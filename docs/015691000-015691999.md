# StackOverflow 问答 15691000-15691999

# sql - 在 codeigniter 中为实时站点配置数据库配置不断收到 500 内部服务器错误

> ID：15691000
> 
> 赞同：1
> 
> 时间：2013-03-28T19:56:38.230
> 
> 标签：sql, database, model, codeigniter-2, configuration-files

我对实际将网站设置为实时版本非常陌生，我只使用本地主机完成了网站。我为此使用了codeigniter，并且我已经将我的问题追溯到它加载数据库的模型。这让我觉得我的数据库配置设置不正确。该模型的功能如下：

```
public function register($email, $password, $first_name, $last_name, $gender, $birthday){

    $salt = $this->generateSalt();

    $password = $this->hash($password, $salt);

    $data = array('email' => $email, 'password' => $password, 'salt' => $salt, 'first_name' => $first_name,
        "last_name" => $last_name, 'gender' => $gender, "birthday" => $birthday);

    $this->load->database();
    if($this->db->insert('users', $data)){
        $this->loginById($this->db->insert_id());
        return true;
    }else{
        return false;
    }
} 
```

虽然我删除了密码和用户名以保护隐私，但数据库配置看起来像这样，但我使用的用户名和密码与我用来进入 phpmyadmin 的相同：

```
$db['default'] = array(
    'dsn'   => '',
    'hostname' => 'http://130.184.99.114/',
    'username' => '',
    'password' => '',
    'database' => 'meetings',
    'dbdriver' => 'mysqli',
    'dbprefix' => '',
    'pconnect' => TRUE,
    'db_debug' => TRUE,
    'cache_on' => FALSE,
    'cachedir' => '',
    'char_set' => 'utf8',
    'dbcollat' => 'utf8_general_ci',
    'swap_pre' => '',
    'autoinit' => TRUE,
    'encrypt' => FALSE,
    'compress' => FALSE,
    'stricton' => FALSE,
    'failover' => array()
); 
```

那么，我需要如何设置呢？我认为我在正确的轨道上，但我对此真的很陌生，所以请以我可以学习的方式解释它！:D 如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T10:44:29.817

您列出的主机名不正确。

它应该是：

`'hostname' => '130.184.99.114',`

或者

`'hostname' => 'localhost',`

取决于服务器的设置方式。

您是否在 /application/config/database.php 文件中进行了设置，或者您是否以不同的方式进行设置？我问我`failover => array()`在那里看到的，它不在默认配置文件中。

# c++ - 生成形状的简单方法

> ID：15691004
> 
> 赞同：0
> 
> 时间：2013-03-28T19:56:51.480
> 
> 标签：c++, c, image, image-processing

我想生成如下形状（图像文件，例如 PNG）：

![例子](../Images/f4193546750a61ea7082afbef0676b63.png)

我正在寻找 ac / c++ 库，它可以让我实现以下算法：

基本算法将是：

1.  画圈
2.  随机分区圈
3.  填写一个段
4.  旋转整个形状（见链接）
5.  将图像另存为 PNG

[链接：Photoshop 中的旋转滤镜](http://www.entheosweb.com/photoshop/twirl.asp)

我将接受列出并链接**一个或多个库**的第一个答案，这将使我能够轻松实现上述算法。如果可能的话，图书馆应该是轻量级的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:03:53.580

我能想到的“最简单”的解决方案是使用[GraphicsMagick](http://www.graphicsmagick.org/index.html)库——特别是[Magick++](http://www.graphicsmagick.org/Magick++/index.html) API。使用[Magick::Image](http://www.graphicsmagick.org/Magick++/Image.html)，您可以使用[Drawable](http://www.graphicsmagick.org/Magick++/Drawable.html)对象、洪水填充，甚至是[Image::swirl](http://www.graphicsmagick.org/Magick++/Image.html#swirl)方法。保存为 PNG 可以像调用`Image::write("filename.png")`

# python - 判断 python 对象是否是当前 __init__ 方法的子类

> ID：15691012
> 
> 赞同：1
> 
> 时间：2013-03-28T19:57:19.880
> 
> 标签：python, init

这是一个奇怪的问题。我曾遇到过几次想在`__init__`python 对象末尾执行一些操作的情况。我只想将动作作为`__init__`真正类（叶类）中的最后一件事。`__init__`如果在 self方法的超类中，我绝对不想这样做。有没有好的方法来做到这一点？我承认这可能是一件愚蠢的事情。但这让我很好奇它是否以及如何完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T20:06:26.510

如果你想让一些代码在叶子类中运行，在 的末尾`__init__`，而不是在基类中运行……只需`__init__`在叶子类中覆盖。例如：

```
class Base(object):
    def __init__(self):
        print('Base initializing')
class Intermediate(Base):
    pass
class Leaf(Intermediate):
    def __init__(self):
        super(Leaf, self).__init__()
        print('Leaf initializing')

>>> o = Base()
Base initializing
>>> o = Intermediate()
Base initializing
>>> o = Leaf()
Base initializing
Leaf initializing 
```

* * *

如果您尝试以编程方式检测，从类似的方法`Base.__init__`中，是否`self`是......的一个`Base`或某个子类`Base`，通常这是一个坏主意，并且您实际上想使用方法覆盖，如上所述。但这很容易做到。例如：

```
class Base(object):
    def __init__(self):
        if type(self) != Base:
            print('Some subclass of Base initializing')
class Leaf(Base):
    pass

>>> obj = Leaf()
Some subclass of Base initializing 
```

（如果您担心有人可能会破坏您的层次结构，以至于某个既不是它的 a 也不是它的子类的对象最终`Base` *可能*会调用`Base.__init__`检查`issubclass`。）

* * *

如果您尝试在类似的方法中以编程方式检测`Base.__init__`base 是否是“真正的类”……那么，您需要定义这意味着什么。这是否意味着“不是 PEP3119 意义上的抽象基类”？“还没有定义子类”？“有一些关键方法的实现”？你想做的任何事情都可能是可行的，但有些会比其他人更难。（例如，要检测是否有人对您的类进行了子类化，您可能需要构建一个自定义元类。）

# internet-explorer-8 - IE8中的双重图像

> ID：15691017
> 
> 赞同：0
> 
> 时间：2013-03-28T19:57:45.423
> 
> 标签：internet-explorer-8

我在显示双图像的 IE8 中存在渲染问题。这是有问题的页面[http://www.salterkitchenscales.co.uk/kitchen-scales/](http://www.salterkitchenscales.co.uk/kitchen-scales/)

我已经阅读了其他可能是标签关闭顺序错误的地方。我不认为这里是这种情况。

谁能指出我正确的方向？

页面在 Firefox 和 Chrome 中呈现正常。

提前致谢。西蒙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:08:34.830

尝试更改您的 css 中的 product_thumb_bg 类，删除宽度和高度：

```
.products_thumb_bg {
    /* show product image as background */        
    float: left;        
    margin: 10px 0px;
} 
```

# sql-server-2008 - SQL Server 2008 中的跨服务器连接

> ID：15691018
> 
> 赞同：0
> 
> 时间：2013-03-28T19:57:46.310
> 
> 标签：sql-server-2008, jointable

有没有办法在没有链接服务器的情况下连接驻留在不同服务器上的不同数据库中的表？

如果链接服务器是唯一的选择，在集群中设置链接服务器时是否有缺点/警告/我应该考虑的任何事情？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:00:33.933

链接服务器几乎是城里唯一的游戏。主要缺点是性能......您的服务器无法很好地优化对链接服务器的查询，当然数据传输率和索引利用率受到严重阻碍。

当我不得不做这样的事情时，我尝试通过简单的查询获取我将使用的所有远程结果，并将数据本地存储在索引临时表中。最初的绘制可能很慢，但我可以根据需要使用数据。但实际上，应该尽可能避免跨服务器的任何复杂查询。亚秒级查询最终可能需要几分钟或更长时间。

# c# - DataTemplate 在维护属性时在 WPF ListView 中显示按钮

> ID：15691021
> 
> 赞同：0
> 
> 时间：2013-03-28T19:57:50.970
> 
> 标签：c#, wpf, mvvm, binding, datatemplate

在 WPF 中，我有一个 2 列的 ListView，第一列需要是一个按钮。如果我错了，请纠正我，但我发现在 ListView 中实现按钮的唯一方法是使用 DataTemplate。我发现的问题是当它们与 DataTemplate 映射时，我无法维护我的原始按钮属性，因此我不得不使用绑定来重新映射每个单独的属性（包括自定义属性，因为我实际上使用的是自定义用户控件它继承自 Button）。这似乎与手动映射所有属性无关，所以也许有更好的方法来自动保留这些属性？

这是我的测试代码：

```
public MainWindow() {
    InitializeComponent();

    ObservableCollection<ScreenRequest> screenRequests = new ObservableCollection<ScreenRequest>() {
        new ScreenRequest("A", "1"),
        new ScreenRequest("B", "2")
    };
    myListView.ItemsSource = screenRequests;
}   

public class ScreenRequest {
    public CustomButton ScreenButton { set; get; }
    public string Details { set; get; }

    public ScreenRequest(string buttonText, string customProperty) {
        this.ScreenButton = new CustomButton();
        this.ScreenButton.Content = buttonText;
        this.ScreenButton.CustomProperty = customProperty;
        this.ScreenButton.Click += new RoutedEventHandler(InitiateScreenRequest);
    }

    private void InitiateScreenRequest(object sender, RoutedEventArgs e) {
        CustomButton screenBtn = (CustomButton)sender;
        screenBtn.Content = "BUTTON TEXT CHANGED";
    }
}   

public class CustomButton : Button  {
    public string CustomProperty { get; set; }
} 
```

和 XAML：

```
<Window...
...
    <Window.Resources>
        <DataTemplate x:Key="ButtonTemplate">
            <local:CustomButton Content="{Binding ScreenButton.Content}"/>
        </DataTemplate>
    </Window.Resources>
    <Grid x:Name="grdMain">
    ...
        <ListView...
            <ListView.View>
                <GridView x:Name="gridView">
                    <GridViewColumn CellTemplate="{StaticResource ButtonTemplate}" Width="Auto" Header="Screen" HeaderStringFormat="Screen"/>
                    <GridViewColumn Header="Details" HeaderStringFormat="Details" DisplayMemberBinding="{Binding Details}"/>
                </GridView>
            </ListView.View>
        </ListView>
    </Grid>
</Window> 
```

所以我的问题是：

1.  我是否必须手动映射 CustomButton 中的每个属性才能将其转移到 DataTemplate 中，或者它们是自动持久化属性的包罗万象？
2.  如何在绑定中映射 CustomProperty 属性以使其与按钮保持一致？我为此使用 DependencyProperty 吗？
3.  如何维护我的单击事件，以便单击 GridView 中的按钮将调用 InitiateScreenRequest 函数？理想情况下，我希望为所有按钮声明一个方法，但我还没有达到这一点。

任何帮助或了解列表视图中的按钮将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:26:11.863

```
<Window x:Class="MiscSamples.TonyRush"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="TonyRush" Height="300" Width="300">
    <ListView ItemsSource="{Binding}">
        <ListView.View>
            <GridView>
                <GridViewColumn Width="Auto" Header="Screen" HeaderStringFormat="Screen">
                    <GridViewColumn.CellTemplate>
                        <DataTemplate>
                            <Button Command="{Binding SomeAction}" Content="{Binding ActionDescription}" Width="100"/>
                        </DataTemplate>
                    </GridViewColumn.CellTemplate>
                </GridViewColumn>
                <GridViewColumn Header="Details" HeaderStringFormat="Details" DisplayMemberBinding="{Binding Details}" Width="100"/>
            </GridView>
        </ListView.View>
    </ListView>
</Window> 
```

代码背后：

```
 public partial class TonyRush : Window
    {
        public TonyRush()
        {
            InitializeComponent();
            DataContext = new List<ScreenRequest>
                              {
                                  new ScreenRequest() {ActionDescription = "Click Me!"},
                                  new ScreenRequest() {ActionDescription = "Click Me Too!"},
                                  new ScreenRequest() {ActionDescription = "Click Me Again!!"},
                              };
        }
    } 
```

视图模型：

```
public class ScreenRequest: INotifyPropertyChanged
    {
        public Command SomeAction { get; set; }

        private string _actionDescription;
        public string ActionDescription
        {
            get { return _actionDescription; }
            set
            {
                _actionDescription = value;
                NotifyPropertyChanged("ActionDescription");
            }
        }

        private string _details;
        public string Details
        {
            get { return _details; }
            set
            {
                _details = value;
                NotifyPropertyChanged("Details");
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        public void NotifyPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }

        public ScreenRequest()
        {
            SomeAction = new Command(ExecuteSomeAction) {IsEnabled = true};
        }

        //public SomeProperty YourProperty { get; set; }

        private void ExecuteSomeAction()
        {
            //Place your custom logic here based on YourProperty
            ActionDescription = "Clicked!!";
            Details = "Some Details";
        }
    } 
```

关键部分：`Command`类：

```
//Dead-simple implementation of ICommand
    //Serves as an abstraction of Actions performed by the user via interaction with the UI (for instance, Button Click)
    public class Command : ICommand
    {
        public Action Action { get; set; }

        public void Execute(object parameter)
        {
            if (Action != null)
                Action();
        }

        public bool CanExecute(object parameter)
        {
            return IsEnabled;
        }

        private bool _isEnabled;
        public bool IsEnabled
        {
            get { return _isEnabled; }
            set
            {
                _isEnabled = value;
                if (CanExecuteChanged != null)
                    CanExecuteChanged(this, EventArgs.Empty);
            }
        }

        public event EventHandler CanExecuteChanged;

        public Command(Action action)
        {
            Action = action;
        }
    } 
```

结果：

![在此处输入图像描述](../Images/1e150e8ec39bd20812a628396d82eb0d.png)

**笔记：**

看看 UI 与数据和功能的分离程度。这是 WPF 的方式。切勿将 UI 与数据/业务代码混为一谈。

ViewModel 中的`Command`用作`Button`. ViewModel 不知道 a`Button`是什么，也不应该知道。如果您需要更多详细信息，请告诉我。

# scala - 将 TraversableOnce[T] 转换为 Multiset-like 或 Histogram-ish Map[T, Int] 的最简洁方法是什么？

> ID：15691022
> 
> 赞同：2
> 
> 时间：2013-03-28T19:57:52.633
> 
> 标签：scala, multiset

我想将 Traversable[T] 转换为带有计数的 Map[T, Int] 直方图。我希望结果是一个不可变的 Map ，它与我会得到的结果相匹配：

```
traversable.groupBy(_).mapValues(_.length) 
```

但看起来这在空间或时间上效率不高......因为`groupBy`维护对可遍历中的每个元素的引用，这在具有少量唯一键的大型可遍历上表现不佳。我真的想要更像这样的东西：

```
def histogram[T](ts : Traversable[T]) : Map[T, Int] = {
  val map = new collection.mutable.HashMap[T, Int].withDefaultValue(0)
  ts.foreach { map(_) += 1 }
  map.toMap
} 
```

有没有一种库方法可以给我这个结果（理想情况下，可以很好地与并行集合一起使用）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:51:56.023

`t.foldLeft(Map.empty[Int, Int].withDefaultValue(0)) { (acc, i) => acc.updated(i, acc(i) + 1) }`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:18:47.927

这是我的扩展，与您的建议非常相似：

```
implicit final class RichIterable[A](val it: TraversableOnce[A]) extends AnyVal {
  def histogram: Map[A, Int] = {
    var res = Map.empty[A, Int] withDefaultValue 0
    it.foreach { elem =>
      res += elem -> (res(elem) + 1)
    }
    res
  }
} 
```

不一定是最快的解决方案，但简洁:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:16:39.340

我会考虑用你的直方图函数来拉扯可遍历的东西。创建一个将“toHistogram[T]”添加到可遍历的隐式类。我认为标准库中没有该功能。

# binary - 任何语言的十六进制到二进制角度测量 (BAMS)

> ID：15691027
> 
> 赞同：3
> 
> 时间：2013-03-28T19:58:07.037
> 
> 标签：binary, hex, data-conversion

例如，我有一个 32 位十六进制值，`04FA4FA4`我想知道如何以双精度形式将其转换为[BAMS](http://en.wikipedia.org/wiki/Binary_scaling)。任何语言的示例都可以正常工作，我只关心学习算法或公式来进行转换。当我有类似的表格时，我知道如何转换为 BAMS，`000:00.0000`但我不知道如何从十六进制进行转换。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T18:41:01.580

[这个链接](http://www.globalspec.com/reference/14722/160210/Chapter-7-5-3-Binary-Angular-Measure)是我发现的最容易理解的资源。算法很简单：

```
(decimal hex value) * 180 / 2^(n-1)       //where n is the number of bits 
```

参考资料中的例子是，

```
0000 0000 1010 0110
 0    0    A    6
166 * 180 * 2^−15 = 0.9118 degrees 
```

这个算法的代码很简单，我觉得这里不需要一一列举。让我知道，如果有人觉得这是不正确的。

# java - Android 文字转语音无法使用日语

> ID：15691031
> 
> 赞同：3
> 
> 时间：2013-03-28T19:58:20.750
> 
> 标签：java, android, text-to-speech

我正在使用[http://mobile.tutsplus.com/tutorials/android/android-sdk-using-the-text-to-speech-engine/上的示例](http://mobile.tutsplus.com/tutorials/android/android-sdk-using-the-text-to-speech-engine/)

我已将其更改为`Local.US`以下内容：`Local.JAPANESE``Local.JAPAN`

```
public void onInit(int initStatus) {

        //check for successful instantiation
    if (initStatus == TextToSpeech.SUCCESS) {
        if(myTTS.isLanguageAvailable(Locale.JAPANESE)==TextToSpeech.LANG_AVAILABLE)
            myTTS.setLanguage(Locale.JAPANESE);
    }   
    else if (initStatus == TextToSpeech.ERROR) {
        Toast.makeText(this, "Sorry! Text To Speech failed...", Toast.LENGTH_LONG).show();
    }   
} 
```

该应用程序运行良好，当设置为 Local.JAPANESE 时，可以正常地说英语单词。

如果我在栏中输入 こんにちは 并单击按钮，它会发出咔哒声。它没有显示 Toast 消息说它不支持该语言。

这是当我点击日文文本时从 logcat 输出的内容：

```
W/patts   ( 1697): [verbalize_controller.cc:366] Failed to find verbatim rule for character 
W/patts   ( 1697): [verbalize_controller.cc:366] Failed to find verbatim rule for character �
W/patts   ( 1697): [verbalize_controller.cc:366] Failed to find verbatim rule for character � 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T12:15:49.917

大多数安卓设备没有内置日语。您必须安装第三方语言包，例如[SVOX](https://play.google.com/store/apps/details?id=com.svox.classic&feature=related_apps#?t=W251bGwsMSwxLDEwOSwiY29tLnN2b3guY2xhc3NpYyJd)。安装后下次打开应用程序时，它会提示您是否要使用 android 系统或新的 SVOX 文本语音。如果没有，您将不得不更改应用程序 > 语言和输入 > 文本转语音中的默认设置。一旦完成，它应该能够说日语。您不必修改代码。

# c++ - 将 FLANN 与单独的 *double 数组一起使用

> ID：15691033
> 
> 赞同：0
> 
> 时间：2013-03-28T19:58:29.423
> 
> 标签：c++, feature-detection, approximate-nn-searching

我正在编写一段代码，该代码执行与 128 维描述符的特征匹配。

图像的所有描述符都存储在 std::vector 中，其中 InterestPoint 包含一个成员 *double desc，它是描述符向量。

现在我想在 Flann 矩阵中使用这个结构来稍后进行近似最近邻特征匹配，我将其初始化为：

```
std::vector<InterestPoint> ip1;
//processing for building vector containing interest points
flann::Matrix<double> input(new double[ip1.size()*128], ip1.size(),  128); 
```

我现在如何用来自 ip1 向量的每个元素的 *double desc 成员填充这个 flann::Matrix ？这是我尝试过的：

```
for(size_t i = 0; i < ip1.size(); i++)
{
    for(size_t j = 0; j < 128; j++)
    {
        input[i][j] = ip1[i].ivec[j];
    }
} 
```

编译但没有成功。flann 提供了一种访问 flann::Matrix 每一行的方法，使用运算符 []，因此 Matrix 类是行主要的。

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-19T08:40:05.067

我不确定“InterestPoint”里面是什么。但我认为这个示例代码会有所帮助。

```
struct MyPoint
{
    MyPoint (double x, double y, double z) {this->x=x; this->y=y; this->z=z;}
    double x,y,z;
};

std::vector<MyPoint> points;
points.push_back(MyPoint(0, 0, 0));
points.push_back(MyPoint(1, 1, 1));
points.push_back(MyPoint(-1, -1, -1));
flann::Matrix<double> points_mat = flann::Matrix<double>(&points[0].x, points.size(), 3); 
```

# javascript - 初学者：想用 do while 循环来完成我的想法，我的脑袋坏了

> ID：15691036
> 
> 赞同：-1
> 
> 时间：2013-03-28T19:58:53.080
> 
> 标签：javascript, html, while-loop

想法是打印 id="gameTable" 的表格 6 次。每次与之前打印的相距 180 像素。使用 CSS 属性。不起作用，我不知道为什么。我觉得这很简单，我看不到。但是什么？

```
<HTML>
<HEAD>
<link rel="stylesheet" type="text/css" href="styleTable.css">
<SCRIPT LANGUAGE="JavaScript">
function newPage(){
    document.open();
    document.write('<HTML>');
    document.write('<head>');
    document.write('</head>');
document.write('<body>');
var i = 0;
function schedule () {
/* print the table */
document.write('<table id="gameTable">');
document.write('<tr>');
document.write('<td id="gameCellTeamNameHost">Arsenal</td>');
document.write('<td id="gameCellTeamNameDash"> - </td>');
document.write('<td id="gameCellTeamNameGuest">Chelsea</td>');
document.write('</tr>');
document.write('<tr>');
document.write('<td id="gameCellScoreHost">0</td>');
document.write('<td id="gameCellScoreSemicolon">:</td>');
document.write('<td id="gameCellScoreGuest">3</td>');
document.write('</tr>   ');
document.write('</table>');
/*Style*/
document.getElementById("gameTable").style.height = "50px"; 
document.getElementById("gameTable").style.width = "180px"; 
document.getElementById("gameTable").style.border = "1px";
document.getElementById("gameTable").style.borderStyle = "solid";   
document.getElementById("gameTable").style.borderColor = "black";
document.getElementById("gameTable").style.padding = "5px"; 
document.getElementById("gameTable").style.backgroundColor = "red"; 
document.getElementById("gameTable").style.position = "absolute";
document.getElementById("gameTable").style.top = "110px";
/* this is the line i used var i */
document.getElementById("gameTable").style.left = (i+"px");
/* -----------------*/
document.getElementById("gameCellTeamNameHost").style.textAlign = "left";
document.getElementById("gameCellTeamNameHost").style.verticalAlign = "top";
document.getElementById("gameCellTeamNameHost").style.height = "24px";
document.getElementById("gameCellTeamNameHost").style.width = "80px";
document.getElementById("gameCellTeamNameGuest").style.textAlign = "right";
document.getElementById("gameCellTeamNameGuest").style.verticalAlign = "top";
document.getElementById("gameCellTeamNameGuest").style.height = "24px";
document.getElementById("gameCellTeamNameGuest").style.width = "80px";
}
 do {           
    schedule();
        i +=180;
        }
        while (i < 1081);

document.write('</body>');
document.write('</HTML>');
document.close();
   }
   </SCRIPT>
   </HEAD>  
   <BODY>
   <INPUT TYPE="button" VALUE="New Season" ONCLICK="newPage()">
   </BODY>
   </HTML> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:21:49.437

您的代码有几个问题。首先，您不应该依赖`document.write`，而应该`document.createElement`使用或使用像 jQuery 这样的框架来动态创建表。

此外，您不应该`id="gameTable"`一遍又一遍地使用相同的。您应该改为使用类，例如`class="gameTable"`. 因为您多次使用相同的 id，所以当您使用 应用样式时`document.getElementById("gameTable")`，您不会将它们应用到所有表格，而只会应用到返回的第一个表格。

最后，您不需要依赖绝对定位，像这样的简单样式将按照您想要的方式对齐表格：

```
.gameTable
{
    float: left;
    margin-right: 180px;
} 
```

# django - Django Celery Beat - 如何使用 DatabaseScheduler 传递参数

> ID：15691038
> 
> 赞同：6
> 
> 时间：2013-03-28T19:59:00.030
> 
> 标签：django, django-celery, celerybeat

我将“DatabaseScheduler”与 Django Celery Beat 一起使用，但我无法将参数传递给函数。

设置：

```
# Django celery
import djcelery
djcelery.setup_loader()
BROKER_URL = 'django://'
CELERYBEAT_SCHEDULER = "djcelery.schedulers.DatabaseScheduler" 
```

任务：

```
@task()
def some_task(days):
    # Some code
    ... 
```

如何使用 Django 管理员传递参数“days”？我创建了一个名为“some_task”的新“定期任务”。我试图通过以下方式来度过争论的日子：

```
Arguments: [7] 
```

并且还测试了：

```
Keyword arguments: {"days": 7} 
```

有人可以给我一个关于如何使用 Django 管理员传递参数的线索吗？

此致，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-07-24T06:06:37.993

参数和关键字参数必须使用双引号。

因此，如果您要指定参数，则应如下所示：

```
["aa", "11"] 
```

如果您指定关键字参数，它应该是这样的：

```
{"abc": "a", "xyz": "1"} 
```

# jquery - 检测滑动速度移动jQuery

> ID：15691040
> 
> 赞同：0
> 
> 时间：2013-03-28T19:59:03.123
> 
> 标签：jquery, cordova, mobile

我正在使用 phonegap 为 andriod 和 iphone 制作应用程序。我想检测滑动速度以获得更好的用户体验。有什么方法可以通过移动 jquery 或任何其他库来实现这一点。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:05:29.593

我最近更新了我的[jQuery Mobile 事件](https://github.com/benmajor/jQuery-Mobile-Events)以包含一个新事件`swipeend`。

`swipeend`当成功执行滑动时触发该事件，并且该库提供了一组有用的数据以用于回调函数。如果您通读文档，就会清楚如何计算速度（假设您使用`S = D / T`算法：

例如，您可以按如下方式使用我的库：

```
$('#myElement').swipeend(function(e, touch) { 
    var speed = touch.xAmount / touch.duration; // Gives speed in pixels/millisecond
}); 
```

这是为您准备的[Fiddle 演示](http://jsfiddle.net/GHt7T/)。

# c# - 如何正确分区 C# 函数库中的代码？

> ID：15691047
> 
> 赞同：9
> 
> 时间：2013-03-28T19:59:47.517
> 
> 标签：c#, functional-programming

作为 FP 设计关于可重用库的关键区别之一的前提（对于我正在学习的内容），这些库比相应的 OO（通常）更以数据为中心。

**TFD** （类型优先开发）等新兴技术似乎也证实了这一点，Tomas Petricek 在[这篇](http://tomasp.net/blog/type-first-development.aspx)博文中对此进行了很好的解释。

如今的语言是多范式的，同一 Petricek 在其书中解释了可从 C# 使用的各种功能技术。

我在这里感兴趣，因此问题**是如何正确分区代码**。

所以我定义了库数据结构，使用等效的可区分联合（如 Petricek 书中所示），并且我计划*根据我的需求的域逻辑将*它们与不可变列表和/或元组一起使用。

我在哪里放置作用于数据结构的操作（方法...函数）？

如果我想定义一个使用标准委托中体现的函数值的高阶函数，`Func<T1...TResult>`我应该把它放在哪里？

常识告诉我将这些方法分组到静态类中，但我想得到那些已经用 C# 编写过函数库的人的确认。

假设这是正确的并且我有一个像这样的高阶函数：

```
static class AnimalTopology {
  IEnumerable<Animal> ListVertebrated(Func<Skeleton, bool> selector) {
    // remainder omitted
  }
} 
```

如果*选择脊椎动物*有N个我想在图书馆展示的特殊案例，那么更正确的展示方式是什么。

```
static class VertebratedSelectorsA {
  // this is compatible with "Func<Skeleton, bool> selector"
  static bool Algorithm1(Skeleton s) {
    //...
  } 
} 
```

或者

```
static class VertebratedSelectorsB {
  // this method creates the function for later application
  static Func<Skeleton, bool> CreateAlgorithm1Selector(Skeleton s) {
     // ...
  } 
} 
```

任何指示将不胜感激。

**编辑：**

[我想引用 Mads Torgersen 的真实世界函数式编程](http://goo.gl/M2M3w)前言T. Petricek 的两句话：

> [...] 您可以在 C# 中使用函数式编程技术获得极大的好处，尽管在 F# 中这样做更容易、更自然。[...] 函数式编程是一种心态。[...]

**编辑-2：**

*   我觉得有必要进一步澄清这个问题。标题中提到的**函数与**[函数式编程](http://en.wikipedia.org/wiki/Functional_programming)严格相关；我不是在问更*实用*的分组方法的方式，更逻辑的方式或更有意义的方式。

*   这意味着实现将尝试尽可能多地遵循[NOOO](http://notonlyoo.org/)宣言总结的 FP 的创始概念，并在此处引用以方便和清晰：

> 1.  类上的函数和类型
> 2.  纯度高于可变性
> 3.  组合优于继承
> 4.  方法分派之上的高阶函数
> 5.  空值选项

问题是围绕**如何布局遵循 FP 概念编写的 C# 库**，因此（例如）绝对不是将方法放入数据结构中的选项；因为这是一个创始的面向对象范式。

**编辑-3：**

此外，如果问题得到回应（和各种评论），我不想给人一种错误的印象，即有人说一种编程范式优于另一种。和之前一样，我将在其书 Expert F# 3.0（第 20 章 - 设计 F# 库 - pg.565）中提到 FP 的权威人士 Don Syme：

> [...] 函数式和 OO 编程方法相互竞争是一个常见的误解。事实上，它们在很大程度上是正交的。[...]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T10:01:27.530

> **注意：**如果您想要一个更简短、更中肯的答案，请参阅我的另一个答案。我知道这里的这个*似乎*是漫无边际的，永远继续下去，谈论你的问题，但也许它会给你一些想法。

`Animal`如果不知道 和 之间的确切关系，很难回答您的问题`Skeleton`。我将在回答的后半部分对这种关系提出建议，但在此之前，我将简单地按照我在您的帖子中看到的内容进行。

首先，我将尝试从您的代码中推断出一些事情：

```
static class AnimalTopology
{
    // Note: I made this function `static`... or did you omit the keyword on purpose?
    static IEnumerable<Animal> ListVertebrated(Func<Skeleton, bool> selector)
    {
        …
    }
} 
```

1.  如果您根据功能原则设计了该功能，则它应该没有副作用。也就是说，它的输出只依赖于它的论点。（在半面向对象的设置中，可能在 ; 的其他静态成员上`AnimalTopology`，但由于您没有显示任何内容，所以让我们忽略这种可能性。）

2.  如果函数确实没有副作用（并且不访问 的静态成员`AnimalTopology`），那么函数的类型签名表明可以`Animal`从 a派生 an `Skeleton`，因为它接受作用于`Skeleton`s 并返回`Animal`s 的东西。

3.  如果这也是正确的，那么为了能够给出答案，让我假设以下内容：

    ```
    class Skeleton
    {
        …
        public Animal Animal { get { … } } // Skeletons have animals!? We'll get to that.
    } 
    ```

现在很明显，您的函数不可能实现，因为它可以从 s 派生`Animal`s `Skeleton`，但它根本没有收到任何东西`Skeleton`；它只接收作用于 a 的谓词函数`Skeleton`。（您可以通过添加第二个 type 参数来解决此问题`Func<IEnumerable<Skeleton>> getSkeletons`，但是...）

在我看来，类似以下的内容会更有意义：

```
static IEnumerable<Animal> GetVertebrates(this IEnumerable<Skeleton> skeletons,
                                          Func<Skeleton, bool> isVertebrate)
{
    return skeletons
           .Where(isVertebrate)
           .Select(s => s.Animal);
} 
```

* * *

现在，人们可能想知道为什么您要从骨骼中猜测动物；并且`bool`“是脊椎动物”的属性不是动物（或骨骼）的固有属性吗？真的有几种方法可以决定这个吗？

我建议如下：

```
class Animal
{
     Skeleton Skeleton { get; } // not only vertebrates have skeletons! 
}

class Vertebrate : Animal { … } // vertebrates are a kind of animal 

static class AnimalsExtensions
{
    static IEnumerable<Vertebrate> ThatAreVertebrates(this IEnumerable<Animal> animals)
    {
        return animals.OfType<Vertebrate>();
    }
} 
```

请注意上述扩展方法的使用。这是一个如何使用它的示例：

```
List<Animal> animals = …;
IEnumerable<Vertebrate> vertebrates = animals.ThatAreVertebrates(); 
```

* * *

现在假设您的扩展方法做了更复杂的工作。在这种情况下，将它放在自己指定的“算法类型”中可能是个好主意：

```
interface IVertebrateSelectionAlgorithm
{
    IEnumerable<Vertebrate> GetVertebrates(IEnumerable<Animal> animals);
} 
```

这具有可以设置/参数化的优点，例如通过类构造函数；您可以将算法拆分为多个方法，这些方法都位于同一个类中（但`private`除了`GetVertebrates`.）

当然，您可以使用函数闭包进行相同类型的参数化，但根据我的经验，这在 C# 设置中很快就会变得混乱。在这里，类是将一组函数组合为一个逻辑实体的好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-29T10:10:36.053

> *我在哪里放置作用于数据结构的操作（方法...函数）？*

我看到了四种常见的方法（没有特别的顺序）：

*   将函数放入数据结构中。（这是**面向对象的“方法”**方法。它适用于函数仅作用于该类型的实例的情况。它可能不太合适，例如，当一个函数“绘制”多个不同类型的对象并吐出一个另一种类型的对象。在这种情况下，我会......）

*   将这些函数放在它们自己指定的**“算法类”**中。（当函数做大量或复杂的工作，或者需要参数化/配置，或者您可能希望将算法拆分为多个函数时，这似乎是合理的，然后您可以通过将它们放入类类型中来逻辑地“分组”在一起。 )

*   将函数转换为**lambda**（也称为匿名委托、闭包等）。（如果它们很小并且您只需要在一个特定的地方使用它们，这很有效；代码不会轻易地在不同的地方重用。）

*   将函数放在静态类中，并使其成为**扩展方法**。（这就是 LINQ to Objects 的工作原理。它是一种混合函数式和面向对象的方法。需要格外小心才能正确解决可发现性/命名空间问题。很多人会认为这种方法在走得太远时会破坏“封装”。对于反论点，阅读优秀的 C++ 文章[“非成员函数如何改进封装”](http://www.drdobbs.com/cpp/how-non-member-functions-improve-encapsu/184401197)；用“扩展方法”代替“非成员朋友函数”。）

> **注意：**如果人们愿意，我可以更详细地介绍其中的每一个，但在我这样做之前，我会等着看这个答案会收到什么样的反馈。

# c# - ASP.net MVC 4 路由和可选参数意外结果

> ID：15691049
> 
> 赞同：1
> 
> 时间：2013-03-28T19:59:49.417
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing

这是我的路线，唯一需要的参数是控制器

```
 routes.MapRoute(
            "countryoptional/controller",
            "{country}/{controller}/{pagelabel}/{page}",
            new { action = "index", country = UrlParameter.Optional,  pagelabel = UrlParameter.Optional, page = UrlParameter.Optional },
            new
            {
                pays = @"$|^(france|belgium)$",
                controller = @"^(car|boat)$",
                pagelabel = @"^$|page",
                page = @"^$|\d{1,6}"
            }
        ); 
```

我期望以下 URLS 可以使用：

/车/

/汽车/页面/2

/法国/汽车

/法国/汽车/页面/2

它有点工作：

```
Url.Action("index", "car", new { country= "france", pagelabel = "page", page = 2} ) 
```

将产生：***/france/car/page/2***

但

如果我想要一个没有国家/地区的网址，则视图操作会响应，但构造函数如

```
Url.Action("index", "car", new { pagelabel = "page", page = 2} ) 
```

将生成此链接：***//car/page/2***

我得到了这个双斜杠“//car”，所以它当然会破坏链接。

我怀疑它不喜欢 {country}/{controller}/... url 定义中控制器可选前面的 {country} 参数的可能性我不想使我的路由配置复杂化并有另一个路由声明一定是一种方式，我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T20:03:13.060

可选参数必须跟在任何必需参数之后。据我所知，没有办法解决这个问题。同样的限制适用于其他任何地方（您的方法定义等）。

只需重复该路线，并有一个具有所需国家和一个没有任何国家。MVC 将确定使用哪一个。

# jquery - 使用 Jquery 缩放图像地图

> ID：15691051
> 
> 赞同：2
> 
> 时间：2013-03-28T19:59:55.670
> 
> 标签：jquery, html, mobile, scale, imagemap

所以我有这个问题。我是编程新手，请记住这一点。

我正在尝试做的事情：使用 JQUERY 在图像映射中缩放一些值。

我的想法：图像被包裹在一个完整的宽度。这意味着它是 100%。因此，如果我采用该数字，然后采用查看器正在使用的宽度，我*可以*将 coord 上的值相乘以始终在轨道上。

一些注意事项（#mapa 是我正在使用的图像映射，#content 是我用作 div 将所有内容放在一起的通用容器。515 是图像自然宽度的值。）不工作：

```
var width = $('#content').width();
var exp = width * 515;
var mul = exp / 100; //I would do all in one line, but I'm always afraid I mess up.

$("area").each(function() {
var pairs = $(this).attr("coords").split(', ');
for (var i=0; i < pairs.length; i++) {
    pairs[i] = pairs[i] * mul;
    }
$(this).html('coords', pairs.join);
}); 
```

那么......有什么建议/建议/插件？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T17:25:34.283

```
$(this).html('coords', pairs.join); 
```

应该

```
$(this).attr('coords', pairs.join(',')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T21:58:49.417

你这里有一个可能的问题：

```
var pairs = $(this).attr("coords").split(', '); 
```

应该*是*_

```
var pairs = $(this).attr("coords").split(','); 
```

如果逗号后应该有一个没有空格的区域定义。

然后是另一个更严重的：

```
$(this).html('coords', pairs.join); 
```

应该

```
$(this).attr('coords', pairs.join(',')) 
```

我刚刚使用您的代码作为基础实现了一个“scaleAreas”功能，它运行良好，您的初始工作节省了我的一天。

# c++ - 如何让 C++ 字符串函数表现得像 Java 和 C# 字符串方法？

> ID：15691052
> 
> 赞同：0
> 
> 时间：2013-03-28T19:59:57.540
> 
> 标签：c++, string

我开始从具有 Java 和 C# 知识的一般编程背景中学习一些 C++。我正在处理一些字符串，我对一些字符串函数感到沮丧。我习惯于字符串函数返回一个新字符串，而旧字符串保持不变。我知道这是在 C# 和 Java 中完成的，因为字符串是不可变的，但我真的希望 C++ 中的字符串方法也能以这种方式工作。有什么我想念的吗？现在我正在做这样的事情：

```
std::string temp = word;
Func(temp.erase(i , 1)); 
```

编辑：这就是我的想法：

```
Func(word.substr().erase(i , 1); 
```

大家觉得哪一个最好？我想这是一件小事，只是想知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:04:33.637

在 C++ 中，您有两种可能性：“就地”编辑，或者返回一个新字符串，例如可以使用[substr 。](http://en.cppreference.com/w/cpp/string/basic_string/substr)

好的我明白了。它的一个变种：

```
Func( string(word).erase(i,1) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:10:14.497

每当您想要副本时，请明确声明它：

```
std::string copy = original;
copy.erase(startPos, size); 
```

当您实际上不需要副本时不断地复制字符串是对性能的浪费，而 C++ 被设计为具有极高的性能，因此大型程序（如游戏、办公套件或 Web 浏览器）即使在旧硬件上也可以顺利运行。

为了满足这一非常重要的需求，C++ 的座右铭是“*不要为不需要的东西买单*”，整个语言都是围绕着这一点设计的。

这并不意味着其他语言（如 Java）更差或更好，只是它们服务于不同的目的和不同的需求，因此功能不同。Java 的主要目的是“*在任何地方和任何地方运行相同的可执行文件*”（字面意思是：“*[一次编写，到处运行](http://en.wikipedia.org/wiki/Write_once,_run_anywhere)*”），这就是它存在于虚拟机上的原因，也是为什么 Java 代码可以在 10 美元的手机、1000 美元的智能手机、电视、电脑、网络浏览器和微波炉。

# android - 当用户离开当前活动时如何使一些代码执行（按下硬件按钮）

> ID：15691067
> 
> 赞同：1
> 
> 时间：2013-03-28T20:00:51.410
> 
> 标签：android, android-intent, android-activity

正如标题所说，我该怎么做？我查看了互联网，似乎您无法做到这一点..有人知道怎么做吗？

我的意思是，当用户按下关闭活动的按钮时，我知道如何执行我的代码，但是硬件后退按钮呢？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:02:14.507

覆盖`onBackPressed()`：

```
@Override
public void onBackPressed() {
    //code
} 
```

这将在使用后退按钮时执行。如果您想在用户导航到另一个活动或使用主页按钮时运行代码，请覆盖`onPause()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:34:08.580

如果您选择按照 ρяσѕρєя 的建议执行 onKeyDown/onKeyUp 方法，这里是代码。

```
// Sets functionality of the hard buttons on the device
@Override 
public boolean onKeyUp(int keyCode, KeyEvent event)
{
    if (keyCode == KeyEvent.KEYCODE_BACK) {
        // Code
    }
    return true;
} 
```

# java - 字符串值的单元测试

> ID：15691069
> 
> 赞同：0
> 
> 时间：2013-03-28T20:00:56.247
> 
> 标签：java, unit-testing

此测试失败：

```
String validString = new String("12345.78");  
myClass.setStringValue(validString);  
assertEquals( "testSetStringValue: " + validString, validString, myclass.getStringValue() ); 
```

因为，我假设，即使`validString`来自的返回值`myclass.getStringValue()`包含相同的内容`12345.78`，它们也是不同的对象。

我如何测试它们是否包含相同的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T20:06:03.910

`assertEquals()`将`equals()`用于比较，所以你的测试是好的。如果要测试某个对象实例是否与其他对象实例相同，可以使用`assertSame()`

有关更多信息，请参阅[JUnit 文档](http://junit.sourceforge.net/doc/cookbook/cookbook.htm)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:07:29.703

只需使用`assertSame`. 但我认为这没有意义，因为它不符合 String 合同。您的任何代码都不应假定字符串是`==`，它必须依赖于它们是`equal`。

# c - C 中 fgets() 和多个 strncmp() 的奇怪错误

> ID：15691072
> 
> 赞同：0
> 
> 时间：2013-03-28T20:01:13.023
> 
> 标签：c

我需要从键盘获得一个输入，再获得三个输入并在这三个上调用一个函数。（清理不必要的代码）头文件：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct aluno
{
char nUsp[8];
char nome[30];
char ano[5];
};
typedef struct aluno aluno;

struct disciplina
{
char nomeDisciplina[30];
char professor[30];
char codigo[8];
};
typedef struct disciplina disciplina;

void ordernaAluno(FILE *alunos, int n);
void ordenaDisciplina(FILE *disciplinas, int m);
void ordenaMatricula(FILE *matriculas, int o);
int buscaAluno(aluno *al, FILE *fp, int n);
int buscaDisciplina(disciplina *disc, FILE *fp, int n);
int cadastrarAluno(aluno *al, FILE *alunos, int n);
void dumpAluno(FILE *alunos, int n);
int cadastrarDisciplina(disciplina *disc, FILE *disciplinas, int m);
void dumpDisciplina(FILE *disciplinas, int m);
int matricular(FILE *alunos, FILE *disciplinas, FILE *matricula, aluno *al, disciplina *disc, int n, int m, int o);
void dumpMatricula(FILE *matriculas, int o); 
```

和主文件：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "T1.h"

//-------------------------------------------------------------------------------------    ------------------------------------------------------
void ordernaAluno(FILE *alunos, int n)
{
int i, j;
aluno aux[2];
rewind(alunos);
//inicio bubble sort do arquivo
for(i=0; i<=n; i++) //primeiro elemento
{

    for(j=0; j<=n-1; j++) //proximo elemento
    {
        fseek(alunos, j*sizeof(aluno),SEEK_SET);//vai ate a posicao inicial do aluno 1
        fread(&aux[0],sizeof(aluno),1,alunos);//le o aluno 1
        fseek(alunos,(i+1)*sizeof(aluno),SEEK_SET);//vai ate a posicao inicial do aluno 2
        fread(&aux[1],sizeof(aluno),1,alunos);//le o aluno 2
        if(strcmp(aux[0].nUsp,aux[1].nUsp) > 0)//compara o nUsp dos dois alunos
        {
            //se o nUsp do aluno 1 for maior que do aluno 2, troca os alunos
            fseek(alunos, j*sizeof(aluno),SEEK_SET);//vai ate a posicao inicial do aluno 1
            fwrite(&aux[1],sizeof(aluno),1,alunos);//escreve o aluno 2
            fseek(alunos,(i+1)*sizeof(aluno),SEEK_SET);//vai ate a posicao inicial do aluno 2
            fwrite(&aux[0],sizeof(aluno),1,alunos);//escreve o aluno 1
        }
    }
    }
}
//-------------------------------------------------------------------------------------------------------------------------------------------

void ordenaDisciplina(FILE *disciplinas, int m)
{
int i, j;
disciplina aux[2];

rewind(disciplinas);
//inicio bubble sort do arquivo
for(i=0; i<=m; i++)//primeiro elemento
{
    for(j=0; j<=m-1; j++)//proximo elemento
    {
        fseek(disciplinas, j*sizeof(disciplina),SEEK_SET);//vai ate a posicao inicial da disciplina 1
        fread(&aux[0],sizeof(disciplina),1,disciplinas);//le a a disciplina 1
        fseek(disciplinas,(i+1)*sizeof(disciplina),SEEK_SET);//vai ate a posicao inicial da disciplina 2
        fread(&aux[1],sizeof(disciplina),1,disciplinas);//le a disciplina 2
        if(strcmp(aux[0].codigo,aux[1].codigo) > 0)//compara os codigos das disciplinas
        {
            //se o codigo da disciplina 1 for maior que o da disciplina 2, troca as disciplinas
            fseek(disciplinas, j*sizeof(disciplina),SEEK_SET);//vai ate a posicao inicial da disciplina 1
            fwrite(&aux[1],sizeof(disciplina),1,disciplinas);//escreve a disciplina 2
            fseek(disciplinas,(i+1)*sizeof(disciplina),SEEK_SET);//vai ate a posicao inicial da disciplina 2
            fwrite(&aux[0],sizeof(disciplina),1,disciplinas);//escreve a disciplina 1
        }
    }
}
}

//-------------------------------------------------------------------------------------------------------------------------------------------

void ordenaMatricula(FILE *matriculas, int o)
{
int i, j;
disciplina Daux[2];
aluno Aaux[2];

rewind(matriculas);
//inicio bubble sort do arquivo (ordena por nUsp)
for(i=0; i<=o; i++) //primeiro elemento
{
    for(j=0; j<=o-1; j++) //proximo elemento
    {
        fseek(matriculas, j*(sizeof(Aaux[0].nUsp)+sizeof(Daux[0].codigo)),SEEK_SET);//vai ate a posicao inicial da matricula 1
        fread(&Aaux[0].nUsp,sizeof(Aaux[0].nUsp),1,matriculas);//le o nUsp da matricula 1
        fread(&Daux[0].codigo,sizeof(Daux[0].codigo),1,matriculas);//le o codigo da matricula 1
        fseek(matriculas,(i+1)*(sizeof(Aaux[1].nUsp)+sizeof(Daux[1].codigo)),SEEK_SET);//vai ate a posicao inicial da matricula 2
        fread(&Aaux[1].nUsp,sizeof(Aaux[1].nUsp),1,matriculas);//le o nUsp da matricula 2
        fread(&Daux[1].codigo,sizeof(Daux[1].codigo),1,matriculas);//le o codigo da matricula 2
        if(strcmp(Aaux[0].nUsp,Aaux[1].nUsp) > 0)//compara os nUsps das matriculas
        {
            //se o nUsp da matricula 1 for maior que o da matricla 2, troca as matriculas
            fseek(matriculas, j*(sizeof(Aaux[0].nUsp)+sizeof(Daux[0].codigo)),SEEK_SET);//vai ate a posicao inicial da matricula 1
            fwrite(&Aaux[1].nUsp,sizeof(Aaux[1].nUsp),1,matriculas);//escreve o nUsp da matricula 2
            fwrite(&Daux[1].codigo,sizeof(Daux[1].codigo),1,matriculas);//escreve o codigo da matricula 2
            fseek(matriculas,(i+1)*(sizeof(Aaux[1].nUsp)+sizeof(Daux[1].codigo)),SEEK_SET);//vai ate a posicao inicial da matricula 2
            fwrite(&Aaux[0].nUsp,sizeof(Aaux[0].nUsp),1,matriculas);//escreve o nUsp da matricula 1
            fwrite(&Daux[0].codigo,sizeof(Daux[0].codigo),1,matriculas);//escreve o codigo da matricula 2
        }
    }
}

//inicio do bubble sort do arquivo (ordena os codigos das disciplinas)
for(i=0; i<=o; i++) //primeiro elemento
{
    for(j=0; j<=o-1; j++) //proximo elemento
    {
        fseek(matriculas, j*(sizeof(Aaux[0].nUsp)+sizeof(Daux[0].codigo)),SEEK_SET);//vai ate a posicao inicial da matricula 1
        fread(&Aaux[0].nUsp,sizeof(Aaux[0].nUsp),1,matriculas);//le o nUsp da matricula 1
        fread(&Daux[0].codigo,sizeof(Daux[0].codigo),1,matriculas);//le o codigo da matricula 1
        fseek(matriculas,(i+1)*(sizeof(Aaux[1].nUsp)+sizeof(Daux[1].codigo)),SEEK_SET);//vai ate a posicao inicial da matricula 2
        fread(&Aaux[1].nUsp,sizeof(Aaux[1].nUsp),1,matriculas);//le o nUsp da matricula 2
        fread(&Daux[1].codigo,sizeof(Daux[1].codigo),1,matriculas);//le o codigo da matricula 2
        if(strcmp(Aaux[0].nUsp,Aaux[1].nUsp) == 0)//compara os nUsps das matriculas
        {
            if(strcmp(Daux[0].codigo,Daux[1].codigo) > 0)
            {
                //se o codigo da matricula 1 for maior que o da matricula 2, troca as matriculas
                fseek(matriculas, j*(sizeof(Aaux[0].nUsp)+sizeof(Daux[0].codigo)),SEEK_SET);//vai ate a posicao inicial da matricula 1
                fwrite(&Aaux[1].nUsp,sizeof(Aaux[1].nUsp),1,matriculas);//escreve o nUsp da matricula 2
                fwrite(&Daux[1].codigo,sizeof(Daux[1].codigo),1,matriculas);//escreve o codigo da matricula 2
                fseek(matriculas,(i+1)*(sizeof(Aaux[1].nUsp)+sizeof(Daux[1].codigo)),SEEK_SET);//vai ate a posicao inicial da matricula 2
                fwrite(&Aaux[0].nUsp,sizeof(Aaux[0].nUsp),1,matriculas);//escreve o nUsp da matricula 1
                fwrite(&Daux[0].codigo,sizeof(Daux[0].codigo),1,matriculas);//escreve o codigo da matricula 2
            }
        }

    }
}
}

//-------------------------------------------------------------------------------------------------------------------------------------------

int buscaAluno(aluno *al, FILE *fp, int n)
{
int i;
aluno aux;

rewind(fp);

for(i=0; i<n; i++)//percorre o arquivo de 0 ate numero de alunos matriculados (n)
{
    fseek(fp, i*sizeof(aluno), SEEK_SET);//posiciona ponteiro para leitura do i-esimo aluno
    fread(&aux, sizeof(aluno), 1, fp);//le todos os dados do aluno
    if(strcmp(aux.nUsp,al->nUsp) == 0)//compara numero usp do aluno lido com do aluno buscado. enquanto os numeros nao forem iguais ou chegar a N alunos, continua buscas
    {
        return 1;//o aluno existe
    }
}
return -1; //nao existe o aluno buscado
}

//-------------------------------------------------------------------------------------------------------------------------------------------

int buscaDisciplina(disciplina *disc, FILE *fp, int n)
{
int i;
disciplina aux;

rewind(fp);

for(i=0; i<n; i++)//percorre o arquivo de 0 ate numero de disciplinas matriculadas (n)
{
    fseek(fp, i*sizeof(disciplina), SEEK_SET);//posiciona ponteiro para leitura da i-esima disciplina
    fread(&aux, sizeof(disciplina), 1, fp);//le todos os dados da disciplina
    if(strcmp(aux.codigo,disc->codigo) == 0)//compara codigo da disciplina lida com codigo da disciplina buscada. enquanto os codigos nao forem iguais ou chegar a N disciplinas, continua buscas
    {
        return 1;//a disciplina existe
    }
}
return -1;//nao existe a disciplina buscada
}

//-------------------------------------------------------------------------------------------------------------------------------------------

int cadastrarAluno(aluno *al, FILE *alunos, int n)//cadastra aluno al, e retorna quantidade de alunos cadastrados +1
{
rewind(alunos);

fseek(alunos, n*sizeof(aluno), SEEK_SET);//coloca o ponteiro na posicao do n-esimo aluno
fwrite(al, sizeof(aluno), 1, alunos);//escreve todas as informacoes do aluno na i-esima posicao

ordernaAluno(alunos, n);

return n+1;//retorna numero de alunos cadastrados +1
}

//-------------------------------------------------------------------------------------------------------------------------------------------

void dumpAluno(FILE *alunos, int n)
{
if(n==0) return NULL; //se nao ha alunos cadastrados, retorna NULL

aluno aux;
int i;

rewind(alunos);

for(i=0; i<n; i++)//percorre o arquivo de alunos de 0 ate n (numero de alunos cadastrados)
{
    fread(&aux,(sizeof(aluno)),1,alunos);//le o aluno
    printf("\%s - \%s - \%s\n",&aux.nUsp,&aux.nome,&aux.ano); //imprime dados do aluno
    //nao eh necessario mover o ponteiro para proximo elemento, pois apos a leitura o ponteiro ja esta no proximo elemento
}
}

//-------------------------------------------------------------------------------------------------------------------------------------------

int cadastrarDisciplina(disciplina *disc, FILE *disciplinas, int m)
{
rewind(disciplinas);

fseek(disciplinas, m*sizeof(disciplina), SEEK_SET);//coloca o ponteiro na posicao da m-esima disciplina
fwrite(disc, sizeof(disciplina), 1, disciplinas);//escreve todas as informacoes da disciplina na i-esima posicao
ordenaDisciplina(disciplinas,m);
return m+1;//retorna numero de disciplinas cadastradas +1
}

//-------------------------------------------------------------------------------------------------------------------------------------------

void dumpDisciplina(FILE *disciplinas, int m)
{
if(m==0) return NULL;//se nao ha disciplinas cadastradas, retorna NULL

disciplina aux;
int i;

rewind(disciplinas);

for(i=0; i<m; i++)//percorre o arquivo de disciplinas de 0 ate m (numero de disciplinas cadastradas)
{
    fread(&aux,(sizeof(disciplina)),1,disciplinas);//le a disciplina
    printf("\%s - \%s - \%s\n",&aux.codigo,&aux.nomeDisciplina,&aux.professor);//imprime dados da disciplina
    //nao eh necessario mover o ponteiro para proximo elemento, pois apos a leitura o ponteiro ja esta no proximo elemento
}
}

//-------------------------------------------------------------------------------------------------------------------------------------------

int matricular(FILE *alunos, FILE *disciplinas, FILE *matricula, aluno *al, disciplina *disc, int n, int m, int o)
{
if(buscaAluno(al,alunos,n)==-1) return o;//verifica se aluno 'al' existe no arquivo 'alunos' com 'n' alunos cadastrados.

if(buscaDisciplina(disc,disciplinas,m)==-1) return o;//verifica se aluno 'al' existe no arquivo 'alunos' com 'n' alunos cadastrados

fseek(matricula,o*(sizeof(al->nUsp)+sizeof(disc->codigo)),SEEK_SET);//posiciona ponteiro para escrita dos dados apos 'o' matriculas
fwrite(al->nUsp, sizeof(al->nUsp),1,matricula);//escreve nUsp do aluno
fwrite(disc->codigo,(sizeof(disc->codigo)),1,matricula);//escreve codigo da disciplina
fseek(matricula,o*(sizeof(al->nUsp)+sizeof(disc->codigo)),SEEK_SET);//posiciona ponteiro para leitura dos dados apos 'o' matriculas
fread(&al->nUsp, sizeof(al->nUsp),1,matricula);//le nUsp do aluno
fread(&disc->codigo, sizeof(disc->codigo),1,matricula);//le codigo da disciplina

ordenaMatricula(matricula, o);

return o+1;//retorna numero de matriculas + 1
}

//-------------------------------------------------------------------------------------------------------------------------------------------

void dumpMatricula(FILE *matriculas, int o)
{
if(o==0) return NULL;//se nao ha matriculas feitas, retorna NULL

char numeroUsp[8], codigoDisc[8];
int i, j;

rewind(matriculas);

for(i=0; i<o; i++)//percorre o arquivo matriculas de 0 ate o matriculas
{
    fread(numeroUsp,8*sizeof(char),1,matriculas);//le o numero usp da matricula
    fread(codigoDisc,8*sizeof(char),1,matriculas);//le o codigo da disciplina da matricula
    printf("\%-7s - \%-7s\n",numeroUsp,codigoDisc);//imprime os dados lidos
}
}

//-------------------------------------------------------------------------------------------------------------------------------------------

int main()
{
int n=0;
int m=0;
int o=0;
char aux[30];
aluno *al;
disciplina *disc;
disc = malloc(sizeof(disciplina));
al = malloc(sizeof(aluno));

FILE *alunos;
FILE *disciplinas;
FILE *matriculas;
alunos = fopen("alunos.bin", "w+b");
disciplinas = fopen("disciplinas.bin", "w+b");
matriculas = fopen("matriculas.txt", "w+");

do
{
    fgets(aux, 29, stdin);
    printf("aux: %s\n", aux);
    //fflush(stdin);
    if(strncmp(aux, "sair\n", 29)==0)
    {
        free(al);
        free(disc);
        fclose(alunos);
        fclose(disciplinas);
        fclose(matriculas);
        return EXIT_SUCCESS;
    }
    else if(strcmp(aux,"cadastar\0aluno")==0)
    {
        //printf("%s", aux);
        printf("entrou cadastrar aluno\n");
        //fflush(stdin);
        scanf("%s", al->nome);
        //fflush(stdin);
        scanf("%s", al->nUsp);
        //fflush(stdin);
        scanf("%s", al->ano);
        n=cadastrarAluno(al, alunos, n);
        printf("cadastrou aluno\n");
    }

    else if(strncmp(aux,"dump aluno\n", 29)==0)
    {
        printf("entrou dump aluno\n");
        dumpAluno(alunos, n);
        printf("dumpou aluno\n");
    }
    else if(strncmp(aux,"cadastrar disciplina\n", 29)==0)
    {
        printf("entrou cadastrar disciplina\n");
        //fflush(stdin);
        scanf("%s", disc->nomeDisciplina);
        printf("%s\n", disc->nomeDisciplina);
        //fflush(stdin);
        scanf("%s", disc->codigo);
        printf("%s\n", disc->codigo);
        //fflush(stdin);
        scanf("%s", disc->professor);
        printf("%s\n", disc->professor);
        //fflush(stdin);
        m=cadastrarDisciplina(disc, disciplinas,m);
        printf("cadastrou disciplina\n");
        printf("tentou get\n");

    }
    else if(strncmp(aux, "dump disciplina\n", 29)==0)
    {
        printf("entrou dump disciplina\n");
        dumpDisciplina(disciplinas, m);
        printf("dumpou disc\n");
    }

    else if(strncmp(aux, "matricular aluno\n", 29)==0)
    {
        printf("entrou matricular aluno\n");
        //fflush(stdin);
        scanf("%s", al->nUsp);
        //fflush(stdin);
        scanf("%s", disc->codigo);
        //fflush(stdin);
        o=matricular(alunos,disciplinas,matriculas,al,disc,n,m,o);
        printf("matriculou \n");
    }

    else if(strncmp(aux, "dump matricula\n", 29)==0)
    {
        printf("entrou dump matricula\n");
        dumpMatricula(matriculas,o);
        printf("dumpou matricula\n");
    }
}while(1);
} 
```

输入已正确存储，但程序根本不会将`aux`与字符串进行比较（“sair”和“cadastrar disciplina”除外，不知道为什么）。即使它这样做了，它也会做它必须做的事情并退出程序，即使我所做的一切都没有返回任何内容（所有使用的函数都是无效的）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:35:06.053

你还记得包含字符串库吗？

```
#include <string.h> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-17T09:36:06.007

> 输入已正确存储，但程序根本不会将 aux 与字符串进行比较（“sair”和“cadastrar disciplina”除外，不知道为什么）。

如果你更换

```
 else if(strcmp(aux,"cadastar\0aluno")==0) 
```

经过

```
 else if(strcmp(aux,"cadastar aluno\n")==0) 
```

它有效 - 空格当然是空格，并且不要忘记换行符。

> 即使它这样做了，它也会做它必须做的事情并退出程序，即使我所做的一切都没有返回任何内容（所有使用的函数都是无效的）。

当然，“sair”因此而退出

```
 return EXIT_SUCCESS; 
```

“地籍学科”没有退出。

# sas - 我正在尝试在 proc sql 的 where 子句中循环使用 case 语句

> ID：15691073
> 
> 赞同：0
> 
> 时间：2013-03-28T20:01:13.713
> 
> 标签：sas, proc-sql

我正在尝试为 SAS EG 中的多个提示值创建存储过程代码......所以当我运行存储过程时，我想为 Fac_Nm 提供多个值......

```
 PROC SQL;
    CREATE TABLE rpt_fac_prd_schd AS
    select  rpt.fac_id,fac.fac_nm as facility_name, schd.prd_id, prd.prd_nm
                , bid_price_dt , bid_price, Table_top
                , Remaining_resource_count label='rem_res_ct' as rem_res_ct, bid_price_tm
                , today()-Load_Dt as Days_out
    from TD.bid_price_rpt rpt Left Join SSIN.fac fac ON rpt.fac_id=fac.onesrc_fac_id
                     Left Join SSIN.FAC_PRD_SCHD schd ON rpt.fac_id=schd.fac_id 
                        and rpt.bid_price_dt=schd.schd_dt
                    Left Join SSIN.PRD prd ON schd.prd_id=prd.prd_id
/*where fac.Fac_Nm="&Fac_Nm" *//*If I use this it is selecting only first value enetered in the prompt*/
where fac.Fac_Nm =CASE when &Fac_Nm_COUNT = 1 then "&Fac_Nm"
else do i=1 to &Fac_Nm_COUNT;/*Value of &Fac_Nm_COUNT is number of values I selected for Fac_Nm prompt*/
               "&&Fac_Nm&i" %end

            and prd.prd_nm ="&Prd_Nm"
            and calculated Days_Out Between &Days_out_str and &Days_out_end 
            and BID_PRICE_DT = "&arrival_dt"d 
            and BID_PRICE_TM Between "&arrival_str_tm"t and "&arrival_end_tm"t
        Order by fac.fac_nm, prd.prd_nm, bid_price_dt, bid_price , Table_top desc
                 , Remaining_resource_count desc,bid_price_tm desc, Days_out desc;
        QUIT; 
```

但它引发了以下错误......知道我在哪里做错了，或者还有其他方法吗？？？

```
ERROR:
                        else do i=1 to &Fac_Nm_COUNT;
                                _
                                22
                                76
ERROR 22-322: Syntax error, expecting one of the following: !, !!, &, (, *, **, +, -, '.', /, <, <=, <>, =, >, >=, AND, EQ, EQT, GE, GET, GT, GTT, LE, LET, LT, LTT, NE, NET, OR, ^=, |, ||, ~=.  

ERROR 76-322: Syntax error, statement will be ignored. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:20:32.857

您不能在 SQL 语句中循环。

我建议您发布另一个问题，描述您要解决的更广泛的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:21:03.870

SAS中没有“带有循环的case语句”之类的东西。你在这里结合了两件事。你想在这里做一个宏循环。

```
where fac.Fac_Nm =
             CASE when &Fac_Nm_COUNT = 1 then "&Fac_Nm"
             else %do i=1 %to &Fac_Nm_COUNT;
                         "&&Fac_Nm&i" %end; end 
```

您也不想在这里使用 CASE WHEN；那是为了选择子句。您想使用宏条件，或者直接使用 - 您根本不需要 if。IN 将愉快地处理 1 值，而 %do 循环将愉快地处理结束值 1。

```
where fac.Fac_NM in (%do i = 1 %to ... %end; ) 
```

不过，我相当肯定这是我能想象到的最糟糕的写这个查询的方式；您可能想回来提交一个包含整个查询的问题。您当然可以使用 SELECT INTO; 将所有 fac_nm 存储在一个宏变量中；但即使这样也不是很聪明。聪明的方法是在 SQL 中正确地做到这一点......

```
where exists (select 1 from B where A.fac_nm = B.fac_nm); 
```

（假设您的原始查询来自 A，而您的 fac_nm 存储在 B 中）。比这更好的是 A 和 B 之间的连接，它更有效。

# java - 避免 android 补间动画更改位置

> ID：15691078
> 
> 赞同：0
> 
> 时间：2013-03-28T20:01:42.247
> 
> 标签：java, android, android-animation

我正在创建一个动画来增加 TextView 的大小。这是我的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<scale xmlns:android="http://schemas.android.com/apk/res/android"
android:fromXScale="0.5"
android:toXScale="2.5"
android:fromYScale="0.5"
android:toYScale="2.5"
android:duration="4000" /> 
```

这是我的 Java 文件：

```
Animation anim = AnimationUtils.loadAnimation(MainActivity.this, R.anim.answeranim);
txtanswer.startAnimation(anim); 
```

我的问题是我的 TextViewer 转到屏幕中心并启动动画。我希望我的 TextViewer 从我已经设置的位置增加他的大小。事实上，我希望动画只是增加 TextViewer 的大小而不是改变它的位置。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:20:48.427

我认为这可能会给你一些方向，你可能需要稍微调整一下 valeus：

```
TextView text = (TextView) this.findViewById(R.id.idTesteText);
    ScaleAnimation anim = new ScaleAnimation(1.0f, 2.0f, 1.0f, 2.0f, 
            Animation.RELATIVE_TO_SELF,1.0f, Animation.RELATIVE_TO_SELF, 0.5f);
    anim.setDuration(700);
    text.startAnimation(anim); 
```

如果将 pivotX 和 pivotY 设置为宽度和高度的一半，如果需要，它将从中心缩放。

您可以在此处查看文档：http: [//developer.android.com/reference/android/view/animation/ScaleAnimation.html](http://developer.android.com/reference/android/view/animation/ScaleAnimation.html)

# c# - 下拉列表列表 C# mvc4

> ID：15691091
> 
> 赞同：-2
> 
> 时间：2013-03-28T20:02:26.110
> 
> 标签：c#, asp.net-mvc-4, drop-down-menu

我想在“下拉列表列表”中显示我的数据，让我解释一下。

如果数据是这样的：

```
Potato - 1.00
Egg - 2.50
Avocado - 3.00 
```

我想这样呈现它：

```
Potato  - 1.00
Egg     - 2.50
Avocado - 3.00 
```

我怎样才能像这样格式化下拉菜单？

让我试着让我的问题更容易理解：

我只需要像在 dropdonw 中显示的那样组织数据，使它们`-`成为两件事的分隔符`vegetable`and `value`，但我想将此字符放在最大名称项目的末尾并`-`在那时对齐另一个，以显示用户喜欢表格数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:09:15.917

由于这是一个下拉列表，因此您需要使用以下技术 [格式化字符串：将字符串格式化为列](https://stackoverflow.com/questions/2978311/format-a-string-into-columns)

```
string.Format( "{0,-10} - {1,-10}", item.Name, item.Price) 
```

您可能还需要这样做，`.Replace(" ", "&nbsp;")`因为 HTML 通常会忽略重复的空格，但在下拉列表中可能会或可能不会出现这种情况。

请注意，您可以通过找到最长的项目并加 1 来计算每个列的宽度，因此如果最长的 Name.Length 为 5，则

```
string.Format( "{0,-" + longestNameLength + "} - {1,-5}" 
```

如果您知道它始终是两位数的价格，则可能是-5。

# paypal - SetExpressCheckout (NVP Legacy API) 和巴西

> ID：15691092
> 
> 赞同：0
> 
> 时间：2013-03-28T20:02:27.287
> 
> 标签：paypal

我刚刚更新了我们的应用程序以使用最新版本的旧版 NVP API，并发现提到了巴西显然需要的两个新字段（TAXIDTYPE、TAXID）。这些显然是在我们之前使用的 API 版本之后引入的。

我只是尝试发送 BR（巴西）的语言环境而忽略发送这些新字段，一切正常。

所以我的问题是：

*   他们真的需要吗？
*   如果是这样，它们到底是什么？[除了 API 文档（ https://www.x.com/developers/paypal/documentation-tools/api/setexpresscheckout-api-operation-nvp](https://www.x.com/developers/paypal/documentation-tools/api/setexpresscheckout-api-operation-nvp) ）之外，找不到任何解释，目前还不清楚这些字段是什么。巴西的个人/企业是否有他们打算在网上购物时提交的 TAXID？

在此先感谢您的任何信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T04:29:40.067

获取买家税号是巴西商家的一项监管要求。如果不是巴西商人，则不需要这些字段。

# java - Spring MVC 3：拦截器返回错误视图

> ID：15691094
> 
> 赞同：3
> 
> 时间：2013-03-28T20:02:32.490
> 
> 标签：java, spring-mvc, interceptor

我正在使用拦截器来限制对应用程序中某些用户的访问。例如：

```
@Override
public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception
{
    Logger.logRequest(request);
    return list.contains(user);
} 
```

如果列表包含用户，则完成请求。否则，它什么也不做。

如果用户无权访问，我如何显示自定义页面？现在，如果它是错误的，它只会显示一个空白页面，这对用户体验来说并不是很好。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-28T20:09:46.330

看起来您可以在不点击 servlet 的情况下进行响应重定向。以下作品：

```
 if (list.contains(user))
        return true;
    else
    {
        //set up the view
        response.sendRedirect("nope_view");
        return false;
    } 
```

# reporting - 如何在不使用 Pentaho Report Designer 的情况下提取 prpt 文件以对其进行更改

> ID：15691095
> 
> 赞同：1
> 
> 时间：2013-03-28T20:02:33.043
> 
> 标签：reporting, pentaho

我想通过更改 .xml 文件来编辑 prpt 文件，而不是在 pentaho Report Designer 中编辑它。

我使用了 winRAR 并提取了文件，对 layout.xml 进行了更改，并尝试通过将扩展名更改为 .prpt 而不是 .rar 来“添加到存档”。这很好地创建了报告，但是当我尝试在 Pentaho 报告设计器中打开这个修改后的报告时，它给了我“无法将文件作为有效的报告定义打开”。

我也尝试在不对任何 xml 文件进行任何更改的情况下执行上述操作，但这也不起作用。

请有人建议任何其他方式来做到这一点。我非常感谢您对此问题的任何意见。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T10:17:25.570

prpt 只是 zip 格式。请务必将 WinRAR 指定为 zip，而不是 rar。

此外，还要特别注意文件内容。报告文件需要位于 zip 文件的根目录中，并且数据源和清单必须位于各自的目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-16T08:48:09.207

我认为您只是用扩展名 prpt 压缩 zip 中的文件夹。这是一种错误的方法，只是压缩文件夹中的文件，而不是使用 prpt 名称和扩展名为 prpt 的文件夹。

它应该是 zip 而不是 Rar

# asp.net - VB.NET/ASP.NET - 日历控件 - 选择年份

> ID：15691100
> 
> 赞同：1
> 
> 时间：2013-03-28T20:02:44.363
> 
> 标签：asp.net, vb.net, calendar, date

如何让用户从 ASP.NET 中的日历控件中选择年份？

目前，日历允许您从左到右滚动（上个月 - 下个月），因此，例如，如果某人出生于 1970 年，他需要点击最远 1970 年才能选择他的出生日期。

怎么可能克服这个？

当前日历：

![日历](../Images/fde076e4dc57317bf8b9796323124d8e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T23:10:16.790

正如评论中所说，它不支持开箱即用。但是，还有其他选择。

你可以使用：

*   jQuery UI 的***[日期选择器](http://jqueryui.com/datepicker/#dropdown-month-year)***
*   AJAX 控制工具包的***[日历](http://www.asp.net/ajaxLibrary/AjaxControlToolkitSampleSite/Calendar/Calendar.aspx)***

或者

***正如@Jack Pettinger***所暗示的那样，您可以简单地创建一个自定义控件，通过扩展 ASP.NET 日历控件来完全满足您的需求。

# c# - 如何在 Windows Store App 中保存我的状态？

> ID：15691101
> 
> 赞同：5
> 
> 时间：2013-03-28T20:02:48.057
> 
> 标签：c#, windows-8, windows-runtime, winrt-xaml, state

我在将状态保存到本地设置时遇到了一点问题。`alt`除了有人使用+关闭我的应用程序`f4`并在 10 秒前打开它（10 秒后应用程序处于挂起状态并保存数据）的情况外，一切都很好。（技术xaml/c#）

我将数据保存在 event 中`OnSuspending`。

我在这样的事件中加载我的数据`OnLaunched`：

```
if (args.PreviousExecutionState == ApplicationExecutionState.Terminated ||
args.PreviousExecutionState == ApplicationExecutionState.ClosedByUser)
{
  // save data
} 
```

如何处理这种情况？我知道每次更改状态时我都可以保存状态，但我认为在我的应用程序中这不是一个好主意。感谢帮助 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:42:40.603

当您在 10 秒前关闭并启动应用程序时，会创建另一个实例，而前一个实例不会运行`OnSuspending`事件**（这很奇怪，因为这意味着像此事件这样的异步操作可以在没有警告我们的情况下结束或永远不会开始）**。我认为这很烦人，但您的用户为什么要这样做呢？大多数情况下，用户“重新启动”您的应用程序是因为它崩溃了，或者他被卡住了，无法返回主页。你应该尽量避免这些情况，这样的想法很少会发生。

但是，这也可能发生，因为用户忘记做某事并想再次启动应用程序。为了防止丢失用户数据，我一有机会就保存最重要的数据并保存其余的唯一`OnSuspending`方法。**您需要考虑丢失时哪些数据会让您的用户感到不安。**

我认为微软应该有更好的方法来保存应用程序状态。我对这个问题进行了很多搜索，但没有找到解释，所以现在我将继续按照上面所说的进行。我希望你提出的这个问题可以帮助我澄清这个，在我看来，奇怪的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T18:51:24.173

```
onLaunched :
    CoreWindow.GetForCurrentThread().Activated += App_Activated;
and event:  
void App_Activated(CoreWindow sender, WindowActivatedEventArgs args)
        {

               if (args.WindowActivationState == CoreWindowActivationState.Deactivated)
               {
               //save Data
               }
       } 
```

加载数据时，删除： `if (args.PreviousExecutionState == ApplicationExecutionState.Terminated || args.PreviousExecutionState == ApplicationExecutionState.Closed`ByUser)`。有用 ！

# javascript - 解析时间字符串

> ID：15691110
> 
> 赞同：2
> 
> 时间：2013-03-28T20:03:07.840
> 
> 标签：javascript, regex

在 Javascript 或 jquery 中，有没有办法验证给定的字符串是 h:m 或 hh:mm 格式还是简单的 h 格式。前任：

```
5 //legal    
2.5 //legal
.5 //legal
2:05 //legal
:5 //NOT legal
2:61 // NOT legal 
```

这个想法是，如果字符串可以解析为双精度，或者可以解析为 h:m 格式，那么就可以了。

这不是 24 小时制，33:44 完全有效，这是用于输入工作时间的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:08:20.287

```
function test(str) {
  if (!isNaN(str)) return true;
  $parts = str.split(':');
  return !isNaN(str[0]) && !isNaN(str[1]) && (+str[1]) <= 60;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:09:28.133

如果您想要一个持续时间（`h`可以是任何值），请使用正则表达式测试数字和时间，例如：

```
/^(?:\.\d+|\d+(?:\.\d*)?|\d+:[0-5]?\d)$/.test(str) 
```

`true`法律案件和`false`其他方面的回报

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:12:02.917

我认为这个问题可以用这样的代码解决：

```
function validate(value) {
           if (!parseFloat(value)) {
              var values = value.split(':');
              if (!parseInt(values[0]) || parseInt(values[1]) >= 60) {
                 return false;
              }
           }
           else {
             var values = value.split('.');
             if (parseInt(values[1]) >= 60)
                return false;
           }
           return true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T20:21:32.857

尝试

```
/^(\d+|\d*(\.[0-5]?\d)|\d+(:[0-5]?\d)?)$/ 
```

例如

```
function verify( time ) {
    return /^(\d+|\d*(\.[0-5]?\d)|\d+(:[0-5]?\d)?)$/.test( time ); 
}  

verify( '24:00' );    // true 
```

# java - 我如何在摇摆中画到 JPanel

> ID：15691112
> 
> 赞同：1
> 
> 时间：2013-03-28T20:03:12.010
> 
> 标签：java, swing, jpanel

我正在编写一个程序，它使用链接节点来存储一个值，然后以黄色条的形式将包含的值绘制到 JPanel 中。这幅画最初是使用 AWT 完成的。我已经阅读了一些关于摇摆绘画[的](http://docs.oracle.com/javase/tutorial/uiswing/painting/index.html)教程，但我仍然不明白如何在 JPanel 上绘画。该程序应该在按下“随机”按钮时绘制条形图，但目前不绘制任何内容。

我已经包含了我认为相关的代码，但如果您需要任何其他部分，请告诉我。提前感谢您可以给我的任何帮助或您可以指向我的任何教程。

```
public class DataOrganizer extends JPanel 
    {

        private JFrame  frame;

        protected static final Color DEFAULT_COLOR = Color.YELLOW;

        protected static final Color    HIGHLIGHT_COLOR = Color.YELLOW.darker();

        protected DataCollection<Item> collection; // To hold our items

        protected DataCollection<Item> sortedCollection;

        protected Item selected;

        private final int COLLECTION_SIZE = 10, // Maximum number of items
                MAXIMUM_ITEM_VALUE = 16; // Maximum value of an item

        private int firstItemXCoord;

        protected int   firstItemYCoord;

        /**
         * Launch the application.
         */
        public static void main(String[] args) 
        {
            EventQueue.invokeLater(new Runnable() {
                public void run()
                {
                    try
                    {
                        DataOrganizer window = new DataOrganizer();
                        window.frame.setVisible(true);
                    }
                    catch (Exception e)
                    {
                        e.printStackTrace();
                    }
                }
            });
        }

        /**
         * Create the application.
         */
        public DataOrganizer()
        {
            initialize();

        }

        /**
         * Initialize the contents of the frame.
         */
        private void initialize()
        {
            /*
             * Create and set-up the JFrame.
             */
            frame = new JFrame();
            frame.setPreferredSize(new Dimension(550, 450));
            frame.setBounds(100, 100, 600, 400);
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.getContentPane().setLayout(null);
            frame.setVisible(true);

            /*
             * Create btnRandom and add an action listener
             * that calls randomAction().
             */
            JButton btnRandom = new JButton("Random");
            btnRandom.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    randomAction();
                }
            });
            btnRandom.setBounds(6, 18, 117, 29);
            frame.getContentPane().add(btnRandom);

            /*
             * Create btnMaximum and add an action listener
             * that calls maximumAction().
             */
            JButton btnMaximum = new JButton("Maximum");
            btnMaximum.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    maximumAction();
                }
            });
            btnMaximum.setBounds(6, 59, 117, 29);
            frame.getContentPane().add(btnMaximum);

            /*
             * Create btnMinimum and add an action listener
             * that calls minimumAction().
             */
            JButton btnMinimum = new JButton("Minimum");
            btnMinimum.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    minimumAction();
                }
            });
            btnMinimum.setBounds(6, 100, 117, 29);
            frame.getContentPane().add(btnMinimum);

            /*
             * Create btnRemove and add an action listener
             * that calls removeAction().
             */
            JButton btnRemove = new JButton("Remove");
            btnRemove.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    removeAction();
                }
            });
            btnRemove.setBounds(6, 141, 117, 29);
            frame.getContentPane().add(btnRemove);

            /*
             * Create btnSort and add an action listener
             * that calls sort().
             */
            JButton btnSort = new JButton("Sort");
            btnSort.addActionListener(new ActionListener() {
                public void actionPerformed(ActionEvent e) {
                    sort();
                }
            });
            btnSort.setBounds(6, 182, 117, 29);
            frame.getContentPane().add(btnSort);

            /*
             * Create the JPanel, set the bounds,
             * and add it to the frame.
             */
            JPanel panel = new JPanel();
            panel.setBounds(135, 0, 465, 378);
            frame.getContentPane().add(panel);

            //Initialize the unsorted collection
            collection = new DataCollection<Item>(COLLECTION_SIZE);

            //Initialize the sorted collection
            sortedCollection = new DataCollection<Item>(COLLECTION_SIZE);

            repaint();
        }

        public void paintComponent(Graphics panel) {

            super.paintComponent(panel);

            panel.drawString("Hello World", 140 , 10);

            /*
             *  Display the Items when instantiated.
             */

            if (collection != null) 
            { 

                Item item;              
                int xCoord = firstItemXCoord;

                /*
                 * Reset the selected item to the start of the collection,
                 * ensuring it always starts at the first node
                 */
                collection.reset();

                        //While there is another node in the collection, loop through.
                while (collection.hasNext()) 
                {
                    /*
                     * Set the item to the selected node. 
                     * Which since reset() was called on the 
                     * collection, it should be the first node 
                     * in the collection. Then set the next node in the
                     * collection a the selected one.
                     */
                    item = collection.next(); 

                    /*
                     * Call the paint method in the item class
                     */
                    item.paint(panel, xCoord, firstItemXCoord);
                    xCoord += Item.OVERALL_WIDTH;
                }

            }

            /*
             *  Display the Items when instantiated.
             */

            if (sortedCollection != null) 
            { 
                Item item; 
                int xCoord = firstItemXCoord + 200;

                /*
                 * Reset the selected item to the start of the collection,
                 * ensuring it always starts at the first node
                 */
                sortedCollection.reset();

                        //While there is another node in the collection, loop through.
                while (sortedCollection.hasNext()) 
                {
                    /*
                     * Set the item to the selected node. 
                     * Which since reset() was called on the 
                     * sortedCollection, it should be the first node 
                     * in the collection. Then set the next node in the
                     * collection a the selected one.
                     */
                    item = sortedCollection.next(); 

                    /*
                     * Call the paint method in the item class
                     */
                    item.paint(panel, xCoord, firstItemXCoord);
                    xCoord += Item.OVERALL_WIDTH;
                }

            }
        }

        //
        // Random
        //
        public void randomAction() 
        {
            collection.clear(); // We restart with nothing,
            // then we add random items,
            for (int i = 1; i <= COLLECTION_SIZE; i++) 
            {
                collection.add(new Item((int) (1 + MAXIMUM_ITEM_VALUE
                        * Math.random()), DEFAULT_COLOR));
            }
            selected = null; // We make sure nothing is selected
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:08:37.473

查看[自定义绘画方法](http://tips4java.wordpress.com/2009/05/08/custom-painting-approaches/)，了解几种进行自定义绘画的方法。

> 该程序应该在按下“随机”按钮时绘制条形图，但目前不绘制任何内容

您可能希望使用将对象添加到 ArrayList 的第一种方法，以便您拥有要绘制的对象列表。所以按钮会添加要绘制的对象，然后调用面板上的 repaint() 方法。

# c++ - 错误：非静态成员引用必须相对于特定对象

> ID：15691115
> 
> 赞同：3
> 
> 时间：2013-03-28T20:03:29.810
> 
> 标签：c++, static, enums

我不明白为什么视图给我一个非静态成员引用的错误必须是相对于特定对象的。

`CDrawView::Shape`是我在我的`CDrawView`

```
enum shape{line, rect, elli};
shape current_shape; 
```

这是我的另一堂课

```
class Shapemaker
{
public:

    CDrawView view;
    static void Create(CDrawView::shape )
    {
        if(view.current_shape == view.line)
        {
            view.m_shape.reset(new Line());
        }
        else if(view.current_shape == view.rect)
        {
            view.m_shape.reset(new Rect());
        }
    }
} 
```

避免此错误的最佳做法是什么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T20:04:56.143

首先，由于函数是`static`，它无权访问`view`. 那是因为`view`是 的非静态成员`Shapemaker`，所以只与特定实例 o 相关联`Shapemaker`。要么`view`需要，`static`要么`Create`功能不应该。另一种选择是它`view`不应该是成员，应该在`Create`函数内部创建。

此外，枚举常量的名称在类的范围内，`CDrawView`并通过类名访问，如下所示：

```
if(view.current_shape == CDrawView::line) 
```

运算符用于访问对象的`.`非静态成员。`view`没有名为`line`or的非静态成员`rect`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:10:05.853

`view`是CDrawView类的一个非静态对象， `Create`是类的静态函数，如果不构造一个对象，`ShapeMaker`就不会有实例，而与ShapeMaker的任何对象都没有关联。您不能在静态成员函数中使用非静态成员。`view``ShapeMaker``Create`

# perl - 在 Perl 中创建多行变量

> ID：15691118
> 
> 赞同：1
> 
> 时间：2013-03-28T20:03:42.607
> 
> 标签：perl, variables

按照我的另一个问题[在这里](https://stackoverflow.com/questions/15597683/processing-text-inside-variable-before-writing-it-into-file)..

我有以下一段代码，我在其中逐行读取网页的内容，尝试匹配某个模式，如果匹配，则将其写入文件：

```
foreach my $line (split qr/\R/, $mech->content) {
    if ($line=~ m/t\/([A-Z]+)/){
        print $fileHandle "$1\n";
    }
} 
```

我想知道是否可以将匹配行附加到另一个多行变量并仅在循环完成时将其写入文件。

我希望这样的原因是因为我想使用以下子例程将数据保存到文件中，而不是直接执行：

```
writeToFile("fileName.tmp","path",data); 
```

这是我编写的一个子程序，除了将数据保存在文件中之外，还检查以下内容：

1.  指定的路径是否已经存在（如果需要，创建它）
2.  如果该文件已存在于磁盘上，请将其与即将写入的文件进行比较（并且仅在文件不同时才写入）

因此，如果我能够创建这个额外的变量，我将少一个文件写入磁盘。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T20:17:22.120

1.  您可以通过字符串连接来做到这一点，在您的循环中，您只需将 print 替换为

    ```
    $data .= "$1\n"; 
    # Same as $data = $data . "$1\n"; 
    ```

2.  或者使用 Perl 的魔力`map`来构建多行字符串，而无需循环或`if`：

    ```
    my $data = join "", 
                    map { /t\/([A-Z]+)/ ? "$1\n" : "" } 
                    split(qr/\R/, $mech->content); 
    ```

3.  或者，您甚至不必经历分裂和加入的痛苦。

    只需将多行字符串视为单个字符串（`/g`修饰符让正则表达式一次又一次地匹配），然后用 3 行替换整个循环：

    ```
    my $data = $mech->content();
    $data =~ s/t\/([A-Z]+)/$1\n/g;
    writeToFile("fileName.tmp", "path", $data); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:13:58.650

这很简单 - 您可以使用`.=`运算符（组合赋值 ( `=`) 和连接 ( `.`) 来附加字符：

```
my $data = "";
while (my $line = ...) {
    ...
    $data .= $line . "\n";
}
writeToFile("fileName.tmp", "path", $data); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T20:19:23.320

只需更换

```
open(my $fileHandle, ...) or ...;

...

   print $fileHandle "$1\n"; 
```

和

```
my $data = '';

...

   $data .= "$1\n"; 
```

将输出附加到字符串而不是将其发送到文件句柄。

# jsf - 什么时候在 UIComponent 上调用 setValue 和 setSubmittedValue？

> ID：15691126
> 
> 赞同：5
> 
> 时间：2013-03-28T20:04:03.620
> 
> 标签：jsf, components, lifecycle

如果我正确地将 BalusC 2006 年伟大的帖子[http://balusc.blogspot.ch/2006/09/debug-jsf-lifecycle.html](http://balusc.blogspot.ch/2006/09/debug-jsf-lifecycle.html)中包含的信息与 Optimus Prime 更早的帖子[http://cagataycivici.wordpress.com/2005结合起来/12/28/jsf_component_s_value_local/](http://cagataycivici.wordpress.com/2005/12/28/jsf_component_s_value_local/)我得到以下信息：

**我的理解：**

1.  在 APPLY_REQUEST_VALUES 阶段，
    *   输入值被设置为 UI 组件的提交值属性（例如 inputComponent.setSubmittedValue **(** "test")）。
2.  在 PROCESS_VALIDATIONS 阶段，
    *   从 submitValue 属性（可能是**inputComponent.getSubmittedValue** ()）中读取相同的值，并在必要时用于转换。
    *   如果转换成功或跳过，则将结果设置为组件的 value 属性（例如 inputComponent.setValue **(** "test")）。
    *   此外，submittedValue 会立即再次被擦除（例如**inputComponent.setSubmittedValue** (null)）
    *   从 UI 组件的 value 属性中读取（转换后的）值（大概是 inputComponent.getValue **()**）并进行验证。
    *   验证后，读取支持 bean/模型的存储值（例如 myBean.getInputValue **(** )）并与新转换和验证的值进行比较。如果不同，将调用 valueChangeListener 方法。
3.  在 UPDATE_MODEL_VALUES 阶段，
    *   新转换和验证的值最终存储在支持 bean 的属性字段中（例如 myBean.setInputValue **(** "test")）。

**问题：**

*   它是否正确？
*   是否缺少一些东西来全面理解 POST 和将输入值保存在支持 bean 之间发生的事情？
*   在输入组件上使用 immediate="true" 时，我们只是将这些事件转移到 APPLY_REQUEST_VALUES 阶段，还是我们改变的不仅仅是事件的时间/顺序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T21:01:35.360

几乎正确。组件的本地值仅在转换**和**验证成功时设置。之后，提交的值设置为`null`。您可以在方法中以一种相当自记录的方式找到验证阶段的整个过程[`UIInput#validate()`](http://grepcode.com/file/repo1.maven.org/maven2/javax.faces/jsf-api/2.1/javax/faces/component/UIInput.java#UIInput.validate%28javax.faces.context.FacesContext%29)（行号符合 JSF 2.1 API）：

```
934    public void validate(FacesContext context) {
935 
936         if (context == null) {
937             throw new NullPointerException();
938         }
939 
940         // Submitted value == null means "the component was not submitted
941         // at all".  
942         Object submittedValue = getSubmittedValue();
943         if (submittedValue == null) {
944             return;
945         }
946 
947         // If non-null, an instanceof String, and we're configured to treat
948         // zero-length Strings as null:
949         //   call setSubmittedValue(null)
950         if ((considerEmptyStringNull(context)
951              && submittedValue instanceof String 
952              && ((String) submittedValue).length() == 0)) {
953             setSubmittedValue(null);
954             submittedValue = null;
955         }
956 
957         Object newValue = null;
958 
959         try {
960             newValue = getConvertedValue(context, submittedValue);
961         }
962         catch (ConverterException ce) {
963             addConversionErrorMessage(context, ce);
964             setValid(false);
965         }
966 
967         validateValue(context, newValue);
968 
969         // If our value is valid, store the new value, erase the
970         // "submitted" value, and emit a ValueChangeEvent if appropriate
971         if (isValid()) {
972             Object previous = getValue();
973             setValue(newValue);
974             setSubmittedValue(null);
975             if (compareValues(previous, newValue)) {
976                 queueEvent(new ValueChangeEvent(this, previous, newValue));
977             }
978         }
979 
980     } 
```

至于组件`immediate`上的属性`UIInput`，是的，这只是将验证转移到应用请求值阶段。[`UIInput#processDecodes()`](http://grepcode.com/file/repo1.maven.org/maven2/javax.faces/jsf-api/2.1/javax/faces/component/UIInput.java#UIInput.processDecodes%28javax.faces.context.FacesContext%29)另请参阅and的源代码，[`UIInput#processValidators()`](http://grepcode.com/file/repo1.maven.org/maven2/javax.faces/jsf-api/2.1/javax/faces/component/UIInput.java#UIInput.processValidators%28javax.faces.context.FacesContext%29)在`UIInput#isImmediate()`.

# sql - PostgreSQL 查询按天计数/分组并显示没有数据的天数

> ID：15691127
> 
> 赞同：65
> 
> 时间：2013-03-28T20:04:09.843
> 
> 标签：sql, postgresql, join, group-by

我需要创建一个返回的 PostgreSQL 查询

*   一天
*   当天找到的对象数量

重要的是**每一天都出现在结果**中，即使那天没有发现任何对象。（这之前已经讨论过，但我无法在我的具体情况下让事情正常进行。）

首先，我找到了一个[sql 查询来生成一系列 days](https://stackoverflow.com/questions/346132/postgres-how-to-return-rows-with-0-count-for-missing-data)，我可以加入：

```
SELECT to_char(date_trunc('day', (current_date - offs)), 'YYYY-MM-DD')
AS date 
FROM generate_series(0, 365, 1) 
AS offs 
```

结果是：

```
 date    
------------
 2013-03-28
 2013-03-27
 2013-03-26
 2013-03-25
 ...
 2012-03-28
(366 rows) 
```

现在我正在尝试将它加入到一个名为“sharer_emailshare”的表中，该表有一个“created”列：

```
Table 'public.sharer_emailshare'
column    |   type  
-------------------
id        | integer
created   | timestamp with time zone
message   | text
to        | character varying(75) 
```

`GROUP BY`这是我迄今为止最好的查询：

```
SELECT d.date, count(se.id) FROM (
    select to_char(date_trunc('day', (current_date - offs)), 'YYYY-MM-DD')
    AS date 
    FROM generate_series(0, 365, 1) 
    AS offs
    ) d 
JOIN sharer_emailshare se 
ON (d.date=to_char(date_trunc('day', se.created), 'YYYY-MM-DD'))  
GROUP BY d.date; 
```

结果：

```
 date    | count 
------------+-------
 2013-03-27 |    11
 2013-03-24 |     2
 2013-02-14 |     2
(3 rows) 
```

期望的结果：

```
 date    | count 
------------+-------
 2013-03-28 |     0
 2013-03-27 |    11
 2013-03-26 |     0
 2013-03-25 |     0
 2013-03-24 |     2
 2013-03-23 |     0
 ...
 2012-03-28 |     0
(366 rows) 
```

如果我理解正确，这是因为我使用的是普通的（隐含的`INNER`）`JOIN`，这是预期的行为，如[postgres docs 中所述](http://www.postgresql.org/docs/8.3/static/queries-table-expressions.html)。

我查看了数十个 StackOverflow 解决方案，所有具有工作查询的解决方案似乎都特定于 MySQL/Oracle/MSSQL，我很难将它们转换为 PostgreSQL。

问[这个问题](https://stackoverflow.com/questions/346132/postgres-how-to-return-rows-with-0-count-for-missing-data)的人用 Postgres 找到了他的答案，但把它放在了一段时间前过期的 pastebin 链接上。

我试图切换到`LEFT OUTER JOIN`, `RIGHT JOIN`, `RIGHT OUTER JOIN`, `CROSS JOIN`, 如果为 null ，则使用`CASE`语句来插入另一个值，`COALESCE`以提供默认值等，但我无法以某种方式使用它们来获得我需要的东西。

任何帮助表示赞赏！我保证我很快就会开始阅读那本 PostgreSQL 巨著；）

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-03-28T20:06:09.690

你只需要一个`left outer join`而不是一个内部连接：

```
SELECT d.date, count(se.id)
FROM (SELECT to_char(date_trunc('day', (current_date - offs)), 'YYYY-MM-DD') AS date 
      FROM generate_series(0, 365, 1) AS offs
     ) d LEFT OUTER JOIN
     sharer_emailshare se 
     ON d.date = to_char(date_trunc('day', se.created), 'YYYY-MM-DD'))  
GROUP BY d.date; 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2014-03-14T02:16:34.620

扩展 Gordon Linoff 的有用答案，我建议进行一些改进，例如：

*   使用`::date`代替`date_trunc('day', ...)`
*   加入日期类型而不是字符类型（更简洁）。
*   使用特定的日期范围，以便以后更容易更改。在这种情况下，我选择表中最近条目之前的一年 - 这是其他查询无法轻松完成的事情。
*   计算任意子查询的总数（使用 CTE）。您只需要将感兴趣的列转换为日期类型并将其命名为 date_column。
*   包括一列累计总数。（为什么不？）

这是我的查询：

```
WITH dates_table AS (
    SELECT created::date AS date_column FROM sharer_emailshare WHERE showroom_id=5
)
SELECT series_table.date, COUNT(dates_table.date_column), SUM(COUNT(dates_table.date_column)) OVER (ORDER BY series_table.date) FROM (
    SELECT (last_date - b.offs) AS date
        FROM (
            SELECT GENERATE_SERIES(0, last_date - first_date, 1) AS offs, last_date from (
                 SELECT MAX(date_column) AS last_date, (MAX(date_column) - '1 year'::interval)::date AS first_date FROM dates_table
            ) AS a
        ) AS b
) AS series_table
LEFT OUTER JOIN dates_table
    ON (series_table.date = dates_table.date_column)
GROUP BY series_table.date
ORDER BY series_table.date 
```

我测试了查询，它产生了相同的结果，加上累积总计列。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-28T22:20:03.450

根据 Gordon Linoff 的回答，我意识到另一个问题是我有一个`WHERE`在原始问题中没有提到的子句。

而不是裸`WHERE`，我做了一个子查询：

```
SELECT d.date, count(se.id) FROM (
    select to_char(date_trunc('day', (current_date - offs)), 'YYYY-MM-DD')
    AS date 
    FROM generate_series(0, 365, 1) 
    AS offs
    ) d 
LEFT OUTER JOIN (
    SELECT * FROM sharer_emailshare 
    WHERE showroom_id=5
) se
ON (d.date=to_char(date_trunc('day', se.created), 'YYYY-MM-DD')) 
GROUP BY d.date; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-09-29T13:42:24.693

我将尝试提供一个包含一些解释的答案。我将从最小的构建块开始并逐步完成。

如果您运行这样的查询：

```
SELECT series.number FROM generate_series(0, 9) AS series(number) 
```

你会得到这样的输出：

```
 number 
--------
      0
      1
      2
      3
      4
      5
      6
      7
      8
      9
(10 rows) 
```

这可以变成这样的日期：

```
SELECT CURRENT_DATE + sequential_dates.date AS date
  FROM generate_series(0, 9) AS sequential_dates(date) 
```

这将给出如下输出：

```
 date    
------------
 2019-09-29
 2019-09-30
 2019-10-01
 2019-10-02
 2019-10-03
 2019-10-04
 2019-10-05
 2019-10-06
 2019-10-07
 2019-10-08
(10 rows) 
```

然后您可以执行这样的查询（例如），将原始查询作为子查询加入您最终感兴趣的任何表：

```
 SELECT sequential_dates.date,
          COUNT(calendar_items.*) AS calendar_item_count
     FROM (SELECT CURRENT_DATE + sequential_dates.date AS date
             FROM generate_series(0, 9) AS sequential_dates(date)) sequential_dates
LEFT JOIN calendar_items ON calendar_items.starts_at::date = sequential_dates.date
 GROUP BY sequential_dates.date 
```

这将给出如下输出：

```
 date    | calendar_item_count 
------------+---------------------
 2019-09-29 |                   1
 2019-09-30 |                   8
 2019-10-01 |                  15
 2019-10-02 |                  11
 2019-10-03 |                   1
 2019-10-04 |                  12
 2019-10-05 |                   0
 2019-10-06 |                   0
 2019-10-07 |                  27
 2019-10-08 |                  24 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-24T00:52:10.007

我喜欢 Jason Swett SQL，但遇到了一些日期的计数应该为零而不是一的问题。从 public.post_call_info 运行语句 select count(*) where timestamp::date = '2020-11-23' count = 0，但低于等于 1。

此外，+ 给我一个前进的时间表，所以改为减号提供当前日期之前的 9 天数据。

```
SELECT sequential_dates.date,
COUNT(*) AS call_count
FROM (SELECT CURRENT_DATE - sequential_dates.date AS date
        FROM generate_series(0, 9) AS sequential_dates(date)) sequential_dates
LEFT JOIN public.post_call_info ON public.post_call_info.timestamp::date = 
    sequential_dates.date
GROUP BY sequential_dates.date
    order by date desc 
```

# java - JSF 下载并转发到结果页面

> ID：15691134
> 
> 赞同：2
> 
> 时间：2013-03-28T20:04:24.213
> 
> 标签：java, jsf, download

我正在使用 JSF 2.1 和 Primefaces。当用户提交表单时，我的程序填写 PDF 文档并将其下载到用户计算机，然后我需要显示带有状态消息的新页面。我的代码下载填写的表单但不重定向到结果页面。

```
PDDocument document = PDDocument.load("C:/Backup/test.pdf");
PDDocumentCatalog docCatalog = document.getDocumentCatalog();
PDAcroForm acroForm = docCatalog.getAcroForm();
.... 
```

在这里填写文件..

```
FacesContext facesContext = FacesContext.getCurrentInstance();
ExternalContext externalContext = facesContext.getExternalContext();
HttpServletResponse response = (HttpServletResponse) externalContext.getResponse();

response.setHeader("Content-disposition", "attachment; filename=\"test.pdf\""); 
response.setHeader("Refresh", "1; URL=result.xhtml");

BufferedOutputStream output = null;
output = new BufferedOutputStream(response.getOutputStream());
document.save(output);
output.close();
facesContext.responseComplete(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T03:53:55.850

您可以遵循以下之一：

1.  **选项1**

    一世。将用户重定向到结果页面

    ii. 向用户显示**下载按钮**，单击此按钮时，会打开一个新窗口，其中将显示/下载 PDF。

2.  **选项 2**

    一世。将用户重定向到结果页面

    ii. 当结果页面加载时，使用 javascript/jQuery 发送请求以打开一个新窗口，其中将显示/下载 PDF。

# javascript - 此函数如何确定对象为空？

> ID：15691141
> 
> 赞同：8
> 
> 时间：2013-03-28T20:04:44.390
> 
> 标签：javascript, jquery

我正在挖掘 jQuery 源代码，发现他们使用这个小代码片段来检测 JavaScript 对象是否为空。

```
function isMyObjEmpty( obj ) {
    var name;
    for (name in obj ) {
        return false;
    }
    return true;
} 
```

有人可以向我解释为什么会这样吗？我只是不明白为什么这会返回真实。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-28T20:06:33.970

## 为什么有效：

这使用[`for... in`](http://es5.github.com/#x12.6.4)循环来遍历对象的属性。

如果对象有任何属性，它将进入循环并返回`false`

如果对象没有属性，则不会进入循环，并返回`true`。

## 为什么没有：

请注意，存在不起作用的情况。`for.. in`循环只通过`enumerable`属性，所以从技术上讲，一个对象可以是非空的，它仍然会返回 false。可以[将属性定义](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)为不可枚举并欺骗此方法。[这是有问题的案例](http://jsbin.com/ikeyep/1/edit)。

正确的说法是这个方法检查一个对象是否有任何**可枚举**的属性。

### 文档怎么说：

您可以在此处找到该方法的[文档](http://api.jquery.com/jQuery.isEmptyObject/)。

> 描述：检查对象是否为空（不包含可枚举的属性）。

我个人觉得他们会调用那个方法很奇怪`isEmptyObject`。我认为更合适的名字是`hasNoEnumerableProperties`.

### 如果你真的想检查一个对象是否为空怎么办？

在 JS 的较新实现中，可以使用[`Object.getOwnPropertyNames`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/getOwnPropertyNames). `getOwnPropertyNames`获取所有属性，无论是否可枚举。

您可以`isMyObjEmpty`使用`Object.getOwnPropertyNames(myObject).length===0`. 这将检查对象是否没有可枚举的属性。

然而，这并没有检查原型属性。这可能是可取的行为，也可能不是可取的行为，您可以查看我与[theshadowmonkey](https://stackoverflow.com/a/15691211/1348195)的讨论。这可以通过[`Object.getPrototypeOf`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/getPrototypeOf)递归调用并检查原型链中的属性来轻松解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:06:28.063

如果它找到`name`了，`obj`那么 obj 中有东西并且它不为空，如果它不能这样做，它将返回 true，说 obj 是空的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:08:19.980

试试这个。我认为这是因为对象自身的属性。您需要拥有 hasOwnProperty 以确保您不访问其原型属性。

```
 function isMyObjEmpty( obj ) {
        var name;
        for (name in obj ) {
          if(obj.hasOwnProperty(name)) {
            return false;
          }
        }
        return true;
    } 
```

阅读文档并查看其中所写的含义。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T20:09:44.853

也许不是，但我假设混淆来自于 obj.name 中的关键“名称”。它实际上并不是在对象中寻找名为 name 的键，而是将对象中的任何键分配给他们称为 name 的变量。因此，如果它在对象中找到任何东西，它将返回 false 并确认它确实不是一个空对象。但是如果它在对象中没有找到任何东西，它将返回 true 意味着您的对象是空的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T21:00:43.427

关键是 for..in 循环遍历对象的每个属性，但仅此而已。如果对象中没有任何内容，那么该循环将永远不会运行，因此“return false”行永远不会被执行。然后程序转到下一行，告诉它返回真。

（这本身就引出了一个有趣的问题。是否应该将 for..in 循环包含在 hasOwnProperty() 检查中？或者该函数实际上是否打算捕获非自己的属性并在此基础上将对象计为非空？）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-28T20:06:35.920

当对象为空时，它什么时候返回 true。

```
isMyObjEmpty({}); 
```

它是如何工作的？通过使用[for...in](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in)

* * *

> ## 对于...在
> 
> *概括*
> 
> 以任意顺序迭代对象的可枚举属性。对于每个不同的属性，可以执行语句。

所以如果没有*属性*，它就不会进入 for in 循环。循环确实应该检查，[`hasOwnProperty()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/hasOwnProperty)因为这可能导致误报。

# django - 基于 Django 类的视图和简单图像上传

> ID：15691143
> 
> 赞同：3
> 
> 时间：2013-03-28T20:04:45.217
> 
> 标签：django, django-forms, django-views

尝试简单的图像上传时出现错误：

```
TypeError at /upload/
__init__() got an unexpected keyword argument 'instance' 
```

以下是相关代码的片段（如果您需要更多，请告诉我！）：

```
# Models

class Photo(models.Model):
    created_at = models.DateTimeField(auto_now_add=True, editable=False)
    title = models.CharField(max_length=255)
    image = models.ImageField(upload_to='photos/'+str(uuid.uuid4())+'/')

# Views

class PhotoUploadView(CreateView):
    model = Photo
    form_class = PhotoUploadForm
    template_name = 'upload.html'
    success_url = '/thanks/'

# Forms

class PhotoUploadForm(forms.Form):
    image = forms.ImageField()
    title = forms.CharField(max_length=255)

# Urls

urlpatterns = patterns('',
    url(r'^upload/', views.PhotoUploadView.as_view()),
) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T20:14:37.123

您收到异常是因为您在 View 类中指定了实现[SingleObjectMixin](https://docs.djangoproject.com/en/1.3/ref/class-based-views/#singleobjectmixin)的“模型”属性。但是，您并没有给它一个要渲染的 Photo 模型的实例。

由于您只想创建一张新照片，因此您应该从 View 类中删除模型属性：

```
# views.py
from django.views.generic import CreateView
from myapp.forms import PhotoUploadModelForm

class PhotoUploadView(CreateView):
    form_class = PhotoUploadModelForm
    template_name = 'upload.html'
    success_url = '/thanks/' 
```

并修改您的表单类以从[ModelForm](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#modelform)继承：

```
# forms.py
from django import forms
from myapp.models import Photo

class PhotoUploadModelForm(forms.ModelForm):

    class Meta:
        model = Photo
        fields = ['image', 'title'] 
```

# svn - CollabNet SVN 和 TortoiseSVN 的 svnserve 作为服务器有什么区别？

> ID：15691144
> 
> 赞同：2
> 
> 时间：2013-03-28T20:04:49.287
> 
> 标签：svn, tortoisesvn, collabnet

我们目前有一个 Win 2008 R2 服务器设置，其中 Tortoise SVNSERVE.EXE 作为服务运行。我们被禁止运行网络服务器。一些项目想要将存储库添加到我们的服务器，并建议我们“升级”到 CollabNet Subversion。这样做我们会得到什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-29T00:29:58.043

*完整披露：我是一名资深的 Subversion 开发人员和 CollabNet 员工。*

很难想象运行 CollabNet 打包的 'svnserve' 实用程序与 TortoiseSVN 附带的实用程序相比，您会获得什么直接的*技术优势。*主要区别在于 CollabNet 为其提供的版本提供的额外支持。

不过，我不禁想知道，那些敦促您安装“CollabNet Subversion”的人实际上是否在敦促您考虑 CollabNet 的 Subversion Edge 产品。（冒着听起来像广告的风险）Subversion Edge 在一个易于安装的软件包中提供了一个免费的、开源的、网络管理的 Subversion 服务器。作为 Subversion 服务器软件包，它是一个很好的软件包，但特别是因为 Subversion Edge 为诸如“创建新存储库”之类的操作提供了一个干净的界面，我假设您的用户在他们仅仅说“CollabNet Subversion”时是指 Edge。不幸的是，它是基于 Apache 的（显然*不是*基于 svnserve），所以我认为它不会通过您严格的“不允许 Web 服务器”政策。

我建议您让您的用户准确地确定他们想要什么，因为他们*似乎*建议的选项都没有提供额外的技术价值，这是非常明显的，但也符合您的部署限制。（或者，请参阅解除“禁止 Web 服务器”禁令，并为自己试一试 Subversion Edge。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T21:53:07.010

Subversion 的源代码（来自 Apache）是免费和开放的。TortoiseSVN 和 CollabNet 使用同一组源文件来构建它们的命令行工具。

主要区别在于支持之一。TortoiseSVN 项目提供了一套完整的命令行工具，但实际上并不支持它们。事实上，如果您查看[TortoiseSVN 的在线文档`svnserve`](http://tortoisesvn.net/docs/nightly/TortoiseSVN_en/tsvn-serversetup-svnserve.html)，您会看到他们告诉您使用 CollabNet 的`svnserve`.

还有如何编译和测试代码的问题。CollabNet 可能对他们的 svnserve 版本进行了更彻底的测试，以确保它可以在各种情况下工作。*考虑到升级*到 CollabNet的成本是免费的，您应该选择 CollabNet 软件包来运行您的 Subversion 服务器。

如果您将 Subversion 用于您自己的个人用途， TortoiseSVN 的版本`svnserve`可能还不错，但是当您使用公司团队时，您真的应该选择专门为服务器使用而制作的众多 Subversion 发行版之一。

# c - 如何在 win32 中安装/卸载 Windows 服务？

> ID：15691150
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:05:19.727
> 
> 标签：c, winapi, service

我正在尝试创建一个可以删除特定路径中的临时文件的 Win32 程序。

但实际上我的代码中的安装/卸载功能遇到了麻烦。

我正在使用 Visual Studio 2012，当我启动调试过程以测试我的代码时，调试窗口会立即关闭。

也许问题不是来自VS 2012，而是来自我的代码？

这里是：

```
/*
** INCLUDES
*/
#include <Windows.h>
#include <stdio.h>

/*
** MACROS
*/
# define MY_SERVICE_NAME "DiskCleaner"
# define MY_SERVICE_DISPLAY_NAME "Nettoyeur de disque"   
SERVICE_STATUS my_ServiceStatus;
SERVICE_STATUS_HANDLE my_ServiceStatusHandle;
BOOL bRunning;
BOOL InstallMyService();
BOOL DeleteMyService();
void WINAPI ServiceCtrlHandler(DWORD Opcode);
void WINAPI ServiceMain(DWORD argc, LPTSTR *argv);

/* INSTALL THE SERVICE */
BOOL InstallMyService()
{
    char strDir[MAX_PATH];
    SC_HANDLE hSCManager;
    SC_HANDLE hService;
    LPCTSTR lpBinaryPathName;

    GetCurrentDirectory(MAX_PATH, strDir);
    strcat(strDir, "\\AutoClean.exe");

    hSCManager = OpenSCManager (NULL, NULL, SC_MANAGER_ALL_ACCESS);

    if (hSCManager == NULL)
        return (FALSE);

    lpBinaryPathName=strDir;

    hService = CreateService(
        hSCManager,                             MY_SERVICE_NAME,                
        MY_SERVICE_DISPLAY_NAME,                SERVICE_ALL_ACCESS,             
        SERVICE_WIN32_OWN_PROCESS,      
        SERVICE_AUTO_START,             
        SERVICE_ERROR_NORMAL,           
        lpBinaryPathName,                   
        NULL,                            
        NULL,                           
        NULL,                           
        NULL,                            
        NULL);                          

    if (hService == NULL)
        return (FALSE);

    CloseServiceHandle(hService);
    return (TRUE);
}

/* DELETE THE SERVICE */
BOOL DeleteMyService()
{
    SC_HANDLE hSCManager;
    SC_HANDLE hService;

    hSCManager = OpenSCManager (NULL, NULL, SC_MANAGER_ALL_ACCESS);

    if (hSCManager == NULL)
        return (FALSE);

    hService = OpenService (hSCManager, MY_SERVICE_NAME, SERVICE_ALL_ACCESS);

    if (hService == NULL)
        return (FALSE);

    if (DeleteService(hService) == NULL)
        return (FALSE);

    if (CloseServiceHandle(hService) == NULL)
        return (FALSE);

    return (TRUE);
}

/* SERVICE EVENT HANDLER */
void WINAPI ServiceCtrlHandler(DWORD Opcode)
{
    switch (Opcode)
    {
    case SERVICE_CONTROL_PAUSE:
        my_ServiceStatus.dwCurrentState = SERVICE_PAUSED;
        break;
    case SERVICE_CONTROL_CONTINUE:
        my_ServiceStatus.dwCurrentState = SERVICE_RUNNING;
        break;
    case SERVICE_CONTROL_STOP:
        my_ServiceStatus.dwWin32ExitCode = 0;
        my_ServiceStatus.dwCurrentState = SERVICE_STOPPED;
        my_ServiceStatus.dwCheckPoint = 0;
        my_ServiceStatus.dwWaitHint = 0;
        SetServiceStatus (my_ServiceStatusHandle, &my_ServiceStatus);
        bRunning = FALSE;
        break;
    case SERVICE_CONTROL_INTERROGATE:
        break;
    default:
        break;
    }   
    return;
}

/* SERVICE ENTRY POINT */
void WINAPI ServiceMain(DWORD argc, LPTSTR *argv)
{
    DWORD Status;
    DWORD SpecificError;

    my_ServiceStatus.dwServiceType = SERVICE_WIN32;
    my_ServiceStatus.dwCurrentState = SERVICE_START_PENDING;
    my_ServiceStatus.dwControlsAccepted = SERVICE_ACCEPT_STOP;
    my_ServiceStatus.dwWin32ExitCode = 0;
    my_ServiceStatus.dwServiceSpecificExitCode = 0;
    my_ServiceStatus.dwCheckPoint = 0;
    my_ServiceStatus.dwWaitHint = 0;
    my_ServiceStatusHandle = RegisterServiceCtrlHandler(MY_SERVICE_NAME, ServiceCtrlHandler);

    if (my_ServiceStatusHandle == (SERVICE_STATUS_HANDLE)0)
    {
        return;
    }

    my_ServiceStatus.dwCurrentState = SERVICE_RUNNING;
    my_ServiceStatus.dwCheckPoint = 0;
    my_ServiceStatus.dwWaitHint = 0;
    SetServiceStatus(my_ServiceStatusHandle, &my_ServiceStatus);
    bRunning = TRUE;

    while (bRunning)
    {
        printf("\nOK just to test if this part works well before implementing my cleaning part\n");
    }
    return;
}

/* ENTRY POINT */
int main(int argc, char* argv[])
{
    if (argc > 1)
    {
        if (strcmp(argv[1], "-i"))
        {
            if (InstallMyService())
                printf("\nService successfully installed\n");
            else
                printf("\nService installtion unsuccessfull\n");
        }
        else if (strcmp(argv[1], "-d"))
        {
            if (DeleteMyService())
                printf("\nService successfully deleted\n");
            else
                printf("\nService delete unsuccesfull\n");
        }
        else
            printf("\nUsage incorrect\n");
    }
    else
    {
        SERVICE_TABLE_ENTRY DispatchTable[]={{MY_SERVICE_NAME, ServiceMain}, {NULL, NULL}};
        StartServiceCtrlDispatcher(DispatchTable);
    }

    return (EXIT_SUCCESS);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T15:12:37.813

在您的主要功能中，您有错误：

```
if (strcmp(argv[1], "-i"))

if (strcmp(argv[1], "-d")) 
```

此条件为**FALSE**，因此不会执行您的**InstallMyService() / DeleteMyService() 。**

同样为了复杂性，您忘记了关闭服务管理器句柄。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-05T19:39:58.043

我已经更正了我的代码，它现在可以工作了。这是整个解决方案：

```
#include <Windows.h>
#include <stdio.h>

/*
** MACROS
*/
# define MY_SERVICE_NAME "DiskCleaner"
# define MY_SERVICE_DESCRIPTOR "Nettoyeur de fichiers temporaires"
# define MY_SERVICE_BIN_NAME "DiskCleaner.exe"

/*
** GLOBALS
*/
SERVICE_STATUS g_ServiceStatus;
SERVICE_STATUS_HANDLE g_ServiceStatusHandle;

/*
** INSTALL THE SERVICE
*/
BOOL InstallMyService()
{
  char strDir[MAX_PATH + 1];
  SC_HANDLE schSCManager;
  SC_HANDLE schService;
  LPCTSTR lpszBinaryPathName;

  GetCurrentDirectory(MAX_PATH, strDir);
  strcat(strDir, "\\"MY_SERVICE_BIN_NAME);
  if ((schSCManager = OpenSCManager(NULL, NULL, SC_MANAGER_ALL_ACCESS)) == NULL)
    return (TRUE);
  lpszBinaryPathName = strDir;
  schService = CreateService(schSCManager, MY_SERVICE_NAME, MY_SERVICE_DESCRIPTOR,
                             SERVICE_ALL_ACCESS, SERVICE_WIN32_OWN_PROCESS,     SERVICE_AUTO_START, SERVICE_ERROR_NORMAL,
                             lpszBinaryPathName, NULL, NULL, NULL, NULL, NULL);
  if (schService == NULL)
    return (FALSE);
  CloseServiceHandle(schService);
  return (TRUE);
}

/*
** DELETE THE SERVICE
*/
BOOL DeleteMyService()
{
  SC_HANDLE schSCManager;
  SC_HANDLE hService;

  if ((schSCManager = OpenSCManager(NULL, NULL, SC_MANAGER_ALL_ACCESS)) == NULL)
return (FALSE);
  if ((hService = OpenService(schSCManager, MY_SERVICE_NAME, SERVICE_ALL_ACCESS)) == NULL)
    return (FALSE);
  if (!DeleteService(hService))
    return (FALSE);
  if (!CloseServiceHandle(hService))
    return (FALSE);
  return (TRUE);
}

/*
** SERVICE EVENT HANDLER
*/
void WINAPI ServiceCtrlHandler(DWORD Opcode)
{
  switch (Opcode)
  {
    case SERVICE_CONTROL_PAUSE:
       g_ServiceStatus.dwCurrentState = SERVICE_PAUSED;
       break;
    case SERVICE_CONTROL_CONTINUE:
       g_ServiceStatus.dwCurrentState = SERVICE_RUNNING;
       break;
    case SERVICE_CONTROL_STOP:
       g_ServiceStatus.dwWin32ExitCode = 0;
       g_ServiceStatus.dwCurrentState = SERVICE_STOPPED;
       g_ServiceStatus.dwCheckPoint = 0;
       g_ServiceStatus.dwWaitHint = 0;
       SetServiceStatus (g_ServiceStatusHandle, &g_ServiceStatus);
       break;
    case SERVICE_CONTROL_INTERROGATE:
       break;
    default:
       break;
   }
}

/*
** SERVICE MAIN ENTRY
*/
void WINAPI ServiceMain(DWORD argc, LPTSTR *argv)
{
  g_ServiceStatus.dwServiceType = SERVICE_WIN32;
  g_ServiceStatus.dwCurrentState = SERVICE_START_PENDING;
  g_ServiceStatus.dwControlsAccepted = SERVICE_ACCEPT_STOP;
  g_ServiceStatus.dwWin32ExitCode = 0;
  g_ServiceStatus.dwServiceSpecificExitCode = 0;
  g_ServiceStatus.dwCheckPoint = 0;
  g_ServiceStatus.dwWaitHint = 0;
  g_ServiceStatusHandle = RegisterServiceCtrlHandler(MY_SERVICE_NAME, ServiceCtrlHandler);
  if (g_ServiceStatusHandle == (SERVICE_STATUS_HANDLE)0)
    return;
  g_ServiceStatus.dwCurrentState = SERVICE_RUNNING;
  g_ServiceStatus.dwCheckPoint = 0;
  g_ServiceStatus.dwWaitHint = 0;
  SetServiceStatus(g_ServiceStatusHandle, &g_ServiceStatus);

}

/*
** MAIN ENTRY
*/
int main(int argc, char* argv[])
{
  if (argc > 1)
  {
    if (!strcmp(argv[1], "-i"))
       if(InstallMyService())
           printf("\nService correctly installed\n");
   else
       printf("\nService uncorrectly installed\n");

    else if (!strcmp(argv[1], "-d"))
       if(DeleteMyService())
       printf("\nService correctly deleted\n");
   else
       printf("\nService uncorrectly deleted\n");
  }
  else
  {
     SERVICE_TABLE_ENTRY DispatchTable[]={{MY_SERVICE_NAME, ServiceMain}, {NULL, NULL}};
 StartServiceCtrlDispatcher(DispatchTable);
  }
  return (EXIT_SUCCESS);
} 
```

# ruby - 如何根据先前的输入创建下拉列表值？

> ID：15691155
> 
> 赞同：0
> 
> 时间：2013-03-28T20:05:30.517
> 
> 标签：ruby, ruby-on-rails-3, html, forms, ruby-on-rails-3.2

我需要一些有关 Rails 表格的帮助。我目前有：

```
<div class="field">
  <%= f.label :student_id %>
  <%= f.collection_select(:student_id, Student.active.order('first_name'), :id, :proper_name, :prompt => true) %>
</div>
<br />
<div class="field">
  <%= f.label :section_id %>
  <%= f.select(:section_id, get_section_list, :prompt => "Select Section") %>
</div> 
```

所以第一个下拉菜单是选择一个学生。第二个下拉列表是选择一个部分。但是，现在我正在显示所有部分。但我只想选择学生有资格参加的那些部分。那么如何获取第一个下拉列表的输入以更改第二个下拉列表选项。如果他们试图在不选择学生的情况下选择该部分，它应该显示所有选项。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T22:26:58.103

将选择框放入部分中，并在第一个选择框更改时重新渲染部分。

[http://keithschacht.com/getting-ajax-to-work-in-rails-3-with-jquery/](http://keithschacht.com/getting-ajax-to-work-in-rails-3-with-jquery/)

# java - 在外键上一对一休眠

> ID：15691156
> 
> 赞同：2
> 
> 时间：2013-03-28T20:05:31.487
> 
> 标签：java, hibernate, foreign-key-relationship, one-to-one, hbm

我有一个主表 D1，它的唯一 ID 为 d1Id。d1Id 唯一标识 D1 记录，也是表的主键。我有表 2，它是 D2，它有一个 d2seq 作为主键，但 D2 也有 d1Id，它是唯一的，它在 D1 上有一个外键约束（我认为）。但我确定它是独一无二的，并且 id 是相同的。当我使用休眠进行 D1 调用时，我试图检索 d2 值，但由于出现编译时错误，我无法为其获取正确的 hbm。

问题的底线是，我需要在 2 个表之间建立一对一的关系，其中在第二个表中，连接的 id 不是表的主键。我在谷歌上看到的所有示例都有第二个表上的 ID 也是第二个表的主键的情况。让我向您展示我现在拥有的 HBM 文件。

```
<hibernate-mapping default-lazy="true"
package="com.xxx.xx.customer.dto">
<class name="D1" table="D1" dynamic-update="true">
    <id name="dString" column="DID" type="java.lang.String"
        unsaved-value="null" length="9">
        <generator class="assigned"/>
    </id>
...

<one-to-one name="d2" class="com.xxx.xx.customer.dto.D2" >
        <!-- column name="d1Id" /-->
    </one-to-one> 
```

在 D2 的第二个 hbm 中，我被困在这里

```
<hibernate-mapping default-lazy="true" package="com.xxx.xx.customer.dto">
<class name="D2" table="D2" dynamic-update="true">
    <id name="id" column="D2ID" type="integer">
        <generator class="native">
            <param name="sequence">D2SEQ</param>
        </generator>
    </id>

<id name="d1id" column="D1ID" type="java.lang.String"
        unsaved-value="null" length="9">
        <generator class="assigned"/>
    </id> 
```

我显然不能在这里为 d1id 使用第二个 id 字段，因为 1> 它不是主键，并且 2> 我以前已经使用过它。那么我的 HBM 文件应该如何用于此操作？

同样，一旦我的 HBM 就位，我想在通过 DTO 查询 D1 时获取 D2 信息。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:31:43.470

为什么不能使用`@ManyToOne`关系？它通常提供比`@OneToOne`

# spring-mvc - 使用 Thymeleaf 的 Spring 3 静态资源映射

> ID：15691158
> 
> 赞同：2
> 
> 时间：2013-03-28T20:05:35.733
> 
> 标签：spring-mvc, spring-3, thymeleaf

我在使用 Spring 映射我的静态资源时遇到问题。我收到 404 错误。我的servlet代码如下

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="
 http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
 http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
 http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

<context:component-scan base-package="web.controller" />

<!-- Enabling Spring MVC configuration through annotations -->
<mvc:annotation-driven />

<!-- Mapping Static Resources -->
<mvc:resources mapping="/css/**" location="/resources/css/" />
<mvc:resources mapping="/js/**" location="/resources/js/" />
<mvc:resources mapping="/images/**" location="/resources/images/" />
<mvc:resources mapping="/oldcss/**" location="/resources/oldResources/css/" />
<mvc:resources mapping="/oldjs/**" location="/resources/oldResources/js/" />
<mvc:resources mapping="/oldimages/**" location="/resources/oldResources/images/" />

<bean id="templateResolver"
    class="org.thymeleaf.templateresolver.ServletContextTemplateResolver">
    <property name="prefix" value="/WEB-INF/views/" />
    <property name="suffix" value=".html" />
    <property name="templateMode" value="HTML5" />
</bean>

<bean id="templateEngine" class="org.thymeleaf.spring3.SpringTemplateEngine">
    <property name="templateResolver" ref="templateResolver" />
</bean>

<bean class="org.thymeleaf.spring3.view.ThymeleafViewResolver">
    <property name="templateEngine" ref="templateEngine" />
    <property name="order" value="1" />
</bean> 
```

我指的是静态对象——

```
<link rel="stylesheet" type="text/css" href="../oldcss/reset.css" th:href="@{/oldcss/reset.css}"/>
    <link rel="stylesheet" type="text/css" href="../oldcss/skeleton.css" th:href="@{/oldcss/skeleton.css}"/>
    <link rel="stylesheet" type="text/css" href="../oldcss/style.css" th:href="@{/oldcss/style.css}"/>
    <!-- Import JS -->
    <script src="../oldjs/jquery.min.js" th:src="@{/oldjs/jquery.min.js}"></script>
    <script src="../oldjs/responsiveslides.min.js" th:src="@{/oldjs/responsiveslides.min.js}"></script> 
```

谁能帮我找到可能的问题？提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T03:42:45.493

解决了这个问题...必须将 servlet 中的映射更改为

```
<mvc:resources mapping="/css/**" location="/WEB-INF/resources/css/" /> 
```

# vba - 如何将大量文件转换为 docx？

> ID：15691161
> 
> 赞同：0
> 
> 时间：2013-03-28T20:05:58.720
> 
> 标签：vba, ms-word, docx

我有大量想要转换为 docx 文件的 doc 文件。

我发现没有一种非常好的方法可以自动进行这种转换。

**我已经提交了我用来执行此操作的方法，但也许现在还有其他方法。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:05:58.720

我发现了一些可能有帮助的东西：

[微软批量转换器](http://blogs.msdn.com/b/ericwhite/archive/2008/09/19/bulk-convert-doc-to-docx.aspx)

[简单的 Microsoft Word 宏](http://answers.microsoft.com/en-us/office/forum/office_2007-word/is-it-possible-to-convert-a-batch-of-doc-files-to/8f5549be-8143-4f0a-8f82-06c855fcb092)

但是我对提供的宏不满意。我需要一些递归的东西来转换嵌套文件。所以我扩展它来做到这一点。

```
Sub SaveAllAsDOCX()

    'Search #EXT to change the extensions to save to docx

    Dim strDocName As String
    Dim strPath As String
    Dim oDoc As Document
    Dim fDialog As FileDialog
    Dim intPos As Integer

    'Create a folder dialog
    Set fDialog = Application.FileDialog(msoFileDialogFolderPicker)
    With fDialog
        .Title = "Select root folder and click OK"
        .AllowMultiSelect = False
        .InitialView = msoFileDialogViewList
        If .Show <> -1 Then
            MsgBox "Cancelled By User", , "List Folder Contents"
            Exit Sub
        End If

    'Select root folder
    strPath = fDialog.SelectedItems.Item(1)

    'Ensure the Folder Name ends with a "\"
    If Right(strPath, 1) <> "\" Then strPath = strPath + "\"

End With

'Close any open documents
If Documents.Count > 0 Then
    Documents.Close SaveChanges:=wdPromptToSaveChanges
End If

'remove any quotes from the folder string
If Left(strPath, 1) = Chr(34) Then
    strPath = Mid(strPath, 2, Len(strPath) - 2)
End If

'begin recusion
recurse (strPath)

End Sub

'This method controls the recusion
Function recurse(folder As String)

    'save all the files in the current folder
    SaveFilesInFolder (folder)

    'get all the subfolders of the current folder
    Dim folderArray
    folderArray = GetSubFolders(folder)

    'Loop through all the non-empty elements for folders
    For j = 1 To UBound(folderArray)
        If folderArray(j) <> "" Then
            'begin recusion on subfolder
            recurse (folder & folderArray(j) & "\")
        End If
    Next
End Function

'Saves all files with listed extensions
Function SaveFilesInFolder(folder As String)

    'List of extensions to look for #EXT
    Dim strFilename As String
    extsArray = Array("*.rtf", "*.doc")

    'Loop through extensions
    For i = 0 To (UBound(extsArray))

        'select the 1st file with the current extension
        strFilename = Dir(folder & extsArray(i), vbNormal)

        'double check the current extension (don't to resave docx files)
        Dim ext As String
        ext = ""
        On Error Resume Next
        ext = Right(strFilename, 5)

        If ext = ".docx" Or ext = "" Then
            'Don't need to resave files in docx format
    Else
        'Save the current file in docx format
        While Len(strFilename) <> 0
            Set oDoc = Documents.Open(folder & strFilename)
            strDocName = ActiveDocument.FullName
            intPos = InStrRev(strDocName, ".")
            strDocName = Left(strDocName, intPos - 1)
            strDocName = strDocName & ".docx"
            oDoc.SaveAs FileName:=strDocName, _
                FileFormat:=wdFormatDocumentDefault
            oDoc.Close SaveChanges:=wdDoNotSaveChanges

            strFilename = Dir
        Wend
    End If
    Next

    strFilename = ""
End Function

'List all the subfolders in the current folder
Function GetSubFolders(RootPath As String)
    Dim FS As New FileSystemObject
    Dim FSfolder As folder
    Dim subfolder As Variant

    Set FSfolder = FS.GetFolder(RootPath)

    'subfolders is variable length
    Dim subfolders() As String
    ReDim subfolders(1 To 10)

    Dim i As Integer
    i = LBound(subfolders)
    For Each subfolder In FSfolder.subfolders
        subfolders(i) = subfolder.Name

        'increase the size of subfolders if it's needed
        i = i + 1
        If (i >= UBound(subfolders)) Then
            ReDim subfolders(1 To (i + 10))
        End If

    Next subfolder

    Set FSfolder = Nothing

    GetSubFolders = subfolders

End Function 
```

是的，我知道这是很多代码。:)

# c# - Windows 8 RT 应用程序控件多次触发事件

> ID：15691176
> 
> 赞同：3
> 
> 时间：2013-03-28T20:06:29.300
> 
> 标签：c#, windows-runtime

我有一个基本的**图像**控件，我在 XAML 中添加到我正在制作的控件中。然后在我正在制作的控件中的**OnApplyTemplate**方法中，我向图像添加了一个*Tapped*事件处理程序。

```
(GetTemplateChild("PART_quarter") as Image).Tapped += tcNoteSelector_Tapped; 
```

在点击的事件处理程序中，我有以下代码：

```
System.Diagnostics.Debug.WriteLine("Sender: {0}", (sender as Image).Name);
e.Handled = true; 
```

我的问题是这会触发三次。我有多个使用相同处理程序的图像，它们都有相同的问题。我尝试注释掉除一条事件处理程序连线之外的所有内容，但这并没有什么不同。这是应该发生的还是我做错了什么？如果这应该发生，我应该如何从事件触发的多次中确定单个逻辑点击？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:43:47.353

`OnApplyTemplate`可以多次调用，因此它可以多次附加您的`Tap`事件处理程序。有点hacky，但是在大多数情况下删除然后添加事件处理程序应该可以确保事件处理程序只附加一次。

```
Image img = GetTemplateChild("PART_quarter") as Image;
if(img != null)
{
   img.Tapped -= tcNoteSelector_Tapped;
   img.Tapped += tcNoteSelector_Tapped;
} 
```

# autocad - 如何将AutoCAD绘图转换为图像？

> ID：15691186
> 
> 赞同：2
> 
> 时间：2013-03-28T20:06:53.793
> 
> 标签：autocad, autocad-plugin

我有一个 Autocad 绘图，它是一个土地方块的平面图，每个方块都包含一个数字。

我尝试通过选择将其转换为图像：文件->导出数据->和文件格式位图（bmp）。（我有 Autocad 2013 Mac 版）

文件转换为图像，但质量太差，放大图像时看不到正方形内的土地编号。

我也尝试过使用 Postscript（PS 文件格式），质量稍好一些，但仍然很差。

是否可以将 Autocad 文件转换为图像但仍保留它的高质量细节

我需要将文件转换为图像，因为我想在我的网站上在线发布它。可能还有其他方法可以在线发布autocad文件，如果有，请指教。但是我希望 autcad（计划）的背景是透明的，这样我就可以在谷歌地图上显示它。如果我使用 autocad 插件，我无法使其透明。对？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T02:08:36.717

使用 PLOT（用于当前图形）或 PUBLISH（用于批处理）命令生成高质量图像。

# java - 是否可以在同一个项目中使用 jersey 和 jax-ws

> ID：15691187
> 
> 赞同：1
> 
> 时间：2013-03-28T20:06:55.547
> 
> 标签：java, web-services, jax-ws, jax-rs

是否可以在同一个项目中使用 jersey(jax-rs) 和 jax-ws？我使用Jboss。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T23:30:08.410

当然。JAX-RS 和 JAX-WS 都是 JBoss 支持的 Java EE 标准（从 5.X.GA 或 4.X.EAP 开始）。所以从技术上讲，这不是问题。

如果您问“这是否有意义”，答案是 - 这取决于。如果您想为您的应用程序公开轻量级 API，那么使用 JAX-RS 的 REST Web 服务非常有意义。

如果您与第三方系统进行一些集成，并且您需要可靠消息传递、高级安全设置等特殊功能，那么您需要（或希望）对 Web 服务 API（根据 WSDL 和 XSD）进行精确描述，而不是通常的 JAX-WS SOAP/WSDL Web 服务更好（但并非总是如此）。

如果在您的应用程序中同时做这两件事，只需使用这两种技术。

# c# - WebClient：（System.Net.WebException）获取响应流时出错（ReadDone1）：ReceiveFailure

> ID：15691188
> 
> 赞同：3
> 
> 时间：2013-03-28T20:06:57.303
> 
> 标签：c#, asp.net-mvc, xamarin.ios, webrequest

这是一个 MonoTouch 应用程序。除了这个例外，我在现场看到了错误。我看到其他 SO questions，但似乎没有什么能解决我的问题。这可能与服务器上的 maxRequestLength 或 executionTimeout 有关吗？我真的没有想法...

我没有使用 WebRequest，我使用的是 WebClient。请帮忙！

**堆栈跟踪**

```
System.Net.WebException: Error getting response stream (ReadDone1): ReceiveFailure
  at System.Net.HttpWebRequest.EndGetResponse (IAsyncResult asyncResult) [0x00000] in <filename unknown>:0 
  at System.Net.HttpWebRequest.GetResponse () [0x00000] in <filename unknown>:0 
  at System.Net.WebClient.GetWebResponse (System.Net.WebRequest request) [0x00000] in <filename unknown>:0 
  at System.Net.WebClient.ReadAll (System.Net.WebRequest request, System.Object userToken) [0x00000] in <filename unknown>:0 
  at System.Net.WebClient.UploadFileCore (System.Uri address, System.String method, System.String fileName, System.Object userToken) [0x00000] in <filename unknown>:0 
  at System.Net.WebClient.UploadFile (System.Uri address, System.String method, System.String fileName) [0x00000] in <filename unknown>:0 
```

**客户端代码 (Monotouch)**

```
 public void UploadVideo(Guid organizationId, string path) {
        WebClient wc = new WebClient();
        var token = Convert.ToBase64String(Encoding.UTF8.GetBytes(string.Format("{0}:{1}", username, password)));
        var authHeader = string.Format("Basic {0}", token);
        wc.Headers.Add("Authorization", authHeader);
        var resource = string.Format("/organizations/{0}/SyncVideo/", organizationId);

        var fi = new FileInfo(path);            
        wc.UploadFile(restClient.BaseUrl + resource, "POST", path);
        wc.Dispose();            
    } 
```

**服务器代码 (ASP.Net MVC3)**

```
[HttpPost, Url("v3/organizations/{organizationId?}/SyncVideo/")]
public virtual JsonResult SyncVideo(HttpPostedFileBase file, Guid? organizationId) {
    if (organizationId.IsNull()) throw new HttpNotFoundExecption();
    if (organizationId != RESTContext.OrganizationId) throw new HttpNotAuthorizedException();

    var basePath = RESTContext.Config.VideoPath;

    using (new Impersonator(RESTContext.Config.VideoPathUsername, RESTContext.Config.VideoPathDomain,
        RESTContext.Config.VideoPathPassword)) {
        if (!Directory.Exists(basePath))
            Directory.CreateDirectory(basePath);
        file.SaveAs(basePath + @"\" + file.FileName);
    }
    return JsonSuccess();
} 
```

# ruby-on-rails - 如何收集我所属的群组成员拥有的所有主题？

> ID：15691189
> 
> 赞同：0
> 
> 时间：2013-03-28T20:07:04.233
> 
> 标签：ruby-on-rails, model-associations, ruby-on-rails-4

这对我来说可能很难解释，所以如果不清楚，请告诉我，以便我可以根据需要进行编辑！

我有以下示例：

```
class User < ActiveRecord::Base
  has_many :topics
  has_many :memberships
end

class Topic < ActiveRecord::Base
  belongs_to :user
end

#join model between User and Group
class Membership < ActiveRecord::Base
  belongs_to :user
  belongs_to :group
end

class Group < ActiveRecord::Base
  has_many :memberships
  has_many :members, :through => :memberships, :source => :user
  has_many :topics, :through => :members
end 
```

我遇到的问题是，我正在尝试为我`@feed_topics`所属的组的所有成员所拥有的所有主题创建一个提要 ()，而且我让自己有点发疯。

我应该尝试使用关联来实现这一点，还是在我的用户模型中创建一个具有一些 ActiveRecord/SQL 的实例方法来将所有组成员的主题合并到一个 ActiveRecord::Relation 对象中？

我的目标是写`current_user.feed_topics`在我的控制器的动作中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:42:01.127

抱歉没有早点解释！这个想法是利用“嵌套 has_many_through”来访问您的提要主题。这个概念记录在标题“嵌套关联”下： http: [//api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)。让我知道这是否仍然不清楚（或者如果它不起作用）。

```
class User < ActiveRecord::Base
  has_many :topics
  has_many :memberships
  has_many :groups, :through => :membership
  has_many :group_members, :through => :groups, :source => :member
  has_many :feed_topics, :through => :group_members, :source => :topic
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T23:21:51.777

到目前为止，这些是来自原始问题的模型的最终版本（主题和成员资格没有改变）：

```
class User < ActiveRecord::Base
  has_many :topics
  has_many :memberships
  has_many :groups, :through => :memberships
  has_many :feed_topics, :through => :groups, :source => :member_topics
end

class Group < ActiveRecord::Base
  has_many :memberships
  has_many :members, :through => :memberships, :source => :user
  has_many :member_topics, :through => :members, :source => :topics
end 
```

我现在正在通过添加更多组和成员来测试它是否会吸引其他组的所有其他成员的主题。

编辑：事情似乎工作正常。

EDIT2：我遇到的一个小问题是看到重复的主题，因为一个成员在多个组中。我了解了`:uniq => true`这一点，它挽救了这一天。

# java - 一种新的列表数据结构，针对任何地方的插入进行了优化？

> ID：15691191
> 
> 赞同：3
> 
> 时间：2013-03-28T20:07:12.893
> 
> 标签：java, arrays, algorithm, data-structures

我一直在寻找针对**任意**索引优化的列表数据结构，但我没有找到很多关于这个问题的信息，除了一些有趣的二叉树和很多痛苦的数组操作。

二叉树很有用，但我认为通用列表更适合此目的。无论如何，我不知道为什么它们不像树木那样被广泛使用。

然而，广义列表本身并不足以实现列表：它们必须具有可以保持它们清晰的属性，而不是在随机插入后在许多子列表中退化。

> **我建议这个属性**：*广义列表不能有与其包含列表相同或更多项目的子列表。如果违反了这个属性，如果我们将子列表的元素溢出到父列表中，它可以被恢复。*

例如**(1 2 3 (4 5 7 (9 1) 0))**是“不稳定的”，因为它的子列表比其父列表具有更多的“槽”（不递归计算元素）。可以使用先前提出的属性将其重写为**(1 2 3 4 5 7 (9 1) 0) 。**

此外，新元素将创建新的子列表，而不是直接添加到父列表中。例如：

如果一个新元素“x”被添加到索引 1

```
(1 2 3 5) 
```

那将是

```
(1 ("x" 2) 3 4) 
```

如果将“y”添加到索引 1，那么它将是

```
(1 (("y" "x") 2) 3 4) 
```

这是“不稳定的”，所以它会转化为

```
(1 ("y" "x" 2) 3 4) 
```

这也是不稳定的，所以它会转化为

```
(1 "y" "x" 2 3 4) 
```

我的问题是：**以前是否已经描述过这种数据结构？**我的意思是，我认为它真的很有用，而且几乎是**微不足道**的。如果它以前存在，为什么不那么为人所知？ **真的有用吗？**它有名字吗？我确实认为它很有用，但我可能错了。

我[以持久的方式实现了它](https://github.com/fluorine/SpongeList)，但是我的代码（Java）有点混乱和丑陋，尽管它似乎可以工作并且它也被记录在案。你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:14:08.483

这听起来类似于跳过列表：[http ://en.wikipedia.org/wiki/Skip_list](http://en.wikipedia.org/wiki/Skip_list)

# php - 如何在php中调用成员函数query()？

> ID：15691194
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:07:20.717
> 
> 标签：php, mysqli

我有一个从名为 db 的基类扩展的应用程序类。当我尝试创建实例时，出现错误

> 在非对象上调用成员函数 query()。

我的应用程序类是：

```
Class Application extends DB
{

public $sql;

 /*
  * Public Methods
 */
/*
 * Constructor
 */
function Application() {
    global $sql;

    $sql = db::getInstance();
}

function selectSqli($access_table){
    $result = $sql->query("select * from $access_table");
    return $result;
} 
```

}

我的数据库类是：

```
class db extends mysqli{
protected static $instance;
protected static $options = array();

private function __construct() {
    $db = self::$options;

    // turn of error reporting
    mysqli_report(MYSQLI_REPORT_OFF);

    // connect to database
    @parent::__construct(isset($db['host'])   ? $db['host']   : 'localhost',
                         isset($db['user'])   ? $db['user']   : 'root',
                         isset($db['pass'])   ? $db['pass']   : '',
                         isset($db['dbname']) ? $db['dbname'] : 'angler_blog_post');

    // check if a connection established
    if( mysqli_connect_errno() ) {
        throw new exception(mysqli_connect_error(), mysqli_connect_errno()); 
    }
}

public static function getInstance() {
    if( !self::$instance ) {
        self::$instance = new self(); 
    }
    return self::$instance;
}

public function query($query) {
    if( !$this->real_query($query) ) {
        throw new exception( $this->error, $this->errno );
    }

    $result = new mysqli_result($this);
    return $result;
}
} 
```

我尝试了 global，plublic，但我无法访问函数 query()。如何解决这个错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-04T11:21:32.693

你应该更好地注入你的数据库对象而不是使用`global $sql;`

但在你的情况下，`$sql`是一个局部变量，而不是属性。正如您在构造函数中声明的那样`$this->sql`：`$sql`当前对象的属性现在包含 DB 对象的实例。

所以，它应该是：

```
function selectSqli($access_table){
    $result = $this->sql->query("select * from $access_table");
    return $result;
} 
```

还有，你可能不知道一些关于 PHP 5 的消息，因为使用类似于类名的方法名来实现构造函数，在 PHP 5 中你应该使用一个特殊的方法`__construct() {}`，即构造函数。

在 OOP 中查看 PHP 5 的新功能：[http ://www.php.net/manual/en/language.oop5.php](http://www.php.net/manual/en/language.oop5.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-04T11:10:21.423

```
function selectSqli($access_table){
    global $sql;
    $result = $sql->query("select * from $access_table");
    return $result;
} 
```

或者，如果您使用 OOP：

```
Class Application extends DB
{

public $sql;

 /*
  * Public Methods
 */
/*
 * Constructor
 */
function Application() {
    $this->sql = db::getInstance();
}

function selectSqli($access_table){
    $result = $this->sql->query("select * from $access_table");
    return $result;
}
} 
```

# sockets - 在 Socket UDP 上使用 Getaddrinfo() 和 SendTo() 失败 - 分段错误（核心转储）

> ID：15691197
> 
> 赞同：0
> 
> 时间：2013-03-28T20:07:27.450
> 
> 标签：sockets, struct, udp, sendto, getaddrinfo

在我开始使用 getaddrinfo() 检索动态 IP 地址后，我的套接字的 sendTo() 不再工作并返回错误“分段错误（核心转储）”。为什么会这样，请问我的代码中是否缺少任何初始化或内存分配？我已经尝试了一段时间，但还没有弄清楚原因。任何帮助将非常感激！

这是代码的一部分：

```
 // variables declaration
    int s;
    struct sockaddr_in si_other;
    struct addrinfo hints;     
    struct addrinfo *result, *rp;
    char *hostname = "localhost"; 
    const char* portnum = "8000"; 

    // settings of hints
    memset(&hints, 0, sizeof(struct addrinfo));
    hints.ai_family = AF_UNSPEC;    /* Allow IPv4 or IPv6 */
    hints.ai_socktype = SOCK_DGRAM; /* Datagram socket */
    hints.ai_flags = 0;
    hints.ai_protocol = 0;
    hints.ai_flags = AI_NUMERICSERV;

    // resolve dynamically IP adress by getaddrinfo()
    s = getaddrinfo(hostname, NULL, &hints, &result); 
    if (s != 0) {
            fprintf(stderr, "getaddrinfo: %s\n", gai_strerror(s));exit(EXIT_FAILURE);
    }
    // create socket s
    for (rp = result; rp != NULL; rp = rp->ai_next) 
    {
            s = socket(rp->ai_family, rp->ai_socktype, rp->ai_protocol);
    }

    // loop for sending m x struct ECA_message_t 
    int m=0;
for (; m<NbMesPerFile; ++m) 
    {

            ECA_message_t* ECA_paquet;
            ECA_paquet=(ECA_message_t*)malloc(sizeof(ECA_message_t)*2400); 
            // 2400 to workaround some not understood memory issue and make sendto() to 
            // work  

            // function initializing ECA_paquet
            Client_update_ECA_data(ECA_paquet,m);
            if (sendto(s, ECA_paquet, sizeof(ECA_paquet)*2400, 0 ,(struct 
                  sockaddr*)&si_other,slen)==-1)
    {
        perror("sendto()");
    }
    } 
```

要向我的结构添加详细信息，并找出我的 malloc(sizeof(ECA_message_t) 出错的原因，请参阅下面的 struct ECA_message_t 代码：

```
typedef struct{

unsigned int version:2;
unsigned int p:1;
unsigned int x:1;
unsigned int cc:4;
unsigned int m:1;
unsigned int pt:7;
unsigned int seq:16;
u_int32_t timestamp;
u_int32_t ssrc;
u_int32_t csrc;
} RTP_header_t;             // 16 bytes

typedef struct {

unsigned int version:2;
unsigned int reserved_1:6;
unsigned int reserved_2:8;
unsigned int number_sample:16;

}ECA_header_t;              // 4 bytes

typedef struct {

//every line composed of 6 values, 2 byte per value, all signed
int32_t v_phase_1;
int32_t v_phase_2;
int32_t v_phase_3;
int32_t i_phase_1;
int32_t i_phase_2;
int32_t i_phase_3;

}ECA_payload_t;             // 12 bytes

typedef struct {

RTP_header_t rtp_header;
ECA_header_t eca_header;
ECA_payload_t eca_payload[MAX_ECA_SAMPLES]; // MAX_ECA_SAMPLES of 100

}ECA_message_t;             // 1220 bytes 
```

这是中止（核心转储）回溯消息：

```
*** glibc detected *** ./clientUDPIniDyn: double free or corruption (!prev): 0x081768c8 ***
 ======= Backtrace: =========
 /lib/i386-linux-gnu/libc.so.6(+0x75ee2)[0xb7642ee2]
 ./clientUDPIniDyn[0x804896b]
 /lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0xb75e64d3]
 ./clientUDPIniDyn[0x80486b1]
 ======= Memory map: ========
 08048000-0804a000 r-xp 00000000 08:01 1319522    /home/lin/ULB/Memoire/Client_Server
 /Server/clientUDPIniDyn
 0804a000-0804b000 r--p 00001000 08:01 1319522    /home/lin/ULB/Memoire/Client_Server
 /Server/clientUDPIniDyn
 0804b000-0804c000 rw-p 00002000 08:01 1319522    /home/lin/ULB/Memoire/Client_Server
 /Server/clientUDPIniDyn
 08176000-08197000 rw-p 00000000 00:00 0          [heap]
 b7589000-b75a5000 r-xp 00000000 08:05 264147     /lib/i386-linux-gnu/libgcc_s.so.1
 b75a5000-b75a6000 r--p 0001b000 08:05 264147     /lib/i386-linux-gnu/libgcc_s.so.1
 b75a6000-b75a7000 rw-p 0001c000 08:05 264147     /lib/i386-linux-gnu/libgcc_s.so.1
 b75bf000-b75ca000 r-xp 00000000 08:05 293796     /lib/i386-linux-gnu/libnss_files-
 2.15.so
 b75ca000-b75cb000 r--p 0000a000 08:05 293796     /lib/i386-linux-gnu/libnss_files-
 2.15.so
 b75cb000-b75cc000 rw-p 0000b000 08:05 293796     /lib/i386-linux-gnu/libnss_files-
 2.15.so
 b75cc000-b75cd000 rw-p 00000000 00:00 0 
 b75cd000-b7770000 r-xp 00000000 08:05 293791     /lib/i386-linux-gnu/libc-2.15.so
 b7770000-b7771000 ---p 001a3000 08:05 293791     /lib/i386-linux-gnu/libc-2.15.so
 b7771000-b7773000 r--p 001a3000 08:05 293791     /lib/i386-linux-gnu/libc-2.15.so
 b7773000-b7774000 rw-p 001a5000 08:05 293791     /lib/i386-linux-gnu/libc-2.15.so
 b7774000-b7777000 rw-p 00000000 00:00 0 
 b778d000-b7791000 rw-p 00000000 00:00 0 
 b7791000-b7792000 r-xp 00000000 00:00 0          [vdso]
 b7792000-b77b2000 r-xp 00000000 08:05 293804     /lib/i386-linux-gnu/ld-2.15.so
 b77b2000-b77b3000 r--p 0001f000 08:05 293804     /lib/i386-linux-gnu/ld-2.15.so
 b77b3000-b77b4000 rw-p 00020000 08:05 293804     /lib/i386-linux-gnu/ld-2.15.so
 bfbad000-bfbce000 rw-p 00000000 00:00 0          [stack]
 Aborted (core dumped) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T07:21:03.267

这是固定代码，使用 calloc() 不会再出现分段错误

```
for (rp = result; rp != NULL; rp = rp->ai_next) 
{
     s = socket(rp->ai_family, rp->ai_socktype, rp->ai_protocol); // socket creation

     ECA_message_t* ECA_paquet;
     ECA_paquet=calloc(NbMesPerFile, sizeof(* ECA_paquet)); // calloc to assign table [NbMesPerFile] length bloc memory for my struct EA_message_t

     // sending m paquets of my struct 
     int m=0;
     for (; m<NbMesPerFile; ++m) 
     {

         Client_update_ECA_data(ECA_paquet,m);  //update the ECA data paquet

         if (sendto(s,ECA_paquet, sizeof(*ECA_paquet) ,0, rp->ai_addr,rp->ai_addrlen)==-1) // send data ECA data pointed by ECA_paquet
         {
             perror("sendto()");
         }
     }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T23:10:13.817

```
// create socket s
for (rp = result; rp != NULL; rp = rp->ai_next) 
{
        s = socket(rp->ai_family, rp->ai_socktype, rp->ai_protocol);
} 
```

您在这里泄漏文件描述符（套接字）。循环的每次迭代`s`都会重新分配。并且之前的 s 值丢失了。（我不知道你的链表有多长）

```
// loop for sending m x struct ECA_message_t 
int m=0;
for (; m<NbMesPerFile; ++m) 
    {

            ECA_message_t* ECA_paquet;
            ECA_paquet=(ECA_message_t*)malloc(sizeof(ECA_message_t)*2400); 
            // 2400 to workaround some not understood memory issue and make sendto() to 
            // work  

            // function initializing ECA_paquet
            Client_update_ECA_data(ECA_paquet,m);
            if (sendto(s, ECA_paquet, sizeof(ECA_paquet)*2400, 0 ,(struct 
                  sockaddr*)&si_other,slen)==-1)
    {
        perror("sendto()");
    }
} 
```

你在这里泄漏内存。循环的每次迭代`ECA_paquet`都会重新分配。并且 ECA_paquet 之前的值丢失了。永远。（不知道有多大`NbMesPerFile`）

（这可能不是你的段错误的原因，但它至少表明质量不合格）你也不应该转换 malloc()**的返回值**，(+ `#include <stdlib.h>`, , 加上检查 malloc() 的返回值。并打开警告编译器的级别。

# javascript - 使用 jQuery 从 HTML 创建 JSON 对象

> ID：15691205
> 
> 赞同：3
> 
> 时间：2013-03-28T20:08:05.017
> 
> 标签：javascript, jquery, json, html-parsing, scrape

## 问题概述

假设我有一批糖果。货物有多个盒子，每个盒子都有许多独特的糖果类型。每个盒子都有一个唯一的 id，与其他盒子不同；糖果类型也是如此。此外，糖果还具有其他特征，例如颜色、风味和数量。

## 示例代码

以以下 HTML 示例为例：

```
<div class="shipment">
    <div class="box" data-boxid="a">
        <div class="candy" data-candyid="1" data-color="orange" data-flavor="orange" data-qty="7">
            <!-- unimportant content -->
        </div>
        <div class="candy" data-candyid="2" data-color="red" data-flavor="strawberry" data-qty="4">
            <!-- unimportant content -->
        </div>
    </div>
    <div class="box" data-boxid="b">
        <div class="candy" data-candyid="3" data-color="green" data-flavor="lime">
            <!-- unimportant content -->
        </div>
    </div>
</div> 
```

## 以前的尝试

我已经看到了使用 jQuery`.map()`函数进行表解析的类似示例，并且我也看到了提到`.each()`，但我无法生成任何工作代码。

## 期望的输出

我想（使用 jQuery）生成*类似于*以下内容的 JSON 对象：

```
{
    "shipment": {
        "a": {
            "1": {
                "color": "orange",
                "flavor": "orange",
                "qty": "7"
            },
            "2": {
                "color": "red",
                "flavor": "strawberry",
                "qty": "4"
            }
        },
        "b": {
            "3": {
                "color": "green",
                "flavor": "lime"
            }
        }
    }
} 
```

## 补充笔记

**我的应用程序已经广泛使用了 jQuery，因此它似乎是适合这项工作的合乎逻辑的工具。** 但是，如果纯 'ol JavaScript 是更合适的选择，请随意说。

HTML 总是格式正确的，并且总是遵循指定的格式。但是，在某些情况下，信息可能不完整。 **请注意，第三个糖果没有指定数量，因此在构建对象时会简单地忽略数量。**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-28T20:39:15.413

这会生成您要求的内容：

```
var json = {};   

$('.shipment').each(function(i,a) {
    json.shipment = {};

    $(a).find('.box').each(function(j,b) {
        var boxid = $(b).data('boxid');
        json.shipment[boxid] = {};

        $(b).find('.candy').each(function(k,c) {
            var $c = $(c),
                candyid = $c.data('candyid'),
                color = $c.data('color'),
                flavor = $c.data('flavor'),
                qty = $c.data('qty');
            json.shipment[boxid][candyid] = {};
            if (color) json.shipment[boxid][candyid].color = color;
            if (flavor) json.shipment[boxid][candyid].flavor = flavor;
            if (qty) json.shipment[boxid][candyid].qty = qty;
        });
   });
}); 
```

[http://jsfiddle.net/mblase75/D22mD/](http://jsfiddle.net/mblase75/D22mD/)

如您所见，在每个级别上，它都用于`.each()`循环遍历与某个类匹配的元素，然后`.find().each()`循环遍历所需的子元素。在这两者之间，`.data()`用于抓取所需的`data-`属性，并逐级构建 json 对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T20:15:13.127

这是否接近您正在寻找的内容？– [http://jsfiddle.net/4RPHL/](http://jsfiddle.net/4RPHL/)

我已经使用`data()`并`JSON.stringify`创建了 json。

请务必检查我记录输出的控制台。

```
$(".candy").each(function() {
    console.log(JSON.stringify($(this).data()))
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T21:51:54.767

好问题！多亏了克里斯的帖子，我才能让它工作。

```
var shipments = [],
    shipment  = {},
    boxes = {},
    candy = {};
$(".shipment").each(function() {
    var shipment = {},
        boxes = {};
    $(this).children().each(function(){
        var boxdata = $(this).data();
        candy = {};
        $(this).children().each(function(){
            var candydata = $(this).data();
            candy[candydata["candyid"]] = {
                color: candydata["color"],
                flavor: candydata["flavor"],
                qty: candydata["qty"]
            };
            boxes[boxdata["boxid"]] = candy;
        });
        //console.log(JSON.stringify(boxes)); // works
    });
    shipment = {shipment: boxes};
    shipments.push(shipment); // for multiples
});

console.log(JSON.stringify(shipments[0]));
console.log(shipments.length);  // 1 for the example html above 
```

# ios - 字符串 ios 的整数格式化程序

> ID：15691207
> 
> 赞同：-3
> 
> 时间：2013-03-28T20:08:10.637
> 
> 标签：ios, objective-c, nsstring, nslog

我想知道以下代码的结果是什么

```
NSString *str = @"0";
NSString *str1 = @"12";
NSLog(@"str int value %d, %d",str, str1); 
```

我得到的结果是 18036, 18052

我在代码中使用了错误的格式说明符并遇到了这个奇怪的结果。我后来修好了。但我想知道它到底打印了什么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:10:37.747

> `NSLog(@"str int value %d, %d",str, str1);`

您将指向字符串的指针作为参数传递，但格式字符串指定整数。一个很好的猜测是指针将被解释为整数，因此输出将取决于字符串恰好在内存中分配的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:10:41.200

我猜它打印出字符串指针地址

# r - 性能提升

> ID：15691216
> 
> 赞同：2
> 
> 时间：2013-03-28T20:08:32.940
> 
> 标签：r, data.table

我正在尝试获取基于滞后/转发的功能应用程序。我广泛使用`data.table`，我什至有工作代码，但是知道`data.table`我认为必须有一种更简单的方法来实现同样的功能，并可能提高性能（我在函数内部创建了很多变量）。以下是函数的工作代码（可在[https://gist.github.com/tomaskrehlik/5262087#file-gistfile1-r](https://gist.github.com/tomaskrehlik/5262087#file-gistfile1-r)中获得）

```
# Lag-function lags the given variable by the date_variable

lag_variable <- function(data, variable, lags, date_variable = c("Date")) {
    if (lags == 0) {
      return(data)
    }
    if (lags>0) {
      name <- "lag"
    } else {
      name <- "forward"
    }
    require(data.table)
    setkeyv(data, date_variable)
    if (lags>0) {
      data[,index:=seq(1:.N)]  
    } else {
      data[,index:=rev(seq(1:.N))]
    }
    setkeyv(data, "index")
    lags <- abs(lags)
    position <- which(names(data)==variable)
    for ( j in 1:lags ) {
      lagname <- paste(variable,"_",name,j,sep="")
      lag <- paste("data[, ",lagname,":=data[list(index-",j,"), ",variable,", roll=TRUE][[",position,"L]]]", sep = "")
      eval(parse( text = lag ))
    }
    setkeyv(data, date_variable)
    data[,index:=NULL]
}

# window_func applies the function to the lagged or forwarded variables created by lag_variable
window_func <- function(data, func.name, variable, direction = "window", steps, date_variable = c("Date"), clean = TRUE) {
    require(data.table)
    require(stringr)
    transform <- match.fun(func.name)
    l <- length(names(data))
    if (direction == "forward") {
      lag_variable(data, variable, -steps, date_variable)
      cols <- which((!(is.na(str_match(names(a), paste(variable,"_forward(",paste(1:steps,collapse="|"),")",sep=""))[,1])))*1==1)
    } else {
      if (direction == "backward") {
        lag_variable(data, variable, steps, date_variable)
        cols <- which((!(is.na(str_match(names(a), paste(variable,"_lag(",paste(1:steps,collapse="|"),")",sep=""))[,1])))*1==1)
      } else {
        if (direction == "window") {
          lag_variable(data, variable, -steps, date_variable)
          lag_variable(data, variable, steps, date_variable)
          cols <- which((!(is.na(str_match(names(a), paste(variable,"_lag(",paste(1:steps,collapse="|"),")",sep=""))[,1])))*1==1)
          cols <- c(cols,which((!(is.na(str_match(names(a), paste(variable,"_forward(",paste(1:steps,collapse="|"),")",sep=""))[,1])))*1==1))
        } else {
          stop("The direction must be either backward, forward or window.")
        }
      }
    }
    data[,transf := apply(data[,cols, with=FALSE], 1, transform)]
    if (clean) {
      data[,cols:=NULL,with=FALSE]
    }
    return(data)
}

# Typical use:
# I have a data.table DT with variables Date (class IDate), value1, value2
# I want to get cumulative sum of next five days
# window_func(DT, "sum", "value1", direction = "forward", steps = 5) 
```

**编辑：**示例数据可以通过以下方式创建：

```
a <- data.table(Date = 1:1000, value = rnorm(1000)) 
```

对于每个 Date （这里是整数只是一个例子，并不重要），我想创建*下十个观察值的总和*。要运行代码并获取输出，请执行以下操作：

```
window_func(data = a, func.name = "sum", variable = "value", 
      direction = "forward", steps = 10, date_variable = "Date", clean = TRUE) 
```

该函数首先获取变量并创建十个滞后变量（使用 function `lag_variable`），然后按列应用函数并自行清理。代码很臃肿，因为我有时只需要在滞后观察上使用函数，有时在前向观察上使用函数，有时在两者上都使用函数，这称为窗口。

有什么建议可以更好地实施吗？我的代码似乎太大了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T21:27:32.677

我不确定您的其余功能，但您可以相当有效地获得滞后总和，如下所示：

```
a[ , lagSum := 
       a[, list(sum=sum(value)), by=list(grp=(Date+lag-i) %/% lag)] [grp!=0, sum]
   , by=list(i=Date %% lag)] 
```

* * *

例如：

```
set.seed(1)
a[ , lagSum := 
       a[, list(sum=sum(value)), by=list(grp=(Date+lag-i) %/% lag)] [grp!=0, sum]
   , by=list(i=Date %% lag)]

> a
      Date      value      lagSum
   1:    1 -0.6264538  1.32202781
   2:    2  0.1836433  3.46026279
   3:    3 -0.8356286  3.66646270
   4:    4  1.5952808  3.88085074
   5:    5  0.3295078  0.07087005
  ---                            
 996:  996 -0.3132929 -3.79332038
 997:  997 -0.8806707 -3.48002750
 998:  998 -0.4192869 -2.59935677
 999:  999 -1.4827517 -2.18006988
1000: 1000 -0.6973182 -1.88854602 
```

* * *

确认正确的值：

```
# first n values
n <- 5
for (i in seq(n))
  a[seq(i, length.out=10), print(sum(value))]

#  [1] 1.322028
#  [1] 3.460263
#  [1] 3.666463
#  [1] 3.880851
#  [1] 0.07087005 
```

* * *

### 基准（针对循环，所以不太公平）

```
set.seed(1)
a <- data.table(Date = 1:1000, value = rnorm(1000))

system.time({    a[ , lagSum := 
           a[, list(sum=sum(value)), by=list(grp=(Date+lag-i) %/% lag)] [grp!=0, sum]
       , by=list(i=Date %% lag)]
})

#  user  system elapsed 
# 0.049   0.001   0.056 

set.seed(1)
a <- data.table(Date = 1:1000, value = rnorm(1000))

system.time({    for (i in seq(nrow(a)-lag+1))
      a[seq(i, length.out=10), lagSum := sum(value)]})

#  user  system elapsed 
# 1.526   0.019   2.220 
```

# javascript - 画布未正确调整为 div 的大小（滚动条问题？？）

> ID：15691221
> 
> 赞同：0
> 
> 时间：2013-03-28T20:08:58.207
> 
> 标签：javascript, canvas, resize, scroll

我不知道是否有人注意到这一点，但我会试一试。

因为画布的行为与其他 HTML 元素不同，所以我使用 resize 事件而不是 CSS 来调整它的大小。这个效果很好，

除非将浏览器的大小从最大化调整为正常，在这种情况下画布小于 div。区别在于

滚动条的宽度。事实上，当我使画布足够大以强制使用滚动条时，这不会发生。

这与调整大小事件的时间有关吗？有人知道如何解决吗？

# 编辑

这适用于 IE9（右侧）和 Safari（底部和右侧）。但不适用于 Chrome 和 FF。

在这里拉小提琴->[拉小提琴](http://jsfiddle.net/HxVWJ/)

# /编辑

```
window.onload = function()
{
    canvas = document.getElementById("canvas");
    context = canvas.getContext("2d");
    window.addEventListener('resize', doTheResize, false);
}

function doTheResize()
{
    canvas.width = div.clientWidth;
    canvas.height = div.clientHeight;
    drawThings();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T22:32:41.817

使用[getBoundingClientRect](https://developer.mozilla.org/en-US/docs/DOM/element.getBoundingClientRect)获取宽度和高度并使画布具有该大小。

**[现场演示](http://fiddle.jshell.net/j7nCY/4/)**

[全屏](http://fiddle.jshell.net/j7nCY/4/show/light/)

## 标记

```
<div class="container">
    <canvas id="canvas"></canvas>
</div> 
```

## CSS

```
html, body {
    width:100%;
    height:100%;
    padding:0;
    margin:0;
}
.container {
    height:100%;
    width:600px;
} 
```

## JS

```
var canvas = document.getElementById("canvas"),
    ctx = canvas.getContext("2d");

canvas.width = canvas.parentNode.getBoundingClientRect().width;
canvas.height = canvas.parentNode.getBoundingClientRect().height;

ctx.fillRect(0, 0, canvas.width, canvas.height);

window.onresize = function () {
    canvas.width = canvas.parentNode.getBoundingClientRect().width;
    canvas.height = canvas.parentNode.getBoundingClientRect().height;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
} 
```

# ios - 试飞中显示的 iOS 版本错误

> ID：15691222
> 
> 赞同：7
> 
> 时间：2013-03-28T20:08:58.367
> 
> 标签：ios, testflight, ios6.1

我的 iPhone 运行的是 iOS 6.1.3，但测试飞行将 iOS 版本捕获为 6.0.1，并拒绝安装为 6.1 构建的应用程序。如果可能，请提出一些解决方案来进行刷新。

# node.js - Mongoose，更新对象数组中的值

> ID：15691224
> 
> 赞同：131
> 
> 时间：2013-03-28T20:09:01.443
> 
> 标签：node.js, mongodb, mongoose

有没有办法更新对象中的值？

```
{
  _id: 1,
  name: 'John Smith',
  items: [{
     id: 1,
     name: 'item 1',
     value: 'one'
  },{
     id: 2,
     name: 'item 2',
     value: 'two'
  }]
} 
```

假设我想更新 id = 2 的项目的名称和值项目；

我尝试了以下 w/猫鼬：

```
var update = {name: 'updated item2', value: 'two updated'};
Person.update({'items.id': 2}, {'$set':  {'items.$': update}}, function(err) { ... 
```

这种方法的问题在于它更新/设置了整个对象，因此在这种情况下我丢失了 id 字段。

猫鼬有更好的方法来设置数组中的某些值但不理会其他值吗？

我也只查询了这个人：

```
Person.find({...}, function(err, person) {
  person.items ..... // I might be able to search through all the items here and find item with id 2 then update the values I want and call person.save().
}); 
```

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2013-03-28T20:54:08.183

你很近；您应该在使用[`$`更新运算符](https://docs.mongodb.com/manual/reference/operator/update/positional/)时使用点符号来做到这一点：

```
Person.update({'items.id': 2}, {'$set': {
    'items.$.name': 'updated item2',
    'items.$.value': 'two updated'
}}, function(err) { ... 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2017-03-14T03:56:47.023

```
model.update(
    { _id: 1, "items.id": "2" },
    {
        $set: {
            "items.$.name": "yourValue",
            "items.$.value": "yourvalue",
         }
    }
) 
```

[MongoDB 文档](https://docs.mongodb.com/manual/reference/operator/update/positional/)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2019-07-16T17:12:31.373

有一种猫鼬方法可以做到这一点。

```
const itemId = 2;
const query = {
  item._id: itemId 
};
Person.findOne(query).then(doc => {
  item = doc.items.id(itemId );
  item["name"] = "new name";
  item["value"] = "new value";
  doc.save();

  //sent respnse to client
}).catch(err => {
  console.log('Oh! Dark')
}); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2019-05-29T10:08:24.673

要记住一件事，当您根据多个条件搜索数组中的对象时，请使用**$elemMatch**

```
Person.update(
   {
     _id: 5,
     grades: { $elemMatch: { grade: { $lte: 90 }, mean: { $gt: 80 } } }
   },
   { $set: { "grades.$.std" : 6 } }
) 
```

这是[文档](https://docs.mongodb.com/manual/reference/operator/update/positional/)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-03-28T20:55:29.293

对于每个文档，更新运算符`$set`可以[设置多个值](http://docs.mongodb.org/manual/reference/method/db.collection.update/)`items`，因此您可以单独设置对象的`name`和`value`字段，而不是替换数组中的整个对象。

```
{'$set':  {'items.$.name': update.name , 'items.$.value': update.value}} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-04-29T03:52:12.990

下面是一个如何更动态地更新对象数组中的值的示例。

```
Person.findOneAndUpdate({_id: id}, 
{ 
  "$set": {[`items.$[outer].${propertyName}`]: value} 
},
{ 
  "arrayFilters": [{ "outer.id": itemId }]
},
function(err, response) {
  ...
}) 
```

`arrayFilters`请注意，通过这样做，您可以通过添加额外的位置运算符来更新嵌套数组的更深层次，如下所示：

```
"$set": {[`items.$[outer].innerItems.$[inner].${propertyName}`]: value} 

"arrayFilters":[{ "outer.id": itemId },{ "inner.id": innerItemId }] 
```

* * *

更多用法可以在[官方文档](https://docs.mongodb.com/manual/reference/operator/update/positional-filtered/)中找到。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-27T14:52:59.203

在 Mongoose 中，我们可以使用`$set`内部 dot( `.`) 表示法将数组值更新为特定值，方法如下

```
db.collection.update({"_id": args._id, "viewData._id": widgetId}, {$set: {"viewData.$.widgetData": widgetDoc.widgetData}}) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-26T17:36:28.760

尝试过其他效果很好的解决方案，但他们的答案的陷阱是只有已经存在的字段会更新，添加 upsert 不会做任何事情，所以我想出了这个。

```
 Person.update({'items.id': 2}, {$set: {
    'items': { "item1",  "item2",  "item3",  "item4" } }, {upsert: 
true }) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-12T10:33:45.463

我有类似的问题。这是最干净的方法。

```
 const personQuery = {
       _id: 1  
    }

    const itemID = 2;

    Person.findOne(personQuery).then(item => {
       const audioIndex = item.items.map(item => item.id).indexOf(itemID);
       item.items[audioIndex].name = 'Name value';
       item.save();
    }); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-12-10T16:17:37.237

使用点对象找到了这个解决方案，它帮助了我。

```
import dot from "dot-object";

const user = await User.findByIdAndUpdate(id, { ...dot.dot(req.body) }); 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-09-07T07:59:09.270

在猫鼬中我们可以更新，比如简单的数组

```
user.updateInfoByIndex(0,"test")

User.methods.updateInfoByIndex = function(index, info) ={
    this.arrayField[index]=info
    this.save()
} 
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2018-08-13T13:31:20.223

```
update(
    {_id: 1, 'items.id': 2},
    {'$set': {'items.$[]': update}},
    {new: true}) 
```

这是有关以下内容的文档`$[]`：[https://docs.mongodb.com/manual/reference/operator/update/positional-all/#up。*年代*[]](https://docs.mongodb.com/manual/reference/operator/update/positional-all/#up._S_[])

# asp.net - 如何为系统编写开发人员测试（单元测试、集成测试等）？

> ID：15691225
> 
> 赞同：1
> 
> 时间：2013-03-28T20:09:08.727
> 
> 标签：asp.net, unit-testing, testing, service, tdd

我有一个 WCF 服务，它运行并与数据库、文件系统和一些外部 Web 服务交互，然后创建结果并对其进行 Xml 序列化并最终返回它。

我想为这个解决方案编写测试，我正在考虑如何（这一切都使用依赖注入和合同设计）。

我可以采取 3 种主要方法。

1）我可以选择最小的代码/方法单元并为其编写测试。选择一个类并将其与其依赖项（其他类等）隔离开来。虽然它保证了质量，但编写它们需要大量时间，而且速度很慢。

2）只使与外部系统的交互可模拟，并编写一些涵盖从发出请求到响应被序列化并返回的主要场景的测试。这将测试我的类之间的所有交互，但会模拟所有外部资源访问。

3) 我可以设置一个测试环境，在该环境中确实发生与外部 Web 服务的交互、发生文件访问、发生数据库访问等。然后从头到尾编写测试。这需要环境设置和对所有其他系统的依赖才能启动和运行。

关于#1，我认为将时间/金钱/精力投入到为我拥有的每一种方法或代码编写测试上是没有意义的。我的意思是这是浪费时间。

关于#3，由于它依赖于外部资源/系统，因此很难设置和运行。

#2，听起来对我来说是最好的选择。因为它将测试它应该测试的内容。只有我的系统及其所有类和模拟所有其他外部系统。

所以基本上，经过几年的单元测试经验后，我得出的结论是，编写单元测试是一种需要避免的浪费，相反，孤立的系统测试是最好的投资回报。

即使我要先编写测试（TDD）然后是生产代码，我认为仍然#2 是最好的。

您对此有何看法？您会为您的应用程序编写小型单元测试吗？您是否认为这是一种良好的做法和对时间/预算/精力的最佳利用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:24:06.820

如果你想谈论*质量*，你应该拥有所有 3 个：

1.  单元测试以确保您的代码按照您的想法执行，暴露任何边缘情况并帮助[回归](http://en.wikipedia.org/wiki/Software_regression)。您（开发人员）应该编写这样的测试。
2.  集成测试以验证整个过程的正确性，组件*之间*是否正确通信等。同样，您作为开发人员编写此类测试。
3.  在类生产环境中进行系统范围的测试（自然会有一些限制 - 您可能无法访问客户端数据库，但您应该在本地机器上拥有其*精确副本）。*这些测试通常由专门的测试人员编写（通常使用不同于应用程序代码的编程语言），但当然也可以由您编写。

第二种和第三种类型的测试（集成和系统）对于测试较小组件的*边缘情况*来说将是太多的努力。这就是你通常想要的单元测试。您需要集成，因为连接经过测试、验证和正确的模块可能会失败。当然，系统测试是您每天在开发过程中所做的事情，或者是指派人员（手动测试人员）来做这件事。

从列表中选择类型的测试可能会在某种程度上起作用，但远非完整的解决方案或质量软件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T21:18:26.577

所有 3 个都很重要，并且针对不同的测试类型，即单元/集成/系统类别的矩阵，每个类别都有正面和负面的测试。

对于代码覆盖率，单元测试将产生最高百分比，其次是集成，然后是系统。

您还需要考虑测试的目的是验证（将满足最终用户\客户的要求，即价值）还是验证（写入规范，即正确）。

总而言之，答案是“视情况而定”，我建议遵循 SEI CMMi 验证和确认模型（即测试），该模型从每个活动的目标（价值）开始，然后对该活动进行最终允许整体过程需要持续改进。通过这种方式，您将“什么”和“为什么”与“如何”隔离开来，并且您将能够针对您的给定环境（可以是生命支持系统或当天的推文，向您最喜欢的阿姨、应用程序）回答时间和价值类型的问题）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-05T05:55:42.740

**摘要**：#2（集成测试）似乎是最合乎逻辑的，但您应该毫不犹豫地使用各种测试来实现对最需要它的代码库的最佳覆盖。为对“一切”进行测试而拍摄并不是一个有价值的目标。

**长版**

有一种思想流派，开发人员坚信采用单元\集成\系统测试意味着努力测试每一个被测试的代码。它要么根本没有测试覆盖率，要么致力于测试“一切”。这种二元思维总是使采用任何类型的测试策略看起来都非常昂贵。

事实是，强制测试每一行代码\函数\模块与尽可能快地编写所有代码一样合理。这需要太多的时间和精力，而且大部分收益都很少。另一个事实是，您永远无法在一个重要的项目中实现真正的 100% 覆盖。

测试本身并不是目标。这是实现其他目标的一种手段：最终产品质量、可维护性、互操作性等，同时花费尽可能少的工作量。

考虑到这一点，退后一步并评估您的特定情况。为什么要“为此解决方案编写测试”？您对今天项目的整体质量不满意吗？你经历过高回归率吗？您是否不确定某些模块是如何工作的（更重要的是，它可能有什么错误）？无论您的确切目标是什么，您都应该能够选择具有特殊挑战的作品并将注意力集中在它们上。根据这些部分是什么，可以选择适当的测试方法。

如果您有一个特别棘手的函数或类，请考虑对它们进行单元测试。如果您面临具有多个难以理解的交互的复杂架构，请考虑编写集成测试来为您最棘手的场景建立一个干净的基线，并更好地了解问题的根源（您可能会清除一些错误）道路）。如果您的问题没有在更本地化的测试中得到解决，系统测试会有所帮助。

根据您为特定场景提供的信息，面向外部的单元测试\集成测试（#2）看起来最有希望。似乎您有很多外部依赖项，所以我猜这是大多数复杂性隐藏的地方。综合单元测试（＃1）是＃2的超集，所有额外的内部内容都带有可疑的价值。#3（完整系统测试）可能不允许您按照您的意愿测试外部边缘情况\错误条件。

# batch-file - 使用不同的命名方案重命名多个文件夹

> ID：15691226
> 
> 赞同：1
> 
> 时间：2013-03-28T20:09:15.070
> 
> 标签：batch-file

我有很多按日期命名的图片文件夹，日期格式为 03282013，表示 2013 年 3 月 28 日。

我已经开始使用更明显且易于排序的命名方案 2013-03-28，即 2013 年 3 月 28 日。

有没有直接的方法，使用批处理文件，使用新格式重命名我所有的旧文件夹？

示例：将 03282013 重命名为 2013-03-28 等等

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T05:50:27.440

下面的批处理文件将当前目录中的所有文件夹从 MMDDYYYY 格式重命名为 YYYY-MM-DD 格式：

```
@echo off
setlocal EnableDelayedExpansion
for /F %%a in ('dir /B /AD') do (
   set name=%%a
   ren %%a !name:~4!-!name:~0,2!-!name:~2,2!
) 
```

安东尼奥

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T22:12:08.253

试试这个，如果输出正常，删除最后一个`echo`（之前）：`ren`

```
@echo off &setlocal
for /f "tokens=1,2" %%a in ('for /f "delims=" %%i in ^('dir /ad /b .^^^| findstr /b [0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]$'^) do ^
@set "fname=%%i"^&^
@call set "month=%%fname:~0,2%%"^&^
@call set "day=%%fname:~2,2%%"^&^
@call set "year=%%fname:~-4%%"^&^
@call set "fname=%%year%%-%%month%%-%%day%%"^&^
@call echo "%%~i" "%%fname%%"') do echo ren "%%~a" "%%~b" 
```

这将搜索正确的 MMDDYYYY 格式的文件夹，所有其他文件夹保持不变。

# javascript - 在 node.js 中使用参数时，对象没有方法“减少”错误？

> ID：15691234
> 
> 赞同：10
> 
> 时间：2013-03-28T20:09:32.083
> 
> 标签：javascript, node.js

为什么这样使用时会出错`arguments`？

```
function sum(){
    return arguments.reduce(function(a,b){
        console.log(a+b)
        return a+b;
    },0);
}

sum(1,2,3,4); 
```

错误：

```
/Users/bob/Documents/Code/Node/hello.js:2
return arguments.reduce(function(a,b){
                 ^
TypeError: Object #<Object> has no method 'reduce'
    at sum (/Users/bob/Documents/Code/Node/hello.js:2:19)
    at Object.<anonymous> (/Users/bob/Documents/Code/Node/hello.js:8:1)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Function.Module.runMain (module.js:497:10)
    at startup (node.js:119:16)
    at node.js:903:3 
```

这是来自 Crockford 先生的[JS 讲座](http://www.youtube.com/watch?NR=1&feature=endscreen&v=ya4UHuXNygM)。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-28T20:11:10.753

`arguments`不是真正的数组，它是“类数组”对象，`reduce`不是类数组对象的方法。您可以`reduce`通过`arguments`作为上下文传递来使用，如下所示：

```
[].reduce.call(arguments, function(a, b) {

}); 
```

**编辑：在**[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Predefined_Core_Objects#Working_with_Array-like_objects)上有关类似数组的对象的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-25T16:27:36.247

Crockford 明确指出，在 ECMAscript 5 中引入了在参数上使用诸如 reduce() 之类的 Array 方法。在 ECMAscript5 之前，甚至 Array 在所有 Javascript 实现中都没有 reduce()。对于 map() 和 reduce() 之类的东西，我建议使用像 Underscore 这样的库来隐藏实现差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:13:34.813

你得到一个错误，因为`arguments`是一个对象而不是一个列表。考虑以下：

```
> function a(){ return arguments; }
> b = a(1, 2, 3);
> b
{ '0': 1,
  '1': 2,
  '2': 3 } 
```

* * *

MDN JavaScript 文档[`arguments`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/arguments)有更多信息，包括：

> 对应于传递给函数的参数的类数组对象。

# jsf - Servlet 3.0 在应用程序启动时不加载

> ID：15691240
> 
> 赞同：0
> 
> 时间：2013-03-28T20:09:53.897
> 
> 标签：jsf, jsf-2, servlet-3.0

我有一个在 tomcat 7.0.29 中运行的 JSF 2.0 Web 应用程序，并尝试使用 Servlet 3.0 注释，但 servlet 不起作用，因为我看不到它的 init() 方法中写入的日志。

我已经阅读了很多相同问题的答案，但仍然没有成功。

这是我的文件的外观：

web.xml ：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app metadata-complete="false"
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0">
  <display-name>GestionCongesFeki</display-name>
  <welcome-file-list>
    <welcome-file>index.xhtml</welcome-file>
  </welcome-file-list>
  <servlet>
    <servlet-name>Faces Servlet</servlet-name>
    <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>
  <servlet-mapping>
    <servlet-name>Faces Servlet</servlet-name>
    <url-pattern>*.xhtml</url-pattern>
  </servlet-mapping>

<!--   <servlet> -->
<!--     <servlet-name>AjaxRelaisServlet</servlet-name> -->
<!--     <servlet-class>utils.AjaxRelaisServlet</servlet-class> -->
<!--     <load-on-startup>2</load-on-startup> -->
<!-- </servlet> -->
<!-- <servlet-mapping> -->
<!--     <servlet-name>AjaxRelaisServlet</servlet-name> -->
<!--     <url-pattern>/AjaxRelaisServlet/*</url-pattern> -->
<!-- </servlet-mapping> -->

</web-app> 
```

pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>esprit.pfe2013</groupId>
  <artifactId>GestionCongesFeki</artifactId>
  <packaging>war</packaging>
  <version>0.0.1-SNAPSHOT</version>
  <name>GestionCongesFeki Maven Webapp</name>
  <url>http://maven.apache.org</url>

<repositories>
        <repository>
            <id>central</id>
            <name>Maven Repository Switchboard</name>
            <layout>default</layout>
            <url>http://repo1.maven.org/maven2</url>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
        </repository>       
        <repository>
            <id>prime-repo</id>
            <name>Prime Repo</name>
            <url>http://repository.primefaces.org</url>
        </repository>
    </repositories>
    <pluginRepositories>
        <pluginRepository>
            <id>central</id>
            <name>Maven Plugin Repository</name>
            <url>http://repo1.maven.org/maven2</url>
            <layout>default</layout>
            <snapshots>
                <enabled>false</enabled>
            </snapshots>
            <releases>
                <updatePolicy>never</updatePolicy>
            </releases>
        </pluginRepository>
    </pluginRepositories>

<!--   <repositories> -->
<!-- <repository> -->
<!--            <id>central</id> -->
<!--            <name>Central Repository</name> -->
<!--            <url>http://repo.maven.apache.org/maven2</url> -->
<!--            <layout>default</layout> -->
<!--            <snapshots> -->
<!--                <enabled>false</enabled> -->
<!--            </snapshots> -->
<!--        </repository> -->

<!--    </repositories> -->

    <dependencies>

         <dependency>
           <groupId>javax.servlet</groupId>
           <artifactId>javax.servlet-api</artifactId>
           <version>3.0.1</version>        
         </dependency>

        <!-- PrimeFaces -->
        <dependency>
            <groupId>org.primefaces</groupId>
            <artifactId>primefaces</artifactId>
            <version>3.4.1</version>
        </dependency>

        <!-- JSF 2 -->
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-api</artifactId>
            <version>2.1.11</version>
        </dependency>
        <dependency>
            <groupId>com.sun.faces</groupId>
            <artifactId>jsf-impl</artifactId>
            <version>2.1.11</version>
        </dependency>

        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
        </dependency>
        <dependency>
            <groupId>taglibs</groupId>
            <artifactId>standard</artifactId>
            <version>1.1.2</version>
        </dependency>

        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>5.1.13</version>
        </dependency>

        <dependency>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-resources-plugin</artifactId>
    <version>2.4.3</version>
</dependency>

    </dependencies>
    <build>
    <finalName>GestionCongesFeki</finalName>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
        </plugins>
    </build>  

</project> 
```

和小服务程序：

```
package utils;

import java.io.IOException;

import javax.servlet.Servlet;
import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class AjaxRelaisServlet
 */
@WebServlet("/AjaxRelaisServlet") 
public class AjaxRelaisServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see HttpServlet#HttpServlet()
     */
    public AjaxRelaisServlet() {
        super();
        // TODO Auto-generated constructor stub
    }

    /**
     * @see Servlet#init(ServletConfig)
     */
    public void init(ServletConfig config) throws ServletException {
        System.out.println("This is AjaxRelaisServlet initialisaton !!!");
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
    }

} 
```

实际上，当我在 web.xml（注释代码）中声明它时，servlet 工作正常，但当我使用注释时却没有。顺便说一句，我想知道当这个问题得到解决时我是否可以摆脱 web.xml，但我不知道如果没有它，JSF servlet 将如何声明。

感谢帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T16:41:51.290

`loadOnStartup=1`将该属性添加到您的`@WebServlet`注释中，以使 servlet 在应用程序启动时加载。此属性类似于`<load-on-startup/>`您将在*web.xml*中找到的元素。

```
 @WebServlet(name="AjaxRelaisServlet",loadOnStartup=1,urlPatterns={"/AjaxRelaisServlet"}) 
```

> 当你有一把锤子时，每一个问题看起来都像钉子。

在完全替换*web.xml*的问题上，您应该意识到基于注释的模型目前无法实现的一些事情。例如，仅使用注释（AFAIK）无法实现过滤器排序。此外，您应该意识到具体的配置文档是自记录的。您系统的维护者可以查看 web.xml 并了解您的应用程序中发生了什么，配置明智。将其与仅注释架构进行对比。弄清楚系统所有部分的布线将是一项艰巨的任务。

# sql - 在 SQL 中创建临时表

> ID：15691243
> 
> 赞同：56
> 
> 时间：2013-03-28T20:10:06.900
> 
> 标签：sql, postgresql, temp-tables

我正在尝试创建一个临时表，它只选择某个特定的数据`register_type`。我写了这个查询，但它不起作用：

```
$ CREATE TABLE temp1
(Select 
    egauge.dataid,
    egauge.register_type,
    egauge.timestamp_localtime,
    egauge.read_value_avg
from rawdata.egauge
where register_type like '%gen%'
order by dataid, timestamp_localtime ) $ 
```

我正在使用 PostgreSQL。
你能告诉我查询有什么问题吗？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2013-03-29T09:40:11.430

您可能想要[**`CREATE TABLE AS`**](https://www.postgresql.org/docs/current/sql-createtableas.html)- 也适用于`TEMPORARY`( `TEMP`) 表：

```
CREATE TEMP TABLE temp1 **AS**
SELECT dataid
     , register_type
     , timestamp_localtime
     , read_value_avg
FROM   rawdata.egauge
WHERE  register_type LIKE '%gen%'
ORDER  BY dataid, timestamp_localtime;
```

这将创建一个临时表并将数据复制到其中。请注意，数据的*静态快照*。它就像一个普通的表，但如果`temp_buffers`设置得足够高，它会驻留在 RAM 中。它仅在当前*会话*中可见，并在会话结束时消失。当用它创建时，`ON COMMIT DROP`它会在*事务*结束时死掉。

临时表首先出现在默认**模式搜索路径**中，隐藏其他同名的可见表，除非模式限定：

*   [search_path 如何影响标识符解析和“当前模式”](https://stackoverflow.com/questions/9067335/how-does-the-search-path-influence-identifier-resolution-and-the-current-schema/9067777#9067777)

* * *

如果你想要*动态*，你会寻找[**`CREATE VIEW`**](https://www.postgresql.org/docs/current/sql-createview.html)一个完全不同的故事。

* * *

SQL 标准也定义了，Postgres 也支持：~~[`SELECT INTO`](https://www.postgresql.org/docs/current/sql-selectinto.html)~~. [但不鼓励使用它](https://www.postgresql.org/docs/current/sql-selectinto.html#AEN78092)：

> 最好`CREATE TABLE AS`在新代码中用于此目的。

实际上不需要第二个语法变体，`SELECT INTO`它用于在 中进行赋值`plpgsql`，因此 SQL 语法是不可能的。

有关的：

*   [将两个表合并为一个新表，以便忽略从另一个表中选择的行](https://stackoverflow.com/questions/15559090/combine-two-tables-into-a-new-one-so-that-select-rows-from-the-other-one-are-ign/15560009#15560009)
*   [错误：具有默认值的输入参数在 Postgres 中也必须具有默认值](https://stackoverflow.com/questions/24038195/error-input-parameters-after-one-with-a-default-value-must-also-have-defaults/24072348#24072348)

* * *

[**`CREATE TABLE LIKE (...)`**](https://www.postgresql.org/docs/current/sql-createtable.html)只从另一个表复制*结构，没有数据：*

> 该`LIKE`子句指定一个表，新表会自动从该表中复制所有列名、它们的数据类型和它们的非空约束。

* * *

如果您仅出于单个查询的目的需要一个“临时”表（然后丢弃它），那么 CTE 或子查询中的**“派生表”**的开销要少得多：

*   [手动更改postgresql中查询的执行计划？](https://stackoverflow.com/questions/14982120/change-the-execution-plan-of-query-in-postgresql-manually/14983685#14983685)
*   [在 PostgreSQL 中合并两个 SELECT 查询](https://stackoverflow.com/questions/15849423/combine-two-select-queries-in-postgresql/15850396#15850396)
*   [重用计算的选择值](https://stackoverflow.com/questions/21863163/reuse-computed-select-value/21863334#21863334)
*   [单个查询中的多个 CTE](https://stackoverflow.com/questions/35248217/multiple-cte-in-single-query/35249370#35249370)
*   [用另一个 sql 的结果更新](https://stackoverflow.com/questions/25350431/update-with-results-of-another-sql/25354243#25354243)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-28T20:20:49.013

[http://www.postgresql.org/docs/9.2/static/sql-createtable.html](http://www.postgresql.org/docs/9.2/static/sql-createtable.html)

```
CREATE TEMP TABLE temp1 LIKE ... 
```

# php - 检测请求是否来自不同域或子域的最佳方法

> ID：15691247
> 
> 赞同：2
> 
> 时间：2013-03-28T20:10:14.933
> 
> 标签：php

我正在构建一个应用程序，该应用程序使用位于数据库中的用户子域和自定义域名，因此如果请求来自另一个域，我将从数据库中检查该自定义 URL 是否确实存在或请求来自一个子域，我会检查它是否存在。如果是我做我的事。

考虑一下我正在寻找的一个简单示例：

```
if(is_user_request())
{
    $url = get_url();
    // assuming that get_url() magically decides whether to output ..
    // a custom domain (http://domain.tld)
    // or a subdomain's first part (eg. "this".domain.tld)
}
else
{
    // otherwise it's not a sub domain nor a custom domain,
    // so we're dealing with our own main site.
} 
```

现在在你继续假设因为我有 0 代表之前，我在这里要求“teh 代码”。我有一种完全可行的方法，如下所示：

```
// hosts
$hosts = explode('.', $_SERVER['HTTP_HOST']);

// if there is a subdomain and that's under our $sitename
if(!empty($hosts[1]) AND $hosts[1] === Config::get('domain_mid_name'))
{
    $url = $hosts[0];
    $url_custom = false;
}

 // if there is no subdomain, but the domain is our $sitename
 elseif(!empty($hosts[0]) AND $hosts[0] === Config::get('domain_mid_name') AND !empty($hosts[1]) AND $hosts[1] !== Config::get('domain_mid_name'))
    {
    $url = false;
    $url_custom = false;
}

// otherwise it's most likely that the request
// came from a entirely different domain name.
// which means it's probably $custom_site
else
{
    $url = false;
    $url_custom = implode('.', $hosts);
}

if($url)
{
    return $url;
}

if($url_custom)
{
    return $url_custom;
} 
```

但是，我确信有更好的方法可以做到这一点。因为首先，HTTP_HOST 不包含'http://'，所以我需要手动添加它，我很确定这整个 if，否则事情只是一个矫枉过正。所以，比我聪明的人，请赐教。

哦，不……我没有预定义的子域。我设置了一个简单的通配符 *.domain.tld，因此所有子域都转到主脚本。我之所以这么说，是因为在我寻找解决方案的过程中，我发现了许多建议手动创建子域的答案，这甚至与我所要求的内容无关，所以让我们跳过这个主题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:17:27.427

`$_SERVER['HTTP_HOST']`除非您想将不同的参数从 Web 服务器传递到 PHP，否则这是正确的方法。

至于协议，请注意请求协议应该由`$_SERVER['HTTPS']`而不是假设它是`http`.

对于提取子域，您可以查看使用[`array_shift`](http://php.net/array_shift)然后运行

```
$subdomain = array_shift(explode('.', $_SERVER['HTTP_HOST'])); 
```

但通常你所拥有的是应该如何去做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T20:41:26.993

正如已经说过的，`$_SERVER['HTTP_HOST']`是要走的路。

但是您的代码中有错误。您假设发送的主机名包含 2 或 3 个组件，但您不能确定这一点。你至少`count($hosts)`也应该检查一下。

例如，如果您将 domain.tld 用于您自己的网站，那么您最好先检查是否`domain.tld`已发送（快速返回您的页面）；然后看看是否`substr($_SERVER['HTTP_HOST']...,-11)==='.domain.tld'`，如果是，返回子站点（适用于任何级别的子域，仍然很快）；否则错误恢复，因为已将一个完全陌生的域路由给您。需要注意的关键是从层次结构顶部进行域匹配意味着匹配主机名字符串右对齐：

```
 .domain.tld | subsite-pattern
   sub12.domain.tld | MATCH
   sub12.dumain.tld | NO MATCH
    sub12domain.tld | NO MATCH 
```

# c# - 从 C# 与英特尔的新 DRNG（RDRAND 指令）交互的方式？

> ID：15691251
> 
> 赞同：6
> 
> 时间：2013-03-28T20:10:31.123
> 
> 标签：c#, random, cryptography, intel, rdrand

我希望从 C# 程序集中使用英特尔的数字随机数生成器（Ivy Bridge 中的 RDRAND 指令）。我查看了 cpp 库，但我希望有一个更“托管”的解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:27:00.350

我能找到的最好的在这里：

*   [Rdrand 手册和库（Windows* 版本）](http://software.intel.com/en-us/articles/user-manual-for-the-rdrand-library-windows-version)
*   [Rdrand 手册和库（Linux* 和 OS X* 版本）](http://software.intel.com/en-us/articles/user-manual-for-the-rdrand-library-linux-version)

您可以自己下载和编译（链接等）。如果您认识了解 C++ 的人，请从 C# 中`extern`为 s 编写一些方法。`P/Invoke`

# c++ - 如何以高效快捷的方式为号码添加前缀并删除？

> ID：15691253
> 
> 赞同：0
> 
> 时间：2013-03-28T20:10:36.530
> 
> 标签：c++, algorithm, boost, stl

如何以高效快捷的方式为号码添加前缀并删除？（数字可以有任意位数，数字没有限制）我有数字，例如 122121，我想在开头添加数字 9 为 9122121，之后我需要删除数字中的第一个数字。我已拆分为向量，推前数字（在本例中为 9）和从数字创建数字（迭代乘以 10）。有没有更有效的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:25:23.123

如果您想要效率，请不要使用除数字、向量、字符串等之外的任何其他内容。在您的情况下：

```
#include <iostream>

unsigned long long add_prefix( unsigned long long number, unsigned prefix )
{
    // if you want the example marked (X) below to print "9", add this line:
    if( number == 0 ) return prefix;

    // without the above, the result of (X) would be "90"

    unsigned long long tmp = ( number >= 100000 ) ? 1000000 : 10;
    while( number >= tmp ) tmp *= 10;
    return number + prefix * tmp;
}

int main()
{
    std::cout << add_prefix( 122121, 9 ) << std::endl; // prints 9122121
    std::cout << add_prefix( 122121, 987 ) << std::endl; // prints 987122121
    std::cout << add_prefix( 1, 9 ) << std::endl; // prints 91
    std::cout << add_prefix( 0, 9 ) << std::endl; // (X) prints 9 or 90
} 
```

但要注意溢出。如果没有溢出，上述内容甚至适用于多位前缀。我希望你能找出反向算法来删除前缀。

* * *

**已编辑：**正如 Andy Prowl 指出的那样，可以将 0 解释为“无数字”，因此前缀不应*后跟*数字 0。但我想这取决于 OPs 用例，因此我相应地编辑了代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T20:24:22.797

您可以使用 floor(log10(number)) + 1 计算位数。因此代码如下所示：

```
int number = 122121;
int noDigits = floor(log10(number)) + 1;
//Add 9 in front
number += 9*pow(10,noDigits);
//Now strip the 9
number %= pow(10,noDigits); 
```

我希望我做对了一切；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T22:03:40.150

我将提供一个使用二分搜索的答案和迄今为止提供的答案的一个小基准。

## 二进制搜索

以下函数使用二进制搜索来查找所需数字的位数并将所需数字附加到其前面。

```
int addPrefix(int N, int digit) {
    int multiplier = 0;
    // [1, 5]
    if(N <= 100000) {
        // [1, 3]
        if(N <= 1000) {
            //[1, 2]
            if(N <= 100) {
                //[1, 1]
                if(N <= 10) {
                    multiplier = 10;
                //[2, 2]
                } else {
                    multiplier = 100;
                }
            //[3, 3]
            } else {
                multiplier = 1000;
            }
        //[4, 4]
        } else if(N <= 10000) {
            multiplier = 10000;
        //[5, 5]
        } else {
            multiplier = 100000;
        }
    //[6, 7]
    } else if(N <= 10000000) {
        //[6, 6]
        if(N <= 1000000) {
            multiplier = 1000000;
        //[7, 7]
        } else {
            multiplier = 10000000;
        }
    //[8, 9]
    } else {
        //[8, 8]
        if(N <= 100000000) {
            multiplier = 100000000;
        //[9, 9]
        } else {
            multiplier = 1000000000;
        }
    }
    return N + digit * multiplier;
} 
```

它比较冗长。`int`但是，它会在最多 4 次比较的范围内找到数字的位数。

## 基准

我创建了一个小型基准测试，针对 4.5 亿次迭代运行每个提供的算法，每个确定的位数进行 5000 万次迭代。

```
int main(void) {
    int i, j, N = 2, k;
    for(i = 1; i < 9; ++i, N *= 10) {
        for(j = 1; j < 50000000; ++j) {
            k = addPrefix(N, 9);
        }
    }
    return 0;
} 
```

结果：

```
+-----+-----------+-------------+----------+---------+
| run | Alexander | Daniel Frey | kkuryllo | W.B.    |
+-----+-----------+-------------+----------+---------+
| 1st |    2.204s |      3.983s |   5.145s | 23.216s |
+-----+-----------+-------------+----------+---------+
| 2nd |    2.189s |      4.044s |   5.081s | 23.484s |
+-----+-----------+-------------+----------+---------+
| 3rd |    2.197s |      4.232s |   5.043s | 23.378s |
+-----+-----------+-------------+----------+---------+
| AVG |    2.197s |      4.086s |   5.090s | 23.359s |
+-----+-----------+-------------+----------+---------+ 
```

[您可以在此处找到本要点中使用的来源](https://gist.github.com/aeurielesn/6cff01aac21367d6520c)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T20:20:39.887

使用 boost 中的词法转换怎么样？这样你就不用自己做迭代了。

[http://www.boost.org/doc/libs/1_53_0/doc/html/boost_lexical_cast.html](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_lexical_cast.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-28T20:27:52.547

%首先找到比你的数字大 10 的最大幂。然后乘以那个加法并添加到您的号码

例如：

```
int x;
int addition;
int y = 1;
while (y <= x)
{
    y *= 10;
}

x += addition * y; 
```

我没有测试此代码，因此仅作为示例...我也不太了解您的其他说明，您需要澄清一下。

编辑好吧我想我明白你也想在某个时候删除第一个数字。您可以使用类似的方法来执行此操作。

```
int x;
int y = 1;
while (y <= x*10)
{
    y *= 10;
}

x %= y; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-28T20:29:32.893

您可以将数字放在 std::string 中并使用 insert 和 delete 但这可能有点矫枉过正

# c# - TCPListener 不接受客户端

> ID：15691258
> 
> 赞同：2
> 
> 时间：2013-03-28T20:10:43.723
> 
> 标签：c#, tcp, tcpserver

我在 C# 中运行 TCP 服务器。该程序似乎为新客户端运行并保持（它在 TcpClient 客户端 = this.tcpListener.AcceptTcpClient(); 上停止）等待新连接。但是，如果我检查网络（使用 netstat 命令），服务器没有在监听，这意味着没有运行。我也尝试了不同的端口，但我想端口 80 应该更适合测试（我也尝试过其他端口，但都没有工作）。我的代码有什么问题？也许操作系统阻止了服务器？

```
namespace TCPServer
{
    class TestClass
    {
        static void Main(string[] args)
        {
            Server TCPServer = new Server();
            // Display the number of command line arguments:
            System.Console.WriteLine(args.Length);
        }
    }

    class Server
    {
        private TcpListener tcpListener;
        private Thread listenThread;

        public Server()
        {
            this.tcpListener = new TcpListener(IPAddress.Any, 80);
            this.listenThread = new Thread(new ThreadStart(ListenForClients));
            this.listenThread.Start();
            System.Console.WriteLine("Server started");
        }

        //starts the tcp listener and accept connections
        private void ListenForClients()
        {
            this.tcpListener.Start();
            System.Console.WriteLine("Listener started");

            while (true)
            {
                System.Console.WriteLine("Accepting Clients");
                //blocks until a client has connected to the server
                TcpClient client = this.tcpListener.AcceptTcpClient();
                System.Console.WriteLine("Client connected");

                //create a thread to handle communication 
                //with connected client
                Thread clientThread = new Thread(new ParameterizedThreadStart(HandleClientComm));
                clientThread.Start(client);
            }
        }

        //Read the data from the client
        private void HandleClientComm(object client)
        {
            TcpClient tcpClient = (TcpClient)client; //start the client
            NetworkStream clientStream = tcpClient.GetStream(); //get the stream of data for network access

            byte[] message = new byte[4096];
            int bytesRead;

            while (true) 
            {
                bytesRead = 0;

                try
                {
                    //blocks until a client sends a message
                    bytesRead = clientStream.Read(message, 0, 4096);
                }
                catch
                {
                    //a socket error has occured
                    break;
                }

                if (bytesRead == 0) //if we receive 0 bytes
                {
                    //the client has disconnected from the server 
                    break;
                }

                //message has successfully been received
                ASCIIEncoding encoder = new ASCIIEncoding();
                System.Diagnostics.Debug.WriteLine(encoder.GetString(message, 0, bytesRead));

                //Reply
                byte[] buffer = encoder.GetBytes("Hello Client!");
                clientStream.Write(buffer, 0, buffer.Length);
                clientStream.Flush();
            }

            tcpClient.Close();
        }

    }
} 
```

**更新：** 我将应用程序配置为获得防火墙豁免。我在windows7中运行。我还检查了端口 3000 并且没有在该端口上监听。我使用 netstat 输出来确定它是否在监听。

# php - 使用 PHP SDK 在 facebook.com/dialog/oauth 上出现错误 500

> ID：15691259
> 
> 赞同：1
> 
> 时间：2013-03-28T20:10:46.777
> 
> 标签：php, facebook, facebook-graph-api, login

facebook.com 上的 oauth 对话框页面正在生成 500 错误。我们有一些使用 Graph API 的 Web 应用程序，它们都遇到了同样的错误。

完整的 URL 是：https://www.facebook.com/dialog/oauth?client_id=[app_id]&scope=publish_actions&display=page&redirect_uri=https%3A%2F%2Fwww.mydomain.com%2Fcallback%2F&state=[unique_number]。

我们创建了一个新的测试应用程序，那里也发生了完全相同的情况。我们使用最新的 Facebook PHP SDK。我们在此过程中不使用 JavaScript。我们尝试了不同的范围参数，但没有任何区别。

这个过程一直持续到 2013 年 3 月 27 日晚些时候或 2013 年 3 月 28 日早些时候的某个时间。然后它开始消除 500 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-02T02:34:07.460

另外，如果你有一个新的应用程序。确保将其设置为公开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T23:23:46.020

这可能与此 FaceBook 错误有关：[https](https://developers.facebook.com/bugs/491147611024519) ://developers.facebook.com/bugs/491147611024519 （500 oauth 错误）

# c++ - 为什么我会收到此错误？“未解决的外部符号”

> ID：15691263
> 
> 赞同：0
> 
> 时间：2013-03-28T20:10:59.773
> 
> 标签：c++, visual-c++, compiler-errors

这是我一直遇到的错误，我一直在试图弄清楚如何解决它但失败了。我在问是否有人可以指出我正确的方向。

```
 WorldServer fatal error LNK1120: 2 unresolved externals
WorldServer error LNK2019: unresolved external symbol "public: class CItemElem * __thiscall CLinkedItemMgr::GetLinkedItem(unsigned long)" (?GetLinkedItem@CLinkedItemMgr@@QAEPAVCItemElem@@K@Z) referenced in function "private: void __thiscall CDPSrvr::OnLinkedItem(class CAr &,unsigned long,unsigned long,unsigned char *,unsigned long)" (?OnLinkedItem@CDPSrvr@@AAEXAAVCAr@@KKPAEK@Z)
WorldServer error LNK2019: unresolved external symbol "public: int __thiscall CLinkedItemMgr::AddLinkedItem(class CItemElem *)" (?AddLinkedItem@CLinkedItemMgr@@QAEHPAVCItemElem@@@Z) referenced in function "private: void __thiscall CDPSrvr::OnLinkedItem(class CAr &,unsigned long,unsigned long,unsigned char *,unsigned long)" (?OnLinkedItem@CDPSrvr@@AAEXAAVCAr@@KKPAEK@Z) 
```

这是.h

```
#ifndef __ITEM_LINK__H
#define __ITEM_LINK__H
class CLinkedItemMgr
{
private:
    CLinkedItemMgr(){ m_dwLinkedItemCount = 0;};
    ~CLinkedItemMgr(){};
    DWORD m_dwLinkedItemCount;
public:
    map<DWORD,CItemElem*> m_mapLinkedItems;

    static CLinkedItemMgr *GetInstance()
    {
        static CLinkedItemMgr instance;
        return &instance;
    }
    int AddLinkedItem(CItemElem *pItem);
    CItemElem *GetLinkedItem(DWORD dwIndex);
};
#endif 
```

这是.cpp

```
 #include "stdafx.h"
#include "ItemLink.h"
int CLinkedItemMgr::AddLinkedItem(CItemElem *pItem)
{
    if(!pItem)
        return 0;
    m_mapLinkedItems.insert(make_pair<DWORD,CItemElem*>(++m_dwLinkedItemCount,pItem));
    return m_dwLinkedItemCount;
}
CItemElem *CLinkedItemMgr::GetLinkedItem(DWORD dwIndex)
{
    map<DWORD,CItemElem*>::iterator it = m_mapLinkedItems.find(dwIndex);
    if(it == m_mapLinkedItems.end())
        return FALSE;
    return it->second;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:13:36.597

您的问题出在此处的 cpp 中。

```
#ifdef __ITEM_LINK
#include "ItemLink.h" 
```

`#ifdef __ITEM_LINK``__ITEM_LINK`意思是“如果定义了，只处理下面的代码”

在您的情况下，它**没有定义**。它仅在包含时才被定义`"ItemLink.h"`，并且`"ItemLink.h"`仅在已经定义时才被包含。你已经阻止了任何一个先发生。

删除`#ifdef`线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:23:10.497

它看起来像一个链接问题。编译器知道你的类有一个被调用的函数，`GetLinkedItem`但在任何地方都找不到该函数的任何定义。编译可执行文件时是否正确链接？我敢打赌，在链接之前停止编译器不会触发任何错误。（例如 g++ -c ItemLink.cpp）。

我将请习惯于 Visual Studio 的人帮助详细说明：D 无论如何，编译需要三个主要步骤：1）应用预处理器指令，解析源代码，查找语法错误等 2）创建一个源代码中的目标文件（源代码和可执行文件之间的中间部分） 3）将构成项目的所有目标文件链接到一个可执行文件中

您的编译链在第三步失败。编译器希望在某些 .cpp 中定义某个函数（在编译链的第 2 步已成为目标文件），但无法在任何地方找到它。

并且由于 .cpp 文件中的 #ifdef 而找不到它，它告诉预处理器不要包含您的定义，因为 __ITEM_LINK 未定义

顺便说一句，我看到您更改了问题中的 .cpp

# f# - 有没有办法将 llvm 位码加载到 Mono (F#)

> ID：15691271
> 
> 赞同：2
> 
> 时间：2013-03-28T20:11:35.687
> 
> 标签：f#, mono, llvm

LLVM 具有允许轻松读取和写入位码的库。这使得例如可以编写输出 llvm 位码的代码生成器（可以使用 llvm 将其编译为本机代码），或者加载位码文件并对其执行优化或分析。

甚至可以从 OCaml 做到这一点。

是否有一个库可以将 LLVM 位码加载到 Mono (F#) 中，并将其作为对象树进行浏览？

（注意：我不想在 Mono 中执行 LLVM 位代码，只需加载代码并浏览结构。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T21:02:27.287

**[llvm-fs](https://github.com/fsharp/llvm-fs)**是 LLVM 项目的一组 F# 绑定。

**额外阅读：**

*   [在 Windows 上使用 F# 和 LLVM 构建一个简单的编译器。](http://fsharpnews.blogspot.com/2012/03/using-llvm-from-f-under-windows.html)

# xpages - xPages Dojo 网格事件不工作

> ID：15691274
> 
> 赞同：0
> 
> 时间：2013-03-28T20:12:00.240
> 
> 标签：xpages, dojox.grid.datagrid, xpages-extlib

我正在尝试双击道场网格以打开文档。在这个练习中，我发现我无法从 dojo 网格执行任何事件。即使我尝试执行一个相对简单的事件，例如导航到 dojo 网格事件上的页面，它也根本无法运行。

有什么我想念的吗？有没有办法解决这个问题？

谢谢，

[编辑] 8.5.2

[编辑2]

```
 <xe:this.service>
        <xe:viewItemFileService contentType="application/json"
            defaultColumns="true" var="entry" viewName="RFCID">
        </xe:viewItemFileService>
    </xe:this.service>
</xe:restService>

<xp:br></xp:br>
<xe:djxDataGrid id="djxDataGrid1" storeComponentId="restService1"
    escapeHTMLInData="false" loadingMessage="Loading Data">

    <xe:djxDataGridColumn id="djxDataGridColumn1" field="rfcid"
        label="RFC ID" width="30" editable="false">
    </xe:djxDataGridColumn>
    <xe:djxDataGridColumn id="djxDataGridColumn2"
        label="Request Title" field="requesttitle" width="200">
    </xe:djxDataGridColumn>
    <xe:djxDataGridColumn id="djxDataGridColumn3" label="Initiator"
        field="initiator" width="100">
    </xe:djxDataGridColumn>
    <xe:djxDataGridColumn id="djxDataGridColumn4" label="Waiting On"
        field="waitingon" width="100">
    </xe:djxDataGridColumn>
    <xe:djxDataGridColumn id="djxDataGridColumn5" label="Status"
        field="rfcstatus" width="150">
    </xe:djxDataGridColumn>

    <xp:eventHandler event="onRowDblClick" refreshMode="complete"
        immediate="true" submit="true">

        <xe:this.action>
            <xp:openPage name="/Home.xsp" target="newDocument"></xp:openPage>
        </xe:this.action>
    </xp:eventHandler></xe:djxDataGrid>

<xp:br></xp:br>

</xp:view> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T09:51:56.483

Extension Library Dojo Data Grid 事件是客户端的，而不是服务器端的。那是因为它是一个 Dojo 控件，而 Dojo 控件是客户端的。有关如何获取当前行的句柄，请参阅演示数据库或书中的示例。

# c++ - 如何使用 DirectX11 着色器将纹理应用到正交平面

> ID：15691276
> 
> 赞同：1
> 
> 时间：2013-03-28T20:12:12.440
> 
> 标签：c++, textures, shader, hlsl, directx-11

我目前正在尝试将纹理图像应用于正交平面，以便它可以用作一种“UI 装饰”。

该平面由 D3D11_PRIMITIVE_TOPOLOGY_TRIANGLESTRIP 格式的两个 tri's 组成。当我尝试使用着色器渲染平面时，它只是显示为白色（如果我将混合状态设置为 true，则它是不可见的）。我相信这是因为我只在正交平面上采样纹理的四个角，因为我只在顶点着色器中采样。

这是我的着色器中的当前代码：

```
void VSMain( const VSInput input, out PSInput output) {
    output.pos = input.pos;
    output.pos = mul( output.pos, g_WVP);

    float2 tex_pos;
    float4 Tex;
    tex_pos.x = ( input.pos.x + 512) / 1024;
    tex_pos.y = (-input.pos.z + 512) / 1024;

    Tex = g_materialMap.SampleLevel( g_sampler, tex_pos, 0);

    output.colour = Tex;
}

void PSMain( const PSInput input, out PSOutput output) {
    output.colour = input.colour;
} 
```

当我将此着色器应用于当前在场景中渲染的高度图时，它可以正常工作，但是在正交平面上不能正常工作。

谁能帮我把这个纹理正确地应用到正交平面上？（如果需要，我可以提供当前场景的截图）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T22:12:38.160

我自己发现并解决了这个问题。

需要在像素着色器中进行采样才能正确着色，但我错过了将纹理添加到像素着色器可见。

修复如下：

换线

```
Tex = g_materialMap.SampleLevel( g_sampler, tex_pos, 0); 
```

到

```
output.tex = tex_pos; 
```

然后，在像素着色器中放

```
float4 Tex = g_materialMap.Sample( g_sampler, input.tex);
output.colour = Tex; 
```

# javascript - 为什么脚本没有在所有输入元素上运行？

> ID：15691279
> 
> 赞同：0
> 
> 时间：2013-03-28T20:12:18.993
> 
> 标签：javascript, html

我正在使用此脚本来隐藏页面上输入元素的默认值：

```
<script>

var active_color = '#000'; // Colour of user provided text
var inactive_color = '#ccc'; // Colour of default text

window.onload = formDefaultValues;

function formDefaultValues() {
  var fields = getElementsByClassName(document, "input", "default-value");
  if (!fields) {
    return;
  }
  var default_values = new Array();
  for (var i = 0; i < fields.length; i++) {
    fields[i].style.color = inactive_color;
    if (!default_values[fields[i].id]) {
      default_values[fields[i].id] = fields[i].value;
    }
    fields[i].onfocus = function() { 
      if (this.value == default_values[this.id]) {
        this.value = '';
        this.style.color = active_color;
      }
      this.onblur = function() {
        if (this.value == '') {
          this.style.color = inactive_color;
          this.value = default_values[this.id];
        }
      }
    }
  }
}

function getElementsByClassName(oElm, strTagName, strClassName){
  var arrElements = (strTagName == "*" && oElm.all)? oElm.all : oElm.getElementsByTagName(strTagName);
  var arrReturnElements = new Array();
  strClassName = strClassName.replace(/\-/g, "\\-");
  var oRegExp = new RegExp("(^|\\s)" + strClassName + "(\\s|$)");
  var oElement;
  for (var i = 0; i < arrElements.length; i++) {
    oElement = arrElements[i];
    if (oRegExp.test(oElement.className)) {
      arrReturnElements.push(oElement);
    }
  }
  return (arrReturnElements);
}
</script> 
```

我使用此代码循环具有“默认值”类的输入元素并触发对它们的操作。它真的对某些元素起作用，但对其他元素不起作用？可能出了什么问题？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:29:27.003

这对我有用..

```
<html>
<script>
    function ViewAllElements() {
        var fe = document.forms['myForm'].elements;
        alert(fe.length);
        for(var i = 0; i < fe.length; i++)
        {
            alert(fe[i].value);
        }

        var ebc = getElementsByClassName(document, "input", "fieldA");
        alert(ebc.length);
        for(var j = 0; j < ebc.length; j++)
        {
            alert(ebc[j].value);
        }
    }

    function getElementsByClassName(oElm, strTagName, strClassName){
      var arrElements = (strTagName == "*" && oElm.all)? oElm.all : oElm.getElementsByTagName(strTagName);
      var arrReturnElements = new Array();
      strClassName = strClassName.replace(/\-/g, "\\-");
      var oRegExp = new RegExp("(^|\\s)" + strClassName + "(\\s|$)");
      var oElement;
      for (var i = 0; i < arrElements.length; i++) {
        oElement = arrElements[i];
        if (oRegExp.test(oElement.className)) {
          arrReturnElements.push(oElement);
        }
      }
      return (arrReturnElements);
    }

</script>

<body>
<form id="myForm" name="myForm">
    <input class="fieldA" id="field1" name="field1" value="field1value">
    <input class="fieldA" id="field2" name="field2" value="field2value">
    <input class="fieldA" id="field3" name="field3" value="field3value">
    <input class="fieldB" id="field4" name="field4" value="field4value">
    <input class="fieldB" id="field5" name="field5" value="field5value">
    <input class="fieldB" id="field6" name="field6" value="field6value">
    <input type="button" onClick="ViewAllElements();" value="View">
</form>
</body>
</html> 
```

# c# - 如何获取复选框 ID 列表

> ID：15691280
> 
> 赞同：0
> 
> 时间：2013-03-28T20:12:21.210
> 
> 标签：c#, checkbox

我创建了一个动态创建表格的网页。表中的一列是具有 ID(int) 的复选框。我想使用 SQL 查询中所有复选框的 ID，如下所示：

```
select * 
from table 
where ID in (1,2,3,4) 
```

有没有办法可以从所有复选框中获取 ID 列表？

我正在使用 C#.Net

这是我用来生成复选框的代码片段：

```
foreach (DataRow dr in dt.Rows)
{
    string Compatible_Controls = (
        "<tr>" +
        "<td><input type='CheckBox' ID='" +(dr["id"]) + "' /></td>" +
        "<td>" + (dr["Control_Name"]) + "</td>" +
        "<td>" + (dr["Control_Statement"]) + "</td>" +
        "<td>" + (dr["Regulation_type"]) + "</td>" +
        "</tr> ); 
```

这是生成的内容：

```
<tr>
    <td><input type='CheckBox' ID='3' /></td>
    <td>xxxxxx</td>
    <td>xxxxxxxxx</td>
    <td>xxxxxxxx</td>
</tr> 
```

非常感谢你！！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:20:56.417

如果您将所有复选框命名为相同的名称，将复选框的值设置为 id，并让您的控制器接受一个整数列表，它将返回已选中的复选框。

像这样：

看法：

```
<input type='checkbox' name='check' value='1'>
<input type='checkbox' name='check' value='2'>
<input type='checkbox' name='check' value='3'>
<input type='checkbox' name='check' value='4'> 
```

控制器：

```
public ActionResult CheckBoxes(IList<int> checkIds)
{
  //checkIds will contain the "value" of all the checkboxes that are checked when the form is submitted.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T22:51:46.713

此代码**未经测试**，但基本逻辑应该是正确的。这个想法是遍历页面上的所有控件，挑选出其 ID 以设置前缀开头的控件。

首先，在数字 ID 前添加前缀：

```
string ID_Prefix = "MyCheckbox_";

string Compatible_Controls = (
                 "<tr>" +
                      "<td><input type='CheckBox' ID='" + ID_prefix 
                                + (dr["id"]) + "' /></td>" +
                      "<td>" + (dr["Control_Name"]) + "</td>" +
                      "<td>" + (dr["Control_Statement"]) + "</td>" +
                      "<td>" + (dr["Regulation_type"]) + "</td>" +
                "</tr> ); 
```

这将创建如下 HTML：

```
<td><input type='CheckBox' ID='MyCheckbox_3' /></td> 
```

现在，当您要解析页面时调用它：

```
List<string> GetMyCheckboxes(ControlCollection coll, List<string> ids)
{
    foreach (Control ctl in coll)
    {
        if (ctl.ID.StartsWith(ID_Prefix))
            ids.Add(ctl.ID.Substring(ID_Prefix.Length)); // only take the number

        if (ctl.Controls.Count > 0)
            ids = GetInputs(ctl.Controls, ids);
    }
    return ids;
} 
```

像这样称呼它：

```
List<string> ids = GetMyCheckboxes(Page.Controls, new List<string>()); 
```

您最终会得到一个仅包含 ID 的列表。

# ruby - 了解 Ruby 块。为什么 Rspec 这样做？

> ID：15691285
> 
> 赞同：1
> 
> 时间：2013-03-28T20:12:48.303
> 
> 标签：ruby

我试图了解何时使用 Ruby 块，并且我看到为了配置`rspec-rails`，您需要执行以下操作：

```
RSpec::configure do |config|
  config.foo = bar
end 
```

为什么在这种情况下将其作为一个块来执行会很有用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T23:32:45.390

因为在所有内容前加上`RSpec.configuration`. 你更喜欢哪个？

```
RSpec.configuration.some_config_option = 5
RSpec.configuration.some_other_config_option = 6
RSpec.configuration.yet_another_config_option = :foo 
```

或者：

```
RSpec.configure do |c|
  c.some_config_option = 5
  c.some_other_config_option = 6
  c.yet_another_config_option = :foo
end 
```

显然，您可以编写`c = RSpec.configuration`然后使用`c.`之后的语法......但是该块也很好地限定了配置代码的范围/定界。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T20:55:17.453

这只是糖。这是（简化的）来源：

```
module Rspec
  def self.configuration
    @configuration ||= RSpec::Core::Configuration.new
  end

  def self.configure
    yield configuration if block_given?
  end

  # rest omitted
end 
```

[请参阅https://github.com/rspec/rspec-core/blob/master/lib/rspec/core.rb](https://github.com/rspec/rspec-core/blob/master/lib/rspec/core.rb)的源代码

这意味着你也可以写

```
config = Rspec.configuration
config.foo = bar 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T20:23:09.947

在一个块内，您可以更改范围。我相信你在这里的范围内是 RSpec，在块内。我也相信能够在块内说 config.foo = bar 很方便（想象你有 20 多个配置）。

# javascript - JS 与 Royal Slider Wordpress 冲突

> ID：15691290
> 
> 赞同：0
> 
> 时间：2013-03-28T20:13:03.303
> 
> 标签：javascript, wordpress, slider, conflict

我正在使用流沙过滤类别和 Superbox ( [http://toddmotto.com/labs/superbox/](http://toddmotto.com/labs/superbox/) ) 在下拉列表中显示基于高级插件 Royal Slider 的画廊。

[http://bvh.delineamultimedia.com/?page_id=2](http://bvh.delineamultimedia.com/?page_id=2)

这个文件中 _animateTo:function 周围的 Royal Slider 似乎存在问题... [http://bvh.delineamultimedia.com/wp-content/plugins/new-royalslider/lib/royalslider/jquery.royalslider.js ?ver=3.0.93](http://bvh.delineamultimedia.com/wp-content/plugins/new-royalslider/lib/royalslider/jquery.royalslider.js?ver=3.0.93)在第 1825 行附近。这导致滑块在 Superbox 下拉功能内部时无法正常工作。当我单击 Royal Slider 上的下一个按钮时，它似乎不想转到下一个图像，直到我关闭 Superbox 并再次打开它。然后是下一个图像出现的时候。

在此页面上... [http://bvh.delineamultimedia.com/?page_id=13](http://bvh.delineamultimedia.com/?page_id=13)我似乎对 Royal Slider 没有问题，这就是为什么我认为 Superbox 和 Royal Slider javascript 存在冲突的原因。此外，在此页面上... [http://bvh.delineamultimedia.com/?page_id=12](http://bvh.delineamultimedia.com/?page_id=12) Superbox 可以完美地处理静态图像。

我想以某种方式在同一个地方声明“如果有画廊显示它 - 否则显示静态图像”。

我也觉得我在这里修改了我的代码。[http://bvh.delineamultimedia.com/wp-content/themes/bvh/js/portfolio/superbox.js](http://bvh.delineamultimedia.com/wp-content/themes/bvh/js/portfolio/superbox.js)这不是最好的，因为我在这里和那里猜测一下让它工作。

我一直在尝试学习如何调试 JS，但老实说我有点迷茫。我认为这个问题发生在 _animateTo:funtion 的原因是因为控制台没有在 _stopAnimation 周围触发。任何人都可以帮助解释为什么会发生这种情况以及调试此问题的好方法。此刻我感到有些不知所措。

要查看问题：访问[http://bvh.delineamultimedia.com/?page_id=2](http://bvh.delineamultimedia.com/?page_id=2)并单击第一张图片，将出现一个下拉菜单，您将在其中看到图库。如果单击下一个箭头，它不会转到下一个图像。如果您关闭 Superbox 下拉菜单并重新单击第一个图像以查看 Superbox 下拉菜单，您将看到图像移动到下一个图像，但只有在您单击下一个箭头后关闭并重新打开 superbox 之后。

我希望这是有道理的。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T22:43:05.950

我检查了您的 Superbox.js 中的代码。问题是您正在克隆元素而不是附加它。在这种情况下，皇家滑块。这条线是罪魁祸首，它创建了两个不同的“滑块”。只有一个在工作，尽管它被隐藏了。

```
if (sliderData.length > 0) { // show the slider if there is one
    superbox.append(sliderData.clone(true)); 
```

}

只需删除 .clone() 方法就可以了。

修复关闭回调期间元素消失的问题。在此处替换此行：

```
superbox.find('.royalSlider').remove(); // remove the slider from previous events 
```

对此：

```
superbox.find('.royalSlider').appendTo($(this)); 
```

总而言之，所有这些都是在触发时将滑块从列表项元素移动到超级框，并在关闭时将其放回原处。

# javascript - 从 Javascript 插入 div 的问题

> ID：15691291
> 
> 赞同：0
> 
> 时间：2013-03-28T20:13:05.147
> 
> 标签：javascript

我正在尝试在文档中的另一个 div 之前添加一个带有一些文本的 div。简而言之，这是我的脚本，假设在加载页面时调用了 init()：

```
 <head>
            <script type="text/javascript">
                function init () {
                       var div = document.createElement('div').className = 'title';
                       div.innerHTML = 'Hello';
                       var reference = document.getElementById('content');
                       document.body.insertBefore(div, reference );            
                }
            </script>
        </head>
        <body>
            <div id="content">blah blah</div>
            <br /><br />
        </body> 
```

我在 document.body.insertBefore(div, reference) 上收到**类型不匹配错误**，有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:16:38.320

尝试

```
function init () {
     var div = document.createElement('div');
     div.className = 'title';
     div.innerHTML = 'Hello';
     var reference = document.getElementById('content');
     document.body.insertBefore(div, reference );            
} 
```

您将 div 设置为我认为的字符串标题（从未检查过）

是的，你去

[http://jsfiddle.net/FxFzc/](http://jsfiddle.net/FxFzc/)

# c - AVR32 UC3A0 如何利用 USART 中断示例并接收字符串然后做一些事情

> ID：15691293
> 
> 赞同：1
> 
> 时间：2013-03-28T20:13:06.103
> 
> 标签：c, string, interrupt, avr, uart

我遇到了一些麻烦，我不知道这是我对 Atmel 语法、Atmel Studio 6.0 还是程序本身的理解。我似乎无法让中断处理程序接收一个简单的字符串然后做点什么。当 USART 接收到一个字符时，它会打开 LED，然后如果它接收到不同的字符，它会关闭 LED，我成功地实现了单个字符打开 LED。顺便说一句，我有一个设计板，程序在进入接收子例程时遇到了一些麻烦，因为主程序中的发送代码太大，所以建议我利用中断来解决这个问题。顺便说一句，我正在 EVK1100 AVR32 板 MCU：AT32UC3A0512-U 上试用这个程序，不知道你们中是否有人玩过这些，但它们非常棒。不确定我是否喜欢 Atmel 语法。反正，

我对 Atmel 世界的中断还很陌生。

任何帮助将非常感激。我只对内置的 ASF USART 中断“INTC”项目示例进行了一些修改。

谢谢，

```
#include <string.h>
#include <avr32/io.h>
#include "compiler.h"
#include "board.h"
#include "print_funcs.h"
#include "intc.h"
#if defined (__GNUC__)
#  if   defined (__AVR32_AP7000__)
#    include "pm_at32ap7000.h"
#  else
#    include "power_clocks_lib.h"
#  endif
#elif defined (__ICCAVR32__) || defined (__AAVR32__)
#  if  defined (__AT32AP7000__)
#    include "pm_at32ap7000.h"
#  else
#    include "power_clocks_lib.h"
#  endif
#endif
#include "gpio.h"
#include "usart.h"
//#include "conf_example.h"    
#  define EXAMPLE_TARGET_PBACLK_FREQ_HZ FOSC0  // PBA clock target frequency, in Hz

#if BOARD == EVK1100
#  define EXAMPLE_USART                 (&AVR32_USART1)
#  define EXAMPLE_USART_RX_PIN          AVR32_USART1_RXD_0_0_PIN
#  define EXAMPLE_USART_RX_FUNCTION     AVR32_USART1_RXD_0_0_FUNCTION
#  define EXAMPLE_USART_TX_PIN          AVR32_USART1_TXD_0_0_PIN
#  define EXAMPLE_USART_TX_FUNCTION     AVR32_USART1_TXD_0_0_FUNCTION
#  define EXAMPLE_USART_CLOCK_MASK      AVR32_USART1_CLK_PBA
#  define EXAMPLE_PDCA_CLOCK_HSB        AVR32_PDCA_CLK_HSB
#  define EXAMPLE_PDCA_CLOCK_PB         AVR32_PDCA_CLK_PBA
#  define EXAMPLE_USART_IRQ             AVR32_USART1_IRQ
#  define EXAMPLE_USART_BAUDRATE        57600
#endif
    /**
     * \brief The USART interrupt handler.
     *
     * \note The `__attribute__((__interrupt__))' (under GNU GCC for AVR32) and
     *       `__interrupt' (under IAR Embedded Workbench for Atmel AVR32) C function
 *       attributes are used to manage the `rete' instruction.
 */
#if defined (__GNUC__)
__attribute__((__interrupt__))
#elif defined(__ICCAVR32__)
__interrupt
#endif

static void usart_int_handler(void)
{   
    static char Cmnd[30];
    int index = 0;
    int c;

    usart_read_char(EXAMPLE_USART, &c);
    Cmnd[index++] = c;

if (c = '\r')
{
    Cmnd[index] = '\0';
    usart_write_line(EXAMPLE_USART, Cmnd);
}

}   

/**
 * \brief The main function.
 *
 * It sets up the USART module on EXAMPLE_USART. The terminal settings are 57600
 * 8N1.
 * Then it sets up the interrupt handler and waits for a USART interrupt to
 * trigger.
 */
int main(void)
{
    static const gpio_map_t USART_GPIO_MAP =
    {
        {EXAMPLE_USART_RX_PIN, EXAMPLE_USART_RX_FUNCTION},
        {EXAMPLE_USART_TX_PIN, EXAMPLE_USART_TX_FUNCTION}
    };

    // USART options.
    static const usart_options_t USART_OPTIONS =
    {
        .baudrate     = 57600,
        .charlength   = 8,
        .paritytype   = USART_NO_PARITY,
        .stopbits     = USART_1_STOPBIT,
        .channelmode  = USART_NORMAL_CHMODE
    };

#if BOARD == EVK1100 || BOARD == EVK1101 || BOARD == UC3C_EK \
    || BOARD == EVK1104 || BOARD == EVK1105 || BOARD == STK600_RCUC3L0 \
    || BOARD == STK600_RCUC3D
    /*
     * Configure Osc0 in crystal mode (i.e. use of an external crystal
     * source, with frequency FOSC0) with an appropriate startup time then
     * switch the main clock source to Osc0.
     */
    pcl_switch_to_osc(PCL_OSC0, FOSC0, OSC0_STARTUP);

#elif BOARD == STK1000
    pm_reset();
#elif BOARD == UC3L_EK
    /*
     * Note: on the AT32UC3L-EK board, there is no crystal/external clock
     * connected to the OSC0 pinout XIN0/XOUT0\. We shall then program the
     * DFLL and switch the main clock source to the DFLL.
     */
    pcl_configure_clocks(&pcl_dfll_freq_param);
    /*
     * Note: since it is dynamically computing the appropriate field values
     * of the configuration registers from the parameters structure, this
     * function is not optimal in terms of code size. For a code size
     * optimal solution, it is better to create a new function from
     * pcl_configure_clocks_dfll0() and modify it to use preprocessor
     * computation from pre-defined target frequencies.
     */
#end if

    // Assign GPIO to USART.
    gpio_enable_module(USART_GPIO_MAP,
        sizeof(USART_GPIO_MAP) / sizeof(USART_GPIO_MAP[0]));

    // Initialize USART in RS232 mode.
    usart_init_rs232(EXAMPLE_USART, &USART_OPTIONS,
        EXAMPLE_TARGET_PBACLK_FREQ_HZ);
    print(EXAMPLE_USART, ".: Using interrupts with the USART :.\r\n\r\n");

    // Disable all interrupts.
    Disable_global_interrupt();

    // Initialize interrupt vectors.
    INTC_init_interrupts();

    /*
     * Register the USART interrupt handler to the interrupt controller.
     * usart_int_handler is the interrupt handler to register.
     * EXAMPLE_USART_IRQ is the IRQ of the interrupt handler to register.
     * AVR32_INTC_INT0 is the interrupt priority level to assign to the
     * group of this IRQ.
     */
    INTC_register_interrupt(&usart_int_handler, EXAMPLE_USART_IRQ, AVR32_INTC_INT0);

    // Enable USART Rx interrupt.
    EXAMPLE_USART->ier = AVR32_USART_IER_RXRDY_MASK;
    print(EXAMPLE_USART, "Type a character to use the interrupt handler."
        "\r\nIt will show up on your screen.\r\n\r\n");

    // Enable all interrupts.
    Enable_global_interrupt();

    /**
     * We have nothing left to do in the main, so we may switch to a device
     * sleep mode: we just need to be sure that the USART module will be
     * still be active in the chosen sleep mode. The sleep mode to use is
     * the FROZEN sleep mode: in this mode the PB clocks are still active
     * (so the USART module which is on the Peripheral Bus will still be
     * active while the CPU and HSB will be stopped).
     * --
     * Modules communicating with external circuits should normally be
     * disabled before entering a sleep mode that will stop the module
     * operation: this is not the case for the FROZEN sleep mode.
     * --
     * When the USART interrupt occurs, this will wake the CPU up which will
     * then execute the interrupt handler code then come back to the
     * while(1) loop below to execute the sleep instruction again.
     */

    while(1)
    {
        /*
         * If there is a chance that any PB write operations are
         * incomplete, the CPU should perform a read operation from any
         * register on the PB bus before executing the sleep
         * instruction.
         */
        AVR32_INTC.ipr[0];  // Dummy read

        /*
         * When the device wakes up due to an interrupt, once the
         * interrupt has been serviced, go back into FROZEN sleep mode.
         */
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-10T16:29:58.473

尽量保持你的中断处理程序简短。中断处理程序或 ISR 通常在禁用中断的情况下执行。他们的目标是进入，做某事，然后迅速离开。如果您有其他正在运行的中断（例如实时时钟），当您在 ISR 中时它们会被阻止，这可能会导致中断丢失等问题。

这里最好的做法是将输入缓冲区声明为全局静态。还要定义一个`static uchar_t have_line`或类似的，并在 ISR 中保存每个字符，直到缓冲区已满（重要的检查！），或者您收到 CR (\r)。还要检查换行符 (\n)。保存一个零以空终止缓冲区，然后设置`have_line = 1`.

在您的主循环中，等待`have_line`非零，然后处理输入缓冲区中的内容。最后，将 have_line 设置回零。

这样一来，您的 ISR 就简短且相当稳健。

在您的示例代码中，该功能是否`usart_write_line`需要启用中断？

哎呀！抱歉，我刚刚注意到您的索引不是静态变量。这意味着每次调用例程时它将被初始化为零。*在int index*前面添加一个静态声明符，这应该可以对其进行排序。

# python - 如何直接设置matplotlib图形背景颜色的alpha通道值

> ID：15691297
> 
> 赞同：2
> 
> 时间：2013-03-28T20:13:36.067
> 
> 标签：python, matplotlib, alpha

我遇到了 matplotlib 的问题。使用[这些信息](https://stackoverflow.com/questions/4581504/how-to-set-opacity-of-background-colour-of-graph-wit-matplotlib)，我可以设置人物脸部的颜色和 alpha 值。但是，matplotlib 似乎坚持在渲染输出之前将其与白色隐式混合。

例如，使用以下内容：

```
import matplotlib.pyplot as plt

fig = plt.figure()
fig.set_facecolor('black')
fig.patch.set_alpha(0.3)
ax = fig.add_subplot(111, axis_bgcolor='black')

ax.plot([1, 2, 3], [1, 2, 3], color='white')

fig.savefig('test_fig.png', facecolor=fig.get_facecolor(), edgecolor='none') 
```

中的图形背景像素`test_fig.png`具有 RGBA 值`(178, 178, 178, 77)`，而不是预期值`(0,0,0,77)`。我尝试了多种颜色——在所有情况下，最终输出似乎都等同于指定的颜色+alpha 与不透明的白色混合，然后将 alpha 值重置为指定的原始值。

为什么会这样？是否有一些我缺少的颜色仍然设置为白色，或者这是 matplotlib 的错误？

**编辑**：事实上，这是 matplotlib 中的一个错误，并且已经进行了修复，并且应该存在于 1.3 版及更高版本中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T11:30:23.310

对我来说似乎是一个错误。我已经提交了 PR 来修复它。如果可以的话，如果您可以尝试一下，那将非常有价值：[https ://github.com/matplotlib/matplotlib/pull/1868](https://github.com/matplotlib/matplotlib/pull/1868)

高温高压

# c - 使用 C 在文本文件中加载数字

> ID：15691299
> 
> 赞同：0
> 
> 时间：2013-03-28T20:13:37.417
> 
> 标签：c, eclipse-cdt

我正在尝试编写一个程序，将文本文件中的数字加载到数组中。文本文件称为“数字”，数字格式如下：3、49、52、40、34 等。

当我尝试运行该程序时，我收到“程序没有响应错误”。谁能指出我做错了什么？非常感谢。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define MAX 32

int main (void) {

    FILE* fp;
    fp = fopen ("numbers.txt", "r");
    if (fp == NULL)
        puts ("No data in file");
        return 0;

    int n = 0;
    int i = 0;
    int j = 0;
    int a[MAX];

    while (fscanf(fp, "%d, ", &n) > 0) {
        a[i++] = n;
    }

    fclose (fp);

    printf ("Data loaded");

    for (j = 0; j < MAX; j++) {
        printf ("%d", a[j++]);
        printf ("THE END");
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:16:55.870

将括号置于以下`if`条件：

```
FILE* fp;
fp = fopen ("numbers.txt", "r");
if (fp == NULL)
{
    puts ("No data in file");
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:17:58.313

```
if (fp == NULL)
    puts ("No data in file");
    return 0; 
```

如同：

```
if (fp == NULL)
    puts ("No data in file");
return 0; //returned already 
```

您的程序已经返回而不从文件中读取。

你应该做

```
if (fp == NULL)
{  
    puts ("No data in file");
    return 0; 
} 
```

# c++ - 将对象添加到数组但内容长度仍然为零

> ID：15691304
> 
> 赞同：0
> 
> 时间：2013-03-28T20:13:55.153
> 
> 标签：c++, objective-c, arrays, box2d

我有一个伊瓦尔，`NSMutableArray *bodies;`. 我在 init 方法中分配和初始化它。然后在另一个地方我正在做以下事情：

```
b2Body *body=_world->CreateBody(&bodyDef);
NSValue *bodyValue=[NSValue valueWithPointer:body];
[bodies addObject:bodyValue]; 
```

当我调试代码时，body 是一个有效的对象，但是虽然我将它添加到了 bodys 数组中，但该数组仍然是空的。如果我做这样的事情

```
[bodies addObject:@"An object"]; 
```

那么物体中物体的数量是1。可能是什么问题？我需要一种将 C++ 对象存储到可变数组中的方法。

# python - 没有 ORM、DOM 或表单的对象模式/模型

> ID：15691310
> 
> 赞同：3
> 
> 时间：2013-03-28T20:14:13.873
> 
> 标签：python, json, validation, serialization, orm

我最近经常使用 MongoEngine。除了 MongoDB 集成之外，我喜欢明确定义实体结构的想法。字段定义使代码更容易理解。此外，使用这些定义，我可以验证对象以捕获潜在的错误或更准确地序列化/反序列化它们。

MongoEngine 的问题在于它是专门为与存储引擎一起工作而设计的。这同样适用于 Django 和 SQLAlchemy 模型，它们也缺少列表和集合类型。那么，我的问题是，**是否有 Python 的对象模式/模型库可以进行自动对象验证和序列化，但没有对象关系映射或任何其他花哨的东西**？

让我举个例子吧。

```
class Wheel(Entity):
    radius = FloatField(1.0)

class Bicycle(Entity):
    front = EntityField(Wheel)
    back = EntityField(Wheel)

class Owner(Entity):
    name = StringField()
    bicycles = ListField(EntityField(Bicycle))

owner = Owner(name='Eser Aygün', bicycles=[])

bmx = Bicycle()
bmx.front = Wheel()
bmx.back = Wheel()

trek = Bicycle()
trek.front = Wheel(1.2)
trek.back = Wheel(1.2)

owner.bicycles.append(bmx)
owner.bicycles.append(trek)

owner.validate()  # checks the structure recursively 
```

给定结构，序列化和反序列化对象也很容易。例如，`owner.jsonify()`可能返回字典

```
{
    'name': 'Eser Aygün',
    'bicycles': [{
        'front': {
            radius: 1.0
        },
        'back': {
            radius: 1.0
        }
    }, {
        'front': {
            radius: 1.2
        },
        'back': {
            radius: 1.2
        }
    }],
} 
```

并且您可以轻松地将其转换回调用`owner.dejsonify(dic)`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-01-27T15:28:32.940

如果有人还在寻找，因为`python-entities`有一段时间没有更新，那里有一些很好的库：

*   示意图 - [https://schematics.readthedocs.org/en/latest/](https://schematics.readthedocs.org/en/latest/)
*   滤锅 - [http://docs.pylonsproject.org/projects/colander/en/latest/](http://docs.pylonsproject.org/projects/colander/en/latest/)
*   voluptuous - [https://pypi.python.org/pypi/voluptuous](https://pypi.python.org/pypi/voluptuous)（更多的验证库）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T22:19:25.953

您所描述的可以使用[remoteobjects](https://pypi.python.org/pypi/remoteobjects/1.1)来实现，它包含一种机制（称为`dataobject`），允许您定义对象的结构，以便可以对其进行验证，并且可以轻松地将其编组到 JSON 和从 JSON 编组。

它还包括一些用于构建发出 HTTP 请求的 REST 客户端库的功能，但不需要使用这部分。

主`remoteobjects`发行版没有特定`StringField`或`IntegerField`类型，但很容易实现它们。这是我维护的代码库中的一个示例，该示例`BooleanField`使用`remoteobjects`：

```
class BooleanField(dataobject.fields.Field):

    def encode(self, value):
        if value is not None and type(value) is not bool:
            raise TypeError("Requires boolean")
        return super(BooleanField, self).encode(value) 
```

然后可以在对象定义中使用它：

```
class ThingWithBoolean(dataobject.DataObject):
    my_boolean = BooleanField() 
```

进而：

```
thing = ThingWithBoolean.from_dict({"my_boolean":true})
thing.my_boolean = "hello"
return json.dumps(thing.to_dict()) # will fail because my_boolean is not a boolean 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T22:22:51.483

查看[`mongopersist`](https://pypi.python.org/pypi/mongopersist/0.8.1)，它使用 mongo 作为 Python 对象（如 ZODB）的持久层。它不执行模式验证，但它允许您在 Mongo 和 Python 之间透明地移动对象。

对于验证或其他序列化/反序列化场景（例如表单），请考虑[`colander`](http://docs.pylonsproject.org/projects/colander/en/latest/). 漏勺项目说明：

> Colander 可用作验证和反序列化通过 XML、JSON、HTML 表单发布或任何其他同样简单的数据序列化获得的数据的系统。它在 Python 2.6、2.7 和 3.2 上运行。滤锅可用于：
> 
> *   定义数据模式。
> *   在针对数据模式验证数据结构后，将由字符串、映射和列表组成的数据结构反序列化为任意 Python 结构。
> *   将任意 Python 结构序列化为由字符串、映射和列表组成的数据结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T20:34:46.187

正如我之前在评论中所说，我决定发明自己的轮子。我开始实现一个开源 Python 库*Entities*，它正是我想要的。您可以从[https://github.com/eseraygun/python-entities/](https://github.com/eseraygun/python-entities/)查看。

该库支持递归和非递归集合类型（列表、集合和字典）、嵌套实体和引用字段。它可以为任何复杂的实体自动验证、序列化、反序列化和生成可散列密钥。（事实上​​，反序列化功能还没有完成。）

这是你如何使用它：

```
from entities import *

class Account(Entity):
    id = IntegerField(group=PRIMARY)  # this field is in primary key group
    iban = IntegerField(group=SECONDARY)  # this is in secondary key group
    balance = FloatField(default=0.0)

class Name(Entity):
    first_name = StringField(group=SECONDARY)
    last_name = StringField(group=SECONDARY)

class Customer(Entity):
    id = IntegerField(group=PRIMARY)
    name = EntityField(Name, group=SECONDARY)
    accounts = ListField(ReferenceField(Account), default=list)

# Create Account objects.
a_1 = Account(1, 111, 10.0)  # __init__() recognizes positional arguments
a_2 = Account(id=2, iban=222, balance=20.0)  # as well as keyword arguments

# Generate hashable key using primary key.
print a_1.keyify()  # prints '(1,)'

# Generate hashable key using secondary key.
print a_2.keyify(SECONDARY)  # prints '(222,)'

# Create Customer object.
c = Customer(1, Name('eser', 'aygun'))

# Generate hashable key using primary key.
print c.keyify()  # prints '(1,)'

# Generate hashable key using secondary key.
print c.keyify(SECONDARY)  # prints '(('eser', 'aygun'),)'

# Try validating an invalid object.
c.accounts.append(123)
try:
    c.validate()  # fails
except ValidationError:
    print 'accounts list is only for Account objects'

# Try validating a valid object.
c.accounts = [a_1, a_2]
c.validate()  # succeeds 
```

# symfony - Symfony2 表单错误 - 为什么？

> ID：15691312
> 
> 赞同：0
> 
> 时间：2013-03-28T20:14:21.653
> 
> 标签：symfony, doctrine, twig

我有一个在 symfony2 中构建的表单。

```
$builder->add('purchaseOrder','text');
$builder->add('product', 'entity', array(
        'class' => 'WICProductBundle:Product',
        'property' => 'name',
        'query_builder' => function(EntityRepository $er) {
            return $er->createQueryBuilder('p')
                ->where('p.account=?1')
                ->orderBy('p.name', 'ASC')
                ->setParameter(1,$this->account);
        }
   )); 
```

当我在 Twig 中输出此表单并提交时，它工作正常！

当我将表单生成器更改为此并提交表单时，出现错误？！？！

```
$builder->add('purchaseOrder','text');
$builder->add('product','text'); 
```

表单的第一次迭代我用 8 填写采购订单字段，然后在产品下拉列表中选择一个值为 65 的选项...一切正常...

表单的第二次迭代我用 8 填写采购订单字段，并用值 65 填写产品字段......我得到这个错误：

```
Catchable Fatal Error: Argument 1 passed to WIC\PurchaseOrderLineItemBundle\Entity\PurchaseOrderLineItem::setProduct() must be an instance of WIC\ProductBundle\Entity\Product, string given, called in /Applications/MAMP/htdocs/symfonydev/vendor/symfony/symfony/src/Symfony/Component/Form/Util/PropertyPath.php on line 538 and defined in /Applications/MAMP/htdocs/symfonydev/src/WIC/PurchaseOrderLineItemBundle/Entity/PurchaseOrderLineItem.php line 302 
```

如果每次都传递相同的“65”值，为什么我的表单会从下拉列表切换到文本框？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:18:24.313

如果您想通过文本字段使用实体，则应在字段中添加自定义模型数据转换器，将实体的“文本”表示转换为“真实”实体并将实体反向转换为他的“文本”表示.

这将避免您的模型由于 setter 类型提示而导致 PHP 致命错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:10:09.990

[我在symfony 官方文档](http://symfony.com/doc/master/index.html)中找不到关于这个主题的正式解释，但是 AFAIK 任何代表关系的表单字段都应该由[`Entity Field Type`](http://symfony.com/doc/master/reference/forms/types/entity.html). 这是 symfony 的基本表单功能渲染和持久化代表实体的表单字段的唯一方式。

不过，您可以使用它[`Data Transformers`](http://symfony.com/doc/master/cookbook/form/data_transformers.html)来实现您想要的。

来自 symfony[食谱](http://symfony.com/doc/master/cookbook/form/data_transformers.html)：

> 假设您具有任务与问题的一对一关系，例如，任务可选地具有与其相关联的问题。添加一个包含所有可能问题的列表框最终会导致一个非常长的列表框，在其中无法找到某些内容。您可能想要添加一个文本框，用户可以在其中简单地输入问题编号。

# vb.net - 为空时 DataGrid 列更改

> ID：15691313
> 
> 赞同：0
> 
> 时间：2013-03-28T20:14:28.620
> 
> 标签：vb.net, datagrid, datatable, infragistics, ultrawingrid

我正在使用`Infragistics UltraGrid`which 就像一个普通的`datagrid`.

我的网格看起来像这样：

```
-------------------------
|  Red  |  Blue | Green |
-------------------------
| null  |  null |  null |
------------------------- 
```

我正在构建一个`DataTable`以将其分配`DataSource`为我的网格。我的`DataTable`有

*   5个红色物品
*   2 个蓝色项目

当我像这样分配我的数据源时：
`myGrid.DataSource = myDataTable` 或者像这样
`myGrid.SetDataBinding(myTable, Nothing, True)`

我得到这个网格：

```
------------------
| Red  |   Blue  |
------------------
|   5  |    2    |
------------------ 
```

当我应该有这个时：

```
---------------------------
| Red  |   Blue  |  Green  |
---------------------------
|   5  |    2    |   null  |
---------------------------- 
```

是否有一些我缺少的属性允许我的表调整为非空列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:52:51.317

当您将 DataSource 属性设置为 DataTable 时，您将通过 Designer 设置的架构信息替换为分配的表的架构信息。
据我所知，没有办法保留那个缺失的列。

但是，您可以使用 InitializeLayout 事件将缺少的列重新添加到网格中

```
Private Sub myGrid_InitializeLayout(sender As object, _
            e As Infragistics.Win.UltraWinGrid.InitializeLayoutEventArgs)
    Dim b As UltraGridBand = e.Layout.Bands[0];
    if Not b.Columns.Exists("RED") Then
        Dim colRed As UltraGridColumn = b.Columns.Add("RED", "RED");
        colRed.NullText = "Null"
        colRed.Header.VisiblePosition = 0
    End if
    if Not b.Columns.Exists("BLU") Then
        Dim colBlu As UltraGridColumn = b.Columns.Add("BLU", "BLU");
        colBlu.NullText = "Null"
        colBlu.Header.VisiblePosition = 1
    End if
    if Not b.Columns.Exists("GREEN") Then
        Dim colGreen As UltraGridColumn = b.Columns.Add("GREEN", "GREEN");
        colGreen.NullText = "Null"
        colGreen.Header.VisiblePosition = 2
    End if
End Sub 
```

# html - 用于显示的模态弹出窗口，不再在任何浏览器中显示

> ID：15691315
> 
> 赞同：0
> 
> 时间：2013-03-28T20:14:30.330
> 
> 标签：html, css, modal-dialog

这是有问题的页面：[https ://www.matejkadesign.com/pricing.php](https://www.matejkadesign.com/pricing.php)

当您单击“这是什么”图标时，可退出的模式弹出窗口应在同一页面上淡入。它从 2 天前就被破坏了（它不会在任何浏览器中弹出）。是否进行了一些浏览器/编码升级来禁用我的代码？我咨询了我的网络主机，他们无法帮助我。

如果您查看页面源代码，您将在底部找到我的模态框的代码，您将能够看到它们链接到的位置以激活它们。

如果有人可以调查它，我将不胜感激。我有一半希望人们会说“但模态框对我有用，它一定只是你的电脑”。如果是这样就太好了，我无从得知。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:16:08.480

根据控制台，`https://code.jquery.com/jquery-latest.pack.js`返回 404。当点击“这是什么”时，控制台显示错误`$ is not defined`，这也告诉我们 jQuery 从未加载。

当前页面的`https`版本有一个不正确的安全证书，所以如果你使用`http://code.jquery.com/jquery-latest.pack.js`，你会没事的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T21:17:41.923

问题出在 jquery 网站上。我会把这些放到你的页面中：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script> 
```

来自谷歌。

# jquery - 使用 .off() 或 .empty() 删除 jquery 事件处理程序

> ID：15691316
> 
> 赞同：0
> 
> 时间：2013-03-28T20:14:33.653
> 
> 标签：jquery, events, event-handling

我在应用程序中有一些小部件，它们在创建/初始化时将一系列事件处理程序附加到主容器元素。

```
widget = function(){
    this.el = $("#someelement");
    this.init = function(){
        doAjax(function(data)){
            this.el.html(data)
            .on("click", function(){
                //attach some handler here
            })
            .on("change", ("div.class"), function(){
                //attach some handler here
            });
        } 
    }
    this.reload = function(){
        this.init();
    }
} 
```

我的问题在这里很明显 - 每当我重新加载小部件（调用 init 函数）时，我都会将处理程序重新附加到元素。然后，如果我触发一个处理程序，它会执行与我“刷新”一样多的次数。我尝试了多种方法：

```
this.el.empty().html(data)
this.el.off("*").html(data)
this.el.html(data)
.off("click change")
this.el.children.remove().end().html(data) 
```

等等等等。我所做的一切实际上都不会删除事件处理程序。我所能做的就是追加/添加它们。我永远无法清除它们。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:20:26.197

```
widget = function(){
    this.el = $("#someelement");
    this.isInitialLoad = false;

    this.init = function(){
        doAjax(function(data)){
            if(!isInitialLoad){
                this.el.html(data)
                .on("click", function(){
                    //attach some handler here
                })
                .on("change", ("div.class"), function(){
                    //attach some handler here
                });
            }
            else {
                this.el.html(data);
            }
        } 
    }
    this.reload = function(){
        this.init();
    }
} 
```

或者，分离关注点：

```
widget = function(){
    this.el = $("#someelement");

    this.init = function(){
        doAjax(function(data) {
            this.el.html(data)
            .on("click", function(){
                //attach some handler here
            })
            .on("change", ("div.class"), function(){
                //attach some handler here
            });
        });
    }
    this.reload = function(){
        doAjax(function(data) { this.el.html(data); });
    }
} 
```

# 2d - 仅将 Box2D 用于碰撞检测是否有意义？

> ID：15691320
> 
> 赞同：1
> 
> 时间：2013-03-28T20:14:59.427
> 
> 标签：2d, box2d, collision-detection

我有一个正在运行的模拟，我想测试 2D 对象的碰撞。我对 Box2D 的物理模拟部分不感兴趣，但想利用它的碰撞检测功能。

我最初的想法是制作一堆静态物体，但在阅读文档后我得到的印象是它们没有包含在碰撞测试中，因此没有意义。

是否值得在我的系统中使用 Box2D 评估碰撞检测，其中元素的位置由单独的系统驱动，还是在其他地方寻找碰撞检测解决方案更有意义？如果是这样，我将如何使用 Box2D 开始这条路？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T07:07:54.173

虽然我自己没有尝试过，但我想你可以通过使用动态物体来做到这一点，世界重力设置为零，所有物体的线速度设置为零（所以它们不会在世界步骤调用中移动）然后定位它们使用 SetTransform。常规的 BeginContact/EndContact 事件仍应发送到您的联系侦听器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T22:11:00.397

是的，使用 Box2D。与 Chipmunk 和 Bullet 相比，Box2D 拥有我用过的最好的碰撞检测系统。

我同意 iforce2d，您应该使用具有重力设置为零的世界的动态物体。

祝你好运，编码愉快。

# python - 获取嵌套在 QHBoxLayout 和 QVBoxLayout 中的小部件

> ID：15691329
> 
> 赞同：1
> 
> 时间：2013-03-28T20:15:35.097
> 
> 标签：python, pyqt, pyqt4

我正在尝试使用 children() 方法访问嵌套的 QVBoxLayout 和 QHBoxLayout 布局中的所有按钮、标签、文本小部件等。但我没有得到我期望的结果：我只得到布局，而不是按钮、标签等。

是否有一种 Pythonic 方式来遍历**所有**嵌套布局以获取按钮、标签、文本编辑等？

这是我遇到麻烦的部分：

```
for child in self.ui.gridLayout.children():
    print "child_name:%s - type:%s" %(child.objectName(),type(child))

    for grand_child in child.children():
        print "gc_name:%s - type:%s" %(grand_child.objectName(),type(grand_child))

        # never prints the buttons, labels, etc
        for ggc in grand_child.children():
            print "ggc_name:%s - type:%s" %(ggc.objectName(),type(ggc)) 

        # never finds the QLabels
        qreg = QRegExp('.+')
        widgets = grand_child.findChildren(QLabel,qreg)
        print widgets # prints None 
```

这是整个代码：

```
import sys
from PyQt4 import QtCore, QtGui
from PyQt4.QtCore import *
from PyQt4.QtGui import *

from mygui import Ui_Form

class MyApp(QtGui.QWidget):

    def __init__(self,parent=None):
        super(MyApp, self).__init__(parent)

        self.ui = Ui_Form()
        self.ui.setupUi(self)

        self.ui.pushButton_test.clicked.connect(self.click_button)

    def click_button(self):
        print "Printing layouts and widgets"

        for child in self.ui.gridLayout.children():
            print "child_name:%s - type:%s" %(child.objectName(),type(child))

            for grand_child in child.children():
                print "gc_name:%s - type:%s" %(grand_child.objectName(),type(grand_child))

                # never prints
                for ggc in grand_child.children():
                    print "ggc_name:%s - type:%s" %(ggc.objectName(),type(ggc)) 

                qreg = QRegExp('.+')
                widgets = grand_child.findChildren(QLabel,qreg)
                print widgets # prints None

if __name__ == "__main__":
    app = QtGui.QApplication(sys.argv)
    myapp = MyApp()
    myapp.show()
    sys.exit(app.exec_()) 
```

这是mygui.py：

```
# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'mygui.ui'
#
# Created: Thu Mar 28 14:07:12 2013
#      by: PyQt4 UI code generator 4.9.1
#
# WARNING! All changes made in this file will be lost!

from PyQt4 import QtCore, QtGui

try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    _fromUtf8 = lambda s: s

class Ui_Form(object):
    def setupUi(self, Form):
        Form.setObjectName(_fromUtf8("Form"))
        Form.resize(454, 323)
        self.gridLayout = QtGui.QGridLayout(Form)
        self.gridLayout.setObjectName(_fromUtf8("gridLayout"))
        self.verticalLayout = QtGui.QVBoxLayout()
        self.verticalLayout.setObjectName(_fromUtf8("verticalLayout"))
        self.horizontalLayout = QtGui.QHBoxLayout()
        self.horizontalLayout.setObjectName(_fromUtf8("horizontalLayout"))
        self.lineEdit = QtGui.QLineEdit(Form)
        self.lineEdit.setObjectName(_fromUtf8("lineEdit"))
        self.horizontalLayout.addWidget(self.lineEdit)
        self.pushButton_2 = QtGui.QPushButton(Form)
        self.pushButton_2.setObjectName(_fromUtf8("pushButton_2"))
        self.horizontalLayout.addWidget(self.pushButton_2)
        self.verticalLayout.addLayout(self.horizontalLayout)
        self.horizontalLayout_2 = QtGui.QHBoxLayout()
        self.horizontalLayout_2.setObjectName(_fromUtf8("horizontalLayout_2"))
        self.label_2 = QtGui.QLabel(Form)
        self.label_2.setObjectName(_fromUtf8("label_2"))
        self.horizontalLayout_2.addWidget(self.label_2)
        self.label = QtGui.QLabel(Form)
        self.label.setObjectName(_fromUtf8("label"))
        self.horizontalLayout_2.addWidget(self.label)
        self.verticalLayout.addLayout(self.horizontalLayout_2)
        self.textEdit = QtGui.QTextEdit(Form)
        self.textEdit.setObjectName(_fromUtf8("textEdit"))
        self.verticalLayout.addWidget(self.textEdit)
        self.pushButton_test = QtGui.QPushButton(Form)
        self.pushButton_test.setObjectName(_fromUtf8("pushButton_test"))
        self.verticalLayout.addWidget(self.pushButton_test)
        self.gridLayout.addLayout(self.verticalLayout, 0, 0, 1, 1)

        self.retranslateUi(Form)
        QtCore.QMetaObject.connectSlotsByName(Form)

    def retranslateUi(self, Form):
        Form.setWindowTitle(QtGui.QApplication.translate("Form", "Form", None, QtGui.QApplication.UnicodeUTF8))
        self.pushButton_2.setText(QtGui.QApplication.translate("Form", "PushButton", None, QtGui.QApplication.UnicodeUTF8))
        self.label_2.setText(QtGui.QApplication.translate("Form", "TextLabel", None, QtGui.QApplication.UnicodeUTF8))
        self.label.setText(QtGui.QApplication.translate("Form", "TextLabel", None, QtGui.QApplication.UnicodeUTF8))
        self.pushButton_test.setText(QtGui.QApplication.translate("Form", "Print All Widgets", None, QtGui.QApplication.UnicodeUTF8))

if __name__ == "__main__":
    import sys
    app = QtGui.QApplication(sys.argv)
    Form = QtGui.QWidget()
    ui = Ui_Form()
    ui.setupUi(Form)
    Form.show()
    sys.exit(app.exec_()) 
```

感谢您的帮助和意见。

保罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T00:35:48.957

我意识到所有的小部件都可以从 self 访问。这是我使用的最终代码：

```
wtypes = [QPushButton,QLabel,QTextEdit]
qreg = QRegExp(r'.*')
mywidgets = {}

for t in wtypes:
    mywidgets[t] = self.findChildren(t,qreg)

for button in mywidgets[QPushButton]:
    print "button:", button.objectName()

for label in mywidgets[QLabel]:
    print "label:", label.objectName() 
```

# php - AJAX 到 JS 变量交换

> ID：15691334
> 
> 赞同：0
> 
> 时间：2013-03-28T20:15:51.197
> 
> 标签：php, html, ajax

我使用 ajax 调用 php 来获取一些存储在我的数据库中的值。然后我在我的 php 中回显这些值，以便我可以使用该`responseText`属性来获取这些检索到的值（我想将其存储在 JS 数组中）以供进一步参考。这就是我卡住的地方。当我必须从数据库中仅检索 1 行时，我确实设法做到了这一点（我通过使用“，”分隔字段并随后使用 JS 中的 split() 函数来解析字符串来做到这一点）。但是，当我的数据库返回超过 1 行时，我会遇到死胡同，因为我的这种方法似乎不起作用。请建议最简单的方法来克服这个障碍。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:21:20.683

[您可以使用服务器端的json_encode](http://www.php.net/manual/en/function.json-encode.php)将多个 DB 行的 PHP 数组转换为 json ，并使用[此处的](https://stackoverflow.com/questions/4935632/how-to-parse-json-in-javascript)[javascript](http://www.json.org/js.html)阅读帮助在客户端解析 JSON 。更面向代码的答案需要一些有问题的代码才能使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:18:41.173

利用

```
 var jsArray = {};
    $.each(response, function(i, item) {
       jsArray[i] = item;
    }); 
```

上面的 JQuery 循环等价于 PHP 循环：

```
 foreach($response as $i => $item) {
      $jsArray[$i] = $item;
   } 
```

# python - 如何在sqlite中插入带有管道符号的字符串

> ID：15691342
> 
> 赞同：0
> 
> 时间：2013-03-28T20:16:19.863
> 
> 标签：python, sqlite

我正在使用 sqlite3 但我遇到了一些问题，因为我需要添加包含`|`符号的字符串

我有一个只有一列的表，我这样做：

```
s.execute('INSERT INTO mytable (col_name) VALUES (?);',"a|b") 
```

但结果我得到了这个：

```
ProgrammingError: Incorrect number of bindings supplied. The current statement uses 1, and there are 3 supplied. 
```

我也试过引用，像这样：

```
s.execute('INSERT INTO mytable (col_name) VALUES (?);',"'a|b'") 
```

错误有点不同，但仍然不起作用

```
ProgrammingError: Incorrect number of bindings supplied. The current statement uses 1, and there are 5 supplied. 
```

如何说服 sqlite3 接受我的字符串作为单个字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:21:45.267

参数参数必须是一个序列，所以在这里使用一个元组：

```
s.execute('INSERT INTO mytable (col_name) VALUES (?);', ("a|b",)) 
```

这与管道符号无关，顺便说一句，但与字符串也是序列这一事实有关。3 个字符的字符串是 3 个元素的序列。

# java - 更改 ZK 中的列顺序

> ID：15691343
> 
> 赞同：3
> 
> 时间：2013-03-28T20:16:26.287
> 
> 标签：java, zk

我在 ZK 中创建了一个包含几列的表。我使用了、`listbox`、`listhead`和`listeheader`组件。我想动态更改表列的顺序。有谁知道 ZK 提供的库是否可行？提前致谢`listitem``listcells`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T06:30:45.737

我已经在 ZUL 中完成了重新排序，您可以查看 [ZK Reordering Example](http://zkframeworkhint.blogspot.in/2013/01/zk-listbox-with-column-reordering-in-zul.html)

# git - Git 用于带有分支的 Web 目录

> ID：15691346
> 
> 赞同：0
> 
> 时间：2013-03-28T20:16:39.100
> 
> 标签：git

我正在尝试使用 git 设置 Web 服务器的版本控制系统，但我完全糊涂了。

所以我希望有 2 个分支：实验和发布。

当发布与实验性合并时，我编写了挂钩以将文件移动到 web 目录。但是，我真的不知道如何在服务器上设置存储库，然后在本地设置。

我是否需要服务器上的裸存储库（我不是 100% 确定那是什么）？如何创建分支、切换到它们，然后发送提交？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:42:12.170

您可以在服务器上拥有一个正常的 repo。

如果您可以访问服务器，您可以做的是将本地存储库的副本复制到您的服务器中。完成后，您的服务器和本地存储库将同步。然后你可以使用 git remote add 命令将你的服务器添加为你本地的远程，这样每次推送都会进入服务器。

添加一个名为 origin 的远程示例： git remote add origin git@domain.com/project.git

下次您在本地 repo 上有更新时，您可以使用以下命令更新服务器`git push origin master`

要制作分支，很容易：

```
git branch newbranch 
```

要更改为该分支：

```
git checkout newbranch 
```

列出所有分支：

```
git branch -a 
```

# c++ - 使用 ifstream 在 while 循环内将数据传递给向量

> ID：15691349
> 
> 赞同：0
> 
> 时间：2013-03-28T20:16:47.430
> 
> 标签：c++, vector, while-loop, ifstream

我正在为我的 C++ 类进行分配，并且在使用 ifstream 的 while 循环中将数据传递给向量时遇到了麻烦。

这就是我最终这样做的方式，它有效，但取决于数据文件小于 100 个整数：

```
void Frequency()
{
    ifstream frequency("test.dat");
    if (! frequency)
    {
        cout << "**Error opening File**";
    }
    else
    {
        int data;
        vector <int> numbers(101, 0);
        while(frequency >> data)
        {
            numbers[data-1] += 1;
        }
        for(int i = 100; i >= 1; i--) //
        {
            if (numbers[i] != 0)
            {
                cout << setw(3) << i+1 <<": " << numbers[i] << endl;
            }
        }
    }
} 
```

它按降序返回某些数字的频率。

这感觉更像是我在通过它而不是在编码，虽然（尽管我的教练坚持“这是简单的方法！”我不想要简单，我想要正确。我这样做是这样的：

```
void Frequency()
{
    ifstream frequency("test.dat");
    if (! frequency)
    {
        cout << "**Error opening File**";
    }
    else
    {
        int size = 0;
        int x; //actually a useless variable, only exists so the program can iterate to find the size
        while (frequency >> x) //gives us the size of the data file
        {
            size++;
        }
        vector <int> numbers(size, 0);
        int data;
        int a = 0; 
        while (frequency >> data) //inputs the data into the vector
        {
            numbers[a] = data;
            a++;
        }
        for (int a = 0; a < size; a++)
        {
            frequency >> numbers[a];
        }
        for(int i = 0; i < size; i++) //displays each subvector and it's value (for testing)
        {
            cout << "numbers[" << i << "]: " << numbers[i] << endl;
        }
    }
} 
```

但是所有向量都返回为 0。任何人都可以看到为什么数据没有正确通过吗？

这是我传递的数据文件，供参考。75 85 90 100
60 90 100 85 75 35 60 90 100 90 90 90 60 50 70 85 75 90 90 70

编辑：修复了一些评论的东西。我一定会尝试用 MAP 来做。现在让我感到困惑的最大的事情（以*我*所做的方式就是为什么数据文件没有传递到向量中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:21:11.027

由于您不知道文件中有多少不同的值，因此您有两个选择：`resize`必要时使用向量，或使用`map`. 后者是解决此问题的最简单方法：

```
std::map<unsigned, unsigned> numbers;

while(frequency >> data)
{
    numbers[data]++;
} 
```

如果您想再次遍历数字，*可以*使用您当前的方法。但是，这将导致将其他条目添加到您的地图中（查看`std::map::operator[]`）。但是，您可以使用`iterators`仅显示已添加到地图中的值：

```
for(
    std::map<unsigned, unsigned>::iterator it = numbers.begin(); 
    it != numbers.end();
    it++
){    
    cout << setw(3) << it->first <<": " << it->second << endl;
} 
```

如果您被允许使用 C++11，那么使用 range-for-loops 会变得更加简单：

```
for(auto entry : numbers){
{    
    cout << setw(3) << entry.first <<": " << entry.second << endl;
} 
```

# highcharts - Highcharts yAxis setExtremes far off

> ID：15691354
> 
> 赞同：0
> 
> 时间：2013-03-28T20:17:03.190
> 
> 标签：highcharts

[http://jsfiddle.net/wtftc/cGbUh/](http://jsfiddle.net/wtftc/cGbUh/)

```
$(function () {
$('#container').highcharts({
    chart: {
        plotBorderWidth: 1
    },

    xAxis: {
    },
    yAxis: [{
        startOnTick: true,
        endOnTick: true,
    }, {
        opposite: true,
        title: {
            text: null,   
        }
    }],
    title: {
        text: '',   
    },

    series: [{
        data: [-67900.92, 454001.7, -204238.28, 322154.52, 162814.29, 940881.87, 454987.58, -190981.9, 77289.43, -578758.66, 232812.59, -553224.3, -161440.06, 203872.86, -487226.65, 582178.18, 88564.43, 250057.57, -62186.0600000001, 377721.25, -196420.64, 38713.0099999999, 284969.83, 166221.67],
    }]
});

// the button action
$('#button').click(function() {
    var chart = $('#container').highcharts();
    var yAxis = chart.yAxis[0];
    yAxis.options.startOnTick = false;
    yAxis.options.endOnTick = false;

    chart.yAxis[0].setExtremes(-1034970.057, 1034970.057);
});
}); 
```

我创建了一个 jsfiddle 示例来说明我正在尝试做的事情。我用示例中的数据加载了一个图表，然后我想为我的轴设置自定义值。我设置的极值是 -1034970.057、1034970.057，因为我希望我的 y 轴值是对称的。

然而，我在图表中最终得到的是 yAxis 极端值 -1.5m 和 +3m，而不是 -1.5m 和 +1.5m。我要求它是对称的，但是在你按下设置极端按钮后，你可以看到它不是对称的。

我的数据是动态的，并且会根据他们正在查看的页面上的设置而变化，因此这些数据只是我可能遇到的众多场景之一的示例。这意味着我不能硬编码滴答间隔或滴答计数。有没有办法让它对称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T22:34:18.170

我通过在图表中将 start/endOnTick 设置设置为 false 然后在单击时设置为 true 来使其工作。

[http://jsfiddle.net/uNvvk/](http://jsfiddle.net/uNvvk/)

```
yAxis: [{
        startOnTick: false,
        endOnTick: false,
    }, {

yAxis.options.startOnTick = true;
yAxis.options.endOnTick = true; 
```

我不知道为什么会这样！

# mysql - 将来自两个表、多列和多行的数据分组为一行

> ID：15691355
> 
> 赞同：0
> 
> 时间：2013-03-28T20:17:06.357
> 
> 标签：mysql, sql

我正在尝试将每个在其行上的键 = 值对分组到按 ID 分组的一行中。

表 1\. wp_posts
键：ID - post_title

表 2\. wp_postmeta
键：post_id、wpcf-owner、wpcf-tel、wpcf-mob、wpcf-email...

使用这个查询，我得到了所有信息，但是对于每个键，我得到单独的行。我需要的是一个数组，其中所有内容都在一行中，按 wp_posts.ID 分组

```
SELECT wp_posts.ID, wp_posts.post_title, wp_postmeta.post_id, wp_postmeta.meta_key, wp_postmeta.meta_value
FROM wp_posts
JOIN wp_postmeta
ON wp_posts.ID = wp_postmeta.post_id
WHERE wp_posts.post_type = 'accommodation' AND wp_postmeta.meta_key LIKE 'wpcf%'
ORDER BY hic13_posts.post_title 
```

结果是：

```
ID | post_title | key value  
------------------------------  
1  |  TITLE     |  wpcf-owner  
1  |  TITLE     |  wpcf-tel  
1  |  TITLE     |  wpcf-mob  
1  |  TITLE     |  wpcf-email  
2  |  TITLE     |  wpcf-owner  
2  |  TITLE     |  wpcf-tel  
2  |  TITLE     |  wpcf-mob  
2  |  TITLE     |  wpcf-email  
... 
```

我需要的是：

```
ID | post_title | key value  | key value | key value | key value  
-----------------------------------------------------------------  
1  |  TITLE     | wpcf-owner | wpcf-tel  | wpcf-mob  | wpcf-email  
2  |  TITLE     | wpcf-owner | wpcf-tel  | wpcf-mob  | wpcf-email 
```

如果我将命令添加到按 ID 分组，那么我只能从第二个表中获得一个键......

```
SELECT wp_posts.ID, wp_posts.post_title, wp_postmeta.post_id, wp_postmeta.meta_key, wp_postmeta.meta_value
FROM wp_posts
JOIN wp_postmeta
ON wp_posts.ID = wp_postmeta.post_id
WHERE wp_posts.post_type = 'accommodation' AND wp_postmeta.meta_key LIKE 'wpcf%'    
GROUP BY hic13_posts.ID
ORDER BY hic13_posts.post_title 
```

我只得到这个

```
ID | post_title | key value  
------------------------------  
1  |  TITLE     |  wpcf-owner  
2  |  TITLE     |  wpcf-tel 
```

希望这一切都有意义:-)
谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:23:08.873

这种类型的转换是*枢轴*，但 MySQL 没有枢轴函数，因此您需要使用带有`CASE`表达式的聚合函数。：

```
SELECT p.ID, 
  p.post_title, 
  m.post_id, 
  max(case when m.meta_key = 'wpcf-owner' then m.meta_value end) as owner,
  max(case when m.meta_key = 'wpcf-tel' then m.meta_value end) as tel,
  max(case when m.meta_key = 'wpcf-mob' then m.meta_value end) as mob,
  max(case when m.meta_key = 'wpcf-email' then m.meta_value end) as email
FROM wp_posts p
JOIN wp_postmeta m
  ON p.ID = m.post_id
WHERE p.post_type = 'accommodation' AND m.meta_key LIKE 'wpcf%'    
GROUP BY p.ID, p.post_title, m.post_id
ORDER BY p.post_title 
```

编辑，如果您有未知数量的`meta_key`项目要转换，那么您可以使用准备好的语句来生成动态 sql：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'max(CASE WHEN m.meta_key = ''',
      meta_key,
      ''' THEN m.meta_value else null END) AS `',
      meta_key, '`'
    )
  ) INTO @sql
FROM wp_postmeta;

SET @sql 
  = CONCAT('SELECT p.ID, 
              p.post_title, 
              m.post_id, ', @sql, ' 
            FROM wp_posts p
            JOIN wp_postmeta m
              ON p.ID = m.post_id
            WHERE p.post_type = ''accommodation'' 
               AND m.meta_key LIKE ''wpcf%''   
            GROUP BY p.ID, p.post_title, m.post_id
            ORDER BY p.post_title');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

# django - Django UnknownTimeZoneError

> ID：15691356
> 
> 赞同：0
> 
> 时间：2013-03-28T20:17:06.930
> 
> 标签：django, pytz, traceback

最近我在玩谷歌应用引擎并安装了 GAE 的 pytz 版本（更准确地说是 gaepytz-2011h-py2.7）。当我现在尝试为 Django 项目打开我的管理员时，我得到了这个回溯的上述错误：

```
gaepytz-2011h-py2.7.egg/pytz/__init__.py in timezone
        raise UnknownTimeZoneError(zone) 
```

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T09:53:29.813

您的时区可能定义不正确。由于您没有说明该区域是什么，因此无法知道确切的问题是什么。

# linux - 如何列出（ls）目录中最后修改的 5 个文件？

> ID：15691359
> 
> 赞同：164
> 
> 时间：2013-03-28T20:17:15.133
> 
> 标签：linux, list, terminal, limit, ls

我知道`ls -t`会按修改时间列出所有文件。但是我怎样才能将这些结果限制在最后*n 个*文件中呢？

* * *

## 回答 #1

> 赞同：290
> 
> 时间：2013-03-28T20:19:31.693

尝试使用头部或尾部。如果您想要 5 个最近修改的文件：

```
ls -1t | head -5 
```

-1（这是一个）表示每行一个文件，而头部表示取前 5 个条目。

如果你想要最后 5 次尝试

```
ls -1t | tail -5 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2018-01-11T11:37:16.967

接受的答案仅列出文件名，但要获得前 5 个文件，也可以使用：

`ls -lht | head -6`

在哪里：

`-l`以列表格式输出

`-h`使输出可读（即文件大小以 kb、mb 等显示）

`-t`通过将最近修改的文件放在最前面对输出进行排序

`head -6`将显示 5 个文件，因为`ls`在输出的第一行打印块大小。

我认为这是一种更优雅且可能更有用的方法。

**示例输出：**

`total 26960312 -rw-r--r--@ 1 user staff 1.2K 11 Jan 11:22 phone2.7.py -rw-r--r--@ 1 user staff 2.7M 10 Jan 15:26 03-cookies-1.pdf -rw-r--r--@ 1 user staff 9.2M 9 Jan 16:21 Wk1_sem.pdf -rw-r--r--@ 1 user staff 502K 8 Jan 10:20 lab-01.pdf -rw-rw-rw-@ 1 user staff 2.0M 5 Jan 22:06 0410-1.wmv`

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-03-28T20:19:24.367

使用`tail`命令：

```
ls -t | tail -n 5 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-01-03T14:02:03.157

默认情况下`ls -t`，输出从最新到最旧排序，因此要使用的命令组合取决于您希望输出的排序方向。

对于从最新到最旧排序的最新 5 个文件，使用`head`前 5 行输出：

```
ls -t | head -n 5 
```

对于从最旧到最新排序的最新 5 个文件，使用`-r`switch to reverse`ls`的排序顺序，并使用`tail`最后 5 行输出：

```
ls -tr | tail -n 5 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-08-25T23:13:42.190

`ls -t`按创建时间而不是上次修改时间列出文件。`ls -ltc`如果您想按最后修改时间从最后到第一个（从上到下）列出文件，请使用。因此要列出最后的 n：`ls -ltc | head ${n}`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-28T12:04:59.513

没有其他答案对我有用。结果既是文件夹又是文件，这不是我所期望的。

对我有用的解决方案是：

```
find . -type f -mmin -10 -ls 
```

这会在当前目录中列出最近 10 分钟内修改的所有文件。它不会列出最后 5 个文件，但我认为它可能会有所帮助

# php - while 循环跳过查询

> ID：15691361
> 
> 赞同：0
> 
> 时间：2013-03-28T20:17:19.387
> 
> 标签：php, mysql, phpmyadmin, while-loop

我的 while 循环跳过该元素。寻找类似的问题，但仍然无法理解。请赐教。天呐！

```
$query = "SELECT userid, COUNT(content) as x_count
                       FROM x GROUP BY userid ORDER BY x_count DESC
                       LIMIT 5";
            $result = mysql_query($query) or die("Error in query:".mysql_error());
            $row = mysql_fetch_assoc($result);
            echo '<br>';
            while(list($id,$no_x) = mysql_fetch_array($result)){
                echo $id.'number of x:'.$no_x;
                echo '<br>';
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:21:43.497

问题是您正在执行`$row = mysql_fetch_assoc($result);`，这将推进结果集。

我不明白你为什么要这么叫，所以我的建议是删除这一行。

# sql - VS 2010 数据库项目：决定 sql03006 还是 sql04151

> ID：15691363
> 
> 赞同：0
> 
> 时间：2013-03-28T20:17:25.540
> 
> 标签：sql, visual-studio-2010, database-project

我仍在研究，但我无法弄清楚这一点。

我从一个数据库逆向工程了一个项目，我所有未解决的引用都以 SQL03006 错误的形式出现，这些错误会终止构建。我对一个不同的数据库进行了逆向工程，所有未解析的引用都作为 SQL04151 警告出现，让我继续。

我没有选中“将警告视为错误”框。

我想我是通过向导创建了 1，而另一个是手动创建的，所以还在研究。但是，如果有人有想法，我将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T13:47:55.513

您是否尝试添加指向其他数据库引用的 dbschema 文件的数据库引用？您可以使用 VSDBCMD.exe 创建这些文件。有人在以下位置编写了一个可能适用于此的 GUI： [http ://www.benday.com/2009/08/22/a-user-interface-for-vsdbcmd-deployimport-your-database-schema-without-installing- visual-studio-2008-数据库版/](http://www.benday.com/2009/08/22/a-user-interface-for-vsdbcmd-deployimport-your-database-schema-without-installing-visual-studio-2008-database-edition/)

该命令的一般语法如下所示：

```
VSDBCMD /a:Import /cs:" ConnectionString" /dsp:Sql /model:DatabaseName.dbschema 
```

您可以在以下位置找到有关 VSDBCMD 的更多详细信息：http: [//msdn.microsoft.com/en-us/library/dd193283%28v=VS.100%29.aspx](http://msdn.microsoft.com/en-us/library/dd193283%28v=VS.100%29.aspx)

在我们的例子中，我们将任何共享模式文件放在一个文件夹中，所有需要它们的项目都可以访问该文件夹。一旦添加为数据库参考，您应该能够构建/部署而不会出现错误。

# android - 如何切换到活动通话屏幕

> ID：15691365
> 
> 赞同：1
> 
> 时间：2013-03-28T20:17:28.650
> 
> 标签：android

接听电话后，您会转到活动通话屏幕（它有结束通话、显示拨号盘、通话静音等按钮）

假设用户在通话过程中导航到我的应用程序。是否有以编程方式返回正在进行的呼叫的机制？我想在我的应用程序中有一个按钮，以便如果有活动呼叫并且我的应用程序在前台运行，那么用户可以按下按钮并返回活动呼叫屏幕。

我需要一个广播接收器吗？我是否会带着 Intent 返回正在进行的通话屏幕？这似乎不对。我认为 Intents 开始了新的活动，并没有让你回到已经运行的活动。

任何建议将不胜感激。

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:19:01.517

如果您的应用程序位于 Activity 堆栈中的调用中应用程序的顶部，您应该能够调用`finish()`您自己的 Activity，这将使调用中的应用程序再次位于堆栈顶部，因此它将是显示在屏幕。

同样，我不确定您是否需要为用户提供返回活动的方法。他们应该能够拉下通知栏并单击放置在其中的“通话中”条目以返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-27T14:28:01.670

我至少找到了适用于 Android O 的解决方案。制作工作的简单意图`ACTION_CALL_BUTTON`：

```
 Intent callIntent = new Intent(Intent.ACTION_CALL_BUTTON);
  startActivity(callIntent); 
```

# javascript - 使用承诺 - 在失败处理程序中记录堆栈跟踪

> ID：15691366
> 
> 赞同：31
> 
> 时间：2013-03-28T20:17:31.670
> 
> 标签：javascript, node.js, stack-trace, promise, q

我对nodejs相当陌生，所以我将更详细地解释我想要做什么。

我有一个网络服务器。如果请求失败，我想记录该异常的堆栈跟踪，但会提供错误页面而不会使服务器崩溃。

例如，处理请求的函数：

```
var Q = require('q');

var requestHandler = function () {
    // Here I get the data etc. that was requested. As this is not important, just a dummy here
    Q.resolve()
        // Now I answer the request
        .then(function (data) {
            // Dummy Code representing the sending of a response
            console.log('sending response …');
            console.log('oh no! an exception');
            // Now an Exception occurs
            throw new Error('You did something wrong!');
        })
        // If there was any error, show the error page instead
        .fail(function (err) {
            // Dummy Code representing the sending of the error page
            console.log('sending error page');
            // Additionally I want to write the error into a log file
            console.error('You had an error: ', err);
        })
        // If there was an error in the .fail-handler, I deserve the server to crash
        .done();
};

// A request comes in, I want to call my handler
requestHandler(); 
```

控制台的输出：

```
sending response …
oh no! an exception
sending error page
You had an error:  [Error: You did something wrong!] 
```

我看不到访问堆栈跟踪的方法。但是当我在 .fail-handler 中抛出异常（或者只是省略完整的 .fail-handler）时，我会在控制台上获得堆栈跟踪（但我必须重新启动服务器）。

所以我想我的问题是：

**如何访问承诺失败处理程序中的堆栈跟踪？**

**编辑**：当然，欢迎任何有关如何改进解释的提示。如果我没有说清楚，请告诉我。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-03-29T08:21:25.797

记录错误对象不会打印错误的堆栈跟踪。您需要具体要求：

```
console.error('You had an error: ', err.stack); 
```

# algorithm - 数独多项式算法？

> ID：15691367
> 
> 赞同：4
> 
> 时间：2013-03-28T20:17:33.297
> 
> 标签：algorithm, complexity-theory, np-complete

我有一个项目要完成复杂性和解决问题的课程，我决定将项目建立在数独上。根据我所做的研究，数独是一个 NP-Complete 问题（这是项目所必需的），我找到了一些为其创建算法的方法。我打算做一个蛮力解决方法，我需要做另外两种方法。我找到了一些方法，例如将其解决为精确覆盖问题，并且我找到了一篇将数独描述为 SAT 问题的论文。但我的问题是：数独是否有经过验证的多项式解决方案？我的老师似乎认为大约 5 年前一位“高级”绅士有一个“聪明”的解决方案，但他只记得这些。有谁知道这个解决方案是什么，或者任何其他多项式解决方案是什么？我'

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-03-05T19:43:13.057

因为广义数独问题（n ² × n ²网格）是 NP 难的，如果有一个已知的多项式时间算法来解决数独难题，它将证明 P = NP。那将是一笔*大*买卖。

需要记住的是，我们所知道的数独游戏都是 9 × 9 的网格。因此，当试图测量解决数独难题的时间复杂度时，使用大 O 表示法实际上并不是一个好主意，因为大 O 表示法讨论的是算法*在长期内*如何扩展以及我们所关心的about 是解决固定大小的数独谜题。换一种说法，如果您想谈论解决数独难题的多项式时间，您必须回答“*什么变量中的多项式？* ”如果您一直在解决 9 × 9 数独网格，那么答案问题不是很清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-07T10:47:34.653

您也可以使用[类似人类的策略](http://en.algoritmy.net/article/42521/Sudoku)，它可以是多项式，但它不会为所有数独找到解决方案（即使是具有唯一解决方案的数独）。将数独简化为图形着色问题也很容易（每个单元格由图形的一个节点表示，节点根据数独规则连接，以免具有相同的颜色。预填充节点接地到一些颜色）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-05T19:34:55.977

看看[车多项式](https://en.wikipedia.org/wiki/Rook_polynomial)。

对于一个 9 * 9 的网格，它开始完全是空的，这给出了一个 9 阶多项式。

但是，对于部分填充的网格，订单减少到最长的空跨度。

# java - 添加无法在应用程序上运行的暴徒

> ID：15691373
> 
> 赞同：3
> 
> 时间：2013-03-28T20:18:15.847
> 
> 标签：java, android, admob

我试图在我的应用程序上设置 admob 并且它无法正常工作它在你必须输入用户 ID 以使 admob 服务工作的行出现错误:(

```
package com.google.example.ads.fundamentals;

import android.app.Activity;
import android.os.Bundle;
import android.widget.LinearLayout;

import com.google.ads.AdRequest;
import com.google.ads.AdSize;
import com.google.ads.AdView;

/**
 * A simple {@link Activity} that embeds an AdView.
 */
public class BannerSample extends Activity {
  /** The view to show the ad. */
  private AdView adView;

  /** Called when the activity is first created. */
  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main); 
```

error here
// 创建一个广告。adView = new AdView(this, AdSize.BANNER, a1515* ***** ****** );

```
 // Add the AdView to the view hierarchy. The view will have no size
    // until the ad is loaded.
    LinearLayout layout = (LinearLayout) findViewById(R.id.linearLayout);
    layout.addView(adView);

    // Create an ad request. Check logcat output for the hashed device ID to
    // get test ads on a physical device.
    AdRequest adRequest = new AdRequest();
    adRequest.addTestDevice(AdRequest.TEST_EMULATOR);

    // Start loading the ad in the background.
    adView.loadAd(adRequest);
  }

  /** Called before the activity is destroyed. */
  @Override
  public void onDestroy() {
    // Destroy the AdView.
    if (adView != null) {
      adView.destroy();
    }

    super.onDestroy();
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:05:44.863

我认为问题是 AdView 类中的第三个参数必须是字符串

尝试将其更改为：

```
 adView = new AdView(this, AdSize.BANNER, "a1515******"); 
```

我希望这对你有帮助

干杯，

# python - 在python中导入opencv时出错

> ID：15691376
> 
> 赞同：2
> 
> 时间：2013-03-28T20:18:26.297
> 
> 标签：python, opencv

我在我的 Mac 上使用这些命令安装了 opencv：

```
$ wget http://sourceforge.net/projects/opencvlibrary/files/opencv-unix/2.4.3/OpenCV-2.4.3.tar.bz2
$ tar xjvf OpenCV-2.4.3.tar.bz2
$ cd OpenCV-2.4.3
$ mkdir build; cd build
$ cmake -G "Unix Makefiles" -D CMAKE_OSX_ARCHITECTURES=i386 -D CMAKE_C_FLAGS=-m32 -D CMAKE_CXX_FLAGS=-m32 ..
$ make -j4
$ sudo make install 
```

然后我尝试通过导入它来使用它，但出现以下错误：

```
~/opencv-2.4.4/build $ python
Python 2.7.3 (default, Mar 28 2013, 14:31:14) 
[GCC 4.2.1 Compatible Apple Clang 4.1 ((tags/Apple/clang-421.11.66))] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import cv
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/local/lib/python2.7/site-packages/cv.py", line 3, in <module>
    from cv2.cv import *
ImportError: dlopen(/usr/local/lib/python2.7/site-packages/cv2.so, 2): no suitable image found.  Did find:
    /usr/local/lib/python2.7/site-packages/cv2.so: mach-o, but wrong architecture 
```

**更新**

在编译 OpenCV 时，我注意到它从以前的版本（苹果安装的一个）中获取了 python 库：

```
-- Could NOT find PythonLibs: Found unsuitable version "2.7.2", but required is exact version "2.7.3" (found /usr/lib/libpython2.7.dylib)

--   Python:
--     Interpreter:                 /usr/local/bin/python2 (ver 2.7.3)
--     Libraries:                   /usr/lib/libpython2.7.dylib (ver 2.7.2)
--     numpy:                       /usr/local/lib/python2.7/site-packages/numpy/core/include (ver 1.7.0)
--     packages path:               lib/python2.7/site-packages 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:28:30.613

该错误告诉您问题是“mach-o, but wrong architecture”。这通常意味着您正在尝试在 64 位应用程序中加载 32 位库，反之亦然（或类似地，对于 Intel 与 PowerPC）。

无论您安装了哪种 Python，您都可能获得了一个可以作为 32 位应用程序或 64 位应用程序运行的通用构建，但默认情况下它以 64 位运行。但是您正在为 32 位明确构建 OpenCV：

```
$ cmake -G "Unix Makefiles" -D CMAKE_OSX_ARCHITECTURES=i386 -D CMAKE_C_FLAGS=-m32 -D CMAKE_CXX_FLAGS=-m32 .. 
```

如果这是一个错误，只需重建并且不要这样做。

如果你希望它是 32 位的，你可以在 32 位模式下启动一个 Universal python，或者安装一个 32 位的 Python。

* * *

同时，您正在尝试使用安装了 Homebrew 的 Python 2.7.3 来运行它，但很有可能您是针对 Apple 预安装的 2.7.2 构建它（或者，更糟糕的是，以一种方式部分地构建它，部分地构建它）其他）。

`sudo`首先，人们将 Homebrew 添加到他们的 PATH 的通常方式不会影响任何`sudo make install`使用.`cmake``make`

其次，Apple 的 Python 和 Homebrew 都认为自己拥有`/usr/local/lib/python2.7`（并且还认为他们拥有安装工具/脚本之类的专有权利`/usr/local/bin/pip-2.7`），这使得这更加痛苦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-16T23:59:42.203

根据我的经验，（来自 debian 的 arm-linux-gcc (uclibc) 交叉编译），

Python 试图使用 dlopen (/usr/lib/python2.7/site-packages/cv2.so) 加载正确的文件，但我得到“找不到文件”而文件存在。

在我的板上：

```
$ python
>>> import cv2
Traceback (most recent call last):
File "<stdin>", line 1, in <module>
ImportError: File not found 
```

事实上，动态加载试图加载递归依赖的库（当然）。但是，就我而言，libstdc++ 没有嵌入到我的板上，而 opencv 需要它：

主机端：

```
$ arm-linux-readelf -d ./lib/cv2.so 
Dynamic section at offset 0x24197c contains 23 entries:
Tag        Type                         Name/Value
0x00000001 (NEEDED)                     Shared library: [libpython2.7.so.1.0]
0x00000001 (NEEDED)                     Shared library: [libstdc++.so.6]
0x00000001 (NEEDED)                     Shared library: [libgcc_s.so.1]
0x00000001 (NEEDED)                     Shared library: [libc.so.0]* 
```

我希望它可以帮助。

# android - 如何以编程方式创建 ImageView 对象的多个副本？

> ID：15691377
> 
> 赞同：3
> 
> 时间：2013-03-28T20:18:28.157
> 
> 标签：android, imageview, clone, inflate

我在我的 XML 布局中定义了一个 ImageView 对象*R.id.tile*，我想要做的是创建它的克隆并将它们中的每一个放置在不同的坐标处。

这是我到目前为止所拥有的：

```
 protected void onCreate(Bundle savedInstance)
    {   super.onCreate(savedInstance);
        setContentView(R.layout.board_layout);
        layout = (AbsoluteLayout)findViewById(R.id.board);
        img = (ImageView)findViewById(R.id.tile);
        View[] tiles = new ImageView[9];
        for (int i = 0; i<tiles.length; i++) {
            tiles[i] = (ImageView)findViewById(R.id.tile);
        }

        for(int i=0; i<3; i++){
            for(int j=0; j<3; j++){
                tiles[i+j].setX((float) 32*2*i);
                tiles[i+j].setY((float) 34.39*2*j);
            }
        }
     ... 
```

但是当我调试它时，它会一直停在*tiles[i] = (ImageView)findViewById(R.id.tile);*
出现错误*“找不到源”。*

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-12-03T08:34:02.993

activity_main.xml

```
<LinearLayout
    android:id="@+id/linear"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="vertical">
</LinearLayout> 
```

MainActivity.java

```
ImageView iv;
LinearLayout linear;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    linear = new LinearLayout(this);
    linear = (LinearLayout)findViewById(R.id.linear);

    for(int i=1;i<10;i++)
    {
        iv = new ImageView(this);
        iv.setImageResource(R.drawable.plus);
        iv.setPadding(0,0,0,20);
        linear.addView(iv);
    }
} 
```

应用视图看起来像这个 [应用视图](https://i.stack.imgur.com/RMg1B.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-28T20:19:46.680

```
ImageView imageview=new ImageView(context); 
```

`imageview=yourimageview` // 原件的副本

对于你的问题试试这个

```
View[] tiles = new ImageView[9];
ImageView testview= (ImageView)findViewById(R.id.testview);

for (int i = 0; i<tiles.length; i++) {
            tiles[i] = new Imageview(context);
        } 
```

# parsing - 一些错误php

> ID：15691379
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:18:36.500
> 
> 标签：parsing, syntax

我需要一些帮助来解决这个错误；

```
Parse error: syntax error, unexpected T_VARIABLE 
```

线路是：

```
list( $fname, $size ) = fname                    $fname = trim( $fname );}" 
```

代码开头：

```
include( "{$include_path}/app/ftp.php" );
        $ftp_object = new FTP( "" );
        $ftp_object->login( $remote_store_array, $remote_store_array['user_login'], $decoded_temp_passwd );
        unset( $decoded_temp_passwd );
        $singlerow_archive = query_singlerow( $table = "store_files", "`id` = '{$singlerow_install['file_id']}'" );
        $ftp_object->file_size( $singlerow_archive['file'] );
        $zip_array = $ftp_object->listzips( );
        $ftp_object->logout( );
        $percent_uploaded = "";
        $archive_mb_size = sprintf( "%.1f", $singlerow_archive['size'] / 1024 / 1024 );
        if ( !empty( $zip_array ) )
        {
            foreach ( $zip_array as $fileinfo )
            {
                list( $fname, $size ) = fname                    $fname = trim( $fname );
                $size = trim( $size );
                }
                if ( !( $singlerow_archive['file'] == $fname ) && empty( $size ) )
                {
                    $percent_uploaded = sprintf( "%.1f", $size / $singlerow_archive['size'] * 100 );
                }
            }
        }
        if ( empty( $percent_uploaded ) )
        {
            $percent_uploaded = "0";
        }
        array_push( $admin_diag_msg, translate_text( "tpl_store_archive_upload_triggered", "upper" )." [ <span style=\"background-color : #ffffcc; padding : 5px;\">{$percent_uploaded} %</span> {$archive_mb_size} ".translate_text( "tpl_MB" )." ]" ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:22:17.907

尝试 ：`list( $fname, $size ) = $fname;`

# php - 根据mysql中的记录更新设置表单元素

> ID：15691381
> 
> 赞同：0
> 
> 时间：2013-03-28T20:18:44.170
> 
> 标签：php, javascript, html

我有一个 PHP 脚本可以加载 MYSQL 数据库表中的用户记录。

该数据库表包含来自该站点的其他评论，因为它只是一个评论表。

每个评论或条目都会收到它自己的唯一 ID。

一旦用户加载了他/她的评论。我在加载页面的表格上有一个按钮，允许他们更新该特定记录。

不知何故，我需要能够从 mysql 数据库中传递唯一 ID（也许通过按钮？）并将其放入表单上的隐藏字段中。

然后，当用户单击提交并更新与该唯一 ID 关联的记录且没有其他记录时，该表单将提交。

我已经尝试了几个小时试图找出这个问题的合乎逻辑的解决方案，但没有成功（显然）。我希望这对我的需求足够具体，任何帮助/建议将不胜感激！谢谢！

这是我的代码：

**这是在页面上加载评论的 php 脚本。**

```
<?php
  $con=mysqli_connect("");
  // Check connection
  if (mysqli_connect_errno())
  {
    echo "Failed to connect to MySQL: " . mysqli_connect_error();
  }

$result = mysqli_query($con,"SELECT * FROM comments
        WHERE email='$_SESSION[email]' ORDER BY dt");

echo "<table cellpadding='5' cellspacing='5' border='1' width='auto'>
    <tr>
    <td colspan='5' style='padding-right:15px; padding-bottom:5px; border:1px solid black; text-align:center;'>The Green Panda</td> 
                                                  </tr>
<tr>                                                                   <td colspan='2' style='padding-right:15px; padding-bottom:5px; border:1px solid black; text-align:center; vertical-align:center; background-color: #96b759; color: white;'>Date</td>
                                                <td colspan='2' style='padding-right:15px; padding-bottom:5px; border:1px solid black; text-align:center; vertical-align:center; background-color: #96b759; color: white;'>Email</td>
                                                <td colspan='2' style='padding-right:15px; padding-bottom:5px; border:1px solid black; text-align:center; vertical-align:center; background-color: #96b759; color: white;'>Review</td>
                                                <td colspan='2' style='padding-right:15px; padding-bottom:5px; border:1px solid black; text-align:center; vertical-align:center; background-color: #96b759; color: white;'>Update</td>
                                            </tr>";

                                while($row = mysqli_fetch_array($result))
                                  {
                                      echo "<tr>";
                                      echo "<td colspan='2' style='padding-right:15px; padding-bottom:5px; border:1px solid black; text-align:center; vertical-align:center; background-color: #758F45; color: white;'>" . $row['dt'] . "</td>";
                                      echo "<td colspan='2' style='padding-right:15px; padding-bottom:5px; border:1px solid black; text-align:center; vertical-align:center; background-color: #758F45; color: white;'>" . $row['email'] . "</td>";
                                      echo "<td colspan='2' style='padding-right:15px; padding-bottom:5px; border:1px solid black; text-align:center; vertical-align:center; background-color: #758F45; color: white;'>" . $row['body'] . "</td>";
                                      echo "<td colspan='2' style='padding-right:15px; padding-bottom:5px; padding-left: 10px; border:1px solid black; text-align:center; vertical-align:center; background-color: #758F45; color: white;'><input type='button' value='Update' onclick='showDiv()'/></td>";
                                      echo "</tr>";
                                  }
                                      echo "</table>";
                                ?> 
```

**这是html表单**

```
<div id="update-form"> 

                                    <form method="post" action="update.php">

                                        <label>Your Review:</label> 
                                        <input type="text" name="body">

                                        <input type="text" name="id" value="" readonly>

                                        <input type="submit" value="submit" onclick="hideDiv()"> 

                                    </form>

                                </div> 
```

**这是处理更新的 PHP 脚本（外部脚本）**

```
<?php
  $con=mysqli_connect("");
  // Check connection
  if (mysqli_connect_errno())
  {
    echo "Failed to connect to MySQL: " . mysqli_connect_error();
  }

  mysqli_query($con,"UPDATE comments SET body= '$_POST[body]'
  WHERE id='$_POST[id]'");

  mysqli_close($con);

  header("location:myReviews.php");

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:28:57.783

在您的 PHP 中，将当前记录的 id 注入每个按钮，如下所示：

```
<input type='button' value='Update' onclick='showDiv(" . $row['id'] . ")'/> 
```

我假设您的记录存储在 $row['id'] 中，但您可以根据需要进行调整。在您的“showDiv”javascript 方法中，在函数签名中创建一个参数，以捕获此传入值。它可能看起来像这样：

```
function showDiv(recId) {
    //recId is my record id, I can use it now!
    //....more javascript here that does stuff

    //access the input element that you want to put the record id into
    var recordIdElement = document.getElementById("recId");

    //finally, update its value to this new recId that was passed in
    recordIdElement.value = recId;
} 
```

您需要将此值传递到您的 id 元素中。在您的输入中添加一个 id 属性：

```
<input id="recId" type="text" name="id" value="" readonly> 
```

如果你真的希望它是一个隐藏元素，不要使用'type="text"'。相反，使用'type="hidden"'。

你最终会得到这个：

```
<input id="recId" type="hidden" name="id" /> 
```

# python - 使用命令 args 调用函数

> ID：15691384
> 
> 赞同：1
> 
> 时间：2013-03-28T20:18:55.157
> 
> 标签：python

我有以下代码。

```
import os, fnmatch, sys
print ("HERE")
def test(arg):
    print ("arg" + arg) 
```

`test`从命令行运行脚本时，我将如何调用该函数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:22:47.023

这个 python 成语也被大量使用：

```
if __name__ == "__main__":
    # do stuff
    ... 
```

当脚本从控制台运行时，这个 if 子句中的所有内容都将运行。这样您就可以将驱动程序代码放在模块文件等中。

如果您将`...`上面的内容替换为`test("blah blah")`您将得到您想要的结果:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T20:20:24.457

在 Python 中获取命令行选项的最简单方法是使用`sys.argv`. 这会以数组的形式为您存储任何命令行选项。

打印参数非常简单。

```
import sys
print(str(sys.argv)) 
```

如果您要在此脚本上运行以下命令行： `python test.py arg1 arg2 arg3`它将打印`['test.py', 'arg1', 'arg2', 'arg3']`

您可以使用它来构建调用您的函数。但是，您可能已经注意到我们的输出，它不仅包含您的参数，还包含我们执行的文件的名称。因此，我们需要首先确保用户向我们提供了至少一个参数，除了文件名。

我们使用[len](http://docs.python.org/2/library/functions.html#len)来做到这一点。

```
import sys
if len(sys.argv) > 1:
   print(sys.argv[1]) 
```

然后我们可以将它与您的函数一起使用来打印第一个参数。

```
import sys
def test(arg):
   print ("arg" + arg)
if len(sys.argv) > 1:
   test(sys.argv[1]) 
```

* * *

如果你想从命令行运行调用函数`test`，你最好使用类似于[OptionParser](http://docs.python.org/2/library/optparse.html)的东西来解析 args。不过，请记住，它`OptionParser`已被弃用，您应该考虑改用[ArgParse](http://docs.python.org/2/library/argparse.html#module-argparse)。

这是一个使用`OptionParser`and your 函数的工作示例。

```
from optparse import OptionParser

# Options/Args
parser = OptionParser()

# Add Options
parser.add_option("-t", "--test", dest="test")

# Parse the Options
(options, args) = parser.parse_args()
usage = "usage: %prog [options] arg"
parser = OptionParser(usage)

print ("HERE")
def test(arg):
    print ("arg: " + arg)

# If the command line for test was specified.
if options.test:
    # Run the test function.
    test(options.test) 
```

当您运行应用程序时，您只需添加`-t your-text`即可调用您的函数。

例如 `python3 test.py -t hello`

会输出：

```
HERE
arg: hello 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T20:25:23.787

Python 中的 def 结构是“定义”的缩写。您编写的代码块定义了测试函数，但没有调用它。在解释器中定义好测试函数后，就可以执行命令了

```
test('whatever') 
```

'whatever' 是你想要的任何东西。或者您可以在定义 test 后将该命令放入文件中，然后输入 test.py

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T20:20:53.510

在下面

```
def test(arg):
    print ("arg" + arg) 
```

写

```
test('testing') 
```

然后以与以前相同的方式运行它。要使用用户输入运行它，

```
uinpt = raw_input("Enter something: ")
test(uinpt) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-28T20:41:36.680

这是一个非常简单的示例，没有参数：

```
def do_hex():
text=raw_input("Enter string to convert to hexadecimal: ")
print "HEX: " + text.encode('hex')

#call the function

do_hex() 
```

# r - R 等效于 Stata 本地或全局宏

> ID：15691390
> 
> 赞同：5
> 
> 时间：2013-03-28T20:19:17.473
> 
> 标签：r, stata, local, stata-macros

我是一名尝试学习 R 的 Stata 用户。

我有几个冗长的文件夹路径，在我的 Stata 代码中，我存储为本地宏。我在这两个文件夹中有多个文件可用于我的分析。

我知道，在 R 中，每次我想引用其中一个文件夹中的文件时，我都可以更改工作目录，但这绝对不是一个好方法。即使我将文件夹路径作为字符串存储在 R 中，我也不知道如何引用它们。例如，在 Stata 中，我会使用“folder1”。

我想知道是否尝试在 R 中逐行重写 Stata 代码不是学习 R 的最佳方法。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T20:35:21.617

也许你想要`file.path()`？

```
a <- "c:"
b <- "users"
c <- "charles"
d <- "desktop"

setwd(file.path(a,b,c,d))
getwd()
#----
[1] "c:/users/charles/desktop" 
```

您可以包装`source`或`read.XXX`围绕它做任何您想做的事情。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-28T23:06:35.087

首先，作为前 Stata 用户，让我为 Stata 用户推荐[R。](https://rads.stackoverflow.com/amzn/click/com/1441913173)还有这篇关于[R 中的 Macros 的](http://www.r-project.org/doc/Rnews/Rnews_2001-3.pdf)文章。我认为@Nick Cox 是对的，您需要学习以不同的方式做事。但是像你一样（至少在这种情况下），我经常发现自己开始一项新任务，因为我事先知道如何在 Stata 中完成并从那里开始。有时我发现方法是相似的。有时我可以让 R 表现得像 Stata，而另一种方法会更好（例如，[循环与向量化](http://yihui.name/en/2010/10/on-the-gory-loops-in-r/)）。

我不确定我是否会用以下内容来捕捉你的问题，但让我试试。

在 Stata 中，通常会这样写：

```
global mydata "path to my data directory/" 
```

要导入数据，我只需键入：

```
insheet using "${mydata}myfile.csv" 
```

作为前 Stata 用户，我想在 R 中做类似的事情。这是我所做的：

```
mydata <- "path to my data directory/" 
```

要导入位于此目录中的 csv 文件并创建一个名为 myfile 的数据框，我将使用：

```
myfile <- read.csv(paste(mydata, "myfile.csv", sep="")) 
```

或者更有效...

```
myfile <- read.csv(paste0(mydata, "myfile.csv")) 
```

我还不是一个非常高效的 R 用户，所以也许其他人会看到这种方法的一些缺陷。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T20:44:04.497

我从上下文中猜测，将“本地”一词应用于文件时意味着它们已被加载到内存中以提高效率？如果是这样，那么您需要意识到几乎所有普通的 R 对象都是以这种方式处理的。见`?read.table`和`?load`。数据可以保持非本地的唯一方法是将其驻留在数据库中，该数据库具有支持 SQL 查询的接口包或使用专门的包，例如`ff`or `bycol`。

除了这个和 Chase 使用 file.path() 的想法之外，对文件或连接的任何引用都是使用正确的读取/加载/扫描函数完成的，其中字符值作为（各种命名的）参数给出。您可以通过该帮助页面中的一些附加链接查看各种低级功能，`?file`也许还可以通过该链接查看这些附加链接。您可以将一个或多个`file.path`构造结果存储在一个字符向量中，该字符向量可以命名以便于参考。

```
 pathvecs <- c(User= "~/", hrtg="~/Documents/Heritage/")
 pathvecs
#                   User                    hrtg 
#                   "~/" "~/Documents/Heritage/" 
pathvecs["hrtg"]
#                   hrtg 
#"~/Documents/Heritage/" 
```

# python - Tkinter - 如何禁用现有按钮

> ID：15691392
> 
> 赞同：1
> 
> 时间：2013-03-28T20:19:21.490
> 
> 标签：python, button, tkinter

我正在尝试使用 Tkinter 禁用按钮：

```
from Tkinter import *
import os

class OptionWindow:

    def __init__(self, value):

        self.master = Tk() 
        self.master.minsize(500,500)
        self.b1 = Button(self.master, text = "save Game", command =self.saveGame, state = NORMAL).grid(row = 0, column = 1, sticky = W)

   def saveGame(self):       
        from modules.startingKit import options
        options.saved = True
        self.b1.configure (state = DISABLED) 
```

然而，由于某种原因，当我按下“保存游戏”按钮时，它的外观并没有改变。我必须做什么才能禁用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T20:26:32.010

您犯了一个非常常见的错误，可能是因为互联网上有几个教程犯了同样的错误。

在 python 中，如果你这样做`x=foo().bar()`，`x`会给出`bar()`. 在您的代码中，您正在执行`self.b=Button(...).grid(...)`. 因此，`self.b`设置为 的结果`grid(...)`。`grid(...)`总是返回`None`。正因为如此，做`self.b.configure(...)`与做`None.configure(...)`显然不会做你认为它会做的事情是一样的。

解决方案是在单独的步骤中创建小部件和小部件布局：

```
self.b1 = Button(...)
self.b1.grid(...) 
```

# iphone - iOS：有没有办法在导航到其他视图控制器之前杀死 NavigationControl 的当前视图控制器？

> ID：15691405
> 
> 赞同：1
> 
> 时间：2013-03-28T20:20:26.077
> 
> 标签：iphone, ios

例如，导航控制器中的当前视图控制器是“A”。现在，在从“A”导航到“B”之前或之后，我想杀死“A”。有没有办法实现这种机制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:28:57.923

当然，做这样的事情：

```
NSMutableArray *vcArray = [[NSMutableArray alloc] initWithArray: self.navigationController.viewControllers];
[vcArray removeObjectAtIndex: 0];  
self.navigationController.viewControllers = vcArray;
// don't forget to release vcArray if you aren't using ARC 
```

# c - 这个指针是否安全声明？

> ID：15691408
> 
> 赞同：-2
> 
> 时间：2013-03-28T20:20:38.053
> 
> 标签：c, pointers

以下代码在同一函数中：

```
File *curr = dir -> head_file;
...
f -> next = curr; 
```

实际上是`f -> next`指向`dir -> head_file`还是局部变量`curr`？`curr`如，一旦这个函数退出，当消失或指向别的东西时会不会有问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:24:04.587

```
 f -> next = curr; 
```

指向`f->next`指向的地方`curr`，在这种情况下，它是`dir -> head_file`，它不会破坏指针`curr`或改变指向的方向`curr`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:24:12.000

`f->next`是存储在 中的值的副本`curr`。如果更改，如果没有为后者分配任何内容`curr`，则不会影响。`f->next`既不`curr`也不`f->next`指向`dir -> head_file`；它们都是副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:24:26.157

它是安全的，它指向`dir->header_file`.

注意类型并注意`&curr`具有`File **`不同类型的类型。要获取您使用的变量的地址`&`：`&curr`

# android - 我怎样才能旋转一个圆圈？

> ID：15691413
> 
> 赞同：-2
> 
> 时间：2013-03-28T20:20:52.397
> 
> 标签：android

我想顺时针旋转这个圆圈。

```
RadialGradient gradient = new RadialGradient(0, 0, 70,Color.YELLOW, Color.RED, Shader.TileMode.MIRROR);
paint.setShader(gradient);
            canvas.save();

            canvas.drawCircle(this.getWidth()/2, this.getHeight()/2, 40, paint);
canvas.rotate()
canvas.restore(); 
```

上面的代码不起作用。它不旋转为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T22:12:23.227

在画布上绘制**之前**旋转：

```
canvas.save();
canvas.rotate(degrees);
canvas.drawCircle(x, y, radius, paint);
canvas.restore(); 
```

您可以将该操作与在实际物理画布上绘制进行比较，首先旋转（`rotate`）它，然后`drawCircle`在其上绘制（ ），最后再次旋转回来（`restore`）。

# magento - 如何将具有自定义源的新属性添加到现有组

> ID：15691419
> 
> 赞同：1
> 
> 时间：2013-03-28T20:21:04.530
> 
> 标签：magento

我正在尝试将具有自定义源的新属性添加到现有组。但是，该属性永远不会出现在 UI 中。

是的，我禁用了缓存并在我的模块的 config.xml 中遇到了问题。

这是 mysql4-upgrade 脚本

```
$installer = $this;
$setup = new Mage_Eav_Model_Entity_Setup('core_setup');
$installer->startSetup();

$entityTypeId = Mage::getModel('eav/entity')
                ->setType('catalog_product')
                ->getTypeId();

$installer->addAttribute($entityTypeId, 'editor_form', array(
        'group'             => 'mygroup',
        'input'             => 'select',
        'type'              => 'int',
        'label'             => 'Editor form',
        'backend'           => '',
        'visible'           => 1,
        'required'          => 0,
        'global'            => Mage_Catalog_Model_Resource_Eav_Attribute::SCOPE_GLOBAL,
        'unique'            => false,
        'apply_to'          => 'simple,configurable,virtual,bundle,downloadable',
        'is_configurable'   => false,
        'source'            => 'sourcetype/attribute_source_type',
        'frontend_class'    => '',
        'frontend'          => '',
        'used_in_product_listing'   => false,
        'sort_order'        => 5,
    ));

$installer->endSetup(); 
```

以及 app/code/local/mycompany/w2p/Attribute/Source 中的自定义源

```
<?php
class mycompany_w2p_Sourcetype_Model_Attribute_Source_Type extends Mage_Eav_Model_Entity_Attribute_Source_Abstract
{
    public function toOptionArray()
    {
      return array(
            array('value' => 0, 'label'=>'Standard form'),
            array('value' => 1, 'label'=>'Custom form'),
        );
    }
} 
```

# javascript - 类事件只触发一个

> ID：15691420
> 
> 赞同：1
> 
> 时间：2013-03-28T20:21:06.283
> 
> 标签：javascript, jquery, javascript-events

带有链接的数据表

```
<strong>1</strong> <a href ='index.cgi?reqpage=2&job_category_id=1' class='paginateAdmin' id='nonItPaginate'>nextPage</a> 

$(document).ready(function () {
    $('.paginateAdmin').on('click', function (e) {
        e.preventDefault();
        var post = $(this).attr("href");
        var id = $(this).attr('id');
        var array = post.split('?');
        $.post(
            'index.cgi',
        array[1],
        function (data, status) {
            switch (id) {
                case "nonItPaginate":
                    $('#nonit').html(data);
                    break;
                case "ItPaginate":
                    $('#it').html(data);
                    break;
                case "govtPaginate":
                    $('#govt').html(data);
                    break;
                default:
            }
        });
    });
}); 
```

发布请求后，数据由链接组成

带有此链接的数据表

```
<strong>2</strong> <a href ='index.cgi?reqpage=3&job_category_id=1' class='paginateAdmin' id='nonItPaginate'>nextPage</a> 
```

但是当我点击下一页时，点击事件不起作用。如果它有效，以便我可以获得响应数据

数据表

```
<strong>3</strong> <a href ='index.cgi?reqpage=4&job_category_id=1' class='paginateAdmin' id='nonItPaginate'>nextPage</a> 
```

但它没有触发事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:49:36.947

这将只为所有具有类的现有元素`$('.paginateAdmin').on('click', function(){})`绑定事件。您需要改用这样的语法：`click``paginateAdmin``$(document).on('click', '.paginateAdmin', function(){...`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T21:08:12.030

解决方案是

```
$(document).ready(function() {

     $(document).on('click','.paginateAdmin',
            function(e){
    e.preventDefault();
        var post = $(this).attr("href");
        var id=$(this).attr('id');
        var array = post.split('?');

    $.post(
        'index.cgi',
        array[1],
        function(data,status){

           switch(id)
            {
                case "nonItPaginate":

                     $('#nonit').html(data);

                    break;
                case "ItPaginate":

                         $('#it').html(data);
                        break;
                case "govtPaginate":

                     $('#govt').html(data);
                    break;
            default:

                 }

    });

    });
     }); 
```

# objective-c - UIView 越界不透明

> ID：15691427
> 
> 赞同：0
> 
> 时间：2013-03-28T20:21:39.793
> 
> 标签：objective-c, uiview, shadow, quartz-core

我正在尝试做这样的事情：

![一个](../Images/c4f6b66c54cb3ec76347fb57e96f7d8f.png)！

我用过 QuartzCore，但它不起作用。

我做了什么：

1-创建 UIView`clipSubviews = NO;`

2-添加了一个可以移动和缩放的imaveview；

3-在第一个视图后面添加了另一个视图；

但它不起作用。

有谁知道我该怎么做类似图像的事情？

谢谢

# vba - excel中的VBA If语句

> ID：15691430
> 
> 赞同：0
> 
> 时间：2013-03-28T20:21:45.923
> 
> 标签：vba, excel, if-statement

我需要他帮助编写一个 If 语句，该语句将在每次单元格 D8 中的值超过 1 时运行一个宏。不知道从哪里开始

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:32:53.047

干得好...

```
Private Sub Worksheet_Change(ByVal Target As Range)

If Intersect(Target, Range("D1")) Is Nothing Then Exit Sub
If Not Range("D1").Value > 1 Then Exit Sub

MsgBox "D1 > 0"

End Sub 
```

有关 _Change 事件的更多信息：

[http://msdn.microsoft.com/en-us/library/office/ff839775.aspx](http://msdn.microsoft.com/en-us/library/office/ff839775.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T21:05:35.800

这是一个简单的 if 语句。

```
 If Range("D8").Value > 1 Then
        '~~> Your code here
    End If 
```

你可以把它放在`Worksheet_Change`事件中。我还建议阅读此[链接](https://stackoverflow.com/questions/13860894/ms-excel-crashes-when-vba-code-runs/13861640#13861640)，其中谈到`Worksheet_Change`

如果 in 中的值`Range("D8")`由于公式而发生变化，那么您可能必须使用该`_Calculate`事件。有关示例，请参见此[链接。](https://stackoverflow.com/questions/11406628/vba-code-doesnt-run-when-cell-is-changed-by-a-formula/11409569#11409569)

# javascript - 更改 Ruby 哈希的值

> ID：15691441
> 
> 赞同：0
> 
> 时间：2013-03-28T20:22:27.303
> 
> 标签：javascript, ruby-on-rails, ruby, morris.js

我正在尝试使用 morris.js ( [http://www.oesmith.co.uk/morris.js/donuts.html](http://www.oesmith.co.uk/morris.js/donuts.html) ) 制作甜甜圈图，但是在正确格式化数据时遇到了一些问题。

目前这是数据的格式。

```
{"2D"=>"6768.96", "1DP"=>"293.63", "3D"=>"84.97", "1D"=>"361.83", "GR-RES"=>"19083.85", "GR-COM"=>"11254.69"} 
```

以下是我当前的代码

```
<%= content_tag :div, "", id: "shipments-by-service-type", data: {shipments: @details.group(:family).sum("base_charge + discount")} %>

jQuery ->
  Morris.Donut
    element: "shipments-by-service-type"
    data: $('#shipments-by-service-type').data('shipments') 
```

这是我将数据传递到 js 并解析以制作图表的第一次体验，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:02:17.957

因此，一旦您更正了我在上面的评论中指出的引号问题，无论是转义还是将外部引号切换为单引号，此 javascript 都会解析您的输入并为甜甜圈图做好准备

```
var dataArr = [];
var obj = $("#shipments-by-service-type-simple").data('shipments');
for ( var prop in obj) {
  dataArr.push({"label": prop, "value": obj[prop]});
}

Morris.Donut({
  element: 'donut-example',
  data: dataArr
}); 
```

这是[jsbin](http://jsbin.com/axezax/1/edit)。拉斐尔似乎不喜欢十进制值并且正在抛出错误。可能想要四舍五入你的价值观

# java - 如何在 main() 中指定带有 Atmosphere 的 Spring Servlet

> ID：15691442
> 
> 赞同：2
> 
> 时间：2013-03-28T20:22:28.130
> 
> 标签：java, spring, sockets, atmosphere

目前我正在像这样在我的 main() 方法中实现氛围

```
public static void main(String[] args) throws IOException {
    final HttpServer server = HttpServer.createSimpleServer(".", 8181);

    WebappContext ctx = new WebappContext("Socket", "/");

    //allow spring to do all of it's stuff
    ctx.addListener("org.springframework.web.context.ContextLoaderListener");

    //enable web socket support
    final WebSocketAddOn addon = new WebSocketAddOn();
    for (NetworkListener listener : server.getListeners()) {
        listener.registerAddOn(addon);

        //if false, local files (html, etc.) can be modified without restarting the server
        //@todo experiment with this setting in production vs development
        listener.getFileCache().setEnabled(false);
    }

    //add jersey servlet support
    ServletRegistration jerseyServletRegistration = ctx.addServlet("JerseyServlet", new ServletContainer());
    //jerseyServletRegistration.setInitParameter("com.sun.jersey.config.property.packages", "come.fettergroup.production.queue.resources");
    jerseyServletRegistration.setLoadOnStartup(1);
    jerseyServletRegistration.addMapping("/api/*");

    //add atmosphere servlet support
    ServletRegistration atmosphereServletRegistration = ctx.addServlet("AtmosphereServlet", new AtmosphereServlet());
    atmosphereServletRegistration.setInitParameter("org.atmosphere.websocket.messageContentType", "application/json");
    atmosphereServletRegistration.setInitParameter("com.sun.jersey.api.json.POJOMappingFeature", "true");
    atmosphereServletRegistration.setLoadOnStartup(1); 
```

我怎样才能获取这个 XML 文件并完成同样的事情，但是在上面的代码中？

```
<atmosphere-handlers>
    <atmosphere-handler context-root="/api" class-name="org.atmosphere.handler.ReflectorServletProcessor">
        <property name="servletClassName"
                  value="com.sun.jersey.spi.spring.container.servlet.SpringServlet" />
    </atmosphere-handler>
</atmosphere-handlers> 
```

我已经研究过将处理程序分配给 Atmosphere，但它需要一个 `AtmosphereFramework`我无法获得的实例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:33:11.763

您可以通过执行以下操作添加您的 AtmosphereHandler：

```
AtmosphereServlet s = new AtmosphereServlet();
AtmosphereFramework f = s.framework();

ReflectorServletProcessor r = new ReflectorServletProcessor();
r.setServletClassName("com.sun.jersey.spi.spring.container.servlet.SpringServlet");

f.addAtmosphereHandler("/api/*", r);

ServletRegistration atmosphereServletRegistration = ctx.addServlet("AtmosphereServlet", s); 
```

感谢您填写问题顺便说一句，将改进常见问题解答

——让弗朗索瓦

# html - 为什么我的引导标签和徽章在我的三星 s3 上消失了

> ID：15691450
> 
> 赞同：5
> 
> 时间：2013-03-28T20:22:59.697
> 
> 标签：html, css, twitter-bootstrap

当页面第一次加载时，我的引导标签和徽章会从网页上消失，使用我的三星 Galaxy s3，它们只有在我刷新浏览器窗口后才会重新出现。为什么会发生这种情况，我该如何简单地强制它们在页面第一次加载时出现。我的标签和徽章不是空的，所以显示无功能与它无关。

第一次加载页面时不显示的代码示例如下：

```
 <span class="badge badge-important">info</span> 
```

也试图在没有运气的情况下删除下面

```
 .label:empty,
    .badge:empty { display: none; } 
```

普通的 boostrap.css 附加到我的页面上，它是唯一包含标签选择器的样式表。

有没有人遇到过这种奇怪的事情？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-15T16:54:45.380

好的，在三星 Galaxy Note 平板电脑、LG Optimus 手机和 LG Nexus 手机上遇到了这个问题。当我从引导 CSS 文件中完全删除以下代码时，问题就消失了。

消除：

```
.label:empty,
.badge:empty { display: none; } 
```

看起来三星/LG 浏览器忽略了 :empty ，只是让 .label 和 .badge 显示：none 是否为空。

我知道最初的提问者说他​​试过这个但它没有用（缓存问题可能？？？），但它确实对我有用，所以我想我至少会发布答案，因为这是＃1当我遇到问题时谷歌结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-05T11:13:09.980

我也有同样的问题。当我在我的网络浏览器中尝试这个时，一切正常。

```
<div>
  some text <span class='badge'>1</span>
</div> 
```

但是，当我在我的 android 浏览器中尝试时，徽章不显示。我解决了这个问题。

```
<div>
  <span> some text <span class='badge'>1</span> </span>
</div> 
```

# ruby - 试图在 windows xp 上的 watir-webdriver 上启动 IE，得到“Errno::EPERM: Operation not allowed - bind(2)”，stacktrace 指向 'port_prober'

> ID：15691453
> 
> 赞同：0
> 
> 时间：2013-03-28T20:23:08.630
> 
> 标签：ruby, internet-explorer-8, webdriver, port, watir-webdriver

所以我在 Windows XP 上，我试图让 watir-webdriver 运行 Internet Explorer 8。我已经将 IEDriverServer.exe 添加到 cygwin 的 /bin 中。我还暂时禁用了 Windows 防火墙和杀毒软件，但仍然收到此错误消息。

```
w = Watir::Browser.new :ie 
#=>
Errno::EPERM: Operation not permitted - bind(2)
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/common/port_prober.rb:28:in `initialize' from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/common/port_prober.rb:28:in `new'
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/common/port_prober.rb:28:in `block in free?' rom /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/common/port_prober.rb:26:in `each'
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/common/port_prober.rb:26:in `free?'
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/common/port_prober.rb:5:in `above'
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/ie/bridge.rb:18:in `block in initialize'
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/ie/bridge.rb:18:in `delete'
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/ie/bridge.rb:18:in `initialize'
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/common/driver.rb:35:in `new'
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver/common/driver.rb:35:in `for'
from /usr/lib/ruby/gems/1.9.1/gems/selenium-webdriver-2.31.0/lib/selenium/webdriver.rb:67:in `for'
from /usr/lib/ruby/gems/1.9.1/gems/watir-webdriver-0.6.2/lib/watir-webdriver/browser.rb:46:in `initialize'
from (irb):3:in `new' 
```

请注意，我第一次运行该程序时，虽然它立即崩溃并显示相同的错误消息，但我从 Windows 收到一个对话框，询问我是否要阻止某些操作。我告诉它“解锁”该动作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T11:02:14.547

看来您的 IE 配置文件有问题，最好删除 IE 并重新安装它，然后尝试使用您的代码调用浏览器，它应该可以工作。或者尝试更新也可以修复浏览器的IE。

# user-interaction - 灵活词云

> ID：15691455
> 
> 赞同：0
> 
> 时间：2013-03-28T20:23:09.373
> 
> 标签：user-interaction, word-cloud

我必须实现动态术语云。我需要让用户从云中删除术语或将它们从一个云分配到另一个云。它们还应该能够合并或分裂云。因此，云应该是完全动态的，用户可以自由地操纵它们。Java中有没有可以帮助我的库？是否已经有任何实现可用于此目的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T21:49:26.593

我发现了一个在测试阶段免费的 API。
[http://tagul.com/](http://tagul.com/) 用户可以从云中排除某些单词，您可以创建自定义形状和复制云。它生成的云具有翻转效果，可以导出为具有透明背景的图形。

# monodevelop - 使用 MonoDevelop 编译代码

> ID：15691458
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:23:16.190
> 
> 标签：monodevelop

我不明白 MonoDevelop 是如何编译代码的。一旦代码正确，我们选择“Build”，然后选择“Run”，就这样了吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T22:42:21.437

Command-Return（在 Mac 上）将运行调试。这就是我 99% 的时间使用的东西。一键轻松。可执行文件最终位于项目文件夹的 /bin 文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T22:38:36.557

最终，我安装了 Xamarin，一切正常，就像您在上面描述的那样。感谢您的耐心等待！

# javascript - 使用 jw Player 实时发布网络摄像头

> ID：15691463
> 
> 赞同：2
> 
> 时间：2013-03-28T20:23:38.207
> 
> 标签：javascript, flash, jwplayer

我使用 JW 播放器只是为了发布我的实时网络摄像头。实时网络摄像头流。我在网络摄像头所在的位置使用以下代码。

```
<script type='text/javascript' src="js/jquery.js"></script>
<script src="js/swfobject.js"></script>
<script type="text/javascript">
  var flashvars =
  {
    'streamer':                     'rtmp://69.160.44.133/SOSample',
    'file':                         'samplefile',
    'type':                         'camera',
    'controlbar':                   'bottom',
    'stretching':                   'none',
    'frontcolor':                   '86C29D',  // text & icons                  (green)
    'backcolor':                    '849BC1',  // playlist background           (blue)
    'lightcolor':                   'C286BA',  // selected text/track highlight (pink)
    'screencolor':                  'FFFFFF',  // screen background             (black)
    'id':                           'playerID',
    'autostart':                    'true'
  };

  var params =
  {
    'allowfullscreen':              'true',
    'allowscriptaccess':            'always',
    'bgcolor':                      '#FFFFFF'
  };

  var attributes =
  {
    'id':                           'playerID',
    'name':                         'playerID'
  };
  swfobject.embedSWF('player.swf', 'player', '320', '260', '9.0.124', false, flashvars, params, attributes);
</script> 
```

以及将显示流的以下代码。

```
<script type='text/javascript' src='js/jwplayer.js'></script>
<script type='text/javascript'>
 jwplayer('mediaspace').setup({
'flashplayer': 'player.swf',
'type': 'rtmp',
'streamer': 'rtmp://69.160.44.133/SOSample',
'autostart': 'true',
'bufferlength': '3',
'file': '<?php echo $selid; ?>',
'controlbar': 'bottom',
'width': '320',
'height': '260'
});
</script> 
```

一切正常，但音频不来。我做错了什么？

# matlab - 如何在matlab中将多项式作为输入？

> ID：15691467
> 
> 赞同：1
> 
> 时间：2013-03-28T20:23:50.443
> 
> 标签：matlab

我想将多项式 p 作为用户在 matlab 中针对给定度数（每次由用户指定）的输入，以便多项式一次将一个元素输入到从 1 到 n 的每个索引处的矩阵中。其中 n 是多项式次数。试图做这样的事情，但我卡住了

```
 for M = 1:n
        p[n] = input('polynomial')
        p
     end 
```

我应该如何在矩阵的每个索引处输入多项式系数，即如何到达每个索引位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:03:53.910

您可以使用以下方法将多项式作为输入，而不是使用循环：

```
p = input('Enter a polynomial in [] brackets'); 
```

现在用户应该像这样输入多项式：

```
[2, 4, 3, 8]; 
```

`length`然后您可以使用以下命令计算其度数：

```
n = length(p); 
```

# sonarqube - sonar-maven3-plugin 使用客户 checkstyle 文件分析多语言项目

> ID：15691468
> 
> 赞同：0
> 
> 时间：2013-03-28T20:23:51.390
> 
> 标签：sonarqube, checkstyle

我的项目有一个使用 Eclipse 创建的 .checkstyle 文件，该文件引用了一个 svn url 中保存的 checkstyle 文件。以下是文件如何引用外部 URL 的示例：

```
 <local-check-config name="My Checkstyle" location="https://svn.me.com/viewvc/dev-Standards/trunk/Checkstyle/My%20Checkstyle.xml" type="remote" description="">
    <additional-data name="cache-file" value="false"/>
  </local-check-config> 
```

该文件还为不同的文件类型标识了许多其他 checkstyle 配置文件类型。

有没有办法将此文件作为参数传递到 sonar-maven3-plugin 中？这是我目前如何调用声纳： mvn install org.codehaus.sonar:sonar-maven3-plugin:3.5-RC4:sonar

.checkstyle 文件位于项目的根目录，与 pom.xml 处于同一级别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:30:26.857

请参阅[http://docs.sonarqube.org/display/SONAR/Quality+profiles](http://docs.sonarqube.org/display/SONAR/Quality+profiles) - 具体来说，“[创建配置文件](http://docs.codehaus.org/display/SONAR/Quality+profiles)”。

基本上，在“设置”、“质量配置文件”、“Java 配置文件”下，单击“创建”。下一个对话框将包含一个选项，用于提供 Checkstyle 配置文件来填充新的质量配置文件。（提供它`My%20Checkstyle.xml`- 而不是`.checkstyle`文件，它特定于 eclipse-cs。）

# sas - 使用 scan(&varlist) 的错误 + 宏变量的比较

> ID：15691470
> 
> 赞同：0
> 
> 时间：2013-03-28T20:23:55.710
> 
> 标签：sas, sas-macro

作为这个问题的后续，我现有的答案似乎是最好的： [Extracting sub-data from a SAS dataset & apply to a different dataset](https://stackoverflow.com/questions/15650542/extracting-sub-data-from-a-sas-dataset-applying-to-a-different-dataset)

给定一个 dataset ，我目前有一组包含数字数据`dsn_in`的宏变量。我还有一个包含变量列表的宏变量。这两组宏是相关的，例如与等相关联。我正在尝试将每个变量中的数据值与相关的比较值进行比较- 。我想将更新后的数据输出到. 这是我到目前为止所拥有的：`max_1``max_N``varlist``max_1``scan(&varlist, 1)``dsn_in``varlist``max_1``max_N``dsn_out`

```
data dsn_out;
  set dsn_in;

  /* scan list of variables and compare to decision criteria.
     if > decision criteria, cap variable */
  do i = 1 by 1 while(scan(&varlist, i) ~= '');
    if scan("&varlist.", i) > input(symget('max_' || left(put(i, 2.))), best12.) then   
    scan("&varlist.", i) = input(symget('max_' || left(put(i, 2.))), best12.);
  end;  
run; 
```

但是，我收到以下错误，我不明白。`options mprint;`显示。当 SAS 是一个 SAS 函数时，它似乎同时被解释`scan`为一个数组和一个变量。

```
ERROR: Undeclared array referenced: scan.
MPRINT(OUTLIERS_MAX):   if scan("var1 var2 var3 ... varN", i) > input(symget('max_' 
|| left(put(i, 2.))), best12.) then scan("var1 var2 var3 ... varN", i) = 
input(symget('max_' || left(put(i, 2.))), best12.);
ERROR: Variable scan has not been declared as an array.
MPRINT(OUTLIERS_MAX):   end;
MPRINT(OUTLIERS_MAX):   run; 
```

您能提供的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:32:10.297

您在这里遇到的具体问题是您将 SCAN 放在等号的左侧。这是不允许的；允许以这种方式使用 SUBSTR，但不允许使用 SCAN。

# android - Eclipse 中的 android.R 出现问题的外部库

> ID：15691472
> 
> 赞同：1
> 
> 时间：2013-03-28T20:24:04.493
> 
> 标签：android, eclipse

我在我的 Android 项目中使用了一个外部库，它曾经可以正常工作。但是在对项目进行清理之后，外部库开始标记一些错误，例如 android.R.attr.ordering 和其他 android SDK 相关属性：

```
private static final int[] AnimatorSet = new int[] {
    /* 0 */ android.R.attr.ordering,
}; 
```

所有这些错误似乎都是 SDK 配置的问题，但我已经检查了 Window>Preferences>Android 并且我使用了正确的 SDK 位置。知道为什么会发生这种情况吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-14T19:13:04.013

[请注意，在 >> API 11](http://developer.android.com/reference/android/R.attr.html#ordering) <<中添加了 android.R.attr 。

检查 android:minSdkVersion 以将其指向清单文件中的 API 11：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="your.package.name.here"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="11"
        android:targetSdkVersion="19" />
... 
```

另外，右键单击您的项目并选择正确的 API

![在此处输入图像描述](../Images/b83dfe284b42020a123638394ba34828.png)

# c++ - C++ - MPIR：mpz_t 到 std::string？

> ID：15691477
> 
> 赞同：6
> 
> 时间：2013-03-28T20:24:16.110
> 
> 标签：c++, gmp

我们如何将 mpz_t 转换为 std::string？

```
mpz_t Var;

// Var = 5000
mpz_init_set_ui( Var, 5000 );

std::string Str = "";
// Convert Var to std::string?

mpz_clear( Var ); 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-28T20:34:19.220

您正在寻找[`mpz_get_str`](http://gmplib.org/manual/Converting-Integers.html)：

```
char * tmp = mpz_get_str(NULL,10,Var);
std::string Str = tmp;

// In order to free the memory we need to get the right free function:
void (*freefunc)(void *, size_t);
mp_get_memory_functions (NULL, NULL, &freefunc);

// In order to use free one needs to give both the pointer and the block
// size. For tmp this is strlen(tmp) + 1, see [1].
freefunc(tmp, strlen(tmp) + 1); 
```

但是，您不应该`mpz_t`在 C++ 程序中使用。改为使用[`mpz_class`](http://gmplib.org/manual/C_002b_002b-Class-Interface.html#C_002b_002b-Class-Interface)，因为它提供了`get_str()`方法，该方法实际上返回 a`std::string`而不是指向某些已分配内存的指针。

# ipython - ipython notebook 作为一个网络工具开发平台

> ID：15691479
> 
> 赞同：1
> 
> 时间：2013-03-28T20:24:25.233
> 
> 标签：ipython, ipython-notebook

我计划将现有应用程序（或至少部分用于处理数据以交互创建图形的应用程序）移植到基于 ipython 的 UI 中。我想知道是否可以使用 ipython notebook 作为引擎来创建基于菜单的应用程序。在 Ipython 中创建基于菜单的应用程序的任何功能？根据我迄今为止使用 Ipython 的经验，我想这是不可用的。

我正在考虑通过在降价单元格中创建 html 代码来模仿它，该代码将生成菜单作为选择列表，从那里选择和提交将调用服务器上的一些 cgi，该服务器将使用 AJAX 更新笔记本的下部。有人做过类似的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T22:20:42.787

没有什么能阻止您重用该组件。我们尝试使它们尽可能地可重用，并且应该易于使用我们的 javascript 来创建您自己的 js 前端。cf @minrk 示例[在这里](https://github.com/minrk/singlecell)。

如果一些修改使组件更加独立和可重用补丁是受欢迎的。在某些时候，我们甚至可以使用 bower/component.io/whatever 安装每个组件（代码单元、工具提示、完成器）

我建议不要在 markdown 单元格中通过 javascript 添加菜单，因为它将很快被禁用。

你可能想看看使用 ipython notebook 来做一些 noce 东西的 Exhibitionist [。](https://github.com/Exhibitionist/Exhibitionist)

# javascript - 在 javascript 警报中使用文本框值

> ID：15691481
> 
> 赞同：0
> 
> 时间：2013-03-28T20:24:28.480
> 
> 标签：javascript, asp.net

我写了这段代码

```
string javaScript = "<script language=JavaScript>\n" + "alert('Form Submitted Successfully!');\n" + "</script>";

ClientScript.RegisterStartupScript(this.GetType(), "Button1_ClickScript", javaScript); 
```

但我想在消息中放置一个文本框值。

我怎样才能做到这一点

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:26:56.250

给文本框（或者更好的 HTML`<input>`标签）一个 id：

```
 <input name="mytext" id="theId" value="somevalue"> 
```

并将其称为：

```
 alert(document.getElementById("theId").value); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:26:00.587

在您的警报中，您可以通过表单集合引用该元素：

```
<script type="text/javascript">
    alert(document.forms[0].elements["myTextBox"].value)
</script> 
```

你的文本框：

```
<textbox id="myTextBox"></textbox> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T20:31:52.890

以防万一您想使用服务器端代码构建消息 - 如下所示：

```
string javaScript = "<script language='JavaScript'>alert('Textbox value " + Server.HtmlEncode(txtYourTextBox.Text) + "');</script>";

ClientScript.RegisterStartupScript(this.GetType(), "Button1_ClickScript", javaScript); 
```

# c# - 无法隐式转换类型 - 缺少演员表 - models.views

> ID：15691482
> 
> 赞同：1
> 
> 时间：2013-03-28T20:24:54.783
> 
> 标签：c#, asp.net-mvc, asp.net-web-api

我在构建这段代码时遇到了麻烦——我有一个 api 控制器，它通过模型从服务层获取数据，这就是我所拥有的：

**api控制器**

```
public class RoleApiController : ApiController
{
    private RoleService _roleService = new RoleService();

    public RoleUser GetRoleUser(int sectionID)
    {
        if (sectionID != null)
        {
            return _roleService.GetUsers(sectionID);
        }
        throw new HttpResponseException(HttpStatusCode.NotFound);
    }
} 
```

**模型**

```
public partial class RoleView
{
    public RoleView()
    {
        this.Users = new HashSet<RoleUser>();
    }
    public ICollection<RoleUser> Users { get; set; }
}

public class RoleUser
{
    public string Name { get; set; }
    public string Email { get; set; }
} 
```

**错误信息：**

> 无法将 System.Collections.Generic.IEnumberable<...RoleUser> 类型隐式转换为 RoleUser。存在显式转换（缺少演员表？）

对于这一行：`return _roleService.GetUsers(sectionID);`

**JavaScript**

```
<div>
Name: <span id="name"></span>
</div>
<div>
    Email: <span id="email"></span>
</div>
<script type ="text/javascript" src="~/Scripts/jquery-1.9.1.min.js"></script>
<script type ="text/javascript">
    getRoleUser(9, function (roleUser) {
        $("#name").html(roleUser.Name);
        $("#email").html(roleUser.Email);
    });
    function getRoleUser(id, callback) {
        $.ajax({
            url: "/api/RoleUser",
            data: { id: id },
            type: "GET",
            contentType: "application/json;charset=utf-8",
            statusCod: {
                200: function (roleUser) { callback(roleUser); },
                404: function () { alter("Not Found!"); }
            }
success: function(result){
                result.each(function())
            }
        });
    }
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:26:21.917

嗯，当您应该只返回一个用户时，您返回了一组用户？我无法从您显示的代码中判断您是否真的想要一个集合，但这是您的问题。

这将使您的代码编译，但可能不是您想要的解决方案：

```
return _roleService.GetUsers(sectionID).FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:28:17.277

您的方法声明说它返回 RoleUser （单数），而您的方法将暗示它返回一个集合。因此，您要么需要修复方法以返回列表，要么只从 GetUsers 方法返回单个结果。

# android - 如何在 tabhost 的单个选项卡中实现一系列活动？

> ID：15691484
> 
> 赞同：0
> 
> 时间：2013-03-28T20:24:59.590
> 
> 标签：android, android-tabhost, fragment

我已经实现了一个 TabHost。在一个选项卡中，我有 Activity1，它在单击按钮后调用 Activity2，在单击按钮后调用 Activity3，在单击按钮后调用 Activity1，等等。不需要回栈功能，只需 1 --> 2 --> 3 --> 1 等等。所有三个活动都有一个单独的布局文件。

一切正常，除了从 1 --> 2 的第一次转换后，活动会占据整个屏幕并且选项卡永远不可见。

问题：如何将这三个活动保持在标签区域的范围内并且标签可见？这个问题之前已经在这里多次认识到了；以前的解决方案是 ActivityGroups，但这些已被弃用，建议使用 Fragment。我在这里看到了很多例子，但没有什么可以帮助我。

*   我可以保留我的三个活动（活动 1 扩展活动等）吗？
*   我应该在布局文件中添加片段标签吗？
*   我需要处理交易吗？
*   我应该使用一个片段类还是三个？

你能给我一些提示我应该怎么做吗？如果你告诉我需要使用哪些类以及它们是什么类型，我已经得到了帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T16:37:44.300

我花了半天多的时间，但终于找到了一个可行的解决方案。不幸的是，我仍然遇到过时的问题（Activity Group 和 getLocalActivityManager().startActivity(..)）。

同样，我在 TabHost 下有一个选项卡和几个活动，所有活动都在该选项卡内运行。从一个活动到下一个活动的导航是通过单击按钮进行的​​。解决方案：

*   在选项卡内操作的所有活动都需要扩展 ActivityGroup

*   所有 Activity 类都需要有一个按钮处理程序来链接到下一个活动，如下所示：

    public void onBtnClicked(View view) { Intent intent = new Intent(view.getContext(), NextActivity.class); replaceContentView("NextActivity", 意图); }

    public void replaceContentView(String id, Intent newIntent) { View view = getLocalActivityManager().startActivity(id, newIntent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP)).getDecorView(); this.setContentView(view); }

通过这种方式，选项卡根据需要始终保持可见。希望这可以帮助某人。

# batch-processing - Sybase ASE 数据清除批处理 - 确定要在事务中删除的行数

> ID：15691486
> 
> 赞同：1
> 
> 时间：2013-03-28T20:25:01.730
> 
> 标签：batch-processing, sap-ase

我们有多个使用 Sybase ASE 的应用程序（目前正在从 15.0 迁移到 15.7）。我正在开发一个通用实用程序，我们所有的 ASE 数据库都可以使用它来清除不需要的旧数据。该实用程序应该在指定的窗口（12:00 到 3:00 AM）运行，并且可以每天缓慢地删除数据，而不会影响其他用户或不会关闭数据库。由于涉及到多个具有不同参数的表，我需要找出一个最佳算法来确定每个事务中删除的行数。- 是否应该使用基于用户缓存/数据缓存/日志空间/其他参数的公式来计算删除的数据量？如果是这样，你能提供一个公式吗？- 现在，我正在使用以下蛮力安全限制并循环删除查询，在每次循环遍历时提交：

```
set rowcount 100 
```

此外，我们是否有办法考虑以下参数？如果是这样，我应该给这些参数中的每一个赋予多少权重？

1.  根据表的最大行大小，动态修复删除的行数？
2.  指数：
    *   如果删除条件与索引匹配，则删除 tran 中的更多行（多少行？）
    *   如果删除条件与索引匹配，请使用“select for update”（ASE 15.7）
    *   如果有其他索引与给定的列条件不匹配，我是否应该“选择到#temptbl”匹配输入条件的索引列值，然后删除加入#temptbl？
    *   如果根本没有索引，我是否应该使用表的最大行大小设置使用“设置行数”删除的行数？

# javascript - 获取当前认证用户的名字

> ID：15691487
> 
> 赞同：0
> 
> 时间：2013-03-28T20:25:09.223
> 
> 标签：javascript, node.js, xmpp, google-talk

是否可以从 Google Talk XMPP API 获取当前经过身份验证的用户的名称？我知道可以使用[this](https://developers.google.com/talk/jep_extensions/roster_attributes?hl=en#3)获取联系人的姓名，但它不会返回您的姓名，而只会返回您的联系人。

PS 我正在使用[node-xmpp](https://github.com/astro/node-xmpp)模块来连接 API。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T11:29:51.540

您可以请求自己的 Vcard 并从之前设置的响应中获取您的姓名。见：http: [//xmpp.org/extensions/xep-0054.html](http://xmpp.org/extensions/xep-0054.html)

例子：

```
<iq id='get_vcard'        
    type='get'>
  <vCard xmlns='vcard-temp'/>
</iq>

<iq id='get_vcard'
    to='your_full_jid'
    type='result'>
  <vCard xmlns='vcard-temp'>
    <FN>Your Full Name</FN>
    <N>
      <FAMILY>Familiy Name</FAMILY>
      <GIVEN>Given Name</GIVEN>
      <MIDDLE/>
    </N>
    <NICKNAME>nickname</NICKNAME>
  </vCard>
</iq> 
```

# c# - MEF CS0234：命名空间“System.ComponentModel”中不存在类型或命名空间名称“Composition”（您是否缺少程序集引用？）

> ID：15691489
> 
> 赞同：5
> 
> 时间：2013-03-28T20:25:19.397
> 
> 标签：c#, asp.net

我在 ComponentModel.Composition 中添加了；组装。但显示此错误

使用 System.ComponentModel.Composition；

和大会参考

仍然得到错误

**CS0234：命名空间“System.ComponentModel”中不存在类型或命名空间名称“Composition”（您是否缺少程序集引用？）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-01-10T11:29:50.393

1.  首先（如果需要）在 Visual Studio 2012 或更高版本中打开您的项目，从“项目”菜单中选择“管理 NuGet 包”，然后在线搜索 Microsoft.Composition 包。

2.  右键单击您的项目并选择“添加引用”。在 Framework 列表中找到 System.ComponentModel 并添加它或适用的子程序集。

这就是我遇到这个问题时所做的一切。

# html - CSS - 如何在浏览器窗口调整大小期间将图像保留在容器中？

> ID：15691493
> 
> 赞同：1
> 
> 时间：2013-03-28T20:25:30.037
> 
> 标签：html, css

我有两个问题；

1) 我希望标题中的图像在浏览器窗口调整大小期间保持在我的 990px​​ 标题内。

2）如何将（中间）图像与标题对齐？

[这是我调整大小后得到的](http://img15.imageshack.us/img15/7527/actual1.gif)

橙色图像位于黑色图像之下。

[虽然他们想保持这样（当然在 990 像素以内）](http://img560.imageshack.us/img560/2539/template1.gif)

这是代码：

```
 body {
                background-color: #e8e8e8;
                font-family: Arial, Helvetica, sans-serif;
                font-size:12px;
                padding: 0;
                margin: 0;
            }
            h1 {
                padding: 0px;
                margin: 0px;
            }
            #container {
                margin:0px auto;
                border:0px solid #bbb;
                padding:10px;
                min-width: 990px;
            }
            .white-box {
                width: 180px;
                margin: 0px;
            }
            #main-header {
                border:1px solid #bbb;
                height:98px;
                padding:3px;
                background:#FFF
                min-width: 930px;
            }
            #main-content {
                margin-top:10px;
                padding-bottom:10px;
            }
            #main-body {
                margin-left:10px;
                width:666px;
                height:150px;
            }
            #main-footer {
                margin-top:10px;
                margin-bottom:10px;
                padding:10px;
                border:1px solid #bbb;
            }
            .box {
                padding: 8px;
                border: 1px solid silver;
                -moz-border-radius: 8px;
                -o-border-radius: 8px;
                -webkit-border-radius: 5px;
                border-radius: 8px;
                background-color: #fff;
            }
            .box1 {
                width: 200px;
                float: left;
            }
            .box2 {
                margin-left: 224px;
            }

            div.left {
                width: 200px;
                float: left;
            }

            div.right {
                width: 730px;
                float: right;
                margin-right:3px;
            }
            </style>
            </head>
            <body>
            <div id="main-header">
            <div class="left"><img src="imgn/banners/logo.gif" border="0" alt=""></div>
            <div class="right"><img src="imgn/banners/banner1.gif" border="0" alt=""></div>
            </div>
            <div id="container">

                <div id="main-content">
                    <div class="box box1">
                    left
                    </div>

                    <div class="box box2">
                    <p>Main Bbody 1...</p>
                    </div>
                </div>

                <div id="main-footer">Main Footer</div>
            </div>
            </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:37:21.997

使用 CSS`background-image`属性而不是使用图像。这样，您可以根据调整大小后窗口的新大小，将容器`div`的宽度设置为外部 div 宽度的百分比。`container`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T22:30:06.383

**HTML：**

```
<div id="main-header">
    <div class="left"><img src="imgn/banners/logo.gif" alt="" border="0"></div>
        <div class="right"><img src="imgn/banners/banner1.gif" alt="" border="0"></div>
    </div>
    <div id="container">
        <div id="main-content">
            <div class="box box1">
                left
            </div>

            <div class="box box2">
                <p>Main Bbody 1...</p>
            </div>
            <div style="clear:both;"></div>
        </div>

        <div id="main-footer">Main Footer</div>
    </div> 
```

**CSS：**

```
body {
                background-color: #e8e8e8;
                font-family: Arial, Helvetica, sans-serif;
                font-size:12px;
                padding: 0;
                margin: 0;
            }
            h1 {
                padding: 0px;
                margin: 0px;
            }
            #container {
                margin:0px auto;
                border:0px solid #bbb;
                padding:10px;
                min-width: 990px;
            }
            .white-box {
                width: 180px;
                margin: 0px;
            }
            #main-header {
                border:1px solid #bbb;
                height:98px;
                padding:3px;
                background:#FFF
                min-width: 933px;
            }
            #main-content {
                margin-top:10px;
                padding-bottom:10px;
            }
            #main-body {
                margin-left:10px;
                width:666px;
                height:150px;
            }
            #main-footer {
                margin-top:10px;
                margin-bottom:10px;
                padding:10px;
                border:1px solid #bbb;
            }
            .box {
                padding: 8px;
                border: 1px solid silver;
                -moz-border-radius: 8px;
                -o-border-radius: 8px;
                -webkit-border-radius: 5px;
                border-radius: 8px;
                background-color: #fff;
            }
            .box1 {
                width: 200px;
                float: left;
            }
            .box2 {
               float:right; margin-left:0px; width:748px;
            }

            div.left {
                width: 200px;
                float: left;
            }

            div.right {
                width: 730px;
                float: right;
                margin-right:3px;
            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-29T08:36:33.170

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<style>
body {  background-color: #e8e8e8;                 font-family: Arial, Helvetica, sans-serif;               font-size:12px;                padding: 0;                margin: 0;            }
            h1 {                padding: 0px;                margin: 0px;            }
            #wrapper{width:990px; margin:0 auto;}
            #container {                margin:0px auto;                border:0px solid #bbb;                padding:10px;                width: 990px;            }
            .white-box {                width: 180px;                margin: 0px;            }
            #main-header {                border:1px solid #bbb;                height:98px;               padding:3px;                background:#FFF; width: 990px; margin:0px auto;   }
            #main-content {             margin-top:10px;                padding-bottom:10px;            }
            #main-body {                margin-left:10px;                width:666px;                height:150px;            }
            #main-footer {                margin-top:10px;                margin-bottom:10px;                padding:10px;                border:1px solid #bbb;            }
            .box {                padding: 8px;                border: 1px solid silver;                -moz-border-radius: 8px;                -o-border-radius: 8px;                -webkit-border-radius: 5px;                border-radius: 8px;                background-color: #fff;            }
            .box1 {                width: 200px;                float: left;            }
            .box2 {               float:right; margin-left:0px; width:748px;            }
            div.left {                width: 200px;                float: left;            }
            div.right {                width: 730px;                float: right;                margin-right:3px;            }
            </style>
</head>

<body>
<div id="wrapper">
<div id="main-header">
    <div class="left"><img src="http://img89.imageshack.us/img89/2675/logoxnx.gif" alt="" border="0"></div>
        <div class="right"><img src="http://img199.imageshack.us/img199/9759/banner2b.gif" alt="" border="0"></div>
    </div>
    <div id="container">
        <div id="main-content">
            <div class="box box1">
                left
            </div>

            <div class="box box2">
                <p>Main Bbody 1...</p>
            </div>
            <div style="clear:both;"></div>
        </div>

        <div id="main-footer">Main Footer</div>
    </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-03T14:43:27.260

正如皮特在另一个线程中所建议的那样：您需要将#main-header 的最小宽度增加到大约 950px

# android - 如何确定设备最近在 Android 中何时解锁？

> ID：15691497
> 
> 赞同：1
> 
> 时间：2013-03-28T20:25:41.240
> 
> 标签：android, orientation, unlock

我构建了一个应用程序，该应用程序在每次方向更改时都会触发一个活动，但我有一个例外：我不希望该活动在手机解锁后的接下来的五秒钟内触发。

所以在手机解锁后，我会在五秒钟内忽略每次手机方向的变化。
我以为我可以获得*最后一次解锁时间*并将其与当前时间进行比较？

关于如何做到这一点的任何建议？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:27:59.727

为 注册一个广播接收器[`ACTION_USER_PRESENT`](http://developer.android.com/reference/android/content/Intent.html#ACTION_USER_PRESENT)，并在其中启动一个处理程序以在至少五秒后运行您的活动。

您必须动态注册接收器，因为如果您从清单中注册，则不会调用 ACTION_USER_PRESENT。

```
IntentFilter filter = new IntentFilter(Intent.ACTION_USER_PRESENT);
BroadcastReceiver mReceiver = new YourReceiver();
registerReceiver(mReceiver, filter); 
```

# jquery - 使用 jQuery 进行顺序 XML 过滤？

> ID：15691498
> 
> 赞同：0
> 
> 时间：2013-03-28T20:25:41.570
> 
> 标签：jquery, xml

我正在尝试按顺序解析 XML - 我不只是一次查找多个属性的原因是因为某些必需的属性将需要 if 语句，因此我正在尝试为此进行设置。我尝试了下面的代码，但它不起作用 - 只是返回了一个空白响应（将内容区域变为空白，没有填充）。我知道其余代码有效，因为我已经对其进行了测试。

```
$.get('wallets.xml', function(data) {
    $('#content').empty();
    var $genders = $(data).find('wallet[gender=' + genderChosen + ']');
    $genders.find('wallet[material="leather"]').each(function() {
        var $wallet = $(this);
        printWallet($wallet);
    });
    });
} 
```

请注意我是如何尝试按一个属性过滤 XML 结果，然后获取这些结果并按另一个属性过滤它们。我怎样才能做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:32:13.283

请注意，该`find`方法搜索您调用它的集合的*后代*。看到您的两个选择器都使用标签 name `wallet`，我怀疑您打算使用`filter`第二次，这会通过选择器表达式缩小集合范围：

```
$.get('wallets.xml', function(data) {
    $('#content').empty();
    var $genders = $(data).find('wallet[gender=' + genderChosen + ']');
    $genders.filter('wallet[material="leather"]').each(function() {
        var $wallet = $(this);
        printWallet($wallet);
    });
}); 
```

您还遇到了语法错误，已在上面的代码段中更正。其他可能的错误来源可能是`printWallet`什么都不做，或者您的 XML 格式不正确。

# javascript - 如何在一组点上绘制闭合曲线？

> ID：15691499
> 
> 赞同：1
> 
> 时间：2013-03-28T20:25:41.767
> 
> 标签：javascript, math, drawing, spline

基本上我想绘制一个多边形，但我希望边缘看起来柔软而不是坚硬。由于多边形的形状很重要，因此边缘必须越过这些点。

我发现单调三次样条对于开放曲线是准确的（即，不环绕自身的曲线），但我发现的算法预先计算点 0 和 N。我可以以某种方式将它们更改为与闭合曲线一起使用曲线？

我在 JavaScript 中实现它，但伪代码也一样。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-29T04:39:17.027

[有一种简单的方法](http://www.antigrain.com/research/bezier_interpolation/index.html#PAGE_BEZIER_INTERPOLATION)（由 Maxim Shemanarev 开发）来构建（通常）在一组点上设置的好看的封闭贝塞尔曲线。例子：

![在此处输入图像描述](../Images/57cc3e3b97e92e730dc63cddabc9d4f3.png)

算法的关键时刻：

![在此处输入图像描述](../Images/6444bd84b09996497453725b4f25c69b.png) ![在此处输入图像描述](../Images/7ff123a8330f11530a144117141ed67a.png) ![在此处输入图像描述](../Images/236b4051ecb3bdd883ac977941a921cc.png) ![在此处输入图像描述](../Images/4f1093700aaa30ebf1243090c8d85762.png)

和示例代码：

```
 // Assume we need to calculate the control
    // points between (x1,y1) and (x2,y2).
    // Then x0,y0 - the previous vertex,
    //      x3,y3 - the next one.

    double xc1 = (x0 + x1) / 2.0;
    double yc1 = (y0 + y1) / 2.0;
    double xc2 = (x1 + x2) / 2.0;
    double yc2 = (y1 + y2) / 2.0;
    double xc3 = (x2 + x3) / 2.0;
    double yc3 = (y2 + y3) / 2.0;

    double len1 = sqrt((x1-x0) * (x1-x0) + (y1-y0) * (y1-y0));
    double len2 = sqrt((x2-x1) * (x2-x1) + (y2-y1) * (y2-y1));
    double len3 = sqrt((x3-x2) * (x3-x2) + (y3-y2) * (y3-y2));

    double k1 = len1 / (len1 + len2);
    double k2 = len2 / (len2 + len3);

    double xm1 = xc1 + (xc2 - xc1) * k1;
    double ym1 = yc1 + (yc2 - yc1) * k1;

    double xm2 = xc2 + (xc3 - xc2) * k2;
    double ym2 = yc2 + (yc3 - yc2) * k2;

    // Resulting control points. Here smooth_value is mentioned
    // above coefficient K whose value should be in range [0...1].
    ctrl1_x = xm1 + (xc2 - xm1) * smooth_value + x1 - xm1;
    ctrl1_y = ym1 + (yc2 - ym1) * smooth_value + y1 - ym1;

    ctrl2_x = xm2 + (xc2 - xm2) * smooth_value + x2 - xm2;
    ctrl2_y = ym2 + (yc2 - ym2) * smooth_value + y2 - ym2; 
```

# opengl - 如何识别opengl中的交叉线？

> ID：15691505
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:26:07.033
> 
> 标签：opengl, graphics

我正在尝试编写一个程序，当两条线相互交叉时，我应该在其中识别。谁能帮我 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T01:47:25.720

OpenGL 用于*渲染*几何图形。这是一个简单的数学问题，您不需要 OpenGL 来解决。您通常会在几何库或场景图中使用算法。CGAL 在这里有一篇很好的文章：

*   [http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Sweep_line_2/Chapter_main.html](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Sweep_line_2/Chapter_main.html)

# c# - 必须先关闭 DataReader，然后我的 LINQ 查询

> ID：15691510
> 
> 赞同：2
> 
> 时间：2013-03-28T20:26:34.463
> 
> 标签：c#, linq

`Name`我正在尝试使用 LINQ使用 EF 从我的数据库中选择一堆对象。问题是我收到一个错误：

> 已经有一个与此命令关联的打开的 DataReader，必须先关闭它。

`Project`是一个包含有关该项目的信息的类型。它是名称类的导航属性。导致此错误的我的 LINQ 查询有什么问题。

```
var allNames = from n in _db.DCENames
               orderby n.BrandName ascending
               select n;

foreach (Name name in allNames)
{
    NameDbModel data = new NameDbModel();
    data.id = name.Id;
    data.BrandName = name.BrandName; 
    data.MarkType = name.Project.MarkType;
    data.DateAdded = name.DateAdded;
    data.PrimarySector = name.Project.PrimarySector;
    data.ProjectName = name.Project.ProjectName; 
    data.Status = name.Project.ProjectStatus;
    data.ProjectId = name.Project.ProjectId;
    data.Notes = "";
    model.Add(data);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T20:30:16.357

LINQ 查询不会获取数据，它只会创建一个可以获取数据的枚举，因此数据读取器是打开的，直到您获取最后一项。

使用`ToList`方法在使用它们之前将所有记录读入列表：

```
foreach (Name name in allNames.ToList()) 
```

# python - Python ImportError 关键字参数

> ID：15691517
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:27:02.573
> 
> 标签：python

我有以下问题。我想要一个对象类，它将预定义对象作为超类作为关键字参数。

但我得到了错误：

```
ImportError: cannot import name Object 
```

代码：

```
import Object

class Object:

    defaultobject = Object('defaultobject', None)

    def __init__(self, name, superclass = defaultobject):
        self.__name = name
        self.__superclass = superclass 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:34:47.450

您无法导入您所在的*模块*。您必须将`Object()`实例化移动到 类定义*之后：*

```
class Object:
    defaultobject = None

    def __init__(self, name, superclass=None):
        self.__name = name

        if superclass is None:
            superclass = self.defaultobject
            if superclass is None
                # No default set yet, use `self` instead (it'll *be* the default)
                superclass = self

        self.__superclass = superclass

Object.defaultobject = Object('defaultobject', None) 
```

您始终可以向类定义添加更多属性，但要*创建*类的实例，您首先需要定义它。

舞蹈是必要的`superclass is None`，因为否则你在这里有一个catch-22；`Object`如果不先设置，您将无法创建实例`Object.defaultobject`。您不能这样做，因为您尚未创建默认值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-17T09:33:05.393

可以通过从父类中删除导入库来解决此问题，该导入库也由其某些子类导入。如果您的子类也使用导入对象，那么从父类中删除该对象将解决问题。

# php - 使用 shell_exec 从 php 脚本运行 unoconv 的问题

> ID：15691521
> 
> 赞同：0
> 
> 时间：2013-03-28T20:27:16.587
> 
> 标签：php, shell, pdf, command, uno

我无法使用 unoconv 使用 exec 将 .doc 从 php 转换为 PDF。这是我正在尝试的：

```
$output = exec("unoconv /opt/bitnami/apache2/htdocs/=".$fileData['name']);
error_log(print_r($output, TRUE)); 
```

该命令在控制台中运行时可以完美运行，但是通过 php 运行时，它会在错误日志中显示以下内容：

```
python: /opt/bitnami/common/lib/libcrypto.so.1.0.0: no version information available (required by python)
python: /opt/bitnami/common/lib/libssl.so.1.0.0: no version information available (required by python)
Aborted
[Thu Mar 28 20:13:58.312843 2013] [:error] [pid 1481] [client ***] 
```

我不认为前两行是相关的，我不确定如何获得有关它为什么中止的更多信息。我也尝试使用存储在 /usr/local/bin/unoconv.sh 中的这个包装器来运行它

```
#!/bin/bash

if [ -z "$1" ]; then
    echo "Must pass file";
    exit 10;
fi

/usr/bin/unoconv -f pdf $1.rtf 
```

但这给出了错误

```
python: /opt/bitnami/common/lib/libcrypto.so.1.0.0: no version information available (required by python)
python: /opt/bitnami/common/lib/libssl.so.1.0.0: no version information available (required by python)
/usr/local/bin/unoconv.sh: line 8:  2886 Aborted                 /usr/bin/unoconv $1
[Thu Mar 28 20:17:05.331830 2013] [:error] [pid 1188] [client ***] 
```

关于还有什么可以尝试的任何想法？谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-15T15:40:26.430

我已经用 exec();

```
$path_exe = "\"C:\Program Files (x86)\LibreOffice 4\program\python.exe\" c:\unoconv\unoconv -f png ";
exec('"C:\Program Files (x86)\LibreOffice 4\program\python.exe" c:\unoconv\unoconv -f pdf 'c:\'.$filename, $array_buffer, $code_error); 
```

您应该指定 python.exe 的路径和**unoconv的路径**

# python - Python + Mapnik：关于如何渲染带有 gps 轨迹的地图的示例

> ID：15691525
> 
> 赞同：6
> 
> 时间：2013-03-28T20:27:32.447
> 
> 标签：python, render, openstreetmap, mapnik

我正在尝试使用 mapnik 和 python 从记录的 GPS 轨迹中渲染地图。我从数据库中获取 gps 数据，所以它只是一个数组（纬度，经度）。

有谁知道这样做的例子？我知道我需要先创建一个形状文件，但我是 mapnik 的新手，到目前为止我还不太了解。也许有一个很好的例子我会明白的:-)

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-12T00:30:03.820

最简单的方法实际上是使用 KML 文件。安装[simplekml](https://code.google.com/p/simplekml/)模块，然后运行您的阵列以创建 KML 文件。

```
import simplekml
kml = simplekml.Kml()
for i, coord in enumerate(coords):
    # assuming coord is a lat, lon tuple
    kml.newpoint(name="Point %s" % i, coords=[coord])

kml.save("GPS_tracking_data.kml") 
```

现在您可以将其作为数据源加载到 mapnik 中并绘制它；

```
import mapnik
# Setup the map
map_canvas = mapnik.Map(width_in_px, height_in_px)
map_canvas.background = mapnik.Color('rgb(0,0,0,0)') # transparent

# Create a symbolizer to draw the points
style = mapnik.Style()
rule = mapnik.Rule()
point_symbolizer = mapnik.MarkersSymbolizer()
point_symbolizer.allow_overlap = True
point_symbolizer.opacity = 0.5 # semi-transparent
rule.symbols.append(point_symbolizer)
style.rules.append(rule)
map_canvas.append_style('GPS_tracking_points', style)

# Create a layer to hold the ponts
layer = mapnik.Layer('GPS_tracking_points')
layer.datasource = mapnik.Ogr(file="GPS_tracking_data.kml", layer_by_index=0)
layer.styles.append('GPS_tracking_points')
map_canvas.layers.append(layer)

# Save the map
map_canvas.zoom_all()
mapnik.render_to_file(map_canvas, 'GPS_tracking_points.png', 'png') 
```

那应该差不多了。python+mapnik 的文档有点弱，但如果您参考，您应该能够在此基础上进行构建；

1.  [mapnik 维基](https://github.com/mapnik/mapnik/wiki)
2.  [python mapnik 包文档](http://mapnik.org/docs/v2.1.0/api/python/mapnik-module.html)

# linux - Emacs Cx Cs save 命令创建重复项

> ID：15691531
> 
> 赞同：1
> 
> 时间：2013-03-28T20:28:14.393
> 
> 标签：linux, emacs, command-line

当我在 emacs 中保存文件（使用 Cx Cs）然后退出时，该文件被复制，但一个文件以“~”结尾。例如，如果我在 emacs 中保存了一个文件 test.txt，我的目录会在保存后显示文件 test.txt 和 test.txt~。为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:30:23.450

它们是备份副本，如果您的文档出现问题，它们会非常有用。但是，您可以将它们保存[的目录更改为当前目录以外的其他目录。](http://emacswiki.org/emacs/BackupDirectory)

从链接的文档：

> 如果你不想让 Emacs 的备份文件弄乱你的文件树，你可以将它们保存到系统的“temp”目录：
> 
> ```
> (setq backup-directory-alist
>       `((".*" . ,temporary-file-directory)))
> (setq auto-save-file-name-transforms
>       `((".*" ,temporary-file-directory t))) 
> ```
> 
> 这会将所有自动保存和备份都放在临时文件目录指向的目录中（例如，Windows 上的 C:/Temp/）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:29:34.510

名称以波浪号结尾的文件`~`是备份副本。它应该包含启动 Emacs 之前文件中的内容。

# map - QGis：如何将 svg 或光栅图像导入 Quantum GIS？

> ID：15691541
> 
> 赞同：10
> 
> 时间：2013-03-28T20:28:41.710
> 
> 标签：map, gis, wikipedia, openstreetmap, qgis

这些矢量或光栅文件是没有地理坐标的经典文件。它们是纬度/经度投影，我想将它们导入 QGIS，放大/缩小它们，将它们放置到正确的位置，它们成为可重复使用的 shp 或栅格地理坐标图层。

编辑：我来自维基百科图形实验室>地图研讨会，我们希望更多地使用 GIS。我们几乎有数百张地图可以迁移到 GIS 技术......

*   [文件：Chinese_plain_5c._BC-en.svg](http://en.wikipedia.org/wiki/File:Chinese_plain_5c._BC-en.svg)
*   [文件：Vignobles_basse_loire.svg](http://upload.wikimedia.org/wikipedia/commons/b/b1/Vignobles_basse_loire.svg)

![在此处输入图像描述](../Images/b74c47ca988c8f20c462bd0c65a239ec.png) ![在此处输入图像描述](../Images/6911fff820912be6521c89215cae4c3c.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-01T15:15:09.487

Partial Solution: load SVG into Inkscape, Save as DXF file, then you can load this into QGIS. This should at least get you most of the linework into QGIS.

However, it won't yet be properly georeferenced or styled, and different layers may be in different places because the SVG has some scaling and translating operators on parts of the map data that QGIS or Inkscape is ignoring. You'll probably need to work with a layer at a time. This probably isn't a problem since maybe you are only interested in the added data on the map, and not the base map (country outlines etc) since you will probably want to overlay your data onto standard map base layer (natural earth, OpenStreetMap tiles).

The only way I see to do the transformation at present is to work out the affine transformation parameters and use the QgsAffine plugin, but that does require you to work out the parameters beforehand by fitting known source coordinates to known target coordinates.

But to do hundreds? You might be better off writing some custom SVG parsing code for each one...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-04-11T00:09:40.010

如果您只想在正确的位置显示它，缩放和旋转将其视为 SVG 图标。
1\. 创建一个点图层并将一个点放在您将加载的 SVG 的地理参考中心。
2\. 编辑符号系统并将 SVG 加载为图标
3\. 将大小单位设置为地图单位
4\. 提供适当的尺寸
5\. 根据需要旋转

重绘非常缓慢且痛苦，但如果您使用 Project>import/Export>Export map as image 您可以制作地理参考栅格。

# multithreading - 添加到子集合的多个线程导致 StaleObjectStateException

> ID：15691543
> 
> 赞同：0
> 
> 时间：2013-03-28T20:28:49.047
> 
> 标签：multithreading, spring, hibernate

我有一个情况，多个线程加载相同的实体`Job`，然后每个线程都添加到它的子集合中`Set<JobError>`。如果父项本身已更新，我可以理解此异常，但是对父项的唯一“更改”是添加到集合中，即使这样？

父实体：

```
@Entity
@Table(name = "JOB")
public class Job extends BaseEntity {

private Set<JobError> jobErrors = new HashSet<JobError>();

/**
 * @return the jobErrors
 */
@OneToMany(mappedBy = "job", cascade = { CascadeType.PERSIST,
        CascadeType.MERGE, CascadeType.REMOVE })
public Set<JobError> getJobErrors() {
    return jobErrors;
}

/**
 * @param jobErrors
 *            the jobErrors to set
 */
public void setJobErrors(Set<JobError> jobErrors) {
    this.jobErrors = jobErrors;
}

/**
 * Helper to take care of both sides of the association
 * @param message
 * @param currentProfileId
 */
public void addError(String message, Long currentProfileId,
        String firstName, String lastName) {
    JobError er = new JobError(message, currentProfileId, firstName,
            lastName, this);
    jobErrors.add(er);
}
} 
```

子实体：

```
@Entity
@Table(name = "JOB_ERROR")
public class JobError extends BaseEntity {
private Job job;

    public JobError(String description, Long profileId, String firstName,
        String lastName, Job job) {
    this.description = description;
    this.profileId = profileId;
    this.firstName = firstName;
    this.lastName = lastName;
    this.job = job;
}
/**
 * 
 */
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "JOB_ID", nullable = false)
public Job getJob() {
    return job;
}

/**
 * @param jobErrors
 *            the jobErrors to set
 */
public void setJob(Job job) {
    this.job = job;
}
} 
```

服务代码，这在多个并发线程中运行：

```
job = jobDao.findById(er.getJobId(), false);

for (Long profileId : er.getProfileIds()) {
// do stuff
try {
    sendEmail(emailTemplateDto, user);
} catch (RuntimeException re) {
    job.addError(re.getLocalizedMessage(), currentProfileId, profile.getPersonalData().getFirstName(), profile.getPersonalData().getLastName());
} 
```

一旦服务方法返回被注释为`@Transactional(propagation = Propagation.REQUIRED)`StaleObjectStateException 被抛出：

```
2013-03-28 13:22:52,578 ERROR     org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(324):  - Could not synchronize database state with session
org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [com.test.project.domain.Job#2]
at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1950)
at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2594)
at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2494)
at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2821)
at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:113)
at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:273)
at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:265)
at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:185)
at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:51)
at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1216)
at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:383)
at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:133)
at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:76)
at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:467)
at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754)
at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723)
at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:393)
at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:120)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
at $Proxy162.processSendEmail(Unknown Source)
at com.test.project.service.messaging.EmailRequestMessageListener.onMessage(EmailRequestMessageListener.java:57)
at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:560)
at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:498)
at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:467)
at org.springframework.jms.listener.AbstractMessageListenerContainer.executeListener(AbstractMessageListenerContainer.java:439)
at org.springframework.jms.listener.SimpleMessageListenerContainer.processMessage(SimpleMessageListenerContainer.java:311)
at org.springframework.jms.listener.SimpleMessageListenerContainer$2.onMessage(SimpleMessageListenerContainer.java:287)
at org.apache.activemq.ActiveMQMessageConsumer.dispatch(ActiveMQMessageConsumer.java:1321)
at org.apache.activemq.ActiveMQSessionExecutor.dispatch(ActiveMQSessionExecutor.java:131)
at org.apache.activemq.ActiveMQSessionExecutor.iterate(ActiveMQSessionExecutor.java:202)
at org.apache.activemq.thread.PooledTaskRunner.runTask(PooledTaskRunner.java:129)
at org.apache.activemq.thread.PooledTaskRunner$1.run(PooledTaskRunner.java:47)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662) 
```

除了尝试直接保存之外，我什么都想不到`JobError`。目前我首先加载`Job`，添加到集合`JobError`然后`merge`Job 并希望 cascade.merge 将负责保存子集合。

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:39:09.837

我不知道这是否是有问题的异常的原因，但如果不是，它会导致问题：HashSet 不是线程安全集合，这意味着如果两个线程同时调用 addError那么其中一个错误可能不会进入集合。您要么需要在 addError 方法中添加“synchronized”关键字，要么需要将 HashSet 替换为线程安全的替代方案，例如 ConcurrentLinkedQueue 或 ConcurrentHashMap

# visual-studio-2012 - 如何以编程方式在 Visual Studio 中获取测试资源管理器窗口的内容

> ID：15691551
> 
> 赞同：1
> 
> 时间：2013-03-28T20:29:19.337
> 
> 标签：visual-studio-2012, visual-studio-addins, vs-extensibility

我正在为 VS 2012 开发我的第一个加载项。我需要以编程方式查找用户从测试资源管理器窗口中选择的测试。

我怎么做？

非常感谢任何指示和帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T13:09:30.047

我没有正确回答您的问题，但这可能会对您有所帮助， [http://www.codeproject.com/Articles/173496/How-to-Create-a-Visual-Studio-Add-in-that-Launches](http://www.codeproject.com/Articles/173496/How-to-Create-a-Visual-Studio-Add-in-that-Launches)

# silverlight - VS 2012 中 SIlverlight 5 的替代单元测试框架

> ID：15691552
> 
> 赞同：1
> 
> 时间：2013-03-28T20:29:23.027
> 
> 标签：silverlight, unit-testing, visual-studio-2012

有谁知道与 VS 2012 和 Silverlight 5 兼容的单元测试框架？我尝试了 Silverlight Toolkit，但它没有注册新的项目类型。此外，该工具包的单元测试框架是“实验性的”并且有一些破坏交易的错误。

# python - gevent.Timeout 未引发

> ID：15691555
> 
> 赞同：1
> 
> 时间：2013-03-28T20:29:29.147
> 
> 标签：python, network-programming, timeout, gevent, monkeypatching

我有一个服务器在一个部分中执行“一些事情”，并且我有一个“with gevent.Timeout(5)”围绕它。我在另一个greenlet中进行了一些检查，通过它我注意到其中一个执行“某些事情”的greenlet运行了45分钟。我最终不得不重新启动程序才能杀死它（我知道其他杀死它的方法，但这不是问题..）。

我也使用 gevent.monkey.patch_all() 进行修补。“一些东西”部分确实涉及网络连接，我猜有些东西卡在其中一个地方。我不明白为什么没有引发超时异常。有谁知道为什么可能没有引发 gevent.Timeout 异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:34:01.120

每当我`gevent.Timeout`使用它时，我也将它用作上下文管理器，但带有第二个参数`False`。这样，上下文管理器会抑制任何异常并只留下代码块。您可以通过检查块是否成功设置值来跟进：

```
result = None
with gevent.Timeout(5, False):
    # Something that stalls

if result == None:
    # Take care of business 
```

这对我来说非常可靠。似乎默认的第二个参数`exception`是- 您是否尝试将其替换为您自己的异常类型`gevent.Timeout`？`None`甚至`Exception`？

# ruby-on-rails-3 - 在 ActiveRecord 中使用包含时优化内部连接

> ID：15691558
> 
> 赞同：1
> 
> 时间：2013-03-28T20:29:35.133
> 
> 标签：ruby-on-rails-3, activerecord

如何`includes`在保持即时加载的同时向活动记录中生成的 ON 子句添加条件？

假设我有这些课程：

```
class Car
   has_many :inspections
end

class Inspection
   belongs_to :car
end 
```

现在我可以这样做：

```
Car.includes(:inspections)

Select * from cars LEFT OUTER JOIN inspections ON cars.id = inspections.car_id 
```

但我想生成这个sql：

```
Select * from cars LEFT OUTER JOIN inspections ON cars.id = inspections.car_id 
    AND inspections.month = '2013-04-01' 
```

（这不起作用）：

```
Car.includes(:inspections).where("inspections.month = 2013-04-01")

Select * from cars LEFT OUTER JOIN inspections ON cars.id = inspections.car_id
    WHERE inspections.month = '2013-04-01' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T03:52:57.913

我不确切地知道这一点，但您可能不推荐您尝试做的事情，*即*违反了 Rails 的约定之一。根据[相关问题中的这个答案，](https://stackoverflow.com/questions/6246826/how-do-i-avoid-multiple-queries-with-include-in-rails)此类查询的默认行为是使用两个查询，例如：

```
SELECT "cars".* FROM "cars";
SELECT "inspections".* FROM "inspections" WHERE "inspections"."car_id" IN (1, 2, 3, 4, 5); 
```

出于性能原因做出此决定。这让我猜想查询的确切类型（JOIN 或多个查询）是您无法指望的实现细节。按照这种思路，ActiveRecord::Relation 可能不是为您的用例设计的，可能无法`ON`在查询中添加条件。

沿着这一系列的猜测，如果你真的相信你的用例是独一无二的，最好的办法可能是你制作自己的 SQL 查询，如下所示：

```
Car.joins(sanitize_sql_array(["LEFT OUTER JOIN inspections ON inspections.car_id = cars.id AND inspections.month = ?", "2013-04-01"]) 
```

（更新：这是[去年提出](https://stackoverflow.com/questions/13307685/activerecord-adding-condition-to-on-clause-for-includes?rq=1)的，但没有得到很好的答案。）

## 备选方案 1

正如卡洛斯·德鲁建议的那样，

```
@cars   = Cars.all
car_ids = @cars.map(&:id) 
@inspections = Inspection.where(inspections: {month: '2013-04-01', car_id: car_ids})
# with scopes: Inspection.for_month('2013-04-01').where(car_id: car_ids) 
```

但是，为了防止`car.inspections`触发不必要的 SQL 调用，还需要做

```
# app/models/car.rb
has_many :inspections, inverse_of: :car

# app/models/inspection.rb
belongs_to :car, inverse_of: :inspections 
```

## 备选方案 2

也许您可以找到一种方法来缓存当月的检查，然后不用担心急切加载。这可能是最好的解决方案，因为缓存可以在不同的地方重复使用。

```
@cars = Cars.all
@cars.each do |car|
  car.inspections.where(month: '2013-04-01')
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:41:15.550

这应该有效：

```
Car.includes(:inspections).where( inspections: { month: '2013-04-01' }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-15T20:51:13.180

我已经更广泛地重新考虑了你的问题。我认为您正面临代码设计问题以及（而不是？）ActiveRecord 查询问题。

您要求返回`.inspections`已重新定义为表示与特定日期匹配的检查的汽车关系。ActiveRecord 不允许您根据查询动态重新定义模型关联。

如果您不要求检查日期的动态条件，我会告诉您使用 a`has_many :through`和 a `:condition`。

```
has_many :passed_inspections, :through => :inspections, :conditions => {:passed => true}

@cars = Cars.includes(:passed_inspections) 
```

显然，如果您需要即时提供检查日期，那将是行不通的。

所以，最后，我会告诉你做这样的事情：

```
@cars = Cars.all
@inspections = Inspection.where(inspections: {month: '2013-04-01', car_id: @cars.pluck(:id)}) 
```

（确切的，最好的实现`car_id`条件是有待商榷的。然后你需要对`@inspections`by进行分组`car_id`以在给定的时刻获得正确的子集。）

或者，在生产环境中，您可能能够依赖一些相当好的/聪明的 ActiveRecord 缓存。我不确定这一点。

```
def inspections_dated(month)
  inspections.where(month: month)
end
Car.includes(:inspections).each{|car| car.inspections_dated(month).each.etc. } 
```

**交替地，交替地**

您可以通过手动 SQL 欺骗 ActiveRecord 为您提供具有不清楚接口的扩展 Car 对象：

```
@cars_with_insp = Car.join("LEFT OUTER JOIN inspections ON inspections.car_id = cars.id AND inspections.month = '2013-04-01'").select("cars.*, inspections.*")
@cars_with_insp.each{|c| puts c.name; puts c.inspection_month} 
```

您将看到，`.each`您可以直接在 上使用检查的属性`car`，因为您已经说服 ActiveRecord 通过连接将一个类的两条记录作为单行返回。Rails 会告诉你它的类是 Car，但它不仅仅是 Car。对于没有匹配的检查，您将获得每辆汽车一次，或者每次匹配的检查获得多次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-19T03:49:46.383

Rails 的作者没有将这个功能构建到 ActiveRecord 中，大概是因为使用 WHERE 返回相同的结果集，他们觉得没有必要有替代方案。

在文档和代码中，我们找到了向包含模型添加条件的两种“官方”方法。

在实际源代码中：[https](https://github.com/rails/rails/blob/5245648812733d2c31f251de3e05e78e68bfa3a5/activerecord/lib/active_record/relation/query_methods.rb) ://github.com/rails/rails/blob/5245648812733d2c31f251de3e05e78e68bfa3a5/activerecord/lib/active_record/relation/query_methods.rb我们发现他们使用 WHERE 来完成此操作：

我引用：“

# === 条件

```
#
# If you want to add conditions to your included models you'll have
# to explicitly reference them. For example:
#
# User.includes(:posts).where('posts.name = ?', 'example')
#
# Will throw an error, but this will work:
#
# User.includes(:posts).where('posts.name = ?', 'example').references(:posts) 
```

_END_QUOTE_

文档提到了另一种方法：[http](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html) ://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html在标题“Eager loading of associations”下

引用：

如果您确实希望只加载关联的某些成员，通常更自然地包含一个定义了条件的关联：

class Post < ActiveRecord::Base has_many :approved_comments, -> { where approved: true }, class_name: 'Comment' end

Post.includes(:approved_comments)

这将加载帖子并急切加载approved_comments 关联，该关联仅包含那些已被批准的评论。

结束报价

您可以在技术上使用这种方法，但在您的情况下，如果您使用动态月份值，它可能不是那么有用。

这些是唯一的选项，它们在任何情况下都返回与基于 AND 的查询相同的结果。

# vba - Excel 到动态 Word 表格

> ID：15691559
> 
> 赞同：0
> 
> 时间：2013-03-28T20:29:37.770
> 
> 标签：vba, excel, ms-word

我是 VBA 新手，尝试为此解决方案编写一些代码非常困难。任何帮助将不胜感激！

在 MS Word 中，我需要在工作表中查看一个 Excel 工作簿，然后将符合我的条件的数据复制/粘贴到一个两列表中：

从工作表的第 6 行开始，在 D6:M6 范围内查找。如果 D6:M6 为空白，则转到下一行。如果 D6:M6 中的任何单元格有数据，请从 C6 复制数据并将其粘贴到表格的第一行（最好跨两列合并）。然后，从包含数据的列的第 1 行复制数据并将其粘贴到表的下一行（第 1 列）。然后，从包含数据的单元格中复制数据并将其粘贴到第二列。

基本上，如果有数据，表的第一行将来自有数据的行的C列，下一行的第一列将来自有数据的列的第1行，第二行的第2列将来自同一列中包含数据的单元格。

感谢您提供帮助。这是一个示例 Excel 文件的超链接，以及我开始在 MS Word 中编写的仅涵盖第一个产品的非常业余的代码：

[Excel 示例文件](http://wikisend.com/download/489350/Sample.xlsx)

```
 Private Sub useVBinWord()

Dim workBook As workBook
Dim dataInExcel As String

Application.ScreenUpdating = False

Selection.TypeText Text:="Comments:"
Selection.TypeParagraph
Selection.TypeText Text:="Printed:  " & Now
Selection.TypeParagraph

Set workBook = Workbooks.Open("C:\Users....xls", True, True)

ActiveDocument.Tables.Add Range:=Selection.Range, NumRows:=100, NumColumns:=2, DefaultTableBehavior:=wdWord9TableBehavior, AutoFitBehavior:=wdAutoFitFixed
With Selection.Tables(1)
If .Style <> "Table Grid" Then
.Style = "Table Grid"
End If
.ApplyStyleHeadingRows = True
.ApplyStyleLastRow = False
.ApplyStyleFirstColumn = True
.ApplyStyleLastColumn = False
.ApplyStyleRowBands = True
.ApplyStyleColumnBands = False
End With

dataInExcel = workBook.Worksheets("Top30 Comments").Range("C6").Formula
ActiveDocument.Tables(1).Cell(1, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("D1").Formula
ActiveDocument.Tables(1).Cell(2, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("D6").Formula
ActiveDocument.Tables(1).Cell(2, 2).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("E1").Formula
ActiveDocument.Tables(1).Cell(3, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("E6").Formula
ActiveDocument.Tables(1).Cell(3, 2).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("F1").Formula
ActiveDocument.Tables(1).Cell(4, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("F6").Formula
ActiveDocument.Tables(1).Cell(4, 2).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("G1").Formula
ActiveDocument.Tables(1).Cell(5, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("G6").Formula
ActiveDocument.Tables(1).Cell(5, 2).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("H1").Formula
ActiveDocument.Tables(1).Cell(6, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("H6").Formula
ActiveDocument.Tables(1).Cell(6, 2).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("I1").Formula
ActiveDocument.Tables(1).Cell(7, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("I6").Formula
ActiveDocument.Tables(1).Cell(7, 2).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("J1").Formula
ActiveDocument.Tables(1).Cell(8, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("J6").Formula
ActiveDocument.Tables(1).Cell(8, 2).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("K1").Formula
ActiveDocument.Tables(1).Cell(9, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("K6").Formula
ActiveDocument.Tables(1).Cell(9, 2).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("L1").Formula
ActiveDocument.Tables(1).Cell(10, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("L6").Formula
ActiveDocument.Tables(1).Cell(10, 2).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("M1").Formula
ActiveDocument.Tables(1).Cell(11, 1).Select
Selection.TypeText Text:=dataInExcel

dataInExcel = workBook.Worksheets("Top30 Comments").Range("M6").Formula
ActiveDocument.Tables(1).Cell(11, 2).Select
Selection.TypeText Text:=dataInExcel

workBook.Close True
Set workBook = Nothing
Application.ScreenUpdating = True

End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T18:47:53.447

你选择了一个困难的项目开始！这是我几乎完整的解决方案：

```
Sub ImportTable()

    Dim AppExcel As Excel.Application    '  link to Excel
    Dim ExcelRange As Excel.Range        '  range in worksheet to process
    Dim ExcelData As Variant             '  worksheet data as VBA array
    Dim ExcelHeadings As Variant         '  worksheet headings as VBA array
    Dim FoundCol As Boolean              '  a column found with data ***
    Dim exCol As Integer                 '  Excel column (iterator)
    Dim exRow As Integer                 '  Excel row (iterator)
    Dim wdRow As Integer                 '  Word table row
                                         '  reference to open instance of Excel
    Set AppExcel = GetObject(class:="Excel.Application")
' change this to create an instance and open the file

    Set ExcelRange = AppExcel.ActiveSheet.UsedRange ' the spreadsheet data as a range
'  change this to ensure we have the correct worksheet

' the following reads cells C6 to End into a VBA array (row,column)
    ExcelData = ExcelRange.Offset(5, 2).Resize(ExcelRange.Rows.Count - 6, _
        ExcelRange.Columns.Count - 2)
' the following reads the heading row starting at C1
    ExcelHeadings = ExcelRange.Offset(0, 2).Rows(1)

' assumes we have a blank document in word

    With ActiveDocument.Range

      .InsertAfter "Comments:" & vbCrLf  '  insert your document header
      .InsertAfter "Printed: " & Now & vbCrLf & vbCrLf

    End With

    Selection.EndOf wdStory              '  reposition selection at end

    ActiveDocument.Tables.Add Selection.Range, 1, 2 ' create a 1 x 2 table

    With ActiveDocument.Tables(1)        '  use this table

        .Style = "Table Grid"            '  set the style (copied from your code)
        .ApplyStyleHeadingRows = True
        .ApplyStyleLastRow = False
        .ApplyStyleFirstColumn = True
        .ApplyStyleLastColumn = False
        .ApplyStyleRowBands = True
        .ApplyStyleColumnBands = False

' the first row is left blank for you to insert a title
' perhaps you should make this row repeat on each page

        wdRow = 2                        '  we will fill from row 2 which doesn't exist yet
        For exRow = 1 To UBound(ExcelData, 1) Step 3 ' process every 3rd row

            FoundCol = False             '  mark 'not found' ***

            For exCol = 2 To UBound(ExcelData, 2) '  test each column from D

                If Trim(ExcelData(exRow, exCol)) <> "" Then '  if cell not empty

                    If Not FoundCol Then '  first filled column, write header

                        .Rows.Add        '  add row for header
                        .Rows.Add        '  add row for data (avoid problem with merged row)

                        .Rows(wdRow).Cells.Merge '  merge header row

                        .Rows(wdRow).Range.InsertAfter ExcelData(exRow, 1) ' add title from C
                                         '  this keeps the two rows together across page breaks
                        .Rows(wdRow).Range.ParagraphFormat.KeepWithNext = True

                        wdRow = wdRow + 1 ' row added

                        FoundCol = True  '  header written

                    Else

                        .Rows.Add        '  add row for data
                                         '  this keeps the two rows together across page breaks
                        .Rows(wdRow - 1).Range.ParagraphFormat.KeepWithNext = True

                    End If
                                         '  write heading from row 1
                    .Cell(wdRow, 1).Range.InsertAfter ExcelHeadings(1, exCol)
                                         '  write found data
                    .Cell(wdRow, 2).Range.InsertAfter ExcelData(exRow, exCol)

                    wdRow = wdRow + 1    '  row added

                End If

            Next exCol

        Next exRow

    End With

' don't forget to close the instance of Excel

End Sub 
```

阅读评论，我给你留下了一些工作要做！

# php - 使用 htaccess 进行重定向

> ID：15691560
> 
> 赞同：1
> 
> 时间：2013-03-28T20:29:41.897
> 
> 标签：php, .htaccess, redirect

我正在使用以下代码将我的所有页面从 .php 更改为简单的 /

```
RewriteRule ^(.*)/$ $1.php [L] 
```

现在出现 www.site.com/clubs/ 或 www.site.com/training/ 而不是 www.site.com/clubs.php 和 www.site.com/training.php

现在在俱乐部中，我想显示俱乐部（使用数据库中的数据），页面将显示为 www.site.com/clubs/my-club/
所有 my-club 数据都将在数据库中，包括 a 中的链接网址字段。

我可以用下面的代码得到这个。但是，当我使用 $_GET['club'] 方法回显时，它会显示 my-club.php 而不仅仅是 my-club。

```
RewriteRule ^clubs/([^/]*)$ clubs.php?url=$1 [L] 
```

url 中的结尾 / 似乎变成了 .php

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:41:15.803

您可以通过不同的方式实现您的需求，但这就是我的做法。更改规则顺序，如下所示：

```
RewriteRule ^clubs/([^/]*)/$ clubs.php?url=$1 [L]
RewriteRule ^(.*)/$ $1.php [L] 
```

我在第一条规则中添加了斜杠，因为我猜它是模式的一部分。如果我错了，您可以将其删除。

如果您想从原始请求 URL 中附加任何查询字符串，您应该`QSA`与 一起使用`L`，所以`[L,QSA]`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:48:40.137

试试这个：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([0-9a-zA-Z\-]+?)/([0-9a-zA-Z\-]+?)?$ $1.php?url=$2 
```

你在跑什么：

```
http://localhost/club/ 
```

结果将是

```
http://localhost/club.php 
```

你在跑什么：

```
http://localhost/club/my-club 
```

结果将是

```
http://localhost/club.php?url=my-club 
```

# ruby-on-rails - 没有数据库清理或空数据库

> ID：15691562
> 
> 赞同：0
> 
> 时间：2013-03-28T20:29:43.790
> 
> 标签：ruby-on-rails, rspec, capybara, spork, database-cleaner

我无法让我的测试套件工作。我尝试混合和匹配不同的配置。但是这个视图的结果都是一样的：要么在测试之间没有清理任何东西，要么数据库是空的。

我收到这种错误：

当什么都没有清理

```
1) Authentication Sign in page as new user with valid information creates a user
     Failure/Error: select group.name, from: 'user_group_id'
     Capybara::Ambiguous:
       Ambiguous match, found 2 elements matching option "Group g" 
```

或者这个，一个空的数据库：

```
 1) Authentication Sign in page as new user with valid information creates a user
     Failure/Error: select group.name, from: 'user_group_id'
     Capybara::ElementNotFound:
       Unable to find option "Group g" 
```

我尝试过使用和不使用 database_cleaner。我尝试过不使用 Spork。我尝试了不同来源的不同配置，例如：

[http://devblog.avdi.org/2012/08/31/configuring-database_cleaner-with-rails-rspec-capybara-and-selenium/](http://devblog.avdi.org/2012/08/31/configuring-database_cleaner-with-rails-rspec-capybara-and-selenium/)

[https://github.com/bmabey/database_cleaner#rspec-example](https://github.com/bmabey/database_cleaner#rspec-example)

但我不知道如何使它工作。

这是 Gemfile，带有 gems 版本：

```
gem 'rails', '3.2.13'
gem 'sqlite3'

group :development, :test do
  gem 'libnotify'
  gem 'rb-inotify'
  gem 'rspec-rails'       (2.13.0)
  gem 'guard-rspec'       (2.5.1)
  gem 'guard-spork'       (1.5.0)
  gem 'guard-livereload'   
  gem 'rack-livereload'    
end

group :test do
  gem 'capybara'          (2.0.2)
  gem 'launchy'             
  gem 'database_cleaner'  (0.9.1)
  gem 'factory_girl_rails'
end 
```

这是视图：

```
<%= form_for(@user, url: sessions_path ) do |f| %>

  <div class="field">
    <%= f.label :group_id %><br />
    <%= f.collection_select :group_id, Group.order('name asc').all, :id, :name, :prompt => "Choose your Group" %>
  </div>
  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label :phone %><br />
    <%= f.text_field :phone %>
  </div>
  <div class="actions">
    <%= f.submit 'Go !'%>
  </div>
<% end %> 
```

两种型号：

```
class Group < ActiveRecord::Base
  has_many :users
  attr_accessible :name, :phone, :active
end

class User < ActiveRecord::Base
  belongs_to :group
  attr_accessible :name, :phone, :group_id

  validates_presence_of :name, :phone, :group
end 
```

以及相应的规范

```
require 'spec_helper'

describe "Authentication" do

  subject { page }
  before { visit root_path }

  describe "Sign in page" do
    let(:submit) {'Go !'}
    let(:session_new_content) { "Who's nearby"}
    let(:session_show_content){ "session show"}

    describe "as new user" do      
      describe "with valid information" do
        group = Group.create(name: "Group g")

        before do
          select group.name, from: 'user_group_id'
          fill_in 'Name', with: 'Samy'
          fill_in 'Phone', with: '0642604568'
        end

        it "creates a user" do
          expect{ click_button submit }.to change(User, :count).by(1)
        end

        describe "after saving the user" do 
          let(:user) { User.find_by_phone '0643614864'}  
          before do
            click_button submit
          end
          it { should have_content session_show_content}
          it { should have_content user.name}
        end
      end
    end
  end
end 
```

这是我的 spec_helper.rb

```
require 'rubygems'
require 'spork'

Spork.prefork do

  ENV["RAILS_ENV"] ||= 'test'
  require File.expand_path("../../config/environment", __FILE__)
  require 'rspec/rails'
  require 'rspec/autorun'

  Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f}

  RSpec.configure do |config|

    config.use_transactional_fixtures = false

    config.infer_base_class_for_anonymous_controllers = false

    config.order = "random"
    config.include Rails.application.routes.url_helpers

    config.include Capybara::DSL

    config.before(:suite) do
      DatabaseCleaner.strategy = :transaction
      DatabaseCleaner.clean_with(:truncation)
    end

    config.before(:each) do
      DatabaseCleaner.start
    end

    config.after(:each) do
      DatabaseCleaner.clean
    end
  end

end

Spork.each_run do
  FactoryGirl.reload
end 
```

这有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:14:15.557

问题似乎在这里：

```
describe "as new user" do      
  describe "with valid information" do
    group = Group.create(name: "Group g")

    before do 
```

您正在前块之外创建一个组，因此它是在文件加载时创建的（在事务之外）。

为了让一切都变得快乐，您需要将`group = Group.create(name: "Group g")`调用移动到`before`块内或`it`块内。

编辑：或使用 let 助手，例如 `let(:group) { Group.create(name: "Group g") }`

# javascript - Greasemonkey 脚本不工作但没有显示错误？

> ID：15691564
> 
> 赞同：1
> 
> 时间：2013-03-28T20:29:57.943
> 
> 标签：javascript, jquery, greasemonkey

在网站[pib.nic.in/newsite/erelease.aspx](http://pib.nic.in/newsite/erelease.aspx?relid=0)中，左侧链接在同一页面中打开 - 不方便阅读和切换到下一个主题。

调用的函数`Getrelease`传递与单击的项目相对应的唯一 ID，以获取并显示在右侧列中。

相关页面，HTML 片段是：

```
<div class="leftrightdiv" id="lreleaseID">
    <ul class="link1">
        <li style="list-style:none;border-bottom: blue 1px dotted;color:blue;font-size:110%" class="rel">Prime Minister's Office</li>
        <!-- <li class="rel" style="border-bottom: teal 1px dotted;cursor:pointer" **onclick='Getrelease(94318)'** >PM's statement at the BRICS Leaders - Africa Dialogue Forum<span style='font-weight:lighter;color: ThreeDDarkShadow;'> ()</span></li>  -->
        <li onclick="Getrelease(94318)" style="border-bottom: teal 1px dotted;cursor:pointer" class="rel">PM's statement at the BRICS Leaders - Africa Dialogue Forum</li>
        <li style="list-style:none;border-bottom: blue 1px dotted;color:blue;font-size:110%" class="rel">Ministry of Finance</li>
        <!-- <li class="rel" style="border-bottom: teal 1px dotted;cursor:pointer" onclick='Getrelease(94339)' >Central Board of Excise and Customs (CBEC) Offices to Remain open on 29th, 30th & 31stmarch, 2013 ;<span style='font-weight:lighter;color: ThreeDDarkShadow;'> ()</span></li>  -->
        <li onclick="Getrelease(94339)" style="border-bottom: teal 1px dotted;cursor:pointer" class="rel">Central Board of Excise and Customs (CBEC) Offices to Remain open on 29th, 30th &amp; 31stmarch, 2013 ;</li>
        <!-- <li class="rel" style="border-bottom: teal 1px dotted;cursor:pointer" onclick='Getrelease(94338)' >India and Liechtenstein Sign Tax Information Exchange Agreement (TIEA)<span style='font-weight:lighter;color: ThreeDDarkShadow;'> ()</span></li>  -->
        <li onclick="Getrelease(94338)" style="border-bottom: teal 1px dotted;cursor:pointer" class="rel">India and Liechtenstein Sign Tax Information Exchange Agreement (TIEA)</li>
        <!-- <li class="rel" style="border-bottom: teal 1px dotted;cursor:pointer" onclick='Getrelease(94337)' >Government Committed to bring down the Current Account<span style='font-weight:lighter;color: ThreeDDarkShadow;'> ()</span></li>  -->
        <li onclick="Getrelease(94337)" style="border-bottom: teal 1px dotted;cursor:pointer" class="rel">Government Committed to bring down the Current Account</li>
    </ul>
    <br>
</div> 
```

我想将以上内容更改为以下代码，以便在单击该项目时，它将在新页面中打开。

```
<div class="leftrightdiv" id="lreleaseID">
    <ul class="link1">
        <li style="list-style:none;border-bottom: blue 1px dotted;color:blue;font-size:110%" class="rel">Prime Minister's Office</li>
        <!-- <li class="rel" style="border-bottom: teal 1px dotted;cursor:pointer" onclick='Getrelease(94318)' >PM's statement at the BRICS Leaders - Africa Dialogue Forum<span style='font-weight:lighter;color: ThreeDDarkShadow;'> ()</span></li>  -->
        <li onclick="window.open('http://www.pib.nic.in/newsite/erelease.aspx?relid=94318')" style="border-bottom: teal 1px dotted;cursor:pointer" class="rel">PM's statement at the BRICS Leaders - Africa Dialogue Forum</li>
        <li style="list-style:none;border-bottom: blue 1px dotted;color:blue;font-size:110%" class="rel">Ministry of Finance</li>
        <!-- <li class="rel" style="border-bottom: teal 1px dotted;cursor:pointer" onclick='Getrelease(94339)' >Central Board of Excise and Customs (CBEC) Offices to Remain open on 29th, 30th & 31stmarch, 2013 ;<span style='font-weight:lighter;color: ThreeDDarkShadow;'> ()</span></li>  -->
        <li onclick="window.open('http://www.pib.nic.in/newsite/erelease.aspx?relid=94339')" style="border-bottom: teal 1px dotted;cursor:pointer" class="rel">Central Board of Excise and Customs (CBEC) Offices to Remain open on 29th, 30th &amp; 31stmarch, 2013 ;</li>
        <!-- <li class="rel" style="border-bottom: teal 1px dotted;cursor:pointer" onclick='Getrelease(94338)' >India and Liechtenstein Sign Tax Information Exchange Agreement (TIEA)<span style='font-weight:lighter;color: ThreeDDarkShadow;'> ()</span></li>  -->
        <li onclick="window.open('http://www.pib.nic.in/newsite/erelease.aspx?relid=94338')" style="border-bottom: teal 1px dotted;cursor:pointer" class="rel">India and Liechtenstein Sign Tax Information Exchange Agreement (TIEA)</li>
        <!-- <li class="rel" style="border-bottom: teal 1px dotted;cursor:pointer" onclick='Getrelease(94337)' >Government Committed to bring down the Current Account<span style='font-weight:lighter;color: ThreeDDarkShadow;'> ()</span></li>  -->
        <li onclick="window.open('http://www.pib.nic.in/newsite/erelease.aspx?relid=94337')" style="border-bottom: teal 1px dotted;cursor:pointer" class="rel">Government Committed to bring down the Current Account</li>
    </ul>
    <br>
</div> 
```

所以写了这个 Greasemonkey 脚本：

```
// ==UserScript==
// @name            Press Information Bureau
// @namespace       http://userscripts.org/scripts/show/163329
// @description     PIB new tab open
// @include         http://pib.nic.in*
// @require         http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js
// @version         2.4
// ==/UserScript==

function replaceOnclick() {

    var list = document.getElementById('lreleaseID');
    var lists = list.getelementsbytagname('li');

    for (i = 0; i < lists.length; i++) {
        var Str = lists[i].getAttribute("onclick");
        var seconds = Str.indexOf(')');
        var url = "http://www.pib.nic.in/newsite/erelease.aspx?relid=" + Str.substring(11, second);

        lists[i].setAttribute("onclick", "window.open('" + url + "')");
    }
} 
```

Greasemonkey 脚本正在被注入。但它没有在输出中做出预期的变化。
javascript使用中的错误是什么？请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:03:24.330

该脚本有多个错误：

1.  它定义`replaceOnclick()`但从不调用它。 **这就是您在错误控制台**( `Ctrl` `Shift` `J`) 中看不到任何操作和错误的原因。

2.  无效的函数名 ,`getelementsbytagname`将引发错误（异常）。JavaScript 区分大小写，正确的函数是`getElementsByTagName()`.

3.  `Str`有时为空，因此`var seconds=Str.indexOf(')');`会引发异常并使脚本崩溃。防止这种情况的一种方法是将其使用包装在`if (Str) {...}`语句中。

4.  同样，`seconds`有时为空。

5.  这一行：

    ```
    var url="http://www.pib.nic.in/newsite/erelease.aspx?relid="+Str.substring(11, second); 
    ```

    使用错误的名称。`second`应该是`seconds`。

* * *

还有一些不完全是错误的项目，但你应该做不同的事情......

1.  该站点默认为 URL 的 like `http://www.pib.nic.in/newsite/...`。因此，您可能需要添加一个包含行来说明这一点：

    ```
    // @include         http://www.pib.nic.in* 
    ```

2.  该脚本引用了 jQuery，但没有使用它！使用 jQuery，它将为您节省时间和痛苦。

3.  该脚本没有[指定`@grant`指令](http://wiki.greasespot.net/@grant)。这可能会导致意外行为和冲突。始终指定至少一行，如果可以避免就`@grant`不要使用它。`@grant none`

4.  jQuery 1.3.2 已经过时了。如果您打算使用 jQuery，请使用更新的版本，除非有*令人信服*的理由不这样做。

* * *

使用上面的项目来修复该脚本。或者这是使用 jQuery 的样子：

```
// ==UserScript==
// @name            Press Information Bureau
// @namespace       http://userscripts.org/scripts/show/163329
// @description     PIB new tab open
// @include         http://pib.nic.in*
// @include         http://www.pib.nic.in*
// @require         http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js
// @grant           GM_addStyle
// @version         2.4
// ==/UserScript==
/*- The @grant directive is needed to work around a design change
    introduced in GM 1.0\.   It restores the sandbox.
*/

//-- Use jQuery selector to get just the <li>s that have an onclick.
var articleLinks    = $("#lreleaseID li[onclick]");

//-- jQuery .each()
articleLinks.each ( function () {
    var jThis           = $(this);  // "this" is a special var inside .each()
    var onClickVal      = jThis.attr ("onclick");
    var articleMatch    = onClickVal.match (/Getrelease\s*\((\d+)\)/i);

    if (articleMatch  &&  articleMatch.length == 2) {
        var articleId   = articleMatch[1];
        var articleUrl  = "http://www.pib.nic.in/newsite/erelease.aspx?relid="
                        + articleId
                        ;

        jThis.attr ("onclick", "window.open('" + articleUrl + "')");
    }
} ); 
```

# clojure - clojure 内置 java 方法

> ID：15691565
> 
> 赞同：1
> 
> 时间：2013-03-28T20:30:06.200
> 
> 标签：clojure

有关于 clojure 内置 java 方法的文档吗？例如，来自 java.lang.String 的 .toUpperCase 和来自 clojure.lang.PersistantVector 的 .indexOf。

无论如何我可以在不查看源代码的情况下找到有用的java方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T01:38:17.463

正如其他人指出的那样，您可以很容易地在线获取文档`java.*`和`javax.*`文档，因为它是核心 Java 的一部分。

对于`clojure.*`，您最好的参考是来源。即便如此，我还是建议*不要依赖它，*因为这段代码真的应该被视为 Clojure 的实现细节。您**无法保证**该功能在 Clojure 的未来版本中不会发生变化并破坏任何依赖它的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T20:37:16.633

Java [API](http://docs.oracle.com/javase/7/docs/api/)怎么样？那里列出了所有 Java 的类和方法。这涵盖了所有的“clojure 内置 java 方法”。

另一方面，Clojure 的类记录在[此处](http://clojure.github.com/clojure/index.html)，Clojure 的 API。你必须学会​​区分 Clojure 的类和 Java 的类。所有以 Java 开头`java.*`或`javax.*`属于 Java 的包都记录在第一个链接中。以 开头的包`clojure.*`来自 Clojure，您可以在第二个链接中找到它们的文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T20:37:30.963

如果该类的包以`java`or开头，那么您可以[在 Oracle 网站上的 Java 文档](http://docs.oracle.com/javase/7/docs/api/)`javax`中查找它。

对于 Clojure 实现类（包名以 开头`clojure`），您可能会一直在查看源代码。有针对预期 API（Clojure 语言）的文档，但没有针对实现它的 Java 类的文档。根据您要查找的内容是否是博主感兴趣的内容，您可能会找到一些文章（[例如这篇文章）。](http://blog.higher-order.net/2009/02/01/understanding-clojures-persistentvector-implementation/)

# javascript - Chrome 中 scrollTo() 的 JavaScript 问题

> ID：15691569
> 
> 赞同：12
> 
> 时间：2013-03-28T20:30:24.960
> 
> 标签：javascript, google-chrome, scrollto

我尝试创建一个网页，顶部有一个固定的导航栏，覆盖了下面的内容。在 url 中加载带有锚点的页面时，正常行为是页面将锚点滚动到窗口顶部。但随后该内容隐藏在导航栏下。所以我尝试用 JavaScript scrollTo() 来解决这个问题。我的解决方案适用于 Firefox 和 Opera，但不适用于 Chrome。请尝试示例。任何想法如何在 Chrome 中解决此问题？谢谢你。

测试.htm:

```
<!DOCTYPE HTML>
<html>
  <head>
    <title>Test</title>
    <meta charset='UTF-8'>
    <style type='text/css'>
      #navi { position:fixed; left:0; top:0; width:100%; height:100px; background-color:yellow; }
      #spacer { background-color:cyan; height:100px; }
      #spacer2 { height:1000px; }
      .style1 { background-color:green; height:200px; }
    </style>
    <script type='text/javascript'>
      /* <![CDATA[ */
      function scrollAnchor() {  // doesn't work in Chrome
        var y = document.getElementById(window.location.hash.substr(1)).offsetTop - 110;
        window.scrollTo(0, y);
        //alert(y);
      }
      /* ]]> */
    </script>
  </head>
  <body id='top' onload='scrollAnchor();'>
    <div id='navi'>
      <a href='./test2.htm'>Menu</a>
    </div>
    <div id='main'>
      <div id='spacer'></div>
      <h3 id='1'>Heading 1</h3><p class='style1'></p>
      <h3 id='2'>Heading 2</h3><p class='style1'></p>
      <h3 id='3'>Heading 3</h3><p class='style1'></p>
      <h3 id='4'>Heading 4</h3><p class='style1'></p>
      <h3 id='5'>Heading 5</h3><p class='style1'></p>
      <h3 id='6'>Heading 6</h3><p class='style1'></p>
      <div id='spacer2'></div>
    </div>
  </body>
</html> 
```

测试2.htm：

```
<!DOCTYPE HTML>
<html>
  <head>
    <title>Test</title>
    <meta charset='UTF-8'>
  </head>
  <body>
    <a href='test.htm#1'>Heading 1</a>
    <a href='test.htm#2'>Heading 2</a>
    <a href='test.htm#3'>Heading 3</a>
    <a href='test.htm#4'>Heading 4</a>
    <a href='test.htm#5'>Heading 5</a>
    <a href='test.htm#6'>Heading 6</a>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-29T00:02:30.490

Chrome 是如此之快，以至于您的 scrollTo() 操作在Chrome 的默认滚动到 html 锚事件**之前触发。**

通过使用给它一个微小的延迟

```
setTimeout(function() {window.scrollTo(0, y);},1) 
```

* * *

或者干脆避免使用**实际的元素 id**作为哈希名称

而不是使用

> 测试.htm#6

采用

> test.htm#link_6

然后你可以通过做类似的事情来获得真实的身份

```
window.location.hash.split('_')[1] 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-03-27T19:33:17.860

我建议避免使用 JavaScript，而是创建一个专用的锚元素，然后将其在标题上方偏移至少您的标题高度。

这已经在[https://stackoverflow.com/a/13184714/5951116](https://stackoverflow.com/a/13184714/5951116)中有很好的描述。

您的代码将如下所示：

```
<div id='navi'>
  <a href='./test2.htm'>Menu</a>
</div>
<div id='main'>
  <div id='spacer'></div>
  <div class='article-wrapper'>
    <a class='anchor' id='1'></a>
    <h3>Heading 1</h3><p class='style1'></p>
  </div>
  <div class='article-wrapper'>
    <a class='anchor' id='2'></a>
    <h3>Heading 2</h3><p class='style1'></p>
  </div>
  ...
</div> 
```

```
#navi {
  height: 50px;
}

#main a.anchor {
    display: block;
    position: relative;
    top: -50px;
    visibility: hidden;
} 
```

或者使用 CSS 变量来消除尽可能多的紧密耦合：

```
:root {
  --header-height: 50px;
}

#navi {
  height: var(--header-height);
}

#main a.anchor {
    display: block;
    position: relative;
    top: -var(--header-height);
    visibility: hidden;
} 
```

# python - 比较两个 csv 文件中的值，将值附加到文本文件

> ID：15691572
> 
> 赞同：0
> 
> 时间：2013-03-28T20:30:28.577
> 
> 标签：python, csv, python-2.7

我有三个文件。我想比较其中有水果的列和匹配的列，我想将匹配的水果附加到 Append.txt 文件中，然后升序排序。

测试1.csv

```
CustID,Name,Count,Item,Date  
23,Smith,8,apples,08/12/2010  
1,Jones,8,banana,03/26/2009  
15,Miller,2,cookie dough,03/27/2009  
6,Fisher,8,oranges,06/09/2011 
```

测试2.csv

```
FRUIT,Amount,Aisle  
oranges,1,1  
apples,1,1  
pears,1,1 
```

追加.txt

```
Fruit,Total,Aisle
cherries,1,1  
dates,2,1  
grapes,5,1  
kiwis,2,2  
peaches,2,2  
plums,1,1  
watermelon1,2 
```

代码：

```
import csv

# Iterate through both  reader1 and reader2, compare common row, and append matching column data to test.txt in its matching column
with open("C:\\Test\\Append.txt", 'a') as f:
    reader1 = csv.reader(open("C:\\Test\\test1.csv", 'rb'), delimiter=',')
    row1 = reader1.next()
    reader2 = csv.reader(open("C:\\Test\\test2.csv", 'rb'), delimiter=',')
    row2 = reader2.next()
    if (row1[3] == row2[0]):
        print "code to append data from row1[0] to test.txt row[0] goes here"

f.close()
exit

print "code to sort test.txt ascending on column[0] goes here" 
```

我的初始脚本不起作用。检查后我可以看到代码仅将第 1 行与第 1 行、第 2 行与第 2 行等进行比较，我真的希望它比较所有行（第 1 行与第 1 行、第 1 行与第 2 行、第 2 行与第 1 行、第2 与第 2 行等>）。运行主脚本后，可以填充没有记录或最多 5 条记录的测试文件。附加文件可以是空的，也可以有数百条记录。使用python 2.7。

我也不确定如何在完成后按升序对文件进行排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:42:39.113

使用[集合](http://docs.python.org/2/library/stdtypes.html#set-types-set-frozenset)。首先读取两个 CSV 文件，然后只收集行中的结果。

然后使用集合交集找到两个文件共有的所有水果，将它们添加到`Append.txt`文件中的水果，排序，然后将所有水果写回文件。

```
import csv

# collect the fruits of both CSV files
with open('c:/Test/test1.csv', 'rb') as test1:
    reader = csv.reader(test1)
    next(reader, None)  # ignore header
    test1_fruit = set(row[3] for row in reader)
with open('c:/Test/test2.csv', 'rb') as test2:
    reader = csv.reader(test2)
    next(reader, None)  # ignore header
    test2_fruit = set(row[0] for row in reader)

# Read all the fruit from Append
with open("C:/Test/Append.txt", 'r') as append:
    fruit = set(line.strip() for line in append if line.strip())

# add all fruit that are in both test1 and test2
fruit |= test1_fruit & test2_fruit

# write out a sorted list
with open("C:/Test/Append.txt", 'w') as append:
    append.write('\n'.join(sorted(fruit))) 
```

# model-view-controller - 为什么不调用类的方法

> ID：15691575
> 
> 赞同：0
> 
> 时间：2013-03-28T20:30:52.083
> 
> 标签：model-view-controller, extjs, tabs, extjs4

我有一个 TabContainer 类。此类是 Ext.tab.Panel 的扩展。创建工作正常，但是，当我尝试向实例发送消息时 Firebug 说：

> “TypeError：tbbar.canAddTab 不是函数”

课程是：

```
Ext.define('KMA.view.environment.TabContainer',{
    extend: 'Ext.tab.Panel',
    alias: 'widget.environmenttabcontainer',

    initComponent: function(){
        [...]
        this.callParent(arguments);
    },
    createTab: function(aTitle,aToolTip,anItem){
        return {
            title: aTitle,
            itemId: aTitle + "Tag",
            tabconfig: {
                title: aTitle,
                tooltip: aToolTip,
                items: anItem
            }    
        };
    },
    openTabs: function(){
        return this.getItems().length;
    },
    maxOpenTabs: function(){
        return 7;
    },
    canAddTab: function(){
        return (this.openTabs() < this.maxOpenTabs());
    },
    addTab: function(aTabCfg){
        this.add(aTabCfg);
    }
}); 
```

我的示例代码是：

```
var tbbar = Ext.ComponentQuery.query('environmenttabcontainer');
console.log(tbbar);
console.log(tbbar.canAddTab()); 
```

在第一个“console.log”中，Firebugs 显示了 TabContainer 的实例，并显示了该类的方法。但是，为什么不工作？任何想法 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T23:39:02.777

我猜它不起作用，因为`Ext.ComponentQuery.query`返回一个数组。这有效：

```
var t = new KMA.view.environment.TabContainer();
Ext.ComponentQuery.query('environmenttabcontainer')[0].canAddTab
 > function (){
         return (this.openTabs() < this.maxOpenTabs());
    } 
```

您是否有理由使用组件查询而不是直接引用？

# windows - 使用模数运算符批量使用 for 循环

> ID：15691576
> 
> 赞同：0
> 
> 时间：2013-03-28T20:30:57.773
> 
> 标签：windows, command-line, batch-file

```
for /L %%i in (1, 1, 100) do (           
    SET VAR=%%i %% 5
    set /a CAL=%VAR% %% 5
    echo %CAL%
) 
```

大家好，这里是上面的简单代码，我试图获取索引并在每个增量上使用 % 5。

命令行给了我：

```
SET VAR = 100 % 5
set /a CAL = % 5
Missing operand. 
```

我到底做错了什么？多谢你们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:11:01.613

需要更好地解释您打算做什么。试图从不起作用的代码中找出你想要的东西变成了猜谜游戏。

您应该意识到的第一件事是，您需要使用`&`OR 将语句分开，并将它们放在单独的行上，否则右侧的 ENTIRE 表达式将分配给`VAR`.

我假设你的意思是

```
for /L %%i in (1, 1, 100) do (
 SET VAR=%%i %% 5 
 set /a CAL=%VAR% %% 5 
 echo %CAL%
) 
```

现在我们无法从中看出您真正想要实现的目标。也许您想设置`val`为表达式的值`%%i %% 5`您需要`/A`开关

```
for /L %%i in (1, 1, 100) do (
 SET /A VAR=%%i %% 5 
 set /a CAL=%VAR% %% 5 
 echo %CAL%
) 
```

现在 - 下一行，您是否尝试设置`CAL`为 的值`%VAR% %% 5`？好吧 - 有几个问题 - 首先，`VAR`将是 0..4，因此无论如何设置`CAL`为0。`VAR %% 5``CAL`

第二个问题更重要，并延伸到下一行。

FOR 循环从 FOR 到结束括号进行解析。在 PARSE-TIME，any`%var%`被变量的 THEN-CURRENT 值替换。***然后***执行代码。

由于在 PARSE 时既没有`var`也没有`cal`设置，所以将执行的是

```
for /L %%i in (1, 1, 100) do (
 SET /A VAR=%%i %% 5 
 set /a CAL= %% 5 
 echo 
) 
```

所以你会`SET CAL`在线路上得到一个“缺少操作数”的错误，并`ECHO`会及时报告“Echo is OFF”（或视情况而定）。

要克服这些问题，您需要添加一些更改...

```
SETLOCAL ENABLEDELAYEDEXPANSION
for /L %%i in (1, 1, 100) do (
 SET /A VAR=%%i %% 5 
 set /a CAL=!VAR! %% 3 
 echo !VAR! !CAL!
) 
```

请注意，`SETLOCAL ENABLEDELAYEDEXPANSION`它建立了一种模式，该模式`%var%`仍然返回 PARSE-TIME 值，但`!val!`返回 RUN-TIME 值 - 随着它的变化。由于`VAR`将在 0 和 4 之间变化，我已经更改了计算以允许看到更改，并且`CAL`ECHO 报告了`var``cal`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T22:57:26.120

以下两个代码导致相同的结果。第一个使用 DelayedExpansion 并且速度更快，第二个没有`VAR`：

```
@echo off &setlocal enabledelayedexpansion
for /L %%i in (1, 1, 100) do (
    SET /a VAR=%%i %% 5
    set /a CAL=!VAR! %% 5
    echo !CAL!
) 
```

.

```
@echo off &setlocal
for /L %%i in (1, 1, 100) do (
    set /a CAL="(%%i%%5)%%5"
    call echo %%CAL%%
) 
```

# c++ - 从 C/C++ 中的周数计算公历日期

> ID：15691579
> 
> 赞同：4
> 
> 时间：2013-03-28T20:31:05.657
> 
> 标签：c++, c, algorithm

我正在使用公历并且我想实施 IS0 8601 周，但我偶然发现了一个计算任何周数日期的问题。例如，ISO 日期`2010-W01-1`应返回*January 4, 2010*和`2009-W01-1`应返回*December 29, 2008*。

```
// Get the date for a given year, week and weekday(1-7) 
time_t *GetDateFromWeekNumber(int year, int week, int dayOfWeek)
{
    // Algorithm here
} 
```

编辑：我还没有找到任何可以在线工作的算法，尝试了很多，但我现在有点卡住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-12-06T23:19:39.743

当前接受的答案给出了 2017 年第 1 周（以及 2017 年每周）的错误答案。函数`GetDayAndMonthFromWeekInYear`，给定输入 2017 和 1`year`并`weekInYear`分别输出 1 in`month`和 2 in `dayInMonth`，表示 2017-W01 开始于 2017-01-02 星期一，但它输出的是公历日期 2017-01-01。

这个[免费的开源 C++11/14 库](https://github.com/HowardHinnant/date)使用以下语法输出从 ISO 周到公历的正确日期转换：

```
#include "date/date.h"
#include "date/iso_week.h"
#include <iostream>

int
main()
{
    using namespace iso_week::literals;
    std::cout << date::year_month_day{2017_y/1_w/mon} << '\n';
}

2017-01-02 
```

由于该库是开源的，因此可以轻松检查所使用算法的源代码（“iso_week.h”和“date.h”）。这些算法也很有效，没有使用迭代。

一般的方法是将该字段`2017_y/1_w/mon`转换为自 1970-01-01 以来的天数，使用以下算法：

```
CONSTCD14
inline
year_weeknum_weekday::operator sys_days() const NOEXCEPT
{
    return sys_days{date::year{int{y_}-1}/date::dec/date::thu[date::last]}
         + (date::mon - date::thu) + weeks{unsigned{wn_}-1} + (wd_ - mon);
} 
```

然后使用此算法将连续天数转换为`year/month/day`字段类型：

```
CONSTCD14
inline
year_month_day
year_month_day::from_sys_days(const sys_days& dp) NOEXCEPT
{
    static_assert(std::numeric_limits<unsigned>::digits >= 18,
             "This algorithm has not been ported to a 16 bit unsigned integer");
    static_assert(std::numeric_limits<int>::digits >= 20,
             "This algorithm has not been ported to a 16 bit signed integer");
    auto const z = dp.time_since_epoch().count() + 719468;
    auto const era = (z >= 0 ? z : z - 146096) / 146097;
    auto const doe = static_cast<unsigned>(z - era * 146097);          // [0, 146096]
    auto const yoe = (doe - doe/1460 + doe/36524 - doe/146096) / 365;  // [0, 399]
    auto const y = static_cast<sys_days::rep>(yoe) + era * 400;
    auto const doy = doe - (365*yoe + yoe/4 - yoe/100);                // [0, 365]
    auto const mp = (5*doy + 2)/153;                                   // [0, 11]
    auto const d = doy - (153*mp+2)/5 + 1;                             // [1, 31]
#ifdef _MSC_VER
#pragma warning(push)
#pragma warning(disable: 4146) // unary minus operator applied to unsigned type, result still unsigned
#endif
    auto const m = mp + (mp < 10 ? 3 : -9u);                           // [1, 12]
#ifdef _MSVC_VER
#pragma warning(pop)
#endif
    return year_month_day{date::year{y + (m <= 2)}, date::month(m), date::day(d)};
} 
```

后一种算法[在此处详细记录](http://howardhinnant.github.io/date_algorithms.html#civil_from_days)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T00:03:03.047

也许你应该看看[boost::date_time::gregorian](http://www.boost.org/doc/libs/1_39_0/doc/html/date_time/gregorian.html)。使用它，您可以编写这样的函数：

```
#include <boost/date_time/gregorian/gregorian.hpp>

// Get the date for a given year, week and weekday(0-6) 
time_t *GetDateFromWeekNumber(int year, int week, int dayOfWeek)
{
    using namespace boost::gregorian;
    date d(year, Jan, 1);
    int curWeekDay = d.day_of_week();
    d += date_duration((week - 1) * 7) + date_duration(dayOfWeek - curWeekDay);
    tm tmp = to_tm(d);
    time_t * ret = new time_t(mktime(&tmp));
    return ret;
} 
```

不幸的是，他们的日期格式与您的不同 - 他们从星期日开始计算星期几，即`Sunday = 0, Monday = 1, ..., Saturday = 6`. 如果它不能满足您的需求，您可以使用这个稍作改动的函数：

```
#include <boost/date_time/gregorian/gregorian.hpp>

// Get the date for a given year, week and weekday(1-7) 
time_t *GetDateFromWeekNumber(int year, int week, int dayOfWeek)
{
    using namespace boost::gregorian;
    date d(year, Jan, 1);
    if(dayOfWeek == 7) {
        dayOfWeek = 0;
        week++;
    }
    int curWeekDay = d.day_of_week();
    d += date_duration((week - 1) * 7) + date_duration(dayOfWeek - curWeekDay);
    tm tmp = to_tm(d);
    time_t * ret = new time_t(mktime(&tmp));
    return ret;
} 
```

**编辑：**

经过一番思考，我找到了一种无需使用 boost 即可实现相同功能的方法。这是代码：

**警告：以下代码已损坏，请勿使用！**

```
// Get the date for a given year, week and weekday(1-7) 
time_t *GetDateFromWeekNumber(int year, int week, int dayOfWeek)
{
    const time_t SEC_PER_DAY = 60*60*24;
    if(week_day == 7) {
        week_day = 0;
        week++;
    }
    struct tm timeinfo;
    memset(&timeinfo, 0, sizeof(tm));
    timeinfo.tm_year = year - 1900;
    timeinfo.tm_mon = 0;
    timeinfo.tm_mday = 1;
    time_t * ret = new time_t(mktime(&timeinfo));  // set all the other fields
    int cur_week_day = timeinfo.tm_wday;
    *ret += sec_per_day * ((week_day - cur_week_day) + (week - 1) * 7);
    return ret;
} 
```

**编辑2：**

**是的， EDIT**中的代码完全被破坏了，因为我没有花足够的时间来理解如何分配周数。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-29T13:12:20.073

通过 F#

```
open System
open System.Globalization

//wday: 1-7, 1:Monday
let DateFromWeekOfYear y w wday =
  let dt = new DateTime(y, 1, 4) //first week include 1/4
  let dow = if dt.DayOfWeek = DayOfWeek.Sunday then 7 else int dt.DayOfWeek //to 1-7
  let dtf = dt.AddDays(float(wday - dow))
  GregorianCalendar().AddWeeks(dtf, w - 1) 
```

# ember.js - EmberJS：模型“isLoaded”但我无法访问它的属性

> ID：15691580
> 
> 赞同：3
> 
> 时间：2013-03-28T20:31:10.993
> 
> 标签：ember.js, ember-data

在我的代码的某个地方，我遇到了一个错误。我放了一个断点来尝试看看发生了什么。当我在控制台中检查对象“foo”时，我得到：

```
foo.toString() > "<App.Foo:ember661:174009>" // all good
foo.get('isLoaded') > true 
foo.get('isValid') > true 
```

然而：

```
foo.get('name') > null // Whereas it definitely has a name. 
```

当我查看开发人员工具中的网络选项卡时，我可以看到加载记录仍在“完成”。对于相应的 URL，它说：“待定”。

这个模型状态是什么？您如何知道模型何时“完全”准备好？

**更新**：根据我对 Mike 的评论，我应该补充说我正在 registerBoundHelper 函数中检查此记录。所以我想我缺少一个上下文问题。的确：

```
... foo template ...
{{ name }} // properly set to a value
{{ my_helper this }}

... helpers ...
Ember.Handlebars.registerBoundHelper('my_helper', function(foo) {
    return foo.get('name'); // name property is null!!
}); 
```

我一定遗漏了一些明显的东西吗？

谢谢， PJ

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T22:20:31.053

> 这个模型状态是什么？

鉴于您提供的信息无法判断，但要从控制台中找出，您可以尝试以下操作：

```
foo.stateManager.get('currentPath') > should be something like "rootState.loaded.saved" 
```

然后查看[states.js 源代码](https://github.com/emberjs/data/blob/master/packages/ember-data/lib/system/model/states.js)以了解有关该状态的详细信息。

> 您如何知道模型何时“完全”准备好？

取决于您的意思*完全*和*准备好*。一些技巧可以帮助您了解是什么：

### 显示模型的原始数据

```
foo.get('data')
foo.get('data.attributes') 
```

### 当记录在状态之间转换时获取控制台日志输出

```
record.set("stateManager.enableLogging", true) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T20:53:45.777

回答我自己的问题，以防它帮助别人......

这种奇怪的行为来自助手的上下文问题。它在视图中非常“深”（几个嵌套级别向下），我正在使用`{{partial}}`新的组合`{{render}}`，您现在可以多次使用（在主控上）。如果我说我完全清楚正在发生的事情，我会撒谎，但我尝试了各种上下文切换，它最终起作用了。

所以我想如果你遇到这样的事情，请仔细检查你的助手的上下文......

# sql - 在 .sql 脚本中定义和使用变量

> ID：15691582
> 
> 赞同：2
> 
> 时间：2013-03-28T20:31:17.887
> 
> 标签：sql, oracle, plsql

我正在尝试在 .sql 文件中定义变量，以便可以在我的 sql 语句中使用它们。但是我对如何定义这些变量感到非常困惑，我什至找不到一个很好的在线资源可以清楚地解释所有这些。我遵循不同来源的建议，并且在“Oracle SQL Developer”中不断出现编译错误。这是我的两个问题：

**问题1：**似乎可以通过以下2种方式定义变量。这两种方式有什么区别，我可以同时使用吗？

```
define first_name = Joe;
select * from customer where name = '&firstname'; 
```

或者

```
variable first_name CHAR;
exec :first_name:= 'Joe';
select * from customer where name = :firstname; 
```

**问题2：** 在第一种方法中（意思是使用define命令），我可以定义一个number类型的变量吗？如果可以，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:51:45.800

你可以定义`NUMBER`变量没问题：

```
SQL> VARIABLE myNum NUMBER;
SQL> EXEC :myNum := 123.456;

PL/SQL procedure successfully completed.

SQL> print myNum;

     MYNUM                                        
----------                                        
   123.456 
```

还支持许多其他类型。以下是`USAGE`VARIABLE 命令的帮助文本：

```
Usage: VAR[IABLE] [ <variable> [ NUMBER | CHAR | CHAR (n [CHAR|BYTE]) |
                VARCHAR2 (n [CHAR|BYTE]) | NCHAR | NCHAR (n) |
                NVARCHAR2 (n) | CLOB | NCLOB | BLOB | BFILE
                REFCURSOR | BINARY_FLOAT | BINARY_DOUBLE ] ] 
```

如果您输入`VARIABLE`（或仅输入`VAR`）而不输入任何其他内容，SQL*Plus 将列出所有变量及其值。

**附录**：对比原始问题中的两种变量分配样式。

当你这样做...

```
define first_name = Joe
select * from customer where name = '&first_name'; 
```

...它更像是`#define`C/C++ 中的一个。你不能把它当作一个变量来对待；它只是每次 SQL*Plus 看到时粘贴的文本`&first_name`。

当你这样做...

```
variable first_name CHAR;
exec :first_name:= 'Joe';
select * from customer where name = :first_name; 
```

您正在创建一个可以操纵的真实变量。

请注意，如果您`CHAR`在定义中使用（没有大小），第一个分配将确定它的大小，之后您不能让它更长。如果您将其定义为`CHAR(50)`长度始终为 50 个字符并用空格填充。这可能会让人感到困惑，所以我建议`VARCHAR2`在大多数情况下使用字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T21:25:21.587

**- 问题 1 的答案：** 第一种类型的变量称为替换变量，它仅适用于 SQL*Plus 和 SQL Developer。因此，当您在任何 SQL 语句中提供替代变量时，SQL*Plus 将变量替换为它的值。它与 Oracle 服务器或性能无关。您提供的示例将在将其发送到 Oracle 数据库服务器之前转换为以下示例：

```
select * from customer where name = 'Joe'; 
```

第二部分称为绑定变量，它不是 SQL*Plus 或 SQL Developer 独有的，因为您可以在连接到 Oracle 的 Java 应用程序（或其他语言）中使用它。当您多次运行相同的语句时，绑定变量会提供更好的性能，因为您总是按原样提交语句（无需重写）。然后在数据库级别对变量进行评估。例如，假设您已将“first_name”的值更改为“Mark”：

```
exec :first_name:= 'Mark'; 
```

与绑定变量相同的语句被提交到 Oracle 数据库服务器。数据库使用缓存区域来查找以前运行过的相同语句并再次使用它。然后数据库使用变量值。这意味着数据库不需要为同一条语句重新解析和重新计算最佳执行计划。但第一种类型（替代变量）并非如此。

**- 对问题 2 的回答：** 不，你不能，因为正如我上面所说，SQL*Plus 或 SQL Developer 所做的只是重写语句，用它的值替换变量名。它对它的类型一无所知。这里只进行文本替换。

您可以在此处找到更多详细信息： [http ://www.oracle-base.com/articles/misc/literals-substitution-variables-and-bind-variables.php](http://www.oracle-base.com/articles/misc/literals-substitution-variables-and-bind-variables.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:37:04.643

在 Oracle 中，您可以按如下方式定义变量：

```
CREATE OR REPLACE FUNCTION MyFunction()
AS

    my_number     NUMBER (20, 0);
    first_name    VARCHAR2(256);

BEGIN
    first_name := 'Joe';
    select * from customer where name = first_name;

END 
```

那是你要找的吗？

# javascript - 基于计算值取消隐藏 div 的 Java 脚本

> ID：15691583
> 
> 赞同：1
> 
> 时间：2013-03-28T20:31:18.160
> 
> 标签：javascript

我有一个网页，其中包含输入值的表单。我的javascript汇总了单击提交按钮时在底部输入的值（onclick =“runTotal（this.form）），但现在我不仅需要汇总表单，还需要根据值取消隐藏特定的div总数。

基本上我需要如果字段“总计”等于以下任何一个取消隐藏 div

0-85 取消隐藏 div id 红色 125-86 取消隐藏 div id 黄色 126 或更多取消隐藏 div id 绿色

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:42:28.973

确保要显示的 DIV 最初设置为 display:"none";

```
var oldRunTotal = runTotal; 
runTotal = function(form){
  var id = "green",
      total = oldRunTotal(form);
  if (total < 0) return;
  else if (total < 86) id = "red";
  else if (total < 126) id = "yellow";
  document.getElementById(id).style.display = "block";
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:34:17.840

你可以让你的 div 原来隐藏使用

```
<div id="your-div" hidden></div> 
```

我建议您使用 jquery 来隐藏和取消隐藏该 div。这很简单：

```
$("#your-div").show(); 
```

您可以将该行放在您的 runTotal 方法中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:35:43.423

使用 jQuery 实现简单、健壮的方法：

```
$(document).ready(function() {
    $('#totalBox').change(function () {
        var total = $(this).val();
        if(total <= 85) { $("#red").toggle(); }
        else if(total > 85 && <= 125) { $("#yellow").toggle(); }
        else if(total > 125) { $("#green").toggle(); }
    }
}); 
```

**在哪里**

```
#totalBox = your "total" input textbox's ID 
```

# sql - 每种类型的数据库表，具有专有的子类型

> ID：15691584
> 
> 赞同：0
> 
> 时间：2013-03-28T20:31:22.053
> 
> 标签：sql, constraints, data-integrity, table-per-type

在每个类型架构的表中，假设我有一个 Person 类型，它有两个子类型 student 和 teacher。学生不能成为老师，老师也不能成为学生。

以下是迄今为止我知道如何设置这些的最佳方法：

```
Geometry
  ID int, PK
  Name string

Point
  ID int, PK, FK
  X float
  Y float

Line
  ID int, PK, FK
  StartPoint int, FK
  EndPoint int, FK 
```

请注意，对于子类型，主键也是 Geometry 的外键。如何确保不存在既是点又是线的几何？是否存在某种互斥约束？

如果唯一的解决方案是使用诸如特定于供应商的触发器之类的东西，我最好这样做还是在其他地方（例如稍后的通信或客户端）执行此操作？

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:39:59.397

StackOverflow 和 Database Administrators 上有一些类似的问题，可以作为一个很好的参考点。请参阅此相关问题：

[如何为引用 SQL 中其他几个实体之一的实体建模？](https://stackoverflow.com/questions/14882502/how-do-i-model-one-entity-that-references-one-of-several-other-entities-in-sql/14882893#14882893)

# magento - 强制 Magento 始终对模块使用单个控制器

> ID：15691586
> 
> 赞同：2
> 
> 时间：2013-03-28T20:31:38.607
> 
> 标签：magento

最终结果是我可以访问[http://www.mysite.com/frontname/something/something](http://www.mysite.com/frontname/something/something)

我将捕获 frontname 之后的所有内容，并使用它来添加挂钩和设置数据。这将以与类别的工作方式类似的方式起作用，但我的前名将被添加到 url，以便我可以在与该类别相关的布局中调用不同的块。

如果在这一切都弄清楚后它会帮助其他人，你会使用 _call 方法来处理所有请求：[Dynamic router name for magento controller](https://stackoverflow.com/questions/11786475/dynamic-router-name-for-magento-controller)

如果有更好的方法可以做到这一点，我会全力以赴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T23:23:48.293

您应该创建一个自定义**路由器**，该路由器将在默认路由器之外使用。要将新路由器添加到配置中，请使用以下 XML：

```
<default>
    <web>
        <routers>
            <arbitrary_name>
                <area>frontend</area>
                <class>Your_Module_Controller_Router_Something</class>
            </arbitrary_name>
        </routers>
    </web>
    <shorturls>
    </shorturls>
</default> 
```

**路由器可能如下所示：**

```
class Your_Module_Controller_Router_Something extends Mage_Core_Controller_Varien_Router_Abstract
{
    private static $_module = 'your_module';
    private static $_realModule = 'Your_Module';
    private static $_controller = 'your_controller';
    private static $_controllerClass = 'Your_Module_ControllerClassName';
    private static $_action = 'your_action';

    /**
     * @var Zend_Controller_Request_Http
     */
    protected $_request;

    /**
     * Front controller looks for collectRoutes() although it is not defined
     * in abstract router class!
     * 
     * (non-PHPdoc)
     * @see Mage_Core_Controller_Varien_Router_Standard::collectRoutes()
     */
    public function collectRoutes()
    {
        // nothing to do here
    }

    /* (non-PHPdoc)
     * @see Mage_Core_Controller_Varien_Router_Abstract::match()
     */
    public function match(Zend_Controller_Request_Http $request)
    {
        $this->_request = $request;

        // here you will have to implement your matching:
        // - detect if the request should be matched by this router
        //   (i.e. check for "frontname" after base url)
        // - return false if not

        // - otherwise:
        $this->_setRequestRoute();
        $this->_dispatch();
        return true;
    }
    /**
     * @return void
     */
    protected function _setRequestRoute()
    {
        $this->_request->setModuleName(self::$_module);
        $this->_request->setControllerName(self::$_controller);
        $this->_request->setActionName(self::$_action);
        $this->_request->setControllerModule(self::$_realModule);

    }
    /**
     * @return void
     */
    protected function _dispatch()
    {
        $this->_request->setDispatched(true);
        $controller = Mage::getControllerInstance(
            self::$_controllerClass, $this->_request, $this->_response
        );
        $controller->dispatch(self::$_action);
    }
} 
```

重要的方法是`match()`每个请求都会调用它，并且必须确定路由器是否对请求负责，如果是，则分派它。该路由器将始终调度相同的控制器操作`your_controller/your_action`。

您可能还希望根据 URL 提供一些参数：`$this->_request->setParam(key, value)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T18:52:29.170

上面的代码工作到一定程度，需要更多的理解和解释。以下是我在过去 10 个小时左右使用此工具后得出的结论：

文件：config.xml

```
<?xml version="1.0"?>
<config>
    <modules>
        <AJW_Bestselling>
            <version>1.6.0.0.1</version>
        </AJW_Bestselling>
    </modules>
    <frontend>
        <routers>
            <bestselling>
                <use>standard</use>
                <args>
                    <module>AJW_Bestselling</module>
                    <frontName>bestsellers</frontName>
                </args>
            </bestselling>
        </routers>
        <layout>
            <updates>
                <bestselling>
                    <file>bestselling.xml</file>
                </bestselling>
            </updates>
        </layout>
    </frontend>
    <global>
        <events>
            <controller_front_init_routers>
                <observers>
                    <bestselling>
                        <class>AJW_Bestselling_Controller_Router</class>
                        <method>initControllerRouters</method>
                    </bestselling>
                </observers>
            </controller_front_init_routers>
        </events>
        <models>
            <bestselling>
                <class>AJW_Bestselling_Model</class>
            </bestselling>
        </models>
        <blocks>
            <bestselling>
                <class>AJW_Bestselling_Block</class>
            </bestselling>
        </blocks>
        <helpers>
            <bestselling>
                <class>AJW_Bestselling_Helper</class>
            </bestselling>
        </helpers>
    </global> 
```

文件：控制器/路由器.php

```
<?php

class AJW_Bestselling_Controller_Router extends Mage_Core_Controller_Varien_Router_Abstract
{
    private static $_module = 'bestsellers';
    private static $_realModule = 'AJW_Bestselling';
    private static $_controller = 'index';
    private static $_controllerClass = 'AJW_Bestselling_Controller_Index';
    private static $_action = 'view';

    public function initControllerRouters($observer)
    {
        $front = $observer->getEvent()->getFront();

        $front->addRouter('bestselling', $this);
    }

    public function match(Zend_Controller_Request_Http $request)
    {
        $this->_request = $request;
        $identifier = trim($request->getPathInfo(), '/');

        //If Magento Is Not Installed Reroute To Installer
        if (!Mage::isInstalled()) {
            Mage::app()->getFrontController()->getResponse()
                ->setRedirect(Mage::getUrl('install'))
                ->sendResponse();
            exit;
        }
        //If we dont match our router then let another router take over
        if(!substr($identifier,0,strlen('bestsellers')) == 'bestsellers'){
            return false;
        }
        //If we do match the our router then lets add some data and dispatch our 

controller
            else{
            $route_params = str_replace ( "bestsellers/" , "" , $identifier );
            $rewrite = Mage::getModel('core/url_rewrite');
            $rewrite->setStoreId(1);
            $rewrite->loadByRequestPath($route_params);
            $category_route = $rewrite->getIdPath();
                //Check to see if the route exists before we do anything else
                if(!$category_route != ""){
                    return false;
                }//Otherwise send the parameters to the request
                else{
                    $id = str_replace ( "category/" , "" , $category_route );
                    $this->_request->setParam('id',$id);
                }

            }
            $this->_setRequestRoute();
            return true;
        }

        protected function _setRequestRoute()
        {
            $this->_request->setModuleName(self::$_module)
                ->setControllerName(self::$_controller)
                ->setActionName(self::$_action)
                ->setControllerModule(self::$_realModule);
            return true;

        }

    } 
```

文件：控制器/IndexController.php

```
class AJW_Bestselling_IndexController extends Mage_Core_Controller_Front_Action{

    public function indexAction(){

        echo "This is the index controller";
        die();
    }

    public function viewAction(){
        $this->loadLayout();
        $this->renderLayout();
    }
} 
```

如果您只访问 mysite.com/bestsellers/ 会发生什么，路由器将加载索引控制器。但是，如果您访问 bestsellers/some/category/url.html，它将触发 viewAction 并且类别 ID 将被发送以供控制器使用。

这背后的概念是能够根据 .com 之后 URL 的第一部分向每个类别显示内容 - 一些想法可能是最畅销的、最推荐的、最受好评的类别问题 .. 任何会形成与特定类别的多对一（或多）关系。

另请注意，您可以通过有条件地设置 AJW_Bestsales_Controller_Router 的参数来使用同一个模块作为多个模块的路由器。

# python - 使用 py.test 运行测试套件（任意测试集合）

> ID：15691587
> 
> 赞同：5
> 
> 时间：2013-03-28T20:31:39.543
> 
> 标签：python, unit-testing, python-2.7, pytest

我正在使用 py.test 构建功能测试框架，因此我需要能够指定要运行的确切测试。我了解动态测试集合的美妙之处，但我希望能够先运行我的测试环境健康检查，然后再运行我的回归测试；该分类并不排除将这些集合中的测试用于其他目的。

测试套件将与 Jenkins 构建项目相关联。我正在使用 osx、python 2.7.3、py.test 2.3.4。

所以我有一个如下的测试用例：

```
# sample_unittest.py
import unittest, pytest

class TestClass(unittest.TestCase):

    def setUp(self):
        self.testdata = ['apple', 'pear', 'berry']

    def test_first(self):
        assert 'apple' in self.testdata

    def test_second(self):
        assert 'pear' in self.testdata

    def tearDown(self):
        self.testdata = []

def suite():
    suite = unittest.TestSuite()
    suite.addTest(TestClass('test_first'))
    return suite

if __name__ == '__main__':
    unittest.TextTestRunner(verbosity=2).run(suite()) 
```

我有一个这样的测试套件：

```
# suite_regression.py
import unittest, pytest
import functionaltests.sample_unittest as sample_unittest

# set up the imported tests
suite_sample_unittest = sample_unittest.suite()

# create this test suite
suite = unittest.TestSuite()
suite.addTest(suite_sample_unittest)

# run the suite
unittest.TextTestRunner(verbosity=2).run(suite) 
```

如果我从命令行对套件运行以下命令，test_first 会运行（但我没有得到 py.test 将提供的附加信息）：

> python 功能测试/suite_regression.py -v

如果我对套件运行以下命令，则会收集 0 个测试：

> py.test 功能测试/suite_regression.py

如果我对测试用例运行以下命令，则 test_first 和 test_second 运行：

> py.test 功能测试/sample_unittest.py -v

我看不出用关键字做 py.test 将如何帮助将测试组织成套件。将测试用例放入文件夹结构并使用文件夹选项运行 py.test 不会让我按功能区域组织测试。

所以我的问题：

1.  是否有 py.test 机制以可重用格式指定任意测试分组？
2.  有没有办法使用 py.test 中的 unittest.TestSuite？

编辑：所以我尝试了 py.test 标记，它可以让我用任意标签标记测试函数和测试方法，然后在运行时过滤该标签。

```
# conftest.py
import pytest

# set up custom markers
regression = pytest.mark.NAME
health = pytest.mark.NAME 
```

我更新的测试用例：

```
# sample_unittest.py
import unittest, pytest

class TestClass(unittest.TestCase):

    def setUp(self):
        self.testdata = ['apple', 'pear', 'berry']

    @pytest.mark.healthcheck
    @pytest.mark.regression
    def test_first(self):
        assert 'apple' in self.testdata

    @pytest.mark.regression
    def test_second(self):
        assert 'pear' in self.testdata

    def tearDown(self):
        self.testdata = []

def suite():
    suite = unittest.TestSuite()
    suite.addTest(TestClass('test_first'))
    return suite

if __name__ == '__main__':
    unittest.TextTestRunner(verbosity=2).run(suite()) 
```

因此，运行以下命令会收集并运行 test_first：

> py.test 功能测试/sample_unittest.py -v -m healthcheck

这会收集并运行 test_first 和 test_second：

> py.test 功能测试/sample_unittest.py -v -m 回归

所以回到我的问题：标记是一个部分解决方案，但我仍然没有办法控制收集的标记测试的执行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-05-27T18:26:45.043

在这种情况下不需要使用标记：[`@pytest.mark.incremental`](https://docs.pytest.org/en/latest/example/simple.html#incremental-testing-test-steps)在你的 py.test 测试类上设置将强制执行顺序为声明顺序：

```
# sequential.py
import pytest

@pytest.mark.incremental
class TestSequential:

    def test_first(self):
        print('first')

    def test_second(self):
        print('second')

    def test_third(self):
        print('third') 
```

现在运行它

```
pytest -s -v sequential.py 
```

产生以下输出：

```
=========== test session starts ===========
collected 3 items

sequential.py::TestSequential::test_first first
PASSED
sequential.py::TestSequential::test_second second
PASSED
sequential.py::TestSequential::test_third third
PASSED
=========== 3 passed in 0.01 seconds =========== 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-31T03:12:38.720

我想现在有点晚了，但我刚刚完成了一个带有文档的交互式选择插件：

[https://github.com/tgoodlet/pytest-interactive](https://github.com/tgoodlet/pytest-interactive)

我实际上使用了上面提到的钩子 Holger。

它允许您在使用 IPython 的收集阶段之后选择一系列测试。如果您想要的话，使用切片、下标或制表符完成对测试进行排序非常容易。请注意，它是一个交互式工具，用于在开发过程中使用，而不是用于自动回归运行。

对于使用标记的持久排序，我使用[了 pytest-ordering](http://pytest-ordering.readthedocs.org/en/develop/)这实际上非常有用，特别是如果您在长回归套件中有基线先决条件测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-02T08:25:05.090

目前没有直接的方法来控制测试执行的顺序。FWIW，有一个插件钩子`pytest_collection_modifyitems`可以用来实现一些东西。有关使用它来实现随机化的插件，请参阅[https://github.com/klrmn/pytest-random/blob/master/random_plugin.py](https://github.com/klrmn/pytest-random/blob/master/random_plugin.py)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-07T14:07:54.360

我知道这很旧，但是这个库似乎完全允许操作人员正在寻找什么......将来可能会对某人有所帮助。

[https://pytest-ordering.readthedocs.io/en/develop/](https://pytest-ordering.readthedocs.io/en/develop/)

# jquery - 修改文本建议

> ID：15691591
> 
> 赞同：1
> 
> 时间：2013-03-28T20:32:02.680
> 
> 标签：jquery

我正在使用 TextExt：[http ://textextjs.com/](http://textextjs.com/)

这是我目前的代码：

```
$('#company').textext({
    plugins : 'autocomplete filter ajax',

    autocomplete : {
        render : function (suggestion) {
            var organization = suggestion.split('#');

            return '<strong>' + organization[0] + '</strong><br />' + organization[1];
        }                            
    },

    ajax : {
        url : '/organizations.json',
        dataType : 'json',
        cacheResults : true
    }
}); 
```

这是json输出的内容：

> > [“组织#地址”]

它目前工作正常，但是当用户单击建议时，文本框会包含“Organization#Address”。我的问题是，如何修改 texttext，以便当用户单击建议时，它只会将“组织”填充到文本框中，而不是整个 json 建议。

如果不清楚，我可以进一步解释。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-01T07:22:11.820

不知道你是否还想要一个答案（考虑到这个问题是九个月前提出的），但以防万一这是我基于我在类似情况下编写的一些代码的建议：

```
$('#company').textext({
    plugins : 'autocomplete filter ajax',

    autocomplete : ...as before

    ajax : ... as before

    // new bit
    ext: {
         selectFromDropdown: function() {
             var self = this;
             var suggestion = self.selectedSuggestionElement().data('text-suggestion');
             var organization

             if (suggestion) {
                 organization = suggestion.split('#');

                 self.val( self.itemManager().itemToString(organization[0]));
                 self.core().getFormData();
             }

             self.trigger('hideDropdown');
         }
    }
}); 
```

我还没有测试过这个特定版本的代码，所以可能需要稍微调整一下。

另一种选择可能是编写您自己的 ItemManager。

# android - create table 在事务中的行为如何？

> ID：15691593
> 
> 赞同：1
> 
> 时间：2013-03-28T20:32:11.603
> 
> 标签：android, sqlite

我运行两个事务。

在第一个事务中，创建了表测试，但是我说这个事务的回滚。

我认为那么表测试应该是否已经创建，但不是介于两者之间。

然后我运行另一个事务来测试发生了什么：

我在表测试中插入一行。这似乎在程序中有效，但是当我进入 sqlite 提示符时，当我说命令“.schema”时，我没有看到那里的表测试。

有人能说出发生了什么吗？

我的代码的输出是：“插入确定。”

```
 try
    {
      db.beginTransaction();

      String s =
      "CREATE TABLE test(id INTEGER PRIMARY KEY AUTOINCREMENT ,age INTEGER)";
      db.execSQL(s);
    }
    catch (Exception e)
    {
      System.out.println("Exception 1:"+e);
    }
    finally
    {
      db.endTransaction();
    }

    try
    {
      db.beginTransaction();
      db.execSQL("INSERT INTO test VALUES(NULL,22)");
      db.setTransactionSuccessful();
      System.out.println("Insert ok.");
    }
    catch (Exception e)
    {
      System.out.println("Exception 2:"+e);
    }
    finally
    {
      db.endTransaction();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:38:42.380

> 有人能说出发生了什么吗？

这是正常行为。未创建您的表是因为您未提交`TRANSACTION`以及未执行插入。你得到结果的原因

```
System.out.println("Insert ok."); 
```

是 execSQL() 方法仅在您的**查询字符串**无效/损坏的情况下抛出 SQLException 。而且您也不能使用 execSQL() 进行插入。您只能将其用于更改表。

> 执行不是 SELECT/INSERT/UPDATE/DELETE 的单个 SQL 语句。

## 解决方案：

由于`execSQL()`是 void 类型，您需要使用`API`方法[`insert()`](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insert)来测试结果。

```
long rowId = db.insert("test", <nullColumnHack>, values);
if (rowId < 0) {
    // error
} 
```

# jquery - 使用 .css() 在 IE 中使用 jQuery 获取边框颜色

> ID：15691595
> 
> 赞同：13
> 
> 时间：2013-03-28T20:32:22.250
> 
> 标签：jquery, css, internet-explorer, border

在 Internet Explorer 中获取单击元素的边框颜色时出现问题。

```
$("#clickme").click(function() {
    alert($(this).css('border-color'));
}); 
```

这是 jsfiddle： http: [//jsfiddle.net/dS7mc/](http://jsfiddle.net/dS7mc/)
它适用于 chrome，但不适用于 IE10。

任何想法如何使它与两者一起工作？也仅更改为“边框”，在 chrome 中它给了我`2px solid rgb(0, 0, 0)`，但在即我仍然得到空警报。

PS。是的，我试过“borderColor”。在 IE 中也不起作用

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T20:53:59.120

这是因为在 Internet Explorer 中没有`border-color`. 该属性被重命名为border- *pos* - color：

```
border-top-color: #000000;
border-right-color: #000000;
border-bottom-color: #000000;
border-left-color: #000000; 
```

这同样适用于`border-width`和`border-style`(`border-left-width`等)。为了拉出边框颜色（假设所有 4 个都相同），您将使用：

```
$(this).css('border-top-color'); 
```

同样拉`border-width`或`border-style`（再次假设所有 4 都相等）你会使用：

```
$(this).css('border-top-width');
$(this).css('border-top-style'); 
```

*您可以使用 IE 的F12 开发人员工具*找到元素具有的样式属性：

![IE 开发工具](../Images/c058f5e8b80aca69b52709e19008d805.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-28T20:47:45.360

试试这个..适用于 IE8

```
$("#clickme").click(function() {
    $('body').append($(this).css('border-top-color'));
}); 
```

![在此处输入图像描述](../Images/1899bbe47d0c692160f29b1b934922e7.png)

# [*jsFiddle*](http://jsfiddle.net/mohammadAdil/dS7mc/31/)

此外，浏览器以不同的方式返回颜色 FireFox、Safari 和 Chrome 将它们作为`rgb()`值`IE`返回，并完全按照您在您中设置的方式返回它们，`CSS`即使您使用速记符号 ( `#f00`vs `#ff0000`) 并且 Opera 始终`hexidecimal`以 6 位返回颜色

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T20:50:31.347

类似于穆罕默德·阿迪尔：

```
$("#clickme").click(function() {
    var Bcolor = $(this).css("border-left-color");
    alert(Bcolor);
}); 
```

你必须指定每一面

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T20:50:39.480

试试普通的js

```
var clickme = $("#clickme")[0];
    clickme.addEventListener('click', function() {
    alert(clickme.style.borderColor)
    }, false) 
```

# jquery - 尝试使用 tablesorter 添加解析器时出现正则表达式错误

> ID：15691598
> 
> 赞同：0
> 
> 时间：2013-03-28T20:32:30.140
> 
> 标签：jquery, regex, tablesorter

我正在尝试使用 tablesorter jquery 库对时间/日期列进行排序。我在使用正则表达式并对其进行排序时遇到问题。有人可以帮忙吗？我的时间/日期格式是：

下午 2:06

周四 3 月 28 日

像这样。日期在单独的一行。我的正则表达式是这样的：

```
/$(\d{1,2}):(\d\d):(\d\d) (a\.m\.|p\.m\.) (\d{1,2})\/(\d{1,2})\/(\d{4})$/ 
```

我解析日期的功能是：

```
$.tablesorter.addParser({
        id: 'DateParser',
        is: function(s) {
                return false;
        },
        format: function(s) {
                var date = s.match(/$(\d{1,2}):(\d\d):(\d\d) (a\.m\.|p\.m\.) (\d{1,2})\/(\d{1,2})\/(\d{4})$/)
                var d = date[1];
                var m = date[2];
                var y = date[3];
                var H = date[4];
                var M = date[5];
                var S = date[6];
                var MS = 0;

                return new Date(y, m, d, H, M, S, MS).getTime();
        },
        type: 'numeric'
}); 
```

我得到的错误是：“Uncaught TypeError: Cannot read property '1' of null” 当用谷歌浏览器看到时。我认为最好的方法是使用正则表达式。但如果我弄错了，我愿意换一种更好的方式。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:36:08.820

试试这个正则表达式：

```
s.match(/^(\d{1,2}):(\d\d) (AM|PM)\n(\w+) (\w+) (\d{1,2})$/) 
```

`$`匹配字符串的*结尾*。你想`^`匹配开头。`\n`匹配换行符。`\w`匹配字母。

那么，输出的顺序，从 1 到 6，是：

```
["2", "06", "PM", "Thu", "Mar", "28"] 
```

# javascript - 单击复选框时显示文本输入 - Jquery

> ID：15691603
> 
> 赞同：0
> 
> 时间：2013-03-28T20:33:11.147
> 
> 标签：javascript, jquery, each

我对这段代码有疑问，我不知道它为什么不起作用。本质上，当一个复选框被点击时，同一个 li 中的文本字段应该会显示出来。

我不想要“隐藏/显示”，因为这会用其他字段填充数组，所以如果选中了复选框，我正在考虑用新的输入填充 div。

我遇到问题的任何想法？

这是我的html：

```
<ul>
    <li class="practice"><label><input type="checkbox" value="Practice 1" class="input_control" name="practice_areas[id][name]" /> Practice 1</label> <div class="showOrder"></div></li>
    <li class="practice"><label><input type="checkbox" value="Practice 2" class="input_control" name="practice_areas[id][name]"  /> Practice 2</label> <div class="showOrder"></div></li>
    <li class="practice"><label><input type="checkbox" value="Practice 3" class="input_control" name="practice_areas[id][name]"  /> Practice 3</label> <div class="showOrder"></div></li>
    <li class="practice"><label><input type="checkbox" value="Practice 4" class="input_control" name="practice_areas[id][name]"  /> Practice 4</label> <div class="showOrder"></div></li>
    <li class="practice"><label><input type="checkbox" value="Practice 5" class="input_control" name="practice_areas[id][name]"  /> Practice 5</label> <div class="showOrder"></div></li>                 
</ul> 
```

这是我的 Javascript：

```
<script>
jQuery('li.practice').each(function() {
    jQuery(".input_control", this).click(function() {
        jQuery('.showOrder', this).html('<label>Order: <input type="text" size="2" name="practice_area[id][order]" value="" /></label>');
    });
});

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:36:07.153

您错误地使用您的`.input_control`as 上下文来定位您的`.showOrder`，我将您的代码更改为使用您的`li.practice`as 上下文，因此请执行以下操作：

```
jQuery('li.practice').each(function() {
    var li = this;
    jQuery(".input_control", this).click(function() {
        jQuery('.showOrder', li).html('<label>Order: <input type="text" size="2" name="practice_area[id][order]" value="" /></label>');
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T20:36:16.910

您在滥用`$(selector, context)`，该`.showOrder`元素不在单击元素的上下文中。

```
$('li.practice .input_control').change(function(){
    var $target = $(this).closest('li').find('.showOrder');
    if (this.checked) {
        $target.html('<label>Order: <input type="text" size="2" name="practice_area[id][order]" value="" /></label>');
    } else {
        $target.empty();
    }
}); 
```

[http://jsfiddle.net/Qh6Fq/1/](http://jsfiddle.net/Qh6Fq/1/)

# c++ - 使用没有填充的类在 C++ 中读取二进制数据的最佳方法

> ID：15691605
> 
> 赞同：3
> 
> 时间：2013-03-28T20:33:11.780
> 
> 标签：c++, class, padding

我正在读取没有指针的简单二进制数据，使用 C++ 类而不使用以下代码填充：

```
#include <fstream>
#include <iostream>

using namespace std;

class Data {
    public:
    int a;
    int b;
    short int c;
    double d;
}__attribute__((packed));

int main() {
    Data myData;      
    ifstream ifs("test.bin", ios::binary);
    ifs.read((char *)&myData, sizeof(myData));
    ifs.close();
} 
```

我使用这种方法是因为数据可能有 20 多种不同的格式，我想编写 20 多种不同的类来涵盖所有可能出现的格式。我还读到其他选项包括使用位域、pragma 指令，甚至是 boost 序列化例程（我不能，因为我必须使用 std）。我的问题是：**这是使用没有填充的类读取简单二进制数据的最佳方法吗？您是否建议任何其他替代方案？**我想了解什么是最安全和最广泛使用的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:36:12.797

通常，人们会使用 a`struct`而不是 a `class`，但是是的，相同的概念适用于两者。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:42:08.197

我使用这些宏来允许打包结构在 gcc 和 VC 上编译：

```
#ifdef _MSC_VER
    #define BEGIN_PACK __pragma( pack(push, 1) )
    #define END_PACK __pragma( pack(pop) )
#else
    #define BEGIN_PACK 
    #define END_PACK __attribute__((packed))
#endif 
```

那么你会像这样使用它们：

```
BEGIN_PACK
struct Data {
    int a;
    int b;
    short int c;
    double d;
} END_PACK; 
```

但是，是的，通常就是这样完成的。请注意，这些是非标准扩展。

C++11 已经定义了打包指令，但我不知道编译器是否支持它们。

# android - 首次启动时 overridePendingTransition 不起作用（仅应用程序启动！）

> ID：15691606
> 
> 赞同：0
> 
> 时间：2013-03-28T20:33:13.417
> 
> 标签：android, animation

我正在打电话，`overridePendingTransition`一切都很好......`onCreate``onPause`

但是当应用程序启动时，转换不起作用......

有什么技巧可以让它工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-06T16:30:52.830

发生这种情况可能是您没有创建活动的新实例。可能是我们设置intentflage。像 intent.setFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT); startActivity(about_intent);

# url - 为 CSS 行为构建 URL

> ID：15691607
> 
> 赞同：1
> 
> 时间：2013-03-28T20:33:15.400
> 
> 标签：url, css, behavior

我在我的网站中使用 CSS3Pie 以允许在旧版本的 IE 中使用圆角。在我的 CSS 类中，我需要将属性添加`behavior`到我的 CSS 类中

```
#myclass
{
    border-radius: 10px;
    behavior: url(pie.htc)
} 
```

它适用于网站根级别的任何页面。当我浏览到我的站点中使用该类的任何子目录时，它不会应用圆角，因为 pie.htc 位于侧面的根目录中。行为 URL 与 HTML 页面相关，而不是 CSS 样式表。

我怎样才能建立一个 URL `behavior`，使它可以在我的网站的所有级别访问？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:36:14.560

从绝对路径引用它应该有效吗？[http://www.domain.com/youknowwhat](http://www.domain.com/youknowwhat) 仍然很奇怪它与 HTML 相关，但您会认为它与 CSS 文件相关。

# github - 如何将更改从 github 存储库拉到本地计算机？

> ID：15691611
> 
> 赞同：8
> 
> 时间：2013-03-28T20:33:33.980
> 
> 标签：github

我已经看到了几个与此非常相似的问题/答案，但仍然不确定我是否理解它们是否是我需要的。因此，如果之前类似的事情已经涵盖了这一点，请接受我的道歉。

我有一个包含多个存储库的私人 GitHub 帐户。我从我的 mac 创建了这些，将它们推送到 GitHub，一切都很好。

在我的 Ubuntu 桌面上，我做了一个 git clone 并将几个存储库拉到那个桌面。现在从 Ubuntu 中，我对文件进行更改、添加、提交并将其推送到 GitHub。

问题：我如何（什么命令）在我的 mac 上将更改拉到我的本地存储库，以便我得到更改？用户名是 JohnCowan，repo 是 sacnomadgolf.git

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-28T20:35:53.460

你说你在你的 Mac 上做了 repo。然后你可以`git pull`在你有存储库的文件夹中做。

一个非常好的 Git 资源，附有关于“Git 工作流程”的解释性插图：

[http://git-scm.com/doc](http://git-scm.com/doc)

# javascript - 在 javascript 中操作时间变量 - 将小时添加到时间变量

> ID：15691618
> 
> 赞同：0
> 
> 时间：2013-03-28T20:34:31.647
> 
> 标签：javascript, titanium

我正在使用 json 文件获取数据，其中一个变量是关于时间的，例如 19:00，如 GMT+0。如果我想将其转换为 GMT+2，我需要添加 2，但我不知道如何...我正在尝试在 Titanium 项目中执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:04:24.887

```
var time = "19:00";
function incHour(t,hr){ return parseInt(hr) + 2; }
time = time.replace( /^(\d{1,2})/, incHour ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T02:09:04.763

我总是推荐 momentjs，如果你认为你将不得不做更多的时间操作

[http://momentjs.com/](http://momentjs.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T21:00:41.580

参考：[如何将 30 分钟添加到 JavaScript 日期对象？](https://stackoverflow.com/questions/1197928/how-to-add-30-minutes-to-a-javascript-date-object)

```
var d1 = new Date ('6/29/2011 4:52:48 PM'),
    d2 = new Date ( d1 );
d2.setHours ( d1.getHours() + 2 );
alert ( d2 ); 
```

# sql - 获取访问权限以返回空白记录？

> ID：15691619
> 
> 赞同：1
> 
> 时间：2013-03-28T20:34:36.093
> 
> 标签：sql, ms-access, null

我靠运气和胶带建立了一个数据库来处理一些员工数据。我每月收到一个包含以下字段的大型 Excel 电子表格：

员工编号、会计月份、项目代码、工作时间

我构建了查询/表来链接员工编号和员工姓名等内容。一切都很好。

我遇到的问题，这可能是因为除了一些 1 天的课程之外，我没有任何编程背景，我希望它在没有工作时间的情况下返回结果。

举一个具体的例子——假设我们有一个名为 Project Pasta 的项目。在三月份，没有人在 Project Pasta 上工作任何时间。但是，当我运行每个项目的所有工作时间的报告时，我希望 Project Pasta 在生成的电子表格的第二列中仍然显示为“0”。

我尝试了各种形式的左外连接，但我不知道如何获得“空”返回，我对 Access 和我自己感到非常恼火，我想我会哭求帮助。

我会回答任何人的任何问题，但我不能 100% 确定人们需要知道什么才能提供帮助。它是 Windows XP 上的 Microsoft Access 2007，物有所值。

谢谢！:)

我现在的查询按经理分组：

```
SELECT timeworked.fiscalmonth, 
       timeworked.projectcode, 
       kronoscodes.projectname, 
       SUM(timeworked.hoursworked) AS SumOfHoursWorked, 
       employees.manager 
FROM   employees 
       INNER JOIN ((kronoscodes 
                    INNER JOIN timeworked 
                            ON kronoscodes.projectcode = timeworked.projectcode) 
                   INNER JOIN months 
                           ON timeworked.fiscalmonth = months.fiscalmonth) 
               ON employees.[employee id] = timeworked.employeeid 
GROUP  BY timeworked.fiscalmonth, 
          timeworked.projectcode, 
          kronoscodes.projectname, 
          employees.manager 
HAVING (( ( timeworked.fiscalmonth ) LIKE "janfy13" )); 
```

列名是：

```
EmployeeID, 
ProjectCode, 
ProjectName, 
HoursWorked, 
FiscalMonth 
```

所以基本上我希望每个财政月的每个项目代码都回来，即使在我导入的数据中“工作时间”下没有任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T12:47:30.910

考虑以下示例数据：

```
Table: timeworked
employeeid  fiscalmonth projectcode hoursworked
1           janfy13     101         16
2           janfy13     101         11
1           janfy13     102         8

Table: employees
[employee id]   manager
1               Manager A
2               Manager B

Table: kronoscodes
projectcode projectname
101         Project 101
102         Project 102
103         Project 103 
```

使用直接的 INNER JOINS，您的“经理报告”的略微简化版本将如下所示：

![内](../Images/f7e2d2d47b1dc31534acb7c89d2a9b66.png)

SQL在哪里

```
SELECT employees.manager, timeworked.fiscalmonth, kronoscodes.projectname, 
    Sum(timeworked.hoursworked) AS SumOfHoursWorked
FROM employees INNER JOIN 
    (kronoscodes INNER JOIN timeworked 
        ON kronoscodes.projectcode = timeworked.projectcode
    ) ON employees.[employee id] = timeworked.employeeid
GROUP BY employees.manager, timeworked.fiscalmonth, kronoscodes.projectname; 
```

结果看起来像这样

```
manager     fiscalmonth projectname SumOfHoursWorked
Manager A   janfy13     Project 101 16
Manager A   janfy13     Project 102 8
Manager B   janfy13     Project 101 11 
```

嗯，没有提到“经理B”的“Project 102”，根本没有提到“Project 103”。尽管如此，这是一个很好的开始，所以让我们将其保存为“ProjectSumsByManager_innerJoin”。（以后可能有用……提示，提示。）

我们想查看**所有**项目，所以我们右键单击 [timeworked] 和 [kronoscodes] 之间的连接，选择“Join Properties”，然后选择选项“Include ALL records from 'kronoscodes' and only those records from 'timeworked'连接字段相等的地方。”

![加入道具](../Images/8cdf56aa1b3fa5fb8087ef966305f4db.png)

不幸的是，当我们尝试运行查询时，我们得到了令人讨厌的“模糊外部连接”消息：

> SQL 语句无法执行，因为它包含不明确的外部连接。要强制首先执行其中一个连接，请创建一个单独的查询来执行第一个连接，然后将该查询包含在您的 SQL 语句中。

好的，所以我们只使用该连接创建一个单独的查询：

![外1](../Images/ca71ea198de5da4bc1829d18bd080fa4.png)

SQL在哪里

```
SELECT kronoscodes.projectcode, timeworked.employeeid, 
    timeworked.fiscalmonth, timeworked.hoursworked
FROM kronoscodes LEFT JOIN timeworked 
    ON kronoscodes.projectcode = timeworked.projectcode; 
```

结果看起来像这样。

```
projectcode employeeid  fiscalmonth hoursworked
101         1           janfy13     16
101         2           janfy13     11
102         1           janfy13     8
103 
```

嗯，“项目 103”在那里，但它没有员工 ID，所以我们无法链接到 [员工] 记录并获得经理。此外，“项目 102”仍然只与“员工 1”（“经理 A”）相关联，因此“经理 B”仍然不会出现。这种方法看起来并不是特别有希望。

也许我们真正想要的只是所有项目和所有经理的列表：

```
SELECT DISTINCT kronoscodes.projectname, employees.manager
FROM kronoscodes, employees; 
```

返回

```
projectcode         manager
Project 101         Manager A
Project 101         Manager B
Project 102         Manager A
Project 102         Manager B
Project 103         Manager A
Project 103         Manager B 
```

如果我们在 Access 中创建一个新查询，将该 SQL 语句键入（或粘贴）到 SQL 视图中，然后将其保存为“Project_Manager_map”，我们可以将其与上面的第一个查询 LEFT JOIN *，*并得到

![外层2](../Images/a2ae2fb36f43b15aa94b565a2fe7c2a2.png)

SQL在哪里

```
SELECT Project_Manager_map.manager, ProjectSumsByManager_innerJoin.fiscalmonth, 
    Project_Manager_map.projectname, ProjectSumsByManager_innerJoin.SumOfHoursWorked
FROM Project_Manager_map LEFT JOIN ProjectSumsByManager_innerJoin ON 
    (Project_Manager_map.manager = ProjectSumsByManager_innerJoin.manager) 
        AND (Project_Manager_map.projectname = ProjectSumsByManager_innerJoin.projectname); 
```

结果是

```
manager     fiscalmonth projectname SumOfHoursWorked
Manager A   janfy13     Project 101 16
Manager B   janfy13     Project 101 11
Manager A   janfy13     Project 102 8
Manager B               Project 102 
Manager A               Project 103 
Manager B               Project 103 
```

# ruby - 使用 ruby -dbus 和 udisk 查找 USB 属性/详细信息

> ID：15691620
> 
> 赞同：1
> 
> 时间：2013-03-28T20:34:40.887
> 
> 标签：ruby

我需要检测所有可用的 USB 驱动器及其信息。主要我对 USB 设备（闪存驱动器和外部硬盘）、挂载点、uuid、总大小、可用空间、标签以及是否挂载 USB 感兴趣。我认为 ruby​​-dbus 与 udisk 一起使用会更好。所以安装没有错误。但是我无法继续进行。我需要在linux上使用它。这是示例代码

```
#!/usr/bin/env ruby
require 'rubygems'
require 'dbus'
bus = DBus::SystemBus.instance
rb_service = bus.service("org.freedesktop.UDisks")
rb_udisk = rb_service.object("/org/freedesktop/UDisks")
rb_udisk.introspect
rb_udisk_iface = rb_udisk["org.freedesktop.UDisks.Device"]
puts rb_udisk_iface.DeviceIsRemovable 
```

但是我得到这个错误未定义的方法'DeviceIsRemovable' for nil:NilClass (NoMethodError) 我不明白。有人可以帮助我吗？有用的链接：- python 和 udisk [http://mindbending.org/en/python-and-udisks-part-5](http://mindbending.org/en/python-and-udisks-part-5) [python udisk - 枚举设备信息](https://stackoverflow.com/questions/5067005/python-)...

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T01:46:58.523

```
#!/usr/bin/env ruby

require 'dbus'

bus = DBus::SystemBus.instance
udisk_service = bus.service("org.freedesktop.UDisks")
udisk_udisk = udisk_service.object("/org/freedesktop/UDisks")
udisk_udisk.introspect
udisk_udisk.default_iface = "org.freedesktop.UDisks"
disk_list = udisk_udisk.EnumerateDevices[0]
    disk_list.each { |disk|
    udisk_udisk = udisk_service.object("#{disk}")
    udisk_udisk.introspect
    udisk_udisk_i = udisk_udisk["org.freedesktop.UDisks.Device"]
    if udisk_udisk_i["DriveConnectionInterface"] == "usb" && udisk_udisk_i["DeviceIsPartition"]
    #puts disk #Debug
    puts "Device file: #{udisk_udisk_i["DeviceFile"]}"
    puts "Is device mounted: #{udisk_udisk_i["DeviceIsMounted"]}"
    puts "Is device mount path: #{udisk_udisk_i["DeviceMountPaths"]}"
    puts "Device uuid: #{udisk_udisk_i["IdUuid"]}"
    puts "Device label: #{udisk_udisk_i["IdLabel"]}"
    puts ""
    end
    } 
```

# asp.net - 如何根据两个字段与 LINQ 的组合来选择不同的？

> ID：15691622
> 
> 赞同：2
> 
> 时间：2013-03-28T20:34:41.240
> 
> 标签：asp.net, linq, entity-framework-5, where

如何仅选择在一行中只有两个值的不同组合的记录？

例如，假设我有以下内容：

```
Name     |     Age     |     Height
------------------------------------
Joe          19               99
Kim          19               76
Joe          20               88
Joe          19               69 
```

我如何编写一个 LINQ 表达式来仅选择具有相同`Name`AND的行`Age`？

我试过： `var count = context.people.Where(p => (p.age && p.name).Distinct());` 和`var count = context.people.Where(p => (p.age.Distinct() && p.name.Distinct()));`

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T20:38:31.513

您可以将姓名和年龄选择为匿名类型，然后使用`Distinct()`：

```
var results = context.people
                     .Select(p => new { p.Name, p.Age })
                     .Distinct(); 
```

显然这不会给你高度，但是*没有*单一的高度。如果您还想要所有高度，则需要进行分组：

```
var results = context.people
                     .GroupBy(p => new { p.Name, p.Age }); 
```

这将为您提供一系列分组，其中每个分组包含所有具有相同姓名和年龄的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:39:24.570

您应该`GroupBy`在 linq 中使用这些场景：

```
var result = people.GroupBy(p => new{p.Name, p.Age}) 
```

~~.Select(g => g.Key)~~

更新：
正如 Jon Skeet 提到的，这为您提供了基于`Name`和`Age`值的分组列表。然后，您可以例如添加`.Select(g => g.Max(p => p.Height))`以获取`List<Person>`包含每个名称/年龄组中最高的类型的结果。

# javascript - Backbone + Require 与 Backbone.localStorage

> ID：15691625
> 
> 赞同：0
> 
> 时间：2013-03-28T20:34:48.827
> 
> 标签：javascript, backbone.js, local-storage, requirejs

我正在使用 Backbone 和 RequireJS 构建一个应用程序，[以此](http://kilon.org/blog/2012/08/build-backbone-apps-using-requirejs/)为指导。由于 Backbone 不是 AMD，我使用的是 RequireJS shim，如我上面提到的指南中所述。

我的主要脚本如下所示：

```
require.config({
  baseUrl: "js/",
  paths: {
    jquery: 'lib/jquery.min',
    underscore: 'lib/underscore',
    backbone: 'lib/backbone',
    'backbone.localStorage': 'lib/backbone.localStorage-min'
  },
  shim: {
    underscore: {
      exports: "_"
    },
    backbone: {
      deps: ['underscore', 'jquery'],
      exports: 'Backbone'
    },
    'backbone.localStorage': {
      deps: ['backbone'],
      exports: 'Backbone'
    }
  }
}); 
```

该指南显示在不包含 Backbone 的其他模块中包含“backbone.localStorage”，因此我假设在 localStorage shim 中`deps: ['backbone']`或其中一个`exports: Backbone`确保包含 Backbone。

`undefined method: extend`但是，我在 Javascript 控制台中不断收到错误消息

我正在启动其他模块，如下所示：

`define(['underscore','backbone.localStorage'], function(_, Backbone) {`

如何在 RequireJS 中同时包含 Backbone 和 Backbone.localStorage？

这是我第一次使用 Backbone 或 RequireJS，所以如果我的问题很明显，我深表歉意......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:42:38.297

这是我的咖啡脚本版本：

```
shim:
 underscore:
  exports: "_"
 backbone:
  deps: ["underscore", "jquery"]
  exports: "Backbone"
 localStorage:
  deps: ["backbone"]

paths:
  backbone: "lib/backbone/backbone-min"
  underscore: "lib/underscore/underscore-min"
  localStorage: "lib/backbone.localStorage/backbone.localStorage" 
```

然后在一个模块中

```
define [
 "underscore"
 "backbone"
 "localStorage"
], (_, Backbone) -> 
```

本地存储基本上将自身附加到 Backbone 对象，因此 AMD 只需在其之前加载主干即可。

# xml - 我可以创建一个 XSD 架构，将属性放在特定的复杂类型上吗？

> ID：15691626
> 
> 赞同：0
> 
> 时间：2013-03-28T20:34:59.087
> 
> 标签：xml, xsd, xml-validation

我给了

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema
  targetNamespace="AdditionalAttribute.OtherXSD"
  xmlns:o="AdditionalAttribute.OtherXSD" 
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
>
  <xs:element name="Tag" type="o:TagType" />
  <xs:complexType name="TagType" />
</xs:schema> 
```

我想写

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema
  targetNamespace="AdditionalAttribute.MyXSD" 
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
>
  <!-- ? -->
</xs:schema> 
```

所以这成为有效的 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<o:Tag
  xmlns:o="AdditionalAttribute.OtherXSD"
  xmlns:m="AdditionalAttribute.MyXSD"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
    AdditionalAttribute.OtherXSD AdditionalAttribute.OtherXSD.xsd 
    AdditionalAttribute.MyXSD AdditionalAttribute.MyXSD.xsd
  "
  m:AdditionalAttribute="Value"
/> 
```

我知道一个[类似的问题，询问如何](https://stackoverflow.com/questions/932371/can-i-create-an-xsd-schema-that-places-an-attribute-on-all-complex-types)在另一个 XSD 中为所有复杂类型放置一个附加属性。答案是否定的。但是，我不是这方面的专家，从那里的答案中我无法推断出特定复杂类型是否可能。我尝试了几件事但没有成功，似乎这只能通过 xsd:extension'ing 或 xsd:restriction'ing 复杂类型来实现，从而派生出一个新类型，这不是我想要的。我想在同一个标​​签上“合并”属性：

```
 <o:Tag o:...=...           />
+ <o:Tag           m:...=... />
= <o:Tag o:...=... m:...=... /> 
```

这可能吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:37:56.493

```
<?xml version="1.0" encoding="utf-8"?>
<xs:schema xmlns:o="AdditionalAttribute.OtherXSD" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:m="AdditionalAttribute.MyXSD" attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="AdditionalAttribute.OtherXSD" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="AdditionalAttribute.MyXSD" />
  <xs:element name="Tag">
    <xs:complexType>
      <xs:attribute ref="m:AdditionalAttribute" use="required" />
    </xs:complexType>
  </xs:element>
</xs:schema> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-13T17:36:04.067

我认为您的问题是您试图在 XML Schema 中一些故意施加的约束之外进行操作。

*   标记由限定名称 ( QName ) 标识，该名称由名称和命名空间组成。
*   标签的类型定义了其允许的内容

您所提议的将为“标签”添加一个新属性，从而为 XSD 模型的*某些*消费者更改其类型。

话虽如此，只要您愿意将 xsi:type 属性添加到 XML，您就可以做您想做的事。鉴于 o:TagType 是一个空类型，您不妨这样做：

```
<m:Tag xsi:type="m:TagWithAttribute" m:additionalAttribute="Value" /> 
```

*   使 o:TagType 成为抽象类型
*   使用 xs:extension 创建基于 o:TagType 的新类型 'm:TagWithAttribute'

通过添加 xsi:type 属性，模式验证器可以将您对“标签”的使用与其他希望对其进行不同验证的人区分开来。换句话说，XML Schema 正在强制执行强类型（xs:redefines 绕过了强类型，这就是为什么有些人不喜欢它）。

# c# - 将 blob 上传到 windows azure 时指定特定地址

> ID：15691630
> 
> 赞同：0
> 
> 时间：2013-03-28T20:35:09.273
> 
> 标签：c#, azure-storage, azure-blob-storage

我正在使用.Net。将 blob 上传到窗口天蓝色存储时，是否可以为 blob 指定特定地址？

因为我想在文件完成上传之前获得文件的链接。我不在乎链接是否不起作用，我只想先拥有链接。

我听说这是可能的，但我找不到任何参考。有人告诉我生成文件标识符，然后使用该标识符上传文件。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:53:37.433

我直接从 windowsazure.com 上的指南得到了这个答案。这是 google 中短语“将文件上传到 azure blob 存储”的第一名结果。

我相信在该`GetBlockBlobReference`方法中，您可以将“myblob”替换为您想要的 blob 文件名。

```
// Retrieve storage account from connection string.
CloudStorageAccount storageAccount = CloudStorageAccount.Parse(
    CloudConfigurationManager.GetSetting("StorageConnectionString"));

// Create the blob client.
CloudBlobClient blobClient = storageAccount.CreateCloudBlobClient();

// Retrieve reference to a previously created container.
CloudBlobContainer container = blobClient.GetContainerReference("mycontainer");

// Retrieve reference to a blob named "myblob".
CloudBlockBlob blockBlob = container.GetBlockBlobReference("myblob");

// Create or overwrite the "myblob" blob with contents from a local file.
using (var fileStream = System.IO.File.OpenRead(@"path\myfile"))
{
    blockBlob.UploadFromStream(fileStream);
} 
```

# trigger.io - Trigger.io 使用 forge.tabs.openWithOptions 时显示加载图像

> ID：15691631
> 
> 赞同：2
> 
> 时间：2013-03-28T20:35:14.397
> 
> 标签：trigger.io

将 forge.tabs.openWithOptions 与远程 url 一起使用时，有什么方法可以显示任何视图或加载图像？因为它给了我白色的空白页，直到加载了 url ??

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T16:03:18.610

简短的回答：没有。

但是，您不能只是“修改”您的远程页面吗？例如，也许您可​​以将内容“精简”为仅“加载”图像......但在后台加载您的内容？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-06T06:50:36.907

您可以简单地将模块添加到您的应用程序中，并在其配置中指定要显示的图像位置

希望能帮助到你

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-08-23T05:15:59.867

使用启动图像模块

通过此链接 [https://trigger.io/modules/launchimage/current/docs/index.html](https://trigger.io/modules/launchimage/current/docs/index.html)

希望能帮助到你

# django - 无法使用 Haystack 2.0 导入名称站点

> ID：15691633
> 
> 赞同：1
> 
> 时间：2013-03-28T20:35:21.903
> 
> 标签：django, django-haystack

我刚刚更新到 Haystack 版本 2，并且在尝试执行以前使用 1.7.2 的搜索时收到 ImportError。

`cannot import name site`

追溯：

```
Traceback:
File "/Users/nb/Desktop/myenv2/lib/python2.7/site-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/Users/nb/Desktop/nutmegstore/apps/haystack/views.py" in __call__
  45\.         self.form = self.build_form()
File "/Users/nb/Desktop/nutmegstore/apps/haystack/views.py" in build_form
  72\.         return self.form_class(data, **kwargs)
File "/Users/nb/Desktop/nutmegstore/apps/haystack/forms.py" in __init__
  90\.         self.fields['models'] = forms.MultipleChoiceField(choices=model_choices(), required=False, label=_('Search In'), widget=forms.CheckboxSelectMultiple)
File "/Users/nb/Desktop/nutmegstore/apps/haystack/forms.py" in model_choices
  12\.     choices = [("%s.%s" % (m._meta.app_label, m._meta.module_name), capfirst(smart_unicode(m._meta.verbose_name_plural))) for m in connections[using].get_unified_index().get_indexed_models()]
File "/Users/nb/Desktop/nutmegstore/apps/haystack/utils/loading.py" in get_indexed_models
  268\.             self.build()
File "/Users/nb/Desktop/nutmegstore/apps/haystack/utils/loading.py" in build
  197\.             indexes = self.collect_indexes()
File "/Users/nb/Desktop/nutmegstore/apps/haystack/utils/loading.py" in collect_indexes
  166\.                 search_index_module = importlib.import_module("%s.search_indexes" % app)
File "/Users/nb/Desktop/myenv2/lib/python2.7/site-packages/django/utils/importlib.py" in import_module
  35\.     __import__(name)
File "/Users/nb/Desktop/nutmegstore/nutmegmodels/search_indexes.py" in <module>
  3\. from haystack import site

Exception Type: ImportError at /search/
Exception Value: cannot import name site 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:37:09.757

是的，这是因为在 Haystack 的 2.0 版本中删除了 haystack.site。Haystack API 在这个新版本中发生了一些重大变化，目前还没有稳定发布。使用 1.2.7 仍然是 Django 和基于文档的搜索引擎的特色版本。

您可以在此处阅读有关如何将 1.x 版本迁移到 2.x的[整个文档](http://django-haystack.readthedocs.org/en/latest/migration_from_1_to_2.html)

希望能帮助到你！:)

# c# - 当前上下文中不存在该名称

> ID：15691635
> 
> 赞同：0
> 
> 时间：2013-03-28T20:35:31.207
> 
> 标签：c#, scope, instance

我在我的应用程序中创建了一个方法，它在运行时创建了许多面板。在创建面板的循环中，我创建了一个面板 MouseMove 事件，该事件根据鼠标指针在所创建的任何一个面板中的位置来控制工具提示的位置。

我在编译时遇到了这个错误，我很欣赏这`pnlOverview`是在不同的构造函数中创建的，但是对于我来说，我无法理解如何`pnlOverview`从事件处理程序中访问实例。

谁能指出我正确的方向？

这只是我认为您需要查看的代码：

```
 public void CreatePanels()
    {
        int PanelPosX = 50;
        int PanelPosY = 500;
        int LabelPosX = 10;
        int LabelPosY = 10;

        for (int i = 0; i < (Convert.ToInt32(txtNoOfPanels.Text)); i++)
        {
            // Create a new panel, each with a unique label identifying the inspector

            Panel pnlOverview = new Panel();
            pnlOverview.Name = "InspectorPanel" + (i + 1).ToString();
            pnlOverview.Text = "Inspector Panel " + (i+1).ToString();
            pnlOverview.Location = new Point(PanelPosX, PanelPosY);
            pnlOverview.Size = new Size(1200, 180);
            pnlOverview.BorderStyle = System.Windows.Forms.BorderStyle.FixedSingle;
            Controls.Add(pnlOverview);
            pnlOverview.Paint += new PaintEventHandler(newPanelPaint);

            // Create a MouseMove event for each panel created
            pnlOverview.MouseMove += new MouseEventHandler(pnlOverview_OnMouseMove);

            Label lblInspectorName = new Label();
            lblInspectorName.Name = "InspectorName" + (i+1).ToString();
            lblInspectorName.Text = " Inspector " + (i+1).ToString();
            lblInspectorName.Width = 100;
            lblInspectorName.Height = 13;
            lblInspectorName.Location = new Point(LabelPosX, LabelPosY);
            lblInspectorName.Size = new Size(82, 13);
            pnlOverview.Controls.Add(lblInspectorName);

            PanelPosY += 190;
        }
        return;
    }

    // Show a tooltip
    public void pnlOverview_OnMouseMove(object sender, MouseEventArgs e)
    {
        toolTip1.Show("HELLO", this, new Point(pnlOverview.Left + e.X + 1, pnlOverview.Top + e.Y + 1), int.MaxValue);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:42:49.570

`pnlOverview`不会在 MouseMove 处理程序的范围内，因为它是 CreatePanels() 中的局部变量。

`sender`应该是您鼠标移动的控件，但您需要将其转换为适当的类型。

# java - 带有 java.lang.noclassdeffounderror 的线程“main”中的异常

> ID：15691650
> 
> 赞同：0
> 
> 时间：2013-03-28T20:36:36.307
> 
> 标签：java, exception, noclassdeffounderror

它说 exeption it thread "main" java.lang.noclassdeffounderror: 后面跟着 13 行“at java”。

我尝试了最常见的方法来解决这个错误，我对 java 完全陌生，这让我发疯了！它非常令人沮丧。:(我将“类路径”环境变量更改为“。”并将正确的路径（C：\ Program Files \ Java \ jdk1.7.0_17 \ bin）也复制到“路径”变量中。我不认为它是.我什至在另一台计算机上尝试了完全相同的结果（在我更改了环境变量之后）。我从“fordummies”网站下载了代码，所以我不认为它的代码不好......我花了最后 4 个小时研究这个，我想是时候向专家寻求建议了 :) :)

```
// This program prompts for information about a loan and
// computes the monthly loan payment.

import java.util.*;   // for Scanner

public class Mortgage {
    public static void main(String[] args) {
        Scanner console = new Scanner(System.in);

        // obtain values
        System.out.println("This program computes monthly " +
                           "loan payments.");
        System.out.print("loan amount     : ");
        double loan = console.nextDouble();
        System.out.print("number of years : ");
        int years = console.nextInt();
        System.out.print("interest rate   : ");
        double rate = console.nextDouble();
        System.out.println();

        // compute result and report
        int n = 12 * years;
        double c = rate / 12.0 / 100.0;
        double payment = loan * c * Math.pow(1 + c, n) /
                         (Math.pow(1 + c, n) - 1);
        System.out.println("payment = $" + (int) payment);
    }
} 
```

错误是：

```
at java.net.URLClassLoader$1.run(Unknown Source)
    at java.net.URLClassLoader$1.run(unknown Source)
    at java.security.AccessController.DoPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at sun.launcher.LauncherHelper.checkAndLoadMain(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T22:46:51.160

请注意，Java 区分大小写，包括在命令行中使用的参数。我的猜测是你正在错误地运行你的程序

> java抵押贷款

由于您的班级名称是`Mortgage`，因此您*必须*使用相同的大小写：

> java抵押

请注意，`java`程序需要包含该`main()`方法的类的名称。因此，大写必须与您在代码中声明的内容相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T23:48:11.093

我不知道这是否是问题，但值得一试。

首先（这是我不确定的）我认为而不是：

> 公共静态无效主要（字符串 [] 参数）

我认为你应该有：

```
public static void main(String args[]){} 
```

* * *

另一件事是，如果您将程序制作为 Jar 文件，请确保您拥有 manifest.txt 文件。[有关 Jar 清单文件的一些信息。](http://docs.oracle.com/javase/tutorial/deployment/jar/manifestindex.html)

# android - Android WebView 清除基本身份验证凭据

> ID：15691651
> 
> 赞同：4
> 
> 时间：2013-03-28T20:36:49.763
> 
> 标签：android, caching, webview, basic-authentication, webviewclient

我制作了一个使用基本身份验证向服务器进行身份验证的应用程序。但是我无法清除凭据，因此这意味着我有两个未解决的问题：

*   用户在不退出程序的情况下无法注销
*   如果用户输入的凭据错误，他们必须退出并重新进入程序

我自己尝试了很多不同的实现，并且在这个网站上推荐了很多。我在 freenode 上露营 #android-dev 无济于事。所以这是我最后的选择。

这是我的 WebView 示例代码（我取出了一些东西，但主要代码基本相同）：

```
 wv = new WebView(getBaseContext());
    wv.setWebViewClient(new WebViewClient() {
        boolean error = false;
        int count = 0;
        int checked = 0;

        @Override
        public void onReceivedHttpAuthRequest(WebView view, HttpAuthHandler handler, String host, String realm) {
            count++;
            if (count >= 3) {
                Toast.makeText(getBaseContext(), "Login Failed. Please Try Again.", Toast.LENGTH_LONG).show();

            } else {
                handler.proceed(getUser(), getPass());
            }// end else
        }// end onReceivedHttpAuthRequest

        @Override
        public void onPageStarted(WebView view, String url, Bitmap favicon) {

        }// onPageStarted

        // on success switch activities
        @Override
        public void onPageFinished(WebView view, String url) {

            if (view.getTitle().equalsIgnoreCase("fooTitle")) {

                // switch activities
                Intent fooActivity = new Intent(getBaseContext(), fooActivity.class);
                startActivity(fooActivity);
            } else {
                //failed
            }// end else
        }// end onPageFinished
    });// end setWebViewCleint

    wv.getSettings().setJavaScriptEnabled(true);
    wv.loadUrl(url); 
```

只有在我第一次运行它时它才会运行 onReceivedHttpAuthRequest。如果我注销并重新登录，它将使用以前的凭据运行 onPageStarted 然后 onPageFinished。因此，如果我注销并输入新用户，我将使用原始用户重新登录。或者，如果我输入了错误的用户名和密码，它只会挂在 OnPageStarted 上。我试过使用 onReceivedError 和 http 错误之一也没有任何好处。

这是我尝试使用 logout() 方法以及代码的其他部分中的一些代码。我也尝试了许多不同的变体：

```
 wv.clearCache(true);
    wv.setHttpAuthUsernamePassword(host, realm, "","");
    clearCacheFolder(this.getCacheDir());
    clearCacheFolder(this.getExternalCacheDir());
    this.getBaseContext().deleteDatabase("webview.db");
    this.getBaseContext().deleteDatabase("webviewCache.db");
    WebViewDatabase.getInstance(getBaseContext()).clearHttpAuthUsernamePassword();
    WebViewDatabase.getInstance(getBaseContext()).clearUsernamePassword();
    WebViewDatabase.getInstance(getBaseContext()).clearFormData();
    WebStorage.getInstance().deleteAllData();
    wv.setHttpAuthUsernamePassword(host, realm,
    username, password); 
```

ClearCacheFolder 指的是这里贴出的方法markjan：[Android Webview - Completely Clear the Cache](https://stackoverflow.com/questions/2465432/android-webview-completely-clear-the-cache)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:39:24.033

尝试这个：

```
 CookieSyncManager.createInstance(this);
    CookieManager cookieManager = CookieManager.getInstance();
    cookieManager.removeAllCookie(); 
```

我在 VKontakte 登录活动中使用它来清除 webview 中保存的用户名/密码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-30T10:57:59.213

```
@Override
public void onReceivedHttpAuthRequest(WebView view, HttpAuthHandler handler, String host, String realm) {
    count++;
    if (count >= 3) {
    handler.cancel();// after adding this line of code my
                     //problem is solved. Hope it will for you too.

    Toast.makeText(getBaseContext(), "Login Failed. Please Try Again.", Toast.LENGTH_LONG).show();

    } else {
        handler.proceed(getUser(), getPass());
        }// end else
    } 
```

# html - 为什么我的 ul 列表有很大的差距？

> ID：15691655
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:36:55.703
> 
> 标签：html, css

我正在尝试整理 html 列表样式，但我不知道为什么会这样。

所以请看这里：[http ://www.gamingonlinux.com/articles/fester-mudd-adventure-game-released-for-linux.1871](http://www.gamingonlinux.com/articles/fester-mudd-adventure-game-released-for-linux.1871)

我的 UL html 列表似乎在它们之上有一个巨大的差距，我该如何删除它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:39:30.007

设置以下样式：

```
ul{
margin: 0;
padding: 0;
} 
```

您的浏览器默认添加 UL 边距 - 您需要重置默认浏览器`CSS`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:39:47.787

通过添加`margin:0`到您的`.content-list`规则声明。

顺便说一句，你不能有一个`<br />`in`<ul>`标签。这是无效的标记

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T20:40:22.537

那是因为默认情况下，`ul`s 有一个`margin-top`of `40px`（在 Chrome 中，不同的浏览器会有所不同）。设置`margin: 0px`你的`ul`，这将解决它：

```
ul {
    margin: 0px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T20:40:11.757

如果您在浏览器开发人员工具中特别是在 chrome 中检查元素，则您的 UL 内容列表的边距为 14，侧面工具指标将显示您的间距值。只需设置边距：0px; 对于那种 UL 风格，这种差距将会消失。

# python - cPickle 下溢错误

> ID：15691657
> 
> 赞同：2
> 
> 时间：2013-03-28T20:36:57.620
> 
> 标签：python, file-io, pickle

我正在尝试使用 cPickle 加载文件，如下所示，

```
import cPickle

cPickle.load(open('test', 'rb')) 
```

但是，我收到此错误，

```
---------------------------------------------------------------------------
UnpicklingError                           Traceback (most recent call last)
<ipython-input-527-1b7653ff1917> in <module>()
----> 1 cPickle.load(open('test', 'rb'))

UnpicklingError: unpickling stack underflow 
```

有时它会发出这个错误

```
UnpicklingError: could not find MARK 
```

我得到这个有什么理由吗？

PS：cPickle 不能与我一起处理任何文件，即使是新创建的只包含两个单词的文件。我正在使用 ubuntu 12.04 和 Python 64bit

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2016-02-23T21:24:48.270

试试这个它为我修复了错误：

```
import pickle
import pandas as pd

# read in csv file to pandas dataframe and save as pickle file
training_data = pd.read_csv('train.csv')
pickle_out = open('train.pkl', 'wb')
pickle.dump(training_data, pickle_out)
pickle_out.close() 

# open pickle file
file = 'train.pkl'
with open(file, 'rb') as f:
    training_data = pickle.load(f) 
```

# php - PHP 输出样式

> ID：15691659
> 
> 赞同：0
> 
> 时间：2013-03-28T20:37:09.157
> 
> 标签：php, styling

我有这个 php 输出

```
<?=($event ['Field'])?>: 

<?=($event['Value'])?> 
```

如果我用 div 将其包围，则线接缝会断开，从而使这两个输出出现在文档上的不同行上。

如何在不影响值定位的情况下使字段变粗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:39:58.183

使用跨度（连同相关的 CSS）：

```
<span class="field-name"><?= $event['Field'] ?></span>:
<?= $event['Value'] ?> 
```

`div`s 有一个隐含的`display: block`，这可以防止它们与文本一起流动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:42:12.210

或者要么为这些 div 定义类，所以让它们在 CSS 中浮动在同一行

# google-app-engine - 如何将 NDB 搜索索引与数据存储同步

> ID：15691671
> 
> 赞同：0
> 
> 时间：2013-03-28T20:37:51.900
> 
> 标签：google-app-engine, app-engine-ndb

当我最初为我们的数据存储编写`delete`方法时，我搞砸了，忘记从`search.Index`. 现在我发现搜索结果已恢复`doc_ids`，但数据存储中没有关联数据。

我想遍历所有索引文档并删除那些没有关联数据的文档。

我想我可以做这样的事情：

```
docs = videos.Index.search('').results
doc_ids = [x.doc_id for x in docs]
keys = [ndb.Key(urlsafe=x) for x in doc_ids]
entities = [key.get() for key in keys]

nones = []
for idx, i, in enumerate(entities):
  if i == None: nones.append(idx)

for i in nones:
  videos.Index.delete(doc_ids[i]) 
```

我想知道是否有一种`sync`方法或我缺少的东西？这`videos.Index.search('')`也绝对不正确，因为我认为它在实体上匹配的任何字段都会多次返回同一个实体。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T23:02:55.787

您可以使用 Index.get_range 来迭代索引文档，而不是使用 Index.search。更多信息在这里：

[https://developers.google.com/appengine/docs/python/search/indexclass#Index_get_range](https://developers.google.com/appengine/docs/python/search/indexclass#Index_get_range)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:27:41.240

从编程的角度来看，当您知道事情不同步时，确保一切同步的最简单方法（除非您知道事情不同步，否则我不建议这样做）是删除所有文档，然后重新放置它们与数据存储中当前的内容。您可以对文档执行 list puts，就像数据存储一样，这将使此过程更加高效。这是保证同步的最佳方式。

如果您忘记删除一些文档，这可能意味着您忘记更新一些文档以及数据存储更新，这就是我推荐这个的原因......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-05T05:59:34.017

在我的数据存储中，我可以使用 docId 检索相关数据。我正在使用类似下面的代码来完成检查所有搜索索引条目并删除不必要的任务的任务：

```
docIndex = search.Index(name=[your_index_name])
docIds = [d.doc_id for d in docIndex.get_range(limit=200, ids_only=True)]
for docId in docIds:
    if !:# Check if docId refers to valid data
        docIndex.delete(docId) 
```

如果搜索索引中有超过 200 个条目，则必须迭代 get_range 调用，将最后一个 doc_id 作为 start_id 参数传递给下一个调用。

# c# - 从 csv 文件中获取数据到字典中

> ID：15691672
> 
> 赞同：0
> 
> 时间：2013-03-28T20:37:55.783
> 
> 标签：c#, excel, csv

我正在尝试从此文件（indexes.csv）中获取信息：

![在此处输入图像描述](../Images/c075c2eae682fb5d7e5331600e735cda.png)

进入这个类的一个实例：

```
class Table
{
    Dictionary<String, double> _regionTimeValues;
    String _region;

    public Table(String region)
    {
        _regionTimeValues = new Dictionary<string, double>();
        _region = region;
        suckInValues();
    }

    private void suckInValues()
    {
        //Go find File, get the appropriate Values for _region
        //add each value found in the csv file that applies, indexed by yearQuarter
        //Example: _regionTimeValues.Add("2013Q1", 1.1 );
    }

    internal double locateRelevantValue(string yearQuarter)
    {
        double locatedValue = 0.0;
        _regionTimeValues.TryGetValue(yearQuarter,out locatedValue);
        return locatedValue;
    } 
```

我只想用特定区域的数据填充字典。

如何从 csv 文件执行此操作？

**编辑**

区域的示例是字符串值，例如“Dalton”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:00:31.063

我想你想要这样的东西......

```
public class Table
{
    private Dictionary<string, double> _regionTimeValues = new Dictionary<string, double>();
    private String _region;

    public Table(String region)
    {
        _region = region;
    }

    public void AddValue(string key, double value)
    {
        _regionTimeValues.Add(key, value);
    }
}

public class Program
{
    static void Main(string[] args)
    {
        Dictionary<string, Table> tables = new Dictionary<string, Table>();

        using (var reader = new StreamReader("Data.csv"))
        {
            // First line contains column names.
            var columnNames = reader.ReadLine().Split(',');
            for(int i = 1; i < columnNames.Length; ++i)
            {
                var columnName = columnNames[i];
                tables.Add(columnName, new Table(columnName));
            }

            var line = reader.ReadLine();
            while (line != null)
            {
                var columns = line.Split(',');

                for (int i = 1; i < columns.Length; ++i)
                {
                    var table = tables[columnNames[i]];
                    table.AddValue(columns[0], double.Parse(columns[i]));
                }

                line = reader.ReadLine();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:53:41.837

首先，您将阅读标题并获取包含您所在区域的列的索引。然后你必须读取每一行并用'，'分割行，然后读取索引以获得你的值。您还可以通过搜索拆分记录的第一个索引将 yr\qrt 应用于它。

# python - 对字典中的值执行标准偏差

> ID：15691677
> 
> 赞同：3
> 
> 时间：2013-03-28T20:38:18.677
> 
> 标签：python, dictionary, python-2.7, numpy

我正在使用 Numpy 和 Python2.7，并且我正在编写一个函数，该函数计算在我读入图像时每列像素出现颜色的次数（使用 PIL）：

```
for i in range(wbmp.size[0]):
    bcount = 0
    for j in range(wbmp.size[1]):
        if wbmp.getpixel((i,j)) == 1:
            bcount = bcount + 1
    bdict[i] = bcount 
```

字典返回为`{Column#: # of times color appears}`，我希望能够对字典中的所有值执行标准偏差。我需要先将它们全部放入列表中吗？或者是否可以从字典中提取它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T20:44:25.763

可以使用 获取字典中所有值的列表`bdict.values()`，因此您可以使用以下命令：

```
std = np.std(bdict.values()) 
```

一种更快的方法是使用更多的 numpy：

```
img = np.array(img)
colour_mask = img == 1  # or whichever colour you want
per_col_count = colour_mask.sum(axis=0)
std = np.std(per_col_count) 
```

`colour_mask`是一个布尔掩码，沿轴 0 对其求和，将`True`每列的所有值相加。这势必会快很多，而且差异会随着图像的大小而增加。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T20:44:32.430

你的字典已经有了你想要的列表，

```
bdict.values() 
```

所以你可以调用`std`这个：

```
np.std(bdict.values()) 
```

但我建议立即将您的图像转换为 numpy 数组，并沿一个轴制作直方图，而不是使用您的计数版本。

```
from PIL import Image
i = Image.open('imfile.png')
a = np.array(i)
c = 1   # or whatever color you want
b = 256 # bit depth of image, so histogram bins are 1 color / bin

hists = np.array([ np.histogram(row, bins=b)[0] for row in a ])
s = hists[:,c].std() 
```

# database - 如何使用 _-leading 列正确查询 SQLite？

> ID：15691678
> 
> 赞同：0
> 
> 时间：2013-03-28T20:38:18.973
> 
> 标签：database, sqlite, select

给定以下 SQLite 查询，

```
SELECT _id, last_name, first_name_pref, title
FROM People 
```

SQLite 将只返回 _id 列。

这有两件事：首先，如果我进一步向下*移动* 序列，我将取回它以及它左侧列出的所有内容。（意思是，如果...，那么它将返回,和-- 但不是。）`_id``SELECT``SELECT last_name, first_name_pref, _id, title``last_name``first_name_pref``_id``title`

但是，如果我将查询修改为 alias `_id AS id`，我会按预期返回 _id、last_name、first_name 和 title 列。

这里发生了什么？

如果有帮助，这里是数据库模式：

```
CREATE TABLE "People" (
"_id" INTEGER,
"first_name_pref" TEXT,
"last_name" TEXT,
"adds" TEXT,
"department" INTEGER REFERENCES "Departments._id"(""),
"title" TEXT,
"email_address" TEXT,
"phone" TEXT,
"office_1" INTEGER REFERENCES "Offices._id"(""),
"office_2" INTEGER REFERENCES "Offices._id"(""),
"office_3" INTEGER REFERENCES "Offices._id"(""),
"office_4" INTEGER REFERENCES "Offices._id"(""),
"address_1" TEXT,
"address_2" TEXT,
"city" TEXT,
"state" TEXT,
"zip" INTEGER,
-- more columns...
"photo" BLOB,
"specialty_area_1" INTEGER REFERENCES "SpecialtyAreas._id"(""),
"specialty_area_2" INTEGER REFERENCES "SpecialtyAreas._id"(""),
"specialty_area_3" INTEGER REFERENCES "SpecialtyAreas._id"(""),
"specialty_area_4" INTEGER REFERENCES "SpecialtyAreas._id"(""),
"parking_info" TEXT
); 
```

# java - AsyncTask 语法错误

> ID：15691679
> 
> 赞同：1
> 
> 时间：2013-03-28T20:38:20.940
> 
> 标签：java, android, http, android-asynctask

我不知道我做错了什么 - 但是在组合我拥有的两个不同文件的源代码并实现 AsyncTask 之后，我在编译以下代码时遇到了几个问题。任何关于可能导致这些问题的建议（作为一种学习经验）以及解决这些问题的方法是否不太复杂，我们都将不胜感激。

（提前致谢！）

问题：

说明 资源路径 位置 类型

```
The nested type AddEditCountry cannot hide an enclosing type    AddEditCountry.java /Game Demo/src/com/nfc/gamedemo line 159    Java Problem
Syntax error, insert "AssignmentOperator Expression" to complete Expression AddEditCountry.java /Game Demo/src/com/nfc/gamedemo line 153    Java Problem
The left-hand side of an assignment must be a variable  AddEditCountry.java /Game Demo/src/com/nfc/gamedemo line 153    Java Problem 
```

附言

在几个用户的帮助下，我已经能够提出下面的源代码，但是我仍然有几个问题（如下所列）和数据字符串： [http://gamedemo.hostzi.com/apply.cgi?submit_button=Wireless_MAC&change_action=&action=Apply&wl_macmode=allow&wl_maclist=32&wait_time=3&wl_mac_filter=1&start=&wl_macmode1=allow&m0=00%3A1E%3A33%3AFE%3A0D%3A38&m16=00%3A00% 3A00%3A00%3A00%3A00&m1=00%3A00%3A00%3A00%3A00%3A00&m17=00%3A00%3A00%3A00%3A00%3A00&m2=00%3A00%3A00%3A00%3A00%3A00&m3A08=00%3A00% 3A00%3A00%3A00&m3=00%3A00%3A00%3A00%3A00%3A00&m19=00%3A00%3A00%3A00%3A00%3A00&m4=00%3A00%3A00%3A00%3A00%3A00&m20=00%3A00%3A00% 3A00%3A00&m5=00%3A00%3A00%3A00%3A00%3A00&m21=00%3A00%3A00%3A00%3A00%3A00&m6=00%3A00%3A00%3A00%3A00%3A00&m22=00%3A00%3A00%3A00% 3A00&m7=00%3A00%3A00%3A00%3A00%3A00&m23=00%3A00%3A00%3A00%3A00%3A00&m8=00%3A00%3A00%3A00%3A00%3A00&m24=00%3A00%3A00%3A00%3A00%3A00%3A00%m9=00%3A00%3A00%3A00%3A00%3A00&m25=00%3A00%3A00%3A00%3A00%3A00&m10=00%3A00%3A00%3A00%3A00%3A00&m26=00%3A00%3A00%3A00%3A00%3A00=m 00%3A00%3A00%3A00%3A00%3A00&m27=00%3A00%3A00%3A00%3A00%3A00&m12=00%3A00%3A00%3A00%3A00%3A00&m28=00%3A00%3A00%3A00%3A00%3A00&1 3A00%3A00%3A00%3A00%3A00&m29=00%3A00%3A00%3A00%3A00%3A00&m14=00%3A00%3A00%3A00%3A00%3A00&m30=00%3A00%3A00%3A00%3A00%3A00&m15= 3A00%3A00%3A00%3A00&m31=00%3A00%3A00%3A00%3A00%3A00&end=m14=00%3A00%3A00%3A00%3A00%3A00&m30=00%3A00%3A00%3A00%3A00%3A00&m15=00%3A00%3A00%3A00%3A00%3A00&m31=00%3A00%3A00%3A00%3A00%3A0=m14=00%3A00%3A00%3A00%3A00%3A00&m30=00%3A00%3A00%3A00%3A00%3A00&m15=00%3A00%3A00%3A00%3A00%3A00&m31=00%3A00%3A00%3A00%3A00%3A0=](http://gamedemo.hostzi.com/apply.cgi?submit_button=Wireless_MAC&change_action=&action=Apply&wl_macmode=allow&wl_maclist=32&wait_time=3&wl_mac_filter=1&start=&wl_macmode1=allow&m0=00%3A1E%3A33%3AFE%3A0D%3A38&m16=00%3A00%3A00%3A00%3A00%3A00&m1=00%3A00%3A00%3A00%3A00%3A00&m17=00%3A00%3A00%3A00%3A00%3A00&m2=00%3A00%3A00%3A00%3A00%3A00&m18=00%3A00%3A00%3A00%3A00%3A00&m3=00%3A00%3A00%3A00%3A00%3A00&m19=00%3A00%3A00%3A00%3A00%3A00&m4=00%3A00%3A00%3A00%3A00%3A00&m20=00%3A00%3A00%3A00%3A00%3A00&m5=00%3A00%3A00%3A00%3A00%3A00&m21=00%3A00%3A00%3A00%3A00%3A00&m6=00%3A00%3A00%3A00%3A00%3A00&m22=00%3A00%3A00%3A00%3A00%3A00&m7=00%3A00%3A00%3A00%3A00%3A00&m23=00%3A00%3A00%3A00%3A00%3A00&m8=00%3A00%3A00%3A00%3A00%3A00&m24=00%3A00%3A00%3A00%3A00%3A00&m9=00%3A00%3A00%3A00%3A00%3A00&m25=00%3A00%3A00%3A00%3A00%3A00&m10=00%3A00%3A00%3A00%3A00%3A00&m26=00%3A00%3A00%3A00%3A00%3A00&m11=00%3A00%3A00%3A00%3A00%3A00&m27=00%3A00%3A00%3A00%3A00%3A00&m12=00%3A00%3A00%3A00%3A00%3A00&m28=00%3A00%3A00%3A00%3A00%3A00&m13=00%3A00%3A00%3A00%3A00%3A00&m29=00%3A00%3A00%3A00%3A00%3A00&m14=00%3A00%3A00%3A00%3A00%3A00&m30=00%3A00%3A00%3A00%3A00%3A00&m15=00%3A00%3A00%3A00%3A00%3A00&m31=00%3A00%3A00%3A00%3A00%3A00&end=)

...从来没有出现在服务器上（我正在检查日志 - 在应用程序中单击提交时没有任何变化，应该发送上面的字符串 - 如果我将该 URL 粘贴到浏览器中，它会成功运行）

另外-它从未出现在服务器上的原因可能是由于我必须先按空格才能单击提交，因为在单击提交之前需要文本框-我想我可能需要完全消除文本框（我根本不需要它 - 我只想发送预定义的数据字符串）但我不确定我是否知道如何在不破坏源代码的情况下这样做。

爪哇：

```
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

import android.app.Activity;
import android.opengl.Visibility;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.ProgressBar;
import android.widget.TextView;
import android.widget.Toast;

public class DeviceConfig extends Activity implements OnClickListener{

    private EditText value;
    private Button btn;
    private ProgressBar pb;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.deviceconfig);
        value=(EditText)findViewById(R.id.editText1);
        btn=(Button)findViewById(R.id.button1);
        pb=(ProgressBar)findViewById(R.id.progressBar1);
        pb.setVisibility(View.GONE);
        btn.setOnClickListener(this);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    public void onClick(View v) {
        // TODO Auto-generated method stub
            if(value.getText().toString().length()<1){

                // out of range
                Toast.makeText(this, "please enter something", Toast.LENGTH_LONG).show();
            }else{
                pb.setVisibility(View.VISIBLE);
                new MyAsyncTask().execute(value.getText().toString());      
            }

    } 

    private class MyAsyncTask extends AsyncTask<String, Integer, Double>{

        @Override
        protected Double doInBackground(String... params) {
            // TODO Auto-generated method stub
            postData(params[0]);
            return null;
        }

        protected void onPostExecute(Double result){
            pb.setVisibility(View.GONE);
            Toast.makeText(getApplicationContext(), "command sent", Toast.LENGTH_LONG).show();
        }
        protected void onProgressUpdate(Integer... progress){
            pb.setProgress(progress[0]);
        }

        public void postData(String valueIWantToSend) {
            // Create a new HttpClient and Post Header
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost("http://192.168.1.1/apply.cgi");

            try {
                // Add your data
                List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
                nameValuePairs.add(new BasicNameValuePair("myHttpData", valueIWantToSend));
                httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

                // Execute HTTP Post Request
                HttpResponse response = httpclient.execute(httppost);

            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
            } catch (IOException e) {
                // TODO Auto-generated catch block
            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T20:40:34.567

`new MyAsyncTask().execute` // 这是错误的

execute() 是方法

像这样打电话

```
new MyAsyncTask().execute(""); 
```

你的代码有很多错误。您已将代码放在 onCreate 之外

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:41:16.540

查看 new MyAsyncTask 之前的行：

```
 }{
     new MyAsyncTask().execute 
```

这弄乱了你所有的代码。在您的 IDE 中正确缩进（例如 eclipse 中的（CTRL-A I））。这将使此类问题更具可读性。

在 java 中：

```
* all statements (java instructions) must be inside methods.
* all methods inside classes. 
```

这是一个好的开始。;)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:56:37.460

似乎您在单击按钮时创建了 AddEditCountry 类！:) 重构将解决您的问题。

# javascript - 试图观察 javascript 对象

> ID：15691680
> 
> 赞同：3
> 
> 时间：2013-03-28T20:38:23.660
> 
> 标签：javascript, observer-pattern, callstack

我正在尝试在 javascript 中创建一个对象观察者。

这是据我所知：

```
//object to observe an object
        observe : {
            parent : this, //keep context of parent
            references : {}, //keep track of setted references
            originals : {}, // also for the originals
            callStack : 0, // trying to prevent the callstack

            // set an object to observe..
            setObject : function ( name, object ){
                this.references[name] = object;
                //app.utils.extendObject is a working object extending function.
                this.originals[name] = app.utils.extendObject( new Object , object );
                //start watching the object
                this.watchObject( name );
            },

            watchObject : function ( referenceName ){
                this.callStack++;
                //walk through reference
                for( prop in this.references[referenceName] ){
                    // if the reference differs from the original...
                    if( this.references[referenceName][prop] !== this.originals[referenceName][prop]  ){
                        //... log the differance
                        console.log( referenceName + " with property " + prop + " has changed." );
                    }
                }
                // set variable with call to this function
                var func = eval( "app.utils.observe.watchObject(" + referenceName + ")" );

                //read somewhere this could do the trick
                if( callStack == 1000 ){
                    setTimeout( func , 100 );
                }
                func();

            }

        } 
```

问题是调用堆栈错误，有没有更好的方法来观察这个？当然，我目前可以在 Chrome 中使用 Object.observe，但我想要一个跨浏览器的解决方案。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:00:00.820

我稍微修改了您的代码，`callback`为方法添加了功能`watchObject`。如果您想监听更改并执行一些操作，这很有用。

```
watchObject: function (referenceName, callback) {
    for (prop in this.references[referenceName]) {
        if (this.references[referenceName][prop] !== this.originals[referenceName][prop]) {
            console.log(referenceName + " with property " + prop + " has changed.");
            callback && callback.call(this.references[referenceName], this.originals[referenceName][prop], this.references[referenceName][prop]);
            this.originals[referenceName][prop] = this.references[referenceName][prop];
        }
    }
} 
```

另外我`setInterval`放在`setObject`：

```
var self = this;
setInterval(function() {
    self.watchObject(name, callback);
}, 300); 
```

[http://jsfiddle.net/59Fnt/1/](http://jsfiddle.net/59Fnt/1/)

# django - django查询集上的复杂注释

> ID：15691681
> 
> 赞同：2
> 
> 时间：2013-03-28T20:38:28.603
> 
> 标签：django, django-queryset

我有一个问题，我无法从`.annotate()`django 视图中的复杂调用中获得所需的所有信息。这是我的模型：

```
RECORD_STATUS = (
    (0, "Hidden"),
    (1, "Unhidden"),
    (2, "Deleted"),
)
class Activity(models.Model):
    event_date = models.DateTimeField()
    duration = models.IntegerField(default=0)
    username = models.CharField(max_length=200)
    record_id = models.CharField(max_length=100)
    record_status = models.IntegerField(choices=RECORD_STATUS)
    record_quality = models.FloatField(default=0) 
```

我想根据不同的 record_id 将以下值传递给我的视图模板：

*   平均质量
*   数数
*   最新事件_日期
*   总持续时间

和...

...最新状态（具有特定记录 ID 的最新 event_date 的活动状态）

使用以下查询集代码块，我已经能够按预期获得其中的大部分，但我无法获取特定`record_id`. 我倾向于相信一个`.extra()`电话可能是要走的路，但我似乎无法正确构建它。

```
record_id_details = Activity.objects.values(
    'record_id',
    ).annotate(
    ave_quality=Avg('record_quality'),
    count=Count('id'),
    latest_event_date=Max('event_date'),
    total_duration=Sum('duration'),
    # Here's where I'm going wrong
    # I need the record_statuses from the most recent Activities of each record_id
    latest_status=,# dont know... record_status WHERE Max(event_date) ???
).order_by(sort) 
```

任何关于注释参数的建议都会给我我需要的东西，或者可能会帮助构建额外的命令。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T07:09:01.470

没有使用 Django 查询集表达此查询的内置方法。在两个查询中执行它可能是纯粹使用 ORM 的最简单方法。如果您不介意一些原始 SQL，并且您正在使用支持它的数据库，例如 PostgreSQL，您需要的工具称为窗口函数，您可以在此处找到详细信息：[http://www.postgresguide .com/tips/window.html](http://www.postgresguide.com/tips/window.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T06:56:21.643

我将只执行第二个查询，以便我可以将所有这些分开。就像是：

```
latest = Activity.objects.filter(record_id="whatever_the_record_id_you_want").order_by("-event_date)
most_recent = latest[0]
what_you_asked_for = most_recent.record_status 
```

# netdna-api - 一次清除多个文件的语法？

> ID：15691684
> 
> 赞同：1
> 
> 时间：2013-03-28T20:38:51.853
> 
> 标签：netdna-api

我似乎通过使用 file=/common/filetopurge.js 一次清除一个文件，但是如果可能的话，如何在同一个 DELETE 请求中清除多个文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T18:22:58.673

@user2200550 如果您以数组形式发送文件，我们的 API 将并行清除所有文件。希望有帮助。如果不让我知道。

# ssis - SSIS：“'GO'附近的语法不正确。” 错误

> ID：15691692
> 
> 赞同：2
> 
> 时间：2013-03-28T20:39:23.090
> 
> 标签：ssis, sql-server-2012, ole

我在针对 SQL Server 2012 数据库运行的 Visual Studio 2012 中使用 SSIS。使用 OLE DB Source 时出现如下所示的错误。此 OLE DB 源正在执行类似于下面进一步显示的 SQL。当我最后删除 GO 语句时，SSIS 包执行正常。

在 SQL Server Management Studio 中，无论 GO 语句是否存在，SQL 都可以正常执行。

OLE DB 源正在数据流任务中执行。

为什么这个 GO 在 SSIS 包中执行时会导致这个错误，应该怎么做？非常感谢。

错误：

> [来自 SQL 变量 [33] 的 OLE DB 源] 错误：SSIS 错误代码 DTS_E_OLEDBERROR。发生 OLE DB 错误。错误代码：0x80040E14。OLE DB 记录可用。来源：“Microsoft SQL Server Native Client 11.0”Hresult：0x80040E14 描述：“无法准备语句。”。OLE DB 记录可用。来源：“Microsoft SQL Server Native Client 11.0”Hresult：0x80040E14 描述：“'GO' 附近的语法不正确。”。

SQL：

```
/* Test statement */
SELECT 'test' as N'test'
GO 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-28T20:43:18.880

`GO`是批处理终止符，如错误消息所示，在 OLE DB 源中使用它是不正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T20:44:09.057

你的 SQL 是：

```
SELECT 'test' as N'test'
GO 
```

`GO`是一个命令行的东西 - 使用 OLE 将 SQL 传递到服务器时将其删除。
试试这个：

```
SELECT 'test' as N'test' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-27T20:57:04.233

您应该从脚本中删除所有“GO”，它将解决问题。

查看此以获取更多信息：

[https://agilewebhosting.com/knowledgebase/63/SQL-Error-Incorrect-syntax-near-andsharp039GOandsharp039.html](https://agilewebhosting.com/knowledgebase/63/SQL-Error-Incorrect-syntax-near-andsharp039GOandsharp039.html)

矩阵

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-03-28T22:31:52.163

建议的最佳实践：使用分号作为 t-SQL 语句终止符。虽然在此版本的 SQL Server 中大多数语句不需要分号，但在未来的版本中将需要它。

```
http://msdn.microsoft.com/en-us/library/ms177563.aspx 
```

# algorithm - 功能语言中的等价类和联合/查找

> ID：15691696
> 
> 赞同：11
> 
> 时间：2013-03-28T20:39:37.460
> 
> 标签：algorithm, data-structures, functional-programming, union-find, equivalence-classes

对于自动机算法，我需要使用函数式语言的快速 Union-Find 数据结构。由于我需要正式证明数据结构的正确性，所以我更喜欢简单的结构。

我想要做的是计算一个集合中元素的等价`S`类`R ⊆ S × S`。最后我想得到的是一些函数`f: S → S`，它将任何元素映射`S`到其`R`-equivalence 类的（规范）代表。通过“规范”，我的意思是我不在乎它是哪个代表，只要它对于一个等价类的所有元素都是相同的，即我想`f x = f y ⟺ (x,y) ∈ R`持有。

函数式语言中最好的数据结构和算法是什么？我应该补充一点，我真的需要“正常”功能代码，即没有可变性/状态转换器单子。

编辑：与此同时，我想出了这个算法：

```
m := empty map
for each s ∈ S do
  if m s = None then
    for each t in {t | (s,t) ∈ R}
      m := m[t ↦ s] 
```

这将创建一个映射，将 的任何元素映射`S`到其等价类的代表，其中代表是迭代到达的第一个元素`S`。我认为这实际上具有线性时间（如果地图操作是恒定的）。但是，我仍然对其他解决方案感兴趣，因为我不知道这在实践中的效率如何。

（我的关系在内部表示为“S → (S Set) option”，因此在 {t | (s,t) ∈ R} 上的迭代 - 这是对该结构的廉价操作。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-28T21:46:38.597

AFAIK（并且快速搜索并没有让我感到厌烦），没有已知的具有可比渐近性能（摊销逆阿克曼函数）的传统[不相交集数据结构的纯函数等价物。](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)（传统的数据结构不是纯功能的，因为它需要破坏性更新来执行路径压缩）

如果您对功能纯度没有死心，您可以使用破坏性更新，并实现传统的数据结构。

如果您不关心匹配渐近性能，您可以用[持久关联映射](http://hackage.haskell.org/packages/archive/containers/0.5.0.0/doc/html/Data-Map.html)替换传统数据结构的随机访问数组，但代价是额外的 O(log N) 性能因子，并且需要验证其正确性。

如果您希望最大程度地简化验证目的，并且对上述任何一项都没有死机，您可以使用可更新数组*并*放弃按秩优化。IIRC 这会产生 O(log N) 摊销的最坏情况性能，但实际上可能会提高实际执行速度（因为不再需要存储或管理等级）。

# haskell - 如何避免在整个程序的 IO monad 中操作？

> ID：15691700
> 
> 赞同：6
> 
> 时间：2013-03-28T20:39:48.457
> 
> 标签：haskell, io

我正在使用 Gloss 库在 Haskell 中编写 Sokoban 程序，并且我已经达到了我想要的程度，当玩家通过关卡时，从文本文件加载新关卡并让程序继续.

由于 Gloss 的限制，我对此有点困难——`play`设置游戏并使其不断更新的功能如下所示：

```
play    :: forall world
        .  Display                      -- ^ Display mode.
        -> Color                        -- ^ Background color.
        -> Int                          -- ^ Number of simulation steps to take for each second of real time.
        -> world                        -- ^ The initial world.
        -> (world -> Picture)           -- ^ A function to convert the world a picture.
        -> (Event -> world -> world)    -- ^ A function to handle input events.
        -> (Float -> world -> world)    -- ^ A function to step the world one iteration.
                                        --   It is passed the period of time (in seconds) needing to be advanced.
        -> IO () 
```

[（直接从http://hackage.haskell.org/packages/archive/gloss/1.7.4.1/doc/html/Graphics-Gloss-Interface-Pure-Game.html](http://hackage.haskell.org/packages/archive/gloss/1.7.4.1/doc/html/Graphics-Gloss-Interface-Pure-Game.html)复制）

这是`world`我正在使用的类型：

```
data Game = Game
  { levelNumber  :: Int,
    currentLevel :: Level Square,
    won          :: Bool } 
```

其中`Level`s 包含当前关卡中的块。我正在`Game`使用类似这样的东西在 s 中阅读（实际上还没有制作一个通用的，但这基本上就是使用文件名参数的全部内容）：

```
startGame = do
  lvl <- readFile "levels/level001.lvl"
  let lvl' = parseLevel lvl
  return $ Game 1 lvl' False 
```

所以，我的困难是由于`play`. 如果我只是在单个级别上操作，我可以轻松地获取 a`Game`并生成 a `Picture`（和 a`Game`等），而无需从文件系统中读取任何数据，但是因为我在中间加载文件中的级别游戏，我不知道如何避免让我所有`Game`的s `IO Game`。也许在这种情况下这是不可能的，也许这是有充分理由的？我*将*始终对`Game`从文件中提取的内容进行操作，但我不知道在任何给定点是否可以避免，如果可以，我想避免它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T02:47:20.900

我最终使用了`playIO`来自[Graphics.Gloss.Interface.IO.Game](http://hackage.haskell.org/packages/archive/gloss/1.7.4.1/doc/html/Graphics-Gloss-Interface-IO-Game.html)的 Gloss 。我需要更改我的几个函数以对纯数据类型进行操作并将它们输出包装在`IO`monad 中。以下是我必须更改的类型：

```
worldToPicture :: World -> IO Picture
eventHandler   :: Event -> World -> IO Picture
stepWorld      :: Float -> World -> IO World 
```

在大多数情况下，这只会在`return`我当前存在的函数中添加一些 s，但最终会添加很多功能（例如即时保存、加载新关卡、使用 BMP 文件进行图形等）。`IO`由于新函数仍将纯数据类型作为参数，因此我还能够保留几乎所有当前存在的代码。它最终成为一个非常简单的重构并完美地解决了我的问题。

# php - 使用 jQuery 将错误实时发送到 PHP 页面

> ID：15691708
> 
> 赞同：0
> 
> 时间：2013-03-28T20:40:15.237
> 
> 标签：php, jquery

我在 php 中构建了一个表单，将输入值发送到 jQuery 页面，然后将信息发送到另一个 php 页面以将值插入到数据库中。

**问题是**

当出现错误时，假设用户名存在，我需要能够将消息从 php 页面发送回原始表单并实时显示。关于如何做到这一点的任何想法？

**这是处理从表单提交到插入数据库的 php 页面**的 jQuery 。****

 **```
// Handle account updates
$('#save_account').click(function() { 
    var log_token = $('#log_token').val();  
    var user_name = $('#user_name').val();  
    var user_pass = $('#user_pass').val();  
    $.post("php/includes/update_account.php", {
        log_token: log_token,
        user_name: user_name,
        user_pass: user_pass
    });
}); 
```

**这是将值插入数据库**的 PHP 。****

 **```
$log_token = $_POST['log_token'];
$user_name = $_POST['user_name'];
$user_pass = $_POST['user_pass'];

$db = db_open();
$query = "SELECT user_name FROM users WHERE user_name='$user_name'";
$result = db_query($db, $query);
$result = db_num_rows($result);
if (!$result) {
    $query = "UPDATE users SET user_name='$user_name', user_pass='$user_pass' 
        WHERE user_id='$_SESSION['user']['user_id']'";
    $result = db_query($db, $query);
} else {
    Pass Error to FORM HERE
}
db_close($db); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:42:11.640

看看 AJAX。这是一种无需刷新即可向页面发送数据和从页面发送数据的方法。实现这一点的最简单方法是使用[jQuery 的 ajax 方法](http://api.jquery.com/jQuery.ajax/)

您的代码几乎拥有它：

```
$('#save_account').click(function() { 
    var log_token = $('#log_token').val();  
    var user_name = $('#user_name').val();  
    var user_pass = $('#user_pass').val();  
    $.post("php/includes/update_account.php", {
        log_token: log_token,
        user_name: user_name,
        user_pass: user_pass
        }, function(data){
            // handle the response from the page here
            if(data != "") {
                alert(data);
            }
        }
    );
}); 
```

传递给 post 函数的匿名函数是一个回调函数，当从调用的脚本接收到响应时调用。变量数据包含来自页面的响应。

PHP

```
$log_token = $_POST['log_token'];
$user_name = $_POST['user_name'];
$user_pass = $_POST['user_pass'];

$db = db_open();
$query = "SELECT user_name FROM users WHERE user_name='$user_name'";
$result = db_query($db, $query);
$result = db_num_rows($result);
if (!$result) {
    $query = "UPDATE users SET user_name='$user_name', user_pass='$user_pass' 
        WHERE user_id='$_SESSION['user']['user_id']'";
    $result = db_query($db, $query);
} else {
    // return there was an error
    echo "There was an error";
}
db_close($db); 
```

你可以用它做更复杂的事情。您可以将一系列错误传递回页面。查看 JSON，了解如何以 JavaScript 可以轻松解析的方式发送消息****

# css - LESS 编译器和相关 @import 引用在 Web Essentials 2012 v2.7 中不起作用

> ID：15691713
> 
> 赞同：16
> 
> 时间：2013-03-28T20:40:29.983
> 
> 标签：css, visual-studio-2012, import, less, web-essentials

v2.6 的更新适用于 VS 2012，并且我安装了 Web Tools 2012.2 更新，但我注意到 v2.5.1 版本中不存在的一个问题（我现在降级修复）是 @import LESS 文件中的行在编译时不再定位引用的文件。

除非@import 行中引用的文件位于同一物理文件夹中，否则编译器会爆炸。如果存在任何路径信息，例如“../../style/common.less”，编译器会以错误响应并且不会创建生成的 CSS 文件。

我得到的错误是它找不到文件并且路径信息被截断为第一个父路径构造或没有。因此，它正在寻找“../style/common.less”或“style/common.less”。两者之间似乎是断断续续的。

有关可能相关的问题，请参阅：[LESS importing CSS and relative paths](https://stackoverflow.com/questions/12813400/less-importing-css-and-relative-paths)

**更新：** 确认预期行为在 LESS v1.3.1 及更低版本中正常工作。

我通过 Visual Studio 扩展更新对话框更新到 Web Essentials v2.6。然后我替换了路径*X:\Users\{USER}\AppData\Local\Microsoft\VisualStudio\11.0\Extensions\{HASH}\Resources\Scripts\less-1.3.0.js*中的 LESS 脚本文件的内容（这是 v1.3.3，最初是 Web Essentials v2.6 更新），包含 1.3.0、1.3.1、1.3.2、1.4.0-beta、1.4.0 和 1.4.1 版本的脚本。编译仅适用于 1.3.1 及更低版本。

我想知道在删除对 @import-once 的支持时是否有问题。

**更新 2：** Web Essentials 2.7 版仍然表现出这种行为，但也可以按照上述方法进行修复。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-28T23:47:59.663

2.6有官方LESS编译器的1.3.3版本。它可能有一个错误。我将调查此问题并在修复后发布更新。

感谢您报告此事！

**更新：已修复！**

截至 2013 年 7 月 16 日，这已针对 VS 2012 进行了验证和修复。

Web Essentials 2.8 版解决了这个问题中的问题，因此如果您从 Visual Studio 2012 中再次更新或通过手动安装扩展，您将能够使用 LESS 编译器来处理相关的 @import 语句。

它仅适用于 LESS 1.3.3（与扩展一起打包的版本），但这应该不是问题，因为它现在可以开箱即用。

要查看扩展的 v2.8 中还更新了什么，请查看更改日志：http: [//vswebessentials.com/changelog](http://vswebessentials.com/changelog)

感谢 Mads Kristensen 和帮助解决此问题的团队其他成员！

**更新：VS自动更新**

VS 2013 的扩展 v2.8.1 已发布到 Visual Studio 扩展库。您应该收到 VS 自动更新消息或转到“工具 > 扩展和更新...”菜单项并从那里更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-14T20:47:08.723

现在已为 VS 2013[修复](https://github.com/madskristensen/WebEssentials2013/pull/25)并[发布此问题。](http://vswebessentials.com/changelog)

# javascript - jQuery.ajax() 无法向某些 URL 发送请求，但不能向其他 URL

> ID：15691717
> 
> 赞同：5
> 
> 时间：2013-03-28T20:40:59.350
> 
> 标签：javascript, ajax, jquery

在我们的 Rails 应用程序中，我们有一个内联编辑功能，可以将 PUT 更改回服务器。PUT 的 URL 会根据正在编辑的对象类型/用户所在的页面而变化，但相同的 JavaScript 支持所有页面上的功能。我遇到了一个问题，即 jQuery 的 AJAX 请求有时会在没有接触服务器的情况下失败，并且除了“错误”之外，它们没有给出任何错误消息。我一直试图在控制台中调试它，但没有成功。极其奇怪的部分是，它似乎是由于传递给的 URL 中的某些`$.ajax()`内容导致了问题。

在控制台中，这按预期工作：

```
> errorCallback = function( jqxhr, status, err ){
    console.log( "Ajax call encountered an error: '" + status + "'" );
    console.log( jqxhr );
    console.log( err );
  };
> options = { type: 'PUT', error: errorCallback, data: { cerebro: true, name: 'cerebro-edit-span-2-title', pk: null, value: 'Test' }, url: '/staff/employees/2.json' };
> test1 = $.ajax( options );
> test1.readyState;
  4 
```

所以我可以看到 AJAX 请求正常完成，没有触发错误回调，并且`readyState`按预期结果为 4。但现在看我是否只更改 URL 的中间部分：

```
> options.url = '/staff/job_advertisements/2.json';
> test2 = $.ajax( options );
  Ajax call encountered an error: 'error'
  Object {readyState: 0, getResponseHeader: function, ... } // elided for clarity

X PUT http://localhost:3000/staff/job_advertisements/2.json        jquery.js:8527
> test2.readyState;
  0 
```

使用这个不同的 URL，AJAX 调用甚至在到达应用程序服务器之前就失败了！查看开发机器的日志显示，从未发出过任何请求`/staff/job_advertisements/2.json`——也就是说，问题*不可能*是由于服务器返回 500 或 404 或其他错误代码，因为服务器甚至没有*收到来自浏览器*。只是为了证明问题出在客户端，而不是服务器端（并排除它与下划线有关的可能性）我尝试将 URL 设置为应用程序中实际不存在的一些无意义值：

```
> options.url = '/staff/jobadvertisements/2.json';
> test3 = $.ajax( options );
X PUT http://localhost:3000/staff/jobadvertisements/2.json 500 (Internal Server Error)    jquery.js:8527
  Ajax call encountered an error: 'error'
  Object {readyState: 4, getResponseHeader: function, ... } // elided for clarity

> test3.readyState;
  4
> options.url = '/staff/empl_oyees/2.json';
> test4 = $.ajax( options );
X PUT http://localhost:3000/staff/empl_oyees/2.json 500 (Internal Server Error)    jquery.js:8527
  Ajax call encountered an error: 'error'
  Object {readyState: 4, getResponseHeader: function, ... } // elided for clarity

> test4.readyState;
  4 
```

在测试 3 和 4 中，我还在应用程序日志中看到了请求、500 状态代码和产生的异常，而测试 2 中没有日志行（失败的情况）。所以测试 3 和 4 证明请求路径不存在不是问题，因为当请求路径不存在时，错误消息包含 500 状态代码并且`readyState`仍然设置为 4。他们还证明它是不允许下划线不是问题。

我已经搜索了有关该方法的 jQuery 文档，但**找不到**`ajax()`任何帮助，所以...**发送？**更重要的是，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-28T21:06:11.237

您是否启用了 AdBlock [Plus]？如果是这样，它会静默阻止对包含`advertisements`. 或者，看起来是这样，`_advertisements`。

# javascript - 为 HTML5 循环网格？

> ID：15691718
> 
> 赞同：2
> 
> 时间：2013-03-28T20:40:59.610
> 
> 标签：javascript, html, canvas

我为我的背景做了一个网格。我能够使用 X 和 Y 上的 for 循环来绘制一个网格来绘制一个正方形。

有没有办法让网格在两个轴上使用 +=1 在 x 和 y 上移动？

我正在考虑将网格设置为一个大图层并为图层设置动画，而不是为每个正方形设置动画。

[http://jsbin.com/emexaz/1/edit](http://jsbin.com/emexaz/1/edit)

编辑：我试图弄清楚使用 context.translate。但是每秒的每个间隔（假设 setInterval 的毫秒为 1000），它都会使值加倍。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T22:02:37.483

**这是在画布中循环网格的方法**

有几种方法可以绘制移动网格。这是其中之一。

这是代码和小提琴：http: [//jsfiddle.net/m1erickson/AjZhD/](http://jsfiddle.net/m1erickson/AjZhD/)

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; }
    canvas{border:1px solid red;}
</style>

<script>
$(function(){

    var canvas=document.getElementById("canvas");
    var ctx=canvas.getContext("2d");

    var w=canvas.width;
    var h=canvas.height;
    var offsetX=0;
    var offsetY=0;
    var rectX=0;
    var rectY=0;

    setInterval(function(){drawGrid();},100);

    function drawGrid(){

      // move the grid
      offsetX+=5;
      offsetY+=5;
      if(offsetX==20){offsetX=0;}
      if(offsetY==20){offsetY=0;}
      rectX+=5;
      rectY+=5;
      if(rectX==w){rectX=0;}
      if(rectY==h){rectY=0;}

      ctx.save();
      ctx.clearRect(0,0, w, h);
      ctx.strokeStyle="gray";
      ctx.beginPath();
      // vertical grid lines
      for(var x=offsetX;x<w;x+=20){
            ctx.moveTo(x,0);
            ctx.lineTo(x,h);    
      }
      // horizontal grid lines
      for(var y=offsetY;y<h;y+=20){
            ctx.moveTo(0,y);
            ctx.lineTo(w,y);    
      }
      // "moving" rect
      ctx.fillStyle="red";
      ctx.rect(rectX-4,rectY-4,8,8);

      ctx.stroke();
      ctx.fill();
      ctx.restore();

  }

}); // end $(function(){});
</script>

</head>

<body>
    <canvas id="canvas" width=300 height=300></canvas>
</body>
</html> 
```

**[编辑以获取有关代码如何工作的更多详细信息]**

可以……这里有更详细的解释。

这些变量将让我们在画布上下移动网格线。他们告诉我们在哪里绘制网格的下一帧和下一个红色矩形：

```
 var offsetX=0;
    var offsetY=0;
    var rectX=0;
    var rectY=0; 
```

然后 setInterval 是一个每 100 毫秒调用一次 drawGrid() 的循环。

顺便说一句，Loktar 是完全正确的，除了快速测试之外，您还需要使用 requestAnimationFrame 而不是 setInterval。requestAnimation 框架已内置优化，可提高性能并减少资源使用。

```
 // repease drawGrid() every 100 milliseconds
    setInterval(function(){drawGrid();},100); 
```

在 drawGrid() 中，我们增加了 offsetX/Y 和 rectX/Y，这导致我们开始向右和向下绘制网格。请注意，在移动 20px 之后，网格基本上回到了与我们开始时**相同的视觉位置！**这使我们可以简单地将我们的移动偏移重新设置为 0，并创建网格向右/向下行进超过 1 平方的**视觉错觉。**然而，rectX/Y 确实继续向右/向下网格（增加了运动的错觉）。

```
 // move the grid
      offsetX+=5;
      offsetY+=5;
      if(offsetX==20){offsetX=0;}
      if(offsetY==20){offsetY=0;}
      rectX+=5;
      rectY+=5;
      if(rectX==w){rectX=0;}
      if(rectY==h){rectY=0;} 
```

最后我们只画网格。首先，我们绘制垂直线，直到到达画布的末端。然后是水平线。最后，我们绘制红色矩形，它会产生网格向右/向下移动超过 1 个网格正方形的视觉错觉。

```
 for(var x=offsetX;x<w;x+=20){
            ctx.moveTo(x,0);
            ctx.lineTo(x,h);    
      }
      // horizontal grid lines
      for(var y=offsetY;y<h;y+=20){
            ctx.moveTo(0,y);
            ctx.lineTo(w,y);    
      }
      // "moving" rect
      ctx.fillStyle="red";
      ctx.rect(rectX-4,rectY-4,8,8); 
```

根据您想要移动网格的目的，有一些方法可以让网格飞得更快、更顺畅。Loktar 使用 requestAnimationFrame 进行了描述，它比 setInterval 做得更好。如果您想要真正快速和流畅，您可以简单地保存完整网格的图像并移动该图像，而不是重新绘制所有网格线。保存图像以供重复使用称为缓存。

如果您缓存的网格比画布宽 1 个方格，高出 1 个方格，您可以重用我们的**视觉错觉**。您将开始动画，超大网格悬挂在比画布更靠左和靠上的位置。然后对于每个动画帧，您将向右/向下移动网格 1px。20px 之后，缓存的图像将与画布的顶部/左侧完全对齐。然后，您只需将缓存的网格移动到画布左侧和顶部的起始位置。然后重复动画！非常快，非常流畅。

# java - python无法从网络打印解压的浮点数

> ID：15691720
> 
> 赞同：0
> 
> 时间：2013-03-28T20:41:04.330
> 
> 标签：java, python, sockets

我尝试从 UDP 数据报中获取浮点数并打印它们以验证：

```
import socket
from struct import *

socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
socket.bind( ('127.0.0.1', 2416) )
msg = bytearray( 4*1024 ) 
f1 = 0.0
f2 = 0.0
f3 = 0.0
while True:
    nBytes = socket.recv_into( msg )
    print( '%d bytes received' % nBytes )
    (f1) = unpack_from( '!f', msg, 0 )
    (f2) = unpack_from( '!f', msg, 4 )
    (f3) = unpack_from( '!f', msg, 8 )
    print( '%f, %f, %f received' % ( f1, f2, f3 )) 
```

引发以下错误：

```
$ python Server.py
12 bytes received
Traceback (most recent call last):
  File "Server.py", line 13, in <module>
    print( '%f, %f, %f received' % ( f1, f2, f3 ))
TypeError: a float is required 
```

预期输出为`1.2, 3.4, 5.6 received`。

语境：

```
Python 3.3.0 (v3.3.0:bd8afb90ebf2, Sep 29 2012, 10:57:17) [MSC v.1600 64 bit (AMD64)] on win32 
```

有关 Java UDP 发送方（客户端）的信息：

```
import java.io.IOException;
import java.net.DatagramPacket;
import java.net.DatagramSocket;
import java.net.InetAddress;
import java.nio.ByteBuffer;

public class Client {

   public static void main( String[] args ) throws Exception {
      try( DatagramSocket clientSocket = new DatagramSocket()) {
         InetAddress target = InetAddress.getByName( "localhost" );
         ByteBuffer msg = ByteBuffer.allocate( 4*1024 );
         for(;;) {
            msg.clear();
            msg.putFloat(   1.20f );
            msg.putFloat(   3.40f );
            msg.putFloat(   5.60f );
            msg.putDouble(  7.80  );
            msg.putDouble(  9.10  );
            msg.putDouble( 11.120 );
            msg.flip();
            clientSocket.send(
               new DatagramPacket( msg.array(), msg.limit(), target, 2416 ));
            Thread.sleep( 2000 );
         }
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:57:42.193

这条线是问题所在：

```
(f1) = unpack_from( '!f', msg, 0 ) 
```

尝试

```
(f1,) = unpack_from( '!f', msg, 0 ) 
```

注意额外的逗号。其他两行类似。

如您所述，`unpack_from`返回一个元组。`(f1)`不是元组，它是单个值。`(f1,)`是一个包含一个元素的元组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:59:31.423

这个程序运行良好：

```
import socket
from struct import *

socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
socket.bind( ('127.0.0.1', 2416) )
msg = bytearray( 4*1024 )
while True:
    nBytes = socket.recv_into( msg )
    print( '%d bytes received' % nBytes )
    (f1,) = unpack_from( '!f', msg,  0 )
    (f2,) = unpack_from( '!f', msg,  4 )
    (f3,) = unpack_from( '!f', msg,  8 )
    (d1,) = unpack_from( '!d', msg, 12 )
    (d2,) = unpack_from( '!d', msg, 20 )
    (d3,) = unpack_from( '!d', msg, 28 )
    print( f1, f2, f3, d1, d2, d3 )
    print( type(f1), type(d1)) 
```

并打印：

```
$ python Server.py
36 bytes received
1.2000000476837158 3.4000000953674316 5.599999904632568 7.8 9.1 11.12
<class 'float'> <class 'float'>
36 bytes received
1.2000000476837158 3.4000000953674316 5.599999904632568 7.8 9.1 11.12
<class 'float'> <class 'float'>
36 bytes received
1.2000000476837158 3.4000000953674316 5.599999904632568 7.8 9.1 11.12
<class 'float'> <class 'float'> 
```

# php - 具有三个变量的 PHP 排序数组

> ID：15691721
> 
> 赞同：0
> 
> 时间：2013-03-28T20:41:08.373
> 
> 标签：php, arrays, multidimensional-array, sorting

我需要帮助使用 PHP 对关联数组进行排序。

排序应依赖于数组键“名称”，并保留键/值对。以下排序顺序：1）第一个*整数*ASC，2）第二个*整数*ASC，3）第三个*混合*ASC

**输入**

```
array(6) {
  [0]=>
  array(2) {
    ["name"]=>
    string(13) "60 to 90 in 6"
    ["timing"]=>
    float(4.7)
  }
  [1]=>
  array(2) {
    ["name"]=>
    string(15) "40 to 120 in KD"
    ["timing"]=>
    float(3.3)
  }
  [2]=>
  array(2) {
    ["name"]=>
    string(14) "60 to 100 in 4"
    ["timing"]=>
    float(1.5)
  }
  [3]=>
  array(2) {
    ["name"]=>
    string(13) "60 to 90 in 4"
    ["timing"]=>
    float(2.4)
  }
  [4]=>
  array(2) {
    ["name"]=>
    string(15) "140 to 160 in 6"
    ["timing"]=>
    float(2.4)
  }
  [5]=>
  array(2) {
    ["name"]=>
    string(13) "60 to 90 in KD"
    ["timing"]=>
    float(5.7)
  }
} 
```

**输出顺序**

`1, 3, 0, 5, 2, 4`

非常感谢您的帮助。

* * *

# 回答：

```
uasort($acceleration, function($a, $b) {    
    if($a['_sort'][0] == $b['_sort'][0] AND $a['_sort'][2] == $b['_sort'][2])
    {                       
        if($a['_sort'][4] < $b['_sort'][4])
            return -1;
        elseif($a['_sort'][4] > $b['_sort'][4])
            return 1;
        else
            return 0;
    }
    elseif($a['_sort'][0] == $b['_sort'][0])
    {
        if($a['_sort'][2] < $b['_sort'][2])
            return -1;
        elseif($a['_sort'][2] > $b['_sort'][2])
            return 1;
        return 0;
    }
    else
    {
        if($a['_sort'][0] < $b['_sort'][0])
            return -1;
        elseif($a['_sort'][0] > $b['_sort'][0])
            return 1;
        else
            return 0;
    }
}); 
```

我敢肯定，有一种更优雅的方式，但可以作为输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:47:14.803

[使用uasort()](http://www.php.net/manual/en/function.uasort.php)排序后，您需要此数组的 array_keys 。比较函数（闭包）应该易于编写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:48:13.277

您应该使用 usort() ，它允许您使用用户定义的comarison 函数进行排序。因此，您必须实现比较 neme 字段并根据结果返回 -1,0 或 1 值的函数（小于、等于或大于）。此函数可以使用正则表达式从 name strng 字段中获取三个值，然后使用您的条件比较它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-25T08:29:44.857

```
<?php

$acceleration = array();
$acceleration[0]= array("name" => "60 to 90 in 6",   "timing" => 4.7 );
$acceleration[1]= array("name" => "40 to 120 in KD", "timing" => 3.3 );
$acceleration[2]= array("name" => "60 to 100 in 4",  "timing" => 1.5 );
$acceleration[3]= array("name" => "60 to 90 in 4",   "timing" => 2.4 );
$acceleration[4]= array("name" => "140 to 160 in 6", "timing" => 2.4 );
$acceleration[5]= array("name" => "60 to 90 in KD",  "timing" => 5.7 );

function comp_maker( $key ) {
    return function ($a, $b) use ( $key ) {     // closure for uasort() to use
        return strnatcmp( $a[$key], $b[$key] ); // comp by "natural order" 
    };
}

uasort($acceleration, comp_maker( 'name' ) );

// display sorted array's keys 
$str = '';
foreach ( $acceleration as $key => $value ){
    $str .= ", $key";
}
echo substr($str,1);

// output:  1, 3, 0, 5, 2, 4 
```

你也可以看看[这里的代码](http://3v4l.org/JnRYY)

该解决方案遵循关于应用 uasort() 的明智建议，它比 usort() 更合适，因为它保留了数组的键值关联。如果不维护这些，结果将是： 0,1,2,3,4,5 隐藏原始数组的重新排序方式。

请注意，由于调用 comp_maker() 函数，uasort() 的第二个参数将评估为闭包。uasort() 反过来将调用闭包，以便它可以执行比较。排序通过使用 strnatcmp() 根据“人工顺序”进行，因此值按预期升序显示。

为了获得结果，我本可以使用 array_keys() 但选择通过使用 key,value 语法遍历数组来输出排序数组键的新顺序来避免函数调用的开销。

# sharepoint - 如何以编程方式将主题标签添加到 Sharepoint 2013 中的列表项？

> ID：15691722
> 
> 赞同：2
> 
> 时间：2013-03-28T20:41:11.430
> 
> 标签：sharepoint, sharepoint-api, sharepoint-2013

我想使用 C# 组件将特定主题标签添加到 Sharepoint 2013 应用程序上的列表项。我想模仿“标签和记事板”功能。

我在这里找到了如何在服务器上添加标签[http://msdn.microsoft.com/en-us/library/ff770863.aspx](http://msdn.microsoft.com/en-us/library/ff770863.aspx)，但是当我使用 Sharepoint Online 时，我需要使用客户端 API。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T22:02:09.650

昨天我确实偶然发现了这个，现在无法访问 devbox，但您应该开始查看 Microsoft.SharePoint.Client.Social

IE

```
context.Load(context.Web);
SocialFeedManager socialFeedManager = new SocialFeedManager(context); 
```

如果您不击败我，我会在 devbox 再次上线时提供更多信息！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T12:53:52.617

我终于找到了方法：

```
public void AsyncEvent(SPRemoteEventProperties properties) {

    ...

    List lst = clientContext.Web.Lists.GetByTitle(properties.ItemEventProperties.ListTitle);
    clientContext.Load(lst);
    clientContext.ExecuteQuery();
    ListItem item = lst.GetItemById(properties.ItemEventProperties.ListItemId);

    clientContext.Load(item.ParentList, l => l.Fields.Where(field => field.Title == "FieldName"));
    clientContext.ExecuteQuery();

    foreach(TaxonomyField field in item.ParentList.Fields) {
         TaxonomyFieldValueCollection newTopics = new TaxonomyFieldValueCollection(clientContext, String.Empty, field);
         newTopics.PopulateFromLabelGuidPairs("Term A Label|term-a-unique-id;Term B Label|term-b-unique-id");
         field.SetFieldValueByValueCollection(item, newTopics);
    }

    item.Update();
    clientContext.ExecuteQuery(); 
```

如果您找到更好的解决方案，请发布它，这个效果很好。

如果您想知道如何格式化“Term Label|term-unique-id”，请查看 Sharepoint Admin 页面下的 Taxonomy Term Store。术语的唯一 id 样本：d5e733d2-a904-4bee-afbd-632440fdc125。

# c++ - 具有共享指针参数歧义的函数重载

> ID：15691726
> 
> 赞同：6
> 
> 时间：2013-03-28T20:41:15.850
> 
> 标签：c++, inheritance, c++11, shared-ptr, overloading

我想制作重载函数，这些函数采用指向基类和派生类的共享指针。它似乎适用于引用和原始指针，但不适用于额外派生类的共享指针。请参阅示例代码：

```
#include <memory>

class Base{};
class Derived : public Base {};
class ExtraDerived : public Derived {};

bool IsBase(Base*){ return true; }
bool IsBase(Derived*){ return false; }

bool IsBase(std::shared_ptr<Base>){ return true; }
bool IsBase(std::shared_ptr<Derived>){ return false; }

int main() 
{
    auto derived = std::make_shared<Derived>();
    auto extra_derived = std::make_shared<ExtraDerived>();
    // works
    auto raw_result_derived = IsBase(derived.get());
    auto raw_result_extra_derived = IsBase(extra_derived.get());
    auto shared_result_derived = IsBase(derived);
    // doesn't work
    auto shared_result_extra_derived = IsBase(extra_derived);
} 
```

使用 Visual Studio 2012 时，我得到：“错误 C2668：'IsBase'：对重载函数的模糊调用”，但当我在这里尝试代码时，我也得到了相同的结果[http://ideone.com/6uoa0p](http://ideone.com/6uoa0p)。

这似乎不是所需的行为（因为它适用于“原始”内容）。这是模板的限制，还有其他原因导致这不起作用还是错误？我怎样才能让它以最不难看的方式工作？

我能想到的最好的是

```
//ugly workaround
bool IsBase(std::shared_ptr<Base>, Base*){ return true; }
bool IsBase(std::shared_ptr<Derived>, Derived*){ return false; }
template<typename T> bool IsBase(std::shared_ptr<T> input )
{
    return IsBase(input, input.get());
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T21:00:58.747

> 这是模板的限制，还有其他原因导致这不起作用还是错误？

不，这不是错误。实际上，您似乎遇到了智能指针的唯一缺陷： an`std::shared_ptr<base>`可以由 from`std::shared_ptr<derived>`和 from构造`std::shared_ptr<extra_derived>`，但是这两个转换序列中没有一个比另一个更好（两个用户定义的相同长度的转换序列）。

但是，您仍然可以通过使用一些 SFINAE 约束来修复您的重载：

```
#include <type_traits>

// Selected for `std::shared_ptr<Base>`
template<typename T, typename std::enable_if<
    std::is_same<T, Base>::value>::type* = nullptr>
bool IsBase(std::shared_ptr<T>){ return true; }

// Selected for `std::shared_ptr<T>` where T is a class derived from Base,
// but not Base itself
template<typename T, typename std::enable_if<
    std::is_base_of<Base, T>::value &&
    !std::is_same<T, Base>::value
    >::type* = nullptr>
bool IsBase(std::shared_ptr<T>){ return false; } 
```

# python - 如何将一个脚本的输出作为另一个脚本的输入

> ID：15691729
> 
> 赞同：0
> 
> 时间：2013-03-28T20:41:23.017
> 
> 标签：python

我需要将 bash shell 的输出传递给 python 脚本。

1.  我正在打开一个模拟器，一次会在终端上收到错误消息
2.  我想使用 python 脚本从 stdout 和 stderr 解析一些数据
3.  解析完成后，我想终止模拟器（在 bash 脚本中打开）

我尝试使用管道衬里，但这里 python 脚本直到手动我没有终止模拟器才开始。例如：

```
./start.sh | python file.py 
```

我想实现自动化。我想将一个脚本的输出流式传输到 python 脚本的输入。

你能建议一种在两个脚本中实现流式传输的方法吗？

问候，曼

# c# - 列表的排序由数组组成

> ID：15691730
> 
> 赞同：0
> 
> 时间：2013-03-28T20:41:26.697
> 
> 标签：c#, arrays, list

我在一个项目的中间，我有点卡在这个问题上，

我需要在 C# 中对列表进行排序，列表结构是
`public List < double[] > DataList = new List < double[] >();`

现在我想根据列表中双数组的最后一个索引对该列表进行排序

像

`2|3|5|6|8`

`2|3|5|6|9`

`2|3|5|6|5`

`2|3|5|6|12`

输出应该是这样的

`2|3|5|6|12`

`2|3|5|6|9`

`2|3|5|6|8`

`2|3|5|6|5`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:44:12.117

使用 LINQ：

```
// reproduce data
List<double[]> DataList = new List<double[]>();
DataList.Add(new double[] { 2, 3, 5, 6, 8 });
DataList.Add(new double[] { 2, 3, 5, 6, 9 });
DataList.Add(new double[] { 2, 3, 5, 6, 5 });
DataList.Add(new double[] { 2, 3, 5, 6, 12 });

var ordered = DataList.OrderByDescending(l => l.Last()); 
```

`l`将对应于 中的每个元素`DataList`。使用`l.Last()`最后一个元素作为排序标准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:55:53.860

也使用Linq：

```
var tList = new List<double[]>();
tList.Add(new double[] {2,3,4,5,8});
tList.Add(new double[] {2,3,4,5,9});
tList.Add(new double[] {2,3,4,5,5});
tList.Add(new double[] {2,3,4,5,12});

var t = from element in tList
        orderby element.Last() descending
        select element;
var tResults = t.ToList(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-28T20:59:47.483

这是一些不使用 LINQ 的老式排序。

```
 List<double[]> DataList = new List<double[]>();
        private void button1_Click(object sender, EventArgs e)
        {
            DataList.Add(new double[] { 2, 3, 5, 6, 8 });
            DataList.Add(new double[] { 2, 3, 5, 6, 9 });
            DataList.Add(new double[] { 2, 3, 5, 6, 5 });
            DataList.Add(new double[] { 2, 3, 5, 6, 12 });
            DataList.Sort(new DoubleArrayComparer());
            DataList.Reverse();
        }
        class DoubleArrayComparer : IComparer<double[]>
        {
            public int Compare(double[] x, double[] y)
            {
                if(x.Length>0 && y.Length>0)
                {
                    if(x[x.Length-1] > y[y.Length-1])
                        return 1;
                    else if(x[x.Length-1] < y[y.Length-1])
                        return -1;
                    else
                        return 0;

                }
                else if(x.Length == 0 && y.Length!=0)
                    return -1;
                else if(y.Length == 0 && x.Length!=0)
                    return 1;
                else
                    return 0;
            }
        } 
```

# joomla - Joomla！模态，在条件下关闭刷新页面

> ID：15691732
> 
> 赞同：0
> 
> 时间：2013-03-28T20:41:27.657
> 
> 标签：joomla, joomla2.5, joomla-extensions, joomla-component

使用 Joomla！v2.5 和模态打开一个新的弹出窗口

```
<a href="index.php?option=com_mycomponent&view=my_view" class="modal" rel="{handler: 'iframe', size: {x: 800, y: 600}}"> 
```

用户将有一些选项（链接），例如信息/删除/锁定。

选择（单击）一个选项并单击“关闭”按钮后，我需要关闭模式或关闭模式并刷新页面。

我总是可以使用这样的东西刷新页面

```
<a href="index.php?option=com_mycomponent&view=my_view" class="modal" rel="{handler:'iframe', size: {x: 800, y: 600},onClose:function(){var js =window.location.reload();}}"> 
```

但我需要在某些条件下刷新页面（例如，用户单击“删除”=> 刷新，用户单击“信息”=> 什么也不做）

想法？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-29T02:58:32.453

所以，在 Joomla！2.5`modal`弹出窗口由[SqueezeBox](http://digitarald.de/project/squeezebox/)脚本（1.3 版）处理。

将您的`onClose`处理程序设置为调用您自己的 Javascript 方法，因此：

```
onClose:function(){var js =window.location.reload();} 
```

更改为：

```
onClose:function(){checkUserChoice();} 
```

或者，如果您保持 Javascript 的命名空间整洁（如推荐的那样）

```
onClose:function(){mycomponent.checkUserChoice();} 
```

让您`checkUserChoice()`做出决定：

```
mycomponent.checkUserChoice = function () {
    userChoice = document.id('userOption).value;
    if(userChoice == 'delete') {
        // refresh our page
    } else {
        // do something else
    }
} 
```

然后将您的自定义 Javascript 文件加载到视图中：

```
// Get the document object
$document = JFactory::getDocument();
$document->addScript('path/to/myscript.js'); 
```

或者，如果您只有一种小方法可以加载：

```
$myscript = <<<'JS'
mycomponent.checkUserChoice = function () {
    userChoice = document.id('userOption).value;
    if(userChoice == 'delete') {
        // refresh our page
    } else {
        // do something else
    }
}
JS;

$document->addScriptDeclaration($myscript); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T02:05:09.057

对于 onClose 处理程序，我建议让它调用您自己的自定义 JS 方法。在该方法中，处理您的自定义逻辑以确定是否刷新页面。

# javascript - jQuery .click() 似乎没有取消选中单选框

> ID：15691733
> 
> 赞同：1
> 
> 时间：2013-03-28T20:41:28.163
> 
> 标签：javascript, jquery, radio-button

我试图在单选框上动态创建一个重置按钮，然后在用户单击按钮时说重置按钮取消选中任何现有选择，但是当我单击它时，什么也没有发生。我可能遗漏了一些明显的东西，但不确定是什么。

[http://jsfiddle.net/sFUBV/5/](http://jsfiddle.net/sFUBV/5/)

```
$('.surveyor_radio').parent().parent().append('<div class="reset-button">A reset button</div>');

$('.reset-button').click(function () {
    $('#form input[type="radio":checked]').each(function () {
        $(this).prop('checked', false);
    });
});

$('fieldset').each(function () {
    var qid = $(this).attr('id');
    $('.reset-button', $(this)).attr('data-question-id', qid);
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:44:20.060

代替

```
$('#form input[type="radio":checked]') 
```

和

```
$('#form input[type="radio"]:checked') 
```

但是，请注意您的代码不会区分单选按钮组，并且会简单地取消选中整个表单中的所有单选按钮。

幸运的是，您已经`data-question-id`存储了单选按钮，因此我们可以使用它来提供上下文而不是`#form`：

```
$('.reset-button').click(function () {
    $('input[type="radio"]:checked','#'+$(this).data('question-id')).each(function () {
        $(this).prop('checked', false);
    });
}); 
```

[http://jsfiddle.net/mblase75/sFUBV/10/](http://jsfiddle.net/mblase75/sFUBV/10/)

正如 nzifnab 指出的，我们甚至可以进一步简化：

```
$('.reset-button').click(function () {
    $('input[type="radio"]','#'+$(this).data('question-id')).prop('checked', false);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T21:01:03.647

您不想使用`removeAttr`，该`prop`方法就足够了。

您不应该使用`.each`任何一个，因为在 jquery 集合上调用的大多数 jquery 方法已经在所述集合的每个对象上执行。

这有效：http: [//jsfiddle.net/sFUBV/14/](http://jsfiddle.net/sFUBV/14/)

```
$('.surveyor_radio').parent().parent().append('<div class="reset-button">A reset button</div>');

$('.reset-button').on('click', function () {
  $(this).
    closest('li.input').
    find('input[type=radio]').
    prop('checked', false);
}); 
```

没有理由添加`:checked`选择器，因为无论如何您都取消选中它们，如果取消选中未选中的有什么关系？无论哪种方式都会发生同样的事情。

另请注意，您不一定必须按照接受的答案所示的问题 ID 来执行此操作。这只是查看 current 中的所有单选按钮`li.input`，因此您可以在任何地方使用它，而不必担心问题 ID 和插值废话。

此外，您应该使用`on`绑定事件而不是`click`或`live`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:50:58.093

这有效：

```
$("input[type='radio']:checked").each(function () {
    $(this).removeAttr('checked');
}); 
```

检查小提琴：http: [//jsfiddle.net/sFUBV/9/](http://jsfiddle.net/sFUBV/9/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-29T12:53:50.980

试试这一行而不是 each() 函数

```
$('.reset-button').click(function () {
    $('#form input[type="radio"]:checked').prop('checked', false);
}); 
```

# c# - 当涉及字符时从字符串中获取值

> ID：15691734
> 
> 赞同：0
> 
> 时间：2013-03-28T20:41:29.087
> 
> 标签：c#, regex

我有一个字符串，我想从中获取值“12345”和“123.5”并将其放入一个集合中，这样我就可以循环并对其进行处理。有人可以帮忙吗？

```
string test = "Hello World [12345] - [123.5]"

string anothertest = "Hello World [A12345 (05,00,45)] [518.6Z] [51.5]" 
```

我想要“A12345”“518.6Z”“51.5”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:44:24.570

使用以下正则表达式：

```
\[(\d+\.?\d+)\] 
```

你会想要组（1）。

也许这个半伪会有所帮助......

```
Regex expression = new Regex(@"\[(\d+\.?\d+)\]");
var results = expression.Matches(test);
foreach (Match match in results)
{
    //do whatever you want.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T23:25:55.340

对于您编辑的第二部分：

```
\[(\d*\w*\.?\d*\w*)(?!\() 
```

这 ”？！” 是一个否定的前瞻断言，在这种情况下意味着“匹配之前没有跟随的事物（”

# python - 高级索引分配是否复制数组数据？

> ID：15691740
> 
> 赞同：14
> 
> 时间：2013-03-28T20:41:42.510
> 
> 标签：python, numpy, copy

我正在慢慢尝试理解numpy 中`view`s 和`copy`s 之间的区别，以及可变类型与不可变类型的区别。

[如果我使用“高级索引”](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#advanced-indexing)访问数组的一部分，它应该返回一个副本。这似乎是真的：

```
In [1]: import numpy as np
In [2]: a = np.zeros((3,3))
In [3]: b = np.array(np.identity(3), dtype=bool)

In [4]: c = a[b]

In [5]: c[:] = 9

In [6]: a
Out[6]: 
array([[ 0.,  0.,  0.],
       [ 0.,  0.,  0.],
       [ 0.,  0.,  0.]]) 
```

由于`c`只是一个副本，它不共享数据并且更改它不会改变`a`。然而，这让我感到困惑：

```
In [7]: a[b] = 1

In [8]: a
Out[8]: 
array([[ 1.,  0.,  0.],
       [ 0.,  1.,  0.],
       [ 0.,  0.,  1.]]) 
```

所以，看起来，即使我使用高级索引，赋值仍然把左边的东西当作一个视图。显然第`a`2 行与第 6 行是相同的对象/数据`a`，因为变异`c`对其没有影响。

所以我的问题是：第`a`8 行中的对象/数据是否与以前相同（当然不包括对角线）还是副本？换句话说，是`a`的数据被复制到了新的`a`，还是它的数据在原地发生了变异？

例如，是不是这样：

```
x = [1,2,3]
x += [4] 
```

或喜欢：

```
y = (1,2,3)
y += (4,) 
```

我不知道如何检查这一点，因为在任何一种情况下，`a.flags.owndata`都是`True`. 如果我以一种令人困惑的方式思考这个问题，请随时详细说明或回答不同的问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-28T21:13:33.343

当您这样做时`c = a[b]`，`a.__get_item__`将`b`作为其唯一参数调用，并且将返回的任何内容分配给`c`.

当您这样做时`a[b] = c`，`a.__setitem__`会使用`b`and`c`作为参数调用，并且返回的任何内容都会被默默地丢弃。

因此，尽管`a[b]`语法相同，但两个表达式都在做不同的事情。您可以子类`ndarray`化，重载这两个函数，并让它们表现不同。在 numpy 中默认情况下，前者返回一个副本（如果`b`是一个数组），但后者修改`a`到位。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-28T20:53:04.293

是的，它是同一个对象。以下是您的检查方式：

```
>>> a
array([[ 0.,  0.,  0.],
       [ 0.,  0.,  0.],
       [ 0.,  0.,  0.]])
>>> a2 = a
>>> a[b] = 1
>>> a2 is a
True
>>> a2
array([[ 1.,  0.,  0.],
       [ 0.,  1.,  0.],
       [ 0.,  0.,  1.]]) 
```

在 Python 中分配给某个表达式与仅读取该表达式的值不同。当你这样做`c = a[b]`时，`a[b]`在等号的右边，它会返回一个新对象。当你这样做`a[b] = 1`时，`a[b]`在等号的左边，它会修改原始对象。

事实上，表达式 like`a[b] = 1` *不能*改变 name`a`所绑定的内容。处理的代码`obj[index] = value`只知道对象`obj`，而不是用于引用该对象的名称，因此它不能更改该名称所指的内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-23T01:15:13.480

这似乎是常见的误解，引用官方文档：（[https://scipy-cookbook.readthedocs.io/items/ViewsVsCopies.html](https://scipy-cookbook.readthedocs.io/items/ViewsVsCopies.html)）

> 这里的经验法则可以是：在左值索引的上下文中（即索引放置在赋值的左侧值中），不创建数组的视图或副本（因为没有必要）。但是，对于常规值，上述创建视图的规则确实适用。

换句话说，`view`or的概念`copy`仅指从`numpy`对象中检索值的情况。

# node.js - 将变量发送到 nodeJs 中的翡翠模板引擎（同步）

> ID：15691742
> 
> 赞同：0
> 
> 时间：2013-03-28T20:41:54.013
> 
> 标签：node.js, pug, nodejitsu

我想在 Node.js 中调用一个函数，获取结果并将它们发送到模板。`results`总是返回空。

怎么了？

```
var replace = req.params.replace || "";
var find = req.params.find;
var fs = require("fs");
var dir = "./public/sounds/";
var results = [];

var readFiles = function (root) {
    fs.readdir(root, function (err, files) {
        if (err) {
            console.log(err);
            return;
        }
        files.forEach(function (file) {
            console.log(root.concat(file));
            fs.stat(root.concat(file), function (err, stat) {
                if (stat && stat.isDirectory()) {
                    readFiles(root.concat(file + "/"));
                }
            });
            if (file.indexOf(find) > 0) {
                var oldPath = root.concat(file);
                var newPath = oldPath.replace(find, replace).trim();
                console.log("Old Path: ", oldPath, " New Path: ", newPath);
                fs.rename(oldPath, newPath);
                results.push(newPath);
            }
        })

    });
};
readFiles(dir);
res.jsonp({
    message: results
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T19:01:36.890

```
var results = [];
...some async stuff...
console.log(results); 
```

每次都会打印空数组，所以如何修复。

简短的回答：

```
var async = require('async');
async.each(files, function (file) { ... },
  function (error, results) { 
    res.jsonp({
      message: results
    });
  }); 
```

更长的答案，您的代码分支笨拙，因此需要进行一些重组才能正常工作。

```
var async = require('async');
var replace = req.params.replace || "";
var find = req.params.find;
var fs = require("fs");
var dir = "./public/sounds/";

var readFiles = function (root, cb) {
    var results = [];
    fs.readdir(root, function (err, files) {
        if (err) {
            cb(err);
            return;
        }
        aync.each(file, function (file, cb) {
            console.log(root.concat(file));
            fs.stat(root.concat(file), function (err, stat) {
                if (err) {
                  return cb(err);
                }
                if (stat && stat.isDirectory()) {
                    readFiles(root.concat(file + "/"), function (err, res) {
                      results = results.concat(res);
                      cb(err);
                    });
                } else {
                    if (file.indexOf(find) > 0) {
                        var oldPath = root.concat(file);
                        var newPath = oldPath.replace(find, replace).trim();
                        console.log("Old Path: ", oldPath, " New Path: ", newPath);
                        fs.rename(oldPath, newPath);
                        results.push(newPath);
                    }
                    cb();
                }
            });

        }, function (err) {
            cb(err, results);
        });

    });
};
readFiles(dir, function (err, results) {
  res.jsonp({
    message: results
  });
}); 
```

我还没有测试过，所以如果你在调试它时遇到问题，请告诉我。

# python - 模型作为 r 函数的参数，当从多线程中使用 rpy2 调用 r 函数时

> ID：15691745
> 
> 赞同：0
> 
> 时间：2013-03-28T20:42:09.690
> 
> 标签：python, multithreading, r, multiprocessing, rpy2

当从多线程中使用 rpy2 调用 r 函数时，这更像是一个效率问题。

r 函数的任务基本上是从磁盘加载模型文件并使用模型对时间序列进行分类。然而，收集输入时间序列是使用 python 通过从数据库中轮询来完成的（将由一些 Web 服务更新）。一旦python代码检测到新的时间序列，它将创建一个工作进程，其中rpy2用于调用r函数来完成分类任务。

让 python 做分类任务不是我们的选择。我主要关心的是加载模型文件时的开销。显然，我不希望每次对新的时间序列进行分类时都读取一次文件。所以问题是——

如何只加载一次模型文件，并且当通过 rpy2 调用相同的 r 函数时可以重新使用内存中的模型对象？

我最初的意图是将模型文件加载到 python 中，并在每次调用 r 函数时将其作为参数传递。但这会引入复制模型参数的额外成本（比如大小不可忽略）。

您的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T12:45:39.347

如果我理解正确，您：

1.  有一个用 R 编写的函数（分类器），它需要相对大量的数据才能工作（k 个最近的邻居？）
2.  正在使用 Python 加载该数据体
3.  想加载参数/once/，然后根据需要对分类器进行尽可能多的调用
4.  计划将数据主体作为分类器的参数传递

如果遵循 4.，则复制并不总是必要的，但目前只有当数据是数字或布尔值，并且内存区域由 R 分配时。

但是，我认为对于这种情况，一个更简单的替代方法是将数据主体一次性传递给 R（并在必要时复制）并使用该转换后的对象。

```
from rpy2.robjects.packages import importr
e1071 = importr('e1071')

from rpy2.robjects.conversion import py2ri

# your model's data are in 'm_data'
# here conversion is happening
r_m_data = py2ri(m_data)

for test_data in many_test_data:
    # r_m_data is already a pointer to an R data structure
    # (it was converted above - no further copying is made)
    res = e1071.knn(r_m_data, test_data) 
```

这将对应于您所描述的内容：

> 如何只加载一次模型文件，并且当通过 rpy2 调用相同的 r 函数时可以重新使用内存中的模型对象？

# jquery - 将外部 html 加载到同一类的多个 div 中

> ID：15691749
> 
> 赞同：2
> 
> 时间：2013-03-28T20:42:14.627
> 
> 标签：jquery, ajax, html, load, next

我正在尝试为我的音乐创建一个 CD 封面组合。

目前，我的投资组合页面会在初始页面加载时加载我相册中的所有内容。内容包含在隐藏的 div 中。

当您单击相册时，内容会向下滚动并在再次单击时关闭，使用`.slideToggle()`. [**在这里**](http://jimkulakowski.com)查看网站[](http://jimkulakowski.com)

 **我担心的是我希望页面加载速度更快，并且只有在被调用时才加载内容。
任何帮助将不胜感激。

我制定了一个测试场景：

```
<!doctype html>
<html>
    <title>jQuery external load test</title>

    <head>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
        <style type="text/css">
            #container {
                width: 80%;
                margin: 0 auto;
                margin-top:;
            }
            .albumThumb {
                float: left;
                position: relative;
                margin: 5px;
                height: 150px;
                width: 150px;
                background-color: purple;
            }
            .albumThumb:hover {
                opacity: 0.8;
                filter:alpha(opacity=80);
            }
            .albumContent {
                display: none;
                width: 100%;
                float: left;
                position: relative;
                padding: 20px;
                color: #333;
                background-color: #eee;
                border: 1px solid #ddd;
            }
        </style>
    </head>

    <body>
        <div id="container">
            <!-- Album #1 -->
            <div class="albumThumb"></div>
            <div class="albumContent"></div>
            <script type="text/javascript">
                $(document).ready(function() {
                    $('.albumThumb').click(function() {
                        // Name content variable
                        var album = 'album-page';
                        var url = 'http://mysite.com/' + album + ' #project-info';
                        var content = $(this).nextAll('.albumContent:first');

                        // Load/Unload div content
                        if (content.is(':visible')) {
                            content.slideUp(500);
                            content.html('');
                        } else {
                            content.text('Loading...', function() {
                                content.load(url).content.slideDown(500);
                            });
                        }
                    });
                });
            </script>
            <!-- Album #2 -->
            <div class="albumThumb"></div>
            <div class="albumContent"></div>
            <script type="text/javascript">
                $(document).ready(function() {
                    $('.albumThumb').click(function() {
                        // Name content variable
                        var album = 'album-page';
                        var url = 'http://mysite.com/' + album + ' #project-info';
                        var content = $(this).nextAll('.albumContent:first');

                        // Load/Unload div content
                        if (content.is(':visible')) {
                            content.slideUp(500);
                            content.html('');
                        } else {
                            content.text('Loading...', function() {
                                content.load(url).content.slideDown(500);
                            });
                        }
                    });
                });
            </script>
        </div>
        <!-- End Container -->
    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:51:14.717

那个网站**真的很慢！**这可能是因为代码重复和您分配的事件数量。`on`我们可以压缩您的代码，然后使用委托减少事件数量。

在使用它之前，您**需要**更新您的 jQuery（您当前使用的是 1.3，您需要*至少*使用1.7（即`on`添加时））。

试试这个：

```
$(function() {
    $('.albumThumb').on("click", function() {
        // Name content variable
        var album = 'album-page';
        var url = 'http://mysite.com/' + album + ' #project-info';
        var content = $(this).nextAll('.albumContent:first');

        // Load/Unload div content
        if (content.is(':visible')) {
            content.slideUp(500);
            content.html('');
        } else {
            content.text('Loading...', function() {
                content.load(url).content.slideDown(500);
            });
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T23:42:36.160

好吧，我找到了解决方案。确实花了很多时间，mattytommo的回答让我走上了正确的轨道。所以，再次感谢马蒂。

我最终编写了一个 function() 并将变量名称更改从 html 传递到 jQuery 函数，使用 onClick 事件，这是新脚本：

```
<script type="text/javascript">
$(function albumSlider() {
    $('.albumThumb').on("click", function() {
        // Name content variables
        // var album = *Gets content from html "onClick"
        var url = 'http://mysite.com/' + album;
        var thisAlbum = $(this);
        var content = thisAlbum.nextAll('.albumContent:first');

        // Load/Unload div content
        if (thisAlbum.hasClass('.selected')) {
            thisAlbum.removeClass('.selected');
            content.slideUp(500, function() {
                content.html('');
            });
        } else {
            thisAlbum.addClass('.selected');
            content.slideDown(500, function() {
                content.text('Loading...').load(url);
            });
        }
    });
});
</script> 
```

我在 if/else 语句中使用了 .hasClass()、addClass() 和 .removeClass() - 好像在说：“如果我点击的专辑已经有 .selected 类，那么它的内容必须是打开的并且可见。因此，删除.selected类并关闭被点击的divAlbumThumb后面的div.albumContent。否则，如果我点击的相册没有.selected类，那么它一定没有打开。因此，添加类 .selected 到我单击的专辑并打开以下专辑内容 div。”

接下来，我简化了 html，使用它将外部专辑内容 (html) 传递到 div.albumContent 之后选择的 div.albumThumb：

```
<body>

<div id="container">

<!-- Album 1 -->

  <div class="albumThumb" onClick="javascript:album = 'album-1';"></div>

  <div class="albumContent"></div>

<!-- Album 2 -->

  <div class="albumThumb" onClick="javascript:album = 'album-2';"></div>

  <div class="albumContent"></div>

</div><!-- End Container -->

</body> 
```

专辑 1 和专辑 2 现在在“var album = '';”中传递 在javascript函数中。**

# php - Symfony 2 全局函数

> ID：15691752
> 
> 赞同：0
> 
> 时间：2013-03-28T20:42:38.233
> 
> 标签：php, symfony

我想为我的 Symfony 2 应用程序（跨多个控制器和实体）提供一组全局函数，它们的作用类似于内置的 PHP 函数。例如：

```
function startsWith($haystack, $needle) {
    return !strncmp($haystack, $needle, strlen($needle));
} 
```

我可以创建一个包含这些函数的文件，但需要为每个命名空间复制它：

```
namespace Taggle\TaggleBundle\DependencyInjection;
namespace Taggle\TaggleBundle\Controller; 
```

处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:59:32.333

如果带有函数声明的文件未定义命名空间，则函数将在全局命名空间中声明。

全局命名空间中的函数可以在任何其他命名空间中通过它们的常规名称调用。

**函数.php**

```
<?php

function foo() {
  echo 'bar';
} 
```

**索引.php**

```
<?php

namespace Foo\Bar;

require 'functions.php';

foo(); // 'bar' 
```

但是，我建议不要以这种方式定义普通函数。首先它们污染了全局命名空间（导致潜在的命名冲突），其次你最好用静态方法声明一个类。这样，您还可以从自动加载机制中受益。

# php - 无法启动 .jnlp

> ID：15691755
> 
> 赞同：1
> 
> 时间：2013-03-28T20:42:42.837
> 
> 标签：php

我第一次不得不在这里问一个问题，因为我总是能够找到答案。我不知道 Java 或 .jnlp 文件是如何工作的。

**项目背景**

当人们点击下载文件时，我的网站上有一个网页会加载一个空白页面。然后，此空白页面加载 .jnlp 文件，该文件在用户启动时执行 java 代码。不幸的是，许多用户很难理解发生了什么。我的任务是将下载的内容打包到我们的 Magento 系统中，并添加说明，以便人们知道他们在哪里。

**问题**

一切都按预期工作。唯一的例外是 .jnlp 文件在启动时显示错误“无法启动应用程序”。问题是整个网站的内容都被写入文件，这导致它失败。我发现的唯一解决方法是在新的空白窗口中启动 .jnlp 文件......这违背了我打算做的事情的目的。

**问题**

有没有办法在页面上启动 .jnlp 文件而不必打开新选项卡或页面为空白（尽管是 .jnlp 启动代码）？

**编码**

以下是用于启动 .jnlp 文件的代码：

```
<?php
$map_name = isset($_GET['name']) ? filter_var($_GET['name'], FILTER_SANITIZE_STRING ) : redirect();
$map_version = isset($_GET['version']) ? filter_var($_GET['version'], FILTER_SANITIZE_NUMBER_INT ) : redirect();
$expiration = (time() + (2*24*60*60)) * 1000; 
$java = isset($_GET['java']) ? filter_var($_GET['java'], FILTER_SANITIZE_STRING ) : "false"; 

// check if java is ready, then execute the chip updater
if( $java == "ready" ){

    // load jnlp template
    $dom = new DOMdocument('1.0', 'utf-8');
    $dom->formatOutput = true;

    $dom->load('template.jnlp.php');
    $node = $dom->getElementsByTagName("application-desc")->item(0); // locate the start place and prep for insertion

    // map name attribute
    $var = $dom->createElement("argument", base64_encode($map_name)); // place a new argument tag and place an encoded name there
    $node->appendChild($var);

    // map version attribute
    $var = $dom->createElement("argument", base64_encode($map_version)); // place a new argument tag and place an encoded version there
    $node->appendChild($var);

    // set expiration attribute
    $var = $dom->createElement("argument", base64_encode($expiration)); // place a new argument tag and place an encoded expiration time there
    $node->appendChild($var);

    // output jnlp mime header and force download=
    header("Content-Type: application/x-java-jnlp-file");
    header("Content-Disposition: attachment; filename=update.jnlp");
    //header("Content-Type: text/xml");

    // output xml content
    echo $dom->saveXML();
    //echo $dom->saveXML($node);

    } // end
    else{
        echo <<<EOD
        <?xml version="1.0" encoding="UTF-8"?>
        <html>
            <head></head>
            <body>
                <script src="http://www.java.com/js/deployJava.js" type="text/javascript"><!-- // --></script>
                <script type="text/javascript">
                    if (deployJava.versionCheck('1.6') || deployJava.versionCheck('1.7')) {
                        var str = location.href;
                        var z = str.replace("https://","http://");
                        var n = z.replace("?download=1","");
                        var url = n + "&java=ready";

                        window.location = url; // possibly replace with = ((location.href).replace("?download=1","")) + "&java=ready"

                    }
                    else{
                        alert("We have detected that you either do not have Java installed, or that it may be an older version. We are redirecting you to the Java download site where you will be able to install the newest version of Java. <!!! -- If the window does not load, you may need to allow popups from our site. Please watch for a popup warning and allow it to then relaunch! -- !!!>");
                        var url="./update2.php";
                        window.open(url);
                        window.history.back();
                    }
                </script>
            </body>
        </html>

EOD;
    } 
```

**注意：**我知道有一些不好的做法，例如使用 $_GET() 而不是 $_POST()，由于系统设置的方式，这需要时间来修复。我也了解 DOM 对象正在从我的网页中抓取所有内容，如果我在系统框架的同一页面上使用此代码，则会导致错误。这段代码是在我加入公司之前开发的，我正在尝试查看是否可以对其进行调整以使其工作，或者是否需要采用不同的方法。

我很感激你可以分享的任何意见。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T23:02:04.073

我想通了。在这种情况下，我仍然需要在单独的页面中打开它——这确实违背了构建它的目的。但是，我使用了`<iframe>`，它允许我正确运行文件。我发现如果我`<iframe>`使用 display:none 隐藏它，它仍然会正确下载 .jnlp 文件。

因此，如果有人遇到过类似的解决方案，那么有一种方法。如果有人知道，我会对学习另一种方式感兴趣。

# windows-7 - 由于 CroMagVersion 错误，无法在发布模式下编译

> ID：15691756
> 
> 赞同：0
> 
> 时间：2013-03-28T20:42:48.830
> 
> 标签：windows-7, visual-studio-2012, nuget-package, cromagversion

我已使用 NuGet 包管理器将 CroMagVersion 安装到我的解决方案中。

`Debug`它在配置中工作得很好。现在我想尝试一些`Release`模式，我被打动了

```
4>  Processing '..\..\packages\CroMagVersion.0.3.4.0\tools\CroMagVersion.tt'... failed.
4>e:\path\to\solution\DataAccessLayers\Org.Zighinetto.MyProject.NHibernate\Org.Zighinetto.MyProject.NHibernate.csproj(161,5): error : (-1,-1): ERROR Error running transform: System.ComponentModel.Win32Exception (0x80004005): Unable to find the specified file
4>     in System.Diagnostics.Process.StartWithCreateProcess(ProcessStartInfo startInfo)
4>     in System.Diagnostics.Process.Start(ProcessStartInfo startInfo)
4>     in Microsoft.VisualStudio.TextTemplating.GeneratedTextTransformation370e1b87.GetProcessOutput(String localPath, String path, String command)
4>     in Microsoft.VisualStudio.TextTemplating.GeneratedTextTransformation370e1b87.WriteAttributes()
4>     in Microsoft.VisualStudio.TextTemplating.GeneratedTextTransformation370e1b87.TransformText()
4>     in Mono.TextTemplating.CompiledTemplate.Process()
4>e:\path\to\solution\DataAccessLayers\Org.Zighinetto.MyProject.NHibernate\Org.Zighinetto.MyProject.NHibernate.csproj(161,5): error MSB3073: exit command "..\..\packages\CroMagVersion.0.3.4.0\tools\TextTransform.exe -o="..\..\packages\CroMagVersion.0.3.4.0\tools\SharedAssemblyInfo.cs" -a="Configuration!Release " -a="SolutionDir!e:\path\to\solution\ " "..\..\packages\CroMagVersion.0.3.4.0\tools\CroMagVersion.tt"" with code -1. 
```

虽然我有匿名的项目名称和路径，但项目结构保留在路径中。

基本上我有

```
-- Solution dir

  --packages //NuGet's
  --DataAccessLayers
    --Project1
    --Project2
  --FrontEnds
    --Project1
    --Project2
  --ProjectX
  --ProjectY 
```

我已经三重检查：

1.  packages\CroMagVersion.0.3.4.0 存在。查看
2.  TextTransform 存在于正确的目录中。查看
3.  运行`cmd`,`cd`进入项目目录并发出`..\..\packages\CroMagVersion.0.3.4.0\tools\TextTransform.exe`不会引发文件未找到错误，但会正确调用程序。查看

我的解决方案路径**确实**包含空格（解决方案通常放在下面`Documents\Visual Studio 20xx`，2012 年我也不例外）

### 问题是

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:07:35.533

升级到 CroMagVersion 0.3.5.0 已修复。这是该项目的一个已知错误

```
Release Notes
0.3.5.0 - minor bugfix

    When hg or git was not in PATH, builds could generate spurious exceptions like System.ComponentModel.Win32Exception (0x80004005): The system cannot find the file specified 
```

事实上，我还没有使用 git

# javascript - 在 node.js 服务器上生成 URL

> ID：15691758
> 
> 赞同：2
> 
> 时间：2013-03-28T20:42:51.937
> 
> 标签：javascript, node.js, url

我正在寻找一种专业技术来生成唯一的 URL 地址。我创建了一个 node.js 服务器，它应该将这些 URL 提供给访问客户端。如何提供网址？

```
// user is connecting to www.privatebox.de

// server serves index.html with unique ID

// e.g. www.privatebox.de/8yfuzyzzm7 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-28T22:23:24.820

对于一个健壮的解决方案，我会考虑使用 node-uuid 来生成 UUID。

使用 NPM 安装包：

```
npm install node-uuid 
```

基于来自[GitHub 项目页面](https://github.com/broofa/node-uuid)的示例代码：

```
var uuid = require('node-uuid');

// Generate a v1 (time-based) id
var timeBasedID = uuid.v1(); // -> '6c84fb90-12c4-11e1-840d-7b25c5ee775a'

// Generate a v4 (random) id
var randomID = uuid.v4(); // -> '110ec58a-a0f2-4ac4-8393-c866d813b8d1'

var url = 'www.privatebox.de/' + randomID;  // or + timeBasedID 
```

如果您正在寻找一个更短、对 url 更友好的唯一 ID，那么[ShortId](https://github.com/dylang/shortid)对您来说可能是一个不错的选择，尽管发生冲突的可能性会更高。ShortId 将生成这样的 id：

```
ShortId.generate() -> 'PPBqWA9' 
```

最后，我建议你看一下这个[SO question](https://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript) for generate unique ids in javascript。

# python - Conky界面

> ID：15691761
> 
> 赞同：1
> 
> 时间：2013-03-28T20:43:01.547
> 
> 标签：python, c, conky

我正在研究一种远程访问有关 linux 服务器的统计信息的方法，即[conky](http://conky.sourceforge.net/)会显示的那种信息。

有没有办法与 conky 交互并获取它显示的统计信息？如果没有，您能否推荐一种获取此类统计信息的好方法？（C/Cpp 库，或者可能是 python）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T00:01:28.163

您可以将 conky 写入标准输出（`out_to_console`选项）并将其重定向到文件。当然，您仍然需要获得对该文件的外部访问权限。

`sysfs`Conky 从和中的文件中获取大部分数据`procfs`。您可以编写一个程序，从那里收集您需要的信息并将其放在您可以远程阅读的网页上（假设服务器运行网络服务器）。

**编辑：**据此，文件[中](https://www.kernel.org/doc/Documentation/hwmon/sysfs-interface)的文件格式`sysfs`非常简单；每个文件只有一个浮点值（作为文本）。

# python - Python：引发 argparse.ArgumentError 后，argparse 引发一般错误

> ID：15691762
> 
> 赞同：3
> 
> 时间：2013-03-28T20:43:02.007
> 
> 标签：python, regex, assert, argparse

我为需要遵循精确格式的参数定义了一个自定义正则表达式类型。我使用了另一篇非常有用的代码（[正则表达式自定义类型](https://groups.google.com/forum/?fromgroups=#!topic/argparse-users/tAC1eH1a29c)）。我的问题是我正在编写单元测试，我希望正则表达式失败并试图断言`argparse.ArgumentError`引发了（`assertRaises(argparse.ArgumentError, parser.parse_args(inargs.split()))`）。问题是 argparse 似乎正在捕获 ArgumentError 并引发一般错误，从而阻止我验证失败的原因。我错过了什么吗？

这是回溯：

```
Error
Traceback (most recent call last):
  File "/Users/markebbert/PyCharmProjects/newproject/unittests.py", line 203, in test_set_operation_parameter
    self.assertRaises(argparse.ArgumentError, parser.parse_args(inargs.split()))
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/argparse.py", line 1688, in parse_args
    args, argv = self.parse_known_args(args, namespace)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/argparse.py", line 1727, in parse_known_args
self.error(str(err))
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/argparse.py", line 2347, in error
    self.exit(2, _('%s: error: %s\n') % (self.prog, message))
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/argparse.py", line 2335, in exit
    _sys.exit(status)
SystemExit: 2 
```

这是我定义的自定义类型和解析器代码：

```
class RegexValidator(object):
    """
    Performs regular expression match on value.
    If match fails an ArgumentError is raised
    """

    def __init__(self, pattern, statement=None):
        self.pattern = re.compile(pattern)
        self.statement = statement
        if not self.statement:
            self.statement = "must match pattern %s" % self.pattern

    def __call__(self, string):
        match = self.pattern.search(string)
        if not match:
            raise argparse.ArgumentError(None, self.statement)
        return string

operatorRV = RegexValidator(
    "^((\w+)=)?[iIuUcC]\[(\w+(\[\w+(,\w+)*\])?)(:\w+(\[\w+(,\w+)*\])?)*\]$",
    "Set operations must conform to...")

parser = argparse.ArgumentParser(
    description='Compare variants across individuals',
    formatter_class=argparse.ArgumentDefaultsHelpFormatter)

group.add_argument('-s', '--set-operation', dest='operation', nargs='+',
                   type=operatorRV,
                   help="blah.") 
```

这是单元测试：

```
 # Fail for ending colon
    inargs = "-s out=i[one[id1]:]"
    self.assertRaises(argparse.ArgumentError, parser.parse_args(inargs.split())) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T21:13:05.670

Argparse 是一个命令行解析器，错误总是以调用 结尾`argparse.exit()`，而后者又以`sys.exit()`错误代码调用。这是设计使然。

`.error()`对于单元测试，您必须对解析器的或方法进行monkeypatch（也许使用模拟）`.exit()`。`.error()`使用错误消息调用并打印使用消息，然后`.exit()`使用退出代码和错误消息调用。

他们当前的实现：

```
# ===============
# Exiting methods
# ===============
def exit(self, status=0, message=None):
    if message:
        self._print_message(message, _sys.stderr)
    _sys.exit(status)

def error(self, message):
    """error(message: string)

    Prints a usage message incorporating the message to stderr and
    exits.

    If you override this in a subclass, it should not return -- it
    should either exit or raise an exception.
    """
    self.print_usage(_sys.stderr)
    self.exit(2, _('%s: error: %s\n') % (self.prog, message)) 
```

# javascript - 画布绘图 Flickring

> ID：15691764
> 
> 赞同：0
> 
> 时间：2013-03-28T20:43:05.963
> 
> 标签：javascript, canvas, drawing

我希望有绘画经验的人能帮助我弄清楚为什么在下面的例子中，我偶尔会看到点闪烁。我在这里不知所措。感谢您提供任何可能的建议。

[http://codepen.io/mikefowler/pen/fLHAB](http://codepen.io/mikefowler/pen/fLHAB)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:32:35.403

您`newOpacity`有时是如此之小，以至于像`9.444794391022526e-9`newOpacity这样的数字`'rgba(r,g,b,a)'`很可能会解析错误，因为您正在那里创建一个字符串。您可以使用自定义`Math.round()`，但由于您使用的是字符串，您可以做一个简单的

```
newOpacity = newOpacity.toFixed(2); 
```

或者，您可以使用任何您想要的小数位数，而不是 2，在小数点后第三位之后，您无论如何都不会看到 alpha 的差异。

# c# - Powershell StreamWriter 中的 C#

> ID：15691766
> 
> 赞同：0
> 
> 时间：2013-03-28T20:43:15.733
> 
> 标签：c#, powershell-2.0

我有一个 Powershell 脚本，其中删除了一些 C# 代码。该代码对文件进行正则表达式搜索，如果找到匹配项，则将其写入数据表，该数据表返回给 Powershell 以进行进一步处理。在我添加 StreamWriter 写入行之前，一切正常。一旦我这样做，脚本就会完全爆炸。这是代码片段。我已经标记了破坏脚本的行。知道为什么这可能会在这里发生吗？如果我注释掉那一行，脚本就可以正常工作。

```
Regex reg = new Regex(regex);
using (StreamReader r = new StreamReader(SFile))
{
    string revisedfile = FileName.txt
    string line;                
    while ((line = r.ReadLine()) != null)
    {
        using (StreamWriter writer = new StreamWriter(revisedfile, true))
        {                        
            // Try to match each line against the Regex.
            Match m = reg.Match(line);
            if (m.Success) 
            {   
                DateTime result;
                if (!(DateTime.TryParse(m.Groups[0].Value, out result)))
                {
                    // add it to the DT                            
                    MatchTable.Rows.Add(x, m.Groups[0].Value, line);

                    // write it to the "revised" file
                    writer.WriteLine(reg.Replace(line, match => DateTime.Now.ToString("MM-dd-yyyy"))); // this is the line that blows it up
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T18:36:38.407

今天遇到了同样的问题。StreamWriter 不使用 powershell 所在的当前目录。默认情况下，StreamWriter 在此命令返回的目录中创建文件：

```
[IO.Directory]::GetCurrentDirectory() 
```

这将返回打开 powershell 的目录，而不是运行脚本的目录。让它工作的最好方法，我使用的方法，是把它作为脚本的第一行：

```
[IO.Directory]::SetCurrentDirectory($pwd) 
```

这会将流写入器文件输出定向到当前工作目录。您可以将 $pwd 替换为您希望的任何其他目录，但请记住，如果它是一个相对目录，则该文件将放置在相对于 getcurrentdirectory 返回的目录的该目录中。

呸！

# c# - MediaElement 不播放 mp3 或 wav

> ID：15691769
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:43:19.563
> 
> 标签：c#, windows-phone-7, mp3, wav, mediaelement

*我想在页面加载时播放声音。我在名为“媒体”的组件中创建了一个 MediaElement。我根据需要更改了设置，当我运行项目时，没有发生。我听不到音乐。XAML : C# : media.Play();*

**解决方案：只需勾选 Capabilities 中的 ID_CAP_MEDIALIB。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T11:09:32.523

您的音频文件是否放置在根级别？无论如何将源更改为 001.mp3 并让我知道。还有一个建议是让您的媒体停止播放任何其他元素。所以尝试编辑这个

```
media.stop();
media.Volume=20;
media.Play(); 
```

您尝试的完整路径是什么？只需向我们展示更多代码，以帮助您...在 Visual Studio 中快速了解文件的排列方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T15:52:54.493

**已解决：我解决了这个问题。我只是在 Capabilities 中勾选 ID_CAP_MEDIALIB。麻烦您了。**

# python - Python子进程未正确执行程序

> ID：15691771
> 
> 赞同：3
> 
> 时间：2013-03-28T20:43:25.337
> 
> 标签：python, subprocess

我正在尝试在 Python 的 shell 中执行 Fortran 程序。我`subprocess`用来调用 Fortran 程序并传递参数（需要两个输入文件）。我就是这样做的：

```
COMMAND = '/path/to/FORTRAN/program << !\n' + INPUT_FILE1 + '\n' + INPUT_FILE2 +'\n!'
return = subprocess.call(COMMAND, shell=True) 
```

不幸的是，Fortran 程序退出时：

```
? FORTRAN Runtime Error:
? Attempt to read past end of file
? READ(UNIT=22,... 
```

这**不是**输入文件或 Fortran 程序的问题。当我在我的 shell 中执行此操作时：

```
$>/path/to/FORTRAN/program << !
>INPUT_FILE1
>INPUT_FILE2
>! 
```

一切都按预期工作（否`Attempt to read past end of file`）。

我无权访问 Fortran 源，所以我无法检查那里发生了什么。我认为这与我调用程序的方式有关`subprocess`——我只是不知道是什么。

我正在使用 Python 2.6.6。

快速解释：Fortran 程序将提示输入两个输入文件，但它不会将它们识别为命令行选项（不能在调用程序时提供它们）。如果你想运行它——比如说一个 shell 脚本（批处理模式）——你需要捕获返回命令来执行命令，还要提供这两个文件。`<< !`由于缺少更好的术语，因此打开了一个“列表”。以下命令被传递给程序，该程序等待执行，直到`!`输入。

我已经多次成功地使用了这种方法（不同的 Fortran 代码），并且在这个方法中，使用了[C shell](https://en.wikipedia.org/wiki/C_shell)脚本（不是 Python）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:54:36.107

`shell=True`如果它没有`bash`在您的系统上调用，可能是由调用的 shell 引起的。您可以避免依赖扩展的 shell 语法`<<`，而是自己构建整个调用，如下所示：

```
popen = subprocess.Popen(["/path/to/FORTRAN/program"], stdin=subprocess.PIPE)
popen.stdin.write('123\n')
time.sleep(0.1)    # hack, following LAK's suggestion
popen.stdin.write('456\n')
popen.stdin.close()
result = popen.wait() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T20:18:19.020

不久前我遇到了类似的问题，结果证明是添加了一个小暂停。看看[这个](https://stackoverflow.com/questions/9740887/controlling-puttygen-with-popen)，看看这个技术是否有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-16T15:31:39.597

您可以尝试`"\r\n"`（tty 换行符）：

```
from subprocess import Popen, PIPE

p = Popen(["/path/to/FORTRAN/program"], stdin=PIPE,
          bufsize=1, close_fds=True)
p.communicate("INPUT_FILE1\r\nINPUT_FILE2")
rc = p.returncode 
```

最后有/没有`"\r\n"`。

# google-chrome - 您可以利用操作系统特定的桌面浏览器手势吗？

> ID：15691772
> 
> 赞同：0
> 
> 时间：2013-03-28T20:43:31.933
> 
> 标签：google-chrome, google-chrome-extension, safari, gesture, safari-extension

不，这样做不是一个好主意，但仍然是一个真正的问题。

例如，谷歌浏览器允许 OSX 用户来回滑动以在页面之间来回移动。像这样的东西。在移动设备上，您可以将这些手势用于您的应用程序，所以我想知道是否有办法为桌面浏览器做同样的事情。

也许甚至可以编写一个能够利用这些控件的插件？

# linux - 反向引用正则表达式 Unix

> ID：15691773
> 
> 赞同：2
> 
> 时间：2013-03-28T20:43:33.677
> 
> 标签：linux, unix, grep

我真的不明白如何使用这些反向引用。让我给你举个例子：

```
grep '\([a-z]\)\([a-z]\)[a-z]\2\1' 
```

前面的指令在文件中查找回文词。但我不明白它是如何工作的？所有这些是怎么回事`\2\1`，为什么不是`\1\2`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T20:49:16.903

简单举例说明：

`\2\1`将匹配如下文本：`foxof`

这里：

```
f o  x  o  f
| |     \2 \1
| |_2
|
|_1 
```

`\1\2`将匹配如下文本：`foxfo`

所以你会看到不同的

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-28T20:48:13.703

\1 是括号内的第一个匹配项 \2 是第二个匹配项

所以你在寻找

```
(any char)(another char)[a middle char](the second char again)(the first char again)
  ([a-z])    ([a-z])        [a-z]               \2                   \1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T20:46:04.860

“\2”引用第二对括号，“\1”引用第一对。它是“\2\1”而不是“\1\2”，否则它就不是回文。

# javascript - Kendo 网格组合框将未定义的数据发送到 DataSource

> ID：15691774
> 
> 赞同：3
> 
> 时间：2013-03-28T20:43:39.380
> 
> 标签：javascript, kendo-ui, kendo-grid

我有一个剑道网格，其中有一列使用组合框，该组合框绑定到一个名为“Worker”（ID，Workername）的对象。这可以正常工作，除非用户将组合框文本设置为与任何下拉选项都不匹配的字符串（例如：'xxxx'）。组合框将 Worker 的值设置为字符串 ('xxxx') 而不是 Worker 对象，此时 dataSource 在收到格式错误的数据时停止响应。

我已经让它在 dataSource 'change' 事件中工作，该事件在网格的 'save' 事件之后触发。有问题的 dataItem 的属性被变量 myWorkerStart 覆盖（在网格的编辑事件中捕获）：

```
myDataSource.bind("change", function (e) {
        if (e.field) {
            if (e.field == "Worker") {           
                rowDataItem = myGrid.dataItem(myGrid.tbody.find("tr.k-grid-edit-row"));
                var currentWorker = rowDataItem.Worker;
                var myType = $.type(currentWorker);
                if (myType != "object") {
                    alert('Ooooh, BAD worker, reverting to starting value');
                    rowDataItem.set('Worker', myWorkerStart);
                }
            }
        }
        alert("datasource change");
}) 
```

我在 Telerik 论坛的几个主题中看到了这个主题，但大多没有答案。Telerik 支持告诉我，我应该解决网格的“保存”事件中未定义的值，但在组合框设置行之前触发。我可以看到这些值，但我不确定可以在哪里设置这些值以防止将未定义的值发送到数据源（容器、模型） 在发送未定义的组合框值之前是否有更好的方法来解决格式错误的数据到电网？

```
myGrid.bind("save", function (e) {
        myCombo = $('#Worker').data("kendoComboBox");
        rowDataItem = myGrid.dataItem(myGrid.tbody.find("tr.k-grid-edit-row"));          
        myPreviousWorker = e.model.Worker;//Worker previously
        myNewWorker = myCombo.dataItem();//Worker about to be set by selected Combobox.
        if (myNewWorker) {
            alert("GOOD worker");
        } else {
            alert("BAD worker");
        }
        //Manipulate the combobox/container/model values
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T14:54:45.257

[Petur Subev](https://stackoverflow.com/users/332124/petur-subev)能够提供这个答案：[jsbin](http://jsbin.com/edamuj/649/edit "带有组合框批量保存的剑道网格")

在具有“批量”保存的网格的示例中，网格的“保存”事件检查组合框中未定义的选择，然后绑定一次 (jquery .one()) 到模型的更改事件以在保存期间设置所需的值仅当组合框选择未定义时。

```
http://jsbin.com/edamuj/649/edit

//grid configuration setup
save:function(e){          
       if(!e.container.find('[data-role=combobox]').data().kendoComboBox.dataItem())
       {
         e.model.one('change',function(e){
             this.set('test',{CategoryName:"Bevarages",CategoryID: "001"}) 
         }) 

       }

       this.refresh();
    } 
```

下面的示例对于没有批量保存的网格（例如内联编辑）只需要在网格保存时触发，不需要对模型更改进行额外绑定。Petur 的其他[jsbin](http://jsbin.com/edamuj/634/edit "具有内联编辑非批量保存的剑道网格")

```
save:function(e){
       if(!e.container.find('[data-role=combobox]').data().kendoComboBox.dataItem())
       {
           e.model.set('test',{CategoryName:"Bevarages",CategoryID: "001"})
       }

       this.refresh();
    } 
```

# cakephp - CakePHP - 通过链接删除数据的问题

> ID：15691780
> 
> 赞同：1
> 
> 时间：2013-03-28T20:43:58.740
> 
> 标签：cakephp

我正在使用 cakephp 2.3.0。我要做的是让用户单击一个链接（以图像的形式），并且该用户操作将从该用户的数据库中删除一些数据。

在我看来，我有这个代码片段，它实际上是表格中的一列。对于“删除”这个词，我希望它是一个图像（使用 $this->Html->image()），但 cakephp 抱怨这一点。根据 API，该参数只能是字符串。

```
$this->Form->postLink(
                'delete', 
                array('action' => 'deleteActivity', $myActivity['Activity']['id']),
                array('confirm' => 'Are you sure?')), 
```

这是我正在尝试的控制器中的功能：

```
public function deleteActivity($id) {

        if ($this->Post->delete($id)) {             
            $this->Session->setFlash('The activity with id: ' . $id . ' has been deleted.');
            $this->redirect(array('action' => 'landingPage'));
        }
    } 
```

我收到以下错误。似乎用 post 包装表单标签是行不通的。在 CakePHP 中，我正在尝试做的最佳实践方式是什么？

致命错误

错误：在非对象上调用成员函数 delete()

这是生成的 HTML：

```
<td><form action="/activities/index.php/activities/deleteActivity/4"      name="post_515496f40ca77" id="post_515496f40ca77" style="display:none;" method="post">    <input type="hidden" name="_method" value="POST"/></form><a href="#" onclick="if (confirm(&#039;Are you sure?&#039;)) { document.post_515496f40ca77.submit(); } event.returnValue = false; return false;">delete</a></td> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:57:32.917

**错误：**

该错误基本上是说“嘿，没有`Post`对象这样的东西，所以我们不确定如何处理您尝试访问的这个'删除'方法”（换句话说，`Post`模型尚未加载）

**进一步解释/解决方案：**

除了您当前所在的控制器之外，您本质上无法访问模型。

所以在你的情况下，你不能直接访问`Post`模型而不加载它：

```
$this->loadModel('Post');
$this->Post->delete($id); 
```

或者，如果它与当前模型相关联（例如`Activity`），您可以通过以下方式访问它：

```
$this->Activity->Post->delete($id); 
```

# python - 如何在 Kivy 中创建键绑定 (Ctrl + O)？

> ID：15691782
> 
> 赞同：0
> 
> 时间：2013-03-28T20:44:08.603
> 
> 标签：python, kivy

我想在 Kivy (Ctrl + O) 中创建一个可以附加事件的键绑定。我看到 Kivy Inspector 模块正在做类似的事情，但我不确定如何复制该功能。

我想在所有 Kivy 应用程序上进行键绑定工作，所以我猜它必须绑定到窗口/根小部件。

有没有人这样做过？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T23:08:58.317

正如您所说，检查器模块完全符合您的要求，所以您不打开代码并找出答案吗？毕竟是 Python :)。

这是文件[inspector.py](https://github.com/kivy/kivy/blob/master/kivy/modules/inspector.py)

搜索`ctrl`检查员使用的快捷方式是 'ctrl+e' get's us [this](https://github.com/kivy/kivy/blob/master/kivy/modules/inspector.py#L339) .::

```
def keyboard_shortcut(self, win, scancode, *largs):
    modifiers = largs[-1]
    if scancode == 101 and modifiers == ['ctrl']:
        self.activated = not self.activated
        ...
        ...
        ... 
```

似乎这是在听键盘并检查输入是否匹配'ctrl'和'e'

```
if scancode == 101 and modifiers == ['ctrl']: 
```

但是我们不知道如何/从哪里调用这个函数？所以让我们搜索函数名::

```
 `keyboard_shortcut` 
```

我们得到[这个](https://github.com/kivy/kivy/blob/master/kivy/modules/inspector.py#L475)。

```
win.bind(children=ctx.inspector.on_window_children,
        on_keyboard=ctx.inspector.keyboard_shortcut) 
```

win 是 window 的一个实例，因为我们要全局绑定到键盘快捷键，我们将绑定到`on_keyboard`Window 的事件。

Window的这个`on_keyboard`事件是什么？让我们在 kivy 文档中[搜索。`window`](http://kivy.org/docs/search.html?check_keywords=yes&area=default&q=window#)

第四个链接[kivy.core.window.Keyboard](http://kivy.org/docs/api-kivy.core.window.html?highlight=window#kivy.core.window.Keyboard)（Python 类，在 Window 中）似乎很有趣。在该链接之后，他们似乎甚至有一个使用 Window.keyboard 的示例，并在[此处](http://kivy.org/docs/api-kivy.core.window.html?highlight=window#kivy.core.window.WindowBase)`on_keyboard`解释了该事件。

按照上面的所有资源，您应该能够全局绑定到快捷方式以便对其做出反应。

希望这是有帮助的。

# python - 在 Django 中检索通用外键关系的“多”端

> ID：15691790
> 
> 赞同：19
> 
> 时间：2013-03-28T20:44:26.943
> 
> 标签：python, django, tastypie

在 Django 中，当我请求具有多对多关系的资源时，我最终会获得关系的子部分中的*所有项目，即使是那些与父级没有直接关系的项目。*如果我向您展示代码会更容易（精简类以仅显示必要的内容）：

### 楷模

```
class Report(models.Model):
    name = models.CharField(max_length=255)
    slug = AutoSlugField(_('slug'), populate_from='name')
    wells = models.ManyToManyField(Well, null=True)
    uuid = UUIDField(editable=False, blank=True, version=4, unique=True)

class Well(models.Model):
    slug = AutoSlugField(_('slug'), populate_from='name')
    name = models.CharField(max_length=255)

class Node(models.Model):
    @property
    def well(self):
        raise NotImplementedError("The 'well' field must be implemented")
    //irrelevant GFK omitted
    page_content_type = models.ForeignKey(ContentType, null=True, blank=True, related_name='page')
    page_object_id = models.PositiveIntegerField(blank=True, null=True)
    page_content_object = generic.GenericForeignKey('page_content_type', 
     'page_object_id') 
```

### 资源

```
class ReportResource(ModelResource):
    wells = fields.ManyToManyField(WellResource, 'wells', full=True)
    stock = fields.ForeignKey(TickerResource, 'stock', full=True)

    class Meta:
        queryset = Report.objects.all()
        resource_name = 'ticker_reports'

class WellResource(ModelResource):
    nodes = fields.ToManyField('wells.api.NodeResource', 'nodes', full=True)
    type = fields.ForeignKey(WellTypeResource, 'type', full=True)

    class Meta:
        queryset = Well.objects.all()
        resource_name = 'wells'

class NodeResource(ModelResource):
    order = fields.IntegerField()
    content_object = GenericForeignKeyField({
                                                Content: UUIDOnlyContentResource
                                            }, 'content_object', full=True)

    class Meta:
        queryset = Node.objects.all()
        resource_name = 'nodes'
        filtering = {
            'ticker_report': ALL_WITH_RELATIONS
        } 
```

一个 Ticker Report 有许多 Wells，这些 Wells 在所有 Ticker Reports 中共享。不同的是你可以将 Nodes 绑定到 Wells；对于给定的代码报告，应该显示的唯一节点是与该代码报告相关的节点。

因此，对于给定的股票报告和一组井，只应显示与该股票报告共享该 GenericForeignKey 的节点。

关系：

`page_object_id`, `page_content_object`,`page_content_type`是与 Report 的 GenericForeignKey 关系

目前，显示所有节点（这是一个错误）。

在 TastyPie 中，我如何告诉它只显示相关对象而不是所有对象？

这是一个简短的 python 控制台，更简洁地显示了问题：

```
>>> r = Report.objects.get(id=1)                                                                                                        
>>> for well in r.wells.all():                                                                                                          
...     for node in well.nodes.all():                                                                                                   
...         print 'Node in Well {0} is {1}'.format(well, node)                                                                          
...                                                                                                                                     
Node in Well The Areas You Must Watch (the-areas-you-must-watch - Fancy List) is Apple Content #1:Apple (0)                             
Node in Well The Areas You Must Watch (the-areas-you-must-watch - Fancy List) is First Solar Content #1:first solar (0)                 
Node in Well Risks (risks - Headline and Lead) is Apple Content #2:Apple (0)                                                            
Node in Well Risks (risks - Headline and Lead) is First Solar Content #2:first solar (0)                                                
>>> 
```

### SQL 实际输出

```
SELECT node.id, node.uuid, node.order,node.content_type_id, node.object_id,
       node.page_content_type_id, node.page_object_id, node.well_id FROM node 
WHERE node.well_id = 1  
ORDER BY node.order ASC 
```

（已修改以使其更易于阅读）

### 预期的 SQL 输出：

```
SELECT node.id, node.uuid, node.order,node.content_type_id, node.object_id,
       node.page_content_type_id, node.page_object_id, node.well_id FROM node 
WHERE node.well_id = 1  AND node.page_content_type_id = 99 /*Report Content TypeID */ AND node.page_content_object_id = 1 /*ReportID*/
ORDER BY node.order ASC 
```

### 预期输出：

```
Node in Well The Areas You Must Watch is Apple Content #1
Node in Well Risks is Apple Content #2:Apple (0) 
```

如何过滤掉与 Django 和 TastyPie 的多对多关系的子端（尽管这个问题在没有 TastyPie 的情况下也很明显，让我相信这是一个结构性问题）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T13:16:15.783

执行查询时

```
well.nodes.all() 
```

这会通过您在模型中描述的关系获取*所有*相关的节点。`well`

听起来好像您想将返回的节点限制为通过通用外键关系引用`Report`对象的节点。是对的吗？如果是，那么您需要显式过滤节点，如下所示：`r``page_content_object`

```
r = Report.objects.get(id=1)
for well in r.wells.all():                                                                                                          
    for node in well.nodes.filter(page_object_id = r.id,
                                  page_content_type = ContentType.objects.get_for_model(r)):
        # ... 
```

更新：我对 TastyPie 一无所知，我不得不说我不太了解您要做什么，但是在 Django 中，如果井和节点之间存在关系，那么您需要将其添加到你的模型。例如，如果每个都`Node`恰好属于一个`Well`，那么很自然的做法就是在模型中添加一个字段`Node`：

```
class Node(models.Model):
    # ...
    well = models.ForeignKey('Well') 
```

然后如果你想找到属于属于特定`Report`对象的井的所有节点`r`，所述节点也`r`通过通用外键关系引用，你会发出查询：

```
 Node.objects.filter(well__report = r,
                     page_object_id = r.id,
                     page_content_type = ContentType.objects.get_for_model(r)) 
```

如果您必须经常这样做，那么很自然的事情就是在`Report`模型上添加一个方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T02:06:34.613

> 一个 Ticker Report 有许多 Wells，这些 Wells 在所有 Ticker Reports 中共享。不同的是你可以将 Nodes 绑定到 Wells；对于给定的代码报告，应该显示的唯一节点是与该代码报告相关的节点。
> 
> 在 Django 中，当我请求具有多对多关系的资源时，我最终会获得关系的子部分中的所有项目，即使是那些与父级没有直接关系的项目。如果我向您展示代码会更容易（精简类以仅显示必要的内容）：

如果我理解正确，该节点可以与报告或井相关（因为您提到**与该 Ticke Report 相关**）。您正在寻找**与报告相关**的节点，而不是与报告**的井相关的节点**。（因为您正在寻找与父级直接相关的节点（报告？））

如果我是正确的，这很简单：

[https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#reverse-generic-relations](https://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/#reverse-generic-relations)

```
class Report(models.Model):
    name = models.CharField(max_length=255)
    slug = AutoSlugField(_('slug'), populate_from='name')
    wells = models.ManyToManyField(Well, null=True)
    uuid = UUIDField(editable=False, blank=True, version=4, unique=True)

    nodes = generic.GenericRelation(Node)

# usage
r = Report.objects.get(id=1)
nodes = r.nodes.all() 
```

# zend-framework - index.php 文件中 defined('APPLICATION_PATH') 的用途是什么？

> ID：15691793
> 
> 赞同：0
> 
> 时间：2013-03-28T20:44:35.113
> 
> 标签：zend-framework

我是 Zend 框架的新手，所以问了一个基本问题，我无法找到 index.php 中定义的（'APPLICATION_PATH'）的用法，因为这个文件首先加载，所以 APPLICATION_PATH 必须在此处且仅在此处定义..

```
// Define path to application directory

defined('APPLICATION_PATH')
    || define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/application')); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:52:58.183

APPLICATION_PATH 是全局常量，它在文件系统中定义 Zend Framework 应用程序的绝对路径。

**编辑：**这个常量可以已经在*htaccess*文件中预定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T12:22:32.247

[已定义](http://php.net/manual/en/function.defined.php)，是一个布尔值。

此行检查是否`'APPLICATION_PATH'`存在和 isset，如果不存在，则该行的其余部分将定义常量。

```
//if APPLICATION_PATH is not set then define the APPLICATION_PATH
defined('APPLICATION_PATH')
     or define('APPLICATION_PATH', realpath(dirname(__FILE__) . '/application')); 
```

这允许在某些情况下可能需要某种外部配置文件（xml、.htaccess ...）来设置应用程序空间。

# ios - iOS Time Profiler 方法执行次数

> ID：15691795
> 
> 赞同：1
> 
> 时间：2013-03-28T20:44:40.897
> 
> 标签：ios, performance, profiler

我一直在尝试对应用程序进行时间分析。完成后，我会搜索符号或函数。如果该符号仅被调用 2 次，我可以在堆栈跟踪中看到它，在 main 之后的树中某个位置。但是，如果我选中 Top Function 框，我会多次看到该符号。我现在很困惑。那么我怎么知道一个函数或方法被调用了“x”次，以便我可以计算该函数或方法的总执行时间。

任何帮助将非常感激。

# android - init_module '/path/to/module.ko' 失败

> ID：15691796
> 
> 赞同：6
> 
> 时间：2013-03-28T20:44:43.053
> 
> 标签：android, insmod

我正在尝试通过以下方式启动驱动程序模块

```
insmod path/to/module.ko 
```

我收到以下错误

```
> init_module 'path/to/module.ko' failed <File exists> 
```

我试图了解这是否意味着模块已经启动并运行，或者它是否完全无法初始化。

我正在寻找 的含义`<File exists>`，这是否意味着它已经初始化？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-28T21:00:08.993

这意味着该模块已经加载。检查 的输出`lsmod`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-21T00:16:48.260

我相信这里的问题是内核是从由 android rom 引导的只读分区运行的。尝试插入wifi模块时，我也遇到了类似的问题。即，如果您的输出类似于：

```
root@stackoverflow:~# insmod rkwifi.ko
Error: could not insert module rkwifi.ko: File exists
root@stackoverflow:~# lsmod | grep rkwifi
root@stackoverflow:~# lsmod
Module                  Size  Used by
fbcon                  34211  66
font                    7042  1 fbcon
bitblit                 3708  1 fbcon
softcursor               880  1 bitblit
wlan                  458451  0
rk30xxnand_ko         314328  0
root@stackoverflow:~# 
```

我的设置是一个运行 3.0.36+ 内核的 debian 的 android 电视盒在我的情况下，从源代码下载和修改内核是必要的。然后，您可以将内核打包备份，并为您的设备使用适当的刷写工具，仅将内核分区刷回设备，而不修改文件系统。

# javascript - 带有内部和外部脚本的脚本块会发生什么？

> ID：15691799
> 
> 赞同：0
> 
> 时间：2013-03-28T20:45:01.993
> 
> 标签：javascript

可能已经回答了，但我不能轻易找到它。

情况1：

```
<script type="text/javascript" src='external'>
    'Some script here'
</script> 
```

案例二：

```
<script type="text/javascript" src='external'></script>
<script type="text/javascript">
    'Some script here'
</script> 
```

因此，在情况 1 中，是否首先加载 src lib，以便您可以在内部脚本块中使用它？我试过了，显然，它不起作用。（我所做的是存储一个变量，但它不起作用）

如果它应该工作，它与案例2有什么不同吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T20:47:11.690

当存在“src”属性时，页面内脚本内容将被忽略。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T20:47:11.207

案例 1 不正确。情况 2 取决于您的外部脚本中是否有同步或异步代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-28T20:47:51.000

src 该属性指定外部脚本的 URI；这可以用作直接在文档中嵌入脚本的替代方法。指定了 src 属性的脚本元素不应在其标签中嵌入脚本。

[https://developer.mozilla.org/en-US/docs/HTML/Element/script](https://developer.mozilla.org/en-US/docs/HTML/Element/script)

# mysql - 左连接的教义查询 Mysql 语法错误

> ID：15691800
> 
> 赞同：0
> 
> 时间：2013-03-28T20:45:03.213
> 
> 标签：mysql, symfony, doctrine, left-join, dql

## 介绍

我在这里遵循本指南，我被困在最后一部分：[http ://symfony.com/doc/2.0/cookbook/security/entity_provider.html](http://symfony.com/doc/2.0/cookbook/security/entity_provider.html)

我正在尝试从帐户表中查询并加入组表。它与中间表 account_group 是多对多关系。

```
account Table Fields: id, firstName, and email

account_group Table Fields: account_id and group_id

group Table Fields: id, name, and role 
```

## 问题

这是我的 DQL：

```
 SELECT a.firstName, g.role
        FROM WikiRosterMainBundle:Account a
        LEFT JOIN a.groups g
        WHERE a.email = :email 
```

我收到内部服务器错误：

执行 'SELECT a0_.id AS id0, a0_.firstName AS firstName1, a0_.email AS email3, g1_.role AS role18 FROM account a0_ LEFT JOIN account_group a2_ ON a0_.id = a2_.account_id LEFT JOIN group g1_ ON 时发生异常g1_.id = a2_.group_id 在哪里 a0_.email = ？带参数 {"1":"test@test.com"}：

SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'group g1_ ON g1_.id = a2_.group_id WHERE a0_.email = 'test@test.com'' 附近使用正确的语法

## 我试过的：

+向 account_group 表添加主键（无效）

+编写我自己的左连接 mysql 查询并在 phpmyadmin 中输入（使用单个左连接，但当我尝试连接 3 个表时失败）

+翻转我正在加入/从中选择的表格

## 我做过的研究

似乎在 mysql 5 中左连接发生了变化。我查看了文档和其他堆栈溢出问题：

[http://dev.mysql.com/doc/refman/5.0/en/join.html](http://dev.mysql.com/doc/refman/5.0/en/join.html)

[5.0.12 更改后的 MySQL LEFT JOIN - 如何重写查询](https://stackoverflow.com/questions/700779/mysql-left-join-after-5-0-12-changes-how-to-rewrite-query)

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:43:00.540

基本问题是 group 是 sql 中的保留工作（又名 GROUP BY）。可以使用反引号解决此问题，但最好将表重命名为其他名称，例如 groupx。您可以将实体保留为组，只需更改表名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T21:52:34.870

如上所述，最大的问题是命名表`Group`。每次引用它时都需要使用反引号。我宁愿避开它们，但这是你的决定。以下是加入的方法：

```
SELECT a.FirstName, g.Role
FROM Account a
LEFT JOIN account_group ag ON a.id = ag.account_id
LEFT JOIN `group` g ON ag.group_id = g.id 
```

# screen - 我如何在 VideoView 中拉伸视频 - Android

> ID：15691801
> 
> 赞同：2
> 
> 时间：2013-03-28T20:45:11.340
> 
> 标签：screen, fullscreen, android-videoview, stretch

每次我在屏幕上播放电影时，我都会看到两侧有白色条纹。如何拉伸电影以适应屏幕？？？

我到处都看到以下代码：

```
android:layout_alignParentTop="true"
android:layout_alignParentBottom="true"
android:layout_alignParentLeft="true"
android:layout_alignParentRight="true" 
```

但它没有拉伸电影，它只拉伸了 VideoView，我仍然看到侧面的白色条纹。

# c - 生成一个 N 位的随机整数？

> ID：15691802
> 
> 赞同：3
> 
> 时间：2013-03-28T20:45:19.693
> 
> 标签：c, bit-manipulation

我正在尝试编写一个基于随机生成的指令集的简单虚拟机。在 C 中，生成包含**N 位**集的随机位掩码的最佳方法是什么（与生成随机整数不同，因为不能保证其中设置了 N 位）。我需要它适用于 16 位和 32 位整数。

**编辑：**它必须**恰好**设置 N 位。**正是**。不多。而且不少。**正好**设置了 N 位。它不必非常安全，也不必从宇宙噪声中获取熵。它必须是伪随机的。

这就是我真正想要实现的目标：

```
uint32_t rand_bits_32(size_t reqBits)
{
    /* blah */
}

uint16_t rand_bits_16(size_t reqBits)
{
    /* blah */
}

extern char *int2bin(uint32_t n, char *buf);

uint16_t gen_mask_16_excl_32(uint32_t* exclude, size_t exclude_count, size_t bits_required)
{
    uint32_t ret = 0;

    while (1) {
        bool has = false;
        ret = (uint32_t)rand_bits_16(bits_required);

        for (size_t i = 0; i < exclude_count; i++) {
            if (ret & (uint32_t)exclude[i]) {
                has = true;
                break;
            }
        }

        if (!has) {
            break;
        }

        has = false;
    }

    return ret;
}

uint32_t gen_mask_32(uint32_t* exclude, size_t exclude_count, size_t bits_required)
{
    uint32_t ret = 0;

    while (1) {
        bool has = false;
        ret = rand_bits_32(bits_required);

        for (int i = 0; i < exclude_count; i++) {
            if (ret & (uint32_t)exclude[i]) {
                has = true;
                break;
            }
        }

        if (!has)
            break;

        has = false;
    }

    return ret;
} 
```

我生成随机位，然后`AND`对现有位掩码进行暴力破解，直到没有位匹配，因此我可以生成具有 N 个位的位掩码，并且没有其他位掩码共有的位。是的，这段代码很糟糕，在 x86_64 上会中断。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T22:08:28.693

我根据 Steve Emmerson 的想法松散地写了一个 C99 实现。你可以看到它[在 ideone 运行](http://ideone.com/GQmX4t)。

除非出现任何错误，`randto()`否则`shuffle()`这应该可以满足您的要求。

```
#include <stdint.h>
#include <stdlib.h>

static int randto(int n) {
  int r;
  int maxrand = (RAND_MAX / n) * n;
  do r = rand(); while (r >= maxrand);
  return r % n;
}

static void shuffle(unsigned *x, size_t n) {
  while (--n) {
    size_t j = randto(n + 1);
    unsigned tmp = x[n];
    x[n] = x[j];
    x[j] = tmp;
  }
}

uint16_t nrand16(int n) {
  uint16_t v = 0;
  static unsigned pos[16] = {0, 1,  2,  3,  4,  5,  6,  7,
                             8, 9, 10, 11, 12, 13, 14, 15};
  shuffle(pos, 16);
  while (n--) v |= (1U << pos[n]);
  return v;
}

uint32_t nrand32(int n) {
  uint32_t v = 0;
  static unsigned pos[32] = { 0,  1,  2,  3,  4,  5,  6,  7,
                              8,  9, 10, 11, 12, 13, 14, 15,
                             16, 17, 18, 19, 20, 21, 22, 23,
                             24, 25, 26, 27, 28, 29, 30, 31};
  shuffle(pos, 32);
  while (n--) v |= (1U << pos[n]);
  return v;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T21:19:03.170

像这样的东西可能会起作用

```
#include <stdlib.h>
#include <string.h>

unsigned long set_bits(
    unsigned size,       /** [in] Size of the integer in bits: 16, 32 */
    const unsigned nbits)/** [in] Number of bits to be set */
{
    unsigned pos[nbits];
    unsigned long result = 0;

    srand(time(NULL));

    for (unsigned i = 0; i < size; i++)
        pos[i] = i;

    for (unsigned i = 0; i < nbits; i++) {
        unsigned j = rand()%size--;

        result |= 1 << pos[j];

        (void)memmov(pos+j, pos+j+1, size-j);
    }

    return result;
} 
```

我没有测试过这个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-29T01:30:26.073

我最终选择了自己的实现。它似乎工作。

```
static bool prob(double probability)
{
    return rand() <  probability * ((double)RAND_MAX + 1.0);
}

uint32_t count_set_bits(uint32_t i)
{
    i = i - ((i >> 1) & 0x55555555);
    i = (i & 0x33333333) + ((i >> 2) & 0x33333333);
    return (((i + (i >> 4)) & 0x0F0F0F0F) * 0x01010101) >> 24;
}

uint32_t gen_mask_excl_32(size_t bits, uint32_t* exclude, size_t exclude_count, size_t bits_required)
{
    uint32_t excl_mask = 0;

    size_t mask_bit_count;
    size_t rem_bit_count;

    uint32_t out_mask = 0;

    if (exclude_count == 0) {
        /* pass */
        if (exclude != NULL) {
            abort();
        }
    }
    else {
        for (size_t i = 0; i < exclude_count; i++) {
            excl_mask |= exclude[i];
        }
    }

    mask_bit_count = count_set_bits(excl_mask);
    if (mask_bit_count == bits) {
        /* overflow! */
        abort();
    }
    rem_bit_count = bits - mask_bit_count;

retry:
    for (size_t i = 0; i < bits; i++) {
        unsigned re;

        if (( 1 << i ) & excl_mask || ( 1 << i ) & out_mask) {
            /* bit already set, skip */
            continue;
        }

        re = prob((double)1 / (double)rem_bit_count);
        if (re) {
            out_mask = ( 1 << i ) | out_mask;
            bits_required--;
        }

        if (bits_required == 0) {
            break;
        }
    }

    /* still stuff left */
    if (bits_required) {
        goto retry;
    }

    return out_mask;
}

uint16_t gen_mask_16_excl_32(uint32_t* exclude, size_t exclude_count, size_t bits_required)
{
    return (uint16_t)gen_mask_excl_32(16, exclude, exclude_count, bits_required);
}

uint32_t gen_mask_32(uint32_t* exclude, size_t exclude_count, size_t bits_required)
{
    return (uint32_t)gen_mask_excl_32(32, exclude, exclude_count, bits_required);
}

uint32_t rand_bits_32(size_t reqBits)
{
   return gen_mask_32(NULL, 0, reqBits);
}

uint16_t rand_bits_16(size_t reqBits)
{
    return gen_mask_16_excl_32(NULL, 0, reqBits);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-23T14:50:23.747

如果 RAN32() 返回带有随机位的随机 uint32_t，则下面的代码应该可以完成工作。这样的功能应该由您常用的随机数生成器提供。

```
uint32_t fixed_nb_bits(int b)
{
    if ( b > 31 )
        return ~0;
    uint32_t n = 0;
    while ( b > 0 )
    {
        uint32_t x = 1 << ( RAN32() % 32 );
        if (!( n & x ))
        {
            n += x;
            --b;
        }
    }
    return n;
} 
```

但是，此代码对于 ( b > 16 ) 不是最佳的，在这种情况下，最好只反转：

```
~fixed_nb_bits(32-b) 
```

# vb.net - 在 vb.net 中重命名和移动文件

> ID：15691803
> 
> 赞同：0
> 
> 时间：2013-03-28T20:45:22.870
> 
> 标签：vb.net

我正在尝试将字符串“XYZ”添加到每个文件名，然后将我的文件从文件夹 A 移动到文件夹 B。这是我到目前为止的代码。

* * *

```
Private Const varSourceAddress As String = "\\serverA\drivename\FolderA\"
Dim diaddr As New DirectoryInfo(varSourceAddress)
Dim fiaddr As FileInfo() = diaddr.GetFiles()

While diaddr.GetFiles.Length > 0
  For Each scannedFile As FileInfo In fiaddr
    If scannedFile.Name.Contains("Thumbs") = False Then
      If scannedFile.Exists Then
         strOldName = scannedFile.Name
         strNewName = strOldName.Insert(14, "XYZ")
         scannedFile.CopyTo("\\serverA\drivename\FolderB\" & strNewName, True)
         scannedFile.Delete()

         strOldName = ""
         strNewName = ""

      End If
     End If
    Next
  End While 
```

* * *

我在 Windows 服务中使用此代码。当服务第一次运行时，一切都按照预期的方式发生。它确实将 XYZ 添加到每个文件的名称中，并且文件也被移动到文件夹 B。但是，在第二次运行时，它会发送一条错误消息：

```
System.IO.FileNotFoundException: Could not find file '\\serverA\drivename\folderA\20130327082003.pdf'. 
```

我可以看到该文件`20130327082003.pdf`已被移动到文件夹 B，新名称为`20130327082003XYZ.pdf`文件夹 B，这一切都很好，但服务会不断检查文件夹 A 中的相同文件名。

我也尝试过重命名、移动、复制、复制到所有这些命令，但是系统不检查文件夹 A 中的新文件（如果有），而是继续检查已移动到文件夹 B 的文件。不知何故，循环不断引用它已重命名（并且已经移动）到文件夹B的最后一个文件。

一旦将文件复制到文件夹B，我正在使用`.Delete`方法删除文件（或任何引用），但这似乎没有任何区别。

一旦服务将运行，最终假设将文件夹A中生成的每个新文件（在其名称中添加XYZ之后）移动到文件夹B。

任何帮助将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:08:23.867

您有两个循环，一个在另一个，外部循环 (while) 继续，直到 GetFiles() 不再返回文件，但在内部循环中，您使用在`fiaddr` 循环外获得的变量。

我认为您的循环次数超出了必要

```
Private Const varSourceAddress As String = "\\serverA\drivename\FolderA\"
Dim diaddr As New DirectoryInfo(varSourceAddress)
Dim fiaddr As FileInfo() = diaddr.GetFiles()

For Each scannedFile As FileInfo In fiaddr
    If scannedFile.Exists Then ' not sure it is necessary unless someone adds files externally
        If scannedFile.Name.Contains("Thumbs") = False Then
            strOldName = scannedFile.Name
            strNewName = strOldName.Insert(14, "XYZ")
            scannedFile.CopyTo("\\serverA\drivename\FolderB\" & strNewName, True)
            scannedFile.Delete()
            strOldName = ""
            strNewName = ""
        End If
    End If
 Next 
```

# google-app-engine - 哪些 urlfetch 限制适用于 AppEngine 上的 Python 后端？

> ID：15691807
> 
> 赞同：3
> 
> 时间：2013-03-28T20:45:55.803
> 
> 标签：google-app-engine

我需要移动最大 100 MB 左右的文件。如果我正确阅读了文档，我将需要使用后端来希望不达到每个请求的限制。后端配额是否允许我这样做，或者后端只放弃时间限制，而不是带宽限制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T01:36:42.587

请求的新限制`fetch()`约为 32MB。但是，如果您的源 HTTP 服务器支持“范围”请求，您可以轻松地获取部分文件，然后按顺序组合它们。

# c# - C#中函数参数中的方括号语法？

> ID：15691808
> 
> 赞同：18
> 
> 时间：2013-03-28T20:45:56.907
> 
> 标签：c#, asp.net

我正在学习 ASP.NET 并偶然发现了这个方法声明：

```
public IQueryable<Product> GetProducts([QueryString("id")] int? categoryId) {.....} 
```

教程说`categoryId`将等于查询字符串“id”（来自 URL，如 &id=5），但问题是什么是`[QueryString("id")]`语法？这可以在 ASP.NET 之外使用吗？它的应用程序是什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-28T20:47:31.210

那就是将[`QueryStringAttribute`](http://msdn.microsoft.com/en-gb/library/system.web.modelbinding.querystringattribute.aspx)属性应用于参数`categoryId`。它只是一个属性，就像您可能更习惯于在方法或类上看到的属性一样，如下所示：

```
[STAThread]
static void Main()
{
} 
```

在这种情况下，大概框架的某些部分（我不是 ASP.NET 开发人员，所以我无法准确指出*是*什么）正在使用反射来查找所有方法，找到`QueryStringAttribute`应用于参数的任何值，然后将这些属性中的名称与查询字符串中的名称匹配，然后提取匹配值以传递给方法调用（再次使用反射）。

# google-app-engine - Dart2Js 生成的代码不访问谷歌云端点

> ID：15691809
> 
> 赞同：2
> 
> 时间：2013-03-28T20:45:59.150
> 
> 标签：google-app-engine, dart

真奇怪。该代码在 Chromium 中运行良好——授权 (oauth2) 后，访问 Google 云端点以下载信息。但是一旦它转换为 js 并在 Chrome 中打开，授权后，它就永远不会访问云端点（从谷歌应用引擎日志中检查）。如果用IE9打开，连授权页面都不会出现。任何帮助表示赞赏。

源代码：example.html

```
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <title>example</title>
    <link rel="stylesheet" href="example.css">
  </head>
  <body>
    <h1>example</h1>
 <div id="container">   
         <div id="title">
             <p>Hello!</p>    
          </div>    
          <div id="navigation">
              <p> first </p>            
          </div>
         <div id="content">
              <p> Content </p>            
         </div>
     <button id="login">Login</button>
</div>
    <script type="application/dart" src="example.dart"></script>
    <script src="packages/browser/dart.js"></script>
  </body>
</html> 
```

例子.css

```
#navigation {

  float:left;
  color: #333;
  width: 200px;
  border: 1px solid #ccc;
  background-color: #fff;
  min-height: 20px;
  margin-bottom: 5px;
  box-sizing: border-box;
  padding: 5px;

}
#content {
 margin-left: 200px;
   width: 600px;
  height: 600px;

  border: 1px solid #ccc;
  background-color: #fff;
} 
```

例子.dart

```
import 'dart:html';
import 'package:web_ui/web_ui.dart';
import "packages/dart_terminalendpoint_v1_api_client/lib/terminalendpoint_v1_api_browser.dart" as gdglib;
import "package:google_plus_v1_api/plus_v1_api_browser.dart" as pluslib;
import "package:google_oauth2_client/google_oauth2_browser.dart";
final CLIENT_ID = "----------.apps.googleusercontent.com";
final SCOPES = ["https://www.googleapis.com/auth/userinfo.email", "https://www.googleapis.com/auth/plus.me"];

void main() {
  var auth = new GoogleOAuth2(CLIENT_ID, SCOPES);
  var gdg = new gdglib.Terminalendpoint(auth);
  var plus = new pluslib.Plus(auth);      
  var navigation = query("#navigation");
  var content = query("#content");
  var loginButton = query("#login");
  pluslib.Person me;

  void fetch() {
    gdg.makeAuthRequests=true;
    gdg.terminals.listTerminal().then((l) {
      navigation.text = "";
      if (l.items != null) {
        l.items.forEach((e) {
          var p = new ParagraphElement();
          p.text = " ${e.emailAddress}: ${e.location}";
          navigation.append(p);
        });
      }
    });
   }
  loginButton.onClick.listen((Event e) {
  fetch();
}); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T01:38:36.607

嗨，文森特，最新版本是否为您解决了这个问题？[http://pub.dartlang.org/packages/discovery_api_client_generator](http://pub.dartlang.org/packages/discovery_api_client_generator)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-10T00:43:16.637

我使用了discovery_api_client_generator，效果很好。但是，默认情况下它被设置为不进行身份验证，因为库中的一个变量被设置为 false，并且没有办法从外部更改它。如果您在文件 client_base.dart 中手动编辑生成的库，下面 browser_client.dart 中的代码将执行“正确”的操作，即调用身份验证。

```
if (makeAuthRequests && auth != null) {
  auth.authenticate(request).then((request) => request.send(body));
} else {
  request.send(body);
} 
```

# python - Django过滤器查询解决方案

> ID：15691810
> 
> 赞同：1
> 
> 时间：2013-03-28T20:45:59.537
> 
> 标签：python, django, filter

我需要过滤多个属性的空字段和空白字段。到目前为止，我发现可行的解决方案是这个：

```
avaluos=Avaluo.objects.filter(Q(Estatus='CONCLUIDO',Pagado=False,Factura__isnull=True)
|Q(Estatus='CONCLUIDO',Factura__isnull=True,Pagado__isnull=True)
|Q(Estatus='CONCLUIDO',Factura__exact='',Pagado__isnull=True)
|Q(Estatus= 'CONCLUIDO',Factura__exact='',Pagado=False)) 
```

但是我很确定这不是最好的选择。有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:02:27.620

我认为如果你把你的条款链接起来，它会更具可读性。

```
avaluos= ( Avaluo.objects
           .filter(Estatus='CONCLUIDO')
           .filter(Q(Factura='')|Q(Factura__isnull=True))
           .filter(Q(Pagado=False)|Q(Pagado__isnull=True)) ) 
```

# ios - iPhone：我可以通过编程方式禁用自动关闭显示器吗？

> ID：15691813
> 
> 赞同：9
> 
> 时间：2013-03-28T20:46:04.907
> 
> 标签：ios, objective-c, cocoa-touch

我最近开始用 Objective-C 开发 iPhone 应用程序，并组装了一个小型通用视频播放器，让我可以在我的 iPhone 上观看电视节目、电影等。除了一件小事，一切都完美无缺。

如果我在这段时间内没有点击屏幕，显示屏总是会在一两分钟后关闭并变黑。

我想知道是否可以在我的应用程序打开时以编程方式保持显示。不过，我已经尝试将 idleTimerDisabled 设置为 true，但没有成功。

如果它有所作为，我的设备已越狱，并且我也愿意接受仅适用于越狱设备的解决方案（如果有任何解决方案适用于这种情况）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-28T20:49:49.273

在 AppDelegate 添加：

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions...

//Add this to your method
[UIApplication sharedApplication].idleTimerDisabled = YES; 
```

# php - 获取 PHP 重定向地址

> ID：15691815
> 
> 赞同：1
> 
> 时间：2013-03-28T20:46:10.313
> 
> 标签：php, url, curl

我正在开发一个要求我在重定向后获取最终 URL 的应用程序。在发布此问题之前，我尝试了不同的解决方案，但没有任何效果。

要查询的初始 url 是[Base URL](http://www.epa.gov/myenv/myenview2.find?pQuery=27606)。它使用**JS 重定向**并重定向到[Redirect URL](http://www.epa.gov/myenv/myenview2.html?minx=-76.97948&miny=38.96742&maxx=-76.78894&maxy=39.03545&ve=12,39.00156,-76.88437&pSearch=20770,%20MD)

有没有办法可以从初始 url 获得最终重定向的 url？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T20:50:25.577

[`curl_getinfo()`](http://www.php.net/manual/en/function.curl-getinfo.php)与 opt 参数一起使用`CURLINFO_EFFECTIVE_URL`

从上面的链接页面：

```
CURLINFO_EFFECTIVE_URL - Last effective URL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:52:47.877

这是一个 JS 重定向。如果您查看第一页的 JS 代码，您会看到它是如何生成下一个 URL 的。您可以尝试实现相同的 URL 生成并获取最终 URL。

# batch-processing - Sybase ASE 数据清除批处理 - 等待和事务日志管理

> ID：15691816
> 
> 赞同：1
> 
> 时间：2013-03-28T20:46:17.123
> 
> 标签：batch-processing, sap-ase

我正在开发一个 Sybase ASE（迁移到 15.7）数据清除实用程序，供多个表/数据库使用，以删除大量不需要的旧数据。我计划将它安排在每晚 12:00 到凌晨 3:00 和凌晨 3:00 之后，它应该在第二天中午 12:00 睡觉和醒来并继续清除。标准是不影响用户。

1.  这是一个很好的设计，可以使用以下内容让批次休眠到第二天吗？还是会损害性能？我在调用 waitfor 之前提交了 tran。

    ```
    waitfor time "12:00:00" 
    ```

2.  交易日志：

    *   我正在使用以下查询查找事务日志大小，并等待事务日志可用空间 < 一些百分比。这是一个好方法吗？
    *   另外，考虑到我的一般情况，在继续等待之前我应该​​检查的最佳事务日志使用百分比限制是多少？-我应该使用“转储交易”吗？我读到我们不应该在生产系统中使用“仅转储事务截断”。我应该以不同的方式使用它吗？你对我的场景有什么建议吗？

        ```
        select @tlogPctUsed = ceiling(100 * (1 - 1.0 * lct_admin("logsegment_freepages",d.dbid) / sum(case when u.segmap in (4, 7) then u.size end)))
          from master..sysdatabases d, master..sysusages u
         where u.dbid = d.dbid
           and d.dbid = db_id()
           and d.status != 256
        group by d.dbid

        while (@tlogPctUsed > @tlogPctLimit)
        begin
            waitfor delay @10Seconds
            select @tlogPctUsed = ceiling(100 * (1 - 1.0 * lct_admin("logsegment_freepages",d.dbid) / sum(case when u.segmap in (4, 7) then u.size end)))
              from master..sysdatabases d, master..sysusages u
             where u.dbid = d.dbid
               and d.dbid = db_id()
               and d.status != 256
            group by d.dbid
        end 
        ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T04:44:24.620

[ASE Job Scheduler](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc20001.1570/html/jsusers/title.htm)将是一种更稳定的运行清除方法，而不是*waitfor*。

不建议将 *dump transaction with truncate_only* 用于生产系统的原因是它对可恢复性的影响。您可以通过将事务日志作为进程的一部分转储到文件来解决此问题。这样，您既可以处理日志填充问题，也可以保持在数据库发生故障时恢复系统的能力。

有关转储事务日志的更多信息，请参见[Sybase ASE 15.7 参考手册：命令](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc36272.1570/html/commands/X47924.htm)

此外，可以将 sp_thresholdaction 设置为在达到某个阈值时自动转储事务日志。[Sybase ASE 15.7 Reference Manual: Procedures](http://infocenter.sybase.com/help/index.jsp?topic=/com.sybase.infocenter.dc36273.1570/html/sprocs/X67172.htm)有这个例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T13:25:03.620

1.  waitfor 不应该损害您的性能，但是在 ASE 重新启动、DBA 终止、与客户端的连接丢失等情况下，您可能会丢失此会话，对我来说，这看起来像是不稳定的解决方案。考虑使用 cron 或 ASE Job Scheduler

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-16T18:03:31.890

谨慎使用 Job Scheduler - 注意此 ASE Java 函数中的已知错误，例如，需要回收 ASE 只是为了让失败的 JS 任务从休眠状态中恢复过来，这使得使用 JS 的风险比等待更高的风险。

Cron 更可靠。

# java - ServerSocket 在 android 上不适合我

> ID：15691817
> 
> 赞同：1
> 
> 时间：2013-03-28T20:46:26.810
> 
> 标签：java, android, networking, serversocket

所以我正在为 android 和创建一个在线游戏。曾经取得过成就的人，我找到了一种让它变得更复杂的方法。所以我有一台服务器，它是登录服务器。它侦听来自 android 设备的连接。一旦它接受用户名和密码，检查以确保它们有效，然后将设备的 IP 地址和端口号发送到游戏服务器。然后，Android 设备会侦听来自游戏服务器的连接。

在游戏服务器尝试连接到设备之前，所有这些都有效。此时它会挂起一段时间，然后游戏服务器会抛出此异常：“连接尝试失败，因为连接方在一段时间后没有正确响应，或者建立连接失败，因为连接的主机未能响应 [deviceIP]： [港口]”。

没有提及在 LogCat 中连接的尝试。顺便说一下，我正在使用 ServerSock 来监听游戏服务器的连接。我将它初始化为端口零，然后调用 getLocalPort() 以获取它绑定到的端口以发送到登录服务器。

我已经尝试了我能想到的一切，但我无法让它发挥作用。

# sql - 动态sql查询与日期检查之间的条件？

> ID：15691818
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:46:34.203
> 
> 标签：sql

我的存储过程中有一个动态查询。当我添加了一个条件来检查条件之间的日期时，它给了我以下错误：

从字符串转换日期和/或时间时转换失败。

这是我的查询：

```
@EffDate datetime = GETDATE() 
```

在我的动态查询中：

```
set @query = @query + ' WHERE  ' + @EffDate + ' BETWEEN CONVERT(nvarchar(24), a.Eff_StartDate, 121) AND CONVERT(nvarchar(24), a.Eff_EndDate, 121)'; 
```

如何处理这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:48:54.100

由于您在字符串中连接 DateTime，因此必须先将其转换为字符串：

```
set @query = @query 
  + ' WHERE  ''' 
  + CONVERT(nvarchar(24),@EffDate, 121) 
  + ''' BETWEEN CONVERT(nvarchar(24), a.Eff_StartDate, 121) AND CONVERT(nvarchar(24), a.Eff_EndDate, 121)'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:52:07.310

您生成的 @query 值看起来像（例如）：

```
WHERE 2008-01-01 00:00:00.000 BETWEEN ... 
```

您需要在查询中的 @EffDate 周围添加引号：

```
set @query = @query + ' WHERE  ''' + CONVERT(nvarchar(24), @EffDate,121) + ''' BETWEEN CONVERT(nvarchar(24), a.Eff_StartDate, 121) AND CONVERT(nvarchar(24), a.Eff_EndDate, 121)'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:49:55.210

如果@EffDate 并不总是 GETDATE()，您可以使用 CAST：

```
CAST(@EffDate AS VARCHAR) 
```

并且您的代码应该可以正常工作。你必须在它周围加上单引号：

'在哪里 @EffDate = ' + '''' + CAST(@EffDate AS VARCHAR) + '''' + .....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-10T12:58:43.637

```
set @query = @query + ' WHERE  ' + quotename(@EffDate,'''') + ' BETWEEN CONVERT(nvarchar(24), a.Eff_StartDate, 121) AND CONVERT(nvarchar(24), a.Eff_EndDate, 121)'; 
```

# javascript - dojox.dgauges 中仪表的突然变化。不像 dojox.gauges

> ID：15691820
> 
> 赞同：1
> 
> 时间：2013-03-28T20:46:45.863
> 
> 标签：javascript, jquery, dojo

是否有可能针在更新时会逐渐改变值，如`dojox.gauges` 您可以在此[示例](http://download.dojotoolkit.org/release-1.8.3/dojo-release-1.8.3/dojox/dgauges/tests/test_circular_gauge.html)中看到，当您按下***设置为 15*** 的按钮时，值直接更改为 15。

这是否有可能使其逐渐通过中间值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T12:21:57.337

[根据dojox/dgauges/CircularRangeIndicator](http://dojotoolkit.org/api/dojox/dgauges/CircularRangeIndicator)`animationDuration`上的 API 文档，您要查找的属性是：

> 值更改动画的持续时间（以毫秒为单位）。默认值为 0。动画发生在用户交互和编程值更改时。将此属性设置为 0 以禁用动画。

我创建了一个测试[jsfiddle](http://jsfiddle.net/jrkeller/BFPuL/) 来证明这一点：

标记：

```
<body class="claro">
    <div data-dojo-type="dojox/dgauges/components/default/CircularLinearGauge" data-dojo-id="gauge" value="20" minimum="-50" maximum="50" animationDuration="100" style="width:300px; height:300px"></div>
</body> 
```

代码：

```
require(['dojo/parser', 'dojox/dgauges/components/default/CircularLinearGauge', 'dojo/domReady!'], function (parser, CircularLinearGauge) {
    parser.parse();
    console.log('parsed');
    setInterval(function () {
        var newVal = Math.ceil(Math.random() * (100) - 50);
        console.log('setting value to', newVal);
        gauge.set('value', newVal);
    }, 1000);
}); 
```

# java - Java：何时使用 CertPathValidator 与 TrustManager 来验证证书？

> ID：15691824
> 
> 赞同：-2
> 
> 时间：2013-03-28T20:47:00.663
> 
> 标签：java, cryptography

似乎这两个类都可以用来验证证书。CertPathValidator 支持 CRL。如何确定何时使用它们来验证实体证书？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:52:41.473

`X509TrustManager`用于检查证书是否被认为是可信的。
`CertPathValidator`用于检查证书链是否有效（即，您确实可以从证书中形成一条证书路径，从主体到颁发者一直到根）

**评论后更新**
Valid不是trusted的超集或者子集在链中形成一条有效路径。现在证书是否被认为是受信任的则是另一回事。它们可能确实以所描述的方式有效，但不是受信任证书的一部分

# ruby - 在两个不同操作系统之间进行开发的最佳方式

> ID：15691825
> 
> 赞同：1
> 
> 时间：2013-03-28T20:47:04.513
> 
> 标签：ruby, windows, macos, development-environment

我在家在 OSX 上开发（用于个人项目）：Ruby（研究节点）和许多基本的 Web 应用程序。我喜欢使用 OSX 进行开发，并且发现在开发环境中工作并从 OSX 推送到 Ubuntu 生产环境要简单得多……

这个问题与我目前的工作有关，每个人都使用 Windows（与开发无关），但我想用相同的语言（Ruby/node/unix）做一些与工作相关的开发......

什么是在两个不同的开发环境中舒适地工作的好方法，在两者之间轻松同步（也许是 github？）项目，并最低限度地关注“希望这不是依赖项/Windows 问题”？

我意识到这是主观的，可能在其他地方被问过，但我正在寻找一种 TRIED 方法（不是，“嘿，试试这个”），它至少很容易在一个平台上坐下来，做一个简单的同步，然后得到去工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:36:57.427

如果你不反对使用虚拟机，你应该考虑[Vagrant](http://www.vagrantup.com/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T22:17:18.733

同意 ethagnawl，[Vagrant](http://www.vagrantup.com/)是快速开发环境的最佳选择。它适用于 Virtualbox，并允许您使用预制的 VM 快照？或在这种情况下为“盒子”。

一个带有 RVM、Ruby、MySQL 的预制盒子示例：[RWpreise64](http://railsware.github.com/dev_vagrant_box/)

这也适用于[Puppet](https://puppetlabs.com/)或[Chef](http://www.opscode.com/chef/)，用于“蓝图”您的服务器配置和其他基础设施。Vagrant-Puppet/Chef 组合是沙盒的好方法。

这是一个很好的介绍页面：[链接](http://edvanbeinum.com/automate-your-development-environment-with-vagrant)

请注意，如果您想要一个 gui，您必须将以下内容添加到您的 Vagrantfile 中：

```
config.vm.boot_mode = :gui 
```

# jquery - jqGrid自定义edittype（单选按钮列）自定义元素在编辑时不触发设置事件

> ID：15691828
> 
> 赞同：2
> 
> 时间：2013-03-28T20:47:11.990
> 
> 标签：jquery, jqgrid, jqgrid-formatter

我有一个 jqGrid，它在编辑时需要在一行的一列中有单选按钮。以下是我的代码：

```
function BindPreclosingDocs(response) {
    var previouslyselectedRow;
    var preclosingtable = $('#preclosing');
    preclosingtable.jqGrid({
        datatype: 'jsonstring',
        datastr: JSON.stringify(response.ServiceModel),
        colNames: ['', 'Documents Received', 'Comments', 'SubDocument', 'NA'],
        colModel: [
        { name: 'Documents', index: 'Documents', align: 'left', sortable: false, editable: false, width: 240 },
        { name: 'DocsReceived', index: 'DocsReceived', align: 'center', sortable: false, editable: true, edittype: 'checkbox', editoptions: { value: "True:False" }, formatter: "checkbox", width: 140 },
        { name: 'Comments', index: 'Comments', align: 'center', sortable: false, editable: true, edittype: "textarea", editoptions: { rows: "3", cols: "16" }, width: 180 },
        { name: 'SubDocument', index: 'SubDocument', editable: false, width: 1 },
        { name: 'NA', index: 'NA', editable: true, formatter: 'dynamicText', width: 150, edittype: 'custom', editoptions: { custom_element: radioelem, custom_value: radiovalue} }
        ],
        rowNum: response.ServiceModel.PreClosing.length,
        pager: '#preclosingpagerdiv',
        viewrecords: true,
        sortorder: "asc",
        sortname: 'Documents',
        jsonReader: {
            root: "PreClosing",
            repeatitems: false,
            id: 'ConfigId'
        },
        shrinkToFit: false,
        height: 'auto',
        grouping: true,
        groupingView: {
            groupField: ['SubDocument'],
            groupColumnShow: [false],
            plusicon: 'ui-icon-circle-triangle-s',
            minusicon: 'ui-icon-circle-triangle-n'
        },
        loadComplete: function () {
            HideGroupHeaders(this);                
        },
        onSelectRow: function (id) {
            preclosingtable.jqGrid('saveRow', previouslyselectedRow, false, 'clientArray');
            previouslyselectedRow = SetJQGridRowEdit(id, previouslyselectedRow, preclosingtable);
        }
    });
    preclosingtable.setGridWidth('710');
};

//RowSelect 
function SetJQGridRowEdit(id, previousid, grid) {
    if (id && id !== previousid) {
        grid.jqGrid('restoreRow', previousid);
        grid.jqGrid('editRow', id, true);
        previousid = id;
        return previousid;
    }
};

//Build radio button
function radioelem(value, options) {
    var receivedradio = '<input type="radio" name="receivednaradio" value="R"';
    var breakline = '/>Received<br>';
    var naradio = '<input type="radio" name="receivednaradio" value="N"';
    var endnaradio = '/>NA<br>';
    if (value == 'Received') {
        var radiohtml = receivedradio + ' checked="checked"' + breakline + naradio + endnaradio;
        return radiohtml;
    }
    else if (value == 'NA') {
        var radiohtml = receivedradio + breakline + naradio + ' checked="checked"' + endnaradio;
        return radiohtml;
    }
    else {
        return receivedradio + breakline + naradio + endnaradio;
    }
};

function radiovalue(elem, operation, value) {
    if (operation === 'get') {
        return $(elem).val();
    } else if (operation === 'set') {
        if ($(elem).is(':checked') === false) {
            $(elem).filter('[value=' + value + ']').attr('checked', true);
        }
    }
}; 
```

我的格式化程序和取消格式化程序代码如下

```
dynamicText: function (cellvalue, options, rowObject) {
        if (cellvalue == 'R') {
            return 'Received';
        }
        else if (cellvalue == 'N') {
            return 'NA';
        }
        else {
            return '';
        }
    }

$.extend($.fn.fmatter.dynamicText, {
    unformat: function (cellValue, options, elem) {
        debugger;
        var text = $(elem).text();
        return text === '&nbsp;' ? '' : text;
    }
}); 
```

我遇到的问题是，当我选择一行并检查一个编辑按钮时，它不会在 radiovalue 函数中触发设置。在选择行时创建无线电按钮时，它会在RadiOvalue功能中发射。有什么帮助可以让我为单选按钮设置一个值吗？！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T00:29:08.717

我认为你是对的。`custom_value`在不同的编辑模式下，回调的使用是有区别的。

如果使用表单编辑并且某些可编辑列具有`edittype: 'custom'`然后第一个`custom_element`函数（在您的情况下是`radioelem`函数）将在`$.jgrid.createEl`. 然后`custom_value`将在以下情况下额外调用`rowid !== "_empty"`（不适用于添加表单）。有关详细信息，请参阅[代码行](https://github.com/tonytomov/jqGrid/blob/v4.4.4/js/grid.formedit.js#L499-L501)。

问题是`custom_element`有`value`参数。因此它可以在自定义控件中设置值并调用，并且不需要`custom_element`额外调用`custom_value`with 。`"set"`

另一种编辑模式（内联编辑和单元格编辑）只是创建自定义控件。`custom_value`永远不会使用`"set"`参数调用回调。

我确认有关自定义控件[的文档](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:common_rules#custom)太短。我想您可以删除 part 的部分`radiovalue`代码`'set'`。我认为以下代码也可以很好地工作（即使在表单编辑的情况下）：

```
function radiovalue(elem, operation, value) {
    if (operation === 'get') {
        return $(elem).val();
    }
} 
```

一句话：如果您尝试使用自定义控件，您应该不要忘记使用[recreateForm: true](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:form_editing#properties)选项。作为在内联编辑、表单编辑和搜索中使用自定义控件的示例，您将在[此处](http://www.ok-soft-gmbh.com/jqGrid/ranking1_441.htm)找到。您将在[答案](https://stackoverflow.com/a/12744780/315935)中找到对演示的参考。

# python-2.7 - 如何停止 Bottle.py 自动重新加载

> ID：15691830
> 
> 赞同：0
> 
> 时间：2013-03-28T20:47:15.177
> 
> 标签：python-2.7, bottle

我对bottle.py很陌生，
我遇到了问题有`run(reloader=True)`
没有办法停止服务器？击中`ctr+c`并没有停止服务器。
顺便说一句，我在 linux 上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:01:44.353

在linux中，您可以终止该进程。

找到它：

```
ps -ef|grep python 
```

然后使用进程行中的第一个数字终止进程：

```
sudo kill 99999 
```

这是针对 Ubuntu 的。

该端口可能会`in use`在您重新启动时显示，并且已在 stackoverflow 中解决，但我不记得在哪里，所以您必须寻找它。

# java - 如何使用commons mail 1.3将图像嵌入正文

> ID：15691831
> 
> 赞同：3
> 
> 时间：2013-03-28T20:47:16.420
> 
> 标签：java, html, email, sendmail, apache-commons

这是我的附加和发送图像的代码，但我想从本地驱动器加载图像并将其嵌入邮件正文而不附加请帮助我，我搜索了仍然没有解决方案。感谢导入 org.apache.commons.mail.DefaultAuthenticator；导入 org.apache.commons.mail.EmailAttachment；导入 org.apache.commons.mail.HtmlEmail；

```
public class img {

     public static void main(String[]args)  throws Exception {

         // Create the attachment
          EmailAttachment attachment = new EmailAttachment();
          attachment.setPath("Monthly Target AchivedDaily.gif");
          attachment.setDisposition(EmailAttachment.INLINE);
          attachment.setDescription("Monthly");
          attachment.setName("1");

            HtmlEmail he = new HtmlEmail();

               he.setSmtpPort(25);
              he.setAuthenticator(new DefaultAuthenticator("myid","mypwd"));

              he.setDebug(false);
              he.setHostName("..com");
              he.addTo("@.com","hsn");

                //email.setSSL(true);
              he.setFrom("mail", "Hassan");
              he.setSubject("tst1");
              he.attach(attachment);

              he.send();

            System.out.println("Done...");

     }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T21:08:02.240

我没有使用过这个工具，但经过一些研究：[这里](http://www.codereye.com/2009/08/sending-html-email-with-embedded-images.html)有一些例子的链接。另外，请参阅`org.apache.commons.mail.HtmlEmail.embed(String url, String name)`[2的文档](http://www.jarvana.com/jarvana/view/commons-email/commons-email/1.0/commons-email-1.0-javadoc.jar!/org/apache/commons/mail/HtmlEmail.html#embed%28java.net.URL,%20java.lang.String%29)

你会打个电话

```
String id = email.embed(new URL("file://localhost/home/mydir/images/my_image.png"), "My image"); 
```

# javascript - 如何在某个位置的 div 文本中插入 html 对象？

> ID：15691835
> 
> 赞同：-4
> 
> 时间：2013-03-28T20:47:30.803
> 
> 标签：javascript, jquery

我有一个包含一些用户输入文本的 div。

我希望能够插入一个 html 对象，跨度可以说在这个 div 文本中的某个位置。

例如：

```
<div>
    There is some text in this div and I would like to append an html object right here.
    There might be some other text here.
</div> 
```

把它变成：

```
<div>
    There is some text in this div and I would like to append an html object <span class="safeHtml"></span> right here.
    There might be some other text here.
</div> 
```

需要考虑的一些事项：

1.  我不想将整个 div 呈现为安全的 html，因为用户输入可能包含可能破坏我的设计或一些讨厌的脚本的 html 标签。
2.  我想将插入的对象呈现为 html；其余的作为文本。

谢谢

PS：现在已经足够具体了，还是我应该在黑板上为那些关闭问题和投票的人画一幅画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:49:01.170

您可以这样做来替换`right here`：

```
$('div').each(function(){
  $(this).html($(this).html().replace(/right here/, '<span>something</span>'));
}); 
```

如果你只想插入，你可以这样做：

```
$('div').each(function(){
  var html = $(this).html();
  var i = html.indexOf('right here');
  if (i>=0) $(this).html(html.slice(0, i)+'<span>something</span>'+html.slice(i));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T22:29:21.277

我无法理解这个问题。但我认为，这就是你要找的。 [http://jsfiddle.net/rexonms/wzBh3/](http://jsfiddle.net/rexonms/wzBh3/)

HTML

```
<div>
    Some text. <span id="newText"> </span> .Some more text.
</div> 
```

Javascript

```
var htmlObject = "Text from HTML object"; 
$("#newText").append(htmlObject); 
```

# twitter-bootstrap - 使用 Twitter 引导的响应式设计

> ID：15691837
> 
> 赞同：0
> 
> 时间：2013-03-28T20:47:38.787
> 
> 标签：twitter-bootstrap

我已经为我的网站使用 twitter bootstrap 实现了响应式设计。可折叠的导航栏在手机上运行良好，但在平板电脑和 iPad 上却不行。基本上我希望可折叠导航自动在平板电脑或 ipad 上实现。我发现引导文档有点混乱。任何人都可以提供一些指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T21:49:47.363

Bootstrap 不适用于设备，它使用屏幕宽度（通过 CSS 媒体查询）以特定宽度折叠导航栏。因此，在 iPad 上默认启用它的唯一方法是确保它折叠在 iPad 的屏幕宽度或以上（纵向模式下为 768px）。

我过去也做过同样的事情，并且有几次最终编辑了`@media`构成其中一部分的查询，以`bootstrap-responsive.css`使其以更合适的宽度折叠到平板电脑上。例如：

```
@media (min-width: 768px) and (max-width: 979px) { 
```

[如此处](http://twitter.github.com/bootstrap/customize.html#variables)详述，一种更先进的方法是自定义引导程序以满足您的需求并使用自定义变量 - 更改`@navbarCollapseWidth`页面上列出的变量，但您可能更喜欢手动编辑宽度...

附带说明一下，可能值得查看各种流行平板电脑和设备的屏幕宽度。这可能会有所帮助：[媒体查询：如何定位台式机、平板电脑和移动设备？](https://stackoverflow.com/questions/6370690/media-queries-how-to-target-desktop-tablet-and-mobile)

# c# - 使用文本框更改控件

> ID：15691844
> 
> 赞同：1
> 
> 时间：2013-03-28T20:48:05.620
> 
> 标签：c#, input, xna

我一直在研究一种使用从文本框派生的字符串来更改我的 c# 游戏的控件的方法。

```
 moverighttext = System.IO.File.ReadAllText(@"C:\Users\Public\TestFolder\moverighttext.txt");
 movelefttext = System.IO.File.ReadAllText(@"C:\Users\Public\TestFolder\movelefttext.txt");

 //I have the letter 'D' Stored in moverighttext.txt and the letter 'A' Stored in movelefttext.txt

 var moverightkey = (Keys)Enum.Parse(typeof(Keys), moverighttext);
 var moveleftkey = (Keys)Enum.Parse(typeof(Keys), movelefttext); 

 if (KeyboardState.IsKeyDown(Keys.moveleftkey))
            if (KeyboardState.IsKeyDown(Keys.moverightkey))
            {
                acceleration.X = 0;
            } 
```

这会产生错误：-“Microsoft.Xna.Framework.Input.Keys”不包含“moveleftkey”的定义

“Microsoft.Xna.Framework.Input.Keys”不包含“moverightkey”的定义

我不熟悉使用“Enum.Parse”之类的东西，但我的印象是我已将“moverightkey”和“moveleftkey”作为定义添加到“Microsoft.Xna.Framework.Input.Keys”。

我正在寻找解决这些错误或找到处理此问题的正确方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:53:51.483

您不应该为游戏中的每个键都提供单独的文本文件。相反，您可以使用一个合适格式的文本文件（二进制、XML 等）并对其进行解析以获取所有关键信息（查找`Serialization`有关此的更多信息）。

假设`Enum.Parse`调用成功，您不需要添加前缀`Keys`to，`moveleftkey`因为它已经是一个`Keys`枚举。你可以这样称呼它

```
if (KeyboardState.IsKeyDown(moveleftkey)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:52:27.887

`Keys`是一个枚举，`moveleftkey`不是值之一。但是，`moveleftkey`- 解析后 -**是**枚举值（或应该是）。

删除`Keys.`前置`moveleftkey`并`moverightkey`尝试一下。

我建议您也简化控制键的分配。您当然不需要创建多个文件。

将以下内容复制到 Xml 文件（`control_keys.xml`例如）：

```
<?xml version="1.0" encoding="utf-8"?>
<control_keys>
    <move_left key="l"/>
    <move_right key="r"/>
    <!-- add more control keys -->
</control_keys> 
```

加载该 xml 并获得`Keys`如下内容：（请参阅此处了解如何使用[Linq-to-Xml](http://msdn.microsoft.com/en-us/library/bb387098.aspx)）

```
var conrolKeys = XDocument.Load("control_keys.xml").Root;
//  now get your Keys text values
var moveLeftText = controlKeys.Element("move_left").Attribute("key").Value;
var moveRightText = controlKeys.Element("move_right").Attribute("key").Value;
//  now get your Keys values
var moveLeftKey = (Keys)Enum.Parse(typeof(Keys), moveLeftText);
var moveRightKey = (Keys)Enum.Parse(typeof(Keys), moveRightText); 
```

**编辑关于命名空间的每条评论**
添加项目引用到：

*   系统文件
*   System.Linq.XML

然后，Visual Studio 应该会帮助解决您的`using`陈述。但是，简而言之：

```
using System.Xml;
using System.Linq.Xml; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T20:55:11.920

一旦你的枚举被解析（到`moverightkey`和`moveleftkey`变量中），你就不想在它们前面加上`Keys`. 仅当您直接访问特定的 Key 值时才需要这样做。请记住，`Keys`枚举代表键盘上的实际键。虽然有“A”键，但没有“左移”键。但是，您可以创建一个名为的变量`moveleftkey`并为其分配 value `Keys.A`。

例如：

```
if (KeyboardState.IsKeyDown(moveleftkey)) 
{

} 
```

# c++ - 为什么这段代码在 Linux 中运行良好但在 Windows 中失败？

> ID：15691847
> 
> 赞同：0
> 
> 时间：2013-03-28T20:48:06.577
> 
> 标签：c++, linux, windows, crash, linked-list

我写了一些链表的代码：链表的定义：

```
struct Node {
    // data is used to store an integer value in this node
    int data;
    // a pointer points to the next node
    Node* link;
    // inializes the node with a 0 value in data and a null pointer in link
    Node() : data(0), link(NULL) {};
    // destructor release space allocated to the linked list
    ~Node() {delete link;}
}; 
```

显示链表：

```
void display_and_count(Node* aLink) {
    cout << "Entries: ";
    int nodeNumber = 0;                         // elements number of linked list
    for(Node* iterator = aLink; iterator->link != NULL; iterator=iterator->link) {
        cout << iterator->data << ", ";
        nodeNumber++;
    }
    cout << "contans " << nodeNumber << " nodes." << endl;
}// end display_and_count 
```

现在我编写了一个函数，根据阈值将一个链表拆分为两个 LESS 和 MORE，并删除原始链表中的节点：

```
void split_them_up(Node* aLink, Node* less, Node* more, int threshold) {
    Node* lessHead = less;                              // head of less
    Node* moreHead = more;                              // head of more
    bool isThresholdInALink = false;                    // store if threshold is an element of aLink
    for(Node* iterator = aLink; iterator->link != NULL; iterator = iterator->link) {
        if(iterator->data < threshold) {
            less->data = iterator->data;
            less->link = new Node;
            less = less->link;
        }
        else if(iterator->data > threshold) {
            more->data = iterator->data;
            more->link = new Node;
            more = more->link;
        }
        else {
            isThresholdInALink = true;
        }
    } // end for(Node* iterator = aLink; iterator->link != NULL; iterator = iterator->link)

    less = lessHead;
    more = moreHead;

    delete aLink;
    // If threshold is an element of aLink, then the new linked list contains the only threshold.
    // If threshold isn't in aLink, then the new linked list contains nothing
    aLink = new Node;
    if(isThresholdInALink) {
        aLink->data = threshold;
        aLink->link = new Node;
    } // end if(isThresholdInALink)*/
} // end split_them_up 
```

然后这是主要功能：

```
int main() {
    Node* ENTRIES = new Node;           // define a linked list

    get_input(ENTRIES);
    display_and_count(ENTRIES);

    Node* less = new Node;              // define less list
    Node* more = new Node;              // define more list
    cout << "Enter a threshold: ";
    int thd;                            // threshold
    cin >> thd;
    split_them_up(ENTRIES, less, more, thd);

    cout << "Less list: " << endl;
    display_and_count(less);
    cout << "More list: " << endl;
    display_and_count(more);
    cout << "ENTRIES: " << endl;
    display_and_count(ENTRIES);
} 
```

get_input 函数从用户和 -1 获取一些整数到结束：

```
void get_input(Node* aLink) {
    Node* head = aLink;                 // head of linked list
    int capacity=1;                     // the capacity of intArray
    int* intArray = new int[capacity];  // an array stores user input
    int size=0;                         // actual number of elements stored in the intArray

    cout << "Input some integers, -1 to end: ";
    while(true) {
        int input;
        cin >> input;
        if(input == -1) break;
        if(!isContained(intArray, size, input)) {
            intArray[size]=input;
            size++;
            // if size meets capacity, double capacity
            if(size >= capacity) {
                int* temp = new int[capacity];
                int oldCapacity = capacity;
                for(int i=0; i < oldCapacity; i++) temp[i]=intArray[i];
                delete[] intArray;
                capacity = 2*capacity;
                intArray = new int[capacity];
                for(int i=0; i < oldCapacity; i++) intArray[i]=temp[i];
                delete[] temp;
            } // end if(size >= capacity)
        } // end if(!contained(intArray, size, input))
    } // end while(true)

    for(int i=0; i<size; i++) {
        aLink->data = intArray[i];
        aLink->link = new Node;
        aLink = aLink->link;
    }
    delete[] intArray;
    aLink = head;
} // end get_input 
```

包含：

```
bool isContained(int* array, int aSize, int n) {
    for(int i=0; i<aSize; i++) {
        if(array[i] == n) return true;
    }
    return false;
} // end isContained 
```

在 Linux 系统中执行时一切正常。但在 Windows 中，它会在 split_them_up 之后在 ENTRIES 中显示一个随机值，并且程序将崩溃，给出“访问冲突读取位置”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:53:28.417

我不知道这是否会解决问题，但我很确定您不希望节点使用这样的析构函数。

1.  没有新的，所以不需要删除。
2.  如果它触发删除下一个节点，下一个，下一个......，你将如何实现删除列表中的某个节点？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T07:36:44.430

操作时当然会崩溃`ENTRIES`；该`split_them_up`函数删除了`Node`它指向的对象。

从它的外观来看，您打算声明`aLink`为指针到指针，以便您实际上可以将值更改`ENTRIES`为指向新声明`Node`的（此时您正在泄漏）。

或者，`aLink`您可以删除子节点并重用，而不是删除`aLink`，即替换：

```
delete aLink;
aLink = new Node;
if(isThresholdInALink) {
    aLink->data = threshold;
    aLink->link = new Node;
} 
```

有了这个：

```
delete aLink->link;
if(isThresholdInALink) {
    aLink->data = threshold;
    aLink->link = new Node;
} else {
    aLink->data = 0;
    aLink->link = NULL;
} 
```

为什么糟糕的代码可以在 Linux 上运行？猜测一下，新声明`Node`的节点巧合地创建在与原来删除的节点相同的位置，所以`ENTRIES`不小心指向了正确的位置。

我还将评论您不需要`lessHead`或`moreHead`; 他们没有做任何有用的事情。完全删除它们。就像`aHead`，因为`less`和`more`没有被声明为指向指针的指针，所以调用函数中的值不会受到内部发生的任何事情的影响`split_them_up`。

*附加：*析构函数，

```
~Node() {delete link;} 
```

如果链接很大，很容易溢出堆栈。递归是一件好事，但在极端情况下就不行了。:-)

# php - PHP - 发送邮件不起作用

> ID：15691850
> 
> 赞同：0
> 
> 时间：2013-03-28T20:48:18.940
> 
> 标签：php, email

我已经看过其他一些关于此的帖子，我现在正在从一本书中学习。我遵循了书中所说的内容，但我不明白我错过了什么。

我尽量不让它成为一个双重帖子，但代码与我在 stackoverflow 上阅读的代码完全不同，所以我开始了。我希望有一个人可以帮助我。我是一个完整的初学者。

我`Basic.php`有这个脚本

```
<form action="sendmail.php" method="POST">
<p><strong>Name:</strong><br />
<input type="text" size="25" name="name" /></p>
<p><strong>E-Mail Address:</strong><br />
<input type="text" size="25" name="email" /></p>
<p><strong>Message:</strong><br />
<textarea name="message" cols="30" rows="5"></textarea></p>
<p><input type="submit" value="send" /></p>
</form> 
```

我`sendmail.php`有这个脚本。

```
echo "<p>Thank you, <b>" . $_POST['name'] . "</b>, for your message!</p>";
echo "<p>Your e-mail address is: <b>" . $_POST['email'] . "</b>. </p>";
echo "<p>Your message was: <br/>";
echo $_POST['message']."</p>";
//start building the mail string
$msg = "Name: " . $_POST['name'] . "\n";
$msg .= "E-mail: " . $_POST['email'] . "\n";
$msg .= "Message: " . $_POST['message'] . "\n";
//set up the mail
$recipient = "myemail@gmail.com";
$subject = "Form Submission Results";
$mailheaders = "From: me \n";
$mailheaders .= "Reply To " . $_POST['email'];
//send the mail
mail($recipient, $subject, $msg, $mailheaders); 
```

这是我`php.ini`的改变（这部分我不知道）。

```
[mail function]
; For Win32 only.
; http://php.net/smtp
SMTP = smtp.gmail.com
; http://php.net/smtp-port
smtp_port = 465
; For Win32 only.
; http://php.net/sendmail-from
sendmail_from = myemail@gmail.com 
```

我会很感激我能得到的任何帮助。谢谢！

顺便说一句，我收到以下错误：警告：邮件（）：SMTP 服务器响应：530-5.5.1 需要身份验证。在 530 5.5.1 [http://support.google.com/mail/bin/answer.py?answer=14257](http://support.google.com/mail/bin/answer.py?answer=14257) wx2sm302658igb.4 - gsmtp in C:\wamp\www\sam\sendmail.php 第 24 行了解更多信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T21:15:51.690

您的代码看起来不错，但您可能无法通过的服务器使用核心功能`PHP`发送电子邮件。看看[这篇文章](https://stackoverflow.com/questions/10028428/using-core-php-mail-to-send-via-gmail-smtp?lq=1)，因为它可以帮助你。`PHP's``mail``gmail``SMTP`

# windows - 如何使用不同的 IIS 用户读取加密的目录文件

> ID：15691854
> 
> 赞同：2
> 
> 时间：2013-03-28T20:48:29.403
> 
> 标签：windows, web-services, encryption, public-key-encryption

我想在浏览器上使用 IIS 从加密目录读取/访问文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T20:22:15.270

如果您有特定文件，您应该能够将 IIS 用户添加为授权用户：[http ://technet.microsoft.com/en-us/library/bb457007.aspx](http://technet.microsoft.com/en-us/library/bb457007.aspx)

在我的机器上，IIS 用户已经拥有 EFS 证书，但我找不到任何关于是否始终如此的文档。

# string - 按字符数分割字符串matlab

> ID：15691857
> 
> 赞同：4
> 
> 时间：2013-03-28T20:48:43.987
> 
> 标签：string, matlab, octave

Matlab中是否有任何内置函数可以按字符数切割字符串并将其作为单元格数组或其他内容返回。例如，如果调用 A = some_function(string, 3)：

```
Input: string = '1234567890'
Output: A = {'123', '456', '789', '0'} 
```

还是我需要使用循环？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-29T02:07:55.627

另一种更优雅的解决方案（在我看来）是使用[`regexp`](http://www.mathworks.com/help/matlab/ref/regexp.html)：

```
A = regexp(str, sprintf('\\w{1,%d}', n), 'match') 
```

`str`你的字符串在哪里，是`n`字符数。

### 例子

```
>> regexp('1234567890', '\w{1,3}', 'match')

ans = 
    '123'    '456'    '789'    '0' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-28T20:57:40.150

有点长可能是：

```
ns = numel(string);
n = 3;
A = cellstr(reshape([string repmat(' ',1,ceil(ns/n)*n-ns)],n,[])')' 
```

# vba - 将传入消息的附件添加到新的传出消息

> ID：15691861
> 
> 赞同：2
> 
> 时间：2013-03-28T20:49:11.600
> 
> 标签：vba, outlook, email-attachments

我有一份每周通过电子邮件发送几次的订单，其中包含我需要发送以进行处理的附件。处理文件的软件要求电子邮件正文中没有签名和文本。

我通过查找发件人和附件的规则触发脚本。该脚本应该抓取一个模板并插入附件。我遇到的问题是插入附件。

这是我到目前为止所拥有的。感谢您的帮助。

```
Sub SendLeadOrder(Item As Outlook.MailItem)

    Set objMsg = Application.CreateItemFromTemplate("C:\OrderTemplate.oft")

    objMsg.Attachments.Add Item.Attachments
    objMsg.Display
    'objMsg.Send

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T22:09:02.557

我很确定您需要将附件保存到磁盘，然后将它们重新应用到新邮件中。像这样

```
Dim Item As Outlook.MailItem
Dim objMsg As Outlook.MailItem
Dim objAtt As Outlook.Attachment
Dim sPath As String

Set Item = ActiveInspector.currentItem
Set objMsg = Application.CreateItemFromTemplate("C:\OrderTemplate.oft")

For Each objAtt In Item.Attachments
    sPath = Environ("TEMP") & "\" & objAtt.FileName
    objAtt.SaveAsFile sPath
    objMsg.Attachments.Add sPath
Next objAtt

objMsg.Display 
```

您确定仅转发消息并根据需要进行清理并不容易吗？像这样

```
Dim Item As Outlook.MailItem
Dim objMsg As Outlook.MailItem

Set Item = ActiveInspector.currentItem
Set objMsg = Item.Forward
With objMsg
    .To = "someone@example.com"
    .Subject = "Predifined Subject"
    .Body = vbNullString
    .Display
End With 
```

# php - 如何从 PHP 中的时间和时区获取 UTC 时间？

> ID：15691863
> 
> 赞同：1
> 
> 时间：2013-03-28T20:49:16.063
> 
> 标签：php, date, timezone, utc

我正在开发一个需要与时间和时区相关的特定功能的应用程序。这是下面的伪代码，可以简要说明我的疑问

```
$start_time = "10:00 AM"; // starting time of an event
$end_time = "11:00 AM"; // ending time of an event
$system_time = "1:30 AM";

$timezone = "India +5:30"; 
```

我想要的是根据事件当前正在发生、将要发生还是已经发生，将事件的状态显示为“Live”、“Upcoming”和“Finished”。

我怎样才能找到独立于国家时区的这种状态？

任何我可以拥有通用功能的方式

```
$universal_time = get_time_in_utc_for($system_time, $timezone); // similarly for start_time & end_time 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:59:36.913

您有一个良好的开端 -*使用 UTC*。

传统上[`strtotime()`](http://php.net/manual/en/function.strtotime.php)是工作的方法。但是，如果您使用 PHP > 5.3，您可能会发现[DateTime](http://www.php.net/manual/en/datetime.createfromformat.php)类更加灵活。

快速代码示例：

```
$timestamp = strtotime('2013-03-28 10:00 AM +5:30');
// 1364445000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T21:52:44.620

## 使用日期时间

```
<?
// Not sure where you're gonna run this
$b = PHP_EOL . "<br/>";

// Create your events in their natual start/end time per that country/TZ
$eventStartMyTime = '2013-03-28 11:30:00';
$eventEndMyTime = '2013-03-28 16:30:00';
$eventTimeZone = new DateTimeZone('Asia/Calcutta');
$startTime = new DateTime($eventStartMyTime, $eventTimeZone);
$endTime = new DateTime($eventEndMyTime, $eventTimeZone);

// Now when the system deals with dates, it's going to
// deal with them all in UTC (DateTime object can do this)
// A Unix timestamp is inherently "in UTC"
// Store these values in a db if you need to
$startTS = $startTime->getTimestamp();
$endTS = $endTime->getTimestamp();

// Function to get status
function getStatus($dateTime, $start, $end) {

    // Get UTC timestamp for the input
    $time = $dateTime->getTimestamp();

    // Check against event times
    switch(true) {
        case $time >= $start && $time < $end: return "LIVE";
        case $time >= $end: return "ENDED";
        case $time <= $start: return "UPCOMING";
    }
} 
```

## 测试

```
// Let's walk through some scenarios
$testUpcoming = new DateTime('2013-03-21 00:00:00', new DateTimeZone('Asia/Calcutta'));
$testLive = new DateTime('2013-03-28 15:30:00', new DateTimeZone('Asia/Calcutta'));
$testEnded = new DateTime('2013-03-28 23:30:00', new DateTimeZone('Asia/Calcutta'));
$testNewYork = new DateTime('2013-03-28 12:30:00', new DateTimeZone('America/New_York'));
$testPyongyang = new DateTime('2013-03-28 12:30:00', new DateTimeZone('Asia/Pyongyang'));

// Use a fixed TZ (the TZ of the server)
// Should be UPCOMING
echo getStatus($testUpcoming, $startTS, $endTS) . $b;
// Should be LIVE
echo getStatus($testLive, $startTS, $endTS) . $b;
// Should be ENDED
echo getStatus($testEnded, $startTS, $endTS) . $b;

// Pretend we're running on a server in New York
// Same timestamp, different TZ
// Should be ENDED
echo getStatus($testNewYork, $startTS, $endTS) . $b;

// Pretend we're running on a server in Pyongyang
// Same timestamp, different TZ
// Should be UPCOMING
echo getStatus($testPyongyang, $startTS, $endTS) . $b;

$now = new DateTime();
echo "Our current timezone is: " . $now->getTimezone()->getName()  . $b;
echo "And the event is: " . getStatus($now, $startTime, $endTime); 
```

# common-lisp - 重新定义内置函数

> ID：15691868
> 
> 赞同：6
> 
> 时间：2013-03-28T20:49:33.993
> 
> 标签：common-lisp, sbcl

我将如何重新定义内置函数，同时以不同的名称保留对旧函数的引用？

即与 SBCL

```
(unlock-package 'common-lisp)
(defun old+ (a b) ??????
(defun + (a b) (old+ a b)) 
```

我正在将代码移植到没有浮点数据类型的 LISP 实现中。所以我想重新定义数学运算以使用固定整数数学。

我想我也可以通过搜索和替换来解决这个问题:)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-28T21:23:49.520

要回答您的具体问题：

```
(defconstant +old-plus+ (fdefinition '+))
(defun + (&rest args) (apply +old-plus+ args)) 
```

请注意，如果您再次对此进行评估（例如，通过重新加载包含此代码的文件），您可能会遇到问题：`+old-plus+`可能会被静默地重新定义为新的`+`（或者您可能会收到错误，或者您可能会收到警告）并且您将失去原来的`+`定义。

因此，似乎更好的方法是创建一个新包，其中所有符号都从其中导入，`CL`除了`+`阴影之外，然后使用该包而不是`CL`（未经测试）：

```
(rename-package "COMMON-LISP" "COMMON-LISP-ORIGINAL")
(make-package "COMMON-LISP")
(use-package "COMMON-LISP-ORIGINAL" "COMMON-LISP")
(shadow "+" "COMMON-LISP")
(do-external-symbols (s "COMMON-LISP-ORIGINAL")
  (export (find-symbol (symbol-name s)) "COMMON-LISP"))
(defun common-lisp::+ (&rest args) (apply #'common-lisp-original:+ args)) 
```

现在您应该能够处理代码了。

请注意，您不应两次加载上述代码，因为如果您加载[`rename-package`](http://www.lispworks.com/documentation/HyperSpec/Body/f_rn_pkg.htm)到现有的`"COMMON-LISP-ORIGINAL"`.

# python - 使用升级的站点包创建虚拟环境

> ID：15691869
> 
> 赞同：0
> 
> 时间：2013-03-28T20:49:35.743
> 
> 标签：python, virtualenv, distribute

我正在尝试使用分发版本==0.6.35 创建一个虚拟环境，每次创建它时，我都会在激活它后获得以下站点包

```
distribute==0.6.26
mercurial==2.2.2
virtualenv==1.7.1.2
virtualenvwrapper==3.4
wsgiref==0.1.2 
```

1.  我想知道，虚拟环境在哪个基础上安装这些具有特定版本的站点包？

2.  如何使用 Distribute==0.6.35 创建虚拟环境？

**我已经尝试过。** 我尝试将分发版本升级到 0.6.35，但无法正常工作。

```
pip install distribute --upgrade
Downloading/unpacking distribute from http://pypi.python.org/packages/source/d/distribute/distribute-0.6.35.tar.gz#md5=e55298c7e3a233df1a47a4881a0c9800
  Using download cache from /Users/nileshsharma/.pip/cache/http%3A%2F%2Fpypi.python.org%2Fpackages%2Fsource%2Fd%2Fdistribute%2Fdistribute-0.6.35.tar.gz
  Running setup.py egg_info for package distribute

Installing collected packages: distribute
  Found existing installation: distribute 0.6.26
    Not uninstalling distribute at /Users/nileshsharma/.local/lib/python2.7/site-packages/distribute-0.6.26-py2.7.egg, outside environment /Users/nilesh/env/foobar/lib/python2.7/site-packages/nilesh/bin/.. 
```

即使我尝试卸载此分发版本，也无法正常工作。

```
pip uninstall distribute
Not uninstalling distribute at /Users/nileshsharma/.local/lib/python2.7/site-packages/distribute-0.6.26-py2.7.egg, outside environment /Users/nileshsharma/Sites/env/foobar/lib/python2.7/site-packages/nilesh/bin/.. 
```

# javascript - 如何动态更改网站标题中的文字

> ID：15691875
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:49:49.597
> 
> 标签：javascript, html, title

几年前我看到一个网站有一个非常有趣的标题，当你打开这个网站时，网站的标题显示了大量的 1 和 0，它们在快速变化，有点像矩阵效应，最终它被修剪并变慢出到原网站标题。

关于如何重新创造这种效果的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:52:49.023

更改文档标题很容易：

```
document.title = '1001010'; 
```

将其与间隔相结合，您可以创建“动画”....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:53:05.317

您可以使用 document.title = 'new title' 通过 javascript 更改标题。

我猜你正在谈论的网站在循环中使用了一些 document.title = 'new title' ，其中有间隔来做你描述的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T20:57:01.930

[http://www.javascriptsource.com/page-details/dynamic-title.html](http://www.javascriptsource.com/page-details/dynamic-title.html)

这显然不会给您想要的 1 和 0 效果，但它确实向您展示了如何更改网站的标题。至于您想要的“矩阵效应”，您可以编写一个函数，以随机的 1 和 0 字符串开头，并不断随机更改它，直到第 10 次或插入第一个实际字母的任何迭代，然后插入第二个字母12日等

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T21:01:38.537

如果它不仅仅是文本的变化。您谈论的内容听起来像是动画图像或 .gif 动画背景图像。

此外，使用最新的 IE10 和 DirectWrite，您可以手动创建文本/字体并选择动画和操作文本，请查看此链接：[DirectWrite](http://msdn.microsoft.com/en-us/library/windows/desktop/dd371554%28v=vs.85%29.aspx)

# android - 如何将来自另一个类的对象绘制到画布上？

> ID：15691876
> 
> 赞同：0
> 
> 时间：2013-03-28T20:49:51.340
> 
> 标签：android, multithreading, android-canvas, surfaceview

我正在尝试创建一个程序，其中当我触摸设备的屏幕时，一个球会出来并动画。我将图像放在一个单独的类中，因为稍后我将需要这个 MyImage 类的多个实例，所以每当我触摸屏幕时，另一个球就会出来。

我有 MyImage 类，其中包含一个图像。该类扩展为 View 类。覆盖方法 onDraw 是图像被动画化的地方（在屏幕上弹跳）。

```
public class MyImage extends View {
Bitmap g;
float posY = 0;
float posX = 0;

boolean ud = true, lr = true;

public MyImage(Context context) {
    super(context);
    g = BitmapFactory.decodeResource(getResources(), R.drawable.ba);
}
@Override
protected void onDraw(Canvas canvas) {
    super.onDraw(canvas);
    canvas.drawColor(Color.WHITE);
    canvas.drawBitmap(g, posX, posY, null);

    ...... //code for animating

    invalidate();
}
} 
```

我想创建这个类的一个对象，这样它就会从 MainActivity 类中为我的另一个画布设置动画。

```
public class MainActivity extends Activity implements OnTouchListener{
..... //declarations

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    mySurfaceView = new MySurfaceView(this);
    mySurfaceView.setOnTouchListener(this);
    setContentView(mySurfaceView);
}

@Override
protected void onPause() {
    ....
}
@Override
protected void onResume() {
    ....
}

 Thread myThread;   
 Canvas canvas;

 public class MySurfaceView extends SurfaceView implements Runnable{
    SurfaceHolder myHolder;
    boolean isRunnable = false;

    public MySurfaceView(Context context) {
        super(context);
        myHolder = getHolder();
    }
    public void pause(){
        ....
    }

    public void resume(){
        isRunnable = true;
        myThread = new Thread(this);
        myThread.start();
    }

    @Override
    public void run() {
        while(isRunnable){
            if(!myHolder.getSurface().isValid()){
                continue;
            }
            canvas = myHolder.lockCanvas();
            canvas.drawRGB(100, 0, 0);

            myHolder.unlockCanvasAndPost(canvas);
        }
    }
}

@Override
public boolean onTouch(View v, MotionEvent me) {
    .....

    switch(me.getAction()){
    case MotionEvent.ACTION_DOWN:
        break;
    case MotionEvent.ACTION_UP:
        mi = new MyImage(this);

        canvas.drawBitmap(..) ;//Is it possible to convert object to Bitmap?

        break;
    }
    return true;
}
} 
```

问题是我不知道如何将 MyImage 的对象制作为 Bitmap 以便我可以将其绘制到画布中。而且我也不确定我所做的是否正确，因为在我的 MyImage 类中，我已经有一个画布，我认为它将覆盖主要活动的画布。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:11:37.477

是的，我可能会改变这种方法。为每个球创建一个视图没有多大意义。我会创建一个自定义视图。然后这个视图可以包含一个球列表。在该`onDraw()`视图的方法中，您可以绘制所有球。球可以是刚开始时具有默认半径的对象`Point`。`PointF`

类似的东西

```
private class MyView extends View {
    List<Point> balls;

    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);

        for(Point p : balls){
            canvas.drawCircle(p.x, p.y, 10, myPaint);
        }
    }
} 
```

# c# - 带有 2 个复选框的 WPF 绑定

> ID：15691884
> 
> 赞同：0
> 
> 时间：2013-03-28T20:50:08.460
> 
> 标签：c#, wpf, binding, checkbox

我正在尝试将 2 个复选框绑定在一起，以便在选中一个时，另一个复选框被禁用。

现在我只是想让任何东西工作。绑定一个，以便如果未选中它，则禁用它绑定的其他元素。最终，我希望它与所检查的内容相反（只检查一个或另一个。）我知道我将不得不为此使用转换器。IsChecked 绑定工作正常，而不是 IsEnabled 属性。任何帮助将不胜感激。

```
<GridViewColumn.CellTemplate>
     <DataTemplate>
          <Grid HorizontalAlignment="Stretch">
               <CheckBox Name="kioskRequiredCB"  IsChecked="{Binding DefaultKioskAsRequired}" IsEnabled="{Binding ElementName=kioskHiddenCB, Path=IsChecked,Mode=TwoWay}" />
           </Grid>
      </DataTemplate>
 </GridViewColumn.CellTemplate>

<GridViewColumn.CellTemplate>
     <DataTemplate>
          <Grid HorizontalAlignment="Stretch">
                <CheckBox Name="kioskHiddenCB"  IsChecked="{Binding DefaultKioskAsHidden}" IsEnabled="{Binding ElementName=kioskRequiredCB, Path=IsChecked,Mode=TwoWay}" />
          </Grid>
      </DataTemplate>
 </GridViewColumn.CellTemplate> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:05:42.493

您的两个复选框都在模板中声明，这些模板是单独的名称范围，因此无法看到彼此的名称来执行 ElementName 绑定。为了解决这个问题，您需要绑定到两者共有的数据，看起来您已经拥有了：

```
<GridViewColumn.CellTemplate>
     <DataTemplate>
          <Grid HorizontalAlignment="Stretch">
               <CheckBox Name="kioskRequiredCB"  IsChecked="{Binding DefaultKioskAsRequired}"
                         IsEnabled="{Binding DefaultKioskAsHidden, Converter={StaticResource SomeInvertingBooleanConverter}" />
           </Grid>
      </DataTemplate>
 </GridViewColumn.CellTemplate>

<GridViewColumn.CellTemplate>
     <DataTemplate>
          <Grid HorizontalAlignment="Stretch">
                <CheckBox Name="kioskHiddenCB"  IsChecked="{Binding DefaultKioskAsHidden}"
                          IsEnabled="{Binding DefaultKioskAsRequired, Converter={StaticResource SomeInvertingBooleanConverter}}" />
          </Grid>
      </DataTemplate>
 </GridViewColumn.CellTemplate> 
```

# php - 除非包含调试打印，否则 codeigniter 应用程序不会返回响应

> ID：15691887
> 
> 赞同：1
> 
> 时间：2013-03-28T20:50:22.390
> 
> 标签：php, debugging, codeigniter-2

我遇到了一个奇怪的问题，我拥有的一些通过 ssh 连接到设备并抓取日志的代码不再显示数据，除非我通过包含调试语句强制它。

这是控制器中的代码：

```
public function logs()
{
    try {
        $data['logcontents'] = $this->device_model->get_logs($this->uri->segment(6), $this->uri->segment(3));
        var_dump($data['logcontents']);
        $data['Name'] = $this->uri->segment(5);
        $this->load->view('includes/template', $data);
    }
    catch (Exception $e) {
        show_error($e->getMessage());
    }   
}// end logs 
```

这是视图中的逻辑：

```
<div class="container-fluid">
  <h2><?php echo $Name; ?> Logs</h2> 
          <div class="row-fluid">
            <div class="span12">
                <table class="table table-bordered">
                <thead>
                    <tr>
                          <th>Log Contents:</th>                        
                    </tr>
                </thead>
                <tbody>
                    <p>
                        <tr>                                        
                        <td><pre><?php print_r($logcontents) ?></pre></td>                                          
                        </tr>
                    </p>
                </tbody>
                </table>
            </div>

          </div><!--/row-->
</div> 
```

如果我删除控制器方法中的 var_dump() 语句，Web 应用程序将只是坐在那里而不返回/显示任何内容。如果我包含它，我会转储数据，并且还会获得包含预期结果的表格。

至于如何解决这个问题，你能指出我正确的方向吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-01T20:58:19.793

您是否尝试过循环打印值？

```
<?php foreach $logcontents as $log {?>
  <tr>
    <td><?=$log?></td>                                          
  </tr>
<?php } ?> 
```

# ruby - 如何在 ruby webcrawler 中检查空页面和 HTTPErrors

> ID：15691892
> 
> 赞同：1
> 
> 时间：2013-03-28T20:50:36.717
> 
> 标签：ruby, nokogiri

此代码从谷歌图片中随机抓取一张图片。但是，当网络爬虫尝试搜索谷歌没有显示结果的术语时，我会收到错误。当谷歌向网络爬虫提供不再存在的图像时，我也会遇到错误。我如何编写此代码，以便在遇到错误时重新运行并尝试获取另一个图像。

```
require 'open-uri'
require 'nokogiri'
url = "https://www.google.com/search?hl=en&q=" + rand(0-999999).to_s + "&ion=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.42553238,d.dmg&biw=1354&bih=622&um=1&ie=UTF-8&tbm=isch&source=og&sa=N&tab=wi&ei=sNEfUf-fHvLx0wG7uoG4DQ"
googim = Nokogiri::HTML(open(url))
googimstr = googim.to_s
durl = googim.to_s.split('imgurl=')[1].split('&amp')[0]

name = durl.reverse.split("/")[0].reverse

open("./data/images/#{name}", 'wb') do |file|
          file << open(durl).read
end 
```

这是我收到的两种错误

第一个错误：

```
usr/lib/ruby/2.0.0/open-uri.rb:353:in `open_http': 400 Bad Request (OpenURI::HTTPError)
    from /usr/lib/ruby/2.0.0/open-uri.rb:708:in `buffer_open'
    from /usr/lib/ruby/2.0.0/open-uri.rb:210:in `block in open_loop'
    from /usr/lib/ruby/2.0.0/open-uri.rb:208:in `catch'
    from /usr/lib/ruby/2.0.0/open-uri.rb:208:in `open_loop'
    from /usr/lib/ruby/2.0.0/open-uri.rb:149:in `open_uri'
    from /usr/lib/ruby/2.0.0/open-uri.rb:688:in `open'
    from /usr/lib/ruby/2.0.0/open-uri.rb:34:in `open'
    from wc.rb:11:in `block in <main>'
    from /usr/lib/ruby/2.0.0/open-uri.rb:36:in `open'
    from /usr/lib/ruby/2.0.0/open-uri.rb:36:in `open'
    from wc.rb:10:in `<main>' 
```

第二个错误：

```
wc.rb:6:in `split': invalid byte sequence in UTF-8 (ArgumentError)
    from wc.rb:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:34:29.410

您可以将代码的适当部分包装在一个`begin/end`块和`rescue`异常中。例如：

```
begin
  open("./data/images/#{name}", 'wb') do |file|
    file << open(durl).read
  end
rescue => e
  puts "some failure: #{e}"
end 
```

这是 Pickaxe/Programming Ruby 的 Exceptions、Catch 和 Throw 章节的链接：[http ://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_exceptions.html](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_exceptions.html)

# javascript - Dojo, dgrid 定义未定义

> ID：15691894
> 
> 赞同：2
> 
> 时间：2013-03-28T20:50:39.637
> 
> 标签：javascript, dojo, undefined, dgrid

我是 dojo 和 dgrid 的新手。我正在关注网站上的教程，但我有两个错误

`Uncaught ReferenceError: define is not defined dojo.js:1`

`Uncaught ReferenceError: require is not defined index.html:10`

[我从http://dojofoundation.org/packages/dgrid/tutorials/hello_dgrid/](http://dojofoundation.org/packages/dgrid/tutorials/hello_dgrid/)复制了代码，并按照所说的更改了文件夹名称。

文件在正确的位置，我找不到问题。也许我需要更改 dojo 文件中的某些内容。

```
<script src="dojodatagrid\dojo.js" data-dojo-config="async: true"></script>
<script>
    require(["dgrid/Grid", "dojo/domReady!"], 
    function(Grid){
        var data = [
            { first: "Bob", last: "Barker", age: 89 },
            { first: "Vanna", last: "White", age: 55 },
            { first: "Pat", last: "Sajak", age: 65 }
        ];

        var grid = new Grid({
            columns: {
                first: "First Name",
                last: "Last Name",
                age: "Age"
            }
        }, "grid");
        grid.renderArray(data);
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T12:44:44.053

作为测试，尝试使用这样的 CDN：

`<script data-dojo-config="async: 1" src="//ajax.googleapis.com/ajax/libs/dojo/1.8.3/dojo/dojo.js"></script>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T09:11:28.147

您可能在 dojodatagrid 中使用 CPM 安装了 dgrid。您的 src 必须是**src="dojodatagrid/dojo/dojo.js"**而不是**src="dojodatagrid/dojo.js"**

# android - 想要在按钮单击时更改图像视图中的图像

> ID：15691896
> 
> 赞同：0
> 
> 时间：2013-03-28T20:50:45.177
> 
> 标签：android, android-imageview

我正在尝试制作一种存储电视节目角色的数据库。只是为了有事做。

我在用户个人资料页面上有 6 个纯白色的图像视图，下面是他们最喜欢的。当用户单击字符页面上的按钮时，其相应图像的缩略图应替换第一个图像视图。

如果第一个图像视图已经更改，则将其移至第二个，依此类推，直到您到达第 6 个。此时用户会收到一条消息，说不能再添加了。

任何想法如何实现这一目标？

编辑：到目前为止我所拥有的

```
image.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub

        empty.setImageResource(R.drawable.pikachuthumb);

        empty.remove(R.id.empty1);

        if(empty.getCount()==0)
        {
            Toast.makeText(myContext, "No more favourites can be added. Please Refresh.", Toast.LENGTH_SHORT).show();
        }
        else
        {

        }

    }

    public void main(String[] args) {
        // TODO Auto-generated method stub

        List<ImageView> empty = new ArrayList<ImageView>();

        empty.add(R.id.empty1);
        empty.add(R.id.empty2);
        empty.add(R.id.empty3);
        empty.add(R.id.empty4);
        empty.add(R.id.empty5);
        empty.add(R.id.empty6);

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T22:45:02.583

一种简单的方法是在单击按钮的第一个视图（即索引视图）上拥有`ArrayList`所有`ImageView`s 并调用`setImageResource()`方法（或任何其他更改图像的方法） 。`0th`接下来是从列表中删除图像视图，一旦它被更改。继续重复该过程，除非所有图像视图都已更改，否则数组列表将为空，因此请显示一些关于此的敬酒消息或友好消息。

# javascript - 创建具有动态名称的 KnockoutJS 可观察对象

> ID：15691897
> 
> 赞同：3
> 
> 时间：2013-03-28T20:50:49.860
> 
> 标签：javascript, knockout.js

我正在为我的应用程序使用我自己的简单模板系统，并且每页将加载未知数量的“相同”模板。

所以基本上，我通过 ajax 调用获取一些数据并获得一个 uniqueId。然后，我将一个模板加载到我的页面中，并使用 uniqueId 应用 id 和 data-bind="with:"。

```
<div id="content-uniqueId">
    <div data-bind="with: uniqueId">
        ...
    </div>
</div> 
```

然后我调用一个函数并尝试使用 uniqueId 创建一个 observableArray，以便它绑定到我的“with”。

就像是：

```
function(uniqueId) {
     var theObservable = uniqueId;
     theObservable = ko.observableArray(); // make the observable name equal to uniqueId
     // get some data
     theObservable(new data);
} 
```

我创建了一个 JS Fiddle 来帮助解决问题，但它不起作用，因为我没有获取 ajax 数据或传递唯一的 id。

[JS小提琴在这里](http://jsfiddle.net/EYHuY/1/)

**编辑：**

根据以下 Tyrsius 的建议[更新了 JS Fiddle 。](http://jsfiddle.net/EYHuY/4/)

```
this[uniqueId] = ko.observableArray(new entityApp.dataContext.EntityModel(data)); 
```

绝对接近一步，但我收到一个错误：

*初始化可观察数组时传递的参数必须是数组，或者为空，或者未定义*

但是'new entityApp.dataContext.EntityModel(data)'返回一个对象数组，所以应该没问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T21:18:08.420

Javascript 通过其对象索引器使动态分配和反射变得简单：

```
var ViewModel = function(propName) {
    this[propName] = ko.observable("reflection");
};

ko.applyBindings(new ViewModel("dynamic")); 
```

这是一个演示绑定[的小提琴。](http://jsfiddle.net/FHz4k/1/)

# c - 在链表中错误地打印字符串

> ID：15691906
> 
> 赞同：0
> 
> 时间：2013-03-28T20:51:16.090
> 
> 标签：c, linked-list

这是我的代码

```
#include<stdio.h>
#include<stdlib.h>
#include<string.h>

struct node {
    char courseID[6];
    int section;
    int credits;
    struct node *link;
};

int main(void)
{
    int run=1;
    char coursetemp[6];
    int option, num, num2;
    struct node *ptr;
    void add(struct node **, int, int, char[]);
    void display(struct node *);
    void del(struct node *, int);

    ptr = NULL;
    while (run==1)
    {
        printf("Main Menu\n 1\. Add Course\n2.Delete Course\n3\. Display Enrolled courses\n");
        scanf("%d", &option);
        if (option == 1)
        {
            printf("Please enter the course ID\n");
            scanf("%s", coursetemp);
            printf("Please enter the course section, and amount of credits it's worth\n");
            scanf("%d %d", &num, &num2);
            add(&ptr, num, num2, coursetemp);
            display(ptr);
        }
        if (option == 2)
        {
            printf("Enter the element to delete\n");
            scanf("%d", &num);
            del(ptr, num);
        }
        if (option == 3)
        {
            display(ptr);
        }
        else
        {
            //printf("Please enter a proper selection\n");
        }   //end of while
    }
    return 0;
}  
void display(struct node *pt)
{
    while (pt != NULL)
    {
        printf("%s %d %d\n", pt->courseID, pt->section, pt->credits);
        pt = pt->link;
    }
} 
```

只要课程名称只是字母，这就像我想要的那样工作。但是一旦我尝试使用字母和数字前。CIS444 我得到一堆随机的 ascii 字符。我觉得这是一个简单的修复，但我不记得如何

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T20:57:28.227

我怀疑您正在输入 6 个或更多字符的课程 ID。该`courseID`成员只能持有一个 5 个字符的 ID，其末尾带有一个空终止符。例如，如果您输入了一个 6 个字符的课程 ID，那么它将复制 7 个字节`courseID`，并根据结构对齐方式覆盖结构中以下成员的一部分。还要注意，在这种情况下，变量`coursetemp`也将被写入末尾（导致未定义的行为）。

# c# - ajax调用后如何重置表单

> ID：15691907
> 
> 赞同：3
> 
> 时间：2013-03-28T20:51:18.733
> 
> 标签：jquery, c#, jquery, asp.net-mvc, asp.net-mvc-3, razor

```
@Html.DropDownListFor(
    x = > x.LanguageId,
    new SelectList(Model.Languages, "LanguageId", "Name"),
    "--- select ---",
    new {
        id = "ddlLanguage", 
        @class = "profile-setting-dropdown"
    }) 
```

我想在 ajax 提交后，用这个下拉菜单重置表单。
是否可以重置整个表格？
如果不是如何`option item`从[jquery](/questions/tagged/jquery "显示标记为“jquery”的问题")中选择，因为选项项没有`value`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T20:53:56.213

使用 JavaScript `document.formname.reset()`：.

# asp.net-mvc - MVC 4 导出到 Excel 失败

> ID：15691910
> 
> 赞同：0
> 
> 时间：2013-03-28T20:51:42.070
> 
> 标签：asp.net-mvc, export-to-excel, contenttype

我在控制器和 MVC 4 应用程序中有以下代码

```
 Response.AddHeader("Content-Disposition", "attachment; filename=export.xml");
    Response.AddHeader("Content-type", "vnd.openxmlformats-officedocument.spreadsheetml.sheet");

    var rows = data.Split('\n');
    var sheet = "<?xml version=\"1.0\" encoding=\"utf-8\"?>" + Environment.NewLine;
    sheet += "<?mso-application progid=\"Excel.Sheet\"?>" + Environment.NewLine;

    sheet += "<ss:Workbook xmlns:ss=\"urn:schemas-microsoft-com:office:spreadsheet\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns:html=\"http://www.w3.org/tr/rec-html40\">" + Environment.NewLine;
    sheet += "<ss:Worksheet ss:Name=\"Sheet1\">" + Environment.NewLine;
    sheet += "<ss:Table>" + Environment.NewLine;

    foreach (var r in rows)
    {
        sheet += "<ss:Row>" + Environment.NewLine;

        var columns = r.Split(',');

        foreach (var column in columns)
        {
            sheet += "<ss:Cell>" + Environment.NewLine;
            sheet += "<ss:Data ss:Type=\"String\">" + column + "</ss:Data>" + Environment.NewLine;
            sheet += "</ss:Cell>" + Environment.NewLine;
        }
        sheet += "</ss:Row>" + Environment.NewLine;
    }
    sheet += "</ss:Table>" + Environment.NewLine;
    sheet += "</ss:Worksheet>" + Environment.NewLine;
    sheet += "</ss:Workbook>" + Environment.NewLine;

    return Content(sheet); 
```

如果我放置一个断点并将工作表变量的值复制到记事本中并将其保存在我的机器上本地作为 export.xml 我可以打开该文件并且它没有问题。

我遇到的问题是，当我让控制器中的此方法继续运行时，我会在浏览器中收到提示以打开文件，这是我所期望的，但是当我单击打开时，excel会打开，然后出现错误信息。我得到的错误信息是

Microsoft Excel 无法打开或保存更多文档，因为没有足够的可用内存或磁盘空间。

我缺少什么让这个控制器将正确的信息传递回浏览器。

# ios - 如何设置包含 %%@% 和 %@ 值的 NSString？

> ID：15691917
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:52:26.097
> 
> 标签：ios, objective-c, nsstring

我想将 NSString 设置为`@"SELECT a, b FROM abc WHERE c LIKE %MYVALUE%"`. 所以我像这样初始化我`NSString`的`initWithFormat`：

```
NSString * query = [[NSString alloc] initWithFormat:@"SELECT a, b FROM abcd WHERE c LIKE %%@%%", searchBar.text]; 
```

但这当然行不通。

**如何构建这种查询？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T20:54:13.247

写入以在字符串`%%`中包含 a 。`%`

```
@"SELECT a, b FROM abcd WHERE c LIKE '%%%@%%'" 
```

您当前的字符串 ( `%%@%%`) 将被解释为百分号、at 符号、百分号 ( `%@%`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:54:44.077

您不需要用 标记`LIKE`条件的开始和结束`'`吗？

所以`initWithFormat:@"SELECT a, b FROM abcd WHERE c LIKE '%%%@%%'", searchBar.text];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:56:02.877

使用您当前的 %%@%%，第一个 % 转义第二个 %，然后您只有一个 @，然后您有另一个 % 转义另一个 %，导致 %@%

你真正想要的是 %%@%，但你需要用 % 转义 %，这样你才能得到`%%%@%%`结果`%searchBar.Text%`

# ios - 在 UITableViewCell 的突出显示上更改附件视图

> ID：15691923
> 
> 赞同：2
> 
> 时间：2013-03-28T20:52:47.800
> 
> 标签：ios, objective-c, uitableview, ios6

我正在尝试让我的 UITableViewCell 在突出显示时更改它的附件视图。因此，突出显示时配件会更暗。到目前为止，我已经设法使它工作得很好，但有一个例外。当按下一个单元格时，它会导致该单元格突出显示，但是当按下该按钮并取消突出显示时，accessoryView 会保留其突出显示的图像。

有什么方法可以检测突出显示是否被取消，以便我可以将附件视图更改回它应该是什么？我是否需要创建 UITableViewCell 的子类才能完成此操作？任何帮助是极大的赞赏。谢谢！

**正常状态：** ![正常细胞状态](../Images/f9f196ff2d8c1531102591e1662b17b4.png)

**高亮状态** ![在此处输入图像描述](../Images/b0c1724f102ac8bb434594ddb416fa56.png)

**按下并移动触摸后（我想避免）：** ![在此处输入图像描述](../Images/ff75f403a3e43dace50aab6f3b7f47a1.png)

```
 - (void)tableView:(UITableView *)tableView didHighlightRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
    UIImageView *accessoryView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"accessoryDark.png"]];
    cell.accessoryView = accessoryView;
}

- (void)tableView:(UITableView *)tableView didUnhighlightRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = [self.tableView cellForRowAtIndexPath:indexPath];
    UIImageView *accessoryView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"accessory.png"]];
    cell.accessoryView = accessoryView;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-28T21:22:22.190

我尝试复制您的设置，我发现传递给的 indexPath`didUnhighlightRowAtIndexPath`包含一个 NSNotFound 行。所以你可能想检查你进入的单元格是否`didUnhighlightRowAtIndexPath`非零。如果事实证明您将错误的 indexPaths 传递给 didUnhighlightRowAtIndexPath，那么我认为我们可以将其归结为新 API 中的一个错误，您将要使用 didSelectRow 和 didDeselectRow，或者子类 UITableViewCell 并注意更改到您的子类中选定和突出显示的状态。

您可以尝试的另一件事是将附件视图设置为

```
[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"accessory"] highlightedImage:[UIImage imageNamed:@"accessoryDark"]]; 
```

然后（理论上）附件视图将根据单元格的突出显示状态自动显示正确的突出显示或未突出显示的图像，并且您不必在委托方法中观察这些更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T21:06:35.563

尝试使用`didSelectRow...`和`didDeselectRow...`。您还应该保留对所选单元格的索引路径的引用。这样滚动不会弄乱你的单元格（当然，在`cellForRow...`你检查当前单元格是否是选定的单元格，并相应地设置附件视图）。希望这可以帮助！

# android - 从 Mediacodec 同步解码的音频和视频数据

> ID：15691933
> 
> 赞同：7
> 
> 时间：2013-03-28T20:53:17.500
> 
> 标签：android, android-mediaplayer

我想使用`MediaExtractor`和`MediaCodec`API 编写一个简单的音频/视频播放器。

我能够解码和渲染`audio`and `video`。但是，我错过了`audio - video`同步。

我找不到任何 API 来控制 和 之间的`audio`同步`video`。有人可以告诉我，如何同步解码`audio`和`video`数据？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-28T23:48:19.170

在 Android 源代码中，有一个`player`基于`MediaCodec`API 的示例引擎实现。您可以检查`SimplePlayer`位于[`frameworks/av/cmds/stagefright/SimplePlayer.cpp`](http://androidxref.com/4.2.2_r1/xref/frameworks/av/cmds/stagefright/SimplePlayer.cpp)。

在这个播放器引擎实现中，来自 的输出`MediaCodec`被推`dequeued`入队列，如下[所示](http://androidxref.com/4.2.2_r1/xref/frameworks/av/cmds/stagefright/SimplePlayer.cpp#450)。请检查第 439 - 450 行以获得完整的图片。

一旦缓冲区可用，这里就实现了一个简单[的](http://androidxref.com/4.2.2_r1/xref/frameworks/av/cmds/stagefright/SimplePlayer.cpp#508)`AV Sync`机制。请参阅第 508 -521 行。在这个例子中，只考虑一个轨道，因此，即当前时间是从ie导出的。`nowUs``systemTime``ALooper::nowUs`

`audio`在您的代码中，您可以考虑始终在`first-come-first-serve`基础上进行渲染，并且对于您的`video`轨道，您可以从轨道**派生**。`nowUs``audio`

一个简单的实现可能是`nowUs = getAudioLastPresentationTime()`where，`getAudioLastPresentationTime`将返回从 t​​o`presentationTimeUs`发送的最后`audio` `MediaCodec`一个`audio renderer`。

# c++ - 插入类作为 STL 映射键值

> ID：15691935
> 
> 赞同：1
> 
> 时间：2013-03-28T20:53:24.370
> 
> 标签：c++

如果映射，我想添加一个由两个整数值（如 x 和 y 位置）组成的简单类作为键值，我想这样做我需要重载 < 运算符，但由于某种原因我无法正确. 这正是我想挤进去的关键：

```
struct position {
 int x;
 int y;
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:16:01.957

标准方法是将`make_pair`其插入地图：

```
map<int,position> ip;
position pos{1,8};
std::pair<int,position> pair=std::make_pair<int,position>(1,pos);
ip.insert(pair); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T21:51:19.187

这是通常的方式。

```
bool operator<(position p, position q)
{
    return p.x < q.x || (p.x == q.x && p.y < q.y);
} 
```

它为位置提供了*严格的弱排序*，这是`std::map`. 顺序本身有点随意，但这通常并不重要。

# arrays - 在 Bash 中的不同行上打印数组元素？

> ID：15691942
> 
> 赞同：286
> 
> 时间：2013-03-28T20:53:47.937
> 
> 标签：arrays, bash

如何在单独的行上打印 Bash 数组的数组元素？这个可行，但肯定有更好的方法：

```
$ my_array=(one two three)
$ for i in ${my_array[@]}; do echo $i; done
one
two
three 
```

试过这个，但没有奏效：

```
$ IFS=$'\n' echo ${my_array[*]}
one two three 
```

* * *

## 回答 #1

> 赞同：553
> 
> 时间：2013-03-28T20:57:30.790

尝试这样做：

```
$ printf '%s\n' "${my_array[@]}" 
```

`$@`和的区别`$*`：

*   未引用，结果未指定。在 Bash 中，两者都扩展为单独的 args，然后是 wordsplit 和 globbed。

*   引用，`"$@"`将每个元素扩展为一个单独的参数，同时`"$*"` 扩展为合并为一个参数的 args：（`"$1c$2c..."`其中`c`第一个字符是`IFS`）。

你几乎总是想要`"$@"`. 也一样`"${arr[@]}"`。

**总是引用他们！**

* * *

## 回答 #2

> 赞同：85
> 
> 时间：2013-03-28T21:00:06.553

只需引用 echo 的参数：

```
( IFS=$'\n'; echo "${my_array[*]}" ) 
```

子外壳有助于在使用后恢复 IFS

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2015-05-20T02:32:36.203

用于：*_*

```
for each in "${alpha[@]}"
do
  echo "$each"
done 
```

使用*历史*；请注意，如果您的值包含以下内容，这将失败`!`：

```
history -p "${alpha[@]}" 
```

使用*基本名称*；请注意，如果您的值包含以下内容，这将失败`/`：

```
basename -a "${alpha[@]}" 
```

使用*shuf* ; 请注意，结果可能不会按顺序出现：

```
shuf -e "${alpha[@]}" 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-02-04T00:07:43.050

另一个有用的变体是 pipe to `tr`：

`echo "${my_array[@]}" | tr ' ' '\n'`

这看起来简单而紧凑

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-05-01T08:52:17.783

我在一个巨大的 for...if 循环中尝试了答案，但没有得到任何快乐 - 所以我这样做了，也许很乱，但完成了工作：

```
 # EXP_LIST2 is iterated    
 # imagine a for loop
     EXP_LIST="List item"    
     EXP_LIST2="$EXP_LIST2 \n $EXP_LIST"
 done 
 echo -e $EXP_LIST2 
```

虽然这在列表中添加了一个空格，但这很好 - 我希望它缩进一点。还假设“\n”可以打印在原始 $EP_LIST 中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-02-06T21:54:05.657

你可以使用 Bash C Style For Loop 来做你想做的事。

```
my_array=(one two three)

for ((i=0; i < ${#my_array[@]}; i++ )); do echo "${my_array[$i]}"; done
one
two
three 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-12-22T18:19:53.317

我发现您可以使用 eval 来避免使用子外壳。因此：

```
IFS=$'\n' eval 'echo "${my_array[*]}"' 
```

# javascript - 如何在圆周围的点上绘制平滑路径

> ID：15691943
> 
> 赞同：2
> 
> 时间：2013-03-28T20:53:48.773
> 
> 标签：javascript, canvas, bezier, linegraph

这可能是一个数学问题......我在圆轴上有一组点。让我们称圆 x 和点的半径为 y。问题是双重的：

1.  我想要一条跨越所有点的平滑线。让我们假设它是一个正常的 x/y 图：我知道确切的坐标。现在如何在所有这些点之间创建一条平滑的路径？
2.  这不是正常的 x/y 图。这是一个 a/r 图（角度/半径）。我想可以应用 1\. 中的解决方案，但是我在哪里画那条线？（我不确定它是一个 a/r 图是否会使其变得更加困难。）

（我想`<canvas>`用 Javascript 创建这个。我已经为急切的人设置了一些东西：http: [//jsfiddle.net/rudiedirkx/5LfdP/1/](http://jsfiddle.net/rudiedirkx/5LfdP/1/)）

我正在寻找的是

![平滑线图](../Images/670698eb1ddefa2437cd6eb03f885f81.png)

围绕一个圆圈，结束会议（所以 0% = 350 和 100% = 350）。

感觉就像三次贝塞尔曲线对于创建点之间的平滑路径是必要的，但这就是我所得到的。[这是我通常使用的贝塞尔函数。](https://gist.github.com/rudiedirkx/5266253/raw/87e4f7cd4a569b538c13b36d03d6ed8ed5fcc570/bezier.js)

我说得有道理吗？我找不到更好的图片了。（可能是因为我不知道它叫什么。）

**编辑1：**我尝试绘制它的外观：[http](http://www.sketchtoy.com/26800595) ://www.sketchtoy.com/26800595 （忘记动画，这就是sketchtoy的工作原理）

**编辑 2：**我已经使用 quadraticCurveTo() 更新了我的[小提琴演示](http://jsfiddle.net/rudiedirkx/5LfdP/2/show/)，但这还不够好。我需要贝塞尔曲线和两倍的曲线才能使曲线通过点。就像[关于样条插值](http://scaledinnovation.com/analytics/splines/aboutSplines.html)，但希望更简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T16:29:44.620

如果您有图表的函数表达式，您可以简单地绘制它，将您的坐标转换为具有圆形偏移的极坐标。使用以下映射将“x”视为您的角度（min_x 为角度“0”，max_x 为角度“360”，或者对于计算机，“2π”）：

```
φ (the angle) = map x from interval (min_x,max_x) to interval (0,2π);
a (the amplitude) = map y from (min_y,max_y) to (0, max_distance); 
```

然后，您可以绘制函数所需的 x/y 坐标：

```
nx = a * cos(φ);
ny = a * sin(φ); 
```

对于图形绘图，我强烈建议为您的值构建一个查找表，这样您就可以避免不断计算原始 x/y 值。如果您没有函数，而只有一系列点，那么您实际上已经有了这个 LUT。

在转换 LUT x/y 坐标后，通过它们中的每一个绘制一条漂亮的曲线可能是 Catmull-Rom 样条线的工作，而不是 Bezier，因为 Catmull-Rom 样条线会通过您使用的每个点，而 Bezier 曲线不会t，它们绕过除起点和终点之外的每个点，因此它们不适合您想做的事情。

# sql - MAX 日期分组不正确

> ID：15691949
> 
> 赞同：1
> 
> 时间：2013-03-28T20:54:07.700
> 
> 标签：sql, sql-server, tsql, max

```
SELECT
    ij.IJITEM AS Part,
    ij.IJLOC AS Location,
    ib.IFQOH AS QOH,
    MAX(ij.IJDATE) AS Inv_Date
FROM
    dbo.S2K_IJALL ij
    LEFT OUTER JOIN dbo.S2K_IB ib 
    ON ib.IFITEM = ij.IJITEM AND ib.IFLOC = ij.IJLOC
WHERE
    IJITEM LIKE '%-IC'
AND
    IJRBAL < 0
GROUP BY
    ij.IJITEM,
    ij.IJLOC,
    ib.IFQOH 
```

我需要在上面的查询中添加一个字段。当我这样做时，MAX 日期字段不会保持。我得到添加的字段具有值的每条记录。我怎样才能拉回 MAX 日期该字段的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:08:34.353

假设 SQL Server 2005 或更高版本（请始终指定您的版本！）：

```
;WITH x AS 
(
  SELECT
    ij.IJITEM AS Part,
    ij.IJLOC AS Location,
    ib.IFQOH AS QOH,

    -- any other non-grouping column(s) can go here,

    ij.IJDATE AS Inv_date,
    rn = ROW_NUMBER() OVER (PARTITION BY
      ij.IJITEM, ij.IJLOC, ib.IFQOH ORDER BY ij.IJDATE DESC)
  FROM
    dbo.S2K_IJALL ij
    LEFT OUTER JOIN dbo.S2K_IB ib 
    ON ib.IFITEM = ij.IJITEM AND ib.IFLOC = ij.IJLOC
  WHERE IJITEM LIKE '%-IC'
  AND IJRBAL < 0
)
SELECT Part, Location, QOH, Inv_date
  FROM x WHERE rn = 1; 
```

您可能需要告诉我们您想如何处理平局，可能有多行具有相同的分组和相同的 max(date) 但您要添加的列的值不同...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:58:09.197

将上面的查询加入到包含关键字段上的新字段以及 IJDate = Inv_Date 的表中，这实际上是 MAX(IJDATE)。选择第一个查询中的所有字段以及新字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T20:59:42.173

如果您有更多列要添加，并且结果在您 时变得混乱`GROUP BY`，您可以更改查询以使用子查询：

```
select ij.IJITEM AS Part,
  ij.IJLOC AS Location,
  ib.IFQOH AS QOH,
  ij2.ijdate Inv_date,
  --- add other columns
from dbo.S2K_IJALL ij1
inner join
(
  select MAX(IJDATE) ijdate, IJITEM, IJLOC
  from dbo.S2K_IJALL
  WHERE IJITEM LIKE '%-IC'
    AND IJRBAL < 0
  group by IJITEM, IJLOC
) ij2
  on ij1.ijdate = ij2.ijdate
  and ij1.IJITEM = ij2.IJITEM
  and ij1.IJLOC = ij2.IJLOC
LEFT OUTER JOIN dbo.S2K_IB ib 
  ON ib.IFITEM = ij1.IJITEM 
  AND ib.IFLOC = ij1.IJLOC
WHERE ij1.IJITEM LIKE '%-IC'
  AND ij1.IJRBAL < 0 
```

# inno-setup - 在 Inno Setup 安装程序中隐藏“就绪”页面

> ID：15691956
> 
> 赞同：1
> 
> 时间：2013-03-28T20:54:48.800
> 
> 标签：inno-setup

我有一个小设置项目来运行 vb.net 项目，安装/设置环境在 32 位和 64 位和 inno-setup 帮助我运行它的正确版本。这是代码，很短。我的问题是`DisableReadyPage=yes`仍然显示准备安装页面。如何摆脱它？

即使我禁用`[file]`并且`[run]`准备安装页面的部分仍然存在...

```
[Setup]
AppName=xxx Environment
AppVerName=xxx Environment
AppPublisher=zzz
AppPublisherURL=somewebaddress1
AppSupportURL=somewebaddress2
AppUpdatesURL=somewebaddress3
AppID="xxx Environment"
DefaultDirName={pf}\zzz
PrivilegesRequired=admin
DefaultGroupName=xxx Environment
CreateUninstallRegKey=no
DisableDirPage=yes
DisableProgramGroupPage=yes
DisableWelcomePage=yes
DisableReadyPage=yes
DisableFinishedPage=yes
DirExistsWarning=yes
OutputDir=.
OutputBaseFilename="Setup"

[Files]
Source: Unzip.exe; DestDir: {tmp}; Flags: deleteafterinstall
Source: Setup.zip; DestDir: {tmp}; Flags: deleteafterinstall

[Run]
Filename: "{tmp}\UNZIP.EXE"; Parameters: "{tmp}\Setup.zip -d {tmp}"
Filename: "{code:RunInstallExe}"

[Code]
function GetProcessorTypeId (): Integer;
var
  s: String;
  i: Integer;
begin

  case ProcessorArchitecture of
    paX86:  i := 1;//s := 'x86';
    paX64:  i := 2;//s := 'x64';
    paIA64: i := 3;//s := 'Itanium';
  else
    i := 0;//s := 'Unrecognized';
  end;
  Result := i;

end;

function RunInstallExe(Param: String): String;
var
  _path: string;
  _procId: Integer;
begin

  _procId := GetProcessorTypeId();
  if _procId = 1 then
    begin
      _path := ExpandConstant('{tmp}\Install86Environ.exe');
    end
  else if _procId = 2 then
    begin
      _path := ExpandConstant('{tmp}\Install86Environ.exe');;  //run in wow64 mode
    end
  else if _procId = 3 then
    begin
      _path := ExpandConstant('{tmp}\Install64Environ.exe');;
    end
  else
    begin
      _path := '';
    end

  if FileExists(_path) then
    begin
        Result := _path;
    end
  else
    begin
        MsgBox('Installation package not found.', mbCriticalError, MB_OK);
    end

end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-28T21:44:28.607

根据[文档](http://www.jrsoftware.org/ishelp/index.php?topic=setup_disablereadypage)：

> 当安装程序未静默运行时，如果在“准备安装”向导页面之前没有显示其他向导页面，则忽略此指令。

使用您拥有的所有 Disable*Page 指令，它是显示的第一页。

您禁用所有页面的目标是什么？

# javascript - 按钮应该只显示 iphone

> ID：15691957
> 
> 赞同：-1
> 
> 时间：2013-03-28T20:54:51.840
> 
> 标签：javascript, html, css, twitter-bootstrap

我正在使用 twitter bootstrap 布局....当我缩小浏览器窗口时，您将通过单击按钮看到一个菜单....但该按钮应仅显示 iphone 布局.....但该按钮正在显示对于桌面如何修复它....

[http://jsfiddle.net/r4SqC/4/embedded/result/](http://jsfiddle.net/r4SqC/4/embedded/result/)

```
<a class="btn btn-navbar collapsed" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                </a>

.navbar .btn-navbar {
background: none repeat scroll 0 0 #040404;
display: block;
padding: 0;
}
.navbar-inverse .btn-navbar {
color: #ffffff;
text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.25);
background-color: #0e0e0e;
background-image: -moz-linear-gradient(top, #151515, #040404);
background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#151515), to(#040404));
background-image: -webkit-linear-gradient(top, #151515, #040404);
background-image: -o-linear-gradient(top, #151515, #040404);
background-image: linear-gradient(to bottom, #151515, #040404);
background-repeat: repeat-x;
border-color: #040404 #040404 #000000;
border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25);
filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff151515', endColorstr='#ff040404', GradientType=0);
filter: progid:DXImageTransform.Microsoft.gradient(enabled=false);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-28T21:15:44.757

`.visible-phone`如果您只希望元素在手机上显示，则可以使用该类。请参阅“响应式实用程序类”：http: [//twitter.github.com/bootstrap/scaffolding.html#responsive](http://twitter.github.com/bootstrap/scaffolding.html#responsive)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T21:19:23.870

您可以使用媒体查询仅定位特定大小的屏幕（不包括桌面，但包括iPhone*等*移动浏览器）。iPhone 的屏幕尺寸为纵向 320 像素 x 480 像素，横向 480x320 （[请参阅此处](http://upstageapp.com/resources)）。所以你会有类似的东西：

```
@media only screen and (max-width: 480px) {
    selector { color: red }
} 
```

Mozilla 开发者网络有[一篇很好的文章来详细介绍](https://developer.mozilla.org/en-US/docs/CSS/Media_queries)。

# unit-testing - Grails 在子集合中获得最新 - 排序不起作用？

> ID：15691958
> 
> 赞同：0
> 
> 时间：2013-03-28T20:54:52.633
> 
> 标签：unit-testing, sorting, grails-orm

在这里挠头，不确定是代码还是测试。

我们需要跟踪对象的状态变化以及这些变化的历史。有时只应显示最新状态，而有时则需要整个历史列表。

最初我们认为“小菜一碟”遵循文档（grails.org/doc/2.2.x/ref/Database%20Mapping/sort.html）和这个人发现的内容（stackoverflow.com/questions/12482995/sort-a- collection-in-grails-by-date ）并且是金色的。

来到单元测试时间，我们创建了测试以制作两个状态并拉出最新的。宾果游戏有效。然后，麻烦；随机间隔，测试失败。所以我们似乎找到[了这个家伙发现](http://grails.1312388.n4.nabble.com/Sort-not-working-td3258369.html)的关于 sort 不起作用的地方。也许我错过了一些明显的东西，希望一双新的眼睛能看到它。

```
class mainObject {
    static hasMany = [ statusHistory : StatusHistory]

    static mapping = {
           sort id: 'asc'
           statusHistory sort:"statusDate"
    }

 String getCurrentStatus(){
     if (!this.statusHistory){
         return""
     }else{
         this.statusHistory.sort{it.sstatusDate}
         return statusHistory.status.first()
     }
 }
}

class statusHistory {

     static mapping = {
        sort statusDate: "asc"
     }

 static belongsTo = [ mainObjects : MainObject]

 Date statusDate
 String strStatus
 String notes

 String toString(){
    if (statusDate ==null){
        return "${strStatus}" + " - No Date"
    }else{
        return "${strStatus}" +" - "+ "${statusDate.getDateString()}"
    }
 }
} 
```

单元测试

```
@TestMixin(GrailsUnitTestMixin)
class MainObjectTests {

    def util = new UnitTestUtil()
    def mockMainObj

    @Before
    void setUp {

          mockMainObj = util.initMockMainObj()
          mockForConstraintsTests(MainObject, [mockMainObj])
     }

    void testgetCurrentStatus(){
        assertEquals("", mockMainObj.getCurrentStatus())

        def mockObjStatus1 = util.initMockStatus(mockMainObj, new SimpleDateFormat(dd/MM/yyyy hh:mm:ss).parse("01/12/2008 15:00:00"), "First Status")
        mockDomain (StatusHistory, [mockObjStatus1])
        mockForConstaintsTests (StatusHistory, [mockObjStatus1])
        mockObjStatus1.save()
        assertEquals(1, mockMainObj.statusHistory.size())
        assertEquals("First Status", mockMainObj.getCurrentStatus())

        def mockObjStatus2 = util.initMockStatus(mockMainObj, new Date(), "Latest Status")
        mockDomain (StatusHistory, [mockObjStatus2])
        mockForConstaintsTests (StatusHistory, [mockObjStatus2])
        mockObjStatus2.save()
        assertEquals(2, mockMainObj.statusHistory.size())
        assertEquals("Latest Status", mockMainObj.getCurrentStatus())

    }
 } 
```

根据[本博客](http://mrpaulwoods.wordpress.com/2011/02/07/implementing-burt-beckwiths-gorm-performance-no-collections/)和 Beckwith 先生 (www.infoq.com/presentations/GORM-Performance )

但我不断回到文档并查看我的代码并认为它​​是正确的。所以我现在处于循环引用中。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T15:41:10.120

来自同事 - 可能有几种解决方案，但这将是我的方法。不要使用 hasMany 集合来获取第一个值，因为您无法确定顺序（在 Grails 中可能存在错误）。而是使用单个查询来获取值。尝试用这个替换 getCurrentStatus() 方法：

```
String getCurrentStatus() {
            StatusHistory.createCriteria().get() {
                            eq(‘mainObjects’, this)

                            maxResults(1)
                            order(‘statusDate, ‘asc’)

                            projections {
                                            property(‘strStatus’)
                            }
            }
} 
```

这将只从 StatusHistory 中获取当前 MainObject 的最早 strStatus。它比检索所有历史记录然后才选择第一个历史记录更好。

这似乎解决了问题

# android - 共享首选项无法正确保存数据

> ID：15691962
> 
> 赞同：0
> 
> 时间：2013-03-28T20:55:08.047
> 
> 标签：android, android-intent

您好，我的应用程序中有 3 个活动，我使用 Intent 在它们之间传输数据。我遇到的问题是，当我从 3 活动返回到主要活动时，我在主要活动上的共享首选项发生了变化。我怀疑问题在于我的意图是重新启动，但我不确定。我试图让数据保持与我移动到 3 活动时的数据相同。我的应用程序从活动 1 开始，然后进入主要活动，最后如果您单击一个按钮，它会转到第三个活动，获取一些数据并返回到主要活动我遇到的问题是我从第一个活动中获得的数据当我从第三个活动返回时重新启动。当我在活动之间移动数据时，我使用意图。

我传输意图活动1的代码：

```
 Bundle CIW = new Bundle();
    CIW.putInt("one", int1);
    CIW.putInt("two", int2);
    CIW.putDouble("double", double);
    Intent a = new Intent(Must.this, Main.class);
    a.putExtras(CIW);
    startActivity(a); 
```

我的代码在我的主要活动中获取捆绑包（它在我的创建方法中）：

```
 Intent must = getIntent();
        Intent name = getIntent();
        Bundle CIW = must.getExtras();
        Bundle card = name.getExtras();
        int1 = CIW.getInt("one");
        int2 = CIW.getInt("two");
        double= CIW.getDouble("double");
        int3 = card.getInt("three"); 
```

我的共享首选项代码（暂停）：

```
 SharedPreferences settings = PreferenceManager
            .getDefaultSharedPreferences(getApplicationContext());
    SharedPreferences.Editor editor = settings.edit();
    editor.putInt("one", Int1); //the rest of the variable 
editor.commit(); 
```

我的共享偏好代码（在简历上）：

```
 SharedPreferences settings = PreferenceManager
            .getDefaultSharedPreferences(getApplicationContext());
    int1 = settings.getInt("one", int1); //the rest of the variable 
```

我传输意图活动 3 的代码：

```
Bundle number = new Bundle();
    number.putInt("three", int3);
    Intent a = new Intent(Card.this, Main.class);
    a.putExtras(number); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T22:09:53.177

您的共享首选项文件（名称）总是相同的，对吧？

如果您使用来自不同活动/服务/意图/...的共享首选项，则应将其与模式**MODE_MULTI_PROCESS**（常量值 int = 4）一起使用。如果没有，文件将被锁定，并且只有一个进程可以一次写入！

因此，当您在多进程应用程序中调用共享首选项时，请执行以下操作：

```
SharedPreferences preferences = this.getSharedPreferences("myapp",4); 
```

MODE_MULTI_PROCESS 在 android 2.3 之前的所有版本上都为 ON，但必须严格调用后者！官方文档说：

> 操作模式。使用 0 或 MODE_PRIVATE 进行默认操作，使用 MODE_WORLD_READABLE 和 MODE_WORLD_WRITEABLE 来控制权限。如果多个进程正在改变同一个 SharedPreferences 文件，也可以使用位 MODE_MULTI_PROCESS。MODE_MULTI_PROCESS 在针对 Gingerbread (Android 2.3) 及更低版本的应用程序中始终打开，在更高版本中默认关闭。

# linq - 在 LINQ 中传递 Null 日期值

> ID：15691964
> 
> 赞同：0
> 
> 时间：2013-03-28T20:55:15.203
> 
> 标签：linq, linq-to-sql, linq-to-dataset

```
 Private m_ExpirationDate As Nullable(Of DateTime)
Public Property ExpirationDate() As Nullable(Of DateTime)
    Get
        Return m_ExpirationDate
    End Get
    Set(ByVal value As Nullable(Of DateTime))
        m_ExpirationDate = value
    End Set
End Property

Dim rec As New DBML.Staff With _
        {.StaffDesc = m_StaffDesc, _
         .LastName = m_LastName, _
         .FirstName = m_FirstName, _
         .MiddleInit = m_MiddleInit, _
         .Gender = m_Gender, _
         .Certification = m_Certification, _
         .ExpirationDate = m_ExpirationDate, _ ********
         .Active = m_Active, _
         .CEPDNo = m_CEPDNo, _
         .FaNo = m_FaNo, _
         .PIC = m_PIC, _
         .PICValid = m_PICValid, _
         .PICCheckDate = Today(), _
         .PICError = m_PICError}

    _db.Staffs.InsertOnSubmit(rec)

    Try
        _db.SubmitChanges()
        RetVal = rec.StaffID.ToString
    Catch exp As Exception
        RetVal = "Insert Failed:" & exp.Message

    End Try 
```

当我运行 insertonsubmit 时，它会失败，因为 m_ExpirationDate 的值为 null，尽管它显示 12:00:00:00AM。那么我该如何测试这个值，如果它为空，请不要将它包含在“InsertOnSubmit”语句中。我不想传递像 1/1/1900 这样的虚假值。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T13:00:27.703

```
 Private m_ExpirationDate As Nullable(Of DateTime)
Public Property ExpirationDate() As Nullable(Of DateTime)
    Get
        Return m_ExpirationDate
    End Get
    Set(ByVal value As Nullable(Of DateTime))
        If Not IsDate(value) Or value = #12:00:00 AM# Then
            m_ExpirationDate = Nothing
        Else
            m_ExpirationDate = value
        End If

    End Set
End Property 
```

我需要做的是将我的属性值设置为“无”，如果它是一个空白值或不是一个日期。

# java - dropwizard 中的单元测试视图

> ID：15691968
> 
> 赞同：2
> 
> 时间：2013-03-28T20:55:31.987
> 
> 标签：java, unit-testing, dropwizard

我正在尝试测试从drowpizard 资源返回的视图是否正确组装。具体来说，添加用户的视图有一个字段，如果密码检查器不符合某些规则，则该字段允许密码检查器拒绝创建用户的尝试。该视图在部署和运行 web 应用程序并指定错误密码时效果很好，但是当我尝试对其进行单元测试时，它会引发一个 web 应用程序异常，指出视图没有消息正文编写器。

我的单元测试很简单：

```
@Test
public void testBadPassword(){
    ClientResponse response = null;
    try {
         response=client().resource("/users").post(ClientResponse.class, createUserParameters);
         Status status = response.getClientResponseStatus();
         assertEquals(Status.SEE_OTHER, status);
    } finally {
        if (response != null) {
            response.close();
        }
    }
} 
```

我得到一个服务器 500 错误，它隐藏在以下内容中：

```
javax.ws.rs.WebApplicationException: com.sun.jersey.api.MessageException: A message body writer for Java class com.seeker.stm.resources.views.AddUserView, and Java type class com.seeker.stm.resources.views.AddUserView, and MIME media type text/html was not found
    at com.sun.jersey.spi.container.ContainerResponse.write(ContainerResponse.java:285)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1448) 
```

处理请求并生成视图和响应的资源如下所示：

```
@Path("/users")
public class UserResource {

    public Object addUser(@FormParam("username") String username,
        @FormParam("password") String password,
        @FormParam("email") String email){
    Set<String> passwordErrors = passwordChecker.checkValidity(password, username, email);
    if (!passwordErrors.isEmpty()) {            
        return new AddUserView(userDAO.getAllActive(), passwordErrors);
    }

    // ...
} 
```

我可以理解异常（它知道的编写器，如 StringProvider 和 ByteArrayProvider，不适用于响应或视图或其他东西）但我更想知道如何正确测试可以返回响应的资源代码或视图。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T00:01:04.223

您需要添加`addProvider(ViewMessageBodyWriter.class);`到您的`setUpResources`.

`ViewMessageBodyWriter`被添加为提供者`ViewBundle`，这就是它在您的服务中工作的原因（您可能有`bootstrap.addBundle(new ViewBundle());`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-26T13:24:29.707

我正在使用 dropwizard 0.8.0-rc3，我的视图是基于 freemarker 模板的。我尝试了上述方法并不断收到异常。最终让它为我工作的是打电话

```
.addProvider(new ViewMessageBodyWriter(new MetricRegistry(), Collections.singleton(new FreemarkerViewRenderer()))) 
```

在我的`ResourceTestRule.builder()`.

# ksh - 使用 awk 读取文件的每一行并存储到数组中

> ID：15691969
> 
> 赞同：0
> 
> 时间：2013-03-28T20:55:37.767
> 
> 标签：ksh, nawk

我正在 Sun Solaris 中研究 ksh。我有一个文件，每行只有一个单词作为作业名称。想要从文件中读取所有作业并按照给定的顺序一一执行。如何在 ksh 中做到这一点。如果在命令提示符下触发以下代码，则可以正常工作。当我尝试通过 shell 脚本运行它时，它给出了错误。

```
i=0;nawk '{print $1}' input.txt | while read -r r;
do 
a[i]="$r";
echo "${a[++i]}";
done 
```

错误：

```
i=0
+ read -r r
+ nawk {print $1} input.txt
test2.ksh: -r: is not an identifier 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T16:28:35.430

该消息来自 Bourne shell，因此可能以某种方式没有以正确的方式调用该脚本。您需要在脚本的第一行插入一个 shebang：

```
#!/bin/ksh 
```

并使其可执行并执行它：

```
chmod +x /path/to/script
/path/to/script 
```

或者您需要像这样调用脚本：

```
ksh /path/to/script 
```

# forms - IE10 inset box-shadow scaling with border-radius

> ID：15691970
> 
> 赞同：2
> 
> 时间：2013-03-28T20:55:41.703
> 
> 标签：forms, internet-explorer-10, css

我想在 IE10 中添加一个插入框阴影。相对于应用于输入元素的边框半径，圆角的尺寸似乎变大了。这不会在 webkit 或 firefox 中发生。我可以看到缩放一个初始的盒子阴影是多么有意义，但是缩放一个嵌入的阴影是很奇怪的。

它应该看起来如何：

![它应该是什么样子](../Images/089f78ea17ec5ce6c70915dce03d85ef.png)

它在 IE10 中的外观：

![它在 IE10 中的外观](../Images/e82f72eca0689839b5f6a125dcdfe79a.png)

有没有人遇到过这个问题并找到了解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T15:19:27.390

你可以参考 [http://www.impressivewebs.com/ie10-css-hacks/](http://www.impressivewebs.com/ie10-css-hacks/)

一些测试代码：

```
.navigation ul li a {
  -moz-box-shadow: 3px 3px 3px #ffccff;
  -webkit-box-shadow: 2px 2px 7px #ffccff;
  -o-box-shadow: 2px 2px 7px #ffccff;
  box-shadow: 2px 2px 7px #ffccff;
}
@media screen and (min-width:0\0) {
    /* IE9 and IE10 rule sets go here */
.navigation ul li a {
  box-shadow: 2px 2px 17px #3a312a;
 }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-31T05:53:24.167

我尝试分别为块的每一侧添加插入框阴影，它起作用了！ [http://codepen.io/bivihoba/pen/DHuqk](http://codepen.io/bivihoba/pen/DHuqk)

# javascript - 一次只显示一个数组项（Javascript）

> ID：15691972
> 
> 赞同：2
> 
> 时间：2013-03-28T20:55:44.567
> 
> 标签：javascript, arrays, loops

我试图从本质上创建一个代码，它一次显示一个从数组中获取的单个字符串项。基本上我只希望它显示一个项目，然后过渡到下一个项目，我的 Javascript 技能非常初级（Jquery 可能会更好。）

这是我的代码：

```
var title= ['Orange', 'Apple', 'Mango', 'Airplane', 'Kiwi'];
for (var i=0; i<title.length; i++){
document.write(title[i]);
} 
```

我要补充什么？

非常感谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-28T21:03:52.190

从了解`document.getElementById`和开始`setInterval`。

[http://jsfiddle.net/wtNhf/](http://jsfiddle.net/wtNhf/)

HTML：

```
<span id="fruit"></span> 
```

Javascript：

```
var title = ['Orange', 'Apple', 'Mango', 'Airplane', 'Kiwi'];

var i = 0;  // the index of the current item to show

setInterval(function() {            // setInterval makes it run repeatedly
    document
        .getElementById('fruit')
        .innerHTML = title[i++];    // get the item and increment i to move to the next
    if (i == title.length) i = 0;   // reset to first element if you've reached the end
}, 1000);                           // 1000 milliseconds == 1 second 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T21:04:03.973

[http://jsfiddle.net/3fj9E/1/](http://jsfiddle.net/3fj9E/1/)

js

```
 var span = $('span');
 var div = 0;
 var fading_in = function () {
 $(span[div++] || []).fadeIn(500, arguments.callee);
 }
setTimeout(fading_in, 400); 
```

html

```
 <div id='example'>
 <span>orange </span>
 <span>apple </span>
 <span>kiwi </span>
<span>banana </span>
<span> melon</span>
</div> 
```

css

```
 span {display:none} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-28T21:10:40.253

我试图让它保持最简单

HTML

```
<div id="my_id"></div> 
```

Javascript

```
var counter = 0;
var words = ['jaja', 'jojo', 'lol', 'troll', 'pk!'];
var my_div = document.getElementById('my_id');

function next_word()
{
    my_div.innerHTML = words[counter % words.length];
    counter += 1;
}

setInterval(next_word, 100); 
```

[http://jsfiddle.net/zTLqe/](http://jsfiddle.net/zTLqe/)

# sql - 自动完成从一个巨大的表中获取数据

> ID：15691976
> 
> 赞同：6
> 
> 时间：2013-03-28T20:55:53.220
> 
> 标签：sql, database, postgresql, autocomplete

我需要做一个自动完成功能，需要做这样的事情：

```
select field from huge_table where field like '%some string%'; 
```

该表有 200 万行，我需要它的快速响应和多个响应。我们正在使用 Postgres。这种查询将永远持续下去。

有没有一种有效的方法来使用 postgres 做到这一点？或者也许我应该使用 postgres 以外的其他东西？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T21:06:35.450

如果您正在执行自动完成，我假设您正在查找基于前缀的匹配项。基于前缀的查找的标准数据结构是[trie](http://en.wikipedia.org/wiki/Trie)。

如果使用索引和基于前缀的查找`some string%`（

Trie 的最坏情况是`O(m)`，其中`m`是前缀的长度，因此一旦构建，它将提供*非常*快速的自动完成功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T23:01:56.970

根据您的用例的具体情况，可能值得知道它`tsquery`具有用于查询单词前缀的语法。将此与索引`tsvector`字段结合起来，您可以非常快速地查找单词前缀。

创建你的“巨大”表：

```
CREATE TABLE huge_table (
    field       text,
    field_tsv   tsvector
); 
```

添加索引：

```
CREATE INDEX field_tsv_idx ON huge_table USING gin(field_tsv); 
```

添加触发器以更新索引列：

```
CREATE TRIGGER tsvectorupdate BEFORE INSERT OR UPDATE
ON huge_table FOR EACH ROW EXECUTE PROCEDURE
tsvector_update_trigger(field_tsv, 'pg_catalog.english', field); 
```

添加一些模拟数据

```
INSERT INTO huge_table (field) VALUES ('something nice');
INSERT INTO huge_table (field) VALUES ('another thing'); 
```

然后查询具有某种限制的前缀：

```
SELECT field FROM huge_table WHERE field_tsv @@ to_tsquery('anot:*') LIMIT 20;
     field     
---------------
 another thing
(1 row) 
```

阅读有关[文档](http://www.postgresql.org/docs/9.1/static/textsearch-controls.html)的更多信息，尤其是[索引类型](http://www.postgresql.org/docs/9.1/static/textsearch-indexes.html)，因为您的索引可能会变得非常大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T20:59:44.360

您可以为`field`正在搜索的内容添加索引。

此外，如果可以避免，请不要使用开放式通配符，因为`%some string%`它们**确实会损害**性能。如果可能的话，做`some string%`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-28T21:13:56.470

如果您负担得起额外的插入/更新时间，也许您可​​以使用[pg_trgm 扩展](http://www.depesz.com/2011/02/19/waiting-for-9-1-faster-likeilike/)

您在该链接中使用 200 万条记录表进行了一些测试，以查看最佳情况下的改进。

# bash - 为什么用反斜杠开始一个 shell 命令？

> ID：15691977
> 
> 赞同：216
> 
> 时间：2013-03-28T20:55:53.610
> 
> 标签：bash, shell

```
\curl -L https://get.rvm.io | bash -s stable 
```

为什么命令以 开头`\`？ [这是我看到它的网站。](https://www.digitalocean.com/community/articles/how-to-install-ruby-on-rails-on-ubuntu-12-04-lts-precise-pangolin-with-rvm)

* * *

## 回答 #1

> 赞同：210
> 
> 时间：2013-03-28T20:59:32.857

```
alias curl='curl --some --default --options' 
```

如果你有一个别名`curl`并且你不想使用它，在前面放一个反斜杠会禁用别名并直接运行 curl 二进制文件。

请注意，这仅适用于交互式外壳。别名不会在脚本中生效，因此在那里没有必要。

* * *

## 回答 #2

> 赞同：174
> 
> 时间：2013-05-12T10:10:10.170

[(Bourne/POSIX) shell 规范](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_03_01)说，当命令词的任何字符被引用时，交互式 shell 中的**别名替换将被禁止。**反斜杠是这样做的一种方法，但还有其他众所周知的引用方式：单引号和双引号。以下所有内容都将禁止别名替换：

```
 \curl
 cur\l
 \c\u\r\l
 "c"url
 "curl"
 "c""u""r""l"
 'curl'
 'cu'"rl" 
```

使用`\curl`只是最常见和可读的方式。由于这是一个标准化功能，您可以期望它在所有 Bourne-heritage shell 中工作。

`\curl`看起来有点像 TeX 命令，不是吗？:-)

# java - 如何退出Java循环？

> ID：15691981
> 
> 赞同：3
> 
> 时间：2013-03-28T20:55:57.517
> 
> 标签：java, loops, break

如果您能为我的 Java 课作业提供一些帮助，我将不胜感激。问题的提示是：

编写一个程序来读取一个非负整数列表并显示最大整数、最小整数和所有整数的平均值。用户通过输入一个不用于查找最大值、最小值和平均值的负标记值来指示输入的结束。平均值应该是 double 类型的值，以便用小数部分计算。

我的代码遇到的问题是，在运行时，循环不会完成，除非输入的第一个值是负数，在这种情况下它会返回：

输入的最大数字是：0 输入的最小数字是：0 输入数字的平均值是：NaN

请帮忙！谢谢。-山姆

代码：

```
package blah;
import java.util.Scanner;
public class blahblah
{
    public static void main(String[] args) 
    {
        Scanner keyboard = new Scanner(System.in);
        System.out.println ("Please enter a list of positive integers.");
        System.out.println ("Please enter a negative integer when finished.");

        int in = 0;
        int max = 0;
        int min = 0;
        int sum = 0;
        int count = 0;
        in = keyboard.nextInt();

        while (in>=0)
        {
            if (in > max) {
                in = max;
            }
            if (in < min) {
                in = min;
            }
            sum += in;
            count++;
            if (in < 0) {
                 break;
            }
        }

        System.out.println("The maximum number entered was: " + max);
        System.out.println("The minimum number entered was: " + min);
        System.out.println("The average of the numbers entered was: " + (double)sum/count);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T20:58:28.373

您需要在循环内再次读取 nextInt ：

```
while (in>=0)
{
    if (in>max){
        max=in;
    }
    if (in<min){
        min=in;
    }
    sum += in;
    count++;
    in = keyboard.nextInt();
    //Check not needed here, handled by while loop
    //if (in<0){
    //     break;
    //}
} 
```

从评论中编辑：您的分配方向错误，因此您将输入设置为最小值/最大值，而不是设置最小值/最大值等于输入

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-28T20:58:36.140

将输入的读取移动到循环*内，并在负数处中断：*

```
while (true) {
    in = keyboard.nextInt();
    if (in < 0) break;
    // rest of loop
} 
```

更好的方法是使用`for`循环，它很好地捆绑了所有与循环相关的逻辑：

```
for (int in = keyboard.nextInt(); in >= 0; in = keyboard.nextInt()) {
    // your current loop code
} 
```

分离出迭代代码可以清楚哪些代码是迭代代码，让循环代码完全专注于程序的任务，从而更容易阅读和理解

这也意味着您不需要声明`int in`，并且尽可能减少变量的范围是一种很好的做法 - 在这种情况下`in`，它只存在于循环中，这是唯一使用/需要它的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T21:01:48.890

您读取值的语句不在 while 循环内，因此它仅读取第一个条目：

```
in = keyboard.nextInt ();
while (in>=0)
{

} 
```

改成：

```
in = keyboard.nextInt ();
while (in>=0)
{
   ... stuff ...
in = keyboard.nextInt ();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T20:58:34.280

您必须重新读取用户的输入。代替：

```
in = keyboard.nextInt ();
while (in>=0) {
    if (in>max){
       in=max;
    }
    if (in<min){
        in=min;
    }

    sum += in;
    count++;
    if (in<0){
         break;
    }
} 
```

利用：

```
in = keyboard.nextInt ();
while (in>=0) {
    if (in>max){
        in=max;
    }
    if (in<min){
        in=min;
    }

    sum += in;
    count++;

    // removed if, since loop checks it.

    in = keyboard.nextInt (); // read on!
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-28T20:59:26.267

将您的代码更改为

```
in = keyboard.nextInt ();
while (in>=0){
    if (in>max){
        in=max;
    }

    if (in<min){
        in=min;
    }

    sum += in;
    count++;
    in = keyboard.nextInt ();
} 
```

如您所见，我已添加`in = keyboard.nextInt ();`以从用户那里获得更多价值

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-28T21:11:07.377

您将值放在同一个变量“in”中

在=最大值；

应该是其他方式

最大=在；

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-18T16:48:09.817

```
Scanner input =new Scanner(System.in);
double a= 0;
int i=0;
double sum=0;
double average=0;
double smallest=0;
double largest=0;
double range=0;

while(a>=0){
    System.out.print("Enter the value : ");
    a=input.nextDouble();
    if(a<0){
    break;
}
i++;
sum+=a;
average=sum/i;
if(smallest==0){
    smallest=a;
}
if(smallest>a){
    smallest=a;
}

if(largest<a){
    largest=a;
}

range=largest-smallest;

}
System.out.print("\n The average of all the values is : "+average);
System.out.print("\n The smallest of the values is : "+smallest);
System.out.print("\n The largest of the values is : "+largest);
System.out.print("\n The range of the values is : "+range); 
```

# perl - 如何让 File::Queue 能够在 perl 中处理 utf8 字符串？

> ID：15691983
> 
> 赞同：0
> 
> 时间：2013-03-28T20:56:11.580
> 
> 标签：perl, encoding, utf-8, fifo, widechar

我正在 perl 中处理来自 XML 文件的一些数据，并想使用 FIFO File::Queue 来划分和加速该过程。一个 perl 脚本解析 XML 文件并为另一个脚本准备 JSON 输出：

```
#!/usr/bin/perl -w
binmode STDOUT, ":utf8";
use utf8;
use strict;
use XML::Rules;
use JSON;
use File::Queue;

#do the XML magic: %data contains result

my $q = new File::Queue (File => './importqueue', Mode => 0666);
my $json = new JSON;
my $qItem = $json->allow_nonref->encode(\%data);
$q->enq($qItem); 
```

只要`%data`包含数字和 az 数据，就可以正常工作。但是当出现其中一个宽字符时（例如 ł、ą、ś、ż 等），我得到：`Wide character in syswrite at /usr/lib/perl/5.10/IO/Handle.pm line 207.`

我试图检查字符串是否为有效的 utf8：

```
print utf8::is_utf8($qItem). ':' . utf8::valid($qItem) 
```

我确实得到了`1:1`- 所以是的，我确实有正确的 utf8 字符串。

我发现原因可能是 syswrite 将文件处理程序获取到不知道是 :utf8 编码文件的队列文件。

我对吗？如果是这样，有什么方法可以强制 File:Queue 使用 :utf8 文件处理程序？也许 File:Queue 不是最好的选择——我应该使用其他方法在两个 perl 脚本之间创建 FIFO 队列吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-28T21:16:24.457

`utf8::is_utf8`不会告诉您您的字符串是否使用 UTF-8 编码。（该信息甚至不可用。）

```
>perl -MEncode -E"say utf8::is_utf8(encode_utf8(chr(0xE9))) || 0"
0 
```

`utf8::valid`不会告诉您您的字符串是否是有效的 UTF-8。

```
>perl -MEncode -E"say utf8::valid(qq{\xE9}) || 0"
1 
```

两者都检查一些内部存储详细信息。你不应该需要任何一个。

* * *

File::Queue 只能传输字节串。您可以将要传输的数据序列化为字符串。

序列化文本的主要方式是*字符编码*，或者简称*编码*。UTF-8 是一种字符编码。

例如，字符串

```
dostępu 
```

由以下字符组成（每个字符都是一个 Unicode 代码点）：

```
64 6F 73 74 119 70 75 
```

并非所有这些字符都适合字节，因此无法使用 File::Queue 发送字符串。如果您要使用 UTF-8 对该字符串进行编码，您将得到一个由以下字符组成的字符串：

```
64 6F 73 74 C4 99 70 75 
```

这些字符适合字节，因此可以使用 File::Queue 发送字符串。

* * *

正如您所使用的，JSON 返回 Unicode 代码点的字符串。因此，您需要应用字符编码。

File::Queue 不提供自动为您编码字符串的选项，因此您必须自己完成。

您可以使用`encode_utf8`和`decode_utf8`来自编码模块

```
 my $json = JSON->new->allow_nonref;
 $q->enq(encode_utf8($json->encode(\%data)));
 my $data = $json->decode(decode_utf8($q->deq())); 
```

或者您可以让 JSON 为您进行编码/解码。

```
 my $json = JSON->new->utf8->allow_nonref;
 $q->enq($json->encode(\%data));
 my $data = $json->decode($q->deq()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T21:22:19.447

看着文档......

```
perldoc -f syswrite
              WARNING: If the filehandle is marked ":utf8", Unicode
               characters encoded in UTF-8 are written instead of bytes, and
               the LENGTH, OFFSET, and return value of syswrite() are in
               (UTF8-encoded Unicode) characters.  The ":encoding(...)" layer
               implicitly introduces the ":utf8" layer.  Alternately, if the
               handle is not marked with an encoding but you attempt to write
               characters with code points over 255, raises an exception.  See
               "binmode", "open", and the "open" pragma, open.

man 3perl open
use open OUT => ':utf8';
...
with the "OUT" subpragma you can declare the default
       layers of output streams.  With the "IO"  subpragma you can control
       both input and output streams simultaneously. 
```

所以我猜想添加`use open OUT=> ':utf8'`到你的程序顶部会有所帮助

# java - Maven 发布-> 对等体未通过身份验证

> ID：15691985
> 
> 赞同：21
> 
> 时间：2013-03-28T20:56:20.863
> 
> 标签：java, maven, svn, https, release

我正在尝试发布我的软件（我以前从未这样做过），到目前为止我已经能够执行 mvn release:prepare。当我执行 release:perform 时，我收到以下错误：

```
[信息] [错误] 无法执行目标 org.apache.maven.plugins:maven-deploy-plug
in:2.7:deploy (default-deploy) on project img2stl: 未能部署工件：C
不能将工件 nl.byterendition:img2stl:jar:0.9 从/到 byterenditio 传输
n-releases (https://localhost:443/svn/repo/releases): 对等体未通过身份验证->
[帮助1]

```

我已经在 localhost:443 设置了一个本地密码保护的 svn 存储库，所以我将以下内容添加到我的 .m2 文件夹中的 settings.xml

编辑包括埃德温巴克的回答：

```
<?xml version="1.0" encoding="UTF-8"?>

<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd">

    <servers>
        <server>
            <id>byterendition-releases</id>
            <username>username</username>
            <password>password</password>
        </server>
        <server>
            <id>byterendition-snapshots</id>
            <username>username</username>
            <password>password</password>
        </server>
    </servers>
</settings> 
```

这是我的 pom 的有用部分：

```
<distributionManagement>
    <repository>
        <id>byterendition-releases</id>
        <url>https://localhost:443/svn/repo/releases</url>
    </repository>
    <snapshotRepository>
        <id>byterendition-snapshots</id>
        <url>https://localhost:443/svn/repo/snapshots</url>
    </snapshotRepository>
</distributionManagement> 
```

如何让 maven 访问 svn 存储库？

好的，正如 Edwin Buck 建议的那样，我不应该使用 localhost，但由于我无法让它工作，否则我想我会使用我用于工作的远程 SVN 服务器来尝试这个。现在我得到一个不同的错误：

```
[信息] [错误] 无法执行目标 org.apache.maven.plugins:maven-deploy-plug
in:2.7:deploy (default-deploy) on project img2stl: 未能部署工件：C
不能将工件 nl.byterendition:img2stl:jar:0.9.5 从 / 转移到 byterendit
ion-releases (https://svn.science.ru.nl/repos/estens/releases/)：传输失败
fer 文件：https://svn.science.ru.nl/repos/estens/releases/nl/byterendition/img2s
tl/0.9.5/img2stl-0.9.5.jar。返回码为：409，ReasonPhrase：冲突。-> [赫尔
1]

```

我再次可以从 Eclipse 访问这个 repo。有谁知道我做错了什么？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-07-18T21:40:20.923

从 3.0.5 版开始，Maven 检查 https 连接上的 SSL 证书。您可以通过添加命令行参数来临时解决此问题

```
-Dmaven.wagon.http.ssl.insecure=true -Dmaven.wagon.http.ssl.allowall=true 
```

将 SSL 证书安装到您的 JRE 中应该可以永久解决该问题。

官方文档：[http ://maven.apache.org/wagon/wagon-providers/wagon-http/](http://maven.apache.org/wagon/wagon-providers/wagon-http/)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-02-16T11:54:13.643

**步骤 1.**将 DER 格式的证书 *.cer (/X.509 .cert) 文件下载到本地目录

（您可以从浏览器执行此操作；对于 Chrome，单击锁定符号，显示证书 --> 复制到文件）

**步骤 2.**将其导入 Java 信任库

> \Program_Files\Java\jdk1.6.0_45\jre\lib\security>%JAVA_HOME%\jre\bin\keytool -v -alias mavensrv -import -file d:\temp\apacher.cer -keystore trust.jks

**步骤 3.**将 maven 的路径作为环境变量

> 设置 MAVEN_OPTS=-Xmx512m -Djavax.net.ssl.trustStore=%JAVA_HOME%/jre/lib/security/trust.jks -Djavax.net.ssl.trustStorePassword=changeit -Djavax.net.ssl.keyStore=%JAVA_HOME%/ jre/lib/security/trust.jks -Djavax.net.ssl.keyStoreType=jks -Djavax.net.ssl.keyStorePassword=changeit

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-28T20:58:38.767

您输入`settings.xml`的服务器 id 为 ，`localhost`但您正在访问 id(s) of`byterendition-releases`和的存储库`byterendition-snapshots`。

这意味着 maven 不会识别凭据并将其与这两个服务器相关联，因为它们具有不同的“身份”。您将需要`byterendition-releases`和的 settings.xml 条目`byterendition-snapshots`。

现在，如果您添加了一个条目，例如

```
 <server>
        <id>byterendition-releases</id>
        <username>user</username>
        <password>password</password>
    </server> 
```

然后 maven 将`byterendition-releases`使用用户名`user`和密码来满足 https 身份验证挑战`password`，因为它有一个服务器凭证条目`byterendition-releases`。

您还必须为 添加一个附加条目`byterendition-snapshots`，或将其设置为与 具有相同的服务器 ID `byterendition-releases`。

---编辑以跟上更新的问题---

您正在使用`localhost`URL 访问您的存储库。如果您的存储库确实位于同一台主机上，这可能会起作用，但它可能无法正常工作的原因有很多。

1.  SVN 存储库位于远程 SVN 服务器上，因此在远程服务器以外的其他地方开发时会失败。
2.  HTTP 服务器未配置为解析 localhost 的方式与解析外部请求的方式完全相同。

无论哪种方式，放弃本地主机。如果您无法获得机器的稳定 DNS 名称，即使输入 IP 地址也是更好的选择。如果您的 SVN 服务器在 DHCP 上，那么请花时间让 DynamicDNS 正常工作（但实际上，如果可以的话，您应该为服务器获取静态 IP）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-05-17T04:51:16.067

[https://github.com/escline/InstallCert](https://github.com/escline/InstallCert)提供了必要的工具，并提供了有关如何将远程证书导入系统范围证书存储的分步说明。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-07-03T09:42:28.227

我发现 Java 版本可以在这里有所作为。

使用 Maven 3.0.5 我在使用 Java 6 时遇到了这个错误，但切换到 Java 7（或更高版本）为我解决了这个问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-28T21:09:28.347

连接到服务器时看起来像是 SSL 问题。也许在用户名和密码检查之前。

您是否使用 SSL 客户端身份验证配置了 svn 服务器？这意味着您需要将客户端证书发送到服务器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-30T21:03:58.227

升级到 OSX Mavericks 后我遇到了很多安全问题

*   亚马逊 AWS 的 SSL 问题
*   对等点未通过 Maven 和 Eclipse 进行身份验证
*   trustAnchors 参数必须为非空

我应用了这个 JAVA 更新并解决了我的所有问题： http: [//support.apple.com/kb/DL1572 ?viewlocale=en_US](http://support.apple.com/kb/DL1572?viewlocale=en_US)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-02T09:36:28.697

我在使用 maven 3.6.0 时遇到了同样的问题。所有提议的解决方案（使用`-Dmaven.wagon.http.ssl.insecure=true`, `-Dmaven.wagon.http.ssl.allowall=true`, 更新 CA 商店）都对我不起作用。实际上，部署失败不是在第一个模块上而是在 ~25ish 左右，并且对于所有以前的模块都是成功的。因此，我假设通常 SSL 处理没问题，并且本地 <> 服务器连接或证书中存在一般问题。

让我很困惑一段时间，我今天偶然发现了[这个 jacoco 问题](https://github.com/jacoco/jacoco/issues/269)，他们提到[了`deployAtEnd`parameter](http://maven.apache.org/plugins/maven-deploy-plugin/deploy-mojo.html#deployAtEnd)。作为部署插件配置的一部分，将此参数添加到我的 pom.xml 为我解决了这个问题。

但是，我还不清楚为什么在以后的一些模块上部署失败，而不是在第一个模块上失败。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-11-03T02:43:02.280

我正在使用 maven 3.5.3，我选择通过根据上述答案添加命令行参数来临时修复此 SSL 问题。但是参数的格式似乎发生了一些变化。

```
-D maven.wagon.http.ssl.insecure=true -D maven.wagon.http.ssl.allowall=true 
```

抱歉，我无法评论@Alex Punnen 的答案，所以我必须写一个新的答案。

# excel - 在 VBA 项目中以编程方式导入 Microsoft.Office.Interop.Excel 命名空间

> ID：15691987
> 
> 赞同：0
> 
> 时间：2013-03-28T20:56:26.253
> 
> 标签：excel, vba, ms-office

我正在尝试以编程方式将`Microsoft.Office.Interop.Excel`命名空间导入我的 vba 项目。我发现[这个网站](http://msdn.microsoft.com/en-us/library/office/bb407651%28v=office.12%29.aspx) 显示了如何手动导入它，但我将这个我一直在从事的项目提供给不知道如何导入它的人。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:09:10.440

我从您的问题中假设您的 VBA 代码使用了对 Microsoft Excel 12.0（或其他版本）库的引用 - 并且您的用户收到错误，因为无法找到该引用。在这种情况下，您有两个选择：

*   不要参考 v12 库，而是参考较旧的库，例如来自 Excel 2003 的库。为此，请在网上搜索该库并安装它 - 或者只是在发货前在 Office 2003 安装中“重新链接”您的文件
*   使用后期绑定而不是早期绑定。在这种情况下，您根本不需要添加对 Excel 库的引用。相反，您将对象声明为类型`Object`（而不是`Excel.Workbook`,`Excel.Application`等）。要创建一个新对象，而不是使用`Set objExcelApp = New Excel.Application`，您现在必须使用`CreateObject`（对于新对象）或`GetObject`（对于现有对象，例如现有的正在运行的应用程序）：`Set objExcelApp = CreateObject("Excel.Application")`。任何以后的代码都将继续照常工作（尽管由于后期绑定可能会慢一点）。

如需进一步阅读，请查看此[答案](https://stackoverflow.com/questions/9491314/preventing-excel-vba-compile-errors-due-to-users-having-an-older-version-of-ms-o)。

# .net - 从自定义命名列中获取值

> ID：15691989
> 
> 赞同：1
> 
> 时间：2013-03-28T20:56:33.333
> 
> 标签：.net, mpxj

我正在使用一个 MPP 文件，该文件有一些附加列，名称如“Text5”、“Text10”等。显然，这些不是通过 Task 类简单访问的默认列。我见过 Column 类，但没有看到通过 Task 类访问特定命名的列的方法。

如何从除默认列之外的列中的任务对象中检索值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-06T03:58:21.097

You could use getFieldByAlias() to get value from custom-name column:
Example: task.getFieldByAlias("Text5")

Regards,

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-29T15:19:20.747

Task 类有一个 GetText(int) 方法，允许像这样检索字段。我能够通过对 Text5 字段使用 task.GetText(5) 来获得我需要的值。

# netbeans - 在 Netbeans 中发现意外错误

> ID：15691992
> 
> 赞同：1
> 
> 时间：2013-03-28T20:56:44.090
> 
> 标签：netbeans, netbeans-7

我收到错误，例如

> 意外的令牌 LBRACE 发现它指向`</div>`

我也收到如下错误：

> 发现意外字符 ';',' ' 指向没有任何此类字符的行，例如 smarty 代码：

```
{if isset($payopts[l].shipping) && $payopts[l].shipping} 
```

那么这是怎么回事，更重要的是，netbeans 在谈论 wtf 吗？

# ruby-on-rails - 如何在 IP 级别限制访问？

> ID：15691993
> 
> 赞同：0
> 
> 时间：2013-03-28T20:56:48.893
> 
> 标签：ruby-on-rails

例如，如果我只希望具有特定 IP 地址（公司 IP 或校园 IP 等）的用户能够访问某些页面怎么办？如何获取访问者的IP并在不同情况下呈现不同的页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T21:05:59.070

在控制器操作的上下文中，`request.remote_ip`将为您提供您正在寻找的信息。

[http://apidock.com/rails/ActionDispatch/Request/remote_ip](http://apidock.com/rails/ActionDispatch/Request/remote_ip)

例如，您可以向应用程序控制器添加过滤器操作，以呈现错误页面，除非 remote_ip 在白名单中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T20:58:23.823

你有什么服务器？

你可以使用 .htaccess 文件吗？如果是，这就是答案。