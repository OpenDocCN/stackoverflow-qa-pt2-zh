# StackOverflow 问答 12810000-12810999

# macos - 在 Mac 上使用 JDK 7 时多播套接字不起作用

> ID：12810001
> 
> 赞同：1
> 
> 时间：2012-10-09T23:46:57.683
> 
> 标签：macos, java, multicastsocket

我有一个关于多播发送和接收的代码。它可以在使用 JDK 6 的 Mac 上运行。但是，当我更改为使用 JDK 7 时，它无法正常工作。

代码是这样的：

```
final InetAddress group = InetAddress.getByName("228.2.3.4");
final MulticastSocket socket = new MulticastSocket(2012);

socket.setReuseAddress(true);
socket.joinGroup(group);

final int length = 8 * 1024;
final byte[] bytes = new byte[length];
final DatagramPacket packet = new DatagramPacket(bytes, length);

while(true) 
{                       
socket.receive(packet);
    ...
}
... 
```

使用JDK 7编译运行，VMware运行时无法运行。但是如果使用 JDK 6，即使 VMware 正在运行，它也可以工作。

此外，我尝试使用 WireShark 来监控适配器。而且我发现 WireShark 可以看到使用 JDK 7 运行我的程序时发送和接收的所有多播数据包。但是多播套接字无法接收任何内容。

有人对此有任何想法吗？谢谢你的帮助。

# c# - SignalR sqlServer 监听

> ID：12810002
> 
> 赞同：3
> 
> 时间：2012-10-09T23:47:07.060
> 
> 标签：c#, asp.net, sql-server, signalr

我注意到 github 上有一个 SignalR.SqlServer 类。 [https://github.com/paigecook/SignalR/tree/master/SignalR.SqlServer](https://github.com/paigecook/SignalR/tree/master/SignalR.SqlServer)

想知道我是否可以用它来监听数据库更新并将它们发送给客户端？如果是，是否有关于此功能的任何文档/示例？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-10T01:04:49.350

不，你不能。这是在 SQL Server 之上实现 SignalR 的 IMessageBus。它允许您在 webfarm 中使用 SignalR，使用 Sql 服务器作为背板将消息传递给所有 webnodes。

# activerecord - 在rails 3中链接where子句

> ID：12810013
> 
> 赞同：1
> 
> 时间：2012-10-09T23:48:38.917
> 
> 标签：activerecord, ruby-on-rails-3.2

我已经完成了一个基于搜索输入的两个参数的小型搜索方法。我的代码是这样的：

```
def self.search(search, page)
    result = where("dead = ? and sold = ?", false, false)
    if not search.nil? and not search.empty?
        # regex for 'number - any word'
        search = search.split(' ')[0] if not (/^\d+ - .+$/ =~ search).nil?
        if not search.integer?
            result = result.where("name like ?", "%#{search}%")
        else
            result = result.where("earring = ?", search.to_i)
        end
    end
    result.paginate(:page => page)
        .includes(:mother, :father, :animal_type, :race)
        .order(:earring)
end 
```

正如你们所看到的，它非常丑陋。有效，但很丑。

所以，我正试图找到一种方法让它变得更好......但不知道如何。

希望大家能给我一些指导。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T11:05:13.723

```
#in your model
scope :dead_and_sold, where('dead = :q AND sold = :q', :q => false)

#your search method
def self.search(search, page)
     result = dead_and_sold
     unless search.nil? && search.empty?
         # regex for 'number - any word'
         search = search.split(' ').first unless (/^\d+ - .+$/ =~ search).nil?

         result = unless search.instance_of?(Fixnum)
            result.where("name like ?", "%#{search}%")
         else
            result.where("earring = ?", search.to_i)
         end
     end

    result.paginate(:page => page)
       .includes(:mother, :father, :animal_type, :race)
       .order(:earring)

end 
```

# map - Mathematica 中的 MapThread 具有一个变量常量

> ID：12810014
> 
> 赞同：0
> 
> 时间：2012-10-09T23:48:48.530
> 
> 标签：map, wolfram-mathematica, fold

我想使用三个变量的函数将 MapThread 折叠（以便求和）两个列表，其中第三个变量在 Mapthread 上是常量。我想完成这样的事情：

```
nList = {}; For[i = 0, i <= Length[N0], i++, nSum = 0; Fold[Plus,0,MapThread[n,T,M,N0[i]]]]; 
```

其中 n 是这样的， n[t_,m_,n0_] 我可以制作一个长度为 N0' 的列表 [T] 并用 N0[i] 填充它，但这有点小技巧。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T07:47:53.653

您的示例在语法上不正确；只接受`MapThread`3 个参数。

而不是`For`循环尝试

```
 Plus@@MapThread[n[#1,#2,N0]&,{T,M}] 
```

1.  成语`Plus@@`(...) 产生给定列表的总和（它适用`Plus`于列表）
2.  Mathematica 的 lambda 表达式非常强大，即无名函数。为方便起见，它的符号很短：您用占位符`#1`, `#2`, `#3`,... 替换的每个参数，在您指定的函数体之后，它是一个带`&`符号的无名函数。等效地，您可以编写`Function[{t,m},n[t,m,N0]]`而不是`n[#1,#2,No]&`. 请参阅帮助`Function`。

# html - 固定导航列表上的负边距

> ID：12810016
> 
> 赞同：1
> 
> 时间：2012-10-09T23:49:00.283
> 
> 标签：html, css, css-float, margins

所以基本上我所拥有的是一个包含所有内容的主容器 div。我想要一个固定的垂直导航列表出现在容器的一侧。

当我调整窗口大小以查看不同的分辨率时，会出现问题。我现在在我的容器中使用大约 1024 像素的固定宽度，最小宽度为 1200 像素，但它仍然切断了固定导航列表的一部分，因为我在导航容器上使用了 -125 像素的边距以使其超出内容容器。

这是正常的样子

![在此处输入图像描述](../Images/892188f1c9f1f5e1378b2c7c190747c1.png)

然后当缩小尺寸并且我设置的最小宽度开始时

![在此处输入图像描述](../Images/5325af831179199e8b2f590128c292ef.png)

这是 nav .nava { float:left; 的代码 位置：固定；左边距：-125px；文本对齐：右；}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T05:03:17.220

```
.nava
{
    float:left; 
    position: fixed;
    min-width: ??px         //Set your minimum needs here.
    max-width: ???%;        //preferably % because you don't know the maximum
    padding-left: -125px;   //!!!
    text-align:right; 
} 
```

当您的意图是填充时，切勿使用边距，绝不！

# facebook - 在调用 FB.init() 之前调用 FB.getLoginStatus()

> ID：12810018
> 
> 赞同：41
> 
> 时间：2012-10-09T23:49:17.880
> 
> 标签：facebook

我的控制台中有这条消息

```
FB.getLoginStatus() called before calling FB.init(). 
```

我的代码

```
<div id="fb-root"></div>
<script>
        // Load the SDK Asynchronously
        (function(d){
           var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
           if (d.getElementById(id)) {return;}
           js = d.createElement('script'); js.id = id; js.async = true;
           js.src = \"//connect.facebook.net/fr_FR/all.js#xfbml=1\";
           ref.parentNode.insertBefore(js, ref);
         }(document));
</script>
<div class="fb-like" data-send="false" data-layout="button_count" data-width="100" data-show-faces="false"></div> 
```

我不明白为什么。在我的所有网站中，我只有一次调用这个 facebook like 插件。

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-05-16T17:09:09.793

## 简短的回答

添加`&status=0`到您的`js.src`URL 以使警告消失，即：

`//connect.facebook.net/fr_FR/all.js#xfbml=1&status=0`

## 完整答案

`FB.init()`如果在井号 (#) 符号后提供参数，将在加载时由 facebook 脚本在内部调用。这里`xfbml`通过了，所以`FB.init()`才叫。

（源代码：[http](http://connect.facebook.net/fr_CA/all/debug.js) ://connect.facebook.net/fr_CA/all/debug.js行 8699 在这篇文章的时间）

如果未明确提供，则使用 init() 的默认 args：`status`arg default 是`true`- 这会`getLoginStatus()`在启动时调用 FB 脚本，这会报错，因为该函数调用需要应用程序 ID。

**FB 社交插件不需要应用程序 ID** - 它们被呈现为源自 facebook.com 的 iframe，因此它们可以访问 FB 登录状态和 cookie。

[FB 开发人员社交插件部分](https://developers.facebook.com/docs/reference/plugins/like/#configurator)中的“获取代码”向导会生成一个带有`xfbml`参数的 URL，它应该使用`status=0`参数恕我直言更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-02T12:19:04.123

如果您在实施解决方案后看到“Invalid App ID”的警告

[https://stackoverflow.com/a/16593474/1428052](https://stackoverflow.com/a/16593474/1428052)

然后将 appId 添加到您的 js.src URL 以使其适合您，即：

> //connect.facebook.net/en_US/all.js#xfbml=1&status=0&appId=YOUR_APP_ID

此 appId 的存在将自动调用带有基本应用设置的 FB.init()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T06:41:43.913

您需要`FB.init`在调用 fb 登录状态函数之前调用函数

```
 <div id="fb-root"></div>
    <script src="//connect.facebook.net/en_US/all.js"></script> 
    <script>
      FB.init({
            appId  : 'YOUR APP ID',
            status : true, // check login status
            cookie : true, // enable cookies to allow the server to access the session
            xfbml  : true,  // parse XFBML
            oauth : true
        });

    // Load the SDK Asynchronously
    (function(d){
       var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement('script'); js.id = id; js.async = true;
       js.src = \"//connect.facebook.net/fr_FR/all.js#xfbml=1\";
       ref.parentNode.insertBefore(js, ref);
     }(document));
  </script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-16T09:57:55.507

[我在这里](https://stackoverflow.com/a/12911928/540776)回答了一个类似的 SO 问题。
实际上，如果您也根本看不到 Like 按钮，那么这个问题与另一个问题完全相同。

就我而言，我看到了控制台错误，但我*也*看到了 Like 按钮。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-10T02:07:14.560

警告：下面有一些猜测。如果不合适，我可以删除它。

我认为问题在于异步加载 SDK，但内联的 Like 按钮。然后，Like 按钮可能会在脚本加载之前调用 getLoginStatus。您可以通过注释掉异步加载 SDK 的脚本来测试/验证这一点，而是将其作为正常的脚本标签包含在页头中。

当然，这只是简单的测试方法。如果您可以验证问题是否存在，那么解决它的“正确”方法可能是确保在 SDK 加载之前不会出现在页面上的 Like 按钮。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-13T20:37:32.817

我使用以下代码使其工作：

```
<!--[if IE]>
<script src="https://connect.facebook.net/pt_BR/all.js?xfbml=1" type="text/javascript"></script>
<![endif]-->
<script src="https://connect.facebook.net/pt_BR/all.js#xfbml=1" type="text/javascript"></script>

 <div class="fb-like"
          data-href="https://www.myurl.com" 
          data-send="true" data-layout="button_count" 
          data-width="50" data-show-faces="false"></div> 
```

# ruby - RVM 正在从我的 PATH 中删除 /usr/bin

> ID：12810020
> 
> 赞同：4
> 
> 时间：2012-10-09T23:49:46.453
> 
> 标签：ruby, path, rvm

帮助？

我刚刚卸载了 rvm：

```
rvm implode 
```

然后重新安装它：

```
curl -L get.rvm.io | bash -s stable 
```

不幸的是，现在当我尝试运行大多数（不是全部）rvm 命令时，它会从我的 PATH 中删除 /usr/bin，因此找不到它需要的所有命令行命令，例如 grep、sed 等。我已经包括在我的控制台的未经编辑的复制和粘贴下面：

```
[~]$ echo $PATH
/opt/local/bin:/opt/local/sbin:/Developer/usr/bin:/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/Users/Thai/.rvm/bin
[~]$ rvm use
Now using system ruby.
[~]$ echo $PATH
/opt/local/bin:/opt/local/sbin:/Developer/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/Users/Thai/.rvm/bin
[~]$ 
```

同样的事情发生在`rvm install...`and`rvm remove...`但不是`rvm help`or `rvm info`。

关于发生了什么的任何想法？编译后`rvm install...`失败，因为它需要访问 /usr/bin 中的命令行工具

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-11T20:07:52.403

当 RVM 尝试`PATH`从所有出现的 中清除时，就会发生这种情况`rvm`，基本上这意味着您有一个非常旧的系统安装`/usr/bin/rvm`- 只需将其删除：

```
sudo rm /usr/bin/rvm 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-09T21:33:47.733

您需要在 .bash_profile 中导出您的 bin 路径

`export PATH=$HOME/bin:$PATH`应该做的伎俩。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-11T17:32:54.930

检查 /etc/environment 以获取系统范围的路径。

我的猜测是 RVM 在某处覆盖了路径，而 rvm implode 无法删除有问题的脚本，因为 PATH 缺少 /usr/bin。尝试手动添加路径并运行 rvm implode。

# android - 用于网格视图的 ViewHolder - 使用 onclicklistener 选中的复选框不起作用

> ID：12810024
> 
> 赞同：0
> 
> 时间：2012-10-09T23:50:22.657
> 
> 标签：android, android-gridview

我有一个 ViewHolder，它在 gridview 中有 3 个文本框、一个图像和一个复选框。问题是在我将复选框添加到此查看器后，我似乎无法捕获/触发 onclicklistener。只有复选框似乎设置为选中或未选中。如果我单击图像或文本框上的其他区域，我想触发 onClick 事件。

另外，如果有人知道我们是否可以将几个复选框设置为 false，那么它可以被查看但不能响应。

我目前的代码在 ImageAdpater 中：

```
public View getView(int position, View convertView, ViewGroup parent)
{
    ViewHolder holder;
    ImageView imgView = null;

        if (convertView == null) {

            holder = new ViewHolder(); 
            LayoutInflater ltInflate = (LayoutInflater) context.getSystemService( Context.LAYOUT_INFLATER_SERVICE ); 
            convertView = ltInflate.inflate(R.layout.griditem, null);

            holder.textview1 = (TextView) convertView.findViewById(R.id.grid_item_alert_date);
            holder.textview2 = (TextView) convertView.findViewById(R.id.grid_item_alert_time);
            holder.textview3 = (TextView) convertView.findViewById(R.id.grid_item_alert_type);

            holder.imageview    = (ImageView) convertView.findViewById(R.id.grid_item_image);
            holder.checkbox = (CheckBox) convertView.findViewById(R.id.checkbox_ack);
            convertView.setTag(holder);

        }
        else
        {   
            holder = (ViewHolder) convertView.getTag();
        }

        holder.checkbox.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {

              @Override
              public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
                 // TODO Auto-generated method stub
                  Toast.makeText(context, " checkbox checked", Toast.LENGTH_SHORT).show();

              } });

        holder.textview1.setText("Text 1 ");
        holder.textview2.setText("Text 2 ");
        holder.textview3.setText("Text 3 ");
        holder.checkbox.setChecked(false);
        holder.imageview.setImageBitmap(bitmap);
        holder.id = position;

        return convertView;

} 
```

调用 imageadpater 的 Activity 中的代码：

```
 GridView gridview = (GridView) findViewById(R.id.mygridview);
        adapter = new ImageAdapter(this);
        gridview.setAdapter(adapter);

        gridview.setOnItemClickListener(new OnItemClickListener()
        {   
            public void onItemClick(AdapterView<?> parent, View v, int position, long id)
            {
                Toast.makeText(getBaseContext(),"pic" + (position + 1) + " selected",
                        Toast.LENGTH_SHORT).show();
            }
        }
        ); 
```

所以上面的gridview.setOnItemClickListener没有被调用，为什么呢？我尝试了不同的设置，但似乎没有任何效果，只有复选框事件有效，并且如果在 getView 中定义如上。

急需解决方案，干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T00:02:19.170

将这些行添加到布局 xml 中的复选框：

```
android:focusable="false"
android:focusableInTouchMode="false" 
```

这可以解决问题。

# event-handling - Opa：在迭代中将变量传递给事件处理程序

> ID：12810030
> 
> 赞同：0
> 
> 时间：2012-10-09T23:51:12.980
> 
> 标签：event-handling, iteration, opa

对于那里的 Opa Folks，我在过去的整个周末都对这个问题感到困惑。

我试图在我的视图中做的是迭代我的模型数据调用返回的 DBSet，生成一个 XHTML 记录表，每个记录都绑定到一个单击事件处理程序。我希望此单击事件处理程序接受迭代记录类型的属性作为参数，或记录本身。`type team = { string team_id, ...etc}` 我的视图中有一个表单，我想用最近单击的表​​行的值填充输入，这就是事件处理程序所做的——如果我什至可以将正确的参数传递给它。

我该怎么做？

我正在尝试获取一些 XHTML 来绑定这样的事件处理程序

```
<tr onclick={ otherExposedFunctionIWantToCall(team) }> 
```

或者

```
<tr onclick={ otherExposedFunctionIWantToCall(team.team_id) }> 
```

我采取的最新措施之一是尝试查看是否可以访问我在自定义类型 team.id 上设置的 team_id 属性。

```
function teams_management_view(){
    tbody = Iter.fold(
          function(team, acc){
            <>{acc}<tr onclick={ function(_){ Log.info("click", {team.team_id})}}><td class="team_id">{team.team_id}</td><td class="team_name">{team.name}</td></tr></>
          },
          TeamModel.get_teams(),
          <></>
        )
  ...
} 
```

当我在迭代代码中使用这些事件处理程序的这些形式时，它们都无法编译。

为什么这不起作用？我用动态记录迭代的问题是什么？我什至可以将这样的功能绑定到事件吗？
Opa 客户端事件是否有任何方法可以访问事件的目标 - 似乎没有找到任何方法？为了实现我的目标，我有哪些选择？

如果有人可以帮助我理解这个问题的任何部分，我将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:13:41.053

愚蠢的我，事实证明我完全忽略了团队变量完全在函数范围内（即传递给迭代器）这一事实。

原来我没有将作为一个int字段的team_id转换为字符串......

我发现这有效：

```
<tr onclick={ function(_){ setTeamView("{team.team_id}")} }> 
```

鉴于，这一直给我以前的错误，

```
Expression has type
    void
    but is coerced into
    FunAction.t

<tr onclick={ setTeamView("{team.team_id}")}> 
```

您的自定义函数最好首先包装在一个匿名包装函数中，正如我给出的第一个示例所示。team.team_id 的字符串转换仅在第一种情况下有效。

我猜到下一个！

# c# - 在启动时启动服务并从服务启动应用程序？

> ID：12810031
> 
> 赞同：0
> 
> 时间：2012-10-09T23:51:22.467
> 
> 标签：c#, service

> **可能重复：**
> [从 Windows 服务加载 GUI 应用程序](https://stackoverflow.com/questions/807683/loading-gui-app-from-windows-service)

我需要一个在用户桌面上启动 .exe 的服务。我还需要在用户登录桌面后立即启动此服务。（Windows 7 平台）

我确实有 SENS 事件，但不确定如何将上述谜题放在一起。我也知道 Runkey 中的任何 .exe 都会在窗口启动时启动，但是如何将我的服务放入 Runkey 中？

任何帮助，将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:20:04.497

Another option besides a windows service is writing a tray app which will start in the tray when the user logs in interactively. That eliminates the need of a windows service that's always running and has to detect when a log in occurs. It will start in the tray when they log in, runs as them, and you could offer gui in the tray app to start/stop the service.

Here's an S.O. post:

[How can I make a .NET Windows Forms application that only runs in the System Tray?](https://stackoverflow.com/questions/995195/how-can-i-make-a-net-winforms-application-that-only-runs-in-the-system-tray)

If you want it always running even when not logged in interactively, then a windows service is the way to go.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:23:53.930

从 Vista 开始不应该这样做，因为服务被设计为不能与桌面交互。这是有关该主题的更深入的文档。

[http://msdn.microsoft.com/en-us/windows/hardware/gg463353.aspx](http://msdn.microsoft.com/en-us/windows/hardware/gg463353.aspx)

通常，您会将桌面可执行文件放在用户启动文件夹或类似文件夹中，并让它与服务通信。

这是影响您的段落：

> 对于更复杂的交互，开发人员应该将他们的 UI 代码移动到在用户会话中运行并处理所有 UI 要求的代理中。代理通过 RPC 或命名管道与服务通信。如果用户使用控制面板、Internet Explorer 或类似的 UI 体验启动 UI 交互，则该 UI 体验应启动代理。然后代理处理所有 UI 交互。如果需要 UI 但用户未启动，则服务必须请求代理启动任何所需的 UI，而不是尝试自行启动该 UI。在服务必须启动用户交互并且代理尚未运行的极少数情况下，服务应调用 CreateProcessAsUser API 来启动代理。然后代理可以启动所有 UI 交互。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:09:44.103

您将需要 Windows 服务，请查看[http://msdn.microsoft.com/en-us/library/zt39148a%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-us/library/zt39148a%28v=vs.80%29.aspx)。在服务中，您将需要检测用户何时登录：[如何在 c#(.net) windows 服务中检测 windows 启动或用户登录？](https://stackoverflow.com/questions/10554922/how-to-detect-windows-started-or-user-login-in-c-net-windows-service)

# algorithm - 如何在 for 循环（matlab）中压缩 n-1，n-2，...？

> ID：12810032
> 
> 赞同：0
> 
> 时间：2012-10-09T23:51:30.677
> 
> 标签：algorithm, matlab, matrix, iteration

我正在寻找输入标准，因为矩阵的大小每次都会减小。

我试图简化我正在做的事情，看看浓缩它是否可行。

是否有一种方法可以简化以下内容，因此不需要 n-1、n-2 等，并且代码可以适应输入矩阵。

```
a = [2 4 5 6; 7 5 3 5; 6 7 9 4];
a
n = length(a(1,:));
b = [5];

for i = n,

    a = a.*b;

    a(:,n-1)=[];

    a

    a = a.*b;

a(:,n-2)=[];

a

a = a.*b;

a(:,n-3)=[];

a

end 
```

我希望能够在每次迭代时看到输出。例如：

```
a =

     2     4     5     6
     7     5     3     5
     6     7     9     4

a =

    10    20    30
    35    25    25
    30    35    20

a =

    50   150
   175   125
   150   100

a =

   750
   625
   500 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T00:28:38.913

使用带有语法的 FOR 循环

```
for i = starting_index:increment:ending_index 
```

从n-1倒数*到*1，如下：

```
for i = n-1:-1:1 % Count down from n-1 to 1
    a = a.*b;
    a(:,i)=[];
    a
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T00:30:12.283

试试这个

```
a = [2 4 5 6; 7 5 3 5; 6 7 9 4]

n = size(a,1);
b = [5];
for i=1:n
    a = a(:,end-1).*b
end 
```

我现在无法访问 Matlab，因此它可能无法按您的意愿工作。

# javascript - 使用 knockout.js 将 css 类绑定到 Observable Array item.chosen 值

> ID：12810037
> 
> 赞同：3
> 
> 时间：2012-10-09T23:51:43.870
> 
> 标签：javascript, knockout.js, observable

我对 Knockout.js 还很陌生，所以我可能只是遗漏了一些东西。我正在尝试创建一组用作按钮的 div，其中它们的“选定”状态反映了数组中项目的子值。

看到这个小提琴：http: [//jsfiddle.net/bleiddyn/RepnY/](http://jsfiddle.net/bleiddyn/RepnY/)

摘抄：

```
 $('.tag-cell').click(function() {
        var ele = event.srcElement.textContent;
        var match = ko.utils.arrayFirst(self.Tags(), function(item) {
            if (ele === item.title) {
                item.chosen = !item.chosen;
                return true;
            }
            return false;
        });

        match.chosen = true;
        self.Tags.valueHasMutated();
    }); 
```

div 的初始显示是正确的。似乎我可以使单击事件更改可观察数组中的值而不会出现问题。但是，显示的 div 不会更改 css 类以响应此问题。

我意识到作为数组中的项目的对象的子对象本身不是可观察的。但是，我对 valueHasMutated() 的调用不应该强迫这个问题吗？这也可能不是完成该行为的最优雅的方式。

有人想帮助学习 javascript 的人吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:13:27.647

为了更新绑定的属性，您必须使有问题的属性可观察。此外，您不需要 jQuery 来处理`click`事件，您可以使用`event`绑定来完成：

```
function item(options) {
    var self = this;
    this.title = ko.observable(options.title);
    this.level = ko.observable(options.level);
    this.chosen = ko.observable(options.chosen);
    this.toggleItem = function () {
        self.chosen(!self.chosen());
    };
}

function myViewModel() {
    var self = this;
    self.Tags = ko.observableArray([
        new item({
        title: 'Tag1',
        level: 'Primary',
        chosen: true
    }),
        new item({
        title: 'Tag2',
        level: 'Primary',
        chosen: false
    }),
        new item({
        title: 'Tag3',
        level: 'Primary',
        chosen: false
    }),
        new item({
        title: 'Tag4',
        level: 'Primary',
        chosen: false
    }),
        new item({
        title: 'OtherTag',
        level: 'Secondary',
        chosen: false
    })]);

    self.PrimaryTags = ko.computed(function() {
        return ko.utils.arrayFilter(this.Tags(), function(tag) {
            return tag.level() === 'Primary';
        });
    }, self);
    self.SecondaryTags = ko.computed(function() {
        return ko.utils.arrayFilter(this.Tags(), function(tag) {
            return tag.level() === 'Secondary';
        });
    }, self);

}

var vm = new myViewModel();
ko.applyBindings(vm); 
```

​<strong>示例：http: [//jsfiddle.net/andrewwhitaker/RepnY/1/](http://jsfiddle.net/andrewwhitaker/RepnY/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T00:13:46.387

observableArrays 仅跟踪数组本身（添加/删除的项目等）。您可能希望使`chosen`属性可观察，然后添加一个函数来切换它。

Sample here: [http://jsfiddle.net/rniemeyer/7aVVy/](http://jsfiddle.net/rniemeyer/7aVVy/)

From your example, your markup might look like:

```
<div data-bind="foreach: PrimaryTags" class='tag-grid'>
    <span class="tag-cell" data-bind="text: title, css: { chosen: chosen }, click: $parent.toggleChosen">
    </span>
</div>​ 
```

with your view model like:

```
function MyViewModel() {
    var self = this;
    self.Tags= ko.observableArray([
        {
        title: 'Tag1',
        level: 'Primary',
        chosen: ko.observable(true)},
    {
        title: 'Tag2',
        level: 'Primary',
        chosen: ko.observable(false) },
    {
        title: 'Tag3',
        level: 'Primary',
        chosen: ko.observable(false)},
    {
        title: 'Tag4',
        level: 'Primary',
        chosen: ko.observable(false)},
    {
        title: 'OtherTag',
        level: 'Secondary',
        chosen: ko.observable(false)}]);

    self.toggleChosen = function(tag) {
        tag.chosen(!tag.chosen());  
    };

    self.PrimaryTags = ko.computed(function() {
        return ko.utils.arrayFilter(self.Tags(), function(tag) {
            return tag.level === 'Primary';
        });
    });
    self.SecondaryTags = ko.computed(function() {
        return ko.utils.arrayFilter(self.Tags(), function(tag) {
            return tag.level === 'Secondary';
        });
    });
} 
```

# android - Android NDK静态库调试（合并项目？）

> ID：12810040
> 
> 赞同：6
> 
> 时间：2012-10-09T23:52:11.880
> 
> 标签：android, eclipse, android-ndk, static-libraries

我正在寻找一种更好的方法来调试我正在处理的具有非常大的 NDK 核心的大型项目。NDK 代码由一个大型 C/C++ 静态库组成，该库被构建然后通过 NDK 代码链接到主 android 应用程序。项目的 NDK 部分本身也在一个 android 库项目中。所以总共有三个项目（Android -> NDK 胶水项目 -> Native C lib）

据我了解，NDK 调试在尝试与库项目交互时效果不佳（或根本没有）。我怀疑我可以将 NDK 胶水代码项目与主要的 android 项目合并，但痛苦相对较小，但更大的问题是包含项目核心的 C/C++ 项目。

有没有一种可行的方法来合并 C/C++ 项目和 android NDK 项目，而不必为 C++/C 项目重写构建/制作脚本？

静态库的当前构建脚本非常复杂，可能很难转换为 Android.mk 文件。

有没有我没有考虑过的更好的方法来做到这一点？

# autohotkey - 检查可变数量的 If 语句

> ID：12810042
> 
> 赞同：1
> 
> 时间：2012-10-09T23:52:31.513
> 
> 标签：autohotkey

我从 Ini 文件中检索具有一系列文件扩展名的字符串到数组。本质上，我想检查我的变量 %ext% 是否等于数组中的任何这些文件扩展名。为了澄清起见，我不提前知道有多少物品。

我知道我解释得不好，所以我会尝试用伪代码来阐明

```
ext := jpg ;(for example)
IniRead, extsFromFile, data.ini, Images, Extensions
StringSplit, allExts, extsFromFile, `,
If (ext = <any of the elements in the array allExts>)
    doStuff() 
```

我对如何在 Autohotkey 中解决这个问题一无所知。我对语言没有我想要的那么熟悉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:19:10.347

**编码：**

```
ext := "jpg"
found := "false"

Loop, read, ExtsList.txt ;this loops reads each line of the file...
{
    If ext = %A_LoopReadLine% ; A_LoopReadLine is the value of the current line...
    {
        msgbox, Found "%ext%" in "ExtsList.txt" at line "%A_Index%"...
        ;call function "dostuff()"
        found := "true"
    }
}

if found = false
{
msgbox, Did not find "%ext%" in "ExtsList.txt"...
} 
```

**ExtsList.txt**

```
png
svg
xml
jpg
html
txt 
```

祝你好运！:D

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T03:53:05.930

StringSplit 以 OutputVar0 的形式为您提供最后一个元素的索引（或长度，取决于您如何看待它）。您可以循环使用内置的 A_Index 变量来检查每个元素是否匹配。

```
ext := "jpg" ;(for example)
IniRead, extsFromFile, data.ini, Images, Extensions

; For debugging/testing purposes
extsFromFile = png,bmp,tiff,jpg

StringSplit, allExts, extsFromFile, `,
Loop %allExts0% 
    If (ext = allExts%A_Index%) 
        MsgBox Match! We have %allExts0% extensions and "%ext%" was the %A_Index%th 
```

给

> 匹配！我们有 4 个扩展名，“jpg”是第 4 个

# android - Eclipse for Java (EE) Developers 和 Eclipse for Mobile Developers 和 Eclipse Classic 之间有什么区别？

> ID：12810044
> 
> 赞同：2
> 
> 时间：2012-10-09T23:53:21.017
> 
> 标签：android

上述 IDE 中最好的 Android 开发 IDE 是什么，还有其他 IDE 压倒它们吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:15:32.110

区别在于捆绑的插件。如果你不打算做任何 Java EE 的东西（servlet、JSP 等）。得到经典的。如果需要，您可以随时安装更多插件。唯一具有良好 Android 支持的其他（主要）IDE 是 IntelliJ。不确定 NetBeans（现在叫什么？）的位置，但那是 Oracle 技术......

# php - PHP 正则表达式字符串，带 + 括号 + 所有非字母数字字符，# 和 (?!\^) 除外

> ID：12810046
> 
> 赞同：0
> 
> 时间：2012-10-09T23:53:34.073
> 
> 标签：php, regex, sms-gateway

> **可能重复：**
> [PHP 从字符串中删除特殊字符](https://stackoverflow.com/questions/6073221/php-remove-special-character-from-string)

我想以这种方式找到一个正则表达式：

我在 $sms 变量中有 SMS 消息的正文。结果我会得到一个字符串：

```
- parenthesis
- the non alphanumeric character )([]#@*^?!|"&% and remove the other that remain
- all alphanumeric character and numeric 
```

这是因为我的 sms 网关机器存在一些问题，它无法传递带有这个字符°的消息，该字符在意大利语言中经常用于枚举数字。

我需要使用 PHP 来执行此操作，但只有正则表达式可以提供很大帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:22:09.507

```
$newSMS = preg_replace('/[^)(\[\]#*^?!|"&%a-zA-Z0-9]/', '', $sms); 
```

正则表达式匹配您描述的字符（ `[...]`）中不是（ ）的任何一个字符（） ，并将它们替换为空字符串，这与删除它们基本相同。此正则表达式可以缩短为：`^``)(\[\]#*^?!|"&%a-zA-Z0-9``''`

```
/[^)(\[\]#*^?!|"&%a-z\d]/i 
```

通过使用`\d`代表`0-9`和不区分大小写的模式 ( `i`) 这样我们就不必重复这些字母，但节省的费用很少，特别是因为 PHP 的数字无论如何都只是 ASCII。

# php - 无法将对象转换为字符串

> ID：12810049
> 
> 赞同：1
> 
> 时间：2012-10-09T23:53:55.463
> 
> 标签：php

我想在页面上以文本形式输出查询结果，以便查看它的外观。问题是，如果我像下面那样使用回声，甚至使用打印，我会收到错误消息。

我收到的错误是关于无法将对象转换为字符串

我的问题是在页面上输出查询结果的最佳方式是什么？

下面是代码：

```
$answersql = "INSERT INTO Answer (Answer) 
    VALUES (?)";

      if (!$insertanswer = $mysqli->prepare($answersql)) {
      // Handle errors with prepare operation here
    }  

    $insertanswer->bind_param("s", $_POST['value'][$i]);

        //$insertanswer->execute();

        echo $insertanswer;

        if ($insertanswer->errno) {
          // Handle query error here
        }

        $insertanswer->close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:06:17.747

您没有输出查询结果。您似乎正在尝试输出查询本身。

但是，`$insertanswer`是[mysqli_statement](http://www.php.net/manual/en/class.mysqli-stmt.php)的一个实例。此类似乎不提供对查询的访问。

这就是为什么您不能将其打印为字符串的原因。它不是一个字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:08:54.897

您可以尝试使用字符串进行类型转换。例如，您声明一个变量来保存结果转换，例如 $answersql = "INSERT INTO Answer ((string)Answer)) VALUES (?)"; 或者您可以输入分配的变量： (string)$answersql = "INSERT INTO Answer (Answer) VALUES (?)"; 取决于您需要结果的方式或位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:19:58.270

情侣物品。在您的绑定中，您需要先将 $_POST 分配给一个变量。我看到你在那里有一个计数器，但看不到你在哪里迭代任何东西。我假设您可以将 $_POST['value'] 分配给比例变量。

```
 $input = $_POST['value']; 
```

如果您在 db 表列上设置了 auto_increment 属性，则 INSERT 返回 true 或 false 和一个 ID。如果是这样，您可以使用

```
 $insertid = $insertanswer->insert_id; 
```

但是，您编写语句的方式，它不会返回任何值。只是 true 或 false 和一个 id（如果设置了 auto_increment 属性）。

# java - 为什么编译器不将 Circle 类视为实例？

> ID：12810051
> 
> 赞同：0
> 
> 时间：2012-10-09T23:54:26.680
> 
> 标签：java

现在我正在尝试在我的菜单类中的一个方法中实例化 Circle 类（它是 Shape 的子类）。但问题是我不断收到编译器错误，说 Circle 无法解析为类型。换句话说 in 甚至不承认我的 Circle 类是一个实例，它只是认为它是另一个变量。我尝试在实例化中使用变量，并尝试在构造函数中使用设置器。

这是我试图实例化 Circle 的菜单类中的方法

```
public void select_case()
    {
        switch (menu_select)
        {
            case 1: Circle c = new Circle(1);
                    break;

        }

    } 
```

以防万一您需要知道，menu_select 是一个私有整数变量。

这是我的 Circle 类的代码。我只会向构造函数展示以减少混乱。

```
public class Circle extends Shape 
{
    final private pi = Java.lang.Math.PI;
    //Constructor
     Circle(double r)
     {
        super(r);
     }
} 
```

这是形状超类的代码。与 circle 类的代码一样，仅显示了构造函数。

```
public abstract class Shape 
{
    private static double scaleFactor;
    private double base;
    private double radius;
    private double height;
    //Constructor for circle
    public Shape(double r)
    {
        radius = r;
    }   
    //Constructor for rectangle
    public Shape(double b, double h)
    {
        base = b;
        height = h;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T23:58:46.197

```
final private pi = Java.lang.Math.PI; 
```

应该

```
private final double pi = java.lang.Math.PI; 
```

要不就

```
private final double pi = Math.PI; 
```

除此之外，我在代码中没有看到任何错误。

# c# - 将 htmlweb 委托从 c# 转换为 vb.net

> ID：12810055
> 
> 赞同：0
> 
> 时间：2012-10-09T23:55:33.557
> 
> 标签：c#, vb.net, delegates, html-agility-pack

我需要将[此处](http://blog.jongallant.com/2012/07/htmlagilitypack-set-timeout.html#.UHSy6pfNVvA)找到的此代码转换为其 vb.net equivqlent，有人可以帮助我吗？

代码摘录

```
/// <summary>
/// Represents the method that will handle the PreRequest event.
/// </summary>
public delegate bool PreRequestHandler(HttpWebRequest request);

//And they call that delegate right before making the GetResponse call:
if (PreRequest != null)
{
    // allow our user to change the request at will
    if (!PreRequest(req))
    {
        return HttpStatusCode.ResetContent;
    }              
}

HttpWebResponse resp;

try
{
    resp = req.GetResponse() as HttpWebResponse;
}

//So all you have to do is assign a delegate to PreRequest and set your timeout within that delegate:

var web = new HtmlWeb();
web.PreRequest = delegate(HttpWebRequest webRequest)
{
     webRequest.Timeout = 4;
     return true;
};
var doc = web.Load("http://www.msn.com/"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:49:43.413

```
''' <summary> 
''' Represents the method that will handle the PreRequest event. 
''' </summary> 
Public Delegate Function PreRequestHandler(ByVal request As HttpWebRequest) As Boolean

'And they call that delegate right before making the GetResponse call: 
If PreRequest IsNot Nothing Then
    ' allow our user to change the request at will 
    If Not PreRequest(req) Then
        Return HttpStatusCode.ResetContent
    End If
End If

Dim resp As HttpWebResponse

Try
    resp = TryCast(req.GetResponse(), HttpWebResponse)
End Try

'So all you have to do is assign a delegate to PreRequest and set your timeout within that delegate: 

Dim web = New HtmlWeb()
web.PreRequest = Function(webRequest As HttpWebRequest)
     webRequest.Timeout = 4
     Return [True]
End Function
Dim doc = web.Load("http://www.msn.com/") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:01:55.477

转到[http://converter.telerik.com/](http://converter.telerik.com/) - 粘贴您的 C# 代码并取回 VB 代码。

# java - SLF4J：避免完全限定的类名

> ID：12810056
> 
> 赞同：4
> 
> 时间：2012-10-09T23:55:35.323
> 
> 标签：java, logging, slf4j

这对你的家伙来说很容易！

如何防止 SLF4J 显示完全限定的类名（例如`com.mycompany.mypackage.MyObject`）并仅输出`MyObject`？

我通常更喜欢这个：

1)

```
private static final Logger LOGGER = LoggerFactory
        .getLogger(MyObject.class); 
```

对此：

2)

```
private static final Logger LOGGER = LoggerFactory
        .getLogger("MyObject"); 
```

这样当我重构/重命名`MyObject`引用`MyThing`时，就会自动为我更新。

然而.. 1）我得到笨拙的输出：`com.mycompany.mypackage.MyObject`

我只需要`MyObject`在日志中查看...

可选：如果您知道如何`\e[0;33m`根据日志级别有选择地对输出进行着色（例如），那将是很高兴知道的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T00:32:22.483

根据 的[API](http://www.slf4j.org/api/org/slf4j/impl/SimpleLogger.html)，`SimpleLogger`您可以尝试将实例的`org.slf4j.simpleLogger.showShortLogName`属性设置为.`LOGGER``true`

从 API：

> `org.slf4j.simpleLogger.showShortLogName`-`true`如果您希望名称的最后一个组成部分包含在输出消息中，请设置为。默认为`false`.

# java - 保持绘制图形 - 删除 super.paintComponent

> ID：12810057
> 
> 赞同：2
> 
> 时间：2012-10-09T23:55:49.080
> 
> 标签：java, swing, graphics, repaint, paintcomponent

我有一个名为 Foo 的类，它扩展了一个名为 Bar 的类，该类扩展了 JPanel 并实现了 ActionListener。当我选择圆形并单击绘制按钮时，我绘制了一个圆形，当我按下矩形并单击绘制时，它会擦除​​以前的形状并绘制一个矩形。

但是，我想保留 JPanel 上的所有形状，直到我选择单击擦除按钮。所以我删除了`super.paintComponent(g)`它，它可以工作，但它也会导致 Bar 类的按钮以一种故障的方式重新出现。我怎样才能阻止按钮再次绘画？我在想不要扩展 Bar 并让 Foo 扩展 JPanel。

```
 public class Bar extends JPanel implements ActionListener
    {
    public void actionPerformed(ActionEvent e)
    {

        if (e.getActionCommand() == "Draw")
        {
            this.requestDraw = true;
            repaint();
        }
            if (e.getActionCommand() == "Circle")
            {
                requestRectangle = false;
                requestTriangle = false;
                requestCircle = true;
            }
            if (e.getActionCommand() == "Rectangle")
            {
                requestCircle = false;
                requestTriangle = false;
                requestRectangle = true;
            }
            if (e.getActionCommand() == "Right Triangle")
            {
                requestCircle = false;
                requestRectangle = false;
                requestTriangle = true;
            }
    }

    public class Foo extends Bar
    {    
        @Override
        public void paintComponent(Graphics g)
        {
            //super.paintComponent(g);
            if(RequestDraw())
            {

                if(RequestCircle())
                    circle.draw(g);
                if(RequestRectangle())
                    rectangle.draw(g);
                if(RequestTriangle())
                    rightTriangle.draw(g);

            }

            if(!RequestDraw())
            {                    

                g.setColor(getBackground());
                g.fillRect(0,0,getWidth(), getHeight());
            }        
        }
    }
} 
```

![在此处输入图像描述](../Images/4588da71cd229d081fe79d422ab7258d.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T01:00:35.830

除了气垫船的所有评论

Graphics 上下文在组件之间共享。的任务之一`super.paintComponent`是在绘制之前“清理”图形上下文。

这就是为什么您会看到两个版本的按钮...

我也会做一些不同的事情。随着时间的推移，这应该有助于可扩展性和重用性，并且还可以稍微减少逻辑。

我会...

*   将形状抽象为具有最低要求的基本“形状”类，例如填充和描边颜色、位置、大小、描边等，并且知道如何绘制自身。
*   我会创建某种模型，允许您分离和定义责任的界限。“管理”形状不是组件的责任，它只关心在其表面上绘制它们。同样，组件不关心“形状”是什么，它只想知道如何绘制它们......
*   我会使用`Action`s 来简单地创建这些形状并将它们添加到模型中......

![在此处输入图像描述](../Images/b0e111fe5af0ab4aac2c657b7f2c1120.png)

我只创建了一个三角形（除了位置和大小之外，它没有其他属性），但我相信你会明白一般的想法......（ps你需要为动作提供你自己的三角形图标;))

```
public class DrawMe {

    public static void main(String[] args) {
        new DrawMe();
    }

    public DrawMe() {

        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());

                DrawModel model = new DefaultDrawModel();
                model.addElement(new Triangle(new Rectangle(10, 10, 100, 100)));
                DrawPane drawPane = new DrawPane(model);

                JToolBar toolBar = new JToolBar();
                toolBar.add(new AddTriangleAction(model));
                frame.add(toolBar, BorderLayout.NORTH);

                frame.add(drawPane);
                frame.setSize(400, 400);
                frame.setVisible(true);
            }
        });

    }

    /**
     * Simple action used to add triangles to the model...the model acts
     * as a bridge between the action and the UI.
     */
    protected class AddTriangleAction extends AbstractAction {

        private DrawModel model;

        public AddTriangleAction(DrawModel model) {
            // Supply your own icon
            putValue(SMALL_ICON, new ImageIcon(getClass().getResource("/shape_triangle.png")));
            this.model = model;
        }

        public DrawModel getModel() {
            return model;
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            // Randomly add the triangles...
            int x = (int)(Math.random() * 400);
            int y = (int)(Math.random() * 400);
            model.addElement(new Triangle(new Rectangle(x, y, 100, 100)));
        }

    }

    /**
     * This is the background pane, from which the draw pane extends...
     */
    protected class BackgroundPane extends JPanel {
        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            int x = getWidth() / 2;
            int y = getHeight() / 2;

            Graphics2D g2d = (Graphics2D) g.create();
            RadialGradientPaint rgp = new RadialGradientPaint(
                    new Point(x, y),
                    Math.max(getWidth(), getHeight()),
                    new float[]{0f, 1f},
                    new Color[]{Color.GRAY, Color.WHITE}
                    );

            g2d.setPaint(rgp);
            g2d.fill(new Rectangle(0, 0, getWidth(), getHeight()));

            g2d.setBackground(Color.BLACK);
            g2d.drawRect(0, 0, getWidth() - 1, getHeight() - 1);

            g2d.dispose();
        }
    }

    /**
     * This is a simple model, I stole the list model because it was quicker
     * and easier to demonstrate (don't need to write all the listeners)
     */
    public interface DrawModel extends ListModel<DrawMeShape> {
        public void addElement(DrawMeShape shape);
        public void removeElement(DrawMeShape shape);
    }

    /**
     * A default implementation of the DrawModel...
     */
    public class DefaultDrawModel extends DefaultListModel<DrawMeShape> implements DrawModel {
        @Override
        public void removeElement(DrawMeShape shape) {
            removeElement((Object)shape);
        }
    }

    /**
     * The actually "canvas" that shapes are rendered to
     */
    protected class DrawPane extends BackgroundPane {

        // Should provide ability to setModel...
        private DrawModel model;

        public DrawPane(DrawModel model) {
            this.model = model;
            model.addListDataListener(new ListDataListener() {

                @Override
                public void intervalAdded(ListDataEvent e) {
                    repaint();
                }

                @Override
                public void intervalRemoved(ListDataEvent e) {
                    repaint();
                }

                @Override
                public void contentsChanged(ListDataEvent e) {
                    repaint();
                }
            });
        }

        public DrawModel getModel() {
            return model;
        }

        @Override
        protected void paintComponent(Graphics g) {

            super.paintComponent(g);

            // Draw the shapes from the model...
            Graphics2D g2d = (Graphics2D) g.create();
            DrawModel model = getModel();
            for (int index = 0; index < model.getSize(); index++) {
                DrawMeShape shape = model.getElementAt(index);
                shape.paint(g2d, this);
            }

            g2d.dispose();

        }

    }

    /**
     * A abstract concept of a shape.  Personally, if I was doing it, I would
     * generate an interface first, but this is just a proof of concept...
     */
    public abstract class DrawMeShape {

        private Rectangle bounds;

        public void setBounds(Rectangle bounds) {
            this.bounds = bounds;
        }

        public Rectangle getBounds() {
            return bounds;
        }

        protected abstract Shape getShape();

        /**
         * The shape knows how to paint, but it needs to know what to paint...
         * @param g2d
         * @param parent 
         */
        public void paint(Graphics2D g2d, JComponent parent) {
            g2d = (Graphics2D) g2d.create();
            Rectangle bounds = getBounds();
            Shape shape = getShape();
            g2d.translate(bounds.x, bounds.y);
            g2d.setColor(Color.DARK_GRAY);
            g2d.fill(shape);
            g2d.setColor(Color.BLACK);
            g2d.draw(shape);
            g2d.dispose();
        }

    }

    /**
     * An implementation of a Triangle shape...
     */
    public class Triangle extends DrawMeShape {

        public Triangle(Rectangle bounds) {
            setBounds(bounds);
        }

        @Override
        protected Shape getShape() {
            // This should be cached ;)
            Path2D path = new Path2D.Float();
            Rectangle bounds = getBounds();

            path.moveTo(bounds.width / 2, 0);
            path.lineTo(bounds.width, bounds.height);
            path.lineTo(0, bounds.height);
            path.lineTo(bounds.width / 2, 0);
            path.closePath();

            return path;
        }
    }
} 
```

快乐的画...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T00:12:18.537

建议：

*   不要删除`super.paintComponent(g)`，因为它具有必要的重要作用。
*   相反，为什么不绘制到 BufferedImage，然后在`paintComponent(...)`方法覆盖中绘制该 BufferedImage。
*   然后，如果您想擦除绘制的图像，只需创建一个新的 BufferedImage，或在其上绘制。

顺便说一句，不要使用`==`. 请改用`equals(...)`or`equalsIgnoreCase(...)`方法。了解 == 检查两个*对象*是否相同，这不是您感兴趣的。另一方面，这些方法检查两个字符串是否具有相同顺序的相同字符，这在这里很重要。所以而不是

```
if (fu == "bar") {
  // do something
} 
```

做，

```
if ("bar".equals(fu)) {
  // do something
} 
```

或者，

```
if ("bar".equalsIgnoreCase(fu)) {
  // do something
} 
```

# ruby-on-rails - 将字符串转换并存储为货币值

> ID：12810059
> 
> 赞同：2
> 
> 时间：2012-10-09T23:56:07.457
> 
> 标签：ruby-on-rails, ruby, rubygems

我有一个字符串，我需要将其转换为 RUBY 中的货币格式并验证它是否与预期匹配。

```
String = "$6,178.50 USD / 22,693.01 AED" 
```

我想把它分成2个不同的变量，比如

```
usa_price = $6,178.50

aed_price = 22,693.01 
```

`expected_output= $6,178.50 * 3.67 = 22,693.01`（应与 AED 中的值匹配）

我尝试做 gsub/scan，现在我很困惑，在 Ruby 中实现这一目标的最佳方法是什么！！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T00:13:12.637

我会拆分`/`然后使用[`money`](http://money.rubyforge.org/)gem 解析出金额，如下所示：

```
require 'money'
amounts = "$6,178.50 USD / 22,693.01 AED".split("/")
amounts.map! { |amount| Money.parse(amount) } 
```

然后，因为它们现在是`Money`对象，你可以用它们做金钱的事情：

```
>> amounts.first.format
=> "$6,178.50" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:08:21.347

如果您确定第一个数字是 USD 而第二个数字是 AED 并且订单不会改变，那么：

```
str = "$6,178.50 USD / 22,693.01 AED"

usa_price, aed_price = str.scan(/\d{1,2}?,?\d{1,3}\.\d{2}/)

#=> usa_price = 6,178.50, aed_price = 22,693.01 
```

# ruby - 有人让 swank.rb 使用 Emacs 24 吗？

> ID：12810061
> 
> 赞同：2
> 
> 时间：2012-10-09T23:56:24.400
> 
> 标签：ruby, emacs, slime

我一直在寻找 Ruby 的 SWANK 服务器实现。

我找到了[https://bitbucket.org/yinwm/usemacs/src/5bb82e78239c/raw-elisp/march/macos/site-lisp/slime/contrib/swank.rb](https://bitbucket.org/yinwm/usemacs/src/5bb82e78239c/raw-elisp/march/macos/site-lisp/slime/contrib/swank.rb)但运气不好让它与 Emacs 24 和红宝石 1.9.3。

其他人有运气吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-14T00:57:00.220

在图书馆四处逛逛之后，它似乎并不完整。在自己调整了 swank.rb 代码之后，我能够让 slime-connect 工作。不过，它需要相当多的润色才能成为一个成熟的时髦服务器。

# qt - 检查一个小部件是否在 Qt 布局中

> ID：12810063
> 
> 赞同：8
> 
> 时间：2012-10-09T23:56:31.577
> 
> 标签：qt

如何检查小部件是否在布局中？我有一个可能包含或不包含小部件的布局。

*   小部件名称：`infoClient`

*   图层名称： `verticalLayout_3`

需要检查小部件是否存在于布局中，然后不要添加新的。
如果不存在，则添加一个新的。
怎么做？

```
void MainWindow::slotPush1()
{
    if <there is no infoClient> ui->verticalLayout_3->addWidget(new infoClient(this));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T08:09:02.383

几点：

*   布局中小部件的父级是包含**顶级**布局的小部件
*   布局可以嵌套。
*   布局包含项目（[QLayoutItem](http://qt-project.org/doc/qt-4.8/qlayoutitem.html)），它们可以是布局（`layout()`不为空）或小部件（`widget()`不为空）。最后，您有一个布局项目树。

因此，您需要从父小部件（dfs、bfs）进行搜索。

```
bool checkWidgetInsideLayout(const QWidget* _someWidget){

return _someWidget != NULL && 
       _someWidget->parent() != NULL && 
       _someWidget->parent()->layout() != NULL && 
       foundItem(_someWidget->parent()->layout(), _someWidget ); 
}

//clumsy dfs
bool foundItem(const QLayout* layout, const QWidget* _someWidget ){

     for(int i = 0; i < layout->count(); i++){
        QLayoutItem* item = layout->itemAt(i);
        if(item->widget() == _someWidget )
            return true;
         if(item->layout() && foundItem(item->layout(), _someWidget)  )
             return true;
     }
     return false;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T01:04:40.807

Qt 中没有机制可以执行您正在寻找的检查。您必须自己实现它：

```
void MainWindow::slotPush1()
{
   if (doesLayoutContainInfoClient(ui->verticalLayout_3))
   {
      ui->verticalLayout_3->addWidget(new infoClient(this));
   }
}

bool MainWindow::doesLayoutContainInfoClient(QLayout* layout)
{
   const QString infoClientName("infoClient");

   for (int i=0; i<layout->count(); i++)
   {
      QWidget* layoutWidget = layout->itemAt(i)->widget();
      if (layoutWidget)
      {
         if (infoClientName == layoutWidget->metaObject()->className())
         {
            return true;
         }
      }
   }
   return false;
} 
```

尽管我在上面提出了建议，但我并不真正推荐它。将您是否已将 infoClient 添加到布局中作为独立布尔值存储在程序中的某个位置会更有意义。以这种方式查询布局的内容有些不寻常，而且比仅使用`bool`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T01:06:25.517

使用[QObject::findChild](http://qt-project.org/doc/qt-4.8/qobject.html#findChild)按名称查找子项。例如：

```
void MainWindow::slotPush1()
{
    if (ui->verticalLayout_3->findChild<QWidget*>("infoClient")) // your code to add it here
} 
```

注意：findChild 是一个模板函数。如果您不熟悉模板函数，只需知道您传递了您想要查找的对象类型（在您的示例中，看起来您可以使用`ui->verticalLayout_3->findChild<infoClient*>("infoClient")`）。如果你想找到一个 QWidget，或者任何从 QWidget 继承的东西，你可以使用`findChild<QWidget*>()`并且你会很安全。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-10T06:13:09.510

我同意汤姆潘宁用这种方法找到你的孩子的解决方案`QObject::findChild()`。但是将 Widget 添加到 QLayout 会将其重新设置为布局的父级。所以你必须通过`MainWindow`像这样的对象调用它来找到它：

```
void MainWindow::slotPush1()
{
    if (this->findChild<QWidget*>("infoClient")) {
        // ...
    }
} 
```

如果您的 infoClient 小部件已添加到 QtDesigner 中，您将不会遇到此解决方案的问题。设计者默认设置对象名称。如果 infoClient 被添加到代码中的布局中，则必须显式设置对象名称，否则将无法找到它，因为它的名称为空：（假设 m_client 是 MainWindow 的成员变量）

```
void MainWindow::createWidgets()
{
    if (infoClientShouldBeAdded) {
        m_client = new infoClient(this);
        m_client->setObjectName("infoClient");
        ui->verticalLayout_3->addWidget(m_infoClient);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-12T05:24:25.923

另一种可能性是跟踪您创建的小部件的指针（例如，通过将它们存储在 std::vector 或 Qt 等效项中）。这允许使用 [indexof(QWidget*)](http://doc.qt.io/qt-5/qlayout.html#indexOf)：

> 在此布局中搜索小部件小部件（不包括子布局）。返回小部件的索引，如果未找到小部件，则返回 -1。

# jquery - jQuery：克隆表中的最新行 - 不是最后一行，最新

> ID：12810075
> 
> 赞同：1
> 
> 时间：2012-10-09T23:58:02.467
> 
> 标签：jquery, forms, html-table

我有一个表单，可以在提交时向表中添加行：

```
<form id="scan_form" name="scan_form" method="post" action="/cgi-bin/app/app.pl" onsubmit="return checkout('f00b@r');"> 
```

**旁注**
想要在不“干扰”其现有功能的情况下添加/附加提交功能如下：

```
$("#scan_form").submit(function() {
    //clone row and add to hidden table.
}); 
```

当它添加一行时，我希望它将同一行添加到不同的隐藏表中进行打印。

我在想我需要以某种方式将一个函数绑定到将同一行添加到另一个表但被卡住的表。使用下面的 SO 问题作为模板，我如何捕获这个最新的行？

[监听添加的表格行](https://stackoverflow.com/questions/9095472/listen-for-added-table-rows)

```
$('#table_id').bind('rowAddOrRemove', function(event){
    //do what you want.
}); 
```

该表按字母顺序排序，因此最新的行不一定是最后一行。

**更新**
尝试这个想法：

第 1 步：将所有现有行的 id 设置为“oldRow”

```
$( '#loanTable tr' ).attr("id", "oldRow"); 
```

第2步：克隆上面的表：

```
var lbl = $("#loanTable tbody");
var newLbl = $(lbl[0].outerHTML); 
```

第 3 步：删除 id 为 'oldRow' 的行

```
$(".oldRow", newLbl).remove(); 
```

如您所料，它删除了所有内容。如何连接这些点？

**更新 2**
如何执行以下操作？

```
$('#table_id').bind('rowAddOrRemove', function(event){
        //add attribute print to 'this' row.
}); 
```

想要标记添加到表中的新行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:01:52.183

您可以尝试使用某个类创建新行，例如“.newRow”，在事件中您应该删除此类以准备下一次插入：

```
$('#table_id .newRow').trigger('rowAddOrRemove');

$('#table_id').bind('rowAddOrRemove', function(event){
   //do what you want.
   $(this).removeClass('.newRow');
}); 
```

# javascript - 等到 Ext.Ajax.request 响应成功后再设置变量

> ID：12810076
> 
> 赞同：0
> 
> 时间：2012-10-09T23:58:29.783
> 
> 标签：javascript, ajax, json, extjs, asynchronous

下面您将看到一些代码来设置 extjs 4 应用程序的当前登录用户。如果我未注释警报，则代码似乎要等到警报被接受后，代码才会继续（似乎）。这为异步调用成功完成提供了足够的时间。如果我注释掉警报，变量“employeeFilter”永远不会被设置，因为 AJAX 调用没有及时返回。在这种情况下，它将“employeeFilter”设置为 null。我该如何解决这个问题，让它等到 AJAX 响应成功返回？

```
var loggedInUserId = null;
Ext.Ajax.request({
    url: '/Controls/UserList/UserService.asmx/GetLoggedInUserId',
    method: 'POST',
    jsonData: { 'x': 'x' },
    success: function (response, opt) {
        loggedInUserId = Ext.decode(response.responseText).d;
    },
    failure: function (response) {
    }
});

//alert(loggedInUserId);
var employeeFilter = loggedInUserId;
var projectFilter = '-1'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:10:05.147

我会这样做的。

```
var employeeFilter;        
Ext.Ajax.request({
    url: '/Controls/UserList/UserService.asmx/GetLoggedInUserId',
    method: 'POST',
    jsonData: { 'x': 'x' },
    success: function (response, opt) {
        employeeFilter = Ext.decode(response.responseText).d;
        //Do here whatever you need to do once the employeeFilter is set. probably call a function and pass the employee filter as parameter. 
    },
    failure: function (response) {
    }
});

var projectFilter = '-1'; 
```

# arrays - ada重命名数组

> ID：12810078
> 
> 赞同：1
> 
> 时间：2012-10-09T23:58:43.510
> 
> 标签：arrays, ada

我正在尝试将相同的数组用于不同的操作，而不是使用 3 个不同的数组来节省空间。例如，在我的程序空间的某个部分 1..5 未使用，而另一部分空间 3..8 未使用。

关键字**重命名**会起作用吗？像这样的东西？

```
type SharedArray is array (integer range 1..10) of integer;
array1: SharedArray;
array2: SharedArray renames array1(1..5); 
```

如果我是对的，那么 array2 不是一个全新的数组，它只是指 array1 每当它的值发生变化时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:34:18.857

我的第一个想法是“不，这行不通”。但后来我用 GNAT GPL 2012 写了这个：

```
with Text_IO; use Text_IO;

procedure Ren_Test is

   type Shared_Array is array (Integer range 1 .. 10) of Integer;

   Array1 : Shared_Array := (others => 42);
   Array2 : Shared_Array renames Array1(1..5);

begin
   Put_Line("Array1 range: " & Integer'Image(Array1'First) & " .." 
          & Integer'Image(Array1'Last));
   Put_Line("Array2 range: " & Integer'Image(Array2'First) & " .." 
          & Integer'Image(Array2'Last));
   New_Line;
   Put_Line("Dump Array1");
   for I in Array1'Range loop
      Put(Integer'Image(Array1(I)));
      if I /= Array1'Last then
         Put(",");
      end if;
   end loop;
   New_Line(2);

   Put_Line("Dump and modify renaming Array2");
   for I in Array2'Range loop
      Put(Integer'Image(Array2(I)));
      if I /= Array2'Last then
         Put(",");
      end if;
      Array1(I) := Array1(I) + 17;
   end loop;
   New_Line(2);

   Put_Line("Redump Array1");
   for I in Array1'Range loop
      Put(Integer'Image(Array1(I)));
      if I /= Array1'Last then
         Put(",");
      end if;
   end loop;
   New_Line;
end Ren_Test; 
```

运行它让我：

```
[35] Marc say: ./ren_test
Array1 range:  1 .. 10
Array2 range:  1 .. 5

Dump Array1
 42, 42, 42, 42, 42, 42, 42, 42, 42, 42

Dump and modify renaming Array2
 42, 42, 42, 42, 42

Redump Array1
 59, 59, 59, 59, 59, 42, 42, 42, 42, 42 
```

我会说我对此并不满意，主要是因为我预计将约束数组切片到小于其声明大小时会出现 Constraint_Error。所以我不*知道*这是合法代码，我知道 GNAT GPL 2012 可以毫无问题地编译和运行它。

当 Shared_Array 是一个不受约束的数组时，我会舒服得多：

```
 type Shared_Array is array (Integer range <>) of Integer;

   Array1 : Shared_Array (1..10) := (others => 42);
   Array2 : Shared_Array renames Array1(1..5); 
```

后者我希望符合标准。第一个，受约束的形式......恕我直言，不确定。（但我会把它留给语言律师来验证这一点。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T02:53:47.680

如果您想使用具有不同标识符的相同内存，则可以使用访问类型。但是，这对下标映射没有任何作用。

```
procedure Array_Alias is
   type Shared_Array_Type is array (1 .. 10) of Integer;
   Array_1 : aliased Shared_Array_Type := (others => 0);
   Array_2 : access Shared_Array_Type := Array_1'Access;
begin

   Array_1(1 .. 3) := (1, 2, 3);
   Array_2(5 .. 8) := (others => -1);
   for Index in 1 .. 10 loop
      Text_IO.Put(Array_1(Index)'Img & " ");
   end loop;
   Text_IO.New_Line;

end Array_Alias; 
```

产生：

```
 1  2  3  0 -1 -1 -1 -1  0  0 
```

编辑：在 Ada2005 中添加了匿名访问类型。对于 Ada95，需要声明对数组类型的访问类型：

```
type Access_Shared_Array_Type is access all Shared_Array_Type;
Array_2 : Access_Shared_Array_Type := Array_1'Access; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T18:57:06.547

您明确要求的是别名。变量的别名往往会使我们这些可怜的人感到困惑，并可能导致一些非常微妙、难以发现的错误。它使您的代码容易出错并且处理起来压力很大。简而言之，混叠是邪恶的。

**在这种情况下，由于精心设计的语言的魔力，**它也是完全不必要的。**您所要做的就是将处理缓冲区的代码分成不同的例程，并且据这些例程所知，它们处理的数组仅与传递给它们的一样大。例如，我写了这段简短的代码：**

 **```
with Ada.Text_Io;

procedure Ada_Slice is

   type Integer_Array is array (Natural range <>) of Integer;
   Integer_Buffer : Integer_Array (1..10) := (1,2,3,4,5,6,7,8,9,10);

   procedure Magnify (Buffer : in out Integer_Array) is
   begin
      for I in Buffer'Range loop
         Buffer(I) := Buffer(I) * 10;
      end loop;
   end Magnify;

   procedure Swap (Front : in out Integer_Array;
                   Back : in out Integer_Array) is
      Scratch : Integer;
   begin
      for I in Front'Range loop
         Scratch := Front(I);
         Front(I) := Back(Back'First + (I - Front'First));
         Back(Back'First + (I - Front'First)) := Scratch;
      end loop;
   end Swap;

begin

   Magnify(Integer_Buffer(6..10));
   Swap (Integer_Buffer(1..2), Integer_Buffer(9..10));

   for I in Integer_Buffer'range loop
      Ada.Text_Io.Put (Integer'Image(Integer_Buffer(I)) & ",");
   end loop;
   Ada.Text_Io.New_Line;

end Ada_Slice; 
```

运行时，输出当然是：

> 90, 100, 3, 4, 5, 60, 70, 80, 1, 2,

（修正尾随逗号留给读者作为练习）**

# solr - Solr MultiValued 得分提升与基于数组的搜索

> ID：12810081
> 
> 赞同：0
> 
> 时间：2012-10-09T23:59:03.617
> 
> 标签：solr, lucene, multivalue

首先，我对 solr 还很陌生，而且我还不确定 solr 是解决这个问题的正确解决方案。我正在处理的文档已经在那里，如果 solr 可以解决它，那就太好了:)

我们在文档中的一个字段是字符串类型，并且将属性 multiValued 设置为 true。它包含与当前文档相关的 id 列表。

现在的任务是我知道有第二个 id 列表（相同的域），如果这些 id 中的任何一个匹配（如果有多个 id 匹配，那么我想要更高的分数），那么我想提高分数的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T08:54:44.367

如果您使用 dismax 或 edismax，请使用[Boost Query 。](http://wiki.apache.org/solr/ExtendedDisMax#bq_.28Boost_Query.29)

例如，`bq=id:1 OR id:2 OR id3`将提升至少具有 3 个 id 之一的文档。它还将为具有更多匹配 id 的文档提供更高的提升。

# django - Django + mod_wsgi：有人可以就我的设置和重写规则给我建议吗

> ID：12810082
> 
> 赞同：0
> 
> 时间：2012-10-09T23:59:10.233
> 
> 标签：django, apache, apache2, mod-wsgi, linode

这是我第一次将 Django 部署到最近收购的 Linode 服务器上，我很好奇是否有人可以查看我的部署并帮助我解决一些烦人的问题并建议我是否做错了事情。

## 目录结构

```
home\
    -public\
        -example.com\
            -public\
                -.htaccess
                -index.html
            -log\
            -application\
                -mysite\
                    -mysite\
                    -manage.py
                    -static\
                    -myapp\
                    -logs\ 
```

Django 的部署结构如何？

## 不正确的 URL 命名

我在我的域“example.com”上托管了名为“myapp”的 Django 应用程序。按照 Django 网站上的说明，我已经完成了应用程序的 urls.py 必须以“/myapp”开头。这导致应用程序的域变为“example.com/myapp”。

如何设置它以便 example.com 只是我编写的 Django 应用程序？我想简单地导航到 example.com，它会加载我的应用程序而不是 example.com/myapp。

更奇怪的是，我原以为 example.com 会加载我的 index.html 文件，但它却试图为 Django 查找 URL 映射......

## Django 日志文件写入权限

每当我通过 SSH 连接到我的机器上“syncdb”或“collectstatic”时，日志记录模块都会创建我在我的 settings.py 文件中命名的日志文件。这给我带来了问题，因为我是文件的所有者，而 apache2（www-data）无法写入它。在我重新启动 apache 服务器之前，必须在每个命令之后手动删除日志文件，这很烦人。

这是我的 /etc/apache2/sites-available/example.com 文件：

```
# domain: example.com
# public: /home/setheron/public/example.com/

WSGIPythonPath /home/setheron/public/example.com/applications/mysite:/home/setheron/env/lib/python2.7/site-packages

<VirtualHost *:80>
  # Admin email, Server Name (domain name), and any aliases
  ServerAdmin setheron@setheron.com
  ServerName  www.example.example.com
  ServerAlias example.com

  WSGIScriptAlias / /home/setheron/public/example.com/applications/mysite/mysite/wsgi.py

  Alias /static/ /home/setheron/public/example.com/applications/mysite/static/
  <Directory /home/setheron/public/example.com/applications/mysite/static/>
        Order deny,allow
        Allow from all
  </Directory>

  <Directory /home/setheron/public/example.com/applications/mysite/mysite>
  <Files wsgi.py>
        Order deny,allow
        Allow from all
  </Files>
  </Directory>

  # Index file and Document Root (where the public files are located)
  DirectoryIndex index.html index.php
  DocumentRoot /home/setheron/public/example.com/public

  # Log file locations
  LogLevel warn
  ErrorLog  /home/setheron/public/example.com/log/error.log
  CustomLog /home/setheron/public/example.com/log/access.log combined
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:42:35.793

如果您希望 Django 为整个站点提供服务，请摆脱您的公共目录、索引等。除了 /static，你应该只需要你的 WSGIScriptAlias 指令。修复 urls.py 以说明您的网站应该来自 /，而不是 /myapp。

# symfony - 生成pdf包

> ID：12810083
> 
> 赞同：-1
> 
> 时间：2012-10-09T23:59:11.863
> 
> 标签：symfony

我正在使用 bundle psliwa pdfbundle 并成功生成 pdf，但我不知道如何将 pdf 保存在服务器上并能够将生成的 pdf 的路径放入 mysql 数据库中。

谁来帮帮我？使用 Symfony2 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T07:06:30.893

在文档[https://github.com/psliwa/PHPPdf#parsing](https://github.com/psliwa/PHPPdf#parsing)中，您将找到如何向用户呈现广告输出 PDF。

这是由

```
//$documentXml and $stylesheetXml are strings contains XML documents, $stylesheetXml is optional
$content = $facade->render($documentXml, $stylesheetXml);

header('Content-Type: application/pdf');
echo $content; 
```

如果您想将 PDF 保存为文件系统上的文件，您只需要做

```
//$documentXml and $stylesheetXml are strings contains XML documents, $stylesheetXml is optional
$content = $facade->render($documentXml, $stylesheetXml);
$filename = '/path/to/the/file.pdf';
file_put_contents($filename, $content); 
```

您可以在[http://www.php.net/manual/en/function.file-put-contents.php](http://www.php.net/manual/en/function.file-put-contents.php)找到函数*file_get_contents的文档*

但是您的问题与捆绑包本身无关。这是一个关于如何在 PHP 中保存文件以及如何使用[Google等搜索引擎轻松找到的一般问题](http://www.google.de)

# c++ - 最大二分匹配 C++

> ID：12810085
> 
> 赞同：2
> 
> 时间：2012-10-10T00:00:01.187
> 
> 标签：c++, algorithm, graph, matching, bipartite

我正在用两个解决一个匹配`vectors`问题`class`

```
class matching
{
public:
    int n;
    char match;
}; 
```

这是我试图实现的算法：

```
int augment(vector<matching> &left, vector<matching> &right)
{
   while(there's no augmenting path)
     if(condition for matching)
        <augment>
  return "number of matching";
} 
```

对于粗略匹配，如果`left[i]`与 匹配`right[j]`，则`left[i].n = j`、`left[i].match ='M'`、`right[j].n = i`和`right[j].match = 'M'`不匹配的有成员`n = -1`和`match = 'U'`

在找到增广路径时，如果一个存在另一个（i，j），那么我们将`match`不匹配的成员从`'M'`to更改为，`'U'` 并且`n = -1` 与增广路径匹配的两个`match`在我们更改时将其成员更改为“A”他们的成员`n`根据他们的指数。

我不知道这是否是解决这个问题的正确方法，这是我第一次尝试最大匹配，我已经阅读了很多文章并在线观看了教程，但我无法让我的“代码”正常运行。

我不需要代码，我可以编写我的代码。我只是想一步一步地理解这个算法。如果有人能给我一个像我上面尝试过的算法，我将不胜感激。另外，如果从那以后我一直走错方向，请纠正我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T01:29:34.570

我不确定您是否正确找到了扩充路径。我建议采用以下方法。

1.  以贪婪的方式找到初始匹配。为了获得这一点，我们遍历左侧的每个顶点，并贪婪地尝试将其与右侧的一些空闲（未匹配）顶点匹配。

2.  尝试在图中找到一条增广路径 P。为此，我们需要从左侧的所有自由顶点开始进行广度优先搜索，并在搜索中交替通过匹配和不匹配的边。（即第二层包含与level-1顶点相邻的所有右侧顶点，第三层包含与level-2顶点匹配的所有左侧顶点，第四层包含与level-3相邻的所有右侧顶点顶点等）。当我们在任何未来级别访问一个自由顶点时，我们停止搜索，并使用到目前为止计算的广度优先搜索树计算增广路径 P。

3.  如果我们在上一步中可以找到一条增广路径 P： 将 P 中的匹配边和不匹配边分别更改为不匹配边和匹配边，然后转到步骤 2。

4.  Else：得到的结果匹配是最大的。

该算法需要对每个扩展进行广度优先搜索，因此它的最坏情况复杂度为`O(nm)`. 尽管[Hopcroft-Karp 算法](http://en.wikipedia.org/wiki/Hopcroft-Karp_algorithm)可以为每个广度优先搜索执行多次增强，并且具有更好的最坏情况复杂性，但它似乎（来自 Wikipedia 文章）在实践中并没有更快。

# c - 预处理器和常量传播后的 C 代码

> ID：12810091
> 
> 赞同：2
> 
> 时间：2012-10-10T00:00:32.133
> 
> 标签：c, gcc, constants, c-preprocessor

我想在经过预处理器**和**常量传播和简单的代码分析后得到**C代码。**这就是我的意思。

 **我使用 gcc 的`-E`选项在预处理器之后获取代码。然而，我得到的代码真的很难理解，一个简单的局部常量传播将使它更容易阅读。这是预处理器生成的仅一行**C**代码的示例。

```
(b1[0] = (kp + 1 * 4)[0] ^ 
( t_fn[0][(((( 0 == 0 ? ( 0 == 0 ? b0[0] : 0 == 1 ? b0[1] : 0 == 2 ? b0[2] : b0[3]) : 0 == 1 ? ( 0 == 0 ? b0[1] : 0 == 1 ? b0[2] : 0 == 2 ? b0[3] : b0[0]) : 0 == 2 ? ( 0 == 0 ? b0[2] : 0 == 1 ? b0[3] : 0 == 2 ? b0[0] : b0[1]) : ( 0 == 0 ? b0[3] : 0 == 1 ? b0[0] : 0 == 2 ? b0[1] : b0[2]))) >> (8 * ((0)))) & 0xff)] 
^ t_fn[1][(((( 1 == 0 ? ( 0 == 0 ? b0[0] : 0 == 1 ? b0[1] : 0 == 2 ? b0[2] : b0[3]) : 1 == 1 ? ( 0 == 0 ? b0[1] : 0 == 1 ? b0[2] : 0 == 2 ? b0[3] : b0[0]) : 1 == 2 ? ( 0 == 0 ? b0[2] : 0 == 1 ? b0[3] : 0 == 2 ? b0[0] : b0[1]) : ( 0 == 0 ? b0[3] : 0 == 1 ? b0[0] : 0 == 2 ? b0[1] : b0[2]))) >> (8 * ((1)))) & 0xff)] 
^ t_fn[2][(((( 2 == 0 ? ( 0 == 0 ? b0[0] : 0 == 1 ? b0[1] : 0 == 2 ? b0[2] : b0[3]) : 2 == 1 ? ( 0 == 0 ? b0[1] : 0 == 1 ? b0[2] : 0 == 2 ? b0[3] : b0[0]) : 2 == 2 ? ( 0 == 0 ? b0[2] : 0 == 1 ? b0[3] : 0 == 2 ? b0[0] : b0[1]) : ( 0 == 0 ? b0[3] : 0 == 1 ? b0[0] : 0 == 2 ? b0[1] : b0[2]))) >> (8 * ((2)))) & 0xff)] 
^ t_fn[3][(((( 3 == 0 ? ( 0 == 0 ? b0[0] : 0 == 1 ? b0[1] : 0 == 2 ? b0[2] : b0[3]) : 3 == 1 ? ( 0 == 0 ? b0[1] : 0 == 1 ? b0[2] : 0 == 2 ? b0[3] : b0[0]) : 3 == 2 ? ( 0 == 0 ? b0[2] : 0 == 1 ? b0[3] : 0 == 2 ? b0[0] : b0[1]) : ( 0 == 0 ? b0[3] : 0 == 1 ? b0[0] : 0 == 2 ? b0[1] : b0[2]))) >> (8 * ((3)))) & 0xff)])); 
```

像`0 == 0 ? X : Y`并且 `8*2`可以很容易地转换为更简单的形式。现在我的代码中有很多这样的行，这真是令人头疼。因此，如果我可以通过简单的局部常量传播和代码分析来获得更简单的**C代码，那该多好？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T00:07:51.960

我所知道的任何 C 编译器都无法做到这一点。常量传播通常发生在将内部表示转换回 C 已经太迟之后。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T00:08:20.003

为此，您需要一个基本上可以在源代码级别执行代码优化的工具。编译器在这里不会帮助您，因为编译器通常不会在源代码级别优化代码。任何代码转换通常发生在很久以后，当源代码不再相关并且真的没有办法回到它时。

换句话说，您需要专门设计的工具来解决您的问题。我不知道有任何这样的工具，我怀疑它是否存在。**

# facebook - Facebook 供稿对话框未打开

> ID：12810092
> 
> 赞同：1
> 
> 时间：2012-10-10T00:00:33.537
> 
> 标签：facebook, facebook-graph-api, facebook-javascript-sdk

我正在构建一个自定义多朋友选择器，以便根据本教程将帖子发送到 Facebook 上的朋友墙 [https://developers.facebook.com/docs/guides/games/custom-muti-friend-selector/](https://developers.facebook.com/docs/guides/games/custom-muti-friend-selector/)

我已经能够加载我的朋友列表并创建一个我想要发布的人的 CSV 列表，但是打开提要对话框的最后一步失败了，我不明白为什么。对话框未打开。

这是我的 sendRequest 函数

```
 var sendUIDs = '';
   $('.cbFriendId').each(function(index){
        if($(this).prop('checked') == true){
        var addId = $(this).attr('value');
        sendUIDs += addId + ',';
        }
    });
    console.log(sendUIDs);
    openSendDialog(sendUIDs);
    }

   function openSendDialog(sendUIDs){
   console.log('open send dialog');
   FB.ui({
       method: 'feed',
       to: sendUIDs,
       link: 'http://www.mydomain.com',
       display: 'iframe',
       message: 'Hello from My Domain',
       name: 'Click to view my app',
       caption: 'Hello my app'

   },
               function (response) {
                   if (response) {
                       alert('Post was published.');
                       console.log('Post was published.');
                   } else {
                       alert('Post was not published.');
                       console.log('Post was not published.');
                   }
               }
             );
 } 
```

最后一个控制台日志条目是“打开发送对话框”。我在 IE9 开发工具中没有收到任何错误，但我在 chrome 中确实收到了“不安全的 Javascript 尝试访问框架 ...”错误。

只是为了理智起见，这是我的图表初始化

```
window.fbAsyncInit = function () {
    FB.init({
        appId: '462750593765445', // App ID
        channelUrl: '//www.mydomain.com/channel.html', // Channel File
        status: true, // check login status
        cookie: true, // enable cookies to allow the server to access the session
        xfbml: true,  // parse XFBML
        frictionlessRequests: false 
    });
}; 
```

另外我应该提到该应用程序处于沙盒模式。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:41:40.257

你想要做的是调用`Send Dialog`，所以你需要将你的方法从`feed`to更改为`send`它应该可以工作。

查看他们的文档以获取更多信息：[https ://developers.facebook.com/docs/reference/dialogs/send/](https://developers.facebook.com/docs/reference/dialogs/send/)

# algorithm - 带有离开源节点的负边的 Dijkstra

> ID：12810093
> 
> 赞同：2
> 
> 时间：2012-10-10T00:00:35.557
> 
> 标签：algorithm, dijkstra

当图中的边具有负权重时，Dijkstra 算法会失败。但是，这个规则有一个例外：如果在有向无环图中只有离开源节点的边是负的（所有其他边都是正的），那么我们可以成功地使用 Dijkstra 算法。

现在我的问题是，如果在上述异常中，图表有一个循环怎么办？我相信 Dijkstra 行不通，但我想不出一个有循环的有向图的例子，唯一的负边是那些离开源节点的那些不与 Dijkstra 一起工作的。任何人都可以提出一个例子吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T00:17:25.460

In the scenario you describe, Dijkstra's algorithm will work just fine.

The reason why it fails in the general case with negative weight since it greedily chooses which node to "close" at each step, and a closed node is never reopened.

Now, assume the source `s` has `k` out edges, to `k` different nodes.
Let the order of them be `v_1, v_2, ..., v_k` (`v_1` being the smallest). Note that for each `v_i`, `v_j` such that `i < j` - there will be no path from `s` to `v_i` through `v_j` with a "better" cost then `v_i`, thus - the order of investigating these first nodes will never change. (and since it doesn't change, no way a later node will be entered to "closed" before the shortest path is indeed found).

Thus, at overall - no harm is done - once an edge is in the "closed" - you will never find a "shorter" path to it, since the negative edges are only from the source.

* * *

In here I assume the `source` in your question means `d_in(source)=0`, same as a "source" in a DAG.
If you mean out of the source vertex, it could be a problem since look at a 2 vertices graph such that `w(s,t) = -2, w(t,s)=1` - there is a negative cycle in the graph. So, in order to the above explanation to work - you must assume `d_in(s) = 0`

# bluej - 为什么我会收到此 Java 错误？

> ID：12810094
> 
> 赞同：0
> 
> 时间：2012-10-10T00:00:44.767
> 
> 标签：bluej

在第 3 行中，它显示“找不到符号 - 类 ArrayList”，并突出显示“ArrayList”一词。为了防止他的错误发生，我需要做什么？

任何答案将不胜感激。

请帮助

* * *

```
public class JobQueue
{
    private ArrayList<Job>myJob;
    private ArrayList<Job>myFinishedJobs;
    private int myJobDuration; 
    private int myTotalDuration;
    /**
     *
     */
     public JobQueue()
    {
      myJob = new ArrayList<Job>();
      myFinishedJobs = new ArrayList<Job>();
      myJobDuration =0; 
      myTotalDuration=0; 
    }

    /**
     * 
     */
     public ArrayList<Job> getPendingJobs()
     {
      return myJob;  
     }

    /**
     * 
     */
     public ArrayList<Job> getCometedJobs()
     {
      return myFinishedJobs;
     } 

    /**
     * 
     */
     public Job getCurrentJob()
     {
       if(myJob!=null)
       { 
        Job FirstJobInTheQueue = myJob.get(0);   
        return FirstJobInTheQueue;
       }
       else
       {
        return null; 
       }
     } 

    /**
     * 
     */
     public int getClockTime()
     {
       return myTotalDuration; 
     }

    /**
     * 
     */

     public int getTotalDuration()
     {
       int totalDuration = 0;
       for(int i = 0; i<myJob.size();i++)
       {
         totalDuration = totalDuration + myJobDuration;
       }
       return totalDuration;
     }

    /**
     * 
     */ 
     public void addJob(Job job)
     {   
        if(job!=null)
        {
          myJob.add(job);
        }
     }

    /**
      * 
      */
     public void addTime(int seconds)
     {
        if(seconds>0)
        {
          myTotalDuration = myTotalDuration + seconds;
        }
     }

    /**
      * 
      * 
      */
     public boolean runAJob()
      {

      } 

    /**
      * 
      */
    public void runAll()
     {

           }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:03:51.077

确保在顶部导入 ArrayList。

`import java.util.ArrayList;`

但是您还应该确保变量类型和变量名称之间有空格。

```
private ArrayList<Job> myJob; 
private ArrayList<Job> myFinishedJobs; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T20:59:06.350

您需要通过 import 语句访问 java 中的库类的第一行：

```
import java.util.ArrayList; 
```

这使得包中的`ArrayList`类`java.util`可用于我们的类定义。该`import`语句必须始终放在文件中的类定义之前。

# python - 通过实例方法操作实例本身

> ID：12810095
> 
> 赞同：2
> 
> 时间：2012-10-10T00:00:46.053
> 
> 标签：python, class, self

我想知道是否有类似的东西，比如：

```
>>> class A(object):
...     def swap(self):
...         self = 'I am swapped'
... 
>>> abc=A()
>>> abc
<__main__.A object at 0x028B6130>
>>> abc.swap
<bound method A.swap of <__main__.A object at 0x028B6130>>
>>> abc.swap()
>>> abc
<__main__.A object at 0x028B6130>
>>> type(abc)
<class '__main__.A'> 
```

看，它的类型不是str，而是A类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T00:03:26.343

你很困惑 - 通过使用来分配名称并没有什么特别之处

```
self = 'I am swapped' 
```

这只是将名称绑定`self`到字符串对象，它在此处充当*局部变量*。您根本没有改变父对象。

实际上，您尝试的内容并未在 Python 中使用，因为它是一种强类型语言。相反，您只需`swap`返回一个值，然后将相同的变量名重新分配给外部范围内的返回对象。

也许这更容易用代码解释，而不是：

```
a.swap() 
```

你将会拥有：

```
a = a.swap() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:12:47.697

`self`是一个约定。一个类的实例是在第一个参数中传递给它的函数的，你可以随意调用它，你可以对特定函数中的本地命名空间做任何你喜欢的事情。看：

```
>>> class A:
...     def f(hats):
...         print hats
... 
>>> a = A()
>>> a.f()
<__main__.A instance at 0x100466908> 
```

所以是的，您可以`self`在类方法中进行操作，但由于`self`它本身实际上并没有任何意义，因此没有任何意义。你应该（不）按照 Joran 的建议去做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:05:28.807

这是一个糟糕的主意......我不提倡这样做......事实上你应该不惜一切代价避免......看看使用工厂设计模式......

```
>>> class A:
...    def swap(self):
...      self.__class__ = B
...
>>> class B:
...   pass
...
>>> a = A()
>>> a.swap()
>>> a
<__main__.B instance at 0x02C43E18>
>>> 
```

# php - 获取 Flash 中的 URL 参数

> ID：12810098
> 
> 赞同：0
> 
> 时间：2012-10-10T00:01:32.153
> 
> 标签：php, html, flash

我有一个这样的网址

```
www.website.com?fname=Peter 
```

我在我的 Flash 电影中有一个`Dynamic Text`字段，`fnameurl`并且希望`Peter`在动态文本字段中显示，一旦它在浏览器上打开。如何获取 url 参数并将其显示在浏览器上？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:02:53.177

最直接的方法是使用[FlashVars](http://helpx.adobe.com/flash/kb/pass-variables-swfs-flashvars.html)参数。它是通过这样的 HTML`param`标记定义的：

```
<param name='flashvars' value='name=value&amp;name2=value2' /> 
```

该值必须格式化为 URL 查询字符串。各个键/值对将在 SWF 电影的根目录中提供。在 AS2 中，您可以使用以下命令简单地访问它们`_root`：

```
_root.name
_root.name2 
```

在 AS3 中，这些值可通过以下方式获得[`LoaderInfo.parameters`](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/LoaderInfo.html#parameters)：

```
root.loaderInfo.parameters.name
root.loaderInfo.parameters.name2 
```

长话短说，你可以在 PHP 中这样做：

```
<param name='flashvars' value='fname=<?php echo urlencode($_GET['fname']); ?>' /> 
```

然后在 AS 中：

```
fnameurl.text = _root.fname;

// or

fnameurl.text = root.loaderInfo.parameters.fname; 
```

# jquery-mobile - 空格键不会在 jquery-mobile 文本输入类型中产生空格

> ID：12810100
> 
> 赞同：0
> 
> 时间：2012-10-10T00:01:36.680
> 
> 标签：jquery-mobile

有没有人遇到过在 jquery-mobile 中使用文本输入类型时无法输入空格的问题

代码：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <script src="http://code.jquery.com/jquery-1.8.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0-beta.1/jquery.mobile-1.2.0-beta.1.min.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0-beta.1/jquery.mobile-1.2.0-beta.1.min.css"/>
    <link rel="stylesheet" type="text/css" href="mobile-css.css"/>
</head>
<body>
<div data-role="dialog" data-theme="d">
    <div data-role="header" data-theme="d"><h5 style="margin: 0.6em 10% 0.5em;">Comment</h5></div>
    <div id="" data-role="content" data-theme="d">
        <label for="txtComment">Your Comment:</label>
        <input type="text" id="txtComment" data-theme="d">
    </div>
    <div data-role="footer" data-theme="d">
        <a href="#" data-role="button" data-mini="true" data-inline="true" data-transition="fade"
           class="cancelButton" data-theme="c" data-rel="back">Cancel</a>
        <a href="#" data-role="button" id="btnSave" data-theme="d">Save</a>
    </div>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T04:32:02.543

试试这个简单的例子（在 iPhone 5 上测试），它使用目前最新版本的 jQuery Mobile（1.2.0），如果它有效，请告诉我：

```
<html>
<head>
    <meta name='viewport' content='minimum-scale=1.0, width=device-width, maximum-scale=1.0, user-scalable=no' />

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile.structure-1.2.0.min.css" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>   

</head>

<body>

    <div data-role="page">
        <div data-role="header" data-position="fixed">
            <h1>HEADER</h1>
        </div>

        <div data-role="content">
            <h1>my content</h1>
            <input type="text"/>
            <a data-role="button" href="#mydialog" data-rel="dialog">OPEN DIALOG</a>
        </div>

        <div data-role="footer" data-position="fixed">
            <h1>FOOTER</h1>
        </div>
    </div>

    <!-- YOUR DIALOG -->
    <div data-role="dialog" data-theme="d" id="mydialog">
        <div data-role="header" data-theme="d">
            <h5 style="margin: 0.6em 10% 0.5em;">Comment</h5>
        </div>
        <div id="" data-role="content" data-theme="d">
            <label for="txtComment">Your Comment:</label>
            <input type="text" id="txtComment" data-theme="d">
        </div>
        <div data-role="footer" data-theme="d">
            <a href="#" data-role="button" data-mini="true" data-inline="true" data-transition="fade"
                class="cancelButton" data-theme="c" data-rel="back">Cancel</a>
            <a href="#" data-role="button" id="btnSave" data-theme="d">Save</a>
        </div>
    </div>

</body>
</html> 
```

* * *

您应该得到以下信息：

![1](../Images/81ac4b447af6f28448b17e7932948062.png)

尝试在输入文本框中输入空格：

![2](../Images/c37ad094d6ddcbdc3f97e93cba93fd7f.png)

然后，单击按钮`OPEN DIALOG`，这将引导您进入对话框（您提供的代码），并尝试在对话框的输入文本框中输入空格：

![3](../Images/875997b66add7b640c94404a76019d2c.png)

我希望这对你有用。不管怎样，让我知道你的结果伙伴。

# database - Kohana 在视图内参数化执行查询

> ID：12810106
> 
> 赞同：0
> 
> 时间：2012-10-10T00:02:16.030
> 
> 标签：database, model-view-controller, kohana, prepared-statement

我只是想了解一下Kohana，所以如果我想错了，请告诉我！

我想在我的输出中对结果进行分组。我在 vanilla-PHP / PDO 中这样做的方式是准备一个查询，然后在输出结果中执行它。不过，我无法在 Kohana (3.2.2) 中到达那里。

在这种情况下，在我的“条款”页面上，我想按“类型”对“条款”进行分组，每组条款由“类型”标题分隔。

我的“条款”控制器是（简化的）：

```
class Controller_Terms extends Controller {

  public function action_index() 
  {
    $view = View::factory('terms');

    // types of term - for grouping terms together
    $sql = 'SELECT DISTINCT Type 
            FROM Term';
    $view->types = DB::query(Database::SELECT, $sql)->as_object()->execute();

    // list of terms - executed separately for each type
    $sql = 'SELECT TermId, Term
            FROM Term
            WHERE Type = :type';
    $view->terms = DB::query(Database::SELECT, $sql)->as_object();

    $this->response->body($view);
  }

} 
```

“条款”视图包括（简化）：

```
<? foreach ($types as $type): ?>
<h2><?= $type->Type ?></h2>
<? $params = array(':type' => $type->Type);
   $terms->parameters($params)->execute(); 
   foreach ($terms as $term): ?>
    <a href="term/<?= $term->TermId ?>"><?= $term->Term ?></a>
<? endforeach // term ?>
<? endforeach // type ?> 
```

我得到了“类型”标题，但我没有在每种类型中得到任何术语。

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T10:23:56.333

`execute()` [返回](http://kohanaframework.org/3.2/guide/database/query/prepared#executing)一个特殊的对象 ( `Database_Result`)，所以你需要这样的东西：

```
$items = $terms->parameters($params)->execute(); 
foreach ($items as $term): ?>
... 
```

# java - 如何只读取每行 Java 中的第二个单词

> ID：12810109
> 
> 赞同：0
> 
> 时间：2012-10-10T00:02:20.340
> 
> 标签：java, file, bufferedreader

到目前为止，我一直在逐行读取带有 BufferedReader 的文件，但是，现在我希望能够只存储该行上的第二个单词。我将我的行存储在哈希图中以便于查找。

```
 int i=0;

     HashMap<Integer, String> mapHash = new HashMap<Integer, String>();

    try {
        BufferedReader in = new BufferedReader(new FileReader("file"));
        String st;

        while ((st = in.readLine()) != null) {
            st = st.trim();
            //store the lexicon with position in the hashmap
            mapHash.put(i, st);
            i++;

        }
        in.close();
    } catch (IOException e) {
    } 
```

谁能帮助我只阅读每行的第二个单词？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:09:43.453

例如

```
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.HashMap;
import java.util.Map;
import java.util.StringTokenizer;

//...
try (BufferedReader in = new BufferedReader(new FileReader("file"));) {
        Map<Integer, String> mapHash = new HashMap<>();
        int i = 0;
        String st;

        while ((st = in.readLine()) != null) {
            st = st.trim();
            StringTokenizer tokenizer = new StringTokenizer(st);
            int j = 0;
            while (tokenizer.hasMoreTokens()) {
                if (j == 1) {
                    mapHash.put(i, tokenizer.nextToken());
                    break;
                } else {
                    tokenizer.nextToken();
                    j++;
                }
            }
            //store the lexicon with position in the hashmap
            i++;
        }
    } catch (IOException e) {
        throw new RuntimeException(e);
    } 
```

# javascript - addEventListener 到多个 ID

> ID：12810113
> 
> 赞同：1
> 
> 时间：2012-10-10T00:02:57.457
> 
> 标签：javascript, addeventlistener

无法使以下代码正常工作。直接调用 swapLevel() 可以正常工作，但是 addEventListener() 似乎没有做任何事情？

JavaScript：

```
<script>
function load() {
    var arr = document.getElementById('menu').getElementsByClassName('level');

    for (var i=0; i<arr.length; i++) {
        arr[i].addEventListener('click', function(){swapLevel(i);}, false);
    }
    // automatically open the first level
    swapLevel(0);
}
document.addEventListener('DOMContentLoaded', load, false);
</script> 
```

HTML：

```
<div id="menu"> 
<a href="#" class="level">Level One</a> 
<span class="hidden" id="0">
<p>Some options here</p> 
</span> 
<a href="#" class="level">Level Two</a> 
<span class="hidden" id="1">
<p>More options</p> 
</span> 
<a href="#" class="level">Level Three</a> 
<span class="hidden" id="2">
<p>Even more options</p> 
</span> 
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:06:13.533

您的索引不是您认为的那样，因为在`for`调用事件处理程序之前循环已经运行到完成，所以`i`在`arr.length`所有事件处理程序中都是如此。相反，您需要这样的东西来捕获闭包中的索引值，这样它就是您希望它在每个事件处理程序中的样子。函数调用创建了一个闭包，所以这个例子使用了一个自执行匿名函数来创建闭包：

```
function load() {
    var arr = document.getElementById('menu').getElementsByClassName('level');

    for (var i=0; i<arr.length; i++) {
        (function(index) {
           arr[i].addEventListener('click', function(){swapLevel(index);}, false);
        })(i);
    }
    // automatically open the first level
    swapLevel(0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:05:59.117

每个处理程序都需要引用一个单独的值来传递给`swapLevel`. 要为此目的使用变量范围，您需要调用一个函数，并在该函数内构建您的处理程序。

```
function makeHandler(i) {
    return function(){swapLevel(i);}
}

for (var i=0; i<arr.length; i++) {
    arr[i].addEventListener('click', makeHandler(i), false);
} 
```

* * *

另一种解决方案是简单地将属性直接放在元素上。

```
for (var i=0; i<arr.length; i++) {
    arr[i].__i__ = i
    arr[i].addEventListener('click', function(){swapLevel(this.__i__);}, false);
} 
```

这种技术实际上也可以让您重用处理程序。

```
function handleSwap() {
   swapLevel(this.__i__);
}

for (var i=0; i<arr.length; i++) {
    arr[i].__i__ = i
    arr[i].addEventListener('click', handleSwap, false);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:09:44.177

您需要在此处使用自评估闭包来捕获`i`循环每次迭代的值，否则您将获得`i`after control has left the for loop:的值`arr.length`。

```
var i;
for (i = 0; i < arr.length; ++i) {
    arr[i].addEventListener('click', function (i) {
        return function () { swapLevel(i); };
    }(i));
} 
```

# c# - 如何使用 interop.excel 将长数字写为文本

> ID：12810114
> 
> 赞同：1
> 
> 时间：2012-10-10T00:03:05.717
> 
> 标签：c#, excel

我正在使用`interop.excel`dll 并创建一个 Excel 文件。我在将长数字写为文本时遇到问题。

下面是我正在使用的代码。我可以使用撇号，但如果您查看公式栏中，您可以看到单元格已格式化。

有没有其他方法可以将长数字写入 Excel 电子表格，而不会看到公式栏中的格式化值（使用`numberformat`）？

```
worksheet.Cells[i, j] = "'" + dr[p];

//var startCell = (Excel.Range)worksheet.Cells[i, j]; 

//var endCell = (Excel.Range)worksheet.Cells[i, j]; 

//worksheetRange = worksheet.get_Range(startCell, endCell); 

//worksheetRange.NumberFormat = "#####"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:43:59.613

如果你想在一行中完成，你可以使用[Text 函数](http://office.microsoft.com/en-us/excel-help/text-function-HP010062580.aspx)。

例子：

```
worksheets.Cells[i, j] = "=Text(" + dr[p] + ", \"#\""; 
```

但这可能不是您要查找的内容，因为这会将数字存储为文本并在公式栏中显示公式。在这种情况下，就像 user194076 建议的那样，您可以使用`.NumberFormat = "@";` 或者`.NumberFormat = "#";`如果您不希望它以科学记数法显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-24T06:13:50.453

您可以使用带有 '@' 或 '#' 的 NumberFormat 示例：

```
Range r= worksheet.Cells;
r.NumberFormat = "@"; 
```

# html - 在shell脚本中对html进行排序

> ID：12810120
> 
> 赞同：0
> 
> 时间：2012-10-10T00:03:51.240
> 
> 标签：html, shell, sorting

我有一个里面有 html 代码的文件

![在此处输入图像描述](../Images/ba4d50abae7d0977f3d94ef61eb91140.png)

有没有办法按名称对内容进行排序？这样文件现在排序如下：

![在此处输入图像描述](../Images/65aafe19100f1205a06b58005fe6c975.png)

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:04:48.263

是的，只需运行以下命令：

```
sort -t '>' -k 3 filename 
```

我认为您想要的输出中有一个错误：*Chan*应该在*deLtorro*之前。

顺便说一句，你能告诉我们你最终想要达到什么目标吗？也许这不是更好的方法。

# ruby-on-rails - 使用 gagejs 和 rails 更新 SVG

> ID：12810121
> 
> 赞同：4
> 
> 时间：2012-10-10T00:04:00.350
> 
> 标签：ruby-on-rails, svg, raphael, justgage

我正在试验 Raphael、SVG 和 rails。我希望量具作为各种进度指示器动态更新，因为每个任务都通过完成按钮划掉。

诸如完成的任务/创建的总任务之类的东西。

附件是浏览器中的视图，下面是显示页面。

```
 <h1 class="page-header"> Getting it up</h1>
 <div class="well span9 offset2">
   <h2 class="page-header"><%= @list.name %></h2>
   <h2 class="lead"><%= @list.description %></h2>  
   <div class="pull-right" id="smallbuddy" style="width:340px; height:200px;"></div>

   <h3>Still Not Finished</h3>

   <ul>
     <% @list.tasks.incomplete.each do |task| %> 
     <li style="list-style:none"><%= task.description %> <%= button_to "Completed", complete_task_path(@list.id,task.id), :class =>"btn-mini" %></li>
     <% end %>
   </ul>
   <hr>
   <h3>Finished</h3>
   <ul id="completed">
     <% @list.tasks.completed.each do |task| %> 
     <li style="list-style:none; opacity:.5; text-decoration:line-through;"><em><%= task.description %></em></li>
     <% end %>
   </ul>

   <hr>
   <%= form_for [@list, @list.tasks.new] do |form| %>
   <p><%= form.text_field :description %><%= form.submit %></p>
   <% end %>
 </div>    

 <span class="btn affix"><%= link_to "Back to all Installs", lists_url %></span>
 <div>

 </div>

 <script>
   var g = new JustGage({
     id: "smallbuddy", 
     value: 27, 
     min: 0,
     max: 100,
     title: "Until Complete"
   }); 

 </script> 
```

![更清晰的量规](../Images/80bf8a8d729f366da422183e37c6318c.png) 我需要操纵 Raphael Lib 吗？还是 justgagejs 库？

我仍在努力解决它，但是一些资深的建议可以为我指出如何实现这一目标的正确方向会有所帮助。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T20:24:59.587

您需要您的 Rails 控制器来响应 JS 请求，请阅读以下内容：[在 Rails 中渲染 Javascript 问题时遇到](https://stackoverflow.com/questions/1344593/having-trouble-rendering-javascript-in-rails)问题。

这样您就可以在控制器返回的 JS 中更新您的仪表。

# javascript - transtionend/animationend 事件的特征检测？

> ID：12810123
> 
> 赞同：6
> 
> 时间：2012-10-10T00:04:40.157
> 
> 标签：javascript, css, dom-events, css-transitions, browser-feature-detection

我正在寻找一种更简洁的方法来检测`transitionend`. 我已经看到了很多例子，只是蛮力地将处理程序添加到所有变体中。另外，我不想依赖 jQuery（或类似的框架）。

我基本上是从这个列表开始并希望只绑定最合适的（即，列表中的第一个匹配）。

```
var transitionendName,
    events = [
        'transitionend',
        'webkitTransitionEnd',
        'MozTransitionEnd',
        'oTransitionEnd'
    ];

// ^^^^^ your code here

myElem.addEventListener(transitionendName, myHandler, false); 
```

有人觉得他们有一个干净的解决方案吗？相同的解决方案可能适用于`animationend`事件。

**编辑：** msTransitionEnd 和 '-ms-' 前缀属性[在最终的 IE10 候选版本之一中被删除](http://blogs.msdn.com/b/ie/archive/2012/06/06/moving-the-stable-web-forward-in-ie10-release-preview.aspx)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T00:39:59.790

您可以注册所有事件结束名称，然后触发一个非常短的 CSS 过渡，然后查看哪个会触发。另外，IE10 使用`transitionend`.，所以没有浏览器使用`msTransitionEnd`.

这是一个如何做到这一点的例子：http: [//jsfiddle.net/jfriend00/5Zv9m/](http://jsfiddle.net/jfriend00/5Zv9m/)

```
var transitionendName,
    events = [
        'transitionend',
        'webkitTransitionEnd',
        'MozTransitionEnd',
        'oTransitionEnd'
    ];

function findTransitionEnd(callback) {
    // add an off-screen element
    var elem = document.createElement("div");
    elem.id = "featureTester";
    document.body.appendChild(elem);

    // clean up temporary element when done
    function cleanup() {
        document.body.removeChild(elem);
        elem = null;
    }

    // set fallback timer in case transition doesn't trigger
    var timer = setTimeout(function() {
        if (!transitionendName) {
            cleanup();
            callback("");
        }
    }, 200);

    // register all transition end names
    for (var i = 0; i < events.length; i++) {
        (function(tname) {
            elem.addEventListener(tname, function() {
                if (!transitionendName) {
                    transitionendName = tname;
                    clearTimeout(timer);
                    cleanup();
                    callback(tname);
                }

            });
        })(events[i]);
    }

    // trigger transition
    setTimeout(function() {
        elem.className = "featureTestTransition";
    }, 1);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-10T16:14:54.913

另一种符合纯特征检测（而不是纯实用解决方案）但更有效的变体：

```
var transitionendNames = [
    'transitionend',
    'webkitTransitionEnd',
    'MozTransitionEnd',
    'oTransitionEnd'
];

/**
 * Helper function to bind to the correct transitionend event
 * @param {function} callback The function to call when the event fires
 */
var transitionend = function(elem, callback) {
    var handler = function(e) {
        //console.log('transitionend == '+e.type);

        // test in case multiple were registered before change
        if (transitionendNames) {
            // store the actual name
            var transitionendName = e.type;

            // every other time, bind only to actual event
            transitionend = function(elem, callback) {
                elem.addEventListener(transitionendName, callback, false);
            };

            // flag for any others
            transitionendNames = null;
        }
        return callback.call(elem, e);
    };

    // until an event has been triggered bind them all
    for (var i=0, len=transitionendNames.length; i<len; i++) {
        elem.addEventListener(transitionendNames[i], handler, false);
    }
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-08-19T13:46:22.563

我知道这是旧的，但我想补充一点：样式属性并不总是检测 animationend/transitionend 前缀的好方法。例如，一些 android 浏览器对转场不使用前缀，而对 JS 事件使用 webkitAnimationEnd。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T02:01:47.763

使用@jfriend00 的答案/示例可以更轻松地创建更轻量的检测。

```
// cssPrefix is any method which detects the property name
var transition = cssPrefix('transition');

var transitionend = {
    'transition': 'transitionend',
    'webkitTransition': 'webkitTransitionEnd',
    'MozTransition': 'transitionend',
    'OTransition': 'oTransitionEnd'
}[transition]; 
```

看看它在行动：http: [//jsfiddle.net/mckamey/qWPTg/](http://jsfiddle.net/mckamey/qWPTg/)

# c++ - boost 中是否有允许写入偏向锁定的功能？

> ID：12810127
> 
> 赞同：1
> 
> 时间：2012-10-10T00:04:55.667
> 
> 标签：c++, multithreading, boost

如果我有以下代码：

```
#include <boost/date_time.hpp>
#include <boost/thread.hpp>

boost::shared_mutex g_sharedMutex;

void reader()
{
    boost::shared_lock<boost::shared_mutex> lock(g_sharedMutex);
    boost::this_thread::sleep(boost::posix_time::seconds(10));
}

void makeReaders()
{
    while (1)
    {
        boost::thread ar(reader);
        boost::this_thread::sleep(boost::posix_time::seconds(3));
    }
}

boost::thread mr(makeReaders);
boost::this_thread::sleep(boost::posix_time::seconds(5));
boost::unique_lock<boost::shared_mutex> lock(g_sharedMutex);

... 
```

永远不会获得唯一锁，因为总会有读者。我想要一个 unique_lock ，当它开始等待时，它可以防止任何新的读锁获得对互斥锁的访问权（根据我的 wiki 搜索，称为偏写锁或写优先锁）。有没有一种简单的方法可以通过 boost 做到这一点？还是我需要自己写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T01:14:40.330

请注意，我不会评论 win32 的实现，因为它涉及更多，而且我没有时间详细介绍它。话虽如此，它的接口与 pthread 实现相同，这意味着以下答案应该同样有效。

自 v1.51.0 起， boost::shared_mutex 的 pthread 实现的相关部分：

```
void lock_shared()
{
    boost::this_thread::disable_interruption do_not_disturb;
    boost::mutex::scoped_lock lk(state_change);

    while(state.exclusive || state.exclusive_waiting_blocked)
    {
        shared_cond.wait(lk);
    }
    ++state.shared_count;
}

void lock()
{
    boost::this_thread::disable_interruption do_not_disturb;
    boost::mutex::scoped_lock lk(state_change);

    while(state.shared_count || state.exclusive)
    {
        state.exclusive_waiting_blocked=true;
        exclusive_cond.wait(lk);
    }
    state.exclusive=true;
} 
```

while 循环条件对您来说是最相关的部分。对于 lock_shared 函数（读锁），请注意只要有线程试图获取（`state.exclusive_waiting_blocked`）或已经拥有（`state.exclusive`）锁，while 循环将不会终止。这实质上意味着写锁优先于读锁。

对于锁函数（写锁），只要至少有一个线程当前拥有读锁（`state.shared_count`）或另一个线程拥有写锁（`state.exclusive`），while循环就不会终止。这基本上为您提供了通常的互斥保证。

至于死锁，只要保证一旦获得写锁就可以解锁，读锁总是会返回。至于写锁，只要读锁和写锁总是保证一旦获得就解锁就保证返回。

如果您想知道，`state_change`互斥锁用于确保没有对这些函数中的任何一个的并发调用。我不打算介绍解锁功能，因为它们涉及更多。随意查看它们，毕竟你有来源（`boost/thread/pthread/shared_mutex.hpp`）:)

All in all, this is pretty much a text book implementation and they've been extensively tested in a wide range of scenarios (`libs/thread/test/test_shared_mutex.cpp` and massive use across the industry). I wouldn't worry too much as long you use them idiomatically (no recursive locking and always lock using the RAII helpers). If you still don't trust the implementation, then you could write a randomized test that simulates whatever test case you're worried about and let it run overnight on hundreds of thread. That's usually a good way to tease out deadlocks.

Now why would you see that a read lock is acquired after a write lock is requested? Difficult to say without seeing the diagnostic code that you're using. Chances are that the read lock is acquired after your print statement (or whatever you're using) is completed and before state_change lock is acquired in the write thread.

# android - 如何区分 MotionEvent.ACTION_UP 和在 Android 中将手指拖出屏幕？

> ID：12810128
> 
> 赞同：2
> 
> 时间：2012-10-10T00:05:14.390
> 
> 标签：android, gesture, touchscreen, motionevent

我的应用程序是一个边到边的按钮网格。我正在覆盖所有触摸和运动事件并手动控制行为。一切正常，除了手指被拖出屏幕外。MotionEvent.ACTION_UP 被触发，我不希望这样。我尝试使用 getRawX() 和 getRawY() 来确定（例如，对于顶部和左侧边缘）坐标是否 < 1，但如果快速拖动手指，该值会更高（高达 20）。当 ACTION_UP 被触发时，位置值似乎有点滞后。有没有解决的办法？ACTION_CANCEL 似乎根本没有被触发。

```
@Override
public boolean onTouchEvent(MotionEvent event) {
    switch (event.getAction() & MotionEvent.ACTION_MASK) {
    case (MotionEvent.ACTION_DOWN):
        Log.i(classID, "action down");
        return true;
    case (MotionEvent.ACTION_CANCEL):
        Log.i(classID, "action cancel");
        // never called
        return true;
    case (MotionEvent.ACTION_MOVE):
        Log.i(classID, "action move");
        return true;
    case (MotionEvent.ACTION_UP):
        Log.i(classID, "action up");
        Log.i(classID, "position: " + (int)event.getRawX() + "/" + (int)event.getRawY());
        return true;
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:38:51.640

两者之间在物理上或逻辑上没有区别（手指从屏幕上掉下来并抬起手指）。当您的手指离开屏幕时，您已经“抬起”，或者更准确地说，是您的手指从屏幕上移开。MotionEvent.ACTION_UP 是任何导致没有触摸输入数据提供给系统的运动事件的占位符。

如果您希望解决此问题，您可以创建父视图和子视图。如果触摸从子视图“解除”但仍在父视图中，则手指仍在设备上但超出范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T22:35:01.337

他所说的手指从屏幕上*抬起和手指**滑出***视图**边界之间没有“物理差异”的说法是不正确的。

您可以通过在屏幕中间放置一个**SurfaceView**来证明这一点，并且在**OnTouch**事件回调中，有一个**IF**语句，例如：

```
if (event.getEvent() == MotionEvent.ACTION_UP) {
         Log.d("derp", "finger has lifted up");
} 
```

您会看到，如果您的手指只是超出了边界，它实际上并没有报告。虽然有一个**MotionEvent.ACTION_OUTSIDE**，但我似乎无法让它工作。因此，为什么我也在寻找这里。

# javascript - 带有 Internet Explorer 的 Fancybox Iframe 错误

> ID：12810132
> 
> 赞同：5
> 
> 时间：2012-10-10T00:05:54.243
> 
> 标签：javascript, jquery, html, css, fancybox

我遇到了 Internet Explorer 的错误。iframe 的大小不正确，它显示在页面的左上角而不是中心。

在 Firefox 和 Chrome 中，一切都运行良好。

尝试了很多东西，但我找不到解决方案:(

请帮我。

您可以在此处查看 IE8 中的错误：http: [//www.ni-dieu-ni-maitre.com/v2/index_v2.php](http://www.ni-dieu-ni-maitre.com/v2/index_v2.php) 点击左上角标有“iframe”的链接

这是它的截图：

![在此处输入图像描述](../Images/bd2acc81e2381ab46fd71778fd7dfcc3.png)

这是我的代码：

```
<head>
    <script type=\"text/javascript\" src=\"http://www.$domain/scripts/jquery-1.8.2.min.js\"></script>
    <script type=\"text/javascript\" src=\"http://www.$domain/scripts/jquery.fancybox.js?v=2.1.1\"></script>
    <link rel=\"stylesheet\" type=\"text/css\" href=\"http://www.$domain/scripts/jquery.fancybox.css?v=2.1.1\" media=\"screen\" />

    <script type=\"text/javascript\">
        $(document).ready(function() {
            $('.fancybox').fancybox();

            $('.fancybox').click(function() {
                $.fancybox.open({
                    href : 'iframe.html',
                    type : 'iframe',
                    padding : 5,
                    autoScale : false
                });
            });

    $(\".contactbox\").fancybox({

        openEffect : 'elastic',
        openSpeed  : 150,
        closeEffect : 'elastic',
        closeSpeed  : 150,
        closeClick : true,
        'overlayShow'    :    false,
        href : 'contact.php',
        type : 'iframe',
        padding : 5,
        autoScale : true,
        scrolling : 'no'
        frameWidth : 430,
        frameHeight : 380
    });

        });
    </script>

</head>
<body background=\"$background\" id=\"top\">

<a class=\"contactbox\" href=\"http://$domain/contact.php\">Iframe</a> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T00:21:33.537

Your page is rendered in quirks mode because you don't have a correct HTML DTD declaration.

![F12 screenshot](../Images/7d834c93313b616c23881c998c3a2335.png)

If you bring up IE dev toolbar (F12), you can see it renders correctly in standards modes.

# c++ - 在 C++ Visual Studio 中链接静态库

> ID：12810133
> 
> 赞同：2
> 
> 时间：2012-10-10T00:05:58.480
> 
> 标签：c++, visual-studio-2010, static-linking, dynamic-linking

有人可以帮我理解这个过程。

在 c++ 视觉工作室 2010 中

我有一个视觉工作室解决方案（让我们称之为 mysol）

我有一个作为静态库构建的项目（我们称之为 staticprj） staticprj 需要使用外部库（我们称之为 ext.lib）

在 staticprj 的源代码主体中，我使用#include extlib.h 包含外部库头文件并调用它的一些函数（让它们称为 extfunctions()），我还包括头文件位置的路径扩展库。

staticprj 编译好没有错误

mysol 还有另一个项目，它是一个动态库 (dynprj)，它依赖于 staticprj。

在 dynprj 的源文件中也使用来自外部库的函数。

我在 dynprj 的源代码中包含了#include extlib.h。我已经包含头文件的路径，我已将 extlib.h 直接附加到 dynprj 我还将 ext.lib 添加到链接器输入（以及 ext.lib 所在的路径）。

我仍然收到一个 lnk2001 错误，指出未找到 extfunctions()。

如果我根本不使用 ext.lib，整个结构（mysol 解决方案）可以编译。

我的问题是链接过程是如何工作的，我能做些什么来纠正这个链接错误。

（请注意，在没有 ext.lib 的情况下，我的 staticprj 和 dynprj 链接很好。我的编译工作正常，我的代码工作正常。当我尝试将另一个 ext.lib 链接到 staticprj 和 dynprj 并使用时，我只会收到链接错误ext.lib 中的函数）

提前致谢。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-10T00:15:36.567

I'm not quite sure it will work, but try putting the .dll inside your "mysol" debug folder. I had a similar problem couple of weeks ago when I had library compiled as .dll. I just placed that .dll within my debug folder and worked lovely.

# cakephp - CakePHP 中的自定义身份验证

> ID：12810144
> 
> 赞同：0
> 
> 时间：2012-10-10T00:07:12.067
> 
> 标签：cakephp

我创建了一个 CustomAuthenticate 类，如下所示，并将其放在 app/Controller/Component/Auth 下。我在 sqlite 数据库中有一个模型“用户”和相应的“用户”表。虽然我不想要表“用户”，但它不起作用。但是现在在表单上点击“登录”之后。它出现以下跟踪错误

```
2012-10-10 00:57:59 Error: [CakeException] Authentication adapter "Custom" was not found.
#0 C:\Program Files (x86)\Ampps\www\application1\lib\Cake\Controller\Component\AuthComponent.php(630): AuthComponent->constructAuthenticate()
#1 C:\Program Files (x86)\Ampps\www\application1\lib\Cake\Controller\Component\AuthComponent.php(510): AuthComponent->identify(Object(CakeRequest), Object(CakeResponse))
#2 C:\Program Files (x86)\Ampps\www\application1\app\Controller\UsersController.php(70): AuthComponent->login()
#3 [internal function]: UsersController->login()
#4 C:\Program Files (x86)\Ampps\www\application1\lib\Cake\Controller\Controller.php(485): ReflectionMethod->invokeArgs(Object(UsersController), Array)
#5 C:\Program Files (x86)\Ampps\www\application1\lib\Cake\Routing\Dispatcher.php(186): Controller->invokeAction(Object(CakeRequest))
#6 C:\Program Files (x86)\Ampps\www\application1\lib\Cake\Routing\Dispatcher.php(161): Dispatcher->_invoke(Object(UsersController), Object(CakeRequest), Object(CakeResponse))
#7 C:\Program Files (x86)\Ampps\www\application1\app\webroot\index.php(92): Dispatcher->dispatch(Object(CakeRequest), Object(CakeResponse))
#8 {main} 
```

AppController 在组件数组中有以下内容。

```
public $components = array(
        'Session',          
        'Auth' => array(
            'loginRedirect' => array('controller' => 'ananlyze', 'action' => 'index'),
            'logoutRedirect' => array('controller' => 'users', 'action' => 'login', 'home'),
            'authenticate' => array('Custom','Form')
        )
    ); 
```

感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T07:45:31.203

你有调用`App::uses('CustomAuthenticate', 'Controller/Component/Auth');`AppController 吗？

# c++ - 简单的 VBO 不显示

> ID：12810150
> 
> 赞同：0
> 
> 时间：2012-10-10T00:08:10.957
> 
> 标签：c++, opengl, vbo

我正在使用一个顶点，其中三个浮点数作为位置（XYZ），另外三个浮点数作为颜色（RGB）：

XYZ RGB XYZ RGB ...

我目前正在尝试绘制一个红色三角形。不幸的是，我最终得到了一个白色的窗口。我认为步幅有问题，但我无法弄清楚。我已经尝试了许多关于步幅和大小的值，但它似乎仍然没有显示任何内容。

```
//main.cpp
#include "data.h"
GLuint ID;
int size,el_size;

void init(){
vector<float>data_vector(18);

data_vector[0]=0; //x
data_vector[1]=0; //y
data_vector[2]=0; //z
data_vector[3]=1;
data_vector[4]=0;
data_vector[5]=0;
data_vector[6]=1; //x
data_vector[7]=0; //y
data_vector[8]=0; //z
data_vector[9]=1;
data_vector[10]=0;
data_vector[11]=0;
data_vector[12]=0; //x
data_vector[13]=1; //y
data_vector[14]=0; //z
data_vector[15]=1;
data_vector[16]=0;
data_vector[17]=0;

size=data_vector.size();

// Init GLEW
if ( glewInit() != GLEW_OK ){
    cerr << "Failed to initialize GLEW." << endl;
    exit(-1);
}   

if ( !glewIsSupported("GL_VERSION_1_5") && !glewIsSupported( "GL_ARB_vertex_buffer_object" ) ){
    cerr << "ARB_vertex_buffer_object not supported!" << endl;
    exit(-2);
}
glOrtho(-1, 1,1,-1, -5.0f, 5.0f);

glClearColor(1.0f, 1.0f, 1.0f, 0.0f);
glShadeModel(GL_SMOOTH);
glEnableClientState(GL_VERTEX_ARRAY);
glGenBuffers(1,&ID);
glBindBuffer(GL_ARRAY_BUFFER, ID);
glBufferData(GL_ARRAY_BUFFER,size*sizeof(float), &data_vector[0], GL_STATIC_DRAW);

el_size=3*sizeof(data_vector[0]);
}

void reshape(int w, int h){
cout<<"reshape"<<endl;
glViewport(0,0, (GLsizei) w, (GLsizei) h);
glMatrixMode(GL_PROJECTION);
glLoadIdentity();
gluOrtho2D(0.0f, (GLdouble) w, 0.0f, (GLdouble) h);
}

void display(){

cout<<"display"<<endl;
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

glBindBuffer(GL_ARRAY_BUFFER, ID);
glEnableClientState(GL_VERTEX_ARRAY);
glVertexPointer(3, GL_FLOAT, el_size, 0);

glEnableClientState(GL_COLOR_ARRAY);
glColorPointer(3,GL_FLOAT, el_size,(void*)(el_size));

glDrawArrays(GL_TRIANGLES,0,size/6);

glFlush();  
}

int main(int argc, char **argv){
cout<<"main"<<endl;
glutInit(&argc,argv);
glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);
glutInitWindowSize(500,500);
glutInitWindowPosition(300,300);
glutCreateWindow(argv[0]);
init();
glutDisplayFunc(display);
 // glutReshapeFunc(reshape);
glutMainLoop();

return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:16:18.413

您似乎使用了不正确的步幅。步幅应该是从一个顶点的起点到下一个顶点的起点的距离，或者在您的情况下为 6 个浮点数。

您已将步幅设置为`el_size`，它只有 3 个浮点数。

还要注意你的 resize 函数使用的是从 0 到屏幕宽度的正交矩阵，并且你的 init 函数将它设置为从 -1 到 1。如果 resize 被调用，你的场景将变得完全不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:18:49.763

我看到的一个问题是`glOrtho`init 函数中的调用。无论您打算做什么，这肯定不会做您想要的。作为一般规则，所有与绘图状态相关的命令只放在显示功能中，别处。应该在那里设置转换矩阵（和视口）。这样做可以在以后省去很多麻烦。

另一个问题是，您定义的步幅太短。步幅是交错数组中顶点到顶点的距离，而不是单个属性的长度。`el_size`计算错误。

# spring - Spring会话处理：未收到HttpSessionDestroyedEvent

> ID：12810153
> 
> 赞同：9
> 
> 时间：2012-10-10T00:08:39.180
> 
> 标签：spring, session, web-applications

我有一个网络应用程序，其中`web.xml`我添加了`HttpSessionEventPublisher`作为侦听器。Web 应用程序在 Jetty 7.x 上运行，我们使用的是 Spring 3.1.1。

这应该触发`HttpSessionCreatedEvent`和`HttpSessionDestroyedEvent`Spring 上下文事件侦听器。

我有一个`@Controller`实现`ApplicationListener<ApplicationEvent>`. 是和`ApplicationEvent`的公共父类。当我现在登录到我的 Web 应用程序或从中注销时，我希望这些事件会被触发到该方法。我收到了其他事件，比如一些请求处理事件，但预期的事件没有出现。我已经稍微跟踪了应用程序，肯定会触发事件到上下文，但没有接近侦听器。我在这里想念什么？`HttpSessionCreatedEvent``HttpSessionDestroyedEvent``onApplicationEvent(ApplicationEvent event)``HttpSessionEventPublisher`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T00:36:02.407

问题是`HttpSessionEventPublisher`根据 javadoc 在“Spring Root WebApplicationContext”上发布事件，这是通过`ContextLoaderListener`web.xml 文件中的条目注册的应用程序上下文。另一方面，您的 @Controller 可能完全是通过不同的应用程序上下文注册的——通过 DispatcherServlet 注册的应用程序上下文。所以我建议你创建一个不同的ApplicationListener，将它注册到Root WebapplicationContext，然后事件应该会通过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-11T08:45:36.967

面对类似的问题，如果无法将 ApplicationListener 移动到根上下文，则可以使用 org.springframework.security.context.DelegatingApplicationListener。

只需在您的 Bean 中自动装配一个 DelegatingApplicationListener 并使用构造函数/@PostConstruct 将您的侦听器注册到 DelegatingApplicationListener（spring-security 应该已经到位）

# javascript - 更改 Raphael“标签”的背景颜色

> ID：12810164
> 
> 赞同：3
> 
> 时间：2012-10-10T00:10:23.250
> 
> 标签：javascript, raphael, graphael

如果我使用 Raphael 创建一个[`Label`](http://g.raphaeljs.com/reference.html#Element.label)，默认样式是带有白色文本的黑色块。

如何更改背景框颜色，而不是文本颜色？我试过了：

```
paper.label(x, y, value).attr("fill", colour) 
```

但这也填充了文本，我最终得到了不可见的文本。

我也不能简单地更改[此函数](https://github.com/DmitryBaranovskiy/g.raphael/blob/master/g.raphael.js#L328)中的默认颜色，因为我需要有几个不同的颜色，具体取决于它添加到的行：

![在此处输入图像描述](../Images/19564c5ae7dcbdca30056185088d4a0e.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-19T02:12:22.180

正如你所注意到的，

```
Paper.label(x, y, value).attr(
    fill : color
); 
```

更改背景填充颜色和文本填充颜色，导致文本不可见。

Unspecified 正确解释了这是一个数组，因此每个部分都必须单独更改，如图所示。但是，他们没有提到更改更新两组属性的最简单方法，所以我想分享这个技巧。为此，请将属性更改为具有两组的数组。第一个元素是背景，第二个是文本。

```
Paper.label(x, y, value).attr([{
    fill : backgroundColor
}, {
    fill : textColor
}]); 
```

您可以为每个部分添加任何其他适用的属性。这是一个工作示例：http: [//jsfiddle.net/VzpeG/1/](http://jsfiddle.net/VzpeG/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:18:53.203

I was working on a graph similar to this and used:

> .attr({fill: "#EF7C4D"})

Let me know how this goes...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T06:00:39.963

```
var r = Raphael('divID', 320, 220);
text = r.text(100,100,"Hello").attr({fill:"#fff"});​​​​
text.label().attr({fill:"#f00"}); 
```

这是一个工作小提琴[http://jsfiddle.net/vpGyL/216/](http://jsfiddle.net/vpGyL/216/)

在文本或标签上设置任何颜色都单独应用......希望这会有所帮助！

进一步挖掘......`Paper.label(x,y,text)`不同于`Element.label()`

如果您查看源代码`Paper.Label(x,y,text)`是一组矩形元素和文本元素，那么这样做`.attr({fill:"SomeColor"})`适用于整个集合，因此矩形和文本共享相同的颜色（因此不可见）。

哦，是的，如果您只想更改文本颜色，请执行此操作，`Raphael.g.txtattr.fill = "#yourColorCode"`但这会在所有图表和工具提示上全局更改文本颜色（似乎不是一个好主意）。

虽然`Element.Label`正如文档所说，采用上下文元素并嵌入标签工具提示中，但基本上无论`element`您使用什么，应用`.label`都会将其嵌入到矩形中

# javascript - JQueryUI如何“自我”关闭对话框

> ID：12810165
> 
> 赞同：1
> 
> 时间：2012-10-10T00:10:23.787
> 
> 标签：javascript, jquery, jquery-ui

我正在开发一个使用 jQueryUI 并创建大量对话框的 Web 应用程序。对话框都是不同的，关闭对话框的按钮最终会嵌入几个 div 到对话框中。

我想要一个总是关闭包含对话框的函数。

以下面的 html 为例：

```
<div id="demoDialog">
   <div>
      <div id='demoDialogSubmit'>
         <input type='submit' onClick='selfCloseDialog();' value='Ok' style='margin-top:10px' />
      </div>
   <div>
<div> 
```

在我的 js 代码中的某处，我将其初始化为一个对话框：

```
$( "#demoDialog" ).dialog( params ); 
```

现在对于点击我有一些不太好的选择。我可以坚持关闭按钮知道对话框的ID。例如，做类似的事情：

```
onclick="$( '#demoDialog' ).dialog( 'close' );" 
```

但我宁愿拥有通用代码，而不是总是随身携带对话框的 id，这样我就可以将它发送到可能关闭它的小部件。

或者我可以记住我下降了多少层：

```
function selfCloseDialog() { $(this).parent().dialog( 'close' ); } 
```

但我真的希望 selfCloseDialog() 只搜索元素层以寻找要关闭的对话框对象。我该怎么做呢？

@更新：

所以我让它工作了。感谢大家的建议，这个问题实际上有两个问题。

第一个问题在这里：

```
<input type='submit' onClick='selfCloseDialog();' value='Ok'/> 
```

它应该是：

```
<input type='submit' onClick='selfCloseDialog(this);' value='Ok'/> 
```

按钮元素不会作为函数的“this”参数传入。现在看起来很明显。

下面的直接方法 JAAulde 有效并且看起来最干净：

```
function selfCloseDialog( caller ) {
   $(caller).closest( ".ui-dialog-content" ).dialog('close');
} 
```

有几个答案涉及最接近和选择器 - 但除了他建议的普通类选择器之外，我看不出有任何理由使用任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:15:27.040

When making your dialog, include a close button:

```
var params = {
    //whatever you already had in there
    buttons: {
        // In the buttons object, the "key" will be the button text, the function
        // will be executed on click of the button in scope of the dialoged element
        Close: function () {
            $(this).dialog('close');
        }
    }
};

$( "#demoDialog" ).dialog( params ); 
```

And from code running in scope of ANY descendant element of the dialoged element, run:

```
$(this).closest('.ui-dialog-content').dialog('close'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:17:40.307

Not sure if I'm exactly understanding what you're asking, but it seems the easiest way would be to add a standard class to all your dialogs, and then have code like:

```
$(this).closest('.dialog-class').dialog('close'); 
```

closest() is defined here:

[http://api.jquery.com/closest/](http://api.jquery.com/closest/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T00:18:47.430

*updated to reflect the ajax part of the dialog. *updated to reflect comments

```
<div id="soemthing.random.ui.dialog.makes">
.... your content....
<a class='custom-close' href="#Close">Custom Close</a>
.... 
</div>

$(function(){
  $("your selector").dialog();
  var selector = ":ui-dialog";
//developers choice.  ".ui-dialog-content" is faster, ":ui-dialog" is guaranteed
  $(selector ).on({
   "click":function(event){
     event.preventDefault();
     $(this).closest(selector).dialog("close");
   }
  },"a.custom-close",null);

}) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T00:37:55.853

我建议使用类而不是编写内联函数调用，但这取决于你。

这是我的带有事件委托的 hackish 解决方案，其中单击带有`selfclose`类的元素将关闭祖先对话框：

```
$(document).on('click', '.selfclose', function() {
    $(this).parents().each(function() {
        try {
            $(this).dialog('close');
        } catch(e) {}
    });
}); 
```

[**小提琴**](http://jsfiddle.net/bAzab/2/)

但正如 DefyGravity 提到的，使用`:ui-dialog`选择器是一个更清洁的解决方案：

```
$(document).on('click', '.selfclose', function() {
    $(this).closest(":ui-dialog").dialog("close");
}); 
```

[**小提琴**](http://jsfiddle.net/bAzab/4/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-10T00:30:31.847

检查这个：http: [//jsfiddle.net/Wqh4Y/3/](http://jsfiddle.net/Wqh4Y/3/)

```
function closeParentDialog(closeButton)
{
closeButton.parents('.ui-dialog').eq(0).find('a.ui-dialog-titlebar-close').eq(0).click();

}

$(function() {

    $( "#dialog" ).dialog();

});​ 
```

你可以像这样使用它：

```
 <div id="dialog" title="Basic dialog">
        <p>This is the default dialog which is useful for displaying information. The dialog   window can be moved, resized and closed with the 'x' icon.

          <span> <a class="close-dialog" onclick="closeParentDialog($(this))">selfclose</a>  </span>
        </p>
     </div> 
```

# php - 一个 reddit-php-sdk 方法不输出任何东西

> ID：12810166
> 
> 赞同：2
> 
> 时间：2012-10-10T00:10:25.523
> 
> 标签：php, reddit

我正在尝试学习 reddit 代码并使用此[https://github.com/jcleblanc/reddit-php-sdk](https://github.com/jcleblanc/reddit-php-sdk)

这个库中有一个总是`$reddit->getUser()`输出的方法。`null`其他一切似乎都在工作。

```
include_once("jcleblanc-reddit-php-sdk-4a4cc32/reddit.php");
$reddit = new reddit("my-username", "my-password");
$userData = $reddit->getUser();
var_dump($userData); 
```

输出`null`。

```
$response = $reddit->getListing("all", 5);
var_dump($response); 
```

输出预期的就好了。那么可能出了什么问题`$reddit->getUser()`呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T04:57:29.780

这是 Jonathan LeBlanc，我创建了那个库。我现在正在运行测试，我似乎没有看到同样的问题。这是我在库中运行的代码：

```
<?php
require_once("reddit.php");

$reddit = new reddit("USERNAME", "PASSWORD");
var_dump($reddit->getUser());
?> 
```

运行它时，我看到我的用户数据对象通过了。你还在遇到这个问题吗？

*   乔恩

# python - Python 和新实例

> ID：12810168
> 
> 赞同：1
> 
> 时间：2012-10-10T00:10:38.350
> 
> 标签：python

虽然我熟悉其他编程语言，但我很难理解我在 python 中的代码以及为什么当我重新分配类时我的类属性没有被重置......例如。我在通知类中有一个方法

```
def send(self):
    for service in self.hosts:
      # func = getattr(self, service)
      for host in self.hosts[service]:
        try:
          if service == 'xbmc':
            self.xbmc(host)
          elif service == 'growl':
            self.growl(host)
          elif service == 'prowl':
            self.prowl(host)
        except:
          print "Cound't connect " + host.find('ip').text + " For " + service 
```

如您所见，这将遍历每个服务（所以请记住，我有 3 个 xbmc）

所以以xbmc为例，方法是

```
def xbmc(self, host):
  x = Xbmc(host)
  x.notify(self.title, self.message) 
```

在其他语言下，如果我再次分配 x，这将是一个全新的对象，但 python 似乎不是这种情况......

我将从我的 xbmc 课程中放置片段来解释这个问题。

```
class Xbmc:
  hosts = []
  def __init__(self, host = None):
    self.setHosts(host)
    self.server = Hosts().getHostsByService('xbmcserver')

  def setHosts(self, host = None):
     ...alot of elif...
     elif type(host).__name__ == 'Element': # this code is the one that is in effect from my notify class
       self.hosts.append(host)
     ...more elif...
     print self.hosts # for debugging 
```

现在代码就在那里，当我启动通知发送时。输出显示：

```
[<Element 'host' at 0x7fdda19d0d10>]
XBMC 192.168.1.10 Failed To Connect
[<Element 'host' at 0x7fdda19d0d10>, <Element 'host' at 0x7fdda1955090>]
XBMC 192.168.1.10 Failed To Connect
XBMC 192.168.1.20 Failed To Connect
[<Element 'host' at 0x7fdda19d0d10>, <Element 'host' at 0x7fdda1955090>, <Element 'host' at 0x7fdda19553d0>]
XBMC 192.168.1.10 Failed To Connect
XBMC 192.168.1.20 Failed To Connect
XBMC 192.168.1.21 Failed To Connect 
```

很明显，当我附加主机时，它实际上从来没有一个新实例，但总是附加到已经存在的东西......我假设 x = Class() 会启动一个新实例？如果我做

```
self.hosts = [host] 
```

那么显然我没有得到不希望的效果，但是知道为什么我的初始方法不起作用或如何克服它也会很好。我们需要重置方法吗？或者实际上有没有办法从一个类中创建一个新实例？还是我的代码有问题？谢谢....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:15:24.103

## Problem

The problem is caused, because the class property `hosts` is mutable (list), so appending to it will influence every instance.

## Solution

The solution is to change the class property into instance property:

```
class Xbmc:
    # <--- (no more "hosts" here)
    def __init__(self, host = None):
        self.hosts = []  # <--- we are initializing "hosts" property here now
        self.setHosts(host)
        self.server = Hosts().getHostsByService('xbmcserver')
    # and so on... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:17:11.513

```
class Xbmc:
  hosts = []
  def __init__(self, host = None):
    self.setHosts(host)
    self.server = Hosts().getHostsByService('xbmcserver') 
```

Should be

```
class Xbmc:
  def __init__(self, host = None):
    self.hosts = []
    self.setHosts(host)
    self.server = Hosts().getHostsByService('xbmcserver') 
```

The first version creates a list shared between all Xbmc instances. The second creates a list for each one.

# django - S3 不向 Django heroku 应用程序提供媒体文件

> ID：12810170
> 
> 赞同：3
> 
> 时间：2012-10-10T00:11:01.097
> 
> 标签：django, heroku, amazon-s3, django-storage

晚安伙计们，我正在尝试在 Heroku 上使用 django 设置一个应用程序，使用 S3 作为我的 javascript 和样式表的服务器。在一些帖子之后，我在 S3 上配置了一个存储桶，并将我的环境变量配置到 heroku 中。然后在我的设置文件中我有这样的东西

```
DEFAULT_FILE_STORAGE = 'storages.backends.s3boto.S3BotoStorage'

INSTALLED_APPS = (
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.sites',
    'django.contrib.messages',
    'django.contrib.staticfiles',        
    # Uncomment the next line to enable the admin:
    'django.contrib.admin',
    # Uncomment the next line to enable admin documentation:
    # 'django.contrib.admindocs',
    'apuh',
    'storages',
)

AWS_QUERYSTRING_AUTH = False
AWS_ACCESS_KEY_ID = os.environ.get('AWS_ACCESS_KEY_ID')
AWS_SECRET_ACCESS_KEY = os.environ.get('AWS_SECRET_ACCESS_KEY')
AWS_STORAGE_BUCKET_NAME = 'mybucket' 
```

STATIC_URL = 'https://s3.amazonaws.com/%s/' % AWS_STORAGE_BUCKET_NAME ADMIN_MEDIA_PREFIX = '/static/admin/'

当我运行我的应用程序时，它会因以下错误而崩溃：

```
Error: No module named storages 
```

我用 pip install django_storages 安装了 django_storages。它安装在我的环境中。如果我评论“存储”行，它不会从存储桶中加载任何文件，我猜该请求不会发送用于身份验证的属性令牌。

所以，我的问题是，我做错了什么。我已经检查了问题和问题，但看起来我错过了一些大事。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T07:30:21.777

也许添加这些会有所帮助？

```
STATICFILES_STORAGE = 'storages.backends.s3boto.S3BotoStorage'
DEFAULT_FILE_STORAGE = 'storages.backends.s3boto.S3BotoStorage'

STATIC_URL = 'http://' + AWS_STORAGE_BUCKET_NAME + '.s3.amazonaws.com/'
ADMIN_MEDIA_PREFIX = STATIC_URL + 'admin/' 
```

是的，也安装[了 boto](http://pypi.python.org/pypi/boto)

然后运行 ​​pip freeze > requirements.txt 以确保您的所有依赖项都是最新的

我希望它有帮助

# javafx-2 - 如何实现一个真正自定义的事件处理程序，可以处理 JavaFX 中的任何 EventType？

> ID：12810185
> 
> 赞同：2
> 
> 时间：2012-10-10T00:13:52.680
> 
> 标签：javafx-2, javafx

我计划创建一个 EventHandler 类，它将为我的 JavaFX 类中的所有控件处理所有类型的事件。

例如，我添加了我的自定义事件处理程序类以通过以下方式处理动作事件，它工作正常：

```
userNameText.addEventHandler(ActionEvent.ACTION, new DataChangeHandler());
cmbBox.addEventHandler(ActionEvent.ACTION, new DataChangeHandler());
btn.addEventHandler(ActionEvent.ACTION, new DataChangeHandler()); 
```

这是我的客户事件处理程序类代码：

```
public class DataChangeHandler implements EventHandler<ActionEvent> {    
    public void handle(ActionEvent event) {
            System.out.println("My Very Own Private Button Handler");
        }               
} 
```

但是，当我尝试将其中一个 addEventHandlers 更改为 MouseEvent 并通过以下方式修改主 EventHandler 类时，它会显示错误“接口事件处理程序不能通过不同的争论多次实现”：

```
userNameText.addEventHandler(ActionEvent.ACTION, new DataChangeHandler());
cmbBox.addEventHandler(MouseEvent.CLICKED, new DataChangeHandler());
btn.addEventHandler(ActionEvent.ACTION, new DataChangeHandler());

public class DataChangeHandler implements EventHandler<ActionEvent>, EventHandler<MouseEvent> {    
    public void handle(ActionEvent event) {
            System.out.println("My Very Own Private Button Handler - ACTIONEVENT");
        }

        @Override
    public void handle(MouseEvent arg0) {
        System.out.println("My Very Own Private Button Handler - MOUSEEVENT");

    }
} 
```

有没有其他方法可以实现这一目标？请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T07:36:11.380

尝试这个

```
public class DataChangeHandler implements EventHandler<Event>{
    @Override
    public void handle(Event event) {
        System.out.println("My Very Own Private Handler For All Kind Of Events");
    }
} 
```

# php - PHP简写/简码条件IF语句：执行代码或返回消息

> ID：12810187
> 
> 赞同：0
> 
> 时间：2012-10-10T00:13:54.923
> 
> 标签：php, shortcode

我`foreach`在 if 语句中有一个循环。我的代码是速记格式。如果条件返回，我不希望`foreach`循环执行，而是回显一条消息“对不起，数据库为空！”`if``true`

# 功能代码

```
<?php if (!$check == 0) : ?>
    <?php foreach... ?>
       ...
    <?php endforeach; ?>
<?php endif; ?>
<?php if ($check == 0) echo 'Sorry database is empty!'; ?> 
```

我不喜欢这段代码的地方是我有两个不同的`if`条件。当然它可以正常工作，但我更愿意`else`在第一个`if`.

1.  我想做的正确语法是什么？

或者，如果您的答案是这样的：

```
$var_is_greater_than_two = ($var > 2 ? true : false); // returns true 
```

解释这将如何阻止`foreach`执行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:16:43.047

只需使用其他：

```
<?php if ($check !== 0) : ?>
    <?php foreach... ?>
       ...
    <?php endforeach; ?>
<?php else: echo 'Sorry database is empty!'; ?>
<?php endif; ?> 
```

你也可以缩短这个：

```
$var_is_greater_than_two = ($var > 2 ? true : false); // returns true 
```

仅此：

```
$var_is_greater_than_two = ($var > 2); // returns true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:18:12.637

为什么不给 if 添加一个 else 呢？代码块看起来像特殊渲染，类似于 Zenf 框架视图脚本。除非特殊语法不允许 else，否则您应该可以这样做。

```
<?php if (!$check == 0) : ?>
   <?php foreach... ?>
   ...
  <?php endforeach; ?>
<?php else :  ?>
      Sorry database is empty!
<?php endif; ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:20:47.150

想法可能是将 foreach 循环提取到另一种方法。另一个文件或同一个文件有你的 executeLoop 方法：

```
<?php 
   function executeLoop()
   {
     foreach(..)
     {
       //do something
     }
  }
?>
enter code here 
```

几行代码之后，您可以：

```
<?php (condition)?executeLoop() : echo $something;?> 
```

好消息是，如果您以后愿意，您可以重用您的代码。

# java - Java：对类型的引用？

> ID：12810191
> 
> 赞同：1
> 
> 时间：2012-10-10T00:14:11.963
> 
> 标签：java, oop, metaprogramming

我需要根据条件实例化两种不同类型之一的对象。两种类型的构造函数都采用相同的参数，并且都是主类型的子类。我可以在条件内定义对正确类型的引用，然后使用该引用实例化对象吗？快速示例：

```
if (v == "bob") {
   Object myType = bobType;
} else {
   Object myType = otherType;
}
SuperType instance = new myType(arg1, arg2); 
```

这不起作用；在java中有正确的语法吗？这是这样做的捷径：

```
if (v == "bob") {
   SuperType instance = new bobType(arg1, arg2);
} else {
   SuperType instance = new otherType(arg1, arg2);
} 
```

我实际上正在制作几个实例，它们都是相同类型的，它们都需要一长串参数，并且我想避免完全重复自己，除了类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T00:17:14.173

可以，但必须使用反射 API。有什么原因你不能这样写：

```
SuperType instance;
if (v == "bob") {
   instance = new bobType(arg1, arg2);
} else {
   instance = new otherType(arg1, arg2);
} 
```

否则你想要的是使用Class类型来获取对构造函数的引用，然后你可以直接调用构造函数：

```
 SuperType instance;
  Class<? extends SuperType> clazz;
  Constructor<? extends SuperType> constructor;
  if ("bob".equals(v)) {

       clazz = bobType.class;
    } else {
       clazz = otherType.class;
    }
  //subbing in types of arg1 and arg2 of course
  constructor = class.getConstructor(String.class, String.class);
  instance = constructor.newInstance(arg1, arg2); 
```

因此，如果您的目标只是简洁，那么它并没有那么冗长，而且反射会引发您需要处理的各种检查异常。如果您在编译时知道所有可能的类型，那么实际上并没有太大的优势。如果您不知道所有类型并且正在按名称从其他库中查找类，它会变得很有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T00:23:34.500

可以为此使用反射，但在大多数情况下，定义工厂会更惯用。例如，

```
interface MyFactory {
  SuperType newInstance(Foo arg1, Bar arg2);
}

class BobFactory implements MyFactory {
  public BobType newInstance(Foo arg1, Bar arg2) {
    return new BobType(arg1, arg2);
  }
}

class OtherFactory implements MyFactory {
  public OtherType newInstance(Foo arg1, Bar arg2) {
    return new OtherType(arg1, arg2);
  }
}

void myMethod() {
  MyFactory factory;
  if (v == "bob") {
    factory = new BobFactory();
  } else {
    factory = new OtherFactory();
  }
  SuperType instance = factory.newInstance(arg1, arg2);
} 
```

这比你想象的更冗长，但它的好处是，如果你改变`BobType`or的构造函数`OtherType`，编译器会捕捉到你需要更新这段代码，而不是在运行时崩溃。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T00:17:35.963

在java中它有点复杂，你需要使用类名创建一个实例。看看这个问题：[使用类名和调用构造函数创建实例](https://stackoverflow.com/questions/6094575/creating-an-instance-using-the-class-name-and-calling-constructor)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T00:34:22.250

你的代码：

```
if (v == "bob") {
   Object myType = bobType;
} else {
   Object myType = otherType;
}
SuperType instance = new myType(arg1, arg2); 
```

据我了解，您想要的是根据条件实例化不同的类型。

您可以选择声明一个变量以使其范围超过 if-else 条件（最好，我们将其称为选项＃1）和创建一个工厂构造函数以便您实例化正确的类型（不太可能需要，看起来像一个矫枉过正，选项＃2）。

选项1：

简单地打破声明：

```
// declare "instance" so it exists inside if-else AND after condition
SuperType instance; 
if (v == "bob") {
   // instantiate "instance"
   instance = new bobType(arg1, arg2);
} else {
   // instantiate "instance"
   instance = new otherType(arg1, arg2);
}
// "instance" is now instantiated 
```

选项#2：

背景： [http ://en.wikipedia.org/wiki/Factory_method_pattern](http://en.wikipedia.org/wiki/Factory_method_pattern)

基本上你所做的是创建一个接口来构造 SuperType 类型。显然，两个类（bobType 和 otherType）都应该实现它——这样您就可以立即实例化该对象。这不会让您摆脱在代码中可访问的“工厂”，如果它不是重复操作，则选项 #1 更可取。

# ios - iOS 在图像视图中交叉淡化多个图像

> ID：12810195
> 
> 赞同：2
> 
> 时间：2012-10-10T00:14:47.920
> 
> 标签：ios, animation, uiimageview

我有 9 张图像需要交叉淡入淡出。我试图用imageview的animationImages方法做动画。但不幸的是，它不支持图像之间的交叉淡入淡出效果。谁能告诉我如何实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T00:24:55.147

我通常使用 Core Animation，具体来说`CABasicAnimation`，

我最近使用了这个，一个带有几个手势识别器的图像视图，用于左右滑动。查看我正在使用的褪色动画：

```
_someImageView = [[UIImageView alloc] initWithFrame:myFrame];
_someImageView.image = [myArrayOfImages objectAtIndex:0];
[self.view addSubview:_someImageView];
[_someImageView release];

_currentImageIndex = 0;

_someImageView.userInteractionEnabled = YES;

UISwipeGestureRecognizer *swipeLeftGesture = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(changeImage:)];
swipeLeftGesture.direction = UISwipeGestureRecognizerDirectionLeft;
[_someImageView addGestureRecognizer:swipeLeftGesture];
[swipeLeftGesture release];

UISwipeGestureRecognizer *swipeRightGesture = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(changeImage:)];
swipeRightGesture.direction = UISwipeGestureRecognizerDirectionRight;
[_someImageView addGestureRecognizer:swipeRightGesture];
[swipeRightGesture release]; 
```

然后每次我滑动时都会调用它，或者如果你更喜欢基于时间做一些事情，那么让你的计时器调用它，只要确保你增加一个计数器，以便你可以循环图像：

```
- (void)changeImage:(UISwipeGestureRecognizer *)swipe{

    NSArray *images = [myArrayOfImages images];
    NSInteger nextImageInteger = _currentImageIndex;

    if(swipe.direction == UISwipeGestureRecognizerDirectionLeft)
        nextImageInteger++;
    else
        nextImageInteger--;

    if(nextImageInteger < 0)
        nextImageInteger = images.count -1;
    else if(nextImageInteger > images.count - 1)
        nextImageInteger = 0;

    _currentImageIndex = nextImageInteger;

    UIImage *target = [images objectAtIndex:_currentImageIndex];

    CABasicAnimation *crossFade = [CABasicAnimation animationWithKeyPath:@"contents"];
    crossFade.duration      = 0.5;
    crossFade.fromValue     = _someImageView.image;
    crossFade.toValue       = target;
    [_someImageView.layer addAnimation:crossFade forKey:@"animateContents"];
    _someImageView.image = target;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:16:20.377

只需创建两个图像视图并将它们放在另一个之上。当您想要交叉淡入淡出到下一张图像时，只需将底部图像视图的图像设置为您想要淡入淡出的图像*，*并将顶部图像视图的 alpha 设置为 0。冲洗并重复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-30T04:57:03.357

```
- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view from its nib.
UIImage *img=[UIImage imageNamed:@"images.jpeg"];
imgview=[[UIImageView alloc]init];
imgview.frame=CGRectMake(30,90, img.size.width, img.size.height);
[self.view addSubview:imgview];
[self animateImages];
}
- (void)animateImages
{
static int count = 0;
NSArray *animationImages = @[[UIImage imageNamed:@"images.jpeg"], [UIImage imageNamed:@"images (1).jpeg"]];
UIImage *image = [animationImages objectAtIndex:(count % [animationImages count])];

[UIView transitionWithView:imgview
                  duration:2.0f // animation duration
                   options:UIViewAnimationOptionTransitionCrossDissolve
                animations:^{
                    imgview.image = image;
                } completion:^(BOOL finished) {
                    [self animateImages];
                    count++;
                }];
} 
```

# c++ - c++ 如何从 .dat 文件构建二维字符串矩阵？5 列 x 行

> ID：12810206
> 
> 赞同：4
> 
> 时间：2012-10-10T00:16:29.000
> 
> 标签：c++, arrays, string, vector, matrix

我需要阅读如下所示的 .dat 文件：

```
Atask1 Atask2 Atask3 Atask4 Atask5
Btask1 Btask2 Btask3 Btask4 Btask5
Ctask1 Ctask2 Ctask3 Ctask4 Ctask5
Dtask1 Dtask2 Dtask3 Dtask4 Dtask5 
```

我需要能够输出这样的信息：

```
cout << line(3) << endl; // required output shown below
>>Ctask1 Ctask2 Ctask3 Ctask4 Ctask5

cout << line(2)(4) << endl; // required output shown below
>>Btask4 
```

我不知道如何读取 1 行并将其拆分为 5 个不同字符串的数组。理想情况下，我希望将整个 .dat 文件转换为向量或列表或某种矩阵/数组结构以便于参考

任何简单的代码或解决方案？

请帮忙？！？！？！？:-)

编辑：

```
vector<string> dutyVec[5];

dut1.open(dutyFILE);

if( !dut1.is_open() ){
    cout << "Can't open file " << dutyFILE << endl;
    exit(1);
}

    if(dut1.eof()){
    cout << "Empty file - no duties" << endl;
            exit(1);
    }

while ( !dut1.eof()){
    int count = 0;
    getline(dut1, dutyVec[count]);
    count++;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T01:49:54.270

您的问题解决了许多问题，我将尝试一口气回答所有这些问题。所以，原谅这篇文章的长度。

```
#include <iostream>
#include <sstream>
#include <string>
#include <vector>
#include <fstream>

int main(int argc, char argv[]){
  std::vector <std::string> v;//just a temporary string vector to store each line

  std::ifstream ifile;
  ifile.open("C://sample.txt");//this is the location of your text file (windows)

  //check to see that the file was opened correctly
  if(ifile.is_open()) { 
    //while the end of file character has not been read, do the following:
    while(!ifile.eof()) {
      std::string temp;//just a temporary string
      getline(ifile, temp);//this gets all the text up to the newline character
      v.push_back(temp);//add the line to the temporary string vector
    }
    ifile.close();//close the file
  }

  //this is the vector that will contain all the tokens that
  //can be accessed via tokens[line-number][[position-number]
  std::vector < std::vector<std::string> > tokens(v.size());//initialize it to be the size of the temporary string vector

  //iterate over the tokens vector and fill it with data
  for (int i=0; i<v.size(); i++) {
    //tokenize the string here:
    //by using an input stringstream
    //see here: http://stackoverflow.com/questions/5167625/splitting-a-c-stdstring-using-tokens-e-g
    std::istringstream f(v[i].c_str());

    std::string temp;

    while(std::getline(f, temp, ' ')) {
      tokens[i].push_back(temp);//now tokens is completely filled with all the information from the file
    }
  }
  //at this point, the tokens vector has been filled with the information
  //now you can actually use it like you wanted:
  //tokens[line-number][[position-number]

  //let's test it below:

  //let's see that the information is correct
  for (int i=0; i<tokens.size(); i++) {
    for(int j=0; j<tokens[i].size(); j++) {
      std::cout << tokens[i][j] << ' ';
    }
    std::cout << std::endl;
  }

  system("pause");//only true if you use windows. (shudder)
  return 0;
} 
```

请注意，我没有使用迭代器，这在这里会很有用。但是，我认为你可以自己尝试。

# python - 尝试在 python 中使用 HTTP POST 请求进行 POST

> ID：12810210
> 
> 赞同：1
> 
> 时间：2012-10-10T00:16:52.447
> 
> 标签：python, http-post, httpconnection

我正在尝试使用 HTTP POST-request 将两个参数发布到[http://foo.bar.com/submit.jsp](http://foo.bar.com/submit.jsp)。

这行得通。

```
conn = httplib.HTTPConnection("www.bar.com")
conn.request("POST", "",parameters) 
```

但这不是，有人可以向我解释为什么它没有以及正确的方法是什么？

```
conn = httplib.HTTPConnection("www.foo.bar.com")
conn.request("POST", "/submit.jsp", parameters) 
```

我收到此错误

```
File "example.py", line 68, in <module>
    conn.request("POST", "/submit.jsp", parameters)
  File "/usr/lib/python2.7/httplib.py", line 958, in request
    self._send_request(method, url, body, headers)
  File "/usr/lib/python2.7/httplib.py", line 992, in _send_request
    self.endheaders(body)
  File "/usr/lib/python2.7/httplib.py", line 954, in endheaders
    self._send_output(message_body)
  File "/usr/lib/python2.7/httplib.py", line 814, in _send_output
    self.send(msg)
  File "/usr/lib/python2.7/httplib.py", line 776, in send
    self.connect()
  File "/usr/lib/python2.7/httplib.py", line 757, in connect
    self.timeout, self.source_address)
  File "/usr/lib/python2.7/socket.py", line 553, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
socket.gaierror: [Errno -2] Name or service not known 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:34:32.683

无论您真正使用的是什么主机名，`www.foo.bar.com`都无法解析为 IP 地址。请注意，您的第一个示例使用了`www.bar.com`，而不是`www.foo.bar.com`. 虽然这些只是示例，但您使用的第二个主机名是错误的。

路径`/submit.jsp`不是这里的问题，如果那是你真正想要测试的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:23:31.273

此错误意味着 python 无法访问您在函数中定义的 HTTP 服务器，您可能有一个不需要的“HTTP://”，一个错字的 url，如果您使用的是 IPV6，它可能是您的地址或其他形式网络问题。

这可能会有所帮助；

[使用 conn = httplib.HTTPConnection ("http://ipaddr:port") 时出错](https://stackoverflow.com/questions/11836748/error-while-using-conn-httplib-httpconnection-http-ipaddrport)

# java - 布尔和 for 循环 JAVA

> ID：12810224
> 
> 赞同：0
> 
> 时间：2012-10-10T00:18:54.700
> 
> 标签：java

```
int a=25: 
for (double i=1;i<=a;i++) 
{
    int b=5*i; 
    boolean value= b==a; 
    System.out.println(value);
 } 
```

此方法在 i=5 时为真，否则为假。所以值可以在 i=5 时为真，但我的程序会为我打印：假-假-假-假-真-假-假-假...我怎样才能让这个程序为我只打印真。PS：我知道 false 或 false 或 TRUE 或 false = True .. 但我如何在 for 循环中使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T00:21:54.570

也许这个？

```
int a=25; 
for (double i=1;i<=a;i++) { 
    int b = 5 * (int)i;  // you must cast "i" in order for this to compile 
    boolean value = b == a;  // you probably wanted "b == a" not "b == i" 
    if (value)
        System.out.println("true");
} 
```

`"true"`即我们仅在`value`is时打印`true`。

* * *

`value`要在变为时停止循环`true`，我们可以使用以下`break`语句：

```
int a=25; 
for (double i=1;i<=a;i++) { 
    int b = 5 * (int)i;
    boolean value = b == a; 
    if (value) {
        System.out.println("true");
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:23:22.337

像这样：

```
int a=25,b: 
boolean value;
for (double i=1;i<=a;i++) { 
    b=5*i; 
    value = (b==i); 
    if (value) {
        System.out.println(value);
    }
} 
```

也永远不要担心在循环体内声明变量，因为它们在每次迭代中都会重新声明——这是不好的做法。

编辑：大声笑，这段代码总是打印错误，因为它不能打印真实

```
 b=5*i; 
```

并且 5*i 永远不等于 i

编辑^2：

正如 CodeGuru 建议的那样，使用 a==i 它只打印一次 true ：

```
int a=25,b;
boolean value;
for (double i=1;i<=a;i++)     {
    b=5*(int)i; 
    value= i==a; 
    if (value) {
        System.out.println(value);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:23:26.260

一种方法类似于添加数字列表。您需要一个累加器，它是一个保存迄今为止结果的变量。在循环之前声明：

```
boolean value = false; 
```

现在在循环内部，使用`|=`运算符：

```
value |= (b == i); 
```

然而，这似乎是一个丑陋的解决方案。`true`当你找到它时，你将如何处理它？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-03T09:12:34.233

```
 int a = 25;
    for (double i = 1; i <= a; i++) {
        double b = 5 * i;
        if (b == a) {
            boolean value = b == a;
            System.out.println(value);
        }
    } 
```

这将起作用

# html - 覆盖为 HTML 标签设置的 CSS 样式

> ID：12810227
> 
> 赞同：3
> 
> 时间：2012-10-10T00:19:18.193
> 
> 标签：html, css

我的页面正在引用具有定义的 CSS 样式表：

```
html {background-color:#FFFFFF;background-image:url('../images/Background.png');background-repeat:repeat-x; } 
```

如何`background-image`在页面级别覆盖元素？我只需要在我的应用程序中覆盖一页的设置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T00:22:22.100

向 html 元素添加一个类，然后使用一些内联样式来覆盖外部样式表的样式。您还可以将内联样式放在外部样式表中，这是最佳实践。

```
<html class="myHtmlTag">
   <head>
     <link href="externalStyle.css" rel="stylesheet"/>
    <style>
     html.myHtmlTag{
       background: none !important;
       background-image:none !important;
     }
    </style>
   </head>
   <body></body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:43:01.533

如果您只定位`html`标签而没有任何其他选择器，那么您可以简单地`html`在主 css 之后包含另一种样式。根据 CSS 的特殊性——它们每个只有 1 个标签的值（没有 id，没有类）——所以后者将为元素设置样式。

```
<html>
<head>

<link rel="stylesheet" href="main.css" /> 

<!-- anywhere from here down you can include a style to over ride html --> 
```

这是一个快速演示：

```
html {background-color:#000;background-image:url('http://lxmpro.com/cms/wp-content/uploads/2012/01/site-background-pattern-07.jpeg');background-repeat:repeat-x; }

/*  second reference to html tag overrides the first */
html {background-image:url('http://www.noupe.com/wp-content/uploads/2009/10/wallpaper-pattern.jpg');} 
```

工作演示 - [http://jsfiddle.net/K68D3/](http://jsfiddle.net/K68D3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:22:06.503

在样式上使用`!important`属性，如下所示：`background` `background-image`

```
html{background-color:#000000 !important;background-image:url('your/image/path') !important;...} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T00:27:46.330

您可以将类应用于body标签吗？IE：

```
<body class="home"> 
<body class="articlepage"> 
```

否则，您在技术上可以使用 jQuery，假设您可以访问页面上的代码以执行该功能但被锁定

```
<script>$("body").addClass("home");</script> 
```

- - 或者 - - -

```
<script>$("body").addClass("articlepage");</script> 
```

这些允许您上课：

```
body.home {background-image:url(homebg.jpg);}
body.articlepage {background-image:url(articlebg.jpg);} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-29T19:31:04.987

类背景颜色的基本内联样式覆盖：

```
<!DOCTYPE html>
<html>
<head>
<style>
.city {
    background-color: orange;
    color: white;
    padding: 10px;
}
</style>
</head>

<body>

<h2 class="city" style="background-color: tomato;">London</h2>
<p>London is the capital of England.</p>

</body>
</html> 
```

# c++ - 与构造函数参数相关的异常安全的成语

> ID：12810228
> 
> 赞同：3
> 
> 时间：2012-10-10T00:19:36.940
> 
> 标签：c++, exception-safety

我一直在查看我正在处理的一些代码，我们有这样的等价物：

```
AutoPtr<A> x;
...
/// x gets initialized
...
B* y = new B(x.Detach()); 
```

其中 AutoPtr 是我们的 auto_ptr 版本，而 Detach() 返回拥有的指针并重置自身。此外，B() 拥有 x 的所有权。

现在，我意识到如果 new 抛出 std::bad_alloc 会泄漏 x，所以我将代码更改为：

```
AutoPtr<A> x;
...
/// x gets initialized
...
B* y = new B(x.Get());
x.Detach(); 
```

但后来我意识到，如果 B() '拥有'指针，并且在其构造过程中发生异常，它应该负责删除参数本身（或者应该删除？），所以 x 将被删除两次，一次被 B ()，并且一次由 x 的析构函数。

现在，是否有解决此问题的 C++ 习惯用法，例如，编写调用负责清理参数的构造函数的代码？我见过的大多数代码似乎都没有这样做......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T00:26:06.333

显而易见的解决方案似乎是将临时传递`AutoPtr<A>`给 的构造函数`B`：

```
AutoPtr<B> y(new B(AutoPtr<A>(x)); 
```

`B*`（这也为返回的 from增加了资源控制`new B()`）。

`B`的构造函数只会调用`x.Detach()`初始化它需要用`A*`. 如果任何时候发生异常，`AutoPtr<A>`都会释放该对象。

如果要在发生异常时保留`A`管理的对象`x`，可以将 a 传递`AutoPtr<A>&`给构造函数`B`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T00:28:50.283

> ...它应该注意删除参数本身（或者应该删除？）

不，不应该。

`B`在构造函数完成之前不存在，如果它不存在，则不应声称拥有任何东西（在某种程度上；如果构造函数本身做了某事，那也需要是安全的）。

C++ 习惯用法是不使用原始指针来表示所有权（包括 for `y`）！`B`应该接受`AutoPtr`作为参数，以便调用者可以通过这种方式放弃所有权。这是`std::unique_ptr`and的目标`std::move`：

```
std::unique_ptr<A> x;

std::unique_ptr<B> y(new B(std::move(x))); 
```

另请注意，真的`new`不应该这样使用；而是使用`make_*`实用程序：

```
auto y = std::make_unique<B>(std::move(x)); 
```

但这目前作为疏忽而缺失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:29:28.833

像这样的东西，可能是：

```
B* y = new B();
y->Attach(x.Detach()); 
```

或者

```
B* y = new B();
(*y) = x; 
```

# jquery - animate from an auto start height to an unknown height?

> ID：12810232
> 
> 赞同：0
> 
> 时间：2012-10-10T00:20:25.700
> 
> 标签：jquery

I can try to throw this in a fiddle if necessary, it's just fairly convoluted code at the moment. Here is my problem: I have a child div that gets resized because of some dynamic image and text content, and a container parent that gives a nice border around the whole thing. The parent has an auto height (or no height?) so it flows with the child height. The problem is that when I change the child height, I am fading the content out and then back in, so the effective height is 12px (some borders going on). The parent resizes to 12, and then when the child content fades back in, the parent goes to the correct position. It just looks choppy, because you see this process unfolding in the span of 100ms or so. Is there any way to animate this process? I guess ideally I'm looking for something like

content.startAnimation and endAnimation, in which you don't have to specify values.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T19:07:41.107

所以我想出了一个解决方案。基本上，由于我的#content div 是浮动的，我可以在其中放置一个#ghostWrapper div，它的高度可能比其父级（#content）更大。我的#ghostWrapper 当然是不可见的。我从这个 onClick 开始：

```
// set content height on load
var contentHeight = $("#content").css("height");
$("#content").css("height", contentHeight); 
```

然后，一旦#ghostWrapper 中的内容自动调整了它的高度，我将#content 的高度设置为等于#ghostWrapper

```
// get ghostWrapper height and set content to it
var ghostHeight = $("#ghostWrapper").css("height");
$("#content").css("height", ghostHeight); 
```

在 CSS 中，我将高度作为 0.2 秒的过渡，因此可以无缝调整。希望这可以帮助其他人在未来遇到同样的问题。

# java - Binary to decimal conversion

> ID：12810237
> 
> 赞同：0
> 
> 时间：2012-10-10T00:21:02.133
> 
> 标签：java, binary, decimal

I am a novice programmer trying to write a program that converts an entered Binary number into a decimal number. As far as I can tell, the math and code are right, and no compilation errors are returned, however the number that is output is NOT the correct decimal number. My code is as follows:

```
 String num;
  double result = 0;
  do {
  Scanner in = new Scanner(System.in);
  System.out.println("Please enter a binary number or enter 'quit' to quit: ");
  num = in.nextLine();
  int l = num.length();
  if (num.indexOf("0")==-1 || num.indexOf("1")==-1 ){
    System.out.println("You did not enter a binary number.");
  }

  for (int i = 0; i < l; i++)
{ 
  result = result + (num.charAt(i) * Math.pow(2, (l - i)));
}
System.out.println("The resulting decimal number is: " +result);
  } while (!num.equals("quit"));

  if (num.equals("quit")){
    System.out.println("You chose to exit the program.");
    return;
  } 
```

Any Help you could give would be much appreciated. I tried making my question as clear as possible but if you have any questions I will try to answer the best I can. I have not been doing this long. All I need is for someone to look it over and hopefully find the error I made somewhere, thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:28:09.457

改变

```
result = result + (num.charAt(i) * Math.pow(2, (l - i))); 
```

至

```
result = result + ((num.charAt(i) - '0') * Math.pow(2, i)); 
```

或更紧凑，

```
result += (num.charAt(i) - '0') * Math.pow(2, i); 
```

* * *

请记住，字符`'0'`与数字`0`不同（`'1'`和相同`1`）；`num.charAt(i)`返回字符而不是整数。

* * *

```
int a = '0';
int b = 0;
System.out.println(Math.pow(2, a));
System.out.println(Math.pow(2, b)); 
```

输出：

> 2.81474976710656E14
> 1.0

差别不大吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:28:30.863

该函数`String.charAt();`不返回可以与位相乘的数字 0 或 1，而是返回字符“id”。您需要将 String / char 转换为数字。

```
String num;
  double result = 0;
  do {
  Scanner in = new Scanner(System.in);
  System.out.println("Please enter a binary number or enter 'quit' to quit: ");
  num = in.nextLine();
  int l = num.length();
  if (num.indexOf("0")==-1 || num.indexOf("1")==-1 ){
    System.out.println("You did not enter a binary number.");
  }

  for (int i = 0; i < l; i++)
{ 
  result = result + (Integer.parseInt(num.substring(i,i+1)) * Math.pow(2, (l - i)));
}
System.out.println("The resulting decimal number is: " +result);
  } while (!num.equals("quit"));

  if (num.equals("quit")){
    System.out.println("You chose to exit the program.");
    return;
  } 
```

顺便说一句：为什么不包含 0 或 1 的字符串不是二进制数字？想想`1111`例如。我认为您最好检查“既不是 0 也不是 1”

```
if (num.indexOf("0")==-1 && num.indexOf("1")==-1 ){
    System.out.println("You did not enter a binary number.");
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:29:47.757

请注意，它`num.charAt(i)`给出了位置字符的 ASCII 码`i`。这不是您想要的值。`int`在对值进行任何数学运算之前，您需要将每个字符数字转换为一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T02:10:05.563

`Integer.parseInt(string, base)`使用“base”基数将字符串解析为整数，如果无法转换，则会引发异常。

```
import java.util.Scanner;

public class Convertion {

    public static void main(String[] args) {
        String num;
        Scanner in = new Scanner(System.in);
        System.out.println("Please enter a binary number");
        num = in.nextLine();
        try{
              //this does the conversion
              System.out.println(Integer.parseInt(num, 2));
        } catch (NumberFormatException e){
              System.out.println("Number entered is not binary");
        }  
    }
} 
```

# entity-framework-4 - 我不明白为什么 DbSet<>.OfType<> 为过滤操作抛出无效的元数据类型

> ID：12810239
> 
> 赞同：2
> 
> 时间：2012-10-10T00:21:20.147
> 
> 标签：entity-framework-4

我有以下无意义的（在我看来）错误消息：

> System.NotSupportedException 未被用户代码处理
> 
> Message='Company.Data.DataProvider.Schema.DerivedType' 不是类型过滤操作的有效元数据类型。类型过滤仅对实体类型和复杂类型有效。

我的数据库中有以下表格：

```
BaseType
ObjectID uniqueidentifier
.. other unrelated columns

DerivedType
ObjectID unqueidentifier
UserID unqueidentifier
.. other unrelated columns 
```

我使用继承的实体框架使用了以下类：

```
BaseType
Guid ObjectID 
.. other unrelated properties

DerivedType : BaseType
Guid UserID 
.. other unrelated properties 
```

我的部分 SchemaContext 看起来像：

```
public partial class SchemaContext
{
  public IQueryable<DerivedType> DerivedTypes
  {
    get { return this.BaseType.OfType<DerivedType>()
  }
} 
```

我有一个看起来像这样的方法：

```
result = this._dbContexts.SchemaContext.DerivedTypes
  .Include(i => i.RatingType)
  .Include(i => i.ObjectVersion)
  .Where(dt => objectIDs.Any(id => 
                 dt.ObjectVersion.
                   .MatchingObjects
                   .Select(s => s.ObjectID).Contains(id))
               && dt.UserID == userID)
  .ToList(); 
```

我相信这`.OfType<>`是抛出错误，我不能使用基本类型，因为我需要过滤用户 ID。关于解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T03:10:15.600

我相信此错误消息表明您的派生类型未在实体模型中正确定义。如果使用操作实体对象类型名称的 POCO/Context 生成器，请验证对象名称是否匹配。

# python - Python django中的抽象类和Mixins有什么区别

> ID：12810240
> 
> 赞同：9
> 
> 时间：2012-10-10T00:21:28.527
> 
> 标签：python, django, oop

谁能告诉Django中的抽象类和Mixin有什么区别。我的意思是，如果我们要从基类继承一些方法，为什么会有单独的术语，比如 mixins，如果那只是一个类。

基类和mixins有什么区别

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T02:03:09.007

在 Python（和 Django）中，**mixin**是一种多重继承。我倾向于将它们视为“专家”类，它向继承它的类（以及其他类）添加特定功能。他们并不是真的要独立存在。

以 Django 为例`SingleObjectMixin`，

```
# views.py
from django.http import HttpResponseForbidden, HttpResponseRedirect
from django.core.urlresolvers import reverse
from django.views.generic import View
from django.views.generic.detail import SingleObjectMixin
from books.models import Author

class RecordInterest(View, SingleObjectMixin):
    """Records the current user's interest in an author."""
    model = Author

    def post(self, request, *args, **kwargs):
        if not request.user.is_authenticated():
            return HttpResponseForbidden()

        # Look up the author we're interested in.
        self.object = self.get_object()
        # Actually record interest somehow here!

        return HttpResponseRedirect(reverse('author-detail', kwargs={'pk': self.object.pk})) 
```

添加的[`SingleObjectMixin`](https://docs.djangoproject.com/en/dev/ref/class-based-views/mixins-single-object/#django.views.generic.detail.SingleObjectMixin)内容将使您能够`author`使用 just查找[`self.get_objects()`](https://docs.djangoproject.com/en/dev/ref/class-based-views/mixins-single-object/#django.views.generic.detail.SingleObjectMixin.get_object)。

* * *

Python 中的抽象类如下所示：

```
class Base(object):
    # This is an abstract class

    # This is the method child classes need to implement
    def implement_me(self):
        raise NotImplementedError("told you so!") 
```

在像 Java 这样的语言中，有一个`Interface`合约是一个 *接口*。然而，Python 没有这样的东西，你能得到的*最接近*的东西是抽象类（你也可以在[abc](http://docs.python.org/library/abc.html)上阅读。这主要是因为 Python 使用了[鸭子类型](http://en.wikipedia.org/wiki/Duck_typing#In_Python)，从而消除了对接口的需求。抽象类支持多态性，就像接口做。

# xml - 从通过 EF 访问的一系列 DB 表创建 XML 文档的最简单方法是什么

> ID：12810244
> 
> 赞同：0
> 
> 时间：2012-10-10T00:21:41.763
> 
> 标签：xml, asp.net-mvc, entity-framework

从数据库中的多个表创建 XML 文档的最简单方法是什么，即：Orders > OrderItems < Products .... 可能是：

```
<Order id="1">
  <OrderItem id ="1">
    <Product>Wheel</Product>
    <Qty>1<Qty/>
    <Price>10.00</Price>
  </OrderItem>
<Order> 
```

我需要它在 XML 中转换为 XHTML 以加载到 Word 中。

我也在使用 MVC3、EF5。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:26:36.923

您没有提供大量细节，但您可以使用[XmlSerializer](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx)类。如果您只想输出到字符串，则可以使用字符串编写器。

来自 MSDN 的代码示例：

```
XmlSerializer serializer = 
   new XmlSerializer(typeof(OrderedItem));

   // Create an instance of the class to be serialized.
   OrderedItem i = new OrderedItem();

   // Set the public property values.
   i.ItemName = "Widget";
   i.Description = "Regular Widget";
   i.Quantity = 10;
   i.UnitPrice = (decimal) 2.30;

   // Writing the document requires a TextWriter.
   TextWriter writer = new StreamWriter(filename);

   // Serialize the object, and close the TextWriter.
   serializer.Serialize(writer, i);
   writer.Close(); 
```

# visual-c++ - 无法纠正错误

> ID：12810245
> 
> 赞同：0
> 
> 时间：2012-10-10T00:21:45.583
> 
> 标签：visual-c++

我有这段代码：

```
static char szTop[] = "iMsg             wParam              lParam";
static char szUnd[] = "____             ______              ______";
static char szFormat[] = "%-16s%04X-%04X        %04X-%04X";
static char szBuffer[50];
static HWND hwndButton[NUM]; 
```

它给了我错误：

```
error C2143: syntax error : missing ']' before ';'
error C2143: syntax error : missing ';' before ']' 
```

另一个代码是：

```
for(i=0;i<NUM;i++)
    hwndButton[i] = CreateWindow ( "button", button[i].text, WS_CHILD | WS_VISIBLE | button[i].style, cxChar, cyChar * (1+2*i), 20*cxChar, 7*cyChar/4, hwnd, (HMENU) i, ((LPCREATESTRUCT) lParam )->hInstance, NULL );
return 0; 
```

这给了我错误：

```
error C2146: syntax error : missing ')' before identifier 'i'
error C2059: syntax error : ';'
error C2059: syntax error : ')'
error C2146: syntax error : missing ';' before identifier 'hwndButton 
```

我之前将所需的东西定义为：

```
static char szTop[] = "iMsg     wParam              lParam";
static char szUnd[] = "____         ______      ______";
static char szFormat[] = "%-16s%04X-%04X        %04X-%04X";
static char szBuffer[50];
static HWND hwndButton[NUM];
static RECT rect;
static int cxChar,cyChar;
HDC hdc;
PAINTSTRUCT ps;
int i;
TEXTMETRIC tm; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:26:36.697

对于第一个，这可能是由于没有为类型或宏定义适当的位置，很可能是`HWND`or `NUM`。

对于第二个，它抱怨`hwndButton`在定义它之前使用了，这仅仅是因为第一个错误 - 该变量从未定义过，因为试图定义它的语句有早期的错误错误。

首先，验证您是否包含了正确的标题。我*认为*它在`windef.h`但通常包含在`windows.h`头文件中。

其次，确保在`NUM`某处实际定义了它。

我认为这可能`NUM`只是因为其中一个错误来自`for`循环语句，其中的`windows.h`东西没有被使用，而是`NUM`被使用。

# algorithm - 交替输出以基于总和（matlab）创建新矩阵

> ID：12810246
> 
> 赞同：0
> 
> 时间：2012-10-10T00:21:52.637
> 
> 标签：algorithm, matlab, matrix

我希望在迭代过程中将一个输入矩阵 (X) 分成两个单独的矩阵。

有什么方法可以使这个过程自动化：

```
X = [1 2 3 4 5 6; 6 7 9 8 7 9; 2 4 1 1 4 2];

n = length(Matrix(1,:))-1;

Matrix1 = X(:,1);

Matrix2 = X(:,2);

if sum(Matrix1(2,:)) < sum(Matrix2(2,:)),

    Matrix1 = [Matrix1 X(:,3)];

else

    Matrix2 = [Matrix2 X(:,3)]; 

end

Output:

X =

     1     2     3     4     5     6
     6     7     9     8     7     9
     2     4     1     1     4     2

Matrix1 =

     1     3
     6     9
     2     1

Matrix2 =

     2
     7
     4 
```

标准是遍历整个矩阵 X，然后根据第二行的总和放入矩阵 1 或矩阵 2。所以在这个例子中，下一列 (#4) 将被放入矩阵 2，因为 Matrix1 中第二行的总和是 15 > Matrix2 = 7。

有什么建议么？

# mysql - load data infile 语句语法错误

> ID：12810255
> 
> 赞同：0
> 
> 时间：2012-10-10T00:22:11.717
> 
> 标签：mysql

我有一个包含以下列的表：ID | 姓名 | 来源 ID 是自增的主键。我需要从`CSV`文件中加载数据。文件中的数据格式如下：名称、来源。

我需要从文件中加载数据而不重复。我将表中的字段指定`Name`为唯一的并运行以下语句：

```
LOAD DATA INFILE 'F:/myfile.csv'
IGNORE
INTO TABLE test(name,source)
COLUMNS TERMINATED BY ','
ESCAPED BY '\\'
LINES TERMINATED BY '\r\n'; 
```

但我在 SQL 语法中遇到错误。你能帮我么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:38:37.210

我认为您不能在表语句中指定列：

```
LOAD DATA INFILE 'F:/myfile.csv'
IGNORE INTO TABLE test 
COLUMNS TERMINATED BY ','
ESCAPED BY '\\'
LINES TERMINATED BY '\r\n'
(`name`,`source`); 
```

像这样试试。根据[http://dev.mysql.com/doc/refman/5.1/en/load-data.html](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)

# javascript - Javascript：索引对象集以通过两个属性进行搜索

> ID：12810256
> 
> 赞同：0
> 
> 时间：2012-10-10T00:22:14.213
> 
> 标签：javascript, search, indexing

我应该为此使用什么数据结构/算法？

我在笛卡尔网格上有大量点，位置由（x，y）指定。我想进行快速搜索，返回位于给定 x 和 y 范围内的点（对象）集。（网格内的矩形）。

也许有一个轻量级的框架可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:36:55.573

我会将这些点存储为具有两个属性的对象：x 和 y，以及一个比较函数，该函数将它们按一个属性或另一个进行排序，使用剩余的属性作为决胜局：

```
function Point(x, y){
    this.x = x;
    this.y = y;
    this.compareTo =function(otherPoint){
        if(otherPoint.x != this.x)
            return this.x-otherPoint.x;
        return this.y-otherPoint.y;
    }
}

points[n] = new Point(someX, someY); 
```

然后，您可以使用排序算法（例如 QuickSort - 使用*O(n log(n))*）对它们进行排序，并使用简单的插入排序来保持它们随着点的来来去去而排序。当您需要使用矩形选择时，您可以简单地对它们进行二进制搜索（*O(log(n))*）以找到第一个属性的边界（例如，`x`），然后再次越过那个较小的集合以找到边界的第二个属性（比如说，`y`），其余的集合将是您正在寻找的那些，使您的搜索时间（*O(4 log(n)*）最坏情况，而您的插入时间线性（最坏情况）。不是太破旧，如果我自己这么说的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-12T07:22:31.410

以下是一般问题的最佳实现：

[http://en.wikipedia.org/wiki/Interval_tree#Higher_dimension](http://en.wikipedia.org/wiki/Interval_tree#Higher_dimension)

[如何搜索影响空间点的对象](https://stackoverflow.com/questions/16500160/how-to-search-objects-affecting-a-point-in-space/16500407#16500407)

# javascript - iphone/ipad 杂志框架，iScroll 还是更新的？

> ID：12810261
> 
> 赞同：0
> 
> 时间：2012-10-10T00:23:22.183
> 
> 标签：javascript, iphone, css, webkit, scroll

自早期版本以来，我一直在使用 iScroll，但我想知道是否有针对经典交互进行的优化：

*   向左/向右滑动：从一个故事移动（对齐）到另一个故事
*   上/下滑动：滚动（自然滚动）故事

我记得由于锁定或嵌套滚动导致的一些问题......

这是解决了还是有更新的插件效果更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:32:25.247

可滚动性 - [https://github.com/joehewitt/scrollability](https://github.com/joehewitt/scrollability) - 来自 joe hewitt 的 iScroll 在推出时是一个改进。它支持双向滚动。

话虽如此，iScroll 4 是对 iScroll 的完全重写，并且在一两个月前刚刚问世。请务必先尝试一下。

# html - 如何将文本字段放入图像中？

> ID：12810268
> 
> 赞同：0
> 
> 时间：2012-10-10T00:23:53.447
> 
> 标签：html, css

谁能给我看一个代码片段，它产生类似于这个例子中的“搜索框”：www.dx.com？

令我惊讶的是，谷歌搜索“图像内的文本字段”只给了我“文本字段内的图像”的所有结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T00:35:12.883

您不能在图像中放入其他元素，但您可以执行以下操作来实现此效果：

使用 a`css`作为：

```
<style>
    .search-container{background:url(your/image/path) no-repeat top left;width:200px;height:50px;}
    .search-container input{width:150px;}
    .search-container button{width:40px;}
</style> 
```

`html`就像：

```
<html>
    <head></head>
    <body>
        <div class="search-container">
            <input type="text" /> <button>Search</button>
        </div>
    </body>
</html> 
```

现在，`search-container`将带有背景图像，您可以在其中放置搜索表单（输入和按钮）。

如果您想要没有“默认”样式的输入，您可以使用以下命令重置：

```
.search-container input{border:none;background:transparent;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:43:39.117

正如其他答案指出的那样，您正在寻找的方法无效。您实际上是将文本字段分层放在图像之上，并隐藏字段的边框和背景，因此唯一可见的是图像。

他们使用绝对定位将文本字段和按钮设置在图像顶部，移除边框和背景，使元素基本上不可见，显示其背后的图像。这是一个简单的例子。 [http://jsfiddle.net/a2pQ2/2/](http://jsfiddle.net/a2pQ2/2/)

这是html

```
<div class="searchbox">
    <input type="text" class="search" id="search" value="Search in 80,000+ Gadgets...">
    <button id="btnSearch" type="button" class="btn_search"></button>
</div>​ 
```

和CSS

```
.searchbox {
    position: relative;
    width: 367px;
    height: 36px;
    background: url(http://tctel.com/search.jpg) no-repeat;
}
.searchbox .search
{
    border: none;
    position: absolute;
    top: 6px;
    left: 6px;
    height: 24px;
    line-height: 24px;
    width: 287px;
    outline: none;
}
.searchbox .btn_search
{
    border: none;
    position: absolute;
    top: 2px;
    right: 2px;
    height: 32px;
    width: 71px;
    background: transparent;
    cursor: pointer;
}​ 
```

所以 searchbox 是容器，它有一个 367px 宽和 36px 高的背景图像。所以我们将它设置为相对位置，这样我们就可以绝对定位孩子。

.search 是文本字段。它设置为绝对位置，我将其设置为从顶部和左侧到 6 px 以匹配图像的边框，出于同样的原因将高度设置为 24。我隐藏了边界和轮廓。

.btn_search 是按钮，我只是将它放在右侧，隐藏边框，使背景透明，并在鼠标悬停时更改光标。

# javascript - 数据库或数组

> ID：12810269
> 
> 赞同：1
> 
> 时间：2012-10-10T00:24:02.823
> 
> 标签：javascript, mysql, node.js, mongodb, database

如果我有简单的关系（95% 的查询取决于 ID），那么使用数据库的确切意义是什么。

我正在存储用户及其统计信息。

如果我可以有简洁的结构，我为什么要使用外部数据库：

`db.users[32] = something`

500K 用户的数组对于 RAM 来说并不是那么大的努力

优点是：

*   没有问题的异步（即时结果）
*   轻松导出/导入
*   像处理本机对象一样处理数据库

附言。和考虑：

*   这样做会更快还是更`collection[3]`慢`db.query("select ...`
*   我要将它存储为文件/s
*   只有一个应用程序/进程访问这些数据，代码是逐行执行的——请不要详细说明锁定。
*   请不要回答数据库命题，但为什么要在本机数组/对象上使用外部数据库-我在一些数据库方面有经验-事实并非如此。
*   我正在构建的是客户端/网关/服务器游戏。网关处理所有用户数据、处理、身份验证、写入统计信息等，软件的其他部分无需直接访问此数据/数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:28:26.997

这取决于对数据的持久性、延迟和生命周期的要求。在内存中访问数据结构几乎总是比将网络跳转到外部数据库要快得多，但有一些事情需要考虑。

您可以将其仅保留在内存中，但如果您的进程由于某种原因被回收，它就消失了。对于您的情况，这可能没问题...

如果您有多个具有负载平衡（而不是分区）的前端/进程或没有亲和性，您也可能会遇到问题。在某些情况下，内存状态可能会出现问题。还有像[memcached](http://memcached.org/)这样的选项来解决这样的问题。

memcached 是 facebook 如何解决此类问题的： http: [//www.facebook.com/note.php? note_id=39391378919](http://www.facebook.com/note.php?note_id=39391378919)

与 facebook 类似，您还可以将数据持久保存在数据库中（无论是 SQL 还是像 mongodb 这样的 NoSQL）并缓存在内存中以提高效率。如果您在内存中缓存并且它由数据库支持，那么您必须担心该数据的延迟以及如何刷新它。memcached 也是此类场景的解决方案。要么你写你自己的机制来捎带数据，有轮询（尽量避免）等等......这基本上就是fb正在做的事情 - 使用数据库但通过分布在内存缓存中卸载数据库负载。从那个帖子：

> memcached 是一个高性能的分布式内存对象缓存系统。在 Facebook，我们可能是世界上最大的 memcached 用户。我们使用 memcached 来减轻数据库负载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T07:57:49.127

这将是一个比任何事情都更周到的答案。您在这里还需要考虑的一件事是您的语言。我是一名 PHP 程序员，我为数据库感到高兴。

尝试在 PHP 中将 500K 用户数组存储在内存中（并对其进行操作）将是一场活生生的噩梦，事实上它可能对于大多数语言来说都是如此。数据库使用对预定义索引的对数时间函数来实施搜索策略来克服这种情况。

你也得到了成本因素。将其存储在同一服务器上的 MySQL 或 MongoDB 数据库中实际上更便宜，因为您很可能需要更少的内存来保存您的信息。

我会在这样一个数组的负载下认真测试你的内存消耗，我也猜这只是许多数组中的一个，对吧？

> 收集 [3] 会比 db.query("select ...

现在这取决于，我不确定 node.js 如何处理数组和迭代到其中的特定索引，但有些语言不会对索引进行 O(log n) 搜索，这意味着你只会做 O(n ) 搜索，这实际上比直接调用 SQL 表的索引要慢。很公平，考虑到 SQL 创建结果集、将其写入磁盘然后响应 node.js 来获取它所需的时间，它可能会更慢。

所以 node.js 在小索引或对象上肯定会更快，但在更大的索引或对象上……我不确定。

> 只有一个应用程序/进程访问这些数据，代码是逐行执行的——请不要详细说明锁定。

这很令人惊讶。在此之前，我不得不轻松启动多个 node.js 服务器。事实上，为了保持理想的网络托管环境，如果您的主服务器出现故障，您应该始终准备好另一台服务器来参与战斗（相信我确实如此......）。考虑到这一点，我认为您在这里没有考虑锁定和分布式数据的中央存储点有点奇怪。

# php - 如何使用正则表达式检查 PHP 字符串中的问号？

> ID：12810271
> 
> 赞同：2
> 
> 时间：2012-10-10T00:24:38.327
> 
> 标签：php, regex, string, url

`if`我有一个返回 URL 的字符串，当返回的 URL 包含问号时，我需要弄清楚如何使用和正则表达式来做某事。

所以当 $url 是`http://somedomain.com/?p=34325&blahblahblah`

如果 $url 包含“ `?p=`”（并丢弃其他所有内容）则退出，否则执行某些操作

有什么帮助吗？
非常感谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T00:29:50.693

您不需要正则表达式来匹配简单的字符串：

```
if (strpos($url, '?p=') !== false) {
   exit;
}
//do something 
```

如果您*真的*想使用正则表达式：

```
if (preg_match('/\?p=/', $url)) { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T00:29:47.650

不要为此使用正则表达式。您不需要常规模式匹配的强大功能。只需使用[strstr](http://php.net/strstr)：

```
if(strstr($url, 'p=?')){
    exit;
}

// Do other stuff 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T00:31:32.337

`if (preg_match("/(\?p=)/", $url)) {`

# php - 有没有办法将 PHP 代码添加到可点击的链接？

> ID：12810277
> 
> 赞同：1
> 
> 时间：2012-10-10T00:25:43.403
> 
> 标签：php

我正在尝试找出一种方法来为企业进行一些网站跟踪。有没有办法将 PHP 代码添加到网页上的可点击链接中，以便当用户点击将他们带到不同页面的链接时，PHP 代码会在点击操作发生之前立即执行？那么像这样的东西会在链接到网站之前执行一些 PHP 代码吗？ [堆栈溢出链接](http://stackoverflow.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:28:10.473

不，不是直接的。PHP 仅适用于服务器端代码。我建议您查看 Mixpanel、Kissmetrics 或 Google Analytics 之类的工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:28:53.950

PHP 是一种服务器端脚本语言。因此，它不能在他们的浏览器中在客户端运行，因为所有处理都必须在服务器本身上完成。

您可以使用 Javascript 来实现您想要的功能。

在您的页面上，您可以执行以下操作：

```
<!-- In your page head -->
<script type="text/javascript">
    function myLinkFunction() {
        // Do some Javascript here to track the click
        // If you have jQuery on your page, you could do this:
        $.post("trackclick.php", { link-id: "212", other-info: "some data" } );
        // Send the user to the linked page:
        return true;
    }
</script>

<!-- Somewhere else -->
<a href="somepage.html" onClick="myLinkFunction();">Link</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T00:30:29.490

链接到 PHP 函数，运行您的代码，函数的最后一行将是标题行。标头（位置：'http://whateverlink.com'）；

真的与提交 PHP 表单没有什么不同

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T00:28:42.670

您可以链接到网站上的 PHP 页面，并`header('Location: <new url>')`在执行 PHP 代码后用于重定向。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-10T00:38:03.037

如果您使用的是 jQuery，您可以执行以下操作：

```
<a href="link.html" class="link">liunk</a>

<script>
$(document).ready(function() {
    $('.link').click(function(e) {
        e.preventDefault();
        var $url = $(this).attr('href');
        var logged = $.post('tracking-script.php', {link: $url});

        //  from 'tracking-script.php' return a string of yes or something

        if(logged == 'yes') {
            //window.location = $url;
            return true;    
        }
    });
});
</script> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-10T00:42:23.017

您可以使用 $_GET 传递跟踪代码或整数。然后在任何 HTML 之前的下一页顶部，您将运行一些小的跟踪代码。跟踪代码可以更新数据库或平面文件，具体取决于您的偏好。

```
landingpage.html
 <a href = "somepage.php?tracking=1">Next Page</a>

somepage.php
 $tally = $_GET['tracking'];
 $track = $tally." from landingpage.html";
 $handle = fopen('path/to/tracks.txt','a');
 fwrite($handle, $track); 
```

这是一种简化的方式，但该过程是 (a) 将一个字符串附加到名为 track.txt 的文本文件的末尾。您可以通过其他方式处理tracks.txt，例如统计某个给定页面的链接数量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-10T00:50:50.533

尽管人们说你可以做到这一点，结合javascript。这是一种您肯定听说过的方法，称为“AJAX”。这意味着您运行一个在后台调用 PHP 脚本的 Javascript 函数。

w3schools 有一个很棒的教程：[http ://www.w3schools.com/ajax/default.asp](http://www.w3schools.com/ajax/default.asp)

您可以同时使用 POST 和 GET 方法将数据传递给 php 函数。它会是这样的：

```
function showHint(str)
{
var xmlhttp;
 if (str.length==0)
 { 
 document.getElementById("txtHint").innerHTML="";
 return;
 }
 if (window.XMLHttpRequest)
 {// code for IE7+, Firefox, Chrome, Opera, Safari
 xmlhttp=new XMLHttpRequest();
 }
 else
 {// code for IE6, IE5
 xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
 }
 xmlhttp.onreadystatechange=function()
 {
 if (xmlhttp.readyState==4 && xmlhttp.status==200)
 {
 document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
 }
}
xmlhttp.open("GET","gethint.asp?q="+str,true);
xmlhttp.send();
} 
```

所以本质上，“str”字符串是您希望传递给 javascript 函数的值，然后通过此处显示的 get 方法传递给 PHP 文件 xmlhttp.open("GET","gethint.asp?q="+str,真的）; 这可能很容易 xmlhttp.open("GET","gethint.php?q="+str,true); PHP 或 ASP 差别不大。接下来要记住的是“txtHint”是一个 HTML 元素，您希望页面的响应返回到该元素中。因此，例如，您可以使用“gethint.php”或 asp 来回显“Success”或“Fail”。

附带说明一下，如果您希望为响应设置样式，可以通过与页面其余部分相同的样式表来完成。我希望这对伴侣有帮助:)

# objective-c - Facebook SDK 使用 iOS SDK 返回错误的 UID

> ID：12810284
> 
> 赞同：-1
> 
> 时间：2012-10-10T00:26:28.243
> 
> 标签：objective-c, facebook-graph-api, facebook-ios-sdk, rubymotion

（这是 RubyMotion 但应该与 Objective-C 完全相同。）

我在 Graph API Explorer (https://developers.facebook.com/tools/explorer) 上运行查询并返回正确的结果（注意：随机 UID，不是真实的）：

```
SELECT uid FROM user WHERE uid = 100001554214421 
```

回报：

```
{
  "data": [
    {
      "uid": 100001554214421
    }
  ]
} 
```

但是，在使用 Facebook SDK 的 iOS 中，我运行相同的查询：

```
def query_facebook
  params = { query: "SELECT uid FROM user WHERE uid = 100001554214421" }
  @facebook.requestWithMethodName("fql.query",
                                                andParams: params,
                                                andHttpMethod: "POST",
                                                andDelegate: self)
end

def request(request, didLoad:response)
  $stderr.puts response
end 
```

这输出：

```
{"uid"=>100001535492096} # << should be 100001554214421 
```

请注意，uid 与我查询的不同。

**问题：** 为什么像这样的简单查询会在 Facebook iOS SDK 中返回错误结果，但在 Graph API Explorer 中却没有？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-10T21:11:29.100

Facebook 已确认这是一个错误：

[https://developers.facebook.com/bugs/507492582594198?browse=search_509ec2d1179c70b65454284](https://developers.facebook.com/bugs/507492582594198?browse=search_509ec2d1179c70b65454284)

不幸的是，他们为此分配了低优先级。希望他们尽快修复它。

# iphone - 手指越过 TableViewCell 时将其设为 Highlite

> ID：12810285
> 
> 赞同：0
> 
> 时间：2012-10-10T00:26:28.477
> 
> 标签：iphone, ios, cocoa-touch, uitableview

`UITableViewCell`当手指经过它时，是否可以制作高光？不仅仅是当它按下它时，而是当手指已经在屏幕上滑动并在 tableviewcell 上运行时？我已经尝试了所有的手势识别器（包括`UILongPressGestureRecognizer`）并且没有任何运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T03:40:13.710

尝试使用此功能，它类似于评论中提到的问题中的那个：

（在您的视图控制器中）

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    //assuming UITableView named tableView
    UITableViewCell *tableViewCell;
    CGPoint touchedPoint = [[touches anyObject] locationInView:self.view];

    for (int C = 0; C < [tableView numberOfRowsInSection:0]; C++) {
        //this should loop through all cells in your tableview

        tableViewCell = [tableView cellForRowAtIndexPath:[NSIndexPath indexPathWithIndex:C]];

        if (CGRectContainsPoint(tableViewCell.frame, touchedPoint)) {

            [tableViewCell setHighlighted:TRUE];
        }  
        else {
            [tableViewCell setHighlighted:FALSE];
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T03:52:13.653

在 cellForRowAtIndexPath 中：

```
UISwipeGestureRecognizer *recognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipe:)];
[recognizer setDirection:UISwipeGestureRecognizerDirectionRight];
[cell.contentView addGestureRecognizer:recognizer]; 
```

然后...

```
- (void)handleSwipe:(id)sender
{
    UISwipeGestureRecognizer *recognizer = (UISwipeGestureRecognizer *)sender;
    UIView *contentView = [recognizer view];
    UITableViewCell *cell = (UITableViewCell*)[contentView superview];
    [cell setSelected:YES];
} 
```

我刚刚对此进行了测试，它的工作原理与您正在寻找的完全一样。

编辑：如果我不着急，我会在类型转换之前进行一些反省。

# ruby-on-rails - 在哪里可以在 rails 源代码中找到自动重新加载代码？

> ID：12810289
> 
> 赞同：0
> 
> 时间：2012-10-10T00:27:09.833
> 
> 标签：ruby-on-rails

所以在 Rails 3.2 中，[来自 Active Reload](https://github.com/paneq/active_reload)的代码已经合并到 ...

“最引人注目的新功能是开发模式的速度提高了一吨半。受 Active Reload 的启发，我们现在只从您实际更改的文件中重新加载类。对于更大的应用程序，差异是巨大的。”

我想知道是否有人知道我可以从哪里开始寻找控制这种行为的代码。我需要为它编写一些自定义钩子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:52:06.703

查看[此提交](https://github.com/rails/rails/commit/fa1d9a884c0d5b70c97442e3360ac98ca5fa4340)以查看相关更改。

# xcode - 仅当用户在计算机上时才显示通知

> ID：12810290
> 
> 赞同：5
> 
> 时间：2012-10-10T00:27:18.967
> 
> 标签：xcode, macos, cocoa, osx-mountain-lion

检测用户当前是否在他们的计算机上的最佳方法是什么，即以某种方式使用它。我们有一个应用程序，如果用户在他们的计算机上，它应该只发布通知（带有关闭按钮的横幅通知）。

*例如，想象一个股票交易应用程序，它会提醒用户注意可能仅在几分钟内相关的各种时间敏感信息。如果用户远离他们的计算机，他们不希望找到 20 个未执行的警报来关闭。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-11T00:35:03.857

如果链接到 ApplicationServices 或更高版本，请尝试：

```
CFTimeInterval idleTime = CGEventSourceSecondsSinceLastEventType(kCGEventSourceStateCombinedSessionState, kCGAnyInputEventType); 
```

自事件源的最后一个事件以来的时间。

kCGanyInputEventType eventType 将报告任何输入事件、键盘、鼠标或平板电脑的最后时间戳。各种系统和应用程序定义的事件不影响此事件类型的时间。

同样，从登录会话中发布的程序或应用程序应该使用 kCGEventSourceStateCombinedSessionState。

解释硬件状态和生成事件的用户空间设备驱动程序应使用 kCGEventSourceStateHIDSystemState。

CG_EXTERN CFTimeInterval CGEventSourceSecondsSinceLastEventType( CGEventSourceStateID 源, CGEventType eventType ) AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER;

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-10T00:34:11.547

从技术上讲，我不知道如何观察不活动，但我认为您可以使用超时通知在一段时间间隔后自行关闭和/或将显示的通知限制为很少，因此最新的通知会自动关闭最旧的通知。

从[苹果文档](https://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSUserNotificationCenter_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40012260)：

> 注意：如果用户在预定的通知计划触发后超过 15 分钟醒来，则将其丢弃。如果通知以小于 15 分钟的间隔重复，则它会在 1 分钟后过期。过期的通知只会被丢弃，除非它们重复，在这种情况下，它们会留在预定列表中，稍后再触发。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T10:20:26.320

相反，您可以检查用户的空闲时间。假设用户离开她的计算机并走开，IOKit 将在 HID（人机接口设备）上报告空闲时间。代码看起来像：

```
int64_t getIdleTime(void) {
    io_iterator_t iter;
    int64_t idle = 0;

    // Step 1: Prepare a matching dictionary for "IOHIDSystem", which is the I/O Kit
    // class which we will query
    if (IOServiceGetMatchingServices
         (kIOMasterPortDefault, IOServiceMatching("IOHIDSystem"), &iter) == KERN_SUCCESS)   
          {
            io_registry_entry_t entry = IOIteratorNext(iter);

            // Step 2: If we get the classes, get the property:

            if (entry)  {

            CFMutableDictionaryRef dict;

             // Query the HIDIdleTime property, if present.
            if (IORegistryEntryCreateCFProperties(entry, &dict, kCFAllocatorDefault, 0) == KERN_SUCCESS)    
                {
                CFNumberRef prop = (CFNumberRef) CFDictionaryGetValue(dict, CFSTR("HIDIdleTime"));
                if (prop) {
                    int64_t nsIdle;

                     // Value is in Nanoseconds, you might want to convert 
                    if (CFNumberGetValue(prop, kCFNumberSInt64Type, &nsIdle)) {
                        idle = (nsIdle / 1000000000); 
                    }
                }
                CFRelease(dict); // Be nice. Clean up
            }
            IOObjectRelease(entry); // as well as here..
        }
        IOObjectRelease(iter); // and here..
    }
    return idle;
} 
```

# python - 澄清：Heroku 是否在 Nginx 后面运行 Python 应用程序？

> ID：12810292
> 
> 赞同：8
> 
> 时间：2012-10-10T00:27:51.657
> 
> 标签：python, heroku, nginx

**TL/DR：我的主要问题：是否值得我花时间尝试将 NGinx 添加到我的 Django/Gunicorn/Cedar/PostgresSql 应用程序中，或者 Heroku 是否为我做了这种类型的性能改进？**

在 Cedar 文档 (https://devcenter.heroku.com/articles/cedar) 中，它明确指出 cedar 不支持反向代理。“Cedar 不包含 Varnish 等反向代理缓存，更愿意让开发人员选择最能满足其需求的 CDN 解决方案。”

再次在路由文章 (https://devcenter.heroku.com/articles/http-routing#gzipped-responses) 中，指定 nginx 不会自动完成：'由于对 Cedar 应用程序的请求是直接向应用程序服务器发出的– 不通过像 nginx 这样的 HTTP 服务器代理 – 响应的任何压缩都必须在您的应用程序中完成。”

但是，在 Python 常见问题解答中，它另有说明：[https://devcenter.heroku.com/articles/python-faq#do-python-applications-run-behind-nginx](https://devcenter.heroku.com/articles/python-faq#do-python-applications-run-behind-nginx) “不。不需要使用反向代理在 Heroku 上，因为 Heroku 云平台会处理这些服务器通常为您做的所有事情。

您的应用程序只是提供了一个 Python 服务器来响应 HTTP 请求。Gunicorn、Gevent 和 Eventlet 是很好的选择。

由于 Web 服务器嵌入在您的应用程序中，因此您可以在任何环境中轻松测试和调试完全相同的代码。这种开发和生产平价让您在开发周期中轻松解决问题。”

在我看来，Heroku 处理了反向代理的一些好处，但没有压缩。真的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-15T04:17:50.157

收到 Heroku 支持的回复：

> 我们不建议尝试将 nginx 添加到您的堆栈中，Heroku 也不提供该层。但是你是正确的，如果你想压缩响应，你的应用程序必须压缩响应 - 这通常在应用程序框架（例如 Ruby 的 Rack）中作为中间件层处理。gzip 非常快，这不会给您的请求增加任何明显的延迟。

这确认您不需要在 Heroku 上运行 Nginx 的反向代理功能。

# objective-c - iOS：有什么方法可以检查属性名称是私有名称还是保留名称？

> ID：12810297
> 
> 赞同：2
> 
> 时间：2012-10-10T00:28:23.180
> 
> 标签：objective-c, ios, properties, private-members

最近我在上传应用程序时遇到问题，App Uploader 告诉我我使用了一个名为“contentId”的私有属性，它是 Core Data 托管对象中的一个私有属性，我所做的是创建一个具有“contentId”的协议属性并使我的核心数据托管对象子类之一实现该协议，并且在'contentId'的getter中它返回其对象ID，我不知道我是否直接在托管对象子类中使用'contentId'，是否它当时警告我，但我想知道在尝试上传并让应用程序上传者告诉我之前，是否有办法确保我的课程不使用私有属性，因为有时无法在最后一步进行更改。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T04:27:40.313

好吧，我想您可以在开发时进行测试

```
[self respondsToSelector:@selector(setSomePotentiallyPrivateProperty)]; 
```

在宣布财产之前。

# wordpress - htaccess 在重定向时删除查询字符串

> ID：12810307
> 
> 赞同：0
> 
> 时间：2012-10-10T00:29:10.143
> 
> 标签：wordpress, .htaccess, mod-rewrite, redirect

我已经对此进行了一段时间的研究，并发誓我的解决方案应该按照以下方式工作（这里还有数百个其他人，所以请原谅我的重复）：

[示例 1](https://stackoverflow.com/questions/3457022/mod-rewrite-remove-query-string-from-url) [示例 2](http://wordpress.org/support/topic/301-redirect-old-site-dynamic-urls-to-wordpress-permalinks)

我需要从重定向中删除查询字符串。旧 WordPress ?p=### 到新域/url。

```
Old Url: blog.domain.com/blog/?p=123
New Url: www.domain.com/yada/woohoo/ 
```

有了这个：

```
RewriteCond %{QUERY_STRING} ^p=123$
RewriteRule ^/blog/$ http://www.domain.com/yada/woohoo/?  [L,R=301] 
```

我得到：[http ://www.domain.com/yada/woohoo/?p=123](http://www.domain.com/yada/woohoo/?p=123)

我想要： http: [//www.domain.com/yada/woohoo/](http://www.domain.com/yada/woohoo/)

blog.domain.com 将在 DNS 级别重定向。

我错过了什么？这 ”？” 在重写行的末尾应该删除查询字符串吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:46:55.970

我刚刚尝试了你的代码，我唯一改变的是博客中的第一个 / ，我让它完美地工作，没有查询字符串
如果你正在运行 Apache > 2.4 那么你可以使用标志 QSD，否则，使用 ? 最后它起作用了。那里还有其他规则吗？

```
RewriteCond %{QUERY_STRING} ^p=123$
RewriteRule ^blog/$ http://www.domain.com/yada/woohoo/?  [L,R=301] 
```

# javascript - 如何从 bash 控制台运行 Jasmine 测试？

> ID：12810310
> 
> 赞同：4
> 
> 时间：2012-10-10T00:29:40.857
> 
> 标签：javascript, jasmine

我正在考虑使用[Jasmine](http://pivotal.github.com/jasmine/)为我们的应用程序的前端代码编写一些单元测试。我希望能够从控制台 1) 运行它们，因为我认为这比在浏览器中运行它们更方便 2) 以便自动执行测试。我到底需要做什么来设置它？是否有任何工具已经可以做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T00:37:41.837

好吧，您仍然必须在浏览器中运行它们，但是有一些控制台驱动的工具可以进行浏览器测试。

Yeoman - [http://yeoman.io/](http://yeoman.io/) - 是 Google 开发团队发布的一个工具，其中包含 phantomjs 作为测试代码任务的一部分。基本上，它启动一个无头浏览器，运行测试，然后将结果输出到控制台。

Bunyip - [http://ryanseddon.github.com/bunyip/](http://ryanseddon.github.com/bunyip/) - 也是一个了不起的工具。它允许您在任何可以连接到它的浏览器中运行您的测试（因此您不仅仅依赖于 webkit 测试，就像使用 yeoman/phantomjs 一样）。它与 browserstack 有很好的集成，因此您可以在数十个浏览器上自动运行整个测试套件。

您还可以编写一个 selenium 测试 - [http://seleniumhq.org](http://seleniumhq.org) - ，然后通过命令行启动它。

# symfony - 学说2一对多不起作用

> ID：12810311
> 
> 赞同：0
> 
> 时间：2012-10-10T00:29:41.720
> 
> 标签：symfony, doctrine-orm, one-to-many, symfony-2.1, many-to-one

这是一个简单的问题，但是在通过 Stackoverflow 和其他地方的所有类似线程都没有成功之后，问题仍然存在。

我无法使双向一对多关系正常工作。Biomass.field 可访问（拥有方），但 Field.biomasses（反方）不可访问。

* * *

表格（删除的消耗性字段）

```
CREATE TABLE `field` (
  `field_id` varchar(255) NOT NULL,
  PRIMARY KEY (`field_id`),
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `biomass` (
  `biomass_id` int(11) NOT NULL AUTO_INCREMENT,
  `field_id` varchar(255) NOT NULL,
  PRIMARY KEY (`biomass_id`),
  KEY `FK_field_has_0m_biomasses_idx` (`field_id`)  
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

ALTER TABLE `biomass`
  ADD CONSTRAINT `FK_field_has_0m_biomasses` FOREIGN KEY (`field_id`) REFERENCES 
`field` (`field_id`) ON DELETE CASCADE ON UPDATE CASCADE; 
```

* * *

字段.php

```
<?php

namespace Acme\MainBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;

/**
 * Acme\MainBundle\Entity\Field
 *
 * @ORM\Table(name="field")
 * @ORM\Entity
 */
class Field {

    public function __construct() {
        $this->biomasses = new ArrayCollection();
    }

    /**
     * @var string $id
     *
     * @ORM\Column(name="field_id", type="string", length=255, nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /*
     * var ArrayCollection $biomasses
     *
     * @ORM\OneToMany(targetEntity="Biomass", mappedBy="field", cascade={"all"})
     */
    private $biomasses;

    /**
     * Get id
     *
     * @return integer
     */
    public function getId() {
        return $this->id;
    }

    /**
     * Get biomasses
     *
     * @return ArrayCollection
     */
    public function getBiomasses() {
        return $this->biomasses;
    }

    /**
     * Set biomasses
     *
     * @param ArrayCollection $biomasses
     * @return ArrayCollection
     */
    public function setBiomasses(ArrayCollection $biomasses) {
        $this->biomasses = $biomasses;
        return $this->biomasses;
    }

    /**
     * Add Biomass
     *
     * @param Biomass $biomass
     * @return ArrayCollection
     */
    public function addBiomass(Biomass $biomass) {
        $biomass->setField($this);
        return $this->biomasses[] = $biomass;
    }

    /**
     * Set biomass
     *
     * @param Biomass $biomass
     * @return ArrayCollection
     */
    public function removeBiomass(Biomass $biomass) {
        return $this->biomasses->removeElement($biomass);
    }       

    function __toString() {
        return $this->getId();
    }
} 
```

* * *

生物质.php

```
<?php

namespace Acme\MainBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Acme\MainBundle\Entity\Biomass
 *
 * @ORM\Table(name="biomass")
 * @ORM\Entity
 */
class Biomass {
    /**
     * @var integer $id
     *
     * @ORM\Column(name="biomass_id", type="integer", nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var Field
     *
     * @ManyToOne(targetEntity="Field", inversedBy="biomasses")
     * @JoinColumn(name="field_id", referencedColumnName="field_id")
     */
    private $field;

    /**
     * Get id
     *
     * @return string
     */
    public function getId() {
        return $this->id;
    }    

    /**
     * Set field
     *
     * @param Field $field
     * @return Biomass
     */
    public function setField(Field $field = null) {
        //$field->addBiomass($this);
        $this->field = $field;

        return $this;
    }

    /**
     * Get field
     *
     * @return Field
     */
    public function getField() {
        return $this->field;
    }

    function __toString() {
        return $this->id;
    }
} 
```

* * *

FieldController.php

```
$em = $this->getDoctrine()->getManager();
$entities = $em->getRepository("AcmeMainBundle:Field")->findAll();

foreach($entities as $field) {
    foreach($field->getBiomasses() as $biomass) {
        print_r($biomass->getId());
    }
} 
```

这导致：警告：在 C:[...]\MainBundle\Controller\FieldController.php 第 39 行中为 foreach() 提供的参数无效

ArrayCollecion 没有被创建，因为 Doctrine 不调用构造函数，它使用序列化/反序列化技巧来实例化类。

我在这些表中有虚拟数据并且数据是可访问的，所以学说似乎根本没有创建生物质对象。

* * *

环境 Symfony-2.1.2, Apache/2.4.3 (Win64), PHP/5.4.6-Win64, MySQL Community Server 5.5.28

编辑：固定 Biomass.field 引用列名拼写错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T20:33:57.273

在 BioMass.php 中，@JoinColumn 应指向**BioMass**表中的 field_id而不是**id**。

```
 /**
 * @var Field
 *
 * @ManyToOne(targetEntity="Field", inversedBy="biomasses")
 * @JoinColumn(name="field_id", referencedColumnName="field_id")
 */ 
```

# asp.net-mvc - ASP .NET WebApi 和 WCF

> ID：12810312
> 
> 赞同：1
> 
> 时间：2012-10-10T00:29:44.077
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-web-api

> **可能重复：**
> [WCF Web API 和 ASP.NET Web API 有什么区别](https://stackoverflow.com/questions/9451298/whats-the-difference-between-wcf-web-api-and-asp-net-web-api)

ASP .NET WebAPI 曾经基于 WCF。我现在注意到，在 MVC4 版本的 ASP .NET WebAPI 中没有更多的服务主机工厂（至少看起来是这样）......

WCF 不再是 WebAPI 框架的一部分吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T07:16:11.703

ASP.NET Web API 与 WCF 无关。这是一个全新的框架。它所基于的整个 HTTP 堆栈都是新的。

# sql-server - 为什么 SharePoint 内容数据库中的 Sites.FullUrl 为空？在哪里可以找到网站集 url？

> ID：12810316
> 
> 赞同：2
> 
> 时间：2012-10-10T00:30:01.790
> 
> 标签：sql-server, sharepoint, sharepoint-2010

我正在开发一个 sharepoint 项目。它需要使用 SQL 查询来获取有关网站集和 web 的一些信息。我正在使用 sharepoint 2010：

```
SELECT
  Webs.Title AS [Site Title]
, Webs.FullUrl AS [Site Url]
, Lists.tp_Title AS [List/Library Title]
, COUNT(*) AS [Total GIF]
, CAST( CAST(SUM(Docs.Size) AS FLOAT) / 1024.0 AS DECIMAL(10,3) ) AS [Size (KB)]
FROM Docs
INNER JOIN Webs On Docs.WebId = Webs.Id
INNER JOIN Sites ON Webs.SiteId = Sites.Id 
INNER JOIN Lists ON Docs.ListId = Lists.tp_ID
WHERE Docs.Type <> 1 
AND Docs.LeafName LIKE '%.gif'
AND Docs.LeafName NOT LIKE 'template%'
GROUP BY
  Webs.FullUrl
, Webs.Title
, Lists.tp_Title
ORDER BY 
  [Site Url]
, [List/Library Title]
, [Total Gif]
, [Size (KB)] 
```

当我直接检查内容数据库时，我发现 Sites.FullUrl 始终为空，尽管我确实有多个网站集和网站（webs.FullUrl 不为空）。

我检查了我在 VM 上安装的 2 个 Sharepoint 2010，它们对于 Sites.FullUrl 都是空的。有人可以确认 Sites.FullUrl 不应该为空吗？是因为sharepoint 2010吗？

使用 powershell，我可以获得我想要的所有信息。所以，我想我也应该能够直接从数据库中获取所有信息。这个对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T06:57:51.913

不建议您查询内容数据库。[正如其他问题中所解释的那样，](https://stackoverflow.com/questions/1665755/how-do-i-query-the-sharepoint-database)您应该将其视为黑匣子。

如果您需要某种`SPSite`从外部应用程序动态检索 url 的方法，您可以将 url 存储在列表中，然后使用列表 Web 服务调用检索它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-14T20:36:24.473

如果您正在寻找站点集合的 URL，您可以使用 Sites.RootWebId 加入 Webs，并使用 Webs.FullUrl。

例如：

```
select SiteID=Sites.ID
    , RootWebId=Sites.RootWebId
    , RootWebURL = Webs.FullUrl
from Sites 
    inner join Webs on Sites.RootWebId = Webs.Id 
```

# wpf - 让窗口滚动

> ID：12810319
> 
> 赞同：-1
> 
> 时间：2012-10-10T00:30:26.067
> 
> 标签：wpf, xaml

我希望窗口根据内容的大小而不是窗口的大小滚动。目前，只有当窗口高度小于 XAML 中的指定高度时，才会出现滚动条。这是 XAML 代码。基于此处的其他线程，我尝试了各种方法，例如将 ScrollViewer 包装在网格中。

```
<Window.Resources>
    <src:ObservableSwitches x:Key="Switches"/>
        <Style TargetType="{x:Type TreeViewItem}" x:Key="ModuleStyle">
        <Setter Property="Foreground" Value="Blue"/>
        <Setter Property="FontSize" Value="12"/>
    </Style>

    <Style TargetType="{x:Type TreeViewItem}" x:Key="RedModuleStyle" BasedOn="{StaticResource ModuleStyle}">
        <Setter Property="Foreground" Value="Red"/>
    </Style>

</Window.Resources>

<ScrollViewer IsEnabled="True" VerticalScrollBarVisibility="Visible">

    <Grid Margin="0,0,-211.4,-168">
    <StackPanel HorizontalAlignment="Stretch" Name="StackPanel1" VerticalAlignment="Stretch" Width="Auto" Margin="0,0,188.6,114">

        <StackPanel.Resources> 
            <Style TargetType="{x:Type Label}" x:Key="LabelStyle">
                <Setter Property="Foreground" Value="Blue"/>
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="FontWeight" Value="Bold"/>
            </Style>
        </StackPanel.Resources>

            <Label Content="Switch Name:" Name="Label1" Height="25" HorizontalAlignment="Left"/>

            <Label Content="Software Version:" Name="Label2" HorizontalAlignment="Left" />
        <Label Content="Model Number:" Name="Label3" HorizontalAlignment="left"/>
        <Label Content="IP Address:" Name="Label4" HorizontalAlignment="left"></Label>
        <Label Content="Serial Number:" Name="Label5" HorizontalAlignment="Left"></Label>
        <Label Content="Show Tech Taken:" Name="Label6" HorizontalAlignment="left"/>

    </StackPanel>
    <StackPanel Margin="105,0,218,489">
        <StackPanel.Resources>
            <Style TargetType="{x:Type Label}" x:Key="LabelStyle">
                <Setter Property="FontSize" Value="12"/>
                <Setter Property="FontWeight" Value="Bold"/>
            </Style>
        </StackPanel.Resources>
        <Label Content="{Binding switchName}"  Name="SwitchNameLabel" HorizontalAlignment="left" />
        <Label Content="{Binding swVersion}" Name="VersionLabel" HorizontalAlignment="left"/>
        <Label Content="{Binding switchModel}" Name="ModelNumberLabel" HorizontalAlignment="Left"/>
        <Label Content="{Binding IPAddress}" Name="IPAddressLabel" HorizontalAlignment="Left"/>
        <Label Content="{Binding SerialNumber}" Name="SerialLabel" HorizontalAlignment="Left"/>
        <Label Content="{Binding LastDataCaptureDate}" Name="ShowTechLabel" HorizontalAlignment="Left"/>

    </StackPanel>

    <StackPanel Name="ContentPanel" HorizontalAlignment="Left" Height="Auto" Margin="0,185,0,0" VerticalAlignment="Top" Width="auto"
                  ScrollViewer.VerticalScrollBarVisibility="Auto">
        <TreeView Name="ModulesTreeView" Height="auto" Background="GhostWhite" BorderThickness="0" Width="auto"/>
        <TreeView Name="VSANTreeView"  Height="auto" Background="GhostWhite" BorderThickness="0" Width="auto"/>
        <TreeView Name="FCIPTreeView"   MaxHeight="200" Background="GhostWhite" BorderThickness="0" Width="auto" 
                    ScrollViewer.VerticalScrollBarVisibility="Auto"/>
        <TreeView Name="IVRTreeView" Height="Auto" Background="GhostWhite" BorderThickness="0" Width="Auto"
                  ScrollViewer.VerticalScrollBarVisibility="Auto">

            <TreeViewItem Name="IVRTreeViewItem" Header="IVR Topology" Height="Auto" Background="GhostWhite" BorderThickness="0" Width="Auto">

                <TreeViewItem Name="NatEnabled" Header="NAT Enabled" Background="GhostWhite" BorderThickness="0" Width="Auto">
                <Label Name="NATLabel" Background="GhostWhite" BorderThickness="0" Width="Auto"></Label>

                </TreeViewItem>
            <TreeViewItem Name="Status" Header="Status" Background="GhostWhite" BorderThickness="0" Width="Auto">
                <Label Name="StatusLabel" Background="GhostWhite" BorderThickness="0" Width="Auto"></Label>

            </TreeViewItem>
            <TreeViewItem Name="FabricDistributionEnabled" Header="Fabric Distribution" Background="GhostWhite" BorderThickness="0" Width="Auto">
                <Label Name="FabricDistributionLabel" Background="GhostWhite" BorderThickness="0" Width="Auto"></Label>

            </TreeViewItem>
            <TreeViewItem Name="AFID" Header="AFID Listing" Background="GhostWhite" BorderThickness="0" Width="Auto">
                <ListView Name="AFIDListView" >

                </ListView>
            </TreeViewItem>
            </TreeViewItem>
        </TreeView>

    </StackPanel>
</Grid>
</ScrollViewer> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T01:08:44.587

您在内部网格中没有外部网格和多个堆栈面板。回到基础。带有一个 ScrollViewer 和一个 StackPanel 的网格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T16:28:02.570

我发现如果我将 ScrollViwer 包装在 ScrollViwer 中，而不是将 ScrollViewer 放在 Grid 中，我可以在 Grid 中拥有我想要的任何东西，并且 Window 仍然可以正常滚动。

# validation - 更改 h:message JSF 标准错误消息

> ID：12810329
> 
> 赞同：1
> 
> 时间：2012-10-10T00:31:32.687
> 
> 标签：validation, jsf, jsf-2

我们正在尝试将标记输出的标准 JSF 错误消息更改为不包含元素的 JSF 呈现 ID。例如：

> j_id1840598516_6db54dbe:terms: 验证错误：值是必需的。

看起来像：

> 条款：验证错误：值是必需的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T14:18:44.653

使用`UIInput`组件的`label`属性。例如

```
<h:inputText ... label="terms" /> 
```

# html - 我如何居中

> ID：12810332
> 
> 赞同：0
> 
> 时间：2012-10-10T00:31:52.577
> 
> 标签：html, css, position, alignment, center

这让我很沮丧......我正在尝试做一些看起来像这样的东西：

```
 Logo

img|h1|img 
```

围绕字幕的图像只是看起来像这样的水平线

--- 副标题 ---

这是HTML：

```
<div>
     <a href="#">
     <img class="logo" src="#" alt="..."/></a>
 </div>
 <div class="subtitle">
     <img class="1" src="#" width="60" height="1" alt="..."/>
     <h1>subtitle text</h1>
     <img class="2" src="#" width="60" height="1" alt="..."/>
 </div> 
```

我尝试将元素放在另一个 div 中并定义宽度：%; 对于那个 div 的 margin:0 auto; 但问题在于，如果用户在浏览器中增加其文本大小，则正确的图像会移动到下一行。

任何帮助都会很棒。谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:37:08.113

您可以使用`display: inline`and`white-space: nowrap`来完成此操作：

```
.subtitle {
    text-align: center;
    white-space: nowrap;
}
.subtitle h1 {
    display: inline;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:38:20.463

尝试将内联 img 标签放在块 h1 元素中，然后设置 H1 标签的样式，如下所示：

CSS：

```
h1{
 width: 100px; /* whatever width you prefer*/
 text-align: center;
} 
```

html:

```
 <h1>
    <img class="1" src="#" width="60" height="1" alt="..."/>
    subtitle text
    <img class="2" src="#" width="60" height="1" alt="..."/>
 </h1> 
```

示例： http: [//jsfiddle.net/sujvM/](http://jsfiddle.net/sujvM/) 注意*：出于某种原因，您需要单击运行按钮才能在 jsfiddle 中加载图像。

# visual-studio - Visual Studio 缺少用户界面位

> ID：12810338
> 
> 赞同：0
> 
> 时间：2012-10-10T00:33:18.803
> 
> 标签：visual-studio, visual-studio-2012, orchardcms

我使用 orchard 的 codegen 制作了一个样板模块。这创建了一个带有 MVC3 格式的样板文件和文件夹的 csproj。

然而，Visual Studio 没有 MVC 项目附带的 UI 助手（例如添加控制器）。

如何更改项目设置以恢复漂亮的 MVC UI？

普通 MVC 项目： ![普通的MVC项目](../Images/c0ae91abc680542a3310356146c2934b.png)

果园样板项目： ![果园样板项目](../Images/ae4c01406a57bbf07abfcb6471a3d8c6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T02:11:44.247

在这里回答：[https ://stackoverflow.com/a/4610008/828859](https://stackoverflow.com/a/4610008/828859)

需要更改 csproj 文件中的这一行

```
<ProjectTypeGuids>{E53F8FEA-EAE0-44A6-8774-FFD645390401};{349c5851-65df-11da-9384-00065b846f21};{fae04ec0-301f-11d3-bf4b-00c04f79efbc}</ProjectTypeGuids> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:59:17.770

这是一个常见问题解答。这些项目未设置为 MVC，因此即使盒子上未安装 MVC，该解决方案也可以打开并工作。这是删除一个先决条件。您可以通过编辑 csproj 文件并添加项目类型来获得额外的工具。查看 MVC 项目以发现差异。

# c++ - ubuntu中的g ++编译错误

> ID：12810339
> 
> 赞同：2
> 
> 时间：2012-10-10T00:33:43.527
> 
> 标签：c++, gcc, ubuntu, permissions, g++

每次我尝试使用 g++ 在 ubuntu 中编译时，都会出现以下错误

```
g++ test.cpp -o test
/usr/bin/ld: 1: /usr/bin/ld: /bin: Permission denied
/usr/bin/ld: 2: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 3: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 4: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 5: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 6: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 7: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 8: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 9: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 10: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 11: /usr/bin/ld: test.cpp: not found
/usr/bin/ld: 12: /usr/bin/ld: Syntax error: "(" unexpected 
```

我已经多次删除并重新安装了 g++。/usr/bin 和 /usr/bin/ld 的 chmod 是 755，奇怪的是我可以运行它`g++ -c test.cpp`但是我不能运行 .o 文件。我不完全确定是什么问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T00:38:30.080

首先，.o 文件并不意味着运行，它意味着与其他目标文件 (.o) 和库（特别是 C++ 和 C 标准库）链接在一起。但是，我从您的错误消息中猜测这可能行不通。

从您的错误消息看来，您可能正在`/bin`目录中运行此命令。这是不恰当的。您应该在您具有写入权限的某个目录中运行它（例如您的主目录）。此外它告诉你它找不到你的 test.cpp 文件，你确定你已经`cd`进入了正确的目录吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T05:42:01.440

首先，`g++ -c test.cpp`只编译或汇编源代码，不要链接。最终输出是一个目标文件。在你的情况下这是 .o 文件。您无法运行 .o 文件。

如上所述，`g++ -c test.cpp`只需忽略链接部分，因此`ld`不会使用，这就是为什么`g++ -c test.cpp`适合您。

您可以切换到root用户并`g++ test.cpp -o test`再次运行。如果它有效，您可能会遇到权限问题`/usr/bin`或`/usr/bin/ld`

# mysql - 在 MYSQL 的子查询中使用 LIMIT 关键字的替代方法

> ID：12810346
> 
> 赞同：32
> 
> 时间：2012-10-10T00:34:51.683
> 
> 标签：mysql, sql, database

我有一个包含以下列的表 TEST ：

```
code_ver (VARCHAR)
suite (VARCHAR)
date (DATE) 
```

现在我想选择不同值为 c 的 10 行`ode_ver & code_ver NOT LIKE '%DevBld%' sorted by date desc.`

所以我写了以下查询：

```
select * 
  from test 
 where code_ver IN (select DISTINCT code_ver 
                      from test 
                     where code_ver NOT LIKE '%DevBld%' 
                     ORDER by date DESC LIMIT 10); 
```

理想情况下，这个查询应该可以工作，但我的 MySQL 版本说：

> 这个版本的 MySQL 还不支持 'LIMIT & IN/ALL/ANY/SOME 子查询'

有人可以建议我替代此查询吗？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2016-04-20T11:28:39.987

Layke 提出的答案在我的范围内是错误的。在子查询中使用限制的意图是使主查询在从子查询中获取的有限记录上运行。如果我们将限制保持在外部，那么限制对子查询毫无用处。

由于 mysql 尚不支持子查询限制，因此您可以使用 JOIN，如下所示：

```
 SELECT * FROM test
    JOIN 
    (
        SELECT DISTINCT code_ver 
        FROM test 
        WHERE code_ver NOT LIKE '%DevBld%' 
        ORDER BY date DESC LIMIT 10
    ) d
    ON test.code_ver
    IN (d.code_ver)
    ORDER BY xyz; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2018-08-16T12:58:12.177

您也可以使用相同的查询，只需在子查询之前添加一层额外的选择。就是这样。它会起作用的。

```
select * from test 
where code_ver IN (select * from (select DISTINCT code_ver 
                      from test 
                     where code_ver NOT LIKE '%DevBld%' 
                     ORDER by date DESC LIMIT 10) as t1); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-10T00:38:56.113

将子查询放在派生表中：

```
 SELECT test.*
     FROM test
LEFT JOIN (SELECT DISTINCT code_ver
             FROM mastertest
            WHERE code_ver NOT LIKE '%DevBld%'
            ORDER BY `date` DESC
            LIMIT 10) d
    USING (code_ver)
    WHERE d.code_ver IS NOT NULL; 
```

（当然，您也可以 RIGHT JOIN 并删除外部 WHERE 条件。）

* * *

## 回答 #4

> 赞同：-14
> 
> 时间：2012-10-10T04:14:25.560

您得到的错误不完全是因为 MySQL 的版本。我认为所有版本都支持这一点。您必须更改 LIMIT 10 位置并将其放在“）”之后。请让我知道这对你有没有用。我在我的身上运行了波纹管，它可以工作。

例如

```
SELECT * FROM test where name IN (
           SELECT DISTINCT name 
           FROM projects 
           WHERE name NOT LIKE "%DevBld%"  
           ORDER by date_created DESC
 ) LIMIT 10; 
```

更新：试试下面的一个，这样顺序就可以了：

```
 SELECT * FROM  automation.e2e_projects WHERE name IN (
       SELECT DISTINCT name 
       FROM automation.e2e_projects
       WHERE name NOT LIKE "%DevBld%"
 ) ORDER by date_created DESC LIMIT 10; 
```

# php - 使用 foreach 的结果

> ID：12810347
> 
> 赞同：0
> 
> 时间：2012-10-10T00:34:53.263
> 
> 标签：php, mysql, foreach

我的代码中有一个 foreach 循环，根据该 foreach 的结果，它将重定向到另一个页面。以下是我的代码的一部分。我也想在下一页中使用变量 $email_number。有什么办法可以将此电子邮件号码带到其他页面。

```
foreach($result as $email_number) {
    $header = imap_headerinfo($connection, $email_number);
    $fromaddr = $header->from[0]->mailbox . "@" . $header->from[0]->host;
    $query = "select * from usergroup where email='$fromaddr'";

    while($line=mysql_fetch_array(mysql_query($query);,MYSQL_ASSOC)){

     $email=$line['email'];
     $group=$line['group'];
    if($group == 1){
         header("Location: facilitator.php");
         }

         else {
             header("Location: new.php");
             }
    } 
```

# sas - 合并 SAS 中的所有记录

> ID：12810349
> 
> 赞同：2
> 
> 时间：2012-10-10T00:35:25.410
> 
> 标签：sas

我有两个数据集。`Table1`只有一个记录。`Table2`有很多记录。我想将这些组合起来，以便将变量 from`Table1`添加到`Table2`.

我知道这可以这样做`proc sql`：

```
proc sql;
 create table3 as
  select *
  from table1, table2;
quit; 
```

我想要相同的结果，但使用数据步骤。做到这一点的最佳（优雅、高效）方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T00:39:23.933

```
data table3;
if _n_ = 1 then set table1;
set table2;
run; 
```

这是最简单的方法。

# ios - 使用 [FBSession openActiveSessionWithPublishPermissions: ..] 时出错

> ID：12810353
> 
> 赞同：6
> 
> 时间：2012-10-10T00:35:56.283
> 
> 标签：ios, facebook-ios-sdk

我正在更新一个应用程序以使用最新的 Facebook SDK 以获得对 iOS6 原生 Facebook 支持的访问权限。它目前使用的是相当旧的 Facebook SDK 版本。

该应用程序需要 Facebook 的“publish_actions”许可才能对 Facebook 进行唯一的操作。

我最初以为我可以使用`[FBSession openActiveSessionWithPublishPermissions: ...]`，但是当用户在 iOS6 设置中配置 Facebook 时，这在 iOS6 上失败了。由于此要求，它失败了，[来自 Facebook 文档](https://developers.facebook.com/docs/howtos/ios-6/)：

> 请注意，要使用 iOS 6 原生身份验证，应用程序需要更改它们向用户请求权限的方式 - 应用程序必须将它们对读取和写入权限的请求分开。适用于 iOS 的 Facebook SDK 支持这些功能，并帮助开发人员使用它们来构建适用于多个 iOS 版本和设备配置的应用程序。

这是一个很大的 PITA，IMO。我们的偏好是提示用户一次获得许可并完成它，但 Apple / Facebook 的“新”理想是在需要但尚未授予时在上下文中提示特定权限。

目前的计划是为 iOS5 用户和未在“设置”中配置 Facebook 的 iOS6 用户保留我们的旧行为。并符合使用本机访问的 iOS6 用户的新双提示。

**问题是，最好的方法是什么？** 我应该如何检测 Facebook SDK 是否会选择 iOS6 本机登录与回退机制？我是否忽略了一些明显的东西？

**编辑：**

gerraldWilliam 让我走上了正轨。他的解决方案几乎可以工作，除了 ACAccountTypeIdentifierFacebook 在 iOS5 中不可用。此外，如果用户在设置中阻止 FB 访问应用程序，则 accountsWithAccountType 调用将返回一个空数组。

可以通过询问帐户类型匹配标识符“com.apple.facebook”来解决第一个问题——这将在 iOS5 上返回 nil，在 iOS6 上返回一个真实的帐户类型对象。

但是第二个问题是无法解决的。我的新计划是始终以只读权限在 iOS6 上打开初始会话，然后在需要时根据上下文提示发布权限。在 iOS5 上，我仍然会打开指定所需的 publish_actions 权限的初始会话。这是代码：

```
ACAccountStore* as = [[ACAccountStore new] autorelease]; 
ACAccountType* at = [as accountTypeWithAccountTypeIdentifier: @"com.apple.facebook"]; 
if ( at != nil ) {
    // iOS6+, call  [FBSession openActiveSessionWithReadPermissions: ...]

} else  {
    // iOS5, call [FBSession openActiveSessionWithPublishPermissions: ...] 
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T13:37:08.560

根据我在 Facebook 的开发者网站上阅读的所有内容（这有点矛盾），“仅发布”应用程序的工作流程并不是他们考虑太多的事情，Apple/iOS 似乎完全无视。

Facebook 在[您引用的文档](https://developers.facebook.com/docs/howtos/ios-6/)中提供了一些指导：

> 技巧 5：禁用本机登录对话框
> 
> 在某些情况下，应用程序可能会选择禁用本机登录对话框以使用新版本的 Facebook SDK，但避免重写它们向用户请求权限的方式。要使用之前的快速应用切换行为进行登录，请使用已弃用的 FBSession 方法 openActiveSessionWithPermissions 和 reauthorizeWithPermissions。

这是我目前正在遵循的路线。略有不同，但总体效果相同。

```
if (FBSession.activeSession.isOpen  == NO) {
    // This will bypass the ios6 integration since it does not allow for a session to be opened
    // with publish only permissions!
    FBSession* sess = [[FBSession alloc] initWithPermissions:[NSArray arrayWithObject:@"publish_actions"]];
    [FBSession setActiveSession:sess];
    [sess openWithBehavior:(FBSessionLoginBehaviorWithFallbackToWebView) completionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
        [self onSessionStateChange:session
                          andState:status
                          andError:error];
    }]; 
```

结果是，该应用程序将始终绕过 IOS6 集成进行登录以进行发布，并且在大多数情况下（因为用户通常已经在手机上安装了 Facebook）切换到 Facebook 应用程序以获得单一的身份验证批准。

如果用户选择使用他们的 Facebook 帐户登录我们的应用程序，我会调用`openActiveSessionWithReadPermissions`，如果存在，它将使用 IOS6 Facebook 集成。如果他们随后决定分享，我会打电话给他们，如果有的话，他们`reauthorizeWithPublishPermissions`也会使用 IOS6 集成。

鉴于可用的文档最少且令人困惑，我无法确定这是否是解决此问题的“正确”方法，但它似乎有效。您可以对 IOS5 或 IOS6 应用程序使用相同的代码，因为它只通过 Facebook SDK 进行调用。它还尊重 Facebook 现在正在推广的同一请求中的不混合读取/发布权限。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-10T03:36:00.247

```
ACAccountStore *store = [[ACAccountStore alloc] init];

ACAccountType *accountType  = [store accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook];
NSArray *accounts = [store accountsWithAccountType:accountType];
NSLog(@"accounts:%@", accounts); 
```

如果accounts 为nil（或者它可能返回一个空数组，我不确定），那么用户没有在iOS6 中配置Facebook。您可以对此进行测试，如果该值表明 Facebook 尚未针对 iOS6 进行配置，则可以调用您的回退机制。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-19T02:14:53.923

而不是使用以下内容：

```
NSArray *readPermissions = [[NSArray alloc]         initWithObjects:@"email",@"friends_location",@"status_update",@"publish_actions",nil];
[FBSession openActiveSessionWithPublishPermissions:readPermissions defaultAudience:FBSessionDefaultAudienceEveryone allowLoginUI:YES completionHandler:^(FBSession *session, FBSessionState state, NSError *error) {
//Your code here for handling forward things;
} 
```

使用此代码：

```
NSArray *readPermissions = [[NSArray alloc] initWithObjects:@"email",@"friends_location",@"status_update",@"publish_actions",nil];
FBSession* sess = [[FBSession alloc] initWithPermissions:[NSArray arrayWithObject:readPermissions]];
[FBSession setActiveSession:sess];
[sess openWithBehavior:(FBSessionLoginBehaviorWithFallbackToWebView) completionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
    [self onSessionStateChange:session
                      andState:status
                      andError:error];

//Your code here for handling forward things;

}]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T09:35:24.773

对不起，但对我来说，在 ios6 行

```
ACAccountType* at = [as accountTypeWithAccountTypeIdentifier: @"com.apple.facebook"]; 
```

即使用户没有配置帐户也不返回 nil...

这意味着您可以检查用户的 ios 版本是什么（5 或 6）

```
NSString *currSysVer = [[UIDevice currentDevice] systemVersion]; 
```

[此链接](http://www.makebetterthings.com/iphone/check-ios-version-and-write-conditional-code/)可能会有所帮助。

# python - Xpath 选择多个类

> ID：12810355
> 
> 赞同：0
> 
> 时间：2012-10-10T00:36:23.107
> 
> 标签：python, html, xpath, html-parsing, lxml

```
<div class="one">
    <a class="two" href="Something..."><img src="http://..."/></a>
    <p> stuff.... </p>
    <p><img src="http://....." /></p>
</div> 
```

我有一个我正在解析的愚蠢的 HTML，你可以看到有一个名为 one 的主类*和*另一个嵌套的名为*two*的主类。我正在尝试解析第一类中的所有图像*，*但显然我拥有的 XPath 只捕获一张图像，这是来自第一类的*图像*

我试过这个：

```
//div[@class="one"]/img | //a[@class="two"]/img 
```

但显然我没有从二班赶上*，*但只有从一班*才能*做到这一点？

我正在使用 lxml.html 的 xpath 功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:37:54.083

试试这个`Xpath`表达式：

```
//div[@class="one"]//img 
```

测试 ：

```
xmllint --html --xpath '//div[@class="one"]//img' \
    'http://sputnick-area.net/ftp/downloads/testSO.html' 
```

**输出**

```
<img src="http://...">
<img src="http://....."> 
```

# jquery - 如何让 jQuery 幻灯片在鼠标悬停时暂停？

> ID：12810356
> 
> 赞同：3
> 
> 时间：2012-10-10T00:36:25.057
> 
> 标签：jquery, slideshow

这是下面的代码...

```
var currentImage;

var currentIndex = -1;

var interval;function showImage(index){if(index < $('#bigPic img').length){    

var indexImage = $('#bigPic img')[index]

            if(currentImage){   

            if(currentImage != indexImage ){

                    $(currentImage).css('z-index',2);

                    clearTimeout(myTimer);

                    $(currentImage).fadeOut(600, function() {myTimer = setTimeout("showNext()", 10000);$(this).css({'display':'none','z-index':1})});

                }
            }
            $(indexImage).css({'display':'block', 'opacity':1});

            currentImage = indexImage;

            currentIndex = index;

            $('#thumbs li').removeClass('active');

            $($('#thumbs li')[index]).addClass('active');

        }

    }

    function showNext(){
        var len = $('#bigPic img').length;
        var next = currentIndex < (len-1) ? currentIndex + 1 : 0;
        showImage(next);
    }

    var myTimer;

    $(document).ready(function() {myTimer = setTimeout("showNext()", 14000);showNext(); //loads first image

        $('#thumbs li').bind('click',function(e){

        var count = $(this).attr('rel');

        showImage(parseInt(count)-1);

        });}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:33:42.410

我在jsfiddle上放了一个简单的例子。下次别忘了上传你的样式和html代码。（我随机生成）

[http://jsfiddle.net/ppFrE/14/](http://jsfiddle.net/ppFrE/14/)

```
<div id="bigPic">
<img src="http://www.google.com/logos/2012/uganda12-hp.jpg">
<img src="http://www.google.com/logos/2012/janusz-korczak-2012-hp.jpg">
<img src="http://www.google.com/logos/2012/Brazil_Elections-2012-hp.jpg">
</div>
<ul id="thumbs">
    <li><img src="http://www.google.com/logos/2012/uganda12-hp.jpg"></li>
    <li><img src="http://www.google.com/logos/2012/janusz-korczak-2012-hp.jpg"></li>
    <li><img src="http://www.google.com/logos/2012/Brazil_Elections-2012-hp.jpg"></li>
</ul>​ 
```

这是一个完整的 Javascript 代码。

```
var currentImage;
var currentIndex = -1;
var interval;
var myTimer;
var hover = false;

function showImage(index) {
    if (index < $('#bigPic img').length) {
        var indexImage = $('#bigPic img')[index]
        if (currentImage) {
            if (currentImage != indexImage) {
                $(currentImage).css('z-index', 2);
                clearTimeout(myTimer);
                $(currentImage).fadeOut(600, function() {
                    if (!hover) myTimer = setTimeout(showNext, 1000);
                    $(this).css({
                        'display': 'none',
                        'z-index': 1
                    })
                });
            }
        }
        $(indexImage).css({
            'display': 'block',
            'opacity': 1
        });
        currentImage = indexImage;
        currentIndex = index;
        $('#thumbs li').removeClass('active');
        $($('#thumbs li')[index]).addClass('active');
    }
}

function showNext() {
    var len = $('#bigPic img').length;
    var next = currentIndex < (len - 1) ? currentIndex + 1 : 0;
    showImage(next);
}

$(document).ready(function() {
    myTimer = setTimeout(showNext, 1000);
    showNext(); //loads first image
    $('#thumbs li').bind('click', function(e) {
        var count = $(this).attr('rel');
        showImage(parseInt(count) - 1);
    });
    $('#bigPic img').hover(function() { 
        hover = true;
        clearTimeout(myTimer); 
    }, function() {
        myTimer = setTimeout(showNext, 1000);
        hover = false;
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T00:45:37.953

在 $(document).ready 事件上添加悬停以在鼠标悬停时停止计时器并在鼠标离开时重新启动计时器。

```
$('#thumbs li').hover(function() { 
    clearTimeout(myTimer); 
    }, function() {
    myTimer = setTimeout("showNext()", 14000);
    }); 
```

# iphone - iPad：如何在不更换后退按钮的情况下向导航栏添加标签？

> ID：12810360
> 
> 赞同：0
> 
> 时间：2012-10-10T00:36:52.023
> 
> 标签：iphone, ios, ipad

如何向导航栏添加与 titleView 文本具有相同字体和颜色的标签？这是我想要实现的目标的 Photoshop 模型...

![在此处输入图像描述](../Images/04bc574b304281fec4d6ed2af2be2429.png)

我正在使用情节提要，所以我尝试使用 Interface Builder 将 UIView 添加到导航栏的我想要的位置（靠近后退按钮），然后将 UILabel 添加到该视图中。这种方法有两个问题。首先，它使后退按钮消失了。其次，字体和颜色与 titleView 文本不同，很难让它们看起来相同。

如何使用 Interface Builder 或代码向导航栏添加标签（上面用红色圈出）而不在运行时替换后退按钮？

非常感谢您的智慧！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:45:50.173

尽管您要实现的目标看起来非常奇怪，但如果使用 a`UISplitController`不是您想要做的，那么我现在唯一能想到的其他方法就是使用 a`UIView`作为栏的 titleView，将其宽度设置为覆盖大多数的酒吧。

然后`UILabel`在左边使用一个，并将一个放在中间。您应该使左侧标签文本左对齐，并且“中心”标签与栏的宽度相同，文本将其对齐到中心。

这个“可能”重叠，但在你的情况下似乎不会。

至于字体，这通常是深灰色，浅灰色阴影偏移为 -1 像素（向上），水平方向为零。我相信字体是 17 号的系统粗体。

# javascript - “concat”不会将 JavaScript 数组连接在一起？

> ID：12810366
> 
> 赞同：13
> 
> 时间：2012-10-10T00:37:35.160
> 
> 标签：javascript, arrays

我在 Webkit 上运行以下代码：

```
var scriptElements = document.scripts;
var scriptUrls = [];
// URL matching
var regexp = /\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/i;
for (var i = 0; i < scriptElements.length; i++) {
    element = scriptElements[i];
    var urls = element.innerHTML.match(regexp);
    console.log('local', urls);
    scriptUrls.concat(urls);
    console.log('global', scriptUrls);
} 
```

我看到在“本地”之后打印了非空数组，但“全局”始终保持为空数组。这是怎么回事？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-10-10T00:38:31.673

`.concat`创建一个新数组。您需要覆盖旧的。

```
scriptUrls = scriptUrls.concat(urls); 
```

* * *

或者，如果您想保留原始`scriptUrls`数组，您可以`.push()`将值放入。

```
scriptUrls.push.apply(scriptUrls, urls); 
```

这用于`.apply()`转换`urls`为传递给的单个参数`.push()`。这样，内容`urls`将`scriptUrls`作为单独的项目添加。

* * *

另外，请注意，这会使数组`.concat()` *变平。*如果你想要一个数组数组，那么你会使用`scriptUrls.push(urls)`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T00:42:07.120

> concat 不会更改此数组或作为参数提供的任何数组，而是返回“一层深”副本，其中包含从原始数组组合的相同元素的副本。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/concat](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/concat)

# testing - 错误页面在哪里？

> ID：12810367
> 
> 赞同：1
> 
> 时间：2012-10-10T00:37:38.093
> 
> 标签：testing, grails, webdriver, functional-testing

[https://bitbucket.org/refactor/grails-webdriver/wiki/Home](https://bitbucket.org/refactor/grails-webdriver/wiki/Home)说如下：

> 如果发生任何故障，则保存当前 HTML 并链接到故障

我无法在任何地方看到保存的 HTML。谁能告诉我它在哪里？

> 该应用程序正在真正运行，并且测试通过真实（或模拟）Web 浏览器的 UI 与其交互，就像真实用户一样

按照我的阅读方式，我应该能够看到浏览器正在执行测试步骤。那是对的吗？如果是，我如何让浏览器打开？

编辑：

我正在尝试这个插件： http: [//grails.org/plugin/geb](http://grails.org/plugin/geb)使用这个示例项目：[https ://github.com/geb/geb-example-grails](https://github.com/geb/geb-example-grails)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T13:05:41.013

*   如果您为真正的浏览器使用正确的 WebDriver，您将能够看到浏览器正常工作，例如 FireFoxDriver；如果你使用 HtmlUnitDriver 你什么都看不到；它是一个只存在于内存中的虚拟浏览器。
*   只能使用支持 TakesScreenshot 接口的 WebDriver 进行截图；HtmlUnitDriver 没有。
*   // 作为“grails -Dgeb.env=firefox test-app”运行</li>
*   // 参见：[http ://code.google.com/p/selenium/wiki/FirefoxDriver](http://code.google.com/p/selenium/wiki/FirefoxDriver)
*   在 Windows 7 上，请确保不要混淆 32/64 位 Program Files (86x) 文件夹。

# python - python创建套接字未接收

> ID：12810382
> 
> 赞同：0
> 
> 时间：2012-10-10T00:39:07.517
> 
> 标签：python, sockets, connect

我有一个 IP = '127.0.0.1'，端口号 'port'，并尝试

```
class AClass(asyncore.dispatcher):
     def __init__(self, ip, port):        
        asyncore.dispatcher.__init__(self)
        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)        
        self.connect((ip, port))

    def handle_connect(self):
        print 'connected'   

    def handle_read(self):        
        data = self.recv(8192)
        print data   

    def handle_close(self):
        self.close() 
```

但是什么都没有打印出来。

发送正在由另一个进程处理。我该如何检查？以上正确吗？

编辑：发送：一个不同的python程序，单独运行：

```
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((addr, port))
packet="some string"
sock.sendall(packet+'\r\n') 
```

没发生什么事

如果我把，在服务器端（!!!）`print sock.recv(4096)`我看到打印的数据包 - 但客户端仍然没有任何反应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T08:34:09.977

我假设您的意思`AClass`是成为服务器端。在那种情况下，*不*`AClass`应该做一个. 套接字通信有两个方面。在服务器端，您通常创建套接字，将其绑定到地址和端口，设置积压（通过）和连接。通常，当您有来自客户端的新连接时，您会生成一些其他实体来处理该客户端。*`connect()``listen()``accept()`*

 *这段代码实现了一个回显服务器：

```
import asyncore
import socket

class EchoHandler(asyncore.dispatcher_with_send):
    def handle_read(self):
        self.out_buffer = self.recv(1024)
        if not self.out_buffer:
            self.close()
        print "server:", repr(self.out_buffer)

    def handle_close(self):
        self.close()

class EchoServer(asyncore.dispatcher):
    def __init__(self, ip, port):
        asyncore.dispatcher.__init__(self)
        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)
        self.set_reuse_addr()
        self.bind((ip, port))
        self.listen(1)

    def handle_accept(self):
        sock, addr = self.accept()

        print "Connection from", addr

        EchoHandler(sock)

s = EchoServer('127.0.0.1', 21345)
asyncore.loop() 
```

请注意，在该`__init__()`方法中，我绑定了套接字，并设置了积压工作。 `handle_accept()`是什么处理新的传入连接。在这种情况下，我们从 获取新的套接字对象和返回的地址`accept()`，并为该连接创建一个新的异步处理程序（我们将套接字提供给`EchoHandler`）。 `EchoHandler`然后从套接字读取数据，然后将该数据放入`out_buffer`. `asyncore.dispatcher_with_send`然后会注意到数据已准备好发送并将其写入我们后台的套接字，然后将其发送回客户端。所以我们有双方，我们已经从客户端读取数据，然后转身将相同的数据发送回服务器。

您可以通过多种方式检查此实现。这是一些用于打开连接、发送消息、读取响应和退出的 python 代码：

```
client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((ip, port))
client.sendall("Hello world!\r\n")
print "client:", repr(client.recv(1024))
client.close() 
```

`telnet localhost 21345`对于本示例，您也可以使用命令 telnet 作为您的客户端。输入一个字符串，按回车键，服务器将发送回该字符串。这是我做的一个示例会话：

```
:: telnet 127.0.0.1 21345
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
Hello!
Hello!
aouaoeu aoeu aoeu
aouaoeu aoeu aoeu
^]
telnet> quit
Connection closed. 
```

在示例中，第一个“Hello！” 是我在客户端输入的，第二个是来自服务器的回声。然后我尝试了另一个字符串，它也被回显了。

如果你以前没有做过套接字通信，我真的不能推荐 Richard Stevens [UNIX Network Programming](http://www.kohala.com/start/unpv12e.html)。第 3 版现已印刷并在[亚马逊](https://rads.stackoverflow.com/amzn/click/com/0131411551)上提供。但是，它不包括使用 Python 或 asyncore。而且，不幸的是，asyncore 是一个在 Python 文档中并没有很好地涵盖的模块。不过，在野外有一些相当不错的例子。

希望这能让你朝着正确的方向前进。

**编辑**：这是一个基于异步的客户端：

```
class Client(asyncore.dispatcher_with_send):
    def __init__(self, ip, port, message):
        asyncore.dispatcher_with_send.__init__(self)
        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)
        self.connect((ip, port))
        self.out_buffer = message

    def handle_connect(self):
        print 'connected'

    def handle_read(self):
        data = self.recv(8192)
        print "client:", repr(data)

    def handle_close(self):
        self.close() 
```*

# c# - 如何告诉 EF Code First Migration 系统数据库已更新

> ID：12810384
> 
> 赞同：0
> 
> 时间：2012-10-10T00:39:36.410
> 
> 标签：c#, entity-framework-4, entity-framework-migrations

以下是我多次经历的事件顺序：

*   手动向数据库添加列
*   向 DbContext 添加与该列对应的属性
*   生成迁移（因此可以签入并且其他开发人员可以更新他们的数据库）

现在我处于无法使用上下文的状态，因为它给出了需要更新的错误。

但是，由于库已经存在（重复列），更新会导致错误。

那么我只是从根本上“做错了”还是包管理器中有一些命令说“我手动更新了我的数据库并且它现在是最新的”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:55:50.053

发生的事情是 EF 还不知道您的迁移已被应用。

我所做的是在包管理器控制台中输入：

```
update-database -v -f -script 
```

生成迁移脚本 - 然后我复制生成的 sql 中的最后一行，将数据添加到 __MigrationHistory 表中，然后手动执行。它看起来像这样：

![在此处输入图像描述](../Images/d3651ed6ff9d3438abdd07b03375fd8f.png)

这应该将您的代码与数据库同步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T00:37:42.850

为防止这种情况一次又一次地出现，您不应在数据库中手动添加该列，而应使用 update-database 对其进行更新。

正确的步骤应该是：

*   向 DbContext 添加与该列对应的属性
*   生成迁移
*   运行更新数据库

# android - 网页内容消失

> ID：12810387
> 
> 赞同：1
> 
> 时间：2012-10-10T00:39:52.793
> 
> 标签：android, webpage

我正在尝试获取此网页的内容：[http ://www.tisseo.fr/calculateur?o_p=saint+sernin&dpt=&dac=0&destination_class_filter=&d_p=saint+michel&apt=&arrival_class_filter=&dy=2012-10-11&sh=02&sm =15&tm=17451448556060676&op=%3E%3E+Rechercher](http://www.tisseo.fr/calculateur?o_p=saint+sernin&dpt=&dac=0&destination_class_filter=&d_p=saint+michel&apt=&arrival_class_filter=&dy=2012-10-11&sh=02&sm=15&tm=17451448556060676&op=%3E%3E+Rechercher)

您可以在源代码中看到有一个名为“row_1”的元素......

但是，当我在我的代码中这样做时：

```
reader = new BufferedReader(new InputStreamReader(connection.getInputStream()));

while((nextLine = reader.readLine()) != null) {
    buffer.append(nextLine.trim());
    Log.i("content", ""+nextLine.trim());
} 
```

只显示网页的开头和结尾！而且我想得到的元素不存在……但是为什么呢？我不明白。

知道如何获取“row_1”的内容吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T10:25:53.237

您不必尝试解析此网页。此页面可能会在没有警告的情况下更改。

如果您对网站的请求过多，您可能会被驱逐，您的 Android 应用程序将停止工作。

而是使用 opendata Tisséo API：[https ://data.toulouse-metropole.fr/explore/dataset/api-temps-reel-tisseo/](https://data.toulouse-metropole.fr/explore/dataset/api-temps-reel-tisseo/)

Journey Planner 目前不可用，但它将可用。（我在天梭工作）

**编辑：自 2014 年 10 月以来**

Journey Planner 现在可通过 Tisséo API 获得

# cocos2d-iphone - cocos2d-iphone 动作被正在进行的操作打断

> ID：12810390
> 
> 赞同：0
> 
> 时间：2012-10-10T00:40:27.143
> 
> 标签：cocos2d-iphone, action, nsthread

我想运行一个动作并同时继续处理游戏逻辑，但是当过程进行时动作被中断。我尝试使用线程，但无法使其工作。当不需要处理游戏逻辑时，精灵会按照我的预期移动，但是当需要在动作期间进行一些操作时，动作会在操作期间被中断。操作结束后，动作继续进行。我究竟做错了什么？

我按如下方式调用选择器 - 选择器启动操作。

```
[NSThread detachNewThreadSelector:@selector(moveSprite:)
                         toTarget:self
                       withObject:[NSDictionary dictionaryWithObjectsAndKeys:
                                                   sprite, @"sprite",
                                                   [NSValue valueWithCGPoint:pos], @"pos",
                                                   nil]];

-(void) moveSprite: (NSDictionary*) parameters {
    CCSprite *sprite = [parameters objectForKey:@"sprite"];
    CGPoint pos = [[parameters objectForKey:@"pos"] CGPointValue];
    id actionMove = [CCMoveTo actionWithDuration:0.4f position:pos];
    id actionMoveDone = [CCCallFuncND actionWithTarget:self selector:@selector(removeSprite:data:) data:(__bridge void*)sprite];
    [sprite runAction:[CCSequence actions:actionMove, actionMoveDone, nil]];
} 
```

动作结束后，我通过以下方法删除精灵。

```
-(void) removeSprite: (id)sender data:(void*)data {
    CCSprite *sprite = (__bridge CCSprite*)data;
    [self removeChild:sprite cleanup:YES];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T08:41:10.383

首先，在单独的线程中创建操作是没有意义的。动作被添加到节点，并且节点及其动作在主线程上更新。

您还应该知道，只有当设备具有两个或更多 CPU 内核时，线程才会对您有所帮助*。*在单核设备（iPhone 4 或更早版本、iPod Touch 4 或更早版本、iPad 1）上运行执行繁重操作的单独线程如果不停止主线程，仍会减慢速度。

如果您的游戏逻辑过于繁重以至于它实际上会*停止*屏幕更新，那么您需要优化您正在做的任何事情。您可以将计算分布在多个帧中，配置文件以查看是否可以优化，或者您是否使用蛮力方法研究更聪明、不那么直接但更快的算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T05:27:42.940

Cocos2d在主线程上运行，你的繁重操作也在主线程上运行，所以你遇到的情况很正常。

您应该使操作更轻松，或者使用线程，因此您的 CCActions 代码不是您应该寻找的，因为您知道它可以在没有代价高昂的操作的情况下正常工作

# c++ - MPI - 异步广播/收集

> ID：12810391
> 
> 赞同：6
> 
> 时间：2012-10-10T00:40:52.473
> 
> 标签：c++, process, mpi

我有一个项目需要“n”个进程才能工作，直到问题得到解决。每个从属进程执行相同的代码。当出现某种情况时，该进程需要以非阻塞的方式通知所有其他进程。其他进程也需要以非阻塞方式接收此消息。

有没有办法不用线程单独循环？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T01:14:41.930

自从我使用 MPI 以来已经有一段时间了。但是*I*函数是非阻塞的。也许是这样的：

```
int comm_size = comm.Get_size();
int comm_rank = comm.Get_rank();

int* data = new int[comm_size];

while (some_condition)
{
    //During each iteration, check for messages from other nodes
    for (int node = 0; node < comm_size; node++)
    {
        if (node != comm_rank)
        {
            if (comm.Iprobe(node, TAG_NUM))
            {
                comm.Irecv(data[node], 1, MPI_INT, node, TAG_NUM);
            }
        }
    }

    if (some_other_condition)
    {
        //Send the message to every node
        for (int node = 0; node < comm_size; node++)
        {
            if (node != comm_rank)
            {
                comm.Isend(data[node], 1, MPI_INT, node, TAG_NUM);
            }
        }
    }

    //do normal work here.
}

delete [] data; 
```

# windows - Grails - 奇怪的 JRE 错误 - 内部错误 (os_windows_x86.cpp:149)

> ID：12810394
> 
> 赞同：1
> 
> 时间：2012-10-10T00:41:09.353
> 
> 标签：windows, grails, runtime-error, java

我对 Grails 非常陌生，但是我在进行中型应用程序开发时学习。

到现在为止，我对 Grails 非常热情，而且它在开发过程中是多么容易和快速 - 到现在 :)

我有一个包含 40 多个属性的域类。我在开发环境（Windows 7 上的标准 glassfish + H2）和我的服务器上使用 Tomcat + PostgreSQL 在 Debian 上本地运行它，并且在两个环境中一切都顺利且相同（在 H2 和 PostgreSQL 中的 save() 后刷新略有不同）。我又添加了一个属性，在我的开发环境中，我得到了一些奇怪的 JRE 错误（当我用谷歌搜索它时，它与本机方法异常处理有关）。应用程序启动良好，我可以从代码级别向此类添加新对象，我可以在其他相关类中使用 toString 方法显示它们，但是一旦我转到特定实例的标准显示视图，我就会得到错误。日志如下：

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  Internal Error (os_windows_x86.cpp:149), pid=10776, tid=4684
#  guarantee(result == EXCEPTION_CONTINUE_EXECUTION) failed: Unexpected result from topLevelExceptionFilter
#
# JRE version: 7.0_07-b11
# Java VM: Java HotSpot(TM) 64-Bit Server VM (23.3-b01 mixed mode windows-amd64 compressed oops)
# Failed to write core dump. Minidumps are not enabled by default on client versions of Windows
#
# If you would like to submit a bug report, please visit:
#   http://bugreport.sun.com/bugreport/crash.jsp 
# 
```

无论我添加什么样的新属性（即使是最简单的 int），无论我是否使用脚手架，我都会收到此错误......似乎再添加一个属性会导致某些东西超过某个阈值并引发异常JRE 处理不当的本机 C++ 代码，我不知道问题出在哪里。有时我没有收到错误，但 CPU 发疯了，浏览器正在等待服务器永远响应显示视图。

更奇怪的是，当我对 Tomcat 进行刺激战时，一切都按预期顺利运行......

任何人都经历过类似的问题或有什么建议和在哪里检查以解决问题？在生产环境的开发过程中测试应用程序非常不舒服......

# udp - windows xp vs 7，UDP接受规则有什么区别

> ID：12810395
> 
> 赞同：1
> 
> 时间：2012-10-10T00:41:21.943
> 
> 标签：udp, port, rtp, rule, iocp

当我收到一个 UDP 数据包（尤其是 rtp）时，我有一个不同的现象。它是由 Windows 7 Professional K 的 Windows 版本不同而发生的。

UDP 数据包在我的电脑上没有打开 udp 端口​​的情况下正常发送（我在wireshark 上看到过），但是在 Windows XP SP3 上，UDP 数据包在没有打开 udp 端口​​的情况下不会发送。

恰好一半的数据包正常到达，但其余的数据包没有到达。所以，我的电脑制作了一个 ICMP 类型 3（无法访问的端口错误）数据包并发送它。

我想知道有什么不同，具体来说。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:46:06.040

如果您正在“在线”运行 Wireshark（通常是您运行它的方式），则无论本地防火墙设置和端口是否打开，您都应该看到所有数据包（UDP/TCP/w/e else）。如您所见，如果端口未打开，您的计算机将响应一个 ICMP 数据包，告诉源它无法在该端口上通信。然后你不太可能看到来自那台机器的更多数据包，因为试图通信的程序已被告知你不会接受该端口上的通信。但是，无论操作系统如何，在发送 ICMP 数据包之前，源无法知道端口是否打开，因此即使相应端口打开，您也应该看到 UDP 数据包。

可能发生的事情是 RTP 库注意到您的机器不接受数据包并停止发送它们。我的猜测是您启动了应用程序/服务，然后启动了 Wireshark，此时 ICMP 数据包已经被发回。发送应用程序/服务缓存您的计算机不会接收此类数据包并停止发送到您的计算机的事实。特别是，这样做可能是为了防止您的机器（以及多播环境中的任何其他机器）向发送者发送 ICMP 数据包垃圾邮件。

# ruby - Ruby 链表实现#remove！做块无效

> ID：12810401
> 
> 赞同：3
> 
> 时间：2012-10-10T00:42:13.003
> 
> 标签：ruby, scope, linked-list, block

我有一个`List`用一个类实现的`Node`类。我的`#remove!`方法如下：

```
def remove!(list_item)
  find list_item do |i|
    if i == nil
      return
    else
      i.pointer = i.pointer.pointer
    end
  end
end 
```

`#find`正如我所料，返回包含搜索数据的节点之前的节点。所以我希望这会将前一个项目的指针设置为在搜索项目之后的对象，这应该从列表中删除当前项目。

我认为这与块作用域的方式有关，并且`i`传递给块并没有直接引用它应该在块中的对象，因此不能覆盖其指针的值。如何在不事先明确声明值的情况下强制此块更改此值（这违背了此块的目的）。

该`#find`方法和“#traverse”方法的行为符合预期，所以我认为这个块*必须*受到指责。我试图避免两次调用相同的函数，或者声明一个丢弃的变量，因为我对函数式编程很感兴趣并且想尝试一下。

*根据请求编辑：*

github上的[完整代码](https://github.com/robototron/linked_list/blob/master/nodes.rb)

`#find`方法_

```
def find(item_to_find, current_item = @sentinel.pointer, previous_item = @sentinel)
  if current_item == @sentinel then puts "not found"; return nil end
  if current_item.datum == item_to_find
    return previous_item
  else
    find item_to_find, current_item.pointer, current_item
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T08:09:08.653

您的`find`方法从不调用块，它不会将它存储在任何地方，它不会将它传递给另一个方法，它根本不会对块做任何事情。它只是忽略它。因此，你的`remove!`方法真的只是

```
def remove!(list_item)
  find list_item
end 
```

# vb6 - 在 vb 6 中延迟不休眠

> ID：12810402
> 
> 赞同：1
> 
> 时间：2012-10-10T00:42:14.223
> 
> 标签：vb6, logic, delay, delayed-execution

我在visual basic6中有一个要求，我想向连接到我的PC的机器发送命令。我只有在得到它的确认后才能发送命令。就像这样。发送第一个命令后睡眠将使程序处于非活动状态，并且我无法收到确认。

所以我正在考虑在后续模块中使用变量或标志并增加延迟。但我不确定如何实现这件事。我为此包含了示例相当不完整的代码。但我不知道它是如何延迟的。我在考虑计时器，转到。有没有其他方法可以在这里实现延迟。

我发送命令的模块

//发送模块

```
Sendcommand()

Send command CMD1.
If (flagcheck =2)
Send command CMD2. 
```

我收到确认命令的模块

```
Receive command()

Select cmdname
public flagcheck=0
CASE ACK1.1
        flagcheck=flagcheck+1
CASE ACK1.2
        flagcheck=flagcheck+1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T00:49:02.600

你通常可以做类似的事情

```
SendCommandOne

While flag = 0 ' ReceiveCommand would set flag to 1
    DoEvents
End While

SendCommandTwo 
```

ETC

# ios - OpenCV 将颜色设置为前景标记的像素 GC_PR_FGD

> ID：12810405
> 
> 赞同：0
> 
> 时间：2012-10-10T00:42:25.793
> 
> 标签：ios, image-processing, opencv, pixels, foreground

我使用 cv::grabCut 从图像中提取对象。它运行良好。

现在我将对象放在一个没有背景的单独垫子中，我想为整个对象设置黑色。我想为所有标有 GC_PR_FGD（前景像素）的像素设置黑色。

我怎样才能做到这一点？

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T04:22:13.943

从[cv::grabCut 文档](http://opencv.willowgarage.com/documentation/cpp/imgproc_miscellaneous_image_transformations.html#cv-grabcut)中，您似乎可以获得具有以下值的掩码作为输出：

*   GC_BGD 当然是背景像素
*   GC_FGD 当然是前景（对象）像素
*   GC_PR_BGD 可能是背景像素
*   GC_PR_FGD 可能是前景像素

我假设您想要一张背景为白色，前景为黑色的图像。在这种情况下，您可以创建一个新矩阵，并在遍历掩码像素时，根据掩码像素值为该矩阵分配 0 或 1（或 255）。

例如，假设您已经得到 a`cv::Mat mask`作为算法的结果，请执行以下操作（警告，我尚未编译，它是近似值）：

```
cv::Mat binaryImage = zeros(mask.rows, mask.cols, CV_8U);

for (int i==0; i<mask.rows; ++i){
    for (int j==0; j<mask.cols; ++j){
        // choose pixels that are certainly or likely background
        if (mask.at<uchar>(i,j) == GC_BGD || mask.at<uchar>(i,j) == GC_BGD){
            binaryImage.at<uchar>(i,j) = 255;
        }
    }
} 
```

# android - 暂停执行微调器的 onItemSelected

> ID：12810408
> 
> 赞同：0
> 
> 时间：2012-10-10T00:43:18.717
> 
> 标签：android, android-spinner

**当我使用setSelection(position)**时，如何停止微调器的 onItemSelected 事件。

 **我正在寻找一个干净的解决方案。

谢谢**

# sql - 在访问中加入语法

> ID：12810409
> 
> 赞同：5
> 
> 时间：2012-10-10T00:43:38.380
> 
> 标签：sql, ms-access, join

我正在使用访问，我有两个表：

观点：

```
id,x,y
1 32432432 143423232
2 32432443 143423300 
```

线：

```
id startPoint endPoint
1  1          2 
```

现在，当我查询该行时，我希望返回的表将同时包含 startPoint 和 endPoint 的 x、y。

我试过加入：

```
select line.*,point.x as x1,point.y as y1 from line as line join point as point on line.startPoint=point.id where line.id=1; 
```

然后我可以得到以下仅包含 startPoint 的结果。

```
id startPoint endPoint x1 y1
1  1          2        ...... 
```

那么当我想要这样的结果时如何检索endPoint（x2 y2是endPoint的坐标）：

```
id startPoint endPoint x1 y1 x2 y2
1  1          2        ...... 
```

我尝试了两个`join`，但它不起作用。

```
select line.*,point1.x as x1,point1.y as y1,point2.x as x2,point.y as y2 from line as line left join point1 as point on line.startPoint=point1.id  left join point as point2 on line.endPoint=point2.id where line.id=1; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T00:47:25.510

Access 对多个连接有奇怪的语法规则。您必须像这样将它们放在括号中。

```
select line.*, point1.x as x1,point1.y as y1,
    point2.x as x2, point.y as y2
from (line as line
left join point as point1
on line.startPoint = point1.id)
left join point as point2
on line.endPoint = point2.id
where line.id = 1; 
```

每个额外的连接都需要在第一个表之前有另一个左括号，在倒数第二个连接之后需要一个右括号。

# objective-c - 如何使用 UITabBarController 解决 iOS 6 中的方向问题？

> ID：12810411
> 
> 赞同：0
> 
> 时间：2012-10-10T00:43:41.727
> 
> 标签：objective-c, uitabbarcontroller, ios6

在我的应用程序中，我有一个横向视图控制器，只要设备处于横向模式，它就应该被调用，这很好。但问题是当我旋转回纵向时，它就搞砸了。我在我的 App 委托中这样做：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{ 

    [NSThread sleepForTimeInterval:1.5];
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    self.window.autoresizingMask = (UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight);

    // Override point for customization after application launch.
    UIViewController *viewController1, *viewController2, *viewController3, *viewController4, *viewController5;

    UIImage * logoImage = [UIImage imageNamed:NAVIGATION_LOGO_IMAGE];
    self.navController.navigationItem.titleView = [[UIImageView alloc] initWithImage:logoImage];
    self.navController.navigationItem.titleView.frame = CGRectMake(340,0 , 450, 55);

    // Create initialized instance of UITabBarController
    tabController = [[UITabBarController alloc] init];
    NSMutableArray *tabs = [[NSMutableArray alloc] init];
    // Create first UIViewController
    viewController1 = [[FirstViewController alloc] initWithNibName:@"FirstViewController_iPhone" bundle:nil];
    [viewController1 setTitle:@"Home"];
    navController = [[UINavigationController alloc] initWithRootViewController:viewController1];
    navController.navigationBar.tintColor = [UIColor blackColor];
    [tabs addObject:navController];

   viewController2 = [[TwitterDataLoad alloc] initWithNibName:@"TwitterDataLoad" bundle:nil];
     //viewController2 = [[TwitterDataController alloc] initWithNibName:@"SecondViewController_iPhone" bundle:nil];
    [viewController2 setTitle:@"News"];
    navController = [[UINavigationController alloc] initWithRootViewController:viewController2];
     navController.navigationBar.tintColor = [UIColor blackColor];
    [tabs addObject:navController];

    viewController3 = [[ThirdViewController alloc] initWithNibName:@"ThirdViewController" bundle:nil];
    [viewController3 setTitle:@"Music"];
    navController = [[UINavigationController alloc] initWithRootViewController:viewController3];
     navController.navigationBar.tintColor = [UIColor blackColor];
    [tabs addObject:navController];

    viewController4 = [[ThumbNailViewController alloc] initWithNibName:@"ThumbNailViewController" bundle:nil];
    [viewController4 setTitle:@"Gallery"];
    navController = [[UINavigationController alloc] initWithRootViewController:viewController4];
     navController.navigationBar.tintColor = [UIColor blackColor];
    [tabs addObject:navController];

    viewController5 = [[FifthViewController alloc] initWithNibName:@"FifthViewController" bundle:nil];
    [viewController5 setTitle:@"Shows"];
    navController = [[UINavigationController alloc] initWithRootViewController:viewController5];
     navController.navigationBar.tintColor = [UIColor blackColor];
    [tabs addObject:navController];

    landscapeVC = [[LandscapeAboutViewController alloc] initWithNibName:@"LandscapeAboutViewController" bundle:nil];
    infamous = [[InfamousViewController alloc]initWithNibName:@"InfamousViewController" bundle:nil];
    NSArray *versionCompatibility = [[UIDevice currentDevice].systemVersion componentsSeparatedByString:@"."];

    if ( 5 == [[versionCompatibility objectAtIndex:0] intValue] ) 
    {
        [[UITabBar appearance]setTintColor:[UIColor blackColor]];
        [[UITabBar appearance]setSelectedImageTintColor:[UIColor whiteColor]];
    }
    NSUserDefaults * defaults = [NSUserDefaults standardUserDefaults];
    NSString * popUpShown = [defaults objectForKey:@"PopUpShown"];

    if (![popUpShown isEqualToString:@"yes"]) {

        [self showAlertView];
    }

    [tabController setViewControllers:tabs];

    self.window.rootViewController = tabController;
    [self.window makeKeyAndVisible];

    [[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(didRotate:)
                                                 name:UIDeviceOrientationDidChangeNotification object:nil];

    return YES;
}

- (void) didRotate:(NSNotification *)notification
{   
    UIDeviceOrientation orientation = [[UIDevice currentDevice] orientation];
    if (UIDeviceOrientationIsLandscape(orientation)) {
        if (self.window.rootViewController != landscapeVC) {
            [[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationNone];
            //[[UIApplication sharedApplication] setStatusBarOrientation:UIDeviceOrientationIsLandscape(orientation)];
            [self switchToLandScape];

        }

    }
    else if (UIDeviceOrientationIsPortrait(orientation)){
        if (self.window.rootViewController != tabController) {
            [[UIApplication sharedApplication] setStatusBarHidden:NO withAnimation:UIStatusBarAnimationNone];
            [[UIApplication sharedApplication] setStatusBarOrientation:UIDeviceOrientationIsPortrait(orientation)];

            [self switchToTabBar];

        }
    }
}

- (void)switchToTabBar {

    self.window.rootViewController = tabController;
}

- (void)switchToLandScape {

    self.window.rootViewController = landscapeVC;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T05:14:37.147

尝试继承 UITabBarController 并在该子类中实现新的 iOS 6 旋转委托方法。然后使用该子类作为您的根视图控制器，以便在 iOS 6 下更好地控制旋转。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T05:25:54.547

在您的标签栏控制器子类中指定：

```
- (NSUInteger)supportedInterfaceOrientations{
    return UIInterfaceOrientationMaskLandscape;
} 
```

另一种选择是将其放置在导航控制器子类中，然后将特定于景观的视图控制器嵌入该导航控制器中。

# listview - Java Fx 2：在 ListView 中刷新项目颜色

> ID：12810413
> 
> 赞同：0
> 
> 时间：2012-10-10T00:43:48.880
> 
> 标签：listview, cell, javafx-2

帮助！我想不通这个。我正在尝试制作一个 ListView，当用户单击它时，文本项的颜色会发生变化。与超链接指示它们是否已被访问的方式相同。

我编写了一个自定义的 Cell Factory 来执行此操作，问题是当我单击一个项目时没有调用 Cell 工厂。

我试图通过实际更改项目的 VALUE 来解决此问题，以便调用单元工厂，但是，问题出在：如果我从我设置的 ChangeListener 中更改 VALUE 以监视用户是否单击在一个新项目上，它会再次调用我的 ChangeListener，然后它变成一个无限循环。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:07:47.780

您可以将鼠标侦听器添加到您的单元工厂并从中更改颜色。

# java - 在杰克逊生成的json中包装协议缓冲区时java中的错误？

> ID：12810414
> 
> 赞同：1
> 
> 时间：2012-10-10T00:43:52.803
> 
> 标签：java, jackson, protocol-buffers

我通过执行以下操作发送和接收 HTTP 发布请求：

```
FooJson fooJson = new FooJson();
fooJson.setName("Bob");

FooProto.Builder fooProto = FooProto.newBuilder(); // google protobuf
fooProto.setColor("Blue");
fooProto.setLength(30);

BarProto.Builder barProto = BarProto.newBuilder();
barProto.setWeight(65);
fooProto.setBarProto(barProto);

barJson.setFooProto(new String(fooProto.build().toByteArray()));
List<BarJson> barJsonList = new ArrayList<BarJson>();
barJsonList.add(barJson);
fooJson.setBarJsonList(barJsonList);
String data = writeJson(fooJson); // wrapper for jackson JsonGenerator
RequestEntity re = new ByteArrayRequestEntity(data.getBytes());

PostMethod method = new PostMethod("http://foo.net:123/path");
method.setRequestEntity(re);
httpClient.executeMethod(method); 
```

在接收端，我解析以下内容：

```
FooJson fooJson = readJson(request.getInputStream(), FooJson.class);
for (BarJson barJson : fooJson.getBarJsonList()) {
    FooProto fooProto = FooProto.parseFrom(barJson.getFooProto().getBytes());
} 
```

在接收端解析protocol buffer的结果是：

```
com.google.protobuf.InvalidProtocolBufferException: While parsing a protocol message, the input ended unexpectedly in the middle of a field.  This could mean either than the input has been truncated or that an embedded message misreported its own length. 
```

我将协议缓冲区转换为字符串的方式有问题吗？我怎么能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T00:50:42.600

我怀疑您是否可以通过 JSON 可靠地隧道 protobuf（其有效负载是纯二进制，而不是文本），而无需进行某种类型的编码，例如 base64 或十六进制编码。将您的 protobuf 有效负载从字节转换为 base64 文本。然后在接收端将其从 base64 文本转换回二进制。

您收到 protobuf 异常，因为接收端的字节数组与您发送的 protobuf 有效负载不匹配。当您在不使用某种编码的情况下转换为字符串并返回时，数据会被处理掉。

javax.xml.bind.DatatypeConverter 我运气不错。它是 Java 1.6 的一部分。在发送端使用 printBase64Binary，在接收端使用 parseBase64Binary。

[更新]

或者，如果 base64 太难看，您可以使用[protobuf-java-format](http://code.google.com/p/protobuf-java-format/)将您的 protobuf 对象序列化为几种不同的字符串格式（JSON、XML） 。这可能看起来有点奇怪，因为 barJson.setFooProto 将包含一个字符串，该字符串本身就是一个 JSON 有效负载。会有很多转义的引号字符 - 但它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T05:54:36.290

你的错误在这里：

```
barJson.setFooProto(new String(fooProto.build().toByteArray())); 
```

不要尝试从任意二进制数据创建字符串——这很可能会破坏数据，具体取决于使用的编码；特别是对于 JSON，UTF-8 编码几乎可以保证损坏（UTF-8 中不允许某些字节序列，因此您要么得到异常，要么数据发生突变）。

相反，将字段定义为`byte[]`，并让 Jackson 使用 Base64 编码。这将是正确的，并且相对有效。

正如第一个答案所建议的那样，您可能还想考虑只对整个事情使用 JSON。也不需要使用特定的 Protobuf 风味；如果你真的需要它们，你总是可以单独构造 PB 对象。

# ruby-on-rails - 我不确定发生了什么。我的路线疯了吗？

> ID：12810418
> 
> 赞同：0
> 
> 时间：2012-10-10T00:44:32.560
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

这些是我路线的一部分。

```
 activity_groups GET    /activity_groups(.:format)                                activity_groups#index
                           POST   /activity_groups(.:format)                                activity_groups#create
        new_activity_group GET    /activity_groups/new(.:format)                            activity_groups#new
       edit_activity_group GET    /activity_groups/:id/edit(.:format)                       activity_groups#edit
            activity_group GET    /activity_groups/:id(.:format)                            activity_groups#show
                           PUT    /activity_groups/:id(.:format)                            activity_groups#update
                           DELETE /activity_groups/:id(.:format)                            activity_groups#destroy
                      root        /                                                         main#index 
```

最小视图：

**活动组/显示**

```
%h2 Activity Ggroup

%h3= @activity_group.title

= link_to "Edit", edit_activity_group_path(@activity_group)
|
= link_to "Delete", activity_group_path(@activity_group), {confirm: (I18n.t "confirmations.activity_group.delete"), method: :delete}
|
= link_to "Back", activity_groups_path 
```

索引有点复杂：

**活动组/索引**

```
.row
    .span8
        %h1.padding_bottom1 Activity Groups

        - if !@activity_groups.empty?

            %ul.span6
                %li.span1 F
                %li.span2 Name
                %li.span2 Actions

            = render @activity_groups
            = render @activities
        - else
            %h2.extra_padding You have no Activity Groups yet. Add one and start managing your time. 

    .span6.padding_top1
        =link_to "Create Activity Group", new_activity_group_path, {class: 'btn'}
        =link_to "Create Activity", new_activity_path, {class: 'btn'} 
```

**activity_groups/_activity_group.html.haml**

```
%ul.span6
    %li.span1
        %i.icon-folder-close.folder
    %li.span2
        = activity_group.title
    %li.span2
        PROBLEM

    - if !activity_group.activity_groups.empty?
        - activity_group.activity_groups.each do |activity_group|
            = render partial: 'activity_group', locals: {activity_group: activity_group}

    - if !activity_group.activities.empty?
        - activity_group.activities.each do |activity|
            = render partial: 'activities/activity', locals: {activity: activity} 
```

**问题**如果我放在`link_to "Show", activity_groups_path(activity_group)`这里，我的路线会发疯。我的 activity_groups_path 不见了。我不能再访问它了。它试图将我重定向到显示视图而不是索引视图。我真的不明白为什么会这样。有任何想法吗？

**[编辑1]**

我从一个干净的数据库开始。如果我现在尝试为显示页面放置一个链接，我会得到一个 NameError `undefined local variable or method`activity_group_path'`

**[EDIT2]**更正了上面的拼写错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:02:26.570

您是否将对象传递给您的链接路径？

```
activity_group_path(@activity_group) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:16:47.077

你提到你在`activity_groups_path(activity_group)`上面使用过 - 这应该是`activity_group_path(activity_group)`（组而不是组）。可能是 /an/ 问题，但可能不是唯一的问题。（也许不是唯一的，听起来像您对相同部分的递归调用并将子 activity_groups 传递为 :local 最终可能会使用无效的活动组对象调用路由。只是预感）

顺便说一句，我在 Rails 路线上度过了许多类似的沮丧时光，它总是归结为我所做的一些愚蠢的事情（尽管语法也是罪魁祸首，它只是英语的一个糟糕的近似值）。休息一下，吃点东西，打个盹……那时可能很明显。

# javascript - 从任何 Facebook 用户那里获取图片

> ID：12810422
> 
> 赞同：0
> 
> 时间：2012-10-10T00:45:03.873
> 
> 标签：javascript, facebook, photo, image

我已经开发了一个 javascript 代码来获取任何 Facebook 用户的图片。我创建了一个 javascript 函数来生成它与照片路径连接的随机链接。然后显示照片。示例： [https ://fbcdn-sphotos-fa.akamaihd.net/hphotos-ak-ash3/548339_10151989882013306_1841267774_n.jpg](https://fbcdn-sphotos-f-a.akamaihd.net/hphotos-ak-ash3/548339_10151989882013306_1841267774_n.jpg)

* * *

```
<html> <head> 
<title>get Facebook Picture </title>
<script type="text/javascript">
function getRandomLink()
{ var c = "123456789";
var link = ''; 
for(var i = 0; i <6; i++)
{ link +=c.charAt(Math.floor(Math.random() * c.length)); 
var d= "1234567890";
var link2 = '';
for(var j = 0; j <9; j++) 
{ 
link2 = link2+d.charAt(Math.floor(Math.random() * d.length)); 
}
var e = "1234567890";
var link3 = '';
for(var k = 0; k <12; k++) 
{ 
link3 = link3+e.charAt(Math.floor(Math.random() * e.length)); 
}

}

linker=link+'_'+link2+'_'+link3;
return linker; 
} 
for(var i = 0; i <1000; i++)
{ var randomLink = getRandomLink();
document.write('processing picture....https://fbcdn-sphotos-c-a.akamaihd.net/hphotos-ak-ash3/'+randomLink+'_n.jpg<br/><a href="https://fbcdn-sphotos-c-a.akamaihd.net/hphotos-ak-ash3/'+randomLink+'_n.jpg"><img src="https://fbcdn-sphotos-c-a.akamaihd.net/hphotos-ak-ash3/'+randomLink+'_n.jpg"></a><br /><br />'); } </script>
</head> 
<body> 
<h1>my by ALon$0</h1>
</body> 
</html>` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:07:45.347

首先，我认为你试图与人们分享你的代码，你应该看看 github.com。

其次，您的代码不起作用，因为它只是生成损坏的图像 url 并且没有显示真实图像，所以老实说它没有用。

这是一个更简单更好的版本：

```
function getId(length) { 
    var num = "111234567890";
    var idLength = length;
    var id = ''; 
    for(var i = 0; i <idLength; i++) { 
        id +=num.charAt(Math.floor(Math.random() * num.length)); 
    }
    return id; 
} 
for(var i = 0; i <10; i++)
{ 
    var randomId = getId(4);
    document.write('Image for UID: ' + randomId +'<br><a href="https://graph.facebook.com/'+randomId +'/picture?type=large" target="_blank"><img src="https://graph.facebook.com/'+randomId +'/picture?type=large"></a><br /><br />');

}​ 
```

​</p>

这是一个工作演示：http: [//jsfiddle.net/KSf9L/](http://jsfiddle.net/KSf9L/)

# php - 快速执行许多 PHP 页面数组的最快方法？

> ID：12810423
> 
> 赞同：2
> 
> 时间：2012-10-10T00:45:28.583
> 
> 标签：php, jquery

执行许多 PHP 页面的最快方法是什么。我不需要查看它们（即从任何输出的 html 中抓取或保留任何信息），但它们需要加载。需要执行每个页面中的 PHP 代码。

我刚开始做`foreach (...){echo <iframe src=....`（*非常丑陋，花了**很**长时间和非常糟糕的主意*）

现在我正在考虑设置一个 jquery 计时器来继续加载 ajax 请求并通过一个数组。

有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:49:16.253

您可以执行以下操作：

```
<?php

$pages = array();

$pages[] = 'page1.php';
$pages[] = 'page2.php';
$pages[] = 'page3.php';
$pages[] = 'page4.php';
$pages[] = 'page5.php';

foreach($pages as $page):
    include $page;
endforeach;
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:01:05.430

好吧，尽管与我的理解差异很小，但 foreach 是最慢的循环类型。你真正的问题是 iframe 他们是出了名的慢。你应该做的是一个 include(); 或要求（）；甚至 require_once();

```
$pages = array();
$pages[] = "Page1.php";
$pages[] = "Page2.php";
$pages[] = "Page3.php";
foreach($pages as $page)
{
require($page);
} 
```

避免使用 iframe，因为我相信它们实际上计划放弃对它们的支持。如果您需要它们出现某种风格或样式，只需使用 CSS 将它们定位为您在使用 iframe 时的位置，但在其位置使用 div。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T01:10:19.487

多线程将让您尽可能快地调用 URL，因为您可以同时进行多个加载。PHP 对多线程并没有很好的支持，但我们可以让它进行多处理。这将允许您启动 URL 请求并立即启动更多请求，而无需等待任何页面加载。

以下代码是如何使用 wget 完成此操作的示例。这将很快，但确实有不让您知道成功或失败的缺点。

```
<?php
foreach($pages as $page){
    exec('/usr/bin/wget '.$page.' > /dev/null 2>&1 &');
}
?> 
```

这可以进一步调用您自己的 php 脚本而不是 wget。在这种情况下，您的程序可以记录加载失败的 url。

因此，一个完整的示例可能如下所示：

**运行.php**

```
<?php
foreach($pages as $page){
    exec('loadPage.php '.$page.' > /dev/null 2>&1 &');
}
?> 
```

**加载页面.php**

```
<?php
$handle = curl_init($url);
curl_setopt($handle,  CURLOPT_RETURNTRANSFER, TRUE);
$response = curl_exec($argv[1]);
$httpCode = curl_getinfo($handle, CURLINFO_HTTP_CODE);
if($httpdCode != '200'){
    $fp = fopen('error.log', 'w');
    fwrite($fp, 'The URL '.$url.' had an issue. It returned a '.$httpCode.' error.');
    fclose($fp);
}
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T07:32:09.693

到目前为止，最有效的事情是线程它......

[http://pthreads.org](http://pthreads.org)

[http://docs.php.net/manual/en/book.pthreads.php](http://docs.php.net/manual/en/book.pthreads.php)

[http://pecl.php.net/package/pthreads](http://pecl.php.net/package/pthreads)（不包含最新版本，如果可以的话 git）

我认为代码包含在几个页面中（我假设是本地的）的唯一原因很可能是因为这是在 PHP 中实现并发的唯一方法......如果这是正确的，那么你很可能应该将代码重写为您不再需要服务器进行并发。即使它们是不同物理机器上的外部站点，线程化请求也是要做的事情......你甚至可以

[http://pthreads.org/pool.php](http://pthreads.org/pool.php)

这太容易了

[http://pthreads.org/pool.phps](http://pthreads.org/pool.phps)

# python - python中类块和功能块的区别

> ID：12810426
> 
> 赞同：8
> 
> 时间：2012-10-10T00:45:54.557
> 
> 标签：python

### 代码 1

```
x = 0

class Foo:
    print(x)
    x = 1
    print(x)

print(x) 
```

### 结果 1

```
0
1
0 
```

* * *

### 代码 2

```
x = 0

def foo():
    print(x)
    x = 1
    print(x)

foo() 
```

### 结果 2

```
UnboundLocalError: local variable 'x' referenced before assignment. 
```

* * *

为什么可以`x`从两个命名空间中引用对象`class block`？
我不明白为什么`Code 1`不扔一个`UnboundLocalError`.
函数和类之间的不一致困扰着我。

* * *

## 更新：

多次阅读[Python 文档后，我仍然无法理解范围规则。](http://docs.python.org/py3k/reference/executionmodel.html)

> 以下是块：模块、函数体和类定义。...[跳过]...
> 
> 如果名称绑定在块中，则它是该块的局部变量，除非声明为非局部变量。如果名称绑定在模块级别，则它是一个全局变量。（模块代码块的变量是局部变量和全局变量。）如果变量在代码块中使用但没有在代码块中定义，则它是自由变量。
> 
> 如果名称绑定操作发生在代码块内的任何位置，则块内名称的所有使用都被视为对当前块的引用。如果在绑定之前在块中使用名称，这可能会导致错误。这个规则很微妙。Python 缺少声明，并允许名称绑定操作在代码块中的任何位置发生。代码块的局部变量可以通过扫描块的整个文本以进行名称绑定操作来确定。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T00:49:53.027

```
x = 0

class Foo:
    print(x)   # Foo.x isn't defined yet, so this is the global x
    x = 1      # This is referring to Foo.x
    print(x)   # So is this

print(x) 
```

* * *

```
x = 0

def foo():
    print(x)   # Even though x is not defined yet, it's known to be local
               # because of the assignment
    x = 1      # This assignment means x is local for the whole function
    print(x)

foo() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T00:52:28.100

为了使示例具有可比性，请不要忘记使用以下[`global`语句](http://docs.python.org/reference/simple_stmts.html#global)：

```
def foo():
    global x
    print(x)
    x = 1
    print(x) 
```

这样你就不会得到`UnboundLocalError`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T00:52:56.080

类块不知道“局部”变量，只知道类变量。它们与局部变量的不同之处在于它们在块执行后不会被遗忘；它们将保留为类中的字段。局部变量和类变量的处理方式不仅在这方面有所不同，因此没有引发未绑定错误也就不足为奇了。毕竟你没有一个未定义的局部变量来隐藏全局变量。因此，在定义类变量之前访问全局变量是没有问题的。

也许编译器也应该以某种方式警告这一点，但目前它没有。

# internet-explorer - Internet Explorer 和 joomla 网站

> ID：12810429
> 
> 赞同：0
> 
> 时间：2012-10-10T00:46:23.367
> 
> 标签：internet-explorer, joomla

嗨，我有一个 joomla 网站，它在除 IE 之外的所有浏览器中都能完美运行。

[www.creativeinfusion.com.au](http://www.creativeinfusion.com.au)

当我在 IE 中查看它时，很多 CSS 似乎都无法识别。当我使用开发者工具查看 html 和 css 时，与其他浏览器相比有很多不同的代码。例如，有一堆额外的`div`ID，称为`slick-unique`. 这些在其他浏览器中不可见。我想知道是否有为 IE 创建这些 ID 的插件。虽然我没找到

甚至 HTML 结构看起来也不同。在 IE中有`divs`调用`rt-hidden`，但在其他浏览器中没有。我有一个仅限 IE 的样式表，我一直在尝试覆盖或修复定位，但我没有做任何更改站点。

IE中的div也有这个代码

```
function(b,g){var h=Element.Constructors[b];if(h){return h(g);}if(typeof b!="string"){return document.id(b).set(g);}if(!g){g={};}if(!(/^[\w-]+$/).test(b)){var e=Slick.parse(b).expressions[0][0];

b=(e.tag=="*")?"div":e.tag;if(e.id&&g.id==null){g.id=e.id;}var d=e.attributes;if(d){for(var a,f=0,c=d.length;f<c;f++){a=d[f];if(g[a.key]!=null){continue;

}if(a.value!=null&&a.operator=="="){g[a.key]=a.value;}else{if(!a.value&&!a.operator){g[a.key]=true;}}}}if(e.classList&&g["class"]==null){g["class"]=e.classList.join(" ");

}}return document.newElement(b,g);} 
```

有任何想法吗？

我已将其范围缩小到模板**index.php中的这段代码：**

```
<?php 
        $browser = $gantry->browser;

        $gantry->displayHead();
        $gantry->addStyles(array('template.css','joomla.css','overlays.css'));

        if ($gantry->get('fixedheader') && $gantry->get('menu-type') != 'splicemenu') $gantry->addScript('rt-fixedheader.js');

        if ($browser->platform != 'iphone')
            $gantry->addInlineScript('window.addEvent("domready", function(){ new SmoothScroll(); });');

//      if ($gantry->get('loadtransition') && isBrowserCapable()){
//          $gantry->addScript('load-transition.js');
//          $hidden = ' class="rt-hidden"';
//      } else {
//          $hidden = '';
//      }
    ?> 
```

如果我删除该代码并刷新页面，则页面加载，显然没有 css。然后，如果我将上面的代码放回并刷新页面，页面工作正常，即使我刷新了这个页面。但是如果我尝试访问另一个页面，它会回到拥有所有额外的 div 和上面的函数代码，即使在转储缓存和刷新之后也是如此。所以似乎javascript发生了某种缓存。

还尝试关闭所有插件，但没有奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T08:42:26.217

仔细检查您是否拥有最新版本的 Gantry，并且该模板适用于您正在使用的 Joomla 版本。

Rockettheme 会定期更新他们的模板以跟上 Joomla 的变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T02:01:41.350

该主题似乎是[Rockettheme 的商业模板“Modulus”，](http://www.rockettheme.com/joomla-templates/modulus)您最好尝试他们的支持论坛来解决此类问题。我们发现他们在查明问题原因方面反应迅速。

话虽如此，我们还发现如果编写不当，第 3 方模块通常会破坏 RocketTheme 的模板。我会尝试一一关闭所有非 RocketTheme 扩展，并在关闭**每个**扩展后在 IE 中检查该站点。通过这种方式，您可能能够找到冲突（如果存在）。

# ios - UITextView 删除最后输入的文本

> ID：12810431
> 
> 赞同：0
> 
> 时间：2012-10-10T00:46:53.697
> 
> 标签：ios, nsmutablearray, uitextfield, stringwithformat

我有一个 UITextView 由 IBAction 上的几个不同 UITextFields 传递文本。

```
textView.text = [NSMutableString stringWithFormat:@"%@ %@",
textView.text,textField1.text]; 
```

我正在尝试从 TextView 中删除选定的文本

```
textField.text = [NSMutableString stringWithString:@""]; 
```

但它会删除所有文本，而不仅仅是选定的文本。

请有人给我一些指导，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:00:22.503

来自苹果文档：

> `@property(nonatomic) NSRange selectedRange`
> 
> 在 iOS 2.2 及更早版本中，选择范围的长度始终为 0，表示该选择实际上是一个插入点。在 iOS 3.0 及更高版本中，选择范围的长度可能不为零。

所以我想你应该这样做：

```
if (textField.selectedRange.location != NSNotFound && textField.selectedRange.length > 0)
    textField.text = [textField.text stringByReplacingCharactersInRange:textField.selectedRange withString:@""]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:11:56.227

您可以存储上次输入的文本（例如`theLastEnteredText`），然后从可变字符串对象（例如`theContent`）中删除它并将其设置为您的文本字段：

```
[theContent deleteCharactersInRange:NSRangeFromString(theLastEnteredText)];
textField.text = theContent; 
```

* * *

### 编辑：

如果在最后一个之前存在相同的文本内容，您将错误地删除它。所以这里有一个更好的方法：

```
// .location: theContentLength - theLastEnteredTextLength
// .lenght: theLastEnteredTextLength
NSRange range = {theContentLength - theLastEnteredTextLength, theLastEnteredTextLength};
[theContent deleteCharactersInRange:range]; 
```

# jsf - 不包括 URL 参数

> ID：12810434
> 
> 赞同：3
> 
> 时间：2012-10-10T00:47:02.700
> 
> 标签：jsf, viewparams

我有一个 JSF 页面，该页面由`test.xhtml?a=15&b=20`.

我有一个链接应该将所有 URL 参数传递到下一页。

```
<h:link outcome="index" includeViewParams="true" value="Include all url parameters" /> 
```

我期待当我点击链接时它会转到`index.xhtml?a=15&b=20`

但我在 URL 中看不到任何内容。我理解`includeViewParams`错了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T14:20:36.387

将`includeViewParams`包括所有`<f:viewParam>`值。但是，您似乎没有声明它们。

在模板客户端中相应地声明它们。

```
<f:metadata>
    <f:viewParam name="a" />
    <f:viewParam name="b" />
</f:metadata> 
```

请注意，将值绑定到 bean 属性`<f:viewParam name="a" value="#{bean.a}" />`是可选的。示例中的视图参数在 EL 范围内可用`#{a}`和`#{b}`。

### 也可以看看：

*   [<f:metadata>、<f:viewParam> 和 <f:viewAction> 可以用来做什么？](https://stackoverflow.com/questions/6377798/what-can-fmetadata-and-fviewparam-be-used-for/6377957#6377957)
*   [ViewParam 与 @ManagedProperty(value = "#{param.id}")](https://stackoverflow.com/questions/4888942/viewparam-vs-managedpropertyvalue-param-id/4889226#4889226)

# javascript - 图片库行网格javascript

> ID：12810441
> 
> 赞同：2
> 
> 时间：2012-10-10T00:48:19.893
> 
> 标签：javascript, loops, gallery

我正在尝试使用循环（从 xml 获取数据）为多个项目创建 javascript 图片库。每个项目至少 3 张图像，以两排排列。

我已经为 4 个看起来正确的图像（如下）创建了 html，但是我很难将其转换为灵活的东西。

```
<div class="project">
<div class="projectImage" id="projectImage" style="float: left;"><img src="image1.png"></div>
<div class="projectImage" id="projectImage" style="float: left; padding-left: 20px;"><img src="image2.png"></div> 
```

我越来越糊涂了。我是否需要循环内的循环来处理只需要生成一次的代码块，以及如何循环遍历 4 个以上的项目并将图像名称分成两组，如上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T04:15:42.297

当您想要一个真正灵活的网格设计时，我建议您查看 masonry jquery 插件或 wookmark jquery 插件。首先，这是一个非常新且有趣的 jquery 扩展，其次，它们还实现了 1d 装箱算法，因此它们将框堆叠在列中，每个列目标的最大框。这是自动的。起初它可能很难学习并且使用过度，但是当您熟悉它时，它可以使网格布局变得非常容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:02:06.797

最好设置margin-right。

```
<style>
.project {
    width: 200px;
}
.projectImage {
    float:left;
    margin-right: 20px;
}
</style>
...
<body>
<div class="project">
<div class="projectImage" id="img1"><img src="image1.png"></div>
<div class="projectImage" id="img2"><img src="image2.png"></div>
<div class="projectImage" id="img3"><img src="image3.png"></div>
<div class="projectImage" id="img4"><img src="image4.png"></div>
<div class="projectImage" id="img5"><img src="image5.png"></div> 
```

根据 .project 的宽度，它会很灵活。

[http://jsfiddle.net/bzykh/](http://jsfiddle.net/bzykh/)（一堆 700 宽的 Google 徽标）

[http://jsfiddle.net/bzykh/1/](http://jsfiddle.net/bzykh/1/)（一堆谷歌徽标，容器宽度为 400）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T01:13:58.907

我建议将您的顾虑分开，以一种可以理解和灵活的方式解决这个问题。

*   让您的数据定义项目和图像的组织
*   让模板引擎（[Handlebars](http://handlebarsjs.com/)）将您的数据转换为标记
*   让 CSS 处理将图像包装成行和其他位置样式

**[JSFiddle 示例](http://jsfiddle.net/YMFCA/)**

**模板：**

```
<script id="gallery-template" type="text/x-handlebars-template">
    {{#each projects}}
    <div class="project">
        <h1>{{title}}</h1>
        <ul>
            {{#each images}}
            <li><img src="{{this}}"></li>
            {{/each}}
        </ul>
    </div>
    {{/each}}
</script> 
```

**Javascript：**

```
var gallery = {
    projects: [
        {
            title: 'Gallery 1',
            images: ['http://placekitten.com/100/100', 'http://placekitten.com/100/100', 'http://placekitten.com/100/100', 'http://placekitten.com/100/100']
        },
        {
            title: 'Gallery 2',
            images: ['http://placekitten.com/100/100']
        }
    ]
};

var source   = $("#gallery-template").html();
var template = Handlebars.compile(source);
var html     = template(gallery);

$(document.body).html(html); 
```

**CSS：**

```
.project ul { overflow: hidden; }
.project ul li { float: left; }
/* break into rows of 2 */
.project ul li:nth-child(odd) { clear: both; } 
```

*编辑：我意识到这个答案可能贡献太多，但你确实在 javascript 标签上问过它，而不是 css :)*

# security - 如何验证 javascript 库？

> ID：12810443
> 
> 赞同：0
> 
> 时间：2012-10-10T00:48:26.843
> 
> 标签：security, authentication, javascript

我正在构建一个可嵌入的 javascript 库，我的用户可以将其放入他们的网络应用程序中并将其提供给访问者。

访问者可以对库进行操作，这会触发一些数据返回到我的服务器。

如何在不向访问者泄露凭据的情况下对图书馆进行身份验证？将访问控制列表锁定到域是推荐的解决方案，根本不交换凭据吗？

我在这里看了一下这个问题，它似乎被建议为一个古怪的解决方案：[如何验证/保护/验证基于 JavaScript 的 POST 请求？](https://stackoverflow.com/questions/2561999/how-can-i-validate-secure-authenticate-a-javascript-based-post-request)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T01:12:49.157

如果您查看其他 API 引擎，它们中的大多数都使用 API 密钥（例如 Google）。

我想，API 密钥只是服务器系统生成的值，它以不可逆的方式对凭证进行编码。

这与例如文档主机的域（可以通过读取请求页面时发送的主机标头的库来检索）一起可用于在您的服务器中进行身份验证。

换句话说：编码凭据（API 密钥）+ 由您的库发送到服务器的域锁定。

# spring - 使用 Spring AOP 集中日志记录

> ID：12810444
> 
> 赞同：1
> 
> 时间：2012-10-10T00:48:41.197
> 
> 标签：spring, logging, aop

我希望你们能够帮助我解决我目前面临的难题。我目前正在开发一个现有的 Web 应用程序项目，其中一个要求是我们必须集中日志记录。应用程序是一个分层的应用程序，由客户端层（即视图）、服务层、业务层和DAO 层组成。

目前，应用程序中的日志记录由控制器方法处理，其中每个需要记录一些信息的控制器方法通过调用日志记录函数手动记录数据。这些控制器方法处理的请求来自许多不同的客户端来源，包括移动设备（例如手机）、Web 浏览器、Web 服务等。目前，所有需要记录的数据都被捕获在一个通用对象中，该对象被传递给记录方法将这些属性保存到数据库表中。

问题在于，这个通用对象正是通用对象。它用于许多其他任务，包括日志记录、搜索和许多其他任务。当此通用对象用于记录时，除了几个属性外，用于填充通用对象（在记录的情况下）的大多数属性都来自请求，即（一个 HttpServletRequest 对象） . 由于这个对象的多功能性，这个通用对象有可能被滥用。因此，我们想摆脱这个通用对象并为专门的任务创建专门的对象。在日志记录的情况下，我们决定创建一个日志记录对象，我们将使用它来持久化我们需要记录的数据。我们将使用 Spring AOP 影响日志记录

难题是这个

1）我们是否应该使用控制器来设置我们想要记录的新的专用日志对象的属性，然后使用 AOP 建议，在控制器方法完成执行后检索日志对象以进行持久性

**或者**

2）我们是否应该使用我们放置在请求对象（即 HttpServletRequest 对象）中的属性在 AOP 建议中设置新日志对象的属性？

我对选项 1 的问题是控制器意识到日志记录，并且根据良好的设计原则，控制器只应该将任务委托给业务和服务层以执行此类任务。选项 1 意味着控制器所做的不仅仅是委派任务，即它将构建日志对象

我对选项 2 的问题是它将我的日志记录对象与请求对象（即 HttpServletRequest 对象）紧密结合，因此我想知道这种方法是否有任何潜力。

欢迎任何形式的建议、建议和批评。另外，如果有人不得不处理类似的情况，我想听听他们是如何解决这个问题的。

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:52:33.853

我将使用方面将日志记录添加到服务层，表示为接口。

您可以使用 HTTP 过滤器或方面从控制器层进行日志记录。

您可以根据需要在多个层中应用 AOP。

# windowbuilder - 发布版和集成版有什么区别？

> ID：12810449
> 
> 赞同：13
> 
> 时间：2012-10-10T00:49:21.040
> 
> 标签：windowbuilder

我刚刚拿到了 JDK 和 Eclipse 经典，我正在尝试找出使用哪一个来安装。eclipse.org 提供的发布版和集成版有什么区别：http: [//www.eclipse.org/windowbuilder/download.php](http://www.eclipse.org/windowbuilder/download.php)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-22T17:07:09.533

我认为这些文件是相同的，但 URL 是不同的。如果您使用 Release 版本，您将始终在 Eclipse URL 列表中拥有该特定版本的 URL，而 Integration 版本将为该特定 Eclipse 版本（例如 4.4）的所有未来版本提供单个 URL

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-15T01:49:09.483

嗯，我不确定。但我已经检查了两者的哈希（md5/sha1）是否有压缩的。并且哈希是完全一样的。例如， 3.8 ：

[http://eclipse.org/downloads/sums.php?file=/windowbuilder/WB/release/R201302221200/WB_v1.5.2_UpdateSite_for_Eclipse3.8.zip.MD5&type=md5](http://eclipse.org/downloads/sums.php?file=/windowbuilder/WB/release/R201302221200/WB_v1.5.2_UpdateSite_for_Eclipse3.8.zip.MD5&type=md5)

[http://eclipse.org/downloads/sums.php?file=/windowbuilder/WB/integration/WB_v1.5.2_UpdateSite_for_Eclipse3.8.zip.MD5&type=md5](http://eclipse.org/downloads/sums.php?file=/windowbuilder/WB/integration/WB_v1.5.2_UpdateSite_for_Eclipse3.8.zip.MD5&type=md5)

从理论上讲，它应该是同一个文件。但是，虽然我不确定...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-09T13:53:09.427

我只发现“集成版本”（39891450 字节）比“发布版本”（39759975 字节）长。

“集成版本”中每个 .jar 文件的名称包含子字符串“20141006”（例如：org.eclipse.wb.swing.FormLayout_1.7.0.r44x201410061440.jar）

“发布版本”中每个 .jar 文件的名称都包含子字符串“20140502”（例如：org.eclipse.wb.swing.FormLayout_1.7.0.r44x201405021531.jar）

链接：

集成版本： [http ://eclipse.org/downloads/download.php?file=/windowbuilder/WB/integration/WB_v1.7.0_UpdateSite_for_Eclipse4.4.zip](http://eclipse.org/downloads/download.php?file=/windowbuilder/WB/integration/WB_v1.7.0_UpdateSite_for_Eclipse4.4.zip)

发布版本： [http ://eclipse.org/downloads/download.php?file=/windowbuilder/WB/release/R201406251200/WB_v1.7.0_UpdateSite_for_Eclipse4.4.zip](http://eclipse.org/downloads/download.php?file=/windowbuilder/WB/release/R201406251200/WB_v1.7.0_UpdateSite_for_Eclipse4.4.zip)

因此，“集成版”似乎是较新的版本。

# iphone - 为 UITableView iOS 解析 Json

> ID：12810450
> 
> 赞同：0
> 
> 时间：2012-10-10T00:49:34.333
> 
> 标签：iphone, xcode, json, ios5

这是我来自网络服务的 Json 响应，我无法解析它。我想要做的是在表格视图中加载以下数据，例如。3.7 作为节标题和行中的其他值。我该怎么做？？我想使用内置 API 的无第三方框架。

任何帮助是极大的赞赏。

```
{"Links":{"3.7":[{"fld_app_download_id":"7111","fld_app_version_id":"1928","fld_date_added":"2012-10-04 08:40:38","fld_cracker":"vend3tta101","fld_download_link":"fiberupload.com","fld_url":"http:\/\/fiberupload.com\/pwzmodjshwhr\/1Password_Pro_(v3.7_v370009_Univ_os31)-vend3tta101.ipa","fld_status":"1"},{"fld_app_download_id":"7112","fld_app_version_id":"1928","fld_date_added":"2012-10-04 08:40:38","fld_cracker":"vend3tta101","fld_download_link":"depositfiles.com","fld_url":"http:\/\/depositfiles.com\/files\/eyhcw06b6","fld_status":"1"},{"fld_app_download_id":"7113","fld_app_version_id":"1928","fld_date_added":"2012-10-04 08:40:38","fld_cracker":"vend3tta101","fld_download_link":"turbobit.net","fld_url":"http:\/\/turbobit.net\/vyc5jkr5s51k.html","fld_status":"1"}]}} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:54:04.867

你看过`NSJSONSerialization`课吗？它处理 JSON 和属性列表之间的转换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:19:18.017

简单的看一下下面的代码：

```
#import "YourViewController.h"

@interface NSDictionary(JSONCategories)
+(NSDictionary*)dictionaryWithContentsOfJSONURLString:(NSString*)urlAddress;
-(NSData*)toJSON;
@end
@implementation NSDictionary(JSONCategories)
+(NSDictionary*)dictionaryWithContentsOfJSONURLString:(NSString*)urlAddress{
NSData* data = [NSData dataWithContentsOfURL: [NSURL URLWithString: urlAddress] ];
__autoreleasing NSError* error = nil;
id result = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
if (error != nil) return nil;
return result;
}
-(NSData*)toJSON{
NSError* error = nil;
id result = [NSJSONSerialization dataWithJSONObject:self options:kNilOptions error:&error];
if (error != nil) return nil;
return result;    
}
@end

@implementation YourViewController

-(IBAction)downloadData:(id)sender{

    NSString *yourResponseLink = @"YOUR RESPONSE LINK";
    NSURL *urlString = [NSURL URLWithString:urlWroteString];
    NSData* data = [NSData dataWithContentsOfURL:urlString];
    [self performSelectorOnMainThread:@selector(fetchedData:) withObject:data waitUntilDone:NO];

}

-(void)fetchedData:(NSData *)responseData {

    NSError* error;

    if (responseData == nil) {

        NSLog(@"NO DATA HAS BEEN FETCHED,ERROR = %@",error);

    }else{

        NSDictionary* json = [NSJSONSerialization JSONObjectWithData:responseData options:kNilOptions error:&error];
        NSArray *yourResponseArray = [json objectForKey:@"YOUR RESPONSE KEY"];

        NSLog("YOU RESPONSE IS = %@",yourResponseArray);

    }

}

@end 
```

要显示响应中的数据，请注意您的数据存储在 NSArray 中，因此在您的**cellForRowAtIndexPath**中，使用以下方法：

```
-(UITableViewCell *)tableView:(UITableView *)myTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

    //initialize your cells normally and to display the data from your response use
    NSDictionary *yourSpecificData = [yourResponseArray objectAtIndex:[indexPath row]];

    //and finally display some text in the cell
    cell.textLabel.text = [yourSpecificData objectForKey:@"SOME KEY FROM RESPONSE"];

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T02:39:35.133

您可以在 ios5 中使用“NSJsonSerialization”；查看代码

```
-(void) parseJsonData:(NSData *)data
{
    NSError *error;
    NSDictionary *json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
    if (json == nil) {
        NSLog(@"json parse failed \r\n");
        return;
    }
    NSArray *songArray = [json objectForKey:@"song"];
    NSLog(@"song collection: %@\r\n",songArray);

    _song = songArray;
    self.songIndex = 0;
    NSDictionary *song = [songArray objectAtIndex:0];
    NSLog(@"song info: %@\t\n",song); 
```

}

# matlab - 替换列中所有出现的值

> ID：12810452
> 
> 赞同：1
> 
> 时间：2012-10-10T00:49:52.587
> 
> 标签：matlab, octave

我需要将矩阵第一列中出现的数次 (5) 替换为 -1。我该怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-10T00:57:08.460

试试这个：

```
A(A(:,1)==5,1) = -1 
```

希望这可以帮助。

# javascript - Javascript document.write('HTML CODE HERE') 并使用 flash 抓取的 var

> ID：12810454
> 
> 赞同：2
> 
> 时间：2012-10-10T00:50:21.937
> 
> 标签：javascript, html, jwplayer, rtmp

所以这是2个问题。我的第一个问题是我该怎么做？

```
 document.write('
<div id="jwplayer">
<center>
<div id='mediaplayer'></div>
<script type="text/javascript">
  jwplayer('mediaplayer').setup({
    'flashplayer': 'jwplayer/player.swf',
    'id': 'playerID',
    'width': '640',
    'height': '580',
    'provider': 'rtmp',
    'streamer': 'rtmp://domain/recorder/_definst_',
'file': 'onSaveOk("+streamName+")'
  });
</script>
</center>
</div>
'); 
```

我基本上只想在调用函数时打印出该代码。

这是我问题的第二部分，这个函数在闪存录像机完成保存录制的视频时运行。它从 Flash 播放器中获取函数参数中的所有变量。我想在我的 jwplayer 代码中使用其中一个变量，我该怎么做？

这是功能：

```
 function onSaveOk(streamName,streamDuration,userId,cameraName,micName,recorderId){
        //alert("onSaveOk("+streamName+","+streamDuration+","+userId+","+cameraName+","+micName+")");

        //the user pressed the [save] button inside the recorder and the save_video_to_db.XXX script returned save=ok
        //recorderId: the recorderId sent via flash vars, to be used when there are many recorders on the same web page
            $('#record').hide();
    document.write('
<div id="jwplayer">
<center>
<div id='mediaplayer'></div>
<script type="text/javascript">
  jwplayer('mediaplayer').setup({
    'flashplayer': 'jwplayer/player.swf',
    'id': 'playerID',
    'width': '640',
    'height': '580',
    'provider': 'rtmp',
    'streamer': 'rtmp://domain/recorder/_definst_',
'file': 'onSaveOk("+streamName+")'
  });
</script>
</center>
</div>
');

    } 
```

这是我尝试使用 streamName 函数的地方，但它不起作用：

```
'file': 'onSaveOk("+streamName+")' 
```

我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T02:07:41.643

首先，JavaScript 不允许多行字符串，所以你`document.write`马上就会抛出语法错误。你至少有几种方法可以解决它。您可以删除换行符，使整个字符串成为单行...

```
var lines = '<div id="jwplayer"><center>...</center></div>';
document.write(lines); 
```

...但这往往不是那么可读。或者你可以用反斜杠转义换行符......

```
var lines = '<div id="jwplayer">\
    <center>\
      ...\
    </center>\
  </div>';
document.write(lines); 
```

...这更具可读性，但可能有点脆弱——反斜杠后面的任何尾随空格都会在不明显的情况下破坏它。接下来，您可以一次将字符串连接一行...

```
var lines = '<div id="jwplayer">';
lines += '<center>';
lines += '...';
lines += '</center>';
lines += '</div>';
document.write(lines); 
```

...*我*认为这在一定程度上减轻了第一种方法的可读性问题和第二种方法的脆弱性问题。最后，您可以创建一个字符串数组并将它们连接起来......

```
var lines = [
  '<div id="jwplayer">',
  '<center>',
  '...',
  '</center>',
  '</div>'].join(' ');
document.write(lines); 
```

...具有消除重复性的[完全主观的]优势`lines += ...`。无论如何，这绝不是一个详尽的方法列表，它主要归结为使用您最熟悉的任何方法。

接下来，坦率地说，您的字符串是相互冲突的单引号和双引号的大杂烩。如果您需要在字符串中包含与用来括住字符串相同类型的引号，那么您需要对它们进行转义：

```
var lines = "<div id=\"jwplayer\">";
lines += '<div id=\'mediaplayer\'></div>'; 
```

显然（？）您希望将转义保持在最低限度，并且由于您正在创建一个 html 字符串，因此您可能希望用单引号括起来并为属性使用双引号价值观。但同样，它是对你最有意义的任何风格。

最后，上述两个问题都是导致`streamName`传递给函数的参数不起作用的原因，因为早在您到达该行之前，您就已经遇到了许多错误。如果您保持字符串问题直截了当，那么

```
lines += "'file': 'onSaveOk(" + streamName + ")'"; 
```

应该按照你想要的方式工作。

**注意：**我前面提到了关于 a) using`document.write()`和 b) using `<center>`tags 的强制性警告，但是您应该花一些时间对这两个问题进行一些研究；我只想说 1998 年打来电话说：“这很酷，我不想让那些回来”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-13T12:55:42.873

派对迟到了，我实际上更喜欢：

//开始html

```
var html = ''+
    '<body>'+
        '<div>'+
            '<a href="foo.bar">Foo Bar page</a>'+
        '</div>'+
    '</body>'; 
```

有效的 javascript 'foo'+\n\r\t'bar' == 'foobar';

# security - 有什么东西可以提供 PHP 的 filter_var 在 ColdFusion 中所做的那种支持吗？

> ID：12810456
> 
> 赞同：1
> 
> 时间：2012-10-10T00:50:40.480
> 
> 标签：security, validation, coldfusion, coldfusion-8, sanitize

我发现[filter_var](http://php.net/manual/en/function.filter-var.php)在使用 PHP 验证和清理用户输入方面**非常**有用，但我还没有在 ColdFusion（更具体地说，CF8）中找到任何远程方便的东西。

显然，我可以使用[REReplace](http://livedocs.adobe.com/coldfusion/8/htmldocs/functions_m-r_35.html#135742)组合一些东西，但这将花费更多时间来编写代码，并且比使用 PHP 中可用的预定义过滤器更难看。有没有更有效的方法，还是我只需要咬紧牙关？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T14:04:57.153

您可以使用三种不同的选项。由于您正在尝试管理用户输入，因此我假设您正在使用表单。 [isValid](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_in-k_37.html)最接近模仿您的功能，允许您检查指定的值是否与数据类型或正则表达式匹配并返回 true 或 false，并且默认包含属性以定义范围。但是，除了定义正则表达式之外，它不支持创建自定义“过滤器”的能力。

第二个选项是在您的 POST 处理页面上使用[cfparam](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_p-q_01.html#1101730)标记，它允许您指定变量的存在、针对数据类型进行测试或定义正则表达式，如果变量不存在，还可以选择指定默认值。如果您尝试处理未定义字段且未指定默认值的页面，ColdFusion 将引发错误。

最后，您可以在表单本身上使用 cfform 和[cfinput字段进行验证；](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_i_07.html)它允许客户端数据验证存在和类型（它也支持服务器端验证，但它的实现是草率的）、正则表达式和输入掩码：获取用户输入的数据并将其符合特定格式（如添加破折号到电话号码和邮政编码）。

# java - JOptionPane - 输入对话框程序

> ID：12810460
> 
> 赞同：13
> 
> 时间：2012-10-10T00:50:52.397
> 
> 标签：java, swing

编写一个程序，使用输入对话框读取三个测试分数，每个分数都为 100。该程序会丢弃您的最低分数，并在消息对话框中显示两个较高分数的平均值。

这是我走了多远，我不知道从哪里开始，任何帮助将不胜感激：

```
import javax.swing.JOptionPane; 

public class Average {

    public static void main (String [] args){

        String test1, test2, test3, avg;

        test1= JOptionPane.showInputDialog("Please input mark for test 1: ");

        test2= JOptionPane.showInputDialog("Please input mark for test 2: ");

        test3= JOptionPane.showInputDialog("Please input mark for test 3: ");

    }

} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-10T00:59:36.727

```
import java.util.SortedSet;
import java.util.TreeSet;

import javax.swing.JOptionPane;
import javax.swing.JFrame;

public class Average {

    public static void main(String [] args) {

        String test1= JOptionPane.showInputDialog("Please input mark for test 1: ");

        String test2= JOptionPane.showInputDialog("Please input mark for test 2: ");

        String test3= JOptionPane.showInputDialog("Please input mark for test 3: ");

        int int1 = Integer.parseInt(test1);
        int int2 = Integer.parseInt(test2);
        int int3 = Integer.parseInt(test3);

        SortedSet<Integer> set = new TreeSet<>();
        set.add(int1);
        set.add(int2);
        set.add(int3);

        Integer [] intArray = set.toArray(new Integer[3]);
        JFrame frame = new JFrame();
        JOptionPane.showInternalMessageDialog(frame.getContentPane(), String.format("Result %f", (intArray[1] + intArray[2]) / 2.0));

    }

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-10T03:52:10.457

为什么要用三个不同的对话框来输入东西来惹恼用户，为什么不在一个对话框中一次性完成所有这些并节省时间，而不是测试用户的耐心呢？

您可以在单个对话框中添加所有内容，方法是将所有字段放在您的`JPanel`，然后将其添加`JPanel`到您的`JOptionPane`. 下面的代码可以澄清一点：

```
import java.awt.*;
import java.util.*;
import javax.swing.*;

public class AverageExample
{
    private double[] marks;
    private JTextField[] marksField;
    private JLabel resultLabel;

    public AverageExample()
    {
        marks = new double[3];
        marksField = new JTextField[3];
        marksField[0] = new JTextField(10);
        marksField[1] = new JTextField(10);
        marksField[2] = new JTextField(10);
    }

    private void displayGUI()
    {
        int selection = JOptionPane.showConfirmDialog(
                null, getPanel(), "Input Form : "
                                , JOptionPane.OK_CANCEL_OPTION
                                , JOptionPane.PLAIN_MESSAGE);

        if (selection == JOptionPane.OK_OPTION) 
        {
            for ( int i = 0; i < 3; i++)
            {
                marks[i] = Double.valueOf(marksField[i].getText());             
            }
            Arrays.sort(marks);
            double average = (marks[1] + marks[2]) / 2.0;
            JOptionPane.showMessageDialog(null
                    , "Average is : " + Double.toString(average)
                    , "Average : "
                    , JOptionPane.PLAIN_MESSAGE);
        }
        else if (selection == JOptionPane.CANCEL_OPTION)
        {
            // Do something here.
        }
    }

    private JPanel getPanel()
    {
        JPanel basePanel = new JPanel();
        //basePanel.setLayout(new BorderLayout(5, 5));
        basePanel.setOpaque(true);
        basePanel.setBackground(Color.BLUE.darker());

        JPanel centerPanel = new JPanel();
        centerPanel.setLayout(new GridLayout(3, 2, 5, 5));
        centerPanel.setBorder(
            BorderFactory.createEmptyBorder(5, 5, 5, 5));
        centerPanel.setOpaque(true);
        centerPanel.setBackground(Color.WHITE);

        JLabel mLabel1 = new JLabel("Enter Marks 1 : ");
        JLabel mLabel2 = new JLabel("Enter Marks 2 : ");
        JLabel mLabel3 = new JLabel("Enter Marks 3 : ");

        centerPanel.add(mLabel1);
        centerPanel.add(marksField[0]);
        centerPanel.add(mLabel2);
        centerPanel.add(marksField[1]);
        centerPanel.add(mLabel3);
        centerPanel.add(marksField[2]);

        basePanel.add(centerPanel);

        return basePanel;
    }

    public static void main(String... args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            @Override
            public void run()
            {
                new AverageExample().displayGUI();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-10T01:08:32.480

一种解决方案是实际使用整数数组而不是单独的`test`字符串：

您可以将响应循环解析为`JOptionPane.showInputDialog`数组的各个元素。

`Arrays.sort`可用于对它们进行排序以允许您挑选出 2 个最高值。

然后可以通过将这 2 个值相加并除以 2 轻松计算平均值。

```
int[] testScore = new int[3];

for (int i = 0; i < testScore.length; i++) {
   testScore[i] = Integer.parseInt(JOptionPane.showInputDialog("Please input mark for test " + i + ": "));
}

Arrays.sort(testScore);
System.out.println("Average: " + (testScore[1] + testScore[2])/2.0); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-10T00:58:16.007

之后，您必须解析结果。假设结果是整数，那么

```
int testint1 = Integer.parse(test1); 
```

同样，其他的也应该被解析。现在应该通过使用 if 语句检查结果中是否有两个较高的分数，然后取出平均值。

# jquery - 为什么这只附加一次？

> ID：12810461
> 
> 赞同：5
> 
> 时间：2012-10-10T00:51:04.753
> 
> 标签：jquery, append

此循环（请参阅[jsfiddle](http://jsfiddle.net/mDV4D/)）尝试将`<span>`标签附加到容器五次。但它只做一次。为什么？

```
var myArr = [0,1,2,3,4];
var $span= $('<span></span>');
for (var i = 0; i < (myArr.length); i++) {
    $('.contain').append($span);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T00:53:09.523

问题是您多次附加相同的元素。
用于`clone`克隆元素，然后`append`.

`$('.contain').append($span.clone());`

[演示](http://jsfiddle.net/mDV4D/1/)

**更新**：

通过这种方式，您可以自定义元素，然后使用所有属性克隆它。

```
var $span = $('<span/>', {
                    'class': 'someClass otherClass',
                    'css': {
                         'background-color': '#FF0000'
                     }
            });
for (var i = 0; i < (myArr.length); i++) {
    $('.contain').append($span.clone());
} 
```

[**演示2**](http://jsfiddle.net/mDV4D/2/)

**Update2**：根据[此](https://stackoverflow.com/questions/12810461/why-is-this-only-appended-once/12810483#comment17325556_12810483)评论。

`$('.contain').append('<span class="yourClass"/>');`

# x86 - 如何使用 SSE2 加载 16 x 8 位整数

> ID：12810465
> 
> 赞同：1
> 
> 时间：2012-10-10T00:51:11.873
> 
> 标签：x86, sse, simd, sse2

假设我有 16 个 8 位整数，我想将它们加载到`__m128i`使用 SSE2 中：

```
__m128i v = _mm_set_epi8(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16); 
```

我可以使用静态方式执行此操作，`_mm_set_epi8`但我想动态执行此操作；这些值将在运行时决定。

```
C = userinput;
for(int i=0; i<16; i++)
{
    load C*i on v at position i
} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T01:13:21.763

一种方法是使用联合：

```
union {
    __m128i v;
    uint8_t a[sizeof(__m128i)];
} u; 
```

将您的值加载到数组 a 中，然后从 v 中读取 SSE 向量。

或者，如果您的数据已经在连续内存中，则只需使用`_mm_load_si128`（或者`_mm_loadu_si128`如果您不能保证 16 字节对齐）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T03:56:47.983

我不确定这个问题是否已经得到解答，但我确信 Paul R 是对的。

对于连续数据，使用负载内在

```
__m128i v = _mm_load_si128((__m128i*)&C[0]); 
```

如果您的数据不能保证始终对齐，请使用`_mm_loadu_si128`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-14T15:54:52.250

传递给的值`_mm_set_epi8`不必是常量——在你的例子中，你可以很好地写

```
__m128i v = _mm_set_epi8(   0,    C,  2*C,  3*C,
                          4*C,  5*C,  6*C,  7*C,
                          8*C,  9*C, 10*C, 11*C,
                         12*C, 13*C, 14*C, 15*C); 
```

（我必须使用的所有编译器都不能很好地解决这个问题，但它确实有效。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T16:53:07.843

```
char Strings[10][1001];
char *gc="GC";  

*((__m128i*)gc) 
```

和

```
*((__m128i*)(&(Strings[i][j]))) 
```

如果您愿意这样做，也可以使用。我也喜欢 struct 答案，但如果您使用指向文本的指针，您通常将不得不转换并进行指针数学运算。（无论如何，这都是我的经验。）

# git - 如何检索隐藏的更改

> ID：12810466
> 
> 赞同：4
> 
> 时间：2012-10-10T00:51:39.407
> 
> 标签：git

我隐藏了我的更改，因为我不得不拉。但是，在我关闭笔记本电脑之前，我忘了弹出我的更改。我尝试了该命令`git stash list`以查看我的隐藏更改是否存在，但我找不到它。我怎样才能找回它？请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-03T13:52:11.853

要应用最近推送的存储，请使用：

`git stash apply`

# php - 如何遍历子数组以查看值是否以字符串形式返回

> ID：12810467
> 
> 赞同：0
> 
> 时间：2012-10-10T00:51:42.793
> 
> 标签：php, arrays, loops, foreach

以下是输出数组的示例：

```
Array ( [CART] => Array ( [ITEMS] => Array ( [0] => Array ( [product_id] => 269194 [variation_id] => 0 [options] => Array ( ) [quantity] => 1 [product_name] => 15 Top Hits for Easy Piano [product_code] => HL102668 [product_price] => 14.9900 [original_price] => 14.9900 [default_currency] => 1 [customer_group] => [product_fields] => Array ( ) ) [1] => Array ( [product_id] => 266421 [variation_id] => 0 [options] => Array ( ) [quantity] => 1 [product_name] => Whistle [product_code] => HD245839 [product_price] => 3.9900 [original_price] => 3.9900 [default_currency] => 1 [customer_group] => [product_fields] => Array ( ) ) ) [LAST_UPDATED] => 1349829499 [NUM_ITEMS] => 2 ) [JustAddedProduct] => [CHECKOUT] => Array ( ) ) 
```

每个独特产品都有一个数组（在此示例中，有 2 个独特产品。）有时只有一个，有时可能有 20 个或更多独特产品。

对我来说重要的价值是 [product_code]。您可以看到在第一个数组中，有 [product_code] => HL102668。第二个是 [product_code] => HD245839。

如何检查任何 [product_code] 值中是否存在“HD”？如果是这样，我需要返回false。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T00:59:40.430

访问您的子数组：

```
 $products  = $array['CART']['ITEMS']; 
```

循环遍历您的子数组：

```
 foreach ($products as $product) 
```

使用简单的 strstr 或使用 preg_match 的正则表达式检查您的 product_code 中是否存在 HD（如果您对它感到满意）。

```
 if (strstr($product['product_code'], "HD")) {
          // Do your actions
   } 
```

# html - 如何使用翻转图像完成此垂直导航栏？

> ID：12810468
> 
> 赞同：0
> 
> 时间：2012-10-10T00:51:52.867
> 
> 标签：html, css

我想要一个带有这些图像的垂直导航栏。我似乎已经完成了翻转更改，但不确定我需要做什么才能让菜单正确显示。

[http://www.charissasantos.la/mezcaleria.html](http://www.charissasantos.la/mezcaleria.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:01:29.110

我不确定我是否有这个权利，但看起来您正在尝试使用填充将文本推出链接，以便只显示背景图像。尝试使用负文本缩进代替填充。像这样：

```
#subnav ul li a {
    background-image: url("img/img-bg-subnav-mezcal.png");
    display: block;
    height: 1px;
    text-indent: -9999px;
} 
```

# replication - 在复制中提升master

> ID：12810469
> 
> 赞同：1
> 
> 时间：2012-10-10T00:52:02.677
> 
> 标签：replication, distributed-computing, database-replication, distributed-system

我正在设计一种复制算法，以在许多奴隶中提升主人。我希望它比 Paxos 更快、更简单。基本思想是：

1.  为每个节点分配一个“促销优先级”，例如对于 5 个节点，会有优先级：50、40、30、20 和 10，50 最高，10 最低。
2.  当需要选举主节点时，所有从节点将（同时）向其他 4 个节点发送请求成为主节点的消息，但只有该主节点将被选举，并由所有从节点以确认消息确认。如果自己的“Promotion Priority”低于请求节点，或者如果具有较高优先级的请求节点超时发出拒绝消息，则从节点将发送确认消息。
3.  如果从站接收到来自具有更高“提升优先级”的从站的拒绝消息，它将中止该过程。
4.  应该没有具有相同优先级的节点。
5.  为了成为主人，奴隶应该收集最少数量的确认消息。

这个算法应该更快，因为所有的slave都将并行选举一个master，优先级将有助于加快进程。

你怎么看待这件事？是否存在其他具有优先级的大师提升算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T01:01:43.943

> 你怎么看待这件事？

在不了解您的需求细节的情况下，很难完全评估您的算法的有效性。总的来说，它看起来是一种有效的方法，但我认为有一些问题值得关注。

[您的问题与将共享资源分配给多个节点中的一个节点的分布式算法](https://stackoverflow.com/q/12450987/1380680)有一些相似之处。因此，我在回答这个问题时提出的一些论点也适用于这个问题。

> 当需要选举主节点时，所有从节点将（同时）向其他 4 个节点发送请求成为主节点的消息，但只有该主节点将被选举，并由所有从节点以确认消息确认。

这种方法假设所有从站都知道在任何时候有多少从站存在——否则假定的主站在收到*所有*从站的确认时永远无法得出结论。隐含地，这意味着没有奴隶可以在不破坏算法的情况下离开和加入系统。

但实际上，由于崩溃、重启、网络中断等原因，这些从站*会*来来去去。这种情况的机会随着从站的数量而增加，但这是否是一个问题取决于您的要求。您的系统必须具备多大的容错能力？

顺便说一句，由于您提到有很多从站，我假设您正在使用多播或广播来发送请求消息。否则，根据*许多*对您的意义，您的设置在管理所有从属服务器所在的位置时可能容易出错。

> 如果自己的“Promotion Priority”低于请求节点，或者如果具有较高优先级的请求节点超时发出拒绝消息，则从节点将发送确认消息。

与前面的评论类似：如果某个从站由于某种原因出现响应问题，则从站可能会得出错误的结论。事实上，如果一个从站宕机或有网络问题，所有其他从站都会得出相同的（很可能是错误的）结论，即没有响应的从站是主站。

> 这个算法应该更快，因为所有的从设备将并行选举一个主设备

这个答案中提出的问题几乎是以分布式方式进行主选择所固有的，并且如果不引入某种集中式决策者就很难解决。你得到一些，你失去一些……

> 是否存在其他具有优先级的大师提升算法？

另一种方法是让系统中的所有从属设备不断维护有关谁是当前主设备的管理。这可以通过让每个从属设备通过某种心跳消息定期多播/广播其优先级来完成（以一些网络带宽为代价）。这样一来，每一个奴隶都会意识到其他每一个奴隶，并且在需要选择一个主人的那一刻，每个奴隶都可以立即做到这一点。由于丢失了心跳，将检测到网络问题或其他“系统健康”问题。该算法对于从属系统加入和离开系统是灵活的。心跳频率越高，您的系统对拓扑变化的响应就越快。但是，由于网络断开，您可能仍然会遇到从站运行得出独立结论的问题。

# c++ - c++ 多线程数组

> ID：12810472
> 
> 赞同：0
> 
> 时间：2012-10-10T00:52:10.627
> 
> 标签：c++, arrays, multithreading

我正在做一些有趣的事情，试图学习多线程 [通过引用线程传递数组的问题](https://stackoverflow.com/questions/12801862/problems-passing-array-by-reference-to-threads)

但 Arno 指出我通过 process.h 的线程不会是多线程的。

我希望做的是我有一个 100 个数组（或 10,000 个，我认为这并不重要），并将值分配拆分给每个线程。例如，4 个线程 = 每个要分配的线程 250 个值。

然后我可以使用这个填充的数组进行进一步的计算。

这是我正在处理的一些代码（不起作用）

```
#include <process.h>
#include <windows.h>
#include <iostream>
#include <fstream>
#include <time.h>
//#include <thread>

using namespace std;

void myThread (void *dummy );

CRITICAL_SECTION cs1,cs2; // global

int main()
{

    ofstream myfile;
    myfile.open ("coinToss.csv");

    int rNum;

    long numRuns;
    long count = 0;
    int divisor = 1;
    float holder = 0;
    int counter = 0;
    float percent = 0.0;

    HANDLE hThread[1000];

    int array[10000];

    srand ( time(NULL) );

    printf ("Runs (use multiple of 10)? ");
    cin >> numRuns;

    for (int i = 0; i < numRuns; i++)
    {
        //_beginthread( myThread, 0, (void *) (array1) );
        //???
        //hThread[i * 2] = _beginthread( myThread, 0, (void *) (array1) );
        hThread[i*2] = _beginthread( myThread, 0, (void *) (array) );

    }
     //WaitForMultipleObjects(numRuns * 2, hThread, TRUE, INFINITE);
     WaitForMultipleObjects(numRuns, hThread, TRUE, INFINITE);

}

void myThread (void *param )
{
    //thanks goes to stockoverflow
    //https://stackoverflow.com/questions/12801862/problems-passing-array-by-reference-to-threads
    int *i = (int *)param;

    for (int x = 0; x < 1000000; x++)
    {
        //param[x] = rand() % 2 + 1;
        i[x] = rand() % 2 + 1;
    }

} 
```

谁能解释为什么它不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:23:53.553

对于初学者，使用 _beginthreadex 而不是 _beginthread，它会在正常运行时关闭线程句柄。如果线程句柄在开始 WFMO 之前关闭，它可能会立即中断，因为一个或多个句柄将无效。

其次，您的句柄列表中的 i*2 是什么？将句柄列表发送到 WFMO 并且每隔一个句柄 NULL 可能会立即出错。

第三，WFMO 的最大等待列表长度为 64 个线程，因此一旦达到 65 个或更多线程，您的 1000 个线程列表肯定会呕吐。您可能只想考虑限制该上限。实际值是 MAX_WAIT_OBJECTS （或接近这个值，我记不清了）。

在我们保护您尝试共享的阵列之前，这就是全部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:06:31.407

您应该知道这`rand`不是线程安全的。

甚至在 SO 上有一篇关于它的帖子：[Using stdlib's rand() from multiple threads](https://stackoverflow.com/questions/6161322/using-rand-with-multiple-threads-in-c)

如果您可以为自己找到一个线程安全的随机数生成器，那么使用 OpenMP 进行并行循环会更好，因为它维护的线程池比使用线程 API 高效得多。

否则，将结构传递给您的线程函数可能会为您提供数组和所需的长度：

```
struct ArraySlice
{
    ArraySlice( int *arr, size_t start, size_t end)
        : pBegin( arr + start )
        , pEnd( arr + end )
    {}

    int *pBegin, *pEnd;
}; 
```

然后创建你的线程......

```
size_t arrayLength = 1000000;
size_t sliceLength = arrayLength / numRuns;

for (size_t i = 0; i < numRuns; i++)
{
    size_t start = i * sliceLength;
    size_t end = min( start + sliceLength, arrayLength );
    ArraySlice *slice = new ArraySlice(array, start, end);
    hThread[i] = (HANDLE)_beginthread( myThread, 0, (void*)slice );
} 
```

在你的线程函数中：

```
void myThread (void *param )
{
    ArraySlice *slice = (ArraySlice*)param;
    if( !slice ) return;

    for( int *pos = slice->pBegin, *end = slice->pEnd; pos != end; pos++ )
    {
        *pos = rand();  // Except you need a thread-safe rand() function...
    }

    delete slice;
} 
```

# uipopovercontroller - 升级Xcode后“无法从没有窗口的视图中呈现弹出窗口”

> ID：12810473
> 
> 赞同：1
> 
> 时间：2012-10-10T00:52:18.857
> 
> 标签：uipopovercontroller, xcode4.4

我有一个使用 Xcode4.3 的项目，但后来我将 Xcode 升级到 4.4.1，错误就出来了。我的应用程序没有任何错误，现在我在运行时出现了一些错误。
其中第一个是“无法从没有窗口的视图中呈现弹出窗口”
我有一个 MainViewController，这个 ViewController 调用另一个带有弹出窗口的 ViewController。当我想回到我的 MainViewController 时，我的应用程序崩溃了。这是我的代码：

```
-(void)clearAnimated:(BOOL)animated{
   if(self.popover &&self.popover.popoverVisible){
      [self.popover dismissPopoverAnimated:animated];
   }
} 
```

所以，经过一番研究，我发现解决方案是这样的：

```
-(void)clearAnimated:(BOOL)animated{
   if(self.popover &&self.popover.popoverVisible){
      if (self.view.window != nil)
         [self.popover dismissPopoverAnimated:animated];
   }
} 
```

有点工作，因为现在我的应用程序没有崩溃，但现在在弹出框所在的 MainViewController 中，它就像一个阴影，就像弹出框仍然存在一样。
然后，当我尝试转到我的 SecondViewController 时，出现错误......
如何关闭弹出框？

# c# - 如何使用 App.config 和 System.Diagnostics 动态设置日志文件？

> ID：12810475
> 
> 赞同：4
> 
> 时间：2012-10-10T00:52:26.290
> 
> 标签：c#, logging, app-config, system.diagnostics

当我遇到一篇文章（[http://www.daveoncsharp.com/2009/09/create-a-logger-using-the-trace-listener-in-时，我正在寻找一种解决方案来为我的最新项目提供日志记录） csharp/](http://www.daveoncsharp.com/2009/09/create-a-logger-using-the-trace-listener-in-csharp/) ) 讨论了使用 System.Diagnostics 和 App.config 通过 Trace 方法进行日志记录。我能够成功地实现类和 App.config，但我真的希望能够动态分配日志文件的值/位置（在 initializeData 中），但我不知道该怎么做. 如果您有任何建议，请随时发表！

应用程序配置：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <system.diagnostics>
    <trace autoflush="true" indentsize="4">
      <listeners>
        <add name="myListener" 
             type="System.Diagnostics.TextWriterTraceListener" 
             initializeData="fileSizeThreshold=512, fileSizeUnit=kilobytes, 
             fileAgeThreshold=1, fileAgeUnit=months, fileNameTemplate='{0}\MyApp-{1:MMM-yy}.log'"/>
        <remove name="Default" />
      </listeners>
    </trace>
  </system.diagnostics>
</configuration> 
```

记录器类：

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Text;

namespace MyCurrentProject
{
    class Logger
    {
        public void Error(string module, string message)
        {
            WriteEntry(message, "ERROR:", module);
        }

        public void Error(Exception ex, string module)
        {
            WriteEntry(ex.Message, "ERROR:", module);
        }

        public void Warning(string module, string message)
        {
            WriteEntry(message, "WARNING:", module);
        }

        public void Info(string module, string message)
        {
            WriteEntry(message, "INFO:", module);
        }

        private void WriteEntry(string message, string type, string module)
        {
            Trace.WriteLine(
                    string.Format("{0} {1} [{2}] {3}",
                                  DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss"),
                                  type,
                                  module,
                                  message));
        }
    }
} 
```

**RE：**抱歉不清楚...只是为了清楚起见，我需要动态设置保存日志文件输出的文件路径。我想要保存到 %AppData% 中某个位置的路径。我在配置中遇到的问题是，一旦我为“initializeData”设置了值，我就找不到更改或动态设置/重置该值的方法。说实话...在这一点上，我只想要一个可行的解决方案，并允许我管理日志文件的位置。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-11T00:54:15.907

这是一个使用 Systems.Diagnostics 的工作示例，它与非基类库相比有两个优点。它总是被允许的（在大型组织中），总是可用的，并且在开发人员熟悉基类库的范围内，下一批维护开发人员会听说过它。

```
using System.Diagnostics;

namespace DynamicTraceLog
{
    class Program
    {
        static void Main(string[] args)
        {
            //Use TraceSource, not Trace, they are easier to turn off
            TraceSource trace = new TraceSource("app");
            //SourceSwitches allow you to turn the tracing on and off.
            SourceSwitch level =new SourceSwitch("app");
            //I assume you want to be dynamic, so probalby some user input would be here:
            if(args.Length>0 && args[0]=="Off")
                level.Level= SourceLevels.Off;
            else
                level.Level = SourceLevels.Verbose;
            trace.Switch = level;
            //remove default listner to improve performance
            trace.Listeners.Clear();
            //Listeners implement IDisposable
            using (TextWriterTraceListener file = new TextWriterTraceListener("log.txt"))
            using (ConsoleTraceListener console = new ConsoleTraceListener())
            {
                //The file will likely be in /bin/Debug/log.txt
                trace.Listeners.Add(file);
                //So you can see the results in screen
                trace.Listeners.Add(console);
                //Now trace, the console trace appears immediately.
                trace.TraceInformation("Hello world");
                //File buffers, it flushes on Dispose or when you say so.
                file.Flush();
            }
            System.Console.ReadKey();
        }
    }
} 
```

**回复：如何** 格式化输出 对于使用 Systems.Diagnostics 类实现模板化跟踪格式化/输出的跟踪侦听器尝试这两种方法中的任何一种：http: [//essentialdiagnostics.codeplex.com](http://essentialdiagnostics.codeplex.com) 或[http://ukadcdiagnostics.codeplex.com/Systems](http://ukadcdiagnostics.codeplex.com/) 。诊断不提供标准令牌的任何特定格式或输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:43:38.317

我知道我可能会因此而被否决，但我要离开牧场一分钟，我会建议你使用与工具箱不同的工具。[Log4Net](http://logging.apache.org/log4net/release/manual/configuration.html)是一个非常强大且简洁的日志框架。例如，下面是一个使用它的控制台应用程序，它功能齐全，如您所见。

```
using Com.Foo;

// Import log4net classes.
using log4net;
using log4net.Config;

public class MyApp 
{
    // Define a static logger variable so that it references the
    // Logger instance named "MyApp".
    private static readonly ILog log = LogManager.GetLogger(typeof(MyApp));

    static void Main(string[] args) 
    {
        // Set up a simple configuration that logs on the console.
        BasicConfigurator.Configure();

        log.Info("Entering application.");
        Bar bar = new Bar();
        bar.DoIt();
        log.Info("Exiting application.");
    }
} 
```

但是假设我们想用一个配置文件来做到这一点，就像你暗示你想要使用的那样。**嗯，这很简单！**下面是我们`App.config`为了完成同样的事情而放置的配置：

```
<log4net>
    <!-- A1 is set to be a ConsoleAppender -->
    <appender name="A1" type="log4net.Appender.ConsoleAppender">

        <!-- A1 uses PatternLayout -->
        <layout type="log4net.Layout.PatternLayout">
            <conversionPattern value="%-4timestamp [%thread] %-5level %logger %ndc - %message%newline" />
        </layout>
    </appender>

    <!-- Set root logger level to DEBUG and its only appender to A1 -->
    <root>
        <level value="DEBUG" />
        <appender-ref ref="A1" />
    </root>
</log4net> 
```

然后可以像这样使用该配置：

```
using Com.Foo;

// Import log4net classes.
using log4net;
using log4net.Config;

public class MyApp 
{
    private static readonly ILog log = LogManager.GetLogger(typeof(MyApp));

    static void Main(string[] args) 
    {
        // BasicConfigurator replaced with XmlConfigurator.
        XmlConfigurator.Configure(new System.IO.FileInfo(args[0]));

        log.Info("Entering application.");
        Bar bar = new Bar();
        bar.DoIt();
        log.Info("Exiting application.");
    }
} 
```

并且不要让模式的东西让你措手不及，它只是配置你在上面编码的内容，这样你就可以在消息中保持一些一致性。但它确实很容易，因为您所需要记录的只是需要插入到模式中的信息，然后将模式封装掉。

* * *

这是 Log4Net 中的速成课程，但我真正推荐它的原因是因为在上面的两个示例中，您看到它们登录到控制台，但是您有无数可能的记录器，只需查看以下列表：

**log4net.Appender.AdoNetAppender**：使用准备好的语句或存储过程将日志记录事件写入数据库。

**log4net.Appender.AnsiColorTerminalAppender**：将颜色突出显示的日志事件写入 ANSI 终端窗口。

**log4net.Appender.AspNetTraceAppender**：将日志记录事件写入 ASP 跟踪上下文。然后可以在 ASP 页的末尾或在 ASP 跟踪页上呈现这些。

**log4net.Appender.ColoredConsoleAppender**：将颜色突出显示的日志事件写入应用程序的 Windows 控制台。

**log4net.Appender.ConsoleAppender**：将日志记录事件写入应用程序的控制台。事件可能会进入标准我们的流或标准错误流。

**log4net.Appender.DebugAppender**：将日志事件写入 .NET 系统。

**log4net.Appender.EventLogAppender**：将日志记录事件写入 Windows 事件日志。

**log4net.Appender.FileAppender**：将日志记录事件写入文件系统中的文件。

**log4net.Appender.LocalSyslogAppender**：将日志记录事件写入本地 syslog 服务（仅限 UNIX）。

**log4net.Appender.MemoryAppender**：将日志记录事件存储在内存缓冲区中。

**log4net.Appender.NetSendAppender**：将日志事件写入 Windows Messenger 服务。这些消息显示在用户终端的对话框中。

**log4net.Appender.OutputDebugStringAppender**：将日志事件写入调试器。如果应用程序没有调试器，系统调试器会显示该字符串。如果应用程序没有调试器并且系统调试器未激活，则忽略该消息。

**log4net.Appender.RemoteSyslogAppender**：使用 UDP 网络将日志记录事件写入远程 syslog 服务。

**log4net.Appender.RemotingAppender**：使用 .NET 远程处理将日志记录事件写入远程接收器。

**log4net.Appender.RollingFileAppender**：将日志记录事件写入文件系统中的文件。RollingFileAppender 可以配置为根据日期或文件大小限制记录到多个文件。

**log4net.Appender.SmtpAppender**：将日志记录事件发送到电子邮件地址。

**log4net.Appender.SmtpPickupDirAppender**：将日志记录事件发送到电子邮件地址，但将电子邮件写入可配置目录，而不是直接通过 SMTP 发送。

**log4net.Appender.TelnetAppender**：客户端通过 Telnet 连接以接收日志记录事件。

**log4net.Appender.TraceAppender**：将日志记录事件写入 .NET 跟踪系统。

**log4net.Appender.UdpAppender**：使用 UdpClient 将日志事件作为无连接 UDP 数据报发送到远程主机或多播组。

* * *

所以，正如你所见，它是非常强大的OOB。我希望这篇文章对您有所帮助。

# jquery - JQuery 多个选择器，“AND”运算符

> ID：12810479
> 
> 赞同：9
> 
> 时间：2012-10-10T00:52:43.817
> 
> 标签：jquery, jquery-selectors

以下代码将对具有 Class =`a.cssPauseAll` `OR`属性 =的元素的单击事件发出警报`historyID`

```
$(document).on("click","a.cssPauseAll,[historyID]", function () {
    alert($(this));

}); 
```

如何使用`AND`运算符使用多个选择器？

`a.cssPauseAll`这意味着具有类`AND` `historyID`属性的元素？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-10T00:55:13.303

只需`,`从您的选择器中删除：

```
$(document).on("click","a.cssPauseAll[historyID]", function () { 
```

`historyID`不是一个有效的属性，你可以使用`data-*`属性来代替：

```
$(document).on("click","a.cssPauseAll[data-historyid]", function () { 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T00:55:13.537

> *具有a.cssPauseAll*类和*historyID*属性的元素

使用以下选择器：

```
a.cssPauseAll[historyID] 
```

自己测试 - [http://jsfiddle.net/SrNDt/](http://jsfiddle.net/SrNDt/)

**注意：**逗号分隔选择器，因此表现为逻辑`OR`. *将表达式链接*到单个选择器中的行为类似于逻辑`AND`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T00:56:13.537

试试这个

```
$(document).on("click","a.cssPauseAll[historyID]", function () { 
```

去掉**逗号就行了**

# facebook - 如何使用对象/动作？

> ID：12810487
> 
> 赞同：-1
> 
> 时间：2012-10-10T00:54:32.493
> 
> 标签：facebook, api, facebook-opengraph

我创建了一个动作和一个对象，它正在工作，但我想我不明白这些参数。我的行动是“采取”。

现在它说：`Joe Blow took a Red marker using Cool Photo App`。我想让它说：`Joe Blow took a photo using Cool Photo App`。

关于如何去做这件事的任何想法？我已阅读所有文档，但有些东西没有点击。

谢谢！

吉姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-12T09:58:06.810

我认为您应该将该操作命名为“采取”。facebook负责处理时态。并且要发布为拍摄照片，对象中的标题标签应具有值“照片”。

# objective-c - NSMutableDictionary 不写入文件

> ID：12810488
> 
> 赞同：1
> 
> 时间：2012-10-10T00:54:55.627
> 
> 标签：objective-c, ios, nsmutabledictionary, nskeyedarchiver, writetofile

我有一段代码，据我所知应该可以正常工作，但不是：

```
NSMutableDictionary* videos = [NSMutableDictionary dictionary];
VideoObject* localVideo = [VideoObject videoObject];
localVideo.assetURL = url;//trust me it's set
localVideo.localThumbPath = finalPath;
        videoData = [NSKeyedArchiver archivedDataWithRootObject:localVideo];
        [videos setObject:videoData forKey:localVideo.assetURL];
        if(![videos writeToURL:[NSURL URLWithString:self.cacheFilePath] atomically:YES]){
            NSLog(@"pretest videos:%@\
                  data:%@\
                  class of key:%@ class of value:%@",videos,videoData,NSStringFromClass([localVideo.assetURL class]),NSStringFromClass([videos[localVideo.assetURL] class]));
        } 
```

我已经在 VideoObject 类中设置了所有编码内容。lovalVideo.assetURL 是 NSString 类型。一切看起来对我来说都应该完美无缺，但它总是在 writeToURL 上返回 NO。这是我从他的日志中得到的输出：

> 00300000 00000000 00000000 00000000 0272>; } 数据：<

所以 key 和 value 都是有效的类型。实际上，我之前已经用一个空字典初始化了那个 cacheFile，所以我知道我可以在那里写。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:57:07.030

这可能是您为编写而创建的 NSURL 的问题。self.cacheFilePath 的值是多少？如果这是一个普通的旧文件路径，那么您需要像这样创建 URL：

```
[NSURL fileURLWithPath:self.cacheFilePath]; 
```

只有当 self.cacheFilePath 已经以 file:// 开头时，您所拥有的才是有价值的。

无论哪种情况，请确保 self.cacheFilePath 代表绝对文件路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T02:45:07.380

我第二个rmaddy的回答。

查看 URLWithString 的文档，他们建议：要为文件系统路径创建 NSURL 对象，请改用 fileURLWithPath:isDirectory:。

如果字符串格式错误，返回值也将为 nil。所以你应该检查/记录来自 [NSURL URLWithString:self.cacheFilePath] 的返回值。如果它为零，那是你的问题。可能使用 fileURLWithPath:isDirectory: 会使问题消失。

# haskell - (Show ([(Char, Char)] -> Char)) 没有实例

> ID：12810490
> 
> 赞同：4
> 
> 时间：2012-10-10T00:55:08.513
> 
> 标签：haskell, compiler-errors, ghci

所以我必须创建一个函数来找到一对第一个字母并返回第二个字母。

我实际上找到了一个答案，但使用地图功能却无法得到它。

```
 lookUp :: Char -> [(Char, Char)] -> Char
      lookUp x [] = x
      lookUp x ( ( st,nd ): rst) | st == x = nd
                   | otherwise = lookUp x rst 
```

我收到这条消息：

```
No instance for (Show ([(Char, Char)] -> Char))
arising from a use of `print'
 Possible fix:
  add an instance declaration for (Show ([(Char, Char
  In a stmt of an interactive GHCi command: print it 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T01:02:45.783

您的代码很好，您只需要在 ghci 提示符下提供所有参数，例如

```
lookUp 'c' [('b','n'), ('c','q')] 
```

应该给你'q'。

它抱怨它无法显示功能。任何时候它说它没有带有 -> in 的东西的 Show 实例，它抱怨它不能显示一个函数。它只能显示对某些数据使用该函数的结果。

当你给它一些但不是全部数据时，Haskell 将其解释为一个接受下一个参数的新函数，所以

```
lookUp 'c' 
```

是一个函数，它将获取字符对列表并为您提供一个字符。这就是它试图显示的，但不能。

顺便说一句，几乎每次你得到一个“没有实例...”的错误，那是因为你在参数上做错了——错过了一些，把它们按错误的顺序排列。编译器*试图*通过建议您添加一个实例来提供帮助，但可能您只需要检查您是否以正确的顺序提供了参数的写入类型。

玩得开心学习 Haskell！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-10T01:01:38.683

看来您在 ghci 中输入了这样的内容：

```
*Main> lookUp 'c' 
```

像这样的表达式`lookUp 'c'`是函数的部分评估/柯里化形式`lookUp`。它的类型是：

```
*Main> :t lookUp 'c'
lookUp 'c' :: [(Char, Char)] -> Char 
```

这是 ghci 说没有 Show 实例的确切类型。

要测试您的功能，请确保同时提供这两者`x`和对列表`Char`：

```
*Main> lookUp 'c' [ ('a','A'), ('b','B'), ('c','C') ]
'C' 
```

# python - Pyramid BeforeRender 订阅和访问 .request

> ID：12810493
> 
> 赞同：2
> 
> 时间：2012-10-10T00:55:26.150
> 
> 标签：python, python-2.7, pyramid

我有一个 BeforeRender 事件的订阅者功能。每次发出请求时，都会调用此函数。

在这里，我想分析给定的请求 url，但我无法访问 request.application_url 或 request.route_url

每次发出请求时，如何获取请求的 url 并在控制台中打印它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T04:57:29.150

`event['request']`将产生`request`您需要的对象。从那里您可以查看各种属性，所有这些属性都已[记录在案](http://docs.pylonsproject.org/projects/pyramid/en/1.4-branch/api/request.html)。例如`request.path_info`将是`/path/to/this/view`.

`BeforeRender`仅当在视图上使用渲染器或调用或调用时才`render()`调用`render_to_response()`。对于*每个*请求，您可以使用`NewRequest`事件或`ContextFound`.

# python - 给定随机矩阵 P，以概率 P[i, j] 随机选择对 (i, j)

> ID：12810499
> 
> 赞同：2
> 
> 时间：2012-10-10T00:56:28.350
> 
> 标签：python, numpy, statistics

我有 numpy 二维数组 P 使得 P[i, j] >= 0 并且所有 P[i, j] 总和为 1。如何选择概率为 P[i, j] 的索引对 (i, j) ？

编辑：我对 numpy 构建功能感兴趣。这个问题有什么问题吗？可能是一维数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T06:19:02.340

```
# setup
import bisect
import numpy as np
cs = P.cumsum()

# get random value
r = np.random.uniform()
i, j = divmod(cs.searchsorted(r), P.shape[1]) 
```

O(n) 初始设置，O(log n) 选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:20:34.553

这是python中的一个简单算法，可以满足您的期望。

让我们以一个等于 [0.1,0.3,0.4,0.2] 的单维数组 P 为例。逻辑可以扩展到任意数量的维度。

现在我们将每个元素设置为它之前的所有元素的总和：P => [0, 0.1, 0.4, 0.8, 1]

使用随机生成器，我们生成介于 0 和 1 之间的数字。假设 x = 0.2。使用简单的二分搜索，我们可以确定 x 在第一个元素和第二个元素之间。我们只为这个 x 值选择第一个元素。

如果仔细观察，0 =< X < 0.1 的机会是 0.1。0.1 =< x < 0.4 的机会是 0.3，依此类推。

对于 2D 数组，最好将其转换为 1D 数组，即使您应该能够实现 2D 数组二进制搜索算法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-12T11:01:56.947

示例设置：

```
P = np.random.random((20, 10)) # Initializing P matrix
P = P/P.sum() # Normalizing probability matrix 
```

`P.ravel()`使概率矩阵变平`P`。

```
ij = np.random.choice(range(P.size), p=P.ravel()) 
```

`ij``P`告诉使用概率矩阵中的权重随机选择哪个元素`P`

```
i, j = np.unravel_index(ij, P.shape) 
```

`i, j`是矩阵中所选元素的坐标`P`

# ipad - 为什么 Settings.bundle 导致 iTunes/adhoc 说我的 iPhone 应用程序无效？

> ID：12810501
> 
> 赞同：0
> 
> 时间：2012-10-10T00:56:43.850
> 
> 标签：ipad, settings.bundle, ota

任何时候我有一个带有设置包的应用程序，它都不会安装 OTA 或通过 iTunes。它可以在开发证书下的设备上正常工作，但 ota 或 iTunes 或通过管理器安装会因 dist 证书而失败。

我的设置包有一个来自 Apples 模板文件的切换。它可以正常工作，因为如果它被切换，它将不允许电子邮件（在我的应用程序中）。

这是我制作的第二个不会使用设置包安装的应用程序。可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T12:45:26.960

我遇到了同样的问题，经过数小时的调查，我发现“settings.bundle”的资源分支丢失了，因为我在 FAT32 分区上创建/修改它。您应该在 OSX 分区上创建 settings.bundle 或修复资源分叉。

# java - “blocks[i][j].isColorBox() ?pieceColor : backgroundColor”的长版本是什么？

> ID：12810508
> 
> 赞同：6
> 
> 时间：2012-10-10T00:58:25.407
> 
> 标签：java, c++, syntax, if-statement

我已经阅读了这行代码：`blocks[i][j].isColorBox() ? pieceColor : backgroundColor`我想知道它的`if`语句对应物是什么。或者，如果它真的是一个`if`声明。我是编程新手，我还在学习这门语言。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T01:00:26.343

有点像（取决于你对结果做了什么）

```
if(blocks[i][j].isColorBox()) {
    //... pieceColor
} else {
    //... backgroundColor
} 
```

例如，如果这是一项任务，那么

```
a = b ? c : d; 
```

就好像

```
if(b) {
   a = c;
} else {
   a = c;
} 
```

来自规范[15.25 Conditional Operator ? ：](http://docs.oracle.com/javase/specs/jls/se5.0/html/expressions.html#15.25)

> 条件运算符 ? : 使用一个表达式的布尔值来决定应该评估其他两个表达式中的哪一个。

因此，`b ? c : d`就像一个带有条件的表达式，`c`如果第一个表达式的求值结果`b`为真，则表达式的求值结果将是第二个表达式的求值结果，否则它是 thirst 表达式的求值结果`d`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T01:01:01.903

如果您在方法结束时返回颜色值，则沿着这些思路：

```
if (blocks[i][j].isColorBox()) {
    return pieceColor;
} else {
    return backGroundColor;
} 
```

或者，如果您将颜色值分配给变量：

```
if (blocks[i][j].isColorBox()) {
    someVariable = pieceColor;
} else {
    someVariable = backGroundColor;
} 
```

[无论哪种方式，条件表达式](http://en.wikipedia.org/wiki/Conditional_%28programming%29#As_a_ternary_operator)的“长”版本（又名形式的三元运算符`?:`）将使用 an`if/else`并对值执行某些操作。请注意，条件表达式和条件表达式之间的根本区别在于`if/else`，前者是一个没有*值*的语句，而后者是一个计算其操作数值的表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T01:12:39.097

`?`是[**三元运算符**](http://en.wikipedia.org/wiki/%3F%3a)，它有点类似于 -`if`语句。基本上，

```
bool ? a : b 
```

表示“如果`bool`为真，则使用 value `a`，否则使用 value `b`”。在你的情况下：

```
blocks[i][j].isColorBox() ? pieceColor : backgroundColor 
```

表示“如果`blocks[i][j].isColorBox()`为真，则使用`pieceColor`，否则使用`backgroundColor`”。

* * *

因此，以下通常是等价的：

```
n = blocks[i][j].isColorBox() ? pieceColor : backgroundColor 
```

和

```
if (blocks[i][j].isColorBox()) 
    n = pieceColor;
else 
    n = backgroundColor; 
```

# android - Android - 动画偏移 - 如何防止在偏移尚未通过时绘制视图？

> ID：12810510
> 
> 赞同：0
> 
> 时间：2012-10-10T00:58:29.557
> 
> 标签：android, animation, view, offset

我试图在 1 秒后开始动画。我在我的 XML 文件中使用了属性*“android:startOffset”*，但它并没有完全按照我的预期工作。在我设置的偏移量通过之前，我期望视图甚至不会在其初始位置（即属性“ *fromXDelta* ”和“ *fromYDelta ”中设置的位置）绘制。*这是我的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
android:ordering="sequentially"
android:shareInterpolator="false" >

  <translate
      android:duration="2000"
      android:startOffset="1000"
      android:fromXDelta="-70%p"
      android:fromYDelta="0%p"
      android:interpolator="@android:anim/linear_interpolator"
      android:toXDelta="+0%p"
      android:toYDelta="0%p" />

</set> 
```

如果我尝试使用上面的动画移动我的视图，视图会立即绘制在屏幕的 -70% 位置。然后一秒钟过去了，然后，正如预期的那样，动画开始并开始移动视图。但是，**我不希望在那 1 秒之前绘制视图！**. 我怎样才能做到这一点？

先感谢您。

## 更新

我在 startActivity 调用之后调用上面的 XML（下面的 *R.anim.animation_coming_in*），如下所示：

```
startActivity(new Intent(this, ThankYouActivity.class)); 
overridePendingTransition(R.anim.animation_coming_in, R.anim.animation_coming_out); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:01:47.653

您可以尝试使用一对`alpha`持续时间很短的动画，以便在需要之前隐藏视图。像这样的东西：

```
<set ...>
    <alpha
        android:fromAlpha="0.0"
        android:toAlpha="0.0"
        android:duration="1"
        android:startOffset="0" />
    <alpha
        android:fromAlpha="0.0"
        android:toAlpha="1.0"
        android:duration="1"
        android:startOffset="1000" />
    <translate
        ...
    />
</set> 
```

或者，您可以在代码中实现这组动画。这样做将使您能够使用 a`Handler`在延迟后启动动画，以便在动画开始之前隐藏视图。

# javascript - 使用 Jquery UI datepicker 日期显示淘汰赛

> ID：12810512
> 
> 赞同：0
> 
> 时间：2012-10-10T00:58:45.890
> 
> 标签：javascript, jquery-ui, knockout.js, datepicker, jquery-ui-datepicker

有关详细信息，请参阅此链接[http://jsfiddle.net/pakpatel/5p6Uz/4/](http://jsfiddle.net/pakpatel/5p6Uz/4/)

我们可以在 Datepicker 中设置范围吗，如果第一个日期选择 [ 10/12/2012 ]，那么第二个日期不应早于 10/12/2012，客户可以在 datepicker 中选择 ex.[10/13/2012] 之后的日期。

谁能解释我如何实施。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:59:09.383

通过使用前一行的数据作为新的最小值，它具有挑战性。

工作演示位于[http://jsfiddle.net/photo_tom/5p6Uz/24/](http://jsfiddle.net/photo_tom/5p6Uz/24/)

有两件事是必需的。

1.  添加了一个计算的 observable 以将前一行的选择日期值传递给当前行。
2.  添加了新的 minDate 绑定以在日期选择器上设置 mindate 选项。

这不是一个完整的小提琴。它不能正确处理添加或删除。这是因为 ko.computables 需要重建。

* * *

**编辑：**

更新以处理添加/删除方法。有趣的问题，试图在表中的两个不同行之间传输信息。好挑战。

http://jsfiddle.net/5p6Uz/34/ 上的[解决方案](http://jsfiddle.net/5p6Uz/34/)。

# ruby - 使用哈希键填充二维数组以获得相似的值

> ID：12810531
> 
> 赞同：2
> 
> 时间：2012-10-10T01:01:08.097
> 
> 标签：ruby

我是红宝石的新手。我有一个（已经排序的）具有以下值的哈希。我想根据那里的值将这些键放在多维数组中。所以，例如

为了

```
VALUES - KEYS 
acemrs - a
acemrs - b

acrs - c
acrs - d
acrs - e

aeoopstt - f

for - g

foru -h 
```

我正在寻找像 [ [a,b] , [c,d,e] , [f] , [g] , [h] ] 这样的数组

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T01:29:13.940

```
hash = {'a'=>'acemrs','b'=>'acemrs','c'=>'acrs','d'=>'acrs','e'=>'acrs','f'=>'aeoopstt','g'=>'for','h'=>'foru'}
new_hash = {}

hash.each_pair do |key, value|
  (new_hash[value] ||= []) << key
end

array = new_hash.values 
```

我们使用以前的哈希`values`作为`keys`新的哈希。如果未定义，我们为每个 new 创建一个新数组`keys`，`new_hash[value] ||= []`然后只需将新哈希中的所有键用`<< key`. 新的哈希将类似于

```
{"aeoopstt"=>["f"], "for"=>["g"], "acemrs"=>["b", "a"], "acrs"=>["e", "d", "c"], "foru"=>["h"]} 
```

最后，您只需要这些值，`new_hash.values`然后就完成了。

[哈希 API](http://www.ruby-doc.org/core-1.9.3/Hash.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T07:43:49.707

```
hash.group_by{|k, v| v}.values.map(&:first) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T01:14:06.780

只是解决这个问题：[Ruby multidimensional array](https://stackoverflow.com/questions/7014052/ruby-multidimensional-array)

您可以使用 [NArray](http://narray.rubyforge.org/)，一个 Ruby 数值数组库：

```
require 'narray'

array = NArray[  [a,b] , [c,d,e] , [f] , [g] , [h] ] 
```

然后

`array[1][2]`将返回“b”，并`array[2][3]`返回“e”等。

# websphere - MQ - 2142 错误

> ID：12810535
> 
> 赞同：1
> 
> 时间：2012-10-10T01:01:26.950
> 
> 标签：websphere, ibm-mq

我是 Java-MQ 编程的新手。我面临一个奇怪的问题。

我正在尝试使用 java 向 WMQ V7 发送文本消息。

在我的代码中，我有一个名为 identifier 的属性，我使用该方法将其设置为消息`msg.setStringProperty("IDENTIFIER", "XXXXX");`

我在 Unix 系统中部署了代码，在测试时我收到`MQ-2142`错误 MQRC_HEADER_ERROR。

奇怪的是，当我使用 netbeans-6.9（如独立应用程序）从本地桌面运行相同的代码时，它执行成功。

请帮我解决这个问题？

# python - 在 Python 中为对象数据保留“面包屑”

> ID：12810538
> 
> 赞同：3
> 
> 时间：2012-10-10T01:01:39.493
> 
> 标签：python, reference, breadcrumbs

在 Python 中设计 nosql 数据库应用程序时，我曾多次遇到以下模式：

我想要的是在对象层次结构中动态存储对某些数据的引用，这将使我既可以访问数据又知道它在层次结构中的位置。

例如，假设我有一个对象结构，如：

```
class A(object):
    def __init__(self, val1, val2):
        self.val1 = val1
        self.val2 = val2

class B(object):
     def __init__(self, a):
          # a is an instance of A
          self.a = a

class C(object):
     def __init__(self, b):
          # b is an instance of B
          self.b = b

a = A(0,1)
b = B(a)
c = C(b) 
```

现在，我想（动态地）引用对象内部深处存在的一些数据`c`。
假设我想引用in里面的`val1`of 。我正在做的是制作一个“面包屑”元组来引用数据。然后，我将使用这些面包屑引用的任何类都继承自基类 say ，该基类定义了递归解析面包屑并用于返回它所引用的数据的方法。`A``B``c``('b', 'a', 'val1')``Breadcrumb``getattr`

这是一种模式吗？反模式？有没有办法更简单地做到这一点，或者重新设计我的程序，这样我就不必这样做了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T12:27:20.460

我认为侵入您访问的类没有多大好处（引入超类算作侵入）。为什么他们需要知道他们的属性是以这种方式访问​​还是以那种方式访问​​？他们已经支持`getattr`实现这一点所需的一切。

我只想写一个自由函数`iterative_getattr(obj, attrs)`（也许有更好的名字），它适用于任何对象并访问`attrs`元组定义的属性链。

# c# - 使用 COM Interop 复制 Excel 工作表会丢失单元格颜色

> ID：12810541
> 
> 赞同：3
> 
> 时间：2012-10-10T01:02:37.917
> 
> 标签：c#, .net, excel, com, interop

我尝试了各种使用 COM Interop 合并工作表的方法。

这是我最终得到的结果（为简洁起见，省略了不必要的代码）：

```
 public bool CombineWorkBooks(string exportFilePath, IEnumerable<string> filesToMergeFrom, bool deleteRawFiles)
    {
        var success = false;

        Excel.Application xlApp = null;
        Excel.Workbook mergeToWorkbook = null;
        Excel.Workbooks mergeToWorkbooks = null;
        Excel.Sheets mergeToWorksheets = null;
        Excel.Worksheet defaultWorksheet = null;

        try
        {
            if (filesToMergeFrom == null)
            {
                return false;
            }

            xlApp = new Excel.Application
                    {
                        DisplayAlerts = false,
                        Visible = false,
                        CutCopyMode = Excel.XlCutCopyMode.xlCopy
                    };

            mergeToWorkbooks = xlApp.Workbooks;
            mergeToWorkbook = mergeToWorkbooks.Add(Excel.XlWBATemplate.xlWBATWorksheet);
            mergeToWorksheets = mergeToWorkbook.Worksheets;

            // Get the reference for the [first] empty default worksheet

            if (mergeToWorksheets.Count > 0)
            {
                defaultWorksheet = mergeToWorksheets[1] as Excel.Worksheet;
            }

            if (defaultWorksheet == null)
            {
                return false;
            }

            var reportSheetIndex = 1;
            var fileMergeCount = 0;

            foreach (var mergeFromFilename in filesToMergeFrom)
            {
                fileMergeCount++;

                Excel.Workbook sourceWorkbook = null;
                Excel.Sheets childSheets = null;

                // Make sure file is still there...

                if (!File.Exists(mergeFromFilename))
                {
                    continue;
                }

                try
                {
                    // Open source file

                    sourceWorkbook = mergeToWorkbooks.Open(mergeFromFilename,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing,
                                                           Type.Missing);

                    childSheets = sourceWorkbook.Worksheets;

                    if (childSheets != null)
                    {
                        var sheetsCopiedFromSource = 0;

                        // childSheets.Copy(defaultWorksheet, Type.Missing);

                        for (int iChildSheet = 1; iChildSheet <= childSheets.Count; iChildSheet++)
                        {
                            Excel.Worksheet sourceWorksheet = null;

                            try
                            {
                                sourceWorksheet = childSheets[iChildSheet] as Excel.Worksheet;

                                if (sourceWorksheet != null)
                                {
                                    string name = string.Format(baseSheetName, reportSheetIndex.ToString("D4", new CultureInfo(CultureInfo.CurrentCulture.Name)));

                                    // Assigning the worksheet name

                                    sourceWorksheet.Name = Truncate(name, 31); // only 31 char max

                                    // Copy the worksheet before the default sheet

                                    sourceWorksheet.Copy(defaultWorksheet, Type.Missing);

                                    reportSheetIndex++;
                                    sheetsCopiedFromSource++;
                                }
                            }
                            finally
                            {
                                disposeCOMObject(sourceWorksheet);
                            }
                        }

                        // Close the childbook - for some reason, calling close below may cause an 
                        // exception -> System.Runtime.InteropServices.COMException (0x80010108): The object invoked has disconnected from its clients.

                        try
                        {
                            sourceWorkbook.Close(false, Type.Missing, Type.Missing);
                        }
                        catch (COMException comException)
                        {
                            if (comException.ErrorCode != 0x80010108)
                            {
                                throw;
                            }

                            _messages.Add("Caught COMException, discarding it.");
                        }

                        _messages.Add(string.Format("Successfully copied {0} worksheets from report file: '{1}'", sheetsCopiedFromSource, mergeFromFilename));
                    }
                }
                catch (Exception ex)
                {
                    _messages.Add(string.Format("An error occurred processing file '{0}'.", mergeFromFilename));

                }
                finally
                {
                    disposeCOMObject(childSheets);
                    disposeCOMObject(sourceWorkbook);
                }
            }

            // Delete the empty default worksheet

            defaultWorksheet.Delete();

            // Select the first sheet.

            if (mergeToWorksheets.Count > 0)
            {
                Excel.Worksheet firstSheet = null;

                try
                {
                    firstSheet = mergeToWorksheets[1] as Excel.Worksheet;

                    if (firstSheet != null)
                    {
                        firstSheet.Select(Type.Missing);
                        firstSheet.Range["A1"].Select();
                    }
                }
                finally
                {
                    disposeCOMObject(firstSheet);
                }
            }

            // Determine the file extension

            var fileExt = GetExcelExtension();

            if (string.IsNullOrEmpty(Path.GetExtension(exportFilePath)))
            {
                exportFilePath = string.Format("{0}.{1}", exportFilePath, fileExt);
            }
            else if (Path.GetExtension(exportFilePath) != string.Format(".{0}", fileExt))
            {
                exportFilePath = Path.ChangeExtension(exportFilePath, fileExt);
            }

            _mergeOutputFile = exportFilePath;

            // Save the merged output

            mergeToWorkbook.SaveAs(exportFilePath,
                                   Excel.XlFileFormat.xlWorkbookDefault,
                                   Type.Missing,
                                   Type.Missing,
                                   Type.Missing,
                                   Type.Missing,
                                   Excel.XlSaveAsAccessMode.xlExclusive,
                                   Type.Missing,
                                   Type.Missing,
                                   Type.Missing,
                                   Type.Missing,
                                   Type.Missing);

            // Close file

            mergeToWorkbooks.Close();
            xlApp.DisplayAlerts = true;

            success = true;
            return true;
        }
        catch (Exception ex)
        {
            return false;
        }
        finally
        {
            disposeCOMObject(defaultWorksheet);
            disposeCOMObject(mergeToWorksheets);
            disposeCOMObject(mergeToWorkbook);
            disposeCOMObject(mergeToWorkbooks);

            // Quit Excel.

            if (xlApp != null)
            {
                xlApp.Quit();

                disposeCOMObject(xlApp);
            }

            // Only delete source files upon success...

            if (success &&
                deleteRawFiles)
            {
                deleteTemporaryFiles(filesToMergeFrom);
            }

            // Clean up remaining resources

            GC.Collect();
            GC.WaitForPendingFinalizers();
        }
    } 
```

现在 - 这一切都很好。但是......合并文件的单元格/行内部颜色都搞砸了（通常是黑色和紫色 - 3 岁的孩子可能更喜欢）。源工作表有一些行具有突出显示的颜色或除白色以外的背景（内部）颜色。

如果我添加以下代码，我可以将合并文件中的所有单元格颜色重置为白色，但我没有成功地保留原始源表的颜色。

```
 // Reset the background colour in the cells to white. For some reason the worksheet copy
            // operation screws up the cell backgrounds - pinks, purples and other business-like 
            // colours.

            foreach (Excel.Worksheet targetWorksheet in mergeToWorkbook.Worksheets)
            {
                var usedRange = targetWorksheet.UsedRange;

                usedRange.Interior.Color = System.Drawing.ColorTranslator.ToOle(System.Drawing.Color.White);
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T14:31:04.823

我遇到了同样的问题，并找到了以下 Microsoft 支持说明： http: [//support.microsoft.com/kb/2465477](http://support.microsoft.com/kb/2465477) 他们在这里提到了一些解决方法。对我来说，以下解决方案有效：只需将新工作簿的配色方案设置为旧工作簿的配色方案，如下所示：

```
mergeToWorkbook.Colors = sourceWorkbook.Colors; 
```

# jsp - 离开网站时删除在线用户而不按退出按钮

> ID：12810545
> 
> 赞同：0
> 
> 时间：2012-10-10T01:03:20.510
> 
> 标签：jsp

我正在开发一个显示谁在线的网站。我的意思是当用户在线时，该网站将显示他当时在线的所有朋友。

我使用这种方式来确定在线列表：当您登录网站时，会在名为 ONLINE_LIST 的表中插入一条新记录。当您单击退出按钮时，会话将被删除，并且与 ONLINE_LIST 表中的相应记录相同。

问题是，当用户离开我的网站而没有点击退出按钮时，我如何从 online_list 表中删除他的会话。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:14:18.200

您需要使用 JavaScript 来执行此操作。你可以使用事件`beforeunload`。[如何捕获浏览器窗口关闭事件？](https://stackoverflow.com/questions/1631959/browser-window-close-event)

# regex - 对 proxypass 使用正则表达式

> ID：12810547
> 
> 赞同：4
> 
> 时间：2012-10-10T01:03:25.907
> 
> 标签：regex, apache

我正在尝试在我们的标准 http 代理服务器上为我的公司环境的 ActiveMQ 管理页面设置代理。我有一个规则允许我访问管理员登录页面：

`ProxyPass /foobar hostname:8161/admin`

`ProxyPassReverse /foobar hostname:8161/admin`

但是，转到“队列”页面会将我带到一个附加了唯一会话 ID (admin/queues.jsp;jsessionid=oq37zgvxz4zkwliwdwddyon3) 的不同页面，并且我希望该页面也可以通过相同的 URL 访问。

尝试在这些 proxypass 规则末尾添加通配符 (*) 会破坏重定向。是否有需要与此结合使用的重定向规则，以及如何将任何字符串发送到此主机以通过此代理规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T08:24:11.493

这是`ProxyPassMatch`基于正则表达式的，但`ProxyPass`前缀匹配（即 ProxyPass`/foo`也应该捕获`/foo/bar`）所以你当前的规则应该仍然有效。

重定向 URL 可能由于某种原因与反向规则不匹配。我不得不承认，当前端和后端上下文路径不同时，我从来没有设法让`ProxyPass`Tomcat 正常工作，所以我的建议是部署后端应用程序，`hostname:8161/foobar`而不是`/admin`如果这是一个选项。

# c# - C# 线程和阻塞

> ID：12810549
> 
> 赞同：8
> 
> 时间：2012-10-10T01:03:50.677
> 
> 标签：c#, multithreading

我想知道哪种方法以线程安全的方式加载数据更好。传统上，我使用了双锁模式，这很好地达到了目的。现在，随着 System.Lazy 类型的添加，我想知道依赖 Lazy 和 Loading 的内部结构是否更好，并以更好的方式完成工作。它看起来确实更干净，更容易阅读，但它更好吗？

有什么想法吗？

```
namespace SomeNameSpace
{
  public class DataStoreContext
  {
    private readonly static Lazy<DataStoreContext> context = new Lazy<DataStoreContext>(() => new DataStoreContext());
    private Lazy<Dictionary<string, Entity>> _entities = new Lazy<Dictionary<string, Entity>>(() => { return DataStoreContext.Instance.Load(); });
    private readonly object _syncRoot = new object();
    private DataStoreContext()
    {
    }

    public Dictionary<string, Entity> Data
    {
      get { return _entities.Value; }
    }

    public static DataStoreContext Instance
    {
      get { return context.Value; }
    }

    private Dictionary<string, Entity> Load()
    {
      // Load Data from some data store. 
      return null;
    }

    private Dictionary<string, Entity> LoadWithLock()
    {
      if (_entities == null)
      {
        lock (_syncRoot)
        {
          if (_entities == null)
          {
            Dictionary<string, Entity> entities = this.Load();
            _entities = entities;
            return _entities;
          }
        }
      }

      return _entities ;
    }

    public void Clear()
    {

     _entities = new Lazy<Dictionary<string, Entity>>(() => { return DataStoreContext.Instance.Load(); });

    }
  }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T01:08:42.373

> 它看起来确实更干净，更容易阅读，但它更好吗？

是的。双重检查锁定很难做到正确。它需要一个内存屏障才能正确。CIL* 实际上并不能保证您的实施是安全的。

有关详细信息，请参阅[此 Wikipedia 条目](http://en.wikipedia.org/wiki/Double-checked_locking#Usage_in_Microsoft_.NET_.28Visual_Basic.2C_C.23.29)。

通过使用`Lazy<T>`，您获得的代码不仅更干净，而且在所有平台上实际上都是正确的。

*请注意，由于平台的内存模型，这可能在运行 Microsoft 运行时的 x86 和 x64 上完美运行。但是，如果没有适当的内存屏障，规范不能保证它是正确的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T01:07:49.707

根据 MSDN 的文档：

> 默认情况下，Lazy 类的所有公共和受保护成员都是线程安全的，并且可以从多个线程同时使用。这些线程安全保证可以通过类型构造函数的参数可选地和每个实例删除。

对于读写操作来说，它是相当线程安全的。因此，我会说坚持这个，因为它更干净。

但是，正如文档所述，您可以使用构造函数的一些可选参数来关闭该线程安全性。

# excel - 32 位 Excel 加载项能否在 64 位 Excel 中运行？

> ID：12810555
> 
> 赞同：6
> 
> 时间：2012-10-10T01:05:26.080
> 
> 标签：excel, add-in, compatibility, 64-bit

最近，自从我迁移到 Excel 2010 64 位后，我发现我经常使用的许多加载项 (XLL) 停止工作（当我尝试添加时，Excel 报告“无效加载项”错误）。

它是否始终认为 32 位内置加载项永远不会与 64 位 Excel 兼容，或者只是我的加载项的情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-10T01:25:04.070

32 位插件无法在 IE 64 位中运行。32 位驱动程序无法在 64 位 Windows 下运行。32 位加载项无法在 64 位 Office 中运行。不只是你，这是因为 64 位程序无法加载 32 位模块。

请参阅[Office 2010 32 位和 64 位版本之间的兼容性](http://msdn.microsoft.com/en-us/library/office/ee691831.aspx)

> “Office 2010 中的本机 64 位进程无法加载 32 位二进制文​​件。当您拥有现有 Microsoft ActiveX 控件和现有加载项时，这应该是一个常见问题，”

[来自 MS 的另一个链接，关于 32 位和 64 位版本的 Office 之间的差异，以及 64 位版本如何无法运行 32 位加载项。](http://office.microsoft.com/en-us/word-help/choose-the-32-bit-or-64-bit-version-of-office-HA010369476.aspx)

# android - 在 Android 中使用类的新实例

> ID：12810556
> 
> 赞同：0
> 
> 时间：2012-10-10T01:05:36.937
> 
> 标签：android

全新的，刚开始学习应用程序教程。我想运行一个算法来测试它是如何运行的。我让它在java中完美运行，但不确定如何在android中正确创建一个类实例。

```
public class DisplayMessageActivity extends Activity {

    myAlgorithm myAlg = new myAlgorithm();

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);

            // Get the message from the intent
            Intent intent = getIntent();
            String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);

            // Create the text view
            TextView textView = new TextView(this);
            textView.setTextSize(40);
            textView.setText(message);

            // Set the text view as the activity layout
            setContentView(textView);

        } 
```

但是，一旦运行该程序，我就会强制关闭。我认为这不是使用Android的正确方法吗？

TIA

# python - 点安装错误

> ID：12810557
> 
> 赞同：1
> 
> 时间：2012-10-10T01:05:53.950
> 
> 标签：python, pip, codec, easy-install

每当我尝试使用时`pip`，都会收到以下错误：

```
Traceback (most recent call last):
File "/Library/Frameworks/Python.framework/Versions/2.7/bin/pip", line 5, in <module>
    from pkg_resources import load_entry_point
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pkg_resources.py", line 720, in <module>
    class Environment(object):
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pkg_resources.py", line 723, in Environment
    def __init__(self, search_path=None, platform=get_supported_platform(), python=PY_MAJOR):
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pkg_resources.py", line 109, in get_supported_platform
    plat = 'macosx-%s-%s' % ('.'.join(_macosx_vers()[:2]), m.group(3))
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pkg_resources.py", line 221, in _macosx_vers
    version = platform.mac_ver()[0]
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/platform.py", line 804, in mac_ver
    info = _mac_ver_xml()
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/platform.py", line 781, in _mac_ver_xml
    pl = plistlib.readPlist(fn)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plistlib.py", line 78, in readPlist
    rootObject = p.parse(pathOrFile)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plistlib.py", line 406, in parse
    parser.ParseFile(fileobj)
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plistlib.py", line 418, in handleEndElement
    handler()
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plistlib.py", line 452, in end_key
    self.currentKey = self.getData()
File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plistlib.py", line 436, in getData
    data = data.encode("ascii")
LookupError: no codec search functions registered: can't find encoding 
```

尝试运行`sudo easy_install pip`会产生相同的消息。我以前`pip`在尝试`virtualenv`为项目安装时使用并收到了这个。我想不出任何最近的更新或系统更改会导致这种情况。有没有人遇到过这个错误信息？

# php - 如何使用连接从查询中按摩结果集？

> ID：12810559
> 
> 赞同：1
> 
> 时间：2012-10-10T01:06:13.300
> 
> 标签：php, mysql, datamapper

我有一个域模型和一个用 PHP 和 MySql 构建的数据映射器。一些域对象只出现在其他域对象的上下文中，在这些情况下，我使用依赖映射，即依赖对象没有自己的映射器，而是由其所有者的映射器持久化。

出于性能原因，我要连接多个表并发出一个 SQL 查询（而不是每个表一个查询），这就是出现困难的地方：我的查询结果是笛卡尔连接（当然）并且需要相当数量的数组筛选以获取用于填充域对象的合理数据。

例如，我有三个表：一个父 (P1) 和两个子 (C1 和 C2)。如果 P1 中的一条记录在 C1 和 C2 中都有两条记录，那么我的结果集中有四条记录。我可以循环遍历结果集数组以查找唯一值并从中创建一个新数组，但这似乎需要做很多工作。

这注定是一个普遍的问题。解决它的典型方法是什么？我查看了 SPL 数据结构和迭代器，但没有发现任何有用的东西。除非我真的必须这样做，否则我不想拆分为多个查询。

谢谢！

# ios5 - Ipad 上的 Splitview 应用程序

> ID：12810561
> 
> 赞同：1
> 
> 时间：2012-10-10T01:06:18.803
> 
> 标签：ios5, uisplitviewcontroller, master-detail, ipad

我是 iOS 开发和 iPad 应用程序编程的初学者。现在我正在一个 ipad splitview 应用程序中工作，其中我有多个元素。在其他视图的详细视图中，我添加了一个 UISegmentedControl 和一个 UIView，我想要做的是当 Segmentedcontrol 切换时，uiview 应该加载并显示我在项目中拥有的另一个 .nib 文件。我的项目是这样的

* * *

大师 --------------详情

* * *

图片---->图片查看

* * *

视频---->视频查看。

* * *

网站 ---> 网站视图。

* * *

其他------->其他视图（（UIsegmentedControl））--->另一个.nib文件

那么我该怎么做呢？感谢你！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T21:11:41.890

要接收你的 UISegmentedControl 被点击的动作，你需要做

```
 [mySegmentedControl addTarget: self action: @selector(mySegControlClicked:) forControlEvents: UIControlEventValueChanged] ; 
```

然后实现你的 mySegControlClicked 函数，如

```
 -(void)mySegControlClicked: (UISegmentedControl*)sender 
    {
           switch([sender selectedSegmentIndex]) {
                   case 0: //nib loading code ; 
                       break ;
                   case 1: //nib loading code ; 
                       break ;
            } 
    } 
```

有关 Nib 加载代码的帮助，请参阅[从 nib 加载视图](https://stackoverflow.com/questions/9545962/load-view-from-a-nib)

# objective-c - 带有我自己的 sqlite3 构建的 Appcelerator 模块

> ID：12810563
> 
> 赞同：3
> 
> 时间：2012-10-10T01:06:25.720
> 
> 标签：objective-c, ios, c, sqlite, appcelerator

我正在编写一个 appcelerator 模块来使用我自己的 sqlite3 构建。我面临的问题是默认系统sqlite代码似乎无论如何都被链接了。

我已经尝试了很多事情，但我会认为将所有 sqlite 代码放在我的 .m 文件中会导致该代码被调用。

MySqlite.m

```
#import "sqlite3.h"
#import "sqlite3.c"

#pragma Public APIs
-(NSString *)getSqliteVersion:(id)args
{    
    return [NSString stringWithFormat:@"%s", sqlite3_libversion()];
} 
```

getSqliteVersion 成员仍然返回 iOS 标准 sqlite 库的版本号

那么有谁知道如何更改链接器以获取我自己的 sqlite 代码，或者有没有办法将 sqlite “包装”在命名空间等中？

编辑 10/10/12：对不起，更多相关信息。构建过程分为两个步骤。

我正在做的部分是构建模块，它是一个打包的静态库，即一个 .a 文件

这个 .a 文件分发给其他用户，然后他们使用这个模块构建他们的应用程序。这就是为什么我无法控制第二个链接步骤并删除任何 .dylib sqlite 引用的原因。

一些我认为我需要将我的 sqlite lib 放入私有“命名空间”的方式。我在概念上使用命名空间，我知道 C 没有它们

不确定它是否有帮助，但模块构建的 Ti 构建命令似乎是：

从命令行构建设置：

```
SDKROOT = iphonesimulator5.0 
```

=== 使用配置版本构建本机目标 tisqlite_crypt_ios 项目 tisqlite_crypt_ios ===

检查依赖项

```
CompileC build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/Objects-normal/i386/UkCoClinicalsoftwaresolutionsTisqlite_crypt_iosModule.o Classes/UkCoClinicalsoftwaresolutionsTisqlite_crypt_iosModule.m normal i386 objective-c com.apple.compilers.llvm.clang.1_0.compiler
    cd /TitaniumStudioWorkspace/tisqlite_crypt_ios
    setenv LANG en_US.US-ASCII
    setenv PATH "/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Developer/usr/bin:/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/opt/local/bin:/usr/local/git/bin"
    /Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/clang -x objective-c -arch i386 -fmessage-length=0 -fdiagnostics-print-source-range-info -fdiagnostics-show-category=id -fdiagnostics-parseable-fixits -std=c99 -Wno-trigraphs -fpascal-strings -Os -Wno-return-type -Wno-parentheses -Wswitch -Wunused-function -Wno-unused-parameter -Wno-unused-variable -Wno-unused-value -Wno-shorten-64-to-32 -DTI_VERSION= -isysroot /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk -fexceptions -fasm-blocks -mmacosx-version-min=10.6 -gdwarf-2 -Wno-sign-conversion -fobjc-abi-version=2 -fobjc-legacy-dispatch "-DIBOutlet=__attribute__((iboutlet))" "-DIBOutletCollection(ClassName)=__attribute__((iboutletcollection(ClassName)))" "-DIBAction=void)__attribute__((ibaction)" -D__IPHONE_OS_VERSION_MIN_REQUIRED=40000 -iquote /TitaniumStudioWorkspace/tisqlite_crypt_ios/build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/UkCoClinicalsoftwaresolutionsTisqlite_crypt_ios-generated-files.hmap -I/TitaniumStudioWorkspace/tisqlite_crypt_ios/build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/UkCoClinicalsoftwaresolutionsTisqlite_crypt_ios-own-target-headers.hmap -I/TitaniumStudioWorkspace/tisqlite_crypt_ios/build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/UkCoClinicalsoftwaresolutionsTisqlite_crypt_ios-all-target-headers.hmap -iquote /TitaniumStudioWorkspace/tisqlite_crypt_ios/build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/UkCoClinicalsoftwaresolutionsTisqlite_crypt_ios-project-headers.hmap -I/TitaniumStudioWorkspace/tisqlite_crypt_ios/build/Release-iphonesimulator/include "-I/Library/Application Support/Titanium/mobilesdk/osx/2.1.3.GA/iphone/include" "-I/Library/Application Support/Titanium/mobilesdk/osx/2.1.3.GA/iphone/include/TiCore" -I/TitaniumStudioWorkspace/tisqlite_crypt_ios/build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/DerivedSources/i386 -I/TitaniumStudioWorkspace/tisqlite_crypt_ios/build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/DerivedSources -F/TitaniumStudioWorkspace/tisqlite_crypt_ios/build/Release-iphonesimulator -DTI_POST_1_2 -include /var/folders/LP/LPsQmql2FfCGO9YCrCUKUU+++TI/-Caches-/com.apple.Xcode.501/SharedPrecompiledHeaders/UkCoClinicalsoftwaresolutionsTisqlite_crypt_ios_Prefix-hbaweqhgijjnfpfynapljpziqmjk/UkCoClinicalsoftwaresolutionsTisqlite_crypt_ios_Prefix.pch -MMD -MT dependencies -MF /TitaniumStudioWorkspace/tisqlite_crypt_ios/build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/Objects-normal/i386/UkCoClinicalsoftwaresolutionsTisqlite_crypt_iosModule.d -c /TitaniumStudioWorkspace/tisqlite_crypt_ios/Classes/UkCoClinicalsoftwaresolutionsTisqlite_crypt_iosModule.m -o /TitaniumStudioWorkspace/tisqlite_crypt_ios/build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/Objects-normal/i386/UkCoClinicalsoftwaresolutionsTisqlite_crypt_iosModule.o

In file included from /TitaniumStudioWorkspace/tisqlite_crypt_ios/Classes/UkCoClinicalsoftwaresolutionsTisqlite_crypt_iosModule.m:14:
/TitaniumStudioWorkspace/tisqlite_crypt_ios/Classes/sqlite3.c:27620:32:{27620:32-27620:45}{27620:30-27620:31}: warning: implicit conversion from 'long long' to 'long' changes value from 9223372036854775807 to -1 [-Wconstant-conversion,3]
     mask = (sizeof(long)==8) ? LARGEST_INT64 : 0x7fffffff;
                              ~ ^~~~~~~~~~~~~
/TitaniumStudioWorkspace/tisqlite_crypt_ios/Classes/sqlite3.c:7946:25: note: instantiated from:
 #define LARGEST_INT64  (0xffffffff|(((i64)0x7fffffff)<<32))
                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1 warning generated.

Libtool build/Release-iphonesimulator/libUkCoClinicalsoftwaresolutionsTisqlite_crypt_ios.a normal i386
    cd /TitaniumStudioWorkspace/tisqlite_crypt_ios
    setenv MACOSX_DEPLOYMENT_TARGET 10.6
    setenv PATH "/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Developer/usr/bin:/System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/X11/bin:/opt/local/bin:/usr/local/git/bin"
    /Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/libtool -static -arch_only i386 -syslibroot /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator5.0.sdk -L/TitaniumStudioWorkspace/tisqlite_crypt_ios/build/Release-iphonesimulator -filelist /TitaniumStudioWorkspace/tisqlite_crypt_ios/build/tisqlite_crypt_ios.build/Release-iphonesimulator/tisqlite_crypt_ios.build/Objects-normal/i386/UkCoClinicalsoftwaresolutionsTisqlite_crypt_ios.LinkFileList -ObjC -framework Foundation -o /TitaniumStudioWorkspace/tisqlite_crypt_ios/build/Release-iphonesimulator/libUkCoClinicalsoftwaresolutionsTisqlite_crypt_ios.a

** BUILD SUCCEEDED ** 
```

# mysql - SQL多对多查询查找所有多个匹配重复问题

> ID：12810564
> 
> 赞同：3
> 
> 时间：2012-10-10T01:06:26.927
> 
> 标签：mysql, sql, jpql

我一直在使用这样的 JPQL 查询：

```
SELECT s 
FROM Sentence s
INNER JOIN s.words sw
WHERE s.date = :date
AND sw IN (:words)
GROUP BY s
HAVING count(sw) = :numberOfWords 
```

在 SQL 中，s.words 将是多对多中的链接表：word 是我们要匹配的单词的集合：numberOfWords 是集合中的单词数

对于那些不熟悉 JPQL 的人，可以在这里找到类似的 SQL： [SQL query to find matches for multiple criteria](https://stackoverflow.com/questions/5999063/sql-query-to-find-matches-for-multiple-criteria)

我遇到了一个问题，我不知道是设计问题还是查询问题。

所以我有句子 (s) 和单词 (w)，而 sentence_word (sw) 表将两者连接起来。例如句子“Thelead dog of the group is blue”和[ the , cat ]的词集合，这个查询将选择这个句子作为匹配。这是一个误报，因为它包含两次“the”并且不包含“cat”。

在 SQL 中，我认为它是：

```
SELECT s.id
FROM sentence s
JOIN sentence_word sw ON ( sw.s_id = s.id )
JOIN word w ON ( w.id = sw.w_id )
WHERE w.word IN ( 'the', 'cat' )
GROUP BY s.id
HAVING COUNT(1) = 2 
```

我能想到的最简单的解决方案是在链接表中禁止重复，所以这个句子中没有两个链接，只有一个（因此链接表存储该句子包含单词 the，而不是多少次）。但是，我认为有时我会想要多次搜索包含“the”的句子，所以我不想使用这个选项。

请帮忙！

**资源**

可以在此处找到类似搜索和性能的一些很好的示例（感谢链接的回答者）：[How to filter SQL results in a has-many-through relationship](https://stackoverflow.com/questions/7364969/how-to-filter-sql-results-in-a-has-many-through-relation)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T07:27:00.813

更改`HAVING`子句以计算不同的单词，使用 要么`COUNT(DISTINCT sw.w_id) = 2`要么`COUNT(DISTINCT w.word) = 2`：

```
SELECT s.id
FROM sentence s
JOIN sentence_word sw ON ( sw.s_id = s.id )
JOIN word w ON ( w.id = sw.w_id )
WHERE w.word IN ( 'the', 'cat' )
GROUP BY s.id
HAVING COUNT(DISTINCT sw.w_id) = 2 ; 
```

# visual-studio-2010 - 在 Windows 8 上使用 Web 部署发布 WCF 服务失败

> ID：12810568
> 
> 赞同：3
> 
> 时间：2012-10-10T01:07:14.050
> 
> 标签：visual-studio-2010, wcf, webdeploy

我正在尝试使用 Web 部署将 WCF 服务发布到 Windows 8 中的 IIS。发布过程失败并出现以下错误：

Web 部署任务失败。从 'C:\windows\system32\inetsrv\config\schema 读取 IIS 配置架构时出错

是的，我在管理员模式下运行 VS2010。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T14:32:02.543

这是在 Windows 8 和 IIS 8 中使用 WS2012 时的一个已知问题

[http://support.microsoft.com/kb/2735834/en-us?fr=1](http://support.microsoft.com/kb/2735834/en-us?fr=1)

我正在迁移到 VS2012，让我们看看这是否真的解决了这个问题。

# python - python将内置属性函数分配给列表元素

> ID：12810575
> 
> 赞同：2
> 
> 时间：2012-10-10T01:08:16.370
> 
> 标签：python

我不明白为什么下面的代码给出了两个不同的输出

```
class foo(object):

       def myget(self):
          return 3

       goo=property(myget)

       hh1=[1,2,3]
       hh1[0]=property(myget)

       def hh(self):
         print self.goo
         print self.hh1[0]
ff=foo()
ff.hh() 
```

* * *

输出：

```
 3
 <property object at 0x292a998> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:13:56.833

`property`对象是[描述符](http://docs.python.org/howto/descriptor.html)。描述符仅在绑定到类时才具有特殊能力。否则，它们的行为与任何其他类完全相同。当您将属性放在列表中时，它不会绑定到类，因此它会丢失它的特殊属性。

* * *

例如，让我们看一个`property` [用纯 python 编写的](http://docs.python.org/howto/descriptor.html#properties)描述符的实现：

```
class Property(object):
    "Emulate PyProperty_Type() in Objects/descrobject.c"

    def __init__(self, fget=None, fset=None, fdel=None, doc=None):
        self.fget = fget
        self.fset = fset
        self.fdel = fdel
        self.__doc__ = doc

    def __get__(self, obj, objtype=None):
        if obj is None:
            return self
        if self.fget is None:
            raise AttributeError, "unreadable attribute"
        return self.fget(obj)

    def __set__(self, obj, value):
        if self.fset is None:
            raise AttributeError, "can't set attribute"
        self.fset(obj, value)

    def __delete__(self, obj):
        if self.fdel is None:
            raise AttributeError, "can't delete attribute"
        self.fdel(obj) 
```

注意`__get__`,`__set__`和的第二个参数`__delete__`是 obj 吗？ `obj`是描述符绑定到的类的实例（它被传递给方法，`self`好像这有助于澄清事情）。为了使整个 shebang 工作，描述符必须绑定到一个类，以便`__get__`可以调用并`obj`传递给它。如果描述符没有绑定到一个类，那么`__get__`就不会被调用，并且您的描述符类将成为另一个类，其中包含一些永远不会被调用的魔术方法（除非您显式调用它们）。

也许更具体地说，当你这样做时：

```
a = instance.my_descriptor 
```

这调用`my_descriptor.__get__(instance)`并相应地：

```
instance.my_descriptor = a 
```

来电`my_descriptor.__set__(instance,a)`

However, if `my_descriptor` isn't bound to a class, then it behaves just like any other class (object) which explains what you're seeing.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T03:02:24.070

i think it may be related to **dict**. descriptor (property) only respond to attributes inside object or class **dict**. Both hh1[] and goo are in foo.**dict**. but hh1[0] is not, therefore, descriptor doesnt work in hh1[0].

# php - PHP PDO 不执行 SQL 命令

> ID：12810582
> 
> 赞同：1
> 
> 时间：2012-10-10T01:09:47.130
> 
> 标签：php, pdo

我正在编写一个 PHP 脚本来重置用户的密码。我有一个电子邮件和一个令牌检查设置，因此这两个必须在允许用户重置之前有效。到目前为止，一切正常，直到我将密码插入数据库。这是我的 PDO 的代码（我在这些部分破坏了 SQL 查询，因此更容易浏览）：

```
try {
    $sql = "UPDATE users 
            SET password=:password, sessionTime=:sessionTime, sessionID=:sessionID 
            WHERE sessionID=:sessionID";
    $update = $con->prepare($sql);
    $update->bindValue("password", hash("sha256", $password . $salt), PDO::PARAM_STR);
    $update->bindValue("sessionID", "0", PDO::PARAM_STR );
    $update->bindValue("sessionTime", "0", PDO::PARAM_STR );
    $update->execute();
    echo "<br /> Successfully updated the password!";
} catch(PDOException $e) {
     throw new Exception('something went wrong with the password reset', 0, $e);  
} 
```

`$salt`并`$password`在此之前定义，当我运行脚本时，它会输出`Successfully updated the password!`，但是我的数据库中没有任何变化。当我将查询复制并粘贴到 phpMyAdmin 并将`:name`参数更改为实际字符串时，它可以完美运行（更新我的数据库）并且不会返回任何错误 - 而且，我没有得到任何内容`php_error.log`，所以我不太确定为什么这不起作用。

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:13:14.163

您可以像下面这样使用 errorInfo 运行脚本并报告结果：

```
<?php

try {
    $sql = "UPDATE users 
            SET password=:password, sessionTime=:sessionTime, sessionID=:sessionID 
            WHERE sessionID=:sessionID";
    $update = $con->prepare($sql);
    $update->bindValue("password", hash("sha256", $password . $salt), PDO::PARAM_STR);
    $update->bindValue("sessionID", "0", PDO::PARAM_STR );
    $update->bindValue("sessionTime", "0", PDO::PARAM_STR );
    $update->execute();

    var_dump($update->errorInfo());
    echo "<br /> Successfully updated the password!";
} catch(PDOException $e) {
     throw new Exception('something went wrong with the password reset', 0, $e);  
} 
```

# php - 循环生成“A0”到“Z9”

> ID：12810583
> 
> 赞同：-1
> 
> 时间：2012-10-10T01:09:59.407
> 
> 标签：php

在 PHP 中，做一个`for`循环。

你能从`A0`到循环`Z9`吗...我知道一个简单的 for 循环就像

```
for ($i = 0; $i <= 9; $i += 1) {
// do things
} 
```

但是它将如何添加到字母表中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T01:15:35.820

您可以使用[`chr`](http://www.php.net/manual/en/function.chr.php)：

```
for ($letter = ord('a'); $letter <= ord('z'); ++$letter) {
    for ($number = 0; $number <= 9; ++$number) {
        echo chr($letter) . $number;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T01:18:00.820

这是另一种方法，它允许您更改字母的顺序或添加其他符号。

```
$alphabet = str_split('ABCDEFGHIJKLMNOPQRSTUVWXYZ', 1);
for ($index = 0; $index <= 9; $index += 1)
{
    for ($letter = 0; $letter <= count($alphabet) - 1; $letter++)
    {
        // do things
        echo $alphabet[$letter].$index;
    }
} 
```

您可能想要更改符号的一个示例是您想要另一种语言的字母表。说...西班牙语？

```
$alphabet = str_split('ABCDEFGHIJKLMNÑOPQRSTUVWXYZ', 1); 
```

不要忘记你的编码；）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T01:34:25.767

您可以利用 ASCII (97-122) range () 函数和 chr () 函数，避免创建字符数组，例如：

```
$range = range(97, 122); # A to Z ascii chars

# loop 9 times
for ($i=1; $i <= 9; $i++) {
    printf("=========== loop %s\n", $i);
    foreach($range as $n) {
        print chr($n);
        print "\n";       
    }    
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-10T01:13:07.030

~~我认为您需要使用**foreach将字符映射到数组中，循环遍历数组**~~

通过答案：

```
<?php
    for ($i = "A00"; $i <= "Z99"; $i++){    
        print $i;
        print "<br>";
    }    
?> 
```

将A00打印到Z99，非常好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-10T01:16:42.637

```
 for ($i = "A"; $i <= "Z"; $i++) {
       print $i;
   } 
```

打印 AZ。

如果您真的想这样做，您可能必须引入一个介于 0-9 之间的内部循环。

```
 for ($i="A"; $i<"Z"; $i++) {
    for ($j=0; $j <=9; $j++) {
    print $i.$j;

  }

} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-10T01:22:19.853

结合 undefined 和 janenz00 的答案，您可以这样做：

```
for ($i = "A"; $i < "Z"; $i++) {
  for($j = 0; $j < 10; $j++) {
     // Do things like echo $i . $j
  }
} 
```

当然，如果你想循环`A0`到`A9`，然后`B0`到`B9`，一直到`Z0`到，这很有效`Z9`。

# html - jWebScokets 资源管理器支持

> ID：12810584
> 
> 赞同：0
> 
> 时间：2012-10-10T01:09:59.797
> 
> 标签：html, websocket

我正在使用 jWebSockets 来运行一个小型互联网应用程序。尽管该网站说有使用 Flash 桥的资源管理器支持并且这应该是透明的，但我似乎无法让我的应用程序在资源管理器上运行。是否需要做一些事情来支持我缺少的资源管理器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T08:02:26.283

[要使这样](https://github.com/gimite/web-socket-js)的 Flash WebSocket 实现工作，您需要在端口 843 上运行一个 Flash 策略文件服务器，该服务器提供一个指示 Flash 播放器允许出站套接字连接的策略文件。显然，您还需要在客户端 HTML 页面中包含相关的 Flash 文件。只需按照参考中的说明进行操作即可。这个特定的网桥适用于 IE8/9 以及其他缺乏支持 Flash 的浏览器的 WebSocket，例如原生 Android 浏览器（Chrome Mobile 之前）。

# c - 从 sockaddr_storage 中提取 IP 地址和端口信息

> ID：12810587
> 
> 赞同：7
> 
> 时间：2012-10-10T01:10:22.170
> 
> 标签：c, arrays, sockets, udp, ip-address

我目前正在使用接收来自客户端的请求的 UDP 服务器。我收到的数据报是一个 5 个元素长的字节 (char) 数组，最后两个元素是端口号。

最终，该服务器将不得不在自己的数据报中返回 IP 地址和端口号。

我已经知道如何使用 inet_ntop 和我已连接并从中接收到的 sockaddr 结构来打印出 ip，但它返回的字符串不是我想要的格式。例如：

```
string1 = inet_ntop(their_addr.ss_family,get_in_addr(
    (struct sockaddr *)&their_addr),s, sizeof s); 
```

返回：

```
127.0.0.1 
```

或者：

```
[1][2][7][.][0][.][0][.][1] 
```

当我需要类似的东西时：

```
[127][0][0][1] 
```

我应该使用某种字符和数组操作来制作我的 4 元素字节数组吗？或者 sockaddr 是否以某种方式拥有这些信息，我可以将其保留为这种十六进制形式并返回它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-10T04:25:20.830

假设为 IPv4。

在获取您的`sockaddr_storage`或`sockaddr`结构的地址并将其转换为 IPv4 版本`sockaddr_in`之后，您可以访问 IPv4 地址的各个字节。

```
struct sockaddr_in *sin = (struct sockaddr_in *)&their_addr; 
```

然后你可以获取`s_addr`成员的地址，它是一个 32 位值 ( `in_addr_t`)，它包含 ip 地址的 4 个字节（按网络字节顺序），并将其转换为指向 an 的指针`unsigned char`，然后你可以访问该值的各个字节.

```
unsigned char *ip = (unsigned char *)&sin->sin_addr.s_addr;

printf("%d %d %d %d\n", ip[0], ip[1], ip[2], ip[3]); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-05T10:47:55.547

您可能想使用`getnameinfo()`功能：

```
int getnameinfo(const struct sockaddr *sa, socklen_t salen,
                   char *host, size_t hostlen,
                   char *serv, size_t servlen, int flags); 
```

例如：

```
struct sockaddr_storage client_addr;
socklen_t client_len = sizeof(struct sockaddr_storage);

/* Accept client request */
int client_socket = accept(server_socket, 
    (struct sockaddr *)&client_addr, &client_len);

char hoststr[NI_MAXHOST];
char portstr[NI_MAXSERV];

int rc = getnameinfo((struct sockaddr *)&client_addr, 
    client_len, hoststr, sizeof(hoststr), portstr, sizeof(portstr), 
    NI_NUMERICHOST | NI_NUMERICSERV);

if (rc == 0) 
    printf("New connection from %s %s", hoststr, portstr); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-29T06:56:21.417

这是一个简单的不可变类，我用于您在问题中提到的相同目的：

```
class address_t {

private:
    uint16_t m_Port = 0;
    std::string m_Ip = "";

public:
    address_t(const sockaddr_in & address) {
        m_Ip = inet_ntoa(address.sin_addr);
        m_Port = ntohs(address.sin_port);
    }

    uint16_t GetPort() const { return m_Port; }
    std::string GetIp() const { return m_Ip; }
    std::string ToString() const {
        return "IP: " + m_Ip + ", Port: " + std::to_string(m_Port);
    }
}; 
```

# php - PHP MySQL 注入保护

> ID：12810588
> 
> 赞同：0
> 
> 时间：2012-10-10T01:10:47.293
> 
> 标签：php, mysql, urlencode, code-injection

> **可能重复：**
> [在 PHP 中防止 SQL 注入的最佳方法？](https://stackoverflow.com/questions/60174/best-way-to-prevent-sql-injection-in-php)

使用从另一个页面传递的变量时，我调用了以下函数。我的问题是，我可以向其中添加 urlencode 信息并使用一个函数，还是最好为通过地址栏和隐藏表单字段传递信息的变量设置单独的函数？

我没有使用 PDO，并且尽可能进行类型转换。

```
function checkInput($value) {
// Stripslashes
if (get_magic_quotes_gpc())

// Stripslashes
if (get_magic_quotes_gpc())
{
$value = stripslashes($value);
}

// Quote if not a number
{
$value = "'" . mysql_real_escape_string($value) . "'";
}
return $value;
} 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:21:27.867

Mysqli 还支持准备好的语句。如果 mysqli 不可用，总有像 PEAR DB 这样的系统也提供准备好的语句。

# php - 如何在 cakephp 模型类中使用 call_user_func？

> ID：12810590
> 
> 赞同：0
> 
> 时间：2012-10-10T01:11:29.970
> 
> 标签：php, cakephp, callback

我在 cakephp 模型中有以下函数：

```
/**
 *
 * saveMany without MeioUpload validations
 *
 */
public function saveManyDataOnly($data) {
    // since creating records without files, 
    // we need to detach the behavior
    $this->Behaviors->unload('MeioUpload.MeioUpload');

    $result = $this->saveMany($data);

    $this->Behaviors->load('MeioUpload.MeioUpload');        

    return $result;
} 
```

我也需要同样的东西来保存和保存关联。

同样，我的意思是我需要在分别调用 save 和 saveAssociated 后卸载然后重新加载行为。

我不希望使用回调 beforeSave 和 afterSave。

> ***添加：***
> 
> *我也不希望覆盖 save 和 saveAssociated 方法。*
> 
> *原因是有时我想在加载行为的情况下使用 save、saveAssociated、saveMany。*
> 
> **我有时想卸载**行为的主要原因是因为在某些情况下，当我执行 save、saveAssociated 或 saveMany 时，由行为触发的验证和回调是**不可取的**

我当然可以简单地再写 2 个函数，但我相信应该有一种方法可以使用 call_user_func 来完成相同的目标，而无需编写更多代码。

帮助我了解如何编写此类代码以及如何调用新函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:16:36.493

您可以通过传递 'callbacks' => false 暂时禁用回调函数：

```
$this->save($data, array('validate' => true, 'callbacks' => false)); 
```

# objective-c - 获取 tableview 的标题 titleForHeaderInSection

> ID：12810591
> 
> 赞同：1
> 
> 时间：2012-10-10T01:11:52.257
> 
> 标签：objective-c, ios, uitableview

我的 iOS 6 应用程序中有 4 个分段表。这些表都有一个我在 titleForHeaderInSection 中设置的标题。我想知道如何在 didSelectRowAtIndexPath 中使用 NSLog 访问此标题。我确实看到了我在警报中单击的行的字符串值，但我也想要 tableview 部分的标题。我不知道如何得到它。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

NSMutableArray *sectionArray = [self.arrayOfSections objectAtIndex:indexPath.section];

UITableViewCell *selectedCell = [tableView cellForRowAtIndexPath:indexPath];
NSString *cellText = selectedCell.textLabel.text;

NSLog(@"Selected Cell: %@", cellText);

UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Selected a row" message:[sectionArray objectAtIndex:indexPath.row] delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
[alert show];
}

- (NSString *) tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section{

NSString *result = nil;

if ([tableView isEqual:self.myTableView] && section == 0) {

    myTableView.tableHeaderView.tag = FROZEN;
    result = @"Frozen";

} else if ([tableView isEqual:self.myTableView] && section == 1) {

    myTableView.tableHeaderView.tag = FRUIT;
    result = @"Fruit";

}
else if ([tableView isEqual:self.myTableView] && section == 2) {

    myTableView.tableHeaderView.tag = SALADS;
    result = @"Salads";

} else if ([tableView isEqual:self.myTableView] && section == 3) {

    myTableView.tableHeaderView.tag = VEGETABLES;
    result = @"Vegetables";
}

return result;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T02:54:17.743

将部分的标题存储在数组中，

```
NSArray *sectionTitles = [NSArray arrayWithObjects:@"Frozen", @"Fruit", @"Salads", @"Vegetables", nil]; 
```

并将您的`titleForHeaderInSection`方法修改为，

```
- (NSString *) tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section {
NSString *result = [sectionTitles objectAtIndex:section];
//....
return result;
} 
```

修改`didSelectRowAtIndexPath`为，

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
//...
NSLog(@"Header title: %@",  [sectionTitles objectAtIndex:indexPath.section]);
//...
} 
```

另一种选择是使用以下方法`didSelectRowAtIndexPath`

```
NSLog(@"Header title: %@",  [self tableView:tableView titleForHeaderInSection:indexPath.section]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T02:42:06.147

好吧，看起来 UITableView 应该为您提供对此的访问权限，但我没有找到任何东西......我认为实现这一点的最简单方法是创建一个数组（我将其称为 mySectionTitles 并假设它是一个属性）与您的部分标题，然后在 didSelectRowAtIndexPath 中调用`[self.mySectionTitles objectAtIndex:indexPath.section]`并使用返回的字符串执行任何您想要的操作。

# c++ - 定义我自己的新运营商

> ID：12810592
> 
> 赞同：2
> 
> 时间：2012-10-10T01:11:55.410
> 
> 标签：c++, embedded, new-operator

----------------------------------------------1-------- ----------------------------------

我正在为运行嵌入式 Linux 的 ARM 编译程序。我本来是把程序写成c++程序的，所以代码中有一些`operator new`和`operator delete`s。现在，要为典型的 PC 平台编译带有`operator new`s 和`operator delete`s 的东西，我需要为链接器指定一个特定的参数 (-lstdc++)。我不知道这到底是做什么的。

现在，如果我尝试将此链接器选项与我的 ARM 交叉编译器一起使用，我会正确链接，但在运行时会失败并显示以下消息：

> ld.so 检测到不一致：dl-deps.c：622：_dl_map_object_deps：断言“nlist > 1”失败！

如果我省略链接选项，我运行良好。这看起来像是一个断言失败，但这是我愿意冒险猜测的。任何人都可以阐明这个错误或其可能的原因吗？

-----------------------------------------------------------2-- ----------------------------------

我决定省略 (-lstdc++) 选项，并将我的所有类指针替换为指向堆栈上变量实例的指针。这行得通，但它显然是草率的，因为这应该是学生的一个例子，我希望它干净。一个干净的方法是创建我自己的`operator new`and `operator delete`...但我将如何实际使用自定义运算符并不明显。

举个例子，`someClass * foo = new someClass(arg);`这是三个（？）步骤。

1.  调用运算符 new。为新的类实例分配一些内存。
2.  调用类构造函数。
3.  将类实例放入由 operator new 创建的内存位置

我不知道这些步骤的顺序。我不知道如何独立于在堆栈上创建该类型的新变量来调用类构造函数。而且我不知道如何将新的类变量从它开始的地方放入堆中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:06:12.643

首先，修正。您上面的创建语句是两步，而不是三步；类构造函数直接应用于分配的内存区域，以将其从“随机内存”转换为对象实例。不过，否则是对的。

重载 operator new 相对简单。您不必在 operator new 中调用类构造函数；该语言分别处理这些步骤。运算符 new() 本质上只是 C++ 的 malloc() 版本：

```
void *operator new(std::size_t sz) {
    void *out = ::malloc(sz);
    if (!out) throw new std::bad_alloc();
    return out;
} 
```

以上基本模仿了真实的操作符new。您需要对其进行调整以执行使您的代码支持 ARM 所需的任何特殊操作。不过这里有一些魔法，所以要小心。在 operator new() 结束后，该语言会调用您的类构造函数，它可以自由地除外。如果是这样，则需要 C++ 释放由 operator new() 分配的内存（因为程序员没有对它的引用，因此不能自己释放它）。因此，C++ 将在这种情况下神奇地触发 operator delete() ......但前提是它可以找到完美匹配的版本。

TL;DR：如果您重载 operator new()，请始终重载 operator delete()，并确保它们在签名、范围等方面匹配。

# python - 如何在python中找到最近添加到队列的项目？

> ID：12810595
> 
> 赞同：1
> 
> 时间：2012-10-10T01:12:31.107
> 
> 标签：python

我想知道队列中最近排队的项目是什么。我怎么知道这个？

换句话说，如何找到队列将出队的最后一个项目（或最近入队的项目）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:25:37.543

我不完全确定您要在这里实现什么，但以下可能有效，只需检查队列是否为空。

```
>>> from Queue import Queue
>>> q = Queue()    
>>> _ = [q.put(index) for index in xrange(2, 10)]
>>> if not q.empty():
...    q.queue[-1]
9
>>> 
```

我假设您使用的是 python 自己的`Queue`对象，我会推荐它，因为它是线程安全的:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:20:29.357

你是如何实现你的队列的？如果它被实现为一个列表，那么大概`yourdata.pop(0)`会删除并返回第一个项目。最近排队的项目将位于列表的末尾，`yourdata.pop()`以删除并返回，或者 yourdata[-1] 以查看项目而不修改列表内容。

将列表用于队列是一个坏主意，因为您会招致性能损失，但是：每次删除第一个项目时，都必须更新列表中的所有后续项目。您将从专门的队列实现中获得更好的性能，例如`collections.deque`. 参见讨论： [http ://docs.python.org/tutorial/datastructures.html#using-lists-as-queues](http://docs.python.org/tutorial/datastructures.html#using-lists-as-queues)

有关 Python 中 Queue 与 deque 的信息，请参阅： [Queue.Queue 与 collections.deque](https://stackoverflow.com/questions/717148/python-queue-queue-vs-collections-deque)

# java - 如何使用 Eclipse Juno 和 PDT (PHP) 安装 ANTLR IDE

> ID：12810596
> 
> 赞同：3
> 
> 时间：2012-10-10T01:12:32.037
> 
> 标签：java, eclipse, antlr, antlr3, eclipse-pdt

我使用 PHP 和 Java 进行开发。Eclipse PDT 似乎需要 DLTK 4.0，它没有问题。ANTLR IDE 似乎需要 DLTK3。我尝试将插件 3.0 复制到我的 Eclipse 插件/功能目录中：

[http://download.eclipse.org/technology/dltk/downloads/drops/R3.0/S-3.0.1-201108261011/](http://download.eclipse.org/technology/dltk/downloads/drops/R3.0/S-3.0.1-201108261011/)

这在没有 PDT 的机器上工作，但是当我有 PDT 时我无法让它工作。

我也尝试过使用市场，但我得到了相同的依赖错误。

注意我在 64 位 Linux 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T16:56:17.927

Try to add the DLTK 3.0 repository and then install ANTLR again, so maybe Eclipse can fetch the plugin and be able to manage the 2 versions of DLTK installed.

The repository is:

```
http://download.eclipse.org/technology/dltk/updates-dev/3.0-stable/ 
```

# objective-c - 是否可以将参数传递给框架/库？

> ID：12810606
> 
> 赞同：0
> 
> 时间：2012-10-10T01:13:32.053
> 
> 标签：objective-c, ios, xcode, frameworks, libraries

在我的项目中，我在处理多个目标时使用不同的标志来运行不同的代码。就像是

```
#ifdef MY_FLAG
//do this
#else
//do this other
#endif 
```

现在我正在将一些代码带到外部库中，但我不想为每个标志编译不同版本的库，所以问题是：

有没有办法传递类似参数的东西，告诉库（或框架）从外部哪些代码应该以“全局”方式运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:35:49.273

一种选择是让框架提供框架用户可以调用的某种初始化方法或函数。这将告诉框架它应该在什么“模式”下运行。框架的客户端可以在应用程序启动时调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:19:26.327

您正在做的`#ifdef`是确定编译器可以看到哪些代码。因此，您将不得不为每个标志编译不同的版本，因为库已链接但已经编译。我想问题更多的是你如何处理磁盘上的那些。

您可以将多个 CPU 架构存储到一个静态库中。因此，任何仅与您的目标是 ARMv7、ARMv7s 还是 i386 有关的标志都可以使用单个库来处理。

对于其他人，您可能必须生成不同的库。但是，这只是磁盘占用空间的形状问题——您可以使用您链接到库的任何项目的项目设置，以便根据构建配置链接到不同版本的库。

# jquery - jQuery Ajax 抛出：TypeError: this is undefined

> ID：12810618
> 
> 赞同：0
> 
> 时间：2012-10-10T01:14:42.693
> 
> 标签：jquery

```
var submitAjax = {
    url: "processor.php",
    type: "POST",
    data: {  },
    success: function(data, textStatus, jqXHR){
        alert("Thanks ! We're excited and we'll keep you up to date with all the progress !");
    }
};

jQuery.ajax(submitAjax); 
```

在此调用中，我收到错误：TypeError：这是未定义的。在这一点上，我已经向 submitAjax.data 添加了一些 key=>value 片段，并对 ajax 变量的所有元素进行了警报，并且已经成功。

这是我从 Google 的 CDN 引用的 jquery 库：1.8.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-12T19:55:02.310

它也发生在我身上......问题是由于谷歌地图API提供的一些对象放入ajax数据中。您必须将它们转换为您自己的 javascript 对象。

# php - NodeJS setInterval 对性能不利？

> ID：12810622
> 
> 赞同：2
> 
> 时间：2012-10-10T01:15:25.053
> 
> 标签：php, performance, node.js, beanstalkd

我有一个用 nodejs 制作的 beanstalkapp 工作程序，它的作用是有一个 PHP 应用程序可以完成所有站点工作，如果有错误、问题或通知，或者它会将它添加到 beanstalkapp 中。然后，nodejs 需要经常运行，检查 beanstalkapp 是否有任何消息，并对它们做一些事情（给某人发电子邮件，将其添加到日志中，在某处发布）。

我的问题是，这种糟糕的表现是明智的还是有更好的方法来做到这一点？我会假设 setInterval 不会让进程结束，因此会很糟糕？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-10T01:44:14.197

这取决于你的`setInterval`时间。javascript 解释器在事件之间休眠。因此，在这之间，`setInterval`您的 node.js 应用程序消耗零（或几乎零）CPU 时间。

因此，应用程序在整个系统上产生的负载量取决于`setInterval`触发频率。每秒一次几乎不会消耗任何 CPU。另一方面，每 1 毫秒一次（以 1 或 0 的 setInterval 时间调用）可能会使您的系统陷入瘫痪，尤其是当您在资源受限的机器或 VM 上运行时。

根据我的经验，一个好的折衷方案是大约 50 或 100 毫秒（每秒 20 或 10 次）。即使是实时应用（因为人类感知比 20Hz 慢很多），它的响应速度也足够快，并且足够长，对系统的其余部分几乎没有影响。

# sql - 地理列上的 sql server union

> ID：12810624
> 
> 赞同：4
> 
> 时间：2012-10-10T01:15:32.397
> 
> 标签：sql, sql-server-2008, tsql, sqlgeography

我正在使用 sql server 2008 R2，我有两个表，区域和设施。两者都有一个包含地理元素的列。

我想计算地理元素交集的并集，如下所示：

```
SELECT * from Regions join Facilities on [Regions].[geography].STIntersects([Facilities].[geography]) 
```

这当然行不通。区域是大多边形，设施是点，每个点只包含在一个多边形中。

我可以写一些（伪代码）

```
for each r in Regions:
    for each f in Facilities:
        if f.[geography].STIntersects(r.[geography]):
            print r, f 
```

但是使用数据库的全部意义在于操作集合而不是元素，对吗？

那么，有没有更好的方法来做到这一点？

谢谢梅兰妮

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T06:44:26.957

STIntersect() 与所有布尔 SQL Server 函数一样，返回一点，因此它是 0 或 1。
这成为您的 WHERE 条件。

r 和 f 的 foreach 隐含在 JOIN 语句中。

```
SELECT r.geography, f.geography
from Regions r
join Facilities f on r.geography.STIntersects(f.geography)=1 
```

# multithreading - 与 Java 7 不兼容

> ID：12810627
> 
> 赞同：3
> 
> 时间：2012-10-10T01:15:44.833
> 
> 标签：multithreading, java-7, volatile, java-6, incompatibility

对于我的一生，我无法弄清楚为什么这个程序不能在 Java 7 中运行。我在使用 Java 6 时运行它没有任何问题，但是一旦我用 Java 7 运行它，它就不起作用了。

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;

public class HelloWorld implements ActionListener {

JButton button;
boolean state;

public HelloWorld(){
    init();
    state = false;
    System.out.println("state - "+state);

    while (true){
        if (state == true){
            System.out.println("Success");
        }
    }
}

private void init(){
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    button = new JButton("Button");
    button.addActionListener(this);
    frame.add(button);
    frame.pack();
    frame.setVisible(true);
}

@Override
public void actionPerformed(ActionEvent e) {
    JButton source = (JButton)e.getSource();

    if (source == button){
        state = !state;
        System.out.println("state - "+state);
    }
}

/**
 * @param args the command line arguments
 */
public static void main(String[] args) {
    new HelloWorld();
}

} 
```

使用 Java 6，如果我按下按钮，它将打印出短语“Success”，直到我再次按下按钮。使用 Java 7 注册按钮被按下并且 state 的值更改为 true，但永远不会打印短语“Success”。这是怎么回事？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T01:18:21.430

添加`volatile`到字段声明。

如果没有`volatile`，则不能保证字段中的更改在其他线程上可见。
特别是，JITter 可以自由地相信主线程上的字段永远不会改变，从而允许它`if`完全删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:29:28.190

当你显示 JFrame

```
 frame.setVisible(true); 
```

Java 显示窗口并在此行停止执行。

您将窗口配置为在关闭时退出：

```
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

该程序将在您关闭窗口后终止。

所以`init()`调用后的代码永远不会被执行。

# ios - UICollectionView 装饰视图

> ID：12810628
> 
> 赞同：49
> 
> 时间：2012-10-10T01:15:58.650
> 
> 标签：ios, ios6, uicollectionview

有没有人为 iOS 6 UICollectionView 实现了装饰视图？在网上找不到任何关于实现装饰视图的教程。基本上在我的应用程序中，我有多个部分，我只想在每个部分后面显示一个装饰视图。这应该很容易实现，但我没有运气。这让我发疯......谢谢。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2016-08-30T02:57:10.417

这是 Swift 中的**集合视图布局装饰视图教程**（这是 Swift 3，Xcode 8 种子 6）。

* * *

装饰视图不是 UICollectionView 功能；它们本质上属于 UICollectionViewLayout。没有 UICollectionView 方法（或委托或数据源方法）提及装饰视图。UICollectionView 对它们一无所知；它只是做它被告知的事情。

要提供任何装饰视图，您将需要一个 UICollectionViewLayout 子类；这个子类可以自由定义自己的属性和委托协议方法来自定义其装饰视图的配置方式，但这完全取决于您。

为了说明，我将继承 UICollectionViewFlowLayout 以在集合视图的内容矩形的顶部施加一个标题标签。这可能是对装饰视图的愚蠢使用，但它完美地说明了基本原理。为简单起见，我将从对整个内容进行硬编码开始，使客户端无法自定义此视图的任何方面。

在布局子类中实现装饰视图有四个步骤：

1.  定义一个 UICollectionReusableView 子类。

2.  通过调用将 UICollectionReusableView 子类注册到布局（*而不是*集合视图）`register(_:forDecorationViewOfKind:)`。布局的初始化程序是执行此操作的好地方。

3.  实现`layoutAttributesForDecorationView(ofKind:at:)`以返回定位 UICollectionReusableView 的布局属性。要构造布局属性，请调用`init(forDecorationViewOfKind:with:)`并配置属性。

4.  覆盖`layoutAttributesForElements(in:)`以使 的结果`layoutAttributesForDecorationView(ofKind:at:)`包含在返回的数组中。

最后一步是导致装饰视图出现在集合视图中的原因。当集合视图调用`layoutAttributesForElements(in:)`时，它发现生成的数组包含指定种类的装饰视图的布局属性。集合视图对装饰视图一无所知，所以它回到布局，要求这种装饰视图的实际实例。您已经注册了这种装饰视图以对应于您的 UICollectionReusableView 子类，因此您的 UICollectionReusableView 子类被实例化并返回该实例，并且集合视图根据布局属性对其进行定位。

因此，让我们按照步骤操作。定义 UICollectionReusableView 子类：

```
class MyTitleView : UICollectionReusableView {
    weak var lab : UILabel!
    override init(frame: CGRect) {
        super.init(frame:frame)
        let lab = UILabel(frame:self.bounds)
        self.addSubview(lab)
        lab.autoresizingMask = [.flexibleWidth, .flexibleHeight]
        lab.font = UIFont(name: "GillSans-Bold", size: 40)
        lab.text = "Testing"
        self.lab = lab
    }
    required init?(coder aDecoder: NSCoder) {
        fatalError("init(coder:) has not been implemented")
    }
} 
```

现在我们转向我们的 UICollectionViewLayout 子类，我将其称为 MyFlowLayout。我们在布局的初始化程序中注册 MyTitleView；我还定义了剩余步骤所需的一些私有属性：

```
private let titleKind = "title"
private let titleHeight : CGFloat = 50
private var titleRect : CGRect {
    return CGRect(10,0,200,self.titleHeight)
}
override init() {
    super.init()
    self.register(MyTitleView.self, forDecorationViewOfKind:self.titleKind)
} 
```

实施`layoutAttributesForDecorationView(ofKind:at:)`：

```
override func layoutAttributesForDecorationView(
    ofKind elementKind: String, at indexPath: IndexPath) 
    -> UICollectionViewLayoutAttributes? {
        if elementKind == self.titleKind {
            let atts = UICollectionViewLayoutAttributes(
                forDecorationViewOfKind:self.titleKind, with:indexPath)
            atts.frame = self.titleRect
            return atts
        }
        return nil
} 
```

覆盖`layoutAttributesForElements(in:)`；这里的索引路径是任意的（我在前面的代码中忽略了它）：

```
override func layoutAttributesForElements(in rect: CGRect) 
    -> [UICollectionViewLayoutAttributes]? {
        var arr = super.layoutAttributesForElements(in: rect)!
        if let decatts = self.layoutAttributesForDecorationView(
            ofKind:self.titleKind, at: IndexPath(item: 0, section: 0)) {
                if rect.intersects(decatts.frame) {
                    arr.append(decatts)
                }
        }
        return arr
} 
```

这行得通！标题标签“Testing”出现在集合视图的顶部。

* * *

现在我将展示如何使标签可定制。我们将允许客户端设置确定标题的属性，而不是标题“测试”。我会给我的布局子类一个公共`title`属性：

```
class MyFlowLayout : UICollectionViewFlowLayout {
    var title = ""
    // ...
} 
```

使用此布局的人应设置此属性。例如，假设这个集合视图显示美国的 50 个州：

```
func setUpFlowLayout(_ flow:UICollectionViewFlowLayout) {
    flow.headerReferenceSize = CGSize(50,50)
    flow.sectionInset = UIEdgeInsetsMake(0, 10, 10, 10)
    (flow as? MyFlowLayout)?.title = "States" // *
} 
```

我们现在来到一个奇怪的谜题。我们的布局有一个`title`属性，它的值需要以某种方式传递给我们的 MyTitleView 实例。但什么时候可能发生呢？我们不负责实例化 MyTitleView；当集合视图在后台请求实例时，它会自动发生。MyFlowLayout 实例和 MyTitleView 实例没有相遇的时刻。

解决方案是使用布局属性作为信使。MyFlowLayout 永远不会遇到 MyTitleView，但它确实创建了布局属性对象，该对象被传递给集合视图以配置 MyFlowLayout。所以布局属性对象就像一个信封。通过继承 UICollectionViewLayoutAttributes，我们可以在信封中包含我们喜欢的任何信息——比如标题：

```
class MyTitleViewLayoutAttributes : UICollectionViewLayoutAttributes {
    var title = ""
} 
```

这是我们的信封！现在我们重写我们的实现`layoutAttributesForDecorationView`。当我们实例化布局属性对象时，我们实例化我们的子类并设置它的`title`属性：

```
override func layoutAttributesForDecorationView(
    ofKind elementKind: String, at indexPath: IndexPath) -> 
    UICollectionViewLayoutAttributes? {
        if elementKind == self.titleKind {
            let atts = MyTitleViewLayoutAttributes( // *
                forDecorationViewOfKind:self.titleKind, with:indexPath)
            atts.title = self.title // *
            atts.frame = self.titleRect
            return atts
        }
        return nil
} 
```

最后，在 MyTitleView 中，我们实现了该`apply(_:)`方法。这将在集合视图配置装饰视图时调用 - 将布局属性对象作为其参数！所以我们拉出`title`并使用它作为我们标签的文本：

```
class MyTitleView : UICollectionReusableView {
    weak var lab : UILabel!
    // ... the rest as before ...
    override func apply(_ atts: UICollectionViewLayoutAttributes) {
        if let atts = atts as? MyTitleViewLayoutAttributes {
            self.lab.text = atts.title
        }
    }
} 
```

* * *

很容易看出您可以如何扩展该示例以使字体和高度等标签功能可自定义。由于我们是 UICollectionViewFlowLayout 的子类，因此可能还需要进行一些进一步的修改，以便通过下推其他元素来为装饰视图腾出空间。此外，从技术上讲，我们应该`isEqual(_:)`在 MyTitleView 中覆盖以区分不同的标题。所有这些都留给读者作为练习。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-10-10T17:10:44.257

我使用以下自定义布局进行了此操作：

创建 UICollectionReusableView 的子类，例如向其中添加 UIImageView：

```
@implementation AULYFloorPlanDecorationViewCell

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        UIImage *backgroundImage = [UIImage imageNamed:@"Layout.png"];
        UIImageView *imageView = [[UIImageView alloc] initWithFrame:frame];
        imageView.image = backgroundImage;
        [self addSubview:imageView];
    }
    return self;
}

@end 
```

然后在 viewDidLoad 的控制器中使用以下代码注册此子类（用您的自定义布局替换代码）

```
AULYAutomationObjectLayout *automationLayout = (AULYAutomationObjectLayout *)self.collectionView.collectionViewLayout;
[automationLayout registerClass:[AULYFloorPlanDecorationViewCell class]  forDecorationViewOfKind:@"FloorPlan"]; 
```

然后在您的自定义布局中实现以下方法（或类似方法）：

```
- (UICollectionViewLayoutAttributes *)layoutAttributesForDecorationViewOfKind:(NSString *)decorationViewKind atIndexPath:(NSIndexPath *)indexPath
{
    UICollectionViewLayoutAttributes *layoutAttributes = [UICollectionViewLayoutAttributes layoutAttributesForDecorationViewOfKind:decorationViewKind withIndexPath:indexPath];
    layoutAttributes.frame = CGRectMake(0.0, 0.0, self.collectionViewContentSize.width, self.collectionViewContentSize.height);
    layoutAttributes.zIndex = -1;
    return layoutAttributes;
}

- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect
{
    NSMutableArray *allAttributes = [[NSMutableArray alloc] initWithCapacity:4];

    [allAttributes addObject:[self layoutAttributesForDecorationViewOfKind:@"FloorPlan" atIndexPath:[NSIndexPath indexPathForItem:0 inSection:0]]];

    for (NSInteger i = 0; i < [self.collectionView numberOfItemsInSection:0]; i++)
    {
        NSIndexPath *indexPath = [NSIndexPath indexPathForItem:i inSection:0];
        UICollectionViewLayoutAttributes *layoutAttributes = [self layoutAttributesForItemAtIndexPath:indexPath];
        [allAttributes addObject:layoutAttributes];
    }
    return allAttributes;
} 
```

似乎没有文档，但以下文档让我走上了正轨：[iOS 的集合视图编程指南](https://developer.apple.com/library/ios/documentation/WindowsViews/Conceptual/CollectionViewPGforIOS/Introduction/Introduction.html)

更新：为装饰视图而不是 UICollectionViewCell 子类化 UICollectionReusableView 可能更好

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-03T23:38:43.127

以下是在 MonoTouch 中的操作方法：

```
public class DecorationView : UICollectionReusableView
{
    private static NSString classId = new NSString ("DecorationView");
    public static NSString ClassId { get { return classId; } }

    UIImageView blueMarble;

    [Export("initWithFrame:")]
    public DecorationView (RectangleF frame) : base(frame)
    {
        blueMarble = new UIImageView (UIImage.FromBundle ("bluemarble.png"));

        AddSubview (blueMarble);    
    }
}

public class SimpleCollectionViewController : UICollectionViewController
{
    public override void ViewDidLoad ()
    {
        base.ViewDidLoad ();
        //Register the cell class (code for AnimalCell snipped)
        CollectionView.RegisterClassForCell (typeof(AnimalCell), AnimalCell.ClassId);
        //Register the supplementary view class (code for SideSupplement snipped)
        CollectionView.RegisterClassForSupplementaryView (typeof(SideSupplement), UICollectionElementKindSection.Header, SideSupplement.ClassId);

        //Register the decoration view
        CollectionView.CollectionViewLayout.RegisterClassForDecorationView (typeof(DecorationView), DecorationView.ClassId);
    }

 //...snip...
}

public class LineLayout : UICollectionViewFlowLayout
{
    public override UICollectionViewLayoutAttributes[] LayoutAttributesForElementsInRect (RectangleF rect)
    {
        var array = base.LayoutAttributesForElementsInRect (rect);
        /* 
        ...snip content relating to cell layout...
        */
        //Add decoration view
        var attributesWithDecoration = new List<UICollectionViewLayoutAttributes> (array.Length + 1);
        attributesWithDecoration.AddRange (array);
        var decorationIndexPath = NSIndexPath.FromIndex (0);
        var decorationAttributes = LayoutAttributesForDecorationView (DecorationView.ClassId, decorationIndexPath);
        attributesWithDecoration.Add (decorationAttributes);

        var extended = attributesWithDecoration.ToArray<UICollectionViewLayoutAttributes> ();

        return extended;
    }

    public override UICollectionViewLayoutAttributes LayoutAttributesForDecorationView (NSString kind, NSIndexPath indexPath)
    {
        var layoutAttributes = UICollectionViewLayoutAttributes.CreateForDecorationView (kind, indexPath);
        layoutAttributes.Frame = new RectangleF (0, 0, CollectionView.ContentSize.Width, CollectionView.ContentSize.Height);
        layoutAttributes.ZIndex = -1;
        return layoutAttributes;
    }
//...snip...
} 
```

最终结果类似于： ![在此处输入图像描述](../Images/57ecc3ffc7280ee6281fcaa523657240.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-19T06:48:29.253

就我而言：我想从 UITableView 升级到 UICollectionView。

uitableview 部分 >>> 补充视图

uitableview headerView >>> 装饰视图

就我而言，我觉得子类化布局并做其他事情，对于简单的“headerView”（装饰）来说“太多了”

所以我的解决方案只是创建标题视图（不是部分）**作为第一个单元格** 和第**1**部分作为第一部分（第 0 部分的大小为零）

# perl - Perl Win32::OLE Word 单元格文本

> ID：12810629
> 
> 赞同：2
> 
> 时间：2012-10-10T01:16:04.557
> 
> 标签：perl

文本被截断。我已经按照文档对单元格范围和文本选项进行了编码，但是每个单元格的第一个字符被截断，并且只打印每个单元格的最后一句话。不确定这是否与单元格格式有关，但某些单元格具有正确的对齐方式。

任何帮助都会很棒......这是代码

```
use warnings;  
use strict;
use Win32::OLE qw(in with);
use Win32::OLE::Const 'Microsoft Word';
use Win32::OLE::Variant;
my $txt = "";
my $var1 = Win32::OLE::Variant->new(VT_BOOL, 'true');

# we are going be working with MS Word Objects
$Win32::OLE::Warn = 3; 

# get already active Excel application or open new
my $Word = Win32::OLE->GetActiveObject('Word.Application')
    || Win32::OLE->new('Word.Application', 'Quit');  

# open Excel file
my $Book = $Word->Documents-    >Open("http://classroom.kleinisd.net/webs/lbalthazar/upload/2nd_six_weeks_calendar.docx"); 

#$Word->{Visible}= 0; # we don't need to see Word in an active window

# get the first table
my $table = $Word->ActiveDocument->Tables(1);
foreach my $row (1..4)
{
foreach my $col (1..5)
 {
$txt = $table->Cell($row,$col)->Range->{Text};
print "$txt \n";
}
}
print "Closing document and Word\n";
#$Word->ActiveDocument->Close();
$Word->Quit; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T05:20:51.820

可以尝试可见= 1吗？我记得面临可见 = 0 的 ole 对象的问题。

# c++ - 如何在其自己的类定义中将类模板作为模板引用？

> ID：12810630
> 
> 赞同：6
> 
> 时间：2012-10-10T01:16:13.103
> 
> 标签：c++, templates

这是场景：

```
template <template <typename> class T, typename V>
struct parent {
    void do_something();
};

template <typename V>
struct child : public parent<child, V> {
    void do_something(V argument);
    using parent<child, V>::do_something; // C3200: invalid template argument for template parameter 'IMPL', expected a class template
}; 
```

上面的代码无法在给定的行上编译并出现给定的错误（MSVC 9.0）。但是，如果我改写这个，则在类定义之外`child`：

```
template <typename V>
struct parent_identity_meta {
    typedef typename parent<child, V> type; // no error!
}; 
```

我现在可以在以下范围内成功执行以下操作`child`：

```
using parent_identity_meta<V>::type::do_something; 
```

我知道有一个限制（在 C++11 中有所缓解）你不能对模板进行 typedef，但我认为这不是我在这里遇到的问题，否则 typedef in`parent_identity_meta`会失败。当不在其自己的类定义中时，它似乎是`child`指*模板，并且是从其自身内部**生成的类*。

这是可以理解的（`child<V>`每次都要写会很痛苦）；但是有什么办法可以覆盖这种行为吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T01:35:51.770

这是C++03和C++11不同的地方。该标准的相关部分是`[temp.local]/1`. 在 C++03 中，这表明：

> 与普通（非模板）类一样，类模板有一个注入类名（第 9 条）。注入的类名可以与模板参数列表一起使用，也可以不与模板参数列表一起使用。当它在没有模板参数列表的情况下使用时，它等效于注入的类名称后跟 <> 中包含的类模板的模板参数。当它与模板参数列表一起使用时，它指的是指定的类模板特化，可以是当前特化或另一个特化。

这意味着`child`（没有任何模板参数）指的是 specialization `child<V>`。在 C++11 中，它被更改为：

> 像普通（非模板）类一样，类模板有一个注入类名（第 9 条）。注入的类名可以用作模板名或类型名。当它与模板参数列表一起使用时，作为模板模板参数的模板参数，或作为朋友类模板声明的详细类型说明符中的最终标识符，它指的是类模板本身. 否则，它相当于模板名称后跟 <> 中包含的类模板的模板参数。

特别注意`When it is used ... as a template-argument for a template template-parameter ... it refers to the class template itself.`。这意味着在 C++11 中，您的代码将是正确的。

# c - 编译错误'未声明的标识符'C

> ID：12810632
> 
> 赞同：0
> 
> 时间：2012-10-10T01:16:31.927
> 
> 标签：c, pointers, compiler-errors, doubly-linked-list

我几乎完成了我的代码，但它给了我这个错误：' `curtemp: undeclared identifier`'。和' `prevtemp: undeclared identifier`'和' `missing ';' before type`'（最后一个错误在“float curtemp = current->temp;”行。我不知道我的代码有什么问题。我试图从双向链表中删除一些元素，当该元素内部的温度比前一个元素的温度高 5 或低 5。

这是我的 .c 文件：

```
void remove_error(Dlist *list){

    DlistElmt *current;

    current = list->head; 
    //initializes ints for comparison
    float curtemp = current->temp;
    float prevtemp = current->temp;
    //now moves current to next data
    current = current -> next;

    //begins while loop for comparison of data
    while(current != NULL){
        curtemp = current -> temp;

        if((curtemp >= (prevtemp +5)) || (curtemp <= (prevtemp-5))){
            //removes current from the list
            dlist_remove(list, current);

            current = current->next;

        }
    }

 } 
```

这是我的结构元素文件：

```
typedef struct DlistElmt_ {

    int hour;
    int min;
    float temp;

    struct DlistElmt_ *prev;
    struct DlistElmt_ *next;

 } DlistElmt; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:54:55.130

我的猜测是你没有包含***DlistElmt***定义的文件，但是你已经包含了 DlistElmt 的声明，所以编译器知道有一个 DlistElmt 东西，所以你可以使用指向它的指针，但是当你尝试对 DlistElmt 的内容做一些事情时编译器不能用它做任何事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:35:09.257

对于 C89 或 C90，预计变量必须在块（函数或局部块）的开头声明。但是，对于 C99，此限制不适用。因此，很可能，上述 Karthik T & japreiss 的建议必须适用。

您可以尝试仅将浮点变量的声明移动到函数的开头并稍后分配它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T01:48:17.760

您的代码不是 ISO 标准 C89，我怀疑您有 C89 编译器（如 Visual C）。您必须重新编码一些行：

```
DlistElmt *current; 
float curtemp, prevtem;

current = list->head;  
//initializes ints for comparison 
curtemp = prevtemp = current->temp; 
```

做到这一点。

它是`gcc`C89 扩展、C99 标准，也是 C++ 功能，允许在块中间而不是仅在顶部进行声明。当他们遇到“纯”ISO C89 编译器时，这让许多人感到困惑。

您的逻辑中似乎也缺少某些东西。 `prevtemp`一旦设置就永远不会更新。如果`prev`意味着以前，我猜你想在循环内：

```
prevtem = curtemp;
curtemp = current -> temp; 
```

在这种情况下，您的一些初始化步骤是多余的。考虑阅读 Gries 的“编程科学”以了解如何避免这些错误。

# algorithm - Project Euler #22 - 不正确的逻辑？

> ID：12810637
> 
> 赞同：0
> 
> 时间：2012-10-10T01:16:47.207
> 
> 标签：algorithm, coffeescript, logic

我正在解决 Project Euler 中的一些编程挑战。挑战如下：

```
Using names.txt (right click and 'Save Link/Target As...'), 
a 46K text file containing over five-thousand first names, 
begin by sorting it into alphabetical order. Then working out 
the alphabetical value for each name, multiply this value by 
its alphabetical position in the list to obtain a name score.

For example, when the list is sorted into alphabetical order,
COLIN, which is worth 3 + 15 + 12 + 9 + 14 = 53, is the 938th name in the list. 
So, COLIN   would obtain a score of 938  53 = 49714.

What is the total of all the name scores in the file? 
```

所以我用咖啡脚本写了它，但我会解释它的逻辑，这样它就可以理解了。

```
fs = require 'fs'

total = 0
fs.readFile './names.txt', (err,names) ->
  names = names.toString().split(',')
  names = names.sort()

  for num in [0..(names.length-1)]
    asc = 0

    for i in [1..names[num].length]
       asc += names[num].charCodeAt(i-1) - 64

    total += num * asc

  console.log total 
```

所以基本上，我正在读取文件。我将名称拆分为一个数组并对它们进行排序。我正在遍历每个名​​称。当我遍历时，我将遍历每个字符以获取它的 charCode（作为它的所有大写字母）。然后我将它减去 64 以获得它在字母表中的位置。最后，我将`num of the loop * sum of positions of all letters`.

我得到的答案是`870873746`，但它不正确，其他答案的数字略高。

谁能明白为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T01:32:20.757

```
 total += num * asc 
```

我认为这是出错的地方。for 的循环`num`从 0 开始（这就是计算机存储东西的方式）。但是对于排名，开始应该从 1 开始，而不是 0。所以对于填充`total`计数，代码应该是：

```
 total += (num+1) * asc 
```

# ios - 当用户更改联系人访问权限时，应用程序在 iOS 6 中崩溃

> ID：12810638
> 
> 赞同：46
> 
> 时间：2012-10-10T01:17:03.597
> 
> 标签：ios, cocoa-touch, ios6, abaddressbook

我有一个使用通讯录的应用程序。在 iOS 6 中运行时，它会在用户执行需要访问地址簿的操作时运行此代码。

```
if (ABAddressBookGetAuthorizationStatus() == kABAuthorizationStatusNotDetermined)
{
    ABAddressBookRef addressBookRef = ABAddressBookCreateWithOptions(NULL, NULL);

    ABAddressBookRequestAccessWithCompletion(addressBookRef, ^(bool granted, CFErrorRef error)
    {
        if (granted)
        {
            showContactChooser();
        }
    });

    CFRelease(addressBookRef);
}
else if (ABAddressBookGetAuthorizationStatus() == kABAuthorizationStatusAuthorized)
{
    showContactChooser();
}
else
{
    showAccessDeniedAlert();
} 
```

这非常有效：我能够读取联系人信息，当用户拒绝访问时，应用程序会做出相应反应。

但是，如果用户：

1.  允许应用程序中的联系人访问，
2.  退出应用程序，
3.  转到设置->隐私->联系人并禁用应用程序的联系人访问权限，
4.  运行应用程序，
5.  当应用程序在后台运行时，进入设置并启用应用程序的联系人访问权限，

该应用程序立即在内部崩溃`main()`，没有异常信息或有意义的堆栈跟踪。我尝试打开“所有异常”和`[NSException raise]`断点，但这并没有给我更多信息。

即使应用程序在启动期间没有运行上述代码，也可以重现崩溃。

这里发生了什么事？是否有我应该订阅的回调？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-10-10T01:31:31.100

我在自己的应用程序中看到了这一点。我也看到其他人也报告了这一点。我很确定这是故意的行为。操作系统会杀死任何对隐私权限更改做出反应的后台应用程序。苹果似乎对此采取了大锤的方法。这不是崩溃（尽管在调试器中运行时可能会出现这种情况）。应用程序因各种其他原因而终止。将此添加到原因列表中。这给了我们更多的理由在完全重启我们的应用程序时做好恢复应用程序状态的工作。

请注意，此行为适用于所有各种隐私设置，例如联系人、照片、麦克风、日历和相机。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-10T01:27:40.610

通常，当应用程序从暂停状态恢复时，它应该从您的 AppDelegate 调用 application:didEnterForeground。在我看来，那将是您重新调整通讯录权限的好地方。

# recursion - 对序列进行分区 - Clojure 中的递归（或一般的 Lisp）

> ID：12810641
> 
> 赞同：7
> 
> 时间：2012-10-10T01:17:47.420
> 
> 标签：recursion, clojure, lisp

在我正在进行的一个项目中，我遇到了一个有趣的问题，我对其他解决方案感到好奇。我正在阅读“The Little Schemer”，所以我正在尝试一些递归技术。我想知道是否有另一种使用递归的方法来做到这一点，并且如果有一种不使用递归的方法也很感兴趣。

问题是获取一个序列，并通过获取每个第 n 个元素将其划分为一个 seq 序列。例如这个向量：

```
[ :a :b :c :d :e :f :g :h :i ] 
```

当用 n=3 分区时会产生 seq

```
((:a :d :g) (:b :e :h) (:c :f :i)) 
```

n = 4：

```
((:a :e :i) (:b :f) (:c :g) (:d :h)) 
```

等等。我使用两个函数解决了这个问题。第一个创建内部序列，另一个将它们拉在一起。这是我的功能：

```
(defn subseq-by-nth
  "Creates a subsequence of coll formed by starting with the kth element and selecting every nth element."
  [coll k n]
  (cond (empty? coll) nil
        (< (count coll) n) (seq (list (first coll)))
        :else (cons (nth coll k) (subseq-by-nth (drop (+ n k) coll) 0 n))))

(defn partition-by-nth
  ""
  ([coll n]
     (partition-by-nth coll n n))
  ([coll n i]
      (cond (empty? coll) nil
        (= 0 i) nil
        :else (cons (subseq-by-nth coll 0 n) (partition-by-nth (rest coll) n (dec i)))))) 
```

我对仅用于递归的具有多个参数的逐个分区函数并不完全满意，但看不到另一种方式。

这似乎适用于所有测试用例。这是一个体面的方法吗？是不是太复杂了？有没有办法在没有递归的情况下或者在单个递归函数中做到这一点？

感谢您的建议。我是 Clojure 和 Lisp 的新手，所以我在学习不同的技术。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-10T02:25:24.573

我希望有一个更简单的递归定义，它更符合*The Little Schemer*的精神，但是下面的函数 using`take-nth`更加紧凑，因为你说你对替代方法感兴趣：

```
(defn chop [coll n]
  (for [i (range n)]
    (take-nth n (drop i coll)))) 
```

满足您的示例：

```
(chop [:a :b :c :d :e :f :g :h :i ] 3)
;= ((:a :d :g) (:b :e :h) (:c :f :i))

(chop [:a :b :c :d :e :f :g :h :i ] 4)
;= ((:a :e :i) (:b :f) (:c :g) (:d :h)) 
```

在 Clojure 中，内置库会让您走得更远；如果失败，请使用显式递归解决方案。这个版本也很懒；您可能希望使用`lazy-seq`或使用`loop...recur`任何“速记”（显式递归）版本来处理大型数据集而不会破坏堆栈。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T14:25:12.540

编辑是因为原始答案完全没有抓住重点。

当我第一次看到这个问题时，我认为`partition`应用了 clojure.core 函数（请参阅 [ClojureDocs 页面](http://clojuredocs.org/clojure_core/clojure.core/partition)）。

正如戴夫指出的那样，分区仅适用于原始顺序的元素。`take-nth`解决方案显然更好。只是为了感兴趣，将 map 与从分区类型的作品中派生的多个序列相结合。

```
(defn ugly-solution [coll n]
  (apply map list (partition n n (repeat nil) coll)))

(ugly-solution [:a :b :c :d :e :f :g :h :i] 3)
;;=> ((:a :d :g) (:b :e :h) (:c :f :i))
(ugly-solution [:a :b :c :d :e :f :g :h :i] 4)
;;=> ((:a :e :i) (:b :f nil) (:c :g nil) (:d :h nil)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T21:32:32.847

我必须提供这个 Common Lisp 循环：

```
(defun partition-by-nth (list n)
  (loop :with result := (make-array n :initial-element '())
        :for i :upfrom 0
        :and e :in list
        :do (push e (aref result (mod i n)))
        :finally (return (map 'list #'nreverse result)))) 
```

# url - 防止两次编码 URI

> ID：12810650
> 
> 赞同：1
> 
> 时间：2012-10-10T01:19:48.887
> 
> 标签：url, uri

我正在尝试编写一个对 URI 进行编码的函数，以使它们符合[rfc 3986](http://www.ietf.org/rfc/rfc3986.txt)。

即检查除字母以外的每个字符；`/?:@&=+$-_.!~*'()|\^[]``#`被取代`%[hex octet]`

我想确保如果使用已经编码的 URI 调用函数，代码不会破坏它。

到目前为止，我所做的只是寻找一个 '%' 符号，后跟 2 个八位字节字符。我发现我替换的任何其他保留字符。

我还应该做其他检查吗？

不要介意安全问题；他们正在其他地方处理。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:48:29.373

我认为正确编码的 URI 应该总是第二次干净地通过。

原因是无论如何您都必须正确解析 URI，因为`/ @ . : ? & =`在 URI 中包含字符是完全合法的，只要它们出现在正确的位置即可。

**因此，只有在 URI 的该部分不合法**时才对字符进行编码。有了这个断言，你就可以创建一个在每个位置都是合法的编码字符串，所以当你解析它时，就没有什么可以编码的了。

请记住，如果有人向您抛出要编码的 URI，并且它恰好是模棱两可的（*即*，它包含改变 URI 语法的特殊字符），他们就不能期望得到正确的结果。

为了更直接地回答您的问题，我会说是的：鉴于上述所有情况，您只需要对`%`转义序列进行特殊处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:36:17.027

嗯，你怎么知道已经编码的 URI 不应该再次编码？也许URI包含，我不知道，如何编码URI的例子，如果不会被第二次编码，那么解码会破坏它？

也就是说，您可以检查是否只`%`存在允许的字符加号，以及是否每个字符都`%`后跟一个十六进制数字。如果是，则很有可能（但不能保证）编码已经完成。

# css - 带有 Internet Explorer 的自定义项目符号上的工件

> ID：12810652
> 
> 赞同：0
> 
> 时间：2012-10-10T01:20:17.130
> 
> 标签：css, internet-explorer

我已经在可扩展项目上实现了一个带有三角形项目符号的可折叠菜单。单击链接并展开子菜单项时，三角形会旋转。

问题是在 Internet Explorer 中，我的子弹左侧有一条浅色虚线。当我展开项目时它会出现，当我单击页面上的其他位置时它会消失。

![在此处输入图像描述](../Images/a6b09c8b4858b799ad844e1b406904b6.png)

它对应于我的样式表中的任何内容。知道如何摆脱它吗？

这是子弹的样式：

```
#block-menu-menu-intra-acp-menu li.expanded > a{
    padding-left:12px;
    background: url('images/triangle_bullet_down.png') left center no-repeat;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:22:24.097

这可能不是它，但尝试设置`outline: 0;`你的`a`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:22:31.680

这看起来像焦点轮廓。您可以使用 禁用它`outline: 0`，但尝试为您的用户提供一些其他的键盘焦点指示。

# php - PHP纬度经度地址

> ID：12810654
> 
> 赞同：5
> 
> 时间：2012-10-10T01:20:30.943
> 
> 标签：php, geolocation, location, latitude-longitude

我的网站上有一个表格，用户可以在其中输入一个地方的地址。当他们提交表单时，我将此位置转换为纬度/经度并将其存储在 MySQL 数据库中。我正在使用 Google 的地理编码服务进行此转换。问题是我找不到将纬度/经度转换回地址的类或服务，据我所知，Google 的地理编码服务是单向转换。我意识到我可以将物理地址存储在数据库中，但是随着时间的推移，当它可以以更简单的格式存储时，这是浪费空间。有没有人知道从纬度/经度转换为地址的类/服务，或者如果我错了，我可以使用谷歌的地理编码系统？这几天我一直在寻找答案，但找不到任何东西。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2016-01-06T07:04:54.787

将地理坐标转换为地址称为反向地理编码。在此脚本中，我们使用 Google 地图 API，因为它免费、快速且不需要 API 密钥。

Google 尊重地理编码的速率限制是每个 IP 每天 2500 次 API 调用。

**用于 Reveres 地理编码的 PHP 函数**

```
<?
  function getaddress($lat,$lng)
  {
     $url = 'https://maps.googleapis.com/maps/api/geocode/json?latlng='.trim($lat).','.trim($lng).'&sensor=false';
     $json = @file_get_contents($url);
     $data=json_decode($json);
     $status = $data->status;
     if($status=="OK")
     {
       return $data->results[0]->formatted_address;
     }
     else
     {
       return false;
     }
  }
?> 
```

在 getaddress() 函数中传递纬度和经度。成功时将返回地址字符串，否则返回布尔值 false。

**例子**

```
<?php
  $lat= 26.754347; //latitude
  $lng= 81.001640; //longitude
  $address= getaddress($lat,$lng);
  if($address)
  {
    echo $address;
  }
  else
  {
    echo "Not found";
  }
?> 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-09-06T03:56:17.220

```
<?php

/* 
* Given longitude and latitude in North America, return the address using The Google Geocoding API V3
*
*/

function Get_Address_From_Google_Maps($lat, $lon) {

$url = "http://maps.googleapis.com/maps/api/geocode/json?latlng=$lat,$lon&sensor=false";

// Make the HTTP request
$data = @file_get_contents($url);
// Parse the json response
$jsondata = json_decode($data,true);

// If the json data is invalid, return empty array
if (!check_status($jsondata))   return array();

$address = array(
    'country' => google_getCountry($jsondata),
    'province' => google_getProvince($jsondata),
    'city' => google_getCity($jsondata),
    'street' => google_getStreet($jsondata),
    'postal_code' => google_getPostalCode($jsondata),
    'country_code' => google_getCountryCode($jsondata),
    'formatted_address' => google_getAddress($jsondata),
);

return $address;
}

/* 
* Check if the json data from Google Geo is valid 
*/

function check_status($jsondata) {
    if ($jsondata["status"] == "OK") return true;
    return false;
}

/*
* Given Google Geocode json, return the value in the specified element of the array
*/

function google_getCountry($jsondata) {
    return Find_Long_Name_Given_Type("country", $jsondata["results"][0]["address_components"]);
}
function google_getProvince($jsondata) {
    return Find_Long_Name_Given_Type("administrative_area_level_1", $jsondata["results"][0]["address_components"], true);
}
function google_getCity($jsondata) {
    return Find_Long_Name_Given_Type("locality", $jsondata["results"][0]["address_components"]);
}
function google_getStreet($jsondata) {
    return Find_Long_Name_Given_Type("street_number", $jsondata["results"][0]["address_components"]) . ' ' . Find_Long_Name_Given_Type("route", $jsondata["results"][0]["address_components"]);
}
function google_getPostalCode($jsondata) {
    return Find_Long_Name_Given_Type("postal_code", $jsondata["results"][0]["address_components"]);
}
function google_getCountryCode($jsondata) {
    return Find_Long_Name_Given_Type("country", $jsondata["results"][0]["address_components"], true);
}
function google_getAddress($jsondata) {
    return $jsondata["results"][0]["formatted_address"];
}

/*
* Searching in Google Geo json, return the long name given the type. 
* (If short_name is true, return short name)
*/

function Find_Long_Name_Given_Type($type, $array, $short_name = false) {
    foreach( $array as $value) {
        if (in_array($type, $value["types"])) {
            if ($short_name)    
                return $value["short_name"];
            return $value["long_name"];
        }
    }
}

/*
*  Print an array
*/

function d($a) {
    echo "<pre>";
    print_r($a);
    echo "</pre>";
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-10T01:30:57.450

您正在寻找 Google（或其他任何人）的[*反向地理编码*服务](https://developers.google.com/maps/documentation/geocoding/#ReverseGeocoding)。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-12-06T03:39:14.857

地理位置 PHP 将纬度经度转换为地址。首先，您需要获取使用以下链接找到的 google map api 的 api 密钥：

[https://developers.google.com/maps/documentation/geocoding/start#ReverseGeocoding](https://www.lelocode.com/posts/geolocation-php-latitude-longitude-to-address---lelocode)

将以下函数放入您的辅助类并在您想要简单传递 lat 和 long 的任何地方调用该函数后。在传递 lat long 之后，它们返回有关 lat long 值的地址。整个过程称为反向地理编码。

```
/**
 * find address using lat long
 */
public static function geolocationaddress($lat, $long)
{
    $geocode = "https://maps.googleapis.com/maps/api/geocode/json?latlng=$lat,$long&sensor=false&key=AIzaSyCJyDp4TLGUigRfo4YN46dXcWOPRqLD0gQ";
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $geocode);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_PROXYPORT, 3128);
    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
    $response = curl_exec($ch);
    curl_close($ch);
    $output = json_decode($response);
    $dataarray = get_object_vars($output);
    if ($dataarray['status'] != 'ZERO_RESULTS' && $dataarray['status'] != 'INVALID_REQUEST') {
        if (isset($dataarray['results'][0]->formatted_address)) {

            $address = $dataarray['results'][0]->formatted_address;

        } else {
            $address = 'Not Found';

        }
    } else {
        $address = 'Not Found';
    }

    return $address;
} 
```

有关更多详细信息，请查看以下链接： [地理位置 PHP 纬度经度到地址 - Lelocode](https://www.lelocode.com/posts/geolocation-php-latitude-longitude-to-address---lelocode)

# .net - 等效于 dll COM 组件的 app.config

> ID：12810656
> 
> 赞同：0
> 
> 时间：2012-10-10T01:20:38.760
> 
> 标签：.net, com, registry, configuration-files

在 .Net 世界中，有一个标准位置来存储配置值，可以根据您正在部署的环境进行更改。那就是app.config/web.config。

最近我不得不与一些遗留的 COM 组件进行互操作。我了解 COM 组件已在注册表中注册。但是，一个 COM 组件在哪里存储其应用程序特定的设置。

例如，远程服务的 url 将存储在哪里？有没有像.Net这样的标准地方？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T12:25:44.860

COM 组件通常是组件而不是应用程序，因此具有特定设置是没有意义的。这些属于客户端应用程序。

通常，COM 组件由客户端应用程序通过组件提供的接口进行配置。没有什么能阻止组件开发人员实现一些自定义机制（从配置文件中读取），但是 COM 作为一种技术并没有提供开箱即用的功能，所以简而言之，在 .NET 中没有与 app.config 文件等效的 COM . 这类似于 .NET 组件通常没有配置文件：您需要通过它们的属性和方法来配置它们。

OTOH，COM 服务器可以是 .exe（带有暴露的 COM 接口）。在这种情况下，再次由服务器的开发人员提供配置，就像为任何其他可执行文件一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T01:51:00.690

谢谢。

就我的问题而言，我必须打开组件服务，展开 DCOM 配置节点，右键单击与 COM 组件对应的 GUID（可以通过在 COM 互操作类的 Visual Studio 中使用“转到定义”找到） ，然后转到属性，打开位置选项卡并输入远程服务的 IP 地址。

我认为它是特定于 DCOM 的，但这并不明显！

# c++ - C++11中任意类型T的最小值/最大值

> ID：12810657
> 
> 赞同：-2
> 
> 时间：2012-10-10T01:20:40.540
> 
> 标签：c++, templates, max, minimum

有没有办法为任意类型的变量分配`T`最小值或最大值？

```
template <typename T>
void setMax(T& var){
var=MAXIMUM_OF_TYPE_T; //can this be done?
}

T toBeMaxed;
setMax(toBeMaxed); 
```

如果`T`是这样`int`，我也可以这样做

```
var=std::numeric_limits<int>::max(); 
```

反而。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T01:47:22.907

如果您只处理具有 的特化的类型，则`std::numeric_limits<T>::max();`可以按如下方式实现您的函数：

```
#include <limits>
template <typename T>
void setMax(T& var){
    var=std::numeric_limits<T>::max();
}
int main() {
    int intvar;
    setMax(intvar);

    float floatvar;
    setMax(floatvar);

    char charvar;
    setMax(charvar);
} 
```

# json - 使用 newtonsoft，如何在运行时不知道类型的情况下反序列化？

> ID：12810659
> 
> 赞同：14
> 
> 时间：2012-10-10T01:21:02.913
> 
> 标签：json, json.net

所以followwing工作得很好，从字符串json给我一个Team对象：

```
var found = JsonConvert.DeserializeObject<Team>(json); 
```

但是如果我直到运行时才知道类型怎么办？假设我有上面的字符串 json，但我还有另一个字符串类型名称？例如，这不起作用：

```
var found = JsonConvert.DeserializeObject(json, Type.GetType("Team")); 
```

无法将“Newtonsoft.Json.Linq.JArray”类型的对象转换为类型...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-10T20:45:22.360

This worked for me:

```
var type = Type.GetType("My.Namespace.Class");
var myObj = JsonConvert.DeserializeObject(item, type); 
```

The trick is to make sure that `type` is not null by providing the correct class name. If it is, the Deserialization can still work, but the output won't be the type you are wanting. See [MSDN](http://msdn.microsoft.com/en-us/library/w3f99sx1.aspx) for more info on `GetType`.

# html - 合并两行使其成为单行

> ID：12810668
> 
> 赞同：0
> 
> 时间：2012-10-10T01:23:05.193
> 
> 标签：html, css

我需要将表格中的两行合并为一行，以便我可以在该行上应用样式（带渐变的背景）。

我尝试在 colspan = 总列数的表格单元格上使用行跨度，但这不起作用。

尝试在主表头内使用嵌套表，但在这种情况下，表背景没有所需的样式。

**演示**：http: [//jsfiddle.net/Debarupa/EyxkJ/3/](http://jsfiddle.net/Debarupa/EyxkJ/3/)

如果您查看演示，我需要将“附加信息”和列标题合并到一行，以便可以将样式“gridheader”作为一行应用于它们。

任何人的想法？感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T06:58:18.630

尝试对要组合的前两行使用两个不同的类。然后将渐变分成两个，对于这些行中的每一行，第一行的颜色变化为 0-50%，第二行的颜色变化为 50-100%。

这是示例：http: [//jsfiddle.net/EyxkJ/5/](http://jsfiddle.net/EyxkJ/5/)

不确定这是否是最优雅的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T07:56:31.183

我已经创建了一个带有嵌套表的[示例](http://jsfiddle.net/EyxkJ/7/)到表单元格的标题中。

# ruby-on-rails - high_voltage gem 不适用于不以 /pages 开头的 URL

> ID：12810670
> 
> 赞同：0
> 
> 时间：2012-10-10T01:23:16.493
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems, gem, ruby-on-rails-3.2

我似乎无法让[thoughtbot 的高压 gem](https://github.com/thoughtbot/high_voltage)用于不以 . 开头的 URL `/pages`。对于类似 的 URL `www.example.com/pages/company/about`，它可以完美运行。当我添加这条路线时：

```
match '/company/about' => 'high_voltage/pages#show', :id => 'about' 
```

我收到内部服务器错误：

```
Started GET "/company/about" for 127.0.0.1 at 2012-10-09 18:03:45 -0700
Processing by HighVoltage::PagesController#show as HTML
  Parameters: {"id"=>"about"}
Completed 500 Internal Server Error in 2ms

ActionController::RoutingError (No such page: about):
  high_voltage (1.2.0) app/controllers/high_voltage/pages_controller.rb:9:in `block in <class:PagesController>'
  activesupport (3.2.8) lib/active_support/rescuable.rb:80:in `call'
  activesupport (3.2.8) lib/active_support/rescuable.rb:80:in `rescue_with_handler'
  actionpack (3.2.8) lib/action_controller/metal/rescue.rb:15:in `rescue_with_handler' 
```

但是，如果我只是把`about.html.erb`页面放在里面`app/views/pages/about.html.erb`，那么这条路线的一切都会按预期工作：

```
match '/:id' => 'high_voltage/pages#show' 
```

或者这条路线也有效：

```
match '/about' => 'high_voltage/pages#show', :id => 'about' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T18:08:35.680

GitHub 的 jferris 告诉我，我必须在上面设置 id 'company/about'。这奏效了。

# jython - StringTemplate-4：无法呈现 expr 属性

> ID：12810675
> 
> 赞同：0
> 
> 时间：2012-10-10T01:24:41.233
> 
> 标签：jython, template-engine, stringtemplate, stringtemplate-4

根据[StringTemplate 4 wiki](http://www.antlr.org/wiki/display/ST4/Templates#Templates-Attributeexpressions)，我应该能够显示 expr 属性，但我不能。我将 StringTemplate4 与 jython 一起使用。

这是我的模板文件 test.st：

```
test(persons, person) ::= <<
<table>
    <tr><th>Name</th><th>Age</th></tr>
    <tr><td>$person.name$</td><td>$person.age$</td></tr>
    $persons:{p|<tr><td>$p.name$</td><td>$p.age$</td></tr>}$
</table> 
```

这是我的 jython 代码。当我尝试渲染模板时，未显示名称和年龄值。

```
>>> import org.stringtemplate.v4 as st
>>> 
>>> class Person:
...     def __init__(self, name, age):
...         self.name = name
...         self.age = age
... 
>>> group = st.STGroupDir('~/template', '$', '$')
>>> tmpl = group.getInstanceOf('test')
>>> 
>>> tmpl.add('persons', [Person('jim', 25), Person('sam', 46)])
/test()
>>> tmpl.add('person', Person('bob', 55))
/test()
>>> 
>>> print tmpl.render()
<table>
    <tr><th>Name</th><th>Age</th></tr>
    <tr><td></td><td></td></tr>
    <tr><td></td><td></td></tr><tr><td></td><td></td></tr>
</table> 
```

在解释器中，我可以很好地访问 tmpl 中的属性。

```
>>> tmpl.attributes
{person=<__main__.Person instance at 0x54>, persons=[<__main__.Person instance at 0x55>, <__main__.Person instance at 0x56>]}
>>> p = tmpl.getAttribute('person')       
>>> print p.name, p.age
bob 55
>>> for p in tmpl.getAttribute('persons'):
...     print p.name, p.age
... 
jim 25
sam 46 
```

知道为什么这不起作用吗？难道我做错了什么？我还尝试为 Person 类创建 getName() 和 getAge() 方法，但没有运气。如果我创建一个数据聚合，我可以很好地访问属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T17:15:17.843

在 Java 中，这是因为这些属性不是公开的。Jython 如何处理对字段的访问？

# java - 是否可以保留列表 带有休眠注释，其中 E 是接口？

> ID：12810676
> 
> 赞同：1
> 
> 时间：2012-10-10T01:24:50.173
> 
> 标签：java, hibernate, list, interface, annotations

这似乎应该相当简单，但我很难想出一个优雅的解决方案。

让我们使用一个基本文件系统的示例，它由两个带 hibernate 注释的类**File**和**Folder**组成。

我们将两个类的共同属性抽象为**FileSystemObject**接口：

```
public interface FileSystemObject {
    public String getName();
    public URI getWhere();
} 
```

还有两个类：

**文件**：

```
@Entity
@Table(name = "FILE")
public class File implements FileSystemObject, Serializable {

    private static final long serialVersionUID = 1L;

    @Id
    @Column(name = "FILE_ID")
    @GeneratedValue(strategy = GenerationType.AUTO)
    private long id;

    @Column(name = "NAME", nullable = false)
    @Index(name = "FILE_NAME", columnNames={"NAME"})
    private String name;

    @Column(nullable = false)
    private URI where;

    public File() {}

    public File(String name, URI where) {
        this.name = name;
        this.where = where;
    }

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public URI getWhere() {
        return where;
    }

    public void setWhere(URI where) {
        this.where = where;
    }
} 
```

**文件夹**：

```
@Entity
@Table(name = "FOLDER")
public class Folder implements FileSystemObject, Serializable {

    private static final long serialVersionUID = 2L;

    @Id
    @Column(name = "FOLDER_ID")
    @GeneratedValue(strategy = GenerationType.AUTO)
    private long id;

    @Column(name = "NAME", nullable = false)
    @Index(name = "FOLDER_NAME", columnNames={"NAME"})
    private String name;

    @Column(nullable = false)
    private URI where;

    @CollectionOfElements
    @JoinTable(name = "FOLDER_CONTENTS",
               joinColumns = @JoinColumn(name = "FOLDER_ID"))
    private List<FileSystemObject> contents;

    public Folder() {}

    public Folder(String name, URI where, List<FileSystemObject> contents) {
        this.name = name;
        this.where = where;
        this.contents = contents;
    }

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public URI getWhere() {
        return where;
    }

    public void setWhere(URI where) {
        this.where = where;
    }

    public List<FileSystemObject> getContents() {
        return contents;
    }

    public void setContents(List<FileSystemObject> contents) {
        this.contents = contents;
    }
} 
```

从逻辑上讲，**Folder**的内容可以是**File**或**Folder ，因此内容 List 的类型为****FileSystemObject**是有意义的。

现在，假设一切都在 pom.xml 中正确设置，当我尝试生成一些模式时：

```
mvn hibernate3:hbm2ddl 
```

它抛出以下错误：

```
Failed to execute goal org.codehaus.mojo:hibernate3-maven-plugin:2.0:hbm2ddl (generate-ddl) on
project foo: Execution generate-ddl of goal org.codehaus.mojo:hibernate3-maven
plugin:2.0:hbm2ddl failed: Could not determine type for: com.foo.data.FileSystemObject, for
columns: [org.hibernate.mapping.Column(element)] -> [Help 1] 
```

希望有人可以对此有所了解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:35:22.003

该类型可能有一个接口，但它不会按照您配置实体的方式工作。为了将两种实体类型组合在同一个集合中，它们需要共享一个公共超类型，该超类型本身就是一个实体。（也就是说，您需要像 FileSystemObject 这样的东西作为它们都继承自的公共超类，在该级别定义 ID。）

问题是，考虑这个查询：

```
select c from Folder f, f.contents c where f.name = 'FOLDER' and c.id = 3; 
```

如果文件夹和文件的 id 为 3，它怎么知道你想要什么？这就是为什么如果它们要在同一个集合中，它们需要共享一个公共超类。

# ruby-on-rails - 导轨 STI。如何计算关联模型的 Upvote 或 Downvote 类型的投票数？

> ID：12810679
> 
> 赞同：0
> 
> 时间：2012-10-10T01:25:07.757
> 
> 标签：ruby-on-rails, single-table-inheritance

模型是`Vote`和`Issue`。`Issue has_many :votes`. 具有 STI 列类型，当用户对某个问题进行投票时，该列类型由问题索引上的隐藏表单`Vote`填充`:Upvote`或填充。`:Downvote`如何找到任一类型`Upvote`或`Downvote`给定问题的投票数？现在我在`Issue`模型上使用这样的方法：

```
 def upvotes_count(issue_id)
     Upvote.count(:conditions => "issue_id = #{issue_id}")
 end

def downvotes_count(issue_id)
      Downvote.count(:conditions => "issue_id = #{issue_id}")
end 
```

当我循环浏览问题索引上的所有问题时，我从视图中传递了 issue_id，如下所示：

```
issue.upvotes_count(issue.id) 
```

这是正确的还是有更好的方法？当我已经在实例上运行时，我似乎不必传递 id。我在控制台中玩过试图弄清楚但无法弄清楚。我知道`@issue.Upvote.count`行不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T03:25:45.557

您有几个选择：在类中定义额外的关联（或方法）`Issue`，或`scope`在`Vote`类中使用。这些示例假设 Rails 3，尽管它们可以很容易地针对 Rails 2.3 进行调整。

1.  中的其他关联`Issue`：

    ```
    class Issue < ActiveRecord::Base

      has_many :votes
      has_many :upvotes, :class_name => "Vote", :conditions => ['type = ?', 'Upvote']
      has_many :downvotes, :class_name => "Vote", :conditions => ['type = ?', 'Downvote']

    end 
    ```

    在这里，我们添加了条件来优化对某个问题的相关投票结果，以便您可以调用`issue.upvotes`和`issue.downvotes`。在这种情况下，要获得对某个问题的赞成票数是`issue.upvotes.count`.

2.  适用范围`Vote`：

    ```
    class Vote

      scope :up, where(:type => 'Upvote')
      scope :down, where(:type => 'Downvote')

    end 
    ```

    Vote 中的`up`and`down`范围提供了关于投票关系的方法，因此您可以调用`issue.votes.up`and `issue.votes.down`。要计算对某个问题的赞成票数很简单`issue.votes.up.count`。

# biztalk - Biztalk 文件适配器复制

> ID：12810680
> 
> 赞同：0
> 
> 时间：2012-10-10T01:25:08.650
> 
> 标签：biztalk

biztalk 2010 cu4，win2k8 服务器，无杀毒

我遇到了一个问题，即 biztalk 文件适配器间歇性地两次拾取完全相同的文件。这发生在 2 个不同应用程序中的 2 个不同接收位置的 unc 远程或本地接收位置。

接收位置具有所有默认设置。我试过设置重命名文件勾选和取消勾选，但没有解决问题。文件掩码为 \H3OR*.txt。

作为副本之间“未解析的交换”的拾取时间永远不会超过 1 秒。2 毫秒是常见的。查看重复项的未解析交换，上下文属性“receivedfilename”完全相同。重复的发生率大约是收到的 8 个文件中的 1 个。

接收位置确实具有 unc 路径的凭据，并且在处理完文件后会删除文件。

重新启动接收位置和 biztalk 主机均无效。

如果您需要更多信息，请告诉我。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T10:54:31.883

有时问题出在其他地方。您确定创建这些文件的上游进程首先没有复制它们，即快速连续发送相同的文件吗？您可以通过创建另一个发送端口来测试这一点，该端口订阅这些文件但将它们写出到一个文件夹但将 %MessageID% 附加到 %SourceFileName%。如果您有 2 个文件具有相同的 %SourceFileName% 但不同的 %MessageID% 且相隔 1 秒或更长时间，则证明问题出在上游。

# java - 在 Java 中定义泛型方法的最佳方法是什么？

> ID：12810685
> 
> 赞同：1
> 
> 时间：2012-10-10T01:25:54.003
> 
> 标签：java, generics

我想在我的一个项目中定义通用静态方法。要求是将方法返回类型作为方法参数之一。

以下是我的解决方案。

```
public static <T> List<T> convertMapToAttribute(Class<T> attrClass, T attr) {
    List<T> list = null;
    if (attrClass.equals(String.class)) {
        list = (List<T>) new ArrayList<String>();
        list.add(attr);
    } else if (attrClass.equals(Integer.class)) {
        list = (List<T>)new ArrayList<Integer>();
        list.add(attr);
    }
    return list;
 } 
```

我有两个问题。

1.  我们可以在不添加@SuppressWarnings("unchecked") 的情况下避免这种警告“警告：[unchecked] unchecked cast”吗？
2.  有没有其他优雅的方法来解决上述问题

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T01:28:53.493

以下应该可以正常工作：

```
List<T> list = new ArrayList<T>(); 
List<T> list = new ArrayList<>(); // Java 7 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-10T01:31:11.990

你就不能做类似...

```
public static <T> List<T> convertMapToAttribute(Class<T> attrClass, T attr) {
    List<T> list = new ArrayList<T>(1);
    list.add(attr);
    return list;
} 
```

反而？

**根据反馈更新**

```
public static <T> List<T> convertMapToAttribute(T attr) {
    List<T> list = new ArrayList<T>(1);
    list.add(attr);
    return list;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T01:36:56.013

通过`Class<T>`作为参数，进行检查转换（并跳过烦人的警告）的方法是调用如果转换失败`attrClass.cast()`将抛出的方法。`ClassCastException`在这种情况下，`T`应该是`String`或`Integer`。

这里的问题是，您正在从列表进行未经检查的`T`转换，`String`或者`Integer`当您应该直接定义列表并使用转换添加元素时：

```
if (attrClass.equals(String.class)) {
    List<String> list =  new ArrayList<String>();
    list.add(attrClass.cast(attr));
} 
```

整数也是如此。

你的方法有点奇怪（实际上我不明白意图），你正在从一个你也传递参数的类型创建一个元素列表......这不也应该工作吗？（因为您创建了一个`T`类型列表并添加了一个类型元素`T`）。

```
public static <T> List<T> convertMapToAttribute(T attr) {
    List<T> list = new ArrayList<T>();
    list.add(attr);
    return list;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T01:32:06.427

1.  据我所知不是

2.  跳过 attrClass 参数，因为它实际上使方法非泛型。

# c# - 单击按钮时如何调用控制器？

> ID：12810687
> 
> 赞同：2
> 
> 时间：2012-10-10T01:26:08.377
> 
> 标签：c#, asp.net-mvc

单击视图中的按钮时，我想调用控制器。如何在 MVC 中执行此操作？

这是我的第一个控制器。

```
public ActionResult DetailForm()
{
    graduandModel model = new graduandModel();

    var ceremonyList = _ceremonyService.GetAllCeremonyByDate(DateTime.Now);

    if (ceremonyList.Count == 0)
    {
        return Content("No ceremony can be loaded");
    }
    else
    {
        foreach (var c in ceremonyList)
        {
            model.AvailableCeremony.Add(new SelectListItem() { 
                Text = "Ceremony at " + c.ceremony_date.ToString(), 
                Value = c.ceremony_id.ToString() });
        }
        return View(model);
    }               
} 
```

这是我的看法。

```
@{
    Layout = "~/Views/Shared/_ColumnsThree.cshtml";
}

@model graduandModel
@using Nop.Web.Models.Hire;
@using Nop.Web.Framework;
@using Telerik.Web.Mvc.UI;
@using System.Linq;

<table>
    <tr>
        <td>
            @Html.LabelFor(model => model.ceremony_id)
        </td>
        <td>
            @Html.DropDownListFor(model => model.ceremony_id, Model.AvailableCeremony)
        </td>
    </tr>
    <tr>
        <td>
            @Html.LabelFor(model => model.first_name):
        </td>
        <td>
            @Html.EditorFor(model => model.first_name)       
        </td>
    </tr>  
    <tr>
        <td>
            @Html.LabelFor(model => model.middle_name):
        </td>
        <td>
            @Html.EditorFor(model => model.middle_name)
        </td> 
    </tr>
    <tr>
        <td>
            @Html.LabelFor(model => model.last_name):
        </td>
        <td >
            @Html.EditorFor(model => model.last_name)
        </td>
    </tr>
    <tr>
        <td>
            @Html.LabelFor(model => model.student_id):
        </td>
        <td>
            @Html.EditorFor(model => model.student_id)  
        </td>
    </tr>    
    <tr>
        <td colspan="2" class="buttons">
            <input type="submit" id="btnsearchgraduand" name="btnsearch" 
                class="searchbutton" value="@T("Search")" />
        </td>
    </tr>
</table> 
```

然后，当我单击搜索按钮时，我想检查输入数据。我应该这样写新控制器吗

```
public ActionResult CheckDegreeDetails()
{
    graduandModel model = new graduandModel();

    var degreeList = _graduandService.GetGraduandByStudent(
        model.ceremony_id, model.first_name, 
        model.middle_name, model.last_name);
    return View(model);
} 
```

或者...

单击按钮时我不知道如何调用控制器...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T02:04:03.203

您想将用户输入字段和提交按钮包装在一个表单中。您可以使用 html 帮助程序，它还可以让您指定要调用的控制器操作。所以修改你的观点：

```
...
@model graduandModel
@using Nop.Web.Models.Hire;
@using Nop.Web.Framework;
@using Telerik.Web.Mvc.UI;
@using System.Linq;

@using(Html.BeginForm("DetailForm", "ControllerName", FormMethod.Post, new {enctype="multipart/form-data"})
{
<table  >

 <tr>
    <td >
        @Html.LabelFor(model => model.ceremony_id)
    </td>
...

//code omitted for brevity

...

<input type="submit" id="btnsearchgraduand" name="btnsearch" class="searchbutton" value="@T("Search")" />

}) 
```

然后在您的控制器中，您需要添加“捕获”此表单的方法。您已经在使用强类型视图，因此捕获数据很容易

```
[HttpPost]
public ActionResult DetailForm (graduandModel model)
{
//do what you need to do with the data here
//the model passed into this method's parameter should 
//contain all the data from the editor templates in the view
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:32:32.207

你有你的按钮的方式，它不会发出请求。

您可以使用 jQuery/javascript。HTML：

Javascript：

```
function callController()
{
 $.get("YourController/Action",data, callBackMethod);

} 
```

[或者您可以使用@using(Html.BeginForm(..))](http://evolpin.wordpress.com/2011/05/09/mvc-and-posting-data-using-html-beginform-and-url-routing/)包装您的输入、按钮等...

# php - 为什么我无法将来自 url 的图像存储在我的文件夹中？

> ID：12810689
> 
> 赞同：1
> 
> 时间：2012-10-10T01:26:26.210
> 
> 标签：php, file-upload, image-uploading

我不知道为什么我不能将图像放在我的文件夹中？

这是我的php代码：

```
 <?php
$img = 'http://ecx.images-amazon.com/images/I/41pg1dHauUL._SL75_.jpg';
$target_path = 'product-images/';
$target_path= $target_path.basename($img);

if(move_uploaded_file($img,$target_path)){
    echo 'Success';
}
else {
    echo 'Error.';
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:28:15.220

如何使用获取图像`cURL`然后将其保存到数据库中`BLOB`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T04:44:56.007

从我在你的代码中可以看出，你实际上并没有得到图像。您可以通过多种方式将图像源下载到您的服务器。

```
$image = file_get_contents($URL); 
```

或者

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $URL);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$image = curl_exec($ch);
curl_close($ch); 
```

我相信 cURL 更快，如果这很重要的话。然后将图像源保存在文件中，

```
file_put_contents( '/path/to/file/myimage.jpg', $image ); 
```

我希望这会有所帮助。

# php - php 类中属性的长列表 - 我可以缩短它吗？

> ID：12810698
> 
> 赞同：3
> 
> 时间：2012-10-10T01:28:00.483
> 
> 标签：php, oop, class, properties

我有两节课。两个类都使用相同的属性列表。这个属性列表有 75 行长。我想把它放在一个单独的文件中，然后两个类都可以访问。但我无法使用包含。

如果发生更改，如何使文件更短并使属性列表更灵活？

我不确定我是否表达了我的观点，所以我举个例子：

我有**类 foo**和**类 bar**。

LIST OF FRUIT 属性*private $apples*、*private $bananas*和*private $grapes*用于这两个类。此外，这两个类都有一些其他属性，这些属性特定于每个类。

我想做这样的事情：

```
class foo 
{
 private $variable_one
 private $variable_two

 //DEFINE THE LIST OF FRUIT PROPERTIES HERE

 public function blahbla...
} 
```

和另一个文件

```
class foo 
{
 private $variable_three
 private $variable_four

 //DEFINE THE LIST OF FRUIT PROPERTIES HERE

 public function gibberish...
} 
```

现在因为将来我可能会扩展我的水果列表并添加菠萝和芒果，但去掉香蕉，将列表作为一个文件放在一个单独的地方会很方便，我可以在其中修改它，以及所做的任何更改将被任何使用水果属性列表的类采用。

它还可以帮助我减少文件的长度......就像我说的，我的水果列表目前有 75 行长，在两个类的前面都有这么长的简介相当烦人。

我感谢任何有关如何实现这两个目标（灵活性和短文件）的意见或建议。

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T01:31:57.720

听起来这两个类都应该继承自定义公共属性的基类。查看[有关对象继承的 PHP 手册](http://www.php.net/manual/en/language.oop5.inheritance.php)。

```
// The base class defines common properties
class FooBase {
  // protected properties will be available to extending classes
  protected $apples;
  protected $bananas;
  protected $oranges;
}
// Foo extends FooBase, inheriting its protected & public properties
class Foo extends FooBase {
  private $variable_one;
  private $variable_two;

  public function __construct() {
    // Initialize some stuff
    $this->apples = 3;
  }
  public function getApples() {
    // $this->apples inherited from FooBase
    echo $this->apples;
  }
}
// Bar also extends FooBase, and inherits the same 3 properties
class Bar extends FooBase {
  private $variable_three;
  private $variable_four;

  public function __construct() {
    $this->oranges = 9;
  }
  public function getOranges() {
    echo "I have {$this->oranges} oranges too!";
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-10T01:34:04.827

您可以使用[继承](http://php.net/manual/en/language.oop5.inheritance.php)：

```
class FruitObject {
    protected $apples;
    protected $bananas;
    // ...
}

class Foo extends FruitObject {
    private $var1;
    private $var2;
}

class Bar extends FruitObject {
    private $var1;
    private $var2;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-19T07:00:24.727

仅仅因为您使用的是 OOP 并不意味着您不能使用数组来存储不同的类型。[这样，在进入实际实现之前，除了继承](http://www.php.net/manual/en/language.oop5.inheritance.php)之外，您不必担心声明所有不同类型的属性。

```
// The base class defines common properties
class FooBase {
  // protected properties will be available to extending classes
  protected $fruit=array();
}
// Foo extends FooBase, inheriting its protected & public properties
class Foo extends FooBase {
  private $variable_one;
  private $variable_two;
  protected $fruitType;

  public function __construct() {
    //declare a fruitType
    $this->fruitType = 'apples';  
    // Initialize some stuff
    $this->fruit[$this->fruitType] = 3;
    //test it on load
    $this->getFruit();
  }
  public function getFruit() {
    // $this->fruit inherited from FooBase
    echo $this->fruit[$this->fruitType];
  }
}
// Bar also extends FooBase, and inherits the same 3 properties
class Bar extends FooBase {
  private $variable_three;
  private $variable_four;
  protected $fruitType;

  public function __construct() {
    $this->fruitType = 'oranges';
    $this->fruit[$this->fruitType] = 9;
    $this->getOtherFruit();
  }
  public function getOtherFruit() {
    echo "I have {$this->fruit[$this->fruitType]} {$this->fruitType} too!";
  }
} 
```

# tridion - Tridion 2011 Sp1 允许将组件的修订版本发布到暂存目标

> ID：12810699
> 
> 赞同：4
> 
> 时间：2012-10-10T01:28:11.713
> 
> 标签：tridion, tridion-2011

这是一个场景：我有一个包含组件 A 的页面。组件 A 有几个链接的组件 B 和 C。如果编辑器修改组件 B 并希望在组件仍在工作流中时发布到暂存目标，以便审阅者可以查看暂存的更改服务器在批准组件 B 之前。当编辑器预览组件时，他可以看到更改，但是当他发布到暂存目标时，它将获取组件 A 的最后签入版本，该版本仍然链接到组件 B 的未修改版本。如何务实覆盖默认行为以允许编辑在完成项目活动之前将其更改发布到暂存环境？

此外，当组件 B 直接插入第二页时，我能够使用以下内容从工作流自动化活动中的 VBScript 发布：

```
Dim strItemURI
strItemURI = CurrentWorkItem.GetItem(2).ID

Dim oComp
Set oComp = TDSE.GetObject(strItemURI, 1)
Call oComp.Publish("tcm:0-13-65537", True, True, False)
Set oComp = Nothing 
```

FinishActivity“自动活动”“发布到暂存”“完成”

我是否需要编写自定义解析器来完成上述场景，以允许在工作流中发布到暂存环境的链接组件的修改版本？

任何想法或样品将不胜感激。

谢谢。

更新：

我正在尝试创建 TBB，它将替换包中项目的修改版本。对此有任何想法吗？这是一些代码：

```
public void Transform(Engine engine, Package package)
{
try
{

 _publicationID = engine.PublishingContext.ResolvedItem.Item.Id.PublicationId;

 string stagingTarget = Settings.GetSetting("StagingTargetUri");
 PublicationTarget target = new PublicationTarget(new TcmUri(stagingTarget),                   engine.GetSession());

if(engine.PublishingContext.ResolvedItem.PublicationTarget!=null){
if     (stagingTarget.Contains(engine.PublishingContext.ResolvedItem.PublicationTarget.Id.ToString()))
{
foreach (Item item in package.GetAllByType(ContentType.Component))
{

VersionedItem versionedItem = (VersionedItem)engine.GetObject(item);

if (versionedItem.LockType.HasFlag(LockType.InWorkflow))
{
Component componentInWorkflow =
(Component)engine.GetObject(new TcmUri(versionedItem.Id.ItemId,   versionedItem.Id.ItemType, versionedItem.Id.PublicationId, 0));

package.Remove(item);
Item mainComponent=  package.CreateTridionItem(ContentType.Component,componentInWorkflow);
package.PushItem(mainComponent);

}
}
}
}

}
catch (Exception ex)
{
throw ex;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T07:35:50.683

根据文档：

> 如果项目满足为发布目标设置的最低批准状态，您可以在工作流中发布项目。如果项目在工作流中并且不满足最低批准状态，则内容管理器会发布项目的最后签入版本。

这意味着您需要：

*   将`Minimum Approval Status`你的设置为**“Staging”**`Publication target`之类的东西

 **![在此处输入图像描述](../Images/ad00691fd7259a680e7f61bae5ae56ba.png)

*   作为工作流程的第一步，`Approval Status`将组件设置为**“暂存”**

![在此处输入图像描述](../Images/77daaaa667c60077e2e3a9e9676dbd77.png)**

# basic - BASIC GOTO 和 GOSUB 语句有什么区别

> ID：12810702
> 
> 赞同：11
> 
> 时间：2012-10-10T01:28:27.247
> 
> 标签：basic

BASIC 编程语言中的 GOTO 和 GOSUB 语句有什么区别？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-10T01:33:57.670

`GOTO`只是跳转到另一行，`GOSUB`跟踪它的来源（大概是在堆栈上），所以当解释器遇到 a 时`RETURN`，它会回到最后一个`GOSUB`被调用的地方。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-09-09T14:53:21.827

提供的其他答案很好地解释了如何使用 GOTO 和 GOSUB，但它们的处理方式存在重要差异。当一个 GOTO 被执行时，它从栈顶开始并遍历所有代码行，直到找到它应该 GOTO 的行。然后，如果您使用另一个 GOTO 语句返回，它会再次进入堆栈顶部并遍历所有内容，直到到达下一个位置。

GOSUB 做的事情几乎和 GOTO 一样，但它记得它在哪里。当您使用 RETURN 语句时，它只是跳回而无需先进入堆栈顶部并再次翻阅所有内容，因此速度要快得多。如果您希望您的代码快速运行，您应该将最常调用的子例程放在堆栈顶部，并使用 GOSUB/RETURN 而不是 GOTO。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T01:35:08.620

当您调用 GOTO 时，程序将跳转到有问题的行并继续执行。

如果你使用 GOSUB，它会做同样的事情，但是在某些时候你可以编写一个 RETURN 语句并且代码将返回到 GOSUB 之后的行。

所以 GOTO 是去 X 而 GOSUB 是去 X 但记住你现在在哪里，这样你以后可以返回。

# android - 如何在android中使布局背景闪烁？

> ID：12810705
> 
> 赞同：1
> 
> 时间：2012-10-10T01:28:52.427
> 
> 标签：android, layout, background

我需要让布局背景闪烁或闪烁，每秒都在变化。我写了这段代码：

```
int colours[]={0xff00ff00, 0xffff0000, 0xff0000ff,0xffffffff};
RelativeLayout fondo;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    fondo = (RelativeLayout) findViewById(R.id.fondo);
    this.fondo.setBackgroundColor(colours[0]);
    this.fondo.setOnTouchListener(this);
} 
```

这是 onTouch 方法：

```
public boolean onTouch(View v, MotionEvent event) {
    if(event.getAction() == MotionEvent.ACTION_UP) {
        int i=1;
        long delay= 1000;
        long time = System.currentTimeMillis();

        while(true) {
            long time2 = System.currentTimeMillis();
            long time3 = (time2 - time);
            if (time3 > delay) {
                this.fondo.setBackgroundColor(colours[i]);
                Log.d("DEBUG", "EEEEEEEEEEEEEEEEEEEEEEEEEEEEE");
                time = System.currentTimeMillis();
                i++;
                if (i >= colores.length)
                    i=0;
            }
        }
    }
    return true;
} 
```

我的问题是我无法每秒更改背景颜色，但我可以每秒编写 Log.d("DEBUG")。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T02:00:35.687

你应该使用`AnimationDrawable`.

如果您在 UI 线程中使用无限循环，则会导致**ANR（Android 无响应）窗口**

```
 public boolean onTouch(View v, MotionEvent event) {

        final int DELAY = 100;

        if(event.getAction() == MotionEvent.ACTION_UP) {

            RelativeLayout fondo = (RelativeLayout) findViewById(R.id.fondo);

            ColorDrawable f = new ColorDrawable(0xff00ff00);
            ColorDrawable f2 = new ColorDrawable(0xffff0000);
            ColorDrawable f3 = new ColorDrawable(0xff0000ff);
            ColorDrawable f4 = new ColorDrawable(0xff0000ff);

            AnimationDrawable a = new AnimationDrawable();
            a.addFrame(f, DELAY);
            a.addFrame(f2, DELAY);
            a.addFrame(f3, DELAY);
            a.addFrame(f4, DELAY);
            a.setOneShot(false);

            fondo.setBackgroundDrawable(a); // This method is deprecated in API 16
            // fondo.setBackground(a); // Use this method if you're using API 16
            a.start();
         }
         return true;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:58:15.793

您需要使用计时器和处理程序。在处理程序中更改背景颜色。[这里](http://mobileorchard.com/android-app-developmentthreading-part-1-handlers/)有一个很好的例子，您可以根据需要对其进行自定义。

# php - 如何从 Facebook 应用程序分享照片

> ID：12810712
> 
> 赞同：1
> 
> 时间：2012-10-10T01:30:25.953
> 
> 标签：php, facebook-graph-api, facebook-javascript-sdk

我想从我的应用程序中将照片分享到我的 Facebook 时间线。我创建了一个提供证书的测验应用程序。我想在 Facebook 上将该证书的图像显示为照片。我检查了 Facebook php SDK，但不知道该怎么做。有没有特定的代码可以做到这一点？我看到一些 Facebook 应用程序直接将图像分享到我的墙上。

这是我尝试过但失败的一些代码：

```
require 'lib/facebook.php';
$facebook = new Facebook(array(
  'appId'  => 'xxxx',
  'secret' => 'xxxxxx',
));
$photo = "";
$message = "Checkout my photo";
$ret_obj = $facebook->api('/me/photos', 'POST', array(
                                         'source' => '@' . $photo,
                                         'message' => $message,
                                         )
                                      );
echo '<pre>Photo ID: ' . $ret_obj['id'] . '</pre>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:21:56.367

我已经发布了有关如何创建相册以及在另一个问题上上传照片的完整代码，您可以参考： http: [//facebook.stackoverflow.com/a/12810351/828705](http://facebook.stackoverflow.com/a/12810351/828705)

# database - 如何在文件级别处理从数据库中删除记录

> ID：12810713
> 
> 赞同：0
> 
> 时间：2012-10-10T01:30:32.400
> 
> 标签：database, algorithm, file-io

我正在开发一个简单的数据库系统（不希望使用股票数据库系统的开销，即使像 gdbm/bdb 一样简单），我试图找出处理删除的最有效方法是什么数据库文件中的记录。

我提出了两种看似幼稚的解决方案，一种在内存方面很昂贵，另一种在磁盘空间方面很昂贵，而且两者在时间方面似乎都很昂贵。第一个涉及将整个数据库读入内存，然后在旧数据库上重写它，但需要删除的记录除外。第二个涉及逐条记录地从旧数据库文件复制到新数据库文件（跳过要删除的记录），然后将新的复制到旧的。

有没有更好的办法？现有的数据库包如何处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:34:54.007

另一种选择是在删除记录时将文件的部分标记为未使用，然后在添加新条目时将其他记录添加到文件的该部分。您可以选择使用某种“收缩”过程，该过程将在指定的时间间隔遵循您提到的方法之一。

我很确定 MySQL 的 innodb 表类型使用与此类似的方法来管理文件（尽管它们不提供收缩方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:35:01.083

您的数据库是作为平面文件实现的吗？我认为您可以考虑使用[B+ 树](http://en.wikipedia.org/wiki/B+_tree) ，因为与您提到的方法相比，它会更简单。

# php - 如何将bcrypted插入mysql？

> ID：12810714
> 
> 赞同：1
> 
> 时间：2012-10-10T01:30:44.483
> 
> 标签：php, mysql, bcrypt

如何在我的 .php 文件中使用 Bcrypt？

### 如果我错了，这就是我将如何设置并纠正我的方式

我查看了以下链接中的信息。[如何在 PHP 中使用 bcrypt 对密码进行哈希处理？](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

如果我理解正确，我会将函数列表放入 .php 文件中。然后在我的主程序上，我会使用类似的东西：`$isGood = $bcrypt->verify('password', $hash);`我的加密密码现在是`$isGood`.

$isGood 是我要存储到数据库中的内容吗？正确的？

### 如何设置我的数据库？

我的字段类型是什么？我只是把它留空吗？或将其标记为文本？如何设置数据库来存储这种类型的密码？我知道我不会使用 md5 或 sha1 作为字段类型，因为那样只会对它进行更多加密，或者是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:47:11.887

根据提供的示例，$isGood 将是 true 或 false，而不是密码。至于您的数据库，您应该使用[binary(60) 作为字段类型](https://stackoverflow.com/questions/5881169/storing-a-hashed-password-bcrypt-in-a-database-type-length-of-column)

基本上，您要完成的是将加密的密码存储在数据库中。由于相同的字符串将始终散列到相同的值（注意换行符），因此您可以根据数据库中的内容检查用户输入的散列。这就是 verify() 方法在您的示例中所做的。然后如果验证返回true，您可以继续，否则密码错误。

我最近刚刚设置了这样的东西 PM 你还有问题吗？

**编辑**

再次阅读本文后，我想我应该提醒您[在提出问题时始终遵循这些准则。](https://stackoverflow.com/questions/how-to-ask)具体来说，请在将来发布实际的代码示例，因为这将有助于使您的问题与其他人更相关。阿罗哈。

# c++ - boost-asio 作为守护进程的“模板”

> ID：12810717
> 
> 赞同：0
> 
> 时间：2012-10-10T01:31:08.590
> 
> 标签：c++, linux, boost, boost-asio, daemon

我正在尝试将一些在 Linux 中作为控制台应用程序运行的演示代码转换为守护进程。

SDK 是在 c++ 中的，所以我去寻找可以完成守护进程需要做的所有事情的 c++ 代码，即启动、分叉、分离、将 std coms 重定向到 syslog、处理信号等。

所以我找到了这个例子：

```
// daemon.cpp
// ~~~~~~~~~~
//
// Copyright (c) 2003-2011 Christopher M. Kohlhoff (chris at kohlhoff dot com)
//
// Distributed under the Boost Software License, Version 1.0\. (See accompanying
// file LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)
//

#include <boost/asio/io_service.hpp>
#include <boost/asio/ip/udp.hpp>
#include <boost/asio/signal_set.hpp>
#include <boost/array.hpp>
#include <boost/bind.hpp>
#include <ctime>
#include <iostream>
#include <syslog.h>
#include <unistd.h>

using boost::asio::ip::udp;

class udp_daytime_server
{
public:
  udp_daytime_server(boost::asio::io_service& io_service)
    : socket_(io_service, udp::endpoint(udp::v4(), 13))
  {
    start_receive();
  }

private:
  void start_receive()
  {
    socket_.async_receive_from(
        boost::asio::buffer(recv_buffer_), remote_endpoint_,
        boost::bind(&udp_daytime_server::handle_receive, this, _1));
  }

  void handle_receive(const boost::system::error_code& ec)
  {
    if (!ec || ec == boost::asio::error::message_size)
    {
      using namespace std; // For time_t, time and ctime;
      time_t now = time(0);
      std::string message = ctime(&now);

      boost::system::error_code ignored_ec;
      socket_.send_to(boost::asio::buffer(message),
          remote_endpoint_, 0, ignored_ec);
    }

    start_receive();
  }

  udp::socket socket_;
  udp::endpoint remote_endpoint_;
  boost::array<char, 1> recv_buffer_;
};

int main()
{
  try
  {
    boost::asio::io_service io_service;

    // Initialise the server before becoming a daemon. If the process is
    // started from a shell, this means any errors will be reported back to the
    // user.
    udp_daytime_server server(io_service);

    // Register signal handlers so that the daemon may be shut down. You may
    // also want to register for other signals, such as SIGHUP to trigger a
    // re-read of a configuration file.
    boost::asio::signal_set signals(io_service, SIGINT, SIGTERM);
    signals.async_wait(
        boost::bind(&boost::asio::io_service::stop, &io_service));

    // Inform the io_service that we are about to become a daemon. The
    // io_service cleans up any internal resources, such as threads, that may
    // interfere with forking.
    io_service.notify_fork(boost::asio::io_service::fork_prepare);

    // Fork the process and have the parent exit. If the process was started
    // from a shell, this returns control to the user. Forking a new process is
    // also a prerequisite for the subsequent call to setsid().
    if (pid_t pid = fork())
    {
      if (pid > 0)
      {
        // We're in the parent process and need to exit.
        //
        // When the exit() function is used, the program terminates without
        // invoking local variables' destructors. Only global variables are
        // destroyed. As the io_service object is a local variable, this means
        // we do not have to call:
        //
        //   io_service.notify_fork(boost::asio::io_service::fork_parent);
        //
        // However, this line should be added before each call to exit() if
        // using a global io_service object. An additional call:
        //
        //   io_service.notify_fork(boost::asio::io_service::fork_prepare);
        //
        // should also precede the second fork().
        exit(0);
      }
      else
      {
        syslog(LOG_ERR | LOG_USER, "First fork failed: %m");
        return 1;
      }
    }

    // Make the process a new session leader. This detaches it from the
    // terminal.
    setsid();

    // A process inherits its working directory from its parent. This could be
    // on a mounted filesystem, which means that the running daemon would
    // prevent this filesystem from being unmounted. Changing to the root
    // directory avoids this problem.
    chdir("/");

    // The file mode creation mask is also inherited from the parent process.
    // We don't want to restrict the permissions on files created by the
    // daemon, so the mask is cleared.
    umask(0);

    // A second fork ensures the process cannot acquire a controlling terminal.
    if (pid_t pid = fork())
    {
      if (pid > 0)
      {
        exit(0);
      }
      else
      {
        syslog(LOG_ERR | LOG_USER, "Second fork failed: %m");
        return 1;
      }
    }

    // Close the standard streams. This decouples the daemon from the terminal
    // that started it.
    close(0);
    close(1);
    close(2);

    // We don't want the daemon to have any standard input.
    if (open("/dev/null", O_RDONLY) < 0)
    {
      syslog(LOG_ERR | LOG_USER, "Unable to open /dev/null: %m");
      return 1;
    }

    // Send standard output to a log file.
    const char* output = "/tmp/asio.daemon.out";
    const int flags = O_WRONLY | O_CREAT | O_APPEND;
    const mode_t mode = S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH;
    if (open(output, flags, mode) < 0)
    {
      syslog(LOG_ERR | LOG_USER, "Unable to open output file %s: %m", output);
      return 1;
    }

    // Also send standard error to the same log file.
    if (dup(1) < 0)
    {
      syslog(LOG_ERR | LOG_USER, "Unable to dup output descriptor: %m");
      return 1;
    }

    // Inform the io_service that we have finished becoming a daemon. The
    // io_service uses this opportunity to create any internal file descriptors
    // that need to be private to the new process.
    io_service.notify_fork(boost::asio::io_service::fork_child);

    // The io_service can now be used normally.
    syslog(LOG_INFO | LOG_USER, "Daemon started");
    io_service.run();
    syslog(LOG_INFO | LOG_USER, "Daemon stopped");
  }
  catch (std::exception& e)
  {
    syslog(LOG_ERR | LOG_USER, "Exception: %s", e.what());
    std::cerr << "Exception: " << e.what() << std::endl;
  }
} 
```

* * *

无论如何，我想知道，这是启动和运行最小守护程序的好选择（替换 udp 服务器代码并替换为我自己的代码），还是我应该研究另一种获取守护程序功能的方法。

我也对我应该从哪里开始我的代码感到困惑，因为本示例中的最后一步是调用 io_service.run()。

我的代码将有两个线程，一个用于侦听连接，另一个用于每 10 秒处理一次挂起的连接->来自连接客户端的更新没有时间关键的更新窗口，甚至可以偶尔跳过。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T18:31:15.163

如果您正在寻找一种快速简便的实施方式，那么这可能是一个好主意。至少，它提供了一种处理信号的高级方法，否则可能需要对低级机制有相当详细的了解才能正确。快速实现可能如下所示：

```
void connection_thread_main( bool& running )
{
  while ( running )
    ...
}

int main()
{
  ...

  syslog(LOG_INFO | LOG_USER, "Daemon started");
  // Create flag to indicate if daemon is running.  This is used as the
  // condition for which the thread's while loop continue.
  bool running = true;

  // Create threads.
  boost::thread_group threads;
  threads.create_thread( boost::bind( &connection_thread_main,
                                      boost::ref( running ) ) );
  threads.create_thread( boost::bind( &pending_thread_main,
                                      boost::ref( running ) ) );

  // This will block the main thread as long as there is work queued into the
  // service.  In this case, signals are being waited on asynchronously.
  io_service.run();

  // On SIGINT or SIGTERM, io_service.stop() is invoked, causing the main 
  // thread to return from io_service.run().

  // Set the running flag to false and wait on the other threads to finish.
  running = false;
  threads.join_all();

  syslog(LOG_INFO | LOG_USER, "Daemon stopped");
} 
```

有几点需要考虑：

*   Boost.Asio 提供了出色的高级网络对象类型。可能值得使用它们，而不必处理较低级别的类型和细节。
*   尽管异步编程具有天生的复杂性，但异步实现可能会提高性能。因为使用 Boost.Asio 支持线程池相当容易。
*   Boost.Asio 使信号处理变得容易。
*   如果您决定不使用 Boost.Asio，该示例是有关如何守护进程的绝佳资源。
*   在快速实施中，我选择使解决方案尽可能地可读。因此，主线程基本上被浪费了，因为它只是在等待信号。除了拥有 3 个线程之外，还可以将其中一个线程的内容放入 main 中的循环中，并定期[轮询](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/reference/io_service/poll.html)`io_service`.

    ```
    syslog(LOG_INFO | LOG_USER, "Daemon started");
    // Create flag to indicate if daemon is running.  This is used as the
    // condition for which the thread's while loop continue.
    bool running = true;

    // Create threads.
    boost::thread_group threads;
    threads.create_thread( boost::bind( &connection_thread_main,
                                        boost::ref( running ) ) );

    for ( ;; )
    {
      // Execute ready to run handlers, but do not block waiting for
      // outstanding handlers to become ready.  When SIGINT or SIGTERM are
      // received, the handler will be ready to run, and ran from the poll
      // call, causing the io_service to stop.
      io_service.poll();

      if ( io_service.stopped() ) break;

      ... // pending_thread_main's while body content
    }    

    // Set the running flag to false and wait on the other threads to finish.
    running = false;
    threads.join_all();

    syslog(LOG_INFO | LOG_USER, "Daemon stopped"); 
    ```

# c# - .Net 列表和最大元素数

> ID：12810724
> 
> 赞同：2
> 
> 时间：2012-10-10T01:32:14.283
> 
> 标签：c#, .net

所以我正在开发一个仅附加的 64 位列表和字典，我遇到了内存错误。我想我会在某个时候，但不是 64 MB。我发现这有点出乎意料，并且很好奇是否有人可以向我解释为什么它会在 64 MB 时遇到问题。

我对新 List 类的测试只是尝试在 List 中创建和加载 8 GB 的布尔值。我认为它们每个只吸收大约 1 位，所以我会得到一些很好的指标/精度来测试我的程序。

这是VS的输出：

```
-       this    {OrganicCodeDesigner.DynamicList64Tail<bool>}   OrganicCodeDesigner.DynamicList64Tail<bool>
        Count   536870912   ulong
-       data    Count = 536870912   System.Collections.Generic.List<bool>
-       base    {"Exception of type 'System.OutOfMemoryException' was thrown."} System.SystemException {System.OutOfMemoryException}
-       base    {"Exception of type 'System.OutOfMemoryException' was thrown."} System.Exception {System.OutOfMemoryException}
+       Data    {System.Collections.ListDictionaryInternal} System.Collections.IDictionary {System.Collections.ListDictionaryInternal}
        HelpLink    null    string
+       InnerException  null    System.Exception
        Message "Exception of type 'System.OutOfMemoryException' was thrown."   string
        Source  "mscorlib"  string
        StackTrace  "   at System.Collections.Generic.Mscorlib_CollectionDebugView`1.get_Items()"   string
+       TargetSite  {T[] get_Items()}   System.Reflection.MethodBase {System.Reflection.RuntimeMethodInfo}
+       Static members      
+       Non-Public members      
-       Raw View        
        Capacity    536870912   int
        Count   536870912   int
-       Static members      
+       Non-Public members      
-       Non-Public members      
+       _items  {bool[536870912]}   bool[]
        _size   536870912   int
        _syncRoot   null    object
        _version    536870912   int
        System.Collections.Generic.ICollection<T>.IsReadOnly    false   bool
        System.Collections.ICollection.IsSynchronized   false   bool
        System.Collections.ICollection.SyncRoot {object}    object
        System.Collections.IList.IsFixedSize    false   bool
        System.Collections.IList.IsReadOnly false   bool
        item    false   bool
-       Type variables      
        T   bool    bool 
```

以下是我目前正在学习的课程：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace OrganicCodeDesigner
{
    public class DynamicList64Tail<T> : iList64<T>
    {
        private List<T> data;

        public DynamicList64Tail()
        {
            data = new List<T>();
        }

        public void Add(T item)
        {
            data.Add(item);
        }       

        public void Clear()
        {
            data.Clear();
        }

        public bool Contains(T item)
        {
            return data.Contains(item);
        }

        public ulong? IndexOf(T item)
        {
            if(this.data.Contains(item)) {
                return (ulong)data.IndexOf(item);
            }
            return null;
        }

        public T this[ulong index]
        {
            get
            {
                return data[(int)(index)];
            }
            set
            {
                data[(int)(index)] = value;
            }
        }

        public ulong Count
        {
            get { return (ulong)data.Count; }
        }

    }
}

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Collections;

namespace OrganicCodeDesigner
{
    // @todo: Create IList64, with 64-bit longs in mind.
    // @todo: Create BigIntegerList, which may supersede this one.
    public class DynamicList64<T> : iList64<T>
    {
        private List<iList64<T>> data;

        private ulong count = 0;
        private ulong depth = 0;

        public DynamicList64()
        {
            data = new List<iList64<T>>() { new DynamicList64Tail<T>()};
            count = 0;
        }

        public DynamicList64(ulong depth)
        {
            this.depth = depth;
            if (depth == 0)
            {
                data = new List<iList64<T>>() { new DynamicList64Tail<T>() };
            }
            else
            {
                depth -= 1;
                data = new List<iList64<T>>() { new DynamicList64<T>(depth) };
            }
        }

        internal DynamicList64(List<iList64<T>> data, ulong depth)
        {

            this.data = data;
            this.depth = depth;
            this.count = Int32.MaxValue;

        }

        public void Add(T item)
        {
            if (data.Count >= Int32.MaxValue)
            {
                //@todo: Do switch operation, whereby this {depth, List l} becomes this {depth + 1, List.Add(List l), count = 1}, and the new object becomes {depth, List l, count = max}  
                DynamicList64<T> newDynamicList64 = new DynamicList64<T>(this.data, this.depth);
                this.data = new List<iList64<T>>() { newDynamicList64 };
                this.count = 0;
                this.depth += 1;
            }

            if(data[data.Count-1].Count >= Int32.MaxValue) {
                if (depth == 0)
                {
                    data.Add(new DynamicList64Tail<T>());
                }
                else
                {
                    data.Add(new DynamicList64<T>(depth - 1));
                }
            }

            data[data.Count - 1].Add(item);
            count++;
        }

        public void Clear()
        {
            data.Clear();
            data = new List<iList64<T>>() { new DynamicList64Tail<T>() };
            count = 0;
            depth = 0;
        }

        public bool Contains(T item)
        {
            foreach(iList64<T> l in data) {
                if(l.Contains(item)) {
                    return true;
                }
            }
            return false;
        }

        public ulong? IndexOf(T item)
        {
            for (int i = 0; i < data.Count; i++ )
            {
                if (data[i].Contains(item))
                {
                    return (ulong)(((ulong)i * (ulong)(Int32.MaxValue)) + data[i].IndexOf(item).Value);
                }
            }

            return null;           
        }

        public T this[ulong index]
        {
            get
            {
                return data[(int)(index / Int32.MaxValue)][index % Int32.MaxValue];
            }
            set
            {
                data[(int)(index / Int32.MaxValue)][index % Int32.MaxValue] = value;
            }
        }

        public ulong Count
        {
            get { return this.count; }
        }

    }
}

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace OrganicCodeDesigner
{
    public interface iList64<T>
    {
        void Add(T item);
        void Clear();
        bool Contains(T item);
        ulong? IndexOf(T item);
        T this[ulong index] { get; set;}
        ulong Count { get; }

    }
} 
```

以及测试程序的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using OrganicCodeDesigner;

namespace OrganicCodeDesignerListDictionaryTest
{
    public partial class MainForm : Form
    {
        public MainForm()
        {
            InitializeComponent();
        }

        private void Button_TestList_Click(object sender, EventArgs e)
        {
            DynamicList64<bool> newList = new DynamicList64<bool>();
            newList.Add(true);
            newList.Add(false);

            bool b = true;
            for (ulong i = 0; i < 68719476736; i++)
            {
                b = !b;
                newList.Add(b);
                //if(i%4096==0) {
                    //TextBox_Output.Text += "List now contains " + i + "\r";
                //}
            }

            TextBox_Output.Text += "Successfully added all the bits.\r";
        }

        private void Button_TestDictionary_Click(object sender, EventArgs e)
        {

        }
    }
} 
```

也许您可以发现错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T01:38:49.483

> 也许您可以发现错误？

我*认为*错误在这里：

> 我认为它们每个只吸收大约 1 位，所以我会得到一些很好的指标/精度来测试我的程序。

一个 bool 占用一个字节，而不是一位 - 所以你大大低估了你的列表的大小。您实际上遇到了 512MB 布尔值的错误。由于 Reed Copsey 的编辑速度比我快 - 我怀疑该列表正试图通过分配一个 2 倍其当前大小的数组来增加其大小 [即 1GB 数组]，并且这遇到了一些 .net 限制。

这可能是开始实施拆分逻辑的好时机。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-10T01:38:05.007

.NET 中数组的大小是有限制的。即使您在 64 位平台上运行，并设置了[gcAllowVeryLargeObjects](http://msdn.microsoft.com/en-us/library/hh285054%28v=vs.110%29.aspx)（在 .NET 4.5 中），您仍然被限制在数组的单个维度中最多 2,146,435,071 个项目。

（在 4.5 之前的版本中，单个对象的大小限制为 2gb，无论它包含多少条目。）

话虽如此， a`bool`由 one 表示`byte`，而不是一位，因此这将比您预期的要大得多。话虽如此，当此操作失败时，您的列表中仍然只有 536,870,912，因此理论上，在*具有足够内存*的 64 位系统上，用于增长列表的下一个分配应该仍然在限制范围内。但是，这需要程序成功地分配一个足够大的连续内存块来存储请求的数据（这将是最后一个块大小的 2 倍）。

# google-chrome - 隐藏字段切换器图标按钮选项

> ID：12810730
> 
> 赞同：1
> 
> 时间：2012-10-10T01:32:32.363
> 
> 标签：google-chrome, google-chrome-extension

我发现这个很棒的扩展在功能方面完全符合我的要求，例如它切换隐藏的输入字段并使它们可见。

我一直想弄清楚的唯一一件事是如何使它成为扩展图标按钮而不是快捷键组合？

扩展： [https ://chrome.google.com/webstore/detail/hidden-field-switcher/gfkfklknjmlpldiggcjgdgkonoicfngp](https://chrome.google.com/webstore/detail/hidden-field-switcher/gfkfklknjmlpldiggcjgdgkonoicfngp)

谢谢

* * *

我当前的设置：我已经能够添加按钮，但点击它没有做任何事情：

**清单.json**

```
{
 "name": "Display Hidden",
 "version": "1.0",
 "manifest_version": 2,
 "description": "Display hidden",
 "background": {"page": "background.html", "persistent": false},
 "browser_action": {"default_icon": "icon.png"},
 "content_scripts":[{"js": ["background.js"], "matches": ["https://*/*"]}],
 "permissions": ["tabs", "http://*/*"]
} 
```

**背景.html**

```
<html>
 <head>
  <script src="background.js">
   chrome.browserAction.onClicked.addListener(function(tab) {alert('icon clicked')});
  </script>
 </head>
</html> 
```

**background.js** [源码](http://code.google.com/p/hiddenfieldswitcher/source/browse/#svn%2Ftrunk)

```
var allFields = new Array();
var visible = false;

function switchHidden() {
 if(visible == true){
     hideHidden();
     visible = false;
}
  else {
      showHidden();
      visible = true;
  }

}

function showHidden() {
    var allHidden = document.getElementsByTagName("input");
    for (var Key in allHidden) {
        if(allHidden[Key].type == "hidden") {
           allFields.push(allHidden[Key]);
           allHidden[Key].type = "text";

           /*for (var SettingsKey in Settings) {
           var subSection = SettingsKey.substring(7,0);
           var subKey = SettingsKey.substring(7);
           if(subSection == "styles_") {
           allHidden[Key].style.setProperty(subKey,Settings[SettingsKey]);
           }
       }*/

if(allHidden[Key].name)
     allHidden[Key].title = allHidden[Key].name;
      if(!allHidden[Key].name && allHidden[Key].id)
     allHidden[Key].title = allHidden[Key].id;
     allHidden[Key].style.setProperty("background-color","#CCFFFF");
       } 
    }
}

function hideHidden() {
    for (var Key in allFields) {
        allFields[Key].type = "hidden";
    }
    allFields = new Array();
} 
```

# mysql - 多连接查询，透视？麻烦事

> ID：12810731
> 
> 赞同：1
> 
> 时间：2012-10-10T01:32:33.813
> 
> 标签：mysql, sql, pivot

提前感谢您提供帮助的任何人。我知道我以前见过这样做没有太多痛苦，但似乎找不到解决方案

我的数据库看起来像：

```
`tbl_user:
----------
id         ( pkey )
email
fName
lName

tbl_userSparseType:
-------------------
id         ( pkey )
varName
displayName

tbl_userSparse:
---------------
id         ( pkey )
value      ( Value of Sparse Type )
user_id    ( => tbl_user.id )
userSparseType_id     ( => tbl_userSparseType.id ) 
```

带有样本数据：

```
tbl_user:
(id,   email,              fName,   lName)
 1     Bob@example.com     Billy    Bob
 2     Betty@example.com   Betty    Sue
 3     Beam@example.com    Jim      Beam

tbl_userSparseType:
(id,   varName,    displayName)
 1     fullName    Full Name
 2     dayPhone    Day Phone
 3     nightPhone  Night Phone
 4     cellPhone   Cell Phone
 5     homeAddr    Home Address

tbl_userSparse:
(id,    value,             user_id,    userSparseType_id)
 1      Billy John Bob     1           1
 2      James B. Beam      3           1
 3      123-234-3456       1           2
 4      234-345-4567       1           4
 5      24 Best st.        2           5
 6      456-567-6789       3           3 
```

我尝试做两个左连接，但这给了我每个稀疏条目的 tbl_user 行，例如：

```
(id, email,            fName,  lName, displayName, value)
 1,"Bob@example.com","Billy","Bob","Full Name","Billy John Bob"
 1,"Bob@example.com","Billy","Bob","Day Phone","123-234-3456"
 1,"Bob@example.com","Billy","Bob","Cell Phone","234-345-4567" 
```

尽管进行了大约 45 分钟的查找会话，但我无法找到一种方法来获得更像以下内容而不显式命名列，我需要一种动态方法来仅提取适用于 tbl_user 行子集的所有显示名称询问：

```
WHERE tbl_user.id IN (1,2)

 id | email             | fName | lName | Full Name,     | Day Phone    | Cell Phone   | 
Home Address
-------------------------------------------------------------------------------------------------------
 1  | Bob@example.com   | Billy | Bob   | Billy John Bob | 123-234-3456 | 234-345-4567 |
 2  | Betty@example.com | Betty | Sue   |                |              |              | 24 Best St. 
```

再次提前感谢，我希望这可以不用大惊小怪地完成。:\

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T01:54:38.930

不幸的是 MySQL 没有一个`PIVOT`基本上是你想要做的功能。因此，您需要将聚合函数与`CASE`语句一起使用。如果您知道列数，则可以对值进行硬编码：

```
select u.id, 
  u.email,
  u.fname,
  u.lname,
  max(case when t.displayname = 'Full Name' then us.value end) FullName,
  max(case when t.displayname = 'Day Phone' then us.value end) DayPhone,
  max(case when t.displayname = 'Cell Phone' then us.value end) CellPhone,
  max(case when t.displayname = 'Home Address' then us.value end) HOmeAddress
from tbl_user u
left join tbl_userSparse us
  on u.id = us.user_id
left join tbl_userSparseType t
  on us.userSparseType_id = t.id
where u.id in (1, 2) 
group by u.id, u.email, u.fname,u.lname; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/68425/9)

现在，如果您想动态执行此操作，这意味着您事先不知道要转置的列，那么您应该查看以下文章：

[动态数据透视表（将行转换为列）](http://buysql.com/mysql/14-how-to-automate-pivot-tables.html)

您的代码如下所示：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'max(case when t.displayname = ''',
      t.displayname,
      ''' then us.value end) AS ',
      replace(t.displayname, ' ', '')
    )
  ) INTO @sql
FROM tbl_userSparse us
left join tbl_userSparseType t
  on us.userSparseType_id = t.id;

SET @sql = CONCAT('SELECT u.id, u.email, u.fname, u.lname, ', @sql, ' 
                  from tbl_user u
                  left join tbl_userSparse us
                    on u.id = us.user_id
                  left join tbl_userSparseType t
                    on us.userSparseType_id = t.id
                  where u.id in (1, 2) 
                  group by u.id, u.email, u.fname, u.lname');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/68425/10)

# javascript - 在另一个滚动 Div 中滚动 Div

> ID：12810732
> 
> 赞同：0
> 
> 时间：2012-10-10T01:32:55.387
> 
> 标签：javascript, jquery, html, css, jquery-ui

我在这里有点麻烦。所以我有一排div，把它们想象成迷你盒子。我可以在指定的宽度/高度区域内滚动它们。使用： http: [//manos.malihu.gr/jquery-custom-content-scroller](http://manos.malihu.gr/jquery-custom-content-scroller)

现在，在其中一个 Div 中，我有更多想要在该 Div 中滚动的内容。这就是问题出现的地方。无论我做什么，我都无法实现。

这是一个示例骨架：

```
<style type="text/css"> 
.rows{
    margin:50px auto;   width:400px; height:405px; overflow:auto;
}
.row{
  background: lightblue; height: 370px; width: 320px; margin: auto;
  padding: 10px 10px 10px 10px; margin: 10px 10px 10px 10px;
}
.column{
  float:left;
}
.columns{
    margin:50px auto;   width:800px; height:405px; 
}
</style>

<DIV id="container">

  <DIV class="columns">
    <DIV class="column">
      <DIV class="rows"> <div class="row"></div><div class="row"></div><div class="row"></div> </DIV>
    </DIV>
    <DIV class="column">
      <DIV class="rows">  <div class="row"></div><div class="row"></div><div class="row"></div> </DIV>
    </DIV>
    <DIV class="column">
      <DIV class="rows">  <div class="row"></div><div class="row"></div><div class="row"></div> </DIV>
    </DIV>
  </DIV>
</DIV>

  <link href="css/jquery.mCustomScrollbar.css" rel="stylesheet" type="text/css" />
    <script src="js/jquery-1.8.2.min.js"></script>
    <script src="js/jquery-ui-1.8.21.min.js"></script>
    <script src="js/jquery.mousewheel.min.js"></script>
    <script src="js/jquery.mCustomScrollbar.min.js"></script>
    <script src="js/jquery.easing.1.3.js"></script>

    <script type='text/javascript'>

        $(window).load(function(){

            $(".rows").mCustomScrollbar({
                scrollButtons:{ enable:false }
            });
        }); 
    </script> 
```

=====================

为了进一步澄清，在 div 类“行”中，我会说一个需要在该框中滚动的长段落。

谢谢

=======================

JS/CSS 链接：

```
http://gsgd.co.uk/sandbox/jquery/easing/jquery.easing.1.3.js
http://manos.malihu.gr/tuts/custom-scrollbar-plugin/jquery.mousewheel.min.js
http://manos.malihu.gr/tuts/custom-scrollbar-plugin/jquery.mCustomScrollbar.js
http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js
http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js
http://manos.malihu.gr/tuts/custom-scrollbar-plugin/jquery.mCustomScrollbar.css 
```

# iphone - Xcode：按钮单击导致 NSInvalidArgumentException

> ID：12810733
> 
> 赞同：0
> 
> 时间：2012-10-10T01:33:01.450
> 
> 标签：iphone, objective-c, xcode, cocoa, ibaction

我在 Xcode 4.3.2 中工作。

我是 Xcode 的新手。我正在构建一个应用程序，该应用程序必须在单击按钮时更改为不同的视图。我的文件是：AppDelegate.h/.m、GreenViewController.h/.m、SwitchViewController.h/.m、GreenView.xib - 我没有使用故事板，但我的项目要求我不使用它们（向后兼容性问题）。

这是我的问题（看起来很简单）：单击 UIButton（放置在 GreenView.xib 中）时，我试图打印到控制台。这是我的 GreenViewController.h 代码

```
#import <UIKit/UIKit.h>
@interface GreenViewController : UIViewController
- (IBAction)switchViews:(id)sender;
@end 
```

这是 GreenViewController.m 的（已弃用）代码：

```
#import "GreenViewController.h"
@implementation GreenViewController

- (IBAction) switchViews:(id)sender {
    NSLog(@"Button Pressed!");
} 
```

GreenView.xib 的所有者是 GreenViewController。

出于某种原因，我只有在按下 UIButton（在 GreenView.xib 中）时才会出现错误：

```
2012-10-09 18:07:38.490 MyViewSwitcher[8655:f803] -[SwitchViewController switchViews:]: unrecognized selector sent to instance 0x688a660
2012-10-09 18:07:38.492 MyViewSwitcher[8655:f803] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[SwitchViewController switchViews:]: unrecognized selector sent to instance 0x688a660' 
```

似乎 SwitchViewController 期望从方法“switchViews”中得到一些东西，但“switchViews”仅在 GreenViewController 中列出。之前，我在 SwitchViewController 中有“switchViews”，但是我删除了所有与方法和所有连接对应的代码。同样，我再次检查了 GreenViewController 中的“switchViews”是否连接到 GreenView.xib 中的 UIButton。我已经清理并重新构建了我的项目，但我仍然收到此错误。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T17:28:22.027

您的错误是说您正在`switchViews:`调用`SwitchViewController`. 而且由于 class 没有定义`switchViews:`（因为你删除了它）`SwitchViewController`，它不知道该怎么做，然后崩溃。

不想告诉你这个，但你的按钮连接到`switchViews:`a 的方法`SwitchViewController`。你说“我已经仔细检查过 GreenViewController 中的‘switchViews’是否连接到 GreenView.xib 中的 UIButton”。嗯，是的，从你的崩溃来看，它是。但是您确定它与实例的`switchViews:`功能有关吗？`GreenViewController`您是如何查看这些信息的？

我建议在连接检查器中删除与 UIButton 的所有连接。然后将其重新连接到视图控制器（您说的是 GreenViewController）。然后它应该会显示 IBActions 列表，这应该只是`switchViews:`方法。

如果你这样做，它仍然不起作用。尝试删除按钮并重新制作，然后重新连接。

# c# - Bing Maps C# GPX Route Viewer 无法编译：无法从 LocationCollection 转换为 LocationRect

> ID：12810736
> 
> 赞同：0
> 
> 时间：2012-10-10T01:33:56.667
> 
> 标签：c#, geolocation, windows-8, bing-maps, windows-store-apps

必应 Windows 应用商店示例应用程序“必应地图 C# GPX 路线查看器”无法编译。

在这行代码上：

```
LocationRect bestRouteView = new LocationRect(gpxRoutePoints); 
```

...我收到这两个错误消息：

*'Bing.Maps.LocationRect.LocationRect(Bing.Maps.LocationRect)' 的最佳重载方法匹配有一些无效参数*

*参数 1：无法从 'Bing.Maps.LocationCollection' 转换为 'Bing.Maps.LocationRect'*

（gpxRoutePoints 是一个 LocationCollection）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T05:39:23.730

您正在使用的示例最近更新为[Bing Maps SDK 的 RTM 版本](http://visualstudiogallery.msdn.microsoft.com/bb764f67-6b2c-4e14-b2d3-17477ae1eaca)，并且在那里引入了它所抱怨 的[构造函数。](http://msdn.microsoft.com/en-us/library/hh846491.aspx)[安装 SDK 更新](http://visualstudiogallery.msdn.microsoft.com/bb764f67-6b2c-4e14-b2d3-17477ae1eaca)，你应该没问题。

# opengl-es - OPenGL ES 中的按位运算

> ID：12810740
> 
> 赞同：4
> 
> 时间：2012-10-10T01:34:12.503
> 
> 标签：opengl-es

我是 OpenGL ES 的新手，我使用的是 OpenGL ES 2.0 版本。我可以在片段着色器中使用按位运算（右移，左移）吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-10T02:03:57.517

OpenGL ES 2.0 没有位运算符。ES 3.0+ 当然可以。

# ios6 - 子类化 UICollectionReusableView

> ID：12810742
> 
> 赞同：2
> 
> 时间：2012-10-10T01:34:24.530
> 
> 标签：ios6

我一直在尝试将 UICollectionReusableView 子类化为非故事板 iPad 项目。我在 IB 中构建了一个视图并将其连接到我的自定义类，注册该类以在我的集合视图所在的 viewController 中重用，并在其中正确调用它

```
UICollectionReusableView *)collectionView:(UICollectionView *)collectionView viewForSupplementaryElementOfKind:(NSString *)kind atIndexPath:(NSIndexPath *)indexPath 
```

但是，UICollectionView 的标题区域中没有显示任何内容。我想我也需要用编码器初始化视图，但我不确定如何正确地做到这一点。我遵循了我找到的几个示例，但标题视图仍然没有出现在我的集合视图中。

```
- (id)initWithCoder:(NSCoder *)aDecoder {
if ((self = [super initWithCoder:aDecoder])) {
    [[NSBundle mainBundle] loadNibNamed:@"CVHeaderView" owner:self options:nil];
    [self addSubview:self.categoryNameLabel];
}
return self; 
```

}

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-26T10:00:14.867

如果您使用情节提要并选择页眉/页脚复选标记`initWithCoder:`将被调用。

如果您不使用故事板（或不单击页眉/页脚）但手动连接它，您必须注册您的自定义类`initWithFrame:`并将被调用。

```
[self.collectionView registerClass:[GameCardCell class] forCellWithReuseIdentifier:@"GameCardCell"];
[self.collectionView registerClass:[PlayerHeaderView class] forSupplementaryViewOfKind:UICollectionElementKindSectionHeader withReuseIdentifier:@"PlayerHeaderView"];
[self.collectionView registerClass:[PlayerFooterView class] forSupplementaryViewOfKind:UICollectionElementKindSectionFooter withReuseIdentifier:@"PlayerFooterView"]; 
```

注意：两者都只会被调用一次。如果视图从缓存中出来，`prepareForReuse`将被调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-02T08:09:17.147

就我而言，`initWithFrame:`第一次出队时会自动调用它。尝试实现这个方法，看看它是否有效。

# ruby - 在不忽略 Keys 的情况下根据 Hash 值进行排序

> ID：12810749
> 
> 赞同：0
> 
> 时间：2012-10-10T01:35:19.863
> 
> 标签：ruby

我有一个像这样的数组：

```
'cars', 'for', 'racs', 'creams', 'scream'. 
```

现在，我要做的是对这个数组中的每个单词/字符串进行排序，并将排序后的字符串作为值放入哈希中，而原始字符串是键。所以现在我有

```
KEYS - VALUES

cars - acrs
for - for
racs - acrs
creams - acemrs
scream - acemrs 
```

代码是

```
sorted_words = Hash.new(0)
words.each { |word| sorted_words[word]=word.chars.sort { |a, b| a.casecmp(b) }.join
} 
```

在此之后，我根据值对哈希进行排序

```
sorted_words = sorted_words.sort{|a1,a2| a1[1]<=>a2[1]} 
```

并实现

```
scream - acemrs
creams - acemrs
racs - acrs
cars - acrs
for - for 
```

而不是这个，我正在寻找像这样排列的哈希

```
cars - acrs
racs - acrs
creams - acemrs
scream - acemrs
for - for 
```

所以，在上面的列表中，值在我现在得到的列表中的排序位置，但它也考虑了键值，所以这就是为什么首先是汽车，然后是具有相同值和奶油的所有其他键，然后是

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T05:44:15.563

听起来您想使用打破平局的键对价值主要顺序进行排序。试试这样：

```
sorted_words = sorted_words.sort{|(k1,v1),(k2,v2)| vcmp = v1<=>v2; vcmp!=0 ? vcmp : k1<=>k2 }
# => [["creams", "acemrs"], ["scream", "acemrs"], ["cars", "acrs"], ["racs", "acrs"], ["for", "for"]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T05:27:12.867

请试试这个..

arr = ['汽车'，'for'，'racs'，'奶油'，'尖叫']

sw=Hash.new

mm=arr.each{|word|sw[word]=word.split(//).sort{|a,b|a.casecmp(b)}.join}

ss=sw.sort_by{|key,value|[value[-1]]}.reverse

# [["cars", "acrs"], ["racs", "acrs"], ["scream", "acemrs"], ["creams", "acemrs"], ["for", "for" ]]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T07:38:01.023

```
Hash[
  array
  .map{|w| [w, w.chars.sort_by(&:downcase).join]}
  .sort_by{|k, v| [v, k]}
] 
```

# php - 解析一个巨大的多维数组并从中构造一个新数组

> ID：12810756
> 
> 赞同：1
> 
> 时间：2012-10-10T01:36:04.280
> 
> 标签：php, multidimensional-array, traversal

我需要一些帮助来启动一个函数，该函数将解析一个数组，检查某些值，如果这些值存在，则使用这些值创建一个新数组并将它们一起 array_push。

我正在通过一个这样的数组：

```
Array
(
    [0] => Array
        (
            [id] => 86
            [34] => 695
            [39] => 0
            [40.1] => Yes
            [36.1] => Yes 
            [35.4] => Card
            [33.3] => Dekalb
            [33.4] => Illinois
            [33.5] => 60115
            [33.6] => United States
            [35.1] => 1143
            [33.1] => 5555 Write Rd
            [33.2] => Write School
            [32.6] => John
            [32.3] => Smith
            [28] => jsmith@gmail.com
            [27] => 5555556554
            [25] => NIUSN
            [14.3] => Jane
            [14.6] => Doe
            [11.2] => 695
            [12] => 1
            [11.1] => In-Person
            [3] => 0
            [2.2] => 595
            [2.1] => Online
        )
    [1] => Array
        (
        ...same stuff as before
        ) 
```

我创建了一个函数`parseArray`，将上述数组传递给了该函数。我遍历每个键/值组合，如果存在某个键，我将其设置为一个变量。然后，如果所有正确的变量都存在，我将其关联到一个数组，然后将其推送到最终数组（将保存所有值）：

```
function parseArray($arry) {

    $results = array();
    $current_result = array();

    foreach($arry as $a) {
        foreach($a as $k => $v) {       
            if ( $k == '14.3' ) {
                $attendee_first_name = $v;
            }
            if ( $k == '14.6' ) {
                $attendee_last_name = $v;
            }
            if ( $attendee_first_name && $attendee_last_name ) {
                $full_name = $attendee_first_name . ' ' . $attendee_last_name;
            }
        }
        $current_result['attendee_name'] = $full_name;
    }

    array_push($results, $current_result);

    return $results;
} 
```

现在他们按照我一直在做的方式，非常程序化并且非常笨拙。我很想了解如何生成更清洁/漂亮的代码来遍历数组和分配值。

理想情况下，我会喜欢这样的结果：

```
Array
(
    [0] => Array
        (
            [attendees_name] = John Smith
            [attendees_email] = jsmith@gmail.com
            [purchasing_name] = Jane Doe
            ...etc 
```

所以我可以简单地通过 foreach 传递输出并轻松输出所需的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:07:54.847

代码：

```
# initialize your test array

$arry = array(
    0 => array(
            'id' => 86,
            '34' => 695,
            '39' => 0,
            '40.1' => 'Yes',
            '36.1' => 'Yes', 
            '35.4' => 'Card',
            '33.3' => 'Dekalb',
            '33.4' => 'Illinois',
            '33.5' => '60115',
            '33.6' => 'United States',
            '35.1' => '1143',
            '33.1' => '5555 Write Rd',
            '33.2' => 'Write School',
            '32.6' => 'John',
            '32.3' => 'Smith',
            '28' => 'jsmith@gmail.com',
            '27' => '5555556554',
            '25' => 'NIUSN',
            '14.3' => 'Jane',
            '14.6' => 'Doe',
            '11.2' => '695',
            '12' => '1',
            '11.1' => 'In-Person',
            '3' => 0,
            '2.2' => 595,
            '2.1' => 'Online'
        ),
1 => array(
        'id' => 86,
        '34' => 695,
        '39' => 0,
        '40.1' => 'Yes',
        '36.1' => 'Yes', 
        '35.4' => 'Card',
        '33.3' => 'Dekalb',
        '33.4' => 'Illinois',
        '33.5' => '60115',
        '33.6' => 'United States',
        '35.1' => '1143',
        '33.1' => '5555 Write Rd',
        '33.2' => 'Write School',
        '32.6' => 'Douglas',
        '32.3' => 'Adams',
        '28' => 'douglas.adams@gmail.com',
        '27' => '5555556554',
        '25' => 'NIUSN',
        '14.3' => 'Frank',
        '14.6' => 'Wright',
        '11.2' => '695',
        '12' => '1',
        '11.1' => 'In-Person',
        '3' => 0,
        '2.2' => 595,
        '2.1' => 'Online'
    )

);

# How to do your function elegantly

foreach($arry as $a) {
    $results[] = array(
        'attendees_name' => $a['32.6'] . " " . $a['32.3'],
        'attendees_email' => $a['28'],
        'purchasing_name' => $a['14.3'] . " " . $a['14.6'] 
    );
}

# print results

var_dump($results); 
```

结果：

```
array(2) {
  [0]=>
  array(3) {
    ["attendees_name"]=>
    string(10) "John Smith"
    ["attendees_email"]=>
    string(16) "jsmith@gmail.com"
    ["purchasing_name"]=>
    string(8) "Jane Doe"
  }
  [1]=>
  array(3) {
    ["attendees_name"]=>
    string(13) "Douglas Adams"
    ["attendees_email"]=>
    string(23) "douglas.adams@gmail.com"
    ["purchasing_name"]=>
    string(12) "Frank Wright"
  }
} 
```

# c# - 如何在没有接口的情况下后期绑定 COM 事件

> ID：12810762
> 
> 赞同：5
> 
> 时间：2012-10-10T01:37:21.240
> 
> 标签：c#, vb6, .net-3.5, late-binding, oleview

我需要后期绑定到 3.5 C# 应用程序中的第 3 方 VB6 COM 对象（以避免我们当前拥有的版本依赖关系）。提供的 dll 在大多数非后期绑定方式中都不能使用，因为一些错误会在我们尝试正常使用它时导致错误。目前，我们正在使用一个自定义的 VB6 包装器，它使事情非常特定于版本，但是我发现我可以使用后期绑定来访问属性和方法。现在，我正在尝试后期绑定事件，但是我读过的所有内容都说我需要从 COM 包装器的接口继承来创建所需的事件接收器。[这是一篇这样的文章](http://blogs.msdn.com/b/rcook/archive/2012/05/09/9023741.aspx)。

所以，我的问题是是否可以在编译时不引用 dll 的情况下执行后期绑定事件处理？

**更新**

这是我在使用 VB6 包装器时遇到的错误（仍在积极更新中）。

*   在 OleViewer 中，我得到

> 无法反编译所选项目 加载类型库/DLL 时出错。TYPE_E_CANTLOADLIBRARY ($80029C4A)

*   在 Visual Studio 中，我得到：

> 无法确定 COM 引用“3rdPartyDLL”的依赖关系。加载类型库/DLL 时出错。（来自 HRESULT 的异常：0x80029C4A (TYPE_E_CANTLOADLIBRARY)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-30T11:36:21.013

从[这里](http://marc.info/?l=ms-dcom&m=103440617319007&w=2)：

> 我发现当 IDL 包含另一个项目的 .tlb 类型库的 importlib 时会导致问题。
> 
> 这似乎在一个 dll 和另一个 dll 之间创建了依赖关系。
> 
> 如果缺少依赖的 dll，OLEView 拒绝显示依赖的 dll，这也表现为不允许 #import from C++ 代码。

因此，我会仔细查看相关 DLL 的 COM 依赖项，并确保它们也都已注册。

它还继续添加：

> ...因为两个 dll 是相互依赖的，所以来自每个组件的组件交互（通过方法签名上的接口声明）并`#import`从彼此的 typelib 中使用。
> 
> 因此，除非两个目标 dll 都存在，否则都无法重建。正如您可以想象的那样，当您尝试从头开始完全重建项目时，这会导致一个可怕的问题。
> 
> 我已经尝试将接口定义分成更小的 IDL 文件......

* * *

**编辑：**这是最近出现的这个问题的一个例子（我相信）。我有一个导出到 COM 的 C# 库。对该库进行了修改，改变了几个类的接口，但库 GUID 没有改变。另[请参阅此处了解`AutoDual`](https://stackoverflow.com/questions/2714430/why-should-i-not-use-autodual)正在使用的风险。

这是奇怪的部分 - VB6 DLL 是参考修改后的 C# DLL 重建的。*它编译得很好*。没有错误。但它的类型库已损坏 - OleView 无法打开它，以`TYPE_E_CANTLOADLIBRARY`. 要成功重新编译 VB6 DLL，必须更改 C# DLL GUID。

显然是 VB6/C# 互操作的一个陷阱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T10:09:29.860

该问题很可能是由您使用的平台引起的。我昨天刚遇到类似的问题。确保在后期绑定 x86/x64 COM 类型库时将项目平台设置为**x86** / **x64 。**

这同样适用于`oleview`。使用 x86/x64 版本查看 x86/x64 类型库。（如果您在 x64 系统上，可能需要安装 x64 Windows SDK 才能获得正确的可执行文件）。

# r - 通过 knitr 和 igraph 在乳胶中的 tkplot

> ID：12810763
> 
> 赞同：9
> 
> 时间：2012-10-10T01:37:23.097
> 
> 标签：r, igraph, knitr, tkplot

这可能是一个疯狂的奇怪梦想。我梦想我可以`tkplot`通过. 我知道一辉是知道动画的，所以我想也许这是可能的。谷歌搜索没有显示我所追求的，所以这是一个无效的尝试：`igraph``knitr`

```
\documentclass[a4paper]{scrartcl}
\begin{document}

<<setup, include=FALSE, cache=FALSE>>=
library(igraph)
@

<<network>>=
edges <- structure(c("A", "B", "C", "D", "E", "F", "G", "H", "I", "J", 
    "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "A", "B", "C", 
    "D", "E", "F", "G", "H", "I", "J", "E", "G", "G", "F", "H", "G", 
    "D", "J", "J", "D", "B", "C", "D", "I", "I", "H", "A", "B", "G", 
    "I", "F", "D", "F", "J", "D", "B", "E", "E", "A", "E"), .Dim = c(30L, 
    2L), .Dimnames = list(NULL, c("person", "choice")))

g <- graph.data.frame(edges, directed=TRUE)
tkplot(g)
@ 

\end{document} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-12T04:17:22.397

好的，一个快速而肮脏的答案：

```
\documentclass{article}
\begin{document}

<<setup, include=FALSE, cache=FALSE>>=
library(igraph)
library(tcltk)
knit_hooks$set(igraph = function(before, options, envir) {
  if (before) return()
  path = knitr:::fig_path('.eps')
  tkpostscript(igraph:::.tkplot.get(options$igraph)$canvas,
                     file = path)
  sprintf('\\includegraphics{%s}', path)
})
@

<<network, igraph=1>>=
edges <- structure(c("A", "B", "C", "D", "E", "F", "G", "H", "I", "J", 
    "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "A", "B", "C", 
    "D", "E", "F", "G", "H", "I", "J", "E", "G", "G", "F", "H", "G", 
    "D", "J", "J", "D", "B", "C", "D", "I", "I", "H", "A", "B", "G", 
    "I", "F", "D", "F", "J", "D", "B", "E", "E", "A", "E"), .Dim = c(30L, 
    2L), .Dimnames = list(NULL, c("person", "choice")))

g <- graph.data.frame(edges, directed=TRUE)
tkplot(g)
@ 

\end{document} 
```

随意抛光它`hook_plot_custom`。

# javascript - 计算负数的立方根

> ID：12810765
> 
> 赞同：14
> 
> 时间：2012-10-10T01:38:33.250
> 
> 标签：javascript, math

所以，简而言之，

> ³ √(-8) = (-8) ^(1/3)

```
console.log(Math.pow(-8,1/3));
//Should be -2 
```

但是当我测试它时，它会输出

```
NaN 
```

为什么？它是一个错误还是一开始就应该是这样的？我正在使用 JavaScript 来绘制图表，但这会弄乱图表。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-10T01:43:10.303

您可以使用此代码段来计算它。它也适用于其他权力，例如`1/4`,`1/5`等。

```
function nthroot(x, n) {
  try {
    var negate = n % 2 == 1 && x < 0;
    if(negate)
      x = -x;
    var possible = Math.pow(x, 1 / n);
    n = Math.pow(possible, n);
    if(Math.abs(x - n) < 1 && (x > 0 == n > 0))
      return negate ? -possible : possible;
  } catch(e){}
}

nthroot(-8, 3); 
```

资料来源： http: [//gotochriswest.com/blog/2011/05/06/cube-root-an-beyond/](http://gotochriswest.com/blog/2011/05/06/cube-root-an-beyond/)

一种更快的方法来计算三次根：

```
Math.cbrt = function(x) {
    var sign = x === 0 ? 0 : x > 0 ? 1 : -1;

    return sign * Math.pow(Math.abs(x), 1 / 3);
}

Math.cbrt(-8); 
```

**更新**

[要查找基于整数的三次根，您可以使用以下函数，受此答案](https://math.stackexchange.com/a/263113)的启发：

```
// positive-only cubic root approximation
function cbrt(n)
{
    var a = n; // note: this is a non optimized assumption

    while (a * a * a > n) {
        a = Math.floor((2 * a + (n / (a * a))) / 3);
    }

    return a;
} 
```

`a`它从一个收敛到最接近的整数的假设开始`a^3 <= n`。可以以相同的方式调整此功能以支持负基数。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-10T01:41:05.257

没有错误；您将负数提高到分数幂；因此，NaN。

谷歌上最热门的是来自[Dr Math](http://mathforum.org/library/drmath/view/62979.html)的解释非常好。它说对于实数（无论如何都不是复数），将负数提高到分数幂可能不是实数。最简单的例子大概是

-4 ^ (1/2)

这本质上是计算-4的平方根。尽管 -8 的三次根确实有真正的解决方案，但我认为大多数软件库发现不执行所有复杂算术并且仅在虚部非零时才返回 NaN 更有效，否则会给您很好的真实答案。

**编辑**

为了明确说明这`NaN`是预期的结果，[请参阅官方的 ECMAScript 5.1 规范，第 15.8.2.13 节](http://www.ecma-international.org/ecma-262/5.1/#sec-15.8.2.13)。它说：

> 如果 x<0 且 x 是有限的且 y 是有限的且 y 不是整数，则结果为 NaN。

同样，即使将负数提高到分数次方的某些实例只有一个实根，但许多语言只是对所有负数到分数根的情况进行 NaN 操作。

请不要认为 JavaScript 是唯一这样的语言。 [C++ 做同样的事情](http://www.cplusplus.com/reference/cmath/pow/)：

> 如果 x 是有限负并且 y 是有限但不是整数值，则会导致域错误。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-19T10:48:12.937

两个关键问题：

1.  在数学上，负数有多个立方根：-2，但也有 2 个复数根（参见[单位立方根](http://www.wolframalpha.com/input/?i=cube+roots+of+unity)）。
2.  Javascript 的`Math`对象（和大多数其他标准数学库）不会做负数的分数幂。它在函数接收它之前将小数幂转换为浮点数，因此您要求函数计算负数的浮点幂，这可能有也可能没有真正的解决方案。所以它做了务实的事情，拒绝尝试计算这样的值。

如果你想得到正确的答案，你需要决定你想要在数学上有多正确，并将这些规则写入`pow`.

所有库函数都受到限制，以避免过多的计算时间和不必要的复杂性。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-10-10T06:08:57.520

我喜欢其他答案，但是如何覆盖`Math.pow`以便能够处理*所有*负数的第 n 个根：

```
//keep the original method for proxying
Math.pow_ = Math.pow;

//redefine the method
Math.pow = function(_base, _exponent) {
  if (_base < 0) {
    if (Math.abs(_exponent) < 1) {
      //we're calculating nth root of _base, where n === 1/_exponent
      if (1 / _exponent % 2 === 0) {
        //nth root of a negative number is imaginary when n is even, we could return
        //a string like "123i" but this would completely mess up further computation
        return NaN;
      }/*else if (1 / _exponent % 2 !== 0)*/
      //nth root of a negative number when n is odd
      return -Math.pow_(Math.abs(_base), _exponent);
    }
  }/*else if (_base >=0)*/
  //run the original method, nothing will go wrong
  return Math.pow_(_base, _exponent);
}; 
```

[摆弄](http://jsfiddle.net/ovfiddle/J5zVt/1/)了一些测试用例，如果您发现错误，请大声疾呼！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-02-13T04:30:41.687

所以我看到了一堆围绕着`Math.pow(...)`很酷的方法，但是基于赏金的措辞，我提出了一种稍微不同的方法。

有几种求解根的计算近似值，其中一些比其他的采取更快的步骤。最终，停止点归结为所需的精确程度（这真的取决于你/正在解决的问题）。

我不打算详细解释数学，但**以下是通过目标测试的立方根近似**的实现（赏金测试 - 由于问题标题，也添加了负范围）。循环中的每次迭代（参见`while(Math.abs(xi-xi0)>precision)`每个方法中的循环）都会更接近所需的精度。一旦达到精度，就会将格式应用于数字，因此它与从迭代中得出的计算一样精确。

```
var precision = 0.0000000000001;
function test_cuberoot_fn(fn) { 
    var tested = 0, 
    failed = 0; 
    for (var i = -100; i < 100; i++) { 
        var root = fn(i*i*i); 
        if (i !== root) { 
            console.log(i, root); 
            failed++; 
        } 
        tested++; 
    } 
    if (failed) { 
        console.log("failed %d / %d", failed, tested); 
    }else{
        console.log("Passed test");
    }
}
test_cuberoot_fn(newtonMethod);
test_cuberoot_fn(halleysMethod); 
```

**牛顿近似实现**

```
function newtonMethod(cube){
    if(cube == 0){//only John Skeet and Chuck Norris
        return 0; //can divide by zero, we'll have
    }             //to settle for check and return
    var xi = 1;
    var xi0 = -1;
    while(Math.abs(xi-xi0)>precision){//precision = 0.0000000000001
        xi0=xi;
        xi = (1/3)*((cube/(xi*xi))+2*xi);
    }
    return Number(xi.toPrecision(12));
} 
```

**Halley's approximation 实施** *说明*Halley's approximation 采用更快的步骤来求解立方体，因此它的计算速度比 newton's 逼近。

```
function halleysMethod(cube){
    if(cube == 0){//only John Skeet and Chuck Norris
        return 0; //can divide by zero, we'll have
    }             //to settle for check and return
    var xi = 1;
    var xi0 = -1;
    while(Math.abs(xi-xi0)>precision){//precision = 0.0000000000001
        xi0=xi;
        xi = xi*((xi*xi*xi + 2*cube)/(2*xi*xi*xi+cube));
    }
    return Number(xi.toPrecision(12));
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-02-11T17:52:56.610

它在 Chrome 控制台中运行

```
function cubeRoot(number) {
    var num = number;
    var temp = 1;
    var inverse = 1 / 3;
    if (num < 0) {
        num = -num;
        temp = -1;
    }
    var res = Math.pow(num, inverse);
    var acc = res - Math.floor(res);
    if (acc <= 0.00001)
        res = Math.floor(res);
    else if (acc >= 0.99999)
        res = Math.ceil(res);
    return (temp * res);
}

cubeRoot(-64) // -4
cubeRoot(64)  //  4 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-04-17T01:05:22.857

作为提醒，在 ES6 中现在有一个 Math.cbrt 函数。

在我在 Google chrome 中进行的测试中，它的运行速度几乎是 Math.pow 的两倍。有趣的是，我不得不将结果相加，否则 chrome 在优化 pow 函数方面做得更好。

```
//do a performance test on the cube root function from es6
var start=0, end=0, k=0;
start = performance.now();
k=0;
for (var i=0.0; i<10000000.0; i+=1.0)
{
    var j = Math.cbrt(i);
    //k+=j;
}
end = performance.now();
console.log("cbrt took:" + (end-start),k);
k=0;
start = performance.now();
for (var i=0.0; i<10000000.0; i+=1.0)
{
    var j = Math.pow(i,0.33333333);
    //k+=j;
}
end = performance.now();
console.log("pow took:" + (end-start),k);
k=0;
start = performance.now();
for (var i=0.0; i<10000000.0; i+=1.0)
{
    var j = Math.cbrt(i);
    k+=j;
}
end = performance.now();
console.log("cbrt took:" + (end-start),k);
k=0;
start = performance.now();
for (var i=0.0; i<10000000.0; i+=1.0)
{
    var j = Math.pow(i,0.33333333);
    k+=j;
}
end = performance.now();
console.log("pow took:" + (end-start),k); 
```

结果：

```
cbrt took:468.28200000163633 0
pow took:77.21999999921536 0
cbrt took:546.8039999977918 1615825909.5248165
pow took:869.1149999940535 1615825826.7510242 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-12T18:52:40.707

//除了符号之外，负数的立方根不与正数相同吗？

```
Math.cubeRoot= function(n, r){
    var sign= (n<0)? -1: 1;
    return sign*Math.pow(Math.abs(n), 1/3);
}
Math.cubeRoot(-8)

/*  returned value: (Number)
-2
*/ 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-04-20T05:43:12.927

只是想强调一下，在 ES6 中有一个[原生的三次根](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/cbrt)函数。所以你可以这样做（在[这里](http://kangax.github.io/compat-table/es6/#Math_methods_Math.cbrt)查看支持）

`Math.cbrt(-8)`会还给你`-2`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-13T23:44:37.590

这适用于负数和负指数：

```
function nthRoot(x = 0, r = 1) {
  if (x < 0) {
    if (r % 2 === 1) return -nthRoot(-x, r)
    if (r % 2 === -1) return -1 / nthRoot(-x, -r)
  }
  return x ** (1 / r)
} 
```

例子：

```
nthRoot( 16,  2)   4
nthRoot( 16, -2)   0.25
nthRoot(-16,  2)   NaN
nthRoot(-16, -2)   NaN
nthRoot( 27,  3)   3
nthRoot( 27, -3)   0.3333333333333333
nthRoot(-27,  3)   -3
nthRoot(-27, -3)   -0.3333333333333333 
```

# c - 测算L2缓存吞吐量的破译作业

> ID：12810769
> 
> 赞同：1
> 
> 时间：2012-10-10T01:38:58.343
> 
> 标签：c, malloc, parameter-passing, cpu-cache

我注意到在过去的几天里，我的一些同学实际上已经尝试在 StackOverflow 上询问有关同一作业的问题，所以我将无耻地复制粘贴（仅）一个已删除（但仍被缓存）的问题的上下文在谷歌上没有答案）以节省时间。我为此提前道歉。

**上下文**
我正在尝试编写一个 C 程序来测量我系统的 L2 缓存的数据吞吐量 (MBytes/sec)。要执行测量，我必须编写一个程序，将数组 A 复制到数组 B，重复多次，然后测量吞吐量。

至少考虑两种情况：

*   两个字段都适合 L2 缓存
*   数组大小明显大于 L2 缓存大小。

使用 string.h 中的 memcpy() 复制数组，用一些值初始化两个数组（例如使用 rand() 的随机数），并重复至少 100 次，否则您看不到差异。

数组大小和重复次数应该是输入参数。其中一个数组大小应该是我的二级缓存大小的一半。

**问题**
因此，基于作业的上下文，我很清楚我需要做什么，因为它几乎直截了当地告诉了我。问题是我们得到了一些模板代码来使用，而我在破译其中的一部分时遇到了麻烦。如果有人能帮助我弄清楚发生了什么，我将不胜感激。

代码是：

```
/* do not add other includes */
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>
#include <time.h>
#include <string.h>

double getTime(){
  struct timeval t;
  double sec, msec;

  while (gettimeofday(&t, NULL) != 0);
  sec = t.tv_sec;
  msec = t.tv_usec;

  sec = sec + msec/1000000.0;

  return sec;
}

/* for task 1 only */
void usage(void)
{
    fprintf(stderr, "bandwith [--no_iterations iterations] [--array_size size]\n");
    exit(1);
}

int main (int argc, char *argv[])
{
  double t1, t2; 

  /* variables for task 1 */
  unsigned int size = 1024;
  unsigned int N = 100; 
  unsigned int i;

  /* declare variables; examples, adjust for task */
  int *A;
  int *B;

  /* parameter parsing task 1 */
  for(i=1; i<(unsigned)argc; i++) {
    if (strcmp(argv[i], "--no_iterations") == 0) {
      i++;
      if (i < argc)
        sscanf(argv[i], "%u", &N);
      else
        usage();
    } else if (strcmp(argv[i], "--array_size") == 0) {
      i++;
      if (i < argc)
        sscanf(argv[i], "%u", &size);
      else
        usage();
    } else usage();
  }

  /* allocate memory for arrays; examples, adjust for task */
  A = malloc (size*size * sizeof (int));
  B = malloc (size*size * sizeof (int));

  /* initialise arrray elements */    

  t1 = getTime();

  /* code to be measured goes here */

  t2 = getTime();

  /* output; examples, adjust for task */
  printf("time: %6.2f secs\n",t2 - t1);

  /* free memory; examples, adjust for task */
  free(B);
  free(A);

  return 0;  
} 
```

我的问题是：

*   使用方法的目的是什么？
*   参数传递部分应该做什么，因为据我所知，它总是会导致使用（）并且不会在 sscanf 行中使用任何参数？
*   在这个分配中，我们打算以 KB 或 MB 记录数组大小，我知道 malloc 以字节为单位分配大小，`size`变量值为 1024 将导致 1MB * sizeof(int) （我认为至少）。在这种情况下，我应该记录的数组大小是 1MB 还是 1MB * sizeof(int)？
*   如果参数传递工作正常并且我们传递参数来更改变`size`量值，那么数组大小是否总是`size`变量的平方？或者数组大小是否会被认为只是`size`变量？malloc size*size 而不是 size 似乎非常不直观，除非我对这一切都遗漏了一些东西。
*   我对测量吞吐量的理解是，我应该将数组大小乘以迭代次数，然后除以所用时间。我能得到任何确认这是正确的吗？

这些是我理解这项任务的唯一障碍。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T02:10:05.267

*   使用方法的目的是什么？

使用函数告诉您应该在命令行上将哪些参数传递给程序。

*   参数传递部分应该做什么，因为据我所知，它总是会导致使用（）并且不会在 sscanf 行中使用任何参数？

当将无效参数传递给程序时，它会导致调用 usage() 函数。

否则，它将变量**的迭代次数**`N`设置为参数的值`no_iterations`（默认值 100），并将变量**的数组大小**`size`设置为参数的值`array_size`（默认值 1024）。

*   在这个分配中，我们打算以 KB 或 MB 记录数组大小，我知道 malloc 以字节为单位分配大小，大小变量值为 1024 将导致 1MB * sizeof(int) （我认为至少）。在这种情况下，我应该记录的数组大小是 1MB 还是 1MB * sizeof(int)？

如果您的大小应该是 1 MB，那么这可能就是应该的大小。

如果你想确保大小是数据类型大小的一个因素，那么你可以这样做：

```
if (size % sizeof(int) != 0)
{
    size = ((int)(size / sizeof(int))) * sizeof(int);
} 
```

*   如果参数传递正常工作并且我们传递参数来更改大小变量值，那么数组大小是否总是大小变量的平方？或者数组大小是否会被认为只是大小变量？malloc size*size 而不是 size 似乎非常不直观，除非我对这一切都遗漏了一些东西。

您可能只想分配`size`字节。除非您应该使用矩阵，而不仅仅是数组。在这种情况下，它将是`size * size`字节。

*   我对测量吞吐量的理解是，我应该将数组大小乘以迭代次数，然后除以所用时间。我能得到任何确认这是正确的吗？

大概吧。

# php - YiiMongoDbSuite 和组合框

> ID：12810770
> 
> 赞同：0
> 
> 时间：2012-10-10T01:39:08.213
> 
> 标签：php, mongodb, combobox, yii

有人知道如何用 mongodb 集合填充组合框列表吗？

```
$list = CHtml::listData($industryModels, '_id', 'name');
echo $form->dropDownListRow($model, 'industry_id', $list);' 
```

不会工作，因为 _id 是一个 mongoId 对象并且 toString 不会自动调用。我收到以下错误：

```
PHP warning Illegal offset type 
```

基于堆栈跟踪意味着对象不能用作数组键。

那么如何让 mongoId 字符串用作组合框列表中的键？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T05:11:43.490

尽量不要使用 CHtml::listData

```
$list = array();
foreach ($industryModels as $industryModel) {
    $list[$industryModel->_id] = $industryModel->name;
}
echo $form->dropDownListRow($model, 'industry_id', $list); 
```

# jquery - 结合 Jquery Ajax 调用 Instagram

> ID：12810771
> 
> 赞同：1
> 
> 时间：2012-10-10T01:39:23.797
> 
> 标签：jquery, ajax, instagram

您好，我编写了一个使用 Jquery 访问 Instagram API 的网站。它工作正常，唯一的问题是客户希望拥有超过 20 个图像。我一直在到处寻找，但找不到如何循环 ajax 调用，以便它通过 url next 信息运行所有可用的 ajax 查询。现在我的代码是

```
$.ajax({
        type: "GET",
        dataType: "jsonp",
        cache: false,
        url: "https://api.instagram.com/v1/users/*my user code* /media/recent/?access_token=* my access token*",
        success: function(data) {

My display code here
} 
```

有没有办法从所有调用中获取所有数据并将它们组合成一个数据对象，以便我的代码可以循环遍历它？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:40:14.790

您可以启动多个 AJAX 请求，然后使用 $.when 等待所有请求完成。一旦 $.when 返回，它会将您所有请求的数据作为其 .done() 回调的参数。我在这里的 jsfiddle 中说明了这一点：

[http://jsfiddle.net/dflor003/BeNdE/](http://jsfiddle.net/dflor003/BeNdE/)

# jquery - Jquery：单击复选框时将输入A的值替换为输入B的值

> ID：12810772
> 
> 赞同：0
> 
> 时间：2012-10-10T01:39:27.783
> 
> 标签：jquery

当我选中复选框时，我想用“input1”的值替换“input2”的值（文本）

这是我的代码：

```
$("#check").click(function () {

$('#input2').html($('#input1').val());

});

<input type="text" id="input2">

<input type="checkbox" id="check">

<input type="text" id="input1"> 
```

目前，它仅在“input2”是 div 而不是输入时才有效。

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:42:21.100

用于`.val()`设置输入的值 not`.html()`

```
$('#input2').val($('#input1').val()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:44:34.313

使用`attr`or`val`方法更新输入元素的值。

```
$("#check").click(function () {
    $('#input2').attr('value',$('#input1').val());
});​ 
```

或者

```
$("#check").click(function () {
    $('#input2').val($('#input1').val());
});​ 
```

[http://jsfiddle.net/Lp8dY/](http://jsfiddle.net/Lp8dY/)

# ruby - 在 ruby 中调用带有块的块而不执行第一个

> ID：12810773
> 
> 赞同：1
> 
> 时间：2012-10-10T01:39:35.387
> 
> 标签：ruby

我正在将一个块传递给一个延迟执行的方法，例如

```
a = Proc.new do 
   puts "call me later"
end 
```

假设我使用它来缓存昂贵的调用。现在假设我不想让我的部分代码现在运行，而我的部分代码在以后运行类似这样

```
 a = Proc.new do |c|
      puts "call me later"
      c.some_method do
        puts "call me now"
      end
    end 
```

`call me now`一旦你有对象`a` 而不调用代码输出“ ” ，是否可以获得“ ”的输出`call me later`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T04:22:12.573

我不确定你到底想要完成什么，但你所拥有的是一个 Proc，它期望一个对象作为参数传递，并且该对象有一个接受块的方法。

```
module ModB
  def self.some_method
    puts 'some_method before yield'
    yield
    puts 'some_method after yield'
  end
end

proc_a = Proc.new do |b|
  puts 'proc_a called'
  b.some_method do
    puts 'block called'
  end
end

proc_a.(ModB)
# proc_a called
# some_method before yield
# block called
# some_method after yield 
```

所以， proc_a 要么需要某种标志

```
proc_a = Proc.new do |run_me, b|
  puts 'proc_a called' if run_me
  b.some_method do
    puts 'block called'
  end
end 
```

或者，您应该单独存储 some_method 的块。

```
proc_a = Proc.new do
  puts 'proc_a called'
end

proc_b = Proc.new do
  puts 'block called'
end

proc_a.()
# proc_a called

ModB.some_method(&proc_b)
#   some_method before yield
#   block called
#   some_method after yield 
```

# java - JPA 模型关系

> ID：12810775
> 
> 赞同：1
> 
> 时间：2012-10-10T01:39:59.873
> 
> 标签：java, jpa, playframework, playframework-1.x

我目前正在使用 JPA 的 playframework 1.2.4 为我和我的朋友编写一个板。一切都很好，直到我来到视图机制。

问题是，每个用户都可以有多个视图条目。每个主题也可以有多个视图条目，所以这是我的视图模型：

```
@Entity
public class ForumTopicView extends Model
{

    @Required
    @ManyToOne
    public ForumTopic   topic;

    @Required
    @ManyToOne
    public User         user;

    @Required
    public Date         viewDate;

} 
```

另一方面，一个主题和连接的用户只有一个视图。

这是我的主题模型：

```
@Entity
public class ForumTopic extends Model
{

    // ...

    @OneToOne(mappedBy = "topic") // TODO: and the connected user
    public ForumTopicView       view;

    // ...
} 
```

我如何自定义用户必须是连接用户并且对于每个主题只有一个选择的视图。

谢谢你的帮助！！核磁共振

@Yogendra Singh：是的，没错。每个用户都可以查看一个主题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-11T21:39:41.270

如果关联的一侧是多对一，另一侧必须是单对多，而不是单对一。

每个主题都有多个视图（其中一个视图是针对当前用户的）。每个用户都有多个视图（其中一个视图用于给定主题）。所以你有两个 OneToMany/ManyToOne 关联。

目前尚不清楚您想做什么，但我认为您需要执行查询才能获得所需的内容。如果您想要的是与当前用户关联并对应于给定主题列表的视图列表，那么查询就是

```
select view from ForumTopicView view
where view.user = :currentUser
and view.topic in (:listOfTopics) 
```

如果您有 50 个主题，则无需 50 个查询。上面的一次检索所有视图。

# ios6 - 如何使用自定义视图模仿 UIAlertView 模态行为？

> ID：12810776
> 
> 赞同：0
> 
> 时间：2012-10-10T01:40:05.637
> 
> 标签：ios6, modal-dialog, uitouch

如果在您尝试保存时未填充项目条目的名称字段，我有一个弹出 UIAlertView 的视图。我想改为显示我自己的自定义警报视图。我用 xib 加载它：

```
- (void)enterNameAlert {

    NSArray *subviewArray = [[NSBundle mainBundle] loadNibNamed:@"AddNameAlertView" owner:self options:nil];
    enterNameAlertView = [subviewArray objectAtIndex:0];
    enterNameAlertView.frame = CGRectMake(232, 417, 303, 171);
    enterNameAlertView.alpha = 0.0;
    [self.view addSubview:enterNameAlertView];
    [self.view bringSubviewToFront:enterNameAlertView];

    //fade view in
    [UIView animateWithDuration:.50f delay:0.0f options:UIViewAnimationOptionCurveEaseOut animations:^(void) {

        enterNameAlertView.alpha = 1.0;

    } completion:NULL];

    [UIView commitAnimations];

} 
```

但是，在显示警报时，您仍然可以单击视图上的所有其他元素。理想情况下，我想制作 alertview 模式。作为一个黑客，我只是在警报视图启动时将 xxxx.enabled = NO 设置为所有其他元素，并在警报上按 OK 时将它们切换回 xxxx.enabled = YES。

必须有一种更好的方法来取消对 self.view 而不是对 self.enterNameAlertView 的所有触摸。

如果我执行 self.view.userInteractionEnabled = NO，它将取消对 self.view 以及 self.enterNameAlertView 的所有触摸。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T06:58:32.657

我认为解决您的问题的方法是，您必须在自定义警报视图和原始视图之间再引入一个视图，一旦警报出现，您需要将该视图带到您的 self.view 并在您使用时隐藏（或删除）它警报被解雇了，我已经这样做了，它对我来说就像魅力一样。希望这对你也有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T03:06:17.607

知道了。我使用了启用交互的 UIScrollView。这会阻止来自自定义警报视图外部的触摸被传递到下面的主视图。

```
- (void)enterNameAlert {

    //pop a UIScrollView behind the alert so that the user can't touch the controls behind it
    shadowScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0, 0, 768, 1024)];
    shadowScrollView.userInteractionEnabled = YES;
    shadowScrollView.backgroundColor = [UIColor blackColor];
    shadowScrollView.alpha = 0.0;
    [self.view addSubview:shadowScrollView];
    [self.view bringSubviewToFront:shadowScrollView];

    //put the alertview in front of the disabled view to make it act like a modal view
    NSArray *subviewArray = [[NSBundle mainBundle] loadNibNamed:@"AddNameAlertView" owner:self options:nil];
    enterNameAlertView = [subviewArray objectAtIndex:0];
    enterNameAlertView.frame = CGRectMake(232, 417, 303, 171);
    enterNameAlertView.alpha = 0.0;
    [self.view addSubview:enterNameAlertView];
    [self.view bringSubviewToFront:enterNameAlertView];

    //animate view in
    [UIView animateWithDuration:.50f delay:0.0f options:UIViewAnimationOptionCurveEaseOut animations:^(void) {

        shadowScrollView.alpha = .6;
        enterNameAlertView.alpha = 1.0;

    } completion:NULL];

    [UIView commitAnimations];

} 
```

# model-view-controller - 包括 MVC 模式和其他模式

> ID：12810782
> 
> 赞同：0
> 
> 时间：2012-10-10T01:40:36.340
> 
> 标签：model-view-controller, design-patterns, class-diagram

我需要知道 MVC 中包含哪些设计模式，因为我在网上查到这个 MVC 模式使用了观察者，以便通知视图模型的变化。

是否包含任何其他模式，例如 Composite、Strategy 甚至 Mediator？

如果我们从 MVC 中取出观察者模式会发生什么？它仍然有效吗？它会如何改变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:19:49.520

我认为复合模式和策略模式是根据程序员的需要使用的，而不是包含在 MVC 模式的内部工作中的东西

对于中介模式，我认为可以将控制器视为视图和模型之间的中介。

只是我的 0.2 美分

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T03:04:01.547

不，没有其他模式被定义为 MVC 或受 MVC 启发的设计模式的一部分。您**可以**使用装饰器、工厂或其他作为其中的一部分，但它们是不可或缺的部分。

MVC 设计模式不是关于实现细节，而是关于关注点分离。您将表示逻辑与域业务逻辑分开。并且您将接口与用户输入处理分开。您真的应该阅读*Martin Fowler*的[GUI Architecture](http://martinfowler.com/eaaDev/uiArchs.html)。这可能会消除一些混乱。

 ** * *

如果你采用经典的 MVC 模式并从中移除观察者，你就会得到 Model2 MVC 模式。这是您在涉及 Web 应用程序时可以使用的关闭。

然后，您还有 MVP 和 MVVM 模式，它们与经典 MVC 和 Model2 MVC 的不同之处在于具有被动视图，它们不直接从模型层请求信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T08:58:05.713

它们是 MVC 中包含的 3 个主要模式
1）复合模型
2）策略控制器
3）观察者 - 视图*

# jquery - 如何用 JQuery 替换选择器的 IF？

> ID：12810783
> 
> 赞同：0
> 
> 时间：2012-10-10T01:40:43.310
> 
> 标签：jquery, jquery-selectors

我觉得我在做脏代码，虽然它工作得很好......

在这种情况下，如何用常规 JQuery 选择器替换那些 IF 语句：

见代码+提琴手

```
<html>
<body>
    <a href="#b" class="cssPauseAll" historyID="12">Pause All</a><br/>

        <a href="#b" itemHistoryID="12" ContentID="45">AA</a><br/>
        <a href="#b" itemHistoryID="12" ContentID="14">BB</a><br/>
        <a href="#b" itemHistoryID="12" ContentID="78">AA</a><br/>  

    <a href="#b" class="cssPauseAll" historyID="13">Pause All</a><br/>

        <a href="#b" itemHistoryID="13" ContentID="45">BB</a><br/>
        <a href="#b" itemHistoryID="13" ContentID="14">BB</a><br/>
        <a href="#b" itemHistoryID="13" ContentID="78">CC</a><br/> 
</body>    
</html>​ 
```

* * *

```
$(document).ready(function () {

    $(document).on("click","a.cssPauseAll[historyID]", function () {
        var historyID = $(this).attr("historyID");
        //alert("historyID from PauseAll  " + $(this).attr("historyID"));
        $(document).find("[itemHistoryID]").each(function() {

            var itemHistoryID = $(this).attr("itemHistoryID");

            if(historyID == itemHistoryID)
            {
                alert($(this).attr("ContentID"));
            }
        });

    });

});​ 
```

[提琴手](http://jsfiddle.net/kzFze/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:46:42.533

您可以连接字符串：

```
$("a[itemHistoryID='" + historyID + "']"); 
```

[http://jsfiddle.net/FBCBP/](http://jsfiddle.net/FBCBP/)

请注意，无需选择文档对象并使用`find`方法。您可以使用`$`or`jQuery`直接选择元素，也可以单独使用属性选择器非常慢，您可以在属性选择器之前使用元素选择器（*在这种情况下*`a`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:47:19.723

是的，你应该能够做到这一点

```
$(document).ready(function () {

$(document).on("click","a.cssPauseAll[historyID]", function () {
    var historyID = $(this).attr("historyID");
    //alert("historyID from PauseAll  " + $(this).attr("historyID"));

    $(document).find("[itemHistoryID='" + historyID + "']").each(function() {
        // here only the matching itemHistoryIds will loop
        alert($(this).attr("ContentID"));
    });

});

});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T01:59:48.147

如果您的 HTML 正是这种方式，您可以使用`nextUntil`而不是`each`循环遍历所有元素，您知道只有下一个`a`元素`itemHistoryID`与单击的链接相等。

```
$(document).on("click","a.cssPauseAll[historyID]", function () {
    var historyID = $(this).attr("historyID");

    $(this).nextUntil('a[itemHistoryID!="' + historyID + '"]', 'a').each(function() {
        alert($(this).attr('ContentID'));
    });

}); 
```

[**演示**](http://jsfiddle.net/xqgcP/)

# shell - 猫不能用管道获取内容？

> ID：12810787
> 
> 赞同：1
> 
> 时间：2012-10-10T01:41:02.783
> 
> 标签：shell

有一个名为 test 的文件，test 上只有一行，`haha`

```
tiger@debian:~$ cat test
haha
tiger@debian:~$ cat 'test'
haha 
```

为什么下面的命令不能得到`haha`？ `ls test`输出`test`，为什么 ls test | 猫不能输出`haha`？

```
tiger@debian:~$ ls test
test
ls test  | cat 
test 
```

我的系统是debian+bash

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T01:48:03.580

问题不在于管道本身，而在于`ls test`不输出文件的内容`test`。`ls`列出目录内容。`ls test`将简单地输出`test`.

如果您绝对希望使用管道显示`test`您可以使用的内容：

```
cat test | xargs echo 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:56:23.877

If you really want to display the content of the file like that, try

```
ls test | xargs cat 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T01:52:23.617

你可以看看“人猫”

使用 `cat test`or`cat 'test'`时，shell 假定第二个参数始终是文件名。

然而，通过管道，cat 期望得到一堆文本，因此打印了 'ls' 的内容。

# php - 将xml转换为sql

> ID：12810789
> 
> 赞同：1
> 
> 时间：2012-10-10T01:41:38.617
> 
> 标签：php, sql, xml, parsing, split

我需要将一个 XML 文件（大约 200 Mb 大小）转换为 SQL 文件并将它们插入到一个 MySQL 表中（一个表 - 看起来大约有 1000 万行，只有几列）。

*   不幸的是，我无法使用 shell / 命令行工具
*   看起来我需要使用 PHPMyAdmin 导入工具，其中每次上传的导入大小限制为 50mb
*   或者，PHP 仅通过 Web 浏览器启用，因此编写一个 PHP 脚本以从浏览器执行。

所以，步骤是（如果有更好的方法，请告诉我）：

*   解压文件到服务器
*   编写一个 PHP 脚本来转换和插入

或者

*   在本地执行并使用 phpadmin 分别上传

什么是完成这项工作的好方法？任何想法/反馈/细节表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T01:48:24.297

如果您真的要处理 1000 万行（200Mb 数据，10 毫米，行，每行大约 21 个字节？），那么在服务器上解压缩文件并编写脚本来处理插入可能是最好的.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:44:18.977

[DomDocument](http://php.net/manual/en/class.domdocument.php)非常擅长处理 xml 数据。您可以使用它解析数据并将其转换为您需要的格式。

如果您无法更改配置，您可能会遇到文件大小的问题。我相信默认允许的内存大小是~8MB。

# ruby-on-rails - rspec - 为什么这个数组键比较失败？

> ID：12810791
> 
> 赞同：0
> 
> 时间：2012-10-10T01:41:42.613
> 
> 标签：ruby-on-rails, rspec, matcher

```
Failure/Error: @group.attributes.keys.should include (Group.first.attributes.keys)     
   expected 

["id", "duration", "frequency", "period", "group_size", "location", "service", "area_of_need", "created_at", "updated_at", "therapist_id", "start_date", "end_date", "student_id", "adhoc"] 
to include  
["id", "duration", "frequency", "period", "group_size", "location", "service", "area_of_need", "created_at", "updated_at", "therapist_id", "start_date", "end_date", "student_id", "adhoc"] 
```

测试：

```
@group.attributes.keys.should include (Group.first.attributes.keys) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T01:46:31.080

因为`a.should includes(b)`断言这`a.include? b`是真的并`include?`检查一个数组的元素是否包含一个对象，而不是一个数组是否等于另一个

```
[1].include? [1]
=> false

[1].include? 1
=> true

[[1]].include? [1]
=> true 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T01:29:47.447

答案是哈希比较在 Ubuntu 上失败，但在 Mac 上有效。

我的解决方法是：

```
i=0
  while i < @group.attributes.count
  assert_equal @group.attributes[i], Group.first.attributes[i]
  i+= 1
end

# Comparing field by field as ruby hash comparison isn't working right - 
# but only on Ubuntu! 
```

# sql-server-2008 - SQL Server 2008 中的表变量自引用

> ID：12810792
> 
> 赞同：0
> 
> 时间：2012-10-10T01:42:02.210
> 
> 标签：sql-server-2008, table-variable, self-reference

我在 SQL Server 中发现了一件很奇怪的事情。我不确定这是否正常。

```
insert @table
select ID, Lastname
from tableB
where ID NOT IN ( select ID from @Table) 
```

它总是说插入了 0 行。如果我使用物理表而不是@table，它可以正常工作。

我错过了查询中的任何内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T04:25:38.067

由于 Table 变量像任何其他普通变量一样是特定于范围的。因此，当您在任何特定的 sql 语句中使用它时，它的范围仅此而已。正如您所说的，此时不在 @tablevariable 中，它不包含任何数据。因此编写如下查询：

```
INSERT INTO @table
select ID, Lastname from tableB where ID NOT IN ( select ID from @Table) 
```

此查询将永远无法实现您在此处尝试实现的目标。它始终插入 tableB 中的所有记录。

# php - 如何只允许对评级系统投一票

> ID：12810793
> 
> 赞同：0
> 
> 时间：2012-10-10T01:42:06.290
> 
> 标签：php, rating-system

伙计们，我制作了一个基于 jquery 和 css 的星级评分系统。现在我真的想不出如何将用户投票保存到数据库。最重要的是如何限制一个用户只能投一票。

由于该网站的访问者数量巨大，我无法将每个用户的 ip 保存到数据库中。此外，我认为它效果不佳，因为即使我的 IP 地址本身也是动态的。每次我断开并重新连接我的互联网时，我的 ip 都会改变，我可以再次投票。所以我认为这行不通。

这就是我对将投票保存到数据库的想法：我只保存页面收到的投票数，不保存页面的总评分。

并且将评分与投票数分开。所以它会给我平均评分。对？

但我想不出办法将一位用户限制为一票。请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T02:14:25.090

似乎没有切实可行的方法来严格执行网络上每人一票。

在计算机网络上，我们经常使用人的代理。他们之中有一些是

*   网络或应用程序登录，
*   电子邮件地址，
*   IP地址，
*   饼干，

等等。但是，当涉及到每人一票时，所有这些都存在问题。

*   对于*Web*登录，一个人通常可以创建多个帐户。（特别是如果他们是免费的。）
*   电子邮件帐户是免费的，许多（大多数？）人现在拥有多个电子邮件帐户。
*   IP 地址可能有效，但仅适用于具有非共享计算机（每台计算机一人的公司政策）的 Intranet（每台计算机使用一个 IP 地址实现）。
*   Cookie 与 Web 登录有同样的问题。（并且它们可以被用户删除。）

如果一票真的很有价值，有些人会很麻烦地投票两次。但大多数选票都不是很有价值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:54:56.077

研究使用索引构建数据库。我创建了一个用户最喜欢的系统，它只允许每个用户/最喜欢的组合插入一行。例如：用户选择了一个收藏夹，数据库中存储的值为用户ID和收藏夹ID。如果用户尝试再次选择它，数据库将不会插入该行，因为它是完全重复的。

# jquery - Jquery中奇怪的按键行为

> ID：12810796
> 
> 赞同：0
> 
> 时间：2012-10-10T01:42:30.220
> 
> 标签：jquery, html, css, contenteditable

我正在尝试创建一个文本框，该文本框可水平调整大小，可拖动，并根据内部输入的内容动态更改其高度。到目前为止，这是我的代码

HTML：

```
<div id="text_container">
    <div id="my_text" contenteditable="true"></div>
</div> 
```

CSS：

```
#text_container {
    border: #4A4A4A 2px solid;
    background: #EFEFEF;
    width: 150px;
    padding: 5px;
}

#my_text {
    width: 100%;
    border: #000 1px solid;
    background: #fff;  
    font-size: 40px;
} 
```

jQuery：

```
$('#text_container').resizable( { handles: 'e' } ).draggable();

$('#my_text').keydown( function() {
    $('#text_container').css( { height: ($( this ).height() + 2) } );
});

$('#text_container').resize( function() {
    $('#text_container').css( { height: ($( '#my_text' ).height() + 2) } );
}); 
```

这使得框随着水平调整大小而正确改变，但是当我需要通过向下跳过一行来调整它的大小时，我必须输入一个比我应该输入的字符更多的字符。使用 keypress 会产生相同的结果，并且 keyup 在释放键之前不会调整大小，因此如果一个人按住某个键，它不会调整 div 的大小，直到该人释放该键，这似乎不是最佳的大部头书。对此有什么想法吗？

这是一个小提琴： http: [//jsfiddle.net/UA3QS/65/](http://jsfiddle.net/UA3QS/65/) ​ ​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:49:45.817

输入值未设置为 中的新值`keydown`。您可以改用该`keyup`事件：

```
$('#my_text').keyup( function() {
    $('#text_container').css( { height: ($(this).height() + 2) });
}); 
```

# jquery - jQuery $(document).bind 仅在单击某个 div 中的链接时适用

> ID：12810797
> 
> 赞同：0
> 
> 时间：2012-10-10T01:42:44.500
> 
> 标签：jquery, binding

我正在创建一个页面，其中多个链接将打开一个[facebox](http://defunkt.io/facebox/)（灯箱样式 div）。

对于`#artworks-col`div 内页面上的链接，我希望强制以 800px 宽度打开 facebox；对于所有其他人，我只希望它使用其默认计算。

将它放在页面上会强制所有链接将其打开为 800px 宽：

```
<script type="text/javascript">
  $(document).bind('beforeReveal.facebox', function() { $('#facebox .content').css('width', '800'); });
</script> 
```

但是经过多次尝试使其仅适用于 中的链接后`#artworks-col`，我仍然只能将其应用于全部或不适用。有没有办法过滤此绑定事件以特定于该链接子集？

我认为能够做到这一点的唯一方法是使用设置一个临时标志`$("a#artworks-col").click(var flag = true);`并在文档范围的绑定事件中检查该标志（并在运行宽度修改后在绑定事件中清除它）但这似乎真的混乱，而且肯定有更好的方法来解决这个问题。

这是此页面的 RoR 视图（请注意，一旦运行，脚本将被移至外部文件，现在将其全部放在一个位置更容易）：

```
<div id="admin_logo">
    <%= image_tag("logo_admin.png", alt: "Administration") %>
</div>
<div id="artworks-col"><%= render partial: "artworks_list" %></div>
<div id="artists-col"><%= render partial: "artists_list" %></div>
<div id="locations-col"><%= render partial: "locations_list" %></div>
<div id="insurers-col"><%= render partial: "insurers_list" %></div>
<div id="users-col"><%= render partial: "users_list" %></div>

<div id="show-object" style="display:none;"></div>

<script type="text/javascript">
  $(document).bind('beforeReveal.facebox', function() { $('#facebox .content').css('width', '800'); });
</script> 
```

上面 erb 代码中的渲染部分只是`<a href>`为数据库中该类型的所有对象添加一个列表。这些链接是我想要应用此功能的链接。

**编辑**

由于我无法按照我的意愿通过 jQuery 实现此功能，因此我将使用 CSS 来定义一个宽度为 800px 的 div，以便在单击这些特定链接时显示。我更喜欢通过 jQuery 来做到这一点，因为它会在其他需要更动态方法的情况下使用，但现在必须这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:09:30.817

# 编辑：工作答案

我在这里上传了示例的工作版本：http: [//fluidev.com/stack/fbox/test.html](http://fluidev.com/stack/fbox/test.html)

这就是您将如何绑定单独的单击事件并为每个事件实现不同的宽度。通过使用回调函数（在初始调用函数完成后运行的函数），我们可以实现不同设置宽度的错觉，即使它发生在 facebox 加载之后。最酷的是，您甚至可以根据需要使用动画和其他东西来更改宽度！

```
$(document).ready(function() {
        $("#artworks-col").bind("click", function() {
            $.facebox({ div: '#artworks-col' }, function() { $('#facebox .content').css('width', '800px'); } ); 
        });
        $("#artists-col").bind("click", function() {
            $.facebox({ div: '#artists-col' }, function() { $('#facebox .content').css('width', '200px'); } ); 
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T02:03:56.517

在没有看到更多标记的情况下，我只能假设您的意思是这样的：

```
$(document).bind('beforeReveal.facebox', function () {
    $('#facebox .content').css('width', 'auto');
});
$('div#artworks-col a').click(function (e) {
    $('#facebox .content').css('width', '800px');
});
//Try doing this instead, but I suspect links outside $('div#artworks-col a')
//will also set the width to 800px...
$('#facebox .content').bind('beforeReveal.facebox', function () {
    $('#facebox .content').css('width', '800px');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T02:04:16.713

试试这个.. 使用 jQuery 1.7 及更高版本中可用的 .on() ..

```
$(document).on('beforeReveal.facebox','#artworks-col', function() { 

              $('#facebox .content').css('width', '800'); 
 }); 
```

看起来您的页面中有多个具有相同 id 的元素。尝试改用一个类。

# python - 使用 python pandas 联合所有类型的查询

> ID：12810801
> 
> 赞同：1
> 
> 时间：2012-10-10T01:43:11.130
> 
> 标签：python, union, pandas

我正在尝试使用 pandas 对平面数据源进行数据分析。具体来说，我试图完成的是相当于 SQL 中的 Union All 查询。

我正在使用 read_csv() 方法输入数据，输出具有唯一的整数索引和大约 30 多列。

在这些列中，有几个列包含识别信息，而其他列包含数据。

总共，前 6 列包含唯一标识条目的标识信息。在这 6 列之后，有一系列列（A、B...等）引用了该值。其中一些列以集合的形式链接在一起，例如 (A,B,C) 和 (D,E,F) 一样。

但是，(D,E,F) 也与 (A,B,C) 相关，如下所示 ((A,D),(B,E),(C,F))。我正在尝试做的是获取我的数据集，该数据集如下：

```
(id1,id2,id3,id4,id5,id6,A,B,C,D,E,F) 
```

并返回以下

```
((id1,id2,id3,id4,id5,id6,A,B,C),
 (id1,id2,id3,id4,id5,id6,D,E,F)) 
```

在这里，由于 A 和 D 是链接的，它们包含在同一列中。

（注意，这是一个简化，整个数据集中大约有 1200 万个唯一组合）

我一直在尝试使用合并、连接和连接功能，但无济于事。我觉得我错过了一些重要的东西，因为在 SQL 数据库中我可以简单地执行一个联合所有查询（诚然这很慢）来解决这个问题。

在这个阶段我没有工作示例代码。

基于一些 pandas 文档编写此问题的另一种方法。

```
left = key lval
right = key rval
merge(left, right, on=key) = key, lval, rval 
```

相反，我想要：

```
left = kev, lval
right = key, lval
union(left, right) = key, lval
                     key, rval 
```

我不确定是否需要为此创建新的索引键值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:21:24.573

我已经能够完成我最初要求的事情。但是，它确实需要对列名进行一些按摩。

解决方案（使用伪代码）：

使用相关数据设置数据框。例如

```
left = (id1,id2,id3,id4,id5,id6,A,B,C)
right = (id1,id2,id3,id4,id5,id6,D,E,F)
middle = (id1,id2,id3,id4,id5,id6,G,H,I) 
```

请注意，在这里，对于我的数据集，这导致我对每个 id 都有非唯一的索引键。也就是说，左右各行都有一个键。

重命名列名。

```
col_names = [id1,id2,id3,id4,id5,id6,val1,val2,val3]
left.columns = col_names
right.columns = col_names
middle.columns = col_names 
```

连接这些

```
pieces = [left, right, middle]
new_df = concat(pieces) 
```

现在，这将创建一个新的数据框，其中包含 x 个唯一索引值和 3 个条目。这不是很理想，但现在可以了，主要缺点是您不能再唯一地访问单个条目行，它们将以三倍的形式出现。要访问数据，您可以根据唯一的 id 值创建一个新的数据框。

例如

```
check_df = new_df[(new_df[id1] == 'id1') & (new_df[id2] == 'id2') ... etc])
print check_df

key, id1, id2, id3, id4, id5, id6, A, B, C
key, id1, id2, id3, id4, id5, id6, D, E, F
key, id1, id2, id3, id4, id5, id6, G, H, I 
```

现在，这不是很理想，但它是我进行其他一些分析所需的格式。它可能不适用于所有各方。

如果有人有更好的解决方案，请分享它，我对使用 pandas 和 python 比较陌生。

# ios - 将图像加载到 UIScrollView

> ID：12810802
> 
> 赞同：0
> 
> 时间：2012-10-10T01:43:18.167
> 
> 标签：ios, xcode, uiscrollview, uiimageview

我希望有人可以在这里帮助我，我不知道还能做什么。我有一个 UIScrollView 加载一组 44 图像，然后允许用户翻阅它们。我的代码正在工作，然后突然停止了。我不知道我做了什么改变，所以任何帮助将不胜感激：

前一个视图是一个 UITableView，它传递一个字符串以及所选单元格的名称。这是 ScrollView 中的 ViewDidLoad 方法：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UIBarButtonItem *rightButton = [[UIBarButtonItem alloc] initWithTitle:@"Answer"
                                                                    style:UIBarButtonItemStyleBordered
                                                                   target:self
                                                                   action:@selector(answerPressed:)];

    self.navigationItem.rightBarButtonItem = rightButton;

    if([questionSetName isEqualToString:@"Limitations"]){

        [self limitationsView];
    }
} 
```

这是限制视图：

```
-(void)limitationsView{

    UIScrollView *scroll = [[UIScrollView alloc] initWithFrame:CGRectMake(0, -44, self.view.frame.size.width, self.view.frame.size.height)];

    scroll.pagingEnabled = YES;

    NSArray *unsortedArray = [[NSBundle mainBundle] pathsForResourcesOfType:@"png" inDirectory:@"Images/Limitations"];

    NSMutableArray *limitationImages = [[NSMutableArray alloc] init];

    for (int x = 0; x<[unsortedArray count]; x++) {

        NSString *fileName = [[unsortedArray objectAtIndex:x] lastPathComponent];

        [limitationImages insertObject:fileName atIndex:x];
    }

    NSArray *sortedArray = [limitationImages sortedArrayUsingFunction:finderSortWithLocal
                                                              context:(__bridge void *)([NSLocale currentLocale])];

    for(int i = 0; i< [sortedArray count]; i++){

        CGFloat xOrigin = i * self.view.bounds.size.width;

        UIImageView *limitationImageView = [[UIImageView alloc] initWithFrame:CGRectMake(xOrigin, 0, self.view.frame.size.width, self.view.frame.size.height)];;

        [limitationImageView setImage:[UIImage imageNamed:[sortedArray objectAtIndex:i]]];

        limitationImageView.contentMode = UIViewContentModeScaleAspectFit;

        [scroll addSubview:limitationImageView];

    }

    scroll.contentSize = CGSizeMake(self.view.frame.size.width * [sortedArray count], self.view.frame.size.height);

    [self.view addSubview:scroll];

} 
```

当我到达 LimitationsView 方法的末尾时，sortedArray 包含所有 44 个图像和正确的名称，如果我尝试设置滚动视图的背景颜色，我可以成功地做到这一点。但是我的图像没有加载，我不知道为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T16:45:06.380

我建议使用

```
NSLog(@"image:%@",[UIImage imageNamed:[limitationsArray objectAtIndex:i]]); 
```

to see if the image is null at that point. If that's the case, then there is a problem with the strings you are storing in that array i.e., they are not identical to the actual names of your images

# ios - UITableViewCell 与 UIView 中的 UIButton 性能

> ID：12810803
> 
> 赞同：2
> 
> 时间：2012-10-10T01:43:21.983
> 
> 标签：ios, uitableview, uibutton

我想将 UIButton 添加到自定义 UITableViewCell （以编程方式）。这很容易做到，但我发现单元格中按钮的“性能”很慢 - 也就是说，当我触摸按钮时，在按钮视觉上进入突出显示状态之前有相当多的延迟. 相比之下，常规 UIView 上相同类型的按钮响应速度非常快。

为了隔离问题，我创建了两个视图——一个是简单的 UIView，另一个是只有一个 UITableViewCell 的 UITableView。我在两个视图（UIView 和 UITableViewCell）中都添加了按钮，性能差异非常显着。

我已经在网上搜索并阅读了 Apple 文档，但还没有真正找到问题的原因。我的猜测是它在某种程度上与响应者链有关，但我不能完全确定它。我一定做错了什么，我会很感激任何帮助。谢谢。

演示代码：

视图控制器.h

```
#import <UIKit/UIKit.h>
@interface ViewController : UIViewController <UITableViewDelegate, UITableViewDataSource>
@property UITableView* myTableView;
@property UIView* myView; 
```

视图控制器.m

```
#import "ViewController.h"
#import "CustomCell.h"

@implementation ViewController

@synthesize myTableView, myView;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        [self initMyView];
        [self initMyTableView];
    }
    return self;
}

- (void) initMyView {
    UIView* newView = [[UIView alloc] initWithFrame:CGRectMake(0,0,[[UIScreen mainScreen] bounds].size.width,100)];
    self.myView = newView;
    // button on regularView
    UIButton* myButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
    [myButton addTarget:self action:@selector(pressedMyButton) forControlEvents:UIControlEventTouchUpInside];
    [myButton setTitle:@"I'm fast" forState:UIControlStateNormal];
    [myButton setFrame:CGRectMake(20.0, 10.0, 160.0, 30.0)];
    [[self myView] addSubview:myButton];
}

- (void) initMyTableView {
    UITableView *newTableView = [[UITableView alloc] initWithFrame:CGRectMake(0,100,[[UIScreen mainScreen] bounds].size.width,[[UIScreen mainScreen] bounds].size.height-100) style:UITableViewStyleGrouped];
    self.myTableView = newTableView;
    self.myTableView.delegate = self;
    self.myTableView.dataSource = self;
}

-(void) pressedMyButton {
    NSLog(@"pressedMyButton");
}

- (void)viewDidLoad {
    [super viewDidLoad];
    [[self view] addSubview:self.myView];
    [[self view] addSubview:self.myTableView];
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    CustomCell *customCell = [tableView dequeueReusableCellWithIdentifier:@"CustomCell"];
    if (customCell == nil) {
       customCell = [[CustomCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:@"CustomCell"];
    }
    return customCell;
}

@end 
```

自定义单元格.h

```
#import <UIKit/UIKit.h>
@interface CustomCell : UITableViewCell
@property (retain, nonatomic) UIButton* cellButton;
@end 
```

CustomCell.m

```
#import "CustomCell.h"

@implementation CustomCell

@synthesize cellButton;

- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier {
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // button within cell
        cellButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
        [cellButton addTarget:self action:@selector(pressedCellButton) forControlEvents:UIControlEventTouchUpInside];
        [cellButton setTitle:@"I'm sluggish" forState:UIControlStateNormal];
        [cellButton setFrame:CGRectMake(20.0, 10.0, 160.0, 30.0)];
        [self addSubview:cellButton];
    }
    return self;
}

- (void) pressedCellButton {
    NSLog(@"pressedCellButton");
}

@end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T23:48:25.803

在表格视图中，在“滚动视图”部分下有“延迟内容触摸”选项...删除它并且按钮上的延迟消失了，但这样表格滚动不会开始拖动按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T03:35:05.613

我认为这与您正在做的事情没有任何关系（我对其进行了测试，它有点慢，但我不会称其为“缓慢”）。它可能与附加到表格视图的各种手势识别器有关——操作系统必须弄清楚正在发生什么手势，这可能会导致轻微的延迟。这是 tableView.gestureRecognizers 的日志：

```
2012-10-09 20:34:12.355 SlowButtonsInTableView[3635:c07] (
    "<UIScrollViewDelayedTouchesBeganGestureRecognizer: 0x71b42b0; state = Possible; delaysTouchesBegan = YES; view = <UITableView 0x789f800>; target= <(action=delayed:, target=<UITableView 0x789f800>)>>",
    "<UIScrollViewPanGestureRecognizer: 0x71b4940; state = Possible; delaysTouchesEnded = NO; view = <UITableView 0x789f800>; target= <(action=handlePan:, target=<UITableView 0x789f800>)>>",
    "<UISwipeGestureRecognizer: 0x71b4e00; state = Possible; view = <UITableView 0x789f800>; target= <(action=handleSwipe:, target=<UITableView 0x789f800>)>; direction = right,left>",
    "<UIGobblerGestureRecognizer: 0x71b5100; state = Possible; enabled = NO; view = <UITableView 0x789f800>>"
) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-24T23:36:57.167

在未启用表格视图滚动的情况下，延迟完全消失，可能延迟是由滚动所需的手势引起的

# c# - ServiceStack 客户端异常行为（新 API）

> ID：12810804
> 
> 赞同：2
> 
> 时间：2012-10-10T01:43:36.377
> 
> 标签：c#, api, servicestack

自从升级到 SS 的最新版本 (3.9.24) 以来，我们在客户端（.NET 客户端）上的“自定义”错误处理已停止按预期工作。我们过去依赖 WebServiceException 的“ResponseDTO”属性来处理/响应异常。现在该属性是“ServiceModel.ErrorResponse”类型（为空），而不是我们的自定义响应类型。在 Fiddler 中查看原始响应时，数据符合预期，但 SS 客户端没有像以前一样解析/处理它。这种设计在新的 api 中仍然可行吗？如果不是，那么正确的方法是什么？我们需要完全控制数据、异常和 HTTP 状态代码的表示。

谢谢

# c# - MVC3 视图模型 - 复杂对象列表，包含列表

> ID：12810807
> 
> 赞同：0
> 
> 时间：2012-10-10T01:43:50.610
> 
> 标签：c#, asp.net-mvc-3, model, model-binding

如何将如此复杂的模型与包含多个对象的多个层绑定？现在我将模型传递给视图 - （填充表单/复选框树）并且我想要返回确切的模型（SubjectSelectionModel），但它没有正确绑定。

谁能详细说明我需要采取的过程才能在我看来正确绑定这些？

查看型号：

```
public class SubjectSelectionModel
{
    public IList<Subject> Subjects { get; set; }
} 
```

学科类：

```
public class Subject
{
    public String Name { get; set; }
    public IList<Bin> Bins { get; set; }

    public Subject()
    {

    }

    public Subject(IList<Course> courses)
    {

    }
} 
```

斌类：

```
public class Bin 
{
    public Subject Subject { get; set; }
    public int Amount { get; set; }

    public IList<Foo> Foos { get; set; }
} 
```

福类：

```
public class Foo
{
    public int Number { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T02:00:03.017

这是编辑器模板派上用场的地方。您可以使用简单的编辑器模板来为您处理所有繁重的工作，而不是搞砸这个。

您将在 ~/Views/Shared/EditorTemplates 中创建几个模板，然后在您的主视图中它应该如下所示：

查看.cshtml

```
@model SubjectSelectionModel
@using(Html.BeginForm()) {
    @EditorFor(m => m.Subjects)
    <input type="submit" />
} 
```

主题.cshtml

```
@model Subject
@Html.EditorFor(m => m.Name)
@Html.EditorFor(m => m.Bins) 
```

Bin.cshtml（我假设您不想渲染主题，这将是一个无限循环）

```
@model Bin
@Html.EditorFor(m => m.Amount)
@Html.EditorFor(m => m.Foos) 
```

Foo.cshtml

```
@model Foo
@Html.EditorFor(m => m.Number) 
```

显然，您可能希望将 html 格式更改为您想要的任何内容，但本质上就是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:48:45.383

您需要对象的 for 循环，以便 MVC 可以使用集合中的索引进行绑定。

例子：

```
for (int subjectIndex = 0; subjectIndex < Model.Subjects.Count; subjectIndex++) {
    @Html.TextBoxFor(x => x.Subjects[subjectIndex].Name)

    for (int binIndex = 0; binIndex < Model.Subjects.Bins.Count; binIndex++) {
        @Html.TextBoxFor(x => x.Subjects[subjectIndex].Bins[binIndex].Amount)
    }
} 
```

..ETC。

我在这里对类似问题给出了类似的回答：[Generating an MVC RadioButton list in a loop](https://stackoverflow.com/questions/11839111/generating-an-mvc3-radiobutton-list-in-a-loop-statement/11839242#11839242)

# math - 编译器执行哪些算术运算（如果有）？

> ID：12810808
> 
> 赞同：1
> 
> 时间：2012-10-10T01:43:54.200
> 
> 标签：math, language-agnostic

给定一个诸如`int myNum = 5 + (5 * 9)`或任何其他数学运算之类的操作，该语句的哪些部分（如果有）由编译器执行？哪些是在运行时执行的？显然，不断变化的变量不能在编译时简化，但某些操作可能会。编译器是否甚至愿意做任何这样的简化（例如做出上述声明`int myNum = 50;`）？这在负载、速度或任何其他客观测量方面是否重要？

细节是关键，请尽可能多地阐述你的想法。

我的意思是这适用于**任何**算术运算。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T01:47:05.023

检查[常量折叠](http://en.wikipedia.org/wiki/Constant_folding)。

常量折叠是在编译时简化常量表达式的过程。常量表达式中的项通常是简单的文字，例如整数 2，但也可以是其值永远不会修改的变量，或者是明确标记为常量的变量。

# file - 从代码获取 Azure VM 上可用的驱动器

> ID：12810814
> 
> 赞同：1
> 
> 时间：2012-10-10T01:45:04.983
> 
> 标签：file, azure, virtual-machine

通过代码我可以获取 Azure VM（中型实例）上可用的驱动器列表及其大小。我正在寻找一种方法，可以将文件临时存储在 VM 磁盘上并在读取后将其删除。

谢谢你的时间

问候， 维维克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T06:40:49.340

请查看这篇 Azure 存储[文章](https://azure.microsoft.com/en-us/documentation/articles/storage-create-storage-account/)。它们本质上是页面 blob，可以安装在您的 web/worker 角色的文件系统上。Azure 驱动器的一个问题是它只允许一个实例写入该驱动器，而其他实例对其具有只读访问权限。

HTH。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T18:02:32.677

请参阅 Neil Mackenzie 关于本地存储的帖子：[https](https://convective.wordpress.com/2009/05/09/local-storage-on-windows-azure/) ://convective.wordpress.com/2009/05/09/local-storage-on-windows-azure/ 。

它就像`RoleEnvironment.GetLocalResource("<name>").RootPath`在该目录中执行然后执行文件操作一样简单。

# jquery - 使用 JavaScript 将 PDF 流写入 iFrame

> ID：12810815
> 
> 赞同：0
> 
> 时间：2012-10-10T01:45:05.857
> 
> 标签：jquery, ajax, internet-explorer, iframe

我正在使用`$.post(url, function(data){ // I use data here });`我从帖子中获得的数据是 PDF 流（响应内容类型是应用程序/pdf）。我有一个 iframe，我必须在其中显示此 PDF。目标浏览器是 IE7 & IE8。

一种解决方案是提交表单并将目标指定为 iFrame。但是，我很难验证它是否真的是 PDF 或自定义设计的未找到错误页面（在[此处](https://stackoverflow.com/questions/12741593/detecting-onload-event-in-ie-for-iframe-which-has-pdf)讨论）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:17:28.910

我已经做到了。我所做的是检查：

```
if (data.toLowerCase().substr(0, 4) == "%pdf") 
```

如果评估结果为真，您应该有一个 PDF，否则内容将是服务器在错误时发回的任何内容。

在[通过使用 $.get 调用 HTTPHandler 进入对象元素的流式 PDF 中，](https://stackoverflow.com/questions/2847742/streaming-pdf-via-invocation-of-httphandler-using-get-into-object-element)我试图做类似的事情。

第一步是进行 Ajax 调用——这将是你的`$.post(url, function(data){ // I use data here });`——然后按照我上面的建议检查结果。

如果 PDF 返回且没有错误：`$('#iframe_id')[0].src = 'url'`. 诀窍在于，通过利用浏览器缓存，设置 IFrame 的源将显示缓存的 PDF，而不是重新发送请求。

要使缓存起作用，您需要确保`url`用于请求 PDF 的两次都相同。

# git - Git 生产/开发发布分支

> ID：12810816
> 
> 赞同：3
> 
> 时间：2012-10-10T01:45:09.210
> 
> 标签：git, branch, release, config, production

你好我认为这应该是一个相当简单的问题，但我对管理 git 不太熟悉。

我正在使用非常流行的[http://nvie.com/posts/a-successful-git-branching-model/](http://nvie.com/posts/a-successful-git-branching-model/)为我的 git 分支提供一个通用模型。*但是，关于将release*分支合并到*master*，然后再合并到*develop*分支的部分，我有点困惑。

我也喜欢[配置文件等的 Git 最佳实践，](https://stackoverflow.com/questions/9342886/git-best-practice-for-config-files-etc)但感觉这并不是最好的方法。

我正在考虑执行以下操作：

1.  从开发分支创建一个新的 release-1.0 分支
2.  进行更改（将环境设置为生产）（***坏主意***）
3.  将更改提交到 release-1.0 分支
4.  将 release-1.0 中的更改合并到 master 分支
5.  将新版本标记为 1.0
6.  *（这对我来说是模糊的）*
7.  进行更改（将环境设置为开发）（***坏主意***）
8.  将更改提交到 release-1.0 分支
9.  将 release-1.0 分支合并回开发分支

我使用一个 shell 脚本来自动进行更改，可能还有整个开发->发布->主创建。我将此脚本称为“#: update.sh production 1.0”

```
if !([ "$1" == "production" ] || [ "$1" == "development" ]); then
    echo "Must specify production or development as the second argument"
    exit;
fi

if [ ! -n "$2" ]; then
    echo "Must specify a version (e.g., 1.2, 1.2.1)."
    exit;
fi

if ([ "$1" == "production" ]); then
    var_env="production";
    git checkout -b release-$2 develop
fi

if ([ "$1" == "development" ]); then
    var_env="development";
fi

echo "Starting change to $1..."

SRC="define('ENVIRONMENT', '.*');"
DST="define('ENVIRONMENT', '${var_env}');"
sed -i -e "s/[\s]*$SRC/$DST/g" index.php
echo "Updated environment constant."

echo "Do you wish to continue and commit these changes? (y|n)"

read WISH

if([ "$WISH" == "y" ]); then
    git checkout master
    git merge --no-ff release-$2
    git tag -a $2
else
    echo "Okay. I give up."
fi 
```

这样做有意义吗？

基本上，每个主版本至少有两次提交。一个是设置生产变量，将这些变量合并到主分支，然后另一个提交将我们的变量更改回它们的开发设置并合并回开发分支。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T03:07:47.487

> 但是我在将发布分支合并到主分支，然后回到开发分支的部分有点困惑

这样做的原因可能是因为您的版本可能并不完美。您将提交与该版本相关的任何错误修复到`release`分支，并且新功能开发进入`develop`分支。然后，您将`release`分支合并到`develop`以将这些更改带入主开发流。

您只是为了更改配置设置然后恢复它们而建议进行第二次提交，这只是让人头疼，可能不值得这样做。此处询问了有关如何处理特定于机器的配置文件的类似问题：

*   [如何务实地对配置文件进行版本控制？](https://stackoverflow.com/questions/1974886/how-to-version-control-config-files-pragmatically)
*   [提交机器特定的配置文件](https://stackoverflow.com/questions/1396617/git-committing-machine-specific-configuration-files/1397180#1397180)
*   [在版本控制下处理系统特定信息的最佳实践是什么？](https://stackoverflow.com/questions/419322/whats-the-best-practice-for-handling-system-specific-information-under-version?rq=1)
*   [半可编辑文件（例如配置文件）和版本控制 - 最佳实践？](https://stackoverflow.com/questions/534119/semi-editable-files-eg-config-files-and-version-control-best-practices)

可能还有很多其他类似的问题。上面的共识似乎是将正确版本的配置文件放入存储库是一个坏主意。此外，部署脚本中的某种模板/替换/文件 gnome 步骤是可行的方法。它消除了人为因素，几乎可以保证每次部署到特定环境时都会执行该步骤。

[VonC 的回答](https://stackoverflow.com/a/419477/164966)对此给出了很好的看法，特别是将维护历史的过程和部署软件的过程分开。

# android - 这个 Android/Java 代码有什么作用？

> ID：12810819
> 
> 赞同：-2
> 
> 时间：2012-10-10T01:45:31.123
> 
> 标签：android, comments

我是编码 Android 的新手。我被投入到一个项目中，下面的代码可以工作，但我并不真正理解它，这并不能真正帮助我学习。有人会用每个阶段正在做什么来评论代码吗？

```
SharedPreferences myPrefs = this.getSharedPreferences("FileName", MODE_PRIVATE);
        TreeMap<String, ?> keys = new TreeMap<String, Object>(myPrefs.getAll());
        for (Map.Entry<String, ?> entry : keys.entrySet()) {
            Log.i("map values", entry.getKey());

        }

      List<Pair<Object, String>> sortedByValue = new LinkedList<Pair<Object,String>>();
        for (Map.Entry<String, ?> entry : keys.entrySet()) {
            Pair<Object, String> e = new Pair<Object, String>(entry.getValue(), entry.getKey());
            sortedByValue.add(e);
        }

     // Pair doesn't have a comparator, so you're going to need to write one.
        Collections.sort(sortedByValue, new Comparator<Pair<Object, String>>() {
            public int compare(Pair<Object, String> lhs, Pair<Object, String> rhs) {

                String sls = String.valueOf(lhs.first);
                String srs = String.valueOf(rhs.first);
                int res = sls.compareTo(srs);
                // Sort on value first, key second
                return res == 0 ? lhs.second.compareTo(rhs.second) : res;
            }
        });

        for (Pair<Object, String> pair : sortedByValue) {
            Log.i("map values", pair.first + "/" + pair.second);
        }

      Collection<?> stringArrayList = keys.values();
      final CharSequence[] prefsCharSequence = stringArrayList.toArray(new CharSequence[stringArrayList.size()]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T01:51:47.207

```
SharedPreferences myPrefs = this.getSharedPreferences("FileName", MODE_PRIVATE);
    TreeMap<String, ?> keys = new TreeMap<String, Object>(myPrefs.getAll());
    for (Map.Entry<String, ?> entry : keys.entrySet()) {
        Log.i("map values", entry.getKey());

    } 
```

在共享首选项文件中记录所有键值对。

```
List<Pair<Object, String>> sortedByValue = new LinkedList<Pair<Object,String>>();
    for (Map.Entry<String, ?> entry : keys.entrySet()) {
        Pair<Object, String> e = new Pair<Object, String>(entry.getValue(), entry.getKey());
        sortedByValue.add(e);
    } 
```

将具有所有设置的 Map 转换为 List 进行排序

```
Collections.sort(sortedByValue, new Comparator<Pair<Object, String>>() {
        public int compare(Pair<Object, String> lhs, Pair<Object, String> rhs) {

            String sls = String.valueOf(lhs.first);
            String srs = String.valueOf(rhs.first);
            int res = sls.compareTo(srs);
            // Sort on value first, key second
            return res == 0 ? lhs.second.compareTo(rhs.second) : res;
        }
    }); 
```

自定义比较器对 Pairs 列表进行排序。它比较值。如果它们相等，它会比较第二个值。

```
for (Pair<Object, String> pair : sortedByValue) {
        Log.i("map values", pair.first + "/" + pair.second);
    } 
```

打印排序的首选项。

```
 Collection<?> stringArrayList = keys.values();
  final CharSequence[] prefsCharSequence = stringArrayList.toArray(new CharSequence[stringArrayList.size()]); 
```

将 SharedPreferences 文件中的键转换为 Collection，然后将其转换为字符串列表。

# c#-4.0 - Postsharp 包含除构造函数之外的所有方法

> ID：12810822
> 
> 赞同：1
> 
> 时间：2012-10-10T01:45:44.890
> 
> 标签：c#-4.0, postsharp

如果我有一个 MethodInterceptionAspect，我该如何定义它以包括它正在拦截的类中的所有方法，但构造函数除外？

例如，以下几行似乎不起作用...

```
[MyAspect(AttributeTargetMembers="regex:!.cctor|.*")] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T09:33:35.763

您需要将您的属性应用于带有`AttributeTargetElements = MulticastTargets.Method`. 它针对方法（但不是构造函数）。

这应该可以解决问题：

```
[MyAspect(AttributeTargetElements = MulticastTargets.Method)] 
```

# c++ - 非常简单的 POSIX C++ IPC

> ID：12810824
> 
> 赞同：3
> 
> 时间：2012-10-10T01:45:56.753
> 
> 标签：c++, posix, ipc

我对一个 c++ linux-only（可能放宽到 posix-only）IPC 解决方案感兴趣，它的行为如下；启动了一个名为“计算器”的程序，可以收听消息。计算器将有一个循环定期检查消息字符串，然后根据它们的内容进行操作。

另一个名为“send_msg”的程序可以将消息发送到它的 pid（理想情况下是主机名/pid，通过 tcp 或 udp）。

```
$ calculator &

// awhile later

$ send_msg <calculator pid> show calculations
Calc1: 52% complete
Calc2: 21% complete
$ send_msg <calculator pid> alter Calc2 <numeric parameters>
Ok! I'm restarting my calculations!
$ 
```

我非常精通 C++，但对网络编程一无所知，也没有兴趣花太多时间学习它。是否有一个易于使用的 c++ 包可以完成上述操作？我宁愿不必选择端口号、文件位置等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T01:51:52.003

我认为您可能喜欢[zeromq](http://www.zeromq.org)（拼写为 0mq）或分叉的[crossroadsio](http://www.crossroads.io/)，因为它们抽象了很多手持操作，允许您简单地发布/订阅以及许多其他模式。0mq 有（有？）一堆从简单的乒乓球开始的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T02:38:00.937

我认为您要求的设置绝非简单。

您可能最好使用 Unix 域套接字或 TCP 套接字（端口号）在后台计算器和前端之间进行通信。因此，例如，您可能会运行：

```
calculator -p 3456 & 
```

然后计算器在端口 3456 上侦听。然后您的`send_msg`程序可用于使计算器执行以下操作：

```
send_msg -p 3456 show calculations 
```

当计算器接收到消息时，它会根据命令进行操作，将答案发送回`send_msg`套接字上的程序，然后将其回显到其标准输出。

同时，您有一个可能需要多线程的计算器。它还需要能够确定每次计算涉及多少工作，以便能够报告每次计算的进度。您和我都没有指定如何设置计算，但它可能是：

```
send_msg -p 3456 new calc.file 
```

表示计算器应该开始新的计算，从文件中读取问题`calc.file`。它可能会回响：

```
Calc1: ETC = 3:15 
```

其中，通过某种或多或少的迂回手段，它已确定预计完成时间 (ETC) 为 3 分 15 秒。您可以以类似的方式设置第二个计算。要处理此问题，您需要一个控制器线程来侦听来自`send_msg`. 当它被告知要创建一个新作业时，它会启动一个新线程（或进程）来进行计算。计算器中的主线程和实际计算线程之间必须有某种约定的机制。这可能就像每个线程写入其进度和主线程读取的位置一样简单。但是计算线程需要跟踪他们已经完成了多少工作，还有多少工作要做，以及是否需要更改估算值。

现在，我可能让事情变得太复杂了，但是您显示的界面表明可能需要类似的东西。如果您对计算器进行单线程处理，它必须对您设置的每个计算的工作进行某种循环调度，并定期检查`send_msg`程序是否发送了新消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T02:49:35.430

看看[RCF——](http://www.deltavsoft.com)它是原生的 C++ 并且具有[发布/订阅](http://www.deltavsoft.com/doc/rcf_user_guide/PubSub.html)支持，这应该让这很容易。

# c# - 如何使用c#打开受密码保护的pdf

> ID：12810832
> 
> 赞同：2
> 
> 时间：2012-10-10T01:46:48.797
> 
> 标签：c#, pdf, adobe, itextsharp, password-protection

我想在 c#.net windows 应用程序面板或 adobe reader 中打开受密码保护的 pdf。

我的想法是我想通过系统传递密码并打开pdf。用户可以看到 pdf 但不能保存。甚至用户也可以将我们保存在他们的计算机中，当他们重新打开 pdf 时，文件会询问密码。这意味着当他们想阅读pdf时，他们必须使用系统，如果他们将pdf带到外面，他们将无法打开密码的cos。

我尝试使用 Adob​​e Pdf dll，这个无法传递密码。我也试过用itextsharp，这个可以传密码但是传密码后需要保存pdf。所以当我打开pdf时，文件没有密码。

我想通过系统直接打开受密码保护的pdf。我不想再保存了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T02:17:24.557

有一个类似的问题[，如何以编程方式打开受密码保护的 PDF 文件？](https://stackoverflow.com/questions/10906422/how-can-a-password-protected-pdf-file-be-opened-programmatically)我复制了该问题的一部分并将其放在这里。

```
public static void unprotectPdf(string input, string output) 
{ 
    bool passwordProtected = PdfDocument.IsPasswordProtected(input); 
    if (passwordProtected) 
    { 
        string password = null; // retrieve the password somehow 

        using (PdfDocument doc = new PdfDocument(input, password)) 
        { 
            // clear both passwords in order 
            // to produce unprotected document 
            doc.OwnerPassword = ""; 
            doc.UserPassword = ""; 

            doc.Save(output); 
        } 
    } 
    else 
    { 
        // no decryption is required 
        File.Copy(input, output, true); 
    } 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T08:08:35.527

如果我对您的理解正确，您想强制执行一些数字版权管理 (DRM)。

为了能够做到这一点，您需要对 PDF 查看组件进行一些控制，或者该组件必须受到足够的限制。否则，即如果您只是以某种方式将密码转发给 Adob​​e Acrobat，则该组件假定用户是文档的实际所有者，因此允许保存文件的未受保护副本。当然，如果您临时创建一个未受保护的副本，例如使用 iText(Sharp)，则该临时文件很容易被抢走。

不幸的是，您没有明确选择“在 c#.net windows 应用程序面板内还是使用 adobe reader”是由您决定还是由用户决定。

因此，如果需要支持 Adob​​e Acrobat/Reader，您必须将 DRM 强制集成到这些产品中，参见。[http://www.adobe.com/devnet/reader/topic_drm.html](http://www.adobe.com/devnet/reader/topic_drm.html)（“开发数字版权管理 (DRM) 插件”）。

另一方面，如果您有选择，您只需要一些合适的 PDF 查看器组件。不幸的是，我不知道可用于 .NET 的查看器。如果你使用 Java，JPedal 可以适当地定制。

# sql - 将内容（大列表）添加到关系数据库的最佳方式

> ID：12810839
> 
> 赞同：3
> 
> 时间：2012-10-10T01:48:15.883
> 
> 标签：sql, database, relational

如果这看起来有点像一个新手问题（可能是），我深表歉意，但我只是在向自己介绍关系数据库的想法，我正在为这个概念而苦苦挣扎。

我有一个包含大约 75 个字段的数据库，这些字段代表“用户”的不同特征。其中一个字段代表用户去过的位置，我想知道存储数据的最佳方法是什么，以便可以轻松检索并可以在以后使用（即在谷歌地图上跟踪路线，确定是否有两个用户共享相同的位置等）

问题是一些用户可能总共有 5 个位置，而其他用户可能超过 100 个。

是否最好将这些位置存储在使用每个用户的唯一 ID 命名的文本文件中（每行一个位置，或在 csv 中）？或者为每个连接到其唯一 ID 的单个用户创建一个单独的表（这对我来说似乎有点矫枉过正）？或者，有没有办法将所有位置直接存储在原始表的单个字段中？

我希望我错过了一个概念，或者有一个教程链接可以帮助我理解。

如果有帮助，您可以假设这些位置将按顺序存储，并且一旦存储就不会更改。此外，这些位置是静态的（我不需要再添加任何位置，因为它们无法更新）。

感谢您花时间帮助我。我很感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T01:51:29.133

将用户的位置数据存储在单独的表中。location 表将通过一个 common 链接回 user 表`user_id`。

将特定用户的多个位置保存在一个表中并不是一个好主意——您最终会得到非规范化的数据。

您可能想阅读以下内容：

*   [参照完整性](http://en.wikipedia.org/wiki/Referential_integrity)
*   [关系非规范化](http://en.wikipedia.org/wiki/Denormalization)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:55:10.020

在关系数据库中，您将使用映射表。因此，您将拥有 user、location 和 userlocation 表（user 是保留字，因此您可能希望使用不同的名称）。这使您可以建立多对多关系，即许多用户可以访问许多位置。如果您想将路线建模为位置的有序集合，那么您将需要做更多的工作。这个网站给出了一个[例子](http://sqlrelationship.com/many-to-many-relationship/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T01:55:34.457

最常见的方法是有一个单独的表，比如

```
USER_LOCATION
+------------+------------------+
|  USER_ID   |   LOCATION_ID    |
+------------+------------------+
|            |                  | 
```

如果用户 3 有 5 个位置，则将有 5 行包含 user_id 3。

但是，如果您说*位置的顺序很重要，*那么可以使用指定位置在用户中的顺序位置的附加字段。

分离表方法就是我们所说的*normalized*。

例如，如果您将位置列表存储为位置 ID 的逗号分隔字符串，那么维护顺序很简单，但是您将无法让数据库快速回答“哪些用户去过位置 x？”这个问题。 . 您的数据将是我们所说的*非规范化*数据。

当然，您确实有选择，但关系数据库在连接表方面非常出色，而且它们并不过分。当您有订购要求时，它们看起来确实有点有趣，就像您提到的那样。但是人们一直在使用它们。

# android - android Websocket socket.io 空指针

> ID：12810846
> 
> 赞同：0
> 
> 时间：2012-10-10T01:49:02.267
> 
> 标签：android, multithreading, nullpointerexception, socket.io

```
theButton = (Button) findViewById(R.id.button5);

client = new SocketIOClient(URI.create("http://192.168.0.157:8080"), new SocketIOClient.Handler() {
        @Override
        public void onConnect() {
            Log.e("WS", "Connected!");
        }

        @Override
        public void on(String event, JSONArray arguments) {

        theButton.setBackgroundColor(Color.BLACK);
            Log.e("WS", "Got event "+event+":"+arguments.toString());
        }

        @Override
        public void onDisconnect(int code, String reason) {

            Log.e("WS", "Disconnected! Code: "+code+" Reason:"+reason);
        }

        @Override
        public void onError(Exception error) {
            Log.e("WS", "+++ Error +++"+error);
        }
    });

    client.connect(); 
```

问题是，如果我在 Event Funktion 中更改 BackgroundColor，我会得到一个 NullPointer 异常：

> E/AndroidRuntime(16409): 致命异常: Thread-11864 E/AndroidRuntime(16409): java.lang.NullPointerException E/AndroidRuntime(16409): at com.fritsch.cpu.SocketIOClient.cleanup(SocketIOClient.java:183) E /AndroidRuntime(16409): 在 com.fritsch.cpu.SocketIOClient.access$0(SocketIOClient.java:181) E/AndroidRuntime(16409): 在 com.fritsch.cpu.SocketIOClient$2.onError(SocketIOClient.java:152) E /AndroidRuntime(16409): 在 com.fritsch.cpu.WebSocketClient$1.run(WebSocketClient.java:125) E/AndroidRuntime(16409): 在 java.lang.Thread.run(Thread.java:856)

如果我在初始后更改 BG 颜色，它工作正常。我认为问题是 Websocket 的线程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:21:29.797

我认为您不能在线程中更改 UI，并且我认为您可以尝试使用 Handler 来处理 UI 更新。

# javascript - Javascript Document.write 另一个脚本

> ID：12810853
> 
> 赞同：0
> 
> 时间：2012-10-10T01:50:11.620
> 
> 标签：javascript, escaping

所以我正在尝试使用 document.write 将另一个脚本写入文档。这是我的函数代码：

```
 function onSaveOk(streamName,streamDuration,userId,cameraName,micName,recorderId){
        //alert("onSaveOk("+streamName+","+streamDuration+","+userId+","+cameraName+","+micName+")");

        //the user pressed the [save] button inside the recorder and the save_video_to_db.XXX script returned save=ok
        //recorderId: the recorderId sent via flash vars, to be used when there are many recorders on the same web page

            $('#record').hide();

document.write('"<d"+"iv id=jwplayer>"
+ "<cen"+"ter>" +
"<d"+"iv id=mediaplayer>"+"</di"+"v>"+
"<scr"+"ipt type=text/javascript>
  jwplayer('mediaplayer').setup({
    'flashplayer': 'jwplayer/player.swf',
    'id': 'playerID',
    'width': '640',
    'height': '580',
    'provider': 'rtmp',
    'streamer': 'rtmp://domain/recorder/_definst_',
    'file': 'onSaveOk("+streamName+")'
  }); " +
"</scr"+"ipt>"+
"</cen"+"ter>"
') 
```

基本上发生的事情是应该出现的记录器根本没有出现。当我在我的函数中有这个时，由于某种原因也 `$('#record').hide();`不起作用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T01:54:08.447

您应该直接附加`<div>`using jQuery，并正常调用该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T02:38:31.453

一旦文档被解析，您就不要使用`document.write()`它，因为它会清除当前文档。相反，您需要以编程方式将元素添加到文档中。

要在加载后将 HTML 添加到文档中，可以使用以下 javascript：

```
var player = document.createElement("div");
player.innerHTML = '<div id="mediaplayer"></div>';
player.id = "jwplayer";
document.body.appendChild(player);    // you decide where to add it to your page

jwplayer('mediaplayer').setup({
    'flashplayer': 'jwplayer/player.swf',
    'id': 'playerID',     // shouldn't this match one of the IDs in your HTML???
    'width': '640',
    'height': '580',
    'provider': 'rtmp',
    'streamer': 'rtmp://domain/recorder/_definst_',
    'file': 'onSaveOk("+streamName+")'
  }); 
```

# ruby - 为什么 rspec 说 should_receive 未收到此方法？

> ID：12810856
> 
> 赞同：0
> 
> 时间：2012-10-10T01:50:44.997
> 
> 标签：ruby, ruby-on-rails-3, rspec2, rspec-rails

我的问题是，为什么我会收到以下 rspec 错误消息？（下面的代码）我已经在 StripeSubscription 模型上存根 :update_payment 方法。我已经在这里待了几个小时，很困惑。

```
Failure/Error: @stripe_msub.should_receive(:update_payment).and_return(@stripe_msub)
       (#<StripeSubscription:0xb879154>).update_payment(any args)
           expected: 1 time
           received: 0 times

 ###Rspec test###
    describe "PUT 'update'" do
        context "signed-in teacher" do
           before(:each) do
            @teacher = Factory(:teacher)
            @teacher_upload = Factory(:teacher_upload,:teacher_id=>@teacher.id)
            @stripe_mplan = Factory(:stripe_plan)
            @new_stripe_card_token = 528
            @stripe_msub = Factory(:stripe_subscription,:teacher_id=>@teacher.id,:stripe_plan_id=>@stripe_mplan.id, :email=>@teacher.email,:account_status=>Acemt::Application::STRIPE_SUBSCRIPTION_ACCOUNT_STATUS[:active])
            @stripe_msub.stub!(:update_payment).and_return(@stripe_msub)
            StripeSubscription.stub!(:update_payment).and_return(@stripe_msub)
            StripeSubscription.stub!(:update_attributes).and_return(true)
            @stripe_customer = mock('Stripe::Customer')
            Stripe::Customer.stub!(:retrieve).with(@stripe_msub.stripe_customer_token).and_return(@stripe_customer)
            @stripe_customer.stub(:card=).and_return(true)
            @stripe_customer.stub(:save).and_return(true)
            test_sign_in(@teacher)
          end
          it "should update credit card information" do
            @stripe_msub.should_receive(:update_payment)
            Stripe::Customer.should_receive(:retrieve).with(@stripe_msub.stripe_customer_token).and_return(@stripe_customer)
            @stripe_customer.should_receive(:card=)
            @stripe_customer.should_receive(:save).and_return(@stripe_customer)

            put :update, :teacher_id=>@teacher.id, :stripe_subscription=>{:stripe_plan_id=>@stripe_msub.stripe_plan_id, :teacher_id=>@stripe_msub.teacher_id, :email=>@stripe_msub.email, :stripe_customer_token=>@stripe_msub.stripe_customer_token,:stripe_card_token=>@new_stripe_card_token,:account_status=>@stripe_msub.account_status}
            @teacher.stripe_subscription.should == @stripe_msub
            response.should redirect_to teacher_path(@teacher)

          end
        end #signed in teacher
      end #PUT update

###controller###
class StripeSubscriptionsController < ApplicationController
  before_filter :signed_in_teacher
  before_filter :correct_teacher
  :
   def update
    #@stripe_subscription = StripeSubscription.find_by_id(params[:id])
    @stripe_subscription = @teacher.stripe_subscription
    if @stripe_subscription.update_payment(params[:stripe_subscription])
      #handle successful update
      flash[:success] = "Credit card updated"
      sign_in @teacher
      redirect_to @teacher
    else
      render 'edit'
    end
  end
  :
end

###model###
class StripeSubscription < ActiveRecord::Base
  #attr_accessible :email, :plan_id, :stripe_customer_token, :teacher_id, :account_status
  validates_presence_of :stripe_plan_id
  validates_presence_of :email
  validates_presence_of :teacher_id

  belongs_to :stripe_plan, :class_name=>"StripePlan"
  belongs_to :teacher
  attr_accessor :stripe_card_token

  def save_with_payment
    if valid?
      customer = Stripe::Customer.create(description: email, plan: stripe_plan_id, card: stripe_card_token)
      self.stripe_customer_token = customer.id
      save!
    end

    rescue Stripe::InvalidRequestError => e
      logger.error "Stripe error while creating customer: #{e.message}"
      errors.add :base, "There was a problem with your credit card."

  end
  def update_payment(stripe_params)
    if valid?
      customer = Stripe::Customer.retrieve(self.stripe_customer_token)
      customer.card = stripe_params[:stripe_card_token]
      status = customer.save #update card info on Stripe
      update_attributes(stripe_params) #save StripeSubscription object
    end

    rescue Stripe::InvalidRequestError => e
      logger.error "Stripe error while updating your credit card: #{e.message}"
      errors.add :base, "There was a problem with your credit card."
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T08:03:21.933

您正在对规范 ( `@stripe_msub`) 中的对象设置期望。然而，在控制器中，您可能会从数据库中加载*教师*并获取其订阅 ( `@stripe_subscription`)。

由于通过数据库的往返，该对象与您设置期望的对象不同，因此您设置期望的对象（`@stripe_msub`在规范中）永远不会收到方法调用，因此 rspec 抱怨。

要解决此问题，您必须将所有数据库调用存根，并确保您的规范中的对象出现在控制器中。我不知道`@teacher`控制器中的确切设置位置（我猜是在其中一个过滤器中）所以我不能给你确切的解决方案，但它会是这样的：

```
# I assume this is the implentation of your filter in the controller
def signed_in_teacher
  @teacher = Teacher.find_by_id(params[:teacher_id])
end

# Then you would have to add the following mocks/stubs to your spec
Teacher.should_receive(:find_by_id).once.with(@teacher.id).and_return(@teacher) 
```

# ruby-on-rails - 从主机访问虚拟机上的 Rails 服务器

> ID：12810859
> 
> 赞同：2
> 
> 时间：2012-10-10T01:51:31.363
> 
> 标签：ruby-on-rails, vmware

我使用 VMware 在 Windows 7 Pro 上将 Ubuntu（最新版本）作为虚拟机运行。我的问题是，我可以在虚拟机运行时让 rails sever 可访问 Windows 吗？因此，例如，如果我在 Windows 浏览器上键入，`http://localhost:3000`我会得到 rails sever 吗？

另外，我可以让它从外部访问计算机，所以如果有人打字 `myipaddress:3000`，他就可以作为客户端访问服务器吗？

我希望这很清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T02:00:16.233

这里有很多“如果”，但它应该“正常工作”。

在 Linux 中，找到虚拟机的 IP 地址。

`$ /sbin/ifconfig`

您正在寻找一个可能标记为“ `eth0`”的部分，并且在该部分中为“ `inet addr`”。

从您的 Windows 主机使用该地址和端口 3000 应该可以正常工作。如果没有，请发布您看到的具体问题，包括您可以找到的任何日志或您在 Linux 客户端上运行的任何防火墙的信息。

# python - Python 多处理：如何删除托管字典键？

> ID：12810860
> 
> 赞同：6
> 
> 时间：2012-10-10T01:51:31.270
> 
> 标签：python, dictionary, multiprocessing, python-multiprocessing

我有一个由管理的字典`SyncManager`，我正在使用`.get()`and`.update()`函数来检索和设置字典键和值。但是，该`del dict[key]`方法未实施。有没有办法从托管字典键中删除键？

简单的例子：

```
mgr = multiprocessing.Manager()
shared_dict = mgr.dict()

shared_dict.update( {'key1' : 'value1'} )
print shared_dict.get('key1')

#Now let's delete key1
del shared_dict['key1']  #Nope!
shared_dict.__delitem__('key1')  #Also not allowed 
```

# r - 如何在 R 和 ggplot2 中获得具有多个数据集的单个趋势线？

> ID：12810861
> 
> 赞同：2
> 
> 时间：2012-10-10T01:51:45.910
> 
> 标签：r, ggplot2

我有超过三个十年的多个数据来源。数据是不连续的并且在多个地方重叠。我想为每个数据源绘制不同颜色的点，然后添加一条使用所有数据源的趋势线。包含的代码有一些示例数据和两个绘图示例。第一次调用 ggplot，为所有数据绘制一条趋势线。第二个 ggplot 调用，用不同的颜色用自己的趋势线清楚地绘制每个源。

```
 library(ggplot2)
    the.data <- read.table( header=TRUE, sep=",", 
    text="source,year,value
    S1,1976,56.98
    S1,1977,55.26
    S1,1978,68.83
    S1,1979,59.70
    S1,1980,57.58
    S1,1981,61.54
    S1,1982,48.65
    S1,1983,53.45
    S1,1984,45.95
    S1,1985,51.95
    S1,1986,51.85
    S1,1987,54.55
    S1,1988,51.61
    S1,1989,52.24
    S1,1990,49.28
    S1,1991,57.33
    S1,1992,51.28
    S1,1993,55.07
    S1,1994,50.88
    S2,1993,54.90
    S2,1994,51.20
    S2,1995,52.10
    S2,1996,51.40
    S3,2002,57.95
    S3,2003,47.95
    S3,2004,48.15
    S3,2005,37.80
    S3,2006,56.96
    S3,2007,48.91
    S3,2008,44.00
    S3,2009,45.35
    S3,2010,49.40
    S3,2011,51.19") 
    ggplot( the.data, aes( the.data$year, the.data$value ) ) + geom_point() + geom_smooth()
    #ggplot( the.data, aes( the.data$year, the.data$value, color=the.data$source ) ) + geom_point() + geom_smooth() 
```

第二个调用显示彩色数据点，我想添加一条表示所有年份的连续趋势线。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T01:56:07.523

像这样：

```
ggplot(the.data, aes( x = year, y = value ) ) + 
    geom_point(aes(colour = source)) + 
    geom_smooth(aes(group = 1)) 
```

![在此处输入图像描述](../Images/d877ab969cb96cdd52b1f570a2ac2776.png)

几点注意事项：

*   不要将美学映射到像`the.data$year`. （直到您真正知道自己在做什么，并且知道何时打破该规则。）只需使用列名。

*   在各自的`geom`调用中将您想要的美学映射到单独的层中。在这种情况下，我希望点的颜色不同，但对于平滑线，我希望将数据全部分组（`group = 1`）。

# ios - NSNotificationCenter 删除错误的观察者？

> ID：12810867
> 
> 赞同：0
> 
> 时间：2012-10-10T01:52:29.700
> 
> 标签：ios, nsnotificationcenter, nsnotifications

removeObserver:name:object: 是否有任何极端情况行为？在以下代码块中，我的观察者未正确注册：

```
- (void)setPlayerItem:(AVPlayerItem *)playerItem {
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(playerItemDidReachEnd:)
                                                 name:nil
                                               object:playerItem];

    [playerItem addObserver:self
                 forKeyPath:kStatus
                    options:0
                    context:(__bridge void*)self];

    [playerItem addObserver:self
                 forKeyPath:kPlaybackBufferEmpty
                    options:0
                    context:(__bridge void*)self]; // For adding a buffering activity indicator

    id temp = playerItem_;
    playerItem_ = [playerItem retain];

    [[NSNotificationCenter defaultCenter] removeObserver:self name:nil object:temp];
    [temp removeObserver:self forKeyPath:kPlaybackBufferEmpty];
    [temp removeObserver:self forKeyPath:kStatus];
    [temp release];
} 
```

但是，如果我将顺序更改为：

```
- (void)setPlayerItem:(AVPlayerItem *)playerItem {    
    [playerItem addObserver:self
                 forKeyPath:kStatus
                    options:0
                    context:(__bridge void*)self];

    [playerItem addObserver:self
                 forKeyPath:kPlaybackBufferEmpty
                    options:0
                    context:(__bridge void*)self]; // For adding a buffering activity indicator

    id temp = playerItem_;
    playerItem_ = [playerItem retain];

    [[NSNotificationCenter defaultCenter] removeObserver:self name:nil object:temp];
    [temp removeObserver:self forKeyPath:kPlaybackBufferEmpty];
    [temp removeObserver:self forKeyPath:kStatus];
    [temp release];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(playerItemDidReachEnd:)
                                                 name:nil
                                               object:playerItem];
} 
```

所有通知都发布得很好。这让我相信当我打电话时发生了一些奇怪的事情：

```
 [[NSNotificationCenter defaultCenter] removeObserver:self name:nil object:temp]; 
```

我在这里错过了一些非常明显的东西吗？我在没有 ARC 的 iOS 6 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-16T04:31:34.547

找到了答案。原来这与传入`nil`观察者姓名有关。呼叫将从观察 发布的任何通知`[[NSNotificationCenter defaultCenter] removeObserver:self name:nil object:temp];` 中删除。但是，在 temp is 的极端情况下，这行代码将作为观察者一起删除。`self``temp``nil``self`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T01:56:35.293

名字不应该是零。你试过给你的观察者起个名字吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T03:03:49.907

@Lee 是正确的，名称不应该是 nil，但也不应该是观察者的名字。相反，它应该是您正在注册观察的通知的名称。例如，UIDeviceOrientationDidChangeNotification。在该参数中添加您要观察的通知的名称，并在删除观察者时将其作为名称参数传递

# approval-tests - ApprovalTests....编译后移动程序集

> ID：12810868
> 
> 赞同：1
> 
> 时间：2012-10-10T01:52:42.583
> 
> 标签：approval-tests

首先，很棒的图书馆！

如果我编译，然后在我验证它仍然在它编译的位置查找 *.approved.txt 时移动程序集，在我的情况下它不再存在。

我在 Teamcity 上遇到了这个问题，我们在不同的任务中构建和测试。因此，构建步骤将在 c:\BuildAgent\SomeGuid...

```
[Fact]
public void ShouldCreateCorrectOutgoingFiles() {
    var textToVerfiy = "Here's some text To Verify";
    Approvals.Verify(textToVerfiy);
} 
```

...

```
: System.IO.DirectoryNotFoundException : Could not find a part of the path 'r:\w\254cbbd5ec9b56bc\project\ScenarioTests\myTests'.
Stack Trace:
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.Directory.InternalCreateDirectory(String fullPath, String path, Object dirSecurityObj, Boolean checkHost)
   at System.IO.Directory.InternalCreateDirectoryHelper(String path, Boolean checkHost)
   at System.IO.Directory.CreateDirectory(String path)
   at ApprovalTests.ApprovalTextWriter.WriteReceivedFile(String received)
   at ApprovalTests.Approvers.FileApprover.Approve()
   at ApprovalTests.Core.Approvals.Verify(IApprovalApprover approver, IApprovalFailureReporter reporter)
   at ApprovalTests.Approvals.Verify(IApprovalWriter writer, IApprovalNamer namer, IApprovalFailureReporter reporter)
   at ApprovalTests.Approvals.Verify(IApprovalWriter writer)
   at ApprovalTests.Approvals.Verify(String text) 
```

关于如何调整它以在相对目录中查找可执行文件的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T13:23:44.790

您必须编写一个自定义命名器。这很容易。看看这些文件。

[http://bit.ly/IApprovalNamer](http://bit.ly/IApprovalNamer)

[http://bit.ly/XUnitStackTraceParser](http://bit.ly/XUnitStackTraceParser)

[http://bit.ly/AttributeStackTraceParser](http://bit.ly/AttributeStackTraceParser)

完成此操作后，您必须注册名称以供使用，只需调用即可。

```
Approvals.RegisterDefaultNamerCreation(()=> new MyCustomNamer()); 
```

# html - HTML5/Canvas - 将 Base64 图像保存到服务器（替换当前图像）

> ID：12810869
> 
> 赞同：1
> 
> 时间：2012-10-10T01:52:47.840
> 
> 标签：html, canvas

我目前正在试验 HTML5 Canvas。

我目前制作了一个简单的小绘画应用程序，您可以在其中画线等等。

我做到了，所以我可以将图像保存在 base64 中。with var dataUrl = document.getElementById('your-canvas').toDataURL();

我想知道是否可以拍摄该图像，并将其保存到我的服务器（或任何地方）替换/覆盖已经存在的图像。

这样做的目的是将保存的图像作为画布的背景。然后每次有人在画布上绘图并单击保存时，它会将他们的绘图保存为背景图像，以便下一个继续使用它的人可以看到最后一个人绘制的内容。

基本上是一个公共互联网白板。

有人可以告诉我这是否可能，并指出正确的方向（代码语言、教程等）吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:45:03.433

You can display or save image like this：</p>

```
$imgData = $_POST['data'];

$imgData = str_replace(' ','+',$_POST['data']);
$imgData = preg_replace('/^data:image\/(png|jpg);base64,/','',$imgData);

header("Content-type: image/png");
echo base64_decode($imgData); 
```

# javascript - CSS 不会影响 Phonegap 上动态创建的列表

> ID：12810871
> 
> 赞同：0
> 
> 时间：2012-10-10T01:53:41.757
> 
> 标签：javascript, css, cordova, dynamic-list

类似于我的问题是[这个](https://stackoverflow.com/questions/8962593/my-list-wont-take-the-css-in-phonegap) 和[这个](https://stackoverflow.com/questions/11786465/jquery-mobile-dynamic-listview-loses-style-data-inset-after-updating)

但是，仍然没有对任何解决方案进行排序..我在`<body>`一个无序列表中`<ul>`，每个元素都是在对数据库执行查询后添加的..所以根据结果，我`<li>`创建了相应的标签..

另一个问题是，虽然我有一些 css 可以`<li>`将“奇数”和“偶数”分开，以便我可以应用一些不同的样式，并且我已经确认，“奇数”和偶数“属性已作为属性传递（类名)`<li>`还是对应的css规则，不适用

这是我的一些代码..首先是html部分

```
<div id="sqldiv">
   <ul class="test" id="attempt">
    </ul>
</div> 
```

和javascript部分..

```
 for (var i=0; i<len; i++){
        var somevariable =  results.rows.item(i).dbvariable;
                if (i%2==0)
                lt='Even';
                else
                lt='Odd';
                var newLI = document.createElement("LI"); 
                newLI.className = lt;
                var htmlcontainer = ("<div>my text :" + my variables + "</div><div>my text :</div><div>" my variables + "</div>");
                newLI.innerHTML = htmlcontainer ;
                var gl = document.getElementById("attempt"); 
                gl.appendChild(newLI);
            } 
```

和CSS

```
li {
background: #8258FA;
list-style-type:none;
list-style-image:none;
margin: 5px 5px;
border-radius: 15px;
}
li.odd  {
border-bottom :1px dotted #ccc;
list-style-type:none;
list-style-image:none;
margin: 5px 5px;
background: #000000;
} 
```

li 样式确实适用，但按类 (li.odd) 的样式不适用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T15:37:44.750

在花了最后 24 小时搜索之后..我尝试了一些我没想到的东西..!!!!

在 javascript 中，我命名为 Even 和 Odd 类。在 css 上，我有 .even 和 .odd 规则。这在另一个项目中效果很好。！！！

但是，由于某种原因，在这种情况下，似乎存在“区分大小写”的问题。由于我将 css 规则更改为 .Even 和 .Odd，因此它们已成功应用。

在达到此之前，我还尝试使用 jquery 分配动态 css 规则。经过一些尝试，我最终区分了大小写。

# javascript - JQuery在显示之前加载div内的所有图像

> ID：12810878
> 
> 赞同：4
> 
> 时间：2012-10-10T01:54:27.767
> 
> 标签：javascript, jquery, css, html

我想在实际显示它们之前将每个图像加载到 div 中。我有类似的东西：

```
<div>

<img src="1.jpg" />
<img src="1.jpg" />
<img src="1.jpg" />
<img src="1.jpg" />
<img src="1.jpg" />
<img src="1.jpg" />

</div> 
```

起初我尝试做这样的事情：

```
$('div img').load(function() {

$('div img').show();

}); 
```

或这个：

```
$('div').find('img').load(function() {

$('div img').show();

}); 
```

不幸的是，这不起作用，因为一旦浏览器加载了一个图像，它就会触发事件。关于如何首先加载所有内容的任何想法？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-10T01:58:43.363

您可以跟踪已加载的图像数量：

```
var $images = $('div img'),
    preloaded = 0,
    total = $images.length;
$images.load(function() {
    if (++preloaded === total) {
        // Done!
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T01:57:14.517

不幸的是，以跨浏览器兼容的方式做到这一点并不容易。但幸运的是，有 2 个插件可以让它变得轻松。

查看[waitforimages](https://github.com/alexanderdickson/waitForImages)和[imagesloaded](https://github.com/desandro/imagesloaded)

然后你可以这样做：

```
$('div').waitForImages(function(){
  $(this).find('img').show();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T01:57:00.677

试试这个 [http://chipsandtv.com/articles/jquery-image-preload](http://chipsandtv.com/articles/jquery-image-preload)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-16T23:44:16.183

**这对我有用：**

```
$(document).ready(function () {
    $('#div with images').hide();
});

$(window).load(function () {
    $('#div with images').show();
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-20T14:40:31.293

首先，现代浏览器可以同时执行 6 个请求 => 不要在加载时加载这么多图像。如果你有很多图片，你可以在后面设置图片 'src=""' 或不设置 "src" 属性，并在第一张图片加载后设置

其次，您可以使用检查“图像已加载”

```
 document.getElementById('#imageId').complete == !0 
```

您可以检查最大尺寸的图像或 DOM 中的最后一个图像，以确保其他图像已加载。

希望它会帮助你。

# javascript - 我在javascript中不断收到这个错误？（收音机，用javascript检查它们）

> ID：12810879
> 
> 赞同：2
> 
> 时间：2012-10-10T01:54:36.593
> 
> 标签：javascript, radio, checked

由于某种原因，我不断收到此错误，我不知道为什么。

```
Uncaught TypeError: Cannot set property 'checked' of null js.js:4
check js.js:4
(anonymous function) 
```

这是我的代码：

```
document.body.onload="check()";
function check()
{
document.getElementById("urlchoice").checked=true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T11:45:51.833

首先检查`document.getElementById("urlchoice")`是否`null`。

```
 window.onload = check;

    function check(){
        if(document.getElementById("urlchoice")!=null){ // available
           document.getElementById("urlchoice").checked = true; 
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T02:11:13.297

id为“urlchoice”的未识别元素的错误点，你确定它存在吗？

```
<body>    
    <input id="urlchoice" type="radio">

    <script>
        document.body.onload = check();
        function check(){        
            document.getElementById("urlchoice").checked=true;
        }
    </script>
</body> 
```

似乎有效（我删除了**document.body.onload = check();**行的双引号，它不适用于它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T01:59:21.243

假设您有一个带有 ID 的元素`urlchoice`（其缺席对诊断来说是微不足道的，但我认为这不会导致您的问题，因为您说它`check`正在被调用），请尝试`window.onload`，而不是`document.body.onload`.

**编辑**

同样，假设文档有一个带有 id = 的单选按钮元素`urlchoice`，并且脚本被正确调用并正在运行，

尝试：

```
function check() {
    document.getElementById("urlchoice").checked=true;
}
window.onload=check; 
```

或者

```
window.onload = function () {
    document.getElementById("urlchoice").checked=true;
} 
```

这些真的应该工作。

# android - 如何在android中从一个意图获取字符串到另一个意图

> ID：12810885
> 
> 赞同：2
> 
> 时间：2012-10-10T01:55:25.703
> 
> 标签：android

我试图将字符串从一个意图转移到另一个意图。我已经尝试过，但总是出错。这是我的代码：

```
i = new Intent(this, JadwalKeberangkatan.class);

btnCari.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
    String getAsal = txtAsal.getText().toString();
            String getTujuan = txtTujuan.getText().toString();

            String words[] = getAsal.split(" ");
            String last = words[words.length - 1]; // parsing asal
            String s = last.replaceAll(Pattern.quote("("), "");
            String s1 = s.replaceAll(Pattern.quote(")"), "");
            String asal = s1;

            String word[] = getTujuan.split(" ");
            String lastw = word[word.length - 1]; // parsing tujuan
            String t = lastw.replaceAll(Pattern.quote("("), "");
            String t1 = t.replaceAll(Pattern.quote(")"), "");
            String tujuan = t1;

             //get tanggal
            int day = dtKeb.getDayOfMonth();
            int month = dtKeb.getMonth() + 1;
            int year = dtKeb.getYear();
            String hari = Integer.toString(day);
            String bulan = Integer.toString(month);
            String tahun = Integer.toString(year);
            String tanggal = ""+hari+"-"+bulan+"-"+tahun;

            Bundle bundle = new Bundle();
            bundle.putString("asal", asal);
            bundle.putString("tujuan", tujuan);
            bundle.putString("tanggal", tanggal);

            startActivity(i);
        }
 } 
```

这里是 JadwalKeberangkatan 类的代码

```
public class JadwalKeberangkatan extends Activity {

Intent intent = getIntent();
String asal = intent.getExtras().getString("asal");
String tujuan = intent.getExtras().getString("tujuan");
String tanggal = intent.getExtras().getString("tanggal");

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.jadwal);       
    TextView tx1 = (TextView)findViewById(R.id.textView1);
    tx1.setText(asal);
    TextView tx2 = (TextView)findViewById(R.id.textView2);
    tx2.setText(tujuan);
    TextView tx3 = (TextView)findViewById(R.id.textView3);
    tx3.setText(tanggal);
   }    
} 
```

如果我删除意图意图 = getIntent(); 然后 tx1 设置为“hello”，这个程序运行正常。那么我该怎么做才能从另一个意图中获取字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T02:10:46.370

您将 3 个字符串放入 Bundle，而不是传递给活动的意图。代替：

```
Bundle bundle = new Bundle();
bundle.putString("asal", asal);
bundle.putString("tujuan", tujuan);
bundle.putString("tanggal", tanggal);

startActivity(i); 
```

做：

```
i.putExtra("asal", asal);
i.putExtra("tujuan", tujuan);
i.putExtra("tanggal", tanggal); 
```

然后字符串实际上将进入下一个活动。

# php - 从父函数的父类调用函数

> ID：12810889
> 
> 赞同：1
> 
> 时间：2012-10-10T01:55:41.963
> 
> 标签：php, class

假设，为简单起见，这就是我的页面的设置方式：

```
class TFS extends PHP_db
{
    public function execute() {
        class Dostuff {
            public static function doit() {
                return "wee";
            }
        }
    Now here I can use Dostuff:doit() successfully
    And also $this->db->functionhere() which is from the PHP_db is also successful from here

    }
} 
```

我需要弄清楚如何`$this->db->functionhere()`从`doit()`Dostuff 类中的函数内部调用..

我已经在 Dostuff 课程中尝试过这个：

```
protected $parent_object;
public function __construct( $object ) {
    $this->parent_object = $object;
 } 
```

这来自 execute() 函数：`$dostuffclass = new Dostuff($this);`

但是当我尝试使用`$parent_object->db->functionhere()`它时它不起作用，告诉我它不是一个对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:07:13.437

您可以将`$this`上下文作为参数传递给内部`DoStuff`类，例如：

```
class TFS extends PHP_db
{
    public function execute() {
        class Dostuff {
            public static function doit($somevar) {
                $somevar->functionhere();
                ^^^^ <-- add this
                return "wee";
            }
        }
    }
} 
```

内部类`DoStuff`不需要知道`$this`您所引用的上下文的任何信息，因为您正在将现有类实例的引用作为参数发送给它。

# php - 如何在 MVC 框架中有效地实现模块，并在单个模块中处理到多个控制器的路由？

> ID：12810899
> 
> 赞同：4
> 
> 时间：2012-10-10T01:57:09.053
> 
> 标签：php, model-view-controller, module, design-patterns, vendor

我已经开发了一个基本的 MVC 框架作为 php 中的一个学习项目——这实际上是它的第二个版本，我正在尝试改进第一个版本不足的两个方面：

*   **请求路由：**映射请求，例如 /controller/action/[params]
*   **模块：**旨在扩展应用程序的插入式应用程序，例如 CMS。

## 这就是我现在所处的位置：

1.  我能够接受一个请求并将其解析为各个部分，例如控制器、动作、参数等。这些映射到相应的控制器类/文件，例如“/foo/bar”-> FooController::bar() - 所有这些都在我的 RequestRouter 类中完成并封装在 Request 对象中。

    *   我维护一个 Manifest 对象，其中包含对应用程序文件的分类引用（控制器、lib 等）。清单由我的自动加载器方法使用。
    *   由于清单已缓存，因此每当我添加新文件/类时都会重新构建它，这适用于添加/删除新模块时。
2.  Controller::methods() 可以很好地呈现正确的视图。

3.  然后是模块，它们的组织方式就像核心结构一样（/root/raspberry/vendors/core/module）

## 问题

我认为我目前遇到的问题是涉及模块的路由/请求处理的组合：

*   如果我请求 project.dev/admin 它映射到 **AdminController::index()** - 这是正确的
*   但是，当我引用 project.dev/admin/editor 时，我仍然得到**AdminController::editor()**我真正想要的是**EditorController::index()**

经过一番研究，我想我可以创建一个**装饰器**，它实现了一个**前端控制器**模式并包装了一个给定的控制器。装饰器可以重新解析请求以使 /editor 成为控制器并重新映射剩余的段（/editor/action/args）。

所有这一切似乎都可以正常工作，但我觉得我在流程的早期缺少一些基本的东西（RequestRouter）。我在 SO 中研究了其他类似的问题，并阅读了 HMVC，原则上它似乎可以回答我的问题，但它似乎比框架驱动更接口驱动（如果这有意义？）我已经还查看了其他框架，例如 Kohana，但我不太了解它们的模块系统和路由到同一模块中的多个控制器的工作原理。

任何关于如何在不引入前端控制器或重新解析请求的情况下有效实施模块系统的见解或建议将不胜感激。或者，如果我应该以不同的方式重新构建我的模块，我想了解如何做到这一点。

## 附加信息：

我的 RequestRouter 维护着我预定义的路由列表（包括它们的默认方法）。使用这些预定义的路由，我**可以**访问 /admin/editor 并获取 EditorController::index()，但我必须为每个控制器定义一个路由，并请求发送到模块中的控制器。我不认为这是一个好的设计。这是我的路线示例：

```
Array
(
    [/foo] => Array
        (
            [controller] => FooController
            [method] => bar
            [path] => /core
        )

    [/admin] => Array
        (
            [controller] => AdminController
            [method] => index
            [path] => /vendors/admin
        )

    [/admin/editor] => Array
        (
            [controller] => EditorController
            [method] => index
            [path] => /vendors/admin
        )

) 
```

这就是我的 Request 对象的样子：

```
Request Object
(
    [properties:Request:private] => Array
        (
            [url] => /admin/editor
            [query] => 
            [uri] => /admin/editor
            [controller] => admin
            [action] => editor
            [args] => 
            [referrer] => Array
                (
                    [HTTP_REFERER] => 
                    [REMOTE_ADDR] => 127.0.0.1
                    [HTTP_VIA] => 
                    [HTTP_X_FORWARDED_FOR] => 
                )

            [get] => 
        )

    [request_status:Request:private] => 200
) 
```

这是我的清单样本：

```
[controller] => Array
    (
        [icontroller] => /htdocs/raspberry/raspberry/core/controller/icontroller.class.php
        [index] => /htdocs/raspberry/raspberry/core/controller/index.php
        [serviceerror] => /htdocs/raspberry/raspberry/core/controller/serviceerror.controller.php
        [admin] => /htdocs/raspberry/raspberry/vendors/core/admin/controller/admin.controller.ph
        [composer] => /htdocs/raspberry/raspberry/vendors/core/admin/controller/composer.controller.php
    ) 
```

这是应用程序文件系统：

[http://s11.postimage.org/pujb2g9v7/Screen_shot_2012_10_09_at_8_45_27_PM.png](http://s11.postimage.org/pujb2g9v7/Screen_shot_2012_10_09_at_8_45_27_PM.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T02:09:44.453

该问题似乎是由过度简化的路由机制引起的。我得到的印象是您使用简单`explode()`的方法从 URL 收集参数。虽然这仅在基本示例中有效，但当您尝试使用更高级的路由方案时，设置将失败。

`/`您应该将其与正则表达式模式匹配，而不是在 上拆分字符串。基本上，您定义要匹配的模式列表，第一个匹配用于填充`Request`实例。

在您的情况下，将定义两种模式：

*   `'#admin/(:?(:?/(?P<controller>[^/\.,;?\n]+))?/(?P<action>[^/\.,;?\n]+))?#'`
*   `'#(:?(:?/(?P<controller>[^/\.,;?\n]+))?/(?P<action>[^/\.,;?\n]+))?#'`

如果第一个失败，第二个将匹配。

**PS**你应该知道控制器不应该渲染输出。响应的生成是视图实例的责任。视图应该是功能齐全的对象，其中包含表示逻辑并且可以从多个模板组成响应。

# sql - 在 linqpad 中使用 sqlfunctions

> ID：12810907
> 
> 赞同：9
> 
> 时间：2012-10-10T01:58:04.640
> 
> 标签：sql, linq, linqpad

我的 LinqPad 将 SqlFunctions 视为无法识别的类。智能感知是课堂的重点。

如何在我的 linqpad 查询中调用库？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-10T01:59:09.910

按`F4`并添加`System.Data.Objects.SqlClient`命名空间。

# python - 在 python 中，self 并不意味着实例？

> ID：12810911
> 
> 赞同：1
> 
> 时间：2012-10-10T01:58:29.647
> 
> 标签：python

我只是做了一个 foo 类来解释我的意思：

```
class Foo:
    def __init__(self, fakevalue):
        self.fv = fakevalue

    @staticmethod
    def make_a_foo():
        return Foo(2)

    def try_change_foo_value(self):
        self = Foo.make_a_foo()
        print "in change function, self.fv:", self.fv

if(__name__ =='__main__'):
    foo_instance = Foo(1)
    print "foo_instance.fv:", foo_instance.fv
    foo_instance.try_change_foo_value()
    print "foo_instance.fv:", foo_instance.fv 
```

我预计：

```
foo_instance.fv: 1
in change function, self.fv: 2
foo_instance.fv: 2 
```

但结果是：

```
foo_instance.fv: 1
in change function, self.fv: 2
foo_instance.fv: 1 
```

我们可以看到 self 的值已经改变了，但是 instance 的值没有。为什么？以及如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T02:00:52.867

在这种情况下，`self`是指向调用者实例的指针。虽然你改变了 in 中的指针`try_change_foo_value`，但它就像改变函数中的参数一样：它在方法之外没有任何影响。

为了澄清这一点，您可以考虑

`a.try_change_foo_value()`作为`Foo.try_change_foo_value(a)`. 这应该清楚地表明，当您更改时`self`，您正在更改*局部*变量，而`a`调用者保持不变。

要修复它，你应该这样做

```
def try_change_foo_value(self):
    self.fv = 2 
```

但正如 mgilson 指出的那样，只是说`foo_instance.fv = 2`.

如果您想实际更改`foo_instance`（而不仅仅是`fv`）的值，您应该在其他地方进行，而不是在方法中（这几乎没有概念意义）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T02:03:11.633

`self`只是一个变量。对于常规方法（例如，没有用@staticmethod 或@classmethod ...修饰），传入的对象是实例。但是，在函数内，您可以重新绑定`self`到您想要的任何内容，但更改不会保留在函数之外，因为赋值只是对右侧的对象进行新引用 - 除非您返回该引用或将它存储在具有更广泛范围的对象上，当函数结束时它将超出范围，再也不会被听到（因为你不再有它的引用/句柄）。

考虑常规函数：

```
def foo(x):
    x = 2

a = 1
foo(a)
print a #prints 1, not 2 
```

这真的没有什么不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T02:22:21.080

Python 中有一个关于赋值的非常简单的规则。在 Python 中分配一个名称**总是**只是使该名称现在引用您刚刚分配给它的任何对象。它**从来没有**真正改变分配之前名称所指的任何对象。

这样做的一个简单结果是，在 line`self = Foo.make_a_foo()`中，与之前的内容完全*无关*`self`。我们谈论类和实例的事实与此无关。无论`self`以前是什么，我们现在只拥有`self`引用新`Foo`对象的名称。

请记住，*名称*只是一个句柄，可让您获取*对象*。在任何给定的时刻，一个给定的对象可以被 0、1 或多个名称引用。赋值是影响名称而不是对象的操作。您无法通过更改引用对象的名称来更改对象。

```
foo_instance = Foo(1)
print "foo_instance.fv:", foo_instance.fv
foo_instance.try_change_foo_value()
print "foo_instance.fv:", foo_instance.fv 
```

当上述调用`foo_instance = Foo(1)`时，它会导致名称`foo_instance`引用一个新对象。当您调用 时`foo_instance.try_change_foo_value()`，该对象会`self`在方法范围内获得一个附加名称。当您更改该名称以引用新对象时，它不会影响原始对象*或*`foo_instance`仍然引用该原始对象的名称。

这是一个非常，非常好的事情！否则，每当您调用一个函数并向其传递一些对象时，该函数对其自己的局部变量所做的所有赋值都会改变您的变量所指的内容！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T02:03:03.797

您正在更改 try_change_foo_value 方法中的容器“self”。请记住，self 是作为参数传入的，这意味着您可以更改变量 self 内部的引用；但您不能更改调用者传递给您的引用。想想Java。

```
public void changeIt(Foo foo) {
    foo = new Foo(2);
} 
```

如果我打电话

```
Foo bar = new Foo(1);
.changeIt(bar); 
```

我可以期待 bar 仍然是“新的 Foo(1)”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-10T02:08:05.470

In `try_change_foo_value`,`self`以实例开始，但您在分配时更改它。您可以通过打印`id`of来检查这一点`self`。

```
class Foo:
    def __init__(self, fakevalue):
        self.fv = fakevalue

    @staticmethod
    def make_a_foo():
        return Foo(2)

    def try_change_foo_value(self):
        print 'Originally, id(self) = %s' % id(self)
        self = Foo.make_a_foo()
        print 'After assignment, id(self) = %s' % id(self)
        print "in change function, self.fv:", self.fv

if __name__ =='__main__':
    foo_instance = Foo(1)
    print "foo_instance.fv:", foo_instance.fv
    foo_instance.try_change_foo_value()
    print "foo_instance.fv:", foo_instance.fv 
```

注意`id`s。

```
foo_instance.fv: 1
Originally, id(self) = 4299779608
After assignment, id(self) = 4299779680
in change function, self.fv: 2
foo_instance.fv: 1 
```

# c# - COLLECTION 固定大小的 WCF 实体框架

> ID：12810918
> 
> 赞同：1
> 
> 时间：2012-10-10T01:59:35.463
> 
> 标签：c#, .net, wcf, entity-framework, poco

我有以下问题，我的 WCF 服务非常简单，从实体框架上下文发送一些实体，我禁用了代理生成和延迟加载，但是当我有一个添加引用实体的实体时会发生我是一个例外，它告诉我该集合具有固定大小。我想问题一定是在序列化/反序列化实体时出现在 WCF 中，但我想不出如何解决这个问题。

例子：

一个办公产品有产品和办公室，我得到了可用服务办公室的列表（从实体框架），然后我创建了一个产品，但是在分配一个办公室时或者：

```
NewProduct.Oficinas.Add(varOficina); 
```

引发异常，它告诉我集合具有固定大小，但不是由实体的集合“Office”产品、由成员 Office 和“产品”产生的实体产生的，问题出在来自WCF 服务，所以我想问题出在了那里。希望有人有答案，因为它给我带来了很多头痛

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T02:07:30.550

您可以在构造函数中创建一个传递服务结果的新集合。

例子：

```
IList<Oficina> oficinas = new List<Oficina>(ServiceResultCollection); 
```

这将解决问题。

# facebook-graph-api - Facebook 图形 api 使用“where”转换为 Fql

> ID：12810920
> 
> 赞同：1
> 
> 时间：2012-10-10T02:00:00.753
> 
> 标签：facebook-graph-api, facebook-fql

我有这个 api 请求。将页面中的问题与投票用户的姓名分组；用户 ID .... 等

```
367298846687999?fields=questions.fields(id,created_time,question,options.fields(name,votes.fields(id,username),vote_count,from)) 
```

但它会返回页面上的所有问题。

我需要通过选择创建日期来获取问题。喜欢 `Month(created_time) = 4`和`year(created_time) = 2012`

似乎我需要 fql，但没有任何关于按页面 id 从页面获取问题的方法。

我们可以转换我输入的 api 代码`fql`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:13:51.317

这是 FQL

SELECT id,owner,question,created_time FROM question WHERE owner=367298846687999

要将问题仅限于 2012 年 4 月提出的问题，您需要添加`AND created_time >= 2012-04-01 AND created_time <= 2012-04-30`到查询中。

要获得选项和投票，您需要构建一个多重查询，将第一个查询的结果传递给后续查询以从`question_option`表中获取信息，然后将这些结果传递给`question_option_votes`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-21T23:26:15.443

是的，您可以按 fql 中的 created_time 排序，但 fb db 中的 created_time 不能按年和月分开。Fb 以时间戳格式将年、月、日和时间组合在一起。因此，您需要将您的正常日期时间转换为时间戳格式，然后我将使用 fql 解决您的问题。

# jquery - 能够在 KoGrid 中显示列表

> ID：12810922
> 
> 赞同：1
> 
> 时间：2012-10-10T02:00:10.287
> 
> 标签：jquery, knockout.js, templating, kogrid

我正在使用 KoGrid 并将其与一些 DataArray 绑定。它可以很好地显示所有平面数据，但同时一个对象成员是一个数组，我想将网格中的所有数组成员显示为一个列表（作为一堆

*   s)。不幸的是，KoGrid 未能显示任何不是一对一映射的数据。

    例如，如果我有 userData= {Name:"",Email:"",Addresses:["",""]} 我正在使用 foreach 模板在网格中显示地址。我可以去 firebug 看看模板已经生成了多个地址并将其提供给 Kogrid。但是 KoGrid 没有显示出来。

    我可以（在萤火虫中）更改它的 koRow 类的 line-height 属性并显示所有数据。我还尝试通过在本地 css 上定义该属性来覆盖该属性，但 KoGrid 总是忽略它。

    无论如何，如果可能的话，我不想玩 CSS 属性。相反，我想知道 KoGrid 是否支持任何机制，在这种情况下我可以显示多个地址或一般的数组成员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:31:55.617

您的小提琴正在使用 koGrid 的主分支版本，该版本不稳定/有问题，尚未发布。我发现最新版本（1.1）非常好。使用它，您的第一个小提琴（没有单元格模板）已经将数组显示为列表。这是更新的小提琴：http: [//jsfiddle.net/sf4p3/74/](http://jsfiddle.net/sf4p3/74/)

关于你的第二小提琴..正如你所说，这只是一个 CSS 问题。您是单元格模板的作者，因此您有责任确保 CSS 正确。这是一个简单的示例，说明如何使用您的第二个小提琴（`display:inline`在列表项上）：http: [//jsfiddle.net/sf4p3/75/](http://jsfiddle.net/sf4p3/75/)

# c++ - C ++中的“免费”数组元素

> ID：12810928
> 
> 赞同：1
> 
> 时间：2012-10-10T02:01:02.530
> 
> 标签：c++, arrays, free, shift

我有一个对象数组

```
Timed_packet* send_queue = new Timed_packet[num_sequence_numbers]; // size=10 
```

这将在某一时刻充满 Timed_pa​​ckets，是否有删除或释放其中的元素，然后将数组向左移动以替换已释放的元素？

例子

```
send_queue = [ packet 9, packet 8, packet 7, packet 6, packet 5, packet 4, packet 3, packet 2, packet 1, packet 0] 
```

我想删除数据包 5 及其左侧的所有内容，使 send_queue 看起来像

```
send_queue = [ packet 4, packet 3, packet 2, packet 1, empty, empty, empty, empty, empty, empty] 
```

有什么方法可以实现吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:03:19.850

是的，您可以手动编写一个循环将所有内容向左移动，并用“空”值填充剩余的元素（也许是`nullptr`，或者`NULL`如果您不使用 C++11）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T02:06:41.633

好吧，实现这一点的一种方法是按字面意思实现它：通过将“数据包 4”复制到数组的开头，将“数据包 3”复制到下一个元素等来移动数组中的数据。在您的情况下，使用代表“空”的任何元素值填充数组中未使用的其余部分。

请记住，C++ 没有内置的数组“空”元素的概念。您要么必须通过创建`Timed_packet`代表“空”数据包的对象的某些保留状态来手动实现它。或者，或者，您可以简单地记住您的数组现在只包含 4 个元素，其余的被假定为“空”，无论状态如何。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T02:21:09.437

您无法通过删除或释放元素来实现这一点，因为您已将数组分配为单个内存区域。该地区只能作为一个整体释放，而不是部分释放。

正如其他人所提到的，您可以使用各种技术来“虚拟化”数组并使其看起来像元素来来去去：

```
packet *queue = new packet[queue_capacity];
packet *begin = queue, *end = queue+queue_capacity, *first = queue, *last = queue;

// add an element to the queue
packet p(...);
*last++ = *p; // note postincrement
if (last == end) last = begin; // the queue is cyclic
if (last == first) throw new queue_overflow(); // ran out of room in the queue!

// remove an element from the queue
if (first==last) throw new queue_underflow(); // ran out of items in the queue!
packet p = *first++; // taken by copy; note postincrement
if (first == end) first = begin; // the queue is still cyclic 
```

这段代码不在我的脑海中。您可能需要修复几个边界条件，但理论就在那里。

如果您使用 std::deque，这基本上就是您将得到的，除了后者提供：

*   表现
*   可移植性
*   类型安全
*   边界安全
*   符合标准

*编辑：*您可以做的一件事是分配一个指针数组（packet* *），而不是一个值数组（packet*）。那么您的入队/出队操作是指向数据包的指针的副本，而不是数据包的副本。您需要确保数据包由出队者释放，而不是由入队者释放，但这应该快光年（原文如此）。

# java - 将 netbeans 标签文本设置为静态字符串时，UI 设计器不显示它

> ID：12810936
> 
> 赞同：0
> 
> 时间：2012-10-10T02:02:00.583
> 
> 标签：java, string, netbeans, label

我正在尝试将标签文本的内容设置为静态字符串，但是当我这样做时 UI 设计器不会显示它。

1.  以编辑模式打开文件。
2.  创建公共最终静态字符串 SOME_VALUE = “我的标签”；
3.  切换到设计模式
4.  检查组件的属性，然后单击 labelText 属性。
5.  更改为自定义代码，然后输入变量 (SOME_VALUE)

代码运行正常，但是当您在设计模式下查看它时，它显示为“标签文本”而不​​是我的静态字符串。这使得在查看长字符串时设计存在问题，因为尺寸不合适。

有没有人找到一种方法来完成这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T08:17:23.813

前段时间我解决了这个问题之王，netbeans 中无法将编程编码的字符串直接读取给 UI 设计器。但是有一个解决方法！

1.  创建一个属性文件
    1.1 右键单击​​ package->New->Other->Other->Properties File
    1.2 在此处插入您的键值对

2.  在 UI 设计器中，选择标签
    2.1 Properties->text->Resource Bundle
    2.2 选择适当的字段
    2.3 你完成了！

3.  将捆绑包值分配给静态字符串
    public static String myString = java.util.ResourceBundle.getBundle("PATH-To-Bundle-file").getString("NAME-OF-THE-KEY");

祝你好运 ：）

# jquery - jQuery Ajax 请求 - 似乎没有发出请求

> ID：12810937
> 
> 赞同：0
> 
> 时间：2012-10-10T02:02:07.383
> 
> 标签：jquery, ajax, jquery-mobile

我有一小段代码，它基本上发出请求，并将结果抛出`console.log`（我省略了我的密钥和签名）。

问题是它似乎从来没有提出请求。

感谢您的帮助，我是新手，我还在学习中。

```
//alert('you clicked on the discgolf button');
$('#zipsubmit').click(function(){
    dgZipSearch();     // call this function perform DGCR search and 
                          populate the page with results
});

function dgZipSearch(){

    alert('foo1');

    $.ajax({
        url:'http://www.dgcr-api.com/?key=xxxxx&mode=findzip&zip=' + $('#zipcode').val() + '&rad=10&sig=yyyyyyy',
        dataType: 'jsonp',
        success: function(zip_results){
            console.log(zip_results);
        }
    });
    alert('foo2');
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T08:20:51.053

根据[文档](http://www.dgcoursereview.com/api_docs.php)，API 仅以 JSON 格式响应，除非您明确指定`out`参数为`XML`.

因此不需要`dataType`为ajax请求指定属性，jQuery会根据响应的MIME类型智能猜测正确的数据类型。

更改请求，例如

```
$.ajax({
    url:'http://www.dgcr-api.com/?key=xxxxx&mode=findzip&zip=' + $('#zipcode').val() + '&rad=10&sig=yyyyyyy',
    success: function(zip_results){
        console.log(zip_results);
    }
}); 
```

并尝试。

对于错误检查，您需要实现错误回调函数。此外，API 提供了特定的[响应代码](http://www.dgcoursereview.com/api_docs.php#rcode)以方便错误处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T05:01:51.063

您也可以尝试删除 url 中的“/”。更改后的 url 可能如下所示

```
http://www.dgcr-api.com?key=xxxxx&mode=findzip&..... 
```

试试上面的网址（观察我在 www.dgcr-api.com 之后删除的“/”）

还有一件事是，ajax 调用有跨域调用等限制。所以请检查下面链接中的“crossDomain”属性。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# matlab - MATLAB 中图像变换的矩阵乘法与方程

> ID：12810938
> 
> 赞同：2
> 
> 时间：2012-10-10T02:02:14.887
> 
> 标签：matlab, image-processing

我正在尝试编写一些代码来在[MATLAB](http://en.wikipedia.org/wiki/MATLAB)中旋转图像，即相当于[imrotate](http://www.mathworks.se/help/images/ref/imrotate.html)。我使用矩阵乘法来执行新图像到输入图像的逆映射。但是，这比明确写出等效方程要花费更长的时间。有没有更好的方法来执行这个乘法？

我更喜欢使用矩阵乘法，因为我可以通过替换转换矩阵将相同的代码用于其他转换，`RT`.

```
im1 = imread('file.jpg');
[h, w, p] = size(im1);
theta = -pi/6;
hh = round( h*cos(theta) + w*abs(sin(theta)));
ww = round( w*cos(theta) + h*abs(sin(theta)));

R = [cos(theta) -sin(theta); sin(theta) cos(theta)];
T = [w/2; h/2];
RT = [inv(R) T; 0 0 1];
for z = 1:p
    for x = 1:ww
        for y = 1:hh
            % Using matrix multiplication
            i = zeros(3,1);
            i = RT*[x-ww/2; y-hh/2; 1];

            %Using explicit equations
            %i(1) = ( (x-ww/2)*cos(theta)+(y-hh/2)*sin(theta)+w/2);
            %i(2) = (-(x-ww/2)*sin(theta)+(y-hh/2)*cos(theta)+h/2);

            %% Nearest Neighbour
            i = round(i);
            if i(1)>0 && i(2)>0 && i(1)<=w && i(2)<=h
                im2(y,x,z) = im1(i(2),i(1),z);
            end
        end
    end
end

%Revised code
im1 = imread('file.jpg');
[h, w, p] = size(im1);
theta = (pi)/3;
hh = round(h*abs(cos(theta)) + w*abs(sin(theta)));
ww = round(w*abs(cos(theta)) + h*abs(sin(theta)));
im2 = zeros([hh,ww,p], class(im1));

R = [cos(theta) -sin(theta); sin(theta) cos(theta)];
T = [w/2; h/2];
RT = [inv(R) T; 0 0 1];

x=1:ww;
y=1:hh;

[X, Y] = meshgrid(x,y);
orig_pos = [X(:)' ; Y(:)' ; ones(1,numel(X))];
orig_pos_2 = [X(:)'-(ww/2) ; Y(:)'-(hh/2) ; ones(1,numel(X))];

new_pos = round(RT*orig_pos_2); % Round to nearest neighbour

% Check if new positions fall from map:
valid_pos = new_pos(1,:)>=1 & new_pos(1,:)<=w & new_pos(2,:)>=1 & new_pos(2,:)<=h;

orig_pos = orig_pos(:,valid_pos);
new_pos = new_pos(:,valid_pos);

siz = size(im1);
siz2 = size(im2);

% Expand the 2D indices to include the third dimension.
ind_orig_pos = sub2ind(siz2,orig_pos(2*ones(p,1),:),orig_pos(ones(p,1),:), (1:p)'*ones(1,length(orig_pos)));
ind_new_pos  = sub2ind(siz, new_pos(2*ones(p,1),:), new_pos(ones(p,1),:), (1:p)'*ones(1,length(new_pos)));

im2(ind_orig_pos) = im1(ind_new_pos);
imshow(im2); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T08:21:48.717

您应该对 for 循环进行矢量化，这似乎并不难。它会让你收获很多。最棘手的是位置计算并忽略旋转后从图像上掉下来的位置。

解决方案：

```
x=1:ww
y=1:hh

[X, Y] = meshgrid(x,y);
orig_pos = [X(:)' ; Y(:)' ; ones(1,numel(X))];

new_pos = round(RT*orig_pos); % round to nearest neighbour

% check if new positions fall from map:
valid_pos = new_pos(1,:)>=1 & new_pos(1,:)<=w & new_pos(2,:)>=1 & new_pos(2,:)<=h; 
```

您可以在 for 循环中对结果矩阵进行分配以处理要忽略的位置，或者只是将它们从源矩阵中删除并一次性完成分配：

```
orig_pos = orig_pos(:,valid_pos);
new_pos = new_pos(:,valid_pos);

siz = size(im1);
im2 = zeros(siz,class(im1));

% expand the 2d indices to include the third dimension
ind_orig_pos = sub2ind(siz,orig_pos(2*ones(siz(3),1),:),orig_pos(ones(siz(3),1),:), (1:siz(3))'*ones(1,N));
ind_new_pos  = sub2ind(siz, new_pos(2*ones(siz(3),1),:), new_pos(ones(siz(3),1),:), (1:siz(3))'*ones(1,N));

im2(ind_orig_pos) = im1(ind_new_pos); 
```

您的代码可能也很慢，因为您没有初始化`im2`，因此它会根据需要在运行时进行扩展。

作为参考：使用“peppers.png”作为源图像，整个代码块在我的电脑上花费了 0.12 秒，您的代码花费了几分钟......最终结果是一样的。

# django - django.db.models get_models 在 django1.4 中返回空列表

> ID：12810939
> 
> 赞同：2
> 
> 时间：2012-10-10T02:02:34.510
> 
> 标签：django, menuitem, django-admin-tools

我的代码曾经在 Django 1.3 中工作，但在更新到 Django 1.4 之后它不再工作了。这个想法是为 django-admin-tools 构建一个 MenuItem，其中包含来自应用程序的模型列表。

```
from admin_tools.utils import AppListElementMixin
from app import models as my_models

class CustomMenu(Menu):
    def init_with_context(self, context):

        app_list=AppListElementMixin()

        '''ERROR not working after upgrade to django 1.4, returns empty list'''
        all_models = get_models(app_mod=my_models)
        ''''''

        dict_models = {}
        for model in all_models:
            dict_models[model.__name__] = items.MenuItem(
                                            title=model._meta.verbose_name_plural,
                                            url=app_list._get_admin_change_url(model, context)
                                            ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T11:13:46.300

尝试将您的“应用程序”添加到 settings.py INSTALLED_APPS 然后执行此操作

```
from django.db.models import get_models, get_app 
```

和这个

```
all_models = get_models(app_mod=get_app('app')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T07:41:17.400

如果您的目标是为每个模型添加一个菜单项，您可以尝试：

```
from django.core.urlresolvers import reverse
from django.utils.translation import ugettext_lazy as _

from admin_tools.menu import items, Menu

class CustomMenu(Menu):
    def __init__(self, **kwargs):
        Menu.__init__(self, **kwargs)
        self.children += [
            # Other items that are in the menu eg "items.Bookmarks()," go here
            items.AppList(
                _('Name of the submenu'), # Your own choosing
                models=('app.models.*',) # Assuming your django app is called "app"
            )
        ]

    def init_with_context(self, context):
        return super(CustomMenu, self).init_with_context(context) 
```

这就是我在我的一个项目中所做的工作。

# jquery - 如何更改 jquery 中新添加行的行背景颜色

> ID：12810949
> 
> 赞同：3
> 
> 时间：2012-10-10T02:03:22.403
> 
> 标签：jquery, html, ajax

提交我的 Ajax 表单后，我正在使用此代码将新行动态添加到表中

```
var $var = $('table');
var newRow = "<tr><td> blah </td></tr>" 
```

`$var.find('tr:last-child').before(newRow)`

现在我希望该行的背景颜色为浅黄色，仅持续 3 秒，然后恢复正常

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T02:12:24.077

您可以尝试使用`setTimeout`功能：

```
var $newRow = $("<tr class='light'><td>blah<td></tr>");
$var.find('tr:last-child').before($newRow);
setTimeout(function(){
    $('#table tr.light').removeClass('light')
}, 3000) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T02:27:26.257

# *[jsBin 演示](http://jsbin.com/upidog/1/edit)*

一个好主意是（**没有 jQuery UI**来为 BG 颜色设置动画）：

*   `td`通过 CSS 默认为所有元素设置自定义颜色
*   `tr`默认 CSS为所有元素设置黄色
*   jQuery - 插入`tr`带有**隐藏** `td`元素的新元素
*   **淡入`td`**元素！

**css**

```
table tr{
  display:block;
  background:yellow;
}
table td{
  display:block;
  background:#eee;
} 
```

**jQuery**

```
var $var = $('table');

$('button').click(function(){

   var newRow = $("<tr><td> NEW ROW! </td></tr>");
   $var.find('tr:last-child').before(newRow);
   newRow.find('td').hide().fadeTo(3000,1);

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T02:12:07.837

添加一个`new`具有该样式的类，然后使用`delay`and`queue`等待 3 秒，然后`new`使用. 删除`removeClass`。

**JS**

```
var $newRow = "<tr class='new'><td> blah<td></tr>";
$var.find('tr:last-child').before($newRow)
    .delay(3000).queue(function(){
        $('.new').removeClass('new');
    }); 
```

**CSS**

```
.new {
    background-color: yellow;
} 
```

[**演示**](http://jsfiddle.net/xqgcP/1/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T02:54:05.350

正如您所说，您使用的是 jQueryUI，您可以使用内置的“突出显示”效果，您可以在此处查看它的演示[http://jqueryui.com/effect/](http://jqueryui.com/effect/)

# javascript - Backbone.js：区分仍在加载的集合和空集合？

> ID：12810951
> 
> 赞同：1
> 
> 时间：2012-10-10T02:03:26.740
> 
> 标签：javascript, backbone.js

使用 Backbone.js，我有一个我实例化的集合，`X`. 实例化后，我立即调用`X.fetch()`，以便尽快从服务器加载数据。然后我传入`X`将在集合上运行的各种视图。

这些视图的最佳方法是区分集合何时加载（因此为空）和何时加载但实际上是空的？我希望我的视图显示适当的“正在加载...”文本，直到集合对服务器执行 ping 操作。在这一点上，我想让他们说“这里好像什么都没有。也许你应该添加一些东西。”

我在想也许在每个视图中收听`reset`集合中的事件，但这对我来说似乎相当脆弱。如果在视图附加其侦听器之前重置事件已经触发，会发生什么？是否有一种很好的模式来检查集合的状态以查明它是否已被提取？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-10T02:06:37.987

`fetch`方法是异步的，基于 AJAX 的异步特性。因此，您需要实现事件驱动的行为。

```
X.fetch({
    success: function(collection, response) {
        hidePreLoader();
        renderViews(collection); // collection argument is your X collection.
    }
}); 
```

**更新**

根据您对我的回答的评论，我可以提出另一个想法。即你可以设置

`X.isLoaded = true;`

或任何其他财产，如

`X.loadedAt = Date.now();`

在`success`回调中，因此其他代码可以检查此属性的状态。

但是，尽管我在这里看到了一种糟糕的设计。您可以使用显示的预加载器呈现您的视图，并在`success`回调中触发一些事件，您的视图将在该事件上开始与集合一起使用，因为它已加载并准备好使用。所以总的来说，我再次建议您使用事件驱动的行为。

我没有测试，但这是我的想法的代表：

```
var XCollection = Backbone.Collection.extend({

    // ...

    model: X,
    loadState: {},
    loadedAt: -1,
    initialize: function(options) {
        _.extend(this.loadState, Backbone.Events);
    },

    isLoaded: function() {
        return this.loadedAt > -1;
    }
});

var Subview = Backbone.View.extend({

    // ...

    initialize: function(options) {
        this.collection.loadState.on("loadComplete",
            this.onLoadComplete, this);
    },

    onLoadComplete: function(response) {
        this.hidePreloader();
        this.renderData();
    },

    /**
     * Checks is the collection loaded and view can render fetched models.
     * It's just an example.
     * You'll not need to use it if you're handling a loadComplete event.
     */
    isRenderingAllowed: function() {
        return this.collection.isLoaded();
    }
});

var XView = Subview.extend({

    // ...

    initialize: function(options) {
        Subview.prototype.initialize.apply(this, arguments);
    }
});

var YView = Subview.extend({

    // ...

    initialize: function(options) {
        Subview.prototype.initialize.apply(this, arguments);
    }
});

// ...

var x = new XCollection();

var xView = new XView({collection: x}),
    yView = new YView({collection: x});

x.fetch({
    success: function(collection, response) {
        collection.loadedAt = Date.now();
        collection.loadState.trigger("loadComplete", response);
    }
}); 
```

[文档](http://backbonejs.org/#Collection-fetch)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T10:10:38.397

确保在调用之前初始化视图`fetch()`。这样您就可以监听`reset`事件，并确保所有视图都已更新。如果您希望尽快加载 xlist，最好将其引导到您的 html 服务器端。

这样做的一种方法可能是：

```
<script src="/public/js/collecions/x-list.js">
<script src="/public/js/views/x-view.js">

    <script>
         var xlist = new App.Collections.XList();

        _.each($(".xdiv"), function(el){
             new App.Views.XView({
                 el: el,
                 collection: xlist
             });
             // make sure that XView have this in it's initialize method:
             // this.collection.bind("reset", this.render, this)
        }

        xlist.fetch();

        // or even better, use bootstraped data:

        x.list.reset((<%= @data.to_json %>)
    </script> 
```

# c# - 在VS2012中附加到一个win8进程

> ID：12810961
> 
> 赞同：0
> 
> 时间：2012-10-10T02:05:22.040
> 
> 标签：c#, windows-8, visual-studio-2012, attach-to-process

我正在开发一个 windows-8 应用程序。我以前是点击VS2012工具栏中的DEBUG按钮，开始调试应用程序。但是这种行为会导致重新安装应用程序（删除然后创建 \AppData\Local\Packages 中的相应文件夹），这不是我想要的，因为本地文件夹中的假数据已被删除。我尝试`Attach to a process`在 VS 中使用函数，但找不到正确的进程（例如调试 Web 应用程序时的 w3wp.exe）。这种调试方法可行吗？或者在不删除本地文件夹中的假数据的情况下进行调试的更好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:51:46.527

如果您的 Metro 应用程序已启动，您应该能够附加到它。我刚刚在 Release Preview 上尝试过，它按预期工作。但是，您的数据不应放在 \Packages 文件夹中，而应放在 \AppData\Roaming 或 Local 中自己的文件夹中。如果您想使用真正的假数据进行测试，另一种方法是您可以将数据文件包含在项目中，或者作为 Resources.resx 中的资源，或者作为项目中复制到输出目录的文件。

# java - 如何执行随机算法

> ID：12810962
> 
> 赞同：3
> 
> 时间：2012-10-10T02:05:30.370
> 
> 标签：java, language-agnostic, random, computation-theory

对于我正在从事的项目，我希望能够生成和执行随机算法（相信我，这是有充分理由的！）根据 Alan Turings 的原始论文，每个 TM 都可以分配一个唯一的编号（更多现代理解这一点的方式是，每个程序都编译成一些唯一的二进制大长数字）。

假设我有这么长的号码。我现在如何执行这对应的程序？

语言在这里并不重要，如果它包含使这更容易的机制，我很乐意选择某种语言而不是另一种语言。如果无论您选择哪种语言都很难，那么我最精通Java。

如果您建议另一种生成随机算法的方法也可以，但请记住，我最终会更改逻辑以使用一些启发式方法而不是纯随机性来选择算法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T02:26:14.963

*“每个 TM 都可以分配一个数字”*和*“每个数字都代表一个有效的、有意义的 TM”*之间存在巨大差异。考虑包含一个简单程序的编译目标代码的二进制字符串，比如 2000 字节长。这是一个 8000 位数，其中大约有 10 个^(2400)值。在几乎无限数量的值中，只有很小的一部分代表有效的可执行程序。随机生成一个生成任何可执行文件的机会几乎无限接近于零。

现在重复这个练习，比如说 6000 字节的程序。问题不是 3 倍难，而是大约 10 ^(12000)倍。等等...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T02:11:01.773

这本质上是操作系统在您运行程序时所做的事情。它基本上将“二进制大长数”加载到内存中，然后从指令 0 开始执行程序。

[http://en.wikipedia.org/wiki/Loader_（计算）](http://en.wikipedia.org/wiki/Loader_%28computing%29)

所以要执行你的随机算法，你可以在一个文件中生成随机数据，然后 exec() 该文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-10T02:24:09.967

您需要做的是找出一种方法——任何方法——在给定整数的情况下生成程序。执行此操作的“标准”方法是选择一种任意编程语言，比如 Java，并想象每个可能的字符串对应于合法的、可编译的 Java 程序的文本，然后想象这些字符串按字母顺序排序。这是所有 Java 程序上定义明确的顺序，因此如果您只有这种顺序，您可以将列表中的任何数字转换为程序，只需在给定索引处获取程序即可。

不幸的是，这对算法来说不太实用。您必须枚举大量字符串才能到达列表中的*第一个*元素，更不用说元素 2134345423532243 或其他任何内容。每个程序都是一个字符串，但*绝大多数*字符串不是合法程序。将程序解释为巨大的二进制数时也存在同样的问题：每个程序都是一个数字，但几乎没有数字是程序。

因此，如果您真的对生成真正的程序感兴趣，而不是将所有时间都花在生成根本不是合法程序的虚假程序上，那么您需要更聪明地做一些事情。您可以这样做的一种方法是将您的数字作为随机数生成器的种子，然后根据对 RNG 的连续调用随机生成一条带有随机寄存器的汇编指令。

# javascript - 用asp方式制作一个togle_visibility(Javascript)

> ID：12810965
> 
> 赞同：0
> 
> 时间：2012-10-10T02:06:08.530
> 
> 标签：javascript, asp.net, blackberry

**我使用 BB 5（尚不支持 Javascript）** 我创建了一个具有`toogle_visibility()`功能（Javascript）的网络手机。现在的问题是，黑莓浏览器似乎无法“读取”Javascript 代码。有没有办法以`toogle_visibility()`asp方式制作（Javascript）？（如果可能的话，包括自上而下的动画，换句话说**，尽可能相似**）
我`ASP/C#`在我的网络手机上使用语言。感谢：D

**编辑**（只是为了让我的问题更清楚）：**如何在`toogle_visibility()`不使用 Javascript 的情况下创建一个？**:D

**这是我在常规浏览器（非 BB 浏览器）中工作的 Javascript 代码**

```
<script src="http://code.jquery.com/jquery-latest.js"></script>

<script type="text/javascript">
    function toggle_visibility(id) 
    {
        var e = document.getElementById(id);
        if($("#"+id).is(":hidden"))
          $("#"+id).slideDown();
        else
             $("#"+id).slideUp();
    }
</script> 
```

# python - 如何使用 For 循环找到 N 面容？

> ID：12810966
> 
> 赞同：1
> 
> 时间：2012-10-10T02:06:10.473
> 
> 标签：python

> **可能重复：**
> [Python 中的阶乘函数](https://stackoverflow.com/questions/5136447/function-for-factorial-in-python)

我需要在 python 中编写一个返回 N! 的程序，而不使用阶乘函数。到目前为止，我已经编写了一个程序，但我一直收到错误消息，`local variable "fact" is assigned but never used`. `fact = 1`分配后如何使用？

```
from pylab import *  

def factorial(n):
    fact = 1

for i in range(n):
    print("i = ", i)
    fact = fact * i

print("The factorial of " + str(n) + " is: " + str(fact)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-10T02:10:24.593

```
In [37]: def fact(n):
    fac=1
    for i in range(2,n+1):
        fac *=i
    return fac
   ....: 

In [43]: fact(5)
Out[43]: 120

In [44]: fact(6)
Out[44]: 720 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T02:16:34.887

我对python知之甚少，但你应该在这些例子中使用递归。这很简单。递归是一个调用自身的函数

```
def factorial(n):
    if n== 0 or n == 1:
        return 1
    else:
        return n * factorial(n-1) 
```

# c++ - 有关将 c++ lambda 转换为 ac 函数的更多信息

> ID：12810968
> 
> 赞同：0
> 
> 时间：2012-10-10T02:06:17.610
> 
> 标签：c++, templates, c++11, function-pointers, word-wrap

**更新 2**

好的，解决了第二个问题。如前所述，在尝试`ReturnType(Args...)`匹配`ReturnType (*)(Args..)`. 明显的解决方法是：

```
template <typename F, F *fn>
void doSomething() {
    function_helper<F>::template toNative<fn>();
} 
```

它现在在 clang++ 下编译。

**更新**

正如所指出的，我之前的代码有问题，我试图将函数参数传递给模板参数。然而，这被解析错误的奇怪错误所掩盖。错误地传递函数参数不应该导致我看到的错误。

事实证明，问题在于调用类的模板化成员函数的新语法（请参阅[http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=/com.ibm.xlcpp8a .doc/language/ref/keyword_template_qualifier.htm](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=/com.ibm.xlcpp8a.doc/language/ref/keyword_template_qualifier.htm)）。

正确的语法应该是：

```
template <typename F, F *fn>
void doSomething() {
  native_function native = function_helper<decltype(fn)>::template toNative<fn>();
} 
```

其中必须在'::'和函数之间插入*模板。*

不幸的是，这是一个非常困难的问题搜索：（a）编译器错误完全没有帮助，并且（b）没有明显的搜索词可以使用。

此外，目前这似乎不适用于当前版本的 clang++，也不适用于 g++ 4.6（到目前为止，我得到另一个语法错误或内部编译器错误）。

**原始问题**

[在我之前的问题](https://stackoverflow.com/questions/12545537/converting-a-c-lambda-to-a-c-function)的后续行动中，我有以下代码：

```
template <typename T>
struct function_helper {};

template <typename ReturnType, typename... Args>
struct function_helper<ReturnType(Args...)> {

    // wraps actual function in a native-c function (allow it to be called
    // via an external scripting language API) 
    template <ReturnType (*fn)(Args...)>
    static native_function toNative() {
         return [](State *state) -> int {
            Context ctx(state);
            return apply_helper<sizeof...(Args)>::apply(ctx, fn);
        };
    }
}; 
```

我想用它来包装：

```
template <typename ReturnType, typename... Args>
native_function function_(Context &ctx, const std::string &name, ReturnType (*fn)(Args...)) {
    ctx.registerFn(name, function_helper<decltype(fn)>::toNative<fn>());
} 
```

但是，这给了我一个“解析错误”。如果我不尝试将它包装在一个函数中，而是这样做：

```
int main(int argc, char **argv) {
    // ...
    ctx.registerFn("myFunc", function_helper<decltype(myFunc)>::toNative<myFunc>());
} 
```

一切都编译并正确运行。同样，如果我使用宏，它也可以工作。但是，出于设计原因，我更愿意使用函数。

我还尝试了一种稍微不同的配方，结果相同：

```
template <typename T>
struct function_args {};

template <typename ReturnType, typename... Args>
struct function_args<ReturnType (*)(Args...)> {
    const int size = sizeof...(Args);
};

template <typename F, F *fn>
native_function wrap() {
    return [](State *state) -> int {
        Context ctx(state);
        return apply_helper<function_args<decltype(fn)>::size>::apply(ctx, fn);
    };
} 
```

我做错了什么，还是编译器问题？解析错误让我怀疑是编译器有问题。

我可以通过向 toNative() 添加参数来消除解析错误。但是，这只是导致了一个不同的错误，即没有这样的方法 toNative(int)。

我正在使用 xcode 附带的最新 clang++（基于 LLVM 3.1svn）。

# c - 我将如何迁移到 C 中的新进程？

> ID：12810971
> 
> 赞同：1
> 
> 时间：2012-10-10T02:06:46.183
> 
> 标签：c, winapi, process

这是一个相当复杂的过程，所以请多多包涵！无论如何，这个概念是直截了当的：

我有一个 C 程序，它根据用户输入生成一个批处理文件并执行它。在所有情况下，批处理文件都会打开一个新终端。我希望我的程序通过新终端执行设置命令。

我 99% 肯定我需要为此使用 Win32 API，并且完全可以接受这个挑战，但我只是想朝着正确的方向稍微推动一下。

关于如何设计这样一个程序的任何建议？

非常感谢您的宝贵时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T09:55:43.150

当您使用`CreateProcess()`启动批处理脚本时，您可以指定`CreatePipe()`为标准输入和标准输出创建的自定义管道。这将允许您的应用程序通过管道发送任何命令来控制应用程序。

如果你只指定标准输入管道，那么输出仍然会被发送到它自己的控制台窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T03:20:15.967

最简单的方法是将SendMessage(WM_CHAR) 发送到新的控制台窗口，但这不是错误证明。

正确的方法是使用 STARTF_USESTDHANDLES 标志 CreateProcess()。[在此处](http://www.codeproject.com/Articles/5531/Redirecting-an-arbitrary-Console-s-Input-Output)查看示例

# r - 网络度

> ID：12810972
> 
> 赞同：1
> 
> 时间：2012-10-10T02:07:05.470
> 
> 标签：r, graph-theory, igraph

我已经开始在 R 中使用网络。我知道 R 中有一个名为的包，`igraph`它具有许多用于网络分析和可视化的功能。我想计算一个小型网络的度数。例如

```
mydegree=c(2,3,5)
g=degree.sequence.game(mydegree) 
```

现在要获得每个节点的度数，我可以简单地使用命令`degree`in`igraph`并说`degree(g)`. 但是如果我不想使用这个 degree 命令，我可以用什么公式来计算学位？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T14:37:38.850

你真的不想使用任何 igraph 函数吗？我假设您至少想使用 igraph 加载或生成图形，否则这个问题没有多大意义。

因此，如果您想将生成的图形转换为不需要 igraph 处理的东西，那么您基本上有三个选择。

`get.adjlist()`，正如您在另一个答案中看到的那样，将为您提供一个邻接列表，然后程度由列表中每个向量的长度给出：

```
g <- degree.sequence.game(rep(2,10))
al.g <- get.adjlist(g)
sapply(al.g, length)
# [1] 2 2 2 2 2 2 2 2 2 2 
```

`get.adjacency()`会给你一个邻接矩阵，然后可以通过简单地将行（或列，如果你有一个有向图）相加来计算度数：

```
adj.g <- get.adjacency(g)
rowSums(adj.g)
# [1] 2 2 2 2 2 2 2 2 2 2 
```

`get.edgelist()`在两列矩阵中返回一个简单的边列表。您需要计算每个顶点在此矩阵中出现的次数以获得它们的度数：

```
el.g <- get.edgelist(g)
table(el.g)
# el.g
#  1  2  3  4  5  6  7  8  9 10 
#  2  2  2  2  2  2  2  2  2  2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T12:54:59.053

如果您阅读 igraph 文档，您会发现有很多方法可以做到这一点。这是一个。获取邻接列表，计算每个元素的长度：

```
mydegree=c(2,3,5)
g=degree.sequence.game(mydegree)
unlist(lapply(get.adjlist(g),length))
[1] 2 3 5 
```

还有一个：

```
> mydegree = c(3,5,2,2,4,2,5,6,7)
> g=degree.sequence.game(mydegree)
> unlist(lapply(get.adjlist(g),length))
[1] 3 5 2 2 4 2 5 6 7 
```

还有一个：

```
> degree(graph.famous("Zachary"))
 [1] 16  9 10  6  3  4  4  4  5  2  3  1  2  5  2  2  2  2  2  3  2  2  2  5  3
[26]  3  2  4  3  4  4  6 12 17
> unlist(lapply(get.adjlist(graph.famous("Zachary")),length))
 [1] 16  9 10  6  3  4  4  4  5  2  3  1  2  5  2  2  2  2  2  3  2  2  2  5  3
[26]  3  2  4  3  4  4  6 12 17 
```

# c# - 如何从后台堆栈中删除导航项

> ID：12810973
> 
> 赞同：1
> 
> 时间：2012-10-10T02:07:08.623
> 
> 标签：c#, windows-phone-7

我想让用户能够将 ConnectionSettingsTask 项目固定到起始页面，然后通过按起始页面上的相应磁贴导航到该特定的 ConnectSettingsTask。我的问题是，一旦用户导航到相应的 ConnectionSettingsTask 页面，用户就无法使用硬件后退按钮直接导航回起始页面。出于某种原因，应用程序不断地反复加载相同的 ConnectionSettingsTask 页面。我现在的实现如下：

MainPage.xaml.cs

```
protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        base.OnNavigatedTo(e);

        string _title = null;
        NavigationContext.QueryString.TryGetValue("Param", out _title);

        if (_title != null)
        {
            ConnectionSettingsTask connectionSettingsTask = new ConnectionSettingsTask();                

            switch (_title)
            {
                case "WiFi":                        
                    connectionSettingsTask.ConnectionSettingsType = ConnectionSettingsType.WiFi;
                    connectionSettingsTask.Show();
                    break;
                 ...
            }

            try
            {                     
                //NavigationService.RemoveBackEntry();
                //_title = null;
                NavigationContext.QueryString.Remove(_title);
            }
            catch(InvalidOperationException ex)
            {
                MessageBox.Show(ex.Message);
            }
        }
    }

private void CreateLiveTile(TileItem item)
    {
        var title = item.Title.ToString();
        string tileParameter = "Param=" + item.Title.ToString();            

        ShellTile Tile = CheckIfTileExist(tileParameter);  // Check if Tile's title has been used             

        if (Tile == null)
        {
            //choose which original background tile image to use
            switch (title)
            {
                case "WiFi":                        
                        background = new Uri("/Images/Mode/Mode_WiFi.png", UriKind.Relative); 
                    break;
                ...
            }

            try
            {
                var LiveTile = new StandardTileData
                {
                    Title = item.TileName,
                    BackgroundImage = background,
                    BackTitle = item.TileName,
                    //BackBackgroundImage = new Uri("/background.png", UriKind.Relative),
                    BackContent = item.Message,
                };

                ShellTile.Create(new Uri("/View/MainPage.xaml?" + tileParameter, UriKind.Relative), LiveTile);  //pass the tile parameter as the QueryString                   
            }
            catch (Exception)
            {
                MessageBox.Show("This tile could not be pinned", "Warning", MessageBoxButton.OK);
            }
        }
        else
        {
            MessageBox.Show("This tile has already been pinned", "Notice", MessageBoxButton.OK);
        }
    }

private ShellTile CheckIfTileExist(string tileUri)
    {
        ShellTile shellTile = ShellTile.ActiveTiles.FirstOrDefault(tile => tile.NavigationUri.ToString().Contains(tileUri));
        return shellTile;
    } 
```

因此，基本上可以创建磁贴并将辅助磁贴固定到开始屏幕，以及从辅助磁贴加载 WiFI ConnectionSettingsTask。但是当我尝试从 ConnectionSettingsTask 页面导航回来时，它只会不断重新加载该页面。我如何根据 Windows Phone 硬件后退按钮认证要求解决此问题（在这种情况下必须返回到开始屏幕）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T07:08:41.593

任务会一遍又一遍地加载，因为每次您返回 taskpage 时，无论导航模式是新的还是返回，都调用 Navigationdto 函数，该函数调用 ConnectionSettingsTask。

确保您打开任务，当导航模式是新的，就像代码一样：

```
 base.OnNavigatedTo(e);
        if (e.NavigationMode == System.Windows.Navigation.NavigationMode.New)
        {
             // Open Task
         } 
```

.........................................我无法在您的评论之后添加我的评论：

如果你从连接设置任务返回主页面，你想返回起始页吗？

你可以知道最后一页是否是任务页。

```
 if (e.NavigationMode == System.Windows.Navigation.NavigationMode.New)
        {
             // Open Task
             _fromTask = true;
         }
        else if(e.NavigationMode==System.Windows.Navigation.NavigationMode.Back&&_fromTask)
    {
    // exit your app . 
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T04:41:47.947

我认为，当您按下后退按钮时，它会回到您的主页，回到最初导航的位置。在主页中，您有重定向逻辑，因此它再次转到您的 ConnectSettingsTask 页面

为什么不能为辅助磁贴设置 ConnectSettingsTask 页面 URL 以及磁贴参数。我认为它应该可以工作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-10T07:19:04.947

试试这个代码。通过一些修改，您可以将此代码用于您的场景。

```
 protected override void OnBackKeyPress(System.ComponentModel.CancelEventArgs e)

    { 

     while (NavigationService.BackStack.Count() >= 1)
                NavigationService.RemoveBackEntry();
     } 
```

# python - 没有枚举的 Pythonic 设计

> ID：12810974
> 
> 赞同：10
> 
> 时间：2012-10-10T02:07:12.687
> 
> 标签：python, enums

关于如何在 Python 中实现枚举存在一些问题。大多数解决方案最终或多或少等同于以下内容：

```
class Animal:
    DOG=1
    CAT=2 
```

其他人提出了更复杂的构造枚举的方法，但最终往往看起来像这个例子。

根据我在 Java 和 C# 方面的经验，我可以想到这种成语的各种用途。但是，它似乎不是很 Pythonic。事实上，似乎每次有人问为什么 Python 中没有枚举时，你往往会因为没有理由尝试在像 Python 这样的语言中强制执行编译时类型安全，而对预设的回答感到有点抱怨，或者需要枚举的设计在 Python 中是多么难闻。

我的问题不是如何在 Python 中实现枚举，而是一般来说人们如何以 Python 式的方式解决那些适合枚举的问题。换句话说，您将如何解决一个问题，该问题有助于拥有具有一组离散的可能值的数据类型，而无需将您的 Java/C# 解决方案移植到 Python。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-10T14:21:26.883

[PEP 435](http://www.python.org/dev/peps/pep-0435/)刚刚被接受，它将 enum 包与 Enum 类和其他派生类（如 IntEnum）一起添加到标准库中。这意味着从 Python 3.4 开始，在设计中使用枚举的“pythonic”方式就是使用这个包。它看起来像这样：

```
>>> from enum import Enum
>>> class Color(Enum):
...    red = 1
...    green = 2
...    blue = 3

>>> print(Color.red)
Color.red

>>> print(Color.red.name)
red

>>>> for color in Color:
....     print(color)
Color.red
Color.green
Color.blue 
```

这种设计的关键特征是键可以拒绝没有意义的比较（与其他答案中建议的字符串键不同），允许键具有与键值无关的漂亮打印，以及赋予键值特殊除了在用户尝试使用 Enum 类中的非法键时引发显式且可理解的错误之外，还可以通过在 Enum 子类上定义方法来获得属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-10T02:28:30.700

由于 Python 字符串是不可变的（并且 Python 会在必要时对它们进行实习），因此将数字枚举用于一组事物并没有真正的优势。相反，您可以简单地使用 a `frozenset`or `tuple`of 字符串（取决于您是否关心排序）。

另一方面，如果您关心的是命名空间，那么将事物属性设为类就可以了。

正如评论中提到的，如果您正在寻找状态机实现之类的东西，一流的功能是您的朋友。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T02:22:35.307

由于不是来自 C# 或 Java 背景，我仍然不太了解这种对枚举的兴趣。

据我了解，我可能会退回到 django 风格，将任何必要的常量放在设置文件中并在必要时导入。

settings.py/animals.py

```
DOG = 1
CAT = 2 
```

其他文件：

```
from animals import CAT, DOG 
```

* * *

甚至...

设置.py

```
ANIMALS = { "DOG": 1, "CAT": 2} 
```

其他文件：

```
from settings import ANIMALS

my_animal = "FROG"
if my_animal not in ANIMALS.keys():
    print "new species discovered!" 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-09-30T22:24:48.137

我不相信 C# 中的枚举。对于状态机，您有策略模式。而不是查看对象的状态并决定要做什么。将要做什么的逻辑封装在对象本身中。

这是 Python 中的一种自然方法，对我来说，引入枚举只是在鼓励糟糕的代码。

# php - PHP 中的递归与迭代

> ID：12810985
> 
> 赞同：25
> 
> 时间：2012-10-10T02:08:25.090
> 
> 标签：php, loops

迭代阶乘函数：

```
function factorial($number) {
    $result = 1;
    while ($number > 0) {
        $result *= $number;
        $number--;
    }
    return $result;
} 
```

递归阶乘函数：

```
function factorial($number) {
    if ($number < 2) {
        return 1;
    } else {
        return ($number * factorial($number-1));
    }
} 
```

我必须开发一个函数来计算我的 PHP 程序中的阶乘。我发现我可以通过以上两种方式做到这一点。

*   我不知道哪种方法更好用，为什么？
*   行业标准是什么？
*   如何在上述两种方法中选择一种？
*   确定哪个更好的条件是什么？

我知道这是很多问题，但由于我是 PHP 新手，希望有人能帮助我。

*鉴于此，实际上我使用的函数不仅仅是阶乘。它也有一些其他的行来完成一些其他的任务。为了简化起见，我们假设这是两个函数。所以任何人都可以理解我的问题，而不是无缘无故地把它复杂化。*

我基本上指的是 PHP 中的递归与迭代。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-10T02:22:16.167

PHP 是一个特例。使用迭代解决方案将使用更少的内存。此外，PHP 中的函数调用成本很高，因此最好尽可能避免函数调用。

PHP 将 seg fault（在我的系统上）试图找到 100,000 的阶乘，但迭代解决方案没有问题。不过，它们几乎都是即时执行的。

当然，小得多的阶乘是`INF`，但这也可以应用于增长慢得多的函数。

如果我们不是在谈论 PHP 或其他脚本语言，那么就没有标准。很高兴知道如何以两种方式做到这一点。我会选择最干净的代码。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-10T02:11:19.863

> 我不知道哪种方法更好用，为什么？

经验法则：如果您可以迭代地编写它，请使用它。这是因为函数调用和递归在 PHP 中会带来一些损失。此外，PHP 本身并没有递归保护，您可能会冒着在大数字上耗尽内存的风险。

> 行业标准是什么？

据我所知，计算阶乘没有行业标准。一般来说，行业标准不会详细说明；如果他们这样做，那就太好了。

> 如何在上述两种方法中选择一种？

独立于函数的真实性质，您也可以通过在输入域上运行函数并对两者进行基准测试来得出自己更好的结论。

> 确定哪个更好的条件是什么？

记忆和时间是重要的因素。您应该尝试实现低内存消耗和短执行时间。这并不总是可能的，在这种情况下，您需要妥协其中任何一个。

也就是说，我会选择迭代解决方案。

* * *

顺便说一句，如果 PHP 要实现尾递归优化，您可以像这样编写阶乘函数：

```
function fact($n, $r = 1)
{
    if ($n < 2) {
        return $r;
    } else {
        return fact($n - 1, $r * $n);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-10T02:13:33.747

据我所知，第一个比递归更好。因为它会给系统带来很多开销，有时还会停止脚本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-15T16:29:58.500

我创建了一个脚本来测试哪些方法更快。

```
$f = 12; //calculate factorial of this number
$n = 10000000; //the number of times the process is repeated

//factorial using iterative function
function f1($a) {
    $r = $a;
    for($i=$a-1; $i >= 2; $i--)
        $r *= $i;
    return $r;
}

//factorial using recursive function
function f2($a) {
    return $a < 2 ? 1 : $a * f2($a - 1);
}

echo "\n\n";

$start = microtime(true);
for($i=0; $i < $n; $i++)
    $x = f1($f);
echo "f1(): " . ((microtime(true) - $start) * 1000) . " ms\n";

$start = microtime(true);
for($i=0; $i < $n; $i++)
    $x = f2($f);
echo "f2(): " . ((microtime(true) - $start) * 1000) . " ms\n"; 
```

结果：

```
f1():  6 648 ms
f2(): 12 415 ms 
```

除了递归使用更多内存这一事实之外，它比迭代慢了大约 1.87 倍。在 PHP 7 上测试。

# python - python多进程中的C静态变量

> ID：12810987
> 
> 赞同：1
> 
> 时间：2012-10-10T02:08:38.667
> 
> 标签：python, static-variables, multiprocess

在这里，我有一个用 C++ 调用*foo*编写的函数，并通过使用用 C 编写的 python 包装器（wrapper.c）使其可从 python 调用（*foo_wrapper*）。

在 wrapper.c 中，我有一个静态全局变量“x”，由*foo*使用和更新。

现在，当我在一个进程中从 python调用*foo时，一切正常。*

但是，当我在 python 中使用**多**进程模块时，即使 foo 是从主进程调用的，这个“x”值也不是应该的！调用过程是这样的：

```
P=Process(target=myf, args=(a,))
P.start()
foo_wrapper()
P.join() 
```

我的问题是：当调用 fork() 时，即启动多个进程，python 如何处理父/子进程的堆栈或堆？我怎样才能使主进程（或父进程）的“x”值正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:20:08.600

C++ 全局变量仅对单个进程是全局的。如果您正在使用该`multiprocessing`模块，那么根据定义，您将拥有多个进程，每个进程都有自己的全局变量视图。Python 没有做任何特别的事情来影响这种行为。

假设您可以控制 C++ 代码，我建议重构它，以使 Python 可以序列化和反序列化的形式对 Python 可见这个全局状态。然后，您可以根据需要在进程之间传递状态（例如，使用来自 的队列类之一`multiprocessing`）。

# apache - .htaccess 用于附加 https://www

> ID：12810989
> 
> 赞同：2
> 
> 时间：2012-10-10T02:09:03.177
> 
> 标签：apache, .htaccess, ssl, https

我已经搜索了很长一段时间来获得解决方案或对我的查询的提示，但没有找到任何有价值的东西。基本上我有我的应用程序是 SSL 安全的。我想要的只是

1.  如果用户尝试在没有 https 和 www 的情况下打开应用程序，它应该会自动附加“ `https://www`”

2.  如果用户输入“ `https://mydomain.com`”，它应该变为“ `https://www.mydomain.com`”

3.  如果用户输入“ `www.mydomain.com`”，它应该变为“ `https://www.mydomain.com`”

我知道这可以通过 .htaccess 来实现，但我对这些文件的编写方式一无所知。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-10T04:34:45.910

通过启用 mod_rewrite 和 .htaccess `httpd.conf`，然后将此代码放在您`.htaccess`的`DOCUMENT_ROOT`目录下：

```
Options +FollowSymLinks -MultiViews
# Turn mod_rewrite on
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST} !^www\. [NC]
RewriteRule ^ https://www.%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-10T04:35:55.540

尝试将这些规则添加到文档根目录中的 htaccess 文件中：

```
RewriteEngine On
RewriteCond !{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
RewriteCond %{HTTP_HOST} !^www\.
RewriteRule ^(.*)$ https://www.%{HTTP_HOST}%{REQUEST_URI} [L,R=301] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-10T04:34:36.767

使用以下内容：

```
RewriteEngine On 
RewriteCond %{SERVER_PORT} 80 
RewriteRule ^(.*)$ https://www.mydomain.com/$1 [R,L] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-10T04:36:03.850

在您的 .htaccess 文件中

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://www.mydomain.com/$1 [L,R]
</IfModule> 
```

RewriteCond %{HTTPS} off 检查 HTTPS 是否关闭。如果它确实关闭（URL 不包含 https://），则应用重写规则并重定向用户。

# node.js - 如何将 medic-injector 添加到 node.js 应用程序

> ID：12810994
> 
> 赞同：0
> 
> 时间：2012-10-10T02:09:28.163
> 
> 标签：node.js, inversion-of-control, code-injection

[我已经安装了 medic-injector 包并按照 medic-injector 的 github 站点https://github.com/DrBenton/Medic-Injector-JS](https://github.com/DrBenton/Medic-Injector-JS)上的说明创建了一个 app/bootstrap.js 文件

一旦我的 app.js 启动，我们如何确保调用注入器？有人有任何指示吗？

提前致谢！

塔米

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T02:32:05.663

创建注入器并添加映射后，您需要在注入器上调用“triggerFunctionWithInjectedParams”方法。

例如：

```
injector.triggerFunctionWithInjectedParams([function name that you want to call]); 
```

请参阅注入器类的 api 文档以查看它包含哪些方法： [http ://drbenton.github.com/Medic-Injector-JS/api/#!/api/sync.Injector](http://drbenton.github.com/Medic-Injector-JS/api/#!/api/sync.Injector)

medic-injector的基本用法是：

1.  创建一个注入器对象
2.  向注入器添加映射
3.  （如果需要，删除映射，如果改变注入器）
4.  使用 triggerFunctionWithInjectedParams 调用注入所有映射的函数。

# javascript - 如何通过javascript以编程方式选择/突出显示HTML页面中的dom？

> ID：12810997
> 
> 赞同：0
> 
> 时间：2012-10-10T02:09:46.447
> 
> 标签：javascript, select, web, copy

例如，我在页面中有一个表 dom，如何在 IE 和 Firefox 浏览器中通过 javascript 选择/突出显示它。

当用户使用 ctrl+c 复制某些内容时，我只想将表 dom 复制到剪贴板。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T03:40:32.970

[这](http://jsfiddle.net/vvNRX/1/)是一个非常简单的例子：

```
<table id="someTable">
<tr>
    <td>ajlaksjd flsajlsd</td>
</tr>
</table>​

<script>
window.prompt ("Copy to clipboard: Ctrl+C, Enter",
      document.getElementById("someTable").outerHTML);
</script> 
```

​我喜欢这个，因为你得到了整个表，你不必担心当你开始自动弄乱用户的复制/粘贴缓冲区时出现的安全问题。有关自动复制/粘贴的许多选项的良好讨论，请查看[这篇文章。](https://stackoverflow.com/questions/400212/how-to-copy-to-the-clipboard-in-javascript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T03:31:50.407

您可以使用 JS 包装选定/突出显示的元素，包装器应该具有一些视觉效果，例如边框或轮廓，然后您可以使用`el.innerHTML`获取 dom，最后使用诸如[zeroclipboard 之](http://code.google.com/p/zeroclipboard/)类的库复制到剪贴板。

# security - Shiro 注释不适用于 JavaEE6 项目

> ID：12810999
> 
> 赞同：3
> 
> 时间：2012-10-10T02:09:58.493
> 
> 标签：security, jsf-2, java-ee-6, shiro

问题：JavaEE6 的实现在哪里？

我目前正在处理一个 JavaEE6 项目，我发现即使我已经根据文档配置了 web.xml 和 shiro.ini，Shiro 的注释也不能开箱即用。

这就是我所拥有的：

1.) 一个页面：

```
<h:form>
  <h:commandLink action="#{userBean.action1()}" value="Action 1"></h:commandLink>
</h:form> 
```

2.) 支持豆：

```
@Stateless
@Named
public class UserBean {
    @Inject
    private Logger log;

    @RequiresAuthentication
    public void action1() {
        log.debug("action.1");
    }
} 
```

3.) web.xml

```
<listener>
    <listener-class>org.apache.shiro.web.env.EnvironmentLoaderListener</listener-class>
</listener>

<filter>
    <filter-name>ShiroFilter</filter-name>
    <filter-class>org.apache.shiro.web.servlet.ShiroFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>ShiroFilter</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

4.) shiro.ini

```
[main]
# listener = org.apache.shiro.config.event.LoggingBeanListener

shiro.loginUrl = /login.xhtml

[users]
# format: username = password, role1, role2, ..., roleN
root = secret,admin
guest = guest,guest
presidentskroob = 12345,president
darkhelmet = ludicrousspeed,darklord,schwartz
lonestarr = vespa,goodguy,schwartz

[roles]
# format: roleName = permission1, permission2, ..., permissionN
admin = *
schwartz = lightsaber:*
goodguy = winnebago:drive:eagle5

[urls]
# The /login.jsp is not restricted to authenticated users (otherwise no one could log in!), but
# the 'authc' filter must still be specified for it so it can process that url's
# login submissions. It is 'smart' enough to allow those requests through as specified by the
# shiro.loginUrl above.
/login.xhtml = authc
/logout = logout
/account/** = authc
/remoting/** = authc, roles[b2bClient], perms["remote:invoke:lan,wan"] 
```

但是当我单击按钮时，它仍然执行操作。它应该抛出未经授权的异常吗？其他 shiro 注释也是如此。

请注意，如果我手动执行检查，它会起作用：

```
public void action1() {
    Subject currentUser = SecurityUtils.getSubject();
    AuthenticationToken token = new UsernamePasswordToken("guest", "guest");
    currentUser.login(token);

    log.debug("user." + currentUser);
    if (currentUser.isAuthenticated()) {
        log.debug("action.1");
    } else {
        log.debug("not authenticated");
    }
} 
```

谢谢，
czetsuya

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T12:01:52.717

您基本上需要一个[Java EE 拦截器](http://docs.oracle.com/javaee/6/api/javax/interceptor/package-summary.html)来扫描调用的 CDI 和 EJB 方法上的注释。

首先创建一个拦截器必须拦截的注释：

```
@Inherited
@InterceptorBinding
@Target({ ElementType.TYPE, ElementType.METHOD })
@Retention(RetentionPolicy.RUNTIME)
public @interface ShiroSecured {
    //
} 
```

然后创建拦截器本身：

```
@Interceptor
@ShiroSecured
public class ShiroSecuredInterceptor implements Serializable {

    private static final long serialVersionUID = 1L;

    @AroundInvoke
    public Object interceptShiroSecurity(InvocationContext context) throws Exception {
        Class<?> c = context.getTarget().getClass();
        Method m = context.getMethod();
        Subject subject = SecurityUtils.getSubject();

        if (!subject.isAuthenticated() && hasAnnotation(c, m, RequiresAuthentication.class)) {
            throw new UnauthenticatedException("Authentication required");
        }

        if (subject.getPrincipal() != null && hasAnnotation(c, m, RequiresGuest.class)) {
            throw new UnauthenticatedException("Guest required");
        }

        if (subject.getPrincipal() == null && hasAnnotation(c, m, RequiresUser.class)) {
            throw new UnauthenticatedException("User required");
        }

        RequiresRoles roles = getAnnotation(c, m, RequiresRoles.class);

        if (roles != null) {
            subject.checkRoles(Arrays.asList(roles.value()));
        }

        RequiresPermissions permissions = getAnnotation(c, m, RequiresPermissions.class);

        if (permissions != null) {
             subject.checkPermissions(permissions.value());
        }

        return context.proceed();
    }

    private static boolean hasAnnotation(Class<?> c, Method m, Class<? extends Annotation> a) {
        return m.isAnnotationPresent(a)
            || c.isAnnotationPresent(a)
            || c.getSuperclass().isAnnotationPresent(a);
    }

    private static <A extends Annotation> A getAnnotation(Class<?> c, Method m, Class<A> a) {
        return m.isAnnotationPresent(a) ? m.getAnnotation(a)
            : c.isAnnotationPresent(a) ? c.getAnnotation(a)
            : c.getSuperclass().getAnnotation(a);
    }

} 
```

请注意，在目标类的超类上检查注释，并且目标类可能在 CDI 实际上是代理并且 Shiro 的注释没有`@Inherited`设置的情况下。

为了让它在 CDI 托管 bean 上工作，首先注册拦截器，`/WEB-INF/beans.xml`如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://docs.jboss.org/cdi/beans_1_0.xsd"
>
    <interceptors>
        <class>com.example.interceptor.ShiroSecuredInterceptor</class>
    </interceptors>
</beans> 
```

同样，为了让它在 EJB 上工作，首先`/WEB-INF/ejb-jar.xml`按如下方式注册拦截器（或者`/META-INF/ejb-jar.xml`如果您在 EAR 中有单独的 EJB 项目）：

```
<?xml version="1.0" encoding="UTF-8"?>
<ejb-jar
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
        http://java.sun.com/xml/ns/javaee/ejb-jar_3_1.xsd"
    version="3.1"
>
    <interceptors>
        <interceptor>
            <interceptor-class>com.example.interceptor.ShiroSecuredInterceptor</interceptor-class>
        </interceptor>
    </interceptors>
    <assembly-descriptor>
        <interceptor-binding>
            <ejb-name>*</ejb-name>
            <interceptor-class>com.example.interceptor.ShiroSecuredInterceptor</interceptor-class>
        </interceptor-binding>
    </assembly-descriptor>
</ejb-jar> 
```

在 CDI 托管 bean 上，您需要设置自定义`@ShiroSecured`注释以使拦截器运行。

```
@Named
@RequestScoped
@ShiroSecured
public class SomeBean {

    @RequiresRoles("ADMIN")
    public void doSomethingWhichIsOnlyAllowedByADMIN() {
        // ...
    }

} 
```

这在 EJB 上不是必需的，`ejb-jar.xml`已经在所有 EJB 上注册了它。

### 也可以看看：

*   [Apache Shiro，为 Java EE 6 做好准备了吗？- bean 方法中的声明性限制](http://balusc.blogspot.com/2013/01/apache-shiro-is-it-ready-for-java-ee-6.html#DeclarativeRestrictionInBeanMethods)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-11T06:37:36.100

基本上，我缺少的是 Shiro 的 Requires* 接口的实现，所以我根据我的需要来实现。对于那些感兴趣的人，你可以在这里找到它：http: [//czetsuya-tech.blogspot.com/2012/10/how-to-integrate-apache-shiro-with.html](http://czetsuya-tech.blogspot.com/2012/10/how-to-integrate-apache-shiro-with.html)