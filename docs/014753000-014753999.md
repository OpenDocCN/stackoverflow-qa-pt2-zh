# StackOverflow 问答 14753000-14753999

# android - Android - 如何在按钮中设置带两位小数的文本

> ID：14753001
> 
> 赞同：1
> 
> 时间：2013-02-07T14:04:01.933
> 
> 标签：android

我需要设置一个带有两位小数的按钮文本。值源是双精度的，例如 1.0、5.0、10.0 或 100.0，下面的字符串格式将其转换为有两位小数，所以它可以工作。

```
 b = new Button(context);
            String stringdouble = String.format("%.2f", 1.0);

            b.setText(stringdouble); 
```

然而，即使在调试模式下，变量“stringdouble”也是“1.00”或“5.00”或“10.00”或“100.00”，在按钮上它们显示为“1.0”、“5.0”、“10.”、“100” ”。

有人知道为什么会这样吗？？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:07:14.513

也许您必须将按钮的宽度参数设置为“wrap_content”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:07:58.710

您正在为按钮使用固定宽度。将按钮宽度设置为`wrap_content`

# tomcat - 在自动部署之前自定义 Web 应用程序

> ID：14753002
> 
> 赞同：0
> 
> 时间：2013-02-07T14:04:05.303
> 
> 标签：tomcat, cloud, war, web-deployment

## 应用场景

我在 IaaS 云服务上有一堆 Tomcat 服务器，所以它们都在我的控制之下。

这些服务器将（应用程序处于设计阶段）运行任何 Java 应用程序容器软件，例如 Tomcat、JBoss、Websphere。

除了最好的解决方案之外，我还有一个 Web 应用程序（WAR），我有完整的源代码。就像在任何体面的托管环境中一样，设置新用户意味着将同一 Web 应用程序的新副本部署到不同的应用程序上下文（例如，将 WAR 复制为`newuser.war`并让 Tomcat 吃掉它）。

该应用程序完全基于 Spring 和 Hibernate。它由 Maven 提供支持。

由于我们在 IaaS 上运行，我们正在*考虑*向我们的管理软件添加要求。如果应用服务器出现故障，重新部署它在不同节点上运行的 webapps，和/或自动请求云提供商提供新机器（尤其是当注册用户增加时）。我们的提供商**目前没有**PaaS 服务。讨论支持 Java Webapps 的云提供商**超出了范围**。

## 配置需求

前面提到的 webapp 的每个实例都有自己的数据库（需要管理软件生成的特定连接字符串）。此外，我们需要在它们的字符串属性中自定义一些 bean。

## 问题

专注于自我管理和自动管理的 Tomcat 服务器，我们需要设计一个自动设置机制（集成到我们之前讨论过的故障转移中）。我们现在的问题是**设置数据库连接字符串**和**一些 Spring bean 的字符串属性**（这些是共享的一对一密码）。

首先，我带着我的想象力提出了一个可能的解决方案，但我不知道它是否在易用性和可管理性方面是“最好的”。

那么问题来了：

*   从高层次的角度来看，您是否看到以下描述的方法存在重大缺陷？
*   您是否知道更智能的解决方案（也许可以通过附加软件轻松实现）来实现我需要做的事情？

## 该方法

由于我们有完整的源代码，一个 Bash 脚本就足够了：

1.  从 SVN 生产分支下载新副本
2.  从字面上用所需的替换连接字符串`hibernate.cfg.xml`（也许 SVN 分支中的文件包含用于字符串替换的占位符）
3.  从字面上替换 Spring 配置文件中的占位符
4.  以新名称复制到 Tomcat webapp 文件夹
5.  等待 Tomcat 自动部署

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:13:38.420

Spring 支持占位符。

最简单的方法是将一个属性文件放在类路径中（如果每个服务器只运行一个战争，在 Tomcat lib 目录中，或者如果在 war/WEB-INF/class 文件夹中有多个战争）。

大多数情况下，占位符用于定义数据库连接（可能解决您的休眠配置需求）。

由于有几种不同的方式来检索配置，您应该使用大 G 来搜索您的案例的方法。

# python - 可以与包装函数的参数交互的装饰器

> ID：14753007
> 
> 赞同：2
> 
> 时间：2013-02-07T14:04:18.360
> 
> 标签：python, decorator

我正在尝试构建一个可以检查包装函数的参数的装饰器，需要的上下文是允许在某些参数到达函数之前更容易地验证它们，避免在我需要检查/验证的每个地方进行检查的样板。

不过，这并不是一个难以编写的装饰器，并且可以完成工作（例如，确保值不是 None ）：

```
def check_arg(func):
    def wrapped(value):
        assert value is not None
        func(value)
    return wrapped 
```

上面的例子不是生产代码，它只是一个可以工作的例子，但是当装饰函数可以使用其他装饰器时，问题就变得很明显了。

在这种情况下，上面的装饰器示例将不起作用，因为`value`现在可以是另一个装饰器。我可以在这里添加另一个嵌套函数，但看起来应该有一种更好的方式来以编程方式处理它，另外，只要装饰器的数量发生变化，它就会中断。

无论使用多少装饰器，我如何才能获得包装函数的参数？

编辑：我应该注意到我不是简单地堆叠装饰器，我正在使用一个装饰器来装饰可重复使用的装饰器。在上面的示例中，我将在此上下文中重新使用它：

```
@check_arg
def some_other_decorator(func):
    def wrapped(*args, **kw):
        ... # some interaction here
    return wrapped 
```

在我写这个编辑的时候，我意识到`check_arg`装饰器放错了地方，它应该`wrapped`在`some_other_decorator`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:06:31.767

你能控制其他装饰器吗？如果是这样，请通过正确包装调用函数来确保它们都运行良好：

```
 import functools
  def check_arg(func):
      @functools.wraps(func)
      def wrapped(value):
          assert value is not None
          func(value)
      return wrapped 
```

# .htaccess - 301重定向目录的正确方法

> ID：14753024
> 
> 赞同：4
> 
> 时间：2013-02-07T14:05:54.847
> 
> 标签：.htaccess, redirect

我想知道像这样进行重定向的正确方法是什么：

```
Redirect 301 /about/$ http://domain.com/new-about/
Redirect 301 /about$ http://domain.com/new-about/
Redirect 301 /about/me http://domain.com/new-about/ 
```

这就是我目前的做法并且它有效，但我相信应该有更好的方法？

我有 2 个页面被重写，一个页面是另一个页面的子页面`/about/me/`，现在两个页面都应该重定向到新页面`new-about`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-22T02:05:38.310

您应该使用[RedirectMatch](http://httpd.apache.org/docs/current/mod/mod_alias.html#redirectmatch)或使用 mod_rewrite 来执行正则表达式匹配。这应该可行，并且将是最短且性能最佳的解决方案：

```
RedirectMatch 301 ^/about /new-about/ 
```

域和协议是可选的 - 像这样将它们排除在外将使它们保持原样，因此这是未来的证明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T02:06:37.893

自从我问这个问题以来已经有一段时间了，现在我对正则表达式更加熟悉了。

我现在这样做的方式是：

```
Redirect 301 ^/about http://domain.com/new-about/ 
```

一个帮助我理解正则表达式的工具，我会建议任何试图理解它们的人是 Rubular：[http: //rubular.com/](http://rubular.com/)

# tridion - 根据子组件的 URI 检索 BluePrinted 组件的父 URI

> ID：14753025
> 
> 赞同：3
> 
> 时间：2013-02-07T14:05:57.630
> 
> 标签：tridion, tridion-2011

有谁知道如何使用核心服务在 SDL Tridion 的子出版物中基于共享或本地化组件的 URI 找到父组件的 URI？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T14:18:17.287

您可以使用`ComponentData.BluePrintInfo.OwningRepository.IdRef`来获取“拥有”该组件的发布的 TcmUri。这是创建或本地化组件的第一个“上升”出版物。

然后你可以使用这样的东西在正确的上下文中为你获取组件 Uri：

```
internal string GetUriInBlueprintContext(string itemId, string publicationId)
{
    if (TcmUri.UriNull == itemId)
        return null;
    TcmUri itemUri = new TcmUri(itemId);
    TcmUri publicationUri = new TcmUri(publicationId);
    TcmUri inContext = new TcmUri(itemUri.ItemId, itemUri.ItemType, publicationUri.ItemId);
    return inContext.ToString();
} 
```

该类`TcmUri`是 Tridion.Common.dll 的一部分，您也可以从项目中引用它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-07T14:54:00.240

这是比 Nuno 提出的更简单的方法，您不需要引用任何 dll

```
var parentComponentid = ClientAdmin.GetTcmUri(component.Id, component.BluePrintInfo.OwningRepository.IdRef, null); 
```

`GetTcmUri`方法适用于获取任何 TcmUris - 只需传递您希望您的项目进入的出版物 ID 和当前出版物中的项目 ID。这样，您还可以在特定子出版物中找到给定项目的 ID

# wordpress - 从 wp_query 循环 wordpress 中排除帖子

> ID：14753028
> 
> 赞同：1
> 
> 时间：2013-02-07T14:06:06.827
> 
> 标签：wordpress, wordpress-theming

我用以下代码在页面中显示我的最后一篇文章：

```
$query1 = new WP_Query();
$query1->the_post(); 
```

并进一步：

```
$id = $query->ID; 
```

检索最后一个帖子 ID，所以我写了一个新的 wp_query，我想从结果中排除该 ID：我写了这个，但它不起作用：

```
$query2-> new WP_Query('p=-$id'); 
```

有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:37:20.323

你没有排除任何东西。[阅读法典](http://codex.wordpress.org/Class_Reference/WP_Query#Post_.26_Page_Parameters)。`p=` **包括**帖子。它不排除它们。你需要的是`post__not_in`

```
$query2-> new WP_Query(array('post__not_in' = array($id))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-09T08:56:20.220

我的代码工作正常：

```
$ID =array('1,2,3,4,5');
$news = new WP_Query(array('
    'post_type'    => 'post',
    'showposts'    =>3,
    'order'        => 'DESC',
    'post__not_in' => $ID
));
if ( $news->have_posts() ) :
    echo '<div>';
        while ( $news->have_posts() ) : $news->the_post(); ?>`

            //Your code here 
```

# javascript - css :before 在嵌套 div 中不能完美工作

> ID：14753034
> 
> 赞同：0
> 
> 时间：2013-02-07T14:06:19.417
> 
> 标签：javascript, html, css

我对 css`:before`和`:after`. 这是我的html：

```
<div id = "test-box">
    1
</div> 
```

这是我的CSS：

```
#test-box:before{
    content: "hello";
} 
```

当我运行它时，它可以完美运行并打印：`hello 1`

但是当我把另一个`div`放在我现有的里面时`div`，它就不起作用了。这是新的html：

```
<div id = "test-box">
    <div>1</div>
</div> 
```

在这种情况下，浏览器会打印：

```
hello
1 
```

我需要你好留在 1 的左侧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:11:27.047

div 是块元素，所以当你在 div 和嵌套 div**之前**添加 hello 时，显然会有换行符。

使用嵌套 div 时，必须使用

[jsfiddle 演示](http://jsfiddle.net/UyVuN/)

```
#test-box div:before{
content: "hello";
} 
```

**更新：** [jsfiddle 演示](http://jsfiddle.net/UyVuN/1/)

```
#test-box:before{
content: "hello";
}

#test-box div {
    display: inline;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:09:35.543

如果您有嵌套的 div，请使用此 CSS：

```
#test-box div:before{
    content: "hello";
} 
```

那里的选择器选择id 元素中的`div` **，**`test-box`并在其之前添加文本，而不是在外部 div 之前添加文本。

原因`1`是换行是因为`divs`是块元素。您的原始 CSS 在内部`<div>`标记之前添加了文本，从而在添加的文本之后产生了换行符。

所以，这发生了：

```
<div id="test-box">
    hello
    <div> <!-- the div starting here causes the following text to be displayed on a new line -->
        1
    </div>
</div> 
```

使用修改后的 CSS，这将是结果，而不是：

```
<div id="test-box">
    <div>
        hello1
    </div>
</div> 
```

* * *

如果您必须将其放在外部 div 中，请将其添加到您的 css 中：

```
#test-box div{
    display: inline-block;
} 
```

（也保留您的问题的另一行）。

这将防止内部`div`换行到新行。

**[例子](http://jsfiddle.net/TZUbK/)**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:11:09.407

原因`hello`是在单独的行`1`上，因为`1`它被块级元素（内部 div）包裹。

尝试这个：

```
#test-box div:before {
  content: "hello";
} 
```

或者，如果您可以控制 HTML，则将内部 div 替换为 span（或其他内联元素）。

# wcf - 为什么 WCF 服务不返回列表<>？

> ID：14753035
> 
> 赞同：0
> 
> 时间：2013-02-07T14:06:19.503
> 
> 标签：wcf

当我添加/编辑服务客户端时，如果我单击“高级...”按钮，我将看到一个选项，允许我为我的客户端代理选择集合类型。默认值为 System.Array。当我更改为 System.Colaction.Generic.List 并单击添加代理创建。但是在我的方法返回值中，我看到 type[] 而不是 List，为什么？我做错了什么？这是类：

```
[DataContract]
public class Asset
{
    [DataMember]
    public decimal AssetId { get; set; }
    [DataMember]
    public string AssetName { get; set; }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:09:00.300

当您生成代理类选择`List`时`Array`

# c - C 中允许的静态数组的最大大小是多少？

> ID：14753036
> 
> 赞同：7
> 
> 时间：2013-02-07T14:06:20.900
> 
> 标签：c, arrays, stack, max

在我的算法中，我知道使用静态数组，没有动态数组。但有时我会达到堆栈的极限。我是对的，静态数组存储到堆栈中吗？

哪些参数会影响我的一个 C 程序的最大堆栈大小？

是否有许多系统参数会影响最大阵列大小？最大没有。元素的数量取决于数组类型？它是否取决于总系统 RAM？还是每个 C 程序都有一个静态的最大堆栈大小？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T14:12:51.370

> 我是对的，静态数组存储到堆栈中吗？

不，`static`数组存储在静态存储区中。*自动*的（即在函数内部声明的，没有`static`存储说明符的）在堆栈上分配。

> 哪些参数会影响我的一个 C 程序的最大堆栈大小？

这取决于系统。在某些操作系统上[，您可以通过编程方式更改堆栈大小](https://stackoverflow.com/a/2284691/335858)。

由于自动存储分配而导致堆栈空间不足是一个明显的迹象，表明您需要重新考虑您的内存策略：如果重入不是问题，您应该在静态存储区域中分配缓冲区，或者对最大的内存使用动态分配你的数组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T14:14:01.047

实际上，这取决于您使用的平台的 C 编译器。

例如，甚至有些系统没有真正的堆栈，因此递归不起作用。

静态数组被编译为带有指针的连续内存区域。指针的大小可能是两个或四个字节（或者在异国平台上甚至可能只有一个）。

有些平台使用具有大小（当然还有速度）不同的“近”和“远”指针的内存页面。因此，表示数组和对象的指针可能需要适合同一内存页面。

在嵌入式系统上，静态数据通常收集在内存区域中，稍后将由只读内存表示。所以你的阵列必须适合那里。

在运行任意应用程序的平台上，如果以上都不适用，RAM 是限制因素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-09T00:04:03.763

您的大部分问题都已得到解答，但只是为了给出一个让我的生活更轻松的答案：

**定性**地说，非动态分配数组的最大大小取决于您拥有的 RAM 量。它还取决于数组的类型，例如 an`int`可能是 4 个字节，而 double 可能是 8 个字节（它们也取决于系统），因此如果您使用，您将能够拥有一个元素数量为两倍的数组`int`而不是`double`.

话虽如此，但请记住，有时数字确实很重要，这里有一个非常无聊的代码片段，可帮助您提取系统中的最大数字。

```
#include <stdio.h>
#include <stdlib.h>

#define UPPER_LIMIT 10000000000000 // a very big number

int main (int argc, const char * argv[])
{
    long int_size = sizeof(int);
    for (int i = 1; i < UPPER_LIMIT; i++)
    {
        int c[i];
        for (int j = 0; j < i; j++)
        {
            c[j] = j;
        }
        printf("You can set the array size at %d, which means %ld bytes. \n", c[i-1], int_size*c[i-1]);
    }    
} 
```

PS：可能需要一段时间才能达到系统的最大值并产生预期的分段错误，因此您可能希望将初始值更改为`i`更接近系统 RAM 的值，以字节表示。

# php - 爆炸期望如果有“

> ID：14753038
> 
> 赞同：-2
> 
> 时间：2013-02-07T14:06:29.590
> 
> 标签：php

我正在尝试用逗号分解一个字符串，但是在字符串中有一些我不想分解的逗号，这些逗号介于`" "`：`"hey, how are you"`. 我尝试了很多事情，比如爆炸第`"`一个。那么我该怎么做呢？

例如我有这个字符串：

```
hey,how,are,"yo how,are you?",i'm,good 
```

所以输出将是：

```
array (
    0 => hey,
    1 => how,
    2 => are,
    3 => "you how, are you?",
    4 => i'm,
    5 => good
); 
```

我试图首先爆发`"`，但我不知道如何。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:09:36.557

用于[`str_getcsv()`](http://php.net/str_getcsv)PHP >= 5.3：

```
var_dump( str_getcsv( 'hey,how,are,"yo how,are you?"')); 
```

这打印：

```
array(4) { [0]=> string(3) "hey" [1]=> string(3) "how" [2]=> string(3) "are" [3]=> string(15) "yo how,are you?" } 
```

# jquery - 从 JSON 抓取、调整大小和显示图像

> ID：14753045
> 
> 赞同：0
> 
> 时间：2013-02-07T14:06:40.167
> 
> 标签：jquery

基本上，我想做的是以下几点：

1.  用户在我们的系统上输入资产的 ID
2.  该 ID 是作为 API 调用的一部分提交的，该调用返回带有名为“videoStillURL”的字段的 JSON，其中包含缩略图图像的 URL。
3.  将此缩略图从其现有大小调整为较小的大小，这样，如果有人右键单击并保存到他们的硬盘驱动器，它将是调整大小的版本而不是原始版本。

我不确定这一切是否可能......我可以做一些零碎的工作，但无法将它们放在一起，我想看看是否有人有任何见解。

下面是我返回的 JSON 格式。我很难弄清楚如何为 videoStillURL 项目加载图像 URL，主要是因为 URL 中有额外的斜杠。

```
{"name":"Test Item","videoStillURL":"http:\/\/brightcove.vo.llnwd.net\/d21\/unsecured\/media\/1547387903001\/1547387903001_2146991932001_vs-5112b14ee4b0a4075c1c8334-1592194027001.jpg?pubId=1547387903001","thumbnailURL":"http:\/\/brightcove.vo.llnwd.net\/d21\/unsecured\/media\/1547387903001\/1547387903001_2146991933001_th-5112b14ee4b0a4075c1c8334-1592194027001.jpg?pubId=1547387903001"} 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:27:52.113

额外的斜线不应该成为问题，因为它们会被转义。

假设你正在做这样的模型：

```
$(document).ready(function()
{
    ...
    ajaxSuccessCallHere(data)
    {
        var image = $("<img/>");
        $(image).attr('src', data.thumbnailURL)
        $(document.body).append(image);
    }
    ...
}); 
```

在您试图实现的目标中，我发现不可能做到的是，仅在右键单击图像时就可以保存 videoStillURL 。我的做法是`<a href='[videoStillURL]'>`在图像周围加上一个标签 - 所以右键单击并选择“保存源”实际上会保存原始图像而不是缩略图

# php - 将excel公式转换为PHP脚本

> ID：14753048
> 
> 赞同：-8
> 
> 时间：2013-02-07T14:06:42.587
> 
> 标签：php, excel

我是编程新手。我有一个 Excel 公式，我想将其转换为 PHP，有人可以帮助我吗？

请找到以下公式：

```
=(IF(MAX(C4,D4)-MIN(C4,D4)<0.05*MAX(C4,D4)*AND(E4<=0.75*MAX(D4,C4)),"hourglass",1)) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T14:11:51.683

*   `=IF(expr, valueIfTrue, valueIfFalse)`可以转换为`$result = expr ? valueIfTrue : valueIfFalse`
*   列引用可以转换为变量引用
*   Rest 几乎保持不变，主要是因为 PHP 具有不区分大小写的关键字和函数

```
$C4 = 1;
$D4 = 2;
$E4 = 3;

$result = ((MAX($C4, $D4) - MIN($C4, $D4) < 0.05 * MAX($C4, $D4)) AND 
          ($E4 <= 0.75 * MAX($C4, $D4))) ? "hourglass" : 1; 
```

# mysql - 进一步提高SQL查询效率

> ID：14753050
> 
> 赞同：0
> 
> 时间：2013-02-07T14:06:46.203
> 
> 标签：mysql, sql

我的最后一个问题得到了很好的答案：[提高我的 SQL 效率](https://stackoverflow.com/questions/14751541/improving-efficiency-of-my-sql)（感谢@Bohemian）我现在意识到我有点短视，因为还有一个额外的复杂性。

使用同一张表 LIKES (likeID,userID,objectID,likeDate) 的想法是，一个人在他们喜欢一个对象后每次喜欢一个对象就可以获得 1 分。

在上一个问题的帮助下，我可以在用户喜欢之后获得喜欢的数量，但现在我需要考虑这个问题中存在对象。

我希望能够通过计算用户对他们喜欢的每个对象的点赞数来计算用户有权获得的点数（哦，那是一个凌乱的句子）。

我正在考虑对 SQL 进行进一步的“嵌套”，但这超出了我的范围，因此除了最后一个问题中的内容之外，我无法提供任何代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:12:18.560

您可以使用相关子查询执行此操作：

```
select l.userid, l.objectid, l.LikeDate,
       (select count(*) from likes l2 where l2.objectid = l.objectid and l2.LikeDate >= l.likeDate and l2.userid <> l.userid
       ) as NumLikesAfterward
from likes l 
```

这样做是在给定点赞后计算其他用户对某个对象的点赞数。它为 中的每一行返回一行`likes`。计算是使用`select`子句中的相关子查询完成的。

假设您有一个索引，它将运行得更快`likes(objectid, likedate, userid)`。

获取用户的总分：

```
select sum(NumLikesAfterward) as TotalPoints
from (select l.userid, l.objectid, l.LikeDate,
             (select count(*) from likes l2 where l2.objectid = l.objectid and l2.LikeDate >= l.likeDate and l2.userid <> l.userid
             ) as NumLikesAfterward
      from likes l
      where userid = $userid
     ) uol 
```

# ruby - Ruby 脚本不等待命令提示符中的输入

> ID：14753059
> 
> 赞同：1
> 
> 时间：2013-02-07T14:06:59.403
> 
> 标签：ruby, command-prompt

我的 ruby​​ 脚本似乎没有等待我的输入。我正在尝试遵循从本书第一章加密文件的脚本：wicked cool ruby​​，但在我在命令提示符下运行文件后，它不会等待我的输入。

导致问题的代码片段：

```
require 'crypt/blowfish'

unless ARGV[0]
   puts "Usage: ruby encrypt.rb <filename.ext>"
   puts "Example: ruby encrypt.rb secret.stuff"
   exit
end

#take in the file name to encrypt as an argument
filename = ARGV[0].chomp
puts filename

c = "Encrypted_#{filename}"

if File.exists?(c)
   puts "File already exists."
   exit
end

print 'Enter your encryption key (1-56 bytes): '
kee = gets.chomp

begin
   blowfish = Crypt::Blowfish.new(kee)
   blowfish.encrypt_file(filename.to_str, c)
   puts 'Encryption SUCCESS!'
rescue Exception => e
   puts "An error occurred during encryption: \n #{e}"
end 
```

尝试运行文件后在 cmd 中看到的内容：

```
C:\Users\me\>ruby new4.rb fileToEnrypt.txt
Enter your encryption key (1-56 bytes): An error occurred during encryption:
 can't convert String into Integer
C:\Users\me\> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T14:33:25.323

你在这里有两个问题：

关于您没有得到用户提示的事实，请将您的代码替换为：

```
kee = $stdin.gets.chomp 
```

关于错误消息，这是因为：

> 密钥介于 64 和 448 位（8 和 56 字节）之间，应作为打包字符串传递

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:34:17.157

这是因为您正在尝试使用加密将字符串转换为整数。

`kee = gets.chomp`正在根据您提供的输入返回一个字符串，这是一个字符串，并且当您将字符串加密为整数时，将发生错误。

错误消息本身说：

```
can't convert String into Integer 
```

此外，您使用的 gem 显然还没有更新为与 Ruby 1.9 一起使用。

[消息人士](http://www.ruby-forum.com/topic/203985)称，gem 中可能存在其他不兼容问题。

# php - Jquery返回ObjectObject，前两个字段按预期返回

> ID：14753060
> 
> 赞同：1
> 
> 时间：2013-02-07T14:07:00.270
> 
> 标签：php, ajax, forms, jquery

我想知道是否有人可以帮助我，因为我今天*已经用*谷歌搜索了很长时间，但还没有找到任何可以解决我的问题的方法。我看过的网站提到这是因为它返回 JSON，但他们在所有领域都得到它，而不仅仅是一个。但我不明白的是，为什么前两个字段也不行？因此我的困惑

我正在提交一个登录表单，使用 Jquery 和 AJAX（我知道这一点）。

前两个字段（email 和 pass）提交，并按预期返回。出于测试目的，我只是在`<span id="loginresponse"></span>`.

我有第三个字段，以防止 CSRF，称为“t”（将其命名为随机名称，看看这是否是问题 - 我仍然得到 [object Object] 返回）。`<input type="hidden" name="t" value="RandomToken"/>` 提交表单时，我希望它返回我在字段中输入的内容 - “电子邮件、密码和随机令牌”。相反，我得到了电子邮件，传递，[对象对象]。

这是我的 DoLogin 函数，在提交表单时调用。

```
function DoLogin()
    {
        var Email = $("#email").val();
        var Pass = $("#pass").val();
        var LoginResponse = $("#loginresponse");
        var T = $("#t");
        var EmailPlaceholder="Email address";var PassPlaceholder="Your password here";
        $.get('path/to/login_ajax.php?email='+Email+'&pass='+Pass+'&t='+T, function(data)
        {
          $('#loginresponse').html(data);
        });
        /*if(Email != EmailPlaceholder && Pass != PassPlaceholder && Email != "" && Email != " " && Pass !="" && Pass != " ")
        {

        }*/
    } 
```

这是我的 HTML 表单：

```
<form action="javascript:DoLogin();" method="post"><!--Also tried changing method to GET, still got the same problem --> 
<input  id="email" class="inputemail" type="text" name="email" size="40" value="Email     address" onclick="$(this).val('');"/><span>Your email</span><br/>
<input id="pass" class="inputpassword" type="password" name="pass" size="40" value="Your password here" onclick="$(this).val('');"/><span>Your password</span><br/>
<input id="t" type="hidden" name="t" value="RandomToken"/>
<input class="indexsubmit" type="submit" value="Login"/>
</form>
<span id="loginresponse"></span> 
```

最后，login_ajax.php

```
<?php
echo $_GET['email'].$_GET['pass'].$_GET['t'];
?> 
```

如上所述 - 我只是回显结果，因为我知道 Jquery 和 AJAX，所以我想检查所有字段是否按预期返回值，而一个不是......令牌字段.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:09:02.093

您`T`将输入元素的对象而*不是*元素的值链接到 GET 请求的查询字符串。

你应该改变这一行

```
var T = $("#t"); // The object of the input element 
```

对此

```
var T = $("#t").val(); // The value of the input element 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T14:10:11.157

也许你想要的是：

```
var T = $("#t").val(); 
```

# excel - 在谷歌中使用邮政编码查找距离

> ID：14753064
> 
> 赞同：0
> 
> 时间：2013-02-07T14:07:10.197
> 
> 标签：excel, vba

我有这个 VBA 脚本，我一直试图让它通过单击按钮给我距离

工作表名称是`inputwks`，我已经定义了名为`C_post`和的单元`D_post`格`Miles`。我试图`C01`在 VBA 脚本`C_post`中设置`C02`为`D_post``Miles`

子获取距离（）

```
Dim inputWks As Worksheet
Dim c01 As Range
Dim c02 As Range
Dim Miles As Range
Dim distance As Range

'Set distance = inputWks.Range("Miles")

Set c01 = inputWks.Range("C_post")
Set c02 = inputWks.Range("D_post")
'Set Miles = inputWks.Range("Miles")

Application.EnableEvents = False

'c01 As String, c02 As String) As Double
With inputWks

With CreateObject("MSXML2.XMLHTTP")
    .Open "Get", "http://maps.google.co.uk/maps?f=d&source=s_d&saddr=" & c01 & "&daddr=" & c02
    .send

Do: DoEvents: Loop Until .readyState = 4

     If InStr(.responseText, "mi</span>") <> 0 Then _
         distance = Val(Split(Split(Split(.responseText, "<div class=""dir-altroute-inner"">")(1), "<span>")(1), "</span>")(0))
    .abort
End With

End With

inputWks.Range("Miles") = distance
Application.EnableEvents = True

End Sub 
```

原来的马可看起来像这样

```
Public Function Getdistance(c01 As String, c02 As String) As Double
With CreateObject("MSXML2.XMLHTTP")
    .Open "Get", "http://maps.google.co.uk/maps?f=d&source=s_d&saddr=" & c01 & "&daddr=" & c02
    .send

Do: DoEvents: Loop Until .readyState = 4

If InStr(.responseText, "mi</span>") <> 0 Then _
    Getdistance = Val(Split(Split(Split(.responseText, "<div class=""dir-altroute-inner"">")(1), "<span>")(1), "</span>")(0))
.abort
End With
End Function
    Application.EnableEvents = True
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T09:15:39.487

我已经做到了这里是答案

子获取距离（）

```
Dim inputWks As Worksheet
Dim c01 As Range
Dim c02 As Range
Dim Miles As Range
Dim distance As Long

'Set distance = inputWks.Range("Miles")

Set inputWks = Worksheets("Input")
Set c01 = inputWks.Range("C_post")
Set c02 = inputWks.Range("D_post")
Set Miles = inputWks.Range("Miles")

Application.EnableEvents = False

With inputWks

With CreateObject("MSXML2.XMLHTTP")
    .Open "Get", "http://maps.google.co.uk/maps?f=d&source=s_d&saddr=" & c01 & "&daddr=" & c02
     .send

Do: DoEvents: Loop Until .readyState = 4

  If InStr(.responseText, "mi</span>") <> 0 Then _
         distance = Val(Split(Split(Split(.responseText, "<div class=""dir-altroute-inner"">")(1), "<span>")(1), "</span>")(0))
     .abort
End With

End With

    Miles = distance
    Application.EnableEvents = True 
```

结束子

# sql - SQL LIKE 查询返回一行

> ID：14753070
> 
> 赞同：1
> 
> 时间：2013-02-07T14:07:30.037
> 
> 标签：sql

为什么以下查询返回一行：

```
select * from (
select 'th' As Test1) as Test
where Test1 like '%þ%' 
```

我正在使用以下排序规则：`Latin1_General_CI_AS`

`þ`被评估为`LIKE th`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:12:39.980

您的所有问题都在 Wikipedia的[此链接上得到解答。](http://en.wikipedia.org/wiki/Thorn_%28letter%29)`th`在您使用的排序规则中，Thorn 字母和有向字母被认为是相同的。它的声音类似于希腊的 theta 字符`θ`。

# objective-c - 表格单元格中的闪烁图像

> ID：14753071
> 
> 赞同：1
> 
> 时间：2013-02-07T14:07:29.833
> 
> 标签：objective-c, xcode, uitableview

我想在表格单元格中有一个闪烁的图像（在两个图像之间交换）。

对我来说最自然的情况如下：

*   将 NSTimer 设置为每 0.5 秒运行一次，调用 -blink：
*   在 -blink 中：我打开/关闭一个 blinkStatus 变量
*   在 -cellForRowAtIndexPath: 中，我根据 blinkStatus 设置图像

现在，我还在 -blink: 方法中调用 [myTableView reloadData]，因此认为得到更新。

这似乎是有道理的；单元格的状态*实际上*正在改变（图像正在改变），因此更新表格是有意义的。

这行得通。 *但是*，reloadData 似乎会干扰用户交互：

在表格编辑模式下，如果用户选择（-）删除，并出现 Delete 按钮，当 reloadData 发生时它会消失。如果 [myTableView.editing] 为假，则仅执行 reloadData 就很容易了。（而且在编辑模式下不闪烁也不是什么大问题。）

然而，reloadData 似乎仍然把事情搞砸了（例如清除单元格选择）。我还担心每 0.5 秒调用一次 reloadData 的效率。

有没有更流畅的方法让图像闪烁？我正在考虑保存指向任何闪烁单元格的指针，并更新计时器中的 .image 属性。但这似乎是个坏主意，因为单元格被重复用于表的不同行（哎哟），我怀疑简单地更新 .image 属性会在没有 reloadData 的情况下更新表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:18:54.797

你应该只在方法中切换图像`-blink`，只要你使用正确的接口（例如`cell.imageView.image`），图像就会自动更新，无需调用`reloadData`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:23:57.867

你试过使用`[UIImageView animationImages]`财产吗？只需提供您的图像，设置所需的持续时间和动画重复计数并调用 startAnimating

# php - 暂停 foreach 并继续

> ID：14753076
> 
> 赞同：-1
> 
> 时间：2013-02-07T14:07:45.497
> 
> 标签：php, mysql, loops, foreach, mysqli

我正在尝试从 api 循环数据，然后将这些值发布到 MySQL db。

像这样的东西：

```
$values = json_decode(file_get_contents("my-json-file"));

$SQL = new mysqli(SQL_HOST, SQL_USER, SQL_PASS, DB_NAME);
$SQL->autocommit(FALSE);

foreach($values As $item)
{
    $query = "INSERT INTO my_table VALUES ('".$item->value1."', '".$item->value2.";)";
    $SQL->query($query);
    if(!$SQL->commit())
    {
        echo "ERROR ON INSERT: [" . $query . "]<hr/>";
    }
}
$SQL->close(); 
```

由于循环太快，SQL 赶不上。（是的！）然后我需要这样的东西：

```
foreach($values As $item)
{
    /**** STOP/PAUSE LOOP ****/

    $query = "INSERT INTO my_table VALUES ('".$item->value1."', '".$item->value2.";");
    $SQL->query($query);
    if($SQL->commit())
    {
        /**** START THE LOOP AGAIN ****/
    }
    else
    {
        echo "ERROR ON INSERT: [" . $query . "]<hr/>";
    }
} 
```

或者我应该如何以正确的方式做到这一点？

编辑：它每次都会插入随机帖子。

编辑 2：这只是示例代码。它确实逃脱了所有这些，是的，分号在这里是错误的，但是由于有很多评论，我不会改变它。这不是真实案例中的问题。我试图在另一台服务器上运行它并且它在那里工作。该问题已通过重新启动 MAMP 得到解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:27:34.243

首先，您认为循环运行得太快以至于 MySQL 跟不上的想法是完全错误的。该`$SQL->query()`调用将在继续之前等待 MySQL 返回响应，因此循环运行的速度不会比 MySQL 响应的速度快。

现在到实际问题....您的查询：

```
$query = "INSERT INTO my_table VALUES ('".$item->value1."', '".$item->value2.";)"; 
```

末尾有一个分号，后面`value2`是无效的。我猜你打算在那里输入引号？分号将导致您的所有查询失败并引发错误。

这可能是您的问题的原因，但您没有在那里检查任何错误，所以您不会知道。调用查询后向您的代码添加一些错误检查；即使查询是正确的，仍然可能出现错误，您的代码应该检查它们。请参阅本手册页上的示例：[http ://www.php.net/manual/en/mysqli-stmt.error.php](http://www.php.net/manual/en/mysqli-stmt.error.php)

最后，由于您使用的是 mysqli API，因此值得一提的是，如果您使用准备好的语句，您的代码会更好，并且可能更安全。在此处查看 PHP 手册中的示例：[http ://www.php.net/manual/en/mysqli-stmt.bind-param.php](http://www.php.net/manual/en/mysqli-stmt.bind-param.php)

[编辑]

您的查询失败的另一个可能原因是您没有转义输入值。如果任何输入值包含引号字符（或任何其他在 SQL 中非法的字符），则查询将失败。此外，此问题使您的代码容易受到 SQL 注入黑客攻击。

您需要`$SQL->real_escape_string()`通过将查询更改为使用准备好的语句（如上所述）来使用 OR 转义您的输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:10:35.150

您的查询在循环内，这意味着循环将等到您的查询完成执行后再继续，php代码按顺序处理...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:29:57.690

@phpalix 说过，PHP 按顺序进行，并等待上一个操作完成。

我认为你的 SQL 是错误的。尝试用这个替换你的 INSERT：

```
$query = "INSERT INTO my_table VALUES ('".$item->value1."', '".$item->value2."');"; 
```

并且不要忘记为每个变量至少运行**mysql_real_escape_string**以采取安全措施。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T14:40:56.537

正如许多答案和评论所说，在 SQL 完成之前它不会继续。问题出在我的本地 apache/mysql 服务器上。通过重新启动它已修复。是的，愚蠢的帖子。

# xml - 如何从 Magento 以 XML 格式发布值

> ID：14753082
> 
> 赞同：0
> 
> 时间：2013-02-07T14:08:02.127
> 
> 标签：xml, magento, soap, payment-gateway

我正在尝试创建一个重定向到 Chase paymentech DPP 的自定义支付网关。当我收到此错误消息时，模块一直在工作，直到我到达网关：

此 XML 文件似乎没有任何与之关联的样式信息。文档树如下所示。

```
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:ns="urn:ws.paymentech.net/PaymentechGateway">
<SOAP-ENV:Body id="_0">
<SOAP-ENV:Fault SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
<faultcode>SOAP-ENV:VersionMismatch</faultcode>
<faultstring>SOAP version mismatch or invalid SOAP message</faultstring>
<SOAP-ENV:Code/>
</SOAP-ENV:Fault>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

我不确定它是否与格式化表单以以正确的格式（即 XML）发布有关，所以想就如何以正确的格式发布值征求一些建议

这是我的名为 redirect.phtml 的表单，它重定向到支付网关。

```
<?php 
    $session = Mage::getSingleton('checkout/session');
    $orderIncrementId = $session->getLastRealOrderId();
    $order = Mage::getModel('sales/order')->loadByIncrementId($orderIncrementId);
    $billingaddress = $order->getBillingAddress();
    $shippingaddress = $order->getShippingAddress();
    $currencyDesc = Mage::app()->getStore()->getCurrentCurrencyCode();
    $totals = number_format($order->getGrandTotal(), 2, '.', ''); 
    $address = $billingaddress->getStreet();
    $address1 = $shippingaddress->getStreet();
    $data = array(
    'api_username' => trim(Mage::getStoreConfig('payment/redirect/api_username')),
    'api_password' => trim(Mage::getStoreConfig('payment/redirect/api_password')),
    'Merchant_ID' => trim(Mage::getStoreConfig('payment/redirect/Merchant_ID')),
    'Terminal_ID' => trim(Mage::getStoreConfig('payment/redirect/Terminal_ID')),
    'BIN_Number' => trim(Mage::getStoreConfig('payment/redirect/BIN_Number')),
    'Amount' => $totals,
    'billing_cust_name' =>$order->getCustomerFirstname(), 
    'billing_last_name'=>$order->getCustomerLastname(),
    'billing_cust_tel_No' => $billingaddress->getTelephone(),
    'billing_cust_email'=>$order->getCustomerEmail(),
    'billing_cust_address'=>$address[0] . ' '.$address[1],
    'billing_cust_city'=>$billingaddress->getCity(),
    'billing_cust_country'=>$billingaddress->getCountryId(),
    'billing_cust_state'=>$billingaddress->getRegion(),
    'billing_cust_zip' =>$billingaddress->getPostcode(),
    'delivery_cust_name' =>$shippingaddress->getCustomerFirstname(),
    'delivery_last_name'=>$shippingaddress->getCustomerLastname(),
    'delivery_cust_tel_No' => $shippingaddress->getTelephone(),
    'delivery_cust_email'=>$shippingaddress->getCustomerEmail(),
    'delivery_cust_address'=>$address1[0] . ' '.$address1[1],
    'delivery_cust_city'=>$shippingaddress->getCity(),
    'delivery_cust_country'=>$shippingaddress->getCountryId(),
    'delivery_cust_state'=>$shippingaddress->getRegion(),
    'delivery_cust_zip' =>$shippingaddress->getPostcode(),
    'Order_Id' => $order->getIncrementId(),
    'TxnType' => 'A',
    'actionID' => 'TXN',
    'Currency' => 'GBP',
    );

?>
<form action="https://wsvar.paymentech.net/PaymentechGateway" method="post" id="chase">
    <?php foreach($data as $key => $value): ?>
        <input type='hidden' name='<?php echo $key?>' value='<?php echo $value;?>' />
    <?php endforeach;?>
    <input type="submit" class="btn btn-success btn-large" value='Complete my order!'/> 
</form>
<?php echo $this->__('If Page Doesn\'t Redirect In 5 Sectonds, Please press Buy button');?>
<script type="text/javascript">
    function myfunc () {
    var frm = document.getElementById("chase");
    frm.submit();
    }
    window.onload = myfunc;
</script> 
```

标准.php

```
<?php
class Custom_Gateway_Model_Standard extends Mage_Payment_Model_Method_Abstract {
    protected $_code = 'chase';
    protected $_isInitializeNeeded      = true;
    protected $_canUseInternal          = true;
    protected $_canUseForMultishipping  = false;

    public function getOrderPlaceRedirectUrl() {
    return Mage::getUrl('chase/payment/redirect', array('_secure' => true));
    }

    //create xml and send info to gateway
    private function callApi(Varien_Object $payment, $amount,$type){

    //call your authorize api here, incase of error throw exception.
    //only example code written below to show flow of code

    $order = $payment->getOrder();
    $types = Mage::getSingleton('payment/config')->getCcTypes();
    if (isset($types[$payment->getCcType()])) {
    $type = $types[$payment->getCcType()];
    }
    $billingaddress = $order->getBillingAddress();
    $totals = number_format($amount, 2, '.', '');
    $orderId = $order->getIncrementId();
    $currencyDesc = $order->getBaseCurrencyCode();

    $url = $this->getConfigData('gateway_url');
    $fields = array(
            'api_username'=> $this->getConfigData('api_username'),
            'api_password'=> $this->getConfigData('api_password'),
            'Merchant_ID'=> $this->getConfigData('Merchant_ID'),
            'Terminal_ID'=> $this->getConfigData('Terminal_ID'),
            'BIN_Number'=> $this->getConfigData('BIN_Number'),
            'customer_firstname'=> $billingaddress->getData('firstname'),
            'customer_lastname'=> $billingaddress->getData('lastname'),
            'customer_phone'=> $billingaddress->getData('telephone'),
            'customer_email'=> $billingaddress->getData('email'),
            'customer_ipaddress'=> $_SERVER['REMOTE_ADDR'],
            'bill_firstname'=> $billingaddress->getData('firstname'),
            'bill_lastname'=> $billingaddress->getData('lastname'),
            'Bill_address1'=> $billingaddress->getData('street'),
            'bill_city'=> $billingaddress->getData('city'),
            'bill_country'=> $billingaddress->getData('country_id'),
            'bill_state'=> $billingaddress->getData('region'),
            'bill_zip'=> $billingaddress->getData('postcode'),
            'customer_cc_expmo'=> $payment->getCcExpMonth(),
            'customer_cc_expyr'=> $payment->getCcExpYear(),
            'customer_cc_number'=> $payment->getCcNumber(),
            'customer_cc_type'=> strtoupper($type),
            'customer_cc_cvc'=> $payment->getCcCid(),
            'merchant_ref_number'=> $order->getIncrementId(),
            'currencydesc'=>$currencyDesc,
            'amount'=>$totals
    );

    $fields_string="";
    foreach($fields as $key=>$value) {
    $fields_string .= $key.'='.$value.'&';
    }
    $fields_string = substr($fields_string,0,-1);
    //open connection
    $ch = curl_init($url);
    //set the url, number of POST vars, POST data
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_POST,1);
    curl_setopt($ch, CURLOPT_POSTFIELDS,$fields_string);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION ,1);
    curl_setopt($ch, CURLOPT_HEADER ,0); // DO NOT RETURN HTTP HEADERS
    curl_setopt($ch, CURLOPT_RETURNTRANSFER ,1); // RETURN THE CONTENTS OF THE CALL
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 120); // Timeout on connect (2 minutes)
    //execute post
    $result = curl_exec($ch);
    curl_close($ch);

    return array('status'=>1,'transaction_id' => time() , 'fraud' => rand(0,1));
  }
}
?> 
```

授权.php

```
 protected function _getTransactionDetails($transactionId)
    {
        $requestBody = sprintf(
            '<?xml version="1.0" encoding="utf-8"?>'
            . '<getTransactionDetailsRequest xmlns="AnetApi/xml/v1/schema/AnetApiSchema.xsd">'
            . '<merchantAuthentication><name>%s</name><transactionKey>%s</transactionKey></merchantAuthentication>'
            . '<transId>%s</transId>'
            . '</getTransactionDetailsRequest>',
            $this->getConfigData('login'),
            $this->getConfigData('trans_key'),
            $transactionId
        );

        $client = new Varien_Http_Client();
        $uri = $this->getConfigData('cgi_url_td');
        $client->setUri($uri ? $uri : self::CGI_URL_TD);
        $client->setConfig(array('timeout'=>45));
        $client->setHeaders(array('Content-Type: text/xml'));
        $client->setMethod(Zend_Http_Client::POST);
        $client->setRawData($requestBody);

        $debugData = array('request' => $requestBody);

        try {
            $responseBody = $client->request()->getBody();
            $debugData['result'] = $responseBody;
            $this->_debug($debugData);
            libxml_use_internal_errors(true);
            $responseXmlDocument = new Varien_Simplexml_Element($responseBody);
            libxml_use_internal_errors(false);
        } catch (Exception $e) {
            Mage::throwException(Mage::helper('paygate')->__('Payment updating error.'));
        }

        $response = new Varien_Object;
        $response
            ->setResponseCode((string)$responseXmlDocument->transaction->responseCode)
            ->setResponseReasonCode((string)$responseXmlDocument->transaction->responseReasonCode)
            ->setTransactionStatus((string)$responseXmlDocument->transaction->transactionStatus)
        ;
        return $response;
    }

Thanks in advance 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:43:13.773

据我所知，您应该只使用其中一种方法（而不是两种方法），因为它们代表两种不同类型的网关。

```
public function getOrderPlaceRedirectUrl() {
return Mage::getUrl('chase/payment/redirect', array('_secure' => true));
}

//create xml and send info to gateway
private function callApi(Varien_Object $payment, $amount,$type){ 
```

我建议使用此示例重新开始（我不确定“Standard.php”和“Authorize.php”的作用）[http://www.excellencemagentoblog.com/magento-create-custom-payment-method-api -基于](http://www.excellencemagentoblog.com/magento-create-custom-payment-method-api-based)并做出改变`callApi`

也看看

`protected function _postRequest(Varien_Object $request)`

`protected function _buildRequest(Varien_Object $payment)`

在

```
/app/code/core/Mage/Paygate/Model/Authorizenet.php 
```

# linux - 如何让emacs控制台模式继承shell颜色

> ID：14753094
> 
> 赞同：5
> 
> 时间：2013-02-07T14:08:40.807
> 
> 标签：linux, ubuntu, emacs

我刚刚将我的 Ubuntu 笔记本电脑从 12.04 升级到 12.10。

在 12.04 中，使用终端配色方案（背景、前景、...，尤其是它保持我的透明终端背景）在终端模式下`emacs -nw`运行。`emacs`

现在在 12.10 中，运行相同的命令会导致在终端中以其他配色方案（灰色背景）打开 emacs。如何告诉 emacs 保留我的终端配色方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T11:25:51.557

感谢[https://stackoverflow.com/users/774691/john-k-doe](https://stackoverflow.com/users/774691/john-k-doe)的评论，我终于明白了我为什么会`emacs -nw`出现这样的原因。

`emacs`我在一个窗口中编辑了字体大小（默认面） （在没有`-nw`选项的情况下启动），然后使用菜单条目保存了这个新设置`Options -> Save Options`。此操作修改了我的`~/.xemacs/custom.el`文件中默认加载的`~/.emacs`文件。修改包括默认面的背景和前景属性，其值在“窗口”模式下使用。

为了解决这个问题，我刚刚从`custom.el`文件中删除了这个自定义条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T17:34:11.663

我不确定是否有一个明智的答案。毕竟，gnome 终端颜色主题列出了三种“颜色”：（1）文本，（2）背景（3）粗体。

Emacs 的工作方式是为每一位文本赋予一个“面孔”。颜色主题是面到颜色的映射。有不止三张脸...

# shell - 根据第一个数值排序文件列表

> ID：14753095
> 
> 赞同：2
> 
> 时间：2013-02-07T14:08:42.343
> 
> 标签：shell, unix, sorting, sed, awk

我是 Unix 新手。我需要一些帮助来对文件名进行排序。我有一个文件列表如下：

```
FILE10_11_9_1_C.sql 
FILE11_11_9_1_P.sql 
LE12_11-9-1-P.sql 
FILE13_11-9-1-P.sql 
FILE14_11_9_1_P.sql 
E15_11_9_1_P.sql 
FILE16_11_9_1_P.sql 
FILE17_11_9_1_U.sql 
FILE17_11_9_1_U.sql 
FILE5_11_9_1_A.sql 
FILE7_PKG_C.sql 
FILE8_PKG_CV.sql 
Fi1_11_9_1_E.sql 
File2_11_9_1_E.sql 
File3_11_9_1_C.sql 
FILE4_11_9_1_P.sql 
```

我想对它进行数字排序，直到遇到第一个下划线（数字可以在任何位置，而不是在第 5 位）。例如 - 如下：

```
File1_11_9_1 
File2_11_9_1 
. 
. 
. 
File8_Pkg 
File10_11_9_1 
```

我正在尝试，`ls -1|sort -t"_" -k1,4n` 但这似乎不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:28:17.050

```
$ sort -k1.5n file
File1_11_9_1_E.sql
File2_11_9_1_E.sql
File3_11_9_1_C.sql
FILE4_11_9_1_P.sql
FILE5_11_9_1_A.sql
FILE7_PKG_C.sql
FILE8_PKG_CV.sql
FILE10_11_9_1_C.sql
FILE11_11_9_1_P.sql
FILE12_11-9-1-P.sql
FILE13_11-9-1-P.sql
FILE14_11_9_1_P.sql
FILE15_11_9_1_P.sql
FILE16_11_9_1_P.sql
FILE17_11_9_1_U.sql
FILE17_11_9_1_U.sql 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:27:10.750

好吧，我有点懒得记住排序花哨的选项。

只需结合 linux 电源文本处理程序来实现它。必须有更优雅的方式来做到这一点。但这不需要太多思考就可以工作

```
your ls...|awk -F'[Ee_]' '{print $2" "$0}'|sort -n|sed -r 's/[0-9]+ //' 
```

**编辑**

添加一个纯 awk 单线：

```
ls...|awk -F'[Ee_]' '{a[NR]=$2;b[$2]=$0;}END{n=asort(a);for(i=1;i<=n;i++)print b[a[i]]}' 
```

像这样工作：

```
kent$  echo "FILE10_11_9_1_C.sql 
FILE11_11_9_1_P.sql 
FILE12_11-9-1-P.sql 
FILE13_11-9-1-P.sql 
FILE14_11_9_1_P.sql 
FILE15_11_9_1_P.sql 
FILE16_11_9_1_P.sql 
FILE17_11_9_1_U.sql 
FILE17_11_9_1_U.sql 
FILE5_11_9_1_A.sql 
FILE7_PKG_C.sql 
FILE8_PKG_CV.sql 
File1_11_9_1_E.sql 
File2_11_9_1_E.sql 
File3_11_9_1_C.sql 
FILE4_11_9_1_P.sql"|awk -F'[Ee_]' '{print $2" "$0}'|sort -n|sed -r 's/[0-9]+ //' 
File1_11_9_1_E.sql 
File2_11_9_1_E.sql 
File3_11_9_1_C.sql 
FILE4_11_9_1_P.sql
FILE5_11_9_1_A.sql 
FILE7_PKG_C.sql 
FILE8_PKG_CV.sql 
FILE10_11_9_1_C.sql 
FILE11_11_9_1_P.sql 
FILE12_11-9-1-P.sql 
FILE13_11-9-1-P.sql 
FILE14_11_9_1_P.sql 
FILE15_11_9_1_P.sql 
FILE16_11_9_1_P.sql 
FILE17_11_9_1_U.sql 
FILE17_11_9_1_U.sql 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:32:48.170

在第 5 个字符上尝试`ls -1 | sort -t _ -k1.5,1n`这种排序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-11T06:46:03.070

假设您的文件名不以数字开头，这是使用`GNU awk`. 它将按下划线前的第一个数字排序，然后按出现顺序排序。同样一般来说，解析`ls`是[一个坏主意](http://mywiki.wooledge.org/ParsingLs)，尽管它会与您的文件名一起“工作”。我更喜欢使用`GNU find`. 像这样运行：

```
awk -f script.awk <(find ./* -maxdepth 1 -type f -name "*.sql" -printf "%f\n") 
```

内容`script.awk`：

```
BEGIN {
    FS="[^0-9]+"
}

{
    a[$2] = (a[$2] ? a[$2] ORS : "") $0
}

END {
    for (i in a) {
        b[j++]=i+0
    }

    n = asort(b)

    for (k=1;k<=n;k++) {
        print a[b[k]]
    }
} 
```

结果：

```
Fi1_11_9_1_E.sql 
File2_11_9_1_E.sql 
File3_11_9_1_C.sql 
FILE4_11_9_1_P.sql 
FILE5_11_9_1_A.sql 
FILE7_PKG_C.sql 
FILE8_PKG_CV.sql 
FILE10_11_9_1_C.sql 
FILE11_11_9_1_P.sql 
LE12_11-9-1-P.sql 
FILE13_11-9-1-P.sql 
FILE14_11_9_1_P.sql 
E15_11_9_1_P.sql 
FILE16_11_9_1_P.sql 
FILE17_11_9_1_U.sql 
FILE17_11_9_1_U.sql 
```

或者，这是单线：

```
awk -F "[^0-9]+" '{ a[$2] = (a[$2] ? a[$2] ORS : "") $0 } END { for (i in a) b[j++]=i+0; n = asort(b); for (k=1;k<=n;k++) print a[b[k]] }' <(find ./* -maxdepth 1 -type f -name "*.sql" -printf "%f\n") 
```

# python - 如何使用 RE 查找出现在某些文本之后的字符串？

> ID：14753096
> 
> 赞同：0
> 
> 时间：2013-02-07T14:08:43.437
> 
> 标签：python, regex

我有许多包含一些我需要提取的字符串的大文件。数据如下：

```
"text":"string","token":"1357580140-7","display_token":0,"display_ttl":1357828250,"coeff2_ts":"2013-01-08","timestamp":1357845041}} 
```

我做了一些研究，并决定RE是最好的。我只需要打印出“字符串”而不是“文本”：位。所需的输出将只是“字符串”

```
def regEx():
os.chdir("C:/Users/Luke/Desktop/FilesWithString")
files = os.listdir(".")
for x in files:
    re.search(r'(?<="text":)("[^"]+")',x).group(0) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:11:21.653

你可以使用一个lookbehind：

```
your_string = '"text":"string"'
match = re.search(r'(?<=:)("[^"]+")',your_string)
if match:
    print match.group(0) #'"string"' 
```

这将捕获紧跟在双引号中的任何内容`:`。

作为旁注，使用您更新的字符串，它看起来非常像`JSON`- 或者`ast.literal_eval`可以处理的东西。如果是这种情况，您可以使用其中任何一个将其评估为字典，您只需下标即可获取字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:34:19.430

您有一个 JSON 字符串，只需使用[`json`模块](http://docs.python.org/2/library/json.html)将其解码为 Python 结构：

```
import json

data = json.loads(inputstring)

print data['somekey']['token']
print data['somekey']['display_ttl'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:11:04.457

您可以更快地完成它而无需重新：

```
s = '"text":"string"'
print s[7:]
>>> "string" 
```

如果`text`部分沿不同的线变化，您可以测量它的长度 - 通过在冒号上分割线并取第一部分：

```
s = '"a text":"a string"'
s[len(s.split('":')[0]) + 2:]
>>> '"a string"' 
```

或者更有效地使用`index`函数：

```
s = '"a text":"a string"'
s[s.index('":') + 2:]
>>> '"a string"' 
```

# javascript - 使用 jQuery 检测内联背景样式

> ID：14753102
> 
> 赞同：2
> 
> 时间：2013-02-07T14:09:04.327
> 
> 标签：javascript, jquery, css, background, inline

我有一个`<div>`有时会`background`应用一个内联属性。

我希望能够检查是否附加了*内联*样式，如果有，那么我想继续附加一个`background-position`.

有没有一种方法可以明确检查应用于的内联背景`$(this)`？

```
if ($(this).css('background').length > 0) { 
   console.log('has a background'); 
   // set a background position
   $(this).css('background-position', 'center 22px');
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T14:18:03.703

我敢打赌这样的事情可能会奏效

```
if($(this).attr("style").indexOf("background") >=0){
  //we have inline background styles!
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:18:44.807

您可以使用测试内联样式`prop`

```
if ($(this).prop('style').backgroundImage) {
  //.. do what you want to
} 
```

# wso2 - 如何从 WSO2 身份服务器刷新 SAML 断言信息？

> ID：14753104
> 
> 赞同：5
> 
> 时间：2013-02-07T14:09:09.317
> 
> 标签：wso2, saml-2.0, wso2is, assertion

我正在为 Web 应用程序构建基于 SAML 2.0 的身份验证。身份验证是针对 WSO2 身份服务器 (WSO2-IS) 完成的。我已经设法使用 HTTP 重定向来进行实际的身份验证。但是现在我在尝试从身份服务器“刷新”身份验证信息时遇到问题。

问题是 WSO2-IS 返回的断言只有 5 分钟的生命周期。因此，基于此，我应该每 5 分钟从 WSO2-IS 获得一个新断言。但是，除了进行另一轮重定向之外，我没有发现其他方法可以针对 WSO2-IS 执行此操作。每五分钟将用户重定向到其他地方对用户来说不是很友好。

SAML 2.0 指定了一个 AuthnQuery 请求，该请求应该使用 SOAP over HTTP 来完成。如果我理解正确，AuthnQuery 正是我为用户重新请求断言信息所需要的，但对我来说，WSO2-IS 似乎不支持这个请求。

所以，问题是，我如何能够刷新（或重新请求）来自 WSO2 身份服务器的断言信息，而无需将用户重定向到他们当前正在访问的页面之外？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T14:12:06.093

答案可以在 Web 浏览器 SSO 配置文件 -> 使用和消息处理规则下的 SAML 配置文件规范中找到。

> 上面描述的承载元素必须包含一个元素，该元素包含一个包含服务提供者的断言消费者服务 URL 的 Recipient 属性和一个限制可以传递断言的窗口的 NotOnOrAfter 属性

NotOnOrAfter 是必须传递消息的时间。

你应该考虑的是它是否存在的属性`SessionNotOnOrAfter`。`AuthnStatement`

> 如果用于为主体建立安全上下文的一个包含 SessionNotOnOrAfter 属性，则一旦达到此时间，安全上下文应该被丢弃，除非服务提供者通过重复使用此配置文件来重新建立主体的身份。

[SAML 配置文件规范](http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:55:00.067

我不确定你是否可以使用它。这是来自 SAML 规范

> 消息元素用于查询“哪些包含身份验证语句的断言可用于该主题？” 一个成功的将包含一个或多个包含身份验证语句的断言。
> 
> 该消息不得用作使用请求中提供的凭据进行新身份验证的请求。是对在指定主体和认证机构之间的先前交互中发生的认证行为的陈述的请求。

您正在谈论断言上的 NotOnOrAfter 约束，对吗？据我了解，这只是为了当您不再信任该消息时。我您在那之前读过它，您可以认为用户已通过身份验证。这通常是为了防止重放攻击。

# javascript - DOM.Selection 的 anchorOffset 属性

> ID：14753110
> 
> 赞同：0
> 
> 时间：2013-02-07T14:09:25.183
> 
> 标签：javascript, dom, selection

此链接中的信息是否准确？

[https://developer.mozilla.org/en-US/docs/DOM/Selection](https://developer.mozilla.org/en-US/docs/DOM/Selection)

根据这份文件：

> anchorOffset：返回选择的锚点在 anchorNode 内偏移的字符数。

尝试使用 FireFox，似乎定义并不总是正确的。有时，偏移属性似乎代表一定数量的子节点。根据初步测试，以下代码**有效**：

```
var sel = window.getSelection() ;
var points = new Array( 0, 0 ) ;
var offset = new Array( sel.anchorOffset, sel.focusOffset ) ;
var nodes = new Array( sel.anchorNode, sel.focusNode ) ;

if ( isText )
    points = offset ;

for ( j = 0 ; j < 2 && ! isText ; j++ ) {
    var kids = nodes[j].childNodes ;
    for ( var i = 0 ; i < offset[j] ; i++ )
        points[j] += kids[i].textContent.length ;
    } 
```

首先，其他人有这种经验吗？其次，我仍在尝试寻找一种可靠的方法来确定*isText*的值。

在某些方面，这篇文章部分是一个问题，部分是一个答案。希望评论将反映新的细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:37:27.107

MDN 的定义是错误的**[UDPATE: I have correct MDN now]**。`anchorOffset`and `anchorNode`(and `focusNode`and `focusOffset`) 就像[Range](https://developer.mozilla.org/en-US/docs/DOM/range)边界一样工作：偏移量是文本节点（文本、字符数据和注释节点）内的字符数或`anchorNode`所有其他节点类型中选择锚点之前的子节点数。实际上，正如您所观察到的，选择边界并不总是在文本节点内。一个明显的例子是当插入符号位于两个相邻图像之间时（插入符号由管道字符表示）：

```
<div contenteditable="true"><img src="1.png">|<img src="2.png"></div> 
```

Also, Firefox often returns selection boundaries as offsets within elements, especially when a selection selects a whole block element (such as a `<p>`). 其他浏览器不倾向于这样做，而是更喜欢在文本节点内返回偏移量。

至于`isText`，如果我理解正确，完整的实现将类似于以下内容，取自我自己的代码：

```
function isCharacterDataNode(node) {
    var t = node.nodeType;
    return t == 3 || t == 4 || t == 8 ; // Text, CDataSection or Comment
} 
```

# c# - 如何使用 NewtonSoft JsonConvert 反序列化名称中带有破折号（“-”）的属性？

> ID：14753113
> 
> 赞同：42
> 
> 时间：2013-02-07T14:09:29.260
> 
> 标签：c#, json, json.net

我们有一个 JSON 对象，其中一个对象的名称中有一个破折号。例如下面。

```
{
    "veg": [
        {
            "id": "3",
            "name": "Vegetables",
            "count": "25"
        },
        {
            "id": "4",
            "name": "Dal",
            "count": "2"
        },
        {
            "id": "5",
            "name": "Rice",
            "count": "8"
        },
        {
            "id": "7",
            "name": "Breads",
            "count": "6"
        },
        {
            "id": "9",
            "name": "Meals",
            "count": "3"
        },
        {
            "id": "46",
            "name": "Extras",
            "count": "10"
        }
    ],
    "non-veg": [
        {
            "id": "25",
            "name": "Starters",
            "count": "9"
        },
        {
            "id": "30",
            "name": "Gravies",
            "count": "13"
        },
        {
            "id": "50",
            "name": "Rice",
            "count": "4"
        }
    ]
} 
```

我们如何反序列化这个json？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2015-11-28T22:40:09.620

要回答有关如何使用 NewtonSoft 执行此操作的问题，您将使用 JsonProperty 属性属性标志。

```
[JsonProperty(PropertyName="non-veg")]
public string nonVeg { get; set; } 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-02-07T14:18:55.523

您可以通过使用 DataContractJsonSerializer 来实现这一点

```
[DataContract]
public class Item
{
    [DataMember(Name = "id")]
    public int Id { get; set; }
    [DataMember(Name = "name")]
    public string Name { get; set; }
    [DataMember(Name = "count")]
    public int Count { get; set; }
}

[DataContract]
public class ItemCollection
{
    [DataMember(Name = "veg")]
    public IEnumerable<Item> Vegetables { get; set; }
    [DataMember(Name = "non-veg")]
    public IEnumerable<Item> NonVegetables { get; set; }
} 
```

现在你可以用这样的东西反序列化它：

```
string data;

// fill the json in data variable

ItemCollection collection;
using (MemoryStream ms = new MemoryStream(Encoding.Unicode.GetBytes(data)))
{
    DataContractJsonSerializer serializer = new DataContractJsonSerializer(typeof(ItemCollection));
    collection = (ItemCollection)serializer.ReadObject(ms);
} 
```

# tsql - 如何在 CAST/CONVERT 之前检查 VARCHAR(n) 以获取格式正确的 XML

> ID：14753119
> 
> 赞同：5
> 
> 时间：2013-02-07T14:09:36.180
> 
> 标签：tsql, validation, casting, xquery-sql

我的公司有一个记录表，其中包含一个`VARCHAR(N)`列，其中放置了一个*应该*是 XML 的字符串，但事实证明它并不总是格式正确的。为了对日志进行分析（以识别错误趋势等），我一直在使用一个`LIKE`语句。然而，这非常缓慢。

最近，我发现 SQL Server 支持 XQuery，所以我开始使用它。我遇到的问题是我无法找到一种方法来处理`CAST/CONVERT`我的`SELECT`陈述中的错误。我最接近的需要 SQL Server 2012，因为它具有该`TRY_CONVERT`功能，但现在不能从 2008 R2 升级。

这是我所拥有的（如果我的公司在 2012 年运行，这将起作用）：

```
CREATE FUNCTION IsMatch(
    @message AS VARCHAR(MAX),
    @match AS VARCHAR(MAX),
    @default AS VARCHAR(MAX))
RETURNS VARCHAR(MAX)
AS
BEGIN
    DECLARE @xml XML = TRY_CONVERT(XML, @message)
    DECLARE @result VARCHAR(MAX) =
        CASE WHEN @xml IS NOT NULL
             THEN CASE WHEN @xml.exist('(/FormattedMessage)[contains(.,sql:variable("@match"))]') = 1
                       THEN @match 
                       ELSE @default 
                       END
             ELSE CASE WHEN @message LIKE '%' + @match + '%'
                       THEN @match
                       ELSE @default
                       END
             END
    RETURN @result
END

GO

DECLARE @search VARCHAR(MAX) = 'a substring of my xml error message'

SELECT Error, COUNT(*) as 'Count'
FROM ( SELECT TOP 319 [LogID]
          ,[Severity]
          ,[Title]
          ,[Timestamp]
          ,[MachineName]
          ,[FormattedMessage]
          --,CAST([formattedmessage] as xml)
          ,IsMatch(@search, 'Other') as 'Error'
       FROM [MyDatabase].[dbo].[Log] (NOLOCK) ) a
GROUP BY Error 
```

一旦遇到格式错误的 XML ，注释的`CAST`（或替代的 a ）将导致查询出错。`CONVERT`如果我限制为 TOP (N)，我可以确保没有错误并且`SELECT`语句运行得非常快。我只需要一种方法来逐行处理错误。

我考虑过使用`TRY/CATCH`in `IsMatch()`，但不能在函数中使用。或者，要使用`TRY/CATCH`，我考虑了一个存储过程，但我不知道如何将它包含在我的`SELECT`子句中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:17:53.340

如果您被困在 2008 R2 上，我认为您想要做的是在存储过程中使用只读前向 CURSOR。然后在 WHILE @@FETCH_STATUS = 0 循环内使用 TRY CATCH 块。

```
DECLARE logcursor CURSOR FORWARD_ONLY READ_ONLY FOR 
SELECT TOP 319 [LogId]
          ,[formattedmessage]
       FROM [GenesisLogging].[dbo].[Log] (NOLOCK)

OPEN logcursor

FETCH NEXT FROM logcursor
INTO @id, @formattedmessage

WHILE @@FETCH_STATUS = 0
BEGIN
    BEGIN TRY
    SET @xml = CONVERT(xml, @formattedmessage)
    END TRY
    BEGIN CATCH
    PRINT @id
    END CATCH; 
    FETCH NEXT FROM logcursor 
    INTO @id, @formattedmessage
END 
CLOSE logcursor;
DEALLOCATE logcursor; 
```

# java - 在 .jar 中加载 freemarker 模板文件夹

> ID：14753125
> 
> 赞同：21
> 
> 时间：2013-02-07T14:09:48.863
> 
> 标签：java, maven, freemarker

我在我的应用程序中使用 freemarker 模板

在将我的应用程序部署到 jar 文件之前，为了加载我的模板，我需要做的就是：`cfg.setDirectoryForTemplateLoading(new File("templates"));`

它从我在项目中创建的模板文件夹中加载了所有模板。

现在，在迁移到 Maven 并将我的应用程序部署到可执行 jar 之后。应用程序再也找不到这个文件夹（我已经在 .jar 文件中检查过，并且“模板”文件夹部署在根目录中）

我已经尝试了我所知道的一切，但没有运气。

我现在应该如何加载所有模板？（我假设如果我将文件夹放在 .jar 文件之外但在同一目录中它将起作用。但这不是我想要的。）

谢谢。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-07T14:16:15.603

看一下

```
void setClassForTemplateLoading(Class cl, String prefix); 
```

...在[FreeMarker 手册中关于模板加载的章节](http://freemarker.sourceforge.net/docs/pgui_config_templateloading.html)中。

例子：

```
cfg.setClassForTemplateLoading(this.getClass(), "/templates"); 
```

...如果您的模板位于`templates`相对于当前类的根目录的包中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-02T19:50:04.837

```
Configuration cfg;
private Template template;  
    {
        cfg=new Configuration(); 
        try {
            cfg.setClassForTemplateLoading(this.getClass(), "/templates");
            template = cfg.getTemplate("template.ftl");
} 
```

这对我来说非常有效。这里我的模板文件夹包含 src/main/resources 包下的 template.ftl。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-25T06:38:54.077

上述的替代方案

```
cfg.setClassForTemplateLoading(this.getClass(), "/templates"); 
```

是

```
TemplateLoader ldr = new ClassTemplateLoader(classLoader, basePackagePath);
cfg.setTemplateLoader(ldr); 
```

如果您需要从 ftl 处理器所属的 jar 之外的其他 jar 加载内容，这将很有用。

然后调用`cfg.getTemplate(..)`可能会更方便，因为它们只需要相对于 ftl 的路径`basePackagePath`

# servlets - 什么时候应该使用开发模式？

> ID：14753131
> 
> 赞同：2
> 
> 时间：2013-02-07T14:10:09.673
> 
> 标签：servlets, websphere, rad

我正在使用 RAD 和 Websphere Application Server (WAS) 7.0 来开发 servlet 应用程序。我最近看到了引用的开发模式设置，并在管理控制台中找到了它。然而，在查找文档时，我只能在 Portal/Portlet 开发的上下文中找到对它的[引用](http://publib.boulder.ibm.com/infocenter/wpdoc/v6r1/index.jsp?topic=/com.ibm.wp.ent.doc_v615/install/chg_dev_mode.html)，而没有关于它对 WAS 的实际作用的详细信息。

什么时候应该使用开发模式，它对 WAS 做了什么样的改变？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T16:12:28.143

当您重视启动时间和内存占用而不是一般应用程序服务性能时，请使用它，例如，您只是将应用程序服务器用作测试环境。

它将 WebSphere Application Server 的调优参数设置为可以产生我提到的快速启动和较低内存的值——例如较低的最大堆。如果您想在以后获得更好的一般应用程序性能，您总是可以找到这些参数并更改它们。

# php - 以图片或 pdf 格式发送网页

> ID：14753133
> 
> 赞同：0
> 
> 时间：2013-02-07T14:10:15.127
> 
> 标签：php, image, pdf

我有一个包含网格的表单，客户可以在其中单击不同的单元格以直观地创建配置。完成后，必须有一封附有 PDF 或图像的电子邮件。

是否可以创建 div 或表单的图像或 PDF 并直接通过邮件发送，而无需先将其保存到客户端 PC？

# ms-access - 子窗体中的数据表视图查询确定父窗体上的控件状态

> ID：14753139
> 
> 赞同：0
> 
> 时间：2013-02-07T14:10:44.093
> 
> 标签：ms-access

我有一个搜索查询，它显示在数据表视图中的子表单中。

从这个子表单中选择记录时，我需要让用户单击一个按钮（用于跟踪目的）以访问表单其他部分的记录数据。目前，当查询运行（通过提交按钮）时，访问记录按钮设置为启用 = true。

这样做的问题是，如果搜索没有结果，访问记录按钮仍然可以点击并尝试访问不存在的记录；给我：“运行时错误 2427：您输入的表达式没有值”

如果查询没有返回结果或没有选择记录，有没有办法禁用该按钮？

编辑：此时按钮的代码。

```
Private Sub cmdSubmit_Click()
Me!SearchResults.Form.RecordSource = "qryPendingCriteriaCIP"
Me!SearchResults.Form.Requery
Me!SearchResults.Form.Visible = True

If Forms!frm_SearchMulti!SearchResults.Form.RecordCount > 0 Then

Me.cmdExport.Enabled = True
Me.SearchResults.Enabled = True

Me.cmdPass.Enabled = True
Else
Exit Sub
End If

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:20:04.183

是主窗体上的按钮吗？您的意思是要检查子窗体中是否有记录？

```
If Me.MySubformControlName.Form.Recordset.RecordCount>0 Then 
```

或检查一行：

```
If Me.MySubformControlName.txtID ... 
```

或检查查询：

```
If DCount("*","qryPendingCriteriaCIP")=0 Then
    MsgBox "No results"
Else
    Me.SearchResults.Form.RecordSource = "qryPendingCriteriaCIP"
End If 
```

# nsdate - NSDateFormatter 奇怪的 dateFromString 行为

> ID：14753140
> 
> 赞同：0
> 
> 时间：2013-02-07T14:10:45.390
> 
> 标签：nsdate, nsdateformatter

我使用 NSDateFormatter 从传入的字符串中获取 NSDate。我有这个代码：

```
stringToUpdate = [stringToUpdate stringByReplacingOccurrencesOfString:@"T" withString:@" "];

NSMutableString* dateWithoutColonString = [stringToUpdate mutableCopy];

NSRegularExpression* lastColonRegex = [NSRegularExpression
                                       regularExpressionWithPattern:@"([\\+\\-][0-9][0-9]):"
                                       options:NSRegularExpressionCaseInsensitive
                                       error:nil];

[lastColonRegex replaceMatchesInString:dateWithoutColonString
                               options:NSRegularExpressionCaseInsensitive
                                 range:NSMakeRange(0, [stringToUpdate length])
                          withTemplate:@"$1"];

NSDateFormatter *dateformatter = [[NSDateFormatter alloc] init];
[dateformatter setDateFormat:@"yyyy-MM-dd hh:mm:ssZZZ"];

NSDate *myDate = [dateformatter dateFromString: dateWithoutColonString]; 
```

对于不同的传入字符串，它的行为不同。意义：

```
NSString *stringToUpdate = @"2013-02-05T17:20:58+01:00"; 
```

总是失败，而

```
NSString *stringToUpdate = @"2013-02-07T12:26:41+01:00"; 
```

总是成功。两者的传入字符串的长度相同，因此不应该有任何功能字符。任何提示正在发生的事情将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T07:29:12.930

DateFromString 似乎只是错误的。利用：

```
if (![[self dateformatter] getObjectValue:&myDate forString:stringToUpdate range:nil error:&error]) {
    NSLog(@"Date '%@' could not be parsed: %@", stringToUpdate, error);
} else {
    //NSLog(@"%@", myDate);
}

NSString *text;

NSTimeInterval timeInSeconds = [myDate timeIntervalSinceNow];
timeInSeconds = timeInSeconds * -1; 
```

获得正的秒数。

# javascript - 使用 Javascript 添加内联样式

> ID：14753147
> 
> 赞同：108
> 
> 时间：2013-02-07T14:11:22.073
> 
> 标签：javascript, css, innerhtml

我正在尝试将此代码添加到动态创建的 div 元素

```
style = "width:330px;float:left;" 
```

创建动态的代码`div`是

```
var nFilter = document.createElement('div');
nFilter.className = 'well';
nFilter.innerHTML = '<label>' + sSearchStr + '</label>'; 
```

我的想法是在之后添加样式，`< div class="well"`但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2013-02-07T14:13:39.073

```
nFilter.style.width = '330px';
nFilter.style.float = 'left'; 
```

这应该为元素添加内联样式。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-02-07T14:15:42.100

您可以直接在样式上执行此操作：

```
var nFilter = document.createElement('div');
nFilter.className = 'well';
nFilter.innerHTML = '<label>'+sSearchStr+'</label>';

// Css styling
nFilter.style.width = "330px";
nFilter.style.float = "left";

// or
nFilter.setAttribute("style", "width:330px;float:left;"); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-02-07T14:15:36.993

使用 jQuery：

```
$(nFilter).attr("style","whatever"); 
```

否则 ：

```
nFilter.setAttribute("style", "whatever"); 
```

应该管用

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-02-07T14:18:03.560

你可以试试这个

```
nFilter.style.cssText = 'width:330px;float:left;'; 
```

那应该为你做。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-02-07T14:16:12.547

```
var div = document.createElement('div');
div.setAttribute('style', 'width:330px; float:left');
div.setAttribute('class', 'well');
var label = document.createElement('label');
label.innerHTML = 'YOUR TEXT HERE';
div.appendChild(label); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2017-08-14T15:47:27.503

一些人有一个我喜欢的使用 setAttribute 的例子。但是，它假定您当前没有设置任何样式。我可能会做类似的事情：

```
nFilter.setAttribute('style', nFilter.getAttribute('style') + ';width:330px;float:left;'); 
```

或者把它变成这样的辅助函数：

```
function setStyle(el, css){
  el.setAttribute('style', el.getAttribute('style') + ';' + css);
}

setStyle(nFilter, 'width:330px;float:left;'); 
```

这确保您可以连续添加样式，并且不会通过始终附加到当前样式来删除当前设置的任何样式。它还添加了一个额外的分号，这样如果有一个样式丢失了一个，它将附加另一个以确保它是完全分隔的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-02-07T14:14:21.460

你应该创建一个 CSS 类`.my_style`然后使用`.addClass('.mystyle')`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-01-17T09:31:23.393

如果您不想逐行添加每个 css 属性，可以执行以下操作：

```
document.body.insertAdjacentHTML('afterbegin','<div id="div"></div>');

/**
 * Add styles to DOM element
 * @element DOM element
 * @styles object with css styles
 */
function addStyles(element,styles){
  for(id in styles){
    element.style[id] = styles[id];
  }
}

// usage
var nFilter = document.getElementById('div');
var styles = {
  color: "red"
  ,width: "100px"
  ,height: "100px"
  ,display: "block"
  ,border: "1px solid blue"
}
addStyles(nFilter,styles);
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-02-07T14:15:54.157

使用[cssText](https://developer.mozilla.org/en-US/docs/DOM/CSSStyleDeclaration)

```
nFilter.style.cssText +=';width:330px;float:left;'; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-06-21T12:14:50.903

尝试这样的事情

```
document.getElementById("vid-holder").style.width=300 + "px"; 
```

# http - 为什么浏览器在刷新时会为同一页面发送两个请求？

> ID：14753148
> 
> 赞同：8
> 
> 时间：2013-02-07T14:11:22.323
> 
> 标签：http, google-chrome, networking, browser, request

我创建了一个简单的 Node.js 应用程序，它记录以控制`request.url`每个传入 HTTP 请求的电流。当我在 Mac OS X ML 上的 Chrome 中刷新页面时，我收到了对同一页面的两个请求。**为什么？**

相比之下，当我使用**curl**并请求同一个页面时，我只收到一个请求。如果我在 Safari 中刷新页面，则请求相同。

**为什么 Chrome 会针对同一页面发送两个请求？**

**编辑：**我已经调查`request.headers`并发现了一个区别：`accept`标题。

这是第一个请求的标头。请注意，它*接受*特定 mime 的列表。

```
{ host: 'www.pulsr.local:1337',
  connection: 'keep-alive',
  'cache-control': 'max-age=0',
  accept: 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
  'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.57 Safari/537.17',
  'accept-encoding': 'gzip,deflate,sdch',
  'accept-language': 'en-US,en;q=0.8',
  'accept-charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.3',
  cookie: 'PULSRSESSID=BBtDAWMVgbQZ8lXA6wv4Wg/vwwI=; PULSRSESSID=dsGxP494UxJueit2/u79AFiM5fw=' } 
```

这是第二个请求。这一次它*接受了一切*。

```
{ host: 'www.pulsr.local:1337',
  connection: 'keep-alive',
  'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.57 Safari/537.17',
  accept: '*/*',
  'accept-encoding': 'gzip,deflate,sdch',
  'accept-language': 'en-US,en;q=0.8',
  'accept-charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.3',
  cookie: 'PULSRSESSID=VGWRSG9zIokHjA2vLa1b+/fUqu8=; PULSRSESSID=dsGxP494UxJueit2/u79AFiM5fw=' } 
```

**编辑 2：**我检查并看到这两个请求都是`GET`请求。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T14:15:13.480

我认为这与 Chrome 中的这个[错误](http://code.google.com/p/chromium/issues/detail?id=39402)有关，它会在每个请求上发送对 favicon 的请求。Firefox 和其他浏览器在第一次请求时执行此操作，但会将其缓存。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-02T14:11:42.403

正如在另一个[答案](https://stackoverflow.com/questions/4460661/what-to-do-with-chrome-sending-extra-requests#29231264)中发现的那样，它可能是由`src`图像或 iframe 上的空属性引起的。我遇到了同样的问题：当只刷新 1 个页面时，来自 Chromium 的完全相同的页面上的 4 个请求（而不是 favicon 上的）。就我而言，我发现这是由于标签上的空`href`属性：`link`

```
<link rel="shortcut icon" href="" />
<link rel="icon" type="image/x-icon" href="" />
<link rel="icon" type="image/png" href="" /> 
```

因此，我的页面重新加载有 1 个请求，上述 3 个链接中的每个链接都有 1 个请求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-07T15:38:20.370

`src="#"`在我的情况下，导致页面打开两次的 iframe

```
<iframe src="#" class="iframe lazyload" id="youtube-player-iframe" allow="autoplay"></iframe> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-03T15:42:02.597

注意chrome上的萤火虫灯扩展..那是我的问题

# scala - 如何在 Scala 中将 InputStream 转换为 base64 字符串？

> ID：14753153
> 
> 赞同：3
> 
> 时间：2013-02-07T14:11:34.820
> 
> 标签：scala

尝试从 Amazon S3 中提取图像（返回`S3ObjectInputStream`）并将其发送到[mandrill 电子邮件 api](https://mandrillapp.com/api/docs/messages.html#method=send)（采用 base64 编码的字符串）。如何在 Scala 中做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-07T15:21:22.417

我还设法仅使用 Apache commons 来做到这一点；不确定哪种方法更好，但我想我会把这个答案留作记录：

```
import org.apache.commons.codec.binary.Base64
import org.apache.commons.io.IOUtils

val bytes = IOUtils.toByteArray(stream)
val bytes64 = Base64.encodeBase64(bytes)
val content = new String(bytes64) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-07T14:51:17.720

这是一种解决方案，可能还有其他更有效的解决方案。

```
val is = new ByteArrayInputStream(Array[Byte](1, 2, 3)) // replace by your InputStream
val stream = Stream.continually(is.read).takeWhile(_ != -1).map(_.toByte)
val bytes = stream.toArray
val b64 = new sun.misc.BASE64Encoder().encode(bytes) 
```

您可以（也应该）用`sun.misc`apache commons [Base64](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html)替换编码器以获得更好的兼容性。

```
val b64 = org.apache.commons.codec.binary.Base64.encodeBase64(bytes) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-01T12:54:36.413

Here's a [simple encoder/decoder](https://github.com/marklister/base64) I wrote that you can include as source. So, no external dependencies.

The interface is a bit more scala-esque:

`import io.github.marklister.base64.Base64._ // Same as Lomig Mégard's answer val b64 = bytes.toBase64`

# postgresql - postgres 处理重复项的效果如何？

> ID：14753155
> 
> 赞同：4
> 
> 时间：2013-02-07T14:11:39.670
> 
> 标签：postgresql

我有一张表，其中存储了相对较大的字符串（10000 个字符）。

我会有很多行（数百万行？），但其中 99% 的行将具有相同的大字符串值。

有谁知道 postgres 是否有机制可以很好地处理这种情况？（即不要使用千兆的存储空间）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T14:17:10.067

PostgreSQL 在内部压缩大值。但它**不会**检测到多行中的值是相同的。如果你想要这样的检测，你必须自己做。例如使用如下模式：

```
CREATE TABLE big_texts (
    id       SERIAL PRIMARY KEY,
    big_text TEXT NOT NULL DEFAULT ''
);

CREATE TABLE base_table (
    id          SERIAL PRIMARY KEY,
    big_text_id INT4 NOT NULL REFERENCES big_texts (id),
    other       TEXT,
    columns     INT8,
); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-07T14:16:30.443

> 我会有很多行（数百万行？），但其中 99% 的行将具有相同的大字符串值。

在这种情况下，我会将唯一的“大字符串”存储在另一个表中，并只保留对另一个表中正确行的引用。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-07T14:18:58.597

实际上，您可能需要考虑使用 MD5 作为 ID。Postgres 支持 MD5。

因此，您可以使用 @depesz 修改后的模式插入：

```
CREATE TABLE big_text (
    id  VARCHAR(32) NOT NULL,
    big_text TEXT NOT NULL,
    CONSTRAINT big_text_pkey PRIMARY KEY (id)
); 
```

您可以使用宿主语言以编程方式创建 ID，也可以使用 Postgres 为您创建 ID： [http ://www.postgresql.org/docs/9.1/static/functions-string.html](http://www.postgresql.org/docs/9.1/static/functions-string.html)

然后您可以执行以下操作：

```
INSERT INTO big_text (id, big_text) VALUES (md5(big_text), big_text); 
```

如果插入失败，您已经在数据库中有文本。显然，您可以通过首先选择 md5 值来以更好的方式执行此操作。

`10000`字符不是那么大，但如果你真的想扩大规模，你还可以研究布隆过滤器之类的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-05T06:28:52.883

您可能想为 postgres 使用 citus 数据扩展。2021 年 3 月，他们为表甚至表分区添加了列存储选项。这完全符合其他答案的建议，但在幕后。 [https://www.citusdata.com/blog/2021/03/06/citus-10-columnar-compression-for-postgres/](https://www.citusdata.com/blog/2021/03/06/citus-10-columnar-compression-for-postgres/)

# glsl - glsl 向量加标量

> ID：14753158
> 
> 赞同：4
> 
> 时间：2013-02-07T14:12:01.060
> 
> 标签：glsl

我搜索了很多，但找不到以下语句在`#version 330`顶点着色器中是否合法：

```
#define note_the_following_whitespaces            0x01

(layout location = 7) vec3 out ov;
(layout location = 8) vec3 out rv;
void main() {
    rv = vec3(1.0,2.0,3.0);
    ov = (1.0+rv)/2.0;
    gl_Position = [whatever]...
} 
```

我特别指的是`(1.0+rv)`- 着色器在每张 nVidia 卡上都能很好地编译，但拒绝在 ATI 卡上编译。不幸的是我没有确切的编译结果，我只知道编译不成功。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T14:17:29.583

[http://www.opengl.org/registry/doc/GLSLangSpec.3.30.6.pdf](http://www.opengl.org/registry/doc/GLSLangSpec.3.30.6.pdf)

从`5.9`

> 算术二元运算符加 (+)、减 (-)、乘 (*) 和除 (/) 对整数和浮点标量、向量和矩阵进行运算。

(...)

> 一个操作数是标量，另一个是向量或矩阵。在这种情况下，标量运算独立地应用于向量或矩阵的每个分量，从而产生相同大小的向量或矩阵。

所以如果它不能在 ATI 上编译，就意味着它的驱动程序在这方面是不正确的。

# python - python下如何读取ip地址不发生资源泄露

> ID：14753159
> 
> 赞同：1
> 
> 时间：2013-02-07T14:12:08.980
> 
> 标签：python, ip, resource-leak

如何在 Linux 和 Windows 中获取 Python 中的网络信息？我尝试在 Ubuntu 12.10 64 位上的 Python 2.7 中使用 netinfo 包（版本 0.3.2），但使用此包会使句柄未关闭，如下所示。在我的情况下，它不被接受。

```
导入网络信息

def countOpenFiles():
    导入资源、fcntl、os
    n_open = 0
    名称 = []
    软、硬 = resource.getrlimit(resource.RLIMIT_NOFILE)
    对于范围内的 fd（0，软）：
        尝试：
            f = fcntl.fcntl(fd, fcntl.F_GETFD)
            n_open += 1
        除了 IOError：
            继续
    返回 n_open

对于范围内的 i (10)：
    netinfo.get_ip('eth0')
    打印 countOpenFiles()

```

它产生：

```
4
5
6
7
8
9
10
11
12
13

```

我想有类似的 netinfo 包没有资源泄漏。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:56:58.217

你到底想做什么？据我所知，您不计算 eth0 文件句柄，而是计算所有文件句柄。如果你只是不想打开 IP 文件句柄，你可以在 Linux 下使用 lsof (shelltool)。

lsof -u 你的用户 | grep IPv4 不仅仅是 eth0，但我不知道如何过滤接口。

# c# - 在 MonoMac 中打开 Cocoa 窗口

> ID：14753166
> 
> 赞同：1
> 
> 时间：2013-02-07T14:12:27.323
> 
> 标签：c#, cocoa, mono, nswindowcontroller

我正在尝试完成打开一个新窗口的非常简单的任务，但我似乎完全无法这样做。

我在 Mac 上使用 MonoMac 和 monobjc。创建新的 monobjc 项目时，会创建 MainMenu.xib。我已经设法使用 XCode 编辑器向该文件添加控件和绑定。启动应用程序时会自动打开此窗口。

但是，当我尝试创建一个新窗口时，我根本无法让它显示出来。我通过右键单击 MainMenu.xib 的父文件夹并单击 Add file => Cocoa Window Template 创建了一个 .xib 文件。这个文件可以在 XCode 中编辑，只是一个 MainMenu.xib。

然后我继续创建一个继承 NSWindowController 的类，并在我的 .xib 文件中选择这个类作为窗口的“文件所有者”。然后我就能够设计窗口，并向控制器添加出口和操作。

但我不知道如何打开窗户。我尝试了多种变体：

```
var f = new RegularLoginForm(); //which inherits NSWindowController
f.LoadWindow(); //I have tried without this line
f.ShowWindow(null); // I have also tried sending in the AppDelegate object (which is the controller for MainMenu.xib) 
```

但似乎没有任何效果——也就是说，窗口永远不会打开。有什么建议么？

编辑：这是我的 .xib 及其配置的屏幕截图：[https ://dl.dropbox.com/u/1545094/so_nswindowcontroller.png](https://dl.dropbox.com/u/1545094/so_nswindowcontroller.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:24:14.013

您在 Window.xib 中将 RegularLoginForm 设置为文件的所有者；但是您是否也将 File's Owner 的 Window 插座连接到 Interface Builder 中的 Window？

即在IB中右键单击File's Owner，然后将Window outlet点拖到Window对象上

Further to that, I tried your code and for me it crashes on the call to

```
f.ShowWindow(null) 
```

*[ERROR] FATAL UNHANDLED EXCEPTION: System.ArgumentNullException: Argument cannot be null. Parameter name: sender*

It runs fine if I assign the sender parameter, e.g.

```
f.ShowWindow(this) 
```

However, my environment is only MonoMac; no monoobjc (I'm not sure how or why you are using both together?); so YMMV.

# android - 在 android 中导入操作栏 sherlock 要求选择至少一个项目

> ID：14753171
> 
> 赞同：0
> 
> 时间：2013-02-07T14:12:30.410
> 
> 标签：android, import, actionbarsherlock

我正在尝试导入 action bar sherlock 我下载了该项目，我正在关注[http://wptrafficanalyzer.in/blog/setting-up-sherlock-library-for-action-bar-in-pre-honeycomb-android-applications/](http://wptrafficanalyzer.in/blog/setting-up-sherlock-library-for-action-bar-in-pre-honeycomb-android-applications/)根据站点中的屏幕截图，我也附加了我的屏幕，但是在选择根目录后，它要求我选择至少一个项目，为什么？帮助将不胜感激...![在此处输入图像描述](../Images/74771cc41630b12d41d2862719966534.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:17:42.653

由于一个目录可以包含多个项目，eclipse 提供了一个对话框，您可以在其中选择要导入的项目。

据我所知，Actionbarsherlock 包含一个库和一个示例文件夹。库文件夹是您要导入的文件夹。

因此，只需选择库项目，然后将其链接到您要使用它的项目。（您当然也可以在导入项目后在 Eclipse 中重命名项目，因为“库”并不是真正的描述性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-30T00:23:46.873

好的，我知道这很旧，但是在尝试更新到新的 4.3.1 版本的 ABS 库后，我遇到了同样的问题。这个问题很容易解决，这与我已经有一个同名的库项目有关。

我下载了 zip 文件。因此，只需将最初名为 actionbarsherlock 的文件夹重命名为 actionbarsherlock-4.3.1 就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-26T15:09:14.247

**在 Eclipse 中：**
您可能已经将此项目添加到您的工作区。要检查它，只需在包资源管理器中控制项目是否已经存在。如果需要，您可以简单地删除项目并再次添加它。

# ios - 在 tableView 中是否可以同时具有分组和普通部分

> ID：14753173
> 
> 赞同：0
> 
> 时间：2013-02-07T14:12:39.210
> 
> 标签：ios, objective-c, xcode

我想知道是否有可能在普通样式的 tableView 中有一个具有分组样式的部分？

谢谢斯图尔特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:16:06.027

不，更好的解决方案是拥有两个 UITableView。我猜这些表中的数据无论如何都是不同的，所以这将是更理想的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:17:47.957

不，不是，因为它们都是适用于整个`UITableView`实例的样式。例如，您可以将表格拆分为多个部分并使用自定义单元格。这将花费您一些时间，但它应该可以工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:16:48.900

该样式应用于整个`UITableView`. 理论上，您可以通过将普通样式表中的第一个单元格作为另一个具有分组样式的表视图来解决此问题，然后其余单元格与正常一样。或者第一个单元格是正常的，最后一个单元格是分组样式表视图，这取决于您是否首先想要分组样式

# macos - MAC OSX中获取Process的cpu、thread、vsize、rsize

> ID：14753187
> 
> 赞同：1
> 
> 时间：2013-02-07T14:13:28.940
> 
> 标签：macos, shell, awk, grep, ps

我想知道基于PID的进程的CPU，线程，VSize，Rsize。所以我使用top -i 1 -l 1命令并grepping相应的值。但是top与MAC 10.5到10.7不同。有没有仅获取那些列本身的特定方法。

代码进程= `top -i 1 -l 1 | grep "$PID" cpu=`echo "$process" | awk '{打印 $3}'`

同样 5 10 11 对应 10.5 中的(thread, VSize, Rsize) 值，但列在 10.7 中不同。

有什么通用的方法可以在 shell 脚本中得到这个请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:20:57.660

我在solaris上使用它：

```
ps -eo pmem,pid,pcpu,rss,vsz,time,args | sort -k 1 -r|awk '$2~/<your pid>/' 
```

# android - Android在从Url加载图像时没有响应

> ID：14753192
> 
> 赞同：1
> 
> 时间：2013-02-07T14:13:44.877
> 
> 标签：android, image, xml-parsing, loading

我正在尝试解析 xml 文件并尝试加载图像和文本视图并将其显示在列表视图中，但是每当我尝试在 getView 方法中加载图像时，即使尝试快速滚动，它也会强制关闭应用程序。我厌倦了在线程和异步任务中做 5 个小时。如果有人可以解决它，请提供帮助。这是我的两个类文件。

```
class NewsRowAdapter

public class NewsRowAdapter extends ArrayAdapter<Item> 
{
    LoadingImage loadingImage;

    Bitmap bitmap = null;

    private Activity activity;

    private List<Item> items;

    private Item objBean;

    private int row;

    public NewsRowAdapter(Activity act, int resource, List<Item> arrayList) 
    {

        super(act, resource, arrayList);

        this.activity = act;

        this.row = resource;

        this.items = arrayList;

    }

    @Override
    public View getView(final int position, View convertView, ViewGroup parent)
    {
        View view = convertView;

        final ViewHolder holder;

        if (view == null) 
        {

            LayoutInflater inflater = (LayoutInflater) activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

            view = inflater.inflate(row, null);

            holder = new ViewHolder();

            view.setTag(holder);

        } else 
        {
            holder = (ViewHolder) view.getTag();
        }

        if ((items == null) || ((position + 1) > items.size()))

            return view;

        objBean = items.get(position);

        holder.tvTitle = (TextView) view.findViewById(R.id.tvtitle);

        holder.tvDesc = (TextView) view.findViewById(R.id.tvdesc);

        holder.tvDate = (TextView) view.findViewById(R.id.tvdate);

        holder.imgView = (ImageView) view.findViewById(R.id.image);

        holder.pbar = (ProgressBar) view.findViewById(R.id.pbar);

        if (holder.tvTitle != null && null != objBean.getTitle() && objBean.getTitle().trim().length() > 0) 
        {
            holder.tvTitle.setText(Html.fromHtml(objBean.getTitle()));
        }
        if (holder.tvDesc != null && null != objBean.getDesc() && objBean.getDesc().trim().length() > 0)
        {
            holder.tvDesc.setText(Html.fromHtml(objBean.getDesc()));
        }
        if (holder.tvDate != null && null != objBean.getPubdate() && objBean.getPubdate().trim().length() > 0)
        {
            holder.tvDate.setText(Html.fromHtml(objBean.getPubdate()));
        }
        if (holder.imgView != null) 
        {
            if (null != objBean.getLink() && objBean.getLink().trim().length() > 0) 
            {
                final ProgressBar pbar = holder.pbar;

                pbar.setVisibility(View.INVISIBLE);

                //---------CHANGES MADE FOR LOADING IMAGE----------//

                Log.d("IMAGE NULL----------", objBean.getLink());

                //loadBitmap(objBean.getLink());

                /*new Thread() 
                {
                    public void run() 
                    {*/
                        try 
                        {
                            URL linkurl = new URL(objBean.getLink());

                            bitmap = BitmapFactory.decodeStream(linkurl.openConnection().getInputStream());

                            holder.imgView.setImageBitmap(bitmap);

                        } catch (MalformedURLException e) 
                        {
                            e.printStackTrace();

                        } catch (IOException e) 
                        {
                            e.printStackTrace();
                        }
                    /*}
                }.start();*/

            } else 
            {
                holder.imgView.setImageResource(R.drawable.ic_launcher);
            }
        }

        return view;
    }

    //------LOADING IMAGE FROM URL------//

    public static Bitmap loadBitmap(String url) 
    {
        Bitmap bitmap = null;

        final AndroidHttpClient client = AndroidHttpClient.newInstance("Android");
        final HttpGet getRequest = new HttpGet(url);

        try 
        {
            HttpResponse response = client.execute(getRequest);
            final int statusCode = response.getStatusLine().getStatusCode();
            if (statusCode != HttpStatus.SC_OK) 
            { 
                Log.d("ImageDownloader", "Error " + statusCode + " while retrieving bitmap from " + url); 
                return null;
            }

            final HttpEntity entity = response.getEntity();
            if (entity != null)
            {
                InputStream inputStream = null;
                try 
                {
                    inputStream = entity.getContent(); 

                    bitmap = BitmapFactory.decodeStream(inputStream);

                } finally
                {
                    if (inputStream != null)
                    {
                        inputStream.close();  
                    }
                    entity.consumeContent();
                }
            }
        } catch (Exception e) 
        {
            // Could provide a more explicit error message for IOException or IllegalStateException
            getRequest.abort();

            Log.d("Error while retrieving bitmap from " + url, e.toString());
        } finally 
        {
            if (client != null)
            {
                client.close();
            }
        }

        return bitmap;
    }

    public class ViewHolder
    {

        public TextView tvTitle, tvDesc, tvDate;
        private ImageView imgView;
        private ProgressBar pbar;

    }

} 
```

主要课程是：

类 MainActivity

```
public class MainActivity extends Activity implements OnItemClickListener
{
    private static final String rssFeed = /*"https://www.dropbox.com/s/t4o5wo6gdcnhgj8/imagelistview.xml?dl=1"*/"http://78.46.34.27/kapapps/newparsedtransaction.xml";

    List<Item> arrayOfList;
    ListView listView;

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.mainnewtransaction);

        listView = (ListView) findViewById(R.id.listview);
        listView.setOnItemClickListener(this);

        if (Utils.isNetworkAvailable(NewTransactionActivity.this)) 
        {
            new MyTask().execute(rssFeed);
        } else 
        {
            showToast("No Network Connection!!!");
        }

    }

    // My AsyncTask start...

    class MyTask extends AsyncTask<String, Void, Void> 
    {

        ProgressDialog pDialog;

        @Override
        protected void onPreExecute() 
        {
            super.onPreExecute();

            pDialog = new ProgressDialog(NewTransactionActivity.this);
            pDialog.setTitle("Latest Transaction");
            pDialog.setMessage("Loading... Please wait");
            pDialog.show();

        }

        @Override
        protected Void doInBackground(String... params) 
        {
            arrayOfList = new NamesParser().getData(params[0]);
            return null;
        }

        @Override
        protected void onPostExecute(Void result) 
        {
            super.onPostExecute(result);

            if (null == arrayOfList || arrayOfList.size() == 0) 
            {

                showToast("No data found from web!!!");

                NewTransactionActivity.this.finish();

            } else 
            {

                // check data...
                /*
                 * for (int i = 0; i < arrayOfList.size(); i++) 
                 * { 
                 *  Item item = arrayOfList.get(i); System.out.println(item.getId());
                 *  System.out.println(item.getTitle());
                 *  System.out.println(item.getDesc());
                 *  System.out.println(item.getPubdate());
                 *  System.out.println(item.getLink()); 
                 * }
                 */
                for(int i = 0 ; i < arrayOfList.size() ; i++)
                {   
                    Item item = arrayOfList.get(i);
                    Log.d("ID NEWTRANSACTION ACTIVITY ------>" , item.getId());
                    Log.d("TITLE NEWTRANSACTION ACTIVITY ------>" , item.getTitle());
                    Log.d("DESC NEWTRANSACTION ACTIVITY ------>", item.getDesc());
                    Log.d("LINK NEWTRANSACTION ACTIVITY ------>", item.getLink());
                }

                setAdapterToListview();

            }

            if (null != pDialog && pDialog.isShowing()) 
            {
                pDialog.dismiss();
            }

        }
    }

    @Override
    public void onItemClick(AdapterView<?> parent , View view , int position ,  long id) 
    {
        Item item = arrayOfList.get(position);
        Intent intent = new Intent(NewTransactionActivity.this, DetailActivity.class);
        intent.putExtra("url", item.getLink());
        intent.putExtra("title", item.getTitle());
        intent.putExtra("desc", item.getDesc());

        Log.d("IMAGE_URL------>" , item.getLink());
        startActivity(intent);
    }

    public void setAdapterToListview() 
    {
        NewsRowAdapter objAdapter = new NewsRowAdapter(NewTransactionActivity.this , R.layout.row, arrayOfList);
        listView.setAdapter(objAdapter);
    }

    public void showToast(String msg) 
    {

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:19:45.463

在另一个线程中执行图像检索逻辑。加载图像需要太多时间，这就是你得到 ANR 的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:27:26.817

使用单个工作线程，并使其可以在活动的 onPause() 中停止。好的方法是使用 SingleThread Executor 服务来加载图像。

这是一个示例[https://stackoverflow.com/a/14579365/1366471](https://stackoverflow.com/a/14579365/1366471)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:30:36.270

我建议使用[`RemoteImageView`](http://dhuckaby.github.com/Prime/reference/com/handlerexploit/prime/widgets/RemoteImageView.html)Prime[库](https://github.com/DHuckaby/Prime)中的。它大大减少了你的工作量。

在您的布局中，替换`ImageView`为`com.handlerexploit.prime.widgets.RemoteImageView`和 在您的代码中，更改`ImageView`为`RemoteImageView`在您的持有人类中。

在`getView`方法中，

```
holder.imgView = (RemoteImageView) view.findViewById(R.id.image);
//...
holder.imgView.setImageURL(objBean.getLink()); 
```

# python - 绘制 5 个图的“平均”图

> ID：14753193
> 
> 赞同：0
> 
> 时间：2013-02-07T14:13:49.970
> 
> 标签：python, plot, gnuplot

假设，我有一些数据点定义了 5 个不同的图表，如下图所示。

**如何在 y 轴的值上绘制这些的平均图**？
我不能直接这样做，因为不同图表的数据点在 x 轴上的值不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:28:17.250

```
import numpy as np

def line_tuple(filename,cols=(0,1)):
    return np.loadtxt(filename,usecols=cols,unpack=True)

#parse each line from the datafile into a tuple of the form (xvals,yvals)
#store that tuple in a list.
data = [line_tuple(fname) for fname in ("line1.txt","line2.txt","line3.txt","line4.txt","line5.txt")]

#This is the minimum and maximum from all the datapoints.
xmin = min(line[0].min() for line in data)
xmax = max(line[0].max() for line in data)

#100 points evenly spaced along the x axis
x_points = np.linspace(xmin,xmax,100)

#interpolate your values to the evenly spaced points.
interpolated = [np.interp(x_points,d[0],d[1]) for d in data]

#Now do the averaging.
averages = [np.average(x) for x in zip(*interpolated)]

#put the average value along with it's x point into a file.
with open('outfile','w') as fout:
    for x,avg in zip(x_points,averages):
        fout.write('{0} {1}\n'.format(x,avg)) 
```

现在我绘制它：

```
plot 'line1.txt' w l, \
     'line2.txt' w l, \
     'line3.txt' w l, \
     'line4.txt' w l, \
     'line5.txt' w l, \
     'outfile' w l 
```

# android - 捕获图像并在片段Android中接收结果时为空位图

> ID：14753201
> 
> 赞同：0
> 
> 时间：2013-02-07T14:14:20.053
> 
> 标签：android, android-fragments, android-camera

我正在尝试从相机捕获图像并将结果放入网格视图中。我使用片段如下。我在尝试接收 Intent Extras 时收到 OnActivityResult 上的空指针异常：

```
 public void onActivityResult(int requestCode, int resultCode, Intent data) {       

                       Bitmap bitmap = (Bitmap) data.getExtras().get("data");

                       try {

                           FileOutputStream outStream = new FileOutputStream(PATH_TO_SAVE+"img2.png");
//NULL pointer exception here
                           bitmap.compress(Bitmap.CompressFormat.PNG, 100, outStream); 
                           /* 100 to keep full quality of the image */

                           outStream.flush();
                           outStream.close();
                           success = true;

                           if (success) {
                               Log.i("SF", "Image saved with success");

                           } else {
                                       Log.i("SF", "Image saved with F");
                           }

                       } catch (FileNotFoundException e) {
                           e.printStackTrace();
                       } catch (IOException e) {
                           e.printStackTrace();
                       } 
            adapter.notifyDataSetChanged();

        } 
```

// 这里开始活动

```
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.submit_feed_scr2 , container, false);

        Button b = (Button) view.findViewById(R.id.btnCapture);
        b.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View arg0) {

                Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
                intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(new

                File(PATH_TO_SAVE)));

                    startActivityForResult(intent, CAPTURE_ITEM);

                }
            });

            //Adapter
            adapter = new ArrayAdapter<String>(getActivity(), android.R.layout.simple_list_item_1,
                    items);
            GridView gridview = (GridView) view.findViewById(R.id.gridView1);

            gridview.setAdapter(adapter);

            //Providing Grid with Images

            gridview = (GridView) view.findViewById(R.id.gridView1);
            gridview.setAdapter(new ImageAdapter(view.getContext(),1));

            gridview.setOnItemClickListener(new AdapterView.OnItemClickListener() {
                public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
                    //Toast.makeText(this, "" + position, Toast.LENGTH_SHORT).show();
                }
            });

            return view;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:34:41.773

您的照片保存在 PATH_TO_SAVE 位置。

你应该在 onActivityResult 做这样的事情：

```
File file = new File(PATH_TO_SAVE);

Bitmap bmp = BitmapFactory.decodeFile(file.getPath()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:32:32.643

试试这个，它对我有用：

```
if (resultCode == RESULT_OK) {

            String realPath = Constants.TMP_CAMERA_PATH;
            photoTaked = (Bitmap) data.getExtras().get("data");
            photoTakedFile = new File(realPath);
            photoTakedFile.deleteOnExit();

            if (photoTakedFile.exists()) {
                photoTakedFile.delete();
            }

            try {

                ByteArrayOutputStream bytes = new ByteArrayOutputStream();
                photoTaked.compress(Bitmap.CompressFormat.PNG, 90, bytes);

                photoTakedFile.createNewFile();
                FileOutputStream fo = new FileOutputStream(photoTakedFile);
                fo.write(bytes.toByteArray());
                fo.close();

                uploadImageView.setImageBitmap(photoTaked);
                uploadImageView.setVisibility(View.VISIBLE);

                calcRemainingChars();

            } catch (IOException e) {
                e.printStackTrace();
            }

        } 
```

# hibernate - 如何将 Hibernate 添加为 Thycho (Maven) 依赖项？

> ID：14753203
> 
> 赞同：2
> 
> 时间：2013-02-07T14:14:23.107
> 
> 标签：hibernate, maven-2, eclipse-rcp, tycho

我正在尝试使用 Maven 2（使用 M2M eclipse 插件）和 Tycho 自动构建我的 RCP 应用程序。

我的应用程序需要休​​眠以将数据保存在 SQLite 数据库中。为此，我将这些 XML 行放在`pom.xml`需要 Hibernate 运行的插件中：

```
<?xml version="1.0" encoding="UTF-8"?>

<project>
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <relativePath>../com.myrcpapp.parentplugin.path/pom.xml</relativePath>
        <groupId>my.group.id</groupId>
        <artifactId>parent</artifactId>
        <version>1.0.0.qualifier</version>
    </parent>

    <groupId>my.group.id</groupId>
    <artifactId>com.myrcpapp.dbplugin</artifactId>
    <packaging>eclipse-plugin</packaging>

    <dependencies>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>4.2.0.CR1</version>
        </dependency>
    </dependencies>
</project> 
```

当我运行`eclipse:eclipse`目标时，一切都很好（类路径已很好地更新，并且在我的插件项目中很好地引用了 jar）并且我可以启动我的应用程序。但是当我尝试使用`clean install`目标使用 Maven 构建我的应用程序时，构建失败。Maven 似乎可以解决“休眠”依赖。无论如何，我都会收到此错误：

```
 [ERROR] Failed to execute goal org.eclipse.tycho:tycho-compiler-plugin:0.16.0:compile (default-compile) on project com.myrcpapp.dbplugin: Compilation failure: Compilation failure: com\myrcpapp\dbplugin
 [ERROR] C:\Documents and Settings\user\workspace\com.myrcpapp.dbplugin\src\com\myrcpapp\dbplugin\service\impl\ClientService.java:[3,0]
 [ERROR] import org.hibernate.Session;
 [ERROR] ^^^^^^^^^^^^^
 [ERROR] The import org.hibernate cannot be resolved
 [ERROR] C:\Documents and Settings\user\workspace\com.myrcpapp.dbplugin\src\com\myrcpapp\dbplugin\service\impl\ClientService.java:[4,0]
 [ERROR] import org.hibernate.Transaction;
 [ERROR] ^^^^^^^^^^^^^
 [..]
 [ERROR] Table cannot be resolved to a type
 [ERROR] C:\Documents and Settings\user\workspace\com.myrcpapp.dbplugin\src\com\myrcpapp\dbplugin\model\Client.java:[7,0]
 [ERROR] @Table(name="clients")
 [ERROR] ^^^^
 [ERROR] The attribute name is undefined for the annotation type Table
 [ERROR] 18 problems (18 errors)
 [ERROR] -> [Help 1]
 [ERROR] 
 [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
 [ERROR] Re-run Maven using the -X switch to enable full debug logging.
 [ERROR] 
 [ERROR] For more information about the errors and possible solutions, please read the following articles:
 [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
 [ERROR] 
 [ERROR] After correcting the problems, you can resume the build with the command
 [ERROR]   mvn <goals> -rf :com.myrcpapp.dbplugin 
```

关于我做错了什么的任何想法？

提前致谢

# c# - 为什么 IEnumerable .ToList () 返回列表 而不是 IList ?

> ID：14753205
> 
> 赞同：68
> 
> 时间：2013-02-07T14:14:28.090
> 
> 标签：c#, linq, interface, ienumerable

扩展方法`ToList()`返回一个`List<TSource>`. 遵循相同的模式，`ToDictionary()`返回 a `Dictionary<TKey, TSource>`。

我很好奇为什么这些方法不分别输入它们的返回`IList<TSource>`值`IDictionary<TKey, TSource>`。这似乎更奇怪，因为`ToLookup<TSource, TKey>`它的返回值类型是接口而不是实际实现。

[使用dotPeek](http://www.jetbrains.com/decompiler/)或其他反编译器查看这些扩展方法的来源，我们看到以下实现（显示`ToList()`是因为它更短）：

```
public static List<TSource> ToList<TSource>(this IEnumerable<TSource> source) { 
   if (source == null) throw Error.ArgumentNull("source");
   return new List<TSource>(source); 
} 
```

那么为什么这个方法将它的返回值作为接口的具体实现而不是接口本身呢？唯一的变化是返回类型。

我很好奇，因为`IEnumerable<>`除了这两种情况外，扩展名的签名非常一致。我一直觉得这有点奇怪。

此外，为了让事情变得更加混乱，状态[文档`ToLookup()`](http://msdn.microsoft.com/en-us/library/bb549073.aspx)：

> 根据指定的键选择器函数从 IEnumerable 创建一个 Lookup。

但返回类型是`ILookup<TKey, TElement>`.

在[Edulinq](http://code.google.com/p/edulinq/)中，Jon Skeet 提到返回类型是`List<T>`而不是`IList<T>`，但没有进一步触及主题。
广泛搜索没有得到任何答案，所以我在这里问你：

**在不将返回值输入为接口的背后是否有任何设计决定，还是只是偶然？**

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-02-07T14:23:37.707

Returning`List<T>`的优点是那些`List<T>`不属于其中的`IList<T>`方法很容易使用。有很多事情你可以用 a 做`List<T>`而你不能用 a 做`IList<T>`。

相反，`Lookup<TKey, TElement>`只有一种`ILookup<TKey, TElement>`没有 ( `ApplyResultSelector`) 的可用方法，而且您可能最终也不会使用它。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-07T14:29:35.860

这类决定可能让人觉得很随意，但我猜是`ToList()`返回`List<T>`而不是接口，因为`List<T>`两者都实现了，但它添加了常规类型对象`IList<T>`中不存在的其他成员。`IList<T>`

例如，`AddRange()`。

看看`IList<T>`应该实现什么（[http://msdn.microsoft.com/en-us/library/5y536ey6.aspx](http://msdn.microsoft.com/en-us/library/5y536ey6.aspx)）：

```
public interface IList<T> : ICollection<T>, 
    IEnumerable<T>, IEnumerable 
```

并且`List<T>`（[http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)）：

```
public class List<T> : IList<T>, ICollection<T>, 
    IList, ICollection, IReadOnlyList<T>, IReadOnlyCollection<T>, IEnumerable<T>, 
    IEnumerable 
```

也许您自己的代码不需要`IReadOnlyList<T>`,`IReadOnlyCollection<T>`或`ICollection`，但 .NET Framework 和其他产品上的其他组件可能依赖于更专业的列表对象，这就是 .NET 开发团队决定不返回接口的原因。

不要觉得*总是返回一个接口*是最好的做法。如果您的代码或第三方代码需要这种封装。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-07T15:14:28.267

仅仅拥有`List`一个`IList`. 首先，`List`有`IList`没有的方法。您还*知道*实现是什么，这使您可以推断它的行为方式。您知道它可以有效地添加到结尾，但不能添加到开头，您知道它的索引器非常快，等等。

您无需担心结构被更改为 a`LinkedList`并破坏应用程序的性能。当涉及到这样的数据结构时，在很多情况下了解数据结构的实现方式确实很重要*，*而不仅仅是它遵循的合同。这是不应该改变的行为。

您也不能将 an 传递`IList`给接受 a 的方法`List`，这是您经常看到的。 `ToList`经常使用，因为该人确实需要 , 的实例`List`来匹配他们无法控制的签名，并且`IList`对此无济于事。

然后我们问自己回归有什么好处`IList`。好吧，我们可能会返回列表的其他一些实现，但如前所述，这可能*非常*有害后果，几乎可以肯定比使用任何其他类型可能获得的后果要多得多。使用接口而不是实现可能会给您带来温暖的模糊感，但即使在这种情况下，我也不认为这是一种好的心态（通常或）。通常，返回一个接口通常不如返回一个具体实现。“在你接受的东西上要自由，在你提供的东西上要具体。” 在可能的情况下，您的方法的参数应该是定义您需要的最少功能的接口，您的调用者可以传入任何您需要的实现，并且您应该提供与调用者一样具体的实现“允许”查看，以便他们可以尽可能多地处理该对象的结果。

所以现在我们继续前进，“为什么要返回`ILookup`而不是返回`Lookup`？” 嗯，首先`Lookup`不是公开课。`Lookup`中没有`System.Collections.*`。通过 LINQ 公开的`Lookup`类不公开公开构造函数。除了 through 之外，您无法*使用*该类`ToLookup`。它还没有公开尚未通过`ILookup`. 在这种特殊情况下，他们专门围绕这个确切的方法 ( `ToLookup`) 设计了接口，并且`Lookup`该类是专门为实现该接口而设计的类。由于所有这些，几乎所有讨论的要点`List`都不适用于这里。退货会不会有*问题*`Lookup`相反，不，不是。在这种情况下，这两种方式都无关紧要。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-07T14:31:38.990

在我看来，返回 a`List<T>`的理由是方法名称说`ToList`. 否则它必须被命名`ToIList`。`IEnumerable<T>`将非特定类型转换为特定类型正是此方法的目的`List<T>`。

如果您有一个名称不明的方法，例如`GetResults`，那么返回类型类似于`IList<T>`or`IEnumerable<T>`对我来说似乎很合适。

* * *

如果您查看`Lookup<TKey, TElement>`使用反射器的类的实现，您会看到很多`internal`成员，这些成员只能由 LINQ 本身访问。没有公共构造函数，`Lookup`对象是不可变的。因此，`Lookup`直接曝光没有任何优势。

`Lookup<TKey, TElement>`类似乎是一种 LINQ 内部的，不适合公共使用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-07T17:34:34.287

我相信返回 List<> 而不是 IList<> 的决定是调用 ToList 的更常见用例之一是强制立即评估整个列表。通过返回**List** <> 可以保证这一点。使用**IList** <> 实现仍然可以是惰性的，这会破坏调用的“主要”目的。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-02-07T14:17:45.320

通常，当您在某个方法上调用 ToList() 时，您正在寻找一个具体类型，否则该项目可能会保留为 IEnumerable 类型。除非您正在做一些需要具体列表的事情，否则您不需要转换为列表。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-02-08T02:37:08.347

这是程序员在使用接口和具体类型时难以理解的常见问题之一。

返回一个具体`List<T>`的实现`IList<T>`只会为方法使用者提供*更多信息*。这是 List 对象实现的（通过 MSDN）：

```
[SerializableAttribute]
public class List<T> : IList<T>, ICollection<T>, IList, ICollection, 
    IReadOnlyList<T>, IReadOnlyCollection<T>, IEnumerable<T>, IEnumerable 
```

作为 a 返回`List<T>`使我们能够在所有这些接口上调用成员，除了`List<T>`它本身。例如，我们只能`List.BinarySearch(T)`在 a 上使用`List<T>`，因为它存在于`List<T>`但不存在于 中`IList<T>`。

一般来说，为了最大限度地提高我们方法的灵活性，**我们应该将最抽象的类型作为参数**（即仅我们将要使用的东西）**并返回尽可能少的抽象类型**（以允许更多功能的返回对象）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-02-07T20:18:18.997

因为`List<T>`实际上实现了一系列接口，而不仅仅是 IList：

```
public class List<T> : IList<T>, ICollection<T>, IList, ICollection, IReadOnlyList<T>, IReadOnlyCollection<T>, IEnumerable<T>, IEnumerable{

} 
```

这些接口中的每一个都定义了列表必须符合的一系列特性。选择一个特定的，将使大部分实现无法使用。

如果您确实想返回 IList，没有什么能阻止您拥有自己的简单包装器：

```
public static IList<TSource> ToIList<TSource>(this IEnumerable<TSource> source)
{
    if (source == null) throw new ArgumentNullException(source);
    return source.ToList();
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-02-07T21:34:18.800

[简短的回答是，权威的框架设计指南](https://rads.stackoverflow.com/amzn/click/com/0321545613)通常建议返回最具体的可用类型。（抱歉，我手头没有引用，但我清楚地记得这一点，因为它与 Java 社区指南相反，后者更喜欢相反）。

这对我来说很有意义。例如，您总是可以这样做`IList<int> list = x.ToList()`，只有库作者需要关心是否能够支持具体的返回类型。

`ToLookup<T>`是人群中独一无二的。但完全符合准则：它*是*库作者愿意支持的最具体的可用类型（正如其他人所指出的，具体`Lookup<T>`类型似乎更像是一种不供公众使用的内部类型）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-02-07T15:50:10.463

如果一个函数返回一个新构造的不可变对象，调用者通常不应该关心返回的精确类型，只要它能够保存它包含的实际数据。例如，一个应该返回 an 的函数`IImmutableMatrix`通常可能返回`ImmutableArrayMatrix`由私有数组支持的 an ，但如果所有单元格都保存零，它可能会返回一个`ZeroMatrix`，仅由`Width`and`Height`字段支持（使用一个简单地返回零的 getter时间）。调用者不会关心它是否被赋予了一个`ImmutableArrayMatrix`矩阵或一个`ZeroMatrix`; 这两种类型都将允许读取它们的所有单元格，并保证它们的值永远不会改变，这就是调用者所关心的。

另一方面，返回允许开放式突变的新构造对象的函数通常应该返回调用者期望的精确类型。除非有一种方法可以让调用者请求不同的返回类型（例如通过调用`ToyotaFactory.Build("Corolla")`vs `ToyotaFactory.Build("Prius")`），否则声明的返回类型没有理由是其他任何东西。虽然返回不可变数据保存对象的工厂可以根据要包含的数据选择类型，但返回自由可变类型的工厂将无法知道可以放入哪些数据。如果不同的调用者有不同的需求（例如，回到现存的例子，一些调用者的需求可以通过数组来满足，而另一些则不会）他们应该可以选择工厂方法。

顺便说一句，类似的东西`IEnumerator<T>.GetEnumerator()`有点特殊。返回的对象几乎总是可变的，但仅限于非常严格的方式；实际上，期望返回的对象，无论其类型如何，都将只有一个可变状态：它在枚举序列中的位置。尽管`IEnumerator<T>`预期 an 是可变的，但在派生类实现中会发生变化的状态部分却不是。

# python - 表单中具有可变列/字段名称的独特 python/django 问题

> ID：14753208
> 
> 赞同：1
> 
> 时间：2013-02-07T14:14:46.323
> 
> 标签：python, django, django-forms

我对 django 有一个非常独特的问题。

我为编辑大数据提供网站用户界面。此数据上的每一行代表数据库中的一行。或者某个类型的一个对象。

用户单击表格中的单元格并打开表单，他们可以在其中编辑此字段/列值。

本质上它是这样工作的：1）根据用户点击的位置，查询被发送到包含对象ID和他正在编辑的字段的服务器。2）基于此信息表单是动态创建的：

```
class FieldEditorForm(forms.ModelForm):
    class Meta:
        model = MyObject
        fields = ['id', field ] 
```

请注意该字段有变量而不是该字段的名称。

3）这个字段通过了它自己的modelform验证，一切都很好。在保存方法 Model.save() 中足以更新值。

但现在问题来了。有时空值会以这种形式发送到服务器。空值，例如 u'' 或几乎为空的值，例如 u''。我想用 None 替换它，以便将 NULL 保存到数据库中。

有两个地方我可以做到这一点。在字段验证中修改cleaned_data 或表单保存方法。

这两种方法都会引发独特的问题，因为我不知道如何创建变量函数名称。

```
def clean_%(field)s(): 
```

或者在表单保存方法的情况下

```
r.%(field)s = None 
```

是我需要的，但这些方法不起作用。那么我如何创建可变的方法名称或将对象变量参数设置为某些东西。甚至有可能还是我必须重新考虑我的方法？

艾伦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:23:37.880

在后一种情况下，`setattr(r, field + 's', None)`。

# android - 自定义 ListView 不保存它的状态

> ID：14753210
> 
> 赞同：0
> 
> 时间：2013-02-07T14:14:49.213
> 
> 标签：android, listview, savestate, custom-adapter, custom-lists

`ListView`我正在使用带有`simle_list_item_multiple_choice`项目布局和自定义适配器的标准 android 。它保存了它在暂停时声明并在恢复时恢复。但是经过几天的工作，我已经在我的适配器中实现了接口，并`SectionIndexer`从这个[库](https://github.com/emilsjolander/StickyListHeaders)更改为。应用程序中还有其他更改，但这些更改仅附加到. 但是，现在当我的应用程序恢复工作时，列表视图将滚动到开始并且所有项目都未选中。我试图删除界面和粘性标题支持，但没有效果。也许我需要启用一些隐藏的列表视图选项？`StickyListHeadersAdapter``ListView``StickyListHeadersListView``ListView``SectionIndexer`

（试过的`saveState`财产 - 没有效果）

```
public class WordAdapter extends ArrayAdapter<Word> implements SectionIndexer, StickyListHeadersAdapter{
// -----------------------------------------------------------------------
//
// Fields
//
// -----------------------------------------------------------------------
private int mResID;

private List<Word> mList;
private String[] mSectionNames;
private StickyListHeadersListView mListView;
private int[] mSectionIndexes;
private boolean mHeadersEnabled;

// -----------------------------------------------------------------------
//
// Constructor
//
// -----------------------------------------------------------------------
public WordAdapter(Context context, StickyListHeadersListView listView, int resID, List<Word> list, String[] sectionNames, int[] sectionIndexes, boolean enableHeaders) {
    super(context, resID, list);
    mResID = resID;

    mList = list;
    mListView = listView;
    mSectionIndexes = sectionIndexes;
    mSectionNames = sectionNames;

    mHeadersEnabled = enableHeaders;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    ViewHolder holder;
    if (convertView == null) {
        convertView = LayoutInflater.from(getContext()).inflate(mResID, parent, false);
        holder = new ViewHolder();
        holder.root = convertView;
        holder.textView = (TextView) convertView.findViewById(android.R.id.text1);
        holder.checkBox = (CheckBox) convertView.findViewById(android.R.id.checkbox);

        convertView.setTag(holder);
    }
    holder = (ViewHolder) convertView.getTag();

    holder.textView.setText(getItem(position).getValue());
    if(mListView.isItemChecked(position))
        holder.root.setBackgroundColor(getContext().getResources().getColor(R.color.highlight));
    else
        holder.root.setBackgroundColor(getContext().getResources().getColor(android.R.color.transparent));
    return convertView;
}

@Override
public View getHeaderView(int position, View convertView, ViewGroup parent) {
    if(!mHeadersEnabled)
        return new View(getContext());

    HeaderViewHolder holder;
    if (convertView == null) {
        holder = new HeaderViewHolder();
        convertView = LayoutInflater.from(getContext()).inflate(R.layout.list_item_header, parent, false);
        holder.labelView = (TextView) convertView.findViewById(R.id.list_item_header_label);
        convertView.setTag(holder);
    } else {
        holder = (HeaderViewHolder) convertView.getTag();
    }

    String label;
    if(mSectionNames != null){
        label = mSectionNames[getSectionForPosition(position)];
        holder.labelView.setText(label);
    }
    return convertView;
}

@Override
public long getHeaderId(int position) {
    long result = getSectionForPosition(position);
    return result;
}

@Override
public int getPositionForSection(int section) {
    return (mSectionIndexes == null || section < 0 ) ? 0 : (section == mSectionIndexes.length ? mList.size():mSectionIndexes[section]);
}

@Override
public int getSectionForPosition(int position) {
    if(mSectionIndexes != null && position >= mSectionIndexes[0]) {
        for(int i = 0; i < mSectionIndexes.length; ++i)
            if(position < mSectionIndexes[i])
                return i-1;
        return (mSectionIndexes.length - 1);
    }
    return 0;
}

@Override
public Object[] getSections() {
        return mSectionNames == null ? new Object[0] : mSectionNames; 
}
// -------------------------------------------------------------------------------
//
// Internal classes
//
// -------------------------------------------------------------------------------
private static class ViewHolder {
    public View root;
    public TextView textView;
    public CheckBox checkBox;
}

private static class HeaderViewHolder {
    public TextView labelView;
} 
```

这是适配器代码。

# django - 在 Python 类中使用干净的函数有什么好处

> ID：14753211
> 
> 赞同：1
> 
> 时间：2013-02-07T14:14:55.687
> 
> 标签：django, class, python-2.7

我见过在许多 Python 类中定义的干净函数，但从未见过它显式调用。这个干净的功能是为了什么？

这是像`__init__()`函数一样自动调用吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T14:24:24.167

不，该`.clean()`方法特定于 Django。

这不是一般的 Python 约定。

它仅用于`Model`类，以提供自定义模型验证或用于相同类型任务的表单的`Form`各种`Field`类。Django 框架在处理表单输入时调用这些方法。

有关何时调用的更多信息，请参阅[表单和字段验证。](https://docs.djangoproject.com/en/stable/ref/forms/validation/)`.clean()`

请参阅[`Model.clean()`方法文档](https://docs.djangoproject.com/en/stable/ref/models/instances/#django.db.models.Model.clean)以了解这如何应用于模型验证。

# iphone - CoreData 插入非常大的数据库 exc_bad_access

> ID：14753213
> 
> 赞同：0
> 
> 时间：2013-02-07T14:15:06.477
> 
> 标签：iphone, objective-c, core-data, insert, nsentitydescription

我的数据库中有大约 60000 个值。我必须保留它们。但是在插入值时，我得到了 exc_bad_access。这是我的代码：

```
if (context == nil)
{
    context = [(radioAppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext];
    NSLog(@"After managedObjectContext: %@",  context);
}

[self performSelectorOnMainThread:@selector(deleteAllFromDB) withObject:nil waitUntilDone:YES];

// here is JSON parsing
int i=0;

@synchronized(self)
{
    NSLog(@"Start");
    NSEntityDescription *entity = [[NSEntityDescription entityForName:@"Station" inManagedObjectContext:context] autorelease];

    for (NSString*string in stations)
    {
        if (![string isEqualToString:@""])
        {
            Station*station = [[[Station alloc] initWithEntity:entity insertIntoManagedObjectContext:nil] retain];

            NSError *err = nil;
            id parsedData = [NSJSONSerialization JSONObjectWithData:[string dataUsingEncoding:NSUTF8StringEncoding]
                                                            options:NSJSONReadingMutableContainers error:&err];
            if (err) {
                NSLog(@"error is %@", [err localizedDescription]);
            }

            [station setName:[parsedData objectForKey:@"nm"]];

            [station setBit: [parsedData objectForKey:@"btr"]];
            [station setEnabled: [NSNumber numberWithInt:1]];

            //encoding id of the station

            scanner = [NSScanner scannerWithString:[parsedData objectForKey:@"id"]];

            [scanner scanHexInt:&tempInt];

            NSNumber *numb = [[NSNumber alloc]initWithInt:i];
            [station setNumber: [NSNumber numberWithInt:[numb intValue]]];

            //encoding country ID

            numb = [NSNumber numberWithInt:i];
            [station setCountryID: [NSNumber numberWithInt:[numb intValue]]];

            //encoding genre ID
            numb = [NSNumber numberWithInt:i];
            [station setGenerID:[NSNumber numberWithInt:[numb intValue]]];

            [station setOrder:[NSNumber numberWithInt:i]];

            [context insertObject:station];

            float k = [stations count];
            k = (i + 1)/k;

            [self performSelectorOnMainThread:@selector(increaseProgress:) withObject:[NSNumber numberWithFloat:k] waitUntilDone:YES];

            i++;

            [scanner release];
            [numb release];
            [station release];
            [parsedData release];
        }
    }

    [context save:nil];
    [entity release];

    NSLog(@"Stop"); 

    NSEntityDescription *entityGen = [NSEntityDescription entityForName:@"Genre" inManagedObjectContext:context];

    NSURL* urlForGenre = [NSURL URLWithString:@"xxx.xxx"];
    NSData *genres = [[NSData alloc] initWithContentsOfURL:urlForGenre];

    NSError *err = nil;
    NSArray *parsedGenres = [NSJSONSerialization JSONObjectWithData:genres options:NSJSONReadingMutableContainers error:&err];
    if (err)
    {
        NSLog(@"error is %@", [err localizedDescription]);
    }

    for (int i =0; i<parsedGenres.count; i++)
    {
        Genre*gen = [[Genre alloc] initWithEntity:entityGen insertIntoManagedObjectContext:nil];

        gen.name = [[parsedGenres objectAtIndex:i] objectForKey:@"nm"];

        int tempInt;
        NSScanner *scanner= [[NSScanner alloc] init];
        scanner = [NSScanner scannerWithString:[[parsedGenres objectAtIndex:i] objectForKey:@"id"]];

        [scanner scanInt:&tempInt];

        NSNumber *numb = [[NSNumber alloc] init];
        numb = [NSNumber numberWithInt:tempInt];

        gen.number = [NSNumber numberWithInt:[numb integerValue]];

        float k = [parsedGenres count];
        k = (i + 1)/k;

        [self performSelectorOnMainThread:@selector(increaseProgress:) withObject:[NSNumber numberWithFloat:k] waitUntilDone:YES];
        [context insertObject:gen];

        [gen release];
    }

    [entityGen release];
    [context save:nil];

    NSEntityDescription *entityCon = [NSEntityDescription entityForName:@"Country" inManagedObjectContext:context];

    NSURL* urlForCoun = [NSURL URLWithString:@"yyy.yyy"];
    NSData *countr = [[NSData alloc] initWithContentsOfURL:urlForCoun];

    err = nil;
    NSArray *parsedCountr = [NSJSONSerialization JSONObjectWithData:countr options:NSJSONReadingMutableContainers error:&err];
    if (err)
    {
        NSLog(@"error is %@", [err localizedDescription]);
    }

    NSMutableArray* temp = [[NSMutableArray alloc] init];

    for (int i =0; i<parsedCountr.count; i++)
    {
        Country*countr = [countr initWithEntity:entityCon insertIntoManagedObjectContext:nil];

        countr.name = [[parsedCountr objectAtIndex:i] objectForKey:@"nm"];

        int tempInt;
        NSScanner *scanner= [[NSScanner alloc] init];
        scanner = [NSScanner scannerWithString:[[parsedCountr objectAtIndex:i] objectForKey:@"id"]];

        [scanner scanInt:&tempInt];

        NSNumber *numb = [[NSNumber alloc] init];
        numb = [NSNumber numberWithInt:tempInt];

        countr.number = [NSNumber numberWithInt:[numb integerValue]];

        [temp addObject:countr];

        float k = [parsedCountr count];
        k = (i + 1)/k;

        [self performSelectorOnMainThread:@selector(increaseProgress:) withObject:[NSNumber numberWithFloat:k] waitUntilDone:YES];

        [context insertObject:countr];

        [countr release];
    }

    [context save:nil]; 
```

如果我的应用程序没有崩溃，是的，它不会在每次启动时发生。它崩溃：

```
Country*countr = [countr initWithEntity:entityCon insertIntoManagedObjectContext:nil]; 
```

请帮忙！对不起我糟糕的英语。

**更新：**

开启：Country*countr = [countr initWithEntity:entityCon insertIntoManagedObjectContext:nil];

> 线程 7：EXC_BAD_ACCESS（代码=1，地址=0x3f800008）

其他错误也是 exc_bad_access。但是使用 code=2 和其他线程。

**更新 2：**

我在调试方案中启用了僵尸模式。没啥事儿。

**更新 3：**

我觉得我的记忆有问题。

> GuardMalloc：VM 分配 4128 字节失败
> 
> GuardMalloc：显式陷入调试器！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:12:54.460

您不能`nil`作为`managedObjectContext`参数传递给`initWithEntity:insertIntoManagedObjectContext:`方法。尝试改变这个：

```
Country*countr = [countr initWithEntity:entityCon insertIntoManagedObjectContext:nil]; 
```

对此

```
// pass managed object context parameter
Country*countr = [countr initWithEntity:entityCon insertIntoManagedObjectContext:context]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-23T15:04:41.270

根据[文档](https://developer.apple.com/library/mac/documentation/cocoa/reference/CoreDataFramework/Classes/NSManagedObject_Class/Reference/NSManagedObject.html#//apple_ref/occ/instm/NSManagedObject/initWithEntity%3ainsertIntoManagedObjectContext%3a)和我的经验，您可以将 nil 作为 managedObjectContext 传递。

我也得到了一个 EXC_BAD_ACCESS，原因是我没有保留托管对象模型（我只是创建一个模型来获取实体描述，然后它被释放）。

特别是，这就是我正在做的事情：

在测试类中，在 setUp 方法中：

```
- (void)setUp
{
    [super setUp];

    NSBundle *bundle = [NSBundle bundleForClass:[self class]];
    NSURL *modelURL = [bundle URLForResource:@"TestDatamodel" withExtension:@"momd"];
    NSManagedObjectModel *model = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];
    STAssertNotNil(model, nil);

    _entity = [[model entitiesByName] objectForKey:NSStringFromClass([MyEntity class])];
    STAssertNotNil(_entity, nil);
    // ...
} 
```

然后在一个测试方法中，我创建了一个没有这样上下文的托管对象：

```
NSManagedObject *object = [[NSManagedObject alloc] initWithEntity:_entity insertIntoManagedObjectContext:nil]; 
```

我在这里得到了 EXC_BAD_ACCESS。

解决方案是向测试类添加一个 ivar 以保留对托管对象模型的引用。

# joomla - 扩展 Joomla 2.5 横幅组件

> ID：14753219
> 
> 赞同：1
> 
> 时间：2013-02-07T14:15:17.477
> 
> 标签：joomla

我真的希望有人能帮助我。

我需要能够在依赖于会话变量的类别中提供横幅 - 并且找不到这样做的组件。所以我想扩展 Joomla Banner 组件，以便根据包含类别路径的会话变量来选择横幅。

正确的会话变量被正确存储。

为了做到这一点，我在横幅模块中添加了一个选项，`.xml`以允许会话变量和会话变量的名称。`params`这与其他模块参数一起正确存储在字段内的模块表中。

然后我开始

> 组件 > 横幅 > com_banners > 模型 > banners.php

通过在组装的`getListQuery`地方添加两行代码。`SQL`他们是：

```
$sess_vars  = $this->getState('filter.sess_vars');
$sess_vars_name = $this->getState('filter.sess_vars_name'); 
```

但是这两个变量都不包含任何内容，即使可以很好地检索组件已经拥有的变量。毫无疑问，我也需要在其他地方改变一些东西——但就是不知道该怎么做。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T00:44:09.403

1.  首先要做的是**不要破解核心文件**，破解核心会阻止您使用内置更新功能来应用 Joomla 发布的常规错误修复和安全补丁！（例如最近发布*的[2.5.9 版本](http://www.joomla.org/announcements/release-news/5477-joomla-2-5-9-released.html)*2.5.9 版本）。

2.  而是复制它们并对其进行修改，以便将其称为其他名称，例如`com_mybanners`. 除了文件夹名称和入口点文件（即`banners.php`变为`mybanners.php`）之外，您还需要将组件更新`banners.xml`为`mybanners.php`.

    （*您将需要复制和修改前端`/components/com_banners/`和`/administrator/components/mybanners.php`。*）

3.  由于横幅的工作方式（即横幅显示在模块中），您还需要复制和修改`/modules/mod_banners/`,`/modules/mod_banners/mod_banners.php`和`/modules/mod_banners/mod_banners.xml`. 在每个位置更改`mod_banners`为。`mod_mybanners`

4.  在 Joomla！组件`state`通常在实例化 JModel 时填充，但是，在这种情况下，组件实际上是关于管理横幅和记录显示由`mod_banners`. 因此，您将需要添加一些代码来`mod_mybanners.php`使用您想要操作的会话变量。

    通常，当查询模型状态时，您将通过[JInput](http://docs.joomla.org/Retrieving_request_data_using_JInput)收集变量并将它们添加到对象的状态中，例如

```
protected function populateState()
{
    $jApp = JFactory::getApplication('site');

    // Load state from the request.
    $pk = $jApp->input->get('id',0,'INT');
    $this->setState('myItem.id', $pk);

    $offset = $jApp->input->get('limitstart',0,'INT');
    $this->setState('list.offset', $offset);

    // Load the parameters.
    $params = $app->getParams();
    $this->setState('params', $params);

    // Get the user permissions
    $user       = JFactory::getUser();
    if ((!$user->authorise('core.edit.state', 'com_mycomponent')) &&  (!$user->authorise('core.edit', 'com_mycomponent')))
    {
        $this->setState('filter.published', 1);
        $this->setState('filter.archived', 2);
    }
} 
```

当`populateState()`方法读取状态时调用该`getState`方法。

这意味着您将不得不更改您的副本`/components/com_banners/models/banner.php`以将变量捕获到与我上面的示例类似的对象状态中。

从那里它是你自己的所有代码。

您可以在[Joomla 文档网站上的](http://docs.joomla.org/)[开发模型-视图-控制器教程](http://docs.joomla.org/Developing_a_Model-View-Controller_Component/2.5)中找到所有这些信息

# python - 在另一个没有限定名称的情况下导入模块元素

> ID：14753227
> 
> 赞同：0
> 
> 时间：2013-02-07T14:15:50.360
> 
> 标签：python, python-import

我的问题很简单，但我找不到一个好的答案，因为搜索引擎对“模块”这个词模棱两可。我想做的大致是这样的：

*模块：a.py*

```
x = 2 
```

*模块：b.py*

```
import a 
```

现在，我希望能够在不使用限定名称的情况下进行访问`x`（`b`即不输入`a.x`，只需使用`x`）。在我的情况下，我不能使用：

```
from a import x 
```

因为我不知道`a`将包含哪些元素。我不能使用

```
from a import * 
```

两者都不。有没有简单的方法来合并或加入模块（我的意思是对象模块）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:19:10.877

这*不是*一个好主意，但您可以使用：

```
globals().update(vars(a)) 
```

*将模块中定义的所有*名称添加`a`到本地命名空间。这几乎与`from a import *`. `from a import *`要准确模拟，不使用`from a import *`自身，您必须使用：

```
globals().update(p for p in vars(a).items() if p[0] in getattr(a, '__all__', dir(a))) 
```

您通常只会使用`x = a.x`or `from a import x`。

如果您正在使用`zipimport`，则无需执行任何此操作。只需将存档路径添加到您的`sys.path`：

```
import sys
sys.path.insert(0, '/path/to/archive.zip')
from test import x 
```

# symfony - 使用 Doctrine 在 Symfony2.1 中实现好友列表

> ID：14753228
> 
> 赞同：0
> 
> 时间：2013-02-07T14:15:53.833
> 
> 标签：symfony, doctrine-orm, symfony-2.1

我想在中实现特定用户的朋友列表，`Symfony2.1`让`Doctrine.` 我们说朋友表：

```
User1 User2 Status     //0-pending request,1-accepted
A     B      0
A     C      1
D     A      1
E     A      1 
```

现在我想`A`在列表中获取朋友的名字。对于此`SQL`查询，可以`UNION`在许多其他答案中使用 as read 来实现。但我想在`doctrine query builder.` 一个选项中实现这一点，就像分别查询两列并将结果和排序结合起来。但这需要更多时间来执行并获得结果。我想尽快得到快速响应。有什么方法可以查询吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:06:45.850

**您不需要任何额外的努力**，例如使用 Doctrine Query Builder！

只需将实体类设计为与 User`User`具有[多对多自引用](http://docs.doctrine-project.org/en/latest/reference/association-mapping.html#many-to-many-self-referencing)，例如：

```
 * @ORM\Table()
 * @ORM\Entity()
 */
class User
{
....

    /**
     * @var string $name
     *
     * @ORM\Column(name="name", type="string", unique=true, length=255)
     * 
     */
    private $name;

    /**
     * @ORM\ManyToMany(targetEntity="User", mappedBy="myFriends")
     **/
    private $friendsWithMe;

    /**
     * @ORM\ManyToMany(targetEntity="User", inversedBy="friendsWithMe")
     * @ORM\JoinTable(name="friends",
     *      joinColumns={@ORM\JoinColumn(name="user_id", referencedColumnName="id")},
     *      inverseJoinColumns={@ORM\JoinColumn(name="friend_user_id", referencedColumnName="id")}
     *      )
     **/
    private $myFriends;

    public function __construct() {
        $this->friendsWithMe = new \Doctrine\Common\Collections\ArrayCollection();
        $this->myFriends = new \Doctrine\Common\Collections\ArrayCollection();
    }

} 
```

然后你可以简单地获取 User 实体并获取所有朋友如下：

```
$user = $this->getDoctrine()
                ->getRepository('AcmeUserBundle:User')
                ->findOneById($anUserId);
$friends = $user->getMyFriends();
$names = array();
foreach($friends as $friend) $names[] = $friend->getName(); 
```

# c# - 为什么“Session_end”不起作用？

> ID：14753240
> 
> 赞同：2
> 
> 时间：2013-02-07T14:16:22.560
> 
> 标签：c#, asp.net, asp.net-mvc-3

global.asax 文件中的事件是这样写的：

```
protected void Session_End(Object sender, EventArgs e)
{
    var x = 5;
} 
```

当客户端关闭窗口时，代码没有到达那里，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:17:18.427

> 当客户端关闭窗口时，代码没有到达那里，为什么？

因为当客户端关闭其浏览器时不应调用此事件。此事件（顾名思义）旨在在会话到期时调用。默认会话到期超时为 20 分钟，因此该事件将在客户端关闭其浏览器后 20 分钟调用。

哦，还有一个非常重要的问题您应该知道：如果您使用进程外会话状态模式（例如 StateServer 或 SqlServer），则**永远不会**调用此事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:21:52.757

PS：该`Session_End`活动仅由`InProc`会话管理器支持

当您的会话过期时，它会被调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:36:29.700

我认为您需要在页面关闭或文档卸载时使用 javascript 函数，即[onbeforeunload](https://stackoverflow.com/questions/5874182/window-unload-not-working-as-expected)。并在该函数中向服务器发出 ajax 请求，指示客户端正在关闭窗口。但是您应该注意安全性，因为这个 javascript在客户端注册的方法，恶意用户可以更改 ajax 请求（甚至阻止它）。如果你不考虑任何安全问题，你很高兴。祝你好运。

# python - 如何将值从 python 调用到 shell？

> ID：14753243
> 
> 赞同：0
> 
> 时间：2013-02-07T14:16:28.760
> 
> 标签：python, shell

```
import os  
url='http://106.3.62.196/mov.bn.netease.com/movieMP4/2011/3/U/1/S6V22L0U1.mp4?wsiphost=local'
os.system("wget -c $url  -O  test") 
```

os.system 语句无法运行。如何在这里将python中的url值发送到shell命令？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:20:53.697

代替

```
os.system("wget -c $url  -O  test") 
```

和

```
os.system("wget -c %s -O  test" % url ) 
```

您可能还想看看像 subprocess.call() 这样的东西是否适合您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:21:05.727

以下对我有用：

```
import os  
url='http://106.3.62.196/mov.bn.netease.com/movieMP4/2011/3/U/1/S6V22L0U1.mp4?wsiphost=local'
os.system("wget -c "+url+" -O  test") 
```

但是，在大多数情况下，这不是从 python 下载文件的最佳方式，当然也不是最便携的方式。

# jquery - 在不同页面上使用 jQuery Mobile 的 WebApp

> ID：14753245
> 
> 赞同：-1
> 
> 时间：2013-02-07T14:16:28.900
> 
> 标签：jquery, web-applications, jquery-mobile, sybase, sap

我正在使用 jQuery Mobile 框架来开发 Web 应用程序。

标准结构是，所有不同的布局都在同一个 html 页面中。

例如：

```
<div id="home">
        <a href="#one" data-transition="flip">Other Page</a>
</div>
<div id="one">
        <p> Other Layout </p>
</div> 
```

但我想使用一些 html 页面来获得清晰的结构。

问题是，一个简单的 href="page2.html" 在没有 ah 下一页的开关的情况下是行不通的。

此外，我想将 SAP 中的 webApp 与 BSP 页面和 Sybase 一起使用。（如果这对我们的答案很重要）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-21T13:08:04.067

我面临同样的问题，我解决如下：

```
<div id="home">
    <a href="page2.html" data-transition="flip" data-ajax="false">Other Page</a>
</div> 
```

如果您添加`data-ajax="false"`浏览器，则会将该页面作为外部页面加载，重新加载该页面并“跳过”尝试在`page`.

希望能帮助到你

# c - 在关键代码上使用互斥锁

> ID：14753247
> 
> 赞同：1
> 
> 时间：2013-02-07T14:16:32.657
> 
> 标签：c, multithreading

```
gcc 4.7.2
c89 
```

你好，

我只是想知道为以下代码片段应用互斥锁。

您是否应该遵循任何规则，因为我不想锁定，因为这会阻塞此函数中的其他线程。因为这真的会减慢速度。

我正在使用以下 CFLAGS 进行编译：

```
-Wall -Wextra -g -m32 -O2 -D_DEBUG -D_THREAD_SAFE -D_REENTRANT -D_LARGEFILE64_SOURCE 
```

代码片段

```
static void* APR_THREAD_FUNC timeout_duration(apr_thread_t *thd, void *data)
{
apr_status_t rv = 0;
channel_t *channel = NULL;

/*
  APPLY LOCK HERE
*/
channel = (channel_t*)data;

/* simulate some work */
apr_sleep(5000000);

LOG_INFO("Channel id [ %d ] Channel name [ %s ] Delay time [ %d ]",
         channel->id,
         channel->name,
         (apr_int32_t)channel->delay_time);

/*
  UNLOCK HERE
*/

return NULL;
} 
```

我将通道作为传递给入口函数的数据传递。但是，这不只是一个副本，所以我真的不需要担心吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:40:01.783

规则是：

1) 锁保护数据而不是代码。当数据受锁保护时，访问该数据的代码必须获取数据的锁。

2) 锁应该尽可能晚地获得并尽可能早地释放。这可以包括将工作从临界区内部转移到临界区外部。

3）只读取（而不是修改）的数据不需要锁。这包括`"Channel id [ %d ] ..."`格式字符串（应被视为常量）之类的内容。

4) 只能由一个线程访问的数据不需要锁。这包括函数参数和局部变量之类的东西。

5）细粒度锁定优于粗粒度锁定。例如，与其拥有一个带有一把锁的大型数据结构，您通常可以将该大型数据结构拆分为许多带有许多锁的较小结构。

6）如果任何代码一次需要多个锁，则需要定义“锁定顺序”。例如，如果一个线程获得锁A然后锁B，做一些工作然后释放锁；如果另一个线程获得锁B然后锁A，做一些工作然后释放锁；那么你可能会陷入死锁（每个线程都有一个锁，但都需要继续）。定义“锁定顺序”（例如说必须在锁定 B 之前获得锁定 A）可以防止这种错误。

对于您的代码，前几行根本不需要锁，因为它们只访问函数参数和局部变量（规则 4）。所指向的数据`void *data`可能需要也可能不需要锁，这取决于它是什么——例如，如果每个线程都有自己的单独数据（规则 4），或者如果该数据只被读取（规则 3），则不需要锁。对于该`LOG_INFO()`功能，您发布的代码中不需要额外的锁（`void *data`如果存在则不包括锁），但它可能有自己的内部锁（例如保护共享日志）。

对于规则 2 的示例，如果`LOCK_INFO`需要一些时间，您的代码可以执行以下操作以更早地释放第一个锁：

```
temp_ID = channel->id;
temp_name = strdup(channel->name);  // Should check for NULL!
temp_delay = channel->delay_time;

/*
  UNLOCK HERE
*/

LOG_INFO("Channel id [ %d ] Channel name [ %s ] Delay time [ %d ]",
         temp_ID,
         temp_name,
         temp_delay);
free(temp_name); 
```

另请注意，如果`LOCK_INFO()`使用锁，则提前释放第一个锁也有助于规则 6。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T14:28:07.717

如果您想在互斥锁解锁时读取此通道，请使用 pthread_mutex_trylock() 而不是 pthread_mutex_lock()。它的作用相同，但 pthread_mutex_trylock() 不是 blocant，基于它的返回值，您可以执行以下操作：

```
if (pthread_mutex_trylock(your_mutex))
{
    //Read the data.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:22:34.227

不，它不是副本，`data`它实际上只是*指向**数据*的指针，因此，您的线程和调用者上下文都可以访问相同的*数据*。现在，如果您可以保证两者（线程和调用者上下文）不会同时接触数据，那么线程函数中就不需要锁了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T14:25:06.977

您肯定需要担心它，因为它`data`是指向您的实际`channel_t`数据的指针。

但是，如果您想使用线程来并行工作，那么在持有锁的情况下进行很长时间的工作是没有意义的。更细粒度的锁会更好——但这当然假设完成的整体操作可以分成多个部分，使数据保持一致状态。

# ravendb - 自定义 Raven 修订文档 ID

> ID：14753250
> 
> 赞同：1
> 
> 时间：2013-02-07T14:16:36.870
> 
> 标签：ravendb

我已经使用`_docStore.Conventions.IdentityPartsSeparator = "-";`了普通的文档 ID，用于在 mvc 中使用它，但是当我使用修订文档 ID 时。我得到带有“/”的ID。有没有办法自定义修订 ID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T16:51:29.387

不，因为约定只是*客户端约定*。RavenDB 服务器无法知道您已经更改了约定。版本控制包从服务器端触发器运行。

# sql - 将类似的值分组为一个并添加相关的 COUNTS

> ID：14753251
> 
> 赞同：0
> 
> 时间：2013-02-07T14:16:37.430
> 
> 标签：sql, count, oracle10g

再次，我为我事先缺乏知识而道歉。如果我需要添加任何内容来帮助您回答我的问题，请尽管提问。开始....

我有这组数据：

```
PERMIT                              # OF PERMITS
Individual NPDES w/ construction    0   
Individual NPDES w/o construction   0   
Renewals (COWS)                     2   
Approvals w/ Construction           21  
Renewals (CHICKENS)                 25  
Approvals w/ Construction           1   
Approvals w/o construction          1   
Renewals (CHICKENS)                 1 
```

我需要做的是结合 PERMIT 列中的类似术语，并从许可数中添加相关计数。这可以做到吗？先感谢您。

系统：Oracle 10g

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:21:58.867

这将很难在主观基础上对行进行分组，我不建议你走这条路。相反，您应该创建一个名为“PERMIT GROUP”的第三列，以便您可以将每个许可组合在一起。完成后，查询您想要的内容变得简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:28:39.313

我认为这可以通过分析函数来完成。您需要按许可和计算对数据进行分区。总计与分区。这是基于 Oracle scott.emp 表的一般示例，您仅在该 deptno 中看到 count(*)。部门 = 10 有 3 名员工，20 有 5 名等...：

```
SELECT * FROM 
 (SELECT deptno, ename, job, sal,
     COUNT(*) OVER (PARTITION BY deptno) cnt
   FROM scott.emp)
  -- WHERE deptno = 10 -- optional 
 /

DEPTNO  ENAME   JOB         SAL     CNT
-------------------------------------------------------
10      CLARK   MANAGER     2450    3
10      KING    PRESIDENT   5000    3
....
20      JONES   MANAGER     2975    5
20      FORD    ANALYST     3000    5
....
30      WARD    SALESMAN    1250    6
30      TURNER  SALESMAN    1500    6 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:34:38.393

```
SELECT permitgroup, SUM(nrOfpermits)
FROM (SELECT substr(permit,1,instr(permit,' ')-1) permitgroup, nrOfpermits
      FROM permits)
GROUP BY permitgroup 
```

假设“相似术语”意味着以相同的单词开头，但您可以通过修改内部 SELECT 语句轻松更改相似性标准。

[测试代码](http://pastebin.com/x95DtYTU)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T15:48:59.257

让我假设您有一个`permits`包含所有许可值列表的表。

```
select p.permit, count(a.ACTIVITY_TASK_LIST) as NumPermits
from Permits p left outer join
     DSKMTB_ACTIVITY_TYPE.ACTIVITY_TASK_LIST a
     on p.permit = a.permit   -- assuming join is on the actual name
group by p.permit
order by 1 
```

我认为挑战在于`0`计数。您可以使用您想要的所有值的列表（我称之为“驱动程序”）来执行此操作，然后加入其余数据。

# haskell - 类型级文字 - 不能在二进制函数中使用不同类型的参数

> ID：14753252
> 
> 赞同：5
> 
> 时间：2013-02-07T14:16:38.897
> 
> 标签：haskell

使用[Type Level Literals](http://hackage.haskell.org/trac/ghc/wiki/TypeNats)作为一种使用 Maybe like 类型区分非空容器值（如幻像类型）的方法。

这很好用。（要求 GHC >= 7.6.1）

但试图定义一个二元函数（eq）

```
eq :: (Eq a) => TMaybe (sym :: Symbol) a -> TMaybe (sym :: Symbol) a -> Bool 
```

允许不同组的值，在使用时会发出编译错误信号：

无法匹配类型`"Just"' with`“Nothing”'

```
{-# LANGUAGE DataKinds, KindSignatures, GADTs, FlexibleInstances #-} 

import GHC.TypeLits

data TMaybe :: Symbol -> * -> * where
  TNothing  :: TMaybe "Nothing" a
  TJust :: a -> TMaybe "Just" a

nonEmpty :: Maybe a -> TMaybe "Just" a
nonEmpty (Just x) = TJust x
nonEmpty Nothing = error "invalid nonEmpty data"

-- this fromJust rejects TNothing at compile time  
fromJust :: (sym ~ "Just") => TMaybe (sym :: Symbol) a -> a
fromJust (TJust x) = x

tmbToMaybe :: TMaybe (sym :: Symbol) a -> Maybe a
tmbToMaybe TNothing = Nothing
tmbToMaybe (TJust x) = Just x

mbToTNothing Nothing = TNothing

mbToTJust (Just x) = TJust x

instance Eq a => Eq (TMaybe (sym :: Symbol) a) where
     TNothing == TNothing = True
     TJust x == TJust y = x == y
     _ == _ = False    -- useless, equal types required

instance Ord a => Ord (TMaybe (sym :: Symbol) a) where
     compare TNothing TNothing = EQ
     compare (TJust x) (TJust y) = Prelude.compare x y
     compare TNothing _ = LT   -- useless, equal types required
     compare _ TNothing = GT   -- useless, equal types required

instance  Functor (TMaybe (sym :: Symbol))  where
    fmap _ TNothing       = TNothing
    fmap f (TJust a)      = TJust (f a)

instance  Monad (TMaybe "Just") where
    (TJust x) >>= k      = k x

    (TJust _) >>  k      = k

    return            = TJust
    fail _              = error "can't fail to TNothing"

--------------------------

-- defining eq to admit parameter types with different symbol

eq :: (Eq a) => TMaybe (sym :: Symbol) a -> TMaybe (sym :: Symbol) a -> Bool
eq TNothing TNothing = True
eq (TJust x) (TJust y) = x == y
eq _ _ = False

---------------------------

-- Test

main = do
        print $ fromJust $ TJust (5::Int)   -- type-checks
        -- print $ fromJust TNothing   -- as expected, does not type-check

        -- print $ TNothing == TJust (5::Int)  -- as expected, does not type-check, types required equal at function def.
        print $ TNothing `eq` TJust (5::Int)   -- does not type-check either 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T15:00:40.720

嗯，你的类型

```
eq :: (Eq a) => TMaybe (sym :: Symbol) a -> TMaybe (sym :: Symbol) a -> Bool 
```

要求两个参数具有相同的类型，因此编译器当然会拒绝比较 a`TMaybe "Nothing" a`和 a的尝试`TMaybe "Just" a`。

如果您将类型更改为

```
eq :: (Eq a) => TMaybe (sym :: Symbol) a -> TMaybe (sym1 :: Symbol) a -> Bool 
```

它编译并

```
TNothing `eq` TJust (5::Int) 
```

评估为`False`。（然后，您需要`TNothing`在许多地方明确确定 s 的类型。）

# asp.net-web-api - WebAPI 未写入 Trace.axd

> ID：14753258
> 
> 赞同：2
> 
> 时间：2013-02-07T14:16:52.263
> 
> 标签：asp.net-web-api, trace

我有一个 WebAPI 应用程序（使用 RC），我正在尝试将消息写入应用程序跟踪。我尝试按照[这里](http://www.asp.net/web-api/overview/testing-and-debugging/tracing-in-aspnet-web-api)的教程进行操作，它让我实现了 ITraceWriter，并在 Global.asax 中启用了它。

我这样做了，在调试时，它在我的 SimpleTracer 类中遇到断点，但是当我访问 Trace.axd 时，我的跟踪信息部分是空白的。我也尝试直接写入跟踪`System.Diagnostics.Trace.WriteLine("Hello, world!");`，它仍然是空白的。

我会错过什么？RC版本可能没有这个功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:13:30.733

虽然不是您问题的直接答案，但您是否使用过使用 System.Diagnostics 启用 ASP.NET Web API 跟踪的官方 NuGet 包（[此处）？](http://nuget.org/packages/Microsoft.AspNet.WebApi.Tracing)这在 2012 年 8 月作为 alpha 版本发布（在您创建示例的博客之后的某个时间），现在处于 RC 级别。

这里有关于如何安装的[说明](http://blogs.msdn.com/b/roncain/archive/2012/08/16/asp-net-web-api-tracing-preview.aspx)。如果您希望继续使用它，这也可以帮助您进行自定义。

# php - 在 PHP 消息中检测垃圾邮件的最佳方法是什么

> ID：14753260
> 
> 赞同：3
> 
> 时间：2013-02-07T14:16:53.870
> 
> 标签：php, mysql, spam, spam-prevention

我正在努力与试图联系其他用户并要钱的用户进行战斗。他们通常来自尼日利亚或加纳。

我尝试过的几件事是在注册时根据他们的 IP 完全阻止这些国家。我还尝试检测类似的消息内容并将每天发送的消息数量限制为 5 条。

他们是否有任何可用的 PHP 类可以更好地或以不同的方式处理这个问题？

根据发送的消息检测和删除这些用户是一场日常战斗。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T14:21:20.387

**检测垃圾邮件**

Paul Graham 阐述了可以过滤掉垃圾邮件内容的贝叶斯过滤器背后的理论：

[http://www.paulgraham.com/spam.html](http://www.paulgraham.com/spam.html) 和 [http://paulgraham.com/better.html](http://paulgraham.com/better.html)

搜索可以对文本块进行贝叶斯过滤的 PHP 代码。允许邮件的读者“将邮件标记为垃圾邮件”并将其用作贝叶斯过滤器的输入。尽可能多地复制 Gmail 的用户界面，以便人们知道该怎么做。

**Google 如何使用 Gmail 中的技术来打击垃圾邮件：**

[http://googlesystem.blogspot.com/2007/10/how-gmail-blocks-spam.html](http://googlesystem.blogspot.com/2007/10/how-gmail-blocks-spam.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T14:20:10.353

[使用像Askimet](http://akismet.com/about/)这样的外部服务。它是免费供个人使用的。

# python - 山狮中的 Numpy 单元测试失败

> ID：14753261
> 
> 赞同：1
> 
> 时间：2013-02-07T14:17:03.317
> 
> 标签：python, unit-testing, numpy, scipy, osx-mountain-lion

我正在尝试在我的 Mac OS 10.8.2 上为 Python 2.7.2 安装 SciPy。我更新了 XCode 4.6 并安装了命令行工具。我按照此线程[Numpy Installation on Mac 10.8.2中的建议使用 pip 安装了 numpy，并且正在使用 High Performance Computing for Mac 网站 (](https://stackoverflow.com/questions/13106919/numpy-installation-on-mac-10-8-2) [http://hpc.sourceforge.net/](http://hpc.sourceforge.net/) )中的 Fortran 编译器。

我可以安装 numpy，但是当我尝试运行内置的 SciPy 单元测试时（如此处 SciPy 的安装文档中所建议的那样[）](http://www.scipy.org/Installing_SciPy/Mac_OS_X)，我继续获得 FAIL 以测试基本算术函数。

任何建议将不胜感激。

```
Python 2.7.2 (default, Jun 20 2012, 16:23:33) 
[GCC 4.2.1 Compatible Apple Clang 4.0 (tags/Apple/clang-418.0.60)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import numpy as np
>>> np.test('full')
Running unit tests for numpy
NumPy version 1.6.1
NumPy is installed in /System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/numpy
Python version 2.7.2 (default, Jun 20 2012, 16:23:33) [GCC 4.2.1 Compatible Apple Clang 4.0 (tags/Apple/clang-418.0.60)]
nose version 1.2.1
..................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................F............................................................................................................................................................................................................................................................................................................................................................................................................................K.................................................................................................K......................K..................................................................................................................................................................................................................................................................................................................................................................................................................................................................................F..............................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................S.....................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
======================================================================
FAIL: Test basic arithmetic function errors
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/numpy/testing/decorators.py", line 215, in knownfailer
    return f(*args, **kwargs)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/numpy/core/tests/test_numeric.py", line 321, in test_floating_exceptions
    lambda a,b:a/b, ft_tiny, ft_max)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/numpy/core/tests/test_numeric.py", line 271, in assert_raises_fpe
    "Type %s did not raise fpe error '%s'." % (ftype, fpeerr))
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/numpy/testing/utils.py", line 34, in assert_
    raise AssertionError(msg)
AssertionError: Type <type 'numpy.complex64'> did not raise fpe error ''.

======================================================================
FAIL: test_kind.TestKind.test_all
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Library/Python/2.7/site-packages/nose/case.py", line 197, in runTest
    self.test(*self.arg)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/numpy/f2py/tests/test_kind.py", line 30, in test_all
    'selectedrealkind(%s): expected %r but got %r' %  (i, selected_real_kind(i), selectedrealkind(i)))
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/numpy/testing/utils.py", line 34, in assert_
    raise AssertionError(msg)
AssertionError: selectedrealkind(19): expected -1 but got 16

----------------------------------------------------------------------
Ran 3552 tests in 35.919s

FAILED (KNOWNFAIL=3, SKIP=1, failures=2)
<nose.result.TextTestResult run=3552 errors=0 failures=2>
>>> 
```

相关线程建议使用 Chris Fonnesbeck 的 SciPy Superpack 安装程序脚本，但这似乎是为 OS 10.7 构建的。

我的 gcc 版本是 4.2.1，我的 gfortran 版本是 4.8.0

先感谢您。

# google-app-engine - Google 表单作为多项选择测验 - 如何提供结果

> ID：14753264
> 
> 赞同：0
> 
> 时间：2013-02-07T14:17:11.250
> 
> 标签：google-app-engine, google-apps-script, google-spreadsheet-api, google-sites

我已经为多项选择测验建立了一个谷歌表格，并带有一个用于结果的链接电子表格，效果很好。我有一个具体的问题，那就是我想向他们展示用户的结果（即他们得到了多少正确/错误的答案）。到目前为止我采取的方法是：

*   在电子表格上创建一个额外的表格，其中包含一个公式来计算每个响应的正确答案数量。这给了我两列“全名”和“分数”
*   将表单嵌入谷歌网站
*   创建一个谷歌应用程序脚本来读取结果表并显示输出
*   将上述内容作为 Apps 脚本小工具嵌入到表单下方的同一站点中

目前我能够显示到目前为止记录的所有结果。看这里：

[https://sites.google.com/site/mcqtest123/home](https://sites.google.com/site/mcqtest123/home)

脚本如下所示：

```
// Script-as-app template.
function doGet() {
  var app = UiApp.createApplication();

  var title = app.createLabel("Survey Results").setStyleAttribute("fontSize","16px");
  app.add(title);

  //readRows(app);
  calculateScores(app);

  return app;
};

function calculateScores(app) {
  var sheet = SpreadsheetApp.openById("0AlNR-ou0QtandFFzX1JCU1VRdTl0NVBRNTFjOUFhd1E");
  var responseSheet = sheet.getSheetByName("Form Responses");
  var allData = responseSheet.getDataRange().getValues();

  var correct = allData[1];
  var responses = allData.slice(2);

  //Logger.log("Timestamp, name, score");
  Logger.log("Name, Score");
  for (var i = 0; i < responses.length; i++) {
    var timestamp = responses[i][0];
    var name = responses[i][1];
    var score = 0;
    for (var j = 2; j < correct.length; j++) {
      if(responses[i][j] == correct[j]) {
        score += 1;
      }
    }  
    //var output = timestamp + ", " + name + ", " + score + "/" + correct.length
    var output = name + ", " + score + "/" + correct.length
    print(app, output);
  }
};

function print(app, line) {
  Logger.log(line);
  app.add(app.createLabel(line));
}; 
```

所以这留下了两个问题：

1.  当页面加载时，它会加载*所有*受访者的分数。我希望能够只为填写表格的人提供分数。

2.  表格完成后分数不会更新 - 只有在页面刷新时才会更新。

对于问题 1），我想知道是否有某种方法可以访问 iframe 表单中的数据（例如，使用`document.getElementById('targetFrame')`，除了 google 脚本似乎无法访问文档模型）以仅显示全名的人的结果匹配表单中的名称（当然，如果您知道其他人的全名是什么，那么您可以查看其他人的结果，但不使用时间戳我看不到这一点）。

对于问题 2)，我想知道在更新响应表时是否有某种方法可以触发脚本。但是，当我转到电子表格和工具-> 脚本管理器时，我收到消息“未找到脚本”，所以我不知道如何添加此触发器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:25:38.570

如果您使用 HtmlService 或 UiApp 创建自己的表单，然后将其发布到您的脚本以填充电子表格，那么您可以在隐藏字段中生成 UID 并使用它来确定某人需要查看的结果。

这将是他们对测验答案的即时反馈结果。要在以后查看这些内容，您还可以添加一个书签链接，该链接也包含该 UID 作为参数。所以你的 doGet() 会寻找一个`e.parameters.uid`例子。

从谷歌表单来看，我不太确定。您可能会使用新的表单样式提供具有此类 UID 的预填充字段，但从表单提交到您的 web 应用程序的路线仍然不清楚。

# tomcat - 了解非数学背景的 apache solr 评分

> ID：14753268
> 
> 赞同：1
> 
> 时间：2013-02-07T14:17:21.313
> 
> 标签：tomcat, solr, lucene

[我在这里](http://lucene.apache.org/core/3_6_2/scoring.html#Understanding%20the%20Scoring%20Formula)学习 apache solr 评分方法。这里说你应该去[这个](http://lucene.apache.org/core/3_6_2/api/core/org/apache/lucene/search/Similarity.html)页面了解评分公式。因为我不是数学背景，所以我很难理解高水平的数学。***有没有其他方法可以轻松理解基本评分公式？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:58:11.283

Lucene 使用许多特征来对文档进行评分，但基本上评分依赖于文档和查询之间的相似性。我之前用或多或少的简单语言解释了[计算文档之间相似度的想法，所以让我在这里简单地解释一下。](http://forcedelay.wordpress.com/2012/01/08/how-semantically-similar-are-2-text-documents/)

如果你有所有单词的字典，你可以将它们组织成很长的列表。数学家习惯于对任何序列使用术语“向量”，包括单词列表，所以我们称之为单词向量：

> [阿巴特，关于，香蕉，...]

我们也可以将集合中的每个文档表示为向量，其中每个元素代表该文档中相应单词的出现次数。例如，如果文档中出现了 1 次单词“bananas”，出现了 2 次“about”并且没有出现“abbat”，那么文档向量将按如下方式开始：

> [0, 2, 1, ...]

现在最有趣的部分来了。我们可以假设，如果两个文档有很多共同词，它们是关于相似的主题，如果它们的共同点很少，那么这些文档是非常不同的。由于我们已经知道文档可以表示为单词的向量，因此我们可以将文档的相似度计算为它们的向量的相似度。

有很多方法可以计算 2 个向量的相似程度。Lucene 使用非常简单的余弦距离。这个想法来自向量的几何表示和它们之间的角度——如果你在 2D 空间中绘制 2 个向量，你会发现这些向量的坐标越相似，它们之间的角度就越小。这就是余弦距离的来源，但实际上您应该只关心 2 个文档中相同单词的数量。

在处理搜索引擎任务时，查询被视为文档：为它们构建文档向量，然后用于从集合中查找最相似（即相关）的文档。

# javascript - 用于脚本的 Web 服务器上的 Photoshop

> ID：14753274
> 
> 赞同：1
> 
> 时间：2013-02-07T14:17:38.910
> 
> 标签：javascript, webserver, photoshop, photoshop-script

所以，我试图想出解决我遇到的问题的最佳方法。

问题是我为我的工作制作了许多网站，并且随着 CSS3 和 HTML5 的强大自我介绍，我想从我的网站中删除几乎所有的图像。对于按钮图标和其他各种东西，我有一个精灵图像，上面有所有图标，我只是根据需要的图标来回移动。我需要做的是在网络服务器上动态地重新着色此图像，这样我就不必打开 Photoshop 并手动重新着色图标。

我已经做了一些研究，我遇到的唯一有机会按照我想要的方式工作的是 Photoshop JavaScript。我的问题是，一旦我编写了脚本并重新着色了我的图标图像，是否可以在服务器上完成，例如，当用户单击按钮时，图像被重新着色并保存到服务器？

这需要在服务器上安装 Photoshop 吗？这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-20T10:01:15.580

如您所知，Photoshop 仅适用于 Mac 或 Windows。

据我所知，您无法在 Windows Server 上安装 Photoshop。（我自己用 CS4 试过 - 也许它适用于 CS6 knowadays）。但是你可以在防火墙后面的 Win 7 机器上安装 PS。

如果您使用 Windows 机器，您可以使用 COM 进行自动化。我试过了，效果很好。

我在中等流量的网页上使用两台 Mac 和 PS Javascript（Imagemagick、PIL 等对我不起作用，因为工作太复杂）做了类似的事情。所以我不同意迈克尔斯的回答。

第一件事：考虑缓存图像并使用低流量时间来计算将来可能需要的图像。这真的让我的事情变得更容易了。

第二件事：尝试图像大小、dpi 等。图像越小 - 处理越快。

我的工作流程是：

*   网络服务器正在写入数据库（“嘿，我需要一个名为“path/bla.jpg”的新图像）。
*   Ajax 调用正在检查图像是否存在。如果不是 - 显示“处理您的请求占位符”
*   在防火墙后面的 mac 上无限循环运行的脚本不断检查是否需要新图像。
*   如果它找到一个它正在更新数据库（“Mac One 将计算这项工作”）。这可以防止每台 Mac 都使用新映像。
*   该脚本正在调用 Photoshop。Photoshop 正在计算图像。
*   该脚本将图像（我使用 rsync）上传到网络服务器。
*   ajax-call 看到新图像并将其呈现给用户。
*   Mac 上的脚本更新数据库“图像成功创建”。

您将需要一些错误处理逻辑等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-05T15:11:09.973

嗯，这个问题也困扰了我很多年.. 我一直希望有一个 Photoshop 服务器，我可以通过 API 交谈并完成工作.. 好吧.. 我已经构建了一些更接近的东西......使用生成器插件我可以连接一个网络套接字并在 Photoshop 中注入 javascript。从技术上讲，您可以使用[Photoshop 脚本指南](http://www.adobe.com/cn/devnet/photoshop/scripting.html)完成任何可以完成的事情。...（包括操纵现有的 PDS）

这个库[https://github.com/Milewski/generator-exporter](https://github.com/Milewski/generator-exporter)使用特殊语法导出所有标记的图层作为其所需格式...此代码可以在服务器上运行..使用 nodejs

```
import { Generator } from 'generator-exporter'
import * as glob from 'glob'
import * as path from 'path'

const files = glob.sync(
    path.resolve(__dirname, '**/*.psd')
);

const generator = new Generator(files, {
    password: '123456',
    generatorOptions: {
        'base-directory': path.resolve(__dirname, 'output')
    }
})

generator.start()
         .then(() => console.log('Here You Could Grab all the generated images and send back to client....')); 
```

但是，我不建议将其用于过多并发任务的大量使用...因为它需要在本地安装 Photoshop...Photoshop GUI 将被初始化..这个过程很慢。所以它并不适合繁忙的工作流程。

# python - 附加值的类的 Python 字典分配给所有字典条目

> ID：14753275
> 
> 赞同：0
> 
> 时间：2013-02-07T14:17:39.987
> 
> 标签：python, class, dictionary, append

我有一本字典，其中 ID 作为键，类作为条目。当我尝试附加到一个特定类的变量时，字典中的所有其他类也被附加到。

```
class Reaction:
    def __init__(self, bkm_id, ec_nums = [], b_ids = [], k_ids = [], m_ids = [], source = ''):
        self.bkm_id = bkm_id
        self.ec_nums = ec_nums
        self.b_ids = b_ids
        self.k_ids = k_ids
        self.m_ids = m_ids
        self.source = source

        self.substrates = []
        self.products = []

    def add_metabolite(self, metabolite, stoichiometry, subs_prod):
        if subs_prod == 'S':
            self.substrates.append(Substrate_Product(metabolite, stoichiometry))
        elif subs_prod == 'P':
            self.products.append(Substrate_Product(metabolite, stoichiometry)) 
```

定义类。然后，如果我输入：

```
rxna = Reaction('a')

rxnb = Reaction('b')

dict = {}

dict['a'] = rxna

dict['b'] = rxnb

dict
Out[14]: 
{'a': <__main__.Reaction instance at 0x102c51fc8>,
 'b': <__main__.Reaction instance at 0x102c62518>}

dict['a'].b_ids.append('BID')

dict['a'].b_ids
Out[16]: ['BID']

dict['b'].b_ids
Out[17]: ['BID']

rxnb.b_ids
Out[18]: ['BID'] 
```

而我只想将“BID”附加到 rxna.b_ids。我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:20:53.200

这些列表在类定义时创建一次，因此由所有实例共享。你自找的：

```
class Reaction:
    def __init__(self, bkm_id, ec_nums=None, b_ids=None, k_ids=None, m_ids=None, source = '')
        self.bkm_id = bkm_id
        self.ec_nums = ec_nums
        self.b_ids = b_ids or []
        self.k_ids = k_ids or []
        self.m_ids = m_ids or []
        self.source = source

        self.substrates = []
        self.products = []

    def add_metabolite(self, metabolite, stoichiometry, subs_prod):
        if subs_prod == 'S':
            self.substrates.append(Substrate_Product(metabolite, stoichiometry))
        elif subs_prod == 'P':
            self.products.append(Substrate_Product(metabolite, stoichiometry)) 
```

这就是为什么你从不使用可变对象作为参数默认值的原因（好吧，除非你有充分的理由）。

# powershell - Powershell获取用户拥有的文件的总大小

> ID：14753279
> 
> 赞同：2
> 
> 时间：2013-02-07T14:17:49.767
> 
> 标签：powershell, size

我需要一个powershell脚本，它将遍历系统中的所有用户，并找到任何用户拥有的所有文件的总大小......我有一个正在遍历所有用户的脚本，但是我不知道继续计数用户为每个用户拥有的总大小

这是一个脚本，我现在已经：

```
$users = Get-WmiObject -class Win32_UserAccount

foreach($user in $users) {
    $name = $user.Name
    $fullName = $user.FullName;
    if(Test-Path "C:\Users\$name") {
        $path = "C:\Users\$name"
    } else {
        $path = "C:\Users\Public"
    }

    $dirSize = (Get-ChildItem $path -recurse | Measure-Object -property length -sum)
 "{0:N2}" -f ($dirSize.sum / 1Gb) + " Gb"
echo "$dirSize"

Add-Content -path "pathototxt..." -value "$name $fullName $path"

} 
```

如果有人知道答案并告诉我，我会非常高兴...谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:53:38.863

如果有很多文件，您可能需要考虑：

```
$oSIDs = @{}

get-childitem <filespec> |
 foreach {
  $oSID = $_.GetAccessControl().Sddl -replace '^o:(.+?).:.+','$1'
  $oSIDs[$oSID] += $_.length
  } 
```

然后在完成后解析 SID。从 SDDL 字符串中解析所有者 SID 或众所周知的安全主体 ID，使提供者不必进行大量重复的名称解析以返回“友好”名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:45:45.070

我不知道你在这里要求什么。 `"to continue with counting total size which user owns for each user"`. 嗯？想要检查系统上的每个文件还是只检查当前用户文件夹？

如果您只是调整它以在输出中包含文件大小，您的脚本就可以正常工作。就我个人而言，我会考虑使用 csv 来存储它，因为并非所有用户都会拥有例如全名（管理员、访客等）。还有，自动取款机。您的脚本多次计算公用文件夹（每次用户没有个人资料时）。例如 admin（如果它从未登录过）、guest 等可能都会指定它。

更新了输出文本文件和 csv 的脚本

```
$users = Get-WmiObject -class Win32_UserAccount

$out = @()
#If you want to append to a csv-file, replace the $out line above with the one below
#$out = Import-Csv "file.csv"

foreach($user in $users) {
    $name = $user.Name
    $fullName = $user.FullName;
    if(Test-Path "C:\Users\$name") {
        $path = "C:\Users\$name"
    } else {
        $path = "C:\Users\Public"
    }

    $dirSize = (Get-ChildItem $path -Recurse  -ErrorAction SilentlyContinue | ? { !$_.PSIsContainer } | Measure-Object -Property Length -Sum)
    $size = "{0:N2}" -f ($dirSize.Sum / 1Gb) + " Gb"

    #Saving as textfile
    #Add-Content -path "pathototxt..." -value "$name $fullName $path $size"
    Add-Content -path "file.txt" -value "$name $fullName $path $size"

    #CSV-way
    $o = New-Object psobject -Property @{
    Name = $name
    FullName = $fullName
    Path = $path
    Size = $size
    }

    $out += $o
}

#Exporting to csv format
$out | Export-Csv "file.csv" -NoTypeInformation 
```

**编辑：**使用@mjolinor 和@CB 提供的答案的另一种解决方案已修改以扫描您的`c:\`驱动器，同时排除一些“根文件夹”，如“程序文件”、“windows”等。它将结果导出到准备用于 Excel 的 csv 文件。：

```
$oSIDs = @{}

$exclude = @("Program Files", "Program Files (x86)", "Windows", "Perflogs"); 

Get-ChildItem C:\ | ? { $exclude -notcontains $_.Name } | % { Get-ChildItem $_.FullName -Recurse -ErrorAction SilentlyContinue | ? { !$_.PSIsContainer } } | % {
  $oSID = $_.GetAccessControl().Sddl -replace '^o:(.+?).:.+','$1'
  $oSIDs[$oSID] += $_.Length
  }

$out = @()
$oSIDs.GetEnumerator() | % { 
    $user = (New-Object System.Security.Principal.SecurityIdentifier($_.Key)).Translate([System.Security.Principal.NTAccount]).Value
    $out += New-Object psobject -Property @{
        User = if($user) { $user } else { $_.Key }
        "Size(GB)" = $oSIDs[$_.Key]/1GB
    }
}

$out | Export-Csv file.csv -NoTypeInformation -Delimiter ";" 
```

# c# - 如何为我的应用程序提供透明的标题栏和菜单，如 Firefox

> ID：14753288
> 
> 赞同：0
> 
> 时间：2013-02-07T14:18:13.933
> 
> 标签：c#, winforms

我怎样才能使标题栏和菜单栏像这样在我的 Windows 应用程序中一样？

![在此处输入图像描述](../Images/7ec72eacbcb87bd2eb0cf61f23b6ea67.png)

# ios - UITabBarButton 无需切换到另一个视图

> ID：14753290
> 
> 赞同：0
> 
> 时间：2013-02-07T14:18:23.980
> 
> 标签：ios, xcode, uitabbarcontroller, uitabbaritem

有谁知道有一个 UITabBarButton 的方法，而不是转到另一个视图控制器，而是执行另一个功能，例如调用一个方法？

我的 iPad 应用程序使用标签栏，但客户端希望最右边的按钮执行服务器上的更新检查；但是我似乎无法弄清楚如何拥有一个在按下时不会切换视图的按钮。我尝试删除segue，但这也删除了按钮。

-EDIT- 为清晰起见添加了屏幕截图和代码片段。标记的选项卡`Sync`是我不想打开 viewController 的选项卡：

![在此处输入图像描述](../Images/7cc3db66518e08e182053eb314f377c6.png)

AppDelegate.h：

```
@interface AppDelegate : UIResponder <UIApplicationDelegate, UITabBarControllerDelegate>

@property (strong, nonatomic) UIWindow *window;
@property (strong, nonatomic) UIViewController *viewController;

@end 
```

AppDelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    [self.window makeKeyAndVisible];       
    UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;
    tabBarController.delegate = (id)self;

   [[NSNotificationCenter defaultCenter] addObserver:self  selector:@selector(applicationDidTimeout:) name:kApplicationDidTimeoutNotification object:nil];

    return YES;
} 
```

和：

```
- (BOOL)tabBarController:(UITabBarController *)tabBarController shouldSelectViewController:(UIViewController *)viewController {

    NSLog(@"vc = %@", viewController);
    return YES;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:20:25.443

看`UITabBarControllerDelegate`方法：

```
– tabBarController:shouldSelectViewController: 
```

如果`selectViewController`== 您的最后一个标签栏，`return NO`并执行其他操作

编辑 ：

看看我做的例子：

AppDelegate.h

```
@interface ISAppDelegate : UIResponder <UIApplicationDelegate, UITabBarControllerDelegate>

@property (strong, nonatomic) UIWindow *window;

@end 
```

AppDelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.

    UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;
    tabBarController.delegate = (id)self;

    return YES;
}

- (BOOL)tabBarController:(UITabBarController *)tabBarController shouldSelectViewController:(UIViewController *)viewController {

    // here check if "viewController" is your last tab controller, then return NO and perform some actions you need
    if (viewController = self.lastTabController) {
        // do some actions
        return NO;
    }

    return YES;
} 
```

# asp.net - 回调和部分回发的性能差异

> ID：14753291
> 
> 赞同：1
> 
> 时间：2013-02-07T14:18:27.863
> 
> 标签：asp.net, .net

我读过很多关于回调和部分回发的文章。我在以下链接中找到了这两者之间差异的详细信息。

[回调和部分回发有什么区别？](https://stackoverflow.com/questions/3016424/whats-the-difference-between-a-callback-and-a-partial-postback)

但我不知道使用 ajax 的回调和部分回调之间的性能差异。谁能帮我找出区别？

谢谢....

# java - 蔚来。2个客户端绑定到同一个端口，只有1个可以读取

> ID：14753293
> 
> 赞同：1
> 
> 时间：2013-02-07T14:18:33.890
> 
> 标签：java, nio

我有 2 个客户端套接字绑定在同一个端口上侦听。

```
Selector readSelector = Selector.open();
DeviceUDPReader reader = new DeviceUDPReader();
reader.start();      

//The following is called for each of my 2 servers
void openDevice(String hostName, int hostPort, DriverHandler driverHandler) {
  socketAddress = new InetSocketAddress(hostName, hostPort);    
  writeSelector = Selector.open();
  channel = DatagramChannel.open();
  channel.configureBlocking(false);
  channel.socket().setReuseAddress(true);//Wonderful!! Many servers can respond to same port
  channel.socket().bind(new InetSocketAddress(localPort));// Controller sends data here
  channel.connect(socketAddress);
  channel.register(writeSelector, SelectionKey.OP_WRITE);
  registerChannel(channel, driverHandler);
}

//Register the channels with the read selector
void registerChannel(DatagramChannel channel, DriverHandler driverHandler) throws Exception {
  synchronized(pendingChanges) { 
    //Pending changes a linked list keeping track of changes to be made to Selector
    //ChangeRequest is a simple storage object
    pendingChanges.add(new ChangeRequest(channel, ChangeRequest.REGISTER, driverHandler));
  }
  readSelector.wakeup();
} 
```

而选择器的运行方法如下

```
class DeviceUDPReader extends Thread {
DriverHandler driverHandler = null;
@Override
public void run() {
  int len;
  byte[] bb = {};
  ByteBuffer buffer = ByteBuffer.allocate(MAX_BYTES_PER_MESSAGE);
  while (true) {
    try {
      // Process any pending changes to selctor
      synchronized (pendingChanges) {
        Iterator<ChangeRequest> changes = pendingChanges.iterator();
        while (changes.hasNext()) {
          ChangeRequest change = (ChangeRequest) changes.next();
          switch (change.type) {
            case ChangeRequest.REGISTER:
              SelectionKey key = change.channel.register(readSelector, SelectionKey.OP_READ);                  
              key.attach(change.driverHandler);
              System.out.println("Registered channel" + change.channel.getRemoteAddress().toString());//both get registered
              break;
          }
        }
        pendingChanges.clear();
      }

      readSelector.select();//Blocks until at least one of the channels are ready
      System.err.println("TOTAL KEYS " + readSelector.keys().size());//==2

      Iterator<SelectionKey> it = readSelector.selectedKeys().iterator();
      System.out.println("Number of selected keys : " + readSelector.selectedKeys().size());//always 1
      while (it.hasNext()) {
        SelectionKey selKey = it.next();
        if (selKey.isValid() && selKey.isReadable()) {
          DatagramChannel sChannel = (DatagramChannel) selKey.channel();
          System.err.println("GOT SOMETHING FOR SELKEY " + sChannel.getRemoteAddress().toString());
          sChannel.receive(buffer);              
          buffer.flip();
          while ((len = buffer.remaining()) > 0) {                
            bb = new byte[len];
            buffer.get(bb, 0, len);
            System.err.println(new String(bb));
            driverHandler = ((DriverHandler)selKey.attachment());
            if (driverHandler != null) {
              driverHandler.readInput(new ByteArrayInputStream(bb, 0, len));
            }
          }
          buffer.clear();
        }
        it.remove();
      }
    }
    catch (Exception e) {
      e.printStackTrace();
    }
  } // end while   
} 
```

}

所以每个channel都有自己的write-write Selector，并共享一个read Selector。

我已经使用wireshark 进行了监控，发现数据在服务器A 和服务器B 之间正确发送和接收。我的读取选择器只从第一个选择器中获取消息，直到我完成并说channelA.close()。然后它立即获取从服务器 B 发送的数据。

任何想法我做错了什么？

# c# - ASP .Net 中的基本安全会话？

> ID：14753294
> 
> 赞同：0
> 
> 时间：2013-02-07T14:18:36.460
> 
> 标签：c#, asp.net

首先，我没有使用表单身份验证。

我找到了一个很棒的教程，几乎可以满足我的要求： http: [//www.codeproject.com/Questions/358434/Keep-me-signed-in-until-Loggged-out](http://www.codeproject.com/Questions/358434/Keep-me-signed-in-until-Loggged-out)

唯一的问题是这似乎不是一个好主意。它将用户名存储在 cookie 中。这似乎很糟糕。

我怎么能以安全的方式做类似本教程的事情？

我基本上只想要这个基本流程：

```
if user logged in then show page 
```

用户可以选择登录会话（30 分钟不活动）或直到他们选择明确注销。

我有一种感觉，为此我需要在我的数据库中创建一个会话表，但我不确定。

由于这是针对 Intranet 的，因此它不必是顶级安全性，但我仍然希望它有点安全。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:35:32.180

最简单的方法是在您的登录功能中，一旦您验证了它们，只需添加：

```
FormsAuthentication.SetAuthCookie(theUserName, persistCookieBoolean); 
```

现在您已经设置了身份验证 cookie。无需加密或解密。获取用户名，如：

```
HttpContext.Current.User.Identity.Name 
```

并查看他们是否已登录：

```
HttpContext.Current.User.Identity.IsAuthenticated 
```

现在您也可以在 web.config 中轻松设置授权。相关文章：[ASP .Net 中的手动访问控制](https://stackoverflow.com/questions/14629346/manual-access-control-in-asp-net/14630156#14630156)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:25:59.173

在存储到 cookie 之前加密您的数据（用户名等）。

读取 cookie，解密数据然后验证。

检查这个：

[在 .NET 应用程序中加密和解密数据](http://weblogs.asp.net/dwahlin/archive/2009/05/21/encrypting-data-in-net-applications.aspx)

[在 .NET 中加密/解密字符串](https://stackoverflow.com/questions/202011/encrypt-decrypt-string-in-net)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T15:09:05.960

您可以使用会话。

示例代码 VB：

登录时执行：

```
Session("Username") = "username" 
```

然后每次在页面加载时检查是否`Session("Username")`有任何数据/不为空。

如果它为 null 或为空，则 Session 已过期，您可以将它们踢出页面。

# css - 如何在 Joomla 2.5 模板中组织 css 文件？

> ID：14753296
> 
> 赞同：1
> 
> 时间：2013-02-07T14:18:40.147
> 
> 标签：css, file, templates, joomla

我想为 Joomla 2.5 设计一个模板，但我不知道如何正确清晰地组织我自己的 css 文件。

以**Beez_20**为例，我的问题是..

*为什么他们决定创建诸如 `general.css`, `layout.css`, `position.css`,之类的 css 文件`template.css`？*

*每个文件有什么用？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:35:05.483

Joomla 模板是你可以想象的，相当大。尤其是由 Yootheme 和 Rockettheme 等大公司开发的产品。将样式放入 1 个 CSS 文件会使文件变得庞大，如果尝试编辑一些代码，如果文件更小，它会更轻松，因为它不包含那么多代码。

例如，如果您想编辑模块的样式，您会立即知道它将在***module.css***中，并且几乎不会花费任何时间来找到完全相同的样式。

**更新：**

*   **general.css** = 按钮、图像、错误消息等。
*   **position.css** = 定位、宽度和高度主要块，例如标题、内容等。
*   **layout.css** = 更详细的样式，例如输入、标签、按钮等。
*   **modules.css（不是默认的 Joomla 模板）** = 模块位置的定位和样式
*   **ieonly** = IE 浏览器的特定固定
*   **nature.css** = 字体系列、字体颜色等
*   **print.css** = 打印预览时网站的样式。
*   **template.ccs** = body 标签的标准样式，并为图像定义无边框。

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T21:31:58.033

我同意洛德的观点；可维护性是主要原因。

但这在生产中是不可接受的（你不能下载 8 个 css 文件，这是一种杀死页面加载时间的好方法）。所以测试完成后你应该切换到

1.  压缩文件（使用 jsmin 或类似工具将文件打包在一起）
2.  添加“custom.css”，以便您的用户可以将他们的覆盖放在那里，而不会弄乱大文件

# java - 从 ThreadPoolExecutor 获取单个线程

> ID：14753298
> 
> 赞同：0
> 
> 时间：2013-02-07T14:18:47.273
> 
> 标签：java, multithreading, pool, executor, threadpoolexecutor

我正在运行带有多个线程的 ThreadPoolExecutor。我想在线程中操作一些数据，所以我想向线程发送一个对象，并在它完成使用数据后。我知道的唯一方法是等到线程使用 join() 完成，然后使用数据。问题是，我无法从 ThreadPoolExecutor 获得单个线程。我想做这样的事情：

```
Thread t = ThreadPoolExecutor.getThread();
t.start();
t.join(); 
```

其余代码....

有人有办法吗？我知道我可以使用 Callable 但我想避免这种情况，因为我已经有预先存在的代码......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:24:09.533

是的，你可以`submit`，得到一个`Future`支持`get()``Future`

```
Future<SomeResult> future = executorService.submit(new Callable<SomeResult>(){
    public SomeResult call(){
        //do work
        return new SomeResult();
    }
});

future.get();//suspends the current thread until the SomeResult callable returns. 
```

基本上，`call()`调用是在池中的线​​程之一上完成的，并且`get()`挂起当前线程类似于`t.join()`挂起当前线程的方式。

# dialog - CRM 2011 使用对话框合并记录

> ID：14753305
> 
> 赞同：0
> 
> 时间：2013-02-07T14:19:09.440
> 
> 标签：dialog, merge, duplicates, dynamics-crm, crm

各位早安。我会尽量简短。我们在本地使用 CRM 2011。目前数据流的工作方式是我们有两个系统（系统 X 和系统 Y）。系统 X 拥有有关购买的所有客户信息，系统 Y 拥有有关客户订阅选择的所有信息。（新闻信等）

我们将这两个数据库合并为一个，然后使用第三方服务，将其推送到 CRM 中。（我们处理这些重复数据行、检查数据质量等数据）

当客户服务输入第三种类型的数据时，问题就开始了。这些人使用 Outlook 将数据推送到 CRM（这是唯一直接进入 CRM 的数据）最后一种方法会创建大量重复项，并且无法使用这些数据来提供更好的客户服务和报告。很少有重要信息：客户服务输入到 CRM 的数据（以案例形式）中，超过 99% 是 CRM 中已经存在的客户（这些是来自 System X 和 System Y 的数据）。现有数据包含所有详细信息（电子邮件、邮政地址等），但客户服务输入的重复数据只有基本信息，如名字、姓氏和电子邮件地址。

1\. 合并这些数据的最佳解决方案是什么？2\. 客服输入时避免重复？我尝试使用对话框，但它要求最终用户（在客户服务中）手动选择他们想要从每一行中保留的详细信息。有时这些行超过 2-3。我很抱歉拖了这么久，但这个问题似乎并没有消失。我不是从你们那里寻找完整的解决方案，而是寻找任何提示、链接或者如果你以前尝试过这样的事情。

非常感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T22:13:30.953

你看过重复检测规则吗？

例如[CRM 重复检测第 1 部分：配置设置和创建规则](http://blog.rbaconsulting.com/blog/bid/190150/CRM-Duplicate-Detection-Part-1-Configure-Settings-and-Create-Rules)

# ruby-on-rails-3 - 列更改时的 ActiveRecord 回调

> ID：14753316
> 
> 赞同：2
> 
> 时间：2013-02-07T14:20:05.160
> 
> 标签：ruby-on-rails-3, activerecord

我有以下关系模型：

```
class Doctor
  has_many :appointmets
  # has attribute 'average_rating' (float)
end

class Appointment
  belongs_to :doctor
  # has_attribute 'rating' integer
end 
```

我想设置一个回调来设置`doctor.average_rating`每次约会被评分，即每次`rating`约会表上的列被触及。

我试过这个：

```
class Appointment
  after_update :update_dentist_average_rating, if: :rating_changed?
  # also tried with after_save 
private

  def update_dentist_average_rating
    ratings = Appointment.where(dentist_id: dentist.id).map(&:rating)
    doctor.average_rating = ratings.reduce(:+) / ratings.size if ratings.any?
    doctor.save
  end
end 
```

但不起作用，总是`appointment.dentist.average_rating`返回`nil`。我似乎无法测试回调是否正在运行`appointment.save`。**我错过了什么？**

**编辑：**这是应用程序流程

1.  一个用户（Patient 类）保存了一个评分为 nil 和一些医生 ID 的约会。
2.  如果约会日期已经过去，可以通过 '' 在表单上编辑或设置约会时间。
3.  然后我需要更新约会.doctor.average_rating

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T15:27:55.210

用这个回调实现了它，虽然我不知道这是否是最好的方法：

```
after_save if: :rating_changed? do |apt|
  ratings = Appointment.where(doctor_id: 10).map(&:rating)
  doctor.average_rating = ratings.reduce(:+) / ratings.size if ratings.any?
  doctor.save!
end 
```

# asp.net-mvc - @html.radiobutton如何设置真实状态？

> ID：14753318
> 
> 赞同：0
> 
> 时间：2013-02-07T14:20:17.233
> 
> 标签：asp.net-mvc, razor, html.radiobuttonlist

我需要设置@html.radiobutton 真实状态。我有两个单选按钮。一种是真实状态，另一种是虚假状态。我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:51:40.183

你可以有一个视图模型：

```
public class MyViewModel
{
    public bool Status { get; set; }
} 
```

和您视图中的 2 个 RadioButtons：

```
@Html.RadioButtonFor(x => x.Status, "true")
@Html.RadioButtonFor(x => x.Status, "false") 
```

# c# - 为 WPFExtension 的 ZoomControl 实现 ISCrollInfo。计算偏移量

> ID：14753319
> 
> 赞同：2
> 
> 时间：2013-02-07T14:20:19.220
> 
> 标签：c#, wpf, zooming, contentcontrol

我正在尝试实现`IScrollInfo`WPFExtensions ['](http://wpfextensions.codeplex.com/)，`ZoomControl`以便能够将此控件与`ScrollViewer`. 但是我很难理解如何正确计算`HorizontalOffset`和`VerticalOffset`属性以及我需要在哪里更新它们。起初我怀疑它是 TranslateX 和 TranslateY 但这只会给你相对于上一次`Zoom`属性的内容位置的偏移量更改而不是视口的全局偏移量。

1.  这似乎是 ZoomControl 用户非常普遍的需求。这种努力以前做过吗？
2.  WPFExtensions 的文档似乎很差，而且不是很不言自明，是否有很好的信息来源可以更好地了解 ZoomControl 的工作原理？

编辑：我一直在使用[此控件](http://www.codeproject.com/Articles/85603/A-WPF-custom-control-for-zooming-and-panning)作为参考，因为它实现了`IScrollInfo`. 然而，这两个控件有不同的方法来使视图无效和更新数据，所以它并没有让我走得太远。我更喜欢使用 WPFExtension 的控件，因为它更易于使用，具有更好的动画效果并且似乎更被广泛接受。

# mysql - 将自动增量 ID 添加到现有表？

> ID：14753321
> 
> 赞同：100
> 
> 时间：2013-02-07T14:20:39.280
> 
> 标签：mysql, sql, definition, auto-increment

我有一个预先存在的表，包含“fname”、“lname”、“email”、“password”和“ip”。但现在我想要一个自动增量列。但是，当我输入：

```
ALTER TABLE users
ADD id int NOT NULL AUTO_INCREMENT 
```

我得到以下信息：

```
#1075 - Incorrect table definition; there can be only one auto column and it must be defined as a key 
```

有什么建议吗？：）

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2013-02-07T14:31:00.447

尝试这个

```
ALTER TABLE `users` ADD `id` INT NOT NULL AUTO_INCREMENT; 
```

对于现有的主键

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2013-06-27T15:00:20.730

如果您不关心 auto-id 是否用作`PRIMARY KEY`，您可以这样做

```
ALTER TABLE `myTable` ADD COLUMN `id` INT AUTO_INCREMENT UNIQUE FIRST; 
```

我只是这样做了，它奏效了。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2013-02-07T14:24:59.987

如果要在现有表中添加 AUTO_INCREMENT，需要运行以下 SQL 命令：

```
 ALTER TABLE users ADD id int NOT NULL AUTO_INCREMENT primary key 
```

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2014-01-30T15:50:27.083

首先你必须删除表的主键

```
ALTER TABLE nametable DROP PRIMARY KEY 
```

现在你可以添加自动增量...

```
ALTER TABLE nametable ADD id INT NOT NULL AUTO_INCREMENT PRIMARY KEY 
```

* * *

## 回答 #5

> 赞同：18
> 
> 时间：2013-02-07T14:27:45.047

好吧，你必须先删除你拥有的，`auto_increment`然后`primary key`添加你的，如下：

```
-- drop auto_increment capability
alter table `users` modify column id INT NOT NULL;
-- in one line, drop primary key and rebuild one
alter table `users` drop primary key, add primary key(id);
-- re add the auto_increment capability, last value is remembered
alter table `users` modify column id INT NOT NULL AUTO_INCREMENT; 
```

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2019-03-12T04:49:46.013

如果您运行以下命令：

```
ALTER TABLE users ADD id int NOT NULL AUTO_INCREMENT PRIMARY KEY; 
```

这将向您显示错误：

```
ERROR 1060 (42S21): Duplicate column name 'id' 
```

这是因为此命令将尝试将名为的新列添加`id`到现有表中。

要修改现有列，您必须使用以下命令：

```
ALTER TABLE users MODIFY id int NOT NULL AUTO_INCREMENT PRIMARY KEY; 
```

这应该适用于更改现有的列约束......！

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2018-05-22T12:58:14.383

删除表的主键（如果存在）：

```
 ALTER TABLE `tableName` DROP PRIMARY KEY; 
```

向表中添加自动增量列：

```
ALTER TABLE `tableName` ADD `Column_name` INT PRIMARY KEY AUTO_INCREMENT; 
```

修改我们想要作为主键的列：

```
alter table `tableName` modify column `Column_name` INT NOT NULL AUTO_INCREMENT PRIMARY KEY; 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2017-03-22T02:27:22.880

只需将 ADD 更改为 MODIFY 即可！

代替

```
ALTER TABLE users ADD id int NOT NULL AUTO_INCREMENT 
```

至

```
ALTER TABLE users MODIFY id int NOT NULL AUTO_INCREMENT; 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-06-22T18:46:54.137

```
ALTER TABLE users CHANGE id int( 30 ) NOT NULL AUTO_INCREMENT 
```

整数参数基于我的默认 sql 设置祝你有美好的一天

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-01-27T04:40:23.720

```
ALTER TABLE users ADD id int NOT NULL AUTO_INCREMENT primary key FIRST 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-12-16T17:20:05.523

对于 PostgreSQL，您必须使用 SERIAL 而不是 auto_increment。

```
ALTER TABLE your_table_name ADD COLUMN id SERIAL NOT NULL PRIMARY KEY 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-01-15T16:26:47.227

这个 SQL 请求对我有用：

```
ALTER TABLE users
CHANGE COLUMN `id` `id` INT(11) NOT NULL AUTO_INCREMENT ; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-11-12T13:43:04.790

```
ALTER TABLE `table` ADD `id` INT NOT NULL AUTO_INCREMENT unique 
```

尝试这个。无需删除您的主键。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-04-27T14:44:08.240

从表中删除主索引：

```
ALTER TABLE `tableName` DROP INDEX `PRIMARY`; 
```

然后添加 id 列（没有主索引）。我使用了一个大整数，因为我将拥有大量数据，但 INT(11) 应该也能正常工作：

```
ALTER TABLE `tableName` ADD COLUMN `id` BIGINT(11) NOT NULL FIRST; 
```

然后使用自动增量修改列（感谢 php）。它必须是主键：

```
ALTER TABLE `tableName ` MODIFY COLUMN `id` BIGINT(11) UNSIGNED PRIMARY KEY AUTO_INCREMENT; 
```

我刚刚在我的一张桌子上试过这个，它似乎奏效了。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2013-12-13T17:02:52.233

检查已经存在的具有不同列的主键。如果是，请使用以下方法删除主键：

```
ALTER TABLE Table1
DROP CONSTRAINT PK_Table1_Col1
GO 
```

然后按原样编写您的查询。

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2014-08-25T09:23:11.313

像这样进行：

```
Make a dump of your database first

Remove the primary key like that 
```

ALTER TABLE yourtable DROP PRIMARY KEY

```
Add the new column like that 
```

ALTER TABLE yourtable add column Id INT NOT NULL AUTO_INCREMENT FIRST，ADD primary KEY Id(Id)

将查看该表并更新 AutoInc。

# c# - 如何使用 C# 计算 SQL Server 2008 表的列数？

> ID：14753322
> 
> 赞同：1
> 
> 时间：2013-02-07T14:20:43.727
> 
> 标签：c#, sql-server-2008

我正在 Visual Studio 2008 中用 C# 开发一个应用程序。我用它连接了一个 SQL Server 2008 数据库。

我想计算列数，以便我可以循环它们以获取特定数据。

我可以通过访问数据库来计算列，但是我在我的程序中加入了 4-5 个表，所以我想知道我是否可以计算列。

任何人都可以帮助我吗？

谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:30:18.993

```
select count(*) from INFORMATION_SCHEMA.columns where TABLE_NAME = 'YourTableName' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:27:10.203

像这样的东西？

```
SELECT COUNT(*)
FROM sys.columns c 
INNER JOIN sys.tables t ON c.object_id = t.object_id
WHERE t.name = 'yourTable' 
```

请参阅[TaronPro 提供的此页面](https://stackoverflow.com/questions/10699166/retrieve-number-of-columns-in-sql-table-c-sharp)以了解如何检索结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T15:02:49.990

如果您使用 SQLConnection 对象连接到 DB，请使用其 GetSchema 方法获取所有列的列表而无需查询。

```
 using (SqlConnection connection = new SqlConnection(connectionString))
   {
       // Connect to the database then retrieve the schema information.
       connection.Open();
       DataTable table = connection.GetSchema("Tables");
        ..
        ..
        .. 
```

如果您想知道特定所有者、表或表类型的列，请在 GetSchema 方法中使用限制。

```
 string[] restrictions = new string[4];
    restrictions[1] = "dbo";
    DataTable table = connection.GetSchema("Tables", restrictions); 
```

有关更多信息，请参阅[此](http://msdn.microsoft.com/en-us/library/ms254934%28v=vs.80%29.aspx)链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T14:27:54.447

我在类似情况下所做的是，当我执行查询时，我将所有数据检索到 DataSet 中。

当我得到数据集时，我打开了第一个表 (ds.Tables[0])。显然，您首先检查是否存在。

当你有桌子时，它就像执行一个简单的

```
dt.Columns.Count; 
```

总之 DS.Tables[0].Columns.Count 要按名称查找特定列，您循环并找到

```
for (z=0; z < dt.Columns.Count; z++)
{
  // check to see if the column name is the required name passed in.
  if (dt.Columns[z].ColumnName == fieldName)
  {
    // If the column was found then retrieve it 
    //dc = dt.Columns[z];
    // and stop looking the rest of the columns
    requiredColumn = z;
    break;
 } 
```

}

然后找到你需要的数据，然后我会遍历表的行并获取该列的字段......即......

```
string return = dr.Field<string>(requiredColumn); 
```

Probalby 不是最好的方法，但它确实有效。显然，如果字段中包含的数据不是字符串，那么您需要传递适当的类型......

```
dr.Field<decimal>(requiredColumn)
dr.Field<int>(requiredColumn) 
```

ETC

乔治

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T14:44:35.923

阅读器本身会为您提供列数。当您不想知道特定表或视图的行数而是从临时查询中知道时，这很有用。

您可以像这样转储列

```
string sql = "SELECT * FROM my query";
SqlCommand cmd = new SqlCommand(sql, connection);
using (SqlDataReader reader = cmd.ExecuteReader()) {
    while (reader.Read()) {
        for (int i = 0; i < reader.FieldCount; i++) {
            Console.WriteLine("{0} = {1}",
                              reader.GetName(i),
                              reader.IsDBNull(i) ? "NULL" : reader.GetValue(i));
        }
        Console.WriteLine("---------------");
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-07T14:51:53.833

您可以使用`Microsoft.SqlServer.Management.Smo`命名空间来获取指定表中的列数，如下所示 1 。在您的项目中添加 Microsoft.SqlServer.Management.Smo dll 并使用命名空间 Microsoft.SqlServer.Management.Smo 2 。编写以下代码

```
private int colCount()
{
      Server server=new Server(".\\SQLEXPRESS");
      Database database=Server.Databases["your database name"];
      Table table=database.Tables["your table name"];
      return (table.Columns.Count);
} 
```

# internet-explorer - 如何在 IE 上查看受信任的人证书选项卡

> ID：14753324
> 
> 赞同：0
> 
> 时间：2013-02-07T14:20:48.080
> 
> 标签：internet-explorer, certificate

安装证书后，我需要在受信任的人员文件夹上安装证书，但在 Internet 选项证书 IE 7 上找不到该类别的水龙头。

我错过了什么？

![在此处输入图像描述](../Images/62c1ca91728ee6c4ba0e4aa0a25522b2.png)

我有所有其他类型（个人、其他人、Trusted Rood Cert ext）除了受信任的人，我需要将它安装在那个上并查看密钥（我在这个窗口上做的事情）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-15T08:30:15.130

我不认为你可以。但是您可以使用[MMC 管理单元](http://msdn.microsoft.com/en-us/library/ms788967.aspx)。

# r - R中的corrplot参数

> ID：14753344
> 
> 赞同：7
> 
> 时间：2013-02-07T14:21:44.460
> 
> 标签：r, plot, r-corrplot

我已经使用了如下的 corrplot，但是正如您所看到的，我需要放大圆圈内数字的字体大小，然后绘图标题的位置和字体大小不正确（不完全可见），但我找不到他们的参数。如果您能提供帮助，我将不胜感激。

```
library(corrplot)

png(height=1200, width=1200, file="overlap.png")

col1 <-rainbow(100, s = 1, v = 1, start = 0, end = 0.9, alpha = 1)
test <- matrix(data=c(20:60),nrow=7,ncol=7)

corrplot(test,tl.cex=3,title="Overlaps Between methods",
  method="circle",is.corr=FALSE,type="full",
  cl.lim=c(10,100),cl.cex=2,addgrid.col="red",
  addshade="positive",col=col1, diag=FALSE,
  addCoef.col = rgb(0,0,0, alpha = 0.6)
)

dev.off() 
```

![在此处输入图像描述](../Images/3ccb829c7666ceb37e0441837165b0cc.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-07T15:10:09.910

问题似乎与您提供的`png()`with`height=1200`和`width=1200`选项有关。尝试将该行更改为：

```
png(height=1200, width=1200, pointsize=25, file="overlap.png") 
```

出于某种原因，默认值`pointsize = 12`会以某种方式减少`labels`and的字体。`title`

**编辑：**要正确查看标题，请将此参数添加到您的`corrplot`：

```
mar=c(0,0,1,0) 
```

所以整个命令集是：

```
library(corrplot)
png(height=1200, width=1200, pointsize=25, file="overlap.png")
col1 <-rainbow(100, s = 1, v = 1, start = 0, end = 0.9, alpha = 1)
test <- matrix(data=c(20:60),nrow=7,ncol=7)
corrplot(test,tl.cex=3,title="Overlaps Between methods",
method="circle",is.corr=FALSE,type="full",
cl.lim=c(10,100),cl.cex=2,addgrid.col=
"red",addshade="positive",col=col1, addCoef.col = rgb(0,0,0, alpha =
0.6), mar=c(0,0,1,0), diag= FALSE) 
dev.off() 
```

# c# - 在绑定的 DataGridView 中访问单元格值的最快方法

> ID：14753348
> 
> 赞同：0
> 
> 时间：2013-02-07T14:21:51.227
> 
> 标签：c#, winforms, performance, datagridview

我有一个绑定到对象 BindingList 的 DataGridView，我需要尽快访问每一行中特定单元格的值。这样做是否更快：

```
if (((ObjectType)row.DataBoundItem).StringProperty != string.Empty)
{
} 
```

...或者...

```
if (row.Cells["STRINGPROPERTY"].Value != string.Empty)
{
} 
```

还是有另一种比这两种方法都快的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:37:31.277

有很多方法可以使用 if 为*空*或*null*检查值，但从您的主要问题中，您可以尝试[在 C# 中对方法调用进行基准测试](https://stackoverflow.com/questions/1622440/benchmarking-method-calls-in-c-sharp)

1.  [String.IsNullOrEmpty](http://msdn.microsoft.com/en-us/library/system.string.isnullorempty.aspx)
2.  [String.IsNullOrWhiteSpace](http://msdn.microsoft.com/en-us/library/system.string.isnullorwhitespace.aspx)
3.  [检查列是否返回空值的最佳方法（从数据库到 .net 应用程序）](https://stackoverflow.com/questions/2017533/best-way-to-check-if-column-returns-a-null-value-from-database-to-net-applicat)

# objective-c - Cocoa：当窗口不可见时应用程序关闭

> ID：14753353
> 
> 赞同：0
> 
> 时间：2013-02-07T14:22:05.723
> 
> 标签：objective-c, xcode, macos, cocoa

我正在制作一个带有两个窗口的 Cocoa 应用程序。我想隐藏这两个窗口，调用一些屏幕捕获功能，然后恢复这些窗口。我用

```
[mainWindow orderOut:self]; 
```

隐藏窗口，但是当我这样做时，整个应用程序都会关闭。在我的 AppDelegate 中，我具有以下功能：

```
- (BOOL)applicationShouldTerminateAfterLastWindowClosed:(NSApplication*)sender 
{
    return YES;
} 
```

我是否错误地隐藏了窗口？为什么 AppDelegate 在使用 orderOut 时会认为窗口已经关闭？

我的应用程序在没有使用上述 AppDelegate 方法的情况下完美运行，我将其添加为最后一步，以在我实际关闭所有窗口时终止应用程序。谁能建议如何在不关闭应用程序的情况下使我的窗口暂时不可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:47:37.910

我忘记了...你能设置一个窗口的可见性吗？如果是这样，那将解决它。

唯一的另一件事是在您以编程方式关闭窗口时设置一个 BOOL ... iClosed Windows = YES。然后在恢复窗口时将其设置为 NO ...然后在委托方法中检查该 bool 并相应地返回 YES 或 NO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T21:07:39.887

删除方法**applicationShouldTerminateAfterLastWindowClosed**。申请将保持开放。这是 OS X 上的正常行为。您可以关闭 Chrome 或 Safari 的所有窗口，它们将保持打开状态。如果需要，OS X 会关闭它们，比如在 iOS 上。

# javascript - 返回 false javascript 后仍提交表单

> ID：14753354
> 
> 赞同：2
> 
> 时间：2013-02-07T14:22:08.807
> 
> 标签：javascript, validation

我对javascript中的验证有一点问题。

```
<form action="insert.php" id="form" name="form" method="post" 
    onSubmit="return validate()">
    <pre>
        Vul hier de/het E-mail adres(sen) in
        <textarea name="email" rows="5" cols="50"></textarea><br>
        Typ hier de E-mail
        <textarea name="text" rows="5" cols="50"></textarea><br>
        <input type="submit" name="Submit" value="Submit">
    </pre>
</form> 
```

正如你在这里看到的，我有两个文本区域。在上一个，您应该在彼此下方输入一个或多个电子邮件地址，而在底部的文本区域中，您应该自己撰写电子邮件。然后，当您单击提交时，它会将电子邮件发送到所有指定的电子邮件地址。

现在，我已经对两个文本区域进行了验证：

```
function explodeArray(emailID, delimiter) {
    tempArray = new Array(1);
    var Count = 0;
    var tempString = new String(emailID);

    while (tempString.indexOf(delimiter) > 0) {
        tempArray[Count] = tempString.substr(0, tempString.indexOf(delimiter));
        tempString = tempString.substr(
            tempString.indexOf(delimiter) + 1, 
            tempString.length - tempString.indexOf(delimiter) + 1
        );
        Count = Count + 1
    }

    tempArray[Count] = tempString.replace("\r", "");
    return tempArray;
}

function validate() {
    var emailID = document.form.email;
    var delimiter = "\n";
    var emailArray = explodeArray(emailID.value, delimiter);
    var textID = document.form.text;
    var length = emailArray.length,
        element = null;
    for (var i = 0; i < length; i++) {
        emailVar = emailArray[i];

        if (emailVar == null) {
            alert("Email-adres bestaat niet")
            emailID.focus()
            return false
        }
        if (emailVar == "") {
            alert("Email-adres veld is leeg")
            emailID.focus()
            return false
        }
        if (checkEmail(emailVar) == false) {
            emailVar.value = ""
            alert("Ongeldig E-mail adres");
            emailVar.focus()
            return false
        }
    }
    if ((textID.value == null) || (textID.value == "")) {
        alert("E-mail textveld is leeg")
        textID.focus()
        return false
    }
    document.getElementById("form").submit();
    return true
}

function checkEmail(hallo) {
    if (/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(hallo)) {
        return true
    }
    return false
} 
```

（我可能也复制了很多不相关的代码，对不起，只是复制了整个东西以防万一......）

现在起作用的是*：*

- 当两个文本区域都为空时，它不会提交；

- 当邮箱地址有效*但*底部文本区域为空时不提交；

什么*不起作用*是：

- 当电子邮件地址无效时，表单仍会提交，即使底部文本区域仍为空。

几个小时以来，我一直试图弄清楚这里可能出了什么问题，我用谷歌搜索并检查了 stackoverflow，但我真的找不到任何东西。谁能告诉我我在这里做错了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:30:32.107

你正在使用`emailVar.focus();`which 不会执行。

在这里，固定：[**现场演示**](http://jsfiddle.net/cBxWd/)

```
if (checkEmail(emailVar) == false) {
    alert("Ongeldig E-mail adres");
    emailID.focus();
    return false;
} 
```

# networking - 网络监控系统如何测量网络流量

> ID：14753358
> 
> 赞同：1
> 
> 时间：2013-02-07T14:22:20.937
> 
> 标签：networking, monitoring, traffic

我将为我在大学的最后一年的项目开发一个网络监控系统。在开发之前，我对网络监控系统的工作原理进行了一些研究。据我了解，网络监控系统使用 ICMP 数据包（Ping）来确保设备在网络中“活动”。这是我遇到的问题：

1.  如果网络监控系统需要ping网络中的每一个设备，那么网络流量就会变大，使用这种方法是不是很好？或者还有其他可能的选择吗？

2.  网络监控系统提供了一组网络流量数据，网络监控系统是否可以获取所有连接的流量级别？假设有 3 台 PC，PC X、PC Y 和 PC Z。PC X 连接到 PC Y，PC Y 连接到两台 PC，PC X 用于监控网络，当 PC Y 向 PC Z 发送数据包时， PC X 是否有可能获得 PC Y 正在向 PC Z 发送数据包的信息？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-23T22:16:34.923

1.  与正常网络流量相比，监控的网络流量负载可以忽略不计。通常，您每分钟或每 5 分钟轮询一次设备，一个数据包得到一个数据包作为回报。

2.  网络流量监控通常使用 SNMP 来轮询每个接口的 ifInOctets 和 ifOutOctets 计数器。这将允许您基于每个接口计算总流量和传输速率（带宽利用率）。但是，它不允许您按流量类型或目的地对其进行细分。

我建议你看看 MRTG 之类的软件，它们可以非常巧妙地进行这种监控。

如果您想监控整个网络的健康状况，而不仅仅是链路上的流量，您可能需要研究从设备捕获 SNMP 陷阱以了解问题，并监控其他内容，例如可达性（通过 ping 数据包）、路由（检测震荡路由），甚至检查主机上的服务（如DNS、HTTP、SMTP等）。为此，您可能想研究 Nagios 软件及其执行各种测试的检查插件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T23:18:55.740

1.  不会，网络流量不会变大。您似乎大大低估了网络容量，或者大大高估了 ping 引起的流量（或两者兼而有之）。从网络监控服务器到网络中所有主机的周期性 ping 导致的网络负载增加将是微不足道的，除非您的网络是某种缓慢的古老半双工网络。我会更担心网络监控服务器上所需的 CPU 使用率，以便能够处理所有 ping 并用它们做有用的事情。

2.  只有当您在 PC 上运行专门的软件才能获取这些数据并将其发送到网络监控服务器时才有可能。[sflow](http://www.sflow.org/)就是一个很好的例子。您是否可以控制 PC 上可以配置的内容？如果是这样，天空就是你的极限。如果我们将 PC 视为一个黑匣子，那么除了 ping 和可能的端口扫描之外，您真的无能为力。

3.  监控单个主机只是图片的一部分。对于网络监控系统来说，监控组成网络的路由器和交换机也是非常重要的。您可以收集的信息量在很大程度上取决于这些网络设备支持的内容以及您是否有权配置它们。如果启用了 SNMP，那将是一个很好的开始。

# java - Docx4j 如何解释 css

> ID：14753361
> 
> 赞同：2
> 
> 时间：2013-02-07T14:22:33.237
> 
> 标签：java, docx, docx4j

我很快就会把头发扯下来，但我真的很困惑 docx4j 在将 xhtml 转换为 docx 文件时如何解释 CSS。

我试过用谷歌搜索，然后我继续阅读整个项目的源代码，以便弄清楚。

例如，我发现字体大小仅在 in`pt`而不是 in`px, em`或任何其他大小时才被解释。通过[阅读此链接](http://grepcode.com/file/repo1.maven.org/maven2/org.docx4j/docx4j/2.7.1/org/docx4j/model/properties/run/FontSize.java)

另外，如果有人可以帮助我，`font-face`这似乎不起作用。

这里有没有人可以解释它是如何工作的，或者有任何关于它是如何工作的文档？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T03:51:30.570

**披露：我写了相关的 docx4j 代码 **

它有两个部分。

第一个是飞碟/XHTML 渲染器。

第二个是 docx4j 中的代码，它将从 Flying Saucer 获得的内容转换为 WordML。

正如您所发现的，有些东西 docx4j 还没有转换（字体就是其中之一）。不是因为它们特别难，而是因为我们的优先事项在其他地方。欢迎您添加您需要的任何内容并提供补丁。

对于像您提到的简单内容，起点是 XHTMLImporter 的第 1327 行的 addRunProperties 方法。在那里你可以看到飞碟提供的 CSSValue 对象。我想你已经在 GitHub 上找到了 docx4j 源代码。

# iphone - 如何在 ios5.1 中从我们的应用打开设置？

> ID：14753367
> 
> 赞同：0
> 
> 时间：2013-02-07T14:22:54.000
> 
> 标签：iphone, ipad, settings

我想在 ios 5.1 中从我的应用程序中打开设置，但我没有找到任何打开设置的来源。谁能指导我解决这个问题。

提前致谢。

# c - 二进制整数到c中的整数数组

> ID：14753370
> 
> 赞同：1
> 
> 时间：2013-02-07T14:23:28.940
> 
> 标签：c, arrays, integer

我有一个变量`unsigned int x = 0b0011`，我怎样才能使它成为无符号整数数组，比如`y[0]=0 ; y[1]=0; y[2]=1; y[3]=1;`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:30:31.740

移位和按位运算。

```
unsigned x = 0b0011; // yap this is a GNU extension, it doesn't always work even with GCC

const size_t intsize = sizeof(x) * CHAR_BIT; // go go indepency-of-sizeof(int)!

unsigned bits[intsize]; // that's why we love constexprs

int i, j;
for (i = intsize - 1, j = 0; i >= 0; i--, j++) { // and the comma operator too
    bits[j] = (x >> i) & 0x1;
} 
```

# c# - 使用 MonoTouch 和 MonoTouch.Dialog 时出现“棕色背景”问题的原因是什么？

> ID：14753376
> 
> 赞同：0
> 
> 时间：2013-02-07T14:24:00.660
> 
> 标签：c#, ios, xamarin.ios, monotouch.dialog

我们将 MonoTouch 用于我们的应用程序，并且我们有时会体验（在使用后）视图控制器背景突然变成棕色。当我们从导航控制器弹出另一个视图控制器时，就会发生这种情况。我们对一切都使用 MonoTouch.Dialog。是什么导致了这个问题，解决方案是什么？

示例可以在这里看到：
![](../Images/21ab8287351c528401050ba1d6bddffa.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:49:28.377

如果我记得，它与被回收的电池有关，你必须设置电池的所有属性，否则你可能最终会使用以前的一个。我说的是背景、前景、颜色等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T14:54:00.413

您可以发布一些代码使用示例吗？

您是否在视图实例化或从 Navstack 弹出视图时显式设置 View.BackgroundColor = UIColor.White？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T11:05:59.790

这实际上是由于我们自己的代码中的一个错误。

# ios - 如何计算具有右/左细节样式的表格视图单元的高度？

> ID：14753377
> 
> 赞同：2
> 
> 时间：2013-02-07T14:24:03.683
> 
> 标签：ios, uitableview, uilabel

我有一个`UITableView`带有右/左细节样式的原型单元格。两个（多行）标签的文本长度变化很大。

这意味着标签的宽度将根据文本（即使在同一部分中）发生变化。

在更一般的意义上，这个问题适用于包含至少 2 个彼此水平对齐的标签的所有单元格。

`heightForRowAtIndexPath`是否可以在没有给定约束标签宽度的情况下计算得到的单元格高度（in ）？

我想以尽可能少的行布局文本=最小化单元格高度（见图）。

![在此处输入图像描述](../Images/cc9faf44e1397ac4e8ed8aee0cc96342.png)

任何建议/解决方案表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:43:05.233

行的高度在 tableview 委托的方法中计算`- tableView:heightForRowAtIndexPath:`

这是您必须计算标签的可能宽度和高度的地方。可以通过使用`[@"LOOOONG TEXT" sizeWithFont:defaultFont];`Then 进行适当的数学运算并返回单元格所需的高度。

# javascript - 全局使用 javascript 用 _ 替换点？

> ID：14753384
> 
> 赞同：3
> 
> 时间：2013-02-07T14:24:35.353
> 
> 标签：javascript, regex

我试图替换所有的点和空格`"`

```
var name = "C. S. Lewis" 
```

并将它们替换为`_`

并将其转换为`"C_S_LEWIS"`

这是我尝试过的，但它将整个内容转换为下划线（`_`）

```
var mystring = "C. S. Lewis";
var find = ".";
var regex = new RegExp(find, "g");
alert(mystring.replace(regex, "_")); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T14:25:34.103

这是因为点需要在正则表达式中进行转义（除非它是字符类的一部分）。这个表达式应该有效：

```
var regex = /[.\s]+/g;

alert(mystring.replace(regex, '_')) 
```

它匹配至少一个句点或空格的序列，然后在后续`.replace()`调用中将其替换为单个下划线。

顺便说一句，这不会将新字符串保存回`mystring`. 为此，您需要将替换操作的结果分配回同一变量：

```
mystring = mystring.replace(regex, '_') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:30:06.043

意思是“`.`任何字符”。用于`\.`获取文字点，这意味着在您的`regex`字符串中，您必须`\\.`输入文字下划线后跟文字点。但我不确定你为什么要先制作一个字符串 - 你可以这样做：

```
var find = /\./g; 
```

当然，这不是您要查找的内容 - 您不仅需要任何点，还需要后跟空格的点。那不一样：

```
var find = /\.\s+/g; 
```

# jvm - Java 虚拟机规范 (JVMS)：“5.4.5 方法覆盖”中的错误

> ID：14753386
> 
> 赞同：4
> 
> 时间：2013-02-07T14:24:42.843
> 
> 标签：jvm, bytecode

我在 2009 年 9 月 28 日提交了以下错误。遗憾的是，我仍然没有得到任何回应，规范的最终版本仍然不正确。这真的是一个错误吗？如果不是，为什么不呢？如果是，我该怎么办？

包含错误的部分是`5.4.5`（方法覆盖）：[http](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-5.html#jvms-5.4.5) ://docs.oracle.com/javase/specs/jvms/se7/html/jvms-5.html#jvms-5.4.5结合描述`INVOKEVIRTUAL`操作码：[http ://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.invokevirtual](http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-6.html#jvms-6.5.invokevirtual)

根据 5.4.5`m1`可以覆盖`m2`即使`m1`是私有的。如果`.class`手动创建文件或组合`.class`来自两个编译的文件，则可能会发生这种情况。

在我的示例中，我有课程`A`并`B`使用`B extends A`. 我编译了这些类，使其`A`包含一个`public`名为的方法，`f`并`B`包含一个`private`方法，也称为`f`（首先声明两个方法`public`，编译，复制`A.class`到安全的地方，删除 in 的声明`f`并`A`更改为`private`in `B`，然后编译`B`并使用保存的版本`A.class`）。

现在运行它时，我当前的 Oracle JVM 输出`A`（意味着调用了`f`in方法）。`A`根据规范，`B`应该是输出（意味着应该调用`f`中的方法）。`B`

编辑：实际上，`B.f`应该解决。如果调用者不是，则调用可能会因为对已解析方法的访问权限检查而失败`B`。但是，我认为方法解析部分是错误的。

我认为中的定义`5.4.5`应该检查访问权限`m1`，而不仅仅是`m2`.

```
public class A {
  public void f();
    Code:
       0: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;
       3: ldc           #3                  // String A
       5: invokevirtual #4                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
       8: return
}

public class B extends A {
  private void f();
    Code:
       0: getstatic     #2                  // Field java/lang/System.out:Ljava/io/PrintStream;
       3: ldc           #3                  // String B
       5: invokevirtual #4                  // Method java/io/PrintStream.println:(Ljava/lang/String;)V
       8: return
} 
```

谢谢，卡斯滕

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-13T21:04:23.280

你的问题终于解决了。Java 8 JVM 规范的[当前版本](http://cr.openjdk.java.net/~mr/se/8/java-se-8-pfd-spec/java-se-8-jvms-pfd-diffs.pdf)包含所需的说明：

> ### 5.4.5 覆盖
> 
> 在类 C 中声明的实例方法 m [C]会覆盖在类 A 中声明的另一个实例方法 m [A] ，前提是 m [C]与 m [A]相同，或者以下所有条件都为真：
> 
> *   C 是 A 的子类。
> *   m [C与 m] [A]具有相同的名称和描述符。
> *   **m [C]未标记为 ACC_PRIVATE。**
> *   以下情况之一为真：
>     *   m [A]被标记为 ACC_PUBLIC；或标记为 ACC_PROTECTED；or 既不标记 ACC_PUBLIC 也不标记 ACC_PROTECTED 也不标记 ACC_PRIVATE 并且 A 属于与 C 相同的运行时包。
>     *   m [C]覆盖方法 m' （m' 不同于 m [C]和 m [A]），因此 m' 覆盖 m [A]。

§4.10.1.5 “类型检查抽象和本机方法”中还有另一个补充：

> 私有方法和静态方法与动态方法分派是正交的，因此它们永远不会覆盖其他方法（第 5.4.5 节）。

不到五年的时间来修复，与其他一些问题相比，这速度很快……</p>

# http - 哪个浏览器不能使用标头位置重定向？

> ID：14753388
> 
> 赞同：2
> 
> 时间：2013-02-07T14:24:47.537
> 
> 标签：http, redirect, header, location

我们使用 header('Location...') 对大量请求进行重定向。我们有 4% 的要求，但不这样做。

你有什么主意吗？

我们的请求来自所有国家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T15:27:43.580

**每个浏览器都需要实现位置标头。**它是[HTTP/1.1](http://www.faqs.org/rfcs/rfc2616.html)的一部分，因此如果有任何东西想称自己为“网络浏览器”，那么它需要实现 Location 标头。所以回答你的问题：每个网络浏览器都可以使用`Location:`.

尽管如此，您仍然需要考虑一些事情：

您需要记住的第一件事是`header('Location`需要使用**绝对路径**，因为在不同的浏览器中可能不支持相对 URL 或行为不正确（旧 IE 存在问题 - 根据 RFC 2616，位置标头需要是绝对的）。因此，检查您是否总是在重定向中使用绝对 URL 可能是值得的。

第二件事是您的**跟踪系统**可能无法正常工作。如果有人使用[不跟踪策略](http://en.wikipedia.org/wiki/Do_not_track_header)或编辑他的[HTTP 引荐来源网址](http://en.wikipedia.org/wiki/HTTP_referer)，那么您的跟踪系统可能会误以为重定向没有发生。虽然它仍然存在，但只有您的跟踪器不会看到它发生。

第三也是最后一件事是**[网络爬虫](http://en.wikipedia.org/wiki/Web_crawler)**，它们可能会完全忽略标题（它们几乎从不这样做，但它可能是这些罕见的情况之一，有人有一个成熟的垃圾邮件机器人试图爬过你的网站），或者发送不正确的响应。

我同意 4% 高得离奇，但它甚至可能发生在某个狡猾的机器人对您的网站进行一次长时间的爬网尝试中。

希望能帮助到你！

# javascript - 我如何知道打印机是否通过 javascript 取消？

> ID：14753394
> 
> 赞同：2
> 
> 时间：2013-02-07T14:25:11.190
> 
> 标签：javascript, printing

当我单击一个按钮时，事件触发`window.print();`，我需要知道用户是否取消了打印。那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:30:37.140

Javascript 无法检查外部事件！

# jquery - 为什么这个带句号的 jquery 选择器不起作用

> ID：14753395
> 
> 赞同：19
> 
> 时间：2013-02-07T14:25:11.793
> 
> 标签：jquery, jquery-selectors

我有一个带有 ID 的 div

```
<div id="updates-pane-user.followed_on"> 
```

这个 jquery 选择器有效

```
$("[id^='updates-pane']") 
```

但这不是

```
$("#updates-pane-user.followed_on") 
```

我看不出有什么问题.. id 名称可以包含句点，对吗？我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-07T14:26:44.183

在后一个选择器中，`.`用于表示一个类。所以它正在寻找`.followed_on`类，它显然没有找到，所以没有匹配的。

为了解决这个问题，我认为你应该用**双反斜杠转义**点：

`$("#updates-pane-user\\.followed_on")`

根据[jQuery 文档](http://api.jquery.com/category/selectors/)：

> 要使用任何元字符（例如 !"#$%&'()*+,./:;<=>?@[]^`{|}~ ）作为名称的文字部分，它必须使用两个反斜杠进行转义：\\。例如，id="foo.bar" 的元素可以使用选择器 $("#foo\\.bar")。

一般来说，尽量**不要**在您的 ID 中使用句点或其他特殊字符，以免造成混乱。“允许”与“良好做法”不同。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T14:28:19.907

因为`id`jQuery 语法中属性中的点表示类选择器。此选择器等效于将节点选择为：

`<div id="updates-pane-user" class="followed_on">`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-07T14:30:04.453

是的，HTML5 允许在 id 中使用句点，但 jQuery 不是由 w3 组织构建的。它只是一个针对最常见情况优化的实用程序库。

如果您的 ID 有句点，或者任何其他使 jQuery 将其解析为不仅仅是 id 的字符，那么您最好使用标准函数：

```
$(document.getElementById(yourId)) 
```

如果您的 id 来自变量，这是首选解决方案。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-07T14:31:27.400

`$("#updates-pane-user\\.followed_on")`-*这应该按照[Jquery 文档工作](http://docs.jquery.com/Frequently_Asked_Questions#How_do_I_select_an_element_by_an_ID_that_has_characters_used_in_CSS_notation.3F)*

```
// Does not work
 $("#some:id")

 // Works!
 $("#some\\:id")

 // Does not work
 $("#some.id")

 // Works!
 $("#some\\.id") 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-07T14:27:45.010

因为`.`selector 认为有一个类名如下

```
$("#updates-pane-user.followed_on") 
```

`updates-pane-user`意思是：查找所有具有 id = 且具有类名的元素`followed_on`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-02-07T14:36:50.743

肯定会为 JQuery 识别模式创建问题。

jQuery 具有三种类型的选择器：

1.  `"."`选择器的意思是按类名选择一个元素。
2.  `"#"`selector 表示通过 ID 选择一个元素。
3.  和元素选择器，通过名称（`div`等`input` ）选择元素

而且您对 ID 的命名约定感到困惑`jQuery engine`。

它假设有一个 div`id="updates-pane-user"`和一个 applied `class="followed_on"`。在这种情况下`jQuery`，建议使用`//`. 下面应该是您选择元素的语法。

```
$("#updates-pane-user\\.followed_on"); 
```

检查一下这个错误的小提琴并尝试使用以下方法进行更正：http `//`: [//jsfiddle.net/ukJ8Z/](http://jsfiddle.net/ukJ8Z/)

干杯！！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-02-07T14:29:57.200

用它来逃避你的点：

```
$("#updates-pane-user\\.followed_on") 
```

参考：[http ://docs.jquery.com/Frequently_Asked_Questions#How_do_I_select_an_element_by_an_ID_that_has_characters_used_in_CSS_notation.3F](http://docs.jquery.com/Frequently_Asked_Questions#How_do_I_select_an_element_by_an_ID_that_has_characters_used_in_CSS_notation.3F)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-07T14:29:25.053

是的，Jimbo 的答案是正确的，但是您仍然可以使用转义字符来完成这项工作`\\`

```
$("#updates-pane-user\\.followed_on") 
```

使用两 (2) 个反斜杠进行转义。

检查此[链接](http://docs.jquery.com/Frequently_Asked_Questions#How%5Fdo%5FI%5Fselect%5Fan%5Felement%5Fthat%5Fhas%5Fweird%5Fcharacters%5Fin%5Fits%5FID.3F)`How do I select an element by an ID that has characters used in CSS notation?`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-09T10:03:32.753

您还可以使用 id 属性选择器，例如：

```
$('[id="updates-pane-user.followed_on"]') 
```

因为 jQuery 会将属性视为字符串，而不是 jQuery 类选择器。

# c - memcpy 中的 EXC_BAD ACCESS

> ID：14753397
> 
> 赞同：0
> 
> 时间：2013-02-07T14:25:17.757
> 
> 标签：c, exc-bad-access, memcpy

我试图构建一个 BST 并在其中插入节点。但是，在创建新节点时，我不断收到 exc_bad 访问错误。可能是什么原因？这是我的代码：

```
struct Node *node_create(struct BSTree *bst,void *nodeKey, struct Value *nodeVal, struct     Node *rightChild, struct Node *leftChild)
{
struct Node *node = malloc(sizeof *node);
nodeKey= malloc (sizeof (bst->key_size));
nodeVal = malloc(sizeof(bst->value_size));
size_t sizeKey = sizeof(nodeKey);
memcpy(node->key, nodeKey, sizeKey);  // exc_bad access
size_t sizeVal = sizeof (nodeVal);
memcpy(node->val, nodeVal, sizeVal); // exc_bad access
node->right = rightChild;  
node->left = leftChild;

return node;

}

struct Node {
void *key;
struct Value *val;
struct Node *left;
struct Node *right;
};

struct BSTree {
size_t key_size, key_alignment;
size_t value_size, value_alignment;
int (*compare_func)(void *, void *);
struct Node *root;
// ... Maybe some other stuff.
};

struct Value {
char name[10];
int id;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:28:22.233

在不知道`Node`, 看起来像什么的情况下，我会说，即使您已经分配了`node`，您还没有分配所有成员（它们似乎是指针）。

将您的代码更改为：

```
// Allocate node
struct Node *node = malloc(sizeof *node);
// Now members
node->key = malloc (sizeof (bst->key_size)); 
// : 
```

如果您要传入键和值，则将`memcpy`这些值中的一个执行到上述位置。但很难说没有更多的代码......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:41:20.437

不看节点结构，我猜你想要做的是：

如果节点被定义为

```
struct Node {
    void *key;
    struct Value *val;
    struct Node *right;
    struct Node *left;
}; 
```

然后

```
struct Node *node_create(struct BSTree *bst,void *nodeKey, struct Value *nodeVal, struct     Node *rightChild, struct Node *leftChild)
{
struct Node *node = malloc(sizeof *node);

  node->key = malloc(bst->key_size);          /* No sizeof here */
  node->val = malloc(bst->value_size);
  memcpy(node->key, nodeKey, bst->key_size);  
  memcpy(node->val, nodeVal, bst->value_size);
  node->right = rightChild;  
  node->left = leftChild;

  return node;
} 
```

由于您不检查`malloc`s 的返回值（这是一个可以证明的设计选择），您甚至可以用这种方式更简单地编写它。

```
struct Node *node_create(struct BSTree *bst,void *nodeKey, struct Value *nodeVal, struct     Node *rightChild, struct Node *leftChild)
{
struct Node *node = malloc(sizeof *node);

  node->key = memcpy(malloc(bst->key_size)  , nodeKey, bst->key_size); 
  node->val = memcpy(malloc(bst->value_size), nodeVal, bst->value_size);
  node->right = rightChild;  
  node->left = leftChild;
  return node;
} 
```

有些人对这种风格感到畏缩，但我不想在冗余上过多地稀释我的代码。

# javascript - 在 Highcharts 中创建带有起点和终点的线

> ID：14753401
> 
> 赞同：0
> 
> 时间：2013-02-07T14:25:41.517
> 
> 标签：javascript, highcharts, linear-regression

请看下面的例子：

```
<script type="text/javascript">
var $j = jQuery.noConflict();

function recalculateUTCValue(startingUTC, add) {
    zeit = new Date(startingUTC);
    zeit.setDate(zeit.getDate()+add);
    return zeit;
}

function calcDateFromUTC(utc) {
    d = new Date(utc);
    return d;
}

function getDaysUntilEnd(utc) {
    var currentTime = new Date();
    var endTime = calcDateFromUTC(utc);
    var diff =  Math.floor(( Date.parse(endTime) - Date.parse(currentTime) ) / 86400000);
    return diff;
}
</script>
<script type="text/javascript">

var highchartsOptions   = Highcharts.setOptions(Highcharts.theme);
var TaskChart; // Chart-Objekt
var container = $j('#chart01')[0];

var TaskDuration          = new Array();

var startingKW = 298;
// Save starting points to javascript variables for HighCharts
var startingUTC = 1288087223364;
// For a given time point id
var startTimePoint = 0;
var endTimePoint = 0;

TaskDuration =  [0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,216.0,216.0,216.0,198.0,134.0,134.0,134.0,171.0,171.0,171.0,149.0,160.5,160.5,160.5];

// Get first value which is not "0"
var firstValue = 0;
for(var i = 0; i < TaskDuration.length; i++) {
    if(TaskDuration[i] != 0) {
        firstValue = i;
        break;
    }
}

// Get largest Y-Value; need for automatically zooming (setExtremes method)
var largest = Math.max.apply(Math, TaskDuration);
var myStartDate;
var myEndDate;
// Check if we have a time point in the query
if(startTimePoint != 0) {
    var myStartDate = calcDateFromUTC(startTimePoint);
    var myEndDate = calcDateFromUTC(endTimePoint);
} else {
    // Otherwise we use the time of first created work item
    var myStartDate = recalculateUTCValue(startingUTC, firstValue); 
    var myEndDate = new Date();
}
</script>
<script type="text/javascript">
$j(document).ready(function() { 
    TaskChart = new Highcharts.Chart({
    credits: {
            enabled: false
    },
    chart: {
      renderTo: "chart01",
      defaultSeriesType: 'line',
      zoomType: 'x',
      events: {
          load: function(event) {
              this.xAxis[0].setExtremes(myStartDate, myEndDate);
              this.yAxis[0].setExtremes(0,largest);
          }
      }
    },
    title: {
      text: "Task Burn Down Chart"
    },
    xAxis: {
        type: 'datetime',
        dateTimeLabelFormats: {
            week: '%e. %b %Y'   
        },
        labels: {
            align: 'right',
            rotation: -60,
            x: 5,
            y: 15
        },
        offset: 10
    },
    yAxis: {
      title: {
        text: "Number of Hours"
      }
    },
    tooltip: {
        formatter: function() {
            return '<b>'+ this.series.name +'</b><br/>' + Highcharts.dateFormat('%d.%m', this.x) +': '+ this.y;;            
        }
    },
    plotOptions: {
        area: { 
           stacking: 'normal',
           lineColor: '#666666',
           lineWidth: 1,
           marker: {
              lineWidth: 1,
              lineColor: '#666666'
           }
        }
     },
    series: [
    {
        name: 'Hours',
        pointStart: startingUTC,
        pointInterval: 24*60*60*1000, 
        data: TaskDuration
    }, 
    { 
        type: 'line',
        name: 'Regression Line',
        data: [[myStartDate, 216], [myEndDate, 50]],
        marker: {
            enabled: false
        },
        states: {
            hover: {
                lineWidth: 0
            }
        },
        enableMouseTracking: false
    }]
  });

});
</script> 
```

[http://jsfiddle.net/JwmuT/8/](http://jsfiddle.net/JwmuT/8/)

目标是创建一条 Highchart 线，起点为 X-Value 1 月 26 日，终点为 X-Value 2 月 7 日。对应的 Y 值是“260”和“0”。

如何在 HighCharts 中用这些点创建一条简单的线？也许 Highcharts 能够即时进行线性回归？！

我[找到了这个演示](http://www.highcharts.com/demo/combo-regression)，但我不知道如何以日期格式正确传递 X 值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:04:20.893

Highcharts 不计算任何类型的回归或趋势线。在您发布的示例中，数据是之前计算的，Highcharts 只是显示它。然而，趋势线有一个已知的插件：[https ://github.com/virtualstaticvoid/highcharts_trendline](https://github.com/virtualstaticvoid/highcharts_trendline)

# iphone - UITableView 传递数据

> ID：14753402
> 
> 赞同：0
> 
> 时间：2013-02-07T14:25:42.327
> 
> 标签：iphone, xcode, json, uitableview

抱歉，这对你们中的很多人来说可能是一个新手问题，但在过去的几个小时里，我一直在绕圈子。

我有一张桌子，当按下该行时会弹出第二个视图。

```
-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
    BlogDetailViewController *blogDetailViewController = [[BlogDetailViewController alloc] initWithNibName:@"BlogDetailViewController" bundle:nil];
    blogDetailViewController.title = [idArray objectAtIndex:indexPath.row];
    blogDetailViewController.newsArticle = [content objectAtIndex:indexPath.row];
    [self.navigationController pushViewController:blogDetailViewController animated:YES];
} 
```

然后在我的下一个视图中，我有一个文本框，我想显示 [content objectAtIndex:indexPath.row]; 的内容。

到目前为止，我已将其添加到 secoundview.h

```
@interface BlogDetailViewController : UIViewController{

    NSDictionary *newArticle;
    IBOutlet UITextView *descTextView;

  }

@property (nonatomic, copy) NSDictionary *newsArticle; 
```

我也有@synthesize newsArticle；在 secoundview.m 上，并连接了 IBOutlet。

到目前为止我有

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    descTextView.text = [content];

    // Do any additional setup after loading the view from its nib.
} 
```

如果这没有意义，希望能解释我可以上传 zip 的内容。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:32:15.387

我对这个问题有点困惑，因为它不是很清楚，但我认为你正在做的是将数据从表视图传递到另一个视图，但下一个视图不显示数据？在这种情况下，最简单的做法是添加`viewWillAppear`将内容 ( `newArticle`?) 放入`descTextView`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-07T15:01:13.893

descTextView.text = [NSString stringWithFormat:newsArticle]; 这显示了文本视图中的字符串

# javascript - jQuery子激活父点击事件

> ID：14753405
> 
> 赞同：3
> 
> 时间：2013-02-07T14:26:02.340
> 
> 标签：javascript, jquery, events, dom

我在阻止子元素激活 jQuery 中的父单击事件时遇到问题。我在 Google 上搜索了一下，偶然发现了几种不同的解决方案，但似乎没有一个对我有用。

我需要在单击后使表格单元格可编辑，以便我可以通过 ajax 异步提交编辑后的文本。我正在使用 jQuery 将文本替换为输入字段，但由于每次单击都会再次触发父事件，因此无法对其进行编辑或提交。

我试过使用：

```
$("child").click(function(e){  
  e.stopPropagation();
}) 
```

而且`.unbind("click")`在父级上，一旦单击它就不需要再次单击，但这似乎也解除了对子级的绑定。

为了正确显示问题，我准备了一个[小提琴。](http://jsfiddle.net/9F67j/2/)

任何帮助都将是超级的！这让我疯狂。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:30:17.277

问题是因为`.btn-comment`元素是动态附加的，所以你需要一个委托处理程序。试试这个：

```
$(".td-edit").on('click', '.btn-comment', function(e) {
    e.stopPropagation();
}); 
```

[**更新的小提琴**](http://jsfiddle.net/RoryMcCrossan/9F67j/3/)

请注意小提琴 - 您可以看到事件没有被传播，因为单击元素`alert()`时不会触发。`button`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:31:21.847

这里有几件事。

1.  每次单击表格单元格时，都会重新生成表单元素。这不仅包括单击单元格以将内容切换到编辑控件，还包括单击文本字段以聚焦于它以执行文本更改
2.  单击按钮将永远不会触发，因为它在控件存在于 dom 之前被绑定。

我的建议是让控件已经存在于页面上，但单击元素是为了控制文本框的可见性。此外，将要单击的文本放入跨度或标签或 div 中，然后以这种方式单击它，而不是实际的单元格。

```
$("#td-edit").click(function() {
    $("#td-edit").hide();
    $("#dvEdit").show();
});

$("#btn-comment").click(function(e) {
    $("#td-edit").show();
    $("#dvEdit").hide();
}); 
```

[更新的小提琴](http://jsfiddle.net/9F67j/18/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:41:20.450

我已经更新了你的小提琴，它似乎适用于我创建的内容。也放在这里供参考：

```
function clickEdit() {
    $(this).html("<div class=\"input-append\"><input class=\"updater-text span2\" type=\"text\" value=\"" + $(this).text() + "\" /><button class=\"btn-comment\" type=\"button\" id=\"appendedInputButton\">Save</button>").off('click');
    $('#appendedInputButton').on('click', function(e) {
       e.stopPropagation();
       e = $(this);
       console.log(e.prev().val());
       e.parent().html(e.prev().val()).on('click', clickEdit);
    });
}

$(".td-edit").on('click', clickEdit); 
```

小提琴链接：http: [//jsfiddle.net/9F67j/14/](http://jsfiddle.net/9F67j/14/)

# javascript - 字符串的正则表达式，不以指定的子字符串结尾

> ID：14753406
> 
> 赞同：-2
> 
> 时间：2013-02-07T14:26:07.753
> 
> 标签：javascript, regex

请建议一个正则表达式来查找所有不以“.pdf”结尾的字符串。所以，它应该找到“some string”和“some stringpdf”的stings，而不是像“some string.pdf”这样的字符串

谢谢， 阿列克谢·阿修廷

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:28:56.523

如果您要测试**单个**字符串，您可以使用此正则表达式

```
/^(?!.*\.pdf$).*$/ 
```

* * *

如果字符串中有多个要匹配的字符串，您可以使用

```
/(\s|^)(?![^\s]+\.pdf(\s|$))[^\s]+/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:29:59.717

这是正则表达式

```
/^(?!.*\.pdf$).*/ 
```

例子：

```
var r =  /^(?!.*\.pdf$).*/;
r.test("some string");     //true
r.test("some stringpdf");  //true
r.test("some string.pdf"); //false 
```

实际上，我推荐@Nannuo Lei 的建议。

# java - 在 JTable 中显示 arrayList 的 arrayList

> ID：14753408
> 
> 赞同：0
> 
> 时间：2013-02-07T14:26:10.380
> 
> 标签：java, swing, arraylist, jtable

我有一个arraylist，arrayList 的每个元素都包含一个小的数据arrayList。

我需要根据这些数据创建一个表。你会推荐什么是解决这个问题的最佳途径？

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:56:41.577

请参阅[如何创建表模型](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#data)

一个展示如何创建模型并将对象存储在模型中的小示例。对数据的任何操作都应该使用模型来完成。

创建一个模型并使用一个列表来存储该表的数据。如下例所示。表中的每一行都是一个`Student`对象，每个对象都存储在列表中。遍历列表并获取每个对象并显示在表格中。这是使用`getValueAt(..)`方法完成的。

![JTable 模型示例](../Images/21385cce16cdda06cb8a8a7d92b6b45d.png)

```
import java.awt.EventQueue;
import java.util.ArrayList;
import java.util.List;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.AbstractTableModel;

public class JTableList {
    public static void main(String[] args) {

        Runnable r = new Runnable() {

            @Override
            public void run() {
                CustomModel model = new CustomModel();
                JTable table = new JTable();
                table.setModel(model);

                JFrame frame = new JFrame();
                frame.add(new JScrollPane(table));
                frame.pack();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setVisible(true);             
            }
        };

        EventQueue.invokeLater(r);
    }

}

class CustomModel extends AbstractTableModel {

    List<Student> data;
    String[] columnNames = {"Name", "Age"};

    public CustomModel() {
        data = new ArrayList<Student>();

        data.add(new Student("Amar", 1));
        data.add(new Student("Sam", 2));
        data.add(new Student("Amar", 1));
        data.add(new Student("Sam", 2));
        data.add(new Student("Amar", 1));
        data.add(new Student("Sam", 2));

    }

    @Override
    public String getColumnName(int column) {
        return columnNames[column];
    }

    @Override
    public int getColumnCount() {
        return 2;
    }

    @Override
    public int getRowCount() {
        return data.size();
    }

    @Override
    public Object getValueAt(int rowIndex, int columnIndex) {
        Student student = data.get(rowIndex);
        switch (columnIndex) {
        case 0:
            return student.getName();
        case 1:
            return student.getAge();
        default:
            return null;
        }
    }

}

class Student {
    private String name;
    private int age;

    public Student(String name, int age) {
        this.name = name;
        this.age = age;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public int getAge() {
        return age;
    }
    public void setAge(int age) {
        this.age = age;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:41:52.887

列表表[模型](http://tips4java.wordpress.com/2008/11/24/list-table-model/)可用于执行此操作。

这是一个更复杂、更灵活的解决方案，实现了这个线程中给出的早期建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:43:14.070

要显示列表列表的 GUI 表，我将创建一个实现“TableModel”接口的类，并有一个接受“列表>”的构造函数

```
public class ListTableModel <T> implements TableModel {

    private List<List<T>> source;

    public ListTableModel(List<List<T>> source) {

        this.source = source;

    }

    //Override 'getRowCount' 
    //The row count would be calculated as the size of the outer list.
    @Override
    public int getRowCount() {
        return source.size();
    }

    //Override 'getColumnCount'
    //The column count would be calculated as the max size of the inner lists
    @Override
    public int getColumnCount() {
        int max = 0;
        for(List<T> row : source) {
            max = Math.max(max, row.size());
        }
        return max;
    }

    //Override 'getColumnName'
    //Lets go ahead and just give a unique name to each column based on the index.
    //This could be populated from an input taken by the constructor, but we
    //won't worry about that now.
    @Override
    public String getColumnName(int columnIndex) {
        return "Column " + columnIndex;
    }

    //Override 'getColumnClass'
    //The class would technically be the generic type 'T', so to get this we 
    //will simply just get the calss of the first element.
    @Override
    public Class<?> getColumnClass(int columnIndex) {
        return source.get(0).get(0).getClass();
    }

    //Override 'isCellEditable'
    //I'm going to assume we don't want cell to be editable.
    @Override
    public boolean isCellEditable(int rowIndex, int columnIndex) {
        return false;
    }

    @Override
    public Object getValueAt(int rowIndex, int columnIndex) {
        List<T> row = source.get(rowIndex);
        if(columnIndex >= row.size())
            return null;
        else 
            return row.get(columnIndex);
    }

    @Override
    public void setValueAt(Object aValue, int rowIndex, int columnIndex) {
        //required but we will assume that you cannot change the source list
        //if we needed to, it wouldn't be too difficult to implement.
    }

    @Override
    public void addTableModelListener(TableModelListener l) {
        //required but not used (will only be used if the source could change)
    }

    @Override
    public void removeTableModelListener(TableModelListener l) {
        //required but not used (will only be used if the source could change)
    }

} 
```

你可以像这样使用这个模型和你的列表：

```
List<List<String>> myList = new ArrayList();

//Populate 'myList'...

JTable table = new JTable();

//Add table to view...

table.setModel(new ListTableModel(myList)); 
```

编辑如果您愿意，我可以向您展示如何实现 TableModel。

# r - 为什么 data.table 在分组后会丢失 .SD 中的类定义？

> ID：14753411
> 
> 赞同：9
> 
> 时间：2013-02-07T14:26:22.137
> 
> 标签：r, class, data.table

我试图将我自己的类附加到一个`numeric`, 以改变输出`format`。这很好用，但是在我进行分组后`by`，该类恢复为数字。

示例：为我的班级定义一个新的格式函数：

```
format.myclass <- function(x, ...){
  paste("!!", x, "!!", sep = "")
} 
```

然后做一个小`data.table`的并将其中一列更改为 myclass：

```
> DT <- data.table(L = rep(letters[1:3],3), N = 1:9)
> setattr(DT$N, "class", "myclass")
> DT
   L     N
1: a !!1!!
2: b !!2!!
3: c !!3!!
4: a !!4!!
5: b !!5!!
6: c !!6!!
7: a !!7!!
8: b !!8!!
9: c !!9!! 
```

现在执行 group by 并且 N 列恢复为整数：

```
> DT[, .SD, by = L]
   L N
1: a 1
2: a 4
3: a 7
4: b 2
5: b 5
6: b 8
7: c 3
8: c 6
9: c 9

> DT[, sapply(.SD, class), by = L]
   L      V1
1: a integer
2: b integer
3: c integer 
```

知道为什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T15:06:16.187

因为每当 R 对向量进行子集化时，它就会丢弃该类。为什么？好吧，因为它是一个arse，这就是原因。您需要编写一个“[”-subset 方法。

```
> DT[,N]
[1] 1 2 3 4 5 6 7 8 9
attr(,"class")
[1] "myclass"
> DT[1:2,N]
[1] 1 2 
```

看看向量子集如何删除了类？那就是问题所在。data.table 在某个时候对您的向量执行此操作。编写一个“[”方法（只需复制 Date 使用的那个）：

```
"[.myclass"= function (x, ..., drop = TRUE){
    cl <- oldClass(x)
    class(x) <- NULL
    val <- NextMethod("[")
    class(val) <- cl
    val
}

> DT[1:2,N]
[1] 1 2
attr(,"class")
[1] "myclass" 
```

现在它有一些类。这也用 sapply 修复了你的最后一行：

```
> DT[, sapply(.SD, class), by = L]
   L      V1
1: a myclass
2: b myclass 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-20T18:27:06.490

**这现在在[v1.8.11 中修复，提交 1005+](https://r-forge.r-project.org/R/?group_id=240)。来自[新闻](https://r-forge.r-project.org/scm/viewvc.php/pkg/NEWS?view=markup&root=datatable&pathrev=1005)：**

> o`.SD`不保留列的类现在已修复。感谢 Corone 在此处报告 SO： [为什么 data.table 在分组后会丢失 .SD 中的类定义？](https://stackoverflow.com/questions/14753411/why-does-data-table-lose-class-definition-in-sd-after-group-by)

# yaml - YAML 语法错误

> ID：14753413
> 
> 赞同：0
> 
> 时间：2013-02-07T14:26:22.560
> 
> 标签：yaml, bukkit

我正在为 Bukkit 中的 PermissionsEx 开发一个 permissions.yml 文件。

我最近在验证语法时遇到了一个错误，在用尽所有选项后，错误仍然显示为“第 130 行的语法错误，第 18 列：`'”（此代码中没有制表符间距）

代码可以在这里找到 [http://pastebin.com/KDKvd18H](http://pastebin.com/KDKvd18H)

如果有人能够帮助我纠正这个错误，我们将不胜感激。

亲切的问候， Cian

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:40:44.860

我在一行之后发现了一个制表符 (\t) 字符。我修复了您的 YAML，至少[在线 YAML 解析器](http://yaml-online-parser.appspot.com/)可以理解它。给你： http: [//pastebin.com/uLTs42FA](http://pastebin.com/uLTs42FA)。问题出在以下部分之后：

```
 Duke:
    prefix: '&6[&1D&2u&1k&2e&6]&8 '
    options:
         rank: '900'
    permissions:
    - essentials.heal
    - essentials.kit
    - essentials.balance
    - essentials.pay
    - essentials.afk
    - essentials.help
    - essentials.helpop 
```

# c++ - 虚方法调用线程安全吗？

> ID：14753416
> 
> 赞同：2
> 
> 时间：2013-02-07T14:26:25.943
> 
> 标签：c++, thread-safety

如果多个线程共享一个指向同一个对象的指针，那么调用它的虚方法是否安全？当然我们应该假设方法本身是线程安全的。

```
class Base {
public:
  virtual int test(int arg) = 0;
};

class Derived1: public Base {
public:
  virtual int test(int arg) { return arg * 2; }
};

class Derived2: public Base {
public:
  virtual int test(int arg) { return arg * 3; }
};

//call in threads:
Base* base = (pointer to the same Derived1);
int value = base->test(1); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:29:50.783

是的，这很好，只要对象的生命周期`*base`超过函数调用的生命周期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:30:57.120

调用虚函数通常是通过在类中查找 vtable 条目来实现的。这个 vtable 不会改变，所以对于这个实现，它应该是线程安全的。

我不认为有一个普遍的保证。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:49:22.473

根据“Kerrek SB 对先前答案的评论，我已经开始了大约三遍这个答案。在我看来，没有阅读规范直到我的眼睛流血，我不确定什么不应该是虚拟线程安全的call - “虚拟函数选择”（vtable 或任何它可能是）的实现绝对不会引起任何问题，因为它应该只是指向函数的指针，它基于索引 [或类似的] 被调用选择的功能。

对不起，这不是答案，但我很难看到任何情况，在我知道它是如何工作的任何处理器上（x86、68K、29k、ARM 是我已经足够使用的处理器）了解如何在汇编程序中实现虚函数）由于线程而出错 - 假设其他代码是安全的 - 如果在上面的示例中我们要运行第二个线程来修改哪些元素`base`指向，你可能有一些某种竞争条件，其中 base 的值指向错误的虚函数集，或类似的。但这不是调用本身，而是修改`base`“非线程安全”的代码。

当然，可能有一些“业余”编译器以其他方式解决虚函数。

当然，如果出现问题 - 除非您在整个虚拟调用期间阻塞其他线程 - 并且如果您有一个通过将虚拟函数`run(void *args)`作为“this是在线程内运行的内容”，这是我见过几次的东西，这几乎会完全杀死该功能！

所以，基本上，虽然我无法参考说明这是安全的规范部分，但除了“它必须是”之外，我看不到任何解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T14:31:16.457

如果该方法是线程安全的，那就没问题了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T15:14:56.037

简而言之：如果不是，C++ 将根本无法用于多线程编程。

长篇：

1.  编译后程序是不变的。所以它的线程安全。

2.  在加载（模块）时，运行时系统会更改 RTTI 的数据结构（dynamic_cast，...）。这超出了您的范围，但应该以线程安全的方式实现。

3.  构造后，对象的类型不会改变（您可以使用非常肮脏的技巧）。所以你所有对象的所有虚函数都不应该改变。所以它的线程安全。

但是您应该考虑到可以被视为虚拟函数（boost 函数，loki 函子，...）的替代的类成员可能具有值语义并且可以在调用时更改。在这种情况下，它应该被记录在案或者应该实现更好的使用它们的接口。

在我看来，您可以安全地调用虚拟方法。即使在有人尝试模仿虚函数的情况下，您也可以期待正常（安全）的行为。

# string - sprintf（将 int 转换为 char[]）

> ID：14753423
> 
> 赞同：2
> 
> 时间：2013-02-07T14:26:45.060
> 
> 标签：string, int, type-conversion, printf

在我的程序中，我尝试将 int 转换为 char[20];

我尝试通过以下方式执行此操作：

```
 char str[20];    
  sprintf(str, "%d", timer); 
```

其中计时器是int。

但是当我构建此代码时，我收到以下警告。

```
Type implicit declaration of function 'sprintf' [-Wimplicit-function-declaration]   
incompatible implicit declaration of built-in function 'sprintf' [enabled by default] 
```

这意味着什么？

注意：（我已经包含了 string.h 和 stdlib.h）。

* * *

太好了，我将 stdio.h 添加到我的代码中，现在警告消失了，只是给了我一个更严重的错误。

对“_sbrk”的未定义引用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:30:52.880

你必须`#include <stdio.h>`使用`sprintf()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T14:33:34.787

您要确保还添加了对

```
stdio.h
```

[看到这个参考](http://www.cplusplus.com/reference/cstdio/sprintf/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:28:25.907

您可能需要放入`sprintf(str, "%d", timer)`一个函数（而不是源代码的全局部分）。

就像是：

```
#include <stdlib.h>
char str[20];
// SPOT #1
int f() {
    sprintf(str, "%d", timer); // this won't work if placed on SPOT #1
} 
```

# php - 了解数组排序行为php

> ID：14753426
> 
> 赞同：5
> 
> 时间：2013-02-07T14:27:08.100
> 
> 标签：php, arrays, sorting

我有这个数组

```
$array = array(2, 1, "img1", "img2", "img10", 1.5, "3.14", "2.72"); 
```

应用`sort`函数后它变成

```
sort($array);

Array
(
    [0] => 2.72
    [1] => 3.14
    [2] => img1
    [3] => img10
    [4] => img2
    [5] => 1
    [6] => 1.5
    [7] => 2
) 
```

我不明白排序是如何执行的。

谁能解释一下输出数组是如何实现的？

编辑：

这里的问题不是`SORT FLAG`我应该使用哪个，而是问题是如何执行上述排序。任何使用另一个的建议在`SORT FLAG`这里都是无用的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T14:32:16.800

前两个数字是实际的字符串（您在引号中传递它们），因此它们被视为这样：在字母排序中，数字位于任何字母之前。

其他的是实数（不带引号），因此该函数将它们分开放置，并按数字排序。

```
array(8)
    0 => '2.72'    [alphabetical]
    1 => '3.14'    [alphabetical]
    2 => 'img1'    [alphabetical]
    3 => 'img10'   [alphabetical]
    4 => 'img2'    [alphabetical]
    5 => 1         [numeric]
    6 => 1.5       [numeric]
    7 => 2         [numeric] 
```

因此，该函数必须决定是按字母顺序（a、b、c...）还是按数字顺序（1、2、3..）对元素进行排序，所以它只检查变量类型。

就像 Pekka 指出的那样，可以设置一些标志来强制排序类型。[它们在文档中进行了描述](http://www.php.net/manual/en/function.sort.php)。

* * *

## 编辑

这个理论在评论中被证明是错误的，我现在完全迷失了（：

[文档中的此评论](http://www.php.net/manual/en/function.sort.php#72780)包含有关此问题的一些有趣的观点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T00:53:07.047

使用 Coanda 链接中的信息作为起点，很明显 PHP 在比较不同类型的对象时使用了类型杂耍。问题是在比较过程中了解什么是什么，我仍然无法找到完整的列表，但总的来说：

string 与 int 相比将变成

```
(int) string <,>,=, (int) int 
```

在这种情况下，字符串在转换后变为 0，因此所有整数都大于字符串。（预期的）。这是我们需要担心的唯一情况。

PHP 使用快速排序，并且很可能选择它的枢轴点作为`array[n/2]`其中 n 是数组中元素的数量。知道这两条信息后，我们对上述数组进行快速排序：

```
$pivot = $array[n/2] //n is the number of elements, this sets $pivot='img2'
//compare each element in the list (i am going to this by hand for demonstration)

(int) 'img2' < 2 //int to int comparison;'img2' resolves to 0 and 0 < 2
(int) 'img2' < 1 //int to int comparison;'img2' resolves to 0 and 0 < 1
      'img2' > 'img1' // string to string comparison; strcmp is +256 
      'img2' > 'img 10' //string to string comparison; strcmp is +256 
(float) 'img2' < 1.5 //float to float comparison;'img2' resolves to 0 and 0<1.5 
      'img2' > '3.14' //string to string comparison; strcmp is +54
      'img2' > '2.72' //string to string comparison; strcmp is +55 
```

我们现在有两个新数组（一个用于更大，一个用于小于）。

```
 $greater = array('img1', 'img10', '3.14', '2.72);
 $less = array(2, 1, 1.5); 
```

现在几乎不需要进一步详细说明，因为我们不小心制作了 2 个数组，其中包含所有易于比较的对象。`$greater`只有字符串，我们可以假设 sort 在这里可以正常工作并将所有内容都视为字符串。

```
sort($greater);
var_dump($greater); 
```

生产

```
array(4) {
  [0]=>
  string(5) "2.72"
  [1]=>
  string(4) "3.14"
  [2]=>
  string(4) "img1"
  [3]=>
  string(5) "img10"
} 
```

这是我们所期望的，也是上面的结果。我们做同样的事情`$lesser`

```
$lesser = array(2, 1, 1.5);
sort($lesser);
var_dump($lesser); 
```

我们得到

```
array(3) {
  [0]=>
  int(1)
  [1]=>
  float(1.5)
  [2]=>
  int(2)
} 
```

这也是意料之中的。现在，当我们将所有三个数组连接在一起时（为了递归，我将“img2”称为数组）。我们得到上面的结果。

```
Array
(
[0] => 2.72
[1] => 3.14
[2] => img1
[3] => img10
[4] => img2
[5] => 1
[6] => 1.5
[7] => 2
) 
```

为了证明这一点，您可以对同一个数组遵循相同的过程，但将`$arr[3]`换成整数。

```
$arr = array("img2", 1, "img1", 2, "img10", 1.5, "3.14", "2.72");
sort($arr);
var_dump($arr) 
```

给您一个完全不同的结果，因为枢轴从字符串更改为 int 导致浮点字符串评估为浮点数。

```
array(8) {
[0]=>
string(4) "img1"
[1]=>
string(5) "img10"
[2]=>
string(4) "img2"
[3]=>
int(1)
[4]=>
float(1.5)
[5]=>
int(2)
[6]=>
string(4) "2.72"
[7]=>
string(4) "3.14"
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:37:14.297

以下错误提供了对混合类型排序的更多见解：[https ://bugs.php.net/bug.php?id=21728](https://bugs.php.net/bug.php?id=21728)

引用：

```
<?php
$arr1 = array("a","b","c","d","4",5,4,"true","TRUE",true);
sort($arr1);
var_dump($arr1);
?>

The output is :
array(10) {
  [0]=>
  bool(true)
  [1]=>
  int(4)
  [2]=>
  string(1) "4"
  [3]=>
  string(4) "TRUE"
  [4]=>
  string(1) "a"
  [5]=>
  string(1) "b"
  [6]=>
  string(1) "c"
  [7]=>
  string(1) "d"
  [8]=>
  string(4) "true"
  [9]=>
  int(5)
} 
```

> 它可能看起来很奇怪 - 为什么 (int)5 在所有字符串之后。这是因为“4”低于（int）5，“4”在“true”之前，“true”在5之前。前2个明显，第三个不明显。但没关系。最好不要在数组中混合类型。如果将 5 更改为“5”，则“5”紧随“4”之后。

# sql - SQL，多行到一列

> ID：14753436
> 
> 赞同：1
> 
> 时间：2013-02-07T14:27:42.010
> 
> 标签：sql, pivot, rows, multiple-columns

所以我有以下日期

```
ID       NAME       MONTH              COUNT

1        David      December2012       500

2        Rob        December2012       320

1        David      January2013        400

2        Rob        January2013        280 
```

我正在努力做到这一点.......

```
ID       Name       December2012       January2013

1        David      500                400

2        Rob        320                280 
```

我感到困惑的地方是我想如何保留两列并只旋转另外两个字段。任何人都知道我会怎么做。

非常感谢您的帮助/时间。我从未发布过其中之一，非常感谢您的回复！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T14:30:35.693

您没有指定您使用的 RDBMS。您可以使用带有表达式的聚合函数来*透视所有数据库中的数据：*`CASE`

```
select id, name, 
  sum(case when month = 'December2012' then "count" end) December2012,
  sum(case when month = 'January2013' then "count" end) January2013
from yourtable
group by id, name 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/ab152/3)

如果您使用的是 SQL Server 2005+ 或 Oracle 11g，那么您可以使用以下`PIVOT`功能：

```
select *
from
(
  select id, name, month, [count]
  from yourtable
) src
pivot
(
  sum([count])
  for month in (December2012, January2013)
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/ab152/1)。

在 SQL Server 中，如果 的值`month`未知，则可以使用类似于以下的动态 SQL：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(month) 
                    from yourtable
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT id, name,' + @cols + ' from 
             (
                select id, name, month, [count]
                from yourtable
            ) x
            pivot 
            (
                sum([count])
                for month in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/ab152/4)

所有版本都会产生结果：

```
| ID |  NAME | DECEMBER2012 | JANUARY2013 |
-------------------------------------------
|  1 | David |          500 |         400 |
|  2 |   Rob |          320 |         280 | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:30:44.810

由于您没有指定您使用的 RDBMS，因此您可以这样做：

```
SELECT
  ID,
  NAME,
  MAX(CASE WHEN MONTH = 'December2012' THEN "COUNT" END) AS "December2012",
  MAX(CASE WHEN MONTH = 'January2013'  THEN "COUNT" END) AS "January2013"
FROM Tablename
GROUP BY ID, Name; 
```

# php - Joomla 扩展更新 - 将列添加到数据库表

> ID：14753441
> 
> 赞同：0
> 
> 时间：2013-02-07T14:27:53.823
> 
> 标签：php, mysql, joomla, joomla2.5, joomla-extensions

我已阅读有关在扩展更新时运行 SQL 文件的[Joomla 文档](http://docs.joomla.org/Managing_Component_Updates_with_Joomla!2.5_-_Part_4)，但问题是我们的扩展的先前版本没有 SQL 文件，因此无法使用此方法。

我很确定可以在 installscript.php 中运行 SQL 命令，因此我尝试将查询添加到更新函数中，如下所示：

```
function update( $parent ) {

    echo '<p>' . JText::_('MOD_SHOUTBOX_UPDATE') . $this->release . '</p>';

    $db = JFactory::getDBO();
    $sql = "ALTER TABLE #__shoutbox ADD COLUMN user_id int(11) NOT NULL DEFAULT '0'";
    $db->setQuery($sql);
} 
```

如果查询是通过 PHPMyAdmin 添加的，并且我还打开了系统调试，但查询没有出现在列表中，则查询工作正常。

有谁知道我要去哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:55:56.610

如果您确定`update`调用该函数而不是它不起作用的唯一原因是您缺少`query`函数。

添加这一行

```
$result = $db->query(); 
```

后

```
$db->setQuery($sql); 
```

希望这会有所帮助。

# c - 如果没有 return 语句，这个 C int 函数如何工作？

> ID：14753444
> 
> 赞同：1
> 
> 时间：2013-02-07T14:27:58.377
> 
> 标签：c, recursion, return

我有这个 C 代码，我确信它不会工作，但它确实有效。

```
#include <stdio.h>

int* find (int* a, int val) {
    if (*a == val)
        return a;
    else
        find(a+1, val);
}

int main() {
    int a[10] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};
    int *b;

    b = find(a, 7);

    printf("%d\n", *b);

    return 0;
} 
```

当然，我收到了来自 gcc 的警告，因为它在`find`函数的 else 分支中缺少 return 语句。但是，它完美地工作。

为什么会这样？它怎么知道通过递归函数返回一个int？当然，最后一次调用返回一个 int，但我在 void 上下文中调用它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T14:31:58.357

**此代码不是有效的 C 代码，并且未定义此类代码的行为。**

它起作用的一个原因可能是在最后一次调用之后没有任何操作，`find`这**可能**导致递归调用的返回值保留在返回寄存器中（可能是 eax）。

**但同样 - 行为是未定义的**。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T14:31:15.230

这*似乎*有效，但它是*未定义的行为*。只是碰巧在您的特定实现/平台`b`中采用从`find`. 但是，在不同的实现/平台上，这也可能会崩溃。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T14:30:50.083

假设您打算写作`find`而不是`trova`（我知道学习意大利语有一天会派上用场:)，答案是这并不完美。由于未定义的行为，它纯粹是偶然地“起作用”。

最有可能的是，最深的递归调用将返回值推送到某个寄存器中，更高级别的调用不会触及这些寄存器，因为它们没有 return 语句，并且当调用者检查该寄存器时，最深调用的返回值还在那里。不过，你不能依赖这个。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-07T15:13:09.653

我找不到参考，但我记得几年前，在 GCC 中，返回值寄存器（在 CPU 上分配）总是有最后一个返回值，所以如果你计算了一些值并且没有返回值，前一个价值持续存在。使用此“功能”似乎是一种不好的做法。

也许还看到

[http://stackoverflow.com/questions/1610030/why-can-you-return-from-a-non-void-function-without-returning-a-value-without-pr](http://forums.freebsd.org/archive/index.php/t-32752.html)

[C：如果没有给出值，默认返回值？](http://forums.freebsd.org/archive/index.php/t-32752.html)

那说： Uniballer 2012 年 6 月 15 日，01:44 C 语言未定义行为，因为您没有在函数中执行您在函数声明中所说的操作。实际上，在 x86 上，函数的值将是返回时寄存器 eax 中发生的任何值。

# jquery-ui - jQueryUI 工具提示小部件在点击时显示工具提示

> ID：14753458
> 
> 赞同：12
> 
> 时间：2013-02-07T14:28:34.283
> 
> 标签：jquery-ui, widget, onclick, tooltip

如何修改新的 jQueryUI 工具提示小部件以在文档上某些元素的单击事件上打开工具提示，而其他元素仍在鼠标悬停事件上显示其提示。在单击打开的情况下，应通过单击文档上的其他位置来关闭工具提示。

这可能吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-21T16:09:57.440

使用 jqueryui：

HTML：

```
<div id="tt" >Test</div> 
```

JS：

```
$('#tt').on({
  "click": function() {
    $(this).tooltip({ items: "#tt", content: "Displaying on click"});
    $(this).tooltip("open");
  },
  "mouseout": function() {      
     $(this).tooltip("disable");   
  }
}); 
```

您可以使用 [http://jsfiddle.net/adamovic/A44EB/检查它](http://jsfiddle.net/adamovic/A44EB/)

感谢 Piradian 帮助改进代码。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-01-13T16:31:21.743

此代码创建一个工具提示，该工具提示将保持打开状态，直到您在工具提示之外单击。即使在您关闭工具提示后它仍然有效。这是对[Mladen Adamovic 回答](https://stackoverflow.com/a/16133224/1763602)的详细说明。

小提琴：http: [//jsfiddle.net/c6wa4un8/57/](http://jsfiddle.net/c6wa4un8/57/)

代码：

```
var id = "#tt";
var $elem = $(id);

$elem.on("mouseenter", function (e) {
    e.stopImmediatePropagation();
});

$elem.tooltip({ items: id, content: "Displaying on click"});

$elem.on("click", function (e) {
    $elem.tooltip("open");
});

$elem.on("mouseleave", function (e) {
    e.stopImmediatePropagation();
});

$(document).mouseup(function (e) {
    var container = $(".ui-tooltip");
    if (! container.is(e.target) && 
        container.has(e.target).length === 0)
    {
        $elem.tooltip("close");
    }
}); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-12-23T21:14:25.080

这个答案基于使用不同的类。当单击事件发生在具有“触发器”类的元素上时，该类将更改为“触发”并触发 mouseenter 事件以将其传递给 jquery ui。

在此示例中取消了 Mouseout，以使所有内容都基于单击事件。

HTML

```
<p>
<input id="input_box1" />
<button id="trigger1" class="trigger" data-tooltip-id="1"  title="bla bla 1">
?</button>
</p>
<p>
<input id="input_box2" />
<button id="trigger2" class="trigger" data-tooltip-id="2"  title="bla bla 2">
?</button>
</p> 
```

jQuery

```
$(document).ready(function(){ 
$(function () {
//show
$(document).on('click', '.trigger', function () {
    $(this).addClass("on");
    $(this).tooltip({
        items: '.trigger.on',
        position: {
            my: "left+15 center",
            at: "right center",
            collision: "flip"
        }
    });
    $(this).trigger('mouseenter');
});
//hide
$(document).on('click', '.trigger.on', function () {
    $(this).tooltip('close');
    $(this).removeClass("on")
});
//prevent mouseout and other related events from firing their handlers
$(".trigger").on('mouseout', function (e) {
    e.stopImmediatePropagation();
});
})
}) 
```

[http://jsfiddle.net/AK7pv/111/](http://jsfiddle.net/AK7pv/111/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-08-26T10:30:38.863

我今天一直在玩这个问题，我想我会分享我的结果......

使用来自 jQueryUI 工具提示、自定义样式和自定义内容的示例

我想拥有这两者的混合体。我希望能够有一个弹出窗口而不是工具提示，并且内容需要是自定义 HTML。所以没有悬停状态，而是点击状态。

我的 JS 是这样的：

```
 $(function() {
        $( document ).tooltip({
            items: "input",
            content: function() {
                return $('.myPopover').html();
            },
            position: {
                my: "center bottom-20",
                at: "center top",
                using: function( position, feedback ) {
                    $( this ).css( position );
                    $( "<div>" )
                            .addClass( "arrow" )
                            .addClass( feedback.vertical )
                            .addClass( feedback.horizontal )
                            .appendTo( this );
                }
            }
        });

        $('.fireTip').click(function () {
            if(!$(this).hasClass('open')) {
                $('#age').trigger('mouseover');
                $(this).addClass('open');
            } else {
                $('#age').trigger('mouseout');
                $(this).removeClass('open');
            }

        })

    }); 
```

第一部分或多或少是来自 UI 站点的代码示例的直接副本，并在工具提示块中添加了项目和内容。

我的 HTML：

```
 <p> 
       <input class='hidden' id="age"  /> 
       <a href=# class="fireTip">Click me ya bastard</a>
   </p>

  <div class="myPopover hidden">
       <h3>Hi Sten this is the div</h3>
  </div> 
```

基本上，当我们单击锚标记（fireTip 类）时，我们会欺骗悬停状态，保存工具提示的输入标记会调用鼠标悬停状态，因此会触发工具提示并根据我们的意愿保持它... CSS 开启小提琴...

无论如何，这里有一个小提琴可以更好地看到交互：http: [//jsfiddle.net/AK7pv/](http://jsfiddle.net/AK7pv/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2014-02-12T10:43:44.623

此版本确保工具提示保持可见的时间足够长，以便用户将鼠标移到工具提示上并保持可见直到鼠标移出。方便用户从工具提示中选择一些文本。

```
$(document).on("click", ".tooltip", function() {
    $(this).tooltip(
        { 
            items: ".tooltip", 
            content: function(){
                return $(this).data('description');
            }, 
            close: function( event, ui ) {
                var me = this;
                ui.tooltip.hover(
                    function () {
                        $(this).stop(true).fadeTo(400, 1); 
                    },
                    function () {
                        $(this).fadeOut("400", function(){
                            $(this).remove();
                        });
                    }
                );
                ui.tooltip.on("remove", function(){
                    $(me).tooltip("destroy");
                });
          },
        }
    );
    $(this).tooltip("open");
}); 
```

HTML

```
<a href="#" class="tooltip" data-description="That&apos;s what this widget is">Test</a> 
```

示例：http: [//jsfiddle.net/A44EB/123/](http://jsfiddle.net/A44EB/123/)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-01-06T15:14:39.187

更新 Mladen Adamovic 的答案有一个缺点。它只工作一次。然后工具提示被禁用。为了使每次代码都能正常工作，应通过单击启用工具提示来补充代码。

```
 $('#tt').on({
  "click": function() {
    $(this).tooltip({ items: "#tt", content: "Displaying on click"});
    $(this).tooltip("enable"); // this line added
    $(this).tooltip("open");
  },
  "mouseout": function() {      
     $(this).tooltip("disable");   
  }
}); 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2013-02-07T14:31:33.350

jsfiddle [http://jsfiddle.net/bh4ctmuj/225/](http://jsfiddle.net/bh4ctmuj/225/)

这可能会有所帮助。

```
<!-- HTML --> 
      <a href="#" title="Link Detail in Tooltip">Click me to see Tooltip</a>      
 <!-- Jquery code--> 

    $('a').tooltip({          
     disabled: true,
     close: function( event, ui ) { $(this).tooltip('disable'); }
    });

  $('a').on('click', function () {
     $(this).tooltip('enable').tooltip('open');
   }); 
```

# windows - 访问函数返回用户名，而不是用户名

> ID：14753464
> 
> 赞同：3
> 
> 时间：2013-02-07T14:28:42.210
> 
> 标签：windows, ms-access

有没有我可以用来将当前用户名返回到文本框的函数，而不是他们的用户名 - 所以 Joe Bloggs，而不是 jbloggs？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:14:37.267

假设您设置了 Active Directory，您可以使用以下代码，取自[Andrey Artemyev 的回答](http://social.msdn.microsoft.com/Forums/pl-PL/accessdev/thread/39b12404-7dc1-4b37-b7e6-7c2f6bd545fe)：

```
Public Function ADtest() As String
  Dim ADSI As Object, UN As Object
  Set ADSI = CreateObject("ADSystemInfo")
  Set UN = GetObject("LDAP://" & ADSI.UserName)
  ADtest = UN.FirstName
  ADtest = ADtest & " " & UN.LastName
  Set UN = Nothing
  Set ADSI = Nothing
End Function 
```

[（在此处添加答案以获得更好的可见性，制作社区 Wiki，因为它不是我的真正答案，我不想要功劳）]

# certificate - 生成证书时出错：系统找不到指定的文件。（来自 HRESULT 的异常：0x80070002）

> ID：14753467
> 
> 赞同：1
> 
> 时间：2013-02-07T14:28:54.243
> 
> 标签：certificate, native-methods

调用时：

```
Check(NativeMethods.CryptAcquireContextW(
                out providerContext,
                containerName,
                null,
                1, // PROV_RSA_FULL
                8)); // CRYPT_NEWKEYSET 
```

我明白了：

该系统找不到指定的文件。（来自 HRESULT 的异常：0x80070002）：堆栈跟踪：在 System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo) 在 System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(Int32 errorCode)

它似乎类似于这个 [http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/feaf03f7-51a8-48d6-825f-e04c4ff2ef3a](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/feaf03f7-51a8-48d6-825f-e04c4ff2ef3a)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-18T22:24:52.947

我从 Web 应用程序执行此操作时遇到了这个问题。对我来说，解决方案是将应用程序池标识从 ApplicationPoolIdentity 更改为 NetworkService（应用程序池的高级设置）。在 Windows 2008 Server R2 上运行 IIS7。

# php - PHP 为看似相同的输入提供不同的日期

> ID：14753470
> 
> 赞同：0
> 
> 时间：2013-02-07T14:29:02.870
> 
> 标签：php, date

PHP程序提取：

```
$currentDate = date("Y-m-d H:i");
echo $currentDate."<br/>";
echo "It is now " . date('l dS \o\f F Y h:i:s A', $currentDate)."<br />";
echo "It is now " .$currentDate."<br /><br />"; 
```

屏幕输出提取

```
2013-02-08 01:15
It is now Thursday 01st of January 1970 10:33:33 AM
It is now 2013-02-08 01:15 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:31:04.350

的第二个参数[`date()`](http://php.net/manual/en/function.date.php)应该是时间戳，而不是格式化字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:32:19.503

`Date`需要一个 unix 时间戳（整数）作为第二个参数。你喂了它一根绳子。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:31:28.990

`date`需要时间戳，而不是格式化的字符串。利用

```
$currentDate = time(); // returns a timestamp 
```

参考： http: [//php.net/date](http://php.net/date)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T14:32:44.223

`date()`假设第二个参数是一个 unix 时间戳。1.1.1970 是时间戳 0。它试图将您的字符串解释为数字。

请参阅[日期手册](http://php.net/manual/en/function.date.php)。

# android - 每当用户与屏幕交互时播放触摸声音

> ID：14753473
> 
> 赞同：0
> 
> 时间：2013-02-07T14:29:14.830
> 
> 标签：android, android-layout, android-intent, user-interface

每当用户触摸屏幕时，无论他们在哪个应用程序中，我都想在 android 中播放声音。就像让它成为 UI 触摸声音一样。这样我的应用程序就会在用户与屏幕交互时继续在后台运行并播放声音。我在哪里的代码？写什么？请帮忙。这是针对安卓的。我正在使用日食。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:36:19.403

这是不可能的。

Android 不允许您在自己的应用程序之外拦截屏幕上的触摸事件，因为这将允许恶意应用程序接管所有其他应用程序并使手机无用。

此外，它很快就会让用户感到烦恼，特别是如果他们正在玩游戏或需要发生大量触摸事件的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:33:12.727

恐怕这是不可能的。您只能在 Activity 中拦截触摸事件。已经问过类似的问题 [https://groups.google.com/forum/?fromgroups=#!topic/android-beginners/H45Xwm43NGQ](https://groups.google.com/forum/?fromgroups=#!topic/android-beginners/H45Xwm43NGQ)

# c# - ASP.NET Application_Error 重定向

> ID：14753474
> 
> 赞同：1
> 
> 时间：2013-02-07T14:29:17.423
> 
> 标签：c#, asp.net, redirect, maxrequestlength

我有一个 Web 应用程序，用户开始上传大文件。为了避免错误，我这样做了：

1- 设置 httpRuntime maxRequestLength。
2- 将 Global.asax 的 Application_Error 函数编辑为：

```
 Server.ClearError();
                Response.Redirect(Request.RawUrl, false);
                return; 
```

当我打开提琴手时，一切都很好，并且用户被重定向到同一页面。但是如果 fiddler 关闭，浏览器会显示：

错误 101 (net::ERR_CONNECTION_RESET)：连接已重置。

我究竟做错了什么？

# scala - sbt 在多项目构建中使用不同的 Scala 版本

> ID：14753475
> 
> 赞同：3
> 
> 时间：2013-02-07T14:29:17.810
> 
> 标签：scala, sbt, multi-project

我有一个使用两个版本的 Scala 的多项目。`Build.scala`看起来像这样：

```
import sbt._
import Keys._

object Build extends sbt.Build {
  lazy val root: Project = Project(
    id = "scalacolliderugens",
    base = file("."),
    aggregate = Seq(gen, core)
  )

  lazy val gen  = Project(...)
  lazy val core = Project(...)

  val ugenGenerator = TaskKey[Seq[File]]("ugen-generate", "Generate UGen class files")

  def runUGenGenerator(source: File, cp: Seq[File]): Seq[File] = Nil // TODO
} 
```

我有一个使用 Scala 2.9.2 的纯源代码生成项目：

```
 lazy val gen = Project(
    id = "scalacolliderugens-gen",
    base = file("gen"),
    settings = Project.defaultSettings ++ Seq(
      scalaVersion := "2.9.2",  // !!!
      libraryDependencies ++= Seq(
        "org.scala-refactoring" % "org.scala-refactoring_2.9.1" % "0.4.1"
      ),
      libraryDependencies <+= scalaVersion { sv =>
        "org.scala-lang" % "scala-compiler" % sv
      }
    )
  ) 
```

以及包含生成的源代码的实际项目，针对 Scala 2.10 进行编译：

```
 lazy val core = Project(
    id = "scalacolliderugens-core",
    base = file("core"),
    settings = Project.defaultSettings ++ Seq(
      scalaVersion := "2.10.0",  // !!!
      sourceGenerators in Compile <+= (ugenGenerator in Compile),
      ugenGenerator in Compile <<=
        (scalaSource in Compile, dependencyClasspath in Runtime in gen) map {
          (src, cp) => runUGenGenerator(src, cp.files)
        }
      )
    ).dependsOn(gen) 
```

当我编译这个时，我得到 sbt 警告：

```
[warn] Binary version (2.9.2) for dependency org.scala-lang#scala-library;2.9.2
[warn]  in de.sciss#scalacolliderugens_2.10;1.0.1 differs from Scala binary \
  version in project (2.10).
[info] Resolving org.scala-lang#scala-library;2.9.2 ...
[info] Done updating.
[warn] Binary version (2.9.2) for dependency org.scala-lang#scala-library;2.9.2
[warn]  in de.sciss#scalacolliderugens-gen_2.10;1.0.1 differs from Scala binary \
  version in project (2.10).
[warn] Binary version (2.9.2) for dependency org.scala-lang#scala-compiler;2.9.2
[warn]  in de.sciss#scalacolliderugens-gen_2.10;1.0.1 differs from Scala binary \
  version in project (2.10). 
```

我应该担心吗？我在这里做坏事吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T09:47:30.877

将以下设置添加到 gen 项目。

```
scalaBinaryVersion:= CrossVersion.binaryScalaVersion("2.9.2") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T16:03:24.310

好的...

我有多项目 SBT 项目，它们通常具有 SBT 设置，部分由所有人共享，部分特定于每个子项目。就我而言，常用设置包括要使用的 Scala 版本。

您可以以相同的方式构建您的构建规范，并将 Scala 版本设置放在子项目特定的设置中。如有必要，如果有一些设置对所有人通用，一些设置对子项目的子集通用，而其他设置特定于每个单独的子项目，则可以进一步对设置进行分层。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:56:34.607

您不能混合来自不同次要版本的 Scala 的字节码。即，任何 2.9.x 系列编译器编译的代码与 2.10.x（或 2.8.x）编译器发出的代码*不*兼容。

# javascript - JS for循环中的变量取最大值

> ID：14753476
> 
> 赞同：0
> 
> 时间：2013-02-07T14:29:17.787
> 
> 标签：javascript, for-loop

我编写了一个 Javascript for 循环来自动隐藏和单击我网站上的某些内容，但由于某种原因，该变量在循环结束时取最高值...

所以

```
for (var i = 1; i <= 5; i++) {
    $('.views-row-' + i + ' .faq_answer').hide();
    $('.views-row-' + i + ' .faq_more').click(function () {
        $('.views-row-' + i + ' .faq_answer').slideToggle();
    });
} 
```

所有`.views-row .faq_answer`元素都隐藏起来，并且`.views-row .faq_more`都有一个点击处理程序。
但是由于某种原因，该`slideToggle`行仅适用于带有类的行`views-row-6`（不存在）...

所以函数中的 i 变量并不适用于循环的所有值......
我怎样才能让它适用于所有`view-row-x`的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:32:58.110

您应该在点击回调中使用 $(this) 引用您的元素。在这里，i 将等于 i 的最后一个值。

```
 $('.views-row-'+ i + ' .faq_more').click(function(){
        $(this).slideToggle();
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:53:19.710

在 Javascript 中，变量具有函数级范围。解释器会将每个变量定义移动到函数的顶部（提升），以引用在该范围内随处可用的变量。因此，内部函数可以从外部函数（闭包）访问变量。对于习惯于块级作用域的每个人来说，这里的一个问题是，这种机制包括将循环计数器绑定到内部函数，这是内部函数比外部函数寿命更长的例子。

因此，在您的情况下，当回调被调用时，选择器将获得对您的循环计数器的***引用***`i`，其值为`6`，即绑定时绑定`i`不是 的值`i`。

因此，您只需将外部函数的变量的值传递给内部函数，而不是传递引用：

```
$('.views-row-'+ i + ' .faq_more').click(
    // pass value of i into the handler, not i itself
    function(i){
         // return the result of invoking the handler 
         // so that we can apply the current value of i to this result
         // and bind the whole closure as a handler to the click event
         return function(e) {
             $('.views-row-'+ i + ' .faq_answer').slideToggle();
         } 
    }(i) 
```

);

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:34:25.607

我认为您正在错误地解决问题。在一个循环中绑定大量事件处理程序并不是一个好主意。你最好做这样的事情：

```
$('.faq_answer').hide();

$('.faq_more').click(function(){
    $(this).parent().find('.faq_answer').slideToggle();
}); 
```

我假设您的 html 类似于：

```
<div class="views-row-1">
    <a href="#" class="faq_more"></a>
    <div class="faq_answer"></div>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T14:53:47.957

而不是变量`i`，最好找到另一种匹配元素的方法

```
for ( var i = 1 ; i <= 5; i++ ) {

    // faq_more elements have id 'more' + i
    // faq_more elements contain class faq_more
    // faq_answer elements have id 'answer' + i
    // faq_answer elements contain class faq_answer

    $( ".faq_more" ).hide();

    $( ".faq_more" ).click( function(){

        var id = $( this ).attr( "id" ).replace( "more", "answer" );
        $( "#" + id ).slideToggle();

    });
} 
```

# c# - 从服务器发送消息到客户端c#

> ID：14753478
> 
> 赞同：0
> 
> 时间：2013-02-07T14:29:22.863
> 
> 标签：c#, tcp, client-server, listener, messaging

我的客户端使用 tcp 协议向我的服务器发送消息（我的服务器有一个监听器）。我正在尝试将消息从服​​务器发送回客户端，但我不确定我需要向客户端添加什么才能获取这些消息。我尝试查找它，但我不明白如何实现它。

你能帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:31:43.453

这是完全相同的过程，但相反。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:34:46.787

如果您打算独立接收消息（即不响应客户端的请求），您也需要使客户端成为 TCP 服务器。客户端需要实现与您现在拥有的服务器完全相同的东西，并且服务器需要连接到客户端。

不能使用支持回调合约的 WCF 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:44:36.217

如果您想要使用网络库的客户端服务器应用程序的控制台示例，请参见此处[http://www.networkcomms.net/how-to-create-a-client-server-application-in-minutes/](http://www.networkcomms.net/how-to-create-a-client-server-application-in-minutes/)。

如果您想要 WPF 应用程序示例，请参见此处[http://www.networkcomms.net/creating-a-wpf-chat-c ​​lient-server-application/](http://www.networkcomms.net/creating-a-wpf-chat-client-server-application/)

# python - Python TypeError：不可散列的类型：'list'

> ID：14753481
> 
> 赞同：1
> 
> 时间：2013-02-07T14:29:30.477
> 
> 标签：python, list, set, typeerror

我正在尝试运行一个有效执行以下操作的程序：

`if [4, 5, False, False, False, False] in {}`

而且，在这条线上，我得到了一个`TypeError: unhashable type 'list'`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T14:30:53.940

代码`if foo in {}`检查字典的任何键是否等于`foo`。

在您的示例中，`foo`是一个列表。列表是不可散列的类型，不能作为字典的键。

如果要检查列表的*任何*条目是否包含在字典的键或集合中，可以尝试：

`if any([x in {} for x in (4, 5, False)])`.

如果您想检查您的任何值是否等于您的列表，您可以尝试：

`if any([v == [4, 5, False, False, False, False] for v in your_dict.values()])`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:37:19.697

A`set`包含可散列的对象，这意味着它们是可排序的，并且它支持高效的搜索/插入方法。另一方面， a`list`是不可散列的。这就是您的代码出错的原因。我建议使用`tuple`而不是`list`.

```
if (4, 5, False, False, False, False) in {}:
  ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:33:46.303

你可以做类似的事情

```
if all(x in {} for x in [4, 5, False, False, False, False]):
    .... 
```

或者

```
if any(x in {} for x in [4, 5, False, False, False, False]):
    .... 
```

取决于你想要什么

# java - 使用 Java api 的 Java 打印问题

> ID：14753485
> 
> 赞同：1
> 
> 时间：2013-02-07T14:29:46.453
> 
> 标签：java, printing

使用这个 java api：[http ://docs.oracle.com/javase/6/docs/api/javax/print/package-summary.html](http://docs.oracle.com/javase/6/docs/api/javax/print/package-summary.html)

我已尝试根据需要修改此代码，目前我有：

```
import java.io.FileInputStream;
import javax.print.Doc;
import javax.print.DocFlavor;
import javax.print.DocPrintJob;
import javax.print.PrintException;
import javax.print.PrintService;
import javax.print.PrintServiceLookup;
import javax.print.SimpleDoc;
import java.io.*;
import javax.print.*;
import javax.print.attribute.*;
import javax.print.attribute.standard.*;

 public class pdfPrinter {

    public static String CompletefileName; // calls from FileUploadController

    public static void main(String args[]) {

        FileInputStream psStream = null;
        try {
            psStream = new FileInputStream(CompletefileName); // this calls a location where the pdf file is stored
        } catch (FileNotFoundException ffne) {
            ffne.printStackTrace();
        }
        if (psStream == null) {
            return;
        }
        DocFlavor psInFormat = DocFlavor.INPUT_STREAM.AUTOSENSE;
        Doc myDoc = new SimpleDoc(psStream, psInFormat, null); // unsure what psStream is, not explained in the api, want to use this to print pdfs, will look at more 
        PrintRequestAttributeSet aset = new HashPrintRequestAttributeSet();
        PrintService[] services = PrintServiceLookup.lookupPrintServices(psInFormat, aset);
        aset.add(new Copies(5)); //sets copies, will add this as a vairable so users can change this
        aset.add(Sides.DUPLEX); // same as above
        if (myPrinter != null) { // having issues setting myPrinter
            DocPrintJob job = myPrinter.createPrintJob();
            try {
                job.print(myDoc, aset);

            } catch (Exception pe) {
                pe.printStackTrace();
            }
        } else {
            System.out.println("no printer services found"); //error msg
        }
    }
} 
```

目前这无法编译，因为我不知道如何`myPrinter`在我的机器上设置默认打印机，这也将用于 jsf Web 应用程序，我可以通过在网页上按一下按钮来运行它吗？

这是打印pdf的正确方法吗？任何建议或教程都会非常有帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:51:52.203

我查看了javadoc `DocPrintJob`，这是一个接口。所以`myprinter`必须是一个实现该接口的对象。

从那里看来您可以附加打印机：[http ://docs.oracle.com/javase/6/docs/api/javax/print/DocPrintJob.html](http://docs.oracle.com/javase/6/docs/api/javax/print/DocPrintJob.html)

这可能会有所帮助，因为它提供了一个示例： [http ://docs.oracle.com/javase/6/docs/technotes/guides/jps/spec/jpsOverview.fm4.html](http://docs.oracle.com/javase/6/docs/technotes/guides/jps/spec/jpsOverview.fm4.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-18T07:18:13.353

你应该定义为

```
PrintService[] services = PrintServiceLookup.lookupPrintServices(flavor, null);
PrintService myService = null;
for(PrintService service : services) {
    System.out.println(service.getName());
    if(service.getName().contains(user.getDefaultPrinter())) {
        myService = service;
        break;
    }
} 
```

# jquery - Jquery下拉列表向左应用空间

> ID：14753488
> 
> 赞同：0
> 
> 时间：2013-02-07T14:29:54.487
> 
> 标签：jquery, ajax

再会

我有一个带有列表选项的动态填充下拉列表。问题是当我从列表中选择和选项时，它会在文本左侧应用间距 ( )，就像它出现在树结构中一样

现在该列表以树形结构设置样式，并从服务器上的另一个位置调用。我不能改变间距。（因为 t 形成树形结构效果）

看看我下面的代码：

HTML

```
<select id="AreaTreeSelect" data-bind="value: RiskAssessment.AreaId"></select> 
```

jQuery

```
 $.ajax({
                    url: "API/DataHandler.ashx?method=getareatree",
                    contentType: "application/json; charset=utf-8",
                    success: function (result) {
                        for (var i in result) {
                            var obj = result[i];

                            $("#AreaTreeSelect").append("<option value=\"" + obj.Id + "\">" + obj.Name + "</option>");

                        }
                    }
                }); 
```

这是它在浏览器中的填充方式：

```
<select id="AreaTreeSelect" data-bind="value: RiskAssessment.AreaId">
<option value="156">Ferrometals</option>
<option value="158">&nbsp;&nbsp;Admin &amp; Finance</option>
<option value="169">&nbsp;&nbsp;&nbsp;&nbsp;Warehousing</option>
<option value="170">&nbsp;&nbsp;&nbsp;&nbsp;Procurement</option>
<option value="171">&nbsp;&nbsp;&nbsp;&nbsp;Acounting</option>
<option value="855">&nbsp;&nbsp;&nbsp;&nbsp;Information Technology</option>
<option value="159">&nbsp;&nbsp;HR</option>
</select> 
```

ETC...

选择在选择框中显示**选项**时如何删除空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:38:32.707

像这样尝试它修剪空间......

```
$("#AreaTreeSelect").append("<option value=\"" + obj.Id + "\">" + $.trim(obj.Name) + "</option>"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:39:57.590

也许这值得一试：

```
$('#AreaTreeSelect').change(function(){
    $(this).find('option.trimmed').each(function(){
        var padding = '';
        for(var i=0; i<$(this).data('numSpaces'); i++){
            padding += String.fromCharCode(160);
        }
        $(this).text(padding + $(this).text());
    })
    .removeClass('trimmed');
    var selOpt = $(this).find('option:selected');
    var numSpaces = selOpt.text().replace(/^(\s*).*/, '$1').length;
    selOpt
        .data('numSpaces', numSpaces)
        .text(selOpt.text().replace(/^\s*/g, ''))
        .addClass('trimmed');
}); 
```

这个想法是它删除了所有   从当前选择的选项，但记住有多少填充，并在选择另一个选项时恢复填充。

显然，您可以存储   的实际序列。而不是它们的数量，并摆脱几行代码。

在这里查看工作小提琴：http: [//jsfiddle.net/aKGac/1/](http://jsfiddle.net/aKGac/1/)

此解决方案的明显缺点是当前选择的选项在展开时将出现在列表中而没有任何缩进：

![所选选项没有缩进](../Images/9ee209769e1dfaaee919d8be59069c7c.png)

# linux - 为什么是 `ls -al & ; ls -al` 无效？

> ID：14753491
> 
> 赞同：10
> 
> 时间：2013-02-07T14:29:57.520
> 
> 标签：linux, bash

我在我的 Centos5 机器上运行了这个：

```
ls -al & ; ls -al 
```

我期待它`ls -al`在后台运行，并`ls -al`在前台同时运行，并演示如何通过这样做来破坏终端的输出。

但是，我得到：

> -bash：意外标记';'附近的语法错误

如何将这两个命令写在同一行？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-07T14:29:57.520

不直观地，`&`是命令分隔符和分叉器。这意味着您实际上有*三个*命令：

```
 ls -al & ; ls -al
# ^^^^^^^|^|^^^^^^^ 
```

...而且 Bash 不支持空语句。

相反，只需编写：

```
 ls -al & ls -al 
```

没有分号。

# c++ - 模板类中定义的类型“未命名类型”

> ID：14753499
> 
> 赞同：0
> 
> 时间：2013-02-07T14:30:09.317
> 
> 标签：c++, templates

几周前我开始使用模板，但我在使用它时遇到了麻烦。我收到了这个错误：

Freestyle/_gl/../_convection_selective/Definitions.h:153:9: 错误: '<strong>Node_handle' in **'Point_set** {aka struct Kd_tree_patch > >*, My_point_property_map, CGAL::Search_traits > >, const double*, Construct_coord_iterator > > >}'**没有命名类型**

在编译此代码时：

**“定义.h”：**

```
#include "Kd_tree_patch.h"
[...]
template <class SearchTraits, class Splitter_= CGAL::Sliding_midpoint<SearchTraits>, class UseExtendedNode = CGAL::Tag_true > class Kd_tree_patch;  //forward declaration

typedef Kd_tree_patch<Search_traits> Point_set;    
typedef Point_set::Node_handle Node_handle; 
```

**“Kd_tree_patch.h”**：

```
template <class SearchTraits, class Splitter_=Sliding_midpoint<SearchTraits>, class UseExtendedNode = Tag_true >
class Kd_tree_patch {
[...]
typedef Kd_tree_node<SearchTraits, Splitter, UseExtendedNode > Node;
typedef typename Compact_container<Node>::iterator Node_handle;
}; 
```

为什么 Node_handle 还没有被视为一种类型？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:45:22.537

您不能转发声明嵌套类型，这意味着要能够使用嵌套类型`Node_handle`，模板`Kd_tree_patch`必须在 typedef*之前定义。*一旦你解决了这个问题，你还需要通过使用来指示编译器它是一种类型`typename`：

```
typedef typename Point_set::Node_handle Node_handle;
//      ^^^^^^^^ 
```

# c - C/C++：printf 使用逗号而不是点作为小数分隔符

> ID：14753505
> 
> 赞同：7
> 
> 时间：2013-02-07T14:30:30.797
> 
> 标签：c, decimal, printf

我需要我的程序使用逗号作为小数分隔符显示输出。

根据这个链接：[http](http://www.java2s.com/Code/Java/Development-Class/Floatingpointwithcommasf.htm) ://www.java2s.com/Code/Java/Development-Class/Floatingpointwithcommasf.htm你可以在Java中使用这样的东西：

```
System.out.printf("Floating-point with commas: %,f\n", 1234567.123); 
```

是否有一个标志或其他东西可以用来在 C 中具有类似的行为？

提前致谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-07T14:40:49.137

如果需要，您可以在程序开始时设置当前语言环境：

```
#include <stdio.h>
#include <locale.h>

int main()
{
    setlocale(LC_NUMERIC, "French_Canada.1252"); // ".OCP" if you want to use system settings
    printf("%f\n", 3.14543);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T14:32:52.563

中没有类似的功能`C`。您可以使用`sprintf`打印到 char 数组中，然后手动将点替换为逗号。我想不出更好的解决方案，抱歉。

编辑：感谢 Mats Patersson 的评论：似乎设置语言环境可以改变这个字符。请看一下他发布的链接。

# xcode - xcode 中用于在项目导航器、主文件等之间切换的快捷方式

> ID：14753506
> 
> 赞同：3
> 
> 时间：2013-02-07T14:30:31.050
> 
> 标签：xcode, keyboard-shortcuts

是否有任何键盘快捷键可以切换到项目导航器，选择一个文件然后编辑该文件？我使用快捷方式在选项卡等之间切换，我发现使用鼠标在项目导航器中选择一个新文件然后再次单击主区域开始编辑它很麻烦。谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-07T15:13:11.417

我希望我明白你在问什么：

> **命令**-**选项**- **〜**（*波浪号*）

这将浏览您在 Xcode 中打开的区域。如果您只打开项目视图和编辑器，这应该在两者之间反弹。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-23T14:34:24.673

您需要做的就是：^~（Command + 波浪号）

# snmp - 使用 SNMP 进行流量监控

> ID：14753509
> 
> 赞同：1
> 
> 时间：2013-02-07T14:30:32.227
> 
> 标签：snmp, openwrt

我正在尝试使用 Open-Wrt 路由器（WRT54GL）获取 Wan 接口的带宽值

```
OID: 1.3.6.1.2.1.2.2.1.10.4 
```

但我一直在 4174517174 附近获得价值

我正在做一些计算，但这没有任何意义：

4174517174 / 8 / 1024 /1024 = 497 MB/s

该值是否包含更多信息，例如时间或其他信息，或者我的 OID 不正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:45:47.020

我得到了答案。将经过的全部流量投向该接口。要获得带宽，您需要获得两个过去值之间的差异......

# asp.net - 从 Telerik RadGrid 导出

> ID：14753513
> 
> 赞同：0
> 
> 时间：2013-02-07T14:30:36.767
> 
> 标签：asp.net, telerik, export, telerik-grid, radgrid

RadGrid 可以将其数据导出到 csv，但默认实现不适合大型表的条款，因为它会在内存中生成结果导出文件，当您获得 5000k 条记录时该文件不起作用。

我将 RadGrid 与 LinqDataSource 一起使用，我的表包含数百万条记录。我正在考虑如何实现更智能的导出。我已经有任务子系统在线程等中运行进程，所以我真正需要的是使用过滤器、排序但没有页面限制来获取当前的 RadGrid 查询。我会将这个查询放入我的服务中，该服务将“运行”它并将逐条记录读取到文件中。

有谁知道如何从 RadGrid 获取当前查询、表达式或任何有助于执行相同查询和读取数据的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T20:18:58.580

似乎唯一的解决方案是限制导出记录的数量：

[Radgrid 导出大型数据集](http://www.telerik.com/community/forums/aspnet-ajax/grid/radgrid-exporting-large-dataset.aspx)

# javascript - 如何在javascript中定义html类？

> ID：14753522
> 
> 赞同：-1
> 
> 时间：2013-02-07T14:31:12.843
> 
> 标签：javascript, html, css

我有带有类的 serval div，我想在 javascript 中定义它们。这是我的 jsfiddle 脚本，它现在只使用 DIV ID，但它必须是类，因为我想添加多个块。有人可以帮忙吗？

```
var block = document.getElementById('block');
var minimizewindow = document.getElementById('minimizewindow');

block.style.height = "250px";
minimizewindow.style.display = "none";  

//function minimize
minimize.onclick = function(){
    if(block.style.height == "250px") {
        block.style.display = "none";
}   ......... 
```

[http://jsfiddle.net/uVSyX/](http://jsfiddle.net/uVSyX/)

单击损坏的图像：最小化、最大化、关闭

谢谢！

编辑：认为我不明白，我不想显示和隐藏多个 div ......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:38:38.903

`document.getElementsByClassName('myClass');`是最简单的方法，但是 IE 不支持。 [Mozilla 对此有很好的文档](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByClassName)。

如果您需要 IE 支持，此页面可能是一个很好的资源：[http ://robertnyman.com/2008/05/27/the-ultimate-getelementsbyclassname-anno-2008/](http://robertnyman.com/2008/05/27/the-ultimate-getelementsbyclassname-anno-2008/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:39:07.137

> 我想在javascript中定义它们。

这是一个坏主意。样式说明属于 CSS 样式表。

去这里的正确方法是上课，比如`.expanded`和`.contracted`

它们将包含如下规则

```
.expanded { width: 800px; display: block } 
```

然后，您只需更改`class`JavaScript 中的属性。jQuery 使这变得*非常*容易，因为它具有处理类的便捷方法。

*   [http://api.jquery.com/hasClass/](http://api.jquery.com/hasClass/)
*   [http://api.jquery.com/addClass/](http://api.jquery.com/addClass/)
*   [http://api.jquery.com/toggleClass/](http://api.jquery.com/toggleClass/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:38:20.507

我不记得我在哪里找到了这个函数，但它是我用来根据类查找元素的。

```
var elems = document.getElementsByTagName('div'),i;
for (i in elems) {
  if((" "+elems[i].className+" ").indexOf(" "+matchClass+" ") > -1) {
    elems[i].style.display = "none";
  }
} 
```

是`matchClass`您要查找的课程的名称。

* * *

我更新了上面的代码以使用定义为在函数运行时设置`div`的特定类来设置所有内容。`matchClass``display:none`

# php - 优化 foreach 语句

> ID：14753527
> 
> 赞同：0
> 
> 时间：2013-02-07T14:31:18.150
> 
> 标签：php, foreach

这是我的代码：

```
<?php foreach ($classes as $str) foreach ($str as $class): ?>
...
<?php endforeach ?> 
```

`$str`只有一个带有随机字符串索引的字符串值。

可以优化第一个语句以将其减少到一个 foreach 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:33:59.553

您可以展平您的`classes`阵列，但它不会给您带来任何性能优势，因为在内部，阵列的展平无论如何都会迭代整个阵列。

简短的回答是：不 - 如果不改变`$classes`数组的构造方式（如果可能的话），就无法优化它 - 假设您需要访问数组的所有 2 级子级`$classes`。

**编辑**：如果您的`$str`子数组只有一个具有随机数组索引的随机子数组，您可以使用`current($str)`- 它可能**证明**比`foreach`

# r - R 双环选择输出

> ID：14753534
> 
> 赞同：1
> 
> 时间：2013-02-07T14:31:37.183
> 
> 标签：r, loops, double

我想我有一个非常简单易懂的问题，但我自己无法提出解决方案。

我有一个包含 10 个元素的向量，我想得到一个新向量，它由第一个元素减去第二个元素、第一个元素减去第三个元素组成，依此类推。但是，在同一个向量中，我还希望第二个元素减去第三个，第二个元素减去第四个等的数字，以及其他元素的数字。

在我看来，我需要两个 for 循环来执行此操作，但是在运行以下脚本之后，我得到了太多元素：

```
for (w in 1:test1){  
  for (u in 1:test1) {
     print(mean[[u]] - mean[[w]])  }} 
```

现在我使用了打印命令，但我想将结果分配给一个向量。

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:38:10.090

```
ttt <- (1:5)^3
#[1]   1   8  27  64 125

result <- outer(ttt,ttt,"-")
#     [,1] [,2] [,3] [,4] [,5]
#[1,]    0   -7  -26  -63 -124
#[2,]    7    0  -19  -56 -117
#[3,]   26   19    0  -37  -98
#[4,]   63   56   37    0  -61
#[5,]  124  117   98   61    0 
```

现在选择您需要的元素（我从问题中并不完全清楚）。

也许你想要这个：

```
t(result)[lower.tri(t(result))]
[1]   -7  -26  -63 -124  -19  -56 -117  -37  -98  -61 
```

# javascript - 使用数组元素分配“id=”值返回：TypeError: document.getElementById(...) is null

> ID：14753536
> 
> 赞同：0
> 
> 时间：2013-02-07T14:31:41.097
> 
> 标签：javascript

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:38:56.793

First, let's look at this line:

```
outputs[index] = (outputs[index] * 13) / 100; 
```

What do you expect to happend here? Say index equals 0\. outputs[0] == 'output1'. Your assignment is doing this (meta):

```
outputs[0] = ('output1' * 13) / 100; 
```

You should revise this statement. As to your error, this should work for you:

```
document.getElementById(spans[index]).innerHtml = outputs[index]; 
```

EDIT: There are a lot of problems with your code. You need to fix your HTML (self-closed td and tr tags) and your JavaScript code (outputs values and innerHTML). Please see working example here: [http://jsfiddle.net/pkRmC/2/](http://jsfiddle.net/pkRmC/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:39:54.793

Use `document.getElementById(spans[index])` if you don't want to select the (nonexisting) element with the literal id "`'spans[index]'`".

Btw, all your opening tags do incorrectly end with `/>`, while it should be just `>`. Not sure how you did not get a big HTML parse error from that. The `/>` syntax is only permitted for self-closing elements such as `hr`, `br`, `meta` etc, and actually is only necessary in XHTML.

Also, your computation of `outputs[index] * 13) / 100` does not make too much sense, since you are multiplying a string with the number `13` - which will result in `NaN`. Not sure what you wanted to achieve with that.

# html - IE背景图片不显示

> ID：14753538
> 
> 赞同：0
> 
> 时间：2013-02-07T14:31:43.773
> 
> 标签：html, css, background

有一个小问题，即在任何 IE 版本中都没有显示背景图像（我相信 IE 9 除外），不知道出了什么问题，我可以尝试任何帮助/想法/事情吗？

亲切的问候

[http://www.trucknetuk.com/phpBB/viewforum.php?f=46](http://www.trucknetuk.com/phpBB/viewforum.php?f=46) 这是新主题按钮上方的米其林横幅（不是小赞助商）

背景： url("./styles/Owner_Fleet_Operator_MS/theme/images/michelinback.gif") 重复-x 滚动中心 0 透明；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:53:37.383

改变这个：

```
background: url('./styles/Owner_Fleet_Operator_MS/theme/images/michelinback.gif')repeat-x scroll center 0 transparent; 
```

对此：

```
background: url('./styles/Owner_Fleet_Operator_MS/theme/images/michelinback.gif') repeat-x scroll center 0 transparent; 
```

不同之处在于右括号之后和“repeat-x”之前的空格。IE 在语法方面比其他浏览器更挑剔。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:56:55.803

你的背景速记错误，`transparent`需要先来

```
#page-body {
    background: transparent url("./styles/Owner_Fleet_Operator_MS/theme/images/michelinback.gif") repeat-x center 0;
    clear: both;
    padding: 4px 5px;
} 
```

正确的速记是：`body {background:#ffffff url('img_tree.png') no-repeat right top;}`

不确定您要对`scroll`声明做什么

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-02T08:24:48.827

```
.button{
      background: transparent url('../images/backrgound.jpg') no-repeat top center;
} 
```

**CSS 标准**

背景：*颜色 URL 重复部分和位置*

**JPEG 图像**

检查图像是否为JPEG2000，如果是，则打开任何图像编辑器并使用正确的jpeg扩展名再次保存

# reflection - 引用的程序集，以前未签名，现在已签名，无法由应用程序加载

> ID：14753542
> 
> 赞同：2
> 
> 时间：2013-02-07T14:32:05.240
> 
> 标签：reflection, dll, .net-assembly, assembly-resolution

在对引用的程序集 (MyAssembly.dll) 进行签名和重新编译后，我的 Web 应用程序失败并显示“名称为 MyReferencedAssembly 的已定位程序集的清单定义与程序集引用不匹配”。

这是我所期望的，因为 PublicKeyToken 已从 null 更改为新密钥。

看来您应该能够使用 web.config 文件中的 assemblyBinding 部分来使应用程序使用新的签名程序集。

问题是，似乎没有办法识别应用程序将在 assemblyIdentity 元素中寻找的程序集（旧的、未签名的程序集）。

由于旧的 publicKeyToken 值为 null，我尝试将其排除在外，尝试将其设置为空字符串，在引号中为 null，但它们似乎都不起作用。

我尝试更改版本号，以便可以使用从旧版本到新版本的绑定重定向，还尝试为程序集设置特定的代码库。

所有这一切都失败了，所以我不得不相信程序集加载过程只是不喜欢在引用/预期未签名的程序集时加载签名的程序集。

如何执行此映射？

重新编译引用签名程序集的整个代码库不是一种选择。

感谢您的任何建议。

# c# - 如何获取或设置自定义对象作为数据上下文实例到 wpf 中的自定义控件

> ID：14753548
> 
> 赞同：0
> 
> 时间：2013-02-07T14:32:21.043
> 
> 标签：c#, wpf, xaml

我创建了一个自定义控件，该控件在其自己的 XAML 表中进行样式设置和配置。此控件中的数据绑定使用特定对象（CProject 类）。

澄清一下，该控件是一个项目框架，具有设置控件和一个画布，该画布将成为每个/任何项目的工作区。

项目控件 (IPProjectPanel) 继承了“Frame”，并将“设置”堆栈面板添加到其子列表中，该列表又包含用于设置的控件。

然而，CProject 类是纯功能部分，没有任何 UI 交互或处理。因此，我需要将 CProject 的一个实例“插入”到每个可以激活的独特项目中。因此，我想将 CProject 的特定实例设置为 tabpanel 中每个 IPProjectPanel 实例的数据上下文。我想通过代码设置数据上下文，或者通过 XAML 中的设置数据上下文创建它，并在初始化后检索它。

不过，问题是我也无法弄清楚。

这是 XAML 中 IPProjectPanel 样式的片段，它使用在 XAML 中设置数据上下文的方法：

```
 <Style TargetType="{x:Type ip:IPProjectGrid}">
    <Setter Property="OverridesDefaultStyle"
        Value="True" />
    <Setter Property="SnapsToDevicePixels"
        Value="True" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ip:IPProjectGrid}">
                <Grid Background="White"  
                      HorizontalAlignment="Stretch" 
                      VerticalAlignment="Stretch" 
                      Margin="0">
                    <!---->
                    <Grid.DataContext>
                        <ipp:CProject></ipp:CProject>
                    </Grid.DataContext>

                    <StackPanel x:Name="PART_settingsPanel" 
                                HorizontalAlignment="Right" 
                                VerticalAlignment="Stretch"
                                MinWidth="300" Background="Gray">

                        <GroupBox Header="Project settings">
                            <StackPanel>

  ....

  </style> 
```

在这里，它被设置为 Grid 的上下文，但我想将它作为实际类（IPProjectPanel）的上下文。

因此，IPProjectPanel 实例是由代码创建的（现在..），我需要检索 CProject 实例（或设置一个）以便我可以使用它。

我想保持 C#/WPF 做事的方式，因为这个应用程序也在训练 WPF 和 C# 概念等。所以“最好的 C#-WPF”方法是非常受欢迎的，但无论哪种方式都是一种解决方案！

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:37:01.027

所以一般来说，datacontext 主要用于您的 ViewModel，实际上 WPF 确实是为执行 MVVM（模型视图 ViewModel）样式应用程序而设置的。它实际上很容易学习，但是如果您正在寻找“最佳 C#-WPF”的做事方式，请花时间学习 MVVM。这真的很简单。

来自 CodeProject 的简单示例：

[http://www.codeproject.com/Articles/165368/WPF-MVVM-Quick-Start-Tutorial](http://www.codeproject.com/Articles/165368/WPF-MVVM-Quick-Start-Tutorial)

来自微软（有点重读）：

[http://msdn.microsoft.com/en-us/library/gg405484(v=pandp.40).aspx](http://msdn.microsoft.com/en-us/library/gg405484(v=pandp.40).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:27:57.267

您当前进行此设置的方式可能会产生一些令人讨厌的错误。你永远不应该`DataContext`在模板内声明一个对象实例，除非你从不打算在模板范围之外访问它。通过这样做，您将在`CProject`任何时候需要在视觉上重新加载控件（例如更改选项卡）时创建该类的新实例，并且您最终可能会`CProject`在代码中引用旧实例，同时在屏幕上显示一个完全独立的实例。声明`DataContext`不在模板中的对象（即`Window.DataContext`）很好。

如果您希望每个控件实例创建自己的`CProject`实例，最好在构造函数中的代码中执行此操作，并将其作为控件上的属性公开，然后您可以将其绑定`Grid.DataContext`到模板内。避免将其设置为`DataContext`控件本身的属性，因为这将导致在 XAML 中声明的控件上设置的任何隐式源绑定通过覆盖继承的来中断`DataContext`：

```
Grid.DataContext="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=PropertyWithCProject}" 
```

您可能更可能希望从`CProject`外部控制实例并将它们交给控制实例。为此，您可以在容器 ViewModel 类（MVVM 模式）中创建它们，并将其设置为`DataContext`包含所有自定义控件的更高级别的内容。然后，您可以公开单个`CProjects`或一组它们并将您的控件绑定`DataContexts`到这些。

# testing - 在 Jenkins 中解析和显示测试结果的最简单插件

> ID：14753550
> 
> 赞同：5
> 
> 时间：2013-02-07T14:32:24.920
> 
> 标签：testing, jenkins, jenkins-plugins

我已经开始使用 Jenkins 来定期编译和测试我的构建。这项工作相当简单。它编译构建，然后执行测试。

测试结果存储在文件中。还有一条明显的线表示通过了多少次测试。（类似于*X 测试通过了 Y*）。

我想知道在构建结束时显示这些结果的最简单方法/插件是什么。

我想要一个视觉显示，因为我知道詹金斯在显示时间/工作图表方面非常好。

感谢您的帮助，如果 Stackoverflow 上已经存在这个问题，请原谅我。我还没有找到任何对我来说足够接近的东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-08T09:43:40.637

如果您能以 Jenkins 更易于理解的格式发布您的测试结果不是更好吗？如果是这样，请参阅此[链接](https://stackoverflow.com/questions/4922867/junit-xml-format-specification-that-hudson-supports)以了解如何生成简单的测试结果。完成此操作后，Jenkins 提供的视觉显示将免费提供给您。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-07T16:16:32.443

您可以安装[Groovy Postbuild Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Groovy+Postbuild+Plugin)并使用它来解析您的*不同行*并将其显示在您的构建结果旁边：

```
def matcher = manager.getLogMatcher("(.*)  tests passed out of (.*)\$")
if(matcher != null && matcher.matches()) {
    passedTests = matcher.group(1)
    totalTests = matcher.group(2)
    manager.addShortText("${passedTests} / ${totalTests}")
} 
```

您还可以根据成功率使用徽章或自定义颜色来增强它。

希望能帮助到你

# java - 列表 到 Json 字符串

> ID：14753551
> 
> 赞同：3
> 
> 时间：2013-02-07T14:32:27.567
> 
> 标签：java, json

如何将列表转换为 Json 字符串？

我设法以相反的方式做到这一点，但不是这样。

我也不知道如何指定键的名称然后..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:33:37.727

您可以使用[Gson 库](http://code.google.com/p/google-gson/)。

```
List<String> list;
String json = new Gson().toJson(list); 
```

**编辑**：

只是为了在这里获得完整的答案：问题是您正在将 json String 转换为`List<String>`. 这样你就失去了关系键值。正确的应该是将 json 字符串转换为`HashMap<>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:54:37.707

似乎您真正的问题是，当您最初将 JSON 字符串转换为 a`List`时，您丢弃了密钥。这并不奇怪，List 不是 JSON 对象的自然表示（即具有键值对的事物）。您可能应该将其表示为`Map`.

但无论如何，如果你把钥匙扔掉，你就会遇到问题。您需要更改数据结构以不丢弃键，或者通过推断键*应该*基于（例如）它们在列表中的位置来重建 JSON。（后者可能有点狡猾，因为原始 JSON 中名称/值对的顺序不应该表示任何东西......并且可能是“随机的”或“依赖于实现的”。

# jquery - jquery ui 可排序列表 - 完整：反应

> ID：14753557
> 
> 赞同：0
> 
> 时间：2013-02-07T14:32:46.693
> 
> 标签：jquery, list, user-interface, jquery-ui-sortable

我想阻止连接的 jquery-ui 可排序列表接受不超过给定数量的项目。

我走了这么远：http: [//jsfiddle.net/9yzea/6/](http://jsfiddle.net/9yzea/6/)

在第 66 行添加什么以防止“#playlist”对悬停在其上方的新项目做出反应？我希望它对“完整”的特殊行为做出反应。还是有更好的方法？

谢谢

```
$(function() {   $( "#playlist" ).sortable({
    cursor: "move",
    handle: ".handle",
    revert: 100,
    opacity: 0.8,
    delay: 50,
    placeholder: "sortable-placeholder",
    stop: function(event, ui) {
        var size = $("#playlist li.track").size();
        $("#music").append(size+" ");
        sizeCheck();
        if (playlistFull) {
            $("#music").append("full ");
            } else { 
            $("#music").append("space ");
            };
        playlistWatcher();
        },
    start: function(event, ui) {
        if (playlistFull) {
            // $(ui.item).sortable('cancel');  // What to do here?
            };
        },
    }).disableSelection();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T16:35:00.690

**编辑**

您可以像这样删除项目`stop:`：

```
 stop: function(event, ui) {
        if (playlistFull) 
           ui.item.remove();
        var size = $("#playlist li.track").size();
        $("#music").append(size+" ");
        sizeCheck();
        if (playlistFull) {
            $("#music").append("full ");
            } else { 
            $("#music").append("space ");
            };
        playlistWatcher();
        },
    start: function(event, ui){
        if (playlistFull){                       
            $(ui.sender).draggable('cancel');
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T06:21:39.990

你现在最好的选择是在 sortable 满后禁用它。

```
function playlistWatcher() {
    // $("#music #playlist li a.addrem").html("remove");
    // $("#music #tracks li a.addrem").html("add to playlist");
    if (playlistFull) {
        $("#alert").show();
         $( "#playlist" ).sortable("disable");
        //$( "#tracks li" ).draggable("option", "connectToSortable", null );
    } else {
        $("#alert").hide();
        }; 
    }; 
```

更新[的小提琴](http://jsfiddle.net/9yzea/7/)

我正在尝试更多更好的解决方案，并在找到时通知您。

# sql - 两个表上的两个关系

> ID：14753562
> 
> 赞同：-1
> 
> 时间：2013-02-07T14:32:53.137
> 
> 标签：sql, android-activity, process, double, relation

我尝试在图表中的 sql server 管理中完成的数据库设计有问题。

我有一个进程表和一个活动表。

一个流程可以调用多个活动，但是一个活动一次只能由一个流程调用（一对多关系）。然而，在我的第二种情况下，一个活动也可以一次调用一个进程，因此一个进程只能由一个活动调用。（一对一关系）

围绕该主体设计这些表格并跟踪谁打电话给谁的最佳方式是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:47:26.647

回答

> 追踪谁打电话给谁

在我看来，您需要第三张表来记录调用，包括调用的活动/进程的 ID、进行调用的活动/进程的 ID、开始时间、完成时间等。

另外，强制执行

> **一个活动一次**只能被一个进程调用

 **和

> 一个活动也可以一次调用一个**进程**

可以通过向活动表中添加字段来完成，称为call_by_processID 和calling_processID，它们需要在调用开始时更新并在调用结束时清空。

或者，将该功能保留在日志表中，并且仅在相应的先前调用完成时才允许该活动/流程调用。稍微复杂的逻辑，但更好的规范化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:36:31.633

只需将 activityID 添加到流程，将 ProcessID 添加到活动，这样您就拥有了您所描述的 2 个关系 1 - M

也许称他们为 CalledByProcessID (activity) 和 CalledByActivityID (process**

# python - 将静态 PHP 网站移植到 Google App Engine

> ID：14753563
> 
> 赞同：0
> 
> 时间：2013-02-07T14:32:54.293
> 
> 标签：python, google-app-engine

我正在尝试使用 webapp2 和 jinja2 将用 PHP 完成的静态站点移植到 Google App Engine。
我的 PHP 的 index.php 看起来像这样：

```
<body>
<div id="container">
    <header id="header"><?php require_once DIR_HTML."header.phtml" ?></header>
    <section id="main"><?php require_once DIR_HTML.$_GET['page'].".phtml" ?></section>
    <footer id="footer"><?php require_once DIR_HTML."footer.phtml" ?></footer>
</div>
</body> 
```

在我的 google-app-engine 代码中，我有这个：

```
import webapp2, jinja2, os

jinja_environment = jinja2.Environment(loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

class MainPage(webapp2.RequestHandler):
    def get(self):
        template_values = {
        }

        template = jinja_environment.get_template('index.html')
        self.response.out.write(template.render(template_values))

class AboutPage(webapp2.RequestHandler):
    def get(self):
        template_values = {
        }

        template = jinja_environment.get_template('templates/about.html')
        self.response.out.write(template.render(template_values))        

app = webapp2.WSGIApplication([('/', MainPage), ('/about', AboutPage)], debug=True) 
```

如何在 Python 中复制相同类型的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:19:38.953

[模板继承](http://jinja.pocoo.org/docs/templates/)

> Jinja 最强大的部分是模板继承。模板继承允许您构建一个基本“骨架”模板，该模板包含您网站的所有常见元素并定义子模板可以覆盖的块。

```
<!DOCTYPE html>
<html lang="en">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    {% block head %}
        <link rel="stylesheet" href="style.css" />
        <title>{% block title %}{% endblock %} - My Webpage</title>
    {% endblock %}
</head>
<body>
    <div id="content">{% block content %}{% endblock %}</div>
    <div id="footer">
        {% block footer %}
            &copy; Copyright 2008 by <a href="http://domain.invalid/">you</a>.
        {% endblock %}
    </div>
</body> 
```

# django - 单独的管理员访问不同的 django 管理站点

> ID：14753566
> 
> 赞同：1
> 
> 时间：2013-02-07T14:33:10.847
> 
> 标签：django, django-admin

假设有一个带有多个管理站点的 Django 应用程序。每个都是供不同的人使用的。

如果用户被标记为“is_staff”，则默认情况下他可以访问所有管理站点。

问题是：如何禁止一个 AdminSite 的管理员访问另一个 AdminSite？

# mysql - 如何配置 tomcat 以在 OpenShift 中与 mysql 一起使用？

> ID：14753568
> 
> 赞同：0
> 
> 时间：2013-02-07T14:33:15.520
> 
> 标签：mysql, variables, tomcat, servlets, openshift

我刚刚发现了 OpenShift，我喜欢它！我想用一个与 mysql 通信的 tomcat 应用程序来尝试它。我能够通过[本教程](https://openshift.redhat.com/community/blogs/free-apache-tomcat-hosting-in-the-cloud-for-java-applications-its-called-openshift)安装 tomcat， 并且我的 tomcat 服务器已启动并运行！我还安装了 mysql 和 phpmyadmin，但现在我必须部署我的 servlet tomcat 服务器。我的 servlet 与 mysql 通信，但我找不到在哪里插入 Openshift 给我的变量！有人知道吗？Thnx 提前安迪 :)

OPENSHIFT 变量是：

```
Root User :andi
RootPassword: andi
Connection URL: mysql://$OPENSHIFT_MYSQL_DB_HOST:$OPENSHIFT_MYSQL_DB_PORT/ 
```

我的伺服器：

```
import java.io.IOException;
import java.io.PrintWriter;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import com.mysql.jdbc.Connection;
import com.mysql.jdbc.PreparedStatement;
@WebServlet("/HelloWorldServlet")
public class HelloWorldServlet extends HttpServlet {
private static final long serialVersionUID = 1L;
public HelloWorldServlet() {
    super();
}

protected void doGet(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {
       String titulli =  request.getParameter("titulli");
      String ingredientet =  request.getParameter("ingredientet");
       String receta =  request.getParameter("receta");

       final String url = "jdbc:mysql://localhost/andi";
        final String user = "andi";
        final String password = "andi";
        try {

            // jdbc try
            Class.forName("com.mysql.jdbc.Driver");
            Connection con = (Connection) DriverManager.getConnection(url, user,
                    password);
            // insert values into the first table
        PreparedStatement s = (PreparedStatement) con
                    .prepareStatement("INSERT INTO  recetat(titulli,ingredientet,receta) VALUES (?,?,?)");

        s.setString(1, titulli);
        s.setString(2, ingredientet);
        s.setString(3, receta);
        s.executeUpdate();

        }  catch (SQLException e) {
            e.printStackTrace();
        } catch (ClassNotFoundException e) {
            e.printStackTrace();
        }
        PrintWriter out = response.getWriter();
        out.println("Receta u ruajt me sukses ne server !");
        System.out.println(titulli+ingredientet+receta);
}
} 
```

就像你可以看到我不知道在哪里插入

```
Connection URL: mysql://$OPENSHIFT_MYSQL_DB_HOST:$OPENSHIFT_MYSQL_DB_PORT/ 
```

多变的...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T15:26:31.887

OpenShift 将 MySQL 主机和端口作为环境变量放在该名称上。在 Java 术语中，它们可以通过

```
String host = System.getenv("OPENSHIFT_MYSQL_DB_HOST");
String port = System.getenv("OPENSHIFT_MYSQL_DB_PORT"); 
```

然后，按如下方式编写 JDBC URL

```
String url = String.format("jdbc:mysql://%s:%s/andi", host, port); 
```

然而，通常的方法是在其中创建一个连接池数据源`context.xml`并通过 JNDI 获取它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T13:04:24.997

有点相关 - 您现在可以直接安装 tomcat（无需遵循 DIY 步骤）但运行

```
rhc app create <name> jbossews-1.0 
```

JBoss EWS 是 Red Hat 的一个维护和支持的 Tomcat 版本——都是一样的。此外，从下周开始，rhc 客户端工具将支持

```
rhc app create <name> tomcat6 
```

让它变得更简单。

# xcode - 通过单击 Return 键在 UITextfield 中插入换行符 (\n)

> ID：14753570
> 
> 赞同：0
> 
> 时间：2013-02-07T14:33:16.583
> 
> 标签：xcode

在在这里发布问题之前，我正在寻找这个答案很长一段时间。我很确定这应该很容易，但是......

我有一个 UITextField ，当用户点击返回键时，应该插入一个换行符。就像 WhatsApp 使用返回键一样。

我怎样才能做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:43:58.640

`UITextView`有这种行为。尝试使用它而不是`UITextField`

# delphi - DelphiWebScript 中值的运行时评估

> ID：14753573
> 
> 赞同：5
> 
> 时间：2013-02-07T14:33:19.877
> 
> 标签：delphi, jedi, dwscript

我的 delphi 应用程序使用 JvInterpreter（来自 Jedi 项目）运行脚本。

我使用的一个特性是表达式的运行时评估。
脚本示例：

```
[...]
ShowMessage(X_SomeName);
[...] 
```

JvInterpreter 不知道 X_SomeName。当需要 X_SomeName 的值时，脚本编写者调用其 OnGetValue 回调。这指向我处理的一个函数。我在那里查找 X_SomeName 的值并返回它。然后 JvInterpreter 使用我提供的值调用 ShowMessage。

现在我考虑切换到 DelphiWebScript，因为它具有适当的调试接口，并且应该比 JvInterpreter 更快。

问题：不过，我没有找到任何明显的方法来实现 JvInterpreter 的 OnGetValue/OnSetValue 函数。

X_SomeName 应该被认为（实际上是，大多数时候）一个由主机应用程序处理的变量。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T16:35:28.957

您可以通过语言扩展机制来做到这一点，该机制有一个 FindUnknownName 方法，允许在现场注册符号。

它在 asm lib 模块演示中使用，您还可以在 ULanguageExtensionTests 中查看新的“AutoExternalValues”测试用例，它应该更接近您所追求的。

# javascript - 带有 json 的混合数组 - 解析问题

> ID：14753575
> 
> 赞同：0
> 
> 时间：2013-02-07T14:33:31.953
> 
> 标签：javascript, jquery, arrays, json

我正在做一个 youtube api 调用，我得到一个`var result = JSON.stringify(response, '', 2);`看起来像：

```
{
    "kind": "youtube#searchListResponse",
    "pageInfo": {
            "totalResults": 1000000,
            "resultsPerPage": 5
        },
    "items": [
        {
            "id": {
                "kind": "youtube#video",
                "videoId": "DEne4AoX_RU"
            },
            "kind": "youtube#searchResult",
            "snippet": {
                "publishedAt": "2012-11-22T22:36:15.000Z",
                "thumbnails": {
                    "default": {
                        "url": "https://i.ytimg.com/vi/DEne4AoX_RU/default.jpg"
                    },
                    "medium": {
                        "url": "https://i.ytimg.com/vi/DEne4AoX_RU/mqdefault.jpg"
                    },
                    "high": {
                        "url": "https://i.ytimg.com/vi/DEne4AoX_RU/hqdefault.jpg"
                    }
                }
            }
        },
        {
            "id": {...} 
```

完整的对象响应在我的控制台中正确返回，但我想检索缩略图 url 并将其显示为 li 标记的 html 列表所以我首先尝试在列表中获取所有片段条目：

```
var obj = $.parseJSON(result);
$.each(obj, function() {
    output += this.snippet + + "<br/>";
});
console.log(output); 
```

但是我的控制台中有一条消息：`Uncaught TypeError: Cannot read property 'length' of undefined`。我错过了什么？顺便说一句，我不明白为什么在字符串化的 json 中仍然有括号`result`（如果有人可以建议一些好的文档来了解如何解析 JSON，那就太好了:)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:35:51.057

你应该循环过去`items`：

```
$.each(obj.items, function() {
    output += this.snippet ...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:36:49.747

您收到的是 JSON，您不应该将其字符串化。

删除此行

```
var result = JSON.stringify(response, '', 2); 
```

并且简单地做

```
var obj = $.parseJSON(response); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:36:53.367

1.  你想迭代`items`，
2.  `snippet`是一个对象字面量，
3.  `+ +`不是有效的 JavaScript。

# iphone - 从不兼容的类型分配给“NSLineBreakMode”

> ID：14753579
> 
> 赞同：2
> 
> 时间：2013-02-07T14:33:39.070
> 
> 标签：iphone, ios, uilabel, xcode4.6

将我的 xcode 4.5 更新到 4.6 后 ....

```
lblMyLable.lineBreakMode = UILineBreakModeWordWrap;
textFieldRounded1.textAlignment = UITextAlignmentLeft; 
```

停止工作并显示不兼容的错误...它们在 xcode 更新前 2 天工作良好。

**PS：- lblMyLable 是一个 UILabel & textFieldRounded1 是一个 UITextField**

**我正在使用 6.1 IOS sdk**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:35:38.357

在 iOS 6 中，您需要使用 NSLineBreakByWordWrapping。代替：

```
lblMyLable.lineBreakMode = UILineBreakModeWordWrap;
textFieldRounded1.textAlignment = UITextAlignmentLeft; 
```

利用：

```
lblMyLable.lineBreakMode = NSLineBreakByWordWrapping;
textFieldRounded1.textAlignment = NSTextAlignmentLeft; 
```

* * *

# 细节

> **换行模式**
> 
> 用于包装和截断标签文本的技术。 `@property(nonatomic) NSLineBreakMode lineBreakMode;`
> 
> **讨论**
> 
> 如果您在 iOS 6 或更高版本中使用样式文本，则为该属性分配一个新值会导致将换行模式应用于属性文本属性中的整个字符串。如果您只想将换行模式应用于文本的一部分，请使用所需的样式信息创建一个新的属性字符串并将其与标签相关联。如果您不使用样式文本，则此属性适用于 text 属性中的整个文本字符串。
> 
> 此属性在正常绘图期间和必须减小字体大小以适合其边界框中的标签文本的情况下都有效。此属性默认设置为 NSLineBreakByTruncatingTail。
> 
> 重要提示：如果此属性设置为导致文本换行的值，则将adjustsFontSizeToFitWidth 或adjustsLetterSpacingToFitWidth 属性设置为YES 是程序员错误。
> 
> 特别注意事项
> 
> **在 iOS 5 和更早的版本中，这个属性的类型是 UILineBreakMode。可用性**
> 
> ```
> Available in iOS 2.0 and later. 
> ```

* * *

> **NSLineBreakMode**
> 
> 这些常量指定当一行对于它的容器来说太长时会发生什么。
> 
> ```
> enum {   
>    NSLineBreakByWordWrapping = 0,   
>    NSLineBreakByCharWrapping,
>    NSLineBreakByClipping,    
>    NSLineBreakByTruncatingHead,   
>    NSLineBreakByTruncatingTail,    
>    NSLineBreakByTruncatingMiddle
>  };
>  typedef NSUInteger NSLineBreakMo 
> ```
> 
> **常数**
> 
> **NSLineBreakByWordWrapping**
> 
> ```
> Wrapping occurs at word boundaries, unless the word itself doesn’t fit on a single line.
> 
> Available in iOS 6.0 and later.
> 
> Declared in NSParagraphStyle.h. 
> ```
> 
> **NSLineBreakByCharWrapping**
> 
> ```
> Wrapping occurs before the first character that doesn’t fit.
> 
> Available in iOS 6.0 and later.
> 
> Declared in NSParagraphStyle.h. 
> ```
> 
> **NSLineBreakByClipping**
> 
> ```
> Lines are simply not drawn past the edge of the text container.
> 
> Available in iOS 6.0 and later.
> 
> Declared in NSParagraphStyle.h. 
> ```
> 
> **NSLineBreakByTruncatingHead**
> 
> ```
> The line is displayed so that the end fits in the container and the missing text at the beginning of the line is indicated by an 
> ```
> 
> 省略号字形。尽管此模式适用于多行文本，但它更常用于单行文本。
> 
> ```
> Available in iOS 6.0 and later.
> 
> Declared in NSParagraphStyle.h. 
> ```
> 
> **NSLineBreakByTruncatingTail**
> 
> ```
> The line is displayed so that the beginning fits in the container and the missing text at the end of the line is indicated by an 
> ```
> 
> 省略号字形。尽管此模式适用于多行文本，但它更常用于单行文本。
> 
> ```
> Available in iOS 6.0 and later.
> 
> Declared in NSParagraphStyle.h. 
> ```
> 
> **NSLineBreakByTruncatingMiddle**
> 
> ```
> The line is displayed so that the beginning and end fit in the container and the missing text in the middle is indicated by an 
> ```
> 
> 省略号字形。尽管此模式适用于多行文本，但它更常用于单行文本。
> 
> ```
> Available in iOS 6.0 and later.
> 
> Declared in NSParagraphStyle.h. 
> ```

请查看[**UILabel 类**](http://developer.apple.com/library/ios/#documentation/uikit/reference/UILabel_Class/Reference/UILabel.html)以获取更多详细信息。还要检查[**UITextField 类**](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextField_Class/Reference/UITextField.html)以获取 NSTextAlignment 值和详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:57:58.580

它们都在 iOS 6 中被弃用；

`UILineBreakModeWordWrap`已被替换[`NSLineBreakByWordWrapping`](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSParagraphStyle_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSLineBreakMode)。

`UITextAlignmentLeft`已被替换为[`NSTextAlignmentLeft`](http://developer.apple.com/library/ios/documentation/uikit/reference/NSString_UIKit_Additions/Reference/Reference.html#//apple_ref/doc/c_ref/NSTextAlignment)

# c# - 我可以从外部控制一些 WebForm 吗？

> ID：14753582
> 
> 赞同：0
> 
> 时间：2013-02-07T14:33:57.547
> 
> 标签：c#, asp.net, .net, webforms

我有一些 WebForms，例如`First.ascx.cs`,`Second.ascx.cs`等等`Third.ascx.cs`！

好吧，我想在 PreInit 阶段调用一个函数（比方说， ），并为每个上下文调用`startFunction()`另一个（比方说， ）和 PreRender 阶段。`endFunction()`

所以：

```
startFunction();
... First.ascx.cs PageLoad execution...
endFunction();

startFunction();
... Second.ascx.cs PageLoad execution...
endFunction();

startFunction();
... Third.ascx.cs PageLoad execution...
endFunction(); 
```

无需为我需要控制的每个上下文编写相同的开始/结束函数并复制和粘贴。.NET (3.5) 和 WebForms 有没有好的策略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:10:17.793

遗产！

创建一个基本控件，您可以在其中附加到这些事件，然后从中派生。

MarkzzzClass .cs

```
public abstract class MarkzzzClass : System.Web.UI.UserControl
{
//do something
} 
```

BaseControl.cs：

```
public abstract class BaseControl : MarkzzzClass 
{
    protected override void OnPreRender(EventArgs e)
    {
        EndFunction();
        base.OnPreRender(e);
    }
    protected override void OnInit(EventArgs e)
    {
        StartFunction();
        base.OnInit(e);
    }
} 
```

首先.ascx.cs：

```
public partial class First : BaseControl
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

# python - dictsort 模板过滤器和过滤两列

> ID：14753586
> 
> 赞同：7
> 
> 时间：2013-02-07T14:34:09.543
> 
> 标签：python, django, django-templates

在模板中我现在使用这个：

```
{% for item in mydict|dictsortreversed:"column1" %} 
```

但是我必须按两列对数据进行排序 - dictsort 中是否有任何选项可以做到这一点？或者在模板中执行此操作的任何替代方法？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-07T14:49:09.303

正如您在 Django[代码](https://github.com/django/django/blob/master/django/template/defaultfilters.py#L486)中看到的那样，不支持此功能。

但是，由于 Python 以[稳定的方式](http://wiki.python.org/moin/HowTo/Sorting/#Sort_Stability_and_Complex_Sorts)排序。通过两次排序来实现这很简单:)

```
{% for item in mydict|dictsortreversed:"column1"|dictsortreversed:"column2" %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:46:05.750

怎么样 -

```
{% for item in mydict|dictsortreversed %}
    {% if forloopcount|diviisbleby:"2" %}
            <td> item </td> 
        </tr>
    {% else %}
        <tr>
            <td> item </td>
    {% endif %}
{% endfor %} 
```

查看[forloop 计数器](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#for)并被模板标签[整除以](https://docs.djangoproject.com/en/1.4/ref/templates/builtins/#divisibleby)获得更多想法。

# java - XPath 节点列表顺序 (Java)

> ID：14753588
> 
> 赞同：5
> 
> 时间：2013-02-07T14:34:15.850
> 
> 标签：java, xpath, nodelist

我有以下 XML 结构。

```
<?xml version="1.0" encoding="UTF-8"?>
<root> 
  <header> 
    <row> 
      <column n="name" />
      <column n="age" />
      <column n="email" />
    </row> 
  </header>  
  <body> 
    <row> 
      <column>Foo</column>  
      <column>99</column>  
      <column>foo@test.com</column> 
    </row>  
  </body> 
</root> 
```

我正在使用以下 XPath 表达式来获取标题列，并同样获取正文列。

```
PathExpression headerExpr = xPath.compile("/root/header/row/column/@n");
NodeList headerColumns = (NodeList) headerExpr.evaluate(document, XPathConstants.NODESET);
PathExpression bodyExpr = xPath.compile("/root/body/row/column");
NodeList bodyColumns = (NodeList) bodyExpr.evaluate(document, XPathConstants.NODESET);
for (int i = 0; i < headerColumns.getLength(); i++) {
                System.out.println((Attr) headerColumns .item(i)).getValue() + ": " + bodyColumns.item(i).getTextContent());
        } 
```

我可以假设 XPath 将始终以相同的顺序返回标题和正文列，以便它们始终匹配吗？或者我什至可以假设列总是按文档顺序返回？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:48:19.143

使用 XPath 时始终保留文档顺序，这里有一些官方供您参考：http: [//msdn.microsoft.com/en-us/library/ms256090.aspx](http://msdn.microsoft.com/en-us/library/ms256090.aspx)

# iphone - 从 iOS 上的 .net Web 服务获取数据

> ID：14753591
> 
> 赞同：5
> 
> 时间：2013-02-07T14:34:20.667
> 
> 标签：iphone, ios, objective-c, web-services, xml-parsing

我有一个 .Net 网络服务，我将它用于移动应用程序。我在 windows phone 和 android 应用程序上使用了它，但我还没有在 iOS 上从中获取数据。例如，我的 Web 服务中有一种方法，它需要一个参数。如何从返回值中获取数据？我在互联网上找到了一个示例并对其进行了编辑，但无法获取数据。所有代码都在这里。在这种情况下**，我需要一个示例代码**。感谢关注。

**网络服务信息**：

命名空间：[http](http://tempuri.org) ://tempuri.org url：[http](http://www.example.com/webservice1.asmx) ://www.example.com/webservice1.asmx 方法名称：FirmaGetir 参数名称：firID（字符串）

**网络服务请求：**

```
 POST /webservice1.asmx HTTP/1.1
Host: example.com
Content-Type: application/soap+xml; charset=utf-8
Content-Length: length

<?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
  <soap12:Body>
    <FirmaGetir xmlns="http://tempuri.org/">
      <firID>string</firID>
    </FirmaGetir>
  </soap12:Body>
</soap12:Envelope> 
```

**返回数据**：

```
HTTP/1.1 200 OK
Content-Type: application/soap+xml; charset=utf-8
Content-Length: length
<?xml version="1.0" encoding="utf-8"?>
<soap12:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap12="http://www.w3.org/2003/05/soap-envelope">
  <soap12:Body>
    <FirmaGetirResponse xmlns="http://tempuri.org/">
      <FirmaGetirResult>
        <Firma>
          <firma_adi>string</firma_adi>
          <adres>string</adres>
          <telefon>string</telefon>
          <id>string</id>
          <sektor>string</sektor>
          <alt_sektor>string</alt_sektor>
          <alt_sektor_adi>string</alt_sektor_adi>
          <servis>string</servis>
          <map>string</map>
          <slogan>string</slogan>
          <sayfaGosterimi>int</sayfaGosterimi>
          <gpsilce>string</gpsilce>
          <gpssemt>string</gpssemt>
          <gpspk>string</gpspk>
          <duyuru>
            <baslik>string</baslik>
            <icerik>string</icerik>
            <link>string</link>
            <image>string</image>
          </duyuru>
          <firma_link>
            <tam_adi>string</tam_adi>
            <kisa_adi>string</kisa_adi>
            <firma_link>string</firma_link>
          </firma_link>
        </Firma>
      </FirmaGetirResult>
    </FirmaGetirResponse>
  </soap12:Body>
</soap12:Envelope> 
```

**SOAPExampleViewController.h**

```
#import <UIKit/UIKit.h>
@interface SOAPExampleViewController : UIViewController 
{
    NSXMLParser *xmlParser;
    NSMutableData *webData;
    NSMutableString *soapResults;
    BOOL recordResults;
}

@property(nonatomic, retain) NSMutableData *webData;
@property(nonatomic, retain) NSXMLParser *xmlParser;
@property(nonatomic, retain) NSMutableString *soapResults;

-(IBAction)buttonClick:(id)sender;

@end 
```

**SOAPExampleViewController.m**

```
#import "SOAPExampleViewController.h"

@implementation SOAPExampleViewController
@synthesize xmlParser, webData, soapResults;

-(IBAction)buttonClick:(id)sender
{
    NSString *firid = [NSString stringWithFormat:@"800"];
    recordResults = NO;
    NSString *soapMessage = [NSString stringWithFormat:
                         @"POST /webservice1.asmx HTTP/1.1\n"
                         "Host: example.com\n"
                         "Content-Type: application/soap+xml; charset=utf-8\n"
                         "Content-Length: length\n"

                         "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n"
                         "<soap12:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap12=\"http://www.w3.org/2003/05/soap-envelope\">\n"
                         "<soap12:Body>\n"
                         "<FirmaGetir xmlns=\"http://tempuri.org/\">\n"
                         "<firID>%@</firID>\n"
                         "</FirmaGetir>\n"
                         "</soap12:Body>\n"
                         "</soap12:Envelope>\n",firid];
    NSLog(@"%@", soapMessage);
    NSURL *url = [NSURL URLWithString:@"http://www.example.com/webservice1.asmx?op=FirmaGetir"];
    NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:url];
    NSString *msgLength = [NSString stringWithFormat:@"%d", [soapMessage length]];

    [theRequest addValue:@"text/xml; charset=utf-8" forHTTPHeaderField:@"Content-Type"];
    [theRequest addValue:@"http://tempuri.org/FirmaGetir" forHTTPHeaderField:@"SOAPAction"];
    [theRequest addValue:msgLength forHTTPHeaderField:@"Content-Length"];
    [theRequest setHTTPMethod:@"POST"];
    [theRequest setHTTPBody:[soapMessage dataUsingEncoding:NSUTF8StringEncoding]];
    NSURLConnection *theConnection = [[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
    if(theConnection)
    {
        webData = [[NSMutableData data] retain];
    }
    else 
    {
        NSLog(@"theConnection is null");
    }
}

-(void)connection:(NSURLConnection*)connection didReceiveResponse:(NSURLResponse*)response
{
    [webData setLength:0];
     NSHTTPURLResponse * httpResponse;
    httpResponse = (NSHTTPURLResponse *) response;
    NSLog(@"HTTP error %zd", (ssize_t) httpResponse.statusCode);
}

-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData*)data
{
    [webData appendData:data];
    //NSLog(@"webdata: %@", data);
}

-(void)connection:(NSURLConnection *)connection didFailWithError:(NSError*)error
{
    NSLog(@"error with the connection");
    [connection release];
    [webData release];
}

-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSLog(@"DONE. Received bytes %d", [webData length]);
    NSString *theXML = [[NSString alloc] initWithBytes:[webData mutableBytes] length:[webData length] encoding:NSUTF8StringEncoding];
    NSLog(@"xml %@",theXML);
    [theXML release];
    NSString *responseString = [[NSString alloc] initWithData:webData encoding:NSUTF8StringEncoding];
    NSLog(@"Respose Data :%@",responseString) ;
    if(xmlParser)
    {
        [xmlParser release];
    }
    xmlParser = [[NSXMLParser alloc] initWithData:webData];
    [xmlParser setDelegate:self];
    [xmlParser setShouldResolveExternalEntities:YES];
    [xmlParser parse];
    [connection release];
    [webData release];
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict
{
    if([elementName isEqualToString:@"firma_adi"] || [elementName isEqualToString:@"Firma"] || [elementName isEqualToString:@"adres"] ) //I'm trying
    {
            if(!soapResults)
        {
            soapResults = [[NSMutableString alloc]init];
        }
        recordResults = YES;
    }
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{
    if(recordResults)
    {
        [soapResults appendString:string];
    }
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{
    if([elementName isEqualToString:@"firma_adi"] || [elementName isEqualToString:@"Firma"] || [elementName isEqualToString:@"adres"] ) // I'm trying
    {
        recordResults = NO;
        NSLog(@"%@", soapResults);
        [soapResults release];
        soapResults = nil;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T15:31:28.710

替换下面的行

```
 NSURL *url = [NSURL URLWithString:@"http://www.example.com/webservice1.asmx"]; 
```

通过这个。

```
 NSURL *url = [NSURL URLWithString:@"http://www.example.com/webservice1.asmx/ServisKontrol"]; 
```

我会帮你的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T14:43:52.470

或者只是尝试一个很棒的免费工具来生成你需要的所有类和代理。wsdl2code.com

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-15T15:51:43.107

我试图解决这个问题大约一个星期。我不再搜索它了。使用 Web 服务的最佳方式是使用带有 JSON 的 WCF 服务。我找到了一个很好的例子。请按照本教程[http://www.codeproject.com/Articles/405189/How-to-access-SQL-database-from-an-iPhone-app-Via](http://www.codeproject.com/Articles/405189/How-to-access-SQL-database-from-an-iPhone-app-Via)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T15:16:20.133

在 SOAPAction 中更改`http://tempuri.org/FirmaGetir`为。`http://tempuri.org/ServisKontrol`您也可以参考此链接以获取更多信息。[iPhone 与 ASP.NET WebService 的交互](https://stackoverflow.com/questions/1290924/iphone-interaction-with-asp-net-webservice)

# java - 我可以检查 JBoss JMS 队列吗？

> ID：14753595
> 
> 赞同：0
> 
> 时间：2013-02-07T14:34:30.810
> 
> 标签：java, debugging, jboss, jms

我正在调试在 JBoss 4.2.3 中发布到 JMS 队列的消息时遇到的问题。我知道我可以通过 JMX 控制台查看当前队列中的消息数量，但想知道是否有办法获取有关当前队列中特定消息的更多信息？

这些是否可以通过 JMX 获得，或者我可以启用任何额外的日志记录吗？

还是我必须使用 QueueBrowser 部署一些东西？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-08T07:29:54.900

您可以使用 hermes jms，它是一个带有 GUI 的 JMS 管理控制台。我没有用 jboss 试过（只用 glassfish），但它工作得很好，我能够访问队列中的各个消息。看起来他们在这里有 jboss 的教程：[http ://www.hermesjms.com/confluence/display/HJMS/JBoss+Tutorial](http://www.hermesjms.com/confluence/display/HJMS/JBoss+Tutorial)

# ios - 重置后 iPod 无法用作开发设备

> ID：14753597
> 
> 赞同：-6
> 
> 时间：2013-02-07T14:34:31.293
> 
> 标签：ios, device, reset

我的 iPod 作为开发设备运行良好。

但是在我重置 iPod 后，我的 XCode 不再识别它。

它的颜色在 XCode 的管理器中变为黄色，而不是之前的绿点。

请帮忙。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:06:20.857

假设“重置”意味着您恢复了 iPod，那么您的所有配置文件等都将从设备中删除，从而阻止 Xcode 构建到设备。要解决此问题，请在 Xcode 管理器中选择设备（黄点所在的位置），然后单击显示“用于开发”效果的按钮。

此时 Xcode 将提示您输入开发人员凭据，检查 DDI 符号（以及所有其他有趣的东西），并将必要的配置文件安装到设备上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:37:14.507

它可能缺少您的开发配置文件，请确保在尝试将它们用于开发之前将它们重新安装在管理器中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T03:13:20.220

我的问题结束了。

当我打开 Xcode 4.3 时，它可以像以前一样识别我的 iPod。

然后我切换回我的 Xcode 3.2.6，我的 iPod 又变绿了。

这么奇怪。无论如何它都有效。谢谢大家！

# git - git 命令的快捷方式

> ID：14753603
> 
> 赞同：30
> 
> 时间：2013-02-07T14:34:42.470
> 
> 标签：git

我想为 git 命令使用快捷方式或别名。

```
git diff
git status
git push 
git pull
git stash
git branch -a 
```

如何创建快捷方式或别名，是否有预定义列表？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-02-07T14:36:44.707

把这个放到你的`.gitconfig`

```
[alias]
  st = status
  ci = commit
  br = branch
  co = checkout 
```

您可以根据需要添加任意数量

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-02-07T14:35:56.173

```
git config --global alias.<short> <long> 
```

例如

```
git config --global alias.cob "checkout -b" 
```

（没有`--global`，您将获得每个项目的别名。）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-01-31T21:42:24.757

我会推荐[oh-my-zsh git](https://github.com/robbyrussell/oh-my-zsh/blob/master/plugins/git/git.plugin.zsh)快捷方式。

它有一个非常详尽的（超过 100 个快捷方式）列表。

这是一个**小**示例，可帮助您入门：

```
alias ga='git add'
alias gc='git commit -v'
alias gd='git diff'
alias gst='git status'

alias gco='git checkout'
alias gcm='git checkout master'

alias gb='git branch'
# view remote branches
alias gbr='git branch --remote'

alias gup='git pull --rebase'
alias gp='git push'
# push a newly created local branch to origin
alias gpsup='git push --set-upstream origin $(git_current_branch)' 
```

大多数快捷方式中的字母选择使它们足够直观。

使用流行且活跃的开源项目提供的快捷方式有很多好处。其中一些：

*   从不在乎是否丢失它们，因为您可以轻松找到它们！
*   增加其他人与您拥有相同快捷方式的机会，从而相互学习。
*   减少快捷方式与其他命令冲突的机会。

即使您不使用 zsh，您仍然可以将它们**复制**到常规的 shell 配置文件中，例如`.bashrc`.

我还添加了

```
alias oh='less ~/.oh-my-zsh/plugins/git/git.plugin.zsh' 
```

这样我就可以直接从终端快速读取可用的快捷方式。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-30T04:52:08.947

不止一种方法可以做到这一点。下面用例子来解释：

**[1] 使用 git 本身提供的“别名”选项。**

**示例：** git config --global alias.co checkout

**因此用法：** git co

这相当于在*'~/.gitconfig'*中手动输入条目（此路径因为使用了*--global*，否则将使用您尝试设置的项目的*.gitconfig文件）。*

```
[alias]
  co = checkout 
```

因此，按照指定手动输入文件也可以是另一种设置别名的方式。

[了解更多信息](https://git-scm.com/book/en/v2/Git-Basics-Git-Aliases)

**[2] 使用 .bash_profile/.bashrc。**

编辑您的*~/.bash_profile*或*~/.bashrc*，如下所示：

**示例：**别名 go='git checkout'

**因此用法：**去

（根据您的情况，在更改文件后不要忘记“source ~/.bash_profile”或“source ~/.bashrc”）。

[了解更多信息](https://jonsuh.com/blog/git-command-line-shortcuts/)

因此，如果您清楚地看到，第二种方法是进一步将速记/别名放入 git-command 用法（用于您的个人资料）。

此外，别名意味着易于使用，因此您更喜欢/放心，是您可以添加的（例如：我可以说，Giraffe = git checkout，如果这是我的方便）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-09T09:43:23.850

我为 bash 调用了一个终端“模式”，`git_mode`以避免键入`git`和使用`c`for`commit`等。

你可以在[这里](https://github.com/Tredecies/git_mode)找到它。

示例命令如下所示：

```
# Add
alias a='git add'
alias add='git add'

# Diff
alias d='git diff'
alias diff='git diff'

# Grep/Search
alias search='git grep'
alias grep='git grep'

# Merge
alias merge='git merge'
alias m='git merge'

# Branch
alias b='git branch'

# Status
alias s='git status'
alias status='git status'

# Commit
alias c='git commit'
alias commit='git commit'

# Remote
alias remote='git remote'

# Pull
alias pull='git pull'

# Push
alias push='git push'

# init
alias init='git init'
alias i='git init'

# clone
alias clone='git clone'

# checkout
alias ch='git checkout'
alias checkout='git checkout'

# stash
alias stash='git stash' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-06-25T08:10:59.650

我使用[这个库，SCM Breeze](https://github.com/scmbreeze/scm_breeze)。它为文件提供了非常酷的 UI，并且易于使用。

# php - 了解服务器是通过 HTTP 还是 HTTPS 访问的最佳方法是什么？

> ID：14753606
> 
> 赞同：0
> 
> 时间：2013-02-07T14:34:58.390
> 
> 标签：php, apache, https, apache2

使用 Apache 和 PHP，了解它并强制使用 HTTPS 的最佳方式是什么？

我在 phpinFO() 中搜索了 $_SERVER 变量，但没有发现任何帮助。

编辑：感谢您的回答和建议！我不能在服务器级别强制它，因为它只用于登录页面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T14:38:15.140

`$_SERVER['HTTPS']`如果使用 HTTPS，则为非空。但是你最好在网络服务器级别执行 HTTPS，例如

```
<virtualhost example.com:80>
   redirect permanent https://example.com
</virtualhost>

<virtualhost example.com:443>
   blah blah blah
</virtualhost> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T14:39:08.747

在 .htaccess 文件中，添加以下内容：

```
<IfModule mod_rewrite.c>
  RewriteEngine on
  RewriteCond %{HTTPS} !=on
  RewriteRule ^/?(.*) https://YOUR_URL/$1 [R,L]
</IfModule> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T14:43:51.233

此外，请考虑添加 HSTS HTTP 标头。这告诉浏览器甚至不要尝试访问 HTTP 版本，而是直接访问 HTTPS。这可以防止可能的中间人攻击，您的重定向可能会被拦截。

（前提是用户之前访问过该网站，或者您的网站已添加到内置 HSTS 列表中。）

请参阅[http://dev.chromium.org/sts](http://dev.chromium.org/sts)了解如何添加到内置列表，以及标题的示例。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-07T14:45:13.277

唯一正确的答案是因为您将服务器配置为以这种方式运行。

如果您绝对不知道当请求发送到 PHP 时是通过 HTTP 还是 HTTPS 发送的，那么您的系统是不安全的。

# ruby - ActiveRecord，通过多态属性查找

> ID：14753611
> 
> 赞同：6
> 
> 时间：2013-02-07T14:35:19.873
> 
> 标签：ruby, ruby-on-rails-3, activerecord, active-record-query

有这个：

```
class Event < ActiveRecord::Base
  belongs_to :historizable, :polymorphic => true
end

user = User.create! 
```

我可以：

```
Event.create!(:historizable => user) 
```

但我不能：

```
Event.where(:historizable => user)
# Mysql2::Error: Unknown column 'events.historizable' in 'where clause' 
```

我必须这样做：

```
Event.where(:historizable_id => user.id, :historizable_type => user.class.name) 
```

## 更新

重现该问题的代码：[https ://gist.github.com/fguillen/4732177#file-polymorphic_where_test-rb](https://gist.github.com/fguillen/4732177#file-polymorphic_where_test-rb)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T17:15:06.420

> 这已在 Rails master 中实现，并将在 Rails 4 中可用。谢谢。

– [@carlosanoniodasilva](https://github.com/rails/rails/issues/9227)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T17:54:33.840

我这样做：

```
user.events 
```

这是一个正确的 AR 查询，您可以将其与其他范围和内容链接起来：

```
user.events.where(<your event conditions here>) 
```

编辑：反过来，AFAIK 必须指定两个字段（这是有道理的：您可以有一个具有 id 4 的用户和另一个具有事件的事物，例如派对，也具有 id 4）。

EDIT2：关于“为什么`create`工作和`where`不工作”：`create`比 更高级`where`，因为前者处理“完整模型”，而后者在数据库表级别管理事物。

1.  ActiveRecord `create`(AFAIK) 在某处使用`new`+组合。`update_param`
2.  `update_param`使用模型的`xxxx=`方法来分配每个单独的属性。
3.  在您的示例中，`historizable=`是由`belongs_to`表达式构建的方法。由于`belongs_to`“知道”它是多态的，它可以处理类型和 id。

另一方面，当您将哈希传递给`where`子句时，那里的参数*仅引用数据库字段*。Rails 为“更高级别”的访问提供了范围：

```
class Event < ActiveRecord::Base
  ...

  scope :by_historizable, lambda { |h| where(:historizable_id => h.id, :historizable_type => h.class.name) }

end

...

Event.by_historizable(user).where(<your other queries here>) 
```

我听说这可能会在 Rails 4 中改变，并且`where`可能更“智能”。但我还没有检查。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-07T15:01:19.250

尝试：

```
Event.joins(:historizable).where(:historizable => {:historizable_type => user}) 
```

# frontend - trello 的图形用户界面

> ID：14753615
> 
> 赞同：3
> 
> 时间：2013-02-07T14:35:34.333
> 
> 标签：frontend, trello

这里的任何人都知道使用哪种技术或框架或任何东西在 Trello 网站上呈现漂亮的 GUI？
我对前端技术有点过时了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T15:29:29.220

这是 Fog Creek（创建者）对 Trello 技术堆栈的一篇非常好的文章： [The Trello Tech Stack](http://blog.fogcreek.com/the-trello-tech-stack/)

简而言之*（如果您太忙而无法阅读文章）*，他们使用：

## 客户

*   骨干网（用于客户端 MVC）
*   HTML5（用于 pushState）
*   小胡子（用于模板）

## 服务器

*   节点.js
*   HAProxy
*   雷迪斯
*   MongoDB

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-07T21:50:57.067

在前端，Trello 主要使用 jQuery 和 Backbone.js。所有的模式、菜单和对话窗口都是自定义的。所有的 CSS 都是自定义的。Trello 使用和[图标字体](http://blog.fogcreek.com/trello-uses-an-icon-font-and-so-can-you/)作为图标。

# c# - 无法在 C# 中初始化列表集合？

> ID：14753620
> 
> 赞同：1
> 
> 时间：2013-02-07T14:35:49.903
> 
> 标签：c#, .net, arrays, list, multidimensional-array

您好，我不知道为什么我无法完成之前声明的对象集合。

**这是我的声明一个对象列表的列表。**（我想将对象列表存储在引用列表中）：

```
private List<List<Classes.instancedModel>> listInstance; 
```

**我在构造函数中初始化**

```
listInstance = new List<List<Classes.instancedModel>>(); 
```

**我在循环完成列表之前初始化列表的第一个数组，**但我不能......

```
listInstance[0] = new List<Classes.instancedModel>();
listInstance[0].Add(new instancedModel(1, position_model_origin, new Vector3(0, 0, 0), 1, Game)); 
```

但我会抛出一个类型的异常：**ArgumentOutOfRangeException**

有人可以向我解释如何声明两个动态列表并作为我的例子填充苍蝇吗？与列表成列表

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T14:38:29.493

**列表不是数组。**除非至少有一个项目，否则您可能无法使用索引器访问。

```
listInstance[0] = new List<Classes.instancedModel>(); <--- NO!!

listInstance.Add(new List<Classes.instancedModel>()); <--- YES!! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:38:17.937

您真正想要的是将项目添加到您的列表中：

```
listInstance.Add(new List<Classes.instancedModel>()); //listInstance is List not an array 
```

[`List<T>`](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDQQFjAA&url=http%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2F6sh2ey19.aspx&ei=7rwTUdCkF8jJtAbnyoGgBg&usg=AFQjCNEDl4T3WgLBndZ1pncFdqEW4rkuog&sig2=7BOy_j5DYdIv53VTxfK_tw&bvm=bv.42080656,d.Yms)并且[`Array`](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&sqi=2&ved=0CDEQFjAA&url=http%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fsystem.array.aspx&ei=Br0TUZr_C8jLswaBv4GICQ&usg=AFQjCNGHRGoMzf3IquzZAzpHwo0aEhdJDA&sig2=ssOvminZCXSHpFY0FOUeTg&bvm=bv.42080656,d.Yms)不一样。当你打电话时，你打电话`instanceOfList[index]`给[indexer](http://msdn.microsoft.com/en-us/library/vstudio/6x16t2tx.aspx)。如果索引器将无法找到元素，`index`则会抛出 `ArgumentOutOfRangeException`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:38:57.730

在使用索引之前，您需要先调用 Add 方法：

```
private List<List<instancedModel>> listInstance;
listInstance = new List<List<instancedModel>>();

listInstance.Add(new List<Classes.instancedModel>());

listInstance[0].Add(new instancedModel(1, position_model_origin, new Vector3(0, 0, 0), 1, Game)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T14:42:15.843

listInstance[0] 在您创建它之前不存在 - 您只创建了列表，您没有向其中添加任何内容。

```
var listInstance = new List<List<instancedModel>>();

listInstance.Add(new List<instancedModel> {
    new instancedModel(1, position_model_origin, new Vector3(0, 0, 0), 1, Game)
}); 
```

# xslt - XSL for-each。tr 标签中的错误输出

> ID：14753623
> 
> 赞同：1
> 
> 时间：2013-02-07T14:35:54.710
> 
> 标签：xslt, foreach, html-table, divider

我的问题是：我必须使用 xslt 来处理我网站中的产品。以下是它的外观：

![应该怎么看](../Images/1332b260ecf88adf175e31104beef711.png)

现在看起来像这样：

![现在看起来](../Images/3e2c730821effad07a8c7e5d7a1a647a.png)

`<tr>`所以，我的问题是如何在标签之间做这些分界线？

![在此处输入图像描述](../Images/3a4e4978b9d23f3dd7932dfb2d755dce.png)

这是我的代码：

```
 <table id="producers_table"  >

      <xsl:for-each select="document('udata://catalog/getCategoryList/void/producers//1/')/udata/items/item[not(@country=preceding-sibling::item/@country)]" >

       <xsl:variable name="country_name" select="@country" />
       <xsl:variable name="country_count" select="count($country_name)"/>

       <tr id="test">

       <td id="country_td">
      <xsl:value-of select="document(concat('uobject://', $country_name))/udata/object/@name"/>

       </td>     

        <xsl:for-each select="../item[@country = $country_name]">

  <xsl:variable name="prod_count" select="document(concat('udata://catalog/getCountObjects/', @id))/udata"/>

                            <td umi:element-id="{@id}">

                                            <a href="{@link}" umi:field-name="name" umi:delete="delete" umi:empty="&empty-section-name;">
                <table class="object_table">
                <tr>
                <td align="center">     
<img src="{document(concat('upage://', @id, '.header_pic'))//value}"/>
</td>
</tr>
<tr>
    <td align="center" id="search_by_appointment_name">
        <p>
    <span><xsl:variable name="curr_producer_name" select="."/>
    <xsl:value-of select="$curr_producer_name" />
</span>

&#160;<sup class="object_count"><xsl:value-of select="$prod_count"/></sup>
</p>
</td>
</tr>
</table>
    </a>
     </td>  
         </xsl:for-each>   
</tr>

</xsl:for-each>

</table> 
```

我应该在哪里添加`<hr/>`？

PS这是我尝试的一些结果：

1.

![尝试 1](../Images/12b9ece7097bc4fbe2280a1d41dc84d5.png)

代码：

```
<table id="producers_table"  >

  <xsl:for-each select="document('udata://catalog/getCategoryList/void/producers//1/')/udata/items/item[not(@country=preceding-sibling::item/@country)]" >

   <xsl:variable name="country_name" select="@country" />
   <xsl:variable name="country_count" select="count($country_name)"/>

   <tr id="test">
      **<hr/>** 
```

2.

![尝试 2](../Images/2430af6d179a42f69a352c84f7aab4b6.png)

```
&#160;<sup class="object_count"><xsl:value-of select="$prod_count"/></sup>
</p>
</td>
</tr>
</table>
    </a>
     </td>  
         </xsl:for-each>   
         **<hr/>**
</tr>

</xsl:for-each>

</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:18:14.213

`td`只需在样式标签中为您创建一个 CSS 类`border-bottom: 1px solid gray`。这应该会达到你想要的效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T15:04:44.523

在 HTML 中，将 a`<hr />`直接放在`<tr>`. 您可以尝试将其放在第二个之前`<xsl:for-each>`：

```
<tr>
  <td colspan="10">
    <hr />
  </td>
</tr> 
```

但是在这个时代，您不应该使用表格进行布局。我认为这里正确的解决方案是重新编写您的 HTML，以便它使用`<div>`s 而不是表格。然后应该很容易将`<hr/>`s 放在您想要的位置。

# c++ - 创建非静态成员函数的线程？

> ID：14753627
> 
> 赞同：3
> 
> 时间：2013-02-07T14:36:01.573
> 
> 标签：c++, multithreading, mfc, member-functions

如果我有一个成员函数。. .

```
MyClass::MyFunction()
{
    while(1)
    {
        //blah blah blah
    }
} 
```

. . . 我尝试创建这个函数的线程。. .

```
CreateThread(Null, 0, (LPTHREAD_START_ROUTINE)MyFunction, NULL, 0, NULL); 
```

. . . 我总是收到一条错误消息，指出 (LPTREAD_START_ROUTINE)MyFunction 是无效的类型转换，并且我无法创建非静态成员函数的线程。

**我不能使我的函数成为静态**的，因为我多次使用*this指针，这需要一个非静态成员函数来做到这一点。*

有什么简单的方法可以创建非静态成员函数的线程吗？

（我在 Visual Studio 2010、C++、MFC 中工作）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:57:47.150

您应该对所有这些信息进行私有化，也许“start()”函数除外。您将拥有一个类的私有静态成员函数作为操作系统线程启动的目标，在“start()”中将对象的“this”指针传递给线程启动方法，将其转换回您的对象类型静态函数，然后在对象本身上调用您的私有主线程方法。由于静态函数是类的成员，它可以使用私有函数，而如果不是，它就不能（如果不是朋友）。我没有编译/测试这个，但想法是：

```
class MyObj {
private:
    void thread() {
            // this-> is valid here
    }

    static DWORD static_entry(LPVOID* param) {
        MyObj *myObj = (MyObj*)parm;
        myObj->thread();
        return 0;
    }

public:
    void start() {
        CreateThread(Null, 0, (LPTHREAD_START_ROUTINE)static_entry, this, 0, NULL);
    }
}; 
```

警告词：不要在线程运行时破坏对象！您可能必须与互斥锁同步或确保线程在对象销毁时加入。如果 start() 的调用者不再管理对象，您还可以在 thread() 的末尾执行“删除此”或在 static_entry 的末尾删除 myObj。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T14:47:00.677

没有类实例就不能调用 C++ 成员函数。以下代码是我的建议之一；

```
MyClass * instance = ...; // valid instance.
CreateThread(NULL, 0, StartRoutine, instance, 0, NULL);

DWORD WINAPI StartRoutine(LPVOID ptr) {
  static_cast<MyClass*>(ptr)->MyFunction();
} 
```

另一个建议是用`static`关键字声明成员函数；

```
class MyClass {
  ...
  static DWORD WINAPI MyFunction();
  ...
} 
```

在第二个代码中，`MyFunction`无法访问类（非`static`）成员变量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T14:52:20.143

创建静态函数

```
static DWORD myFunctionCaller(LPVOID* param)  
{
  MyClass* myClass = static_cast<MyClass*>(param);
  myClass->MyFunction();
}

CreateThread(Null, 0, (LPTHREAD_START_ROUTINE)myFunctionCaller, this, 0, NULL); 
```

缺点是你得到了一些浮动的静态函数，但是你可以很容易地限制范围，这应该可以防止你创建太多的线程

# android - 运行时出错 - 怎么办？

> ID：14753628
> 
> 赞同：0
> 
> 时间：2013-02-07T14:36:01.197
> 
> 标签：android, mobile, runtime-error

这个错误是什么意思？我在运行时遇到此错误。当我尝试启动时应用程序崩溃。我是 Android 编程新手。

我试图查看代码，但找不到。我会很感激你的帮助。

```
02-07 14:32:57.967: E/Trace(943): error opening trace file: No such file or directory (2)
02-07 14:32:58.386: E/AndroidRuntime(943): FATAL EXCEPTION: main
02-07 14:32:58.386: E/AndroidRuntime(943): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.quiz/com.example.quiz.Splash}: java.lang.ClassNotFoundException: Didn't find class "com.example.quiz.Splash" on path: /data/app/com.example.quiz-2.apk
02-07 14:32:58.386: E/AndroidRuntime(943):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2106)
02-07 14:32:58.386: E/AndroidRuntime(943):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
02-07 14:32:58.386: E/AndroidRuntime(943):  at android.app.ActivityThread.access$600(ActivityThread.java:141)
02-07 14:32:58.386: E/AndroidRuntime(943):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
02-07 14:32:58.386: E/AndroidRuntime(943):  at android.os.Handler.dispatchMessage(Handler.java:99)
02-07 14:32:58.386: E/AndroidRuntime(943):  at android.os.Looper.loop(Looper.java:137)
02-07 14:32:58.386: E/AndroidRuntime(943):  at android.app.ActivityThread.main(ActivityThread.java:5039)
02-07 14:32:58.386: E/AndroidRuntime(943):  at java.lang.reflect.Method.invokeNative(Native Method)
02-07 14:32:58.386: E/AndroidRuntime(943):  at java.lang.reflect.Method.invoke(Method.java:511)
02-07 14:32:58.386: E/AndroidRuntime(943):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-07 14:32:58.386: E/AndroidRuntime(943):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-07 14:32:58.386: E/AndroidRuntime(943):  at dalvik.system.NativeStart.main(Native Method)
02-07 14:32:58.386: E/AndroidRuntime(943): Caused by: java.lang.ClassNotFoundException: Didn't find class "com.example.quiz.Splash" on path: /data/app/com.example.quiz-2.apk
02-07 14:32:58.386: E/AndroidRuntime(943):  at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:65)
02-07 14:32:58.386: E/AndroidRuntime(943):  at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
02-07 14:32:58.386: E/AndroidRuntime(943):  at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
02-07 14:32:58.386: E/AndroidRuntime(943):  at android.app.Instrumentation.newActivity(Instrumentation.java:1054)
02-07 14:32:58.386: E/AndroidRuntime(943):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097)
02-07 14:32:58.386: E/AndroidRuntime(943):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:37:52.597

1.  首先，检查您的来源是否在错误日志中提到的位置。
2.  如果是，请检查您是否犯了任何打字错误
3.  如果它仍然无法正常工作，那么（在我看来）创建一个新项目并重命名缺少的内容会更容易（我已经这样做了几次并且它一直有效）当然，请确保复制所有你的代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:39:48.663

您似乎错过了清单中的 Splash 活动。

```
 <activity android:name=".Splash"/> 
```

查看该行是否出现在您的清单中，如果没有，您应该添加它。

# svn - 将具有所有历史的单个树 svn 结构导出到新的多树结构中

> ID：14753630
> 
> 赞同：1
> 
> 时间：2013-02-07T14:36:07.983
> 
> 标签：svn

我们目前有一个 svn 服务器，对于我们所有的项目，一切都在一棵大树中。

是否有可能以某种方式将这些项目及其历史导出到新的多树结构中？

有没有办法只转储树的部分路径，这样我就可以在自己的备份文件中获取每个项目并将它们导入新的 svn 服务器？

编辑：澄清一下，我们有一个存储库，其结构包含客户及其项目，我们现在希望每个项目都有一个存储库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T15:07:49.640

您可能想查看 SVN 书籍的[Migrating Repository Information Elsewhere](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.migrate)部分。总结一下：

*   `svnrdump dump`将存储库子目录放入转储文件中。
*   `svnrdump load`它进入新的存储库。

[本节](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.filtering)也可能解决您的问题..

# java - Java KeyListener - 按住键时释放键触发

> ID：14753636
> 
> 赞同：1
> 
> 时间：2013-02-07T14:36:27.390
> 
> 标签：java, swing, jframe, keylistener

我正在尝试设置一个 KeyListener 来触发 KeyPressed 和 KeyReleased。

当我按住一个键时，如果在按下后立即触发则释放，例如，如果我按住一个键，我会从每个事件的打印语句中获得以下输出：

`Pressed Released Pressed Released Pressed Released Pressed Released`

这是我的 KeyListener

```
import java.awt.Dimension;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;

import javax.swing.JFrame;

public class EventListener extends JFrame implements KeyListener {

    public EventListener() {
        super();
        setSize(new Dimension(200, 300));
        addKeyListener(this);
        setVisible(true);

    }

    @Override
    public void keyTyped(KeyEvent e) {
    }

    @Override
    public void keyPressed(KeyEvent e) {
        System.out.println("Pressed");
    }

    @Override
    public void keyReleased(KeyEvent e) {
        System.out.println("Released");
    }

  } 
```

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T17:00:27.150

KeyEvent 是本地注册的。系统将发生变化。Windows 和 Mac 使用“中继器延迟”，它根据中继器数量每 n 毫秒重新发送一次 keyPressed 事件。Ubuntu 绕过了这一点，只是重新发送一个新事件，而不是重新发送同一个事件。

它应该对您的程序几乎没有影响，具体取决于发布时发生的情况。

# ruby-on-rails - 将电子邮件地址从参数传递到 Rails 3.2.11 中的模型方法

> ID：14753638
> 
> 赞同：0
> 
> 时间：2013-02-07T14:36:27.560
> 
> 标签：ruby-on-rails, methods

在以下代码中，如果 params[:email] 包含 @ 字符，则以下行 user = User.authenticate(params[:email], params[:password]) 得到“参数数量错误（0 表示 2）”。没有 @ 字符一切正常，我不知道如何解决它。

我尝试将电子邮件作为字符串发送，例如 user = User.authenticate("test@test.com", params[:password]) ，但没有收到错误消息。

有人可以帮忙吗？

我的代码：

控制器：

```
class SessionsController < ApplicationController  
  def new  
  end  

  def create  
    user = User.authenticate(params[:email], params[:password])  
    if user  
      session[:user_id] = user.id  
      redirect_to root_url, :notice => "Logged in!"  
    else  
      flash.now.alert = "Invalid email or password"  
      render "new"  
    end  
  end  
end 
```

模型：

```
class User < ActiveRecord::Base  
  attr_accessor :password  
  before_save :encrypt_password  

  validates_confirmation_of :password  
  validates_presence_of :password, :on => :create  
  validates_presence_of :email  
  validates_uniqueness_of :email  

  def encrypt_password  
    if password.present?  
      self.password_salt = BCrypt::Engine.generate_salt  
      self.password_hash = BCrypt::Engine.hash_secret(password, password_salt)  
    end  
  end  

  def self.authenticate(email, password)  
    user = find_by_email(email)  
    if user && user.password_hash == BCrypt::Engine.hash_secret ↵  
      (password, user.password_salt)  
       user  
    else  
       nil  
    end  
  end 
```

结尾

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:50:08.023

尝试：

```
User.authenticate(params[:email].to_s, params[:password]) 
```

这是因为您的电子邮件类型是字符串，并且您在方法中传递了一个哈希值。

# c# - 从 LDAP 确定给定 id 的 objectClass

> ID：14753642
> 
> 赞同：1
> 
> 时间：2013-02-07T14:36:40.680
> 
> 标签：c#, active-directory, ldap

获取给定 id 的 objectClass 名称的最佳方法是什么。

我的输入应该是“IDNSKF”我的输出应该是组或个人或计算机..

我使用以下代码，但有时`distinguishedName`我找不到`OU=Groups`虽然对象是组

代码：

```
DirectoryEntry de = new DirectoryEntry("LDAP://local.be");
        DirectorySearcher searcher = new DirectorySearcher(de);
        searcher.Filter = "(&(cn=variable))";
        searcher.SearchScope = SearchScope.Subtree;
        searcher.PropertiesToLoad.Add("distinguishedName");
        SearchResult result = searcher.FindOne();
        string s = result.GetDirectoryEntry().Properties["distinguishedName"].Value.ToString();
        if (s.IndexOf("OU=Groups") > -1)
            return Groups;
        if (s.IndexOf("OU=Users") > -1)
            return Users;
        if (s.IndexOf("OU=Computers") > -1)
            return Computer; 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T14:35:34.393

我想与您分享我找到的解决方案：

```
SearchResult result = directorySearcher.FindOne();
        if (result == null)
            return new LocalPermissionEntry(accessRule);

        ResultPropertyValueCollection userValueCollection = result.Properties["objectClass"];

        // check if the entry is a group or a user.
        if (userValueCollection.Contains("group"))
            return new GroupPermissionEntry(accessRule);
        if (userValueCollection.Contains("person") || userValueCollection.Contains("user"))
            return new UserPermissionEntry(accessRule);

        return new LocalPermissionEntry(accessRule); 
```

# c# - 使用 C# 制作自解压可执行文件

> ID：14753643
> 
> 赞同：8
> 
> 时间：2013-02-07T14:36:41.043
> 
> 标签：c#, windows, exe, archive

我正在使用幻数创建简单的自解压存档来标记内容的开头。现在它是一个文本文件：

> MAGICNUMBER .... 文本文件的内容

接下来，将文本文件复制到可执行文件的末尾：

> 复制programm.exe/b+textfile.txt/b sfx.exe

我正在尝试使用以下代码查找幻数的第二次出现（第一个显然是硬编码常量）：

```
 string my_filename = System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName;
    StreamReader file = new StreamReader(my_filename);
    const int block_size = 1024;
    const string magic = "MAGICNUMBER";
    char[] buffer = new Char[block_size];
    Int64 count = 0;
    Int64 glob_pos = 0;
    bool flag = false;
    while (file.ReadBlock(buffer, 0, block_size) > 0)
    {
        var rel_pos = buffer.ToString().IndexOf(magic);
        if ((rel_pos > -1) & (!flag))
        {
            flag = true;
            continue;
        }

        if ((rel_pos > -1) & (flag == true))
        {
            glob_pos = block_size * count + rel_pos;
            break;
        }
        count++;
    }

    using (FileStream fs = new FileStream(my_filename, FileMode.Open, FileAccess.Read))
    {
        byte[] b = new byte[fs.Length - glob_pos];
        fs.Seek(glob_pos, SeekOrigin.Begin);
        fs.Read(b, 0, (int)(fs.Length - glob_pos));
        File.WriteAllBytes("c:/output.txt", b); 
```

但由于某种原因，我复制了几乎整个文件，而不是最后的几千字节。是因为编译器优化，在类似的while循环中内联魔术常量吗？

我应该如何正确地进行自解压存档？

猜想我应该向后读取文件以避免编译器内联魔术常数乘法次数的问题。所以我通过以下方式修改了我的代码：

```
 string my_filename = System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName;
    StreamReader file = new StreamReader(my_filename);
    const int block_size = 1024;
    const string magic = "MAGIC";
    char[] buffer = new Char[block_size];
    Int64 count = 0;
    Int64 glob_pos = 0;
    while (file.ReadBlock(buffer, 0, block_size) > 0)
    {
        var rel_pos = buffer.ToString().IndexOf(magic);
        if (rel_pos > -1)
        {
            glob_pos = block_size * count + rel_pos;
        }
        count++;
    }

    using (FileStream fs = new FileStream(my_filename, FileMode.Open, FileAccess.Read))
    {
        byte[] b = new byte[fs.Length - glob_pos];
        fs.Seek(glob_pos, SeekOrigin.Begin);
        fs.Read(b, 0, (int)(fs.Length - glob_pos));
        File.WriteAllBytes("c:/output.txt", b);
    } 
```

所以我扫描了所有文件一次，发现我将是最后一次出现幻数并从这里复制到它的末尾。虽然此过程创建的文件似乎比以前的尝试小，但它绝不是我附加到我的“自解压”存档中的相同文件。为什么？

我的猜测是，由于使用了从二进制到字符串的转换，附件开头的位置计算是错误的。如果是这样，我应该如何修改我的头寸计算以使其正确？

另外我应该如何选择幻数然后使用真实文件，例如pdf？我将无法轻松修改 pdf 以在其中包含预定义的幻数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:12:48.343

试试这个。一些 C# 流 IO 101：

```
 public static void Main()
    {
        String path = @"c:\here is your path";

        // Method A: Read all information into a Byte Stream
        Byte[] data = System.IO.File.ReadAllBytes(path);
        String[] lines = System.IO.File.ReadAllLines(path);

        // Method B: Use a stream to do essentially the same thing. (More powerful)
        // Using block essentially means 'close when we're done'. See 'using block' or 'IDisposable'.
        using (FileStream stream = File.OpenRead(path))
        using (StreamReader reader = new StreamReader(stream))
        {
            // This will read all the data as a single string
            String allData = reader.ReadToEnd();
        }

        String outputPath = @"C:\where I'm writing to";

        // Copy from one file-stream to another
        using (FileStream inputStream = File.OpenRead(path))
        using (FileStream outputStream = File.Create(outputPath))
        {
            inputStream.CopyTo(outputStream);

            // Again, this will close both streams when done.
        }

        // Copy to an in-memory stream
        using (FileStream inputStream = File.OpenRead(path))
        using (MemoryStream outputStream = new MemoryStream())
        {
            inputStream.CopyTo(outputStream);

            // Again, this will close both streams when done.
            // If you want to hold the data in memory, just don't wrap your 
            // memory stream in a using block.
        }

        // Use serialization to store data.
        var serializer = new System.Runtime.Serialization.Formatters.Binary.BinaryFormatter();

        // We'll serialize a person to the memory stream.
        MemoryStream memoryStream = new MemoryStream();
        serializer.Serialize(memoryStream, new Person() { Name = "Sam", Age = 20 });

        // Now the person is stored in the memory stream (just as easy to write to disk using a 
        // file stream as well.

        // Now lets reset the stream to the beginning:
        memoryStream.Seek(0, SeekOrigin.Begin);

        // And deserialize the person
        Person deserializedPerson = (Person)serializer.Deserialize(memoryStream);

        Console.WriteLine(deserializedPerson.Name); // Should print Sam

    }

    // Mark Serializable stuff as serializable.
    // This means that C# will automatically format this to be put in a stream
    [Serializable]
    class Person
    {
        public String Name { get; set; }
        public Int32 Age { get; set; }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T15:48:27.600

您可以将压缩文件作为资源添加到项目本身：

*项目 > 属性*
![在此处输入图像描述](../Images/a89a66f10e326394ef1cb6f706358d3c.png)

将此资源的属性设置为`Binary`。

然后，您可以使用检索资源

```
byte[] resource = Properties.Resources.NameOfYourResource; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-10T21:47:43.623

最简单的解决方法是更换

```
const string magic = "MAGICNUMBER"; 
```

和

```
static string magic = "magicnumber".ToUpper(); 
```

但是整个魔术串方法存在更多问题。包含魔术字符串的文件是什么？我认为最好的解决方案是将文件大小放在文件之后。这样提取要容易得多：从最后一个字节读取长度并从文件末尾读取所需的字节数。

**更新**：除非您的文件很大，否则这应该可以工作。（在这种情况下，您需要使用一对循环缓冲区（以小块读取文件））：

```
string inputFilename = System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName;
string outputFilename = inputFilename + ".secret";
string magic = "magic".ToUpper();

byte[] data = File.ReadAllBytes(inputFilename);
byte[] magicData = Encoding.ASCII.GetBytes(magic);

for (int idx = magicData.Length - 1; idx < data.Length; idx++) {
    bool found = true;
    for (int magicIdx = 0; magicIdx < magicData.Length; magicIdx++) {
        if (data[idx - magicData.Length + 1 + magicIdx] != magicData[magicIdx]) {
            found = false;
            break;
        }
    }
    if (found) {
        using (FileStream output = new FileStream(outputFilename, FileMode.Create)) {
            output.Write(data, idx + 1, data.Length - idx - 1);
        }
    }
} 
```

**Update2**：这应该更快，使用很少的内存并处理各种大小的文件，但是您的程序必须是正确的可执行文件（大小是 512 字节的倍数）：

```
string inputFilename = System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName;
string outputFilename = inputFilename + ".secret";
string marker = "magic".ToUpper();

byte[] data = File.ReadAllBytes(inputFilename);
byte[] markerData = Encoding.ASCII.GetBytes(marker);
int markerLength = markerData.Length;

const int blockSize = 512; //important!

using(FileStream input = File.OpenRead(inputFilename)) {
    long lastPosition = 0;
    byte[] buffer = new byte[blockSize];
    while (input.Read(buffer, 0, blockSize) >= markerLength) {
        bool found = true;
        for (int idx = 0; idx < markerLength; idx++) {
            if (buffer[idx] != markerData[idx]) {
                found = false;
                break;
            }
        }
        if (found) {
            input.Position = lastPosition + markerLength;
            using (FileStream output = File.OpenWrite(outputFilename)) {
                input.CopyTo(output);
            }
        }
        lastPosition = input.Position;
    }
} 
```

在此处阅读一些方法：http: [//www.strchr.com/creating_self-extracting_executables](http://www.strchr.com/creating_self-extracting_executables)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-12T15:26:23.540

向后而不是向前搜索（假设您的文件不包含所述幻数）。

或附加您的（文本）文件，最后附加它的长度（或原始 exe 的长度），因此您只需要读取最后一个 DWORD /几个字节即可查看文件的长度 - 然后不需要幻数。

更可靠的是，将文件作为附加数据部分存储在可执行文件中。这在没有外部工具的情况下更加繁琐，因为它需要了解用于 NT 可执行文件的 PE 文件格式，qv [http://msdn.microsoft.com/en-us/library/ms809762.aspx](http://msdn.microsoft.com/en-us/library/ms809762.aspx)

# c - C 中的数组传递

> ID：14753648
> 
> 赞同：0
> 
> 时间：2013-02-07T14:36:47.233
> 
> 标签：c

我在将数组传递给 C 中的函数时遇到问题。我在 main 中声明了数组

然后，在一个函数内部，我填充它。

此时我离开我的函数并将数组传递给带有原型的另一个函数

并尝试访问该数组。

但是，一旦我退出填充数组的初始函数，我将无法访问该数组。它只返回 0.00000 和 nan 的值。

```
void ReadData(FILE *fpIn, int lines, double *pA );
void MinMaxAvg(double *pA, double *min, double *max, double *avg, int lines);

int main()
{
    FILE *fpIn = NULL;

    int lines = 0;

    double *pA = NULL;

    ReadData(fpIn, lines, pA);

    double min = 0;
    double max = 0;
    double avg = 0;

    MinMaxAvg(pA, &min, &max, &avg, lines);

    printf("%lf %s %lf %s %lf \n", avg, " ", min, " ", max);

    return 0;
}   

void ReadData(FILE *fpIn, int lines, double *pA )
{
    char fName[20];
    scanf( "%s", fName);

    fpIn = fopen ( fName, "rt");
// fpIn = fopen( "test1.txt", "rt");

    if ( fpIn == NULL)
    {
        printf( "Unable to open: ");
        exit(99);
    }

//Gets Lines

//int lines=0;
    char ch;

    while((ch=fgetc(fpIn))!=EOF)
    {
        if (ch=='\n') { lines++; }

    }

// clearerr(fName *fpIn);
    fclose(fpIn);
    fopen(fName, "rt");

//Makes Array

//double *pA;

    pA = (double *)malloc(lines*sizeof(double));

//Fills Array

    for (int i=0; i<lines; i++)
    {
        fscanf(fpIn, "%lf", &pA[i]);
    }

    for (int i=0; i<lines; i++)
    {
        printf("%lf \n", pA[i]);
    }
}

void MinMaxAvg(double *pA, double *min, double *max, double *avg, int lines)
{
    double total = 0;

    for (int i=0; i<lines; i++)
    {
        if ( i==0)
        {
            *min = pA[0];
            *max = pA[0];
        }
        else
        {
            if (pA[i] < *min)
            {
                *min = pA[i];
            }

            if (pA[i] > *max)
            {
                *max = pA[i];
            }
        }

        total += pA[i];

    }

    *avg = (total / (double)lines);

} 
```

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T15:05:47.017

您将文件中的行数计算到函数 ReadData() 中的局部变量“lines”中，但这并不意味着它被传递回 main。传递给 MinMaxAvg() 的“lines”变量值为零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:56:50.193

我刚刚测试了你的代码，它可以工作。我所做的唯一区别是 fscanf 中的标准输入，并且包括了 max、min、avg 和 lines。

```
#include <stdio.h>
#include <stdlib.h>

void MinMaxAvg(double *pA, double *min, double *max, double *avg, int lines)
{
    double total = 0;

    for (int i=0; i<lines; i++)
    {
    if ( i==0)
    {
        *min = pA[0];
        *max = pA[0];
    }
    else
    {
        if (pA[i] < *min)
        {
        *min = pA[i];
        }

        if (pA[i] > *max)
        {
        *max = pA[i];
        }
    }

    total += pA[i];

    }

    *avg = (total / (double)lines);

return;
}

int main(int argc, char** argv)
{
    double *pA = NULL;

    int lines = 3;

    double min,max,avg;

    pA = (double *)malloc(lines*sizeof(double));

    //Fills Array

    for (int i=0; i<lines; i++)
    {
        fscanf(stdin, "%lf", &pA[i]);
    }

     MinMaxAvg( pA, &min, &max, &avg,  lines);

    for (int i=0; i<lines; i++)
    {
        printf("%lf \n", pA[i]);
    }

    printf( "min: %f  max: %f  avg: %f" , min , max , avg );
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-07T15:11:37.640

根据您的问题，如果您在函数中填充 pA，我怀疑您没有更改 pA 的内容，这可能是问题所在。查看您用于填充 pA 的例程可能会有所帮助/有用。

C函数按值调用，如果你只是传入一个指针（只是pA），要更改指针的值，你需要传递指针的地址（如果你愿意，指针指向一个指针）。然后你需要服从一次它来设置指针（指向指针），然后服从它两次来设置分配的内存/数组中的值。

所以对函数的调用是

```
void init(File *fpin, double **pA, int lines)
{
  /* Deference once to set the pointer to the pitner */
  *pA = (double *)malloc(lines*sizeof(double));

  for (int i=0; i<lines; i++)
  {
     /* deference twice to set the the element of the pointer to the pointer */
     fscanf(fpIn, "%lf", &(**pA)[i]);
  }
} 
```

然后在调用例程时，需要传入 pA 的地址。

```
init(fpIn,&pA,lines); 
```

这是一个可能有助于解释指向指针的链接： [http ://www.thegeekstuff.com/2012/01/advanced-c-pointers/](http://www.thegeekstuff.com/2012/01/advanced-c-pointers/)

好久没有做指针的指针了，但是如果你使用上面的，你可能需要做一些小的改动。

正如 larsmans 暗示的那样，我喜欢他的建议，即更改例程以将指针返回到您分配的内存并将该值放在 pA 中。

```
double* init(File *fpin, int lines)
{
  double *local = (double *)malloc(lines*sizeof(double));

  //Fills Array

  for (int i=0; i<lines; i++)
  {
    fscanf(fpIn, "%lf", &local[i]);
  }

  return(local); 
```

}

然后在调用init

```
pA = init(fpIn,lines); 
```

根据您要完成的工作，这可能更容易理解并且没有那么复杂。

# cakephp - CakePHP testAction 没有正确使用资源路由

> ID：14753649
> 
> 赞同：1
> 
> 时间：2013-02-07T14:36:47.013
> 
> 标签：cakephp, testing, routes

目前我正在为我的应用程序的一部分编写控制器测试（使用 CakePHP 2.3.0 Stable）。我对**testAction()**方法的 URL 有一个奇怪的问题。

以下作品：

```
$this->testAction('/users/index'); 
```

这不会：

```
$this->testAction('/users'); 
```

如果我不添加确切的控制器操作，我会收到以下错误：

```
Undefined index: users
Test case: UsersControllerTest(testIndex) 
```

所有的路线都是通过

```
Router::mapResources('users'); 
```

奇怪的是，在浏览器中调用**/users**效果很好。我在测试我的 API 时遇到了同样的问题。在浏览器中调用**/users.json**有效，而测试则无效。

目前我使用**/users/index.json**使测试通过，但必须有更好的方法。

提前致谢！

# logging - NLog 自定义 LayoutRenderer 不工作

> ID：14753652
> 
> 赞同：2
> 
> 时间：2013-02-07T14:36:51.930
> 
> 标签：logging, error-handling, nlog

我在通用程序集中`LayoutRenderer`定义了如下自定义：`NLog`

```
[LayoutRenderer("appsettings")]
public class AppSettingsLayoutRenderer : LayoutRenderer {
    [DefaultParameter]
    public string Variable {
        get;
        set;
    }

    protected override void Append(StringBuilder builder, LogEventInfo logEvent) {
        if (Variable == null) {
            return;
        }

        var context = HttpContext.Current;

        if (context == null) {
            return;
        }

        builder.Append(Convert.ToString(ConfigurationManager.AppSettings[Variable], CultureInfo.InvariantCulture));
    }
} 
```

这个通用程序集在我实现日志记录的 2 个项目中被引用。

第一个项目是一个 ASP.NET/ASP.NET MVC 网站并配置为顶级网站。

第二个项目是一个 WCF 项目，在 IIS 下托管多个服务，并配置为另一个网站（IIS 中的默认网站）下的虚拟目录。

两者都包含以下内容`Web.config`：

```
<appSettings>
  <add key="ErrorLogPath" value="D:\Logs" />
</appSettings> 
```

这两个项目都引用了公共程序集（其中包含客户`LayoutRenderer`）。我已经验证这`bin`两个项目的文件夹实际上也包含程序集 DLL。我通过 IIS 中配置的路径确认了这一点。

`NLog.config`最后，两个项目在文件旁边都包含以下`Web.config`文件：

```
<?xml version="1.0" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <extensions>
    <add assembly="Collective.Core" />
  </extensions>

  <targets>
    <target name="file" xsi:type="File" layout="${longdate}|${level:uppercase=true}|${logger}|${message}${onexception:inner=${newline}${exception:format=tostring}}" fileName="${appsettings:ErrorLogPath}\${logger}\${shortdate}.log" />
  </targets>

  <rules>
    <logger name="*" minlevel="Debug" writeTo="file" />
  </rules>
</nlog> 
```

两个项目都在同一个应用程序池下运行。

现在，我的问题：

对于第一个项目，日志出现在正确的位置，即`D:\Logs\Logger.Name\yyyy-MM-dd.log`.

第二，日志出现在`C:\Logger.Name\yyyy-MM-dd.log`.

这是怎么回事？配置和启用代码是相同的，但日志始终出现在 2 个不同的位置，一个是有意的，另一个是无意的。

对于我的生活，我无法理解发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T08:33:39.233

您在项目中会得到不同的结果，因为在 WCF`HttpContext.Current` **中总是`null`**...

来自[MSDN](http://msdn.microsoft.com/en-us/library/aa702682.aspx)：

> HttpContext：从 WCF 服务中访问时，Current 始终为 null。请改用 RequestContext。

因为你的

```
if (context == null) {
    return;
} 
```

声明你`builder.Append`不会被调用...所以 NLog 默认为基本`LayoutRenderer`行为。

# django - 当我使用中间模型时，如何建立强制唯一性的多对多关系？

> ID：14753654
> 
> 赞同：6
> 
> 时间：2013-02-07T14:36:56.437
> 
> 标签：django, many-to-many, tastypie, relation

我使用中间模型“使用通过的ManyToManyField”
通常，如果我不使用中间字段，则m2m关系将是唯一的并且不能有重复的数据。

在我使用中间模型之后。m2m之间的关系可以有相同的数据。像这样

```
|    |    ['0'] (
|    |    |    addToProfile => Array (0)
|    |    |    (
|    |    |    )
|    |    |    endDate =  NULL
|    |    |    feedType =  "N"
|    |    |    id =  1
|    |    |    info =  "Big Kuy No Fear"
|    |    |    likeMaker => Array (3)
|    |    |    (
|    |    |    |    ['0'] =  "/api/v2/user/2/"
|    |    |    |    ['1'] =  "/api/v2/user/2/"
|    |    |    |    ['2'] =  "/api/v2/user/2/"
|    |    |    )
|    |    |    like_count =  "3" 
```

我正在建立一个社交网络。所以这是我的 feed 对象，它有 3 `like_count`s 。但是这三个来自同一个用户“/api/v2/user/2/”

我尝试在 m2m 字段中添加“unique=True”属性，但 django 出现错误，因为它最初没有授予将“unique”属性添加到 m2m 字段的权限。谁能帮我？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-07T14:58:11.150

尝试在中间模型中使用[unique_together 。](https://docs.djangoproject.com/en/1.4/ref/models/options/#unique-together)

```
class M2MModel(models.Model):
    field1 = models.ForeignKey(Model1)
    field2 = models.ForeignKey(Model2)

    class Meta:
        unique_together = ('field1', 'field2') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-08T19:34:40.527

unique_together 不适用于 M2M 关系。[更多信息](https://code.djangoproject.com/ticket/702)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T18:21:49.333

我刚刚完成了一个与您的要求非常相似的功能，但我的选择是使用另一个简单模型作为中间模型。

这是我的代码。

```
class Vote(models.Model):
    class Meta:
        unique_together = ['content', 'by']

    content = models.ForeignKey(Content)
    by = models.ForeignKey(User) 
```

就我而言，我认为实现 ManyToManyField 没有任何好处。

**更新**：我刚刚从[这里](https://code.djangoproject.com/ticket/702#comment:13)发现 Django 不会为 ManyToManyField 一起创建任何内置的唯一性。您必须实施自己的验证以使其独一无二。

# javascript - 两个淡入淡出切换效果之间的jQuery延迟

> ID：14753655
> 
> 赞同：1
> 
> 时间：2013-02-07T14:36:58.247
> 
> 标签：javascript, jquery, html, toggle

我正在使用显示和显示两个 div`Jquery`

代码是

```
var show_hide = function () {
    $("#extravagents_label").fadeToggle(function () {
        $("#liquid.liquidContanier").fadeToggle().delay(1500);
    });
}

setInterval(show_hide, 1500); 
```

但有问题。它没有正确地完成工作。当一个完全隐藏时，它应该显示另一个 div。请访问**203.81.193.2/jsvt/**。在显示和隐藏的主滑块下有图标和文本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:44:02.667

你应该小心时机，`setInterval`它可能会把事情搞得一团糟。

如果时间有问题：

```
var show_hide = function () {
    $("#extravagents_label").fadeToggle(callblack);
}

var callblack = function () {
    $("#liquid.liquidContanier").fadeToggle()
        .delay(1500).queue(show_hide);
} 
```

希望这会有所帮助，仍然不确定你在追求什么

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T14:48:40.813

试试这个：

**jQuery** :

```
function show_hide() {
 $('#extravagents_label').delay(1000).fadeOut(1000).delay(1000).fadeIn(1000);
 $("#liquid .liquidContanier").delay(1000).fadeIn(1000).delay(1000).fadeOut(1000);
   //don't forgot to use space between id and it's child class
}

setInterval(show_hide,4000);
           //this timing should be total timing values of the show_hide function 
```

猜测你的**CSS**应该是这样的：

```
#extravagents_label { display:block; }
#liquid .liquidContanier { display:none; } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-07T14:49:14.717

我为您制作了一个[jsfiddle](http://jsfiddle.net/pTbzd/)，它稍微修改了您的代码。基本上，您的间隔每 1.5 秒触发一次，同时您还延迟了第二个元素上的 fadeToggle。因为您无法计算 jQuery 将元素淡入和淡出需要多长时间，所以回调会为您处理它。

```
var show_hide = function () {
    $("#extravagents_label").fadeToggle(function () {
        $(this).fadeToggle();
        $("#liquid.liquidContanier").fadeToggle(function () {
            $(this).fadeToggle();
            show_hide();
        });
    });
}

setTimeout(show_hide, 1500); 
```

# php - PHP echo 无法按预期工作

> ID：14753656
> 
> 赞同：3
> 
> 时间：2013-02-07T14:36:59.263
> 
> 标签：php, echo

我有以下 PHP 代码：

```
$ep1 = $tvdb->getEpisodeById($cur->id, 'en');
var_dump($ep1); 
```

它返回这个：

```
object(TvDb\Episode)#60 (17) {
    ["id"]=> int(4490826)
    ["number"]=> int(12)
    ["season"]=>      int(3)
    ["directors"]=> array(0) { }
    ["guestStars"]=> array(0) { }        
    ["writers"]=> array(0) { }
    ["name"]=> string(11) "Episode 312"
    ["firstAired"]=> object(DateTime)#57 (3) {
        ["date"]=> string(19) "2013-04-07 00:00:00"
        ["timezone_type"]=> int(3)
        ["timezone"]=> string(12) "Europe/Sofia"
    }
    ["imdbId"]=> string(0) ""
    ["language"]=> string(2) "en"
    ["overview"]=> string(0) ""
    ["rating"]=> string(1) "0"
    ["ratingCount"]=> int(0)
    ["lastUpdated"]=> object(DateTime)#3 (3) {
        ["date"]=> string(19) "2013-01-30 22:15:41"
        ["timezone_type"]=> int(1)
        ["timezone"]=> string(6) "+00:00"
    }
    ["seasonId"]=> int(501077)
    ["serieId"]=> int(161511)
    ["thumbnail"]=> string(0) ""
} 
```

我想回显“日期”并写下以下内容：

```
$ep1 = $tvdb->getEpisodeById($cur->id, 'en');
echo ($ep1->firstAired->date); 
```

它什么也不返回，但是当我这样做时：

```
$ep1 = $tvdb->getEpisodeById($cur->id, 'en');
var_dump($ep1);
echo ($ep1->firstAired->date); 
```

在转储之后，日期显示：

```
object(TvDb\Episode)#60 (17) { ["id"]=> int(4490826) ["number"]=> int(12) ["season"]=> int(3) ["directors"]=> array(0) { } ["guestStars"]=> array(0) { } ["writers"]=> array(0) { } ["name"]=> string(11) "Episode 312" ["firstAired"]=> object(DateTime)#57 (3) { ["date"]=> string(19) "2013-04-07 00:00:00" ["timezone_type"]=> int(3) ["timezone"]=> string(12) "Europe/Sofia" } ["imdbId"]=> string(0) "" ["language"]=> string(2) "en" ["overview"]=> string(0) "" ["rating"]=> string(1) "0" ["ratingCount"]=> int(0) ["lastUpdated"]=> object(DateTime)#3 (3) { ["date"]=> string(19) "2013-01-30 22:15:41" ["timezone_type"]=> int(1) ["timezone"]=> string(6) "+00:00" } ["seasonId"]=> int(501077) ["serieId"]=> int(161511) ["thumbnail"]=> string(0) "" } 2013-04-07 00:00:0 
```

我没有这个问题：

```
$ep1 = $tvdb->getEpisodeById($cur->id, 'en');
echo ($ep1->name); 
```

我希望我足够清楚，如果这是一个愚蠢的问题，我很抱歉。感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:46:08.540

属性`$ep1->firstAired`是一个`DateTime`对象。您无法像尝试那样直接访问它的属性。您必须使用访问器方法，例如`format()`

```
 echo $ep1->firstAired->format('Y-m-d H:i:s'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:58:40.420

事实上，这真的，真的很奇怪，至少对我来说。一开始我测试只是回显日期属性，就像你做的那样，但它不起作用，然后我决定添加一个 print_r 来查看属性......然后我可以打印出日期字符串。

这是我的代码：

```
$d = new DateTime();
print_r($d);
echo $d->timezone  . PHP_EOL;
echo $d->date  . PHP_EOL; 
```

并且这样做很好，但是我删除`print_r`它不起作用的行。

我的系统是在 shell 中运行 php 5.3 的 windows 8，这是我的证明：

![又一个 PHP 特性。](../Images/72915e6223a173631a8c0668425ea4fc.png)

所以你可以说你可以做到这一点，你只需要先做一个 print_r，它可能不适用于所有系统。:D

# php - PHP 超复杂关联数组解析为 HTML 表格格式

> ID：14753662
> 
> 赞同：0
> 
> 时间：2013-02-07T14:37:16.077
> 
> 标签：php, foreach, associative-array

我试图弄清楚如何解析我从数据库数据构建的关联数组，以便我可以生成我正在寻找的 html 表格布局。

关联数组结构如下：

```
Array
(
  [2013] => Array
    (
        [1] => Array
            (
                [Total] => Array
                    (
                        [validleads] => 7327
                        [conversions] => 9856
                        [bookings] => 2449
                    )
                    ... more types for this week
                 [PPC] => Array
                    (
                        [validleads] => 884
                        [conversions] => 1109
                        [bookings] => 605
                    )
            )
          .. more weeks for 2013
    )
  [2012] => Array
    (
        [1] => Array
            (
                [Total] => Array
                    (
                        [validleads] => 9423
                        [conversions] => 12459
                        [bookings] => 2629
                    )
                [PPC] => Array
                    (
                        [validleads] => 955
                        [conversions] => 1237
                        [bookings] => 601
                    )
    )
) 
```

因此，有一个全局数组`$data`（

理想的表结构是

```
| Week | Total 2013 | Total 2012 | PPC 2013 | % PPC 2013  |  PPC 2012  | % PPC 2012 |  Other types 2013  | % Other types 2013 | Other types 2012 | % Other types 2012  
|  01  |    7327    |    9423    |   884    |   12.06%    |    955     |    10.13%  |                    |                    |                  | 
```

这些百分比只是通过将一年中那一周的数字除以一年中那一周的总数乘以 100 得出的。

我要生成的表格布局是一年中每周生成一个表格行，其中包含每年该周的总数以及每年该周每种类型的总数以及该总数占总总数的百分比那年的一周....

对不起，如果这很复杂......

问题是我只是想不出如何以 HTML 表格格式生成我想要的东西。

我知道有些`foreach`是必需的，但就我所知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:47:18.553

像这样的东西你需要做一些工作，基本上你必须以不同的方式布置你的桌子才能让它工作/看起来正确，但应该是可行的。下面的代码并不完美，但希望能帮助您解决问题。

```
for ($i=0;$i<count($data);$i++) {
     //initial loop for year
    echo "Year = ".$data[$i]."<br />";
     for ($z=0;$z<count($data[$i]);$z++) {
     //secondary loop for year
     echo "Week =".$data[$i][$z]."<br />";
     //no need to loop through final array if its always jsut total and ppc if its variable on the final loop another for will be needed though
    echo "Totals: ".$data[$i][$z]['Total']['validleads']." etc etc";
    echo "Totals: ".$data[$i][$z]['PPC']['validleads']." etc etc";

    }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-25T13:37:51.013

我尝试使用多个 foreach 打印您的数组，它没有按照您的要求执行，但它会给您一些想法，如何使用 foreach 解析数组请看一下

`foreach($complexArray as $k =>$v) { echo $k."=>"; foreach($v as $kx=> $vx) { echo $kx."=> "; foreach($vx as $ky =>$vy) { echo $ky.":=> "; foreach($vy as $kz =>$vz) { echo $kz."=>".$vz."<br>"; } }`

```
 } 
```

}

# count - CLOC 没有正确计算 actionscript 文件

> ID：14753668
> 
> 赞同：0
> 
> 时间：2013-02-07T13:40:06.763
> 
> 标签：count

当我在 Actionscript 项目文件夹上使用[CLOC](http://cloc.sourceforge.net/)时，行数似乎有问题。对于这个项目，我希望有几千行代码，但我得到了这个：

```
 27 text files.
      27 unique files.                              
Using temp dir [/var/folders/Iv/IvtpxxljEvmq44ihKLV3UU+++TI/-Tmp-/I2_EYvn0vb] \
 to install Regexp::Common
       1 file ignored.

http://cloc.sourceforge.net v 1.56  T=0.5 s (52.0 files/s, 296.0 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
ActionScript                    26             38             26             84
-------------------------------------------------------------------------------
SUM:                            26             38             26             84
------------------------------------------------------------------------------- 
```

因此，我浏览到下载的 Actionscript 3D 库的文件夹，并在那里执行了相同的命令，它似乎计算得很好。

此外，该工具似乎可以很好地计算我的 PHP 或 JavaScript，但不是 Actionscript。

我尝试了不同的选项，但似乎无法弄清楚为什么它不能正确计数。从外观上看，它对每个文件计算一条评论（文件数和计算的文件名都可以），这让我想知道检测评论的方式是否有问题，或者换行符。（这里是 Mac OS X，文件都是 unicode 格式。）

有人有想法吗？

* * *

我还制作了一个文件来测试计数，仅此一项就可以正常工作：

```
/**
 * a description
 */
package com.foo.bar {

    public class Foobar {

        // really no, this is a comment
        private var lorem:String = "ipsum";

        /**
         * OMG, it's a constructor
         */
        public function Foobar() {

        }

        private function ladida():Boolean {
            // yes, genius
            return true;
        }

    }

} 
```

使用 CLOC 跟踪到控制台：

```
http://cloc.sourceforge.net v 1.56  T=0.5 s (2.0 files/s, 50.0 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
ActionScript                     1              7              8             10
------------------------------------------------------------------------------- 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T07:40:49.070

在比较单个文件而不是整个目录的 CLOC 结果时，我注意到有些文件会算得很好，而其他文件会算作单行。

经过尝试，我发现行数错误的文件将行结尾设置为`Mac OS 9`- 将行结尾设置为`Unix`或`Windows`在我的编辑器中解决了所有问题，并且计数是正确的。

这让我很吃惊，为什么我的编辑器会默认使用`Max OS 9`行尾，以及为什么它只针对某种文件类型（.as 文件）这样做，但这似乎是原因。

如果由于那些错误的行结尾而只有一个文件无法正确计算，则整个项目的计数可能会被取消。

# bash - bash中的字符串比较（结构化文本）

> ID：14753675
> 
> 赞同：-1
> 
> 时间：2013-02-07T14:37:43.313
> 
> 标签：bash, awk, comparison, compare, diff

我需要比较具有以下结构的两个文件（new.txt 和 old.txt）：

```
 <Field1>,<Field2>,<Field3>,<Field4>,<Field5>,<Field6> 
```

1.  **必须**跳过公共行。
2.  应将 new.txt 和 old.txt 中的类似行分组。如果 Field1、Field2、Field3、Field4 相同，我认为 old.txt 中的行与 new.txt 中的行相似。
3.  其他独特的行应按**文件名分组打印在下面**

**所以最终的任务是让视觉比较更容易。**

**添加部分：** 示例。

```
$ cat old.txt 
 one,two,three,four,five,six
 un,deux,trois,quatre,cinq,six
 eins, zwei, drei, vier, fünf, sechs
$ cat new.txt 
 one,two,three,four,FIVE,SIX
 un,deux,trois,quatre,cinq,six
 en,två,tre,fyra,fem,sex

$cat comparison_result:
# lines are grouped. So it it easy to find the difference without scrolling.
old.txt> one,two,three,four,five,six
new.txt> one,two,three,four,FIVE,SIX
# end of task 2\. There are no more simillar lines.
#
#start task 3.
#Printing all the rest unique lines of old.txt 
echo "the rest unique line in old.txt"
eins, zwei, drei, vier, fünf, sechs
.... 
#Printing all the rest unique lines of new.txt
echo "the rest unique line in new.txt"
en,två,tre,fyra,fem,sex 
```

**这可以是第 1 步：跳过常用行。**

```
 # This is only in old.txt
 comm -2 -3 <(sort old.txt) <(sort new.txt) > uniq_old

 # This is only in new.txt
 comm -1 -3 <(sort old.txt) <(sort new.txt) > uniq_new 
```

我写了第 1 步，并将这个排序的差异作为临时解决方案：

```
 # additional sort improves a bit diffs results.
 diff <(sort uniq_old) <(sort uniq_new) 
```

它正在工作，但并不理想。我拒绝使用 diff，因为它开始比较块，缺少公共行。

有没有更好的方法来满足上面写的 3 个要求？

我认为可以通过

1.  对这种排序、diff 和 comm 命令进行了一些改进（将 sed/tr 添加到临时“隐藏”最后两个文件并比较其余文件）。
2.  awk

我想awk可以做得更好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T18:46:29.240

那这个呢？

```
awk -F, 'NR==FNR{old[$0];next} $0 in old{delete old[$0];next} 1 END{for(line in old) print line}' old.txt <(sort -u new.txt) | sort 
```

让我们把它分解成几部分。

*   `-F,`告诉 awk 使用 a`,`作为字段分隔符。
*   `NR==FNR{old[$0];next}`- 如果 NR（记录/行号）与当前文件中的行号匹配（即，当我们读取第*一个*输入文件时），将整行存储为关联数组的索引，然后跳转到下一个记录。
*   `$0 in old{delete old[$0];next}`- 现在我们正在读取*第二个*文件。如果当前行在数组中，则从数组中删除 if 并继续。您问题中的此地址条件＃1。
*   `1`- awk 中“打印行”的简写。这通过打印第二个文件中的唯一行来解决您问题中的条件 #3 的一部分。
*   `END{...}`- 此循环打印未从数组中删除的所有内容。这通过打印第一个文件中的唯一行来解决条件 #3 的另一部分。
*   `<(sort -u new.txt)`- 唯一的 new.txt 的输入。如果您知道 new.txt 已经是唯一的，则可以删除此 bash 依赖项。
*   `| sort`对输出进行排序，根据问题中的条件 #2 “分组”事物。

样本输出：

```
 $ cat old.txt 
 one,two,three,four,five,six
 un,deux,trois,quatre,cinq,six
 $ cat new.txt 
 one,two,three,four,FIVE,SIX
 un,deux,trois,quatre,cinq,six
 en,två,tre,fyra,fem,sex
 $ awk -F, 'NR==FNR{old[$0];next} $0 in old{delete old[$0];next} 1 END{for(line in old) print line}' old.txt new.txt | sort
 en,två,tre,fyra,fem,sex
 one,two,three,four,FIVE,SIX
 one,two,three,four,five,six
 $ 
```

请注意，法语中的行是重复的，因此被删除了。其他所有内容都已打印，两条英文行通过排序“分组”。

另请注意，此解决方案会受到非常大的文件的影响，因为所有 old.txt 都作为数组加载到内存中。可能对您有用的替代方法是：

```
 $ sort old.txt new.txt | awk '$0==last{last="";next} last{print last} {last=$0} END{print last}' | sort
 en,tva,tre,fyra,fem,sex
 one,two,three,four,FIVE,SIX
 one,two,three,four,five,six
 $ 
```

这里的想法是您只需从文件中获取所有输入数据，对其进行排序，然后使用 awk 脚本跳过重复的行，然后打印所有其他数据。然后对输出进行排序。就 awk 而言，这适用于流，但请注意，对于非常大的输入，您的`sort`命令仍需要将数据加载到内存和/或临时文件中。

同样，如果特定行重复多次，则第二个解决方案将失败。也就是说，如果它在 old.txt 中存在一次，在 new.txt 中存在两次。您需要使输入文件独一无二，或针对这种情况调整脚本。

# boost - 当包含 boost/property_tree/ptree.hpp 文件时

> ID：14753676
> 
> 赞同：1
> 
> 时间：2013-02-07T14:37:44.533
> 
> 标签：boost

我怎样才能找到上面的文件**boost/property_tree/ptree.hpp**何时（哪个版本）包含在**Boost**中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-30T10:12:53.120

通常，各个库没有独立版本。应该改用相关的增强版本。

可以在编译时检查 BOOST_VERSION 宏以确定 boost 的版本，并通过关联属性树库的版本[。](http://www.boost.org/doc/libs/1_54_0/libs/config/doc/html/boost_config/boost_macro_reference.html)

# vb6 - VB6 编辑器显示重音字符都与错误的代码页混在一起

> ID：14753693
> 
> 赞同：0
> 
> 时间：2013-02-07T14:38:32.270
> 
> 标签：vb6

在下面的图片中，我的 VB 显示了那些特殊字符，而不是 ÉÉâââ。

![VB6截图](../Images/011f806452ec91ceda5cacf01e13e289.png)

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:15:52.003

我一开始没有想到！如果我更改“编辑器格式选项”中的字体，它可以解决我的问题。 ![工具-选项-编辑器格式](../Images/d760830da56c304402c5cef76310cd57.png)

# c - 在C中合并两个数组

> ID：14753708
> 
> 赞同：0
> 
> 时间：2013-02-07T14:39:13.173
> 
> 标签：c, arrays

如果我有两个数组，

```
A= [2,3,4] and B=[8,9,10]. 
```

我怎样才能合并这两个数组。

```
Solution C=[2,3,4,8,9,10] 
```

请指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:42:05.693

1.  为 A 和 B 都足够大的数组分配空间
2.  从 A 复制所有元素
3.  从 B 复制所有元素

如果您的意思是合并并保留某种顺序，则遍历 A 和 B 同时将下一个相关（取决于您的排序标准）值复制到新数组中的下一个插槽中。

# ruby - 我的 Ruby 测试无法运行

> ID：14753710
> 
> 赞同：0
> 
> 时间：2013-02-07T14:39:14.627
> 
> 标签：ruby

每隔一段时间，我就会启动使用 zsh 的 iTerm 2 来编写教程。有时，当我尝试运行我的 Ruby 测试时，它们没有运行。没有任何东西被退回。该过程永远不会运行，我必须 ctrl+C 才能摆脱它。

这是我运行的命令：

```
ruby -I test/unit/name_of_test.rb 
```

这发生在我所有的测试中。有时我只需要重新启动计算机。有任何想法吗？

我也尝试过使用终端，它也在使用 zsh。

我在 OS X 上，使用 Ruby 1.9.3 和 Rails 3.2.8。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:57:28.377

这不是真正的 Ruby、iTerm 2、终端或 zsh 问题。相反，它不了解 *nix OS 应用程序如何处理来自 STDIN 的读取。

您看到的问题是`-I`指定`$LOAD_PATH`目录。结果，Ruby 使用您的 path/to/script 作为`LOAD_PATH`变量，然后挂起，等待来自 STDIN 的输入，因为它没有看到要运行的脚本。

而不是使用`CNTRL`+`C`或重新启动，使用`CNTRL`+ `D`。这将关闭输入流，这将导致 Ruby 退出，因为它没有找到要运行的命令。

您可以使用以下方法进行测试：

```
ruby -I /dev/null 
```

在命令行。Ruby 将挂起，等待输入。关闭输入，Ruby 将立即退出。当然，如果你没有意识到这就是发生的事情，你最终可能会向 Ruby 输入一些有趣的命令，在看到`CNTRL`+之前它不会做任何事情`D`，然后可能会吐出各种信息性消息，但这是可以理解的，因为就口译员而言，输入可能是疯狂的谈话。

当它们从 STDIN 读取时，相同的`CNTRL`+`D`组合用于关闭来自各种其他 *nix 程序的输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:39:14.627

嗬！在我写这篇文章时，我发现了我的问题，并认为我会继续提供答案，以防其他人这样做。在指定目录之前，我需要调整命令以包含单词**test ，如下所示：**

```
ruby -I test test/unit/name_of_test.rb 
```

# arrays - squeak how to use pen goto: and place:

> ID：14753711
> 
> 赞同：2
> 
> 时间：2013-02-07T14:39:16.550
> 
> 标签：arrays, smalltalk, squeak, pen

我正在用 squeak smalltalk 制作一个程序，在制作它的同时我意识到我不知道如何使用这些代码片段来使用 x、y 值的数组：

```
pen:= Pen new.         "to create the pen object first"   
pen place: 200@200
pen down
pen goto: 100@100 
```

好的，现在我有一个包含 2 个值的数组，一个用于笔 X，一个用于笔 Y 位置，现在我写：

```
pen place: (myArray at:1) @ (myArray at:2) 
```

但它不喜欢@所以我认为这是因为我需要：

```
pen place: ((myArray at:1)asInteger) @ ((myArray at:2)asInteger) 
```

此外，它不喜欢“asInteger”，所以我用“asSymbol”替换了“asInteger”，这是不正确的，因为我认为它也不起作用。当我尝试时发生了同样的事情：

```
pen goto: 
```

我的问题是，您将如何使用 myArray 的位置来使用“place：”或“goto：”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:15:04.970

我在工作区尝试了这个，它似乎工作正常：

```
pen := Pen new.
pen place: 200@200.
pen down.
pen goto: 100@100.
xArray := Array with:300 with: 350 with: 425.
yArray := Array with: 500 with: 450 with: 375.
1 to: 3 do: [ :index | pen goto: (xArray at: index)@(yArray at: index)]. 
```

上面的代码对你有用吗？

干杯！

# memory-management - 使用 malloc 和 free 的内存峰值和内存损坏

> ID：14753713
> 
> 赞同：0
> 
> 时间：2013-02-07T14:39:18.307
> 
> 标签：memory-management, malloc, free

我最近在一次采访中被要求写信给函数——

1.  mymalloc 将返回到目前为止分配的内存地址的峰值。
2.  myfree 会告诉用户是否做了一些导致内存损坏的操作。例如。程序将内存地址从位置 101 分配到 200。如果程序在边界之外写入，即 101 和 200，则称为内存损坏。

注意：这些函数可以在内部使用 malloc 和 free 来分配和释放内存。

有人可以指导我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T08:03:37.760

1.  mymalloc 可以使用 sbrk(0) 的值来检查程序堆中断的当前位置。

2.  检查损坏部分有点棘手。如果您只是想确保 200 之后的字节是否被修改，那么这可以实现。由于每个内存分配在分配的缓冲区大小之前都有一个标头，用于存储分配的大小，您可以检查下一个块的标头，即存储在位置 201 的标头，以确保程序确实越过其边界写入 201。

# lisp - 返回上一个状态

> ID：14753720
> 
> 赞同：1
> 
> 时间：2013-02-07T14:39:36.697
> 
> 标签：lisp, common-lisp

有没有办法回到运行时的最后状态？简而言之，保存运行时并重新加载它。但是核心图像太大了（我正在制作一个小游戏:-)，所以我想出了一个主意，保存一些重要数据，然后在某一行开始运行（可能还有堆栈信息）。

例如：

```
(defun save ()
  _do-some-magic-to-save-the-state-and-then-exit_)

(defvar data (list 'a 'b 'c)) ; important data
(format t "Hello ")
(save)
(format t "World!~%") 
```

下一次，软件可以从它停止的地方启动。

```
$ software
Hello $ software
Hello $ software --load saved_state
World! 
```

但我根本不知道如何在 Common Lisp 中做到这一点......有人可以给我一些想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T14:48:55.500

这如何工作取决于 Common Lisp 的实现。查阅手册：

*   Clozure Common Lisp ->[保存应用程序](http://ccl.clozure.com/manual/chapter4.9.html)
*   SBCL ->[保存核心映像](http://www.sbcl.org/manual/Saving-a-Core-Image.html)
*   LispWorks ->[保存图像](http://www.lispworks.com/documentation/lw60/LW/html/lw-773.htm)
*   CLISP ->[保存图像](http://clisp.org/impnotes/image.html)

*   其他几个实现...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T13:54:30.093

您可能想尝试实现 Alex Warth 的 Worlds（[他的论文](http://www.vpri.org/pdf/tr2008003_experimenting.pdf)第 4 章）。这将允许您“萌芽”一个新世界，在其中运行您的计算，并定期将子世界中的更改提交给父世界，或者中止并回滚到父世界的状态。这就像一个无限的撤消，但您可以产生*多个*撤消的世界/链。

# mysql - 在 MYSQL 中接受用户输入？Shell 脚本/批处理文件

> ID：14753721
> 
> 赞同：0
> 
> 时间：2013-02-07T14:39:37.587
> 
> 标签：mysql, database, shell, user-input

这是我的问题。我有一组 SQL 数据库查询，我使用 shell 脚本和扩展名为 .sql 的相应批处理文件触发这些查询。我的一些查询需要一些手动用户输入（根据请求），我没有在我的脚本中实现这些输入。

到目前为止，我通过 shell 脚本将用户输入作为日期输入：

```
echo "Please specify the date in yyyy-mm-dd format: 'input;"
read input
mysql -u user -ppass < batch_file.sql 
```

我想将变量传递`$input`给批处理文件。

执行 sql 查询的批处理文件如下所示：

```
select count(*) as count from subscriptions 
where date_add(optin_date, interval 1 year) between "$input" 
and date(curdate()) 
and active = 1 
and stype = "domain"; 
```

`"$input"`从 shell 脚本传递下来的变量在哪里。

任何想法将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:41:36.860

尝试在脚本中使用*here-doc执行此操作：*

```
#!/bin/sh

echo "Please specify the date in yyyy-mm-dd format: 'input;"
read input
mysql -u user -ppass <<EOF
select count(*) as count from subscriptions 
where date_add(optin_date, interval 1 year) between "$input" 
and date(curdatE()) 
and active = 1 
and stype = "domain";
EOF 
```

如果您出于任何原因无法使用第一个解决方案，则另一种解决方案：

```
echo "Please specify the date in yyyy-mm-dd format: 'input;"
read input
sed -i "s/\"\$input\"/$input/g" batch_file.sql
mysql -u user -ppass < batch_file.sql 
```

如果您更喜欢第二种解决方案，最好使用类似的东西`%%PATTERN%%`而不是在 SQL 文件中进行替换。`$input`

# ios - 如何在 Core Graphics 中绘制任何 PNG 格式

> ID：14753722
> 
> 赞同：0
> 
> 时间：2013-02-07T14:39:38.583
> 
> 标签：ios, png, core-graphics

我们有从 PNG 数据提供者创建 CGImage 的代码，然后在 CGBitmapContext 上绘制它。大多数 PNG 工作正常，但不支持某些 PNG 格式（请参阅[此处](https://developer.apple.com/library/ios/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-BCIBHHBB)），因此我们得到一个 NULL 上下文。这就是我们创建它的方式：

`CGContextRef imageContext = CGBitmapContextCreate(NULL, width, height, CGImageGetBitsPerComponent(image), 0, CGImageGetColorSpace(image), CGImageGetBitmapInfo(image));`

现在，虽然这种方式在 Core Graphics 中不起作用，但使用相同的 PNG 制作 UIImage 是可行的。我们确实手动确认确实不支持给定的 PNG 格式（24 bpp、8 bpc、仅 RGB（无 alpha 通道））。此外，传递 kCGImageAlphaPremultipliedFirst 的 CGBitmapInfo 有效！

因此，似乎有一种方法可以让杂散的 PNG 渲染，而 UIImage 实现了这一点。但是我们真的不能在这里使用 UIImage （我们想在后台线程上预渲染位图），因此问题 - 在 Core Graphics 中渲染所有 PNG 的好启发式方法是什么？或者，我们可以使用哪些其他绘图技术来实现相同的效果（但不使用 Core Graphics）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:18:19.300

**第一：** `UIImage`现在是线程安全的。[从文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)：

> 这也意味着图像对象本身可以安全地从任何线程使用。

**第二：**您的问题仅在于可用 CGBitmapContext 像素格式的数量有限。

如果您始终使用 32bpp，则带有预乘 alpha 的 RGB 一切都应该工作。当然，您不会得到 PNG 的原始像素格式（如调色板、黑白或其他），但这通常无关紧要，因为在屏幕上绘制图像是用 RGB 完成的。

# c# - 使用 WPF/Windows Phone 的 TextBlock.Inlines 对齐文本

> ID：14753727
> 
> 赞同：0
> 
> 时间：2013-02-07T14:39:55.187
> 
> 标签：c#, .net, windows-phone-7, windows-phone-8

我正在使用 TextBlock.Inlines 在我的 Windows Phone 应用程序的“隐藏代码”中以编程方式设置文本属性。有谁知道如何使用内联以编程方式对齐文本？我已经尝试应用对齐属性，如下图所示，但运气不佳。

```
 MyLabel.Inlines.Add(new Run() { Text = "My Text  ", FontSize = 10, VerticalAlignment = new ( VerticalAlignment.Center) }); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:56:40.200

您确定要使用垂直对齐吗？您很可能想改用水平的。也许这会解决你的问题。

# c# - 为简单控制台应用程序创建的默认线程数

> ID：14753739
> 
> 赞同：4
> 
> 时间：2013-02-07T14:40:32.443
> 
> 标签：c#

我对为控制台应用程序创建的线程有一个特定的查询。我创建了一个简单的 c# 控制台应用程序，它只打印 Hello World。在此应用程序进程的任务管理器中，显示的线程数为 10。我可以想到 2 个线程：一个用于写入控制台，一个用于垃圾收集。其他 8 个线程呢？此外，创建的线程数是否取决于机器配置或 .net 框架版本？

# android - Android：如何创建主屏幕快捷方式来启动 shell 脚本？

> ID：14753742
> 
> 赞同：17
> 
> 时间：2013-02-07T14:40:35.680
> 
> 标签：android, shell, user-interface, scripting

是否有任何应用程序可以为 shell 脚本创建主屏幕快捷方式（所以我只需单击它即可运行脚本）？

如果该应用程序是开源的，那就太好了，并且允许我将脚本保存到有根设备的内部存储中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-28T22:25:58.717

回答：您的问题的答案应该是 GScript（开源并在有根设备上“保存在任何地方”），但是当脚本完成时，谁想盯着那个模态终端输出屏幕？详情如下。

*   [SManager（免费版）](http://play.google.com/store/apps/details?id=os.tools.scriptmanager)可让您将自定义脚本存储在设备上的任何位置，如果您使用的是有根设备，甚至是您的内部存储。它可以让您设置不同的自动启动触发器：启动（当然）、网络启动/关闭等。可以触发通知以让您了解脚本的运行和/或退出状态等。但是，它不会让您创建一个将直接执行您的脚本的主屏幕快捷方式。它首先启动到自己的 UI，然后您可以从那里执行您的脚本。[SManager（无广告版本）](https://play.google.com/store/apps/details?id=os.tools.scriptmanagerpro)确实可以让您从主屏幕快捷方式干净地在后台执行您的脚本，尽管对于某些脚本我构建了 GUI 弹出视图。我使用这个应用程序编写shell 和 python（参见[SL4A/android-scripting ）。](https://code.google.com/p/android-scripting/)

*   [GScript Lite](http://play.google.com/store/apps/details?id=nl.rogro.GScriptLite)（也是[Gscript（捐赠版）](https://play.google.com/store/apps/details?id=nl.rogro.GScriptFull)）是一个开源解决方案。您可能希望与源代码库同步并重新编码/改进它以更好地满足您的需求。就像现在（v1.1.2）一样，它需要对 ICS+ 进行一些改进，因为它的 UI 退出时会出现一个无害的错误（一个限制其有用性的弹出窗口）。此解决方案将允许您通过主屏幕快捷方式（两个版本）直接启动脚本，但您必须盯着一个免费的终端输出屏幕 20 整秒，或者直到您手动关闭/关闭它。

*   另一个答案中提到了[SL4A/android-scripting 。](https://code.google.com/p/android-scripting/)为您的脚本创建主屏幕快捷方式很容易。这是一个开源解决方案，但它不允许您将脚本保存到设备的内部存储中。该解决方案使用模块化 apk 插件支持 Lua、BeanShell(Java)、Bash shell、Python、Perl、JRuby、Tcl 和 JavaScript。

*   [SL4A 脚本启动器](http://play.google.com/store/apps/details?id=org.androidideas.scriptlauncher)是 TaskBomb 自动化/调度实用程序的附加组件。TaskBomb 提供的脚本执行触发器基本上涵盖了 Android API 公开的每个 Content Provider，而且数量很多。完整的 SL4A 语言支持适用于此应用程序。如果您只需要简单的 shell 脚本，您可能会发现它有点臃肿。您的脚本可以通过主屏幕快捷方式启动，但这不是开源解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-02T12:57:10.523

所以我发现最好的选择是 GScript。

G.Play 上的 GScript 版本已损坏，我已向 bugtracker 发送了一个补丁，但我没有看到任何活动。该项目似乎被遗弃了，所以我在这里做了一个分叉：[https](https://bitbucket.org/Equidamoid/gscript) ://bitbucket.org/Equidamoid/gscript 。该 apk 位于下载部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-02-23T15:49:57.143

也许有人会发现我这样做的方式很有用：我使用 ConnectBot（可在 Play 商店中获得，并且开源[https://code.google.com/p/connectbot/](https://code.google.com/p/connectbot/)）。它是一个允许连接到手机本身的 SSH 客户端。您可以为此创建本地脚本的快捷方式：

*   创建一个新的连接“本地”。您只需要引入一个别名（例如您的脚本名称）
*   然后，编辑连接，有一个选项，如“自动化后开始会话”（我不知道确切的英文单词，因为我看到的是西班牙语语言环境）
*   如果您的脚本足够简单，您只需在输入框中发出命令（多行）：如果没有，请将实际文件脚本的路径/名称放在手机上（不要忘记“换行符”！）
*   现在，您可以在主屏幕上添加该连接的快捷方式（我在 Nova Launcher 上有一个选项：长按主屏幕，“添加快捷方式”，选择 Connect Bot，您将在应用程序中看到所有连接。不同发射器可能不同。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-09T07:10:12.637

我发现了允许创建快捷方式的 SL4A 项目。不幸的是，所有脚本都必须放在 sdcard 上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-01-20T04:28:13.880

终端模拟器应用程序本身（与 cyanogenmod 等捆绑在一起）允许您创建一个快捷方式（通过小部件窗口），它打开终端窗口运行给定的命令（在创建快捷方式时输入）。

使用此工具执行脚本非常容易（使用别名；使用 && 链接命令；实际创建和执行脚本）。

这可以被认为是内置选项。

# solr - 根据另一个索引字段计算分数‏?

> ID：14753743
> 
> 赞同：0
> 
> 时间：2013-02-07T14:40:37.337
> 
> 标签：solr, solrnet

我的架构如下

```
<fields>   
    <field name="ProductId" type="int" indexed="true" stored="true" />    
    <field name="ProductName" type="string" indexed="true" stored="true" required="true" />
    <field name="ProductDesription" type="string" indexed="true" stored="true" required="true" />
    <field name="ProductRating" type="int" indexed="true" stored="true" required="true" />
</fields> 
```

产品名称将作为 q 参数传递给 solr。有没有办法根据不作为查询参数传递的“ProductRating”来影响分数？

或者我需要去 solr 源代码并更改排名算法？

请指导我。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T01:41:49.903

如果您想按 排序`ProductRating`，那么只需像这样附加另一个查询参数： `q=ProductName:book&sort=ProductRating desc`或者您可以`ProductRating`在[函数查询](https://wiki.apache.org/solr/FunctionQuery)中使用来影响分数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T05:16:17.490

您可以根据产品评级提高结果。

检查例如[Boost Score](http://wiki.apache.org/solr/SolrRelevancyFAQ#How_can_I_boost_the_score_of_newer_documents)或如果您使用 Dismax 解析器检查参数[Boost Query](http://wiki.apache.org/solr/DisMaxQParserPlugin#bq_.28Boost_Query.29)

根据你的情况你可以试试`bq=ProductRating^2.0`

您可能应该结合使用产品名称和产品类型的提升来获得具有不同权重的正确结果，以解释搜索，因为在您的情况下，它只是 @Arun 回复的排序

# c++ - C++ 变形库

> ID：14753748
> 
> 赞同：3
> 
> 时间：2013-02-07T14:40:56.663
> 
> 标签：c++, inflection

我有一个 C++ 编写的代码，可以在大型文档库（使用 CLucene）之间进行搜索。我想让它在搜索过程中与单数和复数无关，所以我需要改变单词。在使用 python 时，我使用[了](http://pypi.python.org/pypi/inflect)很多次。是否有任何 C++ 库可以做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:49:11.160

我认为您正在寻找的搜索关键字是“ [stemming](http://en.wikipedia.org/wiki/Stemming) ”。还有一个从 Wikipedia 页面链接的[C++ 库](http://www.oleandersolutions.com/stemming/stemming.html)（BSD 许可）（虽然我无法评论该库，因为我没有使用它）。

# c++ - boost::asio io_service 在 stop() 之后没有返回

> ID：14753759
> 
> 赞同：4
> 
> 时间：2013-02-07T14:41:20.657
> 
> 标签：c++, boost, boost-asio

我正在开发一个使用 boost::asio 在不同端口上侦听 TCP 和 UDP 数据包的应用程序。我通过使用与 asio 教程示例中类似的服务器类来做到这一点，并将它们全部指向一个 io_service。

所以总的来说我的主要功能（win32控制台应用程序）看起来像这样：

```
int main(int argc, char* argv[])
{
    //some initializations here

    try
    {
        asio::io_service io_service;
        TcpServer ServerTCP_1(io_service, /*port number here*/);
        TcpServer ServerTCP_2(io_service, /*port number here*/);
        UdpServer ServerUDP(io_service, /*port number here*/);

        io_service.run();
    }
    catch(std::exception& e)
    {
        std::cerr << e.what() << std::endl;
    }

    //cleanup code here

    return 0;
} 
```

我还阅读了 HTTP 服务器示例，其中 a`signal_set`用于执行异步操作，该操作在退出信号进来时被激活（我也在服务器类中实现了该操作）。

这是我的`TcpServer`课：

```
class TcpServer : private noncopyable
{
public:
    TcpServer(asio::io_service& io_service, int port) : 
        acceptor_(io_service, tcp::endpoint(tcp::v4(), port)), 
        signals_(io_service), context_(asio::ssl::context::sslv3)
    {
        SSL_CTX_set_cipher_list(context_.native_handle(), "ALL");
        SSL_CTX_set_options(context_.native_handle(), SSL_OP_ALL);
        SSL_CTX_use_certificate_ASN1(context_.native_handle(), sizeof(SSL_CERT_X509), SSL_CERT_X509);
        SSL_CTX_use_PrivateKey_ASN1(EVP_PKEY_RSA, context_.native_handle(), SSL_CERT_RSA, sizeof(SSL_CERT_RSA));
        SSL_CTX_set_verify_depth(context_.native_handle(), 1);

        signals_.add(SIGINT);
        signals_.add(SIGTERM);
        signals_.add(SIGBREAK);
#if defined(SIGQUIT)
        signals_.add(SIGQUIT);
#endif // defined(SIGQUIT)
        signals_.async_wait(boost::bind(&TcpServer::handle_stop, this));

        start_accept();
    }

private:
    tcp::acceptor acceptor_;
    asio::ssl::context context_;
    asio::signal_set signals_;
    TcpConnection::pointer new_ssl_connection;

    void start_accept(){
        new_ssl_connection.reset(new TcpConnection(acceptor_.get_io_service(), context_));
        acceptor_.async_accept( new_ssl_connection->socket(), 
                                    boost::bind(&TcpServer::handle_acceptSSL, this, asio::placeholders::error));
    }

    void handle_acceptSSL(const system::error_code& error){
        if(!error)
            new_ssl_connection->start();
        start_accept();
    }
    void handle_stop(){
        acceptor_.close();
        printf("acceptor closed");
    }
}; 
```

现在，由于我有 3 个不同的服务器对象，他应该关闭它们的所有接受者，留下`io_service`没有工作，这再次导致`io_service`从调用返回，`run()`这应该使程序进入主函数中的清理代码，对吗？除此之外，`printf`调用也应该执行 3 次，或者？

好吧，首先`io_service`没有返回，清理代码永远不会到达。其次，控制台中最多只显示一个 printf 调用。

第三，通过进行一些调试，我发现当我退出程序时，它`handle_stop()`会被调用一次，但由于某种原因，程序会在句柄中的某个位置关闭（这意味着有时他会进入 printf 并在此之后关闭，有时他只是得到到`acceptor_.close()`)

另一件可能值得一提的是程序在关闭后不会返回 0 而是返回 0（线程数不同）：

```
The thread 'Win32 Thread' (0x1758) has exited with code 2 (0x2).
The thread 'Win32 Thread' (0x17e8) has exited with code -1073741510 (0xc000013a).
The thread 'Win32 Thread' (0x1034) has exited with code -1073741510 (0xc000013a).
The program '[5924] Server.exe: Native' has exited with code -1073741510 (0xc000013a). 
```

所以我想知道为什么会发生这种情况，如何修复它以及如何正确获取清理代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:12:21.740

`io_service`永远不会回来，因为`io_service`. 当[`acceptor::close()`](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/basic_socket_acceptor/close/overload1.html)被调用时，`acceptor`会立即取消 的异步接受操作。这些取消操作的处理程序将传递`boost::asio::error::operation_aborted`错误。

在当前代码中，问题是始终启动新的异步接受操作的结果，即使`acceptor`已经关闭。因此，工作总是被添加到`io_service`.

```
void start_accept(){
  // If the acceptor is closed, handle_accept will be ready to run with an
  // error.
  acceptor_.async_accept(...,  handle_accept);
}

void handle_accept(const system::error_code& error){
  if(!error)
  {
    connection->start();
  }

  // Always starts a new async accept operation, even if the acceptor
  // has closed.
  start_accept();
}
void handle_stop(){
  acceptor_.close();
} 
```

Boost.Asio 示例防止这种情况发生，检查是否`acceptor_`已在`handle_accept`调用中关闭。如果`acceptor_`不再打开，则处理程序会提前返回，而不会向`io_service`.

以下是来自[HTTP Server 1](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/example/http/server/server.cpp)示例的相关片段：

```
void server::handle_accept(const boost::system::error_code& e)
{
  // Check whether the server was stopped by a signal before this completion
  // handler had a chance to run.
  if (!acceptor_.is_open())
  {
    return;
  }

  if (!e)
  {
    connection_manager_.start(new_connection_);
  }

  start_accept();
} 
```

# database - 使用 Active X 用户表单界面从多个电子表格中提取数据

> ID：14753761
> 
> 赞同：0
> 
> 时间：2013-02-07T14:41:39.610
> 
> 标签：database, excel, vba

我是 VBA 的新手。如果我的问题看起来很愚蠢，请原谅。

我想做的是在 Excel 中创建一个用于提取期货价格数据的用户表单界面。我有大约一百个不同的电子表格，其中期货价格命名为 08012、08011 等。我有类似的电子表格，其中包含对相同期货的预测，它们也以相同的方式命名。我想创建这样的图形用户界面，可以输入股票代码、日期范围以及预测或实际价格，并从正确的电子表格中获取所需的系列。我最大的问题是我是 VBA 的新手，所以我什至不知道这是否可以解决 Excel 中的这类问题。

我一直在阅读一些文献，我意识到我需要一个带有 2 个文本框的用户表单界面（一个用于股票代码查看，一个用于时间范围）以及一个选项框（用于决定是否显示预测或实际价格） . 但这就是我无法真正理解如何传递用户在程序中进一步输入的数据的全部内容，因此 Excel 确实从正确的电子表格中获取了正确的库存。

任何提示，类似问题的链接都将非常受欢迎！抱歉，问题描述不清楚。请询问您需要的任何详细信息。这是我的代码：

```
Private Sub CommandButton1_Click()
Dim a As String
Dim aa As String
Dim myP As Range
Dim myC As Range
Dim t1 As String
Dim tper() As Variant
Dim tper2() As Variant
Dim tper3() As Variant
Dim t2 As Long
Dim t3 As Long
Dim r As Range
Dim rr As Range
Dim rrr As Range
Dim myMax As Long
Dim FindMax As Long
Dim myMin As Long
Dim FindMin As Long
Dim strPath As String
a = TextBox1.Value
If TextBox1.Value = "" Then
MsgBox ("Ange Serie")
Exit Sub
End If
aa = TextBox4.Value
If TextBox4.Value = "" Then
MsgBox ("Ange Prognosår")
Exit Sub
t1 = TextBox2.Value
If TextBox2.Value = "" Then
MsgBox ("Ange Startdatum")
Exit Sub
End If
t2 = Val(t1)
t1 = TextBox3.Value
If TextBox3.Value = "" Then
MsgBox ("Ange Slutdatum")
Exit Sub
End If
t3 = Val(t1)
If OptionButton1.Value = True Then
'Sheets("utfall").Activate
strPath = "C:\Users\dmyshe\Desktop\Dmytro\Utfall.xls"
Workbooks.Open Filename:=strPath, UpdateLinks:=False
ElseIf OptionButton2.Value = True Then
'Sheets("prognoser").Activate
strPath = "C:\Users\dmyshe\Desktop\Dmytro\Prognoser.xls"
Workbooks.Open Filename:=strPath, UpdateLinks:=False
Else
MsgBox ("Fel")
End If
'Application.AskToUpdateLinks = False
Sheets("" & aa).Activate
tper = Range("A3:A500")
tper2 = Range("CL3:CL500")
tper3 = Range("CL3:CL500")
For i = 1 To UBound(tper, 1)
tper(i, 1) = year(tper(i, 1))
Next i
For i = 1 To UBound(tper, 1)
If tper(i, 1) >= t2 Then
tper2(i, 1) = i
End If
Next i
FindMin = Application.Min(tper2)
For i = 1 To UBound(tper, 1)
If tper(i, 1) <= t3 And tper(i, 1) <> 1899 Then
tper3(i, 1) = i
End If
Next i
FindMax = Application.Max(tper3)
Set r = Rows(2).Find("" & a, , xlValues, xlWhole).EntireColumn
Range("CM1:CM" & r.Rows.Count) = r.Value
Set rr = Range("CM" & (FindMin + 1) & ":CM" & (FindMax + 1))
Set rrr = Range("A" & (FindMin + 2) & ":A" & (FindMax + 2))
ThisWorkbook.Activate
Sheets("Blad3").Activate
Range("A:A").Cells.Clear
Range("B:B").Cells.Clear
Range("A1") = "Datum"
Range("B1") = "" & a
Range("A1").Font.Bold = True
Range("B1").Font.Bold = True
Range("B2:B" & (rr.Rows.Count + 1)) = rr.Value
Range("A2:A" & (rrr.Rows.Count + 1)) = rrr.Value
If OptionButton1.Value = True Then
Workbooks("Utfall").Close False
ElseIf OptionButton2.Value = True Then
Workbooks("Prognoser").Close False
End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T19:54:05.383

此[链接](http://www.excel-vba-easy.com/vba-userform-excel-vba.html)将教您如何创建表单和编写基本的 VBA 代码。对于您的用户表单界面，您将需要两个用于日期范围的文本框和用于提交代码的按钮。

# javascript - JavaScript 动态图

> ID：14753763
> 
> 赞同：1
> 
> 时间：2013-02-07T14:41:42.340
> 
> 标签：javascript, jquery, web-applications, raphael, jointjs

快速提问，我对 JavaScript 还是很陌生，毫无疑问，我会从这个项目中学到很多东西。所以我提出一个问题（这很可能是一个愚蠢的问题），我的问题是：

我计划构建一个 Web 应用程序，该应用程序可以从 Raphael 或 Joint.js 动态生成形状，两者都非常相似，动态我的意思是在用户输入之前将有未定义数量的对象要绘制，例如数量他们希望绘制的对象 - 所以这里有一些代码来加强我的问题：

```
var erd = Joint.dia.erd;
Joint.paper("world", 800, 250);

var e1 = erd.Entity.create({
    rect: {
        x: 220,
        y: 70,
        width: 100,
        height: 60
    },
    label: "Entity"
}); 
```

所以，我创建了一个矩形类型的对象，但这是我想知道的 - 我可以这样做：

```
var erd = Joint.dia.erd;
Joint.paper("world", 800, 250);
int x, y;
for (int i = 0; i < numOfUserDefObjects; i++) {
    var e1 = erd.Entity.create({
        rect: {
            x: x,
            y: y,
            width: 100,
            height: 60
        },
        label: "Entity"
        x + 20;
        y - 40;
    });
} 
```

一切都是让我困惑的是，`var e1`. 如果要创建 2 个对象，每当循环第二次遍历循环/创建第二个对象时，是否会从我的 SVG/Canvas 中擦除/删除/覆盖循环中创建的第一个对象？

对此有一点见解将不胜感激！同样，缺乏 JavaScript 经验，但这会改变。

再次感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:22:37.050

在 javascript 中，用声明的局部变量`var`具有函数范围。这意味着每个函数只有一个该局部变量的副本。因此，在您的第二个代码块中，只有一个变量副本，`e1`并且`for`循环在每次迭代中为其分配不同的值。

您可以做您正在做的事情，但是`e1`当您完成时，其中只有一个值，并且该值将是`for`分配给它的循环的最后一次迭代。

我不确切知道您要完成什么，但是您可以像这样创建一个对象数组：

```
var erd = Joint.dia.erd;
Joint.paper("world", 800, 250);
var x = 0, y = 0;
var objs = [];
for (var i = 0; i < numOfUserDefObjects; i++) {
    objs.push(erd.Entity.create({
        rect: {
            x: x,
            y: y,
            width: 100,
            height: 60
        },
        label: "Entity"
    }));
    x += 20;
    y -= 40;
}
// objs now contains an array of the created objects 
```

* * *

注意：我还初始化了 x 和 y，修复了要使用的声明，`var`并在循环`int`中正确地递增和递减 x 和 y 。`for`您发布的代码中有很多语法错误。

# android - 如何知道音源何时停止播放

> ID：14753764
> 
> 赞同：1
> 
> 时间：2013-02-07T14:41:42.677
> 
> 标签：android, thread-sleep, tone-generator

我跪下知道我的音源何时停止播放。

我想播放 dtmf 音 50 ms，然后等待 50 播放下一个音。我想使用这段代码。

```
private void playtones() {
    new Thread(new Runnable() {
        public void run() {
            for(int i=0 ; i<=19 ; i++){
                dtmftone.startTone(savetone.get(i) , 50);
                try {
                    Thread.sleep(50);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }   
            }
            }

        }
      ).start();

} 
```

在音调停止播放之前睡眠开始。如何检查音调是否已停止播放？还是有更好的方法来做到这一点？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:10:29.030

您应该使用 ToneGenerator 的方法[wait(long millis)](http://developer.android.com/reference/java/lang/Object.html#wait%28long%29)而不是 Thread.sleep()。
请注意，该方法不会等待声音停止，因此您必须考虑哔声的持续时间：

```
int BEEP_DURATION = 50;
int WAITING_DURATION = 50;

...

for (int i = 0; i <= 19; i++) {
    dtmftone.startTone(savetone.get(i), BEEP_DURATION);
    synchronized(dtmftone) {
        dtmftone.wait(BEEP_DURATION + WAITING_DURATION);
    }
... 
```

而且我不确定您是否要在两次哔声之间等待 50 毫秒。如果不这样做，只需删除“+ WAITING_DURATION”

# windows-phone-8 - 开始 WP8 游戏

> ID：14753765
> 
> 赞同：1
> 
> 时间：2013-02-07T14:41:43.650
> 
> 标签：windows-phone-8

当 WP 7.5 是最新的 Windows Phone 操作系统时，我可以使用 XNA 框架创建游戏。我知道我可以为此使用 C#。

但现在我看到，WP8 SDK 不支持 XNA，我知道它现在已被弃用。所以我的问题是：

**如何使用 C# 为 Windows Phone 8 编写游戏？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-21T08:45:42.980

您不能直接为#WP8 平台开发 XNA 应用程序。您的 XNA 应用程序只能针对 WP7 平台，它们可以在 WP8 设备上正常运行。

VS2012 和 WP8 SDK 中的 XNA 项目只能针对 WP 7.1 平台。从好的方面来说，所有运行 WP 7.5、即将推出的 7.8 和 WP8 的手机都可以毫无问题地运行您的游戏。从这个角度来看，WP8 SDK 和 WP8 设备完全支持 XNA，但这些不会是 WP8 项目。

由于不是 WP8 项目，缺点是您不能使用 WP8 独有的功能，例如：

1.  应用内购买/微交易（这对 XNA 开发者的伤害最大）
2.  您的游戏将始终为 800x480，因为您需要 WP8 项目来支持更高分辨率。您的 XNA 游戏在分辨率更高的设备上运行时应该会自动放大。
3.  独有的 WP8 网络功能和 API，包括蓝牙和 NFC
4.  语音和语音识别 API
5.  您的 XNA 游戏无法注册应用程序间通信的协议扩展
6.  新的动态磁贴模板

最终选择显然是@Strife 在他的回答中正确所说的。干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:00:01.450

有一些开源项目，例如 SharpDX，正在尝试将 XNA/DirectX 功能移植到 C#。但是，它建议您使用 C++ 和 Direct3D 创建 Windows Phone 8 游戏。使用 C++ 将使您获得比 C# 更高的性能（至少应该如此），并且您将可以访问所有 windows phone 8 功能。如果您决定走这条路，请查看 Microsoft 的 DirectX 工具包项目，因为它包含模拟 XNA 行为的 C++ 方法，例如 spritebatch。最后一点，我相信 Unity3D 引擎很快就会支持 windows phone，并且所有脚本都使用 C# 或 JavaScript。

# c# - 访问共享网络驱动器时需要模拟

> ID：14753766
> 
> 赞同：1
> 
> 时间：2013-02-07T14:41:44.317
> 
> 标签：c#, impersonation

当我尝试从本地访问网络驱动器文件时，它工作正常，但是当我部署代码时，我收到以下错误

> 在 System.IO.__Error.WinIOError（Int32 错误代码，字符串可能全路径）
> 
> 在 System.IO.FileStream.Init（字符串路径，FileMode 模式，FileAccess 访问，Int32 权限，布尔用户权限，文件共享共享，Int32 缓冲区大小，FileOptions 选项，SECURITY_ATTRIBUTES secAttrs，字符串 msgPath，布尔 bFromProxy）
> 
> 在 System.IO.FileStream..ctor（字符串路径、FileMode 模式、FileAccess 访问、FileShare 共享）
> 
> 在 System.Web.HttpResponse.WriteFile（字符串文件名，布尔 readIntoMemory）
> 
> 在 System.Web.HttpResponse.WriteFile（字符串文件名）
> 
> 在 C:\Users\bpucha1103c\Desktop\CellBackHaul_Publish\Configs.aspx.cs:line 59 中的 Configs.gvConfigs_RowCommand(Object sender, GridViewCommandEventArgs e) 2013-02-05 13:31:21,412 [19] 警告 System.Web.UI .Page [(null)] - Logging:System.IO.IOException: 使用的帐户是计算机帐户。使用您的全局用户帐户或本地用户帐户访问此服务器。

访问网络共享文件夹中的文件时如何进行模拟？下面是我的代码

```
GridViewRow rw = (GridViewRow)(((LinkButton)e.CommandSource).NamingContainer);
LinkButton lnkTxtFile = (LinkButton)rw.FindControl("lnkTxtFile");
string strFilename = lnkTxtFile.Text.Replace("/","\\");
System.IO.FileInfo targetFile = new System.IO.FileInfo(strFilename);
Response.Clear();
Response.AddHeader("Content-Disposition", "attachment; filename=" + targetFile.Name);
Response.ContentType = "application/octet-stream";
Response.WriteFile(targetFile.FullName);
//HttpContext.Current.ApplicationInstance.CompleteRequest();
Response.End(); 
```

这是我修改后的代码

```
GridViewRow rw = (GridViewRow)(((LinkButton)e.CommandSource).NamingContainer);
LinkButton lnkTxtFile = (LinkButton)rw.FindControl("lnkTxtFile");
string strFilename = lnkTxtFile.Text.Replace("/", "\\");
System.IO.FileInfo targetFile = new System.IO.FileInfo(strFilename);
RunOperationAsUser(() =>
{
  //GridViewRow rw = (GridViewRow)(((LinkButton)e.CommandSource).NamingContainer);
  //LinkButton lnkTxtFile = (LinkButton)rw.FindControl("lnkTxtFile");
  //string strFilename = lnkTxtFile.Text.Replace("/", "\\");
  //System.IO.FileInfo targetFile = new System.IO.FileInfo(strFilename);
  Response.Clear();
  Response.AddHeader("Content-Disposition", "attachment; filename=" + targetFile.Name);
  Response.ContentType = "application/octet-stream";
  Response.WriteFile(targetFile.FullName);
  //HttpContext.Current.ApplicationInstance.CompleteRequest();
  Response.End();
}, "bpucha1103c", targetFile.DirectoryName , "White1234"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T14:51:01.747

您可以尝试使用以下代码冒充另一个用户并运行操作：

```
[DllImport("advapi32.dll", SetLastError = true)]
private static extern bool LogonUser(string lpszUsername, string lpszDomain, string lpszPassword, int dwLogonType, int dwLogonProvider, ref IntPtr phToken);
[DllImport("advapi32.dll", CharSet = CharSet.Auto, SetLastError = true)]
public extern static bool DuplicateToken(IntPtr existingTokenHandle, int impersonationLevel, ref IntPtr duplicateTokenHandle);
[DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
private static extern bool CloseHandle(IntPtr handle);
[DllImport("advapi32.dll", CharSet = CharSet.Auto, SetLastError = true)]
public static extern bool RevertToSelf();
[DllImport("userenv.dll", SetLastError = true, CharSet = CharSet.Auto)]
public static extern bool LoadUserProfile(IntPtr hToken, ref ProfileInfo lpProfileInfo);

[DllImport("Userenv.dll", CallingConvention =
    CallingConvention.Winapi, SetLastError = true, CharSet = CharSet.Auto)]
public static extern bool UnloadUserProfile
    (IntPtr hToken, IntPtr lpProfileInfo);

[DllImport("ole32.dll")]
public static extern int CoInitializeSecurity(IntPtr pVoid, int
    cAuthSvc, IntPtr asAuthSvc, IntPtr pReserved1, RpcAuthnLevel level,
    RpcImpLevel impers, IntPtr pAuthList, EoAuthnCap dwCapabilities, IntPtr
    pReserved3);

[StructLayout(LayoutKind.Sequential)]
public struct ProfileInfo
{
    ///
    /// Specifies the size of the structure, in bytes.
    ///
    public int dwSize;

    ///
    /// This member can be one of the following flags: 
    /// PI_NOUI or PI_APPLYPOLICY
    ///
    public int dwFlags;

    ///
    /// Pointer to the name of the user.
    /// This member is used as the base name of the directory 
    /// in which to store a new profile.
    ///
    public string lpUserName;

    ///
    /// Pointer to the roaming user profile path.
    /// If the user does not have a roaming profile, this member can be NULL.
    ///
    public string lpProfilePath;

    ///
    /// Pointer to the default user profile path. This member can be NULL.
    ///
    public string lpDefaultPath;

    ///
    /// Pointer to the name of the validating domain controller, in NetBIOS format.
    /// If this member is NULL, the Windows NT 4.0-style policy will not be applied.
    ///
    public string lpServerName;

    ///
    /// Pointer to the path of the Windows NT 4.0-style policy file. 
    /// This member can be NULL.
    ///
    public string lpPolicyPath;

    ///
    /// Handle to the HKEY_CURRENT_USER registry key.
    ///
    public IntPtr hProfile;
}

public enum RpcAuthnLevel
{
    Default = 0,
    None = 1,
    Connect = 2,
    Call = 3,
    Pkt = 4,
    PktIntegrity = 5,
    PktPrivacy = 6
}

public enum RpcImpLevel
{
    Default = 0,
    Anonymous = 1,
    Identify = 2,
    Impersonate = 3,
    Delegate = 4
}

public enum EoAuthnCap
{
    None = 0x00,
    MutualAuth = 0x01,
    StaticCloaking = 0x20,
    DynamicCloaking = 0x40,
    AnyAuthority = 0x80,
    MakeFullSIC = 0x100,
    Default = 0x800,
    SecureRefs = 0x02,
    AccessControl = 0x04,
    AppID = 0x08,
    Dynamic = 0x10,
    RequireFullSIC = 0x200,
    AutoImpersonate = 0x400,
    NoCustomMarshal = 0x2000,
    DisableAAA = 0x1000
}

const int LOGON32_PROVIDER_DEFAULT = 0;
const int LOGON32_LOGON_NEW_CREDENTIALS = 9;
const int SECURITY_IMPERSONATION_LEVEL = 2;

public void RunOperationAsUser(Action operation, string userName, string domain, string password)
{
    IntPtr token = IntPtr.Zero;
    IntPtr dupToken = IntPtr.Zero;

    //Impersonate the user
    if (LogonUser(userName, domain, password, LOGON32_LOGON_NEW_CREDENTIALS, LOGON32_PROVIDER_DEFAULT, ref token))
    {
        if (DuplicateToken(token, SECURITY_IMPERSONATION_LEVEL, ref dupToken))
        {

            WindowsIdentity newIdentity = new WindowsIdentity(dupToken);
            WindowsImpersonationContext impersonatedUser = newIdentity.Impersonate();

            int retCode = CoInitializeSecurity(IntPtr.Zero, -1, IntPtr.Zero, IntPtr.Zero,
                RpcAuthnLevel.PktPrivacy, RpcImpLevel.Impersonate, IntPtr.Zero, EoAuthnCap.DynamicCloaking, IntPtr.Zero);

            if (impersonatedUser != null)
            {
                var username = WindowsIdentity.GetCurrent(TokenAccessLevels.MaximumAllowed).Name;
                var sid = WindowsIdentity.GetCurrent(TokenAccessLevels.MaximumAllowed).User.Value;

                ProfileInfo profileInfo = new ProfileInfo();
                profileInfo.dwSize = Marshal.SizeOf(profileInfo);
                profileInfo.lpUserName = userName;
                profileInfo.dwFlags = 1;

                Boolean loadSuccess = LoadUserProfile(dupToken, ref profileInfo);
            }

            operation();

            impersonatedUser.Undo();
        }
    }
    if (token != IntPtr.Zero)
    {
        CloseHandle(token);
    }
    if (dupToken != IntPtr.Zero)
    {
        try
        {
            CloseHandle(token);
        }
        catch
        { }
    }
} 
```

现在你可以做

```
RunOperationAsUser(() => {
    GridViewRow rw = (GridViewRow)(((LinkButton)e.CommandSource).NamingContainer);
    LinkButton lnkTxtFile = (LinkButton)rw.FindControl("lnkTxtFile");
    string strFilename = lnkTxtFile.Text.Replace("/","\\");
    System.IO.FileInfo targetFile = new System.IO.FileInfo(strFilename);
    Response.Clear();
    Response.AddHeader("Content-Disposition", "attachment; filename=" + targetFile.Name);
    Response.ContentType = "application/octet-stream";
    Response.WriteFile(targetFile.FullName);
    //HttpContext.Current.ApplicationInstance.CompleteRequest();
    Response.End();
}, userName, domain, password) 
```

# r - 变量聚类 (varclus) 汇总表

> ID：14753767
> 
> 赞同：1
> 
> 时间：2013-02-07T03:23:16.963
> 
> 标签：r, cluster-analysis, sas

我正在使用 R 中 Hmisc 包中的 varclus。有没有办法从 varclus 生成汇总表，就像 R 中的 SAS（例如[Output 100.1.2 和 Output 100.1.3](http://support.sas.com/documentation/cdl/en/statug/65328/HTML/default/viewer.htm#statug_varclus_example01.htm)）一样。基本上，我想知道以下信息以表格或矩阵形式包含在图中。例如：哪些变量在哪些集群中（在 SAS*集群结构*中），它们解释的方差比例等。

```
# varclust example in R using mtcars data
mtc <- mtcars[,2:8]
mtcn <- data.matrix(mtc)
clust <- varclus(mtcn)
clust
plot(clust)
#cut_tree <- cutree(varclus(mtcn)$hclust, k=5) # This would show group membership, but only after I chose some a cut point, not what I am after 
```

# html - CSS 订单问题 - 真正的逻辑是什么？

> ID：14753769
> 
> 赞同：1
> 
> 时间：2013-02-07T14:41:51.413
> 
> 标签：html, css

我最近在阅读和试验 CSS，但是，在我所做的几乎每一个实验中，我都一遍又一遍地遇到同样的问题。

问题简单如下：我设置属性为一般规则。然后我尝试为单个项目或有时为一个全新的类修改这些属性。出于某种原因，旧的（初始规则）仍然存在，新的类没有影响任何东西。

我知道在这些情况下使用 !important 会有所帮助，但我仍然难以获得整体逻辑。有时它可以在没有 !important 的情况下工作，有时它只是.. 没有。

我错过了什么？

这是一个示例，其中“nomargins”类不工作，除非它被应用为！important。 [http://cssdeck.com/labs/9xevau8p](http://cssdeck.com/labs/9xevau8p)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T14:51:30.767

你应该研究一下特异性。[例子](http://css-tricks.com/specifics-on-css-specificity/)

您的问题是`#main li`比`.nomargins`.

如果你愿意，你可以为`.nomargins`like this添加特异性`#main .nomargins`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:52:07.727

如果您像这样嵌套元素：`#somediv ul li a`此处指定的属性将具有优先级。我对此有很多问题，但是在您知道之后，解决方案很容易找到。另外[这里](http://css-tricks.com/efficiently-rendering-css/)是可以帮助您理解`css`渲染的文章

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:53:18.463

这是一个漫长而复杂的故事。基本上，浏览器会检查： - 样式来自哪里（作者样式表、用户样式表、内联声明等） - 相关规则的具体程度（影响 id 的规则将先于影响类的规则） - 规则的顺序（新规则先于旧规则） - 以及其他一些东西。就像已经说过的那样，大多数时候问题是特殊性的。检查此链接以获得更详细（和长）的答案： [http ://www.vanseodesign.com/css/css-specificity-inheritance-cascaade/](http://www.vanseodesign.com/css/css-specificity-inheritance-cascaade/)

# git - 如何从 git 存储库中删除文件的所有痕迹而不将其从目录中删除？

> ID：14753770
> 
> 赞同：2
> 
> 时间：2013-02-07T14:41:52.993
> 
> 标签：git

遵循[关于删除敏感数据的 Github 指南](https://help.github.com/articles/remove-sensitive-data)似乎会导致有问题的文件被完全删除，包括从目录中删除。有没有办法只从 git 存储库中删除有问题的文件（就好像它从未提交过一样），而不是从目录中删除它？显然它应该被添加到 .gitignore 文件中。

*注意：这只是一个假设问题；我实际上并没有暴露敏感信息。*

编辑：我确实意识到我可以简单地将文件复制出目录，然后按照 Github 上的说明将其移回。我想知道是否有“git方式”来完成我的要求。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T17:29:46.463

`git rm --cached`将从索引中删除文件而不实际从工作副本中删除该文件，并且您可以`git filter-branch`根据 your-link 使用从存储库的历史记录中清除文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:54:13.017

好吧，将其从 git 存储库中删除。您可以按照问题中链接的 github 页面中描述的步骤进行操作。只需将您的文件复制到另一个目录并在执行 git 过程后将其移回即可。

既然您的存储库是公开的（例如在 github 上），您就不能安全地假设您的敏感数据尚未被其他用户获取。

# python - 检查输入是python中的单个字母

> ID：14753776
> 
> 赞同：1
> 
> 时间：2013-02-07T14:41:56.610
> 
> 标签：python, string, loops

我试图检查用户输入的输入是单个字母或单词，而不是整数或什么都没有，如果他们输入的内容无效，那么他们应该保持在循环中，直到他们输入一个字母。到目前为止，这是我的代码，但它似乎没有以预期的方式工作：

```
animalcount = 0
animal = 0
data = False
while data == False:
    try:
        letter = str(input("what letter would you like to search for? "))
        data = True
    except:
        print ("please enter a letter, try again.")
    if letter == "":
        print ("please enter an item,try again!")
        data = False
for animal in animallist:
    if letter in animal:
        print(animal)
        animalcount = animalcount + 1
if animalcount == 0:
    print ("That letter cannot be found") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:53:14.543

从输入中创建一个字符串不会有太大的作用，因为您使用键盘输入的任何内容都可以作为字符串完美地工作。

您可以使用正则表达式来区分字母和数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:58:12.867

你可以在顶部使用一个简单的循环。

```
import string
letter = None
while not letter or letter not in string.letters:
    letter = str(raw_input("What letter would you like to search for? ")) 
```

然后其余的应该工作。

# ruby - 无法让 Sinatra Flash Gem 工作

> ID：14753782
> 
> 赞同：4
> 
> 时间：2013-02-07T14:42:18.220
> 
> 标签：ruby, sinatra, alert

我试图在成功提交表单后显示一个快速通知。在 Rails 中，我会在控制器中使用类似的东西：

```
:notice => "Youve submitted the form" 
```

我遇到了[Sinatra flash](https://github.com/SFEley/sinatra-flash) gem，想在重定向后显示一条 flash 消息。我像这样安装了gem和设置：

myapp.rb：

```
require 'sinatra/flash'
enable :sessions

#form config
 )}
redirect '/success' # this is the hook after my form submission
end

get('/success') do
 flash[:success] = "Thanks for your email. I'll be in touch soon."
 erb :index 
end 
```

所发生的一切是我被重定向到没有 Flash 消息的索引页面。查看文档，这就是我需要做的所有事情。有没有人看到有什么不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T15:52:11.727

我将我的 Flash 通知移到重定向之前，以便它可以保存消息：

```
flash[:notice] = "Thanks for your email. I'll be in touch soon."
redirect '/success'

get('/success') do
 erb :index 
end 
```

然后，在我看来，我现在把它放在顶部：

```
<div id='flash' class='notice'>
 <a class="close" data-dismiss="alert">&#215;</a>
 <%= flash[:notice] %>
</div> 
```

它需要一些样式，但可以工作。如果有人有更好的解决方案，请分享。

# c# - 使用 XmlMessageFormater 序列化的消息拒绝反序列化 List 成员

> ID：14753791
> 
> 赞同：3
> 
> 时间：2013-02-07T14:42:53.283
> 
> 标签：c#, deserialization, msmq, xml-deserialization

我对 C# 消息序列化感到沮丧。
我有一个类，它有一个如下所示的构造函数：

```
public ProposalRequestMessage(int imaNumber, int proposalId, bool trainingFlag, string firstSiteAddress,
                                  bool lastSiteFlag, string lastSiteAddress, int reasonCode,
                                  List<LaneSelection> theLaneSelections)
    {
        ImaNumber = imaNumber;
        ProposalId = proposalId;
        TrainingFlag = trainingFlag;
        FirstSiteAddress = firstSiteAddress;
        LastSiteFlag = lastSiteFlag;
        LastSiteAddress = lastSiteAddress;
        ReasonCode = reasonCode;
        laneSelections = new List<LaneSelection>(theLaneSelections);
    } 
```

System.Collections.Generic.List 类型的类的 lanesSelections 成员，其中 LaneSelection 如下所示：

```
public class LaneSelection
{
    public int LaneId { get; set; }
    public SignalAspect AspectCode { get; set; }

    public LaneSelection()
    {
    }
    public LaneSelection(int laneId, SignalAspect aspectCode)
    {
        LaneId = laneId;
        AspectCode = aspectCode;
    }
} 
```

SignalAspect 是一个枚举。

我通过 MSMQ 发送包含此类实例的消息，如下所示：

```
System.Messaging.MessageQueue queue = new System.Messaging.MessageQueue(queuename);
        queue.Purge();

System.Messaging.Message msg = new System.Messaging.Message(theMessage, new System.Messaging.XmlMessageFormatter());
        queue.Send(msg); 
```

使用一些调试工具，我发现生成的 XML 看起来有点像这样：

```
<?xml version="1.0"?>
<IvtmMessage xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  
<MessageType>ProposalRequest</MessageType>  
<ProposalRequestMessage>    
    <ImaNumber>0</ImaNumber>    
    <ProposalId>2</ProposalId>    
    <TrainingFlag>false</TrainingFlag>    
    <FirstSiteAddress>M25/4690A</FirstSiteAddress>    
    <LastSiteFlag>false</LastSiteFlag>    
    <LastSiteAddress />    
    <ReasonCode>3</ReasonCode>    
    <LaneSelections>      
        <LaneSelection>        
            <LaneId>1</LaneId>        
            <AspectCode>Advisory20</AspectCode>      
        </LaneSelection>    
    </LaneSelections>  
</ProposalRequestMessage> 
```

我像这样反序列化另一端的消息：

```
Queue = new System.Messaging.MessageQueue(queueName);
Queue.Formatter = new System.Messaging.XmlMessageFormatter(new Type[] { typeof(IvtmMessage) });
Queue.ReceiveCompleted += new System.Messaging.ReceiveCompletedEventHandler(Queue_ReceiveCompleted);
Queue.BeginReceive(new System.TimeSpan(0, 0, 0, 30));
...
System.Messaging.MessageQueue mq = (System.Messaging.MessageQueue)sender;
try
{    
     // End the asynchronous Receive operation.
     System.Messaging.Message m = mq.EndReceive(e.AsyncResult);

     IvtmMessage message = (IvtmMessage)m.Body;
     DecodeMessage(message);
}
catch (System.Messaging.MessageQueueException ex)
{
     string exception = ex.Message;
}
mq.BeginReceive();

return; 
```

该类的每个成员都被正确反序列化，除了 laneSelections 元素，尽管它在 XML 中明确具有值，但在反序列化消息中计算为空实例。

在分离中，我尝试在类中添加一个列表，并在构造时用值 1-5 填充它。如果这个序列化正确，那么它会告诉我问题出在 LaneSelection 类上，但如果不是，那么问题将出在序列化 List 上。列表未正确序列化。

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T08:02:47.510

可能您需要将 [XmlInclude(typeof(LaneSelection))] 属性添加到您的 ProposalRequestMessage 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:48:39.377

两件事情;

1.  IvtmMessage 声明中有“laneSelections”，但序列化的 XML 是带有大写 L 的“LaneSelections”。Xml 序列化/反序列化区分大小写，这让我不止一次发现
2.  您是否尝试将以下内容添加到 IvtmMessage 类的 LaneSelections 属性中，如下面的代码所示；

属性定义；

```
 [XmlArray("LaneSelections"), XmlArrayElement("LaneSelection")]
 public List<LaneSelection> LaneSelections { get; set; } 
```

如果属性和类上没有正确的 Xml 属性，您将把它留给序列化程序来解释应该如何翻译属性/对象

# mysql - 将 MYSQL 查询转换为 DB2 查询

> ID：14753792
> 
> 赞同：0
> 
> 时间：2013-02-07T14:42:57.753
> 
> 标签：mysql, sql, db2

我有一个在我的 sql 中运行良好的查询，但是相同的查询在 DB2 中给出了错误

这是要求找到每个大陆中最大的国家，显示大陆，名称和人口：然后是查询

```
SELECT continent, name, population FROM world x
WHERE population = 
  (SELECT max(population) FROM world y
      WHERE y.continent=x.continent
   ) 
```

错误是

```
 [IBM][CLI Driver][DB2/NT] SQL0206N "Y.CONTINENT" is not valid in the context where
it is used. SQLSTATE=42703 (SQL-42S22) 
```

任何人都可以帮助我进行更改以使其在 DB2 中工作

您可以在此处查看答案[http://sqlzoo.net/wiki/SELECT_within_SELECT_Tutorial](http://sqlzoo.net/wiki/SELECT_within_SELECT_Tutorial)如果它在第 6 个示例中工作...将引擎更改为 DB2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:47:45.060

这是您可以做到的一种方法：

```
SELECT x.continent, x.name, x.population 
FROM world x
  JOIN 
  (
    SELECT continent, max(population) pop
    FROM world
    GROUP BY continent
  ) y ON x.continent = y.continent AND x.population = y.pop 
```

这是一个用于演示的[SQL Fiddle 。](http://sqlfiddle.com/#!2/50c11/1)

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T18:39:07.493

DB2 表“world”没有名为“CONTINENT”的列，它被定义为“REGION”。您的查询很好，这是表定义不匹配的问题。以下查询完美运行！

```
SELECT REGION, name, population FROM world x
WHERE population = 
  (SELECT max(population) FROM world y
      WHERE y.REGION=x.REGION
   ) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-07T14:46:42.447

我认为问题出在世界 x 和世界 y 上。如果这些是您的表的名称，请尝试将它们放在方括号 [world x] 和 [world y] 中。

如果不是这种情况，请尝试指定 max(population)。要么是 y.population，要么是 x.population

# java - JavaFX - 获取 GridPane 以适合父级

> ID：14753793
> 
> 赞同：17
> 
> 时间：2013-02-07T14:42:59.297
> 
> 标签：java, user-interface, resize, javafx-2, gridpanel

我有一个简单的 GridPane 显示几个标签和一个按钮，但我似乎无法让它适合父 StackPane。我将如何前进并使它充满它所在的任何容器？

```
 GridPane g = new GridPane();
    g.add(new Label("Categories"),0,0);
    g.add(new Label("Content"),1,0);        
    Button newCat = new Button("New Category");
    newCat.setOnAction(new EventHandler<ActionEvent>() {
        @Override public void handle(ActionEvent e) {
            System.out.println("Clicked");
        }
    });       
    g.add(newCat,0,1);
    g.setGridLinesVisible(true);
    StackPane root = new StackPane();
    root.getChildren().add(g);        
    Scene scene = new Scene(root, 300, 250);  
    primaryStage.setScene(scene);
    primaryStage.show(); 
```

UI 真的不是我的强项，任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-11-02T17:39:01.473

你应该看到这个[链接](http://docs.oracle.com/javafx/2/api/javafx/scene/layout/GridPane.html)，尤其是关于**百分比大小**的部分。如果您只有两列，我发现该代码可以工作：

```
GridPane grid = new GridPane();
/* your code */
ColumnConstraints column1 = new ColumnConstraints();
column1.setPercentWidth(50);
grid.getColumnConstraints().add(column1); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-05-19T20:05:09.503

万一有人在寻找答案，这就是它对我的工作方式：

```
@Override
public void start(Stage stage) throws Exception {
    stage.setTitle("Window title");
    GridPane grid = new GridPane();

    gridSetup(grid); // Building my grid elements here (2 columns)

    // Setting columns size in percent
    ColumnConstraints column = new ColumnConstraints();
    column.setPercentWidth(30);
    grid.getColumnConstraints().add(column);

    column = new ColumnConstraints();
    column.setPercentWidth(70);
    grid.getColumnConstraints().add(column);

    grid.setPrefSize(WINDOW_WIDTH, WINDOW_HEIGHT); // Default width and height
    grid.setMaxSize(Region.USE_COMPUTED_SIZE, Region.USE_COMPUTED_SIZE);

    Scene scene = new Scene(grid, WINDOW_WIDTH, WINDOW_HEIGHT);
    stage.setScene(scene);
    stage.show();
} 
```

使用此设置，网格会占用窗口的所有空间并随窗口自动调整大小。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-08-31T05:34:07.667

假设您的布局有 2 列和 3 行，您可以一一定义列和行的大小属性：

```
 <GridPane 
    xmlns:fx="http://javafx.com/fxml/1"    
    id="gridPane" 
    prefHeight="768.0" 
    prefWidth="1024.0">     

    <gridLinesVisible>true</gridLinesVisible> 
    <columnConstraints>
        <ColumnConstraints percentWidth="20"  /> 
        <ColumnConstraints percentWidth="80" />        
    </columnConstraints>

    <rowConstraints>
        <RowConstraints minHeight="50"/> 
        <RowConstraints percentHeight="80"/>  
        <RowConstraints minHeight="50"/>  
    </rowConstraints> 

</GridPane> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-10T03:47:13.260

虽然不明显，但我认为您的 GridPane 已经与其父容器一样大。如果在“Scene scene = new Scene(root, 300, 250);”之前添加以下两行代码，应该可以看到发生了什么。

```
root.setStyle("-fx-background-color: yellow;");
g.setStyle("-fx-border-color: blue;"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-08T18:24:52.870

与其将 GridPane 放在 StackPane 中，不如将 GridPane 添加到 HBox 或 VBox 中。调整 Gridpane 更方便。顺便说一句，您仍然有一些方法，例如 g.setPrefSize(arg0, arg1); 相应地设置您的高度和宽度。

# vb.net - 将表单用作控件时的内存泄漏

> ID：14753798
> 
> 赞同：0
> 
> 时间：2013-02-07T14:43:15.270
> 
> 标签：vb.net, visual-studio, memory-leaks

我建立了一个项目，在一个表单（frmDash）中，我在容器中添加了几个表单作为控件。

```
frmChart.TopLevel = False
frmChart.FormBorderStyle = False
frmChart.ControlBox = False
container.Controls.Add(frmChart) 
```

当我关闭 frmDash 时，内存减少了，但没有预期的那么多。
因此，每次我重新打开 frmDash 时，内存都会比上次打开时增加。
当我关闭 frmDash 时：

```
For each frm as frmChart in container.Controls
   frm.Close
Next

container.Controls.Clear
container.Dispose 
```

在 frmChart 处置方法中，我处置了我拥有的所有东西（数据表、列表、图表 - 我知道我不应该处置其中的一些，但我正在努力找出问题所在）。
有谁知道我做错了什么？

我在[这里](http://social.msdn.microsoft.com/Forums/en/adodotnetdataset/thread/41e1b19a-b5ee-4cf2-ac1e-ff0c9a35b961)找到了这个：
我还想提一下，DataSet.Clear() 和 DataSet.Dispose() 不会使行被 GC 清除。.Clear() 方法将删除数据集中每个数据表中的所有数据行。但是，它不会删除表和关系。另外，.Dispose() 方法是由DataSet MarshalByValueComonent 的基类实现的，所以它不会释放dataset 的托管资源。

要让GC清除所有数据表和数据行，请将ds设置为null，这样原始数据集的所有托管资源都不会被引用，GC最终可以将它们全部清除。另一种方法是使用DataSet.Reset，这样数据集将处于初始化状态，没有添加任何表或关系。

如果这是真的，我必须将每个数据表都设置为空，因为我知道我只是在处理它。

我这样做了，我将我使用的每个数据表都设置为 none ，但内存泄漏仍然存在。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:55:03.957

如果您为控件创建任何事件处理程序，这些也需要被释放。.Net 的 GC 将扫描它的对象以寻找指向该对象的链接。调用 dispose 将阻止您引用该对象，但如果仍然附加事件处理程序，则 GC 认为仍然可以引发该事件。

在 VB.Net 你可以做

```
RemoveHandler frmChart.Load, AddressOf ControlLoad 
```

这将允许 GC 从内存中删除对象。

# java - JDialog 窗口不显示

> ID：14753805
> 
> 赞同：1
> 
> 时间：2013-02-07T14:43:34.303
> 
> 标签：java, swing, jtable, jdialog

我有一个带有 addButton 的 JFrame。

当用户单击按钮时，必须显示 AddDialog 窗口，但我看不到它并且无法添加行

这是我的代码：

```
public class AddDialogS extends JDialog{
BookInformation bookinform=new BookInformation();

public AddDialogS(JFrame owner){
    super(owner,"Add New Book!", true);
    JButton OkButton=new JButton("Ok");
   final JTextField nameTF=new JTextField(10);
   final JTextField dateTF=new JTextField(10);
   final JTextField idTF=new JTextField(10);

    OkButton.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {
            bookinform.setBookName(nameTF.getText());
            bookinform.setBookDate(dateTF.getText());
            bookinform.setBookID(idTF.getText());
            AddDialogS.this.dispose();
        }
    });

    JPanel panel=new JPanel(new FlowLayout());
    panel.add(OkButton);
    panel.add(nameTF);
    panel.add(dateTF);
    panel.add(idTF);
}

public BookInformation getBookInfos(){
    return bookinform;
}
} 
```

我的主要课程：

```
public class MainS extends JFrame{

   final AllBooks allBooks=new AllBooks();
   final JTable Btable=new JTable(allBooks);

   public MainS(){
       JButton AddBookButton=new JButton("Add New Book");
       AddBookButton.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) { 

           AddDialogS adddialog=new AddDialogS(MainS.this);
           BookInformation B_info=adddialog.getBookInfos();
           if(B_info != null){
               allBooks.AddRow(B_info);
           }
        }
    });

    JPanel Bpanel=new JPanel();
    Bpanel.setLayout(new FlowLayout());
    JScrollPane sp=new JScrollPane(Btable);
    Bpanel.add(sp);
    Bpanel.add(AddBookButton);
    this.add(Bpanel);
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    this.setBounds(300, 60, 550, 550);
    this.setVisible(true);
   }

   public static void main(String[] args){
       new MainS();
   }
} 
```

它将向 jtable 添加一个新行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:49:07.500

您应该添加主类`dialog.setVisible(true);`的方法：`actionPerformed()`

```
public class MainS extends JFrame{
...
    public MainS(){
        AddDialogS adddialog=new AddDialogS(MainS.this);
        adddialog.setVisible(true);

        BookInformation B_info=adddialog.getBookInfos();
        ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T14:52:55.360

只是创建对象`JDialog`不会显示它。您必须使用 将其设置为可见`setVisible(true)`。

我也看不到为您的对话框设置的大小。你可以用`setSize(width, height)`这个。

# android - 方向更改：DialogFragment 可见时出现 IllegalStateException

> ID：14753806
> 
> 赞同：5
> 
> 时间：2013-02-07T14:43:40.777
> 
> 标签：android, android-orientation, android-dialogfragment

我想让 Android 处理方向变化。不幸的是，每次打开对话框并发生方向更改时它都会崩溃。我已经怀疑原因但不知道如何处理：

当应用程序第一次启动 backstack 时，如下所示：

```
02-07 15:25:36.517: I/System.out(14541): Added Fragments:
02-07 15:25:36.517: I/System.out(14541):   #0: PortraitModeFragment{41963330 #0 id=0x7f090001 ListViewFragment} 
```

太好了，现在我们打开一个对话框：

```
02-07 15:26:03.316: I/System.out(14541): Added Fragments:
02-07 15:26:03.316: I/System.out(14541):   #0: PortraitModeFragment{41963330 #0 id=0x7f090001 ListViewFragment}
02-07 15:26:03.326: I/System.out(14541):   #1: MyDialogFragment{4199f6a0 #1 MyDialogFragment} 
```

现在旋转设备时：

```
02-07 15:26:37.502: E/AndroidRuntime(14541): FATAL EXCEPTION: main
02-07 15:26:37.502: E/AndroidRuntime(14541): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.testapp/com.example.testapp.MainActivity}: android.view.InflateException: Binary XML file line #11: Error inflating class fragment
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3692)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.ActivityThread.access$700(ActivityThread.java:141)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1240)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.os.Looper.loop(Looper.java:137)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.ActivityThread.main(ActivityThread.java:5039)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at java.lang.reflect.Method.invokeNative(Native Method)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at java.lang.reflect.Method.invoke(Method.java:511)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at dalvik.system.NativeStart.main(Native Method)
02-07 15:26:37.502: E/AndroidRuntime(14541): Caused by: android.view.InflateException: Binary XML file line #11: Error inflating class fragment
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:704)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:270)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.Activity.setContentView(Activity.java:1881)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at com.example.testapp.MainActivity.onCreate(MainActivity.java:17)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.Activity.performCreate(Activity.java:5104)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
02-07 15:26:37.502: E/AndroidRuntime(14541):    ... 12 more
02-07 15:26:37.502: E/AndroidRuntime(14541): Caused by: java.lang.IllegalStateException: Fragment com.example.testapp.fragments.LandscapeModeFragment did not create a view.
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.support.v4.app.FragmentActivity.onCreateView(FragmentActivity.java:303)
02-07 15:26:37.502: E/AndroidRuntime(14541):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:676) 
```

有趣的事实：如果我首先转动设备并随后打开对话框并改变方向，则不会发生这种情况，因为两个片段都已预先加载并且和平地存在于 backstack 中：

```
02-07 15:34:00.015: I/System.out(15412):   #0: PortraitModeragment{419b99b0 #0 id=0x7f090001 ListViewFragment}
02-07 15:34:00.015: I/System.out(15412):   #1: LandscapeModeFragment{419b9b88 #1 id=0x7f090003 LandscapeModeFragment}
02-07 15:34:00.025: I/System.out(15412):   #2: MyDialogFragment{419d1da0 #2 MyDialogFragment} 
```

我不能让用户在使用我的应用程序之前旋转智能手机，那该怎么办？;)

**重现：**

我如何将 Dialog 添加到 backstack：

```
MyDialogFragment myTvShowDialog = new MyDialogFragment();
myTvShowDialog.show(getActivity().getSupportFragmentManager(),myTvShowDialog.TAG); 
```

我所做的是为 MainActivity 创建两个 xml 文件：

1\. res/layout/main.xml（纵向模式）：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"    android:layout_width="match_parent"    android:layout_height="match_parent">
     <TextView android:id="@+id/textView1" android:layout_width="wrap_content"  android:layout_height="wrap_content"  android:text="layout-land/PORTRAIT" />
     <fragment class="com.example.testapp.fragments.PortraitModeFragment"
                        android:id="@+id/fragment" android:layout_weight="1"
                        android:layout_width="0px" android:layout_height="match_parent" android:tag="PortraitModeFragment">
     </fragment>
</LinearLayout> 
```

* * *

2\. res/layout-land/main.xml（横向模式）

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"    android:layout_width="match_parent"    android:layout_height="match_parent" android:orientation="vertical">
    <TextView   android:id="@+id/textView1"   android:layout_width="wrap_content"     android:layout_height="wrap_content"     android:text="layout-land/LANDSCAPE" />
    <fragment class="com.example.testapp.fragments.LandscapeModeFragment"
            android:id="@+id/LandscapeModeFragment" android:layout_weight="1"
            android:layout_width="0px" android:layout_height="0dp" android:tag="LandscapeModeFragment">
     </fragment>
</LinearLayout> 
```

MainActivity.java：

```
public class MainActivity extends FragmentActivity {
    private static final String TAG = "MainActivity";
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.v(TAG, "onCreate()");
        setContentView(R.layout.activity_main);
        getSupportFragmentManager().dump("", null,
                new PrintWriter(System.out, true), null);
    }
} 
```

片段肖像模式：

```
public class PortraitModeFragment extends Fragment {
    @Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View fragment = inflater.inflate(R.layout.portraitmodefragment_layout,
            null);
    Button findViewById = (Button) fragment.findViewById(R.id.button1);
    findViewById.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            MyDialogFragment myDialog = new MyDialogFragment();
            myDialog.show(getActivity().getSupportFragmentManager(),
                    MyDialogFragment.TAG);
        }
    });
    TextView textView = (TextView) fragment.findViewById(R.id.textView1);
    textView.setText(TAG);
    return fragment;
} 
```

片段景观模式：

```
public class LandscapeModeFragment extends Fragment {

    public static final String TAG = "LandscapeModeFragment";

    @Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View fragment = inflater.inflate(R.layout.landscapemode_fragment_layout,
            container, false);
    return fragment;
}
} 
```

Landscapemode_fragment_layout.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
            <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="LANDSCAPEFRAGMENT" />
</LinearLayout> 
```

Portraitmode_fragment_layout_xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
    <Button   android:id="@+id/button1"    android:layout_width="wrap_content"    android:layout_height="wrap_content"     android:text="Button" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-08T14:32:33.160

好吧，我找到了一个同样有效的解决方法。

**第一：问题出在哪里？**

在 layout-xml 中定义的 Fragment 和每个 FragmentManager 添加的 Fragment 具有不同的生命周期 abd 尽管可能会因 FragmentManager 意外行为（异常）导致应用程序崩溃而与 layout-fragments 混淆。

[正如 Dianne Hackborn 在 Google Groups 论坛中提到的那样](https://groups.google.com/forum/?hl=de&fromgroups=#!searchin/android-developers/fragment%2420layout%2420orientation/android-developers/tWln4PFHFo0/gopXeMasYCgJ)

> 在 XML 中定义片段主要是用于将要保留的东西。如果您要添加和删除，您可能应该始终动态地执行此操作。
> 
> 我可以在未来的版本中对此进行研究，但请注意，无论我做什么，你都可以很容易地使用它让自己陷入糟糕的境地——例如，如果你没有片段的唯一包含视图组，你会发生什么在层次结构中的该点删除/添加片段将表现不一致。

所以我们不允许混合世界（FragmentManager-Fragments 和 LayoutXML-Fragments）。不幸的是，这也涉及在运行时添加的 DialogFragments。会发生什么：Android-Framework 将orientation-change 新布局创建的Fragment 添加到backstack 中。FragmentManager 尝试将 DialogFragment 添加到与新创建的 Layout-Fragment 相同的索引上。那就是事情变得混乱并发生 IllegalStateException 的时候。

**那么，解决方法是什么？**

大多数将 Fragment 用于不同方向的示例都涉及将 FrameLayout 定义为容器，以将正确的 Fragment 放入其中。所以我们将一直使用 FragmentManager 并从我们的设计中禁止 LayoutFragments：

ActivityMain 只使用这个简单的 xml 作为它的 contentView：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/fragment_container_id"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent">
</FrameLayout> 
```

并在启动时将正确的 Fragment 注入容器

```
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.mainactivity_framelayout);
    createFragmentIfNotExits();
}
private void createFragmentIfNotExits() {
    int orientation = getResources().getConfiguration().orientation;
    Fragment newFragment;
    if (orientation == Configuration.ORIENTATION_PORTRAIT) {
        newFragment = new TvShowListPortraitModeFragment();
    } else {
        newFragment = new TvShowListLandscapeModeFragment();
    }
    FragmentTransaction ft = getSupportFragmentManager().beginTransaction();
    ft.replace(R.id.fragment_container_id, newFragment);
    ft.commit();
} 
```

**缺点：** 不幸的是，以这种方式无法保留片段的已保存状态。或者至少我仍然需要弄清楚我们如何做到这一点。

我这么多。我不会将此答案标记为“已回答”，因为我并没有真正使它起作用，也许有人会弄清楚并发布一个更简单的解决方案。当然，我会将此标记为正确的。

# ant - JUnit 报告显示空值

> ID：14753810
> 
> 赞同：2
> 
> 时间：2013-02-07T14:43:54.193
> 
> 标签：ant, junit

我正在使用带有 Ant 的 JUnitReport 来生成我的测试用例报告。构建文件成功运行，但显示空值。就像在样式表中一样，我看到框架输出具有

*   测试 0
*   失败 0
*   成功率 NaN
*   时间 0.00

这是我的 build.xml 文件

```
<project name="JunitTest" default="test" basedir="."> 
<property name="testdir" location="./bin" /> 
<property name="srcdir" location="." /> 
<property name="full-compile" value="true" /> 
<property name="test.reports" value="./reports" />

<path id="classpath.base"/>
<path id="classpath.test">

<path id="JUnit 4.libraryclasspath">
      <pathelement location="./lib/junit-4.1.jar"/>
      <pathelement location=".lib/hamcrest-core-1.3.jar"/>
</path>

<pathelement location="${testdir}" />
<pathelement location="${srcdir}" />

<path refid="classpath.base" />

</path> 

<target name="clean" >
    <echo> CLEAN </echo>
    <delete verbose="${full-compile}"> 
        <fileset dir="${testdir}" includes="**/*.class" />
    </delete> 
</target>

<target name="compile" depends="clean">
    <echo> COMPILING </echo>
    <javac srcdir="${srcdir}" destdir="${testdir}" verbose="${full-compile}" >
        <classpath refid="classpath.test"/>
        <classpath refid="JUnit 4.libraryclasspath" />
    </javac>
</target>

<target name="test" depends="compile" >

    <junit printsummary="true" showoutput="true">
        <classpath refid="classpath.test" />
        <classpath refid="JUnit 4.libraryclasspath" />
        <formatter type="plain"  />
        <formatter type="plain"  />

        <test name="com.megacorp.projx.JUnit.AllTests" />
    </junit>

    <junitreport todir="${test.reports}" >
        <fileset dir="${test.reports}">
            <include name="TEST-*.xml" />
        </fileset>
        <report todir="${test.reports}"  format="frames" />
    </junitreport>
    <record name="${test.reports}/test-output.txt" action="start"/>
</target> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T11:39:04.547

`test` 请在您的块中设置 todir 属性

```
<test name="com.megacorp.projx.JUnit.AllTests"  todir="${test.reports}" /> 
```

如果你只是学习junit ant任务，请查看`batchtest`任务。它可以基于过滤器进行测试。

# javascript - 为什么这个 if/else 语句总是执行 if 分支？

> ID：14753820
> 
> 赞同：0
> 
> 时间：2013-02-07T14:44:30.027
> 
> 标签：javascript, jquery

嘿伙计们，我知道存在，`.slideToggle()`但我想稍后添加更多功能。

我不知道我在做什么错，向上滑动可以，但我不能向下滑动。

我不能覆盖我的var吗？如果有人可以帮助我，那就太好了。

```
$(document).ready(function () {

    var resizeValue = true;
    $(".resizeSelect").click(function () {
        if (resizeValue === true) {
            $(".resize").slideUp(

            function () {
                $('.parent').height($('.child').height('100'));
            });
            var resizeValue = false;
        } else {
            $(".resize").slideDown(

            function () {
                $('.parent').height($('.child').height('100'));
            });
            var resizeValue = true
        };
    });
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T14:48:27.367

您不应该在函数中重新定义`resizeValue`变量。只需从中`click`删除（它应该只在-function 的顶部使用）。`var``var resizeValue``ready`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-07T14:48:37.463

因为您在函数中重新声明变量 resizeValue 而不是更新它：

```
$(document).ready(function () {

    var resizeValue = true;
    $(".resizeSelect").click(function () {
        if (resizeValue === true) {
            $(".resize").slideUp(

            function () {
                $('.parent').height($('.child').height('100'));
            });
            //DO NOT DECLARE NEW VARIABLE WITH VAR
            resizeValue = false;
        } else {
            $(".resize").slideDown(

            function () {
                $('.parent').height($('.child').height('100'));
            });
            //DO NOT DECLARE NEW VARIABLE WITH VAR
            resizeValue = true
        };
    });
}); 
```

# javascript - 如何判断一个函数是否为空？

> ID：14753821
> 
> 赞同：2
> 
> 时间：2013-02-07T14:44:31.230
> 
> 标签：javascript, jquery

我正在编写一个网络应用程序（老实说，我不知道如果没有 stackoverflow 我会做什么），但这就是我正在做的事情。

我的用户可以定义自定义函数，马上有人向我指出应该有一种方法来警告用户该函数是空白的。

例如，用户可以编写他的函数看起来像这样

```
cFunctionRun: function () {} 
```

可悲的是，我无法控制如何创建函数，这意味着这很可能会发生。

所以现在我必须想办法告诉用户这个函数不会做任何事情，因为它什么也做不了。如果这是不可能的，那很好，但我认为问它不会有什么坏处。

有关 cFunctionRun 部分的更多信息，请查看这个 stackOverflow 问题[jQuery bind custom function to appended element](https://stackoverflow.com/questions/14738154/jquery-bind-custom-function-to-appended-element/14738582)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:51:42.920

我认为这样的事情应该有效：

假设你有这样的事情：

```
var functions = {
    aFunctionRun: function () {return false;}
    bFunctionRun: function ('foobar') {}
    cFunctionRun: function () {}
} 
```

试试这个代码：

```
function isEmpty(function){
    // Get the string from the function;
    var funcString = function.toString();
    // Cut off the part before the actual content of the function
    funcString = funcString.substr(funcString .indexOf(')'))
        .replace(/function|[(){};]/g,'') // remove the function keyword, and the following characters: (){};
        .trim();                         // remove any leading / trailing whitespaces and 
    return funcString === '';            //check if it's an empty string.
}

isEmpty(functions.aFunctionRun); // returns false
isEmpty(functions.bFunctionRun); // returns true
isEmpty(functions.cFunctionRun); // returns true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:51:06.837

您可以`toString`在函数上使用并删除空格以查看函数是否为空。

```
var isEmpty = cFunctionRun.toString().replace(/\s+/g, '') === 'function(){}'; 
```

# javascript - jQuery 动态更新字段滚动页面

> ID：14753826
> 
> 赞同：0
> 
> 时间：2013-02-07T14:44:39.137
> 
> 标签：javascript, jquery, html

我有一个用户填写的表格，点击“保存”，它被移到一个表格中。从那里他们可以编辑一行或删除它。

但是，每次从表中添加或删除某些内容，或者将字段从表中重新填充回表单（因此从表中删除直到再次保存）时，页面都会跳回顶部。

所以每次用户更新这个区域时，他们都必须向下滚动，这是一个相当大的表单。我的大部分部分都处于崩溃状态，但像我自己一样，我怀疑用户在向下移动时会让它们保持打开状态。

有谁知道是什么原因造成的，是否有任何非常简单的方法可以避免它？我是 jQuery 甚至 JS 的超级新手，我大部分时间都花在了服务器端。

**编辑：添加 HTML：**

```
<div class="scroll">
    <table class="table table-condensed table-striped table-bordered scroll">
        <thead>
            <tr>
                <th>Product</th>
                <th colspan="2">Units</th>
                <th>Pieces</th>
                <th>UOM</th>
                <th>NMFC</th>
                <th>Hazmat</th>
                <th>class</th>
                <th>weight</th>
                <th>L</th>
                <th>W</th>
                <th>H</th>
                <th>Cube</th>
                <th>Density</th>
                <th></th>
                <th></th>
            </tr>
        </thead>
        <tbody id="productTable">
        </tbody>
    </table>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:33:25.150

The most likely culprit is that your actual elements are changing in height, causing the page containing the elements to resize to fit them. From there, this can look like a scrolling action.

On this JSFiddle, try making a lot of elements in the table, then click them to remove them and put them back in the form. You'll see that once you have enough elements, the page will scroll.

[http://jsfiddle.net/turiyag/VUqCB/3/](http://jsfiddle.net/turiyag/VUqCB/3/)

I'm betting that the way you've implemented table updates is to delete the whole table and rebuild it? If so, try doing the incremental updates exemplified in the JSFiddle:

```
$(function() {
    $(":button").click(function(event) {
        //Make a new table row (but don't insert it just yet
        var newTableRow = $("<tr/>");

        //For every textbox, add a corresponding data column to the new table row
        $.each($(":text"), function(index, obj) {
            //Store the id of the textbox the data is from in the "from" attribute.
            newTableRow.append('<td from="' + $(this).prop("id") + '">' + $(this).val() + '</td>');
        });
        //Append the row to the table
        newTableRow.appendTo("table");
        //When the row is clicked
        newTableRow.click(function() {
            //$(this) refers to the row element here
            //For every child element (td element)
            $.each($(this).children(),function(index, obj) {
                //$(this) refers to the td element here
                //In the textbox with the id we previously stored in the from attribute
                //Set the value of that textbox to the value of this td
                $("#" + $(this).attr("from")).val($(this).text());
            });
            //$(this) refers to the row element here
            $(this).remove();
        });
        //Reset the form
        //$("form")[0].reset();
        event.preventDefault();
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:03:20.487

尝试这个

```
$(SAVE/EDIT).click(function () {

  // your code 

  return false; //add this
}); 
```

# c# - C#抽象方法和常用代码

> ID：14753830
> 
> 赞同：2
> 
> 时间：2013-02-07T14:44:47.937
> 
> 标签：c#

我想用抽象方法声明一些继承抽象类的类。 **我也想在子类中的一些方法自动调用一个公共代码（即日志代码）**

```
public abstract class AbstractClass
{
    public abstract void AbstractMethod();
    public void CommonCode()
    {
        //do something
    }
}

public class ChildClass : AbstractClass
{
    public void AbstractMethod()
    {
        //automatically call CommonCode in base class
        //do something
    }
} 
```

活动可以帮助我吗？

问候

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T14:50:06.600

不用太花哨，您可以使抽象方法成为您希望继承者做的事情的“胆量”，并从基类的包装方法中调用它。例如：

```
public abstract class AbstractClass
{
    // Note that this protected since consumers won't call it directly
    protected abstract void AbstractMethod();

    // Instead, consumers will use this method which calls CommonCode
    // before the abstract method.
    public void AbstractMethodWrapper()
    {
        CommonCode();
        AbstractMethod();
    }

    public void CommonCode()
    {
        //do something
    }
}

public class ChildClass : AbstractClass
{
    protected override void AbstractMethod()
    {
        // The wrapper method in the base handles calling common code
        //do something
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:47:28.053

我认为您正在寻找类似以下的内容（如果我理解正确的话）：

```
 public abstract class AbstractClass
    {
        public abstract void AbstractMethod();
        public void CommonCode()
        {
            //do something
        }
    }

    public class ChildClass : AbstractClass
    {
        public override void AbstractMethod()
        {
            //automatically call CommonCode in base class
            //do something
            base.CommonCode();
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:50:45.163

为此，您需要*拦截器*。

我将向您推荐 PostSharp，因为它简单且功能强大。检查例如这篇文章：

*   [http://www.rhyous.com/2012/06/15/aop-implementing-try-catch-in-csharp-with-postsharp/](http://www.rhyous.com/2012/06/15/aop-implementing-try-catch-in-csharp-with-postsharp/)

# php - history.js 后退按钮的问题

> ID：14753832
> 
> 赞同：1
> 
> 时间：2013-02-07T14:44:54.893
> 
> 标签：php, ajax, history.js

我正在使用 history.js 来更新我的网站，效果很好。它是一个基于 PHP 的网上商店，如果它检测到 ajax 请求，则只提供带有主 div 数据的 JSON：

```
if(!empty($_SERVER['HTTP_X_REQUESTED_WITH']) 
    && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest') {} 
```

在加载时，我 ajaxify 我的链接，一种取自 history.js 的 github 的方法：[https ://github.com/browserstate/History.js/](https://github.com/browserstate/History.js/)

```
function ajaxify() {
var History = window.History;
$('a[rel="ajax"]').click(function(e){
    if(History.enabled) {
        e.preventDefault();
        var url = $(this).attr("href");
        var options = {};
        History.pushState(null, 'Shop', url);
    }
    else {
        window.location.replace(url);
    }
});
} 
```

下面是事件处理程序：

```
History.Adapter.bind(window,'statechange',function(){
    var State = History.getState();
    var returnLocation = history.location || document.location;
    var url = returnLocation.pathname;
    var options = searchString(returnLocation.search);
    shopUpdate(url,options)
}); 
```

这是ajax调用：

```
function shopUpdate(url,options) {
     $.ajax({
        url: url,
        type: "GET",
        dataType:'json',
        data: options,
        success: function(data, textStatus, jqXHR){
            $('#shop').html(data.page);
            ajaxify();  
        }
    });
} 
```

有一种情况会破坏一切：一些链接不是“ajaxified”，当我单击几个 ajax 链接，然后是“常规”链接，然后“返回”时，我得到原始 JSON 输出。网址是正确的，当我重新加载时，我得到了我想要的页面。就像 PHP 认为它是 Ajax 并提供 JSON 一样，但历史状态更改并没有触发，因为我通过常规链接到达那里。我很困惑，感谢任何帮助！

谢谢，托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T09:30:02.060

原来这是 Chrome、后退按钮和缓存的问题。我添加`Cache-Control: no-store`到 JSON Header 中，现在它可以工作了。

# image - 如何在 Windows 手机地图上设置不可点击的图像？

> ID：14753834
> 
> 赞同：1
> 
> 时间：2013-02-07T14:45:00.583
> 
> 标签：image, windows-phone-7, map

我正在创建一个 windows phone 7.1 应用程序，并且我正在尝试在地图上设置图像。所以我设法创建了地图视图并且它正在工作，我在它上面设置了一个图像（我正在使用网格控件，并且我`Grid.row = 0`在我的 XAML 代码中同时给出了地图和图像，所以它们出现在另一个之上）。问题是因为图像在地图上方，我无法点击或点击或拖动地图。我猜图像正在捕捉 onclick 事件，它阻止它到达地图。

任何想法如何使地图可访问？当一个东西堆叠在一起时，网格是正确的东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:32:43.843

You should try to set the `IsHitTestVisible` property of the Image to false:

```
<Image IsHitTestVisible="False"> 
```

From [MSDN](http://msdn.microsoft.com/fr-fr/library/system.windows.uielement.ishittestvisible%28v=vs.95%29.aspx):

> If this property is set to false, a UIElement will **not report any input events**, such as MouseLeftButtonDown, and cannot receive focus. **A routed input event that was originated by a different object can still route to or through an object in the object tree** where IsHitTestVisible is false. The object where IsHitTestVisible is false can choose to handle that event, or can leave it unhandled so that it routes further up the object tree.

# android - 使用 twitter api 的 Android 更新个人资料横幅

> ID：14753838
> 
> 赞同：0
> 
> 时间：2013-02-07T14:45:11.807
> 
> 标签：android, twitter

我正在使用 twitter4j 更新个人资料图像。这是代码：

```
Twitter twitter = new TwitterFactory(builder.build())
                    .getInstance(accessToken);
            File image = new File(
                    Environment
                            .getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES),
                    "img.jpg");

            twitter.updateProfileImage(image); 
```

此外，我需要更新 twitter 个人资料横幅。我在 java 文档中创建了 twitter4j 库有方法`updateProfileBanner(java.io.File image)`。但我在代码中找不到它。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:58:19.313

它应该在那里，Twitter 接口从 UsersResources 接口扩展而来：

[http://twitter4j.org/javadoc/twitter4j/api/UsersResources.html#updateProfileBanner%28java.io.File%29](http://twitter4j.org/javadoc/twitter4j/api/UsersResources.html#updateProfileBanner%28java.io.File%29)

您确定您使用的是最新版本的 Twitter4J 吗？它肯定存在于 3.0.3 版中。

# sql - 查找重复行记录并更新另一列

> ID：14753841
> 
> 赞同：-1
> 
> 时间：2013-02-07T14:45:19.997
> 
> 标签：sql, duplicates

我有下表：

```
Destination     Last Result
(555) 319-5170  Disconnect
(555) 319-5170  Duplicate
(555) 319-5170  Duplicate
(555) 261-5000  Duplicate
(555) 261-5000  Duplicate
(555) 261-7325  Busy
(555) 261-7325  Duplicate 
```

我想查找所有重复项`Destination(Phone numbers)`并更新所有匹配电话号码的“最后结果”列，其值不等于“重复”。因此，在上面的 Destination((555) 319-5170) 示例表中，所有匹配电话号码 (555) 319-5170) 的结果为“断开连接”。我的查询如下，但出现错误。

```
update Call
set [last result] = (
select [last result] 
from Call
 WHERE Destination in (select destination from Call group by destination having count(*)>1) and [Last result] != 'Duplicate' and [Last result] != 'No Phone #')
 WHERE Destination in (select destination from Call group by destination having count(*)>1) and [Last result] != 'Duplicate' and [Last result] != 'No Phone #'

Destination     Last Result - EXPECTED OUTPUT
(555) 319-5170  Disconnect
(555) 319-5170  Disconnect
(555) 319-5170  Disconnect
(555) 261-5000  Duplicate
(555) 261-5000  Duplicate
(555) 261-7325  Busy
(555) 261-7325  Busy 
```

提前感谢您提供可能的解决方案的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:06:58.967

您的子查询返回多个结果，这就是您遇到异常的原因。

这个查询应该对你有用（如果我正确理解了你的标准）：

```
UPDATE C
SET [Last Result] = 'Disconnect'
FROM Call C
INNER JOIN
        (
            SELECT Destination
            FROM Call
            WHERE [Last Result] NOT IN ('Duplicate','No Phone #')
            GROUP BY Destination
            HAVING COUNT(*) > 1
        ) Dup ON Dup.Destination = C.Destination
WHERE C.[Last Result] NOT IN ('Duplicate','No Phone #') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:23:33.893

我正在对 JBond312 的回答做一个小改动，

```
UPDATE C
SET [Last Result] = 'Disconnect'
FROM Call C
INNER JOIN
        (
            SELECT Destination
            FROM Call
            WHERE [Last Result] NOT IN ('Duplicate','No Phone #')
            GROUP BY Destination
            HAVING COUNT(Destination) > 1
        ) Dup ON Dup.Destination = C.Destination
WHERE C.[Last Result] NOT IN ('Duplicate','No Phone #') 
```

# python - Python 3：使用 %s 和 .format()

> ID：14753844
> 
> 赞同：26
> 
> 时间：2013-02-07T14:45:24.970
> 
> 标签：python, string, string-formatting

我终于在我的 2.x 代码中切换`%`到`.format()`字符串格式化运算符，以便将来更容易迁移到 3.x。令人惊讶的`%`是，Py3 中不仅保留了 -style 格式，而且还广泛用于标准库代码中。这似乎是合乎逻辑的，因为写作`'(%s)' % variable`比`'({})'.format(variable)`. 但我仍然有疑问。在代码中使用这两种方法是否合适（pythonic？）？谢谢你。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-07T14:50:58.157

Python 3.2 文档说，`%`最终会消失。

[http://docs.python.org/3.2/tutorial/inputoutput.html#old-string-formatting](http://docs.python.org/3.2/tutorial/inputoutput.html#old-string-formatting)

> 由于`str.format()`很新，很多 Python 代码仍然使用`%` 操作符。但是，因为这种旧式的格式化方式最终会从语言中移除，所以`str.format()`一般应该使用。

但正如[@regilero 所说](https://stackoverflow.com/questions/14753844/python-3-using-s-and-format#comment30714285_14753974)，**这句话从 3.3 消失了**，这可能表明情况并非如此。[这里](http://python.6.x6.nabble.com/Status-regarding-Old-vs-Advanced-String-Formating-tp4503327p4504193.html)有一些对话暗示了同样的事情。

从[Python 3.4 开始，第 7.1.1 段](https://docs.python.org/3.4/tutorial/inputoutput.html#old-string-formatting)内容如下：

> % 运算符也可用于字符串格式化。它解释左参数很像 sprintf() 样式的格式字符串，以应用于右参数，并返回此格式化操作产生的字符串。

另请参阅[Python 3.4 4.7.2 printf 样式字符串格式。](https://docs.python.org/3.4/library/stdtypes.html#old-string-formatting)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-05-18T07:27:55.320

“%s”现在是“{}”，因此添加 %s 时将其替换为 {}，您希望将变量添加到字符串中。

```
def main():
    n="Python 3.+" 
    l="looks nice"
    f="does not look practical."

    print("This seems to be the new way {}".format(n)\
      + "will be working, rather than the ' % ',{} but {}".format(l,f))

main()

#In comparison to just injecting the variable 
```

出于说明原因，输出忽略它们的报价

“这似乎是“Python 3.+”的新工作方式，而不是 '%;，“看起来不错”但“看起来不实用。”

# visual-studio-2010 - Visual Studio 如何创建 WebService 客户端

> ID：14753846
> 
> 赞同：0
> 
> 时间：2013-02-07T14:45:30.890
> 
> 标签：visual-studio-2010, wsdl

我们都知道，Visual Studio 提供了一个 WebReference，它实际上是在生成一个代理类，它定义了表示公开的 Web 服务 XML 的实际方法的方法。

但是有人知道它是怎么做到的吗？后面使用哪个库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:50:39.253

SvcUtil.exe

它可以通过 Visual Studio 命令提示符轻松访问。请参阅此[MSDN 链接](http://msdn.microsoft.com/en-us/library/aa347733.aspx)以了解使用情况。

就我个人而言，我已经使用它来为企业服务设置一些测试工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-30T16:44:42.110

**我通过使用 JetBrains DotPeek 找到了这些信息。**

我将 SvcUtil.exe 加载到 DotPeek 中，然后环顾四周。

在回答它使用什么 API 时，它可以做什么有多种选择，但我查看了这些`ExportServiceContracts`选项，它似乎使用

1.  从程序集中提取类型的反射。
2.  然后它使用`System.ServiceModel.Description`数据类型获取 ServiceContract 信息。
3.  然后它使用`System.ServiceModel.Description`名称空间`MetadataExporter`将其导出到它在 WebReference 文件夹中创建的各种文件。

希望这为您提供了如何识别正在发生的事情的起点。当我试图了解框架和其他各种工具时，我发现 DotPeek 非常宝贵。当然，还有许多其他可用的反汇编工具可以使用。

# iphone - QuartzCore.h - 阴影层破坏所有视图动画

> ID：14753856
> 
> 赞同：0
> 
> 时间：2013-02-07T14:46:00.897
> 
> 标签：iphone, ios, cocoa-touch, shadow, quartz-core

当我在我`ViewController`的设备（iOS 5.1、iphone 4S）和模拟器（5.1 ）。

我知道阴影层上有一些额外的绘图，但是一个简单的阴影层阻挡了整个视图的平滑度是否正常？是否有我遗漏的关键点，或者是否有另一种方法可以在视图上添加阴影，从而更平滑？

我正在分享用于在我的用户界面对象上应用阴影的代码；

.h（放置所需的头文件以防万一有人尝试使用该代码）

```
#import <QuartzCore/QuartzCore.h> 
```

.m

```
 self.someView.layer.shadowOffset = CGSizeMake(1.0, 1.0);
    self.someView.layer.shadowColor = [[UIColor blackColor] CGColor];
    self.someView.layer.shadowRadius = 2.0f;
    self.someView.layer.shadowOpacity = 1.0f; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T14:50:10.300

如果您将图像用作阴影，则资源会容易得多，因为不必像使用代码生成的阴影那样多次重新计算图层和可见像素。

# java - Java Android Canvas.drawText(...) 在所有屏幕上都一样大

> ID：14753857
> 
> 赞同：1
> 
> 时间：2013-02-07T14:46:01.317
> 
> 标签：java, android, android-canvas, text-size

我在我的项目中绘制了文本`canvas.drawText(...)`并使用不同的设备对其进行了测试。

但是，文本的大小因屏幕而异。

我试图将它与它相乘，`getResources().getDisplayMetrics().density`但它们的大小仍然略有不同。

有没有办法让文本在不同的设备上具有相同的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:50:50.763

嗨，你可以看看这篇文章，[http://catchthecows.com/](http://catchthecows.com/?p=72) ?p=72 ，我认为它对你有帮助。@Override protected void onSizeChanged(int w, int h, int oldw, int oldh) { super.onSizeChanged(w, h, oldw, oldh);

```
 // save view size
    mViewWidth = w;
    mViewHeight = h;

    // first determine font point size
    adjustTextSize();
    // then determine width scaling
    // this is done in two steps in case the
    // point size change affects the width boundary
    adjustTextScale();
}

void adjustTextSize() {
    mTextPaint.setTextSize(100);
    mTextPaint.setTextScaleX(1.0f);
    Rect bounds = new Rect();
    // ask the paint for the bounding rect if it were to draw this
    // text
    mTextPaint.getTextBounds(mText, 0, mText.length(), bounds);

    // get the height that would have been produced
    int h = bounds.bottom - bounds.top;

    // make the text text up 70% of the height
    float target = (float)mViewHeight*.7f;

    // figure out what textSize setting would create that height
    // of text
    float size  = ((target/h)*100f);

    // and set it into the paint
    mTextPaint.setTextSize(size);
}

void adjustTextScale() {
    // do calculation with scale of 1.0 (no scale)
    mTextPaint.setTextScaleX(1.0f);
    Rect bounds = new Rect();
    // ask the paint for the bounding rect if it were to draw this
    // text.
    mTextPaint.getTextBounds(mText, 0, mText.length(), bounds);

    // determine the width
    int w = bounds.right - bounds.left;

    // calculate the baseline to use so that the
    // entire text is visible including the descenders
    int text_h = bounds.bottom-bounds.top;
    mTextBaseline=bounds.bottom+((mViewHeight-text_h)/2);

    // determine how much to scale the width to fit the view
    float xscale = ((float) (mViewWidth-getPaddingLeft()-getPaddingRight())) / w;

    // set the scale for the text paint
    mTextPaint.setTextScaleX(xscale);
}

@Override
protected void onDraw(Canvas canvas) {
    // let the ImageButton paint background as normal
    super.onDraw(canvas);

    // draw the text
    // position is centered on width
    // and the baseline is calculated to be positioned from the
    // view bottom
    canvas.drawText(mText, mViewWidth/2, mViewHeight-mTextBaseline, mTextPaint);
} 
```

[https://github.com/catchthecows/BigTextButton](https://github.com/catchthecows/BigTextButton)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T10:11:57.127

Paint 类采用以像素为单位的文本大小。如果你要直接通过它来绘制文本，那么你需要在调用paint.setTextSize(float size)之前处理单位转换。始终使用 sp 或 dp 单位，您可能希望至少为小屏幕、普通屏幕、大屏幕和超大屏幕包含单独的 dimens.xml 资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:53:04.687

这是什么

getResources().getDisplayMetrics().density

确实是它使它在具有不同密度的相同屏幕尺寸上看起来相似。欣赏你的举动。

您的问题有两种解决方案。1\. 尝试使用 Large、xlarge 和 normal 布局。在各自的布局上相应地调整它们以使其看起来均匀。

1.  获取画布的屏幕百分比占用率（高度/宽度和画布的右/左/上/下百分比以在不同屏幕上均匀调整它们）。并将其应用为 layoutParams。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-11T20:38:34.680

调用[`Canvas.drawText()`](http://developer.android.com/reference/android/graphics/Canvas.html#drawText(java.lang.String,%20float,%20float,%20android.graphics.Paint))时文本大小首先由传入的`Paint`对象确定，可以通过[`Paint.setTextSize()`](http://developer.android.com/reference/android/graphics/Paint.html#setTextSize(float)). 文本大小会`Canvas`根据画布密度自动缩放，可以使用[`Canvas.getDensity()`](http://developer.android.com/reference/android/graphics/Canvas.html#getDensity()).

**在将要在 Canvas 上绘制的绘制对象上设置文本大小时，使用单位值`dp`or`sp`并让 Canvas 为您处理缩放。**

当然，您可能需要根据屏幕尺寸指定不同的值：[Supporting Multiple Screens](http://developer.android.com/guide/practices/screens_support.html)

# python - 石墨 statsd xaxis 每 2 秒

> ID：14753858
> 
> 赞同：0
> 
> 时间：2013-02-07T14:46:01.833
> 
> 标签：python, linux, node.js, graphite, statsd

我已经安装了石墨、nodejs-statsd（用于接收数据）和 python statsd 客户端（用于发送数据）。

下面是一个测试脚本，它将数据发送到 statsd 进程的 udp 套接字。

```
#!/usr/bin/env python
import time
import random
import statsd
c = statsd.StatsClient('localhost',8125)
c.incr('test')
i = 0
while i <= 10000:
    time.sleep(2)
    digit = random.randrange(200 , 999)
    c.timing('stats.timed',digit)
    i = i + 1 
```

因为它每 2 秒发送一次数据，但是石墨/statsd 每 60 秒渲染一次图形，x 轴也在 60 秒内，知道如何将 x 轴点设置为 2 秒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:26:14.687

对于石墨，您必须正确配置存储模式。我建议你看看这个： http: [//graphite.wikidot.com/getting-your-data-into-graphite](http://graphite.wikidot.com/getting-your-data-into-graphite)。具体步骤2。

Statsd 每 10 秒将指标刷新到石墨。您可以使用 flushInterval 选项将其更改为 2 秒。

# ios - 与 NSMutableArray 相比，我可以修改 NSArray 内的数据吗？

> ID：14753861
> 
> 赞同：2
> 
> 时间：2013-02-07T14:46:12.177
> 
> 标签：ios, nsmutablearray, nsarray

我发现了很多关于`NSMutableArray`vs的讨论`NSArray`。这很有趣，我知道您不能在 NSArray 中添加或删除对象

但是是否可以更改 a 中的对象`NSArray`？

我的意思是，如果我有 a `NSArray`of `NSNumber`，我可以更改`NSNumber`中的`NSArray`还是应该使用 a`NSMutableArray`来修改 中的对象的值`NSArray` ？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T14:50:28.190

`NSArray`不允许您**交换**元素（也不附加或删除它们）。如果你有一个`NSArray`可变*对象*，比如说`NSMutableString`你可以在不改变数组的情况下修改对象。

但是，由于 Cocoa 不包含可变变体，`NSNumber`因此您无法对数字对象执行此操作。

例子：

```
// immutable array, immutable elements: no way to change anything.
NSArray *array1 = @[@1, @2, @3];

// immutable array of mutable elements:
NSArray *array2 = @[[@"1" mutableCopy], [@"2" mutableCopy], [@"3" mutableCopy]];
NSLog(@"Step 1: %@", array2); // prints "1, 2, 3"

// now we change one of the elements of the immutable array:
[array2[0] appendString:@".1"];
NSLog(@"Step 2: %@", array2); // prints "1.1, 2, 3" 
```

长话短说：

> 我可以修改 NSArray 中的数据吗？

是的。

# c - Beej 的数据报客户端网络指南

> ID：14753862
> 
> 赞同：0
> 
> 时间：2013-02-07T14:46:12.607
> 
> 标签：c, sockets, datagram

也许我还没有完全醒来，但我正在阅读 Beej 关于数据报套接字的网络编程指南

[https://beej.us/guide/bgnet/html/multi/clientserver.html#simpleserver](https://beej.us/guide/bgnet/html/multi/clientserver.html#simpleserver)

我对客户端的初始部分感到困惑。演示中没有指定命令行参数，但是，代码中似乎有多个调用来检查参数计数。例如，在第一个 if 语句中，检查计数是否为 3，如果不是，则程序退出。

```
 if (argc != 3) {
    fprintf(stderr,"usage: talker hostname message\n");
    exit(1);
} 
```

有人可以解释这里发生了什么吗？

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T14:47:23.263

他希望程序使用两个参数“hostname”和“message”来调用，这两个参数分别是`argv[1]`和`argv[2]`，`argv[0]`保留为可执行文件的名称`./talker`等。

“talker”程序向“listener”程序发送消息，它需要知道发送什么（消息）以及发送到哪里（主机名）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:49:25.883

我认为您正在阅读错误的代码。[talker](http://beej.us/guide/bgnet/output/html/multipage/clientserver.html#indexId434909-140)程序确实采用了通常的参数`argc`和`argv`参数`main()`。

# php - preg_match_all 和正则表达式

> ID：14753863
> 
> 赞同：0
> 
> 时间：2013-02-07T14:46:11.957
> 
> 标签：php, regex, preg-match

我有大约 10-15 个链接的页面，所有链接都在我的控制范围内，并以名人之类的词结尾我想过滤所有以该词结尾的链接，所以我写了这个

```
 $regex='|<a.*?href="(.*_celebrity)"|';

    preg_match_all($regex,$result21,$parts);
$links=$parts[0];
foreach($links as $link){
{
    echo $link."<br>";
    mysql_query ("INSERT INTO tablea(linkssas) VALUES ('$link')");
    } 
```

它完成工作并过滤所有以_celebrity结尾但输出未进入数据库的链接。所有链接都输入一行，它不是普通的，它是锚文本的形式，但我想要数据库中的普通链接因为我正在使用 foreach 所以所有链接都应该在单独的行中输入，但所有行都在单行中输入，并且以锚点的形式输入`http://xyz.com/edje/jjeieied_celebrity">A</a>`

但我只想要数据库中的链接

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:53:45.670

我觉得有义务给你介绍一下[`DOMDocument`](http://www.php.net/domdocument)：

```
$d = new DOMDocument();
$d->loadHTML($result21);

$suffix = "_celebrity"; $suffix_len = strlen($suffix);

foreach ($d->getElementsByTagName('a') as $link) {
    $href = $link->getAttribute('href');
    if ($href && substr($href, -$suffix_len) === $suffix) {
        // do your insert here
    }
} 
```

或者，使用[`XPath`](http://www.php.net/domxpath)代替`getElementsByTagName`：

```
$xp = new DOMXPath($d);

foreach($xp->query('//a[substring(@href, string-length(@href) - 9) = "_celebrity"]') as $node) {
    echo $node->getAttribute('href');
} 
```

这是来自我们聊天室的消息：

[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:50:38.857

您可能希望循环通过 $parts[1] 而不是 $parts[0]。

[http://php.net/manual/en/function.preg-match-all.php](http://php.net/manual/en/function.preg-match-all.php)

# python - Python：函数式组合与 **kwargs

> ID：14753873
> 
> 赞同：2
> 
> 时间：2013-02-07T14:47:02.783
> 
> 标签：python, functional-programming, composition, higher-order-functions

我对`compose`python中的函数感到困惑。根据我的阅读，有两种可能的用途：

```
compose(f,g)(x) ~> f(g(x)) 
```

和

```
compose(f,g, unpack=True)(x) ~> f(*g(x)) 
```

后者用于

```
def f(a,b):
  return a + b
def g(x):
  return [x,x] 
```

这样上面的代码将导致

```
compose(f,g, unpack=True)(x) ~> f(*g(x)) ~> f(x,x). 
```

> **现在的问题是：**在这种情况下如何处理关键字？

更具体地说，撰写功能似乎仅适用于具有签名的功能

```
def f(*args):
    ...
def g(*args):
    ... 
```

以函数调用为例

```
f(4,5, extra = some_info). 
```

是否可以通过 compose 将其写为复合材料？如果是这样，`g`应该以以下形式**解压缩输出**

```
***g(x) = 4,5,extra=some_info(x). 
```

# sql - 为 JSON 数据文件设计文件系统和数据库

> ID：14753875
> 
> 赞同：0
> 
> 时间：2013-02-07T14:47:09.677
> 
> 标签：sql, json, mongodb, filesystems, webserver

我目前有一个接受 JSON 文件（包含一些用户事务数据的 JSON 序列化对象）并将其存储到服务器中的 API。每个这样的 JSON 文件都有一个唯一的全局 id 和一个与之关联的唯一用户。然后，用户应该能够查询与他关联的所有 JSON 文件，并生成一堆在这些文件之上计算的聚合结果。

**编辑：

需要存储的典型 JSON 文件如下所示：

[{"sequenceNumber":125435,"currencyCode":"INR","vatRegistrationNumber":"10868758650","re​​ceiptNumber":{"value":"1E466GDX5X2C"},"retailTransaction":[{"otherAttributes":{} ,"lineItem":[{"sequenceNumber":1000,"otherAttributes":{},"sale":{"otherAttributes":{},"description":"Samsung Galaxy S3","unitCostPrice":{"quantity" :1,"value":35000},"discountAmount":{"value":2500,"currency":"INR"},"itemSubType":"SmartPhone"}},{"sequenceNumber":1000,"otherAttributes" :{},"customerOrderForPickup":{"otherAttributes":{},"description":"iPhone5","unitCostPrice":{"quantity":1,"value":55000},"discountAmount":{"value":5000,"currency":"INR"},"itemSubType":"SmartPhone"}}],"total ":[{"value":35000,"type":"TransactionGrossAmount","otherAttributes":{}}],"grandTotal":90000.0,"reason":"Delivery"},null]}]

上面的 JSON 是一个复杂对象的序列化版本，它包含单个或其他类的对象数组作为属性。所以“receiptNumber”是 JSON 文件的通用 ID。

要回答 Sammaye 的问题，我需要查询诸如 customerOrderForPickup 的数量和价值或交易的总金额之类的东西，并作为各种此类交易 JSON 的集合**

我想对如何进行一些建议：1）将这些JSON文件存储在服务器上，即文件系统，即2）我应该使用什么样的数据库来查询这些具有如此复杂结构的JSON文件

我的研究产生了两种可能性：1）使用 MongoDB 数据库存储对象的 JSON 代表并通过数据库进行查询。JSON 文件将如何存储？将事务 JSON 存储在 MongoDB 数据库中的最佳方式是什么？2) 将包含唯一全局 ID、用户 ID 和服务器上 JSON 文件地址的 SQL 数据库与这些文件上的聚合代码耦合。我怀疑这是否可以缩放

如果有人对这个问题有任何见解，我会很高兴。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:13:26.020

我可以看到 2 个选项：

1.  存储在MongoDB中，如您所说，只需要创建一个集合，并将每个JSON文件直接作为文档添加到集合中。您可能需要稍微更改 JSON 的布局以提高可查询性。
2.  存储在 HDFS 中，并在其上分层 Hive。Hive 中有一个 JSON SerDe（Serializer Deserializer）。这也将很好地扩展。

# visual-studio-2010 - VS2010 和 boost::posix_time 的编译问题

> ID：14753877
> 
> 赞同：0
> 
> 时间：2013-02-07T14:47:12.750
> 
> 标签：visual-studio-2010, boost

我遇到了一个让我发疯的问题。我已经使用以下计时器条目结构实现了一个计时器：

```
typedef std::multimap<boost::posix_time::ptime, events::ITimeout*> TEntryMap;
TEntryMap entries_; 
```

我将元素插入到多重映射中：

```
boost::posix_time::ptime tTimeout = boost::posix_time::microsec_clock::local_time() + boost::posix_time::milliseconds(timeout);
entries_.insert(std::make_pair(tTimeout, ptr)); // ptr is the events::ITimeout object 
```

并在一个翻译单元（cpp 文件）中完美运行。但是，现在我需要将此功能移动到另一个 cpp 文件，现在我得到一个编译错误：

```
1>Build started 2013-02-07 15:38:18.
1>ClCompile:
1>  EventDispatcher.cpp
1>c:\program files (x86)\microsoft visual studio 10.0\vc\include\utility(260): error C2678: binary '=' : no operator found which takes a left-hand operand of type 'const boost::posix_time::ptime' (or there is no acceptable conversion)
1>          ....\boost\boost\date_time\posix_time\ptime.hpp(57): could be 'boost::posix_time::ptime &boost::posix_time::ptime::operator =(const boost::posix_time::ptime &)'
1>          while trying to match the argument list '(const boost::posix_time::ptime, const boost::posix_time::ptime)'
1>          c:\program files (x86)\microsoft visual studio 10.0\vc\include\utility(259) : while compiling class template member function 'std::pair<_Ty1,_Ty2> &std::pair<_Ty1,_Ty2>::operator =(std::pair<_Ty1,_Ty2> &&)'
1>          with
1>          [
1>              _Ty1=const boost::posix_time::ptime,
1>              _Ty2=events::ITimeout *
1>          ]
1>          ....\eventdispatcher.cpp(72) : see reference to class template instantiation 'std::pair<_Ty1,_Ty2>' being compiled
1>          with
1>          [
1>              _Ty1=const boost::posix_time::ptime,
1>              _Ty2=events::ITimeout *
1>          ]
1> 
```

我一无所知，为此苦苦挣扎了 2 个小时。我认为工作实施和非工作实施之间没有区别。相同的构造，相同的多图，相同的包含，相同的一切！;(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T08:22:23.250

我找到了问题的原因，它闻起来像 VS2010 C++ 编译器错误（使用 std::remove_if 时）。在稍后使用该构造的类中的函数实现中，我尝试使用以下方法删除地图中的元素：

```
void removeEntry(events::ITimeout* p)
{
    std::remove_if(entries_.begin(), entries_.end(),
        [&](TEntryMap::value_type& entry)->bool
        { 
             return (entry.second == p);
        }
    );
} 
```

将该代码更改为：

```
void removeEntry(events::ITimeout* p)
{
    TEntryMap::iterator it = std::find_if(entries_.begin(), entries_.end(),
        [&](TEntryMap::value_type& entry)->bool
        { 
             return (entry.second == p);
        }
    );
    if (it != entries_.end()) entries_.erase(it);
} 
```

使插入代码工作。去搞清楚。请注意，即使我使用基于结构的谓词而不是 lambda 闭包，它仍然不适用于 std::remove_if...

# azure - 有没有办法在 Azure 缓存到期时运行自定义代码？（可以访问最后一个缓存的值）

> ID：14753884
> 
> 赞同：5
> 
> 时间：2013-02-07T14:47:28.467
> 
> 标签：azure, azure-caching

我的意思是一种在某些缓存值到期时调用的事件或回调。假设这个回调应该被赋予当前缓存的值，例如，将它存储在缓存之外的其他地方。

为了找到这种方法，我查看了[通知](http://msdn.microsoft.com/en-us/library/windowsazure/hh914156.aspx)选项，但它们看起来适用于具有缓存的显式操作，例如添加或删除，而过期是一种隐式发生的事情。我发现在缓存值过期并变为 后的许多分钟内，这些回调都没有被调用`null`，而如果我`DataCache.Remove`显式调用，则在轮询间隔内正常调用（错误，请参见下面的更新）。

我发现这种行为很奇怪，因为 ASP.Net 有这样的回调。[您甚至可以在 SO 上](https://stackoverflow.com/questions/6116223/callback-when-cache-expires-in-asp-net)找到如何使用它的说明。

另外，我尝试[了 DataCache Events](http://msdn.microsoft.com/en-us/library/windowsazure/hh147550.aspx)。它是在 MSDN 中写的，字面意思是

> 此 API 支持 .NET Framework 基础结构，不打算直接从您的代码中使用。

尽管如此，我为这些事件创建了一个处理程序，看看我是否可以像测试它的参数一样`CacheOperationStartedEventArgs.OperationType == CacheOperationType.ClearCache`，但它似乎是徒劳的。

此刻，我开始思考缺少所需回调的问题的解决方法。因此，也欢迎提出如何实施它们的建议。

更新。经过更细心和耐心的测试，我发现通知`DataCacheOperations.ReplaceItem`是在到期后发送的。遗憾的是，我没有找到获取过期前缓存的值的方法。

# typescript - Typescript 0.8.2 - 使用指定的输出文件在保存时编译

> ID：14753887
> 
> 赞同：2
> 
> 时间：2013-02-07T14:47:37.743
> 
> 标签：typescript

除了指定输出目录之外，我正在尝试配置一个打字稿解决方案来保存编译（我工作得很好）。

这甚至可能吗？我在 typescript 目标文件中看到检查是否指定了 --out 文件。如果是，则禁用保存时编译。

```
<TypeScriptCompileOnSaveEnabled Condition="'$(TypeScriptEnableCompileOnSave)' != 'false' and '$(TypeScriptOutFile)' == ''">true</TypeScriptCompileOnSaveEnabled> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T19:56:10.523

目前不支持此功能。已经记录了一个问题以跟踪此问题：http: [//typescript.codeplex.com/workitem/854](http://typescript.codeplex.com/workitem/854)

# java - Java if 语句总是返回 true

> ID：14753888
> 
> 赞同：0
> 
> 时间：2013-02-07T14:47:41.700
> 
> 标签：java, if-statement, null

我试图通过检查空值来验证来自 Swing 表单的一些输入。但是 checkFirstName 方法总是返回 true。因此，例如，如果我在表单上将名字留空，即使该字段为空，它也会返回 true。

这是我的两种方法，第一种在用户单击保存按钮时触发。

```
public void saveNewCustomer() throws SQLException, ClassNotFoundException {

        boolean dbOK = false;//boolean to check if data input is not null

        System.out.println(dbOK);
        String firstName = txtNCustomerFirstName.getText();
        String lastName = txtNCustomerLastName.getText();

        if (checkFirstName(firstName)) {
            dbOK = true;
        } else {
            lblNCustFirstNameError.setText("First Name Must be Entered");
            dbOK = false;
        }
        System.out.println(dbOK);

        if (dbOK) {
            dbConnector.insertSignup(firstName, lastName);
            System.out.println("Success");
        } else {
            System.out.println("Error");
        }
    }

    public boolean checkFirstName(String firstName) {
        boolean allOK = false;
        System.out.println(allOK);

        if (firstName != null) {
            allOK = true;
        } else {
            allOK = false;
        }
        return allOK;
    } 
```

我是否做错了什么，因为这对我来说应该返回 false，因为 firstname 字段为空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:49:32.187

`String`永远不会为空，将`String`是空的。检查`firstName.isEmpty()`。我仍然建议您也保留对 null 的检查：

```
public boolean checkFirstName(String firstName) {
    boolean allOK = false;
    System.out.println(allOK);

    if (firstName != null && !firstName.isEmpty()) {
        allOK = true;
    } else {
        allOK = false;
    }
    return allOK;
} 
```

编辑：正如 Windle 所指出的，您可能想检查字符串是否至少有一个非空格：

```
if (firstName != null && !firstName.trim().isEmpty()) 
```

您还可以执行更复杂的验证 - 例如，如果您想确保在修剪后用户名中没有空格。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:50:17.430

> 因此，例如，如果我在表格上将名字留空

您只是在检查`null`，还需要进行空`("")`字符串检查。

它应该是这样的：

```
if (firstName != null && !"".equals(firstName.trim()) { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:50:40.277

该`txtNCustomerFirstName.getText`方法返回一个空字符串。您可以更改`checkFirstName`方法的 if 语句以检查空字符串：

```
if (firstName != null && !firstName.isEmpty()) { 
```

如果您没有 Java 6+，则可以`firstName.length() > 0`使用`isEmpty`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-07T14:51:09.940

据我所知，您在 saveNewCustomer() 中调用的 getText() 方法将返回一个空字符串而不是 null。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T14:53:16.400

> 因此，例如，如果我在表单上将名字留空，即使该字段为空，它也会返回 true。

这就是你的推理错误的地方。当您将文本字段留空时，`getText()`返回**一个空字符串**，即不`""`为*​​null*。您应该检查空虚而不是`null`.

```
if (!firstName.isEmpty()) { ... } 
```

如果`firstName`也可能`null`（例如，当它来自另一个来源时），您应该事先检查：

```
if (firstName != null && !firstName.isEmpty()) { ... } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-07T14:57:23.510

正如其他答案所建议的那样，使用空字符串检查进行空检查。我会说在进行空检查之前还要修剪前导和尾随空格，因为实际上您想避免这种情况。

```
if (firstName != null && !firstName.trim().isEmpty()) { ... } 
```

# c# - 比较两个可以为空的日期

> ID：14753893
> 
> 赞同：2
> 
> 时间：2013-02-07T14:47:48.963
> 
> 标签：c#, datetime, comparison, nullable

我有两个日期属性，它们与我从一个对象映射到另一个对象完全相同。如果我将它们进行如下比较，则返回 false：

```
if(obj1.d1 == obj2.d1)
{
} 
```

他们都是`{01/06/2011 15:44:32}`。

我不能使用`DateTime.Compare`，因为它们可以为空。比较可空日期的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T14:50:07.067

检查这些日期的实际刻度，它们可能会有所不同。请注意，`DateTime`将 100 ns 间隔记录为其最小单位。格式化时不会显示这些`DateTime`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-11T21:18:28.723

您可以使用该方法比较可空对象，包括可空日期[`Nullable.Compare<T>()`](http://msdn.microsoft.com/en-us/library/dxxt7t2a(v=vs.110).aspx)。

```
if(Nullable.Compare(obj1.d1, obj2.d1) == 0)
{
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:50:26.100

这应该有效，请检查：

```
var now = DateTime.Now;
DateTime? d1 = now;
DateTime? d2 = now;

Console.WriteLine(d1 == d2); // Output: True 
```

我假设它们实际上*并不*完全相同，即它们以毫秒或刻度为单位不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-07T16:26:59.113

正如其他答案所表明的那样，默认比较器适用于可为空的 DateTime 对象。您在评论中询问如何比较日期的舍入形式。你会想要这样的东西：

```
if (dt1.EqualsRounded(dt2)) 
```

以下是执行此操作所需的所有代码。它完全支持可空和不可空的日期时间。它实现了两者`IComparer<T>`，`IEqualityComparer<T>`因此您也可以在排序列表时使用它（例如）。像上面这样的简单情况有扩展方法，并且有重载来提供不同的舍入间隔。如果不指定一个，则默认舍入到最接近的整秒。享受！

```
public static class DateTimeExtensions
{
    public static DateTime RoundToNearestInterval(this DateTime dateTime, TimeSpan interval)
    {
        // Adapted from http://stackoverflow.com/questions/1393696/c-rounding-datetime-objects

        // do the rounding
        var intervalTicks = interval.Ticks;
        var ticks = (dateTime.Ticks + (intervalTicks / 2) + 1) / intervalTicks;
        var totalTicks = ticks * intervalTicks;

        // make sure the result is not to low
        if (totalTicks < 0)
            totalTicks = 0;

        // make sure the result is not to high
        const long maxTicks = 0x2bca2875f4373fffL; // DateTime.MaxTicks
        if (totalTicks > maxTicks)
            totalTicks = maxTicks;

        // return the new date from the result
        return new DateTime(totalTicks, dateTime.Kind);
    }

    public static bool EqualsRounded(this DateTime x, DateTime y)
    {
        return x.EqualsRounded(y, TimeSpan.FromSeconds(1));
    }

    public static bool EqualsRounded(this DateTime x, DateTime y, TimeSpan interval)
    {
        var comparer = new RoundedDateTimeComparer(interval);
        return comparer.Equals(x, y);
    }

    public static bool EqualsRounded(this DateTime? x, DateTime? y)
    {
        return x.EqualsRounded(y, TimeSpan.FromSeconds(1));
    }

    public static bool EqualsRounded(this DateTime? x, DateTime? y, TimeSpan interval)
    {
        var comparer = new RoundedDateTimeComparer(interval);
        return comparer.Equals(x, y);
    }

    public static int CompareRounded(this DateTime x, DateTime y)
    {
        return x.CompareRounded(y, TimeSpan.FromSeconds(1));
    }

    public static int CompareRounded(this DateTime x, DateTime y, TimeSpan interval)
    {
        var comparer = new RoundedDateTimeComparer(interval);
        return comparer.Compare(x, y);
    }

    public static int CompareRounded(this DateTime? x, DateTime? y)
    {
        return x.CompareRounded(y, TimeSpan.FromSeconds(1));
    }

    public static int CompareRounded(this DateTime? x, DateTime? y, TimeSpan interval)
    {
        var comparer = new RoundedDateTimeComparer(interval);
        return comparer.Compare(x, y);
    }
}

public class RoundedDateTimeComparer : 
    IComparer<DateTime>, IComparer<DateTime?>,
    IEqualityComparer<DateTime>, IEqualityComparer<DateTime?>
{
    private readonly TimeSpan _interval;

    public RoundedDateTimeComparer(TimeSpan interval)
    {
        _interval = interval;
    }

    public int Compare(DateTime x, DateTime y)
    {
        var roundedX = x.RoundToNearestInterval(_interval);
        var roundedY = y.RoundToNearestInterval(_interval);
        return roundedX.CompareTo(roundedY);
    }

    public int Compare(DateTime? x, DateTime? y)
    {
        return x.HasValue && y.HasValue ? Compare(x.Value, y.Value) : (y.HasValue ? 1 : (x.HasValue ? -1 : 0));
    }

    public bool Equals(DateTime x, DateTime y)
    {
        var roundedX = x.RoundToNearestInterval(_interval);
        var roundedY = y.RoundToNearestInterval(_interval);
        return roundedX.Equals(roundedY);
    }

    public bool Equals(DateTime? x, DateTime? y)
    {
        return x.HasValue && y.HasValue ? Equals(x.Value, y.Value) : x.Equals(y);
    }

    public int GetHashCode(DateTime obj)
    {
        var rounded = obj.RoundToNearestInterval(_interval);
        return rounded.GetHashCode();
    }

    public int GetHashCode(DateTime? obj)
    {
        return obj.HasValue ? GetHashCode(obj.Value) : 0;
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-07T14:49:45.543

你不能在使用之前检查它们是否为空`.Compare`吗？

# python - Python 2.7：如何在 Windows 上将新行的分隔符限制为 '\n'？

> ID：14753894
> 
> 赞同：3
> 
> 时间：2013-02-07T14:47:53.403
> 
> 标签：python, windows, python-2.7

当我在 Windows 上运行的 python 2.7 脚本中写入文本文件时，新行分隔符是`'\r\n'`，但我希望它是`'\n'`。

我曾尝试使用[`open`](http://docs.python.org/2/library/io.html#io.open)with `newline='\n'`，但它引发了异常。

```
import io
f= io.open("myfile.txt", "w", newline="\n")
f.write(”aaaaaaa”)
f.close() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T15:05:18.097

以下内容对我有用，并使用`\n`代替`\r\n`

```
 import io
 f= io.open("myfile.txt", "w", newline="\n")
 #note the io module requires you to write unicode
 f.write(unicode("asdasd\nasdasasd\n"))
 f.close() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T14:56:30.510

如果您使用`open("file.ext", "wb")`以二进制模式打开文件，您将获得所需的行为。仅完成`"\n"`to的转换：`"\r\n"`

*   如果您使用的是 Windows 并且
*   以文本模式打开文件，即`open("file.ext", "w")`

# wcf - dotnet winfom 客户端和配置条目使用 WCF

> ID：14753897
> 
> 赞同：0
> 
> 时间：2013-02-07T14:48:03.840
> 
> 标签：wcf

我是 WCF 的新手，但我对 Web 服务（ASMX 文件）有点熟悉

## 我有几个关于 wcf 客户端配置条目的问题

当我们创建任何 Web 服务 (ASMX) 代理时，不会像下面的条目那样在配置文件中添加任何内容，但在 WCF 的情况下，会添加下面的条目。我只需要知道以下条目的重要性。

1）如果我删除这些下面的条目会发生什么......我不能从客户端调用服务吗？

2）当我们从客户端调用Web服务时告诉我，如果客户端添加了多个端点地址，我该怎么说我的服务将使用哪个端点地址来调用服务？

3) 当我进行服务调用时，如何从cient 方面明确提及Web 服务URL？

```
<system.serviceModel>
    <bindings>
        <wsDualHttpBinding>
            <binding name="WSDualHttpBinding_ICommService" closeTimeout="00:01:00"
                openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:00:05"
                bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard"
                maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                messageEncoding="Text" textEncoding="utf-8" useDefaultWebProxy="true">
                <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                    maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                <reliableSession ordered="true" inactivityTimeout="00:10:00" />
                <security mode="Message">
                    <message clientCredentialType="Windows" negotiateServiceCredential="true"
                        algorithmSuite="Default" />
                </security>
            </binding>
        </wsDualHttpBinding>
    </bindings>
    <client>
        <endpoint address="http://localhost/CommService/"
            binding="wsDualHttpBinding" bindingConfiguration="WSDualHttpBinding_ICommService"
            contract="Services.ICommService" name="WSDualHttpBinding_ICommService">
            <identity>
                <dns value="localhost" />
            </identity>
        </endpoint>
    </client>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:12:39.637

是的，这些是 WCF 所需的重要配置。您可以通过配置文件或代码提供它。

1）您需要在某个地方提供它。如果你把它们从配置中拿走。您应该在代码中执行此操作。

2) WCF 具有 ABC 的基本规则。地址，绑定和合同。同样，如果它已经在您的配置文件中，您不必说什么。

对于多个客户。您还可以从配置文件中提及端点名称。例如

```
MyClient someClientObject = new MyClient("WSDualHttpBinding_ICommService"); 
```

3) 默认情况下，当您添加服务引用操作时，WCF 运行时会为您提供客户端代理。

您可以通过简单的方式做到这一点。无参数。

MySVCClient svcproxy = new MySVCClient();

你需要有你的服务合同的条目。您还可以使用如下构造函数...使用端点地址和投标等。

```
BasicHttpBinding myBinding= new BasicHttpBinding(SecurityMode.None);   
EndpointAddress endpointAdd= new EndpointAddress("http://localhost/CommService/");
MySVCClient svcproxy = new MySVCClient (myBinding, endpointAdd); 
```

由于您在这里定义了代码中的所有内容。您不需要配置文件中的任何内容。

# xcode - Xcode 媒体播放器监视器

> ID：14753898
> 
> 赞同：0
> 
> 时间：2013-02-07T14:48:06.380
> 
> 标签：xcode, media-player, movie

如何监控媒体播放器的每秒，以便可以根据视频时间执行动作？

解决方案可能是计时器，但我希望有一个标准的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:34:52.050

What do you mean with "MediaPlayer"? Are talking about a QTMovieView ([QTMovieView Class Reference](https://developer.apple.com/library/mac/#documentation/quicktime/Reference/QTKitFramework/Classes/QTMovieView_Class/Reference/Reference.html))?

If so, you can get the QTMovie object by calling:

```
[myQTMovieView movie] 
```

and then get its

```
[aMovie currentTime] 
```

Please note that this only applies to OS X and not to iOS. Please specify more details about your question.

# windows-8 - 为什么我的本地成功应用在通过商店帐户与保留的应用名称相关联后在 WACK 上失败？

> ID：14753899
> 
> 赞同：0
> 
> 时间：2013-02-07T14:48:11.370
> 
> 标签：windows-8, visual-studio-2012, windows-store-apps, app-certification-kit

我为 Windows 8 商店准备了一个简单的测验应用程序。我的应用程序在构建和创建本地包后成功通过 WACK，而无需登录到商店帐户，但是当我登录到我的商店帐户时，它失败（性能测试：未检测到启动），将应用程序与保留的应用程序名称相关联并创建包提交。

所以，我提交了我的应用程序 3 次，由于这些包失败，它总是不符合要求 3.8。我应该怎么办？有什么我想念的吗？我正在处理这个问题很多天，但我找不到正确的解决方案。问候，哈坎

* * *

我下载并安装了 Visual Studio 2012 Update 1。我使用的 WACK 工具是最新的。我的 Windows 8 帐户和 Windows 8 应用商店帐户相同。然而; 我仍然有问题。

这就是我正在做的；

我重新创建了我的应用程序项目。成功构建应用程序并创建（未与存储关联）应用程序包，而无需登录到 Visual Studio 上的存储帐户。创建这些包后，我在 Visual Studio 上启动了 WACK，应用程序成功通过。然后; 我清理了解决方案并创建了要上传商店的包（我在 Visual Studio 上登录了我的商店帐户并选择了我保留的应用程序名称）。创建包后，我再次启动了 WACK，但这次应用程序失败了；“未检测到启动”错误。

我不认为还有什么可做的。每次提交失败后我都会感到无聊。我应该怎么办？有人有什么主意吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:22:39.840

要求 3.8 非常具体，与您的应用名称无关。来自[App Store 要求](http://msdn.microsoft.com/en-us/library/windows/apps/hh694083.aspx)：

> 3.8 您的应用程序必须满足低功耗计算机上的基本性能标准
> 
> *   应用程序必须在 5 秒或更短时间内启动
> *   应用程序必须在 2 秒或更短时间内暂停

您是否在基于 ARM 的设备上测试过您的应用程序？您的应用启动/暂停需要多长时间？

**更新：**

如果您使用的是独立的 WACK，那么您可能正在尝试验证您的应用程序的旧版本。我记得，当您将您的应用程序与 App Store 关联时，您的应用程序的名称和包 ID 会发生变化。但是，旧应用程序的某些部分可能仍然存在，这可能会导致认证在不再存在的应用程序上运行。

可能有帮助的是在创建包之前先卸载您的应用程序。要尝试的另一件事是从 Visual Studio 中运行认证。我发现它比独立应用程序更可靠。

# mysql - 并发编辑闭包树层次结构时的死锁

> ID：14753906
> 
> 赞同：4
> 
> 时间：2013-02-07T14:48:27.167
> 
> 标签：mysql, ruby-on-rails-3, deadlock, sti, transitive-closure-table

[当使用closure_tree](https://github.com/mceachen/closure_tree)同时操作一组具有层次结构的公共属性的模型时，如何避免数据库死锁？

它们有以下几种口味：

**发出时`#append/prepend_sibling`**

```
Mysql2::Error: Deadlock found when trying to get lock; try restarting transaction:
  UPDATE `elements` SET `sort_order` = `sort_order` + 1 WHERE (`parent_id` = 28035 AND `sort_order` >= 1)

Mysql2::Error: Deadlock found when trying to get lock; try restarting transaction:
  UPDATE `elements` SET `sort_order` = `sort_order` - 1 WHERE (`parent_id` = 21168 AND `sort_order` <= -1) 
```

**重建闭包表时**

```
Mysql2::Error: Deadlock found when trying to get lock; try restarting transaction:
  DELETE FROM `element_hierarchies`
   WHERE descendant_id IN (
     SELECT DISTINCT descendant_id
     FROM ( SELECT descendant_id
       FROM `element_hierarchies`
       WHERE ancestor_id = 16332
     ) AS x )
     OR descendant_id = 16332

Mysql2::Error: Deadlock found when trying to get lock; try restarting transaction: 
  INSERT INTO `element_hierarchies` (`ancestor_id`, `descendant_id`, `generations`) VALUES (30910, 30910, 0) 
```

[with_advisory_lock](https://github.com/mceachen/with_advisory_lock)看起来很有希望。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-10T18:09:22.517

[这里的closure_tree](https://github.com/mceachen/closure_tree)的作者：

Heal 先生的建议通常是正确的——您应该以相同的顺序获取表锁以防止死锁。但是，在这种情况下，死锁是由于层次结构表中的**行级锁造成的。**

有趣的是，您建议使用[with_advisory_lock](https://github.com/mceachen/with_advisory_lock)！我刚刚为closure_tree 编写了那个库，如果您使用版本> = 3.7.0，那么已经有保护类级别`#rebuild`和`#find_or_create_by_path`方法的咨询锁。

咨询锁（至少在 MySQL 和 PostgreSQL 中）的问题在于它们不尊重事务边界——如果持有锁的调用者在释放锁之前没有提交他们的事务，那么其他连接将不会看到这些更改。尝试获取咨询锁，所以我们需要在这里小心。我们可能需要在层次表上为任何写入添加表锁，但这是最坏的情况。

我已经打开了[issue 41](https://github.com/mceachen/closure_tree/issues/41)，我们可以在那里追踪它。首先要做的是在并行测试中可靠地重现死锁。我们已经有针对`#rebuild`和的测试`#find_or_create_by_path`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-07T15:19:04.947

您需要考虑一个事务如何与另一个事务协同工作。最好的办法是确保先读取（选择）内容，然后再编写 SQL。还要确保写入 SQL 以相同的顺序使用表 - 即在两种情况下先写入表 A，然后再写入 B。这将防止在需要另一个事务锁定的另一个事务持有时需要锁定。

或者，您可以检测死锁并采取适当的措施。我建议首先避免使用它们。

# c# - DataGridView 未在运行时创建的列中显示值

> ID：14753908
> 
> 赞同：2
> 
> 时间：2013-02-07T14:48:30.673
> 
> 标签：c#, winforms, datagridview

我有一个非常奇怪的问题。我将实体列表作为数据源分配给我的 DataGridView。我在运行时创建了一些列，然后，对于 DataGridView 中的每一行，我根据行中某些列的某些值来完成新列的值。

该代码工作正常，因为我正在以其他形式显示相同的 DataGridView。但是在这个新的 UserControl 中，它似乎没有在新列上显示任何值。

奇怪的是，这些值实际上是存在的，因为当我执行 foreach 行循环时，我有一些累加器 int 对象显示文本框中的值，并且这些值是正确的。

我使用了 try and catch 来查看是否有问题，但一切都很好。

我附上了一张我得到的图片。 ![在此处输入图像描述](../Images/21d84b376a09627c1f66cead67bdacb1.png)

这两个突出显示的文本框是累积这两列值的文本框。

正如我所说，相同的代码在其他形式中运行良好。以防万一，将此 UserControl 添加到表单中的面板中。

这是我用于 DataGridView 的代码：

```
public void Actualizar_grilla_prestamos()
    {
        dgv_Prestamos.DataSource = null;
        dgv_Prestamos.Columns.Clear();
        dgv_Prestamos.DataSource = lista_prestamos;

        dgv_Prestamos.RowHeadersVisible = false;

        //Agregar columna cuotas restantes
        DataGridViewColumn cuotas_restantes = new DataGridViewColumn();
        {
            cuotas_restantes.HeaderText = "C. Rest.";
            cuotas_restantes.Name = "cuotas_restantes";
            cuotas_restantes.AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
            cuotas_restantes.CellTemplate = new DataGridViewTextBoxCell();
            cuotas_restantes.ToolTipText = "Cantidad de cuotas restantes por cobrar";
        }
        dgv_Prestamos.Columns.Add(cuotas_restantes);

        //Agregar columna tipo de tasa
        DataGridViewColumn tipo_tasa = new DataGridViewColumn();
        {
            tipo_tasa.HeaderText = "Tipo tasa";
            tipo_tasa.Name = "tipo_tasa";
            tipo_tasa.AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
            tipo_tasa.CellTemplate = new DataGridViewTextBoxCell();
        }
        dgv_Prestamos.Columns.Add(tipo_tasa);

        //Agregar columna garantes

        DataGridViewColumn garantes = new DataGridViewColumn();
        {
            garantes.HeaderText = "Garantes";
            garantes.Name = "garantes";
            garantes.AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
            garantes.CellTemplate = new DataGridViewTextBoxCell();
        }
        dgv_Prestamos.Columns.Add(garantes);
        dgv_Prestamos.Columns["garantes"].DisplayIndex = dgv_Prestamos.Columns["Cliente1"].Index;

        //Agregar columna cuotas mora
        DataGridViewColumn cuotas_mora = new DataGridViewColumn();
        {
            cuotas_mora.HeaderText = "C. Venc.";
            cuotas_mora.Name = "cuotas_mora";
            cuotas_mora.AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
            cuotas_mora.CellTemplate = new DataGridViewTextBoxCell();
            cuotas_mora.ToolTipText = "Cantidad de cuotas vencidas";
        }
        dgv_Prestamos.Columns.Add(cuotas_mora);

        int cant_total_cuotas_mora = 0;
        int total_cuotas_restantes = 0;

        foreach (DataGridViewRow r in dgv_Prestamos.Rows)
        {
            Estado_prestamo estado = (Estado_prestamo)dgv_Prestamos.Rows[r.Index].Cells["Estado_prestamo"].Value;
            if (estado.id_estado_prestamo != 3)
            {
                var lista_cuotas = (System.Data.Objects.DataClasses.EntityCollection<Sistema_financiero.Cuota>)dgv_Prestamos.Rows[r.Index].Cells["Cuota"].Value;
                dgv_Prestamos.Rows[r.Index].Cells["cuotas_mora"].Value = lista_cuotas.Where(x => x.pagada != true && x.fecha_vencimiento < DateTime.Now.Date).Count();
                if (Convert.ToInt32(dgv_Prestamos.Rows[r.Index].Cells["cuotas_mora"].Value) > 0)
                {
                    dgv_Prestamos.Rows[r.Index].Cells["cuotas_mora"].Style.ForeColor = Color.Red;
                }
                dgv_Prestamos.Rows[r.Index].Cells["cuotas_restantes"].Value = lista_cuotas.Where(x => x.pagada != true).Count();
            }
            else
            {
                dgv_Prestamos.Rows[r.Index].Cells["cuotas_mora"].Value = 0;
                dgv_Prestamos.Rows[r.Index].Cells["cuotas_restantes"].Value = 0;
                dgv_Prestamos.Rows[r.Index].Cells["cuotas_restantes"].Style.ForeColor = Color.Green;
            }
            if (Convert.ToBoolean(dgv_Prestamos.Rows[r.Index].Cells["tasa_fija"].Value) == true)
            {
                dgv_Prestamos.Rows[r.Index].Cells["tipo_tasa"].Value = "FIJA";
            }
            else
            {
                dgv_Prestamos.Rows[r.Index].Cells["tipo_tasa"].Value = "VARIABLE";
            }
            dgv_Prestamos.Rows[r.Index].Cells["garantes"].Value = ((System.Data.Objects.DataClasses.EntityCollection<Sistema_financiero.Cliente>)dgv_Prestamos.Rows[r.Index].Cells["Cliente1"].Value).Count;
            cant_total_cuotas_mora = cant_total_cuotas_mora + Convert.ToInt32(dgv_Prestamos.Rows[r.Index].Cells["cuotas_mora"].Value);
            total_cuotas_restantes = total_cuotas_restantes + Convert.ToInt32(dgv_Prestamos.Rows[r.Index].Cells["cuotas_restantes"].Value);
        }

        tbx_Cuotas_adeudadas_vencidas.Text = cant_total_cuotas_mora.ToString();
        tbx_Total_cuotas_restantes.Text = total_cuotas_restantes.ToString();

        //Agregar columna ver prestamo

        DataGridViewImageColumn ver_prestamo = new DataGridViewImageColumn();
        {
            ver_prestamo.HeaderText = "";
            ver_prestamo.Name = "ver_prestamo";
            ver_prestamo.AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
            ver_prestamo.CellTemplate = new DataGridViewImageCell();
            ver_prestamo.Image = Properties.Resources.eye_small_grid;
            ver_prestamo.ToolTipText = "Ver préstamo";
        }
        dgv_Prestamos.Columns.Add(ver_prestamo);
        dgv_Prestamos.Columns["ver_prestamo"].DisplayIndex = 0;

        dgv_Prestamos.Columns["id_prestamo"].AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
        dgv_Prestamos.Columns["num_cuotas"].AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
        dgv_Prestamos.Columns["cuotas_mora"].AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
        dgv_Prestamos.Columns["cuotas_restantes"].AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
        dgv_Prestamos.Columns["importe"].AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
        dgv_Prestamos.Columns["Moneda"].AutoSizeMode = DataGridViewAutoSizeColumnMode.Fill;
        dgv_Prestamos.Columns["Sistema_amortizacion"].AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;

        dgv_Prestamos.Columns["cuotas_mora"].DisplayIndex = dgv_Prestamos.Columns["num_cuotas"].Index + 1;
        dgv_Prestamos.Columns["cuotas_restantes"].DisplayIndex = dgv_Prestamos.Columns["num_cuotas"].Index + 1;
        dgv_Prestamos.Columns["importe"].DisplayIndex = dgv_Prestamos.Columns["garantes"].DisplayIndex;

        dgv_Prestamos.Columns["num_cuotas"].DisplayIndex = dgv_Prestamos.Columns["cuotas_restantes"].DisplayIndex;
        dgv_Prestamos.Columns["Estado_prestamo"].DisplayIndex = dgv_Prestamos.Columns[dgv_Prestamos.Columns.Count - 1].Index;
        dgv_Prestamos.Columns["Moneda"].DisplayIndex = dgv_Prestamos.Columns[dgv_Prestamos.Columns.Count - 2].Index;
        dgv_Prestamos.Columns["tipo_tasa"].DisplayIndex = dgv_Prestamos.Columns["tasa_fija"].Index;

        List<int> lista_columnas_visibles = new List<int> { dgv_Prestamos.Columns["Estado_prestamo"].Index, dgv_Prestamos.Columns["garantes"].Index, dgv_Prestamos.Columns["importe"].Index, dgv_Prestamos.Columns["Sistema_amortizacion"].Index, dgv_Prestamos.Columns["tipo_tasa"].Index, dgv_Prestamos.Columns["Moneda"].Index, dgv_Prestamos.Columns["id_prestamo"].Index, dgv_Prestamos.Columns["num_cuotas"].Index, dgv_Prestamos.Columns["cuotas_mora"].Index, dgv_Prestamos.Columns["cuotas_restantes"].Index, dgv_Prestamos.Columns["ver_prestamo"].Index };

        Mostrar_ocultar_columnas(dgv_Prestamos, lista_columnas_visibles);

        dgv_Prestamos.Columns["num_cuotas"].HeaderText = "Cuotas";
        dgv_Prestamos.Columns["id_prestamo"].HeaderText = "Nº";
        dgv_Prestamos.Columns["tasa_fija"].HeaderText = "Tipo tasa";

        dgv_Prestamos.Columns["importe"].HeaderText = "Importe";
        dgv_Prestamos.Columns["Estado_prestamo"].HeaderText = "Estado";
        dgv_Prestamos.Columns["Sistema_amortizacion"].HeaderText = "Amortización";

        dgv_Prestamos.Columns["importe"].DefaultCellStyle.Format = String.Format("$ ##0.##");

        if (dgv_Prestamos.Columns["Moneda"].Width > 99)
        {
            dgv_Prestamos.Columns["Moneda"].AutoSizeMode = DataGridViewAutoSizeColumnMode.None;
            dgv_Prestamos.Columns["Moneda"].Width = 99;
        }
    } 
```

您可以看到 DataGridView 有一个带有眼睛的列。如果单击眼睛，您可以以另一种形式看到该实体。如果您更改该表单中的实体状态，它会返回一个值 (borrado)，如果已进行更改，则返回 true，如果未进行更改，则返回 false。如果检测到更改，则我再次调用上述方法。神奇的是，它显示了所有缺失的值！

```
private void dgv_Prestamos_CellContentDoubleClick(object sender, DataGridViewCellEventArgs e)
    {
        if (e.RowIndex != -1)
        {
            if (e.ColumnIndex == dgv_Prestamos.Columns["ver_prestamo"].Index)
            {
                frm_Ver_Prestamo ver_prestamo = new frm_Ver_Prestamo();
                ver_prestamo.prestamo_seleccionado = (Prestamo)dgv_Prestamos.Rows[e.RowIndex].DataBoundItem;
                ver_prestamo.db = db;
                ver_prestamo.ShowDialog();
                if (ver_prestamo.borrado == true)
                {
                    dgv_Prestamos.DataSource = null;
                    Cursor.Current = Cursors.WaitCursor;
                    Actualizar_grilla_prestamos();
                    Cursor.Current = Cursors.Default;
                }
            }
        }
    } 
```

ver_prestamo 是显示实体的表单。我不知道是什么让它起作用，唯一的区别是我之前做了一个 DataSource = null 。但无论如何我都是这样做的..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T05:06:36.940

“构造网格，设置 DataSource，然后在 DataBindingComplete 事件中更改外观。” - 糖霜

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T21:35:14.610

您是否尝试过移动 dgv_Prestamos.DataSource = lista_prestamos; 到 Actualizar_grilla_prestamos 的底部。我认为当您设置数据源并且看不到您之后创建的列时，它正在执行绑定。

# iphone - 当用户未在设置中登录 Twitter 时，如何在显示警报时禁用键盘？

> ID：14753909
> 
> 赞同：1
> 
> 时间：2013-02-07T14:48:31.407
> 
> 标签：iphone, ipad, twitter, social

我正在使用社交框架在我的应用程序中添加 Twitter，如果用户没有登录 Twitter 帐户，我会显示打开设置登录 Twitter 的警报，但同时键盘也出现了，谁能帮助我如何停止键盘出现当时。

我正在使用以下代码获取警报视图以连接设置

```
// Set up the built-in twitter composition view controller.
TWTweetComposeViewController *tweetViewController = [[TWTweetComposeViewController alloc] init];

// Create the completion handler block.
[tweetViewController setCompletionHandler:^(TWTweetComposeViewControllerResult result) {
    [delegate dismissModalViewControllerAnimated:YES];
}];

// Present the tweet composition view controller modally.
[delegate presentModalViewController:tweetViewController animated:YES];
//tweetViewController.view.hidden = YES;
for (UIView *view in tweetViewController.view.subviews){
    [view removeFromSuperview];
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:51:19.457

试试这个代码：

```
TWTweetComposeViewController *twitterViewController = [[TWTweetComposeViewController alloc] init];

[self presentViewController:twitterViewController animated:YES completion:nil];

twitterViewController.completionHandler = ^(TWTweetComposeViewControllerResult twResult) {
    switch(twResult) {
        case TWTweetComposeViewControllerResultDone:
            break;
        case TWTweetComposeViewControllerResultCancelled:
            break;
    }

    dispatch_async(dispatch_get_main_queue(), ^{
        [self dismissViewControllerAnimated:NO completion:nil];
    });
}; 
```

# python - 与端点在线计算点

> ID：14753913
> 
> 赞同：1
> 
> 时间：2013-02-07T14:48:35.727
> 
> 标签：python, line, pygame

使用 Python 2.7.3 和 Pygame 1.9.1。

我有一条线，我只知道端点 A 和 B 的坐标。
我想计算坐标 AB 是什么，给定 x 或 y 轴上的值。
**例如**
![图像示例](../Images/80a154a44ca5176a3a2d1fe7ee05a52e.png)

****在这里，****我知道**
`(x,y)`, &**此外，**在 X 轴或 Y 轴上。**我的问题** 如何计算点的坐标（x，y）的位置`A` **`B``C`
 **`C`
 **`D`********

 ******* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:07:45.013

直线方程为：

```
y = mx + q 
```

您想要的是`y(x)`or `x(y)`，并且您有两个端点`(x1, y1)`和`(x2, y2)`。将它们替换为直线方程并建立一个线性系统：

```
y1 = m·x1 + q
y2 = m·x2 + q 
```

减法产生：

```
y2-y1 = m(x2-x1) => m = (y2-y1)/(x2-x1) 
```

q 显然是：

```
q = y2-m·x2 
```

所以，现在你有了`y = f(x)`代表连接两点的直线。

`m->+inf`很明显，一条垂直线不能用这种形式表示（
在这两种情况下，您都应该使用`x = f(y)`表格（您可以按照相同的步骤获得表格，但从方程式开始`x = py + r`）。

话虽如此，您只需将其放入上面确定`y`的直线 ( ) 的方程中即可得到；如果您知道并且想要确定 ，则同样成立（反比关系， ） 。`D``x``x``y = f(x)``x = f(y)``y``x`******

# python - 如何列出 Google Drive 文件夹的所有文件、文件夹、子文件夹和子文件

> ID：14753914
> 
> 赞同：1
> 
> 时间：2013-02-07T14:48:37.360
> 
> 标签：python, python-2.7, google-drive-api

任何想法如何在单个查询中查询所有孩子和孩子的孩子？

**更新**

这似乎是一个简单的问题。我怀疑是否有一个简单的解决方案？

查询文件夹和文件树可能会花费大量 API 调用。因此，为了解决我的问题，我使用单个查询来列出所有者的所有文件和文件夹。此查询还返回子文件和子文件夹。要在列表中找到文件夹及其所有子文件夹（文件夹、文件、子文件夹和子文件），我必须创建一个类似 index.html 的树。

**结论**

单个查询是不够的。您必须列出所有或缩小与所有者的查询。下一步您必须索引结果以（递归）找到文件夹的树。

像 (ls -R in Unix) 这样的查询选项会很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T08:02:59.880

我正在尝试在 PHP 中做同样的事情。我的解决方案是：

1.  从驱动器中检索文件和文件夹的完整列表
2.  对检索到的 json 进行两次迭代（嵌套）：
    *   “items”数组中的第一个元素，
    *   每个元素的父 id 的第二个（递归），

拒绝其父 ID 列表中不包含我的特定文件夹 ID 的所有元素。
不用担心，这只是一个 Google API 调用。剩下的工作是本地的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T15:48:14.190

我认为您在“更新”中的想法是正确的。将 Drive 视为平面，调用列出所有内容，并从中生成您自己的树。

# c# - linq-To-SQL 未获取更新的数据库数据

> ID：14753918
> 
> 赞同：0
> 
> 时间：2013-02-07T14:48:41.290
> 
> 标签：c#, linq-to-sql

我正在循环通过中继器并使用 c# SqlCommand 向我的数据库发送更新查询

稍后当我想要我使用的新更新类型的实体类型时

```
Document d = (from c in db.Documents where c.Id = myID select c).First(); 
```

我得到一个文档，其中使用 SqlCommand 更新的字段仍然为空，但是当我检查数据库时，这些字段具有正确的值。

有没有办法从 SqlCommand 命令获取实体类型，或者确保 Linq-To-Sql 获取更新的数据。

在执行此操作之前，我尝试过运行 db.savechanges() ，但没有区别。

编辑：

```
SqlCommand command = getCommand(type, field, item, nDocID, required); // commandText = "UPDATE Documents SET " + field + "=@" + field + " WHERE DocumentID = " + id; "

                    if (command != null)
                    {
                        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["connString"].ConnectionString);

                        command.Connection = conn;
                        conn.Open();
                        command.ExecuteNonQuery();
                        conn.Close();
                    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:55:24.700

db.SaveChanges() 不会做任何事情，因为您没有通过 EF 进行任何更改来应用。您所做的更改超出了它的范围。我猜你在全局声明了你的 db 变量并且 EF 缓存了数据。相反，请尝试这样做：

```
using(somethingEntities db = new somethingEntities()){
  Document d = (from c in db.Documents where c.Id = myID select c).First();
  // do something here
} 
```

# ios - iOS 发布到 Facebook 墙上提及标签用户

> ID：14753919
> 
> 赞同：4
> 
> 时间：2013-02-07T14:48:45.903
> 
> 标签：ios, facebook, api, facebook-ios-sdk

我想从我的 iOS 应用程序中发布一个帖子，向一些朋友提及。我得到了他的“身份证”。

所以我使用以下方法并且不起作用：

```
        NSString *textToShare = @"你好@[100003626828741]";
        NSDictionary *参数 = @{
                                     @"图片":图片,
                                     @“姓名”：@“你好”，
                                     @"caption" : textToShare,
                                     @"message" : textToShare,
                                     };

```
 NSURL *feedURL = [NSURL URLWithString:@"https://graph.facebook.com/me/feed"];

    SLRequest *feedRequest = [SLRequest
                              requestForServiceType:SLServiceTypeFacebook
                              requestMethod:SLRequestMethodPOST
                              URL:feedURL
                              parameters:parameters];

    feedRequest.account = [[ICollinaService instance] facebookAccount];

    [feedRequest performRequestWithHandler:^(NSData *responseData,
                                             NSHTTPURLResponse *urlResponse, NSError *error)
     {
         NSLog(@"Facebook HTTP response: %i", [urlResponse
                                               statusCode]);
         NSLog(@"Facebook HTTP response allHeaderFields: %@", [urlResponse
                                               allHeaderFields]);
         NSLog(@"Facebook HTTP error: %@", error);
     }];

} 
```

如何在帖子中提及朋友？谢谢帖子的结果是：hello @[100003626828741] 作为标题和消息，而不用链接/标签更改名称的 id。

            回答 #1

赞同：0

时间：2013-09-24T10:42:18.753

我正在研究 Facebook Open Graph API - [https://developers.facebook.com/docs/opengraph/getting-started/](https://developers.facebook.com/docs/opengraph/getting-started/)

我不知道这是否是最好的方法！？！

令人不安的是，使用friendPicker 轻松挑选朋友和发布图片在IOS 6.0 社交框架下非常容易，但相比之下，将两者结合open Graph 发布似乎非常困难。然而，它是我迄今为止找到的唯一解决方案。

            回答 #2

赞同：0

时间：2013-02-15T00:30:01.340

我不认为您可以在帖子中标记朋友，但您可以在操作中标记。

```

# c# - 将标签内容绑定到嵌套类中的值而不是 Datacontext

> ID：14753921
> 
> 赞同：1
> 
> 时间：2013-02-07T14:48:54.723
> 
> 标签：c#, wpf, mvvm, binding, mvvm-light

我的视图 (InformationView) 绑定到 InformationViewModel 并且我使用嵌套类来维护当前的银行

我的嵌套类：

```
public class MainController : NotificationObject
{
    public MainController()
    {
        Initialize();
    }

    private void Initialize()
    {
        // TODO implement 
    }

    public static MainController Instance
    {
        get { return Nested.instance; }
    }

    private BankModel _currentBank;

    public BankModel CurrentBank
    {
        get { return _currentBank; }
        set
        {
            if (_currentBank== value)
            {
                return;
            }

            _currentBank= value;
            RaisePropertyChanged(() => CurrentBank);
        }
    }

    private class Nested
    {
        static Nested()
        {
        }

        internal static readonly MainController instance = new MainController();
    }
} 
```

我的银行模型：

```
 private string _name ="test";

    public string Name
    {
        get
        {
            return _name;
        }

        set
        {
            if (_name == value)
            {
                return;
            }

            _name= value;
            RaisePropertyChanged(()=>Name);
        }
    } 
```

我的 XAML

```
xmlns:Controller="clr-namespace:MyProject.Controller" 
/****/
<Label Content="{Binding Controller:MainController.CurrentBank.Name}"/> 
```

首先我在我的标签中看不到“测试”，如果我执行我更改这个值并且我的标签总是为空，我如何用正确的方法做到这一点

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T15:03:21.967

您需要在绑定声明中使用“路径”和“源”的组合。您还需要提醒绑定引擎您正在访问静态成员。

```
<Label Content="{Binding Source={x:Static Controller:MainController.Instance}, Path=CurrentBank.Name}" /> 
```

# mysql - UDF 或存储过程的存储库

> ID：14753923
> 
> 赞同：2
> 
> 时间：2013-02-07T14:49:03.527
> 
> 标签：mysql, postgresql, stored-procedures, user-defined-functions

我正在寻找存储过程或 UDF 的开源存储库（目标数据库无关紧要）。一个例子是[http://www.mysqludf.org/](http://www.mysqludf.org/)。我想知道人们是否知道类似的存储库？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:55:55.577

那里有两个

*   较旧的[http://pgfoundry.org/](http://pgfoundry.org/)
*   和更新的[http://pgxn.org/](http://pgxn.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:00:01.430

我不知道 PostgreSQL 的这种“存储库”。这个想法对我来说似乎很奇怪 - 毕竟 - 所有功能/程序都适用于某些数据，因此它们的作用非常具体。

不过，PostgreSQL wiki 中有一个[Snippets 类别](http://wiki.postgresql.org/wiki/Category%3aSnippets)。

# javascript - jQuery 裁剪一个圆圈

> ID：14753924
> 
> 赞同：0
> 
> 时间：2013-02-07T14:49:04.803
> 
> 标签：javascript, jquery, gd

jQuery/javascript 中是否有脚本可以在图像上选择一个圆圈并将坐标提供给脚本（php/gd）以裁剪/模糊该图像？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:54:03.563

我不知道是否有任何圆形，但您可以使用此[http://odyniec.net/projects/imgareaselect/](http://odyniec.net/projects/imgareaselect/)选择一个矩形，然后您可以从该矩形的中心计算圆形并应用模糊裁剪你需要。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:58:35.123

查看有关掩盖图像以形成圆圈的[答案。](https://stackoverflow.com/questions/8337570/best-way-to-mask-an-image-in-html5)基本上，有很多选择，我引用：

> *   *老式的方式*-通过在所需元素的顶部使用透明 png
> *   图像的 css3`border-radius`设置为其尺寸的一半（以便边框定义一个圆圈）
> *   css3`mask`和`mask-clip`属性（这是一个很好的演示：[http](http://www.webkit.org/blog/181/css-masks/) ://www.webkit.org/blog/181/css-masks/ ）
> *   画布做掩蔽
> *   以图像为背景图案的 svg 圆圈

# python - 将可迭代解包到其他可迭代中？

> ID：14753930
> 
> 赞同：0
> 
> 时间：2013-02-07T14:49:24.760
> 
> 标签：python, python-3.x, iterable-unpacking

从 ASCII 文件中读取数据时，我发现自己在做这样的事情：

```
(a, b, c1, c2, c3, d, e, f1, f2) = (float(x) for x in line.strip().split())
c = (c1, c2, c3)
f = (f1, f2) 
```

如果我每行有确定数量的元素（我这样做）¹并且只有一个多元素条目要解包，我可以使用类似 `(a, b, *c, d, e) = ...' （[扩展的可迭代拆包](http://www.python.org/dev/peps/pep-3132/)）。

即使我不这样做，我当然也可以用星号组件替换*上面*示例中的两个多元素条目之一：`(a, b, *c, d, e, f1, f2) = ...`.

据我所知，`itertools`这里没有立即使用。

由于我可能不知道的原因，上面的三行代码是否有任何替代方案可能被认为是“更 Pythonic”？

^(¹它是确定的，但每行仍然不同，模式对于`numpy`s 函数`loadtxt`或`genfromtxt`.)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:49:34.733

如果你真的经常使用这样的语句，并且想要代码的最大灵活性和可重用性而不是经常编写这样的模式，我建议为它创建一个小函数。只需将其放入某个模块并导入它（您甚至可以导入我创建的脚本）。

有关用法示例，请参见`if __name__=="__main__"`块。诀窍是使用组 ID 列表将值`t`组合在一起。此 id 列表的长度应至少与 的长度相同`t`。

我只会解释主要概念，如果您有什么不明白的地方，请询问。

我`groupby`从 itertools 使用。尽管在这里如何使用它可能并不简单，但我希望它很快就会被理解。

作为`key`函数，我使用通过工厂函数动态创建的方法。这里的主要概念是“闭包”。组 ID 列表被“附加”到内部函数`get_group`。因此：

*   该列表特定于对 的每个调用`extract_groups_from_iterable`。您可以多次使用它，不使用全局变量

*   此列表的状态在对同一实例的后续调用之间共享`get_group`(记住：函数也是对象！所以`get_group`在我的脚本执行期间我有两个实例。

除此之外，我还有一个简单的方法可以从返回的组中创建列表或标量`groupby`。

而已。

```
from itertools import groupby

def extract_groups_from_iterable(iterable, group_ids):
    return [_make_list_or_scalar(g) for k, g in 
                        groupby(iterable, _get_group_id_provider(group_ids))
           ]

def _get_group_id_provider(group_ids):
    def get_group(value, group_ids = group_ids):
        return group_ids.pop(0)
    return get_group

def _make_list_or_scalar(iterable):
    list_ = list(iterable)
    return list_ if len(list_) != 1 else list_[0]

if __name__ == "__main__":
    t1 = range(9)
    group_ids1 = [1,2,3,4,5,5,6,7,8]
    a,b,c,d,e,f,g,h = extract_groups_from_iterable(t1, group_ids1)

    for varname in "abcdefgh":
        print varname, globals()[varname]

    print

    t2 = range(15)
    group_ids2 = [1,2,2,3,4,5,5,5,5,5,6,6,6,7,8]
    a,b,c,d,e,f,g,h = extract_groups_from_iterable(t2, group_ids2)

    for varname in "abcdefgh":
        print varname, globals()[varname] 
```

输出是：

```
a 0
b 1
c 2
d 3
e [4, 5]
f 6
g 7
h 8

a 0
b [1, 2]
c 3
d 4
e [5, 6, 7, 8, 9]
f [10, 11, 12]
g 13
h 14 
```

再一次，这似乎有点矫枉过正，但如果这有助于您减少代码，请使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:54:55.683

为什么不只切片一个元组？

```
t = tuple(float(x) for x in line.split())
c = t[2:5]  #maybe t[2:-4] instead?
f = t[-2:] 
```

演示：

```
>>> line = "1 2 3 4 5 6 7 8 9"
>>> t = tuple(float(x) for x in line.split())
>>> c = t[2:5]  #maybe t[2:-4] instead?
>>> f = t[-2:]
>>> c
(3.0, 4.0, 5.0)
>>> t
(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0)
>>> c = t[2:-4]
>>> c
(3.0, 4.0, 5.0) 
```

虽然我们讨论的是 pythonic 的主题，`line.strip().split()`但总是可以安全地写为`line.split()`where `line`is a string。 `split`当您不提供任何参数时，将为您去除空格。

# ember.js - 使用 Ember Pre4 链接到车把

> ID：14753936
> 
> 赞同：1
> 
> 时间：2013-02-07T14:49:33.980
> 
> 标签：ember.js

我在让 linkTo Handlebar 助手工作时遇到问题

我有这个路线设置：

```
 this.resource("contact", function(){
        this.route('new');
        this.route('show', { path: "/:contactid" });
        this.route('edit', { path: "edit/:contactid" });   
    } 
```

在我的模板中，我有以下代码：

```
{{#each entry in controller.entries}}
{#linkTo "contact.show" entry href="true" }}test {{firstname}} {{lastname}}{{/linkTo}}
{{/each}} 
```

结果链接是 /contact/show/undefined

我究竟做错了什么？

旁注：我没有使用 Ember.Data 和模型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T17:20:28.603

Ember 期望参数遵循约定`modelname_id`，因此应该将路由更改为：

```
this.resource("contact", function(){
    this.route('new');
    this.route('show', { path: "/:contact_id" });
    this.route('edit', { path: "edit/:contact_id" });   
} 
```

假设`entry.get("id")`已定义，这应该可以工作。

有关详细信息，请参阅[http://emberjs.com/guides/routing/specifying-a-routes-model/](http://emberjs.com/guides/routing/specifying-a-routes-model/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T19:18:17.160

在路由器中实现序列化以覆盖 id 的默认行为。例如，我有一条如下所示的路线：

```
this.route( 'date', { path: '/:begin/:end'} ); 
```

路线看起来像

```
Em.Route.extend( {
    serialize: function( model, params ) { 
        return { begin: model.begin.valueOf(), end: model.end.valueOf() };
    }
} ); 
```

# c++ - 0x76b1dd74 处未处理的异常。访问冲突写入位置 0x00000000

> ID：14753939
> 
> 赞同：0
> 
> 时间：2013-02-07T14:49:47.333
> 
> 标签：c++, exception, com, mfc, dialog

我试图通过串行端口连接读取信息。我正在尝试使用超级终端向我的程序发送一个字符或字符串。代码构建良好，并且会调试，直到它到达我正在使用的 ReadFile 函数。一旦启动该功能，它就会等待发送信息。一旦我输入 4 个字符，我就会收到我在标题中声明的未处理异常。断点将我留在 AfxWinMain 以及 hPrevInstance CXX0030 表达式无法评估。我可以使用我的程序将数据发送到超级终端，但无论出于何种原因，它都会与 readfile 一起崩溃。

**在哪里调用函数**

```
void CThermotronDlg::OnBnClickedDelete()
{
Serial Port;
CString Temp("34");
bool ans;
int nItem = MyListEx.GetSelectionMark();

ans = Port.ReadPort(Temp);

} 
```

**功能**

```
bool Serial::ReadPort(CString buf){

OpenPort();
LPCTSTR dope;

LPDWORD bytesRead =0;
char b[4];
BOOL ret = ReadFile(sSerial,b,4,bytesRead,NULL) ;

dope = reinterpret_cast<LPCTSTR>(b);
AfxMessageBox(dope,0,0);
return true;

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T14:53:23.130

```
DWORD bytesRead;
char b[4];
BOOL ret = ReadFile(sSerial,b,4,&bytesRead,NULL) ; 
```

第 4 个参数必须是接收实际读取字节数的有效指针。它不能为 NULL。更准确地说：只有当 lpOverlapped 参数不为 NULL 时，此参数才能为 NULL。

# c - sizeof(function_name)

> ID：14753940
> 
> 赞同：1
> 
> 时间：2013-02-07T14:49:47.270
> 
> 标签：c, function, sizeof

我试过了`sizeof(printf)`，`sizeof(foobar)`等等，其中 foobar 是用户定义的函数。它返回 1 而没有任何警告或错误。为什么是1？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T14:50:51.190

函数的大小在 C 中没有很好地定义，因此该值没有意义。

# html - Template::Toolkit 可以漂亮地打印它输出的 HTML 吗？

> ID：14753941
> 
> 赞同：1
> 
> 时间：2013-02-07T14:49:48.650
> 
> 标签：html, perl, template-toolkit

我想答案是*肯定*的，但最简单的方法是什么？我使用`Template::Toolkit::Simple`，如果这有所作为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:19:38.550

如果你想创建漂亮的 HTML，那么你必须使用[Template::Plugin::HTML](https://metacpan.org/module/Template%3a%3aPlugin%3a%3aHTML)而不是 Template::Toolkit::Simple。

您也可以尝试以下方法：[Template::Flute](https://metacpan.org/module/Template%3a%3aFlute)和[Markapl](https://metacpan.org/module/Markapl)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T14:56:19.737

我不这么认为，但由于它基于模板 - 只需让您的模板打印得漂亮。

# dom - onclick 不起作用。每当我提交它时，它都会自动执行所有 onclick 处理程序

> ID：14753943
> 
> 赞同：0
> 
> 时间：2013-02-07T14:49:58.143
> 
> 标签：dom, javascript-events

这是代码：html+js

```
<input type="submit" onclick="chk();" />
function chk(){
var buttonnode= document.createElement('input');
buttonnode.onClick = ddiv(buttonnode);
} 
```

buttonnode.onclick 自动调用 ddiv 函数，但我希望它等待单击以继续执行该函数。怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:11:54.553

尝试如下...它会工作..

```
buttonnode.onclick = function (){ddiv(this);}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T16:53:17.093

尝试如下...它将给出您需要的结果...

```
<html>
<body>
<style>
.divstyle
{
border: 1px solid red;
}
</style>
<script>

function myFunction()
{

var txt = document.getElementById("txtinfo");

//div Creation
var myDiv = document.createElement("div");
myDiv.setAttribute("class", "divstyle");
myDiv.innerHTML = "<br>" + txt.value + "<br>";

//Button Creation
var myButton = document.createElement("input");
myButton.type = "button";
myButton.value = "my button";
myDiv.appendChild(myButton);
document.body.appendChild(myDiv);
myButton.onclick = function (){ddiv(this,myDiv);};

}

function ddiv(btn, div)
{ 
div.parentNode.removeChild(div);
} 

</script>

<button onclick="myFunction()">Try it</button>
<input type="text" value="Click the Below Button" id="txtinfo"/>
</body>
</html> 
```

# c# - 在 XAML 中更改 Slider 的值会引发异常

> ID：14753945
> 
> 赞同：2
> 
> 时间：2013-02-07T14:50:06.443
> 
> 标签：c#, .net, wpf, xaml, exception

我对 WPF 有疑问：我想在我的 XAML 中使用具有默认值的滑块，但是当我这样做时，会引发异常：

`An unhandled exception of type 'System.Reflection.TargetInvocationException' occurred in PresentationFramework.dll`

这是我的代码：

```
<Slider Height="23" HorizontalAlignment="Center" Name="sliderVolume" VerticalAlignment="Top" Width="66" Grid.Row="2" ValueChanged="volume_ValueChanged" Margin="598,35,12,0" Value="100"/> 
```

这是我的代码是 .cs ：

```
private void volume_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> e)
{
    mediaElement.Volume = sliderVolume.Value;
} 
```

没有默认值

`Value"100"`

有用 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:19:00.903

根据[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.mediaelement.volume.aspx)。允许的最大音量为 1。

> 媒体的音量以 0 到 1 之间的线性刻度表示。默认值为 0.5。

所以你需要像这样设置你的滑块：

```
<Slider Value="0.5" Minimum="0" Maximum="1" Height="23" HorizontalAlignment="Center"
Name="sliderVolume" VerticalAlignment="Top" Width="66" Grid.Row="2"
ValueChanged="volume_ValueChanged" Margin="598,35,12,0" /> 
```

代码 ：

```
private void volume_ValueChanged(object sender, RoutedPropertyChangedEventArgs<double> args)
      {
         mediaElement.Volume = (double)sliderVolume.Value;
      } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T15:07:43.160

[MediaElement 卷属性](http://msdn.microsoft.com/en-us/library/system.windows.controls.mediaelement.volume.aspx)以0 到 1 之间的线性比例表示。

尝试：

```
mediaElement.Volume = sliderVolume.Value / 10; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:57:50.580

我没有看到定义的最小值和最大值。您的“默认”值可能超出范围。

# xaml - 如何使用 VirtualizingStackPanel CleanUpVirtualizedItemEvent？

> ID：14753951
> 
> 赞同：0
> 
> 时间：2013-02-07T14:50:14.393
> 
> 标签：xaml, windows-8, windows-runtime, winrt-xaml, c++-cx

我已经自定义了 ListBox 的样式，以便注册`VirtualizingStackPanel.CleanUpVirtualizedItemEvent`. 我需要在项目重新虚拟化时释放一些内存，然后在取消虚拟化时重新加载内存。每当我检查该项目是否已虚拟化时，它总是返回 false：

`const bool isVirtualizing = VirtualizingStackPanel::GetIsVirtualizing(e->UIElement); // Always returns false`

我如何处理这个事件？我可以更改`ListBox`使用`VirtualizingStackPanel.VirtualizationMode="Standard"`，但这会导致 UI 不断创建和删除，这可能会导致性能问题。如果可能的话，我宁愿回收 UI 控件。

# c# - 如何使用 Windows.ApplicationModel.Resources.Core.ResourcesManager.LoadPriFiles 打开 .PRI 文件？

> ID：14753958
> 
> 赞同：3
> 
> 时间：2013-02-07T14:50:25.357
> 
> 标签：c#, .net, resources

我想使用 C# 以编程方式打开生成的 .PRI 文件**(c:\test\resource.pri) 。**

问题是**ResourceManager的方法将****IEnumerable<IStorageFile>**类型的对象作为参数

 **我希望能够做类似的事情

```
using Windows.ApplicationModel.Resources.Core;

ResourceManager rm = ResourceManager.Current;

//Now something like
IStorageFile stFile = IStorageFile.OpenPath(@"c:\test\resource.pri");
//but IStorageFile is static, how can I serialize it ??

IEnumerable<IStorageFile> files = new IEnumerable<IStorageFile>();
files.Add(stFile);

var priResources = rm.LoadPriFiles(files);

void process(priResources){
    //extract the resources from priResources
    //need this implementation also
} 
```**

# c++ - 在其他类的构造函数中调用 A 类的方法

> ID：14753960
> 
> 赞同：-2
> 
> 时间：2013-02-07T14:50:30.730
> 
> 标签：c++

我想在其他类的构造函数中从 A 类调用一个方法

我用谷歌搜索，但没有找到任何答案例如，我有：

```
class A{
  void doWork();
}
class B{
  B(){
   //here i want to have doWork method
 }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T15:02:14.077

您告诉我们选择合适的解决方案还不够。一切都取决于您要达到的目标。几个解决方案：

a) 将方法标记为静态。

```
class A
{
public:
    static void DoSth()
    {
        // Cannot access non-static A members here!
    }
};

class B
{
public:
    B()
    {
        A::DoSth();
    }
}; 
```

b) 您可以就地实例化 A

```
class A
{
public:
    void DoSth()
    {
        // Do something
    }
};

class B
{
public:
    B()
    {
        A a;
        a.DoSth();
    }
}; 
```

c) 您可以将 A 的实例放入 B：

```
// A remains as in b)

class B
{
private:
    A a;
    // or: A * a;

public:
    B()
    {
        a.DoSth();
        // or: a = new A; a->DoSth();
        // Remember to free a somewhere
        // (probably in destructor)
    }
} 
```

d) 你可以从 A 推导出 B：

```
class A
{
protected:
    void DoSth()
    {
    }
};

class B : public A
{
public:
    B()
    {
        DoSth();
    }
}; 
```

e) 你可以忘记 A 类，让 DoSth 成为一个函数：

```
void DoSth()
{
    // ...
}

class B
{
public:
    B()
    {
        DoSth();
    }
} 
```

由于您提供的数据不足，您必须自己选择解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T15:00:00.667

为了使它起作用，您需要对其进行子类化。

所以它会是这样的：

```
class A {
  doWork();
}

class B : A {
   B(){
     doWork();
   }
} 
```

您也可以像这样进行 HAS-A 而不是 IS-A 关系：

```
class A {
   doWork();
}

class B {
   A myA;
   B(){
      myA.doWork();
   }
} 
```

在不了解您在做什么的情况下，我会选择顶级（IS-A）解决方案，这就是我认为您正在尝试做的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T14:58:13.413

或者

```
class A
{
    public:
         static void doWork();
};
class B
{
     B(void)
     {
          A::doWork();
     }
}; 
```

?

PS：这里 B::B() 将是私有的

# mercurial - 如何在 Mercurial 存储库中找到经常更改的文件？

> ID：14753969
> 
> 赞同：1
> 
> 时间：2013-02-07T14:50:50.763
> 
> 标签：mercurial, refactoring

我正在进入一个新的代码库，目的是让它更稳定。我正在努力确定的是代码中大部分动荡的位置。

我正在寻找一种方法来查找存储库中哪些文件最常被更改，以便我可以提出一些重构的起点。似乎没有内置的 Mercurial 命令，而且 Google 似乎也没有提供太多东西（或者我使用了错误的术语。）

目前想到的只是编写一个脚本，该脚本将解析`hg log -v`命令中的“文件：”行并手动计算文件。这会奏效，但如果我是第一个必须这样做的人，我会感到非常惊讶。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:42:09.520

这将做到：

```
 hg log --template "{files % '{file}\n'}" | sort | uniq -c | sort -rn
     21 templates/base.html
     19 TODO
      8 content/about.rst
      6 static/screen.css 
```

这显示了 21 个 chngesets touch `templates/base.html`，这是我的大部分小仓库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T15:44:18.343

我会建议以相反的方式移动

1.  获取文件列表
2.  对于 p.1 中的每个文件，执行类似`hg log FILENAME --template "+" | wc -m`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-08T01:43:25.350

这是一个适用于旧版 Mercurial 安装的版本：

```
$ hg grep --files-with-matches --all . | cut -d : -f 1 | sort | uniq -c | sort -rn
 21 templates/base.html
 19 TODO
  8 content/about.rst
  6 static/screen.css 
```

如果文件名中有冒号，则还需要添加`--print0`和更改`cut`调用。

# c# - ZipArchive 评论

> ID：14753972
> 
> 赞同：0
> 
> 时间：2013-02-07T14:50:51.690
> 
> 标签：c#, .net-4.5

我想从一些旧的 zip 文件中删除评论。[在ZipArchive](http://msdn.microsoft.com/query/dev11.query?appId=Dev11IDEF1&l=EN-US&k=k%28System.IO.Compression.ZipArchive%29;k%28TargetFrameworkMoniker-.NETFramework,Version=v4.5%29;k%28DevLang-csharp%29&rd=true)中找不到任何“评论”属性。除了“提取所有文件并将它们添加到新的 zip 文件中”之外，是否存在任何解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:54:00.710

如果您有可能向我们推荐另一个库，我推荐 DotNetZipLib ( [http://dotnetzip.codeplex.com/](http://dotnetzip.codeplex.com/) ) 它非常易于使用，您还可以编辑评论。

```
 var file = @"C:\sample.zip";
  using (var zip = new ZipFile(file))
  {
    foreach (var entry in zip.Entries)
    {
      entry.Comment = string.empty;
    }
    zip.Save();
  } 
```

# knockout-2.0 - 使用 Knockout KoLite 进行更改跟踪的示例或教程

> ID：14753982
> 
> 赞同：1
> 
> 时间：2013-02-07T14:51:17.757
> 
> 标签：knockout-2.0, kolite

有没有关于如何使用淘汰赛 kolite 来跟踪更改的简单示例。我看到了 john papa [Kolite][1] 发布的这个链接。我不明白他如何将更改绑定到 html 元素以跟踪更改。任何人都有任何简单的例子来说明如何使用它，然后高度赞赏。在淘汰赛方面，我是新手。请帮忙。非常感谢

我找到了一个例子。这是小提琴 [KoLite 示例的链接](http://jsfiddle.net/ashreva/6dz7g/10/)

在小提琴中，如果对输入字段进行了任何更改，您可以看到保存按钮正在隐藏和正确取消隐藏。我添加了启用取消按钮的代码，但它不起作用。

```
<div data-bind="enable: dirtyFlag().isDirty">
       <button>Cancel</button>
</div> 
```

请问你能告诉我为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T08:49:02.337

你去：

[http://jsfiddle.net/6dz7g/12/](http://jsfiddle.net/6dz7g/12/)

```
<input type="text" data-bind="value: name, valueUpdate: 'keyup'"/>  

<div data-bind="if: dirtyFlag().isDirty">
    <button>Save</button>
</div>  

<div>
    <button data-bind="enable: dirtyFlag().isDirty">Cancel</button>
</div> 
```

我只是为保存按钮使用了 ifnot 绑定。

# javascript - 如果用户未授权，则触发 jQuery UI 对话框

> ID：14753986
> 
> 赞同：0
> 
> 时间：2013-02-07T14:51:31.070
> 
> 标签：javascript, jquery-ui, authentication, asp.net-mvc-4

在我的网站上，我有两种登录方式。第一个用于然后用户按下登录按钮，这会触发一个 jQuery UI 对话框打开。第二个是普通视图，如果用户未授权，则使用该视图，它重定向到普通登录视图。但我喜欢做的是，如果用户未获得授权，它会打开登录 jquery ui 对话框，而不是重定向到用户预期的视图。

这就是我目前打开对话框的方式，

```
 $(".openLoginDialog").on("click", function (e) {
    e.preventDefault();
    $("<div></div>")
      .addClass("dialog")
      .attr("id", $(this).attr("data-dialog-id"))
      .appendTo("body")
      .dialog({
        title: $(this).attr("data-dialog-title"),
        create: function (event, ui) {},
        close: function () { $(this).remove() },
        open: function (event, ui) {},
        modal: true,
        position: ['center', 130],
        minWidth: 510,
        resizable: true,
        zIndex: 20000
      })
      .load(this.href);
  }); 
```

因为对话框中的内容是 partialView，所以这样调用：

```
<div class="items iconlogin highligth-br"><a class="openLoginDialog" data-dialog-id="LoginDialog" data-dialog-title="Login" href="@Url.Action("LogOn", "Authentication", new { returnUrl = Request.Url.ToString() })">Login</a></div> 
```

另外为了帮助我控制未授权，我已经覆盖了这个调用。

```
public override void OnAuthorization(AuthorizationContext filterContext)
    {
      filterContext.Result = new RedirectToRouteResult(new
            RouteValueDictionary(new { controller = "Authentication", action = "AccessDenied" }));
    } 
```

最后的手段是重定向到一个只有白色背景的拒绝访问页面，加载时打开一个对话框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:01:48.377

我有一个 MVC Intranet 解决方案，它使用与您描述的功能类似的功能，但是它使用的是 Windows 身份验证而不是表单。

基本上我在索引中有这样的东西......

```
var userExists = "@ViewBag.User";
// require the user to register if they are not found
if (userExists == "") {
    $.get('Home/Register/', function (data) {
        $("#Register").html(data);
        $("#Register").dialog({
            resizable: false,
            closeOnEscape: false,
            dialogClass: 'no-close',
            typeDelay: 250
        });
    });
} 
```

然后在控制器中，我只需将“ViewBag.User”设置为用户名（如果存在）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T14:57:17.737

看看这个例子：

*   [http://jqueryui.com/dialog/#modal-form](http://jqueryui.com/dialog/#modal-form)

注意`autoOpen: false`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T15:06:11.403

我不熟悉asp.net，所以我无法帮助实际实施。一种方法是检查请求来自哪里，如果用户没有被授权，则将他们重定向回该页面并通过对话框点击他们。

另一种方法是了解用户是否在页面加载时通过身份验证并覆盖需要身份验证的链接

```
$(".authRequired").on("click", function (e) {
e.preventDefault();
      //fancy logic here to load form and dialog
 }); 
```

# r - 找到所有可能的方法将元素列表拆分为给定数量的相同大小的组

> ID：14753987
> 
> 赞同：6
> 
> 时间：2013-02-07T14:51:32.893
> 
> 标签：r

我有一个元素列表，我想要一个对象，它可以为我提供将这些元素拆分为给定数量的相同大小的组的所有可能方法。

例如，这是我的清单：

```
MyElements <- c(1,2,3,4) 
```

我想要将它们分成两组的所有可能组合：

```
nb.groups <- 2 
```

例如，答案可能是这样的：

```
[[1]]

[1] 1,2

[2] 3,4

[[2]]

[1] 1,3

[2] 2,4

[[3]]

[1] 2,3

[2] 1,4 
```

我想避免这种重复：

```
[[1]]

[1] 1,2

[2] 3,4

[[2]]

[1] 3,4

[2] 1,2 
```

非常感谢 ！

谢谢你的回答。我想我应该给你更多关于我想要达到的目标的信息。

列表（或向量，因为显然 MyElements 是向量）实际上是个人的 ID 号。我想要一个列表，列出将这些人分成所需数量的所有可能的方法，这些组都具有相同的大小。

如果我没记错的话，目前唯一真正有效的解决方案是来自 Juba 的所谓的 brute-force-and-dirty 解决方案。但正如朱巴所说，它很快（对我的目的来说太快了！）无法使用。

再次感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-07T18:11:49.367

遵循递归逻辑允许您计算所有组合而无需重复，也无需先计算所有组合。只要 choose(nx-1,ning-1) 返回一个整数，它就可以很好地工作。如果没有，计算可能性有点荒谬。

这是一个递归过程，因此可能需要很长时间，并且当您的向量超过一定限制时会导致内存问题。但是话又说回来，将一组 14 个元素分成 7 组已经给出了 135135 种独特的可能性。在这类事情中，事情很快就会失控。

伪事物中的逻辑（不会称之为伪代码）

```
nb = number of groups
ning = number of elements in every group
if(nb == 2)
   1\. take first element, and add it to every possible 
       combination of ning-1 elements of x[-1] 
   2\. make the difference for each group defined in step 1 and x 
       to get the related second group
   3\. combine the groups from step 2 with the related groups from step 1

if(nb > 2)
   1\. take first element, and add it to every possible 
       combination of ning-1 elements of x[-1] 
   2\. to define the other groups belonging to the first groups obtained like this, 
       apply the algorithm on the other elements of x, but for nb-1 groups
   3\. combine all possible other groups from step 2 
       with the related first groups from step 1 
```

把它翻译成 R 给我们：

```
perm.groups <- function(x,n){
    nx <- length(x)
    ning <- nx/n

    group1 <- 
      rbind(
        matrix(rep(x[1],choose(nx-1,ning-1)),nrow=1),
        combn(x[-1],ning-1)
      )
    ng <- ncol(group1)

    if(n > 2){
      out <- vector('list',ng)

      for(i in seq_len(ng)){
        other <- perm.groups(setdiff(x,group1[,i]),n=n-1)
        out[[i]] <- lapply(seq_along(other),
                       function(j) cbind(group1[,i],other[[j]])
                    )
      }
    out <- unlist(out,recursive=FALSE)
    } else {
      other <- lapply(seq_len(ng),function(i) 
                  matrix(setdiff(x,group1[,i]),ncol=1)
                )
      out <- lapply(seq_len(ng),
                    function(i) cbind(group1[,i],other[[i]])
              )
    }
    out    
} 
```

为了证明它有效：

```
> perm.groups(1:6,3)
[[1]]
     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6

[[2]]
     [,1] [,2] [,3]
[1,]    1    3    4
[2,]    2    5    6

[[3]]
     [,1] [,2] [,3]
[1,]    1    3    4
[2,]    2    6    5

[[4]]
     [,1] [,2] [,3]
[1,]    1    2    5
[2,]    3    4    6

[[5]]
     [,1] [,2] [,3]
[1,]    1    2    4
[2,]    3    5    6

[[6]]
     [,1] [,2] [,3]
[1,]    1    2    4
[2,]    3    6    5

[[7]]
     [,1] [,2] [,3]
[1,]    1    2    5
[2,]    4    3    6

[[8]]
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    5    6

[[9]]
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    4    6    5

[[10]]
     [,1] [,2] [,3]
[1,]    1    2    4
[2,]    5    3    6

[[11]]
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    5    4    6

[[12]]
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    5    6    4

[[13]]
     [,1] [,2] [,3]
[1,]    1    2    4
[2,]    6    3    5

[[14]]
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    6    4    5

[[15]]
     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    6    5    4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T15:41:55.227

这里有一个基于分离柱构造的解决方案。

```
x <- 1:4
a <- as.data.frame(t(combn(x,length(x)/2))
a$sum <- abs(rowSums(a)-mean(rowSums(a)))
lapply(split(a,a$sum),function(x) if(dim(x)[1]>2) 
                                      split(x,1:(dim(x)[1]/2)) 
                                   else 
                                      x)

$`0`
  V1 V2 sum
3  1  4   0
4  2  3   0

$`1`
  V1 V2 sum
2  1  3   1
5  2  4   1

$`2`
  V1 V2 sum
1  1  2   2
6  3  4   2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T14:54:13.293

这是一个蛮力和肮脏的解决方案，它可能适用于不同数量的组，但您确实应该在使用前对其进行测试。此外，当它使用`permn`时，它会很快无法使用，具体取决于向量的大小：

```
library(combinat)
split.groups <- function(x, nb.groups) {
  length.groups <- length(x)/nb.groups
  perm <- permn(x)
  perm <- lapply(perm, function(v) {
    m <- as.data.frame(matrix(v, length.groups, nb.groups))
    m <- apply(m,2,sort)
    m <- t(m)
    m <- m[order(m[,1]),]
    rownames(m) <- NULL
    m})
  unique(perm)
} 
```

例如：

```
R> split.groups(1:4, 2)
[[1]]
     [,1] [,2]
[1,]    1    2
[2,]    3    4

[[2]]
     [,1] [,2]
[1,]    1    4
[2,]    2    3

[[3]]
     [,1] [,2]
[1,]    1    3
[2,]    2    4 
```

或者 ：

```
R> split.groups(1:6, 3)
[[1]]
     [,1] [,2]
[1,]    1    2
[2,]    3    4
[3,]    5    6

[[2]]
     [,1] [,2]
[1,]    1    2
[2,]    3    6
[3,]    4    5

[[3]]
     [,1] [,2]
[1,]    1    6
[2,]    2    3
[3,]    4    5

[[4]]
     [,1] [,2]
[1,]    1    2
[2,]    3    5
[3,]    4    6

[[5]]
     [,1] [,2]
[1,]    1    6
[2,]    2    5
[3,]    3    4

[[6]]
     [,1] [,2]
[1,]    1    5
[2,]    2    6
[3,]    3    4

[[7]]
     [,1] [,2]
[1,]    1    5
[2,]    2    3
[3,]    4    6

[[8]]
     [,1] [,2]
[1,]    1    5
[2,]    2    4
[3,]    3    6

[[9]]
     [,1] [,2]
[1,]    1    6
[2,]    2    4
[3,]    3    5

[[10]]
     [,1] [,2]
[1,]    1    4
[2,]    2    3
[3,]    5    6

[[11]]
     [,1] [,2]
[1,]    1    4
[2,]    2    6
[3,]    3    5

[[12]]
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6

[[13]]
     [,1] [,2]
[1,]    1    3
[2,]    2    5
[3,]    4    6

[[14]]
     [,1] [,2]
[1,]    1    3
[2,]    2    6
[3,]    4    5

[[15]]
     [,1] [,2]
[1,]    1    3
[2,]    2    4
[3,]    5    6 
```

# java - ANTLR 生成无效的 java 异常抛出代码

> ID：14753989
> 
> 赞同：4
> 
> 时间：2013-02-07T14:51:36.477
> 
> 标签：java, antlr3, antlrworks

这些天我一直在使用 ANTLRwork 1.5，以及 antlr runtime 3.5。这是我发现的一件奇怪的事情：Antlr 正在为我生成这种 java 代码：

```
public final BLABLABLAParser.addExpression_return addExpression() throws {
    blablabla...
} 
```

注意这个函数什么都不抛出，这在java中是无效的。所以我需要手动纠正这些错误。

有谁知道为什么？

这是示例语法，它直接取自《*语言实现模式*》一书。

```
// START: header
// START: header
grammar Cymbol; // my grammar is called Cymbol
options {
output = AST;
ASTLabelType = CommonTree;
}

tokens{
METHOD_DECL;
ARG_DECL;
BLOCK;
VAR_DECL;
CALL;
ELIST;
EXPR;
}
// define a SymbolTable field in generated parser

compilationUnit // pass symbol table to start rule
:   (methodDeclaration | varDeclaration)+ // recognize at least one variable declaration
;
// END: header

methodDeclaration 
:   type ID '(' formalParameters? ')' block
    -> ^(METHOD_DECL type ID formalParameters? block)
;

formalParameters
:   type ID (',' type ID)* -> ^(ARG_DECL type ID)+
;

// START: type   
type
:   'float' 
|   'int' 
|   'void'  
;
// END: type   

block   :   '{' statement* '}' -> ^(BLOCK statement*)
;

// START: decl
varDeclaration
:   type ID ('=' expression)? ';' -> ^(VAR_DECL type ID expression?)// E.g., "int i = 2;", "int i;"
;
// END: decl

statement
:   block
|   varDeclaration
|   'return' expression? ';' -> ^('return' expression?)
|   postfixExpression
    (
        '=' expression -> ^('=' postfixExpression expression)
        | -> ^(EXPR postfixExpression)
    ) ';'
;

 expressionList
:   expression(',' expression)* -> ^(ELIST expression+)
| -> ELIST
;

expression
:   addExpression -> ^(EXPR addExpression)
;
addExpression
:   postfixExpression('+'^ postfixExpression)*
;
postfixExpression
:   primary (lp='('^ expressionList ')'! {$lp.setType(CALL);})*
;
// START: primary
primary
:   ID // reference variable in an expression
|   INT
|   '(' expression ')' -> expression
;
// END: primary

// LEXER RULES

ID  :   LETTER (LETTER | '0'..'9')*
    ;

fragment
LETTER  :   ('a'..'z' | 'A'..'Z')
     ;

INT :   '0'..'9'+
    ;

WS  :   (' '|'\r'|'\t'|'\n') {$channel=HIDDEN;}
    ;

SL_COMMENT
    :   '//' ~('\r'|'\n')* '\r'? '\n' {$channel=HIDDEN;}
    ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T16:00:05.003

**编辑：**这是 ANTLRWorks 1.5 中的一个错误，已在下一个版本中修复。
[#5：ANTLRworks 无法生成正确的 Java 代码](https://github.com/antlr/antlrworks/issues/5)

我使用了您上面描述的确切配置，并带有复制/粘贴语法。为您提到的规则生成的签名如下：

```
// $ANTLR start "addExpression"
// C:\\dev\\Cymbol.g:72:1: addExpression : postfixExpression ( '+' ^ postfixExpression )* ;
public final CymbolParser.addExpression_return addExpression() throws RecognitionException { 
```

您可以发布生成文件的第一行吗？它应该以`// $ANTLR 3.5`如下开头：

```
// $ANTLR 3.5 C:\\dev\\Cymbol.g 2013-02-13 09:55:44 
```

# apache2 - AuthName 消息中的 UTF-8

> ID：14753992
> 
> 赞同：1
> 
> 时间：2013-02-07T14:51:40.740
> 
> 标签：apache2

如何使以下 .htaccess 工作（法语）：

```
AuthName "Page protégée"
AuthType Basic
AuthUserFile ".htpasswd"
Require valid-user 
```

该文件以 UTF-8 正确编写，但看起来只有顿悟浏览器能够显示此 UTF-8 消息。

到目前为止，我已经尝试在 httpd.conf 中进行设置：

```
AddDefaultCharset UTF-8 
```

完全没有效果。

# java - 如何处理返回对象和处理错误

> ID：14753994
> 
> 赞同：0
> 
> 时间：2013-02-07T14:51:51.527
> 
> 标签：java, exception-handling, arraylist, iterator, return

感谢您查看我的问题。我有以下用于 Java 平台的代码。我想摆脱数组和玩具代码，并尝试为此使用最佳实践和面向对象的原则，我知道我可以用一种更简单但可重用性较低的方式来做到这一点。

最终目标是创建一个纸牌游戏框架，我可以用它来处理套牌管理的日常部分，同时专注于不同游戏的实现。

我的错误处理有问题。我对 draw() 代码的想法如下 -

1）如果有另一张卡返回它并移动迭代器。这将消除对弃牌堆的需要，因为弃牌将在迭代器后面，而 .last() 卡是刚刚抽出的牌。

2) 如果没有另一张卡片并且“卡片”为空，则运行 emptyDeck() 方法。该方法将在子类中实现。例如，在纸牌游戏中，您可能希望在通过甲板 x 次后结束游戏，因此您可能不想再抽牌了。

3) 如果牌组不是空的并且你没有更多牌，那么你调用 endOfDeck() 方法，该方法将被子类化。同样，您可能想要洗牌或简单地重置迭代器

但是，我收到了旧的“必须返回卡”错误消息。我试过创建一个自定义异常，但我只能指定一个处理程序方法。谁能建议一个聪明的方法来做到这一点？

```
 public abstract class Deck 
{

private ArrayList<Card> cards;
private ListIterator<Card> deckPosition = cards.listIterator();
/**
 * 
 */
public Deck() 
{   
}

public Card draw()
{
    Card drawn;

    try
    {
        if(deckPosition.hasNext())
        {
            drawn = deckPosition.next();
        }
        else if(cards.isEmpty())
        {
            emptyDeck();
        }
        else
        {
            endOfDeck();
        }
    }

    catch(Exception e)
    {
        System.out.println("Exception when drawing a card, check try/catch block in draw() method of Deck");
        e.printStackTrace();
    }

    finally
    {
        return drawn;
    }
}

public abstract void endOfDeck();
public abstract void emptyDeck();

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T14:59:00.213

当一个方法由于内部错误而无法返回有意义的结果时，该方法应该抛出一个异常而不是只返回一些东西。因此，当您的绘图方法中发生该方法本身无法管理的错误时，它应该自己抛出一个异常，然后由调用者处理。

在这种情况下，我将创建一个新的异常类`DeckEmptyException`。当牌组为空时，draw 方法将抛出该异常而不是返回一张牌。任何调用 draw 方法的人都必须处理这个异常。