# StackOverflow 问答 14448000-14448999

# c# - DocType 标记上的 XML 反序列化失败

> ID：14448008
> 
> 赞同：4
> 
> 时间：2013-01-21T21:59:43.003
> 
> 标签：c#, doctype, xmlserializer

我正在与向我们发送 XML 消息的第三方应用程序集成。他们的 XML 看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE theirObj SYSTEM "theirDTD-2.0.dtd">
<theirObj>
    <properties>
        <datasource>ThirdParty</datasource>
        <datetime>2009-03-05T14:45:39</datetime>
    </properties>
        <data>
          ...
        </data>
</theirObj> 
```

我正在尝试使用 XmlSerializer 反序列化它：

```
public theirObj Deserialize(string message) {
            if( string.IsNullOrWhiteSpace( message ) ) {
                throw new ArgumentNullException( "message" );
            }
            XmlSerializer xmlSerializer = new XmlSerializer( typeof(theirObj ) );

            TextReader textReader = new StringReader( message );

            using (XmlReader xmlReader = new XmlTextReader( textReader )) {
                object deserializedObject = xmlSerializer.Deserialize( xmlReader );

                theirObj ent = deserializedObject as theirObj ;

                if (ent == null) {
                    throw new InvalidCastException("Unable to cast deserialized object to an theirObj object. {0}".FormatInvariant( deserializedObject));
                }

                return ent;
            }
        }
} 
```

我使用 xsd.exe 生成了对象。

如果我删除`<!DOCTYPE>`标签，那么它反序列化很好。

有没有办法让 XmlSerializer 忽略`<!DOCTYPE>`标签？

我知道我可以在将它传递给 XmlSerializer 之前将其删除，但如果我不需要，我宁愿不去那种级别的 XML 操作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T22:21:38.950

而不是使用`XmlTextReader`，调用[`XmlReader.Create`](http://msdn.microsoft.com/en-us/library/ms162475.aspx)并传递一个设置为的`XmlReaderSettings`对象：[`DtdProcessing`](http://msdn.microsoft.com/en-us/library/system.xml.xmlreadersettings.dtdprocessing.aspx)[`Ignore`](http://msdn.microsoft.com/en-us/library/system.xml.dtdprocessing.aspx)

```
TextReader textReader = new StringReader( message );
var settings = new XmlReaderSettings { DtdProcessing = DtdProcessing.Ignore };

using (XmlReader xmlReader = XmlReader.Create(textReader, settings)) 
```

**注意：**该`DtdProcessing`属性是在 .NET 4.0 中添加的。在 .NET 3.5 中，您可以改为设置[`ProhibitDtd`](http://msdn.microsoft.com/en-us/library/system.xml.xmlreadersettings.prohibitdtd.aspx)为`false`和：[`XmlResolver`](http://msdn.microsoft.com/en-us/library/system.xml.xmlreadersettings.xmlresolver.aspx)`null`

```
var settings = new XmlReaderSettings { ProhibitDtd = false, XmlResolver = null }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:06:10.900

DOCTYPE 没有内置的 XmlSerlization 属性。事实上，这是因为 XML 序列化是基于元素而不是基于文档的。我认为您可以使用以下方法在序列化中跳过 DOCTYPE：

```
public static String Serialize(object obj)
{
    StringBuilder builder = new StringBuilder();
    XmlSerializer serializer = new XmlSerializer(typeof(theirObj));

    using (XmlWriter writer = XmlWriter.Create(builder, new XmlWriterSettings() { OmitXmlDeclaration = true }))
        xmlSerializer.Serialize(writer, obj);

    return builder.ToString();
} 
```

然后，在文档反序列化后将其注入回去。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:11:45.790

您可以删除文档类型

```
TextReader textReader = new StringReader( message );
XmlDocument XDoc = new XmlDocument();
XDoc.Load(textReader);
XmlDocumentType XDType = XDoc.DocumentType;
XDoc.RemoveChild(XDType);

using (XmlReader xmlReader = new XmlTextReader(XDoc)) {
                object deserializedObject = xmlSerializer.Deserialize( xmlReader );

                theirObj ent = deserializedObject as theirObj ;

                if (ent == null) {
                    throw new InvalidCastException("Unable to cast deserialized object to an theirObj object. {0}".FormatInvariant( deserializedObject));
                }

                return ent;
            } 
```

# ruby-on-rails - 为什么 Rails 应用程序没有拆分，业务逻辑没有转移到 gems 中？

> ID：14448011
> 
> 赞同：4
> 
> 时间：2013-01-21T21:59:48.043
> 
> 标签：ruby-on-rails, ruby, business-logic-layer

在 ASP.NET MVC 应用程序和 Java Web 应用程序中，有一种常见的做法是将业务逻辑保存在单独的包/dll 中，并将数据库和交付机制（Web 应用程序、Web 服务、本机移动或桌面等）视为[插入的细节](http://www.youtube.com/watch?v=WpkDN78P884)。

我可以说这种结构的一些优点是：

*   使用不同的交付机制或持久层重用业务逻辑
*   无需加载 Web 框架或连接到数据库即可运行业务逻辑的验收和单元测试；测试非常快
*   考虑应用程序的本质，而不是交付方式

但这种做法在 Rails 社区中并不常见；我没有看到任何 Rails 应用程序将业务逻辑保存在 gems 中，并且主要的 ORM 都将持久性逻辑和业务逻辑联系在一起。Ruby 是否有一些东西使我提到的结构化应用程序变得不必要？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:13:34.700

定义“必要”。在 .NET 或 Java 中没有*必*要这样做，它很*方便*。

Rails 应用程序通常只在单个应用程序中完全公开 Web 应用程序和相关服务。

测试类似；没有*必要*为了单独测试代码而分解应用程序功能，在 Rails 中的测试也不例外：有可以在任何级别的代码运行的单元测试、规范等，以及模拟任意部分的各种机制的功能。

持久层通常由 AR 层处理，尽管在实践中实际*切换*持久层是相当不寻常的（我在 30 年的开发中恰好这样做过一次，但这显然是轶事）。此外，由于鸭子类型，Ruby 中的一些此类切换在代码级别是透明的（例如，我通过移动到 ActiveResource 而不是 ActiveRecord 将一个应用程序从本地 DB 切换到服务几乎是透明的，尽管我没有尝试之后优化任何东西，数据模型非常简单。）

综上所述，IMO Rails 社区经常忽略“企业”商店的实践，因为 Ruby 语言使得构建功能变得非常容易，而无需过度架构。然而，只有在应用程序达到一定大小后，这种限制才会变得清晰。

Ruby 和 Rails 开发的最新趋势包括我多年来在企业中所做的事情（并且在 Ruby 中实现比在 Java 中容易得多）。但是，为了自己的缘故将功能分解到库中并不是特别有用。识别*应该*被分解的代码*是*，但是当有必要这样做时，它会跨环境发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:10:18.397

Rails 是关于约定优于配置的。以及已提出的意见/最佳实践。

我认为将 BLL 分解为 Gem 并没有什么大的优势。除非我有独立于我的网络应用程序并且可以重用的代码。例如，我最近为一个公司论坛构建了一个 BBCode 解析器，所以我将它打包为一个 GEM，可以插入任何 Rails 应用程序。github 上有数以千计的 GEM，它们在功能上扩展了 rails。

为 Rails 应用程序制作 GEM 的整个想法应该是代码重用。如果您分离代码只是为了尝试遵循更多的代码分离，那么您就不会依赖 Rails 约定，并且如果任何其他 Rails 开发人员加入您的项目，他们将有一个学习曲线。

您可以使用任意数量的测试系统，它们不会在 Rails 中加载 Web 框架。在整个巨大的主题中进行测试，我会研究 RSpec 等等。并且有一些方法可以加快测试速度（例如使用 Guard 和 Spork）

这完全取决于应用程序。Rails 的想法是让您的应用程序快速完成。根据我的经验，Java 开发一直非常缓慢。ASP 也一样。但这些可能只是“糟糕的经历”。很多人都信誓旦旦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:15:45.560

大多数情况下，这只是关于努力和配置。让我们分解各个点：

**努力：**设置一个新的 gem 需要一点时间（每个项目都有自己特定的一组依赖项——测试、模拟、文档等）

**配置：**由于大多数 Rails 应用程序使用 ActiveRecord；拆分模型层有点困难（尽管[很多](https://github.com/plataformatec/devise) [宝石](http://activeadmin.info/)[都](https://github.com/norman/friendly_id) 这样做）。 不过，这有助于减轻这方面的痛苦。[`Rails::Engine`](http://edgeguides.rubyonrails.org/engines.html)

**成本：**对于大多数 Rails 项目，通过将代码拆分到单独的 gem/repo 中获得的收益很少：

*   大多数项目不会在彼此之间共享代码（当他们这样做时，他们*会*设置 gem）

*   有——或者应该有，通过正确的设置——你测试代码的方式没有区别；无论是在 gem 中还是在您的主项目中。（您可以在不使用控制器等的情况下测试模型 - 没问题）

*   主要的好处是在接口/层之间强制执行*显式*契约——这在 Ruby 社区中不太普遍

# iis - sqlbulkcopy 仅导入 67000 行中的 17837

> ID：14448014
> 
> 赞同：0
> 
> 时间：2013-01-21T21:59:59.570
> 
> 标签：iis, sqlbulkcopy

sqlbulkcopy 函数在我的本地环境中运行良好，但是当我将它部署到 IIS 时，它只从 67K 奇数行中导入 17837。有谁知道什么会导致这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T16:09:57.747

实际上，问题出在 Excel 连接字符串的最后，我错过了“IMEX=1”。正确的连接字符串是 - Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\uploaded.xlsx;Extended Properties='Excel 12.0 Xml;HDR=YES;IMEX=1'"

# iphone - peoplePickerNavigationController 泄漏

> ID：14448016
> 
> 赞同：1
> 
> 时间：2013-01-21T22:00:03.300
> 
> 标签：iphone, ios, core-foundation

我正在尝试从联系人中获取姓名和姓氏，并将值存储在几个 NSString 中：

```
CFStringRef cfName = ABRecordCopyValue(person, kABPersonFirstNameProperty);
self.stName = (NSString *)cfName;
CFRelease(cfName);
CFStringRef cfLastname = ABRecordCopyValue(person, kABPersonLastNameProperty);
self.stLastname = (NSString *)cfLastname;
CFRelease(cfLastname); 
```

问题是，如果联系人中的名字或姓氏为空，当我释放 CFStringRef 时，应用程序会因 EXC_BAD_ACCESS（僵尸？）而崩溃。如果我不释放 CFStringRef 我有泄漏。

任何建议表示赞赏。

最大限度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:23:31.953

是的，如果您将参数传递给它，`CFRelease`将会崩溃 ( ) 。`halt``NULL`

sbooth[在这里](https://stackoverflow.com/a/1608425/653513)已经提到了这一点。

`CFRelease`看起来像这样：

```
void CFRelease(CFTypeRef cf) {
    if (NULL == cf) HALT;  //this line will get you 
#if DEPLOYMENT_TARGET_MACOSX || DEPLOYMENT_TARGET_EMBEDDED
    if (CF_IS_COLLECTABLE(cf)) {
        if (CFTYPE_IS_OBJC(cf)) {
            // release the GC-visible reference.
            auto_zone_release(auto_zone(), (void*)cf);
        } else {
            // special-case CF objects for better performance.
            _CFRelease(cf);
        }
        return;
    }
#endif 
```

[资源](http://www.opensource.apple.com/source/CF/CF-550/CFRuntime.c)

因此，您有责任检查您是否通过了它`NULL`。

您的（已删除）答案是正确的。代码应如下所示：

```
CFStringRef cfName = ABRecordCopyValue(person, kABPersonFirstNameProperty);
self.stName = (NSString *)cfName;
if (self.stName) CFRelease(cfName);
CFStringRef cfLastname = ABRecordCopyValue(person, kABPersonLastNameProperty);
self.stLastname = (NSString *)cfLastname;
if (self.stLastname) CFRelease(cfLastname); 
```

您仍然可能会收到编译器警告，但此代码应该可以正常工作。

# ios - 项目列表与数据源

> ID：14448017
> 
> 赞同：1
> 
> 时间：2013-01-21T22:00:10.600
> 
> 标签：ios, uitableview, datasource, uitabbar

在为 iPhone 应用程序构建视图时，必须考虑视图如何确定可变数据。两个设计选项很容易想到：

*   一个`NSArray`项目
*   一个`dataSource`属性，它实现一个协议并返回项目。

前者由诸如 之类的视图使用[`UITabBar`](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITabBar_Class/Reference/Reference.html#//apple_ref/doc/c_ref/UITabBar)，而后者由 使用[`UITableView`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableView_Class/Reference/Reference.html)。这些选项的优缺点是什么？这两种截然不同的范式是有原因的，还是一种普遍优越？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:13:32.307

它主要与简单性相关的数据量和有限的内存量有关。

如果你能摆脱它，更简单总是更好。一个标签栏可能有少于 10 个项目，一次保存在内存中是没有问题的，所以最简单的解决方案是最好的。

然而，表视图可能有数千行可能包含昂贵的数据，例如图像。因此，它具有更复杂的设计，能够仅将必要的数据保留在内存中。

# eventbrite - 我可以在订单确认重定向 URL 中传递其他值吗？

> ID：14448019
> 
> 赞同：4
> 
> 时间：2013-01-21T22:00:12.397
> 
> 标签：eventbrite

感谢用户 ʀɣαɳĵ[对 StackOverflow 上类似问题](https://stackoverflow.com/questions/13868008/pass-eventbrite-attendee-parameters-to-custom-order-confirmation-page-via-redire)的回答。

显然，当使用确认页面重定向将人们引导到网站时，我可以以“$event_id”或“$order_id”的形式传入 eventbrite 特定信息

仅此一项就很棒 - 感谢 Eventbrite 提供这种级别的集成。我要厚脸皮，要求更多！除了订单 id 和事件 id 之外，最好的方法是传递额外的东西，例如订单价值，这样我就可以开始使用 Google Analytics、Adwords 和其他网站跟踪做有趣的电子商务事情.

我想要的是 $order_amount 和 $coupon_code 以及 $discount_percent 和 $discount_amount

有没有这样的附加值？

我知道我可以仅根据订单 ID 手动计算这些东西，但是 A) 需要时间，B) 阻止我根据订单数量在页面上自动执行任何操作，C) 阻止我与各种网络集成分析。

而且，如果这还不存在，我们可以把它放到下一个版本中吗？

提前谢谢了

# drupal - 块中的 PHP 过滤器无法识别标准变量

> ID：14448020
> 
> 赞同：0
> 
> 时间：2013-01-21T22:00:14.937
> 
> 标签：drupal, drupal-7, drupal-theming

我已经打开了 PHP 过滤器，所以我可以将 PHP 放在块文本中，但是以下变量：

```
<?php print $node_url; ?>
<?php print $title ?>
<?php print $directory; ?> 
```

导致以下错误：

```
Notice: Undefined variable: node_url in eval() (line 2 of /modules/php/php.module(80) : eval()'d code).
Notice: Undefined variable: directory in eval() (line 2 of /modules/php/php.module(80) : eval()'d code).
Notice: Undefined variable: title in eval() (line 3 of /modules/php/php.module(80) : eval()'d code). 
```

我知道这在 Drupal 6 中有效。有什么建议吗？

——马歇尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T05:57:47.327

答案是在 Drupal 7 主题中，节点对象不一定存在。去搞清楚。所以你必须自己声明它并创建你自己的变量。并且在对其进行操作时，您必须在“if isset()”语句中执行此操作。因此，要生成变量，请执行以下操作：

```
<?php
$directory = drupal_get_path('theme', 'THEME_NAME');
$node = menu_get_object();
if (isset($node)) {
    $nid = $node->nid;
    $node_url = 'node/' . $nid;
    $title =  $node->title;
    ...[rest of code goes here]
    ...[can't use variables derived from $node outside the 'if isset()']
} 
```

?>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T12:44:29.803

关于您的变量 << $directory >>，我想您的意思是获取节点别名：如果您已经获得了 NID，您可以通过以下方式获取它：

```
$path = drupal_get_path_alias('node/' . $node->nid); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T09:04:33.133

块内容是在主题层生效之前创建的。这意味着在构建块时，这些变量不可用。您必须自己加载节点并创建所需的变量。

# c# - 如何使用结构的指针数组定义函数作为从 C 到 C# 的参数

> ID：14448023
> 
> 赞同：0
> 
> 时间：2013-01-21T22:00:22.300
> 
> 标签：c#, pinvoke

在 C 代码中，函数定义如下：

```
INT WINAPI myFunction(LPCTSTR str1, LPCTSTR str2, INT iNumber,
    LPSTRUCT *lpStruct); 
```

`*lpStruct`是一个结构类型的指针数组：

```
typedef struct myStruct
{
CHAR                    m_s1[64];       
UINT                    m_nS;       
CHAR                    m_s2[8][64];    
UINT                    m_nP;
CHAR                    m_s3[512];

} SomeStruct, *LPSTRUCT; 
```

我需要`myFunction`在 C# 中调用这个外部，我定义`SomeStruct`为：

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public struct SomeStruct
{

   [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 64)]
   public string m_s1;             
   public uint m_nS;             
   [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 512)]
   public string m_s2;             
   public uint m_nP;
   [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 512)]
   public string m_s3;
 } 
```

我的函数为：

```
[DllImport("some.dll")]
public static extern int myFunction(
             string str1,
             string str2,
             int iNumber,
             IntPtr[] lpStruct); 
```

我在 C# 中初始化 IntPtr[]：

```
IntPtr[] lpptr = new IntPtr[iNumber]; 
```

我知道指针的结构数组有`iNumber`元素。

调用这个函数没有错误（`lpStruct[i]`有数字）。但是当我尝试使用以下命令编组指向结构的指针时：

```
SomeStruct st = (SomeStruct )Marshal.PtrToStructure(lpStruct[i], 
    typeof(SomeStruct )); 
```

我收到错误消息：尝试写入只读内存。我不知道这里有什么问题。是 C# 中的外部函数定义错误还是 struct 定义错误，或两者兼而有之。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:38:20.337

尝试将 Struct 定义为 C# 中的类

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
internal class SomeStruct
{

   [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 64)]
   public string m_s1;             
   public UInt32 m_nS;             
   [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 512)]
   public string m_s2;             
   public UInt32 m_nP;
   [MarshalAsAttribute(UnmanagedType.ByValTStr, SizeConst = 512)]
   public string m_s3;
} 
```

也尝试用 UInt32 代替 uint

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:43:12.673

这个问题缺少重要的细节，但我希望您需要为数组中的每个 IntPtr 分配内存。

```
IntPtr[] lpptr = new IntPtr[iNumber];
for (int i=0; i<iNumber; i++)
    lpptr[i] = Marshal.AllocHGlobal(Marshal.SizeOf(typeof(SomeStruct))); 
```

显然，一旦你完成了它，你应该释放内存。

# java - Android光标超出范围异常索引0

> ID：14448024
> 
> 赞同：0
> 
> 时间：2013-01-21T22:00:23.957
> 
> 标签：java, android, sqlite

我正在尝试在我的数据库中检索一个人的姓名。目前我得到一个越界错误。

我知道存在我试图检索的数据，因为我有一个显示数据库中所有数据的列表视图。

IF ELSE 检查：

```
 NameAppointPass.open();
    String nameReturned = NameAppointPass.getName(sentID);
    if(nameReturned != "")
    {
        Dialog d = new Dialog(this);
        d.setTitle("returned");
        TextView txt = new TextView(this);
        txt.setText("win");
        d.setContentView(txt);
        d.show();
    }
    else
    {
        Dialog d = new Dialog(this);
        d.setTitle("empty");
        TextView txt = new TextView(this);
        txt.setText("Fail");
        d.setContentView(txt);
        d.show();
    } 
```

希望有人能看到我哪里出错了。

目前我收到以下错误：

```
01-21 21:41:43.753: E/AndroidRuntime(276): FATAL EXCEPTION: main
01-21 21:41:43.753: E/AndroidRuntime(276): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.flybase2/com.example.flybase2.addAppointment}: android.database.CursorIndexOutOfBoundsException: Index 0 requested, with a size of 0 
```

我正在使用 onclick 'long variable' 从列表视图发送我想要的数据的 ID，如下所示：

```
public void onListItemClick(ListView list, View v, int list_posistion, long item_id)
{

    long idToPass = item_id;

    Intent setName = new Intent("com.example.flybase2.addAppointment");
    setName.putExtra("newPassedID", idToPass);
    startActivity(setName);  
} 
```

然后通过捆绑将其发送到对象实例“NameApppointPass”，如下所示：

```
NameAppointPass.open();
String nameReturned = NameAppointPass.getName(sentID); 
```

以下代码显示了`getName`查询数据库的方法，应该返回存储在所选 ID 处的名称，但我得到了错误：

```
public String getName(long passedID) {

        String [] columns = new String[]{KEY_ROWAPPID, KEY_NAMEAPP,   KEY_TYPEAPP, KEY_TIMEAPP, KEY_DATEAPP, KEY_COMMENTAPP};
        Cursor c = ourDatabase.query(DATABASE_TABLEAPP, columns, KEY_ROWAPPID + "=" + passedID, null, null, null, null);
        if(c != null)
        {
        c.moveToFirst();
        String name = c.getString(1);
        return name;
        }

        return null;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:05:09.943

如果游标可以为空，可以检查游标是否没有数据：

```
 if(c != null && c.getCount() > 0) 
```

为了进一步诊断游标为空的原因，请在各个位置放置日志语句以检查项目 ID 是否仍然正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T00:37:31.583

设法得到这个排序。最后，我错误地将我的变量命名为保存传递的 ID。

# sql - 一步选择具有最大变量的行

> ID：14448028
> 
> 赞同：2
> 
> 时间：2013-01-21T22:00:42.633
> 
> 标签：sql, sql-server

我有一个看起来像这样的表：

```
--------EXAMPLE---------------------------------------------------------
Cat1           Cat2          Value
a              NULL          131
b              e1            143
a              e2            135
c              NULL          136
a              e1            132
a              NULL          13
c              e4            1 
```

我想从上面选择 Cat1 中各种类型的值最高的行。因此，我的答案如下所示：

```
--------EXAMPLE---------------------------------------------------------
Cat1           Cat2          Value
b              e1            143
a              e2            135
c              NULL          136 
```

我正在使用 Microsoft SQL，我正在寻找一些高效的东西，因为我的表中有大约 4000 万行需要操作。

谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:03:33.483

您可以使用`CTE`with `DENSE_RANK`：

```
WITH cte 
     AS (SELECT cat1, 
                cat2, 
                Value, 
                Rank = Dense_rank() 
                         OVER ( 
                           partition BY cat1 
                           ORDER BY Value DESC) 
         FROM   dbo.tablename) 
SELECT cat1, 
       cat2, 
       value 
FROM   cte 
WHERE  rank = 1 
```

如果有多个记录具有相同的最高值，则使用`Row_Number`而不是只需要单个（任意）记录。`Dense_Rank`

# jquery - jquery用.ajax加载另一个网站替换img src

> ID：14448030
> 
> 赞同：0
> 
> 时间：2013-01-21T22:00:46.793
> 
> 标签：jquery, html, ajax, mobile, titanium

我尝试从另一个网站加载 div，但是当我加载时，img src 不是完整路径，所以我看不到图像，所以我需要用完整的真实路径替换它们。我尝试但它不起作用。我该如何解决我的问题？

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script type="text/javascript" src="jquery.min.js"></script>
</head> 
```

```
 <div id="pull"></div>
 <script>

   $.ajax({
       url: "http://www.example.com",
       cache: false,type: "POST"
       }).done(function( html ) {
           var news=$(html).find('.news_slider');
           $(news).find('img').attr("src",$(news).find('img').attr("src").
           replace(".images/","http://www.example.com/images/"));
          $("#pull").append(haberler);
       });
</script>
</body>
</html> 
```

我在我的 android 移动应用程序上对其进行了测试，该应用程序是用钛移动编程的，但是 webview ui 以错误的屏幕分辨率呈现它。这是非常大的视野。我该如何解决？我的钛代码是这样的：

```
var win5 = Titanium.UI.createWindow({
    title : 'Servisler',
    backgroundColor : '#CEE6F2'
 });
var tab5 = Titanium.UI.createTab({
icon : 'duyuru.png',
title : 'Servisler',
window : win5
 });

var servis = Ti.UI.createWebView({
url : 'servis.html',//upside code is servis.html
 width:'100%'
 });
win5.add(servis); 
```

谢谢你的兴趣..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:11:11.343

由于跨域限制，您应该无法使用 AJAX 访问其他站点。

要回答如何更改所有图像：

您需要遍历每个图像，这可以通过多种方式完成，`each`或者`attr()`有一个函数参数也可以这样做

```
$(news).find('img').attr("src", function( i, SRC){
     return SRC.replace(".images/","http://www.example.com/images/");
}); 
```

API 参考：http: [//api.jquery.com/attr](http://api.jquery.com/attr)

# c# - 如何从文件中读取 rtf 并将其插入到 Outlook 项目的正文中？

> ID：14448031
> 
> 赞同：1
> 
> 时间：2013-01-21T22:00:52.753
> 
> 标签：c#, vsto, add-in, outlook-addin

我正在尝试编写一个功能与 Microsoft Outlook 的插入签名功能非常相似的 Outlook 加载项。我发现讨论与此类似的东西的最好和最详细的线程[在这里找到。](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/02056c49-f3ac-4e46-bedf-2c6f849d7bce)

我的代码的问题是内存流，尽管它是一个可以从 word 打开的 rtf 文件，但它返回 null。

```
doc = ms as Microsoft.Office.Interop.Word.Document ; 
```

我正试图让它工作

```
 if (selObject is Outlook.AppointmentItem)
    {
        Outlook.AppointmentItem obj = (Outlook.AppointmentItem)selObject;
        Microsoft.Office.Interop.Word.Document doc = obj.GetInspector.WordEditor as Microsoft.Office.Interop.Word.Document;
        if (doc != null)
        {
            String path = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),
                "Outlook", "Intercall.rtf");

            if (File.Exists(path))
            {
                MemoryStream ms = new MemoryStream();
                Stream fs = new FileStream(path,FileMode.Open);
                fs.CopyTo(ms);
                doc = ms as Microsoft.Office.Interop.Word.Document ;
                fs.Close();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T17:12:27.327

您是否期望从 MemoryStream 转换为 Microsoft.Office.Interop.Word.Document 会成功？MemoryStream 对 Word 或任何其他 COM 对象一无所知。您需要明确创建 Word.Application 对象的实例，使用它来加载 RTF。您还可以使用 Outlook 对象模型中的 Inspector.WordEditor 来获取 Word.Document 对象的实例。

# jsp - 我可以将 HttpServletRequest 的实例传递给 Facades

> ID：14448034
> 
> 赞同：0
> 
> 时间：2013-01-21T22:01:04.117
> 
> 标签：jsp, java-ee-6

如果我为我的应用程序使用模式 JSP->Controller->Facade->Services->DAO，将我的 HttpServletRequest 实例传递给我的外观是好还是坏的做法。我有发送请求的好处，但我不确定是否这样做。

如果这是一种不好的做法，请解释您为什么这么认为，以便我更好地了解为什么我不应该这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:30:54.720

不，这不是一个好习惯。通过这样做，您可以将外观与特定的视图技术联系起来。通过这样做，您还将表示层逻辑放在服务层中，这与您决定使用的层分离相违背。最后，它会阻止将服务层放在表示层之外的另一个 JVM 上。

您应该从控制器内部的 HTTP 请求中提取数据，将这些数据转换为具有适当类型的对象，并将这些对象传递给服务层。这也将使服务层更具可测试性。

# javascript - chrome.cookies.set 甚至没有运行

> ID：14448039
> 
> 赞同：2
> 
> 时间：2013-01-21T22:01:25.873
> 
> 标签：javascript, google-chrome-extension

以下代码由于某种原因不起作用：

背景.js

```
alert("1");
chrome.cookies.set({ url: "https://mywebsite.com", name: "SuperDuperTest" });
alert("2"); 
```

清单.json

> “权限”：[“通知”、“ [https://mywebsite.com](https://mywebsite.com) ”、“cookies”、“http://* /*”、“https://*/*”]、

只有警报（“1”）；永远火。警报 2 从来没有，为什么我的 chrome cookie 根本没有触发？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-22T11:49:07.203

在哪里查看您的 cookie 是否已设置？请使用`console.log()`代替`alert()`

## 示例代码

### 清单.json

注册后台页面并授予 Cookies API 权限。

```
{
    "name": "Cookie API Demo",
    "version": "1",
    "description": "http://stackoverflow.com/questions/14448039/chrome-cookies-set-doesnt-even-run",
    "permissions": [
        "cookies",
        "<all_urls>"
    ],
    "background": {
        "scripts": [
            "background.js"
        ]
    },
    "manifest_version": 2
} 
```

### 背景.js

`cookies.html`为页面设置 cookie 的简单代码

```
chrome.cookies.set({
    "name": "Sample1",
    "url": "http://developer.chrome.com/extensions/cookies.html",
    "value": "Dummy Data"
}, function (cookie) {
    console.log(JSON.stringify(cookie));
    console.log(chrome.extension.lastError);
    console.log(chrome.runtime.lastError);
}); 
```

# 输出

转到[https://developer.chrome.com/extensions/cookies.html](https://developer.chrome.com/extensions/cookies.html)并打开开发人员工具，如图所示，您可以看到正在设置 cookie！。

[点击查看大图](https://i.stack.imgur.com/XYahW.png)

![在此处输入图像描述](../Images/8917572e67d993ee3a75048e94fe7aea.png)

# 进一步调试

如果此示例代码不起作用，`chrome.extension.lastError`和的值是`chrome.runtime.lastError`什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:10:30.190

确保您声明了 cookie 权限。

> 要使用 cookie API，您必须在清单中声明“cookies”权限，以及您想要访问其 cookie 的任何主机的主机权限。例如：

```
{
  "name": "My extension",
  ...
  "permissions": [
    "cookies",
    "*://*.google.com"
  ],
  ...
} 
```

来源：[developer.chrome.com](http://developer.chrome.com/extensions/cookies.html)

# ios - 向地图添加注释太慢 - iOS

> ID：14448040
> 
> 赞同：5
> 
> 时间：2013-01-21T22:01:25.957
> 
> 标签：ios, performance, ipad, annotations, maps

关于在 iOS 中向地图添加注释（使用标准 mapkit 方法 - 因此使用 Apple 地图），我遇到了性能问题。`(void)addAnnotations:(NSArray *)annotations`我正在尝试使用该方法批量添加大量注释（10000+） 。注释对象没有什么特别的 - 一个非常基本的类，`MKAnnotation`只使用定义如下的构造函数来实现：

```
- (id)initWithTitle:(NSString *)ttl andCoordinate:(CLLocationCoordinate2D)c2d {
    if(self = [super init]) {
        title = ttl;
        coordinate = c2d;
    }

    return self;
} 
```

为了测试，我创建了一个基本应用程序，它只是在加载时将注释添加到基本地图视图中，在 iPad 2 上大约需要 6-7 秒。非常可接受的性能。但是，当我在自己的应用程序中嵌入相同的基本地图视图时，事情变得复杂了。这是完全相同的逻辑，但是当我在我的应用程序中执行此操作时，加载所有注释大约需要 50 秒。

我的应用程序彼此之间有很多视图。为了查明问题，我从最低级别开始嵌入地图视图，直到达到最高级别。我已经在每个步骤中进行了分析，看看它是否有助于提高性能，但我没有看到任何结果——它仍然是 50 秒左右。现在，我的应用程序基本上只是加载注释并将注释添加到顶层和唯一的地图视图，理想情况下与独立应用程序相同，但无论出于何种原因，我仍然看到注释渲染大约需要 50 秒。我唯一合理的解释是关于我拥有的一些应用程序设置以某种方式干扰了地图性能。我做了一堆阅读来提出一个无济于事的解决方案。

有人对这里可能出现的问题有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T11:29:11.207

没有实际的“问题”。我的意思是，您有超过 10000 次分配、绘制和渲染实际上对应用程序的性能产生了影响。

我的建议是拦截地图上的用户导航。使用类似的东西`[mapView visibleMapRect]`在屏幕上获取地图的可见部分。获取矩形的坐标（可能稍微大一点，以便用户在移动地图时不会注意到）并仅加载该矩形内的注释。

当用户移动时，您只需加载新矩形中的注释减去已在前一个矩形中加载的注释。我想您也可以在它们离开屏幕时删除注释。

这有点类似于 Apple 在处理滚动视图时建议做的事情。我记得用户必须加载滚动视图的前一个和下一个部分的内容（并释放前一个视图的内容）的应用程序，这样才能降低内存消耗并保持良好的用户体验.

尝试考虑用户正在查看的内容，尝试仅显示与该部分（或在 MKMapView 行话中称为区域）相关的注释，我认为您的应用程序响应能力会立即提高。

# c# - 如何控制应用程序的背景音乐？

> ID：14448046
> 
> 赞同：0
> 
> 时间：2013-01-21T22:01:56.400
> 
> 标签：c#, c++, windows-phone-8

我有一个`c#/xaml`应用程序。我想播放指令声音，但如果用户正在播放背景音乐，我想将其静音，或者在播放声音时暂时降低音量。

目前，我正在使用`xaudio2`C++ 播放我的音频，并使用一些委托来调用 C#，我正在使用`MediaPlayer`来自 的类`xna framework`来静音背景媒体。

但是，暂停音乐后，当我通过 播放我的指令时，我从框架中`xaudio2`得到`System.InvalidOperationException`异常。`xna`如果我注释掉播放声音的行，也不例外。

我想值得注意的是，这并没有发生在 UI 线程上......

我会以正确的方式解决这个问题吗？我找不到任何有关如何完成此操作的信息的链接 - 我正在抓住稻草。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T21:39:38.660

事实证明，在调用 MediaPlayer.Pause() 之前，我并没有调用 FrameworkDispatcher.Update()。但如果您的应用需要，这是可以做到的。

# html - 分页符在Firefox中不起作用

> ID：14448055
> 
> 赞同：1
> 
> 时间：2013-01-21T22:02:24.433
> 
> 标签：html, css

我需要生成一堆表，每个表都有一个标题（`<thead>`由两个组成`<tr>`）。表格比需要打印。一个单独的表格不应该被打破，除非它对于一页来说太长，否则标题应该被重复。标题永远不应该分成两页。我注意到这`page-break-inside: avoid`在 Firefox < 19 中不起作用。有什么解决方法吗？至于现在，我的表格和标题会随时中断。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:33:11.103

MDN 表示 Firefox 19 是支持该`page-break-inside`属性的最早版本。看来你运气不好。

[https://developer.mozilla.org/en-US/docs/CSS/page-break-inside](https://developer.mozilla.org/en-US/docs/CSS/page-break-inside)

也许你可以从这个问题中找到一些有用的东西： [alternative to page-break-inside:avoid because of compatibility issues](https://stackoverflow.com/questions/1246636/alternative-to-page-break-insideavoid-because-of-compatibility-issues)

# ios - 该应用程序在 id 中引用了非公共选择器（Facebook SDK iOS）

> ID：14448056
> 
> 赞同：43
> 
> 时间：2013-01-21T22:02:33.543
> 
> 标签：ios, facebook, facebook-ios-sdk, application-loader

使用 Application Loader 提交我的应用程序时出现此警告。

```
The app references non-public selector in MyApp : id 
```

此警告可能会拒绝我的应用程序通过 Apple AppStore 的验证。

我的应用正在使用 Facebook SDK iOS 3.1.1（也尝试使用 3.1）

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-01-21T22:02:33.543

发生此问题的原因是 Facebook SDK for iOS。

应用程序加载器禁止使用任何 FBGraphUser 相关类中的变量“id”（可能还有其他变量，未测试） - 例如：

```
id<FBGraphUser> friend
id<FBGraphUserExtraFields>user 
```

Facebook 于 2013 年 1 月获悉此问题：[错误报告](https://developers.facebook.com/bugs/143882255765923/)

目前的解决方法是使用这些：

```
[user objectForKey:@"id"]
[friend objectForKey:@"id"] 
```

而不是`user.id`和`friend.id`不同的 Facebook 示例中所示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-26T21:17:30.680

对于任何新来这里寻找答案的人。根据 Facebook SDK 更改日志，该问题似乎已在 v3.14.1 中得到修复

[https://developers.facebook.com/docs/ios/change-log-3.x/](https://developers.facebook.com/docs/ios/change-log-3.x/)

*   `FBGraphObject`类型、`FBGraphPlace`、 `FBOpenGraphAction`和的 id 属性`FBOpenGraphObject`已被弃用，`objectID`以避免应用商店提交警告。

*   `FBLinkShareParams`和的 description 属性`FBOpenGraphObject`
    已被分别弃用，取而代之的是 linkDescription 和
    `objectDescription`，以避免应用商店提交
    警告。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-16T13:22:35.317

只是为了更新来自搜索引擎的人，这已在最新的 Facebook SDK 中修复（刚刚将我们的项目移动到库版本 3.7.1 并且验证警告消失了）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-14T05:41:01.893

Facebook iOS SDK 3.12 在 FBGraphUser.h 中存在同样的问题。

改变

```
@property (retain, nonatomic) NSString *id; 
```

至

```
@property (retain, nonatomic) NSString *UserId; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-30T17:04:02.090

文件**FBGraphUser.h**

改变

> @property (retain, nonatomic) NSString *id;

经过

> @property (retain, nonatomic) NSString *FbUserId;

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-11T14:22:31.353

使用 Facebook iOS SDK 3.13。不会有任何验证警告。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-30T14:39:09.963

[我通过从 Github（链接](https://github.com/facebook/facebook-ios-sdk)）下载 FacebookSDK 源并在脚本目录中使用“build_framework.sh”脚本解决了这个问题（13.1 仍然会生成警告并在 itunesconnect 中生成无效的二进制文件） 。然后将生成的框架添加到我的 Xcode 项目中 - 并且不再收到警告。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-06T08:14:32.987

验证警告也出现在 v3.13 中。我不知道这是否适用于其他人，但他是一个快速的解决方法，可以消除错误。在第 41 行附近的 FBGraphUser.h 中，我更改了...

`@property (retain, nonatomic) NSString *id;`

至

```
@property (retain, nonatomic) NSString *FBUserID; 
```

我也收到了关于 setProfileId 的相同验证警告，所以我去了 FBProfilePictureView.h 并将第 54 行和第 76 行的 profileID 更改为 FBID。

然后我在游戏的 ViewController 中更新了我的 FBLoginView 信息以反映这些更改。与 FB 相关的所有内容似乎仍然可以在我的应用程序中运行，并且它通过了 Application Loader 验证。

# symfony - 一对多关系不起作用

> ID：14448075
> 
> 赞同：3
> 
> 时间：2013-01-21T22:04:05.273
> 
> 标签：symfony, doctrine-orm

在我的博客和 blog_link_tag 连接表之间创建简单的一对多关系时，我似乎遇到了问题。我快到了，但是我不断收到来自 Doctrine 的以下映射错误，我想知道是否有人能指出我哪里出错了？

`The association Acme\BlogBundle\Entity\Blog#tags refers to the owning side field Acme\BlogBundle\Entity\BlogLinkTag#blog_id which does not exist.`

下面是我使用的表结构，其中删除了不必要的字段。

```
CREATE TABLE `blog` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `blog_link_tag` (
  `id` int(3) NOT NULL AUTO_INCREMENT,
  `blog_id` int(3) NOT NULL,
  `tag_id` int(3) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

博客.php

```
<?php

namespace Acme\BlogBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use Doctrine\Common\Collections\ArrayCollection;
use Symfony\Component\Validator\Constraints as Assert;

/**
 * Blog
 *
 * @ORM\Table(name="blog")
 * @ORM\Entity(repositoryClass="Acme\BlogBundle\Entity\BlogRepository")
 * @ORM\HasLifecycleCallbacks
 */

class Blog {

    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer", nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @ORM\OneToMany(targetEntity="BlogLinkTag", mappedBy="blog_id")
     */
    protected $tags;

    public function __construct() {
        $this->tags = new ArrayCollection();
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId() {
        return $this->id;
    }

    /**
     * Add tags
     *
     * @param \Acme\BlogBundle\Entity\BlogLinkTag $tags
     * @return Blog
     */
    public function addTag(\Acme\BlogBundle\Entity\BlogLinkTag $tags) {
        $this->tags[] = $tags;

        return $this;
    }

    /**
     * Remove tags
     *
     * @param \Acme\BlogBundle\Entity\BlogLinkTag $tags
     */
    public function removeTag(\Acme\BlogBundle\Entity\BlogLinkTag $tags) {
        $this->tags->removeElement($tags);
    }

    /**
     * Get tags
     *
     * @return \Doctrine\Common\Collections\Collection 
     */
    public function getTags() {
        return $this->tags;
    }

    /**
     * Set tags
     *
     * @param integer $tags
     * @return Blog
     */
    public function setTags($tags) {
        $this->tags = $tags;
        return $this;
    }
} 
```

博客链接标签.php

```
<?php

namespace Acme\BlogBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * BlogLinkTag
 *
 * @ORM\Table(name="blog_link_tag")
 * @ORM\Entity
*/
class BlogLinkTag
{
    /**
     * @var integer
     *
     * @ORM\Column(name="id", type="integer", nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var integer
     * @ORM\Column(name="blog_id", type="integer", nullable=false)
     * @ORM\ManyToOne(targetEntity="Blog", inversedBy="blog")
     * @ORM\JoinColumn(name="blog_id", referencedColumnName="blog_id")
     */
    private $blogId;

    /**
     * @var integer
     *
     * @ORM\Column(name="tag_id", type="integer", nullable=false)
     */
    private $tagId;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId() {
        return $this->id;
    }

    /**
     * Set blogId
     *
     * @param integer $blogId
     * @return BlogLinkTag
     */
    public function setBlogId($blogId) {
        $this->blogId = $blogId;

        return $this;
    }

    /**
     * Get blogId
     *
     * @return integer 
     */
    public function getBlogId() {
        return $this->blogId;
    }

    /**
     * Set tagId
     *
     * @param integer $tagId
     * @return BlogLinkTag
     */
    public function setTagId($tagId) {
        $this->tagId = $tagId;
        return $this;
    }

    /**
     * Get tagId
     *
     * @return integer 
     */
    public function getTagId() {
        return $this->tagId;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T23:10:23.087

[在此处查看](http://docs.doctrine-project.org/en/2.0.x/reference/association-mapping.html)有关关联映射的官方文档。

试试这个 ：

在 BlogLinkTag

```
 /**
     * @var integer
     * @ORM\ManyToOne(targetEntity="Blog", inversedBy="tags") //put the name of the variable in the other entity here
     * @ORM\JoinColumn(name="blog_id", referencedColumnName="id") //reference of the column targetted here
     */
    private $blog; 
```

在博客中：

```
 /**
     * @ORM\OneToMany(targetEntity="BlogLinkTag", mappedBy="blog") //put the name of the variable in the other entity here
     */
    protected $tags; 
```

# java - 使用 Android 发布到 URL？

> ID：14448077
> 
> 赞同：0
> 
> 时间：2013-01-21T22:04:13.070
> 
> 标签：java, android

好的，已经卡在这个上很长一段时间了。不是 Java 专家，但一直在尝试创建一个应用程序来简单地将信息发布到 URL。不知道我的代码哪里出错了？请你看看和建议？抱歉上传大量代码真的不知道如何解释它，因为我不知道我哪里出错了。控制台没有错误，模拟器只是无法完全加载应用程序？

```
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

public class test {

public void postData() {
    // Create a new HttpClient and Post Header
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://www.yoursite.com/script.php");

    try {
        // Add your data
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        nameValuePairs.add(new BasicNameValuePair("id", "name"));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        httpclient.execute(httppost);

    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
    } catch (IOException e) {
        // TODO Auto-generated catch block
    }
}

  }

   <uses-permission android:name="android.permission.INTERNET"></uses-permission>

    <EditText
    android:id="@+id/name"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="72dp"
    android:layout_marginTop="36dp"
    android:ems="10"
    android:inputType="text"
    android:text="@string/Enter_name" >

       <Button
    android:id="@+id/Submit_Transaction"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/textView1"
    android:layout_marginTop="40dp"
    android:layout_toRightOf="@+id/textView1"
    android:onClick="postData()"
    android:text="@string/Submit_Tran_Button" />

    <activity
        android:name="com.testing.myappname.PostData"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity> 
```

LogCat 以 FATAL EXCEPTION MAIN 错误开始，然后...

01-21 21:52:44.459: E/AndroidRuntime(1155): java.lang.RuntimeException: 无法实例化活动 ComponentInfo{com.test.testing/com.testing.testing.PostData}: java.lang.ClassNotFoundException: 没有在路径上找不到类“com.testing.testingvt.PostData”：/data/app/com.testing.testingvt-1.apk

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:45:42.403

好的。这里的问题是你应该有一个有效的 Activity 类来显示你的 UI。只需阅读[此链接](http://developer.android.com/reference/android/app/Activity.html)上的活动。

# linux - Openvpn密码认证

> ID：14448079
> 
> 赞同：4
> 
> 时间：2013-01-21T22:04:38.447
> 
> 标签：linux, windows, bash, sh, openvpn

我正在尝试将 openvpn windows 客户端连接到在 ubuntu 上运行的 openvpn 服务器。使用“仅证书”身份验证时，VPN 工作正常，. 但是当尝试使用下面的脚本进行身份验证时，我在客户端上遇到以下错误：

```
Mon Jan 21 14:59:07 2013 SENT CONTROL [server]: 'PUSH_REQUEST' (status=1)
Mon Jan 21 14:59:07 2013 AUTH: Received AUTH_FAILED control message
Mon Jan 21 14:59:07 2013 TCP/UDP: Closing socket
Mon Jan 21 14:59:07 2013 SIGTERM[soft,auth-failure] received, process exiting 
```

vpn_user.sh 是一个可执行文件，可由 server.conf 文件访问。

任何帮助表示赞赏。

* * *

这是身份验证脚本：

```
#!/bin/sh
#vpn_user.sh

ALLOWED_USER="user1"

ALLOWED_PASS="password1"
echo "$username"
echo "$password"

if ["$username"=="$ALLOWED_USER"] && ["$password"=="$ALLOWED_PASS"]
    then exit 0
fi

exit 1 
```

* * *

服务器配置：

```
#server.conf
port 1194
proto udp
dev tap0

client-cert-not-required
auth-user-pass-verify vpn_user.sh via-env
script-security 3
username-as-common-name
tmp-dir /dev/shm

ca ca.crt
cert server.crt
key server.key  # This file should be kept secret
dh dh1024.pem
ifconfig-pool-persist ipp.txt
server-bridge 10.8.0.4 255.255.255.0 10.8.0.50 10.8.0.100
client-to-client
duplicate-cn
keepalive 10 120
comp-lzo
persist-key
persist-tun
status openvpn-status.log
log         openvpn.log
verb 3 
```

* * *

客户端配置

```
client
dev tap
proto udp
remote 10.xx.xx.xx 1194
auth-user-pass
resolv-retry infinite
persist-key
persist-tun
ca ca.crt
dh dh1024.pem
comp-lzo
verb 3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-10-27T18:56:52.947

**1.您输入的脚本行中缺少空格`if`，应该是：**

`if [ "$username" == "$ALLOWED_USER" ] && [ "$password" == "$ALLOWED_PASS" ]`

执行脚本时会出现什么？以下是我的测试示例：

```
# username=user1 password=password1 ./vpn_user.sh && echo "authentication OK" || echo "Authentication failed"
user1
password1
authentication OK

# username=user1 password=wrong-pass ./vpn_user.sh && echo "authentication OK" || echo "Authentication failed"**
user1
wrong-pass
Authentication failed 
```

**2\. 同时检查您的`server.conf`. 您可能需要将完整路径放入脚本**

这是重要的部分：

```
auth-user-pass-verify /full/path/to/vpn_user.sh via-env
script-security 3 
```

**3\. Chroot-ed 执行可能会造成困难。**

如果您在 chroot 下运行 openvpn - 那么您的脚本需要在 chroot-ed 进程下可见，脚本的 shell 以及任何需要的库都需要可用。在这种情况下，您需要 chroot 并在 chroot 下测试脚本的执行。

这可能很棘手，对我来说，一个快速的解决方案是编写自己的小程序并编译（作为静态 - 不需要外部库）。

确切的指令、源代码、编译指令等 - 仍应在以下位置提供：

[http://openbsdsupport.org/openvpn-on-openbsd.html](http://openbsdsupport.org/openvpn-on-openbsd.html)

甚至更好 - 尝试直接转到相关部分：

[http://openbsdsupport.org/openvpn-on-openbsd.html#AuthenticationVariant1simple](http://openbsdsupport.org/openvpn-on-openbsd.html#AuthenticationVariant1simple)

**4\. Openvpn 客户端也需要配置为使用密码认证。**

验证客户端配置中的选项`client-config.ovpn`

```
password auth-user-pass 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-10-29T06:54:13.930

**root@myserver:/var/www# cat /tmp/quickAuth.sh**

```
#!/bin/bash
#vpn_user.sh

ALLOWED_USER="user"
ALLOWED_PASS="password"

echo "$username"
echo "$password"
echo $ALLOWED_USER
echo $ALLOWED_PASS

if [[ "$username" == "$ALLOWED_USER"  && "$password"="$ALLOWED_PASS" ]]
then
 exit 0
else
  exit 1
fi 
```

*客户端配置*

```
client
dev tun
proto udp
remote remote ip server 1194(server port)
resolv-retry infinite
nobind
user nobody
group nogroup
persist-key
persist-tun
mute-replay-warnings
ca ca.crt
cert client.crt
key client.key
ns-cert-type server
auth-user-pass
comp-lzo
route xxx.xxx.xxx.xxx  255.255.255.255 the ip that i want to route throw the openvpn(if default was not made)
verb 3 
```

prb 带有 sh 脚本

# python - 对字典使用“打印”时格式化控制台输出

> ID：14448087
> 
> 赞同：0
> 
> 时间：2013-01-21T22:05:11.333
> 
> 标签：python

我正在尝试上 Python 课程，但发现讲师将其留给谷歌来教我们。我必须读取两个文本文件，解析它们，并将数据存储在字典中，以便将其用于比较和打印两个文本文件的结果。既然您知道我为什么要尝试做某事，那么我要做的就是打印一个数据列表，使其看起来对人眼可读。目前在打印时，我收到如下列表：

`{0: ('Arthur', '3', '1'), 1: ('Lancelot', '0', '0'), 2: ('Robin', '0', '2'), 3: ('Arthur', '0', '3'), 4: ('Lancelot', '2', '0'), 5: ('Robin', '1', '2'),`……

我希望它在控制台中像这样显示为每行映射数据的一个键值，像这样

```
 {0: ('Arthur', '3', '1')
   1: ('Lancelot', '0', '0')
   2: ('Robin', '0', '2')
   3: ('Arthur', '0', '3')
   4: ('Lancelot', '2', '0')
   5: ('Robin', '1', '2')
  ....} 
```

显然，我不知道要在谷歌中找到正确的问题。我确信这很简单，例如格式化标志。这实际上不是作业的一部分，但我想学习如何做到这一点，因为稍后我将不得不为该程序的其他部分格式化输出。这是我作为输入读取的文本文件：

```
Arthur;3;1
Lancelot;0;0
Robin;0;2
Arthur;0;3
Lancelot;2;0
Robin;1;2
Robin;2;1
Lancelot;1;1
Galahad;0;1
a random person;0;3
Arthur;1;1
Galahad;1;1
Galahad;3;0 
```

注意：我不必制作防弹代码，所以我没有。我不必考虑不良数据或任何类型的异常。我只需要让它处理这种类型的文本文件。

这是我的代码：

```
# readfile(string)
# Purpose: open a text file and iterate though the file, one line at a time.
# Input: string
# Returns: dictionary
def readResponses(filename):
    mapIndex = 0 # used to append to dictionary rows.
    for line in open(filename): # used to iterate through each txt file line.
        if mapIndex < 1:# assign key and tuple data.
            record = {mapIndex: parseForColon(line)} 
            mapIndex += 1
        elif mapIndex > 0: # append key and tuple data
            record.update({mapIndex: parseForColon(line)})
            mapIndex += 1   
    return record

#def readQuestions():

# parseForColon(string)
# Purpose: Parse string data to assign appropriate data to three variables. Slices an input string one char
# qt-a-time until a delimiter is found. Delimiters are disregarded and a tuple is packed into a single variable.
# Input: String - The next line of text
# Returns: a packed tuple
# Called by readResponses(string)
def parseForColon(line): # This function iterates, releases memory, and is called anew from parent function.
        string1, name, = line, "" # needed to receive text file line and slices of that string.
        length = len (line)
        count = 0
        while count < length: # slice the string one char at a time until a delimiter is found.
                if string1[count] == ';':
                        count += 1 # increment past the delimeter and assign next parameter.
                        question = string1[count]
                        count += 2 # increment past the next delimeter and assign last parameter.
                        answer = string1[count]
                        count += 1 #exceed length and break loop.
                        break
                elif string1[count] != ';': # while delimeter not encountered, append first parameter one char at-a-time.
                        name += string1[count]
                        count += 1
        data = name, question, answer
        return data #return tuple.

#parse answers text file and save data to a dictionary. 
answerMap = readResponses("responses.txt")
print answerMap 
```

任何帮助，将不胜感激。我似乎从谷歌或其他人那里学到的东西比我在课堂上学到的更多，令人沮丧。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:07:52.970

它看起来很像`pprint`格式化：

```
In [14]: x={0: ('Arthur', '3', '1'), 1: ('Lancelot', '0', '0'), 2: ('Robin', '0', '2'), 3: ('Arthur', '0', '3'), 4: ('Lancelot', '2', '0'), 5: ('Robin', '1', '2')}

In [15]: import pprint

In [16]: pprint.pprint(x)
{0: ('Arthur', '3', '1'),
 1: ('Lancelot', '0', '0'),
 2: ('Robin', '0', '2'),
 3: ('Arthur', '0', '3'),
 4: ('Lancelot', '2', '0'),
 5: ('Robin', '1', '2')} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:46:31.140

帕维尔关于印刷的说法是正确的。不过，您的解析对我来说似乎*过于*复杂，所以我将投入 2 美分：

```
>>> from pprint import pprint
>>> s = """Arthur;3;1
... Lancelot;0;0
... Robin;0;2
... Arthur;0;3
... Lancelot;2;0
... Robin;1;2
... Robin;2;1
... Lancelot;1;1
... Galahad;0;1
... a random person;0;3
... Arthur;1;1
... Galahad;1;1
... Galahad;3;0"""
>>> pprint(dict([(n, tuple(l.split(';'))) for n, l in enumerate(s.split('\n'))])) 
```

你的整个程序都在一行中（显然你必须根据你的输入来定制它，我假设它是一个字符串）。

基本上，我们要做的是创建一个以调用索引为键的字典（在迭代列表时`enumerate`产生 ( )。每行的值是 a ，这是每行拆分的值由.`index, value``tuple``;`

当然，一开始可能看起来有点令人生畏，但是一旦你真正了解了如何使用 Python 的 stdlib，阅读这样的表达式几乎成为第二天性。

# iphone - 添加阴影而不调用 CGContextFillPath(context);

> ID：14448096
> 
> 赞同：0
> 
> 时间：2013-01-21T22:06:09.117
> 
> 标签：iphone, ios, objective-c, ipad

我有以下代码：

```
CGContextSetShadowWithColor(context, CGSizeMake(0, 1.5), 
                       2.0, [UIColor blackColor].CGColor); 
```

并根据我的理解应用阴影，我必须调用 CGContextFillPath。有没有其他方法可以在不调用填充路径的情况下做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:08:50.240

不可以。您必须在图形上下文中使用描边或路径方法绘制一些东西来生成阴影。这是来自 Apple 的文档。

> 阴影如何工作
> 
> Quartz 中的阴影是图形状态的一部分。您调用函数 CGContextSetShadow，传递图形上下文、偏移值和模糊值。设置阴影后，您绘制的任何对象都有一个用黑色绘制的阴影，该阴影在设备 RGB 颜色空间中具有 1/3 的 alpha 值。换句话说，阴影是使用设置为 {0, 0, 0, 1.0/3.0} 的 RGBA 值绘制的。
> 
> 您可以通过调用函数 CGContextSetShadowWithColor、传递图形上下文、偏移值、模糊值和 CGColor 对象来绘制彩色阴影。为颜色提供的值取决于您要绘制的颜色空间。
> 
> 如果在调用 CGContextSetShadow 或 CGContextSetShadowWithColor 之前保存了图形状态，则可以通过恢复图形状态来关闭阴影。您还可以通过将阴影颜色设置为 NULL 来禁用阴影。

# java - 选择item后JComboBox自定义显示

> ID：14448099
> 
> 赞同：1
> 
> 时间：2013-01-21T22:06:23.060
> 
> 标签：java, swing, jcombobox

这可能是一个重复 - 虽然我找不到它 - 我基本上只是尝试通过提供我自己的 ListCellRenderer 来自定义 JComboBox 显示：

```
targetCombo = new JComboBox();
targetCombo .setRenderer(new BasicComboBoxRenderer(){
    public Component getListCellRendererComponent(JList list, Object value, int index,              boolean isSelected, boolean cellHasFocus){
        super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
        if (value != null){
            MyObj myObj = (myObj)value;
            setText(myObj.getName());
        }
        return this;
    }
}); 
```

当我展开 JComboBox 列表时，组件会正确显示名称。但是，在选择项目时，显示将恢复为 myObj 的 toString() 值。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:16:16.093

替换使用`BasicComboBoxRenderer`with`DefaultListCellRenderer`

```
public class TestComboBox04 {

  public static void main(String[] args) {
    new TestComboBox04();
  }

  public TestComboBox04() {
    EventQueue.invokeLater(new Runnable() {
      @Override
      public void run() {
        try {
          UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        } catch (Exception ex) {
        }

        JComboBox targetCombo = new JComboBox();
        targetCombo.setRenderer(new DefaultListCellRenderer() {
          public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
            super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
            if (value != null) {
              MyObj myObj = (MyObj) value;
              setText(myObj.getName());
            }
            return this;
          }
        });
        targetCombo.addItem(new MyObj("A"));
        targetCombo.addItem(new MyObj("B"));
        targetCombo.addItem(new MyObj("C"));
        targetCombo.addItem(new MyObj("D"));

        JFrame frame = new JFrame("Test");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLayout(new GridBagLayout());
        frame.add(targetCombo);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);

      }
    });
  }

  public class MyObj {

    private String name;

    public MyObj(String name) {
      this.name = name;
    }

    public String getName() {
      return name;
    }

  }

} 
```

您永远不需要使用外观包中的组件，除非您计划创建自己的外观。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T04:20:21.687

> ...显示恢复为 myObj 的 toString() 值。

除非您需要 toString() 特定的东西，否则覆盖它以返回“名称”，

那么你不需要渲染器 - 组合框将显示 toString() 值

# javascript - 在 JavaScript 中从一个基础转换为另一个基础

> ID：14448104
> 
> 赞同：3
> 
> 时间：2013-01-21T22:06:42.440
> 
> 标签：javascript, base

在 JavaScript 中，是否有任何内置函数可以将整数从一个给定的基数转换为另一个给定的基数？我注意到已经可以使用 将十进制数转换为另一个基数，但我还没有找到可以从*任何*基数转换为任何其他基数`toString(numberToConvertTo)`的通用函数，如下所示：

 *```
convertFrom(toConvert, baseToConvertFrom, baseToConvertTo){
    //convert the number from baseToConvertFrom to BaseToConvertTo
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-21T22:08:13.253

调用`parseInt(str, fromBase)`以转换为基数 10（或者更确切地说，转换为实际数字），然后调用`num.toString(toBase)`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-28T10:23:05.447

您可能想要自定义输入或输出。您可能需要超过 36 个碱基。所以我做了这个

```
function baseCon(number,fromBase,toBase,fromChars,toChars) {
  if (!fromChars) {
    fromChars = ['0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];
    number = number.toString().toUpperCase();
  }
  if (!toChars) {
    toChars = ['0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];
  }
  if (typeof number != 'object') {
    number = number.toString();
  }
  if (fromBase > fromChars.length) {
    console.log('fromBase was too high');
  } else if (toBase > toChars.length) {
    console.log('toBase was too high');
  } else {
    if (fromBase == 10) {
      var base10Num = Math.min(number);
    } else {
      var base10Num = 0;
      var place = 0;
      for (var index = number.length - 1; index > -1; index--) {
        base10Num = base10Num + (fromChars.indexOf(number[index]) * Math.pow(fromBase,place));
        place++;
      }
    }
    var string = '';
    var looping = true;
    var stringLen = 0;
    var stringVal = 0;
    while (looping) {
      stringLen++;
      if (Math.pow(toBase,stringLen) == base10Num) {
        stringLen++;
        break;
      } else if (Math.pow(toBase,stringLen) >= base10Num) {
        break;
      }
    }
    for (var placePos = stringLen; placePos > 0; placePos--) {
      for (var placeVal = 0; placeVal < (toBase + 1); placeVal++) {
        if (((placeVal * Math.pow(toBase,placePos - 1)) > (base10Num - stringVal)) || (placeVal == 0) && ((base10Num - stringVal) == 0)) {
          if (!((placeVal == 0) && ((base10Num - stringVal) == 0))) {
            stringVal = stringVal + ((placeVal - 1) * Math.pow(toBase,placePos - 1));
            string = string + toChars[placeVal - 1];
          } else {
            string = string + toChars[0];
          }
          break;
        }
      }
    }
    if (stringVal == base10Num) {
      return string;
    } else {
      console.log('baseCon failed');
      return string;
    }
  }
}; 
```

您可以自定义输入字符，以便您可以执行以下操作

```
> baseCon([true,true,false,true,false],2,10,[false,true]);
< "26" 
```

和粗略的输出字符

```
> baseCon('3942',10,8,false,['!','@','#','$','%','^','&','*']);
< "*^%&" 
```

我花了一整天才想起来`parseInt(number,fromBase).toString(toBase);`哈哈*

# ember.js - 从视图中访问控制器的属性

> ID：14448105
> 
> 赞同：9
> 
> 时间：2013-01-21T22:06:42.643
> 
> 标签：ember.js

我想做一个进度条之类的东西，它将由 ember 控制。所以在我看来，有两种方法可以实现这一点：

1.  **在控制器**中有一个观察者，它`width`在触发时设置元素。问题：AFAIK，无法从控制器内访问 DOM 元素，即就像您在视图中那样做`this.$('#progress')`。

2.  **在视图**中有一个观察者，它观察控制器的属性。问题：我不知道如何观察（和访问）控制器的属性。

3.  *（将控制器的属性通过绑定`{{bindAttr}}`到一个怪异的属性，并在属性的值发生变化时`data-progress="42"`调整元素）`width`*

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-21T23:11:47.900

选项 2 是您最好的选择。

> 问题：我不知道如何观察（和访问）控制器的属性。

Ember 将在创建视图时设置视图的控制器属性，您可以使用它来访问控制器的属性。

```
App = Ember.Application.create();

App.ApplicationController = Ember.Controller.extend({
  percentComplete: '0'
});

App.ProgressView = Ember.View.extend({
  percentChanged: function() {
    percentString = (this.get('controller.percentComplete') + "%");
    this.$('.bar').css('width', percentString);
  }.observes('controller.percentComplete').on('didInsertElement')
}); 
```

我在这里发布了一个工作示例：http: [//jsbin.com/hitacomu/1/edit](http://jsbin.com/hitacomu/1/edit)

# objective-c - 用于到达当前 View Controller 的 segue 标识符的名称？

> ID：14448107
> 
> 赞同：1
> 
> 时间：2013-01-21T22:06:49.023
> 
> 标签：objective-c, xcode, uiviewcontroller, storyboard, segue

我试图弄清楚如何获取用于到达当前视图控制器的 segue 标识符的名称。例如，假设我有 viewcontroller 的 A、B 和 C。A 和 B 都有一个与 C 相连的按钮。当 C viewcontoller 加载时，我如何知道我之前从哪个视图控制器开始运行？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:12:20.707

向视图控制器添加`sourceSegueId`类型属性，并在源视图控制器`NSString*`的每个方法中设置它：`prepareForSegue`

在您的目标控制器中：

```
@property (nonatomic, readwrite) NSString *sourceSegueId; 
```

在每种`prepareForSegue`方法中：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {
    [segue.destinationViewController setSourceSegueId:segue.identifier];
} 
```

使用此代码，您可以检查`sourceSegueId`目标视图控制器内的属性，以了解控制器从哪个 segue 打开。

# c# - UI 表单事件阻止了我的其他 STOCK TICKER API 事件 - 我该如何防止这种情况发生？

> ID：14448109
> 
> 赞同：0
> 
> 时间：2013-01-21T22:07:00.763
> 
> 标签：c#, events

我有一个通过事件机制收集股票报价的 API (dll)。比如下图：

```
...
using MT4API;

public partial class Blue : Form
{
...
public Blue()   
        {
...
            string symbol = "GBPUSD";
            MT4DDE dde = new MT4DDE("");
            dde.OnQuote += new System.EventHandler<QuoteEventArgs>(MT_OnQuote);
            dde.Connect();
            dde.Subscribe(symbol);
.... 
```

这个想法是在每个图表刻度上我都会得到一个事件。这是事件处理程序代码：

```
 private static void MT_OnQuote(object sender, QuoteEventArgs args)
    {
        GlobalClass.Ask = args.Ask;
        GlobalClass.Bid = args.Bid;
        // I have back ground worker code that updatestables from the global class
    } 
```

这一切都很好。只要我不触摸表单 UI 上的任何其他按钮。一旦我单击 UI 表单上的按钮...我不再从我的 API 接收事件，UI 应用程序正常运行，但没有来自 API 的数据。

为什么来自 UI 的事件会阻止来自 API 事件的任何进一步事件？

知道这里发生了什么吗？或者建议如何设计这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:55:00.560

如果您注释掉从全局对象更新表的代码，是否会出现同样的问题？如果您注释掉后台工作人员？

最好区分事件是在您按下 UI 上的某个按钮后立即停止触发，还是仅在*您*编写的某行代码被执行后才停止触发。

为了能够帮助您，我们需要知道 MT4DDE 类上的事件是如何触发的。

如果您有此类的代码，发布它会有所帮助。

如果您不这样做，您可能希望使用 Reflector 等工具将程序集反编译为 C#，并查看 MT4DDE 类正在做什么，这可能会导致它停止调用事件。

此外，如果您正在做任何与后台线程相关的事情，或者如果您正在对应用程序的主消息循环做任何不寻常的事情，那么在这里提及它是一个好主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T18:47:04.190

我尝试使用调用命令，它可以工作，但是在发生一些事件后它停止了......这是隔离的代码：

使用 MT4API；

namespace WindowsFormsApplication1 { public delegate void UpdateTextCallback(double ask, double bid);

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        string symbol = "GBPUSD";
        MT4DDE dde = new MT4DDE("");
        dde.OnQuote += new EventHandler<QuoteEventArgs>(MT_OnQuote);
        dde.Connect();
        dde.Subscribe(symbol);

    }

    private void updateTickDisplay(double ask, double bid)
    {
        textBox1.Text = ask.ToString();
        textBox2.Text = bid.ToString();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        this.Close();
    }

    private void MT_OnQuote(object sender, QuoteEventArgs args)
    {
        BeginInvoke(new UpdateTextCallback(this.updateTickDisplay),
        new object[] { args.Ask, args.Bid });
    }

    private void textBox1_TextChanged(object sender, EventArgs e)
    {
        textBox3.Text = textBox1.Text;
    }

} 
```

}

与真实代码的唯一区别是我使用的是数据网格......而不是文本字段。但很明显，UI 以某种方式阻止了新事件。奇怪的是，我收到了大约 5 到 10 个事件，然后它就停止了。奇怪的。关于不同设计的任何想法？

# jsf-2 - a4j:commandButton 在模板化 jsf 中不起作用

> ID：14448111
> 
> 赞同：0
> 
> 时间：2013-01-21T22:07:12.870
> 
> 标签：jsf-2

我的问题如下，我有一个用于布局我的 Web 应用程序的 template.xhtml

```
<div id="header">
   <ui:insert name="header">
        [Top Bar content will be inserted here]
     </ui:insert>
    </div>

    <div id="main">
        <ui:insert name="main">
            [Nav Bar Left content will be inserted here]
         </ui:insert>
    </div>

    <div id="button">
         <ui:insert name="button">
            [Nav Bar Left content will be inserted here]
         </ui:insert>
    </div> 
```

然后我有一个 addOrder.xhtml

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:a4j="http://richfaces.org/a4j"
xmlns:rich="http://richfaces.org/rich"
template="/WEB-INF/template/popUpInsert.xhtml">

<ui:define name="header">
  <h:outputLabel value="Status" />
  <rich:inplaceInput value="#{ordineController.orderToSave.status}"   />
  <h:outputLabel value="Code" />
  <rich:inplaceInput value="#{ordineController.orderToSave.code}"  />
</ui:define>
<ui:define name="main">
  Here there is a data table that contains lines of the order
</ui:define>
<ui:define name="button">
 <h:form>
 <a4j:commandButton value="Save" action="#{ordineController.addOrder()}" />
 <h:form>
</ui:define> 
```

但是当我尝试保存状态和代码都为空的订单时，我尝试将范围更改为按钮保存（执行 =“@all”）但没有

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T12:36:53.493

您需要将相关的输入组件放在与命令组件相同的形式中。任何与命令组件形式不同的输入组件在提交中都会被忽略。请注意，这是一个 HTML 限制，而不是 JSF 限制。

所以，这应该为你做：

```
<h:form>
    <div id="header">
        <ui:insert name="header">
            [Top Bar content will be inserted here]
        </ui:insert>
    </div>

    <div id="main">
        <ui:insert name="main">
            [Nav Bar Left content will be inserted here]
        </ui:insert>
    </div>

    <div id="button">
        <ui:insert name="button">
            [Nav Bar Left content will be inserted here]
        </ui:insert>
    </div>
</h:form> 
```

和：

```
<ui:define name="header">
    <h:outputLabel value="Status" />
    <rich:inplaceInput value="#{ordineController.orderToSave.status}" />
    <h:outputLabel value="Code" />
    <rich:inplaceInput value="#{ordineController.orderToSave.code}"  />
</ui:define>
<ui:define name="main">
    Here there is a data table that contains lines of the order
</ui:define>
<ui:define name="button">
    <a4j:commandButton value="Save" action="#{ordineController.addOrder()}" />
</ui:define> 
```

请注意不要以这种方式创建“上帝”形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T09:14:49.783

将此添加到您的页面`<h:messages styleClass="message" />`，您将看到来自 JSF 的更多警告，在您的情况下，应该有一个关于缺少表单的警告，因为 JSF 知道哪些元素需要在其中。最后都是 HTML 和 JavaScript，所以如果你想提交，输入需要在表单中。

# php - WHM 启用 PHP PDO 库

> ID：14448113
> 
> 赞同：1
> 
> 时间：2013-01-21T22:07:16.883
> 
> 标签：php, pdo, cpanel, vps, whm

我刚刚将主机从共享主机切换到 vps 主机，并且正在配置我的 WHM 帐户。我希望能够使用 PHP PDO 库。我知道如何访问 apache 更新表单并找到 pdo 部分。唯一的问题是有两个选项，一个 pdo 复选框，显示为

> 包括 SQLite 支持。MySQL 支持可用。如果您计划通过 PECL 安装或更新 >PDO 驱动程序（freetds、oracle 等），您可能希望跳过此选项，因为 PECL 将 >安装它拥有的 PDO 版本。此选项将在构建之前对您的 >profile 进行以下更改：启用：SQLite3

和一个 PDO_MYSQL 框，读取

> 此选项将在构建之前对您的配置文件进行以下更改：启用：PDO

我不知道该选择哪个选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:11:43.983

第二个，第一个是启用SQLite；我猜你想使用 MySQL 吗？

# vb.net - 媒体播放器不会做任何事情

> ID：14448114
> 
> 赞同：1
> 
> 时间：2013-01-21T22:07:17.447
> 
> 标签：vb.net, visual-studio-2010, media-player, vlc

我的代码看起来是正确的，但是当我按下按钮时没有任何反应。我究竟做错了什么？

下面的代码：

```
Public Class Form1
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        AxVLCPlugin21.playlist.add("C:\Users\Adminx\Downloads\The_Hobbit_Full_Length_Trailer_2_HD.mp4")

        AxVLCPlugin21.playlist.play()
    End Sub

End Class 
```

我`toolbox`的`vlc`东西也是用中文写的。是不是看起来像那样（看下图）

![在此处输入图像描述](../Images/5065d22c0e5d0fff0949f81759870661.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:16:45.497

我已经知道我做错了什么

我需要更改：AxVLCPlugin21.playlist.add("C:\Users\Adminx\Downloads\The_Hobbit_Full_Length_Trailer_2_HD.mp4")

为此：AxVLCPlugin21.playlist.add("file:///C:/Users/Adminx/Downloads/The_Hobbit_Full_Length_Trailer_2_HD.mp4")

# python - wxPython - 图形数据

> ID：14448115
> 
> 赞同：0
> 
> 时间：2013-01-21T22:07:35.587
> 
> 标签：python, wxpython, graphing

我在 wxPython 中绘制数据时遇到问题 - 下面的代码有效，但并不完全正确：现在我绘制随机数，它是输入框的倍数，每 100 毫秒完成一次。

我的问题是，整个数字历史都显示为姿势是（比如说）25 个样本的运行窗口。我最初尝试在每个 100 个样本的集合上重新绘制图表，类似于，`if( length(data)%100 ): drawGraph`但这看起来也不正确。

欢迎提出想法和建议。

我的代码：

```
print( "\n- Please Wait -- Importing Matplotlib and Related Modules...\n" )
import random
import matplotlib
import numpy
import wx
import u3
import numpy as np
matplotlib.use('WXAgg')

from matplotlib.backends.backend_wxagg import FigureCanvasWxAgg as FigureCanvas
from matplotlib.backends.backend_wx import NavigationToolbar2Wx
from matplotlib.figure import Figure

class TemperaturePanel( wx.Panel ) :
    def __init__( self, parent, position ) :
        wx.Panel.__init__( self, parent, pos=position, size=(800,320) )
        # initialize matplotlib 
        self.figure = matplotlib.figure.Figure( None, facecolor="white" )
        self.canvas = matplotlib.backends.backend_wxagg.FigureCanvasWxAgg( self, -1, self.figure )
        self.axes = self.figure.add_subplot(111)
        self.axes.grid(True, color="gray")
        self.axes.set_xbound( (0,5) )
        self.axes.set_ybound( (3,80) )
        self.axes.set_xlabel( "Minutes" )
        self.axes.set_ylabel( "Temperature ($^\circ$C)" )
        self.axes = self.figure.add_subplot(111)
        self.axes.grid(True, color="gray")
        self._SetSize()
        self.Bind( wx.EVT_SIZE, self._SetSize )
        self.TemperatureData   = []

    def updateTemperature(self, value):
        self.TemperatureData.append( value )
        length = len(self.TemperatureData)
        x = np.arange( length )
        y = np.array(self.TemperatureData)

        yMin = round(min(y)) - 2
        yMax = round(max(y)) + 2            
        self.axes.plot(x,y, "-k")
        self.axes.set_ybound( (yMin,yMax) )
        self.canvas = FigureCanvas(self, -1, self.figure)

    #-----------------------------------------------------------------------------------
    def _SetSize( self, event=None ):
        pixels = self.GetSize()
        self.SetSize( pixels )
        self.canvas.SetSize( pixels )

        dpi = self.figure.get_dpi()
        self.figure.set_size_inches( float( pixels[0] ) / dpi,float( pixels[1] ) / dpi )
    #------------------------------------------------------------------------------------

class MainWindow(wx.Frame):
    def __init__(self, parent):
        #wx.Frame.__init__(self, *args, **kwargs)
        wx.Frame.__init__(self, parent, title="Graph Issue", size=(1000,600))
        self.panel = wx.Panel(self)
        self.spin = wx.SpinCtrl(self.panel)
        self.button = wx.Button(self.panel, label="Update")
        self.stop   = wx.Button(self.panel, label="Stop")

        self.sizer = wx.BoxSizer()
        self.sizer.Add(self.spin)
        self.sizer.Add(self.button)
        self.sizer.Add(self.stop)

        self.TemperatureGraph = TemperaturePanel( self, position=(20, 50) )
        self.panel.SetSizerAndFit(self.sizer)
        self.Show()

        # Use EVT_CHAR_HOOK on Frame insted of wx.EVT_KEY_UP on SpinCtrl
        # to disable "on Enter go to next widget" functionality
        self.Bind(wx.EVT_CHAR_HOOK, self.OnKey) 
        self.button.Bind(wx.EVT_BUTTON, self.OnUpdate)
        self.stop.Bind(wx.EVT_BUTTON, self.OnStop)

        self.timer = wx.Timer(self)
        self.Bind(wx.EVT_TIMER, self.OnTimer, self.timer)
        self.Bind(wx.EVT_TIMER, self.updateTemperature, self.timer)
        self.timer.Start(100)
        self.value = 0

    def OnKey(self, e):
        if e.GetKeyCode() == wx.WXK_RETURN:   # Is the key ENTER?
            self.value = self.spin.GetValue() # Read SpinCtrl and set internal value
        else:                                 # Else let the event out of the handler
            e.Skip()

    def OnUpdate(self, e):
        self.value = self.spin.GetValue() # Read SpinCtrl and set internal value

    def OnTimer(self, e):
        # Show internal value
        print(self.value)

    def updateTemperature(self, e):
        Temperature       = self.value*random.uniform(-1,1)                # obtain currnt temperature
        self.TemperatureGraph.updateTemperature(Temperature)               # add temperature to graph   

    def OnStop(self, e):
        self.timer.Stop()
        self.Destroy()

app = wx.App(False)
win = MainWindow(None)
app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T06:15:52.143

如果我正确理解了这个问题，您只需要在图表中显示 25 个最后的温度值，而不是所有值的历史记录。如果这是您想要的，那么在`updateTemperature`子例程中只应绘制最后 25 个值：

```
if length < 25:
    x = np.arange(length)
    y = np.array(self.TemperatureData)
else:
    x = np.arange(length-25, length)
    y = np.array(self.TemperatureData)[-25:] 
```

为了使绘图看起来更好，可以像使用 y 轴一样调整 x 轴：

```
xMin = 0 if length < 25 else length-25
xMax = 25 if length < 25 else length
self.axes.set_xbound( (xMin,xMax) ) 
```

如果该图对您来说看起来不错，并且问题是内存泄漏导致图形在约 200 次迭代后冻结，那是由于`FigureCanvas`每次温度更新时都会创建。相反，您可以重新使用现有的`FigureCanvas`，将最后一行更改`updateTemperature`为

```
 self.canvas.draw() 
```

# java - 我可以使用小程序从 SAP 读取采购订单吗？

> ID：14448116
> 
> 赞同：-2
> 
> 时间：2013-01-21T22:07:38.227
> 
> 标签：java, applet, sap

我的大多数客户都是使用 SAP 的工厂，我有一个 webapp (j2ee) 来处理巴西的（相当复杂的）海关程序。今天的工作方式是，我的客户向我发送发票（通常是 PDF 文件或 Excel 电子表格），我的员工（在这些工厂工作并可以访问他们的 SAP 系统）在我们的系统中输入这些信息。这很容易出错，因为它通常涉及输入数量、金额等。

为了避免使用 Excel 电子表格进行所有输入/弄乱，我的想法是在我的 web 应用程序上设置一个按钮，该按钮调用一个小程序从 SAP 读取采购订单（以及所有项目、数量和诸如此类）并发送该数据通过 https 使用 XML 或 JSON 到我们的 webapp。

有没有人做过类似的事情？这是解决这个问题的最佳方法吗？另外，如果我自己不是 SAP 客户，我是否可以合法地获得 Java SAP 连接器？据我从谷歌搜索中可以看出，答案是否定的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T06:31:40.463

简而言之：是的，从技术上讲这是可能的。但是，如果您的问题中缺少更准确的信息表明您的 SAP 知识（无意冒犯 - 我也不了解很多东西！），那么您将不会如果没有经验丰富且很可能昂贵的人员，就无法做到这一点。不仅需要编程知识（这将是主题），而且您还需要了解业务和后端系统中业务流程实施的人（这绝对是题外话）。如果没有这些知识，Java 连接器将毫无帮助，即使您可以合法地获得它，但您不能。

# magento - 将复选框添加到 Magento 结帐？

> ID：14448118
> 
> 赞同：1
> 
> 时间：2013-01-21T22:07:46.953
> 
> 标签：magento

我一直在这里寻找、尝试和失败。我想要的是在 Onepage 结帐的运送页面上添加一个复选框，即标准的 magento 结帐。

我想创建一个复选框，以便客户可以检查它是否希望将他们的产品放置在他们的地址上而无需签名。

我一直在搞乱一些旧的“接受条款”复选框，但没有运气。

我希望有人可能不得不进行同样的定制。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:36:45.953

你可以做的是`checkout/session`通过观察者保存偏好。首先，将复选框添加到 shipping 部分并为其赋予`name=shipping[no_signature]`. 然后，创建一个新模块并挂钩事件`controller_action_postdispatch_checkout_onepage_saveShipping`，然后使用以下代码：

```
public function controller_action_postdispatch_checkout_onepage_saveShipping($observer)
{
    $params = (Mage::app()->getRequest()->getParams()) ? Mage::app()->getRequest()->getParams() : array();
    if (isset($params['shipping']['no_signature']) && $params['shipping']['no_signature']) {
        Mage::getSingleton('checkout/session')->setNoSignature(true);
    } else {
        Mage::getSingleton('checkout/session')->setNoSignature(false);
    }

    return $this;
} 
```

然后，当即将下订单时，挂钩事件`sales_order_place_before`，您可以像这样向订单添加评论：

```
public function sales_order_place_before($observer)
{
    $order = $observer->getOrder();
    if (Mage::getSingleton('checkout/session')->getNoSignature()) {
        $order->setCustomerNote('No signature required.');
    } else {
        $order->setCustomerNote(null);
    }

    return $this;
} 
```

当您转到“销售”>“订单”时，您应该会在订单上看到有关客户是否需要签名的评论。这是假设没有其他模块或自定义代码将任何内容注入到`customer_note`订单对象的字段中。

# android - viewPager 和 loadermanager 回调

> ID：14448120
> 
> 赞同：0
> 
> 时间：2013-01-21T22:07:50.817
> 
> 标签：android, android-viewpager, android-loadermanager

我的应用程序中有一个带有 3 个片段的 viewpager。viewPager 中的中间片段是其中包含列表视图的片段，它为游标加载器实现了 loader.callbacks 接口。

我遇到的问题是，一旦我向左或向右滑动，中间片段就会留在缓存中，并且永远不会调用“onLoadFinished”回调，因此我永远不会从交换游标中获得新数据。

有人有这个问题的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T13:47:13.543

如果您在刷卡之间更改了数据，那么您有两种选择：

1.  如果您使用`CursorLoader`: 用于`ContentResolver`通知数据已更改。在这种情况下，您`Loader`将自动更新。
2.  `restartLoader`在片段内部调用`onResume`或`onStart`

# android - 对 ViewHolder 模式和 convertView 感到困惑

> ID：14448126
> 
> 赞同：3
> 
> 时间：2013-01-21T22:08:22.690
> 
> 标签：android, android-adapter

我是 Android 开发新手并阅读了一些示例代码。我从适配器类（派生自 ArrayAdapter）中的示例代码中复制了一种方法，派生类除了文本视图外还有一个复选框：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {

  View listItem = super.getView(position, convertView, parent);

  CheckedTextView checkMark = null;
  ViewHolder holder = (ViewHolder) listItem.getTag();
  if (holder != null) {
    checkMark = holder.checkMark;
  } else {
    checkMark = (CheckedTextView) listItem.findViewById(android.R.id.text1);
    holder = new ViewHolder(checkMark);
    listItem.setTag(holder);
  }

  checkMark.setChecked(isInCollection(position));
  return listItem;
}

private class ViewHolder {
  protected final CheckedTextView checkMark;

  public ViewHolder(CheckedTextView checkMark) {
     this.checkMark = checkMark;
  }
} 
```

示例代码是通过在 ViewHolder 对象中缓存 View 来优化 getView。

我感到困惑的是，我认为 convertView（如果不是 null）将被重新使用，然后将 View 数据填充到其中并返回。

如果是这种情况，那么如何依赖代码中调用的 setTag / getTag 方法呢？似乎必须检索相同的对象才能使其工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:54:03.320

> 可能在后续调用中从 getTag 返回的视图用于不同的列表项，并返回错误的视图

适配器使用 RecycleBin。此类允许 ListView 仅创建尽可能多的行布局，以适应屏幕，再加上一两个用于滚动和预加载。因此，如果您有一个包含 1000 行的 ListView 和一个仅显示 7 行的屏幕，则 ListView 很可能只有 8 个唯一视图。

现在使用我上面的示例回答您的问题：仅创建了八个行布局和 8 个后续 ViewHolders。当用户滚动时，不会创建*新*的行布局；只有行布局的*内容会改变。*所以`getTag()`总会有一个有效的 ViewHolder 引用适当的 View(s)。

（这有帮助吗？）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-21T22:54:17.397

您走在正确的轨道上，这里有一些信息可能有助于更了解 ListViews 的工作原理：

该方法的简单实现`getView()`有两个目标。首先是膨胀要显示在列表中的视图。第二个是用需要显示的数据填充视图。

正如您所说，ListViews 重新利用了组成列表的视图。这有时被称为视图回收。这样做的原因是可扩展性。考虑一个包含 1000 项数据的 ListView。视图会占用大量空间，膨胀 1000 个视图并将它们全部保存在内存中是不可行的，因为这可能会导致性能下降或可怕的`OutOfMemoryException`. 为了保持 ListView 的轻量级，Android 使用该`getView()`方法将 View 与底层数据结合起来。当用户上下滚动列表时，任何从屏幕上移出的视图都会被放置在视图池中以供重复使用。的`convertView`参数`getView()`来自这个列表。最初，这个池是空的，所以 null 视图被传递给`getView()`. 因此，getView 的第一部分应该检查是否`convertView`之前已经膨胀了。此外，您需要配置`convertView`所有列表项共有的属性。该代码将如下所示：

```
if(convertView == null)
{
    convertView = new TextView(context);
    convertView.setTextSize(28);
    convertView.setTextColor(R.color.black);  
} 
```

实现的第二部分`getView()`查看列表的基础数据源并配置视图的这个特定实例。例如，在我们的测试列表中，我们可能有一个 Array of Strings 来设置视图的文本，并希望将标签设置为该视图的 Data 中的当前位置。我们根据参数知道我们正在处理列表中的哪个项目`position`。接下来是这个配置。

```
String listText = myListStringsArray[position];
((TextView)convertView).setText(listText);
convertView.setTag(position); 
```

这使我们能够最大限度地减少我们花费在膨胀/创建新视图上的时间，这是一项昂贵的操作，同时仍然能够快速配置每个视图以进行显示。将它们放在一起，您的方法将如下所示：

```
@Override
public View getView(int position, View convertView, ViewGroup)
{ 
    if(convertView == null)
    {
        convertView = new TextView(context);
        //For more complex views, you may want to inflate this view from a layout file using a LayoutInflator, but I'm going to keep this example simple.

        //And now, configure your View, for example...
        convertView.setTextSize(28);
        convertView.setTextColor(R.color.black);  
    }

    //Configure the View for the item at 'position'
    String listText = myListStringsArray[position];
    ((TextView)convertView).setText(listText);
    convertView.setTag(position);

    //Finally, we'll return the view to be added to the list.

    return convertView;

} 
```

如您所见，不需要 ViewHolder，因为操作系统会为您处理它！视图本身应被视为临时对象，它们需要保留的任何信息都应使用您的基础数据进行管理。

还有一点需要注意的是，操作系统对放置在池中的视图没有任何作用，它们保持原样，包括它们填充的任何数据或对它们所做的更改。一个良好实现的`getView()`方法将确保底层数据跟踪视图状态的任何变化。例如，如果您将 TextView 的文本颜色更改为红色 onClick，则当该视图被回收时，文本颜色将保持红色。在这种情况下，文本颜色应链接到一些基础数据，并在`if(convertView == null)`每次`getView()`调用时设置在条件之外。（基本上，所有 convertViews 通用的静态设置都发生在基于当前列表项的有条件的动态设置内，之后发生用户输入）希望这会有所帮助！

已编辑 - 使示例更简单并清理了代码，谢谢 Sam！

# ios - iOS：从流中播放 PCM 缓冲区

> ID：14448127
> 
> 赞同：7
> 
> 时间：2013-01-21T22:08:35.670
> 
> 标签：ios, audio, pcm

我正在从包含编码 PCM 缓冲区的套接字接收一系列 UDP 数据包。解码后，我留下了一个 int16 * 音频缓冲区，我想立即播放。

预期的逻辑是这样的：

```
init(){
   initTrack(track, output, channels, sample_rate, ...);
}

onReceiveBufferFromSocket(NSData data){
   //Decode the buffer
   int16 * buf = handle_data(data);

   //Play data
   write_to_track(track, buf, length_of_buf, etc);
} 
```

不过，我不确定与播放缓冲区有关的所有内容。在Android上，我可以通过创建一个AudioTrack对象来实现这一点，通过指定采样率、格式、通道等来设置它......然后只需使用缓冲区调用“write”方法（就像我希望的那样我可以在上面的伪代码中）但在 iOS 上我做不到。

我尝试使用音频文件流服务，但我猜我做错了，因为没有声音出现，而且我觉得这些功能本身实际上并没有进行任何播放。我还尝试了解音频队列服务（我认为它可能接近我想要的），但是我找不到任何简单的代码示例来使用它。

任何帮助将不胜感激，特别是以示例代码的形式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T23:49:33.167

您需要使用某种类型的缓冲区来保存传入的 UDP 数据。 [这](http://atastypixel.com/blog/a-simple-fast-circular-buffer-implementation-for-audio-processing/)是我使用过的一个简单而良好的循环缓冲区。

然后要从缓冲区播放数据，您可以使用 Audio Unit 框架。 [这](http://code.google.com/p/ios-coreaudio-example/downloads/detail?name=Aruts.zip&can=2&q=)是一个很好的示例项目。

注意：第一个链接还向您展示了如何使用 Audio Unit 进行播放。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T16:48:15.940

您也可以使用 audioQueue 服务，确保您进行某种数据包重新排序，如果您使用 ffmpeg 解码流，则可以选择此选项。

否则音频队列很容易设置。

[https://github.com/mooncatventures-group/iFrameExtractor/blob/master/Classes/AudioController.m](https://github.com/mooncatventures-group/iFrameExtractor/blob/master/Classes/AudioController.m)

您也可以使用 AudioUnits，不过要复杂一些。

# java - Java servlet 尝试输出 xlsx 文件，但不断获取八位字节流

> ID：14448139
> 
> 赞同：3
> 
> 时间：2013-01-21T22:09:13.063
> 
> 标签：java, servlets

我正在尝试在 servlet 中创建一个 xlsx 文件并将其发送到用户可以保存或下载文件的浏览器。目前它一直在发送应用程序/八位字节流而不是一个 excel 文件。

我究竟做错了什么？

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        SXSSFWorkbook wb = new SXSSFWorkbook();
        Sheet sheet = wb.createSheet("Results");
        List<List<TableData>> results = (List<List<TableData>>) request.getSession().getAttribute("results");
        String tableName = (String) request.getSession().getAttribute("tableName");
        DateFormat df = new SimpleDateFormat("yyyy-MM-dd");
        Date date = new Date();
        String filename = tableName+"-"+df.format(date)+".xlsx";

        int rowCounter = 0;

        // Create the rows
        for(List<TableData> l : results) {

            int counter = 0;
            Row row = sheet.createRow(rowCounter);

            for(TableData td : l) {

                Cell cell = row.createCell(counter);

                // if we're on the first row, get the column description, else get the data
                if(rowCounter == 0) {
                    cell.setCellValue(td.getColumnDescription());
                } else {
                    cell.setCellValue(td.getData());
                }
                counter++;
            }
            rowCounter++;
        }

        try {
            OutputStream out = response.getOutputStream();
            wb.write(out);
            response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");
            response.setHeader("Expires:", "0"); // eliminates browser caching
            response.setHeader("Content-Disposition", "attachment; filename="+filename);
            out.flush();
            out.close();

        } catch (Exception e) {
            LOG.debug(e.getStackTrace().toString());
        } 
    } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-21T22:12:50.077

在发送正文*之前*设置内容类型和标题。他们被称为*标题*是有充分理由的:-)

# ember.js - Handlebars helper 返回标记

> ID：14448146
> 
> 赞同：10
> 
> 时间：2013-01-21T22:10:05.777
> 
> 标签：ember.js, handlebars.js

我有以下非常简单的车把助手，它返回一个图像 url：

```
Ember.Handlebars.registerHelper 'avatarUrl', (property, options) ->
  if value = Ember.get(this, property)
    if small_url = value.small_url
      return small_url

  '/images/fallback/small_default.png' 
```

我这样使用：

```
<img src="{{avatarUrl avatar}}" title="displayName"> 
```

以上工作，但我想做的是返回整个 img 元素。

车把助手可以做到这一点吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-21T23:33:27.237

来自[精美手册](http://handlebarsjs.com/)（位于底部）：

> 如果您的助手返回您不想转义的 HTML，请确保返回一个新的`Handlebars.SafeString`.

因此，如果您希望您的助手返回一个完全形成的`<img>`元素，然后构建您的 HTML 字符串并将其包装在 a 中`Handlebars.SafeString`：

```
Ember.Handlebars.registerHelper 'avatarImg', (property, options) ->
  # Build your <img> HTML string and leave it in result ...
  new Handlebars.SafeString(result) 
```

然后在您的模板中，您应该能够拥有：

```
blah blah {{avatarImg ...}} blah blah 
```

并`<img>`从你的`{{avatarImg ...}}`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T23:57:15.327

您可以创建一个视图来表示该图像标签，然后从您的自定义助手中调用把手视图助手。例如：

```
App.AvatarView = Ember.View.extend({
  tagName: 'img',
  attributeBindings: ['src']
});

Ember.Handlebars.registerHelper('avatarUrl', function(property, options) {
  var small_url, value;
  value = Ember.get(this, 'avatarUrl');
  if (value) {
    small_url = value.small_url;
  }
  var hash = options.hash;
  hash.src = small_url || '/images/fallback/small_default.png';

  Ember.Handlebars.helpers.view.call(this, App.AvatarView, options);

}); 
```

我在这里发布了一个工作示例：http: [//jsbin.com/adewot/1/edit](http://jsbin.com/adewot/1/edit)

这是基于 ember 自己的 linkTo 助手的工作方式。要查看更高级的示例，请查看此处的源代码：[https ://github.com/emberjs/ember.js/blob/master/packages/ember-routing/lib/helpers/link_to.js#L83](https://github.com/emberjs/ember.js/blob/master/packages/ember-routing/lib/helpers/link_to.js#L83)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-27T05:14:00.717

`import { htmlSafe } from '@ember/string';`对于 Ember 3 [https://guides.emberjs.com/v3.0.0/templates/writing-helpers/#toc_escaping-html-content](https://guides.emberjs.com/v3.0.0/templates/writing-helpers/#toc_escaping-html-content)

`safeString`在 2.8.0 中已弃用并在 3.0.0 中删除 [https://emberjs.com/deprecations/v2.x/#toc_use-ember-string-htmlsafe-over-ember-handlebars-safestring](https://emberjs.com/deprecations/v2.x/#toc_use-ember-string-htmlsafe-over-ember-handlebars-safestring)

# javascript - 基于文本框的 Javascript URL 重定向

> ID：14448147
> 
> 赞同：1
> 
> 时间：2013-01-21T22:10:07.633
> 
> 标签：javascript, javascript-events

所以，我需要根据输入的代码创建一个重定向系统。目前我有：

```
<form id="form1" name="form1" method="post" action=""> 
  <pre>     <input type="text" name="meow" id="meow" /> <input type="submit" name="submit" id="submit" value="Submit" onclick="javascript:window.location.href('http://foo.exaple.com/bar/' + document.getElementById("meow").value + '.zip')"/> 
```

基本上，我需要上面的脚本根据在文本框中输入的代码在 foo.example.com/bar/ 中下载一个 zip 文件。

当我在文本框 meow 中输入代码“ugh”并单击提交时，我想在[http://foo.example.com/bar/ugh.zip下载文件](http://foo.example.com/bar/ugh.zip)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:13:53.037

`.href`不是函数/方法，它是一个属性，您可以将有效的 URI 字符串分配给：

```
location.href = 'http://foo.exaple.com/bar/' + document.getElementById('meow').value + '.zip'; 
```

参见 MDN：[`window.location`对象](https://developer.mozilla.org/en-US/docs/DOM/window.location)

* * *

旁注：如果您不想提交表单，请使用输入`type="button"`而不是提交。

在我们的 Web 2.0 时代，混合结构和行为（HTML 和 JS）通常是不受欢迎的，所以：

```
<input type="button" name="submit" id="submit" value="Submit">
<script>
document.getElementById('submit').onclick = function() {
    location.href = 'http://foo.exaple.com/bar/' + document.getElementById('meow').value + '.zip';
};
</script> 
```

这在自 IE6 以来的所有浏览器中都可以很好地工作，并且您可以省去一些令人头疼的问题，例如在标记中混淆引号。`=]`
它也更容易维护，以后您甚至可以将页面的 JS 移动到单独的`.js`文件中，以进行结构和行为的缓存和分离。

# .net - 与 GUI 相关的特殊并行模式。它们存在吗？

> ID：14448148
> 
> 赞同：0
> 
> 时间：2013-01-21T22:10:09.957
> 
> 标签：.net, user-interface, asynchronous

异步编程变得更加自然。
C# 现在支持异步/等待。
正如 Anders Hejlsberg 所说，所有这些都使我们能够编写响应式应用[程序](http://channel9.msdn.com/Events/Build/BUILD2011/TOOL-816T)。我们的团队也喜欢异步。但是，当我们为 .net v.4.0 编写代码时，为了方便起见，我们必须开发一些辅助方法

但是我们使用异步操作的次数越多，它就变得越困难。
只是一个例子：

我们有 GUI 的主细节部分。当用户点击一些主项目相当长的操作开始获取详细信息。此操作本质上是不可阻挡的，例如数据库请求或文件下载。因此，我们异步启动这个长操作以使 UI 保持响应。
现在我们必须决定如何处理主项目列表。
我们可以允许用户更改项目并开始新的操作。已经运行的操作的结果现在可以放弃或放入缓存。
现在让我们想象一下，用户再次点击 item1、item2 和 item1。当他相当快地执行此操作时，item1 的已启动且未取消的操作仍可能无法完成。在这种情况下，我们最好等待这个操作的结果，而不是开始一个新的。因此，必须存在一些当前正在执行的操作的缓存。（不知道如何使用 await 轻松完成）
当然我们可以禁用主项目列表直到操作完成，但用户界面的其他部分仍然存在，但用户友好性不是很高。

*第二个例子（对第一个的升级）：*
GUI的细节部分由两个列表组成。每个列表的内容取决于所选的主条目。除此之外，列表相互影响的方式是，一个列表中的选择会改变另一个列表的状态。（是的，相当复杂的用例）。
现在，如果我们希望异步获取两个列表的数据怎么办？
我们事先不知道哪个列表赢得比赛并首先获得其数据。这真的没关系。重要的是获胜者存在的事实。列表一已完成，用户更改了选择...但等待此选择会影响尚未填充的列表二的状态。同样，我们可以在加载两个列表之前禁止选择，但是用户可以对列表执行许多独立操作。因此，这不是一个选择。
好的，我们该怎么做呢？好吧，我们可以引入两个列表加载时要启动的任务。在这个任务中，我们可以获得当前的选择并根据需要设置状态。

重点是什么？[我一般](http://msdn.microsoft.com/en-us/library/ff963553.aspx)
都读过并行编程，但我认为 GUI 是一个非常特殊的情况，因为用户交互使 GUI 随机改变它的状态（从执行流程的角度来看）。由于我们有 gui 相关的设计模式（MVC、MVP、MVVM），我们必须有特殊的并行模式

这是我的问题：

**是否存在专门的并行模式来解决常见的异步 GUI 任务？**

PS如果您认为这个问题更适合programmers.stackexchange，请随意迁移它。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T00:50:20.230

我发现在将桌面程序转换为异步时重新考虑 UI 并不少见。与相应的同步程序相比，异步程序可以具有更多可能的状态。

有几个有用的模式：禁用控件（或者，等效地，用“正在加载...”符号覆盖它们），并保持状态“上下文”（我在下面解释）。您也可以维护一个操作队列，但大多数人不会打扰，因为构建一个用于管理操作队列的 UI 并不容易。

> 此操作本质上是不可阻挡的，例如数据库请求或文件下载。

（旁注：这些都不是天生不可阻挡的）

> 我们可以允许用户更改项目并开始新的操作。已经运行的操作的结果现在可以放弃或放入缓存。

这些都是合理的方法，具体取决于您的应用程序和操作类型。

> 现在让我们想象一下，用户再次点击 item1、item2 和 item1。当他相当快地执行此操作时，item1 的已启动且未取消的操作仍可能无法完成。在这种情况下，我们最好等待这个操作的结果，而不是开始一个新的。因此，必须存在一些当前正在执行的操作的缓存。

我不建议为病态的用户场景进行设计。在这种情况下，如果用户真的以惊人的速度点击该主列表，那么让他们忍受性能下降。如果你真的很在意，你可以缓存结果（就像你上面提到的那样），这样 item1 的重新执行就会非常快。结果的缓存应该足够了；您不需要执行操作的缓存。

> 当然，我们可以在操作完成之前禁用主项目列表，但是虽然 UI 的其他部分保持活动状态，但对用户来说并不是很友好。

要记住的一件事是，它与同步应用程序一样*对*用户不友好，同步应用程序（大概）在这段时间内没有响应。

> 每个列表的内容取决于所选的主条目。除此之外，列表相互影响的方式是，一个列表中的选择会改变另一个列表的状态。

您可能需要重新考虑您的 UI。你真的需要这么复杂的吗？换一种方式想一想：您使用的*任何*公开可用的应用程序是否具有如此复杂的 UI？他们会做什么呢？

也就是说，我在博客中解释了一个古老的异步编程技巧：[异步回调上下文](http://nitoprograms.blogspot.com/2009/04/asynchronous-callback-contexts.html)。本质上，这个想法是您使用“cookie”来定义“当前”状态（对于某些范围）；当状态改变时，你改变“cookie”。属于该范围的所有异步方法都可以监视 cookie 并在其更改时采取特殊措施。

您可以使用`object`cookie（正如我在博客中所描述的那样），但您也可以使用`CancellationToken`：

```
private CancellationTokenSource masterListSelectionCookie;
private Task list1Download;
private Task list2Download;

void MasterList_Click(...)
{
  // Change the cookie, canceling any previous one.
  if (masterListSelectionCookie != null)
    masterListSelectionCookie.Cancel();
  masterListSelectionCookie = new CancellationTokenSource();

  // Clear out both lists.
  list1.Items.Clear();
  list2.Items.Clear();

  // Start both lists downloading.
  list1Download = DownloadList1Async();
  list2Download = DownloadList2Async();
}

async void List1_Click(...)
{
  // Get a local copy of the current cookie.
  var localMasterListSelectionCookie = masterListSelectionCookie.Token;

  // Ensure list2 is done downloading.
  await list2Download;

  // If the cookie has changed, ignore the click.
  if (localMasterListSelectionCookie.IsCancellationRequested)
    return;

  // Apply the click changes to list2 items.
  FilterList2(list1.Item);
}

async void List2_Click(...)
{
  // Get a local copy of the current cookie.
  var localMasterListSelectionCookie = masterListSelectionCookie.Token;

  // Ensure list1 is done downloading.
  await list1Download;

  // If the cookie has changed, ignore the click.
  if (localMasterListSelectionCookie.IsCancellationRequested)
    return;

  // Apply the click changes to list1 items.
  FilterList1(list2.Item);
} 
```

这个想法是，对于每个对 cookie 中隐含的“状态”敏感的操作，它们会在每个操作之后检查`await`cookie 是否已更改（`CancellationToken`即已被取消）并采取适当的行为（在这种情况下，只是不过滤其他列表）。

# spring - SpringAOP，加载时间编织，奇怪的行为

> ID：14448151
> 
> 赞同：0
> 
> 时间：2013-01-21T22:10:28.537
> 
> 标签：spring, spring-mvc, aspectj, spring-aop

在这一刻，我面临一个问题，真的不知道我做错了什么。我正在使用 @AspectJ 样式的 Spring 框架和 AOP 为我的 web 服务编写日志记录。我有两个包 - 背景和前端。在后台包中，我有 LogAspect，如下所示：

```
@Aspect
public class LogAspect {
    @Pointcut("@annotation(logMethod)")
    public void logMethodAnnotated(LogMethod logMethod){}

    @Before("logMethodAnnotated(logMethod)")
    public void beforeLogMethodAnnotated(JoinPoint jp){
        //actions
    }

    @After("logMethodAnnotated(logMethod)")
    public void afterLogMethodAnnotated(JoinPoint jp){
        //actions   
    }
} 
```

和 META-INF/spring/background-osgi.xml：

```
<context:annotation-config />
<context:component-scan base-package="simon.background"/>

<context:load-time-weaver /> 
```

还有 META-INF/aop.xml：

```
<!DOCTYPE aspectj PUBLIC
        "-//AspectJ//DTD//EN" "http://www.eclipse.org/aspectj/dtd/aspectj.dtd">
<aspectj>

    <weaver>

        <!-- only weave classes in our application-specific packages -->
        <include within="simon.background.*"/>
        <include within="simon.frontend.controller.*"/>

    </weaver>

    <aspects>

        <!-- weave in just this aspect -->        
        <aspect name="simon.background.log.LogAspect"/>

    </aspects>

  </aspectj> 
```

在前端包中，我刚刚放入了 aplicationContext.xml`<context:load-time-weaver aspectj-weaving="on" />`. 但是代码表现得很奇怪。当我将建议方法 JoinPoint 作为参数放入时，我发现存在一些问题。（我的意思是，当我得到不带参数的建议方法时，因此方法头中没有 JoinPoin，一切正常，并且建议在 @LogMethod 之前和之后一直在运行（我的注释，我曾经说过，我想要记录此方法）注释的方法）。但现在它的工作方式如下： - 当我启动服务器并首次部署包时，建议仅针对方法运行，它们是 @LogMethod 注释的并且属于后台包，但不适用于带注释的方法在前端.控制器中。- 此外，当我在其中一个控制器中进行了一些更改、保存并仅部署前端包时，然后当我运行 @LogMethod 注释方法时，

org.springframework.web.util.NestedServletException：处理程序处理失败；嵌套异常是 java.lang.LinkageError: loader constraint violation: 当解析方法“simon.background.log.LogAspect.afterLogMethodAnnotated(Lorg/aspectj/lang/JoinPoint;)V”类加载器（com/springsource/kernel/的实例当前类 simon/frontend/controller/HuhController 的 userregion/internal/equinox/KernelBundleClassLoader) 和已解析类 simon/background/ 的类加载器（com/springsource/kernel/userregion/internal/equinox/KernelBundleClassLoader 的实例） log/LogAspect，对于签名中使用的 /aspectj/lang/JoinPoint 类型有不同的 Class 对象；)V

任何想法发生了什么以及如何修复它，以便我的程序能够正确运行建议？

另外一点，它可能会有所帮助：当我在调试模式下使用没有 JoinPoint 参数的建议运行它时，我意识到，两个建议都针对一种方法运行了两次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T23:13:03.220

运行两次，可能是因为您同时使用两者吗？[<context:annotation-config> 与 <context:component-scan> 之间的区别](https://stackoverflow.com/questions/7414794/difference-between-contextannotation-config-vs-contextcomponent-scan)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-19T03:30:40.210

您的切入点已被触发两次，因为您的表达式仅约束注释类型。当一个方法被调用时，`call()`两者`execution()`都匹配这个表达式。

您可以使用`@annotation(xxx) && execution(* *(..))`切入点来限制执行条件。

# c - 关于如何解决这个矩阵/2x2D 数组计算的任何想法？

> ID：14448155
> 
> 赞同：1
> 
> 时间：2013-01-21T22:10:31.580
> 
> 标签：c

我有 2 个 3x3 矩阵，每个矩阵都以 2D 数组表示。第一个矩阵包含元素[我存储 PID，因此，元素的范围可以从数百万开始，我只是将其简化为 A 在我的实际应用中它是一个整数范围，A 可以是 200，B 可以是 200000] 例如，矩阵元素

```
{ A B C
  B D C
  C F B } 
```

second 持有每个位置的权重，例如矩阵权重

```
{ 9 7 5
  8 6 1
  7 5 4 } 
```

所以在上面的例子中，B 是最重的元素，因为它的权重是 7+8+4，其次是 C 等等，

如何找出前 3 个最高元素？

一种解决方案是：是将元素存储在一个单独的数组中 A[9][2]（元素，值和唯一）循环元素矩阵，然后另一个循环遍历值数组并填充与元素对应的值. [迭代创建9x2键值矩阵，迭代排序，迭代删除重复项（因为需要合并权重），-有更好的方法吗？]

还有其他有效的方法吗？[提示：我只需要 3 个，所以我不应该使用 9x2]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:27:41.150

假设您知道您只有`A-Z`可用的字母并且它们是大写字母。

```
char elems[3][3] = {
    { 'A', 'B', 'C' },
    { 'B', 'D', 'C' },
    { 'C', 'F', 'B' }
}; 
```

你也同样设置了你的权重......

您可以像这样跟踪计数：

```
int counts[26] = {0};

for( int i = 0; i < 3; i++ ) {
    for( int j = 0; j < 3; j++ ) {
        counts[elems[i][j] - 'A'] += weights[i][j];
    }
} 
```

那么这只是找到三个最大计数的索引的一个案例，我相信你可以轻松做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T22:46:51.703

忘记它们是二维数组，并将两个数据源合并为一个数组（成对）。对于您的示例，您将获得`{{'A', 9}, {'B', 7}, {'C', 5}, {'B', 8}, ...}`. 对这些进行排序（例如，使用`qsort`），然后浏览列表，随时求和 - 并保留您找到的得分最高的 3 个键。

[此解决方案始终有效，但仅在数组很大时才有意义，在重新阅读问题时它们不是]。

# java - 有没有办法绕过一个没有实现 Serializable 的类？

> ID：14448156
> 
> 赞同：0
> 
> 时间：2013-01-21T22:10:37.600
> 
> 标签：java, serialization, plugins, minecraft, bukkit

好的，所以我在存储在文件中并从中重新加载的 HashMap 中使用 Bukkit 的 ItemStack，但我发现 org.bukkit.craftbukkit.v1_4_6.inventory.CraftMetaItem 用于由 ItemStack.serialize( ) 没有实现可序列化。有没有办法解决这个问题？谢谢！

编辑：

这是我的插件中的代码片段。这是引发错误的部分。

```
 public void onEnable(
{
public Map<NewItem, List<ItemStack>> items = new HashMap<NewItem, List<ItemStack>>();
//Add content to items...
}
public void onDisable()
  {
      try
        {
          Map<List<Map<String, Object>>, NewItem> smap = new HashMap<List<Map<String, Object>>, NewItem>();
          for(NewItem item : items.keySet())
         {
              List<ItemStack> stacks = items.get(item);
                List<Map<String, Object>> stacks2 = new ArrayList<Map<String, Object>>();
              for(ItemStack stack : stacks)
              {
                  stacks2.add(stack.serialize());
                }
              smap.put(stacks2, item);
           }
          SaveLoadAPI.save(smap, this.getDataFolder().getPath()+"\\Items.data");
       }
      catch (Exception e)
        {
          getLogger().severe("Was unable to save the items file to the default path of: "+this.getDataFolder().getPath()+"\\Items.data");
            e.printStackTrace();
       }
  } 
```

最后但肯定最不重要的是，这里是错误！

```
 16:08:52 [SEVERE] java.io.NotSerializableException: org.bukkit.craftbukkit.v1_4_
6.inventory.CraftMetaItem
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeObject0(Unknown Sourc
e)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeObject(Unknown Source
)
16:08:52 [SEVERE]       at java.util.HashMap.writeObject(Unknown Source)
16:08:52 [SEVERE]       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native M
ethod)
16:08:52 [SEVERE]       at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown S
ource)
16:08:52 [SEVERE]       at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unkno
wn Source)
16:08:52 [SEVERE]       at java.lang.reflect.Method.invoke(Unknown Source)
16:08:52 [SEVERE]       at java.io.ObjectStreamClass.invokeWriteObject(Unknown S
ource)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeSerialData(Unknown So
urce)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeOrdinaryObject(Unknow
n Source)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeObject0(Unknown Sourc
e)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeObject(Unknown Source
)
16:08:52 [SEVERE]       at java.util.ArrayList.writeObject(Unknown Source)
16:08:52 [SEVERE]       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native M
ethod)
16:08:52 [SEVERE]       at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown S
ource)
16:08:52 [SEVERE]       at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unkno
wn Source)
16:08:52 [SEVERE]       at java.lang.reflect.Method.invoke(Unknown Source)
16:08:52 [SEVERE]       at java.io.ObjectStreamClass.invokeWriteObject(Unknown S
ource)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeSerialData(Unknown So
urce)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeOrdinaryObject(Unknow
n Source)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeObject0(Unknown Sourc
e)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeObject(Unknown Source
)
16:08:52 [SEVERE]       at java.util.HashMap.writeObject(Unknown Source)
16:08:52 [SEVERE]       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native M
ethod)
16:08:52 [SEVERE]       at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown S
ource)
16:08:52 [SEVERE]       at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unkno
wn Source)
16:08:52 [SEVERE]       at java.lang.reflect.Method.invoke(Unknown Source)
16:08:52 [SEVERE]       at java.io.ObjectStreamClass.invokeWriteObject(Unknown S
ource)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeSerialData(Unknown So
urce)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeOrdinaryObject(Unknow
n Source)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeObject0(Unknown Sourc
e)
16:08:52 [SEVERE]       at java.io.ObjectOutputStream.writeObject(Unknown Source
)
16:08:52 [SEVERE]       at com.tommy3244.plugins.MakeYourOwnBlocks.SaveLoadAPI.s
ave(SaveLoadAPI.java:16)
16:08:52 [SEVERE]       at com.tommy3244.plugins.MakeYourOwnBlocks.MakeYourOwnBl
ocks.onDisable(MakeYourOwnBlocks.java:86)
16:08:52 [SEVERE]       at org.bukkit.plugin.java.JavaPlugin.setEnabled(JavaPlug
in.java:219)
16:08:52 [SEVERE]       at org.bukkit.plugin.java.JavaPluginLoader.disablePlugin
(JavaPluginLoader.java:481)
16:08:52 [SEVERE]       at org.bukkit.plugin.SimplePluginManager.disablePlugin(S
implePluginManager.java:400)
16:08:52 [SEVERE]       at org.bukkit.plugin.SimplePluginManager.disablePlugins(
SimplePluginManager.java:393)
16:08:52 [SEVERE]       at org.bukkit.plugin.SimplePluginManager.clearPlugins(Si
mplePluginManager.java:434)
16:08:52 [SEVERE]       at org.bukkit.craftbukkit.v1_4_6.CraftServer.reload(Craf
tServer.java:563)
16:08:52 [SEVERE]       at org.bukkit.Bukkit.reload(Bukkit.java:184)
16:08:52 [SEVERE]       at org.bukkit.command.defaults.ReloadCommand.execute(Rel
oadCommand.java:23)
16:08:52 [SEVERE]       at org.bukkit.command.SimpleCommandMap.dispatch(SimpleCo
mmandMap.java:186)
16:08:52 [SEVERE]       at org.bukkit.craftbukkit.v1_4_6.CraftServer.dispatchCom
mand(CraftServer.java:514)
16:08:52 [SEVERE]       at org.bukkit.craftbukkit.v1_4_6.CraftServer.dispatchSer
verCommand(CraftServer.java:506)
16:08:52 [SEVERE]       at net.minecraft.server.v1_4_6.DedicatedServer.al(Dedica
tedServer.java:260)
16:08:52 [SEVERE]       at net.minecraft.server.v1_4_6.DedicatedServer.r(Dedicat
edServer.java:225)
16:08:52 [SEVERE]       at net.minecraft.server.v1_4_6.MinecraftServer.q(Minecra
ftServer.java:494)
16:08:52 [SEVERE]       at net.minecraft.server.v1_4_6.MinecraftServer.run(Minec
raftServer.java:427)
16:08:52 [SEVERE]       at net.minecraft.server.v1_4_6.ThreadServerApplication.r
un(SourceFile:849) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:25:47.697

看看这篇[文章](https://stackoverflow.com/questions/95181/java-serialization-with-non-serializable-parts)

如果您尝试扩展不可序列化的类，则您继承的所有字段（以及私有字段）都不会被序列化。所以，不幸的是，扩展一个包含很多字段的类不是一种选择。

如果对象 org.bukkit.craftbukkit.v1_4_6.inventory.CraftMetaItem 是一个字段，您可以将其标记为瞬态以避免序列化，如果这不能解决问题，您可以尝试实现 write() 和 read() 方法. 查看[API](http://docs.oracle.com/javase/6/docs/api/java/io/Serializable.html)以获取更多信息。

# c# - 如何在 C# 中进行 Console.Log、Print_R()、Debug.Trace？

> ID：14448160
> 
> 赞同：11
> 
> 时间：2013-01-21T22:10:50.227
> 
> 标签：c#, asp.net-mvc-3

PHP 有一个名为 print_r() 和 var_dump() 的函数，可以显示项目的所有内容。它使弄清楚事物是什么变得非常容易。

**C#中有类似的东西吗？**

我知道 C# 中有一个`Console.WriteLine("Hello");`，但这在 MVC 中有效吗？我可以在运行应用程序时在调试控制台中执行某种类型的`debug.trace()`flash 操作吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-21T22:12:00.350

```
System.Diagnostics.Debug.WriteLine("blah"); 
```

为了显示对象中的所有变量，您必须重写其 ToString() 方法或编写一个方法，该方法返回您需要从对象中获取的所有信息。IE

```
class Blah{

    string mol = "The meaning of life is";
    int a = 42;    

    public override string ToString()
    {
         return String.Format("{0} {1}", mol, a);
    }
}

System.Diagnostics.Debug.WriteLine(new Blah().ToString()); 
```

简而言之，没有内置任何东西，但可以做到。

如果您必须打印所有对象信息而不覆盖或在类级别上添加逻辑，那么您处于反射领域以迭代对象 PropertInfo 数组

# android - Android 资源的“可用宽度”限定符：从哪个版本开始支持？

> ID：14448161
> 
> 赞同：1
> 
> 时间：2013-01-21T22:10:58.213
> 
> 标签：android, android-resources

在[Android 文档](http://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources)中，“可用宽度”部分显示为“在 API 级别 13 中添加”。在提到一些已经引入的 XML 属性之前。

但这是否意味着“可用宽度”限定符 ( `wXXXdp`) 仅在 API 级别 13+ 中受支持，或者仅仅是那些在该 SDK 版本中可用的 XML 属性？

我想在 API 级别 8+ 的应用程序中使用“可用宽度”，并且该限定符没有真正的替代品，是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:13:20.793

如果平台不[重新识别它，](http://developer.android.com/guide/topics/resources/providing-resources.html#table2)则忽略限定符：

> 注意：自 Android 1.0 以来已添加了一些配置限定符，因此并非所有版本的 Android 都支持所有限定符。使用新的限定符会隐式添加平台版本限定符，以便旧设备肯定会忽略它。

# multithreading - 将多个嵌入式 javafx JFXPanel 管理到 swing 选项卡窗格中

> ID：14448162
> 
> 赞同：2
> 
> 时间：2013-01-21T22:11:02.563
> 
> 标签：multithreading, swing, scala, thread-safety, javafx

我正在使用 swing 显示多个 javafx `Tableview`，每个都嵌入（感谢 `JFXPanel`）在一个 swing`TabbedPane`

我以scala方式使用oracle doc中描述的众所周知的模式：

```
implicit def fun2Run[T](x: ⇒ T) = new Runnable {
    def run = x
  }

  def myTabbedScene():Scene = {
    val root = new StackPane
    root.getChildren.add(new Label("Hello world!"))
    new Scene(root, 300, 300)
  }

  def initFxPanel(fxPanel: JFXPanel, s: ⇒ Scene) = {
    fxPanel.setScene(s)
  }

  def initSwingGui(panel: PluginPanel) = {
    val fxPanel = new JFXPanel()
   // code to add panel to JPanel
    panel.peer.add(fxPanel)
    Platform runLater initFxPanel(fxPanel,myTabbedScene())
  }

  val jfxSwingPanel = new PluginPanel("wrap 2") {
    var jtemp = new JPanel()
    contents += jtemp
  }

  SwingUtilities invokeLater initSwingGui(jfxSwingPanel) 
```

每次用户打开新的摆动选项卡时都会执行此代码（只有场景方法不同），但我不确定这是在这种情况下管理线程的最佳方法：-/

当我关闭或打开选项卡时，我的应用程序中有一些不连贯的状态，并且在显示期间出现错误。

我的用例的一个例子，以及一些链接的问题：

*   我打开第一个选项卡 J1，调用 runlater，我的场景在选项卡中显示没有问题。

*   我打开第二个选项卡 J2，在 javafx 线程上调用一个新的 runlater，

*   我切换到标签 J1，我的标签中的显示如何刷新？向主线程启动隐式`runnable`操作以使这成为可能？**javafx如何识别刷新的好标签**？如果我有一个启动某些动作的按钮，我会`runlater()`在 javafx 主线程上启动一个动作，该线程调度？

*更新：*

我找到了一个可以帮助读者了解这一点的代码源，您可以`revalidate()`或/和`repaint()`您的摆动面板（此处`_contentpane`）包含您的`jfxPanel`

```
 SwingUtilities.invokeLater(new Runnable() { 
    public void run() { 
    _contentPane.add(_jfxPanel); 
    _contentPane.revalidate(); 
    _contentPane.repaint(); }}); 
```

*   我关闭第一个选项卡 J1，javafx 自动关闭/垃圾关联的 javafx 资源？

我有多个其他一般性问题：

*   当 javafx 应用程序主线程从 swing 中的不同 jfxpanel 到达时，它们如何管理这个多个 runlater() 调用？

*   当用户关闭选项卡时，如何正确关闭与我的 jfxpanel 关联的资源（不使用 exit() Platform 方法关闭主 javafx 线程）？如果我销毁 JFXPanel，用于显示的 javafx 资源是否被释放？

*   使用任务来管理我的线程可以解决我的问题吗？

我的问题可能很幼稚，但我从 gui 构建开始，我很难理解 javafx 如何在不同的嵌入式面板上管理场景。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:28:33.257

> 当 javafx 应用程序线程从 swing 中的不同 jfxpanel 到达时，它们如何管理这个多个 runlater() 调用？

从 Platform.runLater javadoc：

> 在未来某个未指定的时间在 JavaFX 应用程序线程上运行指定的 Runnable。此方法可以从任何线程调用，它将 Runnable 发布到事件队列，然后立即返回给调用者。Runnables 按照它们发布的顺序执行。传递给 runLater 方法的 runnable 将在传递给后续调用 runLater 的任何 Runnable 之前执行。

更远：

> 当用户关闭选项卡时，如何正确关闭执行我的 jfxpanel 的线程（不关闭主 javafx 线程）？

目前尚不清楚您指的是哪个线程。一般来说，在集成 JavaFX 和 Swing 时，只需要关注两个线程 - Swing 调度线程和 JavaFX 应用程序线程 - 这两个线程都应该由各自的底层框架管理，您不需要显式关闭。您不需要任何其他线程，除非您尝试执行不应在其中任何一个线程上执行的操作（例如高度 CPU 密集型任务或远程 I/O） - 从您的示例代码中不会出现就是这样。

> 使用任务来管理我的线程可以解决我的问题吗？

除非您对这样的事情有特殊需求，否则这样的解决方案可能会使您的情况变得更加复杂而不是改善它。

> 我关闭第一个选项卡 J1，javafx 自动关闭/垃圾关联的 javafx 资源？

如果您不保留对相关 jfxpanel 中任何资源的引用，那么 Java 虚拟机可以对 jfxpanel 和与之相关的资源进行垃圾收集——这只是标准的 Java 垃圾收集技术，这里没什么特别的。

> 我切换到标签 J1，我的标签中的显示如何刷新？向主线程启动隐式可运行操作以使这成为可能？

听起来是个坏主意（Java 术语中的主线程是用于启动 Java 的 main 函数的线程，根本不参与 GUI 编程）。您可能希望通过提交您的可运行刷新请求，`Platform.runLater()`以便它将在 JavaFX 应用程序线程上执行。

> javafx如何识别刷新的好标签？

您在每个摆动选项卡中都有一个 JavaFX JFXPanel，并且每个摆动选项卡都知道它具有哪个 JFXPanel，因此当您调用 Platform.runLater 以刷新特定面板时，将（最终）引用传递给要使用的 JFXPanel。这是一些没有任何语言的伪代码来说明这个概念：

```
on swing tab change event
  final JFXPanel curPanel = tab.getJFXPanel()
  Platform.runLater() {
    // update curPanel here...
  } 
```

> 如果我有一个启动某些操作的按钮，我会在 javafx 主线程上启动一个 runlater() 操作，它调度？

从本质上讲，我认为您在这里是正确的，我只是重写您的问题以澄清一些术语-假设它是一个摆动按钮，并且在对摆动按钮执行操作时，您调用`Platform.runLater`，然后在runLater 调用最终将在 JavaFX 应用程序线程上执行。

* * *

其他问题我无法回答，因为我在 Scala 中不够流利，无法提供合理的答案。

老实说，如果您刚刚开始构建 GUI，那么我主动提出的建议是使用 Java 而不是 Scala，并坚持使用 Swing 或 JavaFX，但在您真正熟悉 GUI 构建过程之前不要将它们混合在一起 - 否则会有在集成过程中您可能会遇到太多的陷阱和陷阱，很少有人能够帮助您。

# xcode - 如何自动保存我的 UITextField 数据？简单的答案会很好

> ID：14448163
> 
> 赞同：0
> 
> 时间：2013-01-21T22:11:05.913
> 
> 标签：xcode, uitextfield, save, automatic-ref-counting

我已经构建了一个已经可以在 App Store 中下载的应用程序，但最重要的事情并没有发生。我的应用程序包含 208 个 UITextField，但它们不会自动保存。发生是很重要的，否则应用程序将毫无用处。我在论坛上阅读了一些答案，但我没有特定的标签，或者我无法理解答案。我只是来自荷兰的 16 岁开发人员，不懂所有难懂的英语程序语言。所以请尽快回答这个问题，并请一个简单（可能很长）的答案。如果您愿意，我也可以将我的申请发送给您，然后您可以自己更改。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-22T06:46:15.040

可以试试下面的方法吗，

```
 NSTimer *timer = [NSTimer scheduledTimerWithTimeInterval:1.0f target:self selector:@selector(savetextfield:) userInfo:nil repeats:YES];

-(void)savetextfield:(NSTimer*)timer
{
   NSString *mystriing=textField.text;
} 
```

上述方法用于处理唯一的一个 textField 值。通过使用 Timer 对象，我们可以重复调用一个方法。

# android - 使用 MediaRecorder 写入缓冲区或 FIFO

> ID：14448166
> 
> 赞同：4
> 
> 时间：2013-01-21T22:11:22.503
> 
> 标签：android, audio, media-player, mediarecorder, android-mediarecorder

我正在开发一种低数据速率的 VoIP 项目。我需要以低数据速率捕获音频并将其存储在内部缓冲区或 FIFO 中（不在文件中）。

我想使用低数据速率的 .AMR 编码器，这意味着 AudioRecord 已退出。MediaRecorder 看起来完全符合我的要求，只是它似乎是在写入文件。

MediaRecorder 需要一个 FileDescriptor...有什么办法可以编写一个实现 FileDescriptor 接口的类...充当字节的同步...但不是将它们发送到存储在缓冲区中的文件？FileDescriptor 上的文档特别指出，应用程序不应该自己编写，但为什么不可以呢？反正有可能吗？

[http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FileDescriptor.html](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FileDescriptor.html)

简而言之，我想开发自己的流，并欺骗 MediaRecorder 向它发送数据。也许在同一个 APK 中打开套接字的两端并为 MediaRecorder 提供要写入的套接字会做一些棘手的事情？使用套接字作为我的 FIFO？我对此有些陌生，因此非常感谢任何帮助/建议。

我在 RX 方面有一个相关的问题。我想要一个为 MediaPlayer 提供数据的缓冲区/fifo。我可以欺骗 MediaPlayer 接受来自我自己的专有流馈送的缓冲区的数据吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T12:57:51.243

我知道现在回答这个问题有点晚了......但如果它有帮助，那就是解决方案。

**Android MediaRecorder**的方法`setOutputFile()`接受 FileDescriptor 作为参数。至于您的需要，可以创建一个 unix 数据管道，并且可以通过以下方式将其 FD 作为参数传递...

```
mediaRecorder.setOutputFile(getPipeFD());

FileDescriptor getPipeFD()
{
    final String FUNCTION = "getPipeFD";
    FileDescriptor outputPipe = null;

    try
    {
        ParcelFileDescriptor[] pipe = ParcelFileDescriptor.createPipe();
        outputPipe = pipe[1].getFileDescriptor();
    }
    catch(Exception e)
    {
        Log.e(TAG, FUNCTION + " : " + e.getMessage());
    }

    return outputPipe;
} 
```

创建一个 Unix 数据管道并返回一个ParcelFileDescriptors`ParcelFileDescriptor.createPipe()`数组。第一个对象是指读通道（Source Channel），第二个是指管道的写通道（Sink Channel）。使用`MediaRecorder`对象将记录的数据写入写入通道...

就 MediaPlayer 而言，可以通过将与创建的管道的读取通道相关的 FileDescriptor 对象传递给方法来使用相同的技术`setDataSource()`......

# ios - 以用户位置为中心显示多个注释

> ID：14448172
> 
> 赞同：0
> 
> 时间：2013-01-21T22:12:09.307
> 
> 标签：ios, map, annotations, mkmapview, user-location

我需要在地图视图中显示多个注释并缩放以显示所有这些注释。我有代码

```
MKMapRect zoomRect = MKMapRectNull;

int i = 0;
for (Post *post in _allPostsToList) {
    if (((post.location2D.latitude == 0.0f)&&(post.location2D.longitude == 0.0f))||(!CLLocationCoordinate2DIsValid(post.location2D))) {
        i++;
        continue;
    }
    MyAnnotation *annotation = [[MyAnnotation alloc] initWithpost:post];
    annotation.tag = i++;
    [mapView addAnnotation:annotation];

    MKMapPoint annotationPoint = MKMapPointForCoordinate(annotation.coordinate);
    MKMapRect pointRect = MKMapRectMake(annotationPoint.x, annotationPoint.y, 0, 0);
    zoomRect = (MKMapRectIsNull(zoomRect))?pointRect:MKMapRectUnion(zoomRect, pointRect);
}
[mapView setVisibleMapRect:zoomRect animated:YES]; 
```

它工作正常，但我还需要一件事，需要地图中心的用户位置蓝色气泡，并显示上述所有注释。这个怎么做。我试过这个

```
-(void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation{
        MKMapRect zoomRect = mapView.visibleMapRect;
        MKMapPoint annotationPoint = MKMapPointForCoordinate(newLocation.coordinate);
        MKMapRect pointRect = MKMapRectMake(annotationPoint.x, annotationPoint.y, 0, 0);
        zoomRect = (MKMapRectIsNull(zoomRect))?pointRect:MKMapRectUnion(zoomRect, pointRect);
        [mapView setVisibleMapRect:zoomRect animated:YES];
        [manager stopUpdatingLocation];

   } 
```

它的工作但它没有以用户位置为中心如何做到这一点。谁能解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T00:23:30.210

在`didUpdateToLocation`您获得当前可见的 Rect (zoomRect) 时，如果它不为空，则将其与 pointRect 连接并对其进行缩放/平移。这将如何以 pointRect 为中心？只有当他们两个拥有完全相同的中心时才会发生这种情况。

如果您想以用户位置为中心但显示所有点，您可以获得点与用户位置的最大距离，并创建一个具有中心和跨度以匹配的 maprect。但是如果这些点都在一个方向上并且用户位置在屏幕的中间，那么屏幕的另一侧就被浪费了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:55:20.370

只是一个赌注；如何访问您的 mapView 的区域并尝试设置新中心：

```
MKCoordinateRegion region = mapView.region;
region.center = newLocation.coordinates;
[mapView setRegion:region animated:YES]; 
```

# c# - 如何在 C# Winstore Metro 应用程序中永久保存用户数据？

> ID：14448174
> 
> 赞同：0
> 
> 时间：2013-01-21T22:12:18.587
> 
> 标签：c#, windows-runtime, windows-store-apps

我的 Winstore C# 应用程序中有一些用户数据。我刚刚了解到，安装新版本的应用程序（或用户重新安装应用程序）后，本地商店和应用程序数据将被删除。

如何永久存储数据？它可以为用户透明地完成吗？

企业级应用程序怎么样——你们如何访问更强大的数据，如数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:37:29.673

卸载应用程序时删除所有本地数据是 Windows 应用商店应用程序的预期模式。

如果您想永久存储数据，我的建议是您考虑构建一个后端数据存储和服务来访问它们。然后您控制服务器端数据，并可以在用户安装您的应用程序时将数据与用户关联（请注意，如果您计划存储数据而不是在用户卸载应用程序时将其删除，您可能应该在您的应用程序的隐私政策）。

在构建后端服务方面有几个不错的选择，我在我目前正在处理的博客系列中探讨了其中的几个：

[http://bitly.com/bundles/devhammer/2](http://bitly.com/bundles/devhammer/2)

该系列涵盖了构建一个后端游戏排行榜服务，该服务将数据存储在 Windows Azure 上的 SQL 数据库中（尽管这些概念也适用于您自己托管的服务），使用 3 个堆栈之一：

1.  WCF 数据服务
2.  ASP.NET Web API
3.  Windows Azure 移动服务

这三个堆栈中的任何一个都将允许您为您的应用程序创建一个强大的后端，并且可以跨平台使用。

关于透明度，您绝对可以使上述服务在功能上对用户透明，但如上所述，最好对您计划在卸载应用程序后继续存储数据这一事实保持透明，也许甚至为用户提供删除数据的选项。皮特布朗最近发布了一个很好的 Windows 应用商店应用程序隐私政策特征的概述，并在帖子中解决了这个问题：

[http://10rem.net/blog/2013/01/21/traits-of-a-good-windows-store-app-privacy-policy](http://10rem.net/blog/2013/01/21/traits-of-a-good-windows-store-app-privacy-policy)

有关 Windows 应用商店应用开发的更多信息，请注册[Generation App](http://bit.ly/gd30tolaunch)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:47:53.403

您可以使用 Skydrive 或 Dropbox 之类的工具来存储文件。

编辑*

WinRT 中不支持数据库访问。虽然您可以使用 SQLite 之类的东西在本地存储数据 - 它主要用于缓存，并且预计您将数据保存在云中的某个位置，因此您仍然应该上传您想要存储在机器外部某处的数据。

如果您想在您的计算机上存储不会被您的应用程序删除的文件 - 您可以将它们保存在文档/图片/音乐/视频库中的某个位置，具体取决于它们最适合的位置。

# mysql - drupal中选择查询的正确语法是什么

> ID：14448176
> 
> 赞同：0
> 
> 时间：2013-01-21T22:12:23.093
> 
> 标签：mysql, drupal, drupal-6

如果我有一张名为 book 的桌子

```
Column 1 = current_user
, Column 2 = page_length
, Column 3 = author
, Column 4 = title 
```

我想从与当前登录用户对应的第 2、3 和 4 列中选择数据。以下是正确的语法吗？

```
<?
global $user;
$user_id=$user->name;
db_query('SELECT * FROM {book} WHERE current_user=$user_id', $page_length, $author,   $title); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:24:23.093

一些技巧：

1.  您需要确保在作为 SQL 语句的字符串周围使用引号。
2.  由于用户名是用户提供的字符串，因此您应该使用参数转义来防止 SQL 注入。
3.  您实际上不需要将用户名分配给单独的变量 ( `$user_id`) 即可使用它。
4.  您需要从`db_query`.

固定代码：

```
<?php
global $user;
$res = db_query("SELECT page_length, author, title FROM {book} WHERE current_user = '%s'", $user->name); 
$row = db_fetch_array($res);
// now $row['page_length'], $row['author'] and $row['title'] are filled in with values if the query was successful
?> 
```

# gmail - 离线 IMAP 和 Mutt 与 Gmail 的所有邮件文件夹

> ID：14448179
> 
> 赞同：2
> 
> 时间：2013-01-21T22:12:39.813
> 
> 标签：gmail, imap, mutt

**离线IMAP**

我正在尝试通过offlineimap 将我的Gmail - All Mail 文件夹与idlefolders 同步。我的 .offlineimaprc 配置有这个 -

```
idlefolders = ['INBOX', '[Gmail].All Mail'] 
```

我在 .mail 中的所有邮件文件夹的名称（我的邮箱所在的位置）看起来像

```
drwx------ 5 ry ry    4096 Oct 12 18:13 [Gmail].All Mail 
```

我认为空闲文件夹中的名称是错误的。我看到很多人在线使用 [Gmail]/All Mail。

我的收件箱文件夹同步正常，但所有邮件没有。

**穆特**

还尝试在 .muttrc 中为所有邮件设置宏快捷方式-

```
macro index ga  "<change-folder> =[Gmail].All Mail<enter>" 
```

这*不起作用*，但我的收件箱宏*确实*有效

```
macro index gi  "<change-folder> =INBOX<enter>" 
```

怎么了？我应该如何调用我的所有邮件文件夹？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T18:55:13.677

对于我的 Mutt 1.5.21，百分比编码有效：

```
macro index ga "<change-folder>=[Gmail]/All%20Mail<enter>" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T01:45:12.540

我认为这里的问题是文件夹中的空白。可能的解决方案：

1.  **更新：**正如 winchendonsprings 所指出的，有一种方法可以转义文件夹名称中的空格。现在我们可以使用宏更改为`All Mail`：

    ```
    bind editor <space> noop
    macro index ga "<change-folder>=[Gmail].All Mail<enter>" "Go to all mail" 
    ```

2.  [如文档中所述，](http://docs.offlineimap.org/en/latest/nametrans.html)您可以使用名称转换来创建没有空格的邮箱 。例如，翻译可能如下所示：

    ```
    nametrans = lambda x: re.sub('\[|\]|\s', '_', x) 
    ```

    正如文档所述，您应该确保没有文件夹以相同的翻译名称结束。您可以通过运行 offlineimap 来检查这一点`--info`。

3.  另一种可能的解决方案是，注册您的邮箱并简单地使用宏在索引和您配置的邮箱列表之间切换，例如。在你的`.muttrc`：

    ```
    mailboxes =[Gmail].All\ Mail =[Gmail].Important =[Gmail].Starred
    macro index <left> ':mailboxes <enter>c?<toggle-mailboxes> 
    ```

    这提供了 mutt 监控您的本地邮箱并告诉您是否有新邮件的好处。如果需要，您甚至可以自动执行此操作。[可以在此处找到示例。](http://dev.mutt.org/trac/wiki/ConfigTricks)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-08T20:18:38.477

另一个糟糕的解决方案是只使用`<complete>`来避免输入文字空间：

```
macro index ga "<change-folder>=[Gmail]/All<complete><enter>" 
```

# objective-c - 如何在objective-C cocoa中显示带有“选择文件”的窗口

> ID：14448180
> 
> 赞同：1
> 
> 时间：2013-01-21T22:12:40.097
> 
> 标签：objective-c, cocoa, file, select, nsworkspace

我在 OS X 上的应用程序中有一些操作，我必须从 finder 中选择文件。我想显示如下窗口：“打开文件”。我知道这让我打开带有路径的 url：

```
[[NSWorkspace sharedWorkspace] openURL:[NSURL fileURLWithPath:NSHomeDirectory() isDirectory:YES]]; 
```

但是如何使用“选择”按钮显示窗口。这个窗口应该让我获得有关所选文件的信息。

我怎样才能正确地做到这一点？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-06-23T16:42:03.063

先前答案的代码：

```
NSOpenPanel *op = [NSOpenPanel openPanel];
op.canChooseFiles = YES;
op.canChooseDirectories = YES;
[op runModal];
self.txtFilePath.stringValue = [op.URLs firstObject]; 
```

在 op.URLs 中，您可以找到刚刚选择的所有文件的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-16T18:21:01.957

基于 EderYif 的回答，以下内容不会产生编译器警告，并且还会删除返回文件名的 'file://' 部分。

```
NSOpenPanel *op = [NSOpenPanel openPanel];
[op setCanChooseFiles:true];
[op setCanChooseDirectories:true];
[op runModal];

NSString* file = [[op.URLs firstObject] absoluteString];
NSString* fixedFile = [file stringByReplacingOccurrencesOfString:@"file://"
                                                      withString:@""];
[[self textFilePath] setStringValue:fixedFile]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:27:00.687

@Perception 和 @omz 给了我很好的答案。答案是`NSOpenPanel`。

# simple.data - Simple.data 选择前 N 条记录

> ID：14448183
> 
> 赞同：2
> 
> 时间：2013-01-21T22:12:57.747
> 
> 标签：simple.data

我正在使用 Simple.Data 从表中选择数据，并且想知道是否有办法从表中选择前 10 条记录。

就像是：

```
var result = _database.UserList.All()
            .Select(_database.UserList.Name).Take(10)  -- or .Top(10) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:46:13.370

完全像：

```
var result = _database.UserList.All()
             .Select(_database.UserList.Name).Take(10); 
```

这篇博文中有关 Take and Skip 的更多信息：http: [//blog.markrendle.net/simple-data-0-8-0-and-more/](http://blog.markrendle.net/simple-data-0-8-0-and-more/)

当我们在这里时，值得一提的是，如果您只想将这些名称作为字符串，您可以这样做：

```
var result = _database.UserList.All()
             .Select(_database.UserList.Name)
             .Take(10)
             .ToScalarList<string>(); 
```

# android - Android：从 USB 枚举点获取闪存驱动器的挂载点

> ID：14448185
> 
> 赞同：0
> 
> 时间：2013-01-21T22:13:17.787
> 
> 标签：android, linux, usb-drive, mount-point

我有一个闪存驱动器，我知道它的供应商 ID 和产品 ID。

通过扫描`/sys/bus/usb/devices`，我可以可靠地找到根设备的枚举点（例如`/sys/bus/usb/devices/3-1`）和大容量存储设备的枚举点（例如`/sys/bus/usb/devices/3-1:1.0`）。

**一旦我知道了这两个枚举点，我如何使用它们来查找挂载点（例如`/mnt/usb0/part0`or `/mnt/UsbStorageA`）？**

--

**或者，是否有直接的方法从供应商 ID 和产品 ID 获取挂载点？**

--

**编辑 1（有关我的进度的更多详细信息）：**

好的（从挂载点向后工作）：

挂载点：（`/storage/usb0/part0`根据`/proc/mount`）

设备节点：（`/dev/block/vold/8:1`根据`/proc/mount`）

分区名称`sda1`（根据`/proc/partitions`）

但我似乎无法关联到`/sys/block`，因为在 中没有`sda1`条目，在 中`/sys/block`也没有任何`8:1`条目`/sys/dev/block`。`/sys/dev/char`相反，奇怪的是，USB 设备位于`189:261`. 为什么它会显示为字符设备而不是块设备？:-(

# android - 即使使用工作线程，Android 也会在 UI 线程上运行

> ID：14448187
> 
> 赞同：0
> 
> 时间：2013-01-21T22:13:20.057
> 
> 标签：android, multithreading, user-interface

我正在使用工作线程，如此[处所述，](http://developer.android.com/guide/components/processes-and-threads.html)但代码仍然阻塞了 UI。如果我在 run() 方法的开头睡觉，它不会阻塞 UI。问题是，它是从 onCreate 方法运行的繁重代码，但无论我做什么，我都无法让它不阻塞 UI。我究竟做错了什么？

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    new Thread(new Runnable() {
        @Override
        public void run() {
            for (int i = 0; i < 1000000; i++) {
                Log.d("asdf", "asdf");
            }
        }
    }).start();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T02:14:01.177

用于`Handler`或`.runOnUiThread(runnable)`调用您的 UI 线程。您也可以在没有 Runnable 的情况下执行线程，如下所示：

```
new Thread(){
        @Override
        public void run() {
            for (int i = 0; i < 1000000; i++) {
                Log.d("asdf", "asdf");
            }
        }
    }).start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:16:10.163

您没有使用 AsyncTask - 这是 Android 用来在 UI 线程之外执行长时间运行进程的控件。

最重要的是，使用它，您将获得更大的成功。

[AsyncTask Android 示例](https://stackoverflow.com/questions/9671546/asynctask-android-example)

# node.js - 节点是否有放置自定义控制台方法（如 ~/.irbrc）的地方？

> ID：14448190
> 
> 赞同：1
> 
> 时间：2013-01-21T22:13:23.347
> 
> 标签：node.js

我想如果我可以`reload!`在 Node 控制台中编写代码会很方便，效果如下：

`reload('./path/to/my/file.js')`

这将从缓存中删除代码然后再次加载它——这对于执行原型代码很方便。似乎是一个自然的函数，可以放在 node 的`~/.irbrc`. 但我找不到那个。节点有这样的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T05:48:54.460

不知道有没有这样的工具。但我相信你需要的可以通过使用[nodemon](https://github.com/remy/nodemon)来实现。

用来`sudo npm install nodemon -g`安装它。然后通过`nodemon app.js`而不是启动您的应用程序`node app.js`。然后它会监视附近文件的更改`.js`，并在您保存时自动重新启动。

# iphone - 如何像 iPhone 上的标准相机应用程序一样处理方向的变化

> ID：14448192
> 
> 赞同：1
> 
> 时间：2013-01-21T22:13:26.857
> 
> 标签：iphone, ios, camera-overlay

我使用 AVFoundation 框架来访问相机。在标准相机应用程序中，当方向改变时，仅按钮上的图标旋转。但是当我尝试做类似的事情时，我遇到了与方向更改动画相关的问题。预览视图已旋转，其后面的区域为黑色，并且在转动时出现图像抖动。

现在我有这个代码：

```
-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration {

    [CATransaction begin];
    [CATransaction setValue:[NSNumber numberWithFloat:duration]
                     forKey:kCATransactionAnimationDuration];
    if (toInterfaceOrientation==UIInterfaceOrientationLandscapeLeft){
        captureManager.previewLayer.transform=CATransform3DMakeRotation(M_PI/2, 0, 0, 1.0);
        captureManager.previewLayer.frame = CGRectMake(0, 0, 480, 320);
    } else if (toInterfaceOrientation==UIInterfaceOrientationPortrait){
        captureManager.previewLayer.transform=CATransform3DMakeRotation(0, 0, 0, 1.0);
        captureManager.previewLayer.frame = CGRectMake(0, 0, 320, 480);
    } else if (toInterfaceOrientation==UIInterfaceOrientationLandscapeRight){
        captureManager.previewLayer.transform=CATransform3DMakeRotation(M_PI+M_PI/2, 0, 0, 1.0);
        captureManager.previewLayer.frame = CGRectMake(0, 0, 480, 320);
    }

    [CATransaction commit];
} 
```

我的想法是使用变换动画来处理旋转动画，但我遇到了 glithes 的问题。

如何创建相机预览视图并解决方向更改问题？可能我必须使用其他仪器来使用相机吗？不是 AVFoundation 框架？

我知道我可以锁定方向并使用加速度计来处理按钮图标。但是我遇到了一些子视图控制器的问题。

对不起糟糕的英语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T22:25:32.440

您需要通过处理方向更改通知来禁用控制器的横向方向并更新图标布局等。在本主题中，它的描述是正确的 -[如何在 AVCaptureVideoPreviewLayer 中处理自动旋转？](https://stackoverflow.com/questions/11079726/how-to-handle-autorotation-in-avcapturevideopreviewlayer)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-20T11:39:26.400

Nikita 的回答有效，但需要额外的代码来处理设备旋转时 UI 元素的行为。如果这太麻烦了，另一种选择（我实现并工作）是拥有 2 个不同的 UIWindow 实例，一个用于相机的预览层，一个用于显示 UI 元素。请注意，要使其正常工作，带有 UI 元素的 Window 需要具有透明背景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-12T15:05:48.620

我通过以下方式处理预览旋转更改。

PS所有子视图都在情节提要上设置了相应的约束，所以我只更新videoPreviewLayer的帧。

```
override func viewWillTransition(to size: CGSize, with coordinator: UIViewControllerTransitionCoordinator) {
    DispatchQueue.main.async {
        self.videoPreviewLayer.frame = self.previewView.bounds
        self.setRotation()
    }
}

func setRotation() {
    let deviceOrientation = UIDevice.current.orientation
    switch deviceOrientation {
    case .landscapeLeft:
        videoPreviewLayer?.connection?.videoOrientation = AVCaptureVideoOrientation.landscapeRight
        break
    case .landscapeRight:
        videoPreviewLayer?.connection?.videoOrientation = AVCaptureVideoOrientation.landscapeLeft
        break
    case .portrait:
        videoPreviewLayer?.connection?.videoOrientation = AVCaptureVideoOrientation.portrait
        break
    case .portraitUpsideDown:
        videoPreviewLayer?.connection?.videoOrientation = AVCaptureVideoOrientation.portraitUpsideDown
        break
    default:
        break
    }
} 
```

# jquery - SCRIPT1002：语法错误 - IE10

> ID：14448196
> 
> 赞同：2
> 
> 时间：2013-01-21T22:13:51.203
> 
> 标签：jquery, asp.net, visual-studio-2012, internet-explorer-10

我在 Visual Studio 2012 上使用 .Net 4.0 freamworok。我第一次启动的网站在 Internet Explorer 10 上出现以下错误。其他浏览器（Google Chrome、Firefox ..）工作正常。

 **... SCRIPT1002第 2 行第 1 列的 JavaScript 严重错误 ：语法错误**

我的 jquery 脚本文件已在母版页中设置。

```
<head runat="server">
<script src="<%# ResolveUrl("~/") %>Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
<asp:ContentPlaceHolder ID="head" runat="server">
</asp:ContentPlaceHolder> 
```

我无法弄清楚问题所在。你能帮助我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-31T07:25:35.003

SCRIPT1002 消息的完整文本提供了一个线索，即***语法错误脚本部分***：

> siteZ.domainQ/mypage SCRIPT1002 中第 x 行第 y 列的 JavaScript 严重错误：语法错误脚本部分

对我来说，我的 _Layout.cshtml 或 Index.cshtml 引用了脚本或样式***不存在的虚拟路径。***

```
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Bubble</title>
@Styles.Render("~/Content/ErrorPathDoesNotExist/css")
</head> 
```

或者

```
@section Scripts{
@Scripts.Render("~/bundles/ErrorPathDoesNotExist")
} 
```

我通过删除或更正 @Styles.Render 或 @Scripts.Render 语句中的无效虚拟路径解决了我的错误。

有关详细信息，请参阅有关捆绑、缩小和优化的 Microsoft 文档。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-05T11:02:49.640

可能你已经解决了你的问题。但仍然没有公认的答案。所以这是另一个。

`const`当我在我的 javascript 文件中使用时，我遇到了同样的错误。当我更改`const IDLE = 0;`为`var IDLE = 0;`我的问题时解决了。

Const 在 chrome、Firefox 和 IE 11 中工作。

有关更多信息和浏览器兼容性，请参阅： [https ://developer.mozilla.org/nl/docs/Web/JavaScript/Reference/Statements/const](https://developer.mozilla.org/nl/docs/Web/JavaScript/Reference/Statements/const)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-15T22:43:12.040

对不起，我不太懂英语。

我认为您的代码中存在一些问题。

1.  在服务器端赋值前后使用**单引号（'）**而不是**双引号（"） ；因为*****ResolveUrl***方法对其***字符串*****参数使用双引号**，并且这种双引号序列违反了 XHTML Well-Form ness 规则。

**   使用**等号（=）**而不是**井号（#）**。哈希符号应在**数据绑定**表达式中使用。

    *   您可以将完整的资源路径作为参数传递给***ResolveUrl方法。***

    *   如果**Scripts**文件夹在网站根目录下，则无需使用***ResolveUrl***；您可以只使用***“/Scripts/jquery-1.7.2.min.js”***作为***src***属性的值。

    *   为保证**jQuery**的准确性和完整性，请从其官网重新下载。

    *   IE 10 中存在一些 JavaScript 兼容性问题。使用**X-UA-Compatible**元标记来规范 IE。* 

 *应用前面几点后的代码：

```
<head runat="server">
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <script src='<%= ResolveUrl("~/Scripts/jquery-1.7.2.min.js") %>' type="text/javascript"></script>    
    <asp:ContentPlaceHolder ID="head" runat="server">
    </asp:ContentPlaceHolder> 
```

或者（没有服务器端路径解析）

```
<head runat="server">
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <script src="/Scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
    <asp:ContentPlaceHolder ID="head" runat="server">
    </asp:ContentPlaceHolder> 
```

祝你好运！

一些有用的链接：

*   [jQuery官方下载页面](http://msdn.microsoft.com/en-us/library/jj676915.aspx)
*   [在 IE 中指定旧文档模式](http://jquery.com/download/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-30T15:38:05.643

我解决它的方式： -

1) 在我的 cshtml 中删除了一些未使用的 javascript 代码。2）更正脚本链接以检查它们是否指向存在的库。3) 我正在调用一些不存在的 javascript，如 Ajax.BeginForm ， OnSuccess = "CloseWindow()" 和 CloseWindow() 不存在，所以要么添加函数，要么删除它。4) 在 web.config 中添加了这段代码

```
<location path="~/Scripts">
    <system.web>
      <authentication mode="None" />
           <authorization>
                   <allow users="?"/>
             </authorization>
     </system.web>
</location> 
```

我不确定是否需要执行第四步。但是堆栈溢出中的一篇帖子说：错误是因为浏览器需要访问脚本文件夹中的Javascript。我的项目是 Visual Studio 2013 中带有实体框架的 asp.net MVC。希望这会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-07-25T07:04:22.653

我的申请也有同样的问题。我从我的 ValidationScriptsPartial.cshtml 页面中删除了未使用的脚本文件。我正在开发 Asp.Net Core 应用程序。*

# rubymotion - 无论如何要加密 MotionModel 数据？

> ID：14448198
> 
> 赞同：0
> 
> 时间：2013-01-21T22:13:52.327
> 
> 标签：rubymotion

无论如何要为 MotionModel 加密数据吗？我正在看它，它看起来像是在写入文件。我不确定加密数据的最佳透明方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:05:52.807

I replied to this on the list, but to put this where SO readers can see it: MotionModel does not include any encryption technology. It does, however, include `before_save` and `after_save` as well as `before_delete` and `after_delete` hooks. Encryption could be placed in the the `before_save` hook method. That leaves the small matter of decryption which would be user implemented as-needed for display.

# php - 已弃用：函数 ereg() 在...中已弃用（Google 坐标地图）

> ID：14448200
> 
> 赞同：-1
> 
> 时间：2013-01-21T22:13:53.563
> 
> 标签：php

> **可能重复：**
> [如何在 PHP 中将 ereg 表达式转换为 preg？](https://stackoverflow.com/questions/6270004/how-can-i-convert-ereg-expressions-to-preg-in-php)

我从以下位置收到上述（主题）错误：

```
if (ereg('<coordinates>([0-9.-]{1,}),([0-9.-]{1,}).*</coordinates>', $result, $regs)) 
```

所以我这样做了：

```
if (preg_match('<coordinates>/[0-9.-]{1,}\/,\/[0-9.-]{1,}/.*</coordinates>/', $result, $regs)) 
```

现在谷歌地图根本不显示，它还警告“..找不到坐标......”

我哪里做错了？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:16:33.163

You need [delimiters](http://php.net/manual/en/regexp.reference.delimiters.php) around your pattern when using PCRE functions:

```
if (preg_match('~<coordinates>/[0-9.-]{1,}\/,\/[0-9.-]{1,}/.*</coordinates>/~', $result, $regs)) 
```

Notice the `~` at the beginning and end.
Normally, people use `/` as a delimiter, but because it shows up so frequently in your pattern, an alternate delimiter has been selected.

As @nickb mentioned, have a look at this discussion:
[How can I convert ereg expressions to preg in PHP?](https://stackoverflow.com/questions/6270004/how-can-i-convert-ereg-expressions-to-preg-in-php)

# python - 多边形与线的交点 | 蟒蛇匀称

> ID：14448203
> 
> 赞同：11
> 
> 时间：2013-01-21T22:14:04.473
> 
> 标签：python, line, polygon, intersection, shapely

我一直在尝试使用 shapely 来找到一条线和一个多边形的交点，但是我遇到了一些浮点数的问题。

示例代码：

```
polygon = [(4.0, -2.0), (5.0, -2.0), (4.0, -3.0), (3.0, -3.0), (4.0, -2.0)]
shapely_poly = shapely.geometry.Polygon(polygon)

line = [(4.0, -2.0000000000000004), (2.0, -1.1102230246251565e-15)]
shapely_line = shapely.geometry.LineString(line)

intersection_line = list(shapely_poly.intersection(shapely_line).coords)
print intersection_line 
```

我期望的是两个顶点的列表。

点 1：将在多边形内的点，或在本例中为 (4.0, -2.0000000000000004)。

点 2：[(4.0, -2.0000000000000004), (2.0, -1.1102230246251565e-15)] 和 [(3.0, -3.0), (4.0, -2.0)] 的交点。

但是，我收到的结果是：

```
[(4.0, -2.0000000000000004)] 
```

我还检查了我正在查看的边缘是否存在交叉点：

```
>>> edge = shapely.geometry.LineString([(3.0, -3.0), (4.0, -2.0)])
>>> edge.intersects(shapely_line)
False 
```

如果我将 (4.0, -2.0000000000000004) 替换为 (4.0, -2.000000000000000)，则边缘交点将评估为 True。

有没有人对正在发生的事情或我错过了什么有任何想法？谢谢！

![在此处输入图像描述](../Images/c2480171c5b71d45e43ef38b25bcdf17.png)

**编辑：**

我已经使用 shapely 版本 1.12 和 3.3.1、3.3.5、3.3.6、3.3.7 的 geos 进行了测试。

如果有人对我如何在 Windows 上更新 geos 版本感到好奇：

从 GEOS 网站下载了 geos-[version].tar.bz2。使用 Visual Studio 10 Win64 生成器提取文件并在其上运行 CMake。打开 .sln 文件并构建它，然后移动生成的 geos_c.dll 并将其粘贴到 Python 目录中 shapely 安装 geos_c.dll 的位置。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T00:11:30.977

Shapely 构建在 C++ GEOS 库周围的 C 包装器之上。在这个 C++ 库的某个[深处](http://svn.osgeo.org/geos/trunk/src/precision/)，有处理舍入错误的 Precision 类。我想我们可能会得出结论，您的 Shapely 版本和 geos 库以不同的方式处理这种情况。不幸的是，访问精度模型的代码在 C api 中不可用，因此在 Shapely 中也不可用。见[http://lists.gispython.org/pipermail/community/2011-February/002898.html](http://lists.gispython.org/pipermail/community/2011-February/002898.html)

不过，更改为更高版本的 geos 可能会解决您的问题。它在我的机器上运行良好，带有 1.2.16 和 libgeos 3.3.5-CAPI-1.7.5。

# javascript - 使用 javascript 验证表单

> ID：14448205
> 
> 赞同：0
> 
> 时间：2013-01-21T22:14:07.220
> 
> 标签：javascript, html

我根本不了解javascript，但我需要用它来验证我制作的表单上的输入。我看过很多例子，我真的不明白为什么它不起作用。当我点击提交时，什么都没有发生，它只是进入下一页，就像那里甚至没有任何 javascript 一样。抱歉，如果这是一个完全明显的答案，我没有使用 javascript 的经验，所以我不知道我在寻找什么。我正在同一页面上编写所有代码。谢谢你的帮助。

javascript:

```
<script type="text/javascript">
function validateform(theform) {
var reason = "";

reason += validateName(theform.name);
reason += validateSurname(theform.surname);
reason += validateEmail(theform.email);
reason += validateHomephone(theform.homephone);
reason += validateMobilephone(theform.mobilephone);
reason += validateAddress(theform.address);
reason += validateTown(theform.town);
reason += validateCounty(theform.county);
reason += validatePostcode(theform.postcode);
reason += validateEmpty(theform.empty);

if (reason != "") {
alert("Some fields need correction:\n" + reason);
return false;
}

alert("All fields are filled correctly");
return true;
}

function validateEmpty(fld) {
var error = "";

if (fld.value.length == 0) {
    fld.style.background = 'Yellow'; 
    error = "The required field has not been filled in.\n"
} else {
    fld.style.background = 'White';
}
return error;  
}

function validateName(fld) {
var error = "";
var illegalChars = ^[a-z\s]*$; // allow letters, numbers

if (fld.value == "") {
    fld.style.background = 'Yellow'; 
    error = "You didn't enter a name.\n";
} else if (illegalChars.test(fld.value)) {
    fld.style.background = 'Yellow'; 
    error = "The name contains illegal characters.\n";
} else {
    fld.style.background = 'White';
}
return error;
}

function validatSurname(fld) {
var error = "";
var illegalChars = ^[a-z\s]*$; // allow letters, numbers

if (fld.value == "") {
    fld.style.background = 'Yellow'; 
    error = "You didn't enter a surname.\n";
} else if (illegalChars.test(fld.value)) {
    fld.style.background = 'Yellow'; 
    error = "The surname contains illegal characters.\n";
} else {
    fld.style.background = 'White';
}
return error;
}

function validateEmail(fld) {
var error="";
var tfld = trim(fld.value);                        // value of field with whitespace   trimmed off
var emailFilter = /^[^@]+@[^@.]+\.[^@]*\w\w$/ ;
var illegalChars= /[\(\)\<\>\,\;\:\\\"\[\]]/ ;

if (fld.value == "") {
    fld.style.background = 'Yellow';
    error = "You didn't enter an email address.\n";
} else if (!emailFilter.test(tfld)) {              //test email for illegal characters
    fld.style.background = 'Yellow';
    error = "Please enter a valid email address.\n";
} else if (fld.value.match(illegalChars)) {
    fld.style.background = 'Yellow';
    error = "The email address contains illegal characters.\n";
} else {
    fld.style.background = 'White';
}
return error;
}

function validateHomenumber(fld) {
var error = "";
var stripped = fld.value.replace(/[\(\)\.\-\ ]/g, '');    

if (fld.value == "") {
    error = "You didn't enter a phone number.\n";
    fld.style.background = 'Yellow';
} else if (isNaN(parseInt(stripped))) {
    error = "The home phone number contains illegal characters.\n";
    fld.style.background = 'Yellow';
} else if (!(stripped.length == 11)) {
    error = "The home phone number is the wrong length.\n";
    fld.style.background = 'Yellow';
} else {
    fld.style.background = 'White';
}
return error;
}

function validateMobilenumber(fld) {
var error = "";
var stripped = fld.value.replace(/[\(\)\.\-\ ]/g, '');    

if (isNaN(parseInt(stripped))) {
    error = "The mobile phone number contains illegal characters.\n";
    fld.style.background = 'Yellow';
} else if (!(stripped.length == 11)) {
    error = "The mobile phone number is the wrong length.\n";
    fld.style.background = 'Yellow';
} else {
    fld.style.background = 'White';
}
return error;
}

function validateAddress(fld) {
var error = "";

if (fld.value == "") {
    error = "You didn't enter a home address.\n";
    fld.style.background = 'Yellow';

    }else {
    fld.style.background = 'White';
}
    return error;
}

function validateTown(fld) {
var error = "";

if (fld.value == "") {
    error = "You didn't enter a town or city.\n";
    fld.style.background = 'Yellow';

    }else {
    fld.style.background = 'White';
}
    return error;
}

function validateCounty(fld) {
var error = "";

if (fld.value == "") {
    error = "You didn't enter a county.\n";
    fld.style.background = 'Yellow';

    }else {
    fld.style.background = 'White';
}
    return error;
}

function validatePostcode(fld) {
var error = "";     
var illegalChars = ^[a-z\s]*$;
var regPostcode = /^([a-zA-Z]){1}([0-9][0-9]|[0-9]|[a-zA-Z][0-9][a-zA-Z]|[a-zA-Z][0-9][0-9]|[a-zA-Z][0-9]){1}([ ])([0-9][a-zA-z][a-zA-z]){1}$/;

if (fld.value == "") {
    error = "You didn't enter a post code.\n";
    fld.style.background = 'Yellow';
     } 
     else if (illegalChars.test(fld.value)) {
    fld.style.background = 'Yellow'; 
    error = "The post code contains illegal characters.\n";
    else if ((fld.value.length < 7) || (fld.value.length > 8)) {
    error = "The post code is the wrong length. \n";
    fld.style.background = 'Yellow';
} else if (regpostcode.test(fld.value)) {
fld.style.background = 'Yellow';
error = "The post code isn't the correct format.\n";
}
} else {
    fld.style.background = 'White';
}
return error;
}

function trim(s)
{
return s.replace(/^\s+|\s+$/, '');
} 
```

和html

```
</script>
</head>
<body> 
<table class="formy" border="o" cellpadding="2" cellspacing="5" bgcolor="#F4EC53"  align="center">
<th colspan="2" align="center">Booking Private Hire</th>
<form name="firstform" method="post" onsubmit="return validateform(this)"  action="secondform.php">
<table summary="first form">
<tr>
<td><label for="Name">First name:</label></td>
<td><input name="Name" size="35" maxlength="50" type="text"></td>
</tr>   
<tr>
<td><label for="Surname">Surname:</label></td>
<td><input name="Surname" size="35" maxlength="25" type="password"></td>
</tr>   
<tr>
<td><label for="Email">E-mail address:</label></td>
<td><input name="Email" size="35" maxlength="30" type="text"></td>
</tr>  
<tr>
<td><label for="Homephone">Home phone number:</label></td>
<td><input name="Homephone" size="35" maxlength="25" type="text"></td>
</tr>  
<tr>
<td>
    <label for="Mobilephone">Mobile phone number:</label></td>
<td><input name="Mobilephone" size="35" maxlength="50" type="text"></td>
</tr>  
<tr>
<td>
    <label for="Address">Home address:</label></td>
<td><input name="Address" size="35" maxlength="50" type="text"></td>
</tr>  
<tr>
<td>
    <label for="Town">Town/city:</label></td>
<td><input name="Town" size="35" maxlength="50" type="text"></td>
</tr> 
<tr>
<td>
    <label for="County">County:</label></td>
<td><input name="County" size="35" maxlength="50" type="text"></td>
</tr> 
<tr>
<td>
    <label for="Postcode">Post code:</label></td>
<td><input name="Postcode" size="35" maxlength="50" type="text"></td>
</tr> 

<td> </td>
<td><input name="Submit" value="Send" type="submit" ></td>
<td> </td>

</table>
</form> 
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:08:04.123

编辑：最终让它为我工作的是：您引用的字段名称与字段的实际名称不匹配。

```
reason += validateName(theform.name); 
```

变成

```
reason += validateName(theform.Name); 
```

此外，您的 javascript 代码中似乎存在错误：

这些行不解析：

```
var illegalChars = ^ [a - z\s] * $; // allow letters, numbers 
```

validatePostcode() 存在结构性问题。这个“else if”前面没有右括号。

```
else if ((fld.value.length < 7) || (fld.value.length > 8)) { 
```

你可能一直在追求：

```
 if (fld.value == "") {
        error = "You didn't enter a post code.\n";
        fld.style.background = 'Yellow';
    } else if (illegalChars.test(fld.value)) {
        fld.style.background = 'Yellow';
        error = "The post code contains illegal characters.\n";
    } else if ((fld.value.length < 7) || (fld.value.length > 8)) {
        error = "The post code is the wrong length. \n";
        fld.style.background = 'Yellow';
    } else if (regpostcode.test(fld.value)) {
        fld.style.background = 'Yellow';
        error = "The post code isn't the correct format.\n";
    } else {
        fld.style.background = 'White';
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:16:31.900

您似乎没有为变量“theform”分配任何内容。

我猜想发生了一个 JS 错误，使验证无用，所以表单只是被提交。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:30:36.940

根据您的代码并假设您熟悉 jQuery，尽管这样做可能有更简单的方法...

1）在你的函数中传递'this'

```
<form name="firstform" method="post" onsubmit="return validateform(this)"  action="secondform.php"> 
```

2) 验证功能

```
function validateform(myForm)
{
  $(myForm).find('input').each(function(){
     var val_trim = $.trim($(this).val());
     var input_name = $(this).attr('name');
     if(val_trim.length == 0)
     {
        return false;
     }
     else
     {
        if(input_name == 'Email')
        {
           validateEmail(val_trim); 
        }
        else if(input_name == 'Country')
        {
           ...
        } 
     }
  })
} 
```

# c++ - 无符号到有符号的转换，在位级别会发生什么？

> ID：14448206
> 
> 赞同：3
> 
> 时间：2013-01-21T22:14:10.350
> 
> 标签：c++, integer, bit-manipulation

> **可能重复：**
> [当二元运算符任一侧的符号不同时，提升规则如何工作？](https://stackoverflow.com/questions/6770258/how-do-promotion-rules-work-when-the-signedness-on-either-side-of-a-binary-opera)

从`unsigned`整数转换为`signed`整数时，我知道变量位的表示会发生变化。例如，从 转换为 时，255 可能变为`uint8`-1 `int8`。但是，我从来不确定底层位本身的“转换”或“转换”是什么。

我的问题是，整数变量的原始位模式是否保证在有`static_cast`符号和无符号类型之间保持不变，或者它是否有可能通过强制转换以某种方式进行转换？

出于好奇，`static_cast`整数标志类型之间是否会生成程序集，还是仅用于编译器知道要生成哪些 asm 指令？

编辑：

这是我想知道的那种场景的示例：

```
unsigned int uintvar = random();
unsigned int control = uintvar;
assert(control == static_cast<unsigned int>(static_cast<signed int>(uintvar))); 
```

忽略双重演员会被优化掉的事实，这个例子能保证永远成立吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T22:16:47.540

The bit pattern doesn't change at all (on most architectures you're likely to encounter in practice). The difference is in the instructions generated by the compiler to manipulate the values.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T22:17:37.093

If the unsigned value is too large to fit inside the signed counterpart then it's undefined behavior.

255 becomes -1 because those bits are -1 in two's compliment. Nothing happens with the bits.

# ruby-on-rails - 为什么 rspec 有这么多种测试？

> ID：14448207
> 
> 赞同：0
> 
> 时间：2013-01-21T22:14:10.860
> 
> 标签：ruby-on-rails, ruby, rspec, integration-testing, bdd

我很困惑。我应该在控制器文件夹中测试什么？返回成功代码的控制器操作？为什么，如果我可以通过一个命令在集成测试中做到这一点？什么是视图测试？测试视图是否有一些 html 标签？我也可以在集成测试中做到这一点。

模型需要测试验证规则吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:55:25.940

如果您只对单元（模型）和集成规范有信心，并且它为您的应用程序提供了足够的覆盖范围，您可以忽略其他的。如果你只做这两个，我可以告诉你，你做的比一般的开发者要多。大多数开发人员也只是使用这些。

但是当你有一个巨大的应用程序时，你应该考虑一下控制器测试很有用。我的意思是，在集成测试中，您不应该测试 http 响应或某些文本是否在 h1 HTML 标记内，因为如果您更改视图，则需要更改集成测试，而不仅仅是更改视图测试（如果有的话）。

有很多种测试，因此您可以将您的功能分解为多个部分，然后您可以查看到底出了什么问题。是模型上的吗？控制器？

但是完全不要强迫自己编写你觉得对你没有用的测试

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:56:17.743

在控制器规范中有一些更容易实现的测试。

一个例子：

场景：一个人想要测试对一组视图的授权访问（让我们假设非授权用户将被重定向到登录页面）。

集成测试方法：这可以通过集成测试来测试视图，这往往执行速度较慢（访问登录页面，填写凭据字段并按回车，访问页面进行测试......）

控制器测试方法：可以测试每个控制器的方法并检查响应代码。响应是重定向吗？（代码 200）。此外，由于控制器中的方法是 Rails 应用程序的入口点，因此可以肯定控制器规范涵盖了其他视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T02:46:31.083

我使用此指南[https://github.com/bbatsov/rails-style-guide#rspec](https://github.com/bbatsov/rails-style-guide#rspec)

你可以有很多集成测试，但它会很慢。我喜欢制作很多控制器、模型和视图规范，然后只做一些集成规范。

# ruby - 使用 Ruby 中的邮件 gem 发送电子邮件时，如何循环遍历数组？

> ID：14448209
> 
> 赞同：0
> 
> 时间：2013-01-21T22:14:18.620
> 
> 标签：ruby, email, gmail

我正在尝试使用 gmail gem 遍历*电子邮件正文中的*数组（据我所知，它使用邮件 gem 发送邮件）。

如何使用邮件 gem 遍历电子邮件正文中的数组？看起来很简单，但我做不到。

下面的方法不起作用，但显示了我想做的事情。

```
def deliver_mail(gmail, email, result, request_type)
  client = Mysql2::Client.new(:host => "localhost", :username => "root", :database => 'bigmake_development')
  investments = client.query("SELECT * FROM investments WHERE investor_id = '#{result[:id]}'")

  gmail.deliver do
    to email.from_addrs
    subject "My Subject!"

    body do
      investments.each do |i|
        i['target']
        i['deal_type']
        i['round']
        i['deal_date']
      end
    end  
  end
  puts "Email reply sent to #{email.from_addrs}"
end 
```

我见过的工作示例通常格式如下：

```
def deliver_mail(gmail, email, result, request_type)
  gmail.deliver do
    to email.from_addrs
    subject "My Subject!"
    body "Hello!"
    # or like this
    body File.load('body.txt')
  end
end 
```

但是，我认为这两种方法都不会很好地工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:19:13.907

你不只是想建立一个字符串吗？像这样的东西应该工作：

```
 body_content = ""
  investments.each do |i|
    body_content += "#{i['target']} #{i['deal_type']} #{i['round']} #{i['deal_date']}\n"
  end
  gmail.deliver do
    to email.from_addrs
    subject "My Subject!"
    body body_content
  end 
```

如果你想变得更复杂，我会研究类似[ERB](http://ruby-doc.org/stdlib/libdoc/erb/rdoc/ERB.html)的东西。

# java - 在谷歌应用引擎上保存转换后的图像

> ID：14448214
> 
> 赞同：1
> 
> 时间：2013-01-21T22:15:09.783
> 
> 标签：java, google-app-engine, blobstore

我有一个 JavaServletPage，您可以在其中上传和裁剪（使用 JCrop）图像。另一个 Servlet 处理请求并应用裁剪转换，但是如何保存新的转换图像？

我找到了一个需要另一个 Servlet 的解决方案（我还没有尝试过），它接受裁剪的图像并将其存储在 blobstore 中（再次通过 POST 方法）。但是对于这样一个简单的任务来说，这似乎真的很复杂。

还有其他方法可以保存我转换后的图像吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-30T19:47:34.143

应用转换后，您应该将文件保存到 Blobstore 或 Google Cloud Storage。这是一个示例：[https ://developers.google.com/appengine/docs/java/blobstore/#Writing_Files_to_the_Blobstore](https://developers.google.com/appengine/docs/java/blobstore/#Writing_Files_to_the_Blobstore)

# sql - PostgreSQL 查询导致 cpu 飙升至 100%。给定 90k 条记录，7000 的成本可以吗？

> ID：14448216
> 
> 赞同：5
> 
> 时间：2013-01-21T22:15:24.313
> 
> 标签：sql, ruby-on-rails, postgresql, delayed-job, postgresql-9.1

我正在努力了解如何使用成本和实际时间来优化查询。我的应用是带有 PostgreSQL 9.1 db 的 rails 3。Delayed_job 使用我的查询：

```
EXPLAIN ANALYZE SELECT  "delayed_jobs".*
FROM "delayed_jobs"
WHERE ((run_at <= '2011-05-23 15:16:43.180810' AND (locked_at IS NULL OR locked_at < '2011-01-25 11:05:28.077144') OR locked_by = 'host:foo pid:2') AND failed_at IS NULL AND queue = 'authentication_emails')
ORDER BY priority ASC, run_at ASC LIMIT 5 
```

或者：

```
EXPLAIN ANALYZE SELECT  "delayed_jobs".*
FROM "delayed_jobs"
WHERE ((run_at <= '2011-05-23 15:16:43.180810' AND (locked_at IS NULL OR locked_at < '2011-01-25 11:05:28.077144') OR locked_by = 'host:foo pid:2') AND failed_at IS NULL )
ORDER BY priority ASC, run_at ASC LIMIT 5 
```

对于第一个查询，输出等于：

```
Limit  (cost=7097.57..7097.57 rows=1 width=1008) (actual time=35.657..35.657 rows=0 loops=1)
  ->  Sort  (cost=7097.57..7097.57 rows=1 width=1008) (actual time=35.655..35.655 rows=0 loops=1)
        Sort Key: priority, run_at
        Sort Method: quicksort  Memory: 25kB
        ->  Seq Scan on delayed_jobs  (cost=0.00..7097.56 rows=1 width=1008) (actual time=35.648..35.648 rows=0 loops=1)
              Filter: ((failed_at IS NULL) AND ((queue)::text = 'authentication_emails'::text) AND (((run_at <= '2011-05-23 15:16:43.18081'::timestamp without time zone) AND ((locked_at IS NULL) OR (locked_at < '2011-01-25 11:05:28.077144'::timestamp without time zone))) OR (locked_by = 'host:foo pid:2'::text)))
Total runtime: 35.695 ms 
```

该表目前有 90k 条记录，范围为 0-200k。我们注意到此查询导致 CPU 出现峰值并导致瓶颈。从上面的解释信息中可以学到什么。如果有索引，应该在哪里添加？谢谢

**DB Schema.. 表有 0 个索引。**

```
 create_table "delayed_jobs", :force => true do |t|
    t.integer  "priority",   :default => 0
    t.integer  "attempts",   :default => 0
    t.text     "handler"
    t.text     "last_error"
    t.datetime "run_at"
    t.datetime "locked_at"
    t.datetime "failed_at"
    t.text     "locked_by"
    t.datetime "created_at",                :null => false
    t.datetime "updated_at",                :null => false
    t.string   "queue"
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T10:18:25.953

**分析**

如果您将[阅读 PostgreSQL 文档的这一部分](http://www.postgresql.org/docs/current/interactive/using-explain.html)，您将了解规划器如何使用统计信息来估算成本。这是非常有用的信息！

如果您说该表有大约 90k 条记录（并使用[默认成本](http://www.postgresql.org/docs/current/interactive/runtime-config-query.html#GUC-SEQ-PAGE-COST)），那么行处理的成本将是：

```
90000 * (cpu_tuple_cost + cpu_operator_cost) = 90000 * 0.0125 = 1125 
```

我们现在可以估计您的表格占用了多少页：

```
(7097.56-1125)/seq_page_cost = 5972.56 
```

这使得它大约为 46Mb（默认为 8k 页面大小）。因此，我假设您的表适合[shared_buffers](http://www.postgresql.org/docs/current/interactive/runtime-config-resource.html#GUC-SHARED-BUFFERS)，甚至是默认表。

查看我还假设的平均行宽，该表[主要存储为`MAIN`](http://www.postgresql.org/docs/current/interactive/storage-toast.html).

接下来，您将使用类型字段`text`和`string`谓词。不确定它们如何映射到 PostgreSQL 内部类型，但我认为它是`text`. 这种类型默认是可压缩的，因此 PostgreSQL 必须对每一行执行解压缩来检查谓词。我不确定在哪个阈值压缩开始之后，请查看[此消息](http://www.postgresql.org/message-id/23724.1093538844@sss.pgh.pa.us)（以及整个线程）。

**结论**

1.  你没有向我们展示真正的`EXPLAIN (analyze)`输出，因为我也不认为 35ms 查询会导致瓶颈，除了......
2.  您没有提到在瓶颈时刻有多少会话正在使用您的数据库，也不清楚该查询的运行频率。我认为这是一个非常受欢迎的。
3.  您的表似乎适合内存，因此在任何情况下所有操作*都将受*CPU 限制。
4.  谓词中使用的值是可压缩的，并且似乎已被压缩。

因此，我说瓶颈来自于对数据并行运行的峰值查询量，这需要额外的 CPU 周期进行解压缩。

**该怎么办？**

1.  规范化您的表格。感觉“队列”列的选择性很低。考虑为其创建[外部类型](http://www.postgresql.org/docs/current/interactive/sql-createtype.html)（如`ENUM`），或使用适当的外键组织字典表。我也不确定回合`locked_by`专栏，可以标准化吗？
2.  `run_at`在和`locked_at`列上创建索引。
3.  索引`ON priority, run_at`列将使您的排序受益，但我怀疑它在这种情况下会有所帮助。我假设该`priority`列的选择性较低，因此规划者会更喜欢使用`Bitmap And`on`Index Scans`和`run_at`列`locked_at`。

我希望我在这里没有大错:) 欢迎评论/更正！

PS让我知道它对你有什么好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:39:21.017

`Where should indexes be added?`

如前所述，特定的 SQL 查询没有可以作为索引的优秀候选者的列：如果您有大量历史数据，则在日期时间列上使用 < 运算符将返回（可能）一个大结果集。满足条件时从索引返回的结果集越大，索引在给定查询上下文中的效率越低（减少的能力越小）。此外，在某些数据库中，NULL 不会被索引，因此对 NULL 的任何测试都需要进行表扫描。不确定 PostgreSQL 9.1 关于索引中的 NULL 值。

# ruby-on-rails - 如何在 Rails 3.2 中正确添加验收验证器？

> ID：14448218
> 
> 赞同：0
> 
> 时间：2013-01-21T22:15:28.863
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, forms, validation

我想在我的表单中添加简单的术语验证器：

**模型**

```
attr_accessor :terms
validates :terms, :acceptance => {:accept => true}, :allow_nil => false 
```

**查看**（simple_form）

```
= simple_form_for @student, html: { multipart: true } do |f|
   ...
= f.input :terms, as: :select
= f.button :submit 
```

但我得到：

```
Can't mass-assign protected attributes: terms 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:21:18.877

您可以尝试：

```
field :terms, :type => Boolean, :default => false
attr_accessible :terms
validates :terms, :acceptance => {:accept => true} 
```

在你看来：

```
<%= f.input :agree, :as => :boolean, label: false %> 
```

问候！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:19:12.907

您不需要列或`attr_accessor`它，否则它将是一个类对象。

你能做的是

```
attr_accessible :terms
validates_acceptance_of :terms

<%= f.check_box :terms%> I agree to .... 
```

# actionscript-3 - AS3 重置 UrlLoader 缓存

> ID：14448219
> 
> 赞同：2
> 
> 时间：2013-01-21T22:15:29.767
> 
> 标签：actionscript-3, url, caching, urlloader

再会，

我在 Actionscript 3 中遇到了 UrlLoader 缓存的问题。我向 php 站点发出 UrlRequest 以获取时间戳。

当我第二次调用启动类（包含函数）时，结果是一样的。我必须关闭应用程序并重新启动它以获取新请求。

我试过“loader = new loader”。并且还使用标题。

[像这里这样](http://www.newtonflash.com/blog/as3/prevent-xml-caching-problem/#comment-43)为每个请求创建唯一 URL 的选项对我不起作用，因为它会破坏我的 php 操作。

```
 loader = new URLLoader();
   var request:URLRequest = new URLRequest("http://www.mySite.com/getTime.php?action=getTime");
   loader.load(request); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:20:10.847

向您的请求添加随机参数不会以任何方式破坏您的 php：

```
loader = new URLLoader();
var request:URLRequest = 
    new URLRequest(
   "http://www.mySite.com/getTime.php?action=getTime&bogus="+(Math.random() * 10000));
loader.load(request); 
```

您的 php 代码将 GET`action`参数，并将忽略该`bogus`参数，而不会对您的代码产生任何影响。

您还可以使用基于时间的随机数来避免太倒霉并两次获得相同的值。

# sql-server - 每分钟 SQL Server 行数

> ID：14448223
> 
> 赞同：0
> 
> 时间：2013-01-21T22:15:47.643
> 
> 标签：sql-server, datetimeoffset

对不起，我想不出更好的标题。

我有一个表，每次有人点击我的 JSON api 时都会插入一行。本质上，它有 2 列，`Ipaddress`( `nvarchar`) 和`date`( `datetimeoffset`)。

我的部分问题是，我不确定如何定义我想要的数据，但总的来说，我试图弄清楚是否有人在我的 api 上玩恶作剧。

我认为我正在寻找的是每个 IP 地址每秒/分钟的平均请求数。

谁能帮我写一个这样的查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:19:10.077

To see today, by IP, per minute:

```
DECLARE @day DATE = CURRENT_TIMESTAMP;

WITH x AS (
  SELECT Ipaddress, m = DATEADD(MINUTE, DATEDIFF(MINUTE, @day, [date]), @day)
  FROM dbo.tablename
  WHERE CONVERT(DATE, [date]) = @day
)
SELECT Ipaddress, m, c = COUNT(*)
  FROM x 
  GROUP BY Ipaddress m
  ORDER BY c DESC; -- OR ORDER BY m 
```

You could further derive averages from that data and filter depending on what you consider to be indicative of "shenanigans"...

# php - htaccess clean-urls $_GET 为空

> ID：14448224
> 
> 赞同：1
> 
> 时间：2013-01-21T22:16:03.210
> 
> 标签：php, .htaccess, mod-rewrite, clean-urls

我有以下网址：

```
http://www.domain.gr/add-event?state=3cb7a28b14112d3f3ecada3d6915ac5f&code=AQAZeWtJgz1ZYWvsorRPiMRetkNhnU3NrQ9KYzIRkogUpg6IPHCkFCAWMBUYGYtulfWnr5JHWs2GbrBUAp89pVLStyKs_rer2r14yLI6qdByoqEv1TtHGK4TPzdLFRTgXZEzPEUyk9ixYQfdmZid0dRdTfVXDPqniCKnu8RHQb1ErRDezsdI2CcYsTxofe_wwtZYVD3d4r9VtlANrGn_klP1#_=_ 
```

我的 RewriteRule 与[http://www.doamin.gr/news/date/title-of-article](http://www.doamin.gr/news/date/title-of-article)等 'news' 设置为 $_GET['page'] 和 $_GET['request'] 为 '/date /title-of-article' 我的 htaccess 具有以下代码以提供干净的 url：

```
RewriteCond %{REQUEST_FILENAME} !-f
#RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)(.*)$ /index.php?page=$1&request=$2 
```

使用上面的 url $_GET 设置如下：

$_GET['page'] = '添加事件'; $_GET['请求'] = ''; // 空白的

在这种情况下，我应该如何修改 reqriteRule 以获取 url 的剩余部分？（不会弄乱我的干净 url）。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-21T22:23:15.637

您的第一个子模式`([^/]*)`是**贪婪模式**。这意味着表达式将匹配输入字符串的最大可能子字符串（并且由于表达式匹配除`/`字符之外的所有内容，因此它将匹配整个字符串——随后，第二个子模式将不匹配任何内容）。

您可以将子模式标记**为非贪婪**或**惰性**（即`([^/]*?)`），但随后它将仅匹配`/`字符。您可以修改模式以匹配 URL 查询部分开头的所有内容：`^([^/]*?)\?`

# c++ - Boost asio http async_client example warning with helgrind: False positive?

> ID：14448227
> 
> 赞同：4
> 
> 时间：2013-01-21T22:16:15.233
> 
> 标签：c++, boost-asio, valgrind

When running the http [async_client](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/example/http/client/async_client.cpp) example of the official boos asio example code in helgrind, there is a warning. This code from the file `boost/asio/detail/posix_event.hpp` seems to be the cause of the warning:

```
// Signal the event and unlock the mutex.
template <typename Lock>
void signal_and_unlock(Lock& lock)
{
    BOOST_ASSERT(lock.locked());
    signalled_ = true;
    lock.unlock();
    ::pthread_cond_signal(&cond_); // Ignore EINVAL.
} 
```

Here is the full output of valgrind/helgrind:

```
jcm@Ubuntu:~/samples/async-client/build$ valgrind --tool=helgrind ./async-client stackoverflow.com error.html
==2894== Helgrind, a thread error detector
==2894== Copyright (C) 2007-2011, and GNU GPL'd, by OpenWorks LLP et al.
==2894== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==2894== Command: ./async-client stackoverflow.com error.html
==2894== 
==2894== ---Thread-Announcement------------------------------------------
==2894== 
==2894== Thread #1 is the program's root thread
==2894== 
==2894== ----------------------------------------------------------------
==2894== 
==2894== Thread #1: pthread_cond_{signal,broadcast}: dubious: associated lock is not held by any thread
==2894==    at 0x4C2C978: ??? (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)
==2894==    by 0x4C2E5EA: pthread_cond_signal@* (in /usr/lib/valgrind/vgpreload_helgrind-amd64-linux.so)
==2894==    by 0x43FCB2: void boost::asio::detail::posix_event::signal_and_unlock<boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex> >(boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>&) (in /home/jcm/samples/async-client/build/async-client)
==2894==    by 0x43B659: boost::asio::detail::task_io_service::wake_one_idle_thread_and_unlock(boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>&) (in /home/jcm/samples/async-client/build/async-client)
==2894==    by 0x43B68A: boost::asio::detail::task_io_service::wake_one_thread_and_unlock(boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>&) (in /home/jcm/samples/async-client/build/async-client)
==2894==    by 0x43B0B8: boost::asio::detail::task_io_service::post_immediate_completion(boost::asio::detail::task_io_service_operation*) (in /home/jcm/samples/async-client/build/async-client)
==2894==    by 0x43DBFD: boost::asio::detail::resolver_service_base::start_resolve_op(boost::asio::detail::task_io_service_operation*) (in /home/jcm/samples/async-client/build/async-client)
==2894==    by 0x442F86: void boost::asio::detail::resolver_service<boost::asio::ip::tcp>::async_resolve<boost::_bi::bind_t<void, boost::_mfi::mf2<void, client, boost::system::error_code const&, boost::asio::ip::basic_resolver_iterator<boost::asio::ip::tcp> >, boost::_bi::list3<boost::_bi::value<client*>, boost::arg<1> (*)(), boost::arg<2> (*)()> > >(std::shared_ptr<void>&, boost::asio::ip::basic_resolver_query<boost::asio::ip::tcp> const&, boost::_bi::bind_t<void, boost::_mfi::mf2<void, client, boost::system::error_code const&, boost::asio::ip::basic_resolver_iterator<boost::asio::ip::tcp> >, boost::_bi::list3<boost::_bi::value<client*>, boost::arg<1> (*)(), boost::arg<2> (*)()> >) (in /home/jcm/samples/async-client/build/async-client)
==2894==    by 0x44187E: void boost::asio::ip::resolver_service<boost::asio::ip::tcp>::async_resolve<boost::_bi::bind_t<void, boost::_mfi::mf2<void, client, boost::system::error_code const&, boost::asio::ip::basic_resolver_iterator<boost::asio::ip::tcp> >, boost::_bi::list3<boost::_bi::value<client*>, boost::arg<1> (*)(), boost::arg<2> (*)()> > >(std::shared_ptr<void>&, boost::asio::ip::basic_resolver_query<boost::asio::ip::tcp> const&, boost::_bi::bind_t<void, boost::_mfi::mf2<void, client, boost::system::error_code const&, boost::asio::ip::basic_resolver_iterator<boost::asio::ip::tcp> >, boost::_bi::list3<boost::_bi::value<client*>, boost::arg<1> (*)(), boost::arg<2> (*)()> >&&) (in /home/jcm/samples/async-client/build/async-client)
==2894==    by 0x44097E: void boost::asio::ip::basic_resolver<boost::asio::ip::tcp, boost::asio::ip::resolver_service<boost::asio::ip::tcp> >::async_resolve<boost::_bi::bind_t<void, boost::_mfi::mf2<void, client, boost::system::error_code const&, boost::asio::ip::basic_resolver_iterator<boost::asio::ip::tcp> >, boost::_bi::list3<boost::_bi::value<client*>, boost::arg<1> (*)(), boost::arg<2> (*)()> > >(boost::asio::ip::basic_resolver_query<boost::asio::ip::tcp> const&, boost::_bi::bind_t<void, boost::_mfi::mf2<void, client, boost::system::error_code const&, boost::asio::ip::basic_resolver_iterator<boost::asio::ip::tcp> >, boost::_bi::list3<boost::_bi::value<client*>, boost::arg<1> (*)(), boost::arg<2> (*)()> >&&) (in /home/jcm/samples/async-client/build/async-client)
==2894==    by 0x43E05F: client::client(boost::asio::io_service&, std::string const&, std::string const&) (in /home/jcm/samples/async-client/build/async-client)
==2894==    by 0x437018: main (in /home/jcm/samples/async-client/build/async-client)
==2894== 
Response returned with status code 400
==2894== 
==2894== For counts of detected and suppressed errors, rerun with: -v
==2894== Use --history-level=approx or =none to gain increased speed, at
==2894== the cost of reduced accuracy of conflicting-access information
==2894== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 89 from 29) 
```

I seems wrong to me that mutex is unlocked before the condition variable is signalled. In case it's a false positive, please let me know why the above code is correct.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:31:38.453

假设这是匹配调用中使用的`lock`相同对象的包装器对象，pthreads 的大多数实现将允许您以任一顺序发出信号和解锁，因为被定义为在条件变量上解除阻塞并获取互斥锁作为一个*原子操作*——也就是说，它不会成功返回，直到*CV*已经发出信号并且调用线程已经获取了互斥锁。`pthread_mutex_t``pthread_cond_(timed)wait``pthread_cond_(timed)wait`

 **互联网谣言表明，无论按什么顺序执行此操作，都没有人会*失败*，但是一些线程调度程序的编写是为了在信号之后发生解锁时实现最高效率——而另一些线​​程调度程序是为了在信号之前发生解锁时实现最高效率而编写的，这意味着无论您如何编写它，您都无法一直获胜。就个人而言，如果我维护有问题的代码，我会仅仅因为它让 helgrind 高兴而改变顺序。您不想费力通过垃圾投诉来找到真正的比赛条件。

我在我的 POSIX API botches 列表中添加了“`pthread_cond_signal`应该同时使用 CV 和互斥锁，就像`pthread_cond_wait`当我得到一台时间机器时要修复的那样”。**

# templates - how to make a domain object(data) available everywhere? Grails

> ID：14448237
> 
> 赞同：0
> 
> 时间：2013-01-21T22:16:58.227
> 
> 标签：templates, grails, dns

> I want to know how to make a domain object or its data available across the system everywhere in grails?
> 
> Like sort of syntex do i need to use to make it happen. ATM my app's user object/instance is only available on one of my 3 templates not even any other view.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:36:15.027

它对这些视图可用的原因是您的[控制器正在将模型推送到这些视图](http://grails.org/doc/latest/guide/theWebLayer.html#modelsAndViews)。没有什么可以阻止您从您想要的任何控制器/服务中使用您的域。

例如，我可以执行以下操作：

```
class HomeController {

  def index() {
    def users = User.list()
    render view: "list", model: [users: users]
  }
} 
```

请注意我是如何完全脱离惯例的，但它仍然有效。

# ruby - 如何获取 ruby DataMapper::Collection 的所有不同属性值？

> ID：14448240
> 
> 赞同：1
> 
> 时间：2013-01-21T22:17:28.710
> 
> 标签：ruby, database, ruby-datamapper

我正在使用`ruby 1.9.3`ruby​​-datamapper 和`postgresql`. 我有一个充满条目的表，每个条目都有三个属性`id`：`text`和`created_at`。最后一个是`Date`对象。

在我的应用程序中，我的`SELECT`一些条目是这样的：`collection = Entry.all(:text => /SomeRegexp/)`。我现在想知道返回的所有**不同**的值。我想到了以下两种方法：`created_at``DataMapper::Collection`

1.  遍历`DataMapper::Collection`并收集所有日期。

    ```
    dates = Array.new
    Entry.all(:text => /SomeRegexp/).each { |entry| dates.include?(entry.date) ? next : dates = dates << entry.date } 
    ```

    **优点：**

    *   它应该工作

        * * *

    **缺点：**

    *   海量数据速度很慢

        * * *

2.  向数据库询问每天的条目并收集 collection != nil 的日期

    ```
    dates = Array.new
    for date in DatabaseStartDate..Date.today
      Entry.all(:created_at => date, :text => /SomeRegexp/).empty? ? next : dates = dates << date)
    end 
    ```

    **优点：**

    *   应该比上面的例子更快，尤其是在有大量数据的情况下

        * * *

    **缺点：**

    *   许多数据库查询

* * *

*注意：上面的代码是未经测试的伪代码，它应该只是让读者大致了解真实代码应该做什么，所以它不太可能工作。如果您需要更详细的示例，请随时发表评论，我会尝试更好地解释它！*

*下一条通知：如果您发现伪代码中有错误，请告诉我，这样我可以更快地开始！;)*

所以最后我的问题是：我应该更喜欢哪种解决方案，或者我没有想到更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T20:08:07.577

第三个选项：原始 SQL。

```
repository(:default).adapter.select('SELECT created_at FROM entries WHERE text SIMILAR TO ' + pattern) 
```

其中模式将是类似于[http://www.postgresql.org/docs/8.3/static/functions-matching.html中的表达式](http://www.postgresql.org/docs/8.3/static/functions-matching.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T14:28:43.623

好的，我做了一些测试，这是我的结果：

解决方案 #1 对于少量数据来说要快一些，但对于 >10_000 条记录，第二个解决方案显然更快。

通过仅选择一个需要的元素，可以提高这两种解决方案的性能，例如。`Entry.all(:text => /SomeRegexp/, :fields => [:id, :date])`

两个代码片段都对我有用。

如果您知道更好的解决方案（可能是内置在 datamapper 甚至 postgresql 中的），请重新回答问题！;)

# css - 具有灵活宽度内容的固定宽度浮动 div

> ID：14448241
> 
> 赞同：0
> 
> 时间：2013-01-21T22:17:32.370
> 
> 标签：css, css-float

我在一个固定宽度的容器中有内容，我试图像这样格式化：

```
Description: [button][button] 
```

基本上，描述标签占50%，按钮控件占50%。我通过像这样浮动描述来做到这一点：

```
<div style="width: 300px;">
  <div style="width: 145px; margin-right: 5px; float: left;">Description:</div>
  <div>[button][button]</div>
</div> 
```

如果按钮多于右侧，而不是像这样包装：

```
Description: [button][button]
[button][button] 
```

我宁愿布局看起来像：

```
Description: 
[button][button][button][button] 
```

所以基本上，我很难想出一个简单的布局，它将描述标签保持在 50% 宽度，保持控件展开并处理上述两种情况。我很肯定我错过了一些简单的东西 - 任何指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:23:25.513

[你可以在 JsBIN 上](http://jsbin.com/okesuz/2/edit)看到我的演示

使用该`white-space`属性来防止换行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:24:51.003

您可以在此 jsFiddle [http://jsfiddle.net/UGEBM/1/](http://jsfiddle.net/UGEBM/1/)`white-space`上使用和的组合`float`

# iphone - CCLayer Subclass randomly crashes when adding CCSprite

> ID：14448242
> 
> 赞同：0
> 
> 时间：2013-01-21T22:17:34.410
> 
> 标签：iphone, objective-c, macos, cocos2d-iphone

For some reason, whenever I call my CCLayer subclass within a block that is being executed else where the code seems to crash with EXE_BAD_ACCESS.

```
[[DataModel sharedInstance] saveWithSuccess:^{
                CCAlertView *alertView = [[CCAlertView alloc] initWithMessage:@"Unsaved Changes" detail:@"You have unsaved changes, would you like to save?" andButtons:@[@"Save", @"Continue", @"Cancel"]];
                alertView.delegate = (id <CCAlertViewDelegate>)self;
                [self.controls addChild:alertView z:100 tag:kAlertViewTag];
            } failure:^{
                CCAlertView *alertView = [[CCAlertView alloc] initWithMessage:@"Save Failed" detail:nil andButtons:@[@"Okay"]];
                alertView.delegate = (id <CCAlertViewDelegate>)self;
                [self.controls addChild:alertView z:100 tag:kAlertViewTag];
}]; 
```

I'm not exactly sure on what I am doing wrong, is it the block that is throwing it off? I use this line on code in other places and it works.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:29:14.660

啊意识到我需要使用添加视图

```
[[NSOperationQueue mainQueue] addOperationWithBlock:^{}]; 
```

# php - Convert any string number into integer type in PHP considering toInt returns 0 for fail instead of false

> ID：14448244
> 
> 赞同：2
> 
> 时间：2013-01-21T22:17:48.433
> 
> 标签：php

How do I write a function that returns FALSE if a given string is NOT A VALID NUMBER OF TYPE [PHP INT], and returns TRUE otherwise.

This is simple in other languages.

intval(), isint(), and is_numeric() are not adequate, here is why:

is_numeric() is not adequate because it matches to any number not just integers, also it accepts huge numbers as numeric, which aren't integers. intval() is not adequate because it returns 0 for BOTH invalid PHP integers like '9000000000000000' AND the valid PHP integer '0' or '0x0' or '0000' etc. isint() only tests if a variable is already of type int, it doesn't deal with strings or conversion to int.

Maybe there is a popular library for this or something?

I want to call a function that is capable of detecting whether the form data someone posts is a valid php integer, for instance.

I want to call the function that does this: is_php_integer($str_test_input). What goes in the function?

```
<?php

$strInput = 'test' //function should return FALSE
$strInput = '' //function should return FALSE
$strInput = '9000000000000000'  //function should return FALSE since
                            //is not valid int in php
$strInput = '9000' //function should return TRUE since
                    //valid integer in php
$strInput = '-9000' // function should return TRUE
$strInput = '0x1A' // function should return TRUE
                    // since 0x1A = 26, a valid integer in php
$strInput = '0' // function should return TRUE, since
                    // 0 is a valid integer in php
$strInput = '0x0' // function should return TRUE, since
                    // 0x0 = 0 which is a valid integer in php
$strInput = '0000' // function should return TRUE, since
                    // 0000 = 0 which is a valid integer in php

function is_php_integer($strTestInput) {
    // what goes here?
    // ...
    // if string could be interpreted as php integer, return true
    // else, return false
}

if is_php_integer($strInput) {
    echo 'your integer plus one equals: '. (intval($strInput) + 1);
} else {
    echo 'your input string is not a valid php integer'
}

?> 
```

Thanks in advance!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:22:54.950

```
<?php

$input = array(
    'test',
    '',
    '9000000000000000',
    '9000',
    '-9000',
    '0x1A',
    '0',
    '0x0',
    '0000'
);

function is_php_integer($strTestInput) {
    return filter_var( $strTestInput, FILTER_VALIDATE_INT, array('flags' => FILTER_FLAG_ALLOW_OCTAL | FILTER_FLAG_ALLOW_HEX));

}

foreach ( $input as $value ) {
    if (is_php_integer($value) !== FALSE) {
        echo 'your integer plus one equals: '. (intval( $value ) + 1) . PHP_EOL;
    } else {
        echo 'your input string is not a valid php integer' . PHP_EOL;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T22:30:47.457

您可以使用[filter_var](http://php.net/manual/en/function.filter-var.php)。`FILTER_FLAG_ALLOW_HEX`标志对于`0x1A`and是必要的`0x0`，`FILTER_FLAG_ALLOW_OCTAL`对于 也是必要的`0000`。

```
function is_php_integer($strInput) {
    return filter_var(
        $strInput, FILTER_VALIDATE_INT,
        FILTER_FLAG_ALLOW_OCTAL | FILTER_FLAG_ALLOW_HEX
    ) !== false;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T22:24:27.583

```
function is_php_integer($strInput) {
    return false !== filter_var($strInput, FILTER_VALIDATE_INT, FILTER_FLAG_ALLOW_HEX);
} 
```

另外，考虑[`filter_input`](http://php.net/manual/en/function.filter-input.php)直接过滤表单数据。

# android - Monkeyrunner colors outside the lines on a Galaxy Nexus but not on the emulator

> ID：14448246
> 
> 赞同：1
> 
> 时间：2013-01-21T22:18:12.003
> 
> 标签：android, monkeyrunner

If I run the following command on a Galaxy Nexus running Jellybean 4.2, Monkey "spills over" into non-app activities.

```
adb shell monkey -p com.mypackage -v 1000 
```

For example, it ends up executing presses in the settings activity, changing phone volume, turning on/off wifi, etc.

However, if I run the same command on the emulator, I never have this problem.

Is this a device vs. emulator problem? Is it particular to some devices and not others? Is there a known workaround?

# oop - MATLAB: Function to display name of class instance (object)

> ID：14448253
> 
> 赞同：3
> 
> 时间：2013-01-21T22:19:08.960
> 
> 标签：oop, matlab

I am stuck with what I expect should be something relatively simple to do. I am writing a class `Superclass` such that:

```
 Superclass < handle 
```

and then:

```
MyClass < Superclass 
```

`MyClass` contains function `DisplayObjectName`, which should do what the name suggests. That is, display the name of the class instance (object).

For example, I create an object:

```
TestObject = MyClass(inputvariable); 
```

Then I would like to have a function such that when I call

```
TestObject.DisplayObjectName() 
```

the output would be

```
ans = TestObject 
```

I could not seem to find a way to do that. Any ideas? Any help would be very much appreciated.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:45:35.580

该`inputname`功能似乎可以解决问题。

```
classdef SuperClass < handle
    methods
        function displayObjectName(self)
            disp(inputname(1))
        end
    end
end 
```

然后

```
classdef MyClass < SuperClass
end 
```

和

```
>> TestObject = MyClass;
>> TestObject.displayObjectName
TestObject 
```

# java - 从每一行中删除特定文本

> ID：14448258
> 
> 赞同：0
> 
> 时间：2013-01-21T22:19:15.220
> 
> 标签：java, string

我有大约一千行类型：

```
<option value="1436">Some text
<option value="36">Some text 
```

我想存储一个新文件，而不`<...>`参与其中。我正在写的代码是：

```
try{
    FileInputStream fs= new FileInputStream(f);
    Scanner s= new Scanner(fs);
    while (s.hasNext()){
        String sentence=s.nextLine();
        int l=sentence.length();
        try{//printing P
            BufferedWriter bw = new BufferedWriter(new FileWriter("Ps.txt"));
            for (int i=0;i<l;i++){
                if (sentence.charAt(i)=='>'){
                    for (int j=i+1;j<l;j++)
                    bw.write(sentence.charAt(j));
                }
                bw.newLine();
            }
            bw.close();
        }   
        catch(Exception e){}
    }
} 
```

但是，它只在输出文件中存储 3-4 行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:29:06.093

您在 while 循环中打开和关闭文件。您需要将其移到主循环之外，因此您打开文件一次不要关闭文件，直到结束。

因此，循环的每次迭代，您都会覆盖文件，因此文件的内容将只是循环的最后一次迭代计算的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:24:10.947

如果使用 sed 是一个选项，那么

`cat file1 | sed 's/\<.*\>//' > file2`

应该做的伎俩

# javascript - 鼠标悬停时如何获取元素的索引值？

> ID：14448259
> 
> 赞同：0
> 
> 时间：2013-01-21T22:19:15.877
> 
> 标签：javascript, indexing, click, this, onmouseover

我试图在鼠标悬停时获取元素的索引号。
我可以用 jQuery 轻松做到这一点，但原生 javascript 是防弹的 /：

[这是jsFiddle](http://jsfiddle.net/5DAFx/1/)

```
var ele = document.getElementsByClassName('sample')[0];

for(i=0; i<ele.children.length;i++){
    ele.children[i].onmouseover = function() {
        this.style.background='red';
        alert(i);//can't get the value
    }
}

<ul class="sample">
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:23:18.157

使用立即函数来修复当前迭代的 i 值：

```
for(i=0; i<ele.children.length;i++){
    (function(i) {
        ele.children[i].onmouseover = function() {
            this.style.background='red';
            alert(i);
        }
    }(i));
} 
```

这是一个更新的[小提琴](http://jsfiddle.net/sD4aW/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T22:22:11.030

那是因为`i`已经被覆盖了，将它存储在一个属性中：

```
ele.children[i].onmouseover = function() {
    this.style.background='red';
    alert(this.getAttribute('data-index'));
};
ele.children[i].setAttribute('data-index', i); 
```

[**演示**](http://jsfiddle.net/rgHBD/)

或者使用闭包：

```
ele.children[i].onmouseover = (function (index) {
    return function () {
        this.style.background = 'red';
        alert(index);
    };
}(i)); 
```

[**演示**](http://jsfiddle.net/9JNgh/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T22:21:33.180

试试这个：

```
function callback(i) {
    return function() {
        this.style.background = "red";
        alert(i);
    };
}

for (var i = 0; i < ele.children.length; i++) {
    ele.children[i].onmouseover = callback(i);
} 
```

# php - Efficiently render pagination data via custom layouts?

> ID：14448260
> 
> 赞同：0
> 
> 时间：2013-01-21T22:19:18.757
> 
> 标签：php, cakephp, cakephp-2.2

# Current Approach

Currently I render all my pagination results in a single element using a `<table>` that has a header, body and footer structure. The rendering style is very spreadsheet like and this one element can handle paginated results for multiple controllers.

# The Problem

I need to now support configurable rendering styles for the paginated results. The two main styles are spreadsheet and [pinterest.com](http://pinterest.com) style (by pinterest I refer to vertical columns of varying lengths).

# How To Implement

I'm looking for an answer on how to implement this using CakePHP 2.2 view features. Blocks, themes, and nested views. So that as much of the code is dry, and the configured part only applies the styling that is different.

The code to render the values in each tablet cell, the record title, and details like that should all be separated from the code that renders it either as a table or pinterest (or what ever you call that style).

# Challenges

Each method in Cake seems to present limitations. What approach bests deals with the following?

*   When each record is rendered, it will need different pre/post tags, and the same for each field in that record. Those tags are defined a lot by the style renderer.
*   I may need to add features in the future like AJAX editing of a field value, and shouldn't need to modify the style handlers. So the style renderer should just deal with style.
*   A lot of my style tags will involve `wrapping` presented data. What CakePHP method works best for that?
*   What's the best way to configure this? So that the paginate element knows which style to render.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T22:46:52.490

我最近不得不使用定义列表的无序列表来做到这一点。在保持代码 DRY 的同时执行此操作的关键是使用元素。元素是存在于文件夹 Views/Elements 中的 ctp 文件

在我的 index.ctp 中，我将表格更改为 ul 标签，将 tr 标签更改为 li 标签，并调用元素来处理渲染 dl。使用数组将对象及其类型传递给元素，剩下的可以用css完成

索引.ctp：

```
<ul><?php
  foreach ($blobs as $blob){
   echo $this->Html->tag('li',$this->element('dl',array('blob'=>$blob,'type'=>'Blob')));
  }
?></ul> 
```

dl.ctp：

```
<dl class="<?php echo $type;?>"><?php
  foreach ($blob[$type] as $key => $v){
    echo $this->Html->tag('dt',$key);
    echo $this->Html->tag('dd',$v);
  }
?></dl> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:37:58.810

您最好的选择可能是使用 CSS；你会惊讶于你能用它做什么。您甚至可以将表格从矩形布局“翻转”到垂直布局（例如在移动屏幕上），这似乎与您想要的很接近。

# java - 在java中保留unicode

> ID：14448263
> 
> 赞同：-1
> 
> 时间：2013-01-21T22:19:33.670
> 
> 标签：java, unicode

我正在尝试使用 unicode 字符“ `\u65e5\u672c\u8a9e\u6587\u5b57\u5217`”打印一个字符串

我怎样才能打印相同的？Java 将上述字符串转换为不可读的格式，就好像它正在使用其默认的 unicode 字符转换。我怎样才能避免它发生？

我在 OS X 上运行它。

Edit1：请提供不添加反斜杠的解决方案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:22:19.143

如果您要准确打印，则需要转义反斜杠：

```
\\u65e5\\u672c\\u8a9e\\u6587\\u5b57\\u5217 
```

编辑：如果这不好，或者即使是这样，请查看[这个答案](https://stackoverflow.com/a/2406827/781965)-[`escapeJava`](http://commons.apache.org/lang/api-release/org/apache/commons/lang3/StringEscapeUtils.html#escapeJava%28java.lang.String)来自 Apache commons 听起来可能是您正在寻找的。或者也许是其中一种`escapeHtml`方法？我不完全确定是否`escapeJava`适用于 unicode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:33:22.147

逃避你的反斜杠

```
String s = "\\u65e5\\u672c\\u8a9e\\u6587\\u5b57\\u5217"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:50:03.863

可以对字符串中的每个字符执行以下操作`ch`：

```
 int c = ch;
  printf("\\u%04x", c); 
```

# safari-extension - 导致重新加载的 Safari 扩展，.js 似乎被一遍又一遍地添加

> ID：14448268
> 
> 赞同：2
> 
> 时间：2013-01-21T22:20:15.897
> 
> 标签：safari-extension, safari6

这里的上下文是一个 Safari 扩展，脚本作为“结束脚本”添加到扩展中。目的是让 Safari 上的 MS 交换 Web 访问不那么痛苦，只需定期刷新……我注意到的主要事情是，根据网络检查器，它每次重新加载都会添加这个 .js 文件。

![在此处输入图像描述](../Images/8d4d553857f26689a5270dc4990ba459.png)

这是代码，如果相关的话：

```
if (window.top === window) {
    var whitelistURLPartials = ["ae\=Folder","ae\=Item\&t\=IPM.Note\&id"];

    var current = window.location.href;
    for (var index in whitelistURLPartials)
    {
        if(current.match(whitelistURLPartials[index]))
        {
            window.setTimeout(function(){document.location.reload(true)},1000*60);
            break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T06:29:18.243

我不确定您想要实现什么，当您进行比赛时，您将被绑定到无限循环的永远加载页面。

**我在Chrome Extensions**和**Safari 5.1.7**中尝试了您的场景，它们没有像您的屏幕截图中那样添加。

您的脚本是多次执行还是只是视觉上的错误？

# python - 有没有办法让 QLineEdit 表现得像 QInputDialog？

> ID：14448275
> 
> 赞同：0
> 
> 时间：2013-01-21T22:20:54.383
> 
> 标签：python, pyqt4

我正在使用 PyQt 开发基于文本的游戏。我有一个用于“窗口”的 QTextDisplay 和一个用于实际提示的 QLineEdit。它们被连接起来，因此当用户在行编辑中按回车键时，它会出现在文本显示中。不幸的是，这需要一个 GUI 应用程序而不是一个简单的命令程序，因为需要有图片（不是我的决定）。

我希望执行暂停并等待用户输入到行编辑中（很像`input()`在命令应用程序中的工作）。QInputDialog 以这种方式运行，除了启动一个对话框。这很麻烦。我已经尝试过 while 循环，但看起来 PyQt 并不喜欢它们（它挂起并且实际上并没有命中`app.exec_()`）。

顺便说一句，由于不喜欢 while 循环，我将如何在 Qt 中编写游戏循环？我应该使用 QThread 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:25:42.113

我认为你可以只用信号和插槽做你想做的事。Qt 运行它自己的事件循环，你不应该尝试在它上面写第二个。

在处理解释输入的类中，添加一个插槽`deal_with_input`，然后将信号连接`editingFinished`到它。

前任：

```
class main_window(QTextDisplay):
    def __init__(self,input_widget,parent=self,*arg,**kwargs):
        QTextDisplay.__init__(self,parent=parent) # and what ever other args you use
        self.input_widget = input_widget

        self.input_widget.editingFinished.connect(self.proc_input)

        ## what ever other set up you do

    @QtCore.Slot()
    def proc_input(self):
        input_str = self.input_widget.text()
        if input_str = '':
            return
        self.input_widget.clear()

        # do what ever it is you do with the input text, update the display 
```

您可以对确切的类设计提出质疑（也许您不希望将此逻辑嵌入到您的文本显示小部件中），但逻辑将成立。

基本上，Qt 会坐在那里，什么都不做，直到用户戳它，然后它会处理键盘/鼠标事件调整大小，无论如何。当用户在`QLineEdit`小部件中点击返回时，小部件会发出信号`editingFinished`( [doc](http://doc.qt.digia.com/qt/qlineedit.html#editingFinished) )。我们将它连接到`Slot`我们创建的 a，它基本上只是等待信号触发它（信号和插槽只是一个经过深思熟虑的类型安全回调方案）。一旦插槽接收到信号，它就会执行它的功能，然后返回等待。（在这种情况下，该函数从行编辑框中获取文本，清除该框，然后执行您的游戏代码需要执行的操作）。

# ruby - 用 Ruby 解析地址

> ID：14448279
> 
> 赞同：0
> 
> 时间：2013-01-21T22:21:18.550
> 
> 标签：ruby, regex

我希望我的正则表达式能够识别以邮政编码结尾并以数字开头的街道地址。

所以如果我的示例字符串是

```
'abcd 123 abcd 1600 Penn Ave. Washington D.C. 12345 hello, world' 
```

我希望它只匹配

```
1600 Penn Ave. Washington D.C. 12345 
```

我坚持使用

```
.match(/\d+.*\d{5}/) 
```

但这会返回

```
123 abcd 1600 Penn Ave. Washington D.C. 12345 
```

我怎样才能让它返回最接近的数字实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:34:19.553

这也是您的一个选择：

```
.match(/\d+(\s(\D+|\d+\D{2})){3,6}\d{5}/) 
```

这表示：

1.  寻找一组数字
2.  确保后面跟着 3 到 6 组：（一个空格 + 一些字符）。这些字符可以是非数字，也可以是数字和两个字母的组合。正如 The Tin Man 所提到的，后一种类型的组 ,`\d+\D{2}`将在您的地址中处理诸如**1st**和**3rd**等位。但它不会匹配**Apt。2**正确。
3.  为您的组提供 3 到 6 之间的数字范围，您当然可以调整这些数字，这样您的正则表达式将匹配稍微不同的地址。
4.  确保比赛结束时有邮政编码

PS [Rubular](http://www.rubular.com)是你的朋友。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:34:24.297

```
.match(/\d+(\D)*?\d{5}/) 
```

我打赌上面可能是你想要的。基本上，如果您不希望中间有多余的数字，您可以使用`(\D)`而不是`(.)`. 额外`?`的告诉正则表达式解释器进行不情愿匹配而不是贪婪匹配。换句话说，解释器会返回最短的匹配。

[贪婪与不情愿](https://stackoverflow.com/questions/5319840/greedy-vs-reluctant-vs-possessive-quantifiers)的一个好问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:39:27.623

您的模式的问题是正则表达式默认是贪婪的。`.*`抓得太多了，需要被告知要更有选择性。此外，`.`将抓取任何类型的角色，这可能不是您想要的。

我将从`/(\d+\D+?\d{5})/`哪个捕获开始：

```
1600 Penn Ave. Washington D.C. 12345 
```

例如：

```
'a 123 a 1600 Penn Ave. Washington D.C. 12345 foo'[/(\d+\D+?\d{5})/, 1]
=> "1600 Penn Ave. Washington D.C. 12345" 
```

图案的意思是：

1.  从至少一位数字开始...
2.  后跟至少一个非数字，选择要达到的最小数量...
3.  一个五位数的号码。

如果您获得的地址具有以数字命名的街道，例如`1st`.

# keyboard - 键盘隐藏 UITextFields。仅在输入开始后向上滚动

> ID：14448283
> 
> 赞同：0
> 
> 时间：2013-01-21T22:21:32.980
> 
> 标签：keyboard, uitextfield, navigationbar, container-view

我在这个问题上花了大约 2 天的时间浏览了几篇堆栈溢出/在线帖子，但似乎找不到答案。

我有 6 个 UITextField。当键盘出现时，底部的两个隐藏。但是，当我开始输入时：

在 4" 屏幕上 (iPhone 5)：文本字段向上滚动并隐藏在导航栏后面。

在 3.5 英寸屏幕上 (iPhone 3GS)：文本字段在导航栏正下方向上滚动，这是它应该在的位置。

当用户单击 UITextFields 时，我希望 UITextFields 向上滚动并在导航栏之前结束，马上。这样，该字段就会出现并准备好输入，并且不会隐藏，等待用户在向上滚动之前开始输入。

我不确定这是否相关，但我有 UIControllerView，在里面，它有一个 containerView。containerView 不覆盖整个屏幕，从 X:68 Y:7 开始 宽度：237 高度：351。在 ContainerView 内部，我有 UIScrollView 和 UITextFields。containerView 也有自己的 NavigationBar。在 iPhone 5（4" 屏幕）上，向上滚动时，TextFields 隐藏在 containerView 内的 NavigationBar 后面。在 iPhone 3GS（3.5" 屏幕）上，UITextfield 出现在 NavigationBar 的正下方，它们应该如此。

这是我从 Apple Docs 中遵循的代码：

```
.h 
@interface ContactViewController : UIViewController <UITextFieldDelegate>
{
    UITextField *activeField;
}

.m
- (void) viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWasShown:)
                                             name:UIKeyboardWillShowNotification object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillBeHidden:)
                                             name:UIKeyboardWillHideNotification object:nil];
}

// Called when the UIKeyboardDidShowNotification is sent.
- (void)keyboardWasShown:(NSNotification*)aNotification
{
    NSDictionary* info = [aNotification userInfo];
    CGSize kbSize = [[info objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

    UIEdgeInsets contentInsets = UIEdgeInsetsMake(0, 0, kbSize.height, 0.0);
    pageScrollView.contentInset = contentInsets;
    pageScrollView.scrollIndicatorInsets = contentInsets;

    // If active text field is hidden by keyboard, scroll it so it's visible
    // Your application might not need or want this behavior.
    CGRect aRect = self.view.frame;
    aRect.size.height -= kbSize.height;
    if (!CGRectContainsPoint(aRect, activeField.frame.origin) ) {
    CGPoint scrollPoint = CGPointMake(0.0, activeField.frame.origin.y-kbSize.height);
    [pageScrollView setContentOffset:scrollPoint animated:YES];
    }
}

// Called when the UIKeyboardWillHideNotification is sent
- (void)keyboardWillBeHidden:(NSNotification*)aNotification
{
    UIEdgeInsets contentInsets = UIEdgeInsetsZero;
    pageScrollView.contentInset = contentInsets;
    pageScrollView.scrollIndicatorInsets = contentInsets;
} 
```

我从 Apple Doc 获得了代码：http: [//developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T04:46:53.370

经过几天的努力并考虑采取哪条路线后，我决定将我的 UIViewController 变成一个提供内置滚动功能的 UITableViewController。我做出这个决定主要是因为将来我希望将我的应用程序本地化到其他几个语言并且不必为每种语言手动重新发明轮子，我认为适应定制的 TableView 会容易得多。

# java - App Engine Java 错误：java.lang.NoSuchFieldError：CHARSET_UTF8

> ID：14448290
> 
> 赞同：0
> 
> 时间：2013-01-21T22:22:05.107
> 
> 标签：java, google-app-engine, gwt

我的 App Engine、Java、GWT 应用程序仅在生产环境（而不是本地）中不断抛出以下错误。

问题似乎既不是我写的特定代码引起的（我们回滚了代码），也不是数据存储（我们用一个空的）。我们替换了一些相关的 jar 文件（如 requestfactory-api.jar）。这个问题让我很困惑...

有没有更深入的挖掘，找到失败点？

```
javax.servlet.ServletContext log: Exception while dispatching incoming RPC call
java.lang.NoSuchFieldError: CHARSET_UTF8
    at com.google.gwt.user.server.rpc.impl.SerializabilityUtil.generateSerializationSignature(SerializabilityUtil.java:862)
    at com.google.gwt.user.server.rpc.impl.SerializabilityUtil.getSerializationSignature(SerializabilityUtil.java:333)
    at com.google.gwt.user.server.rpc.impl.SerializabilityUtil.encodeSerializedInstanceReference(SerializabilityUtil.java:217)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.getObjectTypeSignature(ServerSerializationStreamWriter.java:651)
    at com.google.gwt.user.client.rpc.impl.AbstractSerializationStreamWriter.writeObject(AbstractSerializationStreamWriter.java:123)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter$ValueWriter$8.write(ServerSerializationStreamWriter.java:153)
    at com.google.gwt.user.server.rpc.impl.ServerSerializationStreamWriter.serializeValue(ServerSerializationStreamWriter.java:585)
    at com.google.gwt.user.server.rpc.RPC.encodeResponse(RPC.java:605)
    at com.google.gwt.user.server.rpc.RPC.encodeResponseForSuccess(RPC.java:471)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:563)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
    at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.tools.appstats.AppstatsFilter.doFilter(AppstatsFilter.java:141)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.ParseBlobUploadFilter.doFilter(ParseBlobUploadFilter.java:102)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.runtime.jetty.SaveSessionFilter.doFilter(SaveSessionFilter.java:35)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.handle(AppVersionHandlerMap.java:266)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)
    at com.google.apphosting.runtime.jetty.RpcRequestParser.parseAvailable(RpcRequestParser.java:76)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at com.google.apphosting.runtime.jetty.JettyServletEngineAdapter.serviceRequest(JettyServletEngineAdapter.java:146)
    at com.google.apphosting.runtime.JavaRuntime$RequestRunnable.run(JavaRuntime.java:447)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at com.google.apphosting.runtime.ThreadGroupPool$PoolEntry.run(ThreadGroupPool.java:251)
    at java.lang.Thread.run(Thread.java:679) 
```

.classpath 文件如下所示：我们现在首先尝试更新所有依赖项，然后删除特定库以解决错误。

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
    <classpathentry kind="src" path="src"/>
    <classpathentry kind="src" path="test"/>
    <classpathentry kind="src" path=".apt_generated">
        <attributes>
            <attribute name="optional" value="true"/>
        </attributes>
    </classpathentry>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
    <classpathentry kind="con" path="com.google.gwt.eclipse.core.GWT_CONTAINER/GWT"/>
    <classpathentry kind="con" path="com.google.appengine.eclipse.core.GAE_CONTAINER/App Engine"/>
    <classpathentry kind="con" path="com.google.gdt.eclipse.managedapis.MANAGED_API_CONTAINER/urlshortener-v1r7lv1.12.0-beta"/>
    <classpathentry kind="con" path="org.eclipse.jdt.junit.JUNIT_CONTAINER/4"/>
    <classpathentry kind="lib" path="war/WEB-INF/lib/commons-fileupload-1.2.1.jar"/>
    <classpathentry kind="lib" path="war/WEB-INF/lib/objectify-2.2.3.jar" sourcepath="/Users/manuel/Documents/workspace/objectify-2.2.3/src">
        <attributes>
            <attribute name="javadoc_location" value="file:/Users/manuel/Documents/workspace/objectify-2.2.3/javadoc/"/>
        </attributes>
    </classpathentry>
    <classpathentry kind="lib" path="war/WEB-INF/lib/log4j-1.2.16.jar"/>
    <classpathentry kind="lib" path="war/WEB-INF/lib/commons-io-1.4.jar"/>
    <classpathentry kind="lib" path="war/WEB-INF/lib/gwt-dnd-3.1.1.jar"/>
    <classpathentry kind="lib" path="war/WEB-INF/lib/gwtupload-gae-0.6.4-SNAPSHOT.jar"/>
    <classpathentry kind="lib" path="war/WEB-INF/lib/gwtupload-0.6.4-20110712.073705-11.jar"/>
    <classpathentry kind="lib" path="war/WEB-INF/lib/gwt-servlet-deps-1.jar"/>
    <classpathentry kind="lib" path="war/WEB-INF/lib/gwt-maps-1.1.1.jar"/>
    <classpathentry kind="lib" path="war/WEB-INF/lib/gwt-urlshortener-v1-0.3-alpha.jar"/>
    <classpathentry kind="output" path="war/WEB-INF/classes"/>
</classpath> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:31:08.423

您使用的是哪个 GWT 版本？缺少字段错误似乎表明您的部分类是从一个版本的 GWT 加载的，而部分是从另一个版本加载的。

快速浏览 GWT 2.4.0 和 2.5.0 指出 SerializabilityUtil.generateSerializationSignature(SerializabilityUtil.java:862) 仅存在于 GWT 2.5.0 中，并且该字段位于 com.google.gwt.user.server.rpc .RPCServletUtils。相比之下，2.4.0 在 SerializabilityUtil 中没有足够的行数，并且有自己的字段来处理编码。如果你的类路径中混合了 2.4.0 和 2.5.0，它很可能会导致这样的问题。

# sql-server - SqlDataSource 未填充参数

> ID：14448305
> 
> 赞同：0
> 
> 时间：2013-01-21T22:23:29.997
> 
> 标签：sql-server, tsql, sqldatasource, radcombobox

我正在执行一个`SSRS rpt`并且需要在一个带有`sqldatasource` *id 的*web 项目中复制它。

就填充参数而言，这些`ssrs rpt`参数工作得很好，但是当我尝试在网络版本中完成相同的事情时，第二个参数列表永远不会被填充。

该`Ship`参数取决于在`CruiseLine`参数中选择的内容。

网页版参数如下：

```
<tr>
                <td>
                    Select a CruiseLine:
                    <telerik:radcombobox id="RadComboBox1" runat="server" checkboxes="True" enablecheckallitemscheckbox="False"
                        skin="Web20" sort="Ascending" allowcustomtext="True" datasourceid="SqlDataSource1"
                        datatextfield="CruiseLine" datavaluefield="CruiseLine">
                    </telerik:radcombobox>
                    <asp:RequiredFieldValidator runat="server" ID="RequiredFieldValidator3" ValidationGroup="A"
                        ControlToValidate="RadComboBox1" ErrorMessage="Choose a CruiseLine!"></asp:RequiredFieldValidator>
                </td>
                <td>
                    Select a Ship:
                    <telerik:radcombobox id="RadComboBox2" runat="server" checkboxes="True" enablecheckallitemscheckbox="False"
                        skin="Web20" sort="Ascending" allowcustomtext="True" datasourceid="SqlDataSource2"
                        datatextfield="Ship" datavaluefield="Ship">
                    </telerik:radcombobox>
                    <asp:RequiredFieldValidator runat="server" ID="RequiredFieldValidator2" ValidationGroup="A"
                        ControlToValidate="RadComboBox2" ErrorMessage="Choose a Ship!"></asp:RequiredFieldValidator>
                </td>
            </tr> 
```

下面是对应的 SQL 数据源：

```
<asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:PrepaidConnectionString %>"
            SelectCommand="SelectCruiseLine" DataSourceMode="DataSet" EnableCaching="true"
            SelectCommandType="StoredProcedure"></asp:SqlDataSource>
        <asp:SqlDataSource ID="SqlDataSource2" runat="server" ConnectionString="<%$ ConnectionStrings:PrepaidConnectionString %>"
            SelectCommand="SelectShip" DataSourceMode="DataSet" EnableCaching="true" SelectCommandType="StoredProcedure">
            <SelectParameters>
                <asp:Parameter Name="CruiseLine" Type="String" />
            </SelectParameters>
        </asp:SqlDataSource> 
```

第一个 sqldatasource 执行以下 sql（来自存储过程并毫无问题地填充列表：

```
SELECT DISTINCT CruiseLine
        FROM dbo.ShipProductPrices
        ORDER BY CruiseLine 
```

第二个`sqldatasource`执行以下 sql（也来自存储过程）：

```
ALTER PROCEDURE [dbo].[SelectShip] 
@CruiseLine NVARCHAR(MAX)
AS
BEGIN
    SET NOCOUNT ON;

    SELECT DISTINCT Ship
        FROM dbo.ShipProductPrices
        WHERE CruiseLine IN (SELECT * FROM dbo.SplitParameterValues(@CruiseLine, ','))
        ORDER BY Ship
END 
```

现在，我只选择一条邮轮，我希望当我拉下第二个组合框的下拉列表时，它应该运行类似于以下内容的查询并填充 Ship 组合框：

```
SELECT DISTINCT Ship
        FROM dbo.ShipProductPrices
        WHERE CruiseLine IN (SELECT * FROM dbo.SplitParameterValues('CCL', ','))
        ORDER BY Ship 
```

注意*Ship* 的参数类型`combobox`和. 它们有点不同。不知道这是否有所作为。`SelectParameter``SelectShip datasource`

`SelectShip SPROC`执行一个`UDF`再次是`sproc`我在上面手动运行的数据的一部分，数据在 sql management studio 中输出。

我需要做什么才能填充第二个`combobox`？

# pattern-matching - 在哪里可以找到 OCaml 索引参考？

> ID：14448307
> 
> 赞同：1
> 
> 时间：2013-01-21T22:23:32.260
> 
> 标签：pattern-matching, ocaml, manual

我想从下面引用的书中理解一个例子。我知道这是关于模式匹配的事情，但是我在哪里可以找到关于`match`表达式含义的完整和准确的描述？

```
# let rec sort lst =
# match lst with
# [] -> []
# | head :: tail -> insert head (sort tail)
# and insert elt lst =
# match lst with
# [] -> [elt]
# | head :: tail -> if elt <= head then elt :: lst else head :: insert elt tail
# ;; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:48:34.083

[OCaml 手册中的此页面](http://caml.inria.fr/pub/docs/manual-ocaml/expr.html#@manual.kwd46)解释了如何`match`工作：

> 表达方式
> 
> ```
> match expr 
> with  pattern1    ->  expr1 
> | … 
> | patternn    ->  exprn 
> ```
> 
> 将 expr 的值与模式 pattern1 匹配到 patternn。如果与 patterni 的匹配成功，则评估关联的表达式 expri，其值成为整个 match 表达式的值。expri 的评估发生在由匹配期间执行的绑定丰富的环境中。如果多个模式与 expr 的值匹配，则选择匹配表达式中第一个出现的模式。如果没有任何模式与 expr 的值匹配，则会引发异常 Match_failure。

也就是说，它会一个接一个地尝试一个模式，直到找到一个匹配的模式。一旦完成，它就会返回与该模式关联的表达式（即 右侧的表达式`->`）。如果没有模式匹配，你会得到一个异常。

[手册的这一页](http://caml.inria.fr/pub/docs/manual-ocaml/patterns.html)解释了存在哪些类型的模式以及它们的含义。不过这有点多，所以这里是相关位的摘要：

最重要的模式是可变模式和变体模式：

变量模式只是一个变量名。此模式始终匹配并允许您通过 . 右侧的给定名称引用匹配的表达式`->`。您也可以使用 代替名称`_`，它也始终匹配，但不允许您引用 . 右侧的值`->`。

变体模式是变体类型的构造函数的名称，后跟构造函数接受参数的多个模式。如果您要匹配的值使用该特定构造函数并且该值内的每个元素都匹配相应的模式，则此模式匹配。

在您的示例中，第一个模式是`[]`. 这是`list`表示空列表的类型的构造函数。构造`[]`函数不接受任何参数。因此，如果列表为空，则此模式匹配。

第二种模式是`head :: tail`。是表示非空列表`::`的类型的构造函数。`list`构造`::`函数有两个参数：列表的头部和列表的尾部。`head`并且`tail`是与构造函数的这两个参数匹配的变量模式`::`。因此，如果列表非空，则此模式匹配，并将变量`head`和分配给`tail`非空列表的头部和尾部。

# 2d - 在 2d 物理中添加力时惯性的问题

> ID：14448308
> 
> 赞同：0
> 
> 时间：2013-01-21T22:23:33.820
> 
> 标签：2d, box2d, physics, momentum, angular-momentum

我尝试制作一个非常简单的二维物理函数来解决以球体粒子作为对撞机的刚体，

我有一个刚体和粒子类：

```
 function _rigidBody () {
        this._position = cc.p(0.0, 0.0);
    this._angle = 0;
    this._linearVelocity = cc.p(0.0, 0.0);
    this._angularVelocity = 0.0;
    this._force = cc.p(0.0, 0.0);
    this._angularMoment = 0;
    this._mass = 1.0;

    this._particles = [];
    }
    function _particle () {
    this._initialPosition = cc.p(0.0, 0.0);
    this._relativePosition = cc.p(0.0, 0.0);
    this._worldPosition = cc.p(0.0, 0.0);
    this._linearVelocity = cc.p(0.0, 0.0);
    this._force = cc.p(0.0, 0.0);
    this._radius = 10.0;
    } 
```

所以基本上，每一帧我计算存储在每个刚体中的每个粒子的新位置，然后我检查粒子到粒子的碰撞，如果发生碰撞，我计算一个力来排斥它们（基于半径和里面有多少嚼劲）它们），然后我将这个力存储在粒子中，

我通过向我的刚体添加和冲量来计算线性速度和角度速度，以获得它包含的所有粒子上的所有力存储。

我的函数 addImpulse（用脉冲将力存储在粒子中并定位我的粒子的世界 pos）：

```
 this.AddImpulse = function(bodyIdx,impulse,position){
    var b = g_Bodies[ bodyIdx ];
    if(position == null){position = b._position;}

    b._linearVelocity.x += (impulse.x/ b._mass);
        b._linearVelocity.y += (impulse.y/ b._mass);
        b._angularVelocity +=  ((position.x - b._position.x) * impulse.y -                
                                (position.y - b._position.y) * impulse.x);
}; 
```

我的问题是，这个函数对 linearVelocity 工作得很好，因为它接缝的角速度在最小的碰撞中变得非常大，现在，我不使用任何阻尼（线性或角度），我没有我的 angularVelocity 的惯性，

我想惯性缺失是我的问题，但是当我在互联网上查看如何计算它时，我有点困惑，

我在 box2d 中查看是否存储了惯性，并且它似乎是刚体的变量（作为质量）。我在互联网上发现惯性 = 质量 * (r*r)
问题 => 什么是 r ...

-if 是我重心的距离（所以我刚体的位置），显然一直等于 0（body.position - body.position == 0）

*   在 box2d 中我发现：this.m_I = massData.I - this.m_mass * (massData.center.x * massData.center.x + massData.center.y * massData.center.y); 并且massData.center接缝是刚体形状的中心，在我的情况下，我的形状是2个球体，一个在（0,10），一个在（0,-10），所以中心是（0 ,0) ....

*   在另一个网站上我发现： for(i < numberOfParticle) I += ( massOfParticle(i) * (RelativePosOfParticle(i)*RelativePosOfParticle(i) ) 在这种情况下更好，因为当我平方每个粒子的距离时（而不是先搜索中心），我的 I 将大于 0。但是我不确定使用的公式是否正确......

如果有人可以用简单的方式解释我，如何计算惯性？如果我可以直接（而不是通过粒子）计算我的刚体的惯性？如果我可以存储惯性，或者如果它加深了应用冲动的地方（我也在其他网站上读到过......）？和/或为什么我的冲动函数会做错以获得如此大的角速度（也许是正常的，解决这个问题的阻尼是其他物理引擎）。

而且，如果有人可以回答（只是出于好奇），box2d 是否使用简单版本的惯性，因为计算速度更快并且结果足够好？还是Box2d的计算是正确的，我在阅读代码时漏掉了什么？

非常感谢^^,

马吕斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:51:53.197

首先：你是对的，问题是你没有考虑**惯性矩**（这是质量的旋转模拟）。看代码：

```
b._linearVelocity.x += (impulse.x/ b._mass);
b._linearVelocity.y += (impulse.y/ b._mass);
b._angularVelocity +=  ((position.x - b._position.x) * impulse.y -
                            (position.y - b._position.y) * impulse.x); 
```

计算线速度时，除以质量；你应该对角运动做类似的事情。

如果它的位置`rigidBody`是它的重心，那么工作就很容易了。

惯性矩是 mr ²，对粒子求和。也就是说，每个粒子都有贡献`m*r*r`，其中`m`是粒子的质量，`r`是粒子到重心的距离。

例如，如果您的形状是 2 个球体，一个位于 (0,10) 处，一个位于 (0,-10) 处，**质量均为 5**，则重心位于

```
C = (5*(0,10)+5*(0,-10))/(5+5) = (0,0) 
```

并且转动惯量是

```
I = 5*10*10 + 5*(-10)*(-10) = 1000 
```

角速度的变化将是

```
b._angularVelocity += (((position.x - b._position.x) * impulse.y -
                        (position.y - b._position.y) * impulse.x))/I; 
```

如果您的形状是 2 个球体，一个在 (0,10)，质量为 5，一个在 (0,-10)，质量为 10，那么重心在

```
C = (5*(0,10)+10*(0,-10))/(5+10) = (0,-10/3) 
```

并且转动惯量是

```
I = 5*(40/3)*(40/3) + 5*(-20/3)*(-20/3) = 10000/9 
```

**编辑：**

在单个球体（或并置球体）的特殊情况下会出现问题。这些球体被视为点质量，因此转动惯量 ( `I`) 将为零。并且所有脉冲都通过球体的中心引导，因此扭矩（角“力”）将为零。所以应该没有角速度，但是通过上面的方法它将是`0/0`。**一种解决方案：**每个球体对惯性矩的贡献很小（这意味着球体不是点质量——它的范围很小，所以它可以旋转）。现在每个球体的贡献是`m*r*r + d`，其中`d`是 ，例如`0.0001`。因此，孤立球体具有正惯性矩（并且不会旋转），并且所有其他对象仍然具有真实的物理特性。

# python - 在python中合并连字符

> ID：14448310
> 
> 赞同：2
> 
> 时间：2013-01-21T22:23:58.390
> 
> 标签：python, regex

我正在尝试在 pythog 中合并一个连字符的单词。例如我有：

```
bla bla bla infor-
mation bla bla bla 
```

我想结束`blabla information bla bla bla`。

我可以匹配连字符，删除换行符，所有这些都很容易，但我似乎无法让这两个部分加入。我得到的关闭是`bla bla bla infor mation bla bla`，但显然我不能在不删除所有其他空格的情况下匹配一个空格。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T22:26:41.023

为什么你会在如此简单的任务中使用正则表达式？

```
>>> s = """bla bla bla infor-
... mation bla bla bla"""
>>> s.replace('-\n','')
'bla bla bla information bla bla bla' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T22:25:28.663

您可以用`-`空字符串替换前后空格：-

```
>>> import re
>>> s = "bla bla bla infor- mation bla bla bla"
>>> re.sub("\s*-\s*", "", s)
'bla bla bla information bla bla bla' 
```

如果您在末尾有新行`hyphen`：-

```
>>> s = """bla bla bla infor-
mation bla bla bla"""
>>> re.sub("\s*-\s*\n", "", s)
'bla bla bla information bla bla bla' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T22:26:04.237

使用`str.split()`和`str.strip()`：

```
In [4]: strs="""bla bla bla infor-
   ...: mation bla bla bla"""

In [6]: "".join(x.strip() for x in strs.split("-\n"))
Out[6]: 'bla bla bla information bla bla bla' 
```

# iphone - 通过 TestFlight 发送演示时，我是否必须在获得新测试人员时创建新存档？

> ID：14448313
> 
> 赞同：1
> 
> 时间：2013-01-21T22:24:10.257
> 
> 标签：iphone, xcode, provisioning-profile, testflight

我将通过 TestFlight 将我的项目演示发送给某人。

为此，我遵循了以下答案：[https](https://stackoverflow.com/a/11917884/555690) ://stackoverflow.com/a/11917884/555690 ，但我也做了其他事情：我询问了他的设备 UDID，然后在我的 Apple Developer 门户上添加了该设备。之后，我创建了选择此类设备的分发配置文件...

...现在其他人可能也会进行测试。和其他人一样。

我担心我可能不得不将他们的设备添加到我的 Apple Developer 门户，重新配置配置文件，然后重新创建存档。

这是正确的，还是没有必要将他们的设备添加到我的门户中（因此也不需要创建新的存档）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:43:51.950

您不必每次想要添加新测试人员时都更新构建。为现有构建添加新测试器非常容易，您所要做的就是将设备添加到应用程序的 ADC 中的配置文件中。然后，将配置文件下载到您的计算机。现在，到了关键时刻。在 testflight 中转到要添加测试人员的构建。然后，在左侧，您将看到“权限”选项卡，单击此处，然后它将向您显示配置文件和当前有权访问该构建的所有测试人员。现在，使用您之前下载的版本更新构建，然后您将在列表中看到该设备。单击复选框以打开设备的权限，瞧你就完成了。您现在可以将相同的构建分发给测试人员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:43:49.007

是的，您每次都必须将它们添加到开发门户中的配置文件中，但是 testflight 在权限下有一个按钮来更新构建的配置文件。您可以尝试上传新的配置文件，而无需存档和上传新版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T05:45:56.220

您可以按照以下任何适合您的步骤进行操作，但根据我的经验，我会推荐流程 1，因为我发现这更可靠。

过程1：

1.  您有测试人员的 UDID。
2.  使用 ADP，在设备列表中添加 UDID 并创建新的配置文件。
3.  下载配置文件并在您的项目中进行更新。
4.  构建并归档一个新的 ipa。
5.  将其上传到测试飞行。

过程2：

1.  使用 ADP，创建一个新的供应配置。
2.  下载配置文件并将其上传到您的 testflight 帐户的权限选项卡中。
3.  刷新，您将在您的配置文件中收到更新的用户列表。
4.  选择用户，瞧你是 ON。

我在尝试 Process 2 时遇到的情况是，有时当您尝试下载应用程序时，即使用户存在于配置文件中，它也会显示“您没有下载权限”或“此时无法下载”。

此问题的解决方法是，每当您上传新的构建或配置文件时，请始终清除 cahce，或者在极端情况下，注销并重新登录。

希望这可以帮助。

# orm - Coldfusion ORM 计数多对多

> ID：14448315
> 
> 赞同：4
> 
> 时间：2013-01-21T22:24:13.063
> 
> 标签：orm, coldfusion, many-to-many, hql, coldfusion-9

我有可以分配许多类别的帖子。所以它是一个多对多的关系。

我想计算每个类别中有多少帖子（符合特定标准），然后对结果进行排序。

我有：

```
Select ( Select count(post.id)
         From post
         Join category as postcat
         where postcat.id = category.id
         and (post.deleted is null or post.deleted = false)
         and ...
       ), category
From category
order by ????? DESC, category.name 
```

我想按计数列排序。但我不能在上面声明别名。它只是忽略我添加的任何别名。然后抛出一个sql错误说：

> java.sql.SQLSyntaxErrorException：[Macromedia][SQLServer JDBC 驱动程序][SQLServer]列名“numPosts”无效。

这是我尝试过的：

```
 ...
         and (post.deleted is null or post.deleted = false)
         and ...
       ) as numPosts, category
From category
order by numPosts DESC, category.name 
```

我检查了 HQL 运行时日志，并没有在计数上设置“as numPosts”。我不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T03:57:40.510

我还没有提出解决方案，但我确实有一个解决方法。

```
SELECT (SELECT count(post.id)
    FROM post
    JOIN post.category postCategory
    WHERE postCategory.id = category.id
    AND (post.deleted IS NULL OR post.deleted = <cfqueryparam value="#false#">)
    ), category
FROM category
order by 1 desc, category.name 
```

我不是按别名排序，而是按列号排序。这似乎有效。我对此不高兴。但它有效。

# php - 严格标准 php 错误

> ID：14448316
> 
> 赞同：0
> 
> 时间：2013-01-21T22:24:15.830
> 
> 标签：php

我的脚本有一个小问题。

我得到了严格的标准：只有变量应该通过引用传递

```
if( $checkDNS && ($domain = end(explode('@',$email, 2))) ) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:28:07.743

从[PHP 手册](http://ca.php.net/manual/en/function.end.php)：

> 这个数组是通过引用传递的，因为它被函数修改了。这意味着您必须将一个实变量传递给它，而不是一个返回数组的函数，因为只有实际变量可以通过引用传递。

所以你必须在 end 函数中使用一个变量：

```
$domain = explode('@',$email, 2);
if( $checkDNS && ($domain = end($domain)) ) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T22:27:23.720

从手册：

```
mixed end ( array &$array ) 
```

`end`通过引用获取数组并移动内部指针。您的数组是函数输出，因此无法通过引用正确修改数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:33:51.887

就像消息说的那样， end 需要一个变量，因为它的参数是一个引用。

但从 PHP 5.4 开始，您可以像这样取消引用数组：

```
$domain = explode('@',$email, 2)[1]; 
```

假设 $email 总是包含`@`. 您应该事先确保，否则 end(...) 也会给您带来意想不到的结果。

# ruby - 查看哈希值是否相同

> ID：14448319
> 
> 赞同：2
> 
> 时间：2013-01-21T22:24:28.873
> 
> 标签：ruby, hash

我有一个哈希值，其值为`true`or `false`。查看这个散列的给定子散列的所有值是否相同的最 Ruby 风格的方法是什么？

```
h[:a] = true 
h[:b] = true 
h[:c] = true 
h[:d] = false
[h[:a], h[:b], h[:c]].include? false 
[h[:a], h[:b], h[:c]].include? true 
```

有没有更好的方法来写这个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T23:00:14.900

`values_at`是从哈希中获取值集合的方法：

```
h.values_at(:a,:b,:c).all?  #are they all true?
h.values_at(:a,:b,:c).any?  #is at least one of them true?
h.values_at(:a,:b,:c).none? #are they all false? 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:27:11.247

```
> [h[:a], h[:b], h[:c]].all? 
=> true
> [h[:a], h[:b], h[:d]].all? 
=> false
> [h[:a], h[:b], h[:d]].all? 
=> false
> [h[:d]].none?
=> true 
```

[全部？](http://apidock.com/ruby/Enumerable/all?)，[没有？](http://apidock.com/ruby/Enumerable/none?)

根据您的需要，编写如下内容可能更简洁：

```
> [:a, :b, :c].all? { |key| h[key] }
=> true
> [:a, :b, :d].all? { |key| h[key] }
=> false
> [:a, :d].none? { |key| h[key] }
=> false
> [:d].none? { |key| h[key] }
=> true 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T22:38:46.527

如果您只想评估它们是 ALL`true`还是它们是 ALL `false`：

```
h[:a] && h[:b] && h[:c] && h[:d] # => false
!(h[:a] || h[:b] || h[:c] || h[:d]) # => false

h[:a] && h[:b] && h[:c] # => true
!h[:d] # => true 
```

否则，正如 Dave Newton 所指出的，您可以使用`#all?`,`#any?`和`#none?`方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T01:43:31.810

另一种通用方法：

```
whatever.uniq.size == 1 
```

这直接测试所有值是否`whatever`相同。所以，在你的情况下，

```
h.values_at(:a, :b, :c).uniq.size == 1 
```

# scala - 在 Lift 中，如何绑定到实例而不是彗星的类？

> ID：14448321
> 
> 赞同：2
> 
> 时间：2013-01-21T22:24:45.777
> 
> 标签：scala, bind, comet, lift

这可能是一个初学者的问题，在简单的提升[教程](https://github.com/dpp/simply_lift)中，它展示了如何使用 xml 绑定到类类型，例如：

```
<div class="lift:comet?type=Chat"> 
...
</div> 
```

或者

```
<lift:comet type="Chat">
...
</lift:comet> 
```

但是，如果您希望用户在同一页面上看到多个不同的聊天流怎么办？理想情况下，这将发生在 Chat 类的多个实例化中。有什么方法可以绑定到特定的对象吗？或者至少对绑定进行参数化，以便可以在幕后使用多个实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:00:53.547

[这篇博文](http://blog.fmpwizard.com/lift-comet-actor-per-tab-library)应该很有帮助。

它的要点是根据`name`您指定的不同，您可以获得不同的 Comet 演员。您只需要在幕后进行一些接线，以按名称将演员注册到某个“主人”。

# javascript - 如果他们得到某个字符串，我如何重定向用户

> ID：14448324
> 
> 赞同：0
> 
> 时间：2013-01-21T22:24:55.280
> 
> 标签：javascript, html, css, string, random

我有一些 JavaScript 代码在屏幕上打印一个随机字符串，而不是随机数字和字母，只是我创建的单词。所以我需要它，所以如果它随机选择某个字符串，它会将您重定向到不同的页面。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T22:27:15.363

```
if (randomString == 'patternString') {
   window.location.href = 'http://google.com';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:37:16.247

```
window.location.href = 'https://www.google.com/search?q=' + encodeURIComponent(randomString); 
```

# git - git commit 停止工作 - 构建树时出错

> ID：14448326
> 
> 赞同：87
> 
> 时间：2013-01-21T22:25:09.287
> 
> 标签：git

我不能提交更改：

```
$ git commit
error: invalid object 100644 13da9eeff5a9150cf2135aaed4d2e337f97b8114 for 'spec/routing/splits_routing_spec.rb'
error: Error building trees 
```

到目前为止我尝试过：

```
$ git fsck | grep 13da
missing blob 13da9eeff5a9150cf2135aaed4d2e337f97b8114 
```

并且：

```
$ git prune
error: Could not read 1394dce6fd1ad15a70b2f2623509082007dc5b6c
fatal: bad tree object 1394dce6fd1ad15a70b2f2623509082007dc5b6c 
```

并且：

```
$ git fsck | grep 13da
missing blob 13da9eeff5a9150cf2135aaed4d2e337f97b8114 
```

但没有任何帮助。我应该删除文件，提交并重新引入吗？如果它把 git commit 带回来，我愿意失去一点历史。

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2016-07-27T04:46:12.090

此错误意味着您有一个带有 hash 的文件`13da9eeff5a9150cf2135aaed4d2e337f97b8114`，而这个 hash 不存在于 中`.git/objects/../`，或者它是空的。发生此错误时，我在错误中只有这个哈希，没有文件路径。然后我试着做`git gc --auto`and `git reset --hard`。在这些命令之一（这些命令没有解决我的问题）之后，我得到了触发错误的文件的路径。

您只需要生成对象哈希：

```
git hash-object -w spec/routing/splits_routing_spec.rb 
```

有关详细信息，请参阅[文档](https://www.kernel.org/pub/software/scm/git/docs/user-manual.html#recovering-from-repository-corruption)。在文档中，还有另一种修复此错误的方法。

PS这是对我有帮助的唯一方法。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-01-22T07:40:10.623

您的 git 存储库中可能有一个损坏的对象。

如果您有此存储库的远程或其他克隆，则可以从那里获取有问题的文件，然后在本地存储库中替换它。

您想要的文件位于：

```
/repo/.git/objects/13/da9eeff5a9150cf2135aaed4d2e337f97b8114 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-01-21T22:27:30.763

`git reset --hard`应该使您的存储库恢复正常，但您将丢失未提交的更改。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-03-03T19:25:10.467

如果您的更改正在添加有问题的文件，您可以将其从索引中删除并再次添加：

```
git reset <file> 
git add <file> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-04-11T19:37:51.270

对我来说，这只是权限问题。当我运行时`sudo`，它起作用了。也许与mac环境有关

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-10-01T09:12:51.680

就我而言，我通过以下方式解决了它：

```
git reset --mixed 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-10-19T10:20:59.993

这可能是Dropbox、建国云等第三方同步APP造成的。根据我的经验，可能有两种方法：

1.  您可以尝试撤消最近的同步操作。
2.  从文件夹中删除相关文件，提交，然后移回文件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-04-07T10:33:12.623

简单的解决方案，如果您不是真的关心文件的轨迹，您可以复制文件并删除原始文件，先提交删除和添加，然后再次重命名为原始文件。

Git应该重新正常构建

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-16T07:41:09.967

就我而言，是远程分支中的文件损坏了。我通过以下方式解决了它：

1.  完全删除远程分支`$ git remote rm origin`
2.  再次添加遥控器：`$ git remote add origin <the-remote-url>`
3.  再次获取遥控器：`$ git fetch origin`
4.  硬重置到原点上所需的分支（例如，`develop`）：`$ git reset --hard origin/develop`

然后一切恢复正常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-09-17T01:24:29.500

就我而言，这是由于不同版本的 git 造成的。我一直通过 git 的官方 Windows 端口使用我的存储库，并开始使用具有相同版本号的 MinGW 端口。

我在尝试使用 MinGW git 提交时开始遇到这个问题。切换回 Windows Git 解决了这个问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-25T15:27:56.950

就像从远程仓库克隆到一个新文件夹一样简单，删除这个新文件夹中的所有文件，保留 .git 文件。然后将所有文件从旧文件夹复制到新的克隆文件夹而不复制 .git 文件夹..

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-05T20:50:58.630

好吧，我也遇到了这个问题，我所做的是：将更改的文件夹或文件复制到 VSCode 中的另一个项目并删除该存储库并再次克隆并再次传递该文件或文件夹。看起来很长，但我认为最好确保你不会丢失你尚未提交的文件

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-12-11T20:51:00.630

解决此问题的最简单方法是：

1.  复制取消提交的文件。
2.  然后使用`$ git reflog -1`
3.  使用`$ git reset --hard xxxxxx`（xxxx 你的最后一个提交头）
4.  然后再次粘贴您的文件。

它对我有用。无需克隆 repo 或删除遥控器。

# wpf - 通过绑定控制显示按钮的数量

> ID：14448329
> 
> 赞同：0
> 
> 时间：2013-01-21T22:25:21.533
> 
> 标签：wpf, mvvm, binding

我不确定标题的最佳表达方式，也找不到相关的问题，但如果有，请指导我。

我正在尝试创建一个投标屏幕，其中显示的按钮数量将取决于用户设置了多少类型的投标（现金、支票、信用卡、借记卡、礼品卡等）。

所以如果我有这样的课：

```
public class TenderType
{
    public string DisplayName { get; set; }

    // ... other implementation details
} 
```

在我的 DataContext 上，我有一个 TenderTypes 集合，声明如下：

```
public ObservableCollection<TenderType> TenderTypes { get; private set; } 
```

那么我该如何让我的视图根据集合中有多少 TenderType 实例更新显示的按钮数量，并将它们的 Text 属性绑定到集合中相应项目的 DisplayName 呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:49:43.790

您可以使用 ItemsControl 并为您的 TenderType 创建一个数据模板来显示一个按钮。

这样它只会显示列表中的按钮

xml:

```
<Window x:Class="WpfApplication8.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication8"
        Title="MainWindow" Height="105" Width="156" Name="UI">
    <Window.Resources>
        <DataTemplate DataType="{x:Type local:TenderType}">
            <Button Content="{Binding DisplayName}" />
        </DataTemplate>
    </Window.Resources>

    <Grid DataContext="{Binding ElementName=UI}">
        <ItemsControl ItemsSource="{Binding TenderTypes}"/>
    </Grid>
</Window> 
```

代码：

```
public partial class MainWindow : Window
{
    private ObservableCollection<TenderType> _sourceData = new ObservableCollection<TenderType>();

    public MainWindow()
    {
        InitializeComponent();
        TenderTypes.Add(new TenderType { DisplayName = "Stack" });
        TenderTypes.Add(new TenderType { DisplayName = "Overflow" });
    }

    public ObservableCollection<TenderType> TenderTypes 
    {
        get { return _sourceData; }
        set { _sourceData = value; }
    }
}

public class TenderType
{
    public string DisplayName { get; set; }
} 
```

结果：

![在此处输入图像描述](../Images/b5f7b8587f8552a8831ca93d045a884b.png)

# ruby-on-rails - wkhtmltopdf 的问题

> ID：14448330
> 
> 赞同：0
> 
> 时间：2013-01-21T22:25:23.697
> 
> 标签：ruby-on-rails, wkhtmltopdf

美好的一天！，我希望有人能回答这个问题。我在尝试将 html 从 rails 应用程序“转换”为 pdf 时遇到问题，我已按照以下步骤操作：[http](http://www.snikt.net/blog/2012/04/26/wicked-pdf/) : //www.snikt.net/blog/2012/04/26/wicked-pdf/不走运，当我单击链接时，它只会将 url 从“http://localhost:3000/users/3”更改为“http://localhost:3000/users.3”，并显示一个空白页面。

然后我读到你必须先配置一些东西，所以我按照以下步骤操作：[http](http://code.google.com/p/wkhtmltopdf/wiki/compilation) ://code.google.com/p/wkhtmltopdf/wiki/compilation ，一切看起来都很好，直到我到达带有“make && make”的部分安装”，结果如下：

cd src/lib/ && make -f Makefile make[1]:`/home/username/wkhtmltopdf/src/lib' make[1]: Nothing to be done for`先进入目录'。make[1]: 离开目录`/home/username/wkhtmltopdf/src/lib' cd src/pdf/ && make -f Makefile make[1]: Entering directory`/home/username/wkhtmltopdf/src/pdf' make[1]: 无事可做`first'. make[1]: Leaving directory`/home/username/wkhtmltopdf/src/pdf' cd src/image/ && make -f Makefile make [1]：先进入目录`/home/username/wkhtmltopdf/src/image' make[1]: Nothing to be done for`'。make[1]: 离开目录`/home/username/wkhtmltopdf/src/image' cd src/lib/ && make -f Makefile install make[1]: Entering directory`/home/username/wkhtmltopdf/src/lib' mkdir: 无法创建目录`/include': Permission denied make[1]: *** [install_headers] Error 1 make[1]: Leaving directory`/home/username/wkhtmltopdf/src/lib' make: *** [sub-src-lib-install_subtargets-ordered] 错误 2

请注意，命令“wkhtmltopdf some_url my_pdf.pdf”确实有效，问题在于尝试将 html 从 rails 应用程序“转换”为 pdf 时。

我很感激你能给的每一个小费，因为我真的迷路了。如果这是一个愚蠢的问题，我很抱歉给您带来所有麻烦，感谢您抽出宝贵的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:32:03.053

好的，按照本教程完成所有这些：http: [//blog.tcs.de/install-wkhtmltopdf-on-ubuntu-server/](http://blog.tcs.de/install-wkhtmltopdf-on-ubuntu-server/) 谢谢你们的时间。

# android - 发送电子邮件得到 NetworkOnMainThreadException

> ID：14448331
> 
> 赞同：0
> 
> 时间：2013-01-21T22:25:24.193
> 
> 标签：android

我正在使用以下代码在我的应用程序中发送电子邮件

[在不使用默认/内置应用程序的情况下使用 JavaMail API 在 Android 中发送电子邮件](https://stackoverflow.com/questions/2020088/sending-email-in-android-using-javamail-api-without-using-the-default-built-in-a?lq=1)

这以前有效，但现在因 NetworkOnMainThreadExceoption 而停止。我知道解决方案是使用 AsyncTask，但我不知道如何转换我现在拥有的类以使用 AsyncTask。以前没用过。

下面是失败的类的发送部分

```
public class EmailProvider extends Authenticator { 
    private static String emailUsername  = ""; 
    private static String emailPassword = "";
    private static String emailFrom  = ""; 
    private static String emailDefaultSMTPport = 
    private static String emailDefaultSocketFactoryPort = 
    private static String emailHost = ""; 

    private boolean emailAuth; 
    private boolean emailDebuggable; 

    private Multipart emailMultipart; 

    public EmailProvider(Context context) { 
        //this.context = context;

        emailDebuggable = false; // debug mode on or off - default off 
        emailAuth = true; // smtp authentication - default on 

        emailMultipart = new MimeMultipart(); 

    } 

    public boolean send(String emailAddress, String pEmailSubject, String pEmailBody) throws Exception { 

        Properties props = setProperties(); 

        Session session = Session.getInstance(props, this); 

        MimeMessage msg = new MimeMessage(session); 

        msg.setFrom(new InternetAddress(emailFrom)); 

        msg.setRecipients(MimeMessage.RecipientType.TO, emailAddress); 

        msg.setSubject(pEmailSubject); 
        msg.setSentDate(new Date()); 

        // setup message body 
        BodyPart messageBodyPart = new MimeBodyPart();
        messageBodyPart.setText(pEmailBody);

        emailMultipart.addBodyPart(messageBodyPart); 

        // Put parts in message 
        msg.setContent(emailMultipart); 

        // send email 
        Transport.send(msg); 

        return true; 
    } 

} 
```

谢谢你的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:43:15.527

在你调用方法`asyncTask`的地方声明这个：`activity``send()`

```
private class SendEmailTask extends AsyncTask<Object, Object, Object> {        
        @Override
        protected Object doInBackground(Object... arg0) {
            yourEmailProviderObj.send(emailAddress, pEmailSubject, pEmailBody);
            return "executed";
        }
} 
```

并进行此调用而不是您的`send()`方法调用：

```
new SendEmailTask().execute(); 
```

谢谢。

# apache - XAMPP Windows Apache VirtualHost 403 禁止

> ID：14448334
> 
> 赞同：4
> 
> 时间：2013-01-21T22:25:33.010
> 
> 标签：apache, virtualhost

我让 XAMPP 在我的 winodws 8 机器上运行良好的虚拟主机，直到我被迫重新启动计算机（Windows 更新）。重新启动后，我注意到我的虚拟主机不再工作了。我决定重新安装 XAMPP（目前正在运行 XAMPP 3.1.0。这是 runnign Apache v 2.4.3），而不是过多的故障排除

我编辑了我的 Windows 主机文件以重定向`sitename.localhost`到 127.0.0.1，这就是我在 httpd-vhost.conf 中的内容：

```
 NameVirtualHost *
      <VirtualHost *>
        DocumentRoot "C:\xampp\htdocs"
        ServerName localhost
      </VirtualHost>
      <VirtualHost *>
        DocumentRoot "C:\Users\USER\Documents\sitename"
        ServerName sitename.localhost
      <Directory "C:\Users\USER\Documents\sitename">
        Order deny,allow
        Allow from all
      </Directory>
    </VirtualHost> 
```

每次我尝试访问[http://sitename.localhost](http://sitename.localhost)时都会收到 403 Access Forbidden 错误。知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-08T14:24:16.843

尝试添加`Require all granted`到目录配置：

```
NameVirtualHost *

<VirtualHost *>
    DocumentRoot "C:\xampp\htdocs"
    ServerName localhost
</VirtualHost>

<VirtualHost *>
    DocumentRoot "C:\Users\USER\Documents\sitename"
    ServerName sitename.localhost
    <Directory "C:\Users\USER\Documents\sitename">
        Order deny,allow
        Allow from all
        Require all granted
    </Directory>
</VirtualHost> 
```

**另外，尝试为Authenticated users**设置对网站文件夹的读取权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T09:17:54.607

这将作为索引列出。

```
NameVirtualHost *:80
<VirtualHost *:80>
    DocumentRoot "C:\xampp\htdocs"
    ServerName localhost
</VirtualHost>
<VirtualHost *:80>
    DocumentRoot "C:\Users\USER\Documents\sitename"
    ServerName projectname.dev
    ServerAlias projectname.dev
    <Directory "C:\Users\USER\Documents\sitename">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride All
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-24T07:29:52.033

你能测试这个代码而不是你的吗？

```
 <VirtualHost *:80>
    DocumentRoot "C:\xampp\htdocs"
    ServerName localhost
  </VirtualHost>
  <VirtualHost *:80>
    DocumentRoot "C:\Users\USER\Documents\sitename"
    ServerName sitename.localhost
   <Directory "C:\Users\USER\Documents\sitename">
     AllowOverride All
     Order allow,deny
     Allow from all
  </Directory>
</VirtualHost> 
```

顺便说一句，文件夹“C:\Users\USER\Documents\sitename”中是否有 index.html/php 文件，不是吗？

# c# - MonoDevelop 项目构建失败，并出现“找不到类型或命名空间“GDK”

> ID：14448337
> 
> 赞同：1
> 
> 时间：2013-01-21T22:25:54.007
> 
> 标签：c#, macos, monodevelop, gdk

“...您是否缺少 using 指令或程序集引用？”

我在升级到 ubuntu 11.10 unity 后尝试了这个问题[Gtk# in monodevelop 中的解决方案不再工作，](https://stackoverflow.com/questions/9014780/gtk-in-monodevelop-not-working-anymore-after-upgrading-to-ubuntu-11-10-unity)但似乎在这里不起作用。

我正在使用最新的 MonoFramework 2.10.10 和 MonoDevelop 3.1.1 在 Mtn Lion 上运行

有什么建议可以进行构建吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:33:23.830

错误消息准确地说明了您需要做什么。

1.  如果没有，请添加对 Gtk# 程序集的引用。
2.  添加`using Gtk;`到您的代码中。

# macos - AppleScript 无需等待即可运行一组终端命令

> ID：14448340
> 
> 赞同：0
> 
> 时间：2013-01-21T22:26:25.180
> 
> 标签：macos, bash, shell, terminal, applescript

我正在编写一个 AppleScript 应用程序。我`do shell script`的代码的一部分看起来像这样：

```
unlink file.file; mv file1.file file2.file; sleep 3; open app.app; 
```

无论如何，我需要它在不中断脚本且不打开终端窗口的情况下运行。我已经知道这`> /dev/null 2>&1 &`件事了，但这对我不起作用，因为我需要按顺序运行这些，而且我无法让它与这样的多个命令一起工作。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:33:21.003

您可以将整个命令列表作为一个组运行：

```
{ unlink file.file; mv file1.file file2.file; sleep 3; open app.app; } >/dev/null 2>&1 & 
```

# extjs - 扩展继承的停靠栏 extjs

> ID：14448342
> 
> 赞同：2
> 
> 时间：2013-01-21T22:26:36.553
> 
> 标签：extjs, extjs4

我写了两个网格类。

**BaseUsuarios.js：**

```
Ext.define('CRUDManantiales.view.grid.BaseUsuarios', {
     extend: 'Ext.grid.Panel',
     alias: 'widget.gridBaseUsuarios',
     title: 'Usuarios',
     initComponent: function(){
           ...
           this.callParent(arguments);
     }
}); 
```

和**FullUsuarios.js**

```
Ext.define('CRUDManantiales.view.grid.FullUsuarios', {
    extend: 'CRUDManantiales.view.grid.BaseUsuarios',
    alias: 'widget.gridFullUsuarios',
    title: 'Usuarios',
    initComponent: function(){
        ...
        this.callParent(arguments);
    } 
```

**BaseUsuarios.js**有一个带有 3 个按钮的工具栏，然后**是 FullUsuarios.js**。**但我想在FullUsuarios.js**工具栏中添加一些按钮。我该怎么办？任何想法 ？。谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T00:20:49.687

我会做这样的事情：

```
Ext.require('*');

Ext.onReady(function() {

    Ext.define('MyBase', {
        extend: 'Ext.panel.Panel',

        initComponent: function() {
            this.tbar = this.getTbarItems();
            this.callParent();
        },

        getTbarItems: function() {
            return [{
                text: 'Base'
            }]
        }
    });

    Ext.define('MySub', {
        extend: 'MyBase',

        getTbarItems: function() {
            var items = this.callParent();
            items.push({
                text: 'Sub'
            });
            // Could also insert etc
            return items;
        }
    });

    new MySub({
        renderTo: document.body
    });
}); 
```

# c++ - 无法打开共享对象文件：没有这样的文件或目录；在 Eclipse 中运行或调试

> ID：14448343
> 
> 赞同：12
> 
> 时间：2013-01-21T22:26:36.173
> 
> 标签：c++, eclipse, shared-libraries

在 Ubuntu 上，我在 Eclipse 中有一个 C++ 应用程序。该应用程序编译良好，我可以从命令行运行该应用程序。

但是当我尝试调试它或使用 Eclipse 运行它时，**错误：**

`"Cannot open shared object file: No such file or directory"`被扔到一个共享库上。

我在我的 bashrc 文件中设置了 LD_LIBRARY_PATH 并且还在运行配置和调试配置中设置了一个 LD_LIBRARY_PATH 环境变量：

> /home/behlingb/Documents/api_libs/FileGDB_API/lib

为了让 Eclipse 运行它，我还缺少什么？

**更新**

此应用程序只需要一个共享对象文件，该文件来自第 3 方 API 下载。我刚刚发现，如果我将共享对象放在可执行文件所在的目录中，它将在 Eclipse 中调试。有没有办法指定不同的目录，这样我就不必为每个项目复制文件？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-11-14T12:08:19.197

我正在使用 Eclipse 的 Kepler 版本。

1.  在 Eclipse 中点击 Run 然后 Debug Configurations
2.  单击环境选项卡
3.  点击新建
4.  添加 LD_LIBRARY_PATH 并将其值设置为包含库的目录
5.  重启 Eclipse

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-10T19:58:07.067

根据@zuafi 的建议，您不必使用 grep 查找库并“定位”即可找到它们。

而是将 strace 的输出保存到文件中：

```
strace -o my_output_file.txt /path/to/my_executable_file 
```

然后打开文件，在哪里可以看到

```
open("/a/path/to/some/library.so", O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory) 
```

向下滚动这些行，直到你点击

```
open("/real/path/to/some/library.so", O_RDONLY|O_CLOEXEC) = 3 (any value here) 
```

这意味着在找到之前`/real/path/to/some/library.so`已经`library.so`在不同的路径中进行了多次试验。但最后图书馆在`/real/path/to/some/`.

只需将其复制并粘贴到您的 Eclipse 中！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-06T04:56:15.767

如果你已经设置`LD_LIBRARY_PATH`并且它不起作用。关闭 Eclipes 并从命令终端运行它。我偶然发现这可以使它起作用。不确定原因，但可能与 Eclipes 初始化有关。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-21T22:40:19.347

您可以使用`strace`实用程序（然后使用`grep`for`open`和/或`stat`调用）来获取运行 smth 所需的 .so 文件列表，然后使用`locate`（或在包中查找）找出所需库的实际位置

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-11-29T17:18:58.403

这对 Eclipse Kepler 有效（我没有研究过旧版本）。要使调试器能够加载您的共享库，尝试设置 LD_LIBRARY_PATH 将失败。然而，CDT 插件为此目的提供了一个*共享库列表*

> ***运行***菜单 ->***调试配置 ...***

然后在配置对话框中

> ***C/C++ 应用程序***->*你的项目*->***调试器***选项卡 ->***共享库***选项卡

![用于添加调试共享库的 Kepler 对话框](../Images/fdef3ccf657710456fbd298941377b83.png)

# ios - 得到一个空白的视图。查看日志记录 null

> ID：14448350
> 
> 赞同：0
> 
> 时间：2013-01-21T22:27:11.803
> 
> 标签：ios, objective-c, uiviewcontroller, uiwebview, uistoryboardsegue

我遇到了类似的问题...[为什么我看到黑屏？我没有分配东西吗？](https://stackoverflow.com/questions/8771727/why-am-i-seeing-a-black-screen-did-i-not-alloc-something)

很抱歉初学者的问题，但我不知道如何调试它。我的一个视图控制器看到一个空白（黑色）屏幕。当我在检查器中将视图控制器设置为“初始视图控制器”时，它按预期工作。但是，当我删除它（它不应该是最初的 VC，只是为了调试）并导航到视图时，我得到一个空白（黑色）屏幕。

VC 中有一个 webview（referenceDetailWebView），当我尝试在 VC 的 viewDidLoad 上注销它时，我得到（null）。同样，当我将 VC 设置为“初始”时，它会按预期注销 referenceDetailWebView 对象。

这是VC的实现...

```
@implementation DetailViewController

@synthesize currentReference, referenceDetailWebView;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    NSString *htmlFile      = [[NSBundle mainBundle] pathForResource:@"reference/accommodation" ofType:@"html"];
    NSString *htmlString    = [NSString stringWithContentsOfFile:htmlFile encoding:NSUTF8StringEncoding error:nil];

    [referenceDetailWebView loadHTMLString:htmlString baseURL:nil];

    // log for debugging
    NSLog(@"%@", [self referenceDetailWebView]);

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
     // Dispose of any resources that can be recreated.
}

@end 
```

我能想到的唯一一件事是我可能在我的转场中遗漏了一些东西。我正在以编程方式处理它们，很可能我在那里忽略了一些东西......？我的 didSelectRowAtIndexPath 看起来像这样......

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    Reference *currentItem = [references objectAtIndex:indexPath.row];
    NSString *mySegueID;

    if([currentItem hasSubReferences]){
        mySegueID = @"ShowSubTable";
    } else {
        mySegueID = @"ShowDetail";
    }

    [self performSegueWithIdentifier:mySegueID sender:nil];

} 
```

我的 performSegueWithIdentifier 看起来像这样......

```
- (void)performSegueWithIdentifier:(NSString *)identifier sender:(id)sender{

    // the segue with identifier allows us to chose a segue programatically

    NSIndexPath *path   = [self.tableView indexPathForSelectedRow];
    Reference *item     = [references objectAtIndex:path.row];

    if([identifier isEqualToString:@"ShowSubTable"]){

        // looking for sub table

        ReferencesSubTableViewController *subTableVC = [[ReferencesSubTableViewController alloc] initWithNibName:nil bundle:nil];
        [subTableVC setCurrentReference:item];
        [self.navigationController pushViewController:subTableVC animated:YES];

    } else if ([identifier isEqualToString:@"ShowDetail"]){

        // looking for detail view

        DetailViewController *detailVC = [[DetailViewController alloc] initWithNibName:nil bundle:nil];
        [detailVC setCurrentReference:item];
        [self.navigationController pushViewController:detailVC animated:YES];

    }

} 
```

除了 detailViewController 显示空白屏幕并为我的 referenceDetailWebView 提供 null 之外，segues 正在按预期工作。

我被困住了。非常感谢任何建议或指导！在此先感谢您的帮助！！

* * *

**编辑：** 看起来segues可能是原因。当我删除多个 segue 和相关代码，并将一个简单的 segue 从表格单元格添加到 DetailViewController 时，detailVC 和视图正确加载。不知道我在segues中错过了什么......？

我已将 performSegueWithIdentifier 简化为以下内容，但仍然出现空白屏幕...

```
- (void)performSegueWithIdentifier:(NSString *)identifier sender:(id)sender{ 

    NSIndexPath *path   = [self.tableView indexPathForSelectedRow];
    Reference *item     = [references objectAtIndex:path.row];

    DetailViewController *detailVC = [[DetailViewController alloc] initWithNibName:nil bundle:nil];

    [detailVC setCurrentReference:item];
    [detailVC setTitle:[item title]];
    [self.navigationController pushViewController:detailVC animated:YES];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T00:05:34.763

你得到一个黑屏，因为你不正确地实例化你的控制器。此外，您不会使用 pushViewController:animated: 推送视图控制器，当您调用 performSegueWithIdentifier: 时，这已经为您完成了。如果您在情节提要中有 segue 设置，那么您应该实现 prepareForSegue:sender:，而不是 performSegueWithIdentifier:。它的代码应该是这样的：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    // the segue with identifier allows us to chose a segue programatically

    NSIndexPath *path   = [self.tableView indexPathForSelectedRow];
    Reference *item     = [references objectAtIndex:path.row];

    if([segue.identifier isEqualToString:@"ShowSubTable"]){

        // looking for sub table

        ReferencesSubTableViewController *subTableVC = (ReferencesSubTableViewController *)segue.destinationViewController; 
        [subTableVC setCurrentReference:item];

    } else if ([segue.identifier isEqualToString:@"ShowDetail"]){

        // looking for detail view

        DetailViewController *detailVC = (DetailViewController *)segue.destinationViewController;
        [detailVC setCurrentReference:item];
    }
} 
```

你真的需要阅读和理解 Apple 关于视图控制器和 segue 的文档——你显然对它们的工作方式有一些基本的误解。

# javascript - HumaneJs 通知绑定到 DIV

> ID：14448355
> 
> 赞同：1
> 
> 时间：2013-01-21T22:27:33.790
> 
> 标签：javascript

我正在使用 HumaneJs [http://wavded.github.com/humane-js/](http://wavded.github.com/humane-js/)来显示通知。除了我似乎无法指定应该出现通知的 DIV 之外，一切都运行良好。此链接[https://github.com/wavded/humane-js/pull/32](https://github.com/wavded/humane-js/pull/32)中的讨论似乎表明这是可能的，但我无法让它工作

这是我的 HTML 代码

```
<button id="1">Display default notification</button><br/><br/><br/><br/>

<div id="container">
    <button id="2">Display notification inside div</button><br/><br/>
</div> 
```

这是Javascript

```
/*display notification in default position*/
$("#1").click(function() {
  humane.log("Default notification");
});

/*display notification inside div*/
$("#2").click(function() {
    var custom = humane.create({container: $("#container")[0]});
    custom.log("Notification inside div");
}); 
```

我还设置了一个小提琴来演示这个问题

[http://jsfiddle.net/ZvCvJ/](http://jsfiddle.net/ZvCvJ/)

单击按钮似乎每次都在默认位置（右上角）显示通知，我无法在 DIV 内显示通知。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-25T11:32:38.230

Humane 中各个主题的 CSS 看起来并没有考虑到“容器”。另一个明确支持这种“容器受限”通知的通知插件是 Noty。 [http://needim.github.io/noty/#custom-container](http://needim.github.io/noty/#custom-container)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:46:17.580

它显示在角落的原因是因为您使用的是默认值`libnotify`

添加`baseCls: "humane-bigbox"`它应该修复它。

[http://jsfiddle.net/ThdLC/](http://jsfiddle.net/ThdLC/)

# python - 具有多轮AES加密的bcrypt密码？

> ID：14448359
> 
> 赞同：0
> 
> 时间：2013-01-21T22:27:50.127
> 
> 标签：python, encryption, aes, bcrypt, sha256

我正在尝试编写一个简单的 Python 解决方案来使用密码安全地加密文件。我想我会使用类似`bcrypt`或`pbkdf2`这样的东西，随着时间的推移，我可以让我的密码哈希越来越难以暴力破解。我还想我会使用 AES 进行实际加密，因为它是一个非常安全的标准。我不固定在加密密码上，但我真的很喜欢`bcrypt`.

我很难弄清楚如何实际执行加密。假设我有一个密码和一个要加密的文件。我假设我基本上需要做这样的事情：

```
from Crypto.Cipher import AES
from bcrypt import gensalt, hashpw
from hashlib import sha256

def encryptify(passphrase, file_name):
    target_file = open(file_name, 'r')

    # generate password, takes time
    passphrase_rounds = 15
    passphrase_salt = gensalt(rounds)
    passphrase = sha256(hashpw(passphrase, passphrase_salt)).hexdigest()

    # encrypt the file
    encrypted_file = AES.new(passphrase, AES.MODE_CBC).encrypt(target_file.read()) 
```

在最后一步，它失败了`ValueError`，告诉我我的密钥必须是 16、24 或 32 字节长。我不明白的是我正在做的事情是否安全，以及为什么最后一步失败了。我以为SHA256输出32个字符的数据？

我特别担心输入`bcrypt`密码并把它扔掉`sha256`，这样做有什么潜在的安全风险吗？我不会这么想，但话又说回来，我不是密码学家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:30:15.550

我无法评论安全性，但如果您想要实际的 32 字节 SHA256，您需要调用`digest`，而不是`hexdigest`. `hexdigest`返回十六进制字符串表示形式（即 64 个字符）。

# mysql - CakePHP 查找带有别名 SQLSTATE[42S22] 的查询错误

> ID：14448360
> 
> 赞同：0
> 
> 时间：2013-01-21T22:27:49.453
> 
> 标签：mysql, cakephp, mysql-error-1054, table-relationships

我在 CakePHP 中的关系/别名有一个奇怪的问题，现在它阻止我正确访问我的数据。

我有：

*   用户 hasMany CreatorModule（Module 的别名）
*   用户 HABTM LearnerModule（模块的别名）
*   模块属于创建者（用户的别名）
*   模块 HABTM 学习者（用户的别名）

我试图打电话给：

```
$id = $this->Module->User->findByEmail($email);
$modules = $this->Module->findByUserId($id['User']['id']); 
```

生成的查询不正确 - 表别名错误。我不确定以上哪一项是负责任的，但我得到：

```
SELECT
    `Creator`.`id`,
    `Creator`.`email`,
    `Creator`.`organization`,
    `Creator`.`name`,
    `Creator`.`password`,
    `Creator`.`verified`,
    `Creator`.`vcode`
FROM
    `snurpdco_cake`.`users` AS `Creator` 
WHERE
    `User`.`email` = 'foo@example.com' # <--
LIMIT 1 
```

我发现错误是 CakePHP*应该*将 WHERE 子句中的“用户”更改为 Creator，但即使我使用别名也不会。如何正确完成此查询。

此外，作为一个相关问题，我发现既然我已经定义了别名，我就不能再在我的模型调用等中使用用户。有没有解决的办法？

编辑：根据要求，这是我定义别名的模型代码：

```
class User extends AppModel {
public $name = 'User';
public $uses = 'users';
public $hasMany = array(
    'OwnedModule' => array(
        'className' => 'Module',
        'foreignKey' => 'user_id',
        'dependent' =>  true
        ));
public $hasAndBelongsToMany = array(
    'LearnerModule' => array( 
       'className'              => 'Module',
       'joinTable'              => 'modules_users',
       'foreignKey'             => 'user_id',
       'associationForeignKey'  => 'module_id',
       'unique'                 => 'keepExisting',
    ));
//The rest of the Model
} 
//Different file, condensed here for spacing 
class Module extends AppModel {
public $name = 'Module';
public $belongsTo = array(
    'Creator' => array(
        'className' => 'User'));    
public $hasAndBelongsToMany = array(
    'Learner' => array(
       'className'              => 'User',
       'joinTable'              => 'modules_users',
       'foreignKey'             => 'module_id',
       'associationForeignKey'  => 'user_id',
       'unique'                 => 'keepExisting',
    ));
//The rest of the Model
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T02:19:18.617

尝试

```
$id = $this->Module->Creator->find('first', 
          array('conditions' => array('Creator.email' => $email)
      );
$modules = $this->Module->findByCreatorId($id['User']['id']); 
```

# clojure - 如何编写一个返回相邻对列表的 Clojure 函数？

> ID：14448361
> 
> 赞同：4
> 
> 时间：2013-01-21T22:27:52.463
> 
> 标签：clojure

我正在尝试编写一个`adjacents`返回序列相邻对向量的函数。所以`(adjacents [1 2 3])`会回来`[[1 2] [2 3]]`。

```
(defn adjacents [s]
  (loop [[a b :as remaining] s
          acc []]
    (if (empty? b)
      acc
      (recur (rest remaining) (conj acc (vector a b)))))) 
```

我当前的实现适用于字符串序列，但对于整数或字符，REPL 输出此错误：

```
IllegalArgumentException Don't know how to create ISeq from: java.lang.Long  clojure.lang.RT.seqFrom (RT.java:494) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T23:25:32.190

这里的问题是在 , 的第一个评估循环中`(adjacents [1 2 3])`绑定`a`到`1`和`b`到`2`。然后你问`b`是不是`empty?`。但是`empty?`适用于序列并且`b`不是序列，它是`Long`，即`2`。您可以在这种情况下使用的谓词是`nil?`：

```
user=> (defn adjacents [s]
  #_=>   (loop [[a b :as remaining] s acc []]
  #_=>     (if (nil? b)
  #_=>       acc
  #_=>       (recur (rest remaining) (conj acc (vector a b))))))
#'user/adjacents
user=> (adjacents [1 2 3 4 5])
[[1 2] [2 3] [3 4] [4 5]] 
```

但是，正如@amalloy 指出的那样，如果您`nil`的数据中有合法的 s，这可能无法给出预期的结果：

```
user=> (adjacents [1 2 nil 4 5])
[[1 2]] 
```

有关使用列表的建议实施，请参阅他的评论。

请注意，`partition`可以使用 Clojure 来完成这项工作，而无需定义自己的危险：

```
user=> (partition 2 1 [1 2 3 4 5])
((1 2) (2 3) (3 4) (4 5))
user=> (partition 2 1 [1 2 nil 4 5])
((1 2) (2 nil) (nil 4) (4 5)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-01T22:49:58.867

这是我的简短回答。一切都成为向量，但它适用于所有序列。

```
(defn adjacent-pairs [s] 
  {:pre [(sequential? s)]}
  (map vector (butlast s) (rest s))) 
```

测试：

```
user=> (defn adjacent-pairs [s] (map vector (butlast s) (rest s))) 
#'user/adjacent-pairs
user=> (adjacent-pairs '(1 2 3 4 5 6))
([1 2] [2 3] [3 4] [4 5] [5 6])
user=> (adjacent-pairs [1 2 3 4 5 6])
([1 2] [2 3] [3 4] [4 5] [5 6])
user=> 
```

但是，此答案可能不如`partition`上面使用的答案有效。

# multithreading - 执行一系列 SQL 查询，并且需要能够从主 UI 线程中取消它们。最好的方法是什么？

> ID：14448367
> 
> 赞同：1
> 
> 时间：2013-01-21T22:28:11.857
> 
> 标签：multithreading, ado.net, backgroundworker, sqlclient

目前，我有几个查询需要按顺序运行（一些创建临时表，我在以后的查询中从中提取）。

查询在一个`BackgroundWorker`线程中运行，目前如果有`CancellationPending`，我会在查询调用之间中断该方法。

但是这种方法是有问题的，因为有时单个查询可以运行很长时间或永远不会返回，所以我需要能够在轮询时运行每个查询`BackgroundWorker.CancellationPending`。

在这种情况下使用的最佳异步模式是什么？我需要`DataTable`为每个查询填写一个，但如果需要太长时间，仍然可以取消。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:39:23.660

在所有情况下，合作中止。甚至不要考虑使用`Thread.Abort`.

[伟大的 Stephen Toub 写了一个最佳实践。](http://blogs.msdn.com/b/pfxteam/archive/2011/11/10/10235834.aspx)

TL;DR：当超时计时器触发时，您`Task`立即完成并让 SQL 查询继续运行。你只是忽略它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T19:56:33.970

**编辑**：最终为我工作的解决方案是使用异步 ADO.NET 方法。`BeginExecute...`和`EndExecute...`

这是一段在检查 a`BackgroundWorker`是否请求取消时异步执行查询的代码片段。如果查询运行完成，该函数返回 true，如果执行取消，则返回 false。

代码应该从`BackgroundWorker`'s`DoWork`函数中的某个地方调用。

```
SqlCommand command = new SqlCommand(query, connectionObj);
IAsyncResult result = command.BeginExecuteReader();  // end async execution

// check for user cancellation while result is not complete
while (!result.IsCompleted)
{
    if (myBackgroundWorker.CancellationPending)
    {
        command.Cancel();  // cancel the existing command
        try
        {
             command.EndExecuteReader(result);  // cancel async execution
        }
        catch (SqlException e)
        {
            // will always enter here due to command.Cancel()
            // this is expected
        }

        return false;
    }

    Thread.Sleep(100);  // sleep so loop doesn't consume all the resources
}

// result is complete, do something with data
using (SqlDataReader reader = command.EndExecuteReader(result))
{
    DataTable table = new DataTable();
    table.Load(reader);
}

// do something with table
return true; 
```

# php - 在验证登录凭据时，如果给定的用户名不存在，那么适当的响应是什么？

> ID：14448368
> 
> 赞同：0
> 
> 时间：2013-01-21T22:28:12.173
> 
> 标签：php, mysql, security, authentication

例如，有人尝试使用名称“Bob”登录，但数据库中没有 Bob。是否应该通知用户没有 Bob，或者程序是否应该简单地说“身份验证失败”（我注意到 Gmail 会这样做）？这部分是可用性问题，部分是效率问题。现在程序查询数据库以查看给定的用户名是否存在，如果存在，则再次查询数据库以查找相同用户名的密码哈希（冗余）。

```
//$link is the link to the database storing passwords/usernames
if(userNameExists($uName, $link))
{
    if(passwordCorrect($uName, $pass, $link))
        echo 'log in successful!';
    else
        echo 'can\'t log in';
}
else
{
    echo 'username doesn\'t exist!';
}

/*This function checks to see if the username exists
INPUT: the userName to check for and a link to the database
OUTPUT: true if username exists
*/
function userNameExists($userName, $link)
{
    $result = mysqli_query($link, 'SELECT `userid`
                        FROM `login`
                        WHERE `userid` = \''.$userName.'\' LIMIT 1');//need to look into uses of backticks, single quotes, double quotes
    return mysqli_num_rows($result) == 1;
}

/*This function checks the password for a given username
INPUT: the userName and password the user entered, and a link to the database
OUTPUT: true if the given password matches the one in the database
*/
function passwordCorrect($userName, $givenPassword, $link)
{
    $result = mysqli_query($link, 'SELECT `password`
                        FROM `login`
                        WHERE userid = \''.$userName.'\' LIMIT 1');
    $retrievedPassword = mysqli_fetch_array($result);
    if(password_verify($givenPassword, $retrievedPassword['password']))
        return true;
    else
        return false;
} 
```

我应该只使用`passwordCorrect()`并且如果`mysqli_query()`返回 false 这意味着用户名不存在（诚然我不喜欢这些解决方案，因为这可能意味着其他地方出了问题，不是吗？）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:31:53.850

您不应*提供*登录失败的详细信息（用户不存在或密码错误），因为这会增加安全性。除非在未登录时用户名可见（这实际上是不安全的，不应该是这种情况..！）

优点是您确实可以使用单个查询来获取给定用户名的哈希值。如果没有得到结果，说明用户名错误（登录失败），否则可以（直接）检查哈希（查看密码是否错误）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:34:04.493

粗略地说，您可以考虑这个故事的两个基本点

1.  提供特定信息可以提高可用性，因为用户知道他提供的哪条信息是错误的

2.  但提供具体信息也允许潜在的滥用。如果您在用户名不存在的情况下特别返回，则相反的情况可能会提醒黑客用户名***确实***存在，他可能会使用该信息更有效地使用暴力破解技术来破解登录

最适合您的情况总是需要权衡取舍，但出于上述安全原因，通常建议您省略特定信息

# java - 将 Jetty 7.x 升级到 8.x 的性能优势

> ID：14448370
> 
> 赞同：-1
> 
> 时间：2013-01-21T22:28:24.413
> 
> 标签：java, jetty

除了错误/功能之外，从 Jetty 7 升级到 8 是否有任何明显的性能优势。我正在尝试寻找 Jetty 7 到 8 的经验性能数据来验证升级。想知道这样的比较是否存在。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:37:44.290

Jetty 7 和 Jetty 8 之间应该没有性能差异。

它们是相同的代码库，唯一的区别是它们支持的 servlet-api 版本。Jetty 7 和 Jetty 8 是并行开发的，变化进入 Jetty 7，然后合并到 Jetty 8。

*   码头 7 - Servlet API 2.5
*   码头 8 - Servlet API 3.0

现在，Jetty 9（目前处于里程碑后期版本），另一方面，已经对 I/O 层进行了彻底的检查，并且被证明比 Jetty 7 和 Jetty 8 的性能更高。

# x86 - RPL 可以不同于 x86 机器上的 DPL 吗？

> ID：14448372
> 
> 赞同：3
> 
> 时间：2013-01-21T22:28:36.587
> 
> 标签：x86, memory-segmentation

我正在阅读有关 x86 分段保护的[博客文章。](http://static.duartes.org/img/blogPosts/segmentProtection.png)RPL 可以与 DPL 不同吗？如果可以，它的用例是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:59:40.357

它们可以不同，这是故意的。

这个想法是，当操作系统/内核代表用户代码执行某些操作时，它可以使用用户代码的权限访问内存（`RPL`这将反映`Requestor Privilege Level`用户代码的级别）。如果它们不足，则异常使操作失败。如果不存在这种（或类似的）机制，用户代码可能会通过以某种方式请求代表其执行的操作来破坏操作系统/内核，并且该操作将由内核以其内核权限执行。这就是你得到[EOP](http://en.wikipedia.org/wiki/Privilege_escalation)的地方。

有关段的更多信息，请访问源代码，即英特尔的 CPU 手册。这一切都在那里。

# cookies - iOS6 UIWebView 中的第 3 方 cookie

> ID：14448373
> 
> 赞同：1
> 
> 时间：2013-01-21T22:28:37.330
> 
> 标签：cookies, uiwebview, ios6

我们的 iOS 应用在 UIWebView 中显示我们的网站。webview 包含一个到第 3 方站点的 iframe。第 3 方站点需要能够设置 cookie 来存储会话信息。这似乎在 iOS 5 中可以正常工作，但在 iOS 6 中却不行

有谁知道通过 iOS 6 中的 web 视图处理 3rd 方 cookie 设置的解决方法或正确方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T18:21:19.643

我遇到了类似的问题，但事实证明，默认的 cookieAcceptPolicy 似乎已更改。这为我修复了它：

```
 [NSHTTPCookieStorage sharedHTTPCookieStorage].cookieAcceptPolicy = NSHTTPCookieAcceptPolicyAlways; 
```

# jquery - jquery崩溃，如何打开和关闭别人？

> ID：14448377
> 
> 赞同：1
> 
> 时间：2013-01-21T22:28:56.187
> 
> 标签：jquery

如果我单击“媒体”，它会向下滑动并显示子链接。然后我点击“项目”，它也会向下滑动，露出里面的链接。单击“项目”时如何隐藏“媒体”？

# HTML 代码

```
<ul id="nav">
<li><a href="#" class="collapse">Media</a>
    <ul>
        <li><a href="#">Photos</a></li>
        <li><a href="#">Video</a></li>
        <li><a href="#">Audio</a></li>
        </ul>
</li>
<li><a href="#" class="collapse">Items</a>
    <ul>
        <li><a href="#">Add</a></li>
        <li><a href="#">List</a></li>
        </ul>
</li>
</ul> 
```

# JS代码

```
// Collapsable navigation
$('ul#nav .collapse:not(.open)').parents('li').find('ul').hide();

$('ul#nav .collapse').click(function() {
    if( ! $(this).hasClass('open') ) {
        $(this).parents('li').find('ul').stop(true, true).slideDown('fast');
        $(this).addClass('open');
    } else {
        $(this).parents('li').find('ul').stop(true, true).slideUp('fast');
        $(this).removeClass('open');
    }
      return false;
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:39:24.717

手风琴逻辑非常简单，这里有一个注释版本：

```
$('#nav .collapse').click(function () {
    //stores a reference to the `ul` which will be toggled
    var toToggle = $(this).closest('li').find('ul');
    //hide the others
    $('#nav ul').not(toToggle).slideUp(200);
    //toggle the clicked one
    toToggle.slideToggle(200);
    return false;
}); 
```

[**小提琴**](http://jsfiddle.net/J94sC/)

* * *

您可以通过删除不必要的变量来使代码更短，但它会失去一些可读性：

```
$('#nav .collapse').click(function () {
    $('#nav ul').not(
        $(this).closest('li').find('ul').slideToggle(200)
    ).slideUp(200);
    return false;
}); 
```

[**小提琴**](http://jsfiddle.net/J94sC/1/)

# excel - Excel VBA - 在日期范围内使用 Find 方法

> ID：14448379
> 
> 赞同：2
> 
> 时间：2013-01-21T22:29:19.227
> 
> 标签：excel, vba, date, find

我正在尝试查找某个日期是否在某个日期范围内。这是日期范围：

```
01/01/2013
11/02/2013
29/03/2013
20/05/2013
01/07/2013
05/08/2013
02/09/2013
14/10/2013
11/11/2013
25/12/2013
26/12/2013 
```

这是VBA代码：

```
 ' Format Holiday Rows '
        With ConfigData.Range("B8:B18")
            Set holidays = .Find(s1.Cells(row_count, 1))

            If Not holidays Is Nothing Then
                MsgBox s1.Cells(row_count, 1)
            End If
        End With 
```

在上面的代码中，弹出的第一个 MsgBox 显示为“11/01/2013”​​。这绝对没有意义，因为该值不在范围内。

注意：ConfigData.Range("B8:B18") 指的是上面显示的日期范围。

另外：此代码在增加 s1.Cells(row_count, 1) 值的 for 循环中。从 2013 年 1 月 1 日至 2013 年 12 月 31 日

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T00:51:47.507

如果您只想确认系列中的日历日是否在假期列表中，那么您甚至可以使用`vlookup`：

```
Dim strFound As String

On Error Resume Next
strFound = Application.Vlookup(s1.Cells(row_count, 1), .Range("B8:B18"), 1, 0)
If IsError(strFound) Then
   MsgBox "Not Found"
Else
'-- Found
End If
On Error GoTo 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-13T21:21:36.330

需要注意的是，excel 使用美国日期格式。即 mm/dd/yyyy，因此要让 .Find() 函数正常工作可能有点棘手。确保您的变量格式正确，以便 excel 能够为您提供所需的内容：

```
Dim strdate As String
Dim aCell As Range

strdate = ActiveSheet.Cells(1,1)
strdate = Format(strdate, "Short Date")
On Error Resume Next
    Set aCell = Cells.Find(What:=CDate(strdate), After:=Range("A1"), LookIn:=xlFormulas , LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)

If rCell Is Nothing Then
    MsgBox("Date cannot be found. Try Again")
End If
End Sub 
```

当然，日期格式可能会发生很多烦人的事情，但这是假设您要查找的日期为“短日期”格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T23:06:59.223

以下代码适用于我：

```
Sub thing()

    Dim cell As Range, _
        holidays As Range

    For Each cell In Range("D1:D365")
        With Range("A1:A11")
            Set holidays = .Find(cell.Value, LookIn:=xlValues, lookat:=xlWhole)

            If Not holidays Is Nothing Then
                Debug.Print cell.Value
            End If
        End With
    Next cell

End Sub 
```

如果这不起作用，我建议您可能有单元格格式问题。选择您的日期单元格之一。转到即时窗口（Alt+F11，然后在 Excel 中按 Ctrl+G），键入`? Selection.Value2`并按 Enter。这会返回一个数值（~41000）吗？

或者，您可以在全新的工作表中重新输入日期（手动输入第一对并向下拖动，不要复制和粘贴，因为格式也会被复制）然后重试。这至少应该消除作为潜在问题的奇怪格式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-15T12:06:14.677

'要在工作表的其他地方查找与参考单元格具有相同特定日期的单元格： '首先将所有日期复制到紧靠其左侧的单元格中。'将复制的单元格格式化为“常规”'运行此代码 - 然后使用 dateRow 和 DateCol 变量（例如在 vlookup 中）'在 Excel 2013 中工作（不得隐藏“常规”列 - 通过背景颜色的格式隐藏）

```
Dim dateVal
Dim DateRow
Dim DateCol

dateVal = Range("j8").Value 'must be in general format

Cells.Find(What:=dateVal, After:=ActiveCell, LookIn:=xlValues, LookAt:= _
    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
    , SearchFormat:=False).Activate

DateRow = ActiveCell.Row
DateCol = ActiveCell.Column

MsgBox (DateRow & "   " & DateCol)

End Sub 
```

# python - 如何读取 MIDI 文件、更改其乐器并将其写回？

> ID：14448380
> 
> 赞同：6
> 
> 时间：2013-01-21T22:29:25.610
> 
> 标签：python, ruby, perl, midi

我想解析一个已经存在的 .mid 文件，将其乐器从“原声三角钢琴”更改为“小提琴”，然后将其保存回来或保存为另一个 .mid 文件。

从我在文档中看到的内容来看，该乐器使用`program_change`or`patch_change`指令进行了更改，但我在已经存在的 MIDI 文件中找不到任何可以执行此操作的库。他们似乎都只支持从头开始创建的 MIDI 文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-28T09:29:24.980

该[`MIDI`](https://metacpan.org/module/MIDI)软件包将为您执行此操作，但确切的方法取决于 MIDI 文件的原始内容。

一个 midi 文件由一个或多个轨道组成，每个轨道是 16 个通道中任何一个通道上的一系列*事件*，例如*Note Off*、*Note On*、*Program Change*等。最后一个将更改分配给通道的乐器，并且这就是您需要更改或添加的内容。

根本没有任何 Program Change 事件，通道将使用程序编号（音色编号）零，这是一台原声三角钢琴。如果你想改变这样一个通道的乐器，那么你需要做的就是在轨道的开头为这个通道添加一个新的 Program Change 事件。

但是，如果一个频道已经有一个 Program Change 事件，那么在开头添加一个新事件将无效，因为它会立即被先前存在的事件覆盖。在这种情况下，您必须*更改*现有事件的参数才能使用您想要的工具。

如果一个通道最初有多个 Program Change 事件，则事情可能会更加复杂，这意味着乐器会在整个轨道中发生变化。这是不寻常的，但如果您遇到这样的文件，您将不得不决定如何更改它。

假设您有一个非常简单的 MIDI 文件，它只有一个轨道、一个通道，并且没有现有的 Program Change 事件。该程序从文件中创建一个新`MIDI::Opus`对象，访问轨道列表（只有一个成员），并获取对第一个轨道事件列表的引用。`patch_change`然后，通道 0的新程序更改事件（此模块称为它）*未移动*到事件列表的开头。新活动的节目编号为 40 - 小提琴 - 因此该频道现在将使用小提琴而不是钢琴演奏。

对于多个轨道、多个通道和现有的程序更改事件，任务变得更加复杂，但原理是相同的 - 决定需要做什么并根据需要更改事件列表。

```
use strict;
use warnings;

use MIDI;

my $opus = MIDI::Opus->new( { from_file => 'song.mid' } );

my $tracks = $opus->tracks_r;
my $track0_events = $tracks->[0]->events_r;

unshift @$track0_events, ['patch_change', 0, 0, 40];
$opus->write_to_file('newsong.mid'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-30T19:11:40.070

使用[music21 库](http://web.mit.edu/music21/)（插入我自己的系统，希望没问题）。如果部件中定义了补丁，请执行以下操作：

```
from music21 import converter,instrument # or import *
s = converter.parse('/Users/cuthbert/Desktop/oldfilename.mid')

for el in s.recurse():
    if 'Instrument' in el.classes: # or 'Piano'
        el.activeSite.replace(el, instrument.Violin())

s.write('midi', '/Users/cuthbert/Desktop/newfilename.mid') 
```

或者如果当前没有定义补丁更改：

```
from music21 import converter,instrument # or import *
s = converter.parse('/Users/cuthbert/Desktop/oldfilename.mid')

for p in s.parts:
    p.insert(0, instrument.Violin())

s.write('midi', '/Users/cuthbert/Desktop/newfilename.mid') 
```

# java - 尝试使用 OpenGL 时，活动因 NumberFormatException 而崩溃

> ID：14448383
> 
> 赞同：0
> 
> 时间：2013-01-21T22:29:48.860
> 
> 标签：java, android, eclipse, opengl-es, numberformatexception

我正在学习一些基本的 OpenGL 编程，但我无法运行该应用程序，因为每次运行它时它都会崩溃并出现以下错误：

01-21 16:22:04.245: E/AndroidRuntime(30137): java.lang.RuntimeException: 无法启动活动组件: java.lang.NumberFormatException: Invalid int: "4.0.4"

我正在运行它的三星 Galaxy SII 上安装了 android 4.0.4，我想知道这是否是问题所在，因为我尝试运行的大多数 OpenGL 测试似乎都因类似的错误而崩溃。

任何想法发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:51:52.193

将您的代码包装在

```
try {
    /// Your code
} catch(NumberFormatException nfe) {
   Log.e("MyApp", nfe.getMessage(), nfe);
} 
```

这将允许您隔离异常的来源。

4.0.4 确实是一个不可解析的数字。您可以对其进行子串化并以这种方式比较数字。

# objective-c - 在不点击按钮的情况下自动更新标签objective-c

> ID：14448384
> 
> 赞同：1
> 
> 时间：2013-01-21T22:29:50.033
> 
> 标签：objective-c, xcode, macos, cocoa, cocoa-bindings

我有 4 个标签，3 个可编辑，一个无法编辑，一个浮点数是 3 个可编辑标签的总和。当用户编辑它们时，让不可编辑的标签自动更新其他标签的总和值的最简单方法是什么？（我不希望用户在编辑标签后必须单击按钮）我知道我可能会使用绑定，但非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:33:23.847

假设您的三个可编辑标签实际上是“文本字段”，请将某个对象（可能是您的视图控制器）指定为委托，然后响应此[NSControlTextEditingDelegate 协议](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSControlTextEditingDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/NSControlTextEditingDelegate)方法：

[`- control:shouldEndTextEditing:`](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/NSControlTextEditingDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/NSControlTextEditingDelegate/control%3atextShouldEndEditing%3a)

当用户选择或退出可编辑文本字段时，您将通过协议方法捕获该事件，然后您可以更新该不可编辑文本字段（您已将其设置为视图控制器中的插座，对吗？）。

或者，您可以使用绑定，是的。:-)

# angularjs - AngularJS：Angular 与表单交互的方式是什么？

> ID：14448386
> 
> 赞同：1
> 
> 时间：2013-01-21T22:29:53.103
> 
> 标签：angularjs

我了解 Angular 的主要原则之一是：

> 你不应该从你的控制器中引用你的 DOM。

我正在尝试处理信用卡付款，这需要以下步骤：

*   用户填写表单，然后单击提交按钮
*   该表格的一部分被发送到我们的服务器，它开始与支付网关的交易
*   我们服务器的响应会更新表单中的值，然后必须通过表单 POST 将其直接提交到支付网关。
*   其他事情发生。

在这种情况下，我该如何：

*   更新表单中的数据（不从控制器引用表单）
*   获取要提交的表单？

该表单绑定到我的控制器上的模型，所以我尝试了类似以下的方法：

```
<form action="{{paymentModel.urlFromTheResponse}}">
    <input type="hidden" name="accessCode" value="{{paymentModelaccessCodeFromResponse}}" />
    <button ng-click="startTransaction(paymentModel)"></button>
</form>

// in my success handler
.success(function(data) {
     paymentModel.urlFromTheResponse = data.url;
     paymentModel.accessCode = data.accessCode;
     $scope.apply();
} 
```

这里的理论是，如果我可以通过数据绑定立即使表单进入正确的状态，那么我可以做*一些事情*来提交表单。但是，这会引发错误：

> 已在进行摘要

支持这种类型的流程的 Angular 方式是什么？看来我需要直接与 DOM 交互，这违背了控制器的本质。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T19:57:45.307

正如其他人所说，您不需要调用 $scope.$apply() 因为表单应该已经通过在每个字段上设置 ng-model 属性来绑定到角度。

但是，有时需要调用 $scope.$apply() 来更新显示，当数据是从 angular 之外的其他来源拉入时...

在这些情况下，我很幸运：

```
 // This method will be inherited by all other controllers
  // It should be used any time that $scope.$apply() would
  // otherwise be used.
  $scope.safeApply = function(fn) {
    var phase = this.$root.$$phase;
    if(phase == '$apply' || phase == '$digest') {
      if(fn && (typeof(fn) === 'function')) {
        fn();
      }
    } else {
      this.$apply(fn);
    }
  }; 
```

我把它放在我最外层的控制器中，所以页面上的所有其他控制器都继承了它的函数。每当我发现我需要调用 apply 时，我都会调用 $scope.safeApply() 如果没有，它将调用 apply已经在进行应用或摘要，否则，这些更改将已被当前运行的应用/摘要拾取。

在你的代码中我会改变这个：

```
<input type="hidden" name="accessCode" value="{{paymentModelaccessCodeFromResponse}}" /> 
```

对此：

```
<input type="hidden" name="accessCode" ng-model="paymentModel.accessCode" /> 
```

我可能还会删除表单操作，而是在控制器中添加类似这样的内容：

```
$scope.$watch('paymentModel.accessCode', function() {
  // Fire off additional form submission here.
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:58:37.410

生成错误是因为您的成功回调已经“在 Angular 内部”，因此 $scope.apply() 将自动为您调用。

如果您在表单元素上使用 ng-model（而不是 value），那么您可以在成功回调中修改 model/$scope 属性，并且表单将自动更新（由于通过 ng-model 进行的双向数据绑定）。然而，与其尝试提​​交表单，为什么不直接使用控制器中的 $http 或 $resource 服务来调用 Web 服务呢？（这就是为什么我问用户是否需要参与我的评论。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T13:04:40.157

假设您使用的是 $http 之类的东西，您已经在角度范围内，不需要手动调用 $scope.apply(); 因为您已经在角度执行中。

您应该能够放弃 $scope.apply() 并简单地拥有一个

```
.success(function(data) {
     paymentModel.urlFromTheResponse = data.url;
     paymentModel.accessCode = data.accessCode;
 $http.post("/finalstep",paymentModel).success(function(data)
{
// other stuff
});
} 
```

# javascript - 仅在 jQuery 中触发最内层元素的单击事件

> ID：14448390
> 
> 赞同：1
> 
> 时间：2013-01-21T22:30:16.907
> 
> 标签：javascript, jquery, events, click, propagation

我试图在 HTML 树的最里面的元素上触发一个点击事件，但由于有一个点击甚至与它的父容器相关联，所以这两个事件都会被触发，这不是我需要的。我以前用 stopPropagation() 解决了这个问题，但我今天似乎无法让它工作。

```
jQuery('#parent li').click(function() {
    jQuery(this).children('.contained').slideDown();
});
jQuery('.contained').click(function() {                 
    Query(this).slideUp();
}); 
```

假设这是我们的 HTML：

```
<ul id="parent">
    <li>
        click to show more
        <p class="contained">click to hide</p>
    </li>
</ul> 
```

我相信这不会验证，因为它在 li 中包含 ap，但为了简单起见，让我们暂时忽略它。我怎样才能让内部元素 slideUp() 没有父级点击甚至触发它到 slideDown() 之后立即？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:32:24.143

`return false`停止冒泡：

```
jQuery('.contained').click(function() {                 
    Query(this).slideUp();
    return false;
}); 
```

请注意，返回 false 也会阻止事件的默认行为。 [在这里阅读更多](https://stackoverflow.com/a/10729215/601179)。

或者使用事件对象的`stopPropagation`函数：

```
jQuery('.contained').click(function(e) {                 
    Query(this).slideUp();
    e.stopPropagation();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:34:12.217

答案是停止事件的传播。您可以使用[stopPropagation](http://api.jquery.com/event.stopPropagation/)及其双胞胎[stopImmediatePropagation](http://api.jquery.com/event.stopImmediatePropagation/)来执行此操作，或者您可以通过从处理程序返回 false 来停止传播并阻止默认操作。stopPropagation 方法将防止事件冒泡，即事件沿 DOM 树向上传播。stopImmdiatePropagation 会做到这一点，但也会阻止同一级别的其他处理程序触发。返回 false 等效于在事件上使用`stopPropagation`和[preventDefault](http://api.jquery.com/event.preventDefault/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:37:16.563

有两种方法，停止传播或结合两个点击处理程序并根据`event.target`

目标方法：

```
jQuery('#parent li').click(function(event) {
     var $tgt=jQuery(event.target)
    if (!$tgt.is('.contained') ){
         jQuery(this).children('.contained').slideDown();
    }else{
       $tgt.slideUp();
    }   
}); 
```

# sharepoint - 从 SharePoint 功能区调用代码隐藏

> ID：14448391
> 
> 赞同：5
> 
> 时间：2013-01-21T22:30:22.817
> 
> 标签：sharepoint, sharepoint-2010

我在我的 SharePoint 功能区中创建了一个自定义操作按钮，现在我尝试从该按钮调用一些 C# 代码。我无法找到有关如何执行此操作的任何详细信息。有谁知道如何做到这一点或有任何关于如何做到这一点的好信息？不确定它会有所帮助，但这是我的自定义操作按钮的代码。谢谢！

```
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">

  <CustomAction

    Id="CustomRibbonButton"
    RegistrationId="101"
    RegistrationType="List"
    Location="CommandUI.Ribbon"
    Sequence="5"
    Title="Move Documents">

    <CommandUIExtension>
      <CommandUIDefinitions>
        <CommandUIDefinition Location="Ribbon.Documents.Manage.Controls._children">
          <Button
              Id="Ribbon.Documents.New.MoveButton"
              Alt="Move Documents"
              Sequence="5"
              Command="Move_Button"
              Image32by32="/_layouts/images/Skynet/WinEarth32x32.png"
              Image16by16="/_layouts/images/Skynet/WinEarth16x16.png"
              LabelText="Move Documents"
              TemplateAlias="o1" />
        </CommandUIDefinition>
      </CommandUIDefinitions>

      <CommandUIHandlers>
        <CommandUIHandler
          Command="Move_Button"
          CommandAction="javascript:alert('SharePoint 2010 makes me angry!');" />
      </CommandUIHandlers>

    </CommandUIExtension>
  </CustomAction>

</Elements> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T12:50:23.243

CommandUIHandler 可以执行 JavaScript（包括客户端对象模型），但如果您想执行服务器对象模型代码，您可以使用[Andrew Connell 的这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/gg552606.aspx)中描述的回发机制。他创建了一个 Web 部件，用于侦听由功能区按钮生成的回发事件。

或者，您可以实现一个 Web 服务并从您的 JavaScript CommandUIHandler（ajax 调用）中调用它。~~[此处](http://www.thedotnotcorner.com/2012/08/27/web-service-call-on-ribbon-button-click-in-sharepoint-2010-2/)~~~~使用该方法。~~（不再访问 2016-02-01）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T00:12:10.557

我不确定它是否会对您有所帮助，但是当我做了一些功能区工作时，我使用了来自[http://quickdeploydoc.codeplex.com](http://quickdeploydoc.codeplex.com)项目的代码。我将用户发送到一个页面，然后将他们带回来。希望能帮助到你。

```
 <CustomAction Id="8CC3766E-1429-498c-9EEA-B2DFA784C360"
                RegistrationType="ContentType"
                RegistrationId="0x0101"
                Location="EditControlBlock"
                Title="Add to Quick Deploy"
                Sequence="1000"
                Description="Add this document to the next Quick Deploy job.">
    <UrlAction Url="javascript:window.location='/_layouts/QuickDeploy/QuickDeployDoc.aspx?SiteUrl={SiteUrl}&amp;ItemUrl={ItemUrl}&amp;returnUrl='+window.location" />
  </CustomAction>

protected void Page_Load(object sender, EventArgs e)
        {
            try
            {
                QuickDeploy quidkDep = new QuickDeploy();

                string siteUrl = Request["SiteUrl"];
                string webUrl = SPContext.Current.Web.Url;
                string itemUrl = Request["ItemUrl"];

                webUrl = siteUrl.Remove(0, webUrl.Length);

                quidkDep.QuickDeployment(siteUrl, webUrl, itemUrl);

                ClientScript.RegisterClientScriptBlock(this.GetType(), "GoBack", "function GoBack(){document.location='" + Request["returnurl"].ToString() + "';}", true);
            }
            catch (Exception ex)
            {
                throw new Exception("Could not save document to Quick Deploy job. " + ex.ToString());
            }
        } 
```

# r - 在 R 中绘制坐标

> ID：14448395
> 
> 赞同：1
> 
> 时间：2013-01-21T22:30:47.113
> 
> 标签：r, plot, coordinates, coordinate-systems

我有许多坐标，我想使用 R 在网格界面中绘制它们。问题是观测值之间的相对距离很大。坐标位于地理坐标系中，研究区域为瑞士。此外，需要绘制点的 id。

问题是两个点簇很密集，而其他一些点则相距很远。我如何以适当的方式绘制它们以获得可读的演示文稿？对绘制数据有什么建议吗？

最好不要`ggplot`像我以前使用的那样使用它，它没有呈现出正确的结果。

数据：

```
id x y
2 7.1735 45.86880001
3 7.17254 45.86887001
4 7.171636 45.86923601
5 7.18018 45.87158001
6 7.17807 45.87014001
7 7.177229 45.86923001
8 7.17524 45.86808001
9 7.181409 45.87177001
10 7.179299 45.87020001
11 7.178359 45.87070001
12 7.175189 45.86974001
13 7.179379 45.87081001
14 7.175509 45.86932001
15 7.176839 45.86939001
17 7.18099 45.87262001
18 7.18015 45.87248001
19 7.18122 45.87355001
20 7.17491 45.86922001
25 7.15497 45.87058001
28 7.153399 45.86954001
29 7.152649 45.86992001
31 7.154419 45.87004001
32 7.156099 45.86983001
GSBi_1 7.184 45.896
GSBi__1 7.36 45.901
GSBj__1 7.268 45.961
GSBj_1 7.276 45.836
GSB 7.272 45.899
GSB_r 7.166667 45.866667 
```

点的位置：

![在此处输入图像描述](../Images/a031139ee614ddd158fd5363455a0e96.png)

正如您在图中看到的，点的 id 对于密集部分和其他部分都是不可读的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T07:54:19.620

您的观点太接近了，无法真正做太多事情，但一个想法可能`spread.labels`来自 plotrix：

```
opar <- par()
par(xpd=TRUE)

plot(dat$x, dat$y)
spread.labels(dat$x,dat$y,dat$id)

par(opar) 
```

![在此处输入图像描述](../Images/aac47050efcdf2657e704ae8970af090.png)

您可能需要考虑省略所有数字标签并将它们放在不同的图表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:14:44.403

实际上，当绘制一组同时包含非常近和非常远的点的点时，并不总是可以确保所有点在屏幕上在视觉上是可分离的。

想想一个 1000x800 像素的屏幕。假设我们有三个点 A、B 和 C，它们分别位于同一水平线上，这样：A 和 B 之间的距离是 1 个单位，A 和 C 之间的距离是 4000 个单位。

如果将此最大距离（4000 单位）映射到屏幕宽度（1000 像素）。那么一个像素将对应于水平方向的 4 个单位。这意味着 A 和 B 将适合一个像素，因为它们之间的距离仅为 1 个单位。因此，它们在屏幕上将无法在视觉上分离。

# drupal-7 - 带有 Views 7.x-3.5 的 Drupal 7，某些字段未显示用于排序

> ID：14448399
> 
> 赞同：4
> 
> 时间：2013-01-21T22:30:54.767
> 
> 标签：drupal-7, views

我正在尝试按节点字段（产品重量 - 这是一个小数）对视图进行排序，但是，该字段和其他各种字段不会显示为我可以排序的字段。

我希望有一些简单的解决方法，但我一直无法找到解决方案。

为什么某些字段显示在排序条件中，而其他字段不显示？我必须做什么才能按缺失的字段进行排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T15:15:40.677

解决了。

您必须向搜索 API 添加索引...

完成此操作并添加适当的字段后，它们应该可以进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-20T10:03:13.017

多值字段在 Drupal 7 视图中不显示为可排序的。转到您的字段设置-> 将值选择为 1 -> 转到视图的格式设置并查看排序选项是否可用-> 检查排序-> 保存视图。

# heroku - 为什么 assets:precompile 在 Heroku 上这么慢？

> ID：14448401
> 
> 赞同：4
> 
> 时间：2013-01-21T22:31:07.503
> 
> 标签：heroku, ruby-on-rails-3.2, asset-pipeline

我的部署设置是让 Heroku 预编译资产。我希望它们被预编译，以便我可以将它们发送到 CDN（通过[asset_sync](https://github.com/rumblelabs/asset_sync)），我希望在 Heroku 上完成，所以我的 repo 中没有任何已编译的资产。我使用[Heroku 的指南](https://devcenter.heroku.com/articles/cdn-asset-host-rails31)进行了设置，效果很好。我添加了[turbo-sprockets-rails3](https://github.com/ndbroadbent/turbo-sprockets-rails3)以提高速度。它一直运行良好，然后停止了；我不知道为什么。

现在，当我部署（没有`public/assets`）`assets:precompile`Rake 任务在 Heroku 上超时。为了查看它真正需要多长时间，我进入了一个 shell ( `heroku run bash`)：

```
~ $ time bundle exec rake assets:precompile
AssetSync: YAML file found /app/config/asset_sync.yml settings will be merged into the configuration
AssetSync: Syncing.
Using: Directory Search of /app/public/assets
AssetSync: Done.

real    19m29.575s
user    17m43.690s
sys 0m28.480s 
```

二十分钟！但是当我在本地运行它（2011 iMac）时，只需几分钟：

```
$ env RAILS_ENV=production time bundle exec rake assets:precompile --trace
** Invoke assets:precompile (first_time)
** Execute assets:precompile
~/.rbenv/versions/1.9.3-p327-perf/bin/ruby ~/.rbenv/versions/1.9.3-p327-perf/bin/rake assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace
** Invoke assets:precompile:all (first_time)
** Invoke assets:cache:clean (first_time)
** Invoke assets:environment (first_time)
** Execute assets:environment
AssetSync: YAML file found ~/Code/Ruby/myproject-rails/config/asset_sync.yml settings will be merged into the configuration
** Execute assets:cache:clean
** Execute assets:precompile:all
AssetSync: Syncing.
Using: Directory Search of ~/Code/Ruby/myproject-rails/public/assets
Uploading: assets/application-3a6de939348195e9610f1321df27837a.js
Uploading: assets/application-3a6de939348195e9610f1321df27837a.js.gz
Uploading: assets/jquery.min-959a5819c76e1508f5a8655c289c0de8.map
Uploading: assets/jquery.min.map
Uploading: assets/rails_admin/rails_admin-76cfbf31a605916a55eee29464ca3e6d.js
Uploading: assets/rails_admin/rails_admin-76cfbf31a605916a55eee29464ca3e6d.js.gz
AssetSync: Done.
      179.92 real        19.29 user         3.98 sys 
```

一个多星期前我写了 Heroku 支持，几天后他们说他们会把它升级到他们的 Ruby 构建团队，但我仍然没有听到任何消息。Stack Overflow 上的聪明人有没有可能的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-29T16:11:42.037

解决方案是告诉 Heroku 使用 Ruby 1.9.3，就像我的本地机器一样。显然 1.9.3 在资产编译方面比 Heroku 默认使用的 1.9.2 快得多。

要修复它，请确保您的`Gemfile`启动：

```
source "https://rubygems.org"
ruby "1.9.3"
# ... 
```

更多[关于 Ruby 版本的 Heroku 文档](https://devcenter.heroku.com/articles/ruby-versions)。

# mongodb - mongodb - 基于 _id 时间戳的查询

> ID：14448404
> 
> 赞同：2
> 
> 时间：2013-01-21T22:31:38.673
> 
> 标签：mongodb, mongodb-query

如何编写一个 mongodb shell 查询，该查询将返回特定日期之后创建的所有对象的文档（或仅文档 ID）？我看到类似下面的例子......

[根据日期返回查询](https://stackoverflow.com/questions/8835757/return-query-based-on-date)

但他们只是返回时间戳，我想根据时间戳进行查询。我认为逻辑并不像寻找高于特定 objectid 的对象那么简单，因为如果 mongodb 被分片，那么就会有多个服务器在创建对象。

# java - 如何在java中的套接字之间传递音频

> ID：14448412
> 
> 赞同：2
> 
> 时间：2013-01-21T22:32:06.563
> 
> 标签：java, sockets, javax.sound.sampled

我尝试在套接字之间传递音频，但它在客户端传递一次，而不是客户端停止工作。我认为我编写和发送的方式可能是错误的，请帮助我处理此代码以下是我的服务器代码：

```
 public void run(){
    try{
            SetInitialSettings();
            int bufferSize = (int) format.getSampleRate() * (int) format.getFrameSize();
            System.out.println("length :" +bufferSize);
            out = new ByteArrayOutputStream();
            readagain=true;
            while(record){
            int count=0;

            for(int i=0;i<1000;i++)
            {

                       if(buffer==null){
                       buffer = new byte[bufferSize];
                       }
                       count = line.read(buffer, 0, buffer.length);
                       if (count > 0) {
                       //out.write(buffer, 0, count);
                       //readagain=false;
                           for (int j=0;i<ser.clientReceiver.audioSender.size();j++){
                            ser.clientReceiver.audioSender.get(i).cliOut.write("Audio".getBytes());
                            ser.clientReceiver.audioSender.get(i).cliOut.write('\n');
                            ser.clientReceiver.audioSender.get(i).cliOut.flush();
                            ser.clientReceiver.audioSender.get(i).cliOut.write(buffer,0,count);
                            ser.clientReceiver.audioSender.get(i).cliOut.flush();
                            Thread.sleep(2000);

                               }
                       }

            }            

    }
    }
    catch(Exception ex)
    {
        System.out.println(ex.getMessage());

    }

    } 
```

以下是我的客户代码：

公共无效运行（）{

```
 try{
        //audioReceiver = new TAudioReceiver(cli);
        //audioReceiver.start();
        while(true){

            //Thread.sleep(1000);    
            System.out.println("reading token");
            cmd= cli.BufferedReader().readLine();
            System.out.println("token :" +cmd);
            switch (cmd) {
                case "Msg":
                    message = cli.BufferedReader().readLine();
                    cmd="None";
                    break;
            case "File":
              GetFile();
                break;
            case "Audio":
                PlayAudio();
                break;

        }

        }

        //reading msgs here
    }
    catch(Exception ex)
    {
        //throw new InterruptedException(ex.getMessage());
    }
} 
```

这是从服务器接收到客户端的“音频”消息时需要运行的功能

```
 public void PlayAudio()throws Exception{

     try{

                    cli.ServerInputStream().read(buffer);

                    audio = buffer;
                    audioIn = new ByteArrayInputStream(audio);
                    AudioFormat f = new AudioFormat(8000, 8, 1,true, true);
                    ain= new AudioInputStream(audioIn,f, audio.length/f.getFrameSize());
                    DataLine.Info info = new DataLine.Info(SourceDataLine.class, f);
                    try (SourceDataLine line = (SourceDataLine)AudioSystem.getLine(info)) {
                        int bufferSize = (int) f.getSampleRate()* f.getFrameSize();
                        buffer= new byte[bufferSize];
                        int count;
                        while ((count = ain.read(buffer, 0, buffer.length)) != -1) {
                        if (count > 0) {
                          line.write(buffer, 0, count);
                        }
                        }
                        line.drain();
                    }

     }
     catch(Exception ex)
     {
         System.out.println("file" + ex.getMessage());
     }

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:56:01.873

您的原始代码更好。您必须写入（缓冲区，0，计数），而不是写入（缓冲区）。否则，您将在最后一次读取未读取的每个缓冲区的末尾写入垃圾。您的第二段代码忽略了 read() 的结果。

# android - 为什么我在使用 swresample 1.1 时会得到 FPE？

> ID：14448413
> 
> 赞同：1
> 
> 时间：2013-01-21T22:32:13.837
> 
> 标签：android, audio, android-ndk, ffmpeg

我正在构建一个项目以使用 FFmpeg 1.1 在 Android 中查看来自 IP 摄像机的视频源。

我正在尝试在 Android 项目中使用 swresample，并在调用 swr_convert 时出现浮点异常。我逐步浏览了 swresample 代码，并在**libswresample/swresample.c**函数**swri_realloc_audio**中找到了一行，其中变量 a->bps 和 a->ch_count 为零，导致 FPE。

```
int swri_realloc_audio(AudioData *a, int count){
    int i, countb;
    AudioData old;

    LOGD("in swri_realloc_audio - bps[%d], ch_count[%d]", a->bps, a->ch_count);
    if(count < 0 || count > INT_MAX/2/a->bps/a->ch_count)
    return AVERROR(EINVAL); 
```

01-21 17:29:09.612: D/swresample.c(18789): 在 swri_realloc_audio - bps[0], ch_count[0]

我在 FFmpeg 项目中发现了[错误单 #1834](https://ffmpeg.org/trac/ffmpeg/ticket/1834)，这听起来与完全相同的问题，但通过调用**swr_init**解决了。但是，我的代码确实调用了这个函数并且仍然崩溃。这是我的 JNI 代码：

```
SwrContext* resampleCtx = swr_alloc_set_opts(NULL,
        AV_CH_LAYOUT_MONO, AV_SAMPLE_FMT_S16, pAudioCodecCtx->sample_rate,
        pAudioCodecCtx->channel_layout, pAudioCodecCtx->sample_fmt,
        pAudioCodecCtx->sample_rate, 0, 0);

swr_init(resampleCtx);
LOGD("Resample context initialized");

int dataSize = swr_convert(resampleCtx,
        &pAudioOutBuffer, AVCODEC_MAX_AUDIO_FRAME_SIZE / 2,
        (const uint8_t**) &(pFrame->data[0]), pFrame->nb_samples);
LOGD("Resample conversion complete");

swr_free(&resampleCtx);
LOGD("Obtained data size - dataSize[%d]", dataSize); 
```

我很困惑，因为我似乎无法控制 swri_realloc_audio 函数中的变量**a**。我逐步浏览了代码并注意到它来自变量**resampleCtx->postin**。此变量是从**swr_init**函数中的resampleCtx- **>in**复制的，但我看不到**in**设置为任何内容。

 ****我究竟做错了什么？是在我的代码中还是在 swresample 中存在问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:00:40.523

这里的答案是我输入错误。swr_convert 不支持 AV_SAMPLE_FMT_S16 并且对 swr_init 的函数调用失败。我只是没有检查结果来知道这一点。****

# jquery-mobile - Jquery Mobile 1.3 滑块与面板冲突

> ID：14448415
> 
> 赞同：2
> 
> 时间：2013-01-21T22:32:23.833
> 
> 标签：jquery-mobile, jquery-selectors

我正在尝试建立一个使用面板和滑块的 JQuery Mobile 1.3 站点。

问题是，当我将滑块向右移动时，使用滑块会触发面板，该面板会在“swiperight”事件中打开。滑块用于分页，面板用于菜单。

代码在这里：

[http://jsfiddle.net/kMARn/1/](http://jsfiddle.net/kMARn/1/)

将滑块向右移动，面板将打开。

我尝试使用面板的 .not() 选择器不对滑块做出反应：

```
$(document).not("#slider").on("swiperight", function(event, ui) {
    $("#myPanel").panel("open");
}); 
```

但它不起作用，当我将滑块向右移动时面板会打开。也尝试了一堆变种，但我迷路了......

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T15:07:01.900

派对有点晚了，但您可以通过在面板 div 上将 data-swipe-close 属性设置为“false”来禁用滑动关闭。

[http://jquerymobile.com/demos/1.3.0-beta.1/docs/panels/options.html](http://jquerymobile.com/demos/1.3.0-beta.1/docs/panels/options.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-02T21:01:53.170

就我而言，我使用了这个简单的代码，面板中没有*data-swipe-close = "false"*。在滑块外部向右滑动以保持面板关闭。

```
$('#panel').find('#slider')
    .on('slidestop',function(e,ui) {
        var value = e.target.value;
        //...operations with slider value...
    })
    .parent().on('swiperight',function(e,ui) {
        e.stopPropagation();  //block panel close
    }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T00:22:07.810

来自 Swipe 的 1.3.0b1 文档：

> “在 1 秒内发生 30 像素或更多（垂直小于 75 像素）的水平拖动时触发”

这适用于并且也可以配置`swiperight`。您可以使滑块的长度变小，这样可以确保不会同时触发滑块事件停止和滑动，但这可能不适用于所有场景。

更好的方法是将向右滑动绑定到`DIV`页面的一个或部分。我的意思是，如果您在显示屏的左侧有一个 75 px 的 div 框，并且当该 div 内发生滑动事件时，它可能会触发菜单。

我觉得这里的逻辑可能更好地由一个按钮控制，就像在 Facebook 应用程序中用来显示滑出菜单一样。在 Android 上的 Dolphin 浏览器中，这种类型的事件也会触发书签菜单，所以如果一个页面有 swiperight 事件并触发它，我有时会从 App 中同时获取事件和书签菜单。恼人的！

我确实分叉了你的 jsfiddle，并且会更多地使用它（http://jsfiddle.net/Twisty/Hg2pw/）。仅供参考，他们的可用框架中有 JQM 1.3.0b1，因此您不必在 HTML 中链接它。如果我找到更多信息，我会在这里发表评论。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-22T08:47:58.400

以下解决方案更像是一种解决方法。不过应该比较靠谱。

```
$(document).ready( function () {

    var menu_available = true;

    $(document).on("swiperight", function(event, ui) {
        if (menu_available) $("#myPanel").panel("open");
    });

    $("#slider").on("slidestop", function( event, ui ) { 
        menu_available = false;
        window.setTimeout(function() {menu_available= true;},250);
    }); 
}); 
```

该变量`menu_available`在`false`幻灯片停止后持续 250 毫秒。该`window.setTimeout`块将重置变量，以便菜单再次可用。

这是一个愚蠢的解决方法，但是 jQuerys function `event.stopEventPropagation()`，恕我直言，这是正确的方法，但没有奏效。

# c++ - 错误 C4996 'fopen' 未声明

> ID：14448433
> 
> 赞同：1
> 
> 时间：2013-01-21T22:34:00.633
> 
> 标签：c++

> **可能重复：**
> [fopen 已弃用警告](https://stackoverflow.com/questions/14386/fopen-deprecated-warning)

在创建我的项目时，我遇到了这个错误：

错误 C4996：“fopen”：此函数或变量可能不安全。考虑改用 fopen_s。要禁用弃用，请使用 _CRT_SECURE_NO_WARNINGS。详细信息请参见在线帮助。1> c:\program files (x86)\microsoft visual studio 11.0\vc\include\stdio.h(218) ：参见“fopen”声明

但是，我也将 stdio.h 和 fstream 作为标题包含在内，因为其他人告诉我这样做。我仍然遇到错误。

这是我的部分错误代码：

[http://pastie.org/5796103](http://pastie.org/5796103)

谁能帮我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:35:42.213

如错误所述，您需要使用[fopen_s](http://msdn.microsoft.com/en-us/library/z5hh6ee9%28v=vs.80%29.aspx)，或通过在包含之前添加来禁用安全异常错误`#define _CRT_SECURE_NO_DEPRECATE`。

这些警告背后的原因，以及如何为各种 C 运行时功能禁用它们，[在 CRT 中的安全增强中进行了详细描述。](http://msdn.microsoft.com/en-us/library/8ef0s5kh%28v=vs.80%29.aspx)

# python - 在 python 中，可以使用 Matplotlib 绘制 datetime.datetime 值吗？?

> ID：14448436
> 
> 赞同：0
> 
> 时间：2013-01-21T22:34:14.127
> 
> 标签：python, datetime, matplotlib

```
In [22]: x
Out[22]: 
[datetime.datetime(2013, 1, 14, 1, 37, 6),
 datetime.datetime(2013, 1, 14, 1, 40, 32),
 datetime.datetime(2013, 1, 14, 1, 52, 57),
 datetime.datetime(2013, 1, 14, 1, 55, 26)]

In [23]: y
Out[23]: [-209.0, -614.0, -43.0, -438.0]

In [31]: plot(x,y)
Out[31]: [<matplotlib.lines.Line2D at 0x35e4e10>]

In [32]: show() 

ValueError: ordinal must be >= 1 
```

我想绘制 x Vs。y 并且每当我调用 show() 函数时，都会出现错误。有人有这方面的经验吗？您能提供解决方案/建议吗？

# css - CSS 左边距，在 px 中有效，但在 % 中无效

> ID：14448442
> 
> 赞同：0
> 
> 时间：2013-01-21T22:34:45.220
> 
> 标签：css, margin

任何人都知道为什么这段代码不起作用：

```
#interieur{
    display: inline-block;
    position: absolute;
    left:50%;
} 
```

这个确实

```
#interieur{
    display: inline-block;
    position: absolute;
    left:500px;
} 
```

我在 PHP 中工作，div“interieur”在回声中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:01:54.687

它不起作用，因为您忘记将 div 宽度的一半减去左侧位置（想想看，如果左侧是 50%，右侧也是 50%，那么您的 div 宽度将是 0% :)

您可以使用 CSS3 Calc 来实现结果，在知道 div 的尺寸之前：

```
#interieur{
    display: inline-block;
    position: absolute;
    left:calc(50% - 100px); /* 100px is half of your div width */
    border: 1px solid #ccc;
    width: 200px;
    height: 200px;
} 
```

演示：http: [//jsfiddle.net/zZHRY/3/](http://jsfiddle.net/zZHRY/3/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-21T22:50:33.433

如果您可以指定 div 的宽度，请尝试以下操作：

```
width: 500px; /* insert width here */
margin: 0 auto; 
```

# python - 将函数分配给python中的变量？

> ID：14448447
> 
> 赞同：0
> 
> 时间：2013-01-21T22:35:06.230
> 
> 标签：python, python-2.7, python-2.x

你好我有一个奇怪的疑问..

我的代码是

```
 def prints():
        print " I WILL DIE HEHE"

    def add(a,b):
        next = a
        print " Added sum is %d " % (next + b)
        next = prints()

    w = int(raw_input("Give a"))
    g = int(raw_input("Give b"))
    add(w,g) 
```

现在的问题是为什么函数 prints() 在我将它分配给 next 即 next = prints() 时被执行。我有点困惑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T22:36:05.200

因为你在呼唤它，

```
prints() 
```

将执行 where as

```
ne = prints
ne() 
```

正在分配名称，然后调用新名称。

`ne`Noteback，我也称它为`next`阴影内置方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T22:36:22.680

以下：

```
next = prints() 
```

调用`prints()`，并将结果分配给`next`. 由于`prints()`没有显式返回任何内容，因此它隐式返回`None`，因此`next`设置为`None`。

尚不完全清楚您期望或试图实现的目标，但考虑以下事项可能会有所帮助：

```
next = prints 
```

它的作用是将函数对象分配给`next`. 它不调用该函数，但允许将其调用为`next()`.

# android - 该类型的方法 findViewById(int) 未定义

> ID：14448448
> 
> 赞同：6
> 
> 时间：2013-01-21T22:35:16.480
> 
> 标签：android, fragment, expandablelistview

我得到错误

> 对于 PM_section 类型，方法 findViewById(int) 未定义

尝试实现我的可扩展列表视图时。我确信这是一个常见错误，但我无法找到解决方案。我正在尝试学习碎片等，从我开始就一直是一场艰苦的战斗。我进行了相当多的搜索，发现了很多结果，这似乎对我的情况没有帮助。

如果有人能给我任何见解，或者指出我正确的方向，我将不胜感激。

我的小测试班在下面

```
public class PM_section extends Fragment {
//  CustomExpListView custExpListView;
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        View V = inflater.inflate(R.layout.fragment_pm_section_test, container, false);

        CustomExpListView custExpListView = (CustomExpListView)
                this.findViewById(R.id.ExpandableListView01);
        return V;   
    }// end on create
} 
```

CustomExpListView 类几乎是从 Android 示例项目中复制而来的，并且很高兴并且没有问题。

谢谢你帮助我。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-21T22:37:35.180

如果`R.id.ExpandableListView01`是 的一部分`R.layout.fragment_pm_section_test`，则替换`this`为`V`。

```
CustomExpListView custExpListView = (CustomExpListView)
                V.findViewById(R.id.ExpandableListView01); 
```

`Fragment`s 没有`findViewById()`方法。你需要使用你的 inflated`View`来从你的布局中获取所有内容。

还可以考虑使用 Java 命名约定。变量以小写字母开头，而类以大写字母开头。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T22:39:58.873

`getView()`只需调用然后调用`findViewById()`方法即可获取片段的根视图：

```
getView().findViewById(R.id.ExpandableListView01); 
```

没有它，您将无法使用`findViewById()`，因为`Fragment`类本身没有这种方法。

# asp.net-mvc - 将 Fiddler 与 MVC 一起使用 - 获取 401

> ID：14448449
> 
> 赞同：0
> 
> 时间：2013-01-21T22:35:18.820
> 
> 标签：asp.net-mvc, asp.net-mvc-3, fiddler, http-status-code-401

我已经安装了提琴手，并且正在通过 Visual Studio 运行 MVC3 应用程序。每当我尝试使用 fiddler (localhost:28267) 访问 MVC 页面时，我都会收到 401。如何确定是什么原因造成的？该页面通过 IE/VS 加载良好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:37:48.533

401 表示 Fiddler 无法正确协商 NTLM 凭据。使用 Firebug 网络控制台检查它，您可能会得到相同的行为。

# android - Android 中特定于密度的布局与特定于尺寸的布局

> ID：14448451
> 
> 赞同：10
> 
> 时间：2013-01-21T22:35:24.350
> 
> 标签：android, android-resources

很长一段时间以来，我一直在为 4 种不同的密度声明资源文件夹：

*   可绘制的 ldpi
*   可绘制的 mdpi
*   可绘制的 hdpi
*   可绘制的 xhdpi

在布局的 XML 中，我一直在使用固定宽度（同时仍然与密度无关），例如`128dp`用于那些图形。

然而，当越来越多的大屏手机，尤其是平板电脑被推出时，这种方法就不再适用了。尽管您以这种方式提供与密度无关的资源，但布局在大屏幕上看起来并不好。

这就是为什么我认为我需要添加`Dimension`取决于屏幕大小的资源，以便在 XML 布局中使用，例如：

*   价值观
*   价值观-w600dp
*   价值观-w720dp
*   价值观-w1024dp

但这是否意味着我应该放弃支持这 4 个密度的容器？还是我需要提供 16 个资源文件夹，即密度和大小的每种组合一个？

[我在Android 文档](http://developer.android.com/guide/practices/screens_support.html)中找不到关于这个主题的任何好的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T03:16:53.573

可绘制对象和布局是不同的。要回答您的问题，您是否应该停止支持这些密度。是的，但您仍应支持 xdpi 和 hdpi。Romain Guy 最近表示，像 Nexus 7（在 tvpi 上）这样的现代设备可以适当地扩展资产，以至于不需要 mdpi。再也没有人使用 ldpi 了。最后我看的是不到 2% 的市场。

关于布局。Nexus 7 (1280x800 tvdpi) 会使用 values-w1024dp 中的某些内容，但仍会从 drawable-hdpi 文件夹中获取资源。这两者并不相互排斥。像 S3 这样的东西也会从 values-w1024dp 中提取，但使用 drawable-xdpi。如果您的用例需要，您只需要提供替代布局。

那么你需要16种不同的东西吗？不，您确实需要 xdpi 和 hdpi（如果不是 mdpi）。您*可能*希望包含不同尺寸的替代布局。您可以随心所欲地具体化或通用化。除非您正在为手机和平板电脑（7 和 10 英寸）制作混合应用程序，否则您可能不需要很多 xxxx-sizexxx 文件夹。

> 在布局的 XML 中，我一直在为这些图形使用固定宽度（虽然仍然与密度无关），例如 128dp。

这可能是您问题的根源。您的布局应该使用 wrap_content 和 match_parent 尽可能流畅。固定尺寸应保留在您提前知道尺寸的侧面和图像周围的填充。如果你这样做，你的布局在从 320 x 200 到 GTV 的任何尺寸都应该看起来不错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T15:42:52.953

1）关于布局中的尺寸（values/dimens.xml）：

> 值 值-w600dp 值-w720dp 值-w1024dp
> 
> 但这是否意味着我应该放弃支持这 4 个密度的容器？还是我需要提供 16 个资源文件夹，即密度和大小的每种组合一个？

不，您不需要为每个 dpi 存储桶 (hdpi/xhdpi) 提供不同的尺寸，因为尺寸已经根据设备进行了放大或缩小（如果您使用的是 dp 而不是 px）。因此对于尺寸，您只需要为不同尺寸的设备提供值（因此名称，值-**最小可能宽度**-600-dp）。因为您不希望手机上的 16dp 填充和 10 英寸平板电脑上的 16dp。您需要 64dp。不，设备的密度无关紧要。它仍然需要具有相同的填充在各自的设备宽度上。因此对于尺寸，您只需要考虑设备的实际物理尺寸。

2）关于不同分辨率的drawables缩放（drawables/xdpi）：系统为设备适当地缩放它们。你不需要担心这个。此外，您无需在此处添加任何其他存储桶。只需使用 mdpi/hdpi/xhdpi 或者 xxhdpi，因为未来许多新设备将使用新的密度。

结论：有 2 个不同的 UI 构建组件根据 2 个不同的规则而变化：基于屏幕密度的可绘制对象和基于屏幕大小的尺寸。不要将一个误认为另一个，并认为您需要在 values 文件夹中放置数十个存储桶，因为这不仅是错误的，而且令人难以置信。

# facebook - facebook网站喜欢显示k而不是具体数字

> ID：14448454
> 
> 赞同：2
> 
> 时间：2013-01-21T22:35:31.473
> 
> 标签：facebook, facebook-like

我的 Facebook 网站点赞按钮显示 2.5k 而不是实际点赞数。请问如何更改它以显示特定数字。

使用的标头中的编码是：

```
<div id="fb-root"></div>
<script>(function(d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) return;
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script> 
```

该页面的编码是：

```
<div class="fb-like" data-href="http://www.nuborns.co.uk/photography" data-send="false"   data-layout="button_count" data-width="400" data-show-faces="false"></div> 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-31T04:05:34.637

你好 sherie deen：k = 1000，你应该设置更大的按钮宽度。希望能帮助到你

# visual-studio-2010 - Visual Studio 2012：tcl8.6.0 不能在 VC11 中编译（通过 makefile.vc）

> ID：14448456
> 
> 赞同：-1
> 
> 时间：2013-01-21T22:35:45.333
> 
> 标签：visual-studio-2010, visual-studio, tcl

tcl8.6.0 不能用 tcl 提供的 makefile.vc 在 VS11 中编译。

我只需要卸载 VS11 并重新安装 VC10（Visual Studio 2010）。

“win”文件夹中的自述文件指出 Visual Studio 6.0 或更高版本应该可以工作，但自述文件似乎不是最新的。

似乎 MS 在每个版本中都破坏了所需的功能。
对于python，情况似乎是一样的：http:
[//mail.python.org/pipermail/python-dev/2012-July/121122.html](http://mail.python.org/pipermail/python-dev/2012-July/121122.html)

没有 makefile 的任何解决方案都没有意义，因为 tcl 扩展无法编译。

有人可以确认用 VS11 编译 tcl8.6 是不可能的吗？（使用提供的 makefile.vc？）

--（我强烈建议不要使用VC11，这只是浪费时间。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:35:33.583

不知道你编译有什么问题，因为你没有提到它。

但只是使用：

```
cd win
nmake -f makefile.vc 
```

刚刚为我工作，在 Windows 8 Pro 上通常的 VC 2012 (Express for Desktop) 命令提示符下。

测试大多运行，只是一些链接、http 和时间相关的测试失败。

# mysql - 优化 MySQL 聚合函数 - AVG、MIN、MAX 和 STDDEV

> ID：14448458
> 
> 赞同：0
> 
> 时间：2013-01-21T22:35:45.890
> 
> 标签：mysql, optimization

我有一个从 1 台 PC 运行的工具。它创建作业并将它们放在 beanstalk 上以供其他 PC 执行。创建作业时，会在 job_times 表中创建一行，并填充`JobID`和`Created`列。然后，当 PC 抓取要执行的作业时，该`Claimed`列会被填充。成功完成作业后，将`Completed`填充该列。`JobID`除填充有 *nix 时间戳之外的所有列。

我正在为该工具构建一些基本报告，我可以使用这样的 MySQL 语句轻松获取统计数据，以确定工作创建和工作申请之间的时间：

`SELECT AVG(Claimed - Created) AS ave, STDDEV(Claimed - Created) AS std, MIN(Claimed - Created) AS min, MAX(Claimed - Created) AS max FROM job_times WHERE Claimed > 0 AND Created > 0`

我假设在`(Claimed - Created)`MySQL 的每个实例中都抓取所有适用的行并进行减法。因此，对于上面的语句，MySQL 对每一行进行 4 次减法 - 一次用于 AVG，一次用于 STDDEV，一次用于 MIN，一次用于 MAX。

首先，这个假设是否正确？如果是这样，那么有没有办法进行一次减法并将其重用于每个聚合函数？

谢谢

# php - 贝宝海量支付soap php集成

> ID：14448459
> 
> 赞同：0
> 
> 时间：2013-01-21T22:35:54.910
> 
> 标签：php, paypal, paypal-sandbox

我想实现 Mass Pay 功能并查看 php 的源代码 [https://www.x.com/paypal-apis-masspay-php-5.3/soap](https://www.x.com/paypal-apis-masspay-php-5.3/soap)

有一段代码是这样的

```
for($i = 0; $i < 3; $i++) {
    $receiverData = array(  'receiverEmail' => "user$i@paypal.com",
                            'amount' => "example_amount",
                            'uniqueID' => "example_unique_id",
                            'note' => "example_note");
    $receiversArray[$i] = $receiverData;
} 
```

究竟什么是 uniqueID 以及它是如何生成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T03:29:38.960

UniqueID 将是您自己的内部 ID，您可能必须识别付款。您可以根据需要生成它。

在大多数情况下，它将是您的客户 ID 或某种订单 ID。或者只是来自您自己系统的付款记录 ID，以便您可以轻松地与 PayPal 交叉引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T04:02:48.217

正如我在该页面中看到的，PayPal 不会强迫您使用特定方法创建 uniqID。所以此时你有很多选择。

伪；

```
uniqid('', true);
sha1(uniqid(mt_rand(), true) . microtime());
hash('ripemd128', uniqid(mt_rand(), true) . microtime());
base64_encode(pack("H*", sha1(microtime())));

// should be more secure
bin2hex(mcrypt_create_iv(64, MCRYPT_DEV_URANDOM));

sprintf('%04X%04X-%04X-%04X-%04X-%04X%04X%04X', 
    mt_rand(0, 65535), mt_rand(0, 65535), mt_rand(0, 65535), 
    mt_rand(16384, 20479), mt_rand(32768, 49151), mt_rand(0, 65535), 
    mt_rand(0, 65535), mt_rand(0, 65535));

$len = 128;
$str = '';
while ($len--) {
    $str .= chr(rand(33,126));
}

$str = '';
$chars = str_shuffle('abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ');
for ($i = 0; $i < 62; $i++) {
    $str .= $chars[$i];
} 
```

# java - Play Framework renderJSON 给出 InvocationTargetException

> ID：14448460
> 
> 赞同：1
> 
> 时间：2013-01-21T22:36:03.653
> 
> 标签：java, json, playframework

我正在尝试使用 Play 的 renderJSON 函数以 JSON 格式呈现用户对象。但是，当我调用它时，我得到一个 InvocationTargetException: null 错误。

在调试时，我发现我在 initial-data.yml 文件中为用户的出生日期提供的值是原因。如下：

```
User(bob):
  firstName: Bob
  lastName: Bobson
  dob: 1979-01-01 
```

但是，如果我以编程方式创建一个用户并使用新的 Date() 构造函数设置他们的 dob，则对象呈现没有问题。我什`dob: !!java.util.Date "1979-01-01"`至按照 SnakeYML 的文档（[http://code.google.com/p/snakeyaml/wiki/Documentation#YAML_syntax](http://code.google.com/p/snakeyaml/wiki/Documentation#YAML_syntax)）中的说明进行了尝试，但无济于事。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T14:22:41.683

尤里卡！我懂了！在阅读了无休止的 SO 问题大约 9 小时后，我终于通过我的厚厚的脑袋明白了错误的出现不是因为日期格式，而是因为默认的 Gson 渲染器不能很好地工作（默认情况下）与双向关系，例如@OneToMany 和 @ManyToOne。

我的解决方案？当将对象呈现为 JSON 时，“静音”关系的一侧。使用此处找到的信息：[用户定义的排除策略](https://sites.google.com/site/gson/gson-user-guide#TOC-User-Defined-Exclusion-Strategies)我想出了以下解决方案。

```
/***************** Models ****************/

class Person {
 @Expose
 public int age;
 @Expose
 public String name;
 @Expose
 @OneToMany(mappedBy="owner")
 public Dog dog;

 //Constructors and other code
}

class Dog {
 @Expose
 public String name;
 @ManyToOne(fetch=FetchType.Eager)
 public Person owner;

 //Constructor and other code
}

/**************Controller********************/

public class Application extends Controller {

 public static Gson gson = GsonBuilder.excludeFieldsWithoutExposeAnnotation().create;

 public static void allPersons() {
  List<Person> people = Person.findAll();
  renderJSON(gson.toJson(people));

 //Error should be taken care of
 }
} 
```

使用@Expose 注释在渲染时使双向关系的一侧静音肯定解决了这个问题。现在我只需要弄清楚如何解决这个新的半单面结构。

在发现这个技巧之前我使用的另一个库是[FlexJSON](http://flexjson.sourceforge.net/)。我可能会根据应用程序稍后的进展情况返回它，因为它可以很好地处理双向关系，而无需您“静音”一侧。它也（对我而言）比 Gson 库更优雅。

所以非常感谢@emt14 的所有帮助。我希望这篇文章可以帮助其他人。

# web-applications - Web 应用程序的语言/框架建议

> ID：14448464
> 
> 赞同：0
> 
> 时间：2013-01-21T22:36:21.790
> 
> 标签：web-applications, frameworks

我希望为我们的应用程序的跨平台/跨浏览器更新找到语言建议。JavaScript 可以为我们正在做的事情工作，但是在 JavaScript 中调试太痛苦了，不能成为一个可行的选择。要求如下：

应用程序应该可以在线和离线使用。最好是一个活跃的开发者社区。可用的 GUI 库，以避免重新发明轮子。在线时与磁盘上的本地文件以及 Web 服务交互

我们考虑过的其他选项是 Dart，以及使用 Django 的 Python（尽管我不完全确定这是否能够完成我们需要的一切）。我们最初考虑的是一个 C# Silverlight 应用程序，但由于 Silverlight 的未来存疑，我们正在寻找具有类似功能的另一个选项。

如果我太含糊，我会尝试提供更多信息。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-21T07:28:01.980

您有很多选择，并且您可以选择您最熟悉的语言。大多数（如果不是全部）框架都应该离线工作。我的一些建议是：

Java：Vaadin、Google Web 工具包、Spring

Python：web2py、Django、谷歌应用引擎

红宝石：轨道上的红宝石

这是一个比较不同框架的 wiki 链接：[http ://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks](http://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks)

# javascript - jQuery 显示，按名称获取元素

> ID：14448466
> 
> 赞同：0
> 
> 时间：2013-01-21T22:36:25.153
> 
> 标签：javascript, jquery, url, anchor, show

我正在创建一个新闻页面。我需要找出是否为文章设置了锚点。如果没有，我只展示最新的文章。带有锚的示例 URL 是：**example.com/news.php#article43**

HTML结构是：

```
<div>
  <a name="article43"></a>
  <h2>TITLE</h2>
  <div class="news_content"></div>
</div> 
```

我的 JS 是这样的：

```
 var anchor = $(location).attr('href').split('#');
        if(anchor[1]){
            $('a[name=' + anchor[1] + ']').next('.news_content').show();
        }else{
            $('.news_content').first().show();
        } 
```

有些东西不行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:47:56.833

`next`只会在元素之后返回**直接**兄弟，你可能想要`nextAll`：

```
$('a[name=' + anchor[1] + ']').nextAll('.news_content').show(); 
```

或者，如果您的 HTML 结构不涉及换行，即：

```
<div>
  <a name="article43"></a>
  <h2>TITLE</h2>
  <div class="news_content"></a>
  <a name="article44"></a>
  <h2>TITLE</h2>
  <div class="news_content"></a>
</div> 
```

你想要：http: [//jsfiddle.net/AVg3y/](http://jsfiddle.net/AVg3y/)

```
$('a[name=' + anchor[1] + ']').nextAll('.news_content').first().show(); 
```

此外，这可能只是一个错字，但您的 HTML 格式不正确。它应该是：

```
<div>
      <a name="article43"></a>
      <h2>TITLE</h2>
      <div class="news_content"></div> //<-- oops
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:40:12.063

试试这个（使用兄弟姐妹而不是下一个）：

```
var anchor = location.href.split('#');

if(anchor[1]) {
    $('a[name=' + anchor[1] + ']').siblings('.news_content').show();
} else {
    $('.news_content').first().show();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T23:35:14.690

我解决了这个问题。

首先：我需要使用你们许多人所说的 nextAll() 。

第二：我在 jQuery 中包含了一个 CSS（仅在启用 JS 时使用）。我必须在 $(document).ready 函数之前包含它。否则它将 news_content 元素设置为 display:none

感谢所有试图帮助我的人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-21T22:39:42.363

您可以通过查看`window.location.hash`. 使用`substring(1)`, 返回值`#`中的所有内容`window.location.hash`。

```
if(window.location.hash) {
    $('a[name=' + window.location.hash.substring(1) + ']').next('.news_content').show();
} else {
    $('.news_content').first().show();
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-21T23:02:38.713

所有答案都有哈希的相似变化，但没有一个检查哈希是否有匹配的元素：

我建议检查该元素是否作为条件的一部分存在。

```
var contentToDisplay=$('.news_content').first();
if(anchor[1]){
   var $link=  $('a[name="' + anchor[1] + '"]');
   contentToDisplay= $link.length ?  $link.next().next('.news_content') : contentToDisplay;

}
contentToDisplay.show() 
```

# javascript - 如何找出当前在显示的地图范围内的标记

> ID：14448469
> 
> 赞同：0
> 
> 时间：2013-01-21T22:36:31.883
> 
> 标签：javascript, google-maps, google-maps-api-3

> **可能重复：**
> [检查地图标记是否在选定范围内](https://stackoverflow.com/questions/11229711/check-if-map-markers-are-within-selected-bounds)

我有数百个标记，但为了方便起见，我想为当前在地图上不可见的标记“灰显”一些选项（它们在地图上，但在当前查看的地图边界之外。）

作为一种解决方案，我认为我需要遍历所有标记（我有一个数组，所以这不是问题），但我不知道如何检查标记当前是否在可见边界内。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:14:00.093

您应该使用以下内容：

```
map.getBounds().contains(marker.getPosition()) 
```

如果标记在地图边界内，它将返回 true，否则返回 false。

# node.js - 节点包管理器在 heroku 部署上失败

> ID：14448470
> 
> 赞同：1
> 
> 时间：2013-01-21T22:36:32.180
> 
> 标签：node.js, heroku, socket.io, npm

抱歉，如果这个问题已经得到解答，但我看不到任何人得到这个错误。

使用工头，我可以看到我的应用程序成功运行，但是在部署到 Heroku 时，我收到以下错误：

```
Counting objects: 717, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (617/617), done.
Writing objects: 100% (717/717), 3.22 MiB | 305 KiB/s, done.
Total 717 (delta 61), reused 0 (delta 0)
-----> Node.js app detected
-----> Resolving engine versions
   Using Node.js version: 0.6.20
   Using npm version: 1.0.106
-----> Fetching Node.js binaries
-----> Vendoring node into slug
-----> Installing dependencies with npm
   express@3.0.6 ./node_modules/express
   â"oâ"?â"? range-parser@0.0.4
   â"oâ"?â"? cookie-signature@0.0.1
   â"oâ"?â"? fresh@0.1.0
   â"oâ"?â"? methods@0.0.1
   â"oâ"?â"? mkdirp@0.3.3
   â"oâ"?â"? cookie@0.0.5
   â"oâ"?â"? debug@0.7.0
   â"oâ"?â"? buffer-crc32@0.1.1
   â"oâ"?â"? commander@0.6.1
   â"oâ"?â"? send@0.1.0 (mime@1.2.6)
   â""â"?â"? connect@2.7.2
   npm ERR! Error: ENOENT, chmod '/tmp/build_2phd1ent7ca7q/node_modules/socket.io/node_modules/socket.io-client/node_modules/uglify-js/bin/uglifyjs'
   npm ERR! Report this *entire* log at:
   npm ERR!     <http://github.com/isaacs/npm/issues>
   npm ERR! or email it to:
   npm ERR!     <npm-@googlegroups.com>
   npm ERR!
   npm ERR! System Linux 2.6.32-348-ec2
   npm ERR! command "/tmp/node-node-UFfk/bin/node" "/tmp/node-npm-Mvon/cli.js" "rebuild"
   npm ERR! cwd /tmp/build_2phd1ent7ca7q
   npm ERR! node -v v0.6.20
   npm ERR! npm -v 1.0.106
   npm ERR! path /tmp/build_2phd1ent7ca7q/node_modules/socket.io/node_modules/socket.io-client/node_modules/uglify-js/bin/uglifyjs
   npm ERR! code ENOENT
   npm ERR!
   npm ERR! Additional logging details can be found in:
   npm ERR!     /tmp/build_2phd1ent7ca7q/npm-debug.log
   npm not ok
 !     Failed to rebuild dependencies with npm
 !     Heroku push rejected, failed to compile Node.js app 
```

我想这与 socket.io 依赖关系有关，但我知识渊博，无法确切知道是什么。我创建了一个新的 git 存储库并从另一个存储库复制了它，因为该项目不在该存储库的根目录中，因此无法推送到 heroku，所以也许这与它有关。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:42:59.267

您会收到该错误，因为 使用的`uglifyjs`（`source-map`准确地说）的依赖项之一`socketio`要求 node 至少为`>= 0.8`，并且您正在使用`0.6.20`.

`npm info source-map@0.1.7`显示了这一点（删除了一些键）：

```
{ name: 'source-map',
  description: 'Generates and consumes source maps',
  'dist-tags': { latest: '0.1.8' },
  versions: 
   [ '0.0.0',
     ...
     '0.1.8' ],
  time: 
   { '0.0.0': '2011-08-30T19:45:40.104Z',
     ...
     '0.1.7': '2012-11-02T19:09:11.172Z',
     '0.1.8': '2012-11-19T22:48:36.067Z' },
  author: 'Nick Fitzgerald <nfitzgerald@mozilla.com>',
  version: '0.1.7',
  homepage: 'https://github.com/mozilla/source-map',
  engines: { node: '>=0.8.0' },
  dist: 
   { shasum: '92da34014a5576d60676150bcf0f55cbd1f395c0',
     tarball: 'http://registry.npmjs.org/source-map/-/source-map-0.1.7.tgz' } } 
```

从`engines`key可以看出，它至少需要node.js的版本`0.8.0`。

# objective-c - 在 appDelegate 中从一个 UITableView 导航到另一个 UITableView

> ID：14448476
> 
> 赞同：0
> 
> 时间：2013-01-21T22:36:59.323
> 
> 标签：objective-c, uinavigationcontroller, navigation, dropbox

第一个 UITableView 显示在从应用程序的 RootViewController 调用的 Popover 中。

我需要导航到同一个弹出框内的另一个 UITableView。如果您只是实例化第二个 UITableView 的对象并从第一个推送它，这很容易做到。

在下一段中，我认为一些事实是理所当然的，如果我错了，请纠正我。

这里的问题是这个过程应该在 appDelegate 内部完成。这是因为我正在实现 Dropbox API，并且我需要在登录过程完成后立即完成 pushViewController，这意味着必须在 application:handleOpenURL 内完成通过 UITableViews 的导航。我假设 application:handleOpenURL 必须在那里被调用，这就是为什么我还假设 pushViewController 必须在那里完成以便在 Dropbox API 验证窗口出现后完成导航，而不必让用户做任何其他事情.

这就是我的代码的样子：

AppDelegate.h

```
@interface AppDelegate : NSObject <UIApplicationDelegate>{
  UINavigationController *navigationController;
    NSString *relinkUserId;
  UIWindow *window;
  TableViewControllerForStorageList *rootViewController;
  ViewController *viewController;
}
@property (nonatomic, strong) IBOutlet UIWindow *window;
@property (nonatomic, strong) IBOutlet UINavigationController *navigationController;
@property (nonatomic, strong) IBOutlet TableViewControllerForStorageList *rootViewController;
@property (nonatomic, strong) IBOutlet ViewController *viewController; 
```

AppDelegate.m

```
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
  if ([[DBSession sharedSession] handleOpenURL:url]) {
        if ([[DBSession sharedSession] isLinked]) {
            [(TableViewControllerForStorageList *)self.window.rootViewController PushView];

        }
        return YES;
    }

    return NO;
} 
```

TableViewControllerForStorageList.h

```
-(void)PushView; 
```

TableViewControllerForStorageLost.m

```
-(void)PushView
{
  TableViewControllerIpadStorage *tableViewControllerIpadStorage = [[TableViewControllerIpadStorage alloc]initWithNibName:@"TableViewControllerIpadStorage" bundle:Nil];
  [self.navigationController pushViewController:tableViewControllerIpadStorage animated:YES];
} 
```

当然，我确定 Application:HandleOpenURL 正在运行，但是当从那里调用 PushView 时，错误是 [ViewController PushView]: unrecognized selector sent to instance

那么，如何从那里进行导航呢？我缺少关于目标 c 的哪些基础知识？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T01:05:02.947

从您的问题中不清楚您的应用程序的结构，因此这个答案可能不是解决您的问题的最佳解决方案，但希望它能让您了解您的视图控制器层次结构可能是如何从您的应用程序委托构建的。

假设您的第一个视图控制器类名为`FirstViewController`. 您的应用程序委托可以直接引用此视图控制器的实例，或者它可以通过父视图控制器（可能通过`window.rootViewController`）访问它。

现在假设您有一个`FirstViewController`名为的方法，`pushNextViewController`它执行推送第二个表视图控制器的任务。

`application:handleOpenURL:`您可以从应用程序委托的方法中调用该方法。

这可能看起来像：

```
[self.window.rootViewController.firstViewController pushNextViewController]; 
```

还有其他方法可以获取对您的实例的引用，`FirstViewController`如果您`rootViewController`是自定义子类，那么您可以在那里创建一个`pushNextViewController`方法并从该方法告诉您的`FirstViewController`实例`pushNextViewController`：

```
[self.window.rootViewController pushNextViewController]; 
```

请注意，在上面的两个示例中，您都需要将其`rootViewController`转换为它实际上是实例的任何类，否则编译器会警告您它没有属性`firstViewController`（示例 1）或方法`pushNextViewController`（示例 2）。

**编辑：**如果你`rootViewController`是 a `UINavigationController`，那么你的代码可能看起来更像：

```
UINavigationController* navController = (UINavigationController*)window.rootViewController;
FirstViewController* vc = navController.viewControllers[0];
[vc pushNextViewController]; 
```

**编辑2：**好的，看起来这里的混乱是`window`对象有一个`rootViewController`属性（它似乎指向你的`navigationController`），然后你`rootViewController`的应用程序委托中也有一个实例变量。这是两个不同的对象，使您的命名约定有点混乱，但如果我是对的，那么以下应该可以工作：

```
- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url {
    if ([[DBSession sharedSession] handleOpenURL:url]) {
        if ([[DBSession sharedSession] isLinked]) {
            [rootViewController PushView];

        }
        return YES;
    }

    return NO;
} 
```

您应该考虑将您的应用程序委托对您的引用的名称更改为其他名称，而`TableViewControllerForStorageList`不是`rootViewController`为了减轻一些混乱。

# javascript - 使用 _.some | _.any 适合低破折号或下划线

> ID：14448479
> 
> 赞同：26
> 
> 时间：2013-01-21T22:37:07.160
> 
> 标签：javascript, jquery, angularjs, underscore.js, momentjs

我正在尝试查看是否有任何一天是“01-01”（年初）

```
_.some(a.days, function(day){ console.log(day.date.format('DD-MM')) }, "01-01") 
```

在我的控制台中生成这个日期数组：

```
01-01
02-01
03-01
04-01
05-01
06-01
07-01 
```

所以然后我没有`console.log`这样的运行..：

```
_.some(a.days, function(day){ day.date.format('DD-MM') }, "01-01") 
```

它返回：

```
false 
```

奇怪，嗯？你认为我做错了什么？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-01-21T22:41:04.217

你误解了最后一个参数`_.some`是什么。[文档](http://underscorejs.org/#some)显示它是迭代器函数在其下运行的或`context`范围，但似乎您正试图将其用作相等测试的值。

您需要自己显式执行相等性测试。

```
_.some(a.days, function(day) {
    return day.date.format('DD-MM') === "01-01";
}); 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-01-21T22:41:21.253

您似乎误解了如何使用`_.some()`. 查看[文档](http://underscorejs.org/#some)，您会看到您的函数需要返回`true`or `false`，并且最后一个参数将用作`this`tat 函数。

你需要这样做：

```
_.some(a.days,function(day){ return day.date.format("DD-MM") == "01-01";}); 
```

# d3.js - D3 库 — 在此示例中如何从 JSON 访问数据

> ID：14448482
> 
> 赞同：4
> 
> 时间：2013-01-21T22:37:23.290
> 
> 标签：d3.js

我没有在标题中正确解释这个问题......对不起。

我正在关注 D3 标签云简单示例 [https://github.com/jasondavies/d3-cloud/blob/master/examples/simple.html](https://github.com/jasondavies/d3-cloud/blob/master/examples/simple.html)

我有一个 JSON 文件，其中包含推文标签、情感值和推文文本；（摘抄）

```
var words = [{"word":"disgrace","sentiment":"0.975","tweet":"Wheres Fred the weatherman? \nIn jail #disgrace #dirtyman @MrJimmyCorkhill"},{"word":"dirtyman","sentiment":"0.975","tweet":"Wheres Fred the weatherman? \nIn jail #disgrace #dirtyman @MrJimmyCorkhill"}]; 
```

我想将“tweet”值用作每个“文本”元素的“标题”元素。我尝试通过将我的推文放入 .words 函数（或 .map，我不知道：s）来做到这一点，因为其他数据是通过这种方式访问​​的，但我无法提取我的“推文”数据；

```
var fill = d3.scale.category20();
var words = <?php echo $tweets->getTweetTags(); ?>;

d3.layout.cloud().size([1000, 1000])
.words(words.map(function(d) {
return {text: d.word, size: d.sentiment * 40, tweet: d.tweet};
}))
.rotate(function() { return ~~(Math.random() * 2) * Math.random() * 1; })
.font("Impact")
.fontSize(function(d) { return d.size; })
.on("end", draw)
.start();

function draw(words) {
d3.select("#vis").append("svg")
.attr("width", 1000)
.attr("height", 1000)
.append("g")
.attr("transform", "translate(500,400)")
.selectAll("text")
.data(words)
.enter().append("text")
.style("font-size", function(d) { return d.size + "px"; })
.style("font-family", "Impact")
.style("fill", function(d, i) { return fill(i); })
.attr("text-anchor", "middle")
.attr("transform", function(d) {
return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
})
.text(function(d) { return d.text; })
.append("svg:title").text(function(d) { return d.tweet; } );
} 
```

d.tweet 返回未定义

我大概可以理解为什么我不能在 .words 或 .map 函数中使用我的推文，因为它们只需要某些参数，但我不知道如何将“推文”数据放入“标题”标签中每个“文本”元素。

谁能帮我这个？

**编辑：**带有内部 d3.json 函数的代码；

```
var data; // a global
            d3.json("../../../assets/json/tweetTags.json", function(error, json) {
              if (error) return console.warn(error);
              data = json;

              var fill = d3.scale.category20();

              d3.layout.cloud().size([1000, 1000])
                  .words(data.map(function(d) {
                    return {text: d.word, size: d.sentiment * 40, tweet: d.tweet};
                  }))
                  .rotate(function() { return ~~(Math.random() * 2) * Math.random() * 1; })
                  .font("Impact")
                  .fontSize(function(d) { return d.size; })
                  .on("end", draw)
                  .start();

              function draw(data) {
                d3.select("#vis").append("svg")
                    .attr("width", 1000)
                    .attr("height", 1000)
                  .append("g")
                    .attr("transform", "translate(500,400)")
                  .selectAll("text")
                    .data(words)
                  .enter().append("text")
                    .style("font-size", function(d) { return d.size + "px"; })
                    .style("font-family", "Impact")
                    .style("fill", function(d, i) { return fill(i); })
                    .attr("text-anchor", "middle")
                    .attr("transform", function(d) {
                      return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
                    })
                    .text(function(d) { return d.text; })
                    .append("svg:title").text(function(d) { return d.tweet; } );
              }

              d3.layout.cloud().size([300, 300])
              .data.map(function(d) {
                return {text: d, size: 10 + Math.random() * 90};
              })
              .rotate(function() { return ~~(Math.random() * 2) * 90; })
              .font("Impact")
              .fontSize(function(d) { return d.size; })
              .on("end", draw)
              .start();
            }); 
```

我不知道如何让它像那样工作。我已经制作了 json 文件，但现在我无法访问数据或运行云。

**编辑：**文本元素现在附加在结束正文标记之外:(

```
var data; // a global
            d3.json("../../../assets/json/tweetTags.json", function(error, json) {
              if (error) return console.warn(error);
              data = json;

              var fill = d3.scale.category20();

             d3.select("#vis").append("svg")
                 .attr("width", 1000)
                 .attr("height", 1000)
                 .append("g")
                 .attr("transform", "translate(500,400)")
                 .data(json)
                 .enter().append("text")
                 .style("font-size", function(d) { return d.sentiment * 40 + "px"; })
                 .style("font-family", "Impact")
                 .style("fill", function(d, i) { return fill(i); })

                 .text(function(d) {return d.word;})
                 .append("svg:title").text(function(d) { return d.tweet; } );

            }); 
```

**编辑：@Chris**这是您在 D3 json 函数中的示例代码以及我的自定义

```
d3.json("../../../assets/json/tweetTags.json", function(error, json) {
  if (error) return console.warn(error);

  var fill = d3.scale.category20();

  d3.layout.cloud().size([600, 500])
      .words(json.map(function(d) {;
            return {text: d.word, size: d.sentiment * 40, tweet: d.tweet};
       }))
      .rotate(function(d) { return ~~(Math.random() * 2) * 90; })
      .font("Impact")
      .fontSize(function(d) { return d.size; })
      .on("end", draw)
      .start();

  function draw(words) { 
      d3.select("body").append("svg")
          .attr("width", 600).attr("height", 500)
          .append("g").attr("transform", "translate(350,350)")
          .selectAll("text").data(words)
          .enter().append("text")
          .style("font-size", function(d) { return d.size + "px"; })
          .style("font-family", "Impact")
          .style("fill", function(d, i) { return fill(i); })
          .attr("text-anchor", "middle")
          .attr("transform", function(d) {
              return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
          })
          .text(function(d) { return d.text; }).append("svg:title")
          .text(function(d) { return d.tweet; } );
      }
}) 
```

但我无法从绘图功能访问 d.tweet ：s

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-22T07:37:18.320

我建议你应该使用内置的[json 导入函数](https://github.com/mbostock/d3/wiki/Requests#wiki-d3_json)而不是 php。我认为您遇到的问题是数据的读取是异步的，因此`words`在云中使用之前没有填充。

背后的原理`d3.json()`就是在这个函数中做所有事情，在加载json的时候会执行：

```
var data; // a global
d3.json("path/to/file.json", function(error, json) {
  if (error) return console.warn(error);
  data = json;
  visualizeit();
}); 
```

**编辑**

这是应该工作的代码示例，我刚刚在 json 函数中添加了[d3 云示例。](https://github.com/jasondavies/d3-cloud/blob/master/examples/simple.html)

```
d3.json("../../../assets/json/tweetTags.json", function(error, json) {
  if (error) return console.warn(error);

  var fill = d3.scale.category20();

  d3.layout.cloud().size([300, 300])    
      .words([  // To be replaced with data
        "Hello", "world", "normally", "you", "want", "more", "words",
        "than", "this"].map(function(d) {
            return {text: d, size: 10 + Math.random() * 90};
       }))
      .rotate(function() { return ~~(Math.random() * 2) * 90; })
      .font("Impact")
      .fontSize(function(d) { return d.size; })
      .on("end", draw)
      .start();

  function draw(words) {
      d3.select("body").append("svg")
          .attr("width", 300).attr("height", 300)
          .append("g").attr("transform", "translate(150,150)")
          .selectAll("text").data(words)
          .enter().append("text")
          .style("font-size", function(d) { return d.size + "px"; })
          .style("font-family", "Impact")
          .style("fill", function(d, i) { return fill(i); })
          .attr("text-anchor", "middle")
          .attr("transform", function(d) {
              return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
          })
          .text(function(d) { return d.text; });
      }
}) 
```

然后，当此版本工作时，您可以将其替换为`.words()`：

```
.words(json.map(function(d) {
  return {text: d.word, size: d.sentiment * 40, tweet: d.tweet};
})) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T08:59:25.203

您可以提取数据的其他条目吗？例如文字和情感？
也许您可以像下面的代码一样尝试。如果有效，您可以将其更改为您的代码。

```
var data; // a global
d3.json("path/to/file.json", function(error, json) {
  if (error) return console.warn(error);
  d3.select("#vis").append("svg")
    .data(json)
    .enter().append("text")
    .text(function(d) {return d.tweets;});
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-07T14:08:33.443

我对从 svg 容器中出来的单词有完全相同的问题，我通过在 translate 方法中插入一个名为 origin 的变量来解决这个问题。边界问题是由于只要您使用投影场的正确中心，算法就会将它们保留在内部，例如：宽度=300，高度=300，这意味着原点=150。我希望这对你有帮助。

# haskell - 内部服务器错误（尝试 Yesod Auth-package）

> ID：14448484
> 
> 赞同：1
> 
> 时间：2013-01-21T22:37:30.863
> 
> 标签：haskell, yesod

我正在关注用户授权的 y-book 示例，并计划将其放入脚手架示例中：显示第一页，有登录链接，如果使用 browserId 登录成功，则让用户去博客。

y-wiki 上有一个很好的例子，但我想试试这个。所以，在Foundation.hs里面的“instance Yesod App where”

```
-- route name, then a boolean indicating if it's a write request
isAuthorized HomeR True = isMyAuth
isAuthorized BlogR _ = isMyAuth
-- anyone can access other pages
isAuthorized _ _ = return Authorized 
```

在实例范围之外的那些之后：

```
isMyAuth = do
  mu <- maybeAuthId
  return $ case mu of
    Nothing -> AuthenticationRequired
    Just "mylog" -> Authorized
    Just _ -> Unauthorized "You must be an mylog" 
```

例如 YesodAuthApp 在哪里

```
-- type AuthId App = UserId
type AuthId App = Text 
```

并且还将 loginDest 更改为指向 BlogR。我应该如何使用 db-access 编写 getAuthId。我只想将它与 isMyAuth 函数中的相同文本“mylog”进行比较。通过将 getAuthId 注释掉，我们得到内部服务器错误。如果缺少此方法，是否可以阻止 ghc 编译？

和

getAuthId creds = return $ Just "mylog"

它似乎可以编译。但是，在“登录”之后，登录页面不会重定向到 BlogR 页面。

# actionscript-3 - 动作脚本 navigateToURL 不适用于 stage3d

> ID：14448485
> 
> 赞同：1
> 
> 时间：2013-01-21T22:37:33.027
> 
> 标签：actionscript-3, stage3d, navigatetourl

这个简单的代码对我不起作用：

```
stage.addEventListener(MouseEvent.CLICK, OnClick);

protected function OnClick(e:MouseEvent)
{
    navigateToURL(new URLRequest("http://www.stackoverflow.com"), "_blank");
} 
```

稍后我希望从 flascc 打开 url，但如果这样做可以轻松完成，如果这是因为安全原因，那么还有其他方法可以做到这一点吗？我在名为decision 2 的游戏中看到他们的网址甚至在所有浏览器的调试版flash player + 中也能正常工作。因此，如果 navigateToURL 有效，则必须有其他方法可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T05:44:09.763

将文件夹 f:\flascc（或所有磁盘 f:）添加到[安全面板](http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html)中的 flash 受信任位置（您也可以通过右键单击浏览器中打开的任何 swf 来打开此面板）

# c# - 扩展方法如何与继承一起工作？

> ID：14448487
> 
> 赞同：2
> 
> 时间：2013-01-21T22:37:36.610
> 
> 标签：c#, inheritance, extension-methods

我知道魔法的前半部分。假设我有：

```
public class Foo {}
public class static FooExt
{
    public static void M(this Foo f) {}
} 
```

当我调用`foo.M()`编译器将其更改为`FooExt.M(foo)`.

但是继承呢？例如：

```
public class Bar : Foo {}
public class static BarExt
{
    public static void M(this Bar b) {} 
} 
```

当我调用`bar.M()`时，它会调用`FooExt.M()`or`BarExt.M()`吗？事实上我测试了它，答案是`BarExt`，但为什么呢？`wow.M()`如果我有另一个`Wow : Foo`但没有，当我打电话时会发生什么`WowExt.M()`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-21T22:41:40.180

编译器将寻找其参数与调用站点的参数*最接近的扩展方法。*如果您有一个类型的变量，`Bar`那么`BarExt`将使用扩展，因为`Bar`它比 更具体，因此比采用实例`Foo`的替代方法更匹配。`Foo`这与如何解决模棱两可的方法重载并没有太大区别。

值得注意的是，这段代码将调用`FooExt.M()`：

```
Foo bar = new Bar();
bar.M(); 
```

这是因为扩展方法不是虚拟的。由于您调用方法的变量是 type `Foo`，因此`Bar`甚至不会考虑扩展方法的版本。 *扩展方法的绑定完全在编译时发生。*

在您指出的第二种情况下（对 type 的变量调用扩展方法`Wow`），`FooExt.M()`将使用该方法，因为没有比这更好的方法了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-21T22:41:44.573

> 我测试了它，答案是`BarExt`，但是为什么呢？

因为编译器会选择“最适合”调用的扩展方法。由于有一种`Bar`直接采用 a 的方法，因此选择了该方法。

> 如果我有另一个 Wow : Foo 但没有 WowExt.M()，当我调用 wow.M() 会发生什么？

同样，它将选择“最适合”使用的扩展。由于没有采用 a 的方法`Wow`，但采用它的方法是它的父类`Foo`，它会选择`FooExt.M()`

请记住，扩展方法实际上只是静态方法调用的语法糖，因此相同的规则适用于它们作为“正常”方法解析。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T22:42:31.427

解析扩展方法时，将选择最具体的类型匹配。在您的第一种情况下，`BarExt.M()`是最具体的（目标`Bar`而不是`Foo`）。

在第二种情况下，没有`Wow`扩展名，因此最具体的匹配是`FooExt.M()`.

# grand-central-dispatch - 为什么我在多线程 [NSString stringWithContentsOfURL:someURL]; 时收到 620 错 误？

> ID：14448489
> 
> 赞同：0
> 
> 时间：2013-01-21T22:37:40.213
> 
> 标签：grand-central-dispatch

这是我正在使用的代码片段。我有一个模型叫`x_locator`. 当我对模型进行多线程处理时，maps.google.com 返回 620 错​​误（请求太多太快），但是当我将模型留在主线程上时，它工作正常......只有在发出请求时 UI 被锁定.

```
-(CLLocationCoordinate2D) getLocationFromAddressString:(NSString*) addressStr {
    NSString *urlStr = [NSString stringWithFormat:@"http://maps.google.com/maps/geo?    q=%@&output=csv", 
                       [addressStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
    NSString *locationStr = [NSString stringWithContentsOfURL:[NSURL URLWithString:urlStr]];
    NSArray *items = [locationStr componentsSeparatedByString:@","];

    double lat = 0.0;
    double lon = 0.0;

    if([items count] >= 4 && [[items objectAtIndex:0] isEqualToString:@"200"]) {
        lat = [[items objectAtIndex:2] doubleValue];
        lon = [[items objectAtIndex:3] doubleValue];
    }
    else {
        NSLog(@"Address, %@ not found: Error %@",addressStr, [items objectAtIndex:0]);
    }
    CLLocationCoordinate2D location;
    location.latitude = lat;
    location.longitude = lon;

    return location;
} 
```

编辑：这是我尝试使用 GCD 的方式......这是在我的 ViewController 中

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    //set any delegates
    self.locationManager.delegate = self;
    [locationManager startUpdatingLocation];
    fuelMapView.showsUserLocation = YES;

    [self setInitialRegion];
    locationManager.distanceFilter = 100;

    //create the model
    x_locator = [[Locator alloc]init];
    x_locator.delegate = self;

    dispatch_queue_t finder = dispatch_queue_create("Locator", NULL);
    //if I do this, only some of the locations are found. If I leave it on the main thread, all locations are found.
    dispatch_async(finder, ^{
    [x_locator getUsersZipUsingLocation:[locationManager location]];
     });
} 
```

所做`getUsersZipUsingLocation:`的只是使用反向地理编码获取用户的邮政编码，然后它调用另一个方法来检索地址数组（根据用户的邮政编码），最后每个地址都使用转换为坐标位置`-(CLLocationCoordinate2D) getLocationFromAddressString:(NSString*) addressStr`

编辑2：我很犹豫是否要完整发布代码，因为人们可能会失去对问题的关注并继续判断我的编码是否优雅......

无论如何...在调用该方法之前`-(CLLocationCoordinate2D) getLocationFromAddressString:(NSString*) addressStr`，我必须将地址组合成可以作为变量传递的形式`addressStr`。地址是分块到达的，所以我组装这些部分，然后继续从 url 获取数据......

```
NSString *urlStr = [NSString stringWithFormat:@"http://maps.google.com/maps/geo?q=%@&output=csv",
                    [addressStr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]; 
```

数据返回后，我说`[NSThread sleepForTimeInterval:0.05];`并接受下一个请求。

感谢您的评论和时间:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T00:29:41.777

首先，`getLocationFromAddressString:`不应以`get`;为前缀 尝试`download`或`retrieve`忽略它（约定）。

其次，发布有关您如何实际使呼叫并发的详细信息。你提出了多少要求？

“请求太多太快”听起来非常准确；您需要限制在远程服务器上发送请求的速度。

我过去曾使用信号量来限制并发性。

[打开多个文件的大中央策略](https://stackoverflow.com/questions/4532509/grand-central-strategy-for-opening-multiple-files)

* * *

> 所有 getUsersZipUsingLocation: 所做的是使用反向地理编码获取用户的邮政编码，然后它调用另一个检索地址数组的方法（根据用户的邮政编码），最后使用 -(CLLocationCoordinate2D) 将每个地址转换为坐标位置getLocationFromAddressString:(NSString*) addressStr

通过以下方式调用它：

```
dispatch_async(finder, ^{
[x_locator getUsersZipUsingLocation:[locationManager location]];
 }); 
```

首先，您现在有一个异步调用来加载该信息。因此，“只找到一些”项目也就不足为奇了。一旦转向异步，*就必须使用某种通知机制来指示加载何时完成*。

假设这`usersZipUsingLocation:`是同步的，您可以：

```
dispatch_async(finder, ^{
[x_locator getUsersZipUsingLocation:[locationManager location]];
[self yoManILoadedTheGoodsDealWithTheUpdate];
 }); 
```

但这仍然不能解释你的 620。那个 620 表示你正在同时（或几乎如此）发出一堆请求。上述任何一项都没有声称的 50 毫秒延迟。

所以……这个故事似乎还有更多内容！:)

* * *

仍然不清楚您为什么要达到 API 请求限制。

你真的不应该使用睡眠机制来延迟这些事情。相反，如果绝对必要，可以结合使用类似信号量的模式来控制同时进行的飞行请求的数量（最好使用系统的异步加载 API）以及基于计时器的延迟。这会将所有与延迟相关的东西都推到系统上，而没有保证的线程契约（根据睡眠线程的要求）。

# android - 线性布局未设置为垂直方向

> ID：14448490
> 
> 赞同：1
> 
> 时间：2013-01-21T22:37:44.753
> 
> 标签：android, orientation, android-linearlayout

我正在扩展 LinearLayout 类，但方向存在一些问题。我正在将我正在创建的这个视图添加到其他线性布局中，但它仍然设置为水平。这是代码：

```
package com.simplemathgame;

import java.util.Date;

import android.content.Context;
import android.graphics.Color;
import android.view.Gravity;
import android.widget.LinearLayout;
import android.widget.TableLayout;

public class GraphBar extends LinearLayout {
    private Date date;
    private int totalDrills;
    private int rightDrills;
    private int score;
    private int height;
    private final int widht = 30;
    private final int totHeight = 300;
    LinearLayout.LayoutParams barParams;

    public GraphBar(Context context, int totalDrills, int rightDrills, Date date) {
        super(context);
        this.date = date;
        this.rightDrills = rightDrills;
        this.totalDrills = totalDrills;

        this.setScore();
        setParams();
        this.barParams = new LinearLayout.LayoutParams(0,this.widht);
    }

    private void setScore(){
        this.height = (this.rightDrills / this.totalDrills) * totHeight;
    }

    private void setParams(){
        this.barParams = new LinearLayout.LayoutParams(this.height,this.widht);
        this.barParams.setMargins(5, 0, 0, 0);
        this.setBackgroundColor(Color.CYAN);
        this.setOrientation(LinearLayout.VERTICAL);
        this.setGravity(Gravity.BOTTOM);
        this.setLayoutParams(this.barParams);
    }
} 
```

我试图在模拟器和我的华硕平板电脑中看到它。有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-13T10:38:47.497

在扩展 LinearyLayout 的类的构造函数中调用此方法 `setOrientation(LinearLayout.VERTICAL);`

# php - 表格在长字符串上扩展的问题

> ID：14448495
> 
> 赞同：0
> 
> 时间：2013-01-21T22:37:58.570
> 
> 标签：php, css, mysql, html-table

你可能会想，“嘿，孩子，这不是它应该这样做的问题。” 我非常清楚这一点。但是我想要实现的是，当框中的文本溢出我设置的初始 50px 时，我希望文本消失，我尝试了很多东西，包括`overflow:hidden`但我似乎无法弄清楚。我知道“表格是用于数据而不是外观”，但在这种情况下这是错误的......另外，我试图在所有可能的情况下避免换行。

HTML：

```
<td>;
$picksql="SELECT * FROM ".$tbl_name."
WHERE PortNumber='".$i."'"; 
    $result=$conn->query($picksql);
    while($row = $result->fetch(PDO::FETCH_ASSOC)) {
    echo $row['Entry1'].'<br>'.$row['Entry2'].'<br>'.$row['Entry3']; 
    $one=$row['Entry1'];
    $two=$row['Entry2'];
    $three=$row['Entry3'];
    }
</td> 
```

CSS：

```
td{
width:50px;
height:70px;
overflow: hidden;
} 
```

无视 php，`$row['Entry1']`是什么回响，我似乎无法用它实现我的目标。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:20:32.280

您可以通过添加`display: inline-block;` 我创建的小提琴[http://jsfiddle.net/QMCMA/](http://jsfiddle.net/QMCMA/)来演示这一点

# javascript - Javascript 对象有效负载

> ID：14448498
> 
> 赞同：0
> 
> 时间：2013-01-21T22:38:25.663
> 
> 标签：javascript, jquery

我有这段代码与 $.ajax jquery 调用的成功调用一起运行。

```
success:function(results){
    if(options.payload)
    {
        eval("AddReview."+options.payload+"("+results+")");
    }
} 
```

结果变量可以包含 html，并且似乎不想传递给函数。这是执行此操作的正确方法还是您能想到更好的方法？这种方法基本上允许我将 jquery $.ajax 功能与可变函数有效负载接口。或者在这种情况下，对象函数有效负载。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T22:40:12.367

当然有更好的方法。`eval`在这种情况下不需要：

```
if (options.payload) {
    AddReview[options.payload](results);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-21T22:40:26.960

对象本质上是关联数组。用这个。

```
AddReview[options.payload](results); 
```

正如[Blender](https://stackoverflow.com/users/464744/blender)所提到的， if`results`是一个字符串参数列表，例如`'hello', 'stack', 'overflow'`您可以执行此操作。

```
var addReview = AddReview[options.payload];

var args = $.map(results.split(','), function(arg) {
    return $.trim(arg).substr(1, $.trim(arg).length - 2);
});

addReview.apply(addReview, args); 
```

# javascript - 样式 twitter bootstrap navbar witout 将该样式应用于折叠的导航栏？

> ID：14448499
> 
> 赞同：1
> 
> 时间：2013-01-21T22:38:27.207
> 
> 标签：javascript, css, twitter-bootstrap, navbar

我在 twitter 引导导航栏上应用了一些样式，然后意识到我不想在折叠版本上使用这些样式。我首先寻找了一些应用类来区分折叠栏和未折叠栏，但我找不到。我打算尝试使用JS有条件地添加一个类......有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T22:49:41.153

将您的样式包装在媒体查询中，就像引导程序一样：

```
@media (min-width: 980px) {
    /* your conditional CSS*/
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-29T02:51:23.763

bootstrap navbar 的当前默认折叠宽度现在是 768px，因此为了仅为折叠的导航栏编写 css 样式，您将使用：

```
@media (min-width 768px) {
} 
```

# mysql - 如果列具有特定值的次数，则计数

> ID：14448501
> 
> 赞同：0
> 
> 时间：2013-01-21T22:38:32.990
> 
> 标签：mysql

我有一个表，其中有一个 id 列（跨行重复相同的 id）和列，`h1`每`h18`列可以包含 word`blob`或.`par``birdie`

我想计算单词出现的次数`blob`，`par`或者`birdie`出现在每个列`h1`中的次数。`h18``id`

我想最终得到一张像......

```
id blob par birdie
-- ---- --- ------
1  5    10  3
2  2    15  1
3  8    8   2 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:40:50.050

听起来您可能应该在某种程度上[规范化](http://en.wikipedia.org/wiki/Database_normalization)您的架构，但就目前情况而言：

```
SELECT id,
       (h1='blob'  )+(h2='blob'  )+...+(h18='blob'  ) AS blob,
       (h1='par'   )+(h2='par'   )+...+(h18='par'   ) AS par,
       (h1='birdie')+(h2='birdie')+...+(h18='birdie') AS birdie
FROM   my_table 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:06:26.153

也许你也可以考虑这个：

```
select
  id,
  sum(word='blob') as blob,
  sum(word='par') as par,
  sum(word='birdie') as birdie
from
  (select id, h1 word from words union all
   select id, h2 from words union all
   select id, h3 from words union all
   ...) w
group by id 
```

为了使查询更快，您还可以像这样编写子查询：

```
(select id, h1 word from words where h1 in ('blob', 'par', 'birdie') union all
 select id, h2 from words where h2 in ('blob', 'par', 'birdie') union all
 ...) 
```

但它变得有点难看。我建议您规范化您的数据库。

# javascript - 是否可以在 Meteor 事件映射中使用嵌套选择器？

> ID：14448504
> 
> 赞同：2
> 
> 时间：2013-01-21T22:38:38.853
> 
> 标签：javascript, css-selectors, meteor

在这里，我想`.accept`从元素中选择`.header`元素。这可能吗？[文档](http://docs.meteor.com/#eventmaps)没有定论，我尝试了一些变化无济于事，有什么我不知道的技巧吗？

```
'click .header .accept': function (event) { ... }, 
```

在 jQuery 中，我可能会使用这个：`$('.header .accept')`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T23:13:16.173

假设您在其他地方没有冲突，您共享的内容将起作用。尝试使用下面的代码。仅当您根据需要单击第二个 div 时才会触发该事件。

模板：

```
<body>
    {{> page}}
</body>

<template name="page">
    <div class="header">.header 
        <div class="accept">.header .accept</div>
    </div>
</template> 
```

js：

```
if (Meteor.isClient) {
    Template.page.events({
        'click .header .accept': function(event) {
            console.log('accept clicked');
        }
    });
} 
```

# c++ - 从子类中的线程调用纯虚函数会引发异常

> ID：14448506
> 
> 赞同：1
> 
> 时间：2013-01-21T22:38:56.307
> 
> 标签：c++, multithreading, inheritance, c++11, virtual

我有一个子类，它将基类的方法作为线程启动。子类还实现了基类的纯虚方法。然后线程需要在线程中调用子实现版本的纯虚方法，但是线程抛出异常：“调用了纯虚方法”。下面的代码演示了在构造 Child 时会发生什么：

```
class Base {
  std::thread messageThread;

  virtual void processMessage(std::string msg) = 0;

  static void checkForMessages(Base *c) {
    while(true) {
      std::string msg = "Hello";
      c->processMessage(msg);
    }
  }
};

class Child : public Base {
  Child() {
    messageThread = std::thread(checkForMessages, this);
  }

  void processMessage(std::string msg) {
     std::cout << "Message: " << msg << std::endl;
  }
}; 
```

我的理解是 Child 在构造函数完成之前仍然被认为是 Base ，因此线程只能将 processMessage 视为纯虚函数。我可以为 Base 的每个孩子实现 checkForMessages，但这首先违背了拥有 Base 类的目的。

我怎样才能正确地实现这一点？感谢您的帮助！

编辑：演示问题的完整示例，并尝试修复：[https ://gist.github.com/4590476](https://gist.github.com/4590476)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:42:37.113

您可以`std::thread(checkForMessages, this)`进入一个单独的`start()`方法，该方法必须在构造对象后由调用者调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:46:02.927

显然有很多方法可以解决这个问题。我的建议是使用两个类：一个用于包装线程，另一个用于实现您的“检查消息”。

```
lass Base {
  std::thread messageThread;

  virtual void processMessage(std::string msg) = 0;

  static void checkForMessages(Base *c) {
    while(true) {
      std::string msg = "Hello";
      c->processMessage(msg);
    }
  }
};

class Child : public Base {
  Child() {
  }

  void processMessage(std::string msg) {
     std::cout << "Message: " << msg << std::endl;
  }
};

class ThreadWrapper
{
    ThreadWrapper(Base *b)
    {
        messageThread = std::thread(Base::checkForMessages, this);
    }
    ... 
}

....
Child child;
ThreadWrapper tw(&child); 
```

另一个相当明显的选择是在单独的成员函数中启动线程。

如果这些都不是“好”，那么你可能想解释为什么，我们可能会想出一些其他的想法。

以下是“如何从不同的函数启动线程”的几个片段：

类子：公共基础公共：子（）{}

```
 void start(void) { messageThread = std::thread(checkForMessages, this); }

    ~Child() {
        messageThread.join();
    } 
```

……

```
int main()
{
    Child c;
    c.start(); 
```

我还修改了 checkForMessage 以在一段时间后退出。在我的测试用例中工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T23:30:28.450

在线程运行之前，没有什么可以阻止实例`Derived`被销毁（或至少开始被销毁）。您需要一些智能指针或一些同步。

# c# - 如何在 WCF netTcpBinding windows 服务中获取调用者的 URL？

> ID：14448510
> 
> 赞同：0
> 
> 时间：2013-01-21T22:39:06.863
> 
> 标签：c#, wcf, url, service, nettcpbinding

我需要获取调用应用程序的 URL，因为该服务会发送包含指向我的应用程序链接的电子邮件（例如，单击此处查看表单）。

我正在考虑将应用程序的 URL 硬编码在服务的 1 个位置，但是在本地工作时，本地主机端口有时会发生变化。此外，当部署到不同的测试环境时，我必须更改 URL。此外，与他人合作也会带来一些小问题。

最好的解决方案是动态确定它。第二好，web.config。第三好：硬编码。

如何解决此问题并获取调用应用程序的 URL？

编辑：不可能从客户端发送 url，因为该服务有一个定时事件来发送电子邮件通知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:58:47.307

也许IP可以帮助

试试这条线

```
((RemoteEndpointMessageProperty)OperationContext.Current.IncomingMessageProperties[RemoteEndpointMessageProperty.Name]).Address; 
```

这篇文章可以在漫长的道路上提供帮助 [http://keyvan.io/detect-client-ip-in-wcf-3-5](http://keyvan.io/detect-client-ip-in-wcf-3-5)

编辑

无法获取 URL，

类似的问题在这里 [我可以得到 WCF 调用者 URL...吗？](https://stackoverflow.com/questions/4147636/can-i-get-the-wcf-caller-url)

# c# - 如何在 Eval 中限制文本字符串

> ID：14448511
> 
> 赞同：9
> 
> 时间：2013-01-21T22:39:21.777
> 
> 标签：c#, asp.net, string, eval, truncate

我有一个带有这样设置的导航属性的超链接：

```
NavigateUrl='<%# Eval("My Text") %>' 
```

如何将字符串限制为 140 个字符？我试过这个 Eval("My Text").ToString().Substring(0,140) 但如果字符串长度小于 140 个字符，则会引发异常。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-21T22:43:55.060

还有另一种可能性：

```
Eval("My Text").ToString().PadRight(140).Substring(0,140).TrimEnd() 
```

编辑：

我也喜欢 LINQ：

```
Eval("My Text").ToString().Take(140).Aggregate("", (x,y) => x + y) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-04T08:48:41.533

用它 （：

```
< % # Eval("MyText").ToString().Length <= 30 ? Eval("MyText") : Eval("MyText").ToString().Substring(0, 30)+"..." % > 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-21T22:46:29.800

该死的我喜欢LINQ：

```
string.Concat('<%# Eval("My Text") %>'.ToString().Where((char, index) => index < 140)) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-21T22:42:40.370

您可以尝试 Truncate 方法，如下所示：

[C# 截断字符串](http://www.dotnetperls.com/truncate)

`this`只需在源参数之前添加关键字即可将其转换为扩展方法。这是一种更复杂的方法，但在您需要在其他地方重用它的情况下可能很有价值......

在您的情况下，您将拥有：

```
NavigateUrl='<%# Eval("My Text").ToString().Truncate(140) %>' 
```

完整的控制台测试应用程序：

```
using System;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            string test1 = "A really big string that has more than 140 chars. This string is supposed to be trunctaded by the Truncate extension method defined in class StringTool.";

            Console.WriteLine(test1.Truncate(140));

            Console.ReadLine();
        }
    }

    /// <summary>
    /// Custom string utility methods.
    /// </summary>
    public static class StringTool
    {
        /// <summary>
        /// Get a substring of the first N characters.
        /// </summary>
        public static string Truncate(this string source, int length)
        {
            if (source.Length > length)
            {
                source = source.Substring(0, length);
            }
            return source;
        }

        /// <summary>
        /// Get a substring of the first N characters. [Slow]
        /// </summary>
        public static string Truncate2(this string source, int length)
        {
            return source.Substring(0, Math.Min(length, source.Length));
        }
    }
} 
```

输出：

```
A really big string that has more than 140 chars. This string is supposed to be
trunctaded by the Truncate extension method defined in class 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-01T12:19:16.143

类似于 Leniel 的答案，但有一点不同。有时我喜欢附加一个省略号来证明显示的字符串已被截断。

```
 /// <summary>
    /// Converts the value of the specified string to a truncated string representation
    /// </summary>
    /// <param name="source">The specified string</param>
    /// <param name="length">Integer specifying the maximum number of characters to retain from the specified string.</param>
    /// <param name="appendEllipsis">Determines whether or not to append an ellipsis to the truncated result.  If the specified string is shorter than the length parameter the ellipsis will not be appended in any event.</param>
    /// <returns>A truncated string representation of the specified string.</returns>
    public static String Truncate(this String source, int length, bool appendEllipsis = false)
    {
        if (source.Length <= length)
            return source;

        return (appendEllipsis)
            ? String.Concat(source.Substring(0, length), "...")
            : source.Substring(0, length);
    } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-20T11:13:28.333

这对我有用 - 该`truncate()`功能没有在我的 Visual Studio 中启动，所以我使用了`Substring()`.

```
Text='<%# Eval("LastChangedTime", "{0:t}").ToString().Substring(0,10) %>' 
```

这将时间显示为最接近的 1/10 秒。

# asp.net-mvc - MVC，强类型视图与关注点分离

> ID：14448516
> 
> 赞同：0
> 
> 时间：2013-01-21T22:39:48.507
> 
> 标签：asp.net-mvc, model-view-controller, dynamic, separation-of-concerns, strongly-typed-view

我刚从书中得到一个例子

**控制器：**

```
[HttpPost]
public ViewResult RsvpForm(GuestResponse guestResponse)
{
   // TODO: Email guestResponse to the part organizer
   return View("Thanks", guestResponse);
} 
```

**看法：**

```
@model MvcApplication1.Models.GuestResponse 
@{
    ViewBag.Title = "Thanks";
}
<div>
    <h1>Thank you, @Model.Name!</h1>

    @if (Model.WillAttend == true)
    {
        @:It's great that you're coming. The drinks are already in the fridge!
    }
    else
    {
        @:Sorry to hear that you can't make it, but thanks for letting us know.
    }
</div> 
```

我相信这种方法违背了分离视图和模型/控制器逻辑的概念。

我的做法是：

**控制器：**

```
 [HttpPost]
    public ViewResult RsvpForm(GuestResponse guestResponse)
    {
        ViewResult v = View("Thanks");
        v.ViewBag.Name = guestResponse.Name;

        if (guestResponse.WillAttend)
        {
            v.ViewBag.Message = "It's great that you're coming. The drinks are already in the fridge!";
        }
        else
        {
            v.ViewBag.Message = "Sorry to hear that you can't make it, but thanks for letting us know.";
        }

        return v;
    } 
```

**看法：**

```
@{
    ViewBag.Title = "Thanks";
}
<div>
    <h1>Thank you, @ViewBag.Name!</h1>

    @ViewBag.Message;

</div> 
```

这个“问题”的目的是澄清视图应该用于查看和控制器用于控制显示的内容，并且书籍示例是“不好的方法”（我正在考虑作者只是想展示能力的事实MVC)

现在使用强类型视图（**带有逻辑代码**）真的是个好主意，还是回到某种 ASP 意大利面条代码？

考虑到高质量的企业设计，请给出一些好的反馈

**更新：** 我知道这是一个简单的例子，没有这样的验证，但是将逻辑放在模型中，然后在视图上访问结果，这是否是一个好习惯（为了这个例子）：

```
@Model.Message 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:46:50.960

关注点分离不是耦合本身，而是描述谁负责什么。在控制器中创建 UI 元素违反了关注点分离，而填充数据则没有。控制器和视图之间必然存在一些必要的耦合。毕竟控制器动作必须提供视图用来生成 UI 的数据。通常，在执行 MVC 时，我更喜欢强类型视图和 model-per-view。这给了我视图代码中强类型数据的好处。在实践中，通常会混合使用强类型视图模型和一些 ViewBag 数据以用于横切关注点。

至于在视图中使用逻辑，我会说“这取决于”。我使用了单独的视图，一个在几个部分（基于模型数据）之间进行选择的视图，控制流来选择 HTML 变体。选择哪种方法取决于模型/视图之间的差异程度。如果逻辑只是围绕选择 UI 显示，我很乐意将其留在视图中。我宁愿拥有它，然后将选择推回控制器。这将违反关注点分离。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T22:46:30.077

在视图中使用代码与拥有强类型视图不同。您可以轻松地拥有其中一个而没有另一个。强类型视图有几个优点，并且本身并不违反关注点分离。

在视图中使用分支代码可能会产生代码异味，实际上可能违反关注点分离，但这实际上取决于代码试图做什么。在您介绍的情况下，我认为这不是违规行为，因为视图中使用的字符串严格用于演示目的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T23:14:04.180

正如 tvanfosson 简洁解释的那样，关注点分离来自于控制器和视图的解耦。

与 web 表单和 asp 经典相反，MVC 架构将逻辑层（控制器）与表示层（视图）分开。只要每个代码位于不同的位置，我们就实现了关注点分离。

模型是从分离层传递信息的被动媒介。使模型强类型化加强了两者之间的“契约”，但不违反分离。您的数据访问方法可以从 ADO 演变为 ORM，而无需重新访问查看代码。您的 ORM 可以重构为使用 Web 服务，而根本不更改视图。

只有当您决定更改视图的传入或传出值时，您才必须更改视图。从本质上讲，这就是关注点分离。

# gcc - rpmbuild - 如何在构建时将某些包标记为冲突

> ID：14448518
> 
> 赞同：1
> 
> 时间：2013-01-21T22:40:11.540
> 
> 标签：gcc, mocking, rpm, rpmbuild

我必须使用与 centos 打包的编译器不同的编译器（gcc）。它也是 gcc，只是重新打包了已使用不同路径安装的较新版本。

我正在使用模拟构建，它的基本设置

**config_opts['chroot_setup_cmd'] = 'groupinstall build'**

在我的案例中，组构建包含 CentOS 库存 gcc。我无法在模拟环境中更改任何内容。

有没有办法在构建实际进行之前删除 gcc 包？

问题是我重新打包的 gcc 编译的一些程序倾向于使用系统 /usr/include/ 而不是重新打包的 gcc 中的正确包含，所以我正在寻找一种方法来定位问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T16:41:40.750

您可以尝试使用[Fedora 提供的说明](https://fedoraproject.org/wiki/Using_Mock_to_test_package_builds?rd=Extras/MockTricks#Building_packages_that_depend_on_packages_not_in_a_repository)来完成此任务，他们谈论在您需要安装的 rpm 不是 repo 的一部分时进行构建。

如果这不起作用，我会考虑设置自定义环境，或者如果您无法按照问题中的说明进行更改，请让您的管理员这样做。配置文件存储在 /etc/mock/*.cfg 下。我建议复制其中一个符合您的需求并将其命名为独特的名称。然后您需要添加一个额外的 repo 行（本地或远程，具体取决于您的自定义 GCC 副本所在的位置）。

如果它真的只是被标记为较新版本，这将配置环境以获取该版本的 GCC。如果有一些独特的命名约定或者由于某种原因没有被采用，您应该查看修改 chroot_setup_cmd 以简单地安装所有构建包。当我回顾一个

```
yum groupinstall buildsys-build 
```

我看到了所有相关软件包的列表。您显然会想要检查“构建”。然后，您可以修改您的 config_opts['chroot_setup_cmd'] 以使用“install”，而不是“groupinstall”，然后您可以在其中安装所有相关的构建包，以及您的自定义 GCC。

如果这仍然不起作用，您可以随时将构建包复制到 GCC 所在的您自己的个人仓库中，确保这是唯一可以从中提取的仓库，配置仓库以支持“构建”组，然后构建包裹。虽然由于年代久远，帮助不大，但[Mock 文档](http://fedoraproject.org/wiki/Docs/Drafts/MockSetupUsingLocalMirror)提供了一些有用的信息，可用于使用本地存储库配置您的环境。

# php - 来自带有 PDO 的存储过程的特定错误代码（在 Zend Framework 2 中）

> ID：14448519
> 
> 赞同：4
> 
> 时间：2013-01-21T22:40:12.040
> 
> 标签：php, mysql, stored-procedures, pdo, zend-framework2

我正在尝试使用 Zend Framework 2 中的存储过程启动并运行。我试图在存储过程中[返回带有 out 参数的错误代码](https://stackoverflow.com/questions/14416204/accessing-mysql-stored-procedure-output-in-zend-framework-2)，但我无法完成这项工作。然后我想，当发生错误时，我可以在 PHP 中捕获一个异常。问题是我似乎无法访问*特定*的错误代码 - 只有一般错误代码（例如 23000 - 违反完整性约束）。这是我*想做*的（或类似的）示例：

```
try {
    $result = $this->dbAdapter->query('CALL sp_register_user(?, ?)', array('username', 'password'));
}

catch (\Exception $e) {
    switch ($e->getCode()) {
        case 1062:
            // Duplicate entry
            break;

        case 1452:
            // Cannot add or update a child row
            break;
    }
} 
```

也就是说，我希望能够准确检查发生了哪个错误。但是，问题在于抛出的异常的错误代码为 23000 而不是上述之一。

在第 220 行`InvalidQueryException`抛出一个：`Zend\Db\Adapter\Driver\Pdo\Statement`

```
try {
    $this->resource->execute();
} catch (\PDOException $e) {
    throw new Exception\InvalidQueryException('Statement could not be executed', null, $e);
} 
```

在我的情况下，`PDOException`此处包含错误代码 23000。`null`参数是错误代码。所以在我的 catch 块中，我实际上会捕获`InvalidQueryException`一个错误代码为 0 的错误代码，这并不是那么有用。这个异常确实让我可以访问以前的异常（上面的最后一个参数），这将是`PDOException`，如下所示：

```
// try block omitted
catch (InvalidQueryException $e) {
    $previous_exception_error_code = $e->getPrevious()->getCode();
} 
```

在重复条目 (1062) 上，错误代码为 23000。对于“无法添加或更新子行”(1452)，它也是 23000。因此我不确定如何在我的应用程序中区分它们。如果我想针对这两个错误向用户显示不同的错误消息怎么办？异常消息是：`SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry 'user' for key 'username'`。但是，这是一个字符串，因此搜索错误代码太麻烦了。我希望仍然能够从我使用 PDO 作为具体实现的事实中抽象出来。

最后，这似乎更多地是关于 PDO 和 MySQL，而不是 ZF2。我不太确定从这里去哪里，所以任何关于我如何区分错误代码的想法都将不胜感激。也就是说，要知道何时发生错误 1062 或 1452 而不仅仅是 23000。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T22:46:33.783

您想要打开`$e->errorInfo[1]`，这是特定于驱动程序的错误代码（而不是标准化`SQLSTATE`值）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-30T20:07:00.570

可能会对一些身体有所帮助->有时try catch块效率不高，[请阅读此处](http://www.php.net/manual/en/pdostatement.errorcode.php)的评论

和[这里](http://www.php.net/manual/en/pdostatement.errorinfo.php)的解决方案。

# apache - mod_rewrite 将特定的 .asp 页面重定向回原始服务器

> ID：14448529
> 
> 赞同：0
> 
> 时间：2013-01-21T22:41:06.737
> 
> 标签：apache, mod-rewrite

我需要使用 apache mod_rewrite 规则将重新开发站点的一部分的流量重定向回原始站点。我需要将所有以[http://www.example.com/page.asp](http://www.example.com/page.asp)开头的请求重定向回原始站点[http://www.original.com/page.asp](http://www.original.com/page.asp)并带有查询字符串或 page.asp 之后的任何内容.

这看起来很简单，但是我没有使用 mod_rewrite 生成器或网络上的文档。我对这个问题的最新尝试是这样的：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^http://www.example.com$ [NC]
RewriteRule ^page\.asp(.*)$ http://www.original.com/page\.asp$1 [R=301,NC] 
```

感谢您对纠正此 mod_rewrite 规则的任何见解。其他重定向工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T17:12:28.137

我能够使用以下方法使重写正常运行：

```
RewriteRule ^/page(.+)  http://www.original.com/page$1 [R=301,NC,L] 
```

我发现这个 apache 文档很有帮助：[Resource Moved to another Server](http://httpd.apache.org/docs/trunk/rewrite/remapping.html#movehomedirs)

# ios - 从右侧推送视图控制器，动态导航控制器

> ID：14448533
> 
> 赞同：0
> 
> 时间：2013-01-21T22:41:11.213
> 
> 标签：ios, objective-c, xcode

我有一个带有按钮的 UIView，当用户单击该按钮时，我有另一个要推送的 xib 文件。现在这个视图没有导航控制器，所以我像这样动态地创建一个：

```
 myVC *viewController = [[myVC alloc] init];
   UINavigationController *controller = [[UINavigationController alloc] 
           initWithRootViewController:viewController];
   [self presentModalViewController: controller animated: YES]; 
```

但这是模态的，我怎样才能让 myV 从右边被推？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T06:33:43.650

试试下面的格式。这将对您有所帮助。

```
 myVC *viewController = [[myVC alloc] initWithNibName:"myVC" bundle:nil];
 viewController.modalTransitionStyle=UIModalTransitionStyleFlipHorizontal;
 [[self navigationcontroller] presentModalViewController:viewController animated: YES]; 
```

此代码用于水平翻转新的视图控制器。请参考“UIModalTransitionStyle”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T07:04:31.053

您需要编辑您的 appdelegate 类，并且您需要将视图控制器作为根类分配给导航控制器。然后它会自动将你所有的视图控制器转换为导航视图。试试看

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-17T11:59:04.737

1.  初始化视图控制器
2.  Intitilize UINavigationController root 作为第一步视图控制器
3.  展示导航

这是代码

```
let vc = SomeViewController()

let nav = UINavigationController(rootViewController: con)

present(nav, animated: true, completion: nil) 
```

# java - 我可以在检票口生成的 html 页面上使用 Selenium 访问属性键吗？

> ID：14448538
> 
> 赞同：1
> 
> 时间：2013-01-21T22:41:38.090
> 
> 标签：java, selenium, internationalization, wicket, automated-tests

我正在尝试使用 Selenium 为基于检票口的 Web 应用程序自动化前端测试。因此我有： - 不同的语言 - 语言属性文件（submit.signup.form=Submit）和使用它们的检票口消息（） - 检票口生成的 HTML 页面（输入类型：按钮和值：提交）

如果我继续使用它来自动化测试用例，它将正常工作。当有人决定将属性文件更改为 fi submit.signup.form=Send 时，问题就开始了。如果发生这种情况，我将不得不调整所有 Selenium 测试以再次检查正确的标签以使测试成功（这实际上不适用于该示例，但对于错误消息，这将是一个问题）

现在的问题：

有没有办法让检票口将属性键放入/放入生成的 html 文件中？

期望的好处：我可以使用 Java 并让 Selenium 获取属性 ke 并检查属性文件中的文本。这样，属性文件中标签的更改根本不会影响 Selenium 测试，并且会使其更容易处理。

我很感激任何答案。:)

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:57:37.273

默认情况下，Wicket 以开发模式启动。在开发模式下，您应该看到[wicket 标记](https://cwiki.apache.org/WICKET/wickets-xhtml-tags.html)，您应该查看[IDebugSettings](http://ci.apache.org/projects/wicket/apidocs/6.0.x/org/apache/wicket/settings/IDebugSettings.html) ，但是您不会看到从 java 代码中收集的属性，但是您可以将键添加为属性，例如

```
new Label(getString("propertieKey")).add(new AttributeAppender("key","propertieKey")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T13:36:37.837

实际上很容易做到。

放入您的应用程序初始化方法：

```
 getResourceSettings().getStringResourceLoaders().add(0, new NoResourceLoader()); 
```

实现 NoResourceLoader：

```
public class NoResourceLoader implements IStringResourceLoader {

@Override
public String loadStringResource(Class<?> clazz, String key, Locale locale, String style, String variation) {
     if ("noProperties".equals(style)) {
         return key;
     }
     return null;
}

@Override
public String loadStringResource(Component component, String key, Locale locale, String style, String variation) {
     if ("noProperties".equals(style)) {
         return key;
     }
     return null;
}
} 
```

如果样式设置为 noProperties，则此资源加载器仅返回键。当它返回 null 时，本地化程序将为任何其他调用尝试下一个资源加载器。

为了将样式设置为“noProperties”，我建议在页面的构造函数中添加一个参数检查，以便在您使用参数调用应用程序时设置会话对象的样式。

```
public BasePage(PageParameters pp) {
    String style = pp.get("st").toOptionalString();
    if (style != null) {
        getSession().setStyle("noProperties");
    } 
```

使用此参数集调用您的第一个 url 就足够了，然后您应该使用属性键而不是 html 中的值遍历整个会话。当应用程序在生产中运行时，我也会禁用此检查。

# c# - 没有聚集主键的映射表

> ID：14448541
> 
> 赞同：0
> 
> 时间：2013-01-21T22:41:57.310
> 
> 标签：c#, sql, linq, entity-framework-4, ef-code-first

当我有两个 POCO 类时`DataContext`（我将它们用作`DbSet<>`），EF 代码首先在幕后创建一个映射表：

```
class Subscription
{
   ICollection<Product> Products {get;set}
} 
```

和

```
class Product
{
   ICollection<Subscription> Subscriptions {get;set}
} 
```

和秘密映射表：

```
CREATE TABLE [dbo].[ProductSubscriptions](
  [Product_Id] [bigint] NOT NULL,
  [Subscription_Id] [bigint] NOT NULL
) ON [PRIMARY] 
```

在两个 ID 字段上有一个聚集的主键。

**问题：** 是否可以在两个字段上都没有聚集主键的情况下创建表？因为我在这里和那里有一个多对多的关系，因此有多个条目，例如：

```
{ Product_Id = 1, Subscription_Id = 1 }
{ Product_Id = 1, Subscription_Id = 1 }
{ Product_Id = 1, Subscription_Id = 2 }
{ Product_Id = 1, Subscription_Id = 2 }
... 
```

我删除了主键，但多次调用`DataContext.Products.Subscriptions.Add(1)`只添加一个项目，而不是它被调用的次数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T22:53:56.187

我认为您将必须明确拥有一个明确执行映射的实体。关系本身将具有一个 ID，因为它是主键而不是复合键。它假设（我认为是正确的）您的意图不是拥有多个关系实例。否则，如果您需要，它如何知道要编辑或删除哪一个？

另外，为什么*你*有多个关系实例？一个真的与另一个不同吗？或者，如果订阅有多个单一产品，您是否只需要添加“计数”？

看起来你需要这样的东西：

```
class Subscription
{
   ICollection<SubscriptionDetail> SubscriptionDetails {get;set}
}

class SubscriptionDetail
{
    Product Product {get; set;}
    int count {get; set;} // have a count vs. having multiple Product entries?
} 
```

# meteor - 是否可以在 Meteor 事件映射中使用 session.get() 作为选择器的一部分？

> ID：14448542
> 
> 赞同：0
> 
> 时间：2013-01-21T22:42:22.230
> 
> 标签：meteor

我只想将特定事件添加到符合特定条件的元素，在这种情况下，如果在会话中选择了该元素。这是一些示例代码：

```
Template.leaderboard.events({
    'click Session.get("selected_team") .win': function () {
        Teams.update(Session.get("selected_team"), {$inc: {won: 1, score : 5, played: 1}});
    }
}); 
```

这会在会话中查找选定的团队，然后更新该项目。那有意义吗？有没有更好的方法来实现我想要的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T01:25:19.757

在排行榜示例中，所选玩家的 css 类为“selected”，因此您需要做的就是：

```
Template.player.events({
  'click .selected': function () {
    console.log('clicked on the selected player:', this.name);
  }
}); 
```

您可以对可能希望有条件地触发事件的其他元素使用相同的模式：根据条件为它们（或不）分配特定的 css 类。

如果您不想通过模板向元素添加 css 类（无论出于何种原因），您最好只在 Javascript 中检查您的条件：

```
Template.player.events({
  'click': function () {
    if (Session.get("selected_player") === this._id) {
      console.log('clicked on the selected player:', this.name);
    }
  }
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-21T23:17:38.323

由于您已将 Session.get 语句作为字符串的一部分包含在内，因此它不会按照您编写的方式工作。像这样的东西可能会起作用：

```
Template.leaderboard.events({
  'click ' + Session.get("selected_team") + ' .win': function() {}
}); 
```

......但我不会推荐它。相反，您可能应该这样做：

```
Template.leaderboard.events({
  'click .team': function() {
    Teams.update(this.id, {...});
  }
});

Template.leaderboard.teams = function() {
  return Teams.find({});
} 
```

在您看来：

```
<template name="leaderboard">
  {{#each teams}}
    <div class="team">{{team}}</div>
  {{/each}}
</template> 
```

每个仍然在排行榜模板中记住它的上下文，在事件处理程序中`.team`被称为，所以你可以只传递给查询。`this``this.id`

# delphi - 下载代码并即时执行

> ID：14448544
> 
> 赞同：6
> 
> 时间：2013-01-21T22:42:30.683
> 
> 标签：delphi

执行应用程序时是否可以下载代码并执行/注入它？

我想在不使用更新程序的情况下保持我的 .exe 小且更新。

一直在谷歌搜索，但除了下载其他总是触发 Antivir 的 .exe 外，找不到任何东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T07:08:15.227

您应该将您的业务逻辑放在 dll 中，并且只将更新逻辑放在 exe 中。每次启动应用程序时，它都应该检查更新。如果需要，它将下载新的 dll 并更新其功能。

通过使 dll 动态加载，如果您在 exe 启动后首先检查更新，您甚至无需在执行更新时重新启动应用程序。

exe 内部的过程如下： 1\. 启动小型 exe 2\. 检查更新。如果需要，请在 dll 的特定位置下载 dll。3\. 从该特定位置加载 dll

当然，为了便于使用它，您不应该允许多个实例，因为如果您已经启动它并启动另一个实例，您将有另一种情况需要处理：您尝试进行更新但需要覆盖的文件正在使用中...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-22T07:13:23.350

有一种方法可以运行 exe，将其注入其他进程的地址空间。但可以肯定的是，您的软件会被启发式 av 标记为恶意软件。

如果您对这个概念感兴趣，这里是可以解决问题的[单元。](http://www.delphibasics.info/home/delphibasicssnippets/memoryexecutionunit-winxpwinvistawin7)

# xml - 从 web 服务返回数据表或 xml？

> ID：14448548
> 
> 赞同：1
> 
> 时间：2013-01-21T22:42:36.103
> 
> 标签：xml, web-services, datatable, dataset, asmx

我正在设计一个 C# web 服务，但我不确定输出单个客户记录的最佳实践是什么？

它目前返回一个 DataTable（它工作得很好），但这是“正常”的方法，还是我应该使用 DataRow、DataSet 或简单地构造一个普通的旧 XML 输出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:47:47.327

根据我使用 C# Web 服务的经验，将 DataTable 返回到前端是相当标准的做法。

如果您要返回单个记录，则不需要 XML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:56:21.953

理想情况下，Web 服务与平台无关。通常，返回`DataTable`或其他特定于 .NET 的类型并不是最佳实践。您的客户可能无法与他们打交道。

如果您只是返回一个客户，那么只需返回它。如果您要返回客户列表，则只需返回列表：

```
[OperationContract]
public Customer GetCustomer(int id);

[OperationContract]
public IEnumerable<Customer> GetAllCustomers(); 
```

WCF 将以允许您的客户处理返回的方式正确地序列化它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T22:50:17.587

一切都取决于您所期望的客户端，某些返回类型并非在所有设备上都可用，因为我尝试始终返回自定义类。

但是，如果您的最终结果适用于数据表，请使用它，我将数据表视为许多生产代码的返回类型

# c# - 这可以使用 lambda 用更少的代码来完成吗？

> ID：14448552
> 
> 赞同：1
> 
> 时间：2013-01-21T22:42:56.277
> 
> 标签：c#, linq, lambda

我有一个`List<Person>`（人）每个人都有一个`List<Kid>`（孩子）

如果我想找到所有有 5 岁以下孩子的人，我会做这样的事情

```
var peopleWithLittleKids=new List<Person>()

foreach(var p in people)
{
    foreach(var kid in p.Kids)
    {
        if(kid.age<5)
        {
            peopleWithLittleKids.Add(p);
            break;
        }
    }
} 
```

有没有一种使用 lambda 的方式来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-21T22:44:24.350

假设人们被允许拥有一个以上的孩子...... [在此处插入政治声明......]

```
people.Where(p => p.Kids.Any(k => k.age < 5)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-21T22:44:00.903

您可以使用[`Enumerable.Where`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.where.aspx)和[`Any`](http://msdn.microsoft.com/en-us/library/bb534972.aspx)扩展方法：

```
var peopleWithLittleKids = people.Where(p => p.Kids.Any(k => k.age < 5)).ToList(); 
```

请注意，`ToList()`如果您只是要遍历结果（通过`foreach`），您也可以停止，因为结果不需要 a `List<T>`。

另外 - 如果他们有多个匹配的孩子，你的循环方法将`Person`多次添加到列表中。如果你想复制这个功能，你可以通过：

```
var peopleWithLittleKidsContainingDuplicates = people
               .SelectMany(p => p.Kids.Where(k => k.Age < 5).Select(k => p)); 
```

（这可能不是您想要的，并且原始代码中存在错误，但这确实与原始代码匹配......）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T22:43:59.427

单独的 Lambda 无法解决您的问题。LINQ 是一种可以帮助您做您想做的事情的技术：

```
var peopleWithLittleKids = people.Where(p => p.Kids.Any(k => k.age < 5).ToList(); 
```

# asp.net-mvc - 如何使用 AttributeRouting 将路由添加到 /Checkemail 异步方法？

> ID：14448553
> 
> 赞同：1
> 
> 时间：2013-01-21T22:42:59.223
> 
> 标签：asp.net-mvc, attributerouting

**额外的：**

[下载](https://skydrive.live.com/embed?cid=E7737D00FF5B25E9&resid=E7737D00FF5B25E9!165&authkey=AJDrmQhgiJAmhU4)我尝试转换为 AttributeRouting 失败的项目。
当主页上的消息在“没有新电子邮件”之间变化时，该项目将正常运行。和“你有邮件！”。在其当前的错误状态下，该消息不会改变。
将显示 javascript 控制台中的错误。
使用浏览器直接导航到 /Checkemail 会导致 404 错误。

**原帖：**

这是一个关于[AttributeRouting](https://github.com/mccalltd/AttributeRouting)的问题（使用最新的 v3.4.1）。

我正在尝试将 a 挂接`GET[""]`到以下代码。

`[GET("")]`我得到一个 404 - 找不到资源。
`[GET("CheckEmail")]`我得到一个 405 - 不允许的方法。

我正在尝试将此项目转换为 AttributeRouting: [source code](http://clay.lenharts.net/blog/wp-content/uploads/MvcAsyncTest.zip)。checkemail 操作是我失败的地方。

该方法是作为“ [ajax 长轮询](http://clay.lenharts.net/blog/2010/10/19/websockets-is-cool-but-what-can-you-do-today/)”技术的一部分的异步方法。

我对我惨淡的尝试发表了以下评论：

```
public class CheckEmailController : AsyncController
    {
        //
        // GET: /CheckEmail/

        //tried [GET("")]
        //tried [GET("CheckEmail")]
        public void IndexAsync()
        {
            AsyncManager.OutstandingOperations.Increment();
            MyAsyncEmailChecker.CheckForEmailAsync(hasEmail =>
            {
                AsyncManager.Parameters["hasEmail"] = hasEmail;
                AsyncManager.OutstandingOperations.Decrement();
            });
        }

        private class IndexResponse
        {
            public bool d { get; set; }
        }

        public JsonResult IndexCompleted(bool hasEmail)
        {
            return this.Json(new IndexResponse() { d = hasEmail });
        }

    } 
```

Global.asax.cs - 对于我所有的 AR 项目

```
public class MvcApplication : System.Web.HttpApplication
{
    public static void RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(new HandleErrorAttribute());
    }

    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    }

    protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        RegisterGlobalFilters(GlobalFilters.Filters);
        RegisterRoutes(RouteTable.Routes);
    }
} 
```

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-29T15:53:36.627

如果您使用的是 ASP.NET MVC 4 和 .NET 4.5，那么您应该只使用 async 关键字和 Tasks。这应该可以解决您的路由问题并降低控制器的复杂性。这是微软白皮书的链接。

[http://www.asp.net/mvc/tutorials/mvc-4/using-asynchronous-methods-in-aspnet-mvc-4](http://www.asp.net/mvc/tutorials/mvc-4/using-asynchronous-methods-in-aspnet-mvc-4)

但总而言之，您的代码将更改为此。

```
public class CheckEmailController : AsyncController
{
    //
    // GET: /CheckEmail/
    [GET("CheckEmail")]
    public async Task<ActionResult> Index()
    {
      return View( new IndexReponse {
        d = await MyAsyncEmailChecker.CheckForEmailAsync() 
      });
    }

    public class IndexResponse
    {
        public bool d { get; set; }
    }

} 
```

# svn - 如何使用 VisualSVNServerHooks.exe 的提交后挂钩排除主干外的通知？

> ID：14448558
> 
> 赞同：2
> 
> 时间：2013-01-21T22:43:25.573
> 
> 标签：svn, visualsvn-server, svn-hooks

我们目前使用一个 SVN 挂钩（如下），它在存储库中的每次提交时发送电子邮件通知。我正在寻找一种方法来将通知限制在主干中发生的更改，不包括标签/分支/等。有没有办法使用[VisualSVNServerHooks.exe](http://www.visualsvn.com/support/topic/00018/)创建这样的限制？

当前的：

```
"%VISUALSVN_SERVER%\bin\VisualSVNServerHooks.exe" ^
commit-notification "%1" -r %2 ^
--from server@email.com --to emaillist@company.com ^
--smtp-server smtp.company.com 
```

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T09:02:11.563

该功能将在即将推出的 VisualSVN Server 2.6.0 中实现。

您还可以检查这个 QA 线程，它有一个可以帮助您的批处理脚本代码： [Post-commit 钩子，仅当提交影响特定路径时才执行操作](https://stackoverflow.com/q/11521100/761095)。

# entity-framework-5 - 实体框架 - group by 和 count 子句

> ID：14448561
> 
> 赞同：0
> 
> 时间：2013-01-21T22:43:39.297
> 
> 标签：entity-framework-5

我想在实体框架中使用 group by 和 count 子句编写查询。喜欢员工和经理，并根据经理显示所有员工

任何代码示例

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:02:58.200

```
var employeesByManager = db.Employees.
                            GroupBy(emp => emp.Manager.EmployeeName, emp => emp).
                            ToList();

var employeeCountsByManager = db.Employees.
                                 Select(emp => new { ManagerName = emp.EmployeeName, EmployeeCount = emp.Employees.Count() }).
                                 Where(a => a.EmployeeCount > 0).
                                 ToList(); 
```

当然，您可以按照与计数类似的方式按经理对员工进行分组。该`GroupBy`方法只是一种更简单的方法。

# ruby-on-rails - 语法错误 ruby on rails

> ID：14448569
> 
> 赞同：0
> 
> 时间：2013-01-21T22:44:20.273
> 
> 标签：ruby-on-rails, sqlite

我刚开始从务实的程序员'Agile Web Development with Rails'那里学习Ruby on Rails。

我写了一个小应用程序，当我运行它时，我收到以下语法错误：

```
/Users/colinlabri/Desktop/depot/app/models/product.rb:2: syntax error, unexpected ':',   expecting keyword_end
  attr_accessible : title, :description, :image_url, :price
                   ^
/Users/colinlabri/Desktop/depot/app/models/product.rb:2: syntax error, unexpected ',', expecting tCOLON2 or '[' or '.'
  attr_accessible : title, :description, :image_url, :price
                                        ^
 Rails.root: /Users/colinlabri/Desktop/depot

Application Trace | Framework Trace | Full Trace

app/controllers/products_controller.rb:1:in `<top (required)>' 
```

DB的代码如下：

```
class CreateProducts < ActiveRecord::Migration
  def change
    create_table :products do |t|
      t.string : title
      t.text :description
      t.string :image_url
      t.decimal :price, precision: 8, scale: 2

      t.timestamps
    end
  end
end 
```

版本如下： ruby​​ 1.9.3p362 Rails 3.2.11

我应该检查我的 sqlite 安装吗？如何检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:47:33.227

您只需要修复此行：

```
t.string : title 
```

到：

```
t.string :title 
```

您的模型在`attr_accessible`通话中也有同样的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T22:47:45.953

`:something`实际上是 Ruby 中的符号。`:`和符号名称之间不能有任何空格。

在迁移文件中更改`t.string : title`为。`t.string :title`

在您的产品模型中，

更改`attr_accessible : title`为`attr_accessible :title`

# c# - 链接表与 3 个表 - 架构设计

> ID：14448570
> 
> 赞同：0
> 
> 时间：2013-01-21T22:44:22.070
> 
> 标签：c#, sql, schema

我正在寻找一种向系统实施“上传附件”功能的方法。这些附件可以应用于 2 个领域，即调查答案和员工行动。我想要一个链接表，因为我想要一种实现附件存储库的方法，这样它们就可以应用于答案和操作，而不必再次上传相同的文档。我可以简单地创建一个链接表，例如：

INT - 附件 ID

INT - ApplysTo -> 系统中的枚举（如果是答案，则为 2，如果是操作，则为 2）

INT- ApplysToId -> 动作或答案的 ID

这是一个糟糕的设计吗？我有一种感觉，我正在以错误的方式解决这个问题。

这是我的第一篇文章，如果它没有达到标准，请原谅！

非常感谢，

克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:10:33.263

从设计的角度来看，这并不是不合适的，但由于 GUID 被用作您的主键，您可能可以删除 ApplyTo 字段，因为 GUID 保证是唯一的。

下面是一个示例，它将查找指定调查答案的所有附件：

```
SELECT
    AttachmentId
FROM
    Attachments
WHERE
    AppliesToId = @SurveyAnswerId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T00:06:47.880

这不是一个糟糕的设计，但您可能会发现这种设计更有用：

```
Attachment
AttachmentId (pkey)

Answer
AnswerId (pkey)
AttachmentId (fkey)

Action
ActionId (pkey)
AttachmentId (fkey) 
```

这允许您拥有没有任何操作的附件，而无需设置数据值，`NULL`并且 siple 连接显示同一附件的所有操作和答案，而不是条件连接

（伪代码）

```
select * from Attachment
outer join Answer on Answer.AttachmentId = Attachment.AttachmentId
outer join Action on Action.AttachmentId = Attachment.AttachmentId 
```

如果操作/答案可以有多个与之关联的附件，那么您将对其进行修改以包含交叉连接：

```
Attachment
AttachmentId (pkey)

Answer
AnswerId (pkey)

Action
ActionId (pkey)

AttachmentAnswer
AttachmentAnswerId (pkey)
AttachmentId (fkey)
AnswerId (fkey)

AttachmentAction
AttachmentActionId (pkey)
AttachmentId (fkey)
ActionId (fkey) 
```

# excel - 从 Access 2003 VBA 排序/操作 Excel 数据

> ID：14448572
> 
> 赞同：0
> 
> 时间：2013-01-21T22:44:25.213
> 
> 标签：excel, ms-access, vba, excel-2003

我正在尝试在 Access 2003 中运行一个模块，该模块需要一个 excel 文件，如果单元格中有信息，然后在 A1、B1 等中复制字段标题和单元格……因为它循环遍历每一行。单元格中也有需要复制数据的注释。

因此，在一个完美的场景中，代码将逐个单元格地遍历每一行，并获取用户、日期、单元格的数据和评论，并在已经存在的访问表中创建一条新记录。如果单元格是空的，那么它将被绕过。我有 4 张纸，我知道如何制作代码循环，我根本无法从 excel 中提取。

我也不想只导入数据，它需要用机智的评论进行排序。

任何建议将不胜感激。谢谢！

下面是我认为我得到的最接近的顺便说一句：

```
Sub copy3()

Dim rs2 As New ADODB.Recordset
Dim cnn2 As New ADODB.Connection
Dim cmd2 As New ADODB.Command

With cnn2
.Provider = "Microsoft.Jet.OLEDB.4.0"
.ConnectionString = "Data Source=C:\FilePath.xls;" & "Extended Properties=Excel 8.0;"
.Open
End With

Set cmd2.ActiveConnection = cnn2
cmd2.CommandType = adCmdText
cmd2.CommandText = "SELECT * FROM [Jan-Mar$] Where [Name] IS NOT NULL"
rs2.Open cmd2

While Not rs2.EOF
...Not sure what to write here but I got a msgbox to appear...
rs2.MoveNext
Wend 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:31:02.470

感谢 Remou 的建议和帮助。这最终对我有用：

```
Set rs = db.OpenRecordset("TestTable")
xl.Visible = False

Set ws = xl.Workbooks.Open("C:\file.xls").Sheets("Jan-Mar")
Set rng = ws.UsedRange

'Row 1 is all dates so start at Row 2
For i = 2 To rng.Rows.Count
    'Column A contains names so start at Column B
    For j = 2 To rng.Rows(i).Cells.Count
        If rng.Cells(i, j) = "" Or rng.Cells(1, j) = "Total" Then

    Else
        On Error Resume Next
        rs.AddNew
        rs!EmployeeName = rng.Cells(i, 1)
        rs!Date = rng.Cells(1, j)
        rs!PointValue = rng.Cells(i, j)
        str = rng.Cells(i, j).Comment.Text
        str = Right(str, Len(str) - 14)
        'MsgBox str
        rs!Comments = str
        rs.Update
    End If
Next
Next
Set rs = Nothing
Set rng = Nothing
ws.Parent.Close
xl.Quit 
```

# jquery - 是什么导致文本重叠？

> ID：14448574
> 
> 赞同：0
> 
> 时间：2013-01-21T22:44:36.550
> 
> 标签：jquery, html, css

我想知道如果文本对于单元格的宽度来说太大而不仅仅是进入下一行，那么附加在表格单元格中的一段文本如何相互重叠？

例如，我有一段文字，`The file upload was successful`但它的显示方式如下：

![在此处输入图像描述](../Images/d68319a35000f20638d47eb6a5cb22a5.png)

以下是表格单元格的 html 及其内容：

```
 var $fileVideo = $("<form action='videoupload.php' method='post' enctype='multipart/form-data' target='upload_target_video' onsubmit='return videoClickHandler(this);' class='videouploadform' >" + 
    "Video File: <input name='fileVideo' type='file' class='fileVideo' /></label>" +  
    "<input type='submit' name='submitVideoBtn' class='sbtnvideo' value='Upload' /></label>" + 
     "<p class='listVideo' align='left'></p>" +
    "<iframe class='upload_target_video' name='upload_target_video' src='/' style='width:0px;height:0px;border:0px;solid;#fff;'></iframe></form>"); 
```

下面是 jquery，它显示相关消息：

```
function stopVideoUpload(success, videoID, videofilename){

      var result = '';
      videocounter++;

      if (success == 1){
         result = '<span class="videomsg'+videocounter+'">The file was uploaded successfully</span>';
            $('.listVideo').eq(window.lastUploadVideoIndex).append('<input type="text" name="vidid" id="'+videoID+'" value="' + videoID + '" />');
            $('.listVideo').eq(window.lastUploadVideoIndex).append('<div>' + htmlEncode(videofilename) + '<button type="button" class="deletefilevideo" data-videoID="'+videoID+'"  data-video_file_name="' + videofilename + '">Remove</button><br/><hr/></div>');
          }

      $(sourceVideoForm).find('.videomsg').html(result);
      $(sourceVideoForm).find('.videomsg').css('visibility','visible'); 
      $(sourceVideoForm).find(".fileVideo").replaceWith("<input type='file' class='fileVideo' name='fileVideo' />");
      $(sourceVideoForm).find('.videof1_upload_form').css('visibility','visible');    

      return true;   
} 
```

下面是CSS：

```
 .videof1_upload_process{
    position:relative;
    visibility:hidden;
    text-align:center;
    margin-bottom:0px;
    padding-bottom:0px;
    margin-left: auto;
    margin-right: auto;
    }

.videofileupload{
    text-align:center;
    width:100%;
    margin:0px;
    padding:5px;
    font-size:85%;  
    }

.videouploadform{
    width:100%; 
}

.listVideo{
    text-align:left;
    margin:0;
    padding-left:0; 
}

.videomsg{
    line-height:0px;
} 

#qandatbl{
    border:1px black solid;
    border-collapse:collapse;
    table-layout:fixed;
}       

#qandatbl{
    width:100%;
    margin-left:0;
    float:left;
}

#qandatbl td { 
    vertical-align: middle;
}

#qandatbl th{
    border:1px black solid;
    border-collapse:collapse;
    text-align:center;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T23:22:48.277

问题在于以下规则：

```
.videomsg{
    line-height:0px;
} 
```

正如您设置的那样`line-height`，`0px`线之间没有空格，这就是它们相互重叠的原因。

# sql-server - SQL Server 2008 中的时区名称

> ID：14448576
> 
> 赞同：0
> 
> 时间：2013-01-21T22:44:44.153
> 
> 标签：sql-server, sql-server-2008, time, timezone

是否可以获取当前时区的名称，例如SQL Server 2008 R2`"Eastern Standard Time"`上`"EST"`的 SQL 代码？`getdate()`我知道我可以通过计算和之间的差异来确定数字本地时间偏移量`getutcdate()`，但这不是我需要的。我只需要来自底层操作系统的 TZ 名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T04:21:27.077

没有任何定义的表，如果你只是想从系统信息中读取时区信息，那么可以从系统注册表中读取。

```
declare @TZName varchar(50)

exec master.dbo.xp_regread 'HKEY_LOCAL_MACHINE',
'SYSTEM\CurrentControlSet\Control\TimeZoneInformation',
'TimeZoneKeyName',@TZName OUT

select @TZName 
```

拉吉

# magento - 产品从 Cat 转移到 Sub-Cat 未显示在站点搜索中

> ID：14448578
> 
> 赞同：0
> 
> 时间：2013-01-21T22:44:51.123
> 
> 标签：magento

在 Admin 中，我为 Cyber​​Power 类别创建了新的子目录。当我在我们的网站上搜索 BH1500 的产品时，我看到了糟糕的页面。如果我逐步浏览我们的网站以获取产品，它就可以正常工作。为什么 URL 丢失，或者链接也没有正确显示？

[http://www.unipower.com/products/ups/cyberpower/bh-series.html](http://www.unipower.com/products/ups/cyberpower/bh-series.html)，就是显示的内容。

然而这

[http://www.unipower.com/products/ups/cyberpower/bh-series/BH1500.html](http://www.unipower.com/products/ups/cyberpower/bh-series/BH1500.html)

应该是正确的链接。

Magento的新手，如果可以的话，请帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:22:44.003

您需要做的就是运行重新索引并刷新缓存！基本上，您的目录 URL 重写不正确或已过时。

`System > Index Management`- 最好选择所有元素，选择重新索引数据操作并单击提交按钮。

`System > Cache Management`- 刷新 Magento 缓存

# wpf - 如何参考 PART_XXX

> ID：14448595
> 
> 赞同：0
> 
> 时间：2013-01-21T22:46:30.077
> 
> 标签：wpf, custom-controls

将自定义控件模拟为窗口并获得正确的所有行为后，我现在正尝试将其转换为适当的自定义控件（称为“时间”，它是一个日期时间小部件）。

我准备了一个 When.XAML 文件，其中子元素被命名为 PART_xxx

```
<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:glob="clr-namespace:System.Globalization;assembly=mscorlib"
  xmlns:local="clr-namespace:Widgets">
  <local:DatePartPositionValueConverter x:Key="DatePartPositionValueConverter" />
  <local:DatePartVisibilityValueConverter x:Key="DatePartVisibilityValueConverter" />
  <Style TargetType="{x:Type local:When}">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type local:When}">
          <Border Background="{TemplateBinding Background}"
                  BorderBrush="{TemplateBinding BorderBrush}"
                  BorderThickness="{TemplateBinding BorderThickness}">
            <Border BorderThickness="1" BorderBrush="{DynamicResource 
                {x:Static SystemColors.ControlDarkBrushKey}}">
              <Grid HorizontalAlignment="Left" Margin="4,0,0,0">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition />
                  ...
                  <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="PART_year" Grid.Column="{Binding 
                    Converter={StaticResource DatePartPositionValueConverter}, 
                    ConverterParameter=y}">
                  <TextBlock.Text>
                  ... 
```

自定义控件项目 Generic.XAML 文件引用 When.XAML

```
<ResourceDictionary
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <ResourceDictionary.MergedDictionaries>
    <ResourceDictionary Source="/Widgets;component/Themes/When.xaml" />
  </ResourceDictionary.MergedDictionaries>
</ResourceDictionary> 
```

但是，我的代码似乎无法解析 PART_ 名称。

我希望能够将 _focussedElement 与（例如） PART_year 进行比较，以提供验证检查的上下文。必须可以从自定义控件的代码中直接引用 PART_xxx，否则无法使用代码将事件处理程序绑定到模板的元素。

我没有意识到什么？

* * *

为了解释和扩展下面的出色答案，PART_year*不在*范围内，因为 IDE 的代码生成魔法没有机会将其纳入范围。因此，您自己将其纳入范围，如下所示：

```
MenuItem PART_MenuItemToday, PART_MenuItemNow, 
  PART_MenuItemMonthEnd, PART_MenuItemMonthStart;
public override void OnApplyTemplate()
{
  base.OnApplyTemplate();
  PART_MenuItemMonthEnd = GetTemplateChild("PART_ContextMenuMonthEnd") as MenuItem;
  PART_MenuItemMonthEnd.Click += PART_ContextMenuMonthEnd_Click;
  ...
} 
```

当您需要将同一组处理程序挂钩到多个小部件时，您可以这样做

```
private void BindGenericHandlers(TextBlock textBlock)
{
  textBlock.GotFocus += PART_GotFocus;
  textBlock.LostFocus += PART_LostFocus;
  textBlock.MouseDown += PART_MouseDown;
  textBlock.MouseEnter += PART_MouseEnter;
  textBlock.MouseLeave += PART_MouseLeave;
}

TextBlock _focussedElement, PART_year, PART_month, PART_day, PART_hour, PART_minute, PART_second, PART_designator;

public override void OnApplyTemplate()
{
  base.OnApplyTemplate();
  BindGenericHandlers(PART_day = GetTemplateChild("PART_day") as TextBlock);
  BindGenericHandlers(PART_designator = GetTemplateChild("PART_designator") as TextBlock);
  BindGenericHandlers(PART_hour = GetTemplateChild("PART_hour") as TextBlock);
  BindGenericHandlers(PART_minute = GetTemplateChild("PART_minute") as TextBlock);
  BindGenericHandlers(PART_month = GetTemplateChild("PART_month") as TextBlock);
  BindGenericHandlers(PART_second = GetTemplateChild("PART_second") as TextBlock);
  BindGenericHandlers(PART_year = GetTemplateChild("PART_year") as TextBlock);
  ...
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:57:24.293

通过使用覆盖`GetTemplateChild`内的方法，您可以在代码中检索对 PART 的引用。`OnApplyTemplate`因此，在您的控件代码中，您将拥有以下内容：

```
private const string PART_TEXTINPUT = "PART_TEXT";
private TextBox _textInput;

public override void OnApplyTemplate()
{
   base.OnApplyTemplate();
   _textInput = GetTemplateChild(PART_TEXTINPUT) as TextBox;
} 
```

由于您使用的是 PART，因此您似乎在制作一个不美观的控件，因此，您不能直接引用 XAML 中的元素（因为自定义`ControlTemplate`可能会用意外的东西替换它）。因此，您可以使用该`GetTemplateChild`方法检索对 PART 的引用。

注意：一定要为部件使用尽可能低的类型（在您的代码中），以防有人用不同的实现替换您预期的控件。

# git - 这个绿色图标在 github 存储库中是什么意思？

> ID：14448601
> 
> 赞同：9
> 
> 时间：2013-01-21T22:46:51.767
> 
> 标签：git, github

这个绿色图标在 Github 中是什么意思？我知道提交链接将我带到另一个存储库。我需要做类似的事情。这是符号链接吗？还是子模块？对 git 还有些陌生，我想知道如何自己复制它。创建后，如何更新此外部依赖项？

![Git 存储库 - 绿色图标是怎么回事？](../Images/c135d0523611b7fa5b2ae81100f9a58c.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-21T22:49:09.400

这是一个子模块：指向不同 URL 的另一个存储库中特定提交的链接。运行时将克隆存储库`git submodule update --init`，然后`784fd39`将检出引用的提交 ( )。

您可以使用创建子模块`git submodule add <url> <directory>`，这将在当前工作目录中您指定的目录中添加给定 URL 的子模块引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-12T02:18:35.693

[您可以在此处](https://stackoverflow.com/a/43601977/4652621)使用此方法。它来自另一个问题，所以，那个主题是[远程 GitHub 中的灰色图标是什么意思](https://stackoverflow.com/questions/19584255/what-does-a-grey-icon-in-remote-github-mean?noredirect=1&lq=1) ？您可以忽略非常复杂的子模块步骤。

# java - 如何忽略使用 EclEmma 和 Eclipse 扫描某些类？

> ID：14448603
> 
> 赞同：5
> 
> 时间：2013-01-21T22:46:56.533
> 
> 标签：java, eclipse, eclemma

我正在使用 EclEmma（Eclipse 内部）扫描我的 JUnit 代码覆盖率。这可以正常工作 - 但是，我不希望 EclEmma 扫描我的`src/view`文件夹，因为它包含我认为不值得测试的 Swing 代码。

当 EclEmma 运行时，是否有任何方法可以忽略此文件夹，以便：a) 运行得更快，并且 b) 不会扭曲覆盖率？

编辑：

我的项目结构是：

```
src/view
src/model
src/controller 
```

我已经在 Preferences 页面中的 Path Entries 部分尝试了这些（可能还有其他）：

```
"src/view"
"src/view/*"
"view"
"view/*"
src/view 
```

这些正在使用“首选项”页面中的“排除”部分：

```
*
*View*
*View*.class
src/view/*View*
src/view/*View*.class 
```

他们都给我留下了分析我整个 src 文件夹的相同结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-02T22:05:03.250

[编辑] 维护人员说你不能，除了源目录级别：[https ://github.com/jacoco/eclemma/issues/70](https://github.com/jacoco/eclemma/issues/70)

我认为 eclemma 不排除文件：它是。只是不像我想的那样。

例如，当您进入首选项中的排除项并指定 your.classes.here.* 时，这意味着这些类不会计入您覆盖所有代码，而不是这些类不会包含在需要包含的内容中被测试覆盖。

试试看。尝试排除您知道其中包含的课程。一旦您将其置于排除首选项中，在新的覆盖范围运行中，它们仍会出现在覆盖窗口中，但它们会显示为 0%，并且都将显示为红色。

如果你问我，那是没用的。我仍在寻找一种适当的解决方案，以从需要被测试覆盖的类中按名称排除类。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-21T22:57:50.250

您可以[指定一个排除字段](http://eclemma.org/userdoc/preferences.html)：

> 排除：应从执行分析中排除的类名列表。列表条目由冒号 (:) 分隔，并且可以使用通配符（* 和 ?）。（默认：空）

但是，使用它们的选项进行类路径匹配可能更容易：

> 只有路径条目匹配：必须与类路径条目匹配的逗号分隔字符串列表。如果类路径条目包含给定字符串之一，则它与过滤器匹配。（例如“src/main/java”，默认：无过滤器）

请参阅[eclemma - 如何忽略](https://stackoverflow.com/questions/2937645/eclemma-how-to-ignore-source) 有关如何忽略 src 文件夹的源代码。

也请注意他们的谨慎，

> 警告：如果您的设置与项目中的任何类路径条目都不匹配，则覆盖模式下的每次新启动都将具有空的分析范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-13T11:27:48.143

我已经放弃了 EclEmma，因为我无法让它做我想做的事情，所以我使用了不同的方法 - 我会在这里记录它以防它帮助其他人。

1.  为了从测试中排除类，我将所有测试类命名为 *Case.java，然后通过 SuiteClasses 包含或排除它们。您可以在[https://github.com/junit-team/junit4/wiki/Aggregating-tests-in-suites阅读更多相关信息](https://github.com/junit-team/junit4/wiki/Aggregating-tests-in-suites)
2.  为了测量覆盖率，我使用 Maven 和 Cobertura。这将仅测试我的测试套件中指定的文件并相应地生成覆盖率报告。

# javascript - 使用 Razor，如何将布尔值呈现给 JavaScript 变量？

> ID：14448604
> 
> 赞同：164
> 
> 时间：2013-01-21T22:46:57.000
> 
> 标签：javascript, asp.net-mvc, razor

如何将布尔值呈现为 cshtml 文件中的 JavaScript 变量？

目前这显示了一个语法错误：

```
<script type="text/javascript" >

    var myViewModel = {
        isFollowing: @Model.IsFollowing  // This is a C# bool
    };
</script> 
```

* * *

## 回答 #1

> 赞同：338
> 
> 时间：2013-12-06T09:19:58.960

您可能还想尝试：

```
isFollowing: '@(Model.IsFollowing)' === '@true' 
```

更好的方法是使用：

```
isFollowing: @Json.Encode(Model.IsFollowing) 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2017-07-06T19:31:49.097

因为一次搜索把我带到了这里：在 ASP.NET Core 中，`IJsonHelper`没有`Encode()`方法。相反，使用`Serialize()`. 例如：

```
isFollowing: @Json.Serialize(Model.IsFollowing) 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2013-01-21T23:27:48.553

JSON 布尔值必须为小写。

因此，试试这个（并确保 nto`//`在行上有注释）：

```
var myViewModel = {
    isFollowing: @Model.IsFollowing.ToString().ToLower()
}; 
```

或者（注意：您需要使用命名空间`System.Xml`）：

```
var myViewModel = {
    isFollowing: @XmlConvert.ToString(Model.IsFollowing)
}; 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-01-21T22:48:27.173

```
var myViewModel = {
    isFollowing: '@(Model.IsFollowing)' == "True";
}; 
```

为什么`True`而不是`true`你问...好问题：
[为什么 Boolean.ToString 输出“真”而不是“真”](https://stackoverflow.com/q/491334/601179)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2019-08-27T09:00:00.883

一个更容易阅读的解决方案是这样做：

```
isFollowing: @(Model.IsFollowing ? "true" : "false") 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-05-07T06:35:23.727

这是另一个需要考虑的选项，使用 !! 转换为布尔值。

```
isFollowing: !!(@Model.IsFollowing ? 1 : 0) 
```

这将在客户端生成以下内容，将 1 转换为 true，将 0 转换为 false。

```
isFollowing: !!(1)  -- or !!(0) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-10T15:06:30.403

[定义一个转换操作](https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/user-defined-conversion-operators)并添加一个覆盖`.ToString()`可以节省很多工作。

`struct`在你的项目中定义这个：

```
/// <summary>
/// A <see cref="bool"/> made for use in creating Razor pages.
/// When converted to a string, it returns "true" or "false".
/// </summary>
public struct JSBool
{
    private readonly bool _Data;

    /// <summary>
    /// While this creates a new JSBool, you can also implicitly convert between the two.
    /// </summary>
    public JSBool(bool b)
    {
        _Data = b;
    }

    public static implicit operator bool(JSBool j) => j._Data;
    public static implicit operator JSBool(bool b) => new JSBool(b);

    // Returns "true" or "false" as you would expect
    public override string ToString() => _Data.ToString().ToLowerInvariant();
} 
```

## 用法

您可以直接转换 C# `bool`，如问题所示：

```
{
    // Results in `isFollowing : true`
    isFollowing : @((JSBool)Model.IsFollowing)
} 
```

但是您也可以`JSBool`直接在 Razor 代码中使用 a 并期望它会提供`true`并且`false`无需做任何额外的工作：

```
@{
    JSBool isA = true;
    JSBool isB = false;
    // Standard boolean operations work too:
    JSBool isC = a || b;
}

<script>
    if (@isC)
        console.log('true');
</script> 
```

这是因为我们上面定义的隐式转换运算符。

* * *

只需确保仅在您打算在 Razor 代码中使用它时才使用它。换句话说，不要将它与普通的 C# 一起使用，因为这会使您的代码变得混乱。

# emacs - 将 Emacs AUCTeX 与 Sumatra PDF 同步

> ID：14448606
> 
> 赞同：6
> 
> 时间：2013-01-21T22:47:07.367
> 
> 标签：emacs, latex, elisp, auctex

通过我的这些行，我`init.el`可以将 Emacs LaTeX 缓冲区与 Sumatra 同步：

```
(setq TeX-source-correlate-mode t)
(setq TeX-source-correlate-method 'synctex)
(setq TeX-view-program-list 
  '(("Sumatra PDF" ("\"C:/bin86/SumatraPDF/SumatraPDF.exe\" -reuse-instance" 
                      (mode-io-correlate " -forward-search %b %n ") " %o"))))
(setq TeX-view-program-selection  
      '(((output-dvi style-pstricks) "dvips and start") (output-dvi "Yap") 
       (output-pdf "Sumatra PDF") (output-html "start"))) 
```

要设置双击 PDF 以获取相关的 LaTeX 代码，我还在 Sumatra 选项中设置`Set inverse search command line`为：

```
"c:\bin86\GNU Emacs 24.2\bin\emacsclient.exe" --no-wait +%l "%f" 
```

尽管同步有效，但我想以不同的方式对其进行编码。

如果我没有设置最后一个表达式 ，`(setq TeX-view-program-selection...`我会得到与上面相同的默认值，除了 PDF 输出的值是：`(output-pdf "start")`。我想将此更改为“Sumatra PDF”并将其他值保留为默认值，也就是说，我想向 Emacs 询问查看器的默认值并仅更改 PDF 值。

这主要是关于变量操作的 ELisp 问题`TeX-view-program-selection`。感谢您的帮助。

PS请告诉我这个问题是否最适合[tex.stackexchange](http://tex.stackexchange.com)

## 基于lunaryorn评论/答案的更新

要更新`TeX-view-program-selection`我可以使用：

```
(assq-delete-all 'output-pdf  TeX-view-program-selection)
(add-to-list 'TeX-view-program-selection   '(output-pdf "Sumatra PDF")) 
```

第一行是可选的，但它使列表看起来“更干净”。

在这两种情况下（有或没有`assq-delete-all`）我现在都需要将代码插入到正确的钩子中，`TeX-view-program-selection`因为`init.el`.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-31T15:53:27.673

我的信用给lunaryorn的建议！我正在重新包装所涉及的步骤以使其他人受益。

## Emacs 端

添加到您的`init.el`：

```
(setq TeX-PDF-mode t)
(setq TeX-source-correlate-mode t)
(setq TeX-source-correlate-method 'synctex)
(setq TeX-view-program-list
   '(("Sumatra PDF" ("\"path/to/SumatraPDF/SumatraPDF.exe\" -reuse-instance"
                      (mode-io-correlate " -forward-search %b %n ") " %o"))))

(eval-after-load 'tex
  '(progn
     (assq-delete-all 'output-pdf TeX-view-program-selection)
     (add-to-list 'TeX-view-program-selection '(output-pdf "Sumatra PDF")))) 
```

## 苏门答腊一侧

在 Settings->Options 对话框中设置`Set inverse search command line`为：

```
"path\to\GNU Emacs ver\bin\emacsclient.exe" --no-wait +%l "%f" 
```

## 如何使用

在 Emacs 中的 LaTeX 文档中键入`C-c C-v`或双击 Sumatra 中的相关 PDF 并...享受））

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T09:37:38.417

使用`add-to-list`而不是`setq`. 有关`C-h f add-to-list`更多信息，请参阅。

`TeX-view-program-selection`在 中定义`tex.el`，因此您需要在加载此库后执行此代码：

```
(eval-after-load 'tex
  '(progn
     (assq-delete-all 'output-pdf TeX-view-program-selection)
     (add-to-list 'TeX-view-program-selection '(output-pdf "Sumatra PDF")))) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-29T02:39:52.973

windows -> emacs 的引用约定让我几乎发疯了如果您在默认位置安装 SumatraPDF，那么这适用于 windows 8.1

```
(setq TeX-view-program-list
   '(("Sumatra PDF" ("\"C:/Program Files (x86)/SumatraPDF/SumatraPDF.exe\" -reuse-instance"
          (mode-io-correlate " -forward-search %b %n ") " %o"))))) 
```

那是一个小时左右，我永远不会回来:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-25T17:53:57.947

我准备了一个批处理文件，`Emacs_SumatraPDF.bat`.

它可以完美`sumatra-forward.el`地实现向前和向后搜索。

## 例如：

**下载**

[http://www.ai.soc.i.kyoto-u.ac.jp/~shi/files/Emacs_SumatraPDF.bat](http://www.ai.soc.i.kyoto-u.ac.jp/~shi/files/Emacs_SumatraPDF.bat)

http://william.famille-blum.org/software/sumatra/sumatra-forward.el

* * *

**准备**

放`Emacs_SumatraPDF.bat`和`SumatraPDF.exe`--> `%Emacs_Home%/bin`。

放`sumatra-forward.el`——>`%Emacs_Home%/site-lisp`

* * *

**用法**

```
;Emacs_Home=C:/Program Files (x86)/GNU Emacs 23.4
;~\.emacs add following information

;;; Emacs_SumatraPDF.bat
;;  @info: pdf viewer 
;   @refer: 
(setq TeX-view-program-list '(
      ("Sumatra" "C:/Program Files (x86)/GNU Emacs 23.4/bin/Emacs_SumatraPDF.bat 
                   %o %t %n") ))         

(setq TeX-view-program-selection '(
     (output-pdf "Sumatra") 
     (output-dvi "Yap") 
     ((output-dvi style-pstricks) "dvips and start") 
     (output-html "start"))) 

 ;;; sumatra-forward.el
 ;;  @info: forward search. 
 ;   @refer: http:/william.famille-blum.org/blog/static.php?page=static081010-000413
 (require 'sumatra-forward) 
```

就这些。

* * *

**除了**

**Emacs 4 Latex 支持**Windows 7 下的 Emacs 新手。

[http://chunqishi.github.io/emacs4ls/](http://chunqishi.github.io/emacs4ls/)

* * *

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-24T11:30:58.187

值得一提的是，默认情况下在对话框中`Set inverse search command line`是不可见的。`Settings->Options`要显示此选项字段，请转到`Settings->Advanced options`或打开`SumatraPDF-settings.txt`并打开`EnableTeXEnhancements = true`。

# c# - 显示方形字符的 DataGrid

> ID：14448615
> 
> 赞同：1
> 
> 时间：2013-01-21T22:48:10.677
> 
> 标签：c#, character-encoding, datatable

几天来我一直在寻找解决这个问题的方法，但我还没有找到任何解决方案。我正在用 C# 构建一个玩具音频播放器，并且我的计算机上有一个包含所有音乐文件的小型 Access 数据库。当我将此数据库导入 DataTable 然后导入 a`DataGridView`时，我会得到这样的方形字符（无法在此处发布图像，所以这是一个链接）：

[http://imgur.com/4UwJSxE](http://imgur.com/4UwJSxE)

据我所知，这些字符在数据库中不存在。有人告诉我尝试该`ToString().Trim()`方法，但我不知道如何使用 SQL 来构建 DataTable。

这是代码：

```
public static DataTable GetLibraryDataTable()
    {
        OleDbConnection cnx = bTunesDB.GetConnection();
        cnx.Open();
        OleDbDataAdapter adapter = new OleDbDataAdapter("SELECT Artist, Title, Album, ReleaseYear, Genre, PlayCount, TrackOrderInAlbum, AlbumOrderInArtist, FilePath FROM Tracks ORDER BY Artist, AlbumOrderInArtist, TrackOrderInAlbum", cnx);
        DataTable dt = new DataTable();
        adapter.Fill(dt);
        return dt;
    } 
```

然后填充datagridview：

```
LibraryDataView.DataSource = bTunesDB.GetLibraryDataTable(); 
```

我尝试使用此代码修剪 DataTable 值，但问题仍然存在：

```
var dataRows = dt.AsEnumerable();
foreach (var row in dataRows)
{
      var cellList = row.ItemArray.ToList();
      row.ItemArray = cellList.Select(x => x.ToString().Trim(null)).ToArray();
} 
```

有人知道为什么会这样吗？我希望它是某种字符集设置或其他东西，但我对`DataTables`and不是很熟悉`DataGridView`。

# javascript - Javascript：控制台循环

> ID：14448619
> 
> 赞同：3
> 
> 时间：2013-01-21T22:48:26.393
> 
> 标签：javascript, for-loop

我刚刚被一位朋友提出以下问题：

```
var i, n = 20;
for(i = 0; i < n; i--) console.log("-"); 
```

Q) 更改单个符号（更改、删除、添加）以使代码打印“-”20 次。

我已经达到以下答案：

```
var i, n = 20;
for(i = 0; -i < n; i--) console.log("-");

var i, n = 20;
for(i = 0; i < n; n--) console.log("-"); 
```

他告诉我有三个答案，但我只能想出两个。有任何想法吗？这让我发疯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:09:34.730

```
for(i = 0; i + n; i--) console.log("-"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:09:11.760

使 n 减 20

```
var i, n = -20;
for(i = 0; i < n; i--) console.log("-"); 
```

# c# - 如何使用 SMO 获取和设置 SQL Server 2008 表的描述属性？

> ID：14448622
> 
> 赞同：1
> 
> 时间：2013-01-21T22:48:38.097
> 
> 标签：c#, sql-server, smo

如何使用 Microsoft.SqlServer.Management.Smo 获取和设置 SQL Server 2008 表的描述属性？我已经看到有关如何在列级别而不是表级别执行此操作的文档。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T04:04:37.350

我能够在 powershell 中执行以下操作：

```
$s = new-object microsoft.sqlserver.management.smo.server '.';
$db = $s.Databases['AdventureWorks2012'];
$t = $db.Tables | where {$_.Name -eq 'Address'};
$t.ExtendedProperties['MS_Description']; # will print current value
$t.ExtendedProperties['MS_Description'].Value = 'new value';
$t.ExtendedProperties['MS_Description'].Alter(); #persist the new value to the database 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:50:45.320

不记得了：是扩展属性中的描述吗？如果是这样，TableViewTableTypeBase.ExtendedProperties 将为您提供描述（Microsoft.SqlServer.Management.Smo.Table 继承）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-21T07:29:40.743

它在扩展属性中，我这样做：

```
string Description = table.ExtendedProperties["MS_Description"].Value.ToString(); 
```

您需要在字符串中指定您需要的扩展属性——这就是为什么您不能这么容易找到它的原因。

# performance - 解析器生成器的任何基准？

> ID：14448626
> 
> 赞同：9
> 
> 时间：2013-01-21T22:49:18.963
> 
> 标签：performance, parsing, generator, benchmarking

有没有人看过解析器生成器的性能比较？

我对以下内容特别感兴趣： 1) 用于 LALR(1) 语法的递归上升解析器生成器；2) 生成基于 C/C++ 的解析器的解析器生成器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:46:46.653

您对*解析器生成器*的运行速度感兴趣吗？取决于它支持的解析引擎的技术类型，以及实现解析器生成器的人的关心。有关真实语言的 LALR/GLR 解析器生成器的一些数字，请参阅此答案：[https](https://stackoverflow.com/a/14151966/120163) : //stackoverflow.com/a/14151966/120163 恕我直言，这不是很重要；解析器生成器通常比使用它们的人快得多。

如果问题是，*生成的解析器有多快？*你会得到不同的答案。LALR 解析器可以通过每个 GOTO 转换（使用直接索引的 GOTO 表）和每个归约几个机器指令来实现。这很难被击败。

# api - 是否制作以 API 为中心的应用程序？- 拉拉维尔

> ID：14448627
> 
> 赞同：4
> 
> 时间：2013-01-21T22:49:20.313
> 
> 标签：api, codeigniter, rest, laravel

所以。在过去的几周里，我开始了学习 Laravel 的旅程，并且非常享受它。

现在是重新设计网站的时候了，我认为是时候加强我们的一些功能了，所以我正在从 CodeIgniter 切换到 Laravel。

我想知道是否值得从 Laravel 中的 RESTful API 层开始（很容易创建）并将其用作 Web 应用程序的基础。将来我们可能会构建一个需要使用 API 的移动应用程序。所以：

1.  是否值得让 Web 应用程序连接到 API
2.  每次我想发出请求时，无需为 cURL 编写无数行即可调用 API 的最简单方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T00:13:05.610

这绝对值得。

我目前正在为一家成熟的托管公司重新设计一个凌乱的 PHP 代码，将其变成漂亮的 Laravel 代码。我已经有一个使用它的移动应用程序 - Laravel 可以很容易地用一行返回 JSON 数据 -

```
Response::json('OK', 200); 
```

或者

```
Response::eloquent(Auth::user()); 
```

或者

```
$tasks = Task::all();
Response::eloquent($tasks); 
```

据我所知，您不需要使用 CURL。您可以使用简单的 AJAX 发出所有请求，jQuery 会简化它。

此外，使用一些 MVC JS 框架将帮助您使客户端的应用程序代码结构更加优雅，其优点是当您准备好让您的 API 进行一些实际测试时，您可以轻松地将其打包到 PhoneGap 中。

今天我在我的博客上发布了一个简单的示例，您可以尝试看看这种方法是否值得您花时间： http: [//maxoffsky.com/code-blog/login-to-laravel-web-application-from-phonegap-或骨干网/](http://maxoffsky.com/code-blog/login-to-laravel-web-application-from-phonegap-or-backbone/)

如果您认为它在正确的轨道上，请检查并接受答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-22T00:20:46.057

与往常一样，您的结果可能会有所不同，但这正是我目前正在经历的。我正在使用这种 API 架构迁移一个大型 .Net 站点，我决定将它保留给 Laravel。

我个人决定这样做是因为：

1.  更具可扩展性。我可以设置 api.domain.com，然后随着流量的增长添加额外的框/vm/whatever。实际上，您可以通过“循环”或该域的多个 dns 条目仅对 api 进行负载平衡。

2.  新网站和应用程序的未来证明。听起来你处于同样的境地。我可以看到明年左右会添加一两个应用程序。

3.  损失成本。您已经布置了控制器，因此实际上只需将它们设置为 RESTful 并进行一些小调整以适应。

公平地说，一些反点：

1.  通过 API 处理可能会增加额外的加载时间，尽管这应该是最少的。

2.  如果您想将事情锁定在您的应用程序中，则需要考虑其他安全项目。

不管怎样，欢迎来到 Laravel！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T08:23:15.920

> > 每次我想发出请求时，无需为 cURL 编写无数行即可调用 API 的最简单方法是什么？

@Sneaksta 尝试使用邮递员 chrome 扩展来调用休息服务。您可以在此扩展程序中创建表单并将这些表单中的数据传递给您休息服务 [https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?utm_source=chrome-ntp-icon](https://chrome.google.com/webstore/detail/postman-rest-client/fdmmgilgnpjigdojojpjoooidkmcomcm?utm_source=chrome-ntp-icon)

# mongodb - 使用hint()跳过复合索引的第一项

> ID：14448628
> 
> 赞同：0
> 
> 时间：2013-01-21T22:49:36.717
> 
> 标签：mongodb

假设我有一个 Mongo 集合，其中包含字段`a`和`b`. 我已经用`{a:'a', b : index }`where`index`从 0 到 1000 迭代地增加了这个集合。

我知道这是非常非常错误的，但无法解释（没有双关语）为什么：

`collection.find({i:{$gt:500}}).explain()`确认没有使用索引（我可以看到它扫描了集合中的所有 1,000 个文档）。

![在此处输入图像描述](../Images/4bcc9bb30c53984b0be78b15d8f4f778.png)

不过，以某种方式强制 Mongo 使用索引似乎可行：

`collection.find({i:{$gt:500}}).hint({a:1,i:1}).explain()`

![在此处输入图像描述](../Images/0ce50d433565ca05667eac31b3349fec.png)

**编辑** Mongo 文档非常清楚，如果您的查询词之一与复合索引的第一个词匹配，它将仅使用复合索引。在这种情况下，使用提示，Mongo 似乎使用了复合索引`{a:1,i:1}`，即使查询词不包括`a`. 这是真的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T01:20:22.340

MongoDB 执行查询方式的有趣之处在于，它实际上可以并行运行多个查询以确定最佳计划。由于您在 shell 中进行的其他实验，或者即使您添加了数据以及它是否在内存中等/（或其他一些因素），它可能选择不使用索引。查看性能数字，它并没有报告使用该指数实际上比没有更快（尽管您通常不应该对这些数字进行太多评估）。在这种情况下，数据集真的很小。

但是，更重要的是，根据 MongoDB 文档，提示运行的输出还表明查询没有完全被索引 ( )[覆盖](http://docs.mongodb.org/manual/applications/indexes/#indexes-covered-queries)`indexOnly=false`。

那是因为您的索引是`a:1, i:1`，而查询是 for `i`。[复合索引](http://docs.mongodb.org/manual/core/indexes/#index-type-compound)仅支持基于索引字段的任何前缀的搜索（这意味着它们必须按照指定的顺序排列）。

[http://docs.mongodb.org/manual/core/read-operations/#query-optimization](http://docs.mongodb.org/manual/core/read-operations/#query-optimization)

仅供参考：使用[详细](http://docs.mongodb.org/manual/reference/method/cursor.explain/#cursor.explain)选项查看为 find() 考虑的所有计划的报告。

# javascript - 用jQuery计算输入框中的文件数？

> ID：14448635
> 
> 赞同：6
> 
> 时间：2013-01-21T22:50:15.397
> 
> 标签：javascript, jquery, file-upload, count

如何使用 jQuery 计算文件上传输入中的文件数？

我已经尝试过了，但它总是返回 1：

```
$("body").on("change", ".create-album .custom-file-input .createAlbumFileUpload", function(){   

    var numFiles = $("input:file", this).length;
    alert(numFiles);
}); 
```

我的 HTML：

```
<form enctype="multipart/form-data" class="createAlbumFileUpload">
    <input type="file" name="uploadFile[]" multiple="multiple"/>
</form> 
```

我在另一个问同样问题的问题上找到了这个[jsFiddle ，但是我不明白为什么我的不工作？](http://jsfiddle.net/ShankarSangoli/yQFXq/)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-21T22:52:13.157

您提供的小提琴包含答案。

```
var numFiles = $("input:file", this)[0].files.length; 
```

[http://jsfiddle.net/xvLAc/1/](http://jsfiddle.net/xvLAc/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-20T06:40:36.850

你也可以试试这个，

在 Div 中输入并给出一个 id，

```
var count =  $('#divPhoto').children().length; // You'll get the length in this. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-17T09:22:36.687

您可以使用以下代码和[https://jsfiddle.net/vvz3a4qp/2/](https://jsfiddle.net/vvz3a4qp/2/)轻松检查：

HTML：

```
<form name="myForm" enctype="multipart/form-data">
<input type="text" name="name">
<input type="file" name="name1" >
<input type="file" name="name2" ><br><br>
<span id="total"></span>
</form> 
```

JS：

```
 $("body").change(function(){
            alert($(":file").length);
            $("#total").html($("input[type=file]").length);
      }); 
```

# php - 试图获得独特的价值

> ID：14448638
> 
> 赞同：0
> 
> 时间：2013-01-21T22:50:26.927
> 
> 标签：php

我有以下代码

```
foreach($reportsResult->getRecords() as $key => $reportRecord){
    $input = array($reportRecord->getField('Term').' - '.$reportRecord->getField('Year'));
    $result = array_unique($input);
    print_r($result);
} 
```

这正在产生类似的输出

```
Array ( [0] => Winter - 2010 )
Array ( [0] => Winter - 2010 )
Array ( [0] => Winter - 2010 )
Array ( [0] => Winter - 2010 )
Array ( [0] => Winter - 2010 )
Array ( [0] => Winter - 2010 )
Array ( [0] => Winter - 2010 )
Array ( [0] => Winter - 2010 )
Array ( [0] => Winter - 2010 )
Array ( [0] => Spring - 2011 )
Array ( [0] => Spring - 2011 )
Array ( [0] => Spring - 2011 )
Array ( [0] => Spring - 2011 )
Array ( [0] => Spring - 2011 )
Array ( [0] => Spring - 2011 )
Array ( [0] => Spring - 2011 )
Array ( [0] => Spring - 2011 )
Array ( [0] => Spring - 2011 )
Array ( [0] => Summer - 2011 )
Array ( [0] => Summer - 2011 )
Array ( [0] => Summer - 2011 )
Array ( [0] => Summer - 2011 )
Array ( [0] => Summer - 2011 )
Array ( [0] => Summer - 2011 )
Array ( [0] => Summer - 2011 ) 
```

我想做的只是获得独特的价值，在这种情况下，冬季 - 2010 年，2011 年春季，2011 年夏季。

有人可以建议我如何做到这一点，我认为`array_unique`可能是解决方案，但我猜它是值存储在数组中的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T22:53:59.903

为什么不将值添加到在循环范围之外定义的数组中？

```
$array = array();

foreach($reportsResult->getRecords() as $key => $reportRecord){
    $array[] = $reportRecord->getField('Term').' - '.$reportRecord->getField('Year');
}

$array = array_unique($array); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T22:54:54.233

问题是您正在`$input`为每个循环设置一个项目数组。对单项数组执行`array_unique`操作将返回与您开始时相同的数组。

您需要在循环中构建一个数组，然后在`array_unique`循环外执行。像这样的东西：

```
$input = array()
foreach($reportsResult->getRecords() as $key=>$reportRecord){
    $input[] = $reportRecord->getField('Term').' - '.$reportRecord->getField('Year');
}
$result = array_unique($input); 
```

# variables - Tcl/tk 按钮 - 如何在命令选项上传递变量？

> ID：14448639
> 
> 赞同：5
> 
> 时间：2013-01-21T22:50:27.690
> 
> 标签：variables, button, tcl, tk

我在命令选项上传递变量时遇到问题，例如：

```
package require Tk
wm withdraw .
destroy .button
toplevel .button

# button.0: puts 0
set count 0
button .button.$count -text $count -command {puts $count}
grid .button.$count -column $count -row 0

# button.1: puts 1
incr count
button .button.$count -text $count -command {puts $count}
grid .button.$count -column $count -row 0 
```

但是 button.0 放置 1 而不是 0。似乎在调用 button.0 时，它采用了当时变量的值，即 1。

我发现我可以使用过程和全局变量来实现所需的结果，但我想知道是否可以在不诉诸过程调用的情况下实现这一目标。

先感谢您。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T00:33:24.163

如果要在定义回调时替换变量的*当前*值，则需要使用不同的引用机制：

```
button .button.$count -text $count -command [list puts $count] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T11:06:52.747

使用您的代码，您可以创建 2 个触发命令的按钮：

```
puts $count 
```

在您的示例中，当您按下按钮时，变量 $count 等于“1”，因此“放置”并显示该值。为了正确操作需要创建2个按钮。第一个按钮命令应该是“puts 0”。第二个按钮命令应该是“puts 1”。我们必须在创建按钮时应用替换。例如：

```
-command [list puts $count]
-command "puts $count" 
```

# iphone - UIImage 无法识别的选择器发送到实例

> ID：14448640
> 
> 赞同：0
> 
> 时间：2013-01-21T22:50:28.127
> 
> 标签：iphone

我有“经典”错误：

> 无法识别的选择器发送到实例。

如果我通读其他类似的问题，它应该与内存有关，但是我无法找出我做错了什么。

这是我尝试做的事情：

*   裁剪图像
*   给图像圆角

[我使用Trevor](http://vocaro.com/trevor/blog/2009/10/12/resize-a-uiimage-the-right-way/)的精彩代码

这是我的代码：

这`roundedCornerImage:borderSize:`是给麻烦

```
NSInteger my_borderSize = 0.1;
UIImage *Image_large = [image_sel croppedImage:CGRectMake((my_width/2) -(my_height*0.66)/2, 0, my_height*0.66, my_height) ];
UIImage *roundedCornerImage_temp = [Image_large roundedCornerImage:0.8 borderSize:my_borderSize]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T03:14:17.163

该方法不在 Apple 的`UIImage`课程中​​。它们是`UIImage`您链接到其代码的人编写的扩展。

您需要确保将**UIImage+RoundedCorner.h**和**UIImage+RoundedCorner.m 添加**到您的 Xcode 项目中，然后在您要使用的类中`roundedCornerImage:borderSize:`，您应该

```
#import "UIImage+RoundedCorner.h" 
```

另外，我注意到您正在为`cornerSize`和传递十进制值`borderSize`。`NSInteger`根据 Trevor 的 API，这些应该是值。我猜那些在 display *points*中，但显然，他将其限制为整数值。

**更新：**还要确保 UIImage+RoundedCorner.m 文件列在您的**Compile Sources**中：

![在此处输入图像描述](../Images/c1fa5e4a73395339f9ac1c0e15cec83b.png)

# c# - Windows Phone 7 - ScrollViewer 值已更改

> ID：14448643
> 
> 赞同：3
> 
> 时间：2013-01-21T22:50:34.977
> 
> 标签：c#, windows-phone-7, scroll, scrollbar, scrollviewer

我一直在寻找解决方案，但无法找到正确的解决方案。我有宽度为 960 的网格并`ScrollViewer`在其中。现在我想知道滚动时滚动的值（水平偏移）。我找到的所有解决方案都适用于 wpf/silverlight，它对我不起作用。

编辑

好的，这是示例代码，xaml：

```
<ScrollViewer Name="Scroll" LayoutUpdated="ScrollViewer_LayoutUpdated" IsEnabled="True" Width="480" ScrollViewer.HorizontalScrollBarVisibility="Auto">
    <Grid x:Name="ContentPanel" Background="Red" Margin="12,0,12,0" Width="960">
        <Rectangle Name="GreenRectangle" Fill="Green" Width="240" Height="240"></Rectangle>
    </Grid>
</ScrollViewer> 
```

C＃

```
private void ScrollViewer_LayoutUpdated(object sender, EventArgs e)
{
    GreenRectangle.Width = Scroll.HorizontalOffset;
    GreenRectangle.Height = Scroll.HorizontalOffset;
} 
```

但问题是它并不是一直在改变大小。也许我的英语不好，你听不懂我。这是电影示例，我向左向右滑动，大小始终相同。当我停止滑动时，它正在改变大小。

[https://www.dropbox.com/s/eh28oavxpsy19bw/20130122_1601_56.avi](https://www.dropbox.com/s/eh28oavxpsy19bw/20130122_1601_56.avi)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T09:58:29.693

可以通过使用 scrollviewers 依赖属性，它有一个 Horizo​​ntalOffset 和一个 VerticalOffset。诀窍是将事件绑定到滚动查看器，但可以在加载事件处理程序中完成。如果您在滚动查看器中放置一个宽网格，您可以获得偏移量！

在您的 xaml 文件中（此处为 MainPage 示例）：

```
 <ScrollViewer Loaded="ScrollViewer_Loaded_1">
        <Grid x:Name="ContentPanel" Grid.Row="1" Width="1000" Margin="12,0,12,0">
            <StackPanel>
                ... 
```

在文件后面的代码中（此处为 MainPage.cs）：

```
 public static readonly DependencyProperty ScrollViewVerticalOffsetProperty =
        DependencyProperty.Register(
                                    "ScrollViewVerticalOffset",
                                    typeof(double),
                                    typeof(MainPage),
                                    new PropertyMetadata(new PropertyChangedCallback(OnScrollViewVerticalOffsetChanged))
                                    );

        public static readonly DependencyProperty ScrollViewHorizontalOffsetProperty =
        DependencyProperty.Register(
                                    "ScrollViewHorizontalOffset",
                                    typeof(double),
                                    typeof(MainPage),
                                    new PropertyMetadata(new PropertyChangedCallback(OnScollViewHorizontalOffsetChanged))
                                    );

    private ScrollViewer _listScrollViewer;

    private void ScrollViewer_Loaded_1(object sender, RoutedEventArgs e)
    {
        _listScrollViewer = sender as ScrollViewer;

        Binding binding1 = new Binding();
        binding1.Source = _listScrollViewer;
        binding1.Path = new PropertyPath("VerticalOffset");
        binding1.Mode = BindingMode.OneWay;
        this.SetBinding(ScrollViewVerticalOffsetProperty, binding1);

        Binding binding2 = new Binding();
        binding2.Source = _listScrollViewer;
        binding2.Path = new PropertyPath("HorizontalOffset");
        binding2.Mode = BindingMode.OneWay;
        this.SetBinding(ScrollViewHorizontalOffsetProperty, binding2);
    }

    public double ScrollViewVerticalOffset
    {
        get { return (double)this.GetValue(ScrollViewVerticalOffsetProperty); }
        set { this.SetValue(ScrollViewVerticalOffsetProperty, value); }
    }

    public double ScrollViewHorizontalOffset
    {
        get { return (double)this.GetValue(ScrollViewHorizontalOffsetProperty); }
        set { this.SetValue(ScrollViewHorizontalOffsetProperty, value); }
    }

    private static void OnScrollViewVerticalOffsetChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        MainPage page = obj as MainPage;
        ScrollViewer viewer = page._listScrollViewer;

        // ... do something here
    }

    private static void OnScollViewHorizontalOffsetChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)
    {
        MainPage page = obj as MainPage;
        ScrollViewer viewer = page._listScrollViewer;

        // ... do something here
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T11:12:51.543

这是我使用的 XAML 代码

```
<Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0" LayoutUpdated='ContentPanel_LayoutUpdated'>

        <ScrollViewer x:Name='scroller' VerticalAlignment='Stretch' VerticalScrollBarVisibility='Visible' >
            <StackPanel
                x:Name='listItems'></StackPanel>
        </ScrollViewer>
    </Grid> 
```

这是后面的 C# 代码

```
private void ContentPanel_LayoutUpdated(object sender, EventArgs e)
    {
        var offset = scroller.VerticalOffset;
    } 
```

每当滚动滚动条时，网格（容器网格）的布局就会发生变化，因此会触发布局更新事件……请尝试通过在事件中放置断点并查找偏移值来进行调试……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-04T15:05:12.133

将属性 ManipulationMode="Control" 添加到 ScrollViewer。这是必要的，因为否则 UI 线程将不会收到足够的 ScrollViewer 滚动值来获得流畅的动画 - 正常模式是 Windows Phone 的性能优化，您需要绕过它！

# objective-c - FocusRingType 的 NSTextField 错误：无

> ID：14448644
> 
> 赞同：0
> 
> 时间：2013-01-21T22:50:38.017
> 
> 标签：objective-c, cocoa, nstextfield

NSTextField 中似乎有一个错误。当应用程序启动时，它会正确绘制。但是，只要我单击 textField，视图就会变得一团糟。更具体地说，每当我键入`drawRect:`时都会被调用，但使用较小的矩形会导致所有问题。

当我选择文本时，它会再次正确绘制。唯一的解决方案是将 设置`FocusRingType`为可见（例如：）`NSFocusRingTypeDefault`。但我想没有戒指。这可能吗？

这是我正在使用的代码：

```
-(id)initWithFrame:(NSRect)frameRect
{
    self = [super initWithFrame:frameRect];
    if(self)
    {
        // Add a label
        NSTextField *textField = [[NSTextField alloc] initWithFrame:CGRectMake(0, 0, frameRect.size.width, frameRect.size.height)];
        [[textField cell] setPlaceholderString:@"URL or search term..."];
        [textField setTextColor:[NSColor greyColor]];
        [textField setBackgroundColor:[NSColor clearColor]];
        [textField setFont:[NSFont fontWithName:@"Open Sans" size:20]];
        [textField setDrawsBackground:FALSE];
        [textField setBordered:FALSE];
        [textField setFocusRingType:NSFocusRingTypeNone];
        [self addSubview:textField];
    }

    return self;
}

-(void)drawRect:(NSRect)dirtyRect
{
    NSInteger borderWdith =  2;

    // Create the path to the button
    NSBezierPath *aPath = [NSBezierPath bezierPathWithRoundedRect:CGRectMake(borderWdith, borderWdith,
                                                                             dirtyRect.size.width-(borderWdith*2),
                                                                             dirtyRect.size.height-(borderWdith*2))
                                                          xRadius:3 yRadius:3];

    // Fill the button with white
    [[NSColor whiteColor] set];
    [aPath fill];
} 
```

`TRUE`将可编辑设置为/在 drawRect 中的技巧`FALSE`不起作用。在方法中设置为不同的 focusRingTypes 也失败了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T21:12:06.320

好的，所以我设法解决了这个绘图问题。在视图`init`方法中，我设置了一个全局`CGRect`变量，该变量设置为初始帧。

每次调用时，我都会用全局变量`-(void)drawRect:(CGRect)dirtyRect`覆盖。`dirtyRect`

希望这对任何人都有帮助。我想这不是最好的解决方案，但有效:)

# sql - SQL 视图优化

> ID：14448647
> 
> 赞同：0
> 
> 时间：2013-01-21T22:51:15.910
> 
> 标签：sql, sql-server, sql-server-2005, optimization

我继承了一个现有的系统，并试图弄清楚一些事情。

系统做了一个

```
SELECT * FROM v_myView WHERE mvViewCol = 'someValue' 
```

并根据`v_myView`_`Table1``myViewCol`

SQL Server 2005 是优化查询还是总在整个查询中发生求和`Table1`？

我知道我可以使用参数化视图，但不想进行不必要的更改。

干杯杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:18:07.077

视图根本没有运行时成本。它们总是内联到周围的查询中，就像您将视图定义粘贴为文本一样。否则它们将是不切实际的。

> SQL Server (2005) 是否优化查询或将总和始终发生在整个 Table1 中。

它将被优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:26:59.877

这是一个复杂的问题。我认为最好的解释在[这里](http://www.informit.com/articles/article.aspx?p=130855&seqNum=6)。我希望微软文档在这一点上更清楚一点。

创建视图时，会解析查询。这确保它是正确的。

执行计划在第一次运行查询时确定（非常接近）。然后，此执行计划保留在计划缓存中以供后续调用。因此，如果您在适当的列上有一个索引，并且第一次执行有一个`where`将使用该索引的子句，那么后续调用也将使用该索引。

我说的很接近，因为*当计划不在计划缓存中时*，这确实是第一次调用视图。对数据库的某些更改将刷新计划，重新启动服务器也是如此。

因此，如果您仅使用该`where`子句访问视图，则视图的后续使用将为此目的进行优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T23:22:28.347

SQL Server 2005 将在查询中每次引用它时优化视图：[http ://technet.microsoft.com/en-us/library/cc917715.aspx](http://technet.microsoft.com/en-us/library/cc917715.aspx)

“视图扩展后，SQL Server 查询优化器为正在执行的查询编译单个执行计划。”

我没有安装 2005，但它的操作类似于 2008R2 - 要查看查询优化计划，请在查询窗口中右键单击并选择“显示估计的执行计划”以获取更多信息并发现任何瓶颈。

在 Query 菜单选项中，有“Analyse Query in Database Tuning Advisor”可能对您也有帮助。

# php - 检查电子邮件是否存在php

> ID：14448649
> 
> 赞同：5
> 
> 时间：2013-01-21T22:51:29.240
> 
> 标签：php, email

我有一个问题，我有一个 php 脚本来检查电子邮件地址是否存在。

但似乎 yahoo、hotmail、aol 和其他提供商正在接受任何电子邮件，而不是拒绝无效电子邮件。

只有 Gmail 和许多像 stackoverflow.com 这样的域拒绝无效的电子邮件。

检查我的脚本，让我知道我是否可以做一些检查雅虎和其他人。

html 发布表单

```
<html>
<body>
<form action="checkemail.php" method="POST">
<b>E-mail</b> <input type="text" name="email">
<input type="submit">
</form>
</body>
</html> 
```

php

```
<?php

/* Validate an email address. */
function jValidateEmailUsingSMTP($sToEmail, $sFromDomain = "gmail.com", $sFromEmail = "email@gmail.com", $bIsDebug = false) {

    $bIsValid = true; // assume the address is valid by default..
    $aEmailParts = explode("@", $sToEmail); // extract the user/domain..
    getmxrr($aEmailParts[1], $aMatches); // get the mx records..

    if (sizeof($aMatches) == 0) {
        return false; // no mx records..
    }

    foreach ($aMatches as $oValue) {

        if ($bIsValid && !isset($sResponseCode)) {

            // open the connection..
            $oConnection = @fsockopen($oValue, 25, $errno, $errstr, 30);
            $oResponse = @fgets($oConnection);

            if (!$oConnection) {

                $aConnectionLog['Connection'] = "ERROR";
                $aConnectionLog['ConnectionResponse'] = $errstr;
                $bIsValid = false; // unable to connect..

            } else {

                $aConnectionLog['Connection'] = "SUCCESS";
                $aConnectionLog['ConnectionResponse'] = $errstr;
                $bIsValid = true; // so far so good..

            }

            if (!$bIsValid) {

                if ($bIsDebug) print_r($aConnectionLog);
                return false;

            }

            // say hello to the server..
            fputs($oConnection, "HELO $sFromDomain\r\n");
            $oResponse = fgets($oConnection);
            $aConnectionLog['HELO'] = $oResponse;

            // send the email from..
            fputs($oConnection, "MAIL FROM: <$sFromEmail>\r\n");
            $oResponse = fgets($oConnection);
            $aConnectionLog['MailFromResponse'] = $oResponse;

            // send the email to..
            fputs($oConnection, "RCPT TO: <$sToEmail>\r\n");
            $oResponse = fgets($oConnection);
            $aConnectionLog['MailToResponse'] = $oResponse;

            // get the response code..
            $sResponseCode = substr($aConnectionLog['MailToResponse'], 0, 3);
            $sBaseResponseCode = substr($sResponseCode, 0, 1);

            // say goodbye..
            fputs($oConnection,"QUIT\r\n");
            $oResponse = fgets($oConnection);

            // get the quit code and response..
            $aConnectionLog['QuitResponse'] = $oResponse;
            $aConnectionLog['QuitCode'] = substr($oResponse, 0, 3);

            if ($sBaseResponseCode == "5") {
                $bIsValid = false; // the address is not valid..
            }

            // close the connection..
            @fclose($oConnection);

        }

    }

    if ($bIsDebug) {
        print_r($aConnectionLog); // output debug info..
    }

    return $bIsValid;

}
$email = $_POST['email'];

$bIsEmailValid = jValidateEmailUsingSMTP("$email", "gmail.com", "email@gmail.com");
echo $bIsEmailValid ? "<b>Valid!</b>" : "Invalid! :(";
?> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-21T23:02:36.573

如果您需要超级确定电子邮件地址是否存在，请向其发送电子邮件。它应该包含一个带有随机 ID 的链接。仅当单击该链接并包含正确的随机 ID 时，才会激活用户的帐户（或发布广告、发送订单或您正在执行的任何操作）。

这是验证电子邮件地址是否存在并确保填写表格的人可以访问它的唯一可靠方法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-21T23:04:04.457

没有 100% 可靠的方法来检查电子邮件地址的有效性。不过，您可以做一些事情来至少清除明显无效的地址。

电子邮件地址出现的问题实际上与蜗牛邮件的问题非常相似。以下所有三点也可用于发送蜗牛邮件（只需将 DNS 记录更改为物理地址即可）。

**1.检查地址格式是否正确**

检查电子邮件地址的格式非常困难，但是 PHP 有一个[验证过滤器](http://php.net/manual/en/filter.filters.validate.php)可以尝试这样做。过滤器不处理“[评论和折叠空白](https://github.com/php/php-src/blob/PHP-5.4.7/ext/filter/logical_filters.c#L514)”，但我怀疑有人会注意到。

```
if (filter_var($email, FILTER_VALIDATE_EMAIL) !== FALSE) {
    echo 'Valid email address formatting!';
} 
```

**2.检查域名的DNS记录是否存在**

如果存在 DNS（域名系统）记录，那么至少有人设置了它。这并不意味着该地址有电子邮件服务器，但如果该地址存在，则更有可能。

```
$domain = substr($email, strpos($email, '@') + 1);
if  (checkdnsrr($domain) !== FALSE) {
    echo 'Domain is valid!';
} 
```

**3.发送验证邮件到地址**

这是查看某人是否在电子邮件地址的另一端的最有效方法。如果没有以有序的方式回复确认电子邮件（例如 3 小时），那么地址可能存在问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-06-27T00:42:50.983

您可以使用 Telnet 验证“使用过的或真实的”电子邮件，MX 在[此处](http://lifehacker.com/5697360/how-to-verify-if-an-email-address-is-real-or-fake)记录更多信息，因为 PHP 存在一个很棒的库调用[php-smtp-email-validation](http://code.google.com/p/php-smtp-email-validation/)来简化流程。

您使用文件 example1.php 创建一个布尔函数，并在您验证电子邮件文本时调用它。对于 Gmail、Hotmail、Outlook、live 和 MSM，我没有任何问题，但使用 Yahoo 和 Terra，库无法正确验证电子邮件

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-12-16T07:35:45.263

问题是 gmail`25`为他们的 smtp 外发邮件使用端口，其他提供商使用不同的端口进行连接。您的回复似乎还可以`gmail.com`。

当您连接到 gmail smtp 时，它会为您提供 `response 250 2.1.5 OK j5si2542844pbs.271 - gsmtp`

但是，当您连接到任何其他不使用端口 25 的 smtp 时，它会给您`null`响应。

# ssh - 如何在腻子中定义与远程桌面的隧道连接？

> ID：14448655
> 
> 赞同：7
> 
> 时间：2013-01-21T22:51:58.460
> 
> 标签：ssh, remote-desktop, putty, rdp, tunnel

我需要（在 rdp 中）连接到我大学网络中的一台机器（我们称之为 #1）（我有它的内部 IP），我还可以在 ssh 中访问同一网络中的 Linux 服务器机器，我可以用来访问#1，我正在使用腻子，有人可以向我解释如何连接到它吗？

[我的笔记本电脑] --->[Linux 服务器] --->[windows 机器] in rdp

谢谢，

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-02T16:36:38.813

让我们假设以下内容：

Linux 服务器 - `gate.college-server.com:22`（SSH 侦听端口 22）

内部服务器 - `internal.college-server.com:3389`（RDP 侦听端口 3389）

RDP 连接将打开`localhost:3399`（应该打开）

如何通过带有 RDP 转发的 Putty 配置 SSH 隧道：

*   打开 Putty 并在`Session`输入 Linux 服务器的连接信息
*   转到分支 > 连接 > SSH > 隧道
*   选择`Local`和`Auto`
*   在`Source Port`enter`3399`和`Destination`- 内部机器的连接信息中，格式为：`hostname:port`.
*   点击添加

您将在该部分中看到条目`Forwarded ports`，例如：

```
4L3399   internal.college-server.com:3389 
```

保存您的连接，即可使用。

接下来，`PuTTy Session`使用 Saved Connection启动 a，*成功*登录 远程服务器*后*，您可以启动 Windows RDP 客户端。*`gate.college-server.com:22`*

 *将其连接到 localhost:3399 并使用 RDP 凭据`internal.college-server.com:3389`*

# matlab - 元素总数

> ID：14448660
> 
> 赞同：-3
> 
> 时间：2013-01-21T22:52:18.750
> 
> 标签：matlab

测试上下文：... [x,y] = calc_barrel_pos(xpos, ypos, turret_width, bucket_length, theta, player)

测试题：calc_barrel_pos 函数应该返回的元素总数（即单个数字）是多少。（提示：变量的数量与元素的数量相同吗？）

我的解释：“返回”一词通常意味着输出什么，因此，函数的值，对吗？因此，x,y 是 2 个不同的数字。这个答案是错误的，而指示的答案 4 意味着它是变量的数量。我完全不明白。

为什么是4？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:35:53.653

我认为提示暗示即使返回了 2 个变量`x`& `y`，元素的数量可能会更多。由于正确答案是 4，我猜`x`和`y`是每两个元素向量。或者可能有 4 个元素`x`和另外 4个元素`y`，它们代表盒子角上的点。如果不知道 calc_barrel_pos 的作用，就很难确定。

只是为了澄清元素和变量之间的区别，在行中`x=[1 3];`x 是一个变量，但它有 2 个元素。

# php - 返回月份和年份目录名称和文件夹大小

> ID：14448662
> 
> 赞同：1
> 
> 时间：2013-01-21T22:52:31.407
> 
> 标签：php

我有一个目录，其中包含年份的子目录（例如 2009），并且在这些子目录中包含月份的子目录（例如 02）

我需要计算每个月文件夹中的文件总数，以及每个文件夹的文件总大小，并输出两个总数（总大小和文件总数）以及年份和月份文件夹名称。

**例子：**

*   05/2009 - 512MB（12 个文件）

*   06/2009 - 45KB（21 个文件）

*   07/2009 - 6MB（8 个文件）

*   01/2011 - 54MB（2 个文件）

*   04/2011 - 652MB（55 个文件）

...

我创建了以下函数来计算目录的总大小和文件。如何调整它以适应上述多子文件夹列表？

```
function foldersize($path) {
    $total_size = 0;
    $total_files = 0;

    $files = scandir($path);

    foreach($files as $file) {
        if ($t<>"." && $t <> "..") {
            if (is_dir($path.'/'.$file)) {
                $size = foldersize($path.'/'.$file);
                $total_files++;
                $total_size += $size;
            }
            else {
                $size = filesize($path.'/'.$file);
                $total_files++;
                $total_size += $size;
            }
        }   
    }

    return $total_size.' | '.$total_files;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:34:25.987

您应该使用`RecursiveDirectoryIterator`递归地遍历子目录。

```
$_recursiveIterator = new RecursiveDirectoryIterator(
    $path, FilesystemIterator::SKIP_DOTS);
$iterator = new RecursiveIteratorIterator(
    $_recursiveIterator, RecursiveIteratorIterator::SELF_FIRST);
foreach($iterator as $subdirPath => $subdirInfo) {
    if ($subdirInfo->isDir()) {
        echo $subdirPath . ' ' . foldersize($subdirPath);
    }
} 
```

这里发生的事情有点难以理解，并且 SPL 迭代器没有很好地记录，所以我将尝试解释：

*   [迭代器](http://php.net/manual/en/class.iterator.php)是实现特殊接口的对象，因此它们可以在`foreach`循环中使用
*   [`RecursiveDirectoryIterator`](http://php.net/manual/en/class.recursivedirectoryiterator.php)是文件系统的递归迭代器。递归迭代器是一种特殊类型的迭代器，它在每次迭代中自己产生一个迭代器。它们可用于嵌套数据结构。
*   `SKIP_DOTS`告诉它忽略`.`and`..`条目
*   [`RecursiveIteratorIterator`](http://php.net/manual/en/class.recursiveiteratoriterator.php)用于“展平”递归迭代器。它通过递归迭代器并在单个循环中产生所有后续条目。
*   `SELF_FIRST`表示父母先于子女（即 2009 年 2009/01 年之前）
*   在循环中，关键`$subdirPath`是每个项目的路径和对象的值`$subdirInfo`（[`SplFileInfo`](http://php.net/manual/en/class.splfileinfo.php)实际上，它是 RecursiveDirectoryIterator 本身，它最终从 SplFileInfo 扩展 - 但此时这并不重要）
*   isDir() 检查当前项是否为目录

下一步将重构您的`foldersize()`函数以使用迭代器。一次迭代所有文件和大小计算可能是明智的。*编辑：查看 Mike Brant 的答案以获得这样的解决方案，上面的解释也适用于此。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:15:48.763

您应该查看SPL 中提供的`recursiveDirectoryIterator`和类。`recursiveIteratorIterator`这应该可以很好地满足您的需求。

[http://php.net/manual/en/class.recursivedirectoryiterator.php](http://php.net/manual/en/class.recursivedirectoryiterator.php) http://php.net/manual/en/class.recursiveiteratoriterator.php

示例用法：

```
$path = realpath('/path/to/directory');
$total_files = 0;
$total_filesize = 0;
$dir_files = 0;
$dir_filesize = 0;

$iterator = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($path, FilesystemIterator::SKIP_DOTS), RecursiveIteratorIterator::SELF_FIRST);
$first_dir = true;
foreach($iterator as $path => $object){
    if ($path->isDir()) {
        // echo out information from last directory
        if (false === $first_dir) {
            echo "Number of Files in Directory: " . $dir_files . "\nTotal File Size of Directory: " . $dir_filesize . " bytes\n\n";
            // reset directory counters
            $dir_files = 0;
            $dir_filesize = 0;
        }
        // start new directory output
        echo $path->getPathname() . "\n";
    } else if ($path->isFile()) {
        $total_filesize += $path->getSize();
        $dir_filesize += $path->getSize();
        $total_files++;
        $dir_files++;
    }
}

echo "\nTotal Files: " . $total_files . "\nTotal File Size: " . $total_filesize . " bytes"; 
```

# c# - 如何将此不受支持的 LINQ 查询转换为其本机 Mongo 等效项？

> ID：14448666
> 
> 赞同：1
> 
> 时间：2013-01-21T22:53:01.543
> 
> 标签：c#, mongodb, linq, nosql

我有这个 MongoDB 无法执行的链式 LINQ 查询：

```
RoleCollection.AsQueryable().Where(r => r.Users.Any(id => id == user.Id))
    .Select(r => r.Name).ToArray(); 
```

这会导致以下错误：

```
Any is only support for items that serialize into documents. The current serializer is ObjectIdSerializer and must implement IBsonDocumentSerializer for participation in Any queries. 
```

如何将查询转换为 Mongo 支持的本机查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:59:09.150

您应该能够用和 长度检查`.Any()`的组合替换，如下所示：`.Where()`

```
RoleCollection.AsQueryable().Where(r => r.Users.Where(id => id == user.Id).Length > 0)
    .Select(r => r.Name).ToArray(); 
```

但是请注意，这里存在性能影响，因为它会拉回*所有*用户以`id`对其进行长度处理。

我不确定 Mongo 支持什么（对不起，我纯粹从[linq](/questions/tagged/linq "显示标记为“linq”的问题")的角度回答这个问题），但您也可以使用组合`FirstOrDefault`并在您的位置执行`null`检查。这可能会更好，因为您只期待一个或什么都没有：

```
RoleCollection.AsQueryable().Where(r => r.Users.FirstOrDefault(id => id == user.Id) != null)
    .Select(r => r.Name).ToArray(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:40:58.540

我得到了以下查询，尽管我还不完全确定它的语义：

```
RoleCollection.Find(new QueryDocument("Users", user.Id))
            .Select(r => r.Name).ToArray(); 
```

# c# - 从数组开始

> ID：14448667
> 
> 赞同：0
> 
> 时间：2013-01-21T22:53:02.603
> 
> 标签：c#, linq

我有这样的功能

```
public List<Entry> GetEntriesForSlider(int first, int max, List<string> NameLetters)
{
    //Some code
} 
```

在这段代码中，我想在数据库中搜索，以返回名字以 NameLetters 中的字母开头的每个结果。

所以如果我传入数组`NameLetters = ["a","b","c"]`

然后它将返回结果，例如

```
Amy 
Bert 
Aaron 
Chris 
```

应该注意的是，理想情况下，我希望使用某种 linq 语句，例如...

```
entries.Where(x => x.FirstName.StartsWith(partofArray)); 
```

如果可能的话。

编辑：我以前有以下内容：

```
var entries = _repository.All<Entry>().Skip(first).Take(max);
if (NameLetters != null && NameLetters.Count > 0)
    entries = entries.Where(x => NameLetters.Contains(x.FirstName[0].ToString())); 
```

但我发现，它在运行 where 语句之前枚举了查询（我认为）。可能是因为试图访问 firstname 的第一个字母（或 ToString）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:56:12.017

如果您只是想匹配第一个字母，请尝试：

```
entries.Where(x => partofArray.Contains(x.FirstName[0])); 
```

如果您需要担心 null 或空字符串，更安全的版本是：

```
entries.Where(x => 
                  !string.IsNullOrEmpty(x.FirstName) &&
                  partofArray.Contains(x.FirstName[0])
             ); 
```

如果要使用可变长度字符串，请尝试：

```
entries.Where(x => 
                   partofArray.Any( p=> x.FirstName.StartsWith(p))
             ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:07:04.903

也许你应该看看[predicate builder](http://www.albahari.com/nutshell/predicatebuilder.aspx)。

然后像

```
IQueryable<Entry> GetThingsThatBeginWithA(String[] prefixes)
{
    var predicate = PredicateBuilder.False<Entry>();
    foreach (String prefix in prefixes)
        predicate = predicate.Or(p => p.FirstName.StartsWith(prefix));
    return database.Entries.Where(predicate);
} 
```

此查询应正确编译为对 SQL 存储的单个查询。

更新：它也可以在没有谓词构建器的情况下完成，但我发现在没有它的情况下使用表达式树真的很乏味。

# java - 表单中的字段有自己的类是否很常见？

> ID：14448672
> 
> 赞同：0
> 
> 时间：2013-01-21T22:53:12.153
> 
> 标签：java, spring, spring-mvc

样本：

我有 2 个表，部门和员工（这 2 个表是通过员工中的 department_id 外键链接的）。显然，部门与雇员表是一对多的关系。

我需要创建一个包含两个表中数据子集的表单。

这些是 Web 表单中的字段。

1.  家庭/姓氏（来自员工表）
2.  名字（来自员工表）
3.  就业开始日期（来自雇员表）
4.  部门（以部门ID作为返回值的各个部门的下拉列表，显然来自部门表）。

我想知道为这 4 个字段创建一个新类是否是“最佳实践”？谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:04:57.310

如果您只返回一个，您可以简单地将它们添加到模型中。如果您要返回一堆这些东西的“行”，那么我会说将值包装在 Bean 中并传回该 bean 的实例集合更有意义。它使在视图侧更容易查看它们。

# ajax - 同时ajax请求django

> ID：14448673
> 
> 赞同：0
> 
> 时间：2013-01-21T22:53:17.250
> 
> 标签：ajax, django, jquery

我在页面加载时触发了多个 ajax 调用。

从`request1`我期待`response1`，从`request2`我期待`response2`。`response1`但我同时收到`request1`和`request2`。

当我收到`request2`后开始射击时，我按预期收到了。`response1``request2`

如何安全地进行多个 ajax 调用？

一些代码：

```
//avoids problem
    this.update = function(){
        $.post('/ws/newsfeed/', {'action':'6'}).done( function(response){
            ...
            _this.get_alert_count()
        })
    }

    this.get_alert_count = function(){
        $.post('/ws/newsfeed/', {'action':'2'}).done(function(count) {
            ...
        })
    }

_this.update()

//causes problem
    this.update = function(){
        $.post('/ws/newsfeed/', {'action':'6'}).done( function(response){
             ...
        })
    }

    this.get_alert_count = function(){
        $.post('/ws/newsfeed/', {'action':'2'}).done(function(count) {
            ...
        })
    }

_this.update()
_this.get_alert_count() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:05:46.913

您可能想研究 AjaxQ (http://code.google.com/p/jquery-ajaxq/)，它可以让您在给定时间内链接 ajax 调用而不会重叠。

希望能帮助到你

# ruby-on-rails - 为什么在仅发布字符串和上传图片之间会有不同的移动？

> ID：14448676
> 
> 赞同：0
> 
> 时间：2013-01-21T22:53:23.633
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有应用程序，其中有一个带有图像上传的评论输入字段。
我将它设计为与 ajax 一起使用。所以基本上它在发表评论后只重新加载部分。

我面临的问题是，当我尝试通过图片上传发表评论时，它会自动重新加载。

这是应该的吗？还是我的编码问题？

谁能告诉我为什么以及如何解决这个问题

**看法**

```
<%=form_for(([@user, @comment]), :remote => true, :class => 'form' ) do |f| %>

        <%= f.text_field :body %>  
        <button type="submit" class="btn">POST</button>
        <%= f.file_field :image %>

<% end %> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:02:09.433

**您不能通过 ajax 发送/上传图像！**

您需要通过 html 发送图像，删除`:remote => true`

```
<%=form_for(([@user, @comment]), :class => 'form' ) do |f| %>
 <%= f.text_field :body %>  
 <%= f.file_field :image %>
 <button type="submit" class="btn">POST</button>
<% end %> 
```

问候！

# maven - 在 Netbeans Maven 项目中导入 org.quartz 和 org.slf4j

> ID：14448679
> 
> 赞同：0
> 
> 时间：2013-01-21T22:53:32.137
> 
> 标签：maven, netbeans, import, quartz-scheduler, slf4j

我希望在 Netbeans 的 maven 项目中`org.slf4j`导入支持。`org.quartz`但是，我无法弄清楚确切的步骤。我不清楚我应该如何将这两个包（通过它们的 jar 文件）配置为工件。

我目前的 Netbeans 结构如下所示：

![在此处输入图像描述](../Images/c568743e9e4ddf0386def7050b85f08b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T22:59:54.893

右键单击依赖项节点，选择添加依赖项。在查询字段中，键入`org.quartz-scheduler`。在搜索结果中显示的列表中，折叠打开节点`org.quartz-scheduler : quartz`并单击您想要的版本（我现在选择 2.1.6）。

因为`org.slf4j`序列是可比的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:00:22.820

为什么不想将它们添加为 maven 依赖项`pom.xml`？

```
<dependency>
    <groupId>org.quartz-scheduler</groupId>
    <artifactId>quartz</artifactId>
    <version>2.1.6</version>
</dependency>
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-parent</artifactId>
    <version>1.7.2</version>
</dependency> 
```

Netbeans 与 Ant 和 Maven 具有出色的集成，并且会自行选择依赖项。

# servicestack - 服务堆栈和 NHibernate

> ID：14448683
> 
> 赞同：1
> 
> 时间：2013-01-21T22:54:07.027
> 
> 标签：servicestack

我正在关注这个例子：[使用 NHibernate 和 ServiceStack](http://www.philliphaydon.com/2012/06/using-nhibernate-with-servicestack)

在 Contacts 类库中，有没有办法不必创建另一个 Product 类，因为我们已经有了 Model 或者这是必需的？似乎可以在这里使用依赖注入。

我也可以将模型和映射移动到服务项目之外的他们自己的类库中吗？

我将如何返回具有另一个模型属性的模型？即假设我们有一个通过 Id 链接到人员模型的员工模型，并且人员模型包含员工出生日期，我不知道如何返回它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T21:55:09.737

您不必创建单独的模型（或 DTO），但是，我认为在处理不同的 ORM 时，自定义 DTO 将使生活更轻松。您可以使用 ServiceStack 的属性翻译器或 AutoMapper 之类的工具轻松翻译属性。

我会以您希望其他人使用它们的方式创建您的 DTO。换句话说，您的 DTO 不需要与基础表对齐。您可以组合模型并将数据展平为有用的 DTO。在您的示例中，Employee 类可以公开出生日期和任何其他人员属性。

您可以轻松地将 DTO 保存在单独的项目中。我已经在我想在其他地方重用 DTO 类而不包括服务的项目中做到了这一点。

# ios - 我可以让 UITextField 不可见吗？

> ID：14448688
> 
> 赞同：2
> 
> 时间：2013-01-21T22:54:26.187
> 
> 标签：ios, objective-c, uitextfield

我检查了[iPhone：如何使 UITextField 不可见但仍可点击？](https://stackoverflow.com/questions/7749028/iphone-how-can-i-make-a-uitextfield-invisible-but-still-clickable)，但是OP还有其他事情发生，答案似乎并没有帮助我解决问题。

我有一个 UITextField ，用户必须在其中输入文本。而不是标准的 UITextField 图形，我想使用一个为此目的而设计的可爱的图形。用户仍然需要能够输入文本并查看他/她正在输入的文本，但我需要使文本字段不可见，以便图形可以从其下方显示。

我怎样才能做到这一点？还是有另一种方法可以做我所追求的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:01:23.490

添加我的评论作为答案。你可以试试这个

```
[textField setBackgroundColor:[UIColor clearColor]]; 
```

然后将边框样式设置为`UITextBorderStyleNone`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T22:59:11.913

就像是：

```
yourTextField.borderStyle = UITextBorderStyleNone; 
```

应该这样做

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T23:10:51.350

另一种解决方案是隐藏`UITextView`自身并添加一个透明按钮，该按钮将调用键盘进行显示。

否则，其他答案应该有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-22T00:10:14.787

最简单的选择是在界面生成器中进行。选择第一个没有边框的 uitext 字段样式，就是这样。

# deployment - Azure 自动缩放在本地工作，但在部署时不工作

> ID：14448689
> 
> 赞同：2
> 
> 时间：2013-01-21T22:54:28.703
> 
> 标签：deployment, azure, enterprise-library, autoscaling

**问题**

我正在尝试部署一个工作角色，它将自动缩放一些目标站点。我能够在本地运行自动缩放器并且它可以工作（我在我的机器上安装了证书）。但是，一旦我将它作为云应用程序部署到 Azure，它就不会自动缩放。（但是，工作角色正在运行，因为我可以看到我的非自动缩放进程在同一个工作角色中工作。）

**我试过的**

我已按照[部署自动缩放应用程序块](http://msdn.microsoft.com/en-us/library/hh680937%28v=pandp.50%29.aspx)说明进行操作。

*   在目标订阅的管理证书中添加了“CN=Windows Azure Tools”证书。*   在自动缩放应用程序的证书中添加了“CN=Windows Azure 工具”证书。*   指定我的证书在工作角色中的位置![工人角色证书](../Images/58ca95d5796040ae6cdfe65b26f8da46.png)*   指定证书在我的服务存储中的位置以配置自动缩放

    ![服务存储配置](../Images/8dddcde45bd3a36b72a51d8ec4c2bef5.png)

    我错过了什么？

    谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T21:16:32.590

Tuzo 是对的 - 证书应该在 LocalMachine 中，但这还不够。请参阅[此 SO 帖子](https://stackoverflow.com/questions/13757127/azure-worker-role-runs-on-osfamily-2-server-2008r2-but-fails-on-osfamily-3)。基本上，在 OS Family 2 中，WaWorkerHost 运行在角色初始化过程生成的临时帐户（具有 GUID 名称）下，该帐户有权访问证书私钥；在 OS Family 3 中，WaWorkerHost 运行在“NETWORK SERVICE”账户下，该账户没有私钥访问权限。

目前最好的选择（MS Azure 团队在下一个 SDK 中解决问题）是以提升的权限运行角色 - 编辑 ServiceDefinition.csdef：

```
<?xml version="1.0" encoding="utf-8"?>
<ServiceDefinition name="blah" xmlns="http://schemas.microsoft.com/ServiceHosting/2008/10/ServiceDefinition" schemaVersion="2012-10.1.8">
  <WorkerRole name="blah" vmsize="Small">
    <Runtime executionContext="elevated" />
    ...      
   </WorkerRole>
</ServiceDefinition> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-22T02:14:42.923

为了在 Azure 中运行，我会尝试将 Store Location 设置为 LocalMachine。

如果您已执行部署自动缩放应用程序块中的所有步骤，则应在角色中部署带有私钥 (.pfx) 的证书。您可以 RDP 进入服务器以验证证书是否已安装（和位置）。

您还可以尝试根据[Autoscaling Application Block Logging](http://msdn.microsoft.com/en-us/library/hh680883%28v=pandp.50%29.aspx)启用日志记录，以查看是否有任何消息。

# ruby-on-rails - 为什么 rspec 不使用密码重置令牌更新数据库记录？

> ID：14448690
> 
> 赞同：0
> 
> 时间：2013-01-21T22:54:28.870
> 
> 标签：ruby-on-rails, testing, rspec

在运行 rails 测试时，我遇到了 RSpec 的一些问题。测试如下：

```
it "allows a user to request a password reset" do
  user = FactoryGirl.create(:user, :name => "John Smith", :email => "john@test.org")
  identity = Identity.create!(email: user.email, password: "please", password_confirmation: "please")
  visit "/"
  click_on "Forgotten password?"
  fill_in "email", :with => "john@test.org"
  click_on "Reset Password"
  ActionMailer::Base.deliveries.last.to.should include(user.email)
  ActionMailer::Base.deliveries.last.body.should include(identity.password_reset_token)
  visit '/password_resets/' + identity.password_reset_token.to_s + '/edit'

    ^ **** ERROR HERE : password_reset_token is nil! ****

  fill_in "identity_password", :with => "newpass123"
  fill_in "identity_password_confirmation", :with => "newpass123"
  click_on "Update Password"
  within page.all('div#loginModal')[0] do
    fill_in "auth_key", :with => "john@test.org"
    fill_in "password", :with => "newpass123"
    click_button "Log in"
  end
  page.should have_content("Hi John")
end 
```

你可以看到我已经概述了我要返回的错误，这很奇怪，因为当我检查发送的电子邮件时，它实际上会生成一个 password_reset_token。

有关信息，我用来执行此操作的代码是：

```
class PasswordResetsController < ApplicationController

  def create
    identity = Identity.find_by_email(params[:email])
    identity.send_password_reset if identity
    redirect_to root_url, :notice => "Email sent with password reset instructions."
  end

  def edit
    @identity = Identity.find_by_password_reset_token!(params[:id])
  end

  def update
    @identity = Identity.find_by_password_reset_token!(params[:id])
    if @identity.password_reset_sent_at < 2.hours.ago
      redirect_to new_password_reset_path, :alert => "Password reset has expired."
    elsif @identity.update_attributes(params[:identity])
      redirect_to root_url, :notice => "Password has been reset."
    else
      render :edit
    end
  end

end 
```

和...

```
class Identity < OmniAuth::Identity::Models::ActiveRecord
  attr_accessible :email, :password, :password_confirmation

  validates_uniqueness_of :email
  validates_format_of :email, :with => /^[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}$/i

  def send_password_reset
    generate_token(:password_reset_token)
    self.password_reset_sent_at = Time.zone.now
    self.save!
    UserMailer.password_reset(self).deliver
  end

  private

    def generate_token(column)
      begin
        self[column] = SecureRandom.urlsafe_base64
      end while Identity.exists?(column => self[column])
    end
end 
```

谁能建议为什么会发生这种情况？这与我的测试环境中某处未保存/访问或缓存的数据库记录有关吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T14:51:23.987

只是一个猜测：你不需要更新你的身份变量，比如通过电子邮件找到它，以便用新参数更新对象吗？在访问“password_resets”之前，请尝试使用

> Identity.find_by_email(user.email)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T05:23:34.537

您可能会遇到时间问题。完成该`click_on 'Reset Password'`步骤后，检查页面是否返回预期值，然后再继续执行该`visit 'passwords_reset...'`步骤。

# python - 如何使用循环查找列表中的最大数量？

> ID：14448692
> 
> 赞同：6
> 
> 时间：2013-01-21T22:54:48.457
> 
> 标签：python, list, loops, max

所以我有这个列表和变量：

```
nums = [14, 8, 9, 16, 3, 11, 5]

big = nums[0]

spot = 0 
```

我对如何实际做到这一点感到困惑。我想用这个练习给我一个开端。我如何在 Python 上做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-21T22:58:02.490

通常，您可以只使用

```
max(nums) 
```

如果您明确想要使用循环，请尝试：

```
max_value = None
for n in nums:
    if n > max_value: max_value = n 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-21T22:59:22.700

```
nums = [14, 8, 9, 16, 3, 11, 5]

big = None

spot = None

for i, v in enumerate(nums):
    if big is None or v > big:
         big = v
         spot = i 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-21T22:56:54.763

干得好...

```
nums = [14, 8, 9, 16, 3, 11, 5]

big = max(nums)
spot = nums.index(big) 
```

这将是实现这一目标的 Pythonic 方式。如果要使用循环，则以当前最大值循环并检查每个元素是否较大，如果是，则分配给当前最大值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T22:57:22.793

为什么不简单地使用内置的[max()](http://docs.python.org/2/library/functions.html#max)函数：

```
>>> m = max(nums) 
```

顺便说一句，类似问题的一些答案可能会有用：

*   [在列表中查找最大值及其索引的 Pythonic 方法？](https://stackoverflow.com/questions/6193498/pythonic-way-to-find-maximum-value-and-its-index-in-a-list)
*   [如何在列表中找到最大值的所有位置？](https://stackoverflow.com/questions/3989016/how-to-find-positions-of-the-list-maximum)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-21T23:23:50.407

要解决您的第二个问题，您可以使用`for`循环：

```
for i in range(len(list)):
    # do whatever 
```

您应该注意，它`range()`可以有 3 个参数：`start`、`end`和`step`。Start 是从哪个数字开始（如果未提供，则为 0）；开始是包容性的。结束是结束的地方（必须给出）；end 是唯一的：如果你这样做`range(100)`，它会给你 0-99。步长也是可选的，它表示使用什么间隔。如果未提供 step，则为 1。例如：

```
>>> x = range(10, 100, 5) # start at 10, end at 101, and use an interval of 5
>>> x
[10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95] # note that it does not hit 100 
```

由于`end`是独占的，要包括 100 个，我们可以这样做：

```
>>> x = range(10, 101, 5) # start at 10, end at 101, and use an interval of 5
>>> x
[10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90, 95, 100] # note that it does hit 100 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-12T09:36:22.467

Python 已经为这种需求内置了函数。

```
list = [3,8,2,9]
max_number = max(list)
print max_number # it will print 9 as big number 
```

但是，如果您找到经典 vay 的最大数量，您可以使用循环。

```
list = [3,8,2,9]

current_max_number = list[0]
for number in list:
    if number>current_max_number:
        current_max_number = number

print current_max_number #it will display 9 as big number 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-30T21:35:09.737

```
student_scores[1,2,3,4,5,6,7,8,9]

max=student_scores[0]
for n in range(0,len(student_scores)):
  if student_scores[n]>=max:
    max=student_scores[n]
print(max)
# using for loop to go through all items in the list and assign the biggest value to a variable, which was defined as max.

min=student_scores[0]
for n in range(0,len(student_scores)):
  if student_scores[n]<=min:
    min=student_scores[n]
print(min)
# using for loop to go through all items in the list and assign the smallest value to a variable, which was defined as min. 
```

***注意：上面的代码是用for循环来获取最大值和最小值，其他编程语言也可以通用。但是，max() 和 min() 函数是在 Python 中使用以获得相同结果的最简单方法。***

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-03-10T16:45:33.743

对于列表代码 HS 中的最大值，我已经设法让大部分自动分级机使用以下代码为我工作：

```
list = [-3,-8,-2,0]

current_max_number = list[0]
for number in list:
    if number>current_max_number:
        current_max_number = number

print current_max_number

def max_int_in_list():
    print "Here" 
```

我不确定 max_int_in_list 的去向。它需要恰好有 1 个参数。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-13T02:06:13.637

**打印列表中最大数字的索引。**

```
numbers = [1,2,3,4,5,6,9]

N = 0
for num in range(len(numbers)) :
  if numbers[num] > N :
    N = numbers[num]
print(numbers.index(N)) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-02-03T18:21:53.280

我也会将此添加为参考。您可以使用排序，然后打印最后一个数字。

```
nums = [14, 8, 9, 16, 3, 11, 5]

nums.sort()
print("Highest number is: ", nums[-1]) 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-05-20T09:54:12.103

```
scores = [12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27,
          28, 29, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 31, 31, 37,
          56, 75, 23, 565]

# initialize highest to zero
highest = 0

for mark in scores:
    if highest < mark:
        highest = mark

print(mark) 
```

# web-services - 尝试访问 GP Web 服务时出现 SOAP 异常

> ID：14448700
> 
> 赞同：2
> 
> 时间：2013-01-21T22:55:22.893
> 
> 标签：web-services, microsoft-dynamics, dynamics-gp

我正在尝试编写一个简单地连接到 GP WebService 并调用它的 GetCustomerList() 方法来从大平原获取客户的程序。我在下面概述的代码是我在文档中找到的代码的重复，但是，当我运行它时，我得到了一个 SoapException。我不确定我是否缺少凭据（例如用户名和密码），或者我是否正确地调用了它。我相信我在 Dynamics Security Console 中正确设置了安全设置，但我不是 100% 确定或者是否还有其他需要配置的内容。任何帮助将不胜感激。

```
public IList<string> GetCustomerNames()
{
    //Added a ServiceReference to the actual WebService which appears to be working
    var service = new DynamicsGPClient();
    var context = new Context();
    var customerKey = new CustomerKey();
    var companyKey = new CompanyKey();

    //Trying to load the test data
    companyKey.Id = (-1);

    context.OrganizationKey = (OrganizationKey)companyKey;

    //Trying to load the test data
    customerKey.Id = "AARONFIT0001";

    var customers = service.GetCustomerList(new CustomerCriteria(), context);

    return customers.Select(x => x.Name).ToList();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T13:02:35.600

听起来像是一个安全问题...您是否收到特定的错误消息...这可能会有所帮助...

还发现了这个...

在我看来，您的网络服务上需要一个 Windows 应用程序池标识。现在您将 IIS 安全设置为“匿名”，因此客户端在调用您的方法时不需要传递凭据。

您需要将其关闭并将您的应用程序池作为 Windows 帐户运行。完成该工作后，您可以选择是否只想将该一个 App Pool 身份添加到 Web 服务的安全性中，并将所有操作作为该帐户完成（安全性差），或者在您的包装器中，您可以使用 HTTP 用户的上下文标识，并将其设置为您实际使用的 GP WebService 调用的“WorkOnBehalfOf”属性。

您必须在 Web 服务安全控制台中授予应用程序池身份“WorkOnBehalfOf”权限，然后授予您要调用 Web 服务的任何用户。这使安全模型保持不变，并且您授权调用包装的 Web 服务的用户实际上确实有权调用原始 GP Web 服务方法。（这是 Business Portal 将请求转发到 Web 服务的方式。）

[https://groups.google.com/forum/?fromgroups=#!topic/microsoft.public.greatplains/W7gAo_zXit8](https://groups.google.com/forum/?fromgroups=#!topic/microsoft.public.greatplains/W7gAo_zXit8)

# linux - 嵌套最深的可写文件夹？

> ID：14448704
> 
> 赞同：1
> 
> 时间：2013-01-21T22:55:51.867
> 
> 标签：linux

大家好，我需要找到最深的嵌套可写文件夹：

我写了这个命令：`find . -type d -printf '%d:%p\n' | sort -n | tail -1`

但是如何添加条件“此文件夹可写”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:05:02.800

尝试这样做：

```
find . -type d -writable -printf '%d:%p\n' | sort -n | tail -1 
```

`man find`说过 ：

> - 可写
> 
> 匹配可写的文件。这考虑了 -perm 测试忽略的访问控制列表和其他权限伪影。该测试使用了 access(2) 系统调用，因此可能会被执行 UID 映射（或 root-squashing）的 NFS 服务器所欺骗，因为许多系统在客户端内核中实现 access(2)，因此无法使用服务器上保存的 UID 映射信息。

这也适用于目录。

# java - Spring不调用setter

> ID：14448706
> 
> 赞同：1
> 
> 时间：2013-01-21T22:56:00.693
> 
> 标签：java, spring, configuration, javabeans, setter

我有以下配置 web.xml：

```
 <!DOCTYPE web-app PUBLIC
 "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
 "http://java.sun.com/dtd/web-app_2_3.dtd" >

<web-app>

  <servlet>
    <servlet-name>minapp</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>

  <servlet-mapping>
    <servlet-name>minapp</servlet-name>
    <url-pattern>hello.htm</url-pattern>
  </servlet-mapping>

   <servlet>
    <servlet-name>register</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
  </servlet>

  <servlet-mapping>
    <servlet-name>register</servlet-name>
    <url-pattern>/register/*</url-pattern>
  </servlet-mapping>

  <welcome-file-list>
    <welcome-file>
      index.jsp
    </welcome-file>
  </welcome-file-list>
  <context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>/WEB-INF/applicationContext.xml</param-value>
</context-param>
</web-app> 
```

应用程序上下文.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="myDataSource"
        class="org.springframework.jdbc.datasource.DriverManagerDataSource">

        <property name="driverClassName" value="com.mysql.jdbc.Driver" />
        <property name="url" value="jdbc:mysql://localhost:3306/minapp" />
        <property name="username" value="root" />
        <property name="password" value="verysecret" />
    </bean>

    <bean id="myUserDAO" class="no.java.UserDAOImpl">
        <property name="DataSource" ref="myDataSource"/>
    </bean>

    <bean name="/register/register.htm" class="no.java.RegistrationController" >
        <property name="UserDAO" ref="myUserDAO" />
    </bean>

</beans> 
```

注册控制器的设置器

```
private UserDAO userDAO;

public void setUserDAO(UserDAO userDAO) {
    System.out.println("dao set");
    if (userDAO == null){

        System.out.println("dao null");
    }
    this.userDAO = userDAO;
} 
```

UserDAOImpl 的设置器：

```
private DataSource dataSource;

    public void setDataSource(DataSource source){
        System.out.println("data source setter called");
        this.dataSource=source;

    } 
```

并且没有调用 RegistrationController 设置器和 UserDAOImpl 设置器。我有一种感觉，我可能放错了配置，但由于 Spring 文档的复杂性，我无法理解我做错了什么。据我了解 contextConfigLocation 应该将 spring 指向 applicationContext.xml ，并且该文件应该做一些魔术以设置数据库连接，但事实并非如此。我将非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:05:25.703

您还需要将上下文加载器添加到您的 web.xml，以启动独立于 Dispatcher Servlet 的 ApplicationContext。

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        /WEB-INF/applicationContext.xml
    </param-value>
</context-param>
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:01:06.127

你初始化bean吗？您应该有类似应用程序上下文的东西，该上下文被调用并从 .xml 中获取信息并关闭所有 setter 方法。就像是：

```
ApplicationContext ac = new ClassPathXmlApplicationContext(new String[]{"applicationContext.xml"});
userDAO = (UserDAO) ac.getBean("myDataSource"); 
```

另外，我不确定您是否希望 UserDAO 作为您的属性名称，如果那也是您的类名称。

# python - Python：迭代两个列表并将一个列表1中的元素替换为列表2中的元素

> ID：14448710
> 
> 赞同：2
> 
> 时间：2013-01-21T22:56:10.073
> 
> 标签：python, list, loops

我有两个字符串列表。在包含大约 1000 个字符串元素的 list1 中，您有一个名为“Date”的字符串，它随机出现，紧随其后的是一个包含特定日期的字符串：“17/09/2011”。这种情况发生了大约 70 次。在 List2 中：我有大约 80 个日期，作为字符串。

问题：我想编写一个脚本，同时循环遍历两个列表，并按顺序将 list1 中的日期替换为 list2 中的日期。因此，显然您将用 list2 的前 70 个日期替换 list1 中出现的 70 个日期。之后我想将修改后的 list1 写入 .txt 文件。

我试过这个，但我完全被卡住了。我是 Python 的超级菜鸟。

```
def pairwise(lst):
    """ yield item i and item i+1 in lst. e.g.
        (lst[0], lst[1]), (lst[1], lst[2]), ..., (lst[-1], None)
    """
    if not lst: return
    #yield None, lst[0]
    for i in range(len(lst)-1):
        yield lst[i], lst[i+1]
    yield lst[-1], None

for line in file:
      list1.append(line.strip())
for i,j in pairwise(list1):
     for k in list2:
     if i == "Date":
         list1."replace"(j) # Dont know what to do. And i know this double for looping is wrong also. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:10:16.003

也许是这样的（如果没有没有以下日期的“日期”字符串）：

```
iter2 = iter (list2)
for idx in (idx for idx, s in enumerate (list1) if s == 'Date'):
    list1 [idx + 1] = next (iter2)

with open ('out.txt', 'w') as f:
    f.write ('{}'.format (list1) ) 
```

@user1998510，这里有一点解释：

`enumerate`将列表作为参数并生成形式为（i，列表的第 i 个元素）的元组。在我的生成器（即`(x for y in z if a)`部分）中，我将此元组的部分分配给局部变量 idx 和 s。生成器本身只产生索引，因为列表的实际项目（对 whit `s`）并不重要，因为在生成器本身中我们过滤了有趣的项目`if s == 'Date'`。在`for`循环中，我遍历此生成器，将其产生的值分配给`idx`（这`idx`与内部`idx`生成器不同，因为 python 中的生成器不再泄漏它们的局部变量）。生成器生成元素为“日期”的列表的所有索引，并且`for`迭代它。因此，我将第二个列表中的下一个日期分配给所有有趣索引的旧列表的 idx+1st 项。

# c++ - 读取具有任意数量空格的输入字符串的一部分

> ID：14448714
> 
> 赞同：1
> 
> 时间：2013-01-21T22:56:36.077
> 
> 标签：c++, string, input, stringstream, istringstream

我正在开发一个允许用户将“部门”添加到学校记录的程序。部门存储为如下结构：

```
struct Department{

  string ID;
  string name;
}; 
```

要将新部门添加到记录中，用户必须输入格式如下的命令：

```
D [5 digit department ID number] [Department name] 
```

该`[Department name]`字段是一个字符串，一直延伸到用户按下回车键。因此它可以有任意数量的空间（例如“人类学”或“计算机科学与工程”）。

当用户正确输入命令字符串（用 获得`getline`）时，它被传递给一个函数，该函数应该提取相关信息并存储记录：

```
void AddDepartment(string command){

  Department newDept;
  string discard;     //To ignore the letter "D" at the beginning of the command 

  istringstream iss;
  iss.str(command);

  iss >> discard >> newDept.ID >> ??? //What to do about newDept.name? 

  allDepartments.push_back(newDept);

} 
```

不幸的是，我不知道如何使这种方法起作用。我需要一种方法（如果有的话）来完成阅读 iss.str 而忽略空格。我设置了`noskipws`标志，但是当我测试它时，新记录中的名称字段为空：

```
... 
iss >> discard >> newDept.ID >> noskipws >> newDept.name; 
... 
```

我想我遗漏了一些关于终止条件/字符的东西。我还能如何创建我想要的功能......也许是带有`get`甚至是循环的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:59:13.230

我会跳过前导空格，然后阅读该行的其余部分

```
iss >> discard >> newDept.ID >> ws;
std::getline(iss, newDept.name); 
```

# javascript - “类”文件中的 jQuery 调试功能

> ID：14448719
> 
> 赞同：2
> 
> 时间：2013-01-21T22:57:01.493
> 
> 标签：javascript, jquery

我正在创建一个简单的游戏，我需要一些指导来调试一些数据。我的 HTML 文件中有一个 div，我希望他显示一些在用户操作更改某些变量时会更改的数据。

例如`var xPosition`，我想将数据发送到 HTML 中的 div，这样我就可以看到`xPosition`.

我真的不知道从哪里开始创建这个功能。

**我的问题：**

1.  是否可以在此类中创建事件并向他注册一些将显示所有更改数据的元素？
2.  我必须为这种事情使用一些计时器吗？

这是“类”：

```
(function ($) {
    $.Player = function (element) {
        this.element = (element instanceof $) ? element : $(element);
        this.movmentSpeed = 10;
        this.size = $(element).width();
        this.xPos = 0;
        this.yPos = 0;
    };

    $.Player.prototype = {
        //register events
        InitEvents: function () {
            var that = this;
            $(document).keydown(function (e) {
                var key = e.which;
                if (key == 39) {
                    that.moveRight(400);
                } else if (key == 37) {
                    that.moveLeft();
                }
            });

            this.element.css({
                left: this.xPos
            });
        },

        //movment functions
        moveRight: function (worldWidth) {
            if ((this.xPos + this.size) <= worldWidth) {
                this.xPos += this.movmentSpeed;
                this.element.css("left", '+=' + this.movmentSpeed);
            }
        },
        moveLeft: function () {
            if (this.xPos > 0) {
                this.xPos -= this.movmentSpeed;
                this.element.css("left", '-=' + this.movmentSpeed);
            }
        }
    };

} (jQuery)); 
```

这里的HTML：

```
<div id="player">
<div id="debugData"> <div>
<script>
var player = new $.Player($("#player"));
        player.InitEvents();

</script> 
```

（对不起我的英语不好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:07:57.320

**[jsFiddle 演示](http://jsfiddle.net/rQAKU/)**

我会说在 Class 中有一个内部函数会有所帮助。甚至可能有一个设置，您可以通过执行来打开日志记录`player.logging = true;`，并将其默认为 false；

`logging = false`在您的原型中，只需为我们的原型函数添加一个公共原型变量`log()`。

您可以使用的内部函数可能很简单：

```
 logging : false, // our default

    log : function (str) {
        if (this.logging) {
            $('#debugData').html(str);
        }
    }, 
```

通过这种方式，您可以**将**您的`log(this.xPos);`（或您想要记录的任何内容）留在您的代码中，并且通过`player.logging = true;`在您实例化您的类时删除它们，它们不会出现，直到您将该代码放回原处。

# django - 如何在加载到数据库之前修改转储数据生成的 django json 夹具

> ID：14448725
> 
> 赞同：0
> 
> 时间：2013-01-21T22:57:40.583
> 
> 标签：django, django-fixtures

我是一个相对的 django 新手。我有一个来自现有数据库的 django.contrib.auth.user 对象的 json 固定装置，我想将它加载到我的测试应用程序中。我要修改的特定字段是所有没有内置 UTC 偏移量的日期时间字段。我想使用 python 脚本添加这些 UTC 偏移量。

我正在使用 django 反序列化器，但没有运气，并且在反序列化过程中出现错误。

```
 File "add_utc_offset_to_fixture.py", line 24, in <module>
    for obj in serializers.deserialize("json", json_fixture):
  File "/Users/hari/.virtualenvs/bsc2/lib/python2.7/site-packages/django/core/serializers/json.py", line 47, in Deserializer
    raise DeserializationError(e)
django.core.serializers.base.DeserializationError: No module named Image 
```

如何解决此反序列化错误，或者如何在加载到数据库之前修改此固定装置。

我查看了我的固定装置以及 json.py 反序列化器，但不明白为什么它需要一个名为 Image 的模块。

我的代码

```
# This program reads in a json fixture with naive Datetime field and converts it into a UTC aware Datetime field
# For Documentation on this see https://docs.djangoproject.com/en/dev/topics/i18n/timezones/#time-zones-migration-guide
import sys,os

# Sets the django settings module
dir_two_steps_up_from_me = os.path.join(os.path.split(os.path.dirname(os.path.abspath(__file__)))[-2])
print "Adding %s to sys.path" % dir_two_steps_up_from_me
sys.path.append(dir_two_steps_up_from_me)

from bsc2 import settings
from django.core.management import setup_environ
# Deprecated but still using
setup_environ(settings)

from django.core import serializers

from django.contrib.auth.models import User
json_fixture = None
try:
    json_fixture = open(sys.argv[1],"rb")
except IndexError,IOError:
    print "Please give json fixture"
    exit()

for obj in serializers.deserialize("json", json_fixture):
    # Getting deserialization error when this executes
    print obj.first_name
    # TODO Code to change naive time in last_login to UTC time 
```

# c++ - 多次写入 QTcpSocket

> ID：14448731
> 
> 赞同：1
> 
> 时间：2013-01-21T22:58:30.907
> 
> 标签：c++, qt, network-programming

我有一个服务器和客户端程序，服务器可以方便地向每个客户端发送两条消息。服务器连续两次在每个客户端套接字上调用 write() 函数。在客户端，会出现readyread信号，但是当客户端读取时，它只得到第一条消息。我通过在服务器每次 write() 之前添加 waitForBytesWritten() 来解决这个问题，这似乎解决了这个问题。但是，我不知道为什么我不能只写两次缓冲区。我认为有更好的方法来解决这个问题。

# java - Java，数据封装，创建和销毁对象，StringTokenizer

> ID：14448734
> 
> 赞同：0
> 
> 时间：2013-01-21T22:58:47.743
> 
> 标签：java, file-io, text-files

我正在尝试读取 .txt 文件。每 5 行文本我想从其中的两个中获取信息，并将其存储在一个名为 Item 的类中，然后对接下来的五行执行相同的操作。

在每 5 行之后，将该 Item 对象保存在一个名为 Inventory 的临时对象中，该对象包含一个 Item 对象的链接列表。

然后，我将此 temp 传递给相应更新主列表的函数。

那么我该如何使用字符串标记器来做到这一点呢？我已经实现了一些东西，下面的代码是准系统/伪代码。在代码中有一个问题，这是我的主要问题。

InvObject 有一个 Item 对象的链表。

代码：

```
 InvObject temp = new InvObject();

        int i = 0;
        Item holdIt = null;

        while (in.hasNextLine())
        {
            i %= 5;

            if(i == 3 || i == 4)
            {
                String line = in.nextLine();
                StringTokenizer tkner = new StringTokenizer(line);

                if(i == 3)
                {
                    int z = 0;
                    Item it = new Item();
                  while (tkner.hasMoreTokens())
                    {
                        String token = tkner.nextToken("$");
                        if(z == 1) // 2nd token of 3rd line is price
                            {it.pric = token;}
                        z++;
                    }
                    holdIt = it; // save item in a globaler variable
                }

                if(i == 4)
                {
                    int j = 0;
                    while (tkner.hasMoreTokens())
                    {
                        String token = tkner.nextToken("\t");
                        if(j == 2)
                            {holdIt.itemNum = token;}
                        j++;
                    }
                    temp.addItem(holdit);
                                delete(holdit);       //// Will this delete holdit from temps linked list?
                                                      /// Or does the linked list in temp copy the data to 
                                                      ///itself regardless of what happens to holdit
                    System.out.println(holdit.print());
                } 
            }
            i++;

        }
        in.close();
        UpdateItems(temp); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:30:57.560

我不确定您在这里要问什么，但是，根据您对代码的评论，答案是否定的，删除 java 中的对象不会对列表产生影响。

我不确定这`delete(holdIt)`意味着什么，如果你想删除对象，你可以为它分配一个空值或调用默认构造函数`holdIt = new Type()`。在这两种情况下，垃圾收集器最终都会从内存中删除旧对象。

如果这不是您正在寻找的答案，请提供有关您想要实现的目标的更多信息。

# ios - 是否必须将通知数量计算为应用程序图标上的徽章值？

> ID：14448735
> 
> 赞同：2
> 
> 时间：2013-01-21T22:58:56.517
> 
> 标签：ios, push-notification, badge

我开发了一个向 iOS 设备发送推送通知的应用程序。在我的情况下，计算应用程序图标徽章上的通知数量并不重要（~没用），因为它们不是那种消息。

Apple 是否允许在收到推送通知时不增加或显示通知计数？还是苹果设计规则强制要求的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T00:13:43.017

您可以使用应用程序图标做任何您想做的事情。该图标不是收到通知的计数。相反，它通常是在应用程序中执行的一些可操作的事情（其中一个动作很可能是阅读通知消息）。

如果在启动您的应用程序时，用户会看到他们错过的通知列表，那么为应用程序添加标记可能是个好主意。但从你的描述看来，情况并非如此。

# ruby - 跨多个数组的一致排序

> ID：14448736
> 
> 赞同：0
> 
> 时间：2013-01-21T22:59:08.467
> 
> 标签：ruby

我在 Ruby 中有以下数据结构（键是字符串，值是数组的哈希）。

```
X = { "id": [2, 4, 1],  "name": ["a", "b", "c"], "time": [1, 0, 2]} 
```

我想对与字段“时间”关联的数组进行排序，但我希望所有其他数组以一致的方式排序。示例：排序后，X 应如下所示。

```
X = {"id": [4, 2, 1], "name": ["b", "a", "c"], "time": [0, 1, 2]} 
```

我以一种非常丑陋的方式解决了这个问题（因为我不知道该怎么做）。我所做的是创建一个时间副本，然后是 zip id 和 time，然后对其进行排序，然后是 zip name 和 time_copy 并对其进行排序。然后解压。我很确定这是一种糟糕的方法。其他人可以教我更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:27:52.940

如果三段数据应该属于一起，我认为您应该认真考虑将数据结构从数组哈希更改为哈希数组。否则，您可能会遇到各种麻烦（例如，如果您不小心使数组长度不等，会发生什么情况）——事实上，正如您所发现的，它使排序变得相当困难。

如果您坚持使用哈希作为输入格式，您可以按如下方式进行转换

```
hash = {id: [2, 4, 1],  name: ["a", "b", "c"], time: [1, 0, 2]}
array = hash.map{|k,v| [k].product(v)}.transpose.map{|h| Hash[h]}
# => [{id: 2, name: "a", time: 1}, ...] 
```

在哈希格式数组中，您可以非常轻松地对字段进行排序

```
array.sort_by{|h| h[:time]} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:49:38.700

使用@tokland 对[另一个问题](https://stackoverflow.com/questions/14446181/originals-indexes-of-sorted-elements-in-ruby)的回答并应用于`values_at`结果：

```
h = { id: [2, 4, 1],  name: ["a", "b", "c"], time: [1, 0, 2]}

time_indices = h[:time].each_with_index.sort_by(&:first).map(&:last)
h.values.each{|ar| ar.replace(ar.values_at(*time_indices))}
#=> {:id=>[4, 2, 1], :name=>["b", "a", "c"], :time=>[0, 1, 2]} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T00:22:02.077

和steenslag的差不多，但我觉得`map.with_index`应该用。

```
permutation = X["time"].map.with_index{|*xi| xi}.sort_by(&:first).map(&:last)
X.values.each{|a| a.replace(a.values_at(*permutation))} 
```

# mysql - 设置外键

> ID：14448738
> 
> 赞同：1
> 
> 时间：2013-01-21T22:59:11.033
> 
> 标签：mysql, foreign-keys

我试图设置一个外键，以便我可以将照片的作者与`users`table 的用户名相关联，但我无法创建表。

**更新**我解决了无法创建表的错误，但数据仍然没有进入表中。

```
CREATE TABLE IF NOT EXISTS `users` (
`username` varchar(30) NOT NULL ,
`password` varchar(40) default NULL,
`usersalt` varchar(8) NOT NULL,
`userid` varchar(32) default NULL,
`userlevel` tinyint(1) unsigned NOT NULL,
`email` varchar(50) default NULL,
`timestamp` int(11) unsigned NOT NULL,
`actkey` varchar(35) NOT NULL,
`ip` varchar(15) NOT NULL,
regdate` int(11) unsigned NOT NULL,
PRIMARY KEY  (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE IF NOT EXISTS photos (
ref int(10) unsigned NOT NULL auto_increment,
    photo varchar(75),
Firstname varchar(35),
    Lastname varchar(35),
    Age INT(3),
    author varchar(30) NOT NULL,
PRIMARY KEY (ref)

) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

这是我在创建表后尝试添加 FK 的内容。

```
ALTER TABLE photos
ADD CONSTRAINT FK_photos
FOREIGN KEY (author) REFERENCES users(username)
ON UPDATE CASCADE
ON DELETE CASCADE; 
```

这是将照片和一些信息连同它一起插入数据库的代码...

```
<?php
include("/include/session.php");
if(!$session->logged_in){ header("Location: ../main.php"); } else {
}
?>

<?php
$sub=0;

ini_set( "display_errors", 0);
if(isset($_REQUEST['submited'])) {
// your save code goes here

$allowedExts = array("jpg", "jpeg", "gif", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/png")
|| ($_FILES["file"]["type"] == "image/pjpeg"))
&& ($_FILES["file"]["size"] < 2097152)
&& in_array($extension, $allowedExts))
{
if ($_FILES["file"]["error"] > 0)
{
echo "Return Code: " . $_FILES["file"]["error"] . "<br>";
}
else
{
echo "";
if (file_exists("pictures/" . $_FILES["file"]["name"]))
{
echo "<font size='4' color='red'><b>We are sorry, the file you trying to upload already exists.</b></font>";
  }

else
{
move_uploaded_file($_FILES["file"]["tmp_name"],
"pictures/" . $_FILES["file"]["name"]);
$sub= 1;
$mysqli = new mysqli("localhost", "root", "", "secure_login");

// TODO - Check that connection was successful.

$photo= "pictures/" . $_FILES["file"]["name"];
$fname = $_POST["fname"];
$lname = $_POST["lname"];
$age   =$_POST["age"];
$stmt = $mysqli->prepare("INSERT INTO photos (photo, Firstname, Lastname, Age) VALUES (?, ?, ?, ?)");

// TODO check that $stmt creation succeeded

// "s" means the database expects a string
$stmt->bind_param("ssss", $photo, $fname, $lname, $age);

$stmt->execute();

$stmt->close();

$mysqli->close();

echo "<font size='7' color='white'><b> Success! Your item has been listed.</b></font>";
echo '<meta http-equiv="refresh" content="2;url=home.php">';
}

}
}
else
{
echo "<font size='4' color='red'><b>We are sorry, the file you trying to upload is not an image or it exceeds 2MB in size.</b></font><br><font color='blue'><i>Only images under size of 2MB are allowed</i></font>.";
}
}

?>

<form action="" method="post" enctype="multipart/form-data">
<input type="hidden" name="submited" value="true" />

<?php
ini_set( "display_errors", 0);
if($sub==0)
{
?> 
<label  for="file"><font  size="5"><b>Choose Photo:</b></font></label>
<input id="shiny" type="file" name="file" onchange="file_selected = true;" required><br>
Last Name:<input  type="text" name="fname" value="<?php echo (isset($_POST['fname']) ? htmlspecialchars($_POST['fname']) : ''); ?>"required><br> 
Last Name:<input  type="text" name="lname" required><br> 
Age:<input type="text" name="age" required><br>
<input id="shiny" type="submit" value="Submit" name="submit">
<?php
}
?>

</form>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:06:33.610

帮自己一个大忙，在所有表上使用整数作为 ID 字段，并将其用作主键字段。然后让你所有的外键约束引用它。在此处查看 MySQL 文档中的第一个示例：http: [//dev.mysql.com/doc/refman/5.5/en/example-foreign-keys.html](http://dev.mysql.com/doc/refman/5.5/en/example-foreign-keys.html)

另外，发布您的错误消息，我会更新我的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:09:00.423

> 如果不存在则创建表`users`（ `username`varchar(30) NOT NULL， `password`varchar(40) 默认 NULL， `usersalt`varchar(8) NOT NULL， `userid`varchar(32) 默认 NULL， `userlevel`tinyint(1) unsigned NOT NULL， `email`varchar(50) 默认 NULL， `timestamp`int (11) unsigned NOT NULL, `actkey`varchar(35) NOT NULL, `ip`varchar(15) NOT NULL, `regdate`int(11) unsigned NOT NULL, PRIMARY KEY ( `username`) ENGINE=InnoDB DEFAULT CHARSET=latin1;
> 
> 如果不存在照片，则创建表 ( ref int(10) unsigned NOT NULL auto_increment, photo varchar(75), Firstname varchar(35), Lastname varchar(35), Age INT(3), author varchar(30) NOT NULL, PRIMARY KEY (ref) ) ENGINE=InnoDB 默认字符集=latin1;

一些变化，但对我有用。但是尝试在 id 列上设置外键，而不是 varchar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T23:14:28.487

看起来您的表定义后面需要一个逗号`photo varchar(75)`

```
CREATE TABLE IF NOT EXISTS photos (
    ref int(10) unsigned NOT NULL auto_increment,
    photo varchar(75),
    Firstname varchar(35),
    Lastname varchar(35),
    Age INT(3),
    author varchar(30) NOT NULL,
PRIMARY KEY (ref)

) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

# android - webview 和 android 日食

> ID：14448741
> 
> 赞同：-4
> 
> 时间：2013-01-21T22:59:15.037
> 
> 标签：android, webview

我有一个 HTML5 网页，我想为 Android DSK 使用 webview。

这是我的 androidmanifest.xml

```
 <?xml version="1.0" encoding="utf-8"?>
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
 package="com.example.myfirstapp"
 android:versionCode="1"
 android:versionName="1.0" >

 <uses-permission android:name="android.permission.INTERNET" />

 <uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

 <application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.example.myfirstapp.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
 </application>

 </manifest> 
```

这是我在布局文件夹上的 activitymain.xml：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
 xmlns:tools="http://schemas.android.com/tools"
 android:layout_width="match_parent"
 android:layout_height="match_parent"
 tools:context=".MainActivity" >

 <TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@string/hello_world" />

<WebView  xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/webview"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
/>

</RelativeLayout> 
```

我还应该做什么？以及将该代码放在哪里？

谷歌安卓文档是这样说的：

要在 WebView 中加载网页，请使用 loadUrl()。例如：

```
WebView myWebView = (WebView) findViewById(R.id.webview);
myWebView.loadUrl("http://www.example.com"); 
```

但是我应该把这些代码行放在哪里呢？在新文件中？我尝试了很多事情都没有成功。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T23:06:29.057

`MainActivity.java`从您的文件中调用它：

```
package com.example.myfirstapp;

import android.app.Activity;
import android.os.Bundle;
import android.webkit.WebView;

    public class MainActivity extends Activity {

        private WebView webView;

        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activitymain);

            webView = (WebView) findViewById(R.id.webview);
            webView.getSettings().setJavaScriptEnabled(true);
            webView.loadUrl("http://www.google.com");

        }

    } 
```

这是一个很好的参考示例：

[Android WebView 示例](http://www.mkyong.com/android/android-webview-example/)

# c++ - 我应该在这种特定情况下使用头文件吗？

> ID：14448748
> 
> 赞同：2
> 
> 时间：2013-01-21T23:00:00.027
> 
> 标签：c++, compilation, header-files

我的应用程序由几个组件组成，继承自一个抽象基类。除了每个组件覆盖的两个成员函数之外，没有任何组件有任何公共声明。

```
class Component()
{
public:
    virtual void Init() = 0;
    virtual void Update() = 0;
}; 
```

由于没有其他公共方法或成员，创建头文件有意义吗？这可以节省编译时间还是有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:05:09.103

如果你有很多派生类`Component`，你可以把它放在一个单独的头文件中：`IComponent.h`. `I`表示接口，它是 C++ 中的抽象类。这使得代码结构非常清晰。

您的代码具有 UB，因为您尚未`virtual destructor`为抽象类定义：

```
class Component()
{
public:
    virtual ~Component();      
    virtual void Update() = 0;
}; 
```

如果通过指向基的指针删除派生类型的对象，则会得到未定义的行为。

同样正如@Griwes 指出的那样，只需使用构造函数来初始化成员，不需要有多余的`virtual Init`功能。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T23:07:42.157

如果您不在单个 CPP 文件之外使用该类，则不需要标头。否则，您可以避免编写头文件，风险自负：潜在的损失（基类的不一致重新声明）远远超过潜在的胜利（加快编译时间）。整个项目的可读性也会受到影响 - 您项目的其他读者会期望在那里看到一个标题，并且会惊讶地看到不同文件中的多个副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T23:03:11.897

不，不需要编写头文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T23:03:26.920

这完全取决于您如何使用课程。如果您仅在一个源文件中使用派生类，则没有特别的理由使用头文件。

我不会担心编译时间，除非您运行在 10 年以上的机器上。现代机器很好地缓存磁盘读取，您很可能会包含几兆字节的其他头文件。

但是，如果您想在其他项目中“重用”您的课程，那么您现在已经很难做到了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-21T23:04:10.163

创建标头通常是一个好主意，即使对于性能提升不会很显着的小程序也是如此。这是您应该养成的良好编码习惯！:)

[http://www.cplusplus.com/forum/articles/10627/](http://www.cplusplus.com/forum/articles/10627/)

# c - 扩展动态链接共享库？

> ID：14448756
> 
> 赞同：5
> 
> 时间：2013-01-21T23:01:07.813
> 
> 标签：c, shared-libraries, extending

我是 C 的新手，很抱歉我缺乏知识（我的 C 书真的很庞大 :)

我想用封闭源代码扩展一个共享库（libcustomer.so），但公共已知的 api。

这样的事情可能吗？

1.  将 libcustomer.so 重命名为 liboldcustomer.so
2.  创建一个扩展共享库 libcustomer.so（因此其他人隐式使用扩展的）
3.  通过 -loldcustomer 将 liboldcustomer.so 链接到我的扩展 libcustomer.so
4.  将任何未额外实现的方法直接转发到旧的“liboldcustomer.so”

我不认为它会那样工作（名称被编译成.so，不是吗？）。但是有什么选择呢？

对于＃4：有没有一种通用的方法可以做到这一点，或者我是否必须编写一个像旧方法一样命名的方法并转发调用（如何？）？

因为原始的 libcustomer.so (=liboldcustomer.so) 可能会不时更改，所以所有这些东西都应该动态工作。

出于安全原因，我们的系统没有 LD_PRELOAD（否则我会采用 :( ）。

考虑扩展验证检查和一些更好的 NPE 处理。

在此先感谢您的帮助！

编辑：

我只是在实现我的扩展，如答案所示，但目前我有一个未处理的案例：

如何“代理”扩展库中的结构？

例如我有这个：

客户.h：

```
struct customer; 
```

客户.c：

```
struct customer {
    int children:1;
    int age;
    struct house *house_config;
}; 
```

现在，在我的customer-extension.c 中，我正在编写customer.c 中的所有公共方法，但是我如何“通过”这些结构呢？

非常感谢您的时间和帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T23:12:36.850

所以你有 OldLib

```
void func1();
int  func2();
... etc 
```

第 4 步可能看起来像使用一些静态初始化创建另一个库。

使用内容创建 NewLib：

```
void your_func1();

void (*old_func1_ptr)() = NULL;
int  (*old_func2_ptr)() = NULL;

void func1()
{
    // in case you don't have static initializers, implement lazy loading
    if(!old_func1_ptr)
    {
       void* lib = dlopen("OldLibFileName.so", RTLD_NOW);
       old_func1_ptr = dlsym(lib, "func1");
    }

    old_func1_ptr();
}

int func2()
{
    return old_func2_ptr();
}

// gcc extension, static initializer - will be called on .so's load
// If this is not supported, then you should call this function
// manually after loading the NewLib.so in your program.
// If the user of OldLib.so is not _your_ program,
// then implement lazy-loading in func1, func2 etc. - check function pointers for being NULL
// and do the dlopen/dlsym calls there.
__attribute__((constructor))
void static_global_init()
{
   // use dlfcn.h
   void* lib = dlopen("OldLibFileName.so", RTLD_NOW);

   old_func1_ptr = dlsym(lib, "func1");
   ...
} 
```

如果您对旧 API 有一些描述，则可以自动生成 '`static_global_init`和所有'。`func_ptr`NewLib 创建完成后，当然可以替换 OldLib。

# matlab - 在matlab中排序并分配排名

> ID：14448759
> 
> 赞同：4
> 
> 时间：2013-01-21T23:01:28.510
> 
> 标签：matlab, sorting, ranking

嗨，我需要对向量进行排序并为相应的排序顺序分配排名。我正在使用排序功能`[sortedValue_X , X_Ranked] = sort(X,'descend');` ，但问题是它为相同的值（零）分配不同的等级。即`x = [ 13 15 5 5 0 0 0 1 0 3]`，我希望零获得相同的最后排名，即 6，而五需要共享第三排名等。有什么建议吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-22T00:51:34.240

语法`[sortedValues, sortedIndexes] = sort(x, 'descend')`不会像您描述的那样返回排名。它返回排序值的索引。如果您想使用一个数组的排序顺序来重新排列另一个数组，这非常有用。

正如@user1860611 所建议的那样，`unique`似乎可以做你想做的事，使用如下第三个输出：

```
x = [ 13 15 5 5 0 0 0 1 0 3];
[~, ~, forwardRank] = unique(x);
%Returns
%forwardRank =
%     5     6     4     4     1     1     1     2     1     3 
```

要获得您想要的顺序（降序），您需要颠倒顺序，如下所示：

```
reverseRank = max(forwardRank) - forwardRank  + 1
%Returns
%reverseRank =
%    2     1     3     3     6     6     6     5     6     4 
```

你可能在这一点上完成了。但是您可能希望将它们按升序排列。这是向量的重新排序，`reverseRank`使其与原始向量保持同步`x`，这正是第二个参数`sort`旨在帮助解决的问题。所以我们可以这样做：

```
[xSorted, ixsSort] = sort(x, 'descend');    %Perform a sort on x
reverseRankSorted = reverseRank(ixsSort);   %Apply that sort to reverseRank 
```

生成：

```
xSorted =           15    13     5     5     3     1     0     0     0     0
reverseRankSorted =  1     2     3     3     4     5     6     6     6     6 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-01-30T09:40:02.483

tierank.m 可能是您正在寻找的东西。

```
>> x = round(rand(1,5)*10)
x =
8     7     3    10     0
>> tiedrank(x)
ans =
4     3     2     5     1 
```

# android - phonegap 上不显示软键盘

> ID：14448760
> 
> 赞同：0
> 
> 时间：2013-01-21T23:01:33.753
> 
> 标签：android, cordova, android-softkeyboard

我正在使用以下代码在加载后在 webview 上显示软键盘。但它不起作用。任何帮助将不胜感激。

```
 public void onCreate(Bundle savedInstanceState) 
        {

            super.onCreate(savedInstanceState);
            super.loadUrl("file:///android_asset/www/index.html");

            InputMethodManager mgr = (InputMethodManager) this.getSystemService(Context.INPUT_METHOD_SERVICE);

            mgr.showSoftInput(this.appView, InputMethodManager.SHOW_IMPLICIT);

            ((InputMethodManager) this.getSystemService(Context.INPUT_METHOD_SERVICE)).showSoftInput(this.appView, 0);

            //NOTE: this code should be called after loadurl : disable the default 'save image as' and 'text selection' android dialog boxes on long clicks
            this.appView.setOnLongClickListener(new OnLongClickListener() {
                @Override
                public boolean onLongClick(View v) {
                    return true;
                }
            });
            this.appView.setLongClickable(false);

       } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T09:21:17.720

在此链接中，您将找到可能会帮助您解决问题的有用信息：

[http://turbomanage.wordpress.com/2012/05/02/show-soft-keyboard-automatically-when-edittext-receives-focus/](http://turbomanage.wordpress.com/2012/05/02/show-soft-keyboard-automatically-when-edittext-receives-focus/)

尽管作者不推荐它，但在 Manifest 中使用属性 android:windowSoftInputMode 最终可能会对您有所帮助。

# arrays - 有没有一种方便的方法可以将查找表应用于 numpy 中的大型数组？

> ID：14448763
> 
> 赞同：43
> 
> 时间：2013-01-21T23:01:40.350
> 
> 标签：arrays, numpy, python-2.x, lookup-tables

我已经将图像读入 numpy，结果数组中有很多像素。

我计算了一个包含 256 个值的查找表。现在我想做以下事情：

```
for i in image.rows:
    for j in image.cols:
        mapped_image[i,j] = lut[image[i,j]] 
```

是的，这基本上就是 lut 所做的。
唯一的问题是：我想做到高效，在 python 中调用该循环会让我等待几秒钟以完成它。

我知道`numpy.vectorize()`，它只是一个调用相同 python 代码的便捷函数。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-01-21T23:16:47.887

您可以只使用`image`索引`lut`if `lut`is **1D**。
这是 NumPy 中索引的入门：
[http ://www.scipy.org/Tentative_NumPy_Tutorial#head-864862d3f2bb4c32f04260fac61eb4ef34788c4c](http://www.scipy.org/Tentative_NumPy_Tutorial#head-864862d3f2bb4c32f04260fac61eb4ef34788c4c)

```
In [54]: lut = np.arange(10) * 10

In [55]: img = np.random.randint(0,9,size=(3,3))

In [56]: lut
Out[56]: array([ 0, 10, 20, 30, 40, 50, 60, 70, 80, 90])

In [57]: img
Out[57]: 
array([[2, 2, 4],
       [1, 3, 0],
       [4, 3, 1]])

In [58]: lut[img]
Out[58]: 
array([[20, 20, 40],
       [10, 30,  0],
       [40, 30, 10]]) 
```

还要注意索引开始于`0`

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-01-22T03:28:55.950

TheodrosZelleke 的回答是正确的，但我只是想为它添加一些无证智慧。Numpy 提供了一个函数，`np.take`根据文档，它*“与花式索引做同样的事情”。*

好吧，几乎，但不完全相同：

```
>>> import numpy as np
>>> lut = np.arange(256)
>>> image = np.random.randint(256, size=(5000, 5000))
>>> np.all(lut[image] == np.take(lut, image))
True
>>> import timeit
>>> timeit.timeit('lut[image]',
...               'from __main__ import lut, image', number=10)
4.369504285407089
>>> timeit.timeit('np.take(lut, image)',
...               'from __main__ import np, lut, image', number=10)
1.3678052776554637 
```

`np.take`大约快 3 倍！根据我的经验，当使用 3D luts 将图像从 RGB 转换为其他色彩空间时，添加将 3D 查找转换为 1D 扁平化查找的逻辑可以加快 x10 倍的速度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-08-10T16:28:30.557

如果您仅限于使用 numpy，[那么 TheodrosZelleke 的答案](https://stackoverflow.com/a/14448935/12808884)就是要走的路。但是如果你允许其他模块，`cv2`它是一个与图像数据交互的有用模块，它接受 numpy 数组作为输入。一个很大的限制是图像数组必须有`dtype='uint8'`，但只要没问题，该函数`cv2.LUT`就会完全按照我们的意愿执行，并且它提供了显着的加速：

```
>>> import numpy as np
>>> import cv2
>>> lut = np.arange(256, dtype='uint8')
>>> image = np.random.randint(256, size=(5000, 5000), dtype='uint8')
>>> np.all(lut[image] == cv2.LUT(image, lut))
True
>>> import timeit
>>> timeit.timeit('lut[image]', 'from __main__ import lut, image', number=10)
0.5747578000000431
>>> timeit.timeit('cv2.LUT(image, lut)', 
...               'from __main__ import cv2, lut, image', number=10)
0.07559149999997317 
```

您的查找表可以是其他一些数据类型，但是您失去了很多速度改进（尽管 numpy 索引也会影响性能）。例如，使用`dtype='float64'`：

```
>>> lut = np.arange(256, dtype='float64')
>>> timeit.timeit('lut[image]', 'from __main__ import lut, image', number=10)
1.068468699999812
>>> timeit.timeit('cv2.LUT(image, lut)', 
...               'from __main__ import cv2, lut, image', number=10)
0.41085720000000947 
```

# django - Django REST Framework 和泛型关系

> ID：14448764
> 
> 赞同：12
> 
> 时间：2013-01-21T23:01:46.337
> 
> 标签：django, django-rest-framework

**问题**

我有一个具有以下标准通用外键字段的模型：

```
content_type = models.ForeignKey(ContentType)
object_id = models.PositiveIntegerField()
event_object = generic.GenericForeignKey('content_type', 'object_id') 
```

根据 REST framework 的文档，我可以执行以下操作来正确序列化：

```
class WhateverSerializer(serializers.ModelSerializer):
    event_object = serializers.RelatedField(source='event_object') 
```

这很好用，但是在其他两种相关情况下，我无法正常工作：

1.  我想用`HyperlinkedRelatedField`. 此字段需要 view_name 参数，我无法声明，因为视图名称因相关模型而异。我通过使用`SerializerMethodField`，在运行时实例化 a`HyperlinkedIdentityField`并返回它的`field_to_native`方法来解决这个问题（见下面的片段）。这感觉不是很优雅。
2.  我想通过说将相关对象直接嵌套在序列化中`event_object = SoAndSoSerializer(source='event_object')`。我能看到的唯一解决方案是遍历`*Serializer`我定义的每一个并检查哪个具有正确的模型，然后使用它。同样，这感觉不是很优雅。

**问题**

HyperlinkRelatedField 是否意味着跨通用关系工作？我只是在犯错吗？是否有明显的解决方案来选择`*Serializer`我缺少的权利？

**代码片段**

上面第 1 点中提到的不优雅的解决方案：

```
class WhateverSerializer(DefaultSerializer):

    event_object_url = serializers.SerializerMethodField('get_related_object_url')
    # ...

    def get_related_object_url(self, obj):
        obj = obj.event_object
        default_view_name = '%(model_name)s-detail'
        format_kwargs = {
            'app_label': obj._meta.app_label,
            'model_name': obj._meta.object_name.lower()
        }
        view_name = default_view_name % format_kwargs
        s = serializers.HyperlinkedIdentityField(source=obj, view_name=view_name)
        s.initialize(self, None)
        return s.field_to_native(obj, None) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-22T08:48:48.463

你说得对，REST 框架不支持这些用例，而且对我来说，如果支持的话，设计会是什么样子并不明显。您可能需要一个隐式注册表模型-> 视图（对于超链接的情况）和模型-> 序列化程序（对于嵌套的情况），我认为我不会非常热衷于此。

做你需要的最简单的方法可能是子类化`ManyRelatedField`并创建一个自定义字段类型，重写`to_native(self, obj)`以完全按照你想要的方式序列化集合中的每个对象。

# windows-phone-8 - ReadingChanged 从未在 WP8 上调用加速计

> ID：14448767
> 
> 赞同：0
> 
> 时间：2013-01-21T23:02:01.243
> 
> 标签：windows-phone-8, c++-cx

我正在尝试在 Windows Phone 8 上的 Windows::Devices::Sensors 命名空间中使用 C++ Accelerometer 接口。代码与我拥有的 C# 项目非常相似，但我无法获得 C++ 事件我可以用我的 C# 代码开火。

我的 C++ 代码是一个带有 C++ 组件的 C# 项目，C++ 组件只是打开 Accelerometer 设备进行读取，然后尝试设置一个事件以在数据准备好时触发：

```
AccelerometerWrapper::AccelerometerWrapper() {
    Accelerometer^ acc = Accelerometer::GetDefault();
    accReading = acc->ReadingChanged::add( ref new TypedEventHandler<Accelerometer^, AccelerometerReadingChangedEventArgs^>(this, &AccelerometerWrapper::ReadingChanged));
}

void AccelerometerWrapper::ReadingChanged(Accelerometer^ sender, AccelerometerReadingChangedEventArgs^ e) {
    ...
} 
```

不幸的是，我的`ReadingChanged()`函数从未被调用过。我四处寻找一种`Start()`方法或类似的方法，但我找不到任何东西。我的大部分知识都来自[AccelerometerCPP 示例](http://code.msdn.microsoft.com/windowsapps/Accelerometer-Sensor-Sample-22982671)，但我无法实际测试它，因为它是一个通用的 WinRT（例如 Windows 8，而不是 Windows Phone 8）示例，而且我的计算机没有加速度计。一切都编译并运行，事件永远不会被触发。

编辑：我已经成功运行了一个测试来验证我可以手动调用`acc->GetCurrentReading()`，所以加速度计正在工作，它似乎是没有被触发的事件。

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:00:14.643

我不是 C++ 专家，但新的加速度计传感器使用 C# 在我的机器上工作。

```
private void MainPage_Loaded(object sender, RoutedEventArgs e)
{
    var accelerometer = Accelerometer.GetDefault();
    if (accelerometer != null)
    {
        accelerometer.ReadingChanged += accelerometer_ReadingChanged;
    }
}

void accelerometer_ReadingChanged(Accelerometer sender, AccelerometerReadingChangedEventArgs args)
{
    Debug.WriteLine(args.Reading.AccelerationX + ", " + args.Reading.AccelerationY + "," + args.Reading.AccelerationZ);
} 
```

当我们运行该代码片段时，我们可以看到以下预期输出：
![输出](../Images/02e3c290404e9d06944b857857295cee.png)

只是对 C++ 的猜测，您是否需要将 Accelerometer 实例缓存在某处而不是让它超出范围？

# api - 电影海报搜索 API

> ID：14448771
> 
> 赞同：5
> 
> 时间：2013-01-21T23:02:14.157
> 
> 标签：api, search, movies

想象一下，我有一个电影标题列表，这些年不断更新（每 24 小时或更短时间），我想为列表中的每部电影获取电影海报。

我尝试使用这个： http: [//mikefigueroa.com/blog/2011/08/get-first-google-image-search-result-with-php/](http://mikefigueroa.com/blog/2011/08/get-first-google-image-search-result-with-php/)

但名单很大，而且我的 IP 被掩盖为滥用。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T23:11:41.303

您可以使用 TheMovieDatabase 的电影图像 API： [http ://api.themoviedb.org/2.1/methods/Movie.getImages](http://api.themoviedb.org/2.1/methods/Movie.getImages)

~~**更新：** 他们的新 API 在支持方面可能更好。 [http://docs.themoviedb.apiary.io/#get-%2F3%2Fmovie%2F%7Bid%7D%2Fimages](http://docs.themoviedb.apiary.io/#get-%2F3%2Fmovie%2F%7Bid%7D%2Fimages)~~

**更新：** 有一个新的 api 可用：[https ://developers.themoviedb.org/3/getting-started/introduction](https://developers.themoviedb.org/3/getting-started/introduction)

# c++ - 代码行正在杀死我的程序

> ID：14448772
> 
> 赞同：0
> 
> 时间：2013-01-21T23:02:19.933
> 
> 标签：c++, oop, list

我在 C++ 中创建了这个链表类，它工作正常，除非我运行它后程序没有响应。我找到了导致问题的线路，但我不知道为什么。即使我以不同的方式键入它，它仍然会做同样的事情。

这是我的列表类：

```
#include <string>

 template<class T>
 class List : public Object{
private: 
    Node<T>* first;
    Node<T>* last;
    int length;
public:
    List() : Object(new std::string("List")) {
        first = NULL;
        last = NULL;
        length = 0;
    }
    ~List() {
        delete first;
        delete last;
    }

    void Add(T value) {
        if(first==NULL)
            first = new Node<T>(NULL, value);
        else if(last==NULL)
            ---->last = new Node<T>(first, value);<-----
        else
            last = new Node<T>(last, value);
        length++;
    }

    T Remove(T value) {
        Node<T>* temp = first;
        while(temp!=NULL) {
            if(temp->GetValue()==value) {
                temp->GetPrev()->SetNext(temp->GetNext());
                temp->GetNext()->SetPrev(temp->GetPrev());
                delete temp;
                length--;
                return value;
            }
            temp = temp->GetNext();
        }
        return 0;
    }

    T Get(int index) {
        Node<T>* temp = first;
        int i = 0;
        while(temp!=NULL) {
            if(i==index)
                return temp->GetValue();
            i++;
            temp = temp->GetNext();
        }
        return 0;
    }
 }; 
```

当我删除程序上方的标记线时，没有响应。这是我的节点构造函数：

```
#include <string>

template<class T>
class Node : public Object{
private:
    Node* next;
    Node* prev;
    T value;
public:
    Node(Node* prev, T value) : Object(new std::string("Node")){
        if(prev!=NULL) {
            prev->next = this;
            this->prev = next;
        } 
        next = NULL;
        this->value = value;
    }
    ~Node() {
        delete next;
    }

    T GetValue() {
        return value;
    }

    Node* GetNext() {
        return next;
    }

    Node* GetPrev() {
        return next;
    }
}; 
```

我的对象类：

```
#include <string>

class Object {
private:
    std::string* type;
public:
    Object() {
        type = new std::string("Object");
    }
    Object(std::string* type) {
        this->type = type;
    }
    ~Object() {
        delete type;
    }

    std::string* GetType() {
        return type;
    }
}; 
```

我的Test.cpp

```
#include <iostream>
#include <string>

#include "Object.h"
#include "Node.h"
#include "List.h"

using namespace std;

int main () {

List<int> l;
l.Add(5);
l.Add(93);
l.Add(17);
l.Add(7789);
l.Add(60);

cout << "node 4 is:" << l.Get(3) << endl;

return 0;
} 
```

错误图片[http://i50.tinypic.com/2mw5phi.png](http://i50.tinypic.com/2mw5phi.png) 感谢您的阅读，请尽快提供帮助，如果您需要我提供更多信息，请发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:22:33.250

**编辑：**您的程序存在许多问题，但可能导致您崩溃的原因是：您的`Add`-function 无法正常工作。它应该是这样的：

```
if(first==NULL) {
    first = new Node<T>(NULL, value);
    last = first;
} else {
    last = new Node<T>(last, value);
}
length++; 
```

否则，它将无法正确插入第二个元素。为什么？使用您的原始代码，在第一次添加之后，您`last`仍然是 NULL，因为`else`. 因此，在第二次添加时，您将 last 设置为`new Node<T>(NULL, value)`. 因此，它不会分配第一个元素的`next`指针。而且你的清单会不一致。

除此之外，还有双重释放、`string`Object 类中不必要的堆分配、所有权问题等。再举一个例子：你的`List`析构函数会由于双重释放而导致堆损坏。`delete first`由于`delete next`in的析构函数，调用将删除所有节点`Node`，只要列表一致。然后你调用`delete last`，但是那个对象已经被释放了。这会破坏程序的内存管理，也可能导致程序退出时崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T23:09:59.917

这个功能对你来说是否正确？

它说`GetPrev`，但它实际上得到了`next`。

```
Node* GetPrev() {
    return next;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T23:43:17.117

我发现如果我在`Node`构造函数中注释掉这一行代码编译：

```
if (next != NULL) {
    // next->next = this;
    prev = next;
} 
```

**编辑1：**

我还意识到你在`Node`课堂上是这样做的：

```
private:
    Node* next;
    Node* prev;
    T value; 
```

由于这些对象是在`Node`类中声明的，因此它们此时是不完整的类型。我设法将这个问题复制到一个像[这样](http://stacked-crooked.com/view?id=0a15df80655355822f2293883b6b656f)的简单问题：

```
template <class T>
struct S {
    S* s = new S();
    ~S() { delete s; }
};

int main() {
    S<int> s; // Segmentation fault      (core dumped) ./test > .stdout
} 
```

这会导致崩溃，因为`S`它本身就是一个不完整的类型。

我遇到了与您的代码相同的分段错误。我很确定这是因为`Node`类中的指针是建立在不完整的类型之上的；并从他们那里访问数据正在查看不属于您的内存，因此会崩溃。

# node.js - 尽管文件存在，为什么`grunt watch`失败并显示“ENOENT，没有这样的文件或目录”

> ID：14448786
> 
> 赞同：2
> 
> 时间：2013-01-21T23:04:01.163
> 
> 标签：node.js, build, gruntjs

当我运行时`grunt watch`，`watch`工作一次：在我编辑并保存了一个 Javascript 文件之后，Grunt 编译/缩小所有文件。但是当我再次编辑并保存同一个文件*时*，Grunt 说`ENOENT, no such file or directory 'client/debiki/debiki-action-edit.js'`。

（提到的文件是我刚刚修改的文件。）但是该文件确实存在：

```
$ ll client/debiki/debiki-action-edit.js
-rw-rw-r-- 1 kajmagnus kajmagnus 22497 Jan 21 23:47 client/debiki/debiki-action-edit.js 
```

如果我`grunt`直接从命令行运行（没有`watch`），Grunt 总是能够编译所有内容而不会出现任何错误。

发生了什么？我怎样才能`grunt watch`工作？

**细节：**

Ubuntu Linux，Grunt v0.3.17，Node.js v0.8.4。我使用内置`watch`任务，而不是`grunt-contrib-watch`.

完整的 Grunt 错误消息

```
Running "watch" task
Waiting...
/usr/local/lib/node_modules/grunt/lib/grunt/file.js:75
      throw grunt.task.taskError(e.message, e);
                       ^
TaskError: ENOENT, no such file or directory 'client/debiki/debiki-action-edit.js'
    at Task.taskError (/usr/local/lib/node_modules/grunt/lib/util/task.js:59:17)
    at /usr/local/lib/node_modules/grunt/lib/grunt/file.js:75:24
    at Array.filter (native)
    at Object.expandByType (/usr/local/lib/node_modules/grunt/lib/grunt/file.js:69:40)
    at Timer.<anonymous> (/usr/local/lib/node_modules/grunt/tasks/watch.js:158:44)
    at Timer.exports.setInterval.timer.ontimeout (timers.js:234:14) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-31T06:34:17.517

可能值得安装最新的 0.4.0 候选版本并使用 grunt-contrib-watch（以及任何其他更新的任务）。许多修复和功能已添加到 0.4.0 兼容任务中，内部 0.3.x 任务已全部移出并作为 grunt-contrib-* 的一部分得到支持

*为了获得批准并关闭此问题，将评论转换为答案*

# d3.js - D3.js IE9 检查图形数据中的节点时出错

> ID：14448790
> 
> 赞同：0
> 
> 时间：2013-01-21T23:04:06.657
> 
> 标签：d3.js

我在修复此错误时遇到问题。可能有人可以解释这里发生了什么：我正在从服务器返回 JSON：

```
 d3.json(fullpath, function (json)
        {
            graphData = json;
            if (graphData.nodes.length == 0)
            {
                $.jnotify("Sorry there is no data for graph. Please include social media type in search.");
            }
            drawGraph();
        }); 
```

这是json的一部分：

```
"nodes": [{
        "id": 1,
        "userID": 1,
        "profile_image_url": "images/twitterimage_1.jpg",
        "description": "user1 desc",
        "name": "user 1",
        "location": "Berlin",
        "statuses_count": 5,
        "followers_count": 1
    }
    ,
    {
        "id": 2,
        "userID": 2,
        "profile_image_url": "images/twitterimage_2.png",
        "description": "user2343434 desc",
        "name": "user 2",
        "location": "Berlin",
        "statuses_count": 6,
        "followers_count": 2        
    } 
```

然后在这一行：'if（graphData.nodes.length == 0）'我确实有这个错误：'错误：无法获取属性'nodes'的值：对象为空或未定义'

这仅在 IE 中，在 Chrome 或 Firefox 中不是问题。

请帮忙！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:46:22.953

好的。问题出在这一行： d3.json(fullpath, function (json)

你知道IE异步json是默认的吗？和 Chrome/Firefox 是否同步调用？

因此，解决方法是从 jquery 库切换到 .ajax 调用：

$.ajax({ url: dataPath, dataType: 'json', async: false, data: null, success: function (response) { }

谢谢！

# javascript - 没有海报属性的视频海报（移动浏览器）

> ID：14448797
> 
> 赞同：0
> 
> 时间：2013-01-21T23:04:23.903
> 
> 标签：javascript, iphone, ipad, mobile, html5-video

我正在使用`video`HTML 标签。到目前为止，如果我**没有**指定 any `poster`，将如何选择一个？它取决于视频文件格式吗？它是否取决于视频内容（第一帧等）？它是否取决于移动浏览器版本等？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:39:00.453

到目前为止，我只使用过带有视频标签的 MP4 文件，而且每次我都没有指定海报图像。默认情况下，它已拾取第一帧。

我知道这些信息对您没有任何具体证据，可能无济于事，但我想我会分享我的经验。

# php - PHP - 与模板的依赖关系相反？

> ID：14448798
> 
> 赞同：0
> 
> 时间：2013-01-21T23:04:24.703
> 
> 标签：php, templates

通常我`require lib.php`在模板中做，我在其中引用具有已实现功能的文件：

**lib.php**：

```
function output(){
 echo "test";
} 
```

和 **template.php**：

```
 head
    {?php
    require lib.php;
    output();
    ?>
    ... 
```

现在我想要两个不同的文件`lib1.php`和`lib2.php`两个不同的`output()`.

从`lib1.php` `lib2.php`我想参考template.php，并注入适当的实现`output.php`。那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:14:54.587

为什么不使用[OOP 功能](http://php.net/manual/en/language.oop5.php)？

**Lib1.php**

```
class Lib1 {

   public function output()
   {
      return 'Library 1!';
   }

} 
```

**Lib2.php**

```
class Lib2 {

   public function output()
   {
      return 'Library 2!';
   }

} 
```

在您的其他 PHP 文件中：

```
$lib1 = new Lib1();
echo $lib1->output();

$lib2 = new Lib2();
echo $lib2->output(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:15:56.297

是时候使用 OOP（面向对象编程）了。对于具有扩展的类来说，这是一个完美的情况。否则是个大问题。感兴趣的可以[看这里。](http://php.net/manual/en/language.oop5.php)

# c# - Monotouch NavigationController 过渡风格

> ID：14448800
> 
> 赞同：2
> 
> 时间：2013-01-21T23:04:34.203
> 
> 标签：c#, xcode, uinavigationcontroller, xamarin.ios, navigationcontroller

我正在为 Iphone 使用 Monotouch 故事板。我有一个导航控制器，并通过代码在某些视图上将 navigationbarhidden 设置为 false 或 true。我在 ViewWIllAppear 方法中设置可见性并且它正在工作。

现在我正在尝试以下代码，但它对导航栏没有影响。我希望导航栏淡入或做一个过渡效果。但它不工作..

`this.NavigationController.ModalTransitionStyle = UIModalTransitionStyle.CrossDissolve`.

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T07:23:58.483

`ModalTransitionStyle`用于其他目的。

成像你有 2 `UIViewController`，其中一个现在是可见的。你想用动画显示模态第二个。使用`ModalTransitionStyle`属性，您可以选择预定义动画之一。有关这些动画的演示，请参阅[该视频](http://www.youtube.com/watch?v=D9sUcV0nOSw)。

`UINavigationController`也有`ModalTransitionStyle`因为它是`UIViewController`. 然而我相信它不符合你想要的效果。

如果您可以在`StoryBoard`基于 - 的项目中使用您的自定义代码，请尝试隐藏`UINavigationBar`动画标志等于`true`：

```
// Second parameter - "animated"
NavigationController.SetNavigationBarHidden(true, true); 
```

# css - 将图像居中并将另一个图像浮动到右侧

> ID：14448803
> 
> 赞同：1
> 
> 时间：2013-01-21T23:04:50.643
> 
> 标签：css

我想要一个带有两个图像的 div。一个位于页面中心，另一个位于右侧。

我尝试将“对齐：中心”添加到 div，这使图像居中。现在，当我添加另一个图像并应用它时：'float:right' 第二个图像稍微向右移动。所以现在它在图像和页面左侧而不是整个页面之间居中。

```
<div class="navigator" id="basket_status2" align="center">

<a href="javascript:void(0);">
<img src="images/icon/check-out_empty.png" border="0" alt=""></a>

<span style="float: right; ><a href="javascript:history.back();">
<img src="images/back_button.png" border="0" alt="" /></a></span>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:16:32.653

无需处理浮动。只需根据自己的喜好放置按钮：

```
.navigator {
    width            : 100%;
    height           : 20px;
    background-color : yellow;
    position         : relative;
}

.checkout {
    margin   : auto;
    height   : 20px;
    width    : 20px;
    border   : 1px solid green;
    position : relative;
    display  : block;
}

.back_button {
    height   : 20px;
    width    : 20px;
    border   : 1px solid red;
    position : absolute;
    right    : 0;
    top      : 0;
} 
```

演示：http: [//jsfiddle.net/NJsvM/](http://jsfiddle.net/NJsvM/)

# twitter-bootstrap - 如何在 Bootstrap 的小屏幕上从侧面滑入导航菜单？

> ID：14448804
> 
> 赞同：0
> 
> 时间：2013-01-21T23:04:53.857
> 
> 标签：twitter-bootstrap

我有一个非常正常的布局，左侧边栏中的导航，右侧的主要内容。Bootstrap 的工作方式是，当屏幕太窄时，导航菜单位于顶部，而内容位于其下方。

但我觉得这非常难看。当我有实际内容要显示时，我不想在导航上浪费太多空间。我想要的是左侧有一个非常窄的栏或按钮，当你触摸它时，一个模态导航菜单会从左侧滑出。

我找不到任何关于如何在引导程序中实现这一点的信息。没有示例或教程，也没有其他文档。

我遇到的一些问题：当我将它作为网格的一部分进行时，它会在小屏幕上流到顶部，我显然不希望这样。当我把它作为主要内容的一部分时，它离屏幕边缘太远了；我想要它在屏幕的边缘。此外，它会随着主要内容滚动，我希望它保持原样。我猜是绝对定位。

还有一个问题，这应该只发生在小屏幕上。在大屏幕上，它现在的方式是完美的。因此，通常在大屏幕上可见的侧边栏应该被隐藏并在小屏幕上作为模态滑入。而且我什至没有看到任何横向滑动或折叠的组件。

那么你是怎么做到的呢？Bootstrap有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-08-06T17:57:50.087

没有任何插件，你可以这样做。

[https://jsfiddle.net/syamacl45/mcekfnpt/](https://jsfiddle.net/syamacl45/mcekfnpt/)

```
$('[data-toggle="slide-collapse"]').on('click', function() {
    $navMenuCont = $($(this).data('target'));
    $navMenuCont.animate({
        'width': 'toggle'
    }, 350);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T05:44:57.877

是的，这确实是可能的。有一个名为 jPanelMenu 的 jQuery 插件：

[http://jpanelmenu.com/](http://jpanelmenu.com/)

它是开源的，在 github 上！

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-18T12:47:23.893

您可以使用本示例中所示的非画布菜单：http: [//bootply.com/94838](http://bootply.com/94838)

当浏览器宽度较窄时，侧边栏会折叠，可以通过单击左侧的箭头来展开。

# java - 删除多行开头的整数

> ID：14448812
> 
> 赞同：1
> 
> 时间：2013-01-21T23:05:29.223
> 
> 标签：java, string, integer

我有一个`txt`文件有超过一千行文本，在开始时有一些整数。像：

```
22Ahmedabad, AES Institute of Computer Studies
526Ahmedabad, Indian Institute of Managment
561Ahmedabad, Indus Institute of Technology &amp; Engineering
745Ahmedabad, Lalbhai Dalpatbhai College of Engineering 
```

我想将所有行存储在另一个没有整数的文件中。我写的代码是：

```
while (s.hasNextLine()){
    String sentence=s.nextLine();
    int l=sentence.length();
    c++;
    try{//printing P
        FileOutputStream ffs = new FileOutputStream ("ps.txt",true);
        PrintStream p = new PrintStream ( ffs );
        for (int i=0;i<l;i++){
            if ((int)sentence.charAt(i)<=48 && (int)sentence.charAt(i)>=57){
                p.print(sentence.charAt(i));
            }
        }
        p.close();
    }   
    catch(Exception e){}
} 
```

但它输出一个空白文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T23:07:57.303

您的代码中有几处需要改进：

1.  不要用每一行重新打开输出文件。一直开着就好了。
2.  您正在删除所有数字，而不仅仅是开头的数字 - 这是您的意图吗？
3.  你知道任何一个既是`<= 48`又是同时`>= 57`的数字吗？
4.  `Scanner.nextLine()`不包括换行，所以你需要`p.println()`在每一行之后调用。

试试这个：

```
// open the file once
FileOutputStream ffs = new FileOutputStream ("ps.txt");
PrintStream p = new PrintStream ( ffs );

while (s.hasNextLine()){
    String sentence=s.nextLine();
    int l=sentence.length();
    c++;
    try{//printing P
        for (int i=0;i<l;i++){
            // check "< 48 || > 57", which is non-numeric range
            if ((int)sentence.charAt(i)<48 || (int)sentence.charAt(i)>57){
                p.print(sentence.charAt(i));
            }
        }

        // move to next line in output file
        p.println();
    }   
    catch(Exception e){}
}

p.close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T23:09:39.250

您可以将此正则表达式应用于从文件中读取的每一行：

```
String str = ... // read the next line from the file
str = str.replaceAll("^[0-9]+", ""); 
```

正则表达式`^[0-9]+`匹配行首的任意数量的数字。`replaceAll`方法用空字符串替换匹配项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T23:13:22.053

在 mellamokb 评论之上，您应该避免使用“幻数”。无法保证这些数字会落在 ASCII 代码的预期范围内。

您可以使用简单地检测字符是否为数字`Character.isDigit`

```
String value = "22Ahmedabad, AES Institute of Computer Studies";

int index = 0;
while (Character.isDigit(value.charAt(index))) {
    index++;
}
if (index < value.length()) {
    System.out.println(value.substring(index));
} else {
    System.out.println("Nothing but numbers here");
} 
```

（Nb dasblinkenlight 发布了一些出色的正则表达式，它可能更容易使用，但如果你喜欢，正则表达式会彻底颠覆我的大脑：P）

# php - 如何使用 cURL 发出 HTTPS 请求？

> ID：14448815
> 
> 赞同：3
> 
> 时间：2013-01-21T23:05:47.160
> 
> 标签：php, curl, https, ssl-certificate

我有 2 个 php 脚本，用于发送一个 xml 文件并捕获它。我正在使用 cURL，一切正常。现在我正在尝试做同样的事情，但使用 HTTP over SSL (HTTPS)。我已经用 XAMPP 安装了本地服务器，并且我已经按照这篇文章[设置了 SSL：在本地 xampp/apache 服务器上设置 SSL](https://stackoverflow.com/questions/2643462/setting-up-ssl-on-a-local-xampp-apache-server)。

我正在尝试像这样发送 xml 文件：

```
<?php
  /*
   * XML Sender/Client.
   */
  // Get our XML. You can declare it here or even load a file.

  $xml = file_get_contents("data.xml");

  // We send XML via CURL using POST with a http header of text/xml.
  $ch = curl_init();

  curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true);
  curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
  curl_setopt ($ch, CURLOPT_CAINFO, dirname(__FILE__)."/cacert.pem");

  //i use this line only for debugging through fiddler. Must delete after done with debugging.
  curl_setopt($ch, CURLOPT_PROXY, '127.0.0.1:8888');

  // set URL and other appropriate options
  curl_setopt($ch, CURLOPT_URL, "https://ipv4.fiddler/iPM/receiver.php");
  curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: text/xml'));
  curl_setopt($ch, CURLOPT_HEADER, 0);
  curl_setopt($ch, CURLOPT_POST, 1);
  curl_setopt($ch, CURLOPT_POSTFIELDS, $xml);
  curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 0);
  curl_setopt($ch, CURLOPT_REFERER, 'https://ipv4.fiddler/iPM/receiver.php');
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  $ch_result = curl_exec($ch);
  echo "Result = ".$ch_result;
  curl_close($ch);
  // Print CURL result.
?> 
```

我从这里下载了 cURL 的新证书：

[http://curl.haxx.se/ca/cacert.pem](http://curl.haxx.se/ca/cacert.pem)

我不确定我应该把证书放在哪里，但我把它放在我这个项目的工作区目录中。

现在的问题是 XML 文件永远不会发送到接收方。有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T02:14:03.437

`cacert.pem`您通过 传递给 cURL 的用于`CURLOPT_CAINFO`验证证书颁发机构，但开发服务器通常具有不包含在该捆绑包中的自签名证书。

第一步是生成您自己的自签名证书。[本文](http://www.akadia.com/services/ssh_test_certificate.html)将逐步介绍该过程。确保在生成 CSR 期间，您使用的是 . 下的预期服务器名称`Common Name (CN)`，例如`ipv4.fiddler`.

一旦您使用自签名证书（例如`server.crt`）和密钥（例如`server.key`）配置了您的 Web 服务器，您需要将前者复制到您的脚本可以访问它的位置。

以下基本要素可用于验证整个事情：

```
$ch = curl_init('https://ipv4.fidler');
curl_setopt_array($ch, array(
    CURLOPT_SSL_VERIFYPEER => true,
    CURLOPT_SSL_VERIFYHOST => 2,
    CURLOPT_VERBOSE => true,
    CURLOPT_CAINFO => '/path/to/server.crt',
));

if (false === curl_exec($ch)) {
    echo "Error while loading page: ", curl_error($ch), "\n";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-12T15:43:01.830

如果我想使用 发送`ssl`发布请求`Curl`，而不验证证书，则可以使用以下代码：

```
$data = array(
    'name' => $name,
    'ip' => $ip,
    'text'=> "text"
);

$ch = curl_init();

curl_setopt($ch, CURLOPT_URL,'https://myserver.com/index.php/');
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS,
          http_build_query($data));

// receive server response ...
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$server_output = curl_exec ($ch);
curl_close ($ch); 
```

# objective-c - Restkit 是否通过 CoreData Sqlite 处理实体唯一性？

> ID：14448816
> 
> 赞同：1
> 
> 时间：2013-01-21T23:05:51.083
> 
> 标签：objective-c, sqlite, core-data, restkit

当使用 RestKit 从 Restful 服务下载 json 对象并在映射中设置实体时。实体唯一性是否延伸到 CoreData sqlite 数据库？如果是这样，它是如何实现的？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T12:34:26.690

使用 RestKit 0.20，通过`identificationAttributes`在定义实体映射时指定来实现唯一性。如果您不这样做，则每次执行对象映射时都会创建新记录。

有关更多信息，请参阅[https://github.com/RestKit/RestKit/wiki/Object-Mapping](https://github.com/RestKit/RestKit/wiki/Object-Mapping)，特别是核心数据部分。

# tsql - 如何创建返回临时表？

> ID：14448818
> 
> 赞同：0
> 
> 时间：2013-01-21T23:06:01.943
> 
> 标签：tsql, sql-server-2000

我正在构建一个存储过程，它将作为一个**配置字符串**代码阅读器，它将接受一个`@config varchar(255)`变量。

此**配置字符串**确定了我们模型中的 26 个设置。

获取配置字符串条目之一：

```
declare @casingType varchar(50);
set @casingType=case SubString(@config, 34, 1)
  when '1' then 'U-Flange - All Around w/ Stacking Flanges'
  when '2' then 'U-Flange - All Around'
  when '3' then 'U-Flange - No Top & Bottom'
  when '4' then 'U-Flange - Flat Top & Bottom'
  when '5' then 'Box Bracket - End Plates Only'
  when '6' then 'Box Bracket - All Around'
  when '7' then 'Slip & Drive Bracket'
  when '8' then 'L Flange'
  when '0' then 'No Casing'
  when 'A' then '3 Sided Box - No Top & Bottom'
  when 'B' then '3 Sided Box - Top & Bottom'
  when 'C' then '3 Sided Box - Top or Bottom'
  when 'D' then 'U-Flange w/ Stacking Plates'
  when 'E' then 'U-Flange Temp Top & Bottom'
  when 'F' then 'Flat Bracket'
  when 'G' then 'A Coil Slab Bracket'
  when 'H' then '2 Sided Box'
  when 'I' then '3 Sided Box w/ Temp Top & Bottom'
  when 'O' then 'One Plus One Casing'
  when 'X' then 'Special'
  when 'Y' then 'Auto Braze'
  else 'Error' end; 
```

我要返回的是一 (1) 行的表格，其中包含每个项目的文本字段。

我是创建一个临时表来返回还是创建其他类型的表来返回？

我希望这是有道理的。可能是我措辞不正确或使用了不恰当的 SQL 术语。

**解决方案：**所以，我得到了这个工作，这是我用来做的代码。

通常我们的销售人员或工程师使用**配置字符串**工作不知道某个字母的含义，因此他们必须查找它。超过 70% 的时间，这会导致更多的字母代码搜索。因此，我们想简单地返回与特定配置相关的所有详细信息。

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      Joe Pool
-- Create date: 21-22 January 2013
-- Description: This returns a DataTable representation of the Model Configuration
-- =============================================
CREATE PROCEDURE sp1_Configurator(@config varchar(255)) as
BEGIN
SET NOCOUNT ON;
declare @len int;
declare @coilType varchar(50), @coilPattern varchar(50), @rowsDeep varchar(50);
declare @finHeight varchar(50), @finLength varchar(50), @finThickMat varchar(50);
declare @finPerInch varchar(50), @finTreatment varchar(50), @finCoating varchar(50);
declare @tubeWallThk varchar(50), @tubeType varchar(50), @qty varchar(50);
declare @tubeCoat varchar(50), @gauge varchar(50), @material varchar(50);
declare @casingType varchar(50), @customerCode varchar(50), @caseCoat varchar(50);
declare @arrangement varchar(50), @connType varchar(50), @connSize varchar(50);
declare @distributor varchar(50), @circuitry varchar(50), @coilApp varchar(50);
declare @agency varchar(50), @outsideCoat varchar(50);
declare @table table (
  CoilType varchar(50) null, CoilPattern varchar(50) null, RowsDeep varchar(50) null, 
  FinHeight varchar(50) null, FinLength varchar(50) null, FinThickMat varchar(50) null, 
  FinPerInch varchar(50) null, FinTreatment varchar(50) null, FinCoating varchar(50) null, 
  TubeWallThk varchar(50) null, TubeType varchar(50) null, Qty varchar(50) null, 
  TubeCoat varchar(50) null, Gauge varchar(50) null, Material varchar(50) null, 
  CasingType varchar(50) null, CustomerCode varchar(50) null, CaseCoat varchar(50) null, 
  Arrangement varchar(50) null, ConnType varchar(50) null, ConnSize varchar(50) null, 
  Distributor varchar(50) null, Circuitry varchar(50) null, CoilApp varchar(50) null, 
  Agency varchar(50) null, OutsideCoat varchar(50) null
);
set @len=Len(@config)
if (@len=53) begin
  set @coilType=case SubString(@config, 1, 1)
    when 'C' then 'Slab' 
    when 'B' then '1 + 1'
    when 'A' then 'A Coil (OBS)'
    when 'X' then 'Special'
    else 'Error' end;
  set @coilPattern=case SubString(@config, 2, 1)
    when '7' then '7mm Tube (.827 x .472 Staggered)'
    when '6' then '5/16" Tube (1 x 5/8 Staggered)(OBS)'
    when '3' then '3/8" Tube (1 x .866 Staggered)'
    when 'P' then '1/2" Tube (1 1/4 x 1.08 Staggered)'
    when '5' then '5/8" Tube (1 1/2 x 1.299 Staggered)'
    else 'Error' end;
  set @rowsDeep=SubString(@config, 3, 2);
  set @finHeight=SubString(@config, 6, 5);
  set @finLength=SubString(@config, 12, 6);
  set @finThickMat=case SubString(@config, 19, 1)
    when 'A' then '.0045 AL (OBS)'
    when 'J' then '.0055 AL (OBS)'
    when 'B' then '.0060 AL'
    when 'C' then '.0075 AL'
    when 'D' then '.0100 AL'
    when 'E' then '.0045 CU (OBS)'
    when 'K' then '.0050 CU (OBS)'
    when 'F' then '.0060 CU'
    when 'G' then '.0075 CU (OBS)'
    when 'H' then '.0100 CU (OBS)'
    when 'P' then '.0065 Pre-Coated'
    when 'X' then 'Special'
    else 'Error' end;
  set @finPerInch=SubString(@config, 20, 2);
  set @finTreatment=case SubString(@config, 22, 2)
    when 'FS' then 'Flat / Straight (OBS)'
    when 'FR' then 'Flat / Rippled (OBS)'
    when 'CS' then 'Corrugated / Straight (OBS)'
    when 'CR' then 'Corrugated / Rippled'
    when 'SS' then 'Sine / Straight (OBS)'
    when 'SR' then 'Sine / Rippled'
    when 'LS' then 'Louvered / Straight (OBS)'
    when 'LR' then 'Louvered / Rippled (OBS)'
    when 'RL' then 'Embossed Arch / Rippled*'
    when 'XX' then 'Special'
    else 'Error' end;
  set @finCoating=case SubString(@config, 24, 1)
    when 'N' then 'See Coil Coating'
    when 'A' then 'Alodine (OBS)'
    when 'K' then 'Technicoat'
    when 'P' then 'Paint Bond'
    when 'X' then 'Special'
    else 'Error' end;
  set @tubeWallThk=case SubString(@config, 26, 1)
    when 'A' then '.012 Smooth (5/16)(OBS)'
    when 'B' then '.014 Smooth (3/8)(OBS)'
    when 'C' then '.017 Smooth (1/2)'
    when 'D' then '.018 Smooth (5/8)'
    when 'E' then '.025 Smooth (1/2, 5/8)'
    when 'F' then '.035 Smooth (1/2, 5/8)'
    when 'G' then '.049 Smooth (5/8)'
    when 'H' then '.012 Rifled (3/8)'
    when 'K' then '.012 Rifled (7mm)'
    when 'L' then '.016 Rifled (7mm) (OBS)'
    when 'P' then '.06 Rifled (1/2)'
    when 'X' then 'Special (.016 Rifled 3/8)(OBS)'
    else 'Error' end;
  set @tubeType=case SubString(@config, 27, 1)
    when '1' then 'ST Flexpand'
    when '2' then 'ST ALL DL Flexpand'
    when '3' then 'ST w/DLST Flexpand'
    when '5' then 'HP Flexpand'
    when '6' then 'HP w/ST Flexpand'
    when 'A' then 'ST w/DL*'
    when 'B' then 'HP w/DL*'
    when 'C' then 'Hairpin w/Straight*'
    when 'D' then 'Hairpin 1/Hairpin .8* (OB)'
    when 'E' then 'HP / DL / ST*'
    when 'F' then 'HP / DL / ST / ST DL*'
    when 'G' then 'HP / DL ST*'
    when 'H' then 'Hairpint (HP)'
    when 'I' then 'HP / ST / DL HP*'
    when 'J' then '.8 HP* (OBS)'
    when 'K' then 'One Short HP / One Long HP*'
    when 'L' then 'HP w/Special DL*'
    when 'M' then 'HP w/Special DL / ST*'
    when 'N' then 'HP 1/HP .8/ST* (OBS)'
    when 'O' then 'HP 1/HP .8/DL 1 HP/DL .8 HP* (OBS)'
    when 'P' then 'All DL ST'
    when 'Q' then 'ST w/Special DL ST*'
    when 'R' then 'HP .8 / ST* (OBS)'
    when 'S' then 'Straight (ST)'
    when 'T' then 'Hydro Ball (HB)'
    when 'U' then 'HB w/ DL*'
    when 'V' then 'ST w/Spin Down*'
    when 'W' then 'HP 7mm .827/.627 Angle*'
    when 'Y' then 'HP 7mm All .627*'
    when 'X' then 'Special*'
    else 'Error' end;
  set @qty=SubString(@config, 28, 2);
  set @tubeCoat=case SubString(@config, 30, 1)
    when 'N' then 'No Coating'
    when 'T' then 'Tinned Plating (OBS)'
    when 'X' then 'Special'
    else 'Error' end;
  set @gauge=case SubString(@config, 32, 1)
    when '2' then '20 Gauge'
    when '8' then '18 Gauge'
    when '6' then '16 Gauge'
    when '4' then '14 Gauge'
    when '5' then '0.050" THK'
    when '3' then '0.063" THK'
    when '9' then '0.090" THK'
    when 'X' then 'Special'
    else 'Error' end;
  set @material=case SubString(@config, 33, 1)
    when 'G' then 'Galvanized'
    when 'S' then 'Stainless'
    when 'C' then 'Copper'
    when 'A' then 'Aluminum'
    when 'P' then 'Paint Bond'
    when 'X' then 'Special'
    else 'Error' end;
  set @casingType=case SubString(@config, 34, 1)
    when '1' then 'U-Flange - All Around w/ Stacking Flanges'
    when '2' then 'U-Flange - All Around'
    when '3' then 'U-Flange - No Top & Bottom'
    when '4' then 'U-Flange - Flat Top & Bottom'
    when '5' then 'Box Bracket - End Plates Only'
    when '6' then 'Box Bracket - All Around'
    when '7' then 'Slip & Drive Bracket'
    when '8' then 'L Flange'
    when '0' then 'No Casing'
    when 'A' then '3 Sided Box - No Top & Bottom'
    when 'B' then '3 Sided Box - Top & Bottom'
    when 'C' then '3 Sided Box - Top or Bottom'
    when 'D' then 'U-Flange w/ Stacking Plates'
    when 'E' then 'U-Flange Temp Top & Bottom'
    when 'F' then 'Flat Bracket'
    when 'G' then 'A Coil Slab Bracket'
    when 'H' then '2 Sided Box'
    when 'I' then '3 Sided Box w/ Temp Top & Bottom'
    when 'O' then 'One Plus One Casing'
    when 'X' then 'Special'
    when 'Y' then 'Auto Braze'
    else 'Error' end;
  set @customerCode=case SubString(@config, 35, 5)
    when '00' then 'Standard'
    when '14' then 'AAON Damper'
    when '15' then 'AAON Cond.'
    when '16' then 'AAON Evap.'
    when 'XX' then 'Special'
    else 'Error' end;
  set @caseCoat=case SubString(@config, 37, 1)
    when 'N' then 'See Coil Coating'
    when 'A' then 'Alodine (OBS)'
    when 'C' then 'Ceramic'
    when 'X' then 'Special'
    else 'Error' end;
  set @arrangement=SubString(@config, 39, 2);
  set @connType=case SubString(@config, 41, 1)
    when '0' then 'No Connection'
    when 'M' then 'MPT'
    when 'F' then 'FPT'
    when 'S' then 'Sweat'
    when 'W' then 'Water Bead (OBS)'
    when 'B' then 'Barbed FTG (OBS)'
    when 'N' then 'Male Flare'
    when 'G' then 'Female Flare'
    when 'O' then 'Male O-Ring (OBS)'
    when 'P' then 'Female O-Ring (OBS)'
    when 'X' then 'Special'
    else 'Error' end;
  set @connSize=case SubString(@config, 42, 1)
    when '0' then 'No Connection'
    when '1' then '3/8 OD'
    when '2' then '1/2 OD'
    when '3' then '5/8 OD'
    when '4' then '7/8 OD'
    when '5' then '1-1/8 OD'
    when '6' then '1-3/8 OD'
    when '7' then '1-5/8 OD'
    when '8' then '2-1/8 OD'
    when '9' then '2-5/8 OD'
    when 'A' then '3-1/8 OD'
    when 'B' then '5/16 OD'
    when 'C' then '3/4 OD'
    when 'D' then '4-1/8 OD'
    when 'E' then '3/16 OD'
    when 'X' then 'Special'
    else 'Error' end;
  set @distributor=case SubString(@config, 44, 4)
    when 'N000' then 'None Required'
    when 'X001' then 'Special'
    else 'Factory Assigned' end;
  set @circuitry=case SubString(@config, 49, 2)
    when 'SS' then 'Single Circuit'
    when 'FF' then 'Full'
    when 'HH' then 'Half'
    when 'QQ' then 'Quarter'
    when 'DD' then 'Double'
    when 'DH' then '1-1/2'
    when 'II' then 'Intertwined <2'
    when 'RS' then 'Row Split <2'
    when 'FS' then 'Face Split <2'
    when '00' then 'No Circuitry'
    when '01' then 'One Circuit'
    when '02' then 'Two Circuits'
    when '03' then 'Three Circuits'
    when '04' then 'Four Circuits'
    when '0S' then 'No Circuitry + SubCooler'
    when '1S' then 'One Circuit + SubCooler'
    when '2S' then 'Two Circuits + SubCooler'
    when '3S' then 'Three Circuits + SubCooler'
    when 'XX' then 'Special'
    else 'Error' end;
  set @coilApp=case SubString(@config, 51, 1)
    when 'D' then 'Drainable Water'
    when 'W' then 'Water'
    when 'G' then 'Cond / SubCooler'
    when 'C' then 'Condenser'
    when 'E' then 'Evaporator'
    when 'S' then 'Steam'
    when 'N' then 'Steam Distributor'
    when 'B' then 'Booster'
    when 'H' then 'Heat Reclaim'
    when 'P' then 'Heat Pipe (OBS)'
    when 'L' then 'Glycol'
    when 'O' then 'Oil (OBS)'
    when 'X' then 'Special'
    else 'Error' end;
  set @agency=case SubString(@config, 52, 1)
    when '0' then 'None'
    when 'A' then 'ARI'
    when 'B' then 'ARI + UL / CSA'
    when 'C' then 'UL / CSA'
    when 'E' then 'ETL / DOE'
    else 'Error' end;
  set @outsideCoat=case SubString(@config, 53, 1)
    when 'N' then 'No Coating'
    when 'A' then 'Ceramic'
    when 'C' then 'Chromocoat'
    when 'E' then 'Epoxy'
    when 'G' then 'Americoat Grey (OBS)'
    when 'H' then 'Heresite'
    when 'K' then 'Phenolic (Technicoat)'
    when 'L' then 'ElectroFin'
    when 'P' then 'Phenolic (OBS)'
    when 'X' then 'Special'
    else 'Error' end;
  insert into @table
    (CoilType, CoilPattern, RowsDeep, FinHeight, FinLength, FinThickMat, FinPerInch, FinTreatment, FinCoating,
     TubeWallThk, TubeType, Qty, TubeCoat, Gauge, Material, CasingType, CustomerCode, CaseCoat, Arrangement,
     ConnType, ConnSize, Distributor, Circuitry, CoilApp, Agency, OutsideCoat)
     values
    (@coilType, @coilPattern, @rowsDeep, @finHeight, @finLength, @finThickMat, @finPerInch, @finTreatment, @finCoating,
    @tubeWallThk, @tubeType, @qty, @tubeCoat, @gauge, @material, @casingType, @customerCode, @caseCoat, @arrangement,
    @connType, @connSize, @distributor, @circuitry, @coilApp, @agency, @outsideCoat);
end
select * from @table;
END
GO 
```

以下是实际**配置字符串**的样子：

> CP06-51.25-051.50-B12SRN-CT00N-8G2XXN-A2S8-N000-HHWAN

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:13:32.580

你有没有想过创建一个用户定义的函数：

```
create function CastingTypeFunction(@config varchar(255))
returns varchar(50)
as
begin
  declare @casingType varchar(50)
  set @casingType=case SubString(@config, 34, 1)
    when '1' then 'U-Flange - All Around w/ Stacking Flanges'
    when '2' then 'U-Flange - All Around'
    when '3' then 'U-Flange - No Top & Bottom'
    when '4' then 'U-Flange - Flat Top & Bottom'
    when '5' then 'Box Bracket - End Plates Only'
    when '6' then 'Box Bracket - All Around'
    when '7' then 'Slip & Drive Bracket'
    when '8' then 'L Flange'
    when '0' then 'No Casing'
    when 'A' then '3 Sided Box - No Top & Bottom'
    when 'B' then '3 Sided Box - Top & Bottom'
    when 'C' then '3 Sided Box - Top or Bottom'
    when 'D' then 'U-Flange w/ Stacking Plates'
    when 'E' then 'U-Flange Temp Top & Bottom'
    when 'F' then 'Flat Bracket'
    when 'G' then 'A Coil Slab Bracket'
    when 'H' then '2 Sided Box'
    when 'I' then '3 Sided Box w/ Temp Top & Bottom'
    when 'O' then 'One Plus One Casing'
    when 'X' then 'Special'
    when 'Y' then 'Auto Braze'
    else 'Error' end

    return @casingType
end; 
```

然后，您将把您的`@config`值传递给与此类似的函数：

```
 select dbo.CastingTypeFunction(@config) 
```

然后将返回您的值。

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/f8e6e/3)。

我可以看到您拥有的另一个选项是创建一个包含每个这些值的表，然后您将加入该表以返回`casingType`.

这些表将与此类似：

```
CREATE TABLE CasingType
    ([CasingTypeId] varchar(1), [CasingValue] varchar(41))
; 
```

然后你会像这样加入它：

```
select 
  case 
    when c.casingtypeid is null 
    then 'Error'
    else c.casingvalue end
from
(
  select '12323212334234231211231212121qwe1212312334234234' config  -- replace with your config values
) src
left join CasingType c
  on SubString(src.config, 34, 1) = c.casingtypeid 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/ed375/2)

# javascript - to_json 方法 => []

> ID：14448823
> 
> 赞同：1
> 
> 时间：2013-01-21T23:06:09.317
> 
> 标签：javascript, ruby-on-rails, ruby, json, backbone.js

我的控制器中有以下内容作为方法：

```
@study = Study.find(params[:id])
respond_to do |format|
  format.json { render :json => @study.to_json(:only => [:id, :first_name, :last_name, :title], :methods => [:active_users]) }
end 
```

它正在响应 JSON 调用。`active_users`是一种`@study`转换用户数组的方法。JSON 看起来像这样：

```
{
    "id": 1,
    "title": "Anterior segment imaging using ultrasound biomicroscopy (UBM) and slit lamp optic coherence tomography (SL-OCT) in patients using alpha-adrenergic blockers. ",
    "active_users": [
        null,
        null,
        null,
        null
    ]
} 
```

JSON 将作为用户的所有空值返回。我应该怎么做？

# android - Android (andengine + box2d) 初学者 - 拖动一个对象（sprite/body）

> ID：14448827
> 
> 赞同：1
> 
> 时间：2013-01-21T23:06:29.660
> 
> 标签：android, box2d, andengine

我目前正在关注一些教程来介绍 andEngine 和 box2d，我想拖动一个**对象（附加到身体的精灵）**，同时它正在弹跳（它已注册到物理世界）。

我想**拖动**，这样我就可以看到我的角色在移动。只有当我将代码注释如下（我正在注册物理连接器的部分）时，它才有效。如果我取消注释，一切都会正常工作（例如，即使我设置了其他属性），除了 setPosition！- 我确定**代码正在进入 ACTION_MOVE 案例**

**问题1：**为什么这种方法不起作用？- 也许我必须拖动身体而不是精灵？

**问题 2：**如何在 onAreaTouched 内引用 body 并在其中进行操作？- 我尝试了许多不同的方法，但它似乎只在声明精灵时必须创建 onAreaTouch。

参考：[http](http://stuartmct.co.uk/2012/07/18/andengine-touch-events-with-sprites-and-shapes/) : //stuartmct.co.uk/2012/07/18/andengine-touch-events-with-sprites-and-shapes/和AndEngine Book

```
Sprite sPlayer = new Sprite(CAMERA_WIDTH / 2, CAMERA_HEIGHT / 2,
                playerTextureRegion,
                this.mEngine.getVertexBufferObjectManager()) {
            @Override
            public boolean onAreaTouched(final TouchEvent pSceneTouchEvent,
                    final float pTouchAreaLocalX, final float pTouchAreaLocalY) {
                Log.i(this.getClass().getName(), "area touched");
                switch (pSceneTouchEvent.getAction()) {
                case TouchEvent.ACTION_DOWN:
                    break;
                case TouchEvent.ACTION_UP:
                    break;
                case TouchEvent.ACTION_MOVE:
                    this.setPosition(pSceneTouchEvent.getX() - this.getWidth()
                            / 2, pSceneTouchEvent.getY() - this.getHeight() / 2);
                    break;
                }

                return true;
            }
        };

        FixtureDef PLAYER_FIX = PhysicsFactory.createFixtureDef(10.0f, 0.75f,
                0.0f);
        // apply all forces, collisions to body - Dynamic
        Body body = PhysicsFactory.createCircleBody(physicsWorld, sPlayer,
                BodyType.DynamicBody, PLAYER_FIX); 
```

## 以下代码不允许我设置 Sprite 的位置：

```
/*
        // relate to collisions after adding to scene
        physicsWorld.registerPhysicsConnector(new PhysicsConnector(sPlayer,
                body, true, true));

*/ 
```

* * *

```
 this.scene.registerTouchArea(sPlayer);
        this.scene.setTouchAreaBindingOnActionDownEnabled(true);
        this.scene.attachChild(sPlayer); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T04:55:10.043

你需要去

`myPad.setTransform(pSceneTouchEvent.getX() - (this.getWidth() / 2), pSceneTouchEvent.getY() - (this.getHeight() / 2), 0);//the zero at the end is for setting the angle`

因为使用 box2d 你需要移动身体和物理连接器

`physicsWorld.registerPhysicsConnector(new PhysicsConnector(sPlayer, body, true, true));`

将使精灵跟随身体。

# html - 如何删除空白图像容器？

> ID：14448830
> 
> 赞同：0
> 
> 时间：2013-01-21T23:06:53.503
> 
> 标签：html

如果图像的来源不可用，如何删除空白图像容器？我只希望图像在其来源可用时出现。否则，我不想出现任何东西，包括空白容器。

HTML 图像语法：

```
<img src="url" alt="some_text"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:13:23.477

您可以使用 JavaScript 和`error`img 标签上的事件来执行此操作。

例如：

```
<img src="url" alt="some_text" id="myimage">

<script>
    var imgElement = document.getElementById('myimage');
    imgElement.addEventListener('error', function()
    {
        this.parentNode.removeChild(this);
    }, true);
</script> 
```

*（糟糕，抱歉@JosephSilber，将我的示例修改为有点不同；-)）*

如果您知道您的图像将不可用，那么您最好的选择是使用服务器端处理。例如，如果您有意`src`留空，您可以在 PHP 中执行以下操作：

```
<?php
$src = ''; // or something else

if (!empty($src)) { ?>
    <img src="<?=$src?>" alt="some_text" />
<?php } ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:09:02.750

循环浏览您的图像，并绑定`onerror`：

```
imgNode.onerror = function () {
    this.parentNode.removeChild(this);
}; 
```

# c# - C++ dll没有返回到c#

> ID：14448836
> 
> 赞同：0
> 
> 时间：2013-01-21T23:07:30.870
> 
> 标签：c#, c++, dll, pinvoke

我正在开发一个项目，该项目使 C# 与以前在 C++ 中创建的 DLL 进行交互。下面的代码显示了我如何导出我需要的函数：

```
extern "C" __declspec(dllexport) int iterateAndTest(int testSize, char* testHash){

CUDADLL dll;
int ret = dll.iterateAndTest(testSize, testHash);
return ret;
} 
```

下面的代码显示了我如何在 C# 中声明函数：

```
[DllImport("C:\\Users\\BrunoBraga\\Documents\\Visual Studio 2012\\Projects\\CUDADLL\\Debug\\CUDADLL.dll")]
public static extern int iterateAndTest(int testSize, string testHash); 
```

问题是：dll 函数没有返回任何东西。事实上，dll 一旦被调用，就永远不会返回到 C# 并且程序只是结束。

我不确定我是否给出了正确的代码，但我想我缺少一些关于 dll 的东西。

很抱歉延迟回复。有两个问题： 1-当我创建对象时，我应该使用新的 CUDADLL dll。我认为我可以做到这一点，因为没有新的我仍然能够访问内部字段。

2-程序应该在admin下运行，否则会发生一些崩溃；

再次感谢各位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T06:59:03.727

在您的 c++ 代码中插入`__stdcall`

```
extern "C" __declspec(dllexport) __stdcall int iterateAndTest(int testSize, char* testHash); 
```

在 C# 中

```
[DllImport("yourdll.dll", EntryPoint="iterateAndTest", CallingConvention=CallingConvention.StdCall)]
public static extern int iterateAndTest(int testSize, string testHash); 
```

在您的 C++ 函数中使用`cout`，如果调用该函数，则输出将显示在输出窗口中，如果您使用的是 Visual Studio。尝试将你的 c++ dll 放在你的输出目录中

可能的错误：找不到dll或将引发入口点异常。

# mysql - 复杂的 MySQL 查询求和连接记录，其中父 ID 和子 ID 相等

> ID：14448839
> 
> 赞同：1
> 
> 时间：2013-01-21T23:07:37.137
> 
> 标签：mysql, join

也许这对你们中的一些 MySQL 大师来说是一件容易的事，他们将这些东西视为 3 级儿童读物。

我有多个表要加入以生成报告的统计数据，而此刻我正试图弄清楚这一点。显然，这些数字必须正确，因为它会影响未来的许多决策。

这是土地的概况（不是全貌，但你会明白的）：

附属表

```
+----+-----------+------------+---------------------+
| id | firstname | lastname   | created_date        |
+----+-----------+------------+---------------------+
|  1 | Mike      | Johnson    | 2010-11-22 17:44:37 |
|  2 | Trevor    | Wilson     | 2010-12-23 16:24:24 |
|  3 | Bob       | Parker     | 2011-11-04 10:33:49 |
+----+-----------+------------+---------------------+ 
```

现在我们的查询应该只找到 Bob Parker (id 3) 的结果，所以我将只显示 Bob 的示例结果。

附属链接表

```
+-----+-----------+--------------+-----------+----------+---------------------+
| id  | parent_id | affiliate_id | link_type | linkhash | created_date        |
+-----+-----------+--------------+-----------+----------+---------------------+
|  21 |      NULL |            3 | PRODUCT   | fa2e82a7 | 2011-06-15 16:18:37 |
|  27 |      NULL |            3 | PRODUCT   | 55de2ae7 | 2011-06-23 01:03:00 |
|  28 |      NULL |            3 | PRODUCT   | 02cae72f | 2011-06-23 01:03:00 |
|  29 |        27 |            3 | PRODUCT   | a4dfb2c8 | 2011-06-23 01:03:00 |
|  30 |        28 |            3 | PRODUCT   | 72cea1b2 | 2011-06-23 01:03:00 |
|  36 |        21 |            3 | PRODUCT   | fa2e82a7 | 2011-06-23 01:07:03 |
|  59 |        21 |            3 | PRODUCT   | ec33413f | 2011-11-04 17:49:17 |
|  60 |        27 |            3 | PRODUCT   | f701188c | 2011-11-04 17:49:17 |
|  69 |        21 |            3 | PRODUCT   | 6dfb89fd | 2011-11-04 17:49:17 |
+-----+-----------+--------------+-----------+----------+---------------------+ 
```

会员统计

```
+--------+--------------+--------------------+----------+---------------------+
| id     | affiliate_id | link_id | order_id | type     | created_date        |
+--------+--------------+---------+----------+----------+---------------------+
|  86570 |            3 |      21 |     NULL | CLICK    | 2013-01-01 00:07:31 |
|  86574 |            3 |      21 |     NULL | PAGEVIEW | 2013-01-01 00:08:53 |
|  86579 |            3 |      21 |      411 | SALE     | 2013-01-01 00:09:52 |
|  86580 |            3 |      36 |     NULL | CLICK    | 2013-01-01 00:09:55 |
|  86582 |            3 |      36 |     NULL | PAGEVIEW | 2013-01-01 00:09:56 |
|  86583 |            3 |      28 |     NULL | CLICK    | 2013-01-01 00:11:04 |
|  86584 |            3 |      28 |     NULL | PAGEVIEW | 2013-01-01 00:11:04 |
|  86586 |            3 |      30 |     NULL | CLICK    | 2013-01-01 00:30:18 |
|  86587 |            3 |      30 |     NULL | PAGEVIEW | 2013-01-01 00:30:20 |
|  86611 |            3 |      69 |     NULL | CLICK    | 2013-01-01 00:40:19 |
|  86613 |            3 |      69 |     NULL | PAGEVIEW | 2013-01-01 00:40:19 |
|  86619 |            3 |      69 |      413 | SALE     | 2013-01-01 00:42:12 |
|  86622 |            3 |      60 |     NULL | CLICK    | 2013-01-01 00:46:00 |
|  86624 |            3 |      60 |     NULL | PAGEVIEW | 2013-01-01 00:46:01 |
|  86641 |            3 |      60 |     NULL | PAGEVIEW | 2013-01-01 00:55:58 |
|  86642 |            3 |      30 |      415 | SALE     | 2013-01-01 00:56:35 |
|  86643 |            3 |      28 |     NULL | PAGEVIEW | 2013-01-01 00:56:43 |
|  86644 |            3 |      60 |      417 | SALE     | 2013-01-01 00:56:52 |
+--------+--------------+---------+----------+----------+---------------------+ 
```

订单

```
+------+--------------+---------+---------------------+
| id   | affiliate_id | total   | created_date        |
+------+--------------+---------+---------------------+
|  411 |            3 |  138.62 | 2013-01-01 00:09:50 |
|  413 |            3 |  312.87 | 2013-01-01 00:09:52 |
|  415 |            3 |  242.59 | 2013-01-01 00:09:55 |
|  417 |            3 |  171.18 | 2013-01-01 00:09:55 |
+------+--------------+---------+---------------------+ 
```

现在我需要的结果应该是这样的（只显示主/父链接 id）

```
+---------+---------+
| link_id | total   |
+---------+---------+
|      21 |  451.49 | <- 1 order from parent (21), 1 from child (69)
|      27 |  171.18 | <- 1 order from child (69)
|      28 |  242.59 | <- 1 order from child (30)
+---------+---------+ 
```

我不太确定如何编写查询，以便我可以总结affiliate_link.id 和affiliate_link.parent_id 的组合位置。这甚至可以通过几个 JOIN 和 GROUPing 实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T07:48:12.687

我不太确定您为什么要进行非规范化`affiliate_id`（通过将其放在每个表中），因此，是否可以依靠源自特定链接的所有统计数据和订单与`affiliate_id`该链接相同。

如果可能的话，我建议更改`AffiliateLink.parent_id`列，使父记录指向自己（而不是`NULL`）：

```
UPDATE AffiliateLink SET parent_id = id WHERE parent_id IS NULL 
```

然后就是一个简单的join和grouping的例子：

```
SELECT   AffiliateLink.parent_id AS link_id,
         SUM(Orders.total) AS total
FROM     AffiliateLink
    JOIN AffiliateStats ON AffiliateStats.link_id = AffiliateLink.id
    JOIN Orders         ON Orders.id = AffiliateStats.order_id
WHERE    AffiliateLink.affiliate_id = 3
GROUP BY AffiliateLink.parent_id 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/c57a8/1/0)上查看。

如果无法进行更改，您可以使用以下方法有效地创建结果`AffiliateLink`表`UNION`（但要注意性能影响，因为 MySQL 将无法对结果使用索引）：

```
(
  SELECT parent_id, id, affiliate_id FROM AffiliateLink WHERE parent_id IS NOT NULL
UNION ALL
  SELECT id       , id, affiliate_id FROM AffiliateLink WHERE parent_id IS NULL
) AS AffiliateLink 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/6d44c/1/0)上查看。

# database-design - 如何解决传递依赖

> ID：14448841
> 
> 赞同：1
> 
> 时间：2013-01-21T23:07:52.497
> 
> 标签：database-design

在我的项目中，我有一个包含职位发布信息的职位表。每个工作都可以定位到*（此信息存储在 JobLocations 中）*：

1.  **只有一个国家，全国范围**，*例如：(id = 1, idCountry = US, idRegion = null, idCity = null, idJob=3)*
2.  **只有一个区域，区域范围广**，*例如：(id = 2, idCountry = US, idRegion = TX, idCity=null, idJob=5)*
3.  **或者更具体一点，可以指当前国家->地区的多个城市**
    *(id = 3, idCountry = US, idRegion = TX, idCity=78, idJob=7)*
    *(id = 4, idCountry = US, idRegion = TX, idCity=200，idJob=7)*

我创建的一些表就是这些。 [工作地点 http://imageshack.us/a/img267/5530/joblocations.png](http://imageshack.us/a/img267/5530/joblocations.png) 但我可以在表 JobLocations 中看到传递依赖的问题，例如更改 idCountry 将导致更改 idRegion 或 idCity。

我还有哪些其他选项可以删除传递依赖项并实现上述第 1、2、3 点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T05:46:14.550

解决这个问题的一种方法是在每个地区设立两个“特殊”城市，一个表示“该地区的任何地方”，一个表示“全国的任何地方”。然后，城市代码`JobLocations`用于指示工作的区域性（如果您愿意的话）。

为了区分特殊城市，您可以以某种方式对它们进行编码（例如，负 id），或者更准确地说，向`City`您通过连接查找的类型列添加一个类型列。

设置好特殊城市后，您可以从 中删除 region 和 country FK 列`JobLocations`。

顺便说一句，如果我是你，我会从 Country、Region 和 City 中删除 id 列。它们是无用的开销，并且通过允许重复名称来引发错误。 `JobLocations`也不需要身份证；它将只有 JobID 和 City 作为列，并且它的主键包括它们两者。

*两个国家都不能有工作*的规则很难执行。您需要一个大致说明的触发器`count(city) < 2 where type in ('country','region')`。它比这更复杂，但你描述的规则都可以表达为一个`SELECT`语句。

# java - 重命名由 Java Servlet 流式传输的 PDF

> ID：14448846
> 
> 赞同：3
> 
> 时间：2013-01-21T23:08:07.440
> 
> 标签：java, servlets, download

使用 XSLT、XSL-FO 和 Apache FOP 的正确组合，我能够将 PDF 发送到某个浏览器窗口。
其实我是这样发送文件内容的：

```
           response.setContentType("应用程序/pdf");
            response.setContentLength(out.size());
            response.getOutputStream().write(out.toByteArray());
            response.getOutputStream().flush();

```

正如预期的那样，浏览器在名为“pdf”的选项卡中显示 PDF 内容，如果我将文件保存在本地，名称也默认为 pdf.pdf
**我该如何强制文件名？**

我尝试了以下不起作用的方法：

```
           response.setHeader("Content-Disposition","inline; filename=" + filename + ".pdf" ); 

```

为了清楚起见，我想在浏览器中显示内容（而不是直接下载）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-21T23:31:36.877

我在[这里找到了解决方案](http://www.forumtopics.com/busobj/viewtopic.php?t=48651)

基本上，这是改变 web.xml 中的 URL 模式的问题浏览器将使用 我以前
使用的任何页面名称

```
<servlet-mapping>
        <servlet-name>PDF</servlet-name>
        <url-pattern>/pdf</url-pattern>
    </servlet-mapping> 
```

我替换为

```
<servlet-mapping>
        <servlet-name>PDF</servlet-name>
        <url-pattern>/pdf/*</url-pattern>
    </servlet-mapping> 
```

调用 servlet`http://wherever/pdf/filename.pdf?param1=va1...`将文件名更改为“filename.pdf”

# node.js - 在 Joyent 上运行 cron 时遇到问题

> ID：14448853
> 
> 赞同：0
> 
> 时间：2013-01-21T23:09:03.890
> 
> 标签：node.js, cron, joyent

我正在尝试设置一个节点脚本以在 Joyent 上作为 cron 作业运行。我可以运行任意命令，但似乎可以执行节点脚本。举个例子：

```
# cron
# call a script every minute
# being specific about the location of node and the script to run 
* * * * * /home/node/local/nodejs/bin/node /full/path/to/some-script.js

// node script at /full/path/to/some-script.js
var fs = require('fs');
fs.writeFile('/home/node/node-service/some-script.log', new Date.toString(), 'utf8'); 
```

一分钟后我希望看到的是 /home/node/node-service/some-script.log 中的一个文件，其内容类似于`Mon Jan 21 2013 15:19:11 GMT-0600`但我什么也看不到。即使脚本设置为所有用户的完全读取、写入和执行权限以及是否为`root`或`node`用户设置了 crontab，情况仍然如此。

我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T19:55:17.100

它现在似乎正在工作。我不确定我改变了什么让它工作。可能是权限问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T00:20:28.773

第四个可选参数`writeFile`是在文件系统完成写入文件时触发的回调。您可以使用它来确定正在发生的错误，因为它的唯一参数是错误。请参阅此处的文档[。](http://nodejs.org/api/fs.html#fs_fs_writefile_filename_data_encoding_callback)

# java - Java 分发代码与开发代码

> ID：14448855
> 
> 赞同：0
> 
> 时间：2013-01-21T23:09:25.143
> 
> 标签：java, build, environment

我有一个用 Java 开发的应用程序，几乎可以分发了。但是，我在从开发环境切换到发布环境并返回开发环境时遇到问题。例如，在 Eclipse 中，如果我只想通过运行按钮进行测试运行，我必须更改代码以显示我的 JMenuItems。

在我的开发环境中，我有以下效果很好：

 `````
JMenuItem[] appItems = new JMenuItem[2];
appItems[0] = new JMenu("New");
appItems[0].setIcon(new ImageIcon(../POS_System/images/new_icon_sm.png"))); 
````  `但是，当我接近部署时，要让它在可部署的 JAR 中工作，我需要更改代码：

 `````
JMenuItem[] appItems = new JMenuItem[2];
appItems[0] = new JMenu("New");
appItems[0].setIcon(new javax.swing.ImageIcon(getClass().getResource("/images/new_icon_sm.png"))); 
````  `这是为了进入 JAR 并获取适当的图像。

我有很多这些 JMenuItems。我真的很希望能够通过 Eclipse 中的运行按钮来测试应用程序，以及在不更改代码的情况下创建 JAR。

有没有一种简单的方法可以做到这一点？我认为 getResource 方法仍然允许我使用 JMenus、JMenuItems 等，但是当我从 Eclipse 运行程序时它们不可用。我不得不不断地来回切换似乎很愚蠢。

我很感激这里的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T00:00:03.827

如果您不想按照您的建议将图像移动到 src/ 文件夹中，那么在 Eclipse 中，您应该在 Project Prooperties -> Java Build Path 下更新您的 Eclipse 配置并添加一个额外的源文件夹，这个文件夹指向哪里你保留你的图像。我相信这会解决它。````

# c# - 有没有办法从 IE 中的 onload 事件传递的 IHTMLEventObj 中找到 HTMLDocument？

> ID：14448856
> 
> 赞同：0
> 
> 时间：2013-01-21T23:09:29.073
> 
> 标签：c#, internet-explorer, visual-c++, bho

我正在使用 C# 开发浏览器助手对象（是的，我知道性能不会很好）。

我将处理程序附加到我的窗口的 HTMLWindowEvents2_Event.onload 事件。事件被正确引发（例如当刷新发生时）。我看到我的处理程序被调用，并且类型正确显示为“加载”事件。

事件处理程序有一个支持 IHTMLEventObj 的参数。我无法弄清楚如何从这个对象获取到引发 onload 事件的窗口或文档。这甚至可以从这个界面吗？传入的对象似乎有一个空的 srcElement 属性（可能是因为它是由窗口引发的事件，而不是文档中的某个元素）。

我是否需要将其转换为另一个类或接口才能获取文档？

我很乐意在 C# 或 C++ 方面提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T00:08:47.370

该事件没有来源信息。

假设是，由于您将事件附加到 Window 对象的连接点，因此您知道哪个窗口将是事件源。当您挂钩事件时，您需要保存对窗口的引用，以防您需要事件源。

```
Class HTMLWindowEvents2Sink
{
    public HTMLWindowEvents2Sink(IHTMLWindow2 eventSource)
    {
        this.eventSource=eventSource;
    }
    IHTMLWindow2 eventSource;
    void AdviseEvent()
    {
        eventSource.load += this.HTMLWindow_onload; 
    }
    ....
} 
```

[通过使用委托事件处理模型](http://support.microsoft.com/kb/811645)，您还会在这里遇到性能损失和潜在的错误农场。

# java - int 到 short 的简单位操作

> ID：14448859
> 
> 赞同：0
> 
> 时间：2013-01-21T23:09:39.423
> 
> 标签：java

根据需要的 16 位，编写将 int 转换为 short 的位操作时遇到问题，例如：1 将是最左边的 16 位，0 将是最右边的 16 位。感谢所有帮助！

```
 /**
 * Get a short from an int.
 * 
 * Examples: 
 *     getShort(0x56781234, 0); // => 0x1234
 *     getShort(0xFF254545, 1); // => 0xFF25
 * 
 * @param num The int to get a short from.
 * @param which Determines which short gets returned - 0 for least-significant short.
 *            
 * @return A short corresponding to the "which" parameter from num.
 */
public static int getShort(int num, int which)
{

    if(which == 1){
        return num>>16;
    }
    else{
        return num << 16;
    }
    } 
```

我不想使用 >>> 或 <<<

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:11:46.167

这

```
 return num << 16; 
```

应该读

```
 return num & 0xFFFF; 
```

还，

```
 return num >> 16; 
```

应该读

```
 return num >>> 16; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:13:28.523

此代码段适用于正数和负数：

```
public static int getShort(int num, int which) {
    if(which == 1){
        return num >>> 16; // Use >>> to avoid sign-extending the result
    } else{
        return num & 0xFFFF;
    }
} 
```

# php - 在 PHP 中中止 Twitter XML 加载

> ID：14448862
> 
> 赞同：0
> 
> 时间：2013-01-21T23:10:00.073
> 
> 标签：php, xml, twitter

我正在使用 simplexml_load_file() 函数加载 Twitter 成员 XML。

这工作正常，我可以解析 XML，但有时它需要很多时间来加载 XML 或 XML 不加载因为 Twitter。这不仅仅是因为 Twitter 的 150 个请求限制。

这就是为什么我想知道在 30 秒后加载不成功时是否可以中止 Twitter XML 文件加载？

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:14:32.507

我不认为你可以做很多事情，使用`simplexml_load_file()`.

但是，当使用 cURL 检索 URL 的内容时，您可以指定超时：

```
$curl = curl_init($url);
curl_setopt($curl, CURLOPT_TIMEOUT, 10); // <- Timeout in Seconds
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 

$xml = curl_exec($curl);
curl_close($curl); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:17:05.597

我首先想到的是使用 AJAX。创建对执行加载功能的 PHP 脚本的调用，如果需要超过 30 秒，则让 JavaScript 中止 AJAX 调用。

```
$.ajax({'complete': callbackFunction, 'url': 'foo/bar/', 'timeout': 5000, 'error': errorCallback}); 
```

您正在寻找`timeout`and `error`。超时（以毫秒为单位）中止脚本并调用`error`可用于返回操作已中止的消息的函数（或您想要对其执行的任何操作）。

您可以在 [有关 AJAX 的 Jquery 文档中找到更多信息](http://api.jquery.com/jQuery.ajax/)

# java - 用于将正则表达式解析为 AST 的 Java 库？

> ID：14448863
> 
> 赞同：2
> 
> 时间：2013-01-21T23:10:09.613
> 
> 标签：java, regex, parsing, metaprogramming

*通常，人们会使用正则表达式将其他内容*解析为 AST。我正在寻找的是一种工具，可用于将正则表达式本身解析为 AST，然后我可以对其进行符号操作。假设我有一个像

```
(c(o)w)/(.*?)/omg 
```

我希望能够提出类似的问题

*   有多少个捕获组？
*   有嵌套组吗？
*   正`.`则表达式中的第 10 个字符是否位于捕获组的开头？

并且能够以某种有意义的方式操作正则表达式，例如：

*   获取所有命名组的名称
*   将所有命名组替换为未命名组
*   将任何嵌套组展平为其最外层的封闭组

在将其序列化回字符串之前。

我已经四处看了看`java.util.regex.Pattern`，但它的内部都是私有的，所以我无权访问它们。我可以使用任何第三方库来执行此操作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T23:29:58.250

我会使用[ANTLR](http://antlr.org)为正则表达式创建词法分析器/解析器。根据您要使用多少正则表达式语法，这可能很容易相当复杂。Antlr 带有一个漂亮的图形编辑器，您可以在其中测试您正在创建的语法文件。生成的 AST 在标准 Java 程序中非常容易操作。如果您是 Antlr 的新手，我强烈推荐 Terence 的 Antlr 书。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-22T17:09:03.700

看看我的基于 ANTLR 的 PCRE 解析器：[https ://github.com/bkiers/PCREParser](https://github.com/bkiers/PCREParser)

# c# - 使用sos调试visual studio

> ID：14448871
> 
> 赞同：4
> 
> 时间：2013-01-21T23:10:51.693
> 
> 标签：c#, visual-studio-2010, windbg, sos

我正在尝试使用 SOS 调试 Visual Studio 2010 插件。我附加了windbg，但没有clr.dll。我尝试了.loadby sos mscoree、.loadby sos corjit，但都没有奏效。通过使用 !sw 切换到 x86 模式并将 sos 复制到 ide 文件夹并运行 .loadby sos devenv，我有点工作了。当我尝试使用任何 sos 命令时，虽然我收到以下错误。有没有办法在 Visual Studio 中使用 sos？我只想找出这个插件中有什么异常，这样我就可以向编写它的团队报告。

找不到运行时 DLL (clr.dll)，0x80004005 扩展命令需要 clr.dll 才能有事可做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:27:19.800

> 我只想找出这个插件中有什么异常，这样我就可以向编写它的团队报告。

我建议您使用[AdPlus](http://support.microsoft.com/kb/286350)来捕获内存转储。

在捕获内存转储之前，请确保已将其设置为进行完全转储。（右键我的电脑>属性>高级设置>高级>启动和恢复>写入调试信息）

第 3 方供应商将需要它来研究问题。

除非您拥有他们的私人 PDB 文件，否则您将无法发现太多有关问题的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-11T17:44:13.677

我通过关闭 WinDbg、删除 Symbols 目录中的所有文件、然后重新加载 WinDbg 来修复此错误。然后，我用“.loadby sos mscorwks”加载了sos，并且像“！dumpheap”这样的命令再次为我工作。

检查“文件 > 符号文件路径...”菜单以找到符号目录的路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-14T12:54:34.037

尝试手动加载 sos。例子：`.load C:\Windows\Microsoft.NET\Framework64\v4.0.30319\sos.dll`

# web-applications - 在 Web 应用程序中嵌入 Windows 8 商店应用程序

> ID：14448874
> 
> 赞同：0
> 
> 时间：2013-01-21T23:11:00.163
> 
> 标签：web-applications, microsoft-metro, windows-store-apps

我对 Metro Style 应用程序技术还很陌生，并且想创建一个可以嵌入到我的网页中的 Metro 风格应用程序。与我们过去使用 Silverlight 的方式相同。无论我在哪里搜索，我都找到了提供 Metro 风格 UI 设计的框架。但我的问题是是否可以在网页中显示现有的 windows 8 Metro 风格应用程序/控件。

我的目标是创建一个看起来像新的 Windows Azure 门户的门户

在此先感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T01:57:48.880

您不能在 Web 浏览器中嵌入 Windows 应用商店应用程序。

与 Silverlight（或其他基于插件的技术，如 Flash）不同，Windows 应用商店应用程序是仅在 Windows 8 上运行的应用程序。

您当然可以使用 HTML 和 CSS 样式在网站中复制 Windows 应用商店应用程序的外观和感觉，但您还应该考虑网站和应用程序之间的差异，并为您的用户提供适当的用户体验。

如果您的目标是构建具有与 Windows Azure 管理门户相似的外观和感觉的东西，我建议检查用于该站点的 CSS 样式。您可以使用 IE 开发人员工具（查看站点时按 F12）或 Firebug 或 Chrome 开发工具来执行此操作。快速浏览一下，开发人员似乎大量使用了 jQueryUI，这是一个很好的框架，可以为您的网站添加丰富的 UI 功能。

但最终，您将需要开发标记、脚本和 CSS，以提供您正在寻找的外观和感觉。如上所述，您无法在 Web 浏览器中运行 Windows 应用商店应用程序。

# ruby-on-rails - 如何使用 FactoryGirl 创建嵌入式文档？

> ID：14448881
> 
> 赞同：3
> 
> 时间：2013-01-21T23:12:26.730
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, mongoid, factory-bot

我正在使用 FactoryGirl 和 RSpec 来测试我的代码。我的 ORM 中的 Mongoid。我遇到的问题是，为了创建嵌入文档，您还必须创建父文档。这是一个例子：

```
# app/models/recipe.rb
class Recipe
  include Mongoid::Document

  field :title

  embeds_many :ingredients
end

# app/models/ingredient.rb
class Ingredient
  include Mongoid::Document

  field :name

  embedded_in :recipe
end 
```

然后我为这两个制造工厂：

```
# spec/factories/recipes.rb
FactoryGirl.define do
  factory :recipe do |f|
    f.title "Grape Salad"
    f.association :ingredient
  end
end

# spec/factories/ingredients.rb
FactoryGirl.define do
  factory :ingredient do |f|
    f.name "Grapes"
  end
end 
```

我现在遇到的问题是我永远无法调用 FactoryGirl.create(:ingredient)。原因`Ingredient`是嵌入的，我的`Ingredient`工厂从不声明与配方的关联。如果我确实声明了与配方的关联，那么我会得到一个无限循环，因为配方与成分相关联，而成分与配方相关联。这很烦人，因为我无法正确地对我的成分类进行单元测试。我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T20:28:28.293

如果您的目标只是对嵌入的成分类进行单元测试，那么最好避免完全“创建”到数据库中，而只需实例化对象...

```
FactoryGirl.build(:ingredient) 
```

这样可以避免将对象实际持久化到 MongoDB 中。否则，从 Mongoid/MongoDB 的角度来看，嵌入文档不能在没有父级的情况下存在于数据库中，因此如果您必须将对象持久保存到数据库中，则必须通过父级来完成。

# clearcase - 基本 ClearCase 中配置规范的详细信息

> ID：14448882
> 
> 赞同：2
> 
> 时间：2013-01-21T23:12:27.400
> 
> 标签：clearcase

我的基本 ClearCase 配置规范如下所示：

```
element * CHECKEDOUT
element * .../Branch_F13R2/LATEST 
```

一切都很好，但我想知道`.../`路径开始时在做什么？在 UCM 中，我们可以在 Clear Case explorer 中看到流和 VOBS，但在基本 ClearCase 中，如何知道如果我想从 签出`Branch_F13R2`，我需要`.../`在一开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:29:47.003

那是因为你不知道父分支。

`.../`在选择规则中允许 ClearCase 从它来自的任何分支中选择该分支：`/main`或任何其他分支。
要了解有关称为**省略号通配符**的表示法的更多信息，请参阅“[查找在特定 ClearCase 分支中修改的所有文件？](https://stackoverflow.com/questions/13920442/find-all-files-modified-in-a-specific-clearcase-branch/13920707#13920707) ”。

我还建议添加规则

```
element * /main/LATEST 
```

并非每个父目录在您要查找的分支中都有一个版本，如果没有最后一条选择规则，它将没有任何选择，从而使任何子元素都无法访问。

# python - Github API 帖子未找到 404

> ID：14448885
> 
> 赞同：1
> 
> 时间：2013-01-21T23:12:46.570
> 
> 标签：python, github, urllib2, github-api

出于某种原因，当我尝试发布 githubs api 来创建存储库时，我不断收到 404 not found。这是我的代码，有其他人经历过吗？

```
url = "https://api.github.com/users/repo"

headers = {
    "Content-type" : "application/json",
    "Authorization" : "token %s" % self.config['token'],
}

request = urllib2.Request(url, json.dumps(data), headers)

try:
    response = urllib2.urlopen(request).read()
    # print response
except Exception, e:    
    print e 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:25:17.137

你的网址有误；它是`https://api.github.com/user/repos`（`user`单数、`repos`复数），请参阅[Repos 创建文档](http://developer.github.com/v3/repos/#create)。

# vb.net - 尝试获取带参数的异步函数并返回工作

> ID：14448887
> 
> 赞同：0
> 
> 时间：2013-01-21T23:13:09.313
> 
> 标签：vb.net, function, asynchronous, callback

我一直在尝试让一个函数与 GUI 窗口异步工作，但成功非常有限。

下面的代码是我的函数 XXX，带有一个委托和回调 - 允许停止 GUI 线程，而不会出现错误。

但它可以工作——如果它是一个 Sub，而不是一个函数，并且它没有任何参数。

我不知道如何更改它，以便检查它的返回值...我在一些示例中找到了一些帮助， http: [//msdn.microsoft.com/en-us/library/system.iasyncresult.asyncstate .aspx](http://msdn.microsoft.com/en-us/library/system.iasyncresult.asyncstate.aspx) - 但他们在回调中打印返回值，我看不到如何在调用者中获取它。

我找不到在我的函数中使用参数的任何方法。

```
Private Function XXX_Callback(ByVal ia As IAsyncResult) 
    Dim d As XXXDelegate = CType(CType(ia, Runtime.Remoting.Messaging.AsyncResult).AsyncDelegate, XXXDelegate)
    d.EndInvoke(ia)

    Dim result As AsyncResult = CType(ia, AsyncResult)
    Dim caller As XXXDelegate = CType(result.AsyncDelegate, XXXDelegate)
    Dim returnValue As Boolean = caller.EndInvoke(ia)

    XXX_Finish()   ' needs the "vvv argument, I don't know how to get it
    ' The returnValue is here but I don't know how to send it to the caller
End Function

'Private Function XXX_Finish(ByVal vvv as Boolean) As Boolean
' this probably needs to return something, I don't know what/ how to get it
Private Function XXX_Finish() As Boolean
    ' something 
    myGui.Finish()            
End Function

' Private Delegate Function XXXDelegate(ByVal vvv As Integer) As Boolean
' Public Function XXX(ByVal vvv As Integer) As Boolean    ' This is what I would like
Private Delegate Sub XXXDelegate()
Public Sub XXX() 
    '
    myGui.Update()
    '
End Sub

Public Sub Caller()
    '
    myGui = New SomeGui()
    myGui.Begin()
    Dim t As New XXXDelegate(AddressOf XXX)
    t.BeginInvoke(AddressOf XXX_Callback, Nothing)
    ' more code, another call
End Sub

Private myGui As SomeGui 
```

拜托，有人可以帮我把它变成一个更好的形状，或者得到一些有帮助的例子吗？用这两天找的那些，我已经走到了死胡同……

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T16:04:38.143

在网上搜索了很多帖子并阅读了几本书之后，我找到了最好的资源，并为每个人可能遇到的每个案例提供了示例：

[http://support.microsoft.com/kb/315582](http://support.microsoft.com/kb/315582)

这个特定问题的答案在上面的链接中，“示例 2：使用 EndInvoke() 调用模式异步调用方法”和“示例 5：在异步方法完成时执行回调”。

最好的一点是简单而有条理的方式，其中解释了使用 Invoke、EndInvoke、Callback 的选项。

需要注意的一点：对于我上面的问题，重要的突破是当我读到“ **BeginInvoke() 立即返回并且不等待异步调用完成时。** ”

所以......试图在它之后调用另一种方法是错误的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-11T21:07:26.973

这就是我进行异步函数调用的方式。

我在模块中声明了函数。

```
Private Delegate Function fnBolAsyncCallVerificacionNuevaVersion(ByVal pIntModo As Integer, ByVal pIntAccion As Integer) As Boolean
Private Delegate Function fnBolAsyncCallActualizacionTipoCambio(ByVal pIntActualizacionMandatoria As clsBusinessBoxData.tblTipoCambio.enumActualizacionMandatoria) As typBolResultadoFuncion 
```

这些函数接收一些参数，第一个返回一个布尔值，第二个返回一个包含 2 个数据、一个布尔值和一个字符串的结构。

在表单的加载事件中，我调用函数。

```
sAsyncVerificaVersion = New fnBolAsyncCallVerificacionNuevaVersion(AddressOf fnBolVerificaActualizacion)
sAsyncVerificaVersion.BeginInvoke(enumDisplayGUIMode.Silent, typApplicationUpdate.CheckOnly, New AsyncCallback(AddressOf fnBolTerminaVerificacionVersion), Nothing)

sAsyncActualizaTiposCambio = New fnBolAsyncCallActualizacionTipoCambio(AddressOf fnBolActualizaTiposCambioYahoo)
sAsyncActualizaTiposCambio.BeginInvoke(clsBusinessBoxData.tblTipoCambio.enumActualizacionMandatoria.No, New AsyncCallback(AddressOf fnBolTerminaActualizacionTipoCambio), Nothing) 
```

这些调用将异步执行函数，并在完成时回调定义的函数。

然后我在定义的回调函数中收到结果。

```
Private Function fnBolTerminaVerificacionVersion(ByVal pIarResultado As IAsyncResult) As Boolean

    Dim sClsResultado = CType(pIarResultado, Messaging.AsyncResult)
    Dim sIarResultado As fnBolAsyncCallVerificacionNuevaVersion = CType(sClsResultado.AsyncDelegate, fnBolAsyncCallVerificacionNuevaVersion)

    Dim sBolExisteNuevaVersion As Boolean = False

    CheckForIllegalCrossThreadCalls = False

    sBolExisteNuevaVersion = sIarResultado.EndInvoke(pIarResultado)

    mnuBajarActualizacion.Enabled = sBolExisteNuevaVersion

    CheckForIllegalCrossThreadCalls = True

    Return True

End Function

Private Function fnBolTerminaActualizacionTipoCambio(ByVal pIarResultado As IAsyncResult) As Boolean

    Dim sBolActualizacionExitosa As typBolResultadoFuncion

    Dim sClsResultado = CType(pIarResultado, Messaging.AsyncResult)
    Dim sIarResultado As fnBolAsyncCallActualizacionTipoCambio = CType(sClsResultado.AsyncDelegate, fnBolAsyncCallActualizacionTipoCambio)

    CheckForIllegalCrossThreadCalls = False

    sBolActualizacionExitosa = sIarResultado.EndInvoke(pIarResultado)

    CheckForIllegalCrossThreadCalls = True

    Return True

End Function 
```

我希望他们有所帮助。

# c# - 从动态类型中获取有用的调试信息

> ID：14448888
> 
> 赞同：4
> 
> 时间：2013-01-21T23:13:09.700
> 
> 标签：c#, debugging, dynamic

我正在开发一个大量使用`dynamic`类型的代码库，并且越来越难以准确地找出正在创建和传递的内容。即使在调试和检查感兴趣的类型时，只要我检查动态视图，我就会收到“无法发现有关此对象的更多信息”的消息，这没有帮助。有什么有用的技巧可以帮助我更多地了解隐藏在`dynamic`黑魔法背后的一些类型和属性吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-11-28T11:01:13.643

我的自定义动态类继承自`DynamicObject`. 解决方案是覆盖`public override IEnumerable<string> GetDynamicMemberNames()`以返回成员列表。就我而言，所有成员都包含在字典中，所以我做了以下操作：

```
 public override IEnumerable<string> GetDynamicMemberNames()
    {
        return properties.Keys;
    } 
```

# javascript - filepicker.io 印象笔记

> ID：14448889
> 
> 赞同：1
> 
> 时间：2013-01-21T23:13:12.170
> 
> 标签：javascript, filepicker.io

我正在使用 filepicker.io 来获取一个印象笔记 - 问题是如果印象笔记包含多个对象，它似乎无法处理。

例如，一个笔记可能包含文本、图像和音频。这是一个真正的限制还是我忽略了什么？

# vba - 返回 Excel 工作表中下一个空闲行的位置

> ID：14448891
> 
> 赞同：0
> 
> 时间：2013-01-21T23:13:20.700
> 
> 标签：vba, excel

我在工作表（条目）上有一个表格，当有人填写并单击提交时，他们将值存储到同一工作簿中的另一张工作表（Tally）。问题是我需要它来收集所有提交的表单并将它们按顺序放在 Tally 表上，而不会覆盖以前的值。目前我有：

```
r = Range("B5:E5")
Sheets("Tally").Range("B5:E5") = r 
```

但这显然会在每次单击提交按钮时覆盖 Tally 上的值。就像是：

```
r = Range("B5:E5")
x = next free row on Tally
Sheets("Tally").Range("Bx:Ex") = r 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:43:04.220

```
r = worksheets("entry").range("b5:e5")
nextFreeRow = worksheets("tally").Cells(Rows.Count,"B").end(xlup).row + 1
worksheets("tally").range("b" & nextFreeRow, "c" & nextFreeRow) = r 
```

应该可以，但我现在无法测试。抱歉格式错误，从 ipad 写入

# java - 这里应该适合什么java数据结构

> ID：14448900
> 
> 赞同：1
> 
> 时间：2013-01-21T23:13:42.087
> 
> 标签：java

我对java非常陌生（但不是编程）。我必须设计一个数据结构，如下所示。这些列（动态和）由 id 标识（例如 77、55、67 等）。对于每一列，我可以在行中有动态条目，但条目“必须”遵循插入顺序。意味着当我们检索时，它们应该以相同的插入顺序输出。在 N 个条目之后，我想删除最旧的条目，以控制列表大小。

我的问题：我应该使用什么数据结构（例如 HashMap、ArrayList、Set 等）来解决我在 java 中的问题。

![数据](../Images/e0b8266b3d9e07488c2091a8e3bbfa52.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:32:28.507

它看起来像一个行的映射，一行看起来像一个 Map... 意思是：

```
Map<Integer, LinkedHashMap<Integer, Double>> collection = new HashMap<Integer, LinkedHashMap<Integer, Double>>(); 
```

LinkedHashMap 会保留有序元素（LinkedHashMap 是有序的，TreeMap 是有序的，HashMap 是无的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T23:15:30.577

看起来你正在寻找一个[队列](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Queue.html)

# ruby-on-rails - bundle install 工作，但 bundle-show 给出错误“rails.git 尚未签出。请运行`bundle install`”

> ID：14448902
> 
> 赞同：1
> 
> 时间：2013-01-21T23:13:43.997
> 
> 标签：ruby-on-rails, github, gem, bundler

我最近更新了我们的 Gemfile 以在我们的 github 帐户上使用分叉的复制 rails。我们从 2.3-stable 分支（我称之为`the_bugfix_branch`）创建了一个自定义分支，并为每个 gem 添加了 gemspecs 以使它们可以被 bundler 找到。

我的 Gemfile 有以下内容：

```
git 'git://github.com/ourgithub/rails.git', :branch => "the_bugfix_branch"  do
  # Note: load-order is essential for dependencies
  gem 'activesupport', '2.3.2' # this must go first
  gem 'actionpack',    '2.3.2' # this must go second
  gem 'actionmailer',  '2.3.2' 
  gem 'activerecord',  '2.3.2' 
  gem 'activeresource','2.3.2' 
  gem 'rails',         '2.3.2' # this must go last
end 
```

`bundle install`快乐地运行给我（在所有其余的 gem 输出中）：

```
Using actionpack (2.3.2) from git://github.com/ourgithub/rails.git (at the_bugfix_branch) 
Using actionmailer (2.3.2) from git://github.com/ourgithub/rails.git (at the_bugfix_branch) 
Using activesupport (2.3.2) from git://github.com/ourgithub/rails.git (at the_bugfix_branch) 
Using activerecord (2.3.2) from git://github.com/ourgithub/rails.git (at the_bugfix_branch) 
Using activeresource (2.3.2) from git://github.com/ourgithub/rails.git (at the_bugfix_branch) 
...
Using rails (2.3.2) from git://github.com/ourgithub/rails.git (at the_bugfix_branch)
...
Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed. 
```

然后我签入并提交 Gemfile.lock ，其中包含：

```
GIT
  remote: git://github.com/ourgithub/rails.git
  revision: 3fc562f9b1def3ad9a7abbfd5ccfa713a6dbc39f
  branch: the_bugfix_branch
  specs:
    actionmailer (2.3.2)
      actionpack (= 2.3.2)
    actionpack (2.3.2)
      actionpack (= 2.3.2)
    activerecord (2.3.2)
      activesupport (= 2.3.2)
    activeresource (2.3.2)
      activesupport (= 2.3.2)
    activesupport (2.3.2)
    rails (2.3.2)
      actionmailer (= 2.3.2)
      actionpack (= 2.3.2)
      activerecord (= 2.3.2)
      activeresource (= 2.3.2)
      activesupport (= 2.3.2)
      rake (>= 0.8.3) 
```

但是，如果我尝试启动服务器，它会告诉我：

```
The git source git://github.com/ourgithub/rails.git is not yet checked out. Please run `bundle install` before trying to start your application 
```

`bundle show rails`如果我尝试或，我也会收到完全相同的消息`bundle check`：

```
> bundle show rails
The git source git://github.com/ourgithub/rails.git is not yet checked out. Please run `bundle install` before trying to start your application
> bundle check
git://github.com/ourgithub/rails.git (at the_bugfix_branch) is not checked out. Please run `bundle install` 
```

如果我尝试`bundle install --deployment`（只是为了踢球）它会给出：

```
> bundle install --deployment
You are trying to install in deployment mode after changing
your Gemfile. Run `bundle install` elsewhere and add the
updated Gemfile.lock to version control.

You have added to the Gemfile:
* source: git://github.com/ourgithub/rails.git (at the_bugfix_branch)

You have deleted from the Gemfile:
* source: git://github.com/ourgithub/rails.git (at the_bugfix_branch)

You have changed in the Gemfile:
* activeresource from `git://github.com/ourgithub/rails.git (at the_bugfix_branch)` to `no specified source`
* activerecord from `git://github.com/ourgithub/rails.git (at the_bugfix_branch)` to `no specified source`
* actionmailer from `git://github.com/ourgithub/rails.git (at the_bugfix_branch)` to `no specified source`
* actionpack from `git://github.com/ourgithub/rails.git (at the_bugfix_branch)` to `no specified source`
* activesupport from `git://github.com/ourgithub/rails.git (at the_bugfix_branch)` to `no specified source`
* rails from `git://github.com/ourgithub/rails.git (at the_bugfix_branch)` to `no specified source` 
```

我显然*不*只是更改了我的 Gemfile，而且自从我将这些东西添加到 Gemfile 以来，我肯定*已经运行了 bundle install。*

我已经用谷歌搜索了*“尚未签出。请`bundle install`在尝试启动您的应用程序之前运行”* ，而我能找到的所有*“`bundle install`无法正常工作”*的问题似乎都在说*“只需运行`bundle install`然后签入您的副本`Gemfile.lock`”* ......我已经清楚地做到了。它们也往往是关于捆绑安装在生产中失败的问题，但我的在开发中也以这种方式失败。

我不认为这是一个**简单**的Gemfile/Gemfile.lock 不匹配问题！

一些谷歌结果告诉我尝试删除 .bundle/config 并再次运行它。我已经尝试过同样的（缺乏）效果。

具体来说，在重新运行捆绑安装之前，我浏览`rm -rf`了本故障排除指南的所有内容：[https ://github.com/carlhuda/bundler/blob/master/ISSUES.md。](https://github.com/carlhuda/bundler/blob/master/ISSUES.md)

错误消息没有变化。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T01:29:05.057

*Taryn East said:*

> I don't think this is a **simple** Gemfile/Gemfile.lock mismatch problem!

Turns out I was wrong.

The solution was to remove the version-numbers in the Gemfile, and explicitly use the branch instead:

```
git 'git://github.com/ourgithub/rails.git', :branch => "the_bugfix_branch"  do
  # Note: load-order is essential for dependencies
  gem 'activesupport', :branch => "the_bugfix_branch" # this must go first
  gem 'actionpack',    :branch => "the_bugfix_branch" # this must go second
  gem 'actionmailer',  :branch => "the_bugfix_branch" 
  gem 'activerecord',  :branch => "the_bugfix_branch" 
  gem 'activeresource',:branch => "the_bugfix_branch" 
  gem 'rails',         :branch => "the_bugfix_branch" # this must go last
end 
```

bundler was getting confused with the version-number on one hand, and the branch on the other.

Explicitly setting the branch for every gem listed, seemed to finally do the trick!

# javascript - Easeljs HitTest 和 hitRadius

> ID：14448909
> 
> 赞同：1
> 
> 时间：2013-01-21T23:14:04.077
> 
> 标签：javascript, easeljs, createjs

这是我的代码：

```
var spriteSheet = new createjs.SpriteSheet({
    images: ["images/mario2.png"],
    frames: {width:24, height:33, regX: 0, regY: 0},
    animations: {
        walk_right:     [5, 9],
        walk_up:        [10, 14],
        walk_down:      [15, 19],
        walk_left:      [0, 4]
    }
});

Player = new createjs.BitmapAnimation(spriteSheet);
Player.name = "Mario";
Player.gotoAndStop("walk_right");
Player.speed = 6;
Player.x = 30;
Player.y = 330;
//Player object toevoegen aan de stage
stage.addChild(Player);

    var monsterspritesheet = new createjs.SpriteSheet({
        images: ["images/MonsterA.png"], //image to use
        frames: {width: 64, height: 54, regX: 0, regY: 0},
        animations: {
            walk: [0, 9, "walk", 4],
            idle: [10, 20, "idle", 4]
        }
    });

Monster1 = new createjs.BitmapAnimation(monsterspritesheet);
Monster1.name = "Monster";
Monster1.gotoAndStop("walk");
Monster1.speed = 6;
Monster1.x = 180;
Monster1.y = 330;
stage.addChild(Monster1);
stage.update(); 
```

对于 hitTest 我使用以下代码：

```
 var testpos = Player.globalToLocal(Monster1.x ,Monster1.y);

if (Player.hitTest(testpos.x, testpos.y) === true)
{
console.log("HIT");
} 
```

问题：当我的玩家在我的怪物下方时，我会收到“HIT”消息，但我想让它在我的玩家击中怪物而不是在它下方时工作。我一直在玩 Player 和 Monster 的 regX 和 regY，但它似乎不起作用。有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-21T23:33:50.770

我认为您的问题是您需要 CollisionDetection 但 hitTest() 只会检查一个像素，这在大多数情况下用于鼠标交互检测并且非常适合它。然而，使用它来检测两个位图之间的冲突可能需要比仅仅测试一个像素多一点的工作。我建议您将我的 CollisionDetection 类用于位图和 bitmapAnimations，它适用于边界框或像素完美，您基本上只需要更改一行。你可以在[Github 上查看：EaselJS 的位图碰撞检测](https://github.com/olsn/Collision-Detection-for-EaselJS) 描述在 github.com 页面上。（以防万一你会使用它：如果你遇到任何错误，请告诉我）

# c# - 类内的 C# 静态事件 null

> ID：14448910
> 
> 赞同：0
> 
> 时间：2013-01-21T23:14:09.373
> 
> 标签：c#, windows-phone-7, events

我在我想从其他类订阅的类中创建了一个静态事件。

```
public class PlaylistModel 
{
    public static event EventHandler PlaylistLoadError;
    public static void LoadPlaylist() 
    {
        try 
        {    
           // ...do some stuff...
        } 
        catch(SomeException ex) 
        {
            EventHandler handler = PlaylistLoadError;

            if(handler != null) 
            {
                PlaylistLoadError(null, null);
            }
        }
    }
} 
```

在我的另一堂课上......

```
public partial class MainPage : PhoneApplicationPage 
{
    public MainPage() 
    {
        PlaylistModel.PlaylistLoadError += PlaylistError;
    }

    public void PlaylistError(object sender, EventArgs args) 
    {
        //... show the error ...
    }
} 
```

在 catch 内部，handler 为 null，尽管它已被订阅。我`MainPage`在 catch 执行后从内部调试了程序，并且`PlaylistLoadError`显示为不为空。任何想法为什么它会在内部为空`PlaylistModel`，但在其他任何地方都没有？我有一种感觉，这与它是静态的有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:26:51.743

如果没有人订阅，则字段的值`event`可以为 null。从您的评论来看，您的 PlaylistModel 类中的异常似乎是在构造类**之前**引发的`MainPage`，此时尚未有人订阅该事件。

另请注意，这是内存泄漏的秘诀。当您的`MainPage`类（或任何其他类）订阅该事件时，`Playlist`该类持有对它的引用，并且`Playlist`该类中的事件是静态的。因此，所有订阅该事件的成员都将在您的应用程序的整个生命周期中存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T00:39:23.790

事件委托的值在您将其分配给变量时被复制，但在您引发它时可能为空：

```
EventHandler handler = PlaylistLoadError;

if(handler != null) { // not null
    PlaylistLoadError(null, null); // null
} 
```

您可以通过执行局部变量而不是从事件中重新获取委托来避免错误：

```
EventHandler handler = PlaylistLoadError;

if(handler != null) {
    handler(this, EventArgs.Empty);
} 
```

`this`并且`EventArgs.Empty`也是更好的默认值`null`

# c++ - 使用 sf::Text 和 sf::Font 时未解析的外部符号

> ID：14448915
> 
> 赞同：0
> 
> 时间：2013-01-21T23:14:36.587
> 
> 标签：c++, text, sfml

我正在使用 sfml 2.0 创建一个文本类，当我尝试构建时遇到链接器错误。这是错误：

```
Error   1   error LNK2019: unresolved external symbol "__declspec(dllimport) public: static class sf::Font const & __cdecl sf::Font::getDefaultFont(void)" (__imp_?getDefaultFont@Font@sf@@SAAEBV12@XZ) referenced in function "public: void __cdecl Text::create(class sf::RenderWindow &,char *,char *,float,float,unsigned int,enum style,int,int,int)" (?create@Text@@QEAAXAEAVRenderWindow@sf@@PEAD1MMIW4style@@HHH@Z) C:\Facepunch Pacman Project\Faceman\Text.obj    Faceman 
```

这是text.h：

```
#ifndef TE_TEXT
#define TE_TEXT

#include <SFML/Window.hpp>
#include <SFML/Graphics.hpp>

enum style { bold, italic, underlined };

class Text {

    public: 
        void create(sf::RenderWindow &window,
                    char* string, 
                    char* fontpath, 
                    float positionx, 
                    float positiony,
                    unsigned int size,
                    style textstyle,
                    int red, 
                    int green, 
                    int blue);

        void setString();
        void setFont();
        void setPosition();
        void setSize();
        void setColor(int red, int green, int blue);

        Text operator==(Text t);
        Text operator!=(Text t);

        sf::Rect<int> textrect;

        void setRect();

    private:
        char* getString();
        char* getFont();
        float getPosition();    
        unsigned int getSize();
        sf::Vector3i getColor();

        sf::IntRect getRect();
};

#endif 
```

文本.cpp（未完成）：

```
#include <Source/Text/Text.h>

void Text::create(sf::RenderWindow &window, char* string, char* fontpath, float positionx, float positiony, unsigned int size, 
                    style textstyle, int red, int green, int blue) {

    sf::Font font;
    font.loadFromFile(fontpath);

    sf::Text text(string);
    text.setFont(font);

    text.setCharacterSize(size);

    text.setPosition(positionx, positiony);

    sf::Color color(red, green, blue);
    text.setColor(color);

    switch (textstyle)
    {
        case bold:
        {
            text.setStyle(sf::Text::Bold);
            break;
        }

        case italic:
        {
            text.setStyle(sf::Text::Italic);
            break;
        }

        case underlined:
        {
            text.setStyle(sf::Text::Underlined);
            break;
        }
    }

    window.draw(text);
} 
```

显示主菜单功能（这不是新的，我之前一直在使用它，没有任何问题）

```
Menu::MenuResult Menu::showMMenu(sf::RenderWindow &window) {

    sf::Texture texture;
    texture.loadFromFile("Source/Images/MenuBG.png");

    sf::Sprite MMenuSprite;
    MMenuSprite.setTexture(texture);

    Text playText;

    MenuItem playButton;
    playButton.buttonrect.top = 283;
    playButton.buttonrect.height = 130;
    playButton.buttonrect.left = 0;
    playButton.buttonrect.width = WINDOW_WIDTH;
    playButton.action = Play;

    MenuItem optionsButton;
    optionsButton.buttonrect.top = 414;
    optionsButton.buttonrect.height = 130;
    optionsButton.buttonrect.left = 0;
    optionsButton.buttonrect.width = WINDOW_WIDTH;
    optionsButton.action = Options;

    MenuItem exitButton;
    exitButton.buttonrect.top = 549;
    exitButton.buttonrect.height = 130;
    exitButton.buttonrect.left = 0;
    exitButton.buttonrect.width = WINDOW_WIDTH;
    exitButton.action = Exit;

    menuItems.push_back(playButton);
    menuItems.push_back(optionsButton);
    menuItems.push_back(exitButton);

    window.draw(MMenuSprite);
    playText.create(window, "start", "Source/Text/Fonts/BOOKOS.ttf", 514, 352, 65, bold, 0, 0, 0);
    window.display();

    return getMenuResponse(window);
} 
```

我可能没有正确获取字体文件路径，因为 getDefaultFont 是在未指定字体时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:48:27.143

您的头文件似乎与您的二进制文件不同步。该功能在 6 个月前被删除。

[https://github.com/LaurentGomila/SFML/commit/a0c1f5f50f5e7ab52bd4b11296ffea1735b3b595](https://github.com/LaurentGomila/SFML/commit/a0c1f5f50f5e7ab52bd4b11296ffea1735b3b595)

# c# - 发送带有附件的电子邮件

> ID：14448917
> 
> 赞同：1
> 
> 时间：2013-01-21T23:14:49.070
> 
> 标签：c#, email, xaml, windows-runtime, attachment

我的问题很简单。我需要发送带有我在 C# 中生成的收件人和附件的电子邮件。

# 1方法：

```
var mailto = new Uri("mailto:?to=" + emails + "&subject=" + subject + "&body=" + body);
        await Windows.System.Launcher.LaunchUriAsync(mailto); 
```

没关系，但我无法添加附件（仅限收件人）

# 2方法：

使用`DataTransferManager`. 这很酷，但我无法添加收件人。

有什么方法可以解决我的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T05:51:40.420

您无法避免已经尝试过的两种方法的局限性：

*   `mailto:`协议不允许添加附件。您还取决于用户为处理此协议而配置的应用程序。它可能根本不起作用。
*   您不能设置共享的收件人。此外，您无法确定用户将选择哪个应用程序作为共享目标。他可能会在社交网络上发布内容或以其他方式使用它。

我认为安东尼奥已经建议使用网络服务来完成这项工作是从 Windows 应用商店应用程序以非交互方式发送电子邮件的最佳方式。

还有一个[第三方 SMTP 组件](http://www.limilabs.com/mail-for-windows-store)可用于发送电子邮件。这种方法的缺点是您需要用户配置 SMTP 设置才能使其工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:46:59.487

没有（简单的）方法可以从 Modern UI 应用程序发送电子邮件，您唯一能做的就是共享要发送的内容，然后用户将选择他或她是否不会使用邮件客户端并在邮件客户端中选择收件人。

出于某种原因，Microsoft 没有将其包含在 WinRT API 中，IMO 肯定需要它，例如现代 UI 中的替代电子邮件客户端。

更难的方法是实现 smtp 客户端，或者更容易构建某种将发送邮件的 Web 服务，或者使用现有的服务，如[mandrill.com](http://mandrill.com/)

# ios - 错误：更改核心数据模型后架构 armv7 的重复符号

> ID：14448920
> 
> 赞同：5
> 
> 时间：2013-01-21T23:14:51.307
> 
> 标签：ios, core-data, linker-errors

我有一个使用核心数据框架的应用程序。我工作得很好。我刚刚更改了数据模型 - 将属性添加到一个实体。当我尝试构建它时，出现错误：

```
duplicate symbol _OBJC_METACLASS_$_AccountFolder in:
/Users/XXX/Library/Developer/Xcode/DerivedData/MyApp-bxsswgxdenxgjweotkkkckaoalat/Build/Intermediates/MyApp.build/Debug-iphoneos/MyApp.build/Objects-normal/armv7/AccountFolder-33D7EA63E98D6090.o

ld: 4 duplicate symbols for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

我做了一些搜索，大多数人得到这个错误是因为将 .h 错误输入为 .m，或者多次导入相同的 .h。我检查了我的代码。我没有那个。coredata 框架还在。

有谁知道还有什么原因？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-21T23:29:23.993

`NSManagedObject`检查进行此更改后是否生成了多个子类文件。属性更改后应该会生成重复文件。签入查找器窗口以及项目，然后删除重复的文件。那应该可以解决这个问题。

# android - 挑选后如何关闭联系人列表（android）

> ID：14448922
> 
> 赞同：0
> 
> 时间：2013-01-21T23:15:17.923
> 
> 标签：android, android-contacts, forceclose

* ***我试图做n sms应用程序并且我使用这个代码从联系人中挑选一些数据我的问题是当我关闭我的应用程序时联系人列表仍然打开..我怎样才能关闭它？**

**有什么方法可以选择数据并强制关闭联系人列表活动？**

**

```
import java.util.ArrayList;
import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.provider.ContactsContract;
import android.util.Log;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity implements OnTouchListener{
    TextView a1,a2;
    EditText contact,message;
    Button send;
    String name,phoneNumber;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        initilaize();
    }
    public void initilaize(){
        a1 = (TextView)findViewById(R.id.tVContact);
        a2 = (TextView)findViewById(R.id.tVMessage);
        contact = (EditText)findViewById(R.id.eTContact);
        message = (EditText)findViewById(R.id.eTMessage);
        send = (Button)findViewById(R.id.button1);
        name ="";
        phoneNumber="";

        contact.setOnTouchListener(this);
    }

    public void onActivityResult(int reqCode, int resultCode, Intent data) {
        super.onActivityResult(reqCode, resultCode, data);
            if (resultCode == Activity.RESULT_OK) {
                if (data != null) {
                    Uri contactData = data.getData();
                    try {
                        String id = contactData.getLastPathSegment();
                        Cursor phoneCur = getContentResolver()
                                .query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
                                        null,
                                        ContactsContract.CommonDataKinds.Phone.CONTACT_ID
                                                + " = ?", new String[] { id },
                                        null);

                        final ArrayList<String> phonesList = new ArrayList<String>();
                        while (phoneCur.moveToNext()) {
                            // This would allow you get several phone addresses
                            // if the phone addresses were stored in an array
                            String phone = phoneCur
                                    .getString(phoneCur
                                            .getColumnIndex(ContactsContract.CommonDataKinds.Phone.DATA));
                            phonesList.add(phone);
                        }
                        phoneCur.close();
                        //
                        String name="";
                        Cursor c =  managedQuery(contactData, null, null, null, null);  
                        if (c.moveToFirst()) {  
                            name = c.getString(c.getColumnIndexOrThrow(ContactsContract.Contacts.DISPLAY_NAME));
                        }
                        c.close();

                            //

                        if (phonesList.size() == 0) {

                        } else{
                           phoneNumber = phonesList.get(0);
                           this.name = name;
                           contact.setText(name);
                        }          } catch (Exception e) {
                        Log.e("FILES", "Failed to get phone data", e);

                     }
                }   

            }

    }
    public boolean onTouch1(View v, MotionEvent arg1) {
        switch(v.getId()){
        case R.id.eTContact:{
            Intent intent = new Intent(Intent.ACTION_PICK);
            intent.setType(ContactsContract.Contacts.CONTENT_TYPE);
            startActivityForResult(intent,0);
            break;
        }
        case R.id.button1:{

        }
        }   
        return true;
    }
    public boolean onTouch(View arg0, MotionEvent arg1) {
        // TODO Auto-generated method stub
        return false;
    }

} 
```

# python - 从网站提取的下拉列表中提取选项

> ID：14448925
> 
> 赞同：-1
> 
> 时间：2013-01-21T23:15:31.360
> 
> 标签：python, parsing, html-parsing, beautifulsoup

我已经尝试（未成功）解决这个问题几个小时，需要一些帮助。我使用 Firebug 提取了几百行如下所示的 HTML：

```
<option value="1b4f4aed-cf1f-4b39-ae27">Foo</option>
<option value="1a05f93f-dd51-449d-b039">Bar</option>
<option value="f62d2d29-29fc-4f7c-9331">Bacon</option> 
```

我将这些行保存到一个文本文件中。我想要的是一个（首选 Python，使用 Ruby 作为替代）脚本来打开进程并关闭文件。该处理应导致保存一个新的文本文件，如下所示：

```
Foo
Bar
Bacon 
```

而已。在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:36:42.540

根据您上面的评论，我建议 BeautifulSoup 与任何与 HTML 相关的内容。由于您处于学习阶段的早期，可能最好将“HTML”与“BeautifulSoup”（而不是[正则表达式](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags):)）联系起来。这是一个非常基本的例子：

```
In [1]: from bs4 import BeautifulSoup

In [2]: html = """
<option value="1b4f4aed-cf1f-4b39-ae27">Foo</option>
<option value="1a05f93f-dd51-449d-b039">Bar</option>
<option value="f62d2d29-29fc-4f7c-9331">Bacon</option>
"""

In [3]: soup = BeautifulSoup(html)

In [4]: for option in soup.find_all('option'):
   ...:     print option.text
   ...:     
Foo
Bar
Bacon 
```

在这里，我们将 HTML 传递给`BeautifulSoup`并将其分配给`soup`变量。现在我们有一个对象，其中包含我们的 HTML 和大量以用户友好的方式与之交互的方法。在这里，我们使用`find_all`方法（[此处](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#find-all)的文档）来查找`option`HTML 中的所有标签。现在，当我们迭代时，我们正在迭代`Tag`对象，这些对象具有自己的特殊属性/方法。在这里，我们选择其中一个 ( `.text`) 来显示`Tag`元素的文本（在这种情况下，将是包含在标签中的文本）。

# php - php DOMDocument 获取属性

> ID：14448926
> 
> 赞同：0
> 
> 时间：2013-01-21T23:15:38.040
> 
> 标签：php, rss, domdocument

我正在使用 php`DOMDocument`来解析 RSS 2.0 提要。除了这条线，一切都很好。

```
$image = $node->getElementsByTagName('itunes:image')->item(0)->getAttribute('href'); 
```

元素`$node`在哪里。`<item>`

`$image`函数后为空。

**编辑：**

以下也返回空...

```
$node->getElementsByTagName('itunes:summary')->item(0)->nodeValue 
```

那么这与`:`节点名称中的有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:23:25.957

了解[名称空间](http://zvon.org/comp/r/tut-Namespace.html)并使用[`getElementsByTagNameNS`](http://php.net/manual/en/domelement.getelementsbytagnamens.php).

```
$node->getElementsByTagNameNS('http://www.itunes.com/dtds/podcast-1.0.dtd', 'summary'); 
```

# sql - 删除重复项 - 仅除最近日期的行之外的所有行

> ID：14448929
> 
> 赞同：4
> 
> 时间：2013-01-21T23:15:56.337
> 
> 标签：sql, sql-server, tsql, azure-sql-database

> **可能重复：**
> [如何在 SQL 中查找重复条目并删除最旧的条目？](https://stackoverflow.com/questions/679855/how-can-i-find-duplicate-entries-and-delete-the-oldest-ones-in-sql)

由于更新工具错误，我有一个数据库有几千个重复项。我能够识别具有重复项的项目集合，但只需要删除最旧的条目，不一定是最低的 id。测试数据如下所示，正确的行有 *

除最近创建的行外，应删除具有重复标题且没有重复规则 ID 的文章。（实际的 id 列是一个 GUID，所以我不能假设自动递增）

```
Id           Article id          Rule Id         Title          Opened Date
--           ----------          -------         -----          -----------
1*           111                 5               T1             2013-01-20
2            112                 5               T1             2013-07-01
3*           113                 6               T2             2013-07-01
4*           114                 7               T2             2013-07-02
5            115                 8               T3             2012-07-01
6            116                 8               T3             2013-01-20
7*           117                 8               T3             2013-01-21 
```

表架构：

```
CREATE TABLE [dbo].[test_ai](
    [id] [int] NOT NULL,
    [ArticleId] [varchar](50) NOT NULL,
    [ruleid] [varchar](50) NULL,
    [Title] [nvarchar](max) NULL,
    [AuditData_WhenCreated] [datetime] NULL,
PRIMARY KEY CLUSTERED 
(
    [id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON)
) 
```

**测试数据插入**

```
insert into test_ai (id, articleid, ruleid, title, auditdata_whencreated) values (1, 111, 5, 'test 1', '2013-01-20')
insert into test_ai (id, articleid, ruleid, title, auditdata_whencreated) values (2, 112, 5, 'test 1', '2012-07-01')
insert into test_ai (id, articleid, ruleid, title, auditdata_whencreated) values (3, 113, 6, 'test 2', '2012-07-01')
insert into test_ai (id, articleid, ruleid, title, auditdata_whencreated) values (4, 114, 7, 'test 2', '2012-07-02')
insert into test_ai (id, articleid, ruleid, title, auditdata_whencreated) values (5, 115, 8, 'test 3', '2012-07-01')
insert into test_ai (id, articleid, ruleid, title, auditdata_whencreated) values (6, 116, 8, 'test 3', '2013-01-20')
insert into test_ai (id, articleid, ruleid, title, auditdata_whencreated) values (7, 117, 8, 'test 3', '2013-01-21') 
```

**我当前的查询看起来像这样**

```
select * from test_ai
where test_ai.id in

-- set 1 - all rows with duplicates
(select f.id 
from test_ai as F 
WHERE exists (select ruleid, title, count(id)   
FROM test_ai
    WHERE test_ai.title = F.title
        AND test_ai.ruleid = F.ruleid
    GROUP BY test_ai.title, test_ai.ruleid
    having count(test_ai.id) > 1))
    and test_ai.id not in

-- set 2 - includes one row from each set of duplicates
(select min(id)
from test_ai as F
WHERE EXISTS (select ruleid, title, count(id)
from test_ai
WHERE test_ai.title = F.title 
    AND test_ai.ruleid = F.ruleid
group by test_ai.title, test_ai.ruleid
HAVING count(test_ai.id) > 1)   
GROUP BY title, ruleid
) 
```

此 SQL 标识了一些应删除的行（第 2、6、7 行），但它确实选择了“打开日期”最旧的文章。（应该删除第 2、5、6 行）我意识到我没有在语句中指定这一点，但正在努力解决如何添加最后一块。如果它导致我需要在多个重复项时多次运行以删除重复项的脚本，那不是问题。

实际问题要复杂得多，但如果我能克服这一障碍，我将能够再次前进。谢谢参观！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T23:23:29.047

在 SQL Server 2005+ 中从集合（或集合中的每个组）中删除一行的典型模型是：

```
;WITH cte AS 
(
  SELECT col, rn = ROW_NUMBER() OVER 
    (PARTITION BY something ORDER BY something)
  FROM dbo.base_table
  WHERE ...
)
DELETE x WHERE rn = 1; 
```

在您的情况下，这将是：

```
;WITH cte AS 
(
  SELECT id, ruleid, Title, rn = ROW_NUMBER() OVER 
  (
     PARTITION BY ruleid, Title  
     ORDER BY auditdata_whencreated DESC
  )
  FROM dbo.test_ai
)
DELETE cte 
  OUTPUT deleted.id
  WHERE rn > 1; 
```

结果：

```
id
----
2
6
5 
```

# facebook - 如何通过 javascript sdk 将提要发布到其他用户墙

> ID：14448932
> 
> 赞同：0
> 
> 时间：2013-01-21T23:16:32.323
> 
> 标签：facebook, facebook-javascript-sdk, feed

我已成功将提要发布到我的墙上，但没有发布到另一个用户墙上我已经定义了“来自”和“到”变量

但是我在发布提要时收到错误消息，上面写着“发生错误。请稍后再试。”

这是我发布时的代码

```
var obj = {
    method: 'feed',
    link: 'http://apps.facebook.com/' + fb_app_id,
    picture: app_url + 'icon/test.png',
    from: facebookid1,
    to: facebookid2,
    name: 'Test App',
    caption: 'This is a test!!',
    description: 'Test to publish feed to other user wall'
};

function callback(response) {
    // Callback after feed posted...
}
FB.ui(obj, callback); 
```

我不知道出了什么问题，或者他们是否需要任何扩展许可？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T06:53:36.620

试试这个代码

```
FB.ui(    {
  method: 'feed',
  name: name,
  link: link,//Link is any link you want to post
  picture: picture,
  caption: caption,
  description: redemption,
  message: message,
  to: page_id,
  from: page_id    
 },    
function (response) {
    if (response && response.post_id) {
      alert(response.post_id);
    } else {

    }    
   }  
); 
```

此外，如果用户设置了隐私，任何时候都不能在他们的墙上发布任何内容，在这种情况下您将无法发布

# operating-system - 为 arm 架构编写操作系统

> ID：14448940
> 
> 赞同：3
> 
> 时间：2013-01-21T23:17:07.033
> 
> 标签：operating-system, arm

如何开始编写在 arm 架构上运行的操作系统？如果可能的话，我想编写一个引导加载程序和我自己的内核。谁能帮我开始？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-21T23:23:33.410

我首先要熟悉一下已经存在的东西——Linux 是一个好的开始。查看 rPi 上的发行版中使用的引导加载程序 - 例如 Debian Squeeze 中使用的[uBoot](http://www.denx.de/wiki/U-Boot)和[BareBox](http://barebox.org/)。另一个选择是 CFE——它在 BSD 许可下并且在调试/早期开发期间很好。

另一件事是查看 ucLinux 和 ucLibC 系统，以及 buildroot 和 OpenWRT——所有这些都旨在将其压缩到一个小型系统中。

当然 - 构建自己的内核 - 你会想要更深入 - 并花时间了解 MMU、进程管理/多任务、中断等。良好的微控制器编程背景、汇编语言和 CPU/SOC 架构知识将是必不可少的。对于 ARM 系列，您会想知道支持的各种指令集，以及哪些芯片具有 MMU、FPU 等功能。

祝你好运——这听起来像是一个有趣的项目。

# php - 将多个复选框值插入单个 SQL 数据库列

> ID：14448942
> 
> 赞同：1
> 
> 时间：2013-01-21T23:17:14.773
> 
> 标签：php, sql, insert, checkbox, multipleselection

我正在寻找一种将多个复选框选择插入单个数据库列的简单解决方案。用户选择框 1、4 和 6 - 因此数据库将反映“1、4、6”.. 逗号会很好但不是必需的。如果选中一个复选框，则信息将按应有的方式插入。如果选择了多个，则只有最后一个将插入数据库。其他一切工作正常，但这些该死的复选框。我试着用

```
<?php
if(isset($_POST['mode'])) {
    $mode = implode(",", $_POST['mode']);   
} else {
    $mode = "";
}
?>

<?php 
```

正如另一个人提出的同样问题的建议，尽管无论选择什么，这种方法都会在列内留下“数组”而不是任何数字。

我试图发布一些图片以更好地解释，但它不允许我。我不是 SQL 或 PHP 专业人士，只是想尽可能多地学习以使该数据库快速运行。如果有解决这个问题的方法，请赐教。

这是我在提交时用于操作脚本的代码：

```
<?php
if(isset($_POST['mode'])) {
$mode = implode(",", $_POST['mode']);   
} else {
$mode = "";
}
?>

<?php

// Connect to server and select database.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// Get values from form 
$gamename=$_POST['gamename'];
$region=$_POST['region'];
$mode=$_POST['mode'];
$notes=$_POST['notes'];

// Insert data into mysql
$sql="INSERT INTO $tbl_name(gamename, region, mode, notes)VALUES('$gamename', '$region', '$mode', '$notes')";
$result=mysql_query($sql);

// if successfully insert data into database, displays message "Successful". 
if($result){
echo "Successful";
echo "<BR>";
echo "<a href='insert.php'>Back to main page</a>";
}

else {
echo "ERROR";
}
?> 

<?php 
// close connection 
mysql_close();
?> 
```

这是我的复选框的代码：

```
<td><input type="checkbox" name="mode[]" id="mode" value="1" />
 mode 1<br />
<input type="checkbox" name="mode[]" id="mode" value="2" />
  mode 2<br />
<input type="checkbox" name="mode[]" id="mode" value="3" />
  mode 3<br />
<input type="checkbox" name="mode[]" id="mode" value="4" />
  mode 4 <br /> 
<input type="checkbox" name="mode[]" id="mode" value="5" />
  mode 5 <br />
<input type="checkbox" name="mode[]" id="mode" value="6" />
  mode 6 <br />
<input type="checkbox" name="mode[]" id="mode" value="7" />
  mode 7<br />
<input type="checkbox" name="mode[]" id="mode" value="8" />
  mode 8
  </td> 
```

附带说明一下，我应该采取哪些步骤来确保我的数据库和网站不会受到简单的攻击。我计划让公众使用这些表格向数据库公开提交信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:27:52.093

您覆盖了正确`$mode`的变量，这就是您`Array`在表数据中看到的原因。

从代码中删除这一行：

```
$mode=$_POST['mode']; 
```

关于易受攻击：您应该以这种方式转义字符串：

```
$gamename = mysql_escape_string($_POST['gamename']);
$region = mysql_escape_string($_POST['region']);
$notes = mysql_escape_string($_POST['notes']); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-21T23:24:08.250

您可以使用以下代码将复选框转换为字符串，其中所选框用逗号分隔。

```
function checkboxToString($check){
    while (list ($key,$val) = @each ($check)) { 
        $string .= $val.",";
    }       
    return $string;
} 
```

例如：选中框 1,3 和 4 时，将返回 1,3,4,。是的，它在末尾添加了一个额外的逗号。您可以使用简单的代码行删除最后一个逗号（也许不是最好的）。只需在最后添加：

```
$string = substr($string,0,strlen($string)-1); 
```

这将删除字符串的最后一个字符。

# java - 更新不同类中的值时更新文本视图

> ID：14448950
> 
> 赞同：0
> 
> 时间：2013-01-21T23:17:53.400
> 
> 标签：java, android, eclipse, textview

我正在尝试将 textview 更新为当前 xml im 查看中的值（计时器），计时器的 java 是 glrenderer 类的一部分，一切正常，除了我无法更新我的 textview，我已经扩展像这样的班级活动：

`class MyGLRenderer extends Activity implements GLSurfaceView.Renderer {`

这样我就可以在计时器循环中使用它：

```
TextView view = (TextView) findViewById(R.id.timetextview);
view.setText(String.valueOf(globals.gametime)); 
```

它在尝试创建 viewtime 对象时崩溃。

有一种方法可以让它部分显示，Timer 值是一个全局值，所以我可以通过在 main.java 中创建一个按钮来显示它，如下所示：

```
public void buttonExample (View v) 
{
    TextView view = (TextView) findViewById(R.id.timetextview);
    view.setText(String.valueOf(globals.gametime));
} 
```

但是有了这个它不会用实际的计时器更新，我不确定为什么当我使用前 2 个代码块时它会崩溃，它编译得很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T05:29:42.493

我怀疑，您正在更新计时器线程中的 Textview。

您可以在计时器线程中尝试此操作 -

```
 runOnUiThread(new Runnable() {
           public void run() {
            view.setText(String.valueOf(globals.gametime));
           }
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T17:20:07.407

使用 Gaurav 提供的代码在我的计时器中访问 uithread 工作得很好，这就是我使用的

```
public Timer timer = new Timer();

timer.schedule(new TimerTask()
{
    @Override
    public void run()
    {
         runOnUiThread(new Runnable() {
          public void run() {
               TextView view = (TextView) findViewById(R.id.timetextview);
               view.setText(String.valueOf(globals.GameTime));
                }
          });
      }
}, 250, 250); 
```

# javascript - 当对象具有“新”作为属性名称时，来自 IE8 和 IE7 的“预期标识符”错误

> ID：14448951
> 
> 赞同：4
> 
> 时间：2013-01-21T23:17:55.833
> 
> 标签：javascript, internet-explorer, internet-explorer-8, internet-explorer-7

我有一个在 IE8 中测试的网页，它告诉我该页面有错误。我试图想出一个简单的例子，我想出了这个：

```
<!DOCTYPE HTML>
<html>
<head>
  <script>
  var stuff = {
    "foo": {
      "new": 42
    }
  };
  var thing = stuff.foo.new;
  </script>
</head>
<body>
</body>
</html> 
```

可以在[这里](http://jsfiddle.net/DKW8h/)测试。

这是我看到的错误：

```
Webpage error details

User Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)
Timestamp: Mon, 21 Jan 2013 23:11:52 UTC

Message: Expected identifier
Line: 11
Char: 25
Code: 0
URI: file:///C:/Documents%20and%20Settings/Administrator/My%20Documents/ie8PropertyNameTest.html 
```

IE7 显示类似的错误。它在我测试页面的所有其他浏览器中都能正常工作，包括较新版本的 IE。有谁知道是什么导致了这个问题以及如何避免它（除了选择其他名称的明显解决方案）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-21T23:19:38.237

`new`是 JavaScript 保留字。您可以通过以下方式前往酒店：

```
var thing = stuff.foo["new"]; 
```

（我敢打赌）。您可以通过调用类似“isNew”的属性来省去一些麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-21T23:21:13.293

如果您`new`用作密钥，请不要这样做：

```
foo.new = 'bar'; 
```

相反，请执行以下操作：

```
foo['new'] = 'bar'; 
```

# meteor - Meteor 客户端分页

> ID：14448956
> 
> 赞同：1
> 
> 时间：2013-01-21T23:18:08.013
> 
> 标签：meteor

有一个集合`Comments`。目前对特定的评论`Content`都发布给客户。

没有分页，我可以成功地将它们呈现在我的模板中，插入新评论并享受反应。

我现在可以将所有评论发送给客户端，但我想实现全客户端分页以在视觉上简化页面，就像 FB 一样。

野兔是规则：

*   评论始终按创建时间戳 ASC 排序（列表底部较新）
*   我需要显示集合中的记录总数 (T)
*   我需要显示当前显示的评论总数（C）
*   如果有更多评论 (C < T) 我需要显示“查看更多”链接
*   最初我显示 5 条最新评论（如果少于 5 条，则显示全部）
*   新评论（从服务器推送）立即显示在列表末尾
*   当我单击“查看更多”链接时，列表开头会显示多达 10 条额外评论（当前不可见的最新评论 - 所有评论都比已经显示的评论更旧）

如此有效地它可能是这样的：

*   有`minTime`变量
*   最初将其设置为第 5 条最新评论的时间戳
*   当我单击链接时，将其设置为比当前值更早的第 10 条最新评论的时间戳
*   模板呈现所有不早于此值的评论
*   *在某些时候*计算值 C 和 T 并保存它们

我试图用一堆`Session`变量来解决这个问题，但没有成功——我认为在某些时候从模板中获取和设置这些变量会导致递归或什么？另一个问题是我不能可靠地知道我应该第一次计算的“初始”时刻`minTime`——第一次创建或呈现模板时，注释可能仍然没有同步。

那么，问题是：满足我的要求的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T15:33:57.657

解决方案：

```
Meteor.startup(function(){
    Session.set('number_of_visible_comments', 5);
});

Template.comments = function() {
    return Comments.find({content: id_of_content}, {
        sort: {timestamp: -1}, 
        limit: Session.get('number_of_visible_comments')
    });
};

Template.total_number_of_comments = function() {
    return Comments.find({content: id_of_content}).count();
};

Template.number_of_visible_comments = function() {
    return Session.get('number_of_visible_comments').count();
};

Template.comments.events({
    'click': function() {
        var count = Session.get('number_of_visible_comments') + 10;
        Session.set('number_of_visible_comments', count);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T05:22:54.907

同时有两个 Meteor 包用于进行客户端分页，一个在一个表中。我承认由于上面与 ram1 的评论交换，我没有满足您的所有要求，但该软件包可能会有所帮助：

[https://atmosphere.meteor.com/package/reactive-table](https://atmosphere.meteor.com/package/reactive-table)

[https://github.com/alethes/meteor-pages](https://github.com/alethes/meteor-pages)

# mongodb - datanucleus 抱怨类没有得到增强，但是当第二次运行时工作正常。

> ID：14448957
> 
> 赞同：1
> 
> 时间：2013-01-21T23:18:20.927
> 
> 标签：mongodb, jdo, datanucleus

我正在尝试制作数据核，与 Mongodb 一起工作（使用 JDO）。成功后

```
mvn clean compile
mvn exec:java 
```

当我第一次运行时它失败了

```
caused by: org.datanucleus.exceptions.NucleusUserException: Found Meta-Data for class com.samples.jdo.mongodb.Account but this class is either not enhanced or you have multiple copies of jdo-api.jar in your CLASSPATH!! Make sure all persistable classes are enhanced before running DataNucleus and/or the CLASSPATH is correct. 
```

但是如果我再次运行它就可以正常工作，并且我可以看到数据也保存在 mongodb 中。

```
 // Create a PersistenceManagerFactory for this datastore
    PersistenceManagerFactory pmf = JDOHelper.getPersistenceManagerFactory("datanucleus.properties", this.getClass().getClassLoader());
    JDOMetadata jdomd = pmf.newMetadata(); 
    PackageMetadata pmd = jdomd.newPackageMetadata("com.samples.jdo.mongodb");
    ClassMetadata cmd1 = pmd.newClassMetadata(Account.class);
    cmd1.setTable("Account").setIdentityType(javax.jdo.annotations.IdentityType.DATASTORE);
    cmd1.setPersistenceModifier(ClassPersistenceModifier.PERSISTENCE_CAPABLE);

    ClassMetadata cmd2 = pmd.newClassMetadata(Login.class); 
    cmd2.setTable("LOGIN").setIdentityType(javax.jdo.annotations.IdentityType.DATASTORE);
    cmd2.setPersistenceModifier(ClassPersistenceModifier.PERSISTENCE_CAPABLE);

        PersistenceManager pm = pmf.getPersistenceManager();
        Account acct = new Account("firstname","lastname", 3);
        Login login = new Login("flastname", "xxxx");
        acct.setLogin(login);

        final JDOEnhancer enhancer = JDOHelper.getEnhancer(); 
        enhancer.setVerbose(true); 
        enhancer.registerMetadata(jdomd);
        enhancer.setClassLoader(this.getClass().getClassLoader());
        String[] classes = {"com.samples.jdo.mongodb.Account","com.samples.jdo.mongodb.Login" };
        enhancer.addClasses(classes); 
        enhancer.enhance(); 

        pmf.registerMetadata(jdomd);            
        pm.makePersistent(acct); 
```

有任何想法吗？

谢谢

# php - 谁能告诉我为什么这个 Codeigniter 会话数据函数似乎工作..但返回 false？

> ID：14448959
> 
> 赞同：0
> 
> 时间：2013-01-21T23:18:38.983
> 
> 标签：php, codeigniter

所以这已经让我死了好几个小时。

我有一个 ajax 方法，可以在用户登录时设置 sessiondata。我通过 jQuery 发送一些 var，然后输出一条消息（也可以是“true”/“false”），我正在发出警报当它回到 $.post 时。

问题是这个..我得到了“假”的回报，尽管事情似乎有效。我的会话用户数据**似乎**设置正确。我建立了一个按钮，在页面上提醒它，它**正在**被设置。我注销并确认所有会话数据都已清除，然后重新登录并再次正确设置会话数据。但是“错误”/“会话数据问题”消息是返回给 jQuery 并每次都被警告的消息。

```
public function setUserSessionData(){
    $picture    = $this->input->post('picture', TRUE);
    $email      = $this->input->post('email', TRUE);
    $first_name = $this->input->post('first_name', TRUE);
    $id         = $this->input->post('id', TRUE);

    ChromePhp::log($picture.$email.$first_name.$id);  // all values good

    $newData = array(
        'loggedInStatus' => 'TRUE',
        'picture'        => $picture,
        'first_name'     => $first_name,
        'id'             => $id,
        'email'          => $email
    );

            // userdata is setting correctly
    if($this->session->set_userdata($newData))
    {
        echo("Session data set"); 
    }
    else
    {
        echo("PROBLEM WITH SESSION DATA"); // this is the message that is outputting
    }
} 
```

谁能解释发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:43:43.613

`set_userdata()`总是返回`NULL`。

我不知道你去哪里`set_userdata()`应该返回任何东西的想法。该[文档](http://ellislab.com/codeigniter/user-guide/libraries/sessions.html)没有提及返回值，并且[代码本身](https://github.com/EllisLab/CodeIgniter/blob/develop/system/libraries/Session/Session.php#L294)被记录为`@return void`并且不包含`return`语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:31:15.363

你不能只在那个会话数组中使用一个键吗？

```
$newData = array(
    'loggedInStatus' => TRUE,

// ...

$this->session->set_userdata($newData);

if($this->session->userdata('loggedInStatus') === TRUE){ 
    echo("Session data set"); 
}else{
    echo("PROBLEM WITH SESSION DATA");
} 
```

# php - 插入后jQuery AJAX刷新不起作用

> ID：14448961
> 
> 赞同：0
> 
> 时间：2013-01-21T23:19:05.230
> 
> 标签：php, jquery

我有一个单页网站，插入工作正常，但提交后似乎无法更新#results div。这些值被插入到数据库中就好了，如果我硬刷新它们就会出现。但不是用 jQuery AJAX 刷新。我是 Ajax 新手，因此非常感谢任何帮助，以及对代码结构或不良习惯的任何评论，请在我尝试学习正确的编程方法时发表评论。

这是我的代码：

```
$(document).ready(function(){        

$("form#addTodo").submit(function(){
    alert('hello world'); // ensure function is running

    var post_title = $('input#post_title').val(); // take values from inputs
    var post_content = $('input#post_content').val();

    $.ajax({
        type: "POST",
        url: "add.php",
        data: "post_title=" + post_title + "&post_content=" + post_content,
        success: function() {
            // alert('success'); // ensure success
            $('#results').fadeOut('slow').load('include/results.php').fadeIn('slow');               
        }
    });

    $('input#post_title').val(''); // clear form fields
    $('input#post_content').val('');

    return false; 
}); 
```

});

这是 results.php 文件：

```
<?php

$sql = $db->query('SELECT id, post_title, post_content FROM posts ORDER BY post_title ASC');

$results = $sql->fetchALL(PDO::FETCH_OBJ);
$count_posts = count($results);

?>

<?php if ( have_posts() == true) : ?>
    <div class="accordion" id="accordion_main">
        <?php foreach($results as $entry): ?>
            <div class="accordion-group">
                <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion_main" href="#collapse-<?php echo $entry->id; ?>">    
                        <?php echo $entry->post_title; ?>
                    </a>    
                </div>
                <div id="collapse-<?php echo $entry->id; ?>" class="accordion-body collapse">   
                    <div class="accordion-inner">
                        <p class="target"><?php echo $entry->post_content; ?></p>
                        <p><a href="edit.php?id=<?php echo $entry->id; ?>">Edit</a> <a href="delete.php?id=<?php echo $entry->id; ?>" onclick="return confirm('Are you sure you wish to delete this post?');">Delete</a></p>                    
                    </div>
                </div>
            </div>
        <?php endforeach; ?>                
    </div>
<?php else: ?>
    <h3>There are no posts to display at this time.</h3>
<?php endif; ?> 
```

当它包含在 index.php 中时，它工作正常，我只是无法在将数据发布到数据库后刷新它。

```
<?php
require_once 'includes/db.php';
require_once 'includes/functions.php';
?>

<?php get_header(); ?>

<div id="results">
<?php include_once 'includes/results.php'; ?>
</div>

<hr />
<p>Add New Post</p>

<form id="addTodo" action="">

<div>
    <label for="post_title">Post Title</label>
    <input id="post_title" name="post_title">
</div>

<div>
    <label for="post_content">Post Content</label>
    <input id="post_content" name="post_content">
</div>

<div>
    <button id="submit" type="submit">
        Save
    </button>
</div>

</form>

<?php get_footer(); ?> 
```

我应该提到我还没有进行表单验证。非常感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:27:45.860

为什么不直接从成功中返回数据？并用它来制作你的 html 输入

```
success:function(returnedData) {
     if (returnedData.status = 'successful') {
       //use javascript to append the data for example like 
       //returnedData.message to make html and insert into your current html
     }    
} 
```

注意：returnedData 必须由您的 php 以 json 格式推出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T00:57:21.753

如果您阅读我最近回答的这个帖子，您可以找到与您的请求类似的答案：[Jquery Mobile Post to PHP (same page)](https://stackoverflow.com/a/14446770/1623591)

但是您必须根据上下文进行一些调整；-) !! 如果您使用唯一的文件脚本，我认为这是唯一的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-22T05:33:01.540

要插入从 php 文件返回的数据，只需使用 $("element id or class").html() 函数将数据或 html 插入到文档的特定区域

# c++ - 错误 LNK2019：函数“...”中引用的未解析外部符号“public: __thiscall user::user(void)”(??0user@@QAE@XZ)

> ID：14448963
> 
> 赞同：1
> 
> 时间：2013-01-21T23:19:23.257
> 
> 标签：c++, linker

> **可能重复：**
> [什么是未定义的引用/未解决的外部符号错误，我该如何解决？](https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix)

我正在尝试编写大学作业并且似乎在编译时遇到问题，我已经对错误进行了 Google 搜索，并且我看到的修复程序不适用于我的代码。我会很感激你的帮助。

以下是错误代码：

```
Error 1 error LNK2019: unresolved external symbol "public: __thiscall user::user(void)" (??0user@@QAE@XZ) 
referenced in function "void __cdecl `dynamic initializer for 'player''(void)" (??__Eplayer@@YAXXZ) 
C:\Users\obinyans\Documents\Visual Studio 2010\Projects\test\test\Challenge 1.obj 
```

以下是我的代码的副本：

```
#include <iostream>
#include <string>
#include <math.h>

using namespace std;

void storeinfo() ;
void showinfo() ;

class user 
{
    string firstname, lastname, currentteam, position, status ;
    int age ;
public:
    user();
    user(string, string, string, string, string, int) ;
    void setFirstName(string fname)
        {firstname = fname;}
    void setLastName(string lname)
        {lastname = lname;}
    void setCurrentTeam(string cteam)
        {currentteam = cteam;}
    void setPosition(string pos)
        {position = pos;}
    void setStatus(string stat)
        {status = stat;}
    void setAge(int _age)
        {age = _age;}

    string getFirstName()
        {return firstname ;}
    string getLastName()
        {return lastname ;}
    string getCurrentTeam()
        {return currentteam ;}
    string getPosition()
        {return position ;}
    string getStatus()
        {return status ;}
    int getAge()
        {return age ;}
};

user player[20] ;

int main()
{
     ;

    int menu ;

    cout << "MENU" << "\n" ;
    cout << "\n 1\. Store Player Information" ;
    cout << "\n 2\. Show Player Informaton" ;
    cout << "\n 0\. Exit" ;

    cin >> menu ;
    if (menu = 1)
    {
        storeinfo() ;
    }
    else if (menu = 2)
    {
        showinfo() ;
    }
    else if (menu = 0)
    {
        return 0;
    }

    cin.get() ;
    return 0 ;

}

void storeinfo()
{
    string firstname ;
    string lastname ;
    string currentteam ;
    string position;
    string status ;
    int age ;

    for (int i=0; i < 3; i++)
    {
        cout << "Enter First Name : " ; cin >> firstname ;
        player[i].setFirstName(firstname) ;
        cout << "Enter Last Name : " ; cin >> lastname ;
        player[i].setLastName(lastname) ;
        cout << "Enter Player's Age : " ;cin >> age;
        player[i].setAge(age) ;
        cout << "Enter Current Team : " ; cin >> currentteam ;
        player[i].setCurrentTeam(currentteam) ;
        cout << "Enter Position : " ; cin >> position ;
        player[i].setPosition(position) ;
        cout << "Enter Status : " ; cin >> status ;
        player[i].setStatus(status) ;
    }
}

void showinfo()
{
    for (int i=0; i < 3; i++)
    {
        cout << "First Name : " << player[i].getFirstName() << "        " << "Last Name : " << player[i].getLastName() <<
            "       " << "Age : " << player[i].getAge() << "        " << "Current Team : " << player[i].getCurrentTeam() << 
            "       " << "Position : " << player[i].getPosition() << "      " << "Status :  " << player[i].getStatus() ;
    }
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T23:44:11.547

您没有为构造函数提供**实现：**

```
class user
{
....
public:
  user();
  user(string, string, string, string, string, int);
....
}; 
```

尝试为它们添加主体：

```
class user
{
....
public:

  // Default constructor
  user()
     // std::string's are default constructed to empty strings.
     // You may want to set a value for age data member.
    : _age(0)
  {
  }

  // Constructor with initialization parameters
  user(string first_name, string last_name, string current_team, 
       string position, string status, int age)
    : _first_name(move(first_name)), 
      _last_name(move(last_name)), 
      _current_team(move(current_team)),
      _position(move(position)), 
      _status(move(status)),
      _age(age)
  {
  }

....
}; 
```

请注意，*为数据成员提供一些前缀*很方便，以将它们与参数区分开来。一些约定以`_`or为前缀`m_`（例如`name`是参数，`_name`或者`m_name`是数据成员）。

另请注意，在 C++11 中（并且从您的错误代码中，我读到您正在使用 VS2010，它具有某种形式的移动语义可用），当您传递一个可移动且移动成本低的类时，您有要制作本地副本（例如设置数据成员时），您可以通过值和`std::move`值传递，例如

```
void set_first_name(string first_name)
{
    _first_name = move(first_name);
} 
```

另请注意，吸气剂往往是`const`：

```
const string& get_first_name() const
{
    return _first_name;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-21T23:22:08.207

看起来您还没有为`user`该类定义构造函数。

尝试改变：

```
user();
user(string, string, string, string, string, int) ; 
```

至：

```
user() {}
user(string, string, string, string, string, int) {} 
```

这不会导致构造函数做任何事情，但至少它们现在会存在。我猜，最终，你会希望你的第二个构造函数看起来像这样：

```
user(string fname, string lname, string cteam, string pos, string stat, int age)
{
    setFirstName(fname);
    setLastName(lname);
    setCurrentTeam(cteam);
    setPosition(pos);
    setStatus(stat);
    setAge(age);
} 
```

# haskell - 如何比较递归数据结构？

> ID：14448964
> 
> 赞同：6
> 
> 时间：2013-01-21T23:19:33.687
> 
> 标签：haskell

我有一个复杂且递归的数据结构，我已将其简化为以下内容：

```
data Node = Node { value :: Integer, next :: Node } deriving (Show,Eq) 
```

给定以下表达式：

```
--Create a circular structure
a = Node 1 b
b = Node 0 a --Tie the knot
c = Node 1 b --Another structure which points to b 
```

表达式`a`和`c`在概念上是相等的：它们都表示一个节点，该节点保存值 1 并指向表达式 b。我的问题是：如何检查它们在 Haskell 表达式中是否确实相等？如果我评估`a == c`，它将永远评估循环结构中的子元素。

是否可以在 Haskell 中进行这样的比较？

编辑：就我而言，我试图比较两者以进行检查/调试。但这样做的另一个原因可能是单元测试。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-22T00:16:55.100

首先，*a*和*b*不相等，但是*a*和*c*相等，不仅在概念上，而且它们实际上是相同的东西。

回答您的问题：您的问题没有直接解决方案。如果你需要身份比较，你首先要建立一个身份的概念。一种方法是使用`Map`从键到节点：

```
data Node k =
    Node {
      nodeValue :: Integer,
      nodeNext  :: k
    } 
```

这个想法是你有一个单独`Map`的从类型*k*到节点的键。但是，您不能`Eq`为该实例编写实例。解决这个问题的一种优雅的方法是使用[反射](http://hackage.haskell.org/package/reflection)：

```
{-# LANGUAGE ScopedTypeVariables #-}

import Data.Reflection

data Node n k =
    Node {
      nodeValue :: Integer,
      nodeNext  :: k
    }

instance (n `Reifies` Map k (Node n k)) => Eq (Node n k) where
    (==) = {- ... -}
        where
        nodeMap :: Map k (Node n k)
        nodeMap = reflect (Proxy :: Proxy n) 
```

最近引起关注的另一个选项是[可观察共享](https://github.com/leonidas/codeblog/blob/master/2013/2013-01-14-observable-sharing.md)的概念。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-22T08:55:40.223

如果您承诺仅将其用于测试和调试，而不用于应用程序代码，您还可以使用我的[ghc-heap-view](http://hackage.haskell.org/package/ghc-heap-view)库，它为您提供 Haskell 堆的低级视图，并使您能够实现比较：

```
Prelude> :script /home/jojo/.cabal/share/ghc-heap-view-0.4.0.0/ghci 
Prelude> data Node = Node { value :: Integer, next :: Node } deriving (Show,Eq)
Prelude> let { a = Node 1 b; b = Node 0 a ; c = Node 1 b}
Prelude> take 100 (show a) -- make sure it is evaluated, we are not interested in thunks here
"Node {value = 1, next = Node {value = 0, next = Node {value = 1, next = Node {value = 0, next = Node"
Prelude> take 100 (show c) -- dito
"Node {value = 1, next = Node {value = 0, next = Node {value = 1, next = Node {value = 0, next = Node"
Prelude> System.Mem.performGC
Prelude> :printHeap a
let x0 = Node (S# 1) (Node (S# 0) x0)
in x0
Prelude> :printHeap c
let x2 = Node (S# 0) (Node (S# 1) x2)
in Node (S# 1) x2 
```

但是现在这对你来说肯定不是正确的事情，因为你正在“做这个项目作为学习 Haskell 的练习”。

# mysql - 在 phpMyAdmin 中导入文本文件

> ID：14448966
> 
> 赞同：2
> 
> 时间：2013-01-21T23:19:42.480
> 
> 标签：mysql, sql, phpmyadmin

我有一个`text`包含大约 1200 行的文件。我想将它作为一个表导入到 phpMyAdmin 中，其中`id`将为每一行提供一个主要的。有没有办法在 phpMyAdmin 中实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-21T23:40:20.803

1.  创建要插入数据的表：

    ```
    CREATE TABLE my_table (
      id        SERIAL,
      my_column TEXT
    ); 
    ```

2.  在`Import`选项卡上，选择您的文件，然后在`Format of imported file`：

    *   选择`CSV using LOAD DATA`

    *   确保`Fields ... by`选项全部为空

    *   离开`Lines terminated by`为`auto`

    *   在列名下，指定要插入数据的列的名称 - 即`my_column`上面

    *   点击`Go`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-28T11:27:24.300

如果您选择“CSV”格式并手动填写列名，它会起作用

# php - PHP MySQL从两个表中选择数据并按第三个表中的字段排序

> ID：14448967
> 
> 赞同：1
> 
> 时间：2013-01-21T23:19:44.523
> 
> 标签：php, mysql, group-by, sql-order-by

请我有以下表格

```
Field
+----+--------+----------+---------------------+
| id | name   | Type     | date                |
+----+--------+----------+---------------------+
|  1 |  price | int      | 2009-09-02 00:07:07 |
|  2 |  width | float    | 2009-09-02 00:07:08 |
|  3 |  height| float    | 2009-09-02 00:07:30 |
+----+--------+--------------------------------+

Post
+----+--------+---------------------------------+
| id |title   | Body                            |
+----+--------+---------------------------------+
|  1 |  test  | Bla bla bla                     |
|  2 | Hello  | Bla bla bla                     |
|  3 | Its me | Bla bla bla                     | 
+----+--------+---------------------------------+

Post_Annex
+----+--------+----------+---------------------+
| id | IdPost | IdField  | Value               |
+----+--------+----------+---------------------+
|  1 |  1     | 1        | 50                  |
|  2 |  1     | 2        | 21                  |
|  3 |  1     | 3        | 3                   |
|  4 |  2     | 1        | 10                  |
|  5 |  2     | 2        | 2                   |
|  6 |  2     | 3        | 150                 |
|  7 |  3     | 1        | 1                   |
|  8 |  3     | 2        | 25                  |
|  9 |  3     | 3        | 15                  |
+----+--------+--------------------------------+ 
```

我希望从**Post**和**Post_Annex**表中选择数据，按 Post 表的 Id 对它们进行分组并按价格排序（这意味着当 Post_Annex 表的 IdField 等于 1 时）。所以这是我的查询：

```
SELECT p.title
    FROM Post p
    LEFT JOIN Post_Annex pa
       ON p.id = pa.IdPost

    GROUP BY p.id

    ORDER BY case when pa.IdField = 1 then 0 else 1, pa.Value DESC 
```

这给了我这个顺序的结果：`its Me | Hello | test`

这可以。但即使我尝试按宽度（IdField = 2）或高度（IdField = 3）排序，它也给了我相同的结果。

请掌握任何想法来帮助我解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:27:39.240

我只想修改 join 子句，以指定要排序的字段：

```
SELECT p.title
FROM Post p
     LEFT JOIN Post_Annex pa
     ON p.id = pa.IdPost
        AND pa.idfield=1
ORDER BY pa.Value DESC 
```

然后您不必按 p.id 分组。

您的查询并不总是有效，因为您正在分组，`p.id`但您正在选择（和排序）其他非聚合列，并且这些列的值可以是[undeteminate](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:43:19.453

在一个简单的 SQL 中，避免 group by 和 case when 的：

```
SELECT p.title
FROM Post p, Post_Annex pa
WHERE p.id = pa.IdPost
AND pa.IdField = 1
ORDER BY pa.Value DESC 
```

你可以这样做。

# iis - IIS 7.0 站点 ID 和 ApplicationHost.config 错误

> ID：14448971
> 
> 赞同：1
> 
> 时间：2013-01-21T23:20:27.320
> 
> 标签：iis, config, applicationhost

我最近使用 App Cmd 将网站自动添加到我的 IIS 服务器。我使用的脚本类似于：site name="Site1 bindings="http/*:80site" id="1%%l"

这是在生成 XML 以在 AppCmd 添加站点中使用的批处理脚本中创建的

该站点已正确添加，但它分配了与现有站点相同的站点 ID。

对此的简单修复似乎是删除该站点并在 ApplicationHost.config 文件中从那里删除该站点（或更改其站点 ID）。

但是问题是该文件始终在使用中，因此我无法保存任何更改。我尝试重新启动服务器并直接访问该文件，但是发生了同样的错误。

有没有办法在启动时关闭 IIS 以使该文件不被使用？或者是否有其他解决方案，以便我可以再次访问我的网站。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:45:22.600

找到了解决我的问题的方法。

由于文件 (ApplicationHost.config) 一直在使用中，我找到了以前的备份 (/inetpub/history/) 并复制/粘贴。这不是适合所有人的解决方案，因为它确实删除了任何新的配置更改，但就我而言，我没有丢失任何数据。

# sql - php subselect 出错 - 有没有办法在这里做一个 LEFT JOIN 呢？

> ID：14448972
> 
> 赞同：-1
> 
> 时间：2013-01-21T23:20:29.717
> 
> 标签：sql, postgresql, php

我得到一个错误`SUBSELECT`？

```
$common_dimensions_query = "
SELECT *
FROM main_products_common_dimensions d
WHERE d.product_id = (SELECT id FROM main_products WHERE abbreviation = '".$product."'"; 
```

错误：

> 警告：pg_query() [function.pg-query]：查询失败：错误：输入第 4 行末尾的语法错误：...（SELECT id FROM main_products WHERE abbreviation = 'banner' ^ in

反正有没有在`LEFT JOIN`这里做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:26:26.117

使用 JOIN 而不是双重 SELECT 的版本：

```
"SELECT *
FROM main_products_common_dimensions d
JOIN main_products p ON d.product_id = p.id
WHERE p.abbreviation = '$product'" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:25:19.173

根据语法，您应该使用`IN`而不是`=`. 正确的语法是

```
$common_dimensions_query = "SELECT * FROM main_products_common_dimensions d WHERE d.product_id IN (SELECT id FROM main_products WHERE abbreviation = '".$product."');"; 
```

是的，您可以改为 JOIN。有关示例，请参见其他答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T23:25:02.420

你需要关闭你的括号

```
$common_dimensions_query = "SELECT * FROM main_products_common_dimensions d ".
                           " WHERE abbreviation = '".$product."')"; 
```

当然，我强烈建议一般不要使用此查询。您不应该在查询中插入字符串，而是使用准备好的语句。

# .htaccess - .htaccess 临时重定向（302）的最佳方法，但有异常

> ID：14448975
> 
> 赞同：0
> 
> 时间：2013-01-21T23:20:40.563
> 
> 标签：.htaccess, redirect, http-status-code-302

我正在对站点执行更新，因此我想为除一个特定页面之外的所有网页创建 302 临时重定向。

perishablepress.com 有两篇关于我目前使用选项 1 的主题的文章：

1.  [http://perishablepress.com/temporary-site-redirect-for-visitors-during-site-updates/](http://perishablepress.com/temporary-site-redirect-for-visitors-during-site-updates/)
2.  [http://perishablepress.com/htaccess-redirect-maintenance-page-site-updates/](http://perishablepress.com/htaccess-redirect-maintenance-page-site-updates/)

这些文章指的是修改所有页面，因为我有一个页面我想保持活动状态。（事实上​​，我正在努力让选项 2 起作用）。谁能告诉我实现这一目标的最佳方法是什么？

为了澄清，我想：

1.  让所有页面重定向到`coming-soon.html`（即*www.mywebsite.com/sample-page.html* => *www.mywebsite.com/coming-soon.html*）
2.  添加一个例外，`/contact-us.html`以便正常处理此请求（即`www.mywebsite.com/contact-us.html`=> *www.mywebsite.com/contact-us.html*）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T23:35:36.267

你可以试试这个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_URI}  !contact-us.html  [NC]
RewriteCond %{REQUEST_URI}  !coming-soon.html [NC]
RewriteCond %{REQUEST_URI}  \.(html|htm)/?    [NC]
RewriteRule .*  coming-soon.html              [R=301,L] 
```

# java - 如何拦截来自 Openfire 服务器的 Ping 消息？

> ID：14448978
> 
> 赞同：3
> 
> 时间：2013-01-21T23:20:52.183
> 
> 标签：java, plugins, xmpp, openfire

我正在编写一个 Openfire 插件来拦截客户端空闲时服务器发送给客户端的 Ping 消息。系统 Ping 如下所示：

```
<iq from='capulet.lit' to='juliet@capulet.lit/balcony' id='s2c1' type='get'>
  <ping xmlns='urn:xmpp:ping'/>
</iq> 
```

但是，当我使用 PacketInterceptor 拦截服务器和客户端之间的所有数据包时，拦截器能够拦截除 Ping 之外的所有数据包。我不明白发生了什么事。任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-31T12:19:19.293

在这里，您可以找到记录每个传入和传出数据包的数据包拦截器的最简单示例。 [http://faisalbhagat.blogspot.com/2014/03/openfire-logging-using-packetinterceptor.html](http://faisalbhagat.blogspot.com/2014/03/openfire-logging-using-packetinterceptor.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-02T02:04:23.887

下面是`intercepPacket`我插件中的覆盖方法，它可以拦截 ping 消息。供你参考~:)

```
@Override
public void interceptPacket(org.xmpp.packet.Packet packet, Session session,
        boolean incoming, boolean processed) throws PacketRejectedException {
    if (incoming && !processed) {
        String packetXml = packet.toXML();
        logger.warn("\n" + new XmlFormatter().format(packetXml));
    }
} 
```

# php - 使用不同的 json-array 多次调用 javascript 函数

> ID：14448979
> 
> 赞同：0
> 
> 时间：2013-01-21T23:20:53.073
> 
> 标签：php, javascript, function, unique

我得到了这个代码：

```
function datatable_display(json) {

    var order = "desc";

    var len = $('.div_gui_tabledata').length;
    len = len++;
    var table = $('#dynamic_' + len);

    document.write("<div class='div_gui_tabledata' id='dynamic_" + len + "' >");

    this.array = JSON.stringify(json);

    $.ajax({
        type: "POST",
        url: "../../api.php?p=datatable_sort",
        data: "sortby=2&data=" + array,
        dataType: "html",
        success: function (data) {
            $('#dynamic_' + len).html(data);
        }
    });

    document.write("</div>");

    $('#dynamic_' + len + ' .sortable').live("click", function () {

        var index = $(this).index();

        $.ajax({
            type: "POST",
            url: "../../api.php?p=datatable_sort",
            data: "order=" + order + "&sortby=" + index + "&data=" + array,
            dataType: "html",
            success: function (data) {
                $('#dynamic_' + len).html(data);
                if (order == "desc")
                    order = "asc";
                else
                    order = "desc";
            }
        });
    });

} 
```

我从我的 PHP 脚本中调用这个函数，如下所示：

```
 $json = json_encode($this->arr);
 return "<script>datatable_display($json);</script></div>"; 
```

当我调用该函数两次甚至更多次时，问题是 json-Object 数组总是被最后一个覆盖。

Javascript中有类似OOP的东西吗？还是威胁到每个函数调用唯一的东西？我为 div 和 Sort-Links 生成唯一的 id，但随后只使用最新的 JSON 对象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:28:43.260

你可以做很多不同的建筑事情来让自己的生活更轻松，但你很可能会自己及时发现这些。要回答您的直接问题，使用 javascript 的内置对象应该可以解决您的问题。

```
var str = "something"; // choose your own key
this.store = {}
this.store[str] = JSON.stringify(json); 
```

*或者*

```
this.array = []; // in your initializer or constructor
this.array.push(JSON.stringify(json)); // this will add to the array as you go 
```

通过这种方式，您可以保留 json 的历史记录，而不会覆盖您之前拥有的内容。

# javascript - 删除 JavaScript 中的按键延迟？

> ID：14448981
> 
> 赞同：6
> 
> 时间：2013-01-21T23:21:06.310
> 
> 标签：javascript, html5-canvas, dom-events

好吧，当你按住键盘上的一个键时，第一次开火后会有 1 秒的延迟。
您可以继续打开记事本并按住一个键（例如“x”），您会在第一次火灾后看到有延迟。

但是，我正在尝试使用 JavaScript 在 HTML5 Canvas 中开发游戏，并且 1 秒的延迟非常烦人，此外，它还会停止玩家行走动画。

那么我怎样才能删除 JavaScript 中令人讨厌的延迟（没有 jQuery！）？

我的 keydown 事件以这种模式工作 -

```
document.onkeydown = getKey;
function getKey(e) {
    switch(e.keyCode) {
        case 38: // UP
            Player.PositionY--;
        break;
        case 39: // RIGHT
            Player.PositionX++;
        break;
        case 40: // DOWN
            Player.PositionY++;
        break;
        case 37: // LEFT
            Player.PositionX--;
        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T23:24:59.760

你可以开始一个事件`keydown`并停止它`keyup`

```
$('#mycanvas').on('keydown', function() { 
   $(document).trigger('start'); 
}); 

$('#mycanvas').on('keyup', function() { 
   $(document).trigger('stop'); 
});

$(document).on('start', startAnimation);
$(document).on('stop', stopAnimation);

function startAnimation(e) { //start something }
function stopAnimation(e) { //stop something } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:41:51.430

相反，在*第一次*按下键时监听，然后在释放时监听。这也意味着您必须在某处记录当前的移动速度状态，以便您可以在这些事件之间应用它。

这个例子只服务于向前走，应该很容易扩展到其他方向。

```
var playerSpeed = 0;

document.onkeydown = keyDown;
document.onkeyup = keyUp;

function keyDown(e) {
    switch(e.keyCode) {
        case 38: // UP
            playerSpeed = 1; // moving!
            break;
        // other cases...
    }
}

function keyUp(e) {
    switch(e.keyCode) {
        case 38: // UP
            playerSpeed = 0; // NOT moving!
            break;
        // other cases...
    }
}

// Whatever loop is called for each frame or game tick
function updateLoop() {
  // rendering, updating, whatever, per frame
  Player.PositionY += playerSpeed;
} 
```

这样，键盘的重复率是多少都没有关系。每一个`onkeydown`，总会最终拥有一个`onkeyup`。您所要做的就是在这些事件之间以不同的方式更新事物。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T01:16:04.370

你很幸运，我只是为游戏编写代码。

```
Controller = {
    keyIsDown: [],

    // Add a new control. up is optional.
    // It avoids key repetitions
    add: function (key, down, up) {
        $(document).keydown(function(e) {
            if(e.keyCode === key && !Controller.keyIsDown[key]) {
                    down()
                Controller.keyIsDown[key] = true
                return false
            }
        })

        $(document).keyup(function(e) {
            if(e.keyCode === key) {
                if(up) up()
                Controller.keyIsDown[key] = false
                return false
            }
        })
    },
} 
```

例子：

```
Controller.add(65,
    function () {
        console.log("A is down")
    },
    // This argument is optional
    function () {
        console.log("A is up")
}) 
```

# jquery - jQuery：我如何让 div 扩展到一个高度并添加文本？

> ID：14448982
> 
> 赞同：0
> 
> 时间：2013-01-21T23:21:06.367
> 
> 标签：jquery, html, css, jquery-ui, jquery-selectors

我有一个主页，在导航下方有一个容器 div，我试图将其扩展到设定的高度并在容器 div 内添加特定文本。

最重要的是，我只希望它在我仅从主页导航时执行此操作。

任何可以帮助我做到这一点的 jQuery 魔法？

谢谢！

这是主页上的之前 ![前](../Images/bf71b55edb617ab9d7a5af2c2abaa9f5.png)

这是在主页上单击并加载的不同页面的之后。 ![在此处输入图像描述](../Images/f3988a3699a40ce1bf2d47f61c31dace.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:25:12.807

这个怎么样？

```
$('#container-div').animate({
    height: '100px' // your target fixed height.
}, 'fast').html('specific text'); 
```

您的容器 div 具有 ID 的位置`container-div`。如果您不想要过渡，可以使用`.css()`.

```
$('#container-div').css('height', '100px').html('specific text'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T23:36:01.047

这可以通过 CSS3 实现： 创建 CSS3 动画：

```
/* Create predefined animation using keyframes */
@keyframes appear { 0% { height: 0px; } 100% { height: 100%; } }
@-o-keyframes appear { 0% { height: 0px; } 100% { height: 100%; } }
@-moz-keyframes appear { 0% { height: 0px; } 100% { height: 100%; } }
@-webkit-keyframes appear { 0% { height: 0px; } 100% { height: 100%; } }

/* will effect in children with less then 150px to slide to this height */
div { min-height: 150px; } 
/* Div is larger then 150px? It will just animate to its required height */
div:hover > div { 
  -webkit-animation: drop 1s 1 linear;
  -moz-animation: drop 1s 1 linear;
  -o-animation: drop 1s 1 linear;
  animation: drop 1s 1 linear;
  overflow-y: hidden;
} 
```

[示例工作](http://jsfiddle.net/7eENn/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T23:24:26.483

您是否尝试过类似的方法：

```
window.onbeforeunload = function() {
    $('.container').css('height', '50px').text('Bye bye!');
} 
```

您可能还想尝试在容器内嵌套另一个元素，以防止您手动指定容器高度。然后，您可以将 JavaScript/CSS 最小化为：

```
$('.container .child').show();

.child {
   height: 20px;
} 
```

# magento - Magento - 覆盖 adminhtml 模板文件

> ID：14448983
> 
> 赞同：12
> 
> 时间：2013-01-21T23:21:07.133
> 
> 标签：magento, magento-1.7

我已经阅读了几篇关于堆栈溢出的帖子

*   [覆盖 Magento Adminhtml 模板文件](https://stackoverflow.com/questions/11348240/overriding-a-magento-adminhtml-template-file)
*   [Magento - 覆盖 Adminhtml 块](https://stackoverflow.com/questions/1876897/magento-overriding-adminhtml-block)

和magento论坛上的几个线程

*   [http://www.magentocommerce.com/boards/viewthread/21978/](http://www.magentocommerce.com/boards/viewthread/21978/)

但是，这些帖子都没有尝试做我想做的事情

我想覆盖

```
app/design/adminhtml/default/default/template/widget/grid.phtml 
```

文件，因为该文件包含 html 的一部分，允许任何人从 sales->order 视图导出。

注意：我们在权限->角色视图中禁用了此用户角色的所有导出选项

显示“导出到：”->“CSV/Excel XML”功能的代码包含在我上面列出的路径中。我想删除那块 html 并覆盖 Magento 包含的文件。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-22T13:47:34.440

Adminhtml 使用与前端相同的主题回退，因此您只需在模块配置 XML 中为您的安装声明一个自定义模板主题：

```
<stores>
    <admin>
        <design>
            <theme>
                <template>custom</template>
            </theme>
        </design>
    </admin>
</stores> 
```

然后，您可以使用您喜欢的任何自定义创建*app/design/adminhtml/default/custom/template/widget/grid.phtml*，该文件将优先使用**默认/默认**adminhtml 主题中的文件。然后，您的解决方案是在呈现导出控制的逻辑中添加 ACL 检查：

```
<?php if($this->getExportTypes() && {ACL LOGIC}}): ?>
    <td class="export a-right">
        <img src="<?php echo $this->getSkinUrl('images/icon_export.gif') ?>" alt="" class="v-middle"/>&nbsp; <?php echo $this->__('Export to:') ?>
        <select name="<?php echo $this->getId() ?>_export" id="<?php echo $this->getId() ?>_export" style="width:8em;">
        <?php foreach ($this->getExportTypes() as $_type): ?>
            <option value="<?php echo $_type->getUrl() ?>"><?php echo $_type->getLabel() ?></option>
        <?php endforeach; ?>
        </select>
        <?php echo $this->getExportButtonHtml() ?>
    </td>
<?php endif; ?> 
```

虽然这个逻辑在块类中可能更合适地实现，但类重写系统不支持重写父类，让您重写每个子类。在这种情况下，遵守 DRY 胜过在模板中嵌入太多逻辑。此外，这种变化是显而易见的并且易于维护。

理想情况下，核心团队应该在`Mage_Adminhtml_Block_Widget_Grid`类中实现这个检查，或者至少为`_exportTypes`属性提供一个公共设置器，这会使这个逻辑更容易实现。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-22T00:04:17.103

重写块似乎是最简单的解决方案，但这更像是一个肮脏的黑客而不是一个干净的解决方案。应该非常小心地使用类重写，并且尽可能避免。否则你很快就会遇到冲突，而且更新 Magento 也会很麻烦。

通常您可以通过自定义布局更新（即在您的 local.xml 中）来更改模板，但在这种情况下，它是一个小部件，它不是通过布局 XML 配置的。

因此，输入观察者：创建一个模块，其中包含以下内容`config.xml`

```
<adminhtml>
    <events>
        <adminhtml_block_html_before>
            <observers>
                <yourmodulename_observer>
                    <class>yourmodulename/observer</class>
                    <method>changeWidgetTemplate</method>
                </yourmodulename_observer>
            </observers>
        </adminhtml_block_html_before>
    </events>
</adminhtml> 
```

如果您不了解上述任何内容，请阅读 Magento 事件和观察者。

现在您将需要观察者本身来实际更改模板，但仅适用于此块类型：

```
class Your_Modulename_Observer
{
    public function changeWidgetTemplate(Varien_Event_Observer $observer)
    {
        $block = $observer->getEvent()->getBlock();
        if ($block instanceof Mage_Adminhtml_Block_Widget_Grid) {
            // consider getting the template name from configuration
            $template = '...';
            $block->setTemplate($template);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-11-03T13:43:28.863

Magento - 覆盖 adminhtml 模板文件将以下代码添加到扩展名的 config.xml 文件（您创建）

```
 <stores>
    <admin>
        <design>
            <theme>
                <default>default</default>
                <template>rwd</template>
            </theme>
        </design>
    </admin>
</stores> 
```

现在在 adminhtml/default/rwd 包下创建 rwd 文件夹。并创建要覆盖的模板和布局文件。

就像我们想要覆盖订单评论 history.phtml 文件一样。

```
<root>\app\design\adminhtml\default\default\template\sales\order\view\history.phtml
<root>\app\design\adminhtml\default\rwd\template\sales\order\view\history.phtml 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-21T23:29:28.690

模板定义可以在这里找到

```
class Mage_Adminhtml_Block_Widget_Grid extends Mage_Adminhtml_Block_Widget 
```

在

```
public function __construct($attributes=array()) 
```

因此，如果要从销售订单网格中删除导出 csv，则需要重写销售网格块（如果您不知道如何使用本指南[http://www.magentocommerce.com/wiki/groups/174/sharing_and_customizing_magento_code](http://www.magentocommerce.com/wiki/groups/174/changing_and_customizing_magento_code)）并将 __construct 更改为

```
public function __construct($attributes=array())
{
    parent::__construct($attributes);
    $this->setTemplate('...'); //here is your template
} 
```

# android - 如何使用 Switch 等新的 API 元素，以使该应用与旧版 Android 兼容？

> ID：14448987
> 
> 赞同：0
> 
> 时间：2013-01-21T23:21:43.007
> 
> 标签：android

我想将新的 UI 元素（如 Switch）用于新的 Android 设备，而在旧设备上我会使用其他东西，如 Button。

我已经创建了布局

```
~/res/
   layout/main.xml
   layout-v14/main.xml 
```

具有不同的元素，例如 Button in`layout/main.xml`和 Switch in`layout-v14/main.xml`

但是我怎样才能在 Activity 中添加不同的元素，而不会得到 Exception 之类的

```
Could not find class 'android.widget.Switch' ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T23:34:06.657

您可以参考`Build.VERSION.SDK_INT`在运行时检查设备的 API 级别。这样，您可以在 Java 类中添加条件代码，这些代码将根据用户的 API 级别改变其行为，如下所示：

```
if ( Build.VERSION.SDK_INT >= Build.VERSION_CODES.ICE_CREAM_SANDWICH ) {
  // Some code that requires API level 14+
} else {
  // Code that will run on lower API levels instead
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T23:45:19.077

因为`Switch`您可以尝试使用该[`SwitchCompat`](https://github.com/ankri/SwitchCompatLibrary)库，以使其向后兼容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T23:54:05.363

为此，您通常在项目依赖项中包含支持库。(http://developer.android.com/tools/extras/support-library.html)

然后，您可以在旧设备上使用新对象（例如 Fragments）。

不幸的是，`Switch`不在其中……

# c# - 覆盖 DateTime.MinValue 导致问题

> ID：14448989
> 
> 赞同：3
> 
> 时间：2013-01-21T23:21:54.147
> 
> 标签：c#, .net, wcf, datetime

我们试图`DateTime.MinValue`在我们的应用程序中覆盖 ，但是通过这样做我们注意到我们的 Web 服务正在超时，下面是一个示例代码。不知道出了什么问题/我们缺少什么。

```
 public MainWindow()
 {
     //Introducing this.. Causes timeout of the webservice call...
     typeof(DateTime).GetField("MinValue").SetValue(typeof(DateTime),new DateTime(1900, 1, 1));
     var yesitworks= DateTime.MinValue;
     InitializeComponent();
     ServiceReference1.Service1Client client = new ServiceReference1.Service1Client();
     //Below call will timeout...
     var value =client.GetData(10);
} 
```

PS：这可能不是我们正在尝试解决的最佳解决方案，但现在更多的是好奇为什么它不起作用？它是如何相关的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T23:39:34.493

`DateTime.MinValue`是一个静态只读字段。这意味着库作者不会期望它发生变化，并且*可能会*编写依赖于它具有预期值的代码。

因此，**您不应更改 的值`DateTime.MinValue`。**

例如，库可以使用它作为变量的默认值：

```
private mostRecentDate= DateTime.MinValue;
foreach (var date in myDates)
{
    if (date > mostRecentDate)
    {
        mostRecentDate= date;
    }
}

// Do something with the most recent date in myDates... 
```

在此示例中，如果`myDates`仅包含早于新值的日期`DateTime.MinValue`，则此代码将设置`mostRecentDate`为`DateTime.MinValue`而不是中的最新日期`myDates`。

虽然这个相当人为的示例可能不是好的编程习惯（[例如](https://stackoverflow.com/questions/2144473/is-it-better-to-use-datetime-minvalue-or-a-nullable-datetime)，您可以使用 Nullable 代替），但它是有效的代码，如果您更改`DateTime.MinValue`.

关键是您正在使用的库也可能取决于 on 的值`DateTime.MinValue`，因此更改它可能会破坏它们。你很幸运，因为你发现这很早就引入了一个错误。如果你不走运，在你的软件上线并且遇到一些极端情况之前，你不会看到问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-27T20:06:14.157

我最近遇到了类似的问题。
您没有说明*为什么*要覆盖`DateTime.MinValue`，但我想原因与我的相似：

我有一个用 .NET 编写的服务器，它有 .NET 客户端和*（通过 COM-Interop）* MS Access 客户端。

客户端传递`DateTime`值，服务器需要检查它们是否传递了“真实”值或`DateTime.MinValue`.

我的问题是：

*   .NET`DateTime.MinValue`是今年**1月 1 日**
*   `Date`VBA类型的最小可能值是**100年 1 月 1 日**

`DateTime.MinValue`⇒当数据来自 MS Access 时，检查不起作用，因为`Date`Access 中的变量不能保存像 .NET 一样小的日期`DateTime.MinValue`。

那时我也尝试覆盖`DateTime.MinValue`，发现它不起作用。

**我的解决方案是为以下内容编写扩展方法`DateTime`：**

```
public static class DateTimeExtensions
{
    public static bool MinValue(this DateTime input)
    {
        // check the min values of .NET *and* VBA
        if (input == DateTime.MinValue || input == new DateTime(100, 1, 1))
        {
            return true;
        }

        return false;
    }
} 
```

对于您问题中的代码，它需要如下所示：

```
public static class DateTimeExtensions
{
    public static bool MinValue(this DateTime input)
    {
        if (input == new DateTime(1900, 1, 1))
        {
            return true;
        }

        return false;
    }
} 
```

用法：

```
DateTime theDate = DateTime.Now;

// vanilla .NET
bool isMin1 = (theDate == DateTime.MinValue);

// with the extension method
bool isMin2 = theDate.MinValue(); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-21T23:25:05.903

我认为你不能改变它，`DateTime` `MinValue`因为它是只读的，但如果你**不能**

约会时间：

```
public struct DateTime : IComparable, IFormattable, IConvertible, ISerializable, IComparable<DateTime>, IEquatable<DateTime>
{
    public static readonly DateTime MaxValue
    public static readonly DateTime MinValue
    .... 
```

# ajax - POST请求后的jQuery AJAX和WCF异常失败

> ID：14448992
> 
> 赞同：3
> 
> 时间：2013-01-21T23:22:10.223
> 
> 标签：ajax, json, wcf, jquery

我正在尝试从 $.ajax 查询将一些 JSON 发布到我的 WCF 服务。这是我的一组参数：

```
$.ajax(
{
 type: "POST",
 url: theurl,
 data: '{name:"Gabriel"}',
 dataType: "json",
 async:false,
 timeout: 5000,
 //success and error callbacks here... 
```

WCF 方法契约如下所示：

```
[OperationContract]
        [WebInvoke(Method = "*", 
                   RequestFormat = WebMessageFormat.Json,
                   BodyStyle = WebMessageBodyStyle.Bare,
                   UriTemplate = "/Sample/POST")]
        string postSample(Stream jsondata); 
```

WCF 在远程服务器上运行（在那里启用了跨域功能和 Access-Control-Allow-Origin）。当我使用 w3wp.exe 进行调试时，我看到 WCF 方法被命中，POST 正文是正确的，但是，在服务方法返回后，（一个简单的 JSON 或空字符串），我得到一个

```
[Exception... "Failure"...> :: line 4"  data: no] 
```

在火狐上。Safari 和 Chrome 抛出：

```
Error: NETWORK_ERR: XMLHttpRequest Exception 101 
```

我正在使用 VS2010 和 jQuery 1.7.xx

知道我做错了什么吗？任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T16:02:38.597

我已经找到了解决方案：我刚刚在 WCF 方法的开头添加了下一行：

```
WebOperationContext.Current.OutgoingResponse.Headers.Add("Access-Control-Allow-Origin", "*") 
```

它就像一个魅力。谢谢大家！

# actionscript-3 - 在不使用静态或全局的情况下从其他类访问变量

> ID：14448993
> 
> 赞同：0
> 
> 时间：2013-01-21T23:22:21.817
> 
> 标签：actionscript-3, class, variables

我试图从一个类获取一个数组到另一个类，但我不能使用静态或全局变量。

在我的班级 Jeu.as 中，我有 3 个数组（t_map1、t_map2 和 t_map3）代表我的游戏地图。t_map 是一个数组，可以包含其中一个地图以及我可以更改它的位置。我想将地图使用（表格 t_map）带到我的角色（Perso.as），这样它就可以知道它可以在哪里行走。

问题是我不知道如何将**t_map**从**Jeu.as**带到**Perso.as** ...我尝试使用静态变量（如其他答案所示）但它不起作用，因为地图必须改变...

如何在我的**perso.as**类中创建一个可以包含我的数组的变量？

简而言之，我想将**t_map**值从我的**jeu.as带到****perso.as**中的另一个变量

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T23:40:42.283

听起来你需要一些简单的访问器。

在`Jeu`中，您需要一些东西来检索这样的地图：

```
function getMap(mapNumber:int):Array
{
    switch(mapNumber)
    {
        case 1:
            return t_map1;
        case 2:
            return t_map2;
        case 3:
            return t_map3;
        default:
            trace("Error: that's not a valid map number!")
    }
} 
```

如果您将地图保存在另一个包含`Array`（让我们称之为`allTheMaps`）中，该函数看起来会更好：

```
function getMap(mapNumber:int):Array
{
    allTheMaps[mapNumber];
} 
```

然后在 中`Perso`，您需要存储一个数组的引用（如果需要同时了解多个地图，则需要几个）来存储地图。您还需要一个函数来设置数据：

```
var theMap:Array;

function setMap(theMap:Array):void
{
    myMap = theMap;
} 
```

现在您可以将映射从 的实例传递`Jeu`到 的实例`Perso`：

```
var Jeu = new Jeu();
var Perso = new Perso();
...
Perso.setMap(Jeu.getMap(1)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T02:10:34.110

您真正需要做的就是给两个实例一个对相同数组的引用，或者给 Perso 一个对 Jeau 的引用。静态变量是一个[非常糟糕的主意](http://misko.hevery.com/code-reviewers-guide/flaw-brittle-global-state-singletons/)，即使这种情况没有任何内在因素会阻止它们为您工作。

下面是使用[依赖注入](http://www.codeproject.com/Articles/13831/Dependency-Injection-for-Loose-Coupling)的解决方案的样子：

```
package model {
   public class Jeau extends EventDispatcher {

      protected var _tMap1:Array = new Array();
      protected var _tMap2:Array = new Array();
      protected var _tMap3:Array = new Array();
      //consider using more descriptive variable names
      //or an array of arrays (one map in each index)
      public function get tMap1():Array {
         return _tMap1;
      }
      public function set tMap1(value:Array):void {
         if (value != _tMap1) {
            _tMap1 = value;
            dispatchEvent(new Event('tMap1Changed'));
         }
      }
      public function get tMap2():Array {
         return _tMap2;
      }
      public function set tMap2(value:Array):void {
         if (value != _tMap2) {
            _tMap2 = value;
            dispatchEvent(new Event('tMap2Changed'));
         }
      }
      public function get tMap3():Array {
         return _tMap3;
      }
      public function set tMap3(value:Array):void {
         if (value != _tMap3) {
            _tMap3 = value;
            dispatchEvent(new Event('tMap3Changed'));
         }
      }
      protected function somethingThatChangesMap1(index:int, value:String):void {
         _tMap1[index] = value;
         dispatchEvent(new Event('tMap1Changed'));
      }
   }
} 
```

我假设这是一个 View 类——你没有给出很多细节。您侦听来自模型类的事件，然后根据这些数组中的任何内容更新视图。通过获取整个实例，您可以监听这些事件。否则，您必须使用其他机制来传达更改（例如 Ro [enter link description here](http://www.robotlegs.org/) botLegs 中使用的事件总线）。

```
package view {
   class Perso extends MovieClip {
       protected var jeau:Jeau;
       public function get jeau():Jeau {
          return _jeau;
       }
       public function set jeau(value:Jeau):void {
          if (value != _jeau) {
             _jeau = value;
             _jeau.addEventListener('map1Changed', doMap1Stuff);
             _jeau.addEventListener('map2Changed', doMap2Stuff);
             _jeau.addEventListener('map3Changed', doMap3Stuff);
             doMap1Stuff();
             doMap2Stuff();
             doMap3Stuff();
          }
       }
       protected function doMap1Stuff(e:Event=null) {
          //do actions depending on the state of map1 here
       }
       protected function doMap2Stuff(e:Event=null) {
          //do actions depending on the state of map2 here
       }
       protected function doMap3Stuff(e:Event=null) {
          //do actions depending on the state of map3 here
       }

   }
} 
```

这只是您如何使用第三个类来组合前两个类的示例。我不一定会这样做：

```
package control {
   public class MainGame {
      protected var jeau:Jeau;
      protected function perso:Perso;
      public function MainGame() {
         jeau = new Jeau();
         //jeau setup
         perso = new Perso();
         perso.jeau = jeau;
      }
   }

} 
```**

# javascript - JavaScript & HTML5 - 向鼠标旋转字符

> ID：14448995
> 
> 赞同：1
> 
> 时间：2013-01-21T23:22:25.477
> 
> 标签：javascript, html, rotation, mouse

我的画布中间有一个图像，我希望能够将它旋转到我的鼠标在画布上的位置。

我的鼠标位置有变量，我已经将我的图像放在一个矩阵中，所以它目前在中心以给定的值完美地旋转，现在我只需要将两者连接起来。

```
var characterRotation = 0;

function characterController(){

    ctxMain.clearRect(0, 0, gameWidth, gameHeight);

    var charWidth = 65;
    var charHeight = 85;

    var srcX = 0;
    var srcY = 619;
    var drawX = gameWidth/2 - charWidth/2;
    var drawY = gameHeight/2 - charHeight/2;

    ctxMain.setTransform(1, 0, 0, 1, drawX, drawY);
    ctxMain.rotate(characterRotation * Math.PI/180);

    characterRotation = mouseX*2 / mouseY*2; // ?? this is what needs to roate my character

    ctxMain.drawImage(imgSprite, srcX, srcY, charWidth, charHeight, -charWidth/2, -charHeight/2, charWidth, charHeight);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T00:03:10.400

从 trig，您正在寻找的角度将是

```
sin( rotation ) = y / (x^2 + y^2)  # opposite/adjacent 
```

但首先你需要确保你的坐标是居中的，所以从 mouseX 和 mouseY 中减去游戏宽度的一半，然后使用上面得到

```
rotation = Math.asin( y / (x*x + y*y) 
```

# c# - 在 WPF 中的路径段之间渲染点？

> ID：14448998
> 
> 赞同：1
> 
> 时间：2013-01-21T23:22:31.737
> 
> 标签：c#, wpf, shape

我有一个数据模板（如下），用于在我的应用程序中绘制一些路径。路径由线段和弧段组成，绘制得很好。我想知道是否有某种方法可以绘制标记路径段边界的小点或分隔符。我将如何修改模板来做到这一点？

我可以将段端点公开为它自己的集合，但我不确定如何将其绑定到点对象的渲染。

```
 <DataTemplate x:Key="assignmentTemplate" DataType="models:AssignmentViewModel">
        <DataTemplate.Resources>
            <Converters:MultiplyConverter x:Key="multiplier"/>
        </DataTemplate.Resources>
        <Path Stroke="Yellow" StrokeThickness="{Binding RelativeSource={RelativeSource FindAncestor,AncestorType={x:Type Composition:IWorldAndScreen}}, Path=MetersPerPixel,
                Converter={StaticResource multiplier}, ConverterParameter=2.0}" StrokeLineJoin="Bevel" StrokeEndLineCap="Square" StrokeStartLineCap="Square">
            <Path.Data>
                <PathGeometry Figures="{Binding Figures}"/>
            </Path.Data>
        </Path>
    </DataTemplate> 
```