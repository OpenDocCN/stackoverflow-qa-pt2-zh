# StackOverflow 问答 15536000-15536999

# c++ - 避免内存泄漏

> ID：15536003
> 
> 赞同：2
> 
> 时间：2013-03-20T22:27:14.717
> 
> 标签：c++, oop, memory, memory-leaks

所以我在 C++ 中学习 OOP，我认为编写自己的字符串类是一个好习惯（当然是为了学习目的）。我想出了一个我不知道如何解决的问题。这是一些和平的代码：

```
class String {
    char *str;
public:
    String(char const *str);
    ~String();
    String operator + (char const *str);
};

String::String(char *str) {
    this->str = _strdup(str);
}

String::~String() {
    free(this->str);
}

String String::operator+(char const *str) {
    char *temp = (char *) malloc(strlen(str) + strlen(this->str) + 1);
    strcpy(temp, this->str);
    strcat(temp, str);
    return temp;
} 
```

这里的问题是，这段代码会导致内存泄漏。从“operator +”返回调用我的构造函数，它通过分配更多内存来复制 temp，但我找不到任何方法可以释放它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T22:33:52.773

你`operator +`被定义为返回 a`String`但你返回的是 a`char*`这意味着编译器正在使用构造函数隐式转换它。这会复制字符串，但不会释放您因此泄漏的原始字符串。

正如其他人所建议的那样，您可以做很多事情来改进代码，但是要修复实际的泄漏，您可以这样做：

```
String String::operator+(char const *str) {
    char *temp = (char *) malloc(strlen(str) + strlen(this->str) + 1);
    strcpy(temp, this->str);
    strcat(temp, str);
    String strTmp(temp);
    free(temp);
    return strTmp;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T22:33:53.553

如果你想把它做好，编写一个字符串类并不是一件简单的事情。对于您面临的特定问题，我可以提出一些建议......

实现`append()`或`operator+=`创建更大的缓冲区复制内容，交换内部缓冲区和新创建的缓冲区并释放旧缓冲区。

那么`operator+`就变成了一个微不足道的任务：

```
String operator+(String lhs, String const & rhs) {
   lhs += rhs;                 // lhs.append(rhs);
   return lhs;
} 
```

(Of course, this is assuming that you provide correct definitions of the copy constructor, and assignment operator)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T22:31:27.273

您忘记实现 operator= 和复制构造函数。如果您不提供自己的，编译器将为您实现它们，以执行成员明智的复制，这会导致您的内存泄漏。

# .htaccess - 使用 htaccess 的双重 RewriteRule

> ID：15536007
> 
> 赞同：0
> 
> 时间：2013-03-20T22:27:39.883
> 
> 标签：.htaccess, mod-rewrite, rewrite

我的规则有问题；我把两者都放了，但只适用于第一个。

我有 2 个包含不同信息的文件。

```
RewriteRule ^([A-Za-z0-9-]+)/?$ tour.php?tour=$1 [NC,L]
RewriteRule ^([A-Za-z0-9-]+)/?$ programa.php?programa=$1 [NC,L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:56:37.607

只有第一个有效，因为您用来匹配的模式完全相同：`^([A-Za-z0-9-]+)/?$`. 您需要其他东西来区分**tour.php**的内容和**programa.php**的内容。现在，如果有人在`http://youdomain.com/abcdefg/`浏览器的 URL 地址栏中输入内容，URI`/abcdefg/`就会发送到您的服务器。第一条规则：

```
RewriteRule ^([A-Za-z0-9-]+)/?$ tour.php?tour=$1 [NC,L] 
```

匹配，因为`/abcdefg/`匹配您的模式`^([A-Za-z0-9-]+)/?$`并且它被重写为`/tour.php?tour=abcdefg`. 如果这意味着**programa.php**怎么办？永远不会达到第二条规则，因为所有内容都被第一条规则的模式捕获。您需要添加其他东西来区分两者。例如，添加一个额外的路径注释：

```
RewriteRule ^tour/([A-Za-z0-9-]+)/?$ tour.php?tour=$1 [NC,L]
RewriteRule ^programa/([A-Za-z0-9-]+)/?$ programa.php?programa=$1 [NC,L] 
```

这意味着如果我去`http://youdomain.com/programa/abcdefg/`，我的请求被重写`/programa.php?programa=abcdefg`，如果我去`http://youdomain.com/tour/abcdefg/`，我的请求被重写`/tour.php?tour=abcdefg`。

# django - django - render_to_response - 渲染了一些东西

> ID：15536011
> 
> 赞同：-1
> 
> 时间：2013-03-20T22:27:50.150
> 
> 标签：django, templates, django-templates, django-views

这是一个非常简单的问题，但我就是想不通。

我有获取一行然后在其上调用 render_to_response 的视图。但是我想在模板中添加一些其他的东西来显示，这些东西不是来自数据库。我只是无法弄清楚如何做到这一点，而且我在文档中找不到任何涵盖这种情况的内容。

如果我只是传递数据库获取的结果，一切都会正常工作——表单会被渲染等等。一旦我介绍了一些其他的东西，我要么得到 500（如下例所示），要么完全被忽略。

*（我在下面显示的示例中正在处理的东西是 django 教程 'polls' 应用程序的一种突变，所以如果某些命名看起来有点奇怪，我们深表歉意）*

**看法**

除了 BookMark 对象，我还添加了一些任意数据，在我的示例中是字符串“测试标题”。

```
def detail(request, bookmark_id):
    try:
        b = BookMark.objects.get(pk=bookmark_id)
        d = {'title' = 'test title'}
    except Poll.DoesNotExist:
        raise Http404
    return render_to_response(  'bookmarks/bookmark_detail.html',
            {'bookmark': b, 'title': d},
                                context_instance=RequestContext(request)) 
```

**基本模板**

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>{% block title %}Default Title from base.html{% endblock %}</title>
    </head>
    <body>
        <div id="topstuff">
            <h1>This is top stuff</h1>
        </div>
        <div id="content">
            {% block content %}{% endblock %}
        </div>
        <div id="bottomstuff">
            <h1>This is bottom stuff</h1>
        </div>
    </body>
</html> 
```

**内部模板**

```
{% extends "base.html" %}

{{ bookmark }}

{% block title %}{{ title.title }}{% endblock title %}

{% block content %}

    <h1>{{ poll.question }}</h1>

    {% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

    <form action="/polls/{{ poll.id }}/vote/" method="post">
        {% csrf_token %}
        <table>
            <tr>
                <td>URL:</td>
                <td><input type="text" name="url" id="url" value="{{ bookmark.url }}" /></td>
            </tr>
            <tr>
                <td>TITLE:</td>
                <td><input type="text" name="title" id="title" value="{{ bookmark.title }}" /></td>
            </tr>
            <tr>
                <td>NOTES:</td>
                <td><input type="text" name="notes" id="notes" value="{{ bookmark.notes }}" /></td>
            </tr>
        </table>
        <input type="submit" value="Submit" />
    </form>

{% endblock content%} 
```

* * *

**编辑：** 正如评论中指出的那样，我在那里有一个错字，所以为了未来的搜索者，以下两种方法中的任何一种都有效：

***选项 1*** 将值直接嵌入到传递给 render_to_response 的字典中，如下所示

```
return render_to_response(  'bookmarks/bookmark_detail.html',
        {'bookmark': b, 'title':'test title1'},
    context_instance=RequestContext(request)) 
```

在模板中引用该值，如下所示：

```
{% block title %}{{ title }}{% endblock title %} 
```

***选项2*** 创建一个容器字典来保存其他值，然后将其嵌入到传递给 render_to_response 的字典中，如下所示

```
d = {'title':'test title 2'}
return render_to_response(  'bookmarks/bookmark_detail.html',
        {'bookmark': b, 'title':d},
    context_instance=RequestContext(request)) 
```

在模板中引用该值，如下所示：

```
{% block title %}{{ title.title }}{% endblock title %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T09:08:29.427

正如评论中指出的那样，我在那里有一个错字，所以为了将来的搜索者，以下两种方法中的任何一种都有效：

***选项 1*** 将值直接嵌入到传递给 render_to_response 的字典中，如下所示

```
return render_to_response(  'bookmarks/bookmark_detail.html',
        {'bookmark': b, 'title':'test title1'},
    context_instance=RequestContext(request)) 
```

在模板中引用该值，如下所示：

```
{% block title %}{{ title }}{% endblock title %} 
```

***选项2*** 创建一个容器字典来保存其他值，然后将其嵌入到传递给 render_to_response 的字典中，如下所示

```
d = {'title':'test title 2'}
return render_to_response(  'bookmarks/bookmark_detail.html',
        {'bookmark': b, 'title':d},
    context_instance=RequestContext(request)) 
```

在模板中引用该值，如下所示：

```
{% block title %}{{ title.title }}{% endblock title %} 
```

# c - 将字符串读取到 char 数组，然后获取字符串的大小

> ID：15536014
> 
> 赞同：1
> 
> 时间：2013-03-20T22:28:02.807
> 
> 标签：c, arrays, pointers, char, stdin

我正在做一个项目，我对这部分感到困惑。

我需要从标准输入读取单词并将它们放在一个 char 数组中，并使用一个指针数组指向每个单词，因为它们将是锯齿状的。其中 numwords 是一个 int 读入，表示单词的数量。

```
 char words[10000];
    char *wordp[2000]; 
```

问题是我只能使用指针添加单词。我不能再使用 [] 来帮助。

```
 *wordp = words; //set the first pointer to the beginning of the char array. 
    while (t < numwords){
      scanf("%s", *(wordp + t))  //this is the part I dont know
      wordp = words + charcounter; //charcounter is the num of chars in the prev word
      t++;
    }

    for(int i = 0;words+i != '\n';i++){
      charcounter++;
    } 
```

任何帮助都会很棒，当涉及到指针和数组时，我很困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:03:48.600

如果您使用额外的指针引用并直接增加它，您的代码将更易于管理。这样你就不必做任何心算。此外，您需要在读取下一个字符串之前增加引用，`scanf`不会为您移动指针。

```
char buffer[10000];
char* words[200];

int number_of_words = 200;
int current_words_index = 0;

// This is what we are going to use to write to the buffer
char* current_buffer_prt = buffer;

// quick memset (as I don't remember if c does this for us)
for (int i = 0; i < 10000; i++)
    buffer[i] = '\0';

while (current_words_index < number_of_words) {

    // Store a pointer to the current word before doing anything to it
    words[current_word_index] = current_buffer_ptr;

    // Read the word into the buffer
    scanf("%s", current_buffer_ptr);

    // NOTE: The above line could also be written
    // scanf("%s", words[current_word_index]);

    // this is how we move the buffer to it's next empty position.
    while (current_buffer_ptr != '\n') 
        current_buffer_ptr++;

    // this ensures we don't overwrite the previous \n char
    current_buffer_ptr++;

    current_words_index += 1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:04:30.450

你想做的事情相对简单。你有一个 10,000 `char`s 的存储数组和 2000 个指针。因此，首先您需要将第一个指针分配给数组的开头：

```
wordp[0] = &words[0]; 
```

在指针形式中，这是：

```
*(wordp + 0) = words + 0; 
```

我用零来展示它与数组的关系。通常，将每个指针设置为每个元素：

```
*(wordp + i) == wordp[i]
words + i    == &words[i] 
```

所以你需要做的就是跟踪你在指针数组中的位置，只要你分配正确，指针数组就会跟踪你`char`数组中的位置。

# visual-studio-2008 - 创建带有连接点的简单 atl 对象 未生成火方法

> ID：15536018
> 
> 赞同：0
> 
> 时间：2013-03-20T22:28:23.547
> 
> 标签：visual-studio-2008, visual-c++, com, atl

我在 Visual Studio 2008 中创建了 ATL dll 项目，它生成了以下类...

template <class T>
class CProxy_IAutomateEvents : public IConnectionPointImpl<T, &__uuidof( _IAutomateEvents ), CComDynamicUnkArray>
{
//警告此类将由向导重新生成。
公开：
};

我在 idl 中的 IAutomateEvents 调度接口中添加了方法并重新编译。我不知道如何让它生成 Fire_ 方法。它在说哪个巫师？我不想手动执行此操作，因为如果在某个时候运行所述向导，我可能会以可能已过时或被替换的方式执行此操作。我发现所有关于右键单击类并选择添加连接点的东西，但该选项没有显示。帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T06:05:29.873

当您更新事件接口时，代理类不会自动更新，因此当您完成更改后，您需要重新生成代理类，以便在其上出现新的方法。

要重新生成代理类，请打开项目的类视图，然后找到您的类并通过上下文菜单选择添加、添加连接点。不用担心已经实现的连接点，只要像第一次一样添加它。您的类将被更新，具有事件生成方法的代理类也将被更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:43:51.853

没关系。我的类视图包括一个类以及名为 IAutomate 的接口。那就是我右键单击不支持添加连接点的内容。我终于注意到 CAutomate 类并右键单击它，选择添加连接点，然后点击完成，我的所有 Fire_ 功能现在都已实现。对不起，如果我浪费了任何人的时间。

# ios - 获取请求模板 - 获取所有对象

> ID：15536024
> 
> 赞同：0
> 
> 时间：2013-03-20T22:28:57.893
> 
> 标签：ios, objective-c, core-data

我开始使用获取请求模板，所以会尽力解释。请询问是否需要更多详细信息。

我创建了一个获取请求模板： ![在此处输入图像描述](../Images/f39dddef09bd1f7c0f5b0b962bf5af95.png)

并尝试使用以下方法打印所有对象：

```
 - (void)printOfflineActivities 
{
    EntityManager* entityManager = [[EntityManager alloc] init];
    ActivityFetcher *activityFetcher = [[ActivityFetcher alloc] initWithEntityManager:entityManager];
    Activity *activity = [activityFetcher activitiesOffline:[NSNumber numberWithBool:YES]];

    NSLog(@"printing..%@",activity.name);
} 
```

活动离线代码是

```
- (Activity*)activitiesOffline:(NSNumber*)offline 
{
    NSDictionary* variables = [NSDictionary dictionaryWithObject:offline forKey:OfflineTemplatePlaceholder];
    NSFetchRequest* request = [entityManager fetchRequestFromTemplateWithName:ActivityOffline substitutionVariables:variables];
    Activity* activity = [entityManager entityForFetchRequest:request];

    return activity;
} 
```

但这仅打印出最后一个值。我不确定如何打印满足条件/表达式的所有活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T07:24:19.807

1.  获取请求模板应如下所示（**变量用 $ 表示（例如 $VARIABLE_NAME）**）： ![在此处输入图像描述](../Images/07538bb6961e0fba16ae511f70894032.png)

2.  从模型中检索必要的获取请求，如下所示：

    ```
    NSFetchRequest* request = [self.managedObjectContext.persistentStoreCoordinator.managedObjectModel fetchRequestFromTemplateWithName:@"ActivityOffline" substitutionVariables:@{@"ANY_VARIABLE_NAME":offline}]; 
    ```

# jquery - 使用前一页链接中的 rel 值突出显示动态文本

> ID：15536027
> 
> 赞同：0
> 
> 时间：2013-03-20T22:29:04.997
> 
> 标签：jquery, text, highlight, rel

这可能是不可能的，但无论如何我都会把它扔掉。我想要一种突出显示文本的方法，以便当您从链接访问页面时，jQuery 将使用链接中的 rel 属性（或其他标识符）突出显示特定文本。

例如，假设我有一个活动注册网站，并且有一个“演讲者”部分，它将在整个活动期间的各种研讨会上进行演讲。然后是一个单独的页面，其中包含演讲者演讲时间的日历。

演讲者的姓名和照片链接到基于表格的日历。到目前为止，我只能使用包含相应时隙的表格行中的 id 将演讲者的图片和姓名链接到日历页面上的表格行。

问题是有时一个扬声器会与其他扬声器混为一谈，或者他们的表格行太靠近底部，因此浏览器窗口不会与它完全对齐。可读性下降或名称在混乱中丢失。

我试图弄清楚如何根据用户在“演讲者”部分点击的演讲者在议程表中突出显示演讲者的姓名。这样，如果浏览器窗口未对齐，则名称将可见，并且用户不必扫描它。

有什么建议么？我很感激任何事情，我对 jQuery 比较熟悉。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:52:39.663

因此，首先您需要确保每个扬声器链接都具有以下格式：

`<a href="/speaker/12?s=speaker_name>Speaker Name</a>` 这里重要的部分是： ***?s=speaker_name***

完成排序后，进入 /speaker/12 页面，您需要拥有以下变量：

```
var pathname = window.location.pathname; //will return the full url
var speakerName = pathname.split('s='); //will split the the url into 2 elements 
```

现在确保每个扬声器名称都有一个与扬声器名称等效的类的跨度，最后是一个简单的 jQuery 命令：

```
$('.'+speakerName[1]).css('background',#F00); 
```

因此，假设您要突出显示**Tom Sawyer**

1.  我们将获得网址：[http](http://example.com/speakers?s=Tom_Sawyer) ://example.com/speakers?s=Tom_Sawyer然后在

2.  这个 url 我们将跨越带有 Tom_Sawyer 类的标签，如下所示：`<span class="Tom_Sawyer">Tom_Swayer</span>`

3.  最后我们运行 jQuery： `$('.'+speakerName[1]).css('background',#F00);`

# c - 让我确保我了解 C pthread mutex

> ID：15536028
> 
> 赞同：0
> 
> 时间：2013-03-20T22:29:12.587
> 
> 标签：c, pthreads, mutex

我有一个全局变量`flag`、一个函数`this()`和一个函数`that()`。现在，`main()`和`this()`所有人`that()`都有需要阅读和/或写作的场合`flag`。要正确使用互斥锁，我需要：

1.  声明一个`pthread_mutex_t`并初始化它。
2.  `this()`为and`that()`和它们创建线程，`pthread_join()`因为我想在退出之前`main()`等待`this()`并`that()`完成。
3.  代码中的任何位置，无论是`main()`、`this()`还是`that()`，在哪里`flag`被读取或写入，调用`pthread_mutex_lock()`然后 [read/write]`flag`然后调用`pthread_mutex_unlock()`

那是对的吗？

我不打算这样做，但如果我想像这样检查`flag`无限循环`main()`：

```
 while(flag != value)
        continue; 
```

`lock()`您和互斥体以及其他线程会在哪里`unlock()`有机会访问`flag`并`main()`不断地在它上面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:42:43.313

1 - 2 - 3 - 正确。

现在，如果你写那个循环，那么

*   由于3，主线程将持有锁，而其他线程将无法获取锁，因此实际上，您创建了一个无限循环。
*   如果您不锁定，则它可能无法正常工作，这取决于 CPU 架构（首先，`flag`需要可原子更新，并且其他内核需要看到这些更改。并非所有架构都保证这一点）。即使它有效，它仍然是一个繁忙的等待循环，不应该使用。

正如 Ben 在他的评论中指出的那样，您想使用条件变量来发出信号（注意：[Pthread 和等待条件](https://stackoverflow.com/questions/1136371/pthread-and-wait-conditions)）

> 你会在哪里锁定（）和解锁（）互斥锁

作为一个经验法则，为了尽量减少争用，保持锁尽可能短。这可以像 lock+read+unlock 一样简单，但是如果以下操作序列取决于标志不应更改的事实，则根据需要保持锁定。

# debugging - Windows 8 Phone 上的 USB 远程调试

> ID：15536029
> 
> 赞同：4
> 
> 时间：2013-03-20T22:29:24.827
> 
> 标签：debugging, usb, windows-phone-8, remote-debugging

我想测试我的 Windows 8 手机应用程序。我想将其插入台式计算机并在桌面上查看 JavaScript 控制台输出。我可以在 Visual Studio 中调试应用程序本身，但我想查看 JavaScript 控制台输出。这可能吗？我知道你可以用安卓手机做到这一点

[https://developers.google.com/chrome-developer-tools/docs/remote-debugging#enable-usb-debugging](https://developers.google.com/chrome-developer-tools/docs/remote-debugging#enable-usb-debugging)

但是 Windows 8 手机呢？以前版本的 windows phone 呢？不同版本的 iOS 怎么样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T11:22:03.907

在 Windows Phone 8 上无法执行此操作。

没有关于未来版本中可能发生什么的信息。

不幸的是，您必须在页面上显示您的输出才能在实际设备上调试网页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-10T17:15:50.597

您可以使用[WEINRE](http://people.apache.org/~pmuellr/weinre/docs/latest/) (WEB INspector REmote)。它适用于所有平台，而且是免费的。

这记录在[Channel9上](http://channel9.msdn.com/Blogs/Interoperability/Use-weinre-WP8-and-IE10-to-debug-your-mobile-HTML5-page-remotely)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-04T20:16:18.523

启动 Visual Studio 并按 Ctrl + Shift + P（或导航到调试 > 其他调试目标 > 调试 Windows Phone Internet Explorer）。

# winapi - 用 EM_GETCHARFORMAT 结果覆盖 CHARFORMAT2 结构似乎会破坏它，没有显示格式

> ID：15536031
> 
> 赞同：0
> 
> 时间：2013-03-20T22:29:29.957
> 
> 标签：winapi, text-formatting, richedit

创建新的 CHARFORMAT2W 并使用它没有问题，但随后用 Richedit 控件的格式覆盖它似乎会损坏结构，因此无法应用回来。但不会产生错误。

```
#include <iostream>
#include <windows.h>
#include <richedit.h>

int main() {
  using namespace std;
  LoadLibrary("Msftedit.dll");
  HWND richeditWindow = CreateWindowExW (
    WS_EX_TOPMOST,
    L"RICHEDIT50W", 
    L"window text",
    WS_SYSMENU | WS_VSCROLL | ES_MULTILINE | ES_NOHIDESEL | WS_VISIBLE,
    50, 50, 500, 500,
    NULL, NULL, NULL, NULL
  );

  GETTEXTLENGTHEX gtl;
  gtl.flags = GTL_NUMCHARS;
  gtl.codepage = 1200;
  int text_len = SendMessageW(richeditWindow, EM_GETTEXTLENGTHEX, (WPARAM)&gtl, (LPARAM)NULL);
  CHARRANGE cr = {text_len,text_len};
  SendMessageW(richeditWindow, EM_EXSETSEL, 0, (LPARAM)&cr);
  static CHARFORMAT2W cf;
  memset( &cf, 0, sizeof cf );
  cf.cbSize = sizeof cf;
  cf.dwMask = CFM_COLOR | CFM_BACKCOLOR;
  SetLastError(0);
  // disabling this line causes text to be colored
  SendMessageW(richeditWindow, EM_GETCHARFORMAT, SCF_SELECTION, (LPARAM)&cf);
  if (GetLastError()) {
    printf("EM_GETCHARFORMAT failed: %ld", GetLastError());
  }
  cf.crTextColor = RGB(255,0,0);
  cf.crBackColor = RGB(233,233,0);
  if (!SendMessageW(richeditWindow, EM_SETCHARFORMAT, SCF_SELECTION, (LPARAM)&cf)) {
    printf("EM_SETCHARFORMAT failed: %ld", GetLastError());
  }
  SendMessageW(richeditWindow, EM_REPLACESEL, FALSE, (LPARAM) L"... some more text, should be colored");

  MSG msg;
  while( GetMessageW( &msg, richeditWindow, 0, 0 ) ) {
    TranslateMessage(&msg);
    DispatchMessageW(&msg);
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T09:38:21.723

你误解了它的[`EM_GETCHARFORMAT`](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb788026.aspx)工作原理。它不响应`dwMask`您传递的结构中的值。相反，它会尽可能多地填充结构。[文档](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb788026.aspx)说：

> dwMask 成员指定哪些属性在整个选择中是一致的。

这意味着**富编辑控件**将分配给`dwMask`指定哪些属性是一致的值。

So, you need to completely re-initialize the struct before you make the subsequent call to `EM_SETCHARFORMAT`.

# c# - 如何在 .NET 字符串中使用系统\环境变量？

> ID：15536033
> 
> 赞同：5
> 
> 时间：2013-03-20T22:29:34.210
> 
> 标签：c#, windows, environment-variables, system-variable

我有从我的 appsettings 获得的路径变量：

```
var path="%TEMP%\myapplication\data"; 
```

我正在尝试在`Directory.CreateDirectory(path)`方法中使用它。但是我在我的应用程序*bin*文件夹中找到了新文件夹，而不是*C:\Users\Evgeny\AppData\Local\Temp\myapplication\data*。

我应该`%TEMP%`手动更换吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-20T22:39:24.737

[`System.Environment.ExpandEnvironmentVariables`](http://msdn.microsoft.com/en-us/library/system.environment.expandenvironmentvariables.aspx)像这样使用：

```
String concretePath = Environment.ExpandEnvironmentVariables(@"%TEMP%\myapplication\data"); 
```

# javascript - div 移动时不跟随拖动条

> ID：15536037
> 
> 赞同：0
> 
> 时间：2013-03-20T22:29:56.263
> 
> 标签：javascript

我试图向 div 添加拖动手柄，但 div 不移动，只是手柄。

但是，如果我将位置更改为应该移动的 div 的绝对位置，我实际上可以在 div 周围移动，但可以从任何地方移动，而不仅仅是拖动手柄。

有小费吗 ？我为此创建了一个jsfiddle。

[http://jsfiddle.net/dymond/tQdFZ/11/](http://jsfiddle.net/dymond/tQdFZ/11/)

一些代码。

```
var draggable = document.getElementsByClassName('hand'),
        draggableCount = draggable.length,
        i, currZ = 1;
    function startDrag(evt) {

        var diffX = evt.clientX - this.offsetLeft,
            diffY = evt.clientY - this.offsetTop,
            that = this;
        this.style.opacity = "0.5";
        this.style.zIndex = currZ++;

        function moveAlong(evt) {
            that.style.left = (evt.clientX - diffX) + 'px';
            that.style.top = (evt.clientY - diffY) + 'px';
        }
        function stopDrag() {
            document.removeEventListener('mousemove', moveAlong);
            document.removeEventListener('mouseup', stopDrag);
            changeClass()
        }
        function changeClass() {
            var diceClass = document.getElementsByClassName("hand");
            for (var i = 0; i < diceClass.length; i++) {
                diceClass[i].style.opacity = "1";
            }
        }

        document.addEventListener('mouseup', stopDrag);
        document.addEventListener('mousemove', moveAlong);
    }

    for (i = 0; i < draggableCount; i += 1) {
        draggable[i].addEventListener('mousedown', startDrag);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:24:44.033

尝试设置css：

```
.draggable { position: absolute; ... 
```

并更改js：

```
function moveAlong(evt) {
    that.parentNode.style.left = (evt.clientX - diffX) + 'px';
    that.parentNode.style.top = (evt.clientY - diffY) + 'px';
} 
```

既然你想移动父节点，通过拖动手柄..

# delphi - 如何解决 TWebBrowser Post 数据的问题？

> ID：15536038
> 
> 赞同：1
> 
> 时间：2013-03-20T22:29:56.877
> 
> 标签：delphi, delphi-xe, twebbrowser

我在使用 TWebBrowser 导航并将数据发布到 Web 服务器时遇到问题。

发生的情况是，当我最初设置帖子数据并导航到页面时，所有信息都可以正常传递。填写一些信息并单击按钮处理请求后，服务器尝试处理请求，但一切都冻结了..

![在此处输入图像描述](../Images/f341018e154e52aafa66291446528f01.png)

在这个屏幕上.. 奇怪的是，在我尝试了大约 30 次之后，它成功了。（没有冻结就通过了）所以我不确定是什么导致了不一致。

现在，如果我生成此数据并通过获取请求将其发送到服务器，只需将所有内容都放在链接中，它每次都可以工作。在 Chrome IE 等上。

我认为问题可能出在发布数据上，所以我尝试使用 TWebBrowser 发出获取请求，但它仍然冻结在我身上。

```
Browser.WebBrowser1.Navigate('https://test.com/ts/testAPI.asmx/Process?'+EncodedDataString); 
```

同样在**TWebBrowser**中- 如果我点击重新开始按钮，该按钮会清除大部分发布/获取数据，然后将其全部输入我自己，然后处理它每次都可以正常工作的信息而不会冻结。

所以我唯一能想到的是，冻结似乎只发生在通过 TWebBrowser 发送 post/get 数据时......但是在没有发送数据时在 TWebBrowser 上工作。

我假设服务器在冻结时尝试运行某种 jquery 或 javascript，但我不确定。

下面是我的代码供参考。

```
EncodedDataString := 'username='+FileForm.Firm.FieldByName('USER').AsString+
'&password='+FileForm.Firm.FieldByName('PASS').AsString+'&action='+action+
'&token='+eToken+'&retname='+HTTPEncode(MaskEditRetName.Text)+
'&retaddress1='+HTTPEncode(MaskEditRetAddr.Text)+
'&retcity='+HTTPEncode(MaskEditRetCity.Text)+
'&retstate='+HTTPEncode(MaskEditRetState.Text)+
'&retzip='+HTTPEncode(MaskEditRetZip.Text)+
'&accountno='+HTTPEncode(MaskEditAccount.Text)+
'&amount='+HTTPEncode(MaskEditAmount.Text)+
'&date='+HTTPEncode(MaskEditDate.Text)+
'&paymenttype='+HTTPEncode(paymentType);

PostData := VarArrayCreate([0, length(EncodedDataString)-1], varByte);

for i := 1 to length(EncodedDataString) do
PostData[i-1] := ord(EncodedDataString[i]);

Headers := 'Content-type: application/x-www-form-urlencoded'#10#13;

Application.CreateForm(TBrowser,Browser);

Browser.WebBrowser1.Silent := True;

Browser.WebBrowser1.Navigate('https://test.com/ts/testAPI.asmx/Process',
     EmptyParam, EmptyParam, PostData, Headers); 
```

# sql - 通用递归 sql 查询

> ID：15536039
> 
> 赞同：1
> 
> 时间：2013-03-20T22:29:59.690
> 
> 标签：sql, database, oracle

如果有一个表，它有 2 列，ParentId 和 ChildId，并且可能有多个级别，如下表

```
ParentId    ChildId
   -1             1
   -1             2
    1             3
    3             4
    4             5 
```

如果孩子没有父母，则用-1表示。

现在，如果我需要说 5 的最顶层的父级，那么它的父级是 4，其父级是 3，其父级是 1。所以 1 是其父级 = -1 的答案。

我在[Sql server CTE 和递归示例](https://stackoverflow.com/questions/14274942/sql-server-cte-and-recursion-example)中进行了讨论，看起来很复杂。

从谷歌搜索我知道我们可以使用 WITH AS 和 UNION 来实现这一点，任何人都可以阐明可以得到这个结果的通用 sql 吗？

谢谢

诺西布

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T23:17:13.740

```
select connect_by_root(ChildId) as id
from t
where ChildId = 5
start with ParentId = -1
connect by ParentId = prior ChildId 
```

[小提琴](http://www.sqlfiddle.com/#!4/b86d8/1)

# return - Fabric + Virtualenvwrapper 给出致命错误：run() 在执行时收到非零返回码 1

> ID：15536041
> 
> 赞同：2
> 
> 时间：2013-03-20T22:30:05.170
> 
> 标签：return, virtualenv, fabric, virtualenvwrapper

我有一个使用 virtualenvwrapper 来创建 virtualenv 的结构脚本，但是在运行 mkvirutalenv 之后，结构脚本抱怨返回代码，见下文

```
[localhost] run: export WORKON_HOME=/srv/www && source /usr/local/bin/virtualenvwrapper.sh && mkvirtualenv james --no-site-packages --distribute
[localhost] Login password for 'james': 
[localhost] out: New python executable in james/bin/python
[localhost] out: Installing distribute...........................................................................................................................................................................................................................done.
[localhost] out: Installing pip................done.

Fatal error: run() received nonzero return code 1 while executing!

Requested: export WORKON_HOME=/srv/www && source /usr/local/bin/virtualenvwrapper.sh && mkvirtualenv james --no-site-packages --distribute
Executed: /bin/bash -l -c "cd /srv/www && export WORKON_HOME=/srv/www && source /usr/local/bin/virtualenvwrapper.sh && mkvirtualenv james --no-site-packages --distribute"

Aborting. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:56:02.067

发现 --no-site-packages 和 --distribute 的位置必须在 virtualenv 名称前面才能返回 0，例如

```
mkvirtualenv --no-site-packages --distribute <name> 
```

# c# - 在 ListView 中显示查询结果

> ID：15536042
> 
> 赞同：0
> 
> 时间：2013-03-20T22:30:19.850
> 
> 标签：c#, asp.net, listview, button, webforms

我有一个带有文本框、一个按钮和一个 Listview 控件的 .aspx 页面。

用户应该在文本框上写任何文本，单击按钮并在列表视图上接收结果。

带有查询的方法：

```
public IQueryable<Midia> GetMidias(string busca)
    {
        var db = new Locadora.Models.LocadoraContexto();
        IQueryable<Midia> query = from m in db.Midias
                                      join f in db.Filmes on m.FilmeID equals f.FilmeID
                                      where f.TituloFilme.Contains(busca)
                                      select m;
        return query;
    } 
```

按钮点击事件：

```
protected void SearchButton_Click(object sender, EventArgs e)
{
     GetMidias(SearchTextBox.Text);
} 
```

当用户单击按钮时，列表视图保持为空。查询没问题，我已经在 SQL Server Management Studio 上测试过了，如果我把它放在 Page_Load 事件上，listview 会正确显示数据。我不知道如何在 button_click 上制作它。

listview的select方法是：SelectMethod="GetMidias"

# html - 禁用字段上的手形光标

> ID：15536045
> 
> 赞同：5
> 
> 时间：2013-03-20T22:30:32.197
> 
> 标签：html, css

我正在使用 html 输入文本字段，当我将鼠标悬停在文本字段上时，我想强制光标成为一只手。文本字段是只读的，因此悬停时会显示取消符号（带斜线的圆圈）。我正在使用

场上的css类，但不是

```
.rdonly
{
cursor: hand;
cursor: pointer;
} 
```

在模板中

```
<input type= "text" readonly class="rdonly"/> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T22:33:22.183

你可以试试 ：

```
.rdonly:hover
{
   cursor: pointer;
} 
```

[http://jsfiddle.net/GJ4TS/](http://jsfiddle.net/GJ4TS/)

问题是，当我在 jsfiddle 中尝试您的代码时，它可以工作......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-23T20:48:22.380

我知道这是一个旧线程，但我仍然会回答它，因为正确的解决方案应该是添加`[readonly]`：

```
input[readonly]
{
    cursor: pointer;
} 
```

# css - 在浏览器调整大小时保持纵横比

> ID：15536049
> 
> 赞同：0
> 
> 时间：2013-03-20T22:30:44.757
> 
> 标签：css, resize, width, grid-layout

包装容器 css 是 width:auto; 最大高度：70%；

我希望 div 在浏览器窗口高度发生变化时保持其纵横比。

jfiddle：http: [//jsfiddle.net/7JNuU/](http://jsfiddle.net/7JNuU/)

HTML

```
<div id="feedwrapper">

<!--FULL group-->
<div id="tile">
<div id="fullcell">1</div>
</div>
<!--FULL group-->

<!--4up group-->
<div id="tile">
<div id="solocell">1</div>
<div id="solocell">2</div>
<div id="solocell">3</div>
<div id="solocell">4</div>
</div>
<!--4up group-->

<!--2top group-->
<div id="tile">
<div id="solocell">1</div>
<div id="solocell">2</div>
<div id="cell2xbot">3</div>
</div>
<!--2top group--> 
```

CSS

```
#feedwrapper{
width:auto;
max-height:70%;
top:80px;
bottom:60px;
margin-bottom:80px;
left:300px;
position:absolute;
background-color:#FFF;
white-space:nowrap;
display:block;
}
#tile{ position:relative; border:none; padding:0px; min-width:640px; height:100%; margin:0px 2px 2px 0px; background-color:#CC6; float:left;}

#fullcell{width:100%; height:100%; background-color:#F99; display:block;}
#solocell{ width:50%; height:50%; background-color:#36C; display:block; float:left;}
#cell2xbot{ width:100%; height:50%; background-color:#C93; display:block; float:left;}
#cell2xtop{ width:100%; height:50%; background-color:#C66; display:block; float:left;}
#cell2yleft{ width:50%; height:100%; background-color:#99C; display:block; float:left;}
#cell2yright{ width:50%; height:100%; background-color:#FC6; display:block; float:right;} 
```

我正在处理的页面是： [http ://www.jordache.com/connect.php](http://www.jordache.com/connect.php)

网格使用正方形和矩形。50%x50% 正方形、100% 正方形、50%x/100%y 矩形和 100%x/50%y 矩形。

必须有一个更简单的方法.... grrrrr ...帮助！

# mysql - MySQL - 一对多查询

> ID：15536053
> 
> 赞同：0
> 
> 时间：2013-03-20T22:30:53.180
> 
> 标签：mysql, codeigniter, one-to-many

我有一张这样的桌子：

```
[Exam]
[exam_id] [exam_name]
   1        Test1
   2        Test2 
```

和其他这样的表：

```
[Module]
[module_id] [module_name] [exam_id]
    1          Module1      1
    2          Module2      1
    3          Module1      2 
```

很明显，我们看到 Test1 分配了 2 个模块，而 Test2 分配了模块

我想要一个查询加入两个表，其中输出如下所示：

```
Test 1    Module1
          Module2

Test 2    Module1 
```

我做了以下事情：

```
SELECT `exam`.'exam_id', 'exam_name', 'module_name'
FROM (`exam`) JOIN `module` ON `exam`.`exam_id`=`module`.`exam_id` 
```

但我得到了一个包含重复考试名称的输出：

```
Test 1 Module 1
Test 1 Module 1

Test 2 Module1 
```

我想删除额外的测试 1，因为这些显示在我正在使用 foreach 的视图上

你们能帮我解决这个问题吗？.. 我正在使用 codeIgniter，因此您也可以在 codeigniter 中向我提供查询。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:39:04.413

MySQL 将在每一行中返回考试名称。为了防止它显示在您的视图中，您需要设置一些额外的逻辑 PHP 端来做到这一点。例如

```
$exam = null;

foreach($rows as $row){

    if($row['exam'] !== $exam){
        echo '<h1>'. $row['exam'] .'</h1>';
        $exam = $row['exam'];
    }

    echo '<p>'. $row['module'] .'</p>';

} 
```

如果它与前一行不同，这只会打印考试。

# javascript - JQuery 适用于 JSFiddle 但不适用于 Live 站点

> ID：15536055
> 
> 赞同：0
> 
> 时间：2013-03-20T22:31:01.650
> 
> 标签：javascript, jquery, jsfiddle

这是 JSFiddle：http: [//jsfiddle.net/CR47/w45M8/](http://jsfiddle.net/CR47/w45M8/)

这是现场网站： [http ://dev.chrisruno.com/sahshe/quiz/#index3](http://dev.chrisruno.com/sahshe/quiz/#index3)

是的，我的索引正确链接到 JQuery 库和我的 .js 文件。所有文件中的其他 javascript 都在工作，只是我在 JSFiddle 中完成的部分似乎不起作用。它实际上正在做与它应该做的相反的事情。

这是现场网站上的截图：http: [//i.imgur.com/8MjCRxg.jpg ?1](http://i.imgur.com/8MjCRxg.jpg?1)

```
var skinCare=[];
$('.skinCare').click(function(){
    var value = event.target.className.split(" ")[0];
    var index = skinCare.indexOf(value); 
    if($(this).hasClass('selected')){
        //$('.skinCare').removeClass('selected');
        skinCare.splice(index, 1);
    } else if($.inArray(value, skinCare) == -1){
        skinCare.push(value);
    }
});

$('html').click(function(){
    alert(skinCare);

});

    $('.circle').mouseover(function(){
            $(this).addClass('hover');
        });

        $('.circle').mouseout(function(){
            $(this).removeClass('hover');
        });

        $('.multi').click(function(){
            //$(this).css('background-color','#ff0000');
            $(this).toggleClass('selected');
            $(this).removeClass('hover');
    }); 
```

根据 chrome 论坛的建议，我尝试禁用 chrome to phone extension，但无济于事。这是我在错误控制台中得到的：

```
 Uncaught Error: Syntax error, unrecognized expression: # 
jquery.min.js:4 
st.error jquery.min.js:4 
ft jquery.min.js:4 
st jquery.min.js:4 
b.fn.extend.find 
jquery.min.js:4 
b.fn.b.init 
jquery.min.js:3 b jquery.min.js:3 (anonymous function) jquery.scrollTo.js:130 
b.extend.each jquery.min.js:3 
b.fn.b.each jquery.min.js:3 
$.fn.scrollTo jquery.scrollTo.js:114 (anonymous function) 
myjs.js:10 b.event.dispatch jquery.min.js:3 
v.handle jquery.min.js:3 Uncaught ReferenceError: index is not defined myjs.js:106 (anonymous function) 
myjs.js:106 
b.event.dispatch 
jquery.min.js:3 v.handle 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:39:31.343

添加到数组中的条件始终为真，因此切勿将值推入数组

更改`if(index >= 0)`安装`$(this).hasClass('selected')`

这是关于函数添加类和评估“hasClass”的函数之间的时间，如果有类，则必须评估是否存在于数组 insted 中......

```
var skinCare = [];
        $('.skinCare').click(function(){
            var value = event.target.className.split(" ")[0];
            var index = skinCare.indexOf(value); 
            if(index >= 0){
                skinCare.splice(index, 1);
            } else if($.inArray(value, skinCare) == -1){
                skinCare.push(value);
            }
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T12:14:27.640

请将您页面上的来源与草稿页面进行比较。检查您的脚本是否加载了所有指定的库（使用浏览器中的 Web 控制台检查 404 错误）。我们确实托管了一些库，请在使用前将它们上传到您的站点。

*   草稿[http://doc.jsfiddle.net/basic/introduction.html#result-draft](http://doc.jsfiddle.net/basic/introduction.html#result-draft)
*   常见问题解答[http://doc.jsfiddle.net/faq.html#code-is-working-on-jsfiddle-not-on-site-local-machine](http://doc.jsfiddle.net/faq.html#code-is-working-on-jsfiddle-not-on-site-local-machine)

# sql - 比较主管的薪水

> ID：15536056
> 
> 赞同：0
> 
> 时间：2013-03-20T22:31:10.343
> 
> 标签：sql, subquery, self-join

我试图展示收入至少是其主管收入的 25% 的员工。到目前为止，我有一个可以显示主管本身的子查询代码，但我不确定如何“获取”主管工资：

```
SELECT TOP (100) PERCENT firstname + ' ' + lastname        AS Employee, 
                         id, 
                         jobtitle                          AS [Job Title], 
                         Str(Round(salary / 12, 2), 12, 2) AS [Monthly Salary] 
FROM   employeetable 
WHERE  ( id IN (SELECT supervisor 
                 FROM   employeetable 
                 WHERE  ( supervisor IS NOT NULL )) ) 
ORDER  BY lastname, 
          firstname 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:36:11.933

-- 一、找员工和主管

```
select emp.id,emp.Salary,Sup.SuperVisor,Sup.Salary
from employeetable emp
join employeetable Sup on emp.supervisor=Sup.id 
```

现在添加 where 子句

```
where emp.Salary >= .25 * Sup.Salary 
```

消除担任主管的人

```
and emp.id not in (select distinct supervisor from employeetable) 
```

# php - 如何从 wordpress 的主题选项中获取输入文本？

> ID：15536059
> 
> 赞同：0
> 
> 时间：2013-03-20T22:31:15.540
> 
> 标签：php, wordpress, themes, textinput

我只是在我的 theme-options.php 文件中设置了一个新的输入文本选项，它类似于二十一主题代码。

以下是关于输入的我的 theme-options.php 代码的一部分，我正在寻找一种方法来获取用户输入“事实”文本并将其显示在 index.php 页面上的输入：

```
function themename_theme_options_init() {

register_setting(
    'themename_options',       // Options group, see settings_fields() call in themename_theme_options_render_page()
    'themename_theme_options', // Database option, see themename_get_theme_options()
    'themename_theme_options_validate' // The sanitization callback, see themename_theme_options_validate()
);

// Register our settings field group
add_settings_section(
    'general', // Unique identifier for the settings section
    '', // Section title (we don't want one)
    '__return_false', // Section callback (we don't want anything)
    'theme_options' // Menu slug, used to uniquely identify the page; see themename_theme_options_add_page()
);

// Register our individual settings fields
add_settings_field( 'facts', __( 'Facts',     'themename' ), 'themename_settings_field_facts', 'theme_options', 'general' );
add_settings_field( 'link_color', __( 'Link Color',     'themename' ), 'themename_settings_field_link_color', 'theme_options', 'general' );
}
add_action( 'admin_init', 'themename_theme_options_init' ); 
```

根据配色方案返回主题名称的默认事实：

```
function themename_get_default_facts( $color_scheme = null ) {
if ( null === $color_scheme ) {
    $options = themename_get_theme_options();
    $color_scheme = $options['color_scheme'];
}

$color_schemes = themename_color_schemes();
if ( ! isset( $color_schemes[ $color_scheme ] ) )
    return false;

return $color_schemes[ $color_scheme ]['default_facts'];
} 
```

呈现 Facts 设置字段。

```
function themename_settings_field_facts() {
$options = themename_get_theme_options();
?>
<input type="text" name="themename_theme_options[facts]" id="facts" value="<?php echo esc_attr( $options['facts'] ); ?>" />
<br />
<span><?php printf( __( 'Default facts: %s', 'themename' ), '<span id="default-facts">' . themename_get_default_facts ( $options['color_scheme'] ) . '</span>' ); ?></span>
<?php
} 
```

清理和验证表单输入：

```
function themename_theme_options_validate( $input ) {
$output = $defaults = themename_get_default_theme_options();

// Color scheme must be in our array of color scheme options
if ( isset( $input['color_scheme'] ) && array_key_exists( $input['color_scheme'], themename_color_schemes() ) )
    $output['color_scheme'] = $input['color_scheme'];

// Facts must be characters.
if ( isset( $input['facts'] ) )
    $output['facts'] = '' . ( ltrim( $input['facts'], '' ) );

// Our defaults for the link color may have changed, based on the color scheme.
$output['link_color'] = $defaults['link_color'] = themename_get_default_link_color( $output['color_scheme'] );

// Link color must be 3 or 6 hexadecimal characters
if ( isset( $input['link_color'] ) && preg_match( '/^#?([a-f0-9]{3}){1,2}$/i', $input['link_color'] ) )
    $output['link_color'] = '#' . strtolower( ltrim( $input['link_color'], '#' ) );

return apply_filters( 'themename_theme_options_validate', $output, $input, $defaults );
} 
```

在主题定制器中实现主题选项：

```
function themename_customize_register( $wp_customize ) {
$wp_customize->get_setting( 'blogname' )->transport = 'postMessage';
$wp_customize->get_setting( 'blogdescription' )->transport = 'postMessage';

$options  = themename_get_theme_options();
$defaults = themename_get_default_theme_options();

$wp_customize->add_setting( 'themename_theme_options[facts]', array(
    'default'           => themename_get_default_facts( $options['color_scheme'] ),
    'type'              => 'option',
    'sanitize_callback' => 'sanitize_text_field',
    'capability'        => 'edit_theme_options',
) );

}
add_action( 'customize_register', 'themename_customize_register' ); 
```

感谢任何可以提供帮助的人：）谢谢！我让它工作了：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T07:46:06.963

```
----------
<?php
/**
 * Theme Options
 *
 * @package WordPress
 * 
 */

/* Write the name and the variable_name in which you want to store the data using theme options in the array $options_array */
$options_array = array(
            'Facebook URL'=>'facebook_url',
        );

function my_theme_options_init() {

    // If we have no options in the database, let's add them now.
    if ( false === my_theme_options() )
        add_option( 'my_theme_options', my_default_theme_options() );

    register_setting(
        'my_options',       // Options group, see settings_fields() call in theme_options_render_page()
        'my_theme_options' // Database option, see my_theme_options()
    );
    global $options_array;
    foreach ($options_array as $key=>$option ){
        register_setting( 'my_options', $option);
    }

}

add_action( 'admin_init', 'my_theme_options_init' );

function my_theme_options_add_page() {
    $theme_page = add_theme_page(
        'myers themeing',   // Name of page
        'myers themeing',   // Label in menu
        'edit_theme_options',                    // Capability required
        'my_options',                         // Menu slug, used to uniquely identify the page
        'my_theme_options_render_page' // Function that renders the options page
    );

    if ( ! $theme_page )
        return;

}
add_action( 'admin_menu', 'my_theme_options_add_page' );

function my_default_schemes() {
    $default_array = array('value' => 'Default_theme',
            'label' => __( 'Default_theme', 'my' ),
            'thumbnail' => get_template_directory_uri() . '/inc/images/my.png' 
            );
    global $options_array;
    foreach ($options_array as $key=>$option ){
        $default_array[$option] =' ';
    }

    $default_scheme_options = array(
        'Default_theme' => $default_array,
    );

    return apply_filters( 'my_default_schemes', $default_scheme_options );
}

function my_default_theme_options() {
    $default_theme_options = array( 'default_scheme' => 'Default_theme' );
    global $options_array;  
    foreach ($options_array as $key=>$option ){
        $default_theme_options[$option] = my_default( $option,'Default_theme' );
    }   

    return apply_filters( 'my_default_theme_options', $default_theme_options );
}

function my_default( $option ,$default_scheme = null ) {
    if ( null === $default_scheme ) {
        $options = my_theme_options();
        $default_scheme = $options['default_scheme'];
    }

    $default_schemes = my_default_schemes();
    if ( ! isset( $default_schemes[ $default_scheme ] ) )
        return false;

    return $default_schemes[ $default_scheme ][$option];
}

function my_theme_options() {
    return get_option( 'my_theme_options', my_default_theme_options() );
}

function my_theme_options_render_page() {
    ?>
    <div class="wrap">
        <?php screen_icon(); ?>
        <h2><?php printf( __( '%s Theme Options', 'my' ), get_current_theme() ); ?></h2>
        <?php settings_errors(); ?>
        <hr>

        <div id="theme_option_main">

            <h2>myers themeing</h2>
            <form method="post" enctype="multipart/form-data" action="options.php">
            <?php

                settings_fields( 'my_options' );
                $options = my_theme_options();
                $default_options = my_default_theme_options();
                global $options_array;  
                foreach ($options_array as $key=>$option ){
                    do_settings_sections($option);
                }   

            ?>

                <table class="form-table">
                    <tr>
                        <th scope="row"><?php _e( "(Use ' http:// ' for Hyperlinks)", 'my' ); ?></th>
                        <td>
                            <fieldset>
                            </fieldset>
                        </td>
                    </tr>
                    <?php   
                            foreach ($options_array as $key=>$option ){

                         ?>
                        <tr>
                            <th scope="row"><?php _e( $key, 'my' ); ?></th>
                            <td>
                                <fieldset>
                                    <legend class="screen-reader-text"><span><?php _e( $key, 'my' ); ?></span></legend>
                                    <input type="text" name="<?php echo $option ?>" id="<?php echo $option ?>" class="large-text" value="<?php echo get_option($option); ?>"></input>
                                </fieldset>
                            </td>
                        </tr>

                    <?php } ?>

                </table>
                <?php submit_button(); ?>
            </form>

        </div>
    </div>  

    <?php
}
?> 
```

复制代码并创建一个新的主题选项文件。在文件的选项数组中添加名称和变量名，您就可以开始了。

不要忘记在你的functions.php中链接这个文件要链接它只需在你的functions.php中添加以下代码

```
require( dirname( __FILE__ ) . '/inc/your_file_name.php' ); 
```

# javascript - CSS3 动画触发其他 dom 元素

> ID：15536063
> 
> 赞同：0
> 
> 时间：2013-03-20T22:31:32.040
> 
> 标签：javascript, jquery, html, css

我目前有一些 CSS3 动画在页面加载时无限循环播放。

有没有办法手动触发这些 - 例如，如果我将鼠标悬停在*另一个*DOM 元素上，而不需要 Javascript/Jquery？

ie -> 将鼠标悬停在元素 a 上 -> 在 DOM 元素 x,y,z 上开始动画

提前谢谢了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:36:27.950

您可以在 CSS 中将其设置为 a `class`，然后使用 javascript 触发添加/删除。

```
$('#element1').hover(function(){
  $('#element2').addClass('animate');
}, function(){
  $('#element2').removeClass('animate');
}); 
```

为了挂钩事件，您将需要 Javascript。

另一种使用纯 CSS 的方法是使用伪类`:hover`，但前提是它`#element2`是`#element1`.

```
#element1:hover #element2{
  /* Your animation */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:38:38.380

您的 DOM 需要设置为使 x、y 和 z 在元素 a 内。然后你可以这样做：

```
a:hover x,y,z {
    animation:yourAnimation 5s infinite;
} 
```

# mongodb - 具有可变距离的 MongoDb 近/近地查询

> ID：15536064
> 
> 赞同：0
> 
> 时间：2013-03-20T22:31:33.833
> 
> 标签：mongodb, geolocation

我想执行一个查询，其中距离是集合中的一个动态字段。

集合中的条目示例：

```
{
  name:'myName',
  location: {lat:10, lng:20},
  maximumDistance: 10
}
{
  name:'myName2',
  location: {lat:20, lng:20},
  maximumDistance: 100
} 
```

我的目标是从该集合中检索该*位置*靠近给定位置的所有元素，例如 (10,10) 但计算出的距离小于该*maximumDistance*字段。

我可以在 near 查询中将 maxDistance 设置为一个常量值（足够高以检索我想要的所有元素），然后在我的 java 代码中进行过滤，但我更愿意在查询中执行它可能过于面向 SQL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T03:20:38.867

您将无法使用普通查询执行此操作，因为您无法动态设置每个文档的距离。从 MongoDB 2.4 开始，您可以使用聚合框架执行此操作，因为他们已将 geoNear 运算符添加到管道的开头。

第一阶段将是与 geoNear 命令非常相似的 geoNear。作为结果，我们还将获得从指定点 (10,10) 到文档的距离。

第二阶段，我们将需要使用项目运算符来计算 maximumDistance 字段和计算的 geoNear 距离之间的差异。

最后，我们匹配那些具有正 delta ((max - distance) > 0) 的文档。

[这是使用Asynchronous Java Driver](http://www.allanbank.com/mongodb-async-driver/)的辅助类的管道。

```
package example;

import static com.allanbank.mongodb.builder.AggregationProjectFields.include;
import static com.allanbank.mongodb.builder.QueryBuilder.where;
import static com.allanbank.mongodb.builder.expression.Expressions.field;
import static com.allanbank.mongodb.builder.expression.Expressions.set;
import static com.allanbank.mongodb.builder.expression.Expressions.subtract;

import com.allanbank.mongodb.bson.element.ArrayElement;
import com.allanbank.mongodb.builder.Aggregate;
import com.allanbank.mongodb.builder.AggregationGeoNear;
import com.allanbank.mongodb.builder.GeoJson;

public class AggregateGeoNear {
    public static void main(String[] args) {
        Aggregate aggregate = Aggregate
                .builder()
                .geoNear(
                        AggregationGeoNear.builder()
                                .location(GeoJson.p(10, 10))
                                .distanceField("distance"))
                .project(
                        include("name", "location", "maximumDistance"),
                        set("delta",
                                subtract(field("maximumDistance"),
                                        field("distance"))))
                .match(where("delta").greaterThanOrEqualTo(0)).build();

        System.out
                .println(new ArrayElement("pipeline", aggregate.getPipeline()));
    }
} 
```

这是创建的管道：

```
pipeline : [
  {
    '$geoNear' : {
      near : [
        10, 
        10
      ],
      distanceField : 'distance',
      spherical : false,
      uniqueDocs : true
    }
  }, 
  {
    '$project' : {
      name : 1,
      location : 1,
      maximumDistance : 1,
      delta : {
        '$subtract' : [
          '$maximumDistance', 
          '$distance'
        ]
      }
    }
  }, 
  {
    '$match' : {
      delta : { '$gte' : 0 }
    }
  }
] 
```

HTH - 抢。

PS 上面的构建器使用的是 1.2.0 版本的驱动程序的预发布版本。当我输入代码时，代码正在通过构建矩阵，应该在 2013 年 3 月 22 日星期五之前发布。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-26T13:02:46.520

关于如何使用 Spring Data 解决它，我通过构建一个新的 GeoNearOperation 实现来解决它，因为必须在投影中包含 maxDistance 字段名称：

```
public class GeoNearOperation2  implements AggregationOperation  {

private NearQuery nearQuery;

public GeoNearOperation2(NearQuery nearQuery) {
    this.nearQuery = nearQuery;
}

public DBObject toDBObject(AggregationOperationContext context) {
    DBObject dbObject = context.getMappedObject(nearQuery.toDBObject());
    dbObject.put("distanceField", "distance");
    return new BasicDBObject("$geoNear",dbObject);
}

} 
```

# scala - Scala Play Framework 2.1 Slick 1.0 Cake Pattern 常用表字段

> ID：15536065
> 
> 赞同：3
> 
> 时间：2013-03-20T22:32:06.960
> 
> 标签：scala, slick

我正在开发一个使用 Slick 1.0 和 cake 模式连接到 postgresql 数据库的项目。
就像现在一样，一切似乎都运行良好，但我还有很多表要添加，并且我意识到所有表都包含许多公共列。我希望能够制作一个包含公共字段的特征，但我无法弄清楚如何让它发挥作用。（我是 scala 的新手，但我认为我的基础知识已经很好了。）

这是一个示例，希望能说明我想要做什么：

一.scala：

```
 package models.db.slick
    import java.util.UUID
    import play.api.db.slick.Profile
    case class One(common1:UUID, common2:String, unique1:String)
    trait OneComponent{this: Profile =>
      import profile.simple._
      object Ones extends Table[One]("One") with CommonColumns{
        def unique1 = column[String]("unique1")
        def * = common1 ~ common2 ~ unique1 <> (One.apply _, One.unapply _)
      }
    } 
```

ColumnColumns.scala：

```
 package models.db.slick
    import java.util.UUID
    import play.api.db.slick.Profile
    trait CommonColumns{
      def common1 = column[UUID]("common1")
      def common2 = column[String]("common2")
    } 
```

这不会编译，因为 ColumnColumns 特征不知道 column[T]。我尝试指定一个 self 类型的 Table，但我不知道如何获取 Table 对象，该对象本身位于 scala.slick.driver.BasicTableComponent 特征中。我还尝试指定一个实现列函数的 self 类型，例如：

```
 trait CommonColumns{ this => {def column[C](n: String, options:    
                                   scala.slick.lifted.ColumnOption[C]* )
                                   (implicit tm:scala.slick.lifted.TypeMapper[C]
                                    ): scala.slick.lifted.Column[C]}
    ...
    } 
```

但这不起作用。我很可能在那个语法上有错误，但我找不到一个很好的例子来说明如何做到这一点。

你怎么看？有什么好方法可以完成这项工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:35:47.823

我想到了！至少我认为我做到了。如果有人注意到这有什么问题，请告诉我。

好的，这就是我的做法：

我将 CommonColumns 特征更改为：

```
 trait CommonColumnsComponent{ this:Profile =>
      import profile.simple._
      trait CommonColumns{ this:Table[_] =>
        def common1 = column[UUID]("common1")
        def common2 = column[String]("common2")
      }
    } 
```

然后我将 OneComponent 更改为：

```
 trait OneComponent extends CommonColumnsComponent{this: Profile =>
      import profile.simple._
      object Ones extends Table[One]("One") with CommonColumns{
        def unique1 = column[String]("unique1")
        def * = common1 ~ common2 ~ unique1 <> (One.apply _, One.unapply _)
      }
    } 
```

它奏效了。

# xcode - 动画自动调整大小图像不可见

> ID：15536077
> 
> 赞同：0
> 
> 时间：2013-03-20T22:32:48.363
> 
> 标签：xcode, nib

[此处的图像](https://stackoverflow.com/questions/15401848/)显示了 Size Inspector Utility 中可用的动画自动调整大小图像。为什么我无法在我的 xib 文件或故事板中看到这些图像？Size Inspector 的那部分在我的计算机上是不可见的。当我在 Size Inspector 中然后单击另一个 Inspector 的按钮之一时，我可以在另一个 Inspector 出现之前看到所需的图像在屏幕上闪烁片刻。

# python - CSS 顶部导航栏，模板不起作用 compass 和 sass

> ID：15536079
> 
> 赞同：0
> 
> 时间：2013-03-20T22:32:50.470
> 
> 标签：python, css, django, sass, compass-sass

我试图理解为什么以下不起作用。我试图在顶部有一个导航栏，但我使用的是指南针和 scss 文件，但这是我不理解的基本 CSS。我从 sass-lang.com 复制并粘贴，只更改了名称

以下是我的 scss 文件

```
#top-navigation {
  width: 80%;
  height: 23px;

  ul { list-style-type: none; }
  li {
    float: left;
    a { font-weight: bold; }
  }
} 
```

以下是我的 base.html

```
{% extends "skeleton.html" %}
{% load zinnia_tags i18n %}
{% load url from future %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
    <link rel="stylesheet" href="/style.css" />
    <title>{% block title %}User test{% endblock %}</title>
</head>

<body>       
        {% block header %}
    <div class ="container">
    <div id="header">
<ul class="top-navigation">
              <li>  
                    <a href="{% url "home" %}">{% trans "Home" %}</a>  
             </li>
                {% if user.is_authenticated %}
                <li> {% trans "Logged in" %}: {{ user.username }} </li>
                {% endif %}

          <li>
            <a href="/blog/feeds/" title="RSS Feed of latest entries" class="feeds">
              RSS Feed
            </a>
          </li>
        </ul>
    </div>
    </div>

    <hr />

        {% endblock %}

        {% block sidebar %}
        <div id="sidebar">
            <ul>
                <li>One</li>
                <li>Two</li>
                <li>Three</li>
            </ul>
        </div>
        {% endblock %}

    <div id="content">
        {% block content %}{% endblock %}
    </div>

    <div id="footer">
        {% block footer %}
        <hr />
        <p>this is the footer</p>
        {% endblock %}
    </div>
</body>

</html> 
```

和

索引.html

```
{% extends "base.html" %}
{% load i18n zinnia_tags %}
{% load url from future %}
{% block title %}IVLoop.com{% endblock %}

</div>
    {% block content %}

        <h1>IVLoop.com</h1>
        <h2>Isla Vista Survival Handbook</h2>
        <h3>Phone Numbers and Links to all the stuff u need. Like food, fixing broken windows, 
        door locks and pluming. IVLoop.com is your IV survival guide</h3>

<p>IV loop is the term to describe the biz and res area around the loop in iv 
“did the Loop” generally means that you had a pitcher at the fine establishments located around the Isla Vista Loop.
 Start at Javan’s on Embarcadero Del Norte
then across to IVBC now remodeled as Embarcadero Hall, once the building was on fire… find out more and submit us your findings to be posted thanks
then down and around the loop for a beer at Super Cuca’s however they are moving next to Woodstock’s
up on Del Mar to Déjà Vu 
next is Giovanni’s 
across they way to El Sitio’s
Sam’s To Go 
Study Hall 
then over to Dublin’s
then Chino’s 
On the Side and Woodstock’s to finish of next to Javan’s
Please drink Responsibly! 

Is it isla as in island or is it isla as in is and why? </p>

{% endblock %}

</div> 
```

我得到的结果是

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xml:lang="en-us" lang="en-us" version="-//W3C//DTD XHTML 1.1//EN" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>IVLoop.com</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="cache-control" content="public" />
    <meta name="robots" content="follow, all" />
    <meta name="language" content="en-us" />
    <meta name="viewport" content="width=device-width; initial-scale=1.0;" />
    <meta name="description" content="Browse through a few featured Isla Vista Restaurants and we are here to take your order. 
Call night or day (805)689-6969 or order online" />
    <meta name="keywords" content="delivery,food,take-out " />
    <meta name="author" content="Brian Scott Carpenter" />

    <link rel="pingback" href="/xmlrpc/" />
    <link rel="shortcut icon" href="/static/img/favicon.ico" />
    <link rel="home" href="/" />
    <link rel="stylesheet" type="text/css" media="screen, projection" href="/static/css/screen.css" />
    <link rel="stylesheet" type="text/css" media="print" href="/static/css/print.css" />
    <!--[if lt IE 8]>
        <link rel="stylesheet" type="text/css" media="screen, projection" href="/static/zinnia/css/ie.css" />
    <![endif]-->

  </head>
  <body class="skeleton ">
    <div class="container">

    <div class ="container">
<ul class="top-navigation">
              <li>  
                    <a href="/">Home</a>  
             </li>

          <li>
            <a href="/blog/feeds/" title="RSS Feed of latest entries" class="feeds">
              RSS Feed
            </a>
          </li>
        </ul>

    <hr />

        <div id="sidebar">
            <ul>
                <li>One</li>
                <li>Two</li>
                <li>Three</li>
            </ul>
        </div>

        <h1>IVLoop.com</h1>
        <h2>Isla Vista Survival Handbook</h2>
        <h3>Phone Numbers and Links to all the stuff u need. Like food, fixing broken windows, 
        door locks and pluming. IVLoop.com is your IV survival guide</h3>

<p>IV loop is the term to describe the biz and res area around the loop in iv 
“did the Loop” generally means that you had a pitcher at the fine establishments located around the Isla Vista Loop.
 Start at Javan’s on Embarcadero Del Norte
then across to IVBC now remodeled as Embarcadero Hall, once the building was on fire… find out more and submit us your findings to be posted thanks
then down and around the loop for a beer at Super Cuca’s however they are moving next to Woodstock’s
up on Del Mar to Déjà Vu 
next is Giovanni’s 
across they way to El Sitio’s
Sam’s To Go 
Study Hall 
then over to Dublin’s
then Chino’s 
On the Side and Woodstock’s to finish of next to Javan’s
Please drink Responsibly! 

Is it isla as in island or is it isla as in is and why? </p>

        <hr />
        <p>this is the footer</p>

  </body>
</html> 
```

我知道指南针有效，因为当我与其他班级一起工作时，它有效。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:35:26.380

问题出在base.html中

```
<div id ="top-navigation">

then <ul> 
```

他们结合在一起

# php - 如何创建搜索框来过滤数据

> ID：15536080
> 
> 赞同：0
> 
> 时间：2013-03-20T22:32:54.467
> 
> 标签：php, jquery, mysql, database, search

首先，我将此网站用作我正在尝试做的事情的模板，除了我在此之上添加一个搜索框：http: [//www.dougv.com/demo/jquery_sort_records/js.php](http://www.dougv.com/demo/jquery_sort_records/js.php)（由于要引用阻止，您应该复制并粘贴链接以查看它。否则您将遇到 403 禁止错误）

我想创建一个简单的搜索框，它将搜索某个属性并显示找到的任何结果（基本上是一个过滤器）。到目前为止，这是我所拥有的代码的一部分。到目前为止，表格看起来不错，但是我想添加一个搜索框，用于搜索名字属性。

有什么帮助吗？

```
<script type="text/javascript" src="jquery-1.3.1.min.js"></script>
<script type="text/javascript" src="jquery.tablesorter.min.js"></script>
<script type="text/javascript">
            $(document).ready(function() {
                $("#sortedtable").tablesorter({ sortlist: [0,0] });
            });
        </script>

</head>
<body>
<?php
            if(!$link = mysql_connect("database_server", "user_name", "password")) {
                echo "Cannot connect to db server";
            }
            elseif(!mysql_select_db("database_name")) {
                echo "Cannot select database";
            }
            else {
                if(!$rs = mysql_query("SELECT * FROM table")) {
                    echo "Cannot parse query";
                }
                elseif(mysql_num_rows($rs) == 0) {
                    echo "No records found";
                }
                else {
                    echo "<table id=\"sortedtable\" class=\"bordered\" cellspacing=\"0\">\n";
                    echo "<thead>\n<tr>";
                    echo "<th>Record ID</th>";
                    echo "<th>First Name</th>";
                    echo "<th>Last Name</th>";
                    echo "<th>Birthday</th>";
                    echo "<th>Department</th>";
                    echo "</tr>\n</thead>\n";
                    while($row = mysql_fetch_array($rs)) {
                        echo "<tr><td>$row[person_id]</td><td>$row[person_name]</td><td>$row[person_surname]</td><td>$row[person_birthdate]</td><td>$row[person_department]</td></tr>\n";
                    }
                    echo "</table><br />\n";
                }
            }
?>

<form name="search_form" method="POST" action="js.php">
<font face="Calibri"> </font>
Search: <input type="text" name="search_b" value="" />
<input type="submit" name="search" value="Search for your term..."> </input>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:42:41.257

首先，我建议您将数组访问权限包含在这样的字符串中：`" some triing {$array['key']}" 这样您就不会遇到直接在字符串中访问数组字段的任何问题。

但现在应该这样做：

```
<script type="text/javascript" src="jquery-1.3.1.min.js"></script>
<script type="text/javascript" src="jquery.tablesorter.min.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("#sortedtable").tablesorter({ sortlist: [0,0] });
    });
</script>

</head>
<body>
    <?php
    if (!$link = mysql_connect("database_server", "user_name", "password")) {
        echo "Cannot connect to db server";
    } elseif (!mysql_select_db("database_name")) {
        echo "Cannot select database";
    } else {
        $searchString = "";
        if(!empty($_POST['search_b'])){
            $searchString = "WHERE user_name LIKE '%{$_POST['search_b']}%'";
        }
        if (!$rs = mysql_query("SELECT * FROM table $searchString")) {
            echo "Cannot parse query";
        } elseif (mysql_num_rows($rs) == 0) {
            echo "No records found";
        } else {
            echo "<table id=\"sortedtable\" class=\"bordered\" cellspacing=\"0\">\n";
            echo "<thead>\n<tr>";
            echo "<th>Record ID</th>";
            echo "<th>First Name</th>";
            echo "<th>Last Name</th>";
            echo "<th>Birthday</th>";
            echo "<th>Department</th>";
            echo "</tr>\n</thead>\n";
            while ($row = mysql_fetch_array($rs)) {
                echo "<tr><td>{$row[person_id]}</td><td>{$row[person_name]}</td><td>{$row[person_surname]}</td><td>{$row[person_birthdate]}</td><td>{$row[person_department]}</td></tr>\n";
            }
            echo "</table><br />\n";
        }
    }
    ?>

    <form name="search_form" method="POST" action="js.php">
        <font face="Calibri"> </font>
        Search: <input type="text" name="search_b" value="" />
        <input type="submit" name="search" value="Search for your term..."> </input>
    </form> 
```

# javascript - 提交前检查下拉列表

> ID：15536082
> 
> 赞同：1
> 
> 时间：2013-03-20T22:33:20.517
> 
> 标签：javascript, jquery, forms

我使用此代码检查是否在提交之前选择了下拉选项。在我的页面上，我有 3 个下拉菜单，但只有第一个可以正常工作。

有没有办法扩展第二个和第三个下拉菜单的功能？

**我的脚本：**

```
<script type="text/javascript">
$(document).ready(function(){
$("#submit").click(function(){
var year = $('#year option:selected').val();
if(year == "")
{
$("#msg").html("Please select a year");
return false;
}
});
});
</script> 
```

**我的 HTML：**

```
<div id="msg"></div>
<form method="post" action="">
<select id="year">
<option value="">OLLA</option>
<option>1991 </option>
<option>1992 </option>
<option>1993 </option>
<option>1994 </option>
<option>1995 </option>
</select>

<div id="msg"></div>
<form method="post" action="">
<select id="year">
<option value="">OLLA</option>
<option>1991 </option>
<option>1992 </option>
<option>1993 </option>
<option>1994 </option>
<option>1995 </option>
</select>

<input type="submit" name="submit" id="submit">
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:37:28.910

[ID](http://www.w3schools.com/tags/att_global_id.asp)应该是唯一的并且**只使用一次**。我建议你改为给他们所有课程`msg`，例如

```
<div class="msg"></div>
...
<div class="msg"></div> 
```

此外，出于同样的原因，也给你的选择一个类：

```
<select class="year"> 
```

您的 jQuery 也将更改为：

```
<script type="text/javascript">
$(document).ready(function(){
  $(".submit").click(function(){
     var year = $('.year option:selected').val();
     if(year == "") {
        $(".msg").html("Please select a year");
        return false;
     }
  });
});
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:42:03.317

如果您将侦听器放在表单上，​​它将`this`在函数内，因此您可以执行以下操作：

```
$("<form selector>").click(function(){
  if (this.year.value == "") {
    $("#msg").html("Please select a year");
    return false;
  } else {
    $("#msg").html("");
  }
}) 
```

您还可以检查所选索引是否大于零。如果它是零或-1，则选择第一个或不选择（分别）。

你应该把ID属性变成NAME属性，然后你可以重复它们（提交表单时它们会成功）。

哦，永远不要将表单控件命名为“提交”，因为它会影响表单的提交方法，从而无法调用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:35:07.997

因为两个元素的 ID 相同，所以选择器适用于第一个 ID 匹配这种情况。尝试使用不同的 ID 或使用类而不是 ID 或使用 jquery 每个函数[http://api.jquery.com/each/](http://api.jquery.com/each/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T22:49:40.487

当然，您可以在 DDL 上设置一个操作以确保已设置一个值（之后启用提交按钮），从而将验证的重点直接放在控件本身上，而不是提交按钮上。（只是给同一只猫剥皮的另一种方法！）

# node.js - 有人复制了我的 npm 并以不同的名称发布。我该怎么办？

> ID：15536085
> 
> 赞同：0
> 
> 时间：2013-03-20T22:33:34.493
> 
> 标签：node.js, npm, bsd

有人拿走了我的 npm 并发布了一个新的 npm，我的代码使用了不同的名称。看起来他只改变了几行。他的自述文件包含了我的大部分内容。它也在 BSD 许可证下。我应该关心并要求他把它取下来，还是让它留下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:39:56.967

根据 BSD 许可证，只有在给出适当的来源归属时才允许这样的再分发。因此，以不同的名称发布已修补的 npm 或多或少都很好（尽管如果他们甚至没有就需要更改的原因与您联系，这很粗鲁），但如果他们只是删除了您的姓名和信息并放入他们的姓名和信息，那么它就是一个许可证违规，您应该联系他们和/或报告。

BSD 许可证要求作者仅通过对他的工作的认可来获得补偿，而违反这一规定是……嗯，一个很大的不，不。在学术界，这样的事情是剽窃，在民​​事上相当于谋杀——即以允许的最严厉的方式受到惩罚。

值得你花时间吗？好吧，这取决于你。如果他们只是没有意识到自己的不当行为并且愿意修复它，那很好，但如果是故意/恶意地这样做，那么“愿天堂鸟飞上他们的鼻子”，并且可能他们所有最喜欢的网页都开始使用闪烁标签。

# php - 如何使用mongodb的php驱动的storeFile()函数保证数据的完整性？

> ID：15536095
> 
> 赞同：0
> 
> 时间：2013-03-20T22:34:12.433
> 
> 标签：php, mongodb, data-integrity

我在这里问我的问题，因为我还没有在其他任何地方找到任何信息。

上下文：
-具有 3 个服务器的副本集架构。
- PHP 作为主要语言
- 图片平均大小约为 2Mo
- 用法：使用 storeFile() PHP 驱动程序函数将大量画廊存储到 mongodb

我担心主服务器崩溃期间和之后的存储。
如果我使用 storeFile() 存储一个完整的 80Mo 文件，客户端会将查询定向到副本集的主副本，然后副本集开始存储数据。
如果现在写操作完成了 60%，而主节点失败了，写操作会发生什么？
我知道我会得到一个异常，我会捕获并尝试重试该操作。但是已经写入的数据呢？

我将在数据库中有一个现有文件，该文件是原始图片的一部分，因此已损坏？
或者，它像事务一样工作，所以如果发生错误，mongodb 会回滚操作并抛出异常？

链接到我在谷歌群组上的主题：[谷歌群组主题](https://groups.google.com/forum/?hl=en#!topic/mongodb-user/asSR_iudKeE)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T22:22:05.930

PHP MongoDB 驱动程序将尝试“清理”对 GridFS 的失败写入，但是如果主节点崩溃，那么我们将无法访问任何主节点以执行清理例程。

因此，数据仍将存在于块集合中，但元数据（和实际文件信息）不会，因为在整个 GridFS 写入成功完成之前不会写入。

一般来说，这不是问题，因为您不应该遇到很多故障转移。但是，如果这是一个实际问题，即您正在存储无法真正访问的几兆字节数据，那么您将需要创建某种类型的后台/cronjob 任务，该任务将遍历块集合并检测孤立块。不过要小心，因为您不想删除当前正在创建的块:)

# email - 从自定义域发送到 gmail 的邮件进入垃圾邮件

> ID：15536096
> 
> 赞同：3
> 
> 时间：2013-03-20T22:34:14.760
> 
> 标签：email, filter, header, gmail, spam

我知道这不是在这里发布的完美消息类型，但我会尝试一下：

当我从我的域向 gmail 发送电子邮件时，它会自动进入垃圾邮件。在客户支持方面，他们告诉我我的域不在任何类型的黑名单上。

以下是标题：

[http://pastebin.com/QVYrDQbz](http://pastebin.com/QVYrDQbz)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:00:59.200

**要求 gmail 收件人**将邮件从`[GMAIL]/Junk`一个文件夹移动到另一个文件`Inbox`夹（IMAP 术语）或通过 Web 界面将其标记为“非垃圾邮件”。

只要**收件人**不告诉 gmail 其“分类为（可能的）垃圾邮件”是错误的，gmail 就认为它是正确的。

* * *

*   为电子邮件发件人的域发布 spf 记录可能会有所帮助，尤其是当发送主机位于另一个域中时
*   传出消息的 DKIM 签名也可能有帮助

[https://support.google.com/mail/answer/81126?hl=en#authentication](https://support.google.com/mail/answer/81126?hl=en#authentication)

# c++ - 在 set 容器的 find() 上崩溃

> ID：15536102
> 
> 赞同：0
> 
> 时间：2013-03-20T22:34:49.050
> 
> 标签：c++, templates, stl, crash, set

我有一个 SyncSet 模板类，它锁定了集合操作。当我在做压力测试时，我崩溃了。当我检查崩溃输出文件时，似乎原因是关于 set 容器的查找功能。您可以在下面看到我的模板类，您可以在 pastebin 链接中找到相关的崩溃输出：http: [//pastebin.com/1JzAWxjf](http://pastebin.com/1JzAWxjf)

我的模板类中是否有问题可能导致此类崩溃？其次，操作系统中止应用程序是否可能因为内存限制超过或类似的东西，那么有没有办法检查操作系统上的消息（Windows 7专业版）？

所有的建议和意见都欢迎和 appricated。

谢谢。

```
template <typename T>
class SyncSet
{
public:
    SyncSet() {
        InitializeCriticalSection(&m_lock);
    }

    ~SyncSet() {
        DeleteCriticalSection(&m_lock);
    }

    void Insert(T elem) {
        EnterCriticalSection(&m_lock);
        m_set.insert(elem);
        LeaveCriticalSection(&m_lock);
    }

    bool Has(T elem) {
        if (m_set.empty() || m_set.find(elem) == m_set.end())
            return false;

        return true;
    }

    bool Erase(T elem) {
        if (!Has(elem))
            return false;
        EnterCriticalSection(&m_lock);
        m_set.erase(elem);
        LeaveCriticalSection(&m_lock);
        return true;
    }

    size_t Size() {
        return m_set.size();
    }

    void Clear() {
        EnterCriticalSection(&m_lock);
        m_set.clear();
        LeaveCriticalSection(&m_lock);
    }

private:
    std::set<T> m_set;
    CRITICAL_SECTION m_lock;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:41:26.233

您的代码不是线程安全的，因为尽管您保护了关键部分中对集合的所有写入，但您不保护 Has() 中的读取。

因此，例如，当另一个线程擦除整个集合时，压力测试可以在 Has() 调用的中途进行。

请注意，critical_Section 是一个门，仅在其他 EnterCriticalSection() 调用时才检查它，并且 Has 中的 find 不使用它，因此当另一个线程在临界区中时，那里的代码不会停止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:52:22.790

考虑设计一种不同类型的锁，以增加并行度。

让我们看一下我们当前正在做的事情以及我们因此被允许做的事情的表格：

```
 Trying to:
                   |  Read  |  Write
           --------|--------|----------
           Nothing |  yes   |  yes
Currently  Reading |  yes   |  no
Doing:     Writing |  no    |  no 
```

只要没有其他线程正在写入，任何想要读取的线程都可以这样做，并且任何想要写入的线程只能在没有其他线程访问资源的情况下这样做。

请注意，如果没有此处未描述的一些额外工作，此解决方案将出现饥饿情况：尝试写入的线程可能必须等待很长时间才能完成所有读取线程，因为只要任何一个线程正在读取，写入线程将继续阻塞，但其他读取线程将能够获取它们的锁。

这对于您正在做的事情可能完全是矫枉过正，但如果您希望您的项目将充分分布，许多线程可能会尝试同时读取，那么它可能值得研究。我知道它不能直接回答您的问题，但是评论太长了，我认为它有可能有用。

# entity-framework-5 - EF5 和 Ado.Net

> ID：15536103
> 
> 赞同：0
> 
> 时间：2013-03-20T22:34:51.603
> 
> 标签：entity-framework-5, transactionscope

我有使用 Ado.Net 的现有代码，并且正在考虑集成一些使用实体框架 5 的新代码。作为概念证明，我想尝试使用 ado.net 和 EF5 进行事务操作。

我尝试使用 TransactionScope，但是当我使用“两个连接”时，我收到关于正在提升的事务的错误并且 DTC 不可用。

我可以让 Ado.Net 和 EF5 使用相同的连接来避免上述问题吗？如果是这样，任何代码示例....

任何其他建议表示赞赏。

顺便说一句，我首先使用的是 EF5 数据库。

提前感谢您的帮助。

问候，特拉维斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:44:10.797

可以，但前提是您配置了分布式事务协调器 (DTC)。DTC 事务比本地事务慢得多。

这可能会有所帮助：

[如何在 SQL Server 上启用 MSDTC？](https://stackoverflow.com/questions/7694/how-do-i-enable-msdtc-on-sql-server)

另一种选择是获取 EntityConnection 对象并获取 SqlConnection 并在您的 ADO.NET 命令中使用它，但您必须小心这一点，因为如果包含实体被释放，则连接可能会关闭。

或者，您可以在创建时将 EntityConnection 传递给上下文，从而允许对两者使用相同的连接。

# django - 在 django 1.5 CBV 中返回 HttpResponse 时的 simplejson 错误

> ID：15536104
> 
> 赞同：2
> 
> 时间：2013-03-20T22:34:52.327
> 
> 标签：django, json, django-views, simplejson

我对 Django 很陌生，尤其是 CBV。因此，我有一个带有 post 方法的 listView，我试图在其中输出 JSON，如下所示：

```
from django.utils import simplejson

class MyCoolListView(ListView):
   # template declaration and other stuff

    def get_context_data(self, **kwargs):
       # do some stuff
       return context

    def get_queryset(self):
       # do some stuff
       return queryset 

    def post( self, request, *args, **kwargs ):
       # check if user is authenticated and return json
       return HttpResponse( simplejson.dump({ "score": blogpost.score }) , content_type='application/json') 
```

但是，POST 上的 HttpResponse，我得到：

```
TypeError: dump() takes at least 2 arguments (1 given) 
```

我不完全确定我做错了什么（我已经用谷歌搜索了很多这个问题，但还没有运气） - 我想知道是否有人遇到过这种情况/错误消息。任何解决此问题的指导将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:35:37.013

[`dump`](http://docs.python.org/2.7/library/json.html#json.dump)用于转储到文件，你想要[`dumps`](http://docs.python.org/2.7/library/json.html#json.dumps).

# php - 尝试自动加载时如何绕过 ini_set disabled

> ID：15536109
> 
> 赞同：0
> 
> 时间：2013-03-20T22:35:33.683
> 
> 标签：php, spl-autoload-register, ini-set

我正在编写一个使用 Raven 的 WordPress 插件，它以下列方式使用自动加载：

```
ini_set('unserialize_callback_func', 'spl_autoload_call');
spl_autoload_register(array(new self, 'autoload')); 
```

但是，该插件的某些用户已被其主机提供商禁用了 ini_set，并且在激活插件时会引发错误：

警告：出于安全原因，ini_set() 已在...中禁用

在这种情况下，有没有办法使用 ini_set ？

我想我真正的问题是使用 spl_autoload_register 时是否需要 ini_set？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:08:15.260

[这个答案](https://stackoverflow.com/a/2405422/53212)表明您`unserialize_callback_func`在使用时可能不再需要设置`spl_autoload_register()`.

# android - 来自 Google Play Android Developer REST API 的可能错误代码列表

> ID：15536115
> 
> 赞同：6
> 
> 时间：2013-03-20T22:35:46.367
> 
> 标签：android, google-api, google-play

我目前正在使用 Google Play Android Developer REST API 来验证用户订阅服务器端。

我似乎得到了一些不同的错误消息。有些表示订阅不存在或无效，有些则表示“backendError”。

**问题：**我正在寻找可能的错误代码列表，以便确定是否应该再试一次或者它是否无效。

# ruby-on-rails - RSpec、Capybara 和带有 rails 的 ajax 请求

> ID：15536120
> 
> 赞同：0
> 
> 时间：2013-03-20T22:36:12.683
> 
> 标签：ruby-on-rails, ajax, rspec, capybara, poltergeist

所以我认为 javascript 方法看起来像这样：

```
window.getWeatherData = function () {
$.getJSON('/weather.json?building=RSF', function (response) {
  console.log(response)
  $('#dynamic-wrapper').show();
  $('#weather-meridan').html(response.meridan);
  $('#relative-humidity').html(response.rh);
  $('#outside-temp').html(response.temperature);
  $('#windspeed').html(response.windspeed);
  // TODO still need to get wind direction!
}).error(function () {
  $('#dynamic-wrapper').hide();
});
}

getWeatherData(); 
```

天气是我的应用程序中的控制器方法。我将如何处理响应，所以当我运行测试时，它可以工作？这是我的测试的样子：

```
before :each do
  MeterMapsController.any_instance.stub(:weather).and_return(
    :json => {:temperature => 98.6, :rh => 100, :windspeed => 20}
  )
end

it 'shows relative humidity' do
  visit '/dashboard/RSF/pv'
  find('span#relative-humidity').should have_content '100% Outside Relative Humidity'
end 
```

这是视图的简化版本`/dashboard/RSF/pv`

```
<div class='current-data'>
<span id='weather-time' class='digi'></span><span id='weather-meridan'></span>
  <span id="dynamic-wrapper">
    <span id='relative-humidity' class='digi'></span>% Outside Relative Humidity <br />
    <span id='outside-temp' class='digi'></span>ºF
    <span id='windspeed' class='digi'></span> mph Wind Speed<%# out of %>
    <span id='wind-direction'></span>
  </span>
</div>
<%= javascript_include_tag "weather.js" %> 
```

我究竟做错了什么？我的测试失败了，但它在浏览器中运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:46:18.553

`visit '/dashboard/RSF/pv'`正在执行 HTML 请求，您想要执行 JSON 请求，请尝试改用：

```
 get '/your/path', format: 'js' 
```

# ios - 一个 managedObjectContext 的 iOS 多个实体

> ID：15536121
> 
> 赞同：0
> 
> 时间：2013-03-20T22:36:12.843
> 
> 标签：ios, core-data, entity, managedobjectcontext

在我的 iOS 应用程序中有一个包含两个实体的核心数据模型。

**实体：单位/属性：unit_name - NSString**

->> 与`Exercise`( `one to many`)的关系

**实体：练习/属性：练习名称 - NSString 。**

所以一个`unit`可以有很多`exercises`。

在我的表视图控制器中列出了所有可用的`exercises`。（所以在第一次，我对`Exercise`实体和`managedObjectContext`指向该实体的点发出获取请求。

如果我想`"NEW"` `unit`用`exercises`保存功能保存一个不起作用。完全没有错误，但`unit`表仍然是空的。

这是保存功能的代码：

```
 Units *newUnit = [NSEntityDescription insertNewObjectForEntityForName:@"Units"   inManagedObjectContext:[self.coreDataHelper managedObjectContext]];
    newUnit.unit_name = unitTextField.text;//Attribute
    newUnit.exercises = exerciseSet;//Relationship (NSSet)

    NSError *error = nil;
    if (![[self.coreDataHelper managedObjectContext]save:&error]) {
        NSLog(@"There was an error! %@", error);
    }
    else {
        NSLog(@"Success!");
    } 
```

似乎`managedObjectContext`仍然指向`Exercise`实体。（因为它是第一次用这个实体初始化的）`coreDataHelper`有`NSPersistentStoreCoordinator`, `NSManagedObjectContext`, the`NSManagedObjectModel`和一些读写和删除方法。

感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T04:24:02.143

只是为了验证一切都按照应有的方式连接，添加

```
NSAssert(self.coreDataHelper, @"null coreDataHelper");
NSAssert(self.coreDataHelper.managedObjectContext, @"null MOC");
NSLog(@"available entities: %@", 
    self.coreDataHelper.managedObjectContext.persistentStoreCoordinator.managedObjectModel.entitiesByName); 
```

`"Units"`如果您已正确设置所有内容，您应该将其视为您的实体之一。

然后在插入 newUnit 后，验证它是否有效： NSAssert(newUnit, @"newUnit didn't get inserted");

顺便说一句，这对我来说听起来像是一个逻辑错误：每次保存时都在创建一个新的 Units 实例？您确定不想改用查找或创建模式吗？

# python - 有没有办法在 Hadoop 管理 Web 界面中从 mrjob 指定作业的标题？

> ID：15536122
> 
> 赞同：2
> 
> 时间：2013-03-20T22:36:21.250
> 
> 标签：python, mapreduce, hadoop-streaming, mrjob

我从 Python 库[mrjob](https://github.com/Yelp/mrjob)开始了几个不同的工作，包括具有多个步骤的工作。如何`streamjob`用自定义名称替换？例如, `wordcount_step_1`,`wordcount_step_2`等。

![Hadoop 管理的屏幕截图](../Images/097301a4089360546683f7c386ea32f8.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-10T06:01:25.170

当然，只需在执行作业时使用[--jobconf](http://pythonhosted.org/mrjob/guides/configs-hadoopy-runners.html)选项指定它。

例如：

```
if __name__ == '__main__':
    # Be careful, this appends all job args, if you have lots it could be a problem
    sys.argv.extend(["--jobconf", "mapred.job.name=%s" % " ".join(sys.argv)])
    MRYourJobClass.run() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-13T15:17:15.117

运行作业时添加选项：

```
--jobconf mapred.job.name=NameOfTheJob 
```

# ruby-on-rails - Rails link_to静态页面问题

> ID：15536123
> 
> 赞同：1
> 
> 时间：2013-03-20T22:36:22.793
> 
> 标签：ruby-on-rails, link-to

我对 Rails 知之甚少，我继承了这个项目。在过去的几天里，我一直在尝试了解“link_to”和“routes.rb”。这些东西让我发疯 - 我花了一整天的时间看着它，将一些代码粘贴到裸项目中，它可以在哪里工作......但我只是不明白我在这里遇到的错误，或者如何去关于解决它，所以如果你有任何想法......

在我的页面 _signed_in_header.html.erb 我有：

```
<a href="../staticpages/faq">FAQ</a> 
```

在我的 routes.rb 我有：

```
get "staticpages/faq" 
```

我知道这是正确设置的，因为当我从头开始一个示例项目时，它可以工作。

但是在我继承的这个特定项目中，我得到了错误：

```
NoMethodError in Staticpages#faq

Showing /home/christophecompaq/Populisto/app/views/layouts/_signed_in_header.html.erb    where line #48 raised:

undefined method `model_name' for NilClass:Class
Extracted source (around line #48):

45: 
46:       <div class='search-box'>
47:       <%= simple_form_for @review, :url => search_index_path, :method => :post,   :html => { :class => 'form-horizontal'} do |f| %>
48: 
49:         <%= f.input :search_ids, :collection => @data, :as => :grouped_chosen, 
50:                     :group_method => :last, :prompt => false,
51:                     :input_html => { :class => 'span5', :multiple => true }, 
Trace of template inclusion: app/views/layouts/_header.html.erb,     app/views/layouts/application.html.erb

Rails.root: /home/christophecompaq/Populisto

Application Trace | Framework Trace | Full Trace
app/views/layouts/_signed_in_header.html.erb:48:in  `_app_views_layouts__signed_in_header_html_erb___586079249_69970641688720'
app/views/layouts/_header.html.erb:1:in  `_app_views_layouts__header_html_erb__1905506502_69970640142220'
app/views/layouts/application.html.erb:21:in  `_app_views_layouts_application_html_erb___1868096314_69970642536740' 
```

编辑：我被要求显示我的审查控制器代码，所以这里是：

```
class ReviewsController < FrontEndController
respond_to :html, :json

before_filter :with_google_maps_api

def index
@review = Review.new
end

def create
@review = Review.create((params[:review] || {}).merge(:user_id => current_user.id))
if @review.save
  redirect_to landing_page, :notice =>    I18n.t('write_review.review_successfully_created')
else
  render :action => :index
end
end

def show
@review = Review.find(params[:id])
end

def edit
@review = Review.find(params[:id])
end

def update
@review = Review.find(params[:id])
if @review.update_attributes(params[:review])

else
  render :edit
end
end

def destroy
@review = Review.find(params[:id])
@review.destroy
end

def repost
@review = Review.find(params[:id])
@review.repost(current_user)
end

def reject
@review = Review.find(params[:id])
current_user.reject @review
end

end 
```

无论如何，如果您有任何想法可能出了什么问题，我很高兴知道....谢谢。

克里斯托夫。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:42:12.750

在您的路线文件中，使用此代码

```
get "staticpages/faq", :as => 'faq_page' 
```

'as' 将生成 2 个辅助函数：您可以在代码中`faq_page_url`使用`faq_page_path`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-07T12:07:59.533

我希望这会有所帮助，我认为我们有同样的问题，但我已经设法解决这个问题：

在我的 routes.rb

```
match 'pages/:action', :controller => "pages" 
```

在我看来：

```
= link_to "About", {:controller => 'pages', :action => 'about'} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T01:41:10.773

该错误发生在布局模板的呈现期间，而不是控制器视图。

如果您正在测试常见问题页面，您将点击 StaticpagesController，而不是您粘贴的 ReviewController，对吗？并且大概 StaticpagesController 没有设置 @review... 因此你的例外。

因此，要么尝试将搜索框代码包装在以下条件中：

```
<% if @review %>
  ... put your review search form here ...
<% end %> 
```

或者如果搜索应该出现在所有页面上，请确保它已填充在所有页面上。也许`before_filter`在你的基本控制器类上添加一个类似的东西

类应用程序控制器 < ....

```
 before filter :ensure_review_set

 private

 def ensure_review_set
    @review ||= Review.new
 end 
```

结尾

搜索表单也引用`@data`了该`search_ids`字段。这也需要由使用此布局的任何控制器初始化。

更一般地说，如果您的 rails 版本支持它，我会非常非常强烈地推荐[better_errors](https://github.com/charliesome/better_errors) gem 来快速调试此类错误。

# git - 如何获取整个 git 存储库

> ID：15536124
> 
> 赞同：7
> 
> 时间：2013-03-20T22:36:23.073
> 
> 标签：git

我不小心从源目录中删除了一些文件。我只需要重新获取整个 git 存储库（git pull 不起作用，因为这些文件自我上次提交以来没有更改）。我的存储库是最新的。如何获取整个存储库？如果它覆盖了那里的内容就可以了

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T22:41:09.837

您的 repo 文件已经在`.git`存储为 git 对象的目录中。您只需要将工作副本的状态切换为未触及的状态。

从 repo 的根目录运行以下命令以取消暂存您在 git 暂存区域中的任何更改：

```
git reset HEAD . 
```

然后运行以下命令，丢弃当前签出分支中的所有更改：

```
git checkout -- . 
```

`git pull`仅当您需要从远程存储库获取更新的更改到本地存储库并将当前分支的远程更改合并到本地存储库时才需要。至少根据我从您的问题中了解到的情况，`git pull`这不是必需的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:40:02.247

有两种简单的方法可以重置结帐：

```
git checkout . 
```

这会将您的结帐重置为当前分支的状态。

```
git reset --hard origin/master 
```

这会将您的结帐重置为远程跟踪分支的状态（假设是主分支）。如果您在本地进行了一些您不想保留的提交，这将很有用。

# android - Webview 不会从以前的活动中收到 getStringExtra

> ID：15536128
> 
> 赞同：0
> 
> 时间：2013-03-20T22:36:57.780
> 
> 标签：android, eclipse, webview, barcode, getstring

我正在尝试使用条形码扫描仪，然后获取该输入并在另一个活动中使用以使用 url 打开。我已经能够让数据返回，只是没有在另一个活动中，也没有看到任何类似的项目。我不确定它是否与意图或我如何调用字符串有关。第二个 java 中的 webview 工作但不接受字符串。谢谢您的帮助！

Scanner.java（工作正常）

```
package com.pangolin.rollin.ts;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

public class Scanner extends Activity {
TextView tvStatus;
TextView tvResult;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_scanner);
    Button websku = (Button) findViewById(R.id.btnsku);
    websku.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            Intent myintent = new Intent(Scanner.this, Websku.class);
            startActivity(myintent);
        }
    });

    tvStatus = (TextView) findViewById(R.id.tvStatus);
    tvResult = (TextView) findViewById(R.id.tvResult);

    Button scanBtn = (Button) findViewById(R.id.btnScan);

    // in some trigger function e.g. button press within your code you
    // should add:
    scanBtn.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            // TODO Auto-generated method stub

            try {

                Intent intent = new Intent(
                        "com.google.zxing.client.android.SCAN");
                intent.putExtra("SCAN_MODE", "QR_CODE_MODE,PRODUCT_MODE");
                startActivityForResult(intent, 0);

            } catch (Exception e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                Toast.makeText(getApplicationContext(), "ERROR:" + e, Toast.LENGTH_LONG)
                        .show();

            }

        }
    });

}

// In the same activity you’ll need the following to retrieve the results:
public void onActivityResult(int requestCode, int resultCode, Intent intent) {
    if (requestCode == 0) {

        if (resultCode == RESULT_OK) {
            tvStatus.setText(intent.getStringExtra("SCAN_RESULT_FORMAT"));
            tvResult.setText(intent.getStringExtra("SCAN_RESULT"));
        } else if (resultCode == RESULT_CANCELED) {
            tvStatus.setText("Press a button to start a scan.");
            tvResult.setText("Scan cancelled.");
        }
    }
}

} 
```

和 websku.java （不起作用，应该从以前的活动中获取结果。

```
package com.pangolin.rollin.ts;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.Window;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;

public class Websku extends Activity {
final Activity activity = this;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Intent intent = getIntent();
    String sku = intent.getStringExtra("SCAN_RESULT");
    this.getWindow().requestFeature(Window.FEATURE_PROGRESS);
    setContentView(R.layout.activity_websku);
    WebView webView = (WebView) findViewById(R.id.webview_sku);
    webView.getSettings().setJavaScriptEnabled(true);
    webView.setWebChromeClient(new WebChromeClient() {
        public void onProgressChanged(WebView view, int progress) {
            activity.setTitle("Loading...");
            activity.setProgress(progress * 100);

            if (progress == 100)
                activity.setTitle(R.string.title_activity_websku);
        }
    });

    webView.setWebViewClient(new WebViewClient() {
        @Override
        public void onReceivedError(WebView view, int errorCode,
                String description, String failingUrl) {
            // Handle the error
        }

        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }
    });

    webView.loadUrl("http://m.radioshack.com/radioshack/catalog/searchList.do?categoryId=&keyword="+sku);

    };
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:50:31.113

您没有为`Websku`意图设置任何额外内容：

```
websku.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {
        Intent myintent = new Intent(Scanner.this, Websku.class);
        startActivity(myintent);
    }
}); 
```

应该：

```
websku.setOnClickListener(new View.OnClickListener() {

    public void onClick(View v) {
        Intent myintent = new Intent(Scanner.this, Websku.class);
        myintent.putExtra("somename", somevalue);
        startActivity(myintent);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:50:55.150

您没有为 websku 活动设置额外内容。保存从扫描仪返回的意图：

```
private Intent mWebskuIntent;
public void onActivityResult(int requestCode, int resultCode, Intent intent) {
    if (requestCode == 0) {
        mWebskuIntent = intent;
        // more of your code 
```

然后，当您启动 websku Activity 时，复制保存的意图，这也将复制从扫描仪返回的附加内容：

```
Intent myintent = new Intent(mWebskuIntent);
myintent.setClass(Scanner.this, Websku.class);
startActivity(myintent); 
```

您可能还想检查 mWebskuIntent 是否为空。

# php - 检查页面是否包含 PHP 中的某些文本

> ID：15536130
> 
> 赞同：-1
> 
> 时间：2013-03-20T22:37:14.427
> 
> 标签：php

我有奇怪的问题。我正在尝试获取网页的内容（例如 Google）并检查页面是否包含一些文本。听起来像一个简单的任务，但我无法让它工作。运行这样的脚本后总是得到 FALSE

```
$site_url = "http://google.com";
$site = file_get_contents( $site_url );
//echo $site;

$pos = stripos($site,"window.chrome");
var_dump( $pos ); 
```

您知道如何在页面内进行搜索吗？什么是快速解决方案，因为我需要把它放在某个循环中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:42:26.823

`window.chrome``echo $site`如果您进行查找，则不存在

我的猜测是当浏览器加载时，相关的 javascript 被注入到页面中，并且`file_get_contents`不会触发任何操作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T22:42:12.347

请检查 的内容`$site`。它不包含“window.chrome”，因此得到`false`结果是有意义的。如果您搜索“window.google”，您将获得一个职位。

# backbone.js - 有没有办法使用 RequireJS 动态更改 Marionette ItemView 模板？

> ID：15536134
> 
> 赞同：7
> 
> 时间：2013-03-20T22:37:31.860
> 
> 标签：backbone.js, requirejs, marionette

我正在尝试在 Marionette CollectionView 中动态操作 itemView。这些集合具有相同的模型，但我在模型中定义了 templateName 参数。

问题是，我可以通过这个参数来操作 ItemView 模板吗？

项目视图：

```
define(['text!templates/ComponentItemViewTemplate.html','models/ComponentModel'], function (template, model) {
    var ItemView = Backbone.Marionette.ItemView.extend({
        template: _.template(template),
        model: model
    });

    return ItemView;
}); 
```

集合视图：

```
define(['views/ComponentItemView', 'views/LoadingView'], function(ItemView, LoadingView) {
    var ComponentListView = Backbone.Marionette.CollectionView.extend({
        emptyView : LoadingView,
        id: "component-list",
        itemView: ItemView, 
        events: {
            'click .title span' : 'show' 
        },
        appendHtml: function(collectionView, itemView, index){//i would like to render different templates, for different models.
            itemView.$el.draggable({ helper: "clone", cancel: ".component .title span", connectToSortable: ".ui-sortable" });
            collectionView.$el.append(itemView.el);
        },
        show: function(r) {
            var target = $(r.target);
            if( target.parent().hasClass('open') ){
                target.parent().removeClass('open');
                target.parent().next().slideDown('fast');
            }else{
                target.parent().addClass('open');
                target.parent().next().slideUp('fast');
            }
        }
    });

    return ComponentListView;
}); 
```

谢谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-07-02T09:11:51.723

您可以覆盖 getTemplate 函数并在那里编写您的自定义逻辑。[Marionette 文档推荐](https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.view.md#change-which-template-is-rendered-for-a-view)以下选项：

```
MyView = Backbone.Marionette.ItemView.extend({
  getTemplate: function(){
    if (this.model.get("foo")){
      return "#some-template";
    } else {
      return "#a-different-template";
    }
  }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-21T13:30:54.167

我认为口香糖头是在正确的轨道上。您可以重写该`getTemplate`函数来执行此操作。

```
 MyCollectionView = Marionette.CollectionView.extend({

  // ...

  getItemView: function(item){
    // get the template from the item... or wherever else it comes from
    return new MyViewType({
      template: item.get("the-template")
    });
  }

}); 
```

希望能做你需要的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T14:13:00.677

首先，我要感谢所有试图帮助我的人。我解决了我自己的问题。如果有人需要，这是解决方案：

```
define(['models/ComponentModel'], function (model) {

    var ItemView = Backbone.Marionette.ItemView.extend({
        model: model,
        render: function() {
            var that = this;
            var data = this.serializeData();

            require(['text!templates/components/editor/' + that.model.get('editor_template') + '.html'], function(Template){
                var html = _.template(Template, data);
                that.$el.html(html);
            });
        }
    });

    return ItemView;
}); 
```

编辑：（更好的解决方案）

欢迎提出建议！

# coffeescript - 真实性的 Coffeescript 快捷方式

> ID：15536139
> 
> 赞同：1
> 
> 时间：2013-03-20T22:37:57.677
> 
> 标签：coffeescript

我经常想检查一个变量或属性是否在 CS 中不为空且未定义。除了后缀之外，还有“真实”检查的快捷方式`?`吗`undefined`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:19:30.410

@Austin Mullins，这是真的，但我认为它会检查所有内容，并发现 CoffeeScript 编译器会根据变量的使用产生不同的结果。

使用前声明的变量（赋值）检查*!= null*。即使显式分配*undefined*（Javascript 编译为*void 0*返回 undefined）也不会改变编译器的行为。

结果是一样的吗？似乎按预期工作。

我发现的演示（预览链接），[http ://preview.tinyurl.com/cmo6xw7](http://preview.tinyurl.com/cmo6xw7)

按照链接并单击“运行”按钮（*右上角*）

编码...

```
((arg) ->
    str = "Hello World!"
    num = 42
    foo = arg

    # Lets see what the compiler produces  
    alert "str is #{str}" if str?
    alert "num is #{num}" if num?
    alert "foo is #{foo}" if foo?
    # bar has not been assigned a value or used until now
    alert "bar is #{bar}" if bar?

    # Lets assign str to something that isn't straight up null
    # cs will translate undefined into the expression that returns undefined
    str = undefined

    # Shorthand
    if str?
        alert "str? is #{str}"
    else
        alert "str? is empty"

    # Explicit checks
    if typeof str isnt "undefined" && str isnt null
        alert "str explicit check is #{str}"
    else
        alert "str explicit check is empty"

 ).call() 
```

# java - 第一次运行MyBatis时的错误信息

> ID：15536145
> 
> 赞同：1
> 
> 时间：2013-03-20T22:38:18.767
> 
> 标签：java, jboss, mybatis

第一次在JBOSS中运行我的应用程序时遇到一个奇怪的问题：错误信息是：

```
javax.servlet.ServletException: java.lang.IllegalArgumentException: Mapped Statements collection already contains value for project.services.dao.workerDAO.getAllWorkers
org.apache.struts.action.RequestProcessor.processException(RequestProcessor.java:535)
    org.apache.struts.action.RequestProcessor.processActionPerform(RequestProcessor.java:433)
    org.apache.struts.action.RequestProcessor.process(RequestProcessor.java:236)
    org.apache.struts.action.ActionServlet.process(ActionServlet.java:1196)
    org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:432)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)
    org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96) 
```

映射器文件：project.services.dao.sql.workerDAO.xml

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="project.services.dao.workerDAO">

    <select id="getAllWorkers" parameterType="java.lang.String"
        resultType="Worker">

         Select wrk.Id As workerId, wrk.Nm As workerName
         From Worker wrk

    </select>

</mapper> 
```

但是，第二次没有错误消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-03-20T09:58:59.530

我遇到了同样的麻烦，最后我发现原因是映射xml文件中有重复的SQL id。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:34:03.773

这似乎是 MyBatis 中的一个错误。java 类**`workerDAO`**不能与 mapper 同名**`workerDAO.xml`**。因此，尝试更改映射器以**`workerMapper.xml`**进行测试。请阅读这篇[文章](https://issues.apache.org/jira/browse/IBATIS-625)以获取更多信息。我希望它会有所帮助。

# node.js - 套接字方法的瓶颈？

> ID：15536150
> 
> 赞同：7
> 
> 时间：2013-03-20T22:38:48.667
> 
> 标签：node.js, websocket, socket.io

考虑创建一个用户可以协作的实时应用程序。发现 node.js + socket.io 是此类问题的解决方案之一。

我从其他开发人员那里听说，就我的服务器将提供给用户的套接字数量而言，将会存在瓶颈。因此，如果我有数百个用户同时协作，则打开的套接字数量将用完，用户将无法连接。这是一个有效的担忧吗？

**更新：**关于某种相关说明，我希望使用 SockJS 而不是 Socket.io。有一个[线程解释了这些库的优缺点](https://groups.google.com/forum/#!topic/sockjs/lgzxVnlth54/discussion)。这[也是一本好书](http://www.quora.com/How-do-I-scale-socket-io-servers-2)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T05:43:51.523

对于数百名用户，我认为这不是问题。

如您所知，套接字在客户端和服务器之间具有持久连接，并且双方可以随时开始发送数据。保持它们打开并不是一个问题，就像处理每秒发送的消息的负载一样。

Socket.io 可以轻松处理 1000 个并发连接。但如果每秒发送超过 8-10k 条消息，它将失败。在您的套接字耗尽之前，您将遇到负载障碍。在大多数情况下，处理更多并发用户会转化为更高的负载。所以不用担心套接字会变低。试图超越这个障碍需要更多的服务器资源。

有用的网址 ：

1.  [Socket.IO - 开放连接是否值得关注？](https://stackoverflow.com/questions/10933124/socket-io-are-the-open-connections-a-concern)
2.  [http://www.quora.com/How-do-I-scale-socket-io-servers-2](http://www.quora.com/How-do-I-scale-socket-io-servers-2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T22:02:28.520

已经有[使用这种方法的解决方案，例如 Cloud9](https://c9.io/site/blog/2012/09/smith-io-now-and-in-the-future/)，并且效果很好。将有一个点，您将需要向外扩展。因此，如果您正在计划一些大事，我会考虑一下。

以下是对具有 10,000 个并发连接[的 sockets.io 进行的一些测试。](http://weblog.bocoup.com/node-stress-test-analysis/)看起来这是一个很好的解决方案，但由于回退机制，这并不容易。

# intuit-partner-platform - realmId 并非来自 QBO 通过 OpenId 工作流程

> ID：15536152
> 
> 赞同：0
> 
> 时间：2013-03-20T22:38:54.663
> 
> 标签：intuit-partner-platform, quickbooks-online

我们正在尝试在我们的应用程序中实现 OpenId 以连接到 QBO。作为示例，我们使用 Intuit 提供的代码

[https://code.intuit.com/integration/viewvc/viewvc.cgi/IntuitAnywhere-.NET/HelloIntuitAnywhere/HelloIntuitAnywhere/OpenIdHandler.aspx.cs?root=intuitanywhere&system=exsy1003&view=markup](https://code.intuit.com/integration/viewvc/viewvc.cgi/IntuitAnywhere-.NET/HelloIntuitAnywhere/HelloIntuitAnywhere/OpenIdHandler.aspx.cs?root=intuitanywhere&system=exsy1003&view=markup)

问题是 realmId 为空，基本上它不是从 Intuit 登录页面返回到我们的应用程序的。所有其他数据都可以，例如姓名，电子邮件。

我们将属性定义为

```
fetch.Attributes.Add(new AttributeRequest(
    "http://axschema.org/intuit/realmId", true, 1)); 
```

我读到它在 Intuit 中关于设置一些 cookie 的错误。这是一个问题还是我做错了什么？

如果需要，我可以发布更多代码，但这与 Intuit 提供的示例非常相似。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T12:29:46.290

当客户授权通过 3 legged Oauth 流访问他们的数据时，realmid 将位于您提供的回调 url 的查询字符串上。

openId 工作流程并不总是导致客户选择 QuickBooks 公司。

在openid流程之后，调用javascript函数direct connect()，你会得到上面提到的oauth流程中的realm id

谢谢

# c# - 根据 FK 表中的记录返回列

> ID：15536154
> 
> 赞同：1
> 
> 时间：2013-03-20T22:39:06.743
> 
> 标签：c#, linq, entity-framework, linq-to-entities, entity-framework-5

我有一个显示供应商的成功查询，但我现在要添加的是显示已选择或未选择供应商的列（显示为复选框列）。这些选择存储在 VendorsSelected 表中，其中包含选择它们的 FK ProfileID 和 UserName。因此，当当前用户查看供应商时，将匹配某些供应商而不是其他供应商。

如何修改查询？请注意，下面的 Where 子句将仅获取当前用户选择的供应商，但我想要的是所有供应商都显示为他们选择的每个供应商的真/假（复选框）列。

```
public IEnumerable<BrowseVendorModel> BrowseVendors()
{
    IQueryable<BrowseVendorModel> viewModel = _db.VendorProfiles
        .Include("VendorsSelected")
        .Select(s => new BrowseVendorModel
        {
            ProfileID = s.ProfileID,
            Name = s.Name,
            CompanyName = s.CompanyName,
            City = s.City,
            State = s.State,
            DateCreated = s.DateCreated
        })
        .Where(x => x.VendorsSelected.Select(s => s.UserName).Contains(HttpContext.Current.User.Identity.Name))
        .OrderBy(v => v.ProfileID);

    return viewModel;
} 
```

![在此处输入图像描述](../Images/2a81bdd68881e367244d86048ea005a4.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:22:07.883

向视图模型添加一个属性`Selected`( )：`boolean`

```
public IEnumerable<BrowseVendorModel> BrowseVendors()
{
    IQueryable<BrowseVendorModel> viewModel = _db.VendorProfiles
        .Include("VendorsSelected")
        .Select(s => new BrowseVendorModel
        {
            ProfileID = s.ProfileID,
            Name = s.Name,
            CompanyName = s.CompanyName,
            City = s.City,
            State = s.State,
            DateCreated = s.DateCreated,
            Selected = x.VendorsSelected.Select(s => s.UserName)
                        .Contains(HttpContext.Current.User.Identity.Name)
        })
        .OrderBy(v => v.ProfileID);

    return viewModel;
} 
```

# facebook - 如何在 Facebook 图形 API 资源管理器中查询请求对象？

> ID：15536155
> 
> 赞同：0
> 
> 时间：2013-03-20T22:39:17.833
> 
> 标签：facebook, facebook-graph-api

我有一个请求 ID，我想获取请求 ID 对象。

当我在图形 api 资源管理器中输入请求 ID 时，我得到：“不支持的获取请求。”

知道怎么做吗？

我想要这个示例末尾的请求对象：[https ://developers.facebook.com/blog/post/464/](https://developers.facebook.com/blog/post/464/)

谢谢！

*编辑*我的代码：

首先，我在浏览器中输入：

```
https://www.facebook.com/dialog/apprequests?
  app_id=APP_ID&
  message=Facebook%20Dialogs%20are%20so%20easy!&
  redirect_uri=http://www.example.com/response 
```

然后检查 Chrome 中的响应，我可以在查询字符串参数下看到：

```
request:600744979955487
to[0]:6025656
to[1]:630243457
to[2]:100002049936997
to[3]:100003709530244 
```

这些是我向其发送请求的朋友的 ID 和请求 ID。

我使用该数据在 Graph Api Explorer 中构建此请求

```
/600744979955487_6025656 
```

我也试过：

```
/600744979955487 
```

两者都返回：

```
{
  "error": {
    "message": "Unsupported get request.", 
    "type": "GraphMethodException", 
    "code": 100
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T03:05:58.053

你需要打电话给`access_token`

> 要获取包含收件人用户的完整请求，您需要附加收件人用户 ID：

`https://graph.facebook.com/<REQUEST_OBJECT_ID>_<USER_ID>?access_token=APP_ACCESS_TOKEN`

> 或使用收件人用户访问令牌：

`https://graph.facebook.com/<REQUEST_OBJECT_ID>?access_token=USER_ACCESS_TOKEN`

-- [https://developers.facebook.com/docs/howtos/requests/](https://developers.facebook.com/docs/howtos/requests/)

# mysql - Unicorn 和 Rails 占用了 2 个 MySQL 连接

> ID：15536159
> 
> 赞同：2
> 
> 时间：2013-03-20T22:39:29.493
> 
> 标签：mysql, ruby-on-rails, activerecord, unicorn

我为每台服务器运行 10 个 Unicorn 工作人员，随着时间的推移，他们耗尽了所有 MySQL 连接，最终出现“连接太多”错误。开始时有 10 个连接，但逐渐增加到 20 个。

当我在生产环境（使用）上运行以下脚本时`SHOW PROCESSLIST`，我可以看到每个 IP（= 应用服务器）每个都有 20 个连接，其中应该是 10 - 是 Unicorn 工人数量的两倍。

```
result = ActiveRecord::Base.connection.execute 'show processlist'
result.group_by{|i| i[2].split(':').first }.map{|k,v| [k, v.size] }
 => [["192.168.1.2", 20], ["192.168.1.3", 20], ["192.168.1.4", 20], ... ] 
```

这是database.yml

```
production:
  adapter: mysql2
  ...
  pool: 1 
```

这是网络统计：

```
# netstat -an | grep :3306
tcp        0      0 192.168.1.2:58535   192.168.1.123:3306    ESTABLISHED
tcp        0      0 192.168.1.2:45021   192.168.1.123:3306    ESTABLISHED
tcp        0      0 192.168.1.2:58537   192.168.1.123:3306    ESTABLISHED
tcp        0      0 192.168.1.2:45119   192.168.1.123:3306    TIME_WAIT
...

# netstat -an | grep :3306 | wc -l
36
# netstat -an | grep :3306 | grep ESTABLISHED | wc -l
33 
```

我担心有一些`TIME_WAIT`- 它不应该存在，因为连接应该都是持久的 - 似乎工作人员的连接比必要的多。大量可用 RAM，无交换/OOM。

红宝石 2.0.0p0 / Rails 3.2.13

这是什么原因造成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T18:14:01.720

好的，感谢[@ono](http://twitter.com/ono)的建议，我发现原因是[New Relic](http://newrelic.com)代理在`NewRelic::Agent::Database::ConnectionManager#get_connection`.

[https://github.com/newrelic/rpm/blob/3.5.8.72/lib/new_relic/agent/database.rb#L158](https://github.com/newrelic/rpm/blob/3.5.8.72/lib/new_relic/agent/database.rb#L158)

此代码调用`ActiveRecord::Base.mysql2_connection`，而后者又调用`Mysql2::Client.new`，它不尊重连接池设置。

它仅在事务缓慢时发生（具有讽刺意味的是，此代码使数据库更加过载），因此编辑`newrelic.yml`

```
transaction_tracer:
  explain_enabled: false 
```

问题已经解决了！在 New Relic 解决这个问题之前，我会一直保持这种状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:05:57.640

大胆猜测，您是否有一个中间件可以打开与您的数据库服务器的连接？运行`$ rake middleware`以验证，sidekiq 例如您是一个原因，或任何其他需要自己连接到您的数据库服务器的组件

# php - 获取无线电组值

> ID：15536162
> 
> 赞同：1
> 
> 时间：2013-03-20T22:39:32.197
> 
> 标签：php, radio-group

我正在为多项选择题开发一个页面。用户只能为每个问题选择一个答案。我似乎无法检索单选按钮的值（1 表示正确答案）。

这是我使用的两个表的结构

```
CREATE TABLE IF NOT EXISTS `question` (
`q_id` int(10) NOT NULL AUTO_INCREMENT,
`q_qstn_no` int(11) NOT NULL,
`q_text` varchar(300) NOT NULL,
`q_chpt` int(11) NOT NULL,
PRIMARY KEY (`q_id`)
)
CREATE TABLE IF NOT EXISTS `answer` (
`a_id` int(6) NOT NULL AUTO_INCREMENT,
`q_id` int(10) NOT NULL,
`a_text` varchar(255) NOT NULL,
`a_value` tinyint(1) NOT NULL,
PRIMARY KEY (`a_id`)
) 
```

**包含无线电组的 HTML 表单。**

```
 <?php
    ini_set('display_errors',1);
    error_reporting(E_ALL ^ E_NOTICE);
    session_start();
    if(isset($_SESSION['tf1_sid']))
    {
    ?>
    <html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Untitled Document</title>
    </head>
    <body>
    <form id="form1" name="form1" method="post" action="ques_page_calc1.php">
    <p>Questions</p>
    <table width="900" border="0" cellpadding="4">
    <?php
    // db connect
    include("dbconn.php");
    // db query for questions
    $sql_q  = "SELECT q_id, q_qstn_no, q_text FROM question";
    $query_q = mysql_query($sql_q) or die("MySQL Error: " . mysql_error());
    // start loop for questions
    $rad2 = 0;
    while($data_q = mysql_fetch_array($query_q, MYSQL_ASSOC)){

    //        echo "<pre>";
    //        print_r($data_q);
    //        echo "</pre>";
    //        

        echo "<tr><td width='25' align='center' valign='top'><label><input name='q_no' size='1' type='hidden' value=". $data_q['q_qstn_no'] .">". $data_q['q_qstn_no'] ."</label></td>";
        echo "<td>". $data_q['q_text'] ."<br />";
        // db query for answers
        $sql_a = "SELECT a_id, a_text, a_value FROM answer WHERE q_id=".$data_q['q_id'];
        $query_a = mysql_query($sql_a) or die("MySQL Error: " . mysql_error());
        //$rad = 0;
        // start loop for answers
        while($data_a = mysql_fetch_array($query_a, MYSQL_ASSOC)){
            echo "<br /><table width='750' border='0'>";
            echo "<tr><td><label><input name='answer_".$rad2."' type='radio' value=". $data_a['a_value'] .">". $data_a['a_text'] . "</label></td></tr>";
            echo "</table>";
            //$rad++;
        }
        echo "</tr>";
        $rad2++;
    }
    echo "<tr><td><input name='Submit' type='submit' onClick='ques_page_calc1.php' value='Submit'></td></tr>";

    mysql_free_result($query_q);
    mysql_free_result($query_a);
    include("dbconn.php");

    ?>
    </table>
    </form>
    </body>
    </html>
    <?php
    }
    else
    {
    header("Location:s_login.php");
    }
    ?> 
```

**获取所选值的 PHP 文件**

```
 <?php
    ini_set('display_errors',1);
    error_reporting(E_ALL ^ E_NOTICE);
    // include db connection file
    include("dbconn.php");
    session_start();

    if(isset($_POST['Submit']))
    {   
$id = $_SESSION['tf1_sid'];
echo $id;
$correct = 0;
$ev_id = 1;

//db query to obtain i_id
$sql_i = "SELECT i_id FROM ins_stud WHERE s_id = '$id'";
$query_i = mysql_query($sql_i) or die("MySQL Error: " . mysql_error());
$data_i = mysql_fetch_array($query_i, MYSQL_ASSOC);
print_r($data_i);

// capture values from HTML form
if(!empty($_POST['answer_'.$rad2]))
{   
    foreach(($_POST['answer_'.$rad2]) as $ans)
    {
    echo $ans;
    var_dump($_POST);

    if($ans == 1)
        $correct = $correct + 1;
    }

    //echo $correct;

    // insert answer to table
    //$sql_eval = "INSERT INTO eval_set (ev_id, q_id, response, created) VALUES ('" . $ev_id . "', '" . $ques_no . "', '" . $ans . "', CURDATE())";
    //mysql_query($sql_eval) or die ("Error: " . mysql_error());
    //}
    }
    //  
    // insert result to table
    //$sql_result = "INSERT INTO result (r_score, ev_id, s_id, i_id) VALUES ('" . $correct . "', '" . $ev_id . "',  '" . $id . "',  '" . $data_i . "')";
    //mysql_query($sql_result) or die ("Error: " . mysql_error());

    //echo "Result: " . $correct . " questions correct.";   

    //header("Location:ass_result.php"); 
    }

    // close db connection
    mysql_close($dbconn);
    ?> 
```

我认为这`$_POST['answer_'.$rad2]`是导致问题的原因，因为我不确定如何将变量连接到名称字段。但是现在这种情况发生了变化，PHP 文件中仍然没有超出`print_r($data_i);`行的输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T05:15:59.120

我解决了它:) 我拿走了 if(!empty...) 并用这些替换它。

```
 for($i=1;$i<=$qno;$i++){
    $repStr = str_replace("1", $i, "answer_1");
    //echo "Question ". $i .": ". $repStr;
    $ans = $_POST[$repStr];
    //echo "". $radio ."<br>";

    if($ans == 1)
    $correct = $correct + 1;

    // everything before is FIXED :D

    // insert answer to table
    $sql_eval = "INSERT INTO eval_set (ev_id, q_id, response, created) VALUES ('MAX(ev_id)+1 ', '" . $i . "', '" . $ans . "', CURDATE())";
    mysql_query($sql_eval) or die ("Error: " . mysql_error());      
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:44:19.890

您不需要为您的单选组按钮指定不同的名称。您的所有选择都将有一个名称（例如“答案”），您的 PHP 脚本将简单地检查

```
$_POST['answer'] 
```

这将为您提供所选单选按钮的值。因此，无论您***对某个问题***有多少单选按钮，都给它们一个相同的名称，就可以了。这也将确保只能检查彼此相关的单选按钮之一。

# python - 在 python 中导入 Zookeeper libzookeeper_mt.so.2 时出错

> ID：15536171
> 
> 赞同：1
> 
> 时间：2013-03-20T22:40:02.870
> 
> 标签：python, linux, python-2.7, apache-zookeeper

我在尝试在 Python 中导入这个 .so 文件时遇到问题......我将它添加到我的`/etc/bashrc`并`source`让它重新加载......到目前为止没有运气......

`LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib`

该文件确实存在于`/usr/local/lib/lobzookeeper_mt.so.2`

```
 File "build/bdist.linux-x86_64/egg/zookeeper.py", line 7, in <module>
  File "build/bdist.linux-x86_64/egg/zookeeper.py", line 6, in __bootstrap__
ImportError: libzookeeper_mt.so.2: cannot open shared object file: No such file or directory 
```

我现在不知道该怎么做，有人知道我做错了什么吗？顺便说一句，我也在使用 Centos 6 64 位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:45:07.803

如果找不到您尝试加载的库的依赖项，尝试加载库将失败并显示“没有这样的文件或目录”。运行`ldd`：

```
ldd /path/to/your/library.so 
```

并查找“未找到”一词以检查是否是这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-25T10:36:30.747

`export LD_LIBRARY_PATH=/usr/local/lib`可以解决你的问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-26T03:31:26.567

1.  临时方式：export LD_LIBRARY_PATH=/usr/local/lib
2.  永久方式：编辑/root/.bashrc，添加以下行：
    *   导出 LD_LIBRARY_PATH=/usr/local/lib

# javascript - 引用文本文件的成熟 javascript

> ID：15536172
> 
> 赞同：1
> 
> 时间：2013-03-20T22:40:04.637
> 
> 标签：javascript, html, text, youtube, embed

```
<script type="text/javascript">
     //GET DATA FROM URL ...index.html?PageTitle,YOUTUBE_ID
     var DATA = window.location.search.replace( "?", "" );
     //STORE IN ARRAY FOR EASY ACCESS AND EXPANDABILITY
     DATA = DATA.split(",");
     //LOAD THE PAGE TITLE
     document.title = DATA[0]
     //UPDATE THE IFRAME SRC AFTER THE DOCUMENT LOADS
     window.onload=function()
     {
     var YouTube = document.getElementById('YouTube'); 
     YouTube.src = "http://www.youtube.com/embed/"+DATA[1]
     };
     </script> 

........<div class='content'>
        <iframe id="YouTube" width="853" height="480"
        frameborder="0" allowfullscreen>
        </div> 
```

我上面有这段代码，它允许我根据用户在 url 中输入的内容更改我的网站嵌入视频。但是我希望 url 更改为一个数字，但仍然根据 url 嵌入不同的视频，所以：

1：jidw82jIG8J 2：ksl9UH65Hn8 3：KNB7gvVsS9B

该网站的 url 将是 www.mysite.com/1 并且嵌入的视频将是 jidw82jIG8J 如果这有意义的话，我不知道如何去做，这个网站估计有 3000 个视频。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:47:38.317

我认为不会有一种自动的方式来获取数据，坦率地说，我不确定这是一个好主意。

话虽如此，您可能必须创建某种关联数组。

```
var lookup = {
    1: "jidw82jIG8J",
    2: "ksl9UH65Hn8",
    3: "KNB7gvVsS9B"
}; 
```

然后，当您解析 URL 后，您可以执行以下操作`lookup[1]`；

# asp.net-mvc - 在 MVC3 中处理创建控制器异常

> ID：15536174
> 
> 赞同：1
> 
> 时间：2013-03-20T22:40:19.103
> 
> 标签：asp.net-mvc, exception, inversion-of-control, unity-container, custom-errors

我有一个带有多个参数的控制器，我正在使用 Unity 创建该控制器的实例。问题是在某些情况下，Unity 无法构建我的构造函数所需的所有对象，因此它会引发异常。

> [MissingMethodException：没有为此对象定义无参数构造函数。]

如何处理此错误并向用户显示自定义错误页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T12:30:53.100

不要处理该错误，要么为实例化的所述对象创建无参数构造函数，要么不在构造函数中创建它们。处理这些异常只会掩盖问题。

# php - htaccess 将子域重定向到某个页面？

> ID：15536175
> 
> 赞同：0
> 
> 时间：2013-03-20T22:40:22.237
> 
> 标签：php, .htaccess

我需要将所有子域重定向到特定页面，而无需实际更改 URL，因为我将根据 URL 中的子域在此特定页面上显示不同的内容。

假设我的网站位于 testdomain.com/site1/

我希望将所有子域，例如 xyz.testdomain.com/site1/ 甚至 xyz.testdomain.com 重定向到[http://testdomain.com/site1/index.php/test.php的特定页面](http://testdomain.com/site1/index.php/test.php)

然后浏览器需要加载[http://testdomain.com/site1/index.php/test.php](http://testdomain.com/site1/index.php/test.php)，但 URL 仍然是 xyz.testdomain.com。

这样做的目的是让某人可以访问 abc.testdomain.com 或 xyz.testdomain.com，两者都会将用户带到 testdomain.com/site1/index.php/test.php，然后在 test.php，我有一些代码可以抓取 URL，如果 url 是 abc.testdomain.com，它将显示某些内容，而如果子域是 xyz.testdomain.com，它将显示不同的内容。

这是我可以在 htaccess 中做的事情吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:51:45.127

使用`mod_rewrite`你可以一起破解它。

```
# Step 1: If the user went to example.com or www.example.com
# then we don't want to redirect them. (S=1 says skip the next rule)
RewriteCond %{HTTP_HOST} ^(www\.)?example\.com
RewriteRule ^ - [S=1]

# Step 2: Anything else is redirected to our catcher script.

# Option 1: keeps the path they went to, but discards the domain
# i.e. xyz.example.com/abc/def.txt => /var/www/cgi-bin/abc/def.txt
RewriteRule ^/?(.*) /var/www/cgi-bin/$1 [QSA,L]

# Or Option 2: take all requests to the same file
# i.e. xyz.example.com/abc/def.txt => /var/www/cgi-bin/myfile.php
RewriteRule ^ /var/www/cgi-bin/myfile.php [QSA,L] 
```

`QSA`告诉它转发查询字符串，`L`告诉它停止寻找更多的重定向（不是绝对必要的，但如果你有很多这样的事情发生，有时会有所帮助）。

您还可以将变量作为查询参数传递给脚本，并且`QSA`标志确保它们不会替换原始值；

```
# xyz.example.com/abc/def.txt => /var/www/cgi-bin/myfile.php?host=xyz.example.com&path=/abc/def.txt
RewriteRule ^/?(.*) /var/www/cgi-bin/myfile.php?host=%{HTTP_HOST}&path=/$1 [QSA,L] 
```

这意味着您无需担心找出请求来自脚本内部的位置（这实际上可能是不可能的，我不确定）。相反，您可以将其作为普通参数读取（它也可以像普通参数一样被破解；请务必对其进行清理）。

# triggers - 有没有办法在 Google Scripts 中获取触发器的详细信息？

> ID：15536185
> 
> 赞同：1
> 
> 时间：2013-03-20T22:41:22.427
> 
> 标签：triggers, google-apps-script

基本上，我的目标是创建一个更简单的界面来管理控制 Google 脚本的基于时间的触发器 到目前为止，我还没有找到任何可以让我获得有关当前触发器的详细信息的东西，特别是触发时间。目前支持触发器管理的方法似乎只有少数几种。

文档： [类触发器](https://developers.google.com/apps-script/class_trigger)

感谢您的任何建议或指点！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T02:22:41.457

Apps 脚本文档还包含以[编程方式管理触发器](https://developers.google.com/apps-script/managing_triggers_programmatically)，这是一个非常有前途的标题。

但是，总结一下：

> 以编程方式修改现有触发器的唯一方法是删除它，然后创建一个新触发器。

有时我们会通过玩自动完成来找到未记录的 API，但此时似乎没有任何用于 Triggers 的 API。

我尝试了这个小宝石，希望得到充满触发信息的日志：

```
var triggers = ScriptApp.getProjectTriggers();
for (var i in triggers) {
  Logger.log(Utilities.jsonStringify(triggers[i]));
} 
```

我得到的只是`"Trigger"`令人作呕的重复。所以没有帮助，触发器对象被锁定。

令我惊讶的是，[问题跟踪器中没有针对触发器组件](https://code.google.com/p/google-apps-script-issues/issues/list?can=2&q=trigger%20component=Triggers&colspec=Stars%20Opened%20ID%20Type%20Status%20Summary%20Component%20Owner)的请求来添加 API 以获取这些附加信息或支持更多的可编程性。您应该添加一个，并在此处报告，以便其他人可以为它加注星标（投票）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T18:20:40.987

根据@Mogsdad 的建议，我已通过[问题跟踪器](https://code.google.com/p/google-apps-script-issues/issues/detail?id=2562)提交了功能请求 。请为此问题投票，并为该请求添加任何其他建议。这个问题相当广泛，如果创建了正确的 API，可能会有很多有用的详细信息。因此，如果您认为需要在当前 Trigger API 的扩展中解决某些部分，请在问题跟踪器中添加评论。

# xproc - 如何在 XProc 中动态生成 doctype 声明？

> ID：15536190
> 
> 赞同：2
> 
> 时间：2013-03-20T22:42:10.207
> 
> 标签：xproc

要求：

*   是在输出xml上添加正确的Doctype声明[输入xml的根元素可以是章节元素]。例如，考虑章节元素公共标识符是 PUBLIC“-//OASIS//DTD DocBook Chap XML V4.5//EN”，系统标识符是“chap.dtd”。与节元素公共标识符类似的是 PUBLIC“-//OASIS//DTD DocBook Sec XML V4.5//EN”，系统标识符是“sec.dtd”。

**输入 XML1：chapter.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook Chap XML V4.5//EN" "chap.dtd">
<chapter>
    <title>Chapter Template Title</title>
    <para>Text</para>
    <section>
        <title>Section Title</title>
        <para>Section text</para>
    </section>
</chapter> 
```

**输入 XML2：section.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook Chap XML V4.5//EN" "chap.dtd">
<section>
    <title>Section Title</title>
    <para>Section text</para>
</section> 
```

**XSLT 文件：test.xsl：**

样式表只是将输入 xml 复制到输出并在所有部分元素上添加 @sec 样式表将正确的 doctype 声明添加到输出 xml，因为输入 xml 根元素可以是或元素

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">

<xsl:template name="add-doctype-declaration">
    <xsl:choose>
        <xsl:when test="/chapter">
            <xsl:text disable-output-escaping="yes">
&lt;!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook Chap XML V4.5//EN" "chap.dtd"&gt;
</xsl:text>
        </xsl:when>
        <xsl:when test="/section">
            <xsl:text disable-output-escaping="yes">
&lt;!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook Sec XML V4.5//EN" "sec.dtd"&gt;
</xsl:text>
        </xsl:when>
    </xsl:choose>
</xsl:template>

<xsl:template match="/">
    <xsl:call-template name="add-doctype-declaration"/>
    <xsl:apply-templates/>
</xsl:template>

<!-- Identity Template -->
<xsl:template match="@*|*|processing-instruction()">
    <xsl:copy>
        <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
</xsl:template>

<xsl:template match="section">
    <xsl:copy>
        <xsl:apply-templates select="@*"/>
        <xsl:attribute name="sec">
            <xsl:number/>
        </xsl:attribute>
        <xsl:apply-templates/>
    </xsl:copy>
</xsl:template>

</xsl:stylesheet> 
```

**输入 XML1 的预期 output.xml**

```
<?xml version="1.0" encoding="utf-8"?> Input XML1:
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook Chap XML V4.5//EN" "chap.dtd">
<chapter>
    <title>Chapter Template Title</title>
    <para>Text</para>
    <section sec="1">
        <title>Section Title</title>
        <para>Section text</para>
    </section>
</chapter> 
```

**输入 XML2 的预期 output.xml**

```
<?xml version="1.0" encoding="utf-8"?> Input XML1:
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook Sec XML V4.5//EN" "sec.dtd">
<section sec="1">
    <title>Section Title</title>
    <para>Section text</para>
</section> 
```

使用任何 XSLT 引擎，转换工作都非常好，并且能够获得预期的输出

但是，如果转换是通过 XProc 完成的，我最终会出现以下错误。有人可以帮助解决此错误吗

err:XD0001 : XD0001 如果非 XML 资源在步骤输出中生成或到达步骤输入，则为动态错误。

**XProc 文件：test.xpl**

```
<?xml version="1.0" encoding="UTF-8"?>
<p:declare-step xmlns:p="http://www.w3.org/ns/xproc"
    xmlns:c="http://www.w3.org/ns/xproc-step" version="1.0" name="testing">
    <p:input port="source">
       <p:document href="chapter.xml"/>
    </p:input>
    <p:output port="result">
        <p:empty/>
    </p:output>

    <p:xslt version="1.0" name="transform">
        <p:input port="stylesheet">
            <p:document href="test.xsl"/>
        </p:input>
        <p:input port="parameters">
            <p:empty/>
        </p:input>
    </p:xslt>

   <!-- Assume that there is another transform happening for chapter/section xml -->
   <p:xslt version="1.0" name="transform2">
        <p:input port="stylesheet">
            <p:document href="test2.xsl"/>
        </p:input>
        <p:input port="parameters">
            <p:empty/>
        </p:input>
    </p:xslt>

    <p:store omit-xml-declaration="false" encoding="utf-8" name="serialize">
        <p:with-option name="href" select="output.xml"/>
    </p:store>

</p:declare-step> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:04:59.403

再看

这是两个简单的示例，表明您不需要将 Doctype 生成上下文化

第[http://www.sharexml.com/x/get?k=uWn0KA7RThnt](http://www.sharexml.com/x/get?k=uWn0KA7RThnt)

章节[http://www.sharexml.com/x/get?k=wAJlbUJfzIYQ](http://www.sharexml.com/x/get?k=wAJlbUJfzIYQ)

[回答后更新]

如果您希望该文档类型动态更改

第[http://www.sharexml.com/x/get?k=pBAwCds86RnQ](http://www.sharexml.com/x/get?k=pBAwCds86RnQ)

第[http://www.sharexml.com/x/get?k=JHEWghzgWIq1](http://www.sharexml.com/x/get?k=JHEWghzgWIq1)

希望这可以帮助

# php - 开发服务器和 repo 的文件结构

> ID：15536194
> 
> 赞同：1
> 
> 时间：2013-03-20T22:42:18.807
> 
> 标签：php, git, codeigniter, filesystems

我在 dev.mysite.com 有一个开发服务器，我正在使用 coda 和 git 提交并推送到具有指向我的开发域的 developmentmenet 分支的 repo。

目前的文件结构是这样的。截至目前，是否有人看到我应该重新考虑改变的任何事情。我问这个是因为在 dev 文件夹中有一个 public_html 或者什么。当前使用此设置时，当我加载 dev.mysite.com 时，它会显示 / 的索引，其中显示 .gitignore、.git 和 public_html。

```
../
    /dev
        /mysite.com
            .git
            .gitignore
            /application
            /public_html
                /assets
                index.php
            /system
        /mysecondsite.com
    /application
    /public_html
        /assets
        /index.php
    /system
    /sites
        /mysecondsite.com
            /application
            /system
            index.php 
```

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T18:42:10.390

如果你想拥有一个开发环境和一个生产环境。在 public_html 之外拥有 CI 的核心文件。您必须重新定义文档根目录。我假设您正在使用 cPanel 附带的服务器作为服务器的管理方式。

也就是说，您进入您的 cpanel 并在其中定义了`dev`子域，您应该能够编辑文档根文件夹。因此，在您的 dev 文件夹中的服务器上，您将添加一个 public_html ，就像我从上面的示例中收集到的那样。并使用您当前的 dev 文件夹设置添加`/public_html`到现在作为文件夹路径的字符串中。

一旦你这样做了，允许一两分钟让它从 cPanel 委托给服务器。并根据需要移动文件夹。

从那里，您找到根 index.php 并打开它，找到您的应用程序文件夹和系统文件夹的引用并更改它们以匹配他们现在应该寻找的路径。可能使用相对路径..即：`../../applications`例如。保存你的 index.php

假设您已经完成了所有正确的操作，那么您的 CI 副本应该可以正确加载，就像您没有像您想要的那样拆分文件夹中的所有内容时所做的那样。

# c# - 一系列浮点数中最大的不准确是什么？

> ID：15536200
> 
> 赞同：2
> 
> 时间：2013-03-20T22:42:55.397
> 
> 标签：c#, floating-point, precision

给定两个浮点值（`fLow`和`fHigh`），您如何计算两个连续值之间的最大或最大步幅/间隙？

例如：

在答案的范围内`16777217f`将`20000000f`是`2`，因为值有效地四舍五入到最接近的两个。

将其推广到任意范围让我摸不着头脑——有什么建议吗？

干杯，

这应该是语言中立的，但我使用的是 C#（我认为它符合 IEEE-754）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T23:05:27.227

这是在 C 中。它需要一些 IEEE 754 行为，用于舍入等。对于 IEEE 754 64 位二进制 ( `double`)，`SmallestPositive`为 2 ^(-1074) ，约 4.9406564584124654417656879286822137236505980261e - 324，DBL_EPSILON 为 2 ^(-52，2.220446049250313080847625-1368640626333) 对于 32 位二进制 ( `float`)，在它们出现的任何地方更改`DBL`to`FLT`和`double`to （以及to和to ，尽管它应该在没有这些更改的情况下工作）。然后是 2 ^(-149)，大约是 1.401298464324817070923729583289916131280261941876515771757068283889791e-45，FLT_EPSILON 是 2 ^(-23)， 1.1920928955078125e-07。`float``fabs``fabsf``fmax``fmaxf``SmallestPositive`

对于两个值之间的间隔，最大的步长当然是具有较大幅度的端点处的步长。（如果该端点恰好是 2 的幂，则从该点到下一个点的步长不会出现在区间本身中，因此这是一种特殊情况。）

```
#include <float.h>
#include <math.h>

/*  Return the ULP of q.

    This was inspired by Algorithm 3.5 in Siegfried M. Rump, Takeshi Ogita, and
    Shin'ichi Oishi, "Accurate Floating-Point Summation", _Technical Report
    05.12_, Faculty for Information and Communication Sciences, Hamburg
    University of Technology, November 13, 2005.
*/
double ULP(double q)
{
    // SmallestPositive is the smallest positive floating-point number.
    static const double SmallestPositive = DBL_EPSILON * DBL_MIN;

    /*  Scale is .75 ULP, so multiplying it by any significand in [1, 2) yields
        something in [.75 ULP, 1.5 ULP) (even with rounding).
    */
    static const double Scale = 0.75 * DBL_EPSILON;

    q = fabs(q);

    return fmax(SmallestPositive, q - (q - q * Scale));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:08:24.233

嗯，机器精度，顾名思义，实际上可能通常取决于机器，甚至取决于编译器。因此，要真正确定您通常必须编写一个实际测试正在发生的事情的程序。

但是，我怀疑您确实在寻找一些方便的公式，您可以使用这些公式来*估算*给定间隔内的最大距离。[关于机器 epsilon](http://en.wikipedia.org/wiki/Machine_epsilon)的 Wikipedia 文章对这个主题给出了非常好的概述，我在下面主要引用了这个来源。

设为`s`您的浮点表示的机器 epsilon（即，在标准浮点数的情况下约为 2^(-24)），则**归一化**数`x`与其邻居之间的最大间距为`2*s*|x|`. *规范化*这个词在这里非常重要，我什至不会尝试考虑非规范化数字的情况，因为这是事情变得非常糟糕的地方......

也就是说，在您的特定情况下，`h`您建议的间隔中的最大间距由 给出`h = 2*s*max(|fLow|, |fHigh|)`。

# xml - Xpath：如何获取我选择的节点的父节点？

> ID：15536203
> 
> 赞同：0
> 
> 时间：2013-03-20T22:43:08.930
> 
> 标签：xml, xpath

我在获取所选节点的父节点时遇到问题。我正在使用查询： // t [@ lemma = "de"] 。但我想得到包含的元素。我对xpath不太了解。现在我正在使用两个查询来尝试解决问题，但我认为没有必要。我的xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<xml>
    <corpus> 
        <body>
            <s id="s16" ref="16" source="Running text" forest="1" text="DECLARARAL A ExtinÃ§Ã£o da Punibilidade do RÃ©u, Em RazÃ£o da PrescriÃ§Ã£o da PretensÃ£o Punitiva, Fulcro Em os ARTIGOS 107, Inciso IV, Combinado Com O ARTIGO 109, Inciso VI (RedaÃ§Ã£o Anterior Ã Lei NÂº.">
                <graph root="s16_500">
                    <terminals>
                        <t id="s16_1" word="DECLARARAL" lemma="DECLARARAL" pos="prop" morph="--" extra="cjt-head cjt-head-X" />
                        <t id="s16_2" word="A" lemma="o" pos="art" morph="F S" extra="artd" />
                        <t id="s16_3" word="ExtinÃ§Ã£o" lemma="ExtinÃ§Ã£o" pos="prop" morph="--" extra="cjt-X" />
                        <t id="s16_4" word="de" lemma="de" pos="prp" morph="--" extra="sam-" />
                        <t id="s16_5" word="a" lemma="o" pos="art" morph="F S" extra="-sam artd" />
                        <t id="s16_6" word="Punibilidade" lemma="punibilidade" pos="n" morph="F S" extra="prop percep-f" />
                        <t id="s16_7" word="de" lemma="de" pos="prp" morph="--" extra="sam-" />
                        <t id="s16_8" word="o" lemma="o" pos="art" morph="M S" extra="-sam artd" />
                        <t id="s16_9" word="RÃ©u" lemma="rÃ©u" pos="n" morph="M S" extra="prop H" />
                        <t id="s16_10" word="," lemma="--" pos="pu" morph="--" extra="--" />
                        <t id="s16_11" word="Em_RazÃ£o" lemma="Em_RazÃ£o" pos="prop" morph="--" extra="cjt-X" />
                        <t id="s16_12" word="de" lemma="de" pos="prp" morph="--" extra="sam-" />
                        <t id="s16_13" word="a" lemma="o" pos="art" morph="F S" extra="-sam artd" />
                        <t id="s16_14" word="PrescriÃ§Ã£o" lemma="prescriÃ§Ã£o" pos="n" morph="F S" extra="prop conv" />
                        <t id="s16_15" word="de" lemma="de" pos="prp" morph="--" extra="sam-" />
                        <t id="s16_16" word="a" lemma="o" pos="art" morph="F S" extra="-sam artd" />
                        <t id="s16_17" word="PretensÃ£o_Punitiva" lemma="PretensÃ£o_Punitiva" pos="prop" morph="--" extra="--" />
                        <t id="s16_18" word="," lemma="--" pos="pu" morph="--" extra="--" />
                        <t id="s16_19" word="Fulcro" lemma="fulcro" pos="n" morph="M S" extra="cjt-X part-build Labs" />
                        <t id="s16_20" word="Em" lemma="em" pos="prp" morph="--" extra="sam-" />
                        <t id="s16_21" word="os" lemma="o" pos="art" morph="M P" extra="artd -sam" />
                        <t id="s16_22" word="ARTIGOS_107" lemma="ARTIGOS_107" pos="prop" morph="--" extra="--" />
                        <t id="s16_23" word="," lemma="--" pos="pu" morph="--" extra="--" />
                        <t id="s16_24" word="Inciso_IV" lemma="Inciso_IV" pos="prop" morph="--" extra="cjt-X" />
                        <t id="s16_25" word="," lemma="--" pos="pu" morph="--" extra="--" />
                        <t id="s16_26" word="Combinado_Com" lemma="Combinado_Com" pos="prop" morph="--" extra="cjt-X" />
                        <t id="s16_27" word="O" lemma="o" pos="art" morph="M S" extra="artd" />
                        <t id="s16_28" word="ARTIGO_109" lemma="ARTIGO_109" pos="prop" morph="--" extra="cjt-X" />
                        <t id="s16_29" word="," lemma="--" pos="pu" morph="--" extra="--" />
                        <t id="s16_30" word="Inciso_VI" lemma="Inciso_VI" pos="prop" morph="--" extra="cjt-X" />
                        <t id="s16_31" word="(" lemma="--" pos="pu" morph="--" extra="--" />
                        <t id="s16_32" word="RedaÃ§Ã£o_Anterior_Ã_Lei_NÂº" lemma="RedaÃ§Ã£o_Anterior_Ã_Lei_NÂº" pos="prop" morph="--" extra="cjt-X" />
                        <t id="s16_33" word="." lemma="--" pos="pu" morph="--" extra="--" />
                    </terminals>

                    <nonterminals>
                        <nt id="s16_500" cat="s">
                            <edge label="X" idref="s16_501" />
                        </nt>
                        <nt id="s16_501" cat="par">
                            <edge label="CJT" idref="s16_1" />
                            <edge label="CJT" idref="s16_502" />
                            <edge label="PU" idref="s16_10" />
                            <edge label="CJT" idref="s16_507" />
                            <edge label="PU" idref="s16_18" />
                            <edge label="CJT" idref="s16_512" />
                            <edge label="PU" idref="s16_23" />
                            <edge label="CJT" idref="s16_24" />
                            <edge label="PU" idref="s16_25" />
                            <edge label="CJT" idref="s16_26" />
                            <edge label="CJT" idref="s16_515" />
                            <edge label="PU" idref="s16_29" />
                            <edge label="CJT" idref="s16_30" />
                            <edge label="PU" idref="s16_31" />
                            <edge label="CJT" idref="s16_32" />
                            <edge label="PU" idref="s16_33" />
                        </nt>
                        <nt id="s16_502" cat="np">
                            <edge label="DN" idref="s16_2" />
                            <edge label="H" idref="s16_3" />
                            <edge label="DN" idref="s16_503" />
                        </nt>
                        <nt id="s16_503" cat="pp">
                            <edge label="H" idref="s16_4" />
                            <edge label="DP" idref="s16_504" />
                        </nt>
                        <nt id="s16_504" cat="np">
                            <edge label="DN" idref="s16_5" />
                            <edge label="H" idref="s16_6" />
                            <edge label="DN" idref="s16_505" />
                        </nt>
                        <nt id="s16_505" cat="pp">
                            <edge label="H" idref="s16_7" />
                            <edge label="DP" idref="s16_506" />
                        </nt>
                        <nt id="s16_506" cat="np">
                            <edge label="DN" idref="s16_8" />
                            <edge label="H" idref="s16_9" />
                        </nt>
                        <nt id="s16_507" cat="np">
                            <edge label="H" idref="s16_11" />
                            <edge label="DN" idref="s16_508" />
                        </nt>
                        <nt id="s16_508" cat="pp">
                            <edge label="H" idref="s16_12" />
                            <edge label="DP" idref="s16_509" />
                        </nt>
                        <nt id="s16_509" cat="np">
                            <edge label="DN" idref="s16_13" />
                            <edge label="H" idref="s16_14" />
                            <edge label="DN" idref="s16_510" />
                        </nt>
                        <nt id="s16_510" cat="pp">
                            <edge label="H" idref="s16_15" />
                            <edge label="DP" idref="s16_511" />
                        </nt>
                        <nt id="s16_511" cat="np">
                            <edge label="DN" idref="s16_16" />
                            <edge label="H" idref="s16_17" />
                        </nt>
                        <nt id="s16_512" cat="np">
                            <edge label="H" idref="s16_19" />
                            <edge label="DN" idref="s16_513" />
                        </nt>
                        <nt id="s16_513" cat="pp">
                            <edge label="H" idref="s16_20" />
                            <edge label="DP" idref="s16_514" />
                        </nt>
                        <nt id="s16_514" cat="np">
                            <edge label="DN" idref="s16_21" />
                            <edge label="H" idref="s16_22" />
                        </nt>
                        <nt id="s16_515" cat="np">
                            <edge label="DN" idref="s16_27" />
                            <edge label="H" idref="s16_28" />
                        </nt>
                    </nonterminals>
                </graph> 
            </s>
        </body>
    </corpus>
</xml> 
```

有人能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:47:50.873

您可以像这样获取父节点：

```
//t[@lemma="de"]/.. 
```

这就像 Unix shell：

```
cd .. 
```

代表*父目录的更改目录*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:18:27.157

从您的评论中：

> 我所需要的只是`<s>`条件下的标签`t[@lemma = 'de']`

在这种情况下，您需要的是类似

```
//s[graph/terminals/t/@lemma = 'de'] 
```

*如果集合中的任何*节点具有所需的值，则一侧是节点集的 = 比较成功。

# php - 'mod_rewrite' 和 PHP 的漂亮 URL

> ID：15536205
> 
> 赞同：1
> 
> 时间：2013-03-20T22:43:29.033
> 
> 标签：php, mod-rewrite

我正在尝试使用 PHP/.htaccess 获取漂亮的 URL，但是我收到 500 个服务器错误并且找不到我做错了什么。

这是我使用的 .htaccess 文件：

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /bulkmailer/

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d

    RewriteRule ^(.*)/(.*)/(.*)/ /bulkmailer/index.php?prefix=$1&controller=$2&action=$3 [L]
    RewriteRule ^(.*)/(.*)/(.*) /bulkmailer/index.php?prefix=$1&controller=$2&action=$3 [L]
    RewriteRule ^(.*)/(.*)/ /bulkmailer/index.php?controller=$1&action=$2 [L]
    RewriteRule ^(.*)/(.*) /bulkmailer/index.php?controller=$1&action=$2 [L]
    RewriteRule ^(.*)/ /bulkmailer/index.php?controller=$1 [L]
    RewriteRule ^(.*) /bulkmailer/index.php?controller=$1 [L]
</IfModule> 
```

我可以找到一个错误日志：

```
[Wed Mar 20 23:44:30.232417 2013] [core:error] [pid 5432:tid 1656] [client ::1:4653] AH00124: Request exceeded the limit of 10 internal redirects due to probable configuration error. Use 'LimitInternalRecursion' to increase the limit if necessary. Use 'LogLevel debug' to get a backtrace.
[Wed Mar 20 23:44:34.601496 2013] [core:error] [pid 5432:tid 1660] [client ::1:4654] AH00124: Request exceeded the limit of 10 internal redirects due to probable configuration error. Use 'LimitInternalRecursion' to increase the limit if necessary. Use 'LogLevel debug' to get a backtrace.
[Wed Mar 20 23:44:34.601496 2013] [core:error] [pid 5432:tid 1660] [client ::1:4654] AH00124: Request exceeded the limit of 10 internal redirects due to probable configuration error. Use 'LimitInternalRecursion' to increase the limit if necessary. Use 'LogLevel debug' to get a backtrace. 
```

我究竟做错了什么？

# ios - AFNetworking AFHTTPClient AFHttpRequestOperation 在 POST 上的死锁

> ID：15536207
> 
> 赞同：3
> 
> 时间：2013-03-20T22:43:39.393
> 
> 标签：ios, multithreading, deadlock, afnetworking

我遇到了一个奇怪的问题，文件上传似乎挂断了，而我的应用程序没有挂起。我假设这是 AFHTTPClient 内部的某种死锁，尽管它可能是我的托管服务提供商（机架空间云站点）。这里有一些提示，请注意这种情况很少见，但似乎最常发生在一次打开多个连接时。

1.  它发生在 WIFI 和 Cell 数据网络上
2.  我正在使用显示 100% 的上传进度块
3.  网络活动微调器正在旋转
4.  您可以让应用程序永远坐在那里，直到您在应用程序响应的文件上传上点击“取消”并且上传成功取消并调用我的完成块之前，似乎什么都没有发生。再次点击上传后，它会立即使用相同的 NSData 文件和新操作。
5.  其他连接开始/完成，而上传挂在那里 100%
6.  我的服务器日志显示在挂起期间没有收到连接的迹象。并且没有重复上传。
7.  上传是从后台线程开始的，但我相信如果我的代码有问题，那么上传永远不会走到这一步。线程中的最后一行代码是我将新创建的上传操作添加到 AFHTTPClient 队列的行。

有任何想法吗？

# stream - 使用rabbitmq订阅和取消订阅实时数据的数据缓冲区

> ID：15536208
> 
> 赞同：0
> 
> 时间：2013-03-20T22:43:49.243
> 
> 标签：stream, buffer, rabbitmq, publish-subscribe

基本上我想创建一个客户端可以偶尔订阅的数据缓冲区，从最后一段时间获取所有数据，继续监听实时数据，然后在一段时间后取消订阅，然后重复。

我正在考虑使用过期的 TTL rabbitmq 队列。这个想法是让客户偶尔订阅和取消订阅它。当客户端订阅队列时，它应该获取队列上所有可用的消息。然后客户端将保持在频道上以将实时数据推送给他们。

这是解决这个问题的好方法吗？我知道如何在rabbitmq 上发布/订阅。我该如何制作，以便每次客户端订阅时都会将所有数据推送到队列中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T07:12:30.570

这取决于您在谈论多少数据。您的方法的缺点是，如果数据速率很高并且 TTL 设置很长时间，队列可能会填满大量数据。您还必须保持队列处于活动状态。并且您必须从一开始就为每个可能的订阅者设置一个队列。

我建议[最近的历史交换](https://github.com/videlalvaro/rabbitmq-recent-history-exchange)也许修改它，以便它包含更多的消息。

# testing - 在 selenium 网格节点上运行任意命令/程序

> ID：15536209
> 
> 赞同：6
> 
> 时间：2013-03-20T22:43:49.753
> 
> 标签：testing, selenium, selenium-webdriver

在运行测试之前，是否可以在 selenium 节点上运行任意 OS 程序？

为什么我需要这么奇怪的东西：

在 Web 应用程序的一项测试中，我需要模拟鼠标悬停 1 秒，但问题是 - 如果浏览器窗口上有鼠标指针，则 selenium webdriver 不会长时间保持鼠标悬停事件。它在几毫秒后被中断，之后真正的鼠标指针开始发出 mouseover 事件。

所以我想尝试的是运行一个简单的程序，将鼠标光标移动到屏幕角落而不干扰浏览器窗口。

有任何想法吗？

**UPD**：在启动将光标移动到角落的特定驱动程序之前创建了一个简单的应用程序来运行：[https ://github.com/zerkms/MoveCursor](https://github.com/zerkms/MoveCursor)

# bash - cygwin中bash的加载时间慢

> ID：15536212
> 
> 赞同：19
> 
> 时间：2013-03-20T22:43:57.040
> 
> 标签：bash, debugging, cygwin, bash-completion

目前 bash 需要大约 2 秒才能加载。我已经用`-x`flag 运行了 bash，我看到了输出，似乎 PATH 在 cygwin 中被加载了很多次。有趣的是我在 linux 环境中使用相同的文件，但它工作正常，没有重新加载问题。以下是否会导致问题？

```
if [ `uname -o` = "Cygwin" ]; then
    ....
fi 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-26T20:57:41.503

正如您在回答中指出的那样，问题在于 Cygwin 的 bash-completion 包。快速简单的解决方法是禁用 bash-completion，正确的方法是运行 Cygwin 的 setup.exe（如果需要，请[再次下载）并选择卸载该软件包。](http://cygwin.com/install.html)

更长的解决方案是处理文件`/etc/bash_completion.d`并禁用您不需要的文件。在我的系统上，减慢 Bash 加载时间的最大罪魁祸首（mailman、shadow、dsniff 和 e2fsprogs）都没有做任何事情，因为没有安装它们被创建来完成的工具。

如果您将文件重命名`/etc/bash_completion.d`为具有`.bak`扩展名，它将停止加载该脚本。以这种方式在我的一个系统上禁用了除选定的 37 个脚本之外的所有脚本后，我将 bash_completion 加载的平均时间缩短了 95%（6.5 秒到 0.3 秒）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-02-18T14:32:59.410

就我而言，那是 Windows 域控制器。我这样做是为了找到问题：

我从一个简单的 windows 开始，`cmd.exe`然后输入：
`c:\cygwin\bin\strace.exe c:\cygwin\bin\bash`

就我而言，我注意到以下顺序：

```
 218   12134 [main] bash 11304 transport_layer_pipes::connect: Try to connect to named pipe: \\.\pipe\cygwin-c5e39b7a9d22bafb-lpc
     45   12179 [main] bash 11304 transport_layer_pipes::connect: Error opening the pipe (2)
     39   12218 [main] bash 11304 client_request::make_request: cygserver un-available
1404719 1416937 [main] bash 11304 pwdgrp::fetch_account_from_windows: line: <CENSORED_GROUP_ID_#1>
    495 1417432 [main] bash 11304 pwdgrp::fetch_account_from_windows: line: <CENSORED_GROUP_ID_#2>
    380 1417812 [main] bash 11304 pwdgrp::fetch_account_from_windows: line: <CENSORED_GROUP_ID_#3>

    etc... 
```

关键是确定`client_request::make_request: cygserver un-available`线路。您可以看到，在那之后，cygwin 如何尝试从 Windows 中获取每个组，并且执行时间变得疯狂。

一个快速的谷歌揭示了 a`cygserver`是什么： [https ://cygwin.com/cygwin-ug-net/using-cygserver.html](https://cygwin.com/cygwin-ug-net/using-cygserver.html)

> Cygserver 是一个旨在作为后台服务运行的程序。它为 Cygwin 应用程序提供需要安全仲裁或需要在没有其他 cygwin 应用程序运行时持续存在的服务。

解决方案是，运行`cygserver-config`然后`net start cygserver`启动 Windows 服务。Cygwin 的启动时间在那之后显着下降。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-04-23T20:10:00.360

所有答案都指的是旧版本的 bash_completion，与最近的`bash_completion`.

现代 bash_completion 默认将大部分完成文件移动到`/usr/share/bash-completion/completions`，通过运行检查系统上的路径

```
# pkg-config --variable=completionsdir bash-completion
/usr/share/bash-completion/completions 
```

那里有很多文件，每个命令一个，但这不是问题，因为它们是在您第一次对每个命令使用完成时按需加载的。`/etc/bash_completion.d`仍然支持旧版本以实现兼容性，并且在`bash_completion`启动时会加载其中的所有文件。

```
# pkg-config --variable=compatdir bash-completion
/etc/bash_completion.d 
```

使用此脚本检查旧目录中是否有任何陈旧文件。

```
#!/bin/sh
COMPLETIONS_DIR="$(pkg-config --variable=completionsdir bash-completion)"
COMPAT_DIR="$(pkg-config --variable=compatdir bash-completion)"
for file in "${COMPLETIONS_DIR}"/*; do
    file="${COMPAT_DIR}/${file#${COMPLETIONS_DIR}/}"
    [ -f "$file" ] && printf '%s\n' $file
done 
```

它打印 compat 目录中的文件列表，这些文件也存在于较新的（按需）完成目录中。除非您有特定理由保留其中一些文件，否则请查看、备份和删除所有这些文件。

结果，兼容目录应该大部分是空的。

现在，对于最有趣的部分 - 检查`bash`启动缓慢的原因。如果您只是运行`bash`，它将启动一个*非登录的交互式*shell - 这是 Cygwin 源代码上的一个`/etc/bash.bashrc`，然后是`~/.bashrc`. 这很可能不包括 bash 完成，除非您从 rc 文件之一获取它。如果您运行`bash -l`( `bash --login`)、启动`Cygwin Terminal`(取决于您的`cygwin.bat`) 或通过 SSH 登录，它将启动一个*登录的交互式*shell - 它将获取`/etc/profile`、`~/.bash_profile`和上述 rc 文件。`/etc/profile`脚本`.sh`本身在`/etc/profile.d`.

您可以检查每个文件需要多长时间才能获取。在以下位置找到此代码`/etc/profile`：

```
for file in /etc/profile.d/*.$1; do
  [ -e "${file}" ] && . "${file}"
done 
```

备份它，然后用这个替换它：

```
for file in /etc/profile.d/*.$1; do
  TIMEFORMAT="%3lR ${file}"
  [ -e "${file}" ] && time . "${file}"
done 
```

开始`bash`，您将看到每个文件花费了多长时间。调查需要大量时间的文件。就我而言，它是`bash_completion.sh`and `fzf.sh`（fzf 是模糊查找器，对 bash_completion 的一个非常好的补充）。现在的选择是禁用它或进一步调查。由于我想继续`fzf`在 bash 中使用快捷方式，因此我进行了调查，找到了减速的根源，对其进行了优化，并将我的补丁提交给了 fzf 的 repo（希望它会被接受）。

现在是最大的时间花费者 - `bash_completion.sh`。基本上就是脚本来源`/usr/share/bash-completion/bash_completion`。我备份了那个文件，然后编辑了它。在最后一页有一个`for`循环，它获取`compat`dir -中的所有文件`/etc/bash_completion.d`。再次，我添加了`TIMEFORMAT`and `time`，并查看了导致启动缓慢的脚本。它是`zzz-fzf`（`fzf`包）。我调查并发现一个子shell（`$()`）在循环中多次执行`for`，重写了该部分而不使用子shell，使脚本快速运行。我已经将我的补丁提交给了 fzf 的仓库。

所有这些减速的最大原因是：`fork`不受 Windows 进程模型的支持，Cygwin 在模拟它方面做得很好，但与真正的 UNIX 相比，它的速度慢得令人痛苦。一个 subshel​​l 或一个只做很少工作的管道将大部分的执行时间花在`fork`-ing 上。例如，比较（我的 Cygwin 上的`time echo msg`0.000 秒）与`time echo $(echo msg)`（我的 Cygwin 上的 0.042 秒）的执行时间——白天和黑夜。这`echo`命令本身不会花费太多时间来执行，但是创建一个子shell 是非常昂贵的。在我的 Linux 系统上，这些命令分别需要 0.000 秒和 0.001 秒。Cygwin 的许多软件包都是由使用 Linux 或其他 UNIX 的人开发的，并且可以在未经修改的情况下在 Cygwin 上运行。因此，这些开发人员自然而然地可以在方便的地方随意使用子shell、管道和其他功能，因为他们不会感觉到对他们的系统有任何显着的性能影响，但是在 Cygwin 上，这些 shell 脚本的运行速度可能会慢几十到几百倍。

底线，如果 shell 脚本在 Cygwin 中运行缓慢 - 尝试定位`fork`调用源并重写脚本以尽可能消除它们。例如`cmd="$(printf "$1" "$2")"`（使用一个 fork 作为 subshel​​l）可以替换为`printf -v cmd "$1" "$2"`.

男孩，它出来的时间很长。读到这里的人都是真正的英雄。谢谢 ：）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-10-24T20:11:49.663

我知道这是一个旧线程，但是在本周全新安装 Cygwin 后，我仍然遇到这个问题。

我没有手工挑选所有的 bash_completion 文件，而是使用这一行来实现 @me_and 的方法来处理我机器上没有安装的任何东西。这对我来说显着减少了 bash 的启动时间。

在`/etc/bash_completion.d`中，执行以下操作：

```
for i in $(ls|grep -v /); do type $i >/dev/null 2>&1 || mv $i $i.bak; done 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-03-11T20:11:51.033

`PATH`与原始问题有关的旧线程的新答案。

大多数其他答案都与 bash 启动有关。如果您在`bash -i`shell 中运行时看到加载时间很慢，那么这些可能适用。

在我的情况下，`bash -i`运行速度很快，但每当我打开一个新的 shell（无论是在终端中还是在 xterm 中），都需要很长时间。如果`bash -l`是需要很长时间，这意味着它是登录时间。

在[https://cygwin.com/faq/faq.html#faq.using.startup-slow](https://cygwin.com/faq/faq.html#faq.using.startup-slow)的 Cygwin 常见问题解答中有一些方法，但它们对我不起作用。

最初的海报询问了`PATH`他诊断使用的`bash -x`. 我也发现虽然`bash -i`速度很快，但速度`bash -xl`很慢，并且显示了很多关于`PATH`.

有一个长得可笑的Windows `PATH`，登录过程一直在运行程序并在整个程序中搜索`PATH`正确的程序。

我的解决方案：编辑 Windows`PATH`以删除任何多余的东西。我不确定我删除的哪个部分起到了作用，但登录 shell 启动时间从 6 秒缩短到了 1 秒以下。

YMMV。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-02-20T12:00:48.113

我的回答和上面的npe一样。但是，由于我刚刚加入，我无法评论甚至投票！我希望这篇文章不会被删除，因为它为任何寻找相同问题答案的人提供了保证。

npe 的解决方案对我有用。只有一个警告 - 在我充分利用它之前，我必须关闭所有 cygwin 进程。这包括运行 cygwin 服务，如 sshd，以及我从登录脚本启动的 ssh-agent。在此之前，cygwin 终端的窗口会立即出现，但会在出现提示之前挂起几秒钟。关闭窗口后它挂了几秒钟。在我杀死所有进程并启动 cygserver 服务之后（顺便说一句，我更喜欢使用 Cygwin 方式 - 'cygrunsrv -S cygserver'，而不是 'net start cygserver'；我不知道它是否有任何实际区别）它立即启动。所以再次感谢npe！

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-06-01T15:02:13.963

我在一个设置非常复杂的公司网络上，这似乎真的扼杀了 cygwin 的启动时间。与 npe 的回答相关，我还必须遵循此处列出的一些步骤：[https ://cygwin.com/faq/faq.html#faq.using.startup-slow](https://cygwin.com/faq/faq.html#faq.using.startup-slow)

> AD 客户端系统的另一个原因是 DC 响应缓慢，通常在具有远程 DC 访问的配置中观察到。Cygwin DLL 查询有关您所在的每个组的信息，以便在启动时填充本地缓存。您可以通过将自己的信息缓存在本地文件中来稍微加快此过程。在对 /etc 具有写访问权限的 Cygwin 终端中运行这些命令：
> 
> `getent passwd $(id -u) > /etc/passwd`
> `getent group $(id -G) > /etc/group`
> 
> 另外，设置`/etc/nsswitch.conf`如下：
> 
> `passwd: files db`
> `group: files db`
> 
> 这将限制 Cygwin 联系 AD 域控制器 (DC) 的需要，同时仍允许从 DC 检索其他信息，例如在列出远程目录时。

在这样做加上启动 cygserver 之后，我的 cygwin 启动时间显着下降。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-19T03:27:21.987

正如上面有人提到的，一个可能的问题是 PATH 环境变量包含太多路径，cygwin 将搜索所有这些。我更喜欢直接编辑 /etc/profile，只需将 PATH 变量覆盖到 cygwin 相关路径，例如`PATH="/usr/local/bin:/usr/bin"`. 如果需要，请添加其他路径。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-01-22T21:30:32.507

我编写了一个名为“minimizecompletion”的 Bash 函数，用于停用不需要的完成脚本。

完成脚本可以添加多个完成规范或具有用于 shell 构建的完成规范，因此将脚本名称与 $PATH 中找到的可执行文件进行比较是不够的。

我的解决方案是删除所有加载的完成规范，加载完成脚本并检查它是否添加了新的完成规范。根据这一点，通过将 .bak 添加到脚本文件名来禁用它，或者通过删除 .bak 来激活它。对 /etc/bash_completion.d 中的所有 182 个脚本执行此操作会导致 36 个活动和 146 个非活动完成脚本将 Bash 启动时间减少 50%（但应该清楚这取决于已安装的包）。

该函数还检查未激活的完成脚本，以便在新安装的 Cygwin 软件包需要它们时激活它们。可以使用激活所有脚本的参数 -a 撤消所有更改。

```
# Enable or disable global completion scripts for speeding up Bash start.
#
# Script files in directory '/etc/bash_completion.d' are inactived
# by adding the suffix '.bak' to the file name; they are activated by
# removing the suffix '.bak'. After processing all completion scripts
# are reloaded by calling '/etc/bash_completion'
#
# usage:  [-a]
#         -a  activate all completion scripts
# output: statistic about total number of completion scripts, number of
#         activated, and number of inactivated completion scripts; the
#         statistic for active and inactive completion scripts can be
#         wrong when 'mv' errors occure
# return: 0   all scripts are checked and completion loading was
#             successful; this does not mean that every call of 'mv'
#             for adding or removing the suffix was successful
#         66  the completion directory or loading script is missing
#
minimizecompletion() {
  local arg_activate_all=${1-}
  local completion_load=/etc/bash_completion
  local completion_dir=/etc/bash_completion.d

  (
    # Needed for executing completion scripts.
    #
    local UNAME='Cygwin'
    local USERLAND='Cygwin'
    shopt -s extglob progcomp
    have() {
      unset -v have
      local PATH="$PATH:/sbin:/usr/sbin:/usr/local/sbin"
      type -- "$1" &>/dev/null && have='yes'
    }

    # Print initial statistic.
    #
    printf 'Completion scripts status:\n'
    printf '  total:       0\n'
    printf '  active:      0\n'
    printf '  inactive:    0\n'
    printf 'Completion scripts changed:\n'
    printf '  activated:   0\n'
    printf '  inactivated: 0\n'

    # Test the effect of execution for every completion script by
    # checking the number of completion specifications after execution.
    # The completion scripts are renamed depending on the result to
    # activate or inactivate them.
    #
    local completions total=0 active=0 inactive=0 activated=0 inactivated=0
    while IFS= read -r -d '' f; do
      ((++total))
      if [[ $arg_activate_all == -a ]]; then
        [[ $f == *.bak ]] && mv -- "$f" "${f%.bak}" && ((++activated))
        ((++active))
      else
        complete -r
        source -- "$f"
        completions=$(complete | wc -l)
        if (( $completions > 0 )); then
          [[ $f == *.bak ]] && mv -- "$f" "${f%.bak}" && ((++activated))
          ((++active))
        else
          [[ $f != *.bak ]] && mv -- "$f" "$f.bak" && ((++inactivated))
          ((++inactive))
        fi
      fi
      # Update statistic.
      #
      printf '\r\e[6A\e[15C%s' "$total"
      printf '\r\e[1B\e[15C%s' "$active"
      printf '\r\e[1B\e[15C%s' "$inactive"
      printf '\r\e[2B\e[15C%s' "$activated"
      printf '\r\e[1B\e[15C%s' "$inactivated"
      printf '\r\e[1B'
    done < <(find "$completion_dir" -maxdepth 1 -type f -print0)

    if [[ $arg_activate_all != -a ]]; then
      printf '\nYou can activate all scripts with %s.\n' "'$FUNCNAME -a'"
    fi
    if ! [[ -f $completion_load && -r $completion_load ]]; then
      printf 'Cannot reload completions, missing %s.\n' \
             "'$completion_load'" >&2
      return 66
    fi
  )

  complete -r
  source -- "$completion_load"
} 
```

这是一个示例输出和结果时间：

```
$ minimizecompletion -a
Completion scripts status:
  total:       182
  active:      182
  inactive:    0
Completion scripts changed:
  activated:   146
  inactivated: 0

$ time bash -lic exit
logout

real    0m0.798s
user    0m0.263s
sys     0m0.341s

$ time minimizecompletion
Completion scripts status:
  total:       182
  active:      36
  inactive:    146
Completion scripts changed:
  activated:   0
  inactivated: 146

You can activate all scripts with 'minimizecompletion -a'.

real    0m17.101s
user    0m1.841s
sys     0m6.260s

$ time bash -lic exit
logout

real    0m0.422s
user    0m0.092s
sys     0m0.154s 
```

# c++ - opencv中基于卡尔曼滤波器的鼠标跟踪

> ID：15536213
> 
> 赞同：1
> 
> 时间：2013-03-20T22:44:00.517
> 
> 标签：c++, opencv, tracking, kalman-filter

我写了一个使用卡尔曼滤波器跟踪鼠标指针的代码。但它给出了一些错误。请帮帮我。

```
enter code here enter code here

#include "cv.h"
#include "highgui.h"
#include <iostream>
#include <vector>

using namespace std;

CvPoint point=cvPoint(-1,-1);
CvPoint last_point;

vector<CvPoint> mousev,kalmanv;

   void my_mouse_callback(int event, int x, int y, int flags, void* param)
 {
CV_EVENT_LBUTTONDBLCLK;
last_point=point;
point=cvPoint(x,y);
 }

IplImage *img;

int main()
{ 
// Initialize Kalman filter object, window, number generator, etc
cvNamedWindow( "Kalman", 1 );

IplImage* img = cvCreateImage( cvSize(500,500), 8, 3 );

CvKalman* kalman = cvCreateKalman( 4, 2, 0 );

CvMat* state = cvCreateMat( 4, 1, CV_32FC1 );

CvMat* processnoise=cvCreateMat(4,1,CV_32FC1);

CvMat* measurement =cvCreateMat(2,1,CV_8SC1);

char code = (char)-1;

cvSetMouseCallback("kalman",my_mouse_callback,NULL);

while(1)
{
  if(point.x<0 || point.y<0)

  {
      cvShowImage("kalman",img);
       cvWaitKey(30);
        continue;
   }
  const float F1[] = {point.x,point.y,0,0};
  memcpy(kalman->state_pre->data.fl,F1,sizeof(F1));

  float vals[] = {1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1};
  CvMat tran;
  cvInitMatHeader(&tran,4,4,CV_32FC1,vals);
  memcpy(kalman->transition_matrix->data.fl,tran,sizeof(tran));

 cvSetIdentity( kalman->measurement_matrix);
 cvSetIdentity( kalman->process_noise_cov, cvRealScalar(1e-5) );
 cvSetIdentity( kalman->measurement_noise_cov, cvRealScalar(1e-1) );
 cvSetIdentity( kalman->error_cov_post, cvRealScalar(1) );

 mousev.clear();
 kalmanv.clear();

 while(1)
 {
     const CvMat* prediction = cvKalmanPredict(kalman,0);

     CvPoint predictionPt = cvPoint(prediction[0],prediction[0]);

     measurement[0]= point.x;
     measurement[1] = point.y;

     CvPoint measPt = cvPoint(measurement[0],measurement[1]);

     mousev.push_back(measPt);

     const CvMat* estimated = cvKalmanCorrect( kalman, measurement);

     CvPoint statePt=cvPoint(estimated[0],estimated[1]);
     kalmanv.push_back(statePt);

     cvLine( img, cvPoint(statePt.x - 5, statePt.y - 5 ),cvPoint( statePt.x + 5, statePt.y + 5 ), cvScalar(255,255,255), 2,8); 
     cvLine( img, cvPoint(statePt.x + 5, statePt.y - 5 ),cvPoint( statePt.x - 5, statePt.y + 5 ), cvScalar(255,255,255), 2,8);

     cvLine( img, cvPoint(measPt.x - 5, measPt.y - 5 ),cvPoint( measPt.x + 5, measPt.y + 5 ), cvScalar(255,255,255), 2,8); 
     cvLine( img, cvPoint(measPt.x + 5, measPt.y - 5 ),cvPoint( measPt.x - 5, measPt.y + 5 ), cvScalar(255,255,255), 2,8);

     for (int i = 0; i < mousev.size()-1; i++) 
    {
            cvLine(img, mousev[i], mousev[i+1], cvScalar(255,255,0), 1);
    }

     for (int i = 0; i < kalmanv.size()-1; i++) 
    {
            cvLine(img, kalmanv[i], kalmanv[i+1], cvScalar(0,255,0), 1);
    }
        cvShowImage( "mouse kalman", img );
        code = (char)cvWaitKey(100);
        if( code > 0 )
            break;
 }
  if( code == 27 || code == 'q' || code == 'Q' )
        break;
}

return 0;
} 
```

错误：

```
 Error  3   error C2664: 'memcpy' : cannot convert parameter 2 from 'CvMat' to 'const void *'   c:\users\anay\documents\visual studio 2008\projects\mission_impossible_1\mission_impossible_1\kalman_filter.cpp 56  mission_impossible_1
Error   4   error C2664: 'cvPoint' : cannot convert parameter 1 from 'const CvMat' to 'int' c:\users\anay\documents\visual studio 2008\projects\mission_impossible_1\mission_impossible_1\kalman_filter.cpp 70  mission_impossible_1
Error   5   error C2679: binary '=' : no operator found which takes a right-hand operand of type 'int' (or there is no acceptable conversion)   c:\users\anay\documents\visual studio 2008\projects\mission_impossible_1\mission_impossible_1\kalman_filter.cpp 72  mission_impossible_1
Error   6   error C2679: binary '=' : no operator found which takes a right-hand operand of type 'int' (or there is no acceptable conversion)   c:\users\anay\documents\visual studio 2008\projects\mission_impossible_1\mission_impossible_1\kalman_filter.cpp 73  mission_impossible_1
Error   7   error C2664: 'cvPoint' : cannot convert parameter 1 from 'CvMat' to 'int'   c:\users\anay\documents\visual studio 2008\projects\mission_impossible_1\mission_impossible_1\kalman_filter.cpp 75  mission_impossible_1
Error   8   error C2664: 'cvPoint' : cannot convert parameter 1 from 'const CvMat' to 'int' c:\users\anay\documents\visual studio 2008\projects\mission_impossible_1\mission_impossible_1\kalman_filter.cpp 81  mission_impossible_1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:56:23.487

> 错误 3 错误 C2664: 'memcpy' : 无法将参数 2 从 'CvMat' 转换为 'const void *' c:\users\anay\documents\visual studio 2008\projects\mission_impossible_1\mission_impossible_1\kalman_filter.cpp 56mission_impossible_1

```
memcpy(kalman->transition_matrix->data.fl,tran,sizeof(tran)); 
```

在 C++ 中（与 C 不同），您必须将指针显式转换为指向 void 的指针。目前你有：

```
CvMat tran;
memcpy(kalman->transition_matrix->data.fl,tran,sizeof(tran)); 
```

相反，请试试这个：

```
CvMat* tran=new CvMat;
memcpy(static_cast<void*>(kalman->transition_matrix->data.fl),static_cast<void*>(tran),sizeof(tran)); 
```

下一个：

> 错误 4 错误 C2664：“cvPoint”：无法将参数 1 从“const CvMat”转换为“int”

我真的很想帮忙，但请附上你的班级代码

# requirejs - Hot Towel：为什么Durandal和Require在App文件夹而不是Script文件夹？

> ID：15536220
> 
> 赞同：5
> 
> 时间：2013-03-20T22:44:26.637
> 
> 标签：requirejs, single-page-application, durandal, hottowel

这是来自 Script 中的 3rd 方库的想法，以阻止开发人员自定义它们。这将鼓励他们编写扩展，以便更容易地接受任一库的新版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T19:15:46.687

您对其他开发人员将 durandal 库误认为可定制文件提出了一个很好的观点。

但是，您不需要将 durandal 放在任何地方。文件夹结构可以随心所欲。因为 durandal 没有强加任何文件夹结构.. 它只有一个推荐的默认设置。遵循它的模式是有好处的。

通过将 durandal 作为应用程序根文件夹的一部分。它将您所有的 amd javascript 文件保存在一个根文件夹中。这样，当您运行 durandal[优化器](http://durandaljs.com/documentation/Optimizing-On-Dot-Net/)时，它可以扫描每个子文件夹以将所有 html/css/js 压缩/缩小/丑化到 1 个文件中。这是一个很好的好处，因为它是您整个应用程序的一键构建。

[此外，这是一个很好的分离，因为如果您使用捆绑](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)器将所有第三方库压缩到一个单独的文件中，那么以这种方式将您的 3rd 方非 AMD JavaScript 库保存在一个单独的文件夹结构中是一个好主意。浏览器可以将您的应用程序与第三方库分开缓存。因为第三方库不会经常更改，而您的应用程序可能会经常更改。

但是 durandal 的约定都是完全可配置的，您可以将 durandal 放在您喜欢的任何位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:46:24.847

这是 Durandal 决定使用的约定，以帮助将您的客户客户端代码组织在 App 文件夹中，并远离 3rd 方脚本文件夹，该文件夹很快就会变得非常混乱。它确实将 require.js 放在 App 文件夹中，因为它依赖于 require.js 及其 AMD 模式。require.js 用于帮助定位所有模块并根据需要加载它们（在您的 App 文件夹中）。

有什么特定的东西需要防止吗？

# opencv - OpenCV GrabCut 算法示例不起作用

> ID：15536222
> 
> 赞同：5
> 
> 时间：2013-03-20T22:44:36.673
> 
> 标签：opencv

我正在尝试使用 C++ 在 OpenCV 中实现抓取算法，我偶然发现了[这个网站](http://www.packtpub.com/article/opencv-segmenting-images)，并找到了一种非常简单的方法。不幸的是，似乎代码对我不起作用

```
#include "opencv2/opencv.hpp"
#include <iostream>

using namespace cv;
using namespace std;

int main( )
{
 // Open another image
    Mat image;
    image= cv::imread("images/mango11a.jpg");

    // define bounding rectangle 
    cv::Rect rectangle(50,70,image.cols-150,image.rows-180);

    cv::Mat result; // segmentation result (4 possible values)
    cv::Mat bgModel,fgModel; // the models (internally used)

    // GrabCut segmentation
    cv::grabCut(image,    // input image
                    result,   // segmentation result
                            rectangle,// rectangle containing foreground 
                            bgModel,fgModel, // models
                            1,        // number of iterations
                            cv::GC_INIT_WITH_RECT); // use rectangle
    cout << "oks pa dito" <<endl;
    // Get the pixels marked as likely foreground
    cv::compare(result,cv::GC_PR_FGD,result,cv::CMP_EQ);
    // Generate output image
    cv::Mat foreground(image.size(),CV_8UC3,cv::Scalar(255,255,255));
    image.copyTo(foreground,result); // bg pixels not copied

    // draw rectangle on original image
    cv::rectangle(image, rectangle, cv::Scalar(255,255,255),1);
    cv::namedWindow("Image");
    cv::imshow("Image",image);

    // display result
    cv::namedWindow("Segmented Image");
    cv::imshow("Segmented Image",foreground);

    waitKey();
    return 0;
} 
```

任何人都可以帮我解决这个问题吗？应该是什么问题 PS：编译时未打印任何错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T13:54:47.470

再次检查您的设置。我刚刚执行了相同的教程，对我来说效果很好。![在此处输入图像描述](../Images/681422249ec6113c02ea1d9642ab3e90.png)

# c# - 如何避免“对象引用未设置为对象的实例”？

> ID：15536223
> 
> 赞同：2
> 
> 时间：2013-03-20T22:44:40.677
> 
> 标签：c#, visual-studio

我一遍又一遍地遇到同样的问题，我刚才又做了一次。我写了一行代码：

```
int LAID = db.GetLAByLatLong(address.Latitude, address.Longitude); 
```

...和 ​​Visual Studio in 报告该行没有任何问题。

但是当我运行它报告的代码时：

> 你调用的对象是空的

我究竟做错了什么？为什么 Visual Studio 似乎说代码没问题，但在运行时却报错？我似乎经常这样做，我真的很想了解我做错了什么，这样我就可以避免它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T22:46:25.190

您的代码中有两个对象：

```
db 
```

和

```
address 
```

您在显示的代码中引用了这两个对象。其中至少有一个为空。

为避免该问题，请确保在代码运行之前已初始化这两个对象。您还可以添加检查，例如

```
if (db == null) throw new Exception("The variable db is null."); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T22:48:08.943

代码可以编译，因为从所有意图和目的来看，它都是正确的。

但是，这并不意味着它不会在运行时导致错误。错误“对象引用未设置为对象的实例？” 表示您正在使用的对象不存在。在这一行中，它可能是变量 db 或地址引用的对象。

要知道哪个，您必须调试代码。在该行上放置一个断点（单击该行左侧的空间）并按 F5。代码将运行然后在该行停止，您可以在其中检查所有变量包含的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T22:48:07.927

您必须检查哪些变量可能是`null`. 有关帮助您解决问题的步骤列表，请参阅[此答案。](https://stackoverflow.com/a/15513981/146622)

在这种情况下，`db`和`address`变量之一*可能*是`null`，这是导致 a 的最常见原因`NullReferenceException`。

# sql - 将上个月存储为一个字符，其中一位数月份以 0 开头

> ID：15536224
> 
> 赞同：2
> 
> 时间：2013-03-20T22:44:46.393
> 
> 标签：sql, sql-server-2008

我有一个充满日期的字段，但它们存储为 varchars。它们采用以下格式：

*   01312013
*   01302013
*   09232007

我正在尝试编写一个仅返回满足以下三个条件的记录的查询：

*   上述varchar“日期”的最后四个字符匹配上个月**的年份**
*   上述 varchar“日期”的前两个字符与上个月匹配。
*   完全不同的日期字段（实际存储为日期）中的值在上个月内

我的尝试使我试图将上个月的年份和上个月的年份存储在两个变量中，然后对 varchar“日期”执行 LEFT() 和 RIGHT() 查找以查看它们是否匹配这两个变量。唷。

问题是 MONTH 被存储为单个数字，我需要将其存储为“0”+月份数字（仅在单个数字月份的情况下）。而且它甚至不工作只是一年所以也许这完全关闭了。真的希望有人能帮忙！

这是我到目前为止所拥有的：

```
DECLARE @monthAgo dateTime
DECLARE @MonthString char
DECLARE @YearString char

SET @monthAgo = DATEADD(month, -1, GETDATE())
SET @MonthString = MONTH(@monthAgo) -- not working
SET @YearString = YEAR(@monthAgo) -- not working

SELECT 
    COUNT(*)
FROM
    jwemaildb.LogFileRecords
WHERE
    date > = DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0) AND
    date <  DATEADD(month, DATEDIFF(month, 0, GETDATE()), 0) AND
    RIGHT(eAlertSentDate, 4) = @YearString AND
    LEFT (eAlertSentDate, 2) = @MonthString 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:48:36.267

幸运的是，您可以将这些字符串转换为日期，除非您有一些奇怪的值，例如 'oh Dear'。然后是一个简单的 dateadd()。

只是为了确保它有效：

```
 declare @dateString as char(8);
 set @dateString = '02132013';

 select cast(left(@dateString, 2) + '/' + 
 substring(@dateString, 3,2) +'/' +   
 right(@dateString, 4) as date) theDate; 
```

返回

```
theDate
2013-02-13 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:51:29.997

实际上，您需要将 varchar "date" 转换为 ISO 标准

```
SELECT COUNT(*)
FROM jwemaildb.LogFileRecords
WHERE
    date > = DATEADD(month, DATEDIFF(month, 0, GETDATE())-1, 0) AND
    date <  DATEADD(month, DATEDIFF(month, 0, GETDATE()), 0) AND
    CAST(RIGHT(eAlertSentDate, 4) + LEFT(eAlertSentDate, 4) AS date) BETWEEN       
    DATEADD(dd , 1 - DAY(GETDATE()), DATEADD(mm, -1 ,GETDATE())) AND
    DATEADD(dd , 1 - DAY(GETDATE()), GETDATE()) 
```

[SQLFiddle](http://sqlfiddle.com/#!3/d41d8/11338)上的简单演示

# java - jMock“意外调用”对于我有 oneOf(instance).method() 预期的方法

> ID：15536225
> 
> 赞同：1
> 
> 时间：2013-03-20T22:44:49.693
> 
> 标签：java, jmock

我似乎无法弄清楚我在这里做错了什么：

这是我正在测试的方法：

```
public List<Mo> filterDuplicatesByName(List<Mo> dbMos) {
    List<String> names = Lists.newArrayList();
    for(Mo mo : dbMos) {
        try {
            String name = mo.getName();
            if(names.contains(name)) {
                dbMos.remove(mo);
            } else {
                names.add(name);
            }
        } catch (DataLayerException ex) {
            dbMos.remove(mo);
        }
    }
    return dbMos;
} 
```

这是我的测试课：

```
package com.rondavu.wt.service.recommendations;

import com.google.common.collect.Lists;
import com.rondavu.data.api.Mo;
import org.jmock.Expectations;
import org.jmock.Mockery;
import org.jmock.lib.legacy.ClassImposteriser;
import org.junit.Before;
import org.junit.Test;

import java.util.ArrayList;
import java.util.List;

import static org.junit.Assert.assertEquals;

public class RecommendationsUtilsTest  {

    Mockery context = new Mockery();

    RecommendationsUtils recommendationsUtils = new RecommendationsUtils();

    final Mo mo = context.mock(Mo.class);

    @Test
    public void testFilterDuplicatesByName_oneMo() throws DataLayerException {
        List<Mo> input = Lists.newArrayList(mo);
        List<Mo> expected = Lists.newArrayList(mo);

        context.checking(new Expectations() {{
            oneOf (mo).getName(); will(returnValue("Mo 1"));
        }});

        List<Mo> actual = recommendationsUtils.filterDuplicatesByName(input);

        context.assertIsSatisfied();

        assertEquals(expected, actual);
    }
} 
```

当我运行测试时，我得到这个输出：

```
unexpected invocation: mo.getName()
no expectations specified: did you...
 - forget to start an expectation with a cardinality clause?
 - call a mocked method to specify the parameter of an expectation?
what happened before this: nothing!
    [stack trace] 
```

我对 jMock 还是很陌生，一般来说 Java 不是我最强大的语言，但我认为我`oneOf (mo).getName()`会让它期待这种调用。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:29:13.107

虽然目前尚不清楚为什么，但与您定义期望的那个相比，Mockery 似乎正在检查一个不同的 mo 实例。尝试`context.mock(Mo.class)`在与测试用例相同的本地范围内插入（或在 @Before 方法中），看看是否能解决问题。

# regex - 需要一个正则表达式来返回从最后一个“/”到最后一个“-”的文本

> ID：15536226
> 
> 赞同：3
> 
> 时间：2013-03-20T22:44:56.693
> 
> 标签：regex

我似乎无法弄清楚如何匹配以下内容

在字符串中`/hello/there-my-friend`

我需要在最后一个之后和最后一个`/`之前捕获所有内容`-`

所以它应该捕获`there-my`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:50:55.287

这是您要查找的正则表达式：

```
#(?<=/)[^/]+(?=-[^-/]*$)# 
```

我会在一分钟内分解它，但可能有更好的方法来做到这一点。

我可能会做这样的事情：

```
$str = "/hello/there-my-friend";
$pieces = explode('/', $str);
$afterLastSlash = $pieces[count($pieces)-1];
$dashes = explode('-', $afterLastSlash);
unset($dashes[count($dashes)-1]);
$result = implode('-', $dashes); 
```

这里的性能保证是线性的（限制因素是 $str 的长度加上 $afterLastSlash 的长度。正则表达式会慢得多（我认为与多项式时间一样多 - 环顾四周可能会有点冒险。 )

上面的代码可以很容易地缩减，但命名使其更清晰。这是一个衬里：

```
$result = implode('-', array_slice(explode('-', array_slice(explode('/', $str), -1)), 0, -1)); 
```

但是很恶心，不要那样做。找到一个中间立场。

正如所承诺的，正则表达式的细分：

```
#
    (?<=        Look behind an ensure there's a...
        /       Literal forward slash.
    )           Okay, done looking behind.
    [^/]        Match any character that's not a forward slash
    +           ...One ore more times.
    (?=         Now look ahead, and ensure there's...
        -       a hyphen.
        [^-/]   followed by any non-hyphen, non-forward slash character
        *       zero or more times
        $       until the end of the string.
     )          Okay, done looking ahead.
# 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:57:00.193

试试这个简短的正则表达式：

```
/\K\w+-\w+ 
```

您的正则表达式引擎需要[`\K`支持](https://stackoverflow.com/questions/13542950/support-of-k-in-regex)

或者

```
(?<=/)\w+-\w+ 
```

（更便携）

## 解释

*   `\K`接近于`(?<=/)`：[*环视*正则表达式高级技术](http://www.perlmonks.org/?node_id=518444)
*   `\w`是一样的`[a-zA-Z0-9_]`，随意调整

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T22:53:13.693

```
^".*/([^/-]*)-[^/-]*$ 
```

语法可能会有所不同，具体取决于您使用的 RE 风格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T23:01:22.567

这不是您问题的确切答案（它不是正则表达式），但如果您使用的是 C#，您可能会使用它：

```
string str = "/hello/there-my-friend";
int lastSlashIndex = str.LastIndexOf('/');
int lastDashIndex = str.LastIndexOf('-');

return str.Substring(lastSlashIndex, lastDashIndex - lastSlashIndex); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T23:04:27.360

这将做到：

```
(?!.*?/).*(?=-) 
```

根据您的语言，您可能需要转义`/`

分解：

```
1\. (?!.*?/) - Negative look ahead. It will start collecting characters after the last `/`
2\. .*       - Looks for all characters
3\. (?=-)    - Positive look ahead. It means step 2 should only go up to the last `-` 
```

评论后编辑：结果中不再包含 the`/`和 last `-`。

# google-app-engine - App Engine 版本 1.7.6 old_dev_appserver.py Model.key().id() 未返回正确的 ID

> ID：15536229
> 
> 赞同：1
> 
> 时间：2013-03-20T22:45:06.103
> 
> 标签：google-app-engine

我一直无法让新`dev_appserver`的工作。当我回滚到`old_dev_appserver`我的应用程序时，无法从数据存储中获取数据，因为`model.key().id()`似乎没有返回正确的`id`.

有人知道我可能做错了什么吗？

例子：

在查看数据存储区时，`_ah/admin`我可以看到实体具有 and `id`of`5764607523034234880`但调用`entitiy_instance.key().id()`返回`5188146770730811000`

换句话说，调用`Model.get_by_id(entity.key().id())`返回 None。我相信它应该返回实体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T04:29:04.003

我发现 1.7.5 和 1.7.6 之间发生了一些变化，导致这些`long`数字在`json.stringify()`.

我通过在放入字符串化之前将`long`id转换为来解决了这个问题。`str``dict`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T01:51:48.580

1.7.6 将默认的ID分配从顺序改为分散，导致ID号这么大，遇到的问题。已注册一个[错误](https://code.google.com/p/googleappengine/issues/detail?id=9030&sort=-id&colspec=ID%20Type%20Component%20Status%20Stars%20Summary%20Language%20Priority%20Owner%20Log)来解决此问题。

同时，我对本地开发的建议是手动将 ID 分配设置回顺序，如此[处](https://developers.google.com/appengine/docs/python/tools/devserver#Using_the_Datastore)所述（指定自动 ID 分配策略）

# php - 如何在 PHP 中使用正则表达式在字符串中的斜杠后获取 int

> ID：15536231
> 
> 赞同：1
> 
> 时间：2013-03-20T22:45:10.997
> 
> 标签：php, regex

我试图在 PHP 中创建一个代码，该代码在给定字符串中的正斜杠之后获取主题 ID。但是我遇到的问题是它什么都不返回，我怎样才能让它返回int？

```
echo  preg_match('/([^/]+)/', 'Learning-English/478', $discussion_id);
echo $discussion_id; 
```

这是一个在线论坛，感谢您的帮助；非常感谢。如果您需要更多信息，请随时发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:49:00.193

```
preg_match("#/(\d+)$#", 'Learning-English/478', $discussion_id); 
```

那对你有用。

打印`id`（匹配的号码）；你需要回声`$discussion_id[1]`。

这是一个工作[链接](http://codepad.viper-7.com/S5pOV9)。

* * *

对于较新的字符串，您不需要字符串结束匹配（`$`）。因此，正则表达式将是：

```
preg_match("#/(\d+)#", 'Looking-for-Pen-Pals/1161&t=viewDiscussion', $discussion_id);
echo $discussion_id[1]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:48:43.343

你可以`explode()`像这样使用：

```
$arr = explode('/',$string);
$discussion_id = $arr[count($arr)-1]; 
```

这将拆分您的字符串，然后为您提供最后一部分。

# c - C/Fortran 混合代码以一种奇怪的方式使用 MPI/ScaLAPACK 段错误

> ID：15536238
> 
> 赞同：1
> 
> 时间：2013-03-20T22:45:44.767
> 
> 标签：c, segmentation-fault, fortran, mpi, scalapack

我正在尝试将此[代码](http://www.netlib.org/scalapack/explore-html/de/d37/pdgbdriver_8f_source.html)从 Fortran 翻译成 C。

这是我到目前为止所拥有的：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>

#include "mpi.h"

#define PRINT_NOTHING             0
#define PRINT_UP_TO_MESGS         1
#define PRINT_UP_TO_ARRAYS        2
#define PRINT_UP_TO_MATRICES      3
#define PRINT_LEVEL               PRINT_UP_TO_MATRICES

/*! Parameters: */
#define TOTMEM                    425053208
#define INTMEM                    13107200
#define NTESTS                    20
#define DLEN_                     9
#define DBLESZ                    8               /*! Size of a DOUBLE PRE. */
#define MEMSIZ                    425053208/8     /*! Memory for DOUBLE PRE. */

#define MASTER                    0
#define MPI_ERROR_CODE_ERROR_GRID 1
#define MPI_ERROR_CODE_NOT_FACT   2
#define MPI_ERROR_CODE_NOT_SOLVE  3

#define BLACS_USER_WONT_FIN_MPI   0
#define BLACS_USER_WILL_FIN_MPI   1

#define DESCRIPTOR_SIZE           7

typedef enum {
  FALSE,
  TRUE

} logical;

/*! External subroutines: */
extern void Cblacs_barrier  (int context,
                             char* scope);
extern void Cblacs_exit     (int doneflag);
extern void Cblacs_get      (int ,
                             int ,
                             int *context);
extern void Cblacs_gridexit (int context);
extern void Cblacs_gridinfo (int context,
                             int *our_nprow,
                             int *our_npcol,
                             int *my_prow,
                             int *my_pcol);
extern void Cblacs_gridinit (int* context,
                             char* order,
                             int nproc_rows,
                             int nproc_cols);
extern void Cblacs_pinfo    (int *my_blacs_pid,
                             int *our_blacs_nprocs);

/* http://www.netlib.org/scalapack/explore-html/dd/d22/descinit_8f.html */
extern void descinit_       (int *desc,
                             int *m,
                             int *n,
                             int *mb,
                             int *nb,
                             int *irsrc,
                             int *icsrc,
                             int *ictxt,
                             int *lld,
                             int *info);
/* http://www.netlib.org/scalapack/explore-html/dc/d44/igsum2d___8c.html */
extern void igsum2d_        (int *contxt,
                             char *scope,
                             char *top,
                             int *m,
                             int *n,
                             int *a,
                             int *lda,
                             int *rdest,
                             int *cdest);
/* http://www.netlib.org/scalapack/explore-html/db/da1/pdbmatgen_8f.html */
extern void pdbmatgen_      (int *ictxt,
                             char *aform,
                             char *aform2,
                             int *bwl,
                             int *bwu,
                             int *n,
                             int *mb,
                             int *nb,
                             double *a,
                             int *lda,
                             int *iarow,
                             int *iacol,
                             int *iseed,
                             int *myrow,
                             int *mycol,
                             int *nprow,
                             int *npcol);
/* http://www.netlib.org/scalapack/explore-html/d8/dba/pdchekpad_8f.html */
extern void pdchekpad_      (int * ictxt,
                             char *mess,
                             int *m,
                             int *n,
                             double *a,
                             int *lda,
                             int *ipre,
                             int *ipost,
                             double *chkval);
/* http://www.netlib.org/scalapack/explore-html/d2/dc2/pddblaschk_8f.html */
extern void pddblaschk_     (char *symm,
                             char *uplo,
                             char *trans,
                             int *n,
                             int *bwl,
                             int *bwu,
                             int *nrhs,
                             double *x,
                             int *ix,
                             int *jx,
                             int *descx,
                             int *iaseed,
                             double *a,
                             int *ia,
                             int *ja,
                             int *desca,
                             int *ibseed,
                             double *anorm,
                             double *resid,
                             double *work,
                             int *worksiz);
/* http://www.netlib.org/scalapack/explore-html/d6/d3b/pdfillpad_8f.html */
extern void pdfillpad_      (int *ictxt,
                             int *m,
                             int *n,
                             double *a,
                             int *lda,
                             int *ipre,
                             int *ipost,
                             double *chkval);
/* http://www.netlib.org/scalapack/explore-html/d0/d2b/pdgbinfo_8f.html */
extern void pdgbinfo_       (char *summry,
                             int *nout,
                             char *trans,
                             int *nmat,
                             int *nval,
                             int *ldnval,
                             int *nbw,
                             int *bwlval,
                             int *bwuval,
                             int *ldbwval,
                             int *nnb,
                             int *nbval,
                             int *ldnbval,
                             int *nnr,
                             int *nrval,
                             int *ldnrval,
                             int *nnbr,
                             int *nbrval,
                             int *ldnbrval,
                             int *ngrids,
                             int *pval,
                             int *ldpval,
                             int *qval,
                             int *ldqval,
                             float *thresh,

                             double *work,  /* Array to gather and bcast. */

                             int *iam,
                             int *nprocs);
/* http://www.netlib.org/scalapack/explore-html/dd/dad/pdgbtrf_8f.html */
extern void pdgbtrf_        (int *n,
                             int *bwl,
                             int *bwu,
                             double *a,
                             int *ja,
                             int *desca,
                             int *ipiv,
                             double *af,
                             int *laf,
                             double *work,
                             int *lwork,
                             int *info);
/* http://www.netlib.org/scalapack/explore-html/d9/dda/pdgbtrs_8f.html */
extern void pdgbtrs_        (char *trans,
                             int *n,
                             int *bwl,
                             int *bwu,
                             int *nrhs,
                             double *a,
                             int *ja,
                             int *desca,
                             int *ipiv,
                             double *b,
                             int *ib,
                             int *descb,
                             double *af,
                             int *laf,
                             double *work,
                             int *lwork,
                             int *info);
/*
http://www.netlib.org/scalapack/explore-html/d2/d66/_e_i_g_2pdmatgen_8f.html
*/
extern void pdmatgen_       (int *ictxt,
                             char *aform,
                             char *diag,
                             int *m,
                             int *n,
                             int *mb,
                             int *nb,
                             double *a,
                             int *lda,
                             int *iarow,
                             int *iacol,
                             int *iseed,
                             int *iroff,
                             int *irnum,
                             int *icoff,
                             int *icnum,
                             int *myrow,
                             int *mycol,
                             int *nprow,
                             int *npcol);
/* http://www.netlib.org/scalapack/explore-html/d2/dcd/sltimer_8f_source.html */
extern void slboot_         (void);
extern void slcombine_      (int *ictxt,
                             char *scope,
                             char *op,
                             char *timetype,
                             int *n,
                             int *ibeg,
                             double *times);
extern void sltimer_        ( int *i );

/*! External functions: */
/* http://www.netlib.org/scalapack/explore-html/d4/d48/numroc_8f.html */
extern int numroc_      (int *n,
                         int *nb,
                         int *iproc,
                         int *isrcproc,
                         int *nprocs);
/* http://www.netlib.org/scalapack/explore-html/df/dee/tools_8f.html#a67ae4efe5110e3297b1e9e3a46d8c78b */
extern logical lsame_   (char *ca,
                         char *cb);
/* http://www.netlib.org/scalapack/explore-html/db/dd0/pdlange_8f.html */
extern double pdlange_  (char *norm,
                         int *m,
                         int *n,
                         double *a,
                         int *ia,
                         int *ja,
                         int *desca,
                         double *work );

/*! Intrinsic functions: */
/*       INTRINSIC          DBLE, MAX, MIN, MOD */
inline double DBLE(int xx) { return (double) xx; }
inline double MAX(double xx, double yy) { return xx >= yy? xx: yy; }
inline double MIN(double xx, double yy) { return xx <= yy? xx: yy; }
inline int MOD(int xx, int yy) { return xx%yy; }

/*! PROGRAM PDGBDRIVER: */
int main (int argc, char **argv) {

  /*! Parameters: */
  int ntests = NTESTS;  /* Number of num. tests to be performed */
  //   int       BLOCK_CYCLIC_2D = 1;
  //   int       DTYPE_ = 1;
  //   int       CTXT_ = 2;
  //   int       M_ = 3;
  //   int       N_ = 4;
  //   int       MB_ = 5;
  //   int       NB_ = 6;
  //   int       RSRC_ = 7;
  //   int       CSRC_ = 8;
  //   int       LLD_ = 9;
  //
  //   double    ZERO = 0.0;
  //   double    PADVAL = -9923.0;
  //
  //   int       INT_ONE = 1;

  /*! Local scalars: */
  logical   CHECK;        /* Should or shouldn't I perform the num. tests? */
  char      TRANS;        /* Should I transpose the matrix? */
  //   char      PASSED[6];
  char      OUTFILE[80];  /* ? */
  //   int       BWL;
  //   int       BWU;
  //   int       BW_NUM;
  //   int       FILLIN_SIZE;
  //   int       FREE_PTR;
  //   int       H;
  //   int       HH;
  int       I;          /* Iterator per process grid. */
  int       IAM;          /* My MPI process ID. */
  int       IASEED;       /* Seed for random matrix A creation. */
  int       IBSEED;       /* Seed for random matrix B creation. */
  //   int       ICTXT;
  //   int       ICTXTB;
  //   int       IERR_TEMP;
  //   int       IMIDPAD;
  //   int       INFO;
  //   int       IPA;
  //   int       IPB;
  //   int       IPOSTPAD;
  //   int       IPREPAD;
  //   int       IPW;
  //   int       IPW_SIZE;
  //   int       IPW_SOLVE;
  //   int       IPW_SOLVE_SIZE;
  //   int       IP_DRIVER_W;
  //   int       IP_FILLIN;
  //   int       J;
  //   int       K;

  /*! Data statements: */
  //   int       KFAIL = 4;
  //   int       KPASS = 4;
  //   int       KSKIP = 4;
  //   int       KTESTS = 4;

  /*! Local scalars: (continued) */
  //   int       MYCOL;
  //   int       MYRHS_SIZE;
  //   int       MYROW;
  //   int       N;
  //   int       NB;
  int       NBW;    /* Number of bandwith values per matrix. */
  int       NGRIDS; /* Number of process grids to try for. */
  int       NMAT;   /* Number of matrices  */
  int       NNB;    /* Number of sizes of NB (block column size). */
  int       NNBR;
  int       NNR;
  int       NOUT;   /* Device out... o.O */
  //   int       NP;
  int       NPCOL;  /* Procs per row in processors grid/ */
  int       NPROCS; /* The size of OUR communicator. */
  //   int       NPROCS_REAL;
  int       NPROW;  /* Procs per row in processors grid/ */
  //   int       NQ;
  //   int       NRHS;
  //   int       N_FIRST;
  //   int       N_LAST;
  //   int       WORKSIZ;

  float     THRESH; /* Threshold variable for numerical tests. */

  //   double    ANORM;
  //   double    NOPS;
  //   double    NOPS2;
  //   double    SRESID;
  //   double    TMFLOPS;
  //   double    TMFLOPS2;

  /*! Local arrays: */
  //   int       IPIV[INTMEM];
  int       BWLVAL[NTESTS];  /* Values of lower diagonals per matrix. */
  int       BWUVAL[NTESTS];  /* Values of upper diagonals per matrix. */
  //   int       DESCA[7];
  //   int       DESCA2D[DLEN_];
  //   int       DESCB[7];
  //   int       DESCB2D[DLEN_];
  //   int       IERR[1];
  int       NBRVAL[NTESTS]; /* ? */
  int       NBVAL[NTESTS];  /* Column sizes per matrix. */
  int       NRVAL[NTESTS];  /* ? */
  int       NVAL[NTESTS];   /* Values of N for a given matrix. */
  int       PVAL[NTESTS];   /* Values for proc. rows. */
  int       QVAL[NTESTS];   /* Values for proc. cols. */

  //   double    CTIME[2];
  double    *MEM;      /* GLOABL array for broadcasting the information. */
  //   double    WTIME[2];

  /*! Executable statements: */

  /*! Get starting information: */
  Cblacs_pinfo(&IAM, &NPROCS);
  IASEED = 100;
  IBSEED = 200;

  MEM = (double *) malloc(MEMSIZ);

  pdgbinfo_(OUTFILE, &NOUT, &TRANS, &NMAT, NVAL, &ntests, &NBW,
            BWLVAL, BWUVAL, &ntests, &NNB, NBVAL, &ntests, &NNR,
            NRVAL, &ntests, &NNBR, NBRVAL, &ntests, &NGRIDS, PVAL,
            &ntests, QVAL, &ntests, &THRESH, MEM, &IAM, &NPROCS);

  CHECK = (THRESH >= 0.0f);

  /*! Print headings: */
  fprintf(stdout, "\n");
  fprintf(stdout, "TIME TR      N  BWL BWU    NB  NRHS    P    Q L*U Time Slv Time   MFLOPS   MFLOP2  CHECK\n");
  fprintf(stdout, "---- -- ------  --- ---  ---- ----- ---- ---- -------- -------- -------- -------- ------\n");
  fprintf(stdout, "\n");
  fflush(stdout);

  /*! Loop over different process grids: */
  for (I = 1; I <= NGRIDS; I++) {

    NPROW = PVAL[I - 1];
    NPCOL = QVAL[I - 1];

    fprintf(stdout, "Solving for a %d x %d grid!\n", NPROW, NPCOL);
  }

  free(MEM);
  Cblacs_exit(0);
  exit(EXIT_SUCCESS);
} 
```

请原谅注释掉的变量的数量，但就像我说的，我基本上是从头开始翻译参考驱动程序。

我的问题是，当我编写 for 循环时，它突然开始出现段错误……它以前工作过。这是一个时髦的内存操作问题的明显迹象，这可能是由与 C 和 Fortran 之间的内存管理差异相关的问题引起的。

至少，这是我的猜测。

有人知道可能出了什么问题吗？

提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T03:03:24.813

这里的根本问题实际上在于对 的调用`pdgbinfo`，它从来没有真正打算从 C 中调用（毕竟它在 TESTING 中）；问题在于字符串，实际上它们的传递方式与数字数组不同——总是传递长度（例如，您可以打印它们）。

您可以在 C 端模拟它，但它高度依赖于编译器。您最好的选择是从这些例程中提取字符串，或者使用[ISO_C_BINDING](http://gcc.gnu.org/onlinedocs/gfortran/ISO_005fC_005fBINDING.html)为相关的 fortran 例程生成可移植的 C 接口。在 F77 代码中使用纯数字数组的例程应该不是问题。

**更新**：如果您更改开头`pdgbinfo.f`和子例程声明，如下所示：

```
 SUBROUTINE PDGBINFO(CSUMMRY, NOUT, TRANS, NMAT, NVAL, LDNVAL, NBW,
     &                     BWLVAL, BWUVAL, LDBWVAL, NNB, NBVAL, LDNBVAL,
     &                     NNR, NRVAL, LDNRVAL, NNBR, NBRVAL, LDNBRVAL,
     &                     NGRIDS, PVAL, LDPVAL, QVAL, LDQVAL, THRESH,
     &                     WORK, IAM, NPROCS ) BIND(C)

      use iso_c_binding
      implicit none
*
*
*
*  -- ScaLAPACK routine (version 1.7) --
*     University of Tennessee, Knoxville, Oak Ridge National Laboratory,
*     and University of California, Berkeley.
*     November 15, 1997
*
*     .. Scalar Arguments ..
      CHARACTER(kind=c_char), intent(OUT) :: TRANS
      CHARACTER(kind=c_char), dimension(*), intent(OUT) :: CSUMMRY
      INTEGER(kind=c_int), intent(IN)     :: IAM, LDNVAL, LDNBVAL,
     &                                       LDNRVAL, LDNBRVAL, LDPVAL,
     &                                       LDBWVAL, LDQVAL

      INTEGER(kind=c_int), intent(INOUT)  :: NPROCS

      INTEGER(kind=c_int), intent(OUT)    :: NOUT, NMAT, NBW, NNB,
     &                                       NNR, NNBR, NGRIDS

      REAL(kind=c_float), intent(OUT)     :: THRESH

      INTEGER(kind=c_int), intent(OUT) ::  NBRVAL( LDNBRVAL ),
     &                   NBVAL( LDNBVAL ),
     &                   NRVAL( LDNRVAL ), NVAL( LDNVAL ),
     &                   BWLVAL( LDBWVAL),BWUVAL( LDBWVAL),
     &                   PVAL( LDPVAL ), QVAL(LDQVAL), WORK( * )

      CHARACTER(kind=c_char,len=100) :: SUMMRY
      INTEGER :: c,sumlen 
```

然后更改它读取文件的位置以将字符串复制到 C 数组中：

```
*
*        Read name and unit number for summary output file
*
         READ( NIN, FMT = * ) SUMMRY
** convert to C string
         sumlen = len_trim(SUMMRY)
         do c=1,sumlen
            csummry(c) = summry(c:c)
         enddo
         csummry(sumlen+1) = c_null_char 
```

然后，您应该能够在 C 程序中去掉下划线，`pdgbinfo`并让它以一种可跨编译器套件移植的方式工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:25:56.657

根据我从您的代码中读取的内容，您实际上从未检查过`NGRIDS`. 我的猜测是它太大了，数组索引超出了限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T21:53:06.153

这里建议的修改：

```
 SUBROUTINE PDGBINFO( CSUMMRY, NOUT, TRANS, NMAT, NVAL, LDNVAL, NBW,
 $                     BWLVAL, BWUVAL, LDBWVAL, NNB, NBVAL, LDNBVAL,
 $                     NNR, NRVAL, LDNRVAL, NNBR, NBRVAL, LDNBRVAL,
 $                     NGRIDS, PVAL, LDPVAL, QVAL, LDQVAL, THRESH,
 $                     WORK, IAM, NPROCS ) BIND(C)
*
 use iso_c_binding
 implicit none
*
*     .. Scalar Arguments ..
  CHARACTER(kind=c_char), intent(out) :: TRANS
  CHARACTER(kind=c_char), dimension(*), intent(OUT) :: CSUMMRY
  INTEGER(kind=c_int), intent(in) :: IAM, LDNVAL, LDNBVAL,
 $                                   LDNRVAL, LDNBRVAL, LDPVAL,
 $                                   LDBWVAL, LDQVAL
 INTEGER(kind=c_int), intent(inout) :: NPROCS
 INTEGER(kind=c_int), intent(out) :: NOUT, NMAT, NBW, NNB,
 $                                   NNR, NNBR, NGRIDS
 REAL(KIND=C_FLOAT), intent(out) :: THRESH
*     ..
*     .. Array Arguments ..
  INTEGER(kind=c_int), intent(out) :: NBRVAL( LDNBRVAL ), NBVAL( LDNBVAL ),
 $                   NRVAL( LDNRVAL ), NVAL( LDNVAL ),
 $                   BWLVAL( LDBWVAL), BWUVAL( LDBWVAL),
 $                   PVAL( LDPVAL ), QVAL(LDQVAL), WORK( * )

 CHARACTER(KIND=c_char,len=100) :: SUMMRY
 INTEGER :: c, sumlen 
```

然而，这些会产生以下编译时错误：

```
[ejspeiro@node01 LIN]$ mpif90 -c -O3 pdgbinfo.f
pdgbinfo.f:5.54:

     $                     WORK, IAM, NPROCS ) BIND(C)                  
                                                      1
Error: Syntax error in SUBROUTINE statement at (1)
pdgbinfo.f:18.21:

      CHARACTER(kind=c_char), intent(out) :: TRANS                      
                     1
Error: Parameter 'c_char' at (1) has not been declared or is a variable, which does not reduce to a constant expression 
```

再加上几个！

再来一次：

```
[ejspeiro@node01 LIN]$ mpif90 -v
mpif90 for the Intel(R) MPI Library 3.2 for Linux
Driving: gfortran -v -I/opt/intel/impi/3.2.0.011/include64/gfortran/4.1.0 -I/opt/intel/impi/3.2.0.011/include64 -L/opt/intel/impi/3.2.0.011/lib64 -Xlinker --enable-new-dtags -Xlinker -rpath -Xlinker /opt/intel/impi/3.2.0.011/lib64 -Xlinker -rpath -Xlinker /opt/intel/mpi-rt/3.2 -lmpi -lmpigf -lmpigi -lrt -lpthread -ldl -lgfortranbegin -lgfortran -lm -shared-libgcc
Using built-in specs.
Target: x86_64-redhat-linux6E
Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --disable-gnu-unique-object --with-as=/usr/libexec/binutils220/as --enable-languages=c,c++,fortran --disable-libgcj --with-mpfr=/builddir/build/BUILD/gcc-4.4.7-20120601/obj-x86_64-redhat-linux6E/mpfr-install/ --with-ppl=/builddir/build/BUILD/gcc-4.4.7-20120601/obj-x86_64-redhat-linux6E/ppl-install --with-cloog=/builddir/build/BUILD/gcc-4.4.7-20120601/obj-x86_64-redhat-linux6E/cloog-install --with-tune=generic --with-arch_32=i586 --build=x86_64-redhat-linux6E
Thread model: posix
gcc version 4.4.7 20120313 (Red Hat 4.4.7-1) (GCC) 
COMPILER_PATH=/usr/libexec/gcc/x86_64-redhat-linux6E/4.4.7/:/usr/libexec/gcc/x86_64-redhat-linux6E/4.4.7/:/usr/libexec/gcc/x86_64-redhat-linux6E/:/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/:/usr/lib/gcc/x86_64-redhat-linux6E/:/usr/libexec/gcc/x86_64-redhat-linux6E/4.4.7/:/usr/libexec/gcc/x86_64-redhat-linux6E/:/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/:/usr/lib/gcc/x86_64-redhat-linux6E/
LIBRARY_PATH=/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/:/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/:/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/../../../../lib64/:/lib/../lib64/:/usr/lib/../lib64/:/app/intel/mkl/10.1.0.015/lib/em64t/:/opt/intel/Compiler/11.0/083/ipp/em64t/lib/:/opt/intel/Compiler/11.0/083/mkl/lib/em64t/:/opt/intel/Compiler/11.0/083/tbb/em64t/cc4.1.0_libc2.4_kernel2.6.16.21/lib/:/opt/intel/Compiler/11.0/083/ipp/em64t/lib/:/opt/intel/Compiler/11.0/083/mkl/lib/em64t/:/opt/intel/Compiler/11.0/083/tbb/em64t/cc4.1.0_libc2.4_kernel2.6.16.21/lib/:/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/../../../:/lib/:/usr/lib/
COLLECT_GCC_OPTIONS='-v' '-I/opt/intel/impi/3.2.0.011/include64/gfortran/4.1.0' '-I/opt/intel/impi/3.2.0.011/include64' '-L/opt/intel/impi/3.2.0.011/lib64' '-shared-libgcc' '-mtune=generic'
 /usr/libexec/gcc/x86_64-redhat-linux6E/4.4.7/collect2 --eh-frame-hdr -m elf_x86_64 --hash-style=gnu -dynamic-linker /lib64/ld-linux-x86-64.so.2 /usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/../../../../lib64/crt1.o /usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/../../../../lib64/crti.o /usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/crtbegin.o -L/opt/intel/impi/3.2.0.011/lib64 -L/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7 -L/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7 -L/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/../../../../lib64 -L/lib/../lib64 -L/usr/lib/../lib64 -L/app/intel/mkl/10.1.0.015/lib/em64t -L/opt/intel/Compiler/11.0/083/ipp/em64t/lib -L/opt/intel/Compiler/11.0/083/mkl/lib/em64t -L/opt/intel/Compiler/11.0/083/tbb/em64t/cc4.1.0_libc2.4_kernel2.6.16.21/lib -L/opt/intel/Compiler/11.0/083/ipp/em64t/lib -L/opt/intel/Compiler/11.0/083/mkl/lib/em64t -L/opt/intel/Compiler/11.0/083/tbb/em64t/cc4.1.0_libc2.4_kernel2.6.16.21/lib -L/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/../../.. --enable-new-dtags -rpath /opt/intel/impi/3.2.0.011/lib64 -rpath /opt/intel/mpi-rt/3.2 -lmpi -lmpigf -lmpigi -lrt -lpthread -ldl -lgfortranbegin -lgfortran -lm -lgcc_s -lgcc -lc -lgcc_s -lgcc /usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/crtend.o /usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/../../../../lib64/crtn.o
/usr/lib/gcc/x86_64-redhat-linux6E/4.4.7/libgfortranbegin.a(fmain.o): In function `main':
(.text+0x26): undefined reference to `MAIN__'
collect2: ld returned 1 exit status 
```

# android - 从 Android 中的 WiFi 检索供应商特定信息

> ID：15536239
> 
> 赞同：1
> 
> 时间：2013-03-20T22:45:58.240
> 
> 标签：android, wifi

有人知道如何检索在 Android 中检测到的 WiFi 网络的供应商信息吗？例如，如果它是 Cisco 路由器，似乎有某种方法可以从电话中确定这一点。

似乎有许多应用程序可以做到这一点。

[https://play.google.com/store/apps/details?id=list.name&hl=en](https://play.google.com/store/apps/details?id=list.name&hl=en)

这些似乎不存在于收到的 ScanResult 中。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:52:54.087

他们可能使用 MAC 地址数据库来查找供应商。

我找不到它的 Java 库，但 Wireshark 维护了一个数据库：[https ://code.wireshark.org/review/gitweb?p=wireshark.git;a=blob_plain;f=manuf](https://code.wireshark.org/review/gitweb?p=wireshark.git;a=blob_plain;f=manuf)

您必须将它导入到您的应用程序中，也许是在您的 SQLite 数据库中并将其用作查找。

# c++ - Qt C++ 将 QString 转换为 long

> ID：15536240
> 
> 赞同：1
> 
> 时间：2013-03-20T22:46:09.847
> 
> 标签：c++, qt

我正在尝试使用以下命令将 QString 转换为 long ：

```
 QTextStream stream(&file);
        QString content = stream.readAll();
        qDebug() << "String: " << content;
        bool ok;
        long long a = content.toLong(&ok, 10);
        qDebug() << a;
        file.close(); 
```

但我从 qDebug 得到以下输出：

```
String:  "123451234512345
" 
0 
```

似乎这个 qstring 无法转换为 long long 变量，因为我总是得到 0。我尝试转换像 1234 这样的较小数字并且它可以工作，但是当我尝试转换这个大数字时，我遇到了问题。请帮忙

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T22:52:49.970

无符号长整数（32 位）的最大值为 4294967295 - 有符号长整数的一半 - 您的值超过了该值。您应该改用该`toLongLong`功能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T22:50:50.920

你已经超出了很长的范围。字符串中的数字太大。长时间查找最大尺寸。试试 tolonglong 。 [http://qt-project.org/doc/qt-4.8/qstring.html#toLongLong](http://qt-project.org/doc/qt-4.8/qstring.html#toLongLong)

# javascript - 如何从gmaps RECTANGLE（叠加）中获取4个顶点坐标？

> ID：15536241
> 
> 赞同：24
> 
> 时间：2013-03-20T22:46:10.237
> 
> 标签：javascript, google-maps

如何从 gmaps RECTANGLE (Overlay) 获得 4 个顶点坐标？

我只能从 NE 和 SW lat long`selectedShape.getBounds()`

我需要一个 4 顶点矩形来对 MySQL php 函数进行后处理检查。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-03-20T23:00:48.060

NorthWest = NorthEast Lat , SouthWest Lng

SouthEast = SouthWest Lat , NorthEast Lng

```
var bounds = rectangle.getBounds();
var NE = bounds.getNorthEast();
var SW = bounds.getSouthWest();
// North West
var NW = new google.maps.LatLng(NE.lat(),SW.lng());
// South East
var SE = new google.maps.LatLng(SW.lat(),NE.lng()); 
```

[示例小提琴](http://jsfiddle.net/geocodezip/aom5o2o5/)

**代码片段：**

```
var geocoder;
var map;

function initialize() {
  var map = new google.maps.Map(
    document.getElementById("map_canvas"), {
      center: new google.maps.LatLng(37.4419, -122.1419),
      zoom: 13,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });
  google.maps.event.addListenerOnce(map, 'bounds_changed', function() {
    var rectangle = new google.maps.Rectangle({
      bounds: map.getBounds()
    })
    var bounds = rectangle.getBounds();
    var NE = bounds.getNorthEast();
    var NEmark = new google.maps.Marker({
      map: map,
      position: NE,
      title: "NE"
    });
    var SW = bounds.getSouthWest();
    var SWmark = new google.maps.Marker({
      map: map,
      position: SW,
      title: "SW"
    });
    // North West
    var NW = new google.maps.LatLng(NE.lat(), SW.lng());
    var NWmark = new google.maps.Marker({
      map: map,
      position: NW,
      title: "NW"
    });
    // South East
    var SE = new google.maps.LatLng(SW.lat(), NE.lng());
    var SEmark = new google.maps.Marker({
      map: map,
      position: SE,
      title: "SE"
    });

    var polygon = new google.maps.Polygon({
      map: map,
      paths: [
        [NE, NW, SW, SE]
      ]
    });
    map.setZoom(map.getZoom() - 1);
  });
}
google.maps.event.addDomListener(window, "load", initialize);
```

```
html,
body,
#map_canvas {
  height: 100%;
  width: 100%;
  margin: 0px;
  padding: 0px
}
```

```
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCkUOdZ5y7hMm0yrcCQoCvLwzdM6M8s5qk"></script>
<div id="map_canvas"></div>
```

# android - 如何在 Android 上启用或实现 HttpsURLConnection 流量的日志记录？

> ID：15536252
> 
> 赞同：0
> 
> 时间：2013-03-20T22:47:06.163
> 
> 标签：android, logging, https, httpsurlconnection

我需要能够记录（至少）标题和（可选）在我的应用程序中使用 HttpsURLConnection 发送/接收的未加密消息的正文。这应该与[此](http://hc.apache.org/httpclient-3.x/logging.html)类似。

有没有一种简单的方法来做到这一点（例如设置一些标志来启用它）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T14:20:20.053

## 复杂的工作解决方案

[使用此处](http://www.javaspecialists.eu/archive/Issue168.html)的 Delegator 类实现了自定义 SSLSocketFactory 和 SSLSocket 的子类。Delegator 被扩展为在层次结构的超类中执行方法查找。

[你可以从这里](https://bitbucket.org/ivan_onys/httpsurlconnlogging)下载演示项目，看看它是如何工作的。

## 简单的非工作解决方案

SSL 层实现包含自己的日志记录代码，它使用 org.apache.harmony.xnet.provider.jsse.Logger 类。它从 jsse 系统属性中读取参数名称，如果已定义，可能包含逗号分隔的值列表 conn_state、prf、alert、ssocket、record、engine 和 socket。

默认情况下，它将输出定向到 System.err。

所以我将输出重定向到 logcat

```
$ adb shell stop
$ adb shell setprop log.redirect-stdio true
$ adb shell start 
```

但是（我认为）在 Logger 类使用它之前未能初始化 jsse 系统属性。在三个选项中：使用 adb shell setprop 设置它，创建 /data/local.prop 并在 MainActivity 类的静态初始化程序中使用 System.setProperty() 设置，只有后面的选项成功（至少 getProperty() 返回设置值后）。

如果您使用第二种方法成功，请告知。

# ios - NSLineBreakByWordWrapping 在第一行但 NSLineBreakByTruncatingTail 在第二行？

> ID：15536260
> 
> 赞同：2
> 
> 时间：2013-03-20T22:47:55.170
> 
> 标签：ios, objective-c, cocoa-touch, uilabel, word-wrap

这可能吗？

我想要一个两行标签。在第一行，我希望它包含文字。但是对于第二行，如果文本太长，我希望它被尾部截断并在`"..."`后面添加省略号。

关于最简单的方法的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:15:32.597

在我的评论中，我对换行模式的看法是错误的。如果你只是拖出一个UILabel，默认的换行符是Truncate Tail，这就是你想要的。如果将标签设置为两倍高，并将行数设置为 2，则文本将换行，如果第二行太长，则会显示省略号。不需要做任何花哨的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:49:57.617

您是否尝试过在`setTruncatesLastVisibleLine:YES`上使用该属性`UITextField`？

我知道这只是打开，`UITextField` **但**如果你删除任何边框（并禁用编辑），它看起来就像一个 UILabel，你会得到你想要的功能。

```
textField.enabled = NO;
textField.borderStyle = UITextBorderStyleNone; 
```

# ruby-on-rails - Rails 中的注册表单和外键

> ID：15536264
> 
> 赞同：0
> 
> 时间：2013-03-20T22:48:08.877
> 
> 标签：ruby-on-rails, forms, ruby-on-rails-3.2

好的，我在这里遗漏了一些明显的东西，但是这里有：

我用 Devise 创建了一个用户

我创建了一个`user_goals`有四个目标的模型

我`user_goal_id`在用户表中创建了一个字段。

在我的用户注册表单中，我想展示`collection_select`四个可能的目标中的一个，并在创建用户时将所选目标的 id 放入 users 表中。

我不知道该怎么做。具体来说，我不知道如何将`user_goals`选定的 id写入`user_goal_id`users 表中的字段。

编辑：

我是否需要创建一个 user_goals 控制器，或者我可以将控制器逻辑放在 users_controller 中吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:58:50.507

请提出准确的问题，这太笼统了。给出你的代码的某些部分并提出一些精确的问题，如果你真的不明白你在问什么，试图回答你的人也不会明白。请查看 Rails 指南，有一个关于 ActiveRecord 关系（包装外键）的好章节并做一些教程。一旦你了解它是如何工作的，如果你需要关于错误消息或一段代码的精确帮助，请回来提出你的问题，我相信你会得到快速的答案:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T16:13:43.120

好的，事实证明这真的很简单。您不需要在控制器或模型中执行任何逻辑。您只需在注册表中执行以下操作：

```
<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %> 
```

上面的行只是`form_for`创建表单的行。脚手架，或者在这种情况下，Devise 将创建它。记得`do |f|`最后。

```
<%= devise_error_messages! %>
    <%= f.label :Whats_your_goal? %><br />
    <%= f.collection_select :user_goal_id, UserGoals.all, :id, :name, { :include_blank => ""}%> 
```

第一行只是字段的标签

第二行是下拉菜单。`f.collection_select`告诉您的表单生成器这将是一个选项的下拉列表。

`:user_goal_id`是用户表中我要记录表中`foreign key`目标的字段的名称`user_goals`。

`UserGoals.all`是我希望下拉列表从中填充的数据库表的名称。`.all`说我想要那个数据库表中的所有项目

我相信`:id,`通过它们的数据库 ID 号或主键提取项目，并`:name`说给我表的名称列，而不是描述或其他东西。

最后，`{ :include_blank => "" }`只需在下拉列表顶部创建一个空白区域，因此没有默认选择。如果需要，您还可以在两者之间添加消息`""`。

我很难找到一个简单的解释，可能是因为它太基础了。希望其他人会发现这很有用。

# android - Android SQLiteDatabase - 存储和比较大数

> ID：15536267
> 
> 赞同：3
> 
> 时间：2013-03-20T22:48:31.643
> 
> 标签：android, comparison, largenumber, sqlite

我正在尝试存储一个非常大的数字，该数字大于 INTEGER 和 REAL 字段类型可以容纳的 8 个字节。我需要能够返回包含此字段中的数字的行，该数字小于或大于我指定的另一个大数字。我不知道该怎么做。似乎我唯一的选择是将其存储为 TEXT，但是当我尝试在查询中使用 > 和 < 进行比较时遇到问题，因为 TEXT 的比较与数字比较不同（当数字的位数不同）。我尝试过使用 BLOB 或将我的大数存储为字节数组，但无济于事。用零填充数字以使它们具有相同的位数也不起作用，因为我不知道数字可能有多大。任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T07:44:44.943

对于存储，您唯一的选择是 TEXT 或 BLOB，因此您必须以某种方式对数字进行编码，以便字典顺序和数字顺序相同。

对于无符号数，您可以使用类似于 SQLite4 的[`varint`encoding](http://sqlite.org/src4/artifact/2e68f22730ce9fd9ef893f0f5a1eb17822e829a5)的机制：

> 让编码的字节被称为 A0, A1, A2, ..., A8。
> 如果 A0 介于 0 和 240（含）之间，则结果为 A0 的值。
> 如果 A0 介于 241 和 248 之间，则结果为 240+256*(A0-241)+A1。
> 如果 A0 为 249，则结果为 2287+256*A1+A2。
> 如果 A0 为 250，则结果为 A1..A3 作为 3 字节大端整数。
> 如果 A0 为 251，则结果为 A1..A4 作为 4 字节大端整数。
> 如果 A0 为 252，则结果为 A1..A5 作为 5 字节大端整数。
> 如果 A0 为 253，则结果为 A1..A6 作为 6 字节大端整数。
> 如果 A0 为 254，则结果为 A1..A7 作为 7 字节大端整数。
> 如果 A0 为 255，则结果为 A1..A8 作为 8 字节大端整数。

以上是为最多 64 位数字设计的。只要你有一个上限，为更大的数字扩展机制是微不足道*的*。

如果数字可以签名，则必须将`A0`范围分成两半，并将前半部分用于负数。

如果您不需要进行计算，您可以使用相同的原则来存储 ASCII 数字而不是二进制值。也就是说，使用具有*固定*长度的前缀来指定数字的长度，然后是数字。假设您的号码不超过 9999 位，您可以使用四个前缀长度，例如：

```
0001|0  ...
0001|9
0002|10  ...
0002|99
0003|100  ...
0060|321741185926535897932384626433832795281828459045235360287471 
```

如果这里需要负值，则必须为正确排序的负数/正数选择一个附加前缀（ / 的 ASCII 顺序`-`是`+`错误的，所以最好使用`n`/之类的东西`p`），并且必须使用*9999 之类的前缀 -负数的长度*，以便较小的负数具有较小的前缀。

# mysql - 如何在 MySQL 中解决错误 #1064

> ID：15536268
> 
> 赞同：-2
> 
> 时间：2013-03-20T22:48:34.063
> 
> 标签：mysql, stored-procedures

当我尝试使用存储过程时，我不断收到同样的错误。

例子：

```
CREATE PROCEDURE mmStudents
AS 
SELECT * FROM student where course 'mm' 
```

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 2 行的“AS SELECT * FROM student where course 'mm'' 附近使用正确的语法

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:55:38.650

MySQL Store Procedure doesn't have `AS` keyword. It should be

```
DELIMITER $$
CREATE PROCEDURE mmStudents()
BEGIN
    SELECT * FROM student where course = 'mm';
END $$
DELIMITER ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:55:27.177

您的 where 子句缺少一个运算符

```
SELECT * FROM student where course = 'mm' 
```

例如。

从[`CREATE PROCEDURE`](http://dev.mysql.com/doc/refman/5.5/en/create-procedure.html)

> 括号内的参数列表必须始终存在。如果没有参数，则应使用 () 的空参数列表。

所以你的完整陈述应该是

```
CREATE PROCEDURE mmStudents()
SELECT * FROM student where course = 'mm' 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-20T22:54:51.730

我认为您应该查看 MySQL[文档到 Stored Procedures](http://dev.mysql.com/doc/refman/5.0/en/create-procedure.html)。

那里有一个关于如何创建存储过程的好例子。

希望能帮助到你！

# sql-server - 向与另一个表共享键的表插入列

> ID：15536269
> 
> 赞同：1
> 
> 时间：2013-03-20T22:48:38.860
> 
> 标签：sql-server, tsql, join, merge

我不确定我是否使用正确的功能来做我想做的事。这是我到目前为止的代码：

```
insert into assets(owner)
(select a.Username as whatIwant
from dbo.DIRECTORY a join dbo.ASSETS b
on a.Ext = b.Ext) 
```

我有一张带有资产（dbo.assets）的表，其中有一列（ext），其中包含资产所绑定的电话分机号。在另一个表 (dbo.directory) 中，我有一列电话分机 (ext) 的号码与驻留在该分机 (用户名) 处的人的姓名相关联。

我想做的是将绑定到电话分机的人的用户名插入到新列下的 dbo.assets 中：所有者。因此，分机必须与用户名匹配。我应该改用合并吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:57:17.703

您没有提及您正在使用哪个 RDMS。无论哪种方式，您都需要先将列添加到表中，然后您将更新设置列值的行。在 SQL Server 中，它看起来像这样。

```
ALTER TABLE assets ADD owner VARCHAR(20) NULL

update a 
set a.owner = b.username
from assets a
inner join directory b on a.ext=b.ext 
```

# javascript - 混乱的操作顺序问题

> ID：15536274
> 
> 赞同：1
> 
> 时间：2013-03-20T22:49:15.083
> 
> 标签：javascript, operator-precedence

我有一个看起来像这样的函数：

```
function showCreditCard(idx, data) {

    if(typeof cardInfo == 'undefined' && parseInt($("#cc-dropdown-" + idx + " option:selected").val(),10) > -1) {
       // actual selection made, but not default, so cardInfo hasn't been set. Need to run ajax call to get credit card;
       console.log("show dropdown");
       console.log("there are saved cards and a selection was made");
       poGetPaymentOption('credit card', parseInt($("#cc-dropdown-" + idx + " option:selected").val(),10), idx);

        // this is the default card; display dropdown with default selected and static fields
        console.log("supposedly after poGetPayment");
        console.dir(cardInfo);

        // why is this stuff running before poGetPaymentOtion finishes and returns a cardInfo object?
        if( cardInfo.cc.cc_type == 'VI' ) { $('#cc_visaBig-'+idx).attr('class', 'cc_visaBig'); }

        $('#cc-static-wrap-'+idx).show();
        updateButtonState();

    }

} 
```

正如您从注释中看到的那样，`poGetPaymentOption`调用之后的行在该函数实际完成之前运行。我也通过`poGetPaymentOption`函数中的日志验证了这一点（如下）。

```
function poGetPaymentOption(type, key, bIdx) {
   if( type == 'credit card' ) {
      console.log("signed in, credit card");
      $.post('/site/ajax/customers/getSingleCreditCard',
          { 'key': key },
          function(data) {
            if( data.success == 1 ) {
                console.log("poPayment success");
                    if(typeof cardInfo == 'undefined') {
                        cardInfo = new saveCardInfo(data);
                    }    

            } else {
              console.log("poPayment no success");
            }
          }, 'json');
    } 
} 
```

我期望发生的是调用 from `showCreditCard`to`poGetPaymentOption`通过 ajax 调用返回成功（它确实如此），然后创建一个`saveCardInfo`名为`cardInfo`. 据我所知，它确实发生了，但是检查`cardInfo.cc.cc_type`和超越的行都是在创建对象之前发生的。我附上了我的 Firebug 控制台的屏幕截图，所以事情发生的顺序很明显。

![在此处输入图像描述](../Images/062bcd5aae51e4728ede59f8815b36b6.png)

我究竟做错了什么？在继续使用该功能之前，我需要确保它`poGetPaymentOption`已完全完成并`cardInfo`已创建。`showCreditCard`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:55:43.120

AJAX 调用是异步的，所以成功回调函数将在响应到达时调用，而不是立即调用。

实际上，当您的代码运行时，无法处理响应到达时发生的事件。即使响应在您退出函数之前到达，在您退出`showCreditCard`函数之前不会处理事件，因此在您退出`showCreditCard`函数之前永远不会调用回调。

要使用获取的数据，您需要在成功回调函数中执行此操作。将代码移动到该函数中，或者将回调函数发送到 中`poGetPaymentOption`，以便在响应到达时调用它。

（为了完整性；进行同步调用将使您的代码无需重新排列即可正常工作，但不建议这样做，因为它会在等待响应时冻结浏览器。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:54:01.963

发生这种情况是因为`$.post()`异步执行。

基本上，当 AJAX 调用转到服务器时，您的 JS 代码会同步继续。只有当服务器响应您的回调函数时才会执行。

在您的确切示例中，之后的所有内容都`poGetPaymentOption('credit card', parseInt($("#cc-dropdown-" + idx + " option:selected").val(),10), idx);`将在执行匿名函数之前执行：

```
 function(data) {
        if( data.success == 1 ) {
            console.log("poPayment success");
                if(typeof cardInfo == 'undefined') {
                    cardInfo = new saveCardInfo(data);
                }    

        } else {
          console.log("poPayment no success");
        }
      } 
```

要解决此问题，您需要`showCreditCard`在回调中移动其余的函数。或者创建另一个在回调中调用的函数。

# java - Eclipse Builders：验证返回码？

> ID：15536281
> 
> 赞同：2
> 
> 时间：2013-03-20T22:50:24.133
> 
> 标签：java, eclipse, builder

因此，我们的 java 代码库非常复杂，以至于我们不能使用 Eclipse 的增量编译功能，而是使用名为“intern”的脚本和参数 build。因此，我在 Eclipse 中添加了一个程序构建器，其中包含实习生路径和单个参数构建： ![实习生](../Images/6c86c3883e43288027bf9b954820f9a7.png)

但是，如果我按 F11 进行调试，并且构建失败，Eclipse 会很高兴地忽略这一点并继续启动程序，即使我已经在构建选项下分配了一个控制台。如果构建失败，有关如何停止调试启动的任何想法？

我有一个想法（但可能行不通）是让构建器运行一个自定义脚本，`intern build`如果它失败，它会运行并暂停。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T22:54:19.557

由于没有人回复，我只是结束了：

1.  修改`bin/intern`脚本以添加`-eclipse_build`参数，如果存在，将`read -p "Build failed"`在失败时调用（以显示“构建失败”并暂停控制台）。
2.  将构建器中的参数更改为`build -eclipse_build`

这对我来说很好。希望这对未来的搜索者有所帮助！

# python - 去除逗号和句点

> ID：15536287
> 
> 赞同：5
> 
> 时间：2013-03-20T22:50:53.227
> 
> 标签：python, file-io, stripping

我目前正在尝试输入一个文本文件，将每个单词分开并将它们组织成一个列表。

我目前遇到的问题是从文本文件中删除逗号和句点。

我的代码如下：

```
#Process a '*.txt' file.
def Process():
    name = input("What is the name of the file you would like to read from? ")

    file = open( name , "r" )
    text = [word for line in file for word in line.lower().split()]
    word = word.replace(",", "")
    word = word.replace(".", "")

    print(text) 
```

我目前得到的输出是这样的：

```
['this', 'is', 'the', 'first', 'line', 'of', 'the', 'file.', 'this', 'is', 'the', 'second', 'line.'] 
```

如您所见，“文件”和“行”这两个词的末尾有一个句点。

我正在阅读的文本文件是：

> 这是文件的第一行。
> 
> 这是第二行。

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T22:53:07.300

这些行没有效果

```
word = word.replace(",", "")
word = word.replace(".", "") 
```

只需将您的列表组合更改为：

```
[word.replace(",", "").replace(".", "") 
 for line in file for word in line.lower().split()] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-20T22:53:47.863

也许`strip`比`replace`

```
def Process():
    name = input("What is the name of the file you would like to read from? ")

    file = open(name , "r")
    text = [word.strip(",.") for line in file for word in line.lower().split()]
    print(text) 
```

```
>>> 帮助（str.strip）
关于method_descriptor的帮助：

跳闸（...）
    S.strip([chars]) -> 字符串或 unicode

    返回带有前导和尾随的字符串 S 的副本
    空格被删除。
    如果给出了 chars 而不是 None，则改为删除 chars 中的字符。
    如果 chars 是 unicode，则 S 将在剥离前转换为 unicode

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:59:08.760

尝试这个：

```
 chars = [',', '.']

 word.translate(None, ''.join(chars)) 
```

对于 Python3

```
 chars = [',', '.']
 word.translate({ord(k): None for k in chars}) 
```

# batch-file - 在另一个 for 循环中的 findstr 中放置 2 个 for 循环

> ID：15536291
> 
> 赞同：0
> 
> 时间：2013-03-20T22:51:02.703
> 
> 标签：batch-file, cmd

如何在 for 循环中的 findstr 中放置 2 个 for 循环？

我所拥有的是一个 for 循环内的 findstr 内的两个 for 循环。我正确地做括号吗？

我想在 *.map 文件中找到 var1 (%%A)，它将位于一行的末尾。如果找到，我想获取该行上的第二个项目 (%%B) 并将其称为 var2 和该行上的第四个项目 (%%C) 并将其称为 var3。然后回显所有三个变量。

```
@echo off

SETLOCAL ENABLEDELAYEDEXPANSION

for /f "delims=" %%A in (Marks.txt) do (

set var1=!var1!%%A

findstr /e "!var1!" "*.map"

if not errorlevel 1 (

for /f "tokens=2" delims=%=%,." %%B do (
set var2=!var2!%%B
)

&

for /f "tokens=4" delims=%=%,." %%C do (
set var3=!var3!%%C
)

)

)

echo !var1!
echo !var2!
echo !var3!

choice /C X /T 8 /D X > nul 
```

我收到一个错误，窗口关闭，所以我无法阅读。我尝试使用计时器和暂停，但我无法保持 cmd 提示符打开。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T07:49:17.990

我已经解决了我的问题。我有额外的引号，并且缺少 in (....) 部分。

# python - Python多处理进程静默崩溃

> ID：15536295
> 
> 赞同：13
> 
> 时间：2013-03-20T22:51:23.303
> 
> 标签：python, python-2.7, parallel-processing, multiprocessing

我正在使用 Python 2.7.3。我已经使用子类`multiprocessing.Process`对象并行化了一些代码。如果我的子类 Process 对象中的代码没有错误，那么一切运行正常。但是，如果我的子类 Process 对象中的代码有错误，它们显然会默默地崩溃（没有堆栈跟踪打印到父 shell）并且 CPU 使用率将下降到零。父代码永远不会崩溃，给人的印象是执行只是挂起。同时，很难找出代码中的错误在哪里，因为没有给出错误在哪里的指示。

我在 stackoverflow 上找不到任何其他处理相同问题的问题。

我猜想子类 Process 对象似乎会默默地崩溃，因为它们无法将错误消息打印到父的 shell，但我想知道我能做些什么，以便我至少可以更有效地调试（以及其他我的代码的用户也可以在遇到问题时告诉我）。

**编辑：**我的实际代码太复杂了，但是一个带有错误的子类 Process 对象的简单示例将是这样的：

```
from multiprocessing import Process, Queue

class Worker(Process):

    def __init__(self, inputQueue, outputQueue):

        super(Worker, self).__init__()

        self.inputQueue = inputQueue
        self.outputQueue = outputQueue

    def run(self):

        for i in iter(self.inputQueue.get, 'STOP'):

            # (code that does stuff)

            1 / 0 # Dumb error

            # (more code that does stuff)

            self.outputQueue.put(result) 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-21T00:08:46.293

您真正想要的是某种将异常传递给父进程的方法，对吗？然后你可以随心所欲地处理它们。

如果您使用[`concurrent.futures.ProcessPoolExecutor`](http://docs.python.org/dev/library/concurrent.futures.html)，这是自动的。如果你使用[`multiprocessing.Pool`](http://docs.python.org/dev/library/multiprocessing.html#using-a-pool-of-workers)，它是微不足道的。如果你使用显式`Process`and `Queue`，你必须做一些工作，但不是*那么*多。

例如：

```
def run(self):
    try:
        for i in iter(self.inputQueue.get, 'STOP'):
            # (code that does stuff)
            1 / 0 # Dumb error
            # (more code that does stuff)
            self.outputQueue.put(result)
    except Exception as e:
        self.outputQueue.put(e) 
```

然后，您的调用代码可以`Exception`像其他任何内容一样从队列中读取 s。而不是这个：

```
yield outq.pop() 
```

做这个：

```
result = outq.pop()
if isinstance(result, Exception):
    raise result
yield result 
```

（我不知道你实际的父进程队列读取代码做了什么，因为你的最小样本只是忽略了队列。但希望这能解释这个想法，即使你的真实代码实际上并不是这样工作的。）

这假定您要中止任何未处理的异常，使其达到`run`. 如果您想传回异常并继续到下一个`i in iter`，只需将 移到`try`，`for`而不是围绕它。

这也假设`Exception`s 不是有效值。如果这是一个问题，最简单的解决方案就是推送`(result, exception)`元组：

```
def run(self):
    try:
        for i in iter(self.inputQueue.get, 'STOP'):
            # (code that does stuff)
            1 / 0 # Dumb error
            # (more code that does stuff)
            self.outputQueue.put((result, None))
    except Exception as e:
        self.outputQueue.put((None, e)) 
```

然后，您的弹出代码执行以下操作：

```
result, exception = outq.pop()
if exception:
    raise exception
yield result 
```

您可能会注意到这类似于 node.js 回调样式，您传递`(err, result)`给每个回调。是的，这很烦人，而且你会弄乱这种风格的代码。但是除了包装器之外，您实际上并没有在任何地方使用它；所有从队列中获取值或在内部调用的“应用程序级”代码`run`只会看到正常的返回/收益和引发的异常。

您甚至可能想要考虑构建一个`Future`符合规范的`concurrent.futures`（或按原样使用该类），即使您正在手动进行排队和执行工作。这并不难，它为您提供了一个非常好的 API，尤其是用于调试。

最后，值得注意的是，大多数围绕工作者和队列构建的代码可以通过执行器/池设计变得更简单，即使您绝对确定每个队列只需要一个工作者。只需废弃所有样板，并将`Worker.run`方法中的循环转换为函数（正常情况下只是`return`s 或`raise`s，而不是附加到队列中）。在调用方，再次废弃所有样板文件和只是`submit`或`map`带有参数的作业函数。

您的整个示例可以简化为：

```
def job(i):
    # (code that does stuff)
    1 / 0 # Dumb error
    # (more code that does stuff)
    return result

with concurrent.futures.ProcessPoolExecutor(max_workers=1) as executor:
    results = executor.map(job, range(10)) 
```

它会自动正确处理异常。

* * *

正如您在评论中提到的，异常的回溯不会回溯到子进程；它只涉及手动`raise result`调用（或者，如果您使用的是池或执行器，则池或执行器的胆量）。

原因是它`multiprocessing.Queue`建立在 之上`pickle`，并且腌制异常不会腌制它们的回溯。原因是你不能腌制回溯。原因是回溯中充满了对本地执行上下文的引用，因此让它们在另一个进程中工作将非常困难。

那么……你能做些什么呢？不要去寻找一个完全通用的解决方案。相反，想想你真正需要什么。90% 的情况下，您想要的是“记录异常，使用回溯并继续”或“打印异常，使用回溯，到`stderr`默认`exit(1)`的未处理异常处理程序”。对于其中任何一个，您根本不需要传递异常；只需在子端格式化它并传递一个字符串。如果您*确实*需要更花哨的东西，请准确计算出您需要什么，并传递足够的信息来手动将它们组合在一起。如果您不知道如何格式化回溯和异常，请参阅[`traceback`](http://docs.python.org/2/library/traceback.html)模块。这很简单。这意味着您根本不需要进入泡菜机械。（不是那个'`copyreg`一个pickler或用一个`__reduce__`方法或任何东西编写一个持有者类，但如果你不需要，为什么要学习所有这些？）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-09T16:51:52.817

我建议这样的解决方法来显示进程的异常

```
from multiprocessing import Process
import traceback

run_old = Process.run

def run_new(*args, **kwargs):
    try:
        run_old(*args, **kwargs)
    except (KeyboardInterrupt, SystemExit):
        raise
    except:
        traceback.print_exc(file=sys.stdout)

Process.run = run_new 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T23:57:30.180

这不是答案，只是扩展评论。请运行这个程序并告诉我们你得到了什么输出（如果有的话）：

```
from multiprocessing import Process, Queue

class Worker(Process):

    def __init__(self, inputQueue, outputQueue):

        super(Worker, self).__init__()

        self.inputQueue = inputQueue
        self.outputQueue = outputQueue

    def run(self):

        for i in iter(self.inputQueue.get, 'STOP'):

            # (code that does stuff)

            1 / 0 # Dumb error

            # (more code that does stuff)

            self.outputQueue.put(result)

if __name__ == '__main__':
    inq, outq = Queue(), Queue()
    inq.put(1)
    inq.put('STOP')
    w = Worker(inq, outq)
    w.start() 
```

我得到：

```
% test.py
Process Worker-1:
Traceback (most recent call last):
  File "/usr/lib/python2.7/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/unutbu/pybin/test.py", line 21, in run
    1 / 0 # Dumb error
ZeroDivisionError: integer division or modulo by zero 
```

我很惊讶（如果）你什么也没得到。

# r - 到 dist 元素的距离矩阵

> ID：15536296
> 
> 赞同：0
> 
> 时间：2013-03-20T22:51:29.203
> 
> 标签：r

这里是 R 的新手。我已经计算了一个距离矩阵，比如说，点 a、b、c：

```
(a,a) = 0;
(a,b) = 1;
(a,c) = 5;
(b,a) = 1;
(b,b) = 0;
(b,c) = 7;
(c,a) = 5;
(c,b) = 7;
(c,c) = 0; 
```

我想使用一个需要'dist' R 元素的函数。我的距离函数是对项目坐标进行计算的结果，但它不是标准计算，因此我无法使用 dist 构造函数创建 dist 元素，它只需要几个预定义的距离度量。

底线是我想从我计算的矩阵中创建 dist 元素。

感谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:10:38.490

您可以从矩阵创建距离类对象

只需创建矩阵并使用`as.dist`

例如

```
 as.dist(matrix( c(0, 1, 5, 1, 0, 7, 5, 7, 0), ncol=3))

  1 2
2 1  
3 5 7 
```

# php - 将 MySQL 内爆数组中的项目与查询中的 PHP 数组匹配

> ID：15536303
> 
> 赞同：0
> 
> 时间：2013-03-20T22:52:37.687
> 
> 标签：php, mysql

我是数据库新手，如何通过将 PHP 数组中的项目与 MySQL 内爆数组中的项目进行匹配来搜索行？出于方便，它是这样存储的，但如果有更好的方法来做我想做的事，我会全力以赴。我正在寻找这样的东西（我用*** * 表示我在哪里挥手）：

```
$sql = "SELECT * FROM codeunits";
$sql .= " WHERE CASE WHEN private=1 THEN creatorID=:userID ELSE true END";
if (isset($tags))
{
  $tag_ids = join(',',$tags);
  $sql .= " AND ****items in mysql array 'tags'  IN :tags";
  if($stmt = $this->_db->prepare($sql)) {
    $stmt->bindParam(":userID", $userID, PDO::PARAM_STR);
    $stmt->bindParam(":tags", $tag_ids, PDO::PARAM_STR);
    $stmt->execute();
    $stmt->closeCursor();
  }
} 
```

这是我将项目存储到数据库中的方式。$values 绑定到 tags 列的查询，因此我称它为 MySQL 数组。

```
 $tags = array();
    foreach ($_POST['tags'] as $selectedOption)
    {
        $tags[] = $selectedOption;
    }
    $values  = implode(",",array_values($tags));
    $sql = "INSERT INTO "
      ."codeunits(tags)"
      ." VALUES(:tags)";
      if($stmt = $this->_db->prepare($sql)) {             
          $stmt->bindParam(":tags", $values, PDO::PARAM_STR);
          $stmt->execute();

          $stmt->closeCursor();

          return true;
        } 
```

这导致我的数据库中的条目看起来像'tag1，tag2，tag3'。很简单的字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:20:17.970

对于这种查询，这不是一个好的数据库设计，您将不得不使用 LIKE 来查找标签。

相反，您应该有一个表格“标签”，每行包含一个标签，然后您可以使用带有“IN”语句的连接：

```
SELECT * FROM codeunits JOIN tags ON tags.codeunit_id=codeunits.ID WHERE tags.name IN (:tags) AND CASE WHEN private=1 THEN creatorID=:userID ELSE true END 
```

# javascript - HTML5 Canvas - 用落下的金片制作动画背景

> ID：15536308
> 
> 赞同：0
> 
> 时间：2013-03-20T22:52:58.107
> 
> 标签：javascript, html, animation, canvas, particles

我正在一个需要动画背景的网站上工作。我试图模仿落下的金片。最初我们尝试使用动画 gif，但它太重且太慢了。

这是我第一次使用 Canvas，我肯定希望有更多经验的人给我一些意见。

我找到了一些代码作为起点，并根据我的需要重新调整了它的用途。这是我目前所在的位置：[http ://codepen.io/slickdev/pen/LqKai](http://codepen.io/slickdev/pen/LqKai)

**待办事项**：我想减慢下落粒子的速度，并将它们的形状从完美的圆形改变为看起来更像落下的金片。如果我能让它看起来更真实，那将是理想的。我还需要关注性能。有没有办法优化它以更有效地运行？

在可访问性/跨浏览器兼容性方面，这种方法有什么缺点吗？我做了一些研究，似乎得到了广泛的支持。

您的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-27T23:20:00.217

我不知道你现在是否已经有机会完成这个，但是这里......

要更改下落粒子的速度，您需要在您的分叉笔的第 57 和 58 行编辑`@vx`和`@vy`，类似于：

```
@vx = range(0,1)+8*xpos-5
@vy = 0.2*@r 
```

我发现改变 DOP（和 Y 值来补偿）也让一些东西更“可信”：

```
@dop = 0.001*range(1,5)
@y = range(-100,h-@r2) 
```

关于绘制更“逼真”的雪花，我个人更喜欢看到更接近“圆形”的形状，因为*实际*的雪花本身在现实生活中更难看到。但是，如果您热衷于研究您最初的想法，我可以为您指出[HTML5 画布分形](http://www.tungnm.com/index.php?ItemID=19)。

如果您正在寻找简单的东西，那么要研究什么的一个很好的例子是*Pentaflake 分形*。如果你真的想让人们大开眼界，那么我建议您查看这个 HTML 画布分形应用程序的源代码，请[点击此处](http://rectangleworld.com/blog/archives/561)。

我希望这有帮助 ：）

# hyperlink - jQuery 可折叠插件：如何切换全部打开/全部关闭

> ID：15536309
> 
> 赞同：0
> 
> 时间：2013-03-20T22:53:04.897
> 
> 标签：hyperlink, toggle, collapse, jquery

[http://github.com/juven14/Collapsible](http://github.com/juven14/Collapsible) [http://www.snyderplace.com/demos/collapsible.html](http://www.snyderplace.com/demos/collapsible.html)

而不是“全部打开”和“全部关闭”这两个链接，我只想要一个链接切换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:20:13.490

`jquery.collapsible.js`API 附带一个方法`toggle`：

> 这些是插件中可用的方法：

*   cssClose - 关闭时分配的类
*   折叠 - 如果元素折叠，则返回 'true'
*   **toggle - 切换可折叠状态**
*   open - 打开一个可折叠的
*   close - 关闭一个可折叠的

> [-通过提供的页面OP](http://www.snyderplace.com/demos/collapsible.html)上的“插件方法”

模仿演示页面上的样式：

```
function toggle() {
    $('.page_collapsible').collapsible('toggle');
}

$('#toggle').click(function(event) {
    event.preventDefault();
    toggle();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:16:09.197

您需要设置一个变量，例如`var open = false;`. 每次点击一个链接，检查`open`是`true`还是`false`。现在您知道了，应该执行哪个操作 - Open all if `!open`， Cl​​ose all if `open`。不要忘记`open = !open`每次都改变值，这样动作也会改变。

# javascript - jQuery：无法自动隐藏元素

> ID：15536316
> 
> 赞同：0
> 
> 时间：2013-03-20T22:53:39.823
> 
> 标签：javascript, jquery, toggle, show-hide

我用`multiple select`表单元素和一个`text input`. 我使用 jQuery`toggle()`方法在单击文本输入时**隐藏**和**显示多个选择项。**显示多选器后，访问者可以使用**ctrl** / **cmd** / **shift**键选择多个项目，然后我需要隐藏多选项目。我可以通过再次单击文本输入来隐藏。

但是我希望它在我不使用多个选择项时自动隐藏。我在同一页面中使用它两次并使用引导程序。现在我找不到解决它的方法。

这里是来源：http: [//jsfiddle.net/3UE7D/3/](http://jsfiddle.net/3UE7D/3/)

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:58:38.037

我认为[这](https://stackoverflow.com/a/714608/459974)可以解决您的问题

[我在这里](http://jsfiddle.net/3UE7D/6/)更新了你的小提琴

我在那里添加了以下代码

```
$(document).click(function(){  
    $('select[name="location"]').slideUp(300);
});

$('select[name="location"]')
    .click(function(e) {
        e.stopPropagation();
    })    
    .hide(); 
```

# python - Python 忽略了我的 if

> ID：15536318
> 
> 赞同：-3
> 
> 时间：2013-03-20T22:53:51.287
> 
> 标签：python

谁能告诉我为什么这个循环忽略了if？（编辑：这是整个代码 - 返回一个数字的函数。）

```
time_now = time()
number = np.loadtxt("11.txt", unpack=True, dtype='int64')
lenx = len(number[0,:])
leny = len(number[:,0])
lennum = 4
#prods = np.zeros(lenx*leny*4).reshape(lenx,leny,4)
maxnum = 0

for m in range(0,leny):
    for n in range(0,lenx):
        prods = lookaround(n,m)

        if prods > maxnum:
            maxnum = prods

time_end = time();

elapsed = time_end - time_now

print(prods, elapsed) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:56:39.890

也许是因为`prods`总是小于或等于`maxnum`？你用什么值来初始化`maxnum`？它应该在循环之前设置为一个非常小的数字，比如`maxnum = float("-inf")`. 另一种可能性是`lookaround`返回不正确的值，对该函数进行单元测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:09:10.917

你可以这样写：

```
from itertools import product

time_now = time()

number = np.loadtxt("11.txt", unpack=True, dtype='int64')
lenx = len(number[0,:])
leny = len(number[:,0])

maxnum = max(lookaround(n, m) for n, m in product(range(lenx), range(leny)))

time_end = time();    
elapsed = time_end - time_now

print(maxnum, elapsed)   # <== maxnum not prods 
```

# python - 如何查找用户输入是否包含在 Python 3.3.0 中的任意整数列表中

> ID：15536325
> 
> 赞同：0
> 
> 时间：2013-03-20T22:54:15.240
> 
> 标签：python, list, if-statement

这是我正在编写的函数的一些代码，用于输出给定日期是否有效：

```
date = (input("Please enter a date (mm/dd/yyyy): "))
monthStr, dayStr, yearStr = date.split("/")
monthStr = int(monthStr)
dayStr = int(dayStr)
yearStr = int(yearStr)
Mylist1 = [1, 3, 5, 7, 8, 10, 12] 
```

所以我想做一个看起来像这样的 if 和语句，但我不知道语法或方法：

```
if monthStr (is == one of the integers in)Mylist and dayStr (is in) range(0,32):
print("Valid date")
else:
print("Not a Valid date") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:56:08.290

使用`in`关键字：

```
if month in months and day in range(1, 32): 
```

我也会重命名你的变量。`dayStr`是整数，不是字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:55:42.320

这很直观

```
if monthStr in Mylist1 and dayStr in range(0, 32):
    print("Valid date")
else:
    print("Not a Valid date") 
```

但是您的变量名称不是很好，您应该选择更相关的名称，因为`monthStr`它实际上不是一个字符串。

# numpy - Numpy 数组比较 2 个数组元素，并增加索引偏移量

> ID：15536327
> 
> 赞同：2
> 
> 时间：2013-03-20T22:54:27.430
> 
> 标签：numpy, random-walk

这是仅使用 numpy 数组的随机游走问题的一个版本。为了找到位置被重新访问超过 500 步的时间，我们必须将位置的排序数组与其偏移量进行比较，记录它接近 0 的时间，然后增加偏移量。

到目前为止，这是我的代码，问题出在“while”循环中，我试图将位置重新访问为“zeroArray”中的元素的最终次数

当我运行它时，我得到一个索引错误，没有记录任何结果，并且即使循环停止的布尔表达式已经改变，计数器也已经迭代了很多次。

编辑：如何使用 numpy 数组查找重复位置：1）将最终位置数组排序为升序。2）比较具有增加偏移量的切片，只要您在该偏移量处找到 0.001m 内的位置，即您将位置与相邻位置（偏移量 1）进行比较。您可能会发现 18 个案例，其中邻居计算出在两个空间中您可能只会找到 2 个案例。在三个空格处，您会发现 0 停止。

```
import numpy as np
import random

MAX_STEP_SIZE = 0.90    # maximum size of a single step [m]
NUM_STEPS = 500         # number of steps in a random walk []
NUM_WALKS = 10        # number of random walks in a run []
TOLERANCE = 0.001    # separation of points considered the same [m]
STEP_TO_RECORD_1 = 100 # first step to record and analyze []
STEP_TO_RECORD_2 = 500 # 2nd step to record and analyze []
random.seed(12345)

#......................................................................distance
def distance(posA, posB) :
    """Distance between two positions"""
    return np.abs(posA - posB)

#...............................................................initialPosition
def initialPosition() :
    """Initial position of walker at the start of a random walk"""
    return 0.0

def genPositions(nSteps, maxStep) :
    """Return the new position after a random step between -maxStep and
    maxStep, given the previous position"""
    genArray1 = (maxStep - (-maxStep))*(np.random.random(nSteps+1)) + (-maxStep)
    genArray1[0]=initialPosition()    
    return np.cumsum(genArray1)

oneStep = np.zeros(NUM_WALKS)
fiveStep = np.zeros(NUM_WALKS)
zeroStep = np.zeros(NUM_WALKS)
walkArray = np.zeros(NUM_WALKS)
counter = 1
hitcounter = 0
zerocounter = 0
keepchecking = bool(1)

for ii in range(NUM_WALKS):
    position = (genPositions(NUM_STEPS, MAX_STEP_SIZE))   
    oneStep[ii] = position[100]
    fiveStep[ii] = position[-1]
    zeroArray = np.sort(position)
    while keepchecking == bool(1):
        zerocounter = 0
        for jj in range(len(zeroArray)):
            hitcounter = 0
            if distance(zeroArray[jj+counter], zeroArray[jj]) <= TOLERANCE:
               hitcounter +=1
            zerocounter += hitcounter
            counter +=1
            if hitcounter == 0:
                keepchecking = bool(0)
    zeroStep[ii] = zerocounter 
```

谢谢你的帮助，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:27:36.487

您可以将您的位置向量与自身进行直接比较：

```
deltas = np.abs(position[None, :] - position[:, None]) 
```

现在，是 step和 step`deltas[i, j]`位置之间的距离。你可以得到你的命中：`i``j`

```
hits = deltas <= TOLERANCE 
```

要获得成对的平仓头寸，您可以执行以下操作：

```
row, col = np.nonzero(hits)
idx = row < col # get rid of the diagonal and the upper triangular part
row = row[idx]
col = col[idx] 
```

举个例子：

```
>>> position = genPositions(NUM_STEPS, MAX_STEP_SIZE)
>>> row, col = np.nonzero(np.abs(position[None, :] -
...                              position[:, None]) < TOLERANCE)
>>> idx = row < col
>>> row= row[idx]
>>> col = col[idx]
>>> row
array([ 35,  40, 112, 162, 165, 166, 180, 182, 200, 233, 234, 252, 253,
       320, 323, 325, 354, 355, 385, 432, 443, 451], dtype=int64)
>>> col
array([ 64,  78, 115, 240, 392, 246, 334, 430, 463, 366, 413, 401, 315,
       380, 365, 348, 438, 435, 401, 483, 473, 492], dtype=int64)

>>> for j in xrange(len(row)) :
...     print '{0}, {1} --> {2}, {3}'.format(row[j], col[j], position[row[j]],
...                                          position[col[j]]) 
... 
35, 64 --> 2.56179226445, 2.56275159205
40, 78 --> 2.97310455111, 2.97247314695
112, 115 --> 3.40413767436, 3.40420856824
...
432, 483 --> 10.2560778101, 10.2556475598
443, 473 --> 10.7463713139, 10.7460626764
451, 492 --> 12.3804383241, 12.3805940238 
```

# php - php array_search 查找索引值

> ID：15536330
> 
> 赞同：0
> 
> 时间：2013-03-20T22:54:38.393
> 
> 标签：php

我有 2 个数组`$userArray`和`$differentArray`.

**问题：**我正在尝试从匹配的`$userArray`位置查找索引值，以便我可以提取名字/姓氏`$userId``$differentArray`

`print_r`$userArray 的输出如下：

```
 Array
    (
        [0] => Array
            (
                [userId] => ID Object
                    (
                        [_unknown:protected] => 
                        [id_:protected] => 8k6Y4FTrnxKY45XrVkXvVJhL
                    )
                [firstName] => Joe
                [lastName] => Smith
            )

        [2] => Array
            (
                [userId] => ID Object
                    (
                        [_unknown:protected] => 
                        [id_:protected] => pCvR9qvIgGv8WyejcKmRtGD8
                    )
                [firstName] => Sue
                [lastName] => Miller
            )

    ) 
```

`print_r`$differentArray 的输出如下：

```
 Array
    (
            [0] => Array
                    (
                            [date] => 1363800434868
                            [userId] => ID Object
                                    (
                                            [_unknown:protected] => 
                                            [id_:protected] => 8k6Y4FTrnxKY45XrVkXvVJhL
                                    )

                            [someTxt] => aaaa
                    )

            [1] => Array
                    (
                            [date] => 1363800858828
                            [userId] => ID Object
                                    (
                                            [_unknown:protected] => 
                                            [id_:protected] => 8k6Y4FTrnxKY45XrVkXvVJhL
                                    )

                            [someTxt] => cccc
                    )

            [2] => Array
                    (
                            [date] => 1363817564430
                            [userId] => ID Object
                                    (
                                            [_unknown:protected] => 
                                            [id_:protected] => pCvR9qvIgGv8WyejcKmRtGD8
                                    )

                            [someTxt] => ccc
                    )
    ) 
```

**这是我的尝试，但它只输出 Joe Smith
*** `$differentArray`的构造方式与`$userArray`

```
 $i = 0;
    while ($i < count($differentArray)){
        $userId = $differentArray[$i]['userId'];
        $key = array_search( $userId, $userArray );
        $firstName = $userArray[$key]['firstName'];
        $lastName = $userArray[$key]['lastName'];
         $i++;
    } 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:17:40.590

伙计，使用`foreach`。

```
$i = 0;
while ($i < $total) {
    $userId = $differentArray[$i]['userId'];
    // $key = array_search($userId, $userArray);
    foreach ($userArray as $k => $user) {
        if($user["userId"] == $userId){
            $key = $k;
            break; // avoid useless loop
        }
    }
    $firstName = $userArray[$key]['firstName'];
    $lastName = $userArray[$key]['lastName'];
    $i++;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:18:20.373

我不确定那个 ID 对象是什么，但我假设它有一个返回 id 属性的 __toString 方法。

```
$output = array();
foreach ($differentArray as $user) {
    foreach ($userArray as $searchedUser) {
        if ($searchedUser['userId'] == $user['userId']) {
            $output[] = $searchedUser;
        }
    }
} 
```

这会将您要查找的用户放入 $output 数组中。这样你就不再需要索引了。您可以迭代 $output 以将值提取到变量中。例如。

```
foreach ($output as $user) {
    list($userId, $firstName, $lastName) = $user;
    // do your code here
} 
```

如果您确定 $userArray 中只能有一个匹配项，那么您可以在找到它时从循环中跳出或从 $output 数组中拉出第一个匹配项。

我做了很多猜测发布该答案，因为您没有提供 $differentArray 结构，也没有指定您实际期望的内容。

# ruby - 在 Ruby 方法中编写括号的正确方法？

> ID：15536332
> 
> 赞同：1
> 
> 时间：2013-03-20T22:54:40.713
> 
> 标签：ruby, coding-style

在 Ruby 方法中编写括号的“可接受”或“正确”方式是什么？

喜欢：

```
puts doc.instance_of?( self.class.superclass.class ) 
```

或者：

```
puts doc.instance_of? ( self.class.superclass.class ) 
```

或者：

```
puts doc.instance_of? (self.class.superclass.class) 
```

或者：

```
puts doc.instance_of?(self.class.superclass.class) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T22:57:43.900

2 和 3 是错误的（请参阅@muistooshort 的评论）。

在 1 到 4 之间，只需选择一个风格指南并坚持下去。一致性是最重要的。我对推荐 1 的这个很满意，并且个人觉得它看起来更干净：

[https://github.com/styleguide/ruby](https://github.com/styleguide/ruby)

这是一个使用可选第二个参数的方法打破 2 的示例：

```
def f(x, y=1) x + y end

f(1,2) # 3

f(1) # 2

f (1, 2) # syntax error

f (1), 2 # 3! 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-20T23:04:09.303

您甚至可以在 Ruby 中省略括号，就像您`puts`在所有示例中都省略了它们一样。这是“常用方式”，除非您有复杂的表达式或优先级问题。

```
puts doc.instance_of? self.class.superclass.class 
```

# opengl - 无论opengl中的视口大小如何，都保持正方形裁剪体积正方形？

> ID：15536333
> 
> 赞同：1
> 
> 时间：2013-03-20T22:54:49.900
> 
> 标签：opengl

我正在阅读 OpenGL SuperBible 第 4 版。有一个描述，在一个又高又薄的窗口中，如果视口与窗口的尺寸匹配，但它被映射到一个方形的裁剪体积，图像将显得扭曲（像视口一样高而薄）。

保持图像正方形的解决方案是以下代码：

```
// Establish clipping volume (left, right, bottom, top, near, far) 
aspectRatio = (GLfloat)w / (GLfloat)h; 
if (w <= h)       
    glOrtho (-100.0, 100.0, -100 / aspectRatio, 100.0 / aspectRatio, 1.0, -1.0);
else       
    glOrtho (-100.0 * aspectRatio, 100.0 * aspectRatio, -100.0, 100.0, 1.0, -1.0); 
```

这段代码有一个解释，但我就是无法理解。为什么我们要根据 aspectRatio 来扩展裁剪体积的高度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:26:10.037

OpenGL 中有两个纵横比需要注意：

1.  *viewport*的纵横比，在调用时指定`glViewport`
2.  视*锥体*的纵横比，通过投影变换指定，无论是正交（例如，由 设置`glOrtho`）还是透视（由 设置`glFrustum`，或`gluPerspective`最常见）。

现在，为了保持正方形渲染为正方形，两个纵横比需要匹配。当您调整窗口大小时，您通过调用隐式设置视口的纵横比`glViewport( 0, 0, width, height );`

指定投影变换的纵横比是显式的，就像调用 时一样`gluPerspective`，因为它的第二个参数是视锥体的纵横比。`glOrtho`但是，对于或之类的调用`glFrustum`，视锥体的纵横比由查看体积的宽度和高度控制。以您提到的正交情况为例（对于透视投影，同样的讨论也适用），此处查看体积的宽度**right-left**，同样，高度是**top-bottom**，这两个量的比率是查看体积的纵横比.

现在，请记住我们需要两个纵横比来匹配。我们不太可能修改视口，因为通常情况下您想使用窗口中的所有像素，或者不冒被裁剪对象的风险，因此我们被迫修改查看体积的纵横比以获得它们匹配。我们通过根据视口的纵横比修改查看体积的宽度或高度来做到这一点，这就是您在提供的代码中看到的内容。特别是，如果视口的纵横比大于 1.0（即宽大于高），那么我们需要让我们的可视体积更宽，这就是为什么我们将**左右****相乘****通过纵横比。同样，如果视口的纵横比小于 1.0，我们需要将查看体积调高。在这种情况下，我们使用纵横比的倒数（将大于 1.0），为**top**和**bottom**提供适当的缩放。**

# php - PHP 时区转换/PHP 日期未显示正确的时区

> ID：15536334
> 
> 赞同：2
> 
> 时间：2013-03-20T22:54:49.910
> 
> 标签：php, datetime, strtotime

我的服务器和 MySQL 数据库的默认时区设置为 GMT。我的 PHP 代码将显示的日期转换为用户的本地时区（在本例中为东部时区）：

```
$OPENED_DATE = '2013-03-20 21:05:00'
$OPENED_DATE = new DateTime($OPENED_DATE);
$OPENED_DATE->setTimeZone(new DateTimeZone('America/New_York')); 
```

然后我为用户输出日期：

```
$OPENED_DATE = strtotime($OPENED_DATE->format('Y-m-d H:i:s'));      
$OPENED_DATE = date('F j, Y g:i A T', $OPENED_DATE); 
```

$OPENED_DATE 的输出：格林威治标准时间 2013 年 3 月 20 日下午 5:05

实际时间显示正确，但日期输出中的“T”仍显示 GMT。有没有办法让它显示我们转换到的时区，而不是默认的 GMT。我知道这样做的唯一方法是使用`date_default_timezone_set`每次切换到用户的时区，然后切换回 GMT。但我觉得必须有一个更有效的方法......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:58:58.190

这两行是多余的

```
$OPENED_DATE = strtotime($OPENED_DATE->format('Y-m-d H:i:s'));      
$OPENED_DATE = date('F j, Y g:i A T', $OPENED_DATE); 
```

`date()`这是输出错误时区的调用。

为什么不试试：

```
$OPENED_DATE = $OPENED_DATE->format('F j, Y g:i A T'); 
```

该`DateTime`对象中设置了时区，但是一旦将其转换为时间戳并使用`date()`，服务器时区将用于该时间。我认为仅使用 DateTime 对象来格式化日期就足以满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:00:07.993

由于您仅将时区设置应用于您的`$OPENED_DATE`变量，因此`strtotime()`和`date()`函数不会收到相同的时区信息。

您仅从`$OPENED_DATE`to传递年/月/日/小时/分钟/部分`strtotime()`，因此无法获取时区信息。

现在，您*可以*做的是设置用于函数的默认时区`strtotime()`，`date()`以及使用`date_default_timezone_set()`.

但是，这仍然很麻烦，您不需要这样做，因为已经有一个 DateTime 对象，您不妨继续使用它。

DateTime 对象将让您直接输出格式化的时间：

```
$OPENED_DATE->format('F j, Y g:i A T'); 
```

因此完全跳过`strtotime()`and`date()`步骤。

# haskell - 文件夹问题（Haskell）

> ID：15536335
> 
> 赞同：1
> 
> 时间：2013-03-20T22:54:51.243
> 
> 标签：haskell, fold

我正在尝试从类型的表转换为`([Char, Int])`字符串`tab2str :: Table -> String`（遵循一些特定的格式模式。）

我正在使用 foldr（正如标题所暗示的那样），但我在让确切的功能正常工作时遇到了一些问题 - 即它错误。我的功能如下所示：

`tab2str xs = foldr (++) ' ' $ map (\char count -> show char ++ ':' ++ show count ++ '\n') xs`

输出应该是表中的每个字母，一个冒号，然后是`\n`. 所以一个测试可能是：

`tab2str test1 == "F: 1\no: 1\nl: 1\nd: 1\nr: 1\n"`

在哪里 `test1 == [(F, 1), (o, 1), (l, 1), (d, 1), (r, 1)]`

感激地收到任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T22:57:55.037

经过最少的更正后，此类型检查：

```
tab2str xs = foldr (++) " " $ map (\(char, count) -> show char ++ ":" ++ show count ++ "\n") xs 
```

- 但产生的并不完全是你想要的。

你可能会更喜欢这个：

```
tab2str table = concat $ map formatRow table
    where formatRow (char, count) = [char] ++ ": " ++ show count ++ "\n" 
```

然后你的测试示例：

```
ghci> let test1 = [('F', 1), ('o', 1), ('l', 1), ('d', 1), ('r', 1)]
ghci> tab2str test1
"F: 1\no: 1\nl: 1\nd: 1\nr: 1\n"
ghci> putStr $ tab2str test1
F: 1
o: 1
l: 1
d: 1
r: 1
ghci> 
```

# openerp - Openerp 6.1 将产品类别放入销售订单行

> ID：15536346
> 
> 赞同：0
> 
> 时间：2013-03-20T22:55:45.483
> 
> 标签：openerp

我想使用我编写的以下代码在销售订单的 sale.order.line.tree 视图中显示产品类别。它显示了 group by 按钮下的类别按钮，但是单击它时，出现以下错误，我不知道如何解决该错误：`assert groupby_def and groupby_def._classic_write, "Fields in 'groupby' must be regular database-persisted fields (no function or related fields), or function fields with store=True" AssertionError: Fields in 'groupby' must be regular database-persisted fields (no function or related fields), or function fields with store=True`

这是我的代码：

```
from osv import fields, osv<code>
class sales_order_line_category(osv.osv):
_name='sale.order.line'
_inherit='sale.order.line'
_columns={'categ_id': fields.related('product_id', 'categ_id', type='many2one', relation='product.categ_id'),

} 
```

sales_order_line_category()

我的观点：

```
`<?xml version="1.0" encoding="utf-8"?> 
```

```
<record id="view_sale_orderlinecategory" model="ir.ui.view">
        <field name="name">sale.order.line.categoryinherit</field>
        <field name="model">sale.order.line</field>
        <field name="type">tree</field>
        <field name="inherit_id" ref="sale.view_order_line_tree"/>
        <field name="arch" type="xml">
            <field name="name" position="after">
                        <field name="categ_id" string="Category"/>
            </field>            
        </field>    

    </record>

    <record id="view_sale_orderlinecategory2" model="ir.ui.view">
        <field name="name">sale.order.line.categoryinherit2</field>
        <field name="model">sale.order.line</field>
        <field name="type">search</field>
        <field name="inherit_id" ref="sale.view_sales_order_uninvoiced_line_filter"/>
        <field name="arch" type="xml">

    <group expand="0" string="Group By..." >
                <filter string="Category of Product" icon="terp-stock_symbol-selection" name="Category"                     context="{'group_by':'categ_id'}"/>
            </group>

        </field> 
    </record>

     <record id="view_sale_orderlinecategory3" model="ir.ui.view">
        <field name="name">sale.order.line.categoryinherit3</field>
        <field name="model">sale.order,line</field>
        <field name="type">search</field>
        <field name="inherit_id" ref="sale.view_sales_order_uninvoiced_line_filter"/>
        <field name="arch" type="xml">

            <field name="name" position="before">
                        <field name="categ_id" string="Category"/>
                        </field>

        </field> 
    </record>

</data> 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T05:26:29.110

请您尝试使用以下代码替换吗？

```
'categ_id': fields.related('product_id', 'categ_id', type='many2one', relation='product.category', store=True), 
```

检查您的字段 categ_id 是否必须出现在您尝试按 categ_id 分组的 sale.order.line 的树视图中

希望这有帮助

# php - JQuery 将页面加载到 div 并 onload 更改第二个 div 的内容

> ID：15536348
> 
> 赞同：0
> 
> 时间：2013-03-20T22:55:57.823
> 
> 标签：php, jquery

我有一个包含 2 个 div 的页面，一个称为菜单，另一个称为内容。内容 div 加载登录页面。当用户尝试登录时，我将脚本调用到内容 div 中，如果不成功，它会重新加载登录页面。

如果成功，我使用标题位置重定向到登录页面。当此页面加载到内容 div 中时，我需要将菜单 div 更改为不同的菜单。我尝试使用以下方法，但无济于事。有没有什么办法可以在成功页面加载到内容 div 时自动改变菜单 div 的内容

这是我在已加载到内容 div 的登录页面中尝试过的，该页面的正文标签具有

> onLoad="$('div#menu').load('Includes/logged-menu-page.php')"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:59:20.993

该`.load()`函数的第二个参数是一个回调函数。您可以使用它来验证它是否正确加载，然后编辑您的菜单元素：

```
$('#result').load('Includes/logged-menu-page.php', function() {
  if(loaded_correctly)
      $("div#menu").html("OtherMenu");
  else
      $("div#menu").html("LoginMenu");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T01:08:37.550

您需要更改调用加载函数的项目：

`$('div#menu').load('Includes/logged-menu-page.php')`

应该

```
$('div#content').load(function() {
 // load your stuff to your menu div
 // you would probably need to make an ajax call or something here
}); 
```

我认为这就是你想要做的，但我不确定你`logged-menu-page.php`从你的问题中得到了什么信息

# drupal - 谷歌机器人索引站点 ip 和域

> ID：15536356
> 
> 赞同：0
> 
> 时间：2013-03-20T22:56:43.627
> 
> 标签：drupal, redirect, drupal-6, ip, googlebot

谷歌同时索引我的站点 ip 和域是一件奇怪的事情。我读了很多关于这个的想法，但我找不到任何令人满意的答案。我对此有两个问题：

1-如何将我的索引 ip 页面重定向到域？例子：

```
http://myip/testpage.html               to
http://www.mydomain.com/testpage.html 
```

2- 对 seo 不利并且会导致内容重复吗？如果我修复它会对我的 seo 产生积极的影响吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T08:46:01.077

1.  这只是服务器配置问题。如果您在 apache 上，您可以[将 IP 地址重定向到域名](https://stackoverflow.com/questions/6880903/redirect-ip-address-to-domain-name)

2.  简短的回答是的。重复内容是不好的生意，因为搜索引擎不会显示重复内容，并且必须确定哪个版本是原始版本。有一篇非常好的文章详细介绍了这个主题：[什么是重复内容？](http://www.seomoz.org/learn-seo/duplicate-content)

# dynamics-crm-2011 - 允许附加文件但不允许编辑注释文本

> ID：15536361
> 
> 赞同：2
> 
> 时间：2013-03-20T22:57:03.077
> 
> 标签：dynamics-crm-2011

我有保护系统中注释文本完整性的基本需求；具体来说，一旦创建了注释，则任何 CSR 都不应对其进行编辑（可能是更高级别）。理想情况下，它一旦创建就应该是不可变的，但如果有必要，我将允许创建它的 CSR 对其进行编辑；最重要的是没有其他人应该拥有这种访问权限。

启用此功能的基本角色权限是 Note 实体的写入权限。通过将此设置为“无访问权限”但仍授予对创建和附加的访问权限，用户仍然可以在任何实体上编写新的注释，他们可以从注释作为子网格存在的表单中“附加到”，但他们不能编辑任何现有的注释.

然而，这有两个问题。首先，我丢失了功能区中的“添加新注释”按钮。没什么大不了的，但它确实迫使用户使用子网格的内联编辑器添加注释。更大的问题是我丢失了附加文件按钮。CSR 仍然需要能够附加文件，即使他们一旦创建便无法编辑注释。

有没有办法做我需要的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:28:47.003

如果它只是您正在寻找的 GUI 保护，您可以简单地将该字段设置为在加载脚本中不可编辑。

# video - 使用 mencoder 从照片中获取视频？

> ID：15536362
> 
> 赞同：5
> 
> 时间：2013-03-20T22:57:09.233
> 
> 标签：video, mencoder

白天，我每分钟都用相机拍照。我想**从图像中制作视频**。1 天 -> 1 个视频

我在一天结束时使用 mencoder 这样做： `mencoder "mf://*.jpg" -mf fps=25:type=jpg -ovc lavc -lavcopts vcodec=mpeg4:mbd=2:trell:vbitrate=7000 -vf scale=1024:768 -oac copy -o movie.avi` 它工作正常，但是：

问题是我需要在 Raspberry Pi（700MHz ARM）上进行，他需要大约一个小时才能从白天拍摄的 1500 张照片中制作视频（它的工作速度约为 0.5 fps）。

**有什么方法可以“连续”制作视频 - 如何在拍摄后立即将每张图片传递给 mencoder - 并在每天午夜停止制作视频？**然后它会拍照，处理 2-3 秒，然后再等一分钟再做一次。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-21T13:00:09.633

您为什么不每隔一小时左右从图片中制作一个视频，然后将其与您现有的视频合并？

合并视频：

```
mencoder -oac copy -ovc copy -idx -o daily.avi this_hour.avi 
```

您每隔一小时左右执行一次，然后在一天结束时，您`daily.avi`将合并所有图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T12:09:12.150

这不提供答案`mencoder`，但`ffmpeg`在评论中允许。

**要求：**

*   所有图片必须连续编号（即picName1.png、picName2.png等）
*   所有图片必须在同一个文件夹中。
*   由于最近更改了选项，因此您必须拥有最新版本的 ffmpeg

**要创建您的视频，请使用：**

```
ffmpeg -r fps -f image2 -i '/path/to/your/picName%d.png' -qscale 0 '/path/to/your/new/video.avi' 
```

*   将**fps**替换为所需的帧速率（10、25、30 等）fps。
*   用实际路径替换**/path/to/your/picName**，但留下 **%d**告诉 ffmpeg 在那里放一个数字。
*   将**/path/to/your/new/video.avi**替换 为您选择的目的地。

*以这种方式创建的视频将具有最高质量。`-q`您可以使用该选项调整质量以匹配您的视频大小要求。*

有关更多解释，请参见[ffmpeg 的手册页。](http://linux.die.net/man/1/ffmpeg)

不幸的是，据我所知，没有办法每隔几分钟左右传递一张照片。我建议以下解决方案之一：

*   每天午夜编译一次视频。你在凌晨 1 点收到它。
*   每天编译几次视频，如果你需要看的话。这是很多浪费的处理，因为您每次都处理整个批次。
*   按块编译视频（例如每 2 小时）并在一天结束时合并所有视频。

如果白天不需要看视频，那么第一种方案是最简单的。

* * *

**以下是手册页的引用：**

> **从许多图像创建视频：**
> 
> ffmpeg -f image2 -i foo-%03d.jpeg -r 12 -s WxH foo.avi 语法“foo-%03d.jpeg”指定使用由三个数字组成的十进制数用零填充来表示序列号。它与 C printf 函数支持的语法相同，但仅适用于接受普通整数的格式。

# php - 基于表单选择的 PHP 列表：MDB2 错误：语法错误

> ID：15536365
> 
> 赞同：0
> 
> 时间：2013-03-20T22:57:32.850
> 
> 标签：php, mdb2

我正在创建一个表格，该表格根据表单选择输出国家/地区详细信息列表，但我不断收到此错误：`MDB2 Error: syntax error`. 如何修复此类错误？

这是我的代码：

```
<?php
    $db =& MDB2::connect($dsn); 
    if(PEAR::isError($db)){ 
        die($db->getMessage());
    }
    $table_name="country";
    $db->setFetchMode(MDB2_FETCHMODE_ASSOC);

    $country_id = mysql_real_escape_string($_GET["country_id"]);

    // collect values from a form sent with method=get
    $gdp = mysql_real_escape_string($_GET["gdp"]);
    $population = mysql_real_escape_string($_GET["population"]);
    $country_name = mysql_real_escape_string($_GET["country_name"]);
    $gold = mysql_real_escape_string($_GET["gold"]);
    $bronze = mysql_real_escape_string($_GET["bronze"]);
    $silver = mysql_real_escape_string($_GET["silver"]);
    $total = mysql_real_escape_string($_GET["total"]);

    $sql = "SELECT * FROM $country WHERE country_id='$country_id'";

    $res =& $db->query($sql);      //MDB2 Error: syntax error

    if (PEAR::isError($res)) {
        die($res->getMessage());    //error printed here
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:46:24.700

在您的行中，未定义`"SELECT * FROM $country WHERE country_id='$country_id'"`变量，因此它将呈现为 eg ，因此出现 SQL 错误。`$country``"SELECT * FROM WHERE country_id='1'"`

看起来你的意思`$table_name`是*有价值* `'country'`的。

由于这似乎只定义了几行，因此直接在 SQL 语句中编写它可能更有意义，而不是有一个变量，但也许你以后有这个变量的计划......

# php - 网站的多语言支持

> ID：15536371
> 
> 赞同：-1
> 
> 时间：2013-03-20T22:57:48.393
> 
> 标签：php, jquery, html

我正在为我为一家公司开发的网站使用 HTML/PHP/jQuery。他已请求为他的网站添加多语言支持。

我只是想找出实现这一目标的最佳方法（或最佳实践方法），因为我确信有很多不同的方法可以做到这一点。

我找到了一个有教程的网站；[点击这里](http://www.bitrepository.com/php-how-to-add-multi-language-support-to-a-website.html)

这将 PHP 与会话一起使用。

这是一个很好的方法还是有更好的方法？

顺便说一句，该公司的网站有 30 页，每页大约 200-300 个字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:02:04.117

我个人不会使用 url 查询字符串参数，我更喜欢它作为 URL 的一部分更简洁，例如：

[http://en.example.com/](http://en.example.com/)

或者

[http://www.example.com/en/](http://www.example.com/en/)

然后除此之外，我倾向于使用`gettext`我认为 PHP 支持的 UNIX 风格的翻译 - [http://php.net/manual/en/function.gettext.php](http://php.net/manual/en/function.gettext.php)。

当你接触到 JavaScript 方面时，这有点痛苦，但它有类似的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:02:52.210

是的，这是在`php`应用程序中声明本地化资源的一种方式。`Key/Value`基本上，正如这表明您需要在您正在本地化的资源和特定语言环境字符串之间创建配对的对象的奇偶校验。

如果您想使用 pure 执行此操作`JavaScript`，则几乎相同。`JavaScript`您需要在不同的语言环境文件中声明对象，例如`locale-en.js`, `locale-de.js`,`locale-fr.js`等。这是针对由您`JavaScript`而不是您的代码服务器端交付的特定语言环境字符串完成的。这些文件包含的内容大致如下：

**语言环境-en.js**

```
myApplication = myApplication || {};

myApplication.locale = {
    title: "English title",
    body: "English body",
    // Etc.
}; 
```

其余文件包含完全相同的对象，但具有不同语言的字符串。然后在客户端代码中引用这些字符串是这样的：

```
<script type="text/javascript" src="locale-*language*.js"></script>
<script type="text/javascript">
    $('#title').text(myApplication.locale.title); //jQuery
    // Pure JavaScript
    document.getElementById('title').innerHTML = myApplication.locale.title;
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T23:21:33.000

以下是我的想法：

*   如果您最不关心 SEO/SEM，请不要使用 JavaScript 进行本地化
*   如果您使用任何类型的 CMS，则需要在数据库中分段内容，并通过 CMS 编辑相应的本地化字段
*   If you're not using a CMS, consider loading in a specific PHP/HTML snippet file for the content of each page, in each language
*   If you have a lot of localized strings, consider using `gettext()` and [Poedit](http://www.poedit.net/)

# php - 使用php中的作业处理大量数据

> ID：15536372
> 
> 赞同：0
> 
> 时间：2013-03-20T22:57:48.900
> 
> 标签：php, cron, jobs, data-processing

我们有一个网站，上面有“项目”，每个项目都有给定数量的人订阅。

在项目“结束”时，所有订阅者都被收集和处理。在这种情况下，大约有 1,000 个订阅者的数据需要被提取和处理。还有一些相关数据与每个数据集一起存储在一个数组中。

上次我们处理大订单时，大约 300 件商品，PHP 内存不足。我们提升了内存，它能够处理它。我不认为这次会是这样。

我们目前使用拉动项目的作业来处理订阅者。在此作业中，执行 SQL 查询以提取所有“订阅者”并将它们及其相关数据存储在数组中。然后迭代该数组以创建单独的作业来处理各个订阅者。

**我的问题是：**

有没有办法在“块”或其他东西中做到这一点？或者有什么更好的方法可以减少对记忆的影响？如果我们有成千上万的订阅者，我希望它可以扩展。

现在这是流程：

*   项目“结束”
*   作业开始设置一些标志，并拉动所有订阅者
*   循环来自 MySQL（订阅者）的数据数组，并为每个订阅者创建一个单独的作业。
*   每个订阅者作业都由引擎处理。

我只是很难确定执行此操作的最佳过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:05:19.493

我会使用按 int-key 排序的主 RS，并且只处理*一个*订阅者。

在部分作业结束时，保存已完成作业的 ID。如果您完成与否，在最终回显时，并有一个父脚本调用它：

在进程脚本的末尾添加一个睡眠以让其他玩家进入..

```
 while(file_get_contents('http://yourscript.php') != false); 
```

（不使用 include 会增加开销，但可以避免内存泄漏）

# html - 这个css声明是什么意思-一次两个声明

> ID：15536374
> 
> 赞同：1
> 
> 时间：2013-03-20T22:57:55.280
> 
> 标签：html, css

你能解释一下这种css声明吗：

```
.menu_blueSkin_Middle.dir_left div.align_left {
float: left;
 } 
```

据我所知，如果你有**.someName{}**这意味着它被放在了 html 元素类属性中。例如：

```
 <div class='someName'></div>. 
```

但是带来问题的例子有两个点。一个在开始，一个在中间。然后还有空格和另一个声明div.align_left？

请给我一些解释！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:59:38.790

两个点表示两个类——那些特定的 CSS 规则只有在元素同时具有这两个类时才会生效。

这两个类都需要出现在您的外部 div 上：

```
.menu_blueSkin_Middle .dir_left 
```

虽然您在内部 div 上的类应该包含一个带有该类的 div（它可以有多个，但至少有以下几个）：

```
.align_left 
```

因此它应该看起来像这样：

```
<div class="menu_blueSkin_Middle dir_left"> <!-- Outer div class selectors -->
    <div class="align_left"></div> <!-- Inner div class selector -->
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:59:47.737

这意味着元素必须具有两个类才能匹配规则。

```
<div class="menu_blueSkin_Middle dir_left">
    <div class="align_left"></div>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T23:02:46.397

div.align_left 是一个后代选择器。这意味着只应用（选择）嵌套在 menu_blueskin_Middle.dor_left 元素中的 div.align_left 的 DOM 元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T23:04:22.073

一个元素的属性中可以有多个类名`class`，两个类名放在一起的选择器意味着该元素需要两个类名才能匹配选择器。

例如，选择器将匹配`div`此代码中的内部：

```
<div class="menu_blueSkin_Middle dir_left">
  <div class="align_left"></div>
</div> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-20T23:05:42.093

它将包含的规则应用于分配了两个类的元素。

[这是一个示例](http://jsfiddle.net/uM4TR/)

```
<html>
  <style>
    .one { color: green; }
    .two { color:red; }
    .one.two { color:blue; }
  </style>
  <div class="one">I'll be Green</div>
  <div class="two">I'll be Red</div>
  <div class="one two">I'll be Blue</div>
</html> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-20T23:55:18.200

```
.menu_blueSkin_Middle.dir_left div.align_left 
```

这里调用了三个类。

这有点复杂，因为命名这些课程的人都是业余爱好者。您永远不应将类命名为与 css 代码相同的名称。

为了更容易理解，让我们重命名显示的三个类：

*   **menu_blueSkin_Middle**我们将重命名为**.firstclass**

*   **dir_left**我们将重命名为**.secondclass**

*   **.align_left**我们将重命名为**.thirdclass**

* * *

好的，现在有了三个重命名的类，让我们向您展示代码：

```
.firstclass.secondclass div.thirdclass {
     float: left;
} 
```

* * *

好的，以下适用：

*   .thirdclass 是唯一受到影响的 [with float:left; 代码]。
*   只有 div 中的 .thirdclass 类会受到影响。（由于 div 位于它之前）
*   只有位于同时声明 .secondclass 和 .firstclass 的类中的 .thirdclass div 会受到影响。

示例代码：

```
<div class="firstclass secondclass">
    <p class="thirdclass">
    </p>
       <!-- NOTE: THIS IS JUST A NOTE SO YOU KNOW WHICH IS AFFECTED.
            The DIV below is the **only one affected**. The P above is NOT affected. Because it is not a DIV.
            The DIV at the bottom is NOT affected. Because it is not nested inside the firstclass secondclass 
       -->
    <div class="thirdclass">
    </div>
</div>
<div class="thirdclass">
</div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-20T23:01:27.207

```
.menu_blueSkin_Middle.dir_left div.align_left 
```

方法

具有类 menu_blueSkin_Middle 和类 dir_left 的任何元素，其子元素是具有类 align_left 的 div 标签

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-20T23:06:43.927

这称为双类选择器。它将应用于具有两个类的元素，如下面的一个

```
<div class="menu_blueSkin_Middle dir_left">...</div> 
```

您可以加入任意数量的 ID 和类选择器，例如 .class1#identifier.class2.class3 等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-20T23:09:51.980

关于什么的很多答案，但为什么呢？

```
.menu_blueSkin_Middle.dir_left div.align_left {
float: left;
 } 
```

有时您希望具有更多的特异性（将其读取为更高的优先级并添加两个类（类之间没有空格）-在这里您确实有多个，这增加了应用此 CSS 的可能性。所以具有这些多个的元素类获得特异性。

尝试在“css 选择器多个类”上搜索 google/bing

# xcode - 在 Xcode 上包含来自添加框架的标头

> ID：15536379
> 
> 赞同：39
> 
> 时间：2013-03-20T22:58:16.710
> 
> 标签：xcode, macos, frameworks, glew, cg

我想使用一些框架`glew`，`cg`所以我手动添加了

通过右键单击项目 - >将文件添加到我的项目所需的框架...

并选择正确的框架。问题是，当我尝试包含头文件时，

Xcode 找不到它们中的任何一个。我希望这张图片能帮助理解：

![在此处输入图像描述](../Images/f5cc28eebfb1c6b56e8bc9e358dc2895.png)

和：

![在此处输入图像描述](../Images/37738b4d79d7ccabc90b23a6091ebffa.png)

给出的错误是针对`glew`框架的，但它也发生在`Cg`.

正如您在左侧看到的，添加了所需的框架。

关于如何包含这些标题的任何想法？

尝试手动添加头文件后，出现架构错误：

![在此处输入图像描述](../Images/da2f8eb4a3b8058b8339c28ce1db03b4.png)

我不知道这是否应该是这样的。谢谢！

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2013-03-20T23:01:10.630

在开始之前，删除框架和您在尝试使其工作时添加的所有文件。

然后，您必须在`Build Phases`目标中添加框架。然后进入`Link Binary With Libraries`并从那里选择您的框架。

这应该这样做。您的标题应该在每个之后作为自动完成可用`#import directive.` 如果它不起作用（有时会发生），我可以为您提供额外的步骤。

**附加步骤：**

转到您的项目设置，在构建设置中：

*   `Framework Search Paths`用你的框架的路径完成
*   做同样的事情`User Header Search Path`

然后，它应该工作。如果没有，您将需要在`#import`指令中添加标题的完整路径。例子：

`#import "/path/to/my/header.h"`

* * *

[此处提供](https://developer.apple.com/library/ios/#recipes/xcode_help-project_editor/Articles/AddingaLibrarytoaTarget.html%23//apple_ref/doc/uid/TP40010155-CH17-SW1)的 Apple 文档指出：

1.  在项目导航器中，选择您的项目
2.  选择你的目标
3.  选择“构建阶段”选项卡
4.  打开“使用库链接二进制文件”扩展器
5.  点击“+”按钮
6.  选择你的框架
7.  （可选）将添加的框架拖放到“框架”组

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-03-28T21:35:02.600

在我的情况下，我添加`Framework Search Paths`了 Target，但它应该添加到`Project`

![在此处输入图像描述](../Images/5ae77a11edcf7e4036e6db0a2d999873.png)

也`Always Search Users Path`应该是`yes`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-24T09:22:24.117

**对于那些在添加框架后自动完成失败的人。**

我过去常常通过选择`Build Phases`并`Link Binary with Libraries`选择来添加框架。现在在 XCode 6.1 中，虽然项目构建良好，但 XCode 中的自动完成功能不起作用。

所以需要做的是：

1.  从中删除已经添加的框架`Project Navigator`，也从`Link Binary with Libraries`.
2.  通过XCode 中的简单`File`->选项将框架添加到项目中。`Add Files to`

自动完成将开始工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-01-12T14:53:31.763

在我的情况下，外部框架已随 Windows 一起下载并添加到项目中。然后它被转移到 OSX，在那里构建了 Xcode 项目并且外部框架没有正确加载。我猜这是因为 Windows 将框架文件夹更改为常规文件夹，然后 OSX 遇到了麻烦。

对我来说，解决方案是简单地使用 OSX 下载框架并将其拖到 XCode 项目中的框架文件夹中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-12T09:42:39.720

就我而言，我必须更新框架版本，所以我只是替换了文件系统中的 .framework ，然后我得到了你在问题中提到的错误。

删除框架并重新添加它，使用搜索路径和所有其他建议都没有帮助。

最终，清理构建文件夹起到了作用：

**从 xcode 菜单中选择“产品”，按住选项键并单击：“清理构建文件夹”。**

之后，我成功构建并运行了该项目。

# ruby-on-rails - rake assets：预编译失败

> ID：15536380
> 
> 赞同：0
> 
> 时间：2013-03-20T22:58:34.727
> 
> 标签：ruby-on-rails, rake, asset-pipeline, production

我有一个在开发中运行良好的 Rails 应用程序。我正在RubyMine中开发它，但我使用Webrick和sqlite3从终端测试和运行它（文件存储/运行在我通过OSX终端访问的Ubuntu工作站上）。该应用程序使用修改后的 Boostrap 模板，并且运行良好。现在我想尝试在生产模式下运行它。

这就是我所做的：Rails 版本是 3.2.11，我使用 rvm 1.8.1 和 ruby​​-1.9.2-p290

```
config.logger = Logger.new(STDOUT) in environment/production.rb
config.serve_static_assets = true in environment/production.rb
export RAILS_ENV=production
rake db:migrate (works fine)
rake assets:precompile --trace 
```

我收到以下错误：

```
peter@fshsweden:/var/www/prod/mackmyra2.dnsalias.com$ rake assets:precompile --trace
** Invoke assets:precompile (first_time)
** Execute assets:precompile
/home/peter/.rvm/rubies/ruby-1.9.2-p290/bin/ruby /home/peter/.rvm/gems/ruby-1.9.2-p290/bin/rake     assets:precompile:all RAILS_ENV=production RAILS_GROUPS=assets --trace
** Invoke assets:precompile:all (first_time)
** Execute assets:precompile:all
** Invoke assets:precompile:primary (first_time)
** Invoke assets:environment (first_time)
** Execute assets:environment
** Invoke environment (first_time)
** Execute environment
** Invoke tmp:cache:clear (first_time)
** Execute tmp:cache:clear
** Execute assets:precompile:primary
Compiled jquery.js  (2ms)  (pid 4521)
Compiled jquery_ujs.js  (0ms)  (pid 4521)
Compiled bootstrap.js  (0ms)  (pid 4521)
Compiled articles.js  (68ms)  (pid 4521)
Compiled lightbox.js  (0ms)  (pid 4521)
Compiled main.js  (0ms)  (pid 4521)
Compiled prettify.js  (0ms)  (pid 4521)
Compiled public.js  (1ms)  (pid 4521)
Compiled small_articles.js  (0ms)  (pid 4521)
Compiled application.js  (142ms)  (pid 4521)
Compiled application.css  (4744ms)  (pid 4521)
rake aborted!
/var/www/prod/mackmyra2.dnsalias.com/app/views/articles/_form.html.erb:6: syntax error, unexpected     ')'
... 'form-horizontal'} ) do |ff| ).to_s); _erbout.concat "\n"
...                               ^
/var/www/prod/mackmyra2.dnsalias.com/app/views/articles/_form.html.erb:45: syntax error, unexpected     keyword_ensure, expecting ')'
/var/www/prod/mackmyra2.dnsalias.com/app/views/articles/_form.html.erb:47: syntax error, unexpected     keyword_end, expecting ')'
  (in /var/www/prod/mackmyra2.dnsalias.com/app/views/articles/_form.html.erb)
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/tilt-1.3.3/lib/tilt/template.rb:209:in `instance_eval'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/tilt-1.3.3/lib/tilt/template.rb:209:in `evaluate_source'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/tilt-1.3.3/lib/tilt/template.rb:144:in `cached_evaluate'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/tilt-1.3.3/lib/tilt/template.rb:127:in `evaluate'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/tilt-1.3.3/lib/tilt/template.rb:76:in `render'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/context.rb:193:in `block in evaluate'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/context.rb:190:in `each'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/context.rb:190:in `evaluate'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/processed_asset.rb:12:in `initialize'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:249:in `new'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:249:in `block in build_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:270:in `circular_call_protection'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:248:in `build_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/index.rb:93:in `block in build_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/caching.rb:19:in     `cache_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/index.rb:92:in `build_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:169:in `find_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/index.rb:60:in `find_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/bundled_asset.rb:16:in `initialize'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:252:in `new'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:252:in     `build_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/index.rb:93:in `block in     build_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/caching.rb:19:in `cache_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/index.rb:92:in `build_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:169:in `find_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/index.rb:60:in `find_asset'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.11/lib/sprockets/static_compiler.rb:19:in `block in compile'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:219:in `block in each_logical_path'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:206:in `block (2 levels) in each_file'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:196:in `each'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:196:in `each_entry'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:204:in `block in each_file'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:203:in `each'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:203:in `each_file'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/sprockets-2.2.2/lib/sprockets/base.rb:217:in `each_logical_path'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.11/lib/sprockets/static_compiler.rb:18:in `compile'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.11/lib/sprockets/assets.rake:56:in `internal_precompile'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.11/lib/sprockets/assets.rake:70:in `block (3 levels) in <top (required)>'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:228:in `block in execute'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:166:in `block in invoke_with_call_chain'
/home/peter/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_with_call_chain'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.11/lib/sprockets/assets.rake:60:in `block (3 levels) in <top (required)>'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:228:in `block in execute'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:166:in `block in invoke_with_call_chain'
/home/peter/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:159:in     `invoke_with_call_chain'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:143:in `invoke_task'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:101:in `block (2 levels) in top_level'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:101:in `each'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:101:in `block in top_level'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:95:in `top_level'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:73:in `block in run'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/bin/rake:33:in `<top (required)>'
/home/peter/.rvm/gems/ruby-1.9.2-p290/bin/rake:23:in `load'
/home/peter/.rvm/gems/ruby-1.9.2-p290/bin/rake:23:in `<main>'
Tasks: TOP => assets:precompile:primary
rake aborted!
Command failed with status (1): [/home/peter/.rvm/rubies/ruby-1.9.2-p290/bi...]
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/file_utils.rb:53:in `block in     create_shell_runner'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/file_utils.rb:45:in `call'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/file_utils.rb:45:in `sh'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/file_utils_ext.rb:40:in `sh'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/file_utils.rb:80:in `ruby'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/file_utils_ext.rb:40:in `ruby'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.11/lib/sprockets/assets.rake:12:in     `ruby_rake_task'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.11/lib/sprockets/assets.rake:21:in `invoke_or_reboot_rake_task'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/actionpack-3.2.11/lib/sprockets/assets.rake:29:in `block (2 levels) in <top (required)>'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:228:in `block in execute'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:166:in `block in     invoke_with_call_chain'
/home/peter/.rvm/rubies/ruby-1.9.2-p290/lib/ruby/1.9.1/monitor.rb:201:in `mon_synchronize'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:159:in     `invoke_with_call_chain'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:143:in `invoke_task'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:101:in `block (2 levels) in top_level'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:101:in `each'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:101:in `block in top_level'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:95:in `top_level'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:73:in `block in run'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
/home/peter/.rvm/gems/ruby-1.9.2-p290/gems/rake-10.0.3/bin/rake:33:in `<top (required)>'
/home/peter/.rvm/gems/ruby-1.9.2-p290/bin/rake:23:in `load'
/home/peter/.rvm/gems/ruby-1.9.2-p290/bin/rake:23:in `<main>'
Tasks: TOP => assets:precompile 
```

现在，如果我在一个干净的 Rails 应用程序上执行上述操作，它就可以工作。但它在我认为有效的应用程序上失败了。你能指出什么是错的吗？

_form.rb 是带有 simple_form 调用的部分，没有什么特别的。

（此处仅显示两行以显示错误似乎发生的位置）

```
<%= yield :title %>
<%= simple_form_for(@article, :html => {:multipart => true, :class => 'form-horizontal'} ) do |ff| %> 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:32:03.213

好吧，这原来是我的一个傻瓜。几周前在解决其他一些资产问题时，我一直在摆弄（在 config/application.rb 中）

```
config.assets.paths << "#{Rails.root}/app/assets" 
```

并意外添加（我猜是在一些绝望的举动中）

```
config.assets.paths << "#{Rails.root}/app" 
```

这当然包括应用程序下的所有内容作为资产，这是非常错误的。

这个错误确实出现了，直到我不得不做一个 rake assets:precompile。因为我真的不知道该命令做了什么，所以我没有看到它正在尝试将视图 ERB 文件编译为资产。

找到这篇文章后： http: [//blog.55minutes.com/2012/02/untangling-the-rails-asset-pipeline-part-2-production/](http://blog.55minutes.com/2012/02/untangling-the-rails-asset-pipeline-part-2-production/)我意识到它错误地包含了视图文件，它必须是路径问题。

小错误但很难修复。Rails 标准的排序。

# java - I/O 不工作（复制文件，粘贴）

> ID：15536389
> 
> 赞同：0
> 
> 时间：2013-03-20T22:59:15.570
> 
> 标签：java, file-io

我试图让这段代码工作。这是一个基本的 I/O 系统，它复制一个文件并将其粘贴到具有所选名称的同一目录中。它应该很简单，但由于某种原因程序运行，它创建了第二个文件，但随后卡住了。Java 进程的 CPU 占用率约为 5%，并且文件从未完成。它只复制一些数据，然后我想它在某个地方陷入了无限循环。

我已经将我的代码与[Oracle 网站](http://docs.oracle.com/javase/tutorial/essential/io/bytestreams.html)上的字节流教程进行了比较。

额外：我只是要求它输出它正在读取的内容，并且它卡在读取 value 的无限循环中`255`。如果这有帮助。另外，我直接从 Oracle 网站编译了代码，它也做了同样的事情。

据我所知，这似乎是一致的。谁能告诉我我做错了什么？谢谢你。

（PS：我使用的是 Eclipse 4.2.0）。

这就是我复制文件的方法：

```
package fileIO;

import java.io.*;

import system.Debug;

public class fileUtil {

    public static void copyFileTo(String file2Copy, String file2Paste) {
        FileInputStream fin = null;
        FileOutputStream fout = null;

        try {
            fin = new FileInputStream(file2Copy);
            fout = new FileOutputStream(file2Paste);

            int aByte;
            while ((aByte = fin.read()) != -1) {
                fout.write(aByte);
            }
        } catch (FileNotFoundException e) {
            Debug.out("Error: File Not Found: " + file2Copy);
        } catch (IOException e) {
            Debug.out("Error: File IO Exception Copying: " + file2Copy);
        } catch (Exception e) {
            Debug.out("Error: General Exception Closing Streams:" + file2Copy);
        } finally {
            try {
                fin.close();
                fout.close();
            } catch (IOException e) {
                Debug.out("Error: File IO Exception Closing Streams: " + file2Copy);
            } catch (Exception e) {
                Debug.out("Error: General Exception Closing Streams:" + file2Copy);
            }
        }
    }
} 
```

在我的程序主类中，我运行这个：

```
fileUtil.copyFileTo("google.bmp", "google(1).bmp"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T11:50:01.510

尝试`fout.flush()`在关闭 OutputStream 之前执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T12:14:54.843

...或者不要发明麻烦重新发明轮子：使用经过验证的 Apache commons-io 中的[FileUtils.copyFile](http://commons.apache.org/proper/commons-io//javadocs/api-2.4/org/apache/commons/io/FileUtils.html#copyFile)，它可以在一行中完成。

（请注意：此评论并不像看起来那么无辜：`File.rename`在 Windows 共享上效果不佳 - commons-io*始终*是做这些事情的安全选择）

**编辑**

1.  Stackoverflow 不是“家庭作业”的好去处——或者你至少必须这么说。这并不是说你的问题不真实。您的目标不同：您想学习一些东西，我们希望以最少的维护使其可靠地工作。
2.  ...这引出了我的第二点：当你在职业生涯中时，永远不要再编程了。正如您所发现的，即使您让它工作，它也可能效率极低，错误处理错误等等。对于 IO 尤其如此，它**总是**比看起来更棘手。
3.  最后，既然我给了你一个在 Apache 2.0 许可下非常受信任的库的链接，也许你可以看看[源代码](http://www.jarvana.com/jarvana/view/commons-io/commons-io/2.1/commons-io-2.1-sources.jar!/org/apache/commons/io/FileUtils.java?format=ok)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T22:39:07.737

好的，所以我发现了发生了什么。是一个非常愚蠢的错误。

我会把我的骄傲放在一边，以防其他人有这个问题。这不是无限循环，只是使用 ByteStreams 进行复制需要 AGES。我期待从小图像文件中获得快速结果，但即使是小图像文件也需要很长时间才能复制。我让它运行了 30 秒，程序正常终止，我得到了我的图像副本。

感谢上帝，它已经解决了，我开始担心了。

# jquery - 如何在 asp.net 中从 web 服务中创建程序集

> ID：15536391
> 
> 赞同：0
> 
> 时间：2013-03-20T22:59:19.773
> 
> 标签：jquery, asp.net, web-services, compilation, getjson

我有一个包含机密信息（登录详细信息）的网络服务，所以我需要将它编译成程序集。在这里，我对这个过程有 2 个问题。

1.  我如何将 Web 服务编译成程序集。
2.  我如何在 Jquery 中调用 Web 服务，因为我使用下面的 getJSON 代码调用 Web 服务
    $.getJSON("http://[external domain]/[servicename].asmx", function () {... })
    所以一旦我编译了网络服务，我应该使用相同的语法来调用网络服务。

任何人都可以让我知道如何做上述事情。

# cron - 如何增加 cron 表达式

> ID：15536393
> 
> 赞同：1
> 
> 时间：2013-03-20T22:59:27.393
> 
> 标签：cron

我有一个 cron 计划的起点，我想在指定的时间间隔后创建一个新的 cron 表达式。

例如，我从 1 个作业的 cron 表达式开始为“0 0 12 * * ?”

我需要为第二个作业创建第二个 cron 表达式，间隔为 30 分钟。所以它变成：“0 30 12 * * ？” 像这样，我想不断增加并为不同的作业创建多个 cron 计划。

所以，

```
1st job - "0 0 12 * * ?"
2nd job - "0 30 12 * * ?"
3rd job - "0 0 13 * * ?"
4th job - "0 30 13 * * ?"
.
.
. 
```

有没有类似的东西：`(cron expression 1) + 30mins = another cron expression`？

# php - 如何使用时区以及如何将它们存储在 mysql 数据库中？

> ID：15536397
> 
> 赞同：0
> 
> 时间：2013-03-20T23:00:01.180
> 
> 标签：php, mysql, timezone

有人可以向我解释如何使用时区吗？我应该如何将时区存储在数据库中以及如何计算时间？

如何按时区对活动进行排序？

谢谢

# html - Internet Explorer 图片宽度和@font-face 问题

> ID：15536399
> 
> 赞同：0
> 
> 时间：2013-03-20T23:00:23.040
> 
> 标签：html, internet-explorer, font-face

好的，我在图像上设置 25% 的 IE 和宽度值时遇到问题。我怎样才能解决这个问题？

IE 9 的图像如下所示：

![IE9 显示错误！](../Images/f379bb50569b6c482aad1daee6973c5f.png)

这是它应该是什么样子的图像，以及它在所有其他浏览器中的外观：（Chrome、Opera、Firefox、Safari）：

![图片应该是怎样的！](../Images/d34b96735ddb57d8316cd7dd5fc9b7d3.png)

我为此使用的代码如下......

***HTML***：

```
<html>
    <head>
        <title>2013 Conference Test Page</title>
        <link rel="stylesheet" type="text/css" href="css/index.css" />
    </head>
<body>

<div class="header">
    <div style="width: 100%;">
        <img class='header_img' src='images/image1.jpg' />
        <img class='header_img' src='images/image2.jpg' />
        <img class='header_img' src='images/image3.jpg' />
        <img class='header_img' src='images/image4.jpg' />
    </div>
    <div class="header_text big_text"><div>SAVE THE DATE!</div><div style="margin-top: -.2em;">2013 OFN CONFERENCE</div>
    </div>
    <div class="header_text" style="margin-top: -.2em;">
        <p class="medium_text"><span style="padding-right: 15px;">October 15-18, 2013</span> &bull; <span style="padding-left: 15px;">Philadelphia, PA</span>
    </div>
    <div class="header_text">
        <p style="padding: 0px 10% 1.5em; line-height: 1.5em;">Join us for this year's conference at the Philadelphia Marriot Downtown, just steps away from historic sites, great cultural destinations, and Opportunity Finance Network's own headquarters!  Registration opens in August, 2013.</p>
    </div>
</div>

</body>
</html> 
```

***CSS***：

```
html,body
{
    margin:0 0 0 0;
    padding:0 0 0 0;
}

.header
{
    background-color: #049EAB;
    width: 100%;
}

@font-face {
    font-family: hnc_font;
    src: url('../fonts/hnc.eot');
    src: local('hnc_font'), url('../fonts/hnc.woff') format('woff'), url('../fonts/hnc.ttf') format('truetype'), url('../fonts/hnc.svg') format('svg');
    font-weight: normal;
}

.header_img
{
    width:25%;
    height:auto;
    float:left;
}

.header_text
{
    width: 100%;
    text-align: center;
    color: white;
}

.medium_text
{
    text-shadow: 1px 1px 2px black;
    font-size: 1.5em;
    font-family: hnc_font;
}

p
{
    font-family: Arial, Helvetica, Verdana, Tahoma;
}

.big_text
{
    text-shadow: 2px 2px 4px black;
    font-size: 5.5em;
    font-family: hnc_font;
} 
```

检测到的问题：

1.  顶部的 4 个图像没有拉伸到屏幕的宽度。TBH，这是图像正在缩小的非常奇怪的行为。每次显示时，他们似乎都将前一个图像的大小缩小了 25%，而不是屏幕的宽度。奇怪的！
2.  使用 @font-face 在 CSS 中嵌入字体甚至在 IE 中都不起作用。该字体是 Helvetica 衍生风格的字体。在第二张图片中看起来完全一样，但在 IE 9 或任何版本的 IE 中看起来都不正确。我正在使用 .eot 字体，但它似乎被 IE 忽略了（根据文档，它应该在 IE 浏览器中工作）。
3.  CSS3 text-shadow 属性不起作用，有没有办法让使用 IE 浏览器的用户获得这种效果？

我如何解决，至少，问题 1 和 2 与 IE？对于问题 #1：我应该改用桌子吗？这是唯一的方法吗？

***编辑***

我对代码进行了以下更改：

HTML：

```
<div style="width: 100%; overflow: hidden;">
    <div class="image"><img class='header_img' src='images/image1.jpg' alt="" /></div>
    <div class="image"><img class='header_img' src='images/image2.jpg' alt="" /></div>
    <div class="image"><img class='header_img' src='images/image3.jpg' alt="" /></div>
    <div class="image"><img class='header_img' src='images/image4.jpg' alt="" /></div>
</div> 
```

CSS：

```
div.image
{
    width: 25%;
}

.header_img
{
    max-width: 100%;
    height: auto;
    float: left;
} 
```

现在，这将图像彼此叠加而不是并排显示：

IE：

![IE9 相互叠加](../Images/2ab487db229a721b2280d0f0ad5f0350.png)

所有其他浏览器：

![在此处输入图像描述](../Images/af1f86b486dd2c7e0a5be6cb41e29eb4.png)

# java - 通用下界方法

> ID：15536403
> 
> 赞同：2
> 
> 时间：2013-03-20T23:01:00.717
> 
> 标签：java, generics, lower-bound

假设我有以下课程`Animal`,`Fish`和`CatFish`.

`CatFish`延伸`Fish`和`Fish`延伸`Animal`。

有一个名为 的泛型类`MyPets`，它有一个名为 的类型参数（泛型）`T`，它将使用上述类的对象进行参数化。

我的问题是，我如何创建一个下界方法，`D`该方法将采用该类的父类的任何对象`CatFish`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:28:05.597

[你不能](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TypeParameters.html#FAQ107)。

TL;博士：

> 类型参数可以有多个界限，例如在类 Box {...} 中。但是类型参数不能有下限，也就是说，类 Box {...} 之类的构造是不允许的。为什么不？答案是：这是没有意义的，因为如果允许的话，它不会给你买任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-05-16T16:37:26.013

[你可以](http://www.angelikalanger.com/GenericsFAQ/FAQSections/TypeParameters.html#FAQ107)。

它只是使用这种下界泛型是有争议的，不被鼓励。基本用途：

```
public void treatAnimalWhichIsCatFishOrSuperType(Animal<? super CatFish> catFishOrParent){
} 
```

当您想从此方法返回泛型类型的实例时，还有其他选择，但您可以在上面的链接中找到。

# java - 我们如何在java中实际实现实体边界控制模式？

> ID：15536404
> 
> 赞同：0
> 
> 时间：2013-03-20T23:01:06.920
> 
> 标签：java, swing, uml

我正在尝试创建一个图书馆管理系统。现在，我知道边界不能直接与实体交互。控制类充当边界和实体类之间的中介。但是，这些类的对象是什么时候创建的呢？

首先，让我们谈谈登录。边界将是使用 Java Swing 创建的登录表单的 UI。Controller 类将是 PersonController，其中包含一个名为“validateUser()”的函数。名为 User 的实体类包含用户信息并访问数据库。

现在，我需要创建 UI，使用操作侦听器从 UI 中获取用户名和密码，然后使用用户名和密码创建一个用户实体，然后调用 PersonController 的 validateUser() 方法来检查登录是否正确并且用户是有效的。

我该怎么做呢？我在哪里创建这些对象？

到目前为止，这是我的代码：

```
public class MainClass { // main class

    public static void main(String[] args) {
        PersonController loginSession = new PersonController(); //UNSURE
    }
}

public class PersonController {

    public PersonController(){
        LoginUI loginForm = new LoginUI(); //UNSURE
        loginForm.setVisible(true); //UNSURE
    }
    //implementation of the validateUser() function
}

public class User {
    private String username;
    private String password;
    private String role;
    private String name;
    private String phone;
    private String email;
    // get & set methods and accessing the database

}
public class LoginUI{
    //entire code for the UI in Java Swing created using Netbeans IDE
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:36:52.400

在我看来，这个过程应该像这样工作......

你有三个元素，UI、模型和控制器。

UI 向用户呈现选择...

该模型将需要创建一个`User`对象（因为您的 UI 不应该知道这是如何实际实现的）。

控制器将负责响应来自 UI 的事件并决定它应该做什么。

当用户在其中键入值并单击“接受”操作（无论它可能是什么）时，控制器会捕获该事件并从 UI 请求一个`User`对象。UI 获取用户输入的信息，并要求模型使用这些值创建一个`User`对象。

控制器可以验证`User`对象。

在任何时候，进程的任何部分都可以选择抛出异常。由于 UI 是系统中唯一可以真正与用户对话的部分，因此 UI 有责任显示这些错误。

基本的工作流程可能看起来像这样......

创建模型、表单和控制器。

将模型添加到表单，将表单添加到控制器。

这些不同元素之间的交互必须尽可能通过接口完成。任何部分都不应该更多地了解另一部分，然后它绝对需要 - 恕我直言。

我的第一步是——在你的脑海中清楚你想要达到的目标。找出谁负责什么，并设计将它们连接在一起所需的桥梁

# android - 通过 MediaRouter 将音频流式传输到设备

> ID：15536406
> 
> 赞同：4
> 
> 时间：2013-03-20T23:01:18.203
> 
> 标签：android, routing, audio-streaming

我想通过 MediaRouter 类将音频文件从我的 android 设备流式传输到另一个设备。据我了解，我需要

```
mediarouter.addCallback(MediaRouter.ROUTE_TYPE_LIVE_AUDIO, mCallback); 
```

功能以侦听连接的设备是否正在播放音频。但是我不确定。我的问题是如何获取音频流？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-06T22:34:40.840

If you play your audio using `AudioTrack` you need to make sure that the `streamType` matches the route's `streamType`. To get the route's `streamType`, simply do:

```
private final MediaRouter.Callback mMediaRouterCallback =
    new MediaRouter.Callback() {

        @Override
        public void onRouteSelected(MediaRouter router, MediaRouter.RouteInfo route) {
                Log.i(TAG, "streamType = " + route.getPlaybackStream());
        }
}; 
```

Usually it will be `AudioManager.STREAM_MUSIC`. So when you initialize your `AudioTrack` make sure to:

```
_audioTrack = new AudioTrack(
                AudioManager.STREAM_MUSIC,
                sampleRate,
                channelConfig,
                audioFormat,
                bufferSize, 
                mode); 
```

# knockout.js - Knockout.js applyBindings twice duplicate result

> ID：15536409
> 
> 赞同：3
> 
> 时间：2013-03-20T23:01:22.340
> 
> 标签：knockout.js

HTML

```
<table cellpadding="0" cellspacing="0" border="0">
<thead>
    <tr><th width="483"><span>Product Name</span></th></tr>
</thead>
<tbody data-bind='foreach: basket.model.products()'>
    <tr><td><div class="ml10 productDetails" data-bind="text: name"></div></td></tr>            
</tbody>
</table> 
```

JAVASCRIPT CODE

```
var ProductLine = function(data) {
    var self = this;
    self.name         = ko.observable(data.name);

};

function BasketModel(data) {
    var self                = this;                     
    self.initialData        = ko.observable(data);      
    self.products           = ko.observableArray();

    $.each(self.initialData().products,function(i,val){
        self.products.push(new ProductLine(this));
    });
}
function renderBasket(data){        

    basket = { model: new BasketModel(data)};
    ko.applyBindings(basket.model);
}   
$(document).ready(function(){
    var sampleData = [{"name":"product 1"},{"name":"product 2"}];
    renderBasket(sampleData );
}); 
```

When i add a new product to basket within ajax post , i call the function below with response data

```
renderBasket(response.data); 
```

Example response.data like [{"name":"product 1"},{"name":"product 2"}, {"name":"product 3"}];

At first: table rows are like :

```
 product 1
 product 2
 product 3 
```

AFTER i add a new product result is :

```
product 1
product 1
product 1
product 2
product 2
product 2
product 3
product 3
product 3 
```

I've tried ko.cleanNode and basket.model.products.removeAll() before ko.applyBindings(basket.model); But i couldn't solve it.

Thank you.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T23:43:54.463

You should call `ko.applyBindings` only once (from the `$(document).ready` function). Just push the products on the observableArray, and you're good to go.

See [http://jsfiddle.net/yCBJ8/5/](http://jsfiddle.net/yCBJ8/5/) for the full example.

```
var ProductLine = function (data) {
        var self = this;
        self.name = ko.observable(data.name);
    },
    BasketModel = function (data) {
        var self = this;

        self.products = ko.observableArray();

        self.addToBasket = function (d) {
            $.each(d, function (i, v) {
                self.products.push(new ProductLine(this));
            });
        };

        self.replaceBasket = function (d) {
            self.products.removeAll();
            self.addToBasket(d);
        };

        self.addToBasket(data);
    };

$(document).ready(function () {
    var initialData = [{"name": "product 1"}, {"name": "product 2"}],
        basket = {
            model: new BasketModel(initialData)
        };

    ko.applyBindings(basket.model);
}); 
```

# hive - HIVE中的多个插入覆盖

> ID：15536413
> 
> 赞同：1
> 
> 时间：2013-03-20T23:01:29.343
> 
> 标签：hive, hiveql

我正在尝试通过以下命令在 Hive 中进行多次插入覆盖。

```
INSERT OVERWRITE  table results_3 SELECT NULL, res, NULL, NULL FROM results where field= 'title'; 
```

以及第一个命令后的 results_3 表的内容

```
NULL    Up On Cripple Creek (2000 Digital Remaster) NULL    NULL
NULL    The Weight (2000 Digital Remaster)  NULL    NULL
NULL    Rhythm Of The Rain (LP Version) NULL    NULL
NULL    Who'll Stop the Rain    NULL    NULL
NULL    I Walk the Line NULL    NULL
NULL    Against The Wind    NULL    NULL
NULL    Lyin' Eyes  NULL    NULL
NULL    North To Alaska NULL    NULL
NULL    You Gave Me A Mountain  NULL    NULL
NULL    Night Moves NULL    NULL

INSERT OVERWRITE  table results_3 SELECT NULL, NULL, res, NULL FROM results where field= 'albums'; 
```

以及第二条命令后 results_3 表的内容

```
NULL    NULL    The Band    NULL
NULL    NULL    The Band    NULL
NULL    NULL    The Cascades    NULL
NULL    NULL    Creedence Clearwater Revival    NULL
NULL    NULL    Johnny Cash NULL
NULL    NULL    Bob Seger   NULL
NULL    NULL    The Eagles  NULL
NULL    NULL    Johnny Horton   NULL
NULL    NULL    Marty Robbins   NULL
NULL    NULL    Bob Seger   NULL 
```

但我想将这两件事合并在一起。你知道我该如何解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-20T15:03:52.023

您可以通过以下方式附加：

```
INSERT OVERWRITE TABLE
select col1 ... col2 
from 
(
SELECT col1 ... coln from TABLE  --old data
UNION ALL
SELECT col1 ... col2n from TABLE2 --new data
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:42:56.010

Hive`insert`目前不支持追加。

一个简单的方法：`insert overwrite`两个目录。手动合并它。或者 `insert into`不同分区的表（但实际上不同的分区有不同的目录）。

请参阅[hive wiki](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DML#LanguageManualDML-InsertingdataintoHiveTablesfromqueries)了解更多信息。

# c# - MSTest中具有多个复杂对象作为参数的单元测试方法

> ID：15536414
> 
> 赞同：1
> 
> 时间：2013-03-20T23:01:29.767
> 
> 标签：c#, unit-testing, mstest

我目前正在开发一个项目，该项目的方法具有参数、复杂对象（主要是存储库对象）。测试必须使用 MSTest 完成。在 TestInitialize 方法中创建对象是否是一种明智的方法，以便它们可以用作用于在测试方法中作为参数传递给实际方法的参数？请提出更好的替代方案。

我在下面附上了需要进行单元测试的方法的示例代码（Exectue() 方法）

```
public class AddOrdersToDbCommand
{
     private IOrdersRepository _ordersRepository;
     private OrderSetting _ordersSetting;

     public AddOrdersToDbCommand(IOrdersRepository ordersRepository, OrderSetting ordersSetting)
     {
        _ordersRepository = ordersRepository;
        _ordersSetting = ordersSetting;
     }

     public void Execute()
     {
         OrderSetting modifyOrderSettings = _ordersRepository.Get(_ordersSetting.Id);
         modifyOrderSettings.Name = _ordersSetting.Name;
         modifyOrderSettings.Status = _ordersSetting.Status;
         modifyOrderSettings.UpdatedBy = _ordersSetting.UpdatedBy;
         modifyOrderSettings.UpdatedDate = _ordersSetting.UpdatedDate;
         _ordersRepository.SaveOrUpdate(modifyOrderSettings);
         _ordersRepository.DbContext.CommitChanges();
     }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:21:55.423

您应该使用[Mocks](http://en.wikipedia.org/wiki/Mock_object)（使用像 Moq 这样的 Mocking 框架）来提供任何依赖对象。这样，您将只隔离和测试当前正在测试的内容。

如果您真的必须创建存根对象，我更喜欢使用辅助类来完成。我有 TestDataGenerator.cs 类。在那里，您可以拥有一组用于生成对象的静态方法。

示例用法将成为`TestDataGenerator.GetStubOrderSetting();`使用 util 类的优势，即您可以创建一整堆返回存根对象的辅助方法，而不会使您的 TestInitialize 方法变得庞大而缓慢。此外，您可以组合单个存根方法以返回更复杂的对象。

例如`TestDataGenerator.GetStubEmployeeWithOrder();`，将首先创建一个存根员工，然后`TestDataGenerator.GetStubOrderSetting();`在返回之前调用您已经创建的为新创建的存根员工设置订单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:42:25.610

我在测试中使用一个类来设置模拟（Moq）存储库以及用于配置的设置方法。

```
class MockRepo {
    private Mock<IRepository> descriptiveSettingRepository;
    private ArrayList _repository = new ArrayList();

    public MockRepo() {
        mockRepo.Setup( /* setup properties */ );
    }
} 
```

使用 MoQ 回调将对象添加到 ArrayList。您还可以查询 ArrayList 并返回对象。

# android - 应用程序运行一段时间后首选项丢失

> ID：15536415
> 
> 赞同：0
> 
> 时间：2013-03-20T23:01:41.837
> 
> 标签：android, preferences, lifecycle

在我的主要活动中，我阅读了一些偏好

```
 public void onCreate(Bundle savedInstanceState) 
  {
      super.onCreate(savedInstanceState);
      SharedPreferences settings = PreferenceManager.getDefaultSharedPreferences(context);
      fontSize = settings.getFloat("textsize", (float) 20);
      userName = settings.getString("userName","");
   } 
```

在其他各种子活动中，我像这样引用这些变量

```
 body.setTextSize(Main.fontSize); 
```

这在大多数情况下都可以正常工作。有时在应用程序运行一段时间后我重新启动它，所有配置变量似乎都是空的。调试时不稳定且难以重现。发生这种情况时，我可以通过所有旧屏幕反复回击，直到它退出，然后重新启动，并且首选项恢复并正常工作

我可以随机尝试将事物移动到不同的地方，例如 onStart() 或 onRestart()，但到目前为止还没有帮助。或者重做每个活动以在开始时重新读取共享首选项。但我更愿意了解导致此问题的错误的生命周期是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:48:58.713

Android 会定期销毁您的 Activity 并在需要时重新创建它。因此，您的`onCreate()`函数正在读取保存的`SharedPreferences`值，但类变量`fontSize`并`userName`没有停留在范围内。

我相信这个问题似乎是*随机*的，而且很恼火，因为这些变量似乎是`static`. 我这样说是因为您的示例`fontSize`以静态方式访问：

```
body.setTextSize(Main.fontSize); 
```

您应该在更改时保存这些值或保存在 中`onPause()`，就像您可能已经这样做的那样。但是，仅仅阅读它们`onCreate()`是不够的，因为 Android 并不总是会完全摧毁你的 Activity。因此，`onCreate()`每次您的活动恢复时都不会调用。您必须在需要时重新读取这些值，或者在`onResume();`.

我在上面写了“激怒”，因为静态变量不会被 Java 自动清除，除非类被完全销毁。因此，有时这些值会比其他时间停留更长时间，从而使行为看起来不可预测。

* * *

最后，允许这些值是静态的并不是最佳实践。还有许多其他方法可以在 Activites 之间共享它们，包括 SharedPreferences。

# php - 使用 PHP 和 Windows 任务计划程序在退出时重试(1)

> ID：15536416
> 
> 赞同：0
> 
> 时间：2013-03-20T23:01:56.827
> 
> 标签：php, windows-server-2008, scheduled-tasks, exit-code

我使用 Windows 任务调度程序来启动一个运行良好的 php 脚本。基本上`C:\php.exe -f C:\myscript.php`

在我的脚本中发生了一些工作，有时让我想在 5 分钟内再次运行任务脚本。

我试图通过更改任务的设置来实现这一点，如果任务失败并拥有我的 php 代码，则每 5 分钟重新启动一次`exit(1)`。任务调度程序似乎知道我以错误代码 1 退出，但它不会再次运行脚本。

有谁知道我可以做些什么来做到这一点，如果我以某种方式从我的代码中发出信号，任务管理器将在 5 分钟内重试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:41:22.527

不是问题的答案，但如果您无法使其正常工作，则可以作为后备：无论如何，让您的工作每 5 分钟运行一次，然后自己跟踪“最后一次成功”/“最后一次失败”，在数据库或文件。

在执行任何其他操作之前，脚本可以检查记录的状态，如果上次失败，请重试（最多尝试次数有限，大概）。如果上次成功，则立即退出，除非到了下一个工作的时间（例如，如果最初的计划是每天，那么检查是否`$last_success`超过 24 小时）。

# excel - 有没有更快的方法来使用 Powershell 解析 excel 文档？

> ID：15536417
> 
> 赞同：12
> 
> 时间：2013-03-20T23:01:57.690
> 
> 标签：excel, powershell

我正在`MS Excel`通过`Powershell`. 每个 excel 文档都有可能包含大约 1000 行数据。

目前，此脚本似乎以`Excel`每 0.6 秒 1 条记录的速率读取文件并将值写入屏幕。乍一看，这似乎非常缓慢。

这是我第一次用 读取`Excel`文件`Powershell`，这是常态吗？有没有更快的方法让我读取和解析`Excel`数据？

这是脚本输出（为便于阅读而修剪）

```
PS P:\Powershell\ExcelInterfaceTest> .\WRIRMPTruckInterface.ps1 test.xlsx
3/20/2013 4:46:01 PM
---------------------------
2   078110
3   078108
4   078107
5   078109
<SNIP>
242   078338
243   078344
244   078347
245   078350
3/20/2013 4:48:33 PM
---------------------------
PS P:\Powershell\ExcelInterfaceTest> 
```

这是`Powershell`脚本：

```
########################################################################################################
# This is a common function I am using which will release excel objects
########################################################################################################
function Release-Ref ($ref) {
    ([System.Runtime.InteropServices.Marshal]::ReleaseComObject([System.__ComObject]$ref) -gt 0)
    [System.GC]::Collect()
    [System.GC]::WaitForPendingFinalizers()
}

########################################################################################################
# Variables
########################################################################################################

########################################################################################################
# Creating excel object
########################################################################################################
$objExcel = new-object -comobject excel.application 

# Set to false to not open the app on screen.
$objExcel.Visible = $False

########################################################################################################
# Directory location where we have our excel files
########################################################################################################
$ExcelFilesLocation = "C:/ShippingInterface/" + $args[0]

########################################################################################################
# Open our excel file
########################################################################################################
$UserWorkBook = $objExcel.Workbooks.Open($ExcelFilesLocation) 

########################################################################################################
# Here Item(1) refers to sheet 1 of of the workbook. If we want to access sheet 10, we have to modify the code to Item(10)
########################################################################################################
$UserWorksheet = $UserWorkBook.Worksheets.Item(2)

########################################################################################################
# This is counter which will help to iterrate trough the loop. This is simply a row counter
# I am starting row count as 2, because the first row in my case is header. So we dont need to read the header data
########################################################################################################
$intRow = 2

$a = Get-Date
write-host $a
write-host "---------------------------"

Do {

    # Reading the first column of the current row
    $TicketNumber = $UserWorksheet.Cells.Item($intRow, 1).Value()

    write-host $intRow " " $TicketNumber    

    $intRow++

} While ($UserWorksheet.Cells.Item($intRow,1).Value() -ne $null)

$a = Get-Date
write-host $a
write-host "---------------------------"

########################################################################################################
# Exiting the excel object
########################################################################################################
$objExcel.Quit()

########################################################################################################
#Release all the objects used above
########################################################################################################
$a = Release-Ref($UserWorksheet)
$a = Release-Ref($UserWorkBook) 
$a = Release-Ref($objExcel) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-21T14:41:00.537

Robert M. Toups, Jr.在他的博客文章[Speed Up Reading Excel Files in PowerShell中解释说，虽然加载到 PowerShell 的速度很快，](http://activelydirect.blogspot.com/2011/03/speed-up-reading-excel-files-in.html)*但实际上读取 Excel 单元格却非常慢*。另一方面，PowerShell 可以非常快速地读取文本文件，因此他的解决方案是在 PowerShell 中加载电子表格，使用 Excel 的原生 CSV 导出过程将其保存为 CSV 文件，然后使用 PowerShell 的标准`Import-Csv`cmdlet 以极快的速度处理数据. 他报告说，这使他的导入过程加快了 20 倍！

利用 Toups 的代码，我创建了一个`Import-Excel`函数，可以让您非常轻松地导入电子表格数据。我的代码添加了在 Excel 工作簿中选择特定工作表的功能，而不仅仅是使用默认工作表（即保存文件时的活动工作表）。如果省略该`–SheetName`参数，它将使用默认工作表。

```
function Import-Excel([string]$FilePath, [string]$SheetName = "")
{
    $csvFile = Join-Path $env:temp ("{0}.csv" -f (Get-Item -path $FilePath).BaseName)
    if (Test-Path -path $csvFile) { Remove-Item -path $csvFile }

    # convert Excel file to CSV file
    $xlCSVType = 6 # SEE: http://msdn.microsoft.com/en-us/library/bb241279.aspx
    $excelObject = New-Object -ComObject Excel.Application  
    $excelObject.Visible = $false 
    $workbookObject = $excelObject.Workbooks.Open($FilePath)
    SetActiveSheet $workbookObject $SheetName | Out-Null
    $workbookObject.SaveAs($csvFile,$xlCSVType) 
    $workbookObject.Saved = $true
    $workbookObject.Close()

     # cleanup 
    [System.Runtime.Interopservices.Marshal]::ReleaseComObject($workbookObject) |
        Out-Null
    $excelObject.Quit()
    [System.Runtime.Interopservices.Marshal]::ReleaseComObject($excelObject) |
        Out-Null
    [System.GC]::Collect()
    [System.GC]::WaitForPendingFinalizers()

    # now import and return the data 
    Import-Csv -path $csvFile
} 
```

Import-Excel 使用这些补充功能：

```
function FindSheet([Object]$workbook, [string]$name)
{
    $sheetNumber = 0
    for ($i=1; $i -le $workbook.Sheets.Count; $i++) {
        if ($name -eq $workbook.Sheets.Item($i).Name) { $sheetNumber = $i; break }
    }
    return $sheetNumber
}

function SetActiveSheet([Object]$workbook, [string]$name)
{
    if (!$name) { return }
    $sheetNumber = FindSheet $workbook $name
    if ($sheetNumber -gt 0) { $workbook.Worksheets.Item($sheetNumber).Activate() }
    return ($sheetNumber -gt 0)
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-21T01:05:03.090

如果数据是静态的（不涉及公式，只是单元格中的数据），您可以将电子表格作为 ODBC 数据源访问并对其执行 SQL（或至少类似于 SQL）查询。查看[此参考](http://www.connectionstrings.com/excel)以设置您的连接字符串（工作簿中的每个工作表将是本练习的“表”），并使用`System.Data`与常规数据库相同的查询它（Don Jones为此编写了一个包装[函数](http://technet.microsoft.com/en-us/magazine/hh855069.aspx)这可能会有所帮助）。

这*应该*比启动 Excel 并逐个单元格地挑选要快。

# java - 实现移植到 Java 的指针和数组

> ID：15536421
> 
> 赞同：1
> 
> 时间：2013-03-20T23:02:10.200
> 
> 标签：java, c++, pointers

我正在将一些 C++ 代码移植到使用一些重指针算法的 Java。我的问题如下：

有一个这样构建的结构，我已经作为一个类实现：

在原始 C/C++ 代码中，我有以下任务，

```
struct mst_edge
{
    int u, v;
    double w;
}

mst_edge * tree_edges = new mst_edge[size];

int node_l = tree_edges->u;
int node_r = tree_edges->v; 
```

如何将此代码转换为java？第二个块声明`mst_edge`为 C/C++ 动态数组。但在第三个代码块中，它使用 tree_edges 作为直接指针。

考虑到内存和引用是由 Java 直接处理的，Java 相当于什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:11:15.973

C/C++ 中的 struct 就像 Java 中的类及其所有成员变量`public`：

```
class MstEdge
{
    public int u;
    public int v;
    public double w;
} 
```

你通常不会在 Java 中这样做。成员变量将是`private`, 带有`public`访问器方法，但最接近`struct`.

在 C/C++ 中指向数组的指针在 Java 中只是一个数组。

```
MstEdge[] treeEdges = new MstEdge[size]; 
```

但是请注意，在 Java 中，声明一个数组意味着您现在有了`size` `null`元素。像这样初始化它们：

```
treeEdges[0] = new MstEdge();  // and so on for other array positions 
```

与在 C/C++ 中将指针视为对第一个元素的直接引用不同，在 Java 中，您必须显式引用第一个元素。

```
int nodeL = treeEdges[0].u;
int nodeR = treeEdges[0].v; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:06:37.087

Java等价物是

```
mst_edge[] tree_edges = new mst_edge[size];

int node_l = tree_edges[0].u;
int node_r = tree_edges[0].v; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T23:09:49.047

在 OO Java 中，您将使用 getter 来检索私有成员变量。size 是您定义的任何值。

```
class MstEdge {
    private int u;
    private int v;
    private double w;

    public int getU() {
        return u;
    }

    public int getV() {
        return v;
    }
   .
   .
   .
}

MstEdge [] treeEdges = new MstEdge[size];

int nodeL = treeEdges[i].getU();
int nodeR = treeEdges[i].getV(); 
```

# ios - 为 UIView 创建动态名称

> ID：15536422
> 
> 赞同：0
> 
> 时间：2013-03-20T23:02:18.937
> 
> 标签：ios, objective-c, nsstring, init, alloc

一切都在我的标题中，我想创建一些动态名称，以随机分配一些不同的 UIView。例如，我想做：

```
Level1 * level1view = [[Level1 alloc] init]; 
```

所以我尝试像这样制作一些 NSString ：

```
ClasseMap = [NSString stringWithFormat:@"Level%i", Map];
NomMap = [NSString stringWithFormat:@"level%iview", NumeroMap];
id nouveau = NSClassFromString(ClasseMap);
nouveau * ViewTest;
ViewTest = [self valueForKey:NomMap];
ViewTest  = [[nouveau alloc] init]; 
```

但它给了我：使用未声明的标识符“ViewTest”。请问我该如何解决？我怎样才能访问一些变量（例如，level1view.example = YES;）？

谢谢你的帮助 ！=)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:20:20.747

为什么不保留一系列视图呢？

```
int Map = 0;
int NumeroMap = 1;

NSMutableArray *array = [[NSMutableArray alloc] init];

//add your views (levels?) to the array
[array addObject:someUIView];
[array addObject:someOtherUIView];

//now you can use your indexes to access the views you want
UIView *yourView = [array objectAtIndex:Map];
UIView *anotherView = [array objectAtIndex:NumeroMap]; 
```

我认为你试图做的不是做事的方式。

# php - 在循环中将数据列表从 php 放入 div

> ID：15536423
> 
> 赞同：0
> 
> 时间：2013-03-20T23:02:39.353
> 
> 标签：php, html, mysqli

这是建立在上一个问题的基础上的： [https ://stackoverflow.com/questions/15534272/interpreting-the-day-of-a-datetime-and-putting-it-into-a-relevant-div](https://stackoverflow.com/questions/15534272/interpreting-the-day-of-a-datetime-and-putting-it-into-a-relevant-div)

本质上我有这张表：

```
Events Table
EventID | Start               | End                 |  Details
1       | 2013-03-18 09:00:00 | 2013-03-18 10:00:00 |  Event is in room 6
2       | 2013-03-18 10:00:00 | 2013-03-18 11:00:00 |  Event is in room 3 
```

和这个专栏：

```
<div class="timetable-column-first">
    <div class="timetable-row-start">Time</div>
    <div class="timetable-row">9:00am</div>
    <div class="timetable-row">10:00am</div>
</div>

<div class="timetable-column">
    <div class="timetable-row-start">Monday</div>
    <div class="timetable-row" id="mon-9"></div>
    <div class="timetable-row" id="mon-10"></div>
</div> 
```

我已经构建了这个 php 查询来获取我需要的信息：

```
function getEvents($weekNumStart, $weekNumEnd){
    $mysqli = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME);
    if (!$mysqli) {
        die('There was a problem connecting to the database.');
    }
    else {
        if ($weekNumEnd == '') {
            $weekNumEnd = $weekNumStart;
        }
        $query = $mysqli->prepare("SELECT EventID, DAYOFWEEK(Start) AS wday, Events.Start, HOUR(Start) AS sHour, HOUR(End) AS eHour, Events.End, Details, StartName FROM Events, Week WHERE StartName >= '$weekNumStart' AND StartName <= '$weekNumEnd' AND Events.Start >= StartWeek AND Events.Start <=EndWeek;");
        $query->execute();
        $query->bind_result($eventID, $dayofweek, $startDateTime, $startHour, $endHour, $endDateTime, $weekName);
        while ($query->fetch()){
            echo $eventID, $dayofweek, $startDateTime, $startHour, $endHour, $endDateTime, $weekName;
        }
    }
    $mysqli->close();
} 
```

问题是这个查询是在附加的 php 文件 /functions.php 中完成的，该文件包含在标题中。

我不知道如何更改此行：

```
echo $eventID, $dayofweek, $startDateTime, $startHour, $endHour, $endDateTime, $weekName; 
```

这样它要么将每个数组返回到原始 index.php，然后我就可以使用 jquery 将它插入到我的 div id 的列和行中。因此，例如，细节在 div 中会像这样结束：

```
<div class="timetable-column">
    <div class="timetable-row-start">Monday</div>
    <div class="timetable-row" id="mon-9">1 - Event is in room 6</div>
    <div class="timetable-row" id="mon-10">2 - Event is in room 3</div>
</div> 
```

就目前而言，我的功能有效，从服务器回显所有单独的数据。

在 index.php 页面上，我只是这样称呼它：

```
getEvents($weekNumStart, $weekNumEnd); 
```

我考虑过返回数组而不是回显，但这不会只返回很多行吗？因此，当我在带有列表的 index.php 页面上选择它时，`($the data here) = getEvents($weekNumStart, $weekNumEnd);`我只会将第一个事件发回？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:55:26.660

我做这样的事情的典型模型是：

```
function getEvents($weekNumStart, $weekNumEnd){
    // I'm moving the SQL up here just so it's out of the way for a minute;
    $sql_str = "SELECT EventID, DAYOFWEEK(Start) AS wday, Events.Start, HOUR(Start) AS sHour, HOUR(End) AS eHour, Events.End, Details, StartName FROM Events, Week WHERE StartName >= '$weekNumStart' AND StartName <= '$weekNumEnd' AND Events.Start >= StartWeek AND Events.Start <=EndWeek";

    $mysqli = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME);
    if (!$mysqli) {
        die('There was a problem connecting to the database.');
    }
    else {
        if ($weekNumEnd == '') {
            $weekNumEnd = $weekNumStart;
        }
        $query = $mysqli->prepare($sql_str); // I moved the string above just for clarity
        $query->execute();
        $query->bind_result($eventID, $dayofweek, $startDateTime, $startHour, $endHour, $endDateTime, $weekName);

        // LINE ADDED:
        $data_arr = array();
        while ($query->fetch()){
            // I'm creating an associative array to sort each result by day of
            // the week
            $data_arr[$dayofweek] = array(
                $eventID, $dayofweek, $startDateTime, 
                $startHour, $endHour, $endDateTime, $weekName
            );
            /* Example of what the object would look like with your events in it.
            ['Monday' => [[
                   1, "Monday", "2013-03-18 09:00:00", 
                   "09", "10", "2013-03-18 10:00:00",
                   "Event is in room 6"
            ], [
                   2, "Monday", "2013-03-18 10:00:00", 
                   "10", "11", "2013-03-18 11:00:00",
                   "Event is in room 3"
            ]]];
             */
        }
        $mysqli->close(); // a little redundant, but meh
        return $data_arr; // returns each of your results as an array within an array
    }
    $mysqli->close(); 
```

}

然后从您调用 getEvents() 函数的任何地方，执行以下操作：

```
$data = getEvents($weekNumStart, $weekNumEnd);

$html = '';
$firstCol = '';
$secondCol = '';

// for each day in the data array:
foreach($data as $day) {
    $firstCol .= '<div class="timetable-column-first">'
           . '<div class="timetable-row-start">Time</div>';
    $secondCol .= '<div class="timetable-column">'
           . '<div class="timetable-row-start">' . $day . '</div>';

    $timeStartRow = '';
    $detailsRow = '';
    for($i = 0; $i < count($data[$day]); $i++) {
        $startHour = $data[$day][$i][3];
        $details = $data[$day][$i][6];

        // build the content rows within the first column
        $timeStartRow .= '<div class="timetable-row">' 
                      . $startHour                         // append each start hour
                      . '</div>';

        // build the content rows within the second column
        $detailsRow .= '<div class="timetable-row" id="' 
                    . $day . '-' . $starHour . '">'        // create the id
                    . $details                             // deats!
                    . '</div>';
    }
    $timeStartRow .= '</div>'; // close off .timetable-column-first
    $detailsRow .= '</div>'; // close off .timetable-column

    $html .= $firstCol . $timeStartRow . $secondCol . $detailsRow;
    $firstCol = '';
    $secondCol = '';
} 

echo $html; // I can't guarantee it will work, but it'll be 90% there :] 
```

希望这有帮助。如果不出意外，请扫描它以了解我想要的整体想法。祝你好运！

# javascript - 我的数组中的javascript无限循环错误

> ID：15536426
> 
> 赞同：0
> 
> 时间：2013-03-20T23:02:51.210
> 
> 标签：javascript, arrays

这是我正在编写 atm 的代码：

```
var array = [3, 6, 2, 56, 32, 5, 89, 32];
var largest = 0;

for (var i = 0; i < array.length; i++){
    if ( i > largest) {
    i = largest;
    }
}

console.log(largest); 
```

它应该警告数组中的最大数字，但它似乎陷入了无限循环。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T23:04:24.693

我想你想要

```
for (var i = 0; i < array.length; i++){
    if ( array[i] > largest) {
        largest = array[i];
    }
} 
```

基本上你是说“如果`i`大于 0，则设置`i`为 0”，这将导致`i`永远在 0 和 1 之间交替。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T23:04:34.060

```
var arr = [3, 6, 2, 56, 32, 5, 89, 32];
var largest = arr[0];

for (var i = 0; i < array.length; i++){
    if ( arr[i] > largest) {
        largest = arr[i];
    }
}

console.log(largest); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T23:04:30.980

我想你的意思是。

```
var array = [3, 6, 2, 56, 32, 5, 89, 32];
var largest = array[0];

for (var i = 1; i < array.length; i++){
    if ( array[i] > largest) {
        largest = array[i];
    }
}

console.log(largest); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T23:04:54.730

`i`每次找到新的 时，您都会重置 的值`largest`，以便您拥有无限循环。此行使您的循环无限：

```
i = largest; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T23:09:06.340

您可以使用找到数组的最大值

```
Math.max.apply(null, array) 
```

# entity-framework - 找不到 EntityType 的映射和元数 据信息……为什么？

> ID：15536428
> 
> 赞同：3
> 
> 时间：2013-03-20T23:02:52.853
> 
> 标签：entity-framework

我正在使用 EF 5 wit Pocos，并且我有以下代码行：

```
user.Seals.Add(new Seal("token", "flag")); 
```

User 和 Seal 都是 EF 实体 pocos，如下所示：

```
user.Seals.Add(new UserUnlockSealModel()); 
```

其中 UserUnlockSealModel 如下：

```
public class UserUnlockSealModel : Seal {

  public UserUnlockSealModel() : base(Cryptographer.Salt(32), "UU") { }

} // UserUnlockSealModel 
```

但是当我使用它时，我收到以下错误：

Message = "找不到 EntityType 'UserUnlockSealModel' 的映射和元数​​据信息。"

我在这里想念什么？我不能将实体用作基类吗？

谢谢你，米格尔

# ios - 将 byte[] 转换为 NSData 后数据损坏

> ID：15536429
> 
> 赞同：2
> 
> 时间：2013-03-20T23:02:57.720
> 
> 标签：ios, json, pdf, bytearray, nsdata

我有 .Net Web 服务响应，其中包含一个 byte[] 条目以及其他字段。数据为 PDF 文件。

我从收到的数据中提取字典： [NSJSONSerialization JSONObjectWithData]

此后，我使用以下代码将 byte[] 转换为 NSData。然后我将结果保存到磁盘（见最后一行）。

打开生成的 PDF 文件时，出现以下错误：

**“找不到 PDF 标题：找不到‘%PDF’。”**

```
 NSArray *byteArray = [rootDictionary objectForKey:@"file"];

        unsigned c = byteArray.count;
        uint8_t *bytes = malloc(sizeof(*bytes) * c);

        unsigned i;
        for (i = 0; i < c; i++)
        {
            NSString *str = [byteArray objectAtIndex:i];
            int byte = [str intValue];
            bytes[i] = (uint8_t)byte;
        }

        NSData* data = [NSData dataWithBytes:(const void *)byteArray length:sizeof(unsigned char)*c];

        //Save to disk using svc class.
        NSString *localPath = [svc saveReport:data ToFile:[rootDictionary objectForKey:@"name"]]; 
```

我还尝试将 byte[] 转换为 base64 NSString（在服务端），然后在我的应用程序中返回 NSData，这可以正常工作（**大部分情况下），但我被告知这是草率的代码。

** 当同时异步拉取多个 PDF 时，其中一些作为 base64 字符串接收的报告也已损坏。

PS。如果我也必须从我的 svc 类中提供代码，请告诉我，但我认为问题不存在。

**编辑：** 我创建了一个新的 Web 服务方法，它以 byte[] 作为输入，然后修改了我的 iOS 应用程序以将 byteArray 变量发送回服务，并将其保存到文件中。生成的 PDF 文件是 Adob​​e 可读的有效文件。意味着在传输过程中没有腐败。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-25T10:13:16.267

[好的，在仔细梳理了我的代码之后终于解决了这个问题（受来自http://www.raywenderlich.com/forums/viewtopic.php?f=2&p=38590#p38590](http://www.raywenderlich.com/forums/viewtopic.php?f=2&p=38590#p38590)的 snadeep.gvn 的启发）。

我犯了一个愚蠢的错误，我忽略了 100 多次。

这行代码：

```
NSData* data = [NSData dataWithBytes:(const void *)byteArray length:sizeof(unsigned char)*c]; 
```

应改为：

```
NSData* data = [NSData dataWithBytes:(const void *)bytes length:sizeof(unsigned char)*c]; 
```

好时光，现在我终于可以睡一觉了:-)

# angularjs - 如何将复杂属性从父范围继承到指令的隔离范围中

> ID：15536435
> 
> 赞同：3
> 
> 时间：2013-03-20T23:03:18.763
> 
> 标签：angularjs, angularjs-directive, angularjs-scope

在查看了 AngularJS（和相关）文档和其他有关指令内隔离范围的 stackoverflow 问题后，我仍然有点困惑。为什么我不能在父范围和指令隔离范围之间进行双向绑定，其中父范围属性是对象而不是属性？我应该只使用所需的属性`scope.$parent`吗？这似乎是错误的。在此先感谢您的帮助。

相关的小提琴在[这里](http://jsfiddle.net/ksevksev/PWdYZ/5/)。

HTML：

```
<div ng-app="myApp">
    <div ng-controller="myCtrl">
        <div my-directive>{{test.name}}</div>
    </div>
</div> 
```

JavaScript：

```
var myApp = angular.module('myApp', []);

myApp.controller('myCtrl', function ($scope) {
    $scope.test = {name:"name", value:"value"};
});

myApp.directive("myDirective", function () {
    return {
        replace: true,
        restrict: 'A',
        scope: {test: '='},
        template: '<div class="parent"><div>This is the parent Div.</div><div>Value={{test}}</div></div>',
        link: function (scope, element, attrs) {
            console.log("scope.test=["+scope.test +"]");
            console.log("scope.$parent.test=["+scope.$parent.test.name+"]");
        }
    };
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T00:12:08.680

对于使用隔离作用域的指令，**属性**用于指定指令隔离子作用域需要访问的父作用域属性。'=' 提供双向绑定。'@' 提供“单向字符串”。'&' 提供单向表达式。

要让您的指令（双向绑定）访问父范围对象属性`test`，请使用以下 HTML：

```
<div my-directive test="test"></div> 
```

使用不同的名称可能更有指导意义：

```
<div my-directive some-obj-prop="test"></div> 
```

然后在你的指令中：

```
scope: { localDirProp: '=someObjProp'},
template: '<div ...>Value={{localDirProp}}...', 
```

* * *

隔离作用域在原型上不会从父作用域继承，因此它无权访问任何父作用域的属性（除非使用了“@”或“=”或“&”）。Using`$parent`是一种仍然访问父作用域的方法，但不是通过原型继承。Angular`$parent`在作用域上创建了这个特殊属性。通常（即最佳实践）不应使用它。

# jquery - jQuery fancybox 将图像源附加到 href

> ID：15536437
> 
> 赞同：0
> 
> 时间：2013-03-20T23:03:24.897
> 
> 标签：jquery, fancybox, append, href

我在我的网站上使用了 fancybox 插件。我想使用 jQuery 来检测图像源并将其放在 href 中。

我的 html 看起来像这样：

```
<div class="item">
    <img src="img/sam_skirrow_the_moment_3.jpg" class="item_img"/>
</div> 
```

我正在使用jquery来附加fancybox代码：

```
 $('<a class="fancybox" href="[IMAGE SOURCE]"></a>').appendTo('.item'); 
```

我需要什么代码来获取 img src 并将其添加为 href 的源？大概是这样的？

```
$('<img>').attr('src').appendTo('.fancybox'); 
```

所以我的问题是：如何使用 jQuery 获取图像的 src 并将其添加到“href”。即 a href="[SRC OF IMAGE]"

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:45:06.827

如果您的容器中有多个`<img>`标签（或没有），例如

```
<div class="item">
    <img src="images/1_b.jpg" alt="" />
    <img src="images/2_b.jpg" alt="" />
</div> 
```

等等然后你可以使用`.each()`和`.wrap()`方法，如：

```
$(".item img").each(function () {
    var newHref = $(this).attr("src");
    $(this).wrap("<a class='fancybox' rel='gallery' href='" + newHref + "'/>");
}); 
```

当然，你还是需要将fancybox绑定到选择器上`.fancybox`

```
$(".fancybox").fancybox(); 
```

见**[JSFIDDLE](http://jsfiddle.net/wfBTj/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:19:22.237

在启动fancybox之前选择图像源：

```
 var imgSrc = $('.item > img').attr('src');
  $('<a class="fancybox" href="'+imgSrc+'"></a>').appendTo('.item'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T23:20:22.930

也许你可以尝试这样的事情

```
$('.fancybox').attr('href',$('.item_img').attr('src')); 
```

[你可以从这里](http://api.jquery.com/attr/)检查`.attr`API

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T23:54:17.513

最简单的方法如下：

```
$(".item").find("img").each( function() {
     $(this).attr("href",$(this).attr("src"));
}; 
```

如果这对您有用，请将其标记为答案！

# jquery - 如何将两个点击计数器存储在变量中并用它进行一些计算 - jquery

> ID：15536438
> 
> 赞同：0
> 
> 时间：2013-03-20T23:03:33.177
> 
> 标签：jquery

我有一个“下一个”和“预览”的 div 可以点击。使用以下代码，可以将计数的点击存储到每个 div 的变量中。单击时显示结果的警报框。到目前为止，一切都很好。但我不知道为什么使用“var countNext”和“var countPrev”进行任何计算都不起作用！
“var countResult”始终为“0”，单击#test div 以提醒结果。

```
var countNext = ($('#next').data('click_count') || 0);  
var countPrev = ($('#prev').data('click_count') || 0);  
var countResult = countNext - countPrev;  

  $('#next').on('click', function() {  
    countNext++;  
    alert(countNext);        
    });  

  $('#prev').on('click', function() {  
    countPrev++;         
    alert(countPrev);        
    });  

  $('#test').on('click', function() {  
    alert(countResult);        
    }); 
```

你知道它有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:11:09.640

只是增加变量不会将其存储在 data() 对象中：

```
$('#next, #prev').data('click_count', 0).on('click', function () {
    $(this).data('click_count', $(this).data('click_count') + 1);
});

$('#test').on('click', function () {
    alert($('#next').data('click_count') - $('#prev').data('click_count'));
}); 
```

[**小提琴**](http://jsfiddle.net/ALFuY/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:12:27.767

为什么不更新数据属性，因为您已经拥有它们而不是使用全局变量？

```
$('#next').on('click', function() { 
    var $this = $(this), new_click_count = $this.data('click_count') + 1;

    $this.data('click_count', new_click_count);  
    alert(new_click_count);        
});  

$('#prev').on('click', function() {  
    var $this = $(this), new_click_count = $this.data('click_count') + 1;

    $this.data('click_count', new_click_count);  
    alert(new_click_count);          
});  

$('#test').on('click', function() {  
    var next_count = $('#next').data('click_count'), prev_count = $('#prev').data('click_count'), countResult = next_count - prev_count;

    alert(countResult); 
}); 
```

您可以将其简化为：

```
$('#next, #prev').on('click', function() { 
        var $this = $(this), new_click_count = $this.data('click_count') + 1;

        $this.data('click_count', new_click_count);  
        alert(new_click_count);        
    });   

$('#test').on('click', function() {  
        var next_count = $('#next').data('click_count'), prev_count = $('#prev').data('click_count'), countResult = next_count - prev_count;

        alert(countResult); 
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T23:12:34.583

添加了一些修改，但主要的修改是移动点击时新结果的计算。

```
$(document).ready(function() {
  var countNext = 0;  
  var countPrev = 0;  

  $('#next').on('click', function() {  
    countNext++;  
    alert(countNext);        
    });  

  $('#prev').on('click', function() {  
    countPrev++;         
    alert(countPrev);        
    });  

  $('#test').on('click', function() {  
    var countResult = countNext - countPrev;
    alert(countResult);        
    }); 
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T23:08:45.570

每次单击发生时，您都需要重新计算 countResults

```
var countNext = ($('#next').data('click_count') || 0);  
var countPrev = ($('#prev').data('click_count') || 0);  
var countResult = countNext - countPrev;  

  $('#next').on('click', function() {  
    countNext++;  
    countResult = countNext - countPrev;
    alert(countNext);        
    });  

  $('#prev').on('click', function() {  
    countPrev++;       
    countResult = countNext - countPrev;  
    alert(countPrev);        
    });  

  $('#test').on('click', function() {  
    alert(countResult);        
    }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T23:09:54.647

我认为您的代码的唯一错误是不要将计数器数据再次存储在您的`div`. 您只需获取值并使用它，但是当您单击按钮时，您会增加变量但不会将其存储在您的`div`数据中。所以

```
$('#next').on('click', function() {  
   countNext++;  
   alert(countNext);        
   $('#next').data('click_count',countNext);
}); 
```

和同样的`countPrev`

# php - 在“索引”的情况下，PHP $_GET 无法获取 RewriteRule 的值

> ID：15536442
> 
> 赞同：0
> 
> 时间：2013-03-20T23:03:59.527
> 
> 标签：php, html, linux, apache, mod-rewrite

我有问题。我正在尝试获取此网址：

```
mySite.com/index.php?url=category/value1/value2/value3 
```

由此：

```
MySite.com/category/value1/value2/value3 
```

我有这个 .htaccess 文件：

```
<IfModule mod_rewrite.c>
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^(.*)$ index.php?url=$1 [L,QSA]
</IfModule> 
```

如果类别是除“索引”之外的所有内容，则一切正常，所以如果我输入 URL：

```
MySite.com/content/tv/color 
```

数组 $_GET 等于：

```
Array
(
    [url] => content/tv/color/
) 
```

但是当我说：

```
MySite.com/index/option1/option2 
```

数组为空

```
Array() 
```

我检查了我的 apache.conf 文件，但看不到问题。

```
<VirtualHost *:80>
        ServerAdmin user@site.com

        DocumentRoot /home/htdocs
        <Directory />
                AllowOverride all
        </Directory>
        <Directory /home/htdocs>
                #>>>>>HERE I HAVE MY TEST APP <<<<<<<<
                DirectoryIndex index.html index.php
                Options FollowSymLinks MultiViews
                RewriteEngine ON
                AllowOverride all
                Order allow,deny
                allow from all
        </Directory>
        Alias /simplesaml /var/simplesamlphp/www
        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
        <Directory "/usr/lib/cgi-bin">
                AllowOverride None
                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
                Order allow,deny
                Allow from all
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog ${APACHE_LOG_DIR}/access.log combined

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:07:29.637

您需要通过在它之前`MultiViews`添加减号来关闭选项。`-``-MultiViews`

实际上我不确定你为什么明确打开它。它只是一个配置复制粘贴吗？

另外，如果您不需要`FollowSymLinks`（我确定您不需要它）-也将其关闭。

# c# - 如何在子网站上引用 aspx？

> ID：15536443
> 
> 赞同：0
> 
> 时间：2013-03-20T23:04:07.260
> 
> 标签：c#, asp.net, .net

我有一个子 asp.net 网站。子，我的意思是它是 IIS 中的一个 Web 应用程序，它位于主 Web 应用程序下。

当用户退出主站点时，会话变量在子站点上仍然有效。

我想取消子站点中的会话变量。我可以专门为此在子站点上创建 subendsession.aspx。当用户注销时，主站点调用 endsession.aspx。如何在不重定向用户的情况下调用 subendsession.aspx？

这种情况有更好的技术吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:09:06.237

该`Abandon`方法应该有效（[MSDN](http://msdn.microsoft.com/en-us/library/ms524310%28VS.90%29.aspx)）：

```
Session.Abandon(); 
```

# java - 资源映射实现后 Spring MVC 映射不起作用

> ID：15536453
> 
> 赞同：1
> 
> 时间：2013-03-20T23:04:50.963
> 
> 标签：java, spring, spring-mvc

在我的上下文文件中，我想添加能够访问静态内容的行。在我添加它之前，一切正常，但是在我添加它之后，我无法访问具有某些控制器的页面并且我收到以下警告：`WARN : org.springframework.web.servlet.PageNotFound - No mapping found for HTTP request with URI [/fit/] in DispatcherServlet with name 'mvc-dispatcher'`. 在添加`<mvc:resources mapping="/resources/**" location="/resources/" />`到上下文文件之前，它看起来像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
xmlns:security="http://www.springframework.org/schema/security"
xmlns:mvc="http://www.springframework.org/schema/mvc"
xsi:schemaLocation="
    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd
    http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd
    http://www.springframework.org/schema/mvc
    http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd">

<context:annotation-config />

<!-- Handles HTTP GET requests for /resources/** by efficiently serving 
    up static resources in the ${webappRoot}/resources directory -->

<context:component-scan base-package="cz.cvut.fit.genepi.controllers" />
<import resource="classpath:applicationContext-security.xml" />
<bean
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix" value="/WEB-INF/views/" />
    <property name="suffix" value=".jsp" />
</bean>

<mvc:resources mapping="/resources/**" location="/resources/" />
    </beans> 
```

知道如何解决这个问题吗？

PS：这些页面受到 Spring 安全性的保护，但我认为这不是问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T06:15:35.543

每个调度程序 servlet 都以 -servlet 结尾。尝试重命名您的调度程序 servlet。

在 DispatcherServlet 初始化时，框架将在您的 Web 应用程序的 WEB-INF 目录中查找名为 [servlet-name]-servlet.xml 的文件并创建其中定义的 bean。

# sql-server - SQL Server 2005 SELECT TOP 1 from VIEW 返回最后一行

> ID：15536454
> 
> 赞同：0
> 
> 时间：2013-03-20T23:04:53.010
> 
> 标签：sql-server, sql-server-2005, view, top-n

我有一个可能包含多行的视图，如下所示：

```
[rate] | [vendorID]
 8374       1234
 6523       4321
 5234       9374 
```

在 SPROC 中，我需要设置一个参数，该参数等于视图第一行中第一列的值。像这样的东西：

```
DECLARE @rate int;
SET @rate = (select top 1 rate from vendor_view where vendorID = 123)
SELECT @rate 
```

但这总是返回视图的最后一行。

事实上，如果我只是自己运行子选择，我只会得到最后一行。
视图中有 3 行，TOP 2 按顺序返回 FIRST 和 THIRD 行。有 4 行，它按顺序返回前 3 行。然而，前 1 名仍然是最后一名。德普？！？

这有效..

```
DECLARE @rate int;

CREATE TABLE #temp (vRate int)
INSERT INTO  #temp (vRate) (select rate from vendor_view where vendorID = 123)

SET @rate = (select top 1 vRate from #temp)
SELECT @rate

DROP TABLE #temp 
```

..但是有人可以告诉我为什么第一个表现得如此愚蠢以及如何做我想做的事？正如评论中所解释的，没有任何有意义的列可以用来进行排序。我可以强制插入行的顺序为返回的顺序吗？

[编辑] 我还注意到：`select top 1 rate from ([view definition select])`也一次又一次地返回正确的值。[/编辑]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:46:16.777

这是设计使然。

如果您没有指定查询的排序方式，数据库可以自由地以任何方便的顺序返回记录。用作默认排序顺序的表没有自然顺序。

实际的顺序取决于查询的计划方式，因此您甚至不能依赖同一个查询随着时间的推移提供一致的结果，因为数据库将收集有关数据的统计信息并可能改变查询的计划方式在那。

要获得您期望的记录，您只需指定您希望它们如何排序，例如：

```
select top 1 rate
from vendor_view
where vendorID = 123
order by rate 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-27T17:02:00.783

我在一个已经工作多年的查询中遇到了这个问题。我们升级了 SQL Server，突然之间，无序`select top 1`没有返回表中的最终记录。我们只是`order by`在`select`.

`order by`我的理解是，如果没有提供或引擎选择的任何索引，SQL Server 通常会根据聚集索引为您提供结果。但是，这并不能保证一定的顺序。

如果您没有要订购的东西，则需要添加它。添加一个日期插入列并将其默认为`GETDATE()`或添加一`identity`列。从历史上看，它对您没有帮助，但它解决了未来的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-27T19:40:18.580

虽然查询的结果应该保持一致并不一定有意义，但在这种特殊情况下，它们是一致的，所以我们决定保持“原样”。最终最好添加一列，但这不是一个选项。这个属于的应用程序预计很快就会停止使用，并且数据库服务器不会从 SQL 2005 升级。我不一定喜欢这个结果，但它就是这样：除非它坏了，否则它不会被修复。：-X

# ruby-on-rails - ActiveRecord::RecordNotFound

> ID：15536456
> 
> 赞同：0
> 
> 时间：2013-03-20T23:05:04.003
> 
> 标签：ruby-on-rails, simple-form, rails-activerecord

我正在尝试提交表单并收到此错误：`Couldn't find Event without an ID`

这是控制器：

```
def create
@event = Event.find(params[:event_id])
@event_sponsorship = EventSponsorship.new(params[:event_sponsorship])
@event_sponsorship.sponsor_id = current_user.id
@event_sponsorship.event_id = @event

respond_to do |format|
  if @event_sponsorship.save
    format.html { redirect_to @event_sponsorship, notice: 'Event sponsorship was successfully created.' }
    format.json { render json: @event_sponsorship, status: :created, location: @event_sponsorship }
  else
    format.html { render action: "new" }
    format.json { render json: @event_sponsorship.errors, status: :unprocessable_entity }
  end
end
end 
```

这是表格：

```
<%= simple_form_for(@event_sponsorship) do |f| %>
<%= f.error_notification %>

<div class="signin">
<%= f.hidden_field :event_id, value: @event %>

 <%= f.hidden_field :sponsor_id, value: current_user.id %>

<%= f.button :submit, :class => "btn btn-success btn-block", value: "Yes" %>
</div>
<% end %> 
```

在`create`方法中`event_id`应该从 URL 中找到。我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:08:41.367

发布您在服务器控制台中看到的错误，您会看到您的参数“event_id”是（我猜）“event_sponsorship”的子键

试试这个：

```
@event = Event.find(params[:event_sponsorship][:event_id]) 
```

您甚至可能需要使用以下代码：

```
@event = Event.find(params[:event_sponsorship].delete(:event_id)) 
```

这将删除参数中的“event_id”，并允许`EventSponsorship.new`正常工作

# php - PHP - 使用选择选项作为数组处理 POST 表单

> ID：15536460
> 
> 赞同：0
> 
> 时间：2013-03-20T23:05:29.387
> 
> 标签：php, arrays, forms, option

我有以下表格，其中有 3 个下拉框，每个额外一个，每个都有一个可以选择的不同“数量”（即 0-1、0-2、0-3）。每个选择的选择名称都相同，但我已将每个选择的 id 传递给它以创建一个数组。

我现在陷入了如何从发布的表格中获取结果的问题？

我需要能够知道选择了哪些额外的值大于 0。所以我需要能够知道选择了多少额外 [1]，有多少额外 [2] 等等。 ..

```
<form action="xxx.php" method="post">
<table width="100%">
<tr>
    <td>
        Option 1
    </td>
    <td>
        &pound;9.99
    </td>
    <td>
        <select name="extra[1]"><option value="0">0</option><option value="1">1</option><option value="2">2</option></select>
    </td>
</tr>

<tr>
    <td>
        Option 2
    </td>
    <td>
        &pound;14.99
    </td>
    <td>
        <select name="extra[2]"><option value="0">0</option><option value="1">1</option></select>
    </td>
</tr>

<tr>
    <td>
        Option 3
    </td>
    <td>
        &pound;24.99
    </td>
    <td>
        <select name="extra[3]"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option></select>
    </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:12:09.007

直接访问有点生疏（用于 Symfony），应该能够引用这样的值（在表单提交之后）：

```
// xxx.php

// Could use $_POST if you want, but I've always used $_REQUEST
$extras = $_REQUEST['extra'];

$extra1 = $extras[1];
$extra2 = $extras[2];
$extra3 = $extras[3]; 
```

# r - 如何在R中绘制规则格子？

> ID：15536465
> 
> 赞同：1
> 
> 时间：2013-03-20T23:05:39.437
> 
> 标签：r, igraph, mathematical-lattices

我是 R 新手，想构建一个具有 30 个节点和 k=4（邻域连通性）的规则格。

我已经尝试了带有 graph.lattice 函数的 igraph 包，但无法生成我正在寻找的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:45:17.593

iGraph 中具有 k = 4 邻域连通性的规则格：

```
require(igraph)
g <- graph.lattice( c(5,6) )
g <- connect.neighborhood(g, 4)
plot(g) 
```

![在此处输入图像描述](../Images/7f52a79eac452de8a83382cff0654ecf.png)

# sencha-touch - Sencha Touch 使 Dataview 动态元素可拖动

> ID：15536467
> 
> 赞同：0
> 
> 时间：2013-03-20T23:05:41.710
> 
> 标签：sencha-touch

我有一个使用商店和模板填充的数据视图，因此该过程是动态的。然后我想让每个容器 Div（见模板）可拖动并使用以下代码。我本来希望容器 divs(image + name) 是可拖动的，但整个 DataView 是可拖动的。想知道我做错了什么？

```
Ext.define('MyApp.view.allImages', {    extend: 'Ext.dataview.DataView',
xtype: 'cams',
requires: [
    'MyApp.store.images'
],
config: {

    title: 'Test',
    store: 'images',
    baseCls: 'camera-list',

    itemTpl: [
        '<div id="camimage">',
            '<div class="image" style="background-image:url({fullimage})"></div>',
            '<div class="name">{address}</div>',
        '</div>'
    ].join(''),
    records: null,
    items: [
        {
            xtype: 'toolbar',
            docked: 'top',
            title: 'Gainesville'
        },
        {
            xtype: 'toolbar',
            docked: 'bottom',
            items: [
                {
                    xtype: 'button',
                    text: 'Path1'
                },
                {
                    xtype: 'button',
                    text: 'Path2'
                },
                {
                    xtype: 'button',
                    text: 'Path3'
                }
            ]
        }
    ]

},
initialize: function () {
    this.callParent(arguments);
    //get the divs that we want to make draggable
    var images = this.element.select("div[id='camimage']");

    Ext.each(images.elements, function (imageElement) {

        imageElement.draggable = true;
    });

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-06T04:56:56.917

这是组件生命周期的问题，您必须等到数据视图渲染后，才能访问元素。

```
initialize: function () {
    this.callParent(arguments);
    var me = this;
    //get the divs that we want to make draggable
    //
    setTimeout(function (argument) {
        var images = me.element.select("div.image-dataview-item");
        Ext.each(images.elements, function (imageElement) {
            var draggable = new Ext.util.Draggable({
                element: imageElement,
                listeners: {
                    dragstart: function(self, e, startX, startY) {
                        console.log("test dragStart[" + startX + ":" + startY + "]");
                    },
                    drag: function(self, e, newX, newY) {
                        console.log("test drag[" + newX + ":" + newY + "]");
                    },
                    dragend: function(self, e, endX, endY) {
                        console.log("test dragend[" + endX + ":" + endY + "]");
                    }
                }
            });
            draggable.setConstraint({
                min: { x: -Infinity, y: -Infinity },
                max: { x: Infinity, y: Infinity }
            });
            draggable.group = 'base';// Default group for droppable
            draggable.revert = true;
        });
    },1000);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T03:00:22.447

您在项目模板上使用硬编码的元素 ID。您最终会得到多个具有相同 ID 的元素。您应该将 camimage 从一个 id 更改为一个类，或者如果您真的附加到您的 ID，请使用记录标识符，以便每个 div ID 都是唯一的。

# java - 将数组更改为字符串而不创建字符串

> ID：15536476
> 
> 赞同：3
> 
> 时间：2013-03-20T23:06:29.687
> 
> 标签：java, arrays, string

我希望完成：

```
 String []beef = new String[3];
    beef[0] = "Water";
    beef[1] = "Chicken";
    beef[2] = "Paper";

    String empo = Arrays.toString(beef);

    if (empo.isEmpty()){
        empo = "Nothing";
        System.out.println(empo);
    }else{
        System.out.println(empo);
    } 
```

无需创建字符串。

就像是：

```
 String []beef = new String[3];
    beef[0] = "Water";
    beef[1] = "Chicken";
    beef[2] = "Paper";

    Arrays.toString(beef);  //change beef to just a plain string

    if(beef.isEmpty()||beef==""){
    no = "Nothing";

    System.out.println(beef); 
```

怎么做呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T23:08:25.803

## 你不能。

Java 是一种[强](http://en.wikipedia.org/wiki/Strong_typing)类型和[静态](http://en.wikipedia.org/wiki/Type_system#Static_typing)类型的语言。这意味着当你声明它时你必须告诉它它是什么类型（强类型），并且在此之后你不能改变它的类型（静态类型）。

您只需要创建一个新的`String`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:09:27.880

您可以创建与原始字符串具有相同后备内存的子字符串，但不能创建与字符串数组具有相同后备内存的字符串。它们的存储顺序不同，因此不可能以两种方式查看相同的内存。

# c# - 将动态标签文本导出到 Excel

> ID：15536482
> 
> 赞同：1
> 
> 时间：2013-03-20T23:07:11.610
> 
> 标签：c#, winforms, visual-studio-2010, excel, export-to-excel

`flowLayoutPanel1`我有一个小程序，可以在我尝试将这些标签的文本导出到 Excel时生成一些动态标签，但我得到的只是最后一个标签的值。

这是我的出口课程：

```
 class Export
    {

        public Export(bool defaultBackgroundIsWhite)
        {
            this.defaultBackgroundIsWhite = defaultBackgroundIsWhite;

            app = new Application();
            app.Visible = true;
            workbook = app.Workbooks.Add(1);
            worksheet = (Worksheet)workbook.Sheets[1];
        }

        public void Do(string excelName, System.Windows.Forms.Label names)
        {
            for (int i = 0; i <= 5; i++)
            {
                    AddNames(i,0,names);
            }
        }

        private void AddNames(int row, int col, System.Windows.Forms.Label lbls)
        {
            if (lbls == null) return;
            row++;
            col++;
            Range range = worksheet.Cells[row + 2, col + 2];
            range.NumberFormat = "";
            worksheet.Cells[row + 2, col + 2] = lbls.Text;
            row--;
            col--;

        }
        private Application app = null;
        private Workbook workbook = null;
        private Worksheet worksheet = null;
        private bool defaultBackgroundIsWhite;
    } 
```

表单类代码：

```
 public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        create();
    }

    Label lbl;
    private void create()
    {
        flowLayoutPanel1.Controls.Clear();
        //int length = ds.Tables[0].Rows.Count;
        for (int i = 0; i < 5; i++)
        {
            lbl = new Label();
            lbl.Name = i.ToString();
            lbl.Text = "Label "+i;
            lbl.Font = new Font(FontFamily.GenericSansSerif, 10, FontStyle.Regular);
            lbl.SetBounds(0, 20, 100, 25);
            lbl.BorderStyle = BorderStyle.FixedSingle;
            flowLayoutPanel1.Controls.Add(lbl);
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        Export ep = new Export(true);
        ep.Do("test.xsl", lbl);
    } 
```

我的结果：

![在此处输入图像描述](../Images/6fc4b3351d0d4eac8d29cf91021b18ce.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:16:46.643

您总是添加最后创建的标签的文本，因为您只是传递它的引用。相反，您应该传递列表，其中包含您希望导出到 Excel 的文本属性的所有标签的引用。更改这些方法：

```
 List<Label> lbls;
    private void create()
    {
        flowLayoutPanel1.Controls.Clear();
        //int length = ds.Tables[0].Rows.Count;
        lbls = new List<Labels>();
        for (int i = 0; i < 5; i++)
        {
            Label lbl = new Label();
            lbl.Name = i.ToString();
            lbl.Text = "Label "+i;
            lbl.Font = new Font(FontFamily.GenericSansSerif, 10, FontStyle.Regular);
            lbl.SetBounds(0, 20, 100, 25);
            lbl.BorderStyle = BorderStyle.FixedSingle;
            flowLayoutPanel1.Controls.Add(lbl);
            lbls.Add(lbl);
        }
    } 
```

还要更改类中的方法`Do`以`Export`接受`List<Label>`代替`Label`：

```
 public void Do(string excelName, List<Label> names)
    {
        for (int i = 0; i <= names.Count; i++)
        {
                AddNames(i,0,names[i]);
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T23:15:35.670

```
List<Label> lbls = new List<Label>();
private void create()
{
    flowLayoutPanel1.Controls.Clear();
    //int length = ds.Tables[0].Rows.Count;
    for (int i = 0; i < 5; i++)
    {
        lbl = new Label();
        lbl.Name = i.ToString();
        lbl.Text = "Label "+i;
        lbl.Font = new Font(FontFamily.GenericSansSerif, 10, FontStyle.Regular);
        lbl.SetBounds(0, 20, 100, 25);
        lbl.BorderStyle = BorderStyle.FixedSingle;
        lbls.Add(lbl);   //< -- add the label to the local list of Labels
        flowLayoutPanel1.Controls.Add(lbl);

    }
}

private void button1_Click(object sender, EventArgs e)
{
    int i = 0;
    Export ep = new Export(true);
    foreach(var lbl in lbls)
    {
        i++;
        ep.AddNames(i,0,lbl);
    }
} 
```

* * *

```
public void AddNames(int row, int col, System.Windows.Forms.Label lbl)
{
if (lbl == null) return;
row++;
col++;
Range range = worksheet.Cells[row + 2, col + 2];
range.NumberFormat = "";
worksheet.Cells[row + 2, col + 2] = lbl.Text;
row--;
col--;

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T23:16:02.417

每次围绕 create() 方法中的 for 循环构建一个新标签，并将该标签分配给同一字段 (lbl)。完成后， lbl 是您创建的最后一个标签。您可以改为将标签添加到列表中，或者将 flowLayoutPanel1.Controls 传递给 go() 方法，前提是您可以确定它只包含您希望导出的标签。

这有点笨重 TBH，并且不推荐如此严重地依赖于 UI 的机制 - 你最好使用一个经过深思熟虑的模型，你的 UI 是数据绑定的，但如果你只想得到完成了，那是你的问题。

# couchdb - 压缩后如何在 _revs_limit 内获取文档的旧版本

> ID：15536484
> 
> 赞同：1
> 
> 时间：2013-03-20T23:07:14.427
> 
> 标签：couchdb, couchdb-futon

所以我在 couchdb wiki 页面上阅读了这个 - *_revs_limit 定义了 CouchDB 跟踪的文档修订的上限，即使在压缩之后也是如此。*

但是，当我尝试检索 _revs_limit 范围内的旧版本（压缩后）时 - 我得到一个 404 Doc Not Found。我只是在 docid 和 old_revid 上做一个 GET

任何人都可以建议即使在压缩之后如何保留/获取文档的“n”个旧版本

[·](https://workaround-for-at-least-6-character-edit-limit)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T02:18:06.770

不，压缩会删除所有以前的修订，并且无法配置。还应该注意的是，修订号不是版本控制的机制，而是纯粹的并发控制/冲突预防。

您需要使用另一种方法来获取文档版本控制，例如[此博客文章](http://nosql.mypopescu.com/post/652783121/document-versioning-in-couchdb)或[此 stackoverflow 答案](https://stackoverflow.com/questions/8274762/best-practice-for-couchdb-document-versioning)中列出的方法。

# c++ - 外部“C”、重载和函数指针可能存在歧义

> ID：15536488
> 
> 赞同：11
> 
> 时间：2013-03-20T23:07:31.647
> 
> 标签：c++, standards

使用正常功能，可以编写

```
extern "C" int Frotz(int);  // in a header

int Frotz(int x) { return x; } 
```

然而，对于函数指针，这似乎在编译器之间的实现不一致。

```
extern "C" int Klutz(int (*)(int), int);

int Klutz(int (*fptr)(int), int x) { return (*fptr)(x); } 
```

在声明中，参数也是`extern "C"`. 在定义中，大多数编译器似乎都匹配这些函数并生成`Klutz`一个`extern "C"`函数。然而，Sun 和 Cray 编译器将这些函数解释为不同的，产生一个重载的`int Klutz(int (*fptr)(int), int x)`，然后产生一个链接时错误。

尽管 C++98 和 C++11 的第 7.5.5 节保证对 的解释`Frotz`，但我无法判断标准是否`extern "C"`应在检查重载之前或之后发生匹配是否模棱两可。

上面应该`Klutz`生成一个损坏的（C++）符号还是一个`extern "C"`符号？

### 编辑 1

我可以使用 typedef 来消除具有 C 或 C++ ABI 的函数指针的歧义，但我感兴趣的是这里的代码 (a) 是否定义`Klutz`为具有 C++ 链接，(b) 将其定义为具有 C 链接，或者 (c)根据标准是模棱两可的，因此编译器可以自由选择如何解释它。

### 编辑 2

这似乎是一个已知问题，至少对于那些带有可搜索错误跟踪器的编译器而言。在我的测试中，GCC、Clang、Intel、MSVC、IBM XL、PathScale、PGI 和 Open64 都无法区分除了语言链接之外相同的函数类型，这是标准明确要求的（参见第 7.5.1 节，引用于接受的答案）。解决这个问题会破坏很多现有代码并需要更改 ABI。我不知道有任何编译器实际上对 C 与 C++ 语言链接使用不同的调用约定。

*   [GCC 错误](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=2316)：“寻找理由要求从下一个标准中删除此功能是相关的 ;-)” ...“我们甚至可能决定使用官方 WONTFIX。”

*   [Clang 错误](http://llvm.org/bugs/show_bug.cgi?id=6277)：“我害怕实际执行此规则，因为正确执行意味着使语言链接成为规范类型的一部分，这将破坏大量代码。”

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T23:38:16.530

不保证 C ABI 和 C++ ABI 相同。因此，`extern "C"`函数指针与 C++ 函数指针是不同的类型。你需要这样的东西：

```
extern "C" {
    typedef int (*KlutzFuncType)(int);
    int Klutz (KlutzFuncType, int);
}

int Klutz (KlutzFuncType fptr, int x) { return (*fptr)(x); } 
```

[这里](https://stackoverflow.com/q/11873939/315052)有一些关于这个问题的讨论。

* * *

我只有一份[草稿](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3242.pdf)。从 7.5p1 开始：

> 具有不同语言链接的两个函数类型是不同的类型，即使它们在其他方面相同。

我对此的解读是，您的 first`Klutz`的第一个参数与您的 second 的第一个参数具有不同的类型`Klutz`，因此您的第二个`Klutz`应该具有 C++ 链接。

* * *

尽管标准规定了什么，但有些 C++ 实现并未考虑函数类型的语言链接。在以下代码片段中，`KlutzCxxFuncType`指的是具有 C++ 链接的函数，而`KlutzCFuncType`指的是具有 C 链接的函数。

```
typedef int (*KlutzCxxFuncType)(int);

extern "C" {
    typedef int (*KlutzCFuncType)(int);
    int Klutz (KlutzCFuncType, int);
}

int Klutz (KlutzCxxFuncType fptr, int x) { return (*fptr)(x); }
int Klutz (KlutzCFuncType fptr, int x) { return (*fptr)(x); } 
```

不根据语言链接区分函数类型的编译器将在此代码上生成重新定义错误。例如，`g++ 4.7.2`将发出：

```
prog.cpp: In function ‘int Klutz(KlutzCFuncType, int)’:
prog.cpp:9:5: error: redefinition of ‘int Klutz(KlutzCFuncType, int)’
prog.cpp:8:5: error: ‘int Klutz(KlutzCxxFuncType, int)’ previously defined here 
```

# mysql - 在 Mysql 中将表转换为特定格式

> ID：15536494
> 
> 赞同：-4
> 
> 时间：2013-03-20T23:07:59.337
> 
> 标签：mysql, sql, database, relational-database

我有一张有 170 万行的表。表结构为 (Datapoint,AttributeName,AttributeValue)。

```
第一列即数据点是这样的：
(1,属性名称1,属性值1)
(1,属性名2.属性值2)
.
.
n次
(2,属性名1,属性值1)
(2,属性名2,属性值2)
.
.
米次
(11113,属性名称1,属性值1)
(11113,属性名称2,属性值2)
.
.
时间
```

我需要在 SQL 中编写一个程序，将上述数据转换为以下格式：

```
（数据点，属性名称 1，属性名称 2，......属性名称）
(1, ,AttributeValue1,AttributeValue2,............)
(2, ,AttributeValue1,AttributeValue2,............)

(11113, ,AttributeValue1,AttributeValue2,............)
```

请让我知道如何去做。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:20:48.503

MySQL 没有数据*透视*函数，但您可以使用带有`CASE`表达式的聚合函数将数据从行转换为列：

```
select datapoint,
  max(case when AttributeName ='AttributeName1' then AttributeValue end) as AttributeName1,
  max(case when AttributeName ='AttributeName2' then AttributeValue end) as AttributeName2,
  max(case when AttributeName ='AttributeName3' then AttributeValue end) as AttributeName3,
  max(case when AttributeName ='AttributeName4' then AttributeValue end) as AttributeName4
from yourtable
group by datapoint 
```

如果您有已知数量的值，上述版本将非常有用。但是，如果您有未知数量的项目要转换为列，那么您将需要使用准备好的语句来生成动态 SQL。您应该查看以下文章：

[动态数据透视表（将行转换为列）](http://buysql.com/mysql/14-how-to-automate-pivot-tables.html)

代码将与此类似：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'max(CASE WHEN AttributeName = ''',
      AttributeName,
      ''' THEN AttributeValue END) AS `',
      AttributeName, '`'
    )
  ) INTO @sql
FROM yourtable;

SET @sql 
  = CONCAT('SELECT datapoint, ', @sql, ' 
           from yourtable
           group by datapoint');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

# javascript - 当注入点是样式属性的值时，是否可能发生 XSS 攻击？

> ID：15536499
> 
> 赞同：4
> 
> 时间：2013-03-20T23:08:20.097
> 
> 标签：javascript, html, css, security, xss

示例代码：

```
<!DOCTYPE html>
<html lang="en">
<head><title>XSS test page</title></head>
<body>
<p>
<?php
  $style = htmlspecialchars($_GET['style']);
  echo '<div style="'.$style.'">This is a style test</div>';
?>
</p>
</body>
</html> 
```

是否可以只使用正确转义的 html 样式属性来注入 javascript 代码？

我听说可以通过 CSS ( [Source 1](http://www.tralfamadore.com/2008/08/xsstc-cross-site-scripting-through-css.html) , [Source 2](http://ajaxian.com/archives/xsstc-cross-site-scripting-through-css-data) ) 触发 XSS 攻击。

我想知道这是否也可以通过 style 属性实现。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T00:33:00.370

我已经在问题的评论部分指出了这一点，但我认为它更适合作为实际答案。

**CSS**

除了实际的 XSS 威胁之外，将用户输入传递给页面上的样式标签会为攻击者打开一整套其他机会，其中一些只是使用纯 css。

通过将元素设置为`position: absolute;`，可以用它覆盖整个页面。这可以用来使其无法使用（`opacity:0;`例如），或者攻击者可以使用它来破坏整个页面。通过使用 和 之类的 CSS3 属性`:before`，`:after`它们甚至能够通过 CSS 将内容放在您的页面上。

另一个结果可能是“点击劫持”，这实际上已经[在 StackOverflow 上](https://stackoverflow.com/questions/4546591/xss-attacks-and-style-attributes)讨论过了。

**跨站脚本**

但是，对于纯 XSS，很难在现代浏览器上使用它，但我不会说这是不可能的。无论如何，在较旧的浏览器（例如 Internet Explorer 7）上，这可能会被用于攻击。已经有非常有创意的 XSS 注入，它们以最疯狂的方式进行混淆和解码以智取输入验证，这仍然会在几个（现在）旧浏览器上成功，因为它们仍在解析它。考虑到这一点，现代浏览器的问题变得更好了。

此外，还有 where 和 之类的函数`expression()`，`background-image:url`这使得在旧版本的 Firefox、IE7 和更早版本以及可能的其他一些浏览器中可以在 CSS 中执行脚本。

[OWASP XSS 预防备忘单](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet#STYLE_attribute_using_a_comment_to_break_up_expression)实际上列出了一个示例，其中这些函数用于样式 - 标记和样式 - 属性。

**无脚本攻击**（可能也适用于现代浏览器！）

抛开旧浏览器和 XSS 不谈，这里还有其他可能适用的方式，主要是“无脚本攻击”的形式。深入细节会扩大这里的范围，但是[关于这个主题有一个很好的演示](http://de.slideshare.net/x00mario/stealing-the-pie)，提供了几种方法和很好的例子，说明即使是现代浏览器也会受到影响。另一个例子是[这篇博客文章](http://securethoughts.com/2009/07/hacking-csrf-tokens-using-css-history-hack/)，其中 CSS 用于跨站点请求伪造。（非常感谢@BenjaminGruenbaum 提供链接）

最后，为了更深入地了解聪明的攻击者在脚本插入方面的疯狂程度，我建议浏览[http://www.thespanner.co.uk/](http://www.thespanner.co.uk/)。例如，甚至[在 style-attribute 上还有一个非常狂野的 XSS 示例](http://www.thespanner.co.uk/2007/11/26/ultimate-xss-css-injection/)，据说可以在“在 IE7 和 Firefox（未给出版本）”上工作。

所以，在做这样的事情时要小心，人们可能仍然会找到办法......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:24:08.093

这取决于浏览器。例如，IE 在 CSS 和样式标签中通过[表达式](http://msdn.microsoft.com/en-us/library/ms537634%28v=vs.85%29.aspx)关键字编写脚本。谢天谢地，这在 IE8 中消失了。

根据我有限的 PHP 知识，您正在做的事情很好；htmlspecialchars() 在您将其用于用引号括起来的属性值时起作用。如果你把引号去掉，`<div style='.$style.'>`那么你就陷入了一个麻烦的世界。

# c# - 如何解决温莎城堡中的代理类

> ID：15536507
> 
> 赞同：1
> 
> 时间：2013-03-20T23:08:54.647
> 
> 标签：c#, wcf, castle-windsor, wcffacility

我有一个 WCF 服务，我正在尝试使用 Castle Windsor 来解决它。以前的注册是这样的：

```
container.Register(Component.For<IBatchDataService>()
.AsWcfClient(WCFEndpoint
.FromConfiguration("Internal.IBatchDataService"))
.LifestyeTransient()) 
```

现在我创建了一个存在于进程中的代理。它公开相同的接口 (IBatchDataService) 并将 WCF 服务的引用作为构造函数参数。如何在 Windsor 中进行设置，以便将任何其他类解析为使用代理类，但代理类解析为 WCF 服务。我现在有这个：

```
container.Register(Component.For<IBatchDataService>()
.ImplementedBy<BatchDataServiceClient>()); 
```

这应该解决新的代理类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T07:28:13.283

试试这个：

```
container.Register(
    Component.For<IBatchDataService>().AsWcfClient(WCFEndpoint.FromConfiguration("Internal.IBatchDataService")).LifestyeTransient().Named("wcfBatchDataService"),
    Component.For<IBatchDataService>().ImplementedBy<BatchDataServiceClient>().AsDefault().DependsOn(
        Dependency.OnComponent("constructorParameterName", "wcfBatchDataService")
) 
```

其中 constructorParameterName 是构造函数上的 IBatchDataService 参数的名称。我没有在编译器中运行它，所以如果这对你有用，请告诉我。

亲切的问候，马尔维恩。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:26:28.333

它只是一个装饰器模式。温莎支持它的 OOTB：

```
container.Register(
    Component.For<IBatchDataService>().
        ImplementedBy<BatchDataServiceClient>(),
    Component.For<IBatchDataService().
        AsWcfClient(WCFEndpoint.FromConfiguration("Internal.IBatchDataService")).
        LifestyleTransient()); 
```

# c# - ASP.net MVC 上传图片 NullReferenceException

> ID：15536508
> 
> 赞同：0
> 
> 时间：2013-03-20T23:09:00.860
> 
> 标签：c#, asp.net-mvc, entity-framework, file-upload, nullreferenceexception

我已经实现了简单的创建方法来将数据放入数据库，并且效果很好。我决定添加图片上传，但我不断收到 NullReferenceException（文件为空），我不知道为什么。我希望你能帮帮我！

这是我的代码：

```
[Authorize]
    public ActionResult Create()
    {
        ViewBag.CategoryId = new SelectList(_categoryRepository.GetAllCategories().AsEnumerable(), "CategoryId",
                                            "Name");
        return View();
    }

    //
    // POST: /Advert/Create

    [HttpPost, Authorize]
    public ActionResult Create(CompetitionDTO competitionDTO, HttpPostedFileBase file)
    {
        if (file.ContentLength > 0)
        {
            string fileName = Path.GetFileName(file.FileName);
            string fileExtension = Path.GetExtension(fileName);
            if ((fileExtension == ".jpg") || (fileExtension == ".png"))
            {
                string path = Path.Combine(Server.MapPath("~/Uploads/Images"), fileName);
                file.SaveAs(path);
                competitionDTO.ImageURL = path;
            }
        }
        if (ModelState.IsValid)
        {
            _competitionRepository.AddCompetition(competitionDTO, WebSecurity.CurrentUserId);

            return RedirectToAction("Index");
        }

        ViewBag.CompetitionId = new SelectList(_competitionRepository.GetAllCompetitions().AsEnumerable(),
                                               "CompetitionId", "Name");

        return View(competitionDTO);
    }
} 
```

和查看

```
<div>
        @using (Html.BeginForm("Create", "Competition", FormMethod.Post, new
            {
                enctype = "multipart/form-data"
                , id = "parentForm"
            }))
        {
            <input type="file" name="file" id="file"/>
            <input type="submit" value="Create" />
        }
    </div> 
```

**编辑**

如果我不够清楚，我：

我知道如何将数据插入数据库，我知道如何上传文件，我希望当我点击提交时，这两件事同时发生

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:00:06.727

这是我的错误，我有两个 Html.BeginForms，现在我将它们合并为一个，它工作正常

# file - tcl 文件重命名并在文件存在时捕获错误

> ID：15536509
> 
> 赞同：0
> 
> 时间：2013-03-20T23:09:01.233
> 
> 标签：file, try-catch, tcl, rename

我是新手，我正在尝试将 .skip 扩展名附加到从 TCL 中的文件名列表中获取的一些文件中。如果已经存在带有 fileName.skip 的文件，我想捕捉错误，将我自己的消息放在屏幕上，然后继续下一个文件。这是我正在使用的代码：

```
set i 0
foreach fileName [glob -nocomplain -type f [file join $basedir *.wav]] {
    foreach line $fileData {
        if { [regexp $line $fileName] == 1 } {
            if { [catch {file rename $fileName "$fileName.skip"}] } {
                puts "Error skipping $fileName skipped file already exists"
                continue
            } else {
                puts "Skipping $fileName..."
                file rename [file join $basedir $fileName] [file join $basedir "$fileName.skip"]
                incr i
            }
        }
    }   
} 
```

我的文件夹中有三个要测试的文件：

```
test21.wav
test21.wav.skip
test22.wav 
```

此代码执行到重命名（或不重命名）文件的位置，然后将其打印到屏幕上：

```
Error skipping C:/xxx/test21.wav file already exists
Skipping C:/xxx/test22.wav...
error renaming "C:/xxx/test22.wav": no such file or directory
    while executing
"file rename $fileName "$fileName.skip"" 
```

我似乎无法弄清楚这个错误是关于什么的，因为脚本有效。是我用`catch`错了吗？或者也许是别的什么......

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:17:40.820

你为什么不先看看它是否存在？

```
set i 0
foreach fileName [glob -nocomplain -type f [file join $basedir *.wav]] {
    foreach line $fileData {
        if {[regexp $line $fileName]} {
            if {[file exists "$fileName.skip"]} {
                puts "Error skipping $fileName -- skipped file already exists"
                continue
            } else {
                puts "Skipping $fileName..."
                set filepath [file join $basedir $fileName]
                file rename $filepath $filepath.skip
                incr i
            }
        }
    }   
} 
```

由于它似乎`$fileData`包含一个字符串列表，因此您不需要内部 foreach 循环。[`lsearch`](http://tcl.tk/man/tcl8.5/TclCmd/lsearch.htm)将在这里工作：

```
set i 0
foreach fileName [glob -nocomplain -type f [file join $basedir *.wav]] {
    if {[lsearch -regexp $fileData $fileName] != -1} {
        if {[file exists "$fileName.skip"]} {
            puts "Error skipping $fileName -- skipped file already exists"
        } else {
            puts "Skipping $fileName..."
            set filepath [file join $basedir $fileName]
            file rename $filepath $filepath.skip
            incr i
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:43:28.633

您将文件重命名了两次：一次在`if`命令中，另一次在 else 块中。您不需要`file rename`else 块中的命令。

该`catch`命令的工作方式是这样的：

1.  执行代码块
2.  如果执行失败，返回1。如果执行成功，返回0

因此，在您的上下文中：

```
set i 0
foreach fileName [glob -nocomplain -type f [file join $basedir *.wav]] {
    foreach line $fileData {
        if { [regexp $line $fileName] == 1 } {
            if { [catch {file rename $fileName "$fileName.skip"}] } {
                # Rename failed
                puts "Error skipping $fileName skipped file already exists"
            } else {
                # Renamed OK
                puts "Skipping $fileName..."
                incr i
            }
        }
    }   
} 
```

# c++ - C++：向量实现和动态内存分配

> ID：15536515
> 
> 赞同：3
> 
> 时间：2013-03-20T23:09:17.763
> 
> 标签：c++, dynamic-memory-allocation

我想了解如何`vector`在 C++ 中实现。以前有一个[问题](https://stackoverflow.com/questions/5159061/implementation-of-vector-in-c)问过这个，所以我看了一下，我有一个小问题。假设链接问题中的实现是正确的，让我们看一下这段代码：

```
int main(){
    Vector<int> test2 = test_Vector();
    cout << test2[0] << endl;
    return 0;
}

// below is NOT the STL vector object, but the one in the linked question,
// in which the asker tries to implement STL vector himself/herself 
Vector<int> test_Vector(){
    Vector<int> test;
    test.push_back(5);
    return test;
} 
```

据我了解，`test` `Vector`对象是在本地创建的，因此当`test_Vector`方法返回时，本地对象超出范围，从而调用析构函数并 -`delete`动态数组。由于代码实际上有效并且打印了 5，我想我错了。正确的解释是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:13:41.090

你是对的，但你错过了一件重要的事情。

因为您要返回 a `Vector<int>`，所以您应该将其视为被复制。这通常会调用复制构造函数，该构造函数复制`test`到`Vector<int>`. 复制构造函数在链接问题中实现为：

```
template<class T>
Vector<T>::Vector(const Vector<T> & v)
{
    my_size = v.my_size;
    my_capacity = v.my_capacity;
    buffer = new T[my_size];  
    for (int i = 0; i < my_size; i++)
        buffer[i] = v.buffer[i];  
} 
```

请注意，由于返回值优化，可能不会调用复制构造函数（请参阅下面评论中的头发分裂）。在许多情况下，编译器可以优化复制，而 C++ 标准允许这种优化*可能会改变程序行为*。

无论是复制对象，还是应用 RVO，您最终都应该得到相同的结果。如果您遵循正常的面向对象实践，优化不应破坏您的对象。

*无论类型如何，您都应该始终考虑按值（即*复制）传递的函数返回值，然后考虑您的编译器可能正在执行 RVO。重要的是不要忘记[三](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)（或四或五）规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:14:15.803

他提供了一个公共的复制构造函数（从技术上讲，他*没有*将复制构造函数设为私有），因此标准的 C++ 逻辑开始执行并制作对象的副本以返回。新对象是本地的`main`。在复制构造函数内部，`malloc`编辑新内存并复制数据。如果他没有提供复制构造函数，它将访问无效内存（尝试从已释放的指针访问内存）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T23:14:47.020

当`test`返回时，它的复制构造函数被调用（理论上），它分配一个新的内存块并复制`test`. `test`s 堆栈上的原始`test_Vector`数据被破坏（理论上）`test2`并被分配副本，这意味着将调用赋值运算符（理论上），它将再次分配内存并从返回时创建的临时对象复制数据。从 then 返回的临时对象`test_Vector`的析构函数称为（理论上）。

如您所见，如果没有编译器优化，这就是地狱 :) 如果您不做任何过于巴洛克的事情并且编译器很聪明并且您的情况就是这么简单，则可以跳过“理论上”。有关C++11 的一些更新，请参阅[此内容。](http://www.cprogramming.com/c++11/rvalue-references-and-move-semantics-in-c++11.html)

# ruby - Heroku：未找到并退出进程

> ID：15536516
> 
> 赞同：2
> 
> 时间：2013-03-20T23:09:21.107
> 
> 标签：ruby, deployment, heroku, sinatra, thin

我不确定如何调试它。在本地运行这个 ruby​​/sinatra/thin 应用程序我没有任何问题。然而，在 Heroku 上，应用程序似乎没有加载，显示“未找到。”。我不确定如何理解日志：

```
2013-03-20T22:27:41+00:00 heroku[api]: Enable Logplex by mymail@gmail.com
2013-03-20T22:27:41+00:00 heroku[api]: Release v2 created by mymail@gmail.com
2013-03-20T22:28:04+00:00 heroku[router]: at=info code= desc="Blank app" method=GET path=/ host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno= queue= wait= connect= service= status=502 bytes=
2013-03-20T22:28:05+00:00 heroku[router]: at=info code= desc="Blank app" method=GET path=/favicon.ico host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno= queue= wait= connect= service= status=502 bytes=
2013-03-20T22:28:05+00:00 heroku[router]: at=info code= desc="Blank app" method=GET path=/favicon.ico host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno= queue= wait= connect= service= status=502 bytes=
2013-03-20T22:37:08+00:00 heroku[slugc]: Slug compilation started
2013-03-20T22:37:59+00:00 heroku[api]: Scale to web=1 by mymail@gmail.com
2013-03-20T22:37:59+00:00 heroku[api]: Add  config by mymail@gmail.com
2013-03-20T22:37:59+00:00 heroku[api]: Release v3 created by mymail@gmail.com
2013-03-20T22:38:00+00:00 heroku[api]: Release v4 created by mymail@gmail.com
2013-03-20T22:38:00+00:00 heroku[api]: Deploy 0a18d12 by mymail@gmail.com
2013-03-20T22:38:00+00:00 heroku[web.1]: Starting process with command `bundle exec rackup config.ru -p 33969`
2013-03-20T22:38:00+00:00 heroku[slugc]: Slug compilation finished
2013-03-20T22:38:01+00:00 app[web.1]: bash: bundle: command not found
2013-03-20T22:38:02+00:00 heroku[web.1]: Process exited with status 127
2013-03-20T22:38:09+00:00 heroku[web.1]: State changed from starting to up
2013-03-20T22:38:19+00:00 heroku[router]: at=info method=GET path=/ host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno=web.1 queue=0 wait=0ms connect=3ms service=79ms status=404 bytes=18
2013-03-20T22:38:21+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno=web.1 queue=0 wait=13ms connect=12ms service=69ms status=404 bytes=18
2013-03-20T22:38:21+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno=web.1 queue=0 wait=0ms connect=2ms service=21ms status=404 bytes=18
2013-03-20T22:50:19+00:00 heroku[slugc]: Slug compilation started
2013-03-20T22:51:01+00:00 heroku[api]: Release v5 created by mymail@gmail.com
2013-03-20T22:51:01+00:00 heroku[api]: Deploy e18aad6 by mymail@gmail.com
2013-03-20T22:51:01+00:00 heroku[web.1]: State changed from up to starting
2013-03-20T22:51:02+00:00 heroku[slugc]: Slug compilation finished
2013-03-20T22:51:09+00:00 heroku[web.1]: State changed from starting to up
2013-03-20T22:52:32+00:00 heroku[router]: at=info method=GET path=/ host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno=web.1 queue=0 wait=1ms connect=6ms service=11ms status=404 bytes=18
2013-03-20T22:52:33+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno=web.1 queue=0 wait=0ms connect=2ms service=5ms status=404 bytes=18
2013-03-20T22:52:33+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno=web.1 queue=0 wait=1ms connect=4ms service=4ms status=404 bytes=18
2013-03-20T22:52:34+00:00 heroku[router]: at=info method=GET path=/ host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno=web.1 queue=0 wait=0ms connect=4ms service=4ms status=404 bytes=18
2013-03-20T22:52:35+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno=web.1 queue=0 wait=0ms connect=12ms service=4ms status=404 bytes=18
2013-03-20T22:52:35+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=ancient-kings-2615.herokuapp.com fwd="92.225.106.224" dyno=web.1 queue=0 wait=2ms connect=5ms service=4ms status=404 bytes=18 
```

有任何想法吗？

**21.3.2013 更新**

我的宝石文件

```
source "http://rubygems.org"

# Sinatra
gem "rake"
gem "thin"
gem "sinatra", "~> 1.3.4"
gem "sinatra-contrib", "~> 1.3.1"
gem 'sinatra-assetpack', :require => 'sinatra/assetpack'

# Sass
gem "sass", "~> 3.2.1"

# Mailing related
gem "hominid", "~> 3.0.5"

# Google Analytics: UNCOMMENT IF DESIRED, THEN ADD YOUR OWN ACCOUNT INFO TO config.ru
#gem 'rack-google-analytics', "~> 0.9.2" 
```

我的 config.ru

```
require 'rubygems'
require 'bundler'

Bundler.require

require './app.rb'
run Sinatra::Application 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T00:51:45.410

我克隆了 repo，但无法通过 运行它`rackup`，这是 Heroku 运行应用程序所依赖的。当直接通过 Ruby 运行 Sinatra 应用程序时，它确实有效。以下是我所做的更改，使其可以使用`rackup`：

### 配置.ru

```
require 'rubygems'
require 'bundler'

Bundler.require

require File.expand_path 'app.rb', File.dirname(__FILE__)
run App 
```

[如果你有子类，运行子类，否则使用 Sinatra::Application](http://sinatra-book.gittr.com/#heroku)

我还删除了**所有**`$:.unshifts`我发现的东西，因为它们是邪恶的。

# java - Tomcat JDBC 池连接全部卡在 Socket Read 上，没有创建新连接

> ID：15536518
> 
> 赞同：4
> 
> 时间：2013-03-20T23:09:24.857
> 
> 标签：java, mysql, jsp, jakarta-ee, tomcat

我有一个托管在 Amazon ElasticBeanstalk 上的 Tomcat 7 应用程序，以及一个托管在 Amazon RDS 上的 MySQL 5.5 数据库。数据库服务器仅服务于一个 Tomcat 应用程序，并且最大连接限制设置为 10,000。

然而，在几个小时的正常运行时间之后，数据库连接发生了奇怪的事情。

MySQL 服务器报告 Tomcat JDBC 连接池只创建了 3 个连接，它们都在“休眠”（示例输出）：

```
| 228 | root     | ip-10-240-xx-xxx.ap-southeast-2.compute.internal:33270 | xxxxx | Sleep   |   13 |       | NULL             | 
```

Tomcat 线程转储建议所有 3 个连接都从网络 IO 套接字读取（阻塞）：

```
at java.net.SocketInputStream.socketRead0(Native Method)
        at java.net.SocketInputStream.read(SocketInputStream.java:150)
        at java.net.SocketInputStream.read(SocketInputStream.java:121)
        at com.mysql.jdbc.util.ReadAheadInputStream.fill(ReadAheadInputStream.java:114)
        at com.mysql.jdbc.util.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:161)
        at com.mysql.jdbc.util.ReadAheadInputStream.read(ReadAheadInputStream.java:189)
        - locked <0x00000000bc349cc0> (a com.mysql.jdbc.util.ReadAheadInputStream)
        at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:3036) 
```

由于连接池中只有 3 个 DB 连接并且它们都卡在 IO 读取上，因此 Tomcat 拒绝服务任何需要 DB 数据的 HTTP 请求。

Tomcat JDBC 池设置已分配：

```
maxActive="500"
maxIdle="100"
minIdle="50"
initialSize="50"
maxWait="15000"
timeBetweenEvictionRunsMillis="10000"
minEvictableIdleTimeMillis="30000"
removeAbandoned="true"
removeAbandonedTimeout="120000"
logAbandoned="true"
testOnBorrow="true"
testWhileIdle="true"
validationQuery="select 1"
driverClassName="com.mysql.jdbc.Driver"
factory="org.apache.tomcat.jdbc.pool.DataSourceFactory" 
```

仍然不确定为什么所有 3 个数据库连接都卡在网络 IO 读取中，但是鉴于上面的配置，我希望 Tomcat 在所有现有连接都忙时创建额外的连接。

我有 8 个其他 Beanstalk 应用程序使用相同的设置，但是只有这个特定的应用程序有这种奇怪的池行为和网络 IO 问题。

你有什么建议？

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:14:20.130

正如[http://bugs.mysql.com/bug.php?id=31353](http://bugs.mysql.com/bug.php?id=31353)上的建议，您可能遇到了不安全的线程问题。

# ruby-on-rails - 在 Rails 3 中提交 AJAX 表单后更新部分的最有效方法是什么

> ID：15536527
> 
> 赞同：1
> 
> 时间：2013-03-20T23:10:01.080
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, forms, partial

我有一个页面，代码如下：

```
<div>
<%= render 'form' %>
</div>

<div id="item_container">
<%= render @item %>  
</div> 
```

其中 form 是“@item”的表单，“render @item”呈现代表“@item”的部分。该表单使用 remote: :true 并使用 AJAX 提交。

在提交表单时，rails 3 中更新整个 @item 部分的最简单和最有效的方法是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T23:13:50.153

在您的控制器操作中，您需要添加一个 respond_to 块

```
respond_to do |format|
  format.html
  format.js
end 
```

并且您可以编写一个直接在其中编写 javascript 代码的视图（假设您的操作名称是“更新”）

**更新.js.erb**

```
$('#item_container').html('<%= j render(@item) %>'); 
```

注意 JS 响应转义的 'j'

# sql - 如何执行“ALL-TO-ALL”关系？

> ID：15536529
> 
> 赞同：3
> 
> 时间：2013-03-20T23:10:12.617
> 
> 标签：sql, sql-server, database, many-to-many

假设我有以下结构（SQL Server 语法）：

```
CREATE TABLE A (
   key_A int NOT NULL PRIMARY KEY CLUSTERED,
   info_A nvarchar(50) NULL
);

CREATE TABLE B(
   key_B int NOT NULL PRIMARY KEY CLUSTERED,
   info_B nvarchar(50) NULL
);

CREATE TABLE C(
   key_C int NOT NULL PRIMARY KEY CLUSTERED,
   key_A int NOT NULL,
   key_B int NOT NULL,
   info1 nvarchar(50) NULL,
   info2 nvarchar(50) NULL,
   info3 nvarchar(50) NULL
);
ALTER TABLE C WITH CHECK ADD  CONSTRAINT FK_C_A FOREIGN KEY(key_A) REFERENCES A (key_A);
ALTER TABLE C WITH CHECK ADD  CONSTRAINT FK_C_B FOREIGN KEY(key_B) REFERENCES B (key_B); 
```

所以，表 C 有两个表 A 和表 B 的主键。表 C 必须有表 A 和表 B 的笛卡尔积。这意味着所有组合，所以当在表 A 中插入新记录时，我们必须插入在表 C 中的几行与 B 中的所有行在 A 中的新引用。反之亦然，在 B 中插入的情况下。

问题是，如何在 SQL Server 中强制这种关系的完整性，其中表 C 必须具有 A 和 B 的所有组合？或者，如果您认为这样的结构是一种不好的做法，您建议使用哪些替代表来避免增加必须进行 DISTINCT 选择等的麻烦？

谢谢！

链接到小提琴： [小提琴](http://sqlfiddle.com/#!3/aa289)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:26:24.477

您需要先插入到表 A / B 中，然后才能在表 C 中引用这个新条目。我知道的唯一方法是在表 A 和 B 上创建触发器，以在对表 C 进行新条目时填充表 C那些表。问题是你在其他领域投入了什么？由于这些是可空的，我假设您很高兴将它们默认为空？如果不是（即您希望用户输入有效值），那么执行此操作的唯一方法是在您的应用程序的逻辑中，而不是在数据库级别（或通过使用存储过程来填充这些 procs 具有合适逻辑的表除了 A / B) 之外，在 C 中创建适当的条目。

触发代码示例：

```
use StackOverflowDemos
go
if OBJECT_ID('TRG_C_DELETE','TR') is not null drop trigger TRG_C_DELETE
if OBJECT_ID('TRG_A_INSERT','TR') is not null drop trigger TRG_A_INSERT
if OBJECT_ID('TRG_B_INSERT','TR') is not null drop trigger TRG_B_INSERT
if OBJECT_ID('C','U') is not null drop table C
if OBJECT_ID('A','U') is not null drop table A
if OBJECT_ID('B','U') is not null drop table B
go

CREATE TABLE A 
(
   key_A int NOT NULL IDENTITY(1,1) CONSTRAINT PK_A PRIMARY KEY CLUSTERED,
   info_A nvarchar(50) NULL
);
go

CREATE TABLE B
(
   key_B int NOT NULL IDENTITY(1,1) CONSTRAINT PK_B PRIMARY KEY CLUSTERED,
   info_B nvarchar(50) NULL
);
go

CREATE TABLE C
(
   key_C int NOT NULL IDENTITY(1,1) CONSTRAINT PK_C PRIMARY KEY CLUSTERED,
   key_A int NOT NULL CONSTRAINT FK_C_A FOREIGN KEY(key_A) REFERENCES A (key_A),
   key_B int NOT NULL CONSTRAINT FK_C_B FOREIGN KEY(key_B) REFERENCES B (key_B),
   info1 nvarchar(50) NULL,
   info2 nvarchar(50) NULL,
   info3 nvarchar(50) NULL
);
go

CREATE TRIGGER TRG_A_INSERT 
ON A 
AFTER INSERT
AS
BEGIN

    --add new As to C
    insert C (key_A, key_B)
    select key_A, key_B
    from inserted
    cross join B

END;
go

CREATE TRIGGER TRG_B_INSERT 
ON B 
AFTER INSERT
AS
BEGIN

    --add new As to C
    insert C (key_A, key_B)
    select key_A, key_B
    from inserted
    cross join A

END;
go

CREATE TRIGGER TRG_C_DELETE
ON C 
AFTER DELETE
AS
BEGIN

    DELETE 
    FROM B
    WHERE key_B IN
    (
        SELECT key_B
        FROM DELETED d
        --ths row onwards are here to cover the circumstance that the record being deleted isn't the only instance of B in this table
        WHERE key_B NOT IN 
        (
            SELECT key_B 
            FROM C
            WHERE C.key_C NOT IN
            (
                SELECT key_C 
                FROM deleted 
            )
        )
    )

    DELETE 
    FROM A
    WHERE key_A IN
    (
        SELECT key_A
        FROM DELETED d
        --ths row onwards are here to cover the circumstance that the record being deleted isn't the only instance of A in this table
        WHERE key_A NOT IN 
        (
            SELECT key_A 
            FROM C
            WHERE C.key_C NOT IN
            (
                SELECT key_C 
                FROM deleted 
            )
        )
    )

END;
go
insert A select 'X'
select * from C --no results as no Bs yet
insert A select 'Y'
select * from C --no results as no Bs yet
insert B select '1'
select * from C --2 results; (X,1) and (Y,1)
insert A select 'Z'
select * from C --3 results; the above and (Z,1)
delete from A where info_A = 'Y'
select * from C --3 results; as above since the previous statement should fail due to enforced referential integrity
insert C (key_A, key_B, info1) 
select a.key_A, b.key_B, 'second entry for (Y,1)'
from A
cross join B
where a.info_A = 'Y'
and b.info_B = '1'
select * from C --4 results; as above but with a second (Y,1), this time with data in info1
delete from C where info1 = 'second entry for (Y,1)'
select * from C --3 results; as above but without the new(Y,1)
select * from A --3 results
select * from B --1 result
delete from C where key_A in (select key_A from A where info_A = 'Y')
select * from C --2 results; (X,1) and (Z,1)
select * from A --2 results; X and Z
select * from B --1 result
delete from C where key_B in (select key_B from B where info_B = '1')
select * from C --0 results
select * from A --0 results
select * from B --0 result 
```

此处的 SQL Fiddle 演示（注意：只有 SQL Fiddle 仅显示表 C 的输出；错误演示也已被注释掉，因为这会导致整个错误，而不仅仅是一个错误行）。 [http://sqlfiddle.com/#!3/34d2f/4](http://sqlfiddle.com/#!3/34d2f/4)

# facebook - Facebook og 修复在 sharer.php 中仅显示一个缩略图

> ID：15536530
> 
> 赞同：1
> 
> 时间：2013-03-20T23:10:14.803
> 
> 标签：facebook, facebook-opengraph, facebook-sharer

我想通过sharer.php分享一个只有一张图片的缩略图的视频

我知道大多数人使用具有灵活 UI 的 Feed 对话框，但在这种情况下我需要高级选项。

`og:image`一个对话框看起来像这样，我希望在相对页面上只有一个我指定的缩略图

![在此处输入图像描述](../Images/db70bfb778994326e76f426f5d57d5b7.png)

我的 OG 标签如下所示：

```
<meta property="fb:admins" content="*admins*" />
<meta property="fb:app_id" content="*app_id*" />

<meta property="og:type" content="movie" /> 
<meta property="og:video:height" content="*height*" /> 
<meta property="og:video:width" content="*width*" /> 
<meta property="og:video:type" content="application/x-shockwave-flash" />
<meta property="og:title" content="*title*" /> 
<meta property="og:description" content="*description*" />
<meta property="og:image" content="*image*" /> 
<meta property="og:url" content="*url*" />
<meta property="og:video" content="*video*" /> 
```

我使用一个基本功能来调用**共享此链接**对话框

```
u = $(*link*).html();
t = $(*name*).html();
window.open('http://www.facebook.com/sharer.php?u='+encodeURIComponent(u)+'&t='+encodeURIComponent(t),'sharer','toolbar=0,status=0,width=*width*,height=*height*');
return false; 
```

我的问题是如何修改我的代码/添加代码以只有 1 个缩略图而不是`1 of 2`消息

我尝试更改我的代码，删除 og:url，检查 og:image 等，使用 facebook 调试器清除其缓存。我在网上也找不到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-03T19:31:39.657

我被告知您必须将 (meta property="og:image" content=" *image* " /) 中的代码修改为 (meta property="og:image" content="http://www.yoursite.location图像”/)

我亲自搞砸了几天，终于完成了！我这样做的方式是将我希望 FB 用于我的网站的图像发布到我的服务器。然后，在我的浏览器中，我右键单击新发布的图像并选择“复制图像位置”。然后我将上面的代码添加到页眉标签之间的页面 html 中，并将**复制的图像位置粘贴**在引号之间。确保您的图像至少为 200 x 200 像素 - 他们说越大越好，但不能超过 5MB。我在让 FB 选择我指定的图像时遇到了很多麻烦，因为我把它弄得太小了。通过将图像大小调整为 1000x712，我终于获得了成功，并且它正在工作。

就我而言，Facebook 仍然没有将我指定的图像识别为我想要使用的唯一图像，但我也被告知 FB 将每 24 小时“抓取”我的网站，希望一旦完成，多图像选项会消失。希望这可以帮助。

# ios - iOS UISegmentedControl 无法以编程方式定位

> ID：15536536
> 
> 赞同：2
> 
> 时间：2013-03-20T23:10:51.730
> 
> 标签：ios, objective-c

我无法更改 UISegmentedControl 的位置。如果我这样做：

```
segControl2.frame = CGRectMake( segControl1.origin.x, segControl2.origin.y, segControl2.size.width, segControl2.size.height); 
```

没有什么真正改变，每个人都说改变控件的框架应该可以做到，但事实并非如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T03:05:24.297

```
CGRect frame = [[UIScreen mainScreen] bounds];
UISegmentedControl *segControl = [[UISegmentedControl] initWithItems:[NSArray alloc] initWithObjects:@"One", @"Two", @"Three", nil];
segControl.frame = CGRectMake(frame.origin.x + 50, frame.origin.y + 50, segControl.size.width, segControl.size.height);
[view addSubview:segControl]; 
```

应该工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T05:41:10.960

要在添加为子视图后更改任何元素的位置，可以使用以下命令：

```
CGRect frame = segControl2.frame;
frame.origin.x = segControl1.frame.origin.x;
// for changes to other properties, do likewise. if no changes, don't do anything
frame.origin.y = ...

segControl2.frame = frame; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-19T17:56:03.363

这可以是“自动布局”，您可以尝试以编程方式创建 UISegmentedControl。

# tomcat - 浏览器失去与 Tomcat 服务器的连接

> ID：15536537
> 
> 赞同：0
> 
> 时间：2013-03-20T23:10:53.867
> 
> 标签：tomcat

我正在向 tomcat 服务器（版本 7.0.32）发送请求。当服务器处理请求时，浏览器会失去与服务器的连接。我尝试将 server.xml 中的 connectionTimeout 值从 20000 增加到 80000，但 5 分钟后仍然显示浏览器中的连接丢失。

我需要在其他地方进行更改还是需要处理其他任何事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:26:50.270

出色地，

首先，确保从浏览器到服务器的连接正在失去连接，而不是服务器与其中一个资源失去连接。多年来与 Tomcat 反复合作，我知道有时很难从 Tomcat 日志中的错误输出中确定问题的核心问题。

有几件事可以检查我的经验。对于浏览器-服务器连接：

1.  连接超时
2.  接受计数
3.  minSpareThreads

然后，如果与特定资源失去连接是一个问题：

1.  最大等待
2.  最大活动
3.  最大空闲
4.  removeAbandonedTimeout

希望有帮助。让我们知道。

# unit-testing - 测试 Ember 数据 - 在测试运行期间切换到 FixtureAdapter

> ID：15536543
> 
> 赞同：1
> 
> 时间：2013-03-20T23:11:25.493
> 
> 标签：unit-testing, ember.js

我有[一个 ember.js 应用程序](https://github.com/balanced/balanced-dashboard/blob/test)，我正在设置`DS.Store`这样的应用程序（[查看实际代码](https://github.com/balanced/balanced-dashboard/blob/test/app/models/store.js)）：

```
(function (app) {
    'use strict';

    ...

    var store = DS.Store.extend({
        revision: 12
    });

    app.Store = store;

})(window.Balanced); 
```

现在我有一个 qunit 测试，在那个测试中，我想将默认的 RESTAdapter 换成 FixtureAdapter，这样我就可以为我的模型设置夹具。我想我需要写[这样的东西，](https://github.com/balanced/balanced-dashboard/blob/test/test/models/store_test.js)但我不是 100% 确定：

```
(function () {
    'use strict';

    var fixtureAdapter;

    module('tests.store.module', {
            setup: function () {
                fixtureAdapter = DS.FixtureAdapter.extend({

                });
                Balanced.Store.reopen({
                    adapter: fixtureAdapter
                });

                //  TODO: how does this work?
                Balanced.Marketplace.FIXTURES = [
                    {id: 1, name: '1'},
                    {id: 2, name: 'poop'},
                    {id: 3, name: 'poop'}
                ];
            },
            teardown: function () {
                // teardown code
            }
        }
    );

    test("Marketplace query", function () {
        var marketplaces = Balanced.Marketplace.find();
        //  TODO: how do I test this?
    });
})(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T12:23:56.217

对于我使用 jasmine 进行的基本单元测试，我像这样手动设置存储（使用本地存储适配器来避免 xhr 请求）

```
describe ("CodeCamp.SessionView Tests", function(){

  var get = Ember.get, set = Ember.set, sut, controller, session, store;

  beforeEach(function(){
    store = DS.Store.create({
      revision: 11,
      adapter: DS.LSAdapter.create()
    });
    sut = CodeCamp.SessionView.create();
    controller = CodeCamp.SessionController.create();
    controller.set("store", store);
    sut.set("controller", controller);
    session = CodeCamp.Session.createRecord({ id: 1, name: "First", room: "A", ratings: [], speakers: [], tags: []});
  });

  afterEach(function() {
    Ember.run(function() {
      store.destroy();
      controller.destroy();
      sut.destroy();
      session.destroy();
    });
    store = null;
    controller = null;
    sut = null;
    session = null;
  });

  it ("will create rating when form is valid", function(){
    sut.set('score', '1234');
    sut.set('feedback', 'abcd');
    sut.addRating(session);
    var ratings = CodeCamp.Session.find(1).get('ratings');
    var rating = ratings.objectAt(0);
    expect(rating.get('score')).toEqual('1234');
    expect(rating.get('feedback')).toEqual('abcd');
    expect(rating.get('session').get('id')).toEqual(1);
  });

}); 
```

上面的测试针对以下 ember 视图进行端到端的测试

```
CodeCamp.SessionView = Ember.View.extend({
  templateName: 'session',
  addRating: function(event) {
    if (this.formIsValid()) {
      var rating = this.buildRatingFromInputs(event);
      this.get('controller').addRating(rating);
      this.resetForm();
    }
  },
  buildRatingFromInputs: function(session) {
    var score = this.get('score');
    var feedback = this.get('feedback');
    return CodeCamp.Rating.createRecord(
    { score: score,
      feedback: feedback,
      session: session
    });
  },
  formIsValid: function() {
    var score = this.get('score');
    var feedback = this.get('feedback');
    if (score === undefined || feedback === undefined || score.trim() === "" || feedback.trim() === "") {
      return false;
    }
    return true;
  },
  resetForm: function() {
    this.set('score', '');
    this.set('feedback', '');
  }
}); 
```

如果您想查看整个应用程序的运行情况（只是一个带有一些基本 jasmine 测试的示例 ember 应用程序），它位于 github

[https://github.com/toranb/ember-code-camp/](https://github.com/toranb/ember-code-camp/)

# itextsharp - 提取文本时出错

> ID：15536546
> 
> 赞同：1
> 
> 时间：2013-03-20T23:11:48.463
> 
> 标签：itextsharp

无法将“iTextSharp.text.pdf.PdfLiteral”类型的对象转换为“iTextSharp.text.pdf.PdfNumber”类型。

代码：

```
StringBuilder text = new StringBuilder();

SimpleTextExtractionStrategy strategy = new SimpleTextExtractionStrategy();

for (int p = 1; p <= reader.NumberOfPages; p++)
{

    text.AppendLine(PdfTextExtractor.GetTextFromPage(reader, p, strategy));
}
reader.Close();
return text.ToString(); 
```

只有很少的 pdf 才会出现此错误。有任何想法吗？

堆栈跟踪：

```
 at iTextSharp.text.pdf.parser.PdfContentStreamProcessor.ShowTextArray.Invoke(PdfContentStreamProcessor processor, PdfLiteral oper, List`1 operands)
   at iTextSharp.text.pdf.parser.PdfContentStreamProcessor.InvokeOperator(PdfLiteral oper, List`1 operands)
   at iTextSharp.text.pdf.parser.PdfContentStreamProcessor.ProcessContent(Byte[] contentBytes, PdfDictionary resources)
   at iTextSharp.text.pdf.parser.PdfReaderContentParser.ProcessContent[E](Int32 pageNumber, E renderListener)
   at iTextSharp.text.pdf.parser.PdfTextExtractor.GetTextFromPage(PdfReader reader, Int32 pageNumber, ITextExtractionStrategy strategy)
   at DCS.Common.PDF.Functions.GetTextPdf(PdfReader reader) in C:\Users\rmaldonado\Documents\Visual Studio 2008\Projects\DCS\Contract\Common\PDF\Functions.cs:line 35
   at DCS.Common.PDF.Functions.ParsePDF(Byte[] bytes) in C:\Users\rmaldonado\Documents\Visual Studio 2008\Projects\DCS\Contract\Common\PDF\Functions.cs:line 23
   at DCS.CAPPS.BLL.Common.Attachment.ReParseText() in C:\Users\rmaldonado\Documents\Visual Studio 2008\Projects\DCS\Contract\ContractBLL\Common\Common.cs:line 1120 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T14:13:45.557

您的文档[Mod 2.pdf](https://docs.google.com/file/d/0B4cQ-iOkdWKvM1RtaEJ3YjFrYkU/edit?usp=sharing)的页面内容完全损坏。它实际上被严重破坏了 Adob​​e Preflight（来自 Acrobat 9.5.4），就像 iText 在尝试分析它时遇到错误一样。

手动检查表明，最明显的错误与注入到**TJ**操作的操作数数组中的操作有关，例如

```
[(OMB) 0.0 Tc -278.0 (Approval) 0.0 Tc -278.0 (2700-0042) ] TJ

[(AMENDMENT) 0.0 Tc -278.0 (OF) 0.0 Tc -278.0 (SOLICITATION/MODIFICATION)
 0.0 Tc -278.0 (OF) 0.0 Tc -278.0 (CONTRACT) ] TJ 
```

这种模式继续下去，即每个非平凡的**[...] TJ**操作都包含注入的**0.0 Tc**操作。

这是错误的，参见。[PDF 规范ISO 32000-1:2008](http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/PDF32000_2008.pdf)的第 7.8.2 节：

> 在 PDF 中，运算符所需的所有操作数都应紧接在该运算符之前。运算符不返回结果，并且在运算符执行完成时不应留下操作数。

这使得`PdfContentStreamProcessor.ShowTextArray.Invoke`（负责处理**TJ**操作）遇到错误。由于**TJ**的操作数数组可能只包含字符串和数字，所有不是 a 的`PdfString,`都被强制转换为，`PdfNumber`但**Tc**运算符是`PdfLiteral.`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T03:57:26.330

正如@mkl 所说，PDf 中也可能存在错误。尝试将文本内容从 PDf 复制粘贴到记事本。它是空白的吗？只是检查内容是图像格式还是其他格式。并尽可能提供完整的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T05:01:06.567

要从 pdf 中提取文本，请尝试使用下面给出的代码

```
PdfTextExtractor.GetTextFromPage(reader, p, new LocationTextExtractionStrategy()) 
```

# ruby-on-rails - Rails + MongoDB：查找大于给定值的ObjectId

> ID：15536547
> 
> 赞同：2
> 
> 时间：2013-03-20T23:12:07.913
> 
> 标签：ruby-on-rails, ruby, mongodb, objectid

我正在尝试在 MongoDB 中查找下一个（最新）文档：

```
Article.find({'_id' => { "$gt" => Moped::BSON::ObjectId(id_from_database)}}) 
```

但是每次我运行这个查询时，我都会得到

```
Problem:
  Document(s) not found for class Article with id(s) {"_id"=>{"$gt"=>"given value"}}. 
```

我已经安装了这些宝石：

```
gem 'mongoid'
gem 'bson'
gem 'bson_ext' 
```

但仍然找不到问题...我将不胜感激每一个帮助！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T11:56:08.740

以下将返回下一个对象

```
Article.where({:_id => {:$gt => id_from_database}}).sort({:_id=>1}).first 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:33:25.707

我认为您想调用`where`而不是`find`用于通过特定 ID 获取记录。

```
Article.where({'_id' => { "$gt" => Moped::BSON::ObjectId(id_from_database)}}).sort(_id: 1).first 
```

# vb.net - 在继承的标签上设置 Font.Bold

> ID：15536549
> 
> 赞同：2
> 
> 时间：2013-03-20T23:12:16.210
> 
> 标签：vb.net, winforms, fonts, controls

我必须在尚未定义 .Font 属性但从表单继承字体（名称、大小、样式）的标签上设置 .Font.Bold = True 。为此，我从表单的设计器文件中删除了她的 .Font 属性。

现在我需要将此标签的文本设置为粗体，而无需为此标签定义字体名称、大小等。

我尝试：

```
label6.Font.Bold = True 
```

但这不起作用（属性 .Font.Bold 是只读的）。
如果我为此标签设置字体，例如：

```
label6.Font = New Font(myfontname, 10, FontStyle.Bold, GraphicsUnit.Point) 
```

然后我得到粗体文本，但标签不再继承表单的字体大小。

是否可以将表单的字体继承保留在标签上但在此类标签上获得粗体文本？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T23:46:11.420

不，因为您已经发现该`Font.Bold`属性是只读的。字体对象是不可变的，这意味着它们的属性一旦创建就不能更改。修改此属性的唯一方法是创建一个新的 Font 对象。

创建这个新 Font 时，您当然可以复制现有 Font 对象（如您的表单使用的那个）的属性，但是没有办法将两个 Font 对象动态耦合在一起。如果您的表单使用的字体大小发生变化，则会使用该新大小为表单创建一个新的 Font 对象，但您的自定义粗体 Font 对象将不会更新。

唯一让人困惑的是，如果您没有为子控件设置自定义字体，就会发生一些神奇的事情。它们会自动继承其父级（容器控件，例如窗体）的字体。此类在未显式设置时从其父级检索其值的属性称为环境属性。环境属性在适用[的文档中进行了说明。](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.font.aspx)但结果是，当您明确设置属性时，氛围就会消失。所以忘了那个吧。

为了实现您想要的效果，我们需要在表单的字体大小更改时收到通知，作为响应，您可以为您的 Label 控件创建一个具有新大小的新粗体 Font 对象。[`FontChanged`幸运的是，事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.fontchanged.aspx)的形式就是这样一种机制。为您的表单处理`FontChanged`事件，并作为响应，为您的 Label 控件创建一个新的 Font 对象。例如：

```
Private Sub myForm_FontChanged(ByVal sender As Object, ByVal e As EventArgs) Handles myForm.FontChanged
    Dim oldFont As Font = myLabel.Font
    myLabel.Font = New Font(myForm.Font, myForm.Font.Style Or FontStyle.Bold)
    oldFont.Dispose()
End Sub 
```

虽然，我不确定这是否/为什么真的有必要。应用程序运行时表单的字体大小很少发生变化。通常，这仅在创建时发生，在这种情况下，当您检索值以为您的 Label 控件创建自定义 Font 对象时，它已经被正确设置。

# routing - WebAPI 路由 - 如何使默认路由忽略命名方法？

> ID：15536553
> 
> 赞同：0
> 
> 时间：2013-03-20T23:12:47.250
> 
> 标签：routing, asp.net-web-api

假设我在控制器中有这些方法：

```
Get() 

[HttpGet]
FindSomeone() 
```

我有一个默认路由和一个带有操作的路由：*routeTemplate: "api/{controller}/{action}"*。

当我调用 /mycontroller/FindSomeone 时工作正常，但当我调用 GET /mycontroller/ 时失败并出现*多个匹配路由*错误。

有没有办法让默认路由只匹配 Get() 方法，并跳过 FindSomeone() 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:09:23.537

在这种情况下，AttributeRouting 可能更适合您。它应该像用 Get Attribute 装饰这两个方法一样简单，

```
[RoutePrefix("mycontroller")
public class MyController 
{
  [GET("")]
  Get() 

  [GET("FindSomeone")]
  FindSomeone()
} 
```

这将使这些方法可用作 mycontroller 和 mycontroller/FindSomeone。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:49:42.683

`Get`为主路由中的所有控制器声明默认操作

```
config.Routes.MapHttpRoute(
    name: "DefaultApi",
    routeTemplate: "api/{controller}/{id}",
    defaults: new { id = RouteParameter.Optional, action ="Get" }
    ); 
```

# ios - Xcode Instruments 的分配工具遗漏了很多东西

> ID：15536557
> 
> 赞同：6
> 
> 时间：2013-03-20T23:13:16.453
> 
> 标签：ios, debugging, instruments

由于我难以理解的原因，我的应用程序经常崩溃。它并没有崩溃——它被外部的“未知”进程杀死：

```
Processes
     Name        <UUID>       rpages       recent_max       [reason]          (state)

     test-app    <....>       167111       167111     [per-process-limit] (frontmost) (resume) 
```

我可以理解，如果我分配了一个巨大的内存块，或者一个无数的小块，但我并没有做任何令人发指的事情。使用 Instruments 进行分析告诉我，该应用程序仅使用大约 8 MB，当我加载一些大型内容时，偶尔会飙升至 13 MB 左右。没有严重的泄漏，该应用程序通常很快就被杀死。

一位同事在模拟器中运行时开始使用 Activity Monitory 检查应用程序的内存使用情况，并注意到当我们开始使用某个库时，内存从大约 70 MB（我猜模拟器中的情况有点不同）飙升至 800 MB 以上. 所以，我开始在模拟器而不是设备上进行分析。Allocations 工具继续报告应用程序使用 8-ish MB，但 VM Tracker 讲述了另一个故事：

![仪器屏幕截图](../Images/9a8527e8714eae5d784f1bf2d088a2c0.png)

所以......看起来VM Tracker能够看到分配没有的一些重要内存使用。

**为什么分配工具缺少此应用程序使用的 99% 的内存？**

**更新：**针对 nielsbot 的问题，我仔细查看了 VM Tracker 的信息，发现我在分配中没有看到的最大部分内存归因于核心动画：

![虚拟机跟踪器屏幕截图](../Images/c05169f7498cd13059aed2d7eb3da527.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:40:48.947

我认为虚拟机空间包括共享框架和映射内存之类的东西，而分配可能不...

我猜常驻大小更接近实际使用的 RAM 量。纯 VM 内存可能只是映射地址空间，而不是实际消耗的物理 RAM。

例如，查看 Safari，我看到 1.92 GB 虚拟内存映射，但更接近 549 MB 常驻，我认为这是有道理的......![在此处输入图像描述](../Images/683753ff2abe7d1bc7ac5730199ba985.png)

# javascript - 在 Javascript 中，如何每 5 秒打印一次数组中的单个元素？

> ID：15536559
> 
> 赞同：1
> 
> 时间：2013-03-20T23:13:28.523
> 
> 标签：javascript

我有一个带有方法 [ **.show()**和**.retrieve()** ]的预制类 [ **Msg** ]。方法 '.show()' 向浏览器显示一条消息，作为无序列表中的最后一个列表项。'.retrieve()' 方法从服务器获取有限数量的消息。它将回调方法作为其唯一参数。它将传递一个字符串数组。数组中的每个字符串都包含一条消息。我有以下代码：

 ******JS：**

```
 Msg.retrieve(function(array) {
      for (var i = 0; i < array.length; i++) {
           Msg.show(array[i]); 
      }
 });

 // The code outputs all the messages to the screen at once as a bunch of list items. 
```

*如何每五秒输出一条消息？*我不确定如何使用 Javascript 的 setInterval() 方法。

任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:15:58.170

```
var interval = setInterval(function() {
    Msg.show(array[i])
    i++
    if (i >= array.length) clearInterval(interval)
}, 5000) 
```

`setInterval`将函数和时间量作为参数。

您也可以使用`clearInterval`清除间隔。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T23:16:57.203

检索后，设置一个计时器并一次将数组移动一个值：

```
Msg.retrieve(function(array) {
     var timer = setInterval(function() {
         if(array.length) {
             Msg.show(array.shift()); 
         } else {
             // All messages displayed, array is empty
             clearInterval(timer);
         }
     }, 5000);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T23:19:23.290

```
function makeArrayPrinter(arr, delayMillis) {
  var i=0;
  return function printer() {
    if (i < arr.length) {
      console.log(arr[i++]);
      setTimeout(printer, delayMillis);
    }
  }
}

var f = makeArrayPrinter([1, 2, 3, 4, 5], 5000);
f(); 
```****

# ruby-on-rails - 使用 FbGraph 循环中的多个帖子给出：OAuthException :: (#1) 创建共享时发生错误

> ID：15536560
> 
> 赞同：0
> 
> 时间：2013-03-20T23:13:32.040
> 
> 标签：ruby-on-rails, facebook, facebook-graph-api, fb-graph

我在将帖子发布到页面时遇到问题，并且只会收到有用的错误：
`OAuthException :: (#1) An error occured while creating the share`

前 20 个左右的帖子效果很好，然后开始出错。
facebook对一个页面（垃圾邮件）的帖子数量有限制吗？

我可以复制表格`rails c`，我已经三次检查了我的 access_token 并且可以直接从 FB 手动发布。
（我使用的`page`access_token 不是我`user`的）

我在 FbGraph 的 githup 上打开了一个问题，但 nov 似乎认为这是一个 FB 问题。

**我的代码：**

```
 admin = Admin.first

    page = FbGraph::Page.new(admin.facebook_page_id)

    Story.where(:facebook_post_id => nil).all.each do |story|
      post = page.feed!(
        :link => 'http://www.example.com/stories/'+story.cached_slug,
        :access_token => admin.facebook_page_access_token
      )

      story.facebook_post_id = post.identifier
      story.live = true
      story.save

      sleep 1
    end 
```

**回溯：**

```
FbGraph::InvalidRequest: OAuthException :: (#1) An error occured while creating the share
    from /usr/local/rvm/gems/ruby-1.9.3-p392/gems/fb_graph-2.6.4/lib/fb_graph/exception.rb:47:in `block in handle_httpclient_error'
    from /usr/local/rvm/gems/ruby-1.9.3-p392/gems/fb_graph-2.6.4/lib/fb_graph/exception.rb:44:in `each'
    from /usr/local/rvm/gems/ruby-1.9.3-p392/gems/fb_graph-2.6.4/lib/fb_graph/exception.rb:44:in `handle_httpclient_error'
    from /usr/local/rvm/gems/ruby-1.9.3-p392/gems/fb_graph-2.6.4/lib/fb_graph/node.rb:142:in `handle_response'
    from /usr/local/rvm/gems/ruby-1.9.3-p392/gems/fb_graph-2.6.4/lib/fb_graph/node.rb:55:in `post'
    from /usr/local/rvm/gems/ruby-1.9.3-p392/gems/fb_graph-2.6.4/lib/fb_graph/connections/feed.rb:14:in `feed!'
    from (irb):9:in `block in irb_binding'
    from (irb):5:in `each'
    from (irb):5
    from /usr/local/rvm/gems/ruby-1.9.3-p392/gems/railties-3.2.12/lib/rails/commands/console.rb:47:in `start'
    from /usr/local/rvm/gems/ruby-1.9.3-p392/gems/railties-3.2.12/lib/rails/commands/console.rb:8:in `start'
    from /usr/local/rvm/gems/ruby-1.9.3-p392/gems/railties-3.2.12/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>' 
```

**更新：**

看起来我的 access_token 被禁止了 24 小时。

在再次出现此错误之前，我只能向页面添加另外 28 个帖子。这次我尝试了 10 秒的睡眠，但仍然被禁止...我想我明天会尝试 60 秒的睡眠.. :(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T04:19:37.883

我无法解决这个问题，但我已经解决了这个问题。

通过每 3 分钟上传 1 个帖子，我每天可以收到 200-300 个帖子。

```
admin = Admin.first

page = FbGraph::Page.new(admin.facebook_page_id)

Story.where(:facebook_post_id => nil).all.each do |story|
  post = page.feed!(
    :link => 'http://www.example.com/stories/'+story.cached_slug,
    :access_token => admin.facebook_page_access_token
  )

  story.facebook_post_id = post.identifier
  story.live = true
  story.save

  sleep 180
end 
```

我希望这可以帮助其他人解决这个问题。

# list - Lisp 循环列表

> ID：15536564
> 
> 赞同：-1
> 
> 时间：2013-03-20T23:13:51.447
> 
> 标签：list, lisp, common-lisp, circular-list

我们从 lisp 得到了作业，我需要使用“循环”列表（我不知道这个的正确命名是什么）。通过“循环”列表，我的意思是列表，其中`cdr`最后一个 cons 指向同一列表的第一个。

```
(Value1 . PointerValue2) (Value2 . PointerValue3) (Value3 . PointerValue1) 
```

我们被教导使用以下方法创建这样的列表：

```
(defun cykl (l)
  (setf (cdr (last l)) l)
) 
```

我使用的 Lisp 软件（*Lispbox*）不支持这种列表。我也在 Debian 上尝试过*clisp*，但它在创建这样的列表后崩溃了。

你知道哪些 lisp 实现支持这个（免费软件，独立于操作系统）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T00:03:01.113

所有 lisp 实现，包括`clisp`，都支持[*循环*列表](http://www.lispworks.com/documentation/HyperSpec/Body/26_glo_c.htm#circular_list)。

当您说“崩溃”时，您可能是指[堆栈溢出错误](http://www.clisp.org/impnotes/faq.html#faq-stack)（或内存不足错误），当您尝试*打印*时总是会遇到这种错误（还记得 'read-eval-PRINT' 循环吗？）循环时[`*print-circle*`](http://www.lispworks.com/documentation/HyperSpec/Body/v_pr_cir.htm)的结构`nil`。将其设置为`t`强制 Lisp 使用[#n#](http://www.lispworks.com/documentation/HyperSpec/Body/02_dhp.htm)表示法：

```
[1]> (defparameter l (list 1 2 3))
L
[2]> l
(1 2 3)
[3]> (setq *print-circle* t)
T
[4]> (setf (cdr (last l)) l)
#1=(1 2 3 . #1#) 
```

另请参见[函数 LIST-LENGTH](http://www.lispworks.com/documentation/HyperSpec/Body/f_list_l.htm)

# javascript - Internet Explorer 8 获取 Radiobutton 的值

> ID：15536567
> 
> 赞同：0
> 
> 时间：2013-03-20T23:14:10.357
> 
> 标签：javascript, jquery, internet-explorer, internet-explorer-8

我已经用谷歌搜索了大约 2 个小时来解决以下问题（包括其他 Stackoverflow 问题）：

```
<script type="text/javascript">
    jQuery(document).ready(function() {
        jQuery('input[type="radio"]').unbind('click.preset')
        .bind('click.preset', function() {
            doingStuffWith(jQuery(this).val());
        });
    });
</script>

<input type="radio" name="lightType" value="led" />
<input type="radio" name="lightType" value="tube" /> 
```

如您所见，我只是试图检索单选按钮组“lightType”的当前值以使用它。这在 Firefox / Safari / Chrome 中就像一个魅力，但 IE8 只返回一个空字符串让我很难过。

我已经尝试了其他问题的一些技巧，例如将更改事件绑定到单选按钮以及通过模糊单击的单选按钮等来强制 IE8 触发它。也许我现在只是失明。

我正在使用最新的 jQuery 版本，并确保没有其他绑定事件干扰。有趣的是，在检索值之前添加一个 alert() 并且 IE 返回当前值：

```
....
// DOES WORK
alert();
alert(jQuery(this).val()); // alerts e.g. "tube"

// DOESN'T WORK
alert(jQuery(this).val()); // alerts "" 
```

我认为这可能是一个时间问题，但试图用 setTimeout 延迟我的单个警报呼叫并没有帮助。

在此先感谢各位，我希望我只是瞎了眼，没有在 IE8 中发现另一个丑陋的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T10:10:47.690

感谢您的回答，但没有一个有效。我不确定这是否是 jQuery 中的错误，或者只是我在特定情况下遇到的问题。似乎 jQuery 正在强制 IE8 在字段真正更改之前触发更改事件。

我终于通过绑定到 blur 事件并将其与 powtacs 结合来解决它：checked 解决方案如下：

```
<script type="text/javascript">
jQuery(document).ready(function() {

   jQuery('input[type="radio"]').unbind('click.preset')
   .bind('click.preset', function() {
       jQuery(this).blur();
   }

   jQuery('input[type="radio"]').unbind('blur.preset')
   .bind('blur.preset', function() {
        doingStuffWith(jQuery('input[type="radio"]:checked').val());
    });
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:26:04.653

我会在回调中使用最新的 jQuery 和选择器[`on()`](http://api.jquery.com/on/)：[`:checked`](http://api.jquery.com/checked-selector/)

```
jQuery(document).ready(function() {
    jQuery('input[type="radio"]').on(function('change blur mousedown click') {
         alert(jQuery('input[type="radio"]:checked').val());
    });
}); 
```

实际上这有点棘手，您无法在回调中使用“this”获取选定的单选按钮，您必须使用其他选择器： [我如何知道通过 jQuery 选择了哪个单选按钮？](https://stackoverflow.com/questions/596351/how-can-i-get-which-radio-is-selected-via-jquery)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-13T18:43:36.423

IE8 的一个公平选项是在每个单选选项中创建一个类 (!) 并使用它来选择选中的选项。从语义上讲，这有点奇怪，但对我来说效果很好：

HTML

```
<input type="radio" name="example" class="example_class" value="1"/>#1
<input type="radio" name="example" class="example_class" value="2"/>#2
<input type="radio" name="example" class="example_class" value="3"/>#3 
```

JS

```
var exampleValue = $('.example_class:checked').val(); 
```

# cookies - HTTPS 上的安全 cookie 意义

> ID：15536569
> 
> 赞同：1
> 
> 时间：2013-03-20T23:14:16.187
> 
> 标签：cookies, ssl, https

为 HTTPS 加密 cookie（安全 cookie）有什么意义吗？据我所知，在 HTTPS 中整个请求都是加密的，那么我们是否需要对 cookie 进行额外加密？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:20:43.710

这完全取决于您的安全模型。您仍然需要加密 cookie 的一些原因：

1.  您是否关心您的应用程序的用户是否获取 cookie 的内容？换句话说，您是否在其中存储了任何不应该向用户披露的内部内容？

2.  您是否关心用户是否篡改了 cookie 的内容？加密可以成为一种获得完整性保护的方法，具体取决于您的操作方式。（当然，还有其他方法。）

3.  披露 cookie 的后果是什么？如果它是不记名令牌，是否加密不会有太大区别，但如果它包含有价值的数据，加密它可以防止攻击者以某种方式访问​​浏览器存储的 cookie（无论是通过网络攻击或对托管浏览器的实际系统的攻击）。您仍然可能以其他方式输给攻击者，但它可以提供一些深度防御。

加密 cookie 为您提供的主要功能是保护接收 cookie 的用户（或可以访问该用户数据的攻击者），如果您需要的话。

# javascript - 为什么不使用 localStorage 来存储静态资源？

> ID：15536571
> 
> 赞同：0
> 
> 时间：2013-03-20T23:14:16.953
> 
> 标签：javascript, html, local-storage, application-cache

这是逻辑上遵循这个问题的问题：

[HTML5 应用程序缓存是否相关？](https://stackoverflow.com/questions/15507150/is-html5-application-caching-relevant-or-a-failed-technology)

很明显，流行的站点没有使用 HTML 5 应用程序缓存来保存其设计的静态资源。

只需检查`<html>`标签中的清单属性。它不在那里。

进一步研究 HTML5 localStorage 也没有被使用。

作为一个测试用例，我看了

*   www.google.com
*   www.twitter.com
*   www.facebook.com

只需进入控制台并输入

```
localStorage. 
```

控制台应该会弹出一个键列表。

这些站点都没有将其静态数据保存到磁盘吗？

为什么是这样？

访问网络以获得未更改的资源似乎是一种资源浪费。

详细说明。如果点击重新加载，页面会重新下载静态资源。使用 Google，您甚至可以看到 URL 路径中使用的静态一词。但是对于这个问题，我使用这个词的概念含义。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T23:24:44.753

> 很明显，流行的站点没有使用 HTML 5 应用程序缓存来保存其设计的静态资源。

您误解了应用程序缓存的设计目的。这是应用程序缓存规范的第一段：

> 为了使用户即使在网络连接不可用时也能继续与 Web 应用程序和文档进行交互——例如，因为他们在 ISP 的覆盖范围之外旅行——作者可以提供一个清单，其中列出了 Web 所需的文件应用程序脱机工作，这会导致用户的浏览器保留文件的副本以供脱机使用。
> 
> [http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#introduction-5](http://www.whatwg.org/specs/web-apps/current-work/multipage/offline.html#introduction-5)

因此，应用程序缓存旨在允许 Web 应用程序作者在网络连接不可用时使他们的应用程序工作。

我无法想象 Google、Twitter 或 Facebook 在没有网络连接的情况下如何有效地工作。它们都依赖于用户与其服务器上的大量数据（在 Twitter 和 Facebook 的情况下，是关于其他用户的数据）进行交互。如果没有网络连接，它们本质上是无用的。

同样，`localStorage`不是为存储可能更改的页面资源而设计的。（我猜你是在暗示这些网站可以将 CSS、JavaScript 和图像文件存储在 localStorage 中——如果我误解了，请道歉。）

> 本规范介绍了两种相关机制，类似于 HTTP 会话 cookie，用于在客户端存储结构化数据...
> 
> 第一个是为用户执行单个事务但可能同时在不同窗口中执行多个事务的场景设计的......
> 
> 第二种存储机制是为跨多个窗口的存储而设计的，并且持续时间超过当前会话。特别是，出于性能原因，Web 应用程序可能希望在客户端存储数兆字节的用户数据，例如整个用户创作的文档或用户的邮箱……
> 
> [http://www.w3.org/TR/webstorage/#introduction](http://www.w3.org/TR/webstorage/#introduction)

为了`localStorage`用于 CSS、JavaScript 和图像文件，您需要页面中的一些 JavaScript 来检查页面`localStorage`所需的每个资源，然后（以某种方式）检查服务器以查看是否有更新的版本，如果必要时，然后将资源添加到页面的 DOM 中（如果它是新的，则将其存储在 localSorage 中）。

基本上复制 Web 浏览器已经完成的缓存需要大量代码。当您的 JavaScript 正在检查`localStorage`服务器时，页面会停止呈现。而当浏览器自己下载 CSS 和图像文件时，页面可以同时进行渲染。

# android - 插入新联系人时如何检测重复联系人？

> ID：15536574
> 
> 赞同：1
> 
> 时间：2013-03-20T23:14:50.133
> 
> 标签：android

对于联系人备份应用程序，我将所有信息保存到 CSV 文件，然后我需要将其恢复。它工作得很好，但是如果我按两次恢复，它会复制所有联系人。

我尝试了以下代码来删除重复项，它确实有效，但在某些情况下会失败。基本上，当没有明确的 DISPLAY_NAME 时，它会失败，例如，如果联系人似乎只有一个电话号码，而 DISPLAY_NAME 是电话号码，或者与电子邮件地址相同。我不明白为什么它不会总是有效，因为 DISPLAY_NAME 字段似乎包含电话号码/电子邮件地址。

这是我使用的代码：

```
private boolean contactExists(String displayname, String emailstring, String phonestring){
           Cursor crsr = BA.applicationContext.getContentResolver().query(
                   ContactsContract.Contacts.CONTENT_URI,
                   new String[] { "display_name", "_id"},                  
                   "display_name = ? ",
                   new String[] {displayname},
                   null);

           while (crsr.moveToNext()){
                HashMap m = new HashMap();
                for (int col = 0; col < crsr.getColumnCount(); col++) {
                  m.put(crsr.getColumnName(col), Integer.valueOf(col));
                }
               int id = crsr.getInt(((Integer)m.get("_id")).intValue());
               String emails = GetEmails(id);
               String phones = GetPhones(id);

               if (emails.contentEquals(emailstring) && phones.contentEquals(phonestring))
               {
                   crsr.close();
                   return true;
               }
           }
           crsr.close();
           return false;
    } 
```

**更新：** 我尝试使用 DISPLAY_NAME_PRIMARY 得到相同的结果。

但是我注意到，如果我在同一个设备/模拟器上创建联系人，当我重新恢复相同的联系人时，会检测到重复。在跨设备时，它不起作用的一个原因似乎是在某些时候特殊字符被删除了。例如，显示名称“John.Doe”是从 CSV 读取的，但是当它被插入时，它变成了“John Doe”。我看不到代码中“。”的位置。永远被剥离出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:24:45.930

发生的情况取决于设备运行的 Android 版本。如果版本是 Honeycomb (3.0) 或更高版本，则联系人将*始终*具有名称。姓名字段为 DISPLAY_NAME_PRIMARY，如果任何原始联系人中没有姓名，则此字段设置为电话号码或电子邮件地址。

很难确切地知道您的代码发生了什么，因为我无法告诉您在所有情况下如何调用contactExists。但我的猜测是您正在查看 DISPLAY_NAME，而您可能想要查看 DISPLAY_NAME_PRIMARY。

作为旁注，您在这里尝试做的事情充满了危险。联系人提供程序是一个复杂的系统，将其备份到 CSV 可能会导致很多问题。更好的策略是在联系人提供商和基于云的 Google 联系人应用程序之间运行同步。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-07T07:48:38.117

这是查找重复联系人的代码。您需要将“NAME”作为字符串传递，它会查找重复项。它在 ICS 中有效，但没有在 GB 中检查，所以基本上你需要试试运气。

```
/**
     * @param name
     * @param context
     * @return
     */
    public boolean isContactExist(String name) {
        boolean result = false;
        try {
            ContentResolver contentResolver = getContentResolver();
            Uri uri = Data.CONTENT_URI;
            String[] projection = new String[] { PhoneLookup._ID,
                    PhoneLookup.LOOKUP_KEY };
            String selection = StructuredName.DISPLAY_NAME + " = ?";
            String[] selectionArguments = { name };
            Cursor cursor = contentResolver.query(uri, projection, selection,
                    selectionArguments, null);

            if (cursor != null) {
                while (cursor.moveToNext()) {
                    /*
                     * Log.i(TAG, "KEY = " + cursor.getString(cursor
                     * .getColumnIndex(ContactsContract.Contacts.LOOKUP_KEY)));
                     */
                    result = true;
                }
            }
            cursor.close();
        } catch (Exception e) {
            result = false;
            e.printStackTrace();
        }
        return result;
    } 
```

# java - 尝试在 Java 中使用递归创建 Htree，但无法让它做多个角落

> ID：15536575
> 
> 赞同：2
> 
> 时间：2013-03-20T23:15:00.247
> 
> 标签：java, algorithm, recursion

我目前正在学习 Java 课程，我们的教授正在让我们编写一个程序，使用递归来构建一个“Htree”，它只是一个 H，在第一个角落的每个角落都有较小的 H，并且按照用户指定的级别向下. 到目前为止，我已经递归地创建了第一个角，但我似乎无法弄清楚如何更改它，所以它将完成所有四个角。这是我的代码：

```
package assignment3;

public class Htree {

    public static void main(String[] args) {

        int SIZE = 512;

        // Output and entry take place in the console window

        Turtle.create(SIZE, SIZE);

        int xCenter = SIZE / 2;
        int yCenter = SIZE / 2;

        int x = 4;
        recursive(xCenter, yCenter, x);
    }

    private static void recursive(int xCenter, int yCenter, int x) {
        int x2 = x - 1;

        if (x2 < 0) {
            return;
        }
        int left = xCenter - xCenter / 2;
        int right = xCenter + xCenter / 2;
        int top = yCenter - yCenter / 2;
        int bottom = yCenter + yCenter / 2;
        int middle = yCenter;

        Turtle.fly(right, middle);
        Turtle.go(left, middle);
        Turtle.fly(right, top);
        Turtle.go(right, bottom);
        Turtle.fly(left, top);
        Turtle.go(left, bottom);
        recursive(left, top, x2);

        System.out.println("Done");
    }
} 
```

它应该看起来像这样： ![树](../Images/d3bb551c28e1324ddd4001df972b9084.png)

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:00:23.533

你的代码喜欢

```
 int left = xCenter - xCenter / 2;
    int right = xCenter + xCenter / 2; 
```

是有问题的。假设第二级 H 的 X 中心应位于 x=2 和 x=6。对于左手 H，您计算左 = 1，右 = 3，因此它将是 2 个单位宽。但是对于右手的 H，你计算 left=3，right=9，所以它是 6 个单位宽。结论：您的递归例程需要另一个参数来指定宽度，并且您将使用 left=xCenter-wide/2、right=xCenter+wide/2 之类的公式。

这是一种简单的方法来执行四种不同的递归调用的伪代码（用`drawH(xCenter, yCenter, wide, deep)`used 代替您的`recursive(left, top, x2);`函数）：

```
p = q = 1
for i in {1..4}:
    drawH(xCenter+p*size/xratio, yCenter+q*size/yratio, wide/2, deep-1)
    q = p*q; p = -p; 
```

*更正和注释，2016 年 5 月：*伪代码的最后一行`q = p*q; p = -p;`产生 (p, q) 对 {(1, 1), (-1, 1), (1, -1), (-1, -1)}对于 H 的四个小节。

# css - 有一个可点击的图像来打开 wordpress 中的嵌入内容 - Space Invaders

> ID：15536576
> 
> 赞同：1
> 
> 时间：2013-03-20T23:15:01.040
> 
> 标签：css, wordpress

我希望能够单击我的一个博客页面上的图像，然后启动一些嵌入式内容。

具体来说，我想为这个 Space Invaders 游戏创建一个封面图片，可以在这里找到：http: [//arcade.gameex.com/playgame/6135/space-invaders.html](http://arcade.gameex.com/playgame/6135/space-invaders.html)

嵌入代码 =

```
<iframe src = "http://arcade.gameex.com/embed.php?id=6135" width="480" height="360" /> 
```

我想在页面中单击我的自定义封面图像，然后启动游戏，但我不知道如何执行此操作。

我已经使用 wordpress 几年了，但只进行了细微的样式调整……没有这样的事情。

对初学者的任何帮助将不胜感激！我不是一个有经验的程序员。

-C

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T02:05:28.677

以下是使用 jQuery（一个 JavaScript 库）的方法：

[http://jsfiddle.net/SMM2B/](http://jsfiddle.net/SMM2B/)

```
<style>
#cover {
    width: 480px;
    height: 360px;
    background: url(image.jpg) left top no-repeat;
}
#game {
    display: none;
    width: 480px;
    height: 360px;
}
</style>

<div id="cover"></div>

<div id="game">
    <object>...</object>
</div>

<script>
$(function() {
    $('#cover').click(function () {
        $(this).slideUp();
        $('#game').slideDown();
    });
});
</script> 
```

请注意，您需要配置 WordPress 和您的编辑器以允许 JavaScript 和对象或 iframe。如果您的网站上还没有 jQuery，您可以使用此标签从 Google 加载它：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

# jquery - jQuery Collapsible Plugin：跳转到锚点和展开

> ID：15536578
> 
> 赞同：0
> 
> 时间：2013-03-20T23:15:20.293
> 
> 标签：jquery, hyperlink, anchor, expand, collapse

[http://github.com/juven14/Collapsible](http://github.com/juven14/Collapsible) [http://www.snyderplace.com/demos/collapsible.html](http://www.snyderplace.com/demos/collapsible.html)

如果该部分尚未展开，如何跳转到部分锚点（例如#faq-3）并展开该部分？

编辑：另外，所有其他部分都应该关闭。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:33:53.083

从他们的API中，您可以通过此打开“可折叠”

```
$('#collapsible_id').collapsible('open'); 
```

因此，如果您可以识别会导致某些“可折叠”打开的链接或按钮（您可以通过添加一些类来指示这一点），您可以添加将打开正确的“可折叠”的单击处理程序

```
$('.open_collapsible').click(function(){
    var id_of_collapsible_to_open=$(this).attr('some_custom_attribute_hold_id_of_collapsible_to_open');
    $('#' + id_of_collapsible_to_open).collapsible('open');
}); 
```

# python - Python：全局对象破坏

> ID：15536581
> 
> 赞同：3
> 
> 时间：2013-03-20T23:15:36.410
> 
> 标签：python

我有一个全局实例，我希望`__del__`在 Python 解释器退出时将其销毁（调用函数）。我是否对 Python 解释器期望过高？我的测试方法是在`__del__`函数中打印，从命令行运行`python.exe`，然后按 Ctrl/Break。此时，我希望在命令行窗口中看到打印。但是，我没有。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T23:21:36.213

是的，你期望太高了。Python对调用[不做任何保证](http://docs.python.org/3/reference/datamodel.html?highlight=__del__#object.__del__)`__del__`：

> 不能保证`__del__()`为解释器退出时仍然存在的对象调用方法。

编辑：

通常，您应该避免使用`__del__`. 在大多数情况下，上下文管理器更好。在极少数情况下，当您需要确保在解释器退出时清理某些外部（即从 C 代码中分配的）资源时，您可以使用该[`atexit`模块](http://docs.python.org/3/library/atexit.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T23:18:57.213

`signal.SIGBREAK`您可以为信号添加一个处理程序。那会让你拦截`ctrl`+ `break`。形成[文档](http://docs.python.org/2/library/signal.html#example)：

```
import signal, os

def handler(signum, frame):
    print 'Someone is trying to exit!', signum

signal.signal(signal.SIGBREAK, handler) 
```

# javascript - 是否可以从 jsperf 中删除损坏的修订？

> ID：15536582
> 
> 赞同：8
> 
> 时间：2013-03-20T23:15:37.463
> 
> 标签：javascript, jquery, performance, jquery-mobile, jsperf

`jsperf`我正在（[这里](http://jsperf.com)）做我的第一步，以提高我的一些脚本的性能。

我想知道是否可以删除/删除我意外发布的测试修订版-它们已损坏且无法使用，因此：

**问题：**
假设我在进行修订 5 时弄清楚了它是如何工作的 - 有没有办法删除修订 1-4？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T06:40:20.480

**免责声明：**我是创建 jsPerf 的人。

除了给我发电子邮件或在 Twitter 上很好地询问 @jsperf 之外，没有其他方法可以删除 jsPerf 上的测试用例。这是设计使然。

但是，您如何最终得到 4 个损坏的修订版？每当您编辑在同一浏览器会话中创建的测试用例时，它只会更新原始测试用例。

# sahi - sahi 和表操作

> ID：15536584
> 
> 赞同：0
> 
> 时间：2013-03-20T23:15:44.443
> 
> 标签：sahi, twist

对于给定的表，我想得到以下

1.  总行数
2.  能够按行和列迭代

使用[Java 驱动程序](http://sahi.co.in/java/javadocs/)。我尝试了[这里提到](http://sahi.co.in/forums/discussion/2931/how-to-loop-through-table-rows-using-java/p1)的选项，但没有运气。

下面是表格的 HTML

```
<div id="hawkMessageCodeTable" class="ui-datatable ui-widget">
          <table>
            <thead>
              <tr>
                <th id="hawkMessageCodeTable:j_idt49" class="ui-state-default">
                  <div class="ui-dt-c">
                    <span>Code</span>
                  </div>
                </th>
                <th id="hawkMessageCodeTable:j_idt51" class="ui-state-default">
                  <div class="ui-dt-c">
                    <span>Message</span>
                  </div>
                </th>
              </tr>
            </thead>
            <tbody id="hawkMessageCodeTable_data" class="ui-datatable-data ui-widget-content">
              <tr data-ri="0" class="ui-widget-content ui-datatable-even">
                <td>
                  <div class="ui-dt-c">
                    9005
                  </div>
                </td>
                <td>
                  <div class="ui-dt-c">
                    Initial Fraud Alert on File
                  </div>
                </td>
              </tr>
              <tr data-ri="1" class="ui-widget-content ui-datatable-odd">
                <td>
                  <div class="ui-dt-c">
                    9003
                  </div>
                </td>
                <td>
                  <div class="ui-dt-c">
                    Security Alert or consumer statement on file relates to true name fraud or credit fraud
                  </div>
                </td>
              </tr>
              <tr data-ri="2" class="ui-widget-content ui-datatable-even">
                <td>
                  <div class="ui-dt-c">
                    2501
                  </div>
                </td>
                <td>
                  <div class="ui-dt-c">
                    Input/File (Current/Previous) Address Has Been Used (#) Times In The Last (30,60,90) Days On Different Inquiries
                  </div>
                </td>
              </tr>
              <tr data-ri="3" class="ui-widget-content ui-datatable-odd">
                <td>
                  <div class="ui-dt-c">
                    9004
                  </div>
                </td>
                <td>
                  <div class="ui-dt-c">
                    Active Duty Alert on File
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:03:02.857

我已经用 sahi 为 ruby​​ 实现了一个类似的功能。要回答您的问题：

1.  rowLen = table.fetch("rows.length").to_i

2.  循环遍历所有单元格：@browser.cell(table,rowIndex,colIndex).exists?()

可以找到sahi java对应的api

# java - Java 中 FontMetrics 的替代方案

> ID：15536588
> 
> 赞同：0
> 
> 时间：2013-03-20T23:16:08.717
> 
> 标签：java, fonts, awt, fontmetrics

我的代码使用了已弃用的 getFontMetrics()。有什么替代方案？

```
 public void setFont ( Font font ) {
       if(font == null){
           Font defaultFont=(Font)javax.swing.UIManager.getDefaults().get ( "Label.font" ) ;
           font=new Font(defaultFont.getName(),Font.BOLD,defaultFont.getSize()+8);;
       }
      FontMetrics fontMetrics = Toolkit.getDefaultToolkit().getFontMetrics (font) ;
      fontHeight      = fontMetrics.getHeight() ;
      fontDescent     = fontMetrics.getDescent() ;
      fontLeading     = fontMetrics.getLeading() ;
      if ( text != null ) 
         fontWidth = Toolkit.getDefaultToolkit().getFontMetrics (font).stringWidth ( text ) ;
      currentFont = font ;
      super.setFont ( font ) ;
   } 
```

有什么建议么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:22:48.210

Javadoc 告诉你

> 从 JDK 版本 1.2 开始，由 Font 方法 getLineMetrics 取代。

# ruby-on-rails - Rails 和 jQuery：在会话中保存状态

> ID：15536592
> 
> 赞同：1
> 
> 时间：2013-03-20T23:16:17.760
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery

我试图在 Rails 应用程序中保存 jQuery 切换的状态，但收效甚微。我将如何将它存储在会话中？或者我会将其存储在 cookie 中？谢谢你的帮助。

这是处理切换的jQuery：

```
$(function() {
  function showHideDocuments() {
    $("#accordion").toggle("blind", 500);
  };
  $("#finalised-documents").click(function() {
    showHideDocuments();
    return false;
  });
}); 
```

我真的不知道如何从这里开始。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:13:23.197

对于其他为此苦苦挣扎的人，这里有一个解决方案。使用带有此代码的 jQuery cookie 插件：

```
$(document).ready(function() {
  $('#finalised-documents').click(function () {
if ($('#accordion').is(':hidden')) {
  $('#accordion').slideDown(500);
  $.cookie('forgetmenow', 'showing');
} else if ($('#accordion').is(':visible')) {
  $('#accordion').slideUp(500);
      $.cookie('forgetmenow', 'hidden');
    }
  });   
  if($.cookie('forgetmenow') == 'hidden') {
    $('#accordion').hide();
  };
}); 
```

享受。

# dialog - jQuery datepicker，对话框 - 滚动到选择日期的位置

> ID：15536594
> 
> 赞同：0
> 
> 时间：2013-03-20T23:16:25.770
> 
> 标签：dialog, scroll, datepicker

问题：滚动到 jQuery 对话框中的特定位置

我的网站上有一个内联日期选择器，它显示当前月份的日历。如果用户单击任何日期，我将显示来自 Feed 的日历事件列表。

代码如下：

```
<div id="datepicker" style="font: 80% 'Trebuchet MS', sans-serif;"></div>
                            <script  type="text/javascript">
                                var caldate;
                                $("#datepicker").datepicker();
                                $("#datepicker").change(function() {
                                    caldate = $(this).val(); 

                                    $("#dialog").dialog({
                                        bgiframe: true,
                                        maxHeight: 450,
                                        width: 600,
                                        modal: true,
                                        draggable: true,
                                        resizable: false,
                                        position: 'center',
                                        show: { effect: "fade", duration: 600 },
                                        hide: { effect: "fade", duration: 600 }
                                    });
                                });
                            </script>
                            <div id="dialog" title="Calendar Events">DisplayFeed("Calendar Events")</div> 
```

DisplayFeed 从 html 帮助程序类中检索数据，并正确显示数据。

现在的障碍是当用户在 datepicker 内联中选择特定日期时。我需要从对话框列表中滚动到选定日期发生的事件。

我试图在 div 对话框中获取 html。当我尝试 document.getElementByID("#dialog").innerHTML 比较日期和选择期间捕获的 caldate 时，我得到的错误是未定义的。

任何能让我朝着正确方向前进的想法都会有很大帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T04:06:28.720

通过添加由事件日期生成的特殊 div ID（将日期转换为 Linux 时间戳并作为 ID 添加到 div）解决了该问题，对于每个事件。

然后通过将所选日期转换为 Linux 时间戳并`document.getElementById(linuxtimestamp.toString()).scrollIntoView()`在 javascript 中使用，滚动到所选日期发生的事件。

# javascript - 在表格中显示和隐藏行 - 事情正在发生变化

> ID：15536596
> 
> 赞同：2
> 
> 时间：2013-03-20T23:16:37.447
> 
> 标签：javascript, html

我有一些带有标签的字段，我已将它们放入表格中以进行布局。有一个下拉选择，根据选择显示/隐藏表中的行。我的代码在 IE9 中按我想要的方式工作，但在 Chrome 和 Firefox 中，每次显示以前隐藏的行时，该行的内容都会偏离位置。

有几个字段和多个选择项（我在下面的代码中进行了删减），所以我使用 switch 语句来告诉它要显示和隐藏什么。如何让 Chrome 和 Firefox 像 IE9 一样工作，以便行内容在显示时不会移动？

```
<HTML>
<HEAD>
</HEAD>
<BODY>
<FORM ACTION="#" name=form>
<select name="type" onchange="changeTable()">
<option value="A">A</option>
<option value="B">B</option>
</select>
<BR>
<table ID="options">
<tr>
<td>A, B, C, D</td>
<td><input type=text name="1" size=20 maxlength="20"></td>
</tr>
<tr ID = "A2">
<td>A</td>
<td><input type=text name="2" size=20 maxlength="20"></td>
</tr>
<tr>
<td>A, B, C, D</td>
<td><input type=text name="3" size=10 maxlength="10"></td>
</tr>
<tr ID="A4" style="display:none">
<td>B, D</td>
<td><input type=text name="4" size=10 maxlength="10"></td>
</tr>
<tr ID="A5">
<td>A</td>
<td><select name="5">
<option value="0">0</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
</select>
</td>
</tr>
<tr ID="A6" style="display:none">
<td>A</td>
<td><input type=text name="6" size=20></td>
</tr>
</table>

<script>
function changeTable(){
var type = document.form.type.value;

    switch(type){

case "A": 
    document.getElementById("A2").style.display = 'block';
    document.getElementById("A4").style.display = "none";   
    document.getElementById("A7").style.display = 'none';
    document.getElementById("A8").style.display = 'none';
    document.getElementById("A9").style.display = 'none';
    document.getElementById("A5").style.display = "block";  
    break;

case "B": 
    document.getElementById("A2").style.display = 'none';
    document.getElementById("A4").style.display = "block";
    document.getElementById("A7").style.display = 'none';
    document.getElementById("A8").style.display = 'none';
    document.getElementById("A9").style.display = 'none';
    document.getElementById("A5").style.display = "none";
    document.getElementById("A6").style.display = "none";
    break;
}
}
</script>
</BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T23:30:51.570

首先-您有一个javascript错误，因为元素“7”“8”和“9”不在您的html中。第二 - 将显示块设置为“tr”，因为他的默认设置是“table-row”，所以只需更改代码以将显示设置为“”，当你想显示它们时，它会解决你的 chrome 等问题。 .

```
 case "A": 
    document.getElementById("2").style.display = '';
    document.getElementById("4").style.display = "none";    

    document.getElementById("5").style.display = "";   
    break;

case "B": 
    document.getElementById("2").style.display = 'none';
    document.getElementById("4").style.display = "";

    document.getElementById("5").style.display = "none";
    document.getElementById("6").style.display = "none";
    break; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T23:26:25.897

**ID不能只是一个数字！**

请用字母替换数字

```
document.getElementById("2").style.display = 'block'; 
```

应该是（示例）：

```
document.getElementById("abc").style.display = 'block'; 
```

或者可能

```
document.getElementById("a2").style.display = 'block'; 
```

注意：Chrome（基于 WebKit 的浏览器）对不正确的 HTML 代码非常严格。因此，我强烈建议在开始使用 JavaScript 之前先使用[W3C Validator测试您的 HTML（标记）。](http://validator.w3.org/)

如果这是 HTML5，请添加`<!DOCTYPE html>`

# ios - 未定义的声明错误

> ID：15536599
> 
> 赞同：0
> 
> 时间：2013-03-20T23:17:06.887
> 
> 标签：ios, objective-c

我正在尝试开发一个提供当前纬度和经度值的 iPhone 应用程序，但遇到了一些名为“未定义声明”的错误。你能帮我解决一下吗？提前致谢。

```
#import "LoginViewController.h"
//#import <CoreLocation/CoreLocation.h>

@interface LoginViewController ()

@end

@implementation LoginViewController
@synthesize locationManager;
- (void)dealloc
{
   // [super dealloc];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Do any additional setup after loading the view, typically from a nib.
}

- (IBAction)Button:(id)sender
{
    locationManager = [[CLLocationManager alloc] init];
    locationManager.delegate = self;
    locationManager.desiredAccuracy = kCLLocationAccuracyHundredMeters;
    locationManager.distanceFilter = kCLDistanceFilterNone;
    [locationManager startUpdatingLocation];
    CLLocation *location = [locationManager location];
    CLLocationCoordinate2D coordinate = [location coordinate];
    NSString *latitude = [NSString stringWithFormat:@"%f", coordinate.latitude];
    NSString *longitude = [NSString stringWithFormat:@"%f", coordinate.longitude];
    NSLog(@"dLatitude : %@", latitude);
    NSLog(@"dLongitude : %@", longitude);
    UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(50, 40, 250, 50)];
    UILabel *myLabel = [[UILabel alloc] initWithFrame:CGRectMake(50, 80, 200, 50)];
    UILabel *myLabel1 = [[UILabel alloc] initWithFrame:CGRectMake(50, 120, 200, 100)];
    myLabel.textColor = [UIColor blackColor];
    myLabel1.textColor = [UIColor blackColor];

    label.backgroundColor = [UIColor clearColor];
    myLabel.backgroundColor = [UIColor clearColor];
    myLabel1.backgroundColor = [UIColor clearColor];
    [myLabel setText:latitude];
    [myLabel1 setText:longitude];
    label.text = @"Current Latitude and Longitude";
    [self.view addSubview:label];
    [self.view addSubview:myLabel];
    [self.view addSubview:myLabel1];
}
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait); <---GETTING ERROR HERE

}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:38:19.710

它应该是

```
return (toInterfaceOrientation == UIInterfaceOrientationPortrait); 
```

# ruby-on-rails - 要使用 :country 输入，请安装 country_select 插件

> ID：15536606
> 
> 赞同：8
> 
> 时间：2013-03-20T23:17:54.610
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, activeadmin

我的指南模型有一个国家属性。我不想使用插件，我只想将国家作为字符串。一切正常，直到我尝试在 activeadmin 中编辑指南，然后我收到错误消息：

> ActionView::Template::Error （要使用 :country 输入，请安装 country_select 插件，例如： [https](https://github.com/jamesds/country-select) ://github.com/jamesds/country-select ）：1：insert_tag renderer_for(:edit)

以我的形式我有

```
 <%= f.input :country, as: :string%> 
```

在我的 admin/guidelines.rb 我有

```
index do                            
    column :title   
    column :specialty                
    column :content       
    column :hospital
    column :country   
    column :user
    default_actions                   
  end 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-10-23T18:43:30.150

我不确定你从哪里得到这个表单代码，但我在 Active Admin 上遇到了同样的问题，并通过明确指示表单将字段视为字符串来解决它：

```
ActiveAdmin.register Guideline do

  form do |f|
    f.inputs 'Details' do
      f.input :country, :as => :string
    end
    f.actions
  end

end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-17T11:39:49.137

首先你需要在 GemFile 中添加 gem

```
gem 'country-select' 
```

创建一个帮助文件“/app/helpers/active_admin/views_helper.rb”。添加以下代码

```
module ActiveAdmin::ViewsHelper

  def country_dropdown 
    ActionView::Helpers::FormOptionsHelper::COUNTRIES
  end 
end 
```

在您的视图文件中使用

```
form do |f|
  f.inputs do 
    f.input :country, as: :select, collection: country_dropdown
  end

  f.actions
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-09T06:10:37.430

使用[`country_select`](https://github.com/stefanpenner/country_select). 如果您最近这样做，似乎可以在 Rails 4.1 上正常工作。加上 Rails 旧回购链接到这个而不是国家选择。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-16T19:15:40.063

您正在使用**ActiveAdmin**，因此您也在使用**Formtastic**。

在 Formtastic 中，在文件 formtastic */lib/formtastic/inputs/country_input.rb*中清楚地说：

```
# Rails doesn't come with a `country_select` helper by default any more, so you'll need to do
# one of the following:
#
# * install the [country_select](https://github.com/stefanpenner/country_select) gem
# * install any other country_select plugin that behaves in a similar way
# * roll your own `country_select` helper with the same args and options as the Rails one 
```

我会添加`gem 'country-select'`到您的**Gemfile**并进行**捆绑安装**，这是最简单和最快的解决方案。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-05-06T22:12:28.387

我想你可以安装 gem，然后覆盖 active_admin 中的显示。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2014-04-02T08:57:22.940

我建议您使用`country-select`：

```
gem 'country-select' 
```

我花了很多时间来找出为什么 country-select 在我的表单中不起作用:)

# objective-c - 如何在 Objective-C 中调用方法？

> ID：15536607
> 
> 赞同：-3
> 
> 时间：2013-03-20T23:17:56.400
> 
> 标签：objective-c

我刚开始使用 ios 并试图制作用户定义的函数......

我的代码：

```
-(void) testFunction{
    //has self. calls
}

 -(IBAction)button:(id)sender { 
       testFunction();
} 
```

我收到警告：函数的隐式声明在 C99 中无效

我究竟做错了什么？或者我必须在我的代码中添加什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:20:18.867

在 Objective-C 中你不能写`testFunction()`. 您发送“消息”，您可以通过

```
[self testFunction] 
```

# three.js - Three.js 中单个平面上的谷歌地图风格的材质四叉树 - 1x1、2x2、4x4 和 8x8

> ID：15536609
> 
> 赞同：1
> 
> 时间：2013-03-20T23:18:05.637
> 
> 标签：three.js

我正在尝试但未能解决如何在单个平面上实现材质（图像）的四叉树，就像谷歌地图风格的可缩放瓷砖越接近越精确。

简而言之，我希望能够拥有一个 1x1 图像纹理（覆盖一个 256 单位宽和高的平面），然后可以用 2x2 纹理替换，然后可以用 4x4 纹理替换，依此类推。

就像下面的图片示例……</p>

![纹理级别](../Images/b16629ae5e10e83a4e1a745ff2cc6a97.png)

理想情况下，我想避免为每个缩放级别/段数创建不同的平面。一个完美的解决方案将允许我将单个平面分成 8x8 段（最高缩放）并即时更新纹理数量。所以它会从所有 64 (8x8) 段的 1x1 纹理开始，然后变为 2x2 纹理，每个纹理覆盖 4x4 段，依此类推。

不幸的是，我无法弄清楚如何做到这一点。我探索了`materialIndex`为每个面设置，但您无法在第一次渲染后更新它们，因此这不起作用。我试过查看 UV 坐标，但我不明白它在这种情况下是如何工作的，也不明白如何在 Three.js 中实际实现它——对于这种特定情况，文档/示例的方式很少。

顶点着色器是研究中出现的另一种选择，但我又一次不知道如何构建它。

我将不胜感激任何和所有的帮助，我敢肯定，这将是一种对其他 Three.js 用户很有价值的技术。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:56:40.680

不是 100% 确定您正在尝试做什么，无论您是在谈论纹理图集（查找和基于当前设置/缩放的不同纹理），但是如果您正在寻找基于四叉树的纹理，当您放大时会增加细节那么这本质上就是 mipmaping 的作用。

（因此，它也可以用来做各种奇怪的事情，但这完全是另一种冒险）

通常 mipmapping 是根据您使用的过滤自动进行的 - 但是听起来您需要对它进行更多控制。

我创建了一个隐藏在 three.js 源代码树中的示例，这可能会有所帮助：

[http://mrdoob.github.com/three.js/examples/webgl_materials_texture_manualmipmap.html](http://mrdoob.github.com/three.js/examples/webgl_materials_texture_manualmipmap.html)

它向您展示了如何手动加载每个 mipmap 级别，而不是让它自动生成。

高温高压

# powershell - 如何将自定义过滤器功能传递给 Where-Object

> ID：15536611
> 
> 赞同：0
> 
> 时间：2013-03-20T23:18:22.550
> 
> 标签：powershell, powershell-2.0

在过去的几个小时里，我试图弄清楚如何将脚本块传递给一个函数，以用作 where 对象的过滤器。我还没有找到任何文档，我一定是遗漏了一些东西。我在[PowerShell 的推荐编码风格是什么？](https://stackoverflow.com/questions/2025989/what-is-the-recommended-coding-style-for-powershell)但我不知道这些是如何使用的，我在任何地方都找不到。

```
function Test
{
    Param(
            $f,     
            $What
    )

    $x = $What | where $f
    $x
}

$mywhat = @('aaa', 'b', 'abb', 'bac') 
filter script:myfilter {$_ -like 'a*'}
Test -What $mywhat -xx $myfilter 
```

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:39:45.707

目前还不清楚你在这里要求什么。

过滤器是一个函数，而不是一个脚本块。`where-object`将脚本块作为输入。如果要使用参数指定函数内的 where 条件，可以使用 scriptblock-parameter。

```
function Test
{
    Param(
            [scriptblock]$f,     
            $What
    )

    $x = $What | where $f
    $x
}

$myfilter = {$_ -like 'a*'}
Test -What $mywhat -f $myfilter

#or combine them
Test -What $mywhat -f {$_ -like 'a*'} 
```

如果您只是想使用过滤器，那么可以这样做：

```
filter script:myfilter { if($_ -like 'a*') { $_ }}

$mywhat | myfilter 
```

那将等于`$mywhat | where {$_ -like 'a*'}`

# javascript - 与backbone.js 的用户会话

> ID：15536612
> 
> 赞同：0
> 
> 时间：2013-03-20T23:18:23.553
> 
> 标签：javascript, jquery, backbone.js, requirejs

我正在使用 Backbone.js 和 require.js 编写一个 Web 应用程序，它需要存储用户信息以在用户登录时在整个应用程序中使用。目前，当用户在那里提交凭据时，Web 服务会对用户进行身份验证并返回有关该用户的数据。传统上，我可以将这些信息存储在会话中。如何使用 Backbone 完成此任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:48:50.227

您可能希望为此使用 HTML5 [SessionStorage](http://www.w3schools.com/html/html5_webstorage.asp)。看看[这个](https://gist.github.com/davemo/3875274)SessionStorageAdpater 进行骨干集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:50:56.950

通常，将身份验证信息存储在加密的 cookie 中，该 cookie 在每次请求时发送到服务器。这本质上是将登录用户与 Web 服务器的身份存储相关联的值。

您可能对个人资料数据（即关于用户的元数据——名字、生日等）更感兴趣。用户登录后，当页面加载时，通过对服务器的 ajax 调用获取有关当前用户的配置文件数据（请求将包括 auth cookie，Web 框架将使用该 cookie 来查找当前登录的用户） . 因此，您应该在您的 Web 应用程序上公开一个路由，该路由返回一个 json 数据结构，其中包含您的应用程序需要的有关当前用户的配置文件数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:57:11.290

我目前正在编写一个大型 Backbone / Marionette 应用程序。我将用户信息（不是密码或其他类似信息）存储在名为 user 的模型中。然后我使用这个模型首先通过检查 sessionid 来验证用户。

```
// before every request
if (app.Core.models.user.get('sessionid') != "") {
  // then I run the code.  Authentication can still fail on the server.
} else {
  // trigger the event to bring up the sign in page
  app.vent.trigger('App:Core:Login');
} 
```

用户登录应用程序后，我将通过身份验证收到的信息保存在`app.Core.models.user`模型中。由于我的身份验证不返回完整的用户名，因此我进行了单独的 ajax 调用来检索此信息并将该信息也存储在模型中。然后我将模型绑定到我的页面的一部分，该部分会自动更新页面标题中的用户名。

浏览器会自动存储一个加密的 cookie，因此我不必将任何此类信息发送回服务器。

# mysql - phonegap外部存储

> ID：15536613
> 
> 赞同：0
> 
> 时间：2013-03-20T23:18:23.930
> 
> 标签：mysql, database, cordova, websocket

我正在使用 phonegap 制作 iphone 和 android 应用程序。我需要能够在我的服务器上的 mysql 数据库中存储数据以及使用我的 websocket 服务器。

由于应用程序将在无法在外部服务器上运行 ajax/websocket 请求的本地 html 和 javascript 文件上运行，我该如何做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T23:43:51.007

因此，让我将我的评论转换为答案。

您需要一个客户端-服务器架构，其中客户端将是您的所有终端设备。在这种情况下，服务器需要是某个地方的全局可访问主机（也许是亚马逊云？）。

**您的设备将使用ajax**调用将更新发送到与您的数据库连接的后端服务器。这些更新将存储在服务器上。

您的所有其他客户端都需要使用**ajax**定期轮询同一后端服务器，并将获取从您的主设备发送的更新。

# grammar - 将 LR(2) 语法转换为 LR(1)

> ID：15536614
> 
> 赞同：1
> 
> 时间：2013-03-20T23:18:24.900
> 
> 标签：grammar, lr

我有一个练习，其中我有 LR(2) 语法，我想转换为 LR(1) 语法。但我不明白我怎么能做到这一点。我有这个语法（4条规则）：

*   e->真| 假 | 编号 | e ^ e | 前夕 | (e)
*   i -> 如果 e 则 i | 如果 e 那么我 否则我 | id = e | (一) | 嘛
*   马 -> 一个 | 一个^马
*   a -> id = e

这种语法的问题是她产生了减少/减少冲突（没有人喜欢这样）。所以我需要在 LR(1) 中改变这个语法，但我真的看不到这样做的算法。请帮忙 ：）

# python - 类似 jarvis 的 ai python 应用程序

> ID：15536618
> 
> 赞同：0
> 
> 时间：2013-03-20T23:18:36.833
> 
> 标签：python, string, artificial-intelligence, string-matching

所以我们都看过钢铁侠，对吧？作为一个个人项目，我正在尝试创建一个类似 jarvis 的 AI。我无论如何都不需要像 jarvis 那样复杂的东西；这只是我能想到的最好的描述。

我首先研究了对话式人工智能——聊天机器人——但这不是我需要的。我觉得该方法以与我正在寻找的方式截然不同且更复杂的方式处理用户输入。我需要的只是给ai一个命令，让ai匹配该命令并运行适当的代码。

所以后来我偶然发现了libdiff。但这并不能充分满足我的目的。libdiff，据我所知，不会匹配措辞乱序的字符串。据我所知，至少，两个字符串中的措辞顺序必须相同，libdiff 才能进行匹配。

例如：
用户输入：“现在几点？”
不会匹配它*应该*匹配的命令：“现在几点？”

我不是要勺子代码，但有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:37:58.217

您正在尝试构建[专家系统](http://en.wikipedia.org/wiki/Expert_system)。

看看这本书[Prolog Programming for Artificial Intelligence - Ivan Bratko](https://rads.stackoverflow.com/amzn/click/com/0321417461)。在第 14 章中，他谈到了专家系统。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T00:24:20.627

很酷的项目，这是我的第一个想法。我想首先你需要语音到文本，这样你就可以有效地处理命令。然后，您可以在此之上应用更复杂的方法。有[https://code.google.com/p/dragonfly/](https://code.google.com/p/dragonfly/)，但我发现它对于破解一个快速项目来说有点太多了，我认为主要支持 Windows。但是，也许有人为这类事情提供免费休息服务，谷歌在这里做得很好[http://updates.html5rocks.com/2013/01/Voice-Driven-Web-Apps-Introduction-to- the-Web-Speech-API](http://updates.html5rocks.com/2013/01/Voice-Driven-Web-Apps-Introduction-to-the-Web-Speech-API)，但我认为没有 python 绑定。

然后，下一个任务将是尝试在文本中找到意义。因此，您需要一个解析器（[http://nltk.org/index.html](http://nltk.org/index.html)）来查看诸如“what”和主题“time”之类的问题词，或某种类型的词性标记。当然，在一般设置中正确执行此操作（任意输入要困难得多）。拥有一些内置命令然后在以后工作到更高的通用性可能要容易得多。

如果您想实时执行此操作，则更具挑战性，因为您需要对实时音频流进行分段以确定一个句子何时结束以及另一个句子何时开始。

假设，你想先解决一个更简单的问题。假设只需通过麦克风识别单个命令，例如“打开”一词，然后执行一个动作。如果你愿意训练你的声音，你可以很容易地做到这一点。受此[http://xa.yimg.com/kq/groups/24321415/1523383180/name/Speech_Recognition_seminar.pdf](http://xa.yimg.com/kq/groups/24321415/1523383180/name/Speech_Recognition_seminar.pdf)的启发。您需要 pyaudio、numpy、scipy，如果您想查看在 python 中实现此功能的代码，请参阅[https://gist.github.com/a-wild-tigger/5209781](https://gist.github.com/a-wild-tigger/5209781)

# c++ - 如何将 .pkg 文件中的一组库导入 Xcode 4.6？

> ID：15536620
> 
> 赞同：0
> 
> 时间：2013-03-20T23:18:52.003
> 
> 标签：c++, xcode4.6

我目前正在学习一些不同的在线编程课程，其中之一是斯坦福编程抽象课程。他们有一组用于该类的默认库。

您可以在此处下载该软件包：http: [//see.stanford.edu/materials/icspacs106b/cs106libs_for_xcode.zip](http://see.stanford.edu/materials/icspacs106b/cs106libs_for_xcode.zip)

我需要帮助来弄清楚如何将这个库包放入 Xcode，以便我可以将它们与我编写的程序一起使用。我该如何去做，所以当我创建一个新项目时，我可以在标准 C++ 库之上创建一个准备好这些库的项目。

提前致谢！

编辑：我确实安装了 .pkg 文件，但我没有安装它。如何在 Xcode 中使用已安装的库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:21:33.797

厄运。从这个页面：

[如何在 X-Code 4 中安装外部库](http://www.techques.com/question/1-9687103/How-to-install-external-library-in-X-Code-4)

> 您需要安装 XCode 3.0 才能使用 CS106LibrariesForXcode.pkg 库。
> 
> 与 XCode 3 相比，XCode 4 具有非常不同的 UI 和功能。因此仅研究 XCode 3 是不明智的。但是，如果您要使用这些教程学习 C++，您可能需要安装 XCode 3 并使用它。

* * *

**旧答案**[不适用]

如果包是 pkg 文件，你实际上需要安装它。双击它，按照步骤操作。

如果您有警告信息，

> CS106LibrariesForXcode.pkg”无法打开，因为它来自身份不明的开发人员。

然后右键单击（或 ctrl+单击）并选择打开。然后警告将有一个打开选项，允许您打开包。

完成后，只需编写一个新程序，并包含您需要的标题。

# python - 就地修改 dict 值

> ID：15536623
> 
> 赞同：11
> 
> 时间：2013-03-20T23:18:58.017
> 
> 标签：python, map, dictionary, functional-programming

我想将一个函数应用于`dict`inplace 中的值`dict`（就像`map`在函数式编程设置中一样）。

假设我有这个`dict`：

```
d = { 'a':2, 'b':3 } 
```

我想将该函数`divide by 2.0`应用于字典的所有值，导致：

```
d = { 'a':1., 'b':1.5 } 
```

最简单的方法是什么？

我使用*Python 3*。

**编辑：** 单线会很好。这`divide by 2`只是一个例子，我需要函数作为参数。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-20T23:28:35.437

您可能会发现乘法仍然比除法更快

```
d2 = {k: v * 0.5 for k, v in d.items()} 
```

对于就地版本

```
d.update((k, v * 0.5) for k,v in d.items()) 
```

对于一般情况

```
def f(x)
    """Divide the parameter by 2"""
    return x / 2.0

d2 = {k: f(v) for k, v in d.items()} 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-03-20T23:22:42.000

您可以遍历密钥并更新它们：

```
for key, value in d.items():
    d[key] = value / 2 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-03-20T23:25:11.783

应该为你工作：

```
>>> d = {'a':2.0, 'b':3.0}
>>> for x in d:
...     d[x]/=2
... 
>>> d
{'a': 1.0, 'b': 1.5} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-20T23:20:04.063

```
>>> d = { 'a': 2, 'b': 3 }
>>> {k: v / 2.0 for k, v in d.items()}
{'a': 1.0, 'b': 1.5} 
```

# file - Cassandra 在读/写期间会锁定数据目录中的文件吗？

> ID：15536624
> 
> 赞同：0
> 
> 时间：2013-03-20T23:19:00.973
> 
> 标签：file, operating-system, filesystems, cassandra

我知道 Cassandra 在线时可以拍摄快照。这样做是在每个列族目录中创建一个快照子目录，并在其中放置列族的副本。但我不知道这是否可能，因为根本没有文件锁定，或者快照指令是否只是在复制文件之前等待文件解锁。

有谁知道 Cassandra 如何与数据目录中的文件交互？另外，行为操作系统是否依赖？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T09:57:10.680

首先，重要的是要意识到 Cassandra 数据目录中的所有文件都是一次性写入的。没有文件被修改，它被创建，然后最终与其他文件合并，然后被删除。（这就是 Cassandra 获得如此好的写入性能的原因，因为写入的所有磁盘访问都是顺序的。）

另一件事是拍摄快照不会复制文件，它会创建一个硬链接。这是有效的，因为文件是只读的，因此不需要复制。

因此，不需要文件锁定。

# php - 用户已存在，请填写表格

> ID：15536627
> 
> 赞同：-2
> 
> 时间：2013-03-20T23:19:23.190
> 
> 标签：php, mysql

这是我迄今为止注册用户的代码。

现在我需要：

*   如果用户名已被占用，则返回错误消息
*   如果字段为空，则显示错误消息

这是代码：

```
//=============Configuring Server and Database=======
$host        =    'localhost';
$user        =    'root';
$password    =    'revilo';
//=============Data Base Information=================
$database    =    'dbsneaker';

$conn        =    mysql_connect($host,$user,$password) or die('Server Information is not Correct'); //Establish Connection with Server
mysql_select_db($database,$conn) or die('Database Information is not correct');

//===============End Server Configuration============

//=============Starting Registration Script==========

$userName    =    mysql_real_escape_string($_POST['txtUser']);

$password    =    mysql_real_escape_string($_POST['txtPassword']);

if(isset($_POST['btnRegister'])) //===When I will Set the Button to 1 or Press Button    to register
{
$query    =    "insert into bladmin(admin_usr_name, admin_pwd) values('$userName', '$password')";
$res    =    mysql_query($query);
header('location:success_register.php');
} 
```

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:26:30.707

我认为这会有所帮助...

```
// Validate empty
if(!trim($userName) || !trim($password)){
    // Some field still empty
}else{
    // There's no empty field
    // Check user exists
    $checkQuerySql = "SELECT * FROM `bladmin` WHERE `admin_usr_name` = '$userName'";
    $checkQuery = mysql_query($checkQuerySql);
    if(mysql_fetch_assoc($checkQuery)){
        // User exists
    }else{
        // User doesnt exists
    }
} 
```

# .net - 使用列表 使用 Azure 表存储

> ID：15536630
> 
> 赞同：15
> 
> 时间：2013-03-20T23:19:34.507
> 
> 标签：.net, list, azure, azure-storage

我目前正在使用 Windows Azure 表存储机制，它有一个扩展 TableEntity 的类。但是，此类的字段之一是 List。从表中取回实体时，它作为 DynamicTableEntity 而不是普通的表实体返回。有没有办法从表中获取列表而不是序列化列表并将其存储在 blob 中？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-21T03:44:19.380

您可能已经知道，Azure 表存储本身并不支持复杂的数据类型。有关支持的数据类型的列表，请参见此处：http: [//msdn.microsoft.com/en-us/library/windowsazure/dd179338.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/dd179338.aspx)。

一种选择是将此列表序列化为您提到的分隔字符串。

其他选择是使用 Lucifure Stash ( [http://lucifurestash.codeplex.com/](http://lucifurestash.codeplex.com/) ) 之类的第 3 方库。我自己没有使用过它，但文档指出您可以将数组和列表作为实体存储在 Azure 表中。

# php - Javascript HTML按钮单击不起作用

> ID：15536634
> 
> 赞同：1
> 
> 时间：2013-03-20T23:20:04.763
> 
> 标签：php, javascript, ajax, html

我使用 HTML、JavaScript、Ajax 和 PHP 创建了一个登录系统。

我现在正在尝试实现注销功能，这就是我所拥有的：

首先在我的 html 中有一个 div，它表示欢迎网站上未登录的任何人：

```
<div id="welcome" style="postion:absolute; top:0; float:right;">Welcome to SIK!!!!</div> 
```

然后我有一个 JavaScript 函数，当用户登录或注册时调用它来修改 div 以向特定用户打招呼，并显示一个注销按钮。

```
function show_logged_in(success)
{

    var is_logged_in = success;

    var dataString = {"reg":invalid, "login":invalid,"is_logged_in":is_logged_in};

    $.ajax({
        type:"POST",
        url:"PHP/class.ajax.php",
        data:dataString,
        dataType:'JSON',
        success: function(username) {
            alert("User is shown");
            user = username;
            $('#welcome').html('<p>Hi ' + user + '</p><p><button id="logout_but" 
   type="button">Log Out</button></p>');
        },
        error: function() {
            alert("ERROR in show_logged_in");
        }
    });
} 
```

然后当用户单击注销时，在我的主 js 文件中有一个函数：

```
$("#logout_but").click(ui.logout); 
```

这是我的主要js文件：

```
$(document).ready(function(){

//----------Login/Register Gui --------------
$('#load-new').hide();
$('#reg').hide();
$('#login').hide();

//create new instance of gui class
var ui = new Gui();

//if login_but is clicked do ui.login function
$('#login_but').click(ui.login);
//if reg_but is clicked do ui.register function
$('#reg_but').click(ui.register);
//if login_sumbit button is clicked do ui.login_ajax function
$("#login_submit").click(ui.login_ajax);

$("#reg_submit").click(ui.register_ajax);

$("#logout_but").click(ui.logout);

}); 
```

所以现在你可以看到调用的顺序，并且为注销按钮调用的点击函数是：

```
this.logout = function() {

    alert("clicked");

    var dataString = {"is_logged_out":invalid};

    $.ajax({
        type:"POST",
        url:"PHP/class.logout.php",
        data:dataString,
        dataType:'JSON',
        success: function(success){
            alert("User is logged out");
            $('#welcome').html('<p>Welcome to SIK</p>');
        },
        error: function() {
            alert('ERROR in log out');
        }
    })

} 
```

如您所见，我在发布的最后一个函数的顶部有警告，以显示该函数是否实际被调用。

我的问题是当我单击注销按钮时没有任何反应。我也没有看到警报，因此问题发生在点击时。

在这种情况下的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:23:16.533

这是因为您动态创建了注销按钮，并且在单击处理程序尝试将自身附加到主 js 文件中的元素之后。结果，处理程序找不到`#logout_but`元素，因此不附加到任何东西。

要解决这个问题，您可以使用委托而不是点击处理程序：

替换这个：

```
$("#logout_but").click(ui.logout); 
```

和

```
$("#welcome").on("click", "#logout_but", ui.logout); 
```

# git - git：从另一个分支签出文件到当前分支（不要将 HEAD 切换到另一个分支）

> ID：15536639
> 
> 赞同：64
> 
> 时间：2013-03-20T23:20:18.467
> 
> 标签：git, branch, git-checkout

我想将另一个分支中存在的文件的不同版本加载到我当前的分支中。

`git help checkout`说：

```
DESCRIPTION
   Updates files in the working tree to match the version in the index or
   the specified tree. If no paths are given, git checkout will also
   update HEAD to set the specified branch as the current branch. 
```

有没有办法检查所有这些文件，但*不*更新 HEAD？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-03-20T23:20:18.467

通过提供当前路径结帐，`.`：

`git checkout other-branch-name -- .`

这个操作类似于在[不签出文件的情况下将 HEAD 切换到另一个分支](https://stackoverflow.com/questions/1282639/switch-git-branch-without-files-checkout)，但只是从“另一个方向”。

正如@김민준 所提到的，这会覆盖任何未提交的更改。如果需要，请记住先将它们存储或提交到某个地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-06-08T06:05:55.707

与[@Kache 的回答](https://stackoverflow.com/a/15536640/5532169)类似，但使用较新的[`git restore`](https://git-scm.com/docs/git-restore)命令（需要 Git 2.23 或更高版本）：

```
git restore --source=<other-branch/tag/commit> <pathspec>
# or
git restore -s <other-branch/tag/commit> <pathspec>

# example: to load all files from branch "other"
git restore -s other . 
```

引入这个新命令是为了将“签出分支”和“签出文件”从单个`git checkout`命令中分离出来。阅读更多：[什么是`git restore`命令](https://stackoverflow.com/q/58003030/5532169)。

# page-object-gem - 从 page-object-gem 调用 prompt 方法时出现 JavaScript 错误

> ID：15536645
> 
> 赞同：0
> 
> 时间：2013-03-20T23:20:42.783
> 
> 标签：page-object-gem

```
Scenario: Testing with prompt popups
Given I am on the frames page
When I popup the prompt and enter "Jared Gatorboy"
  SyntaxError: missing ; before statement (Selenium::WebDriver::Error::JavascriptError)
  ./features/support/pages/frames_page.rb:35:in `block in prompt_value'
  ./features/support/pages/frames_page.rb:34:in `prompt_value'
  ./features/step_definitions/web01_steps.rb:35:in `block (2 levels) in <top (required)>'
  ./features/step_definitions/web01_steps.rb:34:in `/^I popup the prompt and enter "(.*?)"$/'
  features/web01.feature:20:in `When I popup the prompt and enter "Jared Gatorboy"'
Then the message from the prompt should read "enter your name"
And the default value from the prompt should be "John Doe" 
```

./features/support/pages/frames_page.rb

```
def prompt_value(value)
in_frame(:id => 'frame_3') do |frame|
  @prompt_response = prompt(value, frame) do
    button_element(:id => 'prompt_button', :frame => frame).click
  end 
 end
 @prompt_response
end 
```

./features/step_definitions/web01_steps.rb

```
When(/^I popup the prompt and enter "(.*?)"$/) do |value_to_enter|
 on_page(FramesPage) do |page|
  @prompt_response = page.prompt_value(value_to_enter)
 end
end 
```

[应用网址](http://puppies.herokuapp.com/frames.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T17:00:25.647

您能告诉我您使用的是什么浏览器和驱动程序吗？在页面对象测试套件中有一个使用此页面的测试。这是步骤定义

```
When /^I trigger a prompt within a frame$/ do
  @page.in_frame(:id => 'frame_3') do |frame|
    @msg = @page.prompt("Cheezy", frame) do
      @page.button_element(:id => 'prompt_button', :frame => frame).click
    end
  end
end 
```

它看起来与您在步骤中的逻辑相同，并且测试使用 selenium-webdriver 和 watir-webdriver 作为驱动程序使用最新的 firefox。

# iphone - 暂停应用选项

> ID：15536650
> 
> 赞同：0
> 
> 时间：2013-03-20T23:21:04.363
> 
> 标签：iphone

我有一个应用程序，我将它设置为不在后台运行，但一些人希望选择让它从他们离开的地方恢复，而一些人只是希望它在他们点击时从头开始主页按钮并重新启动到应用程序。如何添加开/关开关以向用户提供选项？我的应用程序是带有抽认卡和 pdf 的教育/参考应用程序。

谢谢

Ĵ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:49:08.670

[如此处](http://useyourloaf.com/blog/2010/05/18/adding-a-settings-bundle-to-an-iphone-app.html)所述创建设置包。

将您的设置添加为布尔值。让它默认为大多数人使用您的应用程序的方式。

现在在启动时读取设置的值并采取相应的行动。该设置将显示在您的应用名称下的“系统偏好设置”应用中。

# vector - Gnuplot：如何从向量场中删除低于一定幅度的向量？

> ID：15536651
> 
> 赞同：0
> 
> 时间：2013-03-20T23:21:21.137
> 
> 标签：vector, field, gnuplot

我有一个二维 CFD 代码，它给出了网格上每个点的 x 和 y 流速。我目前正在使用 gnuplot 中的矢量场来可视化数据。我的目标是看看喷发后的羽流延伸了多远，所以如果我能阻止矢量在低于一定量级时出现在现场，那会更干净。有谁知道如何去做？我当前的 gnuplot 脚本如下。我还可以根据需要修改输入文件。

```
reset
set nokey
set term png
set xrange [0:5.1]
set yrange [0:10.1]
do for [i=0:10] {
    set title 'Eruption simulation: Timestep '.i
    set output 'path/FlowVel'.sprintf('%04.0f',i).'.png'
    plot 'path/Flow'.sprintf('%04.0f',i).'.dat' using 1:2:3:4 with vec
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T06:31:48.980

我猜你想要一种 gnuplot 没有的过滤，但可以通过以下技巧来实现（取自 gnuplot 中的“帮助使用示例”）：

```
 One trick is to use the ternary `?:` operator to filter data:

       plot 'file' using 1:($3>10 ? $2 : 1/0)

 which plots the datum in column two against that in column one provided
 the datum in column three exceeds ten.  `1/0` is undefined; `gnuplot`
 quietly ignores undefined points, so unsuitable points are suppressed.
 Or you can use the pre-defined variable NaN to achieve the same result. 
```

所以我想你会想要这样的东西

```
plot "data.dat" u 1:2:($3**2+$4**2>mag_sq?$3:NaN):($3**2+$4**2>mag_sq?$4:NaN) w vector 
```

其中 mag_sq 是您想要的幅度的平方。

# php - 使用 ASIFormDataRequest 将 UIImage 从 UIImagePickerController 发送到 PHP 服务器

> ID：15536652
> 
> 赞同：1
> 
> 时间：2013-03-20T23:21:24.093
> 
> 标签：php, ios, objective-c, uiimagepickercontroller, asihttprequest

在当前的项目中，我实现了一个`UITableViewController`收集某些数据并根据用户请求将其发送到后端服务器的方法。这一切都很好，花花公子..但是，我在上传图片时遇到了问题。

一旦我得到图像`UIImagePickerController`并发送它，服务器似乎就有问题。如果我将其编码为 JPEG，PHP 似乎无法理解它......如果我将其编码为 PNG，整个请求似乎会搞砸。

但是，如果我选择项目中存在的任何其他图像（例如一些背景图像），则上传过程完美！那是奇怪的部分。一旦我使用 UIImagePickerController 中的图像，它就不起作用......即使我确实得到了图像（参见代码中的 addSubview，它有效）。

这是我的代码：

```
@interface ServiceViewController ()

@property (nonatomic) UIImage *image;
[...]

@end

@implementation ServiceViewController

@synthesize image = _image;
[...]

- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    self.image = [[info objectForKey:UIImagePickerControllerOriginalImage] copy];

    [self.tableView reloadData];

    [self dismissModalViewControllerAnimated:YES];
}

- (void)sendToApi
{
    // Send post data
    NSString *urlString = [NSString stringWithFormat:@"%@/%@", API_BASE_DOMAIN2, @"requestservice"];
    urlString = @"http://localhost/api/public_html/requestservice";

    NSURL *url = [NSURL URLWithString:urlString];

    ASIFormDataRequest *request = [[ASIFormDataRequest alloc] initWithURL:url];
    [request setUseKeychainPersistence:YES];
    [request setPostValue:[self.problems objectAtIndex:self.problem] forKey:@"problem"];
    [request setPostValue:[self stationName] forKey:@"station"];
    [request setPostValue:self.otherInformation forKey:@"information"];
    [request setPostValue:[NSNumber numberWithInt:self.lock] forKey:@"lock"];
    [request setUploadProgressDelegate:self];
    [request setDidFinishSelector:@selector(didCompleteRequestService:)];
    [request setDidFailSelector:@selector(processFailed:)];
    [request setDelegate:self];
    [request setRequestMethod:@"POST"];

    // Upload an image
    [request addData:[NSData dataWithData:UIImageJPEGRepresentation(self.image, 0.9)] withFileName:@"img.jpg" andContentType:@"image/jpeg" forKey:@"picture"];

    UIImageView *view = [[UIImageView alloc] initWithImage:self.image];
    [view sizeToFit];
    [self.view addSubview:view];

    [request startAsynchronous];
}

- (void)setProgress:(float)newProgress {
//    [prgressView setProgress:newProgress];
    NSLog(@"New progress: %f", newProgress);
}

- (void)didCompleteRequestService:(ASIHTTPRequest *)request
{
    NSLog(@"Request completed");
    NSLog(@"Result: %@", request.responseString);
} 
```

服务器端：

```
 var_dump($_FILES);

    if ($this->_aPicture !== null) {
        $sTarget = DIR_SERVICE . $this->_sFileNamePrefix . ".jpg";

        var_dump($this->_aPicture);
        var_dump($sTarget);

        if (!move_uploaded_file($this->_aPicture['tmp_name'], $sTarget)) {
            $this->returnHttpError(500);
        }
    }

    $this->_writeDataToFile(); 
```

这是我的结果：

```
2013-03-21 00:04:04.859 AppName[15598:c07] New progress: 0.000000
2013-03-21 00:04:04.862 AppName[15598:c07] New progress: 1.000000
2013-03-21 00:04:04.863 AppName[15598:c07] Request completed
2013-03-21 00:04:04.863 AppName[15598:c07] Result: array(1) {
  ["picture"]=>
  array(5) {
    ["name"]=>
    string(7) "img.jpg"
    ["type"]=>
    string(0) ""
    ["tmp_name"]=>
    string(0) ""
    ["error"]=>
    int(1)
    ["size"]=>
    int(0)
  }
}
array(5) {
  ["name"]=>
  string(7) "img.jpg"
  ["type"]=>
  string(0) ""
  ["tmp_name"]=>
  string(0) ""
  ["error"]=>
  int(1)
  ["size"]=>
  int(0)
}
string(58) "/Users/paulp/Sites/api/service/K98XQPo7zx.jpg"
Sending error: 500 
```

我尝试了很多不同的东西，例如：

*   [如何上传从 UIImagePickerController 获取的图像](https://stackoverflow.com/questions/12138484/how-to-upload-image-that-was-taken-from-uiimagepickercontroller)
*   [上传使用 UIImagePickerController](https://stackoverflow.com/questions/9559227/upload-picture-selected-using-uiimagepickercontroller) 等选择的图片。

我没有更改为例如 MKNetworkKit，因为（还）没有时间或预算，所以这不是一个解决方案。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T07:09:49.850

保存所选图像

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)img editingInfo:(NSDictionary *)editInfo {

    //Save selected image to document directory
    jpgPath = [NSHomeDirectory() stringByAppendingPathComponent:@"Documents/Test.jpg"];
    [UIImageJPEGRepresentation(img, 1.0) writeToFile:jpgPath atomically:YES];
    [picker dismissModalViewControllerAnimated:YES];
} 
```

然后使用`ASIFormDataRequest`'s`setFile:forKey`方法将图像发送到服务器

```
ASIFormDataRequest *request = [ASIFormDataRequest requestWithURL:url];
if (jpgPath.length > 0) {
     [request setFile:jpgPath forKey:@"image"]; 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T20:16:18.280

最后，我以前的代码运行良好……原来是我的 PHP 设置不正确。在我的`php.ini`文件中，配置值`upload_max_filesize`设置为默认值`2M`。将其更改为它后，`200M`它工作得很好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:11:34.000

试试这个代码，它非常适合我：

```
[request addData:UIImagePNGRepresentation(image) withFileName:@"image.png" andContentType:@"multipart/form-data" forKey:@"image"]; 
```

# highcharts - highcharts 到底有多灵活？（附上样机。）

> ID：15536664
> 
> 赞同：0
> 
> 时间：2013-03-20T23:22:04.800
> 
> 标签：highcharts

我们已经制作了一些想要包含在我们网站上的图表模型，如果我们可以使用 Highcharts，我们会很高兴。但是我们看到的很多 Highcharts 作品看起来都差不多……

Highcharts 的可定制性如何？我们可以想象用它来创建看起来与这些模型*完全一样的图表吗？*例如与

*   移动平均线
*   指示高低的有吸引力的点
*   纯装饰渐变
*   “关键”覆盖显示什么颜色线代表什么

所以你怎么看？如果我们破解了足够多的 Javascript 和样式，Highcharts 是否能胜任这项工作？

样机：[http ://cl.ly/image/1f0m3l241e2S](http://cl.ly/image/1f0m3l241e2S)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:16:59.033

是的，你绝对可以用 HighCharts 做这些事情！我在这里工作的座右铭是“一切皆有可能”。

对于指示高点和低点的点，您将要使用“符号”来表示此示例中的点：http: [//jsfiddle.net/gh/get/jquery/1.7.2/highslide-software /highcharts.com/tree/master/samples/highcharts/demo/spline-symbols/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/spline-symbols/)

```
data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, {
                y: 26.5,
                marker: {
                    symbol: 'url(http://www.highcharts.com/demo/gfx/sun.png)'
                }
            }, 23.3, 18.3, 13.9, 9.6] 
```

对于渐变，您可以使用 SVG 的“线性渐变”功能并将其附加到背景颜色上。这是一个例子：http: [//jsfiddle.net/WNDUH/10/](http://jsfiddle.net/WNDUH/10/)你将要使用的是“停止”来改变不透明度和颜色（也可以使用 300 来获得正确的高度） ：

```
fillColor : {
          linearGradient : [0, 0, 0, 300],
          stops : [
            [0, Highcharts.getOptions().colors[0]],
            [1, 'rgba(2,0,0,0)']
          ]
        }, 
```

至于关键覆盖，那是你的标准图例，就像这样绝对定位：http: [//jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/ highcharts/demo/bar-basic/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/bar-basic/)

```
legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'top',
            x: -100,
            y: 100,
            floating: true,
            borderWidth: 1,
            backgroundColor: '#FFFFFF',
            shadow: true
        }, 
```

至于移动平均线，这基本上是它自己计算的系列。

就像@nathancahill 所说的那样，有一条学习曲线，但看起来你所要求的大部分内容都可以在不“破解” HighCharts 中的任何内容的情况下完成。

希望对您有所帮助！

# c - 使用 openssl 从 x509 字符数组中提取 RSA 公钥

> ID：15536666
> 
> 赞同：4
> 
> 时间：2013-03-20T23:22:07.697
> 
> 标签：c, openssl

这是存储公钥和模数的 x509 格式的证书：

```
const unsigned char *certificateDataBytes = {/*data*/}; 
```

使用 OpenSSL 和 C，如何将其转换为 RSA 对象？我已经尝试了几种方法，但我无法让它工作`RSA_public_encrypt`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T04:04:56.753

我认为您的意思是公钥进入 RSA * 结构。

因为，你有字节证书，如果它是 DER 编码字节，那么你需要先将它转换成 X509 * 结构。

```
 X509 * cert;
 EVP_PKEY * pubkey;
 //length is the length of the certificateDataBytes in terms of bytes.
 cert = d2i_x509 (NULL, certificateDataBytes, length);
 pubkey = X509_get_pubkey (cert); 
```

请注意，如果证书有 RSA 公钥，那么您可以获得 RSA 公钥，如下所示：

```
 RSA * rsa
 rsa = EVP_PKEY_get1_RSA(pubkey);

 //Now rsa contains RSA public key. Use it.

 //After use, free the pubkey
 EVP_PKEY_free (pubkey); 
```

我希望这必须解决您的目的。如果证书编码不同，请使用不同的功能。一次，您得到 X509 *，其余步骤相同。

# sql - 一次求和和排序

> ID：15536667
> 
> 赞同：0
> 
> 时间：2013-03-20T23:22:10.380
> 
> 标签：sql, postgresql, aggregate-functions, greatest-n-per-group

我有一张订单表。在那里，我需要找出哪 3 个 partner_id 的 amount_totals 总和最大，并将这 3 个从最大到最小排序。

```
 testdb=# SELECT amount_total, partner_id FROM sale_order;
     amount_total | partner_id 
    --------------+------------
          1244.00 |          9
          3065.90 |         12
          3600.00 |          3
          2263.00 |         25
          3000.00 |         10
          3263.00 |          3
           123.00 |         25
          5400.00 |         12
    (8 rows) 
```

刚开始SQL，我觉得很混乱......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:30:59.590

```
select amount_total, partner_id
from (
    select
        sum(amount_total) amount_total,
        partner_id
    from sale_order
    group by partner_id
) s
order by amount_total desc
limit 3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T02:27:35.223

### 合计金额

如果要列出汇总金额，可以很简单：

```
SELECT partner_id, sum(amount_total) AS amout_suptertotal
FROM   sale_order
GROUP  BY 1
ORDER  BY 2 DESC
LIMIT  3; 
```

1 in`GROUP BY 1`是一个数字参数，表示`SELECT`列表中的位置。`GROUP BY partner_id`在这种情况下只是一个符号快捷方式。

这忽略了超过三个合作伙伴有资格并任意选择 3 个的特殊情况（因为缺乏定义）。

### 个别金额

```
SELECT partner_id, amount_total
FROM   sale_order
JOIN  (
   SELECT partner_id, rank() OVER (ORDER BY sum(amount) DESC) As rnk
   FROM   sale_order
   GROUP  BY 1
   ORDER  BY 2
   LIMIT  3
   ) top3 USING (partner_id)
ORDER  BY top3.rnk; 
```

另一方面，如果有超过 3 个合作伙伴有资格进入前 3 名，则这包括所有同行。[窗口函数`rank()`](http://www.postgresql.org/docs/current/interactive/functions-window.html)为您提供。

`partner_id`这里的技术是在子查询中进行分组，`top3`并让窗口函数`rank()`在聚合之后附加排名（窗口函数在聚合函数之后执行）。 `ORDER BY`在窗口函数之后`LIMIT`应用，最后应用。全部在一个子查询中。

然后我将基表加入到这个子查询中，这样结果和 order by 中只剩下排名靠前的狗`rnk`。

窗口函数需要 PostgreSQL 8.4 或更高版本。

这是相当高级的东西。您可能应该从更简单的东西开始学习 SQL。

# java - 将 std::max 转换为 Java

> ID：15536668
> 
> 赞同：0
> 
> 时间：2013-03-20T23:22:24.647
> 
> 标签：java, c++, arrays, pointers

我在 C/C++ 代码中有当前行：

```
double ma = *std::max_element(Dists[a], Dists[a] + size); 
```

`Dists[a]`是一个大小为双整数数组`size`

```
int Dists[size][size]; 
```

我正在寻找可以执行相同操作的 Java 中的等效函数。

由于“Dists[a] + size”行，我不确定这个 C/C++ 函数是如何工作的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:24:22.673

假设您使用的是`Collections`，而不是实际的数组（推荐）：

```
ArrayList<Integer> a; // initialized somewhere
...
Collections.max(a); 
```

如果您使用的是实际的二维数组，请尝试：

```
int[][] c; // initialized somewhere
int i; // set somewhere
List b = Arrays.asList(ArrayUtils.toObject(c[i]));
Collections.max(b); 
```

元素[使用它们的`natural ordering`](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#max%28java.util.Collection%29).

# php - 用于从 MySQL 填充选择菜单的 Javascript 函数

> ID：15536671
> 
> 赞同：0
> 
> 时间：2013-03-20T23:22:35.730
> 
> 标签：php, javascript, mysql

我有这个 PHP 代码，它从 MySQL 数据库中填充一个选择菜单......

```
<select name="input" id="input">
<?php
$sql="SELECT * from table ";
$rs=mysql_query($sql,$conn) or die(mysql_error());
while($result=mysql_fetch_array($rs))
{
    echo '<option value="'.$result["db_field"].'">'.$result["db_field"].'</option>';
}
?>
</select> 
```

这工作得很好，但我需要以某种方式将它放入一个 javascript 函数中。

我有 javascript 代码，当您单击一个按钮时，它会添加更多文本框和另一个选择菜单，但它不会在任何新的（添加的）选择菜单中填充数据库中的数据

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:42:11.743

首先将值的字符串转换为数组，所以你有类似的东西：

```
var values = ['value0','value1','value2']; 
```

然后您可以将它们转换为选项并将它们添加到选择元素中，例如：

```
function addOptions(select, values) {
  for (var i=0, iLen=values.length; i<iLen; i++) {
    select.appendChild(new Option(values[i],values[i]));
  }
} 
```

并称它为：

```
addOptions(document.getElementById('input'), values); 
```

**选择添加到页面**后。****

 **顺便说一句，您不需要同时添加 id 和 name 来形成控件。你必须有他们的名字才能提交，身份证是不必要的。如果您获得对表单的引用，则可以将控件作为表单的命名属性访问，因此您可以使用以下方法引用选择：

```
document.forms[0]['input']; 
```

或者

```
document.forms[0].input; 
```

等等。请注意，“输入”不是控件名称的好选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:32:41.560

您可以使用 json_encode 将选项转换为 JSON（我不是 PHP 程序员，不知道使用它的确切语义）

在 PHP 中执行以下操作：

```
echo '<script>var optionsJSON = '.json_encode(mysql_fetch_array($rs)).'</script>' 
```

在 javascriptn 中执行类似的操作（我正在使用 jquery）：

```
var select = $('select.classOfThisSelect');
var options = JSON.parse(optionsJSON);
for(var i = 0; i < options.length; i++)
  $('option').attr({value: options[i]}).append(options[i]).appendTo(select); 
```

optionsJSON 将是全局可用的 JSON 字符串您可以在 Javascript 函数中自由使用它

注意：您可能需要用引号将 json_encode 括起来**

# php - 在 mySQL 中连接多个表

> ID：15536672
> 
> 赞同：1
> 
> 时间：2013-03-20T23:22:41.040
> 
> 标签：php, mysql

好吧，我不太擅长 mySQL。我在这里要做的是加入 2 个表： `1\. users` `2\. comments` 我正在尝试创建一个评论系统，它应该从表中提取用户名和个人资料图片，并从`users`表中提取评论和 date_posted `comments`。

这是我的查询：

```
$mem_query = mysql_query("SELECT `comments`.`comment_id` AS `comments_id`, `users`.`user_id` AS `users_id`, `users`.`username`,`users`.`profile_pic`,`comments`.`txt_content`,`comments`.`date_posted` FROM `comments` INNER JOIN `users` ON `users`.`user_id` = `comments`.`user_id` WHERE `comments`.`post_id` = '$post_id'"); 
```

我想使用 while 循环运行查询：

```
while($run_mem = mysql_fetch_array($mem_query)){
    $comment_id = $run_mem['comments_id'];
    $txt_content = $run_mem['comments.txt_content'];
    $profile_pic = $run_mem['users.profile_pic'];

?>
    //Run all the comments depending upon the post_id.
<?php
        }
?> 
```

截至目前，它给了我这个错误： - 这在我的第二次更新后没有显示。

```
Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in C:\xampp\htdocs\simpleblog\view.php on line 73 
```

我如何解决它？谢谢。

PS：我知道 'mysql_query' 在 PHP 中已被弃用。我稍后会改变它。PS 2：我将查询从 固定`table.column`为`table`。`column`，但是，它没有显示任何错误，但没有从数据库中提取任何信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:30:43.900

查看 ` 符号，它们应该如下所示：

```
`table`.`column` 
```

并不是：

```
`table.column` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T23:30:20.797

您的查询中有一个很大的语法错误：

```
SELECT `comments.comment_id` AS `comments_id`, `users.user_id` AS `users_id`, `users.username`,`users.profile_pic`,`comments.txt_content`,`comments.date_posted` FROM `comments` INNER JOIN `users` ON `users.user_id` = `comments.user_id` WHERE `comments.post_id` = '$post_id' 
```

应该

```
SELECT `comments`.`comment_id` AS `comments_id`, `users`.`user_id` AS `users_id`, `users`.`username`,`users`.`profile_pic`,`comments`.`txt_content`,`comments`.`date_posted` FROM `comments` INNER JOIN `users` ON `users`.`user_id` = `comments`.`user_id` WHERE `comments`.`post_id` = '$post_id' 
```

你写了这个：`comments.user_id` 但它必须是这个：`comments`.`user_id` 并且几乎在你做错的每个位置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T23:27:56.337

[http://www.php.net/manual/en/function.mysql-query.php](http://www.php.net/manual/en/function.mysql-query.php)

> 对于 SELECT、SHOW、DESCRIBE、EXPLAIN 和其他返回结果集的语句，mysql_query() 成功时返回资源，错误时返回 FALSE。

似乎发生了后者。发生错误，mysql_query 调用返回 false。

# php - 带有 Kendoui 网格的 CodeIgniter

> ID：15536675
> 
> 赞同：1
> 
> 时间：2013-03-20T23:22:57.887
> 
> 标签：php, codeigniter, kendo-ui, kendo-grid

在发布之前，我在网上搜索了相关问题，但找不到任何与我的问题相关的帮助。

我正在 CodeIgniter 下开发 Web 应用程序。我在其中使用 KendoUI。KendoUi 已安装。

问题是我想使用 KendoUi 网格，但该网格遵循 json 格式和 xml 之类的其他格式。

但问题是，我在 kendoUi 网站上看到的文档，根据他们的说法，我需要另一个数据源文件。其中应包括数据库的回显查询，该查询将用作网格的数据源。

但我想知道如果 kendoui 网格直接从数据库加载数据而不是在 ohter php 文件上回显数据然后将其放在网格上，是否可以在 codeigniter 中。

如果且仅当不可能的情况下，我应该遵循什么方法来实现网格的 codeigniter mvc 模式？我应该用我目录中的数据名称创建另一个目录吗？或者我该怎么办..

真的需要你所有的指导。

KendoUi 和 codeigniter 的新手。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-25T11:31:02.117

Kendo UI 在客户端运行。您的数据是服务器端的。将数据放入网格的唯一方法是通过服务器端函数传递它。

在您的情况下，使用 CodeIgniter，这非常简单。您的控制器需要提供包含 Grid 和所需 JavaScript 的页面。`read`数据源的部分应`transport`指向提供数据的 URL。

在您的情况下，该 URL 将指向 CodeIgniter 方法。假设您希望您的网格显示员工信息，`read`URL 将指向`employees\gridread`（或其他）。

该`employees\gridread`方法将调用 来`employees_model`对员工记录进行分类。然后它以 JSON 格式返回员工数据。控制器可能看起来像：

```
 public function gridread()
    {
        $limit = $this->input->post('take',TRUE);
        $offset = $this->input->post('skip',TRUE);
        $sort = $this->input->post('sort',TRUE);
        $filter = $this->input->post('filter',TRUE);

        $data = $this->employees_model->GridRead($limit, $offset,$sort,$filter);

        if ($data):
            header("Content-type: application/json");
            echo json_encode($data);
        else:
            // send server error
            header("HTTP/1.1 500 Internal Server Error");
            echo "Failed to read data!";
        endif;
    } 
```

您将需要模型中的一个函数来处理`$limit, $offset, $sort, $filter`返回请求数据的值。

编辑：实际上有一种更简单的方法可以连接 CodeIgniter（或任何 PHP 框架）以使用 Kendo Grids，那就是使用 Kendo's `DataSourceResult.php`，您可以通过查看 Grid 演示并将源代码切换到 PHP 来找到它。

它处理 Ajax 请求，包括任何过滤、排序和分页，并以 Grid 所需的格式返回数据。

我稍微编辑了它，以便可以使用 CI 的`$this->load->library`方法加载它，并从配置文件中获取数据库设置。

# android - 避免屏幕旋转后重新创建片段的真正方法（以官方片段开发者指南为例）

> ID：15536679
> 
> 赞同：0
> 
> 时间：2013-03-20T23:23:33.390
> 
> 标签：android, android-fragments, android-fragmentactivity

# 我正在寻找一种真正的方法来避免在屏幕旋转后重新创建片段

`if (container == null) { return null; }`并**没有**真正避免重新创建 Fragment。（如下图所示）

* * *

### 官方 Fragment 开发者指南在哪里？

我们所关注的官方指南位于[http://developer.android.com/guide/components/fragments.html](http://developer.android.com/guide/components/fragments.html)。[部分示例代码](http://developer.android.com/guide/components/fragments.html#Example)位于指南的底部。据我所知，完整的示例代码可在 Android 3.0 (API 11) 下的“Samples for SDK”中找到。此外，我对示例代码进行了最小的修改，使其在 API 10 中运行，并添加了一些调试消息，这些消息包含在这个问题的底部。

### 在哪里`R.id.a_item`？

您可以在[开发人员指南示例](http://developer.android.com/guide/components/fragments.html#Example)中找到以下代码存根：

```
if (index == 0) {
    ft.replace(R.id.details, details);
} else {
    ft.replace(R.id.a_item, details);
} 
```

我在互联网上进行了一些搜索，发现[其他](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/HudGNXwUKxk)一些也与`R.id.a_item`. 在检查 API 11 中的示例后，我很确定这**只是一个毫无意义的错字**。样本中根本没有这样的行。

* * *

# 避免屏幕旋转后重新创建片段的真正方法？

*网络上有许多现有的讨论。但似乎还没有一个“真正的”解决方案。*

我在下面的代码中添加了许多调试消息，以跟踪`DetailsFragment`类的生命周期。尝试（1）以纵向模式启动程序，然后（2）将设备转为横向模式，然后（3）将其转回纵向，（4）再次横向，（5）再次返回纵向，最后(6) 放弃它。我们将收到以下调试消息：

(1) 以**纵向**模式启动

> TitlesFragment.onCreate() Bundle=null

只有`TitlesFragment`被创建。`DetailsFragment`尚未显示。

(2) 转成**横向**模式

> TitlesFragment.onCreate() Bundle=Bundle[{shownChoice=-1, android:view_state=android.util.SparseArray@4051d3a8, curChoice=0}]
> DetailsFragment.onAttach() Activity=com.example.android.apis.app.FragmentLayout @4051d640
> DetailsFragment.onCreate() Bundle=null
> DetailsFragment.onCreateView() Activity=android.widget.FrameLayout@4050df68
> DetailsFragment.onActivityCreated() Bundle=null
> DetailsFragment.onStart()
> DetailsFragment.onResume()

首先，`TitlesFragment`是重新创建的（使用 savedInstanceState Bundle）。然后`DetailsFragment`是动态创建的（通过`TitlesFragment.onActivityCreated()`、调用`showDetails()`、使用`FragmentTransaction`）。

(3) 回到**纵向**模式

> DetailsFragment.onPause()
> DetailsFragment.onStop()
> DetailsFragment.onDestroyView()
> DetailsFragment.onDestroy()
> DetailsFragment.onDetach()
> DetailsFragment.onAttach() Activity=com.example.android.apis.app.FragmentLayout@40527f70
> DetailsFragment.onCreate() Bundle=null
> TitlesFragment.onCreate() Bundle=Bundle[{shownChoice=0, android:view_state=android.util.SparseArray@405144b0, curChoice=0}]
> DetailsFragment.onCreateView() Activity=null
> DetailsFragment.onActivityCreated() Bundle=null
> DetailsFragment.onStart()
> DetailsFragment.onResume()

这是我们关注的第一个地方，即***真正***的避免再创造的方法。

这是因为`DetailsFragment`之前已附加到`layout-land/fragment_layout.xml` `<FrameLayout>` `ViewGroup`横向模式。它有一个 ID ( `R.id.details`)。当屏幕旋转时，`ViewGroup`作为 的实例的`DetailsFragment`被保存到 Activity FragmentLayout 的 Bundle 中，在 FragmentLayout 的 onSaveInstanceState() 中。进入纵向模式后，将`DetailsFragment`重新创建。但在纵向模式下不需要**。**

在示例中（以及许多其他人建议的），`DetailsFragment`该类使用`if (container == null) { return null; }`in`onCreateView()`来避免`DetailsFragment`以纵向模式显示。但是，如上面的调试消息所示，`DetailsFragment`在后台仍然存在，作为一个孤儿，拥有所有生命周期方法调用。

(4)再次**进入横向**模式

> DetailsFragment.onPause()
> DetailsFragment.onStop()
> DetailsFragment.onDestroyView()
> DetailsFragment.onDestroy()
> DetailsFragment.onDetach()
> DetailsFragment.onAttach() Activity=com.example.android.apis.app.FragmentLayout@4052c7d8
> DetailsFragment.onCreate() Bundle=null
> TitlesFragment.onCreate() Bundle=Bundle[{shownChoice=0, android:view_state=android.util.SparseArray@40521b80, curChoice=0}]
> DetailsFragment.onCreateView() Activity=android.widget.FrameLayout@40525270
> DetailsFragment。 onActivityCreated() Bundle=null
> DetailsFragment.onStart()
> DetailsFragment.onResume()

请注意，在前 5 行中，`DetailsFragment`完成了其生命周期状态，然后销毁并分离。

这进一步证明了该`if (container == null) { return null; }`方法**并不是*****真正***摆脱`DetailsFragment`实例的方法。（我认为垃圾收集器会摧毁这个悬空的孩子，但事实并非如此。这是因为 Android 确实允许悬空的片段。参考：[添加没有 UI 的片段](http://developer.android.com/guide/components/fragments.html#Adding)。）

据我了解，从第 6 行开始，它应该是`DetailsFragment`由 创建的新实例`TitlesFragment`，就像在 (2) 中所做的那样。但我无法解释为什么`DetailsFragment`'s`onAttach()`和`onCreate()`方法在`TitlesFragment`'s之前被调用`onCreate()`。

但是's`null`中的 Bundle会证明它是一个新实例。`DetailsFragment``onCreate()`

据我了解，之前的悬空`DetailsFragment`实例这次不会重新创建，因为它没有 ID。所以它没有将视图层次结构自动保存到 savedInstanceState 包中。

(5) 再次回到**人像**模式

> DetailsFragment.onPause()
> DetailsFragment.onStop()
> DetailsFragment.onDestroyView()
> DetailsFragment.onDestroy()
> DetailsFragment.onDetach()
> DetailsFragment.onAttach() Activity=com.example.android.apis.app.FragmentLayout@4052d7d8
> DetailsFragment.onCreate() Bundle=null
> TitlesFragment.onCreate() Bundle=Bundle[{shownChoice=0, android:view_state=android.util.SparseArray@40534e30, curChoice=0}]
> DetailsFragment.onCreateView() Activity=null
> DetailsFragment.onActivityCreated() Bundle=null
> DetailsFragment.onStart()
> DetailsFragment.onResume()

请注意，所有生命周期回调都**与****(3)**中的第一次返回纵向相同，除了不同的`Activity ID (40527f70 vs 4052d7d8)`and `view_state Bundle (405144b0 vs 40534e30)`。这是合理的。FragmentLayout Activity 和 Instance State Bundle 都被重新创建。

(6)**退出**（按 BACK 按钮）

> I/System.out(29845)：DetailsFragment.onPause() I/System.out(29845)：DetailsFragment.onStop() I/System.out(29845)：DetailsFragment.onDestroyView() I/System.out(29845) : DetailsFragment.onDestroy() I/System.out(29845): DetailsFragment.onDetach()

如果我们能把 in 去掉就`DetailsFragment`完美了`FragmentLayout`。`onDestroy()`但是`FragmentTransaction`'`remove()`方法需要在`onSaveInstanceState()`. 但是，无法确定它是否是屏幕旋转`onSaveInstanceState()`。

无论如何也无法删除`DetailsFragment`in `FragmentLayout`。`onSaveInstanceState()`首先，如果`DetailsFragment`只是部分被对话框遮挡，它将在背景中消失。此外，在被对话框遮挡或切换活动的情况下，既`onCreate(Bundle)`不会也`onRestoreInstanceState(Bundle)`不会再次调用。因此，我们没有地方可以恢复 Fragment（并从 Bundle 中检索数据）。

* * *

# 源代码和文件

**片段布局.java**

```
package com.example.android.apis.app;

import android.app.Activity;
import android.content.Intent;
import android.content.res.Configuration;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentTransaction;
import android.support.v4.app.ListFragment;
import android.util.TypedValue;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.ScrollView;
import android.widget.TextView;

public class FragmentLayout extends FragmentActivity {

    private final static class Shakespeare {
        public static final String[] TITLES = { "Love", "Hate", "One", "Day" };
        public static final String[] DIALOGUE = {
            "Love Love Love Love Love",
            "Hate Hate Hate Hate Hate",
            "One One One One One",
            "Day Day Day Day Day" };
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.fragment_layout);
    }

    public static class DetailsActivity extends FragmentActivity {
        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            if (getResources().getConfiguration().orientation
                    == Configuration.ORIENTATION_LANDSCAPE) {
                // If the screen is now in landscape mode, we can show the
                // dialog in-line with the list so we don't need this activity.
                finish();
                return;
            }

            if (savedInstanceState == null) {
                // During initial setup, plug in the details fragment.
                DetailsFragment details = new DetailsFragment();
                details.setArguments(getIntent().getExtras());
                getSupportFragmentManager().beginTransaction().add(android.R.id.content, details).commit();
            }
        }
    }

    public static class TitlesFragment extends ListFragment {
        boolean mDualPane;
        int mCurCheckPosition = 0;
        int mShownCheckPosition = -1;

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            System.out.println(getClass().getSimpleName() + ".onCreate() Bundle=" + 
                    (savedInstanceState == null ? null : savedInstanceState));
        }

        @Override
        public void onActivityCreated(Bundle savedInstanceState) {
            super.onActivityCreated(savedInstanceState);

            // Populate list with our static array of titles.
            setListAdapter(new ArrayAdapter<String>(getActivity(),
                    android.R.layout.simple_list_item_1, Shakespeare.TITLES));
            // API 11:android.R.layout.simple_list_item_activated_1

            // Check to see if we have a frame in which to embed the details
            // fragment directly in the containing UI.
            View detailsFrame = getActivity().findViewById(R.id.details);
            mDualPane = detailsFrame != null && detailsFrame.getVisibility() == View.VISIBLE;

            if (savedInstanceState != null) {
                // Restore last state for checked position.
                mCurCheckPosition = savedInstanceState.getInt("curChoice", 0);
                mShownCheckPosition = savedInstanceState.getInt("shownChoice", -1);
            }

            if (mDualPane) {
                // In dual-pane mode, the list view highlights the selected item.
                getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE);
                // Make sure our UI is in the correct state.
                showDetails(mCurCheckPosition);
            }
        }

        @Override
        public void onSaveInstanceState(Bundle outState) {
            super.onSaveInstanceState(outState);
            outState.putInt("curChoice", mCurCheckPosition);
            outState.putInt("shownChoice", mShownCheckPosition);
        }

        @Override
        public void onListItemClick(ListView l, View v, int position, long id) {
            showDetails(position);
        }

        /**
         * Helper function to show the details of a selected item, either by
         * displaying a fragment in-place in the current UI, or starting a
         * whole new activity in which it is displayed.
         */
        void showDetails(int index) {
            mCurCheckPosition = index;

            if (mDualPane) {
                // We can display everything in-place with fragments, so update
                // the list to highlight the selected item and show the data.
                getListView().setItemChecked(index, true);

                if (mShownCheckPosition != mCurCheckPosition) {
                    // If we are not currently showing a fragment for the new
                    // position, we need to create and install a new one.
                    DetailsFragment df = DetailsFragment.newInstance(index);

                    // Execute a transaction, replacing any existing fragment
                    // with this one inside the frame.
                    FragmentTransaction ft = getFragmentManager().beginTransaction();
                    ft.replace(R.id.details, df);
                    ft.setTransition(FragmentTransaction.TRANSIT_FRAGMENT_FADE);
                    ft.commit();
                    mShownCheckPosition = index;
                }

            } else {
                // Otherwise we need to launch a new activity to display
                // the dialog fragment with selected text.
                Intent intent = new Intent();
                intent.setClass(getActivity(), DetailsActivity.class);
                intent.putExtra("index", index);
                startActivity(intent);
            }
        }
    }

    public static class DetailsFragment extends Fragment {
        /**
         * Create a new instance of DetailsFragment, initialized to
         * show the text at 'index'.
         */
        public static DetailsFragment newInstance(int index) {
            DetailsFragment f = new DetailsFragment();

            // Supply index input as an argument.
            Bundle args = new Bundle();
            args.putInt("index", index);
            f.setArguments(args);

            return f;
        }

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            System.out.println(getClass().getSimpleName() + ".onCreate() Bundle=" + 
                    (savedInstanceState == null ? null : savedInstanceState));
        }
        @Override
        public void onAttach(Activity activity) {
            super.onAttach(activity);
            System.out.println(getClass().getSimpleName() + ".onAttach() Activity=" + 
                    (activity == null ? null : activity));
        }
        @Override
        public void onActivityCreated(Bundle savedInstanceState) {
            super.onActivityCreated(savedInstanceState);
            System.out.println(getClass().getSimpleName() + ".onActivityCreated() Bundle=" + 
                    (savedInstanceState == null ? null : savedInstanceState));
        }
        @Override
        public void onStart() { super.onStart(); System.out.println(getClass().getSimpleName() + ".onStart()"); }
        @Override
        public void onResume() { super.onResume(); System.out.println(getClass().getSimpleName() + ".onResume()"); }
        @Override
        public void onPause() { super.onPause(); System.out.println(getClass().getSimpleName() + ".onPause()"); }
        @Override
        public void onStop() { super.onStop(); System.out.println(getClass().getSimpleName() + ".onStop()"); }
        @Override
        public void onDestroyView() { super.onDestroyView(); System.out.println(getClass().getSimpleName() + ".onDestroyView()"); }
        @Override
        public void onDestroy() { super.onDestroy(); System.out.println(getClass().getSimpleName() + ".onDestroy()"); }
        @Override
        public void onDetach() { super.onDetach(); System.out.println(getClass().getSimpleName() + ".onDetach()"); }

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) {
            System.out.println(getClass().getSimpleName() + ".onCreateView() Activity=" + 
                    (container == null ? null : container));

            if (container == null) {
                // We have different layouts, and in one of them this
                // fragment's containing frame doesn't exist.  The fragment
                // may still be created from its saved state, but there is
                // no reason to try to create its view hierarchy because it
                // won't be displayed.  Note this is not needed -- we could
                // just run the code below, where we would create and return
                // the view hierarchy; it would just never be used.
                return null;
            }

            ScrollView scroller = new ScrollView(getActivity());
            TextView text = new TextView(getActivity());
            int padding = (int)TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP,
                    4, getActivity().getResources().getDisplayMetrics());
            text.setPadding(padding, padding, padding, padding);
            scroller.addView(text);
            text.setText(Shakespeare.DIALOGUE[getArguments().getInt("index", 0)]);
            return scroller;
        }
    }

} 
```

**布局/fragment_layout.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent" android:layout_height="match_parent">
    <fragment class="com.example.android.apis.app.FragmentLayout$TitlesFragment"
            android:id="@+id/titles"
            android:layout_width="match_parent" android:layout_height="match_parent" />
</FrameLayout> 
```

**布局土地/fragment_layout.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal" android:baselineAligned="false"
    android:layout_width="match_parent" android:layout_height="match_parent">

    <fragment class="com.example.android.apis.app.FragmentLayout$TitlesFragment"
            android:id="@+id/titles" android:layout_weight="1"
            android:layout_width="0px" android:layout_height="match_parent" />

    <FrameLayout android:id="@+id/details" android:layout_weight="1"
            android:layout_width="0px" android:layout_height="match_parent" />
    <!-- API 11:android:background="?android:attr/detailsElementBackground" -->

</LinearLayout> 
```

**AndroidManifest.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.android.apis.app"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="4"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.android.apis.app.FragmentLayout"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.example.android.apis.app.FragmentLayout$DetailsActivity"
            android:label="@string/app_name" >
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-06T05:00:56.860

我用以下方法取得了一些成功。

这会根据片段的状态做正确的事情。

```
public void activate(FragmentTransaction ft, Fragment f, String tag, int resId) {
    boolean changed =   resId != f.getId();

    if (changed && (f.isAdded() || f.isDetached())) {
        ft.remove(f);
        ft.add(resId, f, tag);
        return;
    }

    // Currently in a detached mode
    if (f.isDetached()) {
        ft.attach(f);
        return;
    }

    // Not in fragment manager add
    if (!f.isAdded() && ! f.isDetached()) {
        ft.add(resId, f, tag);
        return;
    }
} 
```

这处理特定的记忆片段。

```
private enum FragmentOp {
    ADD
    ,DETACH
    ,REMOVE
    ;
}

private void ensureFragmentState(FragmentOp op) {
    if (null == iChild) {
        iChild = (FragmentChild) iFM.findFragmentById(R.id.fragment_phonenumber_details);
    }

    FragmentTransaction ft = iFM.beginTransaction();
    switch(op) {
    case ADD:
        if (null == iChild) {
            iChild = new FragmentChild();
        }
        activate(ft, iChild, null, R.id.fragment_phonenumber_details);
        break;
    case DETACH:
        if (null != iChild) {
            iChild.deactivate(ft);
        }
        break;
    case REMOVE:
        if (null != iChild) {
            iChild.remove(ft);
        }
        break;
    }
    // Only if something shows up did we do anything!
    if (null != iChild) {
        ft.commit();
    }
} 
```

然后在生命周期方法中：

```
@Override public void onResume() {
    super.onResume();
    if (iDualPane) {
        ensureFragmentState(FragmentOp.ADD);
    }
}

@Override public void onPause() {
    super.onPause();

    recordState();   // Grab what I need from the child fragment

    ensureFragmentState(FragmentOp.DETACH);
} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-01T18:42:46.137

非常感谢@RogerGarzonNieto 发现了在方向更改时禁用自动重新创建活动的方法。这是非常有用的。我相信我将不得不在某些情况下使用它。

为了避免在屏幕旋转时重新创建片段，我找到了一种更简单的方法，我们仍然*可以*像往常一样允许 Activity 重新创建。

在`onSaveInstanceState()`：

```
@Override
protected void onSaveInstanceState(Bundle outState) {
    if (isPortrait2Landscape()) {
        remove_fragments();
    }
    super.onSaveInstanceState(outState);
}

private boolean isPortrait2Landscape() {
    return isDevicePortrait() && (getResources().getConfiguration().orientation == Configuration.ORIENTATION_LANDSCAPE);
} 
```

会`isDevicePortrait()`像：

```
private boolean isDevicePortrait() {
    return (findViewById(R.id.A_View_Only_In_Portrait) != null);
} 
```

*请注意，我们***无法***`getResources().getConfiguration().orientation`确定设备当前*是否为*纵向。这是因为`Resources`对象在屏幕旋转***后立即***更改 - 甚至在调用***之前！*** `onSaveInstanceState()`

如果您不想使用`findViewById()`来测试方向（出于任何原因，而且它毕竟不是那么整洁），请保留一个全局变量并通过in`private int current_orientation;`初始化它。这看起来更整洁。但是我们应该注意***不要***在 Activity 生命周期的任何地方更改它。`current_orientation = getResources().getConfiguration().orientation;``onCreate()`

 **请确保我们`remove_fragments()` ***之前*** `super.onSaveInstanceState()`。

*（因为在我的情况下，我从 Layout 和 Activity 中删除了 Fragments。如果它是 after `super.onSaveInstanceState()`，则 Layout 将已经保存到 Bundle 中。然后在 Activity 重新创建后， Fragments**也**将被重新创建。 ###)*

###我已经证明了这个现象。但是[***在 Activity 重新创建时如何确定 Fragment 恢复的原因是什么？***](https://stackoverflow.com/questions/15555964/what-to-determine-a-fragment-restore-upon-activity-re-create)只是我的猜测。如果您对此有任何想法，请回答[我的另一个问题](https://stackoverflow.com/questions/15555964/what-to-determine-a-fragment-restore-upon-activity-re-create)。谢谢！*

# c++ - 在 C++ 中将一个巨大的文本文件 (2Gb+) 拆分为 2 个块

> ID：15536680
> 
> 赞同：0
> 
> 时间：2013-03-20T23:23:33.943
> 
> 标签：c++, file-io

我有一个包含两列（浮点数）的巨大文本文件。我想将它们分成两个文件，每个文件包含大致相同的行数。做这个的最好方式是什么？我正在使用 VS 2012。文件大小约为 2Gb。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:47:11.003

代码确实需要由您“启动”。无论如何，这是我的想法的集合-我也从其他评论者那里借来了。

我的方法，伪代码：

```
open I for reading
open O1 for writing
open O2 for writing
while I has input:
   write next line from I into O1
   if I has input:
       write next line from I into O2 
```

请注意，与 Perl 方法不同的是，它不需要先一次性读取文件来读取行数。这将读取 IO 减少了大约一半。但是，与 perl 方法一样，它仍然可以逐行运行，并且需要行扫描/处理。由于该算法是流式传输的（该行仅保留足够长的时间以便写入），因此它应该适用于所有文件大小。缓冲输出流对性能非常重要。

Markus Mikkolainen 建议的方法类似于：

```
open I for reading
seek to midpoint of I using filesize/2
scan backward to line start
open O1 for writing
write bytes 0..(mid line start + length) from I to O1
open O2 for writing
write bytes (mid line start + length)..filesize from I to O2 
```

如果可以修改输入文件，则只需要完成对 O2 的写入，然后对 I 进行适当的*截断*。这可能导致我的方法中大约一半的 IO 写入，并且由于它处理纯字节副本，因此避免了中点线起点定位后逐行处理。

只要行具有均匀的长度分布，这种方法将导致两个输出文件中出现的行数大致相同；另一方面，即使行长度以倾斜的方式相差很大，两个输出文件的大小也将大致相同。

现在开始编码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:34:52.653

有一个免费的工具，称为[HJSplit](http://www.hjsplit.org/)的 Windows 文件拆分器 ，它可以拆分任何类型和大小的文件。或者[这个](http://www.gdgsoft.com/gsplit/)。您也可以在 Windows 上的 cygwin 中使用 grep 或在 powershell 中使用

[这里是用 C++ 完成的：相关问题：]（[Split a Large File In C++](https://stackoverflow.com/questions/2541433/split-a-large-file-in-c)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T23:42:00.313

在 Unix 中使用“split”命令。Cygwin 如果你在 Windows 上。

# javascript - 单击其他位置时隐藏 div 菜单

> ID：15536683
> 
> 赞同：0
> 
> 时间：2013-03-20T23:24:00.547
> 
> 标签：javascript, jquery

我的目标是让我的 div 菜单在我单击页面上的其他任何位置时消失。下面是在单击两个 div 本身时打开和关闭我的代码的代码。

```
var content_nav = '';
var content_select = '';
window.onload=function(){
    content_nav = document.getElementById("content_nav");
    content_select = document.getElementById("content_select");
    content_nav.addEventListener("click", show_or_hide);
}

function show_or_hide()
{
   if(content_select.style.display!="block") content_select.style.display="block";
   else content_select.style.display="none";

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:29:06.757

你应该听整个页面上的点击事件，如果点击在 content_nav 之外，则隐藏菜单，试试这个（你可能需要调整它以使其工作，我不知道你的 HTML）：

```
$(document).click(function(e){
        if (! $(e.target).closest('#content_nav').length ) 
            $('#content_nav').hide();
    }); 
```

# php - Doctrine PreUpdate 从未奏效

> ID：15536686
> 
> 赞同：1
> 
> 时间：2013-03-20T23:24:14.480
> 
> 标签：php, events, symfony, doctrine-orm, lifecycle

我已经搜索过，有很多相同的问题，但没有一个能解决我的问题。

我有一个实体，这是它的代码：

```
/*
 * @ORM\HasLifecycleCallbacks
 */
class MyEntity
{
    // some preoperties here...

    /**
     * @ORM\Column(type="text", nullable=true)
     * @Assert\MaxLength(limit="500")
     */
    private $delivery = null;

    /**
     * @var $deliveryOn bool
     *
     * Virtual field used for $delivery property organization
     */
    private $deliveryOn = false;

    /**
     * @ORM\PrePersist()
     * @ORM\PreUpdate()
     */
    public function preSetDelivery()
    {
        if ($this->deliveryOn == false)
            $this->delivery = null;
    }

    /**
     * @ORM\PostLoad()
     */
    public function loadDeliveryOn()
    {
        if ($this->delivery != null)
            $this->deliveryOn = true;
    }
} 
```

`loadDeliveryOn`方法一直都很有效。但**只有**当我第一次将实体持久保存到数据库时才会`preSetDelivery`触发。我也希望在更新对象时调用它，但它不起作用。我不知道为什么。

 **我的编辑控制器：

```
public function editAction($id)
{
    // some code here...
    // ...

        $request = $this->getRequest();
        if ($request->isMethod('POST'))
        {
            $form->bind($request);

            if ($form->isValid())
            {
                $em->flush();
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T12:38:42.407

如果您使用继承 - 例如 @ORM\InheritanceType("SINGLE_TABLE") 您需要在父类中添加 @ORM\MappedSuperclass

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:03:43.993

来自官方[文档](http://docs.doctrine-project.org/en/2.0.x/reference/events.html#preupdate)：`preUpdate`

> 刷新操作不再识别对传递实体的字段的更改，使用传递给事件的计算更改集来修改原始字段值。

如果您有权访问，`UnitOfWork`也许有一种方法可以像[onFlush](http://docs.doctrine-project.org/en/2.0.x/reference/events.html#onflush)那样重新计算变更集？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-24T00:37:11.247

PreUpdate 仅在实体发生实际更改时触发。如果您不更改表单中的任何内容，实体将不会发生任何更改，并且不会调用 preUpdate 侦听器。**

# loops - 无限循环重复

> ID：15536687
> 
> 赞同：2
> 
> 时间：2013-03-20T23:24:20.593
> 
> 标签：loops, clojure, tail-recursion

我正在学习 Clojure，我刚刚开始使用[Project Euler](https://projecteuler.net)，但遇到了一个我无法弄清楚的问题。这是我的代码：

```
(defn largest_prime_factor
  [x]
  (if (prime? x) x)
  (loop [running x divider 2]
    (if (= 0 (mod running divider))
      (let [d (/ running divider)]
        (if (prime? d)
          d
          (recur d 2)))
      (recur x (inc divider)))))

(largest_prime_factor 12)  ;works
(largest_prime_factor 49)  ;works
(largest_prime_factor 147) ;Endless loop! 
```

我意识到这可能不是找到最大素数的最有效方法，但我想弄清楚它为什么会陷入循环。显然我以错误的方式使用循环递归但我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:40:16.610

```
(if (prime? x) x) 
```

我想你的意思是

```
(if (prime? x) x
  (loop [... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T01:08:24.127

几件事

```
(defn largest_prime_factor
  [x]
  (if (prime? x) x)                 ; #1
  (loop [running x divider 2]
    (if (= 0 (mod running divider))
      (let [d (/ running divider)]
        (if (prime? d)
          d
          (recur d 2)))
      (recur x (inc divider)))))    ; #2 
```

1.  额外的右括号使它成为一个独立的`if`无`else`子句。这与无限循环无关，但会为素数输入给出错误的答案 (1)（除非您改为从 1 开始除法器，在这种情况下您可以省略此初始测试）。

2.  这条线应该用`running`而不是重复出现`x`，否则你没有分解除数并且`prime?`测试将永远是错误的。这就是为什么你会陷入无限循环。

# c++ - 使用任何缓冲区来存储任何数据，带有放置 new 和 memcpy

> ID：15536688
> 
> 赞同：2
> 
> 时间：2013-03-20T23:24:21.950
> 
> 标签：c++

有一段时间了，我正在阅读有关对齐、别名、填充和放置新的文档，但我仍然不确定如何解决这个问题——这是我第一次在这个级别上遇到内存问题，所以我我不自信。

问题是：我有一个缓冲区，一个数据数组，它使用某种类型`typeT`，例如

```
typeT buff[N]; 
```

在该缓冲区内，我必须`typeU`在`buff`. 让我们假设有 的`K`元素`typeU`，它小于或等于`M`类型的元素`typeT`。

编辑：这个问题取决于数据类型，但我的问题是通用的，适用于 POD 和非 POD。但是您可以假设非 POD 只是 POD 类型的聚合，没有要复制的动态内存，并且所有数据都包含在`sizeof(typeX)`结构本身的字节中。也就是说，*不用担心深/浅复制*。

我最感兴趣的情况`typeT`是`typeU`不同的对齐方式。哪个对齐大小更大尚不清楚。

**问题 1**：（最重要的问题）考虑到我将*始终*使用 typeU 访问这些数据，就像在下面的代码中一样，使用新位置存储我的数据是否*总是安全的？*`buff`

 *```
typeU *allocData = new (buff) typeU[K];
allocData[0] = foo; 
```

**问题 2** ：从using类型的缓冲区中复制任何数据是否*总是*安全的，因为我将始终使用 访问数据，就像在下面的代码中一样？`typeU*``typeT*``memcpy``typeU*`

```
typeU prevData[K];
memcpy(buff, prevData, sizeof(typeU) * K);
// Is it safe to do the following?
typeU *accessData = reinterpret_cast<typeU *>(buff);
accessData[1] = foo; 
```

**问题 3**：（最不重要的问题）只是转换指针并使用它们写入数据并不总是安全的吗？像

```
typeU *castData = (typeU*)buff;
castData[2] = something; 
```

即使我总是使用内存的第一个区域（前 M 个元素）使用`typeU`和第二个区域（从 M 到 N 的元素）使用`typeT`？

我希望我的意思很清楚......我搜索了很多，但我仍然很困惑。

另外，请考虑我说的是 C++98 或 03，而不是 11，它具有 STL 的最小子集，没有提升，并不总是在 x86 上 - 但我可以使用 memcpy 和 Placement new，正如我所说。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:50:46.210

如果 和 的大小和对齐要求`typeT`相同`typeU`，您可以使用分配给的未初始化存储`typeT`来保存`typeU`.

如果`typeT`和/或`typeU`有构造函数或析构函数，您必须确保它们被适当地调用，并且以正确的顺序调用。

```
static_assert(sizeof(typeT) == sizeof(typeU))
static_assert(alignof(typeT) == alignof(typeU))

typeT t[10];

&t[0]->~typeT(); // placement delete t[0] to uninitialize
typeU* p = &t[0];
new (p) typeU(); // construct typeU at t[0]

typeU u& = *p;

u.doStuff();

p->~typeU(); // placement delete typeU at t[0]

new (&t[0]) typeT(); // reconstruct typeT at t[0] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T10:49:50.843

我刚刚发现[了 Sutter 的这篇文章，](http://www.gotw.ca/publications/mill05.htm)其中介绍了一些我不知道的东西

> 通过 new 或 malloc 动态分配的任何内存都可以保证为任何类型的对象正确对齐，但未动态分配的缓冲区没有这样的保证

这意味着，首先，像我一样做是错误的：

```
typeT buff[N];
new (buff) typeU[K]; 
```

因为buff不是动态分配的，所以不能保证。

所以，关键是：要进行这种处理，必须动态分配内存。如果不是，答案取决于对齐方式。*

# iphone - 当您在 iTunes Connect 上创建新版本应用程序时，它是否已经与二进制文件相关联？

> ID：15536695
> 
> 赞同：-1
> 
> 时间：2013-03-20T23:24:46.533
> 
> 标签：iphone, app-store-connect

我花了一天时间在 iTunes Connect 上更新应用程序的元数据 - 新版本 1.2 -（创建于 2 月 4 日），我昨天（3 月 19 日）对我的代码进行了更改，我想发布这些更改，是否可以在 iTunes Connect 上为该新版本 1.2 分配一个新的二进制文件。

当您在 iTunes Connect 上创建新版本应用程序时，它是否已经与二进制文件相关联？或者我可以在这个阶段上传一个新的二进制文件并使用我的元数据。

干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:29:59.170

创建新版本时，它不与二进制文件关联。您将处于“准备上传”状态，这意味着系统正在等待您的二进制文件完成该过程。

如果您已经为某个版本上传了二进制文件，您可以手动拒绝该二进制文件，然后上传新的二进制文件。该新二进制文件将与该版本相关联。如果您在应用程序达到“审查中”状态之前遇到代码中的错误，您会这样做。

# list - Play Framework 2.0，Scala 定义输入类型并打印列表

> ID：15536696
> 
> 赞同：0
> 
> 时间：2013-03-20T23:24:49.440
> 
> 标签：list, scala, playframework-2.0

我正在使用 Play Framework 2.0，我正在尝试打印一个表格，并且根据我的数据类型，我的程序将输入不同的内容。我已经想出了如何使用 isInstanceOf 定义输入的类，但是当我在 List 上执行此操作时，它会返回：

```
non-variable type argument models.Medication in type java.util.List[models.Medication] is unchecked since it is eliminated by erasure 
```

下面是我的代码：

```
@(title: String)(content: Object)
<tr>
<td>@title</td>
@if(content.isInstanceOf[Date]) {    
    <td>@content.asInstanceOf[Date].format("yyyy-MM-dd")</td>    
} else{
    @if(content.isInstanceOf[List[Medication]]){
        <td>
        <table>
        @for(a <- content) {
            @a.name<br>
        }
        </table>
        <td>
    } else {
        <td>@content</td>
    }
} 
```

请帮忙...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T05:06:04.490

我认为警告不会阻止编译，它可能会掩盖真正的编译错误。

尝试*if*`content.isInstanceOf[java.util.List[_]]`测试（这应该会使警告消失）。

 *您还需要转换*content* :`for (a <- content.asInstanceOf[java.util.List[Medication]])`在 for 表达式中。

我不确定 play template 如何确定它是 java 还是`List`Scala `List`，所以完全限定的名称可能会有所帮助。*

# python - 使用 Launchd 运行 Python 脚本：未找到导入

> ID：15536697
> 
> 赞同：4
> 
> 时间：2013-03-20T23:25:03.093
> 
> 标签：python, osx-mountain-lion, launchd

我一直在尝试设置一个脚本来定期使用`launchd`. python 程序失败是因为它找不到我的导入——我知道这一点是因为我在日志文件中发现了错误。为了解决这个问题，我创建`~\.MacOSX\environment.plist`并复制了我的`PYTHONPATH`那里，注销并再次登录。这似乎不足以解决问题，我不知道还能尝试什么。

我正在运行 OSX，10.8.3。

相关话题：

*   [launchd 执行 python 脚本，但导入失败](https://stackoverflow.com/questions/5573538/launchd-executes-python-script-but-import-fails)（不适用——我的脚本指向正确的 python 实例）

更新：

看来我可以运行以下命令：

```
launchctl setenv PYTHONPATH $PYTHONPATH 
```

并且脚本将成功执行。所以，要修改我的问题：

1.  这个存储在哪里？我查了一下`~\.launchd.conf`，`\etc\.launchd.conf`都不存在。
2.  大概是在我重新启动时转储了此设置。我在哪里可以更改此信息以便`launchd`找到它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-22T01:01:55.350

要设置特定作业的环境，您应该使用`EnvironmentVariables`作业定义本身中的键：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>Label</key>
    <string>com.example.app</string>
    <key>Program</key>
    <string>/path/to/your/script</string>
    <key>EnvironmentVariables</key>
    <dict>
        <key>PYTHONPATH</key>
        <string>/your/python/path</string>
    </dict>
</dict>
</plist> 
```

`launchd(8)`您可以通过编辑`/etc/launchd.conf`守护进程或`/etc/launchd-user.conf`代理来定义服务的默认环境变量。后一个有效，但没有记录。当前记录的（但不受支持的）每用户配置文件是`$HOME/.launchd.conf`.

这些配置文件包含一个`launchctl(1)`子命令列表。你想要的是：

```
setenv PYTHONPATH /your/python/path 
```

*更新：* `/etc/launchd.conf` Mac OS X 10.10 及更高版本不支持。在这些系统上，您必须基于每个作业定义环境变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-14T21:34:28.420

以上都没有真正为我工作（OS X 10.11.3）。突破是阅读此[脚本在终端中运行良好，但不是从 launchd 中运行，](https://stackoverflow.com/questions/28532824/script-runs-fine-in-terminal-but-not-from-launchd/28532848#28532848)并且后来意识到可以使用正确的模块编写 python 版本的绝对完整路径。哦。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>Label</key>
    <string>com.example.app</string>
    <key>ProgramArguments</key>
    <string>/path/to/your/python</string>
    <string>/path/to/your/script</string>
</dict>
</plist> 
```

# java - Android - 线程未执行

> ID：15536700
> 
> 赞同：0
> 
> 时间：2013-03-20T23:25:34.263
> 
> 标签：java, android, multithreading

所以，是的，我的线程没有执行，也没有在其中执行代码。我只是想从我的 sdcard 运行一个 shell 脚本，并显示一个“加载”圆圈或“进度”圆圈或任何你想要调用它的东西。当我单击按钮运行线程时，我得到进度/加载栏/圆圈，但它只是坐在那里，什么也不做。我看过一些例子，但仍然无法弄清楚我做错了什么。这是我的代码：

```
package com.cydeon.plasmamodz;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.concurrent.TimeoutException;

import com.stericson.RootTools.*;
import com.stericson.RootTools.exceptions.RootDeniedException;
import com.stericson.RootTools.execution.CommandCapture;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.res.AssetManager;
import android.os.Bundle;
import android.os.Environment;
import android.os.Handler;
import android.os.Message;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

public class Install extends Activity{

private static ProgressDialog progressDialog;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.install);
    Button bInstall = (Button) findViewById(R.id.bInstallTheme);
    bInstall.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {
            showDialog();
        }
    });
}

public void showDialog(){
    progressDialog = ProgressDialog.show(Install.this, "", "Installing Theme", true);
    Thread thread = new Thread();
    thread.start();
}

public void run(){
    try{
        Thread.sleep(1000);
        CommandCapture command = new CommandCapture(0, "su", "sh /sdcard/plasma/scripts/install.sh");
        try {
            RootTools.getShell(true).add(command).waitForFinish();
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (TimeoutException e) {
            e.printStackTrace();
        } catch (RootDeniedException e) {
            e.printStackTrace();
        }
    }catch (InterruptedException e){
        e.printStackTrace();
    }
    handler.sendEmptyMessage(0);
}

private static Handler handler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
        progressDialog.dismiss();
    }
};

} 
```

那么，我做错了吗？为什么它不能运行我的代码？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:27:59.923

线程不知道要运行什么。改变

```
public class Install extends Activity{ 
```

到

```
public class Install extends Activity implements Runnable { 
```

和改变

```
Thread thread = new Thread(); 
```

到

```
Thread thread = new Thread(this); 
```

# javascript - Woocommerce 不会将产品添加到购物车

> ID：15536701
> 
> 赞同：0
> 
> 时间：2013-03-20T23:25:37.740
> 
> 标签：javascript, jquery, wordpress, woocommerce

我不确定我做了什么来打破这个，因为它工作了一段时间，但我不能再将产品添加到我正在处理的网站的 WooCommerce 购物车中。每次尝试时，我都会收到“请选择产品选项”消息作为回报。

我为每个变量选择了一个价格，但它仍然不起作用。我认为这可能与可能无法通过的数量选择器有关。

也可能与一些 jQuery 库发生冲突，我被告知要检查错误，但我已经尝试了无数次来解决这个问题，但我找不到解决方案，这确实需要尽快修复。

任何人都可以提供的任何信息或帮助将不胜感激。

这是一个测试产品的示例页面 [http://www.coreytegeler.com/bolivares/shop/marquez-button-down-cardigan-2/](http://www.coreytegeler.com/bolivares/shop/marquez-button-down-cardigan-2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-03-22T14:29:13.763

我遇到了同样的问题并修复了它。这是我主机上的缓存问题。一旦他们排除了某些要缓存的会话/cookie（在服务器端），所有这些都开始再次工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:33:37.420

在您升级到最新版本的 Woocommerce 之前它工作正常吗？

```
<!-- WooCommerce Version -->
<meta name="generator" content="WooCommerce 2.0.3" /> 
```

Woo 最近对他们的电子商务引擎进行了重大升级，它可能需要调整才能与您当前的主题配合使用。

您可以测试的一件事是暂时切换到已知可与最新的 woocommerce 一起使用的不同主题，例如[http://www.woothemes.com/products/mystile/](http://www.woothemes.com/products/mystile/)这是 Woo 的免费主题人自己。

# excel - 如果选择列表值，Excel VBA允许手动输入

> ID：15536706
> 
> 赞同：0
> 
> 时间：2013-03-20T23:25:57.177
> 
> 标签：excel, vba

我目前有 XLValidationList 类型的验证单元。如果选择了下拉菜单中的特定值，是否可以在 vba 中允许手动输入该单元格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T19:24:16.193

将 False 分配给验证对象的 .ShowAlert 属性似乎可以解决问题

# c++ - (DirectX 11) 动态顶点/索引缓冲区实现，场景内容不断变化

> ID：15536715
> 
> 赞同：2
> 
> 时间：2013-03-20T23:26:41.827
> 
> 标签：c++, directx, directx-11

第一次深入研究非托管 DirectX 11（请多多包涵），有一个问题，尽管在论坛上被问了好几次，但仍然给我留下了疑问。

我正在开发作为应用程序，其中随着时间的推移将对象添加到场景中。在每个渲染循环中，我想收集场景中的所有顶点并重新使用单个顶点和索引缓冲区来渲染它们，以获得性能和最佳实践。我的问题是关于动态顶点和索引缓冲区的使用。当场景内容发生变化时，我无法完全理解它们的正确用法。

```
vertexBufferDescription.Usage               = D3D11_USAGE_DYNAMIC;
vertexBufferDescription.BindFlags           = D3D11_BIND_VERTEX_BUFFER;
vertexBufferDescription.CPUAccessFlags      = D3D11_CPU_ACCESS_WRITE;
vertexBufferDescription.MiscFlags           = 0;
vertexBufferDescription.StructureByteStride = 0; 
```

我应该在场景初始化时创建缓冲区并以某种方式在每一帧中更新它们的内容吗？如果是这样，我应该在缓冲区描述中设置什么 ByteSize？我用什么初始化它？

或者，我应该在第一次渲染场景时（第 1 帧）使用当前顶点数作为其大小来创建它吗？如果是这样，当我向场景中添加另一个对象时，我不需要重新创建缓冲区并将缓冲区描述的 ByteWidth 更改为新的顶点数吗？如果我的场景在每一帧上不断更新它的顶点，那么单个动态缓冲区的使用会以这种方式失去它的目的......

我一直在测试第一次渲染场景时初始化缓冲区，然后在每一帧上使用 Map/Unmap。我首先用所有场景对象填充向量列表，然后像这样更新资源：

```
void Scene::Render() 
{
    (...)

    std::vector<VERTEX> totalVertices;
    std::vector<int> totalIndices;
    int totalVertexCount = 0;
    int totalIndexCount = 0;

    for (shapeIterator = models.begin(); shapeIterator != models.end(); ++shapeIterator)
    {
            Model* currentModel = (*shapeIterator);

            // totalVertices gets filled here...
    }

     // At this point totalVertices and totalIndices have all scene data

    if (isVertexBufferSet)
    {
        // This is where it copies the new vertices to the buffer.
        // but it's causing flickering in the entire screen...
        D3D11_MAPPED_SUBRESOURCE resource;
        context->Map(vertexBuffer, 0, D3D11_MAP_WRITE_DISCARD, 0, &resource);
        memcpy(resource.pData, &totalVertices[0], sizeof(totalVertices));
        context->Unmap(vertexBuffer, 0);
    }
    else
    {
        // This is run in the first frame. But what if new vertices are added to the scene?
        vertexBufferDescription.ByteWidth = sizeof(VERTEX) * totalVertexCount;
        UINT stride = sizeof(VERTEX);
        UINT offset = 0;

        D3D11_SUBRESOURCE_DATA resourceData;
        ZeroMemory(&resourceData, sizeof(resourceData));
        resourceData.pSysMem = &totalVertices[0];

        device->CreateBuffer(&vertexBufferDescription, &resourceData, &vertexBuffer);
        context->IASetVertexBuffers(0, 1, &vertexBuffer, &stride, &offset);
        isVertexBufferSet = true;
    } 
```

在渲染循环结束时，在跟踪每个对象的顶点的缓冲区位置的同时，我最终调用了 Draw()：

```
 context->Draw(objectVertexCount, currentVertexOffset);
} 
```

我当前的实现导致我的整个场景闪烁。但没有内存泄漏。想知道这是否与我使用 Map/Unmap API 的方式有关？

此外，在这种情况下，何时调用 buffer->Release() 是理想的？提示或代码示例会很棒！提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T13:16:31.860

在 memcpy 到顶点缓冲区中，您执行以下操作：

```
memcpy(resource.pData, &totalVertices[0], sizeof(totalVertices)); 
```

`sizeof( totalVertices )`只是询问 std::vector< VERTEX > 的大小，这不是您想要的。

试试下面的代码：

```
memcpy(resource.pData, &totalVertices[0], sizeof( VERTEX ) * totalVertices.size() ); 
```

`IASetVertexBuffers`当 isVertexBufferSet 为真时，您似乎也不会打电话。确保你这样做。

# php - MySQL - 无限制启动

> ID：15536723
> 
> 赞同：2
> 
> 时间：2013-03-20T23:27:35.003
> 
> 标签：php, mysql, database, limit

我有以下 SQL 代码；

```
 SELECT * FROM myTable WHERE id = 1 LIMIT 4, 10; 
```

我希望 sql 从结果 4 开始运行，但没有结束限制，所以我希望脚本从 4 开始获取所有结果。这可能吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:29:47.647

您可以`OFFSET`在查询中使用该选项。像这样

```
SELECT * 
FROM myTable 
WHERE id = 1
OFFSET 4 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:30:43.803

```
SELECT * FROM tbl LIMIT 4, 18446744073709551615; 
```

资源 mysql 文档。

# xml - Dispose 后序列化 Linq2Sql 对象

> ID：15536731
> 
> 赞同：0
> 
> 时间：2013-03-20T23:28:18.020
> 
> 标签：xml, linq, linq-to-sql, serialization, datacontext

我试图找到一种简单的方法来序列化任何对象，以便只包括*直接*属性及其“ToString”值。对于来自 DataContext 的对象，我希望能够忽略属性的属性（即，如果属性是复杂对象，也不要序列化该对象）。如果未加载属性，这一点尤其重要，因为它会导致错误“在释放对象后无法访问对象”...

我创建了以下内容，但是当它尝试访问未在原始 datacontext 调用中加载的属性时失败。

```
string typeString = o.GetType().Name;
        StringBuilder xml = new StringBuilder();
        xml.AppendFormat("<{0}>\r\n", typeString);

        foreach (PropertyInfo property in o.GetType().GetProperties())
        {
            var propertyValue = property.GetValue(o, null);
            if (property.GetType() != typeof(System.Data.Linq.Binary) && property.PropertyType.Name != "EntitySet`1" && property.GetCustomAttributes(typeof(XmlIgnoreAttribute), true).Count() == 0)
            {
                xml.AppendFormat("<{0}>{1}</{0}>\r\n", property.Name, propertyValue);
            }

        }

        xml.AppendFormat("</{0}>", typeString);

        return xml.ToString(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:31:33.053

您可以使用具有适当“忽略”属性的库存序列化程序，例如在您不希望序列化的属性上使用[DataContractSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datacontractserializer.aspx)和[IgnoreDataMemberAttribute 。](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.ignoredatamemberattribute.aspx)

如果您希望坚持您概述的方法，您可以检查 [PropertyInfo.PropertyType](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.propertytype.aspx)以不对任何复杂类型采取行动。

您可以使用[Type.IsPrimitive](http://msdn.microsoft.com/en-us/library/system.type.isprimitive.aspx)来查看给定类型是否为原始类型，但这里有一些陷阱：

[https://stackoverflow.com/a/2442544/141172](https://stackoverflow.com/a/2442544/141172)

# java - 可以使用 ModelAttribute 作为 RequestMapping 方法的方法参数吗？

> ID：15536733
> 
> 赞同：0
> 
> 时间：2013-03-20T23:28:22.030
> 
> 标签：java, jsp, spring-mvc

我一直在使用以下代码：

```
@RequestMapping(value="/myUrl", method=RequestMethod.GET)
public ModelAndView myRequestHandler(
    HttpServletRequest request, HttpServletResponse response,
    @ModelAttribute(value="paramName") @ValidMyModelForm form)
// automatically populates form setters from form:form in JSP view
{
} 
```

阅读以下链接中的答案，我开始怀疑我对 ModelAttribute 的使用在这里不正确。

[Spring MVC 中的@ModelAttribute 是什么？](https://stackoverflow.com/questions/3423262/what-is-modelattribute-in-spring-mvc)

我是否以正确的方式使用它？它似乎有效，但想确保我没有做错任何事。

使用如下代码将表单对象添加到单独的方法中的模型中：

```
 modelAndView.addObject("formName", new MyModelForm()); 
```

在 JSP 视图中，我将表单名称添加为`commandName="formName"`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:58:23.083

这个签名也应该非常适合你：

```
public ModelAndView myRequestHandler(@Valid MyModelForm form) 
```

这里 Spring MVC 将确保`MyModelForm`根据从表单提交的内容创建和绑定实例。

现在，额外`@ModelAttribute`带给你什么：

首先是简单的案例：

```
public ModelAndView myRequestHandler(@ModelAttribute("paramName") @Valid MyModelForm form) 
```

假设您没有任何其他方法 with `@ModelAttribute`，上面将做的是按名称查找模型，`paramName`由于假设不太可能存在，那么将像以前一样创建和绑定 MyModelForm 的实例，使用您现在有一个模型对象，其名称`paramName`可用，您可以在视图中使用： `paramName.myformValue`等等。

所以本质上：

```
public ModelAndView myRequestHandler(@ModelAttribute("paramName") @Valid MyModelForm form) 
```

相当于：

```
public ModelAndView myRequestHandler(@Valid MyModelForm form, Model model) {
    ...
    model.addAttribute("paramName", form)
} 
```

其次，如果你有一个用 @ModelAttribute 注释的方法，它预加载了你的 MyModelForm 的一部分：

```
@ModelAttribute("paramName");
public MyModelForm loadModel(int id) {
   MyModelForm fromDB = loadFromDB(id);
} 
```

现在，您的方法签名的优势：

```
public ModelAndView myRequestHandler(@ModelAttribute("paramName") @Valid MyModelForm form) 
```

将是您从数据库中预先填充的模型，将通过表单中提交的内容进行增强。

# java - Android：套接字通信

> ID：15536737
> 
> 赞同：0
> 
> 时间：2013-03-20T23:28:48.453
> 
> 标签：java, android, sockets

我正在尝试使用 android 客户端和 java 服务器创建简单的应用程序，当我尝试读取服务器回复错误时，android 客户端能够向服务器（java）发送消息：socket 已关闭。行（如果（（receiveMessage = receiveRead.readLine（））！= null））

```
public class ClientConnectorTask extends AsyncTask<String, Void, Integer> {
    private Socket client;
    private PrintWriter printwriter;
    protected Integer doInBackground(String...strings) {
        // validate input parameters
        if (strings.length <= 0) {
            return 0;
        }
        // connect to the server and send the message
        try {
            client = new Socket("192.168.1.4", 7777);
            printwriter = new PrintWriter(client.getOutputStream(),true);

            //while(true){
            InputStream istream = client.getInputStream();
            BufferedReader receiveRead = new BufferedReader(new InputStreamReader(istream));

            String  receiveMessage;
            while (true){
            //  printwriter.write(strings[0]);
                printwriter.print(strings[0]);
                printwriter.flush();
                printwriter.close();
                if((receiveMessage = receiveRead.readLine()) != null) //receive from server
                {
                    System.out.println(receiveMessage); // displaying at DOS prompt
                } 
            }
            //}

            //client.close();
        } catch (UnknownHostException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return 0;
    }
    protected void onPostExecute(Long result) {
        return;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T02:37:39.740

关闭`PrintWriter`循环内部没有意义，在`readLine()`调用之前关闭它也没有意义。关闭 a 的输入或输出流会`Socket`关闭另一个流和套接字。

# php - 基于 LAMP 架构的网站性能问题

> ID：15536743
> 
> 赞同：0
> 
> 时间：2013-03-20T23:29:38.050
> 
> 标签：php, javascript, mysql, performance

我有一个使用 LAMP 架构的内部网站。我的主页大约需要 10 秒来加载数据。数据不多，大约 4-5k 条记录。我没有任何复杂的 MYSQL 查询，但有很多，即大约 10-15 个查询。基本上我正在提取元数据以显示在页面上。这些是非常简单的查询。我有很多中等复杂性的 PHP 和 javascript 逻辑。我无法删除任何内容。我在该页面中有大约 1800 行代码，并且我正在使用数据表来显示数据。数据表包含 25 列和许多 html 选择元素。那么我怎么知道是什么导致了这个页面的性能瓶颈呢？我试图尽可能清楚，但如果您有任何问题，请告诉我。

感谢您的时间和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:36:52.047

使用任何 php profiler 工具（如 zend profiler）来查看哪个部分花费了很多时间

[http://erichogue.ca/2011/03/linux/profiling-a-php-application/](http://erichogue.ca/2011/03/linux/profiling-a-php-application/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:53:09.603

尝试一次获取所有数据。过去我遇到过问题，使用多个选择实际上比更有效的查询花费更长的时间（还要确保尽可能长时间地使用 sql 连接）。除了分析之外，如果您的其他代码需要优化，则可以采用这种方式。

# android - 适用于 Android 应用程序的 Google 地图崩溃

> ID：15536745
> 
> 赞同：0
> 
> 时间：2013-03-20T23:29:49.427
> 
> 标签：android, google-maps-android-api-2

我创建了一个应用程序并在 Android 设备上对其进行了测试。现在，当我尝试在模拟器中进行测试时，我得到了错误。

我试过[这个](https://stackoverflow.com/a/14562396/1652575)，[这个](http://saleh360.blogspot.in/2012/12/android-running-google-maps-api-v2_12.html)。实际上，它们是相同的。

[这](http://pastebin.com/bTdjsXbV)是我的 LogCat。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:57:01.473

您正在尝试`<fragment>`从不支持片段的活动中使用。最可能的情况是您尝试使用`SupportMapFragment`不继承自的活动`FragmentActivity`。

# php - PHP 将我的浮点数转换为数组中的整数

> ID：15536751
> 
> 赞同：0
> 
> 时间：2013-03-20T23:30:09.347
> 
> 标签：php, arrays, integer, rounding

我有这个代码：

```
 $val = (float) $desc;
  if (!isset($runepage['statistics'][$key])) {
        $runepage['statistics'][$key] = (float) 0.0;
  }
  $runepage['statistics'][$key] += $val; 
```

`$val`浮子在哪里。

但是当我在最后打印出数组时，所有值都以整数结尾。例如，如果同一个 1.5、1.5、1.5 `$key`，它会打印出 3 而不是 4.5。

我不确定它为什么这样做。

编辑：这是数组的输出

```
[statistics] => Array
    (
        [magic penetration] => 9
        [ability power per level] => 9
        [movement speed] => 3
        [magic resist] => 9
    ) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T23:32:21.647

对不起，我误读了你的问题，假设这`$key`是一个浮动。

万一`$val`——我不知道。它应该适用于值，因此问题的根源可能在其他地方。在 PHP 中，将整数和浮点数相加是安全的，结果将是浮点数。

* * *

如果`$key`是浮点数：

这是正常的，[记录在案](http://www.php.net/manual/en/language.types.array.php)的行为。数组不应该被浮点数索引。

看起来数字的字符串也被转换为整数。`$a[5] === $a['5']`.

不幸的是，PHP 数组不是通用的键值存储。您最好的选择是将键序列化为不以数字开头的字符串。

# android - ProgressBar.setProgressDrawable 不适用于 Android 2.3

> ID：15536755
> 
> 赞同：9
> 
> 时间：2013-03-20T23:30:26.570
> 
> 标签：android

我目前正在使用动态更新的`ProgressBar`. 通过某些百分比，进度条设置不同颜色的可绘制对象。我们目前在可绘制的 xml 中定义了各种可绘制的彩色剪辑。题为`progressbar_blue_states`详解如下：

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

  <item android:id="@android:id/background"
      android:drawable="@drawable/progressbar_grey">
  </item>

  <item android:id="@android:id/progress">
      <clip android:drawable="@drawable/progressbar_blue" />
  </item>
</layer-list> 
```

每当我们需要更新对话框时，我们都会调用以下代码：

```
progressBar.setProgressDrawable(getResources().getDrawable(R.drawable.progressbar_blue_states)); 
```

但是，这不仅不会更新 ProgressBar，而且还会完全删除进度条，因为它会留下空白。但是，如果我`android:progressDrawable="@drawable/progressbar_blue_states"`在 xml 中设置并取出这个`setProgressDrawable()`调用，它会正确加载。我们需要 setProgressDrawable 来根据需要更新颜色。

此调用在 Android 4.0+ 中运行良好，但在 Android 2.3 中我们遇到了一些麻烦。有任何想法吗？

**编辑**

这就是我们在 xml 中设置 ProgressBar 的方式：

```
<ProgressBar android:id="@+id/progress"
            style="?android:attr/progressBarStyleHorizontal"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_marginBottom="2dp"
            android:indeterminate="false"
            android:indeterminateOnly="false"
            android:progress="24"
            android:max="100"
            android:progressDrawable="@drawable/progressbar_red_states" /> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-21T09:18:21.270

我有同样的错误，但通过使用[这个答案解决了](https://stackoverflow.com/questions/6220910/how-to-dynamically-change-the-color-of-progress-bar-background-android)

这意味着seekbar有一个新的drawable集，但是drawable的大小是0，你什么都看不到。

```
Rect bounds = mySeekBar.getProgressDrawable().getBounds();
mySeekBar.setProgressDrawable(newSeekBarBackground);
mySeekBar.getProgressDrawable().setBounds(bounds); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-24T06:58:56.780

According to this post [https://stackoverflow.com/a/6953534/3223742](https://stackoverflow.com/a/6953534/3223742)

a good solution is to set progress to 1; re-set max progress, and then set the real progress :

```
progressBar.setProgressDrawable(...);
progressBar.setProgress(1);
progressBar.setMax(maxProgress);
progressBar.setProgress(progress); 
```

# windows-runtime - 网格拆分器重叠

> ID：15536757
> 
> 赞同：0
> 
> 时间：2013-03-20T23:30:31.950
> 
> 标签：windows-runtime, winrt-xaml

我正在尝试创建“重叠”效果（因为没有更好的术语）。将有一个分离器，当移动时，它会显示两个相似图像的不同视图（例如在彩色和灰度之间）。

![](../Images/680021f43e36b579d97b6ab841f66cff.png)

我计划使用 WinRTXAMLToolkit 中的 CustomGridSplitter（由于 WinRT 缺少拆分器）。我正在考虑从类似于以下的网格开始：

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition />
        <RowDefinition Height="10" />
        <RowDefinition />
    </Grid.RowDefinitions>
    <controls:CustomGridSplitter Grid.Row="1" Opacity="0.25"/>
</Grid> 
```

...但我不确定如何进行。如果我在第一行和第三行（或列）上指定两个图像控件，如何防止图像控件移动（或左右）？另外，是否可以对角线执行此操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:52:09.087

您可以使用两个使用 ImageBrush 的 Rectangle 或两个使用 Clip 属性来剪辑其内容的 Image 控件。不幸的是，WinRT 中没有对角线剪辑，只有矩形剪辑。也许您可以检查将多个 RotateTransforms 与 Clip 组合是否可行，您永远不知道。除了上述之外，我会在您的场景中使用 Slider 而不是 GridSplitter。

# excel - 通过匹配数字对 2 列 + 调整列进行排序

> ID：15536758
> 
> 赞同：0
> 
> 时间：2013-03-20T23:30:38.367
> 
> 标签：excel

我在 C 列中有一个很长的 ID 号列表，在 DQ 列中有重要信息。

我需要根据 B 列中的一组特定 ID 号以及 Col DQ 中的匹配信息对其进行排序，如下所示：

我有这个：

```
B     C     D      E . . . 
123   234   male   12
234   345   female 13
345   555   male   12
444   123   male   11 
```

我需要这个：

```
B    C      D      E . . . 
123  123    male   11 
234  234    male   12
345  345    female 13
444  N/A     N/A   N/A 
```

本质上，我需要来自 C 的信息（以及相邻的信息）与 B 匹配或*按*B中的 ID 号排序。文件很大，我只需要通过一组特定的 ID 号来拉/排序它。

谢谢！

编辑：我尝试按照建议使用，在新列中使用以下内容。但是，我收到 #N/A 和 #REF 错误。

```
=Index(D:Q,Match(B:B, C:C,0) 
Provides error: #N/A and #REF! 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:56:05.280

您可以使用 CQ 从 CQ 获取所有匹配数据`index(array, match())`。只需`match()`在 B 和 C 上进行。

# jquery - 引导日期选择器根本不工作

> ID：15536765
> 
> 赞同：6
> 
> 时间：2013-03-20T23:31:19.950
> 
> 标签：jquery, twitter-bootstrap, datepicker

我一直试图从这里获取引导日期选择器：[https](https://github.com/eternicode/bootstrap-datepicker) ://github.com/eternicode/bootstrap-datepicker工作，但日历根本不会出现。不确定我错过了什么？我已经正确链接了所有内容。任何帮助都会很棒，谢谢！

```
<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/datepicker.css" rel="stylesheet"> 
```

```
<input type="text" value="02/16/12" data-date-format="mm/dd/yy" class="datepicker" >

<script src="js/bootstrap.js"></script>
<script src="js/jquery-1.7.1.js"></script>  
<script src="js/bootstrap-datepicker.js"></script>

<script type="text/javascript">
$('.datepicker').datepicker();
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T00:16:56.880

```
$(document).ready(function() {
    $('.datepicker').datepicker();
}) 
```

它在[这里](http://jsfiddle.net/powtac/kGDGX/)工作，我使用了 jQuery 1.7.2、Bootstrap 2.0.2 和最新的[datepicker JS](https://raw.github.com/eternicode/bootstrap-datepicker/master/js/bootstrap-datepicker.js)。我的测试中缺少 CSS，但点击时会出现日期选择器！:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T00:45:28.527

除了添加 $(document).ready() 之外，您还需要在加载 bootstrap.js 之前加载 jquery。

```
<script src="js/jquery-1.7.1.js"></script>  
<script src="js/bootstrap.js"></script>
<script src="js/bootstrap-datepicker.js"></script> 
```

希望有帮助。

# ruby-on-rails - 在 Rails 3 Routes 中递归重定向

> ID：15536767
> 
> 赞同：0
> 
> 时间：2013-03-20T23:31:46.013
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, aliases

我们正在更新我们的大型网络应用程序并摆脱我们的 URL 同义词系统。例如，虽然我们只为“广告商”使用一个模型，但它使用同义路径别名为“商人”和“卖家”。因此，/merchant/1 和 /seller/1 使用与 ads/1 完全相同的控制器和操作。

我们不再需要此功能，但我们确实需要旧 URL 将用户正确重定向到正确的位置（即正确的控制器操作）。

到目前为止，我已经尝试过：

1）阅读[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html) - 这让我尝试以下建议

2) match '/merchants' => redirect('/advertisers') - 尽管语法似乎正确，但这似乎根本不起作用。

3）迭代资源（这会产生大量路线并可能导致不安全感）：

```
ADVERTISER_SYNONOYMS = ['affiliates', 'sellers']

ADVERTISER_SYNONYMS.each do |a|
  resources :advertisers, :path => a,  :as => :advertiser
    resources :other_controller do
      member do
        get :test
        match :generate_test
      end
    end
  end
end 
```

我们在 routes.rb 中使用嵌套资源，因此我正在努力让这些同义词在更复杂的 URL 中被识别。如果有人处理过这个问题或有更优雅的建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T02:04:00.483

有很多方法可以处理这个问题，包括`routes.rb`您尝试过的附加路由，或者在 Web 服务器级别（如 Apache 或 Nginx）重写。

我喜欢的一种解决方案是[rack-rewrite](https://github.com/jtrupiano/rack-rewrite) gem；它使路线保持清洁，并且规则是普通的红宝石。它提供了一组用于配置重写和重定向的方法。对于您的情况，我想使用永久重定向。虽然我自己没有测试过，但以下内容可能对您有用：

```
# Gemfile
gem 'rack-rewrite'

# application.rb
config.middleware.use(Rack::Rewrite) do
  r301 %r{/merchant|seller/(\w+)}, '/advertiser/$1'
end 
```

# php - Twitterbot 会检测和提取动态插入的元标记（通过 javascript）吗？（推特照片卡）

> ID：15536770
> 
> 赞同：1
> 
> 时间：2013-03-20T23:31:57.483
> 
> 标签：php, ajax, api, twitter

可能吗？twitterbot 是否检测和处理动态插入的元标记？如果不是，则仅意味着必须从服务器端脚本呈现元标记。但是，我正在开发的应用程序利用主题标签来动态更改内容（ajax）。在这种环境下，最好的和经过验证的方法是什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-10T00:39:07.373

据我尝试，TwitterBot 爬虫不会呈现 javascript。就我而言，我只在 *HTTP_USER_AGENT* 为*TwitterBot*时为 Twitter Card 生成元标记。代码以这样的开头。

```
if(stripos($_SERVER['HTTP_USER_AGENT'], 'twitterbot') !== false) { 
```

您可以通过在 Twitter Card Validator 上测试您的 url 来检查您的代码是否有效。 [https://dev.twitter.com/docs/cards/validation/validator](https://dev.twitter.com/docs/cards/validation/validator)

希望这有帮助！

# delphi - 为什么使用 Socket.ReceiveLength 不安全？

> ID：15536772
> 
> 赞同：1
> 
> 时间：2013-03-20T23:32:23.417
> 
> 标签：delphi, winsock

好吧，即使[Embarcadero](http://docwiki.embarcadero.com/Libraries/XE3/en/System.Win.ScktComp.TCustomWinSocket.ReceiveLength)声明它不能保证返回准备好在套接字缓冲区中读取的字节的准确结果，但是如果你看一下，当你将 -1 放在 Socket.ReceiveBuf （这是 ReceiveLength 包装的内容）时，它会调用**ioctlsocket**和**FIONREAD** *来确定网络输入缓冲区中可以从套接字 s 读取的待处理数据量*。

那么，它怎么不安全或不好呢？

例如：`ioctlsocket(Socket.SocketHandle, FIONREAD, Longint(i));`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T23:54:46.383

你提到的文件特别说（强调我的）

> **注意：对于流式套接字连接，**不能保证 ReceiveLength 是准确的。

这意味着长度无法提前知道，因为它是由数据流提供的。显然，如果您不知道提前发送的数据有多大，您就无法正确设置客户端应该期望的长度。

将其视为复制文件的通用代码。如果您事先不知道要复制的文件有多大，则无法预测要复制的字节数。在套接字的情况下，提供套接字的流大小是事先不知道的（例如，对于实时生成和发送的数据），因此无法通知客户端套接字期望多少。

# jquery - 如何检测在jquery中单击了哪个提交按钮

> ID：15536779
> 
> 赞同：0
> 
> 时间：2013-03-20T23:33:23.353
> 
> 标签：jquery, submit

如果我的表单上有 2 个提交按钮，**是否可以检测到**在 jquery 中单击了哪一个？

```
<input name="submit" type="submit" value="Button 1">
<input name="submit" type="submit" value="Button 2"> 
```

这始终返回“按钮 1”

```
alert($("input[name=submit]").val()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T23:40:57.330

您不一定需要唯一的 ID...使用您提供的 HTML：

```
$("input[type=submit]").click(function() {
   alert($(this).val());
}); 
```

编辑：我同意您应该更改其中一个按钮的名称

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:35:28.630

您需要有唯一的 ID：

```
<input id="submit1" name="submit" type="submit" value="Button 1">
<input id="submit1" name="submit" type="submit" value="Button 2"> 
```

> id 属性为 HTML 元素指定一个唯一的 id（该值在 HTML 文档中必须是唯一的）。

[http://www.w3schools.com/tags/att_global_id.asp](http://www.w3schools.com/tags/att_global_id.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T23:41:06.343

最好的选择是为每个按钮设置唯一的 ID，您可以这样做：

```
$('input').on('click', function(){
    alert(this.id);
}); 
```

否则，如果您想保留当前结构并返回您需要的值：

```
$('input').on('click', function(){
    // the value inside attr() can be any property of the element
    alert($(this).attr('value'));
}); 
```

# c++ - 让自己对指针和引用感到困惑，c++（从 WinAPI 获取鼠标坐标）

> ID：15536781
> 
> 赞同：0
> 
> 时间：2013-03-20T23:33:26.640
> 
> 标签：c++, pointers, reference

我有一堂课：

```
class Mouse
{
public:
    int x;
    int y;
    void MouseMove( int x, int y );
    Mouse();
}; 
```

我将它作为头文件包含到我的 windows.cpp 中，其中包含 WndProc 和 WinMain 函数。就在它的下面，我声明了我的鼠标的一个静态实例：

```
#include "Mouse.h"
#include "Game.h"

static Mouse mouse; 
```

我的鼠标方法如下所示：

```
#include "Mouse.h"

void Mouse::MouseMove( int x, int y )
{
    this->x = x;
    this->y = y;
} 
```

在我的 WndProc 上，我正在处理 WM_MOUSEMOUSE 并将 x 和 y 值（它们具有正确的值传递给我的 MouseMove 函数：

```
case WM_MOUSEMOVE:
            {

                int x = ( short )LOWORD( lParam );
                int y = ( short )HIWORD( lParam );

                bool leftButtonDown = wParam & MK_LBUTTON;
                bool rightButtonDown = wParam & MK_RBUTTON;

                mouse.MouseMove( x, y );

            }
            break; 
```

我的 MouseMove 函数运行并成功地将 this->x 设置为 x 并且与 y 值相同。就这样……完成了。

现在，在我的 Windows 循环中，我正在运行我的游戏（theGame.Go）：

```
Game theGame = Game( hWnd );

    MSG msg;

    ZeroMemory( &msg, sizeof(msg) );

    while( msg.message!=WM_QUIT )
    {
       if( PeekMessage( &msg, NULL, 0U, 0U, PM_REMOVE ) )
       {
          TranslateMessage( &msg );
          DispatchMessage( &msg );
       }
       else
       {
            theGame.Go();
       }
    } 
```

我的游戏标题如下所示：

```
#include "Mouse.h"

    class Game
    {
    public:
        Game( HWND hWnd );
        ~Game();
        void Go();
        void ComposeFrame();

        LPD3DXSPRITE sprite;
        LPDIRECT3DTEXTURE9 gTexture;
        D3DXVECTOR3 pos;
    private:
        D3DGraphics gfx;
    }; 
```

我的游戏构造如下所示：

```
Game::Game( HWND hWnd )
    :
    gfx( hWnd )
{
    HRESULT result;

    sprite = NULL;
    result = D3DXCreateSprite( gfx.d3dDevice, &sprite );
    assert( !FAILED( result ) );

    gTexture = NULL;
    result = D3DXCreateTextureFromFile( gfx.d3dDevice, "Images/character001.png", &gTexture );
    assert( !FAILED( result ) );

    gfx.d3dDevice->SetRenderState( D3DRS_ALPHABLENDENABLE, TRUE);
}; 
```

游戏对象不知道在我的 windows.cpp 中声明的鼠标对象是否存在，无论我是否已在此处全局声明它。所以我想，我需要通过引用将鼠标对象传递给我的 Game 对象。我首先像这样修改 windows 循环：

```
Game theGame = Game( hWnd, &mouse );

    MSG msg;

    ZeroMemory( &msg, sizeof(msg) );

    while( msg.message!=WM_QUIT )
    {
       if( PeekMessage( &msg, NULL, 0U, 0U, PM_REMOVE ) )
       {
          TranslateMessage( &msg );
          DispatchMessage( &msg );
       }
       else
       {
            theGame.Go();
       }
    } 
```

现在我在我的 Game.h 类中添加了一些参数，这样我就有了对内存的引用，并且以后可以从中获取 *mouse.x ......：

```
class Game
{
public:
    Game( HWND hWnd, Mouse &mouse );
... 
```

我回去看看我的 windows 循环，我的电话下面有一个波浪线：

```
Game theGame = Game( hWnd, &mouse ); 
```

其中指出：

```
6   IntelliSense: no instance of constructor "Game::Game" matches the argument list
        argument types are: (HWND, Mouse *) c:\Users\James\Documents\Visual Studio 2012\Projects\Game\Game\Windows.cpp  75  17  Game 
```

我不明白？我到底如何只更改鼠标的一个全局实例并从我该死的游戏对象中调用它:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:36:56.253

您已将`Game::Game`构造函数声明为对 a 的引用，`Mouse`但您正在向它传递一个指针。

要么更改为：

```
Game::Game(HWND hWnd, Mouse* mouse); 
```

或者：

```
Game(hWnd, mouse); 
```

另请注意，当您调用`Game`构造函数时，实际上是在制作不必要的副本：

```
Game theGame = Game( hWnd, &mouse ); 
```

相反，将其更改为：

```
Game theGame( hWnd, &mouse ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T23:41:05.423

导致您的错误的问题是您的`Game`构造函数*引用*了`Mouse`：

```
Game( HWND hWnd, Mouse &mouse ); 
```

但是，您通过以下地址传递一个*指针*：`Mouse``mouse`

```
Game theGame = Game( hWnd, &mouse ); 
```

您可以更改其中之一：将参数类型更改为指针 ( `Mouse* mouse`) 或作为参数传递`mouse`。

但是，这是拥有全局对象的非典型方法。通过声明`mouse`as `static`，您将为其提供内部链接，并且无法在任何其他翻译单元中访问它。您通常会在单个头文件中包含以下声明，当您需要访问全局`mouse`对象时，您将包含该声明：

```
extern Mouse mouse; 
```

然后在单个实现文件中提供定义：

```
Mouse mouse; 
```

# java - awt 事件队列 0 空指针异常错误

> ID：15536790
> 
> 赞同：0
> 
> 时间：2013-03-20T23:34:02.877
> 
> 标签：java, swing, user-interface, nullpointerexception, actionlistener

好的，我收到此错误`awt eventqueue 0 nullpointerexception error`。当我尝试删除一个`JPanel`.

令我困惑的是，当我删除另一个时`JPanel`它工作得很好，但这个却没有。下面的第一个代码显示`JPanel`，当我单击 a 时`JButton`，它不会删除`JPanel`.

```
public class buttontime implements ActionListener { //creating actionlistener for clicking on timebutton to bring up a combobox

    public void actionPerformed(ActionEvent clickTime) {
        Price priceObject = new Price();
        priceObject.getPricepanel();
        remove(priceObject.getPricepanel());
        priceObject.getPricepanel().revalidate();

        add(timeObject.getTimePanel(), BorderLayout.EAST);
        timeObject.getTimePanel().revalidate();

    }
}

//This one gives me 0 errors.
public class buttonprice implements ActionListener { //creating actionlistener for clicking on timebutton to bring up a combobox

    public void actionPerformed(ActionEvent ClickPrice) {

        Price priceObject = new Price();
        priceObject.SelectPrice();
        remove(timeObject.getTimePanel());
        timeObject.getTimePanel().revalidate();

        add(priceObject.getPricepanel(), BorderLayout.EAST);
        priceObject.getPricepanel().revalidate();

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:36:29.947

```
remove(priceObject.getPricepanel()); 
```

`NullPointerException`如果您仅在移除此面板时得到一个，则`priceObject.getPricepanel()`必须返回`null`。

# html - 左侧浮动图像

> ID：15536793
> 
> 赞同：0
> 
> 时间：2013-03-20T23:34:35.517
> 
> 标签：html, css

我对 html 和 css 有点生疏了，我无法让 2 个图像浮动，一个在另一个之上。这是代码...

```
 <div class="kbody">
        <img class="kimg1" src="img1.jpg" alt=" " width="375px" height="auto">      
    <div id="ktxt">
        <p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
        Kristallnacht occurred on November 9-10, 1938\. Also known as the night of 
        broken glass, it was an organized attack on the Jews. Hitler had Nazis all over 
        Germany and Austria that burned synagogues, broke store windows, stole from the
        stores, killed a couple dozen Jews, and arrested twenty thousand more. A few days 
        later Germany made an &quotatonement fine&quot that added up to over one billion dollars 
        and placed it on the remaining Jews. </p>
    </div>
    <img class="kimg2" src="img3.jpg" alt=" " width="375px" height="auto">
    </div> 
```

和CSS...

```
.kbody {
width:800px;
margin-left: auto;
margin-right: auto;
/*border-style:solid;
border-width:3px;*/
}

.kimg1 {
padding-left:5px;
padding-top:5px;
padding-bottom:5px;
float:left;
}

.kimg2 {
padding-left:5px;
padding-top:5px;
padding-bottom:5px;
float:left;
margin-top:10px;
}

#ktxt {
padding-left:10px;
padding-right:10px;
padding-top:10px;
/*border-width:2px;
border-style: solid;*/
width:350px;
height:330px;
margin-left:402px;
font-style:arial, sans-serif;
color: #336699;
font-size:14pt;
} 
```

我究竟做错了什么？？这是这段代码的样子 [http://imgur.com/a/ivDE2#0](http://imgur.com/a/ivDE2#0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:40:45.277

要将第二个图像移动到第一个图像下：

```
.kimg2 {
    clear: both;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:32:12.703

尝试包装您的图像

html

```
<div class="kbody">
        <div class="imageWrapper">
        <img class="kimg1" src="img1.jpg" alt=" " width="375px" height="auto" />
        <img class="kimg2" src="img3.jpg" alt=" " width="375px" height="auto" />
        </div>
    <div id="ktxt">
        <p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
        Kristallnacht occurred on November 9-10, 1938\. Also known as the night of 
        broken glass, it was an organized attack on the Jews. Hitler had Nazis all over 
        Germany and Austria that burned synagogues, broke store windows, stole from the
        stores, killed a couple dozen Jews, and arrested twenty thousand more. A few days 
        later Germany made an &quotatonement fine&quot that added up to over one billion dollars 
        and placed it on the remaining Jews. </p>
    </div>

    </div> 
```

css

```
.imageWrapper {
    float:left;
    width:375px;
} 
```

希望这对你有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:42:58.443

更简单的方法是`<img src="yourimage.jpg" align="left" />`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T02:29:44.390

因为你想让你的图片浮动到左侧是不可能的。所以，你应该为你想要的东西定义你的html。

```
<div class="kbody">
    <div class="kimg">
         <img ..image1../>
         <img ..image2../>
    </div>
    <div id="ktext">your text...</div>
</div> 
```

现在定义css。

提示：

```
.kimg{width: 300px;}
#ktext{width: 300px;} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T23:43:32.487

```
<div class="kbody">
    <img class="kimg1" src="img1.jpg" alt=" " width="375px" height="auto">      
<div id="ktxt">
    <p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
    Kristallnacht occurred on November 9-10, 1938\. Also known as the night of 
    broken glass, it was an organized attack on the Jews. Hitler had Nazis all over 
    Germany and Austria that burned synagogues, broke store windows, stole from the
    stores, killed a couple dozen Jews, and arrested twenty thousand more. A few days 
    later Germany made an &quotatonement fine&quot that added up to over one billion dollars 
    and placed it on the remaining Jews. </p>
</div>
<img class="kimg2" src="img3.jpg" alt=" " width="375px" height="auto">
<div style="clear:both"></div>
</div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T23:44:35.327

1.  在要在单独的行中显示它们的元素之间放置一个 clearfix。我会编写一个全局css规则`.clearfix { clear: both; }`，并在第二张图片之前放置一个div；

2.  而不是编写一堆`&nbsp;`使用 CSS`text-indent`属性；

示例代码：

```
<div class="kbody">
    <img class="kimg1" src="img1.jpg" alt=" " width="375px" height="auto">      
    <div id="ktxt">
        <p>
        Kristallnacht occurred on November 9-10, 1938\. Also known as the night of 
        broken glass, it was an organized attack on the Jews. Hitler had Nazis all over 
        Germany and Austria that burned synagogues, broke store windows, stole from the
        stores, killed a couple dozen Jews, and arrested twenty thousand more. A few days 
        later Germany made an &quotatonement fine&quot that added up to over one billion dollars 
        and placed it on the remaining Jews. 
        </p>
    </div>
    <div class="clearfix"></div>
    <img class="kimg2" src="img3.jpg" alt=" " width="375px" height="auto">
</div> 
```

# c# - 异步超时后正确关闭 FileStream

> ID：15536797
> 
> 赞同：2
> 
> 时间：2013-03-20T23:34:54.580
> 
> 标签：c#, .net, winapi, asynchronous, nfs

我正在编写一个 C# 应用程序（仅限于 .NET 框架 4.0 或更低版本（即没有 Read/WriteAsync）），负责在 Windows（7 或更高版本）机器和基于 NFS 的基于 Unix 的服务器之间读取/写入文件.
客户端机器是移动的，预计会定期与网络断开连接。正因为如此，我希望加强我的应用程序以优雅地处理读取或写入操作中间的断开连接（希望是偶然的）。

为了跟踪是否发生超时，我异步读取（或写入）并使用返回的`AsyncWaitHandle`by ：`IAsyncResult``FileStream.BeginRead`

```
private int PerformRead (FileStream readStream,
                         byte [] buffer,
                         int nBytes)
{
    IAsyncResult readResult = null;

    try
    {
        readResult = readStream.BeginRead
            (buffer, 0, nBytes, null, null);

        // If the read was completed, return # of bytes read.
        if (readResult.AsyncWaitHandle.WaitOne (1000))
        {
            return readStream.EndRead (readResult);
        }
        // Otherwise, the timeout has elapsed.
        else
        {
            throw new TimeoutException ();
        }
    }
    finally
    {
        if (null != readResult)
        {
            readResult.AsyncWaitHandle.Close ();
        }
    }
} 
```

我的问题是在超时的情况下清理我的流。似乎在连接断开时调用`Dispose()`或`Close()`在流上无限期挂起。为了尝试解决这个问题，我`CloseHandle()`在超时时显式调用文件句柄上的 Win32。当连接被切断时，此功能似乎也会阻塞。以下代表我对读取流的处理。

```
private void ReadNewFile (string path,
                          byte [] buffer)
{
    IntPtr readHandle = IntPtr.Zero;
    FileStream readStream = null;
    try
    {
        readHandle = CreateFile (path
                                 0xc0000000,
                                 0,
                                 IntPtr.Zero,
                                 3,
                                 0x40000000,
                                 IntPtr.Zero);
        SafeFileHandle safeReadHandle = new SafeFileHandle (readHandle, true);
        if (safeReadHandle.IsInvalid)
        {
            throw new Exception ();
        }
        readStream = new FileStream (safeReadHandle,
                                     FileAccess.Read,
                                     4092,
                                     true);
        while (true)
        {
            // Read part of the file into the buffer.
            int bytesRead = PerformRead (readStream, buffer, buffer.Length);

            // If EOF reached, break.
            if (bytesRead == 0)
            {
                break;
            }
        }
    }
    catch (TimeoutException)
    {
        // NOTE: Hangs indefinitely if the network cable is unplugged.
        CloseHandle (readHandle);
    }
    finally
    {
        if (null != readStream)
        {
            // NOTE: Hangs indefinitely if both of the following are true:
            // - Network cable is unplugged (resulting in TimeoutException)
            // - The body of the caught TimeoutException is commented out.
            readStream.Close ();
        }
    }
} 
```

是否有推荐的方法来正确处理不再可用的文件的 FileStream？请注意，`BeginRead`如果连接断开，任何调用也将无限期挂起。

# javascript - 如果在 js.erb 中确认

> ID：15536798
> 
> 赞同：1
> 
> 时间：2013-03-20T23:34:59.467
> 
> 标签：javascript, ruby-on-rails, ruby, ruby-on-rails-3, erb

我需要这样的东西才能工作：

显示.erb.js：

```
if (confirm('Delete cart?')) { 
  <%@current_cart.reset%>
  $('.cartbadge').replaceWith('<%= j render :partial => "layouts/cartbadge"%>');
} 
```

但代码的 erb 部分总是在执行

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:13:22.737

因为代码`<%@current_cart.reset%>`会在 erb 被解释的时候执行。

你必须像这样使用ajax：

```
if (confirm('Delete cart?')) { 
  $.post('<%= reset_cart_path(@current_cart) %>', function() {
      $('.cartbadge').replaceWith('<%= j render :partial => "layouts/cartbadge"%>');
  });
} 
```

# php - 显示特定输入字段的验证错误

> ID：15536800
> 
> 赞同：0
> 
> 时间：2013-03-20T23:35:07.537
> 
> 标签：php, validation, cakephp, file-upload

我有一个为个人资料图片上传文件的表单，我正在验证文件上传，如下所示：

```
'picture' => array(
    'kosher' => array(
        'rule' => 'validateImage',
        'message' => 'Only images are allowed to be uploaded'
    ),
    'size' => array(
        'rule' => array('fileSize', '<=', '2MB'),
        'message' => 'Picture must be less than 2 MB'
    )
) 
```

验证运行，并且有效，但是当我提交不正确的数据时，表单上没有显示验证错误。我正在构建整个表单，如下所示：

```
<?php echo $this->Form->create('Profile', array('type' => 'file')); ?>
<?php echo $this->Form->hidden('id'); ?>
<?php echo $this->Form->label('Profile.picture', 'Profile picture'); ?>
<?php echo $this->Form->file('picture'); ?>
<?php echo $this->Form->input('firstname'); ?>
<?php echo $this->Form->input('lastname'); ?>
<?php echo $this->Form->input('email', array('between' => 'This is the email other users will use to contact you')); ?>
<?php echo $this->Form->input('Skill', array('type' => 'text', 'value' => $skills, 'label' => 'Your skills (seperate each skill by space)')); ?>
<?php echo $this->Form->input('course'); ?>
<?php echo $this->Form->input('bio'); ?>
<?php echo $this->Form->end('Save changes'); ?> 
```

其他字段错误消息正确显示，而不是文件上传。如何使验证错误显示在文件输入周围？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:35:25.410

您已经使用`$this->Form->file('picture');`了它只会生成文件上传字段。

在其下方添加一个`$this->Form->error('picture');`将显示验证错误消息或用于`$this->Form->input('picture', array('type' => 'file'));`生成文件上传输入的内容。

`Form::input()`是一种包装方法，它生成所需的输入字段、标签标签并显示验证错误消息（如果有）。请阅读手册。

# asp.net - 异步处理.NET SQL Server？

> ID：15536801
> 
> 赞同：1
> 
> 时间：2013-03-20T23:35:11.643
> 
> 标签：asp.net, asynchronous, sql-server-2008-r2

经过多年的编程，我第一次需要异步做一些事情（因为它需要几分钟并且网页超时 - 无论如何都不希望用户等待那么长时间）。此操作仅由少数人完成，但每天可以执行几次（针对每个人）。

从使用 LINQ 的 ASP.NET 网页上单击“保存”，我将一条记录插入到 SQL Server 表中。然后触发一个 SSIS 包将该记录推送到全国其他几个数据库。

所以..

1.  我怎样才能（希望简单地）使这个异步，以便用户可以继续做其他事情？

2.  这应该设置在.NET 端还是 SQL 端？

3.  有没有办法（几分钟后）用户可以知道该过程已经完成并成功？也许是一封电子邮件？不知道用户如何知道它完成得很好。

我在这个网站上阅读了一些关于它的线程，但它们是从 2009 年开始的，所以不确定现在与 Visual Studio 2012/.NET Framework 4.5 是否有很大不同（我们仍在使用 SQL Server 2008 R2）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:40:08.570

在 ASP.Net 中执行长时间运行的任务通常是个坏主意。一方面，如果应用程序池在任务完成之前被回收，它就会丢失。

我建议将请求写入数据库表，并使用单独的 Windows 服务来完成长时间运行的工作。它可以更新数据库表中的状态列，稍后可以检查以查看任务是否完成以及是否有错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:10:06.793

您可以在 SQL 端使用 Service Broker；这是消息队列的 SQL Server 实现。[这里](http://blog.sqlauthority.com/2009/09/21/sql-server-intorduction-to-service-broker-and-sample-script/ "这里")和[这里的](http://blog.maskalik.com/sql-server-service-broker/scalable-webservice-calls-from-database "here")好例子

您所做的是创建一个 Service Broker 服务并定义一些脚手架（队列、消息类型等）。然后创建一个服务“激活”过程，它基本上是一个使用队列中消息的存储过程。例如，该 SP 将收到一条带有表中记录 ID 的消息，然后继续执行任何需要对其执行的操作，可能在完成后发送一封电子邮件等。

因此，从您的代码隐藏中，您将调用一个简单的存储过程，它将用户的数据插入到一个表中，并向队列发送一条消息，例如新记录的 ID，然后立即返回。我想你应该提前告诉用户这可能需要几分钟，他们会收到一封电子邮件等。

Service Broker 的优点是消息传递几乎得到保证 - 即使您的 SQL Server 在消息排队后立即崩溃，当您将其恢复时，激活 SP 将再次启动，因此它非常强大。

# ruby-on-rails - cap 使用 admin 而不是 ec2-user

> ID：15536803
> 
> 赞同：0
> 
> 时间：2013-03-20T23:35:23.197
> 
> 标签：ruby-on-rails, deployment, amazon-web-services, amazon-ec2, capistrano

我正在尝试为我的 ROR 网站对 EC2 实例（Amazon 映像）执行“cap ec2onrails:setup”，但无论我做什么，身份验证都会不断要求我输入密码。我已经尝试了我在这个论坛和/或其他论坛中读到的几乎所有内容：

*   将公钥从 ~/.ssh 复制到 ec2-user@_.sa-east-1.compute.amazonaws.com:/home/ec2-user/.ssh/authorized_keys2 （或authorized_keys）
*   使用 Amazon 管理控制台生成私钥，然后将公钥从服务器复制到我的机器
*   使用 ssh-add -l 添加这些密钥中的任何一个
*   使用 ssh-keychain 生成新密钥
*   使用我机器中已有的公钥/私钥集（id_rsa & id_rsa.pub）
*   按照上述 ^^ 约定命名键
*   chmod 400 用于 ~/.ssh 中的键
*   将键移动到 ~/.ec2
*   设置环境变量，如此[处所述](http://docs.aws.amazon.com/AWSEC2/2007-08-29/GettingStartedGuide/running-an-instance.html)

笔记：

*   使用 ssh 和 AWS .pem 密钥连接到服务器就可以了
*   我如何在“ssh_options”中设置“keys”值并不重要，Capistrano 似乎总是忽略它。但是，它不会忽略 ssh-add -l 中列出的键

这是我尝试设置关键路径的方法

```
set :ssh_options, {:keys => ["/Users/dalef/.ssh/pk"]} 
```

这是我最新测试的输出代码，使用详细输出

```
Damians-MacBook-Pro:test dalef$ cap ec2onrails:setup
[Deprecation Warning] This API has changed, please hook `deploy:create_symlink` instead of `deploy:symlink`.
  * 2013-03-20 20:10:52 executing `ec2onrails:setup'
  * 2013-03-20 20:10:52 executing `ec2onrails:server:update_hostname'
  * executing "sudo -p 'sudo password: ' /usr/local/ec2onrails/bin/update_hostname"
    servers: ["___.sa-east-1.compute.amazonaws.com"]
D, [2013-03-20T20:10:52.471872 #2647] DEBUG -- net.ssh.transport.session[3fe825c3c40c]: establishing connection to ___.sa-east-1.compute.amazonaws.com:22
D, [2013-03-20T20:10:52.539934 #2647] DEBUG -- net.ssh.transport.session[3fe825c3c40c]: connection established
I, [2013-03-20T20:10:52.540236 #2647]  INFO -- net.ssh.transport.server_version[3fe825c45728]: negotiating protocol version
D, [2013-03-20T20:10:52.591866 #2647] DEBUG -- net.ssh.transport.server_version[3fe825c45728]: remote is `SSH-2.0-OpenSSH_5.3'
D, [2013-03-20T20:10:52.591965 #2647] DEBUG -- net.ssh.transport.server_version[3fe825c45728]: local is `SSH-2.0-Ruby/Net::SSH_2.6.6 x86_64-darwin12.2.0'
D, [2013-03-20T20:10:52.635419 #2647] DEBUG -- tcpsocket[3fe825c40570]: read 784 bytes
D, [2013-03-20T20:10:52.635555 #2647] DEBUG -- tcpsocket[3fe825c40570]: received packet nr 0 type 20 len 780
I, [2013-03-20T20:10:52.635654 #2647]  INFO -- net.ssh.transport.algorithms[3fe825c484dc]: got KEXINIT from server
I, [2013-03-20T20:10:52.635844 #2647]  INFO -- net.ssh.transport.algorithms[3fe825c484dc]: sending KEXINIT
D, [2013-03-20T20:10:52.636042 #2647] DEBUG -- tcpsocket[3fe825c40570]: queueing packet nr 0 type 20 len 1620
D, [2013-03-20T20:10:52.636141 #2647] DEBUG -- tcpsocket[3fe825c40570]: sent 1624 bytes
I, [2013-03-20T20:10:52.636196 #2647]  INFO -- net.ssh.transport.algorithms[3fe825c484dc]: negotiating algorithms
D, [2013-03-20T20:10:52.636319 #2647] DEBUG -- net.ssh.transport.algorithms[3fe825c484dc]: negotiated:
* kex: diffie-hellman-group-exchange-sha1
* host_key: ssh-rsa
* encryption_server: aes128-cbc
* encryption_client: aes128-cbc
* hmac_client: hmac-sha1
* hmac_server: hmac-sha1
* compression_client: none
* compression_server: none
* language_client: 
* language_server: 
D, [2013-03-20T20:10:52.636373 #2647] DEBUG -- net.ssh.transport.algorithms[3fe825c484dc]: exchanging keys
D, [2013-03-20T20:10:52.636563 #2647] DEBUG -- tcpsocket[3fe825c40570]: queueing packet nr 1 type 34 len 20
D, [2013-03-20T20:10:52.636613 #2647] DEBUG -- tcpsocket[3fe825c40570]: sent 24 bytes
D, [2013-03-20T20:10:52.738438 #2647] DEBUG -- tcpsocket[3fe825c40570]: read 152 bytes
D, [2013-03-20T20:10:52.738637 #2647] DEBUG -- tcpsocket[3fe825c40570]: received packet nr 1 type 31 len 148
D, [2013-03-20T20:10:52.744324 #2647] DEBUG -- tcpsocket[3fe825c40570]: queueing packet nr 2 type 32 len 140
D, [2013-03-20T20:10:52.744468 #2647] DEBUG -- tcpsocket[3fe825c40570]: sent 144 bytes
D, [2013-03-20T20:10:52.790733 #2647] DEBUG -- tcpsocket[3fe825c40570]: read 720 bytes
D, [2013-03-20T20:10:52.790938 #2647] DEBUG -- tcpsocket[3fe825c40570]: received packet nr 2 type 33 len 700
D, [2013-03-20T20:10:52.795329 #2647] DEBUG -- tcpsocket[3fe825c40570]: queueing packet nr 3 type 21 len 20
D, [2013-03-20T20:10:52.795447 #2647] DEBUG -- tcpsocket[3fe825c40570]: sent 24 bytes
D, [2013-03-20T20:10:52.795542 #2647] DEBUG -- tcpsocket[3fe825c40570]: received packet nr 3 type 21 len 12
D, [2013-03-20T20:10:52.795871 #2647] DEBUG -- net.ssh.authentication.session[3fe826273f28]: beginning authentication of `admin'
D, [2013-03-20T20:10:52.796008 #2647] DEBUG -- tcpsocket[3fe825c40570]: queueing packet nr 4 type 5 len 28
D, [2013-03-20T20:10:52.796071 #2647] DEBUG -- tcpsocket[3fe825c40570]: sent 52 bytes
D, [2013-03-20T20:10:52.944233 #2647] DEBUG -- tcpsocket[3fe825c40570]: read 52 bytes
D, [2013-03-20T20:10:52.944626 #2647] DEBUG -- tcpsocket[3fe825c40570]: received packet nr 4 type 6 len 28
D, [2013-03-20T20:10:52.945125 #2647] DEBUG -- net.ssh.authentication.session[3fe826273f28]: trying publickey
D, [2013-03-20T20:10:52.945906 #2647] DEBUG -- net.ssh.authentication.agent[3fe826263a88]: connecting to ssh-agent
D, [2013-03-20T20:10:52.946221 #2647] DEBUG -- net.ssh.authentication.agent[3fe826263a88]: sending agent request 1 len 51
D, [2013-03-20T20:10:52.946460 #2647] DEBUG -- net.ssh.authentication.agent[3fe826263a88]: received agent packet 2 len 5
D, [2013-03-20T20:10:52.946578 #2647] DEBUG -- net.ssh.authentication.agent[3fe826263a88]: sending agent request 11 len 0
D, [2013-03-20T20:10:52.946859 #2647] DEBUG -- net.ssh.authentication.agent[3fe826263a88]: received agent packet 12 len 294
D, [2013-03-20T20:10:52.947478 #2647] DEBUG -- net.ssh.authentication.methods.publickey[3fe826263fd8]: trying publickey (b7:96:23:2d:21:f3:5e:dd:ba:e9:7c:7d:f5:4c:fd:0c)
D, [2013-03-20T20:10:52.947821 #2647] DEBUG -- tcpsocket[3fe825c40570]: queueing packet nr 5 type 50 len 348
D, [2013-03-20T20:10:52.947994 #2647] DEBUG -- tcpsocket[3fe825c40570]: sent 372 bytes
D, [2013-03-20T20:10:52.993286 #2647] DEBUG -- tcpsocket[3fe825c40570]: read 52 bytes
D, [2013-03-20T20:10:52.993497 #2647] DEBUG -- tcpsocket[3fe825c40570]: received packet nr 5 type 51 len 28
D, [2013-03-20T20:10:52.993717 #2647] DEBUG -- net.ssh.authentication.session[3fe826273f28]: allowed methods: publickey
D, [2013-03-20T20:10:52.993904 #2647] DEBUG -- net.ssh.authentication.methods.publickey[3fe826263fd8]: trying publickey (40:2c:20:e7:0c:f4:65:32:76:7c:39:5e:83:84:70:b2)
D, [2013-03-20T20:10:52.994095 #2647] DEBUG -- tcpsocket[3fe825c40570]: queueing packet nr 6 type 50 len 348
D, [2013-03-20T20:10:52.994202 #2647] DEBUG -- tcpsocket[3fe825c40570]: sent 372 bytes
D, [2013-03-20T20:10:53.035308 #2647] DEBUG -- tcpsocket[3fe825c40570]: read 52 bytes
D, [2013-03-20T20:10:53.035556 #2647] DEBUG -- tcpsocket[3fe825c40570]: received packet nr 6 type 51 len 28
D, [2013-03-20T20:10:53.035693 #2647] DEBUG -- net.ssh.authentication.session[3fe826273f28]: allowed methods: publickey
E, [2013-03-20T20:10:53.035782 #2647] ERROR -- net.ssh.authentication.session[3fe826273f28]: all authorization methods failed (tried publickey)
Password: 
```

这是我最新测试的密钥列表（只是我从服务器检索到的那个）

```
Damians-MacBook-Pro:test dalef$ ssh-add -l
2048 b7:96:23:2d:21:f3:5e:dd:ba:e9:7c:7d:f5:4c:fd:0c pk (RSA) 
```

有什么我想念的吗？我已经接近尝试基于密码的身份验证了。

谢谢！！

**更新**

仍在尝试替代方案。我还通过与 AWS 密钥指纹和授权密钥进行比较来确保我使用了正确的密钥

```
From Amazon:
dalef 90:04:34:df:75:cc:9c:f0:90:4f:77:17:98:ee:ec:c1:95:d9:f6:14

Damians-MacBook-Pro:.ssh dalef$ ec2-fingerprint-key dalef
90:04:34:df:75:cc:9c:f0:90:4f:77:17:98:ee:ec:c1:95:d9:f6:14
Damians-MacBook-Pro:.ssh dalef$ ssh-add dalef
Identity added: dalef (dalef)
Damians-MacBook-Pro:.ssh dalef$ ssh-add -l
2048 40:2c:20:e7:0c:f4:65:32:76:7c:39:5e:83:84:70:b2 id_rsa (RSA)
2048 e6:02:1a:a4:2a:f9:63:4a:b7:de:66:60:f2:fa:0c:b4 dalef (RSA)

[ec2-user@___ .ssh]$ cat authorized_keys 
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCcfgMIAbEfNAiSgi4zXsObR1zGPHzVbff2suB/J2rLVgr5XNfLhf+kTRzTij0IWsutYj45j/eI87xC912WYtNG2An8262JwqRJZfwbnfDHMjwPQRwlDNjgGWRZwl8x9HO1V7EmBCaEEpeXg0ogbdhM386f/TTdWdUOofSqTEjuN2Nk73OHirPAj7MuWSGwGAwKCS4In2KbGAP/hk0c/PsCx52J+zjp2lteEaA9qWIovQggRw73dAqV++czMwCx2+7GMGxGx21fgSH4cYZ7Q6XxAxBkmsO7yoKZHUFj5QobSJ1TVh7N/61bFInt6Ua6btTXC7jwaATzkOBkv/rwLgtN **dalef** 
```

仍然要求输入密码。

**更新** 我的设置一定有问题。我尝试允许密码连接，但这也不起作用。我是否需要开始考虑 Capistrano 替代品？

这是日志

```
[ec2-user@___ ~]$ sudo vi /etc/ssh/sshd_config 
PasswordAuthentication yes
[ec2-user@___ ~]$ sudo passwd ec2-user
Changing password for user ec2-user.
New password: 
Retype new password: 
passwd: all authentication tokens updated successfully.
[ec2-user@___ ~]$ exit
...
E, [2013-03-21T00:31:02.582111 #3739] ERROR -- net.ssh.authentication.session[3fd0f6e21178]: all authorization methods failed (tried password)
connection failed for: admin@___.sa-east-1.compute.amazonaws.com (Net::SSH::AuthenticationFailed: admin) 
```

**从这些日志中，我假设 Capistrano 正在尝试以管理员身份登录。如何将其更改为 ec2-user？**（我已经尝试在 deploy.rb 中设置：user，“ec2-user”）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T01:56:56.353

所以经过大量阅读，我找到了解决方案。这为我指明了正确的方向：[https ://serverfault.com/questions/55343/cant-get-ssh-public-key-authentication-to-work](https://serverfault.com/questions/55343/cant-get-ssh-public-key-authentication-to-work)

主要问题是我不知道自己在做什么。所以无论如何，如果有人对我提出的解决方案感兴趣：

*   不知何故，Capistrano 总是使用一个管理员用户，除了你设置的那个，所以我创建了一个。您可以继续执行以下步骤：[http ://aws.amazon.com/articles/1233](http://aws.amazon.com/articles/1233)
*   我使用 ssh-keygen -b 1024 -f ec2admin -t dsa 创建了自己的一组 pub/private 密钥
*   我使用 scp 将 ec2admin.pub 文件复制到服务器中的 /home/admin/.ssh
*   我将 pub 内容附加到服务器中的 /home/admin/.ssh/authorized_keys 文件中
*   然后它真的有助于阅读 sshd 日志：/var/log/secure (YMMV)
*   最后解决了 /home 的三个错误权限：

    chmod 700 /home/.ssh

    chmod 600 /home/.ssh/*

    chmod 755 /home/admin

这就是诀窍。我现在可以不用密码登录了。谢谢你的帮助！

# eclipse - Eclipse Scala-IDE 中的 Casbah Maven 依赖失败？

> ID：15536809
> 
> 赞同：0
> 
> 时间：2013-03-20T23:35:41.033
> 
> 标签：eclipse, scala, maven, casbah

我正在尝试在 Eclipse Scala-IDE Maven 项目中使用 Casbah - MonfoDB 的 Scala 工具包。Maven 在 Casbah 依赖项中失败，并出现以下错误：

```
Missing artifact com.mongodb.casbah:casbah_2.10.0:pom:2.5.0 pom.xml 
```

请帮助解决这个问题。这个神器有什么问题？为什么这个神器不见了？我是否应该添加 Casbah 本身所依赖的依赖项，例如 MongoDB Java 驱动程序？我的 pom.xml：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <groupId>test</groupId>
  <artifactId>scalamongo</artifactId>
  <version>0.0.1-SNAPSHOT</version>
  <name>${project.artifactId}</name>
  <description>My wonderfull scala app</description>
  <inceptionYear>2010</inceptionYear>
  <licenses>
<license>
  <name>My License</name>
  <url>http://....</url>
  <distribution>repo</distribution>
</license>
  </licenses>

  <properties>
<maven.compiler.source>1.6</maven.compiler.source>
<maven.compiler.target>1.6</maven.compiler.target>
<encoding>UTF-8</encoding>
<scala.tools.version>2.10</scala.tools.version>
<scala.version>2.10.0</scala.version>
  </properties>

  <dependencies>
 <dependency>
  <groupId>com.mongodb.casbah</groupId>
  <artifactId>casbah_2.10.0</artifactId>
  <version>2.5.0</version>
  <scope>compile</scope>
  <type>pom</type>
</dependency>
<dependency>
  <groupId>org.scala-lang</groupId>
  <artifactId>scala-library</artifactId>
  <version>${scala.version}</version>
</dependency>

<!-- Test -->
<dependency>
  <groupId>junit</groupId>
  <artifactId>junit</artifactId>
  <version>4.11</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>org.specs2</groupId>
  <artifactId>specs2_${scala.tools.version}</artifactId>
  <version>1.13</version>
  <scope>test</scope>
</dependency>
<dependency>
  <groupId>org.scalatest</groupId>
  <artifactId>scalatest_${scala.tools.version}</artifactId>
  <version>2.0.M6-SNAP8</version>
  <scope>test</scope>
</dependency>
  </dependencies>

  <build>
<sourceDirectory>src/main/scala</sourceDirectory>
<testSourceDirectory>src/test/scala</testSourceDirectory>
<plugins>
  <plugin>
    <!-- see http://davidb.github.com/scala-maven-plugin -->
    <groupId>net.alchim31.maven</groupId>
    <artifactId>scala-maven-plugin</artifactId>
    <version>3.1.3</version>
    <executions>
      <execution>
    <goals>
      <goal>compile</goal>
      <goal>testCompile</goal>
    </goals>
    <configuration>
      <args>
        <arg>-make:transitive</arg>
        <arg>-dependencyfile</arg>
        <arg>${project.build.directory}/.scala_dependencies</arg>
      </args>
    </configuration>
      </execution>
    </executions>
  </plugin>
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.13</version>
    <configuration>
      <useFile>false</useFile>
      <disableXmlReport>true</disableXmlReport>
      <!-- If you have classpath issue like NoDefClassError,... -->
      <!-- useManifestOnlyJar>false</useManifestOnlyJar -->
      <includes>
    <include>**/*Test.*</include>
    <include>**/*Suite.*</include>
      </includes>
    </configuration>
  </plugin>
</plugins>
  </build>
</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:57:08.897

刚刚发现以下依赖项适用于 Casbah：

```
 <dependency>
    <groupId>org.mongodb</groupId>
     <artifactId>casbah-core_2.10</artifactId>
     <version>2.5.0</version>
 </dependency> 
```

# java - 在 Java 中使用 RegEx 获取字符串

> ID：15536812
> 
> 赞同：2
> 
> 时间：2013-03-20T23:35:53.383
> 
> 标签：java, regex, pattern-matching

无论我如何尝试学习 RegEx 并实施它们，我都失败了。

下面：第一个值是输入字符串，冒号后的值是我需要的字符串中的术语。该术语将始终是 ->**输入！（AZ）（数字）**或**计算！(AZ) (数字)**

例如输入！A34 或计算！D93。

输入：需要用一些常量/值替换

*   添加（输入！A34 + 计算！D93）：输入！A34，计算！D93
    *   输入！D343 = 1000：输入！D343
    *   Calc!D71=IF(HasValue(Input!D4), "FormIs(PartofReturn)", IFERROR(1/0)): Calc!D71,Input!D4

    我应该为此使用什么模式？

    我的尝试：

    ```
    模式 findMyPattern = Pattern.compile("(?:Input|" + "Calc!"
                    + ")![a-zA-Z]\\d+");
            匹配器 foundAMatch = findMyPattern.matcher(input);
            HashSet hashSet = new HashSet();
            而（foundAMatch.find（））{
                字符串 s = foundAMatch.group(0);
                hashSet.add(s);
            }

    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:44:49.447

```
Pattern findMyPattern = Pattern.compile("(?:Input|Calc)![A-Z]\\d+"); 
```

# groovy - Groovy/Grails：获取满足正则表达式的键：值对

> ID：15536813
> 
> 赞同：1
> 
> 时间：2013-03-20T23:35:54.903
> 
> 标签：groovy

我有一张地图，想获取所有键匹配正则表达式的键：值对。我有一个解决方案，我首先 grep 查找 keySet()，然后循环查找。但是必须有一个更简单的解决方案（或者我希望）。

前任：

```
def qmap = [name: "hair", style: 'straight', color_1: 'brown', color_2: 'blonde', color_3: 'black'] 
```

我想得到一个只有颜色的子图。

```
def colors = [color_1: 'brown', color_2: 'blonde', color_3: 'black'] 
```

我可以使用 .grep 获取密钥，但这只是给了我密钥，我需要循环获取值。

```
def colorKeys = qmap.keySet().grep(~/^color.*/) 
```

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:55:10.020

你可以做

```
qmap.subMap( colorKeys ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T14:12:32.987

真的很简单。做就是了：

```
qmap.findAll{ k,v -> k.matches(~/^color.*/) } 
```

# ruby-on-rails - 以沙盒模式打开撬动控制台

> ID：15536815
> 
> 赞同：3
> 
> 时间：2013-03-20T23:36:23.477
> 
> 标签：ruby-on-rails, pry

我最近发现了 pry，我发现它是 irb 的绝佳替代品。我想我会用它来代替我的 ROR 开发和调试。我知道要使用 rails 应用程序打开 pry，您只需键入

```
pry -r ./config/environment 
```

我的问题是，有没有办法以沙盒模式打开 pry 控制台，这样我所做的任何修改都不会影响我的数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T01:01:48.163

首先将“pry-rails”gem 添加到 Gemfile

```
gem 'pry-rails', :group => :development 
```

然后`bundle install`

然后以沙盒模式启动 rails 控制台

```
# in development env
$ rails c --sandbox
# or in test env
$ rails c test --sandbox 
```

就这样。Pry 将自动替换 irb。享受！

参考：[https ://github.com/pry/pry/wiki/Setting-up-Rails-or-Heroku-to-use-Pry#](https://github.com/pry/pry/wiki/Setting-up-Rails-or-Heroku-to-use-Pry#)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-28T17:48:21.117

如果您不想修改 Gemfile，可以在打开 pry 后执行此操作：

```
require 'active_record/railties/console_sandbox' 
```

我在我的一个方法中定义了这个，`~/.pryrc`所以它很容易使用。

# installation - 增加允许的文件路径长度

> ID：15536817
> 
> 赞同：0
> 
> 时间：2013-03-20T23:36:26.683
> 
> 标签：installation, nsis

是否可以增加 NSIS 的文件路径/字符串长度？我试图`FILE`用一个相当长的路径使用这个函数，我得到了编译错误：

`File: failed opening file "..\..\..\..\12d\10.00\DPTI_Customisation\\DESIGN_12d10\DPTI_Design_User\DPTI_D_Toolbars\DPTI_D_Create_D_Boundaries_for_Tin.slx"`

是否可以像增加 $NSIS_MAX_STRLEN 可变长度一样增加允许长度？

该[线程](http://forums.winamp.com/showthread.php?t=320618)说该错误是由文件路径太长引起的。

**编辑**
继承人的代码：

```
FILE /r "..\..\..\..\12d\10.00\DPTI_Customisation\"
# The folder DPTI_Customisation contains many sub folders and files 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:10:08.987

您可以尝试使用 NSIS 的 unicode 版本。

或者，我想知道您是否可以使用多次调用`cd`来减少路径长度。

参考： http: [//nsis.sourceforge.net/Docs/Chapter5.html#5.1.5](http://nsis.sourceforge.net/Docs/Chapter5.html#5.1.5)

# debugging - Azure Web 角色 - 在 Visual Studio 中运行调试器时，多个网站不编译

> ID：15536819
> 
> 赞同：0
> 
> 时间：2013-03-20T23:36:30.590
> 
> 标签：debugging, azure, visual-studio-2012, azure-web-roles

我有一个 Azure 云服务项目，该项目具有与多个网站相关联的 Web 角色。

当我单击“运行”按钮时，它无法为 web 角色中的所有网站加载调试符号。为了调试其他网站，我必须在运行调试器之前显式构建有问题的 Web 项目。

如何配置 Azure 云服务项目以在单个 Web 角色中编译所有关联的 Web？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:36:30.590

截至本文发布时，Visual Studio 2012 对单个 Web 角色内的多个网站的支持相当差（[Exibit A](https://stackoverflow.com/questions/14569839/error-the-stream-data-of-file-is-not-yet-available-publishing-web-role-azure)、[Exibit B](http://michaelcollier.wordpress.com/2013/01/14/multiple-sites-in-a-web-role/)）。

当您单击解决方案中的“运行”按钮时，并不意味着所有项目都将被编译。只有那些与当前正在运行的项目直接相关的才会被编译（并更新调试符号）。

考虑以下解决方法：

1.  确定解决方案中的主要 Web 角色 Web 项目（它应该与 Azure 云服务项目中的 Web 角色名称匹配）。
2.  右键单击 web 项目
3.  转到“添加参考”
4.  转到“解决方案”->“项目”
5.  选中每个 Web 角色的关联网站旁边的复选框。
6.  点击确定

通过添加对其他 Web 项目的引用，它会导致编译器在使用调试器运行 Azure 云服务项目时编译其他 Web。

这将允许您再次非常放弃地点击“运行”按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:50:30.780

[我已经在我的博客http://michaelcollier.wordpress.com/2013/01/14/multiple-sites-in-a-web-role/](http://michaelcollier.wordpress.com/2013/01/14/multiple-sites-in-a-web-role/)上发布了一些关于在一个网络角色中使用多个网站的详细信息。

至于调试器，您是否使用不同站点的主机头？如果是这样，请尝试改用不同的端口。出于调试目的，我走这条路的运气更好。然后在准备好部署时切换回主机头。

# java - 单击时将唯一的 JButton 数据传递给另一个类

> ID：15536826
> 
> 赞同：1
> 
> 时间：2013-03-20T23:37:08.443
> 
> 标签：java, swing, jbutton, actionlistener

我正在制作一个程序，单击自定义 JButton 可让您在下一次单击时在屏幕上的某个点绘制图像。此 JButton 类的成员具有特定于每个单独按钮的特定数据。**我的问题**是我是否可以在通过方法单击时将 JButton 对象传递到一个类中，然后该类将提取数据。我在想这样的事情：

```
Click Method in JButton{
    OutsideClass.setObject(this); //problem
}

OutsideClass{
    Object obj = new Object();
    public void setObject(Object Obj){
        obj = Obj;
    }

Click Method in OutsideClass{
        place obj;
        obj.getData;//Methods within JButton that retrieve specific data
} 
```

我的问题是 JButton 的“setObject”部分。它不会将“this”识别为单击的特定对象，因此不起作用。有没有其他方法可以达到预期的效果？谢谢！

# sql-server-2008 - 多态数据库设计：这种方法有名字吗？

> ID：15536827
> 
> 赞同：2
> 
> 时间：2013-03-20T23:37:12.687
> 
> 标签：sql-server-2008, database-design

我有一个基础实体（项目），它将承载具有完全不同属性的大量项目类型（> 200）。我想要一个干净的便携式和快速的解决方案，并且想出了一个想法，maby 有一个我不知道的名字。

它是这样的：

*   items-entity 包含基类字段 + 子类字段的附加字段，但具有虚拟名称、ItemID、ItemNo、ItemTypeID、int1、int2、dec1、dec2、dec3、str1、str2

*   引用的 itemtype-record 包含类型名称和子实体 (1:n)：

*   itemtypefields [itemtypeid,name,type,realfield] [53,MaxPressure,dec,dec3] 中的示例

它的局限性：

*   难以估计基类中的现场要求
*   更难根据子类型添加域/检查约束
*   需要应用层将标记的 sql 转换为真正的查询
*   一次只能查询一种类型，因为共享属性可能被定义为不同的“真实字段”。

第三条解释：

```
select ItemNo,_MaxPressure_ from items where ItemTypeID=10 and _MaxPressure_>42
should translate to:
select ItemNo,dec3 as MaxPressure from items where ItemType=10 and dec3>42 
```

（不能用 sp 或 udf 的权利来做到这一点 - 或者有可能吗？）

但好处：

*   表现
*   易于 CRUD 操作
*   更容易在应用程序级别进行排序/过滤。

现在 - 它有名字吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T00:07:43.303

这种反模式称为[One True Lookup Table](https://www.simple-talk.com/sql/t-sql-programming/look-up-tables-in-sql-/)。

在关系数据库中，每一列都需要定义为一种逻辑类型。我不是指像 INT 或 VARCHAR 这样的 SQL 数据类型，我的意思是该列中从头到尾的所有内容都必须来自同一组值，并且您应该能够将一个值与另一个值区分开来。

您不能将鞋码、平均温度和每英寸螺纹数放在给定表格的同一列中，仍然称其为关系。

基本上，您的数据库根本就不是数据库——而是*电子表格*。

阅读 CJ Date 的几乎所有书籍，例如[SQL 和 Relational Theory](http://shop.oreilly.com/product/0636920022879.do)，以获得对关系和类型的正确解释。

* * *

回复您的评论：

> 在讲基本书籍和嘲笑半结构化数据之前，请再次阅读 Q。

好的，我重新看了你的帖子。

One True Lookup Table 的经典用法并不*完全*是您正在做的事情，但您正在做的事情与 OTLT 存在相同的问题。

假设您在 ItemType 10 的列中存储了“MaxPressure” `dec3`。假设 MaxPressure 的值有一组固定的有效选择，并且您希望将它们放在另一个查找表中，这样就没有人可以输入无效的 MaxPressure 值。

现在：在 dec3 上声明一个外键约束，引用您的 MaxPressures 查找表。*你不能*——问题是外键约束适用于*所有*行中的 dec3 列，而不仅仅是那些 ItemType 为 10 的行。

原因是您在单个列中存储了多个值。任何其他类型的约束都会出现同样的问题——唯一约束、检查约束，甚至 NOT NULL。而且您也不能为该列声明 DEFAULT 值，因为您可能对每个 ItemType 有不同的正确默认值（并且某些 ItemTypes 没有该属性的默认值）。

我提到 CJ Date book 的原因是他对*类型*给出了清晰的定义：它是一个命名的有限集，在其上定义了相等操作。也就是说，您可以判断一行上的值“42”是否与另一行上的值“42”相同。在关系列中，这必须是正确的，因为它们必须来自相同的原始值集。在您的表中，`dec3`当它是 MaxPressure 时可能具有值“42”，而当它是每英寸线程数时，另一个 ItemType 可能具有值“42”。因此它们不是*相同*的值“42”。如果您有唯一约束，则这两个 42 不会被视为重复。如果你有一个外键，每个不同的 42 都会引用一个不同的查找表，等等。

*您所做的不是有效的关系数据库设计。*

除非您明白这一点，否则不要因为我向您推荐关系数据库设计资源而生气。

# spring - 当通过使用飞碟（Itext）ReplacedElementFactory 实现的过滤器调用时，Spring @Secured 方法不起作用

> ID：15536829
> 
> 赞同：0
> 
> 时间：2013-03-20T23:37:26.703
> 
> 标签：spring, security, authentication, filter, itext

当我通过普通的 @Controller 类调用在 @Service 类上找到的 Spring @Secured 方法时，身份验证工作正常。

当我通过 IText PDF 过滤器调用相同的方法时，使用 org.xhtmlrenderer.extend.ReplacedElementFactory 实现，我得到以下堆栈跟踪：

```
org.springframework.security.authentication.AuthenticationCredentialsNotFoundException: An Authentication object was not found in the SecurityContext
    at org.springframework.security.access.intercept.AbstractSecurityInterceptor.credentialsNotFound(AbstractSecurityInterceptor.java:325)
    at org.springframework.security.access.intercept.AbstractSecurityInterceptor.beforeInvocation(AbstractSecurityInterceptor.java:196)
    at org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:64)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.Cglib2AopProxy$DynamicAdvisedInterceptor.intercept(Cglib2AopProxy.java:622) 
```

安全性显然是有效的，因为没有所需角色的用户会收到拒绝访问异常，而具有正确角色的其他用户则完全没有问题。

这是我的 web.xml 中的一个片段：

```
<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<listener>
    <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
</listener>
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter>
    <filter-name>pdfFilter</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>pdfFilter</filter-name>
    <url-pattern>/reports/pdf/*</url-pattern>
    <dispatcher>REQUEST</dispatcher>
</filter-mapping>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

这是 ReplacedElementFactory 实现的片段：

```
@Inject private ImageService imageService;

    @Override
    public ReplacedElement createReplacedElement(LayoutContext ctx, BlockBox box, UserAgentCallback uac, int width, int height) {

        Element el = box.getElement();
        if (el == null) {
            return null; 
        }

        String nodeName =  el.getNodeName();
        if (nodeName.equalsIgnoreCase("img")) {
            String srcAttr = el.getAttribute("src");
            FSImage fsImage;
            try {
                fsImage = getImage(srcAttr, uac);
            }catch(BadElementException ex) {
                fsImage = null;
            }catch(IOException ex) {
                fsImage = null;
            }catch(NullPointerException ex) {
                fsImage = null;
            }

            if (fsImage != null) {
                if (width != -1 || height != -1) {
                    fsImage.scale(width, height);
                }

                return new ITextImageElement(fsImage);
            }
        }

        return null;
    }

private FSImage getImage(String src, UserAgentCallback uac) throws IOException, BadElementException, NullPointerException {
        FSImage fsImage;

        String[] split = src.split("/");
        if (src.contains("image/person/")) {                
            Long id = Long.valueOf( split[split.length - 1] );
            Image img = imageService.getPersonImageByImageId(id);           
            fsImage = new ITextFSImage(com.lowagie.text.Image.getInstance(img.getImage()));

        return fsImage;
    } 
```

这是我的 ImageService 类方法：

```
@Secured({"ROLE_MY_ROLE_READ"})
    public Image getPersonImageByImageId(Long imageId) {
        return imageDao.findOne(imageId);
    } 
```

失败发生在对图像服务方法的调用上，可能是因为它是 Secured 并且 ReplacedElementFactory 实现无权访问安全上下文，但是我如何进行身份验证？

我是新来发帖的，所以如果还有什么需要请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T04:56:55.480

不知道你是如何配置你的安全性来启动的。但如果你已经使用了，那么检查过滤器的顺序。安全过滤器应该在您的 pdffilter 之前。

# c# - LINQ - FirstOrDefault() 然后 Select()

> ID：15536830
> 
> 赞同：38
> 
> 时间：2013-03-20T23:37:29.747
> 
> 标签：c#, linq

我有以下 LINQ 查询，当`FirstOrDefault()`返回 null 时会触发和异常。理想情况下，我想避免空检查。有没有办法做到这一点？`0`如果没有`CPOffsets`满足电话的要求，我希望返回`FirstOrDefault()`。

```
double offset = OrderedOffsets.FirstOrDefault(o => o.OffsetDateTime > cpTime).CPOffset; 
```

我能看到实现这一目标的唯一方法如下：

```
CPOffset cpOffset = OrderedOffsets.FirstOrDefault(o => o.OffsetDateTime > cpTime);
double offset = cpOffset != null ? cpOffset.CPOffset : 0; 
```

还有更简洁的方法吗？在不编译`Select()`后使用，但我认为在这里可能合适？`FirstorDefault()`

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-03-20T23:49:43.360

我认为这应该可行，我不在 VS 附近进行检查...

```
OrderedOffsets.Where(o => o.OffsetDateTime > cpTime).Select(x => x.CPOffset).FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-20T23:50:27.403

`DefaultIfEmpty`可用于确保集合始终具有至少一个元素。

```
double offset = OrderedOffsets.Where(o => o.OffsetDateTime > cpTime)
    .Select(o => o.CPOffset)
    .DefaultIfEmpty()
    .First(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-21T00:38:29.530

我认为一个好的模式可能是：

```
double offset = (OrderedOffsets.FirstOrDefault(o => o.OffsetDateTime > cpTime) ?? someDefaultObject).CPOffset; 
```

带有`someDefaultObject`一个保存默认值的对象...使用此模式，您可以通过代码轻松更改默认值！

如果 OrderedOffsets 可以是一个结构，你也可以把你的默认值放在那里！:)

# jenkins - 更改图例标签

> ID：15536831
> 
> 赞同：1
> 
> 时间：2013-03-20T23:37:38.733
> 
> 标签：jenkins

我想改变一个情节的“数据系列图例标签”，比如从“foo”到“bar”。有什么方法可以将先前记录的“foo”值也更改为“bar”的值？

目前，如果我进行更改，我将获得旧版本的“foo”值和新版本的“bar”值。

我假设我可以手动编辑存储这些值的 csv 文件，但在我现在使用的设置中我没有对这些文件的写访问权限。即使我这样做了，我也不想手动编辑 csv 文件，因为这感觉像是一种常见的要求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:45:38.260

我知道的唯一方法是编辑存储绘图值的文件。这将位于运行 Jenkins 主机的机器上的 $JENKINS_HOME/jobs/jobname 中，并且将是一个带有数字名称的 .csv 文件，例如 280055090.csv

# language-agnostic - 为什么一元加号没有绝对值的含义？

> ID：15536832
> 
> 赞同：0
> 
> 时间：2013-03-20T23:37:42.513
> 
> 标签：language-agnostic, unary-operator

在整个过程中，我看到了很多关于为什么一元加号存在于特定语言中的问题，例如：
[为什么 F# 有一个一元加号运算符？](https://stackoverflow.com/questions/7998416/why-does-f-have-a-unary-plus-operator)
[Java的一元加号运算符的目的是什么？](https://stackoverflow.com/questions/2624410/what-is-the-purpose-of-javas-unary-plus-operator)
[Ruby 中的一元加运算符有什么意义？](https://stackoverflow.com/questions/5680587/whats-the-point-of-unary-plus-operator-in-ruby)
[一元加号运算符的使用](https://stackoverflow.com/questions/5117563/use-of-unary-plus-operator)

他们都说“+”仅用于在需要时进行重载，
或者用于执行一些罕见/不必要的特定于语言的任务。
但是为什么没有任何实际用途呢？

一元“+”应该充当绝对值（至少对我而言）是有道理的，例如：

```
int x = -5; //x is -5
x = +x;     //x is now 5 
```

是否有任何具体原因没有这样做？
还是因为这只对我有意义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T02:05:38.823

它不是那样实现的，因为数学不是那样工作的。

在数学中：

```
note: the following is math on a blackboard, not a programming language

+ -5 = -5

- -5 = 5 
```

以任何其他方式做这件事会让任何高中毕业的人感到困惑。

显然，以上是相当弱的答案，因为您确实可以在代码中实现 ASCII 字符“+”所采取的操作，以不同于数学。例如，在 Lisp 中，`+`运算符不像普通的高中数学那样工作：

```
;;; Adding two numbers:
+ 1 2 
```

而在 TI 计算器上，它甚至是相反的：

```
1 2 + 
```

您可能会争辩说，实现`+`您在编程语言中描述的方式是有意义的。关于为什么不应该这样做有许多不同的论据，包括最小意外原则、语言应该模拟问题域、这是我们在学校所教的等等。所有这些本质上都是弱论据，因为它们没有不能为机器以`+`与数学相同的方式处理提供根本原因。

但事情是这样的，人类是情感动物。我们喜欢熟悉的东西，对与我们所学的东西背道而驰的东西感到畏缩。程序员不喜欢因`+`行为与正常不同而感到惊讶。程序员是创建编程语言的人，所以他们以他们的方式实现是有道理`+`的。

一个程序员可能不会这样想，或者一小群人可能不会这样想，他们可以自由地创建一种以`+`不同方式实现的编程语言。但是他们很难让整个编程社区相信他们所做的事情是正确的。

因此，所有可以反对`+`采取行动的论据`abs()`本质上都很弱，这并不重要。只要大多数人认为它是正确的，它的`+`行为就会与常规数学相同。

# java - 将二维数组格式化为文本文件

> ID：15536833
> 
> 赞同：0
> 
> 时间：2013-03-20T23:37:48.000
> 
> 标签：java, multidimensional-array, formatting, text-files

我有一个二维数组，我想将它导出到一个文本文件中。我的格式有问题。例如，我希望有这种格式：

```
 11 22 33 44
  22 33 44 33 
```

但是这段代码会产生这种格式：[[11 22 33 44][22 33 44 33]]。我更喜欢 \tab 作为每两个数字之间的距离。提前致谢。

```
PrintWriter pr = new PrintWriter("file");

for (int i=0; i<X.length ; i++){
pr.println(Arrays.deepToString(X));
}
pr.close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:28:28.400

我建议使用一段代码来填充空格以便正确格式化它，让我们调用方法 printWithFormat(String s)。使用 deepToString 也非常不方便，如果您查看规范，它会为您提供数组的完整表示，以及它如何为您将其打印到文件中。我现在假设 X 是一个二维数组。

如果没有空格格式，代码可能看起来像这样，请注意，虽然这会给你一个

```
11 22 33 44
33 44 55 55 
```

不同长度的数字看起来会出错，例如

```
11 222 33 4
3 44 55 5 
```

因此为什么需要根据需要用空格填充它

无论如何，非空白代码：

```
for (int i=0; i<X.length ; i++){
  for(int j=0; j<X[0].length; j++){
    pr.print(X[i,j]);
    if(j<X[0]-1) pr.print(" "); //separate the numbers by spaces, no need to put a space at teh end
  }
  pr.println(""); //go to the next line
} 
```

如果您无法使空白格式正常工作，我相信它已经完成了无数次，您将能够在网上找到它。

# jquery - 传递对使用 jquery 的 javascript 函数的引用

> ID：15536842
> 
> 赞同：-1
> 
> 时间：2013-03-20T23:38:29.220
> 
> 标签：jquery

我有一些链接，当点击时，会显示一些 div，而另一些则不显示。

```
function slideup(whichdiv)
{
    $("#div1").hide();
    $("#div2").slideDown(2000);
    $(whichdiv)slideDown(2000);
} 
```

如果缺少第 3 行，上面的函数可以工作......你如何将对 div 的引用传递给 jquery 函数？你如何知道哪个 div 是“whichdiv”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:40:15.480

你可以这样做：

```
function slideup(whichdiv)
{
    $("#div1").hide();
    $("#div2").slideDown(2000);
    whichdiv.slideDown(2000);
} 
```

并这样称呼它：

```
slideup($('#someDiv')) 
```

如果您想以当前方式执行此操作，则必须`.`在第三个中添加缺少的内容：

```
$(whichdiv)slideDown(2000); //where is the . 
```

# django - GeoDJango：从 LayerMapping 检索最后插入的主键

> ID：15536845
> 
> 赞同：0
> 
> 时间：2013-03-20T23:38:56.597
> 
> 标签：django, geodjango, gpx

我正在使用 GeoDjango 构建应用程序，但遇到以下问题：

我需要从 GPX 文件中读取轨道数据，这些数据应该存储在模型 MultiLineStringField 字段中。这应该发生在用户上传 GPX 文件的管理界面中

我试图实现这一点，即从文件中抓取的数据应该分配给 MultiLineStringField，而其他字段应该从表单中获取值。

我的模型是：

```
class GPXTrack(models.Model):
    nome = models.CharField("Nome", blank = False, max_length = 255)
    slug = models.SlugField("Slug", blank = True)
    # sport natura arte/cultura
    tipo = models.CharField("Tipologia", blank = False, max_length = 2, choices=TIPOLOGIA_CHOICES)
    descrizione = models.TextField("Descrizione", blank = True)

    gpx_file = models.FileField(upload_to = 'uploads/gpx/')
    track = models.MultiLineStringField(blank = True)
    objects = models.GeoManager()
    published = models.BooleanField("Pubblicato")
    rel_files = generic.GenericRelation(MyFiles)
     #publish_on = models.DateTimeField("Pubblicare il", auto_now_add = True)

    created = models.DateTimeField("Created", auto_now_add = True)
    updated = models.DateTimeField("Updated", auto_now = True)

    class Meta:
       #verbose_name = "struttura'"
       #verbose_name_plural = "strutture"
       ordering = ['-created']

    def __str__(self):
        return str(self.nome)

    def __unicode__(self):
        return '%s' % (self.nome)

    def put(self):
      self.slug = sluggy(self.nome)

      key = super(Foresta, self).put()
      # do something after save
      return key 
```

在 admin.py 文件中，我已经覆盖了 save 方法，如下所示：

```
 from django.contrib.gis import admin
from trails.models import GPXPoint, GPXTrack
from django.contrib.contenttypes import generic
from django.contrib.gis.gdal import DataSource
#from gpx_mapping import GPXMapping
from django.contrib.gis.utils import LayerMapping
from django.template import RequestContext
import tempfile
import os
import pprint

class GPXTrackAdmin(admin.OSMGeoAdmin):
    list_filter = ( 'tipo', 'published')
    search_fields = ['nome']
    list_display = ('nome', 'tipo', 'published', 'gpx_file')
    inlines = [TrackImagesInline, TrackFilesInline]
    prepopulated_fields = {"slug": ("nome",)}

    def save_model(self, request, obj, form, change):
        """When creating a new object, set the creator field.
        """
        if 'gpx_file' in request.FILES:
            # Get
            gpxFile = request.FILES['gpx_file']
            # Save
            targetPath = tempfile.mkstemp()[1]
            destination = open(targetPath, 'wt')
            for chunk in gpxFile.chunks():
                destination.write(chunk)
            destination.close()

            #define fields of interest for LayerMapping
            track_point_mapping = {'timestamp' : 'time',
                                   'point' : 'POINT',
                          }

            track_mapping = {'track' : 'MULTILINESTRING'}

            gpx_file = DataSource(targetPath)
            mytrack = LayerMapping(GPXTrack, gpx_file, track_mapping, layer='tracks')
            mytrack.save()

            #remove the temp file saved
            os.remove(targetPath)
            orig = GPXTrack.objects.get(pk=mytrack.pk)
            #assign the parsed values from LayerMapping to the appropriate Field
            obj.track = orig.track
            obj.save() 
```

我所知道的：

1.  LayerMapping 不能用于更新字段，只能用于保存新字段
2.  我无法访问 LayerMapping 对象的特定字段（即在上面的代码中：**mytrack.track**）并将其值分配给 model_save 方法中的模型字段（即**obj.track**）
3.  我无法检索上次保存的 LayerMapping 对象的主键（即在上面的代码中：**mytrack.pk**），以便使用在表单中传递的值更新它，该字段未在 LayerMapping.mapping 中映射

那我该怎么办？！？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T09:59:43.010

我对它进行了整理，继承了 LayerMapping 并添加了一个 get_values() 方法，该方法不是保存检索到的数据，而是返回它们以供任何使用或操作。get_values 方法是[LayerMapping::save()](https://github.com/django/django/blob/master/django/contrib/gis/utils/layermapping.py#L451)方法的副本，它返回值而不是拯救他们。我正在使用 django 1.5

```
import os
from django.contrib.gis.utils import LayerMapping
import sys
class MyMapping(LayerMapping):
    def get_values(self, verbose=False, fid_range=False, step=False,
         progress=False, silent=False, stream=sys.stdout, strict=False):
        """
        Returns the contents from the OGR DataSource Layer 
        according to the mapping dictionary given at initialization.

        Keyword Parameters:
         verbose:
           If set, information will be printed subsequent to each model save
           executed on the database.

         fid_range:
           May be set with a slice or tuple of (begin, end) feature ID's to map
           from the data source.  In other words, this keyword enables the user
           to selectively import a subset range of features in the geographic
           data source.

         step:
           If set with an integer, transactions will occur at every step
           interval. For example, if step=1000, a commit would occur after
           the 1,000th feature, the 2,000th feature etc.

         progress:
           When this keyword is set, status information will be printed giving
           the number of features processed and sucessfully saved.  By default,
           progress information will pe printed every 1000 features processed,
           however, this default may be overridden by setting this keyword with an
           integer for the desired interval.

         stream:
           Status information will be written to this file handle.  Defaults to
           using `sys.stdout`, but any object with a `write` method is supported.

         silent:
           By default, non-fatal error notifications are printed to stdout, but
           this keyword may be set to disable these notifications.

         strict:
           Execution of the model mapping will cease upon the first error
           encountered.  The default behavior is to attempt to continue.
        """     
            # Getting the default Feature ID range.
        default_range = self.check_fid_range(fid_range)

        # Setting the progress interval, if requested.
        if progress:
            if progress is True or not isinstance(progress, int):
                progress_interval = 1000
            else:
                progress_interval = progress

        # Defining the 'real' save method, utilizing the transaction
        # decorator created during initialization.
        @self.transaction_decorator
        def _get_values(feat_range=default_range, num_feat=0, num_saved=0):
            if feat_range:
                layer_iter = self.layer[feat_range]
            else:
                layer_iter = self.layer

            for feat in layer_iter:
                num_feat += 1
                # Getting the keyword arguments
                try:
                    kwargs = self.feature_kwargs(feat)
                except LayerMapError, msg:
                    # Something borked the validation
                    if strict: raise
                    elif not silent:
                        stream.write('Ignoring Feature ID %s because: %s\n' % (feat.fid, msg))
                else:
                    # Constructing the model using the keyword args
                    is_update = False
                    if self.unique:
                        # If we want unique models on a particular field, handle the
                        # geometry appropriately.
                        try:
                            # Getting the keyword arguments and retrieving
                            # the unique model.
                            u_kwargs = self.unique_kwargs(kwargs)
                            m = self.model.objects.using(self.using).get(**u_kwargs)
                            is_update = True

                            # Getting the geometry (in OGR form), creating
                            # one from the kwargs WKT, adding in additional
                            # geometries, and update the attribute with the
                            # just-updated geometry WKT.
                            geom = getattr(m, self.geom_field).ogr
                            new = OGRGeometry(kwargs[self.geom_field])
                            for g in new: geom.add(g)
                            setattr(m, self.geom_field, geom.wkt)
                        except ObjectDoesNotExist:
                            # No unique model exists yet, create.
                            m = self.model(**kwargs)
                    else:
                        m = self.model(**kwargs)

                    try:
                        # Attempting to save.
                        pippo = kwargs

                        num_saved += 1
                        if verbose: stream.write('%s: %s\n' % (is_update and 'Updated' or 'Saved', m))
                    except SystemExit:
                        raise
                    except Exception, msg:
                        if self.transaction_mode == 'autocommit':
                            # Rolling back the transaction so that other model saves
                            # will work.
                            transaction.rollback_unless_managed()
                        if strict:
                            # Bailing out if the `strict` keyword is set.
                            if not silent:
                                stream.write('Failed to save the feature (id: %s) into the model with the keyword arguments:\n' % feat.fid)
                                stream.write('%s\n' % kwargs)
                            raise
                        elif not silent:
                            stream.write('Failed to save %s:\n %s\nContinuing\n' % (kwargs, msg))

                # Printing progress information, if requested.
                if progress and num_feat % progress_interval == 0:
                    stream.write('Processed %d features, saved %d ...\n' % (num_feat, num_saved))

            # Only used for status output purposes -- incremental saving uses the
            # values returned here.
            return pippo

        nfeat = self.layer.num_feat
        if step and isinstance(step, int) and step < nfeat:
            # Incremental saving is requested at the given interval (step)
            if default_range:
                raise LayerMapError('The `step` keyword may not be used in conjunction with the `fid_range` keyword.')
            beg, num_feat, num_saved = (0, 0, 0)
            indices = range(step, nfeat, step)
            n_i = len(indices)

            for i, end in enumerate(indices):
                # Constructing the slice to use for this step; the last slice is
                # special (e.g, [100:] instead of [90:100]).
                if i + 1 == n_i: step_slice = slice(beg, None)
                else: step_slice = slice(beg, end)

                try:
                    pippo = _get_values(step_slice, num_feat, num_saved)
                    beg = end
                except:
                    stream.write('%s\nFailed to save slice: %s\n' % ('=-' * 20, step_slice))
                    raise
        else:
            # Otherwise, just calling the previously defined _save() function.
            return _get_values() 
```

在自定义 save 或 save_model 方法中，您可以使用：

```
 track_mapping = {'nome': 'name',
                         'track' : 'MULTILINESTRING'}

        targetPath = "/my/gpx/file/path.gpx"
        gpx_file = DataSource(targetPath)

        mytrack = MyMapping(GPXTrack, gpx_file, track_mapping, layer='tracks')

        pippo = mytrack.get_values()
        obj.track = pippo['track'] 
```

# javascript - Javascript：巴恩斯利蕨分形

> ID：15536849
> 
> 赞同：1
> 
> 时间：2013-03-20T23:39:38.960
> 
> 标签：javascript, math, canvas, fractals

有人可以查看这段代码并指出为什么生成的巴恩斯利蕨分形看起来不正确吗？

```
function barnsley (ctx) {

ctx.fillStyle = 'green';
ctx.translate(ctx.canvas.width/2,ctx.canvas.height/2);
var self = this;

this.itts = 100000;
this.ittsCount = 0;
this.x = 0;
this.y = 0;

this.main = function () {
    for (var i=0;i<itts;i++) {
        var rand = Math.random()*100;
        if (rand < 1) {
            self.one();
        } else if (rand < 86) {
            self.two();
        } else if (rand < 94) {
            self.three();
        } else {
            self.four();
        }
    }
}

this.one = function () {
    var xn = self.x;
    var yn = self.y;
    var zx = 0;
    var zy = 0.16 * yn;
    self.drawPoint(zx,zy);
}

this.two = function () {
    var xn = self.x;
    var yn = self.y;
    var zx = 0.85 * xn + 0.4 * yn;
    var zy = -0.04 * xn + 0.85 * yn + 1.6;
    self.drawPoint(zx,zy);
}

this.three = function () {
    var xn = self.x;
    var yn = self.y;
    var zx = 0.2 * xn - 0.26 * yn;
    var zy = 0.23 * xn + 0.22 * yn + 1.6;
    self.drawPoint(zx,zy);
}

this.four = function () {
    var xn = self.x;
    var yn = self.y;
    var zx = -0.15 * xn + 0.28 * yn;
    var zy = 0.26 * xn + 0.24 * yn + 0.44;
    self.drawPoint(zx,zy);
}

this.drawPoint = function (xn,yn) {
    self.x = xn;
    self.y = yn;
    ctx.fillRect(xn*20,-yn*20,1,1);
}

this.main();
} 
```

它具有正确的一般形状，但我必须遗漏一些东西，我已经检查了算法等但无济于事。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T23:59:26.380

输入数字时出现了一个小错误。（我检查了[这个来源](http://en.wikipedia.org/wiki/Barnsley_fern#Computer_generation)，看起来它使用的数字与您使用的数字相同）。

在此`this.two`功能中，您需要更改

```
var zx = 0.85 * xn + 0.4 * yn; 
```

至

```
var zx = 0.85 * xn + 0.04 * yn; 
```

你可以[在 jsFiddle 上看到这个修复](http://jsfiddle.net/hnTfj/3/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-11T00:30:33.000

有数百万种方法可以做到，但我想你可能会喜欢[这个](http://jsfiddle.net/p49HD/1/)。

更新/步骤由 JS 调度程序/计时器处理。它是非阻塞的，不会让你的 CPU 因繁重的 for 循环而发疯。

分形数据也以不同的方式处理。您可以通过在一个位置更改参数来放置使用仿射变换制作的任何分形。你也不必像它为你做的那样对概率求和。

例如：（StackOverflow 不允许我在没有代码示例的情况下发布 JSFiddle 链接）

```
var probability_transforms =  [
    {
        "probability": 0.01, 
        "item": function(point){ return affine_transform(point, 0, 0, 0, 0.16, 0, 0) }
    },
    {
        "probability": 0.85, 
        "item": function(point){ return affine_transform(point, 0.85, 0.04, -0.04, 0.85, 0, 1.6) }
    },
    {
        "probability": 0.07,
        "item": function(point){ return affine_transform(point, 0.2, -0.26, 0.23, 0.22, 0, 1.6) }
    },
    {
        "probability": 0.07, 
        "item": function(point){ return affine_transform(point, -0.15, 0.28, 0.26, 0.24, 0, 0.44) }
    }
]; 
```

玩得开心 ：）

# objective-c - 使用 UIDatePicker 避免“过去”日期

> ID：15536868
> 
> 赞同：0
> 
> 时间：2013-03-20T23:41:22.307
> 
> 标签：objective-c, uidatepicker

我有一个关于 UIDatePicker 的问题。是否可以避免选择过去的日期？我的意思是，只选择从今天到接下来的日子，避免选择“过去”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:45:17.810

采用：

```
[datePicker setMinimumDate:[NSDate date]]; 
```

这只会将最小日期设置为当前日期（由 返回`[NSDate date]`）。

# windows - Windows上缺少nodejs npm全局配置

> ID：15536872
> 
> 赞同：61
> 
> 时间：2013-03-20T23:41:39.230
> 
> 标签：windows, node.js, npm

我根本找不到 npm 存储其全局设置的位置。

npm 配置获取用户配置

```
C:\Users\Jack\.npmrc 
```

npm 配置获取全局配置

```
C:\Users\Jack\AppData\Roaming\npm\etc\npmrc 
```

这些路径中的任何一个都没有文件，但是

npm config get proxy -> 返回我工作的代理 url。我想删除。

npm config -g 删除代理

```
npm ERR! Error: ENOENT, unlink 'C:\Users\Jack\AppData\Roaming\npm\etc\npmrc'

npm ERR! System Windows_NT 6.2.9200
npm ERR! command "C:\\Program Files\\nodejs\\\\node.exe" "C:\\Program Files\\nodejs\\node_modules\\npm\\bin\\npm-cli.js" "config" "-g" "delete" "proxy"
npm ERR! cwd C:\f\Dropbox\apps
npm ERR! node -v v0.8.22
npm ERR! npm -v 1.2.14
npm ERR! path C:\Users\Jack\AppData\Roaming\npm\etc\npmrc
npm ERR! code ENOENT
npm ERR! errno 34
npm ERR!
npm ERR! Additional logging details can be found in:
npm ERR!     C:\f\Dropbox\apps\npm-debug.log
npm ERR! not ok code 0 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-11-21T01:24:00.063

Windows下升级npm有问题。使用 msi 包作为 nodejs 安装的一部分完成的初始安装将创建一个 npmrc 文件：

`C:\Program Files\nodejs\node_modules\npm\npmrc`

当您使用以下命令更新 npm 时：

`npm install -g npm@latest`

它将在以下位置安装新版本：

`C:\Users\Jack\AppData\Roaming\npm`

假设你的名字是 Jack，即 %APPDATA%\npm。

新安装不包含 npmrc 文件，没有它，全局根目录将基于节点的运行位置，因此它是`C:\Program Files\nodejs\node_modules`

您可以通过运行检查这一点：

`npm root -g`

这将不起作用，因为 npm 没有写入`"Program Files"`目录的权限。您需要将 npmrc 文件从原始安装复制到新安装中。默认情况下，该文件只有以下行：

`prefix=${APPDATA}\npm`

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2017-04-07T10:14:09.133

对我来说（在 Windows 10 上），[npmrc 文件](https://docs.npmjs.com/files/npmrc)位于：

```
%USERPROFILE%\.npmrc 
```

经测试：

*   npm v4.2.0
*   Node.js v7.8.0

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-04-03T19:29:03.710

看起来`npm`用于编辑其配置文件的文件不是在全新安装时创建的，因为`npm`每个文件都有一个默认选项。这就是为什么您仍然可以获得选项的原因`npm config get <option>`：让这些文件只覆盖默认值，它不会从头开始创建选项。

今天之前我从来没有碰过我的`npm config`东西，尽管我已经有几个月了。还没有任何文件，例如`~/.npmrc`（在带有 的 Windows 8.1 机器上`Git Bash`），但我可以运行`npm config get <something>`，如果它是正确的`npm`选项，它会返回一个值。当我运行`npm config set <option> <value>`时，文件`~/.npmrc`似乎是自动创建的，选项及其值是唯一未注释掉的行。

至于删除选项，看起来这只是将值设置回默认值，或者如果该选项从未设置或未设置且从未重置，则不执行任何操作。此外，如果该选项是唯一明确设置的选项，它看起来也`~/.npmrc`被删除了，如果你`set`以后有任何其他事情，它就会重新创建。

在您的情况下（假设它在一年后仍然相同），看起来您从未`proxy`在`npm`. 因此，正如帮助页面所说，它被设置为您的`npm`（不区分大小写）环境变量。这意味着没有什么，除非您想“删除”您的 HTTP 代理，尽管您可以将选项或环境变量设置为其他内容，并希望它们不会以某种方式破坏您的设置。`config``http_proxy``delete``set`

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2018-12-10T14:28:43.580

## 如何弄清楚

首先`npm root`——它将显示当前用户的 NPM 包的根文件夹。添加`-g`，您将获得一个全局文件夹。不要忘记减法`node_modules`。

使用`npm config`/`npm config -g`并检查它是否会为您创建一个新的`.npmrc`/`npmrc`文件。

在 Windows 10 Pro、NPM v.6.4.1 上测试：

### 全局 NPM 配置

```
C:\Users\%username%\AppData\Roaming\npm\etc\npmrc 
```

### 每用户 NPM 配置

```
C:\Users\%username%\.npmrc 
```

### 内置 NPM 配置

```
C:\Program Files\nodejs\node_modules\npm\npmrc 
```

参考：

*   [https://docs.npmjs.com/files/npmrc](https://docs.npmjs.com/files/npmrc)
*   [https://docs.npmjs.com/misc/config](https://docs.npmjs.com/misc/config)
*   [https://docs.npmjs.com/cli/root.html](https://docs.npmjs.com/cli/root.html)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-02-23T13:32:27.987

你试过跑步`npm config list`吗？而且，如果您想查看默认值，请运行`npm config ls -l`.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-10-07T16:39:23.877

即使我们有 .NPMRC 可以位于 3 个位置，请注意 - Per-User NPM 配置位置下的文件优先于全局和内置配置。

1.  全局 NPM 配置 => C:\Users\%username%\AppData\Roaming\npm\etc\npmrc
2.  每用户 NPM 配置 => C:\Users\%username%.npmrc
3.  内置 NPM 配置 => C:\Program Files\nodejs\node_modules\npm\npmrc

要找出正在更新的文件，请尝试使用以下命令设置代理 npm config set https-proxy [https://username:password@proxy.company.com:6050](https://username:password@proxy.company.com:6050)

之后打开 .npmrc 文件以查看哪个文件得到更新。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-06-26T00:14:04.900

这不是你要找的路吗？

`C:\Program Files\nodejs\node_modules\npm\npmrc`

我知道 npm 输出，但全局文件夹是安装 node.js 的文件夹，所有模块都在。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-06-18T11:19:24.727

在 Windows 上，使用以下命令列出了 npm 的所有默认值，包括变量名为 userconfig 的配置文件的位置

```
npm config ls -l 
```

# python - 如何在 Twisted 中使用多个参数 spawnProcess？

> ID：15536875
> 
> 赞同：1
> 
> 时间：2013-03-20T23:41:55.840
> 
> 标签：python, twisted

我正在尝试通过扭曲开始一个过程。我正在解析一个 JSON 文件，它具有以下结构，其中包含多个命令：

```
{
"key"     : "test",
"cmd"     : "cat",
"args"    : "/opt/vinci/rxDaemons.json | grep cmd",
"restart" : 5,
"auto"    : 0
} 
```

我正在尝试的命令非常简单；我正在文件中搜索“cmd”一词（我相信你可以挑选出来）

我用来生成进程的代码如下：

```
cmd, args, uid, gid, env = self.processes[name]

proto = LoggingProtocol()
proto.service = self
proto.name = name
self.protocols[name] = proto
self.timeStarted[name] = self._reactor.seconds()
newArgs = str(cmd).split() + args.split()
self._reactor.spawnProcess(proto, str(cmd), args=newArgs, env=env, uid=uid, gid=gid ) 
```

回应是：

```
cat: |: No such file or directory
cat: grep: No such file or directory
cat: cmd: No such file or directory 
```

然后它会覆盖整个文件

我假设我们在每个参数上运行 cat 但我不知道为什么

如何在 spawnProcess 中正确使用多个 arg？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:48:11.267

问题是这`|`不是 的论据`cat`，它是 的[一部分`bash`](http://tldp.org/HOWTO/Bash-Prog-Intro-HOWTO-4.html)。`POpen`您可以添加`shell=True`到命令中，但这似乎在 Twisted 中不可用。“正确”的解决方案可能是在 Twisted 中实现管道，而不是在 bash 中。

编辑：实际上在您的情况下，这是[“无用的使用`cat`”](https://en.wikipedia.org/wiki/Cat_%28Unix%29#Useless_use_of_cat)，只需运行此命令即可：

```
grep cmd /opt/vinci/rxDaemons 
```

# jquery - css显示属性干扰我的jquery切换

> ID：15536885
> 
> 赞同：1
> 
> 时间：2013-03-20T23:43:07.523
> 
> 标签：jquery, css, mobile, menu, toggle

我想创建一个简单的移动菜单，单击时会打开和关闭。我还希望它只显示父母而不是孩子猫，直到点击父母。

我四处研究并找到了这两个问题的好答案。但是，当结合起来时，我没有得到想要的结果。

具体来说，我正在使用的 jquery 切换依赖于将 nav ul 设置为“display:none”作为它们的起始状态，但这在某种程度上干扰了我的其他 jquery 函数来隐藏其父级是顶级 ul 类的元素。

一切都按预期工作，除了在菜单初始加载时没有显示任何子项的部分。但是，一旦我删除了最初完全隐藏我的 nav ul 的 css 行，那么子项就会被隐藏（当然，当我希望隐藏时，我的导航会在加载时展开。

我正在尝试解决的页面：[http://saks-jewelers.com/mobile-nav/mobile_nav.html#]

这是我的html代码和jquery：

```
 <!doctype html>
    <html lang="en">
    <head>
    <meta charset="utf-8">
    <title>Responsive Header Nav</title>
    <meta name="description" content="Responsive Header Nav">
    <meta name="author" content="Treehouse">
    <meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1">
    <link rel="stylesheet" href="styles.css">
    <!--[if IE]> <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js">
    </script>
    <script>
    $(document).ready(function(){
      $("#menu-icon").click(function(){
        $("nav ul").toggle(200);
      });

        $('#nav>li>ul').each(function(){
            if($(this).parent().hasClass("level0")) 
            { 
                $(this).hide();
            } else {
                $(this).show(); 
            }
        });
        $('#nav>li').click(function(){
            // check that the menu is not currently animated
            if ($('#nav ul:animated').size() == 0) {
                // create a reference to the active element (this)
                // so we don't have to keep creating a jQuery object
                $heading = $(this);
                // create a reference to visible sibling elements
                // so we don't have to keep creating a jQuery object
                $expandedSiblings = $heading.siblings().find('ul:visible');
                if ($expandedSiblings.size() > 0) {
                    $expandedSiblings.slideUp(200, function(){
                        $heading.find('ul').slideDown(200);
                    });
                }
                else {
                    $heading.find('ul').slideDown(200);
                }
            }
        });
    });
    </script>
    <body>
    <header>
    <a href="#" id="logo"></a>
    <nav>
        <a href="#" id="menu-icon"></a>
    <ul id="nav">
            <li class="level0 nav-1 first level-top parent">
            <a href="#" class="level-top"><span>Rings</span></a>
            <ul class="level0">
                <li class="level1 nav-1-1 first"><a href="#" class=""><span>CZ Fashion</span></a></li>
                <li class="level1 nav-1-2"><a href="#" class=""><span>Gemstone Fashion</span></a></li>
                <li class="level1 nav-1-3"><a href="#" class=""><span>Silver &amp; Gold Fashion</span></a></li>
                <li class="level1 nav-1-4"><a href="#" class=""><span>Pearl</span></a></li>
                <li class="level1 nav-1-5"><a href="#" class=""><span>Moissanite™&lt;/span></a></li>
                <li class="level1 nav-1-6"><a href="#" class=""><span>Religious &amp; Symbolic</span></a></li>
                <li class="level1 nav-1-7"><a href="#" class=""><span>Youth</span></a></li>
                <li class="level1 nav-1-8"><a href="#" class=""><span>Promise Rings</span></a></li>
                <li class="level1 nav-1-9 last"><a href="#" class=""><span>Wedding</span></a></li>
            </ul>
        </li>
        <li class="level0 nav-2 level-top parent"><a href="#" class="level-top"><span>Earrings</span></a>
            <ul class="level0">
                <li class="level1 nav-2-1 first"><a href="#" class=""><span>CZ Fashion</span></a></li>
                <li class="level1 nav-2-2"><a href="#" class=""><span>Gemstone Fashion</span></a></li>
                <li class="level1 nav-2-3"><a href="#" class=""><span>Silver &amp; Gold Fashion</span></a></li>
                <li class="level1 nav-2-4"><a href="#" class=""><span>Pearl</span></a></li>
                <li class="level1 nav-2-5"><a href="#" class=""><span>Moissanite™&lt;/span></a></li>
                <li class="level1 nav-2-6"><a href="#" class=""><span>Religious &amp; Symbolic</span></a></li>
                <li class="level1 nav-2-7 last"><a href="#" class=""><span>Youth</span></a></li>
            </ul>
        </li>
    </ul>
    </nav>
    </header>
    <section>
    <img src="featured.png" alt="Respond" />
    <h1>Respond to Your Surroundings</h1>
    <p>...Filler Text</p>
    <p>...Filler Text</p>
    <p>Filler Text</p>
    </section>
    </body>
    </html> 
```

这是我的CSS：

```
 /*RESET*/
    html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, font, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td {margin:0; padding:0; border:0; outline:0; font-size:100%; vertical-align:baseline; background:transparent;} body {line-height: 1;}ol, ul{list-style:none;} blockquote, q{quotes:none;} blockquote:before, blockquote:after, q:before, q:after{content:'';content:none;} :focus{outline:0;} ins{text-decoration:none;} del{text-decoration:line-through;} table{border-collapse:collapse; border-spacing:0;}

    /*MAIN*/
    body { 
        font-size: 1.05em;
        line-height: 1.25em;
        font-family: Helvetica Neue, Helvetica, Arial;
        background: #f9f9f9;
        color: #555;
    }
    a {
        color: #4C9CF1;
        text-decoration: none;
        font-weight: bold;
    }
    a:hover { color: #444;  }
    img { width: 100%;  }
    header {
        background: #fff;
        width: 100%;
        height: 76px;
        position: fixed;
        top: 0;
        left: 0;
        border-bottom: 4px solid #4C9CF1;
        z-index: 100;
            }
    #logo{
        margin: 20px;
        float: left;
        width: 200px;
        height: 40px;
        background: url(nav-logo.png) no-repeat center;
        display: block;
            }
    nav {   float: right;   padding: 20px;  }
    #menu-icon {
        display: hidden;
        width: 40px;
        height: 40px;
        background: #4C8FEC url(nav-menu-icon.png) center;
    }
    a:hover#menu-icon {background-color: #444; border-radius: 4px 4px 0 0;   }
    ul { list-style: none; }
    li {
        display: inline-block;
        float: left;
            padding: 10px
    }
    .current {color: #2262AD;}
    section {
        margin: 80px auto 40px;
        max-width: 980px;
        position: relative;
        padding: 20px
    }
    h1 {
        font-size: 2em;
        color: #2262AD;
        line-height: 1.15em;
        margin: 20px 0 ;
    }
    p {line-height: 1.45em; margin-bottom: 20px;}

    /*MEDIA QUERY*/
    @media only screen and (max-width : 640px) {

        header {position: absolute; }
        #menu-icon { display:inline-block; }
        nav ul, nav:active ul { 
            display: none;
            position: absolute;
            padding: 20px;
            background: #fff;
            right: 20px;
            top: 60px;
            width: 50%;
        }
        nav li {
            text-align: left;
            width: 100%;
            padding: 10px 0;
            margin: 0;
        } 
```

如果这只是一种愚蠢的方式来做我想做的事情，我愿意接受更简单的替代方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:09:37.877

我认为你把整个事情复杂化了。我会这样做的方式：

```
<div class="rings" style="display:none">
    <ul>
      <li> ring 1 .... </li>
      <li> ring 2 .... </li>
      ....
    </ul>
</div>

<div class="earrings" style="display:none">
    <ul>
      <li> ring 1 .... </li>
      <li> ring 2 .... </li>
      ....
    </ul>
</div> 
```

接下来是 jQuery：

```
$('.menuAnchor').on('click', function(){
   var $this = $(this); //get the clicked element again

   //Get the text in the a tag and pass it a class selector
   //Therefor <a class="menuAnchor">earrings</a> on click with toggle the earrings div
   $('.'+$this.html()).slideToggle(500); 
}); 
```

就 css 而言，那里有一些无用的东西，但我认为你可以修复它而不会出现重大问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T00:50:08.837

您可能可以对此进行一些改进：（如果我明白您的意图，这应该可行）

```
var subs = $('#nav>li.level0>ul');
$("#menu-icon").click(function () {
      $("nav> ul").toggle(200);
      if ($("nav ul").is(':hidden')) {
          subs.hide();
      }
  });
  subs.hide();
  $('#nav>li').click(function () {
       if (!$('#nav ul:animated').length) {
          $heading = $(this);
          $expandedSiblings = $heading.siblings().find('ul:visible');
          if ($expandedSiblings.length) {
              $expandedSiblings.slideUp(200, function () {
                  $heading.find('ul').slideDown(200);
              });
          } else {
              $heading.find('ul').slideDown(200);
          }
      }
  }); 
```

这似乎也有效并且更简单：

```
 var subs = $('#nav>li.level0>ul');
 $("#menu-icon").click(function () {
     $("nav> ul").toggle(200);
     if ($("nav ul").is(':hidden')) {
         subs.hide();
     }
 });
 subs.hide();
 $('#nav>li').click(function () {
     if (!$('#nav ul:animated').length) {
         $(this).siblings().find('ul:visible').slideUp(200, function () {
             $(this).find('ul').slideDown(200);
         });
        $(this).find('ul').slideDown(200);
     }
 }); 
```

# iphone - 批处理 OpenGL 精灵

> ID：15536886
> 
> 赞同：1
> 
> 时间：2013-03-20T23:43:09.147
> 
> 标签：iphone, ios, opengl-es, opengl-es-2.0

我一直在学习 OpenGL，并且能够使用三角形条创建一个成功的 2d 绘图系统。我编写了一个粒子生成器来测试几何体的批处理，一切正常，我能够在 iPhone 5 上以 60 fps 的速度渲染 30k+ 个顶点。我使用退化三角形连接粒子并立即绘制它们。我想要完成的是在不使用退化三角形的情况下进行批量渲染，因为这会将发送到 GPU 的数据量减少 1/3，这将是巨大的。

我正在尝试使用带有三角形的 glDrawElements 使用以下代码绘制 2 个精灵

```
//the vertices for the square (2d)
GLfloat square[] = {
    50, 50,  //bottom left
    100, 50, //bottom right
    50, 100, //top left
    100, 100, //top right

    150, 200,  //bottom left
    200, 150, //bottom right
    150, 200, //top left
    200, 200 //top right
};

//texture coords
GLfloat tex[] = {
    0,0,
    1,0,
    0,1,
    1,1,

    0,0,
    1,0,
    0,1,
    1,1
};

GLubyte indices[] =
{
    0,2,3, 
    0,3,1,

    0,2,3,
    0,3,1
};

//actual drawing code
glBindBuffer(GL_ARRAY_BUFFER, 0);
glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);
glVertexAttribPointer(ATTRIB_VERTEX, 2, GL_FLOAT, GL_FALSE, 0, square);
glVertexAttribPointer(ATTRIB_TEX, 2, GL_FLOAT, GL_FALSE, 0, tex);

glActiveTexture(GL_TEXTURE0);
glBindTexture(GL_TEXTURE_2D, image);

glDrawElements(GL_TRIANGLES, 12, GL_UNSIGNED_BYTE, indices); 
```

此代码毫无问题地绘制了第一张图像，但第二张图像失真了。我一直在网上寻找，但一直无法弄清楚如何使它正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:15:15.227

首先，您当前对两个四边形使用相同的索引，因此第二张图像甚至根本不可见。

除了第二个四边形的顶点数据混乱之外，您有`(150, 200)`两次要点，第一次可能应该是`(150, 150)`.

# codeigniter - CodeIgniter 路由问题，建议如何做

> ID：15536887
> 
> 赞同：0
> 
> 时间：2013-03-20T23:43:09.840
> 
> 标签：codeigniter, codeigniter-2, codeigniter-url, codeigniter-routing

我不是CI程序员，只是想学习它。也许这是错误的方法，请指教。

我的控制器（不在子目录中）：

```
class Users extends CI_Controller {

    function __construct() {
        parent::__construct();
    }

public function index($msg = NULL) {

        $this->load->helper(array('form'));

        $data['msg'] = $msg;

        $this->load->view('user/login' , $data);

    }

   public function process_logout() {
        $this->session->sess_destroy();
        redirect(base_url());
    }

} 
```

以及登录路线：

```
$route['user/login'] = 'users/index'; 
```

问题是当我想注销时，它会显示 404，因为我的路线中没有它：

```
$route['user/process_logout'] = 'users/process_logout'; 
```

在我看来，我把`<a href="users/process_logout">logout</a>`

当我添加它时，它会起作用，而为所有内容添加路由是很愚蠢的。我做错了什么，请指教。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:59:25.907

不知道您为什么要在 index() 函数中实现登录功能。然而，既然你说你正在学习 CI，我正在讲述一些关于**_remap()**函数的事情。

在那之前。您可以尝试以下路由：

```
$route['user/:any'] = 'users/$1';
$route['user/login'] = 'users/index'; 
```

如果你想在控制器段之后立即取值，你需要使用 _remap() 函数，这个函数可能会解决你的路由问题，我的意思是你不需要设置路由。让我们使用 _remap() 函数实现您的代码控制器**“用户” 。**

```
class Users extends CI_Controller {

    private $sections = array('login', 'logout');

    function __construct() {
        parent::__construct();

    }

   public function _remap($method)
   {
        $section = $this->uri->segment(2);

        if(in_array($section, $this->sections))
            call_user_func_array(array($this, '_'.$section), array());

        else show_404(); // Showing 404 error
   }

   private function _login() 
   {
        $msg = $this->uri->segment(3);

        $this->load->helper(array('form'));
        $data['msg'] = $msg;
        $this->load->view('user/login' , $data);
    }

   public function _logout() {
        $this->session->sess_destroy();
        redirect(base_url());
    }

} 
```

# spring - 在 Spring Web 服务拦截器中捕获异常并返回 Soap 响应

> ID：15536899
> 
> 赞同：1
> 
> 时间：2013-03-20T23:44:17.270
> 
> 标签：spring, exception, soap, exception-handling, spring-ws

在 Spring Web 服务中捕获异常、提取其详细信息并将其格式化为肥皂响应的最佳方法是什么？我的错误消息详细信息必须放在 Soap 响应的标头中。

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ims="http://www.imsglobal.org/services/lis/cmsv1p0/wsdl11/sync/imscms_v1p">
   <soapenv:Header>
      <imsx_syncResponseHeaderInfo xmlns="http://www.imsglobal.org/services/lis/cmsv1p0/wsdl11/sync/imscms_v1p0">
         <imsx_version>V1.0</imsx_version>
         <imsx_messageIdentifier>4</imsx_messageIdentifier>
         <imsx_statusInfo>
            <imsx_codeMajor>failure</imsx_codeMajor>
            <imsx_severity>status</imsx_severity>
            <imsx_codeMinor>
               <imsx_codeMinorField>
                  <imsx_codeMinorFieldName>TargetEndSystem</imsx_codeMinorFieldName>
                  <imsx_codeMinorFieldValue>incompletedata</imsx_codeMinorFieldValue>
               </imsx_codeMinorField>
            </imsx_codeMinor>
         </imsx_statusInfo>
      </imsx_syncResponseHeaderInfo>
   </soapenv:Header>
   <soapenv:Body/>
</soapenv:Envelope> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T12:22:46.297

我知道这是否是最好的方法，但我添加了一个**SimpleSoapExceptionResolver**对象：

```
import java.util.Date;
import java.util.Locale;
import org.apache.log4j.Logger;
import org.springframework.ws.WebServiceMessage;
import org.springframework.ws.context.MessageContext;
import org.springframework.ws.soap.SoapBody;
import org.springframework.ws.soap.SoapFault;
import org.springframework.ws.soap.SoapMessage;
import org.springframework.ws.soap.server.endpoint.SimpleSoapExceptionResolver;

public final class MySimpleSoapExceptionResolver 
extends SimpleSoapExceptionResolver {

    public MySimpleSoapExceptionResolver () {
        super.setOrder(HIGHEST_PRECEDENCE);     
    }

    @Override
    protected void customizeFault(  final MessageContext messageContext_, 
                                    final Object endpoint_, 
                                    final Exception exception_, 
                                    SoapFault soapFault_) {

        WebServiceMessage _webServiceMessageResponse = 
                                messageContext_.getResponse();
        SoapMessage _soapMessage = (SoapMessage) _webServiceMessageResponse;
        SoapBody _soapBody = _soapMessage.getSoapBody();

        String _message = "your error message";

        Logger _logger = Logger.getLogger(MySimpleSoapExceptionResolver.class);
        _logger.error(_message, exception_);
        soapFault_ = 
        _soapBody.addServerOrReceiverFault(_message, Locale.ENGLISH);

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T04:35:17.033

您可能可以实现 org.springframework.ws.server.endpoint.interceptor.EndpointInterceptorAdapter 类型的拦截器。在您的 Web 服务配置中注册您的拦截器。

像这样实现方法 handleResponse(MessageContext messageContext, Object endpoint) -

```
handleResponse(MessageContext messageContext, Object endpoint) {
   SoapMessage msg = (SoapMessage) messageContext.getResponse();
   SoapHeader header = msg.getSoapHeader();
   // do what you want to do with header.
} 
```

我还没有实现这一点，但在 CXF 中使用拦截器做了类似的事情。

# c++ - 双端队列实现

> ID：15536901
> 
> 赞同：1
> 
> 时间：2013-03-20T23:44:27.540
> 
> 标签：c++, data-structures, stl, deque

我对我在 Internet 上找到的代码有疑问，该代码使用双端队列来查找元素的最大值——

```
 #include <iostream>
 #include <deque>

 using namespace std;

 void test(int arr[], int n)
 {    
   std::deque<int>  Qi(n); 
   int i;
   for (i = 0; i < n; ++i)
   {
      while ( (!Qi.empty()) && arr[i] >= arr[Qi.back()])
        Qi.pop_back();  // Remove from rear

      Qi.push_back(i);
   }
  cout << arr[Qi.front()];   
}

// Driver program to test above functions
int main()
{
   int arr[] = {12, 1, 78, 90, 57, 89, 56};
   int n = sizeof(arr)/sizeof(arr[0]);    
   test(arr, n);
   return 0;
} 
```

我的问题是当我没有做任何 Qi.push_front() 时 Qi.front() 如何给出正确的索引？

但是下面的代码给了我一个 0

```
 void test(int arr[], int n)
 {    
   std::deque<int>  Qi(n); 
   int i;
   for (i = 0; i < n; ++i)
   {           
      Qi.push_back(i);
   }
   cout << arr[Qi.front()];   
} 
```

抱歉，如果我听起来很愚蠢.. deques 新手...

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T23:46:57.387

`std::deque<int> Qi(n);`创建一个包含元素的双端队列`n`，所有元素都为零。这些`push_back`操作在后面添加更多元素，因此之后双端队列具有`2 * n`元素。`Qi.front()`与 相同`Qi[0]`。

所有这些都有据可查，例如[这里](http://en.cppreference.com/w/cpp/container/deque)。

# python - Python：简化许多 if 语句

> ID：15536902
> 
> 赞同：3
> 
> 时间：2013-03-20T23:44:33.320
> 
> 标签：python, if-statement, binary-tree, traversal

我有一个遍历树并将元素作为列表返回的函数。有没有办法简化所有 if 语句`treeToList::traverse`，因为它看起来有点多余？

```
#!/usr/bin/python

def enum(**enums):
  return type('Enum', (), enums)

Order = enum(PREORDER=0, INORDER=1, POSTORDER=2)
def treeToList(root, order=Order.INORDER):
  ret = list()
  def traverse(node, order):
    if order == Order.PREORDER: ret.append(node.data)
    if node.right != None: traverse(node.right, order)
    if order == Order.INORDER: ret.append(node.data)
    if node.down != None: traverse(node.down, order)
    if order == Order.POSTORDER: ret.append(node.data)
  traverse(root, order)
  return ret

class node:
  def __init__(self, data=None):
    self.data = data
    self.down = None
    self.right = None

if __name__ == '__main__':
  root = node('F')
  root.right = node('B')
  root.down = node('G')
  root.right.right = node('A')
  root.right.down = node('D')
  root.down.down = node('I')
  root.right.down.right = node('C')
  root.right.down.down = node('E')
  root.down.down.right = node('H')

  print treeToList(root, Order.PREORDER)
  print treeToList(root, Order.INORDER)
  print treeToList(root, Order.POSTORDER) 
```

**输出**

```
['F', 'B', 'A', 'D', 'C', 'E', 'G', 'I', 'H']
['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I']
['A', 'C', 'E', 'D', 'B', 'H', 'I', 'G', 'F'] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T23:58:52.073

好吧，如果你摆脱了闭包..一个纯函数可能更清楚：

```
def treeToList(node, order=Order.INORDER):
    if node is None:
        return []

    right = treeToList(node.right, order)
    down = treeToList(node.down, order)
    current = [node.data]

    if order == Order.PREORDER:
        return current + right + down

    if order == Order.INORDER:
        return right + current + down

    if order == Order.POSTORDER:
        return right + down + current 
```

但是当然会构建很多中间列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T23:59:05.290

我认为在`if order`不重新组织算法的情况下，没有消除这三个语句的好方法。发生的位置`ret.append`取决于该值，因此您几乎必须以一种或另一种方式检查所有三次。

但是有一种明显的方法可以重组事物以删除几个`if`s：

```
def traverse(node, order):
    if node is None: return
    if order == Order.PREORDER: ret.append(node.data)
    traverse(node.right, order)
    if order == Order.INORDER: ret.append(node.data)
    traverse(node.down, order)
    if order == Order.POSTORDER: ret.append(node.data) 
```

当然它长了一行，但它只有 4`if`秒而不是 6 秒。

另一种可能性是更改内容以跟踪所有三个位置，并在事后插入适当的位置：

```
def traverse(node, order):
    if node is None: return
    prepos = len(ret)
    traverse(node.right, order)
    inpos = len(ret)
    traverse(node.down, order)
    postpos = len(ret)
    pos = (prepos, inpos, postpos)[order]
    ret[pos:pos+1] = node.data 
```

这会删除所有的`if`s，但我不认为结果更容易阅读或理解……</p>

真的，让这个更容易阅读和理解的方法可能是切换到函数式算法（递归可变算法很难思考）……但这只会使三个`if`主体更大，而不是摆脱它们。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T23:53:44.160

我唯一想到的就是这个：

```
def treeToList(root, order=Order.INORDER):
    ret = list()
    def inorder_traversal(node):
        if node is not None:
            inorder_traversal(node.right)
            ret.append(node.data)
            inorder_traversal(node.down)

    def preorder_traversal(node):
        if node is not None:
            ret.append(node.data)
            preorder_traversal(node.right)
            preorder_traversal(node.down)

    def postorder_traversal(node):
        if node is not None:
            postorder_traversal(node.right)
            postorder_traversal(node.down)
            ret.append(node.data)

    if order == Order.PREORDER:
        preorder_traversal(node)
    elif order == Order.INORDER:
        inorder_traversal(node)
    else:
        postorder_traversal(node)

    return ret 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T23:47:56.080

~~尝试类似的东西~~

 ~~```
if order in (Order.PREORDER, Order.INORDER, ...):
    ret.append(node.data) 
```~~ 

~~*挑剔*~~

 ~~你应该在多行上有你的条件

```
if cond:
    pass 
```

代替

```
if cond: pass 
```

还可以考虑在比较时使用`is`and而不是and 。`is not``None``==``!=`~~

# android - 偏好点击监听器上的偏好活动

> ID：15536908
> 
> 赞同：20
> 
> 时间：2013-03-20T23:44:49.290
> 
> 标签：android, onclicklistener, preferenceactivity

我正在构建一个首选项活动，其中列表中的大多数首选项将执行代码而不是直接修改 SharedPreference。我的preferences.xml 文件看起来像这样。

```
<PreferenceCategory
    android:title="Connection" >

    <Preference
        android:id="@+id/settings_connectToNewComputer"
        android:key="connectToNewComputer"
        android:summary="Currently connected to:"
        android:title="Connect to new computer" />

    <Preference
        android:id="@+id/removeDevice"
        android:key="removeDevice"
        android:summary="Remove this device from the computer's whitelist"
        android:title="Remove this device from computer" />

</PreferenceCategory>

<PreferenceCategory
    android:title="About" >

    <Preference
        android:id="@+id/settings_About"
        android:key="about"
        android:summary="About me and my thanks to those who made this app great"
        android:title="About Hue Pro" />

    <Preference
        android:id="@+id/contact"
        android:key="contact"
        android:summary="Contact me with comments, bugs, and suggestions for updates"
        android:title="Contact me" />

</PreferenceCategory> 
```

我的目标是在单击其中一个首选项时执行一段代码。类似于 Google Play 设置偏好菜单中的“清除搜索历史”。( [http://i.imgur.com/qnHbJX9.png](http://i.imgur.com/qnHbJX9.png) )

有谁知道如何使这成为可能？

我必须补充一点，我尝试过使用 findPreference("KeyNameHere") 但它总是返回 null。

谢谢！

* * *

**编辑：**

我在这段代码中添加并实现了 OnPreferenceClickListener：

```
@Override
public boolean onPreferenceClick(Preference preference) {
    return false;
} 
```

但是这个方法永远不会被调用。还有另一种方法可以做到这一点吗？

* * *

**编辑2：**

我发现如果我取出 PreferenceCategory 标签，那么我就剩下这个了：

```
<Preference
    android:id="@+id/settings_connectToNewComputer"
    android:key="connectToNewComputer"
    android:summary="Currently connected to:"
    android:title="Connect to new computer" />

<Preference
    android:id="@+id/removeDevice"
    android:key="removeDevice"
    android:summary="Remove this device from the computer's whitelist"
    android:title="Remove this device from computer" />

<Preference
    android:id="@+id/settings_About"
    android:key="about"
    android:summary="About me and my thanks to those who made this app great"
    android:title="About Hue Pro" />

<Preference
    android:id="@+id/contact"
    android:key="contact"
    android:summary="Contact me with comments, bugs, and suggestions for updates"
    android:title="Contact me" /> 
```

并称之为：

```
getPreferenceScreen().setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {

        @Override
        public boolean onPreferenceClick(Preference preference) {
            return false;
        }
    }); 
```

然后我实际上得到了点击事件的响应。唯一的缺点是我必须删除首选项分组。任何人都知道这是为什么以及任何解决方法？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-21T00:01:19.093

实施`OnPreferenceClickListener`并在`onPreferenceClick`

```
@Override
public boolean onPreferenceClick (Preference preference)
{
    String key = preference.getKey();
    // do what ever you want with this key
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-07-17T16:02:18.890

也许这对 OP 没有用，但对其他人可能有用。我想写一个总结；一般来说，您可以主要遵循三种方式：1）您可以在代码中的某处找到您的偏好

```
Preference examplePreference = findPreference(KEY_EXAMPLE_PREFERENCE); 
```

然后你可以添加一个点击监听器并覆盖它的点击方法

```
examplePreference.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {
    @Override
    public boolean onPreferenceClick(Preference preference) {
        // handle click here
    }
}); 
```

这必须为您想要收听其点击的每个首选项完成 2）您可以在设置片段/活动中实现 Preference.OnPreferenceClickListener 接口并仅覆盖一次 onPreferenceClick，方法是使用 switch 构造或 if-else if-else if -...构造和合并所有单一的处理；它应该是这样的：

```
@Override
public boolean onPreferenceClick(Preference preference) {
    switch (preference.getKey()) {
        case KEY_EXAMPLE_PREFERENCE: {
            // handle click here
        }
        break;
        case ...
    }
} 
```

然后，您仍然需要找到每个偏好，但您可以简单地调用它们中的每一个

```
setOnPreferenceClickListener(this); 
```

（我认为 OP 的实现不起作用（由于最后一部分，他的方法没有被调用））我们将“this”作为参数传递，因为我们实现了点击侦听器接口

3）（我认为是最简单的）你可以覆盖

```
onPreferenceTreeClick(PreferenceScreen preferenceScreen, Preference preference) 
```

在您的偏好片段/活动中而不实现任何其他接口，您可以在那里复制选项 2) 的 if-else if-... 构造的开关；主要优点在于您不需要找到每个首选项并调用它们 setOnPreferenceClickListener。

希望这对某人有用！

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-10-28T12:46:13.913

只需覆盖：

```
@Override
public boolean onPreferenceTreeClick(PreferenceScreen preferenceScreen, Preference preference) {

    String key = preference.getKey();
    ...

    return super.onPreferenceTreeClick(preferenceScreen, preference);
} 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-10-03T19:42:22.810

您还可以找到首选项并设置点击侦听器。

```
Preference connectToNewComputer= findPreference("connectToNewComputer");
connectToNewComputer.setOnPreferenceClickListener(this); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-03-21T03:31:45.697

我想出了自己的（我认为真的搞砸了）解决方案；但它有效。

```
for(int x = 0; x < getPreferenceScreen().getPreferenceCount(); x++){
        PreferenceCategory lol = (PreferenceCategory) getPreferenceScreen().getPreference(x);
        for(int y = 0; y < lol.getPreferenceCount(); y++){
            Preference pref = lol.getPreference(y);
            pref.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener(){

                @Override
                public boolean onPreferenceClick(Preference preference) {
                    return false;
                }

            });
        }
    } 
```

所以我了解到有一个分层系统，其工作方式如下： PreferenceScreen 有子项 PreferenceCategory 有子项 Preference，正如您在 XML 文件中看到的那样。我的问题是我无法直接从 PreferenceScreen 设置首选项的 onClickListeners。因此，我制作了两个 for 循环，它们将深入到每个 Preference 并为每个循环设置一个 OnPreferenceClickListener。凌乱，但最终工作。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2020-02-01T17:20:38.990

## 适用于 2020 年 2 月的 Androidx

其他答案对我来说在**Androidx**中不起作用。我实现了[Android 开发者](https://developer.android.com/guide/topics/ui/settings)指南中的设置

请参阅以下指南以实现点击侦听器

1）在您的设置片段中实现[PreferenceManager.OnPreferenceTreeClickListener ，如下面的代码](https://developer.android.com/reference/androidx/preference/PreferenceManager.OnPreferenceTreeClickListener)

```
import androidx.preference.PreferenceManager;

class SettingsFragment extends PreferenceFragmentCompat implements PreferenceManager.OnPreferenceTreeClickListener { 
```

2) 在 SettingsFragment 中覆盖 onPreferenceTreeClick

```
@Override
public boolean onPreferenceTreeClick(Preference preference) {        
    String key = preference.getKey();

        switch (key) {
            case "key1":
                return true;

            case "key2":
                return true;

            //codes    
        }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-23T23:58:12.537

如果您发现以下内容（从项目中复制粘贴），您的 Preference 对象将不会为 null：

```
public class ImePreferences extends PreferenceActivity { 
```

......

```
@Override
protected boolean isValidFragment(String fragmentName) {
    return Settings.class.getName().equals(fragmentName);
} 
```

......

```
public static class Settings extends InputMethodSettingsFragment {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setInputMethodSettingsCategoryTitle(R.string.language_selection_title);
        setSubtypeEnablerTitle(R.string.select_language);

        // Load the preferences from an XML resource
        addPreferencesFromResource(R.xml.ime_preferences);
        Preference pLcl = getPreferenceScreen().findPreference(getResources().getString(
                R.string.dictionary_button));
        pLcl.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {
            @Override
            public boolean onPreferenceClick(Preference preference) {
                // handle click here
                l.a("this is the click");
                return true;
            }
        });
        if(pLcl != null)
            l.a(6576);
    }
} 
```

......

```
} 
```

# android - 官方 Fragment 开发者指南是否自相矛盾？

> ID：15536913
> 
> 赞同：4
> 
> 时间：2013-03-20T23:45:07.287
> 
> 标签：android, interface, android-fragments

在[官方 Fragment 指南的](http://developer.android.com/guide/components/fragments.html)[设计哲学](http://developer.android.com/guide/components/fragments.html#Design)部分，它说：

> 您应该将每个片段设计为模块化和可重用的活动组件。也就是说，因为每个片段都通过自己的生命周期回调定义了自己的布局和自己的行为，所以您可以在多个活动中包含一个片段，因此您应该设计重用并**避免直接从另一个片段操作一个片段**。

但在其[Example](http://developer.android.com/guide/components/fragments.html#Example)中，`TitlesFragment`类(extends ) 在其方法`ListFragment`中直接引用`DetailsFragment`类 (extends )`Fragment``showDetails()``findFragmentById()`

```
DetailsFragment details = (DetailsFragment)
        getFragmentManager().findFragmentById(R.id.details); 
```

并调用`DetailsFragment`类的`newInstance()`方法。

```
details = DetailsFragment.newInstance(index); 
```

这是一种糟糕的编码风格吗？

相比之下，[Basic Training Material](http://developer.android.com/training/basics/fragments/communicating.html)在编码风格方面似乎做得更好。它使用一个接口进行片段到活动的通信。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T23:50:53.397

> 这是一种糟糕的编码风格吗？

恕我直言，是的。恕我直言，一个片段既不应该知道也不应该关心活动管理的其他片段。片段可能关心*嵌套*片段（通过 的子片段`getChildFragmentManager()`），但不关心可能的对等片段。

在引用示例的情况下，`TitlesFragment`不应该关心它是以单窗格还是双窗格模式显示。活动应该关心这一点。这隔离了活动中所有与屏幕大小相关的代码——`TitlesFragment`可以忽略屏幕大小。

话虽如此，代码AFAIK在技术上没有任何问题——这不是我推荐的做法。

# php - PHP 变量变量是如何工作的？

> ID：15536916
> 
> 赞同：3
> 
> 时间：2013-03-20T23:45:17.207
> 
> 标签：php, variables

我知道 PHP 变量变量是如何工作的，但是无法理解为什么这个脚本会输出“I am r”。而不是“我是 B”。

```
<?php
class fooo {
    var $bar = 'I am bar.';
    var $arr = array('I am A.', 'I am B.', 'I am C.');
    var $r   = 'I am r.';
}
$fooo = new fooo();
$arr = 'arr';
echo $fooo->$arr[1] . "\n";
//above line output
//I am r.
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T23:46:31.060

您正在定义`$arr = 'arr';`然后从字符串 'arr' 中获取第二个字符，而不是类 Foo 中的数组，这就是为什么你得到 'r' （`[1]`从你的单词中返回第二个字符）。

**解决方案？**你应该更换：

```
echo $fooo->$arr[1] . "\n"; 
```

和：

```
echo $fooo->arr[1] . "\n"; 
```

您应该收到您想要的输出：

```
'I am B.' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:46:38.317

当您引用对象属性时，它是变量的名称，而不是变量本身。所以你会想做：

```
echo $fooo->arr[1] . "\n"; 
```

得到你所期望的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-11-09T05:25:20.557

得到“我是B”。

您需要先解决**$arr**。

```
echo $fooo->${$arr}[1] 
```

原因是变量的范围是**$arr='arr'**而不是属性 **$arr=array**

# eclipse - Eclipse Ubuntu 中的 ArUco

> ID：15536918
> 
> 赞同：0
> 
> 时间：2013-03-20T23:45:18.950
> 
> 标签：eclipse, ubuntu

我想编译增强现实 ArUco 库，但是互联网上的这个库文档太少了，我遇到了一些问题。有人可以给我一个关于如何在 Eclipse 中编译它的小教程吗？（可能是另一个 IDE） 我正在使用 Ubuntu 12.10，Eclipse Juno。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:54:35.390

查看库的 README 文件，您可能必须使用 [cmake](http://www.cmake.org/)。打开终端并安装 cmake 和 OpenCv（库的要求）`apt-get`。我不知道它们在 Ubuntu 中的确切软件包名称，但请尝试显而易见的`cmake`和`opencv`. 完成后，`cd`进入解包 aruco 库的目录，然后执行以下操作：

```
mkdir build && cd build
cmake ..
make all
make install 
```

您可以通过使用更改安装前缀，`cmake -i ..`或者`ccmake`如果它也已安装。至于在 IDE 中设置库，只需记下库文件（二进制文件和头文件）安装到哪些目录，并确保这些目录位于编译器的搜索路径中。

# php - API 凭据不正确

> ID：15536921
> 
> 赞同：2
> 
> 时间：2013-03-20T23:45:26.667
> 
> 标签：php, paypal

我尝试将[PayPal APIs Getting Started Guide](https://www.x.com/developers/paypal/documentation-tools/quick-start-guides/paypal-apis-getting-started-guide) to PHP 中的示例改编为：

```
<?php

define('PAYPAL_API_USER', '<snip>');
define('PAYPAL_API_PWD', '<snip>');
define('PAYPAL_API_SIGNATURE', '<snip>');
define('PAYPAL_API_APPLICATION_ID', 'APP-80W284485P519543T');

$endpoing = 'https://svcs.sandbox.paypal.com/AdaptiveAccounts/CreateAccount';
$headers = array(
    'X-PAYPAL-SECURITY-USERID' => PAYPAL_API_USER,
    'X-PAYPAL-SECURITY-PASSWORD' => PAYPAL_API_PWD,
    'X-PAYPAL-SECURITY-SIGNATURE' => PAYPAL_API_SIGNATURE,

    'X-PAYPAL-REQUEST-DATA-FORMAT' => 'JSON',
    'X-PAYPAL-RESPONSE-DATA-FORMAT' => 'JSON',

    'X-PAYPAL-APPLICATION-ID' => PAYPAL_API_APPLICATION_ID,

    'X-PAYPAL-DEVICE-IPADDRESS' => '192.0.2.0', // :-? Also tried with my public IP address
    'X-PAYPAL-SANDBOX-EMAIL-ADDRESS' => '<snip>', // Typed my account's e-mail
);
$payload = '{
    "sandboxEmailAddress": "Sender-emailAddress",
    "accountType": "PERSONAL",
    "name": {
        "firstName": "Lenny",
        "lastName": "Riceman"
    },
    "address": {
        "line1": "123 Main St",
        "city": "Austin",
        "state": "TX",
        "postalCode": "78759",
        "countryCode": "US"
    },
    "citizenshipCountryCode": "US",
    "contactPhoneNumber": "512-555-5555",
    "dateOfBirth": "1968-01-01Z",
    "createAccountWebOptions": {
        "returnUrl": "http://www.example.com/success.html"
    },
    "currencyCode": "USD",
    "emailAddress": "lr12345@example.com",
    "preferredLanguageCode": "en_US",
    "registrationType": "Web",
    "requestEnvelope": {
        "errorLanguage": "en_US"
    }
}';
$options = array(
    CURLOPT_SSL_VERIFYPEER => false,
    CURLOPT_HTTPHEADER => $headers,
CURLOPT_POST => false,
CURLOPT_POSTFIELDS => $payload,
    CURLOPT_RETURNTRANSFER => true,
);

try{
    $curl = curl_init($endpoing);
    if(!$curl){
        throw new Exception('Could not initialize curl');
    }
    if(!curl_setopt_array($curl, $options)){
        throw new Exception('Curl error:' . curl_error($curl));
    }
    $result = curl_exec($curl);
    if(!$result){
        throw new Exception('Curl error:' . curl_error($curl));
    }
    curl_close($curl);
    echo $result;
}catch(Exception $e){
    echo 'ERROR: ' . $e->getMessage() . PHP_EOL;
} 
```

...但我总是得到这个：

```
<?xml version='1.0' encoding='utf-8'?>
<ns3:FaultMessage xmlns:ns3="http://svcs.paypal.com/types/common" xmlns:ns2="http://svcs.paypal.com/types/aa">
    <responseEnvelope>
        <timestamp>2013-03-20T16:33:46.309-07:00</timestamp>
        <ack>Failure</ack>
        <correlationId>7d7fa53e6a930</correlationId>
        <build>5343121</build>
    </responseEnvelope>
    <error>
        <errorId>520003</errorId>
        <domain>PLATFORM</domain>
        <subdomain>Application</subdomain>
        <severity>Error</severity>
        <category>Application</category>
        <message>Authentication failed. API credentials are incorrect.</message>
    </error>
</ns3:FaultMessage> 
```

我已经仔细检查了 API 凭据（用户、密码和签名），它们与配置文件页面中显示的完全一样。我不完全确定`X-PAYPAL-DEVICE-IPADDRESS`and `X-PAYPAL-SANDBOX-EMAIL-ADDRESS`。

我怀疑我读错了一些东西或省略了一些 curl 选项。你能发现我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T23:58:17.240

有点无益的是，该`CURLOPT_HTTPHEADER`选项不**采用**Header=>Value 对的哈希值，仅采用字符串列表，每个字符串都必须是完整的 HTTP 标头。

所以不是`$headers = array('X-PAYPAL-SECURITY-USERID' => PAYPAL_API_USER, ...)`你需要`$headers = array('X-PAYPAL-SECURITY-USERID: ' . PAYPAL_API_USER, ...)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-04T14:56:15.060

原因是您使用了错误的 api 凭据。您需要在您的主要开发者帐户中设置一个用户。设置完成后，您将在他们的个人资料中看到他们拥有自己单独的 API 凭据。

我遇到了同样的问题，花了几个小时才解决，但现在一切正常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-17T23:54:48.023

它确实很清楚地表明沙盒的 APP-ID 始终为`APP-80W284485P519543T`.

当您上线时，您将拥有自己的。

# sql-server-2008 - 从 SSRS 2008 中的日期提取月/年

> ID：15536926
> 
> 赞同：4
> 
> 时间：2013-03-20T23:46:03.470
> 
> 标签：sql-server-2008

我使用的是 SQL Server SSRS 2008 版本，我需要从日期字段中提取月份和年份值。例如从 2013-01-11 21:11:29.340 开始，我需要报告显示“2013 年 1 月”</p>

在设计视图中，在我希望显示信息的单元格中，下拉菜单中的“表达式”选项，我把

```
= DATENAME(MONTH, DesiredDate) & DATENAME(YEAR, DesiredDate) . 
```

并收到一条错误消息。

顺便说一句，“DesiredDate”来自查询设计器中的 SQL 代码。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T00:46:11.043

在 SQL Server 中，要连接值，您将需要`+`值之间的 a：

```
DATENAME(MONTH, DesiredDate) +' '+ DATENAME(YEAR, DesiredDate) 
```

您可能需要使用`&' '&`which 将在值之间添加空格：

```
DATENAME(MONTH, DesiredDate) &' '& DATENAME(YEAR, DesiredDate) 
```

编辑 #1，根据您的评论，您可以在“表达式”窗口中使用以下内容：

```
=MonthName(Month(Fields!desireddate.Value)) &" "& Year(Fields!desireddate.Value) 
```

注意：我刚刚在 SSRS 2008 中对此进行了测试，它返回了您想要的结果。

# c# - 实现我的数据访问层的接口

> ID：15536931
> 
> 赞同：1
> 
> 时间：2013-03-20T23:46:17.827
> 
> 标签：c#, winforms, c#-4.0, interface, data-access-layer

我有很多与以下结构相同的类，我想在它们中实现一个接口。那么，是否有人对此有解决方案？

```
 public static class ClientDAL
      {
        private static string connString = ConfigurationManager.ConnectionStrings["default"].ToString();

    public static ClientEntity NewClient(ClientEntity client)
    {
        using (SqlConnection conn = new SqlConnection())
        {
            conn.ConnectionString = connString;
            conn.Open();
            SqlCommand cmd = new SqlCommand();
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.CommandText = "InsertNewClient";
            cmd.Connection = conn;

            cmd.Parameters.AddWithValue("@ClientID", client.ClientID);
            cmd.Parameters.AddWithValue("@ClientName", client.ClientName);
            cmd.Parameters.AddWithValue("@ClientNif", client.ClientNIF);
            cmd.Parameters.AddWithValue("@ClientAddress", client.ClientAddress);
            cmd.Parameters.AddWithValue("@ClientCountry", client.ClientCountry);
            cmd.Parameters.AddWithValue("@ClientProvincy", client.ClientProvincy);
            cmd.Parameters.AddWithValue("@ClientCity", client.ClientCity);
            cmd.Parameters.AddWithValue("@ClientPhone", client.ClientPhone);
            cmd.Parameters.AddWithValue("@ClientMobile", client.ClientMobile);
            cmd.Parameters.AddWithValue("@ClientFax", client.ClientFax);
            cmd.Parameters.AddWithValue("@ClientEmail", client.ClientEmail);
            cmd.Parameters.AddWithValue("@ClientInfo", client.ClientInfo);
            cmd.ExecuteNonQuery();
        }
        return client;
    }
    /// <summary>
    /// 
    /// </summary>
    /// <param name="clientID"></param>
    /// <returns></returns>
    public static ClientEntity GetClientByID(Int64 clientID)
    {
        ClientEntity client=null;
        using (SqlConnection conn = new SqlConnection())
        {
            conn.ConnectionString = connString;
            conn.Open();
            SqlCommand cmd = new SqlCommand();
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.CommandText = "SelectClient";
            cmd.Connection = conn;

            cmd.Parameters.AddWithValue("@ClientID", clientID);

            SqlDataReader reader = cmd.ExecuteReader();

            while (reader.Read())
            {
                client=LoadClient(reader);
            }
        }
        return client;
    }
    /// <summary>
    /// 
    /// </summary>
    /// <param name="ClientID"></param>
    /// <returns></returns>
    public static bool Exists(Int64 ClientID)
    {
        int numberOfRecord = 0;
        using (SqlConnection conn=new SqlConnection())
        {
            conn.ConnectionString = connString;
            conn.Open();

            SqlCommand cmd = new SqlCommand();
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.CommandText = "SelectValidClient";
            cmd.Connection = conn;
            cmd.Parameters.AddWithValue("@ClientID", ClientID);
            numberOfRecord = Convert.ToInt32(cmd.ExecuteScalar());

        }
        return numberOfRecord > 0;
    }

    public static List<ClientEntity> GetAllClients()
    {
        List<ClientEntity> lista = new List<ClientEntity>();
        using (SqlConnection conn = new SqlConnection())
        {
            conn.ConnectionString = connString;
            conn.Open();
            SqlCommand cmd = new SqlCommand();
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.CommandText = "SelectAllClient";
            cmd.Connection = conn;

            SqlDataReader reader = cmd.ExecuteReader();

            while (reader.Read())
            {
                lista.Add(LoadClient(reader));
            }
        }
        return lista;
    }
    public static ClientEntity UpdateClient(ClientEntity client)
    {
        using (SqlConnection conn = new SqlConnection())
        {
            conn.ConnectionString = connString;
            conn.Open();
            SqlCommand cmd = new SqlCommand();
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.CommandText = "UpdateClient";
            cmd.Connection = conn;

            cmd.Parameters.AddWithValue("@ClientID", client.ClientID);
            cmd.Parameters.AddWithValue("@ClientName", client.ClientName);
            cmd.Parameters.AddWithValue("@ClientNif", client.ClientNIF);
            cmd.Parameters.AddWithValue("@ClientAddress", client.ClientAddress);
            cmd.Parameters.AddWithValue("@ClientCountry", client.ClientCountry);
            cmd.Parameters.AddWithValue("@ClientProvincy", client.ClientProvincy);
            cmd.Parameters.AddWithValue("@ClientCity", client.ClientCity);
            cmd.Parameters.AddWithValue("@ClientPhone", client.ClientPhone);
            cmd.Parameters.AddWithValue("@ClientMobile", client.ClientMobile);
            cmd.Parameters.AddWithValue("@ClientFax", client.ClientFax);
            cmd.Parameters.AddWithValue("@ClientEmail", client.ClientEmail);
            cmd.Parameters.AddWithValue("@ClientInfo", client.ClientInfo);
            cmd.ExecuteNonQuery();
        }
        return client;
    }

    private static ClientEntity LoadClient(IDataReader reader)
    {
        ClientEntity list= new ClientEntity();

        list.ClientID =Convert.ToInt64(reader["ClientID"]);
        list.ClientName = Convert.ToString(reader["ClientName"]);
        list.ClientNIF = Convert.ToInt64(reader["ClientNif"]);
        list.ClientAddress = reader["ClientAddress"]==null?string.Empty:Convert.ToString(reader["ClientAddress"]);
        list.ClientCountry = reader["ClientCountry"]==null?string.Empty:Convert.ToString(reader["ClientCountry"]);
        list.ClientProvincy = reader["ClientProvincy"]==null?string.Empty:Convert.ToString(reader["ClientProvincy"]);
        list.ClientCity = reader["ClientCity"] == null ? string.Empty : Convert.ToString(reader["ClientCity"]);
        list.ClientPhone = reader["ClientPhone"] == null ? string.Empty : Convert.ToString(reader["ClientPhone"]);
        list.ClientMobile = reader["ClientMobile"] == null ? String.Empty : Convert.ToString(reader["ClientMobile"]);
        list.ClientFax = reader["ClientFax"] == null ? String.Empty : Convert.ToString(reader["ClientFax"]);
        list.ClientEmail = reader["ClientEmail"] == null ? string.Empty : Convert.ToString(reader["ClientEmail"]);
        list.ClientInfo = reader["ClientInfo"] == null ? string.Empty : Convert.ToString(reader["ClientInfo"]);

        return list;
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:01:35.010

您不能为静态类定义接口。开始重构你的代码，一旦完成，编写一个接口，使用在所有类中重复的相同方法。就像是

```
public interface IClientDAL
{
    string ConnString { get; set; }

    ClientEntity NewClient(ClientEntity client);
    //...
} 
```

最后在所有需要它的类中实现接口。

# c# - 在 webview 控件中加载网页时在 Windows 8 应用程序中显示进度条/环

> ID：15536933
> 
> 赞同：2
> 
> 时间：2013-03-20T23:46:29.627
> 
> 标签：c#, windows-8, microsoft-metro, windows-store-apps

我有在调用异步函数时添加进度条和进度环的经验。这是一项简单的工作，因为它分别仅依赖于进度条和进度环的 IsIndeterminate 和 IsActive 属性。

现在我的问题是，如何在 Windows 8 应用程序的 webview 控件中加载某些网页时在应用程序中显示进度条/环。

我正在搜索一个属性或事件，它告诉 web 视图中的网页当前处于加载状态。如果有人遇到这样的财产，请写下来，如果您有其他解决方案，请告诉它！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T17:19:21.230

首先声明委托

```
public delegate void LoadCompletedEventHandler(  object sender,  NavigationEventArgs e); 
```

在进度条/环必须开始显示的事件区域中逻辑地添加以下代码。

```
ProgressRing1.IsActive = true; //for progress ring
ProgressBar1.IsIndeterminate = true; //for progress bar 
```

添加此行以将控件转移到确定 webview 控件是否已完全加载网页的事件。

```
WebView1.LoadCompleted += new Windows.UI.Xaml.Navigation.LoadCompletedEventHandler(WebView1_LoadCompleted); 
```

定义以下函数来处理网页完全加载时发生的情况（您的目标是此时隐藏进度条/环）

```
void WebView1_LoadCompleted(object sender, Windows.UI.Xaml.Navigation.NavigationEventArgs e)
{
//code for hiding progress bar/ring
ProgressRing1.IsActive = false; //for progress ring
ProgressBar1.IsIndeterminate = false; //for progress bar
} 
```

如需进一步参考，您可以查看此[MSDN](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.navigation.loadcompletedeventhandler)页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T00:29:07.970

[您应该可以在DocumentCompleted](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.documentcompleted.aspx)或中关闭忙`Navigated`，`Navigated`我相信您必须与原始链接进行比较，因为它会在重定向时触发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-01T09:39:04.903

只是一个更正，如果您将它用于手机，那么而不是

```
`new Windows.UI.Xaml.Navigation.LoadCompletedEventHandler(WebView1_LoadCompleted);` 
```

事件处理程序将是

```
`new System.Windows.Navigation.LoadCompletedEventHandler(WebView1_LoadCompleted);` 
```

# c - 如何从文本文件中读取多个数字

> ID：15536935
> 
> 赞同：0
> 
> 时间：2013-03-20T23:46:36.013
> 
> 标签：c, arrays, file-io

所以这是我的代码，我不断收到分段错误。如何格式化此代码以从文件中读取一组数字？

我的输入如下所示： 82, 46, 71, 56, 44, 12, 100 62, 67, 64, 65, 62, 39, 68 68, 90, 78, 57, 76, 45, 82 等

```
#include <stdio.h>

int main ()
{
    FILE *input = fopen("input.txt", "r");

    int line[7];
    int store = 0, read;

    if(!input)
    {
        printf("Error: Filename \"input.txt\" not found!\n");
    }

    store = 0;
    while(fscanf(input, "%d", &read) != EOF)
    {            
        line[store] = read;                 
        store++;
    }

    printf("%d %d %d %d %d %d %d\n", line[0], line[1], line[2], line[3], line[4], line[5], line[6]); 
    return(0);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T23:50:03.923

将您的 while 循环条件更改为：

```
while( store < sizeof(line)/sizeof(int) && fscanf(input, "%d", &read) != EOF) 
```

看起来你在输入中有更多的数字然后你有空间。

# android - 当主页按钮单击带有 actionbarsherlock 的滑动菜单时切换（）

> ID：15536939
> 
> 赞同：1
> 
> 时间：2013-03-20T23:47:05.663
> 
> 标签：android, actionbarsherlock, slidingmenu

这是我的 MainActivity

```
public class MainActivity extends SherlockActivity implements ActionBar.OnNavigationListener {
@Override
protected void onCreate(Bundle savedInstanceState) {
    setTheme(R.style.Theme_Sherlock_Light_DarkActionBar); //Used for theme switching in samples
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    //Hide title bar
    getSupportActionBar().setDisplayShowTitleEnabled(false);

    //Enable home button
    getSupportActionBar().setHomeButtonEnabled(true);

    //Home as up display
    getSupportActionBar().setDisplayHomeAsUpEnabled(true);

    //Sliding menu
    SlidingMenu menu = new SlidingMenu(getBaseContext());
    menu.setMode(SlidingMenu.LEFT);
    menu.setTouchModeAbove(SlidingMenu.TOUCHMODE_FULLSCREEN);
    menu.setShadowWidthRes(R.dimen.shadow_width);
    menu.setShadowDrawable(R.drawable.shadow);
    menu.setBehindOffsetRes(R.dimen.slidingmenu_offset);
    menu.setFadeDegree(0.35f);
    menu.attachToActivity(this, SlidingMenu.SLIDING_CONTENT);
    menu.setMenu(R.layout.slide_menu);
}

public boolean onOptionsItemSelected(MenuItem item) {       
    switch (item.getItemId()) {
        case android.R.id.home:
            //should be something in here that makes it slide to the left
            return true;
    }
    return super.onOptionsItemSelected(item);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    //Used to put dark icons on light action bar
    //boolean isLight = SampleList.THEME == R.style.Theme_Sherlock_Light;

    menu.add("New")
        .setIcon(R.drawable.contentnew)
        .setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);

    menu.add("Search")
        .setIcon(R.drawable.actionsearch)
        .setActionView(R.layout.collapsible_edittext)
        .setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS | MenuItem.SHOW_AS_ACTION_COLLAPSE_ACTION_VIEW);

    getSupportMenuInflater().inflate(R.menu.main, menu);
    return true;
}
} 
```

我想设置单击主页按钮时，它会向左滑动。问题是，我不能`SlidingFragmentActivity`像 jfeinstein10 项目中的例子那样扩展，因为我已经扩展了`SherlockActivity`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T11:47:33.637

您需要更改 SlidingMenu 代码。使`SlidingFragmentActivity`扩展`SherlockFragmentActivity`。然后将 ActionBarSherlock 作为库项目添加到 SlidingMenu。现在您的项目只需将 SlidingMenu 添加为库项目，因为它引用了 ActionBarSherlock。

引自[https://github.com/jfeinstein10/SlidingMenu#setup-with-actionbarsherlock](https://github.com/jfeinstein10/SlidingMenu#setup-with-actionbarsherlock)：

> # 使用 ActionBarSherlock 进行设置
> 
> *   设置如上。
> *   签出 ActionBarSherlock 的干净副本并导入到您的 Eclipse 工作区。
> *   将 ActionBarSherlock 添加为 SlidingMenu 的依赖项
> *   进入您计划使用的 SlidingActivity，使它们扩展`Sherlock___Activity`而不是`___Activity`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T23:55:17.107

你需要从 SlidingFragmentActivity 扩展，如果你不这样做，你甚至不能调用切换或设置菜单片段。如果你从 SFA 扩展它会是这样的：

```
case android.R.id.home:
    toggle();
    return true; 
```

# r - R中的rpart包 - 决策树在每个叶节点中给出不正确的行数标签（'n = ###'）

> ID：15536944
> 
> 赞同：0
> 
> 时间：2013-03-20T23:47:25.623
> 
> 标签：r, rpart

我正在使用 R 中的 rpart 包从名为“myData”的数据框中创建决策树模型。它有 85,590 行。

决策树是使用这样的代码创建的（关键部分是'data = myData'）：

> decTree <- rpart(结果 ~ var1 + var2 + ..., data = myData, method = "anova", control = rpart.control(minsplit=30))

如果我绘制并标记此决策树的“叶”（终端）节点，我会在第一个节点的“左侧”得到 66,667 的初始分割，在右侧得到 18,923 的初始分割（总计行数为 85,590 ，正如预期的那样。）

> plot(decTree) # 绘制树
> 
> text(decTree, use.n = TRUE) #标记树

创建此初始拆分的规则是 var1 < 1.5。

但是，如果我计算 myData 中 var1 < 1.5 的行数，我得到 79,518，而不是预期的 85,590（如果我计算 var1 >= 1.5 的行，我得到 6,072 的“补码”，而不是预计树中显示 18,923。）

> 长度（其中（myData$var1 < 1.5））
> 
> [1] 79518

我意识到你不可能自己重现这种行为（以前的 rpart 模型在节点数方面对我来说是正确的，所以不知道为什么我这次遇到了麻烦），但我希望有人以前遇到过这个问题，或者在我的代码中发现一些愚蠢的错误......

我尝试再次重新运行它，但仍然得到所有相同（不匹配）的叶子计数。

另外，我检查了 myData$frame，肯定不仅仅是“n = ...”标签是错误的；$frame 值与图中显示的值匹配（并且与我自己所做的计数不匹配。）

> decTree$帧

最后，'var1' 值都不是 NA。IE：

> 长度（其中（is.na（myData$var1）））
> 
> [1] 0

# ruby-on-rails - Rails：将关联作为参数传递

> ID：15536945
> 
> 赞同：0
> 
> 时间：2013-03-20T23:47:30.350
> 
> 标签：ruby-on-rails, associations, parameter-passing

在我的模型中，我有几个关联，例如：

```
has_many :posts
has_many :comments, :through => :posts
belongs_to :user 
```

我还有一个方法，我想收集关联的对象，由参数指定：

```
def selected_associations(*associations)
  associations.collect{|association| self.association}
end 
```

问题是，我如何通过`*associations`？我试过用一组符号这样做：

```
self.selected_associations([:posts, :comments]) 
```

但这不起作用。也不会将它们作为字符串传递。也许我没有以正确的方式接近这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:58:22.333

这里有两点。

首先，`self.association`行不通。您需要将其更改为：

```
def selected_associations(*associations)
  associations.collect{|association| self.public_send(association)}
end 
```

关于方法调用，您需要作为散列传递。

```
selected_associations :posts, :comments 
```

最好的。

# backbone.js - 骨干网 - 地理位置

> ID：15536948
> 
> 赞同：0
> 
> 时间：2013-03-20T23:47:44.727
> 
> 标签：backbone.js, geolocation, maps

我是一个新的 Backbone 用户，并开始在其中实施 Google 地图。我在 de View 对象中设置了这个。我工作得很好，但是当我转到另一个页面（带有导航器对象的模板）并返回到带有谷歌地图的页面时，当前位置不在谷歌地图上市场。

在我的视图下面我的代码

```
DFM.MapView = Backbone.View.extend({

el: $("#content"),

template: $("#rankings_template").html(),

// Initialiseren
initialize: function(){

    self = this;
    this.render();

    var location_destiny = new google.maps.LatLng(52.476716,4.799623);

    var map = new google.maps.Map(document.getElementById('google_maps'), {
        center: location_destiny,
        zoom: 13,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        panControl: false,
        zoomControl: false,
        mapTypeControl: false,
        scaleControl: false,
        streetViewControl: false,
        overviewMapControl: false

    });

    if(navigator.geolocation){

        navigator.geolocation.watchPosition(update_user_location, error_handler, {
            enableHighAccuracy: true,
            frequency: 3000
        });

    } else {
        console.error('Geolocation: 0 - Geotracking not available'); 
    }

    // Update user location
    function update_user_location(position){
        location_user = new google.maps.LatLng(52.474716,4.798623);

        var marker_user = new google.maps.Marker({
             title: 'Gebruiker',
             position: location_user,
             map: map,
             draggable: true,
        });
    }

    // Error handler
    function error_handler(error){
        console.error('Geolocation: ' + error.code + ' - ' + error.message);
    }

    var marker_destiny = new google.maps.Marker({
         title: 'Bestemming',
         position: location_destiny,
         map: map,
         draggable: true,
    });
},

render: function(){

    this.$el.html(_.template(this.template));

    return this;
} 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T22:34:20.193

不确定我的问题是否正确，但对我来说，`google.maps.event.trigger(map,'resize');`每次触发地图路线后它都会帮助我打电话。

PS：有点晚了，但也许它可以帮助将来的人

# android - Android：iosched 克隆资源/api 问题

> ID：15536949
> 
> 赞同：0
> 
> 时间：2013-03-20T23:47:47.783
> 
> 标签：android, ant, actionbarsherlock, android-library, iosched

我正在使用 Ant 编译 iosched 的克隆，但遇到了错误。很多，实际上，但我确信它来自一些我没有看到的简单的东西。

`ant debug`在 aapt 捆绑资源 时运行时：`[aapt] C:\DEV\IOSCHED\android\res\values-v14\abs__themes.xml:32: error: Error retrieving parent for item: No resource found that matches the given name 'android:Theme.Holo.Light.Dialog'.`

还有很多类似的错误。我被告知这是一个构建目标错误，但`abs`库`project.properties`和 AndroidManifest 都针对 API15。（minTarget 7，默认）。我已经完成`ant clean`了。

有任何想法吗？更具体地说，更熟悉 aapt 或 android 编译过程的人可以告诉我这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-01T09:59:09.063

对于快速解决方案，您可以从 eclipse 移植版本 iosched 2013 在这里克隆：

[https://github.com/yodiaditya/iosched-2013-eclipse](https://github.com/yodiaditya/iosched-2013-eclipse)

# java - Java信号处理然后返回主程序

> ID：15536952
> 
> 赞同：0
> 
> 时间：2013-03-20T23:48:05.507
> 
> 标签：java, signals, sigint

MI有一个以for循环开头的程序，它旋转了10次，一个循环持续一秒钟。我需要处理一个信号（CTRL+C），在处理它时，它应该做它自己的 for 循环，在它停止之后，我应该返回到主循环。我已经设法完成了上面的几乎所有事情，但是循环不会单独执行。他们并行进行。希望你能帮忙...谢谢:)

顺便说一句，我的代码是：

```
import sun.misc.Signal;
import sun.misc.SignalHandler;

public class MySig {

    public static void shhh(int s){ //s -> seconds :)
        s = s*1000;
        try{
            Thread.sleep(s);
        }catch(InterruptedException e){
            System.out.println("Uh-oh :(");
        }
    }

  public static void main(String[] args){
      Signal.handle(new Signal("INT"), new SignalHandler () {
      public void handle(Signal sig) {
      for(int i=0; i<5; i++){
        System.out.println("+");
        shhh(1);
    }
    }
    });
    for(int i=0; i<10; i++) {
      shhh(1);
      System.out.println(i+"/10");
    }
  } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:37:14.883

对，根据文档， SignalHandler 在单独的线程中执行：

> ...当 VM 接收到信号时，特殊的 C 信号处理程序会创建一个新线程（优先级为 Thread.MAX_PRIORITY）来运行已注册的 Java 信号处理程序。

如果要在处理程序执行时停止主循环，可以添加锁定机制，如下所示：

```
private static final ReentrantLock lock = new ReentrantLock(true);
private static AtomicInteger signalCount = new AtomicInteger(0);

public static void shhh(int s) { // s -> seconds :)
    s = s * 1000;
    try {
        System.out.println(Thread.currentThread().getName() + " sleeping for "
                + s + "s...");
        Thread.sleep(s);
    } catch (InterruptedException e) {
        System.out.println("Uh-oh :(");
    }
}

public static void main(String[] args) throws Exception {
    Signal.handle(new Signal("INT"), new SignalHandler() {
        public void handle(Signal sig) {
            // increment the signal counter
            signalCount.incrementAndGet();
            // Acquire lock and do all work
            lock.lock();
            try {
                for (int i = 0; i < 5; i++) {
                    System.out.println("+");
                    shhh(1);
                }
            } finally {
                // decrement signal counter and unlock
                signalCount.decrementAndGet();
                lock.unlock();
            }
        }

    });
    int i = 0;
    while (i < 10) {
        try {
            lock.lock();
            // go back to wait mode if signals have arrived
            if (signalCount.get() > 0)
                continue;
            System.out.println(i + "/10");
            shhh(1);
            i++;
        } finally {
            // release lock after each unit of work to allow handler to jump in
            lock.unlock();
        }
    }
} 
```

可能有更好的锁定策略。

# php - 从 txt 文件追加到动态创建的列表，PHP

> ID：15536955
> 
> 赞同：0
> 
> 时间：2013-03-20T23:48:17.210
> 
> 标签：php, file-handling, createelement

PHP 新手，并且一直在为如何在 PHP 中创建列表元素而苦苦挣扎，但似乎无法理解它是如何工作的，尽管它很像 javascript……我有一个 txt 文件，我正在附加信息从一个表单到并想要附加前两个；提交表单时将文本块分隔到动态创建的列表元素？如何创建列表元素以及如何将 txt 文件中的信息添加到其中？

现在我在 php 中有这段代码，它可以与 txt 文件中的回显信息一起使用，但我无法创建列表元素并附加文本，任何提示将不胜感激？

```
<?php                       
                    if(isset($_POST['button'])) {
                        if( $_POST['filmnamn'] != "" &&    $_POST['betyg'] != "" &&    $_POST['link'] != "" &&    $_POST['photo'] != "" &&    $_POST['description'] != "") {
                            $myFile = 'demo.txt';
                            $titel = $_POST['filmnamn'] . ";" ;
                            $betyg = $_POST['betyg'] . ";" ;
                            $link = $_POST['link'] . ";" ;
                            $photo = $_POST['photo'] . ";" ;
                            $desc = $_POST['description'].PHP_EOL;
                            $data = "$titel$betyg$link$photo$desc";
                            $fh = fopen($myFile, 'a');
                            fseek($fh, 0, SEEK_SET);
                            fwrite($fh, $data);
                            fclose($fh);

                            $filename = ('demo.txt');
                            $handle = fopen($filename, 'r');
                            $fileinfo = fread($handle, filesize($filename));
                            $fileinfo_array = explode(';', $fileinfo);
                            echo $fileinfo_array[0].$fileinfo_array[1];

                            $div = getElementById('filmlista');
                            $list = createElement("li", $fileinfo_array[0]);
                            $list->setAttribute("class","listan");
                            $div->appendChild($list);

                        }
                    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:59:00.700

似乎您正在尝试使用 php 来更改现有的 html，这是可能的，但不是常规使用。

通常，php 从模板中获取有关布局的信息和数据库中的信息，并以您想要的任何方式将它们组合在一起。

尝试 smarty 并阅读 mvc 设计。 [http://www.smarty.net/crash_course](http://www.smarty.net/crash_course)

或者随心所欲地服用红色药丸和代码。

天哪！;-)

# regex - Linux 正则表达式 - 删除文件

> ID：15536956
> 
> 赞同：0
> 
> 时间：2013-03-20T23:48:26.207
> 
> 标签：regex, linux, unix

我想删除具有多个子目录的目录中以“〜”结尾的所有文件。

有什么安全的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-20T23:57:48.193

你可以试试：

```
find <directory in question> -name "*~" -delete 
```

你说你有很多子目录的地方`<directory in question>`应该是最顶层的目录。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T23:55:33.193

您可以使用`find`来查找和`rm`删除它们。例如，在`/tmp`：

```
 find /tmp -name *~ -exec rm '{}' \; 
```

实际上，在这种情况下，最`-delete`好像 Fred 的回答那样使用，但我会留下这个，因为它展示了如何使用`find`它来对它找到的文件执行任何命令，而不仅仅是`rm`.

# django - 无法成功将 devserver 补丁合并在一起以部署到 Heroku

> ID：15536958
> 
> 赞同：0
> 
> 时间：2013-03-20T23:48:37.010
> 
> 标签：django, heroku, python-2.7, django-admin

我试图将我的新代码推送到 Heroku，但我遇到了一个`ImportError`说：

```
Starting process with command `python manage.py runserver --insecure 0.0.0.0:13192 --noreload`
Traceback (most recent call last):
    execute_from_command_line(sys.argv
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/__init__.py", line 272, in fetch_command
    klass = load_command_class(app_name, subcommand)
File "manage.py", line 10, in <module>
File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/__init__.py", line 453, in execute_from_command_line
  File "/app/.heroku/python/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
    __import__(name)
    from django.core.servers.basehttp import AdminMediaHandler, WSGIServerException, \
  File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/__init__.py", line 392, in execute
File "/app/.heroku/python/lib/python2.7/site-packages/devserver/management/commands/runserver.py", line 3, in <module>
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "/app/.heroku/python/lib/python2.7/site-packages/django/core/management/__init__.py", line 77, in load_command_class
  utility.execute()
ImportError: cannot import name AdminMediaHandler 
```

我在文档中发现`django.core.servers.basehttp.AdminMediaHandler`从 1.4 开始将被替换为`django.contrib.staticfiles.handlers.StaticFilesHandler`. 我的问题是我在哪里`StaticFilesHandler`放置`AdminMediaHandler`？

更新：我现在尝试通过提出`git+git://github.com/dcramer/django-devserver#egg=django-devserver`我的要求将两个补丁合并在一起。但是我在尝试部署时仍然收到同样的错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T16:39:16.867

无需尝试将 django-devserver 的补丁合并在一起。Django-devserver 0.5.0 与 Django 1.5 兼容，一旦我将“django-devserver 0.5.0”放在我的 requirements.txt 中，我的应用程序就可以部署而不会崩溃。

# php - 来自另一个页面的范围的值

> ID：15536962
> 
> 赞同：-1
> 
> 时间：2013-03-19T14:25:17.470
> 
> 标签：php, html, javascript

我想要一个有范围的程序，最后我想给用户所有的结果。

首先是范围

**Javascript**：

```
 function imgShow(Target)
 {
   for(var i=1; i<=images; i++)
   {
        if(i != Target) 
          document.getElementById('img' + i).style.display = 'none';
        else 
          document.getElementById('img' + i).style.display = 'block';
   }
 } 
```

**HTML**

```
 <input type="range" id="slider" max="<?php echo ($images*1); ?>" min="1"
   value="1" onchange="imgShow(parseInt(this.value/1));" />
 <output>
  <?php 
    for ($i=0; $i<$images; $i++){
      $image = $files[$i];
      echo '<div id="img' . ($i+1) . '" class="photo" style=""><img src="' . $image . '" /></div>';
    }
  ?>
</output> 
```

> ***上面的代码很好（我写这个是为了让你知道我使用了哪些变量）***

你看我每次改变图像时都会给出范围的值。然后**我的问题**是，我需要从上面获取结果并将它们放在另一个页面中，这样我就可以将它放在数据库中。我想在文本区域的其他页面中显示它，以便用户知道他们在测试中的得分。

```
 echo '<form action="'. $_SERVER["PHP_SELF"] .'" method="post">';
 echo 'Solution:<br>';
 echo '<textarea name="message"></textarea><br>';
 echo '</form>'; 
```

我想我需要在 textarea 之间写一些东西，但我不知道是什么。已经尝试了一些东西。是的，因为我在“if($_SERVER[REQUEST_METHOD]=='POST')”的 else 中执行此操作。

我真的希望有人可以帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T16:34:06.777

您可以使用以下`switch`功能将用户引导到更合适的页面：http: [//php.net/manual/en/control-structures.switch.php](http://php.net/manual/en/control-structures.switch.php)

在将结果保存到数据库时，也许这会对您有所帮助：[How to pass javascript variables to a database](https://stackoverflow.com/questions/13337807/how-to-pass-javascript-variables-to-a-database)

我想说的是，当您生成指向下一页的链接时，请将`post`函数放在该链接中。希望有帮助。

# perl - 通过分隔符将文件拆分为单行

> ID：15536965
> 
> 赞同：1
> 
> 时间：2013-03-20T23:49:02.840
> 
> 标签：perl

嗨，我有以下文件：

```
>101
ADFGLALAL
GHJGKGL
>102
ASKDDJKJS
KAKAKKKPP
>103
AKNCPFIGJ
SKSK 
```

等等等等；

我需要以下格式：

```
>101
ADFGLALALGHJGKGL
>102
ASKDDJKJSKAKAKKKPP
>103
AKNCPFIGJSKSK 
```

我怎样才能做到这一点？也许是 perl one 班轮？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T23:55:13.263

```
perl -npe 'chomp if ($.!=1 && !s/^>/\n>/)' input 
```

`chomp`如果`>`开头没有（`!s/^>/\n>/`为假） ，则删除末尾的换行符（ ）。此外，如果这不是第一行 ( `$.!=1`) 并且`>`在行的开头有一个 ( )，则在该行的开头添加一个换行符`s/^>/\n>/`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T23:56:33.533

```
perl -lne '
    if (/^>/) {print}
    else{
        if ($count) {
            print $string . $_;
            $count = 0;
        } else {
            $string = $_;
            $count++;
        }
    }
' file.txt 
```

# c# - 在 C# 中将击键发送到应用程序（sendkeys、postmessage、sendmessage 都不起作用）

> ID：15536980
> 
> 赞同：7
> 
> 时间：2013-03-20T23:50:38.330
> 
> 标签：c#, .net, windows, keyboard-events, sendkeys

我正在尝试执行以下操作之一 1\. 打开所需的程序并以编程方式按下一个键 2\. 找到程序的打开窗口并以编程方式按下一个键（两者都可以）

我尝试了许多 SendKeys.SendWait()、PostMessage() 和 SendMessage() 的实现，但均未成功。以下是我的代码片段

```
 //included all these for attempts 
    [DllImport("User32.dll")] 
    static extern IntPtr FindWindow(string lpClassName, string lpWindowName);  

    [DllImport("User32.dll")] 
    static extern int SetForegroundWindow(IntPtr hWnd);

    [DllImport("User32.Dll", EntryPoint = "PostMessageA")]
    static extern bool PostMessage(IntPtr hWnd, uint msg, int wParam, int lParam);

    [DllImport("user32.dll")]
    static extern byte VkKeyScan(char ch);

    [DllImport("user32.dll", CharSet = CharSet.Auto)]
    static extern IntPtr SendMessage(IntPtr hWnd, UInt32 Msg, IntPtr wParam, IntPtr lParam); 
```

获取窗口句柄，sendmessage/postmessage/sendkeys 使用的变量

```
IntPtr ptrOBS = proc.Handle;//this works properly, proc is instantiated properly
//IntPtr ptrOBS = FindWindow(null, "Open Broadcaster Software v0.472b");
SetForegroundWindow(ptrOBS);
const UInt32 WM_CHAR = 0x0102;
const uint WM_KEYDOWN = 0x100;
const int VK_R = 0x52; // taken from http://msdn.microsoft.com/en-us/library/dd375731(v=vs.85).aspx
const int VK_S = 0x53; 
```

发送消息尝试：

```
SendMessage(ptrOBS, WM_KEYDOWN, (IntPtr)VK_R, (IntPtr)1);//tried both WM_CHAR and WM_KEYDOWN 
```

PostMessage 尝试：

```
string message = "rs";
bool sent = PostMessage(ptrOBS, WM_KEYDOWN, VkKeyScan(message[0]), 0); 
```

SendKeys 尝试：

```
SendKeys.SendWait("{r}"); 
```

在父窗口（应用程序）和子窗口（由按键触发的按钮即时发送）上尝试了 SetFocus：

```
static void SetFocus(IntPtr hwndTarget, string childClassName)
    {
        // hwndTarget is the other app's main window 
        // ...
        IntPtr targetThreadID = GetWindowThreadProcessId(hwndTarget, IntPtr.Zero); //target thread id
        IntPtr myThreadID = GetCurrentThread(); // calling thread id, our thread id
        try
        {
            bool lRet = AttachThreadInput(myThreadID, targetThreadID, -1); // attach current thread id to target window

            // if it's not already in the foreground...
            lRet = BringWindowToTop(hwndTarget);
            SetForegroundWindow(hwndTarget);

            // if you know the child win class name do something like this (enumerate windows using Win API again)...
            IntPtr hwndChild = (IntPtr)1183492;//(IntPtr)EnumAllWindows(hwndTarget, childClassName).FirstOrDefault();

            if (hwndChild == IntPtr.Zero)
            {
                // or use keyboard etc. to focus, i.e. send keys/input...
                // SendInput (...);
                return;
            }

            // you can use also the edit control's hwnd or some child window (of target) here
            SetFocus(hwndChild); // hwndTarget);
            SendKeys.SendWait("{r}");
        }
        finally
        {
            SendKeys.SendWait("{r}");
            bool lRet = AttachThreadInput(myThreadID, targetThreadID, 0); //detach from foreground window
            SendKeys.SendWait("{r}");
        }
    } 
```

对于 NSGaga：

```
 string windowName = "Open Broadcaster Software v0.472b";
IntPtr outerPtr = FindWindow(null, windowName);
IntPtr ptrOBS = (IntPtr)527814;//button that im trying to trigger keypress on
SetForegroundWindow(outerPtr);
SetForegroundWindow(ptrOBS);
SetFocus(outerPtr, "OBSWindowClass");//SetFocus(ptrOBS, "Button");
const UInt32 WM_CHAR = 0x0102;
const int VK_R = 0x52; // taken from http://msdn.microsoft.com/en-us/library/dd375731(v=vs.85).aspx
const int VK_S = 0x53;

//SetForegroundWindow(ptrOBS);
System.Threading.Thread.Sleep(3000);
SendKeys.SendWait("{r}");
SendMessage(outerPtr, WM_KEYDOWN, (IntPtr)VK_R, (IntPtr)1);
PostMessage(outerPtr, WM_KEYDOWN, VkKeyScan('r'), 0); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T00:02:40.797

[您不能可靠地使用`SendMessage`和`PostMessage`来合成键盘输入](http://blogs.msdn.com/b/oldnewthing/archive/2005/05/30/423202.aspx)。它们只是不是为此而设计的。当键盘输入被接收、处理并转发给适当的接收者时，这些消息（`WM_CHAR`、`WM_KEYDOWN`等）是由较低级别的子系统发出的*通知。*自己发送或发布这些消息就像是在恶作剧地打电话给某人。

`SendKeys`（与所有其他输入合成器方法一样，包括[`SendInput`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646310.aspx)为合成键盘输入而明确设计的功能，并且至少在某些实现中是`SendKeys`实际使用的功能）仅当您希望接收键盘输入的窗口具有焦点时才有效。在 Windows 中，只有焦点（活动）窗口接收输入事件。

如果您想让它工作（或者 P/Invoking 及其所有相关结构），那么`SendKeys`可能是要走的路`SendInput`，但是您确实需要尊重收件人窗口*必须*具有焦点的警告。否则，它什么也得不到。

从您的示例代码看来，您正在尝试使用该[`SetForegroundWindow`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633539.aspx)函数来满足此先决条件。不幸的是，您传递给它的是一个无效值，并且没有进行任何可能提醒您注意此错误的错误检查。具体来说，这段代码是错误的：

```
IntPtr ptrOBS = proc.Handle;//this works properly, proc is instantiated properly
SetForegroundWindow(ptrOBS); // WRONG, ptrOBS is not a window handle 
```

即使我相信您`ptrOBS`正确初始化，这也使它成为*process的有效句柄，这与**window*的有效句柄完全不同。除了明显的名义差异之外，进程可以有多个窗口，并且只有一个窗口可以具有焦点（即，“在前台”）。

您需要在调用之前获取特定窗口的句柄`SetForegroundWindow`，并且鉴于我们知道一个进程可以有多个窗口，这可能会很棘手。您需要一些可靠的方法来确定您想要的窗口。许多人通过将窗口名称硬编码为字符串来实现这一点，这在重新编译目标应用程序并且此实现细节发生变化之前效果很好。我能想到的唯一防弹方法是让用户*单击*目标窗口和您的代码来检索当前位于鼠标指针下的窗口句柄。

当然，所有这些都假设您已经遵守了使用 的限制，`SetForegroundWindow`在链接的 SDK 文档的“备注”部分中列举了这些限制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T00:44:38.773

有很多试验和错误，才能让它工作
这是我之前发布的一些代码，你可能想试一试（并且附加了一些更多信息）......

[Pinvoke SetFocus 到特定控件](https://stackoverflow.com/questions/9503027/pinvoke-setfocus-to-a-particular-control/9547099#9547099)

尝试首先设置焦点（使用提到的机制） - 然后使用`SendKeys`or `SendInput`。

这是一些详细的代码`SendInput`...

[如何将字符串发送到其他应用程序，包括 Microsoft Word](https://stackoverflow.com/questions/8884763/how-to-send-a-string-to-other-application-including-microsoft-word)

# dynamics-crm-2011 - 访问 iFrame 中的 HTML 控件

> ID：15536981
> 
> 赞同：4
> 
> 时间：2013-03-20T23:50:40.683
> 
> 标签：dynamics-crm-2011

如何从 CRM 中的 javascript 访问 iframe 中的 html 控件？

我有：

```
 var height = document.getElementById("IFRAME_TransactionProduct_RA").contentWindow.document.getElementById("txt").value; 
```

但这会导致“页面错误”并且内容未加载。

我要访问的元素是 id 为“txt”的 html 输入：

```
 <input id="txt" type="hidden" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T05:50:39.843

下面是如何将值从 CRM 字段复制到 IFRAME 中嵌入的 HTML 控件中的控件的示例。我假设 Web 资源和字段的名称。你必须适应这些。如果 CRM 抛出异常，您也可能会抛出一个*try-catch*（开了个玩笑？），请注意我是在手机上输入代码，所以某处**可能**有错字（自动更正，是的）。

```
var source = Xrm.Page.data.entity.attributes.get("oneCoolField")
var information = source.getValue();

var customHtml = Xrm.Page.ui.controls.get("WebResource_EmbeddedHtmlContent");
var destination = customHtml.getObject().contentWindow.document;
if(destination) {
  var customControl = destination.getElementById("elementToAccess");
  if(customControl) {
    customControl.value = information;
  }
} 
```

编辑：

这使您可以访问网络资源。

```
var customHtml = Xrm.Page.ui.controls.get("WebResource_EmbeddedHtmlContent"); 
```

这将带您进入 IFRAME 的 DOM。

```
var destination = customHtml.getObject().contentWindow.document; 
```

这将使您进入自定义页面上的控件。

```
var customControl = destination.getElementById("elementToAccess"); 
```

这将为您提供控件的内容。

```
var contents = customControl.innerHTML; 
```

您的计算机上哪个部分出现故障？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-29T09:04:04.227

**使用 jQuery：**

```
$(Xrm.Page.ui.controls.get('IFRAME_TransactionProduct_RA').getObject()).contents().find('#txt').val(); 
```

**纯JS：**

```
Xrm.Page.ui.controls.get('IFRAME_TransactionProduct_RA').getObject().contentWindow.document.getElementById('txt').value; 
```

*[http://msdn.microsoft.com/en-us/library/gg334266.aspx#BKMK_getObject](http://msdn.microsoft.com/en-us/library/gg334266.aspx#BKMK_getObject)*

# php - Windows 7 (x64) PHP 5.4.7 上的作曲家

> ID：15536983
> 
> 赞同：0
> 
> 时间：2013-03-20T23:50:46.403
> 
> 标签：php

我在作曲家和 PHP 方面不是新手，我已经在 Linux 和 Windows 上使用了很多时间，但是今天我遇到了一个问题。

今天我尝试`use composer update / composer install`在我的 Windows 7 上运行，然后出现异常：“ **Composer 找不到配置文件：** ”这很奇怪，因为它在几天前工作。

我尝试使用最新的 composer.phar 并尝试使用 Composer-Setup.exe 安装的 composer，我还尝试将 composer.phar 放在不同的位置（项目位置等），它总是抛出相同的异常。

当我运行 composer validate 命令时，我得到：*./composer.json is valid*，所以 composer.json 被发现并且是​​有效的。

感谢所有答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-25T14:56:39.853

从环境变量中删除作曲家路径和变量并重新启动（重新启动）Windows。然后再次添加变量和路径

# jquery - 带有 jQ uery 验证错误的 CSS 表单布局

> ID：15536984
> 
> 赞同：1
> 
> 时间：2013-03-20T23:50:51.860
> 
> 标签：jquery, css, jquery-validate

我有一个用 CSS 设置样式的表单，可以正确排列文本框。我在表单中使用[jQuery Validation](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)。由于验证产生的错误，我在提交表单时遇到了布局问题。我的CSS如下：

```
#form p label {
    padding-top: 5px;
    display: block;
    width: 100px;
    float: left;
} 
```

我知道`float: left;`导致问题的原因。我正在寻找在不改变布局的情况下出现在每个文本框旁边的错误。jQuery 验证错误的类是`.errors`. 我制作了一个[jsFiddle](http://jsfiddle.net/K5fR8/)来重新创建我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:21:11.070

在错误元素上使用绝对定位将使您的表单在错误时保持不变。然而，这将需要额外的标记来维护您的表单显示。在此示例中，在您的输入字段中添加了一个包装器，`<span class="item"></span>`以为错误元素提供位置边界。

请注意，为`label`元素设置的属性也会影响您的错误标签。

有关示例，请参见[http://jsfiddle.net/K5fR8/3/ 。](http://jsfiddle.net/K5fR8/3/)

完整标记如下：

**HTML**

```
<form id="form" action="" method="post">
<p>
    <label for="email">Email:</label>
    <span class="item">
        <input type="text" name="email" id="email" placeholder="Email" value="" class="required" />
    </span>
</p>
<p>
    <label for="password">Password:</label>
    <span class="item">
        <input type="password" name="password" id="password" placeholder="Password" value="" class="required" />
    </span>
</p>
<p>
    <label for=""></label>
    <input type="submit" name="submit" id="submit" value="Log In" class="button" />
</p> 
```

**CSS**

```
#form p label {
    padding-top: 5px;
    display: block;
    width: 100px;
    float: left;
}

#form p .item {
    position: relative;
}

#form p .item label.error {
    float: none;
    position: absolute;
    top: 0;
    right: -100px; /* Offset by width set on label element */
    padding: 0px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:28:33.200

您的元素 CSS 以页面上的**所有**`label`元素为目标，因此它覆盖了插件使用的元素以显示表单错误。 **`label``label`**

 **简单地添加这个 CSS 只会将`label`插件使用的元素设置*回默认值*，而不会影响任何其他`label`元素。

```
#form p label.error {
    float: none;
    display: inline;
} 
```

**演示：http: [//jsfiddle.net/4Wspp/](http://jsfiddle.net/4Wspp/)**

* * *

**编辑**：

我的回答解决了您的问题，但如果您想更多地利用 jQuery，您应该使用 jQuery 插件查看另一个选项以获得精美的工具提示。

演示：http: [//jsfiddle.net/kyK4G/](http://jsfiddle.net/kyK4G/)

从这个 SO 答案： [https ://stackoverflow.com/a/14741689/594235](https://stackoverflow.com/a/14741689/594235)**

# php - 标记和重构包含分隔名称-值对的字符串

> ID：15536986
> 
> 赞同：1
> 
> 时间：2013-03-20T23:50:56.330
> 
> 标签：php, arrays, string, explode, implode

我有一个结构如下的字符串：

```
 "01;AA:02;AB:03;AC:" 
```

有没有办法使它变成 $_POST 样式格式，其中：

```
 $MyVar['01'] = "AA"
 $MyVar['02'] = "AB"
 $MyVar['03'] = "AC" 
```

?

当我完成更改时，我还想以某种方式将其内爆回原始字符串格式。（内爆时不需要前导零，爆炸时可能不存在）

编辑：添加信息

```
 InevntorySKU;InventoryQTY:
     086;99:043;99:130;99:131;99:132;99:133;99:134;99:135;99:136;99:137;99:138;99:139;99:140;99:141;99:142;99:143;99: 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T23:53:07.643

没有内置函数可以执行此操作，但您可以这样做：

```
$MyVar = array();
foreach(array_filter(explode(":",$input)) as $i) {
    list($k,$v) = explode(";",$i,2);
    $MyVar[$k] = $v;
} 
```

您可以为相反的过程使用类似的设置：

```
$output = "";
foreach($MyVar as $k=>$v) $output .= $k.";".$v.":"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:08:25.227

使用 preg_match_all：

```
preg_match_all('/\d{2}|[a-z]{2}/i', "01;AA:02;AB:03;AC:", $array);

for($i=0;$i<count($array[0]);$i+=2){
    $myvar[$array[0][$i]] = $array[0][$i+1];
}

print_r($myvar); 
```

* * *

使用 preg_split：

```
$str = '086;99:043;99:130;99:131;99:132;99:133;99:134;99:135;99:136;99:137;99:138;99:139;99:140;99:141;99:142;99:143;99:';
$array = preg_split('/;|:/', $str);

for($i=0;$i<count($array)-1;$i+=2){
    $myvar[$array[$i]] = $array[$i+1];
}

print_r($myvar); 
```

# python-2.7 - Python 中的服务器：无需重定向即可在 URL 上写入或添加参数

> ID：15536989
> 
> 赞同：1
> 
> 时间：2013-03-20T23:51:03.670
> 
> 标签：python-2.7, cherrypy

我需要使用 CherryPy 和 Python 版本 2.7.3 处理 Url 的命令

我想更改网址。

旧网址是

```
localhost:8080 
```

并在 URL 中自动添加`foo=1&foo=2`（**变量 s ）**

```
localhost:8080?=foo=1&foo=2

import cherrypy
import urllib

class Root(object):
    @cherrypy.expose
    def index(self):
        jsondict = [('foo', '1'), ('foo', '2')]
        s = urllib.urlencode(jsondict)
        print s
        #foo=1&foo=2

        return "Hello"

cherrypy.config.update({
    'global': {
        'server.socketPort': 8080
    }
})
cherrypy.quickstart(Root()) 
```

有解决办法吗？

使用建议的 Andrew `raise cherrypy.HTTPRedirect("localhost:8080?" + params).`

这是有效的，但这是用于重定向。

我对此不感兴趣，但使用重定向写在新的 url 上。

我不想要重定向，但我总是在这个 url 上工作，添加没有重定向的查询字符串。

有可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T11:59:15.770

只是一个简单的重定向呢？

```
import cherrypy

class Root(object):
    @cherrypy.expose
    def index(self):
        urlVar = 1
        urlVar2 = 2
        raise cherrypy.HTTPRedirect("localhost:8080?foo=" + str(urlVar) + "&fooo=" + str(urlVar2))

cherrypy.config.update({
    'global': {
        'server.socketPort': 8080
    }
})
cherrypy.quickstart(Root()) 
```

# java - 是否可以通过动作监听器为框架创建新按钮？

> ID：15536990
> 
> 赞同：0
> 
> 时间：2013-03-20T23:51:09.137
> 
> 标签：java, swing, jbutton

这是我的代码，我想知道每次单击实例框架中的现有按钮之一时是否可以将新按钮添加到网格布局中。

```
public class Board {

        public static void main(String[] args) {
            JButton[] button = new JButton[40];
            int i = 0;
            JFrame frame = new JFrame();
            frame.setLayout(new GridLayout(20, 20, 15, 15));
            while (i < 40) {
                button[i] = new JButton("button" + i);
                button[i].addActionListener(new Action());
                frame.add(button[i]); 
                i++;
            }
            frame.setSize(700, 700);
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.setVisible(true);
        }

        static class Action implements ActionListener{
            @Override
            public void actionPerformed (ActionEvent e){

            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:01:53.277

解决方案相当简单。

你需要做的是思考问题。首先，您有一堆`static`确实不是必需的参考资料，并且给您带来的好处很少。

现在，说了这么多。您`Action`需要一些方法来知道在哪里添加按钮。为了做到这一点，`Action`需要引用要添加按钮的容器...

```
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;

public class Board {

    public static void main(String[] args) {
        new Board();
    }

    public Board() {
        JButton[] button = new JButton[40];
        int i = 0;
        JFrame frame = new JFrame();
        frame.setLayout(new GridLayout(20, 20, 15, 15));
        Action action = new Action(frame);
        while (i < 40) {
            button[i] = createButton(i);
            button[i].addActionListener(action);
            frame.add(button[i]);
            i++;
        }
        action.setCount(i);
        frame.setSize(700, 700);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setVisible(true);
    }

    public JButton createButton(int index) {

        return new JButton("button" + index);

    }

    public class Action implements ActionListener {

        private JFrame frame;
        private int count;

        public Action(JFrame frame) {
            this.frame = frame;
        }

        public void setCount(int count) {
            this.count = count;
        }

        @Override
        public void actionPerformed(ActionEvent e) {
            JButton btn = createButton(count);
            btn.addActionListener(this);
            frame.add(btn);
            frame.revalidate();
            count++;
        }
    }
} 
```

# jquery - Jquery 和 MYSQL 和 AJAX 不会按 id 调用函数

> ID：15536995
> 
> 赞同：0
> 
> 时间：2013-03-20T23:51:45.560
> 
> 标签：jquery, mysql, ajax

我正在尝试使用 jquery 和 ajax 来更新 mysql 数据库。我能够添加新记录并让脚本正确附加 html。现在我需要为表格的每一行添加一个 ID，以便我可以编辑任何行的信息。我正在调用函数 editCompany(id) 将 id 传递给脚本，但我无法让它工作。

运行脚本时，出现错误“属性 editCompany() 的值为 null 或未定义，不是函数对象”

有什么想法吗？

```
<html>
    <head>
        <title><?=$settings['title']?></title>
            <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
            <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
            <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
            <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
            <style>
                body { font-size: 62.5%; }
                label, input { display:block; }
                input.text { margin-bottom:12px; width:95%; padding: .4em; }
                fieldset { padding:0; border:0; margin-top:25px; }
                h1 { font-size: 1.2em; margin: .6em 0; }
                div#users-contain { width: 350px; margin: 20px 0; }
                div#users-contain table { margin: 1em 0; border-collapse: collapse; width: 100%; }
                div#users-contain table td, div#users-contain table th { border: 1px solid #eee; padding: .6em 10px; text-align: left; }
                .ui-dialog .ui-state-error { padding: .3em; }
                .validateTips { border: 1px solid transparent; padding: 0.3em; }
            </style>

            <script>
                $(document).ready(function(){

                    var company_name = $( "#company_name" ),
                    company_address = $( "#company_address" ),
                    company_city = $( "#company_city" ),
                    company_state = $( "#company_state" ),
                    company_zip = $( "#company_zip" ),
                    company_phone = $( "#company_phone" ),
                    company_fax = $( "#company_fax" ),
                    company_email = $( "#company_email" ),
                    company_website = $( "#company_website" ),
                    allFields = $( [] ).add( company_name ).add( company_address ).add( company_city ).add( company_state ).add( company_zip ).add( company_phone ).add( company_fax ).add( company_email ).add( company_website ),
                    tips = $( ".validateTips" );

                    function updateTips( t ) {
                        tips
                        .text( t )
                        .addClass( "ui-state-highlight" );
                        setTimeout(function() {
                            tips.removeClass( "ui-state-highlight", 1500 );
                        }, 500 );
                    }
                    function checkLength( o, n, min, max ) {
                        if ( o.val().length > max || o.val().length < min ) {
                            o.addClass( "ui-state-error" );
                            updateTips( "Length of " + n + " must be between " + min + " and " + max + "." );
                            //updateTips( n );
                            return false;
                        } else {
                            return true;
                        }
                    }
                    function checkRegexp( o, regexp, n ) {
                        if ( !( regexp.test( o.val() ) ) ) {
                            o.addClass( "ui-state-error" );
                            updateTips( n );
                            return false;
                        } else {
                            return true;
                        }
                    }
                    function ajaxFunction(){
                        var ajaxRequest;  // The variable that makes Ajax possible!
                        try{
                            // Opera 8.0+, Firefox, Safari
                            ajaxRequest = new XMLHttpRequest();
                        } catch (e){
                            // Internet Explorer Browsers
                            try{
                                ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
                            } catch (e) {
                                try{
                                    ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
                                } catch (e){
                                    // Something went wrong
                                    alert("Your browser broke!");
                                    return false;
                                }
                            }
                        }
                        // Create a function that will receive data sent from the server
                        ajaxRequest.onreadystatechange = function(company_id){
                            if(ajaxRequest.readyState == 4){
                                if( ajaxResult == "success"){
                                    $( "#company-id-" + id ).html( "<tr>" + "<td>" + company_name.val() + "</td>" + "<td>" + company_address.val() + "</td>" + "<td>" + company_city.val() + "</td>" + "<td>" + company_state.val() + "</td>" + "<td>" + company_zip.val() + "</td>" + "<td>" + company_phone.val() + "</td>" + "<td>" + company_fax.val() + "</td>" + "<td>" + company_email.val() + "</td>" + "<td>" + company_website.val() + "</td>" + "</tr>" );
                                    $( "#dialog-form" ).dialog( "close" );
                                } else if ( ajaxResult == "failed" ) {
                                    $( "#dialog-form" ).dialog( "close" );
                                    alert("There was an error updating the information to the database.");
                                }
                            }
                        }
                        var queryString = "?company_name=" + company_name.val() + "&company_address=" + company_address.val() + "&company_city=" + company_city.val() + "&company_state=" + company_state.val() + "&company_zip=" + company_zip.val() + "&company_phone=" + company_phone.val() + "&company_fax=" + company_fax.val() + "&company_email=" + company_email.val() + "&company_website=" + company_website.val();

                        ajaxRequest.open("GET", "ajax_add_company.php" + queryString, true);
                        ajaxRequest.send(null);
                    }

                    function editCompany(id) {
                        $( "#dialog-form" ).dialog({
                            autoOpen: false,
                            height: 300,
                            width: 350,
                            modal: true,
                            buttons: {
                                "Edit a Company": function() {
                                    var bValid = true;
                                    allFields.removeClass( "ui-state-error" );
                                    bValid = bValid && checkLength( company_name, "Company Name", 3, 50 );
                                    bValid = bValid && checkLength( company_address, "Address", 3, 50 );
                                    bValid = bValid && checkLength( company_city, "City", 1, 50 );
                                    bValid = bValid && checkLength( company_state, "State", 2, 2 );
                                    bValid = bValid && checkLength( company_zip, "Zip Code", 1, 50 );
                                    bValid = bValid && checkRegexp( company_email, /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i, "eg. ui@jquery.com" );

                                    if ( bValid ) {
                                        ajaxEditCompany(id);
                                    }
                                },
                                Cancel: function() {
                                    $( this ).dialog( "close" );
                                }
                            },
                           close: function() {
                                allFields.val( "" ).removeClass( "ui-state-error" );
                            }
                        });
                   }
                });
            </script>
        </head>
         <body>
            <div id="dialog-form" title="Edit Company Information">
            <p class="validateTips">All form fields are required.</p>
            <form>
                <fieldset>
                    <label for="name">Company Name</label>
                       <input type="text" name="company_name" id="company_name" class="text ui-widget-content ui-corner-all" />
                        <label for="company_address">Company Address</label>
                        <input type="text" name="company_address" id="company_address" class="text ui-widget-content ui-corner-all" />
                        <label for="company_city">City</label>
                        <input type="text" name="company_city" id="company_city" class="text ui-widget-content ui-corner-all" />
                        <label for="company_state">State</label>
                        <input type="text" name="company_state" id="company_state" class="text ui-widget-content ui-corner-all" />
                        <label for="company_zip">Zip</label>
                        <input type="text" name="company_zip" id="company_zip" class="text ui-widget-content ui-corner-all" />
                        <label for="company_phone">Phone</label>
                        <input type="text" name="company_phone" id="company_phone" class="text ui-widget-content ui-corner-all" />
                        <label for="company_fax">Fax</label>
                        <input type="text" name="company_fax" id="company_fax" class="text ui-widget-content ui-corner-all" />
                        <label for="company_email">Email</label>
                        <input type="text" name="company_email" id="company_email" class="text ui-widget-content ui-corner-all" />
                        <label for="company_website">Website</label>
                        <input type="text" name="company_website" id="company_website" class="text ui-widget-content ui-corner-all" />
                    </fieldset>
                </form>
            </div>
            <div id="company-contain" class="ui-widget">
                <h1>Existing Users:</h1>
                <table id="companies" class="ui-widget ui-widget-content">
                    <thead>
                        <tr class="ui-widget-header">
                            <th>Name</th>
                            <th>Address</th>
                            <th>City</th>
                            <th>State</th>
                            <th>Zip</th>
                            <th>Phone</th>
                            <th>Fax</th>
                            <th>Email</th>
                            <th>Website</th>
                            <th>&nbsp;</th>
                        </tr>
                    </thead>
                <tbody>
                    <tr id="id-1">
                        <td>Ashton Martin</td>
                        <td>124 Main</td>
                        <td>Dallas</td>
                        <td>TX</td>
                        <td>75206</td>
                        <td>2148264955</td>
                        <td>2148264969</td>
                        <td>info@google.com</td>
                        <td>www.google.com</td>
                        <td><button onClick="editCompany('1');">Edit</button></td>
                    </tr>
                    <tr id="id-2">
                        <td>Mike Jones</td>
                        <td>124 Main</td>
                        <td>Dallas</td>
                        <td>TX</td>
                        <td>75206</td>
                        <td>2148245654</td>
                        <td>2148232165</td>
                        <td>info@mikejones.com</td>
                        <td>www.google.com</td>
                        <td><button onClick="editCompany('2');">Edit</button></td>
                    </tr>
                    <tr id="id-3">
                        <td>Nick Moore</td>
                        <td>124 Main</td>
                        <td>Dallas</td>
                        <td>TX</td>
                        <td>75206</td>
                        <td>2144584569</td>
                        <td>214789456</td>
                        <td>info@nickmoore.com</td>
                        <td>www.google.com</td>
                        <td><button onClick="editCompany('3');">Edit</button></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:08:09.623

该函数未定义，因为您有一些标点错误。例如：

```
ajaxRequest.onreadystatechange = function(company_id){
    if(ajaxRequest.readyState == 4){
        if( ajaxResult == "success"){
            $( "#company-id-" + id ).html( "<tr>" + "<td>" + company_name.val() + "</td>" + "<td>" + company_address.val() + "</td>" + "<td>" + company_city.val() + "</td>" + "<td>" + company_state.val() + "</td>" + "<td>" + company_zip.val() + "</td>" + "<td>" + company_phone.val() + "</td>" + "<td>" + company_fax.val() + "</td>" + "<td>" + company_email.val() + "</td>" + "<td>" + company_website.val() + "</td>" + "</tr>" );
            $( "#dialog-form" ).dialog( "close" );
        } else if ( ajaxResult == "failed" ) {
            $( "#dialog-form" ).dialog( "close" );
            alert("There was an error updating the information to the database.");
        }
    }
}
// Create a function that will receive data sent from the server

// Lighthart says: Semicolon missing near here.

ajaxRequest.onreadystatechange = function(company_id){
    if(ajaxRequest.readyState == 4){
        if( ajaxResult == "success"){
            $( "#company-id-" + id ).html( "<tr>" + "<td>" + company_name.val() + "</td>" + "<td>" + company_address.val() + "</td>" + "<td>" + company_city.val() + "</td>" + "<td>" + company_state.val() + "</td>" + "<td>" + company_zip.val() + "</td>" + "<td>" + company_phone.val() + "</td>" + "<td>" + company_fax.val() + "</td>" + "<td>" + company_email.val() + "</td>" + "<td>" + company_website.val() + "</td>" + "</tr>" );
            $( "#dialog-form" ).dialog( "close" );
        } else if ( ajaxResult == "failed" ) {
            $( "#dialog-form" ).dialog( "close" );
            alert("There was an error updating the information to the database.");
        }
    }
} 
```

好像少了一个分号。使用 javascript linter 会在您的脚本部分显示无数错误。尝试[http://www.jshint.com/](http://www.jshint.com/)并修复您遇到的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T21:01:27.407

```
<script>  
            $(document).ready(function(){   

                var company_name = $( "#company_name" ),
                    company_address = $( "#company_address" ),
                    company_city = $( "#company_city" ),
                    company_state = $( "#company_state" ),
                    company_zip = $( "#company_zip" ),
                    company_phone = $( "#company_phone" ),
                    company_fax = $( "#company_fax" ),
                    company_email = $( "#company_email" ),
                    company_website = $( "#company_website" ),
                    allFields = $( [] ).add( company_name ).add( company_address ).add( company_city ).add( company_state ).add( company_zip ).add( company_phone ).add( company_fax ).add( company_email ).add( company_website ),
                    tips = $( ".validateTips" );

                function updateTips( t ) {      
                    tips        
                        .text( t )
                        .addClass( "ui-state-highlight" );      
                    setTimeout(function() {        
                        tips.removeClass( "ui-state-highlight", 1500 );      
                    }, 500 );    
                }     
                function checkLength( o, n, min, max ) {      
                    if ( o.val().length > max || o.val().length < min ) {        
                        o.addClass( "ui-state-error" );        
                        updateTips( "Length of " + n + " must be between " + min + " and " + max + "." ); 
                        //updateTips( n );       
                        return false;      
                    } else {        
                        return true;      
                    }    
                }     
                function checkRegexp( o, regexp, n ) {      
                    if ( !( regexp.test( o.val() ) ) ) {        
                        o.addClass( "ui-state-error" );        
                        updateTips( n );        
                        return false;     
                    } else {        
                        return true;      
                    }    
                }

                function getCompanyData(id){
                    var ajaxRequest;  // The variable that makes Ajax possible!
                    try{
                        // Opera 8.0+, Firefox, Safari
                        ajaxRequest = new XMLHttpRequest();
                    } catch (e){
                        // Internet Explorer Browsers
                        try{
                            ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
                        } catch (e) {
                            try{
                                ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
                            } catch (e){
                                // Something went wrong
                                alert("Your browser broke!");
                                return false;
                            }
                        }
                    }

                    // Create a function that will receive data sent from the server
                    ajaxRequest.onreadystatechange = function(){
                        if(ajaxRequest.readyState == 4){
                            var ajaxResult = ajaxRequest.responseText;
                            var obj = jQuery.parseJSON(ajaxResult);
                            $("#c_id").val(obj.company_id);
                            $("#company_name").val(obj.company_name);
                            $("#company_address").val(obj.company_address);
                            $("#company_city").val(obj.company_city);
                            $("#company_state").val(obj.company_state);
                            $("#company_zip").val(obj.company_zip);
                            $("#company_phone").val(obj.company_phone);
                            $("#company_fax").val(obj.company_fax);
                            $("#company_email").val(obj.company_email);
                            $("#company_website").val(obj.company_website);
                        } 
                    }

                    var queryString = "?company_id=" + id;
                    ajaxRequest.open("GET", "ajax_get_companies.php" + queryString, true);
                    ajaxRequest.send(null); 
                }

                function ajaxFunction(){
                    var ajaxRequest;  // The variable that makes Ajax possible!

                    try{
                        // Opera 8.0+, Firefox, Safari
                        ajaxRequest = new XMLHttpRequest();
                    } catch (e){
                        // Internet Explorer Browsers
                        try{
                            ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
                        } catch (e) {
                            try{
                                ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
                            } catch (e){
                                // Something went wrong
                                alert("Your browser broke!");
                                return false;
                            }
                        }
                    }

                    // Create a function that will receive data sent from the server
                    ajaxRequest.onreadystatechange = function(){
                        if(ajaxRequest.readyState == 4){
                            var ajaxResult = ajaxRequest.responseText;
                            var obj = jQuery.parseJSON(ajaxResult);
                            if (ajaxResult == "failed") {
                                alert("There was an error updating the database.  Please try again.");
                            } else {
                        $( "#c_name-" + obj.company_id ).text( obj.company_name );
                        $( "#c_address-" + obj.company_id ).text( obj.company_address );
                        $( "#c_city-" + obj.company_id ).text( obj.company_city );
                        $( "#c_state-" + obj.company_id ).text( obj.company_state );
                        $( "#c_zip-" + obj.company_id ).text( obj.company_zip );
                        $( "#c_phone-" + obj.company_id ).text( obj.company_phone );
                        $( "#c_fax-" + obj.company_id ).text( obj.company_fax );
                        $( "#c_email-" + obj.company_id ).text( obj.company_email );
                        $( "#c_website-" + obj.company_id ).text( obj.company_website );
//                              $( "#company-row-" + obj.company_id ).html( "<td>" + obj.company_name + "</td>" + "<td>" + obj.company_address + "</td>" + "<td>" + obj.company_city + "</td>" + "<td>" + obj.company_state + "</td>" + "<td>" + obj.company_zip + "</td>" + "<td>" + obj.company_phone + "</td>" + "<td>" + obj.company_fax + "</td>" + "<td>" + obj.company_email + "</td>" + "<td>" + obj.company_website + "</td>" + "<td><button class=company-edit-button data-id=514>Update Company</button></td>"  ); 
                                    $( "#dialog-form" ).dialog( "close" );
                            }
                        }
                    }

                    var queryString = "?company_id=" + $("#c_id").val() + "&company_name=" + company_name.val() + "&company_address=" + company_address.val() + "&company_city=" + company_city.val() + "&company_state=" + company_state.val() + "&company_zip=" + company_zip.val() + "&company_phone=" + company_phone.val() + "&company_fax=" + company_fax.val() + "&company_email=" + company_email.val() + "&company_website=" + company_website.val();
                    ajaxRequest.open("GET", "ajax_edit_company.php" + queryString, true);
                    ajaxRequest.send(null); 
                }

                $( "#dialog-form" ).dialog({      
                    autoOpen: false,      
                    height: 300,      
                    width: 350,      
                    modal: true,      
                    buttons: {        
                        "Save": function() {          
                            var bValid = true;          
                            allFields.removeClass( "ui-state-error" );           

                            bValid = bValid && checkLength( company_name, "Company Name", 3, 50 );
                            bValid = bValid && checkLength( company_address, "Address", 3, 50 );
                            bValid = bValid && checkLength( company_city, "City", 3, 50 );
                            bValid = bValid && checkLength( company_state, "State", 2, 2 );
                            bValid = bValid && checkLength( company_zip, "Zip Code", 1, 50 );          

                            bValid = bValid && checkRegexp( company_email, /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i, "eg. ui@jquery.com" );          
                            //bValid = bValid && checkRegexp( name, /^[a-z]([0-9a-z_])+$/i, "Username may consist of a-z, 0-9, underscores, begin with a letter." );          
                            //bValid = bValid && checkRegexp( company_address, /^([0-9a-zA-Z])+$/, "Address field only allows numbers and letters" );           

                            if ( bValid ) {            
                                ajaxSend = ajaxFunction();
                            }        
                        },        
                        Cancel: function() {          
                            $( this ).dialog( "close" );        
                        }      
                    },      
                    close: function() {        
                        allFields.val( "" ).removeClass( "ui-state-error" );      
                    }    
                });     
                $(".company-edit-button").click(function(){
                    var id = $(this).data("id");                
                    getCompanyResults = getCompanyData(id);
                    $( "#dialog-form" ).dialog( "open" );
                });
            });  
        </script>
    </head>

    <body>
    <div id="dialog-form" title="Create new user">  
        <p class="validateTips">All form fields are required.</p>   
        <form>  
            <fieldset>  
                <input type="hidden" name="c_id" id="c_id" class="text ui-widget-content ui-corner-all" />  
                <label for="name">Company Name</label>    
                <input type="text" name="company_name" id="company_name" class="text ui-widget-content ui-corner-all" />    
                <label for="company_address">Company Address</label>    
                <input type="text" name="company_address" id="company_address" class="text ui-widget-content ui-corner-all" />    
                <label for="company_city">City</label>    
                <input type="text" name="company_city" id="company_city" class="text ui-widget-content ui-corner-all" />   
                <label for="company_state">State</label>    
                <input type="text" name="company_state" id="company_state" class="text ui-widget-content ui-corner-all" />   
                <label for="company_zip">Zip</label>    
                <input type="text" name="company_zip" id="company_zip" class="text ui-widget-content ui-corner-all" />   
                <label for="company_phone">Phone</label>    
                <input type="text" name="company_phone" id="company_phone" class="text ui-widget-content ui-corner-all" />   
                <label for="company_fax">Fax</label>    
                <input type="text" name="company_fax" id="company_fax" class="text ui-widget-content ui-corner-all" />   
                <label for="company_email">Email</label>    
                <input type="text" name="company_email" id="company_email" class="text ui-widget-content ui-corner-all" />   
                <label for="company_website">Website</label>    
                <input type="text" name="company_website" id="company_website" class="text ui-widget-content ui-corner-all" />   

            </fieldset>  
        </form>
    </div>  

    <div id="users-contain" class="ui-widget">  
        <h1>Existing Users:</h1>  
            <table id="users" class="ui-widget ui-widget-content">    
                <thead>      
                    <tr class="ui-widget-header ">        
                        <th>Name</th>        
                        <th>Address</th>
                        <th>City</th>
                        <th>State</th>
                        <th>Zip</th>
                        <th>Phone</th>
                        <th>Fax</th>
                        <th>Email</th>
                        <th>Wesbite</th>
                        <th>&nbsp;</th>
                    </tr>    
                </thead>    
                <tbody>      
                    <tr>        
                        <td id="c_name-514">Ashton Wynne</td>        
                        <td id="c_address-514">124 Main</td> 
                        <td id="c_city-514">Dallas</td> 
                        <td id="c_state-514">TX</td> 
                        <td id="c_zip-514">75206</td> 
                        <td id="c_phone-514">2148264955</td> 
                        <td id="c_fax-514">2148264969</td> 
                        <td id="c_email-514">info@ashtonwynne.com</td> 
                        <td id="c_website-514">www.google.com</td>
                        <td><button class="company-edit-button" data-id="514">Update Company</button></td>
                    </tr>
                    <tr>
                        <td id="c_name-515">Ashton Wynne</td>        
                        <td id="c_address-515">124 Main</td> 
                        <td id="c_city-515">Dallas</td> 
                        <td id="c_state-515">TX</td> 
                        <td id="c_zip-515">75206</td> 
                        <td id="c_phone-515">2148264955</td> 
                        <td id="c_fax-515">2148264969</td> 
                        <td id="c_email-515">info@ashtonwynne.com</td> 
                        <td id="c_website-515">www.google.com</td>
                        <td><button class="company-edit-button" data-id="515">Update Company</button></td>
                    </tr>      
                </tbody>  
            </table>
        </div> 
```

# javascript - 为什么这个事件处理程序使用“e = e || event”？

> ID：15536998
> 
> 赞同：17
> 
> 时间：2013-03-20T23:52:06.777
> 
> 标签：javascript, event-handling, cross-browser, dom-events

谁能解释一下这行代码是什么意思：

```
function(e) { e = e || event; e.returnValue = false; return false; } 
```

为什么要命名参数`e`？
如果我将其更改为“myparam”，它会起作用吗？
是什么`e = e`意思？

`event`变量（之后）在哪里`||`声明？什么是`e.returnValue?`

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-20T23:56:40.877

这都是基本的事件管理，虽然它缺少`e.preventDefault()`...

要分解它，当触发事件处理程序时：

*   一些浏览器将参数传递给保存事件数据的回调（这是符合标准的做法）
*   其他浏览器（主要是旧的 IE）将事件数据放入`window.event`（在此处使用 just 访问`event`，这是有风险的，因为这依赖于没有具有该名称的局部变量）

接下来，`e = e || event;`是一种标准方式，即“如果未传递参数，则将其默认为`||`”之后的任何内容。在这种情况下，如果未传递事件参数，则它会查找全局变量。

`e.returnValue`是阻止事件导致其默认操作的三种方法之一。另外两个是`e.preventDefault && e.preventDefault()`（您发布的代码中明显没有），并且`return false;`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-20T23:58:39.510

这一行只是为了让 IE8 及以下浏览器的功能与所有其他浏览器相同。所有其他浏览器将目标元素 ( `e`) 传递给事件函数。

所以这段代码的作用是：

如果`e`存在，保留`e`. 如果它不存在，则您使用的是旧版本的 IE，我们将`windows.event`对象分配给`e`. 现在所有浏览器的行为方式都相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T23:56:08.683

这段代码测试`e`对象是否存在，否则使用该对象`event`并将其分配给 e。之后，它将属性设置`returnValue`为 false 并返回 false。

**这是在 IE 和其他浏览器上以相同方式运行的代码，无论是调用事件对象`e`还是`event`.**