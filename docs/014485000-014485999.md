# StackOverflow 问答 14485000-14485999

# javascript - 从 asp.net listview 传递输入类型 = text 和 span

> ID：14485004
> 
> 赞同：1
> 
> 时间：2013-01-23T16:51:15.930
> 
> 标签：javascript, asp.net

我有一个 asp.net 列表视图，其中包含一个列，2 个输入类型 = 按钮（id=Start，id=Stop，1 个输入类型 = 文本（id=TimeMINutes）和 1 个跨度（id=spCountDown）。从包括列表视图在内的所有这些控件都是...

```
 <table id="ctl00_ContentPlaceHolder1_lstViewFormulas_itemPlaceholderContainer" style="vertical-align:top; border:solid 1px gray">
        <tr id="ctl00_ContentPlaceHolder1_lstViewFormulas_Tr1" style="vertical-align:top; border:solid 1px gray">
            <td class="ListViewHeader" style="width:20%">
                 <span id="ctl00_ContentPlaceHolder1_lstViewFormulas_lblFormName">Step Name</span></td>
            <td class="ListViewHeader" style="width:10%" align="center">
                 <span id="ctl00_ContentPlaceHolder1_lstViewFormulas_lblTiming">Timing</span></td>
            <td class="ListViewHeader" style="width:30%">
                 <span id="ctl00_ContentPlaceHolder1_lstViewFormulas_Label6">Area Used</span></td>
            <td class="ListViewHeader" style="width:10%">
                 <span id="ctl00_ContentPlaceHolder1_lstViewFormulas_lblClock">Timer</span></td>
            <td class="ListViewHeader" style="width:30%">
                 <span id="ctl00_ContentPlaceHolder1_lstViewFormulas_lblProd">Products</span></td>
        </tr>

        <tr style="">
           <td>
              <span id="ctl00_ContentPlaceHolder1_lstViewFormulas_ctrl0_lblFormName">Step 1</span>
           </td>
           <td>
              <span id="ctl00_ContentPlaceHolder1_lstViewFormulas_ctrl0_lblTiming">20</span>
           </td>
           <td>
              <span id="ctl00_ContentPlaceHolder1_lstViewFormulas_ctrl0_lblAreaUsed">Scalp</span>
           </td>
           <td>

            <input type="button" onclick="countdown(document.getElementById('TimeMinutes'), document.getElementById('spCountDown'))"; value="Start" id="Start" />
            <input type="button" onclick='stopcountdown()'; value="Stop" id="Stop" />

            <input type="text" value='20' id="TimeMinutes" />
              <span id="spCountDown"></span>
           </td> 
```

我正在尝试将“TimeMinutes”输入类型 =“text”和“spCountDown”Span 传递给 javascript 函数。

我尝试了几种方法，包括...

```
<input type="button" onclick="countdown(document.getElementById('TimeMinutes'), document.getElementById('spCountDown'))"; value="Start" id="Start" /> 
```

我还尝试使用输入 id 在 javascript 函数中找到这些控件，但我没有找到正确的行。

我需要从输入 type = text 中获取值，并在 javascript 函数中开始倒计时。

```
 var interval;
  var seconds=0;
  function countdown(txtminutes, spanid) {
      interval = setInterval(function () {
          var sp = document.getElementById("spanid");
          var minutes = document.getElementById("txtminutes").value
          if (seconds == 0) {
              if (minutes == 0) {
                  sp.innerHTML = "countdown's over!";
                  clearInterval(interval);
                  return;
              } else {
                  minutes--;
                  seconds = 60;
              }
          }
          if (minutes > 0) {
              var minute_text = minutes + (minutes > 1 ? ' minutes' : ' minute');
          } else {
              var minute_text = '';
          }
          var second_text = seconds > 1 ? 'seconds' : 'second';
          sp.innerHTML = minute_text + ' ' + seconds + ' ' + second_text + ' remaining';
          seconds--;
      }, 1000);
  }

  function stopcountdown() {
      window.clearInterval(interval);
      var sp = document.getElementById("CountDown");
      sp.innerHTML = ''
  } 
```

如何传入这些控件，以便从正确的行获取和设置正确的值？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T16:59:22.300

对不起，我第一次很快就回复了。看起来您可以使用 parseInt() 将输入元素（字符串）中的值转换为整数。

```
var minutes = parseInt(document.getElementById("txtminutes").value) 
```

在下面的 If 语句中，如果我没有误解某些内容，则将字符串与 int 进行比较。

此外，作为建议，您应该将计时器值存储在变量中，而不是每秒从输入元素中转换字符串。这么想，不要从输入元素中读取时间，只用它来显示当前时间。它更安全，理论上资源需求更少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:49:51.040

您调用 getElementById 两次！

如果你使用这个

```
<input type="button" onclick="countdown(document.getElementById('TimeMinutes'), document.getElementById('spCountDown'))"; value="Start" id="Start" /> 
```

然后改变这个

```
var minutes = document.getElementById("txtminutes").value; 
```

对此

```
var minutes = txtminutes.value; 
```

您将元素的引用作为参数传递，然后尝试使用引用的 id 创建对元素的新引用。那是行不通的。只需删除 document.getElementById 部分。

另外...不要忘记使用 parseInt() 将字符串转换为 int

# sql - SQL 根据一列值替换多个值

> ID：14485005
> 
> 赞同：1
> 
> 时间：2013-01-23T16:51:23.733
> 
> 标签：sql, sql-server

我需要根据另一列值替换最多 9 列的结果。如果列“角色”是值“高级管理”，我想用硬值替换默认的层次值。我现在可以这样做：

```
 , CASE
   WHEN d.Role = 'SeniorManagement'  
   THEN (Replace(p.Firstname,'John','Joe')) END as First
 , CASE
   WHEN d.Role = 'SeniorManagement'  
   THEN (Replace(p.Lastname,'TopDog','AssignedPerson')) END as Last
 , CASE... 
```

我的问题是，有没有更简洁的方法来组合这些？

伪（我知道这不起作用:-)

```
 , CASE
    WHEN d.Role = 'SeniorManagement' 
    THEN (Replace(p.Firstname,'John','Joe')) as First 
    THEN (Replace(p.Lastname,'TopDog','AssignedPerson')) as Last
    THEN (Replace(p.Email,'TopDog@wherever','AssignedPerson@wherever')) as Email 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:15:45.917

使用函数呢？

```
create function dbo.GetColumnValue
(
   @ColumnBasedValue varchar(max),
   @ColumnToReplace varchar(max), --or the type you want
   @ToReplace varchar(max), 
   @Replacement varchar(max)
)
as
BEGIN

return (select case @ColumnBasedValue when 'SeniorManagement'
                      then (Replace(@ColumnToReplace,@ToReplace,@Replacement))
                      else @replaceValue END)

END 
```

并像使用它一样

```
select dbo.GetColumnValue(d.Role, p.Firstname,'John','Joe') as First, 
dbo.GetColumnValue(d.Role, p.Lastname,'TopDog','AssignedPerson') as Last.. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T16:58:15.890

根据上下文的不同，您可能能够摆脱原始选择。

`Select d.Role, 'Joe' as First, 'AssignedPerson' as Last`

并且只需使用 where 子句过滤每个选择。

如果要执行多个，请使用联合。

# objective-c - iOS 6.0：UICollectionView 不尊重 clipsToBounds 与 pagingEnabled

> ID：14485014
> 
> 赞同：8
> 
> 时间：2013-01-23T16:51:56.787
> 
> 标签：objective-c, ios6

**背景**

我正在实现`UICollectionView`（第一次）以实现分页的水平滚动视图。我希望每个图块都显示在框架的中心，其姐妹图块在左右部分可见（类似于 Safari 应用程序中的页面选择器）。我有兴趣使用`UICollectionView`来利用内置的单元出列，并且宁愿不使用旋转的`UITableView`.

**问题**

我发现的问题是，使用`pagingEnabled = YES`and时`clipsToBounds = NO`，一旦分页完成，就会`UICollectionView`删除框架外的单元格`collectionView`（它们不在数组中）。`visibleCells`任何人都可以提供有关如何在保持此基本设置的同时实现显示姐妹图块预览效果​​的建议吗？还是我错误地接近这个？

**截图**

*开始* ![开始](../Images/69a8b33c92eee52a8fa174003c615fe9.png) *滚动* ![滚动](../Images/b28456746adc7ff933f7dbdcea1a9e1f.png) *结束* ![结尾](../Images/9e359f0c0959ab78261efb7d39f443f7.png)

**滚动**屏幕是完全正确的。但是在开始和结束的镜头中，我希望在蓝色边缘有绿色可见。

这是我的 AppDelegate.m 中的内容（这里的基本设置归功于[tutsplus.com ）：](http://mobile.tutsplus.com/tutorials/iphone/uicollectionview-layouts)

```
#import "AppDelegate.h"

@interface ViewController : UICollectionViewController
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];
    [self.collectionView registerClass:[UICollectionViewCell class] forCellWithReuseIdentifier:@"ID"];
    [self.view setBackgroundColor:[UIColor blueColor]];
    // pad the collection view by 20 px
    UIEdgeInsets padding = UIEdgeInsetsMake(20.0, 20.0, 20.0, 20.0);
    [self.collectionView setFrame:UIEdgeInsetsInsetRect(self.view.frame, padding)];
    // set pagingEnabled and clipsToBounds off
    [self.collectionView setPagingEnabled:YES];
    [self.collectionView setClipsToBounds:NO];
}

- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section
{
    return 5;
}

- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    UICollectionViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"ID" forIndexPath:indexPath];
    UILabel *label = [[UILabel alloc] initWithFrame:cell.bounds];
    label.textAlignment = NSTextAlignmentCenter;
    label.text = [NSString stringWithFormat:@"%d", indexPath.row];
    [label setBackgroundColor:[UIColor greenColor]];
    [cell.contentView addSubview:label];
    return cell;
}
@end

@implementation AppDelegate
{
    ViewController *vc;
}

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // setup the UICollectionViewFlowLayout
    UICollectionViewFlowLayout *layout = [[UICollectionViewFlowLayout alloc] init];
    layout.itemSize = CGSizeMake(280, 280);
    layout.minimumInteritemSpacing = 0;
    layout.minimumLineSpacing = 0;
    layout.scrollDirection = UICollectionViewScrollDirectionHorizontal;
    // add a custom UICollectionViewController to the window
    vc = [[ViewController alloc] initWithCollectionViewLayout:layout];
    self.window.rootViewController = vc;
    self.window.backgroundColor = [UIColor yellowColor];
    [self.window makeKeyAndVisible];
    return YES;
}
@end 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-24T16:12:12.703

事实证明，这个问题的解决方案实际上非常简单。我只需要将`UICollectionViewCell`单元格重叠足够的像素，以便在分页滚动完成后它们仍然显示在 collectionView 的框架内。相关代码是

```
layout.itemSize = CGSizeMake(300, 300);
layout.minimumLineSpacing = -20.0; 
```

我继承了该方法`UICollectionViewFlowLayout`并覆盖了该`(CGSize)collectionViewContentSize`方法以返回单元格的非重叠大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-08T18:50:54.483

非常感谢关于使用负 minimumLineSpacing 的提示。我创建了一个测试器应用程序，它使用从 xib 文件加载的集合视图单元格。单元格具有透明背景和单元格内容的“内部”视图。

这样，就不需要自定义流程布局。

[https://github.com/j4johnfox/CollectionViewTester](https://github.com/j4johnfox/CollectionViewTester)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:33:50.730

我不是 collectionView 方面的专家，但它可能与 cellForItemAtIndexPath 中的这一行有关：

```
[cell.contentView addSubview:label]; 
```

每次调用时，都会将另一个标签子视图添加到单元格中。检查现有标签或子类 UICollectionViewCell？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-22T20:20:16.893

您还需要覆盖`-pointInside:withEvent:`以允许滚动手势在集合视图的框架之外开始。我使用`UIEdgeInsets`我的集合视图子类中的属性来执行此操作：

```
- (BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
    CGRect extendedBounds = UIEdgeInsetsInsetRect(self.bounds, self.touchAreaInsets);

    return CGRectContainsPoint(extendedBounds, point);
} 
```

如果您不需要 App Store 安全，您可以覆盖`_visibleBounds`以避免负间距黑客：

```
- (CGRect)_visibleBounds {
     return UIEdgeInsetsInsetRect(self.bounds, self.touchAreaInsets);
} 
```

如果您不太关注代码大小并且需要 App Store 安全性，您还可以将[PSTCollectionView](https://github.com/steipete/PSTCollectionView)子类化并可能覆盖`visibleBoundRects`以获得相同的效果。

# jquery - 如何自定义浏览器下拉选择菜单，以显示样式框？

> ID：14485017
> 
> 赞同：0
> 
> 时间：2013-01-23T16:52:09.477
> 
> 标签：jquery, css

我必须自定义浏览器下拉选择菜单：

![在此处输入图像描述](../Images/0d193023821121d03a24dc2824b5da8c.png)

**对此**：

![在此处输入图像描述](../Images/9e3000c920164bdae294e01baaa807ce.png)

我怎样才能用 Jquery 或 CSS 实现呢？

我查看了谷歌，发现了一些自定义 select_menu 的方法，但没有人将它转换成漂亮的盒子。你能给我一条线，我可以找到一个教程或帮助我从哪里开始吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:00:14.390

你不想要一个无序列表。

您需要单选按钮和标签，并使用该`for=""`属性。

[在这里演示](http://jsfiddle.net/nmGWN/1/)

您可以看到，当您单击标签时，它还会选择相应的单选按钮。使用 display none 隐藏单选按钮（从我的代码中取消注释），它会按您的意愿执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T16:55:53.147

jQuery UI 提供了一些功能，就像您在使用他们的“单选按钮”小部件时所描述的那样。

有关更多信息，请参阅以下链接：http: [//jqueryui.com/button/#radio](http://jqueryui.com/button/#radio)

# javascript - 设置选中状态时对象为空

> ID：14485022
> 
> 赞同：0
> 
> 时间：2013-01-23T16:52:15.467
> 
> 标签：javascript, jquery, html, internet-explorer

所以我有一个页面有几个 jQuery 插件。除其他外，我还有多选工具栏，一个非常可爱的插件。问题是当我在 Internet Explorer 中加载页面时分页符。当我尝试为我动态生成的某些元素设置一些属性时，我已经能够确定问题发生了。

这是生成元素的代码：

```
$.ajax({
            url: '@Url.Content("~")' + 'Ticket/GetTvrtke',
            async: false,
            success: function (data) {
                document.getElementById("header_tvrtka_holder").innerHTML = data;

                var tvrtke = data.split(", ");

                for (var i = 0; i < tvrtke.length; i++) {
                    document.getElementById("KlijentMultiSelect").innerHTML +=
                        "<option value=\"" + tvrtke[i] + "\" id=\"" + tvrtke[i] + "\" >" + tvrtke[i] + "</option>";
                }

                $("#KlijentMultiSelect").multiselect({
                    selectedText: "",
                    height: 125,
                    minWidth: 650,
                    noneSelectedText: 'Izaberite željene tvrtke:'
                });
            }
        }); 
```

该函数获取正确的数据并生成选项，然后我激活插件以呈现带有复选框的新下拉菜单。

问题是之后我有这个代码：

```
 var tvrtke = document.getElementById("header_tvrtka_holder").innerHTML.split(", ");

            for (var i = 0; i < tvrtke.length; i++) {
                document.getElementById("ui-multiselect-" + tvrtke[i]).checked = true;
            }

            for (var i = 0; i < tvrtke.length; i++) {
                document.getElementById("ui-multiselect-" + tvrtke[i]).setAttribute("onclick", "ChangeTextKlijent()");
            } 
```

在这里，我试图将复选框值设置为 true 并向输入元素添加点击事件，但随后 Visual Studio 将标题中的错误消息发送给我。在 Firefox 中，一切都很好，但 IE 则完全不同。

有人知道怎么修这个东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-11T12:37:42.420

我切换了，所以我的代码看起来像这样：

```
var tvrtke = document.getElementById("header_tvrtka_holder").innerHTML.split(", ");

$.each(tvrtke, function (index, value) {
    $("#KlijentMultiSelect").append("<option value=\"" + value + "\" id=\"" + value + "\" >" + value + "</option>");
}); 
```

现在它可以工作了。

# sql-server - SQL Server 2012 WKT 不同于 OGC 规范

> ID：14485026
> 
> 赞同：3
> 
> 时间：2013-01-23T16:52:34.347
> 
> 标签：sql-server, sql-server-2012, standards, wkt, ogc

据说SQL Server 遵循OGC 标准。在 SQL Server 2012中，具有测量值（例如 40）的 2D 点（例如 10,10）的**WKT**表示如下：

```
"POINT (10 10 NULL 40)" 
```

但是在[OGC](http://www.opengeospatial.org/standards/sfa)中，它的定义如下：

```
"Point M (10 10 40)" 
```

为什么？

# asp.net - 是否应该不使用实例变量，因为它们会导致多线程问题？

> ID：14485027
> 
> 赞同：1
> 
> 时间：2013-01-23T16:52:52.347
> 
> 标签：asp.net, vb.net, coding-style

我知道实例变量不是线程安全的，因为它们存储在堆上。我正在重构 ASP.NET 单线程应用程序中的代码，并且尝试更多地使用实例变量。

我的问题是：开发人员是否因为可能的多线程问题而避免使用实例变量？（即使应用程序现在不是多线程的，将来也可能是）。我记得读到应该使用实例变量来改进设计，使用组合和聚合而不是关联（与局部变量一样）。

是否有任何标准可以帮助开发人员决定何时使用实例变量以及何时使用局部变量。我已经用谷歌搜索了这个并且我查看了 MSDN，但我没有设法找到我的具体问题的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T16:59:43.330

您是否做过任何事情来使 ASP.NET 应用程序成为单线程的？否则默认情况下它是多线程的。

如果您在线程之间共享对象，则实例变量仅是多线程应用程序的问题。ASP.NET 应用程序的正常情况是每个线程都创建自己的对象实例，因此多线程不是问题。

如果需要在线程之间共享数据，将数据封装在一个对象中仍然是最好的方法。通过使用私有实例变量并通过方法或属性访问它们，您可以确保来自对象外部的所有访问都是同步的，因为对象中的代码可以完全控制数据的公开位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T16:56:09.197

假设正在谈论网页和网页的实例变量，那么您不必担心多线程和线程安全。asp.net/web 服务器会处理这个问题。这篇[**msdn 文章**](http://blogs.msdn.com/b/benchr/archive/2008/09/03/does-asp-net-magically-handle-thread-safety-for-you.aspx)讨论了 asp.net 提供的线程安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T16:56:38.977

您实际上指的是**静态**变量。静态变量不是线程安全的（通常，除非您编写代码来同步对变量的适当访问）。**相比之下，实例**变量在 asp.net*中是线程安全*的，因为每个请求线程都将在其自己的副本上运行。

**静态**变量旨在存储需要在所有请求之间共享的数据。如果您没有这种情况，则不需要使用静态变量。如果你这样做了，已经有一些类已经提供了这个，比如`Cache`类。

# c# - 获取 HttpPostedFileBase 的 FileInfo

> ID：14485029
> 
> 赞同：4
> 
> 时间：2013-01-23T16:52:54.307
> 
> 标签：c#, .net, vb.net, file-io

有没有一种简单的方法可以`FileInfo`从 中获取对象`HttpPostedFileBase`？我意识到我可以保存文件然后执行类似的操作`DirectoryInfo.GetFiles`，然后遍历文件以查找我的文件，但是对于给定的文件，有没有更简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T16:55:27.610

上传的文件没有`FileInfo`关联。只有`filename`作为参数以及文件流本身发送。这就是您可以查询的内容：

```
HttpPostedFileBase file = ...

string filename = file.FileName;
int fileSize = file.ContentLength;
string contentType = file.ContentType;
using (Stream stream = file.InputStream)
{
    // do something with the file contents here
} 
```

为了更好地了解客户端发送的内容，我邀请您阅读[`multipart/form-data`](http://www.w3.org/TR/html401/interact/forms.html#h-17.13.4.2)规范。

FileInfo 对象包含 LastModified 和 LastAccessed 日期之类的内容，这不是上传文件时发送的信息。如果您将文件保存在 Web 服务器磁盘上，然后从中检索 FileInfo，请记住，您将检索的是**服务器上**有关此文件的信息，而**不是客户端上的**信息，因为这些信息在文件已上传。

# java - 使用 SolrJ 和 Solr4 进行刻面

> ID：14485031
> 
> 赞同：6
> 
> 时间：2013-01-23T16:52:56.933
> 
> 标签：java, solr, solrj, faceted-search, solr4

我已经浏览了这个网站上的相关问题，但没有找到相关的解决方案。

使用表单的 HTTP 请求查询我的 Solr4 索引时

```
&facet=true&facet.field=country 
```

响应包含所有不同的国家以及每个国家的计数。

如何使用 SolrJ 获取此信息？我尝试了以下方法，但它只返回所有国家的总计数，而不是每个国家：

```
solrQuery.setFacet(true);
solrQuery.addFacetField("country"); 
```

以下似乎确实有效，但我不想事先明确设置所有分组：

```
solrQuery.addFacetQuery("country:usa");
solrQuery.addFacetQuery("country:canada"); 
```

其次，我不确定如何从 QueryResponse 对象中提取方面数据。

所以两个问题：

1) 使用 SolrJ 如何在字段上分面并返回分组而不明确指定组？

2) 使用 SolrJ 如何从 QueryResponse 对象中提取分面数据？

谢谢。

**更新：**

我还尝试了类似于 Sergey 的回应（如下）的东西。

```
List<FacetField> ffList = resp.getFacetFields();
log.info("size of ffList:" + ffList.size());
for(FacetField ff : ffList){
    String ffname = ff.getName();
    int ffcount = ff.getValueCount();
    log.info("ffname:" + ffname + "|ffcount:" + ffcount);           
} 
```

上面的代码显示了 size=1 的 ffList 并且循环经历了 1 次迭代。在输出中 ffname="country" 和 ffcount 是匹配原始查询的总行数。

这里没有按国家/地区细分。

我应该提到，在同一个 solrQuery 对象上，我还调用了 addField 和 addFilterQuery。不确定这是否会影响刻面：

```
solrQuery.addField("user-name");
solrQuery.addField("user-bio");
solrQuery.addField("country");
solrQuery.addFilterQuery("user-bio:" + "(Apple OR Google OR Facebook)"); 
```

**更新 2：**

我想我明白了，再次基于 Sergey 在下面所说的话。我使用 FacetField.getValues() 提取了 List 对象。

```
List<FacetField> fflist = resp.getFacetFields();
for(FacetField ff : fflist){
    String ffname = ff.getName();
    int ffcount = ff.getValueCount();
    List<Count> counts = ff.getValues();
    for(Count c : counts){
        String facetLabel = c.getName();
        long facetCount = c.getCount();
    }
} 
```

在上面的代码中，标签变量匹配每个方面组，计数是该分组的相应计数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T17:09:34.923

实际上你只需要设置 facet 字段，facet 就会被激活（查看 SolrJ 源代码）：

```
solrQuery.addFacetField("country"); 
```

你在哪里找的方面信息？必须在`QueryResponse.getFacetFields`( `getValues.getCount`)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-18T14:44:53.343

在 solr Response 中，您应该使用其中的数字“国家”`QueryResponse.getFacetFields()`来获取`List`。`FacetFields`所以“国家”由`QueryResponse.getFacetFields().get(0)`

你迭代然后使用它来`List`获取`Count`对象

```
QueryResponse.getFacetFields().get(0).getValues().get(i) 
```

并使用获取刻面的值名称和使用`QueryResponse.getFacetFields().get(0).getValues().get(i).getName()` 相应的权重

```
QueryResponse.getFacetFields().get(0).getValues().get(i).getCount() 
```

# r - 有没有比较两个数据帧的有效方法

> ID：14485040
> 
> 赞同：3
> 
> 时间：2013-01-23T16:53:15.583
> 
> 标签：r

我有两个行数不同但列数相同的数据框。在下面的示例中，数据帧 1 为 4 x 2，数据帧 2 为 3 x 2。我需要一个 4 x 3 逻辑矩阵，其中 TRUE 表示数据帧中的所有行都匹配。此示例有效，但运行较大的数据帧需要很长时间（我正在尝试两个大约 5,000 行的数据帧，但仍然只有两列）。有没有更有效的方法来做到这一点？

```
> df1 <- data.frame(row.names=1:4, var1=c(TRUE, TRUE, FALSE, FALSE), var2=c(1,2,3,4))
> df2 <- data.frame(row.names=5:7, var1=c(FALSE, TRUE, FALSE), var2=c(5,2,3))
> 
> m1 <- t(as.matrix(df1))
> m2 <- as.matrix(df2)
> 
> apply(m2, 1, FUN=function(x) { apply(m1, 2, FUN=function(y) { all(x==y) } ) })
      5     6     7
1 FALSE FALSE FALSE
2 FALSE  TRUE FALSE
3 FALSE FALSE  TRUE
4 FALSE FALSE FALSE 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-05T00:14:14.160

我被您在 R-bloggers 上的帖子吸引到这里：http: [//jason.bryer.org/posts/2013-01-24/Comparing_Two_Data_Frames.html](http://jason.bryer.org/posts/2013-01-24/Comparing_Two_Data_Frames.html)

如果像您说的那样，您的数据没有数字向量，那么我想我可以建议一种更快的方法。它包括：

1.  把你的两个 data.frames 变成两个整数矩阵
2.  计算两个数据的行之间的欧几里得距离

使用您的数据的快速示例：

```
mat1 <- as.matrix(sapply(df1, as.integer))
mat2 <- as.matrix(sapply(df2, as.integer))
library(fields)
rdist(mat1, mat2) < 1e-9
#       [,1]  [,2]  [,3]
# [1,] FALSE FALSE FALSE
# [2,] FALSE  TRUE FALSE
# [3,] FALSE FALSE  TRUE
# [4,] FALSE FALSE FALSE 
```

几点评论：

1.  如果您的数据包含字符向量，则必须将它们转换为因子并确保它们共享相同的因子水平。
2.  我使用`fields`包来计算欧几里得距离。它使用 Fortran 实现，据我所知，它是该任务最快的 R 包（我已经测试了很多，相信我。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:47:18.910

老实说，我不确定这是否会更快，但您可以尝试：

```
foo <- Vectorize(function(x,y) {all(df1[x,] == df2[y,])})
> outer(1:4,1:3,FUN = foo)
      [,1]  [,2]  [,3]
[1,] FALSE FALSE FALSE
[2,] FALSE  TRUE FALSE
[3,] FALSE FALSE  TRUE
[4,] FALSE FALSE FALSE 
```

我觉得有必要至少提到使用`==`for 比较而不是`all.equal`or的危险`identical`。我假设您对数据类型足够熟悉，这不会成为问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-05T05:38:22.417

我怀疑最佳解决方案取决于您拥有多少唯一行和总行数。

对于您博客上的示例，其中有 1000-1500 行但只有 20 个唯一值（对于您在那里设置的种子），我认为这样做更快：

1.  将 id 分配给每个唯一的行，然后
2.  在每个 data.frame 中看到的 id 向量上运行。

这是我得到的表现。@flodel 的方法在我的电脑上也差不多；这是下面的第三个。免责声明：我对运行这些类型的测试知之甚少。

```
> set.seed(2112)
> df1 <- data.frame(row.names=1:1000, 
+   var1=sample(c(TRUE,FALSE), 1000, replace=TRUE), 
+   var2=sample(1:10, 1000, replace=TRUE) )
> df2 <- data.frame(row.names=1001:2500, 
+   var1=sample(c(TRUE,FALSE), 1500, replace=TRUE),
+   var2=sample(1:10, 1500, replace=TRUE))
> 
> # candidate method on blog  
> system.time({
+  df1$var3 <- apply(df1, 1, paste, collapse='.')
+  df2$var3 <- apply(df2, 1, paste, collapse='.')
+  df6 <- sapply(df2$var3, FUN=function(x) { x == df1$var3 })
+  dimnames(df6) <- list(row.names(df1), row.names(df2))
+ })  
   user  system elapsed 
   1.13    0.00    1.14 
> 
> rownames(df1) <- NULL # in case something weird happens to rownames on merge
> rownames(df2) <- NULL
> # id method  
> system.time({  
+ df12 <- unique(rbind(df1,df2))
+ df12$id <- rownames(df12)
+ 
+ id1 <- merge(df12,df1)$id
+ id2 <- merge(df12,df2)$id
+ 
+ x <- outer(id1,id2,`==`)
+ })
   user  system elapsed 
   0.11    0.02    0.13 
> 
> library(fields)
> # rdlist from fields method
> system.time({  
+ mat1 <- as.matrix(sapply(df1, as.integer))
+ mat2 <- as.matrix(sapply(df2, as.integer))
+ rdist(mat1, mat2) < 1e-9
+ })
   user  system elapsed 
   0.15    0.00    0.16 
```

我猜s`rbind`和`merge`s 会使这个解决方案在使用不同的数据时成本相对更高。

# svn - SVN Post Commit Hook 在文件列表上

> ID：14485041
> 
> 赞同：4
> 
> 时间：2013-01-23T16:53:31.487
> 
> 标签：svn, email, post-commit-hook

我的服务器中有很多文件。我只想为某些文件设置提交后挂钩。IE。只有在更新这些文件时才应发送通知邮件。

我已经安装了 SVN Notify，它对 SVN 服务器中的所有文件都可以正常工作。但它应该只适用于某些文件。所以我找到了维护一个**文本文件**的方法，该文件将包含提交后应该应用的文件列表。

但是问题是我的提交后脚本如何知道更新的文件来自文本文件中存在的文件列表？

请建议我一些摆脱这种情况的方法。

**注意：**维护文本文件是强制性的，因为该文本文件将由第三方定期更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:13:52.587

1.  用于`svnlook changed`找出刚刚提交的修订中发生了什么变化
2.  将此列表与列出这些文件的外部文本文件进行比较
3.  根据您的要求应用逻辑

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:51:27.897

如果您的 post-commit 钩子当前查看所有文件并向您发送一封电子邮件，说明任何文件已签入，那么您将需要编辑它，但使用此基本逻辑。

1.  提交后读取文本文件中的每一行并将其存储在 %file
2.  如果提交的文件 = %file
3.  发送电子邮件，此 %file 已在 %date 签入。

单独的东西。

# jquery - jquery UI 选项卡中的列表

> ID：14485044
> 
> 赞同：0
> 
> 时间：2013-01-23T16:53:36.050
> 
> 标签：jquery, asp.net-mvc-3, jquery-ui

我无法在选项卡中呈现列表。前任。

```
<div id="tabs">
  <ul>
    <li><a href="#tabs-1">Nunc tincidunt</a></li>
    <li><a href="#tabs-2">Proin dolor</a></li>
    <li><a href="#tabs-3">Aenean lacinia</a></li>
  </ul>
  <div id="tabs-1">
      <p>Tab 1</p>
        <div id="validate">
            <ul>
                <li>Item 1</li>
                <li>Item 2</li>
            </ul>
        </div>

  </div>
  <div id="tabs-2">
    <p>Tab 2</p>
  </div>
  <div id="tabs-3">
      <p> Tab 3 </p>
  </div>

</div> 
```

在上面的示例中，嵌套列表未呈现为列表。检查这里[http://jsfiddle.net/3YyHz/](http://jsfiddle.net/3YyHz/)

这会导致问题，因为 MVC 中的验证摘要作为列表返回，但显示会因为它在选项卡上而变得一团糟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T21:04:30.760

您是在谈论缺少的样式吗？我认为您只是有一个 CSS 问题，其中 Jquery UI 列表样式覆盖了嵌套列表。我用一些内联 css 更新了你的小提琴以进行演示。

# python-2.7 - 64 位 Windows 7 上的 Python 32 或 64？安装 easy_install 会有什么影响？

> ID：14485050
> 
> 赞同：5
> 
> 时间：2013-01-23T16:53:47.790
> 
> 标签：python-2.7, cmd, pip, windows-7-x64, easy-install

我在我的 Mac 上写了一些 Python 代码，以及如何将它传输到 Windows 计算机。这令人沮丧，难以言表。我安装了 Python 2.7 x32，然后我卸载了它，然后我安装了 Python 2.7 x64。我的 python 脚本依赖于 xlrd 和 xlwt，以及其他一些下载的模块。我想使用 easy_install 或 pip 或任何对不太了解计算机真正复杂工作原理的人来说容易的方式安装它们。截至目前，如果我这样做：

```
C:\Windows\System32> python 
```

我得到：

```
'python' is not recognized as an internal or external command operable program or batch file. 
```

![这是我的python文件夹](../Images/a51e2b0dfd3e43e2d387cafeff6f2307.png)

![这是脚本文件夹](../Images/2e4451f3e359ff20809bb7ccf6f9e361.png)

![这些是我的环境变量](../Images/8b961aef9176b597b44f91123b3f2a34.png)

有人会建议我采取下一步行动吗？

我做了一堆 google-ing 和 stackoverflow-ing 并且似乎已经登陆[这里](http://www.lfd.uci.edu/~gohlke/pythonlibs/)，我不知道如何从这里下载一些东西。例如，我将如何下载 Pip，以及我将下载哪一个？

人们说一个人应该下载并安装[这个](http://peak.telecommunity.com/dist/ez_setup.py)，我该怎么做？

我对终端很熟悉，我会在 cmd 中输入什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T21:25:11.697

我的事情进展不顺利的原因是因为我混合使用了 Python 2.7（32 位）和 Python 2.7（64 位）。经过更多研究，我发现即使我的 Windows 7 是 64 位，我也不必下载 64 位 python。事实上，32 位 python 与其他程序的兼容性更好。所以我点击并从我的“添加/删除程序”菜单中卸载了 python 和其他所有名称为“Python”的东西。这花了大约 10 分钟。接下来，我下载了 32 位 Python 2.7。在此之后，我下载的所有软件包，我确保它们是 32 位而不是 64 位。

另外，非常重要的是，我去了我的“环境变量”（谷歌如何到达那里）并添加了 Python27 的安装目录。为此，您可以按照[本](http://pythoncentral.org/how-to-install-python-2-7-on-windows-7-python-is-not-recognized-as-an-internal-or-external-command/)指南进行操作。我做的最后一件事是将 ;.PY 添加到 PATHEXT 的末尾。

# entity-framework - EF 5 模型第一个部分类自定义构造函数如何？

> ID：14485052
> 
> 赞同：10
> 
> 时间：2013-01-23T16:53:50.973
> 
> 标签：entity-framework, constructor, partial-classes, ef-model-first

EF 为我生成了一些部分类，每个类都有一个构造函数，但它说不要碰它们（下面的示例），现在如果我创建自己的次要部分类并且我想要一个构造函数来自动设置一些字段如何我这样做会发生冲突吗？

```
//------------------------------------------------------------------------------
// <auto-generated>
//    This code was generated from a template.
//
//    Manual changes to this file may cause unexpected behavior in your application.
//    Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

namespace Breakdown.Models
{
    using System;
    using System.Collections.Generic;

    public partial class Call
    {
        public Call()
        {
            this.Logs = new HashSet<Log>();
        }

        ...
    }
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-05-25T03:19:32.353

部分方法可以在这里为您提供帮助，在 T4 模板中定义了一个无主体的部分方法并在构造函数中调用它。

```
public <#=code.Escape(entity)#>()
{
    ...
    OnInit();
}

partial void OnInit(); 
```

然后在您的部分类中定义部分方法并将您想要在构造函数中执行的操作放入其中。如果您不想做任何事情，那么您不需要定义部分方法。

```
partial class Entity()
{
    partial void OnInit()
    {
        //constructor stuff
        ...
    }
} 
```

[http://msdn.microsoft.com/en-us/library/vstudio/6b0scde8.aspx](http://msdn.microsoft.com/en-us/library/vstudio/6b0scde8.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:28:02.427

我最近也想做同样的事情，最后修改了 T4 模板，这样我就可以手动实现自己的无参数构造函数。为此，您可以从生成的类中删除构造函数，并将集合等的实例化移动到构造函数之外，这样：

```
public Call()
{
  this.Logs = new HashSet<Log>();
} 
```

变成这样：

```
private ICollection<Log> logs = new HashSet<Log>();
public virtual ICollection<Log> Logs 
{ 
  get { return this.logs; } 
  set { this.logs = value; } 

} 
```

我认为的缺点是生成的类不是“干净”的。也就是说，您不能只为您的复杂/导航类型提供自动实现的属性。

在您的 model.tt 文件中，您可以通过删除以下代码、将其注释掉或仅在条件中放入 false 来阻止构造函数的生成，这样它就永远不会被执行：

```
if (propertiesWithDefaultValues.Any() || complexProperties.Any())
{
#>
  public <#=code.Escape(complex)#>()
  {
<#
    foreach (var edmProperty in propertiesWithDefaultValues)
    {
#>
      this.<#=code.Escape(edmProperty)#> =
         <#=typeMapper.CreateLiteral(edmProperty.DefaultValue)#>;
<#
    }

    foreach (var complexProperty in complexProperties)
    {
#>
      this.<#=code.Escape(complexProperty)#> = new
        <#=typeMapper.GetTypeName(complexProperty.TypeUsage)#>();
<#
    }
#>
  } 
```

然后在下面，您需要进行一些修改，为您的复杂类型和导航类型生成属性。添加一个带有对象实例化的私有 var 和一个用于访问这些私有 var 的属性，例如：

```
if (complexProperties.Any())
{
  foreach(var complexProperty in complexProperties)
  {
    //generate private var + any instantiation
    //generate property for accessing var
  }
} 
```

根据模型的复杂性，您可能需要修改其他区域。希望这能让你开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:03:20.153

这是不可能的。

部分类本质上是同一类的一部分。

没有方法可以被定义两次或被覆盖（同样的规则也适用于构造函数）

但是您可以使用下面提到的**解决方法：**

```
//From file SomeClass.cs - generated by the tool
public partial class SomeClass
 {
    // ...
 }

// From file SomeClass.cs - created by me
public partial class SomeClass
  {
    // My new constructor - construct from SomeOtherType
    // Call the default ctor so important initialization can be done
    public SomeClass(SomeOtherType value) : this()
      {

       }
  } 
```

有关更多信息，请查看[**部分类、默认构造函数**](http://blogs.msdn.com/b/rjacobs/archive/2009/02/23/partial-classes-default-constructors-watch-out.aspx)

我希望这对你有帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T08:45:11.330

1.  添加一个基类：

    ```
     public class CallBase
     {
            protected CallBase()
            {
                Initialize();
            }

            protected abstract void Initialize();
     } 
    ```

2.  在另一个文件中添加部分类实现

    ```
     public partial class Call: CallBase
     {
        protected override void Initialize();
        {
       ...
         }
     } 
    ```

缺点是初始化方法会在所有集合生物之前被调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-15T08:49:00.317

如果我很好理解这个问题，那么在创建一个新实体时需要这个构造函数，这是一个以前没有持久化的实体。

我的情况是为所有日期时间设置一个默认值，即将它们初始化为“时间的开始”：1900-01-01。

在这种情况下，我使用实体工厂

```
public static T GetNewEntity<T> () {
    T e;
    try {
        e = Activator.CreateInstance<T>();
    } catch {
        e = default(T);
    }
    SetDefaults(e);

    return e;
} 
```

每次我需要一个新实体时，我都会使用

```
Entity e = GetNewEntity<Entity>(); 
```

使用 SetDefaults 为：

```
public static void SetDefaults (object o) {
    Type T = o.GetType();
    foreach ( MemberInfo m in T.GetProperties() ) {
        PropertyInfo P = T.GetProperty(m.Name);
        switch ( Type.GetTypeCode(P.PropertyType) ) {
            case TypeCode.String :
                if ( P.GetValue(o, null) == null ) 
                    P.SetValue(o, String.Empty, null); 
                break;
            case TypeCode.DateTime :
                if ( (DateTime)P.GetValue(o, null) == DateTime.MinValue )
                    P.SetValue(o, EntityTools.dtDef, null); 
                break;
        }
    }
} 
```

完整代码在[这里](http://madbuildertools.blogspot.fr/2011/08/managing-default-values-for-entities-in.html)

它可以被重写以考虑实体类型等等......

# forms - 引导形式甚至不跨越

> ID：14485056
> 
> 赞同：0
> 
> 时间：2013-01-23T16:54:00.027
> 
> 标签：forms, twitter-bootstrap

我创建了一个表格，并希望确保所有跨度都对齐并且是方形的。但即使所有跨度加起来为 12，每一行的宽度也不同。就是这样，还是我做错了什么？

```
<div class="container ">

                            <form class="well form-inline">
                                <div class="controls controls-row">  
                                    <label class="span1" for="input01">
                                        Prefix
                                    </label>
                                    <input type="text" class="span1" id="input01" placeholder="Dr."><label class="span1" for="input02">
                                        First Name
                                    </label>
                                    <input type="text" class="span3" id="input02" placeholder="John">
                                    <label class="control-label span1" for="input03">
                                        last Name
                                    </label>
                                    <input type="text" class="span3" id="input03" placeholder="Doe">
                                    <label class="control-label span1" for="input04">
                                        Suff
                                    </label>
                                    <input type="text" class="span1" id="input04" placeholder="Jr.">
                                </div>
                                <div class="controls controls-row">  
                                    <label class="span1" for="input01">
                                        Company
                                    </label>
                                    <input type="text" class="span5" id="input01" placeholder="Sample LLC">
                                    <label class="span1" for="input02">
                                        Title
                                    </label>
                                    <input type="text" class="span5" id="input02" placeholder="Director of Samples">
                                </div>
                                <div class="controls controls-row">  
                                    <label class="span1" for="input01">
                                        Address 1
                                    </label>
                                    <input type="text" class="span5" id="input01" placeholder="Address Line 1">
                                    <label class="span1" for="input02">
                                        Address 2
                                    </label>
                                    <input type="text" class="span5" id="input02" placeholder="Address Line 2">
                                </div>
                                <div class="controls controls-row">  
                                    <label class="span1" for="input01">
                                        Cntry
                                    </label>
                                    <select class="input-medium span2 countries" data-country="US"></select>
                                    <label class="span1" for="input01">
                                        City
                                    </label>
                                    <input type="text" class="span2" id="input02" placeholder="City">
                                    <label class="span1" for="input02">
                                        St/Prv
                                    </label>
                                    <select class="input-medium span2 states" data-country="US" data-state="CA"></select>
                                    <label class="span1" for="input01">
                                        Zip
                                    </label>
                                    <input type="text" class="span2" id="input02" placeholder="City">
                                </div>
                                <div class="controls controls-row">  
                                    <label class="span1" for="input01">
                                        Email
                                    </label>
                                    <input type="text" class="span5" id="input01" placeholder="you@yourdomain.com">
                                    <label class="span2" for="input02">
                                        Confirm Email
                                    </label>
                                    <input type="text" class="span4" id="input02" placeholder="you@yourdomain.com">
                                </div>
                                <div class="controls controls-row">  
                                    <label class="span1" for="input01">
                                        Phone
                                    </label>
                                    <input type="text" class="span3" id="input01" placeholder="">
                                    <label class="span1" for="input02">
                                        Cell
                                    </label>
                                    <input type="text" class="span3" id="input02" placeholder="">
                                    <label class="span1" for="input02">
                                        Fax
                                    </label>
                                    <input type="text" class="span3" id="input02" placeholder="">
                                </div>
                            </form>
                        </div> 
```

屏幕截图：http: [//www.flickr.com/photos/92503149@N07/8409032538/in/photostream](http://www.flickr.com/photos/92503149@N07/8409032538/in/photostream)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T20:22:52.267

您只发布了一个片段，所以我不知道您如何将表单集成到页面的其余部分，但`row-fluid`可能会有所帮助：

```
<form class="well form-inline row-fluid"> 
```

我试过了，看起来已经好多了。

更多提示：

*   一些标签缺少类`control-label`。由于行高调整，这总体上很重要`control-label`。
*   根据表格的完整宽度，某些标签可能无法`span1`放在一行中（在我的快速测试中就是这种情况）
*   和一个一般的设计提示：最后一行有 3 个标签/输入对，有点破坏布局。通常，您会尝试坚持某些垂直定位。

希望这可以帮助

# php - PDO 未插入 - 无错误

> ID：14485058
> 
> 赞同：10
> 
> 时间：2013-01-23T16:54:04.703
> 
> 标签：php, mysql, database, pdo

我不明白为什么这些行不起作用：

```
 $host = 'localhost';
  $dbname='mydbname';
  $login='mylogin';
  $pwd='mypwd';
  $datex = date('Y/m/d H:i:s');
  $nomx = 'jrmy';
  $numx = '007';
  try {
    $bdd = new PDO('mysql:host='.$host.';dbname='.$dbname, $login, $pwd);
  }
  catch(Exception $e) {
    die('Erreur : '.$e->getMessage());
  }
  $bdd->exec('INSERT INTO dossiers(date, nom, numero, disp) VALUES(\''.$datex.'\', \''.$nomx.'\', \''.$numx.'\', \'Y\')');
  $id = $bdd->lastInsertId();
  $bdd= null;
  echo 'id: '.$id; 
```

披露：该脚本在我的 apache 服务器上运行，并且由于我将脚本安装在 IIS 服务器上，它停止工作......

并且查询功能完美运行...查询确定，插入否

编辑：谢谢大家！真的！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-23T16:57:25.420

您需要告诉 PDO 引发错误

```
$bdd->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

请注意，您处理异常的方式毫无用处。最好从代码中删除 try-catch 块

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T16:58:11.570

您没有充分利用 PDO。使用参数插入数据

例子：

```
$bdd->exec('INSERT INTO dossiers(date, nom, numero, disp) VALUES(?, ?,?, ?)');
$bdd->bindParam(1, $datex);  
$bdd->bindParam(2, $nomx);  
$bdd->bindParam(3, $numx);
$bdd->bindParam(3, 'Y'); 
```

并使用它来引发错误：

```
$bdd>setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:02:10.593

如果代码在 Apache 中正常工作并且在 IIS 中停止工作，则可能是环境更改导致了它，而代码中没有任何内容。您是否检查过 Windows 中的 PDO 扩展是否已启用？

这些是 Windows 的主要四个 PDO dll：

```
extension=php_pdo.dll
extension=php_pdo_mysql.dll
extension=php_pdo_mssql.dll
extension=php_pdo_odbc.dll 
```

其中我认为前两个需要在您的 php.ini 中启用才能使 PDO 扩展工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-15T22:30:32.133

我有一个类似的问题，原来是因为我没有为 PDO 启用自动提交。使用显式事务帮助我解决了问题；

```
self::$_pdo->beginTransaction();
$sql = "INSERT INTO redirects (source, target, http_status_code, aspect_id) VALUES(?, ?, ?, ?)";
$query = self::$_pdo->prepare($sql);
$query->execute(array($_POST['source'], $_POST['target'], $_POST['http_status_code'], $_POST['aspect_id']));
self::$_pdo->commit(); 
```

（是的，有一百万种方法可以更好地完成上述操作，但我只是在演示交易。在这里，请阅读： http: [//php.net/manual/en/pdo.transactions.php](http://php.net/manual/en/pdo.transactions.php)）

# regex - 序列化字符串中的“姓氏，名字”->“名字姓氏”

> ID：14485060
> 
> 赞同：6
> 
> 时间：2013-01-23T16:54:19.797
> 
> 标签：regex, string, r

我有一堆字符串，其中包含**姓氏、名字**格式的名称列表，用逗号分隔，如下所示：

```
names <- c('Beaufoy, Simon, Boyle, Danny','Nolan, Christopher','Blumberg, Stuart, Cholodenko, Lisa','Seidler, David','Sorkin, Aaron') 
```

将字符串中的所有这些名称转换为**名字姓氏**格式的最简单方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T17:16:29.040

如果您可以确定逗号不会出现在某人的名字中，那么这可能会起作用：

```
mynames <- c('Beaufoy, Simon, Boyle, Danny',
             'Nolan, Christopher',
             'Blumberg, Stuart, Cholodenko, Lisa',
             'Seidler, David',
             'Sorkin, Aaron',
             'Hoover, J. Edgar')
mynames2 <- strsplit(mynames, ", ")

unlist(lapply(mynames2, 
              function(x) paste(x[1:length(x) %% 2 == 0], 
                                x[1:length(x) %% 2 != 0])))
# [1] "Simon Beaufoy"     "Danny Boyle"       "Christopher Nolan"
# [4] "Stuart Blumberg"   "Lisa Cholodenko"   "David Seidler"    
# [7] "Aaron Sorkin"      "J. Edgar Hoover" 
```

我已经在其中添加了 J. Edgar Hoover。

如果您希望一起引用的名称保持在一起，请添加`collapse = ", "`到您的`paste()`函数中：

```
unlist(lapply(mynames2, 
              function(x) paste(x[1:length(x) %% 2 == 0], 
                                x[1:length(x) %% 2 != 0],
                                collapse = ", ")))
# [1] "Simon Beaufoy, Danny Boyle"       "Christopher Nolan"               
# [3] "Stuart Blumberg, Lisa Cholodenko" "David Seidler"                   
# [5] "Aaron Sorkin"                     "J. Edgar Hoover" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T18:07:06.380

**(1) 在每个元素中保持相同的名称**这可以通过单个来完成`gsub`（假设名称中没有逗号）：

```
> gsub("([^, ][^,]*), ([^,]+)", "\\2 \\1", names)
[1] "Simon Beaufoy, Danny Boyle"       "Christopher Nolan"               
[3] "Stuart Blumberg, Lisa Cholodenko" "David Seidler"                   
[5] "Aaron Sorkin"    

> gsub("([^, ][^,]*), ([^,]+)", "\\2 \\1", "Hoover, J. Edgar")
[1] "J. Edgar Hoover" 
```

**(2) 每个元素分成一个名称**如果您希望每个名字姓氏在一个单独的元素中，则使用**(a) 扫描**

```
scan(text = out, sep = ",", what = "") 
```

`out`以上的结果在哪里`gsub`或直接尝试**（b）strapply**：

```
> library(gsubfn)
> strapply(names, "([^, ][^,]*), ([^,]+)", x + y ~ paste(y, x), simplify = c)
[1] "Simon Beaufoy"     "Danny Boyle"       "Christopher Nolan"
[4] "Stuart Blumberg"   "Lisa Cholodenko"   "David Seidler"    
[7] "Aaron Sorkin"     

> strapply("Hoover, Edgar J.", "([^, ][^,]*), ([^,]+)", x + y ~ paste(y, x), 
+   simplify = c)
[1] "Edgar J. Hoover" 
```

请注意，上面的所有示例都使用相同的正则表达式进行匹配。

更新：删除了分隔名字和姓氏的逗号。

更新：添加了代码以将每个名字和姓氏分开到一个单独的元素中，以防这是首选的输出格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T17:21:51.483

我赞成@AnandaMahto 的回答，但只是为了好玩，这说明了另一种使用`scan`、`split`和的方法`rapply`。

```
names <- c(names, 'Chambers, John, Ihaka, Ross, Gentleman, Robert')

# extract names
snames <- 
lapply(names, function(x) scan(text=x, what='', sep=',', strip.white=TRUE, quiet=TRUE))

# break up names
snames<-lapply(snames, function(x) split(x, rep(seq(length(x) %/% 2), each=2)))

# collapse together, reversed
rapply(snames, function(x) paste(x[2:1], collapse=' ')) 
```

# google-apps-script - 为什么谷歌应用程序脚本不发送邀请

> ID：14485063
> 
> 赞同：3
> 
> 时间：2013-01-23T16:54:23.620
> 
> 标签：google-apps-script, google-calendar-api

Google Apps 脚本在下面的电子表格中运行，除了发送邀请外一切正常。使用`sendInvites:true`在日历中创建的事件并添加了客人，但不发送电子邮件。我已经尝试过了，但没有使用`var advancedArgs`相同的结果。

```
 if (eventImported  != EVENT_IMPORTED && title != "") {  // Prevents importing duplicates
    var cal = CalendarApp.openByName('calendarname');
    var advancedArgs = {description: details, location: cust, guests:guestlist, sendInvites:true};

    cal.createEvent("10% Complete-->"+title, startDate, endDate, {description: details, location: cust, guests:guestlist, sendInvites:true});
    sheet.getRange(startcolumn + i, 9).setValue(EVENT_IMPORTED); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T08:06:12.773

错误一定出在其他地方，我在这个简化版本中测试了您的代码，并按预期收到了邀请。（我在许多脚本中大量使用此选项，没有任何问题）

你能说明你是如何得到你的客人名单的吗？[它是文档](https://developers.google.com/apps-script/class_calendar?hl=fr-FR#createEvent)中指定的逗号分隔的电子邮件列表吗？

```
function testcal(){
    var cal = CalendarApp.getDefaultCalendar()
    var advancedArgs = {description: 'details', location: 'here', guests:'serge@xxx.com', sendInvites:true};// change the email adress to a valid one that you have access to (but not your email adress of course !
    var startDate = new Date();// now
    var endDate = new Date(startDate.setHours(10));// at 10 AM, change this according to time of the day when you (eventually) test it
    cal.createEvent("test to delete", startDate, endDate, advancedArgs);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-20T08:51:30.620

我发现**没有活动邀请发送到我*自己的电子邮件地址***（尽管活动已添加到我的日历中）。但活动邀请已正确发送给其他客人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-03T04:01:48.737

我怀疑您可能在某个地方受到速率限制。我有一个类似的问题，发送电子邮件会偶尔工作。我正在轮询一组用户日历，当我在某个时间发现足够的可用日历时，我会将邀请发送给所有人。

我沮丧地补充说：

实用程序.sleep(30000);

就在我创建事件之前，它现在可以可靠地工作。你可能可以用更少的时间逃脱，但我的在凌晨 2 点触发，所以我不在乎。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-22T19:19:36.167

试用：var advancedArgs = {description: details, location: cust, guest:guestlist, sendInvites:"TRUE"};

# visual-studio-2012 - Visual Studio 2012 Ultimate LoadTest 在什么上运行？

> ID：14485064
> 
> 赞同：0
> 
> 时间：2013-01-23T16:54:26.150
> 
> 标签：visual-studio-2012, load-testing

差不多，我需要知道我是否需要在服务器上运行它还是可以从我的桌面运行它？我不想认为我会从我的桌面运行 24 小时负载测试并占用我的机器，但事情就是这样吗？或者我可以从服务器（虚拟或其他？）运行它？

很抱歉模棱两可，但我对运行它所需的基础设施了解不多。我尝试研究它，但我能找到的只是如何运行负载测试，而不是物理要求。我还阅读了一些关于团队系统的内容。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:46:40.807

要求在 MSDN 中，[here](http://msdn.microsoft.com/en-us/library/ff937706.aspx)。是的，您可以在桌面上运行它。正如您将从链接中看到的那样，您的需求取决于要添加到负载中的虚拟用户数量。您的测试资源密集程度如何也影响到这一点。

您应该能够在 MSDN 上找到您需要的内容。阅读并设置并运行测试。如果遇到问题，请在 StackOverflow 上发布更具体的问题。

# ruby-on-rails - Rake 数据库迁移因“未定义方法 `double`”而失败

> ID：14485066
> 
> 赞同：2
> 
> 时间：2013-01-23T16:54:27.923
> 
> 标签：ruby-on-rails, sqlite, rake, rails-migrations

我已经定义了一个脚手架，其中一些 sqlite 列具有 type `double`。当我运行时`rake db:migrate`，它给出了以下错误：

```
undefined method `double' for #<ActiveRecord::ConnectionAdapters::TableDefinition:> 
```

是否有另一种方法来指定`double`Rails 可以理解的？我应该在这里使用`float`吗？

这是脚手架命令：

```
rails generate scaffold shop name:string latitude:double 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T16:55:51.137

尝试使用`float`而不是`double`. 看看[这里](http://overooped.com/post/100354794/ruby-script-generate-scaffold-types)。

# django - 如何从模型表单向 html（表单）添加自定义属性？

> ID：14485068
> 
> 赞同：1
> 
> 时间：2013-01-23T16:54:32.297
> 
> 标签：django

这是模型表单中的标准复选框：

在我的 HTML 中，我有：`{{form}}`

在网站来源：

```
<div class="id_accept-control-group control-group">
   <div class="controls">
      <label class="checkbox">
      <input type="checkbox" name="accept" id="id_accept" /> <span>Accept</span>
      </label>
   </div>
</div> 
```

如何添加自定义属性：（`disabled="disabled" checked="checked"`输入）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T16:59:06.490

查看这个问题，为您指明正确的方向[Django：如何将任意 html 属性添加到表单上的输入字段？](https://stackoverflow.com/questions/2902008/django-how-do-i-add-arbitrary-html-attributes-to-input-fields-on-a-form)

还可以查看模型表单 django doc [https://docs.djangoproject.com/en/dev/topics/forms/modelforms/](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/)

# asp.net - MembershipProvider 的 Initialize 方法未执行

> ID：14485069
> 
> 赞同：1
> 
> 时间：2013-01-23T16:54:32.907
> 
> 标签：asp.net, membership-provider

我正在开发一个 ASP .Net 网站。
我在 web.config 文件中声明了一个自定义 MembershipProvider，如下所示：

```
<membership defaultProvider="MyMembershipProvider">
    <providers>
        <clear/>
        <add name="MyMembershipProvider" type="CompleteSubtitles.Web.Security.MembershipProvider"/>
    </providers>
</membership> 
```

我创建了一个登录 ASPX 页面。
我在验证按钮单击事件处理程序中调用 MembershipProvider.ValidateUser 方法。
我注意到 ASP .Net 不会自动执行 MembershipProvider.Initialize 方法。
正常吗？

MembershipProvider.Initialize 方法是加载 MembershipProvider 的配置所必需的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T10:59:46.970

在阅读了 LordHits 在此线程上的回答后，我得到了解决方案：[如何在自定义 MembershipProvider 上调用 Initialize？](https://stackoverflow.com/questions/623545/how-do-i-call-initialize-on-a-custom-membershipprovider)

我严重地实例化了我的 MembershipProvider 如下：

```
 CompleteSubtitles.Web.Security.MembershipProvider l_membershipProvider = 
        new CompleteSubtitles.Web.Security.MembershipProvider(); 
```

正确的方法是：

```
 CompleteSubtitles.Web.Security.MembershipProvider l_membershipProvider =
        (CompleteSubtitles.Web.Security.MembershipProvider)Membership.Providers["MyMembershipProvider"]; 
```

MembershipProvider.Initialize 方法是在使用正确的方式时执行的。
因此，从 web.config 文件中读取 MembershipProvider 配置。

# html - Bootstrap 导航下拉方向

> ID：14485070
> 
> 赞同：2
> 
> 时间：2013-01-23T16:54:34.117
> 
> 标签：html, twitter-bootstrap

我正在使用 Twitter Bootstrap 构建布局。我在导航栏中定位下拉菜单时遇到问题。如果 .nav 具有拉右功能，则打开的下拉菜单将始终向左打开。

我希望能够手动控制它应该向左还是向右打开。这可能吗？

```
<div class="navbar" id="navbar-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="logo pull-left" href="/index_dev.php/"></a>
            <ul class="nav pull-right">
                <li class="active"><a href="/index_dev.php/"> Shots</a></li>
                <li class="divider-vertical"></li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Explore <i class="icon-caret-down"></i></a>
                    <ul class="dropdown-menu span6">
                        <li class="column-menu span2">
                            <ul>
                                <li><a href="#"><i class="icon-caret-right"></i> Dry Fly</a></li>
                                <li><a href="#"><i class="icon-caret-right"></i> Popper</a></li>
                                <li><a href="#"><i class="icon-caret-right"></i> Terrestrial</a></li>
                                <li><a href="#"><i class="icon-caret-right"></i> Streamer</a></li>
                            </ul>
                        </li>
                        <li class="column-menu span2">
                            <ul>
                                <li><a href="#"><i class="icon-caret-right"></i> Wet Fly</a></li>
                                <li><a href="#"><i class="icon-caret-right"></i> Nymph</a></li>
                                <li><a href="#"><i class="icon-caret-right"></i> Emerger</a></li>
                                <li><a href="#"><i class="icon-caret-right"></i> Streamer</a></li>
                            </ul>
                        </li>
                        <li class="column-menu span2">
                            <ul>
                                <li><a href="#"><i class="icon-caret-right"></i> Wet Fly</a></li>
                                <li><a href="#"><i class="icon-caret-right"></i> Nymph</a></li>
                                <li><a href="#"><i class="icon-caret-right"></i> Emerger</a></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="divider-vertical"></li>
                                <li><a href="/index_dev.php/signup">Sign up</a></li>
                <li class="divider-vertical"></li>
                <li><a href="/index_dev.php/login">Sign in</a></li>
                            </ul>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:56:07.853

你只需要覆盖 Bootstrap 的`.dropdown-menu.pull-right`样式：

```
.navbar .pull-right > li > .dropdown-menu, .navbar .nav > li > .dropdown-menu.pull-right.dropdown-right {
    right: auto;
    left: -19px;
}
.navbar .pull-right > li > .dropdown-menu::before, .navbar .nav > li > .dropdown-menu.pull-right.dropdown-right::before {
    right: auto;
    left: 9px;
}
.navbar .pull-right > li > .dropdown-menu::after, .navbar .nav > li > .dropdown-menu.pull-right.dropdown-right::after {
    right: auto;
    left: 10px;
} 
```

`dropdown-right`在您想要覆盖的任何右拉菜单中使用该类。

[jsFiddle](http://jsfiddle.net/j7mRG/)

# tridion - Tridion 核心服务更新错误

> ID：14485072
> 
> 赞同：9
> 
> 时间：2013-01-23T16:54:38.023
> 
> 标签：tridion, tridion-2011

在我们正在进行的重构练习中，我们必须更改选定网站的页面模板。大多数页面都已本地化，并通过以下代码更新其页面模板，但对于少数页面，我们收到以下错误：

```
XML validation error. Reason: The element 'Metadata' in namespace 'uuid:940d95aa-fcce-481c-8de5-c61d06c74f46' has invalid child element 'description' in namespace 'uuid:940d95aa-fcce-481c-8de5-c61d06c74f46'. 

List of possible elements expected: 'TitleSEO, KeywordsSEO, DescriptionSEO, omniture' in namespace 'uuid:940d95aa-fcce-481c-8de5-c61d06c74f46'. 
```

我们的元数据架构中没有描述字段，并且 TitleSEO、KeywordsSEO、DescriptionSEO、omniture 都是可选字段，不会被代码更改。

```
try
{
   pData = client.Read(page.Attribute("ID").Value, null) as PageData;
    //Localize Page
    if (!(bool)pData.BluePrintInfo.IsLocalized)
    {
        client.Localize(pData.Id, new ReadOptions());
        if (dTemplateIDs.ContainsKey(pData.PageTemplate.IdRef.ToString()))
        {
            pData.IsPageTemplateInherited = false;
            pData.PageTemplate.IdRef = dTemplateIDs[pData.PageTemplate.IdRef];
            client.Update(pData, new ReadOptions());
        }
    }
}
catch (Exception ex)
{
    Console.WriteLine("Error Inner " + ex.Message);
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-23T17:07:02.740

听起来在过去的某个时候，您的页面元数据架构中有一个名为“description”的字段（我怀疑后来更改为现在的“DescriptionSEO”）。这几个导致错误的页面可能在更改后没有更新，它们的 XML 中的旧元数据字段也是如此，因此当您更改页面模板时会出现验证问题。

如果只有几页，只需打开页面，添加一些描述或以其他方式更改某些内容，保存它们，然后再次尝试您的代码。

如果它不止几个，您可能需要以编程方式检测和删除现有数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T18:45:54.007

我不确定您使用的是哪个版本的 SDL Tridion，但在 SDL Tridion 2011 的一些早期版本中，如果之前已将元数据添加到任何对象，则不会通过将元数据模式更改为对象上的空来清除它。因此，我发现您必须在保存项目之前使用代码将元数据值设置为 NULL。这可能会解决您的问题。

# model - 在 ExtJS 4.1.1 中以包含组合 multiSelect=true 的形式加载嵌套模型

> ID：14485074
> 
> 赞同：0
> 
> 时间：2013-01-23T16:54:44.977
> 
> 标签：model, combobox, nested, extjs4.1, multi-select

这是我的代码的缩短版本：

```
Ext.define('MyApp.model.Folder', {
    extend: 'Ext.data.Model',
    fields: ['id', 'name']
});

Ext.define('MyApp.model.User', {
    ...,
    hasMany: { model: 'Folder', name: 'folders' }
});

var form = Ext.widget('form', {
    ...,
    items: {
        xtype: 'combo',
        name: 'folders',
        multiSelect: true,
        valueField: 'id',
        displayField: 'name',
        queryMode: 'local',
        store: 'Folders'
    }
});

User.load(1, {
    success: function (user) {
        form.loadRecord(user);
    }
}); 
```

User 模型加载的数据：

```
{
    ...,
    folders: [
        { id: 1, name: 'folder 1' },
        { id: 2, name: 'folder 2' }
    ]
} 
```

假设一切（用户模型和存储）加载成功，并且存储包含文件夹 1、2、N，我希望组合选择传递给`loadRecord`方法的值（文件夹 1 和 2），但该字段保持为空。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:13:47.080

发布此问题后，我找到了解决方案。但是，我想这一定不是“最佳实践”的一部分，所以，等待更好的，这里是一个不错的选择：

```
Ext.define('MyApp.model.User', {
    ...,
    hasMany: { model: 'Folder', name: 'folders' },
    fields: [..., {
        name: 'folders',
        convert: function (folders) {
            return Ext.Array.map(folders, function (folder) {
                return folder.id;
            });
        }
    }]
}); 
```

# cakephp - 在 find 方法中加入 belongsTo

> ID：14485075
> 
> 赞同：1
> 
> 时间：2013-01-23T16:54:49.177
> 
> 标签：cakephp, join, model, model-associations

`Score`属于`Player`：

```
class Score extends AppModel {
    public $name = 'Answer';
    public $belongsTo = array('Player');
} 
```

在`PlayersController`中，我想获得玩家的分数，以及他的详细信息。

**问题 #1**：如何在方法结果中包含`belongsTo`模型？`find`（加入它）

**问题 #2**：如何获得`Score.distance`属于该玩家的所有得分距离 ( ) 的总和？（我`SUM(Score.distance)`的意思是，分组`Score.player_id`）

**Q1 的注意事项**：因为每个玩家都有很多分数，所以我不喜欢在`find`我在该控制器中使用的每种方法中加入分数。我只想通过 1 个动作来获得它们）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T04:42:11.347

正如您在底部布局中的 sql_dump 中看到的那样，Cakephp automagic 实际上并没有加入表。

您将看到以下查询。

```
SELECT `Player`.`id`, `Player`.`name`, `Player`.`created` FROM `players` AS `Player` WHERE `Player`.`id` = 10 GROUP BY `Player`.`id`

SELECT `Score`.`id`, `Score`.`player_id`, `Score`.`scores` FROM `scores` AS `Score` WHERE `Score`.`player_id` = (10) 
```

很清楚，它实际上并不是连接表，因此您需要按照以下方式进行操作。

以下将对您有所帮助，因为**我已经对其进行了测试。**

在 Player Controller 中，您需要先取消绑定得分模型，然后使用自定义代码加入得分表，如下所示。

在播放器模型中创建一个虚拟字段，如下所示。

```
<?php
class Player extends AppModel
{
    var $name = 'Player';
    var $displayField = 'name';

    var $virtualFields = array
    (
        'Distance' => 'SUM(Score.scores)'
    );

    var $hasMany = array
    (
        'Score' => array
        (
            'className' => 'Score',
            'foreignKey' => 'player_id',
            'dependent' => false,
            'conditions' => '',
            'fields' => '',
            'order' => '',
            'limit' => '',
            'offset' => '',
            'exclusive' => '',
            'finderQuery' => '',
            'counterQuery' => ''
        )
    );
}
?>
```

为了测试，我手动添加`conditions`以查找玩家编号`10 scores`

```
<?php
class PlayersController extends AppController {

    var $name = 'Players';

    function index()
    {

        $this->Player->unbindModel(array
        (
            'hasMany' => array
            (
                'Score'
            )
        ));

        $this->Player->bindModel(array
        (
            'belongsTo' => array
            (
                'Score' => array
                (
                    'foreignKey' => false,
                    'conditions' => array
                    (
                        'Player.id = Score.player_id'
                    )
                )
            )
        ));

        $order = "Player.id";
                $direction = "asc";
                if(isset($this->passedArgs['sort']) && $this->passedArgs['sort']=="Distance")
                {
                        $order = $this->passedArgs['sort'];
                    $direction = $this->passedArgs['direction'];
                    unset($this->passedArgs['sort']);
                    unset($this->passedArgs['direction']);
                }

                $this->pagination = array();

                $this->pagination = array
                (
                    'conditions' => array
                    (
                     'Score.player_id' => 10
                    ),
                    'fields' => array
                    (
                        'Player.*',
                        'SUM(Score.scores) AS Distance'
                    ),
                    'group' => array
                    (
                        'Score.player_id'
                    ),
                    'limit' => 15,
                        'order'=>$order." ".$direction
               );

              $playersScore = $this->paginate('Player');
    }   
}
?>
```

结果数组如下所示。

```
Array
(
    [0] => Array
    (
        [Player] => Array
        (
            [id] => 10
            [name] => Dexter Velasquez
            [created] => 2012-08-02 12:03:07
            [Distance] => 18
        )
    )
)
```

对于测试，我使用了[**Generate Mysql Data**](http://www.generatedata.com/#generator)。

用于排序链接

```
<?php $direction = (isset($this->passedArgs['direction']) && isset($this->passedArgs['sort']) && $this->passedArgs['sort'] == "Distance" && $this->passedArgs['direction'] == "desc")?"asc":"desc";?>
```

并显示如下链接。

```
<?php echo $this->Paginator->sort('Distance','Distance',array('direction'=>$direction));?>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:08:09.093

所以，`Player`有很多`Scores`...

```
class Player extends AppModel {
    public $name = 'Player';
    public $hasMany = array('Score');
} 
```

...这意味着您的`find()`in`PlayersController`可以是...

```
$players = $this->Player->find(
    'all',
    array(
        'contain' => array('Score'), // <-- If you're not using Containable Behavior, remove.
        'conditions' => array('Player.id' => $id), // <-- Change or remove as necessary.
        'fields' => array(
            'Player.id',
            'Player.name',
            'Sum(Score.distance) as sum_dist',
        ),
        'group' => array(
            'Player.id',
            'Player.name',
        ),
        'order' => array(
            'Player.name',
        ),
    )
); 
```

希望你明白这一点。

# java - 推荐的代码重用

> ID：14485076
> 
> 赞同：1
> 
> 时间：2013-01-23T16:54:49.573
> 
> 标签：java, scala, project, svn-externals

我正在 Scala 中启动一个新项目，该项目严重依赖于另一个 Java 项目中的源文件。起初我想在那个项目中创建一个新的包/模块，但这似乎很乱。但是，我不想在我的新项目中复制 Java 代码。我想出的最佳解决方案是通过 svn 外部依赖引用 Java 项目。另一种解决方案是从原始文件创建一个 jar 文件，我会将其作为库附加到新的 Scala 项目中。但是，这使得保持最新状态更加不便。哪条路线比较好？

SVN 外部：

*   易于更新
*   易于提交
*   设置不方便

jar 文件作为库：

*   易于设置
*   旧代码不在积极开发中（稳定，仅修复错误）
*   多步更新
*   需要打开旧项目进行更改

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:05:00.003

你有你的 Scala 项目，它依赖于你的 Java 项目的一部分。对我来说，这听起来像是 Java 项目应该是一个库，带有一个版本号，您的 Scala 项目只是引用它。或者也许那些在两个项目之间共享的部分应该被分离到一个库中。使用 Maven 等构建工具将清楚地知道正在使用哪个版本。然后 Java 项目可以单独发展，或者如果它需要为了 Scala 项目而改变，如果你害怕损坏，你可以推出一个新版本并在其他上下文中继续使用旧版本。

我能想到的超越二进制依赖关系的唯一例外是，Java 代码本身是否实际上在编译时以某种方式在特定于 Scala 项目的情况下进行处理。比如说，注释处理。

使用 SVN 外部可能是一个解决方案。只需确保您使用分支和快照，以确保对主干上的 Java 代码进行一些更新不会突然使您的 Scala 项目无法运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:13:55.170

您是否混合了 scala/java 无关紧要。如果两个项目非常不同并且具有不同的发布周期，您可能想要使用外部依赖项（jar）。否则，您可以使用 sbt 并让您的两个项目成为同一构建的子项目（您的 sbt 构建文件将使 scala 项目依赖于 java 项目）。甚至，如果它们真的如此交织在一起，那么只需一个项目同时包含 java 和 scala 源文件。Sbt 处理得很好。

Maven 也是一种选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:15:38.693

您可以使用 maven 轻松设置混合 scala/Java 项目。看看 scala-maven-plugin。

[https://github.com/davidB/scala-maven-plugin](https://github.com/davidB/scala-maven-plugin)

由于 maven 集成不佳，Eclipse 用户可能不太高兴。

# c# - 代替 goto 的东西？

> ID：14485077
> 
> 赞同：0
> 
> 时间：2013-01-23T16:54:52.517
> 
> 标签：c#

由于我是 C# 的初学者，我们只在控制台中编写。作业要求我们不要使用`goto`我目前正在使用的“”。

控制台结束时会问你一个问题，如果“是”，它会将我返回到入口，如果“否”，它会转到下一个问题。

```
switch (pitanje)
{
    case ("da"):
        goto start;
    case ("ne"):
        Console.ForegroundColor = ConsoleColor.Magenta;
        goto end;
    default:
        break;
} 
```

所以“开始”位于开头（第一个条目），“结束”位于控制台中最后一个问题的前面。

我如何做到这一点`goto`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:01:09.847

```
string pitanje = "";

while(pitanje != "ne")
{
    //start

    if(pitanje == "da")
        //logic

}
Console.ForegroundColor = ConsoleColor.Magenta; 
```

ps 俄语命名变量不是最佳选择。

还可以考虑阅读 Edsger W. Dijkstra 的经典文章[Go To Statement Considered Harmful](http://www.cs.utexas.edu/users/EWD/ewd02xx/EWD215.PDF)。还阅读了他关于[结构化编程](https://rads.stackoverflow.com/amzn/click/com/0122005503)的书。它对如何以这种方式构建程序非常重要，您可以分析并证明它的正确性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:00:46.683

您可以使用中断或继续。或者您可以使用变量作为标志。您也可以在其中使用循环和条件。这完全取决于您的程序

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T16:57:00.560

假设这`switch`是程序的最后一部分，请在程序`while`周围放置一个检查变量的循环。根据所采用的`switch`分支更新该变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T16:58:56.870

您的代码可能形成了一种循环。在这种情况下，您可以像这样替换它：

```
while (pitanje != "ne") {
    // Read content of pitanje …

    switch (pitanje) {
        case "da":
            continue;
        case "ne":
            Console.ForegroundColor = ConsoleColor.Magenta;
            break;
    }
} 
```

– 不需要`default`案例。`continue`跳回到循环的开头。在这种`ne`情况下，您只需更改颜色，然后在循环标题中，您的循环就会被取消。

# c++ - 如何在 C++ 中跟踪日志文件？

> ID：14485078
> 
> 赞同：3
> 
> 时间：2013-01-23T16:54:54.890
> 
> 标签：c++, tail

> **可能重复：**
> [在 C++ 中实现“tail -f”](https://stackoverflow.com/questions/2696976/implement-tail-f-in-c)

我正在向 C++ 应用程序添加一个新线程，该线程将单独负责“跟踪”特定日志文件。基本上，线程应该根据日志文件监视最后一次接收到某个消息的时间（或者换句话说，最后一次将某个短语写入文件的时间）。此消息的每个实例在日志文件中将如下所示：

（此处为时间戳）收到的心跳消息：...（此处有更多文本，但不重要）

如果接收到的两个时间戳之间的经过时间大于或等于 (2 * heartbeat interval) 秒，则线程应将此情况通知应用程序，并从那里应用程序将处理其余部分（这部分对于问题并不重要我在问）。我对此有一些疑问：

1.  当另一个线程不断写入时，如何在这个新线程中读取日志文件？我不会遇到线程安全问题吗？有没有办法以共享模式读取文件？我正在阅读与此相关的其他问题，但找不到明确的答案。

2.  我应该在这个新线程中实现某种计时器，每秒钟触发一次吗？我想我应该每（2 * 心跳间隔）秒触发一次，然后执行检查。

3.  我将如何执行日志文件的实际拖尾？有没有办法从文件末尾开始并反向读取？我知道文件 I/O 很昂贵。那么我是否应该反向读取 x 个字节（换句话说，猜测我应该反向读取多远）并在该数据块中搜索时间戳/短语？

# scala - 从 CMD 调用带有参数的函数

> ID：14485086
> 
> 赞同：1
> 
> 时间：2013-01-23T16:55:25.913
> 
> 标签：scala

我是 scala 的新手，我一直在到处寻找如何找到如何构造我用我的函数编写的文件。此外，如何从 cmd 调用该函数。我正在尝试编写一个简单的函数，就像只是为了了解如何开始编写程序。像下面这样简单的任何东西都会很有用。

`def test (n : Int){ println(n + n) }`

请记住，我是在 Notepadd ++ 中编写的。我的第一个任务是格雷码。所以我的最终目标是弄清楚文件是如何运行的，函数是如何被调用的。下面有很多格雷码的解决方案是1。

```
def gray(n: Int) ={
def gray(n: Int, res: List[String]): List[String] = {
     val nRes = res.map("0" + _) ::: res.reverse.map("1" + _)
         if(n == 1) nRes
           else gray(n-1, nRes);
    }
   gray(n, List(""))
} 
```

我尝试过的事情是制作一个目标文件并运行它并解析参数以传递给一个函数。

```
object test1 {
   def main(args: String) {
     n = args.toInt
  test(n);
}
def test(n: Int){
    println( n + n)
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:25:39.083

`test1`缺少 的`val`声明`n = args.toInt`。添加它会给出以下编译好的代码。

```
object test1 {
  def main(args: String) {
    val n = args.toInt
    test(n);
  }
  def test(n: Int){
   println( n + n)
  }
} 
```

在 REPL 中加载它会显示`defined module test1`. 然后你可以调用`test1.main("1")`which calls`test`并打印出 2。如果你不熟悉 REPL，请参阅此[链接](http://www.scala-lang.org/node/2097)。

```
scala> :load Test1.scala
Loading Test1.scala...
defined module test1

scala> test1.main("1")
2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T20:37:02.760

我实际上是在玩了一点之后才弄清楚的。解决方案就像 Console.readInt 一样简单。这会抓取用户在控制台中输入的任何值。

```
object project1{
def main(args: Array[String]) {
println("Hello World")
println("Enter a number")

val x = Console.readInt

test(x);
 // println(x)
}
def test(x: Int){
    println( x + x)
    }
} 
```

在控制台上时，您只需键入 scale project1.scala 即可运行该函数，就像您使用 java 或 C++ 一样，当您输入一个键时，该值将从屏幕中获取。

所以上面的控制台看起来像。

桌面/> scala helloWorld.scala

Hello World
输入数字
3
6

# java - 在android中创建全局函数

> ID：14485095
> 
> 赞同：11
> 
> 时间：2013-01-23T16:55:56.543
> 
> 标签：java, android

我想做的是创建一个具有各种功能的java文件，我想在整个项目中使用它。例如检查 Internet 连接。然后我想在每个活动上调用该函数。有谁知道这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-23T17:04:12.663

像这样创建类并在此处添加您的功能：

```
package com.mytest;

import android.content.Context;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;

public class MyGlobals{
    Context mContext;

    // constructor
    public MyGlobals(Context context){
        this.mContext = context;
    }

    public String getUserName(){
        return "test";
    }

    public boolean isNetworkConnected() {
          ConnectivityManager cm = (ConnectivityManager) mContext.getSystemService(Context.CONNECTIVITY_SERVICE);
          NetworkInfo ni = cm.getActiveNetworkInfo();
          if (ni == null) {
           // There are no active networks.
           return false;
          } else
           return true;
    }
} 
```

然后在您的活动中声明实例：

```
MyGlobals myGlog; 
```

然后初始化并使用该全局类中的方法：

```
myGlog = new MyGlobals(getApplicationContext());
String username = myGlog.getUserName();

boolean inConnected = myGlog.isNetworkConnected(); 
```

您的清单文件中所需的权限：

```
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

谢谢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T17:08:32.343

像这样创建实用程序类：

```
public final class AppUtils {

    private AppUtils() {
    }

@SuppressLint("NewApi")
    public static void setTabColor(TabHost tabHost) {
        int max = tabHost.getTabWidget().getChildCount();
        for (int i = 0; i < max; i++) {
            View view = tabHost.getTabWidget().getChildAt(i);
                    TextView tv = (TextView) view.findViewById(android.R.id.title);
                    tv.setTextColor(view.isSelected() ? Color.parseColor("#ED8800") : Color.GRAY);
                    view.setBackgroundResource(R.color.black);
            }
        }

} 
```

现在，在任何类别的 Android 应用程序中，您都可以像这样使用 Apputils：

```
AppUtils.setTabColor(tabHost); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T16:58:38.790

这可能不是最好的方法，并且会有其他人可能会提出一些更好的选择，但这就是***我***会做的。

创建一个包含所有功能的类并将其保存为可能**`Utility.java`**.

在需要调用任何函数的代码中使用 Utility 类的对象。

```
Utility myUtilObj = new Utility();
myUtilObj.checkInternet(); 
```

或者也许使**函数静态**，你可以简单地使用**`Utility.checkInternet()`**你需要调用它的地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-11T03:38:27.240

只需使用方法创建`public`类`static`，就像这样......

```
package com.example.test1;

public class GlobalMethod {

    public static String getHelloWorld() {
        return "Hello, World!";
    }

    public static int getAppleCount() {
        return 45;
    }
} 
```

现在，您可以从任何地方调用方法...

```
GlobalMethod.getHelloWorld();
GlobalMethod.getAppleCount(); 
```

有很多方法可以做，请查看其他答案。希望这会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T16:59:03.507

您可以创建一个实用程序类，它具有一组静态方法（假设这样的类不拥有任何自己的真实状态）。现在可以从应用程序的不同部分调用这些静态方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-30T23:31:53.710

我在下面描述我是如何实现它的。首先，我在中创建了以下类`app/src/main/java/com/[my folder]/MyGlobals.java`：

```
package [My package];

import android.content.Context;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;

public class MyGlobals {
    Context mContext;
    // Constructor
    public MyGlobals(Context context){
        this.mContext = context;
    }
    public boolean checkInternetConnection() {
        ConnectivityManager cm = (ConnectivityManager) mContext.getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo netInfo = cm.getActiveNetworkInfo();
        if ((cm != null) && (netInfo != null)) {
            if (netInfo.isConnected()) {
                return true;
            }
        }
        return false;
    }
} 
```

然后在需要使用全局函数的类中，我声明了这些成员变量：

```
MyGlobals myGlobals;
boolean checkInternetConnection; 
```

在我需要测试互联网连接的代码部分中，我使用了这个：

```
myGlobals = new MyGlobals(getApplicationContext());
checkInternetConnection = myGlobals.checkInternetConnection();
if(checkInternetConnection == false){
    Util.showToast([Name of my activity].this, getString(R.string.nointernet), getString(R.string.error), true, false);
    return;
} 
```

# 3d - XNA 检查 3D 点是否在模型内 (fbx)

> ID：14485096
> 
> 赞同：0
> 
> 时间：2013-01-23T16:55:56.747
> 
> 标签：3d, xna, coordinates, point, fbx

我和我的朋友正在开发一台 3D 打印机。我们完成了硬件方面的工作，包括微控制器的编程。现在我们要分析现有的 3D 模型。这包括一种检查特定坐标 (3d) 是否在我们要打印的 3D 模型（FBX 模型）内部或外部的方法。目前我们正在研究 Unity3D 和 XNA。我想出了我可以用边界框做什么，但这不是解决 XNA 问题的聪明方法。所以我的问题是有什么聪明的方法来获取这些信息。

非常感谢您的支持；-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:53:35.893

# 算法

您正在寻找一种方法来确定一个点是否位于凹壳内。这可以通过将[多边形中的点](http://en.wikipedia.org/wiki/Point_in_polygon)算法扩展到三个维度来完成。

这个想法是您通过该点投射光线并计算与体积的外壳（多边形）的交点。如果点两侧的射线三角形交点的数量是奇数，则它位于体积内。

如果性能是一个问题，简化的包围体仍然很有用。如果计算光线-多边形交点的成本很高，您首先要检查该点是否位于网格的近似外壳内，这具有较低的性能成本（例如边界框、凸包）。这样你就可以尽早放弃积分。

这是Polygon算法的另一个详细解释和C中的实现：

*   [确定点是否在复杂多边形内](http://alienryderflex.com/polygon/)

# 选择正确的编程环境

我不确定你为什么要使用 XNA 甚至 Unity 来完成这项任务。当然，两者都提供加载 3D 模型的能力，但肯定有更简单、更高效的替代方案。

对于上述算法，您需要访问模型的顶点位置和三角形定义，仅此而已。如果不需要 FBX，我建议查看[Wavefront OBJ](http://en.wikipedia.org/wiki/Wavefront_.obj_file)文件格式。它是一种基于文本的格式，易于理解/解析，并受到几乎所有专业 3D 建模应用程序的支持。

*   [波前 OBJ 规范](http://netghost.narod.ru/gff/vendspec/waveobj/obj_spec.txt)
*   [OBJ 文件示例](http://people.sc.fsu.edu/~jburkardt/data/obj/obj.html)

*如果*需要FBX ，您仍然可以尝试自己解析它们或仅使用现有的 3D 转换器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T18:54:04.100

一个非常快速的解决方案（绝对不需要数学）来测试一个点是否在一个实体（封闭的表面集）内，就像您已经推测的那样使用 3D 游戏引擎。正如 Lucius 指出的那样，这有点像用起重机压碎苍蝇。但是，它会用很少的努力工作。

为了证实这一点，我在使用 Panda3D 之前已经这样做了（如果可以使用任何 3D 引擎，我不会感到惊讶）。

碰撞检测很有用。正如 Lucius 指出的那样，您想要检测表面。所以，使用 Panda 所说的“RayCollider”（基本上是一条线），看看它与 3D 模型表面相交的次数。Panda 已经拥有执行此操作的辅助函数，并且在下载 SDK 时，包含许多使用 RayColliders 检测表面的完整代码示例。

然后，遍历所有 x、y、z 空间并使用 panda 辅助函数来移动射线的原点是一件很简单的事情。如果它与奇数个表面碰撞 - 你就在里面。否则，你在外面。

与 Panda3D 的完整代码示例相比，这项任务实际上非常琐碎。学习曲线主要用于熟悉引擎而不是数学。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T14:16:06.457

我会使用体素来完成这样的任务。您的 3D 打印机在所有轴上都有一定的分辨率，因此您可以为体素空间假设类似的分辨率。将体素场值转换为打印机运动相对容易，因此最难的是将网格转换为体素。我相信你可以找到一些图书馆。

您可以从这里开始： [知道任何体素图形 C++ 库吗？](https://stackoverflow.com/questions/8022123/know-any-voxel-graphics-c-libraries)

# c# - Lucene.Net 如何存储仅索引字段？

> ID：14485098
> 
> 赞同：1
> 
> 时间：2013-01-23T16:55:59.097
> 
> 标签：c#, .net, lucene, lucene.net

> **可能重复：**
> [lucene 如何索引文档？](https://stackoverflow.com/questions/2602253/how-does-lucene-index-documents)

Lucene 允许对文档的某些（或全部）字段进行索引，仅返回一个 ID，然后可以使用该 ID 查询数据库以获取实际信息。然而，为了能够在那时进行搜索，Lucene 必须以某种方式存储这些字段。

这究竟是如何完成的？仅索引字段是否组合成散列或树状结构，然后用于搜索？是否有任何关于 Lucene 如何搜索这些仅索引字段的文档？

我主要关心的是了解索引数据存储在高度敏感的环境中的安全性。或者换句话说，检索索引字段并将它们与文档相关联以及因此与该文档中的其他字段相关联的难度/容易程度。

# regex - 格式化货币值 - 搜索和替换/正则表达式？

> ID：14485104
> 
> 赞同：1
> 
> 时间：2013-01-23T16:56:15.203
> 
> 标签：regex, currency, replace

我想知道是否有人可以帮助解决这个问题？我有文本文件（已经通过听写/转录包），其中包含需要以正确格式放入的金额。

原价：$1489.05 >> 应该是 $1,149.05

原价：$1489 >> 应该是 $1,489.00

原件：$32,000 >> 应该是 $32,000.00

所以换句话说 - 没有小数的金额需要添加 .00，超过 1000 的金额需要添加逗号。

一个轻微的复杂情况是，超过 10 000 的数量已经有一个逗号。

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:18:02.507

**编辑：修改了额外的步骤以适应丢失`$`**
**编辑：修改了步骤 1 和 2 以适应偶尔`,`丢失的情况`$`**

这需要使用三个正则表达式分三个步骤完成。

**第1步**

将正则表达式模式`(^|[^$,\d])(\d*?,?\d{3}(?:[^\d]|$))`与替换字符串一起使用`\1$\2`。

这将修复丢失的美元符号。

**第2步**

将正则表达式模式`(\$\d+)(\d{3})`与替换字符串一起使用`\1,\2`。

这将修复缺少的逗号。

**第 3 步**

将正则表达式模式`(\$[0-9,]++)(?!\.)`与替换字符串一起使用`\1.00`。
（如果您的正则表达式引擎不支持所有格量​​词，请使用替代模式
`(\$[0-9,]+)(?![0-9.,])`。）

这将修复丢失的美分。

**注意**这些适用于[TextWrangler](http://www.barebones.com/products/textwrangler/index.html)（和其他使用 PCRE 的应用程序）。您可能需要调整替换字符串以适应其他正则表达式引擎作为某些用途`$1`，甚至`\\1`代替`\1`.

# java - 是否存在线程安全的 statsd 客户端？

> ID：14485105
> 
> 赞同：4
> 
> 时间：2013-01-23T16:56:16.237
> 
> 标签：java, multithreading, thread-safety, graphite, statsd

我需要`statsd`在 Web 应用程序中使用线程安全客户端来监视用户线程的统计信息。请提出一个既线程安全又不影响性能的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:27:32.977

[示例目录](https://github.com/etsy/statsd/tree/master/examples)中的 Java 客户端[StatsdClient.java](https://github.com/etsy/statsd/blob/master/examples/StatsdClient.java)怎么样？他们在 Java 客户端实现中使用同步。在类注释中是一个用法示例：

```
StatsdClient client = new StatsdClient("statsd.example.com", 8125);
// increment by 1
client.increment("foo.bar.baz"); 
```

1.  `increment(String)`代表到
2.  `increment(String, int)`哪个代表
3.  `increment(String, int, double)`它生成一个要调用的字符串
4.  `send(double, String...)`最后调用
5.  `sendTo(String)`它使用修饰符**`synchronized`**

这也适用于此类中的其他方法。当然，将所有相关方法声明为`synchronized`不会创建线程安全类。但我相信 Etsy 在这里考虑到了这一点并做到了这一点。

# c++ - 如何从宏中为Stata中的变量赋予标签

> ID：14485111
> 
> 赞同：2
> 
> 时间：2013-01-23T16:56:33.940
> 
> 标签：c++, plugins, label, stata

我想用一个插件创建变量，它导入一个数据库表。我正在使用以下代码来执行此操作：

> SF_macro_save("_vars", "var1 var2...");
> SF_macro_save("_types", "type1 type2...");
> SF_macro_save("_formats", "format1 format2...");
> SF_macro_save("_obs", "obs1 obs2...");

这可以很好地创建变量，但我不知道如何为变量或值赋予标签。

我需要使用哪个 C++ 函数来创建标签？或者如何从 C++ 调用 Stata 函数？（如果重要的话，我正在使用 Visual Studio 10）

我想从插件中调用这个Stata函数：

> 标签变量 var1 label1

和

> 标签定义 var1_label 1 "label1" 2 "label2" 标签值 var1 var1_label

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-06T11:35:16.150

这是可能的，但并不容易。基本上，您在代码中创建一个 .do 文件（下面的 C# 示例），然后执行该 .do 文件。这是一个运行 .do 文件然后使用 ODBC 将结果放入 SQL Server 数据库的示例。您可以使用 Stat/Transfer 执行类似的操作，将数据和变量标签加载到数据库中。

```
 string m_stcmd_valuelabels = Server.MapPath("~/Data/Cmd/Stata/") + m_filename_noex + "_valuelables.do";

            using (StreamWriter m_sw_stcmd_valuelabels = new StreamWriter(m_stcmd_valuelabels, false))
            {

                m_sw_stcmd_valuelabels.WriteLine("clear");
                m_sw_stcmd_valuelabels.WriteLine("set mem 500m");
                m_sw_stcmd_valuelabels.WriteLine("set more off");
                m_sw_stcmd_valuelabels.WriteLine("use  \"" + m_fullpath.Replace(".zip", ".dta") + "\"");
                m_sw_stcmd_valuelabels.WriteLine("valtovar _all, dis");
                m_sw_stcmd_valuelabels.WriteLine("uselabel");
                m_sw_stcmd_valuelabels.WriteLine("ren lname varname");
                m_sw_stcmd_valuelabels.WriteLine("drop trunc");
                m_sw_stcmd_valuelabels.WriteLine("odbc insert, dsn(\"MyData\") table(\"" + m_filename_noex + "_valuelabels\") create " + m_statadsn_conn);
                m_sw_stcmd_valuelabels.WriteLine("exit");
                m_sw_stcmd_valuelabels.WriteLine();
            }

            string str_PathValueLabels = Server.MapPath("~/Data/Stata12/StataMP-64.exe");

            ProcessStartInfo processInfoValueLabels = new ProcessStartInfo("\"" + str_PathValueLabels + "\"");
            processInfoValueLabels.Arguments = " /e do \"" + m_stcmd_valuelabels + "\"";
            processInfoValueLabels.UseShellExecute = false;
            processInfoValueLabels.ErrorDialog = false;

            Process batchProcessValueLabels = new Process();
            batchProcessValueLabels.StartInfo = processInfoValueLabels;
            batchProcessValueLabels.Start(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-14T05:24:52.200

你不能从插件中做到这一点。您不能创建变量、标签。等等..从你的 dll 中，数据集必须在你调用插件之前定义，你可能已经知道了。您可以将数据值存储回变量中，但如果您愿意，则无​​需添加“列”。您可以将所需的名称存储在宏中，但它将落在您的“.do”文件中以将它们分配给 Stata 中的变量，对不起。

# php - 使用图像推子脚本时的 php 问题

> ID：14485114
> 
> 赞同：0
> 
> 时间：2013-01-23T16:56:38.823
> 
> 标签：php

我在使用以下代码时遇到问题。我认为这是错误使用单引号/双引号的问题，但无法弄清楚，有人可以建议吗？

```
foreach ($page->images as $image) {
    echo '<img src= "<?php echo $image->url;?>" >';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T16:59:30.583

PHP 语法规则。引用的字符串`'`不插入变量值。您的脚本正在将文字`<`, `?`, `p`, `h`, 等转储到浏览器中。

您也不能在字符串中运行 php 代码。

尝试

```
foreach(...) {
   echo "<img src='{$image->url}'>";
} 
```

反而

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T16:59:24.250

无需重新声明 PHP & echo。所以你的代码看起来像这样：

```
foreach ($page->images as $image) {
  echo '<img src= "<?php echo $image->url;?>" >';
} 
```

应该是这样的：

```
foreach ($page->images as $image) {
  echo '<img src= "' . $image->url . '" >';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:00:46.750

不解释单引号字符串中的变量。您也不需要字符串中的 php 标签和回显。尝试改变

```
echo '<img src= "<?php echo $image->url;?>" >'; 
```

至

```
echo '<img src= "'.$image->url.'" >'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T16:59:17.607

尝试改用这个：

```
foreach ($page->images as $image) {

                echo "<img src= '{$image->url}' >";

            } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T16:59:02.293

试试这个语法：

```
echo '<img src="' , $image->url , '">'; 
```

您已经在 php 中，因此无需`<?php`再次添加`echo`

# c# - 同步等待一个异步操作，为什么Wait()会在这里冻结程序

> ID：14485115
> 
> 赞同：357
> 
> 时间：2013-01-23T16:56:39.220
> 
> 标签：c#, .net, task-parallel-library, windows-store-apps, async-await

**前言**：我正在寻找一个解释，而不仅仅是一个解决方案。我已经知道解决方案了。

尽管花了几天时间研究有关基于任务的异步模式 (TAP)、async 和 await 的 MSDN 文章，但我仍然对一些更精细的细节感到有些困惑。

我正在为 Windows 应用商店应用程序编写记录器，并且我想同时支持异步和同步记录。异步方法遵循 TAP，同步方法应该隐藏所有这些，并且看起来和工作起来像普通方法。

这是异步日志的核心方法：

```
private async Task WriteToLogAsync(string text)
{
    StorageFolder folder = ApplicationData.Current.LocalFolder;
    StorageFile file = await folder.CreateFileAsync("log.log",
        CreationCollisionOption.OpenIfExists);
    await FileIO.AppendTextAsync(file, text,
        Windows.Storage.Streams.UnicodeEncoding.Utf8);
} 
```

现在对应的同步方法...

**版本 1**：

```
private void WriteToLog(string text)
{
    Task task = WriteToLogAsync(text);
    task.Wait();
} 
```

这看起来是正确的，但它不起作用。整个程序永远冻结。

**版本 2**：

嗯..也许任务没有开始？

```
private void WriteToLog(string text)
{
    Task task = WriteToLogAsync(text);
    task.Start();
    task.Wait();
} 
```

这抛出`InvalidOperationException: Start may not be called on a promise-style task.`

**版本 3：**

嗯..`Task.RunSynchronously`听起来很有希望。

```
private void WriteToLog(string text)
{
    Task task = WriteToLogAsync(text);
    task.RunSynchronously();
} 
```

这抛出`InvalidOperationException: RunSynchronously may not be called on a task not bound to a delegate, such as the task returned from an asynchronous method.`

**版本 4（解决方案）：**

```
private void WriteToLog(string text)
{
    var task = Task.Run(async () => { await WriteToLogAsync(text); });
    task.Wait();
} 
```

这行得通。因此，2 和 3 是错误的工具。但是1? 1有什么问题，4有什么区别？是什么让 1 导致冻结？任务对象有问题吗？是否存在不明显的死锁？

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2013-01-23T16:59:06.310

您的`await`异步方法内部正在尝试返回 UI 线程。

由于 UI 线程忙于等待整个任务完成，因此您遇到了死锁。

移动异步调用来`Task.Run()`解决问题。
因为异步调用现在在线程池线程上运行，它不会尝试返回 UI 线程，因此一切正常。

或者，您可以`StartAsTask().ConfigureAwait(false)`在等待内部操作之前调用以使其返回线程池而不是 UI 线程，从而完全避免死锁。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2013-01-23T17:08:56.320

从同步代码调用`async`代码可能非常棘手。

我在我的博客上解释了[这个僵局的全部原因](http://blog.stephencleary.com/2012/07/dont-block-on-async-code.html)。简而言之，有一个“上下文”默认保存在每个开头`await`并用于恢复该方法。

因此，如果在 UI 上下文中调用它，当`await`完成时，该`async`方法会尝试重新进入该上下文以继续执行。不幸的是，使用`Wait`(or `Result`) 的代码将阻塞该上下文中的线程，因此该`async`方法无法完成。

避免这种情况的准则是：

1.  `ConfigureAwait(continueOnCapturedContext: false)`尽可能多地使用。这使您的`async`方法能够继续执行而无需重新进入上下文。
2.  `async`一路使用。使用`await`代替`Result`or `Wait`。

如果您的方法自然是异步的，那么[您（可能）不应该公开同步包装器](http://blogs.msdn.com/b/pfxteam/archive/2012/04/13/10293638.aspx)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-10-25T23:34:24.877

这是我所做的

```
private void myEvent_Handler(object sender, SomeEvent e)
{
  // I dont know how many times this event will fire
  Task t = new Task(() =>
  {
    if (something == true) 
    {
        DoSomething(e);  
    }
  });
  t.RunSynchronously();
} 
```

工作得很好，不会阻塞 UI 线程

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-27T13:27:06.827

使用小的自定义同步上下文，同步函数可以等待异步函数完成，而不会造成死锁。这是 WinForms 应用程序的小示例。

```
Imports System.Threading
Imports System.Runtime.CompilerServices

Public Class Form1

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        SyncMethod()
    End Sub

    ' waiting inside Sync method for finishing async method
    Public Sub SyncMethod()
        Dim sc As New SC
        sc.WaitForTask(AsyncMethod())
        sc.Release()
    End Sub

    Public Async Function AsyncMethod() As Task(Of Boolean)
        Await Task.Delay(1000)
        Return True
    End Function

End Class

Public Class SC
    Inherits SynchronizationContext

    Dim OldContext As SynchronizationContext
    Dim ContextThread As Thread

    Sub New()
        OldContext = SynchronizationContext.Current
        ContextThread = Thread.CurrentThread
        SynchronizationContext.SetSynchronizationContext(Me)
    End Sub

    Dim DataAcquired As New Object
    Dim WorkWaitingCount As Long = 0
    Dim ExtProc As SendOrPostCallback
    Dim ExtProcArg As Object

    <MethodImpl(MethodImplOptions.Synchronized)>
    Public Overrides Sub Post(d As SendOrPostCallback, state As Object)
        Interlocked.Increment(WorkWaitingCount)
        Monitor.Enter(DataAcquired)
        ExtProc = d
        ExtProcArg = state
        AwakeThread()
        Monitor.Wait(DataAcquired)
        Monitor.Exit(DataAcquired)
    End Sub

    Dim ThreadSleep As Long = 0

    Private Sub AwakeThread()
        If Interlocked.Read(ThreadSleep) > 0 Then ContextThread.Resume()
    End Sub

    Public Sub WaitForTask(Tsk As Task)
        Dim aw = Tsk.GetAwaiter

        If aw.IsCompleted Then Exit Sub

        While Interlocked.Read(WorkWaitingCount) > 0 Or aw.IsCompleted = False
            If Interlocked.Read(WorkWaitingCount) = 0 Then
                Interlocked.Increment(ThreadSleep)
                ContextThread.Suspend()
                Interlocked.Decrement(ThreadSleep)
            Else
                Interlocked.Decrement(WorkWaitingCount)
                Monitor.Enter(DataAcquired)
                Dim Proc = ExtProc
                Dim ProcArg = ExtProcArg
                Monitor.Pulse(DataAcquired)
                Monitor.Exit(DataAcquired)
                Proc(ProcArg)
            End If
        End While

    End Sub

     Public Sub Release()
         SynchronizationContext.SetSynchronizationContext(OldContext)
     End Sub

End Class 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-06-18T16:27:25.913

对我来说实际上是最好的工作解决方案：

```
AsyncMethod(<params>).ConfigureAwait(true).GetAwaiter().GetResult(); 
```

也可以在`UI-Content`没有阻塞和调度程序问题的情况下工作，也可以来自 CTOR。

# javascript - AngularJs位置路径更改而所有控制器都没有重置

> ID：14485117
> 
> 赞同：8
> 
> 时间：2013-01-23T16:56:47.623
> 
> 标签：javascript, angularjs

我的问题的简短版本是：如何在不需要触发路由更改或不需要在当前显示的页面上运行所有控制器的情况下更改 URL？

**细节：**

我有一个显示在其中的模板，该模板`<ng-view>`具有由 3 个控制器管理的区域。在页面的最顶部，我有一个交互式地图。当您单击区域时，它会广播一次单击，其他组件会接收并显示有关该区域的数据。非常简单的设置。

我想做的是允许我的用户深度链接到内容。因此，每次有人单击链接时，我都想更改可以复制并粘贴到另一个浏览器的 URL。其他一些用户只需单击链接并看到第一个看到的相同状态。

目前我使用与此类似的代码更改位置：

```
 $scope.$on('mapRegionClick', function($scope, regionCode) {
    var url = generateURL(regionCode);

    $scope.currentScope.$apply(function(){
      $location.path(url);
    });}); 
```

然后在我的路由中提取 URL，并且地图和数据正确显示。这样做的缺点是每次我点击地图和 URL 更改时，都会重新生成整个模板/视图。因为生成地图有点繁重，所以我只想触发对数据呈现控制器的更改。

是否可以？如何？

我可以在控制器之间进行一些通信并实现我的目标，但是我将无法进行深度链接。

PS：我不想用`$location.search()`and `reloadOnSearch=false`。我的链接必须很漂亮:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-26T07:54:42.167

听起来你不想使用[`$route`](http://docs.angularjs.org/api/ngRoute.%24route)服务。

该`$route`服务旨在重新加载控制器，以便导航到 URL 和刷新 URL 之间没有区别。我们通过对每个 URL 更改进行完全重新加载来做到这一点。这是故意的。

听起来像您的用例，不应该使用`$route`, 只是[`$location`](http://docs.angularjs.org/api/ng.%24location)and [`ng-include`](http://docs.angularjs.org/api/ng.directive%3angInclude)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-07T11:04:24.437

您可以使用[$locationChangeStart](https://docs.angularjs.org/api/ng/service/$location#event-$locationChangeStart)事件将先前的值存储在服务中`$rootScope`或服务中。当您回来时，只需从 $rootScope 初始化所有先前存储的值。使用 . 查看这个快速演示`$rootScope`。

[![在此处输入图像描述](../Images/dd7b64c5ebe719e5bbe2136f36afa76f.png)](https://i.stack.imgur.com/ViFaP.gif)

```
var app = angular.module("myApp", ["ngRoute"]);
app.controller("tab1Ctrl", function($scope, $rootScope) {
    if ($rootScope.savedScopes) {
        for (key in $rootScope.savedScopes) {
            $scope[key] = $rootScope.savedScopes[key];
        }
    }
    $scope.$on('$locationChangeStart', function(event, next, current) {
        $rootScope.savedScopes = {
            name: $scope.name,
            age: $scope.age
        };
    });
});
app.controller("tab2Ctrl", function($scope) {
    $scope.language = "English";
});
app.config(function($routeProvider) {
    $routeProvider
        .when("/", {
            template: "<h2>Tab1 content</h2>Name: <input ng-model='name'/><br/><br/>Age: <input type='number' ng-model='age' /><h4 style='color: red'>Fill the details and click on Tab2</h4>",
            controller: "tab1Ctrl"
        })
        .when("/tab2", {
            template: "<h2>Tab2 content</h2> My language: {{language}}<h4 style='color: red'>Now go back to Tab1</h4>",
            controller: "tab2Ctrl"
        });
});
```

```
<!DOCTYPE html>
<html>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>
<body ng-app="myApp">
    <a href="#/!">Tab1</a>
    <a href="#!tab2">Tab2</a>
    <div ng-view></div>
</body>
</html>
```

# c# - 如果新驱动器连接到计算机，如何收到通知

> ID：14485118
> 
> 赞同：0
> 
> 时间：2013-01-23T16:56:54.727
> 
> 标签：c#, filesystemwatcher

> **可能重复：**
> [寻找用于检测可移动驱动器（USB 闪存）的 C# 代码](https://stackoverflow.com/questions/715739/looking-for-c-sharp-code-for-detecting-removable-drive-usb-flash)

我正在使用 C# 和 WPF。我的应用程序有一个自定义对话框，显示连接到计算机的所有驱动器，并允许用户导航到特定文件夹，其中文件将由手头的进程输出。我没有使用通用文件夹选择器对话框，因为我需要该通用对话框中不包含的功能，并且需要使对话框的外观与我的应用程序样式保持一致。

该功能的目的是允许用户将数据导出到拇指驱动器，因此我希望我的应用程序在新驱动器可用时接收通知。我在内部使用字符串“::{20D04FE0-3AEA-1069-A2D8-08002B30309D}”来表示 MyComputer 特殊文件夹。

我尝试将相同的字符串传递给`FileSystemWatcher`该类的实例，但这告诉我该字符串不是有效路径。所以看起来我无法以这种方式实现我想要的。

从操作系统接收新拇指驱动器已添加到计算机并将其添加到我的`TreeView`控件的通知的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:27:15.107

> 我在内部使用字符串“...”来表示 MyComputer 特殊文件夹

这行不通。它确实是一个*特殊*的文件夹，它实际上并不存在于文件系统中。这些是Windows 资源管理器中的*虚拟*文件夹，由 shell 命名空间扩展实现。演示很方便，它允许给出“事物存储在文件夹中”范式的一致视图。但是如果文件系统上没有真正的文件夹，FileSystemWatcher 就无法生成更改通知。

获取驱动器附件通知需要监听即插即用事件。通常以 WM_DEVICECHANGE 消息开头。您并不完全希望自己编写此代码，设置 api 非常坚韧，而且 pinvoke 也很困难。您也不必这样做，它之前已经被包装了很多次，以使其易于在 C# 程序中使用。按照对您的问题的评论中给出[的链接进行操作。](https://stackoverflow.com/questions/715739/looking-for-c-sharp-code-for-detecting-removable-drive-usb-flash)

# asp.net-mvc - asp.net mvc EF代码中的多对多关系优先

> ID：14485119
> 
> 赞同：1
> 
> 时间：2013-01-23T16:56:55.063
> 
> 标签：asp.net-mvc, entity-framework, ef-code-first, code-first

我正在使用 asp.net mvc 4、EF、codefirst 与用户和角色系统建立多对多关系

用户模型：

```
public class User
{
    #region properties

    [Key]
    public Int32 Id { get; set; }

    [Required]
    public String UserName { get; set; }

    public String Password { get; set; }

    [Required]
    public String Email { get; set; }

    public DateTime CreationDate { get; set; }

    public   DateTime LastUpdate { get; set; }

    public DateTime? LastLogin { get; set; }

    [ForeignKey("RoleId")]
    public virtual ICollection<Role> Roles { get; set; }

    #endregion //properties

    #region constructors

    public User()
    {
        Roles = new HashSet<Role>();

        LastUpdate = DateTime.Now;
        CreationDate = DateTime.Now;
    }

    #endregion //constuctors
} 
```

榜样：

```
public class Role
{
    [Key]
    public Int32 Id { get; set; }
    public String Name { get; set; }
    public String Description { get; set; }
    public DateTime CreationDate { get; set; }
    public DateTime LastUpdate { get; set; }

    [ForeignKey("UserId")]
    public virtual ICollection<User> Users { get; set; }

    public Role() 
    {
        Users = new HashSet<User>();

        CreationDate = DateTime.Now;
        LastUpdate = DateTime.Now;
    }
} 
```

上下文：

```
public class UserManagementContext : Context, IContext
{
    public DbSet<User> Users { get; set; }
    public DbSet<Role> Roles { get; set; }

    public UserManagementContext() {
        Database.SetInitializer<UserManagementContext>(null);
    }

    void IContext.Setup(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<User>().ToTable("Users");
        modelBuilder.Entity<Role>().ToTable("Roles");   
        modelBuilder.Entity<User>()
            .HasMany(u => u.Roles)
            .WithMany(r => r.Users)
            .Map(
                m =>
                {
                    m.MapLeftKey("UserId");
                    m.MapRightKey("RoleId");
                    m.ToTable("UserRoles");
                });
    }
} 
```

当生成数据库表时，表用户、角色和用户角色就在那里。然后我在用户中做一个记录，一个在角色中，一个在用户角色中以连接它们。userroles 表有两列 RoleId 和 UserId。

然后我尝试像这样加载用户的角色：

```
public String[] GetRoles(String userName)
    {           
        //var user = ConcreteContext.Users.Include("Roles").Where(u => u.UserName == userName).FirstOrDefault();
        var users = ConcreteContext.Users.Include(u => u.Roles);
        var user = users.FirstOrDefault();

        var roles = from r in user.Roles
                    select r.Name;
        return roles.ToArray();
    } 
```

但是带有的行`var users = ConcreteContext.Users.Include(u => u.Roles);`引发了下一个错误：

`System.Data.SqlClient.SqlException: Invalid object name 'dbo.RoleUsers'.`

如果在创建数据库时（通过使用）将 UserRoles 的 de 表名称更改为 RoleUsers `m.ToTable(RoleUsers)`，我会收到很多关于错误字段名称的不同错误。

有人知道我在这里缺少什么吗？

提前致谢，

威廉

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T21:07:03.687

为什么必须使用 Fluent API？

您可以像这样使用数据属性映射多对多：

```
public class User
{
    [InverseProperty( "Users" )]
    public virtual ICollection<Role> Roles {get;set;}
}

public class Role
{
    [InverseProperty( "Roles" )]
    public virtual ICollection<User> Users {get;set;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T13:00:26.347

这将做我需要的：

```
public class User
{
    #region properties

    [Key]
    public Int32 Id { get; set; }

    [Required]
    public String UserName { get; set; }

    public String Password { get; set; }

    [Required]
    public String Email { get; set; }

    public DateTime CreationDate { get; set; }

    public   DateTime LastUpdate { get; set; }

    public DateTime? LastLogin { get; set; }

    [InverseProperty("Users")]
    public virtual ICollection<Role> Roles { get; set; }

    #endregion //properties

    #region constructors

    public User()
    {
        LastUpdate = DateTime.Now;
        CreationDate = DateTime.Now;
    }

    #endregion //constuctors
}

    public class Role
{
    [Key]
    public Int32 Id { get; set; }
    public String Name { get; set; }
    public String Description { get; set; }
    public DateTime CreationDate { get; set; }
    public DateTime LastUpdate { get; set; }

    [InverseProperty("Roles")]
    public virtual ICollection<User> Users { get; set; }

    public Role() 
    {
        CreationDate = DateTime.Now;
        LastUpdate = DateTime.Now;
    }
}

public class UserManagementContext : Context, IContext
{
    public DbSet<User> Users { get; set; }
    public DbSet<Role> Roles { get; set; }

    public UserManagementContext() {
        Database.SetInitializer<UserManagementContext>(null);
    }

    void IContext.Setup(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<User>().ToTable("Users");
        modelBuilder.Entity<Role>().ToTable("Roles");               
    }
} 
```

# java - 通过 GET 参数进行 Spring 安全授权

> ID：14485122
> 
> 赞同：1
> 
> 时间：2013-01-23T16:57:07.393
> 
> 标签：java, spring, spring-mvc, spring-security

我正在尝试让 Spring Security 通过 GET 变量处理授权。我能找到的所有示例几乎完全集中在基于角色的授权上，这对我的应用程序并不适用。身份验证/授权过程需要工作的方式如下：

1.  用户通过外部系统进行身份验证，获取会话 ID。
2.  用户将两个 GET 参数传递给我的应用程序 sessionId 和 objectId。
3.  应用程序验证会话有效（已经弄清楚这部分）
4.  应用程序验证对象对用户可见（此处需要帮助）
5.  应用程序向用户返回对象信息

我看到的所有示例都展示了 Spring Security 可以多么强大地检查 URL 模式或 Java 方法上的授予权限。但是我需要在第 4 步中实施自定义检查，以确保用户在后端拥有正确的权限（可以授予用户特定于对象的权限，因此角色方法在这里不起作用）。

我是 Spring Security 的新手，所以我的思维过程可能是各种各样的错误。如果我是，请随时纠正我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:12:03.843

您需要使用[ACL](http://static.springsource.org/spring-security/site/docs/3.2.x/reference/springsecurity-single.html#domain-acls)功能，或者您可以通过一些自定义代码（例如通过自定义 Web 安全表达式）模拟相同的东西。有关详细信息，请参阅[此帖子](https://stackoverflow.com/questions/14275687/denying-access-for-multiple-users-of-same-role-in-spring-security/14276451#14276451)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:13:26.247

我认为您需要查看文档中的[Pre-Authentication Scenarios](http://static.springsource.org/spring-security/site/docs/3.0.x/reference/preauth.html)部分。特别是，您可能需要实现 AbstractPreAuthenticatedProcessingFilter 以根据 GET 参数对用户进行预身份验证。

# drupal-7 - 关于 Drupal7 用户资料和注册

> ID：14485124
> 
> 赞同：0
> 
> 时间：2013-01-23T16:57:15.360
> 
> 标签：drupal-7, user-profile

在我的首页上，用户通过输入他的用户名、电子邮件、密码进行注册..一旦他点击提交，他就会登录并被重定向到他的个人资料编辑页面（不是帐户设置）..我可以使用规则来做到这一点..我正在使用 Profile2 并添加新字段..但是我也希望旧字段（例如用户名、密码和电子邮件 ID）出现在那里...这将是用户在注册时输入的相同密码或用户名和电子邮件 ID，但是我只想在此编辑配置文件页面上创建/显示这些字段以确保完整性。他们可能复制了先前输入的值，用户可以再次在此处输入/编辑它并能够保存（当然，如果他输入，他应该会收到错误该页面上的新电子邮件 ID）

我想要的是这样的：http: [//imgur.com/fa31Xt1](http://imgur.com/fa31Xt1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:20:28.500

为什么不向现有核心配置文件添加字段？admin/config/people/accounts/fields 。在那里您可以添加将显示在用户页面上的新字段。

# java - 具有复合主键的实体类没有 getter 和 setter

> ID：14485125
> 
> 赞同：0
> 
> 时间：2013-01-23T16:57:16.347
> 
> 标签：java, jpa, foreign-keys, composite-primary-key

我有一个实体类 userdetails，它具有用户名、用户 ID（数字）和密码字段，用户名和用户 ID 形成一个复合主键。这是可以协商的，并且可能对主要问题不重要。

我有另一个类，connectiontable，它以 userid 作为主键。用于生成相关表的sql代码如下：

```
create table usertable
(
userid int NOT NULL GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
username varchar(128) NOT NULL UNIQUE,
password varchar(128) NOT NULL, 
CONSTRAINT USER_PK PRIMARY KEY(username, userid)

); 
```

这是usertable的sql代码。以下是用于连接表

```
create table connectiontable
(
userid int not null,
username varchar(128) not null,
connections varchar(32670) not null,

CONSTRAINT CONNECTION_PK PRIMARY KEY(username, userid),
CONSTRAINT CONNECTION_FK FOREIGN KEY(username,userid) REFERENCES usertable(username,userid) 
); 
```

connectiontable 中还有很多其他的东西，但这些都是无关紧要的。我使用 netbeans 7.2.1 和 Jave EE6。我使用“从数据库条目创建实体”，但由于某种原因，我没有用于用户 ID 或用户名的 getter 和 setter。它们在connectiontablePK中，但我似乎无法利用它。例如，当我生成 jsf 页面时，我希望能够执行以下操作：

```
Connectiontable con = new Connectiontable();
con.getUsername(); 
```

但它会抱怨，因为它在 connectiontable.java 中找不到该方法。

谁能告诉我为什么会这样，我该如何解决？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:09:05.057

...您没有发布 Java 代码，我怀疑这会有所帮助，但是：

任何时候在 JPA 中当你有一个复合主键时，你都必须有一个“嵌入式”主键类。我怀疑您的类定义类似于以下内容：

```
@Embeddable
public class UserNameId {
    private int userid;
    private String username;
} 
```

然后`usertable`和`connectiontable`两者都包含以下（或类似的）：

```
@Embedded
@Id
private UserNameId userNameId; 
```

...所以你应该期待一个 getter/setter `userNameId`，而不是嵌入字段，就像你期望的那样。

# magento - Magento 通讯注册源

> ID：14485126
> 
> 赞同：2
> 
> 时间：2013-01-23T16:57:19.787
> 
> 标签：magento, enterprise, mailchimp

我目前正在使用 Ebizmarts MageMonkey 模块将 Mailchimp 与 Magento 集成，用于电子商务商店。我需要发送到 Mailchimp 的数据是名字和姓氏、电子邮件和注册源/位置，例如页眉、页脚、结帐等......我已经成功地能够获得名字、姓氏和电子邮件，但不能弄清楚如何获取注册源/位置。

当用户选择加入我们的时事通讯时，我已经做了很多研究来获取注册源/位置。除了如何将时事通讯块移动到页面上的不同位置之外，我还没有成功找到任何东西。

所以我的问题是，当客户或客人注册我们的时事通讯时，是否有办法获取他们注册的位置，例如页眉、页脚、结帐等...

任何帮助是极大的赞赏。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:43:27.083

时事通讯注册模板位于：

```
app/design/frontend/base/default/customer/form/register.phtml 
```

具体来说是以下几行：

```
<li class="control">
    <div class="input-box">
         <input type="checkbox" name="is_subscribed" title="<?php echo $this->__('Sign up for Newsletter') ?>" value="1" id="is_subscribed"<?php if($this->getFormData()->getIsSubscribed()): ?> checked="checked"<?php endif; ?> class="checkbox" />
    </div>
    <label for="is_subscribed"><?php echo $this->__('Sign Up for Newsletter') ?></label>
    <?php /* Extensions placeholder */ ?>
    <?php echo $this->getChildHtml('customer.form.register.newsletter')?>
</li> 
```

此外，此页面的布局可以在以下位置找到：

```
customer.xml 
```

在布局句柄下：

```
<customer_account_create translate="label"> 
```

定义此块的行：

```
<block type="customer/form_register" name="customer_form_register" template="customer/form/register.phtml">
        <block type="page/html_wrapper" name="customer.form.register.fields.before" as="form_fields_before" translate="label">
        <label>Form Fields Before</label>
</block> 
```

# jquery - 重绘后工具提示在画布上徘徊

> ID：14485127
> 
> 赞同：2
> 
> 时间：2013-01-23T16:57:21.210
> 
> 标签：jquery, html, html5-canvas

我有一个 HTML5 画布应用程序，下面有几个普通按钮。我在按钮上有工具提示，它们在静态情况下似乎工作正常。（我仍然不明白为什么禁用按钮的工具提示与启用按钮的工具提示看起来不同。）

当我将鼠标悬停在启用的按钮上时，其工具提示出现在画布表面上的按钮上方。（这些是普通的 jQuery 工具提示。）当指针离开按钮时，工具提示消失。

但是，如果我按下按钮（当然此时工具提示正在显示），我的按钮会在画布上启动一个动画序列，并且**工具提示会永远留在画布上**。动画开始后将鼠标移动到别处不会取消工具提示。其他工具提示继续正常工作。

在动画过程中，我清理并重绘了数十次画布，但工具提示仍然可见，因此它是独立于画布的自己的矩形。

在重绘动画之前，我尝试将按钮标题设置为 null 和空。都没有帮助。我想为按钮创建一个合成鼠标离开，但我不知道该怎么做。

这发生在 Chrome 和 Firefox 上。

还有其他想法吗？

**回答** 正如 Wolf 建议的那样，当我削减我试图创建一个小小提琴的大量程序时，我找到了问题的根源。

禁用按钮后，它的工具提示将不会消失。如果您取消禁用该按钮，工具提示仍然不会消失。但是，如果您随后将鼠标悬停在未禁用状态的按钮上，然后取消悬停，则工具提示将消失。

显然，如果按钮被禁用，处理工具提示（浏览器？）的代码不会处理 mouseleave 上的按钮工具提示。但它会在重新启用按钮后正确处理任何鼠标离开。

我认为这是一个错误，我没有看到一个好的解决方法。我不知道当我想禁用按钮时是否显示工具提示。我会将它提交给 jQuery 团队。

谢谢你的聆听。

**解决方法**：在禁用按钮之前调用 $("#buttonid").mouseleave()。该错误似乎存在于多个浏览器中，甚至可能被称为功能，因此不太可能很快修复。该解决方法的缺点是它使用户移动指针以获取工具提示，因此在浏览器中使用适当的解决方案会更好。但至少有一个合理的解决方法。

# c - C中的反向字符串 - 我做错了什么？

> ID：14485133
> 
> 赞同：1
> 
> 时间：2013-01-23T16:57:35.220
> 
> 标签：c, string, pointers

我已经完成了以下函数来反转字符串：

```
char* reverseString(char *original_string)
{
    int length = strlen(original_string);
    char *end_of_string = original_string + (length - 1);
    char *reversed_string = malloc(sizeof(char) * length);

    int count = 0;
    int top_limit = length;

    while (count < length) {
        reversed_string[count] = end_of_string[top_limit];
        top_limit--;
        count++;
    }

    return reversed_string;
} 
```

我计划的策略是将指针放在原始字符串的末尾并向后复制到新字符串中。我不确定我在这里做错了什么，但是在做的时候：

```
char* prova = "hello";
char* reversed_string;
reversed_string = reverseString(prova);
printf("%d", strlen(reversed_string)); 
```

它没有显示正确的长度，并且在编译时我收到以下警告：

```
test.c:46: warning: format ‘%d’ expects type ‘int’, but argument 2 has type ‘size_t’ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T17:03:36.953

'\0' 还需要一个字符，并在最后复制它：

```
char* reverseString(char *original_string)
{
    int length = strlen(original_string);
    int top_limit = length-1;
    //char *end_of_string = original_string + top_limit;
    char *reversed_string = malloc(sizeof(char) * (1+length));

    int count = 0;

    while (count < length) {
        reversed_string[count] = original_string[top_limit];
      //reversed_string[count] = *(end_of_string--) ;
        top_limit--;
        count++;
    }
    reversed_string[count] = '\0';
    return reversed_string;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:00:20.423

`strlen`is返回的类型`size_t`是无符号类型。使用`%d`格式打印它是一种未定义的行为。您可以`%zu`在 C99 中使用，也可以在 C89 中使用`%u`并转换为。`unsigned int`

```
#include <string.h>

/* C89 */ printf("%u\n", (unsigned int)strlen(reversed_string));
/* C99 */ printf("%zu\n", strlen(reversed_string)); 
```

> **C11 (n1570), § 7.19 Common definitions`<stddef.h>`**
> `size_t`，它是 sizeof 运算符 [...] 结果的无符号整数类型。

您的算法也是错误的，因为您同时使用`end_of_string`和`top_limit`。您应该选择两种解决方案之一。

```
#include <string.h>

char *reverseString(char *original_string)
{
    size_t length = strlen(original_string);
    char *reversed_string = malloc(length + 1);
    size_t start;
    size_t end;

    for (start = 0, end = length - 1; start < length; start++, end--)
    {
      reversed_string[start] = original_string[end];
    }

    reversed_string[start] = '\0';

    return reversed_string;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T16:59:50.817

`strlen`返回`size_t`，因此您需要使用不同的格式说明符

```
printf("%zu", strlen(reversed_string)); 
```

`sizeof(int)`或（对于短于该字节的字符串）转换长度

```
printf("%d", (int)strlen(reversed_string)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:02:08.060

用作`%u`格式说明符而不是`%d`

```
printf("%u", strlen(reversed_string)); 
```

# facebook - 获取未认证用户的详细信息

> ID：14485134
> 
> 赞同：1
> 
> 时间：2013-01-23T16:57:41.837
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph, crm, nimble

在一些 CRM 应用程序中，我看到了一些功能，它看起来像是在为其他用户/客户的私人资料提取 Facebook 提要……这是怎么做到的？此功能的一个示例来自 Nimble：[http ://www.nimble.com/how-it-works/contact-management/](http://www.nimble.com/how-it-works/contact-management/)

从我所读到的有关 FaceBook API [s] 的所有内容中，它们只能用于为当前经过身份验证的用户或其朋友提取信息，具体取决于请求的访问权限。我是否只是误解了产品，它只是显示登录用户/朋友信息的模型，在 CRM 应用程序的上下文中实际上没有用处？如果没有，我想开发一个 CRM 工具来查看任何用户的 FaceBook 详细信息，有人知道从哪里开始吗？Facebook 是否允许企业付费访问该信息？

任何澄清将不胜感激。

# android - 使用 MediaPlayer 播放由 MediaRecorder 创建的 AMR 文件失败，muri null

> ID：14485137
> 
> 赞同：5
> 
> 时间：2013-01-23T16:57:48.777
> 
> 标签：android, media-player, mediarecorder, amr

我正在编写一个应用程序，它使用 MediaRecorder 以 AMR 格式从麦克风录制语音，然后使用 MediaPlayer 播放数据。

无论如何，这就是目标。

我相当有信心我的 MediaRecorder 端正在工作，我正在以正确的数据速率在正确的位置生成数据文件。这是我如何启动和停止我的 MediaRecorder

```
public void OnStartRecord(View v )
{
    System.out.println( "StartRecord");

    try {
       audioFile = File.createTempFile("amrtmp", ".amr", getApplicationContext().getFilesDir());
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    System.out.println( "Recording to " + audioFile.getAbsolutePath());

    mRecorder = new MediaRecorder();
    mRecorder.setAudioSource(MediaRecorder.AudioSource.VOICE_COMMUNICATION);
    mRecorder.setOutputFormat(MediaRecorder.OutputFormat.AMR_NB);
    mRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
    mRecorder.setAudioEncodingBitRate(4750);
    mRecorder.setAudioSamplingRate(8000);      
    mRecorder.setOutputFile(audioFile.getAbsolutePath());

    try {
        mRecorder.prepare();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
    mRecorder.start();
}

public void OnStopRecord(View v )
{
    System.out.println( "StopRecord");
    mRecorder.stop();
    mRecorder.release();
} 
```

这就像一个魅力。典型的输出类似于

```
StartRecord
Recording to /data/data/com.test.playback/files/amrtmp-235967797.amr 
```

当我开始录制，然后停止录制时，我可以看到文件已创建，并且其中包含与设置正确对应的一定数量的数据。

旁注：运行时我检测到扬声器有奇怪的嗡嗡声。知道那是什么吗？

当我尝试播放文件时，我遇到了无穷无尽的麻烦。我尝试了以下方法：

```
public void OnPlay(View v )
{
    MediaPlayer mPlayer = new MediaPlayer();
    mPlayer.setAudioStreamType(AudioManager.STREAM_VOICE_CALL);

    FileInputStream FIS = null;
    try {
        FIS = new FileInputStream(audioFile.getAbsolutePath());
        mPlayer.setDataSource(FIS.getFD());
        mPlayer.prepare();
    }
    catch( Exception e )        
    {
        e.printStackTrace();
    }
    mPlayer.start();
} 
```

这导致 MediaPlayer 的以下输出根本没有播放任何内容：

start() mURI 为空

我也尝试过相同的代码，但不同地设置 mPlayer 的数据源：

```
mPlayer.setDataSource(audioFile.getAbsolutePath()); 
```

当使用 java.io.IOException 状态 0x1 调用 prepare 时，这将失败。

我不得不想象我还需要对 MediaPlayer 进行其他操作才能正确设置它。有什么建议么？

# asp.net-mvc-4 - 如何扩展/自定义 MVC4 Internet 应用程序 WebSecurity/SimpleMembership

> ID：14485146
> 
> 赞同：3
> 
> 时间：2013-01-23T16:58:17.090
> 
> 标签：asp.net-mvc-4, security, simplemembership

我一直在尽力搜索有关如何修改/扩展/自定义 Visual Studio 2012 Express 中 MVC4 Internet 应用程序（EF 5 Code First）中可用的默认会员系统的更多信息。

我想知道如何实现电子邮件验证，以便在用户注册时发送带有激活链接的电子邮件。当他们点击链接时，他们的帐户被激活，他们可以使用他们的用户名或电子邮件登录。

我还想知道如何通过在注册期间分配默认角色来为注册用户实现简单角色。

类似问题： [如何使用 SimpleMembership 管理个人资料？](https://stackoverflow.com/questions/12352218/how-do-i-manage-profiles-using-simplemembership)

[如何在 ASP.NET MVC4 中扩展 SimpleMembership 身份验证](https://stackoverflow.com/questions/13113145/how-do-you-extend-the-simplemembership-authentication-in-asp-net-mvc4)

但我真的很想使用现有的简单会员系统。

这篇文章非常接近： [http ://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/](http://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/)

我也看过这篇文章： [http ://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4- 5-web-forms-and-asp-net-mvc-4-templates.aspx](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)

这是迄今为止我发现的最接近的： [http ://weblogs.asp.net/thangchung/archive/2012/11/15/customize-the-simplemembership-in-asp-net-mvc-4-0.aspx](http://weblogs.asp.net/thangchung/archive/2012/11/15/customize-the-simplemembership-in-asp-net-mvc-4-0.aspx)

这也很有用，但对于网页： [http ://blog.osbornm.com/archive/2010/07/21/using-simplemembership-with-asp.net-webpages.aspx](http://blog.osbornm.com/archive/2010/07/21/using-simplemembership-with-asp.net-webpages.aspx)

我希望找到一个更全面的演练，以正确的方式扩展它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-30T15:09:43.653

看起来你没有得到任何答案。

除非我不完全理解您想要做什么，否则无需修改/扩展/自定义默认 SimpleMembership 以提供电子邮件注册机制，或在注册期间分配默认角色，因为所有这些都可以在 AccountController 中完成。

例如，这是我正在使用的注册方法：

```
 [HttpPost]
    [AllowAnonymous]
    [ValidateAntiForgeryToken]
    public ActionResult Register(RegisterModel model)
    {
        if (ModelState.IsValid) //TODO Change this to use a worker to send emails.
        {
            // Check if email exists already before creating new user
            using (UsersContext db = new UsersContext())
            {
                UserProfile email = db.UserProfiles.FirstOrDefault(u => u.Email.ToLower() == model.Email.ToLower());
                UserProfile uName =
                    db.UserProfiles.FirstOrDefault(u => u.UserName.ToLower() == model.UserName.ToLower());

                // Attempt to register the user
                try
                {
                    if (email == null && uName == null && this.IsCaptchaVerify("Captcha is not valid"))
                    {
                        bool requireEmailConfirmation = !WebMail.SmtpServer.IsEmpty();
                        string confirmationToken = WebSecurity.CreateUserAndAccount(model.UserName, model.Password, new
                        {
                            FirstName = model.FirstName,
                            LastName = model.LastName,
                            Email = model.Email                               
                        },
                        requireEmailConfirmation);
                        if (requireEmailConfirmation)
                        {
                            EmailViewModel eml = new EmailViewModel
                                                     {
                                                         ToEmail = model.Email,
                                                         Subject = "Confirmez votre inscription",
                                                         FirstName = model.FirstName,
                                                         LastName = model.LastName,
                                                         Body = confirmationToken
                                                     };

                            UserMailer.ConfirmRegistration(eml).SendAsync();

                            Response.Redirect("~/Account/Thanks");                            
                        }
                        else
                        {
                            WebSecurity.Login(model.UserName, model.Password);
                            Response.Redirect("~/");
                        }                           
                    }
                    else
                    {
                        if (email != null)
                            ModelState.AddModelError("Email", "Email address already exists. Please enter a different email address.");

                        if (uName != null)
                            ModelState.AddModelError("UserName", "User Name already exists. Please enter a different user name.");

                        if (!this.IsCaptchaVerify("Captcha is not valid"))
                            TempData["ErrorMessage"] = "Captcha is not valid";
                    }

                }
                catch (MembershipCreateUserException e)
                {
                    ModelState.AddModelError("", ErrorCodeToString(e.StatusCode));
                }
            }
        }

        // If we got this far, something failed, redisplay form
        return View(model);
    } 
```

这里没有分配默认角色，但是一旦验证了 EmailConfirmation，就很容易添加。

由于问题很老，我希望它对某人有所帮助！

# formatting - InstallShield 2012 构建的升级报告安装版本格式错误

> ID：14485147
> 
> 赞同：5
> 
> 时间：2013-01-23T16:58:22.207
> 
> 标签：formatting, version, upgrade, installshield, installscript

在使用使用 InstallShield 2012 Spring 构建的安装程序进行升级期间，我看到以下消息：

1.  InstallShield 向导会将 <我们的产品> 的已安装版本 (9.01.005) 更新到版本 9.2.0.53。
2.  InstallShield 向导正在将 <我们的产品> 的 (9.01.005) 更新到版本 9.2.0.53。

这些消息基于字符串资源`IDS_IFX_SDWELCOMMESSAGE_UPDATE_WELCOME`和`IDS_IFX_STATUSEX_STATICTEXT_UPDATEUI`. 我相信未更改的字符串资源将如下所示：

*   InstallShield 向导会将已安装的 %P 版本 (%VI) 更新到版本 %VS。要继续，请单击下一步。
*   InstallShield 向导正在将 %P 更新 (%VI) 到版本 %VS。

尽管一些资源表明第二个字符串资源是“InstallShield Wizard is updated %VI of %P to version %VS”。

问题是旧的（安装的）版本号应该是像“9.1.5.2”这样的显示字符串，而不是像“9.01.005”这样的内部版本号的格式化版本。据我了解，它`SdSubstituteProductInfo`用于`IFX_INSTALLED_DISPLAY_VERSION`填充默认 InstallScript 代码`%VI`中的替换。`OnUpdateUIBefore`并且`IFX_INSTALLED_DISPLAY_VERSION`默认来自`IFX_INSTALLED_VERSION`，这解释了为什么首选显示字符串没有出现在我们想要的位置。而且我假设`SdWelcome`（或任何类似引用的对话框或代码`IFX_INSTALLED_DISPLAY_VERSION`）也显示格式错误的版本。

尽管我在网上搜索了上面提到的函数、字符串和字符串 ID，但我还没有找到以正确格式显示正确格式的旧版本号 (DisplayVersion) 的理想解决方案。一些文章建议对跳过旧版本号的格式字符串进行硬编码，而不是使用包含`%VI`. 其他人建议根据需要手动格式化版本号并将结果放入`IFX_INSTALLED_DISPLAY_VERSION`. 我知道有一个更好的答案，并且我希望下次我或其他人寻找它时更容易找到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T16:58:43.970

在`OnBegin`InstallScript 函数中，将以下 InstallScript 代码行添加为第一行之后`begin`：

```
RegDBGetItem(REGDB_UNINSTALL_DISPLAY_VERSION, IFX_INSTALLED_DISPLAY_VERSION); 
```

在 OnBegin 中执行此操作还可以确保问题中未提及的另一条消息使用正确的格式：

> 安装程序检测到已经安装了 %P 的 %VI 版本。
> 
> 此安装程序会安装较早版本的 %P (%VS)。
> 
> 在安装此版本之前，您必须卸载以前的版本。

# c# - 重定向到剃刀宏错误的自定义错误页面

> ID：14485155
> 
> 赞同：2
> 
> 时间：2013-01-23T16:58:45.840
> 
> 标签：c#, asp.net, razor, umbraco

在 Umbraco 中，如果页面上有 razor 宏，并且该 razor 宏引发异常，该页面仍会显示，但它会显示“错误加载宏 xyz.cshtml”，而宏应该是。

每当发生这种情况时，我都想重定向到自定义/友好的错误页面，但我找不到任何有关如何执行此操作的信息。是否可以？

我已经尝试`<customErrors>`像往常一样设置标签，但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:34:35.250

在每个 razor 脚本中，您可以用 try/catch 包围您的代码，然后在捕获到错误时重定向：

```
@try
{
    //macro code...
}
catch (Exception ex)
{
    //possible code to log error...

    //redirect to friendly error page:
    Response.Redirect("~/path-to-error-page/");
} 
```

但是，除了重定向用户之外，您还可以捕获错误然后什么也不做。这取决于您的需求。

# performance - 算法效率

> ID：14485158
> 
> 赞同：7
> 
> 时间：2013-01-23T16:58:56.467
> 
> 标签：performance, algorithm

所以这是我作业中的一个问题......

> 假设算法的效率为 n ³，如果算法中的一个步骤需要 1 ns (10 ^(-9) ) 秒），那么算法处理大小为 1,000 的输入需要多长时间？

这是我的问题：我该如何解决？请不要发布答案。帮助我学习如何自己解决这个问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T17:01:38.380

你定义`n`为`1000`。因此，您需要 n ^(3 个)步骤，每个步骤都采取`1 ns`. 将两者相乘，您就有了答案。

总体思路：如果一种算法需要`f(n)`许多步骤并且需要一步，`t`那么您需要`t * f(n)`该算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:01:45.693

在这种情况下， `n`in`n^3`指的是数据大小。如果您有大小为 1 的输入，请将其插入到 n^3 中。（然后乘以时间。）如果你有一个大小为 1,000 的输入......你应该怎么做？

编辑：最初我用 Big-Oh 表示法（例如`O(n^3)`）发布了这个，这是有缺陷的，因为它忽略了可能的固定成本，这会使发布的问题无法回答。我觉得我应该留下这个答案，也许主要是为了提醒其他人不要犯和我一样的错误。感谢您的评论。

# node.js - nodejs串口写入问题？

> ID：14485166
> 
> 赞同：5
> 
> 时间：2013-01-23T16:59:18.083
> 
> 标签：node.js, node-serialport

我正在使用 nodejs 串行端口模块（[https://npmjs.org/package/serialport](https://npmjs.org/package/serialport)），并且在写入串行端口时遇到问题。

如果我只是简单地写入端口，如下所示，串行设备永远不会收到命令。

```
var serialport = require("serialport");
var sp = new serialport.SerialPort(serialPortPath);
sp.write("SYST:ADDR?\n"); 
```

但是，如果我使用如下所示的 setTimeout，那么它似乎可以工作？

```
var serialport = require("serialport");
var sp = new serialport.SerialPort(serialPortPath);
setTimeout(function(){sp.write("SYST:ADDR?\n")},1000); 
```

仅供参考，“serialPortPath”在代码的其他地方设置。

我不确定发生了什么……有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T03:06:43.003

我想我是从 github （[https://github.com/voodootikigod/node-serialport](https://github.com/voodootikigod/node-serialport)页面......基本上看起来我错过了“open”事件，如下所示：

```
serialPort.on("open", function () {
  console.log("open");
  serialPort.on("data", function(data) {
    console.log("data received: " + data);
  });  
  serialPort.write("SYST:ADDR?\n", function(err, results) {
    console.log("err: " + err);
    console.log("results: " + results);
  });  
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-31T20:45:48.743

这是另一种非常有效的方法，它允许对特定串行设备进行动态寻址。就我而言，我只对连接到我们的集成系统的 Numato 设备感兴趣，这就是为什么我在列表回调中有条件逻辑的原因。

```
 exports.testSerial = function(data) {
    serialPort.list(function(err, ports) {

      var port = {};

      for(var i = 0; i < ports.length; i++) {
        try {
          if(typeof ports[i].manufacturer != 'undefined' && ports[i].manufacturer.includes("Numato")) {
            port = ports[i];
          }
        } catch(err) {
          console.dir(err);
        }
      }

      // the port will be opened via the constructor of this call
      var numato = new serial(port.comName, {baudrate : 19200}, function(err) {
        if(err) {
          return console.dir(err);
        }

        // by having the write call within the callback you can access it directly w/o using .on()
        numato.write('relay ' + data.state + ' ' + data.channel + '\r', function(err) {
          if(err) {
            console.dir('error writing');
            console.dir(err);
          }
          console.dir('serial message written');
          numato.close();
        });
      });

      return true;

    });
 } 
```

希望这对将来的人有所帮助！作为参考，这是库版本 4.0.7。

# sql - 使用上一行的值计算信息

> ID：14485167
> 
> 赞同：1
> 
> 时间：2013-01-23T16:59:19.647
> 
> 标签：sql, sql-server, sql-server-2008, cursor, common-table-expression

我有每个账户的当前余额，我需要减去交易的净额以创建过去 24 个月的上个月的期末余额。下面是一个示例数据集；

```
create table txn_by_month (
memberid varchar(15)
,accountid varchar(15)
,effective_year varchar(4)
,effective_month varchar(2)
,balance money
,netamt money
,prev_mnthendbal money)

insert into txn_by_month values
(10001,111222333,2012,12,634.15,-500,1134.15)
,(10001,111222333,2012,11,NULL,-1436,NULL)
,(10001,111222333,2012,10,NULL,600,NULL)
,(10002,111333444,2012,12,1544.20,1650,-105.80)
,(10002,111333444,2012,11,NULL,1210,NULL)
,(10002,111333444,2012,10,NULL,-622,NULL)
,(10003,111456456,2012,01,125000,1200,123800)
,(10003,111456456,2011,12,NULL,1350,NULL)
,(10003,111456456,2011,11,NULL,-102,NULL) 
```

正如您所看到的，我已经有一个汇总了每个月所有交易的表格。我只需要在第一行计算上个月末余额并将其降至第二、第三行等。我一直在尝试使用 CTE，但对它们并不太熟悉，目前似乎被卡住了。这就是我所拥有的；

```
;
WITH CTEtest AS
(SELECT ROW_NUMBER() OVER (PARTITION BY memberid order by(accountid)) AS Sequence
,memberid
,accountid
,prev_mnthendbal
,netamt
FROM txn_by_month)

select c1.memberid
,c1.accountid
,c1.sequence
,c2.prev_mnthendbal as prev_mnthendbal
,c1.netamt, 
COALESCE(c2.prev_mnthendbal, 0) - COALESCE(c1.netamt, 0) AS cur_mnthendbal
FROM CTEtest AS c1
LEFT OUTER JOIN CTEtest AS c2 
ON c1.memberid = c2.memberid 
and c1.accountid = c2.accountid 
and c1.Sequence = c2.Sequence + 1 
```

这仅适用于序列 = 2。我知道我的问题是我需要将我的 cur_mnthendbal 值降低到下一行，但我似乎无法理解如何。我需要另一个 CTE 吗？

任何帮助将不胜感激！

编辑：也许我需要更好地解释它......如果我有这个； ![在此处输入图像描述](../Images/9a27ca5b04ae6c3a3ab49f6d5fa2e1c5.png)

第 2 行的余额将是第 1 行的 prev_mnthendbal ($1,134.15)。然后第 2 行的 prev_mnthendbal 将是余额 - netamt ($1,134.15 - (-$1,436) = $2,570.15)。我一直在尝试使用 CTE，但我似乎无法弄清楚如何使用前一行中的 prev_mnthendbal 填充 balance 字段（因为在余额可用之前不会计算它）。也许我不能使用 CTE？我需要使用光标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T22:32:25.490

事实证明，我需要将运行总计与我开始使用的顺序 CTE 结合起来。

```
;
with CTEtest AS
    (SELECT ROW_NUMBER() OVER (PARTITION BY memberid order by effective year, effective month desc) AS Sequence, *
    FROM txn_by_month)

,test
as (select * , balance - netamt as running_sum from CTEtest where sequence = 1

union all

select t.*, t1.running_sum - t.netamt from CTEtest t inner join test t1

on t.memberid = t1.memberid and t.sequence = t1.Sequence+1 where t.sequence > 1)

select * from test
order by memberid, Sequence 
```

希望这将有助于将来的其他人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:12:56.967

请参阅 LEAD/LAG 分析函数。

# android - 从服务器 http 解压文件

> ID：14485173
> 
> 赞同：-1
> 
> 时间：2013-01-23T16:59:30.367
> 
> 标签：android, unzip

我在解压缩从服务器收到的文件时遇到问题。我发送请求，服务器向我显示带有代码字符的文本：S

使用此代码，我从服务器收到一个 zip，但我需要解压缩此文本文件，并在 EdText 中显示。

```
public void postLoginData() {

    // Create a new HttpClient and Post Header
    HttpClient httpclient = new DefaultHttpClient();

    HttpPost httppost = new HttpPost(
            "http://localhost:80/MOBILE/MBSERVER.V25?");
    try {
        String VENDED_VEN = "2", EMPRES_CFG = "1", VERSAO_CFG = "100", function = "GetMARCAS", REQUERY = null;

        comando = (EditText) findViewById(R.id.comando);
        // String PLS = comando.getText().toString();

        List<NameValuePair> values = new ArrayList<NameValuePair>(6);

        values = new ArrayList<NameValuePair>();
        values.add(new BasicNameValuePair("EMPRES", EMPRES_CFG));
        values.add(new BasicNameValuePair("USUARI", VENDED_VEN));
        values.add(new BasicNameValuePair("VERSAO", VERSAO_CFG));
        values.add(new BasicNameValuePair("ORIGEM", "AD"));
        values.add(new BasicNameValuePair("FUNCAO", function));
        values.add(new BasicNameValuePair("RQUERY", REQUERY));

        httppost.setEntity(new UrlEncodedFormEntity(values));
        // Execute HTTP Post Request
        Log.w("LOG", "Execute HTTP Post Request");
        HttpResponse response = httpclient.execute(httppost);
        Log.w("LOG", "VALUES:"+values);

        String str = inputStreamToString(response.getEntity().getContent())
                .toString();

        Log.w("LOG", str);
        if (str.toString().equalsIgnoreCase("true")) {
            Log.w("LOG", "TRUE");
            result.setText("Login successful");

        } else {
            Log.w("LOG", "FALSE");
            result.setText(str);
        }
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
}

private StringBuilder inputStreamToString(InputStream is) {
    String line = "";
    StringBuilder total = new StringBuilder();

    // Wrap a BufferedReader around the InputStream
    BufferedReader rd = new BufferedReader(new InputStreamReader(is));
    // Read response until the end
    try {
        while ((line = rd.readLine()) != null) {
            total.append(line);
        }
    } catch (IOException e) {
        e.printStackTrace();
    }
    // Return full string
    return total;
}

@Override
public void onClick(View view) {
    if (view == ok) {
        postLoginData();
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:28:19.670

如果它是标准 zip 文件，则可以使用该`java.util.zip`包。

这是一个解压缩包含文件夹的存档并将其写入文件的示例。

```
FileInputStream zipInputStream = new FileInputStream(new File(cacheDir, zipFileName));
FileOutputStream datOutputStream = new FileOutputStream(new File(cacheDir, datFileName));

// unzip and process ZIP file
ZipInputStream zis = new ZipInputStream(zipInputStream);
ZipEntry ze = null;
// loop through archive
while ((ze = zis.getNextEntry()) != null) {
    if (ze.getName().toString().equals("myfolder/myfile.dat")) { // change this to whatever your folder/file is named inside the archive
        while ((bufferLength = zis.read(buffer, 0, 1023)) != -1) {
            datOutputStream.write(buffer, 0, bufferLength);
        }
     }
     zis.closeEntry();
} 
```

# php - 使用 simplexml 从 xml 提要中读取数据

> ID：14485174
> 
> 赞同：1
> 
> 时间：2013-01-23T16:59:32.397
> 
> 标签：php, xml, simplexml

我使用 simplexml 引入数据馈送，现在我想将其放入工作变量中以在我的 php 文档中使用。

遵循关于 simplexml 的 php.net 指南，我到达了

```
<?php
    $xml = simplexml_load_file('f1_feed.xml');

    $xml = new SimpleXMLElement($xmlstr);

    echo $xml->response->williamhill->class->type->market[0]->name;
?> 
```

但我一直得到一个空白页，我是否完全错过了如何解析 xml 并将其放入工作 var 的点？

（饲料是本地的发展）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:01:37.780

你不需要两者`new SimpleXMLElement` 和`simplexml_load_file`：

*   [`simplexml_load_file`](http://php.net/manual/en/function.simplexml-load-file.php)返回 SimpleXMLElement 类的对象
*   [`SimpleXMLElement`](http://php.net/manual/en/simplexmlelement.construct.php)返回一个 SimpleXMLElement 对象

尝试：

```
 if (file_exists('f1_feed.xml')) {
      $xml = simplexml_load_file('f1_feed.xml');    
      print_r($xml);
  } else {
      exit('Failed to open f1_feed.xml.');
  } 
```

或者：

```
if (file_exists('f1_feed.xml')) {
     $xml = new SimpleXMLElement(file_get_contents('f1_feed.xml'));
     echo $xml->response->williamhill->class->type->market[0]->name;
} else {
     exit('Failed to open f1_feed.xml.');
} 
```

如果它仍然不起作用，请添加

```
 error_reporting(E_ALL);
  ini_set("display_errors", 1); 
```

为了更好的错误报告

# c# - 是否可以将 Outlook 包装为单例并使用 MS UnitTesting 对其进行测试？

> ID：14485175
> 
> 赞同：2
> 
> 时间：2013-01-23T16:59:33.907
> 
> 标签：c#, unit-testing, outlook, mstest

好的，将自己作为一个单独的 MailService 类来使用 Outlook 类（它本身就是一个单独的 afaik）似乎是个好主意。

一开始它工作得很好，但是当我尝试从我的 appservice 层为这个类设置单元测试（MS 单元测试）时，一切都崩溃了，我得到了 Runtime Callable Wrapper 错误。

我是否错误地将 MailService 类设置为单例类，或者我在将 Outlook 包装为单例类时做错了什么？

这是我的 Mailservice 类，其中显示了一种方法：

```
public class MailService : IDisposable
{

    private static MailService _instance;
    private Outlook.ApplicationClass _app;
    private Outlook.NameSpace _olNS;

    private MailService()
    {
        _app = new Outlook.ApplicationClass();
        _olNS = _app.GetNamespace("MAPI");
    }

    public static MailService Instance
    {
        get
        {
            if (_instance == null)
                _instance = new MailService();
            return _instance;
        }
    }

    public void Dispose()
    {
        _app.Quit();
        Marshal.ReleaseComObject(_app);
        GC.Collect();
        GC.WaitForPendingFinalizers();
    }

    public Outlook.Folder getFolderByPath(string sFolderPath)
    {
        Outlook.Folder olFolder = null;
        if (sFolderPath.StartsWith(@"\\"))
        {
            sFolderPath = sFolderPath.Remove(0, 2);
        }
        string[] sFolders = sFolderPath.Split('\\');
        try
        {
            olFolder = _app.Session.Folders[sFolders[0]] as Outlook.Folder;
            if (olFolder != null)
            {
                for (int i = 1; i <= sFolders.GetUpperBound(0); i++)
                {
                    Outlook.Folders subFolders = olFolder.Folders;
                    olFolder = subFolders[sFolders[i]] as Outlook.Folder;
                    if (olFolder == null)
                    {
                        return null;
                    }
                }
            }
            return olFolder;
        }
        catch (Exception e)
        {
            LogHelper.MyLogger.Error("Error retrieving " + sFolderPath, e);
            return null;
        }
    }
} 
```

我的 MS 单元测试是***单独工作的，但不是在测试列表中运行全部时***。在后一种情况下，只有第一个测试通过了......

```
 [TestMethod]
    public void TestMonitorForCleanUpDone()
    {
        Assert.IsNotNull(MailService.Instance.getFolderByPath(olFolderDone));
    }

    [TestMethod]
    public void TestMonitorForCleanUpIn()
    {
        Assert.IsNotNull(MailService.Instance.getFolderByPath(olFolderIn));
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T10:20:19.937

像往常一样，原来有人以前遇到过这个问题并写了一篇关于它的博客文章：http: [//blogs.msdn.com/b/martijnh/archive/2009/12/31/unit-testing-com-object- that-has-been-separated-from-its-underlying-rcw-cannot-be-used.aspx](http://blogs.msdn.com/b/martijnh/archive/2009/12/31/unit-testing-com-object-that-has-been-separated-from-its-underlying-rcw-cannot-be-used.aspx)

以防万一博文消失，简而言之，解决方案是在 MTA 模式下运行单元测试。

“解决此问题的方法是使用 XML 编辑器打开您的 testrunco​​nfig 文件并向其中添加***<ExecutionThread apartmentState="MTA" />***元素”

```
<?xml version="1.0" encoding="utf-8"?>
<TestRunConfiguration name="Local Test Run" id="f3322344-5454-4ac5-82b7-fa5ba9c1d8f2"     xmlns="http://microsoft.com/schemas/VisualStudio/TeamTest/2010">
  <ExecutionThread apartmentState="MTA" />
  <Description>This is a default test run configuration for a local test run.</Description>
  <TestTypeSpecific />
</TestRunConfiguration> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:03:12.403

对于初学者来说，您对 IDisposable 的实现并不好。

```
 public void Dispose()
 {
    _app.Quit();
    Marshal.ReleaseComObject(_app);
    GC.Collect();
    GC.WaitForPendingFinalizers();
 } 
```

你在那里有几件事错了..

*   你不应该强制垃圾收集/等待终结器
*   您不应该“盲目地”处置托管资源

并且由于您将 MailService 类设为单例，因此您的生命周期管理存在问题，因为您是如何实现 Dispose() 的。

您应该阅读有关在 .NET和[MSDN 杂志上](http://msdn.microsoft.com/en-us/magazine/cc163392.aspx)[正确实现 IDisposable 接口的](http://msdn.microsoft.com/en-us/library/fs2xkftw.aspx)信息。还要考虑当您的 MailClass 对象超出范围时会发生什么。以及如何在单元测试的上下文中进行管理。

# java - 使用内在锁进入块

> ID：14485178
> 
> 赞同：4
> 
> 时间：2013-01-23T16:59:43.093
> 
> 标签：java, locking, java.util.concurrent

我看不到以下代码如何产生似乎违反对象锁定义的输出。当然应该只允许一个线程打印“获得的锁”消息，但他们都这样做吗？

```
class InterruptThreadGroup {
    public static void main(String[] args) {
        Object lock = new Object();
        MyThread mt1 = new MyThread(lock);
        MyThread mt2 = new MyThread(lock);
        mt1.setName("A");
        mt1.start();
        mt2.setName("B");
        mt2.start();
        try {
            Thread.sleep(2000);
        } catch (InterruptedException e) {
        }
        // Thread.currentThread().getThreadGroup().interrupt();
    }
}

class MyThread extends Thread {
    private Object lock;

    public MyThread(Object l) {
        this.lock = l;

    }

    public void run() {
        synchronized (lock) {
            System.out.println(getName() + " acquired lock");
            try {
                lock.wait();
            } catch (InterruptedException e) {
                System.out.println(getName() + " interrupted.");
            }
            System.out.println(getName() + " terminating.");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T17:01:23.573

这是因为调用`lock.wait()`释放锁，允许第二个线程进入同步块。[从javadoc](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#wait%28%29)中提取

> 线程释放此监视器的所有权并等待，直到另一个线程通过调用 notify 方法或 notifyAll 方法通知在此对象的监视器上等待的线程唤醒。然后线程等待直到它可以重新获得监视器的所有权并恢复执行。

请注意，您的代码中存在一些问题，例如：

*   你不应该在while循环之外等待
*   任何地方都没有通知，因此您的等待可能会永远持续下去
*   让您的任务实现 Runnable 并将其作为参数传递给 Thread 的构造函数比直接扩展 Thread 更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:07:05.917

您应该使用同步块或等待调用。一起使用它们是行不通的。如果您使用等待调用，则锁由同步块中的对象释放。

因此，删除该行`lock.wait`，您的程序将按您的意愿运行。同步块将自动处理所有锁。

如果您使用等待，则必须使用通知。

这是一个很好的线程：[Why must wait() always be in synchronized block](https://stackoverflow.com/questions/2779484/why-wait-should-always-be-in-synchronized-block)

# c++ - GLM Math lib 使用 GCC 编译错误

> ID：14485184
> 
> 赞同：1
> 
> 时间：2013-01-23T16:59:58.387
> 
> 标签：c++, opengl, gcc, glm-math

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:38:37.803

```
void SetProjection(mat4 &matr); 
```

为什么不使用参数 by`const&`而不是 by non-const `&`？这看起来像一个错误，因为`SetProjection`没有*修改*参数。

这就是您的编译器错误的来源。的返回值`perspective`是临时的。并且临时不能由非常量存储`&`。

# ruby-on-rails - 如何使用 cron 运行 rake 任务两次？

> ID：14485185
> 
> 赞同：0
> 
> 时间：2013-01-23T17:00:00.737
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rubygems, ruby-daemons

我想知道 RoR 中是否有一种方法可以在不同的时间两次运行 rake 任务或 ruby​​ 代码。例如，当用户注册时，三天后运行任务，一周后运行相同的任务，但不再运行（'停止进程'）。我正在查看 crontab 和 Resque、Stalker、Starling 等 gem，但我不清楚这些 gem 可以帮助我。我正在考虑为每个用户运行一个守护程序并计算任务执行次数。问题是该守护程序将一直处于活动状态“吃”资源。有没有办法尽可能少地使用资源？我想稍后在 Heroku 中运行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:41:58.480

我通常用记录上的日期列来解决这类事情（例如，first_reminder_sent_at、user_responed_at、week_reminder_sent_at）。在这种情况下，第一个项目的日期、用户的响应以及一周后的项目的日期。

创建一个 cron 任务来调用 rake 任务 - 查看所有 > 3 天、< 1 周、用户尚未响应、未设置日期的用户。排队后台作业。Job 将发送邮件（或任何任务），然后在记录上设置日期字段。

用于调用 rake 任务的 Cron 任务 - 查看超过 1 周且用户尚未响应且未设置日期的所有用户。发送提醒并在后台作业中设置日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:27:01.110

Posix 系统有一个[`at`](http://unixhelp.ed.ac.uk/CGI/man-cgi?at)命令，这是一种非常简单的方法来安排一个作业在以后运行一次。尽管使用基于应用程序的排队机制来安排以后的工作没有任何问题，如其他答案中所述。`at`是特定于主机的，因此如果您正在运行集群，则可能不适合，尤其是在主机可能是瞬态的情况下。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:13:56.970

尝试每当 cron 并创建一个 rake 任务，它正在做你的事情.. 并在数据库中创建一些触发字段，何时以及如何 rake 任务应该执行他的操作..

# jquery - 如何根据特定条件动态创建 jQuery ui 选项卡？

> ID：14485186
> 
> 赞同：2
> 
> 时间：2013-01-23T17:00:00.443
> 
> 标签：jquery, jquery-ui

我正在使用 jquery-ui 选项卡组件基于传入的名为 children 的对象动态创建选项卡（此功能如​​果与更大的应用程序分开）。

我试图确保基本功能/和/或条件符合适当的`If`陈述。

第一个条件检查是否在 DOM 中创建了一个或多个选项卡。如果没有，那么它会创建它们。最后一个条件检查选项卡是否以适当的顺序从对象返回，即。选项卡 1、选项卡 2、选项卡 3。

我将如何检查返回对象是否具有正确的顺序，如果没有，则将正确的顺序附加到 DOM？

```
$.each(children, function(i, val) {

            var existingTab = $('#' + val.id, self.container);  
            var existingTabIndex = existingTab.index();

    if(existingTab.length === 0){

            // Add index au
            self.container.tabs('add', '#' + children[i].id, children[i].label,i);

          } else if(existingTabIndex !== val){

                existingTab.index(i);
                this.container.append(val);

          }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:27:28.297

你不能只运行一个 for 循环并将标签 ID 与它后面的标签进行比较，并确保它后面的标签总是更大。如果即使有一次之后的选项卡更少（意味着乱序），那么将全局变量错误更改为 true，现在你知道有一个错误......

# c# - ObjectListView 不显示所选项目的选择颜色

> ID：14485193
> 
> 赞同：1
> 
> 时间：2013-01-23T17:00:28.030
> 
> 标签：c#, winforms, listview, objectlistview

我有一个[`ObjectListView`](http://objectlistview.sourceforge.net/cs/index.html)本质上是标准 .NET 的包装器`ListView`。我的问题是我无法确定正确的方法调用顺序，以将新对象添加到控件、滚动控件以确保对象可见并选择对象。下面，是我实现这一目标的代码。一切正常，但由于某种原因，所选项目/对象的背景颜色不会显示，直到我单击或重新调整其中一列的大小。我不确定控件是否没有被聚焦或什么。

```
// objectListViewItems is of type BrightIdeasSoftware.ObjectListViewItems
objectListViewItems.AddObject(e.InsertedItem);
objectListViewItems.Refresh();
objectListViewItems.Focus();
objectListViewItems.EnsureModelVisible(e.InsertedItem);
objectListViewItems.SelectedObject = e.InsertedItem;
objectListViewItems.Focus(); 
```

下面的代码更新了 ObjectListView 中的一个项目并且工作得很好。不知道我在上面做错了什么......

```
objectListViewItems.RefreshObject(itemToEdit);
objectListViewItems.Focus();
objectListViewItems.SelectObject(itemToEdit); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T08:33:11.897

这应该像您建议的那样工作（我曾多次这样做）。但是，调用`Refresh()`和第二个`Focus()`是不必要的。我也宁愿使用而`SelectObject()`不是`SelectedObject`财产。

像这样：

```
objectListView.AddObject(newItem);
objectListView.Focus();
objectListView.EnsureModelVisible(newItem);
objectListView.SelectObject(newItem); 
```

另外，请确保之后没有执行任何代码，这可能会导致另一个控件获得焦点。

要缩小发生的范围，您可以尝试设置

```
objectListView.HideSelection = false; 
```

至于 normal `ListView`，这确保当前选择保持可见（但“变灰”），即使控件失去焦点。

`InitializeComponent()`如果您使用设计器，请发布完整的 OLV 配置（来自）。也许有一些奇怪的星座导致了这个。

# java - Eclipse 如何管理不同的运行 Java 类

> ID：14485195
> 
> 赞同：2
> 
> 时间：2013-01-23T17:00:34.160
> 
> 标签：java, eclipse

如果我有一个 Java 文件 test.java，并使用 Eclipse 运行它并且需要很长时间来处理，那么我为什么能够修改 test.java 并同时运行它的另一个实例？应该有一个 test.class 文件，但 Eclipse 似乎在运行时缓存了旧的文件，对吧？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T17:03:04.697

当程序运行时，类文件已经被类加载器加载到内存中。因此，VM 不再需要 .class 文件。因此，如果 .class 文件在文件系统上发生更改，则没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:09:35.600

> 如果我有一个 java 文件 test.java ，并使用 eclipse 运行它并且需要很长时间来处理，我怎么能修改 test.java 并同时运行它的另一个实例？应该有一个 test.class 文件，但是 eclipse 在运行时似乎缓存了旧的文件，对吗？

这*通常*不是真的，除非您关闭了自动项目构建和/或热代码部署。Eclipse 中对源文件的兼容更改将传播到任何已加载等效类的调试会话，除非类签名本身已更改。

但是，是的，Eclipse 中的每个调试会话实际上都是它自己的进程，具有自己的类加载器。

# php - 我们如何以及在哪里将 ASIFormDataRequest 合并到 Xcode 中？

> ID：14485196
> 
> 赞同：0
> 
> 时间：2013-01-23T17:00:36.987
> 
> 标签：php, iphone, ios, xcode, asiformdatarequest

我们正在尝试修改 iphone 文本字段中的数据，然后将（数据）返回到服务器中的 mysql 数据库。

我们有几个问题：

ASIFormDataRequest 是用于此目的的首选工具吗？如果没有，你能推荐一个并解释如何合并吗？如果 ASIFormDataRequest 是正确的工具，我们如何以及在哪里将 ASIFormDataRequest 合并到 Xcode 和 PHP 中？

以下是包含我们编写的代码的三个文件，我们欢迎您的所有见解。谢谢你的慷慨！

DetailViewController.h

```
#import <UIKit/UIKit.h>

@interface DetailViewController : UIViewController {
NSDictionary *newsArticle;

IBOutlet UILabel *titleLabel;
IBOutlet UILabel *timeLabel;    
IBOutlet UITextField *fieldname;
IBOutlet UITextField *fieldtitle;
IBOutlet UITextField *fielddate;}

@property (nonatomic, copy) NSDictionary *newsArticle;

@end 
```

细节视图控制器.m

```
#import "DetailViewController.h"

@interface DetailViewController ()

@end

@implementation DetailViewController
@synthesize newsArticle;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
if (self) {
    // Custom initialization
}
return self;
}

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view from its nib.

titleLabel.text = [newsArticle objectForKey:@"name"];
timeLabel.text = [newsArticle objectForKey:@"title"];

fieldname.text = [newsArticle objectForKey:@"name"];

fieldtitle.text = [newsArticle objectForKey:@"title"];

fielddate.text = [newsArticle objectForKey:@"date"];
}
- (void)viewDidUnload
{
[super viewDidUnload];
// Release any retained subviews of the main view.
// e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:    (UIInterfaceOrientation)interfaceOrientation
{
return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

@end 
```

php文件

```
$con = mysql_connect($DB_HostName,$DB_User,$DB_Pass) or die(mysql_error()); 
mysql_select_db($DB_Name,$con) or die(mysql_error()); 

$query = mysql_query("SELECT * FROM afitest");

$arr = array();

while($row = mysql_fetch_assoc($query)) {
$arr[] = $row;
}

echo json_encode($arr);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:31:34.883

ASIHttprequest 是一个框架（不，它不是一个工具），它使您能够像浏览器获取页面或发布表单一样对服务器应用程序进行 http 调用。

你用哪种数据库做什么并不重要——它既不依赖于服务器脚本语言也不依赖于后端数据库：（php或mysql）。

也就是说，有[很多](https://www.google.co.in/search?q=asihttprequest%20example&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla%3aen-US%3aofficial&client=firefox-a#hl=en&sugexp=les;&gs_rn=1&gs_ri=serp&pq=asihttprequest%20example&cp=7&gs_id=10&xhr=t&q=asiformdatarequest%20example&es_nrs=true&pf=p&client=firefox-a&hs=nqk&tbo=d&rls=org.mozilla%3aen-US%3aofficial&sclient=psy-ab&oq=asiform%20example&gs_l=&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.&bvm=bv.41248874,d.bmk&fp=1ccbb6392a404df7&biw=1024&bih=677)关于 ASIHttpRequest 可以为您做什么的[示例。](http://allseeing-i.com/ASIHTTPRequest/How-to-use)

如果您具体或面临任何问题，请相应地修改您的问题。你会得到更好的帮助。

# version-control - 如何使用 CLI 从 RTC 变更集中删除文件

> ID：14485198
> 
> 赞同：1
> 
> 时间：2013-01-23T17:00:39.880
> 
> 标签：version-control, rtc, jazz

我正在使用 RTC 3.0.1 CLI (lscm)，并且我将一个文件签入到我想删除的变更集中。似乎没有一种直接的方法可以做到这一点，知道吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T18:05:30.020

我讨厌回答我自己的问题，但我想通了。也许这会帮助其他人。

RTC 确实让您以不同于 SVN 甚至 git 的方式思考源代码控制。为了从 RTC 变更集中删除文件，您只需在本地删除文件并签入目录。

```
$ rm myfile
$ cd .. 
$ lscm checkin mydir 
```

使用“撤消”命令撤消更改

```
$ lscm undo myfile 
```

这是 RTC CLI 的一个罗塞塔石碑，它让我知道： [Git v Subversion v RTC](https://www.ibm.com/developerworks/mydeveloperworks/blogs/amcohen/entry/git_versus_subversion_versus_rational_team_concert_basic_commandline_syntax_reference313?lang=en)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:49:31.093

从我在[帮助页面](https://jazz.net/help-dev/clm/index.jsp?topic=/com.ibm.team.scm.doc/topics/r_scm_cli_changeset.html)中可以看到，还有一种解决方法：
**`relocate`**一个文件从一个更改集到另一个更改集。

# php - jQuery/PHP/Smarty - 非侵入式 JS - 在动态元素 ID（PHP 变量）上设置处理程序

> ID：14485204
> 
> 赞同：1
> 
> 时间：2013-01-23T17:00:58.290
> 
> 标签：php, jquery, jquery-selectors, smarty

我试图在我的 web 应用程序中分离 html 和 jQuery 事件处理程序。这是我的上下文：我的 webapp 使用带有 ajax 加载内容的选项卡。每个选项卡内容都由一个唯一的 id 标识。在每个选项卡中，我都有一张桌子。两个或多个选项卡的内容可以相同（例如在 Chrome 中，可以在两个选项卡中加载同一个网站）。在选项卡中，每个表格行都可以通过单击 jQuery 初始化按钮进行编辑。

这是一个简化的示例，它目前是如何工作的：

**智能模板**

```
<div id="tabContent_{$uniqueId}">
  <table>
    {foreach $operations as $op}
       <tr><td><button id="buttonEditOperation_${op}" /></td></tr>
    {/foreach}
  </table>
</div>

<script>           
     $('#tabContent_{$uniqueId} [id^="buttonEditOperation_"]')
       .click( function() { alert('CLICK !'); })
       .button(blabla);
</script> 
```

当我加载具有相同内容的新选项卡时，由于`#tabContent_{$uniqueId}`选择器，仅初始化此新内容中的按钮

我想创建一个 javascript 文件来分隔 JS 和我的 SMARTY TEMPLATE 但我不知道如何只选择新加载的选项卡的内容。我想要这样的东西：

**智能模板**

```
<script type="text/javascript" src="./js/buttonInit.js"></script>
<div id="tabContent_{$uniqueId}">
  <table>
     {foreach $operations as $op}
       <tr><td><button id="buttonEditOperation_${op}" /></td></tr>
    {/foreach}
  </table>
</div> 
```

**JS文件**

```
<script> 
     $('#tabContent_?????? [id^="buttonEditOperation_"]')  // HERE IS MY PROBLEM
       .click( function() { alert('CLICK !'); })
       .button(blabla);
</script> 
```

我有一些想法（HTML5 数据属性、初始化函数、全局变量等），但我想知道这个问题的最佳解决方案。

感谢您的反馈意见 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T12:45:15.037

请参阅下面我找到的最佳解决方案！如果我做错了什么，请不要犹豫告诉我...

**智能模板**

```
<script type="text/javascript" src="./js/object.Module.js"></script>
<script type="text/javascript" src="./js/object.Operation.js"></script>
<div id="tabContent_{$uniqueId}">
  <table>
     {foreach $operations as $op}
       <tr><td>
          <button id="buttonEditOperation_${op}" />
          <span class="tooltip" title="Tooltip content">Show tooltip</span>
       </td></tr>
    {/foreach}
  </table>
</div>

<script>
    // Create a new object "Operation" which inherit from "Module"
    var currentModule_{$uniqueId} = new Operation( {$uniqueId} );

    // Use a method from main object "Module"
    currentModule_{$uniqueId}.init_tooltips();

    // Use a method from specific object "Operation"
    currentModule_{$uniqueId}.init_buttonEditOperation('CLICK !');
</script> 
```

**主 JS 文件：“object.Module.js”**

```
var Module = function(_uniqueId) {
    // Store the value of this in a different variable because jQuery
    // override it when handling events
    // (http://stackoverflow.com/questions/10596727/this-keyword-overriden-in-javascript-class-when-handling-jquery-events)
    var self = this;

    /* ========================================= */
    /* PRIVATE ATTRIBUTE */   
    /* ========================================= */
    // Initialized w/ arguments values when creating "object"
    // (e.g. : var myVar = new Module("35d98q452e");
    self.uniqueId = _uniqueId; // e.g. : "35d98q452e"

    /* ========================================= */
    /* PUBLIC METHODS */   
    /* ========================================= */    
    /*-------------------------------------
    /* ---> Initialize tooltips */
    self.constructor.prototype.init_tooltips = function() {
         $( "#tabContent_" + self.uniqueId + " .tooltip" ).each(function(index) {
            $(this).tooltip();
        }); 
    }

}; 
```

**模块“操作”特定 JS 文件“object.Operation.js”**

```
var Operation = function(_uniqueId) {
    var self = this;

    /* ========================================= */
    /* INHERIT FROM PARENT OBJECT "Module" */   
    /* ========================================= */
    Module.call(self, _uniqueId);

    /* ========================================= */
    /* PUBLIC METHODS */   
    /* ========================================= */ 
    /*-------------------------------------
    /* ---> Initialize button "Edit operation" */
    self.init_buttonEditOperation = function(_msg) {
       $('#tabContent_' + self.uniqueId + ' [id^="buttonEditOperation_"]')
         .click( function() { alert(_msg); })
         .button(blabla);
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T03:19:27.630

虽然分离 HTML 和 Javascript 是一个好主意，但生成一个 Javascript 文件对于实现这一点可能是多余的，而且维护起来也比应有的要困难得多。

我发现最好的方法是向 Smarty 添加简单的插件功能，以允许您生成与在整个站点中多次出现的“小部件”相关的所有 HTML 和 Javascript。

这些插件功能应该：

*   为一个小部件生成所有的 HTML，这样您就不必在不同的 Smarty 模板之间重复 HTML。
*   生成小部件所需的所有 Javascript，这样您就不必在 Smarty 模板中编写 Javascript（这几乎总是一个坏主意——您应该只是调用函数）。
*   将 Javascript 的生成与页面中的实际输出分开，以便您控制 Javascript 的实际放置位置。

**向 Smarty 添加功能的 PHP 代码**

```
$GLOBALS['pageJavascript'] = array();

$smarty->registerPlugin("function", "addButton", "addButtonSmarty");
$smarty->registerPlugin("function", "displayPageJavascript", "displayPageJavascript");

//Outputs the HTML for a button, generates the associated Javascript and either 
//outputs that Javascript or saves it for later.
function    addButtonSmarty($params, &$smarty){

    if(isset($params['operation']) == FALSE){
        return "operation not set.";
    }

    if(isset($params['tabID']) == FALSE){
        return "tabID not set.";
    }

    $tabID = $params['tabID']
    $operation = $params['operation'];

    $uniqueID = "buttonEditOperation_".$operation;

    addButtonJavascript($tabID, $operation);

    echo "<button id='buttonEditOperation_".$operation."' />";
}

function addButtonJavascript($tabID, $operation){

    $javascript = "
        $('#tabContent_".$tabID." [id^=\"buttonEditOperation_".$operation."\"]')
        .click( function() { alert('CLICK !'); })
        .button(blabla);";

    if(FALSE){
    //You can just add the Javascript directly to the web page, however in this case
    //it may throw an error if the user clicks on something before jQuery is
    //fully loaded.
        echo "<script type="text/javascript">";
        echo $javascript;
        echo "</script>";
    }
    else{
        //Much better is to save the Javascript to be included later.
        $GLOBALS['pageJavascript'][] = $javascript;
    }
}

function    displayPageJavascript(){

    echo "<script type="text/javascript">";
    foreach($GLOBALS['pageJavascript'] as $pageJavascript){
        echo $pageJavascript;
        echo "\n";
    }

    echo "</script>";

} 
```

无论您在何处添加按钮，而不是直接添加，请执行以下操作：{addButton tabID=$uniqueId operation=$op}

所以你的 Smarty 模板看起来像：

**智能模板**

```
<script type="text/javascript" src="./js/buttonInit.js"></script>
<div id="tabContent_{$uniqueId}">
  <table>
     {foreach $operations as $op}
       <tr><td>{addButton tabID=$uniqueId operation=$op}</td></tr>
    {/foreach}
  </table>
</div>

...
...
...
<!-- bottom of smarty template -->
{displayPageJavascript} 
```

在有人跳进来说用 PHP 编写 HTML 和 Javascript 是丑陋的并且不应该这样做之前 - 我完全同意！

然而在这种情况下，在 Smarty 中将小部件编写为插件的好处超过了丑陋：

*   它使用于操作小部件的 Javascript 位于小部件的 HTML 的几行内，与将它们放在单独的文件中相比，这使得编写和调试该小部件更容易。
*   将小部件的实现从智能模板中隐藏，意味着您可以在一个地方更改它的实现一次，并确保每次使用该小部件都会得到更新。
*   它使代码更加可靠，因为您的模板编辑器不必记住为他们添加的任何小部件单独添加 Javascript，因此编辑模板时的错误将大大减少。

# php - 为什么 php print_r($array) 不会打印字符串中的空格

> ID：14485206
> 
> 赞同：-2
> 
> 时间：2013-01-23T17:01:02.627
> 
> 标签：php, string, strlen

```
$myArray = array();

array_push($myArray, "'     a'");

use Framework\ArrayMethods as ArrayMethods;
print_r(($myArray));
print_r(ArrayMethods::lengtOfElements($myArray)); 
```

输出将是：

```
Array ( [0] => ' a' ) Array ( [0] => 8 ) 
```

所以在打印的字符串中 a 之前只有一个空格，但是 strelen 返回 8？如何让它打印'a'？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:56:25.043

就像@Marc-B 评论的那样，浏览器正在将多个连续的空格折叠成一个空格。对此的解决方案是：

1.  将文本包装在`<pre></pre>`标签中。
2.  使用 CSS[`white-space`属性](http://www.w3schools.com/cssref/pr_text_white-space.asp)。
3.  `&nbsp;`用 HTML实体替换空格。[非中断空间]

例如：

```
preg_replace("/ /", "&nbsp;", "     a");
//output: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-23T17:03:33.810

如果要在浏览器中查看，请包装：

```
print_r(($myArray));
print_r(ArrayMethods::lengtOfElements($myArray)); 
```

所以它有`<pre>`标签：

```
echo '<pre>';
print_r(($myArray));
print_r(ArrayMethods::lengtOfElements($myArray));
echo '</pre>'; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-23T17:04:32.787

这是因为 html 中的多个空格（连续两个或多个）只会显示为一个空格。如果您“查看源代码”，您可能会看到不同的结果。

如果您想在实际浏览器中查看而不是源代码，可以使用 pre 标签来解决这个问题：

```
$myArray = array();

array_push($myArray, "'     a'");

echo '<pre>';
print_r($myArray);
echo '</pre>'; 
```

# mysql - 从经度和纬度坐标中获取邮政编码

> ID：14485207
> 
> 赞同：2
> 
> 时间：2013-01-23T17:01:05.910
> 
> 标签：mysql, sql, math

我有一个邮政编码表，我想知道如何进行查询以获取`latitude`和`longitude`协调，并从中返回邮政编码。如何才能做到这一点？

这是我的表结构：

```
mysql> describe zipcodes;
+-----------+-----------------------+------+-----+---------+----------------+
| Field     | Type                  | Null | Key | Default | Extra          |
+-----------+-----------------------+------+-----+---------+----------------+
| id        | bigint(20)            | NO   | PRI | NULL    | auto_increment | 
| zip       | mediumint(5) unsigned | NO   | MUL | NULL    |                | 
| longitude | varchar(15)           | NO   | MUL | NULL    |                | 
| latitude  | varchar(15)           | NO   | MUL | NULL    |                | 
| city      | varchar(25)           | NO   |     | NULL    |                | 
| state     | varchar(25)           | NO   |     | NULL    |                | 
| county    | varchar(25)           | NO   |     | NULL    |                | 
| zipClass  | varchar(25)           | NO   |     | NULL    |                | 
+-----------+-----------------------+------+-----+---------+----------------+ 
```

我希望能够获得最接近`longitude`和`latitude`坐标的邮政编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:44:15.403

这是我发现的一个查询，它似乎有效。

```
SELECT zip, city, state, ((
    ACOS(SIN(-094.076163 * PI() / 180) * 
    SIN(latitude * PI() / 180) + 
    COS(-094.076163 * PI() / 180) * 
    COS(latitude * PI() / 180) * 
    COS((44.661216 - longitude) * PI() / 180)) * 180 / PI()
) * 60 * 1.1515) AS `distance` FROM zipcodes ORDER BY `distance` limit 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:45:52.810

给定您的表格，您需要计算给定纬度和经度与每个邮政编码的纬度和经度之间的距离，然后选择最小值。

（显然，找到“最近的”邮政编码并不意味着给定点实际上在邮政编码边界内。）

下面的查询有一个“大圆距离”计算的实现，但这将是一个昂贵的操作，因为这个计算将针对`zipcodes`表中的每一行执行：

```
SELECT ACOS( COS(RADIANS( d2.latitude ))
           * COS(RADIANS( d1.latitude ))
           * COS(RADIANS( d2.longitude ) - RADIANS( d1.longitude ))
           + SIN(RADIANS( d2.latitude ))
           * SIN(RADIANS( d1.latitude ))
           ) * 3958.82 AS distance_miles
     , d2.*
  FROM zipcodes d2
  JOIN (SELECT 44.9800 AS latitude, -93.2636 AS longitude) d1
 ORDER BY distance_miles DESC
 LIMIT 10 
```

# ruby-on-rails - order_by fixNum, integer... mongoid

> ID：14485208
> 
> 赞同：0
> 
> 时间：2013-01-23T17:01:09.237
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, mongoid

我有一个带有属性的对象`impressionist_count`。`impressionist_count`是一个`Fixnum`。

```
object.impressionist_count
# => `20`, `1000`, `26`, etc. 
```

我想按降序对所有对象进行排序，但它不起作用，例如：

```
Objects.order_by(:impressionist_count, :desc) 
```

我不知道我做错了什么。如何修复此代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:09:10.583

使用[`.desc()`](http://two.mongoid.org/docs/querying/criteria.html)：

```
Objects.desc(:impressionist_count) 
```

或者，`.order_by()`如果您使用这样的数组进行包装，则可以使用：

```
Objects.order_by([[:impressionist_count, :desc]]) 
```

# iphone - 在 Safari 中打开 YouTube URL 而不是 UIWebView

> ID：14485210
> 
> 赞同：2
> 
> 时间：2013-01-23T17:01:12.657
> 
> 标签：iphone, ios, xcode, youtube

在初始加载后，我正在尝试在 Safari 中加载任何 URL。对于任何其他网页，此代码都可以正常工作：

```
-(BOOL)webView:(UIWebView*)webView shouldStartLoadWithRequest:(NSURLRequest*)request navigationType:(UIWebViewNavigationType)navigationType {
    NSURL* url = [request URL];
    if (UIWebViewNavigationTypeLinkClicked == navigationType)
    {
        [[UIApplication sharedApplication] openURL:url];
        return NO;
    }

    return YES;
} 
```

但当我访问 m.youtube.com 时，代码不再执行任何操作，YouTube 继续在 UIWebView 中加载。我在网上找不到有关此的任何信息。有什么帮助吗？

这是我的整个 .m 文件：

```
#import "SecondViewController.h"

@interface SecondViewController ()

@end

@implementation SecondViewController
@synthesize topLayer = _topLayer;
@synthesize layerPosition = _layerPosition;
@synthesize webView = webView;

#define VIEW_HIDDEN 260

- (void)viewDidLoad
{
    [super viewDidLoad];

    webView.delegate = self;

    [webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://m.youtube.com"]]];
    [webView setBackgroundColor:[UIColor clearColor]];
    [webView setOpaque:NO];
    webView.scrollView.bounces = NO;
    webView.scrollView.indicatorStyle = UIScrollViewIndicatorStyleWhite;

    [self performSelector:@selector(makeTick)];

    self->promoteImages.contentSize = CGSizeMake(1920, 101);

    UIImageView *imageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"Scroll3.png"]];

    [self->promoteImages addSubview:imageView];

    [promoteImages setShowsHorizontalScrollIndicator:NO];

    // Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
    if (navigationType == UIWebViewNavigationTypeLinkClicked) {

        [[UIApplication sharedApplication] openURL:request.URL];
        return NO;
    }

    return YES;
}

@end 
```

这是我的视图控制器的 .h 文件：

```
#import <UIKit/UIKit.h>
#import <QuartzCore/QuartzCore.h>
#import <Social/Social.h>

@interface SecondViewController : UIViewController <UIWebViewDelegate>
{
    IBOutlet UIScrollView *promoteImages;
    NSTimer *time;

    IBOutlet UIWebView *webView;
}

@property (nonatomic, nonatomic) UIWebView *webView;
@property (weak, nonatomic) IBOutlet UIView *topLayer;
@property (nonatomic) CGFloat layerPosition;
@property(nonatomic,readonly,getter=isDragging)    BOOL dragging;

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:07:21.027

这是我使用的代码：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
    if (navigationType == UIWebViewNavigationTypeLinkClicked) {

        [[UIApplication sharedApplication] openURL:request.URL];
        return NO;
    }

    return YES;
} 
```

这是你的问题：

```
[[UIApplication sharedApplication] openURL:url]; 
```

改成：

```
[[UIApplication sharedApplication] openURL:request.URL]; 
```

您还可以仅指定要在 Safari 中打开的某些 URL，例如以`http://www.example.com/share`如下所示开头的任何 URL：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
        if ((navigationType == UIWebViewNavigationTypeLinkClicked) && ([currentURL hasPrefix:@"http://www.example.com/share"])) {

            [[UIApplication sharedApplication] openURL:request.URL];
            return NO;
        }
    } 
```

# php - PHP LDAP 更改 Active Directory samAccountName？

> ID：14485212
> 
> 赞同：0
> 
> 时间：2013-01-23T17:01:17.023
> 
> 标签：php, active-directory, ldap

我们针对被解雇/分居或请假的人的政策涉及对他们的 AD 帐户进行一些更改，以保持记录和安全。其中一项更改是将帐户（登录名、显示名和 dn）重命名为包含原始名称和附加服务台票号的值。

我已经能够使用 ldap_rename() 来更改活动目录的“名称”属性，从而更改 DN。我可以使用 ldap_modify() 或 ldap_mod_replace() 更改 displayName 属性。我似乎不能做的是使用其中任何一个来更改 samAccountName。下面是我正在使用的代码的核心。我得到的错误取决于我使用的功能，并在下面列出。

我知道在 Active Directory 中使用 PHP LDAP 有一些细微差别，但我很难相信我已经能够完成包括更改密码在内的所有操作，而且我无法更改 samAccountName... 帮助？

```
<?php
 $connection=ldap_connect(domain.local,389);
 ldap_set_option($connection,LDAP_OPT_PROTOCOL_VERSION,3);
 ldap_set_option($connection,LDAP_OPT_REFERRALS,0);
 ldap_start_tls($connection);
 ldap_bind($connection,$username,$password);

 $accountName=$_POST["accountName"];
 $ticketNumber=$_POST["ticketNumber"];
 $baseDn="dc=domain,dc=local";
 $attribs=array("samaccountname","dn","name","displayname","description","info","memberof");

 $search=ldap_search($connection,$baseDn,"(samaccountname=".$accountName.")",$attribs);
 $result=ldap_get_entries($connection,$search);

// ldap_modify returns error 80: Internal (implementation specific) error.
 foreach ($result as $account) {
  $newValues=array("samaccountname"=>$account["samaccountname"][0]."-".$ticketNumber)
 ldap_modify($connection,$account["dn"],$newValues);
 }

// ldap_mod_replace returns error 80: Internal (implementation specific) error.)
 foreach ($result as $account) {
  $newValues=array("samaccountname"=>$account["samaccountname"][0]."-".$ticketNumber)
 ldap_mod_replace($connection,$account["dn"],$newValues);
 }
?> 
```

所以，是的，我应该做些什么来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-11T00:20:58.903

您收到的“实施特定”错误消息意味着您的 sAMAccountName 无效，因为它不符合特定的 AD 限制。sAMAccountName 属性不能超过 20 个字符，并且不能包含以下任何内容：`" [ ] : ; | = + * ? < > / \ ,`。查看附加票号的示例用户名可能会有所帮助。

# c++ - C++ 类重新定义错误 - 帮助我理解标题和链接

> ID：14485215
> 
> 赞同：7
> 
> 时间：2013-01-23T17:01:28.000
> 
> 标签：c++, header, linker, redefinition

我开始用 C++ 编写一个简单的解释器，它的类结构将在下面描述，但我退出并用 Java 重写了这个东西，因为头文件让我很难过。这是 C++ 中显然不允许的基本结构：

**main.cpp**包含 main 函数，并包含一个我们可以调用 print.h 的类的标头**（**其单个 void 方法在**printer.cpp**中实现）。现在想象另外两个相同的类。两者都想调用`Printer::write_something();`，所以我在每个中都包含了**printer.h**。所以这是我的第一个问题：为什么我可以`#include <iostream>`一百万次，甚至一个接一个，但我只能包括*我的*标头一次？（好吧，我想我可以用我的做同样的事情，只要它在同一个文件中。但我可能是错的。）我理解声明和实现/定义之间的区别，但该代码给了我一个类重定义错误。我不明白为什么。这就是让我大吃一惊的事情（可能会告诉你为什么我什么都不明白）：我不能只在**main.cpp**的顶部包含**print.h**并使用我其他两个类中的类。我知道我可以毫无问题地将**printer.h**包含在两个类（标题）*之一*中，但我不明白为什么这与在将类包含在**main.cpp**之前包含它有什么不同（因为这样做会给出我一个类没有找到错误）。

 *******当我厌倦时，我考虑转向 C，因为我使用的 OOP 无论如何都非常强制，但是除非我将所有内容都写在一个文件中，否则我会遇到同样的问题。了解 C++ 但由于编译问题而无法正确使用它令人沮丧。

如果您能帮我解决这个问题，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T17:04:03.020

> 为什么我可以#include 一百万次，甚至一个接一个，但我只能包含一次标题？

这可能是因为您的标头没有[包含保护](http://en.wikipedia.org/wiki/Include_guard)。

```
// printer.h file
#ifndef PRINTER_H_
#define PRINTER_H_

 // printer.h code goes here

#endif 
```

请注意，最佳做法是为包含保护定义选择更长的名称，以最大程度地减少两个不同标头可能具有相同标头的可能性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T17:04:43.587

大多数头文件应该包含在包含保护中：

```
#ifndef MY_UNIQUE_INCLUDE_NAME_H
#define MY_UNIQUE_INCLUDE_NAME_H

// All content here.

#endif 
```

这样，编译器在每个翻译单元中只会看到一次标头的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T19:17:07.543

C/C++ 编译分为编译/翻译单元以生成目标文件。(.o, .obj)

[看这里翻译单元的定义](http://www.efnetcpp.org/wiki/Translation_unit)

C/C++ 文件中的#include 指令直接等效于同一文件中的简单递归复制粘贴。您可以尝试将其作为实验。

因此，如果同一个翻译单元两次包含相同的标头，编译器会看到某些实体被定义了多次，如果你将它们写在同一个文件中就会发生这种情况。错误输出将完全相同。

语言中没有内置的保护措施可以阻止您执行多个包含，因此您必须为每个 C/C++ 标头编写包含保护或特定的#pragma 样板。*******

# html - 在 HTML 中，如果我将一个 img 放在另一个后面，如何让它不占用两倍的空间？

> ID：14485217
> 
> 赞同：0
> 
> 时间：2013-01-23T17:01:38.133
> 
> 标签：html, css

如果我有一个图像，我的定位很好。但是，如果我在它后面添加第二个（`position: relative`并`z-index`应用），则定位会出现偏差，并且 div 似乎比以前占用了更多空间（它们都位于同一个 div 中）。

它们的大小相同。

这是我的 HTML：

```
<div class="resume-header">
    <a href="resume.pdf">
        <img src="media/resume-icon.png" alt="Resume icon" title="Download resume (PDF)" class="top-image" style="position:relative;z-index:2;">
        <img src="media/resume-icon-download.png" style="position:relative;right:132px;z-index:1;visibility:hidden;"><br>
        <span class="center-text">Resume (PDF)</span>
    </a>
</div> 
```

可能相关的CSS：

```
.resume-header {
    display: inline-block;
    position: relative;
    left: 130px;
    text-align: center;
}

.resume-header a {
    color: #333;
    font: 10px "Lucida Grande", Helvetica, sans-serif;
    text-align: center;
    text-decoration: none
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:05:30.580

当你想使用时，`z-index`你应该使用`position: absolute`来定位你的元素。

# ruby-on-rails - 无法激活 rack (~> 1.4.0, runtime) 已经激活 rack-1.5.0

> ID：14485219
> 
> 赞同：3
> 
> 时间：2013-01-23T17:01:37.633
> 
> 标签：ruby-on-rails, ruby-on-rails-3, gem, rack

一天多来，我一直在寻找这个问题的答案，并彻底搜索了 StackOverflow。

我了解正在发生的冲突，我应该卸载我不需要的 Rack 版本，但事情就是这样。我正在 Koding ( [http://koding.com](http://koding.com) ) 上进行开发，但我无法访问系统级 gem。

Rails 之前工作过，我安装了 mongo gem，将其删除，然后安装了 mysql2 gem。

```
bash4.1$ rails
/usr/lib/ruby/site_ruby/1.8/rubygems.rb:233:in `activate': can't activate rack (~> 1.4.0, runtime) for ["actionpack-3.2.11", "railties-3.2.11"
], already activated rack-1.5.0 for ["rack-ssl-1.3.2", "railties-3.2.11"] (Gem::LoadError)
from /usr/lib/ruby/site_ruby/1.8/rubygems.rb:249:in `activate'
from /usr/lib/ruby/site_ruby/1.8/rubygems.rb:248:in `each'
from /usr/lib/ruby/site_ruby/1.8/rubygems.rb:248:in `activate'
from /usr/lib/ruby/site_ruby/1.8/rubygems.rb:249:in `activate'
from /usr/lib/ruby/site_ruby/1.8/rubygems.rb:248:in `each'
from /usr/lib/ruby/site_ruby/1.8/rubygems.rb:248:in `activate'
from /usr/lib/ruby/site_ruby/1.8/rubygems.rb:1082:in `
from /usr/bin/rails:18 
```

我已将目录擦干净，尝试使用 RVM，但仍然一无所获。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T17:03:17.640

使用 Bundler 根据应用 Gemfile 解析 Rack 依赖。

```
$ bundle exec rails 
```

否则，删除 Rack 1.5.0 并重试。

```
$ gem uninstall rack
# select the proper version to delete 
```

# java - 超时连接上的 HttpServletResponse.flushBuffer() 不会抛出 IOException

> ID：14485220
> 
> 赞同：1
> 
> 时间：2013-01-23T17:01:40.100
> 
> 标签：java, servlets, jboss

我面临着一个非常不寻常的情况。我有两个通过 HTTP 通信的 Jboss (7.1) 实例。实例 A 打开到实例 B 的 HTTP 连接，并发送一些要处理的数据。连接设置了超时，因此如果 N 秒后没有读取响应，则会抛出 SocketTimeoutEception。执行一些清理并关闭连接。实例 B 有一个 servlet，监听这样的 http 请求，当收到一个请求时，就完成了一些计算。之后，响应被填充并返回给客户端。

问题是如果计算时间过长，客户端（A）会因为超时而关闭连接，但服务器（B）会照常进行，并会在一段时间后尝试发送响应。我希望能够检测到连接已关闭并做一些家务，但我似乎无法做到这一点。

我试过调用 HttpServletResponse.flushBuffer()，但没有抛出异常。我还在http请求中明确设置“连接：关闭”以避免持久连接，但这没有效果。http servlet resonse 正常处理，无一例外地消失在虚空中。我不知道我做错了什么，我在这个网站上读过其他问题，比如：

[Java 的 HttpServletResponse 没有 isClientConnected 方法](https://stackoverflow.com/questions/7606366/javas-httpservletresponse-doesnt-have-isclientconnected-method)

[Tomcat - Servlet 响应阻塞 - 刷新问题](https://stackoverflow.com/questions/13446483/tomcat-servlet-response-blocking-problems-with-flush)

但在我的情况下它们不起作用。

我认为 jboss servlet 容器可能有一些特定的东西，这会导致忽略或缓冲响应，或者尽管我努力从客户端 (A) 关闭它，但可能重用了 http 连接。如果您能提供一些关于在哪里寻找问题的指示，我会很高兴。我花了几天时间，没有取得相关进展，所以我需要紧急解决这个问题。

以下是相关代码：

**客户端代码（服务器 A）：**

```
 private static int postContent(URL destination, String fileName, InputStream content)
    throws IOException, CRPostException
    {
        HttpURLConnection connection = null;

        //Create the connection object
        connection = (HttpURLConnection)destination.openConnection();

        // Prepare the HTTP headers
        connection.setDoOutput(true);
        connection.setInstanceFollowRedirects(false);
        connection.setRequestMethod("POST");
        connection.setRequestProperty("content-type", "text/xml; charset=UTF-8");
        connection.setRequestProperty("Content-Encoding", "zip");
        connection.setRequestProperty("Connection", "close");//Try to make it non-persistent

        //Timouts
        connection.setConnectTimeout(20000);//20 sec timout
        connection.setReadTimeout(20000);//20 sec read timeout

        // Connect to the remote system
        connection.connect();

        try
        {
            //Write something to the output stream
            writeContent(connection, fileName, content);

            //Handle response from server
            return handleResponse(connection);
        }
        finally
        {
            try
            {
                try
                {
                    connection.getInputStream().close();//Try to explicitly close the connection
                }
                catch (Exception e)
                {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                connection.disconnect();//Close the connection??
            }
            catch (Exception e)
            {
                logger.warning("Failed to disconnect the HTTP connection");
            }
        }
    }

private static int handleResponse(HttpURLConnection connection)
    throws IOException, CRPostException
    {
        String responseMessage = connection.getResponseMessage();//Where it blocks until server returns the response 
        int statusCode = connection.getResponseCode();
        if (statusCode == HttpURLConnection.HTTP_OK)
        {
            logger.debug("HTTP status code OK");
            InputStream in = connection.getInputStream();

            try
            {
                if (in != null)
                {
                    //Read the result, parse it and return it
                    ....
                }
            }
            catch (JAXBException e)
            {
            }
        }// if

        //return error state
        return STATE_REJECTED;
    }//handleResponse() 
```

**服务器代码（服务器 B）：**

```
 protected void doPost(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, IOException
{
    String crXML = null;
    MediaType mediaType = null;
    Object result;

    // Get the media type of the received CR XML
    try
    {
        mediaType = getMediaType(request);
        crXML = loadDatatoString(mediaType, request);
        result = apply(crXML);
    }
    catch (Exception e)
    {
        logger.error("Application of uploaded data has failed");

        //Return response that error has occured
        ....

        return;
    }

    // Finally prepare the OK response
    buildStatusResponse(response, result);

    // Try to detect that the connection is broken
    // and the resonse never got to the client
    // and do some housekeeping if so
    try
    {
        response.getOutputStream().flush();
        response.flushBuffer();
    }
    catch (Throwable thr)
    {
        // Exception is never thrown !!!
        // I expect to get an IO exception if the connection has timed out on the client
        // but this never happens
        thr.printStackTrace();
    }
}// doPost(..)

public static void buildStatusResponse(HttpServletResponse responseArg, Object result)
{
    responseArg.setHeader("Connection", "close");//Try to set non persistent connection on the response too - no effect

    responseArg.setStatus(HttpServletResponse.SC_OK);

    // write response object
    ByteArrayOutputStream respBinaryOut = null;
    try
    {
        respBinaryOut = new ByteArrayOutputStream();
        OutputStreamWriter respWriter = new OutputStreamWriter(respBinaryOut, "UTF-8");
        JAXBTools.marshalStatusResponse(result, respWriter);
    }
    catch (Exception e)
    {
        logger.error("Failed to write the response object", e);
        return;
    }

    try
    {
        responseArg.setContentType(ICRConstants.HTTP_CONTENTTYPE_XML_UTF8);
        responseArg.getOutputStream().write(respBinaryOut.toByteArray());
    }
    catch (IOException e)
    {
        logger.error("Failed to write response object in the HTTP response body!", e);
    }
}//buildStatusResponse() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T01:20:10.413

您在客户端遇到了 HTTP 连接池。物理连接并没有真正关闭，它被返回到池中以供以后重用。如果它空闲了一段时间，它将被关闭并从池中删除。因此，在服务器 flushBuffer() 发生的那一刻，连接仍然存在。

或者

被刷新的数据足够小，可以放入发送方的套接字发送缓冲区，因此底层的写入立即成功返回，而断开连接只是后来才被 TCP 异步发现的。

# .htaccess - 使用 .htaccess 重写多个 URL

> ID：14485222
> 
> 赞同：1
> 
> 时间：2013-01-23T17:01:48.897
> 
> 标签：.htaccess, mod-rewrite

我不能`t understand, why URL rewrite doesn`工作。

我有脚本，它会获取包含内容的文件。

```
 if($pg){
        if(file_exists("resources/pages/".$pg.".php")){
            include("resources/pages/".$pg.".php");
        }
        else{
            include("resources/pages/notfound.php");
        }
   }
   else {
        include("resources/pages/home.php");
   } 
```

还有需要重写 URL 的 htaccess。有类别、页面和语言字符串需要重写。

```
RewriteEngine On
RewriteRule ^([^/]*)/$ /?lang=$1 [NC,OR]
RewriteRule ^([^/]*)/$ /?cat=$1 [NC,OR]
RewriteRule ^([^/]*)/$ /?pg=$1 [NC,OR]
RewriteRule ^([^/]*)/([^/]*)/$ /?lang=$1&pg=$2 [NC,OR]
RewriteRule ^([^/]*)/([^/]*)/$ /?cat=$1&pg=$2 [NC,OR]
RewriteRule ^([^/]*)/([^/]*)/$ /?lang=$1&cat=$2 [NC,OR]
RewriteRule ^([^/]*)/([^/]*)/([^/]*)/$ /?lang=$1&cat=$2&pg=$3 [NC,L] 
```

这显示内部服务器错误。如果我只留下第一行

```
RewriteEngine On
RewriteRule ^([^/]*)/$ /?lang=$1 [L] 
```

只有语言切换工作正常。当放第二排

```
 RewriteEngine On
RewriteRule ^([^/]*)/$ /?lang=$1 [NC,OR]
RewriteRule ^([^/]*)/$ /?cat=$1 [NC,L] 
```

语言切换工作，但下一个规则不起作用。:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:30:48.933

该`OR`标志仅用于 a `RewriteCond`，如果您尝试将其与 a 一起使用，它会给您一个错误`RewriteRule`。您遇到的问题是，就匹配模式而言，路由到`/?lang=`、`/?cat=`和的 URI`/?pg=`是*相同的。*鉴于此网址：

```
http://yourdomain.com/blahblah/ 
```

您的所有 3 个模式（全部）都使用**$1**`^([^/]*)/$`匹配`/blahblah/`和分组`blahblah`作为反向引用。但它是一个lang吗？是猫吗？或者它是一个页面？您需要唯一地创建模式以匹配这 3 个中的每一个，并且它们必须是互斥的。

 **参数是否`pg`只有数字？如果是这样，那么路由到它的模式应该是`^([0-9]+)/$`. lang 变量只有 2 个字母吗？如果是这样，那么路由到 lang 的模式应该是`^([a-z]{2})/$`. 请注意，这仅在 cat 参数*为 1 个字符或超过 2 个字符或包含数字和符号*时才有效。

不管是什么，你都需要解决它。这就是你看到这种行为的原因。**

# regex - 在 Excel 或 VBA 脚本中进行正则表达式解析以将文本分成两行

> ID：14485223
> 
> 赞同：0
> 
> 时间：2013-01-23T17:01:51.760
> 
> 标签：regex, excel, vba

我有一个具有三种不同形式的纬度和经度坐标的单元格。单元格内的内容如下所示：

> 35°21′N 81°47′W / 35.35°N 81.79°W / 35.35；-81.79（埃伦伯勒（1 月 11 日，EF2））
> 38°46′N 85°28′W / 38.76°N 85.46°W / 38.76；-85.46（麦迪逊（1 月 17 日，EF0））
> 等。

我只想提取最后一组数字（35.35；-81.79）并将每个数字放在不同的行中，一个用于纬度，一个用于经度。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:55:45.153

如果您对使用**公式**感到满意- 这是我的解决方案（假设原始字符串放置在从 A2 开始的 A 列中）：

1.  B2（纬度）`=TRIM(MID($A2,SEARCH("@",SUBSTITUTE($A2,"/","@",2))+1,SEARCH("@",SUBSTITUTE($A2,";","@"))-SEARCH("@",SUBSTITUTE($A2,"/","@",2))-1))`：。
2.  C2（经度）`=TRIM(MID($A2,SEARCH("@",SUBSTITUTE($A2,";","@"))+1,SEARCH("@",SUBSTITUTE($A2,"(","@"))-SEARCH("@",SUBSTITUTE($A2,";","@"))-1))`：。
3.  根据需要自动填充两个公式。

这会将结果作为**字符串**返回。如果您希望它们作为**数字**- 只需将`=VALUE(...)`包装器添加到每个公式。但是，我的本地设置使用**逗号**作为小数分隔符，所以我必须再添加一个`SUBSTITUTE`来处理这个问题。

为方便起见，共享示例文件：[https ://www.dropbox.com/s/twkcln8lozdgga9/CoordsSplit.xlsx](https://www.dropbox.com/s/twkcln8lozdgga9/CoordsSplit.xlsx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:13:03.023

从替换开始：

```
\s+\(.* 
```

由空字符串。然后替换：

```
^.*/\s+ 
```

由空字符串。然后，您将只剩下最后一组数字，然后很容易拆分它们（使用`\s*;\s*`）。

perl 中的演示：

```
$ perl -ne 's,\s+\(.*,,; s,^.*/\s+,,; my @coords = (split(/\s*;\s*/)); print "Latitude: $coords[0]; longitude: $coords[1]"' <<EOF
> 35°21′N 81°47′W / 35.35°N 81.79°W / 35.35; -81.79 (Ellenboro (Jan. 11, EF2))
> 38°46′N 85°28′W / 38.76°N 85.46°W / 38.76; -85.46 (Madison (Jan. 17, EF0))
> EOF
Latitude: 35.35; longitude: -81.79
Latitude: 38.76; longitude: -85.46 
```

# typo3 - 菜单：包装每个 X 项目

> ID：14485225
> 
> 赞同：0
> 
> 时间：2013-01-23T17:01:58.633
> 
> 标签：typo3, typoscript

我正在尝试将每个第三项包装在使用 TypoScript 生成的菜单中。

这是我的菜单：

```
tt_content.menu.20.4 >
tt_content.menu.20.4 < tt_content.menu.20.1
tt_content.menu.20.4.stdWrap.outerWrap = <div class="my-menu">|</div>
tt_content.menu.20.4.1.wrap = <ul>|</ul>
tt_content.menu.20.4.1.NO {
    doNotLinkIt = 1
    stdWrap.htmlSpecialChars = 0
    stdWrap.cObject = COA
    stdWrap.cObject {
        # title
        10 = TEXT
        10 {
            field = title
            typolink.parameter.field = uid
            typolink.ATagParams = class="more"
        }

        # abstract
        20 = TEXT
        20 {
            field = abstract
            htmlSpecialChars = 1
            wrap = <span>|</span>
        }
    }
} 
```

通过[如何对每个菜单项应用不同的包装？](https://stackoverflow.com/questions/7814066/how-can-i-apply-a-different-wrap-to-every-menu-item)我知道如何包装每件不同的物品，有没有办法将三件物品包装在一起？并且当有超过 3 % x = 0 个项目时，例如 14，最后一个开始标签必须用最后一个项目关闭。

电流输出：

```
<ul class="csc-menu csc-menu-1">
    <li>
        <a href="index.php?id=1">Page 1</a>
    </li>
    <li>
        <a href="index.php?id=2">Page 2</a>
    </li>
    <li>
        <a href="index.php?id=3">Page 3</a>
    </li>
    <li>
        <a href="index.php?id=4">Page 4</a>
    </li>
    <li>
        <a href="index.php?id=5">Page 5</a>
    </li>
    <li>
        <a href="index.php?id=6">Page 6</a>
    </li>
    <li>
        <a href="index.php?id=7">Page 7</a>
    </li>
    <li>
        <a href="index.php?id=8">Page 8</a>
    </li>
    <li>
        <a href="index.php?id=9">Page 9</a>
    </li>
</ul> 
```

想要的输出，像这样：

```
<div class="pack">
    <a href="index.php?id=1">Page 1</a>
    <a href="index.php?id=2">Page 2</a>
    <a href="index.php?id=3">Page 3</a>
</div>
<div class="pack">
    <a href="index.php?id=4">Page 4</a>
    <a href="index.php?id=5">Page 5</a>
    <a href="index.php?id=6">Page 6</a>
</div>
<div class="pack">
    <a href="index.php?id=7">Page 7</a>
    <a href="index.php?id=8">Page 8</a>
    <a href="index.php?id=9">Page 9</a>
</div>
<div class="pack">
    <a href="index.php?id=10">Page 10</a>
    <a href="index.php?id=11">Page 11</a>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T08:28:22.103

基本上你问了2个问题。

但对于两者，您都可以使用 optionSplit。[1.]

**第一个：“包装每 3 个项目”**

您的代码将如下所示：

```
tt_content.menu.20.4.1.NO.allWrap = |*| <ul>|</ul> || <ul>|</ul> || <ul class="third">|</ul> |*| 
```

**第二：“有没有办法将三个项目包装在一起”**

您的代码将如下所示：

```
tt_content.menu.20.4.1.NO.allWrap = |*| <div class="threepack"> <ul>|</ul> || <ul>|</ul> || <ul>|</ul> </div> |*| 
```

***optionSplit 在这些情况下如何工作：***

*   您没有第一部分和最后一部分，因此中间部分循环遍历所有项目。
*   中间部分由三个循环的子部分组成。

希望有帮助。

PS：不要忘记接受答案;-)

*链接：*

1.  [http://wiki.typo3.org/TSref/optionSplit](http://wiki.typo3.org/TSref/optionSplit)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:40:09.723

下面的排版可能对您有所帮助（页面菜单将3个页面链接组合在一起，您需要根据您的要求进行修改。）：

```
page.234 = COA
page.234{
wrap = <ul> |</ul>
10 = HMENU
10.1 = TMENU
10.special = directory
10.special.value = 1
10.1 {
wrap = <li><ul>|</ul></li>
begin = 1
maxItems = 3
NO {
   allWrap = <li> |</li>
}
}
20 < .10
20.1.begin = 6
30 < .10
30.1.begin = 9
# etc. etc.
} 
```

# c# - 在代码隐藏中将字符串转换为可执行的 c# 代码

> ID：14485226
> 
> 赞同：3
> 
> 时间：2013-01-23T17:02:01.187
> 
> 标签：c#, asp.net, webforms

> **可能重复：**
> [在 C# 4.0 中执行字符串](https://stackoverflow.com/questions/760088/execute-a-string-in-c-sharp-4-0)

我怎样才能让这个字符串执行：

```
string dt = "DateTime.Now"; 
```

...这样会导致显示今天的日期？：

```
lbl.Text = dt; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T17:30:05.373

Codedom 的解决方案：

```
private static string CreateExecuteMethodTemplate(string content)
{
    var builder = new StringBuilder();

    builder.Append("using System;");
    builder.Append("\r\nnamespace Lab");
    builder.Append("\r\n{");
    builder.Append("\r\npublic sealed class Cal");
    builder.Append("\r\n{");
    builder.Append("\r\npublic static object Execute()");
    builder.Append("\r\n{");
    builder.AppendFormat("\r\nreturn {0};", content);
    builder.Append("\r\n}");
    builder.Append("\r\n}");
    builder.Append("\r\n}");

    return builder.ToString();
}

private static object Execute(string content)
{
    var codeProvider = new CSharpCodeProvider();
    var compilerParameters = new CompilerParameters
    {
        GenerateExecutable = false,
        GenerateInMemory = true
    };

    compilerParameters.ReferencedAssemblies.Add("system.dll");

    string sourceCode = CreateExecuteMethodTemplate(content);
    CompilerResults compilerResults = codeProvider.CompileAssemblyFromSource(compilerParameters, sourceCode);
    Assembly assembly = compilerResults.CompiledAssembly;
    Type type = assembly.GetType("Lab.Cal");
    MethodInfo methodInfo = type.GetMethod("Execute");

    return methodInfo.Invoke(null, null);
} 
```

所以你可以打电话：

```
var result = Execute("DateTime.Now"); 
```

# jquery - jquery恢复覆盖div

> ID：14485234
> 
> 赞同：0
> 
> 时间：2013-01-23T17:02:17.267
> 
> 标签：jquery

我有一个显示图像的 div：

```
<div id="player" style="display:block;width:320px;height:240px;background-image:url(../../../images/video.JPG)"></div> 
```

当有人单击按钮时，我在该 div 顶部覆盖了一个视频播放器（flowplayer）：

```
flowplayer("player", "mysite/js/flowplayer/flowplayer-3.2.12.swf", {
        clip: {
            url: theUrl,
            provider: 'rtmp'
        },
        plugins: {
            rtmp: {
                url: "js/flowplayer/flowplayer.rtmp-3.2.10.swf",
                netConnectionUrl: 'rtmp://myhost.com/recordings'
            }
        }
    }); 
```

我的逻辑是，当有人删除该视频时，我希望播放器离开并只留下带有图像的 div。

所以我不能只使用：

```
jQuery("#player").hide(); 
```

这隐藏了播放器和带有图像的原始 div。如何隐藏播放器而不隐藏图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:05:02.883

你可以简单地清空div ...

```
jQuery("#player").empty(); 
```

我对 flowplayer 不熟悉，但这会删除所有子元素，我认为这只是一个 swf 播放器对象。

您也可以隐藏所有子对象，但这会使视频仍在播放......

```
jQuery("#player *").hide(); 
```

# azure - SQL Azure 联合 - 开发环境

> ID：14485235
> 
> 赞同：3
> 
> 时间：2013-01-23T17:02:17.440
> 
> 标签：azure, azure-sql-database, federation

我的团队开发环境基于本地数据库 (SQL Server)，现在我需要将我们的应用程序迁移到基于 SQL Azure 联合。有什么方法可以在本地环境中“模拟”SQL Azure 联合？或者我们的开发环境应该改变吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T01:11:59.167

阿法克，你不能。

虽然您可以模拟本地 SQL Server 上数据的存储位置（例如，表分区或分区视图）的分区，但您无法模拟 FEDERATION 语句（即 USE FEDERATION 等），因为它们仅在 Azure SQL 数据库联合中有效。

# datasource - 在我的报告中使用我的 ObjectDataSource 中的列表作为报告中 Telerik 图表的数据源

> ID：14485241
> 
> 赞同：0
> 
> 时间：2013-01-23T17:02:28.820
> 
> 标签：datasource, objectdatasource, telerik-reporting, telerik-charting

嘿，我正在尝试在报表上的 ObjectDataSource (objectDataSource1) 对象中使用列表 (Loans)，作为同一报表上 Telerik 图表的 DataSource。我看过的大多数教程都显示了使用 SQL 字符串查询数据库的报告。我觉得我看起来有点傻。我也在 Telerik 上发过帖子，但还没有得到回复。

我想做的是这样的：

```
chart1.DataSource = objectDataSource1.Loans; 
```

或者能够在运行时设置它，就像我对报告中的其他报告工具所做的那样：

```
[=Fields.CurrentModel.Loans] 
```

是否可以使用 ObjectDataSource 中的列表作为我的图表的数据源？希望这很清楚。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:51:56.217

所以在深入研究之后，我在 Telerik 的论坛上找到了这篇文章：

[http://www.telerik.com/community/forums/reporting/telerik-reporting/build-chart-with-object-data-source.aspx](http://www.telerik.com/community/forums/reporting/telerik-reporting/build-chart-with-object-data-source.aspx)

图表本身具有“绑定”，您可以在其中设置一个表达式，您可以在其中将图表的 DataSource 属性设置为对象数据源上的列表。

转到图表的 Properties 列，然后单击 Bindings 下的椭圆按钮： ![在此处输入图像描述](../Images/f1221ba69a517c67a4c8e18d19c60b68.png)

然后从那里设置属性路径和表达式，你就可以了

![在此处输入图像描述](../Images/af92ff4c28f2f511d31e579fc07f8814.png)

# android - 使用 FLAG_ACTIVITY_NEW_TASK 将现有任务置于前面

> ID：14485245
> 
> 赞同：1
> 
> 时间：2013-01-23T17:02:43.137
> 
> 标签：android, android-activity, back-stack

android文档`FLAG_ACTIVITY_NEW_TASK`说：

**使用此标志时，如果您现在正在启动的 Activity 已经在运行任务，则不会启动新的 Activity；相反，当前任务将简单地以其上次所处的状态被带到屏幕的前面。**

我做了一个演示来实现这个，有两个应用程序：A和B。A包含活动A1，B包含活动B1，B2。

我按照以下步骤操作：`Home Screen(Application A icon) --> A1 (FLAG_ACTIVITY_NEW_TASK to start B1)--> B1 -->B2 --> Home Screen(Application B icon)-->` 据我了解，单击启动器中的应用程序 B 图标以启动 Activity B1 将使用`FLAG_ACTIVITY_NEW_TASK`，对吗？所以它应该把之前启动的任务放在前面，但不幸的是，一个新的活动 B1 开始了，B 任务堆栈是这样的：（底部）B1 B2 B1。

当我单击启动器中的应用程序 B 图标时，如何让现有任务显示在前面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:01:33.530

A 和 B 是两个不同的应用程序，对吧？这意味着两者都将作为单独的进程执行并作为单独的任务运行。

因此，当您将 FLAG_ACTIVITY_NEW_TASK 设置为 A 时，它将为 A 创建一个单独的任务，并将其作为根 Activity 或置于 A 的现有实例前面。

当 B 从启动器启动时，根据 android 正常的启动器行为，它将作为单独的任务启动，并且 B 将具有单独的堆栈。

# c# - c/c++ 类似于 c# System.ServiceModel.Channels.BufferManager

> ID：14485247
> 
> 赞同：1
> 
> 时间：2013-01-23T17:02:58.350
> 
> 标签：c#, c++, c, buffer

是否有 ac/c++ 类似物或类似于 c# BufferManager 类的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:06:49.290

该标准没有为此提供解决方案。但是有一些缓冲池的开源实现。比如[这个](http://www.codeproject.com/Articles/3526/Buffer-Pool-Object-Pool)或者[这个。](http://titanium.cs.berkeley.edu/src/titaniumc/BufferPool.h)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:09:20.387

从[源头](http://www.cise.ufl.edu/class/cop6726sp07/assign/assign1.htm)

> LRU 缓冲区管理器将是 C++ 类，它将实现以下相当简单的标头（您应该将此标头逐字放入文件 LRU.h）。请注意，虽然您必须为此作业实现一个 C++ 类，但我并不是要您使用任何更炫的 C++ 功能（例如模板、继承等），当然您可以自由使用这些在您的代码中构造。因此，C 程序员应该很容易调整和完成分配。

# javascript - Sencha Touch 2 应用程序具有多个代理

> ID：14485254
> 
> 赞同：0
> 
> 时间：2013-01-23T17:03:21.010
> 
> 标签：javascript, sencha-touch-2

我有两个商店。每个都与一个模型相关联。第一个商店有一个代理来从 php 文件中读取数据，我需要第二个商店从另一个 php 文件中读取数据。

我可以使用多个代理在 Sencha Touch 2 中开发应用程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T05:51:32.230

每个商店都可以拥有自己的代理，但如果它只是不同的目标 php，您可以调整 url 以指向您想要的任何 php。请记住响应数据应该相似，因为它将对所有 URL 使用相同的模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T12:25:29.900

好的，我已经解决了这个问题。

ThinkFloyd，你是对的。但是我需要有两个 Store 因为收取不同的数据，并且我需要将每个 Store 关联到不同的模型。

我的问题是我的第二个 Ajax 代理没有加载数据。我通过向每个代理添加一个 ID 解决了这个问题。

```
proxy: {
        type: 'ajax',
        id: 'proxyId',
        url: 'http://.../read.php',
        reader: {
            type: 'json'
        }
    } 
```

# algorithm - 给定二叉树中的垂直和

> ID：14485255
> 
> 赞同：4
> 
> 时间：2013-01-23T17:03:29.300
> 
> 标签：algorithm, data-structures, binary-tree

给定一棵二叉树，求同一垂直线上的节点的垂直总和。通过不同的垂直线打印所有总和。

要了解什么是相同的垂直线，我们需要先定义水平距离。如果两个节点具有相同的水平距离 (HD)，则它们位于同一垂直线上。高清的想法很简单。根的HD为0，右边缘（连接右子树的边缘）被认为是+1水平距离，左边缘被认为是-1水平距离。例如，在上面的树中，节点 4 的 HD 为 -2，节点 2 的 HD 为 -1，5 和 6 的 HD 为 0，节点 7 的 HD 为 +2。

例子：

```
 1
  /   \
 2     3
/ \   / \
4  5  6  7 
```

这棵树有 5 条垂直线

Vertical-Line-1 只有一个节点 4 => 垂直总和为 4

Vertical-Line-2：只有一个节点 2=> 垂直总和为 2

Vertical-Line-3：具有三个节点：1,5,6 => 垂直总和为 1+5+6 = 12

Vertical-Line-4：只有一个节点 3 => 垂直总和为 3

Vertical-Line-5：只有一个节点 7 => 垂直总和为 7

所以预期的输出是 4、2、12、3 和 7

***我的解决方案：*** 我想出了针对这个问题的 ao(nlong(n)) 解决方案。这个想法是：

(1) 使用前序遍历得到每个节点的HD，并将HD及其关联节点存储在一个数组中。

(2) 按HD对数组进行排序

(3) 遍历排序后的数组打印结果。

我确定这不是解决此问题的最佳方法。谁能帮我提供更好的解决方案？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-23T17:10:31.427

你不能在第一次遍历中全部完成吗？定义从 HD 到 sum 的字典（哈希图）。对于您访问的每个节点，将其值添加到正确的字典键中 - 这是一个`O(n)`解决方案。

```
d = {}

def traverse(node, hd):
  if not node:
    return
  if not hd in d:
    d[hd] = 0
  d[hd] = d[hd] + node.value
  traverse(node.left, hd - 1)
  traverse(node.right, hd + 1) 
```

然后打电话`traverse(root, 0)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-25T11:11:08.547

```
#define HD_OFFSET 16

void vertical_sum(Node *node, int hd, int sum[], int *min, int *max){

/* We are offseting the index to access array correctly.
Root will be at HD_OFFSET/2 index and all vertical lines on left will
be at 0 to HD_OFFSET/2 and right side will be on HD_OFFSET/2 to HD_OFFSET */

int index = hd + HD_OFFSET/2;

if(!node) return;

/* to keep track of min and max index filled in sum array */
if(index > (*max)) (*max) = index;
if(index < (*min)) (*min) = index;

sum[index]+= node->value;
/*If we are moving on the left side, 
we will pass index as one less the current */
vertical_sum(node->left, hd-1, sum, min, max);

/*If we are moving on the right side, 
we will pass index as one more the current */
vertical_sum(node->right, hd+1, sum, min, max);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-10T17:53:44.513

使用级别顺序遍历，使用包含元素的队列以及它们的 HD 值。以下算法将在 O(n) [未运行测试] 中给出解决方案

```
void findVertSum( struct node *root)
{
 enqueue(root);
 enqueue(0);
 while(!isEmptyQueue())
 {
   tempnode = dequeue();
   vertIndex = dequeue();

   sum[vertIndex] += tempnode->val;  
       // Array cant be used because there will be sum[-1], sum[-2] etc, which will give error. This line hense only gives the idea to store solution.

   if(t->left)
   {
     enqueue(t->left);
     enqueue(vertIndex - 1);
   }

   if(t->right)
   {
     enqueue(t->right);
     enqueue(vertIndex + 1);
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-24T06:43:19.610

这是我在 O(n) 中运行的解决方案`

```
 #include <iostream>
 #include <vector>
 using namespace std;

 vector<int> v;
 int size;

typedef struct node
{
int data;
struct node *left, *right ;
} node, *ptr;

ptr newNode(int item)
{
ptr temp =  new node;
temp->data = item;
temp->left = temp->right = NULL;
return temp;
}

void printVerticalSumUtil(ptr root, int line)
{

if (root == NULL) return;
else
{

    v[line] += root->data;
    printVerticalSumUtil(root->left, line - 1);
    printVerticalSumUtil(root->right, line + 1);
}

}

void printVerticalSum(ptr root)
{
if (root == NULL)
    return;

//Calculating the line No for the root
ptr curr = root;
int line = 0;
while (curr->left != NULL)
{
    curr = curr->left;
    line++;
}
size = 2 * line + 1;  //Total No of Lines
line++;      //Adjusting line no for root

for (int i = 1; i <= size; ++i)   //Initializing lines to zero
    v.push_back(0);

printVerticalSumUtil(root, line);

for (int i = 1; i <= size; ++i)
{
    cout << "Sum of Line " << i << " is " << v[i] << endl;
}
}

int main()
{

ptr root = newNode(1);
root->left = newNode(2);
root->right = newNode(3);
root->left->left = newNode(4);
root->left->right = newNode(5);
root->right->left = newNode(6);
root->right->right = newNode(7);

printVerticalSum(root);

return 0;
}` 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T18:14:17.687

这是 C 中的一个。返回时的 vsum 数组将有结果。

```
void vsum(struct tree *t, int vsum[], int depth)     {

    if (t == NULL)
        return;

    vsum[depth] += t->val;
    depth++;

    vsum(t->left, vsum, depth);
    vsum(t->right, vsum, depth);

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-07T14:46:57.647

这是我在 C# 中的解决方案：请注意顺序很重要，因此我必须创建一个类并应用自定义排序。

```
public class Location 
{
    public int x, y, val;

    public Location(int x, int y, int val)
    {
        this.x = x;
        this.y = y;
        this.val = val;
    }
}

private List<Location> locations;
public IList<IList<int>> VerticalTraversal(TreeNode root)
{
    // Each location is a node's x position, y position, and value
    locations = new List<Location>();
    dfs(root, 0, 0);
    locations.Sort(Comparer<Location>.Create((a,b) =>
    {
        if (a.x != b.x)
            return a.x.CompareTo(b.x);
        return a.y != b.y ? a.y.CompareTo(b.y) : a.val.CompareTo(b.val);
    }));

    var result = new List<IList<int>>();
    result.Add(new List<int>());

    int prev = locations[0].x;

    foreach(Location loc in locations)
    {
        // If the x value changed, it's part of a new report.
        if (loc.x != prev)
        {
            prev = loc.x;
            result.Add(new List<int>());
        }

        // We always add the node's value to the latest report.
        result[result.Count - 1].Add(loc.val);
    }
    return result;
}

private void dfs(TreeNode node, int x, int y)
{
    if (node != null)
    {
        locations.Add(new Location(x, y, node.val));
        dfs(node.left, x - 1, y + 1);
        dfs(node.right, x + 1, y + 1);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-24T17:54:37.843

以下代码将完成这项工作：

使用语言：Java

```
 //  Algorithm for calculating the vertical sum of a binary tree.
static void verticalSum(Node root, int[] sum, int index)
{
    /*
       The sum array contains the sum of each 
       vertical line starting from the leftmost vertical line.
    */
    if(root==null)
    {
        return;
    }
    else
    {
        sum[index]+=(int)root.data;
        verticalSum(root.left, sum, index-1);
        verticalSum(root.right, sum, index+1);
    }
} 
```

您需要使用以下代码调用上述函数：

```
//Algorithm for calculating the vertical sum of a binary tree.
int level=countLevels(root);
int a=1,d=2,n=level;
int sizeOfArray= a+(n-1)*d;
int index=sizeOfArray/2;
int[] sum=new int[sizeOfArray];
verticalSum(root, sum, index);
System.out.print("Vertical Sum of the binary tree is : ");
for(int i=0;i<sizeOfArray;i++)
{
    System.out.print(", " + sum[i]);
} 
```

下面提供了 countLevels(root) 函数：

```
//  Algorithm for calculating the number of levels
static int countLevels(Node root)
{
    int count=0,c=1,i=0,level=0;
    Queue<Node> queue=new LinkedList<Node>();
    Node temp = null;
    queue.add(root);
    while(true)
    {
        if(queue.isEmpty())
        {
            break;
        }
        level++;
        for(i=0;i<c;i++)
        {
            temp=queue.remove();
            if(temp.left!=null)
            {
                queue.add(temp.left);
                count++;
            }
            if(temp.right!=null)
            {
                queue.add(temp.right);
                count++;
            }
        }
        c=count;
        count=0;
    }
    return level;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-12-24T14:02:45.540

这是我在 C++ 中的简单解决方案：- 这里我使用地图根据与中心的水平距离来存储总和。

```
Node *vsumprint(Node *root,int level,map<int,int> &mp){
    if(root==NULL)return NULL;
    Node *temp = vsumprint(root->left,--level,mp);
    if(temp==NULL){
        level++;
    }
    if(mp.find(level)!=mp.end()){
        mp[level] = root->data+mp[level];
    }
    else{
         mp[level] = root->data+mp[level];
    }
    return vsumprint(root->right,++level,mp);
 }
void printVertical(Node *root)
{
    map<int,int> mp;
    vsumprint(root,0,mp);
    for(auto it:mp){
        cout<<it.second<<" ";
    }

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-08-20T16:29:02.760

//测试和工作示例

```
package tree;

    import java.util.TreeMap;

    public class VerticalSumProblem 
    {

        public static void main(String[] args) 
        {
            VerticalSumProblem verticalSum = new VerticalSumProblem();
            TreeNode treeNode = verticalSum.new TreeNode(1);

            treeNode.left = verticalSum.new TreeNode(2);
            treeNode.right = verticalSum.new TreeNode(3);

            treeNode.left.left = verticalSum.new TreeNode(4);
            treeNode.left.right = verticalSum.new TreeNode(5);

            treeNode.right.left = verticalSum.new TreeNode(6);
            treeNode.right.right = verticalSum.new TreeNode(7);

            //treeNode.right.right.left =verticalSum.new TreeNode(8);

            verticalSum.printTree(treeNode);
            verticalSum.findVerticalSum(treeNode);
        }

        private void findVerticalSum(TreeNode root)
        {
            if(root == null) return;

            TreeMap<Integer,Integer> _mappings = new TreeMap<Integer,Integer>();
            findVerticalSum(root,_mappings,0);

            if (_mappings != null) 
            {
                System.out.println(_mappings.entrySet());
            }
        }

        //if goes left --  and if goes right ++
        private void findVerticalSum(TreeNode treeNode,TreeMap<Integer,Integer> mappings, int level)
        {
            if(treeNode == null) return;

            TreeNode treeNodeLeft,treeNodeRight;

            if(treeNode.left != null)
            {
                treeNodeLeft =  treeNode.left;
                findVerticalSum(treeNodeLeft, mappings,level - 1);
            }

            int sum = mappings.get(level) == null ? 0 : mappings.get(level); 
            mappings.put(level, treeNode.data + sum);

            if( treeNode.right != null)
            {
                treeNodeRight =  treeNode.right;
                findVerticalSum(treeNodeRight,mappings, level + 1);
            }
        }

    /* Create following Binary Tree
         1
       /   \
      2      3
     / \    / \
    4   5, 6    7

    */

        private void printTree(TreeNode treeNode)
        {
            TreeNode treeNodeLeft,treeNodeRight;

            if(treeNode == null) return;

            if(treeNode.left != null || treeNode.right != null)
            {
                treeNodeLeft =  treeNode.left;
                treeNodeRight =  treeNode.right;

                System.out.println("rootValue ="+treeNode.data);

                System.out.println("Left child of ="+treeNode.data +" is : "+ getNodedata(treeNodeLeft));   
                System.out.println("Right child of ="+treeNode.data+" is : "+ getNodedata(treeNodeRight)+"\n");

                printTree(treeNodeLeft);
                printTree(treeNodeRight);
            }
        }

        private int getNodedata(TreeNode treeNode)
        {
            if(treeNode != null)
            {
               return treeNode.data;    
            }
            return -1;
        }

        private class TreeNode
        {
            private int data;
            private TreeNode left,right;

            TreeNode(int data)
            {
                this.data = data;
                left = null;
                right = null;
            }
        }

    }

    //vertical sum
    ///   |   |    |   |    | 
    //    |   |    1   |    | 
    ///   |   2    |   3    | 
    //    4   |   5,6  |    7

    //             0 
    //         1        -1
    //     2      0,0        -2
    // 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-03-13T06:55:58.013

对不起，迟到的解决方案。有几种方法可以解决这个问题。Itay Karo 已经给出了一个很好的使用 hashmap 的解决方案。您还可以使用双向链接列表：

*   从根节点开始，空双列表listNode
*   将 rootNode 的值添加到当前 listNode
*   现在，无论何时向左，传递 listNode.left 和 root.left 并递归调用 step1 和 2。
*   同样对于右节点，通过 listNode.right 和 root.right 下面是代码：

```
`printVerticalSum(TreeNode root)
{
   if(root==null)
       return -1;
    allocate node doubleLinkList //initialize,
    printVerticalSumUtil(root, doubleLinkList); 
    //write the function to print double linked list
    System.out.println(doubleLinkList.toString())
}

printVerticalSumUtil(TreeNode root, ListNode listNode)
{
  if(root==NULL) return;

if(root.left!=NULL)
    if(listNode.prev!=NULL)
      listNode.prev.data += root.data;
    else
      ListNode t = new ListNode(root.data);
      t.next=listNode; 
      listNode.prev = t;
    findVerticalSum(root.left, listNode.prev)

if(root.right!=NULL)
    if(listNode.next!=NULL)
      listNode.next.data += root.data;
    else
      ListNode t = new ListNode(root.data);
      t.prev=listNode; 
      listNode.next = t;
    findVerticalSum(root.right, listNode.next)
}` 
```

`更多细节在这里 - [http://k2code.blogspot.in/2011/12/vertical-sum-of-binary-tree.html](http://k2code.blogspot.in/2011/12/vertical-sum-of-binary-tree.html)。谢谢。`

# java - 我想创建一个利用并创建较小的子项目（库）的 Java 项目，Apache Ant 是否适合用于此目的的软件？

> ID：14485260
> 
> 赞同：1
> 
> 时间：2013-01-23T17:03:43.653
> 
> 标签：java, ant

假设我要用 Java 编写服务器，术语服务器首先用于解决许多子系统，这些子系统也在一个通用*服务器*下提供服务（多个实际服务器） 。

所以当我启动主服务器时，它会遍历并找到所有注册的子服务器，并将它们作为套件的一部分启动。

这意味着我需要能够在 Eclipse 中编写多个项目并将它们相互链接，以便项目 B 可以使用项目 A（反之亦然），就像我要将 jar/库导入我的构建路径一样。但问题是，如果没有多个项目，我不知道如何做到这一点，然后每次我进行更改时手动重建 jar 并让其他项目包含它。

Apache Ant 或一些类似的软件是我想要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:05:39.917

您需要一个支持依赖管理的项目管理工具。您可以使用`ant`,`maven`或`gradle`等。虽然我不会发起 ant 与 maven 的战争，`maven`但它不仅仅是一个构建工具，它可能会在未来对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:07:57.903

其他人使用 Maven，我使用 ANT，这就像宗教一样……没有一个比其他更好，各有利弊，并且做出决定是主观的。直到我的决定是，我使用 ANT，直到我的经理或我的客户大多需要 Maven。

对于小型子项目，Ant 是完美的，我会推荐 Maven 用于更大的子项目。

# ruby - 在 gem 安装 id3lib-ruby 期间缺少 libstdc++

> ID：14485266
> 
> 赞同：2
> 
> 时间：2013-01-23T17:04:11.903
> 
> 标签：ruby, rubygems, id3lib, mkmf

我正在尝试安装 id3lib-ruby，但出现此错误：

```
Building native extensions.  This could take a while...
ERROR:  Error installing id3lib-ruby:
    ERROR: Failed to build gem native extension.

        /home/rfischer/.rvm/rubies/ree-1.8.7-2012.02/bin/ruby extconf.rb
checking for main() in -lstdc++... no
You must have libstdc++ installed.
*** extconf.rb failed *** 
```

我已经安装了各种 libstdc++：

```
$ apt-cache search libstdc | grep dev
lib32gmp-dev - Multiprecision arithmetic library developers tools (32bit)
libgmp-dev - Multiprecision arithmetic library developers tools
libstdc++6-4.4-dev - GNU Standard C++ Library v3 (development files)
libstdc++6-4.6-dev - GNU Standard C++ Library v3 (development files)
libstdc++6-4.7-dev - GNU Standard C++ Library v3 (development files)
libstdc++6-4.5-dev - GNU Standard C++ Library v3 (development files)
libstdc++6-4.6-dev-armel-cross - GNU Standard C++ Library v3 (development files)
libstdc++6-4.6-dev-armhf-cross - GNU Standard C++ Library v3 (development files)
libstdc++6-4.7-dev-armel-cross - GNU Standard C++ Library v3 (development files)
libstdc++6-4.7-dev-armhf-cross - GNU Standard C++ Library v3 (development files) 
```

这是 mkmf.log：

```
have_library: checking for main() in -lstdc++... -------------------- no

"/usr/bin/gcc-4.6 -o conftest -I/opt/local/include -I. -I/home/rfischer/.rvm/rubies/ree-1.8.7-2012.02/lib/ruby/1.8/x86_64-linux -I. -I/usr/local/include -I/opt/local/include -I/sw/include    -g -O2    conftest.c  -L. -L/home/rfischer/.rvm/rubies/ree-1.8.7-2012.02/lib -Wl,-R/home/rfischer/.rvm/rubies/ree-1.8.7-2012.02/lib -L/usr/local/lib -Wl,-R/usr/local/lib -L/opt/local/lib -Wl,-R/opt/local/lib -L/sw/lib -Wl,-R/sw/lib -L.  -rdynamic -Wl,-export-dynamic     -lruby-static -lstdc++  -L/opt/local/lib -lrt -ldl -lcrypt -lm   -lc"
/usr/bin/ld: cannot find -lstdc++
collect2: ld returned 1 exit status
checked program was:
/* begin */
1: /*top*/
2: int main() { return 0; }
3: int t() { void ((*volatile p)()); p = (void ((*)()))main; return 0; }
/* end */

"/usr/bin/gcc-4.6 -o conftest -I/opt/local/include -I. -I/home/rfischer/.rvm/rubies/ree-1.8.7-2012.02/lib/ruby/1.8/x86_64-linux -I. -I/usr/local/include -I/opt/local/include -I/sw/include    -g -O2    conftest.c  -L. -L/home/rfischer/.rvm/rubies/ree-1.8.7-2012.02/lib -Wl,-R/home/rfischer/.rvm/rubies/ree-1.8.7-2012.02/lib -L/usr/local/lib -Wl,-R/usr/local/lib -L/opt/local/lib -Wl,-R/opt/local/lib -L/sw/lib -Wl,-R/sw/lib -L.  -rdynamic -Wl,-export-dynamic     -lruby-static -lstdc++  -L/opt/local/lib -lrt -ldl -lcrypt -lm   -lc"
/usr/bin/ld: cannot find -lstdc++
collect2: ld returned 1 exit status
checked program was:
/* begin */
1: /*top*/
2: int main() { return 0; }
3: int t() { main(); return 0; }
/* end */

-------------------- 
```

关于我做错了什么或如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-02T10:19:09.127

您可能同时解决了您的问题，但是由于我[最近遇到了类似的问题并在这里得到了帮助](https://stackoverflow.com/questions/16870211/missing-libstdc-when-installing-taglib-ruby-gem-on-ubuntu-12-04#comment24336154_16870211)，我想我可能会分享`apt-get install build-essential`解决了我丢失的 libstdc++ 错误的问题。

# c# - 循环浏览图像文件夹并一张一张显示图像

> ID：14485270
> 
> 赞同：-3
> 
> 时间：2013-01-23T17:04:16.843
> 
> 标签：c#, wpf

我是 c# 和 WPF 的新手，并试图构建一个循环遍历文件夹并一一显示内部图像的应用程序。当显示最后一个时，它需要再次显示第一个。

我尝试将所有文​​件命名为 1.jpg 、 2.jpg 等，然后循环浏览图片数量。但是，如果我删除一个，则会出现错误。

有没有更好的方法来完成这个？

我正在使用 C# 和一个 WPF 窗口，其中有一个网格内的图像。

任何帮助将不胜感激！

编辑：当前代码

```
private string[] files;
    private System.Timers.Timer timer;

    private int counter;
    private int Imagecounter;

    public IntroScreen()
    {
        InitializeComponent();
        this.Loaded += new RoutedEventHandler(this.MainWindow_Loaded);
    }

    private void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {

        setupPics();
    }

    private void setupPics() 
    {
        timer = new System.Timers.Timer();
        timer.Elapsed += new ElapsedEventHandler(timer_Tick);
        timer.Interval = (2000);
        timer.Enabled = true;
        timer.Start();

        files = Directory.GetFiles("../../Resources/Taken/", "*.jpg", SearchOption.TopDirectoryOnly);
        Imagecounter = files.Length;
        counter = 0;
    }

    private void timer_Tick(object sender, EventArgs e)
    {
        counter++;

       Dispatcher.BeginInvoke(DispatcherPriority.Input, new ThreadStart(() =>
            {
                Picture.Source = new BitmapImage(new Uri(files[counter - 1], UriKind.Relative));
            }));

       if (counter == Imagecounter)
       {
           counter = 0;
       }

    } 
```

这不起作用，它会在文件夹中找到项目，但图像不会改变。

它不会返回错误，图像只是不显示。

有人有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:51:27.330

以下使用 RX 对我有用。

Xaml

```
<Image Grid.Row="1" Source="{Binding AppViewModel.MainImageSource}"  Width="400" Stretch="Uniform"  Margin="{StaticResource MarginNormalControl}" /> 
```

查看型号：

```
SlideshowImages = ( from path in Directory.EnumerateFiles( pathSlideshow )
                    select new Uri( path ) ).ToList();
if ( SlideshowImages.Any() )
{ 
    SlideshowIndex = 0;
    var timer = Observable.Interval( TimeSpan.FromSeconds( 2 ) ).TimeInterval();
    timer.Subscribe( _ =>
                 {
                     ++SlideshowIndex;
                     if ( SlideshowIndex >= SlideshowImages.Count() )
                         SlideshowIndex = 0;
                     MainImageSource = SlideshowImages[SlideshowIndex];
                 } );
} 
```

# html - 有没有一种简单的方法可以在 Dreamweaver 中找到损坏的 HTML 代码？

> ID：14485271
> 
> 赞同：4
> 
> 时间：2013-01-23T17:04:31.357
> 
> 标签：html, dreamweaver

有没有一种简单的方法可以在 Dreamweaver 中找到损坏的 HTML 代码？

我有一个问题，我一直在失去计数。有一个 Dreamweaver 技巧吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T17:26:13.993

尝试在靠近编码/设计窗口的左侧工具栏的中间位置打开“突出显示无效代码”和“信息栏中的语法错误警报”。

突出显示无效代码将以黄色显示所有未关闭的 HTML 标记，语法错误警报将通知您脚本存在问题，尽管它不会告诉您确切的位置。

编辑：语法错误警报通过显示哪一行有问题确实给出了一个小的指示，但它通常只是表明脚本的最后一行有问题，通常是由于函数没有被适当地关闭在更远的地方。

# mysql - 并发丢弃没有锁的mysql事务

> ID：14485277
> 
> 赞同：2
> 
> 时间：2013-01-23T17:04:41.340
> 
> 标签：mysql, transactions, locking

我目前正在尝试改进我们应用程序的测试行为。

测试当前在嵌套事务中启动，其中测试套件启动实际事务，并且每个测试用例都创建嵌套保存点。

当一个测试用例完成时，保存点被简单地释放并恢复原始数据。套件完成后，事务将回滚。

（在表上使用截断对我们来说不是一个选项，因为种子数据太大而且它会阻止中央和并发测试）

这工作正常。

当事务并发运行时，事务倾向于将彼此锁定在表之外。这种情况在具有唯一键的表上更是如此（两个事务之一的每个测试都失败）。

我尝试使用事务状态“READ COMMITTED”、“READ UNCOMMITED”和默认的“REPEATABLE READ”来执行此操作。

READ UNCOMMITTED 导致重复的关键问题。READ COMMITTED 有锁/死锁问题 REPEATABLE READ 有锁/死锁问题（同上）

此外，我尝试应用以下选项：innodb_autoinc_lock_mode=2

```
> -- mysql command line
> SET SESSION binlog_format=ROW
> SET SESSION innodb_table_locks=OFF 
```

最后一个参数解决了一些锁定问题。“锁定等待超时”和死锁问题仍然存在。

是否有解决方案使单独的交易真正相互独立？

更新：进一步的测试表明：死锁目前只发生在具有唯一键的表上。我认为会话 1 已经使用了这些键，所以我可能是行锁定的受害者。

mysql服务器版本：5.5.15

编辑：添加工作流示例，以便更清楚地说明问题（可能包含拼写错误和轻微的语法错误。这些不是重点）。不同的连接 不同的意图

```
> create table foo (
>   `id` int(11) auto increment,
>   `name` varchar(255),
>   PRIMARY KEY id,
>   UNIQUE KEY `name`(`name`)
> ) ENGINE=InnoDb;
> insert into foo(name) values ('bar');

> begin;                                       -- connection 1, transaction 1
>   begin;                                     -- connection 2, transaction 1
> savepoint t_1;                               -- connection 1, savepoint within transaction 1
>   savepoint t_1;                             -- connection 2, savepoint within transaction 1
> select count(*) from foo;                    -- connection 1, number of entries in foo, should be 1
> insert into foo('name') values ('meh');      -- connection 1, insert into foo the unique fixed value 'meh', should work
>   select count(*) from foo;                  -- connection 2, number of entries in foo, should be 1
>   insert into foo('name') values ('meh');    -- connection 2, insert into foo the unique fixed value 'meh', should work
> select count(*) from foo;                    -- connection 1, number of entries in foo, should be 2
>   select count(*) from foo;                  -- connection 2, number of entries in foo, should be 2
> rollback to savepoint t_1;                       -- connection 1, discard everything up until savepoint t_1
> rollback;                                    -- connection 1, rollback
>   rollback to savepoint t_1;                     -- connection 2, discard everything up until savepoint t_1
>   rollback;                                  -- connection 2, rollback 
```

在这个例子中，所有*应该被*认为是我想要的事务隔离的测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T00:14:20.430

听起来您正试图同时运行测试，这就是为什么会有并发查询。如果是这种情况，那么我认为您是 100% 正确的，因为您只是遇到了锁。

如果有一个打开的事务（即长时间运行的测试），其预期目的是在测试结束时回滚，那么在这些相同的行/表上进行任何其他写入和可能的一些读取都会遇到很多麻烦其他测试的一部分。您最好的选择是可能只是按顺序运行所有内容。

您遇到的重复键问题与我在使用 READ UNCOMMITTED 时所期望的一致。

# c# - 比较两个不同 LINQ 语句的效率

> ID：14485279
> 
> 赞同：5
> 
> 时间：2013-01-23T17:04:44.383
> 
> 标签：c#, linq

我正在学习 C#（C++ 背景），我有一个关于 LINQ 表达式的问题。以下两个函数都做同样的事情（据我所知）。袋熊的种类是`System.Data.Linq.Table<Wombat>`。

我有兴趣知道

1.  哪个更有效率？
2.  这还重要吗？
3.  相反，返回 IQueryqble 有什么好处吗？
4.  这里有一些礼节偏爱三者之一吗？

我的猜测是第二种效率更高，但除非袋熊表中有数百万只袋熊，否则它并不重要。并且返回一个 IQueryable 似乎并不重要，因为我们只返回一个袋熊。

提前致谢！

```
 public static DBConnector.Connections.Wombat getWombat(String wombatID)
    {
        var db = getDBInstance();
        return db.Wombats.FirstOrDefault(x => x.ID.ToString() == wombatID);
    }

    public static DBConnector.Connections.Wombat getWombat(String wombatID)
    {
        var db = getDBInstance();
        var guid = new System.Guid(wombatID);
        return db.Wombats.FirstOrDefault(x => x.ID == guid);
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T17:10:20.890

这将完全取决于 DB 的 LINQ 提供程序，以及它如何将其转换为 SQL。您可以[分析生成的 SQL](http://msdn.microsoft.com/en-us/magazine/gg490349.aspx)（甚至只是[检查 SQL 跟踪](https://stackoverflow.com/a/143042/65358)）并确定哪个更有效。

我怀疑大多数提供商使用第二个选项会做得更好，因为实际检查将是相同的类型 - 服务器上的查询不需要将每一行转换为字符串，并通过字符串比较进行比较。这可能会使索引正常工作，并使其效率更高。话虽如此，聪明的提供者可以为您进行这种转换，在这种情况下，这两个选项可能是相同的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-23T17:08:37.840

您的猜测是正确的，第二个查询可能更有效，因为它会解析一次 GUID，而不是将每行中的 GUID 转换为字符串。查询提供者可能会对此进行优化，但不是必须的；您的查询提供程序也可能会选择将 GUID 转换为字符串以进行比较，但这将是一个相当不幸的选择。

您还正确地假设除非表中有大量`Wombat`对象，否则这无关紧要。

支持第二个查询有一个显着差异：`ToString`查询提供程序可能无法识别该方法，因此由于运行时错误，您的第一个查询甚至不会执行。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-23T17:10:27.080

1.  查看每种情况下生成的 sql。
2.  检查sql studio中每个查询的执行时间、查询计划和IO。
3.  ？？？
4.  利润。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T17:08:17.807

如果您返回 IQuerable，您可能会延迟评估，允许其他人先更新该值。

# c++ - cmd内存使用

> ID：14485283
> 
> 赞同：2
> 
> 时间：2013-01-23T17:04:59.387
> 
> 标签：c++, c, cmd

我有一个项目是关于使用 windows cmd 制作一个简单的分级机。
`a.exe < input.txt>output.txt`.
无论如何我可以确定内存使用情况和时间流逝吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2021-12-23T15:33:55.083

对于内存：

```
tasklist /fi "memusage gt 30000" | findstr "yourapp.exe yourapp2.exe*" | SORT >> memory_log.txt 
```

对于时间：

```
echo powershell -Command Measure-Command {cmd /c '%thecmd%'} ^| FINDSTR /L /C:"Seconds           :" /L /C:"Minutes           :" > %temp%\timeexec.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:35:22.887

有一个 powershell [Measure-Command cmdlet](http://technet.microsoft.com/en-us/library/ee176899.aspx)，它会给你时间。我不知道它是否会进行重定向，但是如果您将命令放入批处理文件中，您可以运行如下内容：

```
start-process file-to-measure.bat -Wait 
```

看看这个问题：[Tracking CPU and Memory usage per process](https://stackoverflow.com/questions/69332/tracking-cpu-and-memory-usage-per-process)它看起来像一个 WMI 脚本可能会做你想要的。

# c++ - 从 Turbo C++（旧）切换到更新的类似编译器

> ID：14485289
> 
> 赞同：3
> 
> 时间：2013-01-23T17:05:07.733
> 
> 标签：c++, ide

我已经使用 Turbo C++ 1 年了，事情是......我知道它已经非常老了，但现在我已经习惯了它的语法。你能推荐一个（更好的）IDE，它不会显示任何与 turbo C++ 的错误代码？我已经尝试过可视化 C++ 和代码块，甚至尝试过（非常疯狂地）一个 eclipse CDK 包。但是，它们都向普通程序显示错误，例如： `#include<iostream.h> void main() {cout<<"hello";}`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T17:27:26.263

Turbo C++ 如此陈旧的问题在于它比现代编译器更不符合标准。很久以前，C++ 编译器都千差万别。支持不同的特性、不同的语法，并且在他们的 C++ 实现中有严重的错误。那时编写可移植的 C++ 很困难。在过去的 15 年里，随着编译器的成熟以及在实现通用 C++ 标准方面越来越好，情况有了很大的改善。

因此，现代编译器的主要好处可能是它们更加符合要求。他们*不*支持 Turbo C++ 支持的相同错误的 C++ 方言。

与其要求现代 C++ 编译器不具备现代编译器所需要的主要功能，不如简单地找出 Turbo C++ 方言中不正确的区域。无论如何，这可能是一个很好的练习；C++ 程序员从他们的编译器中学到了相当多的 C++，所以当编译器出错时，他们会学到错误的东西。使用不同的编译器有助于找出此类误解并提高对 C++ 的了解。进行调整应该不会太难。

因此，就 C++ 的权威 ISO 规范而言，您发布的简单程序存在以下问题：标准 C++ 标头上没有“.h”后缀，因此`#include <iostream.h>`您必须使用.h 来代替`#include <iostream>`。这些标准头文件将东西放在命名空间中，所以为了访问`cout`你必须在`std`命名空间内访问它：而不是`cout<<"hello";`你应该写`std::cout << "Hello\n";`. finally`main`需要 return`int`而不是`void`，因此您的整个程序可能如下所示：

```
#include<iostream>

int main() {
    std::cout << "Hello\n";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:20:27.190

你是否习惯了这种语法并不重要。如果要编写 C++ 代码，则必须使用 C++ 语法。就像在德国你不能因为习惯了英国的左侧而突然在左侧行驶一样。如果你想在德国开车，你必须遵守规则。如果你不这样做，你会崩溃。

使用现代 C++ 编译器意味着您必须编写符合标准的 C++ 代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T17:19:52.837

这实际上不是一个普通的 C++ 程序。

`main` *总是*返回`int`并且`<iostream.h>`多年来一直在技术上不可用（支持`<iostream>`，尽管许多编译器支持一段时间）。

我不会试图找到一个接受现有代码的 GUI，而是尝试买一本书并学习/复习更新的 C++（至少 C++03），然后使用现代编译器（g++ 或免费的 Visual Studio 编译器） ) 来构建您的标准代码。

# java - Java EE api邮件发送邮件错误

> ID：14485291
> 
> 赞同：0
> 
> 时间：2013-01-23T17:05:27.713
> 
> 标签：java, jakarta-ee, smtp, jakarta-mail, sendmail

我做了一个 CLASSPATH 环境变量绑定 jaf 和 javamail ：

用户变量名（windows）：CLASSPATH

此变量的值：设置 CLASSPATH=%CLASSPATH%;C:\Java EE\Java SMTP\javamail-1.4.5\mail.jar;C:\Java EE\Java SMTP\jaf-1.1.1\activation.jar

我还将这 2 个 .jar 文件放入我的 WebContent 目录（放入我的 Java Web 应用程序）并将其添加到我的构建路径中。

我正在使用 Tomcat Apache Server 7.0.33。

这是我的小服务程序：

```
 @WebServlet (urlPatterns="/register")
    public class RegisterServlet extends HttpServlet {
        private static final long serialVersionUID = 1L;

        private void sendMailRegistration(String email, int code)
                throws ServletException, IOException{
            Properties props = new Properties();
            Session session = Session.getDefaultInstance(props, null);

            String msgBody = "Here is the code you have to put for confirmation: "+Integer.toString(code);

            try {
                Message msg = new MimeMessage(session);
                msg.setFrom(new InternetAddress("dd@supinfo.com", "Admin SupLink"));
                msg.addRecipient(Message.RecipientType.TO,
                                 new InternetAddress(email, "User"));
                msg.setSubject("[SupLink] Activation");
                msg.setText(msgBody);
                Transport.send(msg);

            } catch (AddressException e) {
                e.printStackTrace();
            } catch (MessagingException e) {
               e.printStackTrace();
            }
        }

        @Override
        protected void doPost(HttpServletRequest request, HttpServletResponse response)
                throws ServletException, IOException {
            String emailRegister = request.getParameter("emailRegister");
            int code = 1223;
                sendMailRegistration(emailRegister, code);

    }
} 
```

这是我的错误堆栈跟踪：

```
 javax.mail.MessagingException: Could not connect to SMTP host: localhost, port: 25;
  nested exception is:
    java.net.ConnectException: Connection refused: connect
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1972)
    at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:642)
    at javax.mail.Service.connect(Service.java:295)
    at javax.mail.Service.connect(Service.java:176)
    at javax.mail.Service.connect(Service.java:125)
    at javax.mail.Transport.send0(Transport.java:194)
    at javax.mail.Transport.send(Transport.java:124)
    at com.supinfo.miniprojet.servlets.RegisterServlet.sendMailRegistration(RegisterServlet.java:43)
    at com.supinfo.miniprojet.servlets.RegisterServlet.doPost(RegisterServlet.java:81)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:728)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:931)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.net.ConnectException: Connection refused: connect
    at java.net.DualStackPlainSocketImpl.connect0(Native Method)
    at java.net.DualStackPlainSocketImpl.socketConnect(Unknown Source)
    at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)
    at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)
    at java.net.AbstractPlainSocketImpl.connect(Unknown Source)
    at java.net.PlainSocketImpl.connect(Unknown Source)
    at java.net.SocksSocketImpl.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at com.sun.mail.util.SocketFetcher.createSocket(SocketFetcher.java:319)
    at com.sun.mail.util.SocketFetcher.getSocket(SocketFetcher.java:233)
    at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1938)
    ... 26 more 
```

有人知道我的源邮件地址是否有问题：dd@supinfo.com 或我的 CLASSPATH，因为我只是在这里[Google java mail](https://developers.google.com/appengine/docs/java/mail/usingjavamail?hl=fr)拿了 Google 实现示例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:30:41.363

您需要确定要使用的邮件服务器（因为您显然没有在本地主机上运行）。一旦确定，您需要配置 Java Mail 以使用它。您可以参考以下代码作为使用 Google Mail 服务器的示例：

```
public static void main(String[] args) {

    final String username = "username@gmail.com";
    final String password = "password";

    Properties props = new Properties();
    props.put("mail.smtp.auth", "true");
    props.put("mail.smtp.starttls.enable", "true");
    props.put("mail.smtp.host", "smtp.gmail.com");
    props.put("mail.smtp.port", "587");

    Session session = Session.getInstance(props,
            new javax.mail.Authenticator() {
                protected PasswordAuthentication getPasswordAuthentication() {
                    return new PasswordAuthentication(username, password);
                }
            });

    try {

        Message message = new MimeMessage(session);
        message.setFrom(new InternetAddress("from-email@gmail.com"));
        message.setRecipients(Message.RecipientType.TO,
                InternetAddress.parse("to-email@gmail.com"));
        message.setSubject("Testing Subject");
        message.setText("Dear Mail Crawler,"
                + "\n\n No spam to my email, please!");

        Transport.send(message);

        System.out.println("Done");

    } catch (MessagingException e) {
        throw new RuntimeException(e);
    }
} 
```

注意：这不是我的代码，你可以在[这里参考完整的例子](http://www.mkyong.com/java/javamail-api-sending-email-via-gmail-smtp-example/)

# php - codeigniter - 将图像、css、js、视频（网络资源）加载到您的 html 中

> ID：14485293
> 
> 赞同：0
> 
> 时间：2013-01-23T17:05:28.357
> 
> 标签：php, .htaccess, codeigniter

我正在我的第一个 CodeIgniter 项目中工作......

在构建了我的大部分 PHP 并开始使用几乎完成的脚本后，我意识到所有对`application/views/`文件夹的访问都被`.htaccess`.

当我想访问特定于页面的 JavaScript、图像或任何网络资源文件夹时，这对我的文件结构来说是一个大问题。因为我所有的人都`views template`假设该文件是在本地使用的（也就是说`Page_name/images/cutedog.jpg`，在我的代码中更准确地说`<img src="{images}cutedog.jpg">`）。

我找到的解决方案是修改 .htacces 以便它过滤掉所有媒体文件并允许访问我的应用程序文件夹。但是通过这样做，我会揭示我宁愿避免的文件结构。

我知道我可以将我的网络资源放在我的应用程序文件夹之外，这样就可以解决问题。但是出于可维护性的目的，我认为现在拥有一切会更合乎逻辑。

所以我的问题如下......你会建议什么解决方法： - 我可以维护我的网络资源 `application/views/issue/WEB_PAGE/Web-resource-folder` - 隐藏我的文件结构 - 可以访问网络资源

我的 .htaccess

```
Deny from all
<FilesMatch "\.(css|js|jpg|pdf|avi|mpg|robots\.txt|png|pdf|favicon\.ico)$">
    Order allow,deny
    Allow from all
</FilesMatch> 
```

我的文件结构：

```
-+ /application/
 |
 |-+ /Typical CI folders/        
 |-+ /view/
   |-+ /issue/
     |-+ /1/
       |-+ /page1/
         |-+ /img/
         |-+ /js/
         |-+ /video/
       |-+ /page2/
         |-+ /img/
         |-+ /js/
         |-+ /video/ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:13:40.740

您将需要为将告诉 .htaccess 的内容编写复杂的重写规则，例如：

```
if url is blah/bloh/blih/WEB_PAGE/images/cutedog.jpg 
then fetch application/views/issue/WEB_PAGE/img/cutedlog.jpg 
```

如果您问我，随着您创建更多资源，这将变得越来越麻烦。就像您建议的那样，您应该将 Web 资源放在应用程序文件夹之外。

我的 CI 结构总是如下所示：

```
/application
/resources
   /page1
      /img
      /js
      /video
   /page2
      /img
      /js
      /video 
```

# jquery - html 滚动顶部之谜

> ID：14485297
> 
> 赞同：0
> 
> 时间：2013-01-23T17:05:43.520
> 
> 标签：jquery, html, scroll, scrolltop

我正在构建一个网络编辑器。当大元素被添加到编辑器时，页面看起来会向下滚动，导致顶部的菜单滚动到视图之外。作为测试，我在整个文档上运行下面的函数 - 但除了零之外没有一个滚动顶部（除非我故意增加一些容器的内容来测试）。请注意，body 和 html 标签的高度设置为 100%。

相关：[$(document).scrollTop() 总是返回 0](https://stackoverflow.com/questions/12788487/document-scrolltop-always-returns-0)

```
 ScrollCheck : function (contextSelector){
    var scrollTop = 0;
    $(contextSelector).find('*').each(function () {
        scrollTop = $(this).scrollTop();
       // scrollTop = $(this).offset().top;

       if (scrollTop != 0) {
            console.log(scrollTop, $(this));
        }
    });

} 
```

# asp.net - 更高级的 .NET HTML 编码

> ID：14485301
> 
> 赞同：0
> 
> 时间：2013-01-23T17:05:50.123
> 
> 标签：asp.net, html-email, mailmessage

我正在寻找一个比 .NET 的 HtmlEncode 方法更彻底的 HTML 编码器。该方法将处理 <> 但不是长破折号，这给我带来了问题。是否有将所有特殊字符编码为 HTML 的 .NET 库？

这在哪里：

> 北卡罗来纳州夏洛特（美联社）- 共和党全国委员会正在北卡罗来纳州举行冬季会议，四个月前，民主党人在该市重新提名巴拉克·奥巴马 (Barack Obama) 为总统。

会翻译成：

> 北卡罗来纳州夏洛特 (AP) &mdash ; 共和党全国委员会正在北卡罗来纳州举行冬季会议，四个月前，民主党人在该市重新提名巴拉克·奥巴马 (Barack Obama) 为总统。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T02:25:06.817

我最终使用了我在网上某处找到的一个穷人的 HTML 编码器。这使用 .NET 的 HtmlEncode 函数，然后获取所有“高 ASCII”字符并将它们转换为 HTML 等效的 000;。马虎但有效。

```
 public static string HtmlEncode(this string input)
    {
        char[] chars = HttpUtility.HtmlEncode(input).ToCharArray();
        StringBuilder result = new StringBuilder(input.Length + (int)(input.Length * 0.1));

        foreach (char c in chars)
        {
            int value = Convert.ToInt32(c);
            if (value > 127)
                result.AppendFormat("&#{0};", value);
            else
                result.Append(c);
        }

        return result.ToString();
    } 
```

# javascript - 从 Jquery 方法中的函数获取元素

> ID：14485304
> 
> 赞同：1
> 
> 时间：2013-01-23T17:05:58.250
> 
> 标签：javascript, jquery

我制作了一个 jquery 函数，该函数需要在元素的单击上运行用户函数。问题是我需要访问我正在调用该函数的元素。我将如何实现这一目标。该函数的一个示例是

```
 $("#domelement").yesNoDialog({
                 title:"Ineligible to Register",
                 message:"Stackoverflowtest",
                 yesFunction:function(){        
                     location.href = "www.stackoverflow.com"

                     //How do i grab an attribute from #domelement in here? ie $("domeElement").attr("stuff");

                 }
             }); 
```

Jquery Method的简化版如下

```
(function($) {       
  $.fn.yesNoDialog = function(options) {     
    options = $.extend({}, $.fn.yesNoDialog.defaultOptions, options);      
    this.each(function() {
      $(this).click(function(){
          options.yesFunction();
       });
    });     
    return this;
  };
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T19:19:52.870

您可以将元素传递给函数并以这种方式使用它

```
 $("#domelement").yesNoDialog({
                 title:"Ineligible to Register",
                 message:"Stackoverflowtest",
                 yesFunction:function(element){     
                     location.href = "www.stackoverflow.com"

                     //How do i grab an attribute from #domelement in here? ie $("domeElement").attr("stuff");

                 }
             }); 
```

将元素传递给函数

```
(function($) {       
  $.fn.yesNoDialog = function(options) {     
    options = $.extend({}, $.fn.yesNoDialog.defaultOptions, options);      
    this.each(function() {
      var that = this;
      $(this).click(function(){
          options.yesFunction(that); <--- Lets you use the element 
       });
    });     
    return this;
  };
})(jQuery); 
```

# extjs4 - 在 EXT JS 4 中获取字段容器的子项

> ID：14485306
> 
> 赞同：1
> 
> 时间：2013-01-23T17:06:09.930
> 
> 标签：extjs4

我有一个简单的问题，尽管它让我很头疼。

我有一个字段容器，其中添加了一些无线电字段：

```
xtype      : 'fieldcontainer',
                            fieldLabel : 'Field type',
                            defaultType: 'radiofield',
                            defaults: {
                                flex: 1
                            },
                            items: [
                                {
                                    boxLabel  : 'Plain Text',
                                    name      : 'plain-text',
                                    inputValue: 'plain-text',
                                    id        : 'plain-text'
                                }, {
                                    boxLabel  : 'Rich Text',
                                    name      : 'html-text',
                                    inputValue: 'html-text',
                                    id        : 'html-text'
                                }, {
                                    boxLabel  : 'Time',
                                    name      : 'time',
                                    inputValue: 'time',
                                    id        : 'time'
                                },
                                {
                                    boxLabel  : 'Typed reference',
                                    name      : 'typed-reference',
                                    inputValue: 'typed-reference',
                                    id        : 'typed-reference'
                                },
                                {
                                    boxLabel  : 'Date',
                                    name      : 'date',
                                    inputValue: 'date',
                                    id        : 'date'
                                }

                            ],

                            listeners: {
                                added: function(radiofield) {
                                    ??

                                } 
```

我尝试了几乎所有检查 radiofield 对象的方法，比如迭代它的 items.items 数组以添加项目，但是，我只得到项目的整数值，而不是对象本身。我想迭代添加到容器中的所有项目，以在满足特定条件的单选字段上设置选中值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T09:27:59.290

你有什么理由不使用 RadionGroup 吗？反正; 项目属于 Ext.util.MixedColletion 类型，它为您提供了每个方法[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.util.AbstractMixedCollection-method-each](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.util.AbstractMixedCollection-method-each)

尝试以下

```
// define a function within the scope of the fieldcontainer(instance)
handlerFunction: functio(item) {
    // item is the instance of your radiofield
    // you can access any property or call any method
    if (item.name === 'html-text') {
         item.setValue('html-text');
    }
}

fieldcontainerInstance.items.each(handlerFunction,handlerFunctionScope); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:10:37.907

利用[`query([selector])`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.container.AbstractContainer-method-query)

> 检索与传递的选择器匹配的所有后代组件。使用此容器作为其根执行 Ext.ComponentQuery.query。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-30T09:51:01.547

只需键入 item.query() 即可获取它拥有的所有项目。

# actionscript-3 - 使用命令模式切换帧

> ID：14485307
> 
> 赞同：0
> 
> 时间：2013-01-23T17:06:10.950
> 
> 标签：actionscript-3, flash, null, frame, command-pattern

我正在尝试为我的 Flash 游戏创建介绍动画，但是当它应该转到动画的第二帧时出现问题。

这是菜单中的开始游戏按钮应该执行的代码（位于文档类中）：

```
gotoAndStop(3);

animationHero1.addEventListener(Event.ENTER_FRAME, resetWalkAnimation);

var command1:Command =
    new SerialCommand(0, //start animation
        new TweenLiteToCommand(0, animationHero1, 6, { x: 1300, ease:Linear.easeNone } ), //move hero to door
        new ChangeFrameCommand(0, animationHero1, 1), //stop hero animation
        new ParallelCommand(0,
            new PlaySoundCommand(0, new OpenDoorSound), //open the door
            new TweenLiteToCommand(0, animationHero1, 1, { alpha: 0 } ) //fade out hero
        ),
        new ChangeFrameCommand(0.5, this, 4), //next frame
        new TraceCommand(1, this.currentFrame.toString()) //trace current frame
        //new TweenLiteToCommand(0.5, this.animationHero2, 3, { x: 1100, ease:Linear.easeNone } ) //Walk hero across the room
    );
    command1.start(); 
```

如您所见，我正在使用命令模式。changeFrameCommand 将“this”设置为第 4 帧。但是，当我在下一个命令中跟踪 currentFrame 时，输出为“3”。这没有任何意义，因为当我运行程序时帧确实会更改为第 4 帧。以下现在已注释掉的命令随后会抛出“无法访问空对象引用的属性或方法”，因为 animationHero2 位于第 4 帧中。

我认为问题最可能的地方是changeFrameCommand，所以这是该类的代码：

```
 package commands  
    {
import commands.Command;
import flash.display.MovieClip;
import flash.display.Stage;

/**
 * ...
 * @author Berry Hermans
 */
public class ChangeFrameCommand extends Command 
{
    private var mc:MovieClip;
    private var frame:int;

    public function ChangeFrameCommand(delay:Number, movieclip:MovieClip, frameNumber:int) 
    {
        super(delay);
        mc = movieclip;
        frame = frameNumber;
    }

    override protected function execute():void
    {
        mc.gotoAndStop(frame);
        complete();
    }

}

    } 
```

如果有人能对这种情况有所了解，我将永远感激不尽，因为我的截止日期是 2 天。

根据要求，附加代码。

串行命令类：

```
 package commands {
import flash.events.Event;

public class SerialCommand extends Command {

    private var _commands:Array;

    public function SerialCommand(delay:Number, ...commands) {
        super(delay);
        _commands = commands;
    }

    private var _completeCommandCount:int;

    override final protected function execute():void {

        //set the complete command count to zero
        _completeCommandCount = 0;

        //listen for the complete event of the first subcommand...
        _commands[0].addEventListener(Event.COMPLETE, onSubcommandComplete);

        //...and start the subcommand
        _commands[0].start();
    }

    private function onSubcommandComplete(e:Event):void {

        //stop listening for the complete event
        Command(e.target).removeEventListener(Event.COMPLETE, onSubcommandComplete);

        //increment the complete command count
        _completeCommandCount++;

        //if all the commands are complete...
        if (_completeCommandCount == _commands.length) {

            //...then this serial command is complete
            complete();
        } else {

            //...otherwise listen for the complete event of the next subcommand...
            _commands[_completeCommandCount].addEventListener(Event.COMPLETE, onSubcommandComplete);

            //...and start the subcommand
            _commands[_completeCommandCount].start();
        }
    }
}
    } 
```

命令类：

```
 package commands {
import flash.events.Event;
import flash.events.EventDispatcher;
import flash.events.TimerEvent;
import flash.utils.Timer;

public class Command extends EventDispatcher {

    private var _timer:Timer;

    public function Command(delay:Number = 0) {
        _timer = new Timer(int(1000 * delay), 1);
        _timer.addEventListener(TimerEvent.TIMER_COMPLETE, onTimerComplete);
    }

    private function onTimerComplete(e:TimerEvent):void {
        execute();
    }

    /**
     * Starts the command.
     * Waits for the timer to complete and calls the execute() method.
     * This method can be used directly as an event listener.
     */
    public final function start(e:Event = null):void {
        _timer.start();
    }

    /**
     * The abstract method for you to override to create your own command.
     */
    protected function execute():void {

    }

    /**
     * Completes the command.
     * Dispatches a complete event.
     * This method can be used directly as an event listener.
     */
    protected final function complete(e:Event = null):void {
        dispatchEvent(new Event(Event.COMPLETE));
    }
}
    } 
```

# sql - 将时间格式从 SAS 转换为 sql（将经过的时间转换为日期）

> ID：14485308
> 
> 赞同：0
> 
> 时间：2013-01-23T17:06:17.157
> 
> 标签：sql, postgresql, datetime, timestamp, sas

我有一个数据集，似乎有“经过”格式的时间（可能是 SAS 格式，其中时间表示为自 1960 年 1 月 1 日以来经过的秒数）。在 sql 查询中，我想将其转换为时间戳或日期格式。有没有一种很好、干净的方法来做到这一点？

类似于这里的答案，除了我在 psql 中需要它，而不是 Python： [基于 1970 年以来经过的秒数的时间和日期](https://stackoverflow.com/questions/7778460/time-and-date-on-the-basis-of-seconds-elapsed-since-1970-year)

这是我的数据示例：

```
time_var      
-------------
1344444527000  
1344448596000  
1344455497000  
1344445125000 
```

这是我想做的查询类型：

```
select
   time_var
   cast(time_var as timestamp) as mytimestamp,
   cast(time_var as date)      as mydatetime, 
   date(time_var)              as mydate 
from
   source_dataset
; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T16:04:20.043

原来我的数据集使用的是 UNIX 时间戳，所以这些值是大整数（需要去除多余的零），时间是 1970 年 1 月 1 日。我从老板那里获得了以下代码来转换这些：

```
select
   timestamp with time zone 'epoch' + interval '1 second' *
      cast((cast(time_var as bigint) / 1000) as integer) as postgres_timestamp,
   date(timestamp with time zone 'epoch' + interval '1 second' *
      cast((cast(time_var as bigint) / 1000) as integer)) as postgres_date 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:05:14.337

这是可以帮助您的 Oracle 示例。有一些假设，我从你的号码中删除了 0-s。无论您使用什么数据库，我希望您发现这个有用：

```
SELECT total_days
     , CAST(end_date AS timestamp) t_stamp
     , CAST(end_date AS date) final_date_time
     -- date(end_date) will not work as end_date is date already
     , TO_CHAR(TRUNC(end_date), 'MM/DD/YYYY') final_date
  FROM
  (
   SELECT ROUND(1344444527/60/60/24)         total_days
        , TO_DATE('01-01-1960','dd-mm-yyyy') start_date
        , TO_DATE('01-01-1960','dd-mm-yyyy')+ (1344444527/60/60/24) end_date
     FROM dual
  )
  /

SQL>

 TOTAL_DAYS   T_STAMP                       FINAL_DATE_TIME       FINAL_DATE
 ----------   -------------------------     -------------------   ----------
 15561        8/8/2002 4:48:47.000000 PM    8/8/2002 4:48:47 PM   08/08/2002 
```

# linux - 仅将数据保存在数组中一次

> ID：14485310
> 
> 赞同：0
> 
> 时间：2013-01-23T17:06:27.367
> 
> 标签：linux, bash

我正在从代码文件中检测变量的名称，并且我只想将它们保存在数组中，前提是我还没有使用相同的变量名称完成该操作

假设这是我从中获取变量名的文件：

```
echo $var1; echo $var2; echo $var1; 
```

我想得到一个像 ($var1 $var2) 而不是 ($var1 $var2 $var1) 的数组

如何检查变量名称是否已存在以及如何将其添加到 bash 数组中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:17:25.363

如果您的 bash 足够新（版本 4），您可以使用它的关联数组：

```
declare -A assoc
assoc[val1]=
assoc[val2]=
assoc[val1]=
echo ${!assoc[@]} 
```

# ef-code-first - 实体框架 CodeFirst 迁移，运行迁移，可选择升级到最新更改

> ID：14485314
> 
> 赞同：3
> 
> 时间：2013-01-23T17:06:38.603
> 
> 标签：ef-code-first, configuration-files, entity-framework-5, entity-framework-migrations, config-transformation

我们正在运行带有**Code First**和**Migrations Enabled的****Entity Framework 5**。使用数据库初始化程序运行：****`MigrateToLatestVersion`****

 ****我们有几个客户在最新的稳定分支上运行。当我们在主干/主服务器中开发新代码时，我们有时需要连接到在分支代码 fx 上运行的客户数据库。调试某种数据错误。

如果有人忘记切换到客户正在运行的分支，这可能是“危险的”，因为迁移将升级客户数据库以适应该人正在运行的任何代码。

一种解决方案是运行另一个不会迁移到最新版本的初始化程序。但是，当我们为新客户部署新系统或新加入团队并且需要启动并运行时，这将意味着更多的工作。

我们正在考虑通过在 app.config 中设置一个 bool 来设置代码是否应该“迁移到最新版本”，然后始终将其设置为 false 以进行开发，然后在部署给客户时对其进行转换来解决这个问题。

这样一来，我们仍然可以将数据库自动更新到最新版本，但不会有开发人员意外连接到旧版本代码系统以及迁移破坏该数据库的危险。

所以现在我们有了这个，我们基本上需要检查这个：

（简化代码）

```
if(Config.MigrateToLatestVersion || !databaseExists) 
{
  var initializer = new MigrateToLatestVersion<MyContext,MigrationConfiguration>();
  Database.SetInitializer(initializer);
  using(var context = new MyContext())
  {
    context.Database.Initialize(true)
  }
} 
```

我的问题是关于如何在不运行迁移的情况下检查数据库是否存在，但我发现你可以这样做：

```
Database.SetInitializer<MyContext>(null);
var context = new MyContext();
var databaseExists = context.Database.Exists(); 
```

但是，如果我只`MigrateToLatestVersion`在数据库不存在或从包管理器控制台手动运行 Update-Database 时运行初始化程序。

我有两个问题，首先：如果我的模型与数据库不同，我不再收到异常，我仍然希望。第二：它不运行位于我的 MigrationConfiguration 中的种子方法，我可能仍想运行该方法。

关于我如何仍然可以运行 Migrations Initializer 以获得所有好处的任何建议，但仍然有一些东西可以防止有人意外破坏我们的生产环境？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-30T12:42:50.073

所以我采用的解决方案是制作一个名为的新 DatabaseInitializer`MigrateDatabaseToLatestIfLocal`

看看[MigrateDatabaseToLatestVersion](http://msdn.microsoft.com/en-us/library/hh829293%28v=vs.103%29.aspx)初始化程序是如何工作的，我做了一些非常相似的事情，不同之处在于检查数据库是否存在以及我们是在本地还是远程运行（借助配置转换来确定这一点。远程系统将其数据源转换为配置文件。）

```
public class MigrateDatabaseToLatestIfLocal<TContext, TMigrationsConfiguration> : IDatabaseInitializer<TContext>
        where TContext : DbContext
        where TMigrationsConfiguration : DbMigrationsConfiguration<TContext>, new()
    {
        private DbMigrationsConfiguration _config;

        public MigrateDatabaseToLatestIfLocal()
        {
            this._config = (DbMigrationsConfiguration)Activator.CreateInstance<TMigrationsConfiguration>();
        }

        public MigrateDatabaseToLatestIfLocal(string connectionStringName)
        {
          MigrateDatabaseToLatestIfLocal<TContext, TMigrationsConfiguration> databaseToLatestVersion = this;
          var instance = Activator.CreateInstance<TMigrationsConfiguration>();
          instance.TargetDatabase = new DbConnectionInfo(connectionStringName);
            databaseToLatestVersion._config = instance;
        }

        public void InitializeDatabase(TContext context)
        {
            var databaseExists = context.Database.Exists();

            var migrator = new DbMigrator(this._config);
            var pendingMigrations = migrator.GetPendingMigrations().OrderByDescending(s => s);
            var localMigrations = migrator.GetLocalMigrations().OrderByDescending(s => s);
            var dbMigrations = migrator.GetDatabaseMigrations().OrderByDescending(s => s);

            var isRemoteConnection = FunctionToFindOutIfWeAreRemote(); //here we check the config file to see if the datasource is a certain IP, this differentiates locally and remotely because of config tranformation.

            if (isRemoteConnection && databaseExists)
            {
                if (pendingMigrations.Any())
                {
                    throw new MigrationsException("You are not allowed to automatically update the database remotely.")
                }
                if (localMigrations.First() != dbMigrations.First())
                {
                    throw new MigrationsException("Migrations in code and database dont match, please make sure you are running the code supported by the remote system. ");
                }
            }
            else
            {
                //we are local, fine update the db and run seeding.
                //we are remote and the db does not exist, fine update and run seed.
                migrator.Update();
            }
        }
    } 
```

这可能是一个非常特殊的情况，但对我来说，它在运行代码首次迁移时提供了一些安全性，确保您不会意外地随机迁移实时环境****

# jquery - jQuery 滑动菜单功能

> ID：14485315
> 
> 赞同：0
> 
> 时间：2013-01-23T17:06:39.777
> 
> 标签：jquery, slidetoggle

我正在尝试为一些参考创建一个简单的 jQuery 菜单。本质上，我希望用户单击“术语”，然后将该术语的定义切换为向上滑动以隐藏或向下滑动以查看。

这是我的 jQuery 代码（对此仍然很新！）

```
<script>
$(document).ready(function(){

  $("p").hide();

$("h3").click(function(){
    $("p").slideToggle("slow");
     });

});
</script> 
```

它工作正常！但是，我无法弄清楚我需要做什么才能使其成为“奇异实例”。现在（很明显给定选择器），如果用户单击任何标题，它将同时切换所有段落元素。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:11:50.093

我相信您使用的不是 $('p').slideToggle('slow')

```
$(this).children('p').slideToggle('slow') 
```

假设 p 是 h3 的子级，如果不是，则必须使用选择器才能到达那里。但是 $(this) 会给你你点击的东西。

# r - 在神经网络中的函数 a(i) 和 b(j) 之间进行插值

> ID：14485316
> 
> 赞同：4
> 
> 时间：2013-01-23T17:06:43.393
> 
> 标签：r

我试图在 R 中使用 nnet 函数来近似两个变量 y(a,b) 的函数。变量“a”和“b”在固定点上都是已知的：

```
a={a(1),a(2),...,a(i),...a(n)} and
b={b(1),b(2),...,b(i),...b(n)}. 
```

对于每一对a(i),b(i)，“y”函数的值是已知的，即

```
y(a,b)={y(a(1),b(1)),y(a(2),b(2),...y(a(i),b(i),...y(a(n),b(n)}. 
```

我做

```
res=nnet(y~a+b,size=X,maxit=M,linout=TRUE), 
```

其中定义了 X 和 M。

如何获得点之间的结果值，例如在 a(i) 和 a(i+1) 之间的某个 a 值和 b(j) 和 b(j+ 之间的 b 值1) ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T20:20:01.183

它看起来像正确的命名问题。我建议使用`data.frame`s 以防止误解。

```
library(nnet)
X <- 20  # Number of neurons in hidden layer
M <- 1e4 # Maximum number of iterations
N <- 50  # Length of data vectors

set.seed(1)
## Train set
df.train <- data.frame(a=rnorm(N,5,1), b=rnorm(N,10,2))
df.train$y <- with(df.train, 5*a-2*b+rnorm(N))
## Test set for interpolation
a1 <- sapply(2:N, function(i) with(df.train, (a[i]+a[i-1])/2))
b1 <- sapply(2:N, function(i) with(df.train, (b[i]+b[i-1])/2))
df.test <- data.frame(a=a1, b=b1) 
```

上面的代码创建了两个`data.frame`s：

1.  `df.train`与列`a`,`b`和`y`.
2.  `df.test`与列`a`和`b`。

请注意，变量的列名称应在两个`data.frame`s.

训练：

```
res <- nnet(y~a+b, data=df.train, size=X, maxit=M, linout=TRUE)
p1 <- predict(res, df.train) 
```

这`p1`是训练数据的预测。

插值：

```
p2 <- predict(res, df.test) 
```

在视觉上，插值看起来很自然：

```
library(ggplot2)
ggplot() + 
  geom_line(aes(x,y), data=data.frame(x=1:N, y=df.train$y)) +        # original y
  geom_point(aes(x,y), data=data.frame(x=1.5:N, y=p2), colour="red") # interpolations 
```

![在此处输入图像描述](../Images/8d3a909639e8090cfa9e083e3c895c06.png)

# solr - Solr：排除仅数字匹配

> ID：14485318
> 
> 赞同：0
> 
> 时间：2013-01-23T17:06:44.620
> 
> 标签：solr, edismax

我搜索游戏“质量效应2”

```
http://localhost:8085/solr/select/?defType=edismax&qf=title&q=Mass+Effect+2&mm=1 
```

除了“质量效应 2”和“摊牌效应”之外，它还可以找到诸如“无主之地 2”、“原型 2”和其他名称中带有“2”的游戏。所以我想排除仅与“2”匹配的文档。

`title`字段定义为：

```
<field name="title" type="text" indexed="true" stored="true" multiValued="false" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T10:42:18.313

这不是一个确切的答案，而是一个简单的答案，可能适合您的情况。您可以使用 minimum should match 参数和 edismax 查询解析器，因此如果您的查询中有一个数字，您可以增加数字并使用 2 例如。

[http://wiki.apache.org/solr/DisMaxQParserPlugin#mm_.28Minimum_.27Should.27_Match.29](http://wiki.apache.org/solr/DisMaxQParserPlugin#mm_.28Minimum_.27Should.27_Match.29)

考虑到不是仅排除数字，而是可以将用例称为“仅使用参数进行提升”，您可以重写查询并使用嵌套的分数。如写在：[http](http://searchhub.org/2009/03/31/nested-queries-in-solr) ://searchhub.org/2009/03/31/nested-queries-in-solr 您的查询可以写

```
 text:Mass Effect OR query:"{!dismax mm=2 }Mass effect 2" 
```

这个想法是在没有数字的情况下进行查询，并将数字作为嵌套查询包含在内以增加数字

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:30:29.327

'pf' 短语提升而不是引用短语搜索会给您带来更好的结果吗？它说所有元素都在附近，不一定是相同的顺序。

# php - 以编程方式使用 Drupal 6 中的字段创建新的内容类型

> ID：14485321
> 
> 赞同：1
> 
> 时间：2013-01-23T17:06:49.967
> 
> 标签：php, mysql, drupal, drupal-6

我想使用 Drupal 6 中存在的自定义 PHP 模块创建一个包含字段的新内容类型。

我需要使用自定义 PHP 创建一个新的内容类型，而不是为内容类型添加价值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T05:18:51.467

您可以制作一个在安装时创建内容类型的模块。您可以[在 drupal.org 上获取此文档的帮助](http://drupal.org/node/1044248)。[这里](http://www.dynamiteheads.com/blog/jakub-suchy/how-create-content-types-cck-programatically-drupal-6)也有一个小教程。

接下来您将要以编程方式插入数据&这里是帮助 - 以[编程方式插入和更新节点](http://www.unleashed-technologies.com/blog/2010/07/16/drupal-6-inserting-updating-nodes-programmatically)

我知道启动需要时间，并且需要一段时间才能运行，但至少你愿意现在就开始。很高兴用 Drupal 编码......祝你好运:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:09:20.647

您可以使用[CCK 模块](http://drupal.org/project/cck)在 Drupal 6 中创建自定义内容类型。我不确定您所说的“自定义 PHP 模块”是什么意思。CCK 应该可以解决问题。

# java - 使用 ProcessBuilder 在 Java 中运行 minecraft.jar

> ID：14485324
> 
> 赞同：1
> 
> 时间：2013-01-23T17:06:57.913
> 
> 标签：java, minecraft, processbuilder

我正在尝试用 Java 运行 Minecraft.jar（游戏）。我尝试使用以下代码运行它：

```
String LibsAndStuff = String.format(
        "%s/minecraft.jar:%s/lwjgl.jar:%s/lwjgl_util.jar:%s/jinput.jar", 
        OSDetector.getMinecraftJarDiretoryFullPath(), 
        OSDetector.getMinecraftJarDiretoryFullPath(), 
        OSDetector.getMinecraftJarDiretoryFullPath(), 
        OSDetector.getMinecraftJarDiretoryFullPath());

ProcessBuilder pb = new ProcessBuilder("java", "-Xmx2048M", "-Xms512M", "-cp", 
        LibsAndStuff, String.format("-Djava.library.path=%s/natives", 
        OSDetector.getMinecraftJarDiretoryFullPath()), 
        "net.minecraft.client.Minecraft");
pb.directory(new File(OSDetector.getMinecraftJarDiretoryFullPath()));

try {
    Process p = pb.start();
} catch (IOException e1) {
    e1.printStackTrace();
} 
```

`OSDetector.getMinecraftJarDiretoryFullPath()`返回带有 .minecraft 路径的字符串（例如“/home/user/.minecraft”）。Eclipse 控制台中没有显示任何内容。我不知道出了什么问题，因为在 bash 中启动的完全相同的命令运行良好。

@EDIT `C:\Users\Łukasz\AppData\Roaming\.minecraft\bin/minecraft.jar:C:\Users\Łukasz\AppData\Roaming\.minecraft\bin/lwjgl.jar:C:\Users\Łukasz\AppData\Roaming\.minecraft\bin/lwjgl_util.jar:C:\Users\Łukasz\AppData\Roaming\.minecraft\bin/jinput.jar` 这是那个字符串。我将 / 更改为 \，但没有帮助：<

# google-apps-script - 简单返回 Google Scripts 函数导致 HTML 模板

> ID：14485328
> 
> 赞同：3
> 
> 时间：2013-01-23T17:07:10.067
> 
> 标签：google-apps-script

我已经构建了几个简单的函数，它们在 Google Scripts 中返回单元格值。我还创建了简单的模板 HTML 文件，并尝试遵循 Google 的[HTML 服务文档](https://developers.google.com/apps-script/html_service?hl=en)！但我的 HTML 模板输出仍然不适合我。

首先，我的 .GS 文件中的 JS：

```
function doGet() {
  return HtmlService.createTemplateFromFile('TemplateName').evaluate();
}

function getStarData2() {
  var ss = SpreadsheetApp.openById("key in here").getRange("A2").getValue();
  //Logger.log(ss);
  return ss;
} 
```

还有我的 HTML：

```
...<span><? getStarData2(); ?></span>... 
```

我已经尝试了各种不同的方法来让它工作，但是，我发现它要么运行但没有显示，要么它运行，或者它返回各种不同的错误，具体取决于我的尝试。

我想这对于所有专家来说都是一个非常简单的解决方法，因此非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:01:56.730

尝试使用`<?= getStarData2(); ?>`而不是`<? getStarData2() ?>`.

等号基本上是说，“运行这个函数，然后打印出这里返回的任何内容。” 否则，您只是在运行该函数，而对结果什么也不做。

# regex - 捕获这些元素的正则表达式是什么？

> ID：14485332
> 
> 赞同：-2
> 
> 时间：2013-01-23T17:07:29.707
> 
> 标签：regex

假设您有一个包含任意行数的字符串，每行都遵循如下所示的模式，

```
 Line 498:          [Badsds()]
 Line 499:          protected override void Something() {
 Line 500:              base.Something(); 
```

捕获“Line \d+:\s*”之后的文本的正则表达式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:14:54.310

如果你正在使用`c#`你可以做

```
List<string> lstMatch=Regex.Matches(input,@"(?<=^\s*Line \d+:)(.*)$",RegexOptions.IgnoreCase|RegexOptions.Multiline)
                           .Cast<Match>()
                           .Select(x=>x.Value)
                           .ToList(); 
```

或者

```
List<string> lstMatch=Regex.Matches(input,@"^\s*Line \d+:\s*(.*)$",RegexOptions.IgnoreCase|RegexOptions.Multiline)
                               .Cast<Match>()
                               .Select(x=>x.Groups[1].Value)
                               .ToList(); 
```

如果您想避免一次读取所有行

```
foreach (string line in File.ReadLines(fileLocation))
    {
       Regex.Match(line,@"^\s*Line \d+:\s*(.*)$",RegexOptions.IgnoreCase).Groups[1].Value;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:14:11.633

```
Line \d+:\s*(.*) 
```

捕获您在第一个捕获组中指定的模式之后的所有内容。

# azure - WP8 IMobileServiceTable - 检测异步调用结束

> ID：14485335
> 
> 赞同：2
> 
> 时间：2013-01-23T17:07:38.153
> 
> 标签：azure, windows-phone-8, azure-mobile-services, asynchronous

我的应用程序对 Azure Webservice 数据库进行了简单调用，我想将返回的行复制到一个新列表中。

```
private IMobileServiceTable<dbEntry> entryTable = App.MobileService.GetTable<dbEntry>();
private MobileServiceCollectionView<dbEntry> currentEntries;

currentEntries = (entryTable.Where(ev => ev.event_date.Month == dateToShow.Month)
            .ToCollectionView());

foreach (dbEntry ev in currentEntries)
{
    //insert ev into another List
} 
```

问题是对 DB 的“where”调用是异步的，所以当到达循环时，还没有元素`currentEntries`。

如何在执行循环之前检测到调用已完成？有为此的事件处理程序吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T23:05:53.593

听起来您已经找到了此解决方案，但我会将其发布给遇到此问题的其他人。

除非你想直接将一个 UI 元素绑定到操作的结果上，否则我建议你不要使用 ToCollectionView 方法。相反，请执行以下操作：

```
private IMobileServiceTable<dbEntry> entryTable = App.MobileService.GetTable<dbEntry>();
private List<dbEntry> currentEntries;

currentEntries = await entryTable.Where(ev => ev.event_date.Month == dateToShow.Month)
   .ToListAsync();

foreach (dbEntry ev in currentEntries)
{
    //insert ev into another List
} 
```

# javascript - 在 JavaScript 中计算两个 geoloc 之间的距离

> ID：14485336
> 
> 赞同：0
> 
> 时间：2013-01-23T17:07:38.707
> 
> 标签：javascript

> **可能重复：**
> [如何计算两个经纬度点之间的距离？](https://stackoverflow.com/questions/27928/how-do-i-calculate-distance-between-two-latitude-longitude-points)

如何计算 JavaScript 中地理位置之间的距离（以米为单位）？我找到了这个[答案](https://stackoverflow.com/questions/8832071/how-can-i-get-the-distance-between-two-point-by-latlng)，但它是用 Java 实现的，我并没有真正理解发生了什么。

我正在使用 HTML 5 的地理位置功能并使用 JavaScript 来计算距离。直到现在我有这个功能：

```
 function calculateDistance(lat1, lat2, lng1, lng2)
    {
        return Math.sqrt(((lat1 + lat2)*(lat1 + lat2)) + ((lng1  + lng2)*(lng1  + lng2)));
    } 
```

显然这不是我需要的值。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:10:20.357

```
var R = 6371; // Earth radius in km
var dLat = (lat2-lat1).toRad();
var dLon = (lon2-lon1).toRad();
var lat1 = lat1.toRad();
var lat2 = lat2.toRad();

var a = Math.sin(dLat/2) * Math.sin(dLat/2) +
    Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2); 
var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
var d = R * c; 
```

这不是我的代码。它取自：[http](http://www.movable-type.co.uk/scripts/latlong.html) ://www.movable-type.co.uk/scripts/latlong.html 查看链接了解详情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:11:28.003

也许[这](http://www.movable-type.co.uk/scripts/latlong.html)会有所帮助，这个[答案](https://stackoverflow.com/a/27943/1418118)也可能会有所帮助。

# c++ - 从 Fortran 调用 C 函数，其中 C 函数名称最初是从 C 传入的

> ID：14485344
> 
> 赞同：2
> 
> 时间：2013-01-23T17:08:18.940
> 
> 标签：c++, c, fortran, fortran-iso-c-binding

由于不相关的原因，我需要将 C/C++ 函数名称传递给 Fortran 子例程，该子例程又调用该 C 函数。我发现我可以成功地将函数名传递到 Fortran 子例程中。在那个子程序中，我可以调用正确的 C 函数。但是，C 函数的参数在此调用中被破坏（当直接从 C 调用时，它工作正常）。我已经使用[ISO C Binding](http://gcc.gnu.org/onlinedocs/gfortran/Interoperability-with-C.html)来尝试让它工作，但无济于事。

这是一个MWE：

### fortranRoutine.h：

```
extern "C" {
    void fortranRoutine_(void(int status));
}; 
```

* * *

### 从Fortran.h调用：

```
void calledfromFortran(int status); 
```

* * *

### 主.cpp：

```
#include "fortranRoutine.h"
#include "calledfromFortran.h" 

using namespace std;

int main(int argc, char** argv) {
    calledfromFortran(12);
    fortranRoutine_(calledfromFortran);
    return 0;
} 
```

* * *

### fortranRoutine.f90：

```
subroutine fortranRoutine(calledfromFortran)

    use iso_c_binding

    implicit none

    interface
        subroutine calledfromFortran(status) bind (c)
            use iso_c_binding
            integer(kind = c_int), intent(in) :: status
        end subroutine calledfromFortran
    end interface

    integer(kind = c_int) :: one

    one = 2
    call calledfromFortran(one)
    return

end subroutine fortranRoutine 
```

* * *

### 从Fortran.cpp 调用：

```
#include <iostream>
#include "stdlib.h"

using namespace std;

void calledfromFortran(int status) {
    cout << "In calledfromFortran:" << endl;
    cout << " status: " << status << endl;
} 
```

* * *

## 当前结果

当前运行它会给出：

```
In calledfromFortran:
 status: 12
In calledfromFortran:
 status: -1641758848 
```

`calledfromFortran`对from的第一次调用可以`main`正常工作，但是从`fortranRoutine`值调用它时会被破坏。请注意，每次运行时，后一个值都会发生变化。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T14:21:11.990

在 Fortran 和 C 之间传递标量值时，基本上有两种选择：

*   您通过引用传递它们：在 C 端，您必须确保使用指向这些标量的指针。

*   您按值传递它们：在 Fortran 方面，您必须确保使用该`VALUE`属性，正如其他帖子已经建议的那样。

至于`intent(in)`属性，它可以留在那里，因为它不影响变量是通过值传递还是引用传递。`VALUE`在 Fortran 中，除非您指定属性，否则参数始终通过引用传递。该属性`intent(in)`仅告诉编译器防止在例程中使用该虚拟参数，这将改变其值。

关于命名的附加说明：您`fortranRoutine`还应该使用`bind(c)`. 通过这种方式，您可以指定它的名称，如从 C 中看到的那样，即使它位于模块内：

```
module my_interface
  use iso_c_binding

contains

  subroutine fortranRoutine(calledFromFortran) bind(c, name='fortranroutine')
  ...
  end subroutine fortranRoutine

end module my_interface 
```

这样您就可以确定，要从 C 调用的函数的名称是`fortranroutine`，独立于编译器附加下划线、附加模块名称或将名称转换为小写的约定。因此，您将有一个 C 中的头文件，它应该*独立于编译器*工作：

```
extern "C" {
  void fortranroutine(void(int status));
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:17:56.883

我会将接口定义更改为阅读

```
interface
    subroutine calledfromFortran(status) bind (c)
        use iso_c_binding
        integer(kind = c_int), VALUE :: status
    end subroutine calledfromFortran
end interface 
```

我不确定是什么`intent(in)`，但那部分代码看起来不正确。除此之外，其余的看起来（乍一看）是合理和正确的。

*笔记。ISO C 绑定仅在 FORTRAN 语言的 2003 版本中添加，因此如果您使用的是旧版本，可能值得查看编译器文档以获取详细信息。一些编译器允许 ISO C 绑定，但可能与我上面显示的略有不同。*

* * *

编辑。查看`intent`关键字后，您可以尝试`intent(in)`与以下类型声明结合使用，该类型声明遵循`interface`定义

```
integer (c_int), parameter :: one = 2 
```

我希望这有帮助。

# javascript - 如何使用 jquery 隐藏/显示辅助导航

> ID：14485345
> 
> 赞同：0
> 
> 时间：2013-01-23T17:08:24.130
> 
> 标签：javascript, jquery, html

目前，我的网站上有两个级别的导航。选择时，导航会隐藏/显示 1 页网站的某些部分。我要做的是在`#selected-work`导航链接处于非活动状态时隐藏辅助导航。选择`#selected-work`喜欢后，我希望显示我的辅助导航。到目前为止，我已经设置了一些 jquery 来运行该`hashchange`功能并隐藏/显示不同的内容区域，但是我不知道如何通过辅助导航来实现我的目标。非常欢迎所有建议。

这是我的这些部分的代码：

HTML

```
<div id="header-nav-float-wrap">

<!--main navigation-->
<ul class="nav-list">
    <li><a href="#selected-work" id="selected-work-link">Selected Work</a></li>
    <li><a href="#cv">CV</a></li>                           
    <li><a href="#about">About</a></li>
  </ul> 
</div>

 <!-- Secondary Nav -->

 <div id="left-nav-wrapper">
    <div id="left-nav">
   <ul class="left-nav-list">
    <li><a href="#painting">Painting</a></li>
    <li><a href="#drawing">Drawing</a></li>
        <li><a href="#design">Design</a></li>
    <li><a href="#commissions">Commissions</a></li>
   </ul>
    </div>

 </div>

  <div id="main-content-wrapper">
<div id="main-content">
       <!-- default page content -->
   <div id="default" class="content-pages">
       <img src="img/painting1.jpg">
   </div>
     </div>
   </div> 
```

Javascript

```
$(document).ready(function() {

$(window).on("hashchange", function(e) {
    $(location.hash.length > 1 ? location.hash : "#default").siblings().hide().end().show();
}).trigger("hashchange");

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:49:14.627

`**[LIVE DEMO](http://jsbin.com/aloqis/2)**`

```
$(document).ready(function() {

  $(window).on("hashchange", function(e) {

    var hashID = window.location.hash;

    $(hashID.length > 1 ? hashID : "#default").show().siblings().hide();

    var show_hide = hashID=='#selected-work' ? 'show' : 'hide';
    $('#left-nav-wrapper')[show_hide]();

  }).trigger("hashchange");

}); 
```

# javascript - 如果表单提交被取消，是否有可以监控的 jQuery 事件？

> ID：14485349
> 
> 赞同：4
> 
> 时间：2013-01-23T17:08:36.757
> 
> 标签：javascript, jquery, submit

我在表单提交上有一些 Javascript 代码，它使数据表变灰并覆盖加载图像以指示重新加载正在发生。

问题是如果用户取消了页面重新加载，表格将保持灰色。我想注意页面提交是否被取消，如果是，则将表格淡入并删除覆盖。

**我的问题是：**当取消加载新页面时，是否有可以使用直接 Javascript 或 jQuery 绑定的事件？

我已经用谷歌搜索了很多东西，但是如果有答案，我在大量询问如何取消提交操作的人中看不到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:14:20.467

让用户取消的事件处理程序取消灰色显示如何？即，与其等待收到取消通知，不如成为取消的处理程序。

# javascript - 一次仅将 jquery 脚本应用于一个类

> ID：14485353
> 
> 赞同：0
> 
> 时间：2013-01-23T17:08:41.223
> 
> 标签：javascript, jquery, css-selectors

如何一次将此脚本应用于一个班级

```
<script>

    $(document).ready(function(){

        // set up click/tap panels
        $('.click').toggle(function(){

            $(this).addClass('flip');
        },function(){
            $(this).removeClass('flip');
        });

        // set up block configuration
        $('.action').click(function(){;
            $('.card').addClass('flip');
        });
        $('.action2').click(function(){
            $('.card').removeClass('flip');
        });

}); 
```

当我单击动作类时，所有卡片类都会翻转，我想一次旋转一个。

我的想法是单击一张并仅翻转那张，单击另一张并仅翻转那张卡，而不是同时翻转所有卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:16:31.717

使用延迟

```
$('.action').click(function(){
    $('.card').each(function(i, el) {
        setTimeout(function(){ $(this).addClass('flip'); }, i*300);
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:35:48.690

如果您只想翻转`.card`包含您单击的操作的 div，请执行以下操作：

```
 $('.action').click(function(){;
        $(this).closest(".card").addClass('flip');
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:12:00.063

如果你想在点击时切换一个类，你可以使用 toggleClass()。

```
$(document).on("click", ".click", function() {
    $(this).toggleClass('flip');
}); 
```

现在，如果您想一次翻转一个。确切地知道你想要什么有点困难。我猜你想要这样的东西。

```
$('.action').click(function(){;        
    var cards = $('.card');
    var current = cards.filter(".flip").removeClass('flip');
    var next = current.length===1 && next.index()+1<cards.length? current.next() : cards.first();
    next.addClass("flip");
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:14:56.643

您可以使用`setInterval()`

**[现场演示](http://jsfiddle.net/rajaadil/tEupv/)**

```
var cards;
index = 0;
var interval1;
function repeat()
{
      cards.eq(index++).addClass('flip');
      if(index  == cards.length)
          clearInterval(interval1);
}
$('.action').click(function(){
    cards = $('.card');
    interval1 = setInterval(repeat, 1000);
}); 
```

# php - 获取视图中的 CActiveDataProvider 数据

> ID：14485358
> 
> 赞同：1
> 
> 时间：2013-01-23T17:08:53.737
> 
> 标签：php, yii

如何`CActiveDataProvider`不使用直接获取数据`CGridView`？

控制器.php

```
public function actionList($id)
{
    $criteria = new CDbCriteria;

    $dataProvider=new CActiveDataProvider('Events', array(
            'criteria' => $criteria
    ));

    $this->render('list',array(
        'dataProvider'=>$dataProvider,
    ));
} 
```

查看.php：

```
<?php echo $dataProvider->name; ?> // Return Error 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-23T17:38:24.467

CActiveDataProvider以ActiveRecord**对象**的形式提供数据，使用`getData()`方法获取dataprovider中的所有activerecord对象

```
$models =$dataProvider->getData()

foreach($models as $model)
{
 echo $model->name;
} 
```

# javascript - 避免 `fetch()` 将模型属性标记为已更改

> ID：14485366
> 
> 赞同：3
> 
> 时间：2013-01-23T17:09:06.647
> 
> 标签：javascript, backbone.js

我在用户设置配置文件表单中使用 Backbone。我获取模型并将其信息呈现到表单中。当我保存模型时，*所有*参数都被发送，而不是用户更改的参数。

首先，我获取模式并将其呈现在视图上：

```
// Fetch model and render on view
user = new User({ id: 123 });
user.fetch().done(function () {
    view.render();
}); 
```

当用户更改字段时，我使用“set()”方法更新了模型：

```
"change .email": function () {
    this.model.set("email", this.email.val());
} 
```

稍后在视图代码中，我保存了一个点击事件（使用`patch: true`）：

```
"click .save": function () {
    console.log(this.model.changedAttributes());  // Shows all the model attributes
    this.model.save({ patch: true }); // Sends all the model attributes
 } 
```

`fetch`在我用来初始化模型后，如何避免 Backbone 标记为已更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:02:35.363

这个黑客将解决您的问题：

```
model.fetch({context:model}).done(function () {
  this.set({});
  view.render();
}); 
```

# android - 使用 cancel() 从 AlarmManager 删除警报 - Android

> ID：14485368
> 
> 赞同：42
> 
> 时间：2013-01-23T17:09:16.907
> 
> 标签：android, alarm, android-pendingintent

我正在尝试以两种不同的方法创建和删除警报，这两种方法都在应用程序逻辑中的不同时刻调用。

但是，当我调用 AlarmManager 的`cancel()`方法时，警报并没有被删除。

**这是我的`addAlarm()`方法：**

```
AlarmManager alarmManager = (AlarmManager) mContext.getSystemService(Context.ALARM_SERVICE);

Intent intent = new Intent(PROX_ALERT_INTENT);
intent.putExtra("ALERT_TIME", alert.date);
intent.putExtra("ID_ALERT", alert.idAlert);
intent.putExtra("TITLE", alert.title);
intent.putExtra("GEO_LOC", alert.isGeoLoc);
PendingIntent pendingIntent = PendingIntent.getBroadcast(mContext,
        alert.idAlert, intent, PendingIntent.FLAG_CANCEL_CURRENT);

Calendar calendar = Calendar.getInstance();
calendar.setTime(alert.date);
alarmManager.set(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), pendingIntent);
Log.e("ADD ALERT - WithoutGeoLoc - ",alert.toString()); 
```

**这是我的 deleteAlarm() 方法：**

```
AlarmManager alarmManager = (AlarmManager) mContext.getSystemService(Context.ALARM_SERVICE);

Intent intent = new Intent(PROX_ALERT_INTENT);
intent.putExtra("ALERT_TIME", alert.date);
intent.putExtra("ID_ALERT", alert.idAlert);
intent.putExtra("TITLE", alert.title);
intent.putExtra("GEO_LOC", alert.isGeoLoc);
PendingIntent pendingIntent = PendingIntent.getBroadcast(mContext,
        alert.idAlert, intent, PendingIntent.FLAG_CANCEL_CURRENT);

alarmManager.cancel(pendingIntent);
Log.e(TAG,"REMOVE ALERT - without GeoLoc"+alert.toString()); 
```

**这是我的 Logcat ：**

```
01-23 17:44:07.411: E/ADD ALERT - WithoutGeoLoc -(18789): Alert [latitude=0.0, longitude=0.0, title=bfwu, comments=null, address=null, currency=hrk, idAlert=1, date=Sat Feb 23 17:44:04 CET 2013, isGeoLoc=null]
01-23 17:44:13.032: E/REMOVE ALERT without GeoLoc - (18789): Alert [latitude=0.0, longitude=0.0, title=bfwu, comments=null, address=null, currency=hrk, idAlert=1, date=Sat Feb 23 17:44:04 CET 2013, isGeoLoc=null] 
```

**这是 AlarmManager 中的 pendingIntents 列表**

```
Current Alarm Manager state:
Realtime wakeup (now=2013-01-23 17:44:37):
RTC_WAKEUP #48: Alarm{2c1d0588 type 0 com.my.app}
type=0 when=+364d23h59m33s288ms repeatInterval=0 count=0
operation=PendingIntent{2c0a6cb0: PendingIntentRecord{2c1d04e8 com.my.app  broadcastIntent}}
RTC_WAKEUP #47: Alarm{2c2298a0 type 0 com.my.app}
type=0 when=+30d23h59m27s360ms repeatInterval=0 count=0
operation=PendingIntent{2c292af8: PendingIntentRecord{2c22a628 com.my.app broadcastIntent}} 
```

几点注意事项：

*   `RTC_WAKEUP #47`是我原来的闹钟
*   `RTC_WAKEUP #48`是一个应该覆盖 #47 而不是创建新警报的新警报。

我使用`filterEquals()`返回的 Intent 方法比较了我的 add 和 delete 方法中的两个意图（不是 pendingIntents） `true`......但是警报没有被删除。我究竟做错了什么？

* * *

**更新**

**这是我的`saveAlert()`调用方法`addAlarm()``deleteAlarm()`**

```
private void saveAlert() {
    // *** If Modifying Alert => REMOVE OLD ALERT (then add new one)
    Intent intent1 = null, intent2 = null;

    if (alert.idAlert != null) {
        if (alert.isGeoLoc == null || alert.isGeoLoc == false) {
            intent2 = ProximityService.removeProximityAlertWithoutGeoLoc(getApplicationContext(), devisesApp.alertsGlobal.getAlertById(alert));
        } else {
            ProximityService.removeProximityAlert(getApplicationContext(), alert);
        }
    }
    // *** Add Alert
    if (alert.isGeoLoc == null || alert.isGeoLoc == false) {
        intent1 = ProximityService.addProximityAlertWithoutGeoLoc(getApplicationContext(), alert, devisesApp.alertsGlobal);
    } else {
        ProximityService.addProximityAlert(getApplicationContext(), alert, devisesApp.alertsGlobal);
    }

    Log.i(TAG, "[saveAlert] Alert ID : " + alert.idAlert);
    devisesApp.alertsGlobal.addById(alert);
    Log.i("INTENT EQUALS", intent1.filterEquals(intent2) + ""); // This returns true
} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-24T09:55:13.573

试试这个标志：

```
PendingIntent.FLAG_UPDATE_CURRENT 
```

代替：

```
PendingIntent.FLAG_CANCEL_CURRENT 
```

所以 PendingIntent 看起来像这样：

```
PendingIntent pendingIntent = PendingIntent.getBroadcast(mContext, 
        alert.idAlert, intent, PendingIntent.FLAG_UPDATE_CURRENT) 
```

（确保您使用相同的`alert`对象和`mContext`！）

附注：如果您想要一个全局 AlarmManager，请将 AlarmManager 放在一个静态变量中（并仅在它为 时才对其进行初始化`null`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-02-16T10:07:12.063

取消警报有点令人困惑。您必须传递相同的 ID 和 IntentPending。这是一个例子：

```
private void resetIntentWithAlarm(int time){

        Intent intentAlarm = new Intent(getApplicationContext(), DownloadService.class);
        intentAlarm.putExtra(Your Key, Your stuff to pass here);

        AlarmManager alarmManager = (AlarmManager) getSystemService(Context.ALARM_SERVICE);

        PendingIntent pendingIntent = PendingIntent.getService(
                getApplicationContext(),
                YOUR_ID,
                intentAlarm,
                PendingIntent.FLAG_UPDATE_CURRENT
        );

    if (time != 0) {

        alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis() + (60L * 1000L * time), (60L * 1000L * time), pendingIntent);
        Log.i(TAG, "Alarm setted on for " + time + " mins.");
    }
    // if TIME == Zero, cancel alaram
    else {

        alarmManager.cancel(pendingIntent);
        Log.i(TAG, "Alarm CANCELED. Time = " + time);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-04T05:08:12.383

在您设置的任何特定时间从警报管理器取消警报：

```
Intent intent = new Intent(context, AlarmReceiver.class);
PendingIntent pendingIntent = PendingIntent.getBroadcast(context, 0, intent, PendingIntent.FLAG_CANCEL_CURRENT);
AlarmManager am = (AlarmManager) context.getSystemService(ALARM_SERVICE);
am.cancel(pendingIntent); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-10-23T08:41:42.143

如果您想取消警报管理器，只需将 wright id 放入待处理的意图中，然后在警报管理器中为该待处理的意图调用 cancel()。

# jquery - 可排序的图像库

> ID：14485376
> 
> 赞同：1
> 
> 时间：2013-01-23T17:09:39.383
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable

我想使用 Jquery UI Sortable 创建一个可排序的图片库。直到这里，工作正常。

在每个标签内，我需要将每个图像的顺序存储在图库中。但是这个顺序必须在图像移动时更新。

示例：我有五个图像：

```
<ul id="sortable">
  <li id="1" value="1">image 1</li>
  <li id="2" value="2">image 2</li>
  <li id="3" value="3">image 3</li>
  <li id="4" value="4">image 4</li>
  <li id="5" value="5">image 5</li>
</ul> 
```

如果我将图像 4 移动到图像 5 之后，则顺序值不应更改。也就是说，图像 5 的值为 4，图像 4 的值为 5。

这个有可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:14:41.400

您可以在`stop`排序刚刚结束时更新事件中的值。像这样的东西：

```
$("#sortable").sortable({
    stop: function(event, ui) {
        $(this).children("li").each(function(index) {
            $(this).attr("value", index);
        });
    }
}); 
```

像这样，如果您想在重新加载后保留此显示，您可以将新值保存在服务器上。

[编辑：通过marcelo2605](https://stackoverflow.com/users/1633525/marcelo2605)更正设置索引的方式

# voip - H.264 over RTP 流在播放时中断

> ID：14485377
> 
> 赞同：2
> 
> 时间：2013-01-23T17:09:54.077
> 
> 标签：voip, h.264, rtp

我正在从一个主流终端通过 RTP 录制 H.264 单个 nalu 数据包流并播放它。

问题是，当我使用我正在开发的 RTP 模块播放它并将其发送到终端时，视频会跳过并且我在帧之间得到模糊的部分。我不知道它会发生什么或可能会发生什么。这是一些数据：

视频以 15 fps 录制和播放 帧之间的 rtp 时间戳增量为 6000 (90000khz/15fps) rtp 数据包之间的时间间隔约为 66.66 mili secs (1000milis/15fps)，如果不增加时间戳，则为 2 milis（对于图片参数集和其他与时间无关的数据包）。

所有这些数据都是用wireshark嗅探收集的。

所以，对我来说，流看起来很健康，但由于某种原因，播放很糟糕。这是显示播放的视频的链接。

[http://youtu.be/TGE14y76lc0](http://youtu.be/TGE14y76lc0)

也许观看视频有人可以识别发生了什么。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T19:35:26.067

最后我破解了它。那里有两个问题。

第一个终端在我录制时重置了 rtp 时间戳，这使我的计数器变量溢出并在播放时弄乱了我的时间戳。

另一个与 Ralf 指出的有关，数据包没有被丢弃，但由于缓冲区错误，RTP 数据包在记录时被截断，因此 h.264 比特流信息丢失了。

现在视频可以流畅播放了 :D –</p>

# javascript - 与 Adob e Edge Animate 的冲突

> ID：14485381
> 
> 赞同：0
> 
> 时间：2013-01-23T17:10:09.127
> 
> 标签：javascript, html, jquery-animate, adobe-edge

我的公司正在考虑用 HTML5 动画替换所有 Flash 内容，Edge 似乎是我们的 Flash 人员轻松进入 HTML5 世界的好选择。

这是我们遇到的问题。Flash 中的动画已在 Edge Animate 中重新创建并且运行良好，但是将它们放在同一页面上时（有页眉和页脚动画）。这两个组合相互踩踏，并弄乱了页眉和页脚动画的剪辑。需要注意的是，它们没有相同的宽度或高度，这就是动画最成问题的地方。不应该看到的元素是，我认为它与剪辑有关。在我的修修补补中，似乎两种作品都在互相踩踏，并从对方身上获取一些属性。如果我从页面中删除其中一个，另一个将正常工作。

我不知道为什么会这样，但我似乎找不到任何将两个单独的作品放在一页中的例子。任何帮助将不胜感激，或者即使您知道此类问题的良好资源，我也会非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T02:50:17.837

好的，在处理 DIV ID="stage" 时，您需要将其中一个更改为其他内容，别担心，它不会打扰它。

现在，您还必须弄乱定位，以便将其正确设置为您想要的位置。

例如，您的 2 个 Ae Div 是：stage 和 mystage

```
<style type="text/css">
#header{
position:relative;
top:5px;
width:200px;
}
#stage{
position:relative;
top:5px;
width:200px;
top:5px;
left:25px;
}
#MyCenter{
position:relative;
top:20px;
height:300px;
width:400px;
}
#mystage{
position:relative;
width:300px;
top:30px;
left:25px;
}
</style>

<div id="header">This is my header</div>
<div id="stage">Top Stage</div>
<div id="MyCenter">This is my center content</div>
<div id="mystage">Bottom Stage</div> 
```

您需要保存此文件，并将其作为 .html 运行。这将演示如何从 Ae 设置您的 DIV 标签。做起来相当简单。

希望这可以帮助。韦恩

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T01:43:22.953

如果您查看 adobe edge api（最后），它会显示如何将两个动画放在一个页面上。 [http://www.adobe.com/devnet-docs/edgeanimate/api/old/1.6/EdgeAPI.0.1.6.html](http://www.adobe.com/devnet-docs/edgeanimate/api/old/1.6/EdgeAPI.0.1.6.html)

它需要对 html 页面进行一些修改，但应该相当简单。本质上，您有一个 html 页面引用这两种组合。

# jsf - 如何刷新不同文件中的元素

> ID：14485382
> 
> 赞同：2
> 
> 时间：2013-01-23T17:10:11.313
> 
> 标签：jsf, primefaces, tree

我正在开发基于 primefaces 的 www 应用程序。我的组件之一 [tree] 在 .xhtml 文件中定义。我想从不同的地方[文件]刷新它。有没有办法做到这一点？我试过经典

```
update="nameOfElement" 
```

但它根本不起作用。我不需要一行一行的特定代码。总的来说，如何做到这一点，甚至有可能。如果没有 - > 我可以为此使用 primepush 吗？如何传递树结构？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:40:52.710

许多 Primefaces 组件中的`update`属性通常采用空格分隔的组件 id 字符串，在 JSF Ajax 请求/响应发生后应该重绘该字符串。可以将以下条目放入更新属性中：

*   **@this**只会更新这个组件
*   **@parent**将更新`UINamingContainer`该组件的父级
*   **@form**将更新此组件表单中的所有组件
*   **如果nameOfElement**是相对于同一个 UINamingContainer 的，它只会更新具有以下元素的组件。

所以它似乎无法找到具有此 id 的组件，只是因为它位于不同的 id 中`UINamingContainer`，例如。`<form> <h:dataTable> etc`.

使用`:`前缀将解析相对于页面视图根的 id。

```
update=":nameOfElement" 
```

如果元素不在命名容器内，这应该能够找到元素......

但是，如果它位于前面加上其 id 的表单中怎么办？

```
update=":nameOfForm:nameOfElement" 
```

然后上面应该找到相对于视图根的表单前缀元素。

# android - AndEngine 在多台设备上加载 TMX 地图

> ID：14485385
> 
> 赞同：3
> 
> 时间：2013-01-23T17:10:17.133
> 
> 标签：android, map, scale, andengine, tmx

我的游戏有问题。我有一张 1280x1280px 的地图。它由 40x40 块组成，因此 1 个块是 32x32 像素。问题是我无法将此地图缩放到设备的实际屏幕尺寸。有没有办法做到这一点？

这就是我加载 tmx 文件的方式：

```
public Scene onLoadScene() {
                // TODO Auto-generated method stub
                this.mMainScene = new Scene(1);

                try
                {
                        final TMXLoader tmxLoader = new TMXLoader(this, this.mEngine.getTextureManager(),
                                                                                                                TextureOptions.BILINEAR_PREMULTIPLYALPHA);
                        this.mTMXTiledMap = tmxLoader.loadFromAsset(this,"gfx/untitled.tmx");

                        //"gfx/0_fire_drill-lvl_01.tmx"
                }
                catch(final TMXLoadException tmxle)
                {              
                        Debug.e(tmxle);
                }

                for(TMXLayer tmxLayer : this.mTMXTiledMap.getTMXLayers())
                {
                        this.mMainScene.getChild(0).attachChild(tmxLayer);
                }              

                return this.mMainScene;
        } 
```

这就是地图的样子： [http ://postimage.org/image/403w3dfnx/](http://postimage.org/image/403w3dfnx/)

这些动作只会发生在红色区域。我需要编辑地图吗？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T22:17:21.223

问题不在于您如何生成地图，而在于您的相机。使用 AndEngine 的各种相机类之一创建相机。（我是 SmoothCamera 的粉丝。）像这样：

```
SmoothCamera camera = new SmoothCamera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT, 10, 10, 1.0f); 
```

CAMERA_WIDTH 和 CAMERA_HEIGHT 是供您定义的整数。如果您将这些设置为较小的值，您会放大更多。您也可以直接调整相机的变焦。像这样：

```
camera.setZoomFactor(5.0f); 
```

你可能会想要设置相机来追逐你的玩家实体。像这样的东西：

```
camera.setChaseEntity(pChaseEntity) 
```

pChaseEntity 是您希望它遵循的任何东西。希望这可以帮助。

# powershell - Powershell 导出到 CSV

> ID：14485389
> 
> 赞同：1
> 
> 时间：2013-01-23T17:10:26.650
> 
> 标签：powershell, export-to-csv, get-childitem

我正在尝试创建一天前的文件的报告，我目前有一个包含文件名和日期的脚本：

```
get-childitem -Path \\UNC_PATH_TO_FILE
         | where-object {$_.lastwritetime -gt (get-date).addDays(-1)}
         | Foreach-Object { $_.Name, $_.CreationTime } 
```

以前我将它导出到每个 UNC 路径的文件中，但是现在它已经增长，将导致读取 22 个单独的文件。

我想将其合并到一个 CSV 文件中，该文件可以包含**Server**、**Filename** ( `$_.Name`) 和**Date** ( `$_.CreationTime`) 的 coll 。

这超出了我的 Powershell 领域，找不到任何可以真正帮助我的东西。有人可以提供一些帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:28:07.033

你可以试试这个：

```
$paths = "\\server1\unc\path", "\\server1\unc\path" 
Get-ChildItem -Path $paths
         | Where-Object {$_.lastwritetime -gt (Get-Date).addDays(-1)}
         | Select-Object @{n="Server";e={([uri]$_.FullName).Host}},
                         @{n="Filename";e={$_.Name}},
                         @{n="Date";e={$_.CreationTime}},
                         @{n="FileSize(MB)";e={[Math]::Round($_.Length/1MB,3)}}
         | Export-Csv test.csv -NoTypeInformation 
```

它从 UNC 路径中提取服务器名称，并使用您指定的名称重命名其他属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:23:56.460

这是一个为每个文件创建一个新对象的示例：

```
Get-ChildItem -Path \\UNC_PATH_TO_FILE |
Where-Object {$_.LastWriteTime -gt (Get-Date).AddDays(-1)} | 
ForEach-Object { 
    New-Object PSObject -Property @{
        Server = $_.FullName -replace '^\\\\([\w]+)\\.+$','$1'
        Name = $_.Name
        CreationTime = $_.CreationTime    
    }
} | Export-Csv -Path files.csv -NoTypeInformation 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:29:02.913

以下应该有效：

```
get-childitem -Path \\UNC_PATH_TO_FILE
         | where { $_.lastwritetime -gt (get-date).AddDays(-1)} 
         | foreach-object { $env.COMPUTERNAME,$_.Name, $_.CreationTime}
         | Export-Csv -Path foo.txt -NoTypeInformation 
```

# html - 样式化输入文件 Firefox？

> ID：14485391
> 
> 赞同：2
> 
> 时间：2013-01-23T17:10:31.903
> 
> 标签：html, css, google-chrome, firefox, input

> **可能重复：**
> [设置输入类型=“文件”按钮的样式](https://stackoverflow.com/questions/572768/styling-an-input-type-file-button)

我试图设置输入文件的样式。

它适用于 Chrome 和 Safari，但不适用于 Firefox。

CSS：

```
input[type="file"] {
   position: absolute; 
   padding: 0px; 
   width: 100%!important; 
   height: 220px; 
   background: #000; 
   top: 0;
   z-index: 3000;
} 
```

HTML：

```
<input type="file" multiple="multiple" name="uploadfile[]" /> 
```

铬合金 ：

![在此处输入图像描述](../Images/f0eed6e8c6ff6d81db10a4d7fa34b964.png)

火狐： ![在此处输入图像描述](../Images/4987615318f0615e68a04253ef9466c0.png)

请问有火狐的解决方案吗？

谢谢

# python - read() python 后奇怪的字符串格式

> ID：14485395
> 
> 赞同：0
> 
> 时间：2013-01-23T17:10:39.493
> 
> 标签：python, string, hex

我正在尝试使用 Python 读取文件

```
open('/Desktop/test.csv','rb').read()[1:15] 
```

我得到了类似的回报：

```
'\xfeY\x00!\x00B\x00L\x00-\x00 \x00B' 
```

即使当我在文本编辑器中打开 test.csv 时，它也是可读的字符串格式。有谁知道这是什么格式以及如何将其转换回字符串字符？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:13:37.563

该文件使用 UTF-16 编码。

```
>>> open('/Desktop/test.csv', 'r', encoding='UTF-16').read(7)
'Y!BL- B' 
```

或者，如果您仍在使用较旧的 Python 版本，

```
>>> import codecs
>>> codecs.open('/Desktop/test.csv', 'r', encoding='UTF-16').read(7)
u'Y!BL- B' 
```

另请注意，Python 使用从零开始的索引，与大多数其他语言（C、Java、C#、JavaScript 等）一样

```
>>> 'abcdefghijklmnopqrstuvwxyz'[1:15]
'bcdefghijklmno' # Omits the 'a', which is at index 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:11:18.967

这没有什么奇怪的，一切都很好。Python 使用`\x00`转义序列来表示不可打印的字符：

```
>>> '\x00'
'\x00'
>>> len('\x00')
1
>>> '\x65'
'e' 
```

注意十六进制字符 65 是如何打印为`e`; 毕竟它是一个可打印的 ASCII 字母。

您的数据可能被编码为不同于 ASCII 的东西；例如，尝试使用 UTF-16 对其进行解码。对我来说，前 1 个字节看起来像 UTF-16 BOM 的第二个字节：

```
>>> import codecs
>>> codecs.BOM_UTF16
'\xff\xfe' 
```

# html - 如何修复不同浏览器中的垂直间距变化？

> ID：14485397
> 
> 赞同：1
> 
> 时间：2013-01-23T17:11:00.387
> 
> 标签：html, css, internet-explorer, google-chrome, firefox

我有一小段代码在我的win7机器上的firefox、chrome和ie9中以完全不同的垂直间距进行渲染。

```
<div id="main-compo">
                <div id="divisions" class="transparent">
                    <p><a href="#">p1</a></p>
                    <p><a href="#">p2</a></p>
                    <p><a href="#">p3</a></p>
                    <p><a href="#">p4</a></p>
                    <p><a href="#">p5</a></p>
                    <p><a href="#">p6</a>
                    <p style="border-bottom: none;"><a href="#">p7</a></p>
                </div></div> 
```

[http://jsfiddle.net/erea/96KBC/](http://jsfiddle.net/erea/96KBC/)

我已经为此工作了一个多小时，但我仍然不知道为什么。任何帮助都会很棒，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T08:30:57.310

发现`line-height`是问题所在。

添加了这个，现在一切都很完美。

```
body {
    line-height: 1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:14:42.397

尝试

```
p {
    vertical-align: top;
} 
```

# windows - 了解 Camtasia Studio 十六进制数据

> ID：14485400
> 
> 赞同：1
> 
> 时间：2013-01-23T17:11:09.860
> 
> 标签：windows, hex

Camtasia Studio 是一个用于录制屏幕截图的软件包。它做的一件事，就是将鼠标移动坐标与屏幕视频分开记录。这样做是为了让您在完成录制后可以修改光标的外观。

录制屏幕后，它可以选择导出捕获的原始组件。其中一个文件包含看起来像这样的光标坐标...

```
4556 5453 0300 0000 0c00 0000 0c00 0000
ca00 0000 0c00 0000 0100 0000 0000 0000
8002 0000 e001 0000 1900 0000 cb00 0000
1900 0000 0100 0000 0000 0000 000c 0259
0000 0059 0014 0000 00e0 e8ab 096a 032d
08b8 0100 00c8 0000 0008 0000 0037 0000
00b0 feff feff 0328 02d2 0100 00f0 0328
02d2 0100 00f1 0329 02e0 0100 00f2 032a
02e0 0100 00f5 032b 02ed 0100 00f8 032d
02ed 0100 00fb 032f 02fa 0100 0001 0432
02fa 0100 0007 0435 0208 0200 000e 043a
0208 0200 0018 043f 0215 0200 0023 0445
0215 0200 002e 044a 0215 0200 0039 0450
0215 0200 0046 0455 0215 0200 004f 0458
0215 0200 0056 045a 022c 0200 005d 045e
022c 0200 0063 0462 0242 0200 0068 0465
0242 0200 006f 046b 0258 0200 0072 046f
0258 0200 0079 0476 0280 0200 0082 047d
0280 0200 0089 0484 028c 0200 0091 048a
028c 0200 0098 0494 029a 0200 009e 049c
029a 0200 00a3 04a0 029a 0200 00a7 04a3
029a 0200 00aa 04a6 02aa 0200 00af 04ab
02bc 0200 00b2 04ae 02bc 0200 00b4 04b3
02bc 0200 00b8 04b7 02cc 0200 00be 04bd
02cc 0200 00c1 04bf 02dd 0200 00c3 04c1
02dd 0200 00c6 04c4 02f8 0200 00c9 04c6
02f8 0200 00cb 04c8 0205 0300 00cc 04c9
0213 0300 00cd 04c9 0213 0300 00cd 04ca
0220 0300 00ce 04cb 0221 0300 00ce 04cc
0221 0300 00ce 04cd 0236 0300 00ce 04ce
0236 0300 00cd 04cf 024d 0300 00cc 04d0
024d 0300 00cc 04d1 0262 0300 00cb 04d2
0262 0300 00cb 04d3 0279 0300 00ca 04d3
02a5 0300 00c9 04d3 0218 0000 0002 0000
000c 0000 0002 0000 0000 0000 0081 0404
0487 06a5 04a5 0300 00f8 0304 0487 06ba
040a 0000 0003 0000 000a 0000 0001 0000
0000 0000 0000 0008 0009 000c 0000 0001
0000 000c 0000 0001 0000 0000 0000 00ff
033b 027f 061b 040c 0000 0005 0000 000c
0000 0001 0000 0000 0000 0000 0000 00ff
ffff ff0c 0000 0004 0000 000c 0000 0001
0000 0000 0000 0001 0000 0000 0000 001c
0000 002d 0100 001c 0000 0001 0000 0090
0300 0000 0100 0079 0000 0044 0000 0000
0000 0000 0000 0000 0000 00

```

这是来自 1 秒的录音。屏幕截图大小为 640x480。我将鼠标从左上角移动到右下角。

所以这是我的问题。有没有办法将此信息转换为视频的时间和 X、Y 坐标？我想我只是不明白这个符号，但我想将此信息用于我自己的项目。任何人都可以理解这些数据吗？

# ruby - ruby google sketchup 插件 - 从目录导入纹理

> ID：14485406
> 
> 赞同：1
> 
> 时间：2013-01-23T17:11:28.640
> 
> 标签：ruby, directory, textures, sketchup

我是新来的，对红宝石来说几乎是全新的。我正在使用 ruby​​ 使用 Sketchup 模块编写 Sketchup 插件，我想从目录 'C:\Users\(your name)\Pictures\sketchup-textures' 导入所有图像文件（纹理）并将它们放入SketchUp 中的材料列表，以便我可以将它们放到我的模型中。

我知道有一种手动执行此操作的方法，但我经常需要一次处理很多纹理，并且想要自动化处理。谢谢！

编辑：我知道我可以做到这一点，但它一次只做一个文件，而且只有一个我编码。

```
m = materials.add "test1"
m2 = materials.add "test2"
m.texture = "c:\\Users\\(yourname)\\Pictures\\(file).png"
m2.texture = "c:\\Users\\(yourname)\\Pictures\\(file).jpg"
texture = m.texture = "c:\\Users\\(yourname)\\Pictures\\(images).png"
if (texture)
  UI.messagebox texture
else
  UI.messagebox "Failure"
end 
```

# ruby-on-rails - 路由规范中的动态方法调用

> ID：14485416
> 
> 赞同：1
> 
> 时间：2013-01-23T17:11:59.077
> 
> 标签：ruby-on-rails, dynamic, methods, rspec

我正在我的 Rails 3.2 应用程序中使用 rspec 测试对我的路由的简单获取请求。由于所有都是 get 请求，并且都只是具有与视图名称相似的不同操作名称，因此为每个 get 请求手动编写不同的测试确实是重复的。

相反，我想想出这样的东西：

```
%(action_1 action_2 action_3 action_4).each do |action|
    it "routes to the #{action} page" do
        get("liver_diseases#{action}_path").should route_to("liver_diseases##{action}")
    end
end 
```

它在这个伪代码上失败了：`get("liver_diseases_#{action}_path")` 所以我需要做的是一个动态方法调用 - 但对于我发现的，这将涉及`.send(:method_name)`，为此我需要知道类名。我找不到那个。

我需要做什么才能使此方法调用起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:18:12.513

> 这将涉及 .send(:method_name)，为此我需要知道类名

当接收器丢失时，它总是`self`. 在控制器示例的上下文中，`self`应该是控制器实例。因此，您应该能够通过以下方式获得该路径：

```
send "liver_diseases_#{action}_path" 
```

这应该相当于：

```
controller.send "liver_diseases_#{action}_path" 
```

# ios - 从 UIObject 中移除 UIGesturerecognizer

> ID：14485419
> 
> 赞同：0
> 
> 时间：2013-01-23T17:12:18.873
> 
> 标签：ios

有没有办法从任何 UIObject（如 UItextView）中完全删除所有 UIGestureRecognisers？我试过这个但它不起作用：

```
[photoView removeGestureRecognizer:[photoView.gestureRecognizers objectAtIndex:0]]; 
```

注意：我不想禁用它们，因为我想在将来分配其他手势识别器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:38:03.987

如果要删除所有内容，而不仅仅是：

```
[photoView removeGestureRecognizer:[photoView.gestureRecognizers objectAtIndex:0]]; 
```

你可以：

```
while ([photoView.gestureRecognizers count] > 0)
    [photoView removeGestureRecognizer:[photoView.gestureRecognizers objectAtIndex:0]]; 
```

顺便说一句，请注意，一些标准文本控件会在您进入和退出编辑模式时重新创建手势识别器，因此您可能必须相应地重复此过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:17:11.330

使用以下代码停止任何手势识别器。

```
 - (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch
    {

    // return NO when you want to stop.

if ( [gestureRecognizer isMemberOfClass:[UITapGestureRecognizer class]] ) {
        // Return NO for views that don't support Taps
    } else if ( [gestureRecognizer isMemberOfClass:[UISwipeGestureRecognizer class]] ) {
        // Return NO for views that don't support Swipes
    }

    return YES;

} 
```

# android - Android：定义 onDraw 画布大小

> ID：14485420
> 
> 赞同：2
> 
> 时间：2013-01-23T17:12:25.267
> 
> 标签：android, android-layout, android-canvas, ondraw

我现在已经删除了我的旧代码，因为它没有按我的预期工作。我试图在屏幕的某个部分使用 onDraw 画布功能，这样我的绘图周围仍然可以有按钮和其他文本。

**********编辑****** ******

 **我现在已经设法解决了这个问题。很多建议很有帮助，但我无法让它与我想要的一起工作。这可能是我的错，所以感谢所有提供建议的人。这是我解决问题的方法。

*1。首先在布局文件中定义一个视图。

```
<view
class="com.project.MainActivity.Drawing"
android:id="@+id/drawing_area"
android:layout_width="700dp"
android:layout_height="900dp"
android:layout_centerInParent="true"/> 
```

*2。然后使用以下代码创建一个单独的 java 类文件：

```
public class Drawing extends View {
Paint paint = new Paint();

public Drawing(Context context) {
super(context);
}

public Drawing(Context context, AttributeSet attrs) {
super(context, attrs);
}   

@Override
protected void onDraw(Canvas canvas) {  
super.onDraw(canvas);

//Draw Image Here//

} 
```

*3。然后从主要活动中调用绘图：

```
public class MainActivity extends Activity {

private Drawing mDrawingArea;

@Override
public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.percentage_count_layout);
  mDrawingArea = (Drawing)findViewById(R.id.drawing_area);  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:31:43.487

在您的 View 类中，您需要覆盖 onMeasure() 方法。这是您要求特定视图大小的地方。有一些关于这个主题的官方 Android 教程，一旦我在我的计算机上使用链接，我将编辑这篇文章。

编辑：

看看[这篇关于创建自定义组件的 Android 文章。](http://developer.android.com/guide/topics/ui/custom-components.html). 具体看一下标题为“扩展 onDraw() 和 onMeasure()”的部分。报价：

> `onMeasure()`涉及更多一点。`onMeasure()`是组件与其容器之间渲染契约的关键部分。`onMeasure()`应该被覆盖以有效和准确地报告其包含的部分的测量值。由于父级的限制要求（传递给方法）以及在计算出测量的宽度和高度后`onMeasure()`调用方法的要求，这使得这稍微复杂一些。`setMeasuredDimension()`如果您未能从覆盖的方法调用此方法`onMeasure()`，则结果将在测量时出现异常。

进一步在文章中：

> **您的组件的`onMeasure()`方法应该计算渲染组件所需的测量宽度和高度。它应该尽量保持在传入的规范内**，尽管它可以选择超过它们（在这种情况下，父级可以选择做什么，包括剪辑、滚动、抛出异常或要求`onMeasure()`重试，也许有不同的测量规范）。

有一个 CustomView 示例可用作演示，但不幸的是，开发人员网站已更改（更糟！）因此它不可用，除非通过 SDK 管理器下载。有关更多说明，请参阅[此处的页面。](http://developer.android.com/resources/samples/ApiDemos/index.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-11-22T08:32:09.190

例如，200 宽，150 高。覆盖视图中的 onMeasure 方法。

```
 @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        setMeasuredDimension(200, 150);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T17:41:48.667

根据您的描述，问题似乎在于您没有指定 DemoView 的大小，您只是将其设置为 ContentView，默认情况下将填充父级。

在创建 DemoView 时指定一些[LayoutParams ，或者创建一个 ViewGroup 来给它一个大小。](http://developer.android.com/reference/android/view/ViewGroup.LayoutParams.html)

您还可以通过 XML 定义布局/调整大小，然后对其进行扩展。（在这种情况下，您应该将其设为单独的类，或者将其公开。）例如。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    ...
    Specify container measurements
    ...
    >
    <com.yourpackagename.MainActivity.DemoView
    ...
    Specify layout height / width, etc.
    ...
    />
</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:37:39.730

在 Android 中，您尝试执行的布局通常在 xml 中指定。这个想法是您在 xml 中设置布局（项目中的 res/ 目录中应该有一个布局目录），然后将您的代码连接到该布局。

看看[这个](http://developer.android.com/guide/topics/ui/declaring-layout.html)页面。如果你向下滚动，会有一个关于布局位置、大小和填充的部分。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T17:33:20.177

您正在使用 setContentView() 这本身意味着整个视图是全屏的。如果您希望图像仅设置为特定大小，则需要以这种方式绘制。

```
onDraw(Canvas canvas)
{
     super.onDraw(canvas)
     //This code is for straight centering
     //Also please do math outside of onDraw
     //also below math is pseudocode not actual android code
     canvas.drawBitmap(yourImageBitmap, 
         (screenSize.width / 2) - yourImageBitmap.width/2, 
         (screenSize.height / 2) - yourImageBitmap.height / 2),
         yourPaintObject)

    //The above code should draw your bitmap image in the center of the canvas

} 
```

就像我上面和下面的答案一样，如果您想更改画布大小，那么您需要使用 onMeasure 并正确设置它们。您最好的选择是查看 ImageView 类的源代码[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/1.5_r4/android/widget/ ImageView.java](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/1.5_r4/android/widget/ImageView.java) 看看他们是怎么做的

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-24T00:51:09.487

这是一种您可以在视图中覆盖以获取屏幕设备信息的方法，每个设备执行一次

```
 @Override
public void onSizeChanged (int w, int h, int oldw, int oldh)
{
    super.onSizeChanged(w, h, oldw, oldh);
    screenW = w;
    screenH = h;

    scaledCardW = (int) (screenW/8); //or whatever scale you need for bitmaps
    scaledCardH = (int) (scaledCardW*1.28);
    bitmap = // load your bitmaps

} 
```**

# c# - Windows Phone - 将视图绑定到视图模型

> ID：14485422
> 
> 赞同：1
> 
> 时间：2013-01-23T17:12:30.357
> 
> 标签：c#, mvvm, windows-phone

所以，我正在学习 Windows Phone 的 MVVM 模式，并坚持如何将 View 绑定到我的 ViewModel。我现在构建的应用程序正在获取当前和未来 5 天的天气，并使用 UserControl 将其显示到 MainPage.xaml 上的我的全景项目之一。

我不能简单地设置**Forecasts.ItemsSource = forecast;** 在我的 WeatherViewModel 中，它表示当前上下文中不存在预测（ **WeatherView中的列表框元素名称）。**

谁能教我怎么绑定？并且任何人都有一个很好的源/示例示例到 windows-phone 中的 mvvm 模式？之前谢谢。

**编辑：**

**天气模型.cs**

```
namespace JendelaBogor.Models
{
    public class WeatherModel
    {
        public string Date { get; set; }
        public string ObservationTime { get; set; }
        public string WeatherIconURL { get; set; }
        public string Temperature { get; set; }
        public string TempMaxC { get; set; }
        public string TempMinC { get; set; }
        public string Humidity { get; set; }
        public string WindSpeedKmph { get; set; }
    }
} 
```

**WeatherViewModel.cs**

```
namespace JendelaBogor.ViewModels
{
    public class WeatherViewModel : ViewModelBase
    {
        private string weatherURL = "http://free.worldweatheronline.com/feed/weather.ashx?q=";
        private const string City = "Bogor,Indonesia";
        private const string APIKey = "APIKEY";

        private IList<WeatherModel> _forecasts;
        public IList<WeatherModel> Forecasts
        {
            get 
            {
                if (_forecasts == null)
                {
                    _forecasts = new List<WeatherModel>();
                }

                return _forecasts;
            }

            private set
            {
                _forecasts = value;

                if (value != _forecasts)
                {
                    _forecasts = value;
                    this.NotifyPropertyChanged("Forecasts");
                }
            }
        }

        public WeatherViewModel()
        {
            WebClient downloader = new WebClient();
            Uri uri = new Uri(weatherURL + City + "&num_of_days=5&extra=localObsTime&format=xml&key=" + APIKey, UriKind.Absolute);
            downloader.DownloadStringCompleted += new DownloadStringCompletedEventHandler(ForecastDownloaded);
            downloader.DownloadStringAsync(uri);
        }

        private void ForecastDownloaded(object sender, DownloadStringCompletedEventArgs e)
        {
            if (e.Result == null || e.Error != null)
            {
                MessageBox.Show("Cannot load Weather Forecast!");
            }

            else
            {
                XDocument document = XDocument.Parse(e.Result);
                var current = from query in document.Descendants("current_condition")
                                     select new WeatherModel
                                     {
                                         ObservationTime = DateTime.Parse((string)query.Element("localObsDateTime")).ToString("HH:mm tt"),
                                         Temperature = (string)query.Element("temp_C"),
                                         WeatherIconURL = (string)query.Element("weatherIconUrl"),
                                         Humidity = (string)query.Element("humidity"),
                                         WindSpeedKmph = (string)query.Element("windspeedKmph")
                                     };             

                this.Forecasts = (from query in document.Descendants("weather")
                                       select new WeatherModel
                                       {
                                           Date = DateTime.Parse((string)query.Element("date")).ToString("dddd"),
                                           TempMaxC = (string)query.Element("tempMaxC"),
                                           TempMinC = (string)query.Element("tempMinC"),
                                           WeatherIconURL = (string)query.Element("weatherIconUrl")
                                       }).ToList();
            }
        }
    }
} 
```

**WeatherView.xaml**

```
<UserControl x:Class="JendelaBogor.Views.WeatherView"
    xmlns:vm="clr-namespace:JendelaBogor.ViewModels">

    <UserControl.DataContext>
         <vm:WeatherViewModel />
    </UserControl.DataContext>

    <Grid Margin="0,-10,0,0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Grid x:Name="Current" Grid.Row="0" Height="150" VerticalAlignment="Top">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Image Grid.Column="0" delay:LowProfileImageLoader.UriSource="{Binding WeatherIconURL}" Width="120" Height="120" VerticalAlignment="Top"/>
            <StackPanel Grid.Column="1" Height="200" VerticalAlignment="Top">
                <TextBlock Text="{Binding Temperature}" FontSize="22"/>
                <TextBlock Text="{Binding ObservationTime}" FontSize="22"/>
                <TextBlock Text="{Binding Humidity}" FontSize="22"/>
                <TextBlock Text="{Binding Windspeed}" FontSize="22"/>
            </StackPanel>
        </Grid>

        <Grid Grid.Row="1" Height="300"  VerticalAlignment="Bottom" Margin="10,0,0,0">
            <StackPanel VerticalAlignment="Top">
                <StackPanel Height="40" Orientation="Horizontal" Margin="0,0,0,0">
                    <TextBlock Text="Date" FontSize="22" Width="170"/>
                    <TextBlock Text="FC" FontSize="22" Width="60"/>
                    <TextBlock Text="Max" TextAlignment="Right" FontSize="22" Width="90"/>
                    <TextBlock Text="Min" TextAlignment="Right" FontSize="22" Width="90"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal">
                    <ListBox ItemsSource="{Binding Forecasts}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Height="40" Orientation="Horizontal" Margin="0,10,0,0">
                                    <TextBlock Text="{Binding Date}" FontSize="22" TextAlignment="Left" Width="170" />
                                    <Image delay:LowProfileImageLoader.UriSource="{Binding WeatherIconURL}" Width="40" Height="40" />
                                    <TextBlock Text="{Binding TempMaxC, StringFormat='\{0\} °C'}" TextAlignment="Right" FontSize="22" Width="90" />
                                    <TextBlock Text="{Binding TempMinC, StringFormat='\{0\} °C'}" TextAlignment="Right" FontSize="22" Width="90" />
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl> 
```

**主页.xaml**

```
<controls:PanoramaItem x:Name="Weather" Header="weather">
    <views:WeatherView />
</controls:PanoramaItem> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:27:20.203

您需要告诉视图您正在使用什么视图模型。通过添加

```
<UserControl
    xmlns:vm="clr-namespace:JendelaBogor.ViewModels">

    <UserControl.DataContext>
       <vm:WeatherViewModel />
    </UserControl.DataContext>

</UserControl> 
```

所有`{Binding}`的都映射到类`WeatherViewModel`。按照 Reed 的建议，通过使用`ItemsSource`列表框上的属性，您可以绑定通过属性公开的列表中的所有项目。

如果在运行应用程序时列表发生更改，请考虑使用`ObservableCollection`并清除它并在收到新数据时添加所有新项目。如果你这样做了，你的 GUI 将简单地更新它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:19:32.883

ViewModel 不知道视图。

您需要`Forecasts`在 ViewModel 上创建一个属性，并将 ItemsSource 从您的视图绑定到它。在您看来，将其更改`ListBox`为：

```
<!-- No need for a name - just add the binding -->
<ListBox ItemsSource="{Binding Forecasts}"> 
```

然后，在您的 ViewModel 中，添加：

```
// Add a backing field
private IList<WeatherModel> forecasts;

// Add a property implementing INPC
public IList<WeatherModel> Forecasts 
{ 
    get { return forecasts; }
    private set
    {
        forecasts = value;
        this.RaisePropertyChanged("Forecasts");
    }
} 
```

然后，您可以在您的方法中设置它：

```
 this.Forecasts = (from query in document.Descendants("weather")
                             select new WeatherModel
                             {
                                 Date = DateTime.Parse((string)query.Element("date")).ToString("dddd"),
                                 TempMaxC = (string)query.Element("tempMaxC"),
                                 TempMinC = (string)query.Element("tempMinC"),
                                 WeatherIconURL = (string)query.Element("weatherIconUrl")
                             })
                 .ToList(); // Turn this into a List<T> 
```

# excel - 组所有所有者的 LDAP 查询

> ID：14485424
> 
> 赞同：1
> 
> 时间：2013-01-23T17:12:36.860
> 
> 标签：excel, vba, active-directory, ldap, active-directory-group

## 问题

我需要编写一个 LDAP 查询，给定一个`distinguishedName`for a`group`将返回一个列表，其中列出了所有`users`的所有者/管理者`group`

### 动机

我正在编写一个 VBA 脚本，该脚本将允许 excel 用户在单元格中输入 a`DisplayName`并`group`按下按钮以接收（1）成员列表和（2）单独的组所有者列表。

### 进步

第一部分工作正常。我在目录中搜索在其[字段](https://stackoverflow.com/questions/7187994/memberof-vs-groupmembership-in-ldap-liferay)[中拥有该组的所有用户。`memberof`](https://stackoverflow.com/questions/7187994/memberof-vs-groupmembership-in-ldap-liferay)

对于所有者，我成功拉取了组的`managedBy`字段，但它只包含单个用户的信息。当在 Outlook 的通讯簿中查看该组时，该用户与“所有者”字段中显示的用户相同。还有更多拥有该列表所有权权限的用户。

## 例子

这是我现在使用的两个（稍作修改）查询：

### 查询1：组成员（作品）

```
<LDAP://dc=DOMAIN,dc=com>;(&(memberof=CN=GroupName));DisplayName;Subtree 
```

### 查询 2：Group Owners（返回单个用户）

```
<LDAP://dc=DOMAIN,dc=com>;(&(objectCategory=group)(DisplayName="Group Name"));managedBy;Subtree 
```

## 问题

如何修改查询 2 以返回对组具有管理权限的所有用户？

## 相关问题

# vb.net - 打印一页 WebBrowser

> ID：14485427
> 
> 赞同：1
> 
> 时间：2013-01-23T17:12:43.147
> 
> 标签：vb.net, winforms, automation, webbrowser-control, printdocument

我正在尝试自动打印 Intranet 网站。由于这是一个将放置在特定用户计算机上的应用程序，它将根据需要运行，我希望它尽可能不中断（换句话说，不为每个页面启动 IE ）。问题是我需要打印网站的第一页，然后再次打印整个网站，这将产生两次第一页。做这个的最好方式是什么？

让它循环浏览它需要打印的页面没有问题，我也没有使用 webbrowser 打开页面的问题。但是，我确实在指定打印范围时遇到了问题。

我也尝试过 PrintDocument，但不知道如何在表单中打开它。

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T20:43:18.023

要下载 pdf 文件，请使用 iTextSharp 尝试此解决方案： [ITextSharp HTML to PDF?](https://stackoverflow.com/questions/2822843/itextsharp-html-to-pdf)

如果您想直接保存到文件中，除非有一个替换

```
private MemoryStream createPDF(string html)
{
    MemoryStream msOutput = new MemoryStream();
    TextReader reader = new StringReader(html);

    // step 1: creation of a document-object
    Document document = new Document(PageSize.A4, 30, 30, 30, 30);            

    // step 2:
    // we create a writer that listens to the document
    // and directs a XML-stream to a file
    PdfWriter writer = PdfWriter.GetInstance(document, new FileStream("c:\\my.pdf", FileMode.Create));

    // step 3: we create a worker parse the document
    HTMLWorker worker = new HTMLWorker(document);

    // step 4: we open document and start the worker on the document
    document.Open();
    worker.StartDocument();

    // step 5: parse the html into the document
    worker.Parse(reader);

    // step 6: close the document and the worker
    worker.EndDocument();
    worker.Close();
    document.Close();

    return msOutput;
} 
```

设置 PDF 后，尝试使用 ghostscript 打印一页： [Print existing PDF (or other files) in C#](https://stackoverflow.com/questions/273675/print-existing-pdf-or-other-files-in-c-sharp)

如果您启动进程的 shell 执行，您可以使用命令行参数：

```
gsprint "filename.pdf" -from 1 - to 1 
```

或者，WebBrowser 可以只打印整个页面：http: [//msdn.microsoft.com/en-us/library/b0wes9a3.aspx](http://msdn.microsoft.com/en-us/library/b0wes9a3.aspx)

我找不到任何引用 WebBrowser 本身可以在没有打印对话框的情况下打印“从 X 页到 Y”的内容。

由于我面临类似的问题，这里有一个替代解决方案：

这个开源项目将 HTML 文档转换为类似于 iTextSharp ( [http://code.google.com/p/wkhtmltopdf/](http://code.google.com/p/wkhtmltopdf/) ) 的 PDF 文档。我们最终没有使用 iTextSharp，因为我们想要打印的网站的布局方式存在一些格式问题。我们发送命令行参数以将使用 web 客户端下载的 html 转换为 pdf 文件。

```
WebClient wc = new WebClient();
wc.Credentials = CredentialCache.DefaultNetworkCredentials;
string htmlText = wc.DownloadString("http://websitehere.com); 
```

然后，转到pdf后，您可以简单地打印文件：

```
Process p = new Process();
p.StartInfo.FileName = string.Format("{0}.pdf", fileLocation);
p.StartInfo.Verb = "Print";
p.Start();
p.WaitForExit(); 
```

（对于 C# 道歉，我比 VB.NET 更熟悉它，虽然它应该是一个简单的转换）

# objective-c - 计算实际当天的午夜日期

> ID：14485428
> 
> 赞同：0
> 
> 时间：2013-01-23T17:12:50.417
> 
> 标签：objective-c, nsdate, nsdateformatter, date-formatting

> **可能重复：**
> [将日期从 [NSDate 日期] 缩短几个小时](https://stackoverflow.com/questions/8466744/getting-date-from-nsdate-date-off-by-a-few-hours)

我想使用实际日期计算实际当天的午夜时间，代码如下：

```
NSDateFormatter *formatter = [[NSDateFormatter alloc]init];
    [formatter setDateFormat:@"dd/MM/yyyy"];
 NSDate *today = [NSDate date];
    NSString *todayStr = [NSString stringWithFormat:@"%@ 12:59 PM",[formatter stringFromDate:today]];
NSLog(@"%@",todayStr);
[formatter setDateFormat:@"dd/MM/yyyy hh:mm a"];
NSDate *midNight = [formatter dateFromString:todayStr];
NSLog(@"%@",midNight); 
```

但我得到的日志是：

```
23/01/2013 12:59 PM
2013-01-23 10:59:00 +0000 
```

为什么`midNight`不是实际的午夜，为什么它的格式与 不同`formatter`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:17:17.773

您使用日期格式化程序计算的午夜将本地化考虑在内。

因此，您生活在 UTC+2 时区。

您可以为 UTC 添加一个“Z”。

[在http://www.w3.org/TR/NOTE-datetime](http://www.w3.org/TR/NOTE-datetime)查看更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:30:05.593

这将计算您当地时区的午夜。

```
NSDate *d = [NSDate date];
NSCalendar *cal = [NSCalendar currentCalendar];
NSDateComponents *comps = [cal components:NSEraCalendarUnit|NSYearCalendarUnit|NSMonthCalendarUnit|NSDayCalendarUnit fromDate:d];
d = [cal dateFromComponents:comps];
NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
[formatter setDateFormat:@"dd/MM/yyyy hh:mm a"];
NSString *dateStr = [formatter stringFromDate:d];
NSLog(@"%@", dateStr); 
```

打印 23/01/2013 12:00 AM

# java - Matlab 结构和 Java LinkedList

> ID：14485432
> 
> 赞同：3
> 
> 时间：2013-01-23T17:12:55.437
> 
> 标签：java, matlab, struct, queue

我正在关注[这个答案](https://stackoverflow.com/questions/4142190/is-there-a-queue-in-matlab)，在 matlab 中实现一个队列。

但与答案不同的是，我不是在排队`strings`，而是在排队`structs`。这是我的示例代码

```
import java.util.LinkedList;
queue = LinkedList();
queue.add(struct('f', f, 'A', A)) % f and A are matrices 
```

但这给了我一个错误

```
No method 'add' with matching signature found for class 'java.util.LinkedList'. 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T20:03:06.047

MATLAB 与 Java 有着非常密切的联系，它可以自动将许多 MATLAB 本地数据类型与它们的 Java 对应物相互转换……除了结构。如果您考虑一下，这是有道理的：有一种自然的方式来映射 POD 类型和 POD 类型的数组，甚至元胞数组也自然地映射到 java.lang.Object 数组。但是创建结构的 Java 表示将需要相应的类定义。有关详细信息，请参阅[此 MATLAB 文档](http://www.mathworks.com/help/matlab/matlab_external/passing-data-to-a-java-method.html)。

因此，将 MATLAB 结构存储在 Java 容器中将需要一些额外的，可能是第三方代码。相反，你想做什么？根据您的要求（即，您希望队列获得多大等），使用简单的单元格数组实现队列可能非常好：

```
>> queue = {}; % create empty queue
>> queue{end+1} = x; % push x onto queue
>> q(1) = []; % pop top element from queue 
```

但是一系列的推动将花费二次时间，对吗？是的...但是 O(n^2) 上的常数非常小，因此该实现将在速度上击败许多其他非 MEXed 实现。

# mpi - 嵌套循环中的 MPI 调用和接收

> ID：14485436
> 
> 赞同：1
> 
> 时间：2013-01-23T17:13:02.193
> 
> 标签：mpi

我有一个嵌套循环，从循环内部我调用 MPI 发送，我希望它发送给接收器一个特定的值，然后在接收器获取数据并再次将 MPI 消息发送到另一组 CPU ......我使用了一些东西像这样，但看起来接收中有问题......我看不出我哪里出错了......“机器在某处进入无限循环......

我试图让它像这样工作：主 CPU >> 发送到其他 CPU >> 发送到从 CPU

```
 . 
 . 
 . 

 int currentCombinationsCount; 
 int mp; 

 if (rank == 0)
 {

     for (int pr = 0; pr < combinationsSegmentSize; pr++)
     {
         int CblockBegin = CombinationsSegementsBegin[pr];
         int CblockEnd   = CombinationsSegementsEnd  [pr];
         currentCombinationsCount = numOfCombinationsEachLoop[pr]; 
         prossessNum = 1; //specify which processor we are sending to 

         // now substitute and send to the main Processors 
         for (mp = CblockBegin; mp <= CblockEnd; mp++)
         {

             MPI_Send(&mp , 1, MPI_INT   , prossessNum, TAG, MPI_COMM_WORLD);

             prossessNum ++; 
         }

     }//this loop goes through all the specified blocks for the combinations  
 } // end of rank 0
 else if (rank > currentCombinationsCount)
 {
       // here I want to put other receives that will take values from the else below 
 }
 else 
 {
     MPI_Recv(&mp , 1, MPI_INT   , 0, TAG, MPI_COMM_WORLD, &stat);
     // the code stuck here in infinite loop 
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T10:05:15.453

您只`currentCombinationsCount`在`if(rank==0)`分支中进行了初始化，因此所有其他 proc 将看到一个未初始化的变量。这将[导致未定义的行为](https://stackoverflow.com/questions/1597405/what-happens-to-a-declared-uninitialized-variable-in-c-does-it-have-a-value)，结果取决于您的编译器。您的程序可能会崩溃，或者该值可能设置为 0 或未确定的值。

如果幸运的话，[该值可能会设置为 0](http://ideone.com/62Cm20)，在这种情况下，您的分支会减少到：

```
if (rank == 0) {  /* rank == 0 will enter this } 
else if (rank > 0) { /* all other procs enter this }
else { /* never entered! Recvs are never called to match the sends */ } 
```

因此，您最终会得到与任何接收都不匹配的发送。由于[`MPI_Send`可能会阻塞](http://www.mcs.anl.gov/research/projects/mpi/sendmode.html)，因此发送过程可能会无限期停止。使用 procs 阻止发送，它当然可以看起来像*“......机器在某处进入无限循环......”*。

如果`currentCombinationsCount`给定一个任意值（而不是 0），则`rank!=0`procs 将进入任意分支（所有进入 final 的机会更高`else`）。然后，您最终会收到未调用第二组接收，从而导致与上述相同的问题。

# c# - 如何即时更改xml字符串值

> ID：14485437
> 
> 赞同：0
> 
> 时间：2013-01-23T17:13:04.410
> 
> 标签：c#, xml, string

我有一个 xml 响应字符串，我想更改里面的值并记录它。

```
<xml>
<ns2:abcd>
<password>sample</password>
</ns2:abcd> 
```

我想将密码值更改为加密版本。

我尝试过使用`XmlDocument.SelectSingleNode`，但在想有没有比这更好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:14:42.853

顺便说一句，您需要`ns2`声明命名空间，否则您的 xml 将无效。添加命名空间定义后，您可以使用 Linq to Xml 解析和修改您的 xml：

```
XDocument xdoc = XDocument.Parse(xml);
var passwordElement = xdoc.XPathSelectElement("//password");
passwordElement.Value = Encrypt((string)passwordElement);
xdoc.Save(path_to_xml); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:15:19.640

不——没有比使用正确的 XML 类更好的方法了。

XmlDocument 或 XDocument 非常适合这项任务。如果您的 XML 非常大，您可能希望使用 XmlReader 研究流式传输（在您的情况下不太必要）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:18:48.667

您也可以考虑查看 xsd.exe。使用 xsd.exe，您可以将 xml 反序列化为类型安全的对象模型。从那里，很容易操纵数据。

# java - 如何检测连接池中的关闭连接？

> ID：14485444
> 
> 赞同：0
> 
> 时间：2013-01-23T17:13:16.957
> 
> 标签：java, jdbc, connection, pool, bonecp

想象一下当网络连接中断时有一个活动的 BoneCP jdbc 连接池，然后在一分钟后恢复。为了自动重新连接并重新创建池，应该如何配置 BoneCP？目前，如果我尝试此操作，池中的所有 jdbc 连接仍然可用，并且每次我的代码尝试使用它们时，都会出现异常：“java.sql.SQLException：JZ0C0：连接已关闭。”

更新：看起来 BoneCP 可能不支持这个。有谁知道其他连接池框架是否（以及如何）解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T14:54:18.947

如果网络出现故障，驱动程序应抛出异常，然后由 BoneCP 捕获并破坏所有现有连接。

# c# - ajax调用一次触发多次

> ID：14485445
> 
> 赞同：3
> 
> 时间：2013-01-23T17:13:18.013
> 
> 标签：c#, javascript, ajax, asp.net-mvc, asp.net-mvc-4

场景是我基本上试图创建 4 个下拉列表，当一个被更改时重新填充。又名过滤器是级联的，彼此。

所以我决定把它放在一个 Ajax 调用中。基本上，它需要参数，决定应该返回哪些选择列表。然后用新的下拉菜单替换旧的 4 个下拉菜单。（用新的部分替换当前部分）

除了，由于某种原因，我让它调用控制器一次..然后两次..然后 4 次..等等。好像旧的没有被移除/替换。只是隐藏？...

在视觉上，我看到了 Id 的期望。下拉菜单更改选择选项。

下面是代码。（如果某些变量名称是拼写错误，抱歉，它们已被更改以在此处发布）

控制器：

```
 public class Filter
    {
        public IEnumerable<SelectListItem> List1;
        public IEnumerable<SelectListItem> List2;
        public IEnumerable<SelectListItem> List3;
        public IEnumerable<SelectListItem> List4;
    }

    public ActionResult GlobalFilter(String l1, String l2, String l3, String l4)
    {
        Filter filter = new Filter();

        filter.List1 = ...selectList

        filter.List2 = ...selectList

        filter.List3 = ...selectList

        filter.List4 = ...selectList

        return PartialView(filter);
    } 
```

看法：

```
 <div id="filterPartial">

        @Html.Action("GlobalFilter", "Header")
    </div> 
```

部分观点：

```
@model ns.Controllers.HeaderController.Filter

<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script>

@using (Ajax.BeginForm("GlobalFilter", "Header", new AjaxOptions { UpdateTargetId = "filterPartial" }))
{ 

    @Html.DropDownList("l1", Model.List1, new { })
     @Html.DropDownList("l2", Model.List2, new { })

     @Html.DropDownList("l3", Model.List3, new { })
      @Html.DropDownList("l4", Model.List4, new { })

}
<script type="text/javascript">
    $('#l1').change(function () {
        $(this).parents('form').submit();
    });
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T20:13:28.470

将其移到您的部分之外：

```
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script> 
```

我还将更改脚本也移到了部分之外，并将其更改为处理动态内容，如下所示：

```
<script type="text/javascript">
    $('#filterPartial').on('change', '#l1', function () {
        $(this).closest('form').submit();
    });
</script> 
```

# ios - 带有 FlipViewController 和主视图的 IOS 定位

> ID：14485446
> 
> 赞同：0
> 
> 时间：2013-01-23T17:13:19.807
> 
> 标签：ios, rotation, orientation-changes, flipside

我使用两个 ViewController。一个 MainView 和一个 FlipViewController。MainView 包含一堆按钮和控件，以及一个图形显示，而 FlipView 包含设置。

MainView 根据方向加载不同的 XIB，以方便我支持的各种按钮和图形屏幕。这允许极大的灵活性以不同的方式布置事物。该项目最初是在 StoryBoarding 功能添加到 Xcode 之前创建的。

正常的用例是我在 MainView 上以纵向模式开始，然后触摸一个按钮，将 FlipView 旋转到视图中。我在 FlipView 上进行操作（配置程序的各个方面），然后提交更改，这会将我转回 MainVIew。到目前为止一切都很好。

当我进入 FlipView 然后旋转设备以使 FlipView 采用不同的方向时，就会出现问题。假设我将肖像旋转到横向。然后从 FlipView 返回到 MainView。此时，MainView 并不知道 FlipView 执行的 Rotation。所以它仍然用 Portrait XIB 显示 MainView。

从 FlipViewController 返回后，MainView 的 willRotateToInterfaceOrientation 永远不会被调用。因此，它永远不会发现方向变化，因此，为该方向保留了不正确的 XIB。这是 willRotateToInterfaceOrientation 中的方向处理程序的示例...

```
-(void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration    {

// if portrait, load the portrait XIB for Pad or Phone

if (UIInterfaceOrientationIsPortrait(toInterfaceOrientation)) {

    if( UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {

        [[NSBundle mainBundle] loadNibNamed:@"MainViewiPad" owner:self options:nil];

    }else{

        [[NSBundle mainBundle] loadNibNamed:@"MainView" owner:self options:nil];

    }

    [self viewDidLoad];

    intorient = 1;
 else.... handle Landscape... 
```

所以我一直在尝试 viewWillAppear 例程，试图找到让 MainView 发现旋转并以系统方式执行它的方法。但到目前为止，我不知道如何使系统以这种方式工作。我怀疑当调用 viewWillAppear 时，我必须生成强制重新加载正确方向的代码。但这不能正常工作，因为我似乎从来没有及时加载更改，并且尝试从 viewWillAppear 消息中重新加载新的 XIB 似乎是不正确的。

非常感谢任何有助于理解这种行为的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T17:06:21.657

好的。我在这里找到了问题。问题是有关旋转的信息没有被发送回 MainView。这很容易通过让 FlipView（将对这些方向消息做出反应）将消息重新发送到 MainView 来处理。我在 FLipView 中的代码之前没有为旋转消息做任何事情（它是自动处理旋转），但现在我在 FlipView 中添加处理程序，如下所示：

```
-(void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration { 
        [mainView willRotateToInterfaceOrientation:toInterfaceOrientation duration:duration]; 
} 
```

这实质上是将消息传递回MainView。这是因为在打开 FlipView 时 MainView 不会消失。它留在后面，仍然可以响应它收到的消息。

需要注意的一件事是，我在上面的代码中引用了 mainView。您需要在 FlipView alloc-init 之后将其传入，以确保您可以在需要时进行此调用。这意味着在 Flipview 代码中向 MainView 类添加一个新属性。

在打开 FlipView 之前，我在 MainView 中做了这样的事情：

```
FlipsideViewController *controller = [[FlipsideViewController alloc] initWithNibName:@"FlipsideView" bundle:nil];

controller.delegate = self;
controller.mainView = self;
controller.lastIndexPath = lastIndex;
controller.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
[self presentModalViewController:controller animated:YES]; 
```

希望这可以帮助其他遇到此类麻烦的人。当我以模态方式打开 Web 查看器时，我也注意到了同样的行为。我在那里使用相同的技术来处理相同类型的问题。

# c# - 编写了一个使用 SendKeys.SendWait("{PRTSC}") 进行屏幕捕获的 C# 应用程序

> ID：14485450
> 
> 赞同：1
> 
> 时间：2013-01-23T17:13:28.173
> 
> 标签：c#

我编写了一个 C# 应用程序，它使用`SendKeys.SendWait("{PRTSC}")`. 这并不总是有效。我之所以走这条路，而不是使用诸如 copyScreenImage 之类的功能，是因为有些人可能有多个屏幕，我无法确定屏幕是一个在另一个之上还是并排。如果您想对所有内容进行截图，这很重要。有什么想法吗？

# php - 在 Codeigniter 中使用 My_Model 插入许多表

> ID：14485455
> 
> 赞同：1
> 
> 时间：2013-01-23T17:13:47.077
> 
> 标签：php, codeigniter, database-abstraction

我有一个用 codeigniter 开发的网站。我在没有验证的情况下插入了我的数据库。现在我想使用 My_Model （一个扩展模型来验证我的字段，许多开发人员使用它来验证从 github 下载的 codeigniter 中的字段）但是如果在我的函数中我必须在不同的表中插入更多内容？我该怎么做？因为例如，如果我有一个产品，我将它的数据插入到数据库中，现在`SELECT LAST_INSERT_ID`我使用它的 id 并将具有该 product_id 的图像插入到一些函数中，如下所示：

```
 $product = array('name'=>'test');
        $this->db->insert('product',$product);
        $query = $this->db->query('SELECT LAST_INSERT_ID()');
        $row = $query->row_array();
        $product_id = $row['LAST_INSERT_ID()'];
        $img = array(
                 'product_id'=>$product_id,
             'url'=>$url)       
                );
        $this->db->insert('img',$img); 
```

现在有了 My_Model 我有这个功能：

```
 $product = array('name'=>'test');
   $nation_id = $this->insert($product);
   $this->load->model('backend/Img_model');
   $img_model = new Img_Model();
   $img = array(
             'product_id'=>$product_id,
             'url'=>$url
         );
   return $img_model->insert($img); 
```

问题是：在 Nation_Model 我有一个 validate 数组来检查我的字段，在 Img_Model 我有另一个像这样的 validate 数组（只是一个例子）：

```
 public $validate = array(
        array( 'field' => 'name', 
               'label' => 'name',
               'rules' => 'required),
     ); 
```

但是当我尝试插入时：第一个插入没问题，第二个插入不取Img_Model的验证数组，而是取nation_Model的validate_array。我该如何解决这个问题？

# android - PowerManager newWakeLock.acquire() 未按预期工作

> ID：14485456
> 
> 赞同：2
> 
> 时间：2013-01-23T17:13:48.747
> 
> 标签：android, powermanager

我希望我的应用程序保持 CPU 运行，但关闭屏幕以最大程度地减少电力浪费。

以前有关此主题的帖子建议采用以下方法：

```
 mPm = (PowerManager) getSystemService(Context.POWER_SERVICE);
    mWakeLock =  mPm.newWakeLock(PowerManager.PARTIAL_WAKE_LOCK, Constants.WAKE_LOCK_TAG);

    mWakeLock.acquire();    //keep CPU running, turn screen off 
```

清单包含：

```
 <uses-permission android:name="android.permission.WAKE_LOCK" /> 
```

在我的纯真中，我预计在获得锁定后屏幕会立即关闭，但什么也没发生。我读过的早期帖子似乎从未解决过这个问题，有人成功了吗？还有什么我必须做的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:41:01.670

在活动的方法中以另一种方式使用它会更有效`onCreate`：

```
getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON); 
```

这是以有效方式使用唤醒锁的更好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:35:39.000

唤醒锁不会关闭屏幕。通常，当屏幕熄灭时，您的应用程序会因为 CPU 进入睡眠状态而暂停。如果您有`PARTIAL_WAKE_LOCK`，您的应用程序将继续运行，即使屏幕关闭（由于自动或手动睡眠），CPU 也将处于活动状态。仅当您确实需要在屏幕关闭后继续处理数据时才使用此选项。您提到您担心最小化电源使用，获取任何类型的唤醒锁都可能导致浪费电源。[遵循文档](http://developer.android.com/reference/android/os/PowerManager.html)中的此警告是明智的[`PowerManager`](http://developer.android.com/reference/android/os/PowerManager.html)

> 使用此 API 将显着影响设备电池寿命。不要获取 PowerManager.WakeLocks，除非你真的需要它们，尽可能使用最低级别，并确保尽快释放它们。

因此，最好评估一下您为什么认为您的任务需要唤醒锁。如果您认为它太省电，那不是。

# javascript - 变量为某些目的未定义，为其他目的定义

> ID：14485457
> 
> 赞同：1
> 
> 时间：2013-01-23T17:13:52.427
> 
> 标签：javascript, variables, console

我想查看 NewEgg 产品 ID 的格式，因此我尝试从他们的主页运行以下脚本，将所有链接产品的 ID 吐出到控制台：

```
for (var i=0;i<document.links.length;i++) {
    if (document.links[i].href.indexOf("Product.aspx")!=-1) {
        var itemNo=document.links[i].href.split("Item=")[1];
        console.log(itemNo);
    }
} 
```

（如您所见，产品链接中包含“Product.aspx”，后跟`?Item=[itemid]`.Simple `split`to get the part after `?Item=`）。该脚本运行良好。但是，当我试图变得“更高级”时，我开始收到`itemNo`未定义的错误消息。这是我尝试过的脚本：

```
for (var i=0;i<document.links.length;i++) {
    if (document.links[i].href.indexOf("Product.aspx")!=-1) {
        var itemNo=document.links[i].href.split("Item=")[1];'
        if (itemNo.charAt(0)=="N") {//look at only IDs that start with 'N'
            console.log(itemNo);
        }
    }
} 
```

这报告了 itemNo 在第二个`if`语句中未定义（`if`上面第四行的内部）。注释掉该`if`语句（第 4 行和第 6 行）使其再次正常工作。所以基本上，我可以记录它，但我不能`if`。我还尝试了更多的字符串操作来代替`if`之前的记录，但是在定义的行之后，`itemNo`除了记录它之外我无能为力。我尝试更改变量名无济于事。

诚然，这是来自 Firebug 控制台（也尝试过 Firefox 的原生 Scratchpad），所以环境有点不同，但我看不出为什么有时应该定义变量，但有时却未定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:22:52.690

这实际上根本不是 Firebug 的问题。如果您尝试以下操作：

```
for (var i=0;i<document.links.length;i++) {
    if (document.links[i].href.indexOf("Product.aspx")!=-1) {
        // Added log
        console.log(document.links[i].href);

        var itemNo=document.links[i].href.split("Item=")[1];
        if (itemNo.charAt(0)=="N") {
            console.log(itemNo);
        }
    }
} 
```

您会注意到查询字符串中*没有*`Item=`第一个链接。因此，当您尝试拆分 href 时，您会返回`undefined`，然后尝试运行`charAt()`，这当然会引发 TypeError。

基本上，您只是没有检查`undefined`. 一个简单的检查应该做到这一点：

```
for (var i=0;i<document.links.length;i++) {
    if (document.links[i].href.indexOf("Product.aspx")!=-1) {
        var itemNo=document.links[i].href.split("Item=")[1];
        // Right here
        if (itemNo && itemNo.charAt(0)=="N") {
            console.log(itemNo);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:25:02.283

问题在于您的搜索条件。

如您所见，一些链接具有“Product.aspx”，但不是产品链接，例如：“http://www.newegg.com/Store/NewProduct.aspx?Name=What%27s-New”

您应该更具体，例如：

```
for (var i=0;i<document.links.length;i++) {
    if (document.links[i].href.indexOf("/Product.aspx?")!=-1) {
        // Added log
        console.log(document.links[i].href);

        var itemNo=document.links[i].href.split("Item=")[1];
        if (itemNo.charAt(0)=="N") {
            console.log(itemNo);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:46:54.907

查看您的第一个脚本的第一个结果（效果很好）。它是未定义的。这就是您的第二个脚本中出现错误的原因。

您应该重写它，检查 itemNo 是否不足：

```
for (var i=0;i<document.links.length;i++) {
if (document.links[i].href.indexOf("Product.aspx")!=-1) {
    var itemNo=document.links[i].href.split("Item=")[1];
    if (itemNo!=undefined&&itemNo.charAt(0)=="N") {//look at only product ideas that start with N
        console.log(itemNo);
    }
} 
```

}

# php - 选择带有“请选择”消息的选项标签

> ID：14485459
> 
> 赞同：1
> 
> 时间：2013-01-23T17:13:56.397
> 
> 标签：php, html

我想要一个包含以下选项的下拉列表。当没有选择任何选项时，我想要一个请选择信息。我已经通过下面的代码实现了它。选择一个选项时提交表单。但问题是当我导航回页面并选择第一个选项即--请选择--时，我的表单也被提交给该选项。有什么解决方案，这样我就可以在没有选择任何选项时显示一个 --please select-- 选项，而不是提交该特定的表单 --please select-- 选项。？

```
<select onchange="this.form.submit()">
    <option>--Please Select --</option>
    <option value="volvo">Volvo</option>
    <option value="saab">Saab</option>
    <option value="mercedes">Mercedes</option>
    <option value="audi">Audi</option>
</select> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T17:19:58.520

您可以使用`<option selected="selected" disabled="true">`

选中意味着它将是默认的，然后禁用它会停止被点击。

[演示](http://jsfiddle.net/u8PWX/1/)

```
<select onchange="this.form.submit()">
  <option selected="selected" disabled="true">--Please Select --</option>
  <option value="volvo">Volvo</option>
  <option value="saab">Saab</option>
  <option value="mercedes">Mercedes</option>
  <option value="audi">Audi</option>
</select> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:20:12.340

禁用“请选择”选项。这样，该选项最初会被选中，但不能再次被选中。

```
<select onchange="this.form.submit()">
    <option disabled="true">--Please Select --</option>
    <option value="volvo">Volvo</option>
    <option value="saab">Saab</option>
    <option value="mercedes">Mercedes</option>
    <option value="audi">Audi</option>
</select> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T17:21:47.777

干得好：）

```
<select onchange="if(this.value!='') this.form.submit();">
    <option value="">--Please Select --</option>
    <option value="volvo">Volvo</option>
    <option value="saab">Saab</option>
    <option value="mercedes">Mercedes</option>
    <option value="audi">Audi</option>
</select> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T17:32:15.473

你可以用javascript来做。

```
<select onchange="if (this.selectedIndex !=0) { this.form.submit(); }">
    <option>--Please Select --</option>
    <option value="volvo">Volvo</option>
    <option value="saab">Saab</option>
    <option value="mercedes">Mercedes</option>
    <option value="audi">Audi</option>
</select> 
```

因为这是一个 php，您可能会动态生成您的选择选项，因此您可能需要稍微更改代码。

# php - 使用给定的 wsdl 从 php 调用 webservice

> ID：14485461
> 
> 赞同：1
> 
> 时间：2013-01-23T17:13:59.220
> 
> 标签：php, xml, soap, wsdl

嗨，请告诉我如何获得回复

我有一个wsdl，我想通过它调用awebservice虽然使用soapUI我可以获得reposnse但不能通过php

我还给出了需要进行的 xml 请求

```
 <?xml version="1.0" encoding="UTF-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Header    /><soapenv:Body>
  <q2:OneOffDeductionRequestMsg
   xmlns:q0="http://www.huawei.com/bme/accountmgr"
   xmlns:q1="http://www.huaweiommon"
   xmlns:q2="http://www.accountmgrmsg">
   <RequestHeader>
   <q1:CommandId>OneOffDeduction</q1:CommandId>

   <q1:Version>1</q1:Version>
   <q1:TransactionId/>
   <q1:SequenceId>1</q1:SequenceId>

 <q1:RequestType>Event</q1:RequestType>
   <q1:SessionEntity>
  <q1:Name>NET</q1:Name>
  <q1:Password>084912FA9733C4A0115D</q1:Password>
 <q1:RemoteAddress>10.176.122.2</q1:RemoteAddress>
</q1:SessionEntity>
<q1:SerialNo>192741328589162212</q1:SerialNo>
</RequestHeader>
<OneOffDeductionRequest>
<q0:SubscriberNo>XXXXXX73</q0:SubscriberNo>
<q0:OperationID>4059999</q0:OperationID>
<q0:AdditionalInfo>VNET</q0:AdditionalInfo>
<q0:DeductAmt>100</q0:DeductAmt>
<q0:MinMeasureId>101</q0:MinMeasureId>
</OneOffDeductionRequest>
</q2:OneOffDeductionRequestMsg>
</soapenv:Body></soapenv:Envelope> 
```

这是使用它的 PHP 代码：

```
<?php

  $RequestHeader = array( 
           'CommandId' => 'OneOffDeduction',
    'Version' => '1',
    'TransactionId' => '34234',
    'SequenceId'  =>  '1',
    'RequestType' => 'EVENT',    
    'SerialNo' => '1527013286284589162212');

   $SessionEntity =array(
    'Name'      =>    'V', 
            'Password'  =>    'v',
        'RemoteAddress' =>'10.0.0.0');

 $wsdl ="http://eAccountMgrService?wsdl";
 $client = new SoapClient($wsdl);

  $param =array('SubscriberNo'=>'54321',
 'OperationID' =>'4059999',
 'AdditionalInfo'=>'VAS2NET',
 'DeductAmt'=>'10',
 'MinMeasurId'=>'101');

 var_dump($client);

  $Result = $client->__call('OneoffDeduction',array( 
            'CommandId' => 'OneOffDeduction',
    'Version' => '1',
    'TransactionId' => '34234',
    'SequenceId'  =>  '1',
    'RequestType' => 'ET',    
    'SerialNo' => '1527',
  'sessionEntity' =>array(
    'Name'      =>    'V', 
            'Password'  =>    'v',
        'RemoteAddress' =>'10.0.0.0')));
  var_dump($Result);

  echo $client->__getLastRequest();

 $Response = $client->__call('OneoffDeduction',array('SubscriberNo'=>'54321',
'OperationID' =>'4059999',
' AdditionalInfo'=>'VAET',
 'DeductAmt'=>'10',
'MinMeasurId'=>'101'));

   echo $client->__getLastRequest();
   ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T15:40:43.883

在您的代码干燥并组织好之前，调试问题并不容易/不可能。

由于您定义了从未使用过的变量，因此您很可能对实际发送到 API 的变量感到困惑——例如，`$params`似乎从未*以任何形式*发送过。

建议您[参考soapClient 文档](http://php.net/manual/en/soapclient.soapclient.php)以确保您传递了正确的列表。

# java - Android：考虑2个分隔字符拆分字符串

> ID：14485468
> 
> 赞同：0
> 
> 时间：2013-01-23T17:14:17.560
> 
> 标签：java, android, tokenize

我有一个包含消息的字符串。字符串如下所示：

```
bill:hello;tom:hi;bill:how are you?;tommy:hello!; ... 
```

我需要在字符`:`和`;`.
现在，我已经拆分了字符串`;`，我可以将结果添加到列表元素中。

```
 List<Message> listMessages = new ArrayList<Message>();

    StringTokenizer tokenizer = new StringTokenizer(messages, ";");

    String result = null;
    String uname = "";
    String umess = "";

    while (tokenizer.hasMoreTokens()) {

        result = tokenizer.nextToken();
        listMessages.add(new Message(result, ""));

    } 
```

我仍然必须这样做`:`才能在我的列表元素中包含两个结果字符串，并且我尝试了类似的方法：

```
 List<Message> listMessages = new ArrayList<Message>();

    StringTokenizer tokenizer = new StringTokenizer(messages, ";");

    String result = null;
    String uname = "";
    String umess = "";

    while (tokenizer.hasMoreTokens()) {

        result = tokenizer.nextToken().split(":");
        uname = result[0];
        umess = result[1];
        listMessages.add(new Message(result[0], result[1]));

    } 
```

但是我得到了这个错误，我不明白？

```
01-23 17:12:19.168: E/AndroidRuntime(711): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.appandroid/com.example.appandroid.ListActivity}: java.lang.ArrayIndexOutOfBoundsException: length=1; index=1 
```

提前感谢您查看我的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T17:17:10.630

`String.split(regex)`您可以使用基于以下两个分隔符的拆分，而不是使用 StringTokenizer ：

```
String test="this: bill:hello;tom:hi;bill:how are you?;tommy:hello!;";
String[] arr = test.split("[:;]");
for(String s: arr){
    System.out.println(s);
} 
```

输出：

```
this
 bill
hello
tom
hi
bill
how are you?
tommy
hello! 
```

编辑：

来自@njzk2 的评论，如果你只想使用 StringTokenizer，你可以使用它的[重载构造函数](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/StringTokenizer.html#StringTokenizer%28java.lang.String,%20java.lang.String%29)之一，它需要 2 个 args 。

```
StringTokenizer str = new StringTokenizer(test, ":;"); 
```

# session - Google Analytics 中每个用户会话的搜索查询

> ID：14485472
> 
> 赞同：1
> 
> 时间：2013-01-23T17:14:28.793
> 
> 标签：session, google-analytics, filtering

我们有一个具有站点搜索功能的 WordPress 站点。此搜索的结果页面具有 mysite.com/?s=search+term 的 URL，就像标准 WordPress 设置一样。

我很好奇的是如何找出*特定*用户是否在特定会话中搜索了多个词。

是否有一种方法可以通过 URL 中是否存在“？s =”来过滤所有页面浏览量，然后通过同一会话中发生的任何浏览量来过滤这些浏览量？

# rdf - RDF 和微数据的未来

> ID：14485473
> 
> 赞同：12
> 
> 时间：2013-01-23T17:14:35.310
> 
> 标签：rdf, microdata

未来我们应该对 RDF 和微数据有什么期待？微数据能否完全替代RDF，这是目标吗？还是它们注定要并存？一旦微数据变得更有名，我们是否应该在我们的网站上同时拥有这两者？

更新：我不打算开始讨论，我只想知道微数据是否应该取代 RDF 或者它们应该共存。如果它们应该共存，我将很乐意阅读一些指南和可能基于研究的预测。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-24T12:44:43.217

如果将其与 Microdata 进行比较，您可能会谈论**RDFa**（RDF 是一种数据模型，可以用许多不同的语法表示，如 RDFa、Turtle、RDF/XML、JSON-LD 等）。

请注意，[RDFa 1.0](http://www.w3.org/TR/2008/REC-rdfa-syntax-20081014/)是 2008 年的 W3C 建议，[RDFa 1.1 Core](http://www.w3.org/TR/2012/REC-rdfa-core-20120607/)（和[RDFa 1.1 Lite](http://www.w3.org/TR/2012/REC-rdfa-lite-20120607/)）是 2012 年的 W3C 建议，而[Microdata](http://www.w3.org/TR/microdata/) ~~是相当新的，仍然是 W3C 工作草案，~~只是[工作组说明 (2013-10-29 )](http://www.w3.org/TR/2013/NOTE-microdata-20131029/) . 一些人争辩（例如，RDFa 规范的编辑[Manu Sporny](http://manu.sporny.org/2012/microdata-cr/)）认为 W3C*不应该*将微数据作为建议书发布，因为它与 RDFa 非常相似。

查看[**HTML 数据指南**](http://www.w3.org/TR/html-data-guide/)（W3C 兴趣组注释）：

> 微格式、RDFa 和微数据都使消费者能够从 HTML 页面中提取数据。这些数据可能嵌入到增强的搜索引擎结果中，通过浏览器扩展向用户展示，跨网站聚合或由在这些 HTML 页面中运行的脚本使用。
> 
> 本指南旨在帮助 HTML 数据的发布者和消费者很好地使用它。它有多种语法和词汇可供选择，它提供了有关如何确定哪些满足出版商或消费者需求的指导。它讨论了何时需要混合语法和词汇，以及如何发布和使用使用多种格式的数据。它描述了如何创建可用于多种语法的词汇表以及有关 HTML 数据的发布和使用的一般最佳实践。

* * *

我的主观意见：RDFa 和 Microdata 将共存。如果您想专注于其中之一，请使用 RDFa（从 RDFa Lite 开始，这非常非常简单——您可以在 10-15 分钟内阅读*并理解*整个[规范）。](http://www.w3.org/TR/rdfa-lite/)为什么？RDF 是语义网*的语言。*RDF 可以与许多标记语言一起使用，不仅是 HTML（而 Microdata 仅适用于 HTML5）。RDF 多年来逐渐成熟——已经有两个“完成”的规范仅针对 RDFa（而 Microdata 仍是草案）。

另请参阅：[**微数据和 RDFa 之间的差异**](https://stackoverflow.com/a/25888436/1591669)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-17T17:00:10.260

问题是关于2013年的一种[格式战……](https://en.wikipedia.org/wiki/Format_war)*未来谁会赢得这场战争？* 未来是现在 ：-）

今天，统计大局是“微数据正在获胜”。

关于“最好的格式”，当认为“更好的是用户需要的”时......再次统计。唯一好的答案是随着时间（几年）的采用率而发展起来的。

## 使用微数据，因为 2016 年使用了约 75%

它不是一个标准（在很远的将来[W3C/TR/microdata](https://www.w3.org/TR/microdata/)可能会是），没有使用 Microdata 的“真正充分的理由”......除了**大多数人都在使用它**......有一个可靠的统计数据（没有人反对使用 WebDataCommons 进行这项工作）

*   微数据：约 250 万个域，9 亿个 URL。
*   RDFa：约 90 万个域，3.12 亿个 URL。

因此，Microdate 在 2016 年被使用了约 2.5 倍的域和 3 倍的 URL……而且没有“新事实”来扭转微数据采用的增长。

将“所有用户”想象成 RDFa+Microdata (2.5+0.9=3.4)，我们可以说**大约 75% 的用户**(2.5/3.4) 正在使用 Microdata。

[![在此处输入图像描述](../Images/8709d52182265a322f56979908a2775a.png)](https://i.stack.imgur.com/o2o48.png)
来源：[http ://webdatacommons.org/structureddata/#results-2016-1](http://webdatacommons.org/structureddata/#results-2016-1)

* * *

也可以看看：

*   （避免`meta`和 JSON-LD）[https://stackoverflow.com/a/43960968](https://stackoverflow.com/a/43960968)
*   [“Microformat vs HTML+RDFa”采用率统计](https://stackoverflow.com/q/28609428)
*   ...

# php - 转换与不同比较

> ID：14485474
> 
> 赞同：1
> 
> 时间：2013-01-23T17:14:36.903
> 
> 标签：php, variables, comparison

如果我有一个变量，它被赋予一个也可以是数字的字符串，如下所示：

```
$a = "1"; 
```

如果我想检查它是否确实等于 1，那么两者之间是否有任何功能差异

```
if((int)$a == 1) {
    whatever();
} 
```

和

```
if($a == "1") {
    whatever();
} 
```

在这里，我正在考虑 PHP，但欢迎其他语言的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:16:38.100

在第一种情况下，您需要转换然后比较，而在第二种情况下，您只比较值。从这个意义上说，第二种解决方案似乎更好，因为它避免了不必要的操作。第二个版本也更安全，因为它可能`$a`无法转换为 int。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:19:06.520

```
$a = "1"; // $a is a string
$a = 1; // $a is an integer 
```

第一个

```
if((int)$a == 1) {
 //int == int
    whatever();
} 
```

第二个

```
if($a == "1") {
   //string == string
    whatever();
} 
```

但如果你这样做

```
$a = "1"; // $a is a string

if($a == 1) {
   //string & int
   //here $a will be automatically cast into int by php
    whatever();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:06:52.290

因为您的问题还询问其他语言，您可能正在寻找更一般的信息，在这种情况下不要忘记三等号。这真的真的等于某事。

```
$a = "1";
if ($a===1) {
  // never gonna happen
}
$b = 1;
if ($b === 1) {
  // yep you're a number and you're equal to 1
} 
```

# sql - 更新按组组合的查询并设置最短日期

> ID：14485480
> 
> 赞同：1
> 
> 时间：2013-01-23T17:14:55.360
> 
> 标签：sql, db2

我完全不知道如何完成这个查询。

如何在没有大的性能影响的情况下实现此查询（如果表包含数千行）？

请指教！

**我的表**

```
pktimestmp | sw_id | url_id |  open_date   | end_date  
-------------------------------------------------------
xxx0       |  101  |  com   |  2013-01-01  | 2013-01-30
xxx1       |  202  |  net   |  2013-01-01  | 2013-01-30
xxx2       |  202  |  net   |  2013-01-15  | 2013-02-28 *
xxx3       |  303  |  com   |  2013-01-01  | 2013-01-30 
xxx4       |  303  |  com   |  2013-02-01  | 2013-02-15 *
xxx5       |  303  |  com   |  2013-03-01  | 2013-03-15 *
xxx6       |  404  |  org   |  2013-01-01  | 2013-01-30 
xxx7       |  404  |  org   |  2013-02-01  | 2013-02-15 *
xxx8       |  404  |  gov   |  2013-02-01  | 2013-02-15
xxx9       |  404  |  gov   |  2013-02-01  | 2013-02-15 
```

...

> **更新查询：**
> 
> 软件和 url 相同的日期（即 sw_id 和 url_id）。
> 
> 我们将 opendate 和 enddate 设置为较少（分钟）出现。

```
xxx2       |  202  |  net   |  2013-01-15  | 2013-02-28
will be
xxx2       |  202  |  net   |  2013-01-01  | 2013-01-30 

here we have updated 
open_date to min(open_date)
and 
end_date to min(end_date)
from same sw and url. 
```

**（如果我们只更新有差异的地方就好了，例如不需要更新 xxx8 和 xxx9 因为它们是“相同的”）**

**MyTable** (* = 更新的行)

```
pktimestmp | sw_id | url_id |  open_date   | end_date
-------------------------------------------------------
xxx0       |  101  |  com   |  2013-01-01  | 2013-01-30
xxx1       |  202  |  net   |  2013-01-01  | 2013-01-30
xxx2       |  202  |  net   |  2013-01-01  | 2013-01-30 *
xxx3       |  303  |  com   |  2013-01-01  | 2013-01-30 
xxx4       |  303  |  com   |  2013-01-01  | 2013-01-30 *
xxx5       |  303  |  com   |  2013-01-01  | 2013-01-30 *
xxx6       |  404  |  org   |  2013-01-01  | 2013-01-30 
xxx7       |  404  |  org   |  2013-01-01  | 2013-01-30 *
xxx8       |  404  |  gov   |  2013-02-01  | 2013-02-15
xxx9       |  404  |  gov   |  2013-02-01  | 2013-02-15 
```

提前致谢！（不，我无权重新建模表格）:)

任何帮助表示赞赏，网址，提示，电子书，网站......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:41:34.670

以下应该可以工作（几乎在任何 RDBMS 上）：

```
UPDATE MyTable as a SET (open_date, close_date) 
                        = (SELECT MIN(open_date), MIN(close_date)
                           FROM MyTable as b
                           WHERE b.sw_id = a.sw_id
                             AND b.url_id = a.url_id)
WHERE EXISTS (SELECT *
              FROM MyTable as b
              WHERE b.sw_id = a.sw_id
                AND b.url_id = a.url_id
                AND (b.open_date < a.open_date OR b.close_date < a.close_date)) 
```

它生成了预期的，仅更新了 4 行（针对我的 iSeries 实例进行了测试）：

```
PKTIMESTAMP         SW_ID  URL_ID  OPEN_DATE   CLOSE_DATE
xxx0                101    com     2013-01-01  2013-01-30
xxx1                202    net     2013-01-01  2013-01-30
xxx2                202    net     2013-01-01  2013-01-30
xxx3                303    com     2013-01-01  2013-01-30
xxx4                303    com     2013-01-01  2013-01-30
xxx5                303    com     2013-01-01  2013-01-30
xxx6                404    org     2013-01-01  2013-01-30
xxx7                404    org     2013-01-01  2013-01-30
xxx8                404    gov     2013-02-01  2013-02-15
xxx9                404    gov     2013-02-01  2013-02-15 
```

# ios - 释放对象时的奇怪行为

> ID：14485482
> 
> 赞同：1
> 
> 时间：2013-01-23T17:14:57.487
> 
> 标签：ios, objective-c, cocoa-touch, core-data, uiwebview

我有一个视图，它是**UIWebView**的子类。它有一个名为**Contact的****属性**，它是一个托管对象。该视图使用模板引擎创建包含对象的 html，然后加载到**UIWebView**中。我认为在视图本身中监视对象会是一个更好的主意，这样每当对象发生变化时，视图就会自动刷新。因此，在视图本身中观察托管对象的某些属性。然后为了避免通知合并，我已经完成了重新加载

 ****`[self performSelector:@selector(refresh) afterDelay:0 ]`.

它会在发现更改时自动刷新 webview，但也会出现一些奇怪的崩溃。崩溃显示 [MyWebView 保留] 消息已发送到已释放对象。我知道我已经正确删除了 dealloc 方法中的观察值。但是，似乎 dealloc 会在一段时间后被触发。我有一个与发布视图有关的奇怪问题。视图会停留一段时间，尽管视图控制器已经释放，然后在 2/3 秒后释放。这真的很奇怪。我认为崩溃是因为这个。

请建议我任何想法。我很高兴听到你的建议。肯定有问题，如果有人能指出我，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-09T20:28:54.760

如果使用不当，使用委托设计模式可能会导致 EXC_BAD_ACESS KERN_INVALID_ADDRESS 崩溃。如果您有在使用委托设计模式的后台线程中运行的处理，在您将 SELF 设置为委托的对象中，您必须通过将委托引用设置为nil，或者对象可能会尝试使用委托设计模式回调您已释放的对象。因此，如果您的对象中有类似的东西。

```
[_xmlParser setDelegate:self]; 
```

即使在 ARC 下，您也应该始终有一个 dealloc 方法，以防止在您的对象在仍在工作的同时被破坏的情况下发生崩溃的可能性。在工作时破坏您的对象是很常见的。想象一个 UIViewController 显示来自互联网的图像。如果你有一个 FetchImage 类，它使用委托设计模式来查找图像，然后在查找完成时调用对象上的例程，那么当 FetchImage 对象仍在工作时，用户很容易进出你的 UIViewController在后台线程上。测试时您可能不会注意到这一点，但如果您有数百个用户，其中一些用户会注意到，因为当您的对象尝试调用 SELF 引用上的方法时，应用程序将崩溃。

如果您的对象使用委托设计模式，请始终清理：

```
#pragma mark - dealloc - cleanup delegate references to prevent callbacks into deallocated objects (EXC_BAD_ACCESS / KERN_INVALID_ADDRESS)

- (void)dealloc
{
    [_xmlParser setDelegate:nil];
    // for non ARC based code you would also call: [super dealloc]; 
} 
```

搜索项目中的每个类，如果您有 setDelegate:self 或 delegate = self 如果您没有如上所述的 dealloc 清理方法，那么您的用户很可能会遇到您的应用程序的竞争条件崩溃。如果您没有 dealloc，请添加它，即使您在测试时从未看到崩溃。-rrh****

# java - 关于单元测试结构的思考

> ID：14485483
> 
> 赞同：0
> 
> 时间：2013-01-23T17:15:03.753
> 
> 标签：java, unit-testing, junit

我正在考虑如何为我的项目编写测试。目前，测试结构是这样的：

```
RealClass 
{ 
      method1; 
      method2; 
      ...
} 
```

和完全相同的测试类结构：

```
TestClass {
   testMethod1; 
   testMethod2; 
   ...
 } 
```

但是，我不喜欢它，因为我在一种测试方法中放置了太多测试用例......

也许我应该使用这样的结构：

```
TestClass {
   testMethod1Opt1; 
   testMethod1Opt2; 
   ... 
   testMethod2Opt1; 
   ...} 
```

你是如何编写单元测试的？

### 我的测试代码示例：（非常简单的测试）

```
public void testIsAppUser() {
    // My (Artem`s Zinnatullin) uId
    final long artemZinnatullinUId = 172672179;

    try {
        assertTrue(usersApi.isAppUser(artemZinnatullinUId));
    } catch (Exception e) {
        fail(e.getMessage());
    }

    // Pavel`s Durov uId
    final long durovUId = 1;

    try {
        assertFalse(usersApi.isAppUser(durovUId));
    } catch (Exception e) {
        fail(e.getMessage());
    }

    // By default uId == current user`s (who has authorized) uId 
    try {
        assertTrue(usersApi.isAppUser(null));
    } catch (Exception e) {
        fail(e.getMessage());
    }
} 
```

### 我在想什么：

```
public void testIsAppUser1() {
    // My (Artem`s Zinnatullin) uId
    final long artemZinnatullinUId = 172672179;

    try {
        assertTrue(usersApi.isAppUser(artemZinnatullinUId));
    } catch (Exception e) {
        fail(e.getMessage());
    }
}

public void testIsAppUser2() {
    // Pavel`s Durov uId
    final long durovUId = 1;

    try {
        assertFalse(usersApi.isAppUser(durovUId));
    } catch (Exception e) {
        fail(e.getMessage());
    }
}

public void testIsAppUser3() {
    // By default uId == current user`s (who has authorized) uId
    try {
        assertTrue(usersApi.isAppUser(null));
    } catch (Exception e) {
        fail(e.getMessage());
    }
} 
```

请给我建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:32:05.187

评论：

1.  而不是`try{} catch(){ fail() }`仅仅添加`throws Exception`到测试方法中。JUnit 将自动为您测试失败*并*保留堆栈跟踪。这将使错误修复变得更加容易。

2.  创建小型测试方法。这就产生了一个名字问题：如何想出很多好名字？这里的解决方案是以逻辑测试的内容命名测试，而不是它调用的方法。

    如果您想查看调用了哪些方法，请使用[JaCoCo 之](http://www.eclemma.org/jacoco/)类的代码覆盖工具。

    所以应该调用第一个测试`testIsArtemsZinnatullinAppUser()`。作为指导：每当您觉得需要注释来解释测试的作用时，测试名称是错误的。使用您在评论中写的任何内容来创建测试名称。

您应该进行较小的测试的原因是 JUnit 会因第一个问题而停止。因此，如果您在一个测试用例中有 20 个测试，而第 3 个测试失败，则 17 个测试将无法运行。但是这 17 项测试可能包含有价值的信息，有助于找出问题所在。

如果他们都成功了，那么这可能是一个特定的问题。如果许多测试都失败了，那么问题一定出在共享代码中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:25:12.297

仅当您遇到由于“异常”而可能发生的错误时才抛出，因为您可以抛出。以下假设您正在创建自己的测试环境。

我不知道您的断言方法是什么样的，但实际上它们应该是抛出的方法。您也不需要 try catch 来引发异常，您可以执行以下操作：

`throw new Exception("msg"); // Or another type of Exception`

所以实现：

```
public void AssertEqual(Object obj1, Object obj2) throws Exception
{
    if (!obj1.equals(obj2))
        throw new Exception("Objects are not equal");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T17:30:17.820

您构建测试的第二种方式要好得多。这样，每种测试方法都涵盖了方法中断的不同方式，因此您不会出现修复方法中的一个错误，然后让测试失败的情况更进一步（这样一个错误会阻止您看到）其他）。与测试方法映射到被测对象的方法相比，测试方法要小且重点突出要重要得多。

另外，不要捕获异常，JUnit 会为您完成。添加`throws Exception`到每个测试方法的签名中。如果你想检查一个异常是否真的被抛出，那么你可以在测试中捕获它，比如：

```
try {
    objectUnderTest.doSomethingThatShouldThrowFooException();
    fail("should've thrown an exception before getting here");
}
catch (FooException fooEx) {
    // yay. my test passed
} 
```

，但样板：

```
} catch (Exception e) {
    fail(e.getMessage());
} 
```

是不必要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T17:46:05.950

我不会重复其他回复中的内容。但只需添加以下内容：

*   避免在测试类中重复代码构造。
*   不要犹豫写明确的失败消息。

这里有一些东西可以说明我的意思：

```
public void testIsAppUser1() {
    // My (Artem`s Zinnatullin) uId
    assertAppUser(172672179,true,"artemZinnatullinUId");
}

public void testIsAppUser2() {
    // Pavel`s Durov uId
    assertAppUser(1,false,"Pavel`s Durov");
}

public void testIsAppUser3() {
    // By default uId == current user`s (who has authorized) uId
    assertAppUser(null,true,"current user");
}

private void assertAppUser(Long id, boolean isExpectedAppUser, String userName){
    boolean isAppUser = usersApi.isAppUser(id);
    if(isExpectedAppUser){
        assertTrue("User with id:"+id+"and named:"+userName+" must be an appUser" ,isAppUser);
    }else{
        assertFalse("User with id:"+id+"and named:"+userName+" cannot be an appUser" ,isAppUser);
    }
}
} 
```

# android - 在 Android 4.1（三星）上无法启动 PDF 查看器（北极星）

> ID：14485486
> 
> 赞同：0
> 
> 时间：2013-01-23T17:15:21.740
> 
> 标签：android, pdf, android-activity, android-4.2-jelly-bean

我们正在创建一个 Activity 以在 Android Jelly Bean 4.1 上查看 PDF 文件，三星 Galaxy S3 默认启动 Polaris Viewer。我们第一次这样做时，它起作用了。但是我们第二次这样做时，我们得到了这个错误：

```
E/ActivityThread( 6788): Activity
com.infraware.polarisoffice4.viewer.PDFViewerActivity has leaked IntentReceiver com.infraware.polarisoffice4.viewer.PDFViewerActivity$2@4219c850 that was originally registered here. Are you missing a call to unregisterReceiver()?
E/ActivityThread( 6788): android.app.IntentReceiverLeaked: Activity com.infraware.polarisoffice4.viewer.PDFViewerActivity has leaked IntentReceiver com.infraware.polarisoffice4.viewer.PDFViewerActivity$2@4219c850 that was originally registered here. Are you missing a call to unregisterReceiver()?
E/ActivityThread( 6788):    at android.app.LoadedApk$ReceiverDispatcher.<init>(LoadedApk.java:792)
E/ActivityThread( 6788):    at android.app.LoadedApk.getReceiverDispatcher(LoadedApk.java:593)
E/ActivityThread( 6788):    at android.app.ContextImpl.registerReceiverInternal(ContextImpl.java:1254)
E/ActivityThread( 6788):    at android.app.ContextImpl.registerReceiver(ContextImpl.java:1241)
E/ActivityThread( 6788):    at android.app.ContextImpl.registerReceiver(ContextImpl.java:1235)
E/ActivityThread( 6788):    at android.content.ContextWrapper.registerReceiver(ContextWrapper.java:372)
E/ActivityThread( 6788):    at com.infraware.polarisoffice4.viewer.PDFViewerActivity.onCreate(PDFViewerActivity.java:109)
E/ActivityThread( 6788):    at android.app.Activity.performCreate(Activity.java:5206)
E/ActivityThread( 6788):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1083)
E/ActivityThread( 6788):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2064)
E/ActivityThread( 6788):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2125)
E/ActivityThread( 6788):    at android.app.ActivityThread.access$600(ActivityThread.java:140)
E/ActivityThread( 6788):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1227)
E/ActivityThread( 6788):    at android.os.Handler.dispatchMessage(Handler.java:99) E/ActivityThread( 6788):     at android.os.Looper.loop(Looper.java:137)
E/ActivityThread( 6788):    at android.app.ActivityThread.main(ActivityThread.java:4898)
E/ActivityThread( 6788):    at java.lang.reflect.Method.invokeNative(Native Method)
E/ActivityThread( 6788):    at java.lang.reflect.Method.invoke(Method.java:511)
E/ActivityThread( 6788):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
E/ActivityThread( 6788):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
E/ActivityThread( 6788):    at dalvik.system.NativeStart.main(Native Method) 
```

如果我们安装 Adob​​e Reader，那么我们不会得到这个异常（即使我们仍然在对话框中选择 Polaris 作为查看器）。如果我们卸载 Adob​​e Reader，异常会再次出现。

如果我们终止进程并重新启动，我们将能够在 Polaris 中查看一个 PDF，但是当我们查看第二个 PDF 时会出现异常。（我们查看什么 PDF 无关紧要：我们查看的第一个将打开，第二个则不会。）

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:30:04.107

我猜它在打开一个pdf后不会回到活动中。尝试在关闭该 pdf 并尝试打开新的 pdf 后返回该活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:38:56.750

当您以编程`BroadcastReceiver`方式向 an注册 a`IntentFilter`然后忘记取消注册时，通常会发生此错误。确保在系统删除您的 Activity 之前取消注册接收器（例如`onStop()`或`onDestroy()`）。或者，您可以`BroadcastReceiver`通过执行以下操作取消注册后一个广播：

```
@Override public void onReceiver(Context context, Intent intent) {
    context.unregisterReceiver(this);
    /* ... */
} 
```

只要确保如果广播从未发送过，您在`Activity`关闭之前在其他地方取消注册接收器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T20:41:11.793

由于我们无法解决问题，我们决定在提交 PDF 以供查看之前检查一下 Polaris 是否是唯一安装的查看器。如果是，我们建议用户去获取 Adob​​e Reader。

# ios - 在 iOS 中使用 MPMediaItem 时是否需要使用 mutableCopy 到 NSMutableArray？

> ID：14485487
> 
> 赞同：0
> 
> 时间：2013-01-23T17:15:38.993
> 
> 标签：ios, cocoa-touch, nsmutablearray, mpmediaitem

大家好，请指导我一些事情。

我正在使用`iPodMusicPlayer`.

这是我从 iPodLibrary 加载歌曲的一些代码。

```
MPMediaQuery *query = [MPMediaQuery playlistsQuery];

        MPMediaPropertyPredicate *filter = [MPMediaPropertyPredicate predicateWithValue:self.playlistName forProperty:MPMediaPlaylistPropertyName comparisonType:MPMediaPredicateComparisonContains];

        [query addFilterPredicate:filter];      

**self.app.arrayFromAppDelegate = (NSMutableArray *)[query items];**

        self.userMediaItemCollection = [[MPMediaItemCollection alloc] initWithItems:self.app.arrayFromAppDelegate];

        [self.player setQueueWithItemCollection:self.userMediaItemCollection]; 
```

根据上面的代码

`self.app.arrayFromAppDelegate = (NSMutableArray *)[query items];`

**arrayFromAppDelegate**是`NSMutableArray`我在`AppDelegate`. `[query items];`返回`NSArray`，我`NSMutableArray`用指针添加到`(NSMutableArray *)`

当我那样使用时，这是正确的方式吗？

还是我应该像这样使用`self.app.arrayFromAppDelegate = [[query items] mutableCopy];`

哪种方式最适合记忆，我需要在使用`removeAllObject`后使用`mutableCopy`吗？

请指导我。

对不起，我的英语不好。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:28:29.373

如果您要从`NSArray`不`NSMutableArray`只是转换它，请使用可变副本。

# python - 我在 TextWrangler 中运行 Python，它工作正常，但在 Mac 终端上却不行

> ID：14485488
> 
> 赞同：1
> 
> 时间：2013-01-23T17:15:42.080
> 
> 标签：python, terminal, textwrangler

Python代码：

```
"<stdin>"
#!/usr/bin/env
print "Hello world!" 
print "How are you?" 
```

以上是我应用到脚本上的一些代码，它在 TextWrangler 中运行时可以工作，但是当我将它放在终端中时，它会失败。

为什么会这样？它与我打开文件的方式有关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:21:40.183

`/usr/bin/env`不是 Python 的正确路径。shebang 行很可能应该是：

```
#!/usr/bin/env python 
```

我很确定它必须是第一行，所以`"<stdin>"`也删除该行（无论如何 Python 都会忽略它）。

还要确保您已在脚本上设置执行权限：`chmod +x /path/to/script.py`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:44:19.693

以开头的行在Unix`#!`中称为[shebang 行。](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)根据定义，你的 shebang 有两件事是错误的：

1.  sheebang 必须是脚本中的第一行——你在第二行有它。
2.  如果 Python 是目标解释器，您要么需要 Python 的绝对路径（类似于`#!/usr/bin/Python`OR 的参数来执行配置的 Python - 类似于`#!/usr/bin/env Python`注意实用程序[env的参数“Python”）](http://en.wikipedia.org/wiki/Env_%28shell%29)

# matlab - 在关闭等待栏时中止当前脚本

> ID：14485492
> 
> 赞同：6
> 
> 时间：2013-01-23T17:16:03.947
> 
> 标签：matlab

我正在使用这样的等待栏：

```
h = waitbar(0,'Please wait...');
for i=1:100, % computation here %
   waitbar(i/100)
   % other operation here
end
close(h) 
```

如果用户关闭等待栏（单击窗口的），我想停止此脚本`X`，而无需添加取消按钮。

有什么办法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T17:19:25.223

您可以测试是否`h`是有效句柄，否则退出循环。将以下内容插入循环：

```
if ~ishandle(h)
    break
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:23:47.667

你可以尝试这样的事情：

```
if ishandle(h),
   close(h);
   % Your code here
else
    %waitbar has been closed by the user
    % call throw, return, or break
end 
```

希望能帮助到你，

# java - 我应该在 Spring-mvc 中使用哪个 @controller 注释？

> ID：14485493
> 
> 赞同：0
> 
> 时间：2013-01-23T17:16:05.203
> 
> 标签：java, spring, spring-mvc

```
org.springframework.stereotype; 
```

或者

```
org.springframework.web.servlet.mvc; 
```

我一直在使用刻板印象，但只是注意到我还有另一种选择？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:24:01.080

```
org.springframework.stereotype.Controller 
```

是注解。它表明带注释的类是控制器以及自动检测的候选者（如@Component）。这是您要使用的注释。

```
org.springframework.web.servlet.mvc.Controller 
```

是实现控制器的接口。在大多数简单的情况下，您可能不想使用它。

# database - 数据库和网络应用服务器规范

> ID：14485494
> 
> 赞同：0
> 
> 时间：2013-01-23T17:16:04.860
> 
> 标签：database, web-applications, iis-7, storage, sql-server-2012

我想为使用 Sqlsever 2012 作为数据库服务器并在 .net 框架 4 上运行 ASP.net 应用程序作为接口的环境购买硬件我们有大约 1000 个用户，他们仅使用我们的应用程序来读取数据，我们有 3 个数据库 其中 2 个每月更新，每个更新 200 MB 事务 第三个数据库每周每 15 分钟更新 15 MB 事务 数据变得无用，只有一个用户更新 3 个数据库 我没有服务器设计经验或存储设计，但我做了一些研究，我找到了这个解决方案

戴尔 PowerEdge T620 服务器

处理器：Intel® Xeon® E5-2620 2.00GHz，15M 高速缓存，7.2GT/s QPI，Turbo，6C 95W 无额外处理器内存：4 X 8GB RDIMM，1600 MT/s，标准电压，双列，x4 数据宽度操作系统: Windows Server 2008 R2 SP1, Enterprise Edition,x64 HDD : 4 X 146GB 15K RPM SAS 6Gbps 2.5in Hot-plug Hard Drive,3.5in HYB CARR

如果我走错了方向，请让我站直

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-23T20:39:05.340

我想你想存储多少并不重要，但挑战是每秒或每分钟有多少用户访问你的服务器，并且在每个限制下你的服务器仍然会运行，所以只需尝试寻找具有巨大处理器和 sutable 大小的服务器公羊

# php - 在 URL 中打印 PHP

> ID：14485495
> 
> 赞同：0
> 
> 时间：2013-01-23T17:16:08.493
> 
> 标签：php, database, gps

我有这行代码：

```
echo '<a href="https://maps.google.co.uk/maps?q='.$caseReference['Latitude'].',-1.958862">MAP</a>'; 
```

但是，当您单击超链接时，它不会在纬度之后打印任何内容。EG-“，-1.958862”

我想要的最终结果是从数据库中删除纬度和经度变量并生成指向 Google 地图的超链接。（是的，我知道在数据库中存储纬度/经度坐标及其符号并不是最好的方法）。

有任何想法吗？

[注意] - 我之前已经打印了变量并且它不是空的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:27:16.223

那段代码绝对没有错。运行这将证明它

```
$caseReference['Latitude'] = "1.555555";
echo '<a href="https://maps.google.co.uk/maps?q='.$caseReference['Latitude'].',-1.958862">MAP</a>';
exit(); 
```

所以现在你需要检查纬度的大小写和拼写。如果一切正确，请尝试 $caseReference 的 print_r 并全面检查。

# mysql - 查询 MYSQL JOINS（2 个表）

> ID：14485497
> 
> 赞同：0
> 
> 时间：2013-01-23T17:16:23.940
> 
> 标签：mysql

我是加入表的新手。我有一张像下面这样的“商人”表

```
Merchant_Number    Merchant_Name
   1                 ABCD
   2                 DEFG 
```

我有一个如下表“交易”

```
Merchant_Number    Merchant_Name    Transaction_Amount
   1                 ABCD              100
   3                 XYZ               50
   1                 ABCD              50
   4                 nnn               200 
```

我想加入上面 2 个表，结果如下

```
Merchant_Number    Merchant_Name    Transaction Amount   No. Of Transactions
   1                 ABCD              150                    2
   2                 DEFG              0                      0
   3                 XYZ               50                     1 
   4                 nnn               200                    1 
```

交易金额为同一商户金额之和 交易次数为该商户使用其交易的次数 商户 ABCD 有 2 笔交易，其总交易金额为 150

我有一个查询

```
SELECT Merchant_Name, sum(transaction_amount)  as 'Transaction Amount',
count(*) as 'No. Of Transactions'
FROM Transactions
LEFT JOIN Merchants using (MERCHANT_NUMBER) 
group by Merchant_Name 
```

但这只给了我交易表中的商家，即，

```
Merchant_Number    Merchant_Name    Transaction Amount   No. Of Transactions
       1                 ABCD              150                    2
       3                 XYZ               50                     1 
       4                 nnn               200                    1 
```

如何查询以便我得到如上所述的结果？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:19:34.943

您希望以相反的方式加入，这样您就包括所有*商家*，无论他们是否有交易（这是 LEFT JOIN 所做的）：

```
SELECT Merchant_Name, sum(transaction_amount)  as `Transaction Amount`,
    count(*) as `No. Of Transactions`
FROM Merchants
LEFT JOIN Transactions using (MERCHANT_NUMBER) 
group by Merchant_Name 
```

当然，您可以改为将查询更改为写入 a `RIGHT JOIN`（而不是 a `LEFT JOIN`），但我发现这只会使代码难以阅读，因此我倾向于避免使用它们。

请注意您所写的查询与您所经历的一样；它显示所有*交易*，无论他们是否有商家（`FROM Transactions LEFT JOIN Merchants`）

* * *

正如我刚刚注意到的，您的数据没有标准化。您的交易表中有额外的商家，这些商家未计入您的商家表中。这会给你带来很多麻烦。

您应该找出是什么原因并阻止它，最好的方法是`Merchant_Name`从您的 Transactions 表中完全删除该列。如果您无法控制表格设计，则应该与可以控制的人交谈：-P。除此之外，请尝试：

```
SELECT Merchant_Name, sum(transaction_amount)  as `Transaction Amount`,
    count(*) as `No. Of Transactions`
FROM
(
    SELECT Merchant_Name, Merchant_Number
    FROM Merchants
    UNION
    SELECT Merchant_Name, Merchant_Number
    FROM Transactions
) Real_Merchants
LEFT JOIN Transactions using (MERCHANT_NUMBER) 
group by Merchant_Name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:19:13.647

你几乎拥有它，只需交换`Merchants`和`Transaction`：

```
SELECT Merchant_Name, SUM(transaction_amount)  AS 'Transaction Amount',
COUNT(*) AS 'No. Of Transactions'
FROM Merchants
LEFT JOIN Transactions using (MERCHANT_NUMBER) 
GROUP BY Merchant_Name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:25:19.230

您必须规范化您的数据库。尝试这个：

```
SELECT
  MN.Merchant_Number,
  MN.Merchant_Name,
  ISNULL(SUM(T.Amount), 0) TransactionAmount,
  COUNT(T.Merchant_Number) NoOfTransactions
FROM
(
   SELECT Merchant_Number, Merchant_Name FROM Merchants
   UNION
   SELECT Merchant_Number, Merchant_Name FROM Transactions
) MN
  LEFT JOIN Transactions T
    ON MN.Merchant_Number  = T.Merchant_Number
GROUP BY MN.Merchant_Number, MN.Merchant_Name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:20:16.070

当您想要在 LEFT JOIN 中来自特定表的所有行时，您需要先命名该表。

所以 FROM 商家 LEFT JOIN 交易会给你你想要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T17:20:33.927

更改查询中表的顺序 - `Merchants LEFT JOIN Transactions`。然后，您需要用零替换一些 NULL 值。像这样的东西：

```
SELECT Merchant_Name, ISNULL(SUM(transaction_amount), 0)  AS 'Transaction Amount',
COUNT(*) AS 'No. Of Transactions'
FROM Merchants
LEFT JOIN Transactions using (MERCHANT_NUMBER) 
GROUP BY Merchant_Name 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T17:27:25.333

由于 DEFG 没有出现在左表（“事务”）中，它不会出现在 LEFT JOIN 的结果中，它从左表中获取所有行并在右表中找到它们的匹配项。一种选择是： 1\. 在表之间切换并执行 Merchants LEFT JOIN Transactions。2\. 使用 COALESCE 处理您将要为正确的表获取的 NULL 值（因为那里没有与 DEFG 匹配的值），并将其替换为 0。

# java - handshake.getPeerCertificates() 两次握手时的空指针

> ID：14485500
> 
> 赞同：0
> 
> 时间：2013-01-23T17:16:31.940
> 
> 标签：java, sockets, ssl, ssl-certificate

握手完成后，我调用了我在服务器套接字上使用的`getPeerCertificates()`握手（`socket.getHandshakeSession()`）`setNeedClientAuth(true)`，所以我知道它必须获得客户端证书。

可能出了什么问题？`SSLPeerUnverifiedException`不被抛出

```
ssf = (SSLServerSocketFactory)SSLServerSocketFactory.getDefault();  
serverSocket = (SSLServerSocket)ssf.createServerSocket(PORT);  
serverSocket.setNeedClientAuth(true);
//added to after accept list and picked up by a worker thread.
SSLSocket socket = (SSLSocket) serverSocket.accept();

//worker thread.
SSLSession handshake = socket.getHandshakeSession();
Certificate[] certificates = handshake.getPeerCertificates(); // NULL 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T20:53:46.660

当你打电话时`socket.getHandshakeSession()`，你还没有开始握手，你肯定还没有到达交换客户端证书的地步。尽管调用`getSession()`是开始握手的一种方式（请参阅[`SSLSocket`](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/SSLSocket.html)文档的介绍，但不会发生这种情况`getHandshakeSession()`（如[文档](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/SSLSocket.html#getHandshakeSession%28%29)所述：“*与 getSession() 不同，此方法不会启动初始握手并且在握手完成之前不会阻塞。* ”）。

在大多数情况下，无论如何，您都希望在握手完成后获取客户端证书。调用`socket.getSession()`而不是`socket.getHandshakeSession()`（Java 7 中的新增功能）可能会解决您的问题。

# perl - 如果无法写入 ~/，如何安装 cpanm 和 local::lib？

> ID：14485501
> 
> 赞同：5
> 
> 时间：2013-01-23T17:16:32.190
> 
> 标签：perl, cpan

与许多将网站托管在共享服务器上的人一样，我没有 root 访问权限，并且托管公司不会应用户的要求安装 Perl 模块。

不幸的是，我也没有对该`~/`文件夹的写入权限，只能写入某些子文件夹（例如`~/cgi-bin/`）。

我尝试了[这里](https://stackoverflow.com/a/2980715/270404)建议的解决方案，更改`~/perl5`为`~/cgi-bin/perl5`（我创建的），但我不断收到此错误：

> “无法写入 cpanm home '~/.cpanm'：你应该先用 chown/chmod 修复它。”

问题是，正如我所说，**我没有对 ~/ 的写入权限**。

有什么方法可以告诉安装程序`~/cgi-bin/.cpanm`改用吗？我试图通过在互联网上的here和其他地方搜索来解决这个问题，但我开始把头撞到墙上。

**编辑：**所以我尝试了下面 Steven 的建议，使用这个命令：

> HOME=$HOME/cgi-bin cpanm local::lib

现在，`cpanm`成功运行并尝试安装该模块，但在整个安装过程中出现了许多警告并最终失败（可能仍在尝试写入禁止的文件夹？？）。

以下是一些示例警告：

> 警告：未找到先决条件 CPAN 1.82。我们有 1.7601。
> 
> 警告：未找到先决条件 ExtUtils::Install 1.43。我们有 1.32。
> 
> 警告：未找到先决条件 ExtUtils::MakeMaker 6.42。我们有 6.17。
> 
> 警告：未找到必备模块：：构建 0.36。
> 
> 警告：您无权在 /usr/lib/perl5/5.8.5/ExtUtils/Install.pm 第 114 行安装到 /usr/lib64/perl5/5.8.5/x86_64-linux-thread-multi。
> 
> mkdir /usr/lib/perl5/5.8.5/App：/usr/lib/perl5/5.8.5/ExtUtils/Install.pm 第 176 行的权限被拒绝
> 
> make: *** [pure_perl_install] 错误 255

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:51:39.107

`~`只是访问环境变量的一种简写方式`$HOME`，因此您应该能够执行一些操作，例如`export HOME=$HOME/cgi-bin`将有效的主目录下移到您具有写入权限的某个目录中。但是，这会影响很多事情，所以要小心。

# jquery - 如何将所有分离的行附加回它们的初始位置？

> ID：14485504
> 
> 赞同：0
> 
> 时间：2013-01-23T17:16:38.617
> 
> 标签：jquery, append, detach

单击按钮后，我想从表中分离一行。但是，我无法设法将其附加回原来的位置。我最终使用下面的代码来分离“删除”按钮所属的行：

```
$(".removeTR").live('click', function (event) {
$(this).closest('tr').fadeTo(400, 0, function () {
    $(this).detach();
});
return false;
}); 
```

当我需要分离多行然后使用“重置”按钮将它们全部附加时，问题会变得更加复杂。您能否提出任何建议或指导我正确的逻辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:20:50.603

您可以将节点的*索引**存储*在类似*`<table>`*

 *```
$(this).closest('tr').fadeTo(400, 0, function () {
    var $this = $( this );

    $this
        .data( 'index', $this.index() )
        .detach();
}); 
```

..然后，重新插入

```
$( 'table tr' ).eq( $noderef.data( 'index' ).after( $noderef ); 
```

* * *

请注意，存储的*索引*将是一个静态值。这意味着如果在此期间添加或删除了行，我们此时只需在它拥有的*索引处重新插入该行。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T14:55:34.203

我设法让它完全按照我想要的方式工作，使用 show() 和 hide()。这样我就不用担心定位了。但是，在处理大量表行时，我对性能感到担忧。

```
var trItems = $("table tr").length;
$(".resetALL").hide();

$(".removeTR").live('click', function (event) {
    $(".resetALL").fadeIn("slow");
    $(this).closest('tr').fadeOut("normal");
    var trHidden = $("table tr:hidden").length+1;
    var trRemains = trItems - trHidden;
    if (trRemains <= 3) {
        $("span").text("You must have at least " + (trRemains-1) + " products in the comparison table.");
        $(".removeTR").fadeOut("normal");
    }
});

$(".resetALL").live('click', function (event) {
    $("table tr:hidden").fadeIn("slow");
    var trItems = $("table tr").length;
    $(".removeTR").fadeIn("slow");
    $("span").text("This is the span.");
    $(".resetALL").fadeOut("normal");
}); 
```

您可以在下面看到我的工作示例：http: [//jsfiddle.net/YCdGQ/51/](http://jsfiddle.net/YCdGQ/51/)*

# php - Kendo Autocomplete：动态更新数据源

> ID：14485505
> 
> 赞同：1
> 
> 时间：2013-01-23T17:16:45.927
> 
> 标签：php, mysql, autocomplete, kendo-ui

我有一个工作的自动完成文本框，通过 php 文件从 mysql 服务器获取数据。

我想知道如何根据用户选择动态更改数据源，即表。自动完成功能可以重新查询新表吗？

我正在使用以下教程 [http: //www.kendoui.c​​om/blogs/teamblog/posts/12-10-02/using_the_autocomplete_with_php.aspx](http://www.kendoui.com/blogs/teamblog/posts/12-10-02/using_the_autocomplete_with_php.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:26:39.047

您可以在发送额外参数的服务器中执行此操作：

1.  使用[`transport.parameterMap`](http://docs.kendoui.com/api/framework/datasource#transportparametermap-function)）
2.  使用[`transport.read.data`](http://docs.kendoui.com/api/framework/datasource#transportreaddata-objectstringfunction)

或者您可以在客户端（浏览器）中定义：

1.  [`transport.read`](http://docs.kendoui.com/api/framework/datasource#transportread-objectstringfunction)作为加载数据的函数（可能通过ajax）。
2.  [`transport.read.url`](http://docs.kendoui.com/api/framework/datasource#transportreadurl-stringfunction)计算一个或另一个服务的 URL 的函数。

# node.js - centos / amazon linux / rhel的authbind等效项

> ID：14485515
> 
> 赞同：4
> 
> 时间：2013-01-23T17:17:12.033
> 
> 标签：node.js, networking, amazon-ec2

我想在 Amazon Linux 的 Amazon EC2 实例上的端口 80 上运行 node.js TCP 服务器。我已经将 80 添加到安全组，但问题是让 node.js 绑定到端口 80，这通常需要 root 权限。

最简单的解决方案似乎是使用 authbind，但无法从 EC2 yum repo 访问它。Amazon Linux 是否有等效的实用程序？或者这个发行版的其他一些解决方法？还是使用 authbind 实际上是个坏主意？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T12:59:58.593

我最终绑定到更高的端口，然后使用 iptables 将端口 80 流量转发到该端口。另一种选择是使用 AWS 负载均衡器从传入端口 80 到 ec2 实例上的更高端口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-04T17:28:21.720

这有点乏味，但如果你安装 gcc，你可以从源代码编译它。你可以去[这里](http://www.chiark.greenend.org.uk/ucgi/~ian/git?p=authbind.git;a=commit;h=7ad50c1428c0a3585e977bb354b7569347d21615)获取 2.1.1 版本。单击“快照”链接以获取 tar.gz 文件。我似乎无法直接使用 wget 下载它（必须从网络浏览器下载然后上传），YMMV。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-31T12:15:59.517

如果使用`systemd`，您可以使用`AmbientCapabilities`允许服务绑定到较低的端口。

这是通过`/etc/systemd/system`目录中的服务配置文件完成的：

```
[Service]
AmbientCapabilities=CAP_NET_BIND_SERVICE
... 
```

# c - 为什么 FD_ISSET 在 select() 之后返回 true

> ID：14485517
> 
> 赞同：6
> 
> 时间：2013-01-23T17:17:13.843
> 
> 标签：c, sockets, select

我是套接字编程的新手，我正在尝试彻底了解它是如何工作的，但现在我真的坚持使用`select()`.

问题是在我的代码中，在 select 检测到活动并且 fd 保持设置后，似乎在下一次迭代`FD_ISSET`时会自动返回 true，就像它会忽略 select 函数一样。问题似乎与这个问题相同，但我做了所有我在那里找到的但无济于事：[http ://compgroups.net/comp.unix.programmer/how-does-fd_isset-return-0-after-returne /55058](http://compgroups.net/comp.unix.programmer/how-does-fd_isset-return-0-after-returne/55058)

我确保`select()`在使用 Linux 之后重新初始化 timeval 变量，并且我了解此函数在不同操作系统上的行为不同，我还使用select`FD_ZERO`和之前重新初始化了 fd 集。`FD_SET`

我究竟做错了什么？这是代码：

```
#include <stdio.h>
#include <strings.h>

#include <sys/select.h>
#include <sys/time.h>

int main () {
  struct timeval tv;

  tv.tv_sec = 5; // 5 seconds timeout
  tv.tv_usec = 0;

  fd_set afds, rfds;

  FD_ZERO(&afds);
  FD_SET(0, &afds);

  while (1) {
    rfds = afds;
    select(1, &rfds, NULL, NULL, &tv);
    // linux, reinitialize tv?
    tv.tv_sec = 5;
    tv.tv_usec = 0;

    // so at this point after select runs the first time and detects STDIN activity
    // it will enter an infinite loop printing "fd 0 is set" (why?)
    if (FD_ISSET(0, &rfds)) {
      printf("fd 0 is set\n");
      FD_CLR(0, &rfds);
    } else {
      printf("fd 0 is NOT set\n");
    }
  }
} 
```

问题编辑，因为我是新用户，无法回答：

事实是我在选择之前初始化 rfds，当它被分配 afds 的值时，它又总是用 FD_ZERO(&afds); 设置。FD_SET(0, &afds); 这对我仍然不起作用。

以下是我的理解：

1.  我将标准输入文件描述符添加到 afds

2.  进入while无限循环，rfds = afds（循环开始时rfds永远是= afds）

3.  此外，此时 FD_ISSET(0, &rfds) 将始终为 != 0

4.  select 有 5 秒的超时，所以此时如果我在 5 秒过去之前没有输入任何内容，它就会退出，*UNSETTING* FD_ISSET(0, &rfds) - 对吗？因此，如果没有输入任何内容，select 实际上会取消设置 fd 0。这似乎工作正常

5.  当我在超时*之前输入一些东西时，问题就来了。*此时，FD_ISSET(0, &rfds) 返回 != 0，它打印 fd 0 is set，然后每个循环 fd 都会被设置

好的，这是准确的吗，我猜对了吗？所以实际上 select 不会等待时间过去，因为它实际上检测到 fd 已准备好并退出，设置 fd != 0 ？

这需要进一步的问题：如果我需要服务器每隔一段时间自动向多个客户端发送消息（独立于它从客户端读取的内容），是否可以通过修改代码来使用 select 和 gettimeofday以上？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-23T17:20:22.613

`select()`是电平触发的，不是边沿触发的。当您向它传递一组文件描述符时，它会回来告诉您当前哪些是可读/可写/异常的，而不仅仅是最近更改状态的那些。

在这种情况下，每次调用时 fhe FD 都被标记为可读，`select()`因为当它出现时，您没有做任何事情使其*不可读*（例如耗尽可用输入）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-23T17:25:07.647

在 select() 触发后，存储在 fd_set 中的值会保留。在应用程序中，select() 可以监视许多套接字。自动清理 fd_set 意味着您永远无法检测到多个套接字需要服务。

您需要在无限循环中执行 FD_ZERO() 和 FD_SET() ，以便在每次通过时，在调用 select() 之前干净地初始化 fd_set。

# regex - 使用正则表达式确定 bash 中的正确扩展名

> ID：14485521
> 
> 赞同：1
> 
> 时间：2013-01-23T17:17:33.137
> 
> 标签：regex, bash

想知道是否有人可以用正则表达式和 bash 帮助我。

我正在尝试对仅具有特定扩展名的文件执行一组命令，在这种情况下：mpg、mpeg、avi 和 mkv。

我实际上在这里找到了解决方案，但是，它似乎不起作用。如果有人能告诉我原因，我将不胜感激。

```
#!/bin/bash

# Configuration
TARGETDIR="$1"
TARGETEXT="(mpg|mpeg|avi|mkv)"

for d in `find $1 -type d`
do
    echo "Searching directory: $d"

    for f in "$d"/*
    do
            if [ -d "${f}" ];
            then
                    # File is a directory, do not perform
                    echo "$f is a directory, not performing ..."
            elif [ -f "${f}" ]; 
            then
                    filename=$(basename "$f")
                    extension="${filename##*.}"
                    if [ "$extension" == "$TARGETEXT" ];
                    then
                            echo "Match"
                    else
                            echo "Mismatch - $f - $extension"
                    fi
            fi
    done
done 
```

再次感谢任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T17:33:01.793

这可能仅使用`find`命令即可完成。

```
find $TARGETDIR -regex ".*\\.$TARGETEXT" -type f -exec your_command {} \; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:24:41.560

而不是直接的字符串比较

```
if [ "$extension" == "$TARGETEXT" ]; 
```

使用 Bash 正则表达式匹配语法

```
if [[ "$extension" =~ $TARGETEXT ]]; 
```

注意双 [[ ]] 和未引用的 $TARGETEXT。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T22:58:35.133

您可以在没有正则表达式的 bash 中执行此操作，只需文件模式：

```
shopt -s globstar nullglob
for f in **/*.{mpg,mpeg,avi,mkv}; do 
    if [[ -f "$f" ]]; then
        # do something with the file:
        echo "$f"
    fi
done 
```

# tfs - 重命名团队基础服务器项目的本地路径 (TFS 2010)

> ID：14485526
> 
> 赞同：2
> 
> 时间：2013-01-23T17:18:12.173
> 
> 标签：tfs, path, local

我在团队基础服务器项目上制作了“获取最新版本”。我认为（不确定）这已经在我的计算机上生成了一个本地工作区，其中放置了所有文件。现在我想重命名本地路径。我可以在 Windows 资源管理器中执行此操作还是会导致 TFS 出现任何问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:30:46.723

如果您使用的是 TFS 2010，那么它不会对 TFS 造成任何问题。TFS 将看不到在您移动它们之后之前被拉到您的工作空间的文件。就好像您在本地删除了文件一样。

但是，如果您使用的是 TFS 2012，那么您可能会遇到基于新的本地工作空间功能的无人值守后果，因为它允许您在脱机并与 TFS 断开连接时进行编辑。不过，如果您要重命名文件夹，您应该没问题。

[TFS 2012 - 本地工作空间](http://visualstudiomagazine.com/articles/2012/11/02/local-workspaces-in-tfs-2012.aspx)

# python - 没有更多连接时 asyncore.loop 不会终止

> ID：14485528
> 
> 赞同：0
> 
> 时间：2013-01-23T17:18:14.930
> 
> 标签：python, python-2.7, timeout, asyncore

我正在按照一些示例代码在`asyncore` [此处](http://www.doughellmann.com/PyMOTW/smtpd/)使用，仅在以下完整示例中设置了一个`timeout`值：`asyncore.loop`

```
import smtpd
import asyncore

class CustomSMTPServer(smtpd.SMTPServer):

    def process_message(self, peer, mailfrom, rcpttos, data):
        print 'Receiving message from:', peer
        print 'Message addressed from:', mailfrom
        print 'Message addressed to  :', rcpttos
        print 'Message length        :', len(data)
        return

server = CustomSMTPServer(('127.0.0.1', 1025), None)

asyncore.loop(timeout = 1) 
```

我预计 1 秒后会发生超时，但事实并非如此。代码运行时间超过一秒。我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:29:53.427

to的`timeout`参数是调用将等待数据`asyncore.loop()`的时间量。如果在用完`select.select`之前没有数据，它将循环并再次调用。`timeout``select.select`

同样的`channels`想法。这并不意味着打开套接字，而是意味着活动`asyncore.dispatcher`或`asynchat.async_chat`实例。如果要停止循环，则必须在注册的**所有**实例`close()`上调用该方法。

 **在您的情况下`server.close()`，将关闭实例/通道并将其从`asyncore`循环中删除。如果没有更多通道处于活动状态，则此循环将自行终止。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:30:33.890

我真的不知道`timeout`参数是否`asyncore.loop()`真的意味着`asyncore.loop()`在指定时间后使函数调用超时，但这里有一个收据，使该函数在指定时间后超时（替换`asyncore.loop()`示例代码中的行）：

```
import signal

class TimeoutError(Exception): pass

# define the timeout handler
def handler(signum, frame):
    raise TimeoutError()

# set the timeout handler and the signal duration
signal.signal(signal.SIGALRM, handler)
signal.alarm(1)
try:
    asyncore.loop()
except TimeoutError as exc:
    print "timeout"
finally:
    signal.alarm(0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T22:07:18.157

asyncore.loop() 的超时时间是 select() 的超时时间。

它没有用，因为当 select() 超时时，它会循环回来，请参见伪代码：

```
while True:
    do_something()
    select(...)
    do_something_else() 
```

如果我使用带有防火墙的套接字进行模拟，在我的 Python 2.7.3 asyncore.loop() 超时 1 分钟后没有从某个套接字接收到数据。

我发现在 asyncore.dispatcher “子类”中有以下方法非常有用：

```
def handle_error(self):
    raise 
```

这样我就有了“正确的”异常转储。

因为我不想有例外，后来我把它改成了：

```
def handle_error(self):
    print "Error downloading %s" % self.host
    pass 
```

现在我的代码正常工作，无一例外。

我没有找到控制超时的方法。**

# javascript - 高效填充下拉列表：Javascript 与数据库 (Mysql-Django)

> ID：14485529
> 
> 赞同：0
> 
> 时间：2013-01-23T17:18:17.393
> 
> 标签：javascript, mysql, django, drop-down-menu, web

我想要 3 个下拉列表，就像

选择：州
选择城市
选择：餐厅

当第一个下拉列表选择了一个项目时，“选择城市”列表被更新，当第二个下拉列表选择了一个项目时，最后一个被更新。

我被困在三种方法之间：

1.  使用 Javascript 输入所有可能的值。并`form onchange`用于调用更新方法。
2.  从数据库（MySQL）预填充下拉列表。
3.  前两个的混合体 - 前两个与 Jscript，最后一个来自数据库。

现在，托管、VPS 和 PAAS 的每种方法的性能和优缺点如何比较？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:29:09.123

为了可用性起见，我将使用 Ajax 调用更新选择框。

选择这种方法的另一个好处是您的应用程序逻辑主要保留在服务器端，在大多数情况下更容易为其编写测试。

您可以通过在您的视图中查询并将结果传递给您的模板来填充第一个选择框。如果您禁用其他 2 个选择框，您可以在通过 ajax 调用选择第一个后激活/填充它们。

# facebook-graph-api - 错误：“消息”：“未知路径组件：/photos&callback=”代码：2500”

> ID：14485537
> 
> 赞同：2
> 
> 时间：2013-01-23T17:18:57.883
> 
> 标签：facebook-graph-api

我在这里使用了代码：[code](http://i.stack.imgur.com/pvtJ1.jpg)

但是此代码不再起作用，我需要此代码将 fb 相册嵌入我的网站。所以当我搜索问题时出现了这个：

“错误”：{“消息”：“未知路径组件：/photos&callback=”，“类型”：“OAuthException”，“代码”：2500

所以，如果有人可以帮助我。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T17:35:28.740

你在打电话`<ID>/photos&callback=....`

它应该是`<ID>/photos?callback=...`

这 '？' 字符应该标记查询字符串参数的开始，而不是'&'

# c# - 泛型类作为返回类型

> ID：14485540
> 
> 赞同：2
> 
> 时间：2013-01-23T17:19:08.300
> 
> 标签：c#, generics, return-type, idictionary

我有一个使用泛型来保存不同值的存储类。

```
public class Setting<T>
{
    ...
} 
```

在另一个类中，我想制作一个类似的方法

```
 public Setting<T> getSetting(string setting)
  {
        return (Setting<T>)settingDictionary[setting];
  } 
```

哪里设置字典是

```
 private Dictionary<string, object> settingDictionary; 
```

我得到错误：

> 找不到类型或命名空间名称“T”（您是否缺少 using 指令或程序集引用？）

有没有办法解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:20:33.943

您需要使方法通用：

```
 public Setting<T> GetSetting<T>(string setting)
 {
   // ... Your code... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:21:11.057

你的`Setting<T>`类没有实现[`Dictionary<string, object>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)，所以你应该让你的方法*[`generic type`](http://msdn.microsoft.com/en-us/library/512aeb7t.aspx)*像 `GetSetting<T>`

```
public Setting<T> GetSetting<T>(string setting)
 {

 } 
```

这是一个[**`DEMO`**](http://ideone.com/b1e1wj).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:22:34.387

好吧，编译器不知道“ `T`”是什么，您可以将其定义为方法上的泛型，如下所示：

```
public Setting<T> getSetting<T>(string setting) 
```

# jquery - Jquery在mouseout上淡出图标回到它在mouseenter之前的值

> ID：14485541
> 
> 赞同：0
> 
> 时间：2013-01-23T17:19:09.720
> 
> 标签：jquery, css, fadeto

我有这段代码，它在 mouseenter 上将一些图标淡化为不透明度 1.0，在 mouseleave 上淡化为 0.3。它工作得很好，除了我在不同的响应视图中将这些图标设置为不透明度 0.13，但下面的代码仍然将它们淡化回 0.3 而不是鼠标移出时的 0.13，这不是我想要的。

```
$(".social-holder img").on("hover", function(e) {
    if(e.type == "mouseenter") {
        $(this).fadeTo('fast', 1.0);
    }
    else if (e.type == "mouseleave") {
        $(this).fadeTo('fast', 0.3);
    }
}); 
```

我尝试了下面的代码，但我不明白为什么它不起作用。它在 mouseleave 上将图标留在 1.0

```
$(".social-holder img").on("hover", function(e) {
    var currentOpacity = $(this).css('opacity');
    if(e.type == "mouseenter") {
        $(this).fadeTo('fast', 1.0);
    }
    else if (e.type == "mouseleave") {
        $(this).fadeTo('fast', currentOpacity);
    }
}); 
```

顺便说一句，当我使用控制台检查时，var currentOpacity 似乎工作正常，但它似乎没有进入 else if 语句。也许我对范围或其他东西有一些误解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:24:54.670

您的代码不起作用，因为每次调用处理程序时，都会`currentOpacity`发生变化。因此，在鼠标离开时，将执行以下代码：

```
 var currentOpacity = $(this).css('opacity');
 $(this).fadeTo('fast', currentOpacity); 
```

这是一种不做任何事情的精巧方式:-)

请改用此代码：

```
if(e.type == "mouseenter") {
    // Either preserve the saved value or get current opacity
    var origOpacity = $(this).data('origOpacity') || $(this).css('opacity');
    $(this).fadeTo('fast', 1.0).data('origOpacity', origOpacity);
}
else if (e.type == "mouseleave") {
    var origOpacity = $(this).data('origOpacity');
    $(this).fadeTo('fast', origOpacity, function(){ $(this).removeAttr('style'); });
} 
```

这将在元素的数据映射中保存输入时的不透明度并从那里取回。

# c++ - 为什么这个表达式中的所有值都为零？

> ID：14485547
> 
> 赞同：0
> 
> 时间：2013-01-23T17:19:30.937
> 
> 标签：c++

以下是用于推断 2 条线是否相交的程序片段。 `P and P2`是`CPoint`标记两条线之一的起点和终点的对象。

```
double m1,m2;  //slopes
double b1,b2;     //y-intercepts
double y,x;     //intersection point

m1=(max(P.y,P2.y) - min(P.y,P2.y)) /( max(P.x,P2.x) - min(P.x,P2.x) ); 
```

出于某种原因，我总是`m1`会这样`0`。为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:28:27.290

如果你的`CPoint`类是一个整数坐标的点，你必须在这里做一些转换才能得到你想要的结果。请参阅以下问题演示。考虑两点`P = (1, 4)`和`P2 = (5, 3)`：

```
m1=( max(P.y,P2.y) - min(P.y,P2.y) ) / ( max(P.x,P2.x) - min(P.x,P2.x) );
     ^^^^^^^^^^^^^   ^^^^^^^^^^^^^       ^^^^^^^^^^^^^   ^^^^^^^^^^^^^
           4               3                    5               1
   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                   1                                   4 
```

但是，在整数除法中，`1 / 4`是`0`，但您希望结果是`0.25`。结果变量具有类型的`double`事实不会改变*表达式*的值（和类型） 。

要解决这个问题，您必须在表达式的各个部分被视为非整数*之前*对其进行*转换。*在您的情况下，这是除法的操作数，因此它将是浮点除法。（铸造除法的结果也无济于事。）

 *```
m1 = static_cast<double>( max(P.y,P2.y) - min(P.y,P2.y) )
   / static_cast<double>( max(P.x,P2.x) - min(P.x,P2.x) ); 
```

请注意，强制转换第二个操作数是可选的，因为`double / int`始终使用浮点除法。

**另请注意，您的表达式计算斜率的*绝对值*。您可能想要计算有*符号*斜率。**

* * *

你可以在你的代码中改进的东西（这不会解决上面的问题）：而不是减去差的最大值的最小值，只需取差的绝对值：

```
m1 = static_cast<double>( abs(P.y - P2.y) )
   / static_cast<double>( abs(P.x - P2.x) ); 
```

由于在 C++ 中，`abs`是一个模板函数（在 C 中它是一个宏，呃...），您还可以使用显式模板类型强制结果类型：

```
m1 = abs<double>(P.y - P2.y)
   / abs<double>(P.x - P2.x); 
```

此外，由于计算两个给定点之间的斜率似乎是一个常用函数，因此您可以将其实现为两个`CPoint`s 上的独立函数：

```
double absoluteSlope(const CPoint & p, const CPoint & q) {
    return abs<double>(p.y - q.y) / abs<double>(p.x - q.x);
} 
```

更好的是，要使用 C++ 模板，请在具有成员`x`和的泛型类上实现它`y`：

```
template<class T>
double absoluteSlope(const T & p, const T & q) {
    return abs<double>(p.y - q.y) / abs<double>(p.x - q.x);
} 
```

此解决方案现在适用于您的`CPoint`具有整数坐标的实例以及`CPointF`具有浮点/双坐标的（可能即将推出的）类。

**正如上面已经警告过的，这会计算绝对斜率。**要将其更改为数学上正确（有符号）的斜率，只需替换`abs`为`static_cast`：

```
template<class T>
double slope(const T & p, const T & q) {
    return static_cast<double>(p.y - q.y) / static_cast<double>(p.x - q.x);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:10:54.360

除法 A/B 应为 A/(double)B。在您的代码中使用它。Fabs 而不是 abs。*

# iphone - 带有自动调整大小的 UITabBar

> ID：14485551
> 
> 赞同：0
> 
> 时间：2013-01-23T17:19:35.740
> 
> 标签：iphone, ios, objective-c, ipad, cocoa-touch

我`UITabBar`在 iPhone 和 iPad 应用程序中使用 a，但是当我进入横向模式时，自动调整大小在 iPad 上不起作用（它在 iPhone 上工作正常）。

```
{
    tabBarController =[[UITabBarController alloc]init];
    tabBarController.delegate=self;
    self.tabBarController.viewControllers = [NSArray arrayWithObjects:navController1,navController2, navController3,navController4,navController5,nil];
    tabBarController.selectedViewController = navController1;
    imgTab = [[UIImageView alloc]initWithFrame:CGRectMake(0,0,768.0,51)];
    [imgTab setAutoresizingMask: UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth |UIViewAutoresizingFlexibleBottomMargin |   UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin]; imgTab.image=[UIImage imageNamed:@"footerbg.jpg"];
    [tabBarController.tabBar addSubview:imgTab];
    accountImg=[[UIImageView alloc]initWithFrame:CGRectMake(150.0,5.0,29.0,29.0)];
    [accountImg setAutoresizingMask: UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth |UIViewAutoresizingFlexibleBottomMargin |   UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin];
    accountImg.image=[UIImage imageNamed:@"click11.png"];
    UITabBarItem *tabItem = [[[tabBarController tabBar] items] objectAtIndex:0];
    [tabItem setTitle:@"Task"];
    [imgTab addSubview:accountImg];
    staffImg=[[UIImageView alloc]initWithFrame:CGRectMake(255,5.0,29.0,29.0)];
    staffImg.image=[UIImage imageNamed:@"spreadsheet11-1.png"];
    UITabBarItem *tabItem1 = [[[tabBarController tabBar] items] objectAtIndex:1];
    [tabItem1 setTitle:@"SpreadSheet"];
    [staffImg setAutoresizingMask: UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth |UIViewAutoresizingFlexibleBottomMargin |   UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin];
    [imgTab addSubview:staffImg];
    taskImg=[[UIImageView alloc]initWithFrame:CGRectMake(370.0,5.0,29.0,29.0)];
    taskImg.image=[UIImage imageNamed:@"calendar2.png"];
    UITabBarItem *tabItem2 = [[[tabBarController tabBar] items] objectAtIndex:2];
    [tabItem2 setTitle:@"Calendar"];
    [taskImg setAutoresizingMask: UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth |UIViewAutoresizingFlexibleBottomMargin |   UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin];
    [imgTab addSubview:taskImg];
    spreadImg =[[UIImageView alloc]initWithFrame:CGRectMake(472.0,5.0,29.0,29.0)];
    spreadImg.image=[UIImage imageNamed:@"message22.png"];
    UITabBarItem *tabItem3 = [[[tabBarController tabBar] items] objectAtIndex:3];
    [tabItem3 setTitle:@"Message"];
    [spreadImg setAutoresizingMask: UIViewAutoresizingFlexibleHeight |   UIViewAutoresizingFlexibleWidth |UIViewAutoresizingFlexibleBottomMargin |   UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin];
    [imgTab addSubview:spreadImg];

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:33:34.323

我在此代码中没有看到您为 UITabBar 配置 UIAutoresizingMask 的任何地方，仅针对其中的项目。

# php - 用jQuery链接的PHP动态表

> ID：14485552
> 
> 赞同：1
> 
> 时间：2013-01-23T17:19:40.517
> 
> 标签：php, jquery, html-table

我的问题是我无法获取对话框 div 和其中的所有其他 div 来根据所选图像显示动态变量。

我希望能够动态显示用户图片表，并且当单击包含动态表的 div 上的图片时，会淡入黑色，并且使用 JQUERY 显示包含用户图片和其他信息的弹出窗口。一切正常，但随后弹出显示用户单击的相应变量。

从`$memberdisplaylist`td 内部开始，`$firstname`并`$member_pic`根据数组正确显示，但是当`$member_pic`单击 时，对话框 div 弹出窗口继续显示第 1 行的变量，并且不显示与`$member_pic`所选行相关的变量。关于我做错了什么以及如何解决这个问题的任何想法？

还有人知道我需要在包含动态表的 profilepicsdark div 中将对话框 div 弹出窗口居中的 jQuery 编码吗？

**PHP**

```
$MemberDisplayList = "<table border='0' align='left' cellpadding='7'>";
$sql = mysql_query("SELECT * FROM users WHERE email_activated='1'");
$counter = 0;
while($row = mysql_fetch_array($sql)){
    $id = $row["id"];
    $firstname = $row["first_name"];
    $sex = $row["sex"];
    $age = $row["age"];
    $focus = $row["focus"];
    $lastlog = $row["last_log_date"];
    $firstnameCut = substr($firstname, 0, 10);
    $check_pic = "members/$id/image01.jpg";
    if (file_exists($check_pic)) {
        $member_pic = "<img src=\"members/$id/image01.jpg\" width=\"100px\" border=\"0\" />";
    } else {
        $member_pic = "<img src=\"members/0/image01.jpg\" width=\"100px\" border=\"0\" />";
    }
    if( $counter % 7 == 0)
    $MemberDisplayList .= '<tr>';
    $counter++;
    $MemberDisplayList .= '<td>';
    $MemberDisplayList .= '<a href="" title="' .    $firstname . '"><font size="-2">' . $firstnameCut . '</font></a><br /><div class="memberpreviewpopup" style=" height:100px; overflow:hidden;">' . $member_pic . '</div><div class="boxes"><div id="dialog" class="window"><div id="title">' . $member_pic . '</div><div id="info">' . $firstname . '</div><div id="info">' . $lastlogdate . '</div><div id="info">' . $sex . '</div><div id="info">' . $age . '</div><div id="info">' . $focus . '</div><a href="" class="close"/>Close it</a><a href="profile.php?id=' . $id . '">View Profile</a></div></div></td>';
    if( $counter % 7 == 0) 
        $MemberDisplayList .= '</tr>';

} // close while loop

$MemberDisplayList .= "</table>"; 
```

**查询**

```
<script type="text/javascript">
            function codeBinsAddEvent(obj,type,fn){
                if(obj.attachEvent){
                        if(type == "load"){
                            obj.attachEvent('on'+type, fn);
                        }
                        else{
                            obj.attachEvent('onreadystatechange', fn);
                        }
                        /*
                    obj['e'+type+fn]=fn;
                    obj[type+fn]=function(){
                        obj['e'+type+fn](window.event)}
                    ;obj.attachEvent('on'+type,obj[type+fn])*/
                 }
                else obj.addEventListener(type,fn,false)
            };
            function codeBinsAddLoadEvent(fn){
                codeBinsAddEvent(document.addEventListener&&!window.addEventListener?document:window,'load',fn)
            };
            function codeBinsAddReadyEvent(fn){
                codeBinsAddEvent(document,'DOMContentLoaded',fn)
            };

</script>   

<script type="text/javascript">
  $(function() {
    $(".memberpreviewpopup").click(function(e) {
        e.preventDefault();
        var $dialog = $("#dialog");
        var maskHeight = $('.profilepics').height();
        var maskWidth = $('.profilepics').width();
        $('#profilepicsdark').css({
            'width': maskWidth,
            'height': maskHeight
        });
        $('#profilepicsdark').fadeIn(100);
        $('#profilepicsdark').fadeTo("fast", 0.8);
        var winH = $('.profilepics').height();
        var winW = $('.profilepics').width();
        $('#profilepicsdark').css('top', winH / 2 - $dialog.height() / 2);
        $('#profilepicsdark').css('left', winW / 2 - $dialog.width() / 2);
        $dialog.fadeIn(400);

    });

    $('.window .close').click(function(e) {
        e.preventDefault();
        $('#profilepicsdark').hide();
        $('.window').hide();
    });
    $('#profilepicsdark').click(function() {
        $(this).hide();
        $('.window').hide();
    });

});
</script> 
```

**CSS**

```
<style type="text/css">
#profilepicsdark{
  width: 100%;
  height: 100%;
  z-index:9000;
  background-color:#000;
  opacity:0.5;
  display:none;
}
#dialog{
  position: absolute;
  padding:0px;
  width:250px;
  height:250px;
  background-color:#d4e1ff;
  display:none;
  z-index:99999;
}
#dialog #msg{
  margin-left:20px;
  padding:5px;
  font-size:14px;
}
#dialog #title{
  margin:0px;
  padding:5px;
  float: left;
}
#dialog #info{
  width: 100px; 
  margin-right:20px;
  padding:5px;
  font-size:14px;
  float: right;
  text-align:right;
}
#dialog .close{
  float:right;
  background:#afa1f5;
  bordercolor:1px solid #445cd88;
  border-radius: 1.2em;
  width:100px;
  text-align:center;
  font-size:13px;

}
#dialog .close:hover{
  background:#af55d9;
  bordercolor:1px solid #445cd88;
}
</style> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T06:38:25.480

我想我知道你在这里想要完成什么。发生的情况是调用 #dialog div 时没有您正在查看预览的成员的上下文。

这有点混乱，但是如果您进行以下调整，您应该即将在上下文中调用#dialog。

HTML：

```
$MemberDisplayList .= '
<a href="" title="'.$firstname.'"><font size="-2">' . $firstnameCut . '</font></a>
<br />
<div class="memberpreviewpopup" member_id="'.$id.'" style=" height:100px; overflow:hidden;">
    '.$member_pic.'
</div>
<div class="boxes">
    <div id="dialog" member_id="'.$id.'" class="window">
        <div id="title">' . $member_pic . '</div>
        <div id="info">' . $firstname . '</div>
        <div id="info">' . $lastlogdate . '</div>
        <div id="info">' . $sex . '</div>
        <div id="info">' . $age . '</div>
        <div id="info">' . $focus . '</div>
        <a href="" class="close"/>Close it</a>
        <a href="profile.php?id=' . $id . '">View Profile</a>
    </div>
</div>
</td>'; 
```

Javascript：

```
$(".memberpreviewpopup").click(function(e) {
    e.preventDefault();
    // This has been updated ==============
    var member_id = $(this).attr('member_id');
    var $dialog = $('#dialog[member_id="'+member_id+'"]');
    // ====================================
    $('#profilepicsdark').css({
        'width': maskWidth,
        'height': maskHeight
    });
    $('#profilepicsdark').fadeIn(100);
    $('#profilepicsdark').fadeTo("fast", 0.8);

    var winH = $('.profilepics').height();
    var winW = $('.profilepics').width();

    // This should fix the alignment issue with the box you mentioned ====
    var profilepicsdark_top = winH / 2 - $dialog.height() / 2;
    var profilepicsdark_left = winW / 2 - $dialog.width() / 2;
    $('#profilepicsdark').css('top', profilepicsdark_top); 
    $('#profilepicsdark').css('left', profilepicsdark_left);
    $dialog.css('top', profilepicsdark_top*2);
    $dialog.css('left', profilepicsdark_left*2);
    // ===================================================================

    $dialog.fadeIn(400);
}); 
```

# php - 加载文件或 blob 的域驱动设计方法？

> ID：14485554
> 
> 赞同：1
> 
> 时间：2013-01-23T17:19:51.073
> 
> 标签：php, domain-driven-design, persistence-ignorance

我试图保持我的实体持久性和服务无知，但是当涉及到实体的 BLOB 和文件对应属性时，我遇到了障碍。假设我在聚合中有一个像这样的实体（例如保持基本）：

```
class Attachment
{
    private $_ownerId;
    private $_filename;
    private $_type;
    private $_size;

    public function __construct ($ownerId, $filename, $type, $size)
    {
        $this->_ownerId = $ownerId;
        $this->_filename = $filename;
        $this->_type = $type;
        $this->_size = $size;
    }

    // some getters, etc.
} 
```

我已经考虑或正在考虑的方法：

1.  创建一个服务接口，'FileProvider' 或类似的方法`load (Attachment $file)`，其实现者知道如何获取和返回文件的二进制文件
    *   这允许数据访问逻辑的多种实现（FileProviderMysql、FileProviderDirectory、FileProviderRemoteFTP 等）
    *   这似乎符合 Eric Evans 将服务类描述为封装了似乎不适合实体或值对象的行为的对象
    *   在 Evans 的书中也有示例，其中服务类使用简化的、意图揭示的接口封装对笨拙或遗留接口的访问
2.  可能将所述接口的实现注入实体本身，以便可以使用与其任何其他属性相同的语法即时获取实体的内容
    *   这样，聚合的存储库（或其当前策略）将能够注入与当前存储实现相对应的服务实现，从而使客户端和应用程序服务免于进行该调用
    *   但是，我不确定实体是否应该真正“了解”服务接口

在这种情况下有经验的人可以权衡一下并帮助我做出决定吗？我想确保我正在做的工作能够坚持下去。谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:34:22.573

我会采用方法 1，它可以是域服务或存储库。无论哪种方式，对与 Attachment 对应的 BLOB 的访问都会被封装。

考虑您需要访问 BLOB 的点也很重要。任何与域相关的行为都需要它吗？还是更多的是基础设施问题？

**更新**

方法#2 的好处是增加了对与实体相关的行为的封装。如果在这种情况下`Attachment`引用了用于加载 blob 的服务，则可以在不需要额外依赖项的情况下传递该实体。这似乎也是一种更自然的方法。既然`Attachment`实体提供对其他字段的访问，为什么不提供 blob？

然而，这种方法有几个缺点。通常不鼓励让实体引用服务或存储库，因为它可能导致职责交叉，并且使对实体行为的推理更加困难，尤其是在依赖项本身是抽象的情况下。相反，最好确定需要 BLOB 的用例，并在实现这些用例的代码中引用此服务，通常是周围的应用程序服务。

# dictionary - 如何找到不同语言单词列表的资源？

> ID：14485555
> 
> 赞同：1
> 
> 时间：2013-01-23T17:19:52.477
> 
> 标签：dictionary, localization, puzzle

[嗨，我在这里](http://svn.pietdepsi.com/repos/projects/zyzzyva/trunk/data/words/French/ODS5.txt)寻找与此类似的不同语言单词列表，以便我可以本地化我创建的单词益智游戏我似乎找不到任何好的链接，我找到了一个波兰语 .txt 文件，但那是因为我让我的波兰朋友用他的语言搜索。任何帮助都会非常感谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T20:18:41.807

即使在使用波兰语查询进行搜索时，我也不太成功。如果您在 Ubuntu 上，您可能需要考虑安装诸如[wpolish](http://www.ubuntuupdates.org/package/core/quantal/main/base/wpolish)、[witalian](https://launchpad.net/ubuntu/precise/+package/witalian)、[wpanish](https://launchpad.net/ubuntu/hardy/+package/wspanish)或其他可用的软件包（其他语言可能很容易找到，我想我在这里看到了一个模式......）。

这些将存储巨大的单词列表文件`/usr/share/dict/`，您至少可以在其中查找单词以确定它们是否存在。

# jquery - 使用 jquery 下载多个图像文件

> ID：14485557
> 
> 赞同：0
> 
> 时间：2013-01-23T17:19:55.697
> 
> 标签：jquery

我目前正在尝试制作一个程序，用户可以在其中选择他们想要下载的每个图像，然后在不使用任何 zip 文件的情况下下载它们。它目前有效，但它必须为每个链接打开一个新窗口。我想知道是否有人对如何在不为每次下载打开窗口的情况下执行此操作有更好的建议，并且仍然相对容易设置？我目前正在使用来自 joomlaworks sigpro 的 download.php 文件作为简单的下载解决方案，只需在窗口 url 中指向它即可。

我的代码：

```
$('.finishselect').click(function(){

        $( ".selected" ).each(function () {
            var $href = $(this).parent().children('img').attr('src'),
                $hrefShort = $href.replace('http://example.com/plugins/content/gallery/gallery/thumbs/', 'images\\Pics/');
                window.open("/plugins/content/jw_sigpro/jw_sigpro/includes/download.php?file=" + $hrefShort);
            });
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:23:58.833

您可以使用 iframe 并将 iframe src 设置为下载。

```
$( ".selected" ).each(function () {
  var $href = $(this).parent().children('img').attr('src'),
                $hrefShort = $href.replace('http://example.com/plugins/content/gallery/gallery/thumbs/', 'images\\Pics/');

  var $iframe = $('<iframe />');
  $iframe.attr('src', "/plugins/content/jw_sigpro/jw_sigpro/includes/download.php?file=" + $hrefShort);

  $iframe.css('visibility', 'hidden');
  $iframe.css('height', '0');

  $iframe.appendTo(document.body);
}); 
```

如果你真的想要的话，你可以然后清理 iframe（例如从 DOM 中删除它们），但你不应该这样做。

# vb.net - 多个动作作为变量？

> ID：14485559
> 
> 赞同：0
> 
> 时间：2013-01-23T17:19:58.090
> 
> 标签：vb.net

欢迎，我怎样才能将多个动作作为变量？

喜欢

```
checkbox1.enabled = false
checkbox2.enabled = false
checkbox3.enabled = false 
```

我会在许多对象代码中这样写

有没有办法把它们都放在变量中？

编辑：

我也可以使用潜艇，更容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:28:47.607

如果您使用您在问题中使用的相同命名法，这应该有效：

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    For i As Integer = 1 To 10
        Dim chk() As Control = Me.Controls.Find("CheckBox" & i.ToString(), False)
        If chk(0) IsNot Nothing Then
            DirectCast(chk(0), CheckBox).Checked = Not DirectCast(chk(0), CheckBox).Checked
        End If
    Next
End Sub 
```

当然，这只是一个切换复选框的示例。

**编辑**：

```
''' <summary>
''' Returns true if all of the checkboxes are checked, false if at least one of them is unchecked.
''' </summary>
Function AllChecked() As Boolean
    For i As Integer = 1 To 10
        Dim chk() As Control = Me.Controls.Find("checkbox" & i.ToString(), False)
        If chk(0) IsNot Nothing Then
            If Not DirectCast(chk(0), CheckBox).Checked Then
                Return False 'Not all of the checkboxes are checked
            End If
        End If
    Next
    Return True 'All of the found checkboxes were checked.
End Function 
```

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:24:59.720

```
 public bool EnableChecks
    {
        set
        {
            checkbox1.Enabled = checkbox2.Enabled = checkbox3.Enabled = value;
        }
    } 
```

然后您只需将 EnableChecks 设置为 true 或 false。这是你要求的吗？

编辑：我个人不会这样做，因为我觉得 getter 和 setter 不应该用于此。会创建一种启用/禁用它们的方法吗？

```
 public bool EnableChecks(bool enabled)
    {
        checkbox1.Enabled = checkbox2.Enabled = checkbox3.Enabled = enabled;
    } 
```

# c# - EDM 查询关联

> ID：14485560
> 
> 赞同：0
> 
> 时间：2013-01-23T17:19:59.950
> 
> 标签：c#, database, entity-framework

实体框架的好处是，它隐藏了完整的 n..m 关联问题。

现在我有一些非常简单的数据库包含

```
Person (Id, Name)
Profession (Id, Designation) 
```

这两者之间存在 n..m 关联，这意味着每个人都可以拥有多个职业，并且每个职业都可以由多个人执行。此关联建立在每个实体中的 Id 之上。

现在我想拥有这些协会，但似乎没有办法得到那些。

如果我查询像这样的人

```
using (PersonDataModelContainer dmc = new PersonDataModelContainer())
{
    var persons = (from p in dmc.Persons
                   where p.Id == personId
                   select p).ToList();
} 
```

有一个成员“职业”，但它是空的。在 Associationstable 中有对应于此 Person.Id 的条目。

我在该查询返回的单个对象中的某处看到非公共成员中存在关系。

我怎样才能读到那些？我相信不应该那么难，但我无法通过谷歌找到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:24:22.517

```
using (PersonDataModelContainer dmc = new PersonDataModelContainer())
{
    var persons =  dmc.Persons
                   .Include("Profession")
                   .Where(p.Id == personId)
                   .ToList();
} 
```

# java - Maven 和 gwt 项目

> ID：14485565
> 
> 赞同：2
> 
> 时间：2013-01-23T17:20:17.537
> 
> 标签：java, gwt, maven

我是新用户。我需要一个使用 gwt 依赖的 Maven 项目。我可以使用哪种原型？项目作为新的 GWT Web 应用程序，并且在构建 maven 之后自然比具有 gwt 原型的 maven 项目更好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-24T10:37:41.350

看：

*   [https://code.google.com/p/google-web-toolkit/wiki/WorkingWithMaven](https://code.google.com/p/google-web-toolkit/wiki/WorkingWithMaven)
*   [https://github.com/tbroyer/gwt-maven-archetypes](https://github.com/tbroyer/gwt-maven-archetypes)（这些是我的；[介绍性博客文章](http://tbroyer.posterous.com/announcing-gwt-maven-archetypes-project)）
*   [https://github.com/branflake2267/Archetypes](https://github.com/branflake2267/Archetypes)

我建议**不要**使用 gwt-maven-plugin 中的原型。对于已经掌握 GWT 和 Maven 但肯定需要一些改进的人来说，这没关系。gwt-maven-plugin 有很多好主意，但执行得很糟糕；我的建议是仅将它用于它的`compile`目标`generateAsync`和可能`mergewebxml`，并从您的 IDE（带有 Google Plugin for Eclipse 的 Eclipse 或 IntelliJ IDEA Ultimate Edition）运行 DevMode。`gwt:run`如果您更喜欢普通的 Maven，则可以正常工作，但它确实最适合单模块 Maven 项目，我不建议使用 GWT。

免责声明：我是 gwt-maven-plugin 的维护者之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:00:35.483

我有一个[使用 GWT 和 Maven 的旧配方](http://www.vertigrated.com/blog/2011/02/working-maven-3-google-app-engine-plugin-with-gwt-support/)，它应该只需要对插件版本进行一些小的编辑即可使其与最新版本一起使用。

我总是从 Maven 开始，生成我的项目结构，然后将其导入到我的 IDE 中，从 IDE 开始并向后退只是要求一个痛苦的世界。所以手工构建你的结构，或者更好的是使用原型是首选的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T03:51:47.020

我们只是从 GWT 示例/示例项目 pom 开始，然后从那里向上/向下工作。如果我们需要从依赖项中添加更多功能，或者如果我们需要较少的功能，我们会删除示例文件中提供的依赖项。

[您可以在此处](http://code.google.com/p/google-web-toolkit/source/browse/#svn/trunk/samples)找到 GWT Trunk 中的最新示例 pom 文件。

*   dynatablerf
*   验证
*   移动网络应用

注意 - 我们确实更新了 pom 文件中的**插件**版本以访问一些更前沿的东西。

# php - Foreach $_session[array] 然后使用结果作为 switch - case 值

> ID：14485572
> 
> 赞同：0
> 
> 时间：2013-01-23T17:20:34.543
> 
> 标签：php, session, foreach, switch-statement, case

我有这个代码

```
<?php 
        session_start();

switch($sb) {

   foreach ($_SESSION['myarray'] as $result){

     case $result:
 echo "id"$result;
 break;
   }
 }
?> 
```

这给了我以下错误，我不知道为什么：

解析错误：语法错误，意外的 T_FOREACH，在 foreach 行上需要 T_CASE 或 T_DEFAULT 或 '}'。

虽然这有效：

```
<?php

    foreach ($_SESSION['myarray'] as $result){
         echo "SB: ".$result.",<br>";
    }

 ?> 
```

并输出为：

SB id: 1, SB id: 2, SB id: 3, SB id: 4, SB id: 10, SB id: 11, SB id: 12, SB id: 13,

任何人都可以看到有什么问题吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:22:45.060

您不能将 foreach 直接放在 switch 语句中

[请参阅此处](http://php.net/manual/en/control-structures.switch.php)的文档

开关应如下所示：

```
switch($val){
 case 1:
  //some code... you can put a foreach here
  break;
 case 2:
  //you could do this if you want:
  foreach ($myArray as $key => $value){
    //do some stuff!
  }
  break;
 default:
  //some code for a default case
  break;
} 
```

另外，`echo "id"$result;`会给你带来麻烦。那应该有它之间的连接运算符

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:22:50.110

语言结构被定义为`switch`它只能由案例组成，而不是像你的`for-each`.

# sql - SQL获取不在列表中的项目

> ID：14485573
> 
> 赞同：6
> 
> 时间：2013-01-23T17:20:34.390
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我正在使用 MS SQL Server 2008 R2，并且我有一个来自电子表格的电子邮件列表，我将其插入到针对用户表的查询中。在列表中的 821 封电子邮件中，它返回了 759 行。有没有简单的方法让它返回那些不在表格中的电子邮件？我只有对数据库的读取权限，因此无法使用电子邮件列表创建表 - 只能获取结果。这是我用来获取那些电子邮件列表的查询的简化版本：

```
select *
from UserTbl
where username in ('email1','email2','email3',...'email821') 
```

我可以想出一个 Unix shell 解决方案，但是知道如何在 MS SQL 中完成它会更有用。我实际上从stackoverflow（“T-SQL：如何选择不在表中的值列表中的值？”）中找到了接近解决方案的东西，但它似乎对我不起作用（对于我的需要，我只想要不在表格输出中的列表）：

```
SELECT username,
    CASE
        WHEN EXISTS(SELECT * FROM UsersTbl tu WHERE E.email = tu.username) THEN 'Exist'
        ELSE 'Not Exist'
    END AS
FROM (VALUES('email1'),('email2'),('email3'),('email4')) E(email) 
```

当我运行查询时，这给了我错误“关键字'FROM'附近的语法不正确”。顺便说一句，我在谷歌上四处寻找上面使用的 VALUES 关键字的描述，但没有发现任何有用的信息。

如果有人可以帮助我解决这个问题，将不胜感激。

谢谢，本

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-23T18:00:33.003

如果您只想要尚不存在的电子邮件列表，这似乎要简单得多：

```
SELECT e.email
FROM 
(
  VALUES('email1'),('email2'),('email3'),('email4')
) AS e(email)
WHERE 
NOT EXISTS
(
  SELECT 1
    FROM dbo.UsersTbl 
    WHERE username = e.email
); 
```

或者更简单：

```
SELECT e.email 
FROM 
(
  VALUES('email1'),('email2'),('email3'),('email4')
) AS e(email)
EXCEPT
SELECT username FROM dbo.UsersTbl; 
```

要了解为什么我更喜欢/`NOT EXISTS`或其他替代方案，请参阅：`EXCEPT``LEFT JOIN`

[http://www.sqlperformance.com/2012/12/t-sql-queries/left-anti-semi-join](http://www.sqlperformance.com/2012/12/t-sql-queries/left-anti-semi-join)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T17:25:55.990

似乎您只是在“AS”之后缺少别名

```
SELECT username,
    CASE
        WHEN EXISTS(SELECT * FROM UsersTbl tu WHERE E.email = tu.username) THEN 'Exist'
        ELSE 'Not Exist'
    END AS doesExist
FROM (VALUES('email1'),('email2'),('email3'),('email4')) E(email) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-23T17:27:10.670

您所拥有的非常接近，您只需要实际指定第二列的别名。另外，我认为您想选择`E.email`，而不是空`username`列（如果您要重新加入表格）

```
SELECT E.email,
    CASE
        WHEN EXISTS(SELECT * FROM UsersTbl tu WHERE E.email = tu.username) THEN 'Exist'
        ELSE 'Not Exist'
    END AS ex
FROM (VALUES('email1'),('email2'),('email3'),('email4')) E(email) 
```

虽然，要获取未导入的电子邮件列表，我可能会这样做：

```
SELECT E.email
FROM (VALUES('email1'),('email2'),('email3'),('email4')) E(email)
LEFT OUTER JOIN UsersTbl tu ON E.email = tu.username
WHERE tu.username IS NULL 
```

或者，

```
SELECT E.email
FROM (VALUES('email1'),('email2'),('email3'),('email4')) E(email)
WHERE NOT EXISTS
(
    SELECT 1
    FROM UsersTbl tu 
    WHERE E.email = tu.username
) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T18:49:10.023

一种完全自动化的方法是将电子表格用作使用 openrowset 的数据库。但是，可能不允许使用 openrowset，并且您的 excel 文件需要位于服务器上或可通过网络路径访问。

[这是我找到的电子表格 http://www.sql-programmers.com/tsql-openrowset-in-sql-server.aspx 的一个很棒的教程](http://www.sql-programmers.com/tsql-openrowset-in-sql-server.aspx)

```
Declare @UserTbl Table
(
    email nVarchar(255),
    firstname nVarchar(255),
    lastname nVarchar(255)
)

INSERT into @UserTbl VALUES('user1@email.com','User','1')
INSERT into @UserTbl VALUES('user2@email.com','User','2')
INSERT into @UserTbl VALUES('user3@email.com','User','3')

select *
from @UserTbl
where email not in (SELECT Email FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0','Excel 8.0;Database=C:\email.xls;HDR=YES', 'SELECT * FROM [Feuil1$]')
)

-- Sample to read a file from Excel     SELECT * FROM OPENROWSET('Microsoft.Jet.OLEDB.4.0','Excel 8.0;Database=C:\email.xls;HDR=YES', 'SELECT * FROM [Feuil1$]') 
```

# javascript - document.scripts 在 Firefox 中返回未定义

> ID：14485574
> 
> 赞同：2
> 
> 时间：2013-01-23T17:20:35.427
> 
> 标签：javascript, firefox

我试图调试为什么脚本不能在 firefox 中运行但在其他程序中。部分优秀的[chirp.js](http://lab.rog.ie/chirp/)有一行：

```
script = document.scripts[document.scripts.length-1] 
```

引发错误：**document.scripts 未定义**

因此，我在 firebug 控制台中运行 document.scripts，它返回 undefined，正如您所期望的那样，所以我前往 Mozilla 并查看它是否被称为其他名称，并且它在[那里](https://developer.mozilla.org/en-US/docs/DOM/Document.scripts)被列为可访问。我在 Chrome 控制台中输入了同样的内容，我得到了一个加载的脚本列表。

这发生在我的机器和客户的机器上，所以我猜这不是插件/插件问题？

我在 chirp 项目页面上遇到了同样的错误。

有人遇到过这个问题吗？我尝试使用谷歌搜索，但得到与 document.scripts 对象相关的结果页面，没有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:35:41.243

别的东西不在这里。即使编写以下内容也会为您提供 1 的长度：

```
<!DOCTYPE html>
<html>
<head>
</head>
<body>
<script>alert(document.scripts.length);</script>
</body>
</html> 
```

在您的 Firefox 安装中尝试一下。如果这行得通，那么还有其他问题。

注意：截至 2013 年 1 月 23 日，我在 Firefox for Mac 的最新版本中对其进行了测试。

# vbscript - vbscript 在单独的进程中打开 Excel 2010

> ID：14485583
> 
> 赞同：2
> 
> 时间：2013-01-23T17:21:11.090
> 
> 标签：vbscript, registry, excel-2010, windows-7-x64

我一直在试图弄清楚如何为 RegWrite 正确格式化这些字符串，但一直无法弄清楚。完成后，脚本会修改注册表中的一些区域，以便在不同的窗口中打开多个 Excel 2010 工作簿。

环境：
Windows 7 Professional x64
Excel 2010

```
Option Explicit
' =======================================================
' Purpose: This will let you open each Excel Spreadsheet in a seperate window.
' =======================================================

Const HKCR = &H80000000

dim objShell, objReg, strComputer

strComputer = "."

set objShell = WScript.CreateObject("WScript.Shell")
Set objReg = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & strComputer & "\root\default:StdRegProv")

' objShell.RegDelete "HKCR\Excel.Sheet.12\shell\Open\ddeexec\"
objReg.DeleteKey HKCR, "Excel.Sheet.12\shell\Open\ddeexec"

objShell.RegWrite "HKCR\Excel.Sheet.12\shell\Open\command\", "C:\Program Files (x86)\Microsoft Office\Office14\EXCEL.EXE" "%1", "REG_SZ"
objShell.RegWrite "HKCR\Excel.Sheet.12\shell\Open\command\command", "xb'BV5!!!!!!!!!MKKSkEXCELFiles>VijqBof(Y8'w!FId1gLQ "%1"", "REG_MULTI_SZ"

set objShell = Nothing 
```

问题 1) 出于某种原因，我无法删除 ddeexec 注册表项。它确实有子键，并且通过一些阅读发现你不能删除也有子键的键，`objShell.RegDelete`所以我试图使用`objReg.DeleteKey`但都没有成功。在不涉及单独删除每个子项的解决方法中，我找不到任何东西。

问题 2) 我尝试写入 HKCR\Excel.Sheet.12\shell\open\command 的文本包含很多引号和空格，我无法正确转义。注册表中的值应该是`"C:\Program Files (x86)\Microsoft Office\Office14\EXCEL.EXE" "%1"`

问题 3）我试图在命令键中输入的疯狂字符串包含一个“（”，这会导致错误“）预期”，我已经尝试过尝试使其格式正确，就像在问题 2 中一样. 注册表中的值应该是`xb'BV5!!!!!!!!!MKKSkEXCELFiles>VijqBof(Y8'w!FId1gLQ "%1"`

我尝试过使用不同的东西，比如`& chr(34) &`也使用`""""`过，但还没有想出正确的组合。

谢谢！

编辑：最终解决方案。

```
Option Explicit
' ============================================
' Purpose: This will let you open each Excel Spreadsheet in a seperate window.
' =======================================================

Const HKEY_CLASSES_ROOT = &H80000000

Dim strComputer, objReg, strKeyPath

' Create WMI registry object
strComputer = "."
Set objReg = GetObject("winmgmts:{impersonationLevel=impersonate}!\\" & strComputer & "\root\default:StdRegProv")

' Delete DDE stuff
strKeyPath = "Excel.Sheet.12\shell\Open\ddeexec"
DeleteSubKeys HKEY_CLASSES_ROOT, strKeyPath

' Modify launch commands
strKeyPath = "Excel.Sheet.12\shell\Open\command\"
objReg.SetStringValue HKEY_CLASSES_ROOT, strKeyPath, "", """C:\Program Files (x86)\Microsoft Office\Office14\EXCEL.EXE"" ""%1"""
objReg.SetMultiStringValue HKEY_CLASSES_ROOT, strKeyPath, "command", Array("xb'BV5!!!!!!!!!MKKSkEXCELFiles>VijqBof(Y8'w!FId1gLQ", """%1""")

' =====================================================================
'        Sub: DeleteSubKeys
'       HKEY: The specific root Hive you're editing.
' strKeyPath: Path to specific Key under HKEY.
'    Purpose: Iterate through all subkeys under strKeyPath and delete them.
' http://technet.microsoft.com/en-us/magazine/2006.08.scriptingguy.aspx
' =====================================================================

Sub DeleteSubKeys(HKEY, strKeyPath)

    Dim arrSubkeys, strSubkey

    objReg.EnumKey HKEY, strKeyPath, arrSubkeys

    If IsArray(arrSubkeys) Then
        For Each strSubKey In arrSubkeys
            DeleteSubKeys HKEY, strKeyPath & "\" & strSubkey
        Next
    End If

    objReg.DeleteKey HKEY, strKeyPath
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:58:27.673

**问题一：**

您**必须**自下而上删除每个子项。为此使用递归：

```
Sub DelKey(hive, key)
  rc = reg.EnumKey(hive, key, subkeys)
  If rc = 0 Then                         ' only proceed if there were no errors
    If Not IsNull(subkeys) Then
      For Each subkey In subkeys
        DelKey hive, key & "\" & subkey  ' <- recurse (descend before delete)
      Next
    End If
    reg.DeleteKey hive, key              ' at this point the key doesn't have
                                         ' subkeys anymore
  End If
End Sub 
```

**问题 2：**

字符串中的双引号必须通过加倍来转义：

```
objShell.RegWrite "HKCR\Excel.Sheet.12\shell\Open\command\" _
  , """C:\Program Files (x86)\Microsoft Office\Office14\EXCEL.EXE"" ""%1""" _
  , "REG_SZ" 
```

**问题 3：**

如[文档](http://msdn.microsoft.com/en-us/library/yfdfhz1b%28v=vs.84%29.aspx) `RegWrite`所述，不支持该类型`REG_MULTI_SZ`。您需要为此使用[`SetMultiStringValue`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa393465%28v=vs.85%29.aspx)。您也需要在这里转义内部双引号。

# c - 这个 reverseString 算法是如何工作的？

> ID：14485585
> 
> 赞同：0
> 
> 时间：2013-01-23T17:21:13.043
> 
> 标签：c, string, reverse

我已经看到这个算法在线反转字符串，我对此有一些疑问，我将在代码末尾指定：

```
 void reverseString(char *original_string)
    {
        char *end = original_string;
        char tmp;

        if(original_string) {
            while(*end) {
                ++end;
            }
            --end;
            while (original_string < end) {
                tmp = *original_string;
                *original_string++ = *end;
                *end-- = tmp;
            }
        }
//This line doesn't have the complete reversed string. Why?
printf("%s\n", original_string);
    } 
```

1）在while循环中...为什么要比较两个指针？我们怎么知道这个值会变大还是变小？这些只是指针，对吧？

2) 我们为什么不退货？反转的字符串在哪里？如果我们暗示反转的字符串在 original_string 中，我们不应该使用指向指针的指针以使效果在外部范围内吗？

3）如果我执行以下操作：

```
char test[] = "hello";
    reverseString(test);
    printf("%s\n", test); 
```

我可以看到“olleh”。但是，如果我`printf("%s\n", original_string);`在函数 reverseString 的最后一行执行，我只会得到“leh”。这是为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T17:25:42.247

您有两个指针指向要反转的部分的开头和结尾。在每一步中，您交换这些指针指向的字符，然后减少要从两个方向（开始和结束）反转的字符串。比较指针有以下含义——直到区间的开始不是在区间的结束之后，我们还有一个要反转的区间。希望这是有道理的。

您不需要返回任何内容 - 字符串被反转到位，因此参数同时输入和输出。

3）在函数中，您获取指向字符串的指针的副本，您在其执行期间对其进行了修改，因此当指针被最后一行修改时，它将不再指向字符串的开头，而是指向中间，它留在最后的地方。

# regex - 如何从句子中获取网址？

> ID：14485588
> 
> 赞同：0
> 
> 时间：2013-01-23T17:21:15.690
> 
> 标签：regex, preg-replace

如何进行替换，将段落中的所有普通地址转换为链接？

问题是句号在地址中有效，但地址可能在句末。

测试字符串：

```
The link is: http://www.google.com/pants.  And that is the link. 
```

我需要从 http 分组到裤子。（这是纯文本，我需要将其设为 html。）

这个正则表达式抓住了裤子之后的时期，所以很糟糕：

```
(^|[\n ])([\w]+?://[^\s]*) 
```

我很确定我需要做一个前瞻，但我不能把它放在 ^\s 字符集中。尝试做一个 ifthenelse 也让我望而却步。

这是我的输出内容：

```
$1<a href=\"$2\" target=\"_blank\">$2</a> 
```

* * *

嘿，读这个的人。确保你知道这个网站： http: [//gskinner.com/RegExr/](http://gskinner.com/RegExr/)它规则。这是我正确使用任何正则表达式的唯一原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:31:15.587

假设 url 中没有空格，后面有空格或字符串结尾：

```
str = str.replace(
    /(https?:\/\/\S+?)(?=\.?(\s|$))/g,
        '<a href="$1" target="_blank">$1</a>' ); 
```

它尽可能少地捕获 'http[s]://' 和非空格字符，直到向前看有可选`.`的，然后是空格或字符串结尾。

如果您想排除可能位于网址末尾的其他标点符号，您可以相应地更改正向预测，例如`(?=[;:!,.]?(?:\s|$))`.

请注意，上面的正则表达式并非仅匹配*有效*的 url，您可能希望将 替换`\S`为`[\w/.-]`仅匹配包含单词字符的 url 和`.-/`.

[寻找完美的 URL 验证正则表达式](http://mathiasbynens.be/demo/url-regex)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:45:49.147

这些 urls 正则表达式模式的一些模式：

```
^http\://[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(/\S*)?$

^[a-zA-Z0-9\-\.]+\.(com|org|net|mil|edu|COM|ORG|NET|MIL|EDU)$ 
```

你可以像这样使用它们

```
str = str.replace(PATTERN/g,
        '<a href="$1" target="_blank">$1</a>' ); 
```

你会在[http://regexlib.com/找到很多](http://regexlib.com/Search.aspx?k=URL&AspxAutoDetectCookieSupport=1)

# unicode - UTF-8：语言使用多少字节来表示可见字符？

> ID：14485589
> 
> 赞同：12
> 
> 时间：2013-01-23T17:21:17.527
> 
> 标签：unicode, utf-8, character, byte, glyph

是否存在一个表格或类似的东西来显示当编码为 utf8 时不同语言平均需要多少字节来表示一个可见字符（字形）？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-23T19:15:51.130

如果你想要一些通用的东西，我认为你应该坚持这个：

*   英语每个字符占用*略*多于 1 个字节（偶尔会出现非 ASCII 字符，通常是标点符号或嵌入文本中的符号）。
*   大多数其他使用拉丁字母的语言都使用多于 1，但如果您期望超过 1.5，我会感到惊讶。
*   使用其他一些脚本（希腊语等）的语言每个字符大约需要 2 个字节。
*   东亚语言每个字符占用大约 3 个字节（间距、控制字符和嵌入的 ASCII 使其占用更少，非 BMP 占用更多）。

这都是非常不完整、近似和非定量的。

如果您需要更定量的东西，我认为您必须单独研究每种语言。我怀疑你会发现已经适用于许多不同语言的预计算结果。

如果您有一种语言的文本语料库，则很容易计算所需的平均字节数。从[文本语料库](http://en.wikipedia.org/wiki/Text_corpus)维基百科页面开始。它链接到至少一个很好的免费可用的英语语料库，并且可能还有一些可用于其他语言的语料库（我没有通过链接查找）。

顺便说一句，我不建议您使用此信息来截断您打算执行的（在评论中）的数据库字段的长度。首先，如果您使用由文献组成的语料库来得出您预期的每个字符的字节数，您可能会发现语料库根本不能代表最终在您的数据库中的短小文本字符串，甩掉你的期望。只需获取整个数据库列。大多数结果将比最大长度短得多，如果不是，我认为您的优化不值得节省一百字节左右。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-24T06:37:21.887

查看 Unicode 块列表及其代码点范围，例如可浏览的[http://www.fileformat.info/info/unicode/block/index.htm](http://www.fileformat.info/info/unicode/block/index.htm)或官方的[http://www.unicode.org/Public/ UNIDATA/Blocks.txt](http://www.unicode.org/Public/UNIDATA/Blocks.txt)：

*   U+007F 之前的任何内容都占用 1 个字节：基本拉丁语
*   然后到 U+07FF 它需要 2 个字节：希腊语、阿拉伯语、西里尔语、希伯来语等
*   然后到 U+FFFF 需要 3 个字节：中文、日文、韩文、梵文等
*   除此之外，它需要 4 个字节

# javascript - 在 google Maps API V3 中，如何在不使用限制平移解决方案的情况下防止标记在 x 轴上重复？

> ID：14485590
> 
> 赞同：1
> 
> 时间：2013-01-23T17:21:18.053
> 
> 标签：javascript, google-maps, google-maps-markers

我一直在寻找这个问题的答案，我知道有一种方法，因为传单在他们的框架中做到了。问题是我已经在使用 Google APi 并且无法将所有内容都转回传单，而且我不想使用传单而且我无法限制边界，因为这会给我的地图应用程序带来一些非常奇怪和笨拙的解决方案。有谁知道如何禁用谷歌地图 api v3 的 x 轴上的世界环绕？同样，请不要说限制平移和边界并加强缩放。我已经尝试过了，这不是我想要的，而且它确实效果不佳。如果leaflet 可以用一个worldwrap: false 来做到这一点，那么如何在谷歌自己的框架中实现同样的事情呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T06:41:22.780

The only way I've managed to do this is very crude.

First set the marker(s) to draggabble. Which stops the marker repeating longitudinally.

Then add a drag start and drag end handler.

on drag start, save the markers position.

on drag end, set the markers position back to its original position.

crude but seems to work.

# java - 了解Java中的DI

> ID：14485594
> 
> 赞同：1
> 
> 时间：2013-01-23T17:21:35.533
> 
> 标签：java, spring, dependency-injection, coding-style

> **可能重复：**
> [了解对 DI 框架的需求](https://stackoverflow.com/questions/500637/understanding-the-need-for-a-di-framework)

我已经阅读了几篇文章，并就 DI 与几位专业人士进行了交谈。我不明白的是如何通过 DI 解耦对象。以下文章还描述了一个场景，但我不明白 Spring 如何帮助解耦 PayrollApplication？解耦是通过多态性而不是 DI 完成的。DI 定义服务于其他目的......

[http://www.developer.com/java/dependency-injection-in-existing-java-code.html](http://www.developer.com/java/dependency-injection-in-existing-java-code.html)

提示和参考就可以了。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:28:06.067

依赖注入解耦了对象，因为你没有直接实例化具体的类，Spring 正在为你做这件事。使用 DI 的替代方法是您通常会创建对接口的引用，但您仍然必须直接实例化对象。您的代码中仍然引用了 concreate 类。

编辑：忘了提到您可以使用工厂模式将实现从您的代码中取出，但是您只是将其移入工厂。Spring 就像一个巨大的、所有 bean 的通用工厂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:57:37.973

脱钩不是一个全有或全无的概念。在本文中，仅使用多态（“设计 2”）在一定程度上解耦了对象，但 PayrollApplication 类在编译 PayrollApplication 时仍然需要了解 Employee 的实现。

Employee 实现是 PayrollApplication 的依赖项，通过依赖注入，您可以实现更高级别的解耦：您可以编译 PayrollApplication 使其仅引用 Employee 接口，并仅提供 Employee 实现（可能由另一个团队/组织编写）之后。

另请查看有关依赖注入的[维基百科：](http://en.wikipedia.org/wiki/Dependency_injection)

> 依赖注入模式的主要目的是允许在运行时或通过配置文件而不是在编译时选择给定依赖接口的多个实现。该模式对于在测试时提供复杂组件的存根测试实现特别有用，但通常用于定位插件组件，或定位和初始化软件服务。

# c# - 服务器端代码针对

> ID：14485616
> 
> 赞同：-1
> 
> 时间：2013-01-23T17:23:00.443
> 
> 标签：c#, html

有人可以告诉我如何从服务器端访问控制并将其属性设置为启用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:25:17.477

如果您使用的是网络表单，则需要`<input type="number" id="numb" runat="server">`专门添加`runat="server"`

并在服务器端执行此操作

```
numb.Enabled=false; 
```

# c - 如何在 ANSI C 中分配一块内存，然后在它们的所有位上分配

> ID：14485619
> 
> 赞同：-2
> 
> 时间：2013-01-23T17:23:21.423
> 
> 标签：c

我只想为**int 类型**分配一块内存并将所有位设置为 ON(1) 之后我如何才能读回该内存块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T19:46:06.267

```
int *type = malloc(sizeof(int);
memset(type,~0,sizeof(int)); 
```

回读不过是，

```
int value = *type; 
```

并将`value`所有位设置为**1**。

# javascript - 用户菜单在悬停时淡入淡出

> ID：14485621
> 
> 赞同：0
> 
> 时间：2013-01-23T17:23:29.147
> 
> 标签：javascript, css, hover, mouseover, mouseout

我有需要在鼠标悬停和鼠标移出图标时淡入和淡出的用户菜单。我的问题是用户还应该能够将鼠标悬停在菜单上（或在这种情况下为 img），并且菜单不会淡出，以便他们可以单击其中的链接或图像。这是我的代码和一个jsfiddle。[http://jsfiddle.net/anschwem/7mrM2/](http://jsfiddle.net/anschwem/7mrM2/)

```
<style>
div.notif
{
    display:none;
    position:absolute;
    border:solid 1px black;
    padding:8px;
    background-color:white;
}
a.notif:hover + div.notif
{
    display:block;

}
div.notif:hover
{
    display:block;

}
</style>
<script type='text/javascript'>//NOT WORKING
$(window).load(function(){
$(document).ready(function()
{    
    $(".notif").hover(
      function () {
        $('.notif').fadeIn('slow');
      }, 
      function () {
        $('.notif').fadeOut('slow');
      }
    );
});
});//]]>  
</script>//NOT WORKING
</head>
<body>
<a class="notif" href="notifications.html" style="text-decoration:none;"><img src="images/bubble.png" style="position:relative; top:20px;"/></a>
    <div class="notif" style="z-index:999999; ">
<a href="notifications.html"><img src="images/notif.png"/></a>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:57:15.037

这将对您有所帮助。参见[**JSFiddle 演示**](http://jsfiddle.net/7mrM2/13/)

**HTML**

```
<div class='parent'>
   <a class="notif" href="notifications.html" style="text-decoration:none;"><img src="http://upload.wikimedia.org/wikipedia/commons/a/ac/Approve_icon.svg" height="30" width="30"/></a>

   <div class="notif" style="z-index:999999; ">
      <a href="notifications.html"><img src="http://doinghistoryproject.tripod.com/sitebuildercontent/sitebuilderpictures/failure-message.gif" height="80" width="80"/></a>
   </div>
</div> 
```

**JS**

```
$(document).ready(function () {
    $(".parent").hover(
    function () {
       $(this).find('div.notif').stop().fadeIn('slow');
    },
    function () {
       $(this).find('div.notif').stop().fadeOut('slow');
    });
}); 
```

# c# - Linq在同一查询中返回2个单独列的总和

> ID：14485622
> 
> 赞同：1
> 
> 时间：2013-01-23T17:23:33.747
> 
> 标签：c#, linq

下面的代码为每个 InvNo 带来一行，以及“SCharge”的总和：0

```
var Values = from data in DtSet.Tables["tblCosts"].AsEnumerable()
            group data by new
            {
                InvNo = data.Field<double>("InvoiceNo"),
                AccRef = data.Field<double>("SiteRefNum"),
            }
            into g
            select new
            {
                Code = "1",
                InvType = "I",
                Account = g.Key.AccRef,
                InvNo = g.Key.InvNo,
                SCharge = g.Sum(d => d.Field<double>("SCharge"))
            }; 
```

有没有办法修改它，以便我在下面得到另一组行，这次对“TCharge”列进行求和，还是我需要做一个新的查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:25:18.160

因此，由于您想显示所有行两次，但第二次投影略有不同，我们可以首先保存分组查询，然后对这些组执行两次投影并将它们组合在一起。

```
var groupings = DtSet.Tables["tblCosts"].AsEnumerable()
                .GroupBy(data => new
                {
                    InvNo = data.Field<double>("InvoiceNo"),
                    AccRef = data.Field<double>("SiteRefNum"),
                }).ToList();

var Values = groupings.Select(g => new
{
    Code = "1",
    InvType = "I",
    Account = g.Key.AccRef,
    InvNo = g.Key.InvNo,
    Charge = g.Sum(d => d.Field<double>("SCharge"))
})
.Concat(groupings.Select(g => new
{
    Code = "1",
    InvType = "I",
    Account = g.Key.AccRef,
    InvNo = g.Key.InvNo,
    Charge = g.Sum(d => d.Field<double>("SCharge"))
})); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:27:35.803

```
select new
     {
       Code = "1",
        InvType = "I",
        Account = g.Key.AccRef,
        InvNo = g.Key.InvNo,
        SCharge = g.Sum(d => d.Field<double>("SCharge")),
        TCharge = g.Sum(d => d.Field<double>("TCharge"))
     }; 
```

# magento - Magento 中显示类别的问题

> ID：14485623
> 
> 赞同：0
> 
> 时间：2013-01-23T17:23:34.907
> 
> 标签：magento, categories

我已经在 magento 中设置了许多类别，除了两个之外，所有类别都显示在类别列表中。它们被设置为活动并显示在导航中。

当我尝试重命名这些类别中的每一个时，它们都显示得很好，但这并不合适。我试过清除所有索引和缓存，但没有运气。

如果有帮助，这些类别将被命名为“优惠”和“畅销书”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T22:36:55.003

有几件事会导致类别不显示：

*   如果类别未设置为活动，则不会显示
*   如果该类别中没有任何产品，则不会显示
*   如果没有为该商店视图启用类别（确保已为您想要的站点启用它）

# eclipse - 应用拉取后如何在不使用拉取请求的情况下继续开发

> ID：14485630
> 
> 赞同：2
> 
> 时间：2013-01-23T17:24:02.440
> 
> 标签：eclipse, git, github, egit

我很难清楚地表达这一点，但我会试一试。

## 情况：

*   我[分叉](https://github.com/ryantheleach/MChat)了一个[存储库](https://github.com/MiracleM4n/MChat)作为我的主人，然后在本地克隆它。
*   进行了更改，并发送了[拉取请求](https://github.com/MiracleM4n/MChat/commit/6967d4c78e7bd164739c1c3f5b2afd534a3fe372)。
*   拉取请求已关闭，并已[“手动添加”](https://github.com/MiracleM4n/MChat/commit/6967d4c78e7bd164739c1c3f5b2afd534a3fe372) （补丁和应用）。

## 问题：

*   如何让我的本地（和[远程）存储库与](https://github.com/ryantheleach/MChat)[上游项目](https://github.com/MiracleM4n/MChat)重新同步？

* * *

*   我不在乎保持细微的差异。
*   我希望我的代码将来可以轻松提取。
*   我不想失去历史（我的或上游）。
*   该解决方案会导致我未来的开发出现问题吗？

## 备择方案：

*   有没有更简单的方法？
*   我应该重命名这个分支（以某种方式）并重新开始吗？
*   *   （不知何故）在本地同步重命名并从新的主人那里工作？
*   *   我现在应该忘记使用名为 master 的分支，因为这会给我带来问题吗？

## Github 有问题：

*   [原上游“拉”](https://github.com/MiracleM4n/MChat/commit/6967d4c78e7bd164739c1c3f5b2afd534a3fe372)
*   [我的仓库](https://github.com/ryantheleach/MChat)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:38:12.800

好吧，如果您不想丢失历史记录，最简单的事情就是始终创建一个功能分支，您可以在其中处理您的拉取请求。

在您的情况下（如果您想保留历史记录），请创建一个新分支

```
git checkout master
git checkout -b my-old-feature 
```

然后，只需将您的主分支重置为上游主分支的任何点

```
git remote add upstream <upstream-repo-uri>
git fetch upstream
git checkout master
git reset --hard upstream/master 
```

然后你有一个干净的状态，你的主分支将是上游分支。将来，只需始终保持 master 分支跟随上游/master 分支，并在您创建的功能分支上工作以防止与上游更新发生冲突。

**编辑：**
顺便说一句，我总是喜欢让我的分支与上游命名相同。但是您也可以在另一个分支名称上跟踪上游/主控。例如：

```
git pull upstream master:upstream-master 
```

希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T22:02:35.670

你的意思是你的分支上有额外的提交，这些提交不在拉取请求中，你想将它们转移到新的主节点上？

使用`git-rebase`, 需要注意的是，如果你知道它在做什么，你真的应该只变基：

```
git rebase --onto upstream/master A B 
```

在这里，`A`应该是您拉取请求中的最后一次提交，并且`B`应该是您本地分支的名称（可能是`master`）。

This will iterate over all the commits that come *after* your pull request and "replay" them, one at a time, on top of upstream's new master. By "replay" I mean git is literally generating a patch from each commit, applying it to the code, and making a new commit with the same date/author/message as the original. You'll have the same changes arranged the same way, but the commit hashes will be different. (So **don't do this** if anyone else has branched off of your branch!)

Another way to do the same thing is to create a new branch based on upstream, then `git cherry-pick` the commits you want to keep. This does exactly the same thing, replaying the commits, except you bring arbitrary other commits into the current branch rather than moving the current branch somewhere else.

# c# - .Net C# 将表单发布到外部 URL

> ID：14485632
> 
> 赞同：0
> 
> 时间：2013-01-23T17:24:16.900
> 
> 标签：c#, webforms

我是 .NET 的新手——我是一名经典的 ASP 开发人员已经有一段时间了。我正在尝试向 saleforce 发布 HTML 表单，但遇到了一些问题。我正在使用带有母版页的 .NET webforms 4.0。

如果我在经典 ASP 中执行此操作，我只需将表单操作更改为 Salesforce URL。但是对于网络表单，我猜该表单正在提交回页面。

我想我应该回发并收集表单中的数据，然后将其发送给销售人员，但我不知道该怎么做......感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:28:26.410

答案很简单：不要使用网络表单 ( `runat="server"`)，而是创建一个常规的旧表单。然后将`action`属性设置为 post to salesforce，就大功告成了。

与没有 web 表单（viewstate、viewbag 等）的经典 ASP 方法相比，这就是您的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-02T08:27:36.430

您可以在回发事件中使用 Webclient 和 UploadValues 来发布到外部 Url。这也将使您留在您的网站上，但是如果您想最终访问外部网站，则此解决方案将不起作用。

```
System.Net.WebClient myWebClient = new System.Net.WebClient();
myWebClient.UploadValues(ExternUrl, PostData); 
```

# mysql - 如何随机化单个 mysql 列？

> ID：14485636
> 
> 赞同：0
> 
> 时间：2013-01-23T17:24:31.343
> 
> 标签：mysql, random

我有一个由字符串和数字概率组成的数据库（还有其他列，但它们与问题无关）。一个简化的模式是

```
+-----------------------+----------------------+
| gopair                | P_high               |
+-----------------------+----------------------+
| GO:0000398_GO:0030540 |    0.275997567007171 |
| GO:0015198_GO:0016846 | 5.24489289777325e-06 |
| GO:0034649_GO:0072141 |  0.00338367340340417 |
| GO:0004303_GO:0031053 |    0.110417921058026 |
+-----------------------+----------------------+ 
```

在我的工作中，我运行一个脚本来查询数据库中与特定 GO 对关联的值。我需要证明我的结果与随机获得的结果不同。因此，我要运行的测试之一是对`P_high`列进行洗牌，然后运行我的脚本并分析结果。

我试图洗牌输入文件并重新加载数据库，但这很复杂，因为有问题的输入文件是一个 7GB 的文本文件，在只有 3GB RAM 的机器上很难处理。

那么，有没有一种方法可以随机化数据库中的特定列，同时保持其余部分保持不变？

注意事项：

*   有问题的表很大（60,164,966 行）。
*   我不需要严格的数学随机性
*   我需要保持相同的频率。如果*N*对在真实数据库中具有*P的概率，我需要**N*对在随机一对中具有*P的概率。*
*   我需要持久的解决方案。我的脚本可以多次查询数据库中的同一对，因此仅选择随机对是不够的。
*   我需要重复执行所有这些操作，因此首选可编写脚本（最好是 Perl）的解决方案。
*   我在 Ubuntu 服务器上使用 readline 6.1 为 debian-linux-gnu (x86_64) 运行 mysql Ver 14.14 Distrib 5.1.41。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:34:05.550

该表的主键是什么样的？如果您使用整数代理键，您可以：[假设 4 字节整数]

1.  转储所有键的列表。`$list[]`[240MB 让步]
2.  复制列表。`$shuf[]`[另一个 240MB +/-]
3.  随机播放重复列表。[shuffle 函数可能会返回一个副本，在这种情况下跳过 #2]
4.  在您的表中添加另一列 [ie: `shuffle_key`]，暂时没有索引。
5.  我对 Perl 语法不是很熟悉，但它类似于 PHP，所以：

    ```
    $cnt = count($list);
    for($i=0; $i<$cnt; $i++) {
        $query = sprintf(
            'UPDATE table SET shuffle_key = %d WHERE primary_key = %d',
            $shuf[$i], $list[$i] );
        $dbh->doQuery($query);
    } 
    ```

6.  在新列上创建唯一索引。

7.  现在您可以在主键和洗牌键上自连接表，并从一侧使用 gopair 并从另一侧使用 P_high。

    ```
    SELECT t1.gopair, t2.P_high
    FROM table t1 INNER JOIN table t2
      ON t1.primary_key = t2.shuffle_key 
    ```

这应该需要的内存量大约是主键大小 * 行数的 2 倍，但即使在较大的一侧，我认为它占用的内存也不会超过几个 GB。

注意：每次你想洗牌你需要把索引放在 shuffle_index 列上，这样你就不会在操作中间收到重复的键警告。之后重新添加索引。

# html - 响应式设计 - 所有测量单位都是相对的？使用什么测量单位？

> ID：14485638
> 
> 赞同：2
> 
> 时间：2013-01-23T17:24:39.597
> 
> 标签：html, css, responsive-design

我有一个使用基线网格进行布局的响应式网页。用于字体大小调整的单位是带有 px 后备的 rem。
何时定义边距、填充、宽度和高度，我应该使用什么单位？当然，使用 px 确实很诱人，但这是一种不好的做法吗？当用户放大时怎么办？

我还读到百分比值是响应式设计的方法，但 IMO 在切换到另一个测量单位时很难使用 rem 网格。

另外，我看了一些专业人士制作的知名响应式网站的 HTML/CSS，甚至他们使用了一些 px 值，这真的让我很恼火。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:27:42.900

IMO，响应式设计更需要弯曲。[您可以在https://developer.mozilla.org/en-US/docs/CSS/flex](https://developer.mozilla.org/en-US/docs/CSS/flex)学到很多东西（请避免将 W3Schools 作为学习基地）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:29:39.023

虽然如果 ch 单位是标准化的会很好，但您可以仅使用 em 完成一些相当不错的工作。

# winapi - Win32 API 失败

> ID：14485640
> 
> 赞同：3
> 
> 时间：2013-01-23T17:24:54.400
> 
> 标签：winapi

是否有必要检查所有`Win32 APIs`返回值？例如，像`AdjustWindowRect`,`SetWindowLong`等函数`GetWindowLong`真的会失败（有内部错误），或者返回值主要是一种不输入错误参数的故障安全机制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:33:03.027

与 POSIX 不同，Win32 API 似乎没有为每个调用提供一个很好的错误条件列表。尽管某些函数在实践中不会失败（除了参数错误的情况），但它们在理论上*可能*会失败。就像您不应该相信用户输入一样，您也不应该盲目相信文档记录不佳的库。

我认为处理 API 的最佳方法是将所有调用包装在函数中以进行错误检查（在 API 之间和内部存在很大差异），这样您就有了一种“更高级别”的 API，其中所有特性都被熨平出去。然后，您可以将成功、错误和警告转换为适合您的语言的任何技术（例如异常、错误/警告回调、总和类型）。

# ios - 这些 NSArray 初始化方法有何不同？

> ID：14485646
> 
> 赞同：0
> 
> 时间：2013-01-23T15:18:39.563
> 
> 标签：ios, objective-c, cocoa

> **可能重复：**
> [NSArray 初始化方法](https://stackoverflow.com/questions/14483531/nsarray-initialization-methods)

初始化数组有什么区别

```
NSArray * array = [NSArray array]; 
```

和

```
NSArray * array = @[]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:31:43.493

这两个表达式通常是等价的。

[Clang 的文档](http://clang.llvm.org/docs/ObjectiveCLiterals.html#caveats)列出了对象文字的警告：

> 使用字面量或盒装表达式语法创建的对象不保证在运行时是唯一的，但也不保证它们是新分配的。因此，**直接比较对象字面量的位置（使用 ==、!=、<、<=、> 或 >=）的结果是不明确的**。这通常是旨在调用`isEqual:`方法（或`compare:`方法）的代码中的一个简单错误。

正如文档所述，上面列出的警告仅在对象之间使用直接比较运算符时才会出现，这几乎总是不是预期的操作。这种行为应该无关紧要，因此两者几乎总是可以互换使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:37:14.283

这`@[]`是**现代Objective C**`[NSArray array]`中的快捷方式

 **请检查[**The_Basics_of_Modern_Objective-C**](http://www.techotopia.com/index.php/The_Basics_of_Modern_Objective-C)以获得更好的理解。

据我所知，当您使用 @[] 时，这将等同于相应的 Class 方法。方法：

```
@[]          = [NSArray array];
@[@"M",@"P"] = [NSArray arrayWithObjects:@"M",@"P",nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:31:09.320

这两者是相似的。

`[NSArray array]`并`@[]`创建并返回一个空数组。

`@[]`是 Objective-C 中添加的一个新特性。它将几种对象装箱，并为您提供快捷表示法的灵活性。

> 使用 Apple LLVM 编译器 4.0 或更高版本时，可以使用文字语法而不是方法来创建数组、字典和数字（NSArray、NSDictionary、NSNumber 类）。字面量语法使用 @ 符号与 []、{}、() 组合来分别创建上述类。

更多参考[这里](http://www.reddit.com/r/programming/comments/pso6x/xcode_43_released/c3s2n5r)，[文字](http://clang.llvm.org/docs/ObjectiveCLiterals.html)**

# performance - 按效率排序算法

> ID：14485649
> 
> 赞同：0
> 
> 时间：2013-01-23T17:25:15.673
> 
> 标签：performance, algorithm, sorting, big-o

伙计们，我的作业有最后一个问题。问题问：

```
Reorder the following efficiencies from smallest to largest:
2^n
n!
n^5
10,000
nlog(n) 
```

再次..请不要直接回答这个问题。

我的问题：

1.) 从最小到最大是什么意思？从最低效率到最高效率？

2.) 鉴于 10,000 是恒定的，我认为这是我最有效的，其次是 nlog(n)，然后是 n!，然后是有效的 n^5，最后是 2^n。这是正确的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:34:52.137

对于n!、n^5、2^n的情况，考虑它们在n+1处是如何增加的，也就是比较(n+1)！到 n!，(n+1)^5 到 n^5，以及 2^(n+1) 到 2^n。

至于您的第一个问题，请按照您认为最有意义的方式进行解释，并确保明确说明这是您对它们的排序方式（对大多数人来说效率最低或相反），以便您的教授知道您的意思。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:34:32.693

`f(n) = O(g(n))`意味着对于某些常数和足够大的 ，`|f(n)|`总是小于或等于。这意味着您将函数值与无穷大进行比较。`c * |g(n)|``c``n``n`

例如`100 * n`小于`n²`小`n`，但从`n = 100`上开始`n²`总是大于或等于`100 n`，因此被认为是“更大”。

它不能反过来工作——无论你选择多大的常数`c`，总会有一些`n0`这样的`n > n0` `n² > c * 100 * n`。如果您例如选择`c = 1,000,000` `n²`仍然大于或等于`c * 100 * n`从`n = 100,000,000`上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T19:25:54.643

如果可以，请尝试绘制它们。查看图表的外观并比较它们，使用 x 而不是 n。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:29:47.410

1.  我会反过来 - 从最有效到最不有效排序，但正如约翰尼评论的那样 - 问教授:)
2.  前 2 个是正确的 - 然后你得到的就被打乱了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-23T17:30:08.607

> 从小到大是什么意思？从最低效率到最高效率？

我会说可能从最高效到最不高效，所以 O(1) -> O(n) -> O(n ² ) 顺序。

> 鉴于 10,000 是恒定的，我认为这是我最有效的，其次是 nlog(n)，然后是 n!，然后是有效的 n^5，最后是 2^n。这是正确的吗？

这里只是一个提示。用几个 n 值代替其中的每一个，看看哪个增长最快。确保使用相当广泛的值，例如 10 的前 7 或 8 次方。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-23T18:18:35.190

对于这个作业，只需用大输入代替并进行比较。供您学习.. 有大 O ，欧米茄符号和 Theta Θ。

Big O 是你应该为这个作业得到的，因为这是你的函数永远不会超过的上限，.. 在大值中。

Omega Ω 是下限，这是函数永远不会低于小值的下限。以 1,000,000 为例。

Theta Θ介于两者之间。

但在现实生活中，我总是只面对大 O 符号。

```
let n = 1000    
2^n =~ 1e30  
n!  =~ too BIG!  
n^5 =~ 1e15  
10,000 =~ 10000  
nlog(n) 3000 
```

从某种意义上说，您现在会发现正确的顺序。

# c# - 将不同的结构复制到字节数组

> ID：14485653
> 
> 赞同：2
> 
> 时间：2013-01-23T17:25:20.347
> 
> 标签：c#, vb6

我正在将旧的 Visual BASIC 程序转换为 C#。该程序通过串行或以太网线路向某些工业机械发送消息。为此，它会创建消息的字节数组。

问题在于有**许多**（约 50 种）不同的消息格式，每一种都在 VB6 中定义为用户定义的类型。例如。

```
Public Type K_QCHECK
    Header As K_HEADER3
    Count As LNG4
    crc As INT2
End Type 
```

（LNG4 和 INT2 是自定义类型）通过自动翻译工具运行 VB6 代码，我得到一个 C# 结构：

```
public struct K_QCHECK
{
     public K_HEADER3 Header;
     public LNG4 Count;
     public INT2 crc;
} 
```

但是旧的 VB6 代码将这些复制到带有 LSet 的字节数组中。这取决于类型代表一个连续的内存块的假设。但是在 C# 中，编译器在内存中布局内容的方式应该是程序员无法访问的实现细节。

那么将这些不同结构的内容放入字节数组的最佳方法是什么？我可以将每一个都设为一个类，并给它一个 CopyToByteArray 方法或运算符，但其中有 50 个，所以这似乎需要大量工作。在此先感谢您的任何建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T17:28:22.743

这可能不是正确的解决方案，但是有一个 StructLayoutAttribute 可以让您明确定义结构在内存中的布局方式。

[http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute%28v=vs.110%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:32:52.200

使用这些代码，您可以在任何`structure`和它的`byte[]`数组表示之间进行转换。无需为每个结构实现单独的方法。

```
 public static byte[] StructureToByteArray<T>(T structure) where T:struct
    {
        int len = Marshal.SizeOf(structure);

        byte[] result = new byte[len];

        IntPtr ptr = Marshal.AllocHGlobal(len);

        Marshal.StructureToPtr(structure, ptr, true);

        Marshal.Copy(ptr, result, 0, len);

        Marshal.FreeHGlobal(ptr);

        return result;
    }

    public static T ByteArrayToStructure<T>(byte[] buffer) where T:struct
    {
        //int len = Marshal.SizeOf(typeof(T));
        int length = buffer.Length;

        IntPtr i = Marshal.AllocHGlobal(length);

        Marshal.Copy(buffer, 0, i, length);

        T result = (T)Marshal.PtrToStructure(i, typeof(T));

        Marshal.FreeHGlobal(i);

        return result;
    } 
```

# c++ - 为什么 C 编译器不能以直观的方式进行有符号/无符号比较

> ID：14485655
> 
> 赞同：5
> 
> 时间：2013-01-23T17:25:25.293
> 
> 标签：c++, c, comparison, unsigned, signed

我所说的“直觉”是指给定的

```
int a = -1;
unsigned int b = 3; 
```

表达式`(a < b)`应计算为 1。

Stackoverflow 上有很多问题已经在询问为什么在这种或那种特殊情况下 C 编译器会抱怨有符号/无符号比较。答案归结为整数转换规则等。然而，在比较有符号整数和无符号整数时，为什么编译器必须如此*愚蠢*，似乎没有任何**理由**。使用上面的声明，为什么表达式喜欢

 *```
(a < b) 
```

不会自动替换为

```
(a < 0 || (unsigned int)a < b) 
```

如果没有单一的机器指令可以正确执行？

现在，有一些关于“如果你必须混合有符号和无符号整数，你的程序有问题”的问题的评论。我不会买这个，因为 libc 本身就不可能生活在一个只有签名或无符号的世界中（例如`sprintf()`，函数系列的示例返回`int`为写入的字节数，`send()`返回`ssize_t`等等）。

我也不认为我可以接受下面评论中表达的想法，即有符号整数到无符号的**隐式转换（“成语”）与****显式**强制转换（ ）`(d - '0' < 10U)`相比赋予了 C 程序员一些额外的权力。但可以肯定的是，它打开了广泛的搞砸的机会。**`((unsigned int)(d - '0') < 10U)`**

 **是的，我很高兴编译器警告我它不能这样做（不幸的是，只有当我明确询问时）。问题是——为什么不能呢？通常标准规则背后有充分的理由，所以我想知道这里是否有任何理由？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T17:33:53.863

无法进行自动替换，因为这与 C 语义不同，并且会严重破坏正确使用转换的程序。例如：

```
if (d-'0'<10U)  // false if d is not a digit 
```

对于 ASCII 空间和许多其他字符，您建议的替换将变为 true。

顺便说一句，我相信这个问题部分是重复的：

[如果我们添加安全的有符号/无符号比较 C/C++，它会破坏语言或现有代码吗？](https://stackoverflow.com/questions/3476590/would-it-break-the-language-or-existing-code-if-wed-add-safe-signed-unsigned-co)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:44:11.617

在这种情况下，我确信它会再次退回到 C（和 C++），而不是让您为不需要的功能付费。如果默认行为令人满意，您只需编写显而易见的代码。如果这还不足以满足您的需求，那么您自己编写两部分表达式，然后再付出额外的代价。如果编译器总是按照您的建议执行，您最终可能会付出代码性能损失，即使程序中使用的实际值范围永远不会导致任何问题。

然后，一些编译器会为您提供方便/不正确的警告，让您知道您已进入比较不同符号值的区域。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:04:09.847

通常算术转换的规则适用于几乎所有二元运算符的操作数。它们是一个统一的框架，用于处理（至少在机器级别）需要相同类型的操作中不同大小和符号的整数类型的混合。这些规则旨在使在通用计算机体系结构上的实施尽可能简单和高效。特别是有符号和无符号整数之间的转换通常是二进制补码体系结构上的无操作，并且比较仍然是一条指令 - 有符号或无符号。

对于有符号和无符号类型之间比较的非常特殊的情况，可能会出现您建议的异常。代价将是处理表达式操作数的规则中的不规则性和复杂的实现 - 签名

C 的设计者选择不这样做。更改该决定会破坏大量现有代码以获得有限的利益 - 您仍然会遇到与其他运算符的常见算术转换，因此您必须了解它们。

编译器会警告（或可以警告）可能产生令人惊讶的结果的转换，因此您不会对不同符号或大小的整数的意外混合感到惊讶。使用强制转换来准确表达您希望如何评估它 - 消除警告并帮助您的代码的下一个读者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:32:08.347

如果我没记错的话，这只是一个警告，因此可以忽略。

问题是整数变体的范围。

虽然有符号整数可以保存从 -2147483648 到 2147483648（+- 一或二）的值，但无符号整数的范围可以从 0 到 4294967296。

这意味着，如果将有符号整数与无符号整数进行比较，可能会导致完全错误的结果，因为在内部，符号由整数的 MSB 表示。

一个例子：

您有数字 -1 和数字 3,000,000,000。哪个更大？显然，您可能会说第二个......但对于计算机，-1 实际上更大，因为“无符号”（正确评估大的需要），-1 表示为最大数。（4294967296）。

相反，如果两者都被视为有符号，则大数将是一些相当大的负数，因为它超出了有符号整数的范围。

这就是编译器输出此警告的原因。虽然实际的错误情况相当罕见，但它仍然可能发生。这正是编译器警告你的……当比较两个不同符号的整数时，可能会发生一些意想不到的事情。***

# methods - 启用 CDI 注入到由生产者方法创建的 bean

> ID：14485661
> 
> 赞同：0
> 
> 时间：2013-01-23T17:25:46.703
> 
> 标签：methods, cdi, code-injection, producer, weld

生产者方法对于以编程方式创建实例并在上下文中发布它们非常有用。`new`问题是由生产者方法创建和返回的实例的所有属性都不是由 CDI 注入的。在 Weld 文档中，我读到这是一种有意的行为，但在许多情况下，注入这些 bean 会非常有用。

是否有解决方法可以注入此类 bean？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T17:16:26.823

首先，我要问一下为什么你要为需要注入的 bean 使用生产者。

除此之外，您需要从 BeanManager 创建一个新实例。看看[https://github.com/apache/incubator-deltaspike/blob/master/deltaspike/core/api/src/main/java/org/apache/deltaspike/core/api/provider/BeanProvider.java# L115](https://github.com/apache/incubator-deltaspike/blob/master/deltaspike/core/api/src/main/java/org/apache/deltaspike/core/api/provider/BeanProvider.java#L115)的一些想法（您可以简单地将 BeanManager 作为参数注入 Producer 方法并执行相同的代码）。

# c# - 设置不同数据类型的属性值

> ID：14485666
> 
> 赞同：0
> 
> 时间：2013-01-23T17:26:02.173
> 
> 标签：c#, design-patterns

假设我有一个类，这个类包含一个公共属性，它是一个 System.Drawing.Bitmap，但我希望我的类的使用者能够使用许多不同类型的图像设置这个值，而不必真的想想他们传递了什么，我将在幕后进行必要的转换。这就是我的意思：

```
var myBitmapImage = new BitmapImage();
var writeableBitmap = new WriteableBitmap(myBitmapImage);
var mySystemDrawingBitmap = new Bitmap(@"A:\b.c");

var classOne = new TestClass();
var classTwo = new TestClass();
var classThree = new TestClass();

//This should work:
classOne.MyImage = myBitmapImage;

//This should also work:
classTwo.MyImage = writeableBitmap;

//This should work too
classThree.MyImage = mySystemDrawingBitmap; 
```

目前我正在考虑这样的事情：

```
public class TestClass
{
    private Bitmap _myImage;

    public object MyImage
    {
        get
        {
            return _myImage;
        }

        set
        {
            if (value is Bitmap)
            {
                _myImage = (Bitmap)value;
            }

            if (value is BitmapImage)
            {
                var imageAsSystemDrawingBitmap = ConvertBitmapImageToBitmap((BitmapImage)value);
                _myImage = imageAsSystemDrawingBitmap;
            }

            if (value is WriteableBitmap)
            {
                var imageAsSystemDrawingBitmap = ConvertWriteableBitmapToBitmap((WriteableBitmap)value);
                _myImage = imageAsSystemDrawingBitmap;
            }

            throw new Exception("Invalid image type");
        }
    }

    private Bitmap ConvertWriteableBitmapToBitmap(WriteableBitmap value)
    {
        //do work here
        return null;
    }

    private Bitmap ConvertBitmapImageToBitmap(BitmapImage value)
    {
        //do work here
        return null;
    }
} 
```

但是使用一个对象和铸造感觉很 2001，我相信一定有一个更雄辩的方法来实现这一点。有没有，或者这首先是一个坏主意？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:47:14.467

您可以创建一个`BitmapFactory`充当工厂的类来创建一个`Bitmap`，您可以阅读有关[工厂设计模式](http://en.wikipedia.org/wiki/Factory_method_pattern)的更多信息：

```
public class TestClass
{
    public BitmapFactory BitmapFactory { get; set; }
    public Bitmap Bitmap { get { return this.BitmapFactory.Bitmap; } }
}

public interface IBitmapFactory
{
    Bitmap Bitmap { get; }
}

public class BitmapFactory : IBitmapFactory
{
    public Bitmap Bitmap { get; private set; }

    public BitmapFactory(Bitmap value)
    {
        this.Bitmap = value;
    }

    public BitmapFactory(BitmapImage value)
    {
        this.Bitmap = ConvertBitmapImageToBitmap(value);
    }

    public BitmapFactory(WriteableBitmap value)
    {
        this.Bitmap = ConvertWriteableBitmapToBitmap(value);
    }

    private Bitmap ConvertWriteableBitmapToBitmap(WriteableBitmap value)
    {
        //do work here
        return null;
    }

    private Bitmap ConvertBitmapImageToBitmap(BitmapImage value)
    {
        //do work here
        return null;
    }
} 
```

# javascript - 针对除 10 之外的所有 IE

> ID：14485668
> 
> 赞同：2
> 
> 时间：2013-01-23T17:26:07.903
> 
> 标签：javascript, jquery

好的，写这一行的更好方法是什么

```
 if ($.browser.msie && ($.browser.version == 7 or $.browser.version == 8 or $.browser.version == 9)) {
      $("#wrapper").addClass("oldie");
   } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T17:30:24.763

最佳做法是使用*条件 html 注释*，例如

```
<!--[if (lte IE 10)]><!--> <html class="oldie" lang="en"> <!--<![endif]-->
<!--[if (lt IE 10)]><!--> <html lang="en"> <!--<![endif]-->
</html> 
```

你设置你的`css classes`喜欢

```
.someDiv {
    /* normal definitions */
}    

.oldie .someDiv {
    /* your special definition here */
} 
```

* * *

就像评论中发布的@MarcelKorpel 一样，IE10 将放弃对*条件评*​​论的支持。无论如何要使用它们，您需要包括

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9"> 
```

这条线到你的标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:28:15.407

你可以：

```
if ($.browser.msie && $.browser.version > 6 && $.browser.version != 10)) {
      $("#wrapper").addClass("oldie");
} 
```

或者

```
if ($.browser.msie && $.browser.version > 6 && $.browser.version < 10)) {
      $("#wrapper").addClass("oldie");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:05:30.283

检查您是否可以将行为（应该在 JS 中）与演示文稿（应该在 CSS 中）分开。如果该类仅用于演示，那么最好将版本检查移动到您的 css 文件中。您可以为此目的使用“条件注释”：

```
<!--[if lt IE 7 ]> <html class="ie6"> <![endif]-->
<!--[if IE 7 ]> <html class="ie7"> <![endif]-->
<!--[if IE 8 ]> <html class="ie8"> <![endif]-->
<!--[if IE 9 ]> <html class="ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html> <!--<![endif]--> 
```

有关如何使用它们的更多说明 - 请查看： [http ://webdesignerwall.com/tutorials/css-specific-for-internet-explorer/comment-page-8](http://webdesignerwall.com/tutorials/css-specific-for-internet-explorer/comment-page-8)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:28:52.087

`!=`运营商呢？

```
if ($.browser.msie && $.browser.version != 10) {
    $("#wrapper").addClass("oldie");
} 
```

您还可以使用`<`小于 10 的所有版本，这在这种情况下是最理想的。

```
$.browser.version < 10; 
```

# excel - Excel VBA - 验证数据和逗号分隔的字符串

> ID：14485669
> 
> 赞同：2
> 
> 时间：2013-01-23T17:26:09.120
> 
> 标签：excel, validation, vba

我正在尝试纯粹使用 VBA 创建数据验证单元。问题是，如果验证列表中的一项是包含逗号的 Excel 公式（例如以下代码中的 IF()），则会生成错误。

```
 Dim str As String
 str = "=IF(SUM(A1:A2) = 0, ""Zero"", SUM(A1:A2)) , Item 2 , Item 3 , Item 4"

 s1.Range("B6").Validation.Add Type:=xlValidateList, _
          AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=str 
```

生成错误（运行时错误 1004）是因为它在第一个逗号处分隔字符串，因此验证的第一项是`"=IF(SUM(A1:A2) = 0"`. 我希望逗号有转义字符（例如 C 中的 \）来避免这种情况。我希望经过验证的列表如下所示：

```
<result of IF() function>
Item 2
Item 3
Item 4 
```

注意：我不能对已验证的数据使用范围。如果用户删除了该范围，则电子表格将被破坏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:54:34.807

当单元格 A1 或 A2 更改时，如何使用 WorkSheet_Change 事件重置数据验证？

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim ValidationString As String
Dim rngChanging As Excel.Range
Dim rngWithValidation As Excel.Range

Set rngChanging = Range("A1:A2")
Set rngWithValidation = Range("B6")
If Not Intersect(Target, rngChanging) Is Nothing Then
    With rngWithValidation
        .Validation.Delete
        If WorksheetFunction.Sum(rngChanging) = 0 Then
            ValidationString = "0"
        Else
            ValidationString = WorksheetFunction.Sum(rngChanging)
        End If
        ValidationString = ValidationString & ",Item2,Item3,Item4"
        .Validation.Add Type:=xlValidateList, Formula1:=ValidationString
    End With
End If
End Sub 
```

# authentication - Mozilla 角色身份验证

> ID：14485671
> 
> 赞同：3
> 
> 时间：2013-01-23T17:26:11.210
> 
> 标签：authentication, browserid

如果我想限制访问网站的电子邮件地址，使用 Persona 有什么好处？我必须以相同的方式管理我服务器上的授权电子邮件地址吗？缺少什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-11T22:47:03.930

在您的网站上使用 Persona 的两个主要优点是：

1.  您不必在数据库中存储密码。
2.  您的用户无需为您的网站选择密码。

如果您想将登录限制在特定的电子邮件地址（例如，限制在特定的域），那么 Persona 并不会真正为您改变任何东西。它为您提供了一个经过验证的电子邮件地址，您仍然可以在自己的服务器上进行检查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T10:34:53.647

Persona 为您处理身份验证，但不处理授权。换句话说，Persona 使您能够轻松证明当前用户确实拥有他们传递给您的电子邮件地址，但它并不能决定您是否应该让该电子邮件地址的所有者访问您的站点。

# c# - c# 使用方法访问对象和类

> ID：14485674
> 
> 赞同：-2
> 
> 时间：2013-01-23T17:26:19.333
> 
> 标签：c#, class, object, methods

我在 Format1 类中有 9 个字符串，我想将它们转换为 Format2 类中看到的不同类型，但是 3 个字符串仍将保留为字符串类型。我决定开始和他们一起玩，直到我得到一个我满意的代码。

正如您在我的 Form1.cs 代码中看到的那样，在按钮单击事件时，我真正想做的就是调用 getConvert() 方法并让它处理所有事情。显然我错过了一些东西。我必须用我丑陋的 6 行来调用所有内容。

您可以在代码中的注释中看到我的非工作尝试。这次我做错了什么？？

你也可以在这里获取我的资源： [https ://mega.co.nz/#!64QzERRR!Qit9SDZQ7kW7rNAUUHHDRZUUvZY9z0ukgfuqVt00mE](https://mega.co.nz/#!64QzERRR!Qit9SDZQ7kW7rNCAUUHHDRZUUvZY9z0ukgfuqVt00mE)

```
public class Format1
    {
        public string Name { get; set; }
        public string Year { get; set; }
        public string Director { get; set; }
        public string AverageRating { get; set; }
        public string LeadingActor1 { get; set; }
        public string LeadingActor2 { get; set; }
        public string LeadingActor3 { get; set; }
        public string Language { get; set; }
        public string ImdbLink { get; set; }

    }

public class Format2 : Format1
    {
        public int Year { get; set; }
        public int AverageRating {get; set;}
        public string LeadingActors { get; set; }
        public bool IsInEnglish { get; set; }
        public bool HasImdbLink { get; set; }

        public Format2 getConvert()
        {

            Format2 converted = new Format2();

        //converted.Name = textBox1.Text;
        //textBox18.Text = converted.Name;

            converted.Name = this.Name;
            converted.Director = this.Director;
            converted.ImdbLink = this.ImdbLink;

            return converted;
        }
    }

namespace as3_DVDproject
{
    public partial class Form1 : Form
    {

        public Form1()
        {
            InitializeComponent();
        }

        Format2 converted = new Format2();

        private void label1_Click(object sender, EventArgs e)
        {

        }

        private void label8_Click(object sender, EventArgs e)
        {

        }

        private void label9_Click(object sender, EventArgs e)
        {

        }

        private void okButton_Click(object sender, EventArgs e)
        {
            //converted.getConvert();

            converted.Name = textBox1.Text;
            textBox18.Text = converted.Name;

            converted.Director = textBox3.Text;
            textBox16.Text = converted.Director;

            converted.ImdbLink = textBox9.Text;
            textBox10.Text = converted.ImdbLink;

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:30:24.047

更面向对象的模式是向采用 Format1 的 Format2 添加一个构造函数，或者为 Format2 提供一个采用 Format1 并返回 Format2 的静态方法。实际的映射代码在我看来并不那么冗长，您可以将它放在其中任何一个地方。

```
private void okButton_Click(object sender, EventArgs e)
{
    Format1 one = new Format1(textBox1.Text, converted.Name, textBox3.Text, converted.Director);
    Format2 two = new Format2(one);
} 
```

您希望对象知道如何构建自己而不是在表单中构建它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:39:52.283

至于您重新尝试（我认为问题在于）将 convert.Name 的值分配给 TextBox1 或使用 TextBox18 的反之亦然将失败，因为 TextBox 未在该类中声明，它们是在 Form1 类中声明的Format2 类无法访问。

# amazon-web-services - 亚马逊云上的 Windows 服务总线

> ID：14485676
> 
> 赞同：0
> 
> 时间：2013-01-23T17:26:23.810
> 
> 标签：amazon-web-services, azureservicebus

一个简单的问题：

是否可以在亚马逊云上使用 Windows 服务总线来构建基于 SOA 的解决方案？

[http://msdn.microsoft.com/en-us/library/windowsazure/jj193022%28v=azure.10%29.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/jj193022%28v=azure.10%29.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T18:04:45.977

巴里萨，这是可以做到的。适用于 Windows Server 的 Service Bus 1.0 可以在任何运行 Windows Server 的 VM/Box 上运行，因此您可以在任何地方托管它。

# macos - mod_rewrite 被文件名打败

> ID：14485677
> 
> 赞同：1
> 
> 时间：2013-01-23T17:26:26.163
> 
> 标签：macos, apache, mod-rewrite, webserver, osx-mountain-lion

我在我的 Mac OS X (10.8) 开发计算机上遇到了一个奇怪的问题。我将 mod_rewrite 配置为打开，它似乎在某些情况下确实有效。我现在有一个测试规则，我正在努力工作，但它不会，除非我改变规则做一些我不想要的事情。

这是规则：

```
RewriteRule ^driver/([0-9]+)$ driver.php?d=$1 [L] 
```

现在，如果我尝试调用驱动程序/411。apache 似乎正在做的是调用没有 GET 参数的 driver.php 并完全忽略 .htaccess 规则。我知道这是真的，因为这个带有硬编码值的规则也失败了：

```
RewriteRule ^driver/([0-9]+)$ driver.php?d=411 [L] 
```

但是，如果我将要查找的前缀替换为与文件名前缀不匹配，则它可以工作：

```
RewriteRule ^driverz/([0-9]+)$ driver.php?d=$1 [L] 
```

有谁知道我如何告诉 apache 不要这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T19:49:13.870

这是因为在应用 mod_rewrite get 之前，MultiView 在内部重定向到 driver.php。所以不会有 GET 参数。

通过将以下内容添加到您的 htaccess 来禁用 MultiViews：

```
Options -MultiViews 
```

（PS Apache 应该默认禁用此功能。无论如何，谁使用 MultiViews）

# jquery - 使用 sinon.js 测试 jQuery 延迟对象的“完成”回调函数

> ID：14485678
> 
> 赞同：0
> 
> 时间：2013-01-23T17:26:27.283
> 
> 标签：jquery, backbone.js, callback, sinon, spy

我在我的一个主干视图中有这段 CoffeeScript 代码：

```
myMethod: ->
     # some code here

     $.when(
          # ...
     ).done(
          @myCallback
     ) 
```

我想测试 myCallback 在 done 块中是否被调用。

我不确定如何在 Mocha.js + Sinon.js 中执行此操作。我能够监视 jquery 并检查是否调用了 when 方法：

```
spy = sinon.spy($, 'when')
@view.myMethod()
spy.called.should.be.true
spy.restore() 
```

但是我不能对 done 块做同样的事情，因为如果我理解正确的话，它与 when 方法返回的延迟对象有关。

我也尝试过这样的事情：

```
# NOT WORKING CODE
stub = sinon.stub($.Deferred(), 'done').returns
     myCallback: sinon.stub()
@view.myMethod()
stub.called.should.be.true
stub.restore() 
```

但仍然得到：

```
expected false to be true 
```

有任何想法吗？:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-07-06T08:51:48.063

`$.when`您可以像执行 ajax 请求一样存根。首先，您必须存根`$.when`并返回一个`$.Deferred`对象。

```
var stub = sinon.stub($, "when", function (event) {
    var result = $.Deferred();
    result.args = event;
    return result;
}) 
```

调用要测试的函数后，获取特定`$.when`调用的返回值，这将是延迟对象。手动解决它，您可以对`@myCallback`被调用者进行断言。

```
@view.myMethod()

// Get first when call
var call = $.when.getCall(0).returnValue;

// To return successful when call (having used .done() )
call.resolve(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:47:57.800

在视图类中模拟它？

```
#arrange
view = new View
view.myCallback = sinon.spy()

#act
view.myMethod()

#assert
view.myCallback.called.should.be.true 
```

回调是作为延迟`done`处理程序调用还是以任何其他方式调用是实现细节。调用该方法应该很重要（如果您选择，请使用正确的参数）。

# c - FFmpeg 不尊重不同容器的比特率？

> ID：14485681
> 
> 赞同：0
> 
> 时间：2013-01-23T17:26:40.997
> 
> 标签：c, ffmpeg, decode, h.264, encode

我正在尝试将**mp4**视频文件编码为**flv**视频。这是我正在做的事情：

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <math.h>
#include <libavcodec/avcodec.h>
#include <libavformat/avformat.h>

#define STREAM_FRAME_RATE 30 /* 30 images/s */
#define STREAM_PIX_FMT AV_PIX_FMT_YUV420P /* default pix_fmt */
/**************************************************************/
/* Add an output stream. */
static AVStream *add_stream(AVFormatContext *oc, AVCodec **codec,
        enum AVCodecID codec_id) {
    AVCodecContext *c;
    AVStream *st;
    /* find the encoder */
    *codec = avcodec_find_encoder(codec_id);
    if (!(*codec)) {
        fprintf(stderr, "Could not find encoder for '%s'\n",
                avcodec_get_name(codec_id));
        exit(1);
    }
    st = avformat_new_stream(oc, *codec);
    if (!st) {
        fprintf(stderr, "Could not allocate stream\n");
        exit(1);
    }
    st->id = oc->nb_streams - 1;
    c = st->codec;
    switch ((*codec)->type) {
    case AVMEDIA_TYPE_VIDEO:
        //avcodec_get_context_defaults3(c, *codec);
        c->codec_id = codec_id;
        c->bit_rate = 150 * 1000; //2314000;;
        //c->rc_max_rate = 150*1000;
        //c->rc_buffer_size = 150*1000;
        /* Resolution must be a multiple of two. */
        c->width = 1280;
        c->height = 720;
        /* timebase: This is the fundamental unit of time (in seconds) in terms
         * of which frame timestamps are represented. For fixed-fps content,
         * timebase should be 1/framerate and timestamp increments should be
         * identical to 1\. */
        c->time_base.den = STREAM_FRAME_RATE;
        c->time_base.num = 1;
        c->gop_size = 12; /* emit one intra frame every twelve frames at most */
        c->pix_fmt = STREAM_PIX_FMT;
        if (c->codec_id == AV_CODEC_ID_MPEG2VIDEO) {
            /* just for testing, we also add B frames */
            c->max_b_frames = 2;
        }
        if (c->codec_id == AV_CODEC_ID_MPEG1VIDEO) {
            /* Needed to avoid using macroblocks in which some coeffs overflow.
             * This does not happen with normal video, it just happens here as
             * the motion of the chroma plane does not match the luma plane. */
            c->mb_decision = 2;
        }
        break;
    default:
        break;
    }
    /* Some formats want stream headers to be separate. */
    if (oc->oformat->flags & AVFMT_GLOBALHEADER)
        c->flags |= CODEC_FLAG_GLOBAL_HEADER;
    return st;
}
/**************************************************************/
/* video output */
static AVFrame *frame;
static AVPicture src_picture, dst_picture;
static int frame_count;
static void open_video(AVFormatContext *oc, AVCodec *codec, AVStream *st) {
    int ret;
    AVCodecContext *c = st->codec;
    /* open the codec */
    ret = avcodec_open2(c, codec, NULL);
    if (ret < 0) {
        fprintf(stderr, "Could not open video codec: %s\n", av_err2str(ret));
        exit(1);
    }
    /* allocate and init a re-usable frame */
    frame = avcodec_alloc_frame();
    if (!frame) {
        fprintf(stderr, "Could not allocate video frame\n");
        exit(1);
    }
    /* Allocate the encoded raw picture. */
    ret = avpicture_alloc(&dst_picture, c->pix_fmt, c->width, c->height);
    if (ret < 0) {
        fprintf(stderr, "Could not allocate picture: %s\n", av_err2str(ret));
        exit(1);
    }
    /* If the output format is not YUV420P, then a temporary YUV420P
     * picture is needed too. It is then converted to the required
     * output format. */
    if (c->pix_fmt != AV_PIX_FMT_YUV420P) {
        ret = avpicture_alloc(&src_picture, AV_PIX_FMT_YUV420P, c->width,
                c->height);
        if (ret < 0) {
            fprintf(stderr, "Could not allocate temporary picture: %s\n",
                    av_err2str(ret));
            exit(1);
        }
    }
    /* copy data and linesize picture pointers to frame */
    *((AVPicture *) frame) = dst_picture;
}
static void close_video(AVFormatContext *oc, AVStream *st) {
    avcodec_close(st->codec);
    av_free(src_picture.data[0]);
    av_free(dst_picture.data[0]);
    av_free(frame);
}

int main(int argc, char *argv[]) {
    AVFormatContext *pFormatCtx = NULL;
    int i, videoStream;
    AVCodecContext *pCodecCtx = NULL;
    AVCodec *pCodec;
    AVFrame *pFrame;
    AVPacket packet;
    int frameFinished;

    const char *filename;
    AVOutputFormat *fmt;
    AVFormatContext *oc;
    AVStream *video_st;
    AVCodec *video_codec;
    int ret;

    // Register all formats, codecs and network
    av_register_all();
    avcodec_register_all();
    avformat_network_init();

    // Open video file
    if (avformat_open_input(&pFormatCtx, "input_file.mp4", NULL, NULL) != 0)
        return -1; // Couldn't open file

    // Retrieve stream information
    if (avformat_find_stream_info(pFormatCtx, NULL) < 0)
        return -1; // Couldn't find stream information

    // Dump information about file onto standard error
    av_dump_format(pFormatCtx, 0, "input_file.mp4", 0);

    // Find the first video stream
    videoStream = -1;
    for (i = 0; i < pFormatCtx->nb_streams; i++)
        if (pFormatCtx->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO) {
            videoStream = i;
            break;
        }
    if (videoStream == -1)
        return -1; // Didn't find a video stream

    // Get a pointer to the codec context for the video stream
    pCodecCtx = pFormatCtx->streams[videoStream]->codec;

    // Find the decoder for the video stream
    pCodec = avcodec_find_decoder(pCodecCtx->codec_id);
    if (pCodec == NULL) {
        fprintf(stderr, "Unsupported codec!\n");
        return -1; // Codec not found
    }
    // Open codec
    if (avcodec_open2(pCodecCtx, pCodec, NULL) < 0)
        return -1; // Could not open codec

    // Allocate video frame
    pFrame = avcodec_alloc_frame();

    // setup mux
    filename = "output_file.flv";
    fmt = av_guess_format("flv", filename, NULL);
    if (fmt == NULL) {
        printf("Could not guess format.\n");
        return -1;
    }
    // allocate the output media context
    oc = avformat_alloc_context();
    if (oc == NULL) {
        printf("could not allocate context.\n");
        return -1;
    }
    oc->oformat = fmt;

    // Add the video streams using the default format codecs
    // and initialize the codecs.
    video_st = NULL;
    if (fmt->video_codec != AV_CODEC_ID_NONE) {
        video_st = add_stream(oc, &video_codec, fmt->video_codec);
    }
    // Now that all the parameters are set, we can open the
    // video codec and allocate the necessary encode buffers.
    if (video_st)
        open_video(oc, video_codec, video_st);

    /* open the output file, if needed */
    if (!(fmt->flags & AVFMT_NOFILE)) {
        ret = avio_open(&oc->pb, filename, AVIO_FLAG_WRITE);
        if (ret < 0) {
            fprintf(stderr, "Could not open '%s': %s\n", filename,
                    av_err2str(ret));
            return 1;
        }
    }

    // dump output format
    av_dump_format(oc, 0, filename, 1);

    // Write the stream header, if any.
    ret = avformat_write_header(oc, NULL);
    if (ret < 0) {
        fprintf(stderr, "Error occurred when opening output file: %s\n",
                av_err2str(ret));
        return 1;
    }

    // Read frames, decode, and re-encode
    while (av_read_frame(pFormatCtx, &packet) >= 0) {
        // Is this a packet from the video stream?
        if (packet.stream_index == videoStream) {
            // Decode video frame
            avcodec_decode_video2(pCodecCtx, pFrame, &frameFinished, &packet);

            // Did we get a video frame?
            if (frameFinished) {

                AVFrame* newFrame = avcodec_alloc_frame(); // Initialize a new frame
                int size = avpicture_get_size(video_st->codec->pix_fmt,
                        video_st->codec->width, video_st->codec->height);
                uint8_t* picture_buf = av_malloc(size);

                avpicture_fill((AVPicture *) newFrame, picture_buf,
                        video_st->codec->pix_fmt, video_st->codec->width,
                        video_st->codec->height);

                // Copy only the frame content without any other disturbing
                av_picture_copy((AVPicture*) newFrame, (AVPicture*) pFrame,
                        video_st->codec->pix_fmt, video_st->codec->width,
                        video_st->codec->height);

                // encode the image
                AVPacket pkt;
                int got_output;
                av_init_packet(&pkt);
                pkt.data = NULL; // packet data will be allocated by the encoder
                pkt.size = 0;

                /* Setting newFrame->pts this way produces the error 'non-strictly-monotonic PTS' */
                //if(newFrame->pts != AV_NOPTS_VALUE)
                //newFrame->pts = av_rescale_q(newFrame->pts, video_st->time_base, video_st->codec->time_base);

                // Setting newFrame->pts this does not produce 'non-strictly-monotonic PTS'
                newFrame->pts = frame_count;

                ret = avcodec_encode_video2(video_st->codec, &pkt, newFrame, &got_output);
                if (ret < 0) {
                    fprintf(stderr, "Error encoding video frame: %s\n", av_err2str(ret));
                    exit(1);
                }

                if (got_output) {
                    if (video_st->codec->coded_frame->key_frame)
                    pkt.flags |= AV_PKT_FLAG_KEY;
                    pkt.stream_index = video_st->index;

                    if (pkt.pts != AV_NOPTS_VALUE)
                        pkt.pts = av_rescale_q(pkt.pts,
                                video_st->codec->time_base,
                                video_st->time_base);
                    if (pkt.dts != AV_NOPTS_VALUE)
                        pkt.dts = av_rescale_q(pkt.dts,
                                video_st->codec->time_base,
                                video_st->time_base);

                    // Write the compressed frame to the media file.
                    ret = av_interleaved_write_frame(oc, &pkt);
                } else {
                    ret = 0;
                }
                if (ret != 0) {
                    fprintf(stderr, "Error while writing video frame: %s\n",
                            av_err2str(ret));
                    exit(1);
                }

                fprintf(stderr, "encoded frame #%d\n", frame_count);
                frame_count++;
                av_free(picture_buf);
                av_free_packet(&pkt);
            }
        }

        // Free the packet that was allocated by av_read_frame
        av_free_packet(&packet);
    }

    /* Write the trailer, if any. The trailer must be written before you
     * close the CodecContexts open when you wrote the header; otherwise
     * av_write_trailer() may try to use memory that was freed on
     * av_codec_close(). */
    av_write_trailer(oc);

    /* Close video encoder (codec). */
    if (video_st)
        close_video(oc, video_st);
    // Free the streams.
    for (i = 0; i < oc->nb_streams; i++) {
        av_freep(&oc->streams[i]->codec);
        av_freep(&oc->streams[i]);
    }
    if (!(fmt->flags & AVFMT_NOFILE))
        /* Close the output file. */
        avio_close(oc->pb);
    /* free the stream */
    av_free(oc);

    // Free the YUV frame holding decoded frame
    av_free(pFrame);

    // Close the decoder (codec)
    avcodec_close(pCodecCtx);

    // Close the input video file
    avformat_close_input(&pFormatCtx);

    return 0;
} 
```

如果我通过更改将输出格式更改为**mp4、mov 或 f4v**：

```
// setup mux (FLV OUTPUT)
filename = "output_file.flv";
fmt = av_guess_format("flv", filename, NULL);
if (fmt == NULL) {
    printf("Could not guess format.\n");
    return -1;
} 
```

到

```
// setup mux (MP4 OUTPUT)
filename = "output_file.mp4";
fmt = av_guess_format("mp4", filename, NULL);
if (fmt == NULL) {
    printf("Could not guess format.\n");
    return -1;
} 
```

然后尊重比特率。这是使用**mp4**输出运行的输出

```
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'input_file.mp4':
  Metadata:
    major_brand     : mp42
    minor_version   : 0
    compatible_brands: isomavc1mp42
    creation_time   : 2010-02-09 19:11:10
  Duration: 00:04:31.80, start: 0.000000, bitrate: 2314 kb/s
    Stream #0:0(und): Audio: aac (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 125 kb/s
    Metadata:
      creation_time   : 2010-02-09 19:11:10
      handler_name    : (C) 2007 Google Inc. v08.13.2007.
    Stream #0:1(und): Video: h264 (High) (avc1 / 0x31637661), yuv420p, 1280x720 [SAR 1:1 DAR 16:9], 2186 kb/s, 30 fps, 30 tbr, 30k tbn, 60 tbc
    Metadata:
      creation_time   : 2010-02-09 19:11:10
      handler_name    : (C) 2007 Google Inc. v08.13.2007.
[libx264 @ 02268b80] using cpu capabilities: MMX2 SSE2Fast SSSE3 FastShuffle SSE4.2 AVX
[libx264 @ 02268b80] profile High, level 3.1
[libx264 @ 02268b80] 264 - core 129 r2230 1cffe9f - H.264/MPEG-4 AVC codec - Copyleft 2003-2012 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deb
lock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chro
ma_qp_offset=-2 threads=12 lookahead_threads=2 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1
 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=12 keyint_min=1 scenecut=40 intra_refresh=0 rc_lookahead=12 rc=abr mbtree=1 bitrate=150 ratetol=1.0 qco
mp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'output_file.mp4':
    Stream #0:0: Video: h264, yuv420p, 1280x720, q=-1--1, 150 kb/s, 90k tbn, 30 tbc
encoded frame #0
encoded frame #1
encoded frame #2
encoded frame #3
.
.
.
encoded frame #8142
encoded frame #8143
encoded frame #8144
encoded frame #8145
[libx264 @ 02174240] frame I:771   Avg QP:47.71  size:  2739
[libx264 @ 02174240] frame P:5083  Avg QP:50.05  size:   833
[libx264 @ 02174240] frame B:2264  Avg QP:48.16  size:    91
[libx264 @ 02174240] consecutive B-frames: 59.6%  6.4%  9.0% 24.9%
[libx264 @ 02174240] mb I  I16..4: 34.0% 65.8%  0.2%
[libx264 @ 02174240] mb P  I16..4:  6.8%  3.0%  0.0%  P16..4:  8.5%  0.4%  1.7%  0.0%  0.0%    skip:79.6%
[libx264 @ 02174240] mb B  I16..4:  0.0%  0.0%  0.0%  B16..8:  1.8%  0.0%  0.0%  direct: 0.0%  skip:98.2%  L0:23.6% L1:76.4% BI: 0.0%
[libx264 @ 02174240] final ratefactor: 57.62
[libx264 @ 02174240] 8x8 transform intra:52.1% inter:98.5%
[libx264 @ 02174240] coded y,uvDC,uvAC intra: 3.1% 14.0% 0.2% inter: 0.1% 0.4% 0.0%
[libx264 @ 02174240] i16 v,h,dc,p: 69% 23%  4%  4%
[libx264 @ 02174240] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 23%  6% 68%  1%  1%  1%  1%  0%  0%
[libx264 @ 02174240] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 41% 18% 18%  4%  4%  5%  3%  3%  3%
[libx264 @ 02174240] i8c dc,h,v,p: 98%  1%  1%  0%
[libx264 @ 02174240] Weighted P-Frames: Y:2.1% UV:1.2%
[libx264 @ 02174240] ref P L0: 72.4%  0.8% 19.1%  7.6%  0.1%
[libx264 @ 02174240] ref B L0: 89.8%  9.1%  1.2%
[libx264 @ 02174240] ref B L1: 96.2%  3.8%
[libx264 @ 02174240] kb/s:193.62 
```

**output_file.mp4**的最终文件大小约为**6.5MB**，使用 ffplay，我注意到比特率得到了尊重。当然，质量本身就显示出来了。

这是使用**flv**输出运行的输出：

```
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'input_file.mp4':
  Metadata:
    major_brand     : mp42
    minor_version   : 0
    compatible_brands: isomavc1mp42
    creation_time   : 2010-02-09 19:11:10
  Duration: 00:04:31.80, start: 0.000000, bitrate: 2314 kb/s
    Stream #0:0(und): Audio: aac (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 125 kb/s
    Metadata:
      creation_time   : 2010-02-09 19:11:10
      handler_name    : (C) 2007 Google Inc. v08.13.2007.
    Stream #0:1(und): Video: h264 (High) (avc1 / 0x31637661), yuv420p, 1280x720 [SAR 1:1 DAR 16:9], 2186 kb/s, 30 fps, 30 tbr, 30k tbn, 60 tbc
    Metadata:
      creation_time   : 2010-02-09 19:11:10
      handler_name    : (C) 2007 Google Inc. v08.13.2007.
Output #0, flv, to 'output_file.flv':
    Stream #0:0: Video: flv1, yuv420p, 1280x720, q=2-31, 150 kb/s, 90k tbn, 30 tbc
encoded frame #0
encoded frame #1
encoded frame #2
encoded frame #3
.
.
.
encoded frame #8142
encoded frame #8143
encoded frame #8144
encoded frame #8145 
```

我注意到只要容器是 mp4、mov、f4v 或类似的东西，比特率就会受到尊重。如果我尝试使用 flv、wmv 或其他不同的容器，则比特率不会受到尊重。此外，为 wmv 自动设置的比特率与 flv 不同。我不确定我做错了什么。我怀疑它与**pts**有关，但是，我找不到解决方案:(。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T09:02:51.410

您将视频比特率设置为每秒 150 kbits。它对于 720p 分辨率的视频来说太小了。

您正在使用不同的视频编码器：h264 用于 mp4，Sorenson (flv1) 用于 flv。在这样的比特率下，它们可以以不同的方式工作也就不足为奇了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T09:33:51.773

`H.264`具有非常好的压缩算法并且可以实现非常低的比特率，但对于其他较旧的编解码器（如`flv1`. 它不是导致这种差异的容器。它的视频编解码器，`mp4`在 ffmpeg`h.264`默认使用和 flv 使用`flv1(h.263)`。容器也`flv`支持`h.264`。如果它只是您感兴趣的容器，请将 vcodec 设置为`h.264`or `libx264`，您将获得与`mp4`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T13:58:56.920

感谢您的帮助！我忘记了我正在将默认格式编解码器传递给**add_stream**函数。因此，我使用了 flv 的默认值（正如您提到的，对于 mp4 是 flv1 和 h.264，对于 wmv 是 msmpeg4v3）。上面代码中的错误来源是以下行：

```
// Add the video streams using the default format codecs
// and initialize the codecs.
video_st = NULL;
if (fmt->video_codec != AV_CODEC_ID_NONE) {
    video_st = add_stream(oc, &video_codec, fmt->video_codec);
} 
```

将其更改为：

```
// Add the video stream using the h.264
// codec and initialize the codec.
video_st = NULL;
video_st = add_stream(oc, &video_codec, AV_CODEC_ID_H264); 
```

解决了这个问题。这是固定的源代码/输出：

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <math.h>
#include <libavcodec/avcodec.h>
#include <libavformat/avformat.h>

#define STREAM_FRAME_RATE 30 /* 30 frames/s */
#define STREAM_PIX_FMT AV_PIX_FMT_YUV420P /* default pix_fmt */
/**************************************************************/
/* video output */
static AVFrame *frame;
static AVPicture src_picture, dst_picture;
static void open_video(AVFormatContext *oc, AVCodec *codec, AVStream *st) {
    int ret;
    AVCodecContext *c = st->codec;
    /* open the codec */
    ret = avcodec_open2(c, codec, NULL);
    if (ret < 0) {
        fprintf(stderr, "Could not open video codec: %s\n", av_err2str(ret));
        exit(1);
    }
    /* allocate and init a re-usable frame */
    frame = avcodec_alloc_frame();
    if (!frame) {
        fprintf(stderr, "Could not allocate video frame\n");
        exit(1);
    }
    /* Allocate the encoded raw picture. */
    ret = avpicture_alloc(&dst_picture, c->pix_fmt, c->width, c->height);
    if (ret < 0) {
        fprintf(stderr, "Could not allocate picture: %s\n", av_err2str(ret));
        exit(1);
    }
    /* If the output format is not YUV420P, then a temporary YUV420P
     * picture is needed too. It is then converted to the required
     * output format. */
    if (c->pix_fmt != AV_PIX_FMT_YUV420P) {
        ret = avpicture_alloc(&src_picture, AV_PIX_FMT_YUV420P, c->width, c->height);
        if (ret < 0) {
            fprintf(stderr, "Could not allocate temporary picture: %s\n", av_err2str(ret));
            exit(1);
        }
    }
    /* copy data and linesize picture pointers to frame */
    *((AVPicture *) frame) = dst_picture;
}
static void close_video(AVFormatContext *oc, AVStream *st) {
    avcodec_close(st->codec);
    av_free(src_picture.data[0]);
    av_free(dst_picture.data[0]);
    av_free(frame);
}
/**************************************************************/
/* Add an output stream. */
static AVStream *add_stream(AVFormatContext *oc, AVCodec **codec, enum AVCodecID codec_id) {
    AVCodecContext *c;
    AVStream *st;
    /* find the encoder */
    *codec = avcodec_find_encoder(codec_id);
    if (!(*codec)) {
        fprintf(stderr, "Could not find encoder for '%s'\n", avcodec_get_name(codec_id));
        exit(1);
    }
    st = avformat_new_stream(oc, *codec);
    if (!st) {
        fprintf(stderr, "Could not allocate stream\n");
        exit(1);
    }
    st->id = oc->nb_streams - 1;
    c = st->codec;
    switch ((*codec)->type) {
    case AVMEDIA_TYPE_VIDEO:
        avcodec_get_context_defaults3(c, *codec);
        c->codec_id = codec_id;
        c->bit_rate = 150 * 1000;
        /* Resolution must be a multiple of two. */
        c->width = 1280;
        c->height = 720;
        /* timebase: This is the fundamental unit of time (in seconds) in terms
         * of which frame timestamps are represented. For fixed-fps content,
         * timebase should be 1/framerate and timestamp increments should be
         * identical to 1\. */
        c->time_base.den = STREAM_FRAME_RATE;
        c->time_base.num = 1;
        c->gop_size = 12; /* emit one intra frame every twelve frames at most */
        c->pix_fmt = STREAM_PIX_FMT;
        if (c->codec_id == AV_CODEC_ID_MPEG2VIDEO) {
            /* just for testing, we also add B frames */
            c->max_b_frames = 2;
        }
        if (c->codec_id == AV_CODEC_ID_MPEG1VIDEO) {
            /* Needed to avoid using macroblocks in which some coeffs overflow.
             * This does not happen with normal video, it just happens here as
             * the motion of the chroma plane does not match the luma plane. */
            c->mb_decision = 2;
        }
        break;
    default:
        break;
    }
    /* Some formats want stream headers to be separate. */
    if (oc->oformat->flags & AVFMT_GLOBALHEADER)
        c->flags |= CODEC_FLAG_GLOBAL_HEADER;
    return st;
}

int main(int argc, char *argv[]) {
    // Decoder local variable declaration
    AVFormatContext *pFormatCtx = NULL;
    int i, videoStream;
    AVCodecContext *pCodecCtx = NULL;
    AVCodec *pCodec;
    AVFrame *pFrame;
    AVPacket packet;
    int frameFinished;

    // Encoder local variable declaration
    const char *filename;
    AVOutputFormat *fmt;
    AVFormatContext *oc;
    AVStream *video_st;
    AVCodec *video_codec;
    int ret, frame_count;

    // Register all formats and codecs
    av_register_all();
    avcodec_register_all();

    // Open video file
    if (avformat_open_input(&pFormatCtx, "input_file.mp4", NULL, NULL) != 0)
        return -1; // Couldn't open file

    // Retrieve stream information
    if (avformat_find_stream_info(pFormatCtx, NULL) < 0)
        return -1; // Couldn't find stream information

    // Dump information about file onto standard error
    av_dump_format(pFormatCtx, 0, "input_file.mp4", 0);

    // Find the first video stream
    videoStream = -1;
    for (i = 0; i < pFormatCtx->nb_streams; i++)
        if (pFormatCtx->streams[i]->codec->codec_type == AVMEDIA_TYPE_VIDEO) {
            videoStream = i;
            break;
        }
    if (videoStream == -1)
        return -1; // Didn't find a video stream

    // Get a pointer to the codec context for the video stream
    pCodecCtx = pFormatCtx->streams[videoStream]->codec;

    // Find the decoder for the video stream
    pCodec = avcodec_find_decoder(pCodecCtx->codec_id);
    if (pCodec == NULL) {
        fprintf(stderr, "Unsupported codec!\n");
        return -1; // Codec not found
    }
    // Open codec (decoder)
    if (avcodec_open2(pCodecCtx, pCodec, NULL) < 0)
        return -1; // Could not open codec

    // Allocate video frame
    pFrame = avcodec_alloc_frame();

    // setup mux
    filename = "output_file.flv";
    fmt = av_guess_format("flv", filename, NULL);
    if (fmt == NULL) {
        printf("Could not guess format.\n");
        return -1;
    }
    // allocate the output media context
    oc = avformat_alloc_context();
    if (oc == NULL) {
        printf("could not allocate context.\n");
        return -1;
    }

    // Set out format context to the format ffmpeg guessed
    oc->oformat = fmt;

    // Add the video stream using the h.264
    // codec and initialize the codec.
    video_st = NULL;
    video_st = add_stream(oc, &video_codec, AV_CODEC_ID_H264);

    // Now that all the parameters are set, we can open the
    // video codec and allocate the necessary encode buffers.
    if (video_st)
        open_video(oc, video_codec, video_st);

    /* open the output file, if needed */
    if (!(fmt->flags & AVFMT_NOFILE)) {
        ret = avio_open(&oc->pb, filename, AVIO_FLAG_WRITE);
        if (ret < 0) {
            fprintf(stderr, "Could not open '%s': %s\n", filename, av_err2str(ret));
            return 1;
        }
    }

    // dump output format
    av_dump_format(oc, 0, filename, 1);

    // Write the stream header, if any.
    ret = avformat_write_header(oc, NULL);
    if (ret < 0) {
        fprintf(stderr, "Error occurred when opening output file: %s\n", av_err2str(ret));
        return 1;
    }

    // Read frames, decode, and re-encode
    frame_count = 1;
    while (av_read_frame(pFormatCtx, &packet) >= 0) {
        // Is this a packet from the video stream?
        if (packet.stream_index == videoStream) {
            // Decode video frame
            avcodec_decode_video2(pCodecCtx, pFrame, &frameFinished, &packet);

            // Did we get a video frame?
            if (frameFinished) {

                // Initialize a new frame
                AVFrame* newFrame = avcodec_alloc_frame();

                int size = avpicture_get_size(video_st->codec->pix_fmt, video_st->codec->width, video_st->codec->height);
                uint8_t* picture_buf = av_malloc(size);

                avpicture_fill((AVPicture *) newFrame, picture_buf, video_st->codec->pix_fmt, video_st->codec->width, video_st->codec->height);

                // Copy only the frame content without additional fields
                av_picture_copy((AVPicture*) newFrame, (AVPicture*) pFrame, video_st->codec->pix_fmt, video_st->codec->width, video_st->codec->height);

                // encode the image
                AVPacket pkt;
                int got_output;
                av_init_packet(&pkt);
                pkt.data = NULL; // packet data will be allocated by the encoder
                pkt.size = 0;

                // Set the frame's pts (this prevents the warning notice 'non-strictly-monotonic PTS')
                newFrame->pts = frame_count;

                ret = avcodec_encode_video2(video_st->codec, &pkt, newFrame, &got_output);
                if (ret < 0) {
                    fprintf(stderr, "Error encoding video frame: %s\n", av_err2str(ret));
                    exit(1);
                }

                if (got_output) {
                    if (video_st->codec->coded_frame->key_frame)
                        pkt.flags |= AV_PKT_FLAG_KEY;
                    pkt.stream_index = video_st->index;

                    if (pkt.pts != AV_NOPTS_VALUE)
                        pkt.pts = av_rescale_q(pkt.pts, video_st->codec->time_base, video_st->time_base);
                    if (pkt.dts != AV_NOPTS_VALUE)
                        pkt.dts = av_rescale_q(pkt.dts, video_st->codec->time_base, video_st->time_base);

                    // Write the compressed frame to the media file.
                    ret = av_interleaved_write_frame(oc, &pkt);
                } else {
                    ret = 0;
                }
                if (ret != 0) {
                    fprintf(stderr, "Error while writing video frame: %s\n", av_err2str(ret));
                    exit(1);
                }

                fprintf(stderr, "encoded frame #%d\n", frame_count);
                frame_count++;

                // Free the YUV picture frame we copied from the
                // decoder to eliminate the additional fields
                // and other packets/frames used
                av_free(picture_buf);
                av_free_packet(&pkt);
                av_free(newFrame);
            }
        }

        // Free the packet that was allocated by av_read_frame
        av_free_packet(&packet);
    }

    /* Write the trailer, if any. The trailer must be written before you
     * close the CodecContexts open when you wrote the header; otherwise
     * av_write_trailer() may try to use memory that was freed on
     * av_codec_close(). */
    av_write_trailer(oc);

    /* Close the video codec (encoder) */
    if (video_st)
        close_video(oc, video_st);
    // Free the output streams.
    for (i = 0; i < oc->nb_streams; i++) {
        av_freep(&oc->streams[i]->codec);
        av_freep(&oc->streams[i]);
    }
    if (!(fmt->flags & AVFMT_NOFILE))
        /* Close the output file. */
        avio_close(oc->pb);
    /* free the output format context */
    av_free(oc);

    // Free the YUV frame populated by the decoder
    av_free(pFrame);

    // Close the video codec (decoder)
    avcodec_close(pCodecCtx);

    // Close the input video file
    avformat_close_input(&pFormatCtx);

    return 0;
} 
```

这是输出：

```
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'input_file.mp4':
  Metadata:
    major_brand     : mp42
    minor_version   : 0
    compatible_brands: isomavc1mp42
    creation_time   : 2010-02-09 19:11:10
  Duration: 00:04:31.80, start: 0.000000, bitrate: 2314 kb/s
    Stream #0:0(und): Audio: aac (mp4a / 0x6134706D), 44100 Hz, stereo, fltp, 125 kb/s
    Metadata:
      creation_time   : 2010-02-09 19:11:10
      handler_name    : (C) 2007 Google Inc. v08.13.2007.
    Stream #0:1(und): Video: h264 (High) (avc1 / 0x31637661), yuv420p, 1280x720 [SAR 1:1 DAR 16:9], 2186 kb/s, 30 fps, 30 tbr, 30k tbn, 60 tbc
    Metadata:
      creation_time   : 2010-02-09 19:11:10
      handler_name    : (C) 2007 Google Inc. v08.13.2007.
video codec id = 28 | name = FLV (Flash Video)
[libx264 @ 021891c0] using cpu capabilities: MMX2 SSE2Fast SSSE3 FastShuffle SSE4.2 AVX
[libx264 @ 021891c0] profile High, level 3.1
[libx264 @ 021891c0] 264 - core 129 r2230 1cffe9f - H.264/MPEG-4 AVC codec - Copyleft 2003-2012 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deb
lock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chro
ma_qp_offset=-2 threads=12 lookahead_threads=2 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1
 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=12 keyint_min=1 scenecut=40 intra_refresh=0 rc_lookahead=12 rc=abr mbtree=1 bitrate=150 ratetol=1.0 qco
mp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, flv, to 'output_file.flv':
    Stream #0:0: Video: h264, yuv420p, 1280x720, q=-1--1, 150 kb/s, 90k tbn, 30 tbc
encoded frame #1
encoded frame #2
encoded frame #3
encoded frame #4
.
.
.
encoded frame #8143
encoded frame #8144
encoded frame #8145
encoded frame #8146
[libx264 @ 02241ae0] frame I:771   Avg QP:47.71  size:  2739
[libx264 @ 02241ae0] frame P:5083  Avg QP:50.05  size:   833
[libx264 @ 02241ae0] frame B:2264  Avg QP:48.16  size:    91
[libx264 @ 02241ae0] consecutive B-frames: 59.6%  6.4%  9.0% 24.9%
[libx264 @ 02241ae0] mb I  I16..4: 34.0% 65.8%  0.2%
[libx264 @ 02241ae0] mb P  I16..4:  6.8%  3.0%  0.0%  P16..4:  8.5%  0.4%  1.7%  0.0%  0.0%    skip:79.6%
[libx264 @ 02241ae0] mb B  I16..4:  0.0%  0.0%  0.0%  B16..8:  1.8%  0.0%  0.0%  direct: 0.0%  skip:98.2%  L0:23.6% L1:76.4% BI: 0.0%
[libx264 @ 02241ae0] final ratefactor: 57.62
[libx264 @ 02241ae0] 8x8 transform intra:52.1% inter:98.5%
[libx264 @ 02241ae0] coded y,uvDC,uvAC intra: 3.1% 14.0% 0.2% inter: 0.1% 0.4% 0.0%
[libx264 @ 02241ae0] i16 v,h,dc,p: 69% 23%  4%  4%
[libx264 @ 02241ae0] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 23%  6% 68%  1%  1%  1%  1%  0%  0%
[libx264 @ 02241ae0] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 41% 18% 18%  4%  4%  5%  3%  3%  3%
[libx264 @ 02241ae0] i8c dc,h,v,p: 98%  1%  1%  0%
[libx264 @ 02241ae0] Weighted P-Frames: Y:2.1% UV:1.2%
[libx264 @ 02241ae0] ref P L0: 72.4%  0.8% 19.1%  7.6%  0.1%
[libx264 @ 02241ae0] ref B L0: 89.8%  9.1%  1.2%
[libx264 @ 02241ae0] ref B L1: 96.2%  3.8%
[libx264 @ 02241ae0] kb/s:193.62 
```

感谢您的帮助！

# css - 为什么我的 CSS 布局行为异常（请参阅链接）？

> ID：14485683
> 
> 赞同：3
> 
> 时间：2013-01-23T17:27:03.587
> 
> 标签：css, html, web-applications, responsive-design

这个问题特定于我正在构建的网站。请参阅：[http ://www.creeksidekitchen.ca/seniors](http://www.creeksidekitchen.ca/seniors)

布局在页面中心有两列并排，总宽度为 850 像素。但是，只要浏览器窗口宽度为 1275 像素或更小，右列就会下降到左列下方。

我希望这仅在窗口宽度降至 850 像素或更少时发生 - 即我希望它具有响应性，因此只有当窗口太小而无法并排显示两列时，列才应堆叠。

为什么堆叠发生在 1275px 上？

我迷失在自己的布局和逻辑中，我希望从外面看的人能发现引发问题的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:31:45.543

您应该删除/编辑以下代码`master.css`：

```
@media only screen and (min-width: 480px) and (max-width: 1275px) {
  .column2 {
    clear: left;
  }
} 
```

请参考属性定义：[http ://www.w3.org/wiki/CSS/Properties/clear](http://www.w3.org/wiki/CSS/Properties/clear)

# r - 与 data.table 分组时，如何保留未出现在输入数据中的变量组合？

> ID：14485687
> 
> 赞同：9
> 
> 时间：2013-01-23T17:27:15.070
> 
> 标签：r, data.table

使用[data.table](http://cran.r-project.org/web/packages/data.table/index.html)包，是否可以汇总未出现在输入中的变量的数据保留组合？

使用[plyr](http://cran.r-project.org/web/packages/plyr/index.html)包，我知道如何使用 .drop 参数执行此操作，例如：

```
require(plyr)
df <- data.frame(categories = c(rep("A",3), rep("B",3), rep("C",3)), groups = c(rep(c("X", "Y"),4), "Z"), values = rep(1, 9))

df1 <- ddply(df, c("categories","groups"), .drop = F, summarise, sum = sum(values)) 
```

输出：

```
 categories groups sum
1          A      X   2
2          A      Y   1
3          A      Z   0
4          B      X   1
5          B      Y   2
6          B      Z   0
7          C      X   1
8          C      Y   1
9          C      Z   1 
```

在这种情况下，即使总和为 0，我也会保留所有组/类别组合。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-23T18:16:48.807

好问题。这里有两种方法。他们都使用by-without-by。

```
DT = as.data.table(df)
setkey(DT,categories,groups)
DT[CJ(unique(categories),unique(groups)), sum(values,na.rm=TRUE)]

   categories groups V1
1:          A      X  2
2:          A      Y  1
3:          A      Z  0
4:          B      X  1
5:          B      Y  2
6:          B      Z  0
7:          C      X  1
8:          C      Y  1
9:          C      Z  1 
```

其中`CJ`代表交叉连接，请参阅`?CJ`。by-without-by 仅表示在每行加入的`j`每个组上执行。`i`

诚然，乍一看它看起来很棘手。这个想法是，如果您有一个已知的组子集，则此语法比将所有内容分组然后仅从中选择您需要的结果更快。但是在这种情况下，您无论如何都想要所有东西，所以除了能够查找数据中不存在的组（您无法使用`by`）之外，没有太多优势。

另一种方法是`by`首先照常，然后将`CJ()`结果加入：

```
DT[,sum(values),keyby='categories,groups'][CJ(unique(categories),unique(groups))]
   categories groups V1
1:          A      X  2
2:          A      Y  1
3:          A      Z NA
4:          B      X  1
5:          B      Y  2
6:          B      Z NA
7:          C      X  1
8:          C      Y  1
9:          C      Z  1 
```

但随后你会得到 NA 而不是所需的 0。`set()`如果需要，可以使用这些替换。第二种方法可能更快，因为这两个`unique`调用的输入要小得多。

如果您经常这样做，这两种方法都可以包装成小的辅助函数。

# oracle - 执行的过程不插入行

> ID：14485695
> 
> 赞同：0
> 
> 时间：2013-01-23T17:27:41.783
> 
> 标签：oracle, error-handling, plsql, procedure

我试图运行一个`procedure`where if the `PK`is `null`then `insert variables`。我执行了`procedure`并没有收到错误，但是当我去看它时`table`它仍然是空的。这是我的代码：

```
declare
  type tempcursor is ref cursor;
  v_cur_result tempcursor;
  errcode number;
  errmesg varchar2(1000);
begin
  ct_cu_act_um_pg.spt_save_casedetail
  (null, 8172923, 'SRVCTYPE_CARDPULREHB', systimestamp, 23861881, systimestamp,
  systimestamp, 'CASESTS_COMPL', 'CASESTSCAT_CLSD',
  23778805, 'SRCSRVC_URGNT', 'RESOLS_TRMNTREND', 23778805, 'SRVCDESC_BEDTOIL', 'Y', 'ADAM WAS HERE', 23778805, 'PLCSRVC_OTH', 'N',
  'ADAM', v_cur_result, errcode, errmesg);
end; 
```

规格如下：

```
procedure spt_save_casedetail (
p_casedetailid_in             in casedetail.casedetailid%type,
p_primarymemberplanid_in      in casedetail.primarymemberplanid%type,
p_servicetypecd_in            in casedetail.servicetypecd%type,
p_notifydt_in                 in casedetail.notifydt%type,
p_assignedentityid_in         in casedetail.assignedentityid%type,
p_startdt_in                  in casedetail.startdt%type,
p_enddt_in                    in casedetail.enddt%type,
p_casetypemnemonic_in         in casedetail.casetypemnemonic%type,
p_casestatusmnemonic_in       in casedetail.casestatusmnemonic%type,
p_odsorderingproviderid_in    in casedetail.odsorderingproviderid%type,
p_sourcemnemonic_in           in casedetail.sourcemnemonic%type,
p_caseresolutionmnemonic_in   in casedetail.caseresolutionmnemonic%type,
p_odsservicingproviderid_in   in casedetail.odsservicingproviderid%type,
p_serviceitemmnemonic_in      in casedetail.serviceitemmnemonic%type,
p_providerinnetworkind_in     in casedetail.providerinnetworkind%type,
p_detailtxt_in                in casedetail.detailtxt%type,
p_odsfacilityvendorid_in      in casedetail.odsfacilityvendorid%type,
p_servicelocationcd_in        in casedetail.servicelocationcd%type,
p_facilityinnetworkind_in     in casedetail.facilityinnetworkind%type,
p_audit_user_in               in casedetail.updatedby%type,
p_return_cur_out              out sys_refcursor,
p_err_code_out                out number,
p_err_mesg_out                out varchar2); 
```

我和某人谈过，他们说了一些关于打开的事情，`cursor`但我不确定该怎么做，所以我正在调查它。无论如何，任何朝着正确方向的轻推都会受到赞赏，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:46:58.480

没关系，我想通了，它没有被插入，因为找不到服务类型 cd。一旦我将其更改为不同的类型，它就会被插入。

# wcf - 在 WCF 中验证令牌（WSE 方法）

> ID：14485697
> 
> 赞同：0
> 
> 时间：2013-01-23T17:27:43.597
> 
> 标签：wcf, security, wse

我目前在 WSE 中验证用户名和密码（令牌）的方法如下：

```
public override void VerifyToken(SecurityToken token1)
{
    if (token1 is UsernameToken)
    {
        string u1 = (token1 as UsernameToken).Username;
        string p1 = (token1 as UsernameToken).Password;

        // see if this user is already authenticated
        UsernameToken token2 = TokenCache[u1] as UsernameToken;
        if ((token2 != null) && token2.IsCurrent && (token2.Password == p1))
        {
            // less than 30s?
            if ((DateTime.Now - token2.Created) < TimeSpan.FromSeconds(30))
                return;
            else
                // no - remove from cache
                RemoveFromCache(token1);
        }

        // not cached, so actually check
        // NB Two or more requests for same user at about same time may all fail test above
        // and thus all will call ValidateUser.  But then they will all call CacheSecurityToken below,
        // which is OK - the last one wins.
        if (Membership.ValidateUser(u1, p1))
        {
            Cache(token1);
            return;
        }

        // not authenticated
        throw new Exception("Authentication failed for " + u1);
    } 
```

知道如何在 WCF 中进行更改吗？我使用过**Microsoft.Web.Service3** WSE 程序集 - 不想使用它。想从我的整个解决方案中摆脱 UsernameToken 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T15:00:55.003

我已经在每个 Web 服务调用中验证了我的安全凭证。我已经使用目录键值对来缓存凭据 - 如果有人在寻找类似的，它会有所帮助。

```
public class SecurityManager : UserNamePasswordValidator
{
    //cacheCredentials stores username and password
    static Dictionary<string, string> cacheCredentials = new Dictionary<string, string>();
    //cacheTimes stores username and time that username added to dictionary.
    static Dictionary<string, DateTime> cacheTimes = new Dictionary<string, DateTime>();

    public override void Validate(string userName, string password)
    {
        if (userName == null || password == null)
        {
            throw new ArgumentNullException();
        }
        if (cacheCredentials.ContainsKey(userName))
        {
            if ((cacheCredentials[userName] == password) && ((DateTime.Now - cacheTimes[userName]) < TimeSpan.FromSeconds(30)))// &&  timespan < 30 sec - TODO
                return;

            cacheCredentials.Remove(userName);
            cacheTimes.Remove(userName);
        }
        if (Membership.ValidateUser(userName, password))
        {
            //cache usename(key) and password(value)
            cacheCredentials.Add(userName, password);
            //cache username(key), time that username added to dictionary 
            cacheTimes.Add(userName, DateTime.Now);
            return;
        }
        throw new FaultException("Authentication failed for the user");       
    }
} 
```

# java - Java 和参考资料

> ID：14485699
> 
> 赞同：0
> 
> 时间：2013-01-23T17:27:50.297
> 
> 标签：java

我有基础课：

```
 public class SomeClass {

    private List<String> list = new ArrayList<String>();

    public List<String> getList() {
        return list;
    }

    public void setList(List<String> list) {
        this.list = list;
    }   

} 
```

在一种方法中，我有以下代码：

```
private void test(){

    SomeClass sc1 = new SomeClass();
    sc1.getList().add("a");
    sc1.getList().add("b");

    SomeClass sc2 = sc1;

    System.out.println(sc2.getList().size());

    sc1.getList().remove(0);
    System.out.println(sc2.getList().size());

    sc1=null;
    System.out.println(sc2.getList().size());

    sc2=null;
    System.out.println(sc2.getList().size());

} 
```

我收到 ：

*   2
*   1
*   1
*   空指针异常

但我虽然会收到：

*   2
*   1
*   空指针异常
*   NullPointerException（如果之前的 NullPointerException 被捕获）

如果一个被引用的对象被设置为`null`，引用链接被破坏了？谢谢你的澄清

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-23T17:31:35.357

> 如果引用的对象设置为 null，则引用链接断开？

没有将*对象*设置为null的概念，您只能将*变量*设置为null。这个说法：

```
sc1=null; 
```

... 改变 的 值`sc1` *，仅此而已*。

变量是一个简单的带有名字的存储位置。存储位置有一个值，对于非原始类型的变量，该值是一个引用。了解变量的值不是*对象*非常*重要。*这只是一个参考。

 *所以这个声明：

```
SomeClass sc2 = sc1; 
```

只需声明一个新变量 ( `sc2`)，它以与现有变量 ( ) 相同的值开始`sc1`。这两个变量是完全独立的——它们只是碰巧具有相同的值。

我喜欢把变量想象成一张纸。一张纸上可以有一些原始值，例如数字，或者它可以有一个家庭地址¹。想象一下这些步骤：

*   造房子
*   将那所房子的地址写在一张纸上（`sc1`）
*   将文字复制`sc1`到另一张纸上（`sc2`）
*   擦掉上面的地址`sc1`
*   访问地址所在的房子`sc2`

这与您在这里所做的类似......并且显然擦掉价值`sc1`不会影响房子或这`sc2`张纸。

现在至于为什么你看到 2 然后 1 ......想象这些步骤：

*   造房子
*   将那所房子的地址写在一张纸上（`sc1`）
*   用来找房子`sc1`，把两个包裹放在门口
*   将文字复制`sc1`到另一张纸上（`sc2`）
*   用来找房子`sc1`，大声喊出你找到了多少包裹
*   用来找房子`sc1`，拿走一个包裹
*   用来找房子`sc2`，大声喊出你找到了多少包裹

第一次你会喊 2，然后你会喊 1。你并没有改变纸片上的值——你通过添加或移除包裹来改变房子本身。

* * *

¹我知道引用不一定是内存地址。这纯粹是为了类比，我发现这是有帮助的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-23T17:30:51.600

当您设置`sc2`为 时`sc1`，您*复制*参考。这两个变量引用同一个对象，*但它们不会成为同一个变量*。设置`sc1`为`null`不会改变`sc2`- 它引用同一个`SomeClass`对象，所以`NullPointerException`当你访问它的`getList()`方法时没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:35:05.437

让我们看一下事情指向的地方：

```
SomeClass sc1 = new SomeClass(); 
```

在这里，您有 sc1 指向（引用）您新创建的类，而 sc2 甚至不在图片中。

```
SomeClass sc2 = sc1; 
```

你有 sc1 和 sc2 指向同一个对象。

```
sc1=null; 
```

您的对象仍然完好无损，因为 sc2 仍然指向它。Sc1 为空并且不指向任何东西。由于 sc2，对象本身不符合垃圾收集条件。

```
sc2=null; 
```

现在你有 sc1 和 sc2 都指向任何东西。您的对象没有对它的引用，垃圾收集器将（最终）释放它。

正如您一步一步看到的那样，“引用链接已损坏”，但对象本身并没有真正受到影响，直到其所有引用都丢失。只要你对它有单一的引用，对象就是活着的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:32:19.253

如果你做`SomeClass sc1 = new SomeClass()`，你会做类似的东西`sc1->OBJECT`。做`sc2=sc1`，就像做`sc2->sc1->OBJECT`，或者`sc2->OBJECT`。因此更改 sc1 引用不会更改 sc2。*

# cocoa-bindings - NSTextField 不使用核心数据绑定更新计算属性

> ID：14485701
> 
> 赞同：0
> 
> 时间：2013-01-23T17:27:52.610
> 
> 标签：cocoa-bindings, key-value-observing, nstextfield, nsarraycontroller, nsset

SO新手；我的第一个问题：

回复：核心数据，使用绑定的基于文档的应用程序：

我有一个**NSTableView**绑定到**NSArrayController**，绑定到实体**LineItem**，有几列绑定到以下**LineItem**属性/属性：*amount*、*price*和*total*。我正在使用 + **keyPathsForValuesAffectingTotal**来观察*amount*和*price*的变化。属性*total*会随任何更改立即更新。我有另一个实体**Item**。它与**LineItem具有一对多的关系（** *items*），因为每个**Item** 可以有很多******行项目**。**Item**也有一个**NSTableView**绑定到一个**NSArrayController**，它绑定到它各自的实体**Item**。该表也有几列，但其中之一是*lineItemTotal* (items.@sum.total)。****

 ****```
- (NSNumber *)lineItemTotal {
     float totalOfAllLineItemTotals = [[self valueForKeyPath:@"items.@sum.total"]floatValue];
     [self willAccessValueForKey:@"lineItemTotal"];
     return [NSNumber numberWithFloat:totalOfAllLineItemTotals];
     [self didAccessValueForKey:@"lineItemTotal"];
     return [NSNumber numberWithFloat:totalOfAllLineItemTotals];
} 
```

lineItemTotal值使用**NSNotification** *NSManagedObjectContextObjectsDidChangeNotification**立即*更新，它调用我的选择器 updateLineItemTotal: 发送消息：[self.view setNeedsDisplay:YES]; 一切正常...但是，此视图应该看起来像收据。因此，正如用户所期望的那样，我在**LineItem**表下方有一个 NSTextField来显示总数。我尝试将它绑定到与**Item相同的****NSArrayController**，但这不起作用。在绑定检查器中，我不能为**控制器键选择****排列对象** *************，因为它不是一张桌子。（这就是 Item Table 的设置和正常工作方式）我唯一的选择是**Controller Key**的“选择” 。无论如何，它总是显示正确的值，但只有在我创建了一个新的 Item 实例（通过**NSButton**绑定到 add:) 并返回到旧的 Item 实例之后。它不会像其他所有内容一样立即更新：用户会发现这不专业。**我已经尝试了 Hillegass 的建议，搜索了 Stack Overflow，以及 Apple 推荐的关于在处理NSSet**时更新值的变通方法。Apple 建议设置通知。我这样做了，这次没有用。我已经尝试了所有明显的解决方法，但没有成功。我相信它归结为**KVC**和**KVO**; **不幸的是，在使用NSSets**时，Apple 对这些强大的工具几乎没有支持，至少表面上不支持。任何帮助，将不胜感激。*************

 ****** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T01:55:48.543

我在这里看到的第一个问题是，您似乎在所有语句执行之前从该方法返回：

```
- (NSNumber *)lineItemTotal {
     float totalOfAllLineItemTotals = [[self valueForKeyPath:@"items.@sum.total"]floatValue];
     [self willAccessValueForKey:@"lineItemTotal"];
     return [NSNumber numberWithFloat:totalOfAllLineItemTotals];
     // Anything below here will never be executed.
     [self didAccessValueForKey:@"lineItemTotal"];
     return [NSNumber numberWithFloat:totalOfAllLineItemTotals];
} 
```

即便如此，我还是花了几分钟的时间编写了代码，根据我的经验，集合运算符（即@sum）似乎不适用于 CoreData 惰性获取集。我所做的任何尝试都会使我犯错误，例如：

```
[<_NSFaultingMutableSet 0x101922270> addObserver:forKeyPath:options:context:] is not supported. Key path: @sum.total 
```

幸运的是，您似乎可以使用 NSArrayController 来启用此集合运算符。我把我编码的版本[放在 github 上](https://github.com/ipmcc/SOExamples/tree/master/bindings/SOTotal)。我相信我已经涵盖了您试图在那里实现的所有基础。我有主/详细表视图和额外的文本字段，所有实时更新等。*********

# xpath - 我该如何匹配 in Capybara with xpath

> ID：14485703
> 
> 赞同：1
> 
> 时间：2013-01-23T17:27:56.750
> 
> 标签：xpath, svg, capybara

标题几乎说明了这一点。我似乎无法匹配这些标签。我也在在线 xpath 测试器中尝试过。

我看到提到命名空间，所以我希望在 svg:svg 中工作。还有更多使用命名空间的方法吗？我还缺少什么？

```
<div id="kw_demand"> 
  <h2>Kw Demand</h2>  
  <div class="chart">
    <svg width="540" height="145">
      <g transform="translate(40,10)">
        <g class="x axis" transform="translate(0,105)">
          <g style="opacity: 1;" transform="translate(0,0)"> 
```

# pthreads - 如何杀死所有子线程

> ID：14485708
> 
> 赞同：0
> 
> 时间：2013-01-23T17:28:12.453
> 
> 标签：pthreads

我有一个 C++ 程序并在其中使用 pthreads。在这个程序中，线程用于搜索数据中的模式。这是我在程序中的做法：

```
for (i=0; i<NUM_THREADS; i++) {
    rc = pthread_join(threads[i], NULL);
    assert(0==rc);
    if (args[i].islast == true || args[i].nextaddr != NULL){ //if the pattern is found
        for (j = i+1; j<NUM_THREADS;j++){
            rc = pthread_join(threads[j], NULL); //join the other threads that is not useful
            assert(0 == rc);
        }
        return args[i].nextaddr; //return the address obtained in the thread of interest
    }
} 
```

但是`for`加入无用线程的第二个循环是昂贵的（程序需要非常快，如果我能避免简单的“for”，这是一个了不起的成就）。

我想知道是否存在可以一次杀死所有子线程的命令。

Ps：我需要“加入”无用的线程。如果我不这样做，那么线程将无法回收，并且一段时间后我会达到线程的限制。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-21T16:36:38.810

您可以使用屏障，而不是使用 for 循环来连接各种线程。

```
pthread_barrier_t barrier; // the barrier object
pthread_t threads [NUM_THREADS]; // the thread childs.

// create the threads ...

// initialize the barrier like other pthread object.
pthread_barrier_init (&barrier, NULL, NUM_THREADS+1); 
```

请注意，第二个参数是障碍的属性。如果为 NULL，将设置默认属性。第三个参数是将被屏障同步的线程数。每个线程都将调用 pthread_barrier_wait 以等待也将调用相同函数的其他线程。当特定数量的线程在屏障中等待时，所有线程都将被解除阻塞。

我写了 NUM_THREADS+1，NUM_THREADS 是子线程的数量，并将其递增到与主线程一样的计数。

在“重要线程”中，您可以编写类似这样的内容来等待子线程。

```
/* do important stuff while child threads are executing ... */

/* wait for the childs (join) */
pthread_barrier_wait (&barrier); // main thread gets blocked by the barrier.
                               // untill a specific number of threads reaches the
                               // barrier as well

/* continue execution ... */ 
```

在子线程中，添加下一行代码...

```
void* child_thread_func (void* args)
{
    /* do something with the thread ... */

    /* syncronize with the barrier and exit */
    pthread_barrier_wait (&barrier);

    pthread_exit (some_data);
} 
```

通过这种方式，当孩子将被解除阻塞时，它会立即返回并加入主线程。

不要忘记释放与屏障相关的资源。（仅当任何线程不再使用屏障时）...

```
pthread_barrier_destroy (&barrier); 
```

# html - Fabric JS：如何转换 Fabric 图像

> ID：14485716
> 
> 赞同：3
> 
> 时间：2013-01-23T17:28:36.567
> 
> 标签：html, canvas, javascript, fabricjs

如何使用 Fabric JS 在画布内向左或向右倾斜和缩放 Fabric 图像？我需要它遵循显示器的显示方式，这样我就可以像在屏幕上一样粘贴它

![在此处输入图像描述](../Images/4fb2327e457543bd6a99e551ed279028.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-20T10:20:41.113

请通过[此](http://fabricjs.com/matrix-transformation/)链接。您可以将变换和倾斜设置为[Fiddle](http://jsfiddle.net/Rq7hk/26/)

```
var canvas = new fabric.Canvas('canvas');

fabric.Image.fromURL("https://www.google.co.in/images/srpr/logo11w.png", function(img) {
    img.set({transformMatrix: [1, .30, 0, 1, 0, 0],width:200,height:50,top:100,left:150});
    img.setCoords();
    canvas.add(img);

    canvas.renderAll();
  })
```

```
body {
    background-color: ivory;
    padding:30px;
}
canvas {
    border: 1px solid red;
}
```

```
<h3>FabricJS: using transformMatrix to skew-Y</h3>

<canvas id="canvas" width="300" height="300"></canvas>
```

# javascript - jQuery HTMLCollection，标签剥离

> ID：14485718
> 
> 赞同：2
> 
> 时间：2013-01-23T17:28:49.137
> 
> 标签：javascript, jquery, xml

我通过 AJAX 作为 XML 获取一些 POST 数据，并尝试使用 jQuery 将其加载到文本区域中，并且遇到了一些问题。

XML 看起来像这样（精简，仅显示问题元素）：

```
<Entry>
    <Title>A <i>Title</i> with italics.</Title>
    <Abstract>An abstract, which <i>also</i> may have italics</Abstract>
</Entry> 
```

我已经使用 将这个 XML 转换为一个 jQuery 对象，上面的 XML 字符串`$dom = $(xml)`在哪里。`xml`出于某种原因，jQuery 似乎`.text()`与 vs不一致`.html()`。我认为问题与 HTMLCollection （这是对象显示的日志记录）有关，但我不确定。

`$dom.find('Title').text();`按我的意愿工作，将标题变成“ `A <i>Title</i> with italics`。” 对摘要 ( ) 执行相同操作会完全`$dom.find('Abstract').text()`剥离`<i>`标签，从而产生“ `An abstract, which also may have italics`”。

令人沮丧的是，做事`.html()`也不一致！

```
$dom.find('Title').html();    #=> 'A &lt;Title&gt;, with italics'
$dom.find('Abstract').html()  #=> 'An abstract, which <i>also</i> may have...' 
```

关于问题是什么的任何想法？XML 是无类型的，但我认为这不会产生影响。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:54:46.710

正如您所说`html()`，不适用于 XML `<title>`，`.text()`因为它是一个已知的 DOM 元素，所以将标签重命名为其他内容，内部 HTML 将与`<abstract>`.

您可以将包含 HTML 的节点值包含在 CDATA 部分中并使用`parseXML()`;

```
var xml = "<Entry><Title><![CDATA[A <i>Title</i> with italics.]]></Title><Abstract><![CDATA[An abstract, which <i>also</i> may have italics]]></Abstract></Entry>";

$dom = $($.parseXML(xml));
alert( $dom.find('Title').text() );
alert( $dom.find('Abstract').text() ); 
```

# ruby-on-rails - 在布局中找不到要翻译的路径

> ID：14485720
> 
> 赞同：1
> 
> 时间：2013-01-23T17:28:54.070
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

所以这是我的结构的样子，请注意我要翻译“Home”：

![在此处输入图像描述](../Images/fec1b32cc6998b04e4dbf7c2be0b3192.png)

这是我为 .yml 文件创建的结构：

```
 es:

  layouts:
    _header:
      home:        "HomeTranslated" 
```

但它无法找到并翻译它。我做错什么了？如果我需要包含更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-23T18:19:42.447

试试下面的：

```
 es:
  layouts:
    header:
      home: "HomeTranslated"

<%= link_to t(layouts.header.home), root_path %> # you must give the full path 
```

也看看这个 railscasts：[http: //railscasts.com/episodes/138-i18n?view=asciicast](http://railscasts.com/episodes/138-i18n?view=asciicast)

我希望它有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T18:13:34.403

也许指定翻译会有所帮助，尝试使用`t('layouts._header.home')`而不是`t('home')`

# forms - 如果没有进行任何更改，如何停止 ajax 调用

> ID：14485722
> 
> 赞同：-1
> 
> 时间：2013-01-23T17:29:06.280
> 
> 标签：forms, jquery

想象一下第一次，数据不匹配并且 ajax 已经返回请求然后向表单发送错误消息，之后如果表单/输入没有更改，我如何停止 ajax 调用？

```
$("input[name=signup]").click(function(event) {

if ($(this).attr('type') == "submit" && $(this).attr('name') == "signup") {

        formValidate = function() {
            $.ajax({
                url:   "/ajax/req-signup.aspx",
                type: "post",
                dataType: "json",
                data: { ... },
                success: function(response) { ... }
            });
        }
        formValidate();
    }
event.preventDefault();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:34:03.180

添加一个全局变量

```
var allowAjax = true; 
```

验证失败时将其设置为 false：

```
allowAjax = false; 
```

更改表单中的内容时设置为 true

```
$("input").change(function () {
    allowAjax = true;
}); 
```

并在进行 ajax 调用时检查其状态：

```
if ($(this).attr('type') == "submit" 
   && $(this).attr('name') == "signup" 
   && allowAjax ) { ... } 
```

或者，您可以在验证失败时禁用提交按钮，并在更改时启用它。

```
$(":submit").attr('disabled', 'disabled'); 
```

如果您不介意使用插件，请查看[jQuery 禁用小部件](http://www.dougestep.com/dme/jquery-disabler-widget)，您可能会发现它更易于使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T18:19:46.930

您可以仅在某些更改时绑定单击事件 - 然后在触发单击事件时取消绑定它（从而消除对全局可用变量的需要）：

```
/* whenever an input changes on your form, bind click event */
$("SELECT INPUTS HERE").change(function (){
    /* unbind first to ensure the click event won't be registered/triggered multiple times */
    $("input[name=signup]").unbind("click").click(doSignup);
});

function doSignup(e){
    if ($(this).attr("type") == "submit" && $(this).attr("name") == "signup"){
        /* a successful click has happened - unbind click */
        $("input[name=signup]").unbind("click");

        /* do ajax call */
        $.ajax({
            url:   "/ajax/req-signup.aspx",
            type: "post",
            dataType: "json",
            data: { ... },
            success: function(response) { ... }
        });
    };

    e.preventDefault();
}; 
```

从用户体验的角度来看，您可以通过几种方式来增强它。

1.  每当您取消绑定单击或以其他方式向用户指示该按钮当前未处于可单击状态时，也要“禁用”该按钮。
2.  不要在点击时取消绑定，而是考虑有条件地取消绑定。就像，在成功时解除绑定，但不要在错误时解除绑定，以便他们可以重试。此外，如果您正在进行输入验证，可能会在用户输入无效时解除绑定。等等。

希望有帮助！

# ms-access - Access 2007 - 在不使用交叉表查询的情况下“旋转”数据

> ID：14485726
> 
> 赞同：0
> 
> 时间：2013-01-23T17:29:15.393
> 
> 标签：ms-access, dynamic, join, crosstab

我有一个返回这样的数据的查询：

```
Store    Product    CasesPerStore
Bob's    Original       2
Bob's    Super          1
Tom's    Original       5
Pete's   Original       9
Pete's   Super          2 
```

我想将它加入到 Store 的另一个查询中，最终得到以下结果：

```
Other query headings....       Store    Original CasesPerStore    Super CasesPerStore
Other query data........       Bob's             2                        1
Other query data........       Tom's             5
Other query data........       Pete's            9                        2 
```

我可以使用交叉表查询对原始数据执行此操作，但是我无法在连接中引用新的交叉表标题（例如 [Original CasesPerStore] 和 [Super CasesPerStore]），可能是因为它们是动态的，即标题可能会改变取决于当时数据中包含哪些产品。

那么我怎样才能加入这个“旋转”的数据呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T23:16:34.910

如果您事先知道有多少产品，*并且它们是永久固定*的，那么这个简单的解决方案可能就足够了。通过使用`Iif`语句，您可以绕过数据的旋转，但它是硬编码的 SQL。

```
SELECT tbl.Store,
   SUM(Iif([Product] = "Original", [CasesPerStore], 0)) AS [Original CasesPerStore],
   SUM(Iif([Product] = "Original", 0, [CasesPerStore])) AS [Super CasesperStore]
FROM   tbl
GROUP  BY tbl.Store 
```

# java - 如何模拟一个超级方法（带返回）

> ID：14485731
> 
> 赞同：2
> 
> 时间：2013-01-23T17:29:41.037
> 
> 标签：java, junit, mockito, easymock, jmockit

是否可以模拟超类的方法？（不被覆盖）

```
public class FooBarTest {

    @Test
    public void test() {
        Bar bar = Mockito.spy(new Bar());
        Mockito.doReturn("Mock!").when((Foo) bar).test();

        String actual = bar.test(); // returns only "Mock!"
        assertEquals("Mock! Bar!", actual);
    }

    public static class Foo {
        public String test(){
            return "Foo!";
        }
    }

    public static class Bar extends Foo {
        @Override
        public String test(){
            return super.test()+" Bar!";
        }
    }
} 
```

Off：如何在此处突出显示代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T11:10:41.137

这是一种使用 JMockit 模拟 API 的解决方案：

```
public class FooBarTest
{
    @Test
    public void test()
    {
        final Bar bar = new Bar();
        new NonStrictExpectations(Foo.class) {{ bar.test(); result = "Mock!"; }};

        String actual = bar.test();
        assertEquals("Mock! Bar!", actual);
    }

    public static class Foo {
        public String test() { return "Foo!"; }
    }

    public static class Bar extends Foo {
        @Override
        public String test() { return super.test() + " Bar!"; }
    }
} 
```

# java - 在 JScrollPane 内拖动 JTree 节点时如何加快滚动速度

> ID：14485732
> 
> 赞同：5
> 
> 时间：2013-01-23T17:29:41.550
> 
> 标签：java, swing, drag-and-drop, jscrollpane, jtree

我在[JScrollPane中有一个](http://docs.oracle.com/javase/6/docs/api/javax/swing/JScrollPane.html)[JTree](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTree.html)。它相当长，因此将节点从树的顶部拖到底部需要一段时间。拖动节点时会滚动，但速度不如使用鼠标滚轮滚动的快。[按照此处](https://stackoverflow.com/questions/5583495/how-do-i-speed-up-the-scroll-speed-in-a-jscrollpane-when-using-the-mouse-wheel)所选答案中的建议实施[setUnitIncrement](http://docs.oracle.com/javase/6/docs/api/javax/swing/JScrollBar.html#setUnitIncrement%28int%29)可使鼠标滚轮滚动速度更快，但不会改变拖动节点的速度。实现[setBlockIncrement](http://docs.oracle.com/javase/6/docs/api/javax/swing/JScrollBar.html#setBlockIncrement%28int%29)时也是如此。拖动节点时的滚动速度与我按住向上或向下箭头并以这种方式遍历的速度大致相同。`JTree``JScrollPane``JTree`

**如何加快拖动节点的速度？**

**更新 1：**

这是应要求提供的 SSCCE。[我从这里](http://www.coderanch.com/t/346509/GUI/java/JTree-drag-drop-tree-Java)撕掉了大部分代码，因为它很好地说明了我遇到的问题。只需将一个节点拖到滚动窗格中不可见的树的一部分，您就会看到滚动有多慢。这就是我想要加速的。

```
package example;

import java.awt.datatransfer.*;
import java.util.*;
import javax.swing.*;
import javax.swing.tree.*;

public class Example {

    private JScrollPane getContent() {
        ArrayList<String> arrayList = new ArrayList<String>();
        for( int i = 0; i < 3000; i++ ) {
            arrayList.add( String.format( "Node %d", i ) );
        }
        DefaultMutableTreeNode root = new DefaultMutableTreeNode( "Root" );
        for( String s : arrayList ) {
            root.add( new DefaultMutableTreeNode( s ) );
        }
        JTree tree = new JTree( root );
        tree.setDragEnabled( true );
        tree.setDropMode( DropMode.ON_OR_INSERT );
        tree.setTransferHandler( new TreeTransferHandler() );
        tree.getSelectionModel().setSelectionMode( TreeSelectionModel.CONTIGUOUS_TREE_SELECTION );
        expandTree( tree );
        return new JScrollPane( tree );
    }

    private void expandTree( JTree tree ) {
        DefaultMutableTreeNode root = (DefaultMutableTreeNode)tree.getModel().getRoot();
        Enumeration e = root.breadthFirstEnumeration();
        while( e.hasMoreElements() ) {
            DefaultMutableTreeNode node = (DefaultMutableTreeNode)e.nextElement();
            if( node.isLeaf() ) {
                continue;
            }
            int row = tree.getRowForPath( new TreePath( node.getPath() ) );
            tree.expandRow( row );
        }
    }

    public static void main( String[] args ) {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
        f.add( new Example().getContent() );
        f.setSize( 400, 400 );
        f.setLocation( 200, 200 );
        f.setVisible( true );
    }
}

class TreeTransferHandler extends TransferHandler {

    DataFlavor nodesFlavor;
    DataFlavor[] flavors = new DataFlavor[1];
    DefaultMutableTreeNode[] nodesToRemove;

    public TreeTransferHandler() {
        try {
            String mimeType = DataFlavor.javaJVMLocalObjectMimeType
                    + ";class=\""
                    + javax.swing.tree.DefaultMutableTreeNode[].class.getName()
                    + "\"";
            nodesFlavor = new DataFlavor( mimeType );
            flavors[0] = nodesFlavor;
        } catch( ClassNotFoundException e ) {
            System.out.println( "ClassNotFound: " + e.getMessage() );
        }
    }

    public boolean canImport( TransferHandler.TransferSupport support ) {
        if( !support.isDrop() ) {
            return false;
        }
        support.setShowDropLocation( true );
        if( !support.isDataFlavorSupported( nodesFlavor ) ) {
            return false;
        }
        // Do not allow a drop on the drag source selections.
        JTree.DropLocation dl = (JTree.DropLocation)support.getDropLocation();
        JTree tree = (JTree)support.getComponent();
        int dropRow = tree.getRowForPath( dl.getPath() );
        int[] selRows = tree.getSelectionRows();
        for( int i = 0; i < selRows.length; i++ ) {
            if( selRows[i] == dropRow ) {
                return false;
            }
        }
        // Do not allow MOVE-action drops if a non-leaf node is
        // selected unless all of its children are also selected.
        int action = support.getDropAction();
        if( action == MOVE ) {
            return haveCompleteNode( tree );
        }
        // Do not allow a non-leaf node to be copied to a level
        // which is less than its source level.
        TreePath dest = dl.getPath();
        DefaultMutableTreeNode target = (DefaultMutableTreeNode)dest.getLastPathComponent();
        TreePath path = tree.getPathForRow( selRows[0] );
        DefaultMutableTreeNode firstNode = (DefaultMutableTreeNode)path.getLastPathComponent();
        if( firstNode.getChildCount() > 0 && target.getLevel() < firstNode.getLevel() ) {
            return false;
        }
        return true;
    }

    private boolean haveCompleteNode( JTree tree ) {
        int[] selRows = tree.getSelectionRows();
        TreePath path = tree.getPathForRow( selRows[0] );
        DefaultMutableTreeNode first = (DefaultMutableTreeNode)path.getLastPathComponent();
        int childCount = first.getChildCount();
        // first has children and no children are selected.
        if( childCount > 0 && selRows.length == 1 ) {
            return false;
        }
        // first may have children.
        for( int i = 1; i < selRows.length; i++ ) {
            path = tree.getPathForRow( selRows[i] );
            DefaultMutableTreeNode next = (DefaultMutableTreeNode)path.getLastPathComponent();
            if( first.isNodeChild( next ) ) {
                // Found a child of first.
                if( childCount > selRows.length - 1 ) {
                    // Not all children of first are selected.
                    return false;
                }
            }
        }
        return true;
    }

    protected Transferable createTransferable( JComponent c ) {
        JTree tree = (JTree)c;
        TreePath[] paths = tree.getSelectionPaths();
        if( paths != null ) {
            // Make up a node array of copies for transfer and
            // another for/of the nodes that will be removed in
            // exportDone after a successful drop.
            List<DefaultMutableTreeNode> copies = new ArrayList<DefaultMutableTreeNode>();
            List<DefaultMutableTreeNode> toRemove = new ArrayList<DefaultMutableTreeNode>();
            DefaultMutableTreeNode node = (DefaultMutableTreeNode)paths[0].getLastPathComponent();
            DefaultMutableTreeNode copy = copy( node );
            copies.add( copy );
            toRemove.add( node );
            for( int i = 1; i < paths.length; i++ ) {
                DefaultMutableTreeNode next = (DefaultMutableTreeNode)paths[i].getLastPathComponent();
                // Do not allow higher level nodes to be added to list.
                if( next.getLevel() < node.getLevel() ) {
                    break;
                } else if( next.getLevel() > node.getLevel() ) {  // child node
                    copy.add( copy( next ) );
                    // node already contains child
                } else {                                        // sibling
                    copies.add( copy( next ) );
                    toRemove.add( next );
                }
            }
            DefaultMutableTreeNode[] nodes = copies.toArray( new DefaultMutableTreeNode[copies.size()] );
            nodesToRemove = toRemove.toArray( new DefaultMutableTreeNode[toRemove.size()] );
            return new NodesTransferable( nodes );
        }
        return null;
    }

    /**
     * Defensive copy used in createTransferable.
     */
    private DefaultMutableTreeNode copy( TreeNode node ) {
        return new DefaultMutableTreeNode( node );
    }

    protected void exportDone( JComponent source, Transferable data, int action ) {
        if( ( action & MOVE ) == MOVE ) {
            JTree tree = (JTree)source;
            DefaultTreeModel model = (DefaultTreeModel)tree.getModel();
            // Remove nodes saved in nodesToRemove in createTransferable.
            for( int i = 0; i < nodesToRemove.length; i++ ) {
                model.removeNodeFromParent( nodesToRemove[i] );
            }
        }
    }

    public int getSourceActions( JComponent c ) {
        return COPY_OR_MOVE;
    }

    public boolean importData( TransferHandler.TransferSupport support ) {
        if( !canImport( support ) ) {
            return false;
        }
        // Extract transfer data.
        DefaultMutableTreeNode[] nodes = null;
        try {
            Transferable t = support.getTransferable();
            nodes = (DefaultMutableTreeNode[])t.getTransferData( nodesFlavor );
        } catch( UnsupportedFlavorException ufe ) {
            System.out.println( "UnsupportedFlavor: " + ufe.getMessage() );
        } catch( java.io.IOException ioe ) {
            System.out.println( "I/O error: " + ioe.getMessage() );
        }
        // Get drop location info.
        JTree.DropLocation dl = (JTree.DropLocation)support.getDropLocation();
        int childIndex = dl.getChildIndex();
        TreePath dest = dl.getPath();
        DefaultMutableTreeNode parent = (DefaultMutableTreeNode)dest.getLastPathComponent();
        JTree tree = (JTree)support.getComponent();
        DefaultTreeModel model = (DefaultTreeModel)tree.getModel();
        // Configure for drop mode.
        int index = childIndex;    // DropMode.INSERT
        if( childIndex == -1 ) {     // DropMode.ON
            index = parent.getChildCount();
        }
        // Add data to model.
        for( int i = 0; i < nodes.length; i++ ) {
            model.insertNodeInto( nodes[i], parent, index++ );
        }
        return true;
    }

    public String toString() {
        return getClass().getName();
    }

    public class NodesTransferable implements Transferable {

        DefaultMutableTreeNode[] nodes;

        public NodesTransferable( DefaultMutableTreeNode[] nodes ) {
            this.nodes = nodes;
        }

        public Object getTransferData( DataFlavor flavor )
                throws UnsupportedFlavorException {
            if( !isDataFlavorSupported( flavor ) ) {
                throw new UnsupportedFlavorException( flavor );
            }
            return nodes;
        }

        public DataFlavor[] getTransferDataFlavors() {
            return flavors;
        }

        public boolean isDataFlavorSupported( DataFlavor flavor ) {
            return nodesFlavor.equals( flavor );
        }
    }
} 
```

**成功！**

我终于能够在拖动时加快滚动速度。事实上，我还能够根据光标与树的顶部或底部的接近程度来使滚动速度可变。最终比我做的要简单得多。甚至不需要听众。只需比较这两个代码示例即可查看我添加的内容。

```
package example;

import java.awt.Point;
import java.awt.Rectangle;
import java.awt.datatransfer.*;
import java.util.*;
import javax.swing.*;
import javax.swing.tree.*;

public class Example {

    private JScrollPane getContent() {
        ArrayList<String> arrayList = new ArrayList<String>();
        for( int i = 0; i < 3000; i++ ) {
            arrayList.add( String.format( "Node %d", i ) );
        }
        DefaultMutableTreeNode root = new DefaultMutableTreeNode( "Root" );
        for( String s : arrayList ) {
            root.add( new DefaultMutableTreeNode( s ) );
        }
        JTree tree = new JTree( root );
        tree.setDragEnabled( true );
        tree.setDropMode( DropMode.ON_OR_INSERT );
        tree.setTransferHandler( new TreeTransferHandler() );
        tree.getSelectionModel().setSelectionMode( TreeSelectionModel.CONTIGUOUS_TREE_SELECTION );
        expandTree( tree );
        return new JScrollPane( tree );
    }

    private void expandTree( JTree tree ) {
        DefaultMutableTreeNode root = (DefaultMutableTreeNode)tree.getModel().getRoot();
        Enumeration e = root.breadthFirstEnumeration();
        while( e.hasMoreElements() ) {
            DefaultMutableTreeNode node = (DefaultMutableTreeNode)e.nextElement();
            if( node.isLeaf() ) {
                continue;
            }
            int row = tree.getRowForPath( new TreePath( node.getPath() ) );
            tree.expandRow( row );
        }
    }

    public static void main( String[] args ) {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
        f.add( new Example().getContent() );
        f.setSize( 400, 400 );
        f.setLocation( 200, 200 );
        f.setVisible( true );
    }
}

class TreeTransferHandler extends TransferHandler {

    DataFlavor nodesFlavor;
    DataFlavor[] flavors = new DataFlavor[1];
    DefaultMutableTreeNode[] nodesToRemove;

    public TreeTransferHandler() {
        try {
            String mimeType = DataFlavor.javaJVMLocalObjectMimeType
                    + ";class=\""
                    + javax.swing.tree.DefaultMutableTreeNode[].class.getName()
                    + "\"";
            nodesFlavor = new DataFlavor( mimeType );
            flavors[0] = nodesFlavor;
        } catch( ClassNotFoundException e ) {
            System.out.println( "ClassNotFound: " + e.getMessage() );
        }
    }

    public boolean canImport( TransferHandler.TransferSupport support ) {
        if( !support.isDrop() ) {
            return false;
        }

        boolean isScrolling = false;
        JTree tree = (JTree)support.getComponent();
        JViewport vp = (JViewport)tree.getParent();
        Point vpMousePosition = vp.getMousePosition();
        Rectangle treeVisibleRectangle = tree.getVisibleRect();

        // Don't attempt scroll if mouse isn't over tree
        if( vpMousePosition != null ) {
            Integer newY = null;

            // Make sure we aren't already scrolled all the way down
            if( tree.getHeight() - treeVisibleRectangle.y != vp.getHeight() ) {
                /*
                 * Get Y coordinate for scrolling down
                 */
                if( vp.getHeight() - vpMousePosition.y < 10 ) {
                    newY = treeVisibleRectangle.y + 500;
                } else if( vp.getHeight() - vpMousePosition.y < 20 ) {
                    newY = treeVisibleRectangle.y + 400;
                } else if( vp.getHeight() - vpMousePosition.y < 30 ) {
                    newY = treeVisibleRectangle.y + 300;
                } else if( vp.getHeight() - vpMousePosition.y < 40 ) {
                    newY = treeVisibleRectangle.y + 200;
                } else if( vp.getHeight() - vpMousePosition.y < 50 ) {
                    newY = treeVisibleRectangle.y + 100;
                } else if( vp.getHeight() - vpMousePosition.y < 60 ) {
                    newY = treeVisibleRectangle.y + 50;
                } else if( vp.getHeight() - vpMousePosition.y < 70 ) {
                    newY = treeVisibleRectangle.y + 25;
                } else if( vp.getHeight() - vpMousePosition.y < 80 ) {
                    newY = treeVisibleRectangle.y + 10;
                }
            }

            // Make sure we aren't already scrolled all the way up
            if( newY == null && treeVisibleRectangle.y != 0 ) {
                /*
                 * Get Y coordinate for scrolling up
                 */
                if( 10 > vpMousePosition.y ) {
                    newY = treeVisibleRectangle.y - 500;
                } else if( 20 > vpMousePosition.y ) {
                    newY = treeVisibleRectangle.y - 400;
                } else if( 30 > vpMousePosition.y ) {
                    newY = treeVisibleRectangle.y - 300;
                } else if( 40 > vpMousePosition.y ) {
                    newY = treeVisibleRectangle.y - 200;
                } else if( 50 > vpMousePosition.y ) {
                    newY = treeVisibleRectangle.y - 100;
                } else if( 60 > vpMousePosition.y ) {
                    newY = treeVisibleRectangle.y - 50;
                } else if( 70 > vpMousePosition.y ) {
                    newY = treeVisibleRectangle.y - 25;
                } else if( 80 > vpMousePosition.y ) {
                    newY = treeVisibleRectangle.y - 10;
                }
            }

            // Do the scroll
            if( newY != null  ) {
                Rectangle treeNewVisibleRectangle = new Rectangle( treeVisibleRectangle.x, newY, treeVisibleRectangle.width, treeVisibleRectangle.height );
                tree.scrollRectToVisible( treeNewVisibleRectangle );
                isScrolling = true;
            }
        }

        if( isScrolling ) {
            return false;
        }

        support.setShowDropLocation( true );
        if( !support.isDataFlavorSupported( nodesFlavor ) ) {
            return false;
        }
        // Do not allow a drop on the drag source selections.
        JTree.DropLocation dl = (JTree.DropLocation)support.getDropLocation();
        int dropRow = tree.getRowForPath( dl.getPath() );
        int[] selRows = tree.getSelectionRows();
        for( int i = 0; i < selRows.length; i++ ) {
            if( selRows[i] == dropRow ) {
                return false;
            }
        }
        // Do not allow MOVE-action drops if a non-leaf node is
        // selected unless all of its children are also selected.
        int action = support.getDropAction();
        if( action == MOVE ) {
            return haveCompleteNode( tree );
        }
        // Do not allow a non-leaf node to be copied to a level
        // which is less than its source level.
        TreePath dest = dl.getPath();
        DefaultMutableTreeNode target = (DefaultMutableTreeNode)dest.getLastPathComponent();
        TreePath path = tree.getPathForRow( selRows[0] );
        DefaultMutableTreeNode firstNode = (DefaultMutableTreeNode)path.getLastPathComponent();
        if( firstNode.getChildCount() > 0 && target.getLevel() < firstNode.getLevel() ) {
            return false;
        }
        return true;
    }

    private boolean haveCompleteNode( JTree tree ) {
        int[] selRows = tree.getSelectionRows();
        TreePath path = tree.getPathForRow( selRows[0] );
        DefaultMutableTreeNode first = (DefaultMutableTreeNode)path.getLastPathComponent();
        int childCount = first.getChildCount();
        // first has children and no children are selected.
        if( childCount > 0 && selRows.length == 1 ) {
            return false;
        }
        // first may have children.
        for( int i = 1; i < selRows.length; i++ ) {
            path = tree.getPathForRow( selRows[i] );
            DefaultMutableTreeNode next = (DefaultMutableTreeNode)path.getLastPathComponent();
            if( first.isNodeChild( next ) ) {
                // Found a child of first.
                if( childCount > selRows.length - 1 ) {
                    // Not all children of first are selected.
                    return false;
                }
            }
        }
        return true;
    }

    protected Transferable createTransferable( JComponent c ) {
        JTree tree = (JTree)c;
        TreePath[] paths = tree.getSelectionPaths();
        if( paths != null ) {
            // Make up a node array of copies for transfer and
            // another for/of the nodes that will be removed in
            // exportDone after a successful drop.
            List<DefaultMutableTreeNode> copies = new ArrayList<DefaultMutableTreeNode>();
            List<DefaultMutableTreeNode> toRemove = new ArrayList<DefaultMutableTreeNode>();
            DefaultMutableTreeNode node = (DefaultMutableTreeNode)paths[0].getLastPathComponent();
            DefaultMutableTreeNode copy = copy( node );
            copies.add( copy );
            toRemove.add( node );
            for( int i = 1; i < paths.length; i++ ) {
                DefaultMutableTreeNode next = (DefaultMutableTreeNode)paths[i].getLastPathComponent();
                // Do not allow higher level nodes to be added to list.
                if( next.getLevel() < node.getLevel() ) {
                    break;
                } else if( next.getLevel() > node.getLevel() ) {  // child node
                    copy.add( copy( next ) );
                    // node already contains child
                } else {                                        // sibling
                    copies.add( copy( next ) );
                    toRemove.add( next );
                }
            }
            DefaultMutableTreeNode[] nodes = copies.toArray( new DefaultMutableTreeNode[copies.size()] );
            nodesToRemove = toRemove.toArray( new DefaultMutableTreeNode[toRemove.size()] );
            return new NodesTransferable( nodes );
        }
        return null;
    }

    /**
     * Defensive copy used in createTransferable.
     */
    private DefaultMutableTreeNode copy( TreeNode node ) {
        return new DefaultMutableTreeNode( node );
    }

    protected void exportDone( JComponent source, Transferable data, int action ) {
        if( ( action & MOVE ) == MOVE ) {
            JTree tree = (JTree)source;
            DefaultTreeModel model = (DefaultTreeModel)tree.getModel();
            // Remove nodes saved in nodesToRemove in createTransferable.
            for( int i = 0; i < nodesToRemove.length; i++ ) {
                model.removeNodeFromParent( nodesToRemove[i] );
            }
        }
    }

    public int getSourceActions( JComponent c ) {
        return COPY_OR_MOVE;
    }

    public boolean importData( TransferHandler.TransferSupport support ) {
        if( !canImport( support ) ) {
            return false;
        }
        // Extract transfer data.
        DefaultMutableTreeNode[] nodes = null;
        try {
            Transferable t = support.getTransferable();
            nodes = (DefaultMutableTreeNode[])t.getTransferData( nodesFlavor );
        } catch( UnsupportedFlavorException ufe ) {
            System.out.println( "UnsupportedFlavor: " + ufe.getMessage() );
        } catch( java.io.IOException ioe ) {
            System.out.println( "I/O error: " + ioe.getMessage() );
        }
        // Get drop location info.
        JTree.DropLocation dl = (JTree.DropLocation)support.getDropLocation();
        int childIndex = dl.getChildIndex();
        TreePath dest = dl.getPath();
        DefaultMutableTreeNode parent = (DefaultMutableTreeNode)dest.getLastPathComponent();
        JTree tree = (JTree)support.getComponent();
        DefaultTreeModel model = (DefaultTreeModel)tree.getModel();
        // Configure for drop mode.
        int index = childIndex;    // DropMode.INSERT
        if( childIndex == -1 ) {     // DropMode.ON
            index = parent.getChildCount();
        }
        // Add data to model.
        for( int i = 0; i < nodes.length; i++ ) {
            model.insertNodeInto( nodes[i], parent, index++ );
        }
        return true;
    }

    public String toString() {
        return getClass().getName();
    }

    public class NodesTransferable implements Transferable {

        DefaultMutableTreeNode[] nodes;

        public NodesTransferable( DefaultMutableTreeNode[] nodes ) {
            this.nodes = nodes;
        }

        public Object getTransferData( DataFlavor flavor )
                throws UnsupportedFlavorException {
            if( !isDataFlavorSupported( flavor ) ) {
                throw new UnsupportedFlavorException( flavor );
            }
            return nodes;
        }

        public DataFlavor[] getTransferDataFlavors() {
            return flavors;
        }

        public boolean isDataFlavorSupported( DataFlavor flavor ) {
            return nodesFlavor.equals( flavor );
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:35:01.310

当 SDK 不能很好地工作时，我开始使用我的骇人听闻的方法，在这种情况下，它是一种：听鼠标。当鼠标向下移动 10 像素时，会产生一个事件，因为鼠标在同一方向上移动了 100 像素。在 Windows 中，在 Excel 中，如果您在任务栏下拖动鼠标，它会向上滚动。这里应该有类似的东西，值得一试。

# php - php从数组中读取值

> ID：14485734
> 
> 赞同：0
> 
> 时间：2013-01-23T17:29:43.320
> 
> 标签：php, arrays, variables, object

我有一个数组，我正在尝试访问消息的值。我认为它让我失望，因为它是对象中的对象数组。以下是我尝试过的和数据结构。

代码：

```
foreach ($result as $value) {

         echo "$value[0]->message"; 
} 
```

大批：

```
stdClass Object
(
    [results] => Array
        (
            [0] => stdClass Object
                (
                    [message] => 12345
                    [unit] => test
                    [createdAt] => 2013-01-21T14:57:26.613Z
                    [updatedAt] => 2013-01-21T14:57:26.613Z
                    [objectId] => 0uiYuJcRYY
                )

        )

) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T17:31:11.830

删除引号

```
foreach ($result as $value) {

         echo $value[0]->message; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:21:00.920

有两个可能的错误。

1 - 变量可能是 $results 而不是 $result 2 - 如果您使用 foreach，则不需要 [0]，因为现在这是变量 $value。

尝试

```
foreach ($results as $value) {
    echo $value->message; 
} 
```

# entity-framework - 删除有相关数据如何抛出异常

> ID：14485736
> 
> 赞同：0
> 
> 时间：2013-01-23T17:29:51.760
> 
> 标签：entity-framework

我有这个对象：

```
public class Profile
{
     public int Id {get;set;}
     public List<User> Users {get;set;}
} 
```

我有一个删除个人资料的页面..所以如果没有相关用户，我想删除个人资料..

我试过这个：

```
var profile = _db.Profile
.Include(p => p.Users)
.SingleOrDefault(p => p.Id == id);

_db.Profile.Remove(profile);
_db.SaveChanges(); 
```

但这会自动删除所有相关的用户（我不明白为什么，因为我没有为此设置任何特殊配置）。

我怎样才能避免这种情况？当我尝试 SaveChanges 时如何获得异常？

我很想避免`Users.Count`直接在我的代码中检查来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:46:49.147

你可以使用扩展方法

```
.WillCascadeOnDelete(false); 
```

对于特定的关系，

或禁用所有删除级联`OneToManyCascadeDeleteConvention`

```
protected override void OnModelCreating(System.Data.Entity.ModelConfiguration.ModelBuilder modelBuilder)

    {
        modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>();
   } 
```

[这](http://geekswithblogs.net/danemorgridge/archive/2010/12/17/ef4-cpt5-code-first-remove-cascading-deletes.aspx)将向您显示更多详细信息（EF 4 CTP5，但应该很有价值）

# css - 如何添加 jquery-ui 对话框按钮的 like 属性

> ID：14485741
> 
> 赞同：2
> 
> 时间：2013-01-23T17:30:05.280
> 
> 标签：css, jquery-ui, html, jquery-ui-dialog

jquery-ui 的对话框中是否有任何属性可以提供类似于 div 的标题属性的行为。（在悬停时显示标题名称）？

下面是生成的确认对话框的**确定**​​按钮的 html。我希望将 div 的“标题”属性应用于“确定”和“取消”按钮

```
<button type="button" class="ui-button 
        ui-widget 
        ui-state-default 
        ui-corner-all 
        ui-button-text-only"   role="button" aria-disabled="false">
     <span class="ui-button-text">Ok</span> </button> 
```

***编辑：*** 这是我用于对话框的一些属性

```
 dialog({

        height:110,
        widht:460,
        title:"This is dialog Title",
        modal: true,

        buttons: {
        "Ok": function() {  
        $( this ).dialog( 'destroy');
        },
        Cancel: function() {
            $( this ).dialog( 'destroy');
        }
        }, 
```

![在此处输入图像描述](../Images/357c9704d321b0a5f7f07e4a127304a2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:31:52.970

属性**标题**是您正在寻找的。 [http://www.quackit.com/html/tags/html_button_tag.cfm](http://www.quackit.com/html/tags/html_button_tag.cfm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:53:56.340

将 title 属性放在要应用对话框的 HTML 标记中。

```
<div title="I show on hover!">...</div>
...
$('div').dialog(...); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:54:43.770

我认为没有任何选项可以为 jquery 对话框的按钮应用标题属性。这是我现在使用的解决方案。

```
open: function(event, ui) {
      //  In dialog open
        $('.ui-dialog-buttonset button:first').attr('title','Ok');
        $('.ui-dialog-buttonset button:last').attr('title','Cancel');
    } 
```

# c# - 如何根据至少有一个条目与字符串数组中的一行匹配的字段来限制 linq 查询中的行？

> ID：14485760
> 
> 赞同：0
> 
> 时间：2013-01-23T17:30:58.150
> 
> 标签：c#, linq

我有以下我一直在处理的代码：

```
var menuItems = _contentRepository.GetPk("01" + pk + "000")
    .OrderBy(m => m.Order)
    .Select(m => new Menu.Item
    {
        PartitionKey = m.PartitionKey,
        RowKey = m.RowKey,
        Order = m.Order,
        Title = m.Title,
        Type = m.Type,
        Link = m.Link,
        TextLength = m.TextLength
    }); 
```

返回 .GetPk 的字段之一是名为 Roles 的字段。这是一个字符串字段，其内容显示可以访问菜单的每个项目的角色。字段中的数据如下所示：

```
All 
All,Admin 
All,Admin, Super
Admin
Admin, Super 
```

我有一个字符串 [] 角​​色，其中填充了用户拥有的角色。如果用户有一个角色，则字符串数组中有一项，如果用户有两个角色，则有两项。如果用户没有角色，则数组为空。

如果 string[] 角色中的条目与我的角色字段中的单词之一匹配，我怎样才能使我的选择只返回一个值？

到目前为止，我一直在做一些研究，我发现以下内容几乎可以满足我的需要。但是我怎样才能把它放到我上面的 Linq 中呢？

```
String[] roles = Roles.GetRolesForUser();
var links = from item in menus
    where item.Roles.Split(new String[] { "," }, StringSplitOptions.RemoveEmptyEntries)
    .Any(x => roles.Contains(x) || x == "All")
    select item; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:33:05.747

只需在 Where 子句中包含该条件，然后将结果选择到您需要的表单中。

```
var menuItems = _contentRepository.GetPk("01" + pk + "000")
.OrderBy(m => m.Order)
.Where(m => m.Roles.Split(",").Any(x => roles.Contains(x) || x == "All"))
.Select(m => new Menu.Item
{
    PartitionKey = m.PartitionKey,
    RowKey = m.RowKey,
    Order = m.Order,
    Title = m.Title,
    Type = m.Type,
    Link = m.Link,
    TextLength = m.TextLength
}); 
```

# c# - 查找空字符串并在找到时返回空格的函数

> ID：14485776
> 
> 赞同：0
> 
> 时间：2013-01-23T17:31:52.197
> 
> 标签：c#, xslt

我有一个 XSLT 文件，里面有一个函数，如果值为 NULL，则需要返回一个空格。但是，它特别抱怨下面的行是`if (string A == "")`. 有人知道那有什么问题吗？

```
<![CDATA[
    public string TermDate(string A)
    {
        if (string A == "")
            return " ";
        else
            return A;                                                 
    }
]]>

(...)

cs:TermDate(TerminationDate), 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T17:33:27.650

不要在条件部分使用`string`关键字。`if`

改变

```
if (string A=="") 
```

至

```
if (A=="") 
```

[**您可以在此处**](http://msdn.microsoft.com/en-us/library/vstudio/5011f09h.aspx)阅读有关 if 语法的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:39:05.080

[`String.IsNullOrEmpty`](http://msdn.microsoft.com/en-us/library/vstudio/system.string.isnullorempty%28v=vs.100%29.aspx)除了 normal 之外，还有更多选项（使用） `if(a)...`：

`? :`-[条件运算符](http://msdn.microsoft.com/en-us/library/ty67wk28%28v=vs.100%29.aspx)：

```
return String.IsNullOrEmpty(a) ? " " : a; 
```

`??`-[空合并运算符](http://msdn.microsoft.com/en-us/library/ms173224%28v=vs.100%29.aspx)：

```
return a ?? " "; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-23T17:36:26.377

```
if (String.IsNullOrEmpty(A)) return " ";
else return A; 
```

# c++ - 删除存储在数组中的特定类对象

> ID：14485780
> 
> 赞同：2
> 
> 时间：2013-01-23T17:31:58.783
> 
> 标签：c++, arrays, class, object

我的代码有问题，我想知道是否有人可以看看，我创建了一个函数来从数组中删除特定元素。我使用线性搜索来查找元素，然后用后面的元素覆盖我想要删除的元素，因为我还没有找到专门删除元素的方法。我的问题是代码并没有真正起作用，因为元素没有被覆盖，还有一种方法可以在元素被覆盖后在数组中留下一个空格。

下面是我的代码：

```
void deleteinfo()
{
    string search ;
    int found ;

    cout << "\n Delete A Player's Information \n\n" ;
    cout << "Please Enter The Player's Last Name : " ;
    cin >> search ;

    found=linsearch(search);

    if (found==-1)
    {
        cout << "\n There is no player called " << search ;
    }
    else
    {
        player[found].getFirstName() = player[found + 1].getFirstName() ;
        player[found].getLastName() = player[found + 1].getLastName() ;
        player[found].getAge() == player[found + 1].getAge() ;
        player[found].getCurrentTeam() = player[found + 1].getCurrentTeam() ;
        player[found].getPosition() = player[found + 1].getPosition() ;
        player[found].getStatus() = player[found + 1 ].getStatus() ;

        cout << "\n Player has been deleted." ;
    }

    cin.get() ;

    menu() ;
}

int linsearch(string val)
{
    for (int j=0; j <= 3; j++)
    {
        if  (player[j].getLastName()==val)
         return j ;         
    }
        return -1 ;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:41:43.133

这只是一个示例，您可以如何解决此问题。我假设您有一个静态长度数组（最大玩家数）。

```
Player *Players[MAX_PLAYERS];          //Array with pointers to Player objects.
for(int i = 0; i < MAX_PLAYERS; ++i)
    Players[i] = new Players(x, y, z); //Fills the array with some data. 
```

现在为您的擦除：

```
if(found > 0) {
    delete Players[found];             //Destroys the object in question.
    for(int i = found; i < MAX_PLAYERS - 1; ++i)
        Players[i] = Players[i + 1];   //Moves the entire list up by one.
    Players[MAX_PLAYERS - 1] = NULL;   //Marks the new end of the list.
} 
```

这个小片段不会“复制”整个对象，而是将它们在数组中向上移动（不重建任何对象）。

当您遇到第一个 NULL 指针（并且最迟在 MAX_PLAYERS 处）时，该数组处于其“末尾”，这说明了您的“空白空间”。或者，您可以省略“向上移动”，只销毁对象并将指针设置为 NULL。这样一来，你就会知道，那里没有玩家。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:41:10.767

您所要做的是将要删除的元素后面的所有元素复制到左侧一个位置，最后更新数组的新长度。例如：

```
for (size_t i = found + 1; i < player_length; ++i) {
    player[i - 1] = player[i];
}
--player_length; 
```

数组中的对象`player`必须是可复制的。我假设您在某处有一个变量来保存数组的当前长度（“长度”是指它当前有多少玩家，而不是它的总容量。）

# php - Wordpress，从 sql 数据库中获取查询并回显它

> ID：14485781
> 
> 赞同：-1
> 
> 时间：2013-01-23T17:32:02.190
> 
> 标签：php, sql, database, wordpress

我想获得特定用户的最后修改/创建日期，然后回显它。

我想做的是：

```
<?php $id = get_the_ID();               

global $current_user;
$current_user = wp_get_current_user();

$postID = $id;  //assigning post id
$userID = $current_user->ID;  // assigning user ID

$sql = "SELECT post_date FROM wp_posts WHERE ID = $postID AND post_author = $userID ORDER BY post_date DESC LIMIT 1";
$userModifiedDate = $wpdb->query($sql);
echo $userModifiedDate; ?> 
```

我的错误在哪里？谁能带领我完成这个？

此刻`$userModifiedDate`还给我`1`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:16:03.857

`$wpdb->query()`返回受影响的行数，而不是实际的查询结果。

[http://codex.wordpress.org/Class_Reference/wpdb#Run_Any_Query_on_the_Database](http://codex.wordpress.org/Class_Reference/wpdb#Run_Any_Query_on_the_Database)

尝试使用更具体的功能，例如`$wpdb->get_var()`or `$wpdb->get_results()`：

```
$userModifiedDate = $wpdb->get_var( $sql ); 
```

[http://codex.wordpress.org/Class_Reference/wpdb#SELECT_a_Variable](http://codex.wordpress.org/Class_Reference/wpdb#SELECT_a_Variable)

此外，虽然这不是*绝对*必要的，但我总是喜欢先通过任何查询`$wpdb->prepare()`：

```
$sql = $wpdb->prepare( "SELECT post_date FROM wp_posts WHERE ID = %d AND post_author = %d ORDER BY post_date DESC LIMIT 1", $postID, $userID ); 
```

[http://codex.wordpress.org/Class_Reference/wpdb#Protect_Queries_Against_SQL_Injection_Attacks](http://codex.wordpress.org/Class_Reference/wpdb#Protect_Queries_Against_SQL_Injection_Attacks)

# c# - MYDLL.dll 中是否有设置告诉 VS 在将 MYDLL 添加到另一个项目时包含（未引用的）Bass.dll？

> ID：14485786
> 
> 赞同：1
> 
> 时间：2013-01-23T17:32:10.390
> 
> 标签：c#, visual-studio-2010

我已经编写了自己的 DLL。称它为 MYDLL.dll。

它使用 Bass.Net.dll（用于音频处理）。Bass.Net.dll 本身需要 Bass.dll 一个未管理的库，因此我无法将其添加到项目中的引用中。所以我刚刚将 Bass.dll 添加到我的项目文件中并设置了 "COPY TO OUTPUT DIRECTORY" 。因此，当我构建项目 MYDLL 时，所有内容都正确放置在我的 bin 文件夹中。

这是问题 - 当我想从另一个应用程序使用 MYDLL.DLL 时。我添加了对 MYDLL.DLL 的引用。并且 VS 2010 足够聪明，也可以引入 Bass.Net.dll（因为它在 MYDLL 项目中被引用）。但它不会带来 Bass.dll 文件。我必须手动复制它。

MYDLL.dll 中是否有设置告诉 VS 在将 MYDLL 添加到另一个项目时包含（未引用的）Bass.dll？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:33:34.657

将引用项目中的 DLL 作为内容包含，其中 Copy To Output = true。

Visual Studio 不会递归地包含您引用的依赖项的依赖项。您有责任确保通过正常的 Windows 和 .NET 依赖项解析可以发现子依赖项。

# asp.net - 将网站从右到左对齐

> ID：14485801
> 
> 赞同：1
> 
> 时间：2013-01-23T17:33:17.067
> 
> 标签：asp.net, vb.net, visual-studio-2010

这是一个使用 vb.net 2010 的新 ASP.NET Web 应用程序现在我需要将整个站点的方向更改为从右到左，以便登录视图与左侧对齐，标题与右侧对齐

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:37:03.503

请参阅 CSS 属性`direction`。 [http://www.w3schools.com/cssref/pr_text_direction.asp](http://www.w3schools.com/cssref/pr_text_direction.asp)

我在项目中实现这一点的方法是使用 LESS CSS 编译器。我创建了两个变量：一个被调用`PrimarySide`，一个被调用`SecondarySide`。在 LTR 语言中，这些变量分别是`left`和`right`；在 RTL 中，它分别是`right`和`left`。

然后在我设置边距、填充、边框或浮动或清除的任何地方，我可能会为其设置左右样式，我会改用@PrimarySide 变量。例如： `float: @PrimarySide`代替`float: left`

这让我可以换掉一些变量并编译我的 CSS 的新版本，而无需遍历和更改我在左侧或右侧做某事的每个位置。

如果这不是你的选择，那么寻找我提到的上述 CSS 样式并制作你的 CSS 的 RTL 版本，有效地交换它们的所有左右值，设置方向：rtl，你就完成了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:44:16.960

我认为这可能会对您有所帮助 - [http://msdn.microsoft.com/en-us/magazine/cc163566.aspx？](http://msdn.microsoft.com/en-us/magazine/cc163566.aspx?) 它可以帮助您了解如何在 .net 中使用资源。

# c# - 将此 SQL 转换为用于 Code-First EF 的 lambda

> ID：14485808
> 
> 赞同：0
> 
> 时间：2013-01-23T17:33:40.267
> 
> 标签：c#, .net, entity-framework, asp.net-mvc-4, lambda

我有这个 SQL，它产生了预期的结果：

```
select * from Categories as c
inner join Questions as q on c.Id = q.CategoryId
inner join Surveys as s on s.Id = q.SurveyId
where s.RoleId = 2 
```

我想将其转换为 lambda 表达式。

这个怎么运作：

*   每个用户角色都存在一个调查
*   调查包含问题
*   问题集属于一个类别

我正在尝试拉动整个调查，使用 Category.Questions 等（已构建循环）浏览结果。

对此的任何帮助将不胜感激，因为我试图在 5 年多的回避之后重新回到 .NET 场景......提前谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:39:12.320

如果您的意思是 LINQ，则如下所示：

```
var query = (from c in dataContext.Categories
                  join q in dataContext.Questions on q.CategoryId = c.Id
                  join s in dataContext.Surveys on q.SurveyId = s.Id
             where c.RoleId = 5
             select new
             {
                [Your Fields]
             }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T19:11:43.237

通过使用解决了这个问题：

```
List<Question> questions = db.questions.Where(q => q.Survey.RoleId == iroleId).ToList(); 
```

并在我的视图中过滤了结果集，其中：

```
foreach (Tracker.Models.Category category in Model.Select(x => x.Category).Distinct().ToList())
{
  ...
  foreach (Tracker.Models.Question question in Model.Where(x => x.Survey.RoleId == ViewBag.UserRoleId && x.CategoryId == catLoop.Id).ToList()) 
```

似乎比我预期的要复杂一些，但解决方案有效。一定有比这更好的方法，虽然......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:41:48.863

对于这个特定的查询，我个人更喜欢写成没有 Lambda 表达式的 LINQ

```
var query=(from c in db.Categories  from q in Questions from n in Surveys where c.Id ==
q.CategoryId && q.SurveyId==n.Id && n..RoleId == 2).ToList(); 
```

# ios - 从 Google Analytics for iOS v2 获取特定的 iOS 设备名称

> ID：14485816
> 
> 赞同：4
> 
> 时间：2013-01-23T17:34:07.857
> 
> 标签：ios, google-analytics

我已将 Google Analytics for iOS 库集成到我的应用程序中，并且总的来说它可以正常工作。我在网络仪表板上看到了结果，但是……每个 iPad 都被报告为“Apple iPad”，这不足以满足我的需求。

我希望能够使用“iPad 3 Retina”、“iPad Mini”等更具体的标签覆盖 ga:mobileDeviceModel 或 ga:mobileDeviceMarketingName。

我的应用程序很容易确定它在哪个设备上运行，并像上面那样组成一个字符串，但我无法让这些显示在 Google Analytics 报告中。

有没有人成功做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-30T02:22:37.837

就我而言，解决方案是在 Google Analytics 网络界面上创建一个自定义维度，我称之为 MobileDeviceNameSpecific，然后将代码添加到 iOS 应用程序以在我的视图控制器的 -viewDidAppear: 方法中设置该自定义维度值，如[Google Analytics（分析）开发者网站上的文档中所述](https://developers.google.com/analytics/devguides/collection/ios/v2/customdimsmets)。

现在我已经这样做了，我可以通过在 Google Analytics（分析）网络报告仪表板的设备报告中选择 MobileDeviceNameSpecific 作为二级维度来查看已使用的设备，该报告显示从 iOS 应用程序发送的值，指示特定设备使用中（例如“iPad 3”、“iPad Mini”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:02:58.867

虽然不完全是您想要做的事情（我怀疑它不可能摆弄谷歌向 GA 报告的内置功能），但您可以使用“自定义变量”（这里是[js 文档](https://developers.google.com/analytics/devguides/collection/gajs/gaTrackingCustomVariables)）来报告这个。自定义变量的报告显示在标准谷歌报告的同一“受众”部分中，因此它相对容易与其他“受众”指标相结合。

# c# - 如何更新进度条使其平滑增加？

> ID：14485818
> 
> 赞同：22
> 
> 时间：2013-01-23T17:34:17.737
> 
> 标签：c#, wpf, progress-bar

我正在使用 WPF (C#) 的进度条来描述进程的进度。

我的算法如下：

```
DoSomethingCode1();
ProgressBar.SetPercent(10); // 10%
DoSomethingCode2();
ProgressBar.SetPercent(20); // 20%

...

DoSomethingCode10();
ProgressBar.SetPercent(100); // 100% 
```

没关系，但它会使进度条不连续。

有人可以告诉我一些使进度条柔和更新的建议吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-11-07T23:17:02.153

你可以使用一个行为！

```
public class ProgressBarSmoother
{
    public static double GetSmoothValue(DependencyObject obj)
    {
        return (double)obj.GetValue(SmoothValueProperty);
    }

    public static void SetSmoothValue(DependencyObject obj, double value)
    {
        obj.SetValue(SmoothValueProperty, value);
    }

    public static readonly DependencyProperty SmoothValueProperty =
        DependencyProperty.RegisterAttached("SmoothValue", typeof(double), typeof(ProgressBarSmoother), new PropertyMetadata(0.0, changing));

    private static void changing(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var anim = new DoubleAnimation((double)e.OldValue, (double)e.NewValue, new TimeSpan(0,0,0,0,250));
        (d as ProgressBar).BeginAnimation(ProgressBar.ValueProperty, anim, HandoffBehavior.Compose);
    }
} 
```

您的 XAML 将如下所示：

```
<ProgressBar local:ProgressBarSmoother.SmoothValue="{Binding Progress}"> 
```

每当`Progress`您在 xaml 中绑定的属性发生更改时，ProgressBarSmoother 行为中的代码就会运行，并使用适当的值`To`和`From`!

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-01-23T19:32:23.787

您可以调用该`BeginAnimation`方法来为`ProgressBar`'`Value`属性设置动画。在下面的示例中，我使用了`DoubleAnimation`.

我创建了一个采用所需百分比的扩展方法：

```
public static class ProgressBarExtensions
{
    private static TimeSpan duration = TimeSpan.FromSeconds(2);

    public static void SetPercent(this ProgressBar progressBar, double percentage)
    {
        DoubleAnimation animation = new DoubleAnimation(percentage, duration);
        progressBar.BeginAnimation(ProgressBar.ValueProperty, animation);          
    }
} 
```

因此，在您的代码中，您可以简单地调用：

```
myProgressBar.SetPercent(50); 
```

这样做只是平滑了过渡，因此看起来更好。引用另一个[答案](https://stackoverflow.com/a/7396133/1399567)：“这个想法是进度条报告*实际进度*- 而不是经过的时间。它不打算成为仅指示*正在发生的事情*的动画。” 但是，进度条的默认样式确实具有脉动效果，这可能意味着工作正在发生。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-23T17:37:49.910

检查您是否可以修改进度条的样式并为它的情节提要设置一个缓动功能，以修改进度条的“填充”，这样它就会有一个平滑的过渡。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-10-04T08:05:25.977

试试这个。

```
private void updateProgressBar(int percent)
    {
        if (ProgressBar.InvokeRequired)
        {
            updateProgressBarCallback cb = new updateProgressBarCallback(updateProgressBar);
            this.Invoke(cb, new object[] { percent });
        }
        else
        {
            ProgressBar.Value = percent;
            ProgressBar.Update();
            ProgressBar.Refresh();
            ProgressBar.Invalidate();
        } 
```

# c# - 文本文件读取、Windows Phone 8 和 MonoGame

> ID：14485827
> 
> 赞同：1
> 
> 时间：2013-01-23T17:34:34.473
> 
> 标签：c#, file-io, windows-phone-8, monogame

我在使用 Windows Phone 8 和 MonoGame 框架读取包含我的关卡信息的简单文本文件时遇到问题。

我的文件读取功能适用于普通的 Windows Phone 8 项目，但是当我尝试在 monogame 项目中使用它时，它在尝试创建新的 FileStream 时给了我这个错误：

> “在 mscorlib.ni.dll 中发生了‘System.MethodAccessException’类型的异常，但未在用户代码中处理”

这是我的文件读取功能

```
private string readFile(string fileName)
{
    FileStream fs = new FileStream(fileName, FileMode.Open);

    byte[] bytes = new byte[fs.Length];
    int numBytesToRead = (int)fs.Length;
    int numBytesRead = 0;
    while (numBytesToRead > 0)
    {
        int n = fs.Read(bytes, numBytesRead, numBytesToRead);

        if (n == 0)
        {
            break;
        }

        numBytesToRead -= n;
        numBytesRead += n;
    }

    numBytesToRead = bytes.Length;
    return System.Text.UTF8Encoding.UTF8.GetString(bytes, 0, bytes.Length);
} 
```

我的方法完全错误还是有人知道为什么这不起作用？我正在尝试从我的项目文件中读取文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T19:40:13.207

Since Windows Phone apps are sandboxed, you would typically use the Isolated Storage classes for saving files, and not go directly to System.IO. But since you mention level information (compiled into your app?), perhaps the following link will help:

[How do I embed and read a text file ina WP7 app?](https://stackoverflow.com/questions/3920971/how-do-i-embed-and-read-a-text-file-ina-wp7-app)

# angularjs - angular.js 性能问题

> ID：14485828
> 
> 赞同：7
> 
> 时间：2013-01-23T17:34:35.647
> 
> 标签：angularjs

性能选项卡上的 Batarang 显示，在应用程序的根目录上，angular 正在调用如下所示的函数： `function (a){var e,f,i=a.$eval(h),m=hc(i,`.

根据 batarang 的说法，它的速度非常慢，当我在应用程序上获得更多行时，它会减慢应用程序的速度并导致 Firefox 崩溃（尽管 Chrome 仍然可以处理它）。那么它到底在做什么呢？我该如何解决？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-23T18:17:22.263

在构建动态扩展 ngRepeat 内容的 Angular 应用程序时需要考虑的事项。您设置的每个 ngRepeat 都会设置一个手表。您在该重复中执行的每个 {{binding}} 或 ngModel 都会设置另一个手表，依此类推。这些中的每一个都创建函数和对象实例，并且还需要在每个 $digest 上进行处理。因此，如果您遇到性能问题，您可能需要实现一个自定义指令，该指令在不设置那些多余的手表的情况下写出您的数据，因此您的性能会更高一些。那是我的 2 美分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-12T18:18:18.267

因此，当我遇到我认为类似的问题时，我在被问到这个问题后的几个月里偶然发现了这个问题。让我描述一下我的问题和我的解决方案（不涉及指令），您可以看看它是否适用于您的问题。

我正在建一张桌子。首先我会请求信息告诉我表格中有哪些行，然后我会请求更多信息来填充表格的单元格。所以我会得到第一个请求并将所有行添加到表中，然后请求单元格数据。我会逐行获取单元格数据，但在一个大表中，这仍然是很多请求。当我取回该行的单元格数据时，我会填写它。

这产生了一个非常酷的效果，所有带有旋转图标的单元格都在等待数据。但是，它让它真的很慢。在 Chrome 中，这很好，浏览器会减慢一些速度，但它会继续工作。但在 FF 中，它会收到烦人的“脚本忙或没有响应”消息。如果您单击“继续”，它会正常工作，但如果您单击“取消”，您将停止脚本并且没有任何效果。

所以，这是我想出的解决方案。不需要指令。我所做的只是完全构建每一行的数据，然后才将该行添加到 ng-repeat 使用的变量中。这种方式要快得多。这些行在取回所有数据时填充，$watch 仍然存在，但您不会一次触发大量它们，您仍然可以让它们能够稍后更改数据（在我的表中，您可以编辑表格的每个单元格，以便以后能够轻松更改数据很重要）。

希望这可以帮助某人。

# dql - 如何通过 DQL 更改类型中字段的维度？

> ID：14485830
> 
> 赞同：2
> 
> 时间：2013-01-23T17:34:46.967
> 
> 标签：dql, alter, documentum, documentum6.5

如何通过 DQL 更改类型中字段的维度？

```
create type archik_type(
   archik_id ID,
   archik_number string(10)
)
supertype null
publish
go 
```

如何从 archik_number string(10) 更改为 string(256) ？可能是“改变类型”对我有帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T08:45:01.990

同事帮了我

```
alter type archik_type( 
modify archik_number string(256)
) 
publish 
```

# c++ - 在 gunzip 成功的地方提升 gzip_decompressor 失败

> ID：14485834
> 
> 赞同：0
> 
> 时间：2013-01-23T17:35:07.987
> 
> 标签：c++, boost, gunzip

我们工作中的产品之一涉及其中具有以下结构的文件：

```
A STRING WITH SOME CONTENT IDENTIFYING THE FILES CONTENTS
A STRING ON ROW 2
A STRING ON ROW 3
A STRING ON ROW 4
<binary data starts here and is gzipped> 
```

现在，如果我这样做，我可以解压缩内容并重新创建同一文件的未压缩版本：

```
INPUT=FILEA.COMPRESSED
OUTPUT=FILEB.UNCOMPRESSED
head -n5 $INPUT > $OUTPUT
cat $INPUT | tail --lines=+5 | gunzip >> $OUTPUT

# At this point I'm left with a file structure as follows:
A STRING WITH SOME CONTENT IDENTIFYING THE FILES CONTENTS
A STRING ON ROW 2
A STRING ON ROW 3
A STRING ON ROW 4
<uncompressed content> 
```

我正在尝试通过提升来完成同样的壮举。Boost 总是抛出一个**gzip_error**代码**4**，*gzip.hpp*显示为**bad_header**。

毫无疑问，我正在处理的文件不是防弹的，并且是由一个非常古老的遗留系统生成的。

**我的主要问题：**如果 gunzip 可以做到......是否有一个调整或标志我忽略了提升它可以让它做呢？

失败的 C++ 代码看起来像这样（大大简化以专注于这一点，因此它可能包含语法错误）：

```
#include <boost/iostreams/filtering_stream.hpp>
#include <boost/iostreams/copy.hpp>
#include <boost/iostreams/filter/gzip.hpp>
#include <sstream>
#include <iostream>
#include <fstream>

// Open File
ifstream file("myfile", ios::in|ios::binary);

int line = 1;
char c;
while (!file.eof() && line < 5){
   // I do do 'way' more error checking and proper handling here
   // in real code, but you get the point.. I'm moving the cursor
   // past the last new line and the beginning of what is otherwise
   // compressed content.
   file.get(c);
   if(c == '\n')line++;
}

stringstream ss;
// Store rest of binary data into stringstream
while(!file.eof()){
   file.get(c);
   ss.put(c);
}
// Close File
file.close();

// Return file pointer to potential gzip stream
ss.seekg(0, ios::beg);
try
{
   stringstream gzipped(ss.str());
   io::filtering_istream gunzip;
   gunzip.push(io::gzip_decompressor());
   gunzip.push(gzipped);
   copy(gunzip, ss);
}
catch(io::gzip_error const&  ex)
   // always throws error code 4 here (bad_header)
   cout << "Exception: " << ex.error() << endl; 
```

以下是一些更有用的信息，可能会有所帮助：

*   操作系统：**红帽 5.7**
*   升压：**boost-1.33.1-10（el5 存储库）**
*   平台：**x86_64**
*   GCC：**版本 4.1.2 20080704（红帽 4.1.2-46）**

我的 Makefile 在链接器中也有以下几行：

```
LDFLAGS = -lz -lboost_iostreams 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:53:25.280

我不确定这是否是您错误的根本原因，但您的使用`file.eof()`不正确。只有在您尝试读取文件末尾之后，该函数才会返回 true。它不会通知您下一次阅读是否会失败。

```
while(!file.eof()){ //1
   file.get(c);  // 2
   ss.put(c);    // 3
} 
```

在这个循环中，如果您在第 2 行读取最后一个有效字符，则在第 3 行输出它。然后再次测试第 1 行的条件。由于您还没有尝试读取过去的文件末尾`file.eof()`，因此返回 false，因此循环条件为 true。然后它尝试读取下一个字符，但失败，保持`c`不变。然后第 3 行将该无效字符放入`ss`.

这会在流的末尾产生一个额外的字符。我不确定这是否是唯一的问题，但它可能是其中之一。

编辑：

好吧，看了之后，我不是 100% 确定它为什么会发生，但这是因为你在重用 stringstream `ss`。在进行复制之前调用`ss.seekp(0, ios::begin)`，或者使用单独的字符串流。

就个人而言，我不会复制`ss`到，而是`gzipped`直接`gzipped`从输入文件写入，然后通过复制输出到 ss。

# javascript - node.js 和 AMD API 有什么用？

> ID：14485838
> 
> 赞同：3
> 
> 时间：2013-01-23T17:35:23.447
> 
> 标签：javascript, node.js, build, dependency-management, amd

我对 JavaScript 有一些经验，但对 JavaScript 项目管理和工具却一无所知。我正在考虑使用 node 和 AMD，但不确定它们的用途，并且在阅读文档时遇到了麻烦。

以下是我坚持的一些具体观点：

[**节点**](http://nodejs.org/)

*   我的印象是它是为服务器端 JavaScript 设计的。它还可以为客户端项目进行构建吗？
*   如果它可以进行构建，它可以将项目（+依赖项）构建到单个文件中以进行客户端部署吗？
*   它的构建过程可以集成 jslint 和 grunt 等工具吗？

[**AMD**](http://requirejs.org/docs/whyamd.html)

*   它[显然不能与其他工具配合使用](https://stackoverflow.com/questions/9009510/why-did-underscore-js-remove-support-for-amd)是一个问题吗？（不是在这里抛泥巴，只是不太了解这个问题的来龙去脉）
*   AMD 在哪里运行——在网络浏览器中？如果是这样，这是否意味着我需要另一个工具来处理实际获取和管理第 3 方库、运行 jslint、运行测试和构建项目？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T17:49:15.370

这些项目不相关。

node.js 是一个 JavaScript 解释器，就像一个 Web 浏览器。它是一种服务器技术，不能在客户端上运行。具体来说，它是一组将 IO 支持添加到文件或网络的包装库，以便您可以从磁盘读取或响应 TCP（以及因此 TCP/IP aka HTTP(S) 或 FTP）请求。否则，它只是像您在浏览器中编写的 javascript。您可以使用它从命令行运行脚本或构建 Web 服务器。

它可用于从命令行“构建”项目，因为它可以像 shell 环境中的脚本语言一样使用（它甚至响应 #! 命令路由）。

AMD 是一个管理 JavaScript 项目依赖关系的工具。您可以使用它动态甚至异步加载依赖项（因此得名）。AMD 将在浏览器和 node.js 中工作（但 node.js 已经包含动态加载 JavaScript 的技术，因此它不会真正有用）。

# javascript - 浏览器中的图像不一致

> ID：14485850
> 
> 赞同：0
> 
> 时间：2013-01-23T17:35:53.597
> 
> 标签：javascript, html, browser, html5-canvas

最近，我最近一直在使用 HTML Canvas 5 元素试图从浏览器上的给定图像中提取图像数据，但我遇到了一些问题。使用 canvas 元素的函数（如 getDataURL 或 getImageData()）提取此数据时，跨浏览器的结果不一致。我意识到这是由于浏览器的本机代码对于每个都不同，因此渲染引擎将以不同的方式渲染图像。但是，有没有办法在浏览器中获得一致的图像结果，例如大小为 500kb-1mB 的图像？

我知道 AJAX 解决方案，从服务器调用该图像的 dataURL 的 json 对象，因为这将是原始源，因此在浏览器中是一致的。此外，将 dataURL 从服务器加载到浏览器中可能是另一种解决方案。这些问题将是性能和灵活性。还有其他可行的解决方案吗？我是否查看了我可以在客户端做的事情？

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-07T21:49:04.790

好的，在继续我自己的项目后，我发现了一个对我有用的答案，并且可能适合您的目的。

toDataURL 是错误的，因为它将“二进制”数据读入画布而不是实际像素。浏览器之间在解释该二进制文件时存在不一致，无论如何，二进制数据并没有为您提供我假设您正在寻找的像素信息。

要保留数据您需要将图像（保持原始大小）放入画布，然后使用 getImageData(x,y,w,h) 将 RGBA 像素数据加载到数组中。然后，您可以简单地遍历现在“真实”的像素数据并进行处理。

我尝试将图像缩小到可管理的大小，但这在浏览器中并不总是一致的。无论如何，我只需要图像的一部分，所以这个方法可以达到我的目的，也许你可以隐藏你正在处理的全尺寸画布，并向用户展示一个有代表性的缩小画布。

# c# - 更改 WCF 端点

> ID：14485851
> 
> 赞同：0
> 
> 时间：2013-01-23T17:35:56.847
> 
> 标签：c#, wcf, wcf-binding, spring.net, wcf-endpoint

我从 spring.net 示例中显示的初始示例中具有以下配置。

```
<wcf:channelFactory id="serverAppHost"
channelType="Contract.IHost, WcfService.Contract"
endpointConfigurationName="serverAppHostEndpoint" />

<client>
    <endpoint name="serverAppHostEndpoint" address="http://xxxxx:yyyyy/program/service/host" binding="basicHttpBinding" bindingConfiguration="basicHttpBinding1" contract="Contract.IHost"/> 
</client> 
```

我可以读作

```
IApplicationContext ctx = ContextRegistry.GetContext();
IHost val = (IHost)ctx.GetObject("serverAppHost"); 
```

如果我上面的端点具有正确的 IP 地址和端口号，所有这些都可以正常工作。

我正在寻找一种在代码中编辑端点以使用启动时不知道的 IP 地址和端口号的方法。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T03:45:05.973

我解决了一个类似的问题。基本上，一旦您的应用程序运行，通道工厂就不是很灵活。你最好使用服务代理并像这样动态设置端点，

```
var client = new SampleClient();
client.Endpoint.Address = new EndpointAddress(url);
client.Open();
responseMessage = client.ServiceMethod(requestMessage); 
```

SampleClient 是 Visual Studio 为您生成的服务代理。您需要一个 WSDL 来生成它。您仍然需要在 Web.config 中添加一个虚拟的 Client/Endpoint 标记，但是当您加载动态 URL 时，这将被覆盖。

如果您需要更多详细信息，请告诉我。我可以引导你完成具体的实现。

# javascript - 如何使用 Velocity 制作多级 Liferay 菜单？

> ID：14485852
> 
> 赞同：1
> 
> 时间：2013-01-23T17:35:57.067
> 
> 标签：javascript, liferay, velocity

我尝试用 Velocity 制作新的 Liferay 主题。我想制作多级菜单。我可以像这样用手制作关卡：

```
 <ul class="obsm">
    #foreach ($nav_item in $nav_items)
        #if ($nav_item.isSelected())
            <li class="active">
        #else
            <li>
        #end
            <a href="$nav_item.getURL()" $nav_item.getTarget()><span>$nav_item.icon() $nav_item.getName()</span></a>
            #if ($nav_item.hasChildren())
                <ul>
                    #foreach ($nav_child in $nav_item.getChildren())
                        #if ($nav_child.isSelected())
                            <li class="active">
                        #else
                            <li>
                        #end
                            <a href="$nav_child.getURL()" $nav_child.getTarget()>$nav_child.getName()</a>
                            #if ($nav_child.hasChildren())
                                <ul>
                                    #foreach ($nav_child in $nav_child.getChildren())
                                        #if ($nav_child.isSelected())
                                            <li class="active">
                                        #else
                                            <li>
                                        #end
                                            <a href="$nav_child.getURL()" $nav_child.getTarget()>$nav_child.getName()</a>
                                        </li>
                                    #end
                                </ul>
                            #end
                        </li>
                    #end
                </ul>
            #end
        </li><br>
    #end
</ul> 
```

有 3 级菜单。但它并不好。我想做无限关卡菜单。这是可能的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T01:02:17.930

我建议创建一个速度宏并递归调用它。像这样：

```
#macro ( navigation $list )
    #foreach ( $item in $list )
        //code

        #if ( $item.hasChilden() )
            #navigation ( $item.getChildren() )
        #end
    #end    
#end 
```

请参阅：http: [//velocity.apache.org/engine/releases/velocity-1.5/user-guide.html#velocimacros](http://velocity.apache.org/engine/releases/velocity-1.5/user-guide.html#velocimacros)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-28T08:02:13.707

我有另一个解决方案

```
<nav class="$nav_css_class header-menu" id="navigation" role="navigation">
#set ($nav_item_selected="")
#set ($nav_item_2level_selected="")
#set ($nav_item_3level_selected="")
<ul class="menu-level-01" aria-label="#language ("site-pages")" role="menubar">
    #foreach ($nav_item in $nav_items)
        #set ($nav_item_attr_has_popup="")
        #set ($nav_item_attr_selected="")
        #set ($nav_item_css_class = "")
        #set ($nav_item_css_class_active = "")

        #if ($nav_item.isSelected())
            #set ($nav_item_attr_selected="aria-selected='true'")
            #set ($nav_item_css_class = "selected")
            #set ($nav_item_css_class_active = "active")
            #set ($nav_item_selected = $nav_item)
        #end

        #if ($nav_item.hasChildren())
            #set ($nav_item_attr_has_popup="aria-haspopup='true'")
        #end

        <li class="$nav_item_css_class $nav_item_css_class_active" id="layout_$nav_item.getLayoutId()" $nav_item_attr_selected role="presentation">
            <a aria-labelledby="layout_$nav_item.getLayoutId()" href="$nav_item.getURL()" $nav_item_attr_has_popup $nav_item.getTarget() role="menuitem"><span>$nav_item.icon() $nav_item.getName()</span></a>

        </li>
    #end
</ul>
#if ($nav_item_selected)
    #if ($nav_item_selected.hasChildren())
        <ul class="menu-level-02" aria-label="#language ("site-pages")" role="menubar">
            #foreach ($nav_item_2level in $nav_item_selected.getChildren())
                #set ($nav_item_2level_attr_selected="")
                #set ($nav_item_2level_css_class = "false")
                #set ($nav_item_2level_css_class_active = "")

                #if ($nav_item_2level.isSelected())
                    #set ($nav_item_2level_attr_selected="aria-selected='true'")
                    #set ($nav_item_2level_css_class = "selected")
                    #set ($nav_item_2level_css_class_active = "active")
                    #set ($nav_item_2level_selected = $nav_item_2level)
                #end

                #if ($nav_item_2level.hasChildren())
                    #set ($nav_item_2level_attr_has_popup="aria-haspopup='true'")
                #end

                <li class="$nav_item_2level_css_class $nav_item_2level_css_class_active" id="layout_$nav_item_2level.getLayoutId()" $nav_item_2level_attr_selected role="presentation">
                    <a aria-labelledby="layout_$nav_item_2level.getLayoutId()" href="$nav_item_2level.getURL()" $nav_item_2level_attr_has_popup $nav_item_2level.getTarget() role="menuitem"><span>$nav_item_2level.icon() $nav_item_2level.getName()</span></a>

                </li>
            #end
        </ul>

        #if ($nav_item_2level_selected.hasChildren())
            <ul class="menu-level-03" aria-label="#language ("site-pages")" role="menubar">
                #foreach ($nav_item_3level in $nav_item_2level_selected.getChildren())
                    #set ($nav_item_3level_attr_selected="")
                    #set ($nav_item_3level_css_class = "false")
                    #set ($nav_item_3level_css_class_active = "")

                    #if ($nav_item_3level.isSelected())
                        #set ($nav_item_3level_attr_selected="aria-selected='true'")
                        #set ($nav_item_3level_css_class = "selected")
                        #set ($nav_item_3level_css_class_active = "active")
                        #set ($nav_item_3level_selected = $nav_item_3level)
                    #end

                    #if ($nav_item_3level.hasChildren())
                        #set ($nav_item_3level_attr_has_popup="aria-haspopup='true'")
                    #end

                    <li class="$nav_item_3level_css_class $nav_item_3level_css_class_active" id="layout_$nav_item_3level.getLayoutId()" $nav_item_3level_attr_selected role="presentation">
                        <a aria-labelledby="layout_$nav_item_3level.getLayoutId()" href="$nav_item_3level.getURL()" $nav_item_3level_attr_has_popup $nav_item_3level.getTarget() role="menuitem"><span>$nav_item_3level.icon() $nav_item_3level.getName()</span></a>

                    </li>
                #end
            </ul>   
        #end    
    #end    
#end 
```

# c# - 将 Rx 与 Prism 的 EventAggregator 一起使用或与它们一起使用 - 建议的方法？

> ID：14485854
> 
> 赞同：3
> 
> 时间：2013-01-23T17:36:00.557
> 
> 标签：c#, .net, prism, system.reactive, eventaggregator

令我震惊的是，Prism 和 Rx 框架之间既有一些重叠也有冲突`EventAggregator`，因为两者都是关于订阅事件流的。Rx 显然提供了更细粒度的控制，而 Rx`EventAggregator`提供了松散耦合的、应用程序范围的、发布-订阅基础设施。

所以我的问题是，我们如何在同一个应用程序中有效地利用这两种技术？我是否混淆了他们的角色，或者我错过了某个地方的区别？有没有人有这样做的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:40:28.350

这是与 EventAggregator 相同概念的 Rx 友好版本：

[https://github.com/reactiveui/ReactiveUI/blob/master/ReactiveUI/MessageBus.cs](https://github.com/reactiveui/ReactiveUI/blob/master/ReactiveUI/MessageBus.cs)

> 我是否混淆了他们的角色，或者我错过了某个地方的区别？

消息总线类型的东西只是您可以在应用程序中使用 Rx的**众多方式之一，我编写的名为**[ReactiveUI](http://www.reactiveui.net)的 MVVM 框架有更多的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:45:22.033

这是一个基于 Rx 的实现的链接`EventAggregator`；就像@paul-betts 版本一样`ReactiveUI`，它不是“插入式”替代品，但也像他的一样，它很容易包装。

[José F. Romaniello - 具有响应式扩展的事件聚合器](http://joseoncode.com/2010/04/29/event-aggregator-with-reactive-extensions/)

# scala - mixins 能解决脆弱的基类问题吗？

> ID：14485856
> 
> 赞同：5
> 
> 时间：2013-01-23T17:36:10.540
> 
> 标签：scala, mixins, extends, traits

在关于编程语言的课程中，我的教授引用 mixins 作为脆弱基类问题的解决方案之一。Wikipedia 也曾经列出 (Ruby) mixins 作为脆弱基类问题的解决方案，但前段时间[有人删除](http://en.wikipedia.org/w/index.php?title=Fragile_base_class&diff=451336813&oldid=446645464)了对 mixins 的引用。我仍然怀疑它们在脆弱的基类问题上可能比继承具有某种优势。否则，为什么教授会说他们有帮助？

我将举一个可能的问题的例子。这是教授给我们用来说明问题的（Java）问题的简单 Scala 实现。

考虑以下基类。假设这是列表的一些非常有效的特殊实现，并且在其上定义了更多操作。

```
class MyList[T] {
    private var list : List[T] = List.empty
    def add(el:T) = {
        list = el::list
    }
    def addAll(toAdd:List[T]) : Unit = {
        if (!toAdd.isEmpty) {
            add(toAdd.head)
            addAll(toAdd.tail)
        }
    }
} 
```

还要考虑以下特征，它应该添加`size`到上面的列表中。

```
trait CountingSet[T] extends MyList[T] {
    private var count : Int = 0;
    override def add(el:T) = {
        count = count + 1
        super.add(el)
    }
    override def addAll(toAdd:List[T]) = {
        count = count + toAdd.size;
        super.addAll(toAdd);
    }
    def size : Int = { count }
} 
```

问题是 trait 是否有效取决于我们`addAll`在基类中的实现方式，即基类提供的功能是“脆弱的”，就像`extends`Java 或任何其他编程语言中的正则一样.

例如，如果我们使用上面定义的`MyList`and运行以下代码，我们会得到 back ，而我们期望得到。`CountingSet``5``2`

```
object Main {
    def main(args:Array[String]) : Unit = {
        val myCountingSet = new MyList[Int] with CountingSet[Int]
        myCountingSet.addAll(List(1,2))
        println(myCountingSet.size) // Prints 5
    }
} 
```

如果我们`addAll`在基类 (!) 中进行如下更改，则该特征`CountingSet`按预期工作。

```
class MyList[T] {
    private var list : List[T] = List.empty
    def add(el:T) = {
        list = el::list
    }
    def addAll(toAdd:List[T]) : Unit = {
        var t = toAdd;
        while(!t.isEmpty) {
            list = t.head::list
            t = t.tail
        }
    }
} 
```

请记住，我不是 Scala 专家！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-23T18:50:55.343

Mixins（无论是作为特征还是其他）不能完全防止脆弱的基类综合症，也不能严格使用接口。原因应该很清楚：您可以对基类的工作进行任何假设，也可以对接口进行假设。它之所以有帮助，只是因为它会停止并让您思考，并且如果您的界面变得太大，则会施加样板惩罚，这两者都会将您限制在需要的和有效的操作上。

特质真正让你摆脱困境的地方是你*已经预料*到可能会出现问题的地方；然后你可以参数化你的特质来做适当的事情，或者混合你需要的特质来做适当的事情。例如，在 Scala 集合库中，特征`IndexedSeqOptimized`不仅用于指示，而且*还*用于以在索引与访问集合元素的任何其他方式一样快时执行良好的方式执行各种操作。 `ArrayBuffer`，它包装了一个数组，因此具有非常快速的索引访问（实际上，索引是进入数组的唯一方法！）继承自`IndexedSeqOptimized`. 相比之下，`Vector`可以相当快地被索引，但是在没有显式索引的情况下进行遍历会更快，所以它不会。如果`IndexedSeqOptimzed`不是一个特征，你会不走运，因为`ArrayBuffer`它在可变的层次结构中并且`Vector`在不可变的层次结构中，所以不能创建一个通用的抽象超类（至少不会把其他继承的功能弄得一团糟）。

因此，您脆弱的基类问题没有得到解决；例如，如果您更改`Traversable`算法的实现，使其具有`O(n)`性能而不是`O(1)`（也许是为了节省空间），您显然无法知道某个孩子是否会重复使用它并产生`O(n^2)`可能是灾难性的性能。但是，如果您*知道*，它会使修复变得容易得多：只需混合具有`O(1)`实现的正确特征（并且孩子可以在必要时自由地这样做）。它有助于将关注点分解为概念上连贯的单元。

所以，总而言之，你可以让任何东西变得脆弱。特质是一种工具，明智地使用它可以帮助你变得强壮，但它们不会保护你免受任何愚蠢的影响。

# emacs - 多术语：了解键盘绑定

> ID：14485858
> 
> 赞同：1
> 
> 时间：2013-01-23T17:36:19.797
> 
> 标签：emacs, elisp

[我对这两个多术语](http://www.emacswiki.org/MultiTerm)列表之间的差异感到有些困惑（顺便问一下官方存储库在哪里托管？）

*   `term-bind-key-alist`
*   `term-unbind-key-list`

在我的脑海里，应该有两件事：

*   我们希望 Emacs 捕获自己并以特定方式解释的击键（通过将它们绑定到命令）
*   Emacs 直接发送到 shell 的笔画（“原样”）。

究竟如何定义这些列表`term-unbind-key-list`和`term-bind-key-alist`绑定？

另外，multi-term 是否支持**行模式**和**字符模式**？如果是这样，我们的模式如何改变按键和这些列表的解释方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-24T00:54:13.190

我看到了配方`multi-term.rcp`，`el-get`它是从 emacswiki 下载的。

`term-bind-key-alist``term-send-up`适用于or之类的函数`term-previous-input`，其键绑定设置为“emacs 样式”而不是“术语样式”。

`term-unbind-key-list`是设置的模拟`'nil`（参见[字符模式中的 ansi-term](https://stackoverflow.com/a/14491568/1937596)）。默认情况下，几乎所有的键`term-raw-map`都绑定到功能`term-send-raw`，`'nil`只是解除绑定。

`term-bind-key-alist`并且在 multi-term.el 中`term-unbind-key-list`用于`term-raw-map`( **character mode** ) 和`term-mode-map`( **line mode** ) 完全不使用。

我不使用多词，我`term-mode-map`直接设置`term-raw-map`。例如在模式之间切换：

```
(define-key term-mode-map (kbd "C-j") 'term-char-mode)
(define-key term-raw-map (kbd "C-j") 'term-line-mode) 
```

# tridion - 在内联编辑期间单击更新预览按钮时出现错误“架构参考 ID”（Tridion UI）

> ID：14485860
> 
> 赞同：3
> 
> 时间：2013-01-23T17:36:24.260
> 
> 标签：tridion, tridion-2011

我能够对组件进行内联编辑。我可以在“表单视图”中打开组件并保存组件，但是当我尝试单击“更新预览”按钮时，它会提示错误“架构参考 ID”。当我单击“SDL Tridion”标签或刷新页面时，同样的错误消息也会显示为警告。

Tridion 事件查看器中记录了以下错误：

```
SCHEMA_REFERENCE_ID Component: Tridion.ContentManager.CoreService
   Errorcode: 0 User: NT AUTHORITY\NETWORK SERVICE StackTrace
   Information Details: at
   Tridion.ContentManager.Session.GetList(SystemWideListFilter filter)
   at
   Tridion.ContentManager.CoreService.CoreServiceBase.GetSystemWideListXml(SystemWideListFilterData
   filter) at SyncInvokeGetSystemWideListXml(Object , Object[] ,
   Object[] ) at
   System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(Object
   instance, Object[] inputs, Object[]& outputs) at
   Tridion.ContentManager.CoreService.TransactionSupportInvoker.Invoke(Object
   instance, Object[] inputs, Object[]& outputs) at
   System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(MessageRpc&
   rpc) at
   System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(MessageRpc&
   rpc) at
   System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(MessageRpc&
   rpc) at System.ServiceModel.Dispatcher.MessageRpc.Process(Boolean
   isOperationContextSet) 
```

* * *

```
The socket connection was aborted. This could be caused by an error processing your message or a receive timeout being exceeded by the remote host, or an underlying network resource issue. Local socket timeout was '10675199.02:48:05.4775807'.
The read operation failed, see inner exception.
The socket connection was aborted. This could be caused by an error processing your message or a receive timeout being exceeded by the remote host, or an underlying network resource issue. Local socket timeout was '10675199.02:48:05.4775807'.
An existing connection was forcibly closed by the remote host

Component: Tridion.ContentManager.CoreService
Errorcode: 0
User: NT AUTHORITY\NETWORK SERVICE

StackTrace Information Details:
   at System.ServiceModel.Channels.SocketConnection.BeginReadCore(Int32 offset, Int32 size, TimeSpan timeout, WaitCallback callback, Object state)
   at System.ServiceModel.Channels.ConnectionStream.ReadAsyncResult..ctor(IConnection connection, Byte[] buffer, Int32 offset, Int32 count, TimeSpan timeout, AsyncCallback callback, Object state)
   at System.ServiceModel.Channels.ConnectionStream.BeginRead(Byte[] buffer, Int32 offset, Int32 count, AsyncCallback callback, Object state)
   at System.Net.FixedSizeReader.StartReading()
   at System.Net.Security.NegotiateStream.StartFrameHeader(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.NegotiateStream.StartReading(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.NegotiateStream.ProcessRead(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.NegotiateStream.ProcessRead(Byte[] buffer, Int32 offset, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.NegotiateStream.BeginRead(Byte[] buffer, Int32 offset, Int32 count, AsyncCallback asyncCallback, Object asyncState)
   at System.ServiceModel.Channels.StreamConnection.BeginRead(Int32 offset, Int32 size, TimeSpan timeout, WaitCallback callback, Object state)
   at System.ServiceModel.Channels.StreamConnection.BeginRead(Int32 offset, Int32 size, TimeSpan timeout, WaitCallback callback, Object state)
   at System.ServiceModel.Channels.SessionConnectionReader.BeginReceive(TimeSpan timeout, WaitCallback callback, Object state)
   at System.ServiceModel.Channels.SynchronizedMessageSource.ReceiveAsyncResult.PerformOperation(TimeSpan timeout)
   at System.ServiceModel.Channels.SynchronizedMessageSource.SynchronizedAsyncResult`1..ctor(SynchronizedMessageSource syncSource, TimeSpan timeout, AsyncCallback callback, Object state)
   at System.ServiceModel.Channels.FramingDuplexSessionChannel.BeginReceive(TimeSpan timeout, AsyncCallback callback, Object state)
   at System.ServiceModel.Channels.FramingDuplexSessionChannel.TryReceiveAsyncResult..ctor(FramingDuplexSessionChannel channel, TimeSpan timeout, AsyncCallback callback, Object state)
   at System.ServiceModel.Channels.FramingDuplexSessionChannel.BeginTryReceive(TimeSpan timeout, AsyncCallback callback, Object state)
   at System.ServiceModel.Channels.TransactionReceiveChannelGeneric`1.BeginTryReceive(TimeSpan timeout, AsyncCallback callback, Object state)
   at System.ServiceModel.Dispatcher.ErrorHandlingReceiver.BeginTryReceive(TimeSpan timeout, AsyncCallback callback, Object state) 
```

* * *

新页面和插入组件选项也显示为禁用。虽然我在 Tridion 中创建了一种页面类型。

有没有人对可能导致问题的原因提出建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T17:39:53.870

页面类型可能需要浏览器刷新或缓存清除，因为它被大量缓存。重新打开浏览器通常对我有用。

另一个问题看起来您可能有一个错误配置的会话预览数据库（错误的版本或未在您的存储包装器中正确配置）。

# php - 如何转换混合编码文件的字符

> ID：14485863
> 
> 赞同：0
> 
> 时间：2013-01-23T17:36:26.780
> 
> 标签：php, python, parsing, text, character-encoding

我从 PDF 文件中复制并粘贴了文本，但它没有提取数字。如果我对导出的 txt 文件执行更少或更多操作，我会看到以下内容：

```
"Christina, daughter of David Brodie, on <U+F735> November <U+F731><U+F736><U+F736><U+F735>. She was the sister of" 
```

它应该是：

> “克里斯蒂娜，大卫布罗迪的女儿，1665 年 11 月 5 日。她是”

最初我虽然这将是一个简单的搜索和替换，但`<U+F73n>`数字是编码的，我不确定如何提取它们，甚至不确定它们是如何编码的，尽管我确实将文件保存为`utf-8`原始文件。我尝试使用 php 的`mb_string`函数来查看是否可以以某种方式提取代码，但我没有成功。

有没有其他人遇到过这个问题，是否有一个简单的解决方案让我望而却步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:41:56.130

不幸的是，U+Fxxx 位于 Unicode 的私人使用区。没有自动的方法来解决这个问题，除非提前知道映射。根据您示例中的代码点，我敢说您可以从字符值中减去 0xF731，然后添加 0x30 以将它们转换为 ASCII 数字。

# java - 使用 XStream 将字符串日期时间转换为 Java Long

> ID：14485866
> 
> 赞同：1
> 
> 时间：2013-01-23T17:36:29.370
> 
> 标签：java, xml, datetime, xstream, oxm

我试图让 XStream 能够将包含日期时间（例如`2013-01-23 16:50:39.495855`）的字符串转换为`java.lang.Long`实例。

目前，我有这样的 XML：

```
<widget>
    <timestamp val="2013-01-23 16:50:39.495855"/>
</widget> 
```

我想将其转换为标准的 Unix 纪元时间戳（自 1970 年 1 月 1 日以来的毫秒数）。由于上述日期时间转换为 (如果我的数学是正确的) 的 Unix 纪元时间戳`1358959839000`，我希望 XStream 将其转换为`new Long(1358959839000)`实例。

我不相信 XStream 的别名方法可以做到这一点，我可能需要编写自己的`Converter`，但是 a`com.thoughtworks.xstream.converters.basic.LongConverter`已经存在，所以我不确定如何编写自己的`UnixEpochLongConverter`，因为两个转换器都试图将 String 转换为沿着。有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:20:03.123

使用[registerLocalConverter](http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/XStream.html#registerLocalConverter%28java.lang.Class,%20java.lang.String,%20com.thoughtworks.xstream.converters.Converter%29)或优先级将您的自定义转换器注册为本地`XStream.PRIORITY_NORMAL`。

```
xstream.registerLocalConverter(
    Widget.class, 
    "timestamp", 
     new UnixEpochLongConverter()); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-23T17:59:00.277

您可以使用 DateFormat 对象将字符串转换为 java.util.Date 对象，然后执行 date.getTime() 以返回 long 值。下面是一个例子。您可以在对象中编写一个基本上将字符串转换为长字符串的方法。

```
 String date = "2013-01-23 16:50:39.495855";
 DateFormat format = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss.S");
 Date datem = format.parse(date);
 long longDate = datem.getTime();
 System.out.println(longDate); 
```

# ios - NSJSONSerialization - 无法将数据转换为字符串

> ID：14485868
> 
> 赞同：9
> 
> 时间：2013-01-23T17:36:32.427
> 
> 标签：ios, objective-c, json, web-services, cocoa-touch

我在使用 NSJSONSerialization 从 Met Office Datapoint API 读取 JSON 时遇到问题。

我收到以下错误

```
Error Domain=NSCocoaErrorDomain Code=3840 "The operation couldn’t be completed. (Cocoa error 3840.)" (Unable to convert data to string around character 58208. 
```

我已经检查并认为这是根据字符位置的违规行

```
{"id":"353556","latitude":"57.1893","longitude":"-5.0929","name":"Sóil Chaorainn"} 
```

根据我尝试的几个验证器，JSON 本身似乎是有效的，我希望它也来自一个大型组织，例如 Met Office。

NSJSONSerialization 不应该适用于诸如“ó”之类的字符吗？

如果不是，我该如何改变编码类型来处理这个问题？

提前谢谢了

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-23T18:31:41.927

气象局数据点以 ISO-8859-1 发回数据，这不是 NSJSONSerialization 支持的数据格式之一。

为了使其工作，首先使用 NSISOLatin1StringEncoding 从 URL 内容创建一个字符串，然后使用 NSUTF8 编码创建要在 NSJSONSerialization 中使用的 NSData。

以下工作创建相应的json对象

```
NSError *error;
NSString *string = [NSString stringWithContentsOfURL:[NSURL URLWithString:@"http://datapoint.metoffice.gov.uk/public/data/val/wxfcs/all/json/sitelist?key=<YOUR_API_KEY"] encoding:NSISOLatin1StringEncoding error:&error];

NSData *metOfficeData = [string dataUsingEncoding:NSUTF8StringEncoding];

id jsonObject = [NSJSONSerialization JSONObjectWithData:metOfficeData options:kNilOptions error:&error];

if (error) {
    //Error handling
} else {
    //use your json object
    NSDictionary *locations = [jsonObject objectForKey:@"Locations"];
    NSArray *location = [locations objectForKey:@"Location"];
    NSLog(@"Received %d locations from the DataPoint", [location count]);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T17:47:23.483

JSON 的编码是什么？JSON 应该是 UTF-8，但我看到他们使用 ISO-8859-1 的糟糕 API。NSJSONSerialization 仅适用于 UTF-8、UTF-16LE、UTF-16BE、UTF-32LE、UTF-32BE。

# java - 音频：更改字节数组中的样本量

> ID：14485873
> 
> 赞同：15
> 
> 时间：2013-01-23T17:36:54.253
> 
> 标签：java, audio, bytearray, volume, javasound

我正在使用[这种方法（如下所示）](http://snippi.com/s/ndi3f4x)将 wav 文件读取到字节数组中。现在我将它存储在我的字节数组中，我想改变声音的音量。

```
private byte[] getAudioFileData(final String filePath) {
    byte[] data = null;
    try {
    final ByteArrayOutputStream baout = new ByteArrayOutputStream();
    final File file = new File(filePath);
    final AudioInputStream audioInputStream = AudioSystem.getAudioInputStream(file);

    byte[] buffer = new byte[4096];
    int c;
    while ((c = audioInputStream.read(buffer, 0, buffer.length)) != -1) {
        baout.write(buffer, 0, c);
    }
    audioInputStream.close();
    baout.close();
    data = baout.toByteArray();
    } catch (Exception e) {
    e.printStackTrace();
    }
    return data;
} 
```

**编辑：**根据要求提供有关音频格式的一些信息：

> PCM_SIGNED 44100.0 Hz，16 位，单声道，2 字节/帧，小端

在物理课上，我记得你可以通过将正弦值乘以 0 到 1 之间的数字来改变正弦波的幅度。

**编辑：更新了 16 位样本的代码：**

```
private byte[] adjustVolume(byte[] audioSamples, double volume) {
    byte[] array = new byte[audioSamples.length];
    for (int i = 0; i < array.length; i+=2) {
        // convert byte pair to int
        int audioSample = (int) ((audioSamples[i+1] & 0xff) << 8) | (audioSamples[i] & 0xff);

        audioSample = (int) (audioSample * volume);

        // convert back
        array[i] = (byte) audioSample;
        array[i+1] = (byte) (audioSample >> 8);

    }
    return array;
} 
```

如果我乘以`audioSample`，声音会严重失真`volume`。如果我不这样做并将两个数组与我进行比较，`Arrays.compare(array, audioSample)`我可以得出结论，字节数组正在正确地转换为 int，反之亦然。

有人可以帮帮我吗？我在这里做错了什么？谢谢！:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-09-25T11:33:12.303

int类型的问题，java中int的大小为4字节，样本大小为2字节

这个工作代码：

```
private byte[] adjustVolume(byte[] audioSamples, float volume) {
        byte[] array = new byte[audioSamples.length];
        for (int i = 0; i < array.length; i+=2) {
            // convert byte pair to int
            short buf1 = audioSamples[i+1];
            short buf2 = audioSamples[i];

            buf1 = (short) ((buf1 & 0xff) << 8);
            buf2 = (short) (buf2 & 0xff);

            short res= (short) (buf1 | buf2);
            res = (short) (res * volume);

            // convert back
            array[i] = (byte) res;
            array[i+1] = (byte) (res >> 8);

        }
        return array;
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-23T17:45:28.307

您确定您正在阅读 8 位单声道音频吗？否则一个字节不等于一个样本，你不能只缩放每个字节。例如，如果它是 16 位数据，您必须将每对字节解析为 16 位整数，对其进行缩放，然后将其作为两个字节写回。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-10-06T22:35:19.230

Rodion 的回答是一个很好的起点，但不足以给出好的结果。

它引入了溢出，并且对于 Android 上的实时音频来说不够快。

## TL;DR：我改进的解决方案涉及 LUT 和增益压缩

```
private static int N_SHORTS = 0xffff;
private static final short[] VOLUME_NORM_LUT = new short[N_SHORTS];
private static int MAX_NEGATIVE_AMPLITUDE = 0x8000;

static {
    precomputeVolumeNormLUT();
}    

private static void normalizeVolume(byte[] audioSamples, int start, int len) {
    for (int i = start; i < start+len; i+=2) {
        // convert byte pair to int
        short s1 = audioSamples[i+1];
        short s2 = audioSamples[i];

        s1 = (short) ((s1 & 0xff) << 8);
        s2 = (short) (s2 & 0xff);

        short res = (short) (s1 | s2);

        res = VOLUME_NORM_LUT[res+MAX_NEGATIVE_AMPLITUDE];
        audioSamples[i] = (byte) res;
        audioSamples[i+1] = (byte) (res >> 8);
    }
}

private static void precomputeVolumeNormLUT() {
    for(int s=0; s<N_SHORTS; s++) {
        double v = s-MAX_NEGATIVE_AMPLITUDE;
        double sign = Math.signum(v);
        // Non-linear volume boost function
        // fitted exponential through (0,0), (10000, 25000), (32767, 32767)
        VOLUME_NORM_LUT[s]=(short)(sign*(1.240769e-22 - (-4.66022/0.0001408133)*
                           (1 - Math.exp(-0.0001408133*v*sign))));
    }
} 
```

这很好用，可以很好地增强音频，没有剪辑问题，并且可以在 Android 上实时运行。

## 我是怎么到那里的

我的任务是封装一个专有的闭源 TTS 引擎（由客户提供），使其作为标准的 Android TextToSpeechService 工作。客户抱怨音量太低，即使流音量设置为最高。

我必须找到一种方法来实时提高 Java 的音量，同时避免剪辑和失真。

Rodion 的解决方案有**两个问题：**

1.  代码运行速度有点**慢**，无法在手机上进行实时操作（浮动很慢）
2.  它不能防止**溢出**，这可能会导致不良和明显的伪影

我来到了这个解决方案：

**计算速度**可以通过用 CPU 交换 RAM 和使用查找表 (LUT) 来提高，即预先计算每个输入短值的音量提升函数值。

**这样你牺牲了 128K 的 RAM，但在声音处理过程中完全摆脱了浮点和乘法，在我的情况下这是一个胜利。**

**至于溢出**，有两种解决方法。丑陋的一种是简单地分别用 Short.MIN_VALUE 或 Short.MAX_VALUE 替换短范围之外的值。它不会阻止剪辑，但至少它不会溢出并且伪影不那么令人不安。

但我找到了一种更好的方法，那就是**应用非线性提升**（也称为增益压缩）。您可以使用指数函数，而不仅仅是预先计算乘法 LUT，您可以预先计算非线性提升。实际上，该函数与 LUT 配合得很好，任何类似的函数都可以通过这种方式进行预计算。

找到一个好的 boost 函数和函数的最优参数的最好方法是尝试不同的函数一段时间，一个简单但很好的工具是[https://mycurvefit.com/](https://mycurvefit.com/)

其中一个功能看起来很有希望，我只需要做一个小的修改就可以使负值以对称的方式工作。

![](../Images/86f54fedb64c0e59cc99bac27486841a.png "y=\mathrm{符号}(x)\cdot \left[ y_0-\frac{v_0}{k}(1-e^{-k \cdot \mathrm{sign}(x)})\right]")

在玩了一些参数之后，我得出结论，如果函数通过[0,0]，[10000,25000]和[32767,32767]，我会得到很好的结果。

我需要相当大的音量提升，你可能想要更微妙。

MyCurveFit 给了我这组参数：y [0] = 1.240769e-22, v [0] = -4.66022, k = 0.0001408133

在 LUT 中预计算的最终提升函数如下所示：

[![音量提升函数图](../Images/3b45f79caa8c2a98115bcd09b6c58275.png)](https://i.stack.imgur.com/fOmUT.png)

**免责声明：我不是 DSP 专家，有人警告我，这样的提升不适用于 Hi-Fi 音乐等，因为它会引入音色、谐波和其他细微伪影的变化。但它速度很快，而且对我的目的来说效果很好，我认为它对于涉及语音和 Lo-Fi 的许多用途来说是可以接受的。**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-23T17:46:53.237

你确定一个字节就是一个样本吗？在此格式规范中，样本看起来有 2 个字节。并且不要忘记让标题不变。

[WAVE PCM 声音文件格式](https://ccrma.stanford.edu/courses/422/projects/WaveFormat/)

# c# - CheckBoxList 返回选中

> ID：14485874
> 
> 赞同：0
> 
> 时间：2013-01-23T17:36:54.950
> 
> 标签：c#

我在模板字段中有 CheckBoxList：

```
<asp:TemplateField HeaderText="Check Box">
        <ItemTemplate>
            <asp:CheckBoxList ID="CheckBoxList1" runat="server">
                <asp:ListItem></asp:ListItem>
            </asp:CheckBoxList>
        </ItemTemplate>
        </asp:TemplateField> 
```

我想检查是否所有复选框都已选中。如果尚未选中所有复选框，则您无法前进。

```
for (int i = 0; i < GridView1.Rows.Count; i++)
    {

        GridViewRow row = GridView1.Rows[i];

        bool isChecked = ((CheckBoxList)row.FindControl("CheckBoxList1")).Checked;

        if (isChecked)

            Response.Write("Its Checked");

        else

            Response.Write("Not Check");  

    } 
```

问题是它总是返回“已检查”，即使它不是。可能是因为我不能在模板视图中使用 CheckBoxList。Checked 显然不是方法“CheckBoxList”的属性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:40:18.770

您需要使用 CheckBoxList.SelectedItems.Count 将其与总项目进行比较，以了解是否选择了所有项目。

```
CheckBoxList CheckBoxList1 = ((CheckBoxList)row.FindControl("CheckBoxList1")).Enabled;    
int i = 0;
for(i = 0; i < CheckBoxList1.Items.Count; i++)
    if (!CheckBoxList1.Items[i].Checked)
        break;
if(i == CheckBoxList1.Items.Count)
     Response.Write("Its Checked");
else
     Response.Write("Not Check"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:47:23.170

您应该检查所有项目并计算检查了多少。然后将该值与复选框列表中的项目总数进行比较

```
 for (int i = 0; i < GridView1.Rows.Count; i++) {
        GridViewRow row = GridView1.Rows[i];  
        if(row.RowType == DataControlRowType.DataRow) {
            CheckBoxList CheckBoxList1= row.FindControl("CheckBoxList1")) as CheckBoxList;                 
           //CheckBoxList CheckBoxList1= row.Cells[cbCellIndex].FindControl("CheckBoxList1")) as CheckBoxList;                 
           int checkedCount = 0;
           foreach (ListItem item in CheckBoxList1.Items) {
               checkedCount += item.Selected ? 1 : 0;
            }
            if (checkedCount == CheckBoxList1.Items.Count) { 
                //all checked
            }
            else if (checkedCount == 0)
            {
               //none checked
            }
       }
  } 
```

并且 Enabled 只是显示用户是否可以与之交互。如果`Enabled == false`您会看到禁用的复选框

# alfresco - 露天子网站

> ID：14485885
> 
> 赞同：4
> 
> 时间：2013-01-23T17:37:46.640
> 
> 标签：alfresco, alfresco-share

几天前我安装了 Alfresco Community 4。我正在使用共享。

我想知道我是否可以在一个站点中拥有多个文档库。问题是，当创建一个新站点时，我在顶部导航栏中有一个指向文档库的链接。然后，如果我转到“自定义站点”，我可以将日历、wiki 等添加到顶部导航栏，但我希望有第二个文档库而不是其中的任何一个。

最终结果是在顶部导航栏中有 Doc library 1 和 Doc library 2。

然后，我想这更高级，但我想创建一个站点模板，这样当我创建一个新站点时，我会在顶部导航栏中自动拥有一个带有 2 个文档库的站点。

我知道可以通过在 webapp 中修改或创建 XML 文件来更改共享应用程序和功能。如果有人能指出我创建或修改的正确步骤和文件，那就太好了。

我希望我不需要安装 Eclipse、创建和编译 WAR 文件等，因为我从来没有这样做过。

我还读到 Alfresco Share 不支持子站点，但我不知道第二个文档库是否被视为子站点。也许有一些 XML 文件我可以告诉 Alfresco 的站点类型模板，而不是使用文档库、日历、Wiki 等创建站点。只需创建一个具有 2 个文档库的站点 :)

谢谢。此致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T18:34:24.040

您无法开箱即用或仅通过配置来实现此目的。您将需要进行自定义。恐怕你将不得不去面对你未知的 java-path :(

# xml - 使用 XPath 在 XML 中查找相同级别的前任

> ID：14485886
> 
> 赞同：0
> 
> 时间：2013-01-23T17:37:47.260
> 
> 标签：xml, xpath, html-parsing

我有一个试图从中获取一些数据的 XML 文档。我有一个已知数量，并且在同一级别和未知数量。所以格式看起来像这样：

```
<header>Unknown Item</header>
<title>Known Item</title> 
```

这是非常简化的版本。现在我可能连续拥有任意数量的这种格式，但我想要做的是给定已知项目，这使我能够导航到该节点，使用内置方式获取最近的相同 -级别的前任。每对已知项和未知项在域空间中联系在一起，但在 XML 中没有。

如果相关，这是在 Scala 中使用 Saxon 作为我的解析器完成的，处理干净的 HTML。然而，这似乎是一个相当抽象的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:42:59.550

听起来好像您想访问`preceding-sibling::header[1]`例如

```
<xsl:template match="title">
  <xsl:variable name="header" select="preceding-sibling::header[1]"/>
</xsl:template> 
```

# entity-framework - Breeze 是否适用于按层次结构表 (TPH)

> ID：14485889
> 
> 赞同：1
> 
> 时间：2013-01-23T17:37:52.577
> 
> 标签：entity-framework, breeze, table-per-hierarchy

我正在尝试将 BreezeJs 插入现有数据结构并在元数据获取中出错。我可以通过将以下内容添加到 CarBones 示例来复制它

```
namespace CarBones.Models
{
  public abstract class VanBase
  {
    public int Id { get; set; }
    public string Manufacturer { get; set; }
    public int Wheels { get; set; }
  }

  public class BasicVan : VanBase
  {

  }

  public class LiveriedVan : VanBase
  {
    public string Livery { get; set; }
  }
} 
```

然后在上下文中

```
 public DbSet<VanBase> Vans { get; set; } 
```

这足以触发

```
未捕获的类型错误：无法读取未定义的轻风.debug.js 5224 的属性“propertyRef”

```

我不能以这种方式将 TPH 与 Breeze 一起使用吗？然而？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:58:25.303

## 编辑：从 v 1.3.1 起，Breeze 现在支持继承。

Breeze**还不**支持继承。虽然它在我们的列表中，所以请在[此处](https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions/suggestions/3083057-support-inheritence-in-the-object-model)的 Breeze 用户语音上投票，以便我们可以正确地优先考虑各种请求的附加微风功能。我们非常重视这个场地。

# iphone - 以编程方式了解应用程序是否可以接收推送通知

> ID：14485894
> 
> 赞同：1
> 
> 时间：2013-01-23T17:38:13.083
> 
> 标签：iphone, ios, notifications, push-notification, apple-push-notifications

有没有办法让应用程序以编程方式知道它是否可以接收推送通知？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:45:40.130

最初，您需要尝试注册以接收推送通知。

```
[[UIApplication sharedApplication]registerForRemoteNotificationTypes:(UIRemoteNotificationTypeAlert)]; 
```

如果有可能您将收到成功的委托方法

```
- (void)application:(UIApplication *)app didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)devTokenLocal 
```

如果不可能，您将收到失败委托方法。请注意，您可以分析错误消息以获取更具体的信息

```
-(void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error
{} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-27T11:04:42.467

您可以使用

```
[[UIApplication sharedApplication] isRegisteredForRemoteNotifications] 
```

# maven - Maven Yui Compressor 插件未在进程资源上运行

> ID：14485902
> 
> 赞同：0
> 
> 时间：2013-01-23T17:38:56.353
> 
> 标签：maven, yui, yui-compressor

我已经明确说明了这个插件的过程资源，即使根据文档这不是必需的：http: [//alchim.sourceforge.net/yuicompressor-maven-plugin/usage_compress.html](http://alchim.sourceforge.net/yuicompressor-maven-plugin/usage_compress.html)

运行时：

```
mvn net.alchim31.maven:yuicompressor-maven-plugin:compress 
```

它运行良好。

运行时：

```
mvn process-resources 
```

它没有运行，即使我在这个阶段拥有的 exec 插件确实有效。

这是我的 pom.xml 的相关部分：

```
<plugin>
        <groupId>net.alchim31.maven</groupId>
        <artifactId>yuicompressor-maven-plugin</artifactId>

        <executions>
          <execution>
                <phase>process-resoures</phase>
            <goals>
              <goal>compress</goal>
            </goals>
          </execution>
        </executions> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T03:09:16.303

至少在您发布的代码中看起来像一个小错误。

应该`<phase>process-resources</phase>`不是`<phase>process-resoures</phase>`

# testing - 使用存根服务进行测试

> ID：14485904
> 
> 赞同：1
> 
> 时间：2013-01-23T17:38:58.323
> 
> 标签：testing, integration-testing

我创建了一个存根 Web 服务来帮助我的团队实现和“集成”测试他们的代码，而无需遍历整个堆栈，这在这种情况下是不可能的。

我想为他们创建一些不同的场景，例如成功、不同类型的失败。我考虑过处理这些场景的一种方法是，如果特定输入是例如“Smith”，则返回一个对象，如果“Jones”返回另一个对象。

我想知道这个场景映射是否太脆弱，但主要是我如何以一种允许开发人员扩展场景的好方式管理这些场景。一个想法是序列化他们期望的可能结果，并将它们与参数一起存储在某种存储库中。这意味着可以添加和修改它们。序列化可能会中断，对于复杂的对象来说会很尴尬。

感觉我真的在这里错过了一些东西！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T04:55:36.787

我真的很喜欢在开发过程中剔除 Web 服务之类的东西。它允许开发人员针对可能尚未准备好但仍能完成工作的系统。就像你说的那样，这也让他们能够尽早整合，这很棒。当实际服务准备就绪时，应该很容易将存根换成实际服务。

我认为创建一个模拟实际 Web 服务调用的简单/快速而肮脏的存储库是完全可以的。一组参数进入，然后一些数据返回。

考虑花几个小时编写一个为您生成代码/数据结构的工具。您可以编写生成随机数据（姓名、地址等）的函数，然后很容易更改参数并重新生成存根数据/存根代码。

剔除东西是值得的，因为它会显着提高开发人员的生产力。我不会害怕花一两天时间来设置一些东西——它会在项目的整个生命周期中得到回报。

# winforms - Managed.Windows.Forms 可以在 MonoTouch 中使用吗？

> ID：14485907
> 
> 赞同：3
> 
> 时间：2013-01-23T17:39:08.553
> 
> 标签：winforms, xamarin.ios, monomac

我有一个要移植到 Mono 的 .NET 应用程序，因此它可以在 Mac 和 iOS 上运行。目前，我的应用程序使用 System.Windows.Forms 来处理鼠标和键盘事件。在 MonoMac 中，我知道我可以通过最小的调整来移植代码，但我可以用 MonoTouch 做同样的事情吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T18:11:00.753

System.Windows.Forms 不能使用 MonoTouch 在 iOS 上运行，因为它（当前）依赖于仅存在于 OS X 上的 Carbon api。Windows Forms 是一个桌面 UI，即使它确实通过 MonoTouch 在 iOS 上运行，您的应用程序至少可以说是无法使用的。

您需要重新编写 UI 以使用 MonoTouch api，这将为用户提供更好的体验。

# maven - 如何使用 maven ant 任务安装/部署源 jar

> ID：14485909
> 
> 赞同：2
> 
> 时间：2013-01-23T17:39:10.317
> 
> 标签：maven, ant, maven-ant-tasks

我很难理解如何安装或部署 jar 文件及其随附的源（或任何其他分类器）。[文档](http://maven.apache.org/ant-tasks/reference.html)对我来说不是很清楚，让我做一些试验和错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T17:39:10.317

以下是如何将分类器与 maven ant run 任务一起使用的示例：

```
<target name="install-jar">
    ...
    <artifact:pom id="sharedPom" file="shared/pom.xml" />
    <artifact:install file="${classesdir}/shared.jar" >
        <pom refid="sharedPom" />
        <attach file="${builddir}/shared-sources.jar" classifier="sources" />
    </artifact:install>
</target> 
```

[文档](http://maven.apache.org/ant-tasks/reference.html)中引用的附件是一个子元素。希望这可以帮助。

# xaml - 在没有图形 UI 的情况下渲染 Visiblox 图表以报告服务会引发 NullReferenceException

> ID：14485913
> 
> 赞同：0
> 
> 时间：2013-01-23T17:39:19.083
> 
> 标签：xaml, styles, report, visiblox

我有一个非常简单的 Visiblox 图表，效果很好：

```
<charts:Chart Grid.Row="1" Height="100" x:Name="VisiChart">
    <charts:Chart.Series>
        <charts:LineSeries/>
    </charts:Chart.Series>
</charts:Chart> 
```

我`DataSeries`在代码隐藏中设置了我的：

```
VisiChart.Series[0].DataSeries = MyDataSeries; 
```

就那么简单。

我可以使用此方法从视觉元素中获取位图：

```
private static RenderTargetBitmap AsBmpToClipboard(FrameworkElement element)
{
    var width = (int)Math.Round(element.ActualWidth);
    var height = (int)Math.Round(element.ActualHeight);
    var bmpCopied = new RenderTargetBitmap(width, height, 96, 96, PixelFormats.Default);
    var dv = new DrawingVisual();
    using (var dc = dv.RenderOpen())
    {
        var vb = new VisualBrush(element);
        dc.DrawRectangle(vb, null, new Rect(new Point(), new Size(width, height)));
    }
    bmpCopied.Render(dv);
    Clipboard.SetImage(bmpCopied); // clipboard it for testing reasons
    return bmpCopied;
} 
```

现在我在报告或其他什么中使用这个位图。这行得通。

我的问题来了：如果我想在没有 GUI 的情况下使用图表图像创建报告（在服务器应用程序中，例如 Windows 服务或 IIS 中），我会`NullReferenceException`从图表中得到一个。

我所做的是创建包含图表的控件。然后我调用`Measure()`控件使其工作。这就是我得到的地方：

```
NullReferenceException
at Visiblox.Charts.Chart.OnApplyTemplateInternal()
   at Visiblox.Charts.ChartBase.OnApplyTemplate()
   at System.Windows.FrameworkElement.ApplyTemplate() 
```

我想我必须手动设置图表的模板，但是在哪里可以找到 VisiBlox 的默认模板？我该如何应用它们？还是有其他问题？

非常感谢。

- - 编辑 - -

**所以，我想如果我在控制台应用程序**中的 VisiBox 图表（或包含图表的元素）上调用 Measure()，我总是会得到这个异常。所以我也可以将此问题的标题更改为**如何在控制台应用程序中使用 VisiBlox 图表**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T12:23:22.520

好的，我想出了答案：

1）将visiblox的东西包装在

```
InvalidationHandler.ForceImmediateInvalidate = true;
// here comes the chart
InvalidationHandler.ForceImmediateInvalidate = false; 
```

告诉它实际渲染。

2）手动设置数据，而不是通过DataContext。如果组件未显示，则可能未连接。

3）手动设置图表的样式。默认值位于 Visiblox Generic.xaml 文件中的某个位置。

# c# - 在 System.Deployment 中找不到 ApplicationDeployment

> ID：14485914
> 
> 赞同：8
> 
> 时间：2013-01-23T17:39:19.473
> 
> 标签：c#, wpf, clickonce

我有一个内置程序，我正在尝试用硬编程的程序更改默认的 clickOnce 更新检查器。我已经添加了，`using System.Deployment;`但它不包含我需要调用的程序集信息。我在这里想念什么？我搜索了 MSDN，但它一直说这是要调用的正确命名空间。

错误显示为： `The name ApplicationDeployment does not exist in the current context`

程序代码：

```
 private void UpdateApplication()
    {
        if (ApplicationDeployment.IsNetworkDeployed)
        {
            ApplicationDeployment ad = ApplicationDeployment.CurrentDeployment;
            ad.CheckForUpdateCompleted += new CheckForUpdateCompletedEventHandler(ad_CheckForUpdateCompleted);
            ad.CheckForUpdateProgressChanged += new DeploymentProgressChangedEventHandler(ad_CheckForUpdateProgressChanged);

            ad.CheckForUpdateAsync();
        }
    } 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-23T17:42:37.660

`ApplicationDeployment`类存在于`System.Deployment.Application`命名空间中，而不是`System.Deployment`. 相应地更改您的使用或尝试使用全名`System.Deployment.Application.ApplicationDeployment`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-23T17:42:38.527

您还需要添加`using System.Deployment.Application;`。

# c# - 将没有键的现有表添加到实体框架模型

> ID：14485915
> 
> 赞同：0
> 
> 时间：2013-01-23T17:39:21.273
> 
> 标签：c#, entity-framework

我有一个旧表，需要通过 VS2012 添加到我的 EDM 中。我已经通过“从数据库更新模型”菜单选项更新了模型。这会引发无法推断密钥的错误，并将重新标记的代码添加到 SSDL。我已经看到在 EDM 文件中创建复合键以允许添加表（只读，这很好）但无法使其工作的参考。

它涉及取消标记 SSDL、添加 CSDL 条目和 CS 映射。

但是在尝试运行有关表不在元数据中的应用程序时，我仍然会遇到错误。

有什么建议或指示吗？在这种情况下，无法向实际表添加键。

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:23:46.223

本文详细介绍了如何使其工作。 [http://pratapreddypilaka.blogspot.in/2012/04/entity-framework-adding-datatable-with.html](http://pratapreddypilaka.blogspot.in/2012/04/entity-framework-adding-datatable-with.html)

# jquery - 100% 高度滑动切换

> ID：14485917
> 
> 赞同：0
> 
> 时间：2013-01-23T17:39:25.423
> 
> 标签：jquery, slidetoggle

我正在尝试使用 jQuery 创建一个简单的 slideToggle 效果，以便用户可以单击页脚中的链接，并且一个框会全屏滑动。

当内容很少时，这很有弹性 - 请参阅此链接：

[http://bringontheweb.ca/less-content/](http://bringontheweb.ca/less-content/)

它开始失败，但是主体中的内容更大，并且当用户向下滚动页面时 - 请参阅此链接：

[http://bringontheweb.ca/more-content/](http://bringontheweb.ca/more-content/)

我知道这是因为它从页面底部开始的 slideToggle 开始，但我不知道如何检查它，或者用一些 jQuery 魔法来防止它。

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:46:34.233

给`.about`，`.contact` `position : fixed;`而不是`position : absolute;`

# c# - 本地文件夹在 Windows 8 中消失

> ID：14485918
> 
> 赞同：3
> 
> 时间：2013-01-23T17:39:25.963
> 
> 标签：c#, visual-studio, windows-8, winrt-xaml, windows-store-apps

我`Windows.Storage.ApplicationData.Current.LocalFolder`用于存储 SQLite 数据库和其他文件。它工作正常，但有时文件夹会消失。

我可以使用 Windows 资源管理器检查它并转到 `C:\Users\John\AppData\Local\Packages`

我怀疑它在我调试我的应用程序时消失了，也许我关闭了它，或者其他类似的事情，但我不确定。

有人知道在什么情况下 Windows 8 可以删除本地文件夹？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T19:38:02.113

确保在调试时没有清除应用程序状态！这是项目属性页面中的设置。它看起来像这样。`uninstall and then re-install my package`不应该在你的情况下检查！

![在此处输入图像描述](../Images/010d0af9e5a313b3cdc479ffcdc666d1.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:47:22.100

当我删除 obj/bin 文件夹时，这发生在我身上。Visual Studio 将在那里创建一个新文件夹并丢弃旧文件夹。

这似乎是 Visual Studio 发现它需要卸载/安装您正在开发的应用程序。卸载应用程序意味着删除旧文件夹及其内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T19:14:37.240

因此，我使用相同的位置来存储文件，这对我的应用程序很重要，并且有几次遇到相同的问题-所有文件有时都消失了-但是在阅读了这篇文章后，我意识到了一些事情-是的 @McAden 是对的-Visual Studio 重新安装了您的应用程序- 对我来说，每次我将某些内容更改为应用程序清单时都会发生这种情况 - 就是这样 - 每次您将某些内容更改为应用程序清单时，Visual Studio 都会重新安装应用程序，并且您会丢失 ApplicationData.Current.LocalFolder 中的所有数据 - 这是与我的交易-我希望它对某人有所帮助。

# ios - Facebook SDK iOS 应用在应用退出时保持登录状态

> ID：14485919
> 
> 赞同：0
> 
> 时间：2013-01-23T17:39:27.280
> 
> 标签：ios, facebook, sdk, facebook-ios-sdk

目前我正在使用下面的 if 语句来检查用户是否通过我的应用程序与 facebook 有一个开放的会话。

```
if (FBSession.activeSession.isOpen) {
     // post to wall
}
else {
     [appDelegate openSessionWithAllowLoginUI:YES];
} 
```

如果用户退出应用程序，则会话关闭并且我的 if 语句打开一个新会话，但是即使用户退出应用程序，我也希望保持会话打开。

我尝试从中删除`[FBSession.activeSession close]`，`applicationWillTerminate:`但这没有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T12:01:35.007

您无法完全注销。但是您可以通过以下代码清除上次会话的所有细节。

```
[FBSession.activeSession closeAndClearTokenInformation]; 
```

您可以根据您的要求在 applicationDidEnterBackground 或 applicationWillTerminate 中编写它。

谢谢

# php - PHP Web 表单转 CSV 格式错误

> ID：14485922
> 
> 赞同：1
> 
> 时间：2013-01-23T17:39:52.093
> 
> 标签：php, csv, handle

我创建了一个基于 Web 的打印日志，它使用 PHP 将表单数据发送到 .CSV 文件。一切似乎都正常工作。虽然，我发现了一个我似乎无法解决的小错误（还）。

打印日志中有七个条目提交到 .CSV 文件。其中两个条目是从每天更新的两个不同 .DAT 文件中填充的下拉列表。

问题：

成功提交表单数据并打开 .CSV 文件后，我注意到使用下拉列表的两个实体的格式与其余数据不同。

您可以通过查看以下屏幕截图来了解我的意思：http: [//i49.tinypic.com/2n87eko.jpg](http://i49.tinypic.com/2n87eko.jpg)

我相信问题来自以下代码，该代码提取了“项目编号”和“员工姓名”下拉框数据：

```
<?php
$file = 'dat_files/Employees.dat';

$handle = @fopen($file, 'r');
if ($handle) {
   while (!feof($handle)) {
       $line = fgets($handle, 4096);
       $item = explode('|', $line);
       echo '<option value="' . $item[0] . '">' . $item[0] . '</option>' . "\n";
   }
   fclose($handle);
}
?> 
```

任何帮助或想法将不胜感激。谢谢你。

下面是用于将表单数据发送到 .CSV 文件的代码。

```
 <?php

if(isset($_POST["submit"]))
{ 
    $type = $_POST["type"]; 
    $date = $_POST["date"]; 
    $job_number = $_POST["job_number"]; 
    $phase = $_POST["phase"];
    $task = $_POST["task"];
    $number_copies = $_POST["number_copies"];
    $name = $_POST["name"];

    if(empty($type)||empty($date)||empty($job_number)||empty($phase)||empty($task)||empty($number_copies)||empty($name))  
    { 
        header('Location: submit/unsuccessful.htm'); 
        die; 
    } 
    $cvsData = "\"$type\",\"$date\",\"$job_number\",\"$phase\",\"$task\",\"$number_copies\",\"$name\"".PHP_EOL; 
    $fp = fopen("log.csv", "a"); 

    if($fp) 
    { 
        fwrite($fp,$cvsData); // Write information to the file 
        fclose($fp); // Close the file 
        header('Location: submit/successful.htm');

    }
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T18:01:35.397

我在猜测，但我不确定您显示的代码是将数据回显到屏幕截图中显示的表格内的屏幕的代码。如果这是真的，那么所有选项标签都是关于什么的？

如果不是真的，那么我们可能需要查看更多源代码来帮助您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T18:53:03.063

当我运行您的代码时，我没有在生成的 CSV 文件中看到任何额外的换行符。也许是因为您的 Excel 格式已关闭？尝试在 Excel 中突出显示下拉列，然后单击鼠标右键。选择“格式化单元格”。然后转到“对齐”选项卡。取消选中“文本控件”部分下的“自动换行”。

# jquery - 带有按钮的 Jquery removeclass

> ID：14485925
> 
> 赞同：2
> 
> 时间：2013-01-23T17:39:55.920
> 
> 标签：jquery, html

如何定位具有特定类的所有按钮的子集？我想要完成的是，一次只能选择一个带有 P 或 S 的按钮。如果用户单击特定的“P”按钮，它会从每个其他“P”按钮中删除突出显示类，与“S”相同。

[http://jsbin.com/adopuz/1/edit](http://jsbin.com/adopuz/1/edit)

```
$(':button').on('click', function() {

      var typeid = $(this).attr('value');
      $(this).addClass('highlight');

      if(typeid == 'P') {
        $('.primary').val(0);

        $(':button').removeClass('highlight');

        var opts = $(this).parent().find('input').eq(0).val(1);

      }

      if(typeid == 'S') {

      $('.static').val(0);
      var optp = $(this).parent().find('input').eq(1).val(1);

      }

    }); 
```

## HTML

```
 <div id= "US">
    This is the US
  <div id="Monday">

<input name='' value='1' class="primary" type=''>
<input name='' value='0' class="static" type=''>

<input type='button' value='P' class='P'>
<input type='button' value='S' class='S'>

  </div>

    <div id="Tuesday">

<input name='' value='1' class="primary" type=''>
<input name='' value='0' class="static" type=''>

<input type='button' value='P' class=''>
<input type='button' value='S' class=''>

  </div>

      <div id="Wednesday">

<input name='' value='1' class="primary" type=''>
<input name='' value='0' class="static" type=''>

<input type='button' value='P' class=''>
<input type='button' value='S' class=''>

  </div>
  </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:50:06.193

您的意思是您希望能够仅突出显示具有“P”类的人的一个按钮。与“S”类按钮相同吗？

以选择所有具有“P”类的按钮为例，将代码从 稍微更改`$(':button')`为`$(':button.P')`，这意味着获取所有具有“P”类的按钮。

[演示](http://jsfiddle.net/WaBQ2/)

```
 if(typeid == 'P') {
    $('.primary').val(0);   
    $(':button.P').removeClass('highlight');  
    var opts = $(this).parent().find('input').eq(0).val(1);

  }

if(typeid == 'S') { 
  $('.static').val(0);      
  $(':button.S').removeClass('highlight');     
  var optp = $(this).parent().find('input').eq(1).val(1);  
  }
    $(this).addClass('highlight'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:48:43.020

[http://jsbin.com/adopuz/3/edit](http://jsbin.com/adopuz/3/edit)

您可以使用类选择器过滤您的 :button 选择，例如`:button.P` 您可以使用 jquery 长格式进行操作，如果您希望它更具可读性，使用`$(':button').filter('.P')`

看来我的更改没有保存。不知道这是怎么回事！但是我`.P`在顶部块中添加了您的过滤器，您`removeClass`在底部添加了相同的行，但用于`.S`. 我还添加了类`P`和`S`你所有的按钮。最后，我将您的`addClass`呼叫移至页面底部，因此您`removeClass`不会意外删除新单击的按钮！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T18:02:12.457

首先，您的 HTML 中有一个小错误：您只在前几个按钮中设置了“P”或“S”类。下一个有 '' 作为类。您必须设置类才能使以下代码正常工作。

修复了这个问题，您应该首先取消设置所有“突出显示”类，然后设置您感兴趣的类：

[http://jsbin.com/adopuz/8/edit](http://jsbin.com/adopuz/8/edit)

```
$(':button').on('click', function() {

  var typeid = $(this).attr('value');

  if(typeid == 'P') {
    $('.primary').val(0);

    $(':button.P').removeClass('highlight');
    $(this).addClass('highlight');

    var opts = $(this).parent().find('input').eq(0).val(1);
  }

  if(typeid == 'S') {
    $('.static').val(0);

    $(':button.S').removeClass('highlight');
    $(this).addClass('highlight');

    var optp = $(this).parent().find('input').eq(1).val(1);
  }
}); 
```

# algorithm - 密码算法加密作业

> ID：14485932
> 
> 赞同：0
> 
> 时间：2013-01-23T17:40:31.060
> 
> 标签：algorithm, encryption, cryptography, password-encryption

作为作业的一部分，我们被要求编写自己的密码算法来加密密码。

我们不允许使用任何预定义的方法，例如`md5`或`sha1`等，谷歌似乎没有帮助，有人可以给我看一个链接到一些信息的例子吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T18:14:59.210

我将假设您被要求提出一个[加密散列函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)。您可以从这篇 Wikipedia 文章开始，看看不同的现有加密哈希函数及其构造原理；维基百科有相当详细的解释和一些很好的链接。这里有一些你应该阅读的文章。

*   [加密哈希函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)
*   [碰撞阻力](http://en.wikipedia.org/wiki/Collision_resistance)
*   [碰撞攻击](http://en.wikipedia.org/wiki/Birthday_attack)
*   [生日攻击](http://en.wikipedia.org/wiki/Birthday_attack)
*   [原像攻击](http://en.wikipedia.org/wiki/Preimage_attack)
*   [雪崩效应](http://en.wikipedia.org/wiki/Avalanche_effect)
*   [Merkle-Damgård 构造](http://en.wikipedia.org/wiki/Merkle%E2%80%93Damg%C3%A5rd_construction)
*   [单向压缩功能](http://en.wikipedia.org/wiki/One-way_compression_function)
*   [MD5](http://en.wikipedia.org/wiki/MD5)
*   [SHA-1](http://en.wikipedia.org/wiki/SHA-1)
*   [SHA-2](http://en.wikipedia.org/wiki/SHA-2)

这应该让您对 MD4 系列的常用加密哈希函数有所了解。还有其他方法可以构造加密哈希函数，例如使用[SHA-3](http://en.wikipedia.org/wiki/SHA-3)中的[海绵构造](http://en.wikipedia.org/wiki/Sponge_function)。

在阅读所有这些内容时，您可能很快就会意识到您想出自己的（未完全损坏的）加密哈希函数的机会非常接近于零，但您至少会学到一些关于这个主题的知识。

最后一个想法 - 看看现有的针对密码原语的攻击特别有启发性，因为它们通常利用许多聪明人以前错过的微小细节，或者提供一种完全不同的方式来看待某事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T23:29:24.550

[我在这篇博](http://cipriano-sanchez.blogspot.de/2010/11/blog-post.html)文中解释了 AES ECB 的实现。[在另一个中，对AES Round Steps](http://cipriano-sanchez.blogspot.de/2010/11/aes-round-steps.html)有更技术性的解释。同样在[这里，](http://cipriano-sanchez.blogspot.de/search/label/aes)您可以找到它的 C 实现。

我希望它有帮助

# logging - 使用 CacheEventListener 在 EhCache 中记录驱逐

> ID：14485933
> 
> 赞同：2
> 
> 时间：2013-01-23T17:40:31.303
> 
> 标签：logging, ehcache, event-listener

我正在尝试`EhCache`在我的项目中使用 Tomcat 6。我使用的 EhCache 是 1.4 版，因为它已经在我的 Hibernate 项目中使用。我已经编写了自己的自定义 CacheEventListener（包括在下面），除了`notifyElementExpired()`. 似乎`notifyElementExpired()`只有在我向缓存中添加其他内容时才会调用它。在旁注中，`notifyElementPut()`被调用了。

有人可以提出解决方案吗？

```
public class EhCacheEventListener implements CacheEventListener {
  private Logger log4j =
    LoggerFactory.getLogger(this.getClass().getPackage().getName());   

  public void notifyElementRemoved(Ehcache cache, Element element) throws CacheException {
    log4j.debug("cache element removed---->"+element.getKey());
  }

  public void notifyElementPut(Ehcache cache, Element element) throws CacheException {
    log4j.debug("cache element put---->"+element.getKey());
  }

  public void notifyElementUpdated(Ehcache cache, Element element) throws CacheException {
    log4j.debug("cache element updated---->"+element.getKey());
  }

  @Override
  public void notifyElementExpired(Ehcache cache, Element element) {
    //log4j.debug("Element creation time is "+element.getCreationTime());
    log4j.debug("cache element expired---->"+element.getKey());
    //log4j.debug("Element expiry time is "+element.getExpirationTime());
  }

  @Override
  public void notifyElementEvicted(Ehcache cache, Element element) {
    log4j.debug("cache element evicted---->"+element.getKey());
  }

  public void notifyRemoveAll(Ehcache cache) {}

  public void dispose() {}

  public Object clone(){
    throw new UnsupportedOperationException("Not supported yet.");
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-03T09:02:26.193

`ehcache`在以下时间检查元素是否过期：

当发出`get`请求时，当元素根据`MemoryStore eviction policy`. 在`DiskStore`到期线程运行时，默认为

```
Cache.DEFAULT_EXPIRY_THREAD_INTERVAL_SECONDS 
```

有关更多详细信息，请查看：[ehCache 文档](http://ehcache.org/apidocs/net/sf/ehcache/event/CacheEventListener.html#notifyElementExpired%28net.sf.ehcache.Ehcache,%20net.sf.ehcache.Element%29)

# excel - Excel 2010 从不同的单元格中查找值和复制值

> ID：14485935
> 
> 赞同：0
> 
> 时间：2013-01-23T17:40:38.847
> 
> 标签：excel, excel-formula

我正在尝试从一列中查找一个值，如果找到，则将第二列中的相应单元格复制到新单元格。

B 列是名称列表 M 列是另一个名称列表，也可以在 B 列中找到，并且该列表在 L 列中具有与其关联的 ID #。

我想做的是以下内容；如果在 M 列中找到 B2 中的值，则将 L 中的相邻单元格复制到所查找名称旁边的 A 列。

关于 M 列中名称的一个注释，它们有点偏离，但可以通过在 B 列的单元格中抓取 X 个字符来匹配。

到目前为止，我想出了以下内容：

```
 =INDEX($L$1:$L$130,SMALL(IF(ISNUMBER(SEARCH(LEFT($B2,10),$M$1:$M$130)),MATCH(ROW($M$1:$M$130),ROW($M$1:$M$130))),ROW(A1))) 
```

想法或建议..如果有更好的方式我游戏。我发现上面搜索谷歌并在昨天工作。我不确定我是否完全理解最后的 ROW(A1)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T19:14:48.913

最简单的解决方案是将列 L 移动或复制到列 M 的右侧并进行简单的查找。例如，如果您将 L 列复制到 N 列，则单元格 A2 中的公式将是：

=IFERROR(VLOOKUP(LEFT(B2,10),$M$1:$N130,2,0),"-")

如果您需要将帮助列进一步向右移动，您只需扩大查找范围以包含该列，并调整索引号（此处为 2）以返回该列。

如果您不能或不想将 L 列移动或将其复制到 N 列的右侧，则此公式将起作用：

```
=IFERROR(INDEX($L$1:$L$130,MATCH(LEFT(B2,10),$M$1:$M$130,0)),"-") 
```

您会看到我已将两个公式都包装在 IFERROR 中以处理不匹配项。

正如 BarryHoudini 在他的评论中指出的那样，如果单元格 B2 中的值与单元格 M1:M130 中的完整值不匹配，即如果这些单元格中的值在前 10 个之后有其他字符，则 LEFT(B2,10)上述公式中应改为 LEFT(B2,10)&"*"。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:15:03.563

这应该做的工作：

```
=INDEX($L:$L,MATCH(左($B2,10),$M:$M,0))

```

# git - 合并到master后自动删除git分支

> ID：14485936
> 
> 赞同：36
> 
> 时间：2013-01-23T17:40:43.810
> 
> 标签：git, github, branching-and-merging

我们将在 github 中尝试一个工作流程，其中每个工单都是 master 的一个分支。
票证完成后，工作被合并到 staging 中，在将其合并到 master 之前执行回归和集成测试。

合并将开始建立后，团队负责人提出了旧票证分支的问题。

我找到[了这个](http://clauswitt.com/Removing-Unused-git-branches-Automatically.html)脚本，想知道这是否适用于我们的环境。我们只想删除已经合并到 master 中的分支。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2019-08-02T14:12:43.790

Github 发布了一项功能，任何对存储库具有管理员权限的人都可以将分支配置为在合并拉取请求后自动删除。以下是步骤-

1.  导航到存储库的主页，然后单击设置。
2.  在“合并按钮”下，您可以选择或取消选择“自动删除头分支”选项。

此[功能](https://help.github.com/en/articles/managing-the-automatic-deletion-of-branches)已由 Github 于 2019 年 7 月 31 日发布。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-23T17:52:27.593

据我所知，您的用例没有现成的脚本。您必须为此创建自己的工具。

Vincent Driessen有一个名为[git-flow](https://github.com/nvie/gitflow)的工具，该工具旨在帮助开发人员遵循[*“成功的 Git 分支模型”*](http://nvie.com/posts/a-successful-git-branching-model/)中描述的 git 工作流程。

这不像在合并后删除分支那么容易，因为您永远不知道是否会遇到合并冲突。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2020-12-16T08:09:30.287

Github UI 中有一个选项可供存储库管理员配置。

在“合并按钮”下，选择或取消选择自动删除头分支。

[https://docs.github.com/en/free-pro-team@latest/github/administering-a-repository/managing-the-automatic-deletion-of-branches](https://docs.github.com/en/free-pro-team@latest/github/administering-a-repository/managing-the-automatic-deletion-of-branches)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-03T12:33:45.143

将以下任一内容添加到您的`.gitconfig`文件中，以便使用 1 命令轻松合并和删除分支。

别名作为函数：

```
[alias]
  ff = "!f() { git merge $1; git branch -d $1; }; f" 
```

别名为新的 shell 命令：

```
[alias]
  ff = !sh -c 'git merge $1 && git branch -d $1' -- 
```

他们都做完全相同的事情，只是两种不同的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-11-11T12:15:47.607

据我所知，目前最好的选择是一个名为[delete-merged-branch](https://github.com/apps/delete-merged-branch/)的 GitHub 应用程序。它可以作为现有应用程序安装轻松集成到选定的存储库中，但它的[源代码也是可用](https://github.com/SvanBoxel/delete-merged-branch)的。此应用程序将在通过 PR 合并后自动删除分支。

# javascript - 在 asp.net 文本框中只允许 MM/YYYY 日期格式

> ID：14485937
> 
> 赞同：0
> 
> 时间：2013-01-23T17:40:47.677
> 
> 标签：javascript, jquery, html

我有一个要求，应允许用户在 asp.net 文本框中仅输入 MM/YYYY 日期格式（例如：12/2013）。我想通过客户端编码（而不是通过后面的代码）来实现这一点。已经苦苦挣扎了很长时间，非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-23T17:45:35.543

如果用户手动输入这个，那么你会想要使用一个像这样的 jQuery Masking 插件：http: [//digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

这将强制执行您想要的格式，只需说： $(selector).mask("99/9999"); 它还会自动为您添加斜线，并且只允许数字字符。

如果你想要一个日历小部件，这个解决方案可以与 jQuery UI Datepicker 很好地结合起来，它也可以限制用户的输入：http: [//jqueryui.com/datepicker/](http://jqueryui.com/datepicker/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:49:19.540

使用[jQuery datepicker](http://jqueryui.com/datepicker/)并更改日期格式：

```
$( "#textbox" ).datepicker({"dateFormat", "dd/yy"}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-07T19:32:39.790

最后这对我有用。

```
<asp:MaskedEditExtender ID="meeMonthYear" runat="server" 
     TargetControlID="txtMonthYear" Mask="99/9999" MaskType="None" 
     InputDirection="RightToLeft"></asp:MaskedEditExtender> 
```

# php - PHP regex preg_match_all 贪婪修饰符

> ID：14485938
> 
> 赞同：0
> 
> 时间：2013-01-23T17:40:48.253
> 
> 标签：php, regex, html-parsing, greedy

这是我的代码：

```
echo "<br />";
preg_match_all("|<[^>]+>.*</[^>]+>|U",
    "<b>example:</b><strong>this is a test</strong>",
    $out, PREG_PATTERN_ORDER);
print_r($out);
echo "<br />";

echo "<br />";
preg_match_all("|<[^>]+>.*</[^>]+>|",
    "<b>example:</b><strong>this is a test</strong>",
    $out, PREG_PATTERN_ORDER);
print_r($out);
echo "<br />"; 
```

有一点我不明白。当正则表达式末尾有 U 时会有什么不同？

输出是：

> 数组（[0] => 数组（[0] => 示例：[1] => 这是一个测试））
> 
> 数组（[0] => 数组（[0] => 示例：这是一个测试））

那么这里到底发生了什么？哪个版本是贪婪版本，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:50:41.907

U 告诉您的正则表达式为“不贪婪”。贪婪意味着尝试尽可能多地匹配，而“不贪婪”只接受最小的匹配。

所以在贪婪的例子中，你的比赛是：

```
<b>example:</b><strong>this is a test</strong> 
```

我假设 html 标签`"</b><strong>"`在您输出时或已被 preg_match 删除。

相反，不贪心的人通过这样的匹配来做你想做的事：

```
<b>example:</b>, <strong>this is a test</strong> 
```

编辑：

使用 ? 实现类似的匹配 你可以做：

```
preg_match_all("|<[^>/]+>.*?</[^>]+>|",
    "<b>example:</b><strong>this is a test</strong>",
    $out, PREG_PATTERN_ORDER);
print_r($out); 
```

这是因为`.*?`将尝试将标签之间的内容限制为尽可能短（不贪婪），因此再次导致两个匹配项。

# c# - XML 反序列化为对象。如何构造对象

> ID：14485943
> 
> 赞同：0
> 
> 时间：2013-01-23T17:41:02.930
> 
> 标签：c#, xml, deserialization, xml-deserialization

我想将以下 XML 反序列化为 C# 中的对象类：

```
<?xml version="1.0" encoding="UTF-8"?>
    <ern:NewReleaseMessage xmlns:ern="http://ddex.net/xml/2010/ern-main/32"
                           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                           LanguageAndScriptCode="en"
                           xsi:schemaLocation="http://ddex.net/xml/2010/ern-main/32 http://ddex.net/xml/2010/ern-main/32/ern-main.xsd"
                           MessageSchemaVersionId="2010/ern-main/32">
<MessageHeader>
    <MessageThreadId>PADPID</MessageThreadId>
    <MessageId>PADPIDA</MessageId>
    <MessageSender>
      <PartyId>PADPIDA</PartyId>
      <PartyName>
        <FullName>Tes co</FullName>
      </PartyName>
    </MessageSender>
    <SentOnBehalfOf>
      <PartyId>PADPIDA</PartyId>
      <PartyName>
        <FullName>Bp</FullName>
      </PartyName>
    </SentOnBehalfOf>
    <MessageRecipient>
      <PartyId>PADPIDA</PartyId>
      <PartyName>
        <FullName>Testo</FullName>
      </PartyName>
    </MessageRecipient>
    <MessageCreatedDateTime>2012-10-31T19:26:05Z</MessageCreatedDateTime>
    <!-- Message type ern:NewReleaseMessage -->
    <!-- Message version 20110307 -->
    <!-- Generated using code version 2012102902 -->
  </MessageHeader>
 </ern:NewReleaseMessage> 
```

这是我可能反序列化为名为 NewReleaseMessage 的对象的代码：

```
 var xmlstream = new FileStream(ConfigurationManager.AppSettings["xmlfilepath"],FileMode.Open,FileAccess.Read);
  var dcs = new XmlSerializer(typeof(NewReleaseMessage));
  var loadfile = (NewReleaseMessage)dcs.Deserialize(xmlstream);
  xmlstream.Close(); 
```

somoene 可以帮我创建类来反序列化对象吗？

我尝试了以下课程：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Runtime.Serialization;
using System.Xml;
using System.Xml.Serialization;
//using System.Runtime.Serializa

namespace Ddexcoverter2
{
    [Serializable]
    [XmlRoot(ElementName  = "NewReleaseMessage" , Namespace  = "http://ddex.net/xml/2010/ern-main/32")]
    public class NewReleaseMessage
    {
        [XmlElement]
        public MessageHeader MessageHeader { get; set; }

    }

    [Serializable]
    public class MessageHeader
    {
        [XmlElement]
        public string MessageThreadId { get; set; }
        [XmlElement]
        public string MessageId { get; set; }
        [XmlElement]
        public MessageSender Sender { get; set; }
    }

    [Serializable]
    public class MessageSender
    {
        [XmlElement]
        public string PartyId { get; set; }

    }

} 
```

当我尝试运行程序时，对象 NewReleaseMessage 为空。

我有一种感觉，我试图反序列化的对象构造不正确。有人可以帮我构造对象吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:32:48.590

您可以使用给定的 XSD 文件自动创建 C# 类。因此，您可以使用命令行工具 xsd.exe。

有关 xsd.exe 的更多信息，请访问[http://msdn.microsoft.com/en-us/library/x6c1kb0s%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/x6c1kb0s%28v=vs.110%29.aspx)。xsd 工具包含在 Windows SDK 中，可在此处下载：http: [//msdn.microsoft.com/en-gb/windows/bb980924.aspx](http://msdn.microsoft.com/en-gb/windows/bb980924.aspx?wt.svl=more_downloads) ?wt.svl=more_downloads 。如果已安装，可在此处找到：“C:\Program Files\Microsoft SDKs\Windows\{version}\bin”。

要反序列化，您可以使用现有代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:52:33.483

它在 LanguageAndScriptCode 属性上失败。

```
 XmlSerializer serializer = new XmlSerializer(typeof(NewReleaseMessage));
 serializer.UnknownAttribute += serializer_UnknownAttribute;
 serializer.UnknownElement += serializer_UnknownElement;
 serializer.UnknownNode += serializer_UnknownNode;
 NewReleaseMessage message = (NewReleaseMessage)serializer.Deserialize(file);
 file.Close(); 
```

在 UnknownNode 处理程序中设置断点并亲自查看。

此外，当我粘贴 xml（并添加缺少的 ern:NewReleaseMessage 结束标记）时，VS 发出警告“命名空间 'http://ddex.net/xml/2010/ern-main/32' 中的元素 'NewReleaseMessage' 有内容不完整。预期的可能元素列表：“UpdateIndicator”。”。

所以我认为你需要首先使 XML 对这个 XSD 有效。

# java - 设置 EditText 以接受双值的问题

> ID：14485947
> 
> 赞同：1
> 
> 时间：2013-01-23T17:41:12.447
> 
> 标签：java, android, eclipse, android-edittext

`android:inputType="numberSigned"`我在 XML 文件中设置了我的 EditText 字段。但它似乎只接受非浮点值，因为它不允许用户输入浮点（点）。但实际上，我必须有`double`值，所以它必须支持双值。我该怎么做？我更喜欢 XML 中的一种方式。请帮忙！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T17:45:17.603

试试这个 ：

```
android:inputType="numberDecimal" 
```

这将允许您输入双精度值

# mysql - 查询从数据库中选择所有表，但不选择物化视图

> ID：14485949
> 
> 赞同：1
> 
> 时间：2013-01-23T17:41:15.663
> 
> 标签：mysql, sql, oracle

我正在使用查询从数据库中选择所有表

```
select table_name from all_tables where owner='XYZ' order by table_name 
```

但上面的查询也返回物化视图。我怎样才能只得到表格而不是物化视图

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T17:59:43.023

您可以忽略物化视图及其日志表（如果存在）

```
select *
  from all_tables t
 where owner = user
   and (owner, table_name) not in (select owner, mview_name
                                     from all_mviews l
                                   union all
                                   select log_owner, log_table
                                     from all_mview_logs) 
```

# java - 我应该使用什么来代替已弃用的 Date.getHours()

> ID：14485951
> 
> 赞同：12
> 
> 时间：2013-01-23T17:41:27.183
> 
> 标签：java, datetime, deprecated

如果 Java 中不推荐使用某个方法，那么将有另一种更好的方法来获得相同的功能，对吧？

```
Date date = new Date();
date.getHours() 
```

正如`getHours()`已弃用的那样，仅使用课程来获得时间的最佳方法是什么`Date`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-23T17:44:08.107

[Javadoc 明确建议](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Date.html#getHours%28%29)

```
Deprecated. As of JDK version 1.1, replaced by Calendar.get(Calendar.HOUR_OF_DAY). 
```

[Joda 库](http://joda-time.sourceforge.net/)是处理日期和时间的另一个最佳选择。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-23T17:53:13.023

这些方法确实已被弃用。

您现在应该使用 java.util.Calendar#get()

所以你的例子变成

```
Calendar cal = Calendar.getInstance();
cal.get(Calendar.HOUR); 
```

请参阅[此类的 javadoc。](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html)

请注意，您可以通过在 cal 上调用 getTime 来获取 Date 对象。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-23T17:43:58.887

```
Calendar cal = Calendar.getInstance();
cal.get(Calendar.HOUR); 
```

如果你想作为一个日期

```
Date date = cal.getTime(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-01-23T17:44:14.507

您应该使用日历或 Joda Time 库。

但是，如果您只能使用日期，这是您唯一的方法。请注意，这不会针对时区进行调整。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-07-21T12:10:50.093

# *java.time*

`java.util`日期时间 API 及其格式化 API已`SimpleDateFormat`过时且容易出错。建议完全停止使用它们并切换到[现代 Date-Time API](https://www.oracle.com/technical-resources/articles/java/jf14-Date-Time.html) ^*。

另外，下面引用的是来自[**Joda-Time**](https://www.joda.org/joda-time/)[主页](https://www.joda.org/joda-time/)**的通知：**

 **> 请注意，从 Java SE 8 开始，用户被要求迁移到 java.time (JSR-310) - JDK 的核心部分，它取代了这个项目。

**使用`java.time`现代日期时间 API 的解决方案：**

您可以使用[`ZonedDateTime#now(ZoneId)`](https://docs.oracle.com/javase/8/docs/api/java/time/ZonedDateTime.html#now-java.time.ZoneId-)获取当前的 Date-Time 对象，从中可以获取时区偏移量、年、月、日、**小时**、分钟、秒、纳秒等信息。如果您不需要时区偏移量，则可以使用[`LocalDateTime#now(ZoneId)`](https://docs.oracle.com/javase/8/docs/api/java/time/LocalDateTime.html#now-java.time.ZoneId-)。但是，如果您只需要当前时间信息，您可以使用[`LocalTime#now(ZoneId)`](https://docs.oracle.com/javase/8/docs/api/java/time/LocalTime.html#now-java.time.ZoneId-)获取特定时区的本地时间，**然后**从`LocalTime`.

**演示：**

```
import java.time.LocalDateTime;
import java.time.LocalTime;
import java.time.ZoneId;
import java.time.ZonedDateTime;

public class Main {
    public static void main(String[] args) {
        // Change the JVM's ZoneId, ZoneId.systemDefault() with the applicable ZoneId
        // e.g. ZoneId.of("America/Los_Angeles")
        ZoneId zoneId = ZoneId.systemDefault();

        ZonedDateTime zdt = ZonedDateTime.now(zoneId);
        System.out.println(zdt.getHour());

        LocalDateTime ldt = LocalDateTime.now(zoneId);
        System.out.println(ldt.getHour());

        LocalTime time = LocalTime.now(zoneId);
        System.out.println(time.getHour());
    }
} 
```

**示例运行的输出：**

```
13
13
13 
```

[`ONLINE DEMO`](https://ideone.com/byjfs1)

**[从Trail: Date Time](https://docs.oracle.com/javase/tutorial/datetime/index.html)**了解有关现代日期时间 API 的更多信息。

* * *

^(* 出于任何原因，如果您必须坚持使用 Java 6 或 Java 7，则可以使用[***ThreeTen-Backport，***](http://www.threeten.org/threetenbp/)它将大部分*java.time*功能向后移植到 Java 6 和 7。如果您正在为 Android 项目和 Android API 工作level 仍然不符合 Java-8，请检查[Java 8+ APIs available through desugaring](https://developer.android.com/studio/write/java8-support-table)和[How to use ThreeTenABP in Android Project](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)。)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-22T11:33:54.487

正如其他人已经说过的那样， [Javadoc](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Date.html#getHours%28%29)建议改用`Calendar.get(Calendar.HOUR_OF_DAY)`.

```
Deprecated. As of JDK version 1.1, replaced by Calendar.get(Calendar.HOUR_OF_DAY). 
```

这是已经设置好的方法`Date`：

```
int getHourOfDay(Date date) {
    Calendar calendar = Calendar.getInstance();
    calendar.setTime(date);
    calendar.get(Calendar.HOUR_OF_DAY);
} 
```

`Calendar.HOUR_OF_DAY`如果您想要 0-23 和`Calendar.HOUR`0-11 的数字，请使用。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2021-07-21T11:03:21.297

使用如下代码。

```
Date date = new Date();
    System.out.println(date);
    System.out.println(new SimpleDateFormat("HH").format(date));
    System.out.println(new SimpleDateFormat("mm").format(date));
    System.out.println(new SimpleDateFormat("MM").format(date));
} 
```**

# android - 如何从适配器中删除带有图标的项目

> ID：14485953
> 
> 赞同：0
> 
> 时间：2013-01-23T17:41:41.563
> 
> 标签：android, android-listview, adapter

我正在尝试从适配器中删除带有来自适配器的项目（文本）的图标。我知道这看起来很简单，我做到了，但仍然有一些错误。看起来我删除它们的项目很奇怪，列表中的第一个图标和最后一个图标相同。这是代码：

```
ListRssLinkAndTitle=(ArrayList)dbAdpter.getWantedItemsList(this,"RssTitle","link","Rtl","image");//get wanted items from db 

        for (int j=0;j<ListRssLinkAndTitle.size();j++)
            listKeys.add(ListRssLinkAndTitle.get(j).title);

        for (int i=0;i<ListRssLinkAndTitle.size();i++)
            Icon.add(ListRssLinkAndTitle.get(i).icon);

        listAdapter = new ListRssAdpter(this, R.layout.titlesrss, listKeys,Icon);

            lv.setAdapter(listAdapter); 
            lv.setOnItemClickListener(new OnItemClickListener() 
            {

                public void onItemClick(AdapterView<?> parent, View view,
                        int position, long id) {
                        if  (0<dbAdpter.deleteRssItem(ListRssLinkAndTitle.get(position).title,ListRssLinkAndTitle.get(position).url))
                        {
                            ListRssLinkAndTitle.remove(position);
                            listAdapter.items.remove(position);
                            listAdapter.FavIconList.remove(position);

                listAdapter.notifyDataSetChanged();

                    }
                    else
                        Toast.makeText(getApplicationContext(),  getResources().getString(R.string.operationFaild),0).show();
                }
            } 

        }); 
```

和适配器：

```
public class ListRssAdpter extends ArrayAdapter {
    private Context mContext;
    private int id;
    public List<String> items;
    public List<byte[]> FavIconList;
    public boolean iconRemove=false;
    public int IconHigh=-1;// if -1 not in use

    //constractor for fav icon
    public ListRssAdpter(Context context, int textViewResourceId, List<String> list,List<byte[]> icon) {
        super(context, textViewResourceId, list);
        mContext = context;
        id = textViewResourceId;
        items = list;
        this.FavIconList=icon;
    }

public View getView(int position, View v, ViewGroup parent) {
        View mView = v;
        if (mView==null) {
            LayoutInflater vi = (LayoutInflater) mContext.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            mView = vi.inflate(id, null);

        }
        ImageView   removeIcon = (ImageView)mView.findViewById(R.id.iconremove); 
        ImageView   favIcon = (ImageView)mView.findViewById(R.id.iconfav); 
        if (iconRemove)
        {
            removeIcon.setVisibility(View.VISIBLE);
            favIcon.setVisibility(favIcon.GONE);
        }
        else 
        {
            if (FavIconList.get(position)!=null)
            {
            Bitmap bitmap = BitmapFactory.decodeByteArray(FavIconList.get(position), 0, FavIconList.get(position).length);
            favIcon.setImageBitmap(bitmap);
            }
            else   BitmapFactory.decodeResource(mView.getContext().getResources(),R.drawable.rss);
            removeIcon.setVisibility(removeIcon.GONE);
            favIcon.setVisibility(favIcon.VISIBLE);
        }

        TextView tx = (TextView) mView.findViewById(R.id.textView);

        //if this view is on main screen
        if (tx == null) {
            tx = ((TextView) mView);
        }
        if (this.IconHigh!=-1)
            tx.setHeight(this.IconHigh);
        //this.setTextSize(TypedValue.COMPLEX_UNIT_PX, size);

        tx.setText(items.get(position));
        return mView;

    }
} 
```

如果您找不到逻辑错误，也许您可​​以给我一个简单的示例工作代码:)

# jsf-2 - 在回发（或“部分”回发）之后，如何使 `p:autocomplete` 显示其选定的值？

> ID：14485959
> 
> 赞同：0
> 
> 时间：2013-01-23T17:41:50.560
> 
> 标签：jsf-2, primefaces, mojarra

***(java7, jsf/mojarra v2.1.11, primefaces v3.4.2)***

# 问题

我有一个表单，其中`p:autocomplete`包含用户需要填充的输入字段以及其他字段（如下所示）。

现在，***在页面返回验证和/或所需错误***后，用户设置的值不再显示。这与仍然显示用户已输入/设置的值的所有其他字段形成对比。

# 问题：

为什么此字段不显示用户输入的值？我可以强制它显示值吗？

（同样，最初，所选值在`p:autocomplete`输入框中可见。但是，在页面提交并返回验证错误后，不再显示所选值）

# 标签如下所示：

```
<p:autoComplete
    id="code"
    requiredMessage="code value required"
    converter="acConverter"
    style="overflow: hidden"
    maxResults="200"
    scrollHeight="150"
    dropdown="false"
    value="#{testBean.parmMap['code']}"
    completeMethod="#{testBean.codeListComplete}"
    var="entry"
    itemLabel="#{entry.split(':')[1]}"
    itemValue="#{entry.split(':')[0]}"
    minQueryLength="1"
    forceSelection="true">
</p:autoComplete> 
```

现在，如果用户提交表单并且表单被回发并出现各种表单验证错误，那么，即使用户`p:autocomplete`从在请求/内存中）。

* * *

* * *

* * *

* * *

* * *

***仅供参考 - 如果您需要，以下是更多信息（否则，您可以忽略它）...***

***索引.xhtml...***

```
<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui">
    <f:view contentType="text/html">
        <h:head>
            <title>test autocomplete...</title>
            <meta charset="utf-8" />
        </h:head>
        <h:body>
            <h:form id="queryForm">

                <f:event type="postValidate" listener="#{testBean.validate}" />
                <p:panel id="queryPanel"  header="test autocomplete..." style="width:100%;">

                    <p:autoComplete
                        id="code"
                        requiredMessage="code value required"
                        converter="acConverter"
                        style="overflow: hidden"
                        maxResults="200"
                        scrollHeight="150"
                        dropdown="false"
                        value="#{testBean.parmMap['code']}"
                        completeMethod="#{testBean.codeListComplete}"
                        var="entry"
                        itemLabel="#{entry.split(':')[1]}"
                        itemValue="#{entry.split(':')[0]}"
                        minQueryLength="1"
                        forceSelection="true">
                    </p:autoComplete>

                    <br/>
                    <br/>

                    <p:commandButton
                        id="submit"
                        value="Submit"
                        type="submit"
                        update="@form"
                        process="@form"
                        action="#{testBean.submitQuery}"
                        style="width:150px;"
                        styleClass="button"/>

                    <p:commandButton
                        value="Reset"
                        update="@form"
                        onclick="location.reload();return true;"
                        process="@this"
                        actionListener="#{testBean.reset}"
                        immediate="true"
                        ajax="false"/>

                </p:panel>
            </h:form>

            <h:outputStylesheet library="styles"    name="query.css"      />
            <h:outputScript      library="primefaces" name="/jquery/jquery.js" />
            <h:outputScript      library="primefaces" name="/jquery/plugins/ui/jquery-ui.custom.js" />
            <h:outputScript     library="primefaces" name="/jquery/plugins/inputmask/maskedinput.js" />

        </h:body>
    </f:view>
</html> 
```

***TestBean.java...***

```
package aaa.bbb.ccc.war;

import java.io.Serializable;
import java.text.ParseException;
import java.util.ArrayList;
import java.util.LinkedHashMap;
import java.util.List;
import javax.faces.application.FacesMessage;
import javax.faces.component.UIForm;
import javax.faces.component.UIInput;
import javax.faces.context.FacesContext;
import javax.faces.event.ActionEvent;
import javax.faces.event.ComponentSystemEvent;
import org.apache.commons.lang.StringUtils;
import org.primefaces.context.RequestContext;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Component;

@Component("testBean")
@Scope("request")
public class TestBean implements Serializable
{
    public TestBean()
    {
        parmMap = this.getParmMap();
        FacesContext.getCurrentInstance().getExternalContext().getSessionMap().put("parmMap", parmMap);
    }

    public void reset(ActionEvent event)
    {
        RequestContext.getCurrentInstance().reset("queryForm:queryPanel");
        LinkedHashMap<String, Object> m = new LinkedHashMap<String, Object>();
        FacesContext.getCurrentInstance().getExternalContext().getSessionMap().remove("parmMap");
        setParmMap(m);
    }

    public String submitQuery()
    {
        FacesContext.getCurrentInstance().getExternalContext().getSessionMap().remove("hitlistData");

        System.out.println("TestBean_________________________submitQuery()____________________parmMap contains:" + this.getParmMap().toString());

        if (this.getParmMap().isEmpty())
        {
            return "";
        }

        return "/page2.xhtml?faces-redirect=true";
    }

    private static LinkedHashMap<String, Object> parmMap;
    public LinkedHashMap<String, Object> getParmMap()
    {
        LinkedHashMap<String, Object> map = (LinkedHashMap<String, Object>) FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get("parmMap");

        if (null == map)
        {
            map = new LinkedHashMap<String, Object>();
        }

        return map;
    }

    public void setParmMap(LinkedHashMap<String, Object> map)
    {
        parmMap = map;
        FacesContext.getCurrentInstance().getExternalContext().getSessionMap().put("parmMap", parmMap);
    }

    public void validate(ComponentSystemEvent e) throws ParseException
    {
        LinkedHashMap parmMap = this.getParmMap();
        UIForm queryForm = (UIForm) e.getComponent();
        FacesContext fc = FacesContext.getCurrentInstance();

        UIInput code_c = (UIInput) queryForm.findComponent("code");
        String code = (String) code_c.getValue();

        try
        {
            if (StringUtils.isBlank(code))
            {
                code_c.setSubmittedValue("");
                code_c.setValid(false);
                fc.addMessage(code_c.getClientId(), new FacesMessage(FacesMessage.SEVERITY_ERROR, code_c.getRequiredMessage(), code_c.getRequiredMessage()));
            }

            if (fc.getMessageList().size() > 0)
            {
                fc.renderResponse();
            }
        }
        catch (Exception e1)
        {
            e1.printStackTrace();
        }
    }

    private static List<String> codeList;
    public static List<String> getCodeList()
    {
        codeList = (List<String>) FacesContext.getCurrentInstance().getExternalContext().getSessionMap().get("codeList");

        if (null == codeList)
        {
            codeList = new ArrayList<String>();
            codeList.add("keyaaaa:valaaaa");
            codeList.add("keybbbb:valbbbb");
            codeList.add("keycccc:valcccc");
            codeList.add("keydddd:valdddd");
            codeList.add("keyeeee:valeeee");
            codeList.add("keyffff:valffff");
            codeList.add("keygggg:valgggg");
            codeList.add("keyhhhh:valhhhh");
            FacesContext.getCurrentInstance().getExternalContext().getSessionMap().put("codeList", codeList);
        }

        return codeList;
    }

    public void setCodeList(List<String> list)
    {
        codeList = list;
    }

    public static List<String> codeListComplete(String s)       //autocomplete "completeMethod"...
    {
        List<String> list = getCodeList();
        List<String> suggestions = new ArrayList<String>();
        for (String ss : list)
        {
            if (ss.toLowerCase().contains(s.toLowerCase()))
            {
                suggestions.add(ss);
            }
        }

        return suggestions;
    }

} 
```

***ACConverter.java（我在尝试删除字符串值“null”时创建了它）...***

```
package aaa.bbb.ccc.war;

import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.component.UIInput;
import javax.faces.context.FacesContext;
import javax.faces.convert.Converter;
import javax.faces.convert.ConverterException;
import javax.faces.convert.FacesConverter;
import org.apache.commons.lang.StringUtils;

@FacesConverter("acConverter")
public class ACConverter implements Converter
{
    @Override
    public Object getAsObject(FacesContext context, UIComponent component, String value)
    {
        try
        {
            if (StringUtils.isBlank(value) || String.valueOf(value).equalsIgnoreCase("null"))
            {
                return "";
            }
        }
        catch (Exception e)
        {
            UIInput input = (UIInput) component;
            FacesMessage msg = new FacesMessage(input.getConverterMessage(),input.getConverterMessage());
            msg.setSeverity(FacesMessage.SEVERITY_ERROR);
            throw new ConverterException(msg);
        }

        return value;
    }

    @Override
    public String getAsString(FacesContext context, UIComponent component, Object value)
    {
        return (null==value?"":String.valueOf(value));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T10:37:07.270

可能是因为您的 bean 是请求范围的。尝试改为查看范围。看[这里](https://stackoverflow.com/questions/6025998/difference-between-view-and-request-scope-in-managed-beans)

# php - 单步执行 xml，在标签处执行特定操作

> ID：14485963
> 
> 赞同：1
> 
> 时间：2013-01-23T17:42:03.377
> 
> 标签：php, mysql, xml, dom

有人可以指点我这方面的教程吗？我在 Stackoverflow 上查看了一些类似的问题，并在手册中查看了 PHP DOM。

我有一个 XML 文档，并且在两个特定的标签上想要从我的数据库中输出数据，否则仍然输出其他标签和其中的信息。

所以我想在查询中获取信息以自动动态插入主客场阵容。

```
<root>
    <sometag>Some text here</sometag>
    <anothertag>Something else here</anothertag>

    <Hometeam>Cardinals</Hometeam>
        <HomeLineup></HomeLineup> -- this would be database driven data

    <Awayteam>Giants</Awayteam>
        <AwayLineup></AwayLineup> -- this would be database driven data

    <yetmoretags>Other stuff</yetmoretags>

</root> 
```

我在这里看到一个创建 xml 文件的示例： [使用 PHP DOM 从 MySQL 数据创建 XML 文件](https://stackoverflow.com/questions/10009029/using-php-dom-to-create-xml-files-from-mysql-data/)

但是 a) 我不确定如何确保其他 xml 标记和内容会被吐出，并且 b) 不确定我将如何加载这些文件/文件或在什么时候输出它们。

真的，我正在制作一个包含其他内容、php 和 javascript 相关的完整页面，并且不确定在特定 DOM 标记中输出数据库内容的最佳方法。

我查看了 PHP DOM 文档并了解如何操作和查找特定标签，但不知道如何输出整个文档，但特别是在该文档中包含动态内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T00:47:39.007

像这样的模板：

```
<?xml version="1.0"?>

<xsl:stylesheet version="1.0"
  xmlns:xhtml="http://www.w3.org/1999/xhtml"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  exclude-result-prefixes="xhtml xsl xs"> 

<xsl:output method="html" version="1.0" encoding="UTF-8" doctype-public="-//W3C//DTD XHTML 1.1//EN" doctype-system="http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd" indent="no"/> 

  <!-- match and copy verbatim everything - unless there is another template for it -->
  <xsl:template match="@*|node()"> 
        <xsl:copy> 
            <xsl:apply-templates select="@*|node()"/> 
        </xsl:copy> 
  </xsl:template> 

  <xsl:template match="HomeLineup"> 
        <xsl:copy> 
            <!-- do something here --> 
        </xsl:copy> 
  </xsl:template> 

  <xsl:template match="AwayLineup"> 
        <xsl:copy> 
            <!-- do something here --> 
        </xsl:copy> 
  </xsl:template> 

</xsl:stylesheet> 
```

# cocos2d-iphone - ld：找不到文件：libkobold2d-ios.a (Kobold2d)

> ID：14485966
> 
> 赞同：1
> 
> 时间：2013-01-23T17:42:16.337
> 
> 标签：cocos2d-iphone, kobold2d

尝试构建到我的设备时遇到问题。我不断收到错误：

```
ld: file not found: /Users/Stephen/Library/Developer/Xcode/DerivedData/Tire_Hoops-buzmngpjbdxukpbanrmqlxpfbreg/Build/Products/Release-iphoneos/libkobold2d-ios.a 
```

我在 kobold2d 1.0.4 发布页面的评论中看到人们遇到了这个问题，据我所知，这与构建设置中的这些行有关。

FORCE_LOAD_COCOS2D = -force_load $(BUILT_PRODUCTS_DIR)/libcocos2d-ios.a FORCE_LOAD_KOBOLD2D = -force_load $(BUILT_PRODUCTS_DIR)/libkobold2d-ios.a FORCE_LOAD_COCOS3D = -force_load $(BUILT_PRODUCTS_DIR)/libcocos3d-ios.a

我想知道是否有解决此问题的方法，因为如果不解决此问题，我将无法在发布模式下构建。

# c# - 忘记远程调试器凭据

> ID：14485967
> 
> 赞同：9
> 
> 时间：2013-01-23T17:42:22.523
> 
> 标签：c#, visual-studio-2012, windows-authentication, remote-debugging

现在，我一直在使用 Visual Studio 远程调试监视器在我的表面上进行一些远程调试。

我一直在使用 windows Authentication 连接到远程调试监视器，并且它一直在成功运行。

今天，启动了远程调试监视器，但我点击了“记住凭据”复选框，现在我得到了窗口：

```
A remote operation is taking longer than expected 
```

窗口，后面跟着一个窗口说：

```
There were deployment errors.  Continue? 
```

*   有没有办法忘记我的凭据？
*   是否还有另一个我没有考虑的问题？

同时，如果我选择不使用任何身份验证，我可以运行远程调试器，但最好是我可以重新使用 Windows 身份验证。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-23T23:27:32.150

我相信它存储在 Control Panel\User Accounts\Credential Manager 中并可以从中进行管理。

# sql-server-2008 - Windows Azure 连接

> ID：14485969
> 
> 赞同：1
> 
> 时间：2013-01-23T17:42:27.750
> 
> 标签：sql-server-2008, azure, virtual-machine, azure-connect

**我正在尝试使用Windows Azure**迈出第一步，我需要知道是否可以做我需要的事情。

所以，想象一下**我的本地机器上有一个 BD**并且我**在 Microsoft Azure 中有一个 VM（Win Server 2008 和 SQL Server）**的场景。

我想知道是否可以**从 Azure 上的 VM 连接我的本地数据库**.. 即，想象一下我需要在 VM 上实现**ETL 流程**（集成服务），**从我的本地 BD 获取数据并将其加载到我的 VM 数据库中**.

那可能吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:39:11.947

是的，有可能。您必须使用以下任何一种：

*   [Windows Azure 连接](http://msdn.microsoft.com/en-us/library/windowsazure/gg432997.aspx)
*   [Windows Azure 虚拟网络](http://msdn.microsoft.com/en-us/library/windowsazure/jj156007.aspx)

将 Windows Azure VM 连接到本地网络。我建议从 Windows Azure Connect 开始，因为它很容易安装和配置。而后者需要硬件 VPN/防火墙路由器。

还要注意名称解析方案 - 您完全支持使用 Windows Azure Connect 进行名称解析，而您必须提供自己的 DNS 才能与 Windows Azure VN 一起使用。但是请注意，Windows Azure Connect 仅提供 IPv6 连接。但是有了名称解析，命名管道协议就可以了。

**更新**

您只能从旧的 silverlight 门户 ( [http://windows.azure.com/](http://windows.azure.com/) ) 下载 Windows Azure Connect。您可以从右上角导航到旧门户 -> 单击您的登录 ID，将出现一个下拉菜单，选择“上一个门户”（第一个选项）。然后按照教程进行操作。创建 Azure Connect 组后，您将拥有“下载 Azure Connect 代理”选项。它是每个订阅的自定义下载，这就是为什么没有公开下载的原因：

![获取 Azure 连接](../Images/a397e26455c61deff42c836cc3842c5b.png)

# sql - 汇总并计算“SELECT .... AS [Name]”字段？

> ID：14485971
> 
> 赞同：0
> 
> 时间：2013-01-23T17:42:28.420
> 
> 标签：sql, ms-access-2007

我有这样的 SQL：

```
SELECT 
Mid(Note, 
  InStr(Note, "device.")-
  (
   InStr(Note, "device.")-
   InStr(Note, "pressure and")
  )
  +13,
  (InStr(Note, "device.") - InStr(Note, "pressure and")) - 14
  )
  AS [Device],
  Count([Device]),
Date_Field & " " & Time_Field AS [DateTime],
EnteredBy
FROM MyLog
WHERE Note LIKE "*removed and*"
GROUP BY [Device]
ORDER BY Date_Field DESC
; 
```

我想要`GROUP BY`那个自定义字段`[Device]`并计算每个设备有多少。但是上面的代码为“... AS [Device]”部分给出了错误“...不包括指定的表达式...作为聚合函数的一部分”。

我怎样才能做到这一点？

现在数据看起来像：

```
Record1      12/05/12 03:02:12    User2
Record1      12/02/12 01:02:12    User1
Record1      12/01/12 02:02:12    User2
Record2      12/06/12 03:02:12    User2
Record2      12/07/12 03:02:12    User3 
```

但我希望它看起来像：

```
Record1    3
Record2    2 
```

这是有效的旧 SQL（不聚合）：

```
SELECT Mid(Note, 
  InStr(Note, "device.")-
  (
   InStr(Note, "device.")-
   InStr(Note, "pressure and")
  )
  +13,
  (InStr(Note, "device.") - InStr(Note, "pressure and")) - 14
  ) AS Device, Date_Field & " " & Time_Field AS [DateTime], EnteredBy
FROM MyLog
WHERE Note LIKE "*removed and*"
ORDER BY Date_Field DESC; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:46:41.800

您不能在 MS Access 的 GROUP BY 中引用别名设备，但您可以创建一个子查询并从中引用别名。

这对我来说是：

```
SELECT EnteredBy, Device, Count(Device) As CountDev FROM (
SELECT 
Mid(Note,InStr(Note,"device.")-
         (InStr(Note,"device.")-
          InStr(Note,"pressure and"))+13,
    (InStr(Note,"device.")-InStr(Note,"pressure and"))-14) AS Device, 
MyLog.EnteredBy
FROM MyLog
WHERE MyLog.[Note] Like "*removed and*")
GROUP BY EnteredBy, Device 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T17:48:38.083

您收到该错误是因为 Device 不是列。也许您可以使用子查询，尽管我承认有一段时间没有使用 Access。

尝试这样的事情：

```
SELECT Count([Device]), Device, [DateTime], EnteredBy
FROM (
SELECT
Mid(Note, 
  InStr(Note, "device.")-
  (
   InStr(Note, "device.")-
   InStr(Note, "pressure and")
  )
  +13,
  (InStr(Note, "device.") - InStr(Note, "pressure and")) - 14
  )
  AS [Device],
  Date_Field & " " & Time_Field AS [DateTime],
  EnteredBy
FROM MyLog
WHERE Note LIKE "*removed and*" ) t
GROUP BY Device, [DateTime], EnteredBy
ORDER BY Date_Field DESC
; 
```

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:47:21.673

与此类似的东西 - 基本上将复杂部分嵌套到子查询中。

```
select dev, count(dev) from
(
SELECT 
Mid(Note, 
  InStr(Note, "device.")-
  (
   InStr(Note, "device.")-
   InStr(Note, "pressure and")
  )
  +13,
  (InStr(Note, "device.") - InStr(Note, "pressure and")) - 14
  )
  AS dev,
Date_Field & " " & Time_Field AS DateTime,
EnteredBy
FROM MyLog
WHERE Note LIKE "*removed and*"
)
GROUP BY dev
ORDER BY DateTime DESC 
```

# uiimageview - 即使 contentMode = UIViewContentModeScaleAspectFit，UIImageView 图像也会被拉伸

> ID：14485975
> 
> 赞同：13
> 
> 时间：2013-01-23T17:42:43.830
> 
> 标签：uiimageview, stretched

我对 UIImageView 显示图像的方式感到非常失望。

我有以下代码：

```
UIImageView *imgview = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 300, 100)];
imgview.image = [UIImage imageNamed:@"img.JPG"];
imgview.backgroundColor = [UIColor greenColor];
imgview.contentMode = UIViewContentModeScaleAspectFit;
[self.view addSubview:imgview]; 
```

我得到的是以下屏幕截图：

[http://img26.imageshack.us/img26/3686/screenshot20130123at629.png](http://img26.imageshack.us/img26/3686/screenshot20130123at629.png)

[图像被拉伸到 UIImageView 的全宽，甚至没有全高]

原图：

[http://img248.imageshack.us/img248/341/screenshot20130123at638.png](http://img248.imageshack.us/img248/341/screenshot20130123at638.png)

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-09-16T18:40:36.000

设置大小必须在设置 contentMode 之后发生

```
[imageView setContentMode: UIViewContentModeScaleAspectFit];
imageView.frame = CGRectMake(x, y, width, height); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-20T11:05:43.540

我有同样的问题。在我的项目中，一个从未尊重过它被插入的项目中`UIImage`创建。`imageWithCIImage:``contentMode``UIImageView`

一些图像也确实具有导致相同问题的奇怪属性。使用 Photoshop将其转换为*PNG始终对它们有效。*

**不**使用`contentMode`：

```
 CIImage * __strong ciImage = [CIImage imageWithContentsOfURL:url];
    _image = [UIImage imageWithCIImage:ciImage]; 
```

`UIImageView`似乎根据`CGImage`.

您需要将 CIImage 渲染为 CGImage，然后可以将其用作 UIImage。这将与`UIViewContentModeAspectFit`.

使用 example `createCGImage:fromRect:`，或者最好`CGImage`从一开始就使用 a 。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-23T19:46:07.410

我刚刚运行它，您的代码运行良好。当它实际上是png时，它可能与您指定JPG有关吗？

您也可以使用 UIViewContentModeScaleAspectFill，但请确保您的边界在视图限制内，否则外部可能会被剪裁

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-08T15:37:47.650

这是一个愚蠢的人，如此愚蠢，我为此感到自豪。底线是我最终在这篇 SO 帖子上认为 contentMode = UIViewContentModeScaleAspectFit 被破坏了，而实际上真正被破坏的是我对结果的期望。我在方形视图中处理方形图像，因此 Fit 和 Fill 具有完全相同的效果。当我无法让它坐在广场内的宽屏上时，我哭得像个婴儿。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-17T16:31:01.380

就我而言，我解决了这个问题，消除了一些调整我错误设置的图像视图大小的**约束。**

**[更新]**

它是“尺寸约束”，它使尺寸相对于另一个视图。

[Xamarin IOS 文档](https://developer.xamarin.com/guides/ios/user_interface/designer/designer_auto_layout/)

# ios - UITextView如何禁用带有内容插入的水平滚动

> ID：14485976
> 
> 赞同：6
> 
> 时间：2013-01-23T17:42:51.917
> 
> 标签：ios, uitextview

我以编程方式创建了 UITextview，我需要在文本中设置一些左边距。我这样做：

```
myTextView.contentInset = UIEdgeInsetsMake(0.0, 5.0, 0.0, 0.0); 
```

这工作，但现在我有水平滚动。
我尝试设置`contentSize`小于我的文本视图框架（它等于 320 pt）。

这

```
myTextView.contentSize = CGSizeMake(300.0, 39.0); 
```

不要帮忙。

我需要为文本设置左边距，并且只需要垂直滚动。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2015-02-02T13:18:10.947

代替 contentInset，使用 textContainerInset (iOS 7.0+)

```
myTextView.textContainerInset = UIEdgeInsetsMake(0.0, 5.0, 0.0, 0.0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-04T01:05:48.680

使用自定义插图，我发现对我来说最好的解决方案是将 UITextView 子类化，然后在 layoutSubviews 中调用以下代码。

```
-(void) layoutSubviews
{
    // always keep content offset at x = 0
    self.contentOffset = CGPointMake(0, self.contentOffset.y );
    [super layoutSubviews];
} 
```

希望这可以帮助某人。我还将这个答案发布到[https://stackoverflow.com/a/24027310/2661613](https://stackoverflow.com/a/24027310/2661613)

# delphi - 如何在注册表中配置多个版本的 COM 服务器？

> ID：14485979
> 
> 赞同：2
> 
> 时间：2013-01-23T17:43:04.910
> 
> 标签：delphi, com, registry, delphi-xe

我有一个应用程序的多个版本（主要版本和次要版本），并且希望在我的注册表中进行设置，就像 AutoCAD 之类的程序一样。这是我的注册表中的一个示例：

![在此处输入图像描述](../Images/634c42b0a97b0b4848aa4766a3086ad4.png)

正如您在此处看到的，AutoCAD.Application 只是指向最近执行的 AutoCAD 版本。每个版本都有自己的 COM 服务器（我可以在我的 IDE、Delphi XE 中弄清楚如何做）。CLSID 键包含与 AutoCAD.Application.19 -> CLSID 相同的信息，并且每当执行不同的版本时都会更改。

我的问题是，是否有一种自动方式或实用程序已经在注册表中添加了父 COM 对象并填充了我的应用程序的 CLSID 和当前版本 (CurVer)？

如果没有自动执行此操作的方法，那么手动执行此操作会是什么样子？即使您的答案不是 Delphi/Pascal 语言，我也会看一下。

感谢任何帮助，因为我在一个未知的领域，谷歌没有像往常那样帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-02T21:47:35.047

您正在寻找的是与[版本无关的 PROGID](http://msdn.microsoft.com/en-us/library/windows/desktop/ms694514%28v=vs.85%29.aspx)。这些不是 COM 对象；它们只是用于将人类可读的 PROGID 解析为计算机友好的 CLSID 的注册表项。

通常，您的应用程序的每个类将有两个 PROGID——一个与版本无关，一个与版本相关。与版本无关的 PROGID 转发到与版本相关的 PROGID，然后解析为 CLSID。

当您发布应用程序的新版本时，您将为新版本创建新的 CLSID，添加映射到新 CLSID 的新版本相关 PROGID，并更新与版本无关的 PROGID 的 CurVer 子键以指向您的新版本-依赖程序。

Larry Osterman 在他的[系列](http://social.msdn.microsoft.com/Search/en-US?query=com%20registration&beta=0&rn=Larry%20Osterman's%20WebLog&rq=site%3ablogs.msdn.com/b/larryosterman/&ac=8)文章中更详细地介绍了 COM 注册是如何工作的。

# c++ - 为原生 C++ 类编写 C++/CX 包装类

> ID：14485980
> 
> 赞同：2
> 
> 时间：2013-01-23T17:43:06.347
> 
> 标签：c++, windows-8, windows-runtime, c++-cx

由于 C++/CX 类不允许在公共签名中使用本机类型，我需要找到另一种获取信息的方法。我在互联网上找到了一些关于编写包装类的参考，但没有实际的实现。如何在我的代码中启用以下场景？

```
public ref class MyRefClass
{
public:
    void SetNativeType(NativeType *pType);
}; 
```

显然这是行不通的，那么我该如何包装`NativeType`以便可以将其传递给`MyRefClass`?

我应该补充一点，这是在一个单独的库中，所以使用`internal`关键字在这里没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T20:24:00.010

假设只需包装指向 NativeType 的指针就足够了，您可以使用[Platform::IntPtr](http://msdn.microsoft.com/en-us/library/windows/apps/hh755810.aspx)作为“通用”参数。

来自 MSDN：

```
static IntPtr::operator IntPtr( void* value1);
static IntPtr::operator IntPtr( int value2);
static IntPtr::operator void*( IntPtr value3 ); 
```

作为替代方案，您可以将其`SetNativeType(NativeType *pType);`作为内部的，然后分发带有头文件的静态库，而不是 Windows 应用商店类库。

关于[您在评论中提到的警告](http://social.msdn.microsoft.com/Forums/uk/winappswithnativecode/thread/b9c8a6d0-d6e8-4300-ab04-ef42a332d92f)，您可以尝试使用纯 C++ 类 MyPlainClass，并将其实现导出到 lib 文件中（即使您在其中使用其他 ref 类），然后提供一个仅包含标头的 ref 类 MyRefClass MyPlainClass 并充当公共接口。这个解决方案也不是完美的，我猜你会在同一个项目中组合两个使用你的 lib+header 文件的 winrt 库时遇到麻烦，但也许你不需要支持这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-23T09:25:43.647

由于 WinRT（和 COM）解决了二进制 API 兼容性的真正问题，因此我个人决定使用 COM 来解决这个问题。您可以声明一个没有 IDL 或类型库的私有接口。您所需要的只是在客户端中包含带有接口声明的标头。您只需要匹配的 IID 和接口签名（除了还要弄清楚如何传递 IUnknown 指针）。

# html - 在持续集成环境中测试 Twig 和 HTML

> ID：14485983
> 
> 赞同：1
> 
> 时间：2013-01-23T17:43:23.707
> 
> 标签：html, symfony, continuous-integration, teamcity, twig

我目前将 Symfony2 与 Twig 一起使用。我正在为它配置我们的持续集成 (CI) 项目。

我想知道一些与 Twig 相关的事情： - 是否有任何测试 Twig 的测试（单元测试、块测试、代码标准等） - 有没有办法测试它生成的 HTML（是否可以生成缓存我们可以使用特定参数进行检查）？

此外，是否有人知道任何用于从命令行以某种方式测试 HTML 的好工具。我主要关心的是确保我们遵循特定的标准（符合标准的多语言，本质上是 HTML5+XML）。其他测试也很酷。

我怀疑 Twig 可能没有任何具体的内容，但我认为问一下也无妨。

我还猜想我可以通过测试响应结果将 HTML 测试与我的常规单元测试混合，但我想知道是否有更清洁的东西（所以我可以将 HTML 测试分成自己的东西，这也符合标准棘手）。

谢谢。

（我在 Linux 上使用 TeamCity）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-24T02:07:22.423

使用[Behat](http://behat.org/)、[Mink](http://mink.behat.org/)和Behat[的 Symfony 扩展](https://github.com/Behat/Symfony2Extension)。

这是很棒的东西，可以让您使用许多不同的驱动程序进行功能测试

# r - R：如何匹配第 1 列中的值，并将第 2 列中的相邻值分配到第 2 列中的较低值

> ID：14485984
> 
> 赞同：-1
> 
> 时间：2013-01-23T17:43:23.743
> 
> 标签：r

我有 3 列。第一列是完整的，但是第二列和第三列是不完整的，我想根据所有 3 列中的现有值来完成它们。这是一个例子：

```
number  a   b
1       Q   V
2       R   W
3       S   X
4       T   Y
5       U   Z
3       S   X
2       R   W
4       T   Y
1       Q   V
5       U   Z
4       
1       
5       
3       
2       
2       
4       
3       
5       
1 
```

我需要做的是转到“a”列中的第一个空值，查看“number”列中的值（4），找到“number”对应的“a”和“b”的值（4 )，然后将这些值插入到“a”和“b”列中——然后转到下一个缺失值。

我遇到了一个使用两个数据框的解决方案。一个名为“df”的数据帧是本文开头显示的原始表格，第二个数据帧（称为“df2”）是一个键：

```
number a b
1      Q V
2      R W
3      S X
4      T Y
5      U Z
3      S X
2      R W
4      T Y
1      Q V
5      U Z 
```

然后，我可以使用 df1 中的值将值填充到 df 中

```
df$a <- df2$a[ match(df$number, df2$number)]
df$b <- df2$b[ match(df$number, df2$number)] 
```

这给出了新的df

```
 number a b
1       Q V
2       R W
3       S X
4       T Y
5       U Z
3       S X
2       R W
4       T Y
1       Q V
5       U Z
4       T Y
1       Q V
5       U Z
3       S X
2       R W
2       R W
4       T Y
3       S X
5       U Z
1       Q V 
```

这似乎对我有用！但是，我有一些悬而未决的问题/问题：

1）有没有更优雅或更有效的方法来做到这一点，最好只使用单个数据帧df？

2）要匹配“数字”，此方法是否仅使用该列中匹配的第一个实例？

3) 有没有一种好方法来测试现有的“a”和“b”值是否已正确分配（即相同“数字”的每个实例具有相同的“a”和“b”。这与问题#有关2 直接在上面。

感谢您对此的任何建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T20:02:45.513

我认为 DWin 在这里有正确的想法，但没有理由创建额外的数据框。'match' 函数只找到第一个匹配项，因此我们不必担心数据帧的其余部分。你可以像这样缩写他的代码：

```
data[data$a=="",] <- data[match(data$number[data$a==""], data$number), ] 
```

就是这样。

用简单的英语，这段代码说，“对于缺少 'a' 值的集合行，在缺少的行中找到与 'number' 匹配的列 'number' 的第一行，并将整个匹配行写入旧的排。”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T19:42:19.330

构建两个data.frames：

```
dat <- read.table(text="number  a   b
1       Q   V
2       R   W
3       S   X
4       T   Y
5       U   Z", header=TRUE)
bigger <-read.table(text="number  a   b
1       Q   V
2       R   W
3       S   X
4       T   Y
5       U   Z
3       S   X
2       R   W
4       T   Y
1       Q   V
5       U   Z
4       
1       
5       
3       
2       
2       
4       
3       
5       
1", header=TRUE, fill=TRUE) 
```

然后从 samller 中拉入匹配的行来填充缺失的数据：

```
bigger[bigger$a=="", ] <- dat[match( bigger$number[bigger$a==""], dat$number), ]
> bigger
   number a b
1       1 Q V
2       2 R W
3       3 S X
4       4 T Y
5       5 U Z
6       3 S X
7       2 R W
8       4 T Y
9       1 Q V
10      5 U Z
11      4 T Y
snipped output 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T18:26:36.900

如果您告诉我们您将如何输入这些数据，那就太好了，因为那些回答的人会更准确地回答。

在 python 中提出了解决方案的想法。

```
class Sequence(object):       

    def __init__(self):

        self.D = {
                    1 : ['Q','V'],
                    2 : ['R','W'],
                    3 : ['S','X'],
                    4 : ['T','Y'],
                    5 : ['U','Z'],
                 }

    def add(self, val, *a_b):

        self.D[val] = [a_b[0],a_b[1]]

    def find(self, seed):

        ##  Add all the enteries you want to add in this dict.
        return self.D[seed]

    def ret_all(self):
        return self.D

# Initialize    
s = Sequence()

# Add new item
s.add(9,['M','V'])

# Find by index
cols = s.find(3)
print 'a col: ', cols[0]
print 'b col: ', cols[1]

# Show all the list
All = s.ret_all()

for i,v in All.items():
    print i, [v for x in v] 
```

如果那是你想要的，请告诉我。

# javascript - Calling a regular JS function from a Sencha Touch Class

> ID：14485991
> 
> 赞同：0
> 
> 时间：2013-01-23T17:43:55.070
> 
> 标签：javascript, facebook, facebook-graph-api, extjs, sencha-touch

could someone please explain how i can do this? Im trying to get a FB access token and append it to a URL string in a store config. As such...

```
Ext.define('clubs.store.FacebookEvent', {
extend: 'Ext.data.Store',
requires: [
    'clubs.model.FacebookEvent'
],

config: {
    autoLoad: true,
    model: 'clubs.model.FacebookEvent',
    //storeId: 'FacebookEventStore',
    proxy: {
        type: 'jsonp',
        url: 'https://graph.facebook.com/474381199275383/?fields=description,name&access_token=' + getAccessCode(),

        reader: {
            type: 'json'
            //rootProperty: 'data'
        }
    }
}

});

function getAccessCode(){
FB.getLoginStatus(function(response) {
    if (response.status === 'connected') {
        var uid = response.authResponse.userID;
        var accessToken = response.authResponse.accessToken;
        console.log(accessToken);
    }
});
return accessToken; 
```

}

However i seem to always get this error in my JS console...

```
uncaught Error: The following classes are not declared even if their files have been loaded: 'club.store.FacebookEvent'. Please check the source code of their corresponding files for possible typos: 
```

Am i going about this the wrong way? Any help would be much appreciated!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T07:52:42.873

Ideally you should put this in controller or any singleton utility class and then access it like this:

```
this.getApplication().getController('ControllerName').getAccessCode() 
```

OR

```
UtilsClass.getAccessCode() 
```

But if you want to keep it here you have to define the function like this:

```
config : {
    //..blah blah
},
getAccessCode : function(){
  FB.getLoginStatus(function(response) {
    if (response.status === 'connected') {
    var uid = response.authResponse.userID;
    var accessToken = response.authResponse.accessToken;
    console.log(accessToken);
    }
  });
  return accessToken;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T17:46:57.107

You only need to change the class definition from

```
Ext.define('clubs.store.FacebookEvent', 
```

to

```
Ext.define('club.store.FacebookEvent', 
```

In fact your app name is **club** and not **clubs**.

# .net - 找不到 Oracle OpenSSO Fedlet .NET 主文件夹

> ID：14485992
> 
> 赞同：3
> 
> 时间：2013-01-23T17:43:58.120
> 
> 标签：.net, oracle, opensso

我正在尝试使用 Oracle Open SSO Fedlet，我已经使用 Fedlet 提供的示例应用程序成功连接到 IDP，但是当我将 dll 放到我的应用程序的 bin 目录中并将配置文件添加到 App_Data 目录时并尝试访问我收到错误消息的应用程序

> 找不到指定的主文件夹

据我了解，默认主文件夹应该是 App_Data 但这存在，这是我放置配置文件的地方。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T11:29:02.243

当您将网页放入除根目录之外的任何文件夹时，会导致此错误。然后，您可以通过将 App_Data 文件夹放入该文件夹来使其工作。

例如，如果您创建一个名为 Pages 的文件夹，并将您的网页放在其中，然后创建另一个名为 Pages\App_Data 的文件夹，并将当前项目 App_Data 文件夹中的所有文件放入新文件夹中，一切都会再次运行

# ios - UITableViewController 不会调用 cellForRowAtIndexPath 但 numberOfSectionsInTableView 和 numberOfRowsInSection 设置正确

> ID：14485996
> 
> 赞同：3
> 
> 时间：2013-01-23T17:44:06.733
> 
> 标签：ios, objective-c, uitableview

**解决方案：**

解决方案是首先正确地从 UITableView 开始，然后将 UITableView 委托添加到 UIViewController，如所选答案中所述。

**前言：我几乎阅读了所有关于此事的文章，但没有任何建议有帮助。**

我将 UITableViewController 的 UITableView 嵌入到 UIViewController 中。

我知道除非渲染视图，否则不会调用任何内容，所以我渲染它，我可以使用 NSLog 来显示它命中了这些方法。

我尝试在 InterfaceBuilder 中制作一个 UITableViewController 并将我的子类设置为它的自定义类，它有效！但这不是我需要做的。这是我收集/完成的内容：

*   我正在使用 InterfaceBuilder 来管理 UIViewController 但我正在以编程方式添加 UITableView
*   委托和数据源都设置正确并且 self.tableView 不是 nil
*   尽管记录有效，但从未调用 cellForRowAtIndexPath 并且呈现的 UITableView 为空白
*   我将代表添加到我的控制器中，但没有改变任何东西

我在 UITableViewController 上设置了以下内容：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    NSLog(@"%@", self.questions); // This outputs the questions array as not empty and works
    // As you can see I am also returning 1.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSLog(@"%d", [self.questions count]); // This outputs 4 as it should
    return [self.questions count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // All we need to focus on is this NSLog which never outputs
    NSLog(@"Was called and array is, %@" self.questions);

    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    return cell;
} 
```

我尝试了多种方式设置视图：直接添加 UITableViewController，添加 UITableViewController 的 UITableView（这似乎是正确的方法），但没有任何效果。

也许在使用 InterfaceBuilder 时我忘记了一个重要步骤，或者我忘记了一些随机的事情。任何帮助，将不胜感激。谢谢！

** 更新 ** 这是我添加 UiTableViewController 或 UITavleView 的方法

```
GTTableViewController *tvc = [[GTTableViewController alloc] initWithStyle:UITableViewStylePlain];
// Either
[self.view addSubview:tvc.view];
// OR
[self.view addSubview:tvc.tableView];
// Just to make sure everything is still ok.. and I see the 2/3 TV methods fire.
[self.tableView reloadData]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-23T18:24:18.643

我不会尝试分析您的代码，而是向您展示一个简单的示例，如何以编程方式将表视图添加到**不是**`UITableViewController`. 希望这将帮助您自己解决问题。

在 .h 文件中：

```
@interface MyViewController : UIViewController <UITableViewDelegate, UITableViewDataSource>
{
}
@end 
```

在 .m 文件中：

```
- (void) loadView
{
  CGRect mainViewFrame = CGRectMake(...);
  self.view = [[[UIView alloc] initWithFrame:mainViewFrame] autorelease];

  // You could make this even simpler if you set the table view as
  // your main view
  CGRect tableViewFrame = self.view.bounds;
  UITableView* tableView = [[[UITableView alloc] initWithFrame:tableViewFrame style:UITableViewStylePlain] autorelease];
  [self.view addSubview:tableView];

  tableView.delegate = self;
  tableView.dataSource = self;
} 
```

差不多就是这样。没什么了不起的，但是通过这个简单的设置，`UITableViewDataSource`数据源方法应该可以愉快地触发，包括`tableView:cellForRowAtIndexPath:`. 至少他们在这里做...

我建议你举这个例子，让它在你的环境中工作。然后你慢慢地一步一步地把它改造成你想要的设计。在某些时候，事情会停止工作，然后你就会找到问题的根源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-24T14:28:35.693

封闭的 UIViewController 是 UITableViewController 的容器控制器。UIViewController 文档对此有一个部分：

[https://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW81](https://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW81)

我有一个类似的情况，添加对方法“addChildViewController”的调用解决了这个问题：

```
[self addChildViewController:tvc]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T17:48:47.643

tableView 的框架是什么？您可以使用 打印它`NSLog(@"%@", NSStringFromCGRect(self.tableView.frame));`。预感是0,0,0,0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T17:49:13.987

1 - 检查 numberOfRowsInSection 返回的内容。它是否返回值 > 0？（听起来很愚蠢，我也犯了这样的错误）

2 - 在您的 IB 中，检查表格视图单元格类型 - 它是静态的还是动态的？如果是静态的，它甚至不会查看您的代码。

3 - 你在适当的地方调用 reloaddata 吗？

4 - 在您的视图控制器头文件（或声明它的任何位置）中，您是否从委托 UITableViewDelegate 和 UITableViewDataSource 继承？