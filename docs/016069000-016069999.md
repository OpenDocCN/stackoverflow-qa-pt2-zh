# StackOverflow 问答 16069000-16069999

# paypal - PayPal IPN 历史页面错误（重新发送消息不起作用）

> ID：16069000
> 
> 赞同：1
> 
> 时间：2013-04-17T19:53:05.850
> 
> 标签：paypal, history, paypal-ipn

我使用 Zapier 向 Freshbooks 发送 PayPal IPN 消息，以便从销售中创建新客户。

几秒钟前，Zapier 从我的 Wufoo 订单表格中发送一条消息以创建新发票（然后我在 Freshbooks 中手动将它们链接起来）。

Wufoo 劫持了 Freshbooks API，我从 PayPal 到 Freshbooks 的 Zapier 'Zaps' 失败了。

我通过每天访问一次 PayPal IPN 历史记录并重新发送 IPN 消息来解决此问题，从而使 Zaps 成功。

这对我来说不是太麻烦。

但是，在过去 2 周左右的时间里，PayPal IPN 历史页面上的重新发送消息一直不起作用。它说成功，但没有将通常的“（重新发送）”项目添加到历史列表中，并且没有任何内容发送到 Zapier。

目前 IPN 历史记录是否存在已知问题？还有什么我可以做的，还是只需要等待 PayPal 来修复它？

干杯，

P。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T15:03:06.340

在纠缠技术支持后，我得到了这个答案：

**“历史的更新计划在下周进行。”**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T18:52:45.043

是的，这是一个已知问题，因为过去几周我遇到了同样的问题。我向 Paypal 发送了故障单并收到以下回复：“*感谢您联系 PayPal 商户技术服务。我们知道此问题并正在努力解决它。我将进一步研究此问题并为您提供更多信息，如它变得可用。* ”

那是 4/13。我今天又发了一条消息，要求更新，但还没有收到回复。

希望这可以帮助。

# java - 如何处理 iText“意外色彩空间/CS0”类型的异常

> ID：16069004
> 
> 赞同：5
> 
> 时间：2013-04-17T19:53:13.460
> 
> 标签：java, exception, pdf, itext, color-space

我有一些由未知来源生成的文件，可以在 PDF 浏览器（Reader/Foxit）中正常打开，但 iText 无法处理它们。对于特定文件，我得到：

```
Exception in thread "main" java.lang.IllegalArgumentException: Unexpected colorspace /CS0
        at com.itextpdf.text.pdf.parser.InlineImageUtils.getComponentsPerPixel(InlineImageUtils.java:238)
        at com.itextpdf.text.pdf.parser.InlineImageUtils.computeBytesPerRow(InlineImageUtils.java:251)
        at com.itextpdf.text.pdf.parser.InlineImageUtils.parseUnfilteredSamples(InlineImageUtils.java:280)
        at com.itextpdf.text.pdf.parser.InlineImageUtils.parseInlineImageSamples(InlineImageUtils.java:320)
        at com.itextpdf.text.pdf.parser.InlineImageUtils.parseInlineImage(InlineImageUtils.java:153)
        at com.itextpdf.text.pdf.parser.PdfContentStreamProcessor.processContent(PdfContentStreamProcessor.java:370)
        at com.itextpdf.text.pdf.parser.PdfReaderContentParser.processContent(PdfReaderContentParser.java:79) 
```

有时 /CS0 颜色空间会更改为 /CS1 到 /CS9（或类似的东西）。

是 iText 错误（我使用的是 java 1.7、iText 5.4.1）还是我的 pdf 文件刚刚损坏？即使pdf文件损坏了，有什么办法可以修复它们吗？（Adobe Reader 似乎以某种方式做到了这一点，但不幸的是，打开文件并再次保存它不起作用）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-22T10:12:36.977

我不熟悉 PDF 规范，所以我不知道我使用的 PDF 是否有效。然而，我确实设法通过更改文件 com.itextpdf.text.pdf.parser.InlineIamgeUtils 方法 getComponentsPerPixel(...) 中的 iText 来解决问题：

```
private static int getComponentsPerPixel(PdfName colorSpaceName, PdfDictionary colorSpaceDic){
        if (colorSpaceName == null)
            return 1;
        if (colorSpaceName.equals(PdfName.DEVICEGRAY))
            return 1;
        if (colorSpaceName.equals(PdfName.DEVICERGB))
            return 3;
        if (colorSpaceName.equals(PdfName.DEVICECMYK))
            return 4;

        if (colorSpaceDic != null){
            PdfArray colorSpace = colorSpaceDic.getAsArray(colorSpaceName);
            if (colorSpace != null){
                if (PdfName.INDEXED.equals(colorSpace.getAsName(0))){
                    return 1;
                }
            }
        }

        throw new IllegalArgumentException("Unexpected color space " + colorSpaceName);
    } 
```

至

```
private static int getComponentsPerPixel(PdfName colorSpaceName, PdfDictionary colorSpaceDic){
        if (colorSpaceName == null)
            return 1;
        if (colorSpaceName.equals(PdfName.DEVICEGRAY))
            return 1;
        if (colorSpaceName.equals(PdfName.DEVICERGB))
            return 3;
        if (colorSpaceName.equals(PdfName.DEVICECMYK))
            return 4;

        if (colorSpaceDic != null){
            PdfArray colorSpace = colorSpaceDic.getAsArray(colorSpaceName);
            if (colorSpace != null){
                if (PdfName.INDEXED.equals(colorSpace.getAsName(0))){
                    return 1;
                }
            } /* Begin mod # */ else {
                PdfName tempName = colorSpaceDic.getAsName(colorSpaceName);
                if(tempName != null) return(getComponentsPerPixel(tempName, colorSpaceDic));
            } /* End mod */
        }

        throw new IllegalArgumentException("Unexpected color space " + colorSpaceName);
    } 
```

# css - 带有媒体查询的奇怪 DIV 行为

> ID：16069008
> 
> 赞同：1
> 
> 时间：2013-04-17T19:53:29.997
> 
> 标签：css

在下一页 ( [http://www.ecu.edu/cs-cas/engl/tpc/whytpc.cfm](http://www.ecu.edu/cs-cas/engl/tpc/whytpc.cfm) ) 上，您可以看到，在移动设备上，这些列折叠成一个列。然而，出现在右栏中的内容稍微向右移动。媒体查询中的 CSS 是：

```
@media only screen and (max-device-width: 480px) {
#content {
    float:left;
    max-width:50%;
    padding:1em 0 1em 0%;
}

#sidebar {
    float:left;
    max-width:50%;
    padding-top:1em;
}
.spacerMain {
    display: block;
    padding: none;
    color: #2a272e;
    width: 100%;
}

.column {
    display: block;
    width: 100%;
    float: left;
    clear: both;
}

.spacerCol {
    display: block;
    width: 100%;
    padding: none;
    color: #2a272e;
    clear: both;
    float:left;
}
} 
```

和 HTML：

```
<div id="container">
  <div id="header">
    <div id="navigation">
      <ul>
        <li><a href="/cs-cas/engl/tpc/index.cfm">Home</a></li>
        <li><a href="/cs-cas/engl/tpc/whytpc.cfm">Why TPC?</a></li>
        <li><a href="/cs-cas/engl/tpc/tpcprograms.cfm">Programs</a></li>
        <li><a href="/cs-cas/engl/tpc/tpcsocial.cfm">TPC Social</a></li>
        <li><a href="/cs-cas/engl/tpc/contactus.cfm">Questions?</a></li>
      </ul>
    </div>
    <div id="navigation2">
      <ul>
        <li><a href="http://www.facebook.com/ecutpc"><img width="45px" height="45px" alt="Facebook" src="/cs-cas/engl/tpc/customcf/facebook.png" /></a></li>
        <li><a href="http://www.twitter.com/ecutpc"><img width="45px" height="45px" alt="Twitter" src="/cs-cas/engl/tpc/customcf/twitter.png" /></a></li>
        <li><a href="http://www.linkedin.com/pub/brent-henze/b/35a/b34"><img height="45px" alt="Linked In" src="/cs-cas/engl/tpc/customcf/linkedin.png" /></a></li>
        <li><a href="http://www.ecu.edu/english"><img width="45px" height="45px" alt="Purple Bard" src="/cs-cas/engl/tpc/customcf/bardicon.png" /></a></li>
      </ul>
    </div>
  </div>
  <div id="content">
    <div id="main">
      <div id="spacerMain">
        <div class="column">
          <div class="spacerColFirst">
            <h3 class="sectionTitle">Why TPC at ECU?</h3>
            The ECU Department of English offers two innovative online graduate programs in technical and professional communication: the <a href="http://www.ecu.edu/cs-cas/engl/graduate/degreesoptions.cfm#CP_JUMP_96324"><span style="color: rgb(4, 46, 238); ">Certificate in Professional Communication</span></a> and the <a href="http://www.ecu.edu/cs-cas/engl/graduate/degreesoptions.cfm#CP_JUMP_96211">MA concentration in TPC</a>.</div>
          <div class="spacerColFirst"><br />
          </div>
          <div class="spacerColFirst">Every profession needs excellent communicators, and communication itself is becoming an increasingly complex skill set that combines strong writing and editing skills, teamwork, technological sophistication, leadership, adaptability, global awareness, and disciplinary knowledge.<br />
            <br />
            As part of our master&#39;s degree program, you will gain broad proficiency in all these essential areas. In consultation with your faculty advisor and other mentors, you can also focus on one or more areas of emphasis, including&nbsp;</div>
          <div class="spacerColFirst">
            <ul>
              <li><span style="line-height: 1.3em;"><font size="2">technical editing and publishing</font></span></li>
              <li><span style="line-height: 1.3em;"><font size="2">emerging media and communication technologies</font></span></li>
              <li><span style="line-height: 1.3em;"><font size="2">teaching and training; and&nbsp;</font></span></li>
              <li><span style="line-height: 1.3em;"><font size="2">public and civic communication in contexts such as healthcare, science, government, or service organizations.</font></span></li>
            </ul>
            As a certificate student, you can broaden your communication proficiency by sampling across the range of our courses or develop advanced skills in a specific area of interest.<br />
            <br />
            As members of a large and dynamic English department, MA students are also encouraged to take advantage of the full range of courses offered in other areas of English, including rhetoric and composition, linguistics and TESL, film, folklore, literature, creative writing, and multicultural and transnational studies.</div>
        </div>
      </div>
      <div class="column">
        <div class="spacerCol">
          <h3 class="sectionTitle">TPC and your Career Goals</h3>
          Our programs offer practicing communication professionals the opportunity to step back from their everyday tasks to reconsider the technological changes and communication principles that shape their work environments.<br />
          <br />
          Our courses combine cutting-edge theories and contemporary professional practices. Many courses use a project approach, helping students to develop sophisticated workplace communication products while they learn fundamental principles of professional communication in contemporary workplaces.<br />
          <br />
          Our graduates become public information officers, fund raising and educational outreach professionals, program directors and communication specialists, trainers, content developers, technical editors, and technical communicators in high-tech industries. Others become educators at community colleges or four-year colleges and universities.<br />
          <br />
          If your career goals include effective communication, our programs can help.</div>
      </div>
    </div>
  </div>
  <div id="sidebar">
    <dl>
      <dt>Program Links</dt>
      <dd><a href="http://www.ecu.edu/cs-cas/engl/graduate/degreesoptions.cfm#CP_JUMP_96211">MA Degree (TPC Concentration)</a></dd>
      <dd><br />
      </dd>
      <dd><a href="http://www.ecu.edu/cs-cas/engl/graduate/degreesoptions.cfm#CP_JUMP_96324">Graduate Certificate in TPC</a></dd>
      <dd><br />
      </dd>
      <dd><a href="/cs-cas/engl/tpc/tpcadvising.cfm">Course Advising and Registration</a></dd>
      <dd><br />
      </dd>
      <dd><a href="http://www.ecu.edu/cs-acad/gradschool/results.cfm?id=8">English Graduate Program</a></dd>
      <dd><br />
      </dd>
      <dd><a href="http://www.ecu.edu/cs-acad/grcat/programENGL.cfm">English Graduate Catalog</a></dd>
      <dd><br />
      </dd>
      <dd><a href="http://www.ecu.edu/cs-acad/grcat/coursesENGL.cfm">English Graduate Curricula</a><br />
        <br />
      </dd>
    </dl>
    <dl>
      <dt>Links for Students</dt>
      <dd><a href="http://www.ecu.edu/cs-cas/engl/">ECU Department of English</a><br />
        <br />
        <a href="http://www.ecu.edu/gradschool/">The Graduate School at ECU</a><br />
        <br />
        <a href="http://www.ecu.edu/fsonline/senate/fscalend.cfm">ECU Academic Calendars</a><br />
        <br />
        <a href="http://blackboard.ecu.edu">Blackboard Student Access</a><br />
        <br />
        <a href="http://mymail.ecu.edu">Student E-Mail Access</a><br />
        <br />
        <a href="https://pirateport.ecu.edu/portal/">Pirate Port</a><br />
      </dd>
    </dl>
    <dl>
      <dt><a href="http://www.twitter.com/ecutpc">@ECUTPC</a></dt>
      <dd>
        <ul id="twitter_update_list">
          <li style="list-style: none">%nbsp</li>
          <li class="twitter_date">%nbsp</li>
        </ul>
      </dd>
    </dl>
  </div>
  <div id="footer">&nbsp;</div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:30:23.997

我`margin-left: -2m;`在 CSS 中使用 a 来修复文本列问题。这似乎已经在移动浏览器上清除了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:29:27.990

它没有移动，侧边栏仅占据宽度的 50%。

但是，在侧边栏中，“dl”元素的边距为 1em；那就是你看到的空间，使它看起来像“移位”。

无论如何，如果您要占用此边距，则应在左列右侧留出一些边距，否则它们将“触动”

# c# - 不允许使用抽象字段。如何强制派生类实例化/初始化字段？

> ID：16069011
> 
> 赞同：2
> 
> 时间：2013-04-17T19:53:48.603
> 
> 标签：c#, field, abstract

我有一个通用“设备”类型的抽象基类，并希望要求派生的特定设备类根据它们各自的差异初始化一个列表。

当将派生类设置为活动时，它必须通过列表将参数也设置为活动。每个派生类都会将自己的参数插入到列表中。

以下是相关代码：

基类：

```
 abstract public class Device : Common, IDisposable
        {
          abstract public Boolean bActive
          {
            get;
            set;
          }

          abstract List<Parameters> ActiveParameters;
          ...
        } 
```

我不希望在基类中初始化 List，因为我不知道哪些参数将从派生类插入到列表中。这段代码产生一个错误，说我不能有一个抽象字段，我明白这一点，但是有没有办法要求派生类从基类初始化一个字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:55:15.790

> 这段代码产生一个错误，说我不能有一个抽象字段，我明白这一点，但是有没有办法要求派生类从基类初始化一个字段？

如果这需要实现，它应该是您 API 的一部分。要处理此问题，您可以将其设为受保护的属性。这将强制它由所有派生类实现。

```
protected abstract List<Parameters> ActiveParameters { get; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T21:07:39.743

如果这是关于初始化列表，那么您可以通过将该列表放入基类的构造函数（或所有构造函数，如果您有更多构造函数）中来强制执行该操作。

就像是：

```
public abstract class Device : Common, IDisposable
{
    protected Device(List<Parameters> activeParameters)
    {
        ActiveParameters = activeParameters;
    }

    protected List<Parameters> ActiveParameters { get; private set; }
} 
```

然后派生类将被迫执行以下操作：

```
public class ConcreteDevice : Device
{
    public ConcreteDevice()
       : base(new List<Parameters>())
    {}
} 
```

# macos - Mac OS X 上 Rubymine 全屏模式的快捷方式

> ID：16069014
> 
> 赞同：0
> 
> 时间：2013-04-17T19:54:00.693
> 
> 标签：macos, keyboard-shortcuts, fullscreen, rubymine

您可以通过导航到 Rubymine 进入全屏模式`MENU > VIEW > ENTER FULL SCREEN`。进入全屏模式后，将鼠标移动到屏幕顶部会触发菜单栏下拉菜单，您可以再次导航到`MENU > VIEW >`（现在更改为）`EXIT FULL SCREEN`。

有人知道 Mac 上的快捷方式吗？我认为 OS X 有一个 - 不确定它是什么，但在 Windows 的任何地方都找不到任何人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:56:38.707

`CTRL-COMMAND-F`

OS X KeyMap 备忘单在这里： http: [//www.jetbrains.com/ruby/docs/RubyMine_ReferenceCard_Mac.pdf](http://www.jetbrains.com/ruby/docs/RubyMine_ReferenceCard_Mac.pdf)

# css - IE10 不会触发动画（水平移动图片）

> ID：16069016
> 
> 赞同：1
> 
> 时间：2013-04-17T19:54:12.203
> 
> 标签：css, animation, internet-explorer-10

我在 IE10 中没有触发的 CSS3 动画有点问题。

我基本上有一个静态图像，大部分是透明的，但有一些细节，在它后面有一个应该水平移动的背景图像。它在 Chrome 中运行良好，但在 IE10（win7）中运行良好，我不知道我做错了什么。

各种提示和技巧将不胜感激。

```
<div id="skyover">
    <img src="hh_sky_transp2.png" alt="logo" width="1000" height="202" />
</div>
<div id="sky">
    <img src="hh_sky.jpg" alt="logo" width="2016" height="202" />
</div> 
```

```
#skyover {
    position: absolute;
    z-index: 10;
}

#sky { 
    width: 1000px;
    height: 202px;
    position: relative;
    animation: skymove 10s infinite;
    animation-direction: alternate;
    -webkit-animation: skymove 10s infinite;
    -webkit-animation-direction: alternate;
}

@keyframes skymove {
    from { left: 0px; }
    to { right: 1000px; }
}

@-webkit-keyframes skymove {
    from { left: 0px; }
    to { right: 1000px; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:16:49.307

这里的问题是从左原点到右原点的动画：

```
@keyframes skymove {
    from { left: 0px }
    to { right: 1000px }
} 
```

如果将`to`原点更改为`left`，则问题得到解决：

```
@keyframes skymove {
    from { left:0px }
    to { left: 1000px }
} 
```

小提琴：http: [//jsfiddle.net/HGe5D/2/show/](http://jsfiddle.net/HGe5D/2/show/)

# c# - IronPython：从主机应用程序添加引用

> ID：16069017
> 
> 赞同：6
> 
> 时间：2013-04-17T19:54:13.127
> 
> 标签：c#, ironpython

在我的应用程序中，我使用 Iron Python 来提供脚本功能。问题是嵌入式脚本看不到我链接到应用程序的引用。据我了解，唯一的解决方案是从脚本中手动导入它们

```
import clr
clr.AddReference(...)
from ... import ... 
```

但我正在从文件中读取脚本，我不想像这样预先添加一堆导入。那么如何添加来自主机应用程序的引用？ScriptEngine / ScriptScope 看起来没有任何相关的方法:(

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T23:56:34.553

您想要的方法是`ScriptRuntime.LoadAssembly`，可以从您的 ScriptEngine 实例轻松访问：

```
engine.Runtime.LoadAssembly(typeof(System.Web.HttpContext).Assembly); 
```

# c# - 如何检查 DateTime 是否已初始化？

> ID：16069019
> 
> 赞同：1
> 
> 时间：2013-04-17T19:54:15.890
> 
> 标签：c#, windows, multithreading, datetime, timer

如果 Datetime 开始，我需要帮助制作一个每秒检查一次的代码。如果它已启动，它应该关闭已经运行的功能。我知道 dispatchertimer 但我希望它在后台运行线程。原因是因为我有一个媒体播放器，它一直播放到日期时间开始，导致电影每 1 秒重新启动一次。

如果你们能帮助我，我将非常感谢，有点绝望......

```
 Dictionary<string, string> listBox3Dict = new Dictionary<string, string>();
        private bool listbox3job()
        {
            AxWMPLib.AxWindowsMediaPlayer axWmp =
wfh.Child as AxWMPLib.AxWindowsMediaPlayer;
            DateTime? start = DateTimePicker1.Value;
            DateTime? end = DateTimePicker2.Value; // This. End date. If end date. Stop movie.
            DateTime now = DateTime.Now;

            if (start == null || end == null)
            {
            }
            else if (now >= start.Value && now <= end.Value)
                {
                    foreach (var selected in listBox3.Items)
                    {
                        string s = selected.ToString();

                        if (listBox3Dict.ContainsKey(s))
                        {
                            axWmp.URL = (listBox3Dict[s]);
                        }
                    }

                return true;
            }
            return false;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:18:23.117

好吧，根据我的更好判断，我将为您提供一个解决方案，让您每秒检查一次值。**我提供此解决方案**的唯一原因是该`AxWindowsMediaPlayer`对象没有在播放发生时触发的事件。您将需要构建一个`BackgroundWorker`来执行此操作：

```
var worker = new BackgroundWorker();
worker.WorkerSupportsCancellation = true;

worker.DoWork += (s, e) =>
{
    // here you will check the time
    while (end > DateTime.Now)
    {
        Thread.Sleep(1000);
    }
} 
```

当你准备好使用时，`BackgroundWorker`你会发出这个：

```
worker.RunWorkerAsync(); 
```

但是，我正在做出一些假设，因为您确实没有为您的问题付出足够的努力。我假设您要检查结束时间，`DateTime.Now`因为您声明了所有这些变量。我今天在这里也看到了一个类似的问题 - 执行几乎相同的操作。我做出这种假设的另一个原因是因为您使用的控件并没有真正为您提供确定媒体文件当前播放位置的良好机制。

今后，请在您的问题上投入更多的精力。请记住，我们对您在做**什么一无所知**，因此很难在没有任何上下文的情况下提供解决方案。我知道您可能很忙，并且您感觉自己处于紧缩状态，但是向我们提供的信息很少甚至没有，并不会加快流程 - 正如您从评论线程中看到的那样。

# cuda - Cuda cudaMemcpy2DArrayToArray 没有异步对应项

> ID：16069039
> 
> 赞同：1
> 
> 时间：2013-04-17T19:55:17.640
> 
> 标签：cuda

我正在使用：cudaMemcpy2DArrayToArray()。这个函数还有异步对应的吗？cudaMemcpy2DArrayToArrayAsync() 存在，不存在。我想避免我的 cuda 操作的隐式同步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T01:30:32.447

其他 10 个左右的 cudaMemcpy*() 调用都有一个异步版本，所以我的猜测是这个调用是以某种方式实现的，它阻止了一个完全异步的版本。但是请注意，文档说“此函数在**大多数**用例中表现出同步行为”，因此，它们似乎意味着：

1.  对于从可分页主机内存到设备内存的传输，在启动复制之前执行流同步。一旦可分页缓冲区已复制到暂存内存以进行 DMA 传输到设备内存，该函数将返回，但到最终目的地的 DMA 可能尚未完成。

2.  对于从固定主机内存到设备内存的传输，该函数相对于主机是同步的。

3.  对于从设备到可分页或固定主机内存的传输，该函数仅在复制完成后返回。

4.  对于从设备内存到设备内存的传输，不执行主机端同步。

5.  对于从任何主机存储器到任何主机存储器的传输，该函数相对于主机是完全同步的。

# scroll - 避免水平滚动，并在移动设备上居中内容

> ID：16069046
> 
> 赞同：1
> 
> 时间：2013-04-17T19:55:37.793
> 
> 标签：scroll, responsive-design, zooming, viewport

我有一个静态布局（750px 宽度），我试图让它居中渲染并禁用水平滚动。

我在谷歌上做了几十次搜索，尝试了很多不同的视口设置，但都没有奏效。

这是网站：www.motocross.es

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T04:54:00.633

那是因为你有`min-width:1200px`你的身体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:00:45.397

estilos_2012.css 第 18 行和第 11 行的最小宽度为：1200 像素。把它们取下来，你的问题就解决了。

另外，如果您想禁用水平滚动，则在要防止滚动的元素上隐藏一个 overflow-x: hidden 就可以了。在这里阅读更多信息[。](http://www.w3schools.com/cssref/css3_pr_overflow-x.asp)

# jsp - 无法添加一个或多个标记库（在 jspx 中）

> ID：16069052
> 
> 赞同：1
> 
> 时间：2013-04-17T19:55:49.657
> 
> 标签：jsp, tags, jstl, jspx, tld

当我尝试访问配置的索引页时出现以下错误：

```
/WEB-INF/JSP/index.jspx (line: 6, column: 67) Could not add one or more tag libraries 
```

这是我的 web.xml 的一部分

```
//...
<jsp-config>
    <taglib>
        <taglib-uri>http://www.myurl.com/url/url.tld</taglib-uri>
        <taglib-location>/WEB-INF/tld/url.tld</taglib-location>
    </taglib>
    <taglib>
        <taglib-uri>http://java.sun.com/jsp/jstl/core</taglib-uri>
        <taglib-location>/WEB-INF/tld/c.tld</taglib-location>
    </taglib>
</jsp-config>
</web-app> 
```

这是 index.jspx

```
<?xml version="1.0" encoding="utf-8"?>

<jsp:root   xmlns:c="http://java.sun.com/jsp/jstl/core"
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0"
        xmlns:url="http://www.myurl.com/url/url.tld">

<jsp:directive.page contentType="text/html" pageEncoding="UTF-8" />
<jsp:output omit-xml-declaration="true" />
<jsp:output doctype-root-element="HTML"
            doctype-system="about:legacy-compat" />

<html lang="en">
<head>
    <link rel="shortcut icon" href="${pageContext.request.contextPath}/resources/Images/favicon.ico"/>
    <link rel="stylesheet" type="text/css" media="screen" href="${pageContext.request.contextPath}/resources/CSS/main.css"/>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>url</title>

</head>
<body>
    <url:header>test</url:header>
    <c:out value="Feuer"></c:out>
</body>
</html>

</jsp:root> 
```

网址.tld

```
<?xml version="1.0" encoding="utf-8"?>

<taglib xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-jsptaglibrary_2_1.xsd"
    version="2.1">

<display-name>myurl - tag library</display-name>
<tlib-version>1.0</tlib-version>
<short-name>url-core</short-name>
<uri>http://www.myurl.com/url/url.tld</uri>

<tag-file>
    <name>header</name>
    <path>/WEB-INF/tag/common/header.tagx</path>
</tag-file>

</taglib> 
```

标头.tagx

```
<?xml version="1.0" encoding="utf-8"?>

<jsp:root xmlns="http://www.w3.org/1999/xhtml"
      xmlns:jsp="http://java.sun.com/JSP/Page" version="2.0"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

<header>
    <c:out value="FEUER"></c:out>
</header>

</jsp:root> 
```

我想不通是什么问题。。

如果我不插入“url”标签库并且不在“body”内使用它，我不会收到错误消息。

有人对这个问题有经验吗？我的 tld 有问题吗？

提前致谢

# grails - Grails 2.1.4 和 2.0.4 停止在 AWS Elastic Beanstalk 中提供随机 JS 和 CSS 文件

> ID：16069053
> 
> 赞同：3
> 
> 时间：2013-04-17T19:55:51.240
> 
> 标签：grails, amazon-web-services, grails-plugin, grails-2.0, amazon-elastic-beanstalk

我在 AWS Elastic Beanstalk 中运行的 Grails 应用程序存在很大问题。我们的应用程序使用 Tomcat 7 在 4 个实例上运行，有时它可以扩展到更多。有时，随机实例（4 个中的 1 个）会停止提供一些 JavaScript 或 css 文件。当我手动尝试使用 /js/my_script.js 或 /static/js/my_script.js 访问 URL 时，它会以 404 响应。修复它的唯一方法是重新启动应用程序服务器。我还注意到，有时它会在环境扩展之后发生。这是我用来加载资源的代码：

```
<script type="text/javascript" src="${resource(dir: 'js', file: 'my_script.js')}"></script> 
```

我无法在我的本地环境中重现这一点。我发现了一个非常相似但没有得到回答的问题： [Grails 2.0.4 stop serving certain images random in an AWS Elastic Beanstalk Environment](https://stackoverflow.com/q/11514658/2292199)

可能与此相关的另一个事实是 Elastic Beanstalk 的默认会话粘性已为此环境启用。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-04T17:35:02.217

我认为[Sérgio Michels](https://stackoverflow.com/users/800014/sergio-michels)应该是对的。资源插件有一个错误，并在该版本中得到解决，但它只是一个 RC，而不是最终版本。

对我来说工作，但我没有使用 AWS，请参阅下面的帖子：

[Grails：图像/ CSS 不时丢失](https://stackoverflow.com/questions/7432521/grails-images-css-missing-from-time-to-time/15174643#15174643)

# python - 尝试将文件中的信息读入Python中的两个列表

> ID：16069060
> 
> 赞同：0
> 
> 时间：2013-04-17T19:56:12.147
> 
> 标签：python, list, file-io, split, readline

我认为这是一个相对简单的问题，但我是初学者并且遇到了麻烦。我必须将文本文件中的信息读入 python 中的两个列表。

这是文本文件的示例，它被称为“ratings.txt”，三列是movieId|numberofRatings|averageRatings。

```
1|452|3.9
2|131|3.2
3|90|3
4|209|3.6
...
...
1321|2|2.5
...
...
1685|0|-nan
1686|0|-nan 
```

我需要将第二列和第三列数字读入两个单独的数组。第二列数字需要读入列表 numRatings。第三列需要读入列表avgRatings。文本文件从电影 1 到 1686

所以`numRatings`需要`[452,131,90,....0,0]` 和`avgRating`需要`[3.9,3.2,3,....-nan,-nan]`

我想我必须创建列表，然后创建循环来读取文本文件并将这些数字存储在数组中。

到目前为止，这是我的代码

```
f = open("ratings.txt") #opens the text file
line = f.readline() #reads in one line of the file
a = line.split("|") #splits the line of the file, for example line 1 looks like [1, 452, 3.9] 
```

在上面的代码中，如果我 print ，`a[0]`我分别得到、`a[1]`和。`a[2]``1``452``3.9`

如何一遍又一遍地执行此操作并将结果存储到数组中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T19:59:14.507

您确实有一个 CSV 样式的文件，因此请使用该[`csv`模块](http://docs.python.org/2/library/csv.html)：

```
import csv

results = []
with open('ratings.txt', 'rb') as f:
    reader = csv.reader(f, delimiter='|')
    for row in reader:
        results.append(row) 
```

您可以根据需要增加它；将第二列和第三列附加到单独的列表中，将它们转换为`int`s 和`float()`s，例如：

```
numRatings = []
avgRating = []
with open('ratings.txt', 'rb') as f:
    reader = csv.reader(f, delimiter='|')
    for row in reader:
        numRatings.append(int(row[1]))
        avgRating.append(float(row[2])) 
```

如果这*不是*CSV 样式的文件，您仍然会使用循环；您将直接在文件对象上循环：

```
with open('ratings.txt', 'rb') as f:
    for line in f:
        a = line.strip().split("|") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:00:20.207

像这样的东西：

```
In [56]: with open("abc") as f:
    numRatings=[]
    avgRating=[]
    for line in f:
        f,s,t=map(float,line.split("|"))
        numRatings.append(s)
        avgRating.append(t)
   ....:         

In [57]: numRatings
Out[57]: [452.0, 131.0, 90.0, 209.0]

In [58]: avgRating
Out[58]: [3.9, 3.2, 3.0, 3.6] 
```

或者 ：

```
In [68]: with open("abc") as f:
    z=zip(*(map(float,line.split("|")) for line in f))
    numRatings=z[1]
    avgRating=z[2]
   ....:     

In [69]: numRatings
Out[69]: (452.0, 131.0, 90.0, 209.0)

In [70]: avgRating
Out[70]: (3.9, 3.2, 3.0, 3.6) 
```

# actionscript-3 - 使用 actionscript 按键盘上的 enter 提交表单

> ID：16069062
> 
> 赞同：0
> 
> 时间：2013-04-17T19:56:21.990
> 
> 标签：actionscript-3, textinput, enter

当用户在 Inputfields 中输入内容并按下键盘上的 enter 按钮时，您如何捕获 KeyboardEvent 以供用户登录？

我想我知道代码的第一部分... txt_inputOne.addEventListener(KeyboardEvent.KEY_DOWN, keyHandler);

函数 keyHandler(event:Keyboardevent):void{ if(event.keyCode == Keyboard.ENTER)

在此之后，我对该怎么做感到困惑。要提交按回车按钮的表单，我需要提供文本输入的值吗？谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:01:26.633

您需要将事件侦听器添加到输入字段。

*   对于文本字段：

    ```
    textField.addEventListener(KeyboardEvent.KEY_DOWN,handler);
    function handler(event:KeyboardEvent){
       // if the key is ENTER
       if(event.charCode == 13){
       // your code here
       // use textField.text to get the value
       }
    } 
    ```

*   对于文本输入：

    ```
    textInput.addEventListener(ComponentEvent.ENTER, listenerMethod);
    function handler(e:ComponentEvent):void{
            // your code here
            // use textInput.text to get the value
    } 
    ```

# version-control - 我需要一个用于 Word、PDF 和 Zip 文件的轻量级版本管理系统

> ID：16069067
> 
> 赞同：-1
> 
> 时间：2013-04-17T19:56:44.910
> 
> 标签：version-control

我正在构建一个允许用户上传 Word、PDF 和 Zip 文件的系统。

有时，他们会查看这些文件并上传较新的版本。我也需要保留旧版本，因为他们也希望能够下载它们。

而不是完整存储所有版本，我宁愿存储第一个版本，以及后续版本的差异。基本上，我需要将文档的所有版本存储在尽可能小的空间中。（也许它可以以不同的方式完成，没有差异？）。

无需合并更改、多用户、分布式或任何版本控制系统通常附带的高级功能。该工具的所有使用都将通过我的应用程序进行。

是否有一个易于学习、轻量级、开源的包，具有良好的 JVM（或 REST）互操作性，我可以用于此目的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:16:31.190

无需重新发明轮子。

JavaHL 或 SVNKit 将允许您使用来自 Java 的 Subversion 存储库

# shell - 删除 bourne shell 脚本末尾的临时文件

> ID：16069072
> 
> 赞同：0
> 
> 时间：2013-04-17T19:56:56.807
> 
> 标签：shell, sh, temporary-files, shell-trap

我尝试使用`trap`在 Bourne shell 脚本末尾删除一个临时文件，但这不起作用：

```
trap "trap \"rm \\\"$out\\\"\" EXIT INT TERM" 0 
```

顺便说一句，这是在函数内部，因此尝试嵌套陷阱。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T23:34:02.760

您只能为每个信号设置一个陷阱。如果脚本的不同部分需要执行不同的清理操作，则必须创建清理操作列表。然后设置一个单独的陷阱处理程序来执行所有必需的清理操作。

这是一个例子：

```
set -xv

PROG="$(basename -- "${0}")"

# set up your trap handler

TEMP_FILES=()

trap_handler() {
    for F in "${TEMP_FILES[@]}"; do
        rm -f "${F}"
    done
}

trap trap_handler 0 1 2 3 15

something_that_uses_temp_files() {
    mytemp="$(mktemp -t "${PROG}")"
    TEMP_FILES+=("${mytemp}")

    date > "${mytemp}"

    # ...
}

# ...

something_that_uses_temp_files

# ... 
```

有一个陷阱处理程序，但您可以通过附加到`TEMP_FILES`数组从脚本中的任何位置注册清理操作。清理动作也可以从内部函数中注册。

* * *

如果你不使用带数组的 shell，基本思想是一样的，但实现细节会有点不同。例如，您可以将列表存储为以冒号分隔的字符串变量，使用[`${parameter%%word}`每个 POSIX shell 中的扩展](http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html#tag_02_06_02)来遍历陷阱处理程序中的元素：

```
#!/bin/sh

set -xv

PROG="$(basename -- "${0}")"

# set up your trap handler

TEMP_FILES=""

trap_handler() {
    while [ -n "${TEMP_FILES}" ]; do
        CUR_FILE="${TEMP_FILES%%:*}"
        TEMP_FILES="${TEMP_FILES#*:}"
        if [ "${CUR_FILE}" = "${TEMP_FILES}" ]; then
            # there were no colons -- CUR_FILE is the last file to process
            TEMP_FILES=""
        fi

        if [ -n "${CUR_FILE}" ]; then
            rm -f "${CUR_FILE}"
        fi
    done }

trap trap_handler 0 1 2 3 15

something_that_uses_temp_files() {
    mytemp="$(mktemp -t "${PROG}")"
    TEMP_FILES="${TEMP_FILES}:${mytemp}"

    date > "${mytemp}"

    # ... }

# ...

something_that_uses_temp_files
something_that_uses_temp_files

# ... 
```

# c++ - 在 C++ 中将 DEFINE 与文字字符串混合

> ID：16069083
> 
> 赞同：1
> 
> 时间：2013-04-17T19:57:21.960
> 
> 标签：c++

我创建了一个指向特定目录的#define。然后我想将此定义与字符串文字结合使用：

```
#define PATH_RESOURCES "/path/to/resources/"
std::ifstream datafile(PATH_RESOURCES + "textures.dat"); 
```

但是，编译器抱怨使用 + 运算符添加 char 类型：

```
错误：“const char [11]”和“const char [13]”类型的无效操作数到二进制“operator+”</pre>

那么如何将#define 与字符串文字结合起来呢？或者，有没有更好的方法完全做到这一点？我想使用 const 变量将是另一种选择，但这意味着必须传递另一个参数，我宁愿将其保留为全局定义。

```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T19:58:57.010

您可以通过一个接一个地编写它们来组合两个字符串文字，它们`+`之间没有加号：

```
std::ifstream datafile(PATH_RESOURCES "textures.dat"); 
```

一个字符串文字恰好是通过预处理器定义的这一事实并没有太大变化：您也可以这样做：

```
std::ifstream datafile(PATH_"/path/to/resources/" "textures.dat"); 
```

这是[关于 ideone 的演示](http://ideone.com/IejqjH)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T19:59:09.263

尝试

```
 std::ifstream datafile(PATH_RESOURCES "textures.dat"); 
```

相邻连接的两个字符串文字。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T19:59:14.500

采用`std::ifstream datafile(PATH_RESOURCES "textures.data");`

请注意缺少 + 运算符。

你也可以做

`std::ifstream datafile(std::string(PATH_RESOURCES) + std::string("textures.data"));`如果你真的想要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T20:02:20.617

创建一个 std::string，将您的 #define 字符串分配给它并添加第二个文字。之后使用字符串。

```
std::string str(PATH_RESOURCES);
str = str + "textures.dat";
std::ifstream datafile(str); 
```

# javascript - 使用 JavaScript 更改 CSS 的问题

> ID：16069089
> 
> 赞同：2
> 
> 时间：2013-04-17T19:57:39.560
> 
> 标签：javascript, css

我正在为我正在处理的项目构建一个下拉菜单，但遇到了一些麻烦。它的构建使得每个子菜单的宽度和**style.left**由一个 JavaScript 函数设置，该函数在悬停根级菜单项时调用。当我悬停这些菜单项时，它看起来像这样：

![](https://i.imgur.com/1Ier1tq.png)

子菜单在左侧明显偏离了相当多的像素。如果我*不*改变子菜单的**style.left**，我会得到以下内容：

![](https://i.imgur.com/B7VrAU3.png)

这里对齐是正确的。Windows 7 和 Linux 的 Mozilla Firefox 和 Google Chrome 都出现了该故障，因此这不是与平台相关的故障。

这是产生错误的代码：

**菜单.js**

```
function show_sub_menu(cath){
    var menu_item = document.getElementById(cath)    //cath is an integer passed to the function
    var m_width = Math.floor(window.innerWidth*0.7*0.2);  //Menu is 70% of window, each item is 20% of menu
    menu_item.style.left = cath*m_width;  //Set the style.left dynamically depending on what menu item is to be displayed
                                          //This last line of code produces the error
} 
```

**菜单.css**

```
#m_wrapper{
    position:relative;
    width:100%;
}

#menu{
    position:relative;
    width:70%;
}

#menu li{
    width:20%;
    float:left;
}

#menu div{
    position:absolute;
    width:20%;
    top:30px;
}

#menu div a{
    position:relative;
    display:block;
    padding:5px;
} 
```

**菜单.htm**

```
<div id=m_wrapper>
    <ul id=menu>
        <li onMouseOver=show_sub_menu('0')>Item 1</li>
            <div id=0 onMouseOver=show_sub_menu('0')>
                <a href=#>Item 1.1</a>
                <a href=#>Item 1.2</a>
            </div>
        </li>
    </ul>
</div> 
```

我这看起来很不合逻辑，因为.js 中的**m_width**是，对于我的屏幕设置，235px 和**m_width*cath**是 0。我对 JavaScript 相当陌生，所以非常感谢帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:59:57.727

首先，您的列表项提前关闭，并且 ID 不应以数字开头。所以让我们清理一下：

```
<div id="m_wrapper">
    <ul id="menu">
        <li onMouseOver="show_sub_menu('0');">
            Item 1
            <div id="s0" onMouseOver="show_sub_menu('0');">
                <a href="#">Item 1.1</a>
                <a href="#">Item 1.2</a>
            </div>
        </li>
    </ul>
</div> 
```

接下来让我们看看你的 CSS。由于我们想要相对于主菜单项定位您的子菜单，因此让我们将`position:relative;`列表项本身放在一个空间中，我们可以从中放置其他内容。

现在我们有了一个上下文，其中子菜单根据您的列表项的左上角对齐，我们真正需要的是该菜单显示在该角下方 30 像素处 - 无需左右调整。

```
#m_wrapper{
    position:relative;
    width:100%;
}

#menu{
    position:relative;
    width:70%;
}

#menu li{
    position:relative;
    width:20%;
    float:left;
}

#menu div{
    position:absolute;
    width:100%;
    top:30px;
    left:0;
}

#menu div a{
    display:block;
    padding:5px;
} 
```

从这里开始，您的子菜单应该位于您需要的位置，但它*一直都在*显示。我们将通过添加和修改 JavaScript 来解决这个`display:none;`问题：`#menu div``display`

```
function show_sub_menu(cath){
    var menu_item = document.getElementById("s"+cath);
    menu_item.style.display = "block";
} 
```

这应该使您的菜单出现在您需要的地方和时间。我将把消失的行为留给你。

# r - 向量的积分返回一个值

> ID：16069090
> 
> 赞同：0
> 
> 时间：2013-04-17T19:57:40.977
> 
> 标签：r

我正在使用 R 进行一些多变量分析。对于这项工作，我需要集成三元 PDF。因为我想在 MLE 中使用它，所以需要一个集成向量。有没有办法让`Integrate`一个向量而不是一个值。

这是一个简单的例子：

```
f1=function(x, y, z) {dmvnorm(x=as.matrix(cbind(x,y,z)), mean=c(0,0,0), sigma=sigma)}
f1(x=c(1,1,1), y=c(1,1,1), z=c(1,1,1))
integrate(Vectorize(function(x) {f1(x=c(1,1,1), y=c(1,1,1), z=c(1,1,1))}), lower = -   Inf, upper = -1)$value

Error in integrate(Vectorize(function(x) { : evaluation of function gave a result of wrong length 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:47:34.767

要将一个变量的函数与向量值进行积分，可以将函数转换为 n 个具有实值的函数，并对它们中的每一个进行积分。这是非常低效的（当整合第 i 个函数时，我评估所有函数，并丢弃除一个值之外的所有值）。

```
# Function to integrate
d <- rnorm(10)
f <- function(x) dnorm(d, mean=x)

# Integrate those n functions separately.
n <- length(f(1))
r <- sapply( 1:n, 
  function(i) integrate( 
    Vectorize(function(x) f(x)[i]), 
    lower=-Inf, upper=0 
  )$value 
)
r 
```

对于二维积分，您可以检查`pracma::integral2`，但可能需要相同的操作（将具有向量值的二元函数转换为具有实值的 n 个二元函数）。

# symfony - Symfony2 Admingenerator vs. Sonata admin

> ID：16069094
> 
> 赞同：22
> 
> 时间：2013-04-17T19:58:03.657
> 
> 标签：symfony, sonata-admin

刚刚发现了这个新项目[Symfony2 Admin Generator](https://github.com/symfony2admingenerator/AdmingeneratorGeneratorBundle)。它用于轻松开发基于 symfony2 的应用程序的后端。

我想知道，这个工具与[Sonata 管理](http://sonata-project.org/bundles/admin/master/doc/index.html)项目有何不同？是否有任何用例首选这个新的管理生成器？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-30T06:42:02.090

> 这两个捆绑包正在积极开发中，因此这些考虑因素可能会在不久的将来发生变化。

我最近将我的管理面板从 symfony2admingenerator 迁移到了 SonataAdmin，部分原因是 symfony2admingenerator 中的一些错误，部分原因是我发现 SonataAdmin 更清晰。

*   SA 使用 OOP 方法，而 S2AG 依赖 yml 配置来定义管理面板

*   S2AG 需要通过命令（控制器、视图和 yml 配置）生成完整的 CRUD 结构，而 SA 面板只有 1 个 DI 服务类

*   在 S2AG 中，配置选项更加模糊，因为它们基于 yml 文件和自动生成的类，并且通常错误不会产生有意义的消息/堆栈跟踪

*   在 S2AG 中自定义字段的渲染更简单。

*   在 S2AG 网页中，一些参数（如列表的过滤器）存储在 Session 中，而不是存储在查询字符串中。这导致难以直接链接到过滤列表（例如：用户的评论）

*   SA 似乎更稳定，但 MongoDB 部分开发较少，功能也比 ORM 部分少。

# c# - 为什么 HttpClient 在这里出现死锁？

> ID：16069097
> 
> 赞同：1
> 
> 时间：2013-04-17T19:58:08.273
> 
> 标签：c#, networking, windows-runtime, dotnet-httpclient, winrt-async

我有一个在可移植类库中制作的 API，它需要访问特定于平台的 API 以发送 HTTP 请求。这是我编写的在 WinRT 上执行 HTTP POST 的方法：

```
 public bool Post(IEnumerable<KeyValuePair<string, string>> headers, string data)
    {
        bool success = false;
        HttpClient client = new HttpClient(new HttpClientHandler {AllowAutoRedirect = false});
        foreach (var header in headers)
        {
            client.DefaultRequestHeaders.Add(header.Key, header.Value);
        }

        try
        {
            var task=client.PostAsync(endpoint, new StringContent(data, Encoding.UTF8, "text/xml")).ContinueWith( postTask =>
                    {
                        try
                        {
                            postTask.Wait(client.Timeout); //Don't wait longer than the client timeout.
                            success = postTask.Result.IsSuccessStatusCode;
                        }catch {}
                    }, TaskContinuationOptions.LongRunning);
            task.ConfigureAwait(false);
            task.Wait(client.Timeout);

        }
        catch
        {
            success = false;
        }

        return success;
    } 
```

但是，当受到*任何*压力时，这会出现一个有趣的问题。它似乎在内部陷入僵局。就像我创建 5 个线程并从中发送 POST 请求一样，此方法将到达除了超时**之外什么都不做的地方。**内容永远不会到达服务器，`.Continue`代码也永远不会执行。但是，如果我连续运行它，或者甚至使用 2 或 3 个线程，它就可以正常工作。似乎抛出的线程越多，性能越差

究竟我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:19:15.133

我不认为这是你的问题所在，但它可能是，而且它很容易实现和测试。默认情况下，Windows 将最大网络连接数设置为 2，并且如果线程数超过 2，您可能会锁定连接池。您可以将其添加到您的应用程序配置中

```
<system.net>
  <connectionManagement>
    <add address="*" maxconnection="300" />
   </connectionManagement>
</system.net> 
```

或者在代码中你可以这样做

```
ServicePointManager.DefaultConnectionLimit = 300 
```

我还会考虑在继续中注释掉等待。我认为没有必要。

```
try
{
    //Comment this line out your handling it in the outside task already
    //postTask.Wait(client.Timeout); //Don't wait longer than the client timeout.
    success = postTask.Result.IsSuccessStatusCode;
 }catch {} 
```

最后，如果上面的两件事不起作用，我会尝试注释掉这段代码。

```
//Task.ConfigureAwait(false); 
```

可能是 Task.Wait 加上设置 Task.ConfigureAwait(false) 的组合导致某种死锁，但我不知道为什么。我只知道我有一些非常相似的代码可以很好地运行多线程并且我的代码中没有 Task.ConfigureAwait(false) ，主要是因为我尝试了 HttpClient 库但没有升级到 .NET 4.5所以 await 不可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T00:18:55.600

以下是当前代码让我印象深刻的一些事情：

*   `ContinueWith`*当任务完成*时，将委托排队运行。所以没有必要等待它。
*   `LongRunning`这里不需要；它会降低性能，因为您的延续非常快，根本不会长时间运行。
*   `ConfigureAwait`是没有意义的，因为没有`await`（并且返回值无论如何都会被丢弃）。
*   不需要传递超时，`Task.Wait`因为无论如何在超时之后任务已经完成。

> 我有一个在可移植类库中制作的 API，它需要访问特定于平台的 API 以发送 HTTP 请求。

我建议使您的 API 异步，因为它正在执行 HTTP。`Microsoft.Bcl.Async`如果您想在 PCL 中获得完整`async`/`await`支持，您可以使用。

```
public async Task<bool> Post(IEnumerable<KeyValuePair<string, string>> headers, string data)
{
    HttpClient client = new HttpClient(new HttpClientHandler {AllowAutoRedirect = false});
    foreach (var header in headers)
    {
        client.DefaultRequestHeaders.Add(header.Key, header.Value);
    }

    try
    {
        var result = await client.PostAsync(endpoint, new StringContent(data, Encoding.UTF8, "text/xml")).ConfigureAwait(false);
        return result.IsSuccessStatusCode;
    }
    catch
    {
        return false;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-04T09:26:14.900

当同时发出多个请求时，我也观察到了这个 HttpClientHandler 问题。（.NET 框架 4.7.2）

我能够通过将 .NET Core 2.1 SocketsHttpHandler 反向移植到 .NET Framework 来解决该问题，并且当同时发出数十个多个请求时，反向移植的[实现显着提高了性能。](https://github.com/TalAloni/StandardSocketsHttpHandler)

# visual-studio-2010 - 在 Visual Studio 2010 中调试需要客户端证书的网站

> ID：16069099
> 
> 赞同：1
> 
> 时间：2013-04-17T19:58:12.277
> 
> 标签：visual-studio-2010, iis-7, cryptography, client-certificates

我有一个在部署时使用 IIS7 托管的网站，但是我们看到我们使用的需要客户端证书的 Web 服务出现奇怪的行为。所以我想做的是在本地调试我们的网站以逐步执行代码并仔细查看问题。

问题是当我在本地运行它（调试它）时，我无法弄清楚如何让网站接受客户端证书。如果我只是在本地运行它并在使用我的客户端证书的网站上执行操作，它显然不会从浏览器中提取它，因为我收到“m_safeCertContext 是无效句柄”错误。

有没有办法让网站在本地运行时接受客户端证书？我在安装了 Visual Studio 2010 Professional 的同一台机器上安装了 IIS7，操作系统是 Windows 7。

谢谢。

# javascript - 使用 Greasemonkey 提交表单时出错

> ID：16069101
> 
> 赞同：0
> 
> 时间：2013-04-17T19:58:16.167
> 
> 标签：javascript, submit, greasemonkey

我正在使用 Greasemonkey 在外部站点上提交表单。但是，我遇到了一个问题，因为表单的提交按钮被命名为`submit`.

在 firebug 中，`document.filingform.submit();`返回错误：

> document.filingform.submit 不是函数

有没有办法可以使用 Greasemonkey 将提交按钮的名称更改为提交以外的名称，或者成功调用`submit()`表单的功能？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:15:24.723

这将是类似的东西`document.forms.filingform.submit();`，但不要那样做！

这种方法很容易被沙盒阻止。此外，某些页面需要 javascript 函数才能在合法提交上运行。提交页面并使其及其服务器满意的最可靠方法是“单击”提交按钮。

代码如：

```
var submitBtn   = document.querySelector ("form[name='filingform'] input[name='submit']");
var clickEvent  = document.createEvent ('MouseEvents');

clickEvent.initEvent ('click', true, true);
submitBtn.dispatchEvent (clickEvent); 
```

# php - 属性之间没有空格错误

> ID：16069102
> 
> 赞同：2
> 
> 时间：2013-04-17T19:58:17.160
> 
> 标签：php, javascript, html

```
<div class="suggestionList" id="autoSuggestionsList" onclick="document.forms["searchform"].submit();return false"> </div> 
```

当我右键单击 Firefox 并在我的网站上查看源代码时，我得到上面的代码有一个错误：属性之间没有空格

那个空间在哪里？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T19:59:37.250

也许尝试更改`document.forms["searchform"]`为`document.forms['searchform']`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T19:59:51.033

您需要正确嵌套引号：

`<div class="suggestionList" id="autoSuggestionsList" onclick="document.forms['searchform'].submit();return false"> </div>`

使用带有语法突出显示的文本编辑器可以更容易地发现这些错误。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T19:59:56.580

转义双引号，或使用单引号

您可以使用反斜杠转义它们：`attr="this.something[\"key\"]=value"`或任何您想要的。

更干净地使用单引号:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T20:00:04.673

```
onclick="document.forms["searchform"].submit();return false" 
```

应该

```
onclick="document.forms['searchform'].submit();return false" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-17T20:01:31.260

onclick 属性中存在语法错误：

```
onclick="document.forms["searchform"].submit();return false" 
```

你可以改写

```
onclick="document.forms['searchform'].submit();return false" 
```

# javascript - 方程式的Javascript代码

> ID：16069103
> 
> 赞同：1
> 
> 时间：2013-04-17T19:58:19.613
> 
> 标签：javascript, equation

我搜索了一个解决方案，但我一直遇到同样的问题。我有一个解决二次方程的javascript代码。这是我的代码::

```
var x1 = document.getElementById('x1').value;
var x2 = document.getElementById('x2').value;
var x3 = document.getElementById('x3').value;
var x4 = document.getElementById('x4').value;
var x5 = document.getElementById('x5').value;

var discriminant = (x2*x2)-(4*(x1*x3));
if (discriminant > -1){
var x1 = (-x2+Math.sqrt(discriminant))/(2*x1); 
var x2 = (-x2-Math.sqrt(discriminant))/(2*x1);
document.getElementById('totx1').value = x1;
document.getElementById('totx2').value = x2;
var temp1 = (x5*x1)+1*x4;
document.getElementById('toty1').value = temp1;
var temp2 = (x5*x2)+1*x4;
document.getElementById('toty2').value = temp2;} 
```

由于某些原因，x1 是正确的，但 x2 给了我错误的结果。有人可以帮我吗？在这里您可以看到一个输入示例：

2x^2 + 2x - 40 = 0 | y= x4 + x5

正确的解是 [x1= 4 || y1= 5] 和 [x2= -4 || y2= -5] 但我得到 [x1= 4 || y1= 5] 和 [x2= -10 || y2= -9]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:00:00.470

使用 parseFloat ：

```
var x1 = parseFloat(document.getElementById('x1').value); 
```

并为输入和输出使用不同的变量名：你重用的事实`x1`使这个错误：

```
var x1 = (-x2+Math.sqrt(discriminant))/(2*x1); 
var x2 = (-x2-Math.sqrt(discriminant))/(2*x1); 
```

# java - 如何比较两个java对象

> ID：16069106
> 
> 赞同：32
> 
> 时间：2013-04-17T19:58:28.200
> 
> 标签：java, object, compare

我有两个从同一个类实例化的 java 对象。

```
MyClass myClass1 = new MyClass();
MyClass myClass2 = new MyClass(); 
```

如果我将它们的两个属性都设置为完全相同的值，然后验证它们是否相同

```
if(myClass1 == myClass2){
   // objects match
   ...

}

if(myClass1.equals(myClass2)){
   // objects match
   ...

} 
```

但是，这些方法都没有返回真实值。我检查了每个属性，它们匹配。

如何比较这两个对象以验证它们是否相同？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-04-17T20:00:23.067

您需要提供自己的`equals()`in实现`MyClass`。

```
@Override
public boolean equals(Object other) {
    if (!(other instanceof MyClass)) {
        return false;
    }

    MyClass that = (MyClass) other;

    // Custom equality check here.
    return this.field1.equals(that.field1)
        && this.field2.equals(that.field2);
} 
```

`hashCode()`如果您的对象有可能在哈希表中使用，您还应该覆盖。一个[合理的实现](https://stackoverflow.com/questions/113511/hash-code-implementation)是将对象字段的哈希码与以下内容结合起来：

```
@Override
public int hashCode() {
    int hashCode = 1;

    hashCode = hashCode * 37 + this.field1.hashCode();
    hashCode = hashCode * 37 + this.field2.hashCode();

    return hashCode;
} 
```

有关实现散列函数的更多详细信息，请参阅[此问题。](https://stackoverflow.com/questions/113511/hash-code-implementation)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-17T20:00:31.363

您需要覆盖`equals`和`hashCode`.
`equals`将根据您需要的属性比较对象的相等性，并且`hashCode`是强制性的，以便您的对象正确使用`Collections`和`Maps`

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-17T20:01:49.340

您需要在`MyClass`.

`==`不起作用的原因是检查它们是否引用相同的实例。由于您`new`对每个都做了，因此每个都是不同的实例。

不起作用的原因`equals()`是您还没有自己实现它。我相信它的默认行为与`==`.

请注意，`hashcode()`如果您要实现，您也应该实现，`equals()`因为很多 java.util 集合都期望这样做。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-17T19:59:37.077

您必须从类 Object 中正确覆盖方法 equals()

**编辑**：我认为我的第一反应被误解了，可能是因为我不太精确。所以我决定添加更多的解释。

为什么你必须重写equals()？好吧，因为这是在开发人员的领域内决定两个对象相等意味着什么。在大多数情况下，引用相等是不够的。

例如，假设您有一个 HashMap，其键是 Person 类型。每个人都有姓名和地址。现在，您想使用密钥查找详细的 bean。问题是，您通常无法创建具有与地图中的引用相同的引用的实例。您所做的是创建类 Person 的另一个实例。显然，运算符 == 在这里不起作用，您必须使用 equals()。

但是现在，我们遇到了另一个问题。假设您的收藏非常大，并且您想要执行搜索。天真的实现会使用 equals() 将您的关键对象与地图中的每个实例进行比较。然而，这将是非常广泛的。hashCode() 来了。正如其他人指出的那样，哈希码是一个不必唯一的数字。重要的要求是，每当 equals() 为两个对象返回 true 时，hashCode() 必须为这两个对象返回相同的值。反推不成立，这是一件好事，因为哈希码将我们的密钥分成不同的桶。我们在单个存储桶中有少量 Person 类的实例。当我们执行搜索时，算法可以立即跳转到正确的存储桶，现在只对每个实例执行 equals。

还有一点。某些集合需要在用作键的类中正确实现 hashCode() 方法，这不仅是出于性能原因。示例是：HashSet 和 LinkedHashSet。如果它们不覆盖 hashCode()，则默认 Object hashCode() 方法将允许将您可能认为“有意义相等”的多个对象添加到“不允许重复”集合中。

一些使用 hashCode() 的集合

*   哈希集
*   链接哈希集
*   哈希映射

看看 apache commons 中的这两个类，它们可以让你轻松实现 equals() 和 hashCode()

*   [等于生成器](http://commons.apache.org/proper/commons-lang//apidocs/org/apache/commons/lang3/builder/EqualsBuilder.html)
*   [哈希码生成器](http://commons.apache.org/proper/commons-lang//apidocs/org/apache/commons/lang3/builder/HashCodeBuilder.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-17T20:00:37.753

1) == 在这种情况下评估引用相等
2) 我不太确定相等，但为什么不简单地覆盖比较方法并将其植入 MyClass 中？

# ruby-on-rails-3 - RSpec2：为什么 should_receive + and_return 在这个测试中失败？

> ID：16069111
> 
> 赞同：1
> 
> 时间：2013-04-17T19:58:36.807
> 
> 标签：ruby-on-rails-3, rspec2

这有点与我之前发布的一个问题有关，但我认为它足够令人困惑（恕我直言）来证明它自己的问题是合理的。

简而言之，任何人都可以帮助解释为什么这样做/通过：

```
Category.with_parent(@parent_category).should == [@sub_category] 
```

虽然这失败了：

```
Category.should_receive(:with_parent).with(@parent_category).and_return([@sub_category]) 
```

我的类别模型中的范围是：

```
scope :with_parent, lambda { |parent_id| where(:parent_id => parent_id).order('display_order DESC') } 
```

我正在使用 Rails 3.2.12 和 RSpec 2，对此非常困惑。

# javascript - Jquery Mobile“点击”事件错误

> ID：16069112
> 
> 赞同：2
> 
> 时间：2013-04-17T19:58:43.967
> 
> 标签：javascript, jquery-mobile, jquery, event-propagation

注意***：必须在平板电脑上测试，我只在Ipad上测试过

1 次触摸将在同一项运动中触发不同对象的不同事件

[http://jsfiddle.net/wR6dK/1/](http://jsfiddle.net/wR6dK/1/)

HTML：

```
<div id="box1"></div>
<div id="box2"></div> 
```

JS：

```
$("#box1").on('tap',function(){
    $("#log").append('box1 clicked <br>');
    $(this).fadeOut(0);
});

$("#box2").on('tap',function(){
    $("#log").append('box2 clicked <br>');
    $(this).fadeOut(0);
}); 
```

这种情况下绿框是隐藏的……它可以移开或重新排列z-index，都将触发红框的事件

它是如何工作的？它是否也发生在“vclick”和其他事件中？

它是一个错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T22:31:07.807

这是最古老的 javascript 错误之一，由于很长一段时间都不知道，因此从未修复过。简而言之，javascript 从来就不是这样使用的，而是给人类一个工具，他会根据需要改变它，因此我们有像 jQuery 和 jQuery Mobile 这样的框架。

这也称为跌倒事件。可以通过以下功能防止它：

*   **[停止传播（）](http://api.jquery.com/event.stopPropagation/)**
*   **[停止立即传播（）](http://api.jquery.com/event.stopImmediatePropagation/)**

并返回假。

这是您修改为使用此解决方案的示例：http: [//jsfiddle.net/Gajotres/wR6dK/5/](http://jsfiddle.net/Gajotres/wR6dK/5/)

```
$("#box1").on('tap',function(e){
    $("#log").append('box1 clicked <br>');
    $(this).fadeOut(0);
    e.stopPropagation();   
    return false;    
});

$("#box2").on('tap',function(e){
    $("#log").append('box2 clicked <br>');
    $(this).fadeOut(0);
    e.stopPropagation();   
    return false;    
}); 
```

让我给你看另一个例子，这样你就可以在 jQuery Mobile 的情况下理解这个问题：http: [//jsfiddle.net/Gajotres/Xz2np/](http://jsfiddle.net/Gajotres/Xz2np/)

```
$('#page1').live('pagebeforeshow',function(e,data){
    $('.someDiv').live('click', function (e) {   
        alert('Event is not going to propagate to content div, thus not hiding a header');             
        event.stopPropagation();   
        event.stopImmediatePropagation();
    });
}); 
```

要理解这个问题，只需单击一个 DIV 示例然后注释这 2 行，再次运行一个示例并再次单击一个 DIV。并且请我知道在 jQuery 1.9 中不推荐使用 live 但这是我的旧示例。

# android - Android - 如何在 JNI C 代码中安装包

> ID：16069113
> 
> 赞同：2
> 
> 时间：2013-04-17T19:58:50.140
> 
> 标签：android, java-native-interface, package

我需要在 android 上的 JNI C 中实现等效于以下 java 代码：

```
PackageManager pm = context.getPackageManager();
List<PackageInfo> packages = pm.getInstalledPackages(0);
for(PackageInfo packageInfo : packages) {
 ...
} 
```

我的问题是如何在 JNI C 中安装包。这是否可能？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T05:03:59.423

你最好的选择是`PacakgeManager`通过 JNI 调用。没有“C接口”，必须通过系统服务。安装一个包会做很多事情，所以仅仅将 APK 复制到正确的位置是不够的。

# python - 运行 Django REST 框架快速入门教程

> ID：16069119
> 
> 赞同：0
> 
> 时间：2013-04-17T19:58:56.773
> 
> 标签：python, django, django-rest-framework

我是 python 新手，之前没有使用过 django。我想运行 Django REST 框架快速入门教程，这样我就可以用它来测试另一个应用程序（[http://django-rest-framework.org/tutorial/quickstart.html](http://django-rest-framework.org/tutorial/quickstart.html)）。

我跑了两个问题：

1）我对“设置”步骤感到困惑，我不知道列表应该在哪个文件中。（我将内容粘贴在 urls.py 中，然后我尝试在同一文件夹中使用 settings.py与其他文件一样。）

2）就在“测试我们的 API”部分之前，我不知道启动项目的命令。（我尝试了“python urls.py”，因为 url 引用了其他文件。）

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:16:13.610

在开始使用 django-rest-framework 之前，您可能想了解更多关于 django 本身的信息，因此请尝试 django 教程。

[https://docs.djangoproject.com/en/dev/intro/tutorial01/](https://docs.djangoproject.com/en/dev/intro/tutorial01/)

关于您的问题：当您在 django 中启动一个项目时，它包含一个`settings.py`.

在此文件中，您必须编辑在其末尾`INSTALLED_APPS`添加的元组`'rest_framework,'`（“）”之前的一行）并放入

```
REST_FRAMEWORK = {
    'DEFAULT_PERMISSION_CLASSES': ('rest_framework.permissions.IsAdminUser',),
    'PAGINATE_BY': 10
} 
```

在文件的末尾。

要启动项目，您必须先同步数据库，这样做`python manage.py syncdb`，一旦你做了这个调用`python manage.py runserver`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:14:11.180

1.  `settings.py`明显地
2.  `python manage.py runserver`

`urls.py`是一个重要的文件，它管理 url 到可执行文件的映射，但它不是 django 的入口点。`manage.py`提供大量功能，甚至能够为您运行开发服务器。简而言之，[阅读手册](https://docs.djangoproject.com/en/dev/ref/django-admin/):)

# assembly - 汇编：输出变量，依赖于操作系统？，执行

> ID：16069125
> 
> 赞同：0
> 
> 时间：2013-04-17T19:59:10.623
> 
> 标签：assembly, x86-64, windows-7-x64

在我们在课堂上讨论了一下之后，我正在尝试学习一些汇编。我正在尝试将一个基本的 java 程序翻译为找到一个斐波那契数成汇编，我认为我的逻辑是正确的，但我的朋友告诉我它可能无法在我的 Windows 7 64 位计算机上工作，因为 ASM 因操作系统而异（ :O 他是认真的吗？）

这是我的代码：

```
SECTION .data   

Var2: resd 3
Var5: resd 4
Var1: db 10
Var3: db 1
Var4: db 1

SECTION .text   
global main
main:

MOV Var2,0

Loop1:
  ADD Var2,1
  MOV Var5,Var3
  ADD Var3,Var4
  MOV Var4,Var5
  CMP Var2,Var1
  JE Fin
  JP Loop1

Fin:
Put printing in here. 
```

2/ ASM 中是否有类似于 System.out.print 的内容？

3/一旦我弄清楚了，我该如何执行它？我得到了 RadASM，但我似乎无法通过它运行我的代码。完成后如何执行 ASM 程序？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:30:37.537

1.  几乎每个二进制可执行程序都依赖于操作系统，与编写它的编程语言无关。用汇编编写的程序也不例外。不要将字节码（例如 Java）与本机处理器代码（例如 x86-64）混淆。当然，您必须遵循您使用的编程语言的语法。由于与内存寻址相关的语法错误，您的程序将无法在大多数汇编器上进行汇编。

2.  在 Windows 7 等保护模式操作系统中，您必须使用操作系统 API 进行打印。

3.  您可以像执行任何其他二进制可执行文件一样执行以汇编语言编写的程序。首先编写代码，然后组装和链接它，然后执行。就像任何其他二进制可执行文件一样。与高级编译语言的不同之处在于，汇编程序（程序）比为编译器编译高级源代码要简单得多。

在 x86-64 汇编中，您不能直接从内存地址移动到另一个地址。您必须首先移动处理器的一个通用寄存器，然后从该寄存器移动到另一个内存地址。但是，也有一些指令会在内存之间移动，例如`movsb`、和`movsw`，但要开始使用，以后学习它们会更容易。`movsd``movsq`

目前尚不清楚您希望变量的大小是什么，因为您`db`对某些变量和`resd`其他变量使用。如果您希望所有`Var1`, `Var2`, `Var3`, `Var4`,`Var5`都是字节，那么它应该是例如：

```
Var2：分贝 3
Var5：分贝 4
Var1：分贝 10
Var3：分贝 1
Var4：分贝 1

```

如果您希望它们成为例如 dwords，请将每个替换`db`为`dd`. `resd`表示保留双字，以保留您应该使用的字节`resb`。

您必须知道汇编中操作数的大小。Assembler 不会为您做出决定。

假设上面的所有变量都是字节（`db`每个 8 位），循环可能类似于（NASM/YASM 语法）：

```
循环1：
    ADD [Var2]，字节 1

    MOV al,[Var3]
    MOV [Var5],al

    mov al,Var4
    添加 Var3,al

    移动，[Var5]
    MOV Var4,al

    移动，[Var1]
    CMP Var2,al
    杰芬
    JP循环1

```

如果你想让它们成为双字（`dd`每个 32 位）：

```
循环1：
    ADD [Var2],dword 1

    MOV eax,[Var3]
    MOV [Var5],eax

    mov eax,Var4
    添加 Var3,eax

    mov eax,[Var5]
    MOV Var4,eax

    mov eax,[Var1]
    CMP Var2,eax
    杰芬
    JP循环1

```

# java - setAutoCreateRowSorter 不适用于 Int

> ID：16069130
> 
> 赞同：0
> 
> 时间：2013-04-17T19:59:17.077
> 
> 标签：java, swing, jtable, tablerowsorter

我正在尝试对 JTable 的第二列中的整数进行排序。我用过`table.setAutoCreateRowSorter(true);`，但它是按字符串排序的。我正在尝试编写一些代码来解决这个问题，但我无法让它工作。

```
DefaultTableModel m = new DefaultTableModel();
String columnName = "Occurrences";  
m.addColumn("String");
m.addColumn(columnName);
JTable table = new JTable(m);
table.setAutoCreateRowSorter(true);

if (m.findColumn(columnName) == 2)
    {
            return Integer.class;
    } else {

            return null;
    } 
```

这是我通过添加`Class<Integer>`到我的函数中甚至可以编译的唯一方法。这不起作用

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:06:26.153

您的代码不是很清楚，但是如果您希望第二列类为 Integer，则只需覆盖它：

```
DefaultTableModel m = new DefaultTableModel() {
    @Override
    public Class<?> getColumnClass(int column) {
        if (column == 1) {
            return Integer.class;
        }
        return super.getColumnClass(column);
    }
}; 
```

# c# - 继承的类型在选择时导致异常实体框架5

> ID：16069136
> 
> 赞同：0
> 
> 时间：2013-04-17T19:59:30.650
> 
> 标签：c#, entity-framework

我首先使用 EF5 代码，类型如下：

```
 public class Region
    {
      public int Id { get; set; }
      //...
    }

    public class Destination : Region
    {
      public virtual Origine Origine { get; set; }
      //...
    }

    public class Origine : Region
    {
      public virtual IList<Destination> Destinations { get; set; }
      //...
    } 
```

我的 EF 上下文类型：

```
public class JobAndPopulationContext : DbContext
{
    public DbSet<Region> Regions { get; set; }
} 
```

我想通过这样一个简单的列表来选择所有地区：

```
context.Regions.ToList(); 
```

我收到了这个奇怪的错误信息：

关系经理使用“JobAndMigration.Classes.Origine”类型的所有者定义，该所有者与指定关系“JobAndMigration.Repository.Origine_Destinations”中源角色“Origine_Destinations_Target”的“JobAndMigration.Classes.Destination”类型不兼容'。

这个错误是什么意思？
我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:51:15.087

[在这里](http://weblogs.asp.net/manavi/archive/2010/12/24/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-1-table-per-hierarchy-tph.aspx)查看不同的继承类型

对于 TPT，请考虑将您的上下文更改为以下内容；

```
public class JobAndPopulationContext : DbContext
{
  public DbSet<Destination> Destinations { get; set; }
  public DbSet<Origins> Origin { get; set; }  
} 
```

# ios - 声音剪辑过去可以工作，但现在不行了！有什么问题？

> ID：16069138
> 
> 赞同：1
> 
> 时间：2013-04-17T19:59:34.077
> 
> 标签：ios, objective-c, xcode, cocoa-touch, audio

我有一个声音片段，它可以在模拟器上播放`ViewDidLoad`并且它曾经在模拟器上工作。但是，当我在我的设备上尝试它时，它根本停止工作！连模拟器都没有。

这是我的代码：

```
CFBundleRef mainBundle = CFBundleGetMainBundle();
CFURLRef soundFileURLRef;
soundFileURLRef = CFBundleCopyResourceURL(mainBundle, (CFStringRef) @"Nouh", CFSTR("wav"), NULL);
UInt32 soundID;
AudioServicesCreateSystemSoundID(soundFileURLRef, &soundID);
AudioServicesPlaySystemSound(soundID); 
```

现在我可以确定的是，由于我使用了另一个剪辑并且它可以播放，因此代码可以完美运行。此外，剪辑本身在 xcode 播放器中运行良好。

我已经尝试删除引用，以及重命名文件本身并再次添加它。

我记得我已经从另一台计算机上转移了我的项目，但在我看来整个项目工作正常，我不知道这是否与它有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T23:30:51.417

确保它不超过 30 秒，因为它`AudioToolBox`只会播放 30 秒及以下的剪辑。

如果您需要播放超过 30 秒的剪辑，请尝试`AVAudioPlayer`

祝你好运。

# javascript - 如何在 Opera 上捕捉 onmousewheel 事件？

> ID：16069139
> 
> 赞同：0
> 
> 时间：2013-04-17T19:59:34.603
> 
> 标签：javascript, mouseevent, opera, mousewheel

我认为以下代码同时针对 IE 和 Opera

```
window.onload = function() {
    document.attachEvent("onmousewheel", function() {
        console.log("mousewheel detected");
    });
}; 
```

但是，Opera (11.11) 根本没有任何反应。

我试过谷歌这个但没有得到任何有用的信息。Opera 甚至支持鼠标滚轮事件吗？

我试过的组合...

`attachEvent`,`addEventListener`和`mousewheel`, `onmousewheel`,`DOMMouseScroll`

# 更新

好的，`mousewheel`事件确实在 Opera 上被捕获，问题是我的 Opera 控制台没有打印任何内容。`alert`作品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:07:43.073

您需要处理所有浏览器的兼容性，而不是切换到可能破坏其他浏览器的解决方案。验证您是否可以使用解决方案的最简单方法是“如果”。

在这种情况下，您可以使用 2 个解决方案。添加事件监听器和附加事件。

```
var mousewheelevt=(/Firefox/i.test(navigator.userAgent))? "DOMMouseScroll" : "mousewheel" //FF doesn't recognize mousewheel as of FF3.x

if (document.attachEvent) //if IE (and Opera depending on user setting) {
    document.attachEvent("on"+mousewheelevt, function(e){alert('Mouse wheel movement detected!')})
else if (document.addEventListener) { //WC3 browsers
    document.addEventListener(mousewheelevt, function(e){alert('Mouse wheel movement detected!')}, false) 
```

[资源](http://www.javascriptkit.com/javatutors/onmousewheel.shtml)

# sql-server - 累积计数和计数变为负数和正数的日期

> ID：16069146
> 
> 赞同：1
> 
> 时间：2013-04-17T19:59:52.643
> 
> 标签：sql-server, sql-server-2008

我有以下情况

```
Date     Amount Item 
6/17/08 208  1 
9/24/08  -48     1 
6/15/09  -160    1 
9/23/09  40      1 
```

对于相同的项目，我想第一次获得累计金额小于或等于0的日期，如果以后累计金额变为正数，我也想得到它变为正数的日期。

```
Date     Amount Item Cumulative Amount 
6/17/08   208    1   208 
9/24/08  -48     1       160 
6/15/09  -160    1        0 --This date 
9/23/09  40      1        40 --This date 
```

关于如何实现这一目标的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:08:35.953

在 SQL Server 2012 中：

```
SELECT  date
FROM    (
        SELECT  *,
                SUM(amount) OVER (PARTITION BY item ORDER BY date) AS csum,
                SUM(amount) OVER (PARTITION BY item ORDER BY date ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING) AS psum
        FROM    mytable
        ) q
WHERE   (csum <= 0 AND psum > 0)
        OR
        (csum > 0 AND psum <= 0) 
```

在早期版本中：

```
SELECT  date
FROM    (
        SELECT  *,
                (
                SELECT  SUM(amount)
                FROM    mytable mi
                WHERE   mi.item = m.item
                        AND mi.date < m.date
                ) AS psum
        FROM    mytable m
        ) q
WHERE   (psum + amount <= 0 AND psum > 0)
        OR
        (psum + amount > 0 AND psum <= 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:19:10.063

对于它首次变为非正数的日期：

```
SELECT MIN(t3.Date) AS dateCumAmountTurnsLTEZero
FROM
(SELECT Date, 
 (SELECT SUM(Amount)
  FROM mytable t1
  WHERE t1.Date <= t2.Date) AS cumulativeAmount
 FROM mytable t2) t3
 WHERE t3.cumulativeAmount <= 0 
```

要获得它再次变为正数的日期，您可以将此结果注入另一个查询，或者假设您想在 SQL 中完成所有操作，这有点麻烦！见下文：

```
SELECT MIN(t6.Date)
FROM
(SELECT Date, 
 (SELECT SUM(Amount)
  FROM mytable t4
  WHERE t4.Date <= t5.Date) AS cumulativeAmount
 FROM mytable t5) t6
WHERE t6.cumulativeAmount >= 0
AND t6.Date >
(SELECT MIN(t3.Date)
 FROM
 (SELECT Date, 
  (SELECT SUM(Amount)
   FROM mytable t1
   WHERE t1.Date <= t2.Date) AS cumulativeAmount
  FROM mytable t2) t3
  WHERE t3.cumulativeAmount <= 0) 
```

请参阅[SQL Fiddle 演示](http://sqlfiddle.com/#!6/bed64/8)

# python - 从文件导入变量创建变量的副本

> ID：16069147
> 
> 赞同：3
> 
> 时间：2013-04-17T19:59:53.560
> 
> 标签：python, python-import

如果我

```
from file import variable 
```

并且`varable`在模块文件中更改了`variable`s 值不会更新。如果我

```
import file 
```

变量`file.variable`已更新。

有没有办法从模块中选择性地导入变量，将它们放在模块本地范围内并反映更新。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T20:06:01.250

不，在 Python 中，所有变量都是对象的引用（指针）。简单的分配 *重新绑定*被分配的名称——它们将它们指向不同的对象。也就是说，如果您有两个名称`a`和`b`，它们指向同一个对象，例如`42`，而您分配`b`给不同的对象，例如`"Don't Panic"`，`a`仍然指向`42`。

```
a = b = 42
b = "Don't Panic"
print a 
```

无论涉及的名称是在同一个模块中还是在不同的模块中，这都是正确的。

如果您不希望出现此行为，请不要为同一对象使用其他名称。正如您所发现的，您应该`import file`以`file.variable`而不是`from file import variable`. 后者相当于：

```
import file
variable = file.variable
del file 
```

因此，在幕后，`from ... import`正在分配一个新名称。该名称与其已有的名称相同，但它位于不同的范围内，并且是对该对象的新引用。

另一种可能的解决方案是使用可变对象，这样您就不需要进行简单的分配。例如，如果`a`是一个列表，那么您可以随意修改`a[0]`等等`a[2]`，而无需更改`a`指向的内容。您甚至可以重新分配对象的全部内容，而无需重新绑定名称：`a[:] = [1, 2, 3]`. 由于您正在更改对象本身，而不是任何名称所指向的内容，因此可以通过任何名称看到更改。

# mapreduce - 是否需要使用 map-reduce

> ID：16069151
> 
> 赞同：0
> 
> 时间：2013-04-17T20:00:05.597
> 
> 标签：mapreduce, cloud, elastic-map-reduce

在进行云计算项目时，是否有必要使用图 1 中定义的 amazon s3：{ [http://www.ibm.com/developerworks/aix/library/au-cloud_apache/#figure2](http://www.ibm.com/developerworks/aix/library/au-cloud_apache/#figure2) }，或者我可以使用map-reduce 和数据库？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:02:18.993

S3 只是世界上众多存储选项之一。对于任何云应用程序都不是强制性的，只是有时非常实用。

# c# - 以编程方式控制资源管理器窗口

> ID：16069152
> 
> 赞同：2
> 
> 时间：2013-04-17T20:00:08.267
> 
> 标签：c#, windows-7, explorer

我希望能够更改现有资源管理器窗口的目录。是否有 api 调用向窗口发送“导航到那里”消息（可能带有句柄）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:59:23.210

首先，添加对 Microsoft Internet 控件库的引用。然后您可以使用以下代码，假设您已经知道资源管理器窗口的窗口句柄：

```
var shellWindows = new SHDocVw.ShellWindows();
var myFolder = "C:\\temp"; // folder name you want to navigate to
var myHwnd = 0; // whatever window handle you're looking for
foreach (SHDocVw.InternetExplorer shellWindow in shellWindows)
{
    if (shellWindow.HWND == myHwnd)
    {
        shellWindow.Navigate(myFolder);
        break;
    }
} 
```

# string - 使用vim根据固定长度将字符串拆分为子字符串

> ID：16069153
> 
> 赞同：1
> 
> 时间：2013-04-17T20:00:14.190
> 
> 标签：string, vim

在大多数脚本语言中，很容易将字符串拆分为固定长度的子字符串，而无需使用分隔符。例如在红宝石中我可以做到

```
'acgatgctgc'.scan(/.{3}/).join(' ') #=>"acg atg ctg" 
```

使用 vim 脚本执行此操作的等价物是什么？或在 vim 中使用单个命令实现相同的功能？

编辑注意：注意 Ruby 去掉了最后一个 c

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:09:02.030

```
join(split('acgatgctgc','.\{3}\zs'),' ') 
```

上面的行会给你

```
"acg atg ctg c" 
```

我知道有一个，如果你想删除它`c`，它可以被函数删除：`filter()`

```
join(filter(split('acgatgctgc','.\{3}\zs'),'len(v:val)==3'),' ') 
```

会给你：

```
"acg atg ctg" 
```

不知道能不能回答你的问题。

# perl - Perl 脚本+删除除以“仅在”开头的行之外的所有行

> ID：16069154
> 
> 赞同：0
> 
> 时间：2013-04-17T20:00:16.770
> 
> 标签：perl

我有一个文件有很多行。其中一些以“仅在”开头。所以我只想保留以“Only in”开头的行并删除其余的行。有人可以告诉我我可以使用什么正则表达式命令。

类似“ %s/!(Only in)/rm -rf that line” 抱歉在这里混淆了verilog、unix和perl。有人可以帮助我吗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T20:05:59.900

```
perl -ne 'print if /^Only in /' file 
```

另请参阅`grep`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T20:06:10.453

```
perl -i -ne '/^Only in/ and print' file 
```

在脚本中：

```
use strict; use warnings;

$INPLACE_EDIT = 1;

while (<>) {
    /^Only in/ and print;
} 
```

这两种解决方案都替换了内联，而无需您自己创建临时文件。

# c++ - 具有权限分离的多用户桌面应用程序

> ID：16069161
> 
> 赞同：3
> 
> 时间：2013-04-17T20:00:26.160
> 
> 标签：c++, postgresql

我正在编写一个带有 postgresql 9.2 数据库后端的 C++ 应用程序。是一款会计软件。它是一个具有权限分离功能的多用户应用程序。

我需要帮助来实施用户帐户系统。用户的权限不必相互排斥。我应该在应用程序级别还是在数据库级别实现它？

公司目前不是很大。假设大约有 15-20 个办公室，每个办公室平均有 10 个程序用户。

*   我可以利用 postgres 中的角色来实现这个吗？它会变得过于乏味、难以管理，还是这种方法存在一些缺陷？
*   如果我通过应用程序路由，我如何存储用户拥有的权限集？二进制字符串就足够了吗？如果以后有额外的权限，我该如何合并它们？我需要做些什么来确保没有安全问题？在这种方法中，我假设应用程序连接到最高特权用户所需的特权。
*   这两种方法的某种组合？还是完全不同的东西？

欢迎所有建议和争论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:14:42.000

切勿从在不受控制的环境中运行的客户端应用程序提供授权。用户可以物理访问的每台设备都是一个不受控制的环境。这是通过默默无闻的安全性——用户可以简单地使用调试器从客户端程序内存中获取数据库访问凭据，然后`psql`用来做任何事情。

使用角色。

当我开发 C++/PostgreSQL 桌面应用程序时，我选择禁止所有用户访问修改所有表，并且我使用带有`VOLATILE SECURITY DEFINER`选项的 Pl/PgSQL 函数创建了一个 API。但我认为这不是最好的方法，因为它不自然且容易出错，例如：

```
select add_person(?,?,?,?,?,?,?,?,?,?,?,?); 
```

我认为更好的方法是允许修改用户需要修改的表，并在需要时使用 BEFORE 触发器强制授权，这会在 current_user 不属于适当的角色时引发错误。

但[请记住`set search_path=...`在所有与安全有关的功能中使用选项](http://www.postgresql.org/docs/current/static/sql-createfunction.html#SQL-CREATEFUNCTION-SECURITY)。

* * *

如果您想授权对某些表进行只读访问，那么它会变得更加复杂。您需要禁用这些表的选择权限并使用安全定义器函数创建 API 以访问所有数据。这将是一个怪物大小的 API，极其丑陋且极其脆弱。或者您需要禁用这些表的选择权限并使用`create view with (security_barrier)`. 也不好看。

# android - 如何在android中将单词转换为数字

> ID：16069164
> 
> 赞同：-2
> 
> 时间：2013-04-17T20:00:28.663
> 
> 标签：android, int

我是 android 新手，非常感谢您在这方面的帮助 =)

我正在尝试将用户通过微调器选择的各种单词转换为用于计算的数字。

我不知道该怎么做，而且已经做了 2 天了。

下面是代码。（我知道这是错误的，因为我使用了另一个 BMI 指南来帮助构建下面的代码，但是，由于用户输入的数据首先是数字，所以它与我的情况不同。）

再次非常感谢大家的帮助，真的很感激。

```
package com.example.mygpa;

public class Main extends Activity {

    // declare the references for the UI elements
    Spinner courseSpinner;
    Spinner semesterSpinner;
    EditText currentGPA;

    /** Called when the activity is first created. */
    @SuppressLint ("NewApi")
    @Override
    public void onCreate(Bundle savedInstanceState) {
        try {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            Spinner Course_Add_Spinner = Create_Course_Add_Spinner();
            Spinner Semester_Add_Spinner = Create_Semester_Add_Spinner(null);

            // load the references to the widgets 
            courseSpinner = (Spinner)findViewById(R.id.spinner_course);
            semesterSpinner = (Spinner)findViewById(R.id.spinner_semester);
            currentGPA = (EditText)findViewById(R.id.current_gpa);

        }catch (Exception e) {
            Log.e("ERROR", e.toString());
            e.printStackTrace();
        }
        // Make sure we're running on Honeycomb or higher to use ActionBar APIs
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
            // Show the Up button in the action bar.
            getActionBar().setDisplayHomeAsUpEnabled(true);
        }
    }

     // handler that we defined in "onClick" attribute of the button
        // get called when the button is clicked
        public void calculateClickHandler(View view) {
            // make sure we handle the click of the calculator button
            if (view.getId() == R.id.btncalculate) {

                int course = getSelectedCourse();
                int semester = getSelectedSemester();
                int gpavalue = Integer.parseInt(currentGPA.getText().toString());

                int gpaValue = (((gpavalue / course) + (semester*4)) / (course+semester));

                Intent intent = new Intent (Main.this, Main2.class);
                intent.putExtra("GpaValue", gpaValue);
                startActivity(intent);
                }
            }

        public int getSelectedCourse() {

            try
            {
            String Text = courseSpinner.getSelectedItem().toString();
            String Text2 = semesterSpinner.getSelectedItem().toString();
            int value = Integer.parseInt(Text);
            int value2 = Integer.parseInt(Text2);
            }
            catch(NumberFormatException e)
            {
                e.printStackTrace();
            }

            if (courseSpinner.equals("Hospitality and Tourism Management") && semesterSpinner.equals("Year 1 Semester 1")) {
                return (int) (0);
            } else if  (courseSpinner.equals("Hospitality and Tourism Management") && semesterSpinner.equals("Year 1 Semester 2")) {
                return (int) (22);
            } else if  (courseSpinner.equals("Hospitality and Tourism Management") && semesterSpinner.equals("Year 2 Semester 1")) {
                return (int) (44);
            } else if  (courseSpinner.equals("Hospitality and Tourism Management") && semesterSpinner.equals("Year 2 Semester 2")) {
                return (int) (62);
            } else if  (courseSpinner.equals("Hospitality and Tourism Management") && semesterSpinner.equals("Year 3 Semester 1")) {
                return (int) (77);
            } else {
                return (int) (101);
            }
        }

        public int getSelectedSemester() {

            try
            {

                String Text = semesterSpinner.getSelectedItem().toString();
                int value = Integer.parseInt(Text);
            }
            catch(NumberFormatException e)
            {
                e.printStackTrace();
            }

                if (semesterSpinner.equals("Year 1 Semester 1")) {
                    return (int) (22);
                } else if  (semesterSpinner.equals("Year 1 Semester 2")) {
                    return (int) (22);
                } else if  (semesterSpinner.equals("Year 2 Semester 1")) {
                    return (int) (18);
                } else if  (semesterSpinner.equals("Year 2 Semester 2")) {
                    return (int) (15);
                } else if  (semesterSpinner.equals("Year 3 Semester 1")) {
                    return (int) (24);
                } else {
                    return (int) (18);
                }   
        }

    // Creates the Course Spinner for the Add section sends the choice made to
    // a method for populating the Semester spinner
    public Spinner Create_Course_Add_Spinner() {
        Spinner Course_Add_Spinner = (Spinner) findViewById(R.id.spinner_course);
        String[] Course_Add_Spinner_Array = getResources().getStringArray(R.array.course_array);
        SpinnerAdapter Course_Add_Spinner_Adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_dropdown_item, Course_Add_Spinner_Array);
        Course_Add_Spinner.setAdapter(Course_Add_Spinner_Adapter);
        Course_Add_Spinner.setOnItemSelectedListener(new Course_Add_Spinner_Listener());
        return Course_Add_Spinner;
    }

    // The listener for the Course Spinner that sends whatever choice made to
    // the method that populates the second spinner.
    public class Course_Add_Spinner_Listener implements
            OnItemSelectedListener {

        public void onItemSelected(AdapterView<?> Course_Add_Adapter_View, View v, int position, long row) {
            String Course_Add_Choice = Course_Add_Adapter_View.getItemAtPosition(position).toString();
            Create_Semester_Add_Spinner(Course_Add_Choice);
        }

        public void onNothingSelected(AdapterView<?> arg0) {
            // TODO Auto-generated method stub
        }
    }

    // Create the Semester Spinner for the Add section
    public Spinner Create_Semester_Add_Spinner(String course_array) {
        String[] Semester_Add_Spinner_Array = null;
        Spinner Semester_Add_Spinner = (Spinner) findViewById(R.id.spinner_semester);

        if (course_array.equals("Hospitality and Tourism Management")) {
            Semester_Add_Spinner_Array = getResources().getStringArray(R.array.HTM);

        } else if (course_array.equals("Sports and Wellness")) {
            Semester_Add_Spinner_Array = getResources().getStringArray(R.array.SW);

        } else Semester_Add_Spinner_Array = getResources().getStringArray(R.array.HTM);

        SpinnerAdapter Semester_Add_Spinner_Adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_dropdown_item, Semester_Add_Spinner_Array);
        Semester_Add_Spinner.setAdapter(Semester_Add_Spinner_Adapter);
        return Semester_Add_Spinner;
        }
} 
```

根据要求，日志猫报告错误发生的位置。

```
04-20 23:30:13.759: W/dalvikvm(26872): threadid=1: thread exiting with uncaught exception (group=0x40a96930)
04-20 23:30:13.759: E/AndroidRuntime(26872): FATAL EXCEPTION: main
04-20 23:30:13.759: E/AndroidRuntime(26872): java.lang.IllegalStateException: Could not execute method of the activity
04-20 23:30:13.759: E/AndroidRuntime(26872):    at android.view.View$1.onClick(View.java:3599)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at android.view.View.performClick(View.java:4204)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at android.view.View$PerformClick.run(View.java:17360)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at android.os.Handler.handleCallback(Handler.java:725)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at android.os.Handler.dispatchMessage(Handler.java:92)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at android.os.Looper.loop(Looper.java:137)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at android.app.ActivityThread.main(ActivityThread.java:5237)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at java.lang.reflect.Method.invokeNative(Native Method)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at java.lang.reflect.Method.invoke(Method.java:511)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:799)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:566)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at dalvik.system.NativeStart.main(Native Method)
04-20 23:30:13.759: E/AndroidRuntime(26872): Caused by: java.lang.reflect.InvocationTargetException
04-20 23:30:13.759: E/AndroidRuntime(26872):    at java.lang.reflect.Method.invokeNative(Native Method)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at java.lang.reflect.Method.invoke(Method.java:511)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at android.view.View$1.onClick(View.java:3594)
04-20 23:30:13.759: E/AndroidRuntime(26872):    ... 11 more
04-20 23:30:13.759: E/AndroidRuntime(26872): Caused by: java.lang.NullPointerException
04-20 23:30:13.759: E/AndroidRuntime(26872):    at com.example.mygpa.Main.getSelectedCourse(Main.java:73)
04-20 23:30:13.759: E/AndroidRuntime(26872):    at com.example.mygpa.Main.calculateClickHandler(Main.java:57)
04-20 23:30:13.759: E/AndroidRuntime(26872):    ... 14 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:06:15.420

```
myInteger = Integer.parseInt(myString); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:28:09.340

您可以从微调器获取值并使用如下值。

```
try
{
     Spinner mySpinner = (Spinner)findViewById(R.id.spinner);
     String Text = mySpinner.getSelectedItem().toString();
     int value= Integer.parseInt(Text);
}
catch(NumberFormatException e)
{
    e.printStackTrace();
} 
```

# html - 更改每个 li 项目悬停颜色的问题

> ID：16069165
> 
> 赞同：0
> 
> 时间：2013-04-17T20:00:31.333
> 
> 标签：html, css, html-lists

这是参考链接：[http ://www.mytwins.gr/site/](http://www.mytwins.gr/site/)

这是一个wordpress主题。我编辑 css 是因为我想更改每个菜单项的悬停颜色。这是我到目前为止尝试的代码

```
#menu-item-43 a:hover {background-color: rgb(161, 204, 58) !important;} 
```

*   问题是相同的方法在其他项目中不起作用。为什么？
*   然后我尝试使用 css3 第 n 个元素来选择我想要的特定 li 项目。下面的一个例子

    ```
     #topnav li:nth(4) a:hover {background-color:black;} 
    ```

以上也行不通。关于如何更改每个菜单项颜色的任何想法？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:04:22.917

查看您用于为`<a>`元素提供背景颜色的选择器：

```
#topnav li.current-menu-item > a, #topnav li.sfHover > a, #topnav li a:hover 
```

您的选择器必须比这更具体，而且`#menu-item-43 a:hover`还不够。为什么不试试：

```
#menu-item-43 > a, #menu-item-43 > a:hover { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:04:10.320

它可能与您尝试更改颜色的链接的特异性有关。如果您不熟悉 css 特异性，这里有一个很好的参考： [http ://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/](http://coding.smashingmagazine.com/2007/07/27/css-specificity-things-you-should-know/)

基本上，CSS 会根据它们的特殊性应用于 DOM 中的元素，因此您尝试使用选择器与内联等应用 CSS 的方式会影响哪些元素实际上会将 CSS 应用于它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:10:04.190

如果您使用的是可重复的项目，例如`menu-item`，您应该使用类。当您使用时，`#`您通过 id 选择元素，这对于整个文档应该是唯一的。在某些情况下，选择器只会选择与 id 匹配的第一个项目，因为它**应该**是唯一的。

例如：

```
.menu-item a:hover { background-color: rgb(161, 204, 58) !important;} } 
```

# powerpoint - Powerpoint - 想要定义一个不是配色方案的调色板

> ID：16069168
> 
> 赞同：1
> 
> 时间：2013-04-17T20:00:34.410
> 
> 标签：powerpoint, color-scheme

我经常将 Spotfire 图形导入 Powerpoint。Spotfire 有自己特定的调色板，这不是 powerpoint 中使用的标准颜色，至少我不这么认为。

我经常必须创建我自己的图例或出于其他原因匹配 spotfire 调色板，我通过输入 spotfire 颜色的 RGB 代码来做到这一点。我想这样做一次，并且在 powerpoint 中始终可以使用 spotfire 调色板，而无需重新输入。

我不认为我想使用颜色*主题*，因为如果我最终使用不同的模板（主题），我希望我的颜色保持一致。也就是说，我不想调用 spotfire 默认蓝色“口音 1”，因为如果我更改背景模板（主题），我认为它会用新模板的口音 1 覆盖口音 1。

因此，无论我选择什么主题，我都想要一个始终可用的调色板。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:29:01.153

您出于所有正确的原因而忽略了主题。他们不会为你所追求的而工作。你几乎需要购买或编写一个插件来做你想做的事。

例如，它可能会在工具栏/功能区上安装 n 个按钮，其中 n = 您在调色板上需要的颜色数。单击该按钮时，它将例如将当前选定的形状/形状的填充设置为适当的颜色。

您可以有不同的填充、轮廓等按钮集，或者让代码确定用户是否按下，例如 CTRL 键。单击 = 设置填充，CTRL+单击 = 设置轮廓。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T02:40:00.533

因为我很好奇，我决定尝试创建一个简单的加载项，它允许您选择图表、图表中的系列，然后应用颜色。

![加载项功能的屏幕截图](https://i.stack.imgur.com/yfa00.jpg)

您可以从 Google Docs 下载（*修改后的链接*）

[https://docs.google.com/file/d/0B1v0s8ldwHRYMFFPZ29FNmI0TkE/edit?usp=sharing](https://docs.google.com/file/d/0B1v0s8ldwHRYMFFPZ29FNmI0TkE/edit?usp=sharing)

该文件保存为 PPTM 以公开代码模块。另存为 PPAM 并加载加载项；它将在`Add-Ins`命令栏中可用。我进行了简短的测试，似乎正在工作。

**这是它的具体细节：**

首先将几种自定义颜色声明为`Public Const`变量。可以使用 long 值（从 RGB 转换）来修改这些以适应您的需要。

宏要求选择是 Shape ，并且进一步要求 Shape `.HasChart = True`。有一些逻辑可以捕获这些条件。

用户表单有一个组合框，其中填充`Series`了所选图表中的列表，以及为每种定义的颜色着色的 8 个命令按钮，将把该颜色发送到所选系列。

您可以根据需要添加其他命令按钮和颜色，或调整现有代码以满足您的特定需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:35:30.503

尽管幻灯片模板附加了默认颜色主题，但您可以切换幻灯片模板并仍然使用*任何*您可以随意使用的XML 配色方案。

# tomcat - tomcat osgi实现中的简单Web应用程序包（WAB）

> ID：16069174
> 
> 赞同：0
> 
> 时间：2013-04-17T20:00:43.833
> 
> 标签：tomcat, osgi, bundle, wab

我无法使用 servletbridge osgi 实现访问部署在 tomcat 中的简单 WAB。

我能够使用 HttpService 使用纯 osgi 包以编程方式注册 jsp/servlets/html，并且可以访问此包。我尝试的下一件事是创建一个单独的 WAB，其中包含一个 html 和一个 servlet 资源，但在访问包时遇到了一些问题。我尝试了 jarred 和 unjarred bundle。我现在假设的是，对于 WAB，我不需要以编程方式或以声明方式注册我的资源？？？

下面是我创建的 WAB 包。它不包含任何 Http Service Tracker，只是一个在控制台上显示激活和停用消息的激活器。

```
sample.http1

   helloworld.html

   |META-INF 
       MANIFEST.MF

   |WEB-INF
      web.xml
      |classes
           |sample
                 |http
                      Activator.class
                      HelloWorldServlet.class 
```

下面是 MANIFEST.MF 文件

```
Manifest-Version: 1.0
Bundle-ManifestVersion: 2
Bundle-Name: sample.http1
Bundle-SymbolicName: sample.http1
Bundle-Version: 1.0.0
Bundle-Activator: sample.http.Activator
Import-Package: javax.servlet,javax.servlet.http,org.osgi.framework, org.osgi.service.http, org.osgi.util.tracker
Bundle-ClassPath: WEB-INF/classes
Web-ContextPath: /samplehttp 
```

下面是 Activator 类的代码

```
package sample.http;
import org.osgi.framework.BundleActivator;
import org.osgi.framework.BundleContext;
public class Activator implements BundleActivator {

    public void start(BundleContext context) throws Exception {
    System.out.println("Starting Hello World");
}
        public void stop(BundleContext context) throws Exception {
          System.out.println("Stopping Hello World");
}       
} 
```

下面是web.xml的内容

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app>
<servlet>
<servlet-name>helloworld</servlet-name>
<servlet-class>sample.http.HelloWorldServlet</servlet-class>
</servlet>
<servlet-mapping>
<servlet-name>helloworld</servlet-name>
<url-pattern>/helloworld</url-pattern>
</servlet-mapping>
</web-app> 
```

然后我激活了这个捆绑包。并尝试如下访问 WAB 资源，但我收到 404 page resource not found 错误。

`http://localhost/bridge/samplehttp/helloworld.html` --对于静态html

`http://localhost/samplehttp/helloworld.html`

`http://localhost/bridge/samplehttp/helloworld` --对于 HelloWorldServlet

`http://localhost/samplehttp/helloworld`

Tomcat 托管在端口 80 上。我可以访问我的其他 osgi 包，这些包是使用 HttpService 以编程方式注册的。下面的 osgi 包完美地工作。

例如 `http://localhost/bridge/jsp-examples/helloworld.jsp`

请指教。我在 [http://www.javabeat.net/2011/11/writing-an-osgi-web-application/上引用了 osgi 规范文档和另一个博客](http://www.javabeat.net/2011/11/writing-an-osgi-web-application/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T08:35:52.087

您的嵌入式 OSGi 容器设置是否支持 WAB？什么样的 osgi 框架正在运行？是否只有 HttpService 可用。只要您不支持 WAB（例如 Felix HTTP-Service 不支持此功能），您就是徒劳的。如果可以更改 HTTP 服务，您可以考虑使用它的 Pax-Web 实现，它支持标准。HTTP-Service，它的白板扩展器，当然也完全支持 WAB。最新的甚至支持 Servlets 3.0。但是，如果您绑定到现有的基础架构，并且不允许更改，那么您将无法部署 WAB。在 OSGi 容器中部署 WAB 有点“奇怪”，该容器本身在 WAR 容器中运行 :-)

所以基本上，如果你想使用这个场景，你可能需要做以下事情：让一个 WAR 应用程序在 Tomcat 中运行，让你的 OSGi 服务在另一个 WAR 中的 OSGi-Container 中运行。对 OSGi-War 中的服务进行远程 HTTP 调用。

# c++ - 使用 Watershed 在 C++ 中进行 OpenCV 图像分割

> ID：16069184
> 
> 赞同：3
> 
> 时间：2013-04-17T20:01:25.107
> 
> 标签：c++, opencv, mask, image-segmentation, watershed

嗨，我目前正在编写一个基本的 C++ 应用程序，使用 OpenCV 库从背景中分割图像的主题。应用程序读取图像文件并使用分水岭算法根据在边缘周围找到的数据和在图像中心找到的数据生成掩码。

（首先，我创建了一个整体值为 -1 的图像对象。然后我在一个值为 1 的空图像周围创建了一个边框。然后我在图像的中心大致创建了一个矩形，其值为2.边框和矩形没有接触。）

我尝试使用生成的掩码在原始图像和自动生成的掩码之间使用按位与从图像中删除数据。

我是用 C++ 编写的，如果有人能快速查看我的代码，我将不胜感激。我能找到的唯一类似的例子是使用 Python 的原生 OpenCV 绑定。

样本面具：http: [//i.imgur.com/a0SUwy3.png](http://i.imgur.com/a0SUwy3.png)

示例图片：http: [//i.imgur.com/FQywu6P.png](http://i.imgur.com/FQywu6P.png)

```
// Usage: ./app input.jpg
#include "opencv2/opencv.hpp"
#include <string>

using namespace cv;
using namespace std;

class WatershedSegmenter{
private:
    cv::Mat markers;
public:
    void setMarkers(cv::Mat& markerImage)
    {
        markerImage.convertTo(markers, CV_32S);
    }

    cv::Mat process(cv::Mat &image)
    {
        cv::watershed(image, markers);
        markers.convertTo(markers,CV_8U);
        return markers;
    }
};

int main(int argc, char* argv[])
{
    cv::Mat image = cv::imread(argv[1]);
    cv::Mat blank(image.size(),CV_8U,cv::Scalar(0xFF));
    cv::Mat dest(image.size(),CV_8U,cv::Scalar(0xFF));
    imshow("originalimage", image);

    // Create markers image
    cv::Mat markers(image.size(),CV_8U,cv::Scalar(-1));
    //Rect(topleftcornerX, topleftcornerY, width, height);
    //top rectangle
    markers(Rect(0,0,image.cols, 5)) = Scalar::all(1);
    //bottom rectangle
    markers(Rect(0,image.cols-5,image.cols, 5)) = Scalar::all(1);
    //left rectangle
    markers(Rect(0,0,5,image.rows)) = Scalar::all(1);
    //right rectangle
    markers(Rect(image.cols-5,0,5,image.rows)) = Scalar::all(1);
    //centre rectangle
    markers(Rect(image.cols/2,image.rows/2,50, 50)) = Scalar::all(2);

    //Create watershed segmentation object
    WatershedSegmenter segmenter;
    segmenter.setMarkers(markers);
    cv::Mat result = segmenter.process(image);
    result.convertTo(result,CV_8U);

    bitwise_and(image, blank, dest, result);
    imshow("final_result", dest);

    cv::waitKey(0);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T11:32:58.160

得到它的工作！

```
// Usage: ./app input.jpg
#include "opencv2/opencv.hpp"
#include <string>

using namespace cv;
using namespace std;

class WatershedSegmenter{
private:
    cv::Mat markers;
public:
    void setMarkers(cv::Mat& markerImage)
    {
        markerImage.convertTo(markers, CV_32S);
    }

    cv::Mat process(cv::Mat &image)
    {
        cv::watershed(image, markers);
        markers.convertTo(markers,CV_8U);
        return markers;
    }
};

int main(int argc, char* argv[])
{
    cv::Mat image = cv::imread(argv[1]);
    cv::Mat blank(image.size(),CV_8U,cv::Scalar(0xFF));
    cv::Mat dest;
    imshow("originalimage", image);

    // Create markers image
    cv::Mat markers(image.size(),CV_8U,cv::Scalar(-1));
    //Rect(topleftcornerX, topleftcornerY, width, height);
    //top rectangle
    markers(Rect(0,0,image.cols, 5)) = Scalar::all(1);
    //bottom rectangle
    markers(Rect(0,image.rows-5,image.cols, 5)) = Scalar::all(1);
    //left rectangle
    markers(Rect(0,0,5,image.rows)) = Scalar::all(1);
    //right rectangle
    markers(Rect(image.cols-5,0,5,image.rows)) = Scalar::all(1);
    //centre rectangle
    int centreW = image.cols/4;
    int centreH = image.rows/4;
    markers(Rect((image.cols/2)-(centreW/2),(image.rows/2)-(centreH/2), centreW, centreH)) = Scalar::all(2);
    markers.convertTo(markers,CV_BGR2GRAY);
    imshow("markers", markers);

    //Create watershed segmentation object
    WatershedSegmenter segmenter;
    segmenter.setMarkers(markers);
    cv::Mat wshedMask = segmenter.process(image);
    cv::Mat mask;
    convertScaleAbs(wshedMask, mask, 1, 0);
    double thresh = threshold(mask, mask, 1, 255, THRESH_BINARY);
    bitwise_and(image, image, dest, mask);
    dest.convertTo(dest,CV_8U);

    imshow("final_result", dest);
    cv::waitKey(0);

    return 0;
} 
```

# jquery - jquery 比率星大小属性不起作用

> ID：16069194
> 
> 赞同：5
> 
> 时间：2013-04-17T20:01:53.280
> 
> 标签：jquery, html, css, size

我正在尝试使用 jquery.raty.js 和 jquery.raty.min.js 但我想制作大星星但它不起作用。我已经在 jquery.raty.js 和脚本内的这个函数中更改了大小。

我这里有这个插件：

[http://wbotelhos.com/raty](http://wbotelhos.com/raty)

```
$(document).ready(function () {
    $('.star1').raty({
        cancel: true,
        score: 0,
        half: true,
        size: 22,
        path: 'img',
        click: function (score1, evt) {
            $('input.valor').val(score1);
        }
    });
}); 
```

我想要 22 或 24 像素的星星，但它的大小始终为 16。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T21:53:46.300

我遇到了同样的问题，对我来说是浏览器的缓存内存......直到我把这个属性“single：true”放入函数中它才起作用

```
$('#star').raty({
  cancel   : true,
  cancelOff: 'cancel-off-big.png',
  cancelOn : 'cancel-on-big.png',
  half     : true,
 ->>>>> single   : true,
  size     : 24,
  starHalf : 'star-half-big.png',
  starOff  : 'star-off-big.png',
  starOn   : 'star-on-big.png'
}); 
```

然后我可以看到其中一个很大。然后我想也许是缓存..确实如此。

试试看，也许是解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:15:52.077

您忘记了`$`在代码前面和`});`最后的签名。此外，也许您应该尝试使用该`.ready()`功能在页面加载时启动您的代码。

所以，代码是：

```
$(document).ready(function () {
    $('.star1').raty({
        cancel: true,
        score: 0,
        half: true,
        size: 22,
        path: 'img',
        click: function (score1, evt) {
            $('input.valor').val(score1);
        }
    });
}); 
```

* * *

**编辑**

Raty 插件有一个改变星星大小的[**例子**](http://wbotelhos.com/raty#size)。为了设置更大的尺寸，您必须为更大的星星设置合适的图像。来自站点：*您将使用的图标的像素大小。*

```
$('#star').raty({
  cancel   : true,
  cancelOff: 'cancel-off-big.png',
  cancelOn : 'cancel-on-big.png',
  half     : true,
  size     : 24,
  starHalf : 'star-half-big.png',
  starOff  : 'star-off-big.png',
  starOn   : 'star-on-big.png'
}); 
```

您也可以尝试使用`path`属性，但请检查该路径是否正确。

# excel - ssis 脚本任务损坏 excel 2010 文件

> ID：16069196
> 
> 赞同：0
> 
> 时间：2013-04-17T20:01:58.547
> 
> 标签：excel, ssis, excel-2010, vba

我正在尝试格式化 Excel 2010 文档并且文件创建良好并且数据在那里，但是当脚本任务去格式化文件时它被损坏。我还注意到它只会读取 2 个工作表中的第一个。这是代码：

```
 Dim lintLastRow As Integer
    Dim lstrLastCol, lstrHeader As String
    Dim mobjWorkbook As Workbook
    Dim mappExcel As New Microsoft.Office.Interop.Excel.Application
    Dim lobjWorksheet As Worksheet
    Dim emptyBytes(0) As Byte
    Dim oldCI As System.Globalization.CultureInfo = System.Threading.Thread.CurrentThread.CurrentCulture
    System.Threading.Thread.CurrentThread.CurrentCulture = New System.Globalization.CultureInfo("en-US")

    Try
        mappExcel.Visible = False
        mappExcel.DisplayAlerts = False
        mappExcel.AskToUpdateLinks = False
        mappExcel.AlertBeforeOverwriting = False
        mobjWorkbook = mappExcel.Workbooks.Open(Dts.Variables("FilePath").Value + Dts.Variables("FileName").Value)
        mobjWorkbook.RefreshAll()
        Dts.Log("worksheet count: " & mobjWorkbook.Sheets.Count, 0, emptyBytes)
        For Each lobjWorksheet In mobjWorkbook.Sheets
            If lobjWorksheet.Name = "Compare" Then
                lstrLastCol = "T"
                lstrHeader = "- Compare Results"
            Else
                lstrLastCol = "H"
                lstrHeader = "- Trans UnMatch"
            End If
            'Dts.Log("Set worksheet: " & lintCount, 0, emptyBytes)
            'lobjWorksheet = mobjWorkbook.Sheets.Item(lintCount)
            Dts.Log("worksheet select", 0, emptyBytes)
            lobjWorksheet.Select()
            lobjWorksheet.Range("A1").Select()
            If lobjWorksheet.Cells(2, 1).value = Nothing Then
                lintLastRow = 4
            Else
                lobjWorksheet.Application.Cells.End(XlDirection.xlDown).Select()
                lintLastRow = lobjWorksheet.Application.ActiveCell.Row + 2
            End If
            Dts.Log("last row: " & lintLastRow, 0, emptyBytes)
            lobjWorksheet.Rows(1).Insert(XlInsertShiftDirection.xlShiftDown, False)
            lobjWorksheet.Rows(1).Insert(XlInsertShiftDirection.xlShiftDown, False)
            lobjWorksheet.Cells(1, 1).value = "PAM - GL Portfolio Level " + lstrHeader + " for " + Today
            lobjWorksheet.Range("A1", lstrLastCol + "1").Merge()
            lobjWorksheet.Range("A1").RowHeight = 27
            lobjWorksheet.Range("A1", lstrLastCol + "3").Font.Bold = True
            lobjWorksheet.Range("C4", lstrLastCol & lintLastRow).NumberFormat = "0.00" ' = FormatNumber("#####.00").
            lobjWorksheet.Range("A3", lstrLastCol & lintLastRow).EntireColumn.AutoFit()
            lobjWorksheet.Range("A1", lstrLastCol & lintLastRow).Font.Name = "Arial"
            lobjWorksheet.Range("A1").Select()
            Dts.Log("Complete Update", 0, emptyBytes)
        Next

        mobjWorkbook.Sheets("Compare").Select()
        Dts.TaskResult = ScriptResults.Success
    Catch ex As Exception
        Dts.Events.FireError(0, "Format Excel Failed: ", _
        ex.Message & ControlChars.CrLf & ex.StackTrace, _
        String.Empty, 0)
        Dts.TaskResult = ScriptResults.Failure
    Finally
        System.Threading.Thread.CurrentThread.CurrentCulture = oldCI
        mobjWorkbook.Save()
        mobjWorkbook.Close()
        ReleaseCom(lobjWorksheet)
        ReleaseCom(mobjWorkbook)
        mappExcel.Quit()
        ReleaseCom(mappExcel)
        GC.Collect()
        GC.WaitForPendingFinalizers()
    End Try 
```

这在我的机器和试验环境上运行良好。当它投入生产时，事情会迅速走下坡路。关于我所缺少的任何想法都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:03:17.393

所以我认为最初的问题是由于服务器上没有安装 Excel 转换器造成的。安装后，我开始收到以下错误：

```
OnError,PGIDSMSQL045,PRINCIPALUSA\TWSPGIAC,Formate Excel,{610A1615-E16E-4B62-8A93-F692A478FCF9},{EF8F3734-6467-423C-A9D3-BF2463EEFD44},04/18/2013 11:52:09 AM,04/18/2013 11:52:09 AM,0,0x,The server threw an exception. (Exception from HRESULT: 0x80010105 (RPC_E_SERVERFAULT)) at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)
   at ST_0391e3bc80224a34819c14be208559c5.vbproj.ScriptMain.Main()
OnError,PGIDSMSQL045,PRINCIPALUSA\TWSPGIAC,PAM-GLPortLvlRecon,{008D2838-612E-4DBB-AEE7-65145ED0BAAC},{EF8F3734-6467-423C-A9D3-BF2463EEFD44},04/18/2013 11:52:09 AM,04/18/2013 11:52:09 AM,0,0x,The server threw an exception. (Exception from HRESULT: 0x80010105 (RPC_E_SERVERFAULT))
   at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)
   at ST_0391e3bc80224a34819c14be208559c5.vbproj.ScriptMain.Main()
OnError,PGIDSMSQL045,PRINCIPALUSA\TWSPGIAC,Formate Excel,{610A1615-E16E-4B62-8A93-F692A478FCF9},{EF8F3734-6467-423C-A9D3-BF2463EEFD44},04/18/2013 11:52:09 AM,04/18/2013 11:52:09 AM,8,0x,The script returned a failure result.
OnError,PGIDSMSQL045,PRINCIPALUSA\TWSPGIAC,PAM-GLPortLvlRecon,{008D2838-612E-4DBB-AEE7-65145ED0BAAC},{EF8F3734-6467-423C-A9D3-BF2463EEFD44},04/18/2013 11:52:09 AM,04/18/2013 11:52:09 AM,8,0x,The script returned a failure result.
OnError,PGIDSMSQL045,PRINCIPALUSA\TWSPGIAC,Formate Excel,{610A1615-E16E-4B62-8A93-F692A478FCF9},{EF8F3734-6467-423C-A9D3-BF2463EEFD44},04/18/2013 11:52:09 AM,04/18/2013 11:52:09 AM,1,0x,System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at ST_0391e3bc80224a34819c14be208559c5.vbproj.ScriptMain.Main()
   --- End of inner exception stack trace ---
   at System.RuntimeMethodHandle._InvokeMethodFast(Object target, Object[] arguments, SignatureStruct& sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner)
   at System.RuntimeMethodHandle.InvokeMethodFast(Object target, Object[] arguments, Signature sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.RuntimeType.InvokeMember(String name, BindingFlags bindingFlags, Binder binder, Object target, Object[] providedArgs, ParameterModifier[] modifiers, CultureInfo culture, String[] namedParams)
   at System.Type.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args, CultureInfo culture)
   at Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTATaskScriptingEngine.ExecuteScript()
OnError,PGIDSMSQL045,PRINCIPALUSA\TWSPGIAC,PAM-GLPortLvlRecon,{008D2838-612E-4DBB-AEE7-65145ED0BAAC},{EF8F3734-6467-423C-A9D3-BF2463EEFD44},04/18/2013 11:52:09 AM,04/18/2013 11:52:09 AM,1,0x,System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation. ---> System.NullReferenceException: Object reference not set to an instance of an object.
   at ST_0391e3bc80224a34819c14be208559c5.vbproj.ScriptMain.Main()
   --- End of inner exception stack trace ---
   at System.RuntimeMethodHandle._InvokeMethodFast(Object target, Object[] arguments, SignatureStruct& sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner)
   at System.RuntimeMethodHandle.InvokeMethodFast(Object target, Object[] arguments, Signature sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks)
   at System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.RuntimeType.InvokeMember(String name, BindingFlags bindingFlags, Binder binder, Object target, Object[] providedArgs, ParameterModifier[] modifiers, CultureInfo culture, String[] namedParams)
   at System.Type.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args, CultureInfo culture)
   at Microsoft.SqlServer.Dts.Tasks.ScriptTask.VSTATaskScriptingEngine.ExecuteScript() 
```

这比我想要的更有趣......但是一个很好的挑战。我检查了变量，它们有正确的信息。用户拥有对输出目录的完全访问权限，因为它在前面的步骤中创建了文件。所以我不确定我错过了什么。注意：整个过程在格式化 .xls 文件时有效，所以我不确定 .xlsx 发生了什么。谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T16:44:15.710

转换器已安装，并且必须重新启动，因为本周末服务器重新启动并且一切似乎都在工作。所以我认为我们现在很好。

# c++ - 如何使用 boost 格式打印位域

> ID：16069198
> 
> 赞同：2
> 
> 时间：2013-04-17T20:02:02.670
> 
> 标签：c++, boost

我正在使用 boost::format 打印出一个结构。但是， boost::format 似乎无法处理“位域”，请参见以下示例：

```
// Linux: g++ test.cc -lboost_system
#include <cstdio>
#include <iostream>
#include <boost/format.hpp>

struct bits_t {
    unsigned int io: 1;
    unsigned int co;
};

int main(void) {

    using std::cout;
    using boost::format;

    bits_t b; b.io = 1; b.co = 2;

    printf("io = %d \n", b.io); // Okay
    cout << format("co = %d \n") % b.co;  // Okay
    // cout << format("io = %d \n") % b.io;  // Not Okay
    return 0;

} 
```

注意`cout`我注释掉的第二个，它试图打印出位字段`printf`，但编译器抱怨：

```
`error: cannot bind bitfield ‘b.bits_t::io’ to ‘unsigned int&’ 
```

我想知道我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:12:30.157

问题是`boost::format`通过 const 引用（不是副本）获取参数，并且引用不能绑定到位域。

您可以通过将值转换为临时整数来解决此问题。一种*简洁*的方法是应用一元`operator +`。

```
 cout << format("io = %d \n") % +b.io;  // NOW Okay 
```

# xcode - 合并两个包含不同目标（Carbon/Cocoa/PPC/Intel）的 Xcode 项目文件的简单方法

> ID：16069200
> 
> 赞同：0
> 
> 时间：2013-04-17T20:02:20.007
> 
> 标签：xcode, macos, photoshop

我们有两个用于 Photoshop 插件的 Xcode 项目文件。一个用于 PS CS2 到 CS5 32 位，另一个用于 CS5 64 位和 CS6。我不会提到 PS Elements 等。对于 CS 和 PS 7.0，我们维护了一个单独的 Codewarrior 项目——嗯，主要是为了今天的运动。

无论如何，CS2 的 PPC 插件和通用二进制插件（PPC/Intel 32 位）是从一个 Xcode 项目构建的，而 64 位 Cocoa UI 插件是从另一个 Xcode 项目构建的。仅仅是因为 Adob​​e 从未在同一个项目文件中提供 64 位和 PPC 的示例。他们总是只是打破 SDK 中的旧版本支持来修复当前 PS 的问题。

我们这样做是为了使所有源文件都可以完全互操作。只是一堆#defines 控制我们所在的SDK PC/MAC_CW/MAC_XC/MAC_XC64 并且一切正常。所以我的问题是，是否有任何简单的方法可以合并两个 Xcode 项目文件，以便一个包含所有目标？当然，由于 PPC 版本，它仅限于与 10.6 一起使用，但我仍然想知道如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T11:55:11.663

在我深入研究合并之前，您可能还需要考虑：从命令行以编程`xcodebuild`方式构建所有单个项目，而不是合并它们，或者使用 Workspaces 来包含两个项目。不过，我不确定 Workspaces 是否是 10.6 中的一个选项，所以这可能不起作用。

根据您上面的描述（最值得注意的是，您在两个项目中都使用了所有相同的文件），我建议选择现有项目之一，然后复制现有目标并对其进行修改以适应您的替代构建要求。

过去我们曾尝试对 Xcode 文件进行编程和脚本合并，但通常不值得这么麻烦，因为 Xcode 项目文件非常脆弱，并且包含许多复杂的文件引用，这些引用不容易去重复。

过程将是：

1.  打开要用作最终项目的项目文件
2.  在项目导航器中选择顶级项目（这应该使项目出现在主区域
3.  选择您当前的目标
4.  选择*编辑 > 复制*
5.  使用新目标，根据需要调整设置，特别注意：产品名称、部署目标等。
6.  从 Build Phases 选项卡中的链接对象列表中删除此平台不需要的库
7.  *使用File > Add Files...*将其他库添加到项目中
**   将库添加到目标的构建阶段（链接）*

 *这会有点乏味，但它会给你比尝试以编程方式执行此操作更好的结果。*

# jquery - 如何禁用多个选择选项

> ID：16069204
> 
> 赞同：1
> 
> 时间：2013-04-17T20:02:39.933
> 
> 标签：jquery, option

如何在一次选择中禁用多个选项。例如，我有 2 个选择，有 5 个和 3 个选项。因此，如果我在第二次选择中选择第三个选项，我想在第一次选择中禁用第三、第四和第五个选项：

```
<select name="smjer">
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
</select> 
```

二选一：

```
<select name="godina" >
<option value="1" >1.</option>
<option value="2" >2.</option>
<option value="3">3.</option>
</select> 
```

我试过删除选项，但是如果不刷新页面就无法检索它们：

```
var ary=[3,4,5];
$('[name=smjer] option').filter(function(){
    return ($.inArray(parseInt(this.value),ary) >-1);
}).remove(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:05:56.597

你可以隐藏它们：

```
var ary = [3, 4, 5];
$('[name=smjer] option').filter(function () {
    return ($.inArray(parseInt(this.value), ary) > -1);
}).hide(); 
```

并在再次需要时显示它：

```
var ary = [3, 4, 5];
$('[name=smjer] option').filter(function () {
    return ($.inArray(parseInt(this.value), ary) > -1);
}).show(); 
```

为了使它更好，你可以这样做：

```
var ary = [3, 4, 5];

// Get the options to be hidden/shown
var $options = $('[name=smjer] option').filter(function () {
    return ($.inArray(parseInt(this.value), ary) > -1);
});

// Hide the options
$options.hide();

// Show the options
$options.show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:07:12.160

您也可以禁用它们：

```
var ary=[3,4,5];
$('[name=smjer] option').filter(function(){
    return ($.inArray(parseInt(this.value),ary) >-1);
}).prop('disabled', true); 
```

# c - 删除字符 c 之后的文本

> ID：16069207
> 
> 赞同：3
> 
> 时间：2013-04-17T20:03:04.127
> 
> 标签：c, text, input, output, stdio

我有一些看起来像这样的文本，来自输入文件：

```
func:
    sll  $t3, $t4, 5       # t1 = (i * 4)
    add  $t3, $a1, $t4     # t2 contains address of array[i]
    sw   $t1, 4($t2)       # array[i] = i
    addi $t2, $t5, 3       # i = i+1 
```

我想“清理”它，并将其输出到另一个文件，如下所示：

```
func:
    sll  $t3, $t4, 5
    add  $t3, $a1, $t4
    sw   $t1, 4($t2)
    addi $t2, $t5, 3 
```

这是我用来执行此操作的代码块：

```
 while(fgets(line, 100, input) != NULL)
   {
    int comment = 0;
    for(int x = 0; x < 100; x++)
    {
        if(line[x] == '#')
            comment = 1;

        if(comment == 1)
            line[x] = '\0'; //I know this is incorrect
    }
    fprintf(cleaned, "%s", line);
   } 
```

如何更改该代码块以按我的意愿工作？我搞砸了，用 '\n' '\0' 和 " " 尝试了一些东西，但都没有奏效。

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T20:07:37.937

你可以这样做，但你不需要设置标志。您可以立即截断该行并停止任何进一步的搜索`break;`

```
for(int x = 0; x < 100; x++)
{
    if(line[x] == '#') {
        line[x] = '\n';
        line[x + 1] = '\0';
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:07:37.850

在调试器中运行此代码以查看它在做什么。可能在您的外部循环中放置一个断点，`while`并一次通过一个角色来精确理解行为。您可能会很清楚下一步该做什么。

如果在 unix 上使用`gdb`，请编译您的程序`-g`以包含调试信息，然后在 Google 上搜索“gdb cheatsheet”之类的内容以开始使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:09:36.207

您可以使用`strchr`在您的行中查找“#”。如果找到，则返回一个指针，否则返回`NULL`。
您可以确定开始和出现之间的差异并创建一个新字符串。

```
/* strchr example */
#include <stdio.h>
#include <string.h>

int main ()
{
    char str[] = "This is a sample string";
    char * pch;
    printf ("Looking for the 's' character in \"%s\"...\n",str);
    pch=strchr(str,'s');
    while (pch!=NULL)
      {
        printf ("found at %d\n",pch-str+1);
        pch=strchr(pch+1,'s');
      }
    return 0;
} 
```

请参阅[此处](http://www.cplusplus.com/reference/cstring/strchr/)以获取参考。

# iphone - 在 Facebook 上共享图像和文本数据？

> ID：16069208
> 
> 赞同：-2
> 
> 时间：2013-04-17T20:03:10.453
> 
> 标签：iphone, objective-c, xcode, facebook

我想在 facebook 上共享图像和文本数据我不想要 facebook Compose 视图所有共享都是通过单击视图上的按钮完成的，这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:29:56.570

您可以使用 Facebook API 完成此操作，而无需显示 iOS Facebook 查看器。查看 Facebook iOS SDK 文档。您显然需要用户以正确的权限批准您的应用程序，这意味着将打开一个 FB 会话。

使用股票 iOS FB 对话框的好处是您不需要使用 Facebook SDK，用户不需要授予您的应用权限。如果你没有在你的应用程序中使用 Facebook Sessions，你必须坚持使用 iOS 提供的评论对话，每个 facebook 都没有办法解决这个问题。

```
-(void) postImageToFB:(UIImage *) image
{

    NSData* imageData = UIImageJPEGRepresentation(image, 90);
    Facebook* fb = [(uploadPicAppDelegate *)[[UIApplication sharedApplication] delegate] facebook   ];

    NSMutableDictionary * params = [NSMutableDictionary dictionaryWithObjectsAndKeys:[fb accessToken],@"access_token",
                                    @"message text", @"message",
                                    imageData, @"source",
                                    nil];
    [fb requestWithGraphPath:@"me/photos" 
                   andParams:params 
               andHttpMethod:@"POST" 
                 andDelegate:self];

} 
```

# java - 在包含下划线的 Android 包名称中调用 JNI 函数

> ID：16069209
> 
> 赞同：27
> 
> 时间：2013-04-17T20:03:13.403
> 
> 标签：java, android, java-native-interface, lame

我正在尝试按照以下指南使用 LAME 库在 Android 中实现 MP3 编码： [Lame MP3 Encoder compile for Android](https://stackoverflow.com/questions/8632835/lame-mp3-encoder-compile-for-android) [http://developer.samsung.com/android/technical-docs/Porting-and-using-LAME-MP3-on -Android-with-JNI](http://developer.samsung.com/android/technical-docs/Porting-and-using-LAME-MP3-on-Android-with-JNI)

但是我得到一个 java.lang.UnsatisfiedLinkError ，我认为这可能是因为我的包名包含一个下划线，它解释为句号。

查看下面的代码可能是这个问题，我该如何解决。还是有其他原因导致这种情况。提前感谢您的帮助。

*记录.java*：

```
package co.uk.ing_simmons.aberdeensoundsites;

public class Record extends Activity implements OnClickListener {

static {
    System.loadLibrary("mp3lame");
}

private native void initEncoder(int numChannels, int sampleRate, int bitRate, int mode, int quality);

private native void destroyEncoder();

private native int encodeFile(String sourcePath, String targetPath);

[.....]
} 
```

*包装器.c*：

```
void Java_co_uk_ing_simmons_aberdeensoundsites_Record_initEncoder(JNIEnv *env,
        jobject jobj, jint in_num_channels, jint in_samplerate, jint in_brate,
        jint in_mode, jint in_quality) {
[....] 
```

*完整日志猫错误*：

```
04-17 20:58:36.009: E/AndroidRuntime(26768): FATAL EXCEPTION: main
04-17 20:58:36.009: E/AndroidRuntime(26768): java.lang.UnsatisfiedLinkError: initEncoder
04-17 20:58:36.009: E/AndroidRuntime(26768):    at co.uk.ing_simmons.aberdeensoundsites.Record.initEncoder(Native Method)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at co.uk.ing_simmons.aberdeensoundsites.Record.onCreate(Record.java:79)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at android.os.Looper.loop(Looper.java:123)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at android.app.ActivityThread.main(ActivityThread.java:3687)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at java.lang.reflect.Method.invokeNative(Native Method)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at java.lang.reflect.Method.invoke(Method.java:507)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
04-17 20:58:36.009: E/AndroidRuntime(26768):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-04-17T20:28:56.583

您应该在下划线后面加上数字 1。因此，如果您的包名称包含 ing_simmons，那么您的 JNI 将像这样形成。

```
void Java_co_uk_ing_1simmons_aberdeensoundsites_Record_initEncoder 
```

如果您在调用的任何其他部分（例如 Java 文件中的类名或方法名）中有下划线，这也是如此。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-01-26T14:01:20.387

**`_1`规则上的 JNI 规范引用**

[scriptocalypse 提到](https://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/design.html#resolving_native_method_names)的`_1`规则是[JNI 规范第 8 章第 2 章：设计概述 - 解析本机方法名称](https://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/design.html#resolving_native_method_names)的一部分：

```
Escape Sequence     Denotes
_1                  the character “_” 
```

# perl - Perl - 如何在子类中创建方法别名？

> ID：16069210
> 
> 赞同：0
> 
> 时间：2013-04-17T20:03:19.660
> 
> 标签：perl, class

我正在尝试为子类中的超类泛型方法创建别名，但它似乎不起作用。同一类中的这个技巧有效，但它似乎不适用于超级/子转换。这是一个真实的基本示例。前两个电话有效。第三次调用产生关于未定义子程序的错误。我也尝试过使用 SUPER::cat，但这也没有用。

```
package foo;

sub cat{
  print("inside foo\n");
}

*bird = \&cat;

package bar;

use base 'foo';

*dog = \&cat;

package main;

foo::cat();
foo::bird();
bar::dog(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T21:03:42.200

您对面向对象的继承和简单的符号导入感到困惑。

正如你所说，`use base 'foo'`声明了一个超类。这意味着`foo`将检查对未出现在`bar`.

但是`*dog = \&cat`不是方法调用：它只是一个全局赋值，所以搜索不会超出`&bar::cat`.

如果您正在编写真正面向对象的代码，那么`*bar::dog`像这样分配将破坏继承机制的要点。

要观察 Perl 的面向对象的功能，请将 glob 赋值移动到`foo`（它只是为方法设置别名的地方）并使用方法调用语法进行调用。

在这段代码中，`bar`没有自己的方法并继承自的*所有内容*`foo`，但代码按预期工作。

```
package foo;

sub cat {
  print("inside foo\n");
}

*bird = \&cat;
*dog = \&cat;

package bar;

use base 'foo';

package main;

bar->cat();
bar->bird();
bar->dog(); 
```

**输出**

```
inside foo
inside foo
inside foo 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T20:14:53.933

这个：

```
*dog = \&cat; 
```

应该：

```
*dog = \&foo::cat; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T21:14:18.540

你应该写

```
sub dog { shift->cat(@_) } 
```

（基本上是 eta 转换`cat`方法）而不是使用 glob 赋值，以便子类`bar`可以覆盖或扩展`cat`而不会破坏`bar`' 的合同`cat`并`dog`做同样的事情。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T21:15:22.730

将 Borodin 提出的想法更进一步，假设您正在执行正确的 OO，但确实想要父类提供的方法的别名，并且仅在此子类中（以及更深层次）。在这种情况下，您可能想要这样：

```
#!/usr/bin/env perl

package foo;

sub new { return bless {}, shift }

sub cat{
  print("inside foo\n");
}

*bird = \&cat;

package bar;

use base 'foo';

sub dog { $_[0]->can('cat')->(@_) }

package main;

my $bar = bar->new;
$bar->cat();
$bar->bird();
$bar->dog(); 
```

这种机制保留`dog`在堆栈跟踪中。如果你不想这样，你可以使用`goto &sub`表格，但是因为你应该只在你知道原因的情况下这样做，所以我不打算在这里举一个例子。

# c - While 循环未正确迭代

> ID：16069217
> 
> 赞同：0
> 
> 时间：2013-04-17T20:04:02.413
> 
> 标签：c, networking, loops, while-loop, protocols

我正在研究一个计算机网络项目来模拟 TCp/IP 模型，但我遇到了一个非常奇怪的问题。这很简单，但我就是不知道我的代码有什么问题。在下面的传输函数中，我有一个 while 循环，它将单独的帧收集到一个缓冲区中，每次我去收集一个新帧时都会清除该缓冲区。问题是 while 循环正在从下一帧收集 1 个额外变量到前一帧。任何帮助将不胜感激！

```
void transmit(char *ipaddress){
char mode;
char *ap = calloc(MAX, sizeof(char));   //Arrays used to transfer data from each layer
char *Frame = calloc(MAX, sizeof(char));
mode = 's';
int i = 0, k = 0, j = 0;
ap = layer4(ap);    //Each layer returns data that is stored
ap = layer3(ap, ipaddress); 
ap = layer2(ap);
k = strlen(ap);
printf(" APLENGTH %d", k);

while(k >= 0){     //This is where I start collecting frames
        memset(Frame,0,strlen(Frame));
        while(ap[i] != 3 && ap[i+1] != 2){ //Stop if ETX followed by STX
        Frame[i] = ap[j]; 
//printf("%d, Frame[%d]: %c",j,i,Frame[i]); This was for debugging. 
        i++; j++; 
        k--; //Decrement the amount of characters left in the total package 
    }
    Frame[i] = ap[j]; //Append the last ETX bit to complete frame 
//  printf("\n"); 
    //printf("%d, Frame[%d]: %c",j,i,Frame[i]);
    i++,j++;
    Frame[i] = '\0'; //Append terminate character
    //      printf("%d, Frame[%d]: %c",j,i,Frame[i]);

    i = layer1(Frame, mode);
        printf("FRAME: %s\n\n",Frame);
    if(i != 0){
        printf("Terminating Program");
        exit(1); }
        i = 0;
}

//ap = layer1(ap, mode);

} //Trasmit Layer 
```

这是我得到的输出：

帧：STX102000000000127.0.0.1000000000000000abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcd1eb5ETX

帧：STX101010000000127.0.0.1000000000000000efghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghi1f1bETXSTX

帧： 101020000000127.0.0.1000000000000000jklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabcdefghijklmn1f35ETXSTX0

帧： 85031000000127.0.0.1000000000000000opqrstuvwxyzabcdefghijklmnopqrstuvwxyzab 184aETX

第一帧很好。第二帧的末尾不应有 STX。第三帧的末尾不应有 STX 和 0。第四帧前面应该有一个 STX 和 0 ：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:18:29.473

对于每个说 k>0 是他的问题的人来说，这可能是对的，但这不是他的主要问题。即使k>0，他的问题也会发生，因为他说它发生在帧之间。一旦最后一帧被传输，那么这就是 k>0 循环生效的时候。它与内部的while循环有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:08:04.947

它可能是这个循环：

```
k = strlen(ap);

while(k >= 0){     //This is where I start collecting frames
    ...
    k--; //Decrement the amount of characters left in the total package 
} 
```

请注意，它从长度下降到包括 0。这是长度 + 1 次通过循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:12:04.283

尝试将您的 while 条件替换为以下条件：

```
while(k > 0) 
```

# android - Eclipse PhoneGap HTML div 链接不起作用

> ID：16069220
> 
> 赞同：1
> 
> 时间：2013-04-17T20:04:13.983
> 
> 标签：android, eclipse, cordova, html

我目前正在PhoneGap上制作一个Android应用程序并且在链接图像时遇到问题，因此一旦单击它会将用户带到同一页面上的不同div，我不想制作另一个HTML文件只是一点点javascript。当我在 android 模拟器中对其进行测试时，该链接似乎不起作用，就好像我将他的链接更改为 index.html 一样。任何帮助都会很棒。

```
<div data-role="page" id="workpage">
<div data-role="header">
    <h1>Work</h1>
</div>
<div data-role="content">
<div data-role="navbar">
    <a href="index.html">Back</a>
</div>  
    <a href="#work1"><img src="work/example1.png" id="content"></a>
    <div data-role="navbar">
    <a href="index.html">Back</a>
</div>
<div data-role="footer">
    <h4>¬© 2013 Nick Willcox</h4>
</div>
</div>
<div data-role="page" id="work1">
<div data-role="header">
    <h1>Work</h1>
</div>
<div data-role="content">   
    <div data-role="navbar">
    This was the first website I created, its purpose was to be a small business card which shown a little information about myself. I used HTML4, Photoshop and CSS.
    <a href="work.html">Back</a>
</div>
</div>
<div data-role="footer">
    <h4>¬© 2013 Nick Willcox</h4>
</div> 
```

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:10:24.237

你的滚动代码在哪里？

看看[这个答案。](https://stackoverflow.com/questions/4801655/how-to-go-to-a-specific-element-on-page)它解释了如何滚动到一个元素。

**编辑**

我不知道“跟随 div 作为链接”是什么意思。div不是链接，加载div是什么意思？

如果您想使用 javascript 打开另一个链接，您可以使用：

```
window.location = http:\\www.google.com 
```

# cordova - 使用插件 WebIntent 从其他应用程序接收内容

> ID：16069221
> 
> 赞同：3
> 
> 时间：2013-04-17T20:04:14.383
> 
> 标签：cordova, android-intent, phonegap-plugins

我想接收从其他应用程序共享的信息。

为此，我正在尝试使用插件 WebIntent：[https ://github.com/phonegap/phonegap-plugins/tree/master/Android/WebIntent](https://github.com/phonegap/phonegap-plugins/tree/master/Android/WebIntent)

使用 Phonegap 2.5.0

在 AndroidManifest.xml 中（在分享部分展示我的应用程序）

```
<intent-filter> 
<action android:name="android.intent.action.SEND" />
<category android:name="android.intent.category.DEFAULT" />
<data android:mimeType="text/plain" />
</intent-filter> 
```

在 index.html 中

```
document.addEventListener('deviceready', onDeviceready, true);

function onDeviceready() {  
    window.plugins.webintent.getUri(function(url) {
      if(url !== "") {
        // url is the url the intent was launched with
         alert (url);
      }
    });
} 
```

var url，返回值为空。

插件 src/com/borismus/webintent/WebIntent.java

在 res/xml/config.xml

```
</plugins>
....
....
    <plugin name="WebIntent" value="com.borismus.webintent.WebIntent" />    
</plugins> 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-29T15:18:37.660

我现在可以得到uri了！我在用着：

```
window.plugins.webintent.getExtra(window.plugins.webintent.EXTRA_TEXT, function (url) {
              alert(url);
        }, function() { //Fail
              alert ("error");          
}); 
```

# ios - Objective-C：将代码注入委托方法

> ID：16069222
> 
> 赞同：3
> 
> 时间：2013-04-17T20:04:15.070
> 
> 标签：ios, objective-c

### 我想要的是

我想在我的应用程序中添加一些日志记录代码，而不必更新我的所有视图控制器。

### 我试过的

我试图添加一个类别`UIViewController`并覆盖其中一个委托方法。但是，这产生了几个警告/错误。

有没有办法将代码注入我所有应用的 ViewController 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:08:34.183

查看[方法 swizzling](http://cocoadev.com/wiki/MethodSwizzling)。它是一个强大的工具，可以为您节省大量时间。调配您希望登录的方法之一，然后调用原始方法以使其执行最初应做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:08:39.027

您可以继承 UIViewController，然后在您的超类中添加日志记录方法。不过，您仍然需要触摸所有 VC 并将课程更改为您的超级课程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:22:07.183

你不可能在一个 iOS 应用程序中拥有这么多视图控制器类，以至于触摸每一个都是一个大问题。所以创建你自己的 UIViewController 子类，也许`OurSuperViewController`它会作为你的视图控制器的超类，并在那里添加日志记录。然后修改每个视图控制器类，以便它们继承自`OurSuperViewController`，并确保每个都调用`super`相关的视图控制器方法。

完成后，您可以通过修改来随意打开或关闭登录`OurSuperViewController`。

# caching - 您网站上的 MP3 音频缓存

> ID：16069224
> 
> 赞同：0
> 
> 时间：2013-04-17T20:04:20.313
> 
> 标签：caching, web, mp3, autoplay

我有一个客户想在他们的网站上播放音乐并需要它自动播放。我在网站上放了一个音乐播放器，它可以很好地在列表中的 2 首歌曲之间随机播放。我的问题是他们不断遇到带宽问题。我需要找到一个解决方案，让网站上的音乐播放器在尝试重新下载之前查找缓存的文件。

是否有可以读取缓存文件的音乐播放器或代码？我一直在寻找一点，一直找不到任何东西。

或者，我的问题有更简单的解决方案吗？（其他然后从网站上删除音乐，关闭自动播放，我更喜欢但我无法做到。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:09:14.780

解决方案很简单。在 MP3 资源中包含正确的缓存指令，就像您想要缓存的任何其他文件一样。

另请参阅： [如何强制 Web 浏览器缓存图像](https://stackoverflow.com/q/1285354/362536)

# windows-xp - XP/2003 上的 ETW 文件 IO 监控

> ID：16069230
> 
> 赞同：1
> 
> 时间：2013-04-17T20:04:43.537
> 
> 标签：windows-xp, windows-server-2003, etw

我一直在调查 ETW 的进程/文件/注册表/网络监控。它看起来像在 Win7 上它拥有我需要的一切。但是，在 XP 上，它似乎缺乏相同级别的细节。具体来说，对于文件 IO，似乎只记录了“FileCreate”事件，并且进程创建事件没有给出完整路径。

是否可以确定何时使用 ETW 在 XP 上写入文件？流程启动事件的完整路径如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T04:41:10.523

从 Vista MS 开始，向 Windows 添加了许多 ETW 提供程序。XP/Server 只有其中的几个。所以你不能为XP解决这个问题。

# java - Java 弹出窗口说应用程序包含未签名和签名代码

> ID：16069233
> 
> 赞同：7
> 
> 时间：2013-04-17T20:04:59.213
> 
> 标签：java, security, warnings, mode, mixed-code

我正在使用运行 Java 1.7.0_21 的 Mac 10.7。我正在尝试运行一个已签名的 Java 小程序应用程序，并且在应用程序结束时我收到一个混合模式安全弹出窗口，上面写着“阻止运行可能不安全的组件？”。我使用的所有罐子都已签名。

我能够在运行 Java 6 的 Mac 10.6 上运行相同的小程序应用程序，但没有收到混合模式警告。我还可以在 Windows 上运行应用程序，而不会出现混合模式警告。

当我的所有 jar 都已签名时，为什么我会不断收到此错误？

我搜索了混合模式警告并找到了这个链接。

[http://docs.oracle.com/javase/6/docs/technotes/guides/jweb/mixed_code.html#manifest](http://docs.oracle.com/javase/6/docs/technotes/guides/jweb/mixed_code.html#manifest)

阅读此链接后，我有点困惑。根据此链接，我似乎需要在清单文件中提及“仅受信任”或“受信任库”属性。我查看了我的清单文件，它们没有这些属性，所以我应该把它们放进去，或者只是罐子签名的事实就足够了。

有人可以帮我理解为什么即使所有内容都已签名，我也会收到此错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T00:51:18.660

**Java 7 的更新 21**是一个强大的安全更新，它带来了一定数量的重大更改。

你应该看看它的[发行说明](http://www.oracle.com/technetwork/java/javase/7u21-relnotes-1932873.html)，有两段和两个与签名 jar 相关的已知问题。

你的问题在于这个：

> **区域**：部署/插件
> 
> **概要**：关闭应用程序时的安全弹出窗口
> 
> 从 JDK 7u21 开始，在以所有权限运行的签名小程序中调用代码的 JavaScript 代码被视为混合代码，如果签名的 JAR 文件未使用该`Trusted-Library=true`属性标记，则会引发警告对话框。请参阅混合有权限的代码和没有权限的代码（文档链接）'。
> 
> 对于以所有权限运行 JavaScript 调用的签名小程序，不应弹出任何安全对话框（带有混合代码警告）。但是，在某些情况下会显示混合代码警告。

好消息：**有一个解决方法**：

> 作为一种解决方法，如果小程序 jar 以所有权限运行并使用“Trusted-library:true”属性作为清单条目，则不会弹出混合代码警告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T15:08:50.613

最好的解决方法是使用`Trusted-Library=true`，但是，如果由于某种原因无法使其正常工作，您还可以更改计算机处理混合安全小程序的方式。

[http://docs.oracle.com/javase/7/docs/technotes/guides/jweb/properties.html](http://docs.oracle.com/javase/7/docs/technotes/guides/jweb/properties.html)

在用户的工作站上创建以下文件。 `C:\Windows\Sun\Java\Deployment\deployment.properties`

在文件中添加以下行： `deployment.security.mixcode="HIDE_RUN"`

这将告诉 Java 隐藏安全警告并在出现混合代码条件时运行小程序。此外，在发行说明中它说：

> 从 JDK 7u21 开始，在特权小程序中调用代码的 JavaScript 代码被视为混合代码，如果签名的 JAR 文件未使用 Trusted-Library 属性标记，则会引发警告对话框。
> 
> 有关详细信息，请参阅混合特权代码和沙盒代码文档。
> 
> JDK 7u21 版本通过在运行 RIA 之前提示用户提供权限，使用户能够在运行富 Internet 应用程序 (RIA) 之前做出更明智的决定。这些权限对话框包括有关用于签署应用程序的证书、应用程序的位置以及应用程序请求的访问级别的信息。有关详细信息，请参阅 RIA 的用户接受度。

仅供参考，JRE 6u19 如果小程序同时包含特权组件和沙盒组件，则会显示警告对话框。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T14:08:45.723

我还有一个从 JRE 1.7.0_21 开始生成此安全警告的小程序。

这是我学到的。如果您不希望用户被询问他是否允许调用另一个签名的 jar，那么您可以将“Trusted-Only：true”放入您的小程序清单中。呼叫将被**阻止**而没有安全警告。您添加到您正在调用的 jar 中的“Trusted-Library：true”。如果这是在 jar 的清单中并且 jar 已签名，那么当您的小程序调用它时，将不会有安全警告，并且不会阻止调用。

我的小程序使用 swing-layout-1.0.4.jar。为了解决这个问题，我不得不将“Trusted-Library: true”添加到 swing-layout-1.0.4.jar 中。您应该能够通过使用 JDK 中的 jar.exe 应用程序来执行此操作。

jar vcmf swing-layout-1.0.4a.jar MyManifest.mf swing-layout-1.0.4.jar

MyManifest.mf 是一个包含“Trusted-Library: true”的文本文件。: 和 true 之间的空格很重要，您必须在行尾有一个回车符。

出于某种原因，我无法让它工作，所以我使用 netbeans 重建了 swing-layout。swing-layout-1.0.4 的源代码是 netbeans 安装的一部分（在平台下）。我解压缩它作为一个项目打开它。在文件下，我将清单文件更改为具有魔术线（同样重要的是在 : 之后有空格并在清单文件末尾有一个空白行）并点击构建。然后我在罐子上签名，没有更多的安全警告。

我希望这会有所帮助或至少为您指明正确的方向

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-19T15:36:09.987

谢谢大家的回复。我尝试在一个小样本上添加 Trusted-Library=true ，它似乎有效。所以现在我将尝试更新我所有 jar 的清单文件。由于我们使用 ant，我将执行以下操作

```
 <jar update="true" jarfile="${deploy.dir}/javaApp.jar">
            <manifest>
                <attribute name="Trusted-Library" value="true" />
            </manifest>
        </jar> 
```

更新清单文件。

# c# - typescript 编译器可以生成 POCO .NET 类型/程序集吗？

> ID：16069234
> 
> 赞同：5
> 
> 时间：2013-04-17T20:05:02.370
> 
> 标签：c#, typescript

我正在使用 MVC 和 EF 的淘汰赛进入应用程序开发，并且我正在研究将 TypeScript 添加到配方中可能会如何帮助我。

我喜欢在 IDE 中进行创作的更简洁的机制，但缺少的东西似乎是能够从其他 .NET 程序集中引用 typescript 中定义的接口。

我是对的，除了没有完成之外，没有什么可以阻止这种情况的发生？我很好奇是否有需求，或者我是否以其他人没有的方式看待问题域。

我看到实用程序的原因是因为目前我无法在一个地方定义给定的 DTO。我必须在我的 C# View 模型和 javascript/typescript 中分别编写它们，或者我必须使用类似淘汰映射插件之类的东西，这对我的口味来说太“神奇”了。

**注意**：我不是要求将任意打字稿转换为 .NET。我只想使用 typescript 接口来生成可用的 .NET POCO 类型。

**注意 2**：我刚刚发现[http://typescript.codeplex.com/](http://typescript.codeplex.com/)以相反的方向（从 .NET 到 typescript）完成了我所要求的工作，这实际上可能足以解决我在这个问题中表达的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T01:17:14.133

有一个实用程序可以将 C# 类转换为 Typescript：[http ://type.litesolutions.net/](http://type.litesolutions.net/)

这样，您可以将 DTO 放在一个地方，即 C#。在 Nuget 上可用并且在 BitBucket 上是开源的，因此请随意修改（甚至是代码生成）和贡献。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:12:28.317

在以下位置查看我的答案：[Breeze.js 类型化实体](https://stackoverflow.com/questions/13817230/breeze-js-typed-entities/16028385#16028385)

你不能在淘汰模板中使用我的解决方案，但它绝对有助于 TypeScript 方面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-27T21:45:45.397

我通过序列化到 JSON 并返回来解决这个问题。根据您的需要，这样做的便利是值得的，如果您的文档很复杂，这是必要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-10T11:44:35.537

> Typewriter 是 Visual Studio 的免费扩展，它使用 TypeScript 模板从 c# 代码文件生成 TypeScript 文件。这允许您创建服务器端 API、模型、控制器、SignalR 集线器等的完全类型化的 TypeScript 表示，当您更改时自动更新你的 c# 代码。通过这样做，当客户端和服务器端代码不同时，你会得到 TypeScript Intellisense 和编译时错误。这加快了您的开发速度并提高了应用程序的质量。

[https://frhagn.github.io/Typewriter/](https://frhagn.github.io/Typewriter/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-10T11:42:57.620

> 从 1.7 版开始，Bridge 支持为 C# 类型生成 TypeScript 定义。在本文中，您将了解如何指示 Bridge 编译器在匹配的 .js 文件旁边发出 .d.ts 并在 Visual Studio TypeScript 项目中使用它们

[http://bridge.net/docs/generate-typescript-definitions/](http://bridge.net/docs/generate-typescript-definitions/)

# mysql - mysql根据字段vlue返回数量行

> ID：16069235
> 
> 赞同：0
> 
> 时间：2013-04-17T20:05:02.473
> 
> 标签：mysql, counter

```
select id,name,total_copies from contacts. 
```

这就是选择语句。因为它可以带回来

结果是

```
1,john,1
2,peter,3
3,sara,2 
```

我需要它

```
1,john,1
2,peter,2
2,peter,2
2,peter,2
3,sara,2
3,sara,2 
```

所以简而言之，如果 total_copies = 3 它必须返回行 3 次，如果值为 5 它必须返回行 5 次，依此类推

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:10:26.863

你可以使用这样的东西：

```
SELECT contacts.*, n
FROM
  (SELECT n1.n*10+n2.n n FROM
  (SELECT 0 n UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3
   UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6
   UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) n1,
  (SELECT 0 n UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3
   UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6
   UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9) n2) numbers
   INNER JOIN contacts ON contacts.total_copies>numbers.n
ORDER BY
  id 
```

请[在此处](http://sqlfiddle.com/#!2/93e7c/16)查看小提琴。带有数字的索引表应该使查询更容易和更快：

```
CREATE TABLE numbers (n int);    
INSERT INTO numbers VALUES (0), (1), (2), (3), (4), (5);

SELECT contacts.*
FROM numbers INNER JOIN contacts
     ON contacts.total_copies>numbers.n
ORDER BY id; 
```

[这里](http://sqlfiddle.com/#!2/9538f/1)的例子。

# java - Android 布局/视图旋转/定位

> ID：16069236
> 
> 赞同：0
> 
> 时间：2013-04-17T20:05:05.367
> 
> 标签：java, android, android-layout, android-view

我有一个带有 ImageView 和 8 个 TextView 的 RelativeLayout。我想动态地在这个图像周围放置标签。我认为最好的方法是以 45 度的间隔旋转图像并在每个位置放置一个标签，但是 Image/RelativeLayout 直到下一个预先确定的 onDraw 调用和所有 TextViews 才会重绘（即使调用了 invalidate）之后将其放入消息队列中进行定位，因此所有 TextView 在 315 度标记处彼此重叠。

我尝试将 Runnable 发布到 RelativeLayout，希望在 onDraw 调用之后将其添加到消息队列中，但不幸的是它没有用，而且我的想法已经不多了。

我当前的代码如下所示，以了解我正在尝试做的事情：

```
public void setupMenuText() {
    final float scale = getResources().getDisplayMetrics().density;

    setupMenuItemText((TextView)findViewById(R.id.menu_text_pos0), (72*scale)+0.5f);
    setupMenuItemText((TextView)findViewById(R.id.menu_text_pos1), (72*scale)+0.5f);
    setupMenuItemText((TextView)findViewById(R.id.menu_text_pos2), (72*scale)+0.5f);
    setupMenuItemText((TextView)findViewById(R.id.menu_text_pos3), (72*scale)+0.5f);
    setupMenuItemText((TextView)findViewById(R.id.menu_text_pos4), (72*scale)+0.5f);
    setupMenuItemText((TextView)findViewById(R.id.menu_text_pos5), (72*scale)+0.5f);
    setupMenuItemText((TextView)findViewById(R.id.menu_text_pos6), (72*scale)+0.5f);
    setupMenuItemText((TextView)findViewById(R.id.menu_text_pos7), (72*scale)+0.5f);
}

public void setupMenuItemText(TextView pT, float pY) {
    relativeLayout.setRotation(relativeLayout.getRotation()+45);
    pT.setText("Some Text");
    pT.setRotation(0);
    pT.setGravity(Gravity.CENTER_HORIZONTAL);
    pT.setX(0);
    pT.setY(pY);
} 
```

**编辑：感谢 JSchools 的回答，这并不是我所需要的，而是为我指明了正确的方向，并且信息是准确的。**

**对于其他有同样问题的人，将 TextView 内的文本居中不会削减它。我必须手动将 TextView 的大小设置为远高于其预期用途，以便相对于图像准确定位。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:50:20.967

您需要设置每个单独的 TextView 的旋转。您似乎多次旋转容器，但由于所有 TextViews 都在容器内，并且它们相对于容器的旋转都为零，因此它们似乎是堆叠的。根本不要旋转容器。您还需要设置 TextView 的位置，以便将它们排列成一个圆圈。简单地旋转它们会将它们粘在一起。

# jquery - 从 mvc4 的视图中调用删除帖子？

> ID：16069244
> 
> 赞同：1
> 
> 时间：2013-04-17T20:05:41.610
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-4

我试图`[HttpPost] Delete`从视图中调用。单击我想加载 jQuery 对话框并调用 post 操作方法。

它似乎在寻找我删除的删除视图。我只是保留 [HttpPost] 处理的代码。

## 索引视图

```
 <ul class="dropdown-menu">
  @{
     @Html.TryPartial("_actions", model)
        <li> @Html.ActionLink("Edit", "Edit", new {id =model.Id})</li>
        <li class="divider"></li>
        <li>@Html.ActionLink("Delete", "Delete", new {id =model.Id},new { @class = "delete-link" })</li>
  }
  </ul> 
```

## 控制器

```
 [HttpPost, ActionName("Delete")]
        [ValidateAntiForgeryToken]
        public ActionResult DeleteConfirmed(Byte[] id)
        {

            var committeeMember = db.Committee_Member.FirstOrDefault(x => x.Committee_Member_Id == id);

            if (committeeMember != null)
            {
                committeeMember.Cancelled = 1;
                db.Entry(committeeMember).State = EntityState.Modified;
                db.SaveChanges();
                Success("Your activity was deleted!");
                return RedirectToAction("Index", new { id = committeeMember.Customer_Number });
            }

            Error("there were some errors in your form.");
            return RedirectToAction("Index");
        } 
```

一旦我点击`Delete`链接页面，就会自动重定向到`Delete`没有 jQuery 对话框的视图。

网址是 [http://company.com:55253/Member/Delete/AAAAAAICyns%3d](http://company.com:55253/Member/Delete/AAAAAAICyns%3d)

```
Server Error in '/' Application.

The resource cannot be found.

Description: HTTP 404\. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable.  Please review the following URL and make sure that it is spelled correctly. 

Requested URL: /Member/Delete/AAAAAAICyns=

Version Information: Microsoft .NET Framework Version:4.0.30319; ASP.NET Version:4.0.30319.17929 
```

如何直接调用删除帖子而不重定向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:08:17.370

您正在使用`GET`而不是`POST`.

尝试

```
@using (Html.BeginForm()) {
    <input type="submit" value="Delete" />
    @Html.HiddenFor(m => m.Id)
} 
```

代替

```
@Html.ActionLink("Delete", "Delete", new AjaxOptions { HttpMethod = "POST"}, 
          new { @class = "delete-link" , id =model.Id }) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:25:23.177

您应该为此使用 RoutLink

```
@Html.RouteLink(linkname: "Delete", routeName:"DeleteMember", objectRouteValues: new {id =model.Id},objectHtmlValues: new { @class = "delete-link" }) 
```

在您的 RouteConfig 类中

```
 routes.MapRoute(
                 name: "DeleteMember",
                 url: "Delete/{id}",
                 defaults: new { controller = "Member", action = "DeleteConfirmed" }
                   ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T20:27:24.817

当您单击链接时，您只需使用retuest`Delete`导航到此 url 。`GET`您应该禁用默认链接操作，我认为最好使用 jquery ajax，而不需要额外的表单和 microsoft ajax 助手。

这个问题就是你需要的：[jQuery Ajax calls and the Html.AntiForgeryToken()](https://stackoverflow.com/questions/4074199/jquery-ajax-calls-and-the-html-antiforgerytoken)

因为没有`__RequestVerificationToken`你会得到错误，即使使用`POST`请求。

# maven - 如何为 mvn tycho 插件设置 Eclipse 工件的本地镜像？

> ID：16069245
> 
> 赞同：2
> 
> 时间：2013-04-17T20:05:41.670
> 
> 标签：maven, rcp, nexus, tycho

如果这是由于超时，那么如何设置内部镜像以提高性能并降低超时风险

**问题** Maven 构建通过 tycho 插件下载 eclipse p2 工件并在构建期间超时。

```
[ERROR] Internal error: org.eclipse.tycho.core.osgitools.OsgiManifestParserException:
Exception parsing OSGi MANIFEST /opt/atlassian/bamboo-agent-home/xml-data/build-dir/m2repo
/p2/osgi/bundle/org.eclipse.swt/3.100.1.v4234e/org.eclipse.swt-3.100.1.v4234e.jar: 
error in opening zip file -> [Help 1] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:05:41.670

Nexus Pro 可以处理 p2 存储库，但我认为 Nexus OSS 不能。

1.  在 Nexus Pro 中创建 P2 存储库（网址[http://download.eclipse.org/releases/juno/](http://download.eclipse.org/releases/juno/)）
2.  在 Nexus Pro 中创建 P2 存储库组
3.  将 P2 存储库添加到 P2 存储库组
4.  修改您的 settings.xml 以添加 p2 镜像

第一个镜像用于 maven，第二个用于 tycho eclipse p2 存储库

```
 <mirrors>
      <mirror>
        <id>internal-repository</id>
        <name>Maven Repository Manager running on repo.mycompany.com</name>
        <url>http://localhost:8081/nexus/content/groups/public/</url>
        <mirrorOf>*</mirrorOf>
      </mirror>
      <mirror>
        <id>p2-repository</id>
        <name>p2 Repository mirror</name>
        <url>http://localhost:8081/nexus/content/groups/p2groups/</url>
        <layout>p2</layout>
        <mirrorOfLayouts>p2</mirrorOfLayouts>
        <mirrorOf>*</mirrorOf>
      </mirror>
    </mirrors> 
```

# sockets - 即使一侧的IP地址发生变化，套接字是否仍保持打开状态？

> ID：16069247
> 
> 赞同：2
> 
> 时间：2013-04-17T20:05:48.050
> 
> 标签：sockets, java-7

如果我在 WAN 上的两台计算机之间打开一个套接字，而其中至少一台具有动态 IP 地址，并且即使套接字没有被明确关闭，该地址也会发生变化：请保证该套接字将保持打开状态至少在我的程序真正要求关闭它之前？

问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:12:16.543

一旦两台计算机中的一台的 IP 地址发生更改，则保留原始地址的计算机（不知道新地址）将不再能够与另一台通信。没有自动通知连接的客户端已分配新 IP 地址的过程，您可以想象创建一个，但您必须在更改旧 IP 地址之前通过旧 IP 地址传达新地址。此外，另一台计算机根本不会立即知道地址已更改，您必须等到它超时。另一个重大挑战是计算机甚至不知道它自己的 IP 地址已更改的可能性，因为在 WAN 上它可能通过 NATed 地址暴露于互联网。

# virtualbox - 如何让虚拟机实例像远程服务器一样偷偷运行？

> ID：16069254
> 
> 赞同：1
> 
> 时间：2013-04-17T20:06:01.533
> 
> 标签：virtualbox

主机和虚拟机都是 xubuntu 12.04。我知道这`VBoxManage startvm "name"`会从命令行启动一个虚拟机，但无论如何都会弹出 GUI。有没有办法启动这个虚拟机并让它在后台偷偷运行？因此我可以像访问服务器一样访问它。以前我让 GUI 启动并通过主机的控制台完成我的工作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:08:21.740

我想你正在寻找`VBoxManage startvm "VM name" --type headless`

# html - 使用单选按钮而不是提交按钮提交表单

> ID：16069255
> 
> 赞同：-1
> 
> 时间：2013-04-17T20:06:06.540
> 
> 标签：html, forms, radio-button

我有一个在 html 中有许多单选按钮的表单，我想只使用单选按钮而不是提交按钮提交表单。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:07:43.007

*这个答案使用 jQuery*

```
$('.radiobtnclass').on('click', function() {
    $('#formid').submit();
}); 
```

`radiobtnclass`是您要监控的单选按钮的类别

`formid`是您要提交的表单的 id

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:08:09.993

您可以将 onClick 事件添加到每个单选标记，如下所示：

```
<input type='radio' name='x' value='y' onClick='this.form.submit()'/> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T20:08:57.260

```
<form name="yourForm" action="action.php" method="POST">
    <input type="radio" name="radio" value="Radio button" onclick="document.forms['yourForm'].submit()" />
</form> 
```

# python - 在 Python 上创建余额表（已编辑）

> ID：16069256
> 
> 赞同：1
> 
> 时间：2013-04-17T20:06:09.000
> 
> 标签：python

我有这段代码，它根据不同的因素显示我需要向学生贷款支付的款项，但我想知道如何显示一个表格告诉我……如果我的程序说我将支付 36 笔 153.02 美元以 6.4% 的利息支付 5000 的贷款，我如何显示一个表格告诉我（153 的付款 1 这是剩余余额，这笔钱用于利息或本金支付，然后相同的付款 2 这是新余额。 .. 等等...）换句话说，一张表格告诉我这 36 笔付款以及我的余额如何随着每次付款而减少。

它不必是一个表格，也许只是一个列表......在付款后列出付款，直到余额为 0 或 - 什么？

这是我到目前为止使用 python 2.7.3 的代码

```
def calcDebt (principal, interestRate, numPayments, freqPayment):
    #This code will make different predictions to pay off student loan
    #Input Meanings
    '''
    Inputs
    - interestRate  - The Interest Rate of a Loan
    - numPayments - The Number of Payments Needed
    - principal - The Original Student Loan Amount
    - freqPayment - Frequency of Payments Based on Weekly, Monthly, Annually
    Returns
    - paymentAmount - The Payment Amount Will Be
    '''

    freqPayment_lookup = {'weekly': 52, 'monthly':12, 'annually':1}
    interestRate = float(interestRate) / 100

    x = interestRate/freqPayment_lookup[freqPayment]
    y = (1.0 + x) ** numPayments
    z = x/(y - 1.0)
    paymentAmount = (x + z) * principal

    return paymentAmount
def main():
    a = input('Student Loan Amount: ')
    i = input('Student Loan Interest Rate: ')
    n = input('Number of Payments: ')
    f = None
    while f not in ['weekly', 'monthly', 'annually']:
        if f:
            f = raw_input('Sorry! That is NOT an Option. Please Enter weekly, monthly,    or annually: ').lower()
    else:
            f = raw_input('How Often Do You Want To Make Your Payments? ').lower()
    payment = calcDebt(a, i, n, f)
    print 'Your %s payment will be %.2f' % (f, payment)
if __name__ == '__main__':
    main()
    raw_input('Please Press Enter to Exit') 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:38:44.930

I would say the best thing for this is to use numpy! here is a general idea for the kind of code you would need:

```
import numpy as np
#this creates your table with numPayments rows and 4 columns
numPayments = 40
row_index = range(1,numPayments + 1)
real_row_index = []
for i in row_index:
    real_row_index.append(str(i))
columns = ["payment number", "remaining balance", "interest amount", "principal amount"]
total_payments = np.chararray((numPayments,3), itemsize=20)
total_payments[:] = "none"
total_payments = np.insert(total_payments, 0, np.array((real_row_index)),1)
total_payments = np.insert(total_payments, 0, np.array((columns)),0)
for row in total_payments[1::,1::]: 
    #the 1 skips the lables so you don't mess with them
    #row[0] will be the number payment column
    #row[1] will be the remaining balance column
    #row[2] will be the interest amount column
    #row[3] will be the principal amount column 
```

now that you have an array of tables set up in a for loop (which I will not finish for you), you can use it in you function to iterate through and for every payment, set the cell to the correct value for the column. So if you calculate the interest amount in a variable interest, you just need to throw this in your for loop to make the interest that belongs in the right place to go there:

```
row[2] = str(interest) 
```

interest is iterating at the same pace row is, so they should match up if done correctly

# ruby-on-rails - 将对象的 id 传递给另一个嵌套对象

> ID：16069257
> 
> 赞同：0
> 
> 时间：2013-04-17T20:06:10.163
> 
> 标签：ruby-on-rails, ruby, object, controller

我正在开发一个视频游戏数据库，用户可以在其中制作游戏条目、评分和评论。

为了评论某个游戏，评论对象需要获取该游戏的 id，以便与该特定游戏相关联。我定义了一个嵌套资源

```
 resources :games do
    resources :reviews
  end 
```

在游戏的显示视图中，我有一个链接，它指向评论表单

```
link_to "Kritik verfassen", new_game_review_path(@game) 
```

表单本身是这样定义的

```
<%= form_for(@review, :url => game_reviews_path(@game)) do |f| %>

  <div class="field">
    <%= f.text_area :content, placeholder: "Compose new review..." %>
  </div>

  <%= hidden_field_tag("game_id", @game.id) %>

  <%= f.submit "Post", class: "btn btn-large btn-primary" %>

<% end %> 
```

但这会给我抛出运行时错误：“为 nil 调用 id，这会错误地为 4——如果你真的想要 nil 的 id，请使用 object_id”

我不明白为什么。我的 url 看起来像这样“localhost:3000/games/:id/reivews/new”，并且按照表单中的定义，该 url 获取“@game”属性。

这是我的评论控制器

```
 def create
    @game = Game.find_by_id(params[:id])
    @review = current_user.reviews.build(params[:review])
    @review.game_id = @game.id
    @review.user_id = current_user.id
    #@review = @game.reviews.build(params[:review])
    #@review.game_id = Game.find_by_id(params[:game_id])

    if @review.save
      flash[:success] = "review created!"
      redirect_to @review
    else
      render 'new'
    end
  end

  def new
    @review = Review.new(params[:review])
  end 
```

我的模型中的关联设置正确，但为什么我的评论表没有收到相应的游戏 ID？它仅在我关闭“hidden_​​field_tag”但我需要游戏 ID 时才有效。然后在创建评论时也会发生错误，因为控制器中传递了 game.id。为什么 game.id 为零，我如何在这个嵌套的 url 中设置它？

我很感激任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:34:42.760

我在这里发现了两个问题，以您的形式

```
<%= form_for(@review, :url => game_reviews_path(@game)) do |f| %> 
```

无需通过@game 你只需要 :url => game_reviews_path

检查您的 rake 路线以找到确切的路径助手

二、来自game_id隐藏字段标签

```
<%= hidden_field_tag("game_id", @game.id) %> 
```

您的**params[:game_id]**将给出游戏的 id，但在您的**创建**操作中，您正在执行此操作

```
 @game = Game.find_by_id(params[:id]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T09:43:47.480

哦，是的，现在它正在工作！太感谢了。但我不得不承认控制器现在看起来有点多余

```
 def create
    @game = Game.find_by_id(params[:game_id])
    @review = current_user.reviews.build(params[:review])
    @review.game_id = @game.id
    @review.user_id = current_user.id

    if @review.save
      flash[:success] = "review created!"
      redirect_to root_url
    else
      render 'new'
    end
  end

  def new
    @review = Review.new(params[:review])
    @game = Game.find_by_id(params[:game_id])
    @review.game_id = @game.id
  end 
```

有什么可以被驳回的吗？此外，现在每条评论在我的数据库中都有一个 game_id，但我仍然遇到问题，评论只列在游戏中，其 id 等于用户（作者）id。

示例：我正在尝试评论一个 ID 为 4 的游戏，而我是一个 id=2 的用户...发布时，评论不是显示在游戏编号 4 上，而是显示在 ID 为 2 的游戏上。即使正如在我的数据库中看到的，评论获得了正确的 game_id，但它与游戏无关，但用户 id 是......

我认为必须修改我的游戏控制器中的“显示”方法

目前它看起来像这样

```
 def show
    #store_location
    @game = Game.find(params[:id])
    @review = @game.reviews.build
    @feed_items = @game.feed.paginate(page: params[:page])
    #@reviews = @user.reviews.paginate(page: params[:page])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @game }
    end

  end 
```

# jquery - Toggle show/hide with checkbox

> ID：16069261
> 
> 赞同：-2
> 
> 时间：2013-04-17T20:06:15.040
> 
> 标签：jquery

**what im attempting:**

1.  On page load hide all elements
2.  on change of checkbox toggle show/hide of element

css:

```
.hide{
     display: none;
} 
```

markup:

```
<form id="checkThis">
    <input type="checkbox" data-target="hide1" class="ck">check1</input>
    <input type="checkbox" data-target="hide2"class="ck">check2</input>
</form>

<div id="theHidden">
  <div id="hide1" class='hide'>Im Hidden On Page Load</div>
  <div id="hide2" class='hide'>Im Hidden On Page Load Too</div>
</div> 
```

Fiddle for edited question: [http://jsfiddle.net/1tx18jcy/](http://jsfiddle.net/1tx18jcy/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:15:41.467

```
<input type="checkbox" data-target='transom3' .../>    
<input type="checkbox" data-target='lsl3' .../>    
<input type="checkbox" data-target='door3' .../>
// ... 
```

```
$(".partCheck").change(function(){
   $('#' + this.dataset.target).toggle(this.checked);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:16:14.407

I believe this is what you are looking for...

[http://jsfiddle.net/MYhTu/](http://jsfiddle.net/MYhTu/)

```
$(".partCheck").click(function(){
  if ($(this).prop("checked")) {
        $("#"+$(this).val()).show();
  } else {
      $("#"+$(this).val()).hide();
  }
}); 
```

in the jsfiddle, you'll notice i updated the values to be equal to the id's of the parts they are associated with (i was guessing, but you can put in your own)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-17T20:39:06.890

Replace Javascript with this line:

```
$(".partCheck").attr("onclick", "if($(this).prop('checked') $('#'+$(this).val()).show(); else $('#'+$(this).val()).hide();"); 
```

And set the values of checkboxes to equal the dev IDs.

# c# - 打开文件时出现 FileNotFound 异常

> ID：16069291
> 
> 赞同：2
> 
> 时间：2013-04-17T20:08:33.723
> 
> 标签：c#, resources, streamreader

我有一个通过 StreamReader 将多个文本文件读入列表的项目，我将文件添加到资源下的解决方案中，当我尝试使用 StreamReader 引用文件时，出现“FileNotFound”异常。

这些文件正在被复制到 bin\debug\Resources，并且错误说它试图在 bin\debug 下找到它们。如何在不使用文字路径的情况下引用它们？（例如 C:\users\etc），因为当我编译时，如果我引用实际路径，它就不会在另一个人的 PC 上运行。

调用文本文件的代码：

```
using (sr = new StreamReader("FileName.txt"))
{
    while (!sr.EndOfStream)
        Names.Add(sr.ReadLine());
} 
```

在文本文件属性下，我将其设置为“始终复制”，在构建操作下将其设置为“嵌入式资源”。

基本上，我的主要目标是将项目编译为 exe，并在内部引用文本文件（程序不会更改它们的内容），因此我的应用程序将是可移植的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:17:33.997

在您的情况下，只需替换路径即可删除错误`Resources\FileName.txt`

在其他情况下，正如您提到的，您想要制作一个可移植的 .exe。然后你需要在你的应用程序中嵌入文件。现在看看如何在 .exe 中嵌入文件：

*   展开`Properties`_`Solution Explorer`
*   双击`Resources`

    在选项卡的左上方`Resources`，将有一个组合框 ![在此处输入图像描述](https://i.stack.imgur.com/poyGv.gif)

*   选择文件

*   现在只需将文件拖放到那里
*   要嵌入文件，您可以通过右键单击每个文件来转到每个文件的属性。`Embedded in .resx`从`Persistence` 属性中选择。

要使用该文件，您可以使用`Properties.Resources.YourFile`.

有关更多详细信息，请点击链接[http://msdn.microsoft.com/en-us/library/7k989cfy(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/7k989cfy(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:18:03.743

错误很清楚。将代码更改为：

```
using (sr = new StreamReader("Resources\FileName.txt"))
{
    while (!sr.EndOfStream)
        Names.Add(sr.ReadLine());
} 
```

# sql - 如何在 SQL Server 视图中选择值（如果存在）或其他值（如果不存在）

> ID：16069296
> 
> 赞同：0
> 
> 时间：2013-04-17T20:08:41.923
> 
> 标签：sql, sql-server, select, join, view

我需要在 SQL Server 数据库上创建一个视图，其中一个列可能来自两个源中的任何一个，具体取决于存在的内容。具体来说，我们有一系列这样的表（简化）：

**表 1**：

```
personid
typeid     (one of the values from Table2)
surname
forename
  etc... 
```

**表2**：

```
typeid
typename
  etc... 
```

**表 3**：

```
attributeid
attributename
  etc... 
```

**表 4**：

```
valueid
attributeid (one of the values from table3)
typeid      (one of the values from table2)
personid    (one of the values from table1)
attributevalue
  etc... 
```

现在，我需要（除其他外）从 table4 中选择适用于一个人的“属性值”的值。这可能看起来很简单（加入 personid 就完成了），但并不是那么简单。表 4 中可能没有 personid 的行，在这种情况下，我们需要默认为与类型关联的属性值。换句话说，从逻辑上讲，它是

```
if (there exists an attributevalue in t4 associated with personid) 
  use it
else 
  use attributevalue in t4 associated with typeid 
```

我希望这很清楚。我一直在尝试确定是否可以通过一些微妙的连接或合并来完成，但一直无法弄清楚。

不幸的是，我对 SQL 的练习并不多，因此非常感谢一些指针！

最终，我希望不能使用 t3 中的属性名来编写查询（因此在此处包括它），但现在的症结在于为每个属性获取正确的值。

提前致谢

**编辑：根据以下建议进行更新**（评论太长！）：

感谢您的输入。我已经尝试过了，但它并没有返回我们所期望的。以下是数据示例：

表格1：

```
 PersonID     184
 TypeID        49
 ...etc... 
```

表 4：

```
 valueid             423    424   425    426    431    432
 attributeid           4      5     6      7      6      5
 typeid               49     49    49     49     49     49
 personid           NULL   NULL  NULL   NULL    184    184
 attributevalue      yes  track    no     no    yes    pay
   etc... 
```

所以我们期望的人 id 184 的属性值是

```
4: yes
5: pay
6: yes
7: no 
```

（默认为与相关 typeid 关联的值，其中没有与非空 personid 关联的值）

为了清楚起见，稍微修改查询：

```
SELECT distinct t.id, p.AttributeID, isnull(p.attributevalue, p1.attributevalue) AS   attributevalue
    FROM table1 as T
    LEFT JOIN table4 AS p ON p.personID = t.personID
    left JOIN table4  p1 ON p1.typeID = t.typeID 
    where t.ID=184 
```

我们回来

```
id     AttributeID  attributevalue
184        5           pay
184        6           yes 
```

因此，它正确地撤回了存在特定于 personid 的覆盖的值，而不是默认值。

任何更多的想法将不胜感激！

再次感谢

**第二次更新：**

感谢这里的建议。最后，我选择了其他地方的一个，即使用一个函数并在我需要插入一个值的每个地方调用它。它只是为给定的人/类型/属性组合返回适当的值。奇迹般有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T11:42:03.133

我想这就是你要找的。看一下这个。

```
 SELECT isnull(p.attributevalue ,p1.attributevalue) AS foo
    FROM table1 as T
    LEFT JOIN table4 AS p ON p.personid = t.personid
    LEFT JOIN table4 p1 ON p1.typeid = t.typeID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:13:08.703

[sql server is null](http://msdn.microsoft.com/en-us/library/ms184325.aspx)看起来你需要的是 null，下面是使用你的演示模式的演示。

```
SELECT isnull(p.atributeid,t.typeid) AS foo
FROM table1 as T
LEFT JOIN table4 AS p ON p.personid = t.personid 
```

# python - Python：带有奇数总和累加器的随机模块

> ID：16069299
> 
> 赞同：1
> 
> 时间：2013-04-17T20:08:55.403
> 
> 标签：python, random, dice, accumulator

您好，我正在尝试制作一个函数，包括随机模块，该模块仅累积 n 骰子奇数掷骰的总和，n 面时间。听起来有点令人困惑，但例如，如果我掷了 2 次双面骰子并得到 1 和 2，结果将只有 1（因为 2 是偶数）。这是我所拥有的：

```
import random

def roll(sides, dice):
    y = 0
    for i in range(1, dice+1):
        if y%2 == 1:
            y = y + random.randrange(1, sides+1)
    return y 
```

我怎样才能让它工作？它永远不会超过第一个 if 因为它从 y=0 开始

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:19:29.757

奇数卷：

```
count([1 for i in xrange(num_of_rolls) if (random.randint(1, sides)) % 2]) 
```

和：

```
rolls = [random.randint(1, sides) for i in range(num_of_rolls)]
sum_of_odd = sum([roll for foll in rolls if roll % 2]) 
```

未经测试，但应该可以工作:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:15:39.797

在您的代码中，问题在于您在检查`for`循环中的奇数或偶数之前添加了一个随机数。

我想你正在寻找这样的东西：

```
def roll(sides, times):
    final_sum = 0
    for i in range(times):
        randnum = random.randrange(sides)
        final_sum += randnum if randnum % 2 else 0
    return final_sum 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T20:25:10.447

..你想要单线，这是单线 :)

```
sum(r for r in (random.randrange(1, sides+1) for i in xrange(dice)) if r % 2) 
```

无论如何，要回答 OP 的问题：您的代码的问题是您正在检查到目前为止的总和是否是奇数，而不是当前的骰子...要做到这一点，您应该这样做：

```
import random

def roll(sides, dice):
    total = 0
    for i in range(dice):
        result = random.randrange(1, sides+1)
        if result % 2:
            y += result
    return y 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T02:43:39.943

您的代码应首先将随机值分配给另一个变量。然后检查是否奇数。然后添加它。

```
import random

def roll(sides, dice):
    y = 0
    roll = random.randrange(1, sides+1)
    for i in range(1, dice+1):
        if roll%2 == 1:
            y = y + roll
    return y 
```

# php - php中的mysql查询未读取php变量

> ID：16069301
> 
> 赞同：0
> 
> 时间：2013-04-17T20:08:57.750
> 
> 标签：php, mysql

我有以下代码，但我的 mysql 查询没有返回任何值。请告诉我我做错了什么：

```
foreach($stagearray as $catgry){
    echo $catgry;//this is returning the values
    $sql = mysql_query("
        select
            count(reference) as CCOUNTS,
            assignee_group
        from
            issue_tracking_issues i,
            issue_tracking_issues_issue_tracking_projects j
        where
            status NOT LIKE 'Closed%'
            AND i.id=j.issue_tracking_issue_id
            AND j.issue_tracking_project_id=1
            and $value
        having
            SUBSTR(date_raised,3,3)
        group by
            assignee_group
    ");

    while($rows = mysql_fetch_array($sql)){ 
```

这给了我以下警告：

PHP 警告：mysql_fetch_array()：提供的参数不是有效的 MySQL 结果资源

我猜我的 sql 查询无法解析 $catgry 但我不知道为什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:13:45.077

您不检查[`mysql_query()`](http://php.net/manual/en/function.mysql-query.php). 当`mysql_query()`因任何原因失败时，它会返回`false`. 当您将此`false`值放入`mysql_fetch_array()`时，它当然会抱怨，因为它需要一个查询结果集而不仅仅是一个`false`值。

至少添加`or die(mysql_error());`以查看您的查询有什么问题

```
$sql = mysql_query("select count(reference) as CCOUNTS,assignee_group from issue_tracking_issues...") or die(mysql_error()); 
```

查看查询，我猜罪魁祸首可能是`having`子句中的`where`。`having`不能以这种方式用作运算符，因为它是从`group by`集合中选择的。这应该是

```
select ... from ... where ... group by ... having ... 
```

如果要与`$value`子字符串进行比较，请使用比较运算符，如`=`or`like`或`regexp`。

详情请参阅[`SELECT Syntax`](http://dev.mysql.com/doc/refman/5.5/en/select.html)。

OT：`mysql*`现在已弃用。考虑切换到`mysqli*`或`PDO`。

# php - 如何在两个不同的服务器中与 php 交互

> ID：16069303
> 
> 赞同：0
> 
> 时间：2013-04-17T20:09:01.993
> 
> 标签：php, cross-domain

我正在尝试一个可以为一堆 pdf 文件生成图像的项目。

我正在运行的脚本和 Web 界面已打开`server A`。

我的网页`server A`如下

```
pdf a
pdf b
pdf c
pdf d

create pdf images button. 
```

点击按钮后，图像将生成并显示在网页中。

但是，那些实际的 pdf 文件位于`server B`.

`php`生成`pdf`图像的脚本`server B`也在其中。我不知道如何做到这一点。谁能给我一个提示？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:11:14.547

也许将它们作为作业放在数据库中，然后让每个服务器查询该数据库以提取“请求”

有一些用于构建作业守护程序的好工具，您可以使用它们来完成此类事情。

如果这不是你要找的，请原谅我误解了这个问题！

# ios - 为什么 NSNotificationCenter 发布会导致“无法识别的选择器发送到实例”？

> ID：16069306
> 
> 赞同：2
> 
> 时间：2013-04-17T20:09:02.873
> 
> 标签：ios, objective-c, nsnotificationcenter

我有一个包含多个类的 iPad 应用程序（XCode 4.6、Storyboards、iOS 6.2）。在一个班级中，当我完成发布后，我发布了一条通知，我希望另一个班级能够收到该通知。没有发生！

这是我在 AppDelegate.m 中注册通知的代码：

```
 // add observers for notificaations
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(calendarTapNotification:)
                                             name:@"calendarDateSelected" object:nil ];
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(notificationOfAppointmentMade:)
                                             name:@"appointmentMade" object:nil ]; 
```

这是我为其中一位观察员发布通知的代码：

if(aDate != nil) { // 如果用户在有效日期范围之外点击，aDate 将为 nil

```
 [passedData setObject:aDate forKey:@"selectedDate"];

    //  post notification CFGregorianDate has been tapped and pass selected date
    [[NSNotificationCenter defaultCenter] postNotificationName:@"calendarDateSelected" object:self userInfo:passedData];

} 
```

这是我处理从未被调用的“calendarTapNotification”通知的代码：

```
- (void) calendarTapNotification:(NSNotification *) notification  {

//  was the calendar tapped?
if ([[notification name] isEqualToString:@"calendarDateSelected"])  {

    //  get the data in the dictiionary
    NSDictionary *dict = [notification userInfo];
    //        NSLog(@"\ndict contents: %@", [dict objectForKey:@"selectedDate"]);  //  this is NSDate class!

    // gets the year, month, and day for selected date
    NSDate *selectedDate = [dict objectForKey:@"selectedDate"];
    //        NSLog(@"\n\ndict-selectedDate: %@", [dict objectForKey:@"selectedDate"]);

    NSCalendar *calendar = [NSCalendar currentCalendar]; // get default calendar
    NSDateComponents *components = [[NSCalendar currentCalendar] components:NSDayCalendarUnit | NSMonthCalendarUnit | NSYearCalendarUnit fromDate: selectedDate];
    //        NSLog(@"\n\ndateFromComponents: %@", components);

    // create start and end of date
    NSDate *startDate = [self beginningOfDay: [calendar dateFromComponents:components]];
    NSDate *endDate = [self endOfDay: [calendar dateFromComponents:components]];
    //        NSLog(@"\nstartDate: %@    endDate: %@", startDate, endDate);

    //  create the predicate
    NSPredicate *predicate =  ([NSPredicate predicateWithFormat:@"((aStartTime > %@) AND (aStartTime <= %@))", startDate, endDate]);

    //  find all appointments with that selected date (AppointmentInfo is NSManagedContext; appointmentInfo is NSArray)
    appointmentInfo = [AppointmentInfo MR_findAllWithPredicate:predicate];

    SingletonAppointments *sharedInstance = [SingletonAppointments sharedInstance];  //  initialize
    //        if(sharedInstance.globalApptList.count > 0)  //  <--------------  TODO
    //            [sharedInstance.globalApptList removeAllObjects];                   //removeAllObjects];  //  clear out the old stuff

    if(appointmentInfo.count > 0)  {
        for (AppointmentInfo *appt in appointmentInfo) {
            sharedInstance.globalApptList = appointmentInfo;  //  move data to sharedInstance
        }
    }
    else  {
        sharedInstance.globalApptList = nil;
    }
    // NSLog(@"\n\nsharedInstance.count: %d", sharedInstance.globalApptList.count);

    //  re-draw the schedule
    [self.subViewData setNeedsDisplay];

} 
```

}

这是“崩溃”的输出：

> 2013-04-17 12:58:47.942 saori[11294:c07]-[AppDelegate calendarTapNotification:]：无法识别的选择器发送到实例 0x8a25c60 2013-04-17 12:58:47.943 saori[11294:c07] *** 终止应用程序uncaught exception 'NSInvalidArgumentException', reason: '-[AppDelegate calendarTapNotification:]: unrecognized selector sent to instance 0x8a25c60' *** First throw call stack: (0x2701012 0x19efe7e 0x278c4bd 0x26f0bbc 0x26f094e 0x14b04f9 0x275b0c5 0x26b5efa 0x13e4bb2 0x7de8 0x80eb 0x966cef 0x966f02 0x944d4a 0x936698 0x2b7edf9 0x2b7ead0 0x2676bf5 0x2676962 0x26a7bb6 0x26a6f44 0x26a6e1b 0x2b7d7e3 0x2b7d668 0x933ffc 0x297d 0x28a5 0x1) libc++abi.dylib：终止调用抛出异常

我已经尝试了我所知道的一切，阅读了 NSNotifications 上的两个 Apple 文档并查看了 Google 和 SO，但一无所获）

为什么不调用通知处理程序？（我想这会导致导致崩溃的原因）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:10:46.723

确保你已经实施

```
calendarTapNotification:
notificationOfAppointmentMade: 
```

在你的`AppDelegate`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:13:48.613

如果您还没有实现该`calendarTapNotification:`方法，请实现它，其次确保您在使用方法时使用该参数`:`。

当您为通知添加观察者时，您应该能够收听它，为了收听通知，它应该被发布。确保您`calendarDateSelected`在代码中发布通知。我没有看到你发布的任何地方。

# javascript - 如何使用angularjs在延迟后更改值？

> ID：16069309
> 
> 赞同：39
> 
> 时间：2013-04-17T20:09:18.297
> 
> 标签：javascript, angularjs

我创建了基于`angularjs`

**HTML：**

```
<div ng-app="miniapp">
<div ng-controller="Ctrl">
    My name is 
    <input type="text"/>   
    Val: {{val}}
    <br/>
    <button ng-disabled="val">Submit</button>        
</div> 
```

**JS：**

```
var app = angular.module('miniapp', []);

var glob;
function Ctrl($scope) {      
    glob = $scope;    
     $scope.val = false;

     window.setTimeout(function() {
            $scope.val = true;
        }, 3000);             
}

 window.setTimeout(function() {
            glob.val = true;
        }, 3000); 
```

如您所见，我尝试通过 2 种方式在 3 秒后更改`val`为`true`，但没有人为我工作。真的很奇怪。我错过了什么？

实际上，我在从 Ajax 获得响应后尝试更改值，但假设应该是同样的问题。

谢谢，

这是我的例子：http: [//jsfiddle.net/6uKAT/20/](http://jsfiddle.net/6uKAT/20/)

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2013-04-17T20:19:05.830

尝试使用：[`$timeout`](http://docs.angularjs.org/api/ng.%24timeout)

> Angular 的 window.setTimeout 包装器。fn 函数被包装在一个 try/catch 块中，并将任何异常委托给 $exceptionHandler 服务。

`$timeout(fn[, delay][, invokeApply]);`

[更新小提琴](http://jsfiddle.net/6uKAT/22/)

**JavaScript**

```
var app = angular.module('miniapp', []);

function Ctrl($scope, $timeout) {  
     $scope.val = false;
     $timeout(function(){$scope.val = true}, 3000);       
} 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-04-17T20:20:38.400

您正在对 Angular 所知道的范围之外的范围进行更改（在超时内）。
所以你应该使用`$timeout`.. 否则你必须使用`$scope.$apply()`

```
$timeout(function() {
    $scope.val = true;
}, 3000); 
```

[http://jsfiddle.net/6uKAT/21/](http://jsfiddle.net/6uKAT/21/)

对于超时使用`$timeout`，它会`$scope.$apply()`为你打电话。
同样，对于 ajax 使用`$http`.

如果你不能使用这些，那么你必须给`$scope.$apply()`自己打电话：

```
 window.setTimeout(function() {
     $scope.$apply(function() {
        $scope.val = true;
     });
 }, 3000); 
```

# excel - 对象“工作簿”的“添加”方法失败 - 使用 vba Access 2007 导入 excel 工作簿

> ID：16069312
> 
> 赞同：3
> 
> 时间：2013-04-17T20:09:23.593
> 
> 标签：excel, ms-access, ms-access-2007, vba

已解决：我已经接受了 Siddharth 的以下回答。我非常感谢大家的帮助，我对迅速的反应感到惊讶。当我来到这个社区寻求帮助时，我总是学到一些新东西，你们太棒了。

* * *

感谢您花点时间查看我的消息。我已经编写了一个脚本（这在很大程度上要感谢这里对 SO 的大力帮助），它需要一个 excel 工作簿并将每个工作表导入到 Access 2007 数据库中的一个单独的表中。该脚本过去在我的 PC 上运行良好，但由于最近从硬件故障中恢复，我无法让该脚本运行。最重要的是，我的客户收到的错误消息与我自己的不同。

问题的很大一部分与我的对象引用有关，当我从工具菜单添加 Microsoft Excel 14 对象库作为引用时，一切正常。但是，客户在其系统上安装了不同版本的 Office，并希望将此应用分发给*可能*安装了其他 Office 版本的其他人。我试图实现某种形式的后期绑定，但我可能没有正确地解决这个问题。代码如下：

编辑：当前代码再次更新，与下面 Siddharth 接受的帖子相关

```
Private Sub Command101_Click()
    On Error GoTo Err_Command101_Click

    ' Set up excel object
    Dim excelApp As Object
    Set excelApp = CreateObject("Excel.Application")

    ' Set up workbook object
    Dim excelbook As Object

    ' Set up file selection objects with parameters
    Dim fileSelection As Object
    Dim intNoOfSheets As Integer, intCounter As Integer
    Dim strFilePath As String, strLastDataColumn As String
    Dim strLastDataRow As String, strLastDataCell As String

    ' Prompt user with file open dialog
    Set fileSelection = Application.FileDialog(1)
    fileSelection.AllowMultiSelect = False
    fileSelection.Show

    ' Get the selected file path
    strFilePath = fileSelection.SelectedItems.Item(1)
    ' Open the workbook using the file path
    Set excelbook = excelApp.Workbooks.Open(strFilePath)
    ' Get the number of worksheets
    intNoOfSheets = excelbook.Worksheets.Count
    ' Set up object for current sheet name
    Dim CurrSheetName As String
    ' Disable errors
    DoCmd.SetWarnings False

    ' Loop through each sheet, adding data to the named table that matches the sheet
    For intCounter = 1 To intNoOfSheets
        excelbook.Worksheets(intCounter).Activate

        DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, _
        excelbook.Worksheets(intCounter).Name, strFilePath, True, _
        excelbook.Worksheets(intCounter).Name & "!" & _
        Replace(excelbook.Worksheets(intCounter).UsedRange.Address, "$", "")
    Next

    ' Close Excel objects
    excelbook.Close
    excelApp.Quit
    Set excelApp = Nothing
    ' Confirmation message
    MsgBox "Data import Complete!", vbOKOnly, ""
    DoCmd.SetWarnings True

Err_Command101_Click:
    MsgBox Err.Description
End Sub 
```

`Set excelbook = excelApp.Workbooks.Add`与此消息在线的客户端似乎发生了故障：

[![](https://i.stack.imgur.com/C1IHe.png)](https://i.stack.imgur.com/C1IHe.png)

我的问题有点双重：a）我是否正确实施了后期绑定？b) 如何在确保脚本独立于特定 Office 版本的同时解决此错误？

感谢您的任何帮助，您可以提供！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:26:04.593

我相信错误在这一行

```
DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, ActiveSheet.Name, _
    strFilePath, True, _
    excelbook.Worksheets(intCounter).Name & "!" & _
    Replace(excelbook.Worksheets(intCounter).UsedRange.Address, "$", "") 
```

`ActiveSheet.Name`<+++++ 这是导致错误的原因。

将其更改为`excelbook.Worksheets(intCounter).Name`

在后期绑定中，代码将无法理解什么`Activesheet`是

**跟进**

你得到一个编译错误，因为你没有在第一行的末尾添加“_”`DoCmd.TransferSpreadsheet`

复制以下代码并将其粘贴到您的代码中。

```
DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12, _
excelbook.Worksheets(intCounter).Name, _
strFilePath, True, _
excelbook.Worksheets(intCounter).Name & "!" & _
Replace(excelbook.Worksheets(intCounter).UsedRange.Address, "$", "") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T20:18:53.203

该`Workbooks.Add`方法创建一个新工作簿。我不明白你为什么要使用它。似乎我希望用户选择一个现有的工作簿并打开它，所以你应该使用它`Workbooks.Open`。

至于您是否正确实现了后期绑定，请确保您的代码模块包含`Option Explicit`在其声明部分（有关有用的详细信息，请参阅 Gord 的答案），然后从 VB 编辑器的主菜单运行 Debug->Compile。这项工作将提醒您代码中的任何内容（对象、属性、方法、常量），您需要进一步工作以使其与后期绑定兼容。

这是一个很大的危险信号：

```
DoCmd.SetWarnings False 
```

关闭`SetWarnings`可以抑制错误信息，您需要这些信息来帮助理解为什么您的代码没有按照您的意愿执行。如果您觉得必须在生产代码中关闭`SetWarnings`，至少在开发和调试期间将其保持打开状态。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T20:35:20.987

我将添加这个仅供参考...在 VBA IDE 窗口中选择`Tools > Options...`并确保“需要变量声明”框有一个复选标记：

![vba 选项](https://i.stack.imgur.com/zSz4h.png)

然后，检查所有现有模块以确保前两行是

```
Option Compare Database
Option Explicit 
```

该`Option Explicit`语句将添加到您创建的任何新模块中，但您需要自己为任何现有模块添加它。

# c# - 网格视图中的 DataKeyValues 为空

> ID：16069316
> 
> 赞同：1
> 
> 时间：2013-04-17T20:09:33.093
> 
> 标签：c#, asp.net, datakey

这是我`gridview`的，当用户单击行内的编辑按钮时触发的事件。出于某种原因，我的`datakey`值正在使程序崩溃，说它为空。我不知道为什么。中的 DataKeyNames`gridview`正是我想要的，`formID`. `gridview`这是正确的，因为如您所见， 中的最后一列显示了`formID`并且它显示得很好。所以我不知道我哪里出错了。

```
 <asp:GridView ID="gvHistory" runat="server" DataSourceID="ObjectDataSource" 
                AutoGenerateColumns="False" CellPadding="10" CellSpacing="5" 
                CssClass="userHistory" DataKeyNames="formID">
                <Columns>
                    <asp:BoundField DataField="clientName" HeaderText="User" />
                    <asp:BoundField DataField="formName" HeaderText="Form" />
                    <asp:BoundField DataField="dateCreated" HeaderText="Date Created" />
                    <asp:BoundField DataField="dateRevised" HeaderText="Last Revision Date" />
                    <asp:BoundField DataField="dateSubmitted" HeaderText="Date Submitted" />
                    <asp:TemplateField ShowHeader="False">
                        <ItemTemplate>
                            <asp:Button ID="edit" runat="server" CausesValidation="false" CommandName="editForm" 
                                Text="Edit" OnDataBinding="btnEdit_DataBinding" OnClick="btnEdit_Click" />
                        </ItemTemplate>
                    </asp:TemplateField>
                    <asp:TemplateField ShowHeader="False">
                        <ItemTemplate>
                            <asp:Button ID="delete" runat="server" CausesValidation="false" CommandName=""
                                Text="Delete" OnDataBinding="btnDelete_DataBinding" />
                        </ItemTemplate>
                    </asp:TemplateField>
                    <asp:BoundField DataField="formID" />
                </Columns>
            </asp:GridView>

protected void btnEdit_Click(object sender, System.EventArgs e)
{
    Session["formID"] = gvHistory.SelectedDataKey.Value;
    Label1.Text = Session["formID"].ToString();

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:18:55.750

如果您正在使用`CommandName`您的项目模板，那么您可以简单地使用[Row_Command](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.gridview.rowcommand.aspx)事件，您不需要为按钮单击创建单独的处理程序。

```
protected void grdView_RowCommand(object sender, GridViewCommandEventArgs e)
{
  if (e.CommandName == "editForm")
    {
      GridViewRow row = (GridViewRow)(((Button)e.CommandSource).NamingContainer);
      string value=grdView.DataKeys[row.RowIndex].Values["myDataKey"].ToString();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:15:59.340

按钮 btn =（按钮）发送者；

```
 GridViewRow gvrow = (GridViewRow)btn.NamingContainer;
        if (gvrow != null)
        {
            //Get the Row Index
            int rowIndex = gvrow.RowIndex;
            //Get the DataKey value
            Session["formID"] = gvHistory.DataKeys[rowIndex].Value.ToString();
            Label1.Text = Session["formID"].ToString();

        } 
```

# asp.net - Asp.Net 没有提供足够的错误信息

> ID：16069318
> 
> 赞同：0
> 
> 时间：2013-04-17T20:09:37.907
> 
> 标签：asp.net, error-handling, elmah

我对这段代码感到沮丧，因为我不知道发生了什么。

我的用户在尝试编辑网络表单上的简单值时偶尔会出现错误（我无法复制它，因为它对我来说很好用）：

```
Server Error in '/cp' Application.

Input string was not in a correct format.

Description: An unhandled exception occurred during the execution of the current web                                                                       request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.FormatException: Input string was not in a correct format.

Source Error: 

An unhandled exception was generated during the execution of the current web request.  Information regarding the origin and location of the exception can be identified using the exception stack trace below.

Stack Trace: 

[FormatException: Input string was not in a correct format.]
System.Number.StringToNumber(String str, NumberStyles options, NumberBuffer& number, NumberFormatInfo info, Boolean parseDecimal) +13908045
System.Number.ParseInt32(String s, NumberStyles style, NumberFormatInfo info) +305
DevExpress.Web.ASPxPopupControl.Internal.PopupWindowClientStateUtils.LoadClientState(PopupWindow window, String state) +288
DevExpress.Web.ASPxPopupControl.ASPxPopupControl.LoadWindowsState(String state) +133
DevExpress.Web.ASPxClasses.ASPxWebControl.LoadPostDataInternal(NameValueCollection postCollection, Boolean raisePostDataEvent) +447
System.Web.UI.Page.ProcessPostData(NameValueCollection postData, Boolean fBeforeLoad) +1068
System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +2773 
```

它告诉我发生了异常，但没有告诉我发生在哪里，或者为什么。

将更改保存到存款的弹出框按钮是：

```
 Protected Sub btnDepPaid_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnDepPaid.Click
        Try
            ASPxPopupControl3.ShowOnPageLoad = False
            Dim da As New bsTableAdapters.DepositTableAdapter
            da.UpdateQuery(DepPaid.Text, CustID.Text)

        Catch ex As Exception

        End Try

    End Sub 
```

我正在运行 Elmah，它显示的只是上面的错误 - 但我看不出错误是如何发生的 - 因为根据 Elmah 的说法，DepPaid.Text 和 CustID.Text 具有有效的“字符串”，例如：“65.00”在他们中。

我的沮丧是，错误并没有说明问题出在哪一行，只是“输入字符串的格式不正确” - 我怎样才能让它给我更多信息？

还有什么我可以添加到上面的代码中，以捕获错误发生的位置，或者任何其他可以查明错误实际是什么的信息？

根据 Elmah 的说法，正在输入的是：

![艾玛输入法](https://i.stack.imgur.com/THj7k.png)

谢谢，马克

# java - 包保护类中的公共方法有什么理由吗？

> ID：16069320
> 
> 赞同：9
> 
> 时间：2013-04-17T20:09:47.980
> 
> 标签：java, class-visibility

我想知道如果方法是公共的或在受包保护的类中受包保护，是否有任何区别。

```
class Example {
  public void test() {}
} 
```

代替

```
class Example {
  void test() {}
} 
```

我想最大的能见度是由班级给出的。而一种方法只能降低可见度，增加可见度没有效果。

但它是有效的语法，所以也许我监督了一些事情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T20:16:53.567

如果我们`Example`将子类化为一个`public`类，则包外部的代码可以`test()`使用子类实例访问方法（如果是）`public`。

例子：

```
package A;
class Example {
   public void test() {}
}

package A;
public class SubExample extends Example {
}

package B;
import A.SubExample;
class OutsidePackage {
  public void some method(SubExample e){
    // Had test been defined with default access in class Example
    // the below line would be a compilation error.
    e.test();
  }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-17T20:11:24.840

如果`Example`实现了某种接口，您必须将它们公开，因为在这种情况下您无法减少访问。默认情况下，所有接口方法都是公共的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:14:01.747

正如所写，它什么也不做。如果它是子类或接口实现，那么它可能正在实现或覆盖在其他地方声明为公共的方法。

# java - 将 heroku cedar 模型映射到多线程应用程序

> ID：16069333
> 
> 赞同：1
> 
> 时间：2013-04-17T20:10:33.947
> 
> 标签：java, spring, heroku, concurrency

我并不真正了解 Heroku 的测功机和工作进程模型，因为它与单个进程但多线程的基于 Java 的服务器有关。

例如：我怎么知道（对于单个测功机）有多少处理器可用于我的后台线程？我是否需要使用 RabbitMQ 之类的东西并为每个后台处理任务创建一个单独的进程（应用程序）并在服务器和这些服务器之间进行通信？对于使用线程缓存执行器的一些计划任务来说似乎有点矫枉过正。是否应该将所有 Futures 更改为进程间 Futures？

我想这归结为这个问题。我可以不再编写多线程服务器并扩展服务器进程可用的处理器以适应我的线程活动吗？或者我是否需要重构我的架构以使用单独的进程来实现并发？如果是前者，我需要工人还是只需要多个测功机？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T05:27:28.323

Heroku 支持多种并发模型，所以这完全取决于您希望如何构建您的应用程序。您可以访问完整的 Java 堆栈，因此如果在您的 Web 进程中作为多个线程运行更有意义，您绝对可以这样做，或者您始终可以在 RabbitMQ 或 Redis 之类的东西上将作业排入队列并单独处理它们工人测功机。如果工作量轻且与您的 Web 请求成正比，多线程更简单且有意义，因为它将与 Web dynos 一起扩展；但是，如果工作量很大，不成比例，和/或需要独立扩展，那么将其分解为一个单独的过程会更好。

Heroku 最初只是一个 Ruby 平台，它没有与 Java 相同的线程功能，因此使用单独的 worker dyno 对 Ruby 来说更为重要，这反映在一些文档和示例中，这可能导致你的困惑。幸运的是，使用 Java，您可以使用更多选项，并且可以使用最适合手头工作的选项。

# jquery - Wordpress 中的 jQuery 版本冲突

> ID：16069334
> 
> 赞同：-2
> 
> 时间：2013-04-17T20:10:34.383
> 
> 标签：jquery, wordpress, fancybox

我注意到我在我的 wordpress 网站中加载了 2 个不同版本的 jquery。

我看到我在标题中引用了 1.8 版本（通过谷歌代码），但似乎找不到 1.6.4 版本来删除它？

我的花式插件不再工作，我不确定我做了什么导致这个？当我单击图像时，它会显示精美的加载图像，但随后叠加层只会覆盖页面并且不会打开图像。

任何消除此版本冲突的建议将不胜感激。谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:15:10.237

从 Chrome 的页面检查器中，我可以看到脚本刚刚加载到标题中。

可能是某个插件正在加载此版本。你可以做的是一个一个地禁用你的插件，看看哪个能解决它。

# c# - 将用户输入与之前输入的值进行比较

> ID：16069338
> 
> 赞同：0
> 
> 时间：2013-04-17T20:10:52.873
> 
> 标签：c#, arrays, sorting

我在让我的程序检查之前的输入并进行比较时遇到问题，因此用户无法复制订单号。现在该程序将一直运行并按照我想要的方式运行，但它接受重复的订单号，而我希望它通知用户并要求他们重新输入。问题似乎是我的 check[y] 数组在比较时不包含任何值。如何让这个数组包含先前输入的订单号，以便显示错误消息。我只是要发布整个代码，这样你就可以看到我到目前为止所做的事情。其他人建议使用 List 类型，但我是学生，还没有学过。我相信我应该使用 Equals 方法。任何帮助，将不胜感激。

```
 using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;

namespace Assignment6_Hergott
{

class Order : IComparable <Order>
{

    public int orderNumber { get; set; }
    public string customerName { get; set; }
    public int quanityOrdered { get; set; }
    public double total;
    public const double priceEach = 19.95;

    public Order()
    {
    }
    public Order(int number, string name, int quanity)
    {
        number = orderNumber;
        name = customerName;
        quanity = quanityOrdered;
    }

    public double totalPrice
    {
        get
        {
            return total;
        }
    }

    public int CompareTo(Order o)
    {
        return this.orderNumber.CompareTo(o.orderNumber);
    }

    public override bool Equals(Object e)
    {
        bool equal;
        Order temp = (Order)e;
        if (orderNumber == temp.orderNumber)
            equal = true;
        else
            equal = false;
        return equal;

    }
    public override int GetHashCode()
    {
        return Convert.ToInt32(orderNumber);
    }
    public override string ToString()
    {
    return "ShippedOrder " + orderNumber + " " + customerName + " " + quanityOrdered + 
    " @ " + priceEach + " each.";

    }

}
class ShippedOrder : Order
{

    public const int shippingFee = 4;

    public override string ToString()
    {
   return base.ToString() + " Shipping is " + shippingFee + " Total is " + totalPrice;
    }
}
class Program
{
    static void Main(string[] args)
    {

        double sum = 0;
        ShippedOrder[] orderArray = new ShippedOrder[5];
        ShippedOrder[] check = new ShippedOrder[5];
        bool wrong = true;
        for (int x = 0; x < orderArray.Length; ++x)
        {

            orderArray[x] = new ShippedOrder(); 

            Console.Write("Enter order number: ");
            orderArray[x].orderNumber = Convert.ToInt32(Console.ReadLine());

            for (int y = 0; y < x; y++)
            {
                check[y] = new ShippedOrder();

                if (orderArray[x].Equals(check[y]))
                    wrong = false;
                    while (!wrong)
                    {
                        Console.WriteLine("Sorry, the order number {0} is a duplicate. 
\nPlease reenter: ", orderArray[x].orderNumber);
                        for (y = 0; y < x; y++)
                        {
                        if (orderArray[x].Equals(check[y]))
                            wrong = false;

                        }
                        check[y] = orderArray[x];
                    }
            }

            Console.Write("Enter cusomer name: ");
            orderArray[x].customerName = Console.ReadLine();

            Console.Write("Enter quanity: ");
            orderArray[x].quanityOrdered = Convert.ToInt32(Console.ReadLine());

            orderArray[x].total = orderArray[x].quanityOrdered * Order.priceEach + 
ShippedOrder.shippingFee;

            sum += orderArray[x].total;

        }
        Array.Sort(orderArray);
        for (int x = 0; x < orderArray.Length; x++)
        {
            Console.WriteLine(orderArray[x].ToString());
        }
        Console.WriteLine();
        Console.WriteLine("Total for all orders is {0:c} ", sum);
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:41:46.177

我有几分钟的时间，所以我更改了答案，向您展示了一种可以完成的方法。但是，如果您只是复制/粘贴此内容，您将对自己造成伤害（您的老师可能会说出来）。查看解决方案，看看它与您的解决方案有何不同。我犹豫是否要发布完整的解决方案，但我认为这可能是您找出自己做错了什么的好方法。

```
namespace ConsoleApplication2
{
    using System;
    using System.Linq;

    public class Order : IComparable<Order>
    {
        public const double PriceEach = 19.95;

        public Order()
        {
        }

        public Order(int number, string name, int quanity)
        {
            this.OrderNumber = number;
            this.CustomerName = name;
            this.QuanityOrdered = quanity;
        }

        public int OrderNumber { get; set; }

        public string CustomerName { get; set; }

        public int QuanityOrdered { get; set; }

        public int CompareTo(Order o)
        {
            return this.OrderNumber.CompareTo(o.OrderNumber);
        }

        public override bool Equals(object e)
        {
            int compareTo;
            int.TryParse(e.ToString(), out compareTo);
            return this.OrderNumber == compareTo;
        }

        public override int GetHashCode()
        {
            return Convert.ToInt32(this.OrderNumber);
        }

        public override string ToString()
        {
            return "Shipped order number " + this.OrderNumber + " for customer " + this.CustomerName + " " + this.QuanityOrdered +
            " @ $" + PriceEach + " each.";
        }
    }

    public class ShippedOrder : Order
    {
        public const int ShippingFee = 4;

        public double TotalPrice
        {
            get
            {
                return (this.QuanityOrdered * PriceEach) + ShippingFee;
            }
        }

        public override string ToString()
        {
            return base.ToString() + " Shipping is $" + ShippingFee + ". Total is $" + this.TotalPrice;
        }
    }

    public class Program
    {
        private static readonly int[] OrderNumbers = new int[5];
        private static readonly ShippedOrder[] ShippedOrders = new ShippedOrder[5];

        public static void Main(string[] args)
        {
            double sum = 0;

            for (var i = 0; i < OrderNumbers.Length; i++)
            {
                OrderNumbers[i] = InputOrderNumber();
                var name = InputCustomerName();
                var quantity = InputQuantity();
                ShippedOrders[i] = new ShippedOrder { CustomerName = name, QuanityOrdered = quantity, OrderNumber = OrderNumbers[i] };
                sum += ShippedOrders[i].TotalPrice;
            }

            Array.Sort(ShippedOrders);
            foreach (var t in ShippedOrders)
            {
                Console.WriteLine(t.ToString());
            }

            Console.WriteLine();
            Console.WriteLine("Total for all orders is {0:c} ", sum);
            Console.WriteLine();
            Console.WriteLine("Press enter to exit.");
            Console.ReadLine();
        }

        private static int InputOrderNumber()
        {
            Console.Write("Enter order number: ");
            var parsedOrderNumber = InputNumber();

            if (ShippedOrders.Any(shippedOrder => shippedOrder != null && shippedOrder.OrderNumber.Equals(parsedOrderNumber)))
            {
                Console.WriteLine("Order number {0} is a duplicate.", parsedOrderNumber);
                return InputOrderNumber();
            }

            return parsedOrderNumber;
        }

        private static string InputCustomerName()
        {
            Console.Write("Enter customer name: ");
            var customerName = Console.ReadLine();
            if (customerName == null || string.IsNullOrEmpty(customerName.Trim()))
            {
                Console.WriteLine("Customer name may not be blank.");
                return InputCustomerName();
            }

            return customerName;
        }

        private static int InputQuantity()
        {
            Console.Write("Enter quantity: ");
            return InputNumber();
        }

        private static int InputNumber()
        {
            int parsedInput;
            var input = Console.ReadLine();
            if (!int.TryParse(input, out parsedInput))
            {
                Console.WriteLine("Enter a valid number.");
                return InputNumber();
            }

            return parsedInput;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:16:41.853

> 当我比较它时，我的 check[y] 数组不包含任何值。如何让这个数组包含之前输入的订单号

如果你想`check[]`包含订单号，它需要是订单号的类型（`int`在这种情况下是一个）。因此，每当您向 中添加新订单时`orderArray`，也将其编号添加到`check`数组中。然后，您可以针对较早的数字进行测试。

如果这不能解决您的问题，请添加一个后续问题作为评论，告诉我们您尝试了什么，我们可以从那里开始。

# shell - sh 和 ksh 之间的不同管道行为

> ID：16069339
> 
> 赞同：1
> 
> 时间：2013-04-17T20:10:52.990
> 
> 标签：shell, scripting, sh, ksh, pipeline

我已将问题隔离到以下代码段：

1.  请注意，`LATEST_FILE_NAME=''`当使用`ksh`;运行脚本时，会分配空字符串。但是脚本`$LATEST_FILE_NAME`在使用`sh`. 这反过来会影响 的值`$FILE_LIST_COUNT`。
2.  但由于脚本在 KornShell (ksh) 中，我不确定是什么导致了这个问题。
3.  当我在下面的行中注释掉`tee`命令时，ksh 脚本工作正常并正确地将值分配给 variable `$LATEST_FILE_NAME`。

```
(cd $SOURCE_FILE_PATH; ls *.txt 2>/dev/null) | sort -r > ${SOURCE_FILE_PATH}/${FILE_LIST} | tee -a $LOG_FILE_PATH
```

* * *

请考虑：

**1\. 源码：script.sh**

```
#!/usr/bin/ksh
set -vx # Enable debugging

SCRIPTLOGSDIR=/some/path/Scripts/TEST/shell_issue
SOURCE_FILE_PATH=/some/path/Scripts/TEST/shell_issue
# Log file
Timestamp=`date +%Y%m%d%H%M`
LOG_FILENAME="TEST_LOGS_${Timestamp}.log"
LOG_FILE_PATH="${SCRIPTLOGSDIR}/${LOG_FILENAME}"
## Temporary files
FILE_LIST=FILE_LIST.temp    #Will store all  extract filenames
FILE_LIST_COUNT=0           # Stores total number of  files

getFileListDetails(){
    rm -f $SOURCE_FILE_PATH/$FILE_LIST 2>&1 | tee -a $LOG_FILE_PATH

    # Get list of all files, Sort in reverse order, and store names of the  files line-wise. If no files are found, error is muted.
    (cd $SOURCE_FILE_PATH; ls *.txt 2>/dev/null) | sort -r > ${SOURCE_FILE_PATH}/${FILE_LIST} | tee -a $LOG_FILE_PATH

    if [[ ! -f $SOURCE_FILE_PATH/$FILE_LIST ]]; then
        echo "FATAL ERROR - Could not create a temp file for  file list.";exit 1;
    fi

    LATEST_FILE_NAME="$(cd $SOURCE_FILE_PATH; head -1 $FILE_LIST)";
    FILE_LIST_COUNT="$(cat $SOURCE_FILE_PATH/$FILE_LIST | wc -l)";

}

getFileListDetails;
exit 0; 
```

* * *

**2.使用shell时的输出** `sh script.sh`：

```
+ getFileListDetails
+ rm -f /some/path/Scripts/TEST/shell_issue/FILE_LIST.temp
+ tee -a /some/path/Scripts/TEST/shell_issue/TEST_LOGS_201304300506.log
+ cd /some/path/Scripts/TEST/shell_issue
+ sort -r
+ tee -a /some/path/Scripts/TEST/shell_issue/TEST_LOGS_201304300506.log
+ ls 1.txt 2.txt 3.txt
+ [[ ! -f /some/path/Scripts/TEST/shell_issue/FILE_LIST.temp ]]
cd $SOURCE_FILE_PATH; head -1 $FILE_LIST
++ cd /some/path/Scripts/TEST/shell_issue
++ head -1 FILE_LIST.temp
+ LATEST_FILE_NAME=3.txt
cat $SOURCE_FILE_PATH/$FILE_LIST | wc -l
++ cat /some/path/Scripts/TEST/shell_issue/FILE_LIST.temp
++ wc -l
+ FILE_LIST_COUNT=3
exit 0;
+ exit 0 
```

* * *

**3\. 使用 ksh 时的输出** `ksh script.sh`：

```
+ getFileListDetails
+ tee -a /some/path/Scripts/TEST/shell_issue/TEST_LOGS_201304300507.log
+ rm -f /some/path/Scripts/TEST/shell_issue/FILE_LIST.temp
+ 2>& 1
+ tee -a /some/path/Scripts/TEST/shell_issue/TEST_LOGS_201304300507.log
+ sort -r
+ 1> /some/path/Scripts/TEST/shell_issue/FILE_LIST.temp
+ cd /some/path/Scripts/TEST/shell_issue
+ ls 1.txt 2.txt 3.txt
+ 2> /dev/null
+ [[ ! -f /some/path/Scripts/TEST/shell_issue/FILE_LIST.temp ]]
+ cd /some/path/Scripts/TEST/shell_issue
+ head -1 FILE_LIST.temp
+ LATEST_FILE_NAME=''
+ wc -l
+ cat /some/path/Scripts/TEST/shell_issue/FILE_LIST.temp
+ FILE_LIST_COUNT=0
exit 0;+ exit 0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-01T17:11:55.997

好的，这里……这是一个棘手而微妙的问题。答案在于管道是如何实现的。[POSIX](http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html#tag_02_09_02)指出

> 如果管道不在后台（参见异步列表），shell 将等待管道中指定的最后一个命令完成，也可能等待所有命令完成。）

注意关键字*may*。*许多 shell 以所有*命令都需要完成的方式实现这一点，例如，参见[bash](/questions/tagged/bash "显示标记为“bash”的问题")手册页：

> shell 在返回值之前等待管道中的所有命令终止。

[请注意ksh](/questions/tagged/ksh "显示标记为“ksh”的问题")联机帮助页中的措辞：

> 每个命令（可能是最后一个命令除外）都作为单独的进程运行；shell 等待最后一个命令终止。

在您的示例中，最后一个命令是`tee`命令。`tee`由于您之前在命令中重定向`stdout`到没有输入`${SOURCE_FILE_PATH}/${FILE_LIST}`，因此它立即退出。过于简单地说，这`tee`比之前的重定向更快，这意味着您的文件可能在您读取文件时还没有完成写入。`sleep`您可以通过在整个命令的末尾添加 a 来测试它（这不是修复！） ：

```
$ ksh -c 'ls /tmp/* | sort -r > /tmp/foo.txt | tee /tmp/bar.txt; echo "[$(head -n 1 /tmp/foo.txt)]"'
[]

$ ksh -c 'ls /tmp/* | sort -r > /tmp/foo.txt | tee /tmp/bar.txt; sleep 0.1; echo "[$(head -n 1 /tmp/foo.txt)]"'
[/tmp/sess_vo93c7h7jp2a49tvmo7lbn6r63]

$ bash -c 'ls /tmp/* | sort -r > /tmp/foo.txt | tee /tmp/bar.txt; echo "[$(head -n 1 /tmp/foo.txt)]"'
[/tmp/sess_vo93c7h7jp2a49tvmo7lbn6r63] 
```

话虽如此，这里还有一些其他的事情需要考虑：

1.  始终引用您的变量，尤其是在处理文件时，以避免出现通配、分词（如果您的路径包含空格）等问题：

    `do_something "${this_is_my_file}"`

2.  `head -1`已弃用，使用`head -n 1`

3.  如果一行只有一个命令，则结尾的分号`;`是多余的……跳过它

4.  `LATEST_FILE_NAME="$(cd $SOURCE_FILE_PATH; head -1 $FILE_LIST)"`

    无需先`cd`进入目录，只需将整个路径指定为参数`head`：

    `LATEST_FILE_NAME="$(head -n 1 "${SOURCE_FILE_PATH}/${FILE_LIST}")"`

5.  `FILE_LIST_COUNT="$(cat $SOURCE_FILE_PATH/$FILE_LIST | wc -l)"`

    这被称为[Cat](http://partmaps.org/era/unix/award.html)的无用使用，因为`cat`不需要 -`wc`可以处理文件。您可能使用它是因为 的输出`wc -l myfile`包含文件名，但您可以使用 eg`FILE_LIST_COUNT="$(wc -l < "${SOURCE_FILE_PATH}/${FILE_LIST}")"`代替。

此外，您还需要阅读[为什么不应该解析 ls(1) 的输出](http://mywiki.wooledge.org/ParsingLs)以及[如何从目录中获取最新（或最旧）的文件？](http://mywiki.wooledge.org/BashFAQ/099).

# java - 如何在 Java 上使用 zookeeper 客户端库递归地创建节点？

> ID：16069340
> 
> 赞同：0
> 
> 时间：2013-04-17T20:10:57.587
> 
> 标签：java, recursion, hadoop, apache-zookeeper

我知道已经为使用 python 的动物园管理员提出并回答了这个问题。答案很好，但是，我想要一些与代码更相关的东西。我已经实现了一个创建节点的方法，但我想递归地做。我的节点的结构将是这样的：

动物园管理员

*   网络服务器
    *   服务器1
    *   服务器2
*   模块连接
    *   数据库模块
        *   电脑1
        *   电脑2
    *   服务模块
        *   电脑3
    *   搜索模块
        *   电脑4

我有类似的东西：

```
Zookeeper zk = new Zookeeper(...);

public void createNodeRecursively(String type) {
    final String node = "/" + type + "/" + info.getIP() + ":" + info.getPort(); // Correct line
    if (zk.exists("/" + type, null) == null) {
        Object ctx = new Object();
        StringCallback cb = new StringCallback() {
            public void processResult(int rc, String path,
                                Object ctx, String name) {
                if (name.equals("/" + type))// just in case
                    try {
                        zk.create(node, info.getBytes(),
                            Ids.OPEN_ACL_UNSAFE,CreateMode.EPHEMERAL);
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
            }
        };
        zk.create("/" + type, info.getBytes(), Ids.OPEN_ACL_UNSAFE,
                            CreateMode.PERSISTENT, cb, ctx);

    } else
        zk.create(node, info.getBytes(), Ids.OPEN_ACL_UNSAFE,
                            CreateMode.EPHEMERAL);
    } 
} 
```

如您所见，我多次使用 zk.create，所以我想让该方法递归以获得性能并获得更好的代码，但我不知道如何开始，如果有人我将非常感激可以帮我解决这个问题。非常感谢您提前。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T18:13:14.947

我设法取得了更好的表现：

```
public void createNode(NodePath nodePath, NodeData nodeData, NodeRights nodeRights, NodeCreationHandler nodeCreationHandler) throws KeeperException, InterruptedException, ZookeeperCreationException {

        if (zk == null) {
            throw new ZookeeperCreationException("The zookeeper client has not been instanced.");
        }       
        String targetPath = nodePath.getFullNodePath();
        targetPath = targetPath.substring(1, targetPath.length());
        byte[] serializedData = nodeData.serialize(new Object());
        String[] array = targetPath.split(ICoordinationConstants.BASE_ROOT_SPTR);
        String acum="";
        for (int i = 0; i < array.length-1; i++) {
            acum+=(ICoordinationConstants.BASE_ROOT_SPTR+array[i]);
            if (zk.exists(acum, null) == null) {
                zk.create(acum, serializedData, Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);
            }
        }
        zk.create(acum+ICoordinationConstants.BASE_ROOT_SPTR+array[array.length-1], serializedData, Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);             
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T05:57:51.963

Zookeeper 具有有用的属性：

1.  （写入）请求的总顺序
2.  它的异步性质。

你可以用那个。只需以正确的顺序将整个树作为一堆异步请求发出，然后等待，直到所有请求都成功执行。当然，您可以忽略“NodeExists”异常（但这并不好，因为这样的错误将被写入日志）。

# c# - 使用 OAuth 使用 Twitters 1.1 API，没有得到响应，并且立即发生

> ID：16069341
> 
> 赞同：0
> 
> 时间：2013-04-17T20:11:02.723
> 
> 标签：c#, asp.net, oauth, httpwebrequest, twitter-oauth

我正在尝试将我的网站换成使用 OAuth 1.0a 来使用新的 Twitter 1.1 API。我能够使用 REST 客户端获得正确的响应，现在我正在尝试使用 c# 在我的网站上复制它。

我已经以适当的方式构建了我的标题，并且我已经验证了它们的格式是否适合 Twitter 正在寻找的内容。

我遇到的问题是我认为我实际上并没有发送请求。我这样说是因为我的应用程序几乎立即返回。该请求至少需要一秒钟左右的时间才能发送，而我的响应完全是空的，没有 401 或 400 状态代码。

下面我有实际发送请求的代码。我实际上是在发送请求，如果是这样，为什么我没有收到任何状态代码或任何东西。

在此先感谢您的帮助。

```
//string url = "https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=MYSCREENNAME&count=2";
string url = "https://api.twitter.com/1.1/statuses/user_timeline.json";

HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(url);
webRequest.Method = "GET";
webRequest.Headers.Add("Authorization", authorizationHeaderParams);

try {
    var response = webRequest.GetResponse() as HttpWebResponse;
    if (response != null && response.StatusCode != HttpStatusCode.OK) {
        lblresponse.InnerText = "The request did not complete and returned status code: {0} " + response.StatusCode;
    }
    if (response != null) {
        var reader = new StreamReader(response.GetResponseStream());
        reader.ReadToEnd();
        lblresponse.InnerText += "success";
    }
} catch {
    lblresponse.InnerText += "fail";
} 
```

所以是的，这段代码直接进入了 catch 块。我的想法是我实际上并没有发送请求，因为它不需要时间发生。我知道有一些库旨在使这更容易，但我更愿意自己学习如何做（在你们的帮助下）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:21:14.753

在 400 或 401 的情况下，请求将引发异常。因此在 catch 块中捕获 System.Web.Exception 以查看是否存在 400 或 401。

```
catch(System.Web.Exception ex) {
   var errorReponse = (HttpWebResponse)ex.Response;
   var statusCode = errorReponse.StatusCode;
   lblresponse.InnerText += "fail";
} 
```

# c#-4.0 - GroupPrincipal 抛出“System.Runtime.InteropServices.COMException (0x8007200A)：指定的目录服务属性或值不存在。”

> ID：16069342
> 
> 赞同：4
> 
> 时间：2013-04-17T20:11:03.013
> 
> 标签：c#-4.0, active-directory, account-management, groupprincipal

我`System.DirectoryServices.AccountManagement`用来查询用户，然后找到该用户的组。

```
var _principalContext = new PrincipalContext(ContextType.Domain, domainAddress, adContainer, adQueryAccount, adQueryAccountPassword);
var user = UserPrincipal.FindByIdentity(_principalContext, IdentityType.SamAccountName, account);
var userGroups = user.GetGroups(); 

foreach (var group in userGroups.Cast<GroupPrincipal>())
{
    //////////////////////////////////////////////////////
    // getting the underlying DirectoryEntry shown
    // to demonstrate that I can retrieve the underlying
    // properties without the exception being thrown
    DirectoryEntry directoryEntry = group.GetUnderlyingObject() as DirectoryEntry;

    var displayName = directoryEntry.Properties["displayName"];

    if (displayName != null && displayName.Value != null)
        Console.WriteLine(displayName.Value);
    //////////////////////////////////////////////////////

    Console.WriteLine(group.DisplayName);// exception thrown here...
} 
```

我可以抓取底层`DirectoryEntry`对象并转储其属性和值，但是一旦`GroupPrincipal.DisplayName`访问该属性（或与此相关的任何属性），它就会引发以下异常：

> "System.Runtime.InteropServices.COMException (0x8007200A)：指定的目录服务属性或值不存在。\r\n\r\n 在 System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)\r\n 在 System。 DirectoryServices.DirectoryEntry.Bind()\r\n 在 System.DirectoryServices.DirectoryEntry.get_SchemaEntry()\r\n 在 System.DirectoryServices.AccountManagement.ADStoreCtx.IsContainer(DirectoryEntry de)\r\n 在 System.DirectoryServices.AccountManagement。 ADStoreCtx..ctor(DirectoryEntry ctxBase, Boolean ownCtxBase, String username, String password, ContextOptions options)\r\n 在 System.DirectoryServices.AccountManagement.PrincipalContext.CreateContextFromDirectoryEntry(DirectoryEntry entry)\r\n 在 System.DirectoryServices.AccountManagement.PrincipalContext .DoLDAPDirectoryInitNoContainer()\r\n 在 System.DirectoryServices.AccountManagement.PrincipalContext.DoDomainInit()\r\n 在 System.DirectoryServices.AccountManagement.PrincipalContext.Initialize()\r\n 在 System.DirectoryServices.Account Management.PrincipalContext.get_QueryCtx ()\r\n 在 System.DirectoryServices.AccountManagement.Principal.HandleGet[T](T& currentValue, String name, LoadState& state)\r\n 在 System.DirectoryServices.AccountManagement.Principal.get_DisplayName()\r\n 在ConsoleApplication9.Program.Main(String[] args)"AccountManagement.Principal.HandleGet[T](T& currentValue, String name, LoadState& state)\r\n 在 System.DirectoryServices.AccountManagement.Principal.get_DisplayName()\r\n 在 ConsoleApplication9.Program.Main(String[] args) "AccountManagement.Principal.HandleGet[T](T& currentValue, String name, LoadState& state)\r\n 在 System.DirectoryServices.AccountManagement.Principal.get_DisplayName()\r\n 在 ConsoleApplication9.Program.Main(String[] args) "

为什么我可以转储底层的原始属性，`DirectoryEntry`但不能直接调用任何属性`GroupPrincipal`？什么会导致这个异常？请注意，这不会发生在“域用户”组上，而是发生在后续组上，它确实......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T21:10:38.040

我找到了解决方案。如果我将上下文传递给该`GetGroups`方法，它就可以工作。

```
var user = UserPrincipal.FindByIdentity(_principalContext, IdentityType.SamAccountName, account);
var userGroups = user.GetGroups(_principalContext); 
```

显然，这将检索到的组限制为与上下文关联的域。虽然这并不直观，因为上下文首先用于检索用户！！！

这使我相信之前必须返回来自其他域的组，并且权限本身就是为了防止访问该信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:25:55.967

你为什么用这个`.GetUnderlyingObject()`电话？似乎完全是多余的......只需使用直接的`.SamAccountName`属性`GroupPrincipal`......

尝试这个：

```
foreach (var group in userGroups.Cast<GroupPrincipal>())
{
    Console.WriteLine(group.SamAccountName);
    Console.WriteLine(group.DisplayName);
    Console.WriteLine(group.IsSecurityGroup);
} 
```

似乎**容易多了**——不是吗？

# memory-management - UIView 层 renderInContext 内存没有被释放

> ID：16069343
> 
> 赞同：4
> 
> 时间：2013-04-17T20:11:04.100
> 
> 标签：memory-management, crash, pdf-generation, automatic-ref-counting, calayer

我们正在尝试使用 UIView.layer 的 renderInContext 方法创建多个 pdf 文件

下面的代码在自动释放池中运行。

```
---loop

    UIGraphicsBeginPDFContextToFile(documentDirectoryFilename, CGRectZero, nil);

    UIGraphicsBeginPDFPage();

    CGContextRef pdfContext = UIGraphicsGetCurrentContext();

    [view.layer renderInContext:pdfContext];

    view =nil;

    pdfContext =nil
    UIGraphicsEndPDFContext()

--loop ends 
```

经过几次迭代后，驻留内存增加到 20 mb，随后的迭代增加了使用的总内存。

有些 ARC 没有释放用于渲染 pdf 的内存，因此应用程序因内存不足而崩溃。

应用程序正在使用 ARC

任何解决该问题的帮助或指示将不胜感激。

谢谢

更新：感谢您的快速回复。

对于伪代码中的拼写错误，我深表歉意。这是来自测试项目的示例代码。

```
 -(BOOL)addUIViewToPDFFile:(UIView*)view newBounds:(CGRect)newBounds pdfFile:(NSString*)pdfFile{
BOOL retFlag =YES;

    NSArray* documentDirectories = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask,YES);

    NSString* documentDirectory = [documentDirectories objectAtIndex:0];
    NSString* documentDirectoryFilename = [documentDirectory stringByAppendingPathComponent:pdfFile];
    UIGraphicsBeginPDFContextToFile(documentDirectoryFilename, CGRectZero, nil);
   CGContextRef pdfContext = UIGraphicsGetCurrentContext();
    if([NSThread isMainThread]){
        NSLog(@"Main Thread");
    }else{
        NSLog(@"Not in Main Thread");

    }
    UIGraphicsBeginPDFPage();
    logMemUsage1();
    [view.layer renderInContext:pdfContext];
    UIGraphicsEndPDFContext();
    pdfContext = nil;
    logMemUsage1();

return retFlag;

 }

  - (IBAction)createPdf:(id)sender {
    for(int i=0;i<10;i++){

     @autoreleasepool {
    PDFViewController *vc = [[PDFViewController alloc] init];
    [vc loadView];
    NSString *PdfFileName =[ NSString stringWithFormat:@"TestPdf%d.pdf",i ];
    [self addUIViewToPDFFile:vc.view newBounds:self.view.frame pdfFile:PdfFileName];
    vc = nil;

  } 
```

} }

还有一点要补充的是，当应用程序在按下硬件主页按钮时进入后台并再次返回前台时，内存似乎被清除和释放。

我期望在每次迭代之后，应该释放用于创建 pdf 的内存。

# sql-server - 如何在 SQL Server 2005 中存储日历应用程序数据

> ID：16069345
> 
> 赞同：1
> 
> 时间：2013-04-17T20:11:06.160
> 
> 标签：sql-server, sql-server-2005, calendar, indexing

我正在创建一个在线日历应用程序（如 Google 日历或 MS Outlook），**但不确定我应该如何存储数据**以快速查询基本视图：每日、每周、每月。

在将其标记为重复之前，请记住我已经阅读了这里的几个主题，并且在大多数情况下，他们说“太难优化一般用途”。就我而言，这是一个非常具体的目的，我还没有看到有人问过它——一种非常具体的数据类型，许多开发人员[希望]都有过使用经验。

我需要快速获取任何出现在我的视图中的行（日、周、月），例如：

```
[end date of row] >= [start date of query]
AND
[start date of row] <= [end date of query] 
```

我没有看到一个正常的 b-tree 索引可以很好地解决这个问题，但我也怀疑有人想出了一些可以与 SQL Server 2005（可能更旧）一起使用的聪明方法，因为日历应用程序一直存在，并且有100个。

我也对重复发生的事件以及如何存储这些事件感到好奇，尽管我目前的计划是始终读取所有这些事件（按“Is Recurring”索引）并在代码中优化它，而不是 SQL。与随着时间的推移可能会变得非常大的正常事件不同，这些事件不应该有很多。

**更新**：这个问题也是独一无二的，因为它是一个日历应用程序，我需要存储带有时区信息的日期，但我的查询不能是特定于时区的。如果您有使用日历应用程序的经验，您就会明白我的意思（如果没有，您只会说存储为 UTC）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:50:18.333

不久前，我不得不处理与此类似的事情。它是急诊室软件，我们必须进行大量的日期范围和班次计算，并且不能让时区问题影响我们。我们最终要做的是为每个日期存储 6 列。一组三列（日期，日期为 int，时间为 int）一次作为输入，一次作为 UTC。所有计算均使用 UTC 完成，以避免时区问题。如果需要，您还可以添加时区列。

```
Date as datetime -- in the time zone entered - Used for display
UDate as a datetime -- The UTC version of the date.
            -- Used for display and some calculations
IntDate as int -- Date as an int YYYYMMDD so 20130417
IntUDate as int -- UTC date as an int.   
IntTime as int -- Time as an int HHMMSS.  
              -- So for 1:12:40 PM it would be 131240 and for 1:12:40 AM 
              -- it would be 11240\.  Note only 5 places.
              -- May need to be decimal if you need more precision)
IntUTime as int -- Sames as IntTime but for the UTC datetime 
```

您可能不需要时间列。我们这样做是因为班次计算。根据需要在列上创建索引。至少 IntDate 和 IntUDate 列。因为这些是整数，所以索引会非常快。请注意，所有计算都应使用 UTC 列来完成，以避免时区问题。显示通常使用日期列完成。

接下来创建一个日期表。这里你必须意识到，这张表相当窄，你可以填写数百年的日期，但仍然没有那么大的表。每 100 年大约 36525 行。添加索引，它再次非常快。

我们的看起来像这样。

```
CREATE TABLE DateTable (
    [Date] Int PRIMARY KEY,
    [DayOfYear] smallint,
    [Month] tinyint,
    [Quarter] tinyint,
    [Year] smallint,
    [LeapYear] bit,
    [DaylightSavings] bit
    ) 
```

在（Year，DayOfYear），（Year，Month，Day）等上有索引。无论您需要什么。您也可以添加您需要的任何其他列。比如说闰年、假期、每月的第一天、每月的最后一天等。

如果您需要说出给定年份/季度的所有内容，您可以在日期表上添加一个联接，并且所有内容都被很好地编入索引。

使用上面的示例，您可以执行以下操作：

```
SELECT *
FROM MyTable
WHERE EXISTS
    (SELECT 1 FROM DateTable
    WHERE DateTable.[Date] BETWEEN MyTable.UTCStartDate AND MyTable.UTCEndDate
    AND DateTable.[Date] BETWEEN @StartDate AND @EndDate) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T21:16:45.123

因为我认为时区问题对日历应用程序很重要，并且一些现有的应用程序不能很好地处理这个问题（甚至是 Outlook，2007 年之前），所以我将此信息添加为答案，并作为先前评论的后续行动。

我希望 Google 开发人员也能阅读这篇文章，因为基于[http://support.google.com/calendar/answer/2367918?hl=en](http://support.google.com/calendar/answer/2367918?hl=en)，他们似乎也有“转移”问题。这是他们所说的，这对我来说似乎是错误的/不可接受的：

> 但是，如果一个国家/地区决定在切换到 DST 甚至整个时区时进行更改，则此过程并不总是有效。如果您在我们知道更改之前创建了活动，日历会使用创建时可用的信息将您的时区转换为 UTC。知道时区更改后，日历将使用新规则在您的时区显示事件，这**可能会导致事件在您的日历中发生变化**。

粗体字的最后一部分是不应该发生的事情。如果我将会议设置为太平洋标准时间上午 8 点，它将在太平洋标准时间上午 8 点举行，它不会仅仅因为某些时区规则发生变化而“转移”。

在日历应用程序中，如果用户输入“2020 年 4 月 26 日下午 12:00，亚利桑那时间”的事件。如果您将其转换为 UTC 进行存储，就像大多数应用程序一样，您将把它保存为（使用我输入 ths 时的规则）“2020 年 4 月 26 日，下午 7:00，UTC”。

然后，如果您想查询“2020 年 4 月 26 日下午 12:00，亚利桑那时间”是否有任何事件发生，您将查询“2020 年 4 月 26 日，下午 7:00，UTC”，因为那是当前的转换规则告诉你要做的。

起初你会找到这个项目，正确的，是的。

现在，如果时区规则发生变化，比如说在 2018 年，亚利桑那州变为 -0800 UTC 而不是 -0700 UTC（也许他们决定支持 DST，谁知道呢）。然后您再次进行查询，查找在“2020 年 4 月 26 日下午 12:00，亚利桑那时间”发生的任何事件。这一次，当您进行查询时，您将寻找“2020 年 4 月 26 日，晚上 8:00，UTC”。这是因为您在进行查询时只知道使用当前规则，而您不知道某些数据在保存时使用了旧规则。 **因此，即使您应该找到该项目，您也找不到该项目，并且用户错过了该事件。**

现在，您决定显示该项目的方式因应用程序而异，但对于日历/日程安排应用程序，它永远不应更改用户输入的时间。当用户查看它时，它仍应显示为“2020 年 4 月 26 日，下午 12:00，亚利桑那时间”。但是，由于规则更改，您用于查询的 UTC 值与该时间不匹配。

一个好的日历应用程序应该处理这个问题的方式（从我经过大量研究后了解到的）是：

1.  存储用户每次输入的以下信息：

时区（在 Windows 中，我使用 Windows 时区 ID，但这可以来自其他来源，只要它是唯一的并且是您用来进行转换的）。

用户输入的日期和时间

使用用户输入信息时的规则将日期和时间转换为 UTC（问题区域）

1.  每当时区规则发生变化时，请确保您的转换代码已更新（即 Windows 更新、库更新等），并且**在同一更新过程中**，使用新规则更新数据库中的所有 UTC 时间。

“更新”过程是这样的：

1.  查询更改时区的所有记录。如果需要，可以过滤在规则更改之后具有日期的记录，因为之前的任何记录都没有更改（这将基于用户输入的日期，而不是 UTC 值）。

2.  对于这些记录中的每一个（如果您没有精确过滤，或者即使您只是对每个时区的数据库中的每条记录进行盲目操作，也没有关系）...运行您在记录时执行的相同转换代码最后添加/编辑，只需获取用户输入的值并使用当前规则将其转换为 UTC，然后保存新的 UTC 值。

需要这种混乱的**证据**是结果将是您的某些 UTC 值**已**更改，并且用户输入的值都没有更改（因为我们不能允许这样做，这对于日历应用程序来说是愚蠢的，除非事件时间基于 UTC，在这种情况下，用户应该在添加时区时将时区设置为 UTC）。

想想如果您不执行此更新过程会发生什么。您基于 UTC 所做的所有查询都不正确。他们怎么可能不是？

# actionscript-3 - 为什么这个 TLFTextField 代码只工作一次？

> ID：16069348
> 
> 赞同：2
> 
> 时间：2013-04-17T20:11:14.083
> 
> 标签：actionscript-3, flash, apache-flex, text, actionscript

当用户更改它时，我需要修改输入 TLF 文本字段中的文本。例如，每次用户添加或删除字符时，我都会尝试将其设为大写：

```
import fl.text.TLFTextField;
import flashx.textLayout.formats.TextLayoutFormat;
import flashx.textLayout.elements.TextFlow;

var myTLFTextField:TLFTextField = new TLFTextField();
addChild(myTLFTextField); 
myTLFTextField.x = 10;
myTLFTextField.y = 10;
myTLFTextField.width = 200
myTLFTextField.height = 100;
myTLFTextField.text = "This is my text";

var myFormat:TextLayoutFormat = new TextLayoutFormat();
myFormat.textIndent = 8;
myFormat.color = 0x336633;
myFormat.fontFamily = "Arial, Helvetica, _sans";
myFormat.fontSize = 24;

var myTextFlow:TextFlow = myTLFTextField.textFlow;
myTextFlow.hostFormat = myFormat;
myTextFlow.flowComposer.updateAllControllers();

//--

myTLFTextField.addEventListener(Event.CHANGE, this.onTextFieldChange);
function onTextFieldChange(event:Event):void
{
    myTLFTextField.text = myTLFTextField.text.toUpperCase();
} 
```

前面的代码`//--`取自[TLFTextField 文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/text/TLFTextField.html)，这是页面上的第一个示例。

当我尝试编辑文本时，它确实变成了大写，但之后文本字段停止响应任何输入并且输出显示

> TypeError：错误 #1009：无法访问空对象引用的属性或方法。在 flashx.textLayout.container::TextContainerManager/getController() 在 flashx.textLayout.container::TextContainerManager/mouseDownHandler()

当我注释掉该`addEventListener`行时，一切似乎都工作正常。

这是否意味着无法像经典文本字段那样在用户输入事件上更改 TLF 文本字段中的文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T03:11:31.290

为什么？因为TLF有问题。正如其他人指出的那样，在 Event.CHANGE 处理程序中更改 TLF 文本会导致再次调用更改处理程序。到那时，事情就崩溃了。

我想出了一个类似于@Abe 发布的解决方案，但它更通用——它不依赖于检查大写字符。您侦听 TextEvent.TEXT_INPUT，然后在文本输入处理程序内切换 Event.CHANGE 侦听器。

```
import fl.text.TLFTextField;
import flashx.textLayout.formats.TextLayoutFormat;
import flashx.textLayout.elements.TextFlow;
import flash.text.TextFieldType;
import flash.events.TextEvent;

var myTLFTextField:TLFTextField = new TLFTextField();
addChild(myTLFTextField); 
myTLFTextField.x = 10;
myTLFTextField.y = 10;
myTLFTextField.width = 500
myTLFTextField.height = 100;
myTLFTextField.text = "This is my text";
myTLFTextField.border = true;
myTLFTextField.multiline = true;
myTLFTextField.type = TextFieldType.INPUT;

var myFormat:TextLayoutFormat = new TextLayoutFormat();
myFormat.textIndent = 8;
myFormat.color = 0x336633;
myFormat.fontFamily = "Arial, Helvetica, _sans";
myFormat.fontSize = 24;

var myTextFlow:TextFlow = myTLFTextField.textFlow;
myTextFlow.hostFormat = myFormat;
myTextFlow.flowComposer.updateAllControllers();

myTLFTextField.addEventListener(TextEvent.TEXT_INPUT, onTextInput);

var selectionIndex:uint;
function onTextInput(e:TextEvent):void
{
    trace("onTextInput");
    selectionIndex = myTLFTextField.selectionEndIndex;
    myTLFTextField.addEventListener(Event.CHANGE, onTextChanged);
}

function onTextChanged(e:Event):void
{
    trace("onTextChanged");
    myTLFTextField.removeEventListener(Event.CHANGE, onTextChanged);

    // Do whatever you need to do here:
    myTLFTextField.text = myTLFTextField.text.toUpperCase();
    myTLFTextField.setSelection(selectionIndex + 1, selectionIndex + 1);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T12:30:10.300

现在无法尝试您的代码，所以这是一个疯狂的猜测，但是当您设置文本时，控制器似乎消失了。如果您愿意这样做会发生什么：

```
private var m_dontupdate:Boolean;
function onTextFieldChange(event:Event):void
{
  if(m_dontupdate) return;
  m_dontupdate = true;
  myTLFTextField.text = myTLFTextField.text.toUpperCase();
  myTLFTextField.textFlow.flowComposer.updateAllControllers();
  m_dontupdate = false;
} 
```

? （我无法尝试，因为我使用 FB 4.7 并且找不到 TLFTextField）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-22T23:55:35.523

首先-您在事件侦听器中进行无限循环！您在事件处理程序中的代码会自行调用它！TLF.text = VALUE 产生事件，如 TLF.dispatch(new Event(Event.CHANGE));

因此，**将事件侦听器添加到用户操作而不是文本更改！**例如对于 KEY_UP

第二 - 正确的格式代码，以便将其应用于新文本：

```
myTLFTextField.text = NEW_VALUE;

myTextFlow = myTLFTextField.textFlow;
myTextFlow.hostFormat = myFormat; 
```

编辑：为了更清楚，我添加了完整的代码：

```
import fl.text.TLFTextField;
import flashx.textLayout.formats.TextLayoutFormat;
import flashx.textLayout.elements.TextFlow;
import flash.events.KeyboardEvent;

var myTLFTextField:TLFTextField = new TLFTextField();
addChild(myTLFTextField);
myTLFTextField.x = 10;
myTLFTextField.y = 10;
myTLFTextField.width = 400;
myTLFTextField.height = 100;
myTLFTextField.text = "This is my text";
myTLFTextField.type = "input";
//allow user to wirte in filed

var myFormat:TextLayoutFormat = new TextLayoutFormat();
myFormat.textIndent = 8;
myFormat.color = 0x336633;
myFormat.fontFamily = "Arial, Helvetica, _sans";
myFormat.fontSize = 24;

var myTextFlow:TextFlow = myTLFTextField.textFlow;
myTextFlow.hostFormat = myFormat;
myTextFlow.flowComposer.updateAllControllers();

//--;

myTLFTextField.addEventListener(Event.CHANGE, wrongHandler);
myTLFTextField.addEventListener(KeyboardEvent.KEY_UP, goodHandler);
myTLFTextField.text = 'TEXT';
//this invoke CHANGE and trace '-' in console

setTimeout(function(){  myTLFTextField.text = 'text';}, 500);
//this invoke CHANGE and trace '-' in console

function wrongHandler(event:Event):void
{
    //myTLFTextField.text = myTLFTextField.text.toUpperCase();
    //myTextFlow = myTLFTextField.textFlow;
    //myTextFlow.hostFormat = myFormat;
    // above code will run infinity loop of changing text! test it by uncomment and comment KEY_UP listener!
    trace('-'); // to see in console when and how many event was triggered
}

function goodHandler(event:Event):void
{
    myTLFTextField.text = myTLFTextField.text.toUpperCase();
    myTextFlow = myTLFTextField.textFlow; // reasign formating
    myTextFlow.hostFormat = myFormat;
    var i:uint = myTLFTextField.text.length;
    myTLFTextField.setSelection(i,i); // move carret to last sign
    trace('+'); // to see in console when and how many event was triggered
} 
```

输出：

1.  -
2.  -

在字段中写入“a”字符后的输出：

1.  -
2.  -
3.  -
4.  -
5.  +
6.  -

舞台成绩：TEXTA

# mvel - MVEL：如何将 java.lang.* 类排除在表达式之外？

> ID：16069350
> 
> 赞同：5
> 
> 时间：2013-04-17T20:11:17.913
> 
> 标签：mvel

我正在尝试沙箱 MVEL 表达式评估。不幸的是，默认情况下，MVEL 包含表达式语言中的所有 java.lang.* 类，因此用户可以调用“Runtime.exit()”并杀死整个系统。

如何排除我没有使用 addImport() 显式添加的所有类？

我无法确定变量解析器的正面或反面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:46:14.913

据我所知，这是不支持的。

不久前，我在公司的一个项目中遇到了这种需求。我们不得不对 MVEL 进行相当大的更改，以引入一种配置自定义策略来控制对类型和方法的访问的方法。问题是您还可以通过其完全限定名称访问任何类，因此这不仅仅是删除默认导入的问题。不幸的是，我不拥有使其可用的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-11T15:01:49.730

```
ParserContext ctx = new ParserContext();

ctx.addImport("System", String.class);
ctx.addImport("Runtime", String.class); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T14:21:46.560

您是否尝试过使用 AspectJ 来限制来自 MVEL 的这些调用？

# c++ - 如何使用 Visual Studio 编写单个头文件？

> ID：16069356
> 
> 赞同：0
> 
> 时间：2013-04-17T20:11:30.147
> 
> 标签：c++, visual-studio

我正在使用 Visual Studio 2010 以及每个头文件和源文件（与类同名）有一个类的常见模式。

现在我想编写一个包含所有/一些头文件的单个头文件，其中包含基于内部依赖关系的顺序，即如果 A 依赖于 B（即，如果“Ah ”包括“Bh”）。

有没有内置的工具呢？这通常是怎么做的？

# iphone - UICollectionView 不滚动

> ID：16069357
> 
> 赞同：57
> 
> 时间：2013-04-17T20:11:35.290
> 
> 标签：iphone, ios, uicollectionview

我有一个`UICollectionView`设置`UICollectionViewDataSource`，目前提供六个项目。这些比填满屏幕所需的要少。问题是我的收藏视图只有在有足够的项目填满屏幕时才会滚动（用 10、20 进行测试）。当显示较少的项目时，它甚至不会做我想要的反弹动画，它只是固定的。

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(updateCollectionViewData) name:UIDocumentStateChangedNotification object:nil];

    UICollectionViewFlowLayout *flowLayout = [[UICollectionViewFlowLayout alloc]init];
    flowLayout.itemSize = CGSizeMake(160, 100);
    flowLayout.minimumInteritemSpacing = 0;
    flowLayout.minimumLineSpacing = 0;

    self.collectionView = [[UICollectionView alloc]initWithFrame:self.view.bounds collectionViewLayout:flowLayout];
    [self.collectionView registerClass:[UICollectionViewCell class] forCellWithReuseIdentifier:@"Cell"];
    self.collectionView.delegate = self;
    self.collectionView.dataSource = self;
    self.collectionView.bounces = YES;
    [self.view addSubview:self.collectionView];
}

- (NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section {
    return [self.collectionViewData count];
}
- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
     UICollectionViewCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"Cell" forIndexPath:indexPath];

    Expense *expense = [self.collectionViewData objectAtIndex:indexPath.row];

    UILabel *label = [[UILabel alloc]initWithFrame:cell.bounds];
    label.text = expense.value;
    label.backgroundColor = [UIColor clearColor];
    label.font = [UIFont fontWithName:@"Miso-Bold" size:30];
    label.textAlignment = NSTextAlignmentCenter;
    [cell addSubview:label];

    cell.backgroundColor = [UIColor colorWithRed:1 - (indexPath.row / 30.0f) green:0 blue:1 alpha:1];

    return cell;
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2013-06-06T16:16:57.120

`bounces`，尽管它的名字，不是正确的属性设置。您还需要设置`alwaysBounceVertical`和/或`alwaysBounceHorizontal`。从文档中：

> 如果此属性设置为 YES 并且bounces 为YES，则**即使内容小于滚动视图的边界，**也允许垂直拖动。默认值为 NO。

* * *

注意 IB 中令人困惑的名称 .. [https://stackoverflow.com/a/18391029/294884](https://stackoverflow.com/a/18391029/294884)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-12-20T12:11:15.430

对于集合视图的属性检查器中的情节提要，应检查“反弹”和“垂直反弹”。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-17T20:25:44.950

`UICollectionView`设置to 大小的高度`UIView`将使您的滚动问题被禁用。如果它的`UICollectionView`高度为 568 像素，那么只有在其中包含超过 568 像素的内容时才需要滚动。您应该将其设置为它所包含的视图的高度（与宽度相同）。

希望它可以帮助你。

# java - 我的 onUpgrade() 方法应该是什么样子？

> ID：16069358
> 
> 赞同：0
> 
> 时间：2013-04-17T20:11:42.383
> 
> 标签：java, android, sqlite

你可以在下面看到我的数据库助手类。我使用在 assets 文件夹中导入的预填充 sqlite 数据库。每当我将表添加到现有数据库时，如果我的应用程序已安装在手机上，则不会出现此类表错误。我想我的 onUpgrade() 方法现在很好。它有效，不要误会我的意思，当我将一些数据更改为现有表时，我会增加数据库版本并更新它。但是如果我添加一个表，我会得到错误。

```
public class DataBaseHelper extends SQLiteOpenHelper
{
private static String TAG = "DataBaseHelper"; // Tag just for the LogCat window
//destination path (location) of our database on device
private static String DB_PATH = "/data/data/rs.androidaplikacije.themostcompleteiqtest/databases/"; 
private static String DB_NAME ="pitanja.sqlite";// Database name
private static SQLiteDatabase mDataBase; 
private final Context mContext;
private static final int DATABASE_VERSION = 3;

public DataBaseHelper(Context mojContext) 
{
    super(mojContext, DB_NAME, null, 3);// 1 it's Database Version
    DB_PATH = mojContext.getApplicationInfo().dataDir + "/databases/";
    this.mContext = mojContext;
}

public void createDataBase() throws IOException
{
    //If database not exists copy it from the assets

        this.getReadableDatabase();
        this.close();
        try 
        {
            //Copy the database from assests
            copyDataBase();
            Log.e(TAG, "createDatabase database created");
        } 
        catch (IOException mIOException) 
        {
            throw new Error("ErrorCopyingDataBase");
        }
    }

/**
 * Check if the database already exist to avoid re-copying the file each time you open the application.
 * @return true if it exists, false if it doesn't
 */
public boolean checkDataBase(){

SQLiteDatabase checkDB = null;

try{
String myPath = DB_PATH + DB_NAME;
checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);

}catch(SQLiteException e){

//database does't exist yet.

}

if(checkDB != null){

checkDB.close();

}

return checkDB != null ? true : false;
}
    /*Check that the database exists here: /data/data/your package/databases/Da Name
    private boolean checkDataBase()
    {
        File dbFile = new File(DB_PATH + DB_NAME);
        //Log.v("dbFile", dbFile + "   "+ dbFile.exists());
        return dbFile.exists();
    }
    */

    //Copy the database from assets
    private void copyDataBase() throws IOException
    {
        InputStream mInput = mContext.getAssets().open(DB_NAME);
        String outFileName = DB_PATH + DB_NAME;
        OutputStream mOutput = new FileOutputStream(outFileName);
        byte[] mBuffer = new byte[1024];
        int mLength;
        while ((mLength = mInput.read(mBuffer))>0)
        {
            mOutput.write(mBuffer, 0, mLength);
        }
        mOutput.flush();
        mOutput.close();
        mInput.close();
    }

    //Open the database, so we can query it
    public boolean openDataBase() throws SQLException
    {
        String mPath = DB_PATH + DB_NAME;
        //Log.v("mPath", mPath);
        mDataBase = SQLiteDatabase.openDatabase(mPath, null, SQLiteDatabase.CREATE_IF_NECESSARY);
        //mDataBase = SQLiteDatabase.openDatabase(mPath, null, SQLiteDatabase.NO_LOCALIZED_COLLATORS);
        return mDataBase != null;
    }
    @Override
    public void close() 
    {
        if(mDataBase != null)
            mDataBase.close();
        super.close();
    }

    @Override
    public void onCreate(SQLiteDatabase arg0) {
        }

    @Override
    public void onUpgrade(SQLiteDatabase arg0, int arg1, int arg2) {
        try {
            // delete existing?

            // Copy the db from assests
            copyDataBase();
            Log.e(TAG, "database updated");
        } catch (IOException mIOException) {
            Log.e(TAG, mIOException.toString());
            try {
                throw mIOException;
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:14:53.083

有 2 种方法可以进行 onUpgrade，具体取决于您的应用。

1）删除所有旧表，然后运行 ​​onCreate。这基本上会清除所有旧数据并重新开始。如果您可以以某种方式重新生成旧数据，或者只是不关心它，那么它是一种很好的技术。

2）仔细维护每个发布版本之间架构的差异，并编写SQL语句以在它们之间进行适当的更改-添加新表，更改现有表以添加/删除列等。这既耗时又脆弱，因此请使用仅当您需要在这些版本之间保留数据时才这样做。

# ruby - Ruby 日期范围和匹配

> ID：16069363
> 
> 赞同：1
> 
> 时间：2013-04-17T20:12:06.850
> 
> 标签：ruby

我正在为我的工作环境编写一个小型日志嗅探器程序，该程序在日志中搜索几个关键词，让用户知道他们有一些东西要查看。这部分非常简单，但我试图实现的功能之一是用户可以选择他们今天想要走多远的表单，这样他们就不会遇到几个月前的错误，这不再重要.

我有日期，我有从现在开始的差距和用户指定的范围。我只是不确定如何使范围和匹配工作。这是我的代码：

```
require 'date'
### Get the logfile path from the user
p "What is the path to your log file?"
logfile = gets.chomp

### Get number of days user would like to go back
p "How many days back from today would you like to look?"
num_days = gets.chomp

############################################################################################
### Define Log class. Accept argumnet for path of the file. Called by foo = Log.new
############################################################################################
class Log

    def scan_log(file_name, days)
        error_exists = false
        verify = false
        apn = false
        strict = false
        days = days.to_i
        # time = Time.now.strftime("%Y-%m-%d")
        now = Date.today
        days_ago = (now - days)
        p now
        p days_ago

        File.open(file_name, "r") do |file_handle|
            file_handle.each_line do |line|
                if line =~ /Unable to verify signature/
                    verify = true
                    error_exists = true
                end

                if line =~ /gateway.push.apple.com/
                    apn = true
                    error_exists = true
                end

                if line =~ /Data truncation/
                    strict = true
                    error_exists = true
                end
            end
        end

        p "Verify signature error found" if verify

        p "You have an APNS error" if apn

        p "You have strict mode enabled" if strict

    end

end

l = Log.new
l.scan_log(logfile, num_days) 
```

我的想法是 file_handle.each_line do... 下的循环会起作用。我会在循环中包含现有的 if 语句，并且循环会将用户设置的日期范围与日志中的日期相匹配。日志中的格式为：

2013-04-17 15:10:42, 767

我不关心时间戳，只关心日期戳。

谢谢，如果你能帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:20:20.943

解析自由格式日期的一种可靠方法是：

```
 > Time.parse(" 2013-04-17 13:15:24 -0700 ").strftime("%Y-%m-%d")
  => "2013-04-17" 
 > Time.parse("Wed Apr 17 13:15:09 PDT 2013 ").strftime("%Y-%m-%d")
  => "2013-04-17" 
```

假设用户以“%Y-%m-%d”格式指定 start_date 和时间范围，您可以这样做：

```
 start_date = Time.parse( user_provided_date ) # e.g. "2013-04-10"
 log_date = Time.parse( line )

 do_something if (start_date - log_date) < number_of_seconds  # or whatever time range 
```

如果您只想显示比给定时间范围新的所有日志，那么您可以这样做：

```
 log_date = Time.parse( line )

 do_something if (Time.now - log_date) < number_of_seconds  # or whatever time range 
```

要获得 Rails 风格的漂亮时间范围，例如 1.day 或 12.hours ，您可以包括`ActiveSupport::Duration`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T21:05:45.723

您可以从日期构造一个范围（如问题标题所示）并使用它的 `include?`方法。

```
require 'date'

puts "How many days back from today would you like to look?"
days_back = gets.to_i #input: 3

logline_date = "2013-04-17 15:10:42, 767"

end_date = Date.today
start_date = end_date - days_back
selected_range = start_date..end_date

p selected_range.include?( Date.parse( logline_date )) #true (today for me, that is) 
```

# c# - SoundCloud API 在曲目评论中失败

> ID：16069373
> 
> 赞同：1
> 
> 时间：2013-04-17T20:13:00.377
> 
> 标签：c#, api, soundcloud

我正在尝试在 .NET 应用程序中使用 SoundCloud API。我需要为预定义的曲目发表评论。我正在使用以下代码：

```
byte[] response = client.UploadValues(String.Format
("https://api.soundcloud.com/tracks/{0}/comments.json?oauth_token={1}&comment={2}",
trackID, token, txtComment.Text), "PUT", new NameValueCollection()
{
    { "body", "Comment" }
}); 
```

我收到远程服务器返回错误：（404）未找到。当我使用 soundcloud 控制台[http://developers.soundcloud.com/console](http://developers.soundcloud.com/console)时，结果是一样的。

我错过了什么吗？或者是否有其他方法可以使用 API 向曲目发表评论？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T05:53:53.163

我找到了我的问题的解决方案。在这里： [如何通过 SoundCloud API 添加评论](https://stackoverflow.com/questions/10768474/how-to-add-comments-through-the-soundcloud-api?rq=1)

我的代码应该是这样的：

```
byte[] response = client.UploadValues(String.Format
("https://api.soundcloud.com/tracks/{0}/comments.json?oauth_token={1}&comment={2}",
trackID, token, txtComment.Text), "POST", new NameValueCollection()
{
    { "comment[body]", "Comment" }
}); 
```

# jquery - Jquery 没有识别自定义锚标记属性

> ID：16069376
> 
> 赞同：0
> 
> 时间：2013-04-17T20:13:17.633
> 
> 标签：jquery, html

我有一个 jquery 函数，它通过调用 php 脚本构建动态 html 代码，html 是使用输出的

```
 $('ul.special-list').append("<li><a href='#' class=restaurantItem  restaurant= '" + item.estName + "' adddress='" + item.estAddr + "'><img src= " + item.img_link + 
            " width='60' height='60' alt='" + item.estName + "'><div class='img-det'><strong class='title'> " + item.title + " </strong><p> " + item.desc_short +
            " <br>Expires: " + item.expiry_date + " </p><em class='price'>" + item.price + "</em></div></a><a href='dealDetail.html?id=" + item.id +
            "' class='det-link'>Detail</a>"); 
```

然后我有一个在 doument.ready 上调用的函数，该函数被正确调用，但自定义锚标记的值 - 餐厅未显示警报。

```
$('ul.special-list').on('click', 'a.restaurantItem', function (event) {

    event.preventDefault();
    alert($(this).attr('address'));
 } 
```

即使当我检查 chrome 中的元素时，该警报仍显示未定义，标签上的元素餐厅有一个值。

任何帮助都会很棒，我对 Jquery 很陌生，所以任何帮助都将不胜感激。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:23:07.947

class 属性可能会像 John B 提到的那样影响它，因为 class 接受多个以空格分隔的值。class 属性后面的空格在我们看来好像已经完成了类的声明，但 Chrome 似乎将标记的其余部分解释为更多的类。

可能是 jQuery 没有正确处理这些属性，因为它们并非都是标准的。通常，非标准属性应该写成`data-address=''`而不只是`address=''`. 切换到该格式后，您可以`data-address`使用`attr('data-address')`或在较新的 jQuery 版本中使用`data('address')`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:24:04.507

好吧，这基本上是因为在您的**HTML 字符串**中，属性名称是**adddress**并且您正在尝试访问属性**address**。
更改`adddress='" + item.estAddr + "'`为`address='" + item.estAddr + "'`。**还可以考虑为class**

添加引号：**`class="restaurantItem"`**

# css - css“border-image”浏览器兼容性问题

> ID：16069377
> 
> 赞同：1
> 
> 时间：2013-04-17T20:13:19.167
> 
> 标签：css, cross-browser

我已经搜索了几个小时，并四次检查了我的文件是否存在编码错误，但似乎无法提出任何建议。基本上，我的网站上有一个使用边框图像代码的 div 类，这在 Firefox 中效果很好。但是其他浏览器根本没有显示它。这可能是某个地方的愚蠢代码错误，但我似乎无法找到它，所以我希望能多加关注。

您可以在以下网址找到该网站： [http ://beta.lycancreations.com/](http://beta.lycancreations.com/)

它是 .section div 类，几乎用于网页上的所有文本块。

```
.section{
    padding: 15px 0px 20px;
    -moz-border-image-source:url(../img/layout/border.png);
    -moz-border-image-repeat: repeat;
    -moz-border-image-slice: 10 10;
    -moz-border-image-width: auto;
    -o-border-image-source:url(../img/layout/border.png);
    -o-border-image-repeat: repeat;
    -o-border-image-slice: 10 10;
    -o-border-image-width: auto;
    -webkit-border-image-source:url(../img/layout/border.png);
    -webkit-border-image-repeat: repeat;
    -webkit-border-image-slice: 10 10;
    -webkit-border-image-width: auto;
    border-image-source:url(../img/layout/border.png);
    border-image-repeat: repeat;
    border-image-slice: 10 10;
    border-image-width: auto;
    border-style: solid;
} 
```

我正在使用 CSS 的长版本，因为我一直在搞乱较短的版本，我更容易单独查看每个属性。

任何帮助将不胜感激，这是我第一次在这里发帖，所以如果我忘记包含任何内容，请告诉我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:24:06.050

给`div.section`我一个边框在 Safari 中为我修复了它。

```
div.section {
  ...
  border:1px;
} 
```

# c++ - 由另一个字符串的第一个字符组成的字符串 - 为什么它还打印完整的原始字符串？

> ID：16069378
> 
> 赞同：1
> 
> 时间：2013-04-17T20:13:23.840
> 
> 标签：c++, string, char, iostream

学习 C++。我只想获取字符串中的第一个字符，然后根据该字符创建一个新字符串，然后将其打印出来：

```
#include <iostream>
using namespace std;

int main(int argc, const char * argv[]) {
    string name = "Jerry";
    char firstCharacter = name.at(0);
    string stringOfFirstCharacter = string(&firstCharacter);
    cout << stringOfFirstCharacter;
    return 0;
} 
```

输出是：

```
J
Jerry 
```

我真的不知道为什么它也在打印`Jerry`。这是为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T20:17:51.677

您的代码具有未定义的行为。接受指针的构造函数的签名`char`要求它是一个指向*空终止*字符串的指针，在您的情况下它不是，因为它是单个字符。

我的猜测是您的实现使用了小对象优化，并且“Jerry”足够小，可以存储在`std::string`对象内部而不是动态分配。堆栈中两个对象的布局恰好是先`firstCharacter`，后`name`。当您调用`std::string(&firstCharacter)`它时，它会读取直到它遇到第一个空字符（在`std::string`缓冲区内）并停在那里。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T20:17:42.613

您正在从 a 构造一个[`std::string`](http://en.cppreference.com/w/cpp/string/basic_string/basic_string)对象`char*`（因为您正在获取 的地址`firstCharacter`）。的构造函数不会将指向字符的指针解释为字符本身`std::string`，而是将其解释为以 null 结尾的字符串。

在这种情况下，您的程序具有**Undefined Behavior**，因为 的地址`firstCharacter`不是以空字符结尾的字符串的第一个字符的地址。

你应该做的是：

```
string stringOfFirstCharacter(1, firstCharacter);
cout << stringOfFirstCharacter; 
```

如果你真的想创建一个单字符的字符串。但是，请注意，为了将字符打印到标准输出，您可以简单地编写：

```
cout << firstCharacter; 
```

甚至：

```
cout << name.at(0); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T20:17:23.997

使用`string(&firstCharacter)`，您正在使用表单的[`std::string`构造函数](http://en.cppreference.com/w/cpp/string/basic_string/basic_string)

```
std::string( const char* s, const Allocator& alloc = Allocator() ); 
```

这种形式需要一个指向以*null 结尾的字符数组的*指针。将指针传递给非空终止字符是不正确的。

如果您打算使用 1 初始化字符串`char`，则应使用以下形式：

```
string( 1, firstCharacter ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T20:17:39.577

`string`您正在使用的构造函数（带`char *`参数的构造函数）旨在将 C 样式的字符串转换为 C++ 字符串对象 - 而不是单个字符。通过将单个字符传递给它，您会导致未定义的行为。

在您的特定情况下， 之后的内存中似乎没有零字节`firstCharacter`，因此构造函数贯穿并包含所有`name`内容！

# c# - 在没有 SDK 的 PC 上运行使用 SDK 构建的应用程序

> ID：16069383
> 
> 赞同：0
> 
> 时间：2013-04-17T20:13:47.153
> 
> 标签：c#, .net, sdk, exe

我用 C# (.net 4 / 4.5) 编写了一个使用 Microsoft Surface SDK 构建的小应用程序，但是没有 SDK 的人似乎无法运行该应用程序。

我正在使用 Visual Studio 2012 构建它，并且`Local Copy`在`Microsoft.Surface`引用中设置为`true`，但仍然没有。

有没有其他人可以在不安装 SDK 的情况下执行应用程序的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:23:10.590

您应该将[Microsoft Surface Runtime](http://www.microsoft.com/en-us/download/details.aspx?id=26716)与您的应用程序一起分发。

# java - 在 OpenShift RedHat 服务器中配置 hibernate.cfg.xml

> ID：16069390
> 
> 赞同：3
> 
> 时间：2013-04-17T20:14:06.983
> 
> 标签：java, tomcat, jboss

我正在尝试在 OpenShift 主机（Tomcat 6 (JBoss EWS 1.0)）上配置 xWiki 服务器。我以前从未配置过 Java 服务器，但我遇到了一个问题：

我在我当地的 Ubuntu 上遵循了[THIS](http://halfahairwidth.blogspot.com.es/2009/09/how-to-install-xwiki-on-ubuntu.html) tuto 并开始工作。但是复制 OpenShift 服务器中的步骤我找不到**hibernate.cfg.xml**。使用休眠在目录树中查找文件我找到了包含文件`jbossews-1.0/jbossews-1.0/work/Catalina/localhost/xwiki/WEB-INF/lib/`的文件夹：

```
hibernate-c3p0-3.6.9.Final.jar
hibernate-core-3.6.9.Final.jar
hibernate-validator-4.3.0.Final.jar
hibernate-jpa-2.0-api-1.0.1.Final.jar
hibernate-commons-annotations-3.2.0.Final.jar 
```

但没有类似于 hibernate.cfg.xml 的东西。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-27T12:15:59.893

hibernate.cfg.xml 是你的 Hibernate 配置文件，在这里你可以指定数据库的方言、连接驱动、url、用户名、密码等。

例子：

```
<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE hibernate-configuration PUBLIC
          "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
          "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>

  <session-factory>

    <property name="dialect">org.hibernate.dialect.MySQLDialect</property>
    <property name="connection.driver_class">com.mysql.jdbc.Driver</property>
    <property name="connection.url">jdbc:mysql://host/database</property>
    <property name="connection.username">username</property>
    <property name="connection.password">password</property>

    <property name="cache.provider_class">org.hibernate.cache.HashtableCacheProvider</property>

    <property name="transaction.factory_class">org.hibernate.transaction.JDBCTransactionFactory</property>
    <property name="current_session_context_class">thread</property>
    <property name="hibernate.show_sql">false</property>
  </session-factory>

</hibernate-configuration> 
```

将此文件放在 Java 资源**类路径**中。有关详细信息，请查看[Oracle 的 hibernate.cfg.xml](https://code.google.com/p/sarasvati/source/browse/java/trunk/conf/hibernate.cfg.xml.example.oracle?r=1185)或[mkyong 的示例](http://www.mkyong.com/hibernate/maven-3-hibernate-3-6-oracle-11g-example-xml-mapping/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-28T17:20:55.177

这是（无论如何应该是）xWiki 安装问题。如果您使用的是WAR文件，那么当您将WAR放入tomcat webapps目录时，Tomcat通常会将WAR展开到同名目录中。在该目录中，在 WEB-INF 目录中，应该是 hibernate.cfg.xml 文件。通常，这里：

`/var/lib/tomcat5.5/webapps/xwiki/WEB-INF/hibernate.cfg.xml`

如果您已将 Tomcat 配置为运行 WAR 而不扩展它，那么该文件将位于 WAR 中：

`WEB-INF/hibernate.cfg.xml`

但在这种情况下，您必须编辑 XML 文件并将其放回 WAR 中以配置应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-13T07:39:12.953

我遇到了同样的问题，通过跟踪 tomcat，我看到它查看了以下位置，其中较长的位置位于我的 openstack 设备的 git 存储库中：

*   /var/lib/openshift/518f381fe0b8cd1de2000181/git/tomcat.git/hibernate.cfg.xml
*   /usr/share/java/tomcat7/hibernate.cfg.xml

我看不到这些位置与命令行或 catalina.properties 中给出的类路径之间有任何关联。git仓库是tomcat的cwd。现在将 hibernate.cfg.xml 放在那里确实有效。但我相信，一旦 openstack 的人意识到将 cwd 放在那里有多乱，他们就会把它移走。

# antlr - ANTLR 是否有针对 unicode 标识符开始和标识符继续字符集的内置规则？

> ID：16069394
> 
> 赞同：1
> 
> 时间：2013-04-17T20:14:34.367
> 
> 标签：antlr

我正在尝试为 unicode 兼容的标识符编写 ANTLR 4 令牌规则。在我看来，java.lang.Character 中有一个标识符开始和标识符继续字符的概念；是否有与这些概念相对应的内置 ANTLR 4 字符类？我已经找到了“isUnicodeIdentifierStart”的来源，但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:22:51.563

不，ANTLR 4 集合文字不支持像正则表达式这样的字符类。

# opengl-es - 是否有绘制“拉伸”线的常用技术

> ID：16069398
> 
> 赞同：5
> 
> 时间：2013-04-17T20:14:47.787
> 
> 标签：opengl-es, cocos2d-iphone

我试图弄清楚如何在 iPhone 上的 openGL/Cocos2d 中的两点之间绘制一条弹性/弹性线。像这样的东西

![在此处输入图像描述](https://i.stack.imgur.com/oYXn5.png)

随着线路变长，“乐队”变得越来越细。iOS 使用我在 Mail.app 中针对的相同技术，拉动刷新。

首先，这种东西有名字吗？

我的第一个想法是根据两者之间的角度在起始圆和结束圆的半径上绘制一个点，并使用距离/2 作为控制点绘制二次贝塞尔曲线。但我不是数学高手，所以我正在努力弄清楚如何放置将调整路径粗细的控制点。

但更大的问题是我需要用颜色填充形状，据我所知，OpenGL 贝塞尔曲线似乎无法做到这一点，因为曲线似乎不是形状的一部分填充。

所以我研究了使用点数组创建的样条曲线，但这开辟了一个数学难题的全新世界，因为我必须弄清楚路径边缘的所有点在哪里。

所以在我进入那个兔子洞之前，我想知道是否有一些我忽略的更简单的东西，或者是否有人能指出我最有效的技术。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:25:07.003

除了数学计算之外，我不确定人们使用的“常用”技术，但这个项目 **[SlimeyRefresh](https://github.com/dbsGen/SlimeRefresh)**是如何实现这一目标的一个很好的例子。

# ios - 禁止使用 NSLog

> ID：16069402
> 
> 赞同：2
> 
> 时间：2013-04-17T20:14:59.433
> 
> 标签：ios, objective-c, nslog

是否可以禁止使用**NSLog**，以便在编译时使用它会出现错误？理想情况下，某种带有不允许的方法名称的编译器标志？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-17T20:33:08.707

如果您重新声明`NSLog`（也许还有`NSLogv`）为

```
void NSLog(NSString *format, ...) UNAVAILABLE_ATTRIBUTE;
void NSLogv(NSString *format, va_list args) UNAVAILABLE_ATTRIBUTE; 
```

在您的预编译头文件中，您会收到一条很好的错误消息：

```
main.m:199:3：错误：“NSLog”不可用
                NSLog(@"%@", s1);
                ^

```

* * *

您甚至可以提供自定义错误消息（可在有关Clang 文档的[已弃用和不可用属性的消息中找到）：](http://clang.llvm.org/docs/LanguageExtensions.html#messages-on-deprecated-and-unavailable-attributes)

```
void NSLog(NSString *format, ...) __attribute__((unavailable("You should not do this!"))); 
```

```
main.m:202:3：错误：“NSLog”不可用：你不应该这样做！
                NSLog(@"%@", s1);
                ^

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:19:46.067

在您的前缀标头中：

```
#define NSLog(x, ...) (__please_dont_use_NSLog__) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T20:20:46.213

尝试这个！

```
 #ifdef DEBUG
 #   define NSLog(...) NSLog(__VA_ARGS__)
 #else 
 #   define NSLog(...)
 #endif 
```

可以在这里找到解决方案：[Enable and Disable NSLog in DEBUG mode](https://stackoverflow.com/questions/6552197/enable-and-disable-nslog-in-debug-mode)

希望这有帮助！

# php - 在上传期间重命名图像

> ID：16069404
> 
> 赞同：1
> 
> 时间：2013-04-17T20:15:02.377
> 
> 标签：php

我目前想使用 w3schools 图像上传代码，直到找到我不久前编写的代码。反正：

```
<?php
 $allowedExts = array("gif", "jpeg", "jpg", "png");
 $extension = end(explode(".", $_FILES["file"]["name"]));
 if ((($_FILES["file"]["type"] == "image/gif")
 || ($_FILES["file"]["type"] == "image/jpeg")
 || ($_FILES["file"]["type"] == "image/jpg")
 || ($_FILES["file"]["type"] == "image/png"))
 && ($_FILES["file"]["size"] < 20000)
 && in_array($extension, $allowedExts))
 {
 if ($_FILES["file"]["error"] > 0)
{
echo "Return Code: " . $_FILES["file"]["error"] . "<br>";
}
else
{
echo "Upload: " . $_FILES["file"]["name"] . "<br>";
 echo "Type: " . $_FILES["file"]["type"] . "<br>";
echo "Size: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br>";

if (file_exists("upload/" . $_FILES["file"]["name"]))
  {
  echo $_FILES["file"]["name"] . " already exists. ";
  }
else
  {
  move_uploaded_file($_FILES["file"]["tmp_name"],
  "upload/" . $_FILES["file"]["name"]);
  echo "Stored in: " . "upload/" . $_FILES["file"]["name"];
  }
}
 }
else
{
 echo "Invalid file";
 }
?> 
```

基本上我想要发生的是当用户上传文件时，它将文件名重命名为 $username 而不是原始名称，所以它只是 username.png 而不是我目前拥有的 username-38474.png

有什么帮助吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T20:19:01.553

```
move_uploaded_file($_FILES["file"]["tmp_name"], "upload/" . $_FILES["file"]["name"]); 
```

这行代码基本上将图像重命名为新位置： to `"upload/".$_FILES["file"]["name"]`，因此将这一行替换为：

```
move_uploaded_file($_FILES["file"]["tmp_name"], "upload/".$username.".".$extension); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:18:45.027

所以只需将不同的参数传递给`move_uploaded_file`：

```
$extension = explode("/", $_FILES["file"]["type"]);  //Use proper mime type here, $_FILES contents can be faked by remote user
move_uploaded_file($_FILES["file"]["tmp_name"], "upload/" . $username.".".$extension[1]); 
```

# r - 使用 tm-package 进行文本挖掘 - 词干提取

> ID：16069406
> 
> 赞同：11
> 
> 时间：2013-04-17T20:15:16.773
> 
> 标签：r, text-mining, tm

我正在使用`tm`-package 在 R 中进行一些文本挖掘。一切都很顺利。但是，在词干提取之后会出现一个问题 ( [http://en.wikipedia.org/wiki/Stemming](http://en.wikipedia.org/wiki/Stemming) )。显然，有些词具有相同的词干，但重要的是不要将它们“放在一起”（因为这些词的含义不同）。

有关示例，请参见下面的 4 个文本。在这里，您不能互换使用“讲师”或“演讲”（“协会”和“关联”）。但是，这是在步骤 4 中完成的。

是否有任何优雅的解决方案如何手动为某些案例/单词实现这一点（例如，“讲师”和“演讲”被保留为两个不同的东西）？

```
texts <- c("i am member of the XYZ association",
"apply for our open associate position", 
"xyz memorial lecture takes place on wednesday", 
"vote for the most popular lecturer")

# Step 1: Create corpus
corpus <- Corpus(DataframeSource(data.frame(texts)))

# Step 2: Keep a copy of corpus to use later as a dictionary for stem completion
corpus.copy <- corpus

# Step 3: Stem words in the corpus
corpus.temp <- tm_map(corpus, stemDocument, language = "english")  

inspect(corpus.temp)

# Step 4: Complete the stems to their original form
corpus.final <- tm_map(corpus.temp, stemCompletion, dictionary = corpus.copy)  

inspect(corpus.final) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-18T00:01:27.987

我不是 100% 你所追求的，也不完全了解它是如何`tm_map`工作的。如果我理解，那么以下工作。据我了解，您想提供一个不应被阻止的单词列表。我使用 qdap 包主要是因为我很懒，而且它有`mgsub`我喜欢的功能。

请注意，我对使用感到沮丧，`mgsub`因为`tm_map`它不断抛出错误，所以我只使用`lapply`了。

```
texts <- c("i am member of the XYZ association",
    "apply for our open associate position", 
    "xyz memorial lecture takes place on wednesday", 
    "vote for the most popular lecturer")

library(tm)
# Step 1: Create corpus
corpus.copy <- corpus <- Corpus(DataframeSource(data.frame(texts)))

library(qdap)
# Step 2: list to retain and indentifier keys
retain <- c("lecturer", "lecture")
replace <- paste(seq_len(length(retain)), "SPECIAL_WORD", sep="_")

# Step 3: sub the words you want to retain with identifier keys
corpus[seq_len(length(corpus))] <- lapply(corpus, mgsub, pattern=retain, replacement=replace)

# Step 4: Stem it
corpus.temp <- tm_map(corpus, stemDocument, language = "english")  

# Step 5: reverse -> sub the identifier keys with the words you want to retain
corpus.temp[seq_len(length(corpus.temp))] <- lapply(corpus.temp, mgsub, pattern=replace, replacement=retain)

inspect(corpus)       #inspect the pieces for the folks playing along at home
inspect(corpus.copy)
inspect(corpus.temp)

# Step 6: complete the stem
corpus.final <- tm_map(corpus.temp, stemCompletion, dictionary = corpus.copy)  
inspect(corpus.final) 
```

**基本上它的工作原理是：**

1.  为提供的“NO STEM”词替换唯一标识符键（the `mgsub`）
2.  然后你干（使用`stemDocument`）
3.  接下来，您将其反转并使用“NO STEM”字样（的`mgsub`）子标识符键
4.  最后完成词干 ( `stemCompletion`)

**这是输出：**

```
## >     inspect(corpus.final)
## A corpus with 4 text documents
## 
## The metadata consists of 2 tag-value pairs and a data frame
## Available tags are:
##   create_date creator 
## Available variables in the data frame are:
##   MetaID 
## 
## $`1`
## i am member of the XYZ associate
## 
## $`2`
##  for our open associate position
## 
## $`3`
## xyz memorial lecture takes place on wednesday
## 
## $`4`
## vote for the most popular lecturer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-04T02:06:51.453

您还可以使用以下包来提取单词：[https](https://cran.r-project.org/web/packages/SnowballC/SnowballC.pdf) ://cran.r-project.org/web/packages/SnowballC/SnowballC.pdf 。

您只需要使用函数**wordStem**，传递要词干的词向量以及您正在处理的语言。要了解您需要使用的确切语言字符串，您可以参考**getStemLanguages**方法，该方法将返回所有可能的选项。

亲切的问候

# opencv - 如何在 OpenCV 2.4.3 中保存（cvWrite 或 imwrite）图像？

> ID：16069407
> 
> 赞同：1
> 
> 时间：2013-04-17T20:15:17.000
> 
> 标签：opencv, face-detection, save-image

我正在尝试将 OpenCV 图像保存到硬盘驱动器。

这是我尝试过的：

```
public void SaveImage (Mat mat) {
  Mat mIntermediateMat = new Mat();

  Imgproc.cvtColor(mRgba, mIntermediateMat, Imgproc.COLOR_RGBA2BGR, 3);

  File path =
    Environment.getExternalStoragePublicDirectory(
    Environment.DIRECTORY_PICTURES);
  String filename = "barry.png";
  File file = new File(path, filename);

  Boolean bool = null;
  filename = file.toString();
  bool = Highgui.imwrite(filename, mIntermediateMat);

  if (bool == true)
    Log.d(TAG, "SUCCESS writing image to external storage");
    else
    Log.d(TAG, "Fail writing image to external storage");
  }
} 
```

任何人都可以展示如何使用 OpenCV 2.4.3 保存该图像吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T21:07:12.263

您的问题有点令人困惑，因为您的问题是关于桌面上的 OpenCV，但您的代码是针对 Android 的，您询问的是 IplImage，但您发布的代码使用的是 C++ 和 Mat。假设您使用 C++ 在桌面上，您可以执行以下操作：

```
cv::Mat image;
std::string image_path;
//load/generate your image and set your output file path/name
//...

//write your Mat to disk as an image
cv::imwrite(image_path, image); 
```

...或者更完整的例子：

```
void SaveImage(cv::Mat mat)
{
    cv::Mat img;     
    cv::cvtColor(...); //not sure where the variables in your example come from
    std::string store_path("..."); //put your output path here       

    bool write_success = cv::imwrite(store_path, img);
    //do your logging... 
} 
```

图像格式是根据提供的文件名选择的，例如，如果您的`store_path`字符串是“output_image.png”，那么 imwrite 会将其保存为 PNG 图像。[您可以在OpenCV 文档](http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html?highlight=imwrite#Mat%20imread%28const%20string&%20filename,%20int%20flags%29)中查看有效扩展列表。

使用 OpenCV 将图像写入磁盘时要注意的一个警告是，缩放将根据 Mat 类型而有所不同；也就是说，对于浮点数，图像应该在 [0, 1] 范围内，而对于无符号字符来说，它们将来自 [0, 256)。

对于 IplImages，我建议只是切换到使用 Mat，因为旧的 C 接口已被弃用。您可以通过然后使用 Mat 将 IplImage 转换为`cvarrToMat`Mat，例如

```
IplImage* oldC0 = cvCreateImage(cvSize(320,240),16,1);
Mat newC = cvarrToMat(oldC0);
//now can use cv::imwrite with newC 
```

或者，您可以将 IplImage 转换为 Mat 只需

```
Mat newC(oldC0); //where newC is a Mat and oldC0 is your IplImage 
```

此外，我刚刚注意到OpenCV 网站上的[本教程](http://docs.opencv.org/doc/tutorials/introduction/load_save_image/load_save_image.html)，它为您提供了在（桌面）环境中加载和保存图像的演练。

# for-loop - 为什么我的 for 循环不增加我的变量？

> ID：16069411
> 
> 赞同：1
> 
> 时间：2013-04-17T20:15:32.203
> 
> 标签：for-loop, batch-file

我编写了一个批处理文件，但我是新手`for-loops`，我需要它。

我现在知道语法是如何工作的，但我无法弄清楚为什么我的循环没有做它应该做的事情。

此代码是我文件的摘录：

```
@echo off & setlocal enabledelayedexpansion
set /p file=: 
set /a numberofgoals=0
for /f "delims=" %%a in ("%file%.txt") do set /a "numberofgoals+=1"

echo %numberofgoals%
pause > nul 
```

如果我做对了所有事情，我的输出*应该*是指定文本文件的长度，并且它以前对我有用，但显然我在代码中更改了一些我不确定的内容，并且`%numberofgoals%`现在的输出每次都恰好为 1，不管如何我的文本文件很长。

我的问题是：我做错了什么，为什么现在输出 1？我什至不记得在那里改变了一些东西......

编辑：我按照建议更改`"delims="`了`"usebackq delims="`，现在可以使用了，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:23:24.720

`for`循环括号中的引号表示*“处理此字符串”*而不是*“读取此文件”*。使用该`usebackq`选项来指示引号提供了文件名：

```
for /f "usebackq delims=" %%a in ("%file%.txt") do set /a "numberofgoals+=1" 
```

你应该是金色的。

`help for`在您的窗口中输入`cmd`血腥细节。

# tdd - TypeScript 中的依赖注入

> ID：16069416
> 
> 赞同：33
> 
> 时间：2013-04-17T20:15:39.920
> 
> 标签：tdd, requirejs, typescript, amd

我正在研究使用 TypeScript 进行 TDD 的可能性。如果我用 TypeScript 编写测试，是否可以让 import 语句为我的测试类返回模拟？还是用纯 JavaScript 编写测试并自己处理注入 AMD 的唯一可行方法？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-04-19T09:47:34.957

我开发了一个名为 InversifyJS 的 IoC 容器，它具有诸如上下文绑定之类的高级依赖注入功能。

您需要遵循*3 个基本步骤*才能使用它：

### 1.添加注释

注释 API 基于 Angular 2.0：

```
import { injectable, inject } from "inversify";

@injectable()
class Katana implements IKatana {
    public hit() {
        return "cut!";
    }
}

@injectable()
class Shuriken implements IShuriken {
    public throw() {
        return "hit!";
    }
}

@injectable()
class Ninja implements INinja {

    private _katana: IKatana;
    private _shuriken: IShuriken;

    public constructor(
        @inject("IKatana") katana: IKatana,
        @inject("IShuriken") shuriken: IShuriken
    ) {
        this._katana = katana;
        this._shuriken = shuriken;
    }

    public fight() { return this._katana.hit(); };
    public sneak() { return this._shuriken.throw(); };

} 
```

### 2\. 声明绑定

绑定 API 基于 Ninject：

```
import { Kernel } from "inversify";

import { Ninja } from "./entities/ninja";
import { Katana } from "./entities/katana";
import { Shuriken} from "./entities/shuriken";

var kernel = new Kernel();
kernel.bind<INinja>("INinja").to(Ninja);
kernel.bind<IKatana>("IKatana").to(Katana);
kernel.bind<IShuriken>("IShuriken").to(Shuriken);

export default kernel; 
```

### 3.解决依赖关系

解析 API 基于 Ninject：

```
import kernel = from "./inversify.config";

var ninja = kernel.get<INinja>("INinja");

expect(ninja.fight()).eql("cut!"); // true
expect(ninja.sneak()).eql("hit!"); // true 
```

最新版本 (2.0.0) 支持许多用例：

*   内核模块
*   内核中间件
*   使用类、字符串文字或符号作为依赖标识符
*   注入常​​量值
*   注入类构造函数
*   工厂注入
*   汽车厂
*   注入提供者（异步工厂）
*   激活处理程序（用于注入代理）
*   多次注射
*   标记绑定
*   自定义标签装饰器
*   命名绑定
*   上下文绑定
*   友好的异常（例如循环依赖）

您可以在[https://github.com/inversify/InversifyJS了解更多信息](https://github.com/inversify/InversifyJS)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-03-24T11:20:16.667

我在 TypeScript 中使用[infuse.js](https://github.com/soundstep/infuse.js)进行依赖注入。

### 参考 d.ts

```
/// <reference path="definition/infusejs/infusejs.d.ts"/> 
```

### 在启动时初始化您的注射器

```
this.injector = new infuse.Injector(); 
```

### 映射依赖项

```
this.injector.mapClass( 'TodoController', TodoController );
this.injector.mapClass( 'TodoView', TodoView );
this.injector.mapClass( 'TodoModel', TodoModel, true );  // 'true' Map as singleton 
```

### 注入依赖

```
export class TodoController
{
    static inject = ['TodoView', 'TodoModel'];

    constructor( todoView:TodoView, todoModel:TodoModel )
    {

    }
 } 
```

它是基于字符串的，而不是基于类型的（因为在 TypeScript 中还不能实现反射）。尽管如此，它在我的应用程序中运行良好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-05-12T11:49:03.080

试试这个[依赖注入器（Typejector）](http://olegdokuka.github.io/Typejector/)

GitHub[打字机](https://github.com/OlegDokuka/Typejector)

使用新的 TypeScript 1.5，可以使用注释方式

例如

```
 @injection
    class SingletonClass {
        public cat: string = "Kitty";
        public dog: string = "Hot";

        public say() {
            alert(`${this.cat}-Cat and ${this.dog}-Dog`);
        }
    }
    @injection
    class SimpleClass {
        public say(something: string) {
            alert(`You said ${something}?`);
        }
    }

    @resolve
    class NeedInjectionsClass {
        @inject(SingletonClass)
        public helper: SingletonClass;
        @inject(SimpleClass)
        public simpleHelper: SimpleClass;

        constructor() {
            this.helper.say();
            this.simpleHelper.say("wow");
        }
    }
    class ChildClass extends NeedInjectionsClass {

    }

    var needInjection = new ChildClass(); 
```

对于问题案例：某些属性应该实现伪接口（或抽象类），如下例所示。

```
 class InterfaceClass {
        public cat: string;
        public dog: string;

        public say() {

        }
    }

    @injection(true, InterfaceClass)
    class SingletonClass extends InterfaceClass {
        public cat: string = "Kitty";
        public dog: string = "Hot";

        public say() {
            alert(`${this.cat}-Cat and ${this.dog}-Dog`);
        }
    }

    @injection(true, InterfaceClass)
    class MockInterfaceClass extends InterfaceClass {
        public cat: string = "Kitty";
        public dog: string = "Hot";

        public say() {
            alert(`Mock-${this.cat}-Cat and Mock-${this.dog}-Dog`);
        }
    }

    @injection
    class SimpleClass {
        public say(something: string) {
            alert(`You said ${something}?`);
        }
    }

    @resolve
    class NeedInjectionsClass {
        @inject(InterfaceClass)
        public helper: InterfaceClass;
        @inject(SimpleClass)
        public simpleHelper: SimpleClass;

        constructor() {
            this.helper.say();
            this.simpleHelper.say("wow");
        }
    }

    class ChildClass extends NeedInjectionsClass {

    }

    var needInjection = new ChildClass(); 
```

**注意：** *模拟注入应该在源代码之后定义，因为它重新定义了接口的类创建器*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-16T16:08:29.903

对于使用 Angular2 的人，我开发了 Fluency Injection [https://www.npmjs.com/package/fluency-injection](https://www.npmjs.com/package/fluency-injection)。文档非常完整，它模仿了 Angular2 的 DI 的行为。

非常感谢您的反馈，希望对您有所帮助:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-02-03T01:32:32.690

您可以使用解决方案：
[JavaScript/TypeScript 的轻量级依赖注入容器](https://github.com/microsoft/tsyringe)

```
import {autoInjectable, container} from "tsyringe";

class MyService {
  move(){
    console.log('myService move 123', );
  }
}

class MyServiceMock {
  move(){
    console.log('mock myService move 777', );
  }
}

@autoInjectable()
export class ClassA {
  constructor(public service?: MyService) {
  }
  move(){
    this.service?.move();
  }
}

container.register(MyService, {
  useClass: MyServiceMock
});

new ClassA().move(); 
```

输出：

> 模拟 myService 移动 777

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-11-04T16:34:01.597

我一直在开发一个名为[Pigly](https://github.com/pigly-di/pigly)的 DI 解决方案。给出有关注入和测试的原始问题的示例（诚然不是自动模拟生成-尽管您可以[像我在这里所做的那样尝试](https://github.com/pigly-di/pigly/blob/develop/packages/pigly-example/example-mock.ts)[ts-auto-mock](https://github.com/uittorio/ts-auto-mock#readme) ）：

鉴于：

```
interface IDb {
  set(key: string, value: string);
}

interface IApi {
  setName(name: string);
}

class Api implements IApi {
  constructor(private db: IDb) {}
  setName(name: string){
    this.db.set("name", name);
  }
} 
```

我们可以绑定类型，

```
import { Kernel, toSelf, to, toConst } from 'pigly';
import * as sinon from 'sinon';

let spy = sinon.spy();

let kernel = new Kernel();

kernel.bind(toSelf(Api));
kernel.bind<IApi>(to<Api>());
kernel.bind<IDb>(toConst({ set: spy })); 
```

然后解决并测试：

```
let api = kernel.get<IApi>();

api.setName("John");

console.log(spy.calledWith("name", "John")); 
```

此示例的执行/编译需要一个 typescript 转换器 - 将接口符号和构造函数提供程序编译成普通的 javascript。[有几种方法可以做到这一点](https://github.com/cevek/ttypescript#how-to-install)。ts-node + ttypescript 方法是有一个 tsconfig.json：

```
{
  "compilerOptions": {
    "target": "es2015",
    "module": "commonjs",
    "moduleResolution": "node",
    "plugins": [{
      "transform": "@pigly/transformer"
    }]
  }
} 
```

并执行

```
ts-node --compiler ttypescript example-mock.ts 
```

Pigly 的区别在于不需要对您的（或第三方）类进行任何更改，代价是使用打字稿转换器，或者如果（您不想使用转换器）则使用更详细的绑定。它仍然是实验性的，但我认为它显示出希望。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-17T20:18:08.433

TypeScript 可以很好地与 AMD 加载器（如 requirejs）配合使用。如果配置正确，TypeScript 将输出完全符合 AMD 的 javascript。

在测试情况下，您可以配置 requirejs 以注入可测试的模块。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-20T18:08:17.410

你可以试一试：[https](https://www.npmjs.com/package/easy-injectionjs) ://www.npmjs.com/package/easy-injectionjs 。它是一个通用的依赖注入包。

@EasySingleton 在整个应用程序中创建依赖项的单个实例。它是某种服务的理想选择。

@EasyPrototype 根据需要创建尽可能多的依赖项实例。它是可变依赖项的理想选择。

@EasyFactory 主要用于继承：

你可以使用这个包做任何事情：简单用法（来自自述文件）：

```
import { Easy, EasyFactory, EasyPrototype, EasySingleton } from 'easy-injectionjs';

@EasyFactory()
abstract class Person {
  abstract getName();
  abstract setName(v: string);
}

// @EasyObservable()
@EasySingleton()
class Somebody extends Person{
  // @Easy()
  constructor (private name: string) {
    super()
    this.name = 'Sal';
  }

  public getName() {
    return this.name;
  }
  public setName(v: string) {
    this.name = v;
  }
}

@EasyPrototype()
class Nobody extends Person{
  @Easy()
  somebody: Person;
  constructor () {
    super()
  }

  public getName() {
    return this.somebody.getName();
  }

  public setName(v: string) {
    this.somebody.setName(v);
  }
}

@EasyPrototype()
class Data {
  @Easy()
  somebody: Person;
  name: string;

  change(v: string) {
    this.somebody.setName(v);
  }

  getName(): string {
    return this.somebody.getName();
  }
}

let n = new Nobody();
console.log(n.getName()) // Prints Sal
n.setName('awesome');
console.log(n.getName())  // Prints awesome
let d = new Data()
console.log(d.getName())  // Prints awesome
d.change('Gelba')
console.log(n.getName())  // Prints Gelba
d.change('kaa')
console.log(n.getName())  // Prints Kaa 
```

即使你想注入节点模块，你也可以这样做：

```
import * as IExpress from 'express';
import { Easy, EasySingleton } from 'easy-injectionjs';

@EasySingleton()
class Express extends IExpress {} 

@EasySingleton()
export class App {
  @Easy()
  private _express: Express;
}

let app = new App();
console.log(app) 
```

当然，快速服务器的使用不适用于控制台日志记录。它仅用于测试：D。

希望有帮助：D

* * *

## 回答 #9

> 赞同：-6
> 
> 时间：2013-11-20T16:30:34.687

我从事受 AutoFixture 启发的 AutoFixtureTS。AutoFixtureTS 通过自动化不相关的测试夹具设置使 TypeScript 开发人员更容易进行测试驱动开发，使测试开发人员能够专注于每个测试用例的基本要素。

[http://ronniehegelund.github.io/AutoFixtureTS/](http://ronniehegelund.github.io/AutoFixtureTS/)

它仍然只是原型代码，但请检查一下:-)

/罗尼

# php - jQuery 加载 PHP 文件

> ID：16069419
> 
> 赞同：0
> 
> 时间：2013-04-17T20:15:42.920
> 
> 标签：php, jquery, email, load

我目前正在使用 Jquery 加载函数将 php 内容加载到 Div 中。但是当我使用我的 php 电子邮件表单时，它会变成全白并且索引页面会丢失（我的意思是主布局）。无论如何我可以使用 Jquery 将 Insch.php 加载回 div，即使它需要执行？

```
 <form id="contactform" method="POST" action="insch.php"> <--- this is my Form

  $('.menut').click(function () {
       var phpFile = $(this).attr('id') + '.php';
      /* alert(phpFile)*/
       $.get(phpFile, function (data) {
           $('#box1').html(data);
       });
       return false;
   });                   <---- my Jquery load function(on index) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:19:25.360

我看到您将返回的数据直接添加到`$("#box1")`. 如果您的 php 文件返回`Html`，您应该`dataType:'html'`在 ajax 请求中进行设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:27:26.380

对不起，你的问题有点难以理解。我有点猜测，但听起来你在问如何在不刷新页面的情况下提交表单。如果是这样，您可以执行以下操作：

```
$('.menut').click(function() {
    var phpFile = $(this).attr('id') +'.php';

    $('#box1').load(phpFile, function() { // <-- this is your ready function

        // once the form has been added to the page,
        // add the 'submit' event listener
        $('#contactForm').submit(function(e) {

            // prevent the form from submitting regularly (causing a page refresh)
            e.preventDefault();

            // get the data from the form
            var data = $(this).serialize();

            // submit the form via AJAX and put the response in #box1
            $('#box1').load($(this).attr('action'), data);
        });
    });
}); 
```

* * *

***更新：***

您的**ready**函数是您在 AJAX 调用中创建的要在内容加载完成时执行的函数（当内容*准备好*时）。它也可以称为**回调**函数、**完成**函数或**成功**函数。

看看我在上面第四行代码中添加的注释。我已经指出了我所说的准备好的功能。

在您的问题中，您使用了这个：

```
$.get(phpFile, function (data) {
    $('#box1').html(data);
}); 
```

这相当于：

```
$('#box1').load(phpFile); 
```

这会将响应（您的表单）`phpFile`从`#box1`. 这`function (data) { ... }`是你准备好的功能。那就是您应该将`submit`事件绑定到表单的地方。

如果您[`load()`](http://api.jquery.com/load/)按照我的建议切换到该方法，那么您只需将一个新函数（这将是您的就绪函数）作为该方法的第二个参数传递给该`load()`方法，这是我在原始答案中给出的解决方案。

# variables - PHP：如何索引绑定变量？

> ID：16069424
> 
> 赞同：0
> 
> 时间：2013-04-17T20:15:49.390
> 
> 标签：variables, indexing, bind

另外，你如何索引绑定值？例如，假设我有：

```
oci_parse($handler, "SELECT * FROM table where something = :bv_name['index']")

oci_bind_by_name($stid, ":bv_name", $varname); 
```

该索引显然不起作用。无论如何在PHP中干净地做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:38:34.640

您应该绑定特定的索引：

```
oci_bind_by_name($stid ":bv_name", $varname['index']); 
```

然后只`:bv_name`在查询中使用。

# android - XmlPullParser：获取包含 XML 标签的内部文本

> ID：16069425
> 
> 赞同：10
> 
> 时间：2013-04-17T20:15:52.083
> 
> 标签：android, xml, xmlpullparser

假设您有一个这样的 XML 文档：

```
<root>
  That was a <b boldness="very">very bold</b> move.
</root> 
```

假设`XmlPullParser`是在根的开始标签上。有没有一种方便的方法可以将所有文本读取`root`到DOM 中？`String``innerHtml`

还是我必须自己编写一个实用方法来重新创建已解析的标签？当然，这对我来说似乎是在浪费时间。

```
String myDesiredString = "That was a <b boldness=\"very\">very bold</b> move." 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-17T20:33:47.253

这个方法应该覆盖它，但不处理单例标签或命名空间。

```
public static String getInnerXml(XmlPullParser parser)
        throws XmlPullParserException, IOException {
    StringBuilder sb = new StringBuilder();
    int depth = 1;
    while (depth != 0) {
        switch (parser.next()) {
        case XmlPullParser.END_TAG:
            depth--;
            if (depth > 0) {
                sb.append("</" + parser.getName() + ">");
            }
            break;
        case XmlPullParser.START_TAG:
            depth++;
            StringBuilder attrs = new StringBuilder();
            for (int i = 0; i < parser.getAttributeCount(); i++) {
                attrs.append(parser.getAttributeName(i) + "=\""
                        + parser.getAttributeValue(i) + "\" ");
            }
            sb.append("<" + parser.getName() + " " + attrs.toString() + ">");
            break;
        default:
            sb.append(parser.getText());
            break;
        }
    }
    String content = sb.toString();
    return content;
} 
```

# visual-studio - TFS 项目显示为“白色”

> ID：16069428
> 
> 赞同：1
> 
> 时间：2013-04-17T20:15:52.710
> 
> 标签：visual-studio, visual-studio-2012

我正在为我的 Visual Studio 2012 使用深色主题，但似乎每当我打开 TFS 工作项时，颜色都是“白色”。我不知道如何解决这个问题。这是它的样子：

![这是它的样子：](https://i.stack.imgur.com/BqOnh.jpg)

# sql - 如何显示具有多个命中的行？

> ID：16069429
> 
> 赞同：1
> 
> 时间：2013-04-17T20:15:54.760
> 
> 标签：sql

如果我跑

```
SELECT somecolumn FROM sometable GROUP BY somecolumn HAVING count(*) > 1; 
```

输出将具有在`somecolumn`中多次出现的值`sometable`。

但我想查看这些重复值出现的*行（或其中的一部分）。*例如，如果`foo`和`bar`是感兴趣的其他列的名称，`sometable`则输出的前几行可能看起来像

```
 somecolumn |  foo   |  bar
-------------------------------
 123        | foo_1  | bar_2
 123        | foo_3  | bar_5
 123        | foo_7  | bar_11
 234        | foo_13 | bar_17
 234        | foo_19 | bar_23
... 
```

等等

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:19:08.327

对于与数据库无关的解决方案，您可以这样做：

```
SELECT *
FROM sometable S
WHERE somecolumn IN (   SELECT somecolumn 
                        FROM sometable 
                        GROUP BY somecolumn 
                        HAVING count(*) > 1) 
```

对于 SQL Server 2005+，您可以这样做：

```
;WITH CTE AS
(
    SELECT  *,
            N = COUNT(*) OVER(PARTITION BY somecolumn)
    FROM sometable
)
SELECT *
FROM CTE
WHERE N > 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:17:45.013

您需要将这些列添加到选择以及分组中

```
SELECT 
    somecolumn, 
    foo, 
    bar 
FROM 
    sometable 
GROUP BY 
    somecolumn, 
    foo, 
    bar 
HAVING count(*) > 1; 
```

# html - Rubymine 的实时预览/所见即所得支持或插件？

> ID：16069432
> 
> 赞同：3
> 
> 时间：2013-04-17T20:15:57.297
> 
> 标签：html, css, wysiwyg, rubymine, live-preview

我在 Windows 上使用 Rubymine 5.4，它总体上非常棒，与 Visual Studio 一样好 95% 作为 HTML / CSS 编辑器，但有一些例外......主要是缺乏实时预览 /WYSIWYG 能力，即我输入我可以看到生成的预览直播（除了VS，DreamWeaver 也有这个功能）。我似乎在 IDE、帮助或任何 Google/Stack 搜索中都找不到类似的东西。

需要明确的是，我正在寻找一种在 RubyMine 中具有分屏视图的方法，我可以在其中在一个窗格/选项卡中编辑我的 HTML / CSS，并查看它在浏览器中的样子的实时预览另一个选项卡/窗格。

理想情况下，这将是：

1.  在 RubyMine 本身中（使用如上所述的本机窗格/选项卡）
2.  用户可以配置他们想要查看预览的任何浏览器渲染引擎（Chrome、FF、IE 等）...

...但是，我可以接受上述两者的任何变体，例如使用外部窗口/浏览器简单地与 RubyMine 集成，或者，预览仅适用于有限的渲染引擎（假设只有 Chrome）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-01T16:13:14.110

感谢@CrazyCoder 和@LazyOne 的指点...

经过更多研究，我已经确认并获得了更多详细信息：

解决方案是使用官方 Jetbrains（RubyMine 的制造商）LiveEdit 插件，您可以在这里找到： [http ://plugins.jetbrains.com/plugin/?id=7007](http://plugins.jetbrains.com/plugin/?id=7007)

* * *

## 详细说明

1.  从此处下载***JetBrains LiveEdit 插件***[： http ://plugins.jetbrains.com/plugin/?id=7007](http://plugins.jetbrains.com/plugin/?id=7007)
2.  运行`Rubymine > Settings > Plugins`（在设置的搜索框中输入“插件”）
3.  单击`Install Plugin from disk`列表底部的按钮
4.  导航到您下载插件的位置并选择/打开它
5.  通过在插件列表中选中它来激活
6.  （您可能必须）重新启动 RubyMine
7.  重新启动后，转到`menubar > View > LiveEdit`（然后将被检查）
8.  在此处下载***适用于 Chrome 的 JetBrains IDE 浏览器扩展***：[https ://chrome.google.com/webstore/detail/jetbrains-ide-support/hmhgeddbohgjknpmjagkdomcpobmllji?utm_source=chrome-ntp-icon](https://chrome.google.com/webstore/detail/jetbrains-ide-support/hmhgeddbohgjknpmjagkdomcpobmllji?utm_source=chrome-ntp-icon)
    *   Chrome 扩展支持*在 IDE*外部、外部 Chrome 窗口中的*所见即所得/实时*“LiveEdit”和*实际 RubyMine IDE 内部的JavaScript 调试*
    ***   我相信 FireFox 也有一个扩展，我相信它也支持通过 IDE 进行 Javascript 调试。但是，我不确定它是否像 Chrome 扩展一样支持 LiveEdit**
***   （启动）调试您的项目*   像往常一样编辑**

 **## 观察/意见

该插件几乎可以无缝运行。我发现它不必经常手动重新加载页面，即使用鼠标或键盘将焦点带到浏览器窗口并点击刷新，从而显着缩短了开发时间......这次加起来特别是如果你做了很多HTML/CSS 并希望经常检查您的更改。

但是，如果您要执行任何主要的后端/Rails 或 Javascript，我建议您将其关闭，因为由于代码解释/处理，重新加载可能会稍长一些，并且您在语句中间时遇到错误，并且LiveEdit 决定在变量未定义或值不正确时进行刷新。在这种情况下，您无需手动刷新而节省的时间可能会丢失（超过 1 倍）b/c 在服务器端或 JS 中创建/呈现内容的频率和时间在客户端。**

# macros - 球拍宏省略号语法

> ID：16069434
> 
> 赞同：4
> 
> 时间：2013-04-17T20:15:59.927
> 
> 标签：macros, racket, ellipsis

我有一个宏在传递一个参数时工作，我想扩展它以使用 ... 接受 n 个参数，但我无法弄清楚语法。

该宏要么接受自定义语法，即key:val key:val，要么接受一个过程。

例如：（3种不同的用法）

```
(schema-properties [(name:first-name type:string)])
(schema-properties [(name:age type:number required:#t)])
(schema-properties [(my-custom-fn arg1 arg2 arg3)]) 
```

定义：

```
(define-syntax (schema-properties stx)
  (syntax-parse stx
    [(_ [(prop:expr ...)])
     (with-syntax ([prop0 (make-prop-hash #'(prop ...))])
       #'(list prop0))]))

(define-for-syntax (make-prop-hash stx)
  (with-syntax ([(props ...) stx])
    (if (regexp-match #px":"
                      (symbol->string (car (syntax->datum #'(props ...)))))
        #'(pairs->hash 'props ...)
        #'(props ...)))) 
```

这是有效的，因为它检查 prop:expr 语法是否存在“：”，如果存在，则将其传递给函数（pairs->hash 'props ...），否则，它只是调用它（props ...）。

现在，我希望能够通过：

```
(schema-properties [(name:first-name type:string)
                    (name:last-name type:string)
                    (my-fn arg1 arg2 arg3)]) 
```

并让它以同样的方式工作。但我目前处于省略号地狱中，我的大脑不再正常工作。

任何见解都值得赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:33:00.903

建议：使用辅助函数来帮助处理嵌套。您的`schema-properties`宏知道如何处理一层嵌套，并且您希望将其应用于多个子句。这与我们处理事物列表时的原则相同：有一个助手来处理事物，然后将其应用于您的列表。它有助于降低复杂性。

对于您的代码，我们可以这样做：

```
#lang racket
(require (for-syntax syntax/parse))

(define-syntax (schema-properties stx)
  (syntax-parse stx
    [(_ [clause ...])
     (with-syntax ([(transformed-clauses ...)
                    (map handle-clause (syntax->list #'(clause ...)))])
       #'(list transformed-clauses ...))]))

;; handle-clause: clause-stx -> stx
(define-for-syntax (handle-clause a-clause)
  (syntax-parse a-clause
    [(prop:expr ...)
     (make-prop-hash #'(prop ...))]))

(define-for-syntax (make-prop-hash stx)
  (with-syntax ([(props ...) stx])
    (if (regexp-match #px":"
                      (symbol->string (car (syntax->datum #'(props ...)))))
        #'(pairs->hash 'props ...)
        #'(props ...))))

;;; Let's try it out.  I don't know what your definition of pairs->hash is,
;;; but it probably looks something like this:
(define (pairs->hash . pairs)
  (define ht (make-hash))
  (for ([p pairs])
    (match (symbol->string p)
      [(regexp #px"([-\\w]+):([-\\w]+)" 
               (list _ key value))
       (hash-set! ht key value)]))
  ht)

(schema-properties [(name:first-name type:string)
                    (name:last-name type:string)
                    (list 1 2 3)]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T22:21:27.347

另一个建议：使用语法类来帮助处理嵌套：

首先，定义一个可以识别 key:value 标识符的语法类（并使它们的组件字符串可用作`key`和`value`属性）：

```
(begin-for-syntax
  (define-syntax-class key-value-id
    #:attributes (key value)
    (pattern x:id
             #:do [(define m (regexp-match "^([^:]*):([^:]*)$" 
                                           (symbol->string (syntax-e #'x))))]
             #:fail-unless m #f
             #:with (_ key value) m))) 
```

现在将一个子句定义为这些序列的序列（以一种方式处理）或其他任何东西（被视为一个表达式，它必须产生一个过程）。该`code`属性包含每种子句的*解释。*

```
(begin-for-syntax
  (define-syntax-class clause
    #:attributes (code)
    (pattern (x:key-value-id ...)
             #:with code #'(make-immutable-hash '((x.key . x.value) ...)))
    (pattern proc
             #:declare proc (expr/c #'(-> any))
             #:with code #'(proc.c)))) 
```

现在宏只是将各个部分放在一起：

```
(define-syntax (schema-properties stx)
  (syntax-parse stx
    [(_ [c:clause ...])
     #'(list c.code ...)])) 
```

# c# - C# 使用 OpenXML 复制 DOCX 文件

> ID：16069435
> 
> 赞同：2
> 
> 时间：2013-04-17T20:16:11.333
> 
> 标签：c#, .net, clone, openxml

我正在尝试复制 docx 文件内容并使用 C# 中的 OpenXML 将它们保存在同一个文件中

这是代码：

```
using (WordprocessingDocument wordDoc = WordprocessingDocument.Open(wordFileNamePath, true))
{
    foreach(OpenXmlElement element in wordDoc.MainDocumentPart.Document.ChildElements)
    {
        OpenXmlElement cloneElement = (OpenXmlElement)element.Clone();
        wordDoc.MainDocumentPart.Document.Append(cloneElement);
    }
    wordDoc.MainDocumentPart.Document.Save();
} 
```

代码运行良好，可以满足我的需要。我的问题是生成的 docx 文件已部分损坏。当我打开我的文件时，我收到以下两条消息： ![在此处输入图像描述](https://i.stack.imgur.com/9h0MZ.png)

单击“确定”然后单击“是”将正常打开文件。但是，该文件一直被损坏，直到我“另存为”它（使用相同或不同的名称）。这就是新保存的文件变得固定的方式。

通过使用适用于 Microsoft Office 的 Open XML SDK 2.5 Productivity Tool，我可以验证文件并查看反映的代码。验证文件会出现以下 5 个错误：

![在此处输入图像描述](https://i.stack.imgur.com/Forqd.png)

所以我认为我在代码中使用的“克隆”功能会按原样复制元素，因此当它附加到文档时，会发生一些 ID 重复。

复制自身后获得正确工作的 DOCX 文件的任何想法？任何替代代码表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-11-28T12:10:34.230

您的方法的问题在于它创建了无效的 Open XML 标记。这就是为什么。

假设您有一个由以下标记表示的非常简单的 Word 文档：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
  <w:body>
    <w:p>
      <w:r>
        <w:t>First paragraph</w:t>
      </w:r>
    </w:p>
    <w:p>
      <w:r>
        <w:t>Second paragraph</w:t>
      </w:r>
    </w:p>
  <w:body>
<w:document> 
```

在您的`foreach`循环中，`wordDoc.MainDocumentPart.Document.ChildElements`将是一个仅包含该元素的单元素列表`w:body`。因此，您创建`w:body`元素的深层克隆并将其附加到`w:document`. 生成的 Open XML 标记如下所示：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
  <w:body>
    <w:p>
      <w:r>
        <w:t>First paragraph</w:t>
      </w:r>
    </w:p>
    <w:p>
      <w:r>
        <w:t>Second paragraph</w:t>
      </w:r>
    </w:p>
  <w:body>
  <w:body>
    <w:p>
      <w:r>
        <w:t>First paragraph</w:t>
      </w:r>
    </w:p>
    <w:p>
      <w:r>
        <w:t>Second paragraph</w:t>
      </w:r>
    </w:p>
  <w:body>
<w:document> 
```

上面是一个`w:document`有两个`w:body`子元素的，它是无效的 Open XML 标记，因为它`w:document`必须只有一个`w:body`子元素。因此，Word 会显示该错误消息。

要解决此问题，您需要`Document.Body`在您使用的任何地方使用`Document`. 以下简化的示例显示了如何执行此操作。

```
using (WordprocessingDocument wordDoc = WordprocessingDocument.Open(wordFileNamePath, true))
{
    Body body = wordDoc.MainDocumentPart.Document.Body;
    IEnumerable<OpenXmlElement> clonedElements = body
        .Elements()
        .Select(e => e.CloneNode(true))
        .ToList();

    body.Append(clonedElements);
} 
```

您会看到我没有`Document`显式保存，因为这不是必需的，因为该`using`语句以及这些文档默认自动保存的事实。其次，我曾经`ToList()`在追加之前具体化集合。这是为了避免在枚举同时更改的元素时出现任何问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T21:19:33.383

为什么不会被破坏？您正在打开一个文档，获取所有子元素，并将它们写入同一个文档。我不确定那应该做什么。

# c# - ORA-06502: PL/SQL: 从 c# web 服务调用存储过程的数字或值错误

> ID：16069438
> 
> 赞同：2
> 
> 时间：2013-04-17T20:16:16.370
> 
> 标签：c#, web-services, data-access

我正在尝试编写一个调用 oracle 存储过程的 Web 服务。该过程有 2 个输入 - 一个字符串 (company_code) 和一个 int (客户代码)。它有2个输出参数；一个数字 (pout_addr_code) 和一个 varchar2 (pout_descr)。当我从 SQL Developer 运行此过程时，一切正常，并且两个值都按预期返回。当我从我的 C# Web 服务调用该过程时，我在执行时而不是在编译期间收到错误“Oracle.DataAccess.Client.OracleException: ORA-06502: PL/SQL: numeric or value error”。

如果我注释掉*cmd.ExecuteNonQuery()*和*return pout_addr_code.Value...*行，它将运行良好并输出我的测试字符串。

如果我从过程中删除 varchar2 输出并注释掉添加 pout_descr 参数的部分并注释掉*返回“我返回...”*它运行良好，包括从存储过程返回值。

因此，在我看来，问题在于当过程具有*OracleDbType.Varchar2行时执行**NonQuery*。使用 Oracle.DataAccess 引用在 C# 中添加输出参数时是否有其他定义方式？我发现[这篇文章](https://stackoverflow.com/questions/2077552/oracle-dataaccess-error-ora-06502-pl-sql-numeric-or-value-error-character-str)询问了类似的错误，但他的解决方案是*“在 C# 中将 VARCHAR2 的最大值指定为 32767”，*但我不知道你是如何做到的。

 **这是我的 C# 代码：

```
public string AutoPmtPost(string company_code, int customer_code)
    {
        string oradb = "Data Source=MySource; User Id=MyID; Password=MyPassword;";
        OracleConnection conn = new OracleConnection(oradb);
        conn.Open();
        OracleCommand cmd = new OracleCommand("USP_JEFF_TEST", conn);
        cmd.CommandType = CommandType.StoredProcedure;

        cmd.Parameters.Add("pin_company_code", OracleDbType.Varchar2, ParameterDirection.Input).Value = company_code;

        cmd.Parameters.Add("pin_customer_code", OracleDbType.Int32, ParameterDirection.Input).Value = customer_code;

        OracleParameter pout_addr_code = new OracleParameter("pout_addr_code", OracleDbType.Int32);
        pout_addr_code.Direction = ParameterDirection.Output;
        cmd.Parameters.Add(pout_addr_code);

        OracleParameter pout_descr = new OracleParameter("pout_descr", OracleDbType.Varchar2);
        pout_descr.Direction = ParameterDirection.Output;
        cmd.Parameters.Add(pout_descr);

        cmd.ExecuteNonQuery();
        //return pout_addr_code.Value.ToString();
        return "I returned something";
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T21:02:04.360

```
OracleParameter pout_descr = new OracleParameter("pout_descr", OracleDbType.Varchar2); 
```

应该

```
OracleParameter pout_descr = new OracleParameter("pout_descr", OracleDbType.Varchar2, 2000); 
```**

# go - 你如何在 go 的几行上链接命令？

> ID：16069442
> 
> 赞同：4
> 
> 时间：2013-04-17T20:16:26.187
> 
> 标签：go, chaining

我想以这种方式链接命令：

```
var cmdGroups = []*commands.CmdGroup {
    commands.MakeCmdGroup("foo", cmd1, cmd2, cmd3).AddConstraint(cmd1, cmd2).AddConstraint(cmd2, cmd1, cmd3),
    commands.MakeCmdGroup("bar", cmd1, cmd4).AddConstraint(cmd1, cmd4),
} 
```

出于 80 列长度的原因，我想将我的链分成几行，但 Go 不会让我编译这个：

```
var cmdGroups = []*commands.CmdGroup {
    commands.MakeCmdGroup("foo", cmd1, cmd2, cmd3)
            .AddConstraint(cmd1, cmd2)
            .AddConstraint(cmd2, cmd1, cmd3),
    commands.MakeCmdGroup("bar", cmd1, cmd4)
            .AddConstraint(cmd1, cmd4),
} 
```

我能做些什么 ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T20:28:12.040

正如 FUZxxl 指出的那样，您的问题是分号的自动插入。规范说：

> 当输入被分解为标记时，如果该行的最终标记为
> 
> *   标识符
> *   整数、浮点数、虚数、符文或字符串文字
> *   关键字 break、continue、fallthrough 或 return 之一
> *   运算符和分隔符之一 ++、-、)、] 或 }

你有一个函数调用，它算作 a `)`，所以在行尾添加了一个分号。

要规避自动分号转换，您可以通过以下方式之一编写调用：

使用`.`代替分号：

```
x.
Method(p1,p2,p3) 
```

在参数列表的开头而不是函数之前中断：

```
x.Method(
   p1,p2,p3, // , at the end is important to prevent semicolon insertion
) 
```

~~如果您不喜欢上述方法，您可以（从 go1.1 开始）将这些方法视为一等公民并临时创建可能更短的快捷方式：~~

 ~~```
f = x.Method
f(p1,p2,p3).f(p3,p4,p5) 
```~~ 

~~这个例子我想得还不够。`f(...).f(...)`当然不可能，因为`f`没有 member的返回值`f`。一将不得不重新分配`f`。所以你没有从中得到任何好处。~~

 ~~* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:25:58.293

我可能会写一些变体：

```
var cmdGroups = []*commands.CmdGroup{
                commands.MakeCmdGroup(
                        "foo", cmd1, cmd2, cmd3,
                ).AddConstraint(
                        cmd1, cmd2,
                ).AddConstraint(
                        cmd2, cmd1, cmd3,
                ),
                commands.MakeCmdGroup(
                        "bar", cmd1, cmd4,
                ).AddConstraint(cmd1, cmd4),
} 
```

然而，如此长的选择器操作符链在惯用代码中并不常见。（我认为标准库是惯用代码的非正式指南）。也许这种代码设计/结构可能存在一些弱点。~~

# internet-explorer - 隐藏的 IE 实例

> ID：16069445
> 
> 赞同：0
> 
> 时间：2013-04-17T20:16:31.780
> 
> 标签：internet-explorer, batch-file, windows-xp

我正在尝试从作为系统从调度程序启动的批处理脚本运行 Internet Explorer，同时在活动用户桌面上显示窗口。两条皱纹是：用户没有密码，用户名不一致。

解决此问题的最佳方法是什么？

我已经尝试了很多东西，我得到的最接近的是：

`PsExec.exe -s -i -l 'C:\path-to-iexplore.exe'`

从一个 cmd 窗口，这让我获得了一个以 SYSTEM 身份运行的进程，并显示了 GUI，但我需要与 -s （系统用户）标志相反的，或者能够找到并指定 -i （当前 shell。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T15:41:32.437

所以，经过多次试验和错误，我成功了——似乎由于某种原因，你必须调用 psexec 的嵌套实例。就我而言，将第二个命令放在它自己的批处理文件中是有意义的，如下所示：

`C:\path-to-psexec\PsExec.exe -s -i 0 "lock-screen.bat"`

(lock-screen.bat:) `C:\path-to-psexec\PsExec.exe -s -i 0 -d "C:\path-to-ie\iexplore.exe"`

-i 标志连接到一个会话，如果没有指定会话，它连接到当前 shell 的会话。如果单个用户登录，则该用户的会话号似乎为 0。要找出哪些会话处于活动状态，您可以使用第二个命令[- LoginSessions](http://technet.microsoft.com/en-us/sysinternals/bb896769)。

我不知道为什么我需要嵌套运行 PsExec，也许比我更聪明的人可以解释。

# python - 检查是否设置了外键上的对象

> ID：16069453
> 
> 赞同：1
> 
> 时间：2013-04-17T20:17:09.143
> 
> 标签：python, django

有这个代码：

```
class SomeModel(models.Model):
    pass

class OtherModel(models.Model):
    some_model = models.ForeignKey(SomeModel)

om = OtherModel()
if om.some_model:
    pass 
```

抛出的异常是：

```
models.DoesNotExist 
```

是否有一些很好的方法来检查是否设置了外键对象而不是 try...except 或 hasattr？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:21:45.927

```
om = OtherModel() 
```

'Just' 实例化一个 python 类。在访问属性之前使用模型的管理器保存关系，或将字段设置为 null=True

```
om = OtherModel.objects.create() 
```

看看[官方的经理文档](https://docs.djangoproject.com/en/dev/topics/db/managers/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:25:43.823

我认为使用 try...except 是最好的方法。此（无效）错误报告中提到了此问题：[https ://code.djangoproject.com/ticket/12708](https://code.djangoproject.com/ticket/12708)

# visual-c++ - 在桌面上渲染形状和文本（点击）

> ID：16069454
> 
> 赞同：1
> 
> 时间：2013-04-17T20:17:10.027
> 
> 标签：visual-c++, rendering, desktop-application, transparent, click-through

对于 Windows 7，将任意形状和文本直接渲染到桌面上的最简单方法是什么？

它必须具有以下属性：

1) 可见且始终位于顶部
3) 半透明
2) 单击并输入，就好像对象不存在一样

一些值得注意的例子包括从渲染帧速率的简单 Fraps 到具有大量功能的复杂 Rainmeter。

EDIT0：我查看了 Rainmeter 源代码，但我仍然不知道它是如何渲染对象的......

EDIT1：[Window Hud Behavior（通过点击，不能最小化）](https://stackoverflow.com/questions/9314600/window-hud-behavior-pass-through-clicks-cant-be-minimized)（这样的解决方案似乎非常严格，必须有一种方法可以像 Rainmeter 一样自由地渲染东西？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-24T19:46:01.310

我仍在努力，但这是其中的一部分：

```
#include <algorithm>
#include <Windows.h>
#include <stdlib.h>
#include <iostream>
#include <sstream>
#include <conio.h>
#include <iomanip>
#include <sstream>
#include <fstream>
#include <stdio.h>
#include <cstdlib>
#include <string>
#include <memory>
#include <cstdio>            
#include <glut.h>
#include <io.h>

#using <mscorlib.dll>
#using <System.dll>

using namespace System;
using namespace std;

#pragma comment(lib, "wininet.lib")
#pragma comment (lib, "Urlmon.lib")
#pragma comment(linker, "/subsystem:windows /ENTRY:mainCRTStartup")

HINSTANCE hInstance;
POINT Mouse;
HWND hwnd;
RECT rect;
HDC dc;

float Size = 100;
float angle = 0;
bool Dirty = false;
char TEX;
int posX = 0;
int posY = 0;
int storedDC;

void GetDesktopResolution(int& w, int& h){
    RECT desktop;
    const HWND hDesktop = GetDesktopWindow();
    GetWindowRect(hDesktop, &desktop);
    w = desktop.right;
    h = desktop.bottom;
}

void EX(){
    delete hInstance;
    delete hwnd;
    exit(0);
}

void Keys(){
    if (GetAsyncKeyState(VK_ESCAPE)){
        exit(0);
    }

    if (GetAsyncKeyState(VK_LBUTTON) && GetAsyncKeyState(VK_CONTROL)){

    }
}

void Draw(){
    int h;
    int w;

    //Declair Desktop Size
    GetDesktopResolution(w, h);

    angle += 0.1f;

    if (angle >= 2 * 3.141592f){
        angle -= 2 * 3.141592f;
    }

    GetCursorPos(&Mouse);
    if (Dirty == true){
        rect = { 0, 0, w, h };
        RedrawWindow(hwnd, &rect, NULL, RDW_INVALIDATE | RDW_ERASE | RDW_UPDATENOW);

        posX = Mouse.x;
        posY = Mouse.y;

        RedrawWindow(hwnd, &rect, NULL, RDW_INVALIDATE | RDW_ERASE | RDW_UPDATENOW);
        Dirty = false;
    }

    dc = GetDC(hwnd);
    storedDC = SaveDC(dc);

    //DEFAULT_CHARSET - ANSI_CHARSET
    HFONT FMain = CreateFont(36, 20, -300, 0, FW_DONTCARE, FALSE, TRUE, FALSE, DEFAULT_CHARSET, OUT_OUTLINE_PRECIS,
        CLIP_DEFAULT_PRECIS, CLEARTYPE_QUALITY, VARIABLE_PITCH, TEXT("Times New Roman"));
    SetTextColor(dc, RGB(255, 255, 255));
    SetBkColor(dc, RGB(0, 255, 0));
    SelectObject(dc, FMain);
    TextOut(dc, 15, 15, L"This is what the program does!", 30);

    RedrawWindow(hwnd, &rect, NULL, RDW_NOERASE | RDW_INVALIDATE | RDW_UPDATENOW);

    RestoreDC(dc, storedDC);
    ReleaseDC(hwnd, dc);
}

int main(int argc, char **argv){
    int h;
    int w;

    //Declair Desktop Size
    GetDesktopResolution(w, h);

    // find Program Manager
    hwnd = FindWindowEx(GetDesktopWindow(), 0, L"Progman", L"Program Manager");
    // find SHELLDLL_DefView
    hwnd = FindWindowEx(hwnd, 0, L"SHELLDLL_DefView", 0);
    // find Desktop Folder
    hwnd = FindWindowEx(hwnd, 0, L"SysListView32", L"FolderView");

    if (hwnd == NULL){
        MessageBox(NULL, L"Could not initiate window!", L"ERROR!", MB_OK);
        EX();
    }

    while (1){
        Keys();
        Draw();
    }

    //Remove the drawing
    rect = { Mouse.x - 50, Mouse.y - 50, Mouse.x + 50, Mouse.y + 50 };
    InvalidateRect(hwnd, &rect, true);

    delete hInstance;
    delete hwnd;

    return 0;
} 
```

# java - 在java中将docx转换为PDF的问题

> ID：16069467
> 
> 赞同：0
> 
> 时间：2013-04-17T20:17:44.320
> 
> 标签：java, pdf, docx, docx4j

我正在尝试将 word docx 文件转换为 pdf 文件，全部使用 java，并且没有任何用户交互。

到目前为止，这是我的代码，我正在使用 docx4j 库。

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package richard.fileupload;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;

import org.docx4j.convert.out.pdf.PdfConversion;
import org.docx4j.convert.out.pdf.viaXSLFO.PdfSettings;
import org.docx4j.openpackaging.packages.WordprocessingMLPackage;
/**
 *
 * @author Richard
 */
public class pdfConverter {
        public static void main(String[] args) {
        createPDF();
        createPDF();
    }

    private static void createPDF() {
        try {
            long start = System.currentTimeMillis();

            // 1) Load DOCX into WordprocessingMLPackage
            InputStream is = new FileInputStream(new File(
                    "D:/HelloWorld.docx"));
            WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage
                    .load(is);

            // 2) Prepare Pdf settings
            PdfSettings pdfSettings = new PdfSettings();

            // 3) Convert WordprocessingMLPackage to Pdf
            OutputStream out = new FileOutputStream(new File(
                    "D:/HelloWorld.pdf"));
            PdfConversion converter = new org.docx4j.convert.out.pdf.viaXSLFO.Conversion(
                    wordMLPackage);
            converter.output(out, pdfSettings);

            System.err.println("Generate pdf/HelloWorld.pdf with "
                    + (System.currentTimeMillis() - start) + "ms");

        } catch (Throwable e) {
            e.printStackTrace();
        }
    }

} 
```

但是，当我尝试运行时出现此错误，它编译得很好

```
run:
java.lang.NoClassDefFoundError: org/apache/log4j/Logger
    at org.docx4j.openpackaging.Base.<clinit>(Base.java:42)
    at richard.fileupload.pdfConverter.createPDF(pdfConverter.java:32)
    at richard.fileupload.pdfConverter.main(pdfConverter.java:21)
Caused by: java.lang.ClassNotFoundException: org.apache.log4j.Logger
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    ... 3 more
java.lang.NoClassDefFoundError: Could not initialize class org.docx4j.openpackaging.packages.WordprocessingMLPackage
    at richard.fileupload.pdfConverter.createPDF(pdfConverter.java:32)
    at richard.fileupload.pdfConverter.main(pdfConverter.java:22)
BUILD SUCCESSFUL (total time: 0 seconds) 
```

知道错误是什么，这是什么原因？

编辑我现在收到此错误

```
java.lang.NoClassDefFoundError: org/apache/fop/apps/FopFactory
    at org.docx4j.convert.out.pdf.viaXSLFO.Conversion.output(Conversion.java:231)
    at richard.fileupload.pdfConverter.createPDF(pdfConverter.java:43)
    at richard.fileupload.pdfConverter.main(pdfConverter.java:22) 
```

# .net - 如何使用 SevenZipSharp 创建压缩的 SFX 文件？

> ID：16069470
> 
> 赞同：3
> 
> 时间：2013-04-17T20:17:45.613
> 
> 标签：.net, vb.net, visual-studio, 7zip, sevenzipsharp

我将了解如何使用 SevenZipSharp 库创建 SFX。

首先，我需要说我找不到任何属性来设置压缩级别，以及所有这些。

当我尝试制作文件的 SFX 时，我收到此错误：

```
"Object reference not set to an instance of an object." 
```

如果我尝试制作文件夹的 SFX，我会收到此错误：

```
"Access to the path 'C:\test' is denied." 
```

（但不是真的，我是管理员，我已经用更多可用的文件夹对其进行了测试......）

这是我试图理解所有这些的完整课程......：

```
Imports SevenZip

Public Class Form1

Dim dll As String = "7z64.dll"

Private Function SevenZipSharp_Compress_SFX(ByVal Input_DirOrFile As String, _
                                            ByVal OutputFileName As String) As Boolean
    Try
        ' Set library path
        SevenZipCompressor.SetLibraryPath(dll)

        ' Create compressor
        Dim Compressor As SevenZipSfx = New SevenZipSfx(SfxModule.Default)

        ' Set SFX parameters
        ' ¿?

        ' Start compression
        Compressor.MakeSfx(Input_DirOrFile, OutputFileName)

    Catch ex As Exception
        'Return False ' File not compressed
        Throw New Exception(ex.Message)
    End Try

    Return True ' File compressed

End Function

Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
    SevenZipSharp_Compress_SFX("C:\test\file.bat", "C:\7zSFX.exe")
End Sub

End Class 
```

> 更新：

@给大家：

请我向至少会回答我问题的人祈祷，至少您曾经创建过 SFX SevenZipSharp 告诉我我做错了什么以及如何解决它，而不是回答说它们是用户权限问题，请阅读评论.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-03T08:13:53.543

您可能正在使用 Windows 8，因此为了让您的应用程序有足够的权限在 (C:) 分区中进行写入修改，即使您是管理员，您也应该在“以管理员身份”模式下运行应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-03T23:55:29.470

看起来可能对论点应该是什么感到困惑。以下代码与[codeplex](http://sevenzipsharp.codeplex.com/SourceControl/changeset/view/79962)上的最新 SevenZipSharp 代码一起为我工作。

```
 Private Sub button1_Click(ByVal sender As Object, ByVal e As EventArgs)
        Dim compressor As SevenZipSfx = New SevenZipSfx("7z.sfx")
        compressor.MakeSfx("C:\Temp\cc_seal.7z", "C:\Temp\sfxseal.exe")
    End Sub 
```

我尝试使用 SevenZipSfx(SfxModule.Default) 就像在您的示例中一样，但是没有设置模块名称，我相信这就是“对象引用未设置为对象的实例”错误的来源，因为我做到了这个：

```
 Private Sub button1_Click(ByVal sender As Object, ByVal e As EventArgs)
        Dim compressor As SevenZipSfx = New SevenZipSfx(SfxModule.Default)
        compressor.ModuleFileName = "7z.sfx"
        compressor.MakeSfx("C:\Temp\cc_seal.7z", "C:\Temp\sfxseal.exe")
    End Sub 
```

它也对我有用，没有错误。取出 ModuleFileName 行，我遇到了和你一样的崩溃。

另请注意，compressor.MakeSfx 第一个参数需要是 .7z 文件而不是 .bat 文件。它会“工作”，但是当您尝试运行 sfx.exe 时，它​​会因为它不是有效的 7zip 文件而崩溃。所以你需要先压缩你的文件/目录。

确保 7z.sfx 在您的应用程序目录中，或提供它的路径（它在 codeplex 源下载中）

我首先使用“7zxSD_All.sfx”文件进行了尝试，它提取了该文件，然后 Windows 7 给出了关于它没有正确安装的错误（我假设 Windows 7 认为它是一个安装文件而不是自解压文件）。“7z.sfx”虽然有效。

# c++ - 对角展平矩阵的邻域索引计算

> ID：16069474
> 
> 赞同：4
> 
> 时间：2013-04-17T20:17:58.653
> 
> 标签：c++, c, multidimensional-array, indexing, diagonal

我有一个沿对角线存储在平面缓冲区中的二维矩阵。例如，一个 4x4 矩阵的索引会像这样分散：

```
 0   2   5   9
 1   4   8  12
 3   7  11  14
 6  10  13  15 
```

使用这种表示，在给定原始索引和 X/Y 偏移量的情况下，计算相邻元素索引的最有效方法是什么？例如：

```
// return the index of a neighbor given an offset
int getNGonalNeighbor(const size_t index,
                      const int x_offset,
                      const int y_offset){
    //...
}

// for the array above:
getNGonalNeighbor(15,-1,-1); // should return 11
getNGonalNeighbor(15, 0,-1); // should return 14
getNGonalNeighbor(15,-1, 0); // should return 13
getNGonalNeighbor(11,-2,-1); // should return 1 
```

我们在这里假设永远不会发生溢出并且没有回绕。

我有一个涉及很多[三角数的解决方案](http://en.wikipedia.org/wiki/Triangular_number)和三角根计算的解决方案。它还包含很多分支，如果可能的话，我更愿意用代数代替（这将在分散控制流很昂贵的 GPU 上运行）。我的解决方案有效，但非常冗长。我觉得必须有一种更简单且计算密集度更低的方式来做到这一点。

如果有人可以为这个特定的问题/表示命名，也许会对我有所帮助。

如果有人感兴趣，我可以发布我的完整解决方案，但正如我所说，对于这样一个简单的任务来说，它很长而且相对复杂。简而言之，我的解决方案是：

*   将原始索引转换为更大的三角矩阵以避免处理 2 个三角形（例如 13 将变为 17）

对于 4x4 矩阵，这将是：

```
0   2   5   9   14  20  27
1   4   8   13  19  26  
3   7   12  18  25  
6   11  17  24  
10  16  23
15  22  
21 
```

*   使用偏移量的曼哈顿距离和索引的三角根计算此表示中邻居对角线的索引。
*   使用偏移量计算邻居在此对角线中的位置
*   通过删除填充转换回原始表示。

出于某种原因，这是我能想到的最简单的解决方案。

**编辑：**

*有循环来累积偏移量*：

我意识到考虑到三角形数字的属性，将矩阵分成两个三角形会更容易（让我们称之为 0 到 9 的“上三角形”和 10 到 15 的“下三角形”）并在里面有一个带有测试的循环通过在上三角形中加一并在下三角形中减去一来累积偏移量（如果有意义的话）。但是对于我的解决方案，必须不惜一切代价避免循环，尤其是行程计数不平衡的循环（再次，对 GPU*非常*不利）。

所以**我更多地寻找代数解决方案而不是算法解决方案**。

*构建查找表：*

同样，由于 GPU，最好避免构建查找表并在其中进行随机访问（非常昂贵）。代数解是优选的。

*矩阵的性质*：

*   矩阵的大小是已知的。
*   现在我只考虑方阵，但矩形矩阵的解决方案也很好。
*   正如我的示例中的函数名称所暗示的那样，将解决方案扩展到 N 维体积（因此 N 边展平）也将是一个很大的优势。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:41:03.520

**查表**

```
#include <stdio.h>

#define SIZE 16
#define SIDE  4  //sqrt(SIZE)

int table[SIZE];
int rtable[100];// {x,y| x<=99, y<=99 }

void setup(){
    int i, x, y, xy, index;//xy = x + y

    x=y=xy=0;
    for(i=0;i<SIZE;++i){
        table[i]= index= x*10 + y;
        rtable[x*10+y]=i;
        x = x + 1; y = y - 1;//right up
        if(y < 0 || x >= SIDE){
            ++xy;
            x = 0;
            y = xy;;
            while(y>=SIDE){
                ++x;
                --y;
            }
        }
    }
}
int getNGonalNeighbor(int index, int offsetX, int offsetY){
    int x,y;
    x=table[index] / 10 + offsetX;
    y=table[index] % 10 + offsetY;
    if(x < 0 || x >= SIDE || y < 0 || y >= SIDE) return -1; //ERROR
    return rtable[ x*10+y ];
}

int main() {
    int i;
    setup();
    printf("%d\n", getNGonalNeighbor(15,-1,-1));
    printf("%d\n", getNGonalNeighbor(15, 0,-1));
    printf("%d\n", getNGonalNeighbor(15,-1, 0));
    printf("%d\n", getNGonalNeighbor(11,-2,-1));
    printf("%d\n", getNGonalNeighbor(0, -1,-1));

    return 0;
} 
```

不要使用表格版本。

```
#include <stdio.h>

#define SIZE 16
#define SIDE  4

void num2xy(int index, int *offsetX, int *offsetY){
    int i, x, y, xy;//xy = x + y

    x=y=xy=0;
    for(i=0;i<SIZE;++i){
        if(i == index){
            *offsetX = x;
            *offsetY = y;
            return;
        }
        x = x + 1; y = y - 1;//right up
        if(y < 0 || x >= SIDE){
            ++xy;
            x = 0;
            y = xy;;
            while(y>=SIDE){
                ++x;
                --y;
            }
        }
    }
}
int xy2num(int offsetX, int offsetY){
    int i, x, y, xy, index;//xy = x + y

    x=y=xy=0;
    for(i=0;i<SIZE;++i){
        if(offsetX == x && offsetY == y) return i;
        x = x + 1; y = y - 1;//right up
        if(y < 0 || x >= SIDE){
            ++xy;
            x = 0;
            y = xy;;
            while(y>=SIDE){
                ++x;
                --y;
            }
        }
    }
    return -1;
}
int getNGonalNeighbor(int index, int offsetX, int offsetY){
    int x,y;

    num2xy(index, &x, &y);

    return xy2num(x + offsetX, y + offsetY);
}

int main() {
    printf("%d\n", getNGonalNeighbor(15,-1,-1));
    printf("%d\n", getNGonalNeighbor(15, 0,-1));
    printf("%d\n", getNGonalNeighbor(15,-1, 0));
    printf("%d\n", getNGonalNeighbor(11,-2,-1));
    printf("%d\n", getNGonalNeighbor(0, -1,-1));

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T00:22:28.417

实际上，我已经在我的代码中的其他地方拥有了解决它的元素。正如 BLUEPIXY 的解决方案所暗示的那样，我正在使用分散/聚集操作，我已经为布局转换实现了这些操作。

该解决方案基本上重建了`(x,y)`矩阵中给定元素的原始索引，应用索引偏移并将结果转换回转换后的布局。它将正方形分成 2 个三角形，并根据它属于哪个三角形来调整计算。

这是一个几乎完全代数转换：它不使用循环和表查找，内存占用少，分支少。代码可能可以进一步优化。

这是代码的草稿：

```
#include <stdio.h>
#include <math.h>

// size of the matrix
#define SIZE 4

// triangle number of X
#define TRIG(X) (((X) * ((X) + 1)) >> 1)
// triangle root of X
#define TRIROOT(X) ((int)(sqrt(8*(X)+1)-1)>>1);

// return the index of a neighbor given an offset
int getNGonalNeighbor(const size_t index,
                      const int x_offset,
                      const int y_offset){
    // compute largest upper triangle index
    const size_t upper_triangle = TRIG(SIZE);

    // position of the actual element of index
    unsigned int x = 0,y = 0;

    // adjust the index depending of upper/lower triangle.
    const size_t adjusted_index = index < upper_triangle ?
                index :
                SIZE * SIZE - index - 1;

    // compute triangular root
    const size_t triroot = TRIROOT(adjusted_index);
    const size_t trig = TRIG(triroot);
    const size_t offset = adjusted_index - trig;

    // upper triangle
    if(index < upper_triangle){
        x = offset;
        y = triroot-offset;
    }
    // lower triangle
    else {
        x = SIZE - offset - 1;
        y = SIZE - (trig + triroot + 1 - adjusted_index);
    }

    // adjust the offset
    x += x_offset;
    y += y_offset;

    // manhattan distance
    const size_t man_dist = x+y;

    // calculate index using triangular number
    return TRIG(man_dist) +
            (man_dist >= SIZE ? x - (man_dist - SIZE + 1) : x) -
            (man_dist > SIZE ? 2* TRIG(man_dist - SIZE) : 0);
}

int main(){
    printf("%d\n", getNGonalNeighbor(15,-1,-1)); // should return 11
    printf("%d\n", getNGonalNeighbor(15, 0,-1)); // should return 14
    printf("%d\n", getNGonalNeighbor(15,-1, 0)); // should return 13
    printf("%d\n", getNGonalNeighbor(11,-2,-1)); // should return 1
} 
```

输出确实是：

```
11
14
13
1 
```

如果你认为这个解决方案看起来过于复杂和低效，我提醒你，这里的目标是 GPU，与内存访问相比，计算成本几乎为零，并且所有索引计算都是使用大规模并行架构同时计算的。

# r - 将另一列插入数据框并增加每行的值

> ID：16069475
> 
> 赞同：1
> 
> 时间：2013-04-17T20:18:03.577
> 
> 标签：r

我有这个数据框：

```
 head(df,10)
     V1   V2   V3   V4   V5   V6   V7    V8    V9  V10
3  36.4 13.1 13.9 36.6 9.26 57.9 28.0 34.96 26049 3492
4  31.1 11.2 12.6 45.1 7.81 48.8 25.9 37.85 17515 2754
5  33.2 13.4 13.2 40.3 8.69 54.3 26.9 35.67 23510 3265
6  34.0 12.8 13.7 39.4 8.77 54.8 26.5 35.19 25151 3305
7  32.7 12.4 13.6 41.3 8.49 53.0 25.9 35.97 25214 3201
8  33.4 13.7 12.5 40.3 8.76 54.7 27.1 36.50 23943 3391
9  35.2 13.8 13.5 37.5 9.20 57.5 27.8 33.08 25647 3385
10 34.6 14.9 14.9 35.6 9.35 58.4 27.8 35.81 27324 3790
11 30.4 13.3 13.0 43.3 8.29 51.8 24.9 38.31 25178 2881
12 32.0 13.3 14.0 40.7 8.58 53.6 26.1 35.97 25677 3162 
```

我有 DateTime 是这样的：

```
DateTime<-Sys.time() 
```

我想在这个 df 中插入另一列，并将每行的 DateTime 值增加 30 秒。

我这样做：

```
for (i in 1:nrow(df)) {
 df[1,]$DateTime<-DateTime
 DateTime<-DateTime+30
} 
```

这个循环没有做我想做的事情。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:44:12.927

```
df$DateTime <- Sys.time() + 30 * (seq_len(nrow(df))-1) 
```

# java - 如何实现深度优先搜索，在 Java 中返回最短路径长度

> ID：16069478
> 
> 赞同：1
> 
> 时间：2013-04-17T20:18:06.837
> 
> 标签：java, graph, path, nodes, depth-first-search

我目前正在编写一个程序，该程序获取节点图并返回特征路径长度（从一个节点到每个其他节点的路径长度平均然后为每个节点重复并再次平均）。我已经完成了所有其他工作，但我不确定如何实现节点的深度优先搜索以找到从一个节点到另一个节点的最短路径。这就是我到目前为止所拥有的。

```
 int dist = 0;
        List<Node> path = new ArrayList<Node>();
        List<Node> shrtPath = new ArrayList<Node>();
        Node curNode = rtNode;
        if (rtNode == goalNode) {
            return dist;
        }
        path.add(curNode);
        for (int l = 0; l < rtNode.connections.size(); l++) {
            Node tempNode = new Node();
            curNode = rtNode.connections.get(l);
            for (int i = 0; i < curNode.connections.size(); i++) {
                tempNode = curNode.connections.get(i);
                path.add(tempNode);
                if (curNode.connections.get(i) == goalNode) {
                    if (path.size() < shrtPath.size()) {
                        shrtPath.clear();
                        shrtPath = path;
                    }
                }
            }
        }
        dist = shrtPath.size();
        return dist; 
```

我知道这是不完整的，但我不确定从这里去哪里，或者我是否朝着正确的方向前进。我知道我需要能够搜索根节点及其连接，但我不确定如何遍历连接的连接等等。我也意识到我必须标记访问的节点，因为我的 Node 类中有一个布尔值，因为我还没有实现它。这也是我的 Node 类。

```
import java.util.ArrayList;
import java.util.List;

public class Node {

    List <Node> connections = new ArrayList<Node>();
    int cons = 0;
    boolean hub;
    boolean visited = false;

    public Node() {
        hub = false;

    }

    public void setNbs(Node nb1, Node nb2) {
        connections.add(nb1);
        connections.add(nb2);
    }

    public boolean addExtraCon(Node con) {
        for (int i = 0; i < connections.size(); i++) {
            if(connections.get(i) == con) {
                return false;
            }
        }
        connections.add(con);
        return true;
    }

    public boolean makeHub() {
        hub = true;
        return hub;
    }

    public int numberOfConnections() {
        cons = connections.size();
        return cons;
    }

    public boolean isHub() {
        if (hub == true) {
            return true;
        }
        return false;
    }

} 
```

我希望这有助于任何和所有的帮助，非常感谢。提前致谢。

# google-apps-script - 如何使用 AdWords 脚本在 google docs 电子表格的特定单元格中填充 adwords 数据？

> ID：16069480
> 
> 赞同：0
> 
> 时间：2013-04-17T20:18:08.527
> 
> 标签：google-apps-script, google-sheets, google-ads-api

我没有编程背景，刚开始学习 JavaScript 基础知识，因此我可以流利地创建自定义 Google AdWords 脚本来帮助我自动化客户报告。我花了很多时间反复试验，但还没有弄清楚这个问题（这对程序员来说可能超级容易）：

我正在尝试使用帐户级别数据填充我制作的电子表格（这是缩短的链接：http: [//goo.gl/wLAAx](http://goo.gl/wLAAx)），以便我可以计算帐户的运行率。我要做的就是运行一个每天早上运行的脚本，该脚本将在电子表格中添加一个新行，其中包含昨天的日期，并填充其各自的数据，如点击次数、展示次数、费用和转化次数。

提前感谢您的任何帮助和信息！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T21:21:30.193

这是一个可以执行您想要的操作的脚本（它使用稍微不同的电子表格，请查看）。此外，该脚本仅读取电子表格中的前 365 行，因此它会在一年内中断。

将来，您可能需要查看[https://developers.google.com/adwords/scripts](https://developers.google.com/adwords/scripts)以获取面向脚本的资源和社区

```
function main() {
  var sheet = SpreadsheetApp.openByUrl(
    "https://docs.google.com/spreadsheet/ccc?key=0Aj_Bw31w9s7LdEdLMllQMnZfbW52c3BvcTh0ekVBQ3c#gid=0").getActiveSheet();
  var emptyRow = findEmptyRow(sheet);

  var yesterday = new Date(new Date().getTime() - (24 * 3600 * 1000));

  var range = sheet.getRange(emptyRow + 1, 1, 1, 10);

  var row = range.getValues();
  row[0][0] = yesterday;
  row[0][1] = MONTHS[yesterday.getMonth()];
  row[0][2] = DAYS_OF_WEEK[yesterday.getDay()];

  var stats = AdWordsApp.report("SELECT Clicks, Impressions, Cost, Conversions " +
    "FROM ACCOUNT_PERFORMANCE_REPORT DURING YESTERDAY")
    .rows()
    .next();
  row[0][3] = stats["Clicks"];
  row[0][4] = stats["Impressions"];
  row[0][7] = stats["Cost"];
  row[0][8] = stats["Conversions"];
  range.setValues(row);
}

function findEmptyRow(sheet) {
  var dates = sheet.getRange(1, 1, 365, 1).getValues();
  for (var emptyDate = 0; emptyDate < dates.length; emptyDate ++) {
    if (dates[emptyDate][0].length == 0) {
      return emptyDate;
    }
  }
} 
```

# drupal-7 - Drupal 7.17 - 我必须在安装后删除这些文件吗？

> ID：16069481
> 
> 赞同：1
> 
> 时间：2013-04-17T20:18:10.757
> 
> 标签：drupal-7, installation

我目前管理的一个站点上有 Drupal 7.17。我注意到网站根目录中有以下文件：

```
install.php
CHANGELOG.txt
INSTALL.txt
INSTALL.mysql.txt
INSTALL.pgsql.txt
LICENSE.txt
MAINTAINERS.txt
UPGRADE.txt 
```

研究这个，告诉我，从 Drupal 7.16 开始，他们修复了一个安全问题，该问题允许任意代码在 install.php 中运行，这将允许重新安装 Drupal 以供他人运行。但基本上，我想知道这些文件中的任何一个（如果留在服务器根目录中）是否会导致 Drupal 7.17 出现问题？出于安全原因，我是否必须删除这些文件？或者这在 Drupal 7.17 中不再是安全风险了吗？

我知道我们不应该删除该`upgrade.php`文件，而只是对这些文件的其余部分感到好奇。

谢谢，这可能是一个愚蠢的问题，但还是觉得有必要问一下。通常我在网站上安装软件时会删除这些文件，但不确定 Drupal 如何使用和/或滥用这些文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-22T06:38:39.680

根据 Drupal 手册中的文档“<a href="https://drupal.org/upgrade/finished" rel="nofollow">完成升级”（适用于升级和安装）：

```
The last step in an upgrade is to delete or move the following files from your site:

install.php
CHANGELOG.txt
INSTALL.txt
INSTALL.mysql.txt
INSTALL.pgsql.txt
INSTALL.sqlite.txt
LICENSE.txt
MAINTAINERS.txt
UPGRADE.txt 
```

明确一点：唯一要删除的 PHP 文件是“install.php”（即，一定要保留“upgrade.php”和所有其他 PHP 文件）。当您删除 TXT 文件时，请务必保留“robots.txt”，因为它被搜索引擎使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T04:37:51.730

你不应该删除任何文件。如果你真的想，你可以删除各种 txt 文件。如果您担心安全性，一个更好的解决方案是不要让文件通过 Web 服务器访问。Drupal 仅使用 index.php 文件来提供内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-08T18:06:47.873

我很想听听关于这个问题的更新和最近的想法，这就是为什么......

我刚刚使用一个新更新的 Drupal 站点到**Drupal 8.9.20**，以没有管理员权限的登录用户身份运行 Open Social 发行版。这是我的**活跃生产**网站！

我删除了一个节点（新闻文章）我试图从一个拒绝连接他们的一些元数据的网站嵌入，即：图像#1，在删除链接上提交后，浏览器切换到 install.php，就像你知道文档根目录中的站点。

看到这一点我当然很震惊，在考虑到用户可能会得到的甚至是无辜的回应导致他们重新安装**他们的应用程序**之后，这当然可能非常危险。

因此，自从上次对此的回复引用了 2014 年的 Drupal 版本以来，我只是想知道您在当今时代对最新建议的看法！

谢谢

# asp.net - Visual Studio 2010 对话框停止自动构建

> ID：16069492
> 
> 赞同：1
> 
> 时间：2013-04-17T20:18:34.090
> 
> 标签：asp.net, visual-studio-2010, build-automation

我正在开发一个使用 NAnt 自动构建的项目。自动构建包括清理机器的 NAnt 任务，包括删除和重新创建虚拟目录、清除 VSWebCache 等。一旦机器被重置，它会尝试使用以下命令编译站点：

```
<exec program="${visualstudio.install.dir}\devenv.com" commandline="SolutionFile.sln" failonerror="true"/> 
```

问题是此时自动构建锁定。

如果我以交互方式打开 .sln 文件，首先发生的事情是 Visual Studio 会用一个对话框提示我。我怀疑当我运行 NAnt 脚本时这个对话框正在“打开”（不可见），我无法单击它继续。

对话框消息是：

```
Microsoft Visual Studio

The web (URL) is currently configured for use with ASP.NET 1.1\.  Web project (name) is targeting ASP.NET 4.0; if not configured some features may make incorrect assumptions, and pages designed with the tool may not render correctly.

Would you like the site to be configured for use with ASP.NET 4.0? 
```

事实上，我的机器上有 3 个不同版本的 .NET——我从事多个项目。我无法提前配置站点，因为构建脚本无论如何都会破坏我的配置。我想我需要的是一种自动接受对话框的方式（就像我单击了“是”按钮一样），或者是一个 NAnt 任务，它将自动将 vdir 设置为 ASP.NET 4.0 应用程序。

我确实可以随意修改构建脚本，但我不能简单地删除重置机器的部分——我们的构建框与其他项目共享，我们必须在运行我们的之前将所有内容重置为已知的良好状态编译。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:26:29.127

直接使用MSBUILD，不要使用devenv。它是完整的 IDE，您只需要构建即可。

# python - 如何获取 s 子集总和以打印出它使用的整数（python）

> ID：16069495
> 
> 赞同：0
> 
> 时间：2013-04-17T20:18:38.513
> 
> 标签：python, subset-sum

所以这是我到目前为止的代码。如果总和存在，它会起作用并返回true，但我似乎无法找到一种方法来打印出它用来查找总和的整数。有没有办法我可以重新编写它以使其与 true 一起做到这一点，或者我应该如何编写代码以便它可以做到这一点？

```
from itertools import combinations

def com_subset_sum(seq, target):
    if target == 0 or target in seq:
        return True

    for r in range(2, len(seq)):
        for subset in combinations(seq, r):
            if sum(subset) == target:
                return True
    return False 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:23:40.840

只是`print`用来查看它的内容：

例子：

```
from itertools import combinations

def com_subset_sum(seq, target):
    if target == 0 or target in seq:
        return True

    for r in range(len(seq),1,-1):
        for subset in combinations(seq, r):
            if sum(subset) == target:
                print subset
                return True
    return False

print com_subset_sum([1,3,5,1,6,8,7],10) 
```

**输出：**

```
(1, 3, 5, 1)
True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:56:46.680

怎么样的东西

```
def ssum(numbers, target):
    return [x for r in xrange(2,len(numbers)) for x in combinations(numbers,r) if sum(x)==target] 
```

# java - JRE如何知道发生异常的代码行号？

> ID：16069496
> 
> 赞同：5
> 
> 时间：2013-04-17T20:18:44.687
> 
> 标签：java

考虑以下异常打印

```
java.util.NoSuchElementException
    at java.util.StringTokenizer.nextToken(StringTokenizer.java:332)
    at com.infoaxe.mr.homefeed.ReduceTwo.reduce(MapReduce.java:290) 
```

由于 Java 是一种编译语言，并且在 JVM 中运行的是字节码而不是源代码本身，所以异常如何知道它发生在哪一行？上述情况下的示例第 332 行？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-17T20:20:38.350

仅仅是因为编译器在生成的字节码中包含了行号。如果您愿意，有一些`-g` [选项](http://docs.oracle.com/javase/6/docs/technotes/tools/windows/javac.html#options)（在 Oracle javac 编译器中）允许关闭它。

# c# - C# 中业务对象的通用历史管理

> ID：16069498
> 
> 赞同：0
> 
> 时间：2013-04-17T20:18:47.823
> 
> 标签：c#, history

我想在我的 Web API 应用程序中实现类似的东西：

*   每个修改数据的事务都应该被“记录”
*   日志应该在业务层完成，并且可以存储在当前存储数据的常规 SQL 数据库中，也可以存储在某种 NoSQL 数据库中。
*   日志文件中的每个事务基本上都存储了谁执行了事务、何时、什么事务以及旧/新数据。
*   这可用于查看对象的更改历史记录，并有助于实现撤消/回滚。

我的问题是：

*   这是否作为库/框架存在于某处？
*   这个有名字吗？
*   有没有我遗漏的明显缺陷？

问候，丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:19:53.503

如果您使用的是 DbContext，在这种情况下，您可以覆盖*SaveChanges*方法。像这样：

```
public override int SaveChanges()
{    
    foreach (var entityState in ChangeTracker.Entries())
    {
        // loggin here
    }
    return base.SaveChanges();
} 
```

或者您可以使用[EFTracingProvider](http://efwrappers.codeplex.com/)

# ajax - 单页应用程序和开放图

> ID：16069501
> 
> 赞同：11
> 
> 时间：2013-04-17T20:18:55.747
> 
> 标签：ajax, facebook, facebook-opengraph, underscore.js, single-page-application

我正在编写一个使用下划线模板的 SPA。该应用程序搜索并评价音乐专辑并通过 ajax 返回结果。如果 facebook 打开图元标记不能动态更改，并且无论搜索结果如何，页面的 url 都是恒定的，我该如何制作它以便用户可以分享他们对某个专辑的评分。

IE）

```
<meta property="fb:app_id"      content="118454308341351" /> 
<meta property="og:url"         content="http://www.appurl.com" /> 
<meta property="og:title"       content="Fleetwood Mac's Rumors" /> 
<meta property="og:image"       content="AppImg.jpg" /> 
```

并更新这些属性以反映给定的搜索结果。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T21:13:15.550

我处理这个问题的方法是创建一个动态页面，用作我的打开图形对象，它只是从 url 参数填充并使用元重定向重定向回我的 SPA。

`<meta http-equiv="refresh" content="0;URL=http://YOUR_WEBSITE_WITH_DYNAMIC_CONTENT">`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-07-23T21:59:54.270

感谢本教程，我找到了一个解决方案：[https ://speakerdeck.com/sienatime/facebook-sharing-for-single-page-apps?slide=15](https://speakerdeck.com/sienatime/facebook-sharing-for-single-page-apps?slide=15)

`user-agent`如果http 请求中包含“facebookexternalhit”，我只发送元标记。

这是带有 node 和 express 的后端的一些代码：

```
app.get('/', (req,res) => {
  if(req.header('user-agent').includes('facebookexternalhit'){
    res.send(`
      <meta property="og:title" content="The Slits' Cut" />
    `);
  } else {
    res.sendFile(index.html);
  }  
}) 
```

您也可以为此编写自己的中间件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-17T02:46:41.223

我们的解决方案是使用[Netlify 预渲染](https://docs.netlify.com/site-deploys/post-processing/prerendering/)，它预渲染然后缓存渲染的 HTML 以专门为爬虫和机器人服务。

这似乎运作良好。它允许我们动态更新 OG 元标记，然后由 Netlify 缓存并提供给爬虫，以便它们看到正确的内容。

它也很容易设置，因此如果您使用的是 Netlify，这对您来说可能是一个很好的解决方案。

# java - 如何为小键盘定义 keyStroke - 输入键

> ID：16069502
> 
> 赞同：0
> 
> 时间：2013-04-17T20:18:58.200
> 
> 标签：java, swing, key-bindings, keystrokes

我即将在摇摆应用程序中为数字键盘输入键使用键绑定，但该键很难抓住。我见过的所有例子都依赖于类似的东西
`key == KeyEvent.VK_KP_LEFT`

其中 VK_KP_LEFT 是一些预定义的值。其他选项是定义这样的按键：
`KeyStroke.getKeyStroke("control A");`
`KeyStroke.getKeyStroke(KeyEvent.VK_A, InputEvent.CTRL_MASK);`

但我还没有找到小键盘的“修饰符”。

很容易获得的是通用和小键盘输入之间的区别：所有小键盘键（无论是否切换到数字模式）都被分配
`getKeyLocation() == 4`
（我从按键/按键释放方法中发现了这个）

问题是：
如何正确准备小键盘输入键的keyStroke，以便在
`inputMap.put(KeyStroke keyStroke, Object actionMapKey)`
键绑定方法中使用它？

谢谢，
塔里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:31:29.157

如果您正在寻找`Enter`可以使用的绑定密钥`KeyEvent.VK_ENTER`，即：

```
getInputMap().put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), "someAction");
getActionMap().put("someAction", someAction); 
```

这是一个简短的例子：

```
import java.awt.event.*;
import javax.swing.*;

public class Test {
    public static void main(String[] args) throws Exception {
        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel panel = new JPanel();
        panel.add(new JLabel("Hit Enter"));

        Action someAction = new AbstractAction() {
            public void actionPerformed(ActionEvent e) {
                JOptionPane.showMessageDialog(frame, "Got it");
            }
        };

        panel.getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(
                KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), "someAction");
        panel.getActionMap().put("someAction", someAction);

        frame.add(panel);

        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

***编辑：***数字键盘上的 VK_ENTER 与主键盘

经过一些测试，似乎无法单独绑定这些键。`KeyStroke`为两个密钥生成相同的内容。的实现`JComponent.processKeyBinding`不检查`KeyEvent`，它所关心的只是`KeyStroke`为了找到所需的操作。

`SwingUtilities.notifyAction`即负责调度实际操作并没有委托所有细节`KeyEvent`（只有键、修饰符和何时）。所以内部行动没有办法区分，因为没有细节`ActionEvent`。

如果值得麻烦，您可以`processKeyBinding`根据需要覆盖并添加一些逻辑。您还可以`KeyboardFocusManageraddKeyEventDispatcher()`用于阻止其中一个键。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T20:40:56.167

这个怎么样？

```
if(keyEvent.getKeyLocation() == KeyEvent.KEY_LOCATION_NUMPAD 
&& keyEvent.getKeyCode() == KeyEvent.VK_ENTER) 
```

# java - JNLP 通过 file: 但不是 http: 加载 Sigar 本机库

> ID：16069507
> 
> 赞同：1
> 
> 时间：2013-04-17T20:19:05.190
> 
> 标签：java, jnlp, java-web-start, sigar

我有一个使用 jnlp 作为启动器的应用程序。它使用 Sigar 库，这些库需要为特定于平台的代码动态加载本机库。

出于调试目的，我有两个 JNLP 文件，一个使用 file: urls 引用代码库，另一个使用 http: urls。http url 指向正确提供文件的 localhost apache。我可以通过 apache 日志观看 JNLP 在其启动过程中下载它们的过程，因此我知道这些文件正在正确地到达我的应用程序。

这是两个代码库标签

```
codebase="file:/Users/siberian/Documents/workspace_mnis/MNIS/localhost/" 
href="file:/Users/siberian/Documents/workspace_mnis/MNIS/localhost/minis.jnlp"--> 
```

和 codebase="http://localhost/" href="http://localhost/mnis.jnlp"

如果我双击文件：版本它工作正常。如果我通过浏览器加载它，它工作正常。

如果我双击或浏览器加载 http: 版本，则无法找到具有此错误的动态库：

```
JNLPClassLoader: Finding library liblibsigar-universal64-macosx.dylib.dylib
[AWT-EventQueue-0] DEBUG Sigar  - no libsigar-universal64-macosx.dylib in java.library.path
org.hyperic.sigar.SigarException: no libsigar-universal64-macosx.dylib in java.library.path 
```

现在，有趣的是它说它找不到 liblibsigar-universal64-macosx.dylib.dylib 的文件

注意前缀额外的“lib”和后缀额外的“.dylib”。

Sigar/vmware 论坛上有关于类似问题但没有解决方案的注释。

核心问题是，为什么这在文件中表现不同：上下文与 http: 上下文？

另外值得注意的是，我已经取消了所有文件的签名和辞职，我看不到任何签名错误。

这里有答案提示：[Java Webstart with Tibco Native Libs](https://stackoverflow.com/questions/1399397/java-webstart-with-tibco-native-libs)

但它在一个文件中工作：上下文让我认为其他事情是错误的。

另外：JaNeLa 告诉我一切都很好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:49:10.253

JNLP 和 Sigar 类加载器不能很好地配合使用。这是拼凑在一起的，但在 Windows 和 Mac 环境中运行良好。VMWare 论坛提示了这样的答案，但没有人将它们放在一起。对于 JNLP，您需要根据您的架构专门执行 loadLibrary。在非 JNLP 上下文中，Sigar 透明地处理这一点，但 JNLP 以某种方式打破了这一点，需要手动选择平台。

只需将此方法放入您的类并在您调用 new Sigar() 之前调用它，它应该可以正常工作。此解决方案需要 commons-lang 库。您可以轻松地将其扩展为 linux 和其他替代平台支持。

```
 private static void preloadSigar() {

        String arch = System.getProperty("os.arch");
        String libName;

        if (SystemUtils.IS_OS_WINDOWS) {
            if (arch.equalsIgnoreCase("x86")) 
                libName = "sigar-x86-winnt";
            else
                libName = "sigar-amd64-winnt";
        } else if (SystemUtils.IS_OS_MAC_OSX) {
            if (arch.startsWith("i") && arch.endsWith("86"))
                libName = "sigar-universal-macosx";
            else
                libName = "sigar-universal64-macosx";
        } else {
            throw new RuntimeException("Unrecognized platform!");

        }

        System.setProperty("org.hyperic.sigar.path", "-");    
        System.loadLibrary(libName);

      } 
```

# c# - 如何在 C# 中正确使用 SortedDictionary？

> ID：16069515
> 
> 赞同：10
> 
> 时间：2013-04-17T20:19:15.047
> 
> 标签：c#, dictionary, sorted, sorteddictionary

我正在尝试做一些非常简单的事情，但似乎我不明白`SortedDictionary`。

我想要做的是以下内容：
创建一个排序字典，按某个浮点数对我的项目进行排序，所以我创建一个看起来像这样的字典

```
SortedDictionary<float, Node<T>> allNodes = new SortedDictionary<float, Node<T>>(); 
```

现在，在我添加项目之后，我想一个一个地删除它们（每次删除都应该是从最小到最大的 O(log(n)) 复杂度。

我该怎么做？我以为这只`allNodes[0]`会给我最小的，但事实并非如此。

此外，字典似乎无法处理重复的键。我觉得我使用了错误的数据结构......
如果我有一堆节点想要按它们的距离（浮点数）排序，我应该使用其他东西吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-17T20:32:03.007

`allNodes[0]`不会给你字典中的第一个项目 - 它会给你一个`float` *键值*为`0`.

如果您想要第一个项目，请尝试`allNodes.Values.First()`。或者找到第一个*键*使用`allNodes.Keys.First()`

要*逐个删除*项目，请遍历集合的*副本并调用*`Keys``allNodes.Remove(key);`

```
foreach (var key in allNodes.Keys.ToList())
{
    allNodes.Remove(key);
} 
```

要回答您对问题的补充，是`SortedDictionary`的（任何形式的`Dictionary`）都不会处理重复的键 - 如果您尝试使用现有键添加项目，它将*覆盖*以前的值。

你可以使用 a`SortedDictionary<float, List<Node<T>>>`但是你有提取*集合*与项目的复杂性，需要*初始化*每个列表而不是仅仅添加一个项目等。这一切都是可能的，并且可能仍然是添加和获取的最快结构，但它确实添加了一个有点复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:32:25.750

是的，您对复杂性的看法是正确的。

在`SortedDictionary`所有键中都进行了排序。如果你想从最小到最大迭代，`foreach`就足够了：

```
foreach(KeyValuePair<float, Node<T>> kvp in allNodes)
{
    // Do Something...
} 
```

您写道要删除项目。在使用 迭代期间禁止从集合中删除`foreach`，因此首先创建它的副本以执行此操作。

编辑：

是的，如果您有重复的密钥，则无法使用`SortedDictionary`. `Node<T>`用and创建一个结构节点`float`，然后编写一个比较器：

```
public class NodeComparer : IComparer<Node>
{
    public int Compare(Node n1, Node n2)
    {
        return n2.dist.CompareTo(n1.dist);
    }
} 
```

然后将所有内容简单`List<Node> allNodes`排序：

```
allNodes.Sort(new NodeComparer()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:30:40.823

由于`Dictionary<TKey, TValue>`必须具有唯一键，我会`List<Node<T>>`改用它。例如，如果您的`Node<T>`班级有一个`Value`属性

```
class Node<T>
{
    float Value { get; set; }
    // other properties
} 
```

并且您想按此属性排序，请使用 LINQ：

```
var list = new List<Node<T>>();

// populate list

var smallest = list.OrderBy(n => n.Value).FirstOrDefault(); 
```

要一个一个地删除节点，只需迭代抛出列表：

```
while (list.Count > 0)
{
    list.RemoveAt(0);
} 
```

# python - Python - “if”语句中的逻辑评估顺序

> ID：16069517
> 
> 赞同：11
> 
> 时间：2013-04-17T20:19:16.077
> 
> 标签：python, boolean, short-circuiting

在 Python 中，我们可以这样做：

```
if True or blah:
    print("it's ok") # will be executed

if blah or True: # will raise a NameError
    print("it's not ok")

class Blah:
    pass
blah = Blah()

if blah or blah.notexist:
    print("it's ok") # also will be executed 
```

*   有人可以指点我有关此功能的文档吗？
*   它是语言的实现细节还是特性？
*   利用此功能是一种好的编码风格吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-17T20:21:38.077

和*短路*`or`，参见[布尔运算](http://docs.python.org/2/reference/expressions.html#boolean-operations)文档：`and`

 *> 表达式`x and y`首先计算`x`; 如果`x`为假，则返回其值；否则，`y`评估并返回结果值。
> 
> 表达式`x or y`首先计算`x`; 如果`x`为真，则返回其值；否则，`y`评估并返回结果值。

请注意，`and`仅`y`当评估为 True 值时，*才会评估 for 。*`x`相反，对于`or`,`y`仅在`x`评估为 False 值时才评估。

对于第一个表达式`True or blah`，这意味着它`blah`永远不会被评估，因为第一部分已经是`True`。

此外，您的自定义`Blah`类被认为是 True：

> 在布尔运算的上下文中，以及当控制流语句使用表达式时，以下值被解释为 false：`False`、、`None`所有类型的数字零，以及空字符串和容器（包括字符串、元组、列表、字典、集合和冻结集）。所有其他值都被解释为 true。（有关[`__nonzero__()`](http://docs.python.org/2/reference/datamodel.html#object.__nonzero__)更改此设置的方法，请参见特殊方法。）

由于您的类没有实现`__nonzero__()`方法（也没有`__len__`方法），因此就`True`布尔表达式而言，它被认为是。

在表达式`blah or blah.notexist`中，`blah`因此为真，并且`blah.notexist`从不计算。

经验丰富的开发人员经常有效地使用此功能，通常用于指定默认值：

```
some_setting = user_supplied_value or 'default literal'
object_test = is_it_defined and is_it_defined.some_attribute 
```

请注意链接这些并在适用的情况下使用[条件表达式。](http://docs.python.org/2/reference/expressions.html#conditional-expressions)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-17T20:21:21.370

这称为短路，是该语言的一个特性：

[http://docs.python.org/2/tutorial/datastructures.html#more-on-conditions](http://docs.python.org/2/tutorial/datastructures.html#more-on-conditions)

> 布尔运算符`and`和`or`是所谓的短路运算符：它们的参数从左到右进行评估，一旦确定结果，评估就会停止。例如，如果 A 和 C 为真但 B 为假，则 A 和 B 和 C 不计算表达式 C。当用作一般值而不用作布尔值时，短路运算符的返回值是最后一个评估的论点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-17T20:21:28.580

这是运算符逻辑运算符的方式，特别`or`是在 python 中的工作方式：**短路评估。**

为了更好地解释它，请考虑以下几点：

```
if True or False:
    print('True') # never reaches the evaluation of False, because it sees True first.

if False or True:
    print('True') # print's True, but it reaches the evaluation of True after False has been evaluated. 
```

有关更多信息，请参阅以下内容：

*   [关于布尔运算的官方 python 文档](http://docs.python.org/2/library/stdtypes.html?highlight=short%20circuit#boolean-operations-and-or-not)
*   [关于python中短路的堆栈溢出问题](https://stackoverflow.com/questions/2580136/does-python-support-short-circuiting)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-17T21:52:21.160

使用`or`运算符，从左到右计算值。在一个值计算为 之后`True`，整个语句的计算结果为`True`（因此不再计算更多值）。

*   [官方文档](http://docs.python.org/2/library/stdtypes.html?highlight=short%20circuit#boolean-operations-and-or-not)
*   这是语言的一个特点
*   使用它的功能没有错*

# java - 尝试将 Saxon 与 Web 服务一起使用时出现 TransformerFactoryConfigurationError

> ID：16069519
> 
> 赞同：2
> 
> 时间：2013-04-17T20:19:20.467
> 
> 标签：java, wso2, saxon, transformer, wso2wsas

我的 Web 服务位于 WSO2 WSAS 应用程序服务器内的 Axis2 上，包含以下代码：

```
String prop = "javax.xml.transform.TransformerFactory";
String val = "net.sf.saxon.TransformerFactoryImpl";

public static TransformerFactory getTransformerFactory() {
    System.setProperty(prop, val); // This line executes normally
    return TransformerFactory.newInstance(); // Error occurs inside this call
} 
```

运行时，服务会产生以下错误：

```
[2013-04-15 12:22:41,263] ERROR
  {org.apache.axis2.transport.base.threads.NativeWorkerPool} -  Uncaught
  exception
javax.xml.transform.TransformerFactoryConfigurationError: Provider
  net.sf.saxon.TransformerFactoryImpl not found
        at javax.xml.transform.TransformerFactory.newInstance(Unknown Source)
        at com.example.Setup.getTransformerFactory(Setup.java:40)
        at com.example.ProcessFiles.init(ProcessFiles.java:336)
        at com.example.TorgApp.incoming(TorgApp.java:229)
        ... 
```

我的类路径中确实有`Saxon-HE-9.4.jar`，并且它是可读的。它也可用于 Axis2 ( `/foo/bar/wso2as/wso2as-4.0.0/tmp/axis2-tmp-6436419317930731973.tmp/axis67573163200472779114Saxon-HE-9.4.jar`)。

根据[Javadoc for`newInstance()`](http://docs.oracle.com/javase/6/docs/api/javax/xml/transform/TransformerFactory.html#newInstance%28%29)，我设置的系统属性应该推翻所有其他识别`TransformerFactory`要使用的方法，因此优先级不是问题。

什么可能导致此错误，我可以做些什么来获得我想要的撒克逊变压器厂？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:34:11.247

如果axis2（这似乎是异常的原因）放置在您的Web应用程序之外，那么您还必须使Saxon也可用。

大多数应用程序服务器都有一个预定义的位置，可以在其中放置 jar 文件正是为了这个目的。仅仅将其部署在您的 Web 应用程序中是不够的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:26:57.790

这似乎是一个类加载问题。您是否遵循此文档。 [http://docs.wso2.org/wiki/display/AS510/Webapp+ClassLoading](http://docs.wso2.org/wiki/display/AS510/Webapp+ClassLoading)

# c# - DateTime.ParseExact 失败（字符串不是有效的日期时间格式）

> ID：16069520
> 
> 赞同：2
> 
> 时间：2013-04-17T20:19:23.967
> 
> 标签：c#

我正在尝试在使用该格式的时间戳上使用 DateTime.ParseExact，`M/d/yyyy HH:mm:ss:fff`编译器告诉我这不会发生。

我的时间戳的一个例子是：

`3/26/2013 14:37:05:553`

...我的代码的一个例子是，_CultureInfo 是 en-us。

`DateTime someDateTime = DateTime.ParseExact("3/26/2013 14:37:05:553","M/d/yyyy HH:mm:ss:fff", _CultureInfo.DateTimeFormat);`

看下面的图片是怎么回事......我错过了什么吗？

![在此处输入图像描述](https://i.stack.imgur.com/g5YLp.png)

**新编辑**

我又尝试了几件事，但仍然没有运气：

*   更改`:fff`为`.fff`
*   按照以下建议更改`_CultureInfo.DateTimeFormat`为`System.Globalization.CultureInfo.InvariantCulture`和更改`d`为`dd`

以下是您可以放入控制台并运行的内容，以查看它在我的最终表现如何。

```
 class Program
    {
        static void Main(string[] args)
        {
            CsvImporter importer = new CsvImporter();

            DateTime readtime = importer.Parse(@"""3/26/2013 14:37:07:238,00:00:01.6850000,23.138,23.488,23.175""");

            Console.WriteLine(readtime.ToString());
        }
    }

    class CsvImporter
    {
        public Char[] _SeparatorChars = new Char[] { ',' };

        public DateTime Parse(string text)
        {
            System.Globalization.CultureInfo _CultureInfo = System.Globalization.CultureInfo.CurrentCulture;

            string txt = text.Replace('"', ' ');
            string[] columns = txt.Split(_SeparatorChars);

            return DateTime.ParseExact(columns[0], "M/dd/yyyy HH:mm:ss:fff", _CultureInfo.DateTimeFormat);
            //return DateTime.ParseExact(columns[0], "M/dd/yyyy HH:mm:ss.fff", System.Globalization.CultureInfo.InvariantCulture);
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:22:12.810

试试这个（`d`改为`dd`和`CultureInfo.InvariantCulture`）

```
DateTime someDateTime = DateTime.ParseExact("3/26/2013 14:37:05:553", "M/dd/yyyy HH:mm:ss:fff", CultureInfo.InvariantCulture); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T15:39:05.127

问题在于`string txt = text.Replace('"', ' ');`

这正在`column[0]`变成`[space]3/26/2013 14:37:05:553`而不是`3/26/2013 14:37:05:553`像我期望的那样。

更改此行以`string txt = text.Replace(@"""", "");`解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T15:31:50.907

每当您调用`ParseExact`时，请确保您使用的是明确的格式字符串。在 .NET 中，`/`格式字符串中的字符是[系统日期分隔符](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)，而不是实际的斜杠。有时也适用于`:`角色。

要使用您的结构解析字符串，请使用反斜杠转义斜杠和冒号，例如：

```
DateTime.ParseExact(s, @"M\/d\/yyyy HH\:mm\:ss\:fff", null)
// or
DateTime.ParseExact(s, "M\\/d\\/yyyy HH\\:mm\\:ss\\:fff", null) 
```

这将告诉解析器您特别想要正斜杠和冒号，无论您的系统偏好或当前文化如何。

# spring - Spring JPA 事务

> ID：16069522
> 
> 赞同：0
> 
> 时间：2013-04-17T20:19:26.483
> 
> 标签：spring, hibernate, jpa, transactions

我在 Spring 托管事务中遇到了一些奇怪的行为。这是一个 Spring MVC 应用程序。我将实体直接绑定到 Web 层。我使用以下服务层代码从数据库加载持久实体以进行编辑，该代码从使用@ModelAttribute 注释的方法调用。

```
@Transactional(readOnly = true)
@PreAuthorize("#id == authentication.principal.id or hasRole('ROLE_ADMIN')")
public User findById(Long id) {
    return repository.findOne(id);
} 
```

提交表单时，数据将绑定到此分离实体。作为验证的一部分，我查询数据库以验证为用户指定的电子邮件地址是唯一的。

```
@Transactional(readOnly = true)
public boolean isEmailAddressUnique(String emailAddress, Long userId){
    return repository.checkEmailAddressUnique(emailAddress, userId) == 0;
} 
```

此时，在执行此查询之前，Hibernate 会尝试刷新以前加载的我不理解的分离实体。显然，如果电子邮件地址不是唯一的，这会导致异常。

我正在使用 OpenEntityManagerinViewFilter 但是我希望这应该将 FlushMode 设置为 NEVER，也许不是。

如果我从 isEmailAddressUnique() 中删除 @Transactional 属性，则不会发生刷新，并且一切都按预期工作，我想这可以解决问题，但是我想了解这里发生了什么。

有什么建议么？

==============

好的，我已经进一步调查了。因此，我将 OpenEntityManagerInViewFilter 配置为默认值：

情景一。

[1] MVC 控制器在只读事务 T1 中加载用户实体 [2] 由于 MVC 字段绑定而修改了实体 [3] 第二个事务在只读事务 T2 中针对用户表运行。[4] Hibernate 刷新 T1 中加载的实体。[5] Hibernate 发出查询

情景 2。

子类化 OEMIVFilter 以将 FlushMode 设置为提交（默认为自动）。

如上所述，将步骤 [4] 和 [5] 颠倒过来，即。即使 T2 被标记为 readOnly Hibernate 仍然尝试在事务结束时刷新。我可以理解场景 1，因为 readOnly 可能只引用当前事务 T2（并且会在执行 T2 之前尝试同步数据库）。但是我希望在场景 2 中不应该发出 Flush。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T07:30:10.877

我一开始也有同样的问题。我们还使用了 OSIV 过滤器，我们的问题是事务注释上的只读标志没有传播到休眠。我们必须确保我们使用正确的事务管理器，更重要的是使用 hibernatevendoradapter。检查您的配置，如果您无法解决问题，请发布您的持久性和弹簧集成配置。

# string - HIVE：如何传递包含单引号的 hiveconf？

> ID：16069525
> 
> 赞同：0
> 
> 时间：2013-04-17T20:19:29.153
> 
> 标签：string, hadoop, amazon-web-services, hive, elastic-map-reduce

我想传递一个在字符串中包含单引号的配置单元 arg。这会导致 EMR 作业失败并出现以下错误：

```
sh: -c: line 0: unexpected EOF while looking for matching `''
sh: -c: line 1: syntax error: unexpected end of file
Command exiting with ret '255' 
```

**所需变量：**

```
-hiveconf "myvar=Today's a great day for a test!" 
```

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:10:38.427

尝试：

```
SET myvar="Today's a great day for a test!"; 
```

然后调用它：

```
SELECT * FROM myTable WHERE test_today=${hiveconf:myvar} 
```

当我尝试时，这对我有用，但是当我尝试时：

```
SET myvar=Today's a great day for a test! (withoutquotes) 
```

我得到一个错误。希望这可以帮助

# google-apps-script - 将一个工作表中命名范围的单元格值复制到另一工作表中另一个命名范围的相同单元格地址

> ID：16069529
> 
> 赞同：0
> 
> 时间：2013-04-17T20:19:38.353
> 
> 标签：google-apps-script, google-sheets, named-ranges

是否可以在一张纸中复制命名范围的值并将它们粘贴到另一张纸的相同单元格位置？

例如，我将 range `"old_desk_1"`in命名为 ，并将 range in`sheet1!A24:A25`命名为. 是否可以在不进行标准复制/粘贴的情况下复制to单元格中的值？`"desk_1"``sheet2!A24:A25``old_desk_1``desk_1`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:27:34.413

是的，首先我建议查看以下文档。

*   [Google Class SpreadsheetApp](https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app)
*   [谷歌课堂电子表格](https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet)
*   [谷歌课程表](https://developers.google.com/apps-script/reference/spreadsheet/sheet)
*   [谷歌类范围](https://developers.google.com/apps-script/reference/spreadsheet/range)

上面的链接将告诉您所有可用于您需要执行此操作的类的所有方法。这是您希望实现的基本示例。

```
function copyCells(){
   var thisSpreadsheet = SpreadsheetApp.getActiveSpreadsheet();
   var theRange = thisSpreadsheet.getRangeByName("YOUR RANGE");

   var destinationSheet = thisSpreadsheet.getSheetByName("SHEET TO COPY TO");
   var destinationRange = destinationSheet.getRangeByName("YOUR OTHER RANGE");

   theRange.copyTo(destinationRange);
} 
```

# jquery - jQuery 日期选择器不适用于 ng-grid 单元格

> ID：16069531
> 
> 赞同：2
> 
> 时间：2013-04-17T20:19:44.373
> 
> 标签：jquery, jquery-ui, angularjs, jquery-ui-datepicker

我在将 jQuery 的日期选择器与 AngularJS ng-grid 扩展集成时遇到问题；更具体地说，jQuery 日期选择器无法将数据推回 ng-grid，而是抛出此错误：*未捕获此日期选择器的缺失实例数据*所有关于此错误消息的研究都与它在 ng-grid 中的使用无关。

在这个小提琴中重新创建的问题：http: [//jsfiddle.net/ADukg/2363/](http://jsfiddle.net/ADukg/2363/)

任何帮助或解释将不胜感激。谢谢！

```
var myApp = angular.module('myApp', ['ui', 'ngGrid']);

function Ctrl($scope) {

    $scope.data = [{
        "Title": "Title",
        "Date": new Date("01/03/1970")

    }];

    $scope.kpiGridOptions={data:'data',
        enableCellEdit:true,
                columnDefs:[{field:'Title', displayName:'Title'},
            {field:'Date', displayName:'Date', editableCellTemplate:'<input ui-date ui-date-format ng-model="row.entity[col.field]">'}]
    }
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T03:09:06.943

好像您只是有几个选项不正确。`editableCellTemplate`应该设置为`true`并且您应该在`cellTemplate`.

[http://jsfiddle.net/ADukg/2370/](http://jsfiddle.net/ADukg/2370/)

```
$scope.kpiGridOptions = { 
    data:'data',
    enableCellEdit:true,
    columnDefs: [
        { field:'Title', displayName:'Title'},
        { field:'Date', displayName:'Date', editableCellTemplate: true, cellTemplate: 
          '<input ui-date ui-date-format ng-model="row.entity[col.field]">' }
    ]
} 
```

此外，`"Date": new Date("01/03/1970")`会导致`input`字段中不显示默认日期。但是，将分配更改为字符串表示可以解决此问题，正如您在[jsfiddle](http://jsfiddle.net/ADukg/2370/)中看到的那样。我现在没有时间弄清楚为什么会这样，希望这对您来说不是问题。

希望这可以帮助。

# java - 假的 actionEvent 不会处理窗口。（密码对话框）

> ID：16069534
> 
> 赞同：0
> 
> 时间：2013-04-17T20:19:50.653
> 
> 标签：java, passwords

我正在使用 JOptionPane 确认对话框来输入密码，它有 OK 和 Cancel 按钮，当我使用 while 循环来检测何时输入了正确的密码时，当用户按下 Cancel 或“X”时，我会触发假 actionEvent 来处理窗口使用this.dispose(); 但是由于某些奇怪的原因，它不起作用并且无论如何都会打开窗口。

这是代码：

```
while(identifier<1) {
  if(action == 0) {
    if(Arrays.equals(password.getPassword(),pass)) {
      break;
    } else {
      actionPerformed(new ActionEvent(2,-1,""));
      break;
    }
  } else {
    actionPerformed(new ActionEvent(2,-1,"");
    break;
  }
} 
```

这是 actionPerformed 方法中应该关闭窗口的部分：

```
if(e.getSource()==2) {
  this.dispose();
} 
```

# backbone.js - 检测主干中的多个按键

> ID：16069535
> 
> 赞同：0
> 
> 时间：2013-04-17T20:19:53.187
> 
> 标签：backbone.js

我正在尝试捕捉像**Alt + g**这样的按键事件，我的主干代码现在是这样的：

```
class MyView extends Backbone.View
  template: ...

  events:
    "keydown input" : "logKey"

  logKey: (e) ->
    if e.keyCode == 18 and e.keyCode == 71
      console.log('did it!') 
```

哪个不起作用，因为一次只有一个事件键码。

这怎么可能实现？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:50:24.310

为什么不寻找`keypress`而不是`keydown`？像这样的东西：

```
class MyView extends Backbone.View
  events:
    "keypress input" : "logKey"

  logKey: (e) ->
    console.log('did it') if(e.keyCode == 169) 
```

演示：http: [//jsfiddle.net/ambiguous/fmr8D/](http://jsfiddle.net/ambiguous/fmr8D/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T20:43:42.907

您必须设置一个单独的变量来跟踪修饰键并检查您的 keydown 事件。像：

```
events:
    "keydown input" : "logKeyDown",
    "keyup input" : "logKeyUp"

logKey: (e) ->
    if e.keyCode == 18
         altDown = true

    if altDown && e.keyCode == 71
      console.log('did it!')

logKeyUp: (e) ->
    if e.keyCode == 18
        altDown = false 
```

# jquery - 使用 jquery 更改选择输入

> ID：16069536
> 
> 赞同：0
> 
> 时间：2013-04-17T20:19:54.257
> 
> 标签：jquery, html, css

我一直在尝试通过使用 jquery 来更改选择输入。当用户单击搜索字段时，我希望更改选择字段。这是我用来执行此操作的代码：

```
$(document).ready(function() {

$('#cat-filter').change( function() {
    var filterText = $(this).val().toLowerCase();       

    if(filterText == 'all events'){
        $('a.events').css("display", "inline");
    } else if(filterText != ''){
        $('a.events:not([categories~="'+ filterText +'"])').css("display", "none");
        $('a.events[categories~="'+ filterText +'"]').css("display", "inline");
    } else {
        $('a.events').css("display", "inline"); 
    }
});
// --------------- THIS IS THE CODE ----------------
$('#search-input').focus( function() {
    $(this).val('');
    $('a.events').css("display", "inline");         
    $("select option:contains(1)").prop('selected', true);
});
//--------------------------------------------------

$('#search-input').blur( function() {
    $(this).val('Search Events');
});

$('#search-input').keyup(function (){
    textField = null;
    var textField = $(this).val().toLowerCase();
    if (textField != ""){
        $('a.events:not([categories*="'+textField+'"])').css("display", "none");
        $('a.events[categories*="'+textField+'"]').css("display", "inline");
    } else {
        $('a.events').css("display", "inline"); 
    }
});

}); 
```

但是，它似乎不起作用。我检查了我的 id 和值，但似乎没有任何效果。我正在使用 jquery 1.9，我读过需要使用 prop。请让我知道我做错了什么，谢谢！

这是一个活生生的例子：[http ://www.lcbcchurch.com/new-site/events](http://www.lcbcchurch.com/new-site/events)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:27:46.653

问题不`.prop`在于您的选项中没有一个在其文本中包含**1的事实。**

如果您想定位第一个（*其值为 1*）然后使用

```
$('select option[value="1"]').prop('selected', true); 
```

并且由于您使用统一插件，因此您还必须发布更新

```
var element = $('select option[value="1"]').prop('selected', true);
$.uniform.update(element.closest('select')); 
```

# ruby-on-rails - 在 heroku 上重命名了 Ruby on Rails 应用程序，现在它不起作用

> ID：16069537
> 
> 赞同：2
> 
> 时间：2013-04-17T20:20:00.267
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku

我启动了我的应用程序，填充了数据库并多次访问它，没有任何问题。但我只是通过登录我的 heroku 帐户并访问应用程序设置来更改应用程序的名称。现在我的应用程序出现故障。

之后我阅读了如何更改应用程序名称的指南，最终结果是相同的。我从字面上只是更改了名称，现在它不起作用。有人可以帮我解决这个问题。我还删除了指向 heroku 的远程别名，并将它们替换为正确的地址。

谢谢您的帮助

**Heroku Logs** （我会尝试再清理一下）

```
 ←[36m2013-04-17T20:27:29.659316+00:00 app[web.1]:←[0m Redirected to http://costrecovery-post.herokuapp.com/
    ←[36m2013-04-17T20:27:29.659316+00:00 app[web.1]:←[0m Completed 302 Found in 4ms
    (ActiveRecord: 1.7ms)
    ←[36m2013-04-17T20:27:29.750709+00:00 app[web.1]:←[0m Started GET "/" for 74.143.68.203 at 2013-04-1720:27:29 +0000
    ←[36m2013-04-17T20:27:29.753863+00:00 app[web.1]:←[0m Processing by IncidentsController#index as HTML
    ←[36m2013-04-17T20:27:29.962842+00:00 app[web.1]:←[0m   Rendered incidents/index.html.erb within layouts/application (15.5ms)
    ←[36m2013-04-17T20:27:29.963111+00:00 app[web.1]:←[0m Completed 500 Internal Server Error in 207ms
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m ActionView::Template::Error (PG::Error: ERROR:  relation "users" does not exist at character 24
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m : SELECT  "users".* FROM "users"  WHERE "users"."id" = $1 LIMIT 1):
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m     26:   <td><%= incident.location %></td>
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m     27:   <td><b><%= incident.status %></b> <% if current_user.admin == "yes" %><%= link_to "change", changestatus_incident_path(incident) %><% end %></td>
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m     28:   <% if current_us
er.admin == "yes" %>
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m     29:   <td><%=     User.find(incident.user_id).profile.name %> (<%= User.find(incident.user_id).profile.department %>)</td>
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m     30:   <% end %>
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m     31:     <td><%= link_t
o 'View Time Sheet', incident_timesheet_path(incident) %></td>
    ←[36m2013-04-17T20:27:29.966640+00:00 app[web.1]:←[0m     32:   <td><%= link_to'Delete Incident', incident, :confirm => 'Are you sure?', :method => :delete %><
/td>
    ←[36m2013-04-17T20:27:29.966901+00:00 app[web.1]:←[0m   app/views/incidents/inde
x.html.erb:29:in `block in _app_views_incidents_index_html_erb___137155814596393
6561_33092660'
    ←[36m2013-04-17T20:27:29.966901+00:00 app[web.1]:←[0m   app/views/incidents/inde
x.html.erb:22:in `each'
    ←[36m2013-04-17T20:27:29.966901+00:00 app[web.1]:←[0m   app/views/incidents/inde
x.html.erb:22:in `_app_views_incidents_index_html_erb___1371558145963936561_3309
2660'
    ←[36m2013-04-17T20:27:29.966901+00:00 app[web.1]:←[0m   app/controllers/incident
s_controller.rb:22:in `index'
    ←[36m2013-04-17T20:27:29.966901+00:00 app[web.1]:←[0m
    ←[36m2013-04-17T20:27:29.966901+00:00 app[web.1]:←[0m
    ←[33m2013-04-17T20:27:29.977182+00:00 heroku[router]:←[0m at=info method=GET pat
h=/ host=costrecovery-post.herokuapp.com fwd="74.143.68.203" dyno=web.1 connect=
5ms service=246ms status=500 bytes=643 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T05:29:32.103

从命令行试试这个：

```
$ heroku apps:rename newname
-> http://newname.heroku.com/ | git@heroku.com:newname.git
-> Git remote heroku updated 
```

# python - Python 模拟、django 和请求

> ID：16069541
> 
> 赞同：10
> 
> 时间：2013-04-17T20:20:17.987
> 
> 标签：python, django, unit-testing, mocking, django-testing

所以，我刚刚开始在 Django 项目中使用 mock。我正在尝试模拟视图的一部分，该视图向远程 API 发出请求以确认订阅请求是真实的（根据我正在努力的规范的一种验证形式）。

我所拥有的类似于：

```
class SubscriptionView(View):
    def post(self, request, **kwargs):
        remote_url = request.POST.get('remote_url')
        if remote_url:
            response = requests.get(remote_url, params={'verify': 'hello'})

        if response.status_code != 200:
            return HttpResponse('Verification of request failed') 
```

我现在想做的是使用 mock 来模拟`requests.get`调用以更改响应，但我无法弄清楚如何为补丁装饰器执行此操作。我以为你会做类似的事情：

```
@patch(requests.get)
def test_response_verify(self):
    # make a call to the view using self.app.post (WebTest), 
    # requests.get makes a suitable fake response from the mock object 
```

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-17T23:30:47.083

您快到了。你只是稍微不正确地调用它。

```
from mock import call, patch

@patch('my_app.views.requests')
def test_response_verify(self, mock_requests):
    # We setup the mock, this may look like magic but it works, return_value is
    # a special attribute on a mock, it is what is returned when it is called
    # So this is saying we want the return value of requests.get to have an
    # status code attribute of 200
    mock_requests.get.return_value.status_code = 200

    # Here we make the call to the view
    response = SubscriptionView().post(request, {'remote_url': 'some_url'})

    self.assertEqual(
        mock_requests.get.call_args_list,
        [call('some_url', params={'verify': 'hello'})]
    ) 
```

您还可以测试响应是正确的类型并且具有正确的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T20:35:48.100

这一切都在[文档](http://www.voidspace.org.uk/python/mock/patch.html#mock.patch)中：

> 补丁（目标，new=DEFAULT，spec=None，create=False，spec_set=None，autospec=None，new_callable=None，**kwargs）
> 
> 目标应该是格式为“package.module.ClassName”的字符串。

```
from mock import patch

# or @patch('requests.get')
@patch.object(requests, 'get')
def test_response_verify(self):
    # make a call to the view using self.app.post (WebTest), 
    # requests.get makes a suitable fake response from the mock object 
```

# database - 在 postgresql 中有效地在同一数据库的模式之间移动数据

> ID：16069546
> 
> 赞同：2
> 
> 时间：2013-04-17T20:20:41.393
> 
> 标签：database, postgresql, schema

如何在同一个 postgresql 数据库的模式之间最有效地移动相似表中的数据（相同的列数、数据类型。如果它们不一样，可以用我希望的视图来实现）？

**编辑**

抱歉含糊不清。我打算将其他模式用作不经常需要的数据的存档（以提高性能）。更准确地说，超过 2 年的数据将被存档。服务器下线是可以的，但不超过一天，最多2个。这是一个中型公司的会计软件。根据自由主义者的估计，一年中的记录数量不会接近一百万。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T20:29:58.547

```
insert into target_schema.table_one (col1, col2, col3)
select col1, col2, col3
from source_schema.other_table
where <some condition to select the data to be moved>; 
```

如果你真的想“移动”数据（即从源表中删除行），你需要可以使用

如果表是你不能使用的外键的目标，那么`truncate`你需要使用

```
delete from source_schema.other_table
where <some condition to select the data to be moved>; 
```

如果您愿意，可以将这两个步骤合并到一个语句中：

```
with deleted_data as (
   delete from source_schema.other_table
   where <some condition to select the data to be moved>;
   returning *
)
insert into target_schema.table_one (col1, col2, col3)
select col1, col2, col3
from deleted_data; 
```

# javascript - 在全屏模式 Internet Explorer 中检测事件变化

> ID：16069548
> 
> 赞同：5
> 
> 时间：2013-04-17T20:20:53.613
> 
> 标签：javascript, jquery, html, dom

我正在尝试编写一个事件处理程序来检测我拥有的视频播放器是处于全屏模式还是“常规”模式。

我试过使用

```
 document.addEventListener("fullscreenchange", myfunc, false); 
```

但这在 IE 中不起作用，我使用 webkitfullscreenchange 和 mozfullscreenchange 事件为 firefox 和 chrome 实现了同样的事情。我可以在 IE 中为此使用任何其他事件吗？或者另一种方式来做到这一点？

任何帮助，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-17T20:26:24.383

你有 jQuery，所以使用它：

```
var screen_change_events = "webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange";
$(document).on(screen_change_events, function () {

}); 
```

（`addEventListener`无论如何，早于 IE 9 的版本不支持）

同时，看起来任何版本的 IE 都不支持全屏：

*   [http://caniuse.com/fullscreen](http://caniuse.com/fullscreen)

MDN 参考：

*   [https://developer.mozilla.org/en-US/docs/DOM/Using_fullscreen_mode](https://developer.mozilla.org/en-US/docs/DOM/Using_fullscreen_mode)

这是一个可能的黑客攻击：

*   [onfullscreenchange DOM 事件](https://stackoverflow.com/questions/8358196/onfullscreenchange-dom-event)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:44:50.377

有一个名为[jquery-fullscreen](https://github.com/ruidlopes/jquery-fullscreen)的 jQuery 插件可以完全满足您的需求。在 Fullscreen-API 标准明确之前，这可能是最好的选择。

如果浏览器不支持它，您还可以使用[Modernizr](http://modernizr.com/) fullscreen-api 检查并通过自己触发事件来填充它（有关检测方法，请参阅[此问题）](https://stackoverflow.com/questions/8358196/onfullscreenchange-dom-event)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2017-04-09T00:36:09.173

下载此脚本：[https ://raw.githubusercontent.com/sindresorhus/screenfull.js/gh-pages/dist/screenfull.js](https://raw.githubusercontent.com/sindresorhus/screenfull.js/gh-pages/dist/screenfull.js)

使用此代码：

```
if (screenfull.enabled) {
    screenfull.onchange(() => {
        icono_full(screenfull.isFullscreen);
    });
}

function icono_full(x) {
    if (x == true) {
        //do when full screen is on
    } else {
        //not full screen
    }
} 
```

见：[https ://github.com/sindresorhus/screenfull.js](https://github.com/sindresorhus/screenfull.js)

# google-app-engine - 等效于 Google App Engine 上 JPA /JDO 中重复的 NDB StructuredProperty

> ID：16069549
> 
> 赞同：0
> 
> 时间：2013-04-17T20:20:54.003
> 
> 标签：google-app-engine, jpa, datanucleus, app-engine-ndb

NDB 中的列表`StructuredProperties`由多个重复属性建模，`StructuredProperty's`模型类的每个属性一个重复属性。（看这里： [https://developers.google.com/appengine/docs/python/ndb/properties#structured。](https://developers.google.com/appengine/docs/python/ndb/properties#structured.)）

我在 Google App Engine 上使用 JPA 找到的封闭等效项`@Embedded`是`@Embeddables`. 但是，存储格式现在不同了。JPA 的 GAE/J 插件为每个嵌入式实体的每个属性生成一列（请参见此处：[http ://datanucleus-appengine.googlecode.com/svn-history/r979/trunk/src/com/google/appengine /datanucleus/StoreFieldManager.java](http://datanucleus-appengine.googlecode.com/svn-history/r979/trunk/src/com/google/appengine/datanucleus/StoreFieldManager.java)）。（例如，对于长列表，这会生成包含许多列的行。）

是否有一种简单的内置方法可以复制 NDB 使用 JPA 或 JDO 处理重复复合值的方法？

添加：

对于那些比 Python 更熟悉 Java 的人，我发现基于 Java 的 Objectify 框架以与 Python 上的 NDB 相同的方式存储嵌入式类的集合：[http ://code.google.com/p/objectify-appengine/wiki /Entities#Embedding](http://code.google.com/p/objectify-appengine/wiki/Entities#Embedding)，这是我想用 JPA（或 JDO）实现的方式：

为方便起见，我在这里复制他们的示例：

```
import com.googlecode.objectify.annotation.Embed;
import com.googlecode.objectify.annotation.Entity;
import com.googlecode.objectify.annotation.Id;

@Embed
class LevelTwo {
    String bar;
}

@Embed
class LevelOne {
    String foo;
    LevelTwo two
}

@Entity
class EntityWithEmbeddedCollection {
    @Id Long id;
    List<LevelOne> ones = new ArrayList<LevelOne>();
} 
```

使用此设置，运行以下代码：

```
EntityWithEmbeddedCollection ent = new EntityWithEmbeddedCollection();
for (int i=1; i<=4; i++) {
    LevelOne one = new LevelOne();
    one.foo = "foo" + i;
    one.two = new LevelTwo();
    one.two.bar = "bar" + i;

    ent.ones.add(one);
}

ofy().save().entity(ent); 
```

生成的行布局（使用数据存储级别的重复属性）为：

one.foo: ["foo1", "foo2", "foo3", "foo4"]

one.two.bar: ["bar1", "bar2", "bar3", "bar4"]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T09:21:19.253

Google 的嵌入式集合的 JDO/JPA 插件定义在 [https://code.google.com/p/datanucleus-appengine/issues/detail?id=258&can=1&q=embedded&colspec=ID%20Stars%20Type%20Status%20Priority%中指定20FoundIn%20TargetRelease%20Owner%20Summary](https://code.google.com/p/datanucleus-appengine/issues/detail?id=258&can=1&q=embedded&colspec=ID%20Stars%20Type%20Status%20Priority%20FoundIn%20TargetRelease%20Owner%20Summary)

如果您想对它的存储方式进行其他定义（并且可以通过多种方式存储它），那么您会在 Google 的问题跟踪器上提出问题（如果您希望尽快获得该功能，请提供一些资源来实现它）

# c# - 在 C# 中使用“复杂”XPath

> ID：16069551
> 
> 赞同：1
> 
> 时间：2013-04-17T20:21:01.473
> 
> 标签：c#, xpath

我有这个非常简单的 XML

```
<Customer>
   <BirthDate>1958-05-31 00:00:00</BirthDate>
</Customer> 
```

我想提取没有小时部分的 BirthDate。

**编辑：它必须在 XPath 语句中完成，而不是在客户端代码中。**

我在这个[网站上](http://videlibri.sourceforge.net/cgi-bin/xidelcgi "网站")测试了这个 XPath ：

```
/Customer/BirthDate/substring(text(), 1, 10) 
```

我还测试了这个 XPath：

```
/Customer/BirthDate/substring(., 1, 10) 
```

该网站给了我预期的结果。但是我的 C# 程序给了我一个运行时错误。

这是测试程序：

```
var content = @"<Customer><BirthDate>1958-05-31 00:00:00</BirthDate></Customer>";

using (var memStream = new MemoryStream(Encoding.Default.GetBytes(content)))
{
    var doc = new XPathDocument(memStream);
    var navigator = doc.CreateNavigator();

    /// GET THE "RAW" VALUE. WORKING
    var expr = navigator.Compile("/Customer/BirthDate");
    var iter = navigator.Select(expr);
    Console.WriteLine("BirthDate: {0}", iter.Current.Value);

    /// GET THE "TRANSFORMED" VALUE. NOT WORKING
    var expr2 = navigator.Compile("/Customer/BirthDate/substring(text(), 1, 8)");
    var iter2 = navigator.Select(expr2);
    Console.WriteLine("BirthDate: {0}", iter2.Current.Value);

    Console.ReadKey();
} 
```

这是一个 XPathException，没有任何内部异常的消息：

> '/Customer/BirthDate/substring(text(), 1, 10)' 具有无效标记。

Wellllllll ..... 我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:38:36.740

> 编辑：它必须在 XPath 语句中完成，而不是在客户端代码中。

.net 对 XPath 的内置支持仅支持 XPath 1.0。XPath 1.0 不支持定位步骤中的函数，因此您必须使用支持 XPath 2.0 的 .net 第三方库，例如[XmlPrime](http://www.xmlprime.com/xmlprime/index.htm)、[Saxxon](http://saxon.sourceforge.net/)或[Query Machine](http://qm.codeplex.com/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:29:12.757

我会选择你的第一个选项。选择值，将字符串解析为日期，然后格式化日期。而不是一次完成所有这些。

```
 var expr = navigator.Compile("/Customer/BirthDate");
 var iter = navigator.Select(expr);
 var formatted dates = iter
             .Select(i=>i.Current.Value)
             .Select(x => DateTime.Parse(x))
             .Select(x=> d.ToString(put desired format here))
             .ToArray(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T20:44:58.720

您可以像这样评估单个值：

```
var expr2 = navigator.Evaluate("substring(/Customer/BirthDate, 1, 10)");
Console.WriteLine(expr2); 
```

但这只会给你一个字符串。

以下表达式似乎编译并返回了一个节点集，但没有提取子字符串，总是返回完整的字符串：

```
var expr2 = navigator.Compile("/Customer/BirthDate[substring(text(), 1, 8)]"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T21:43:08.930

利用：

```
substring(/Customer/BirthDate, 1, 10) 
```

在 XPath 1.0 中工作。

正如菲利普的回答所指出的，您尝试的语法在 XPath 2.0 中有效，但在 1.0 中无效，即 .NET 支持的版本

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T20:30:30.910

我不知道你为什么不简单地使用：

```
var doc = new XPathDocument(memStream);
            var navigator = doc.CreateNavigator();

            /// GET THE "RAW" VALUE. WORKING
            var expr = navigator.Compile("/Customer/BirthDate");
            var iter = navigator.Select(expr);
            Console.WriteLine("BirthDate: {0}", iter.Current.Value);

            /// GET THE "TRANSFORMED" VALUE. NOT WORKING
            var result = iter.Current.Value.ToString().Substring(0, 10);
            Console.WriteLine("BirthDate: {0}", result); 
```

将子字符串值放在一个新的 var 中，然后你可以用它做任何你想做的事情。

# mongodb - 为什么查询索引字段是 indexOnly = false

> ID：16069561
> 
> 赞同：0
> 
> 时间：2013-04-17T20:21:39.307
> 
> 标签：mongodb, performance, indexing, nosql

我有默认索引 _id 的集合用户。

我做这个查询：

```
db.users.find({ }, { "_id" : 1 }).limit(50); 
```

或者这个查询：

```
db.users.find({ "_id" : NumberLong("382748936301357196") }, { "_id" : 1 }).limit(50); 
```

我希望这些查询仅用于索引，因为我不想返回 _id 以外的任何其他字段。但是*解释*是说这个查询不是indexOnly。为什么？

![解释 dotazu](https://i.stack.imgur.com/0b7cR.png)

# php - PHP 不会从 MySQL 数据库中获取电子邮件地址以显示在 html 文档中

> ID：16069563
> 
> 赞同：0
> 
> 时间：2013-04-17T20:21:46.947
> 
> 标签：php, mysql, email

我有一个奇怪的问题。是否有任何原因我无法显示从 MySQL 数据库轮询的电子邮件地址？

轮询数据库：

```
$AE_item = mysqli_query($dblink, 'SELECT AEmail FROM heac2013 WHERE cid =' . $heac);
if (!$AE_item) {
    $AEmail = 'Error reading data: ' . mysqli_error($dblink);
}
while ($AErow = mysqli_fetch_array($AP_item)) {
    $AEmail = $AErow['AEmail'];
} 
```

当轮询不包含电子邮件地址的字段时，相同的代码可以工作，例如查询电话号码

```
$AP_item = mysqli_query($dblink, 'SELECT APhone FROM heac2013 WHERE cid =' . $heac);
if (!$AP_item) {
    $APhone = 'Error reading data: ' . mysqli_error($dblink);
}
while ($AProw = mysqli_fetch_array($AP_item)) {
    $APhone = $AProw['APhone'];
} 
```

在所有这些民意调查结束时，有一个包含回显标签的 html 文档

```
 <?php echo $AEmail; ?> and <?php echo $APhone; ?> 
```

我很困惑。html 页面中显示了其他数据（姓名、地址、电话、人的图像），但电子邮件地址返回为空白。

使用 PHPmyadmin 检查数据库时，字段在那里，并且 sql 查询有效，但在我的 php/html 文档中，电子邮件不显示。

这个 n00b 有什么东西不见了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:23:31.163

```
<?php echo AEmail; ?> and <?php echo APhone; ?> 
```

应该：

```
<?php echo $AEmail; ?> and <?php echo $APhone; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:31:29.997

尝试这个 ：

```
$AE_item = mysqli_query($dblink, 'SELECT AEmail FROM heac2013 WHERE cid =' . $heac); 
```

至

```
$AE_item = mysqli_query($dblink, 'SELECT AEmail FROM heac2013 WHERE cid ="' . $heac . '"'); 
```

对于这两个查询。

原因：您的变量 $heac 可能是也可能不是数字。（取决于您的 SQL 设计）

（我认为 j08691 和 nickhar 指出的错误不是解决方案）

# python - 寻找 wikidump python lib 的示例或文档

> ID：16069565
> 
> 赞同：7
> 
> 时间：2013-04-17T20:21:53.637
> 
> 标签：python, mediawiki, wikipedia

我偶然发现了[wikidump](https://pypi.python.org/pypi/wikidump) python 库，我认为它非常适合我。

我可以通过查看源代码来解决问题，但我是 python 新手，我不想编写 BS 代码，因为我需要它的项目对我来说很重要。

我得到了“wiki-SPECIFICDATE-pages-articles.xml.bz2”文件，我需要将其用作获取单篇文章的来源。谁能给我一些正确实现这一目标的指示，或者更好的是，指出一些文档？我找不到任何东西！

（ps如果你有更好和正确的文档库，请告诉我）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-18T19:48:40.710

不确定我是否理解这个问题，但如果你有维基百科转储并且你需要解析维基代码，我会建议[mwparserfromhell](https://github.com/earwig/mwparserfromhell) lib。

另一个强大的框架是[Pywikibot](https://www.mediawiki.org/wiki/Manual:Pywikibot)，它是 Wikipedia 上机器人用户的历史框架（因此，它有许多专门用于*编写*页面的脚本，而不是阅读和解析文章）。它有很多文档（尽管有时已经过时）并且它使用 MediaWiki API。

当然，您可以同时使用它们：PWB 用于获取文章，mwparserfromhell 用于解析。

# r - 有什么方法可以访问 makeActiveBinding 安装的功能？

> ID：16069566
> 
> 赞同：13
> 
> 时间：2013-04-17T20:21:59.493
> 
> 标签：r, scoping

标题基本上说明了一切。

如果我这样做...

```
makeActiveBinding("x", function() runif(2), .GlobalEnv)
x
# [1] 0.7332872 0.4707796
x
# [1] 0.5500310 0.5013099 
```

...然后我有什么方法可以检查`x`以了解它链接到什么功能（如果没有，为什么不呢）？

（在这种情况下，我希望能够了解`x`定义为`function() runif(2)`.）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-17T22:43:39.003

在 中闲逛了一下`envir.c`，我可以让它工作：

```
#include <Rcpp.h>
using namespace Rcpp ;

#define HASHSIZE(x)      LENGTH(x)
#define HASHVALUE(x)    TRUELENGTH(x)

// [[Rcpp::export]]
SEXP get_binding_fun( std::string name, Environment env){
    SEXP symbol = Rf_install( name.c_str() );
    SEXP tab = HASHTAB(env) ;
    SEXP c = PRINTNAME(symbol);

    // finding the hash code for the symbol
    int hashcode = HASHVALUE(c) % HASHSIZE(tab);

    // get the value there from the hash table
    SEXP res = CAR( VECTOR_ELT(tab, hashcode ) ) ;

    return res ;
} 
```

将其保存到`.cpp`文件中，[`sourceCpp`](http://help.r-enthusiasts.com/library/Rcpp/html/sourceCpp.html)并将其与此 R 代码一起使用：

```
> makeActiveBinding("x", function() runif(2), .GlobalEnv)
> get_binding_fun("x", .GlobalEnv)
# function ()
# runif(2) 
```

# regex - 构建正则表达式

> ID：16069570
> 
> 赞同：1
> 
> 时间：2013-04-17T20:22:11.090
> 
> 标签：regex, parsing

我正在为我的代码解析器制作正则表达式。我需要识别字符串文字，我做了这个正则表达式：

```
"([^"]|(\\"))+"? 
```

我需要匹配这些情况：

```
"Some String
"another string \" string
"blah blah \" blah " 
```

而这些不是：

```
"Some String"a
"blah blah \" blah "b 
```

它必须以**“**

之后应该有任何字符，除了**“**

如果有另一个**"**它必须在最后，或者必须用**\转义**

我的正则表达式不起作用:(我在：[http](http://gskinner.com/RegExr/) ://gskinner.com/RegExr/ 测试过如果我有这种情况：

```
"asdasdsd\"sadasd 
```

它只选择：

```
"asdasdsd\" 
```

为什么？

非常感谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:32:48.090

您需要反转 or 操作...这里是在 python 中

```
>>> print re.search(r'"(\\"|[^"])+','"asdasdsd\\"sadasd').group(0)
"asdasdsd\"sadasd 
```

原因是，首先有 [^"] 会吸收你的反斜杠，然后在遇到引号时失败

这个

```
"([^"]|(\\"))+"? 
```

变成

```
"(\\"|[^"])+"? 
```

*注意：我不知道您是否需要“？” 因为您没有指定语言。上面的 python 实现应该有望为您提供所需的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:28:05.587

你必须使用正则表达式吗？

如果您只是在您选择的语言中使用标准字符串解析工具，您的案例似乎会更简单、更清晰。

# ajax - 带有 CORS 的 Ajax 请求未通过

> ID：16069572
> 
> 赞同：1
> 
> 时间：2013-04-17T20:22:22.630
> 
> 标签：ajax, cors

我正在尝试发出跨域请求。我知道 CORS 并想测试来自例如 w3schools 的呼叫作为域。

我将 Jersey 用于 REST API 和 Apache 服务器，并执行了以下操作：

```
 ResponseBuilder rb = Response.status(status).entity(mapper.writeValueAsBytes(data)).type(MediaType.APPLICATION_JSON);
    **EDITED **
    rb.header("Access-Control-Allow-Origin","*");
    rb.header("Access-Control-Allow-Methods","GET, OPTIONS");
    rb.header("Access-Control-Allow-Headers","*");

   return rb.build 
```

当我从浏览器中调用我的 API 查看我的响应标头时，我看到

Access-Control-Allow-Headers:*
Access-Control-Allow-Methods:GET, OPTIONS
Access-Control-Allow-Origin:*
Cache-Control:private
Content-Length:2523
Content-Type:application/json
Date:Wed, 2013 年 4 月 17 日 20:16:20 GMT
到期：星期三，1969 年 12 月 31 日 16:00:00 PST
服务器：Apache-Coyote/1.1

但是当我想使用不同的域（即在 W3 学校）真正测试它时，我有以下内容 -

```
<!DOCTYPE html>
<html>
<head>
<script src="http://code.jquery.com/jquery-1.9.1.min.js">
</script>
 <script>
$(document).ready(function(){
 $("button").click(function(){

   $.ajax({
        url: "url", // this is a real URL replaced with just url
        type: 'GET',

        success: function(content) { console.log("ok"); },
        error: function(XMLHttpRequest, textStatus, errorThrown) {   
            console.log("error");
        },
        complete: function() { console.log("complete"); }
     });
  });
});
</script>
</head>
<body>

<button>Send an HTTP GET request to a page and get the result back</button>

</body> 
```

我总是得到一个 XMLHttpRequest 无法加载:url:。Access-Control-Allow-Origin 不允许来源[http://www.w3schools.com 。](http://www.w3schools.com)

我的请求标头是

接受：*/*
来源：[http ://www.w3schools.com 参考：](http://www.w3schools.com) [http](http://www.w3schools.com/jquery/tryit_view.asp?x=0.8691769954748452)
://www.w3schools.com/jquery/tryit_view.asp?x= 0.8691769954748452 用户代理：Mozilla/5.0（Windows NT 6.1；WOW64 ) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.64 Safari/537.31

我也尝试在 jsfiddle 中测试上述内容，但得到了同样的错误。

注意：我的 URL 仍然在我的本地主机上，这可能是问题吗？

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:21:16.700

所以我解决了我的问题。

我不得不这样做

```
jQuery.ajax({
   url: 'url',
   xhrFields: {
      withCredentials: true
   },
   success : function(data) {alert(data); }
}); 
```

由于我的 REST 服务需要身份验证，我猜它需要在任何事情发生之前进行身份验证，所以一旦我这样做并在我的响应中指定了我的来源，我就能让它工作。

# java - 尝试从 ID3v1 标记读取流派时出现 NullPointerException

> ID：16069574
> 
> 赞同：0
> 
> 时间：2013-04-17T20:22:36.310
> 
> 标签：java, android

我正在尝试使用 Beaglebuddy 和 JaudioTagger 库从 mp3 文件中读取流派标签，我得到一个 NullPointerException 指向：

使用 Beaglebuddy 时，其原因是：

```
songs.add(mp3.getMusicType().toString()); 
```

或者当我使用 JaaudioTagger 时，它是由以下原因引起的：

```
songs.add(f.getID3v1Tag().getGenre().toString()); 
```

我想我没有正确使用这些方法，因为我确定类型已经设置好了。谁能告诉我应该如何获得流派？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:26:08.510

如果您在同一个地方使用这两行，并且两者都获得了 NPE-songs 为空的可能性很大，它是在这两个地方访问的唯一变量。我建议将该行分成多个部分，保存中间值，并在调试器下运行以查看哪个为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-12T12:31:39.147

我使用了 JAudioTagger 2.0.4 库。ID3V1 标签输出：

```
ID3v1Tag         v1Tag  = f.getID3v1Tag();
v1Tag.getFirstGenre(); 
```

# scala - 在 scala 中使用类型参数

> ID：16069577
> 
> 赞同：3
> 
> 时间：2013-04-17T20:22:56.377
> 
> 标签：scala

我正在尝试将一堆 Strings 转换为通用 Stack 。

这是字符串实现的堆栈：

```
class LinkedStackOfStrings {

  var first : Node = _

  def isEmpty : Boolean  = {
    first == null
  }

  def push(itemName : String) = {
    val oldFirst = first
    first = new Node(itemName , oldFirst)
  } 

  def pop = {
    first = first.next

    first.itemName

  }

}

  class Node(val itemName : String , val next : Node) {} 
```

这是我的通用类型堆栈实现：

```
class LinkedStackGeneric[T] {

  var first : NodeGeneric[T] = _

  def isEmpty : Boolean  = {
    first == null
  }

  def push(itemName : T) = {
    val oldFirst = first
    first = new NodeGeneric(itemName , oldFirst)
  } 

  def pop = {
    first = first.next

    first.itemName

  }

}

  class NodeGeneric[T](val itemName : T , val next : NodeGeneric[T]) {} 
```

当我尝试用 data 初始化我的新泛型类时：

```
 val generic = new LinkedStackGeneric
   generic.push("test") 
```

我收到此语法错误：

```
type mismatch; found : String("test") required: Nothing 
```

我究竟做错了什么 ？由于我使用的是类型参数，我是否应该无法将包括 String 在内的任何类型的数据添加到方法 'push' 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:27:04.370

乍一看，我没想到你正在努力工作。

类型推断没有在实例化对象时推断类型的基础。在下一行看到你按下 . 是不够聪明的`String`。因此，您必须这样做：

```
val generic = new LinkedStackGeneric[String]
generic.push("test") 
```

我很想被证明是错误的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T02:26:55.207

您可以通过使`Stack`对象不可变来解决此问题：

```
object ImmutableStack {
  trait ImmutableStack[+A] {
    def isEmpty: Boolean
    def push[B >: A](item: B): ImmutableStack[B] = new <<(this, item)
    def pop: (ImmutableStack[A], Option[A])
    def <<[B >: A](item: B) = push(item)
  }
  case class <<[+A](init: ImmutableStack[A], last: A) extends ImmutableStack[A] {
    override def isEmpty = false
    override def pop: (ImmutableStack[A], Option[A]) = (init, Some(last))
    override def toString = "" + init + " << " + last
  }
  case object Nst extends ImmutableStack[Nothing] {
    override def isEmpty = true
    override def pop = (Nst, None)
    override def toString = "Nst"
  }
} 
```

然后我们有：

```
scala> import ImmutableStack._
import ImmutableStack._

scala> val intStack = Nst << 5 << 4 << 3 << 2 << 1
intStack: ImmutableStack.ImmutableStack[Int] = Nst << 5 << 4 << 3 << 2 << 1

scala> intStack.pop
res0: (ImmutableStack.ImmutableStack[Int], Option[Int]) = (Nst << 5 << 4 << 3 << 2,Some(1))

scala> val firstItems << lastItem = intStack
firstItems: ImmutableStack.ImmutableStack[Int] = Nst << 5 << 4 << 3 << 2
lastItem: Int = 1

scala> val strStack = Nst << "A" << "B" << "C"
strStack: ImmutableStack.ImmutableStack[String] = Nst << A << B << C

scala> val fs << lt = strStack
fs: ImmutableStack.ImmutableStack[String] = Nst << A << B
lt: String = C

scala> val anyStack = Nst << 1 << "Str" << 'Z'
anyStack: ImmutableStack.ImmutableStack[Any] = Nst << 1 << Str << Z

scala> val st << x1 << x2 << x3 = anyStack
st: ImmutableStack.ImmutableStack[Any] = Nst
x1: Any = 1
x2: Any = Str
x3: Any = Z 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T20:49:02.590

`Nothing`Scala 的类型推理引擎因在像您这样的情况下进行推理而臭名昭著。简而言之，Scala 的类型层次结构既有顶部 ( `Any`) 也有底部 ( `Nothing`)，所有其他类型都必须存在于它们之间。所有类型都有一个超类型`Any`, 并且`Nothing`是所有类型的公共子类型。

这对你意味着什么？好吧，当你实例化你的`LinkedStackGeneric`实例时，你省略了类型参数的任何类型`T`。这向 Scala 表明它需要推断类型（因为作为静态类型语言，它必须在编译时确定所有内容的类型）。在这种情况下，Scala 的类型推理引擎选择不佳（从用户期望的角度来看），并选择底部类型 ( `Nothing`) 作为参数的类型`T`。有了这个，你去添加你的值“测试”，Scala编译器（正确地）抱怨`String`不能添加到 a `LinkedStackGeneric[Nothing]`，因为即使所有`Nothing`s 都是 s `Strings`，但并非所有（或可能不是任何）`String`s 都是`Nothing`s 。

为好奇的人提供更多注意事项。`Nothing`实际上是所谓的无人居住类型，这意味着永远不会有 type 的实例`Nothing`。所以，即使我说不是所有`String`的 s 都是`Nothing`s，实际上 a 不可能`String`是 a `Nothing`。

# android - Android中的自动启动录音

> ID：16069579
> 
> 赞同：0
> 
> 时间：2013-04-17T20:23:12.157
> 
> 标签：android, audio, record, autostart

我正在使用意图开始录音活动，但是当活动打开时它不会开始记录。我怎样才能自动开始记录？也许有一些额外的东西可以做，但我在互联网和 android 开发人员上找不到任何东西。这是我的代码

```
Intent intent=new Intent(MediaStore.Audio.Media.RECORD_SOUND_ACTION);
context.startActivity(intent); 
```

我知道这是可以做到的，因为我找到了一个可行的例子。但我无法复制它。先谢谢了XD

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:38:31.270

您正在启动另一个应用程序来进行录音。它将在该应用程序需要时启动。如果您想立即开始，请使用 AudioRecord API 并自己实现录制。

# c++ - 遍历向量时移动位置

> ID：16069582
> 
> 赞同：0
> 
> 时间：2013-04-17T20:23:14.267
> 
> 标签：c++, c++11

您如何替换您遍历向量的位置？我试过类似的东西：

```
for(auto x : vect+2) 
```

但这不起作用。我确信有一个简单的解决方案，但我无法在网上找到任何东西。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T20:29:32.223

如果您想使用基于范围的`for`，您可以使用[**Boost.Range**](http://www.boost.org/libs/range/)`begin() + 2`创建一个从向量 ( )的第三个元素开始的范围：

```
for (auto x : boost::make_iterator_range(begin(v) + 2, end(v)))
{
    std::cout << x << " ";
} 
```

这是一个简单的例子：

```
#include <iostream>
#include <vector>
#include <algorithm>
#include <boost/range.hpp>
#include <boost/range/adaptors.hpp>

int main()
{
    std::vector<int> v(10);
    iota(begin(v), end(v), 1);

    for (auto x : boost::make_iterator_range(begin(v) + 2, end(v)))
    {
        std::cout << x << " ";
    }
} 
```

相反，如果您想遍历每个第二个元素，则可以按如下方式更改范围：

```
namespace rng = boost::adaptors;
for (auto x : v | rng::strided(2))
{
    std::cout << x << " ";
} 
```

在一个完整的程序中是：

```
#include <iostream>
#include <vector>
#include <algorithm>
#include <boost/range.hpp>
#include <boost/range/adaptors.hpp>

int main()
{
    namespace rng = boost::adaptors;

    std::vector<int> v(10);
    iota(begin(v), end(v), 1);

    for (auto x : v | rng::strided(2))
    {
        std::cout << x << " ";
    }
} 
```

Boost.Range 非常灵活，因此您可以例如*组合*上面的两个适配器：

```
for (auto x : boost::make_iterator_range(begin(v) + 2, end(v)) |
              rng::strided(3))
{
    std::cout << x << " ";
} 
```

* * *

如果您不想或不能使用 Boost，则可以使用`for`带有迭代器的经典循环：

```
for (auto i = begin(v) + 2; i != end(v); ++i)
{
    std::cout << *i << " ";
} 
```

这是整个程序的样子：

```
#include <iostream>
#include <vector>
#include <algorithm>

int main()
{
    std::vector<int> v(10);
    iota(begin(v), end(v), 1);

    for (auto i = begin(v) + 2; i != end(v); ++i)
    {
        std::cout << *i << " ";
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:37:46.357

这可以非常简单地实现，并且有许多解决方案可以适应任何编程风格。

# 经典方法

```
int main()
{    
    std::vector<int> v(10);
    std::iota(v.begin(), v.end(), 1);

    for (auto i = v.begin() + 2; i != v.end(); ++i)
    {
        std::cout << *i << " ";
    }
} 
```

# 函数式方法

```
int main()
{    
    std::vector<int> v(10);
    std::iota(v.begin(), v.end(), 1);

    std::for_each(v.begin() + 2, v.end(), [](int val)
        {
            std::cout << val << " ";
        }
    );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T21:11:17.280

您可以添加一个轻量级包装器，使其与基于范围的以下应用程序一起使用：

```
#include <iostream>
#include <vector>
#include <iterator>

namespace range
{
    template <typename C>
    struct make_range
    {
        C t;
        make_range(C t, int offset)
        : t(std::begin(t) + offset, std::end(t))
        {}
        auto begin() -> decltype(t.begin())
        {
            return t.begin();
        }
        auto end() -> decltype(t.end())
        {
            return t.end();
        }
    };
}

int main()
{
    std::vector<int> v{1, 2, 3, 4, 5}; 
    for (auto i : range::make_range<decltype(v)>(v, 2))
    {
        std::cout << i << std::endl;
    }
} 
```

也许只存储迭代器会更好：

```
namespace range
{
    template <typename C>
    struct make_range
    {
        typename C::iterator beg_iter;
        typename C::iterator end_iter;
        make_range(C& t, int offset)
        : beg_iter(std::begin(t) + offset),  end_iter(std::end(t))
        {}
        auto begin() -> decltype(beg_iter)
        {
            return beg_iter;
        }
        auto end() -> decltype(end_iter)
        {
            return end_iter;
        }
    };
} 
```

# linux - 在 for 循环中从数组创建目录

> ID：16069583
> 
> 赞同：1
> 
> 时间：2013-04-17T20:23:16.073
> 
> 标签：linux, arrays, bash, scripting, redhat

我有一组客户姓名，我想用它们来制作目录。下面是我正在运行的代码：

```
$ echo "$customerArray=( customer1 customer2 customer3 customer4 customer5 )"

for customerName in $( customerArray ); 
do
    mkdir -p /home/$customerName
    mkdir -p /home/$customerName/outbound
    mkdir -p /home/$customerName/outbound_backup
    mkdir -p /home/$customerName/dropoff
done 
```

谁能向我解释我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:26:50.893

这将是使用 [大括号扩展的可行替代方案](http://mywiki.wooledge.org/BraceExpansion)

```
customerArray=(customer1 customer2 customer3 customer4 customer5)
for customerName in ${customerArray[*]}
do
  mkdir -p /home/$customerName/{outbound,outbound_backup,dropoff}
done 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T20:36:34.390

您不能在字符串文字内设置变量，我很确定这`$( customerArray )`也是无效的。请尝试以下操作：

```
customerArray=(customer1 customer2 customer3 customer4 customer5)
for customerName in ${customerArray[@]}
do
    ...
done 
```

您需要将数组变量引用为`${customerArray[@]}`或`${customerArray[*]}`。[bash 手册](http://www.gnu.org/software/bash/manual/html_node/Arrays.html#Arrays)对此进行了更深入的描述。

# struts2 - 两个Struts过滤器之间的区别？

> ID：16069587
> 
> 赞同：5
> 
> 时间：2013-04-17T20:23:22.983
> 
> 标签：struts2, filter, struts

*我在web.xml*中看到了两种 Struts 2 过滤器。

1.  `org.apache.struts2.dispatcher.FilterDispatcher`
2.  `org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter`

请告诉我这两个过滤器之间的区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T02:38:27.707

好吧，由于以下原因引入了新过滤器

1.  有很多发布与`FilterDispatcher`它的部署。
2.  新过滤器提供了一种更好的方式来启用自定义和覆盖。
3.  让开发人员清楚地知道哪些过滤器正在执行哪些流程。
4.  使调度过程更加灵活，以支持 OSGi 或插件系统中的本机操作。

其中最主要的驱动原因是，早期的过滤器调度程序有很多问题，其他原因是转向 OSGI。

# ruby-on-rails - 使用创建和更新操作将单个 Rails 表单管理到其他控制器

> ID：16069589
> 
> 赞同：3
> 
> 时间：2013-04-17T20:23:26.877
> 
> 标签：ruby-on-rails, controller, routes, form-for

我是新来的铁路。我使用 rails 3.0.5 。

我有一个 EMPLOYEE 资源，但我想用另一个外部控制器 (emp_profile_controller) 来管理它。这个外部控制器 (emp_profile_controller) 管理一些操作 (index, new_employee, create_employee, edit_employee, update_employee ecc..)。

我这个控制器的路线是：

```
controller :emp_profile do
get 'emp_profile' => :index
get 'emp_edit_profile' => :edit_employee
put 'emp_edit_profile' => :update_employee
get 'new_employee' => :new_employee
post 'new_employee' => :create_employee
get 'emp_list' => :emp_list
end 
```

我如何使用一种表单来处理此控制器中的创建和更新操作？

我试过：

```
form_for(@employee, :url => { :controller => "emp_profile"}) do |f| 
```

但它不起作用。

如果我一次只管理一项操作（创建或更新），则 url_for 有效，例如：

```
form_for(@employee, :url => { :controller => "emp_profile", :action => "update_employee" } 
```

但是我怎样才能用一种形式处理这两个动作呢？

感谢您的光临，如果我问了一个愚蠢的问题，我深表歉意。

**编辑**

现在，我解决了检查表单文件中是否存在对象，如果存在，我使用 UPDATE 操作路径设置一个变量，否则，我使用 CREATE 操作路径设置一个变量。因此，在 form_for 语句中，我将 url_for 与上述变量一起使用。

```
<% if @employee.new_record?
  action = "create_employee"
  method = "post"
 else
  action = "update_employee"
  method = "put"
end
 %>

form_for(@employee, :url => { :controller => "emp_profile", :action => action }, :method => method 
```

我不认为这是最好的方法，但它有效，我只能使用一个表单文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-25T08:21:03.840

由于您的模型名称和控制器名称不同，您可以将此行添加到您的路线

```
resources :employees,:controller=>"emp_profile",:path=>"emp_profile" 
```

将create_employee、update_employee的方法名分别更改为create和update。

并更改您的 form_for 如下所示

```
<%= form_for @employee do |f| %>
....
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T22:54:15.803

首先，如果你想更新一些东西，这个对象应该存在。计划如何找到它，我不知道（因为方法不同，取决于背景）。

有两种方法可以解决这个问题。您可以只检查视图文件中是否存在对象，如果存在，则引用表单进行更新，否则进行创建。另一种方法是在控制器中进行。

例如：

```
def create
@employee=Employee.find_by_name('Jack Black') #for example
if @employee!=nil
render :action=> 'update'
else
@employee=Employee.new(:employee)
@employee.save
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T11:07:50.573

据我了解，您想使用表单提交在同一个控制器上执行两个不同的操作，这是不可能的，您只能使用表单提交执行一个操作，因为表单正在到达该操作应该呈现的操作控制器执行代码末尾的一些视图，如果可以使用表单提交的操作，rails 将如何知道要呈现哪个视图？？？（这就是为什么不可能）。

如果您想在控制器上执行更多代码，正确的方法是调用一个包含您要执行的代码的方法，该方法应该在模型中，因为编写代码是一个好习惯模型中的所有大量代码块，并使控制器尽可能远离代码:-)

希望这可以帮助。

# c# - 如何为 SslStream.AuthenticateAsServer() 创建证书？

> ID：16069591
> 
> 赞同：1
> 
> 时间：2013-04-17T20:23:36.127
> 
> 标签：c#, .net, ssl, x509certificate

我正在尝试编写一个使用 SSL 进行通信的服务器应用程序。接受连接后，我相信我必须调用`SslStream.AuthenticateAsServer`. 但是，这需要一个证书，我不明白如何创建一个。

我遵循了[这个问题](https://stackoverflow.com/questions/14214396)的答案中给出的建议：

> 我运行以下命令来创建 server.pfx 文件：
> 
> ```
> makecert.exe -r -pe -n "CN=localhost" -sky exchange -sv server.pvk
> server.cer pvk2pfx -pvk server.pvk -spc server.cer -pfx server.pfx 
> ```
> 
> 然后我在代码中加载它：
> 
> ```
> certificate = new X509Certificate2("server.pfx", "password"); 
> ```

然而，我确实这样做了，我得到一个`CryptographicException`说法“指定的网络密码不正确。”这显然是错误的，因为我使用了密码`x`，很难打错。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-09-30T20:18:21.887

[如何：创建自己的测试证书](http://msdn.microsoft.com/en-us/library/ff699202.aspx)

# java - Java 类无法在 Linux 中找到或加载主类，但 Windows 可以

> ID：16069600
> 
> 赞同：0
> 
> 时间：2013-04-17T20:24:37.710
> 
> 标签：java, linux, process

使用进程构建器在自己的操作系统进程中启动其他 Java 应用程序。该实现适用于 Windows 7，但不适用于 Linux。两台机器都使用 Java 1.7。这是一些示例代码：

```
//Windows OK, but Linux Could not find or load main class 
//weka.subspaceClusterer.MySubspaceClusterEvaluation 

ArrayList<String> commands = new ArrayList<String>();
commands.add("java");
commands.add("-cp");
commands.add("\".:lib/*\"");
commands.add("weka.subspaceClusterer.MySubspaceClusterEvaluation");
procBuilder = new ProcessBuilder();
procBuilder.inheritIO();
procBuilder.command(commands);
Process proc = procBuilder.start(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:28:10.990

类路径分隔符`;`在 Windows 下，但`:`在 Unix 下。

考虑创建一个可运行的 jar，您的类路径存储在 MANIFEST.MF 条目中，因此您只需执行`java -jar whatever.jar`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-20T16:27:39.387

我在 Mac OS X 上遇到了类似的问题。它在终端中有效，但在 Eclipse 中无效。如果我删除了类路径字符串周围的引号，它对我有用。当传递给 ProcessBuilder 的任何参数周围有引号时，我猜 Eclipse JVM 不喜欢它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:48:37.770

您的代码看起来正确。它只是找不到您的类文件。尝试设置进程的工作目录：

```
procBuilder.directory(new File("package/structure/starts/here")); 
```

# javascript - 进入和离开主链接时如何保持下拉菜单子导航过渡一致？

> ID：16069601
> 
> 赞同：0
> 
> 时间：2013-04-17T20:24:43.377
> 
> 标签：javascript, jquery

我创建了一个下拉菜单，其中每个主链接都有一个附加事件`mouseenter`，`mouseleave`首先检查是否有与链接关联的子导航​​列表，然后将菜单滑动到可见性。如果您输入链接 1 并将下拉菜单滑入然后滑出，则此方法可以正常工作，但是如果您输入链接 1，然后将鼠标悬停在链接 2 上，则`slideUp()`一致性已经消失，理想情况下，我想确保活动菜单在新`mouseenter`代码之前已关闭再次运行。谁能建议我如何实现这一目标？

**小提琴链接：http:** [//jsfiddle.net/f3ZpN/1/](http://jsfiddle.net/f3ZpN/1/)

**JS**

```
var mainNav = $('.main-nav'),
    topLevelLinks = mainNav.children('li'),
    subNav = $('.sub-nav-panel'),
    subNavPanel,
    isActive = false,
    inner,
    innerLink;

topLevelLinks.on({
    mouseenter: function () {
        var el = $(this);

        if (el.children('.sub-nav').length > 0) {
            inner = el.children('.sub-nav');

            subNav.stop(true, true).slideDown(function () {
                inner.fadeIn();
            });
        }
    },
    mouseleave: function () {
        //make sure this finishes before mouseenter is run again?
        inner.fadeOut(function() {
            subNav.slideUp();
        });
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:42:59.157

`subNav.slideUp()`如果没有仍然可见的子菜单，您只想调用。这是使用现有代码的简单修复：http: [//jsfiddle.net/PkAw3/](http://jsfiddle.net/PkAw3/)它仍然不完美，但可能会帮助您。

```
if (topLevelLinks.children('.sub-nav').filter(":visible").length === 0) {
    subNav.slideUp();
} 
```

## 根据评论更新

有点脑筋急转弯......所以我们不想在 mouseleave 的动画完成之前调用 mouseenter 的动画，反之亦然。您可以使用`promise()`和`done()` [jQuery 函数](http://api.jquery.com/promise/)来做到这一点。默认情况下，`promise()`会等到所有元素的动画都完成后再执行`done()`。查看 jsfiddle [http://jsfiddle.net/F75yV/1/上的更新](http://jsfiddle.net/F75yV/1/)

# xaml - MVVM Light, Metro App, Inheriting ViewModelBase 打破设计模式

> ID：16069603
> 
> 赞同：0
> 
> 时间：2013-04-17T20:24:52.690
> 
> 标签：xaml, mvvm, microsoft-metro, windows-store-apps, mvvm-light

我有一个奇怪的问题，我似乎找不到任何答案。

我正在通过 NuGet 使用 MVVM Light 使用 Visual Studio 2012 构建 Metro Store 应用程序。

在设计和添加数据上下文 xaml 代码时，studio 给了我一个红色的 swiggly 错误“对象引用未设置为对象的实例”。

```
DataContext={Binding MainVM, Source={StaticResource Locator}} 
```

我终于把它缩小到我的视图模型中的继承。我有一个基本视图模型，我的所有视图模型都继承自声明如下：

```
public class BaseViewModel : ViewModelBase
{
} 
```

然后显然我所有的视图模型都是这样的：

```
public class MainViewModel : BaseViewModel
{
} 
```

现在，在运行时一切正常（这让我很困惑），但是设计模式中断了。

但是，如果我删除继承并让我的视图模型直接继承 ViewModelBase，那么在设计模式下一切都很好：

```
public class MainViewModel : ViewModelBase
{
} 
```

我认为可能是代码中的某些内容导致了问题，因此我将所有内容都注释掉了，除了编译所需的内容并仍然收到相同的结果。

任何人似乎都有这个问题，或者知道我可能做错了什么？在使用 MVVM 处理 Silverlight 或 WPF 应用程序时，我通常使用相同的模式，那里的情况似乎很好。

只是一个旁注，我的 ViewModelLocator 确实有一个 MainVM 属性，它返回 MainViewModel 类。

**更新** 在阅读了 LBugnion 和 Will 的评论后，我正准备调试设计模式时发现我愚蠢地忘记在 BaseViewModel 中注释掉我的代码。我确实发现那里有破坏代码。设计模式不喜欢下面这行：

```
private CoreDispatcher UIDispatcher = Windows.UI.Core.CoreWindow.GetForCurrentThread().Dispatcher; 
```

我用来更新代码中的 UI 线程。我猜（哪个更有经验的人可能会插话）设计模式下没有 UI 线程？

通常我使用“IsInDesignMode”属性使我的视图模型几乎无法用于设计，但显然在这里忘记了这样做，所以我将上面的行更改为

```
private CoreDispatcher UIDispatcher = IsInDesignModeStatic ? null : Windows.UI.Core.CoreWindow.GetForCurrentThread().Dispatcher; 
```

我的混蛋

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:54:05.653

一直在发生，主要是因为您的类型中的代码正在设计器中执行。

是的，代码实际上可以在设计器中执行。设计器会将您的程序集加载到设计图面的 AppDomain 中，实例化您的类型，并将该实例用于设计图面。

因此，如果你有这样的事情：

```
public MyView : UIElement
{
    public MyView()
    {
        InitializeComponent();
        var database = GetDatabaseObject();
        database.OpenLikeWeAreInProduction();
        FillTheUiLol(database.GetAllKindsOfCrap());
    }
} 
```

它很可能会因为您的数据库不存在而中断，您无法从 app.config 等中找到连接字符串等。

处理这个问题的方法是，只要您有可能在设计器中执行的代码（例如在构造函数中、在属性更改事件处理程序中等），您应该[`DesignerProperties.GetInDesignMode(new DependencyObject())`](http://msdn.microsoft.com/en-us/library/system.componentmodel.designerproperties.getisindesignmode.aspx)在执行保证的代码之前确定您是否在设计器中打破设计师。

不幸的是，有时很难确定*哪些*代码正在破坏。对于难以推断的故障，我唯一的解决方案是记下异常类型，启动另一个 Visual Studio 实例，附加到第一个实例，然后将调试配置为始终中断该异常类型。

# php - php mysql 多个 OR 语句

> ID：16069606
> 
> 赞同：0
> 
> 时间：2013-04-17T20:25:15.800
> 
> 标签：php, mysql

我正在尝试运行一个简单的 mysql 查询，但它每次都没有返回任何内容。出于某种原因，似乎有多个“OR”语句是原因。为什么？

返回空

```
mysql_query("SELECT * FROM table WHERE lower(Name)='arabic' or lower(Sub Name)='arabic' or lower(Language)='arabic'"); 
```

返回结果

```
mysql_query("SELECT * FROM table WHERE lower(Name)='arabic'"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:30:51.063

你的列名有空格你应该用`符号包围列名

```
mysql_query("SELECT * FROM table WHERE lower(`Name`)='arabic' or lower(`Sub Name`)='arabic' or lower(`Language`)='arabic'"); 
```

# php - 如何正确更新我的数据库

> ID：16069609
> 
> 赞同：0
> 
> 时间：2013-04-17T20:25:20.180
> 
> 标签：php, mysql

我正在尝试使用您从下拉菜单中选择的内容更新我的表格，然后将文本放入文本框中，它将更新特定列（fixture_result）。输出告诉我它已更新，但是当我查看数据库时它还没有完成。

我不知道这个问题以前是否被问过。我查看了一些与更新相关的表格，但它们并没有太大帮助；但是，如果您看到我做错了什么，我将不胜感激。

```
<html>
<head>
    <title>The Score</title>
</head>
<body>
    <form id="form1" name="form1" method="post">
    Fixture:
        <select name='NEW'>
            <option value="">--- Select ---</option> <br>
            <?php
                if(isset($db_name)&&$db_name!=""){
                    $select=$_POST['NEW'];
                }
            ?>
            <?php
                $list=mysql_query("select * from Fixture_Information order by fixture_id asc");

                while($row_list=mysql_fetch_assoc($list)){
            ?>
            <option value="<?php echo $row_list['fixture_id']; ?>">
                <?php if($row_list['fixture_id']==$select){ echo "selected"; } ?>
                <?php echo $row_list['fixture_name']; ?>
            </option>
            <?php
                }
            ?>
        Input Score: <input type="text" name="myusername">
        <input type="submit" value="Submit">
        <?php
            $data =$_POST['myusername'];
            $select=$_POST['NEW'];
            $sql=("UPDATE Fixture_Information
                set fixture_result = '$data'
                where fixture_name = '$select'");
            $checkresult = mysql_query($sql); 
            if ($checkresult) echo 'update query succeeded'; 
                else echo 'update query failed'; 
            mysql_close(); 
        ?>
        </select>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:34:43.560

您只检查更新语句的成功，这就是`true`您的情况。但是您不检查更新了多少行。你可以用[`mysql_affected_rows`](http://www.php.net/manual/en/function.mysql-affected-rows.php)这个

```
if (mysql_affected_rows() > 0)
    echo 'update query succeeded';
else
    echo 'update query failed'; 
```

# php - 从 ftp 或 php 运行 Bash 文件 (.sh)

> ID：16069610
> 
> 赞同：1
> 
> 时间：2013-04-17T20:25:20.497
> 
> 标签：php, linux, bash, shell, ftp

让我承认，我从来没有从 php 运行过 bash 文件......尽管我尝试使用谷歌搜索并使用`shell_exec`& ，但我无法做到这一点`system()`

我有一个 bash 脚本，它收回了 magento db，文件名为`backu.sh`. 该文件位于 magento root `/var/www/html/backup.sh`，我该如何运行这个文件？

我试过到目前为止

`$output=shell_exec('sh backup.sh >/dev/null &' ); echo "<pre>$output</pre>";`

但它没有显示任何内容，我也看不到生成的文件......我的 bash 脚本看起来像

```
`#!/bin/sh

# Connection parameters
DBHOST=
DBUSER=
DBNAME=
TBLPRF=

# Include DB logs option
SKIPLOGS=1

# Magento folder
MAGENTOROOT=./
LOCALXMLPATH=${MAGENTOROOT}app/etc/local.xml

# Output path
OUTPUTPATH=$MAGENTOROOT

# Content of file archive
DISTR="
app
downloader
errors
includes
js
lib
pkginfo
shell
skin
.htaccess
cron.php
cron.sh
get.php
index.php
install.php
mage
*.patch"

# Ignored table names
IGNOREDTABLES="
core_cache
core_cache_option
core_cache_tag
core_session
log_customer
log_quote
log_summary
log_summary_type
log_url
log_url_info
log_visitor
log_visitor_info
log_visitor_online
enterprise_logging_event
enterprise_logging_event_changes
index_event
index_process_event
report_event
report_viewed_product_index
dataflow_batch_export
dataflow_batch_import"

# Get random file name - some secret link for downloading from magento instance :)
MD5=`echo \`date\` $RANDOM | md5sum | cut -d ' ' -f 1`
DATETIME=`date -u +"%Y%m%d%H%M"`
CODEFILENAME="$OUTPUTPATH$MD5.$DATETIME.tar.gz"
DBFILENAME="$OUTPUTPATH$MD5.$DATETIME.sql.gz"

# Create code dump
DISTRNAMES=
for ARCHPART in $DISTR; do
    if [ -r "$MAGENTOROOT$ARCHPART" ]; then
        DISTRNAMES="$DISTRNAMES $MAGENTOROOT$ARCHPART"
    fi
done
if [ -n "$DISTRNAMES" ]; then
    echo nice -n 15 tar -czhf $CODEFILENAME $DISTRNAMES
    nice -n 15 tar -czhf $CODEFILENAME $DISTRNAMES
fi

# Get mysql credentials from local.xml
getLocalValue() {
    PARAMVALUE=`sed -n "/<resources>/,/<\/resources>/p" $LOCALXMLPATH | sed -n -e "s/.*<$PARAMNAME><!\[CDATA\[\(.*\)\]\]><\/$PARAMNAME>.*/\1/p" | head -n 1`
}

if [ -z "$DBHOST" ]; then
    PARAMNAME=host
    getLocalValue
    DBHOST=$PARAMVALUE
fi
if [ -z "$DBUSER" ]; then
    PARAMNAME=username
    getLocalValue
    DBUSER=$PARAMVALUE
fi
if [ -z "$DBNAME" ]; then
    PARAMNAME=dbname
    getLocalValue
    DBNAME=$PARAMVALUE
fi
if [ -z "$TBLPRF" ]; then
    PARAMNAME=table_prefix
    getLocalValue
    TBLPRF=$PARAMVALUE
fi

if [ -z "$DBHOST" -o -z "$DBUSER" -o -z "$DBNAME" ]; then
    echo "Skip DB dumping due lack of parameters host=$DBHOST; username=$DBUSER; dbname=$DBNAME;";
    exit
fi
CONNECTIONPARAMS=" -u$DBUSER -h$DBHOST -p $DBNAME --single-transaction --opt --skip-lock-tables"

# Create DB dump
IGN_SCH=
IGN_IGN=
if [ -n "$SKIPLOGS" ] ; then
    for TABLENAME in $IGNOREDTABLES; do
        IGN_SCH="$IGN_SCH $TBLPRF$TABLENAME"
        IGN_IGN="$IGN_IGN --ignore-table='$DBNAME'.'$TBLPRF$TABLENAME'"
    done
fi

if [ -z "$IGN_IGN" ]; then
    CODEDUMPCMD="nice -n 15 mysqldump $CONNECTIONPARAMS"
else
    CODEDUMPCMD="( nice -n 15 mysqldump $CONNECTIONPARAMS $IGN_IGN ; nice -n 15 mysqldump --no-data $CONNECTIONPARAMS $IGN_SCH )"
fi

CODEDUMPCMD="$CODEDUMPCMD | nice -n 15 gzip > $DBFILENAME"
echo $CODEDUMPCMD
eval "$CODEDUMPCMD"
` 
```

请帮忙...

谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:32:53.420

**尝试：**

```
$output=shell_exec('/path/to/sh /var/www/html/backup.sh' ); 
echo "<pre>$output</pre>"; 
```

通常，`/path/to/sh`是`/bin/sh`。

此外，您可以在`backup.sh`脚本末尾添加这一行：

```
echo "backup.sh has been executed" >> /var/www/html/backupstatus.txt 
```

这样，如果您的脚本已成功执行，`backupstatus.txt`将创建一个名为的文件，其内容将填充为`"backup.sh has been executed"`.

# javascript - 对象方法中的“this”与事件处理程序中的“this”

> ID：16069612
> 
> 赞同：4
> 
> 时间：2013-04-17T20:25:27.660
> 
> 标签：javascript, jquery, jquery-plugins

**编辑**
答案指出，关键字`this`在 jQuery 中的使用与在任何 JavaScript 代码中一样。也就是说，对象方法将对象本身接收为`this`，这就是函数所发生的情况`$.fn`（它们在 jQuery 对象上调用）。事件处理函数是回调函数，它们不是对象方法，它是调用者决定`this`在函数内部引用什么。它通常引用一个 DOM 元素。

**原始问题**

`this`和之间的区别`$(this)`通常被解释为`this`引用一个**DOM 对象**，而`$(this)`引用一个**jQuery 对象**（一个带有 jQ​​uery 包装器的 DOM 元素）。
在下面的示例中，处理函数`this`作为 DOM 元素传递，通过包装它，`$()`我们从中创建一个 jQuery 对象，因此我们可以在其上使用位于`$.fn`命名空间中的函数。

```
$('div').on('click', function(event){
    event.preventDefault();
    $(this).css('backgroundColor', 'red');
}); 
```

但是，我刚刚在 learn.jquery.com 上看到了这个解释：

**[插件 | jQuery学习中心](http://learn.jquery.com/plugins/basic-plugin-creation/ "插件 |  jQuery学习中心")**

```
$.fn.greenify = function() {
this.css( "color", "green" );
};
$("a").greenify(); // makes all the links green

// Explanation provided by the author of the article:
// "Notice that to use css(), another method, we use this, not $( this ).
//  This is because our greenify function is a part of the same object as css()." 
```

这是否意味着`this`在传递给事件处理函数时引用了一个 DOM 对象，但在传递给 jQuery 对象方法时引用了一个 jQuery 对象？
事实上，这是有道理的，因为该方法是在 jQuery 对象上调用的，因此将 jQuery 对象传递给它是合乎逻辑的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T20:29:32.053

“this”标识符与 jQuery 无关，它是 javascript 的一个组成部分。

您可以查看此链接，该链接提供了“this”关键字的详细说明：http: [//www.devig.me/javascript-this-keyword/](http://www.devign.me/javascript-this-keyword/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T20:29:56.470

在一个 jQuery 插件方法`this`中已经是 jQuery 对象。因此，您可以直接在`this`.

这与事件处理程序无关。这是因为当在对象（本例中为 jQuery 对象）上调用方法时，javascript 设置`this`为指向该对象。因此，由于本例中的对象是 jQuery 对象，所以就是这样`this`。

事件处理程序回调函数不是方法调用，因此它的工作方式不同 - 它是一个回调，回调的调用者决定`this`使用`.call()`或设置什么`.apply()`。对于大多数事件处理程序回调，代码专门决定设置`this`为触发事件的 DOM 对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T20:28:10.767

那是因为在您的`greenify`插件中，没有涉及回调，没有事件处理程序。

它被称为

```
$("a").greenify(); 
```

这意味着`this`，在函数内部，是接收者，也就是说`$("a")`，就像`this`在`b`执行时`a.b();`一样`a`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T20:31:30.733

`.greenify``jQuery`作为实例上的方法调用。如果你查看 jQuery 源代码，你会发现

```
jQuery.fn = jQuery.prototype = {
  // All the goodies... 
```

这说明你的理解是正确的。

# google-maps-api-3 - 谷歌地图标签信息框在外部链接上打开？

> ID：16069620
> 
> 赞同：0
> 
> 时间：2013-04-17T20:25:58.890
> 
> 标签：google-maps-api-3, google-maps-markers

我正在尝试创建一个网页，其中包含一个带有四个标记的 Google Maps API，可以单击这些标记以打开一个带有自己信息的信息框。这完全可以正常工作，但是我在地图下方也有图像，我想将其链接到 Google Maps API 并打开每个链接所代表的标记，但我似乎无法理解它。我已经尝试查看其他此类问题并尝试了他们的答案，但我不知道如何将其实现到我自己的代码中。

这是我到目前为止的代码：

```
function initialize() {
    var mapOptions = {
        center: new google.maps.LatLng(53.487509,-2.240009),
        zoom: 14,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var map = new google.maps.Map(document.getElementById("mapContainer"), mapOptions);

    var infoWindow = new google.maps.InfoWindow;

    var myLocations = [
        ["Manchester Town Hall", "This magnificent building was designed in Victorian Gothic style by Alfred Waterhouse and opened in 1877\. Amongst its many treasures are the Ford Maddox Brown murals which are monument to the ideas of Victorian Manchester, portraying science, invention, education, trade and textile industry.", "townhall.jpg", "http://www.manchester.gov.uk/", 53.479366, -2.244671],
        ["Manchester Royal Exchange Theatre", "Situated in the heart of Manchester, the Royal Exchange is an award-winning producing Theatre with a history spanning five decades. Known for producing classics such as William Shakespeare, we're also one of the country's leading theatres for new writing, with over 125 premieres in the theatre history!", "royalexchange.jpg", "http://www.royalexchange.co.uk/",  53.482696, -2.244588],
        ["Afflecks's Palace", "Afflecks is an emporium of eclecticism in Manchester’s Northern Quarter. A fantastic place to shop for anything unique, handmade or quirky! With over 73 units filled with individual sellers, you'll be sure to find something you love, or something for someone else!", "afflecks.jpg", "http://www.afflecks.com/", 53.482677, -2.23634],
        ["The Printworks", "The Printworks is a buzzing, state of the art entertainment complex located in the heart of Manchester City Centre. It is home to a range of restaurants, bars and clubs alongside a cinema and gym. The Printworks has something to offer both day and night.", "printworks.jpg", "http://www.theprintworks.com/", 53.485061, -2.241509]
        ];

    function infoCallback(infowindow, marker) { 
        return function() {
        infowindow.open(map, marker);
    };
   }    

   function setMarkers(map, myLocations) {  
    for (var i in myLocations)     {                                        
        var name    = myLocations[i][0];
        var info    = myLocations[i][1];
        var image   = myLocations[i][2];
        var url     = myLocations[i][3];
        var lat     = myLocations[i][4];
        var lng     = myLocations[i][5];
        var latlngset;
        latlngset = new google.maps.LatLng(lat, lng);
        var marker = new google.maps.Marker({  
          map: map,  title: name,  position: latlngset  
        });

        var content = 
        '<div class="mapContent"><h3>' + name + '</h3>' + '<img width="192" height="128" src="images/' + image + '"> <div class="mapContentText">' + info + '</div> <h4><a href="' + url + '" target="_blank">' + url + '</a></h4> </div>';

        var infowindow = new google.maps.InfoWindow();
          infowindow.setContent(content);
          google.maps.event.addListener(
            marker, 
            'click',
            infoCallback(infowindow, marker)
          );
      }
    }           
    setMarkers(map, myLocations);
  }; 
```

以及带有地图的 HTML 片段以及出现在其下方的图像，我想分别链接到它们各自的地图标记：

```
<!DOCTYPE html>
<head>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA5Iwz01YK3kUnBKFSB7W0PML2XcIChJCc&sensor=false"></script>
    <script src="js/mapScript.js"></script>       
</head>

<body onload="initialize()">

    <section id="mapContainer">
    </section>

    <img src="images/tag_townhall.jpg">
    <img src="images/tag_royalexchange.jpg">
    <img src="images/tag_printworks.jpg">
    <img src="images/tag_afflecks.jpg">
</body> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:18:22.010

将相同的点击侦听器添加到相应的图像。

**1.**添加名称属性以能够选择图像

```
<img name="someName" src="images/tag_townhall.jpg">
<img name="someName" src="images/tag_royalexchange.jpg">
<img name="someName" src="images/tag_printworks.jpg">
<img name="someName" src="images/tag_afflecks.jpg"> 
```

**2.**添加监听器：

```
google.maps.event.addDomListener(
  document.getElementsByName('someName')[i], 
  'click',
  infoCallback(infowindow, marker)
); 
```

# google-app-engine - map reduce 总是与平台即服务不同吗？

> ID：16069622
> 
> 赞同：1
> 
> 时间：2013-04-17T20:26:08.133
> 
> 标签：google-app-engine, mapreduce

谷歌应用引擎本身是否有 map-reduce 或者我应该使用 map-reduce ？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T04:58:50.513

AppEngine 有一个易于使用的 map reduce 实现，可作为单独下载的组件使用。

有关更多详细信息，请参阅[https://developers.google.com/appengine/docs/python/dataprocessing/overview](https://developers.google.com/appengine/docs/python/dataprocessing/overview)和 [https://code.google.com/p/appengine-mapreduce](https://code.google.com/p/appengine-mapreduce)。

# iphone - 来自 AppDelegate 的共享 ADBannerView - 如何从代表处获取广告

> ID：16069628
> 
> 赞同：2
> 
> 时间：2013-04-17T20:26:26.717
> 
> 标签：iphone, ios, objective-c, appdelegate, adbannerview

我做了相当多的阅读，发现以下几个问题： [使用 UITableViews 跨应用程序使用 ADBannerView 的共享实例](https://stackoverflow.com/questions/10433565/using-shared-instance-of-adbannerview-across-app-with-uitableviews) [如何在许多视图控制器中制作 iAd 横幅的单个共享实例？](https://stackoverflow.com/questions/11895661/how-to-make-a-single-shared-instance-of-iad-banner-throughout-many-view-controll) [AdBannerView 跨多个视图共享，包括 rootviewcontroller，如何？](https://stackoverflow.com/questions/6949115/adbannerview-shared-across-multiple-views-including-the-rootviewcontroller-how)

我希望在 didFinishLoading 方法中的 AppDelegate 类中加载一个 ADBannerView。希望这个 ADBannerView 可以被所有相关的 ViewControllers 检索（通过导入 AppDelegate.h），然后当用户在 VC 之间移动时相应地显示。

我实现的代码如下：

AppDelegate.h @interface AppDelegate : UIResponder

```
@property (strong, nonatomic) IBOutlet ADBannerView *adView;
@property (nonatomic, assign) BOOL bannerIsVisible;

- (ADBannerView *)sharedAdBannerView; 
```

AppDelegate.m

```
ADBannerView *adView;
BOOL bannerIsVisible;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions(NSDictionary *)launchOptions
{   
    // create the iAdBannerView
    adView = [[ADBannerView alloc] initWithFrame:CGRectZero];
    adView.frame = CGRectOffset(adView.frame, 0, -50);
    adView.requiredContentSizeIdentifiers = [NSSet setWithObject:ADBannerContentSizeIdentifier320x50];
    adView.currentContentSizeIdentifier = ADBannerContentSizeIdentifier320x50;
    adView.delegate=self;
    self.bannerIsVisible=NO;

    // Override point for customization after application launch.
    return YES;
}

#pragma begin of iAdBannerView Delegate Methods
- (void)bannerView:(ADBannerView *)banner didFailToReceiveAdWithError:(NSError *)error
{

    if (self.bannerIsVisible)
    {
        [UIView beginAnimations:@"animateAdBannerOff" context:NULL];
        banner.frame = CGRectOffset(banner.frame, 0, -50);
        [UIView commitAnimations];
        self.bannerIsVisible = NO;
    }

}

- (void)bannerViewDidLoadAd:(ADBannerView *)banner
{

    if (!self.bannerIsVisible)
    {
    [UIView beginAnimations:@"animateAdBannerOn" context:NULL];
    // banner is invisible now and moved out of the screen on 50 px
    banner.frame = CGRectOffset(banner.frame, 0, 50);
    [UIView commitAnimations];
    self.bannerIsVisible = YES;
    }

}

- (ADBannerView *)sharedAdBannerView
{
    return adView;
} 
```

我还尝试了使用 [NSNotificationCenter defaultCenter] postNotificationName: 方法的变体，但最后我遇到了同样的问题：

问题：在 ViewController 我想显示 ADBannerView 我如何从 AppDelegate 中检索它？

我目前有：

```
ADBannerView *banner = [[UIApplication sharedApplication] sharedAdBannerView];
[self.view addSubview:banner]; 
```

但是我遇到了很多错误，似乎无法绕过它。

错误：UIApplication 没有可见的@interface 声明扇区 sharedAdbannerView。

我敢肯定我错过了一些非常基本的东西。

任何帮助将不胜感激......谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-05T17:19:19.467

你必须`ADBannerView.h`在你的`AppDelegate.m`. 顺便看看 Apple 示例项目“ [iAd Suite](https://developer.apple.com/library/ios/samplecode/iadsuite/introduction/intro.html) ”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-15T10:43:51.577

创建共享`iAdBannerView`是这些主题之一，如果您可以阅读几天并最终放弃或编写必要的几行代码。我选择了第二种方式并创建了这几行代码。

```
import UIKit
import iAd

// Used thrughout the applcation to show banner when possible
private let applicationADBannerView = ADBannerView(adType: ADAdType.Banner)

// Simple base class for controllers to share one banner view.
// To use this class, inherit a view controller from it and add
// a UIView as container for the banner. The size of the
// container is used as banner size
internal class BaseViewControllerWithBanner: UIViewController, ADBannerViewDelegate {
    private var bannerContainer: UIView?

    internal func viewDidLoad(bannerContainer: UIView) {
        super.viewDidLoad()
        self.bannerContainer = bannerContainer
    }

    internal func bannerView(banner: ADBannerView!, didFailToReceiveAdWithError error: NSError!) {
        log(error)
        applicationADBannerView.delegate = nil
        applicationADBannerView.removeFromSuperview()
    }

    internal override func viewDidAppear(animated: Bool) {
        super.viewDidAppear(animated)

        applicationADBannerView.delegate = self
        applicationADBannerView.frame = bannerContainer?.frame ?? CGRectZero
        bannerContainer?.addSubview(applicationADBannerView)
    }

    internal override func viewWillDisappear(animated: Bool) {
        super.viewWillDisappear(animated)

        applicationADBannerView.delegate = nil
        applicationADBannerView.removeFromSuperview()
    }
} 
```

要使用此类，只需继承并覆盖`viewDidLoad`本示例中的方法。

```
import UIKit

internal class BanneredViewController: BaseViewControllerWithBanner {
    @IBOutlet weak var bannerViewContainer: UIView! // Position and link this in the xib or storyboard

    internal override func viewDidLoad() {
        log("BanneredViewController: viewDidLoad")
        super.viewDidLoad(bannerViewContainer)
        ... do all other stuff ...
    }
} 
```

它运行良好：所有请求的 100% 都在所有支持 iAd 的国家/地区得到填写。

# google-apps-script - 自动筛选（Excel VBA 到 Google 电子表格）

> ID：16069629
> 
> 赞同：0
> 
> 时间：2013-04-17T20:26:28.980
> 
> 标签：google-apps-script, google-sheets

我有一个带有以下代码的 Excel 电子表格。我想将此电子表格转换并上传到谷歌驱动器电子表格。谁能帮我将 VBA 代码转换为谷歌应用程序脚本？谢谢！

```
Sub Filter1()

'Assigned to Keyboard Shortcut Ctrl + Q
ActiveSheet.AutoFilterMode = False 'Initializes the Filter
ActiveSheet.Range("$D$2:$AZ$500").AutoFilter Field:=ActiveCell.Column - 3, Criteria1:="<>" 'Applies filter and criteria (blanks)

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T13:55:19.697

您共享的 VBA 脚本示例的两个方面无法在应用程序脚本中实现：

*   虽然 Google 电子表格确实具有类似于 Excel 的自动过滤功能，但没有 API 可以从应用程序脚本控制它。
*   不支持键盘快捷键编程（您没有包含将 Ctrl + Q 映射到 Filter1() 的代码，但在评论中提到了）。

您可以考虑一些替代方案。例如，您可以创建一个菜单驱动的函数，该函数将在单独的工作表上生成源数据的过滤版本。用户将导航到感兴趣的源数据中的单元格，从自定义菜单调用“过滤器”功能，该功能将继续根据当前“活动”单元格过滤数据。

# xml - 在 ERD 中设计并导出 XML 文件以获取元数据

> ID：16069635
> 
> 赞同：1
> 
> 时间：2013-04-17T20:26:47.633
> 
> 标签：xml, xsd, uml, entity-relationship, erd

为了将数据模型更改与数据库模式（以及由此产生的模式更改）隔离开来，我实现了一个元数据模型，它使用 XML 文件来描述存储在其他表中的基础科学数据。我正在寻找一种设计工具，它支持以 ERD 格式定义此元数据，然后允许将相关实体分组到名称-值对的 XML 文件中，并定义从分层父子关系中提取的 XML 文件之间的键关系在 ERD 中定义。我过去使用过 Visio、ERWin 和 Popkin System Architect，但这是不久前的事了，当时，这不是我正在探索的问题。是否有支持 ERD 到 XML（以及相关的 DTD 和可能的 XSL 文件）设计模型的工具？我知道我可以导出 SQL 命令来创建本机数据库模式，但不确定是否存在任何创建 XML 的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-02-01T18:43:27.523

对我非常有帮助的一个工具是 ER/Studio Data Architect。它允许您对现有数据库进行逆向工程，对逻辑模型和物理模型进行更改，并且支持导出为 XML 模式。

[http://www.embarcadero.com/products/er-studio-data-architect](http://www.embarcadero.com/products/er-studio-data-architect)

该产品有大约一百万个功能，这意味着立即拿起和使用起来有点挑战，而且我相信价格也很高。

# java - 在 Java 中具有自动索引的集合

> ID：16069636
> 
> 赞同：2
> 
> 时间：2013-04-17T20:26:48.877
> 
> 标签：java, data-structures, collections

Java中是否有一个集合，它的“put”方法返回它给对象的自动索引，所以你可以及时检索/删除它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:30:58.567

所有的 java.util.Map 类都包含一个[`put(K key, V value)`方法](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html#put%28K,%20V%29)，该方法允许您提供一个密钥，您以后可以通过该密钥检索对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T20:32:29.687

`HashMap`您可以使用自己的扩展进行包装。您可以安全地从中删除元素，其余元素将保留其索引。

```
class MyHashMap<T> {
    int index = 0;
    HashMap<Integer, T> internalMap = new HashMap<>();

    public int add(T t) {
        int temp = index++;
        internalMap.put(temp, t);
        return temp;
    }
} 
```

如果您需要它是线程安全的，请使用`AtomicInteger`for`index`和`ConcurrentHashMap`for `internalMap`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T20:32:51.967

在向其添加（即）元素后，您始终可以调用`size()`a 。您仍然必须将返回的值减 1 才能获得元素的索引。`List``add(element)`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-17T20:37:08.647

取决于您使用的集合。大多数集合会给你一个布尔值作为回报，告诉你元素是否被添加到集合中。但是由于有许多集合没有任何特定的顺序（并且在处理集合时该顺序可能会改变），因此索引将不再正确。

一些如何检索索引的示例：

```
// ArrayList, LinkedList (they put the new element at the end of the list)
list.add(myElement);
int index=list.size()-1;

// LinkedList , Stack... (with "push" the new element will be put at the beginning of the list)
list.push(myElement);
int index = 0; 
```

如果集合有索引（不是地图），那么您可以通过调用检索该索引

```
 int index = myCollection.indexOf(myElement); 
```

**编辑**我忘了补充，这需要通过覆盖来实现相等测试`equals(Object o)`。（谢谢穆罕默德 Gelbana）**/编辑**

这实际上是确保索引正确的最安全方法，即使在集合发生更改时也是如此。

但是当然有太多不同的集合具有不同的目标，以确定如何检索索引。例如，地图通常没有索引，而是您必须自己提供的“键”。

您当然可以创建自己的集合并确保始终拥有正确的索引。要么`map`按照已经建议的方式实现 a ，要么使用数组：

```
public class MyCollection{
    private E[] array;

   public MyCollection<E>(){
       array = new E[0];
   }

   public int put(E element){
      // create a new array that can hold one more element
      E[] copy = new E[array.length+1];
      // copy the old array into a new array
      int i=0;
      for(;i<array.length;i++){
         copy[i] = array[i];
      }
      copy[i]=element;
      return i;
   }
} 
```

# c# - Azure 服务总线是否应该取代您的 SOA

> ID：16069641
> 
> 赞同：1
> 
> 时间：2013-04-17T20:27:03.410
> 
> 标签：c#, azure, soa, azureservicebus

以前在我的 Web 应用程序中，当（从 UI）进行 CRUD 操作（或任何其他任务）时，我会使用如下简单的模式，利用 WCF。

```
GetUserByIDResponse response = new UserServiceClientProxy().GetByID(new GetUserByIDRequest() { UserID = UserID });

if (response.success) {
    //response.data - Do something!
} else {
    //Show error response.message
} 
```

然而，从我的研究来看，如果打算从 Azure 平台运行并使用[云服务](http://www.windowsazure.com/en-us/develop/net/fundamentals/compute/)模型进行部署，最好的方法是使用此服务总线概念和如下代码

```
QueueClient requestClient = CreateQueueClient("RequestQueueName"); 
QueueClient responseClient = CreateQueueClient("ResponseQueueName");

MessageSession receiver = responseClient.AcceptMessageSession(ReplyToSessionId); 
//blah blah 
```

通信时我假设我的所有服务类型操作现在都通过服务总线处理正确吗？或者您是否只考虑在应用程序的某些特定方面使用这种技术？

我想我要问的是，“服务总线是为 Azure 平台设计的 SOA（面向服务的架构）的通用替代品吗？”

希望这是有道理的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T21:24:48.607

> “服务总线是为 Azure 平台设计的 SOA（面向服务的架构）的通用替代品吗？”

绝对**不是**！

您现在在 Web 应用程序中使用 WCF 所做的事情，您当然可以在云服务中做同样的事情，不用担心！

Azure 服务总线队列和 Azure 存储队列（在我看来）是用于解耦应用程序块/模块的机制。假设您有一个模块 A（或一个 Web 应用程序），它需要发送一些长时间运行的重 CPU 密集型任务以由模块 B 完成。但是，模块 B 被设计为仅在夜间打开（可用）。模块 A 可以安全地将任务消息发送到队列并忘记它。模块 B 稍后将“唤醒”并检查队列中是否有任何任务消息。将一个一个地处理任务（或并行，现在并不重要）并且可以将结果报告给另一个队列，或其他形式的通知。

深入了解 Azure 服务总线队列，他们了解并实现了该`Publish-Subscribe`模式。这意味着您可能有一个发布者（将消息发送到队列），但有多个订阅者（从队列中读取）。甚至更多 - 您可以为每个订阅者应用过滤器。

更进一步，ASB 更像是企业服务总线，或者云中的 BizTalk（我不是说它**是**，我说它**类似于**BizTalk）。

总之：

在当前设置中使用 Windows Azure 云服务中的 WCF。Azure 服务总线不是 WCF 的“替代品”。它还有另一个目的。

**更新**

我会说`use queues when you want to *decouple* system components`。解耦意味着模块 A（调用者）**不依赖**于模块 B（执行者）的可用性。

在 WCF 服务的情况下，我们在模块 A（调用者）和模块 B（WCF）之间有非常紧密的耦合。如果 WCF 服务不可用，则调用者会立即失败。

在您的特定情况下，如果您有 WCF 服务来处理 UI 调用，那么严重依赖 WCF 服务是可以接受的。尤其是在您将 Web 应用程序中的 WCF 服务作为 UI 本身托管的情况下。

但是在这种情况下，我有一个桌面应用程序（模块 A），它必须将任务发送到某个远程执行器（模块 B），并且该任务需要可靠地发送，并且无论执行器可用性如何，我都会使用一些队列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:39:32.607

不; WCF 和 ASB 都不是 SOA 的替代品，因为 SOA 都不是。

SOA 意味着服务。ASB 是消息代理和实际服务总线的最小部分。WCF 是一个 RPC 框架。

服务是独立运行的程序，无论您使用什么软件将它们链接在一起。它们通常与队列链接在一​​起，并且它们还需要一些身份、路由或查找其他服务的能力。他们经常使用其他服务作为资源。

关于 WCF - 如果您以这种方式进行 SOA，那么您基本上是在弄乱您的体系结构。如果你想使用 ASB，我可以推荐 MassTransit-AzureServiceBus，它处理了很多恼人的路由逻辑、重试逻辑、进程内队列、异步调用和消息处理逻辑，而不是非服务总线 Azure 服务总线不执行。

# mysql - MySQL delete-from-table-by-id 存储过程，以表名和 ID 号为参数

> ID：16069643
> 
> 赞同：1
> 
> 时间：2013-04-17T20:27:04.907
> 
> 标签：mysql

我需要编写一个 MySQL delete-from-table-by-id 存储过程，其中包含表名和 ID 号作为调用时发送到过程的参数。表名参数告诉要从哪个表中删除，ID 参数告诉要删除表中的哪一行。

这是我的非工作解决方案：

```
CREATE PROCEDURE delete_from_table_by_id(IN IN_TABLE_NAME VARCHAR(255),
                                         IN IN_ROW_ID     INT UNSIGNED)
BEGIN
    DELETE FROM IN_TABLE_NAME
    WHERE CONCAT(IN_TABLE_NAME, '_id') = IN_ROW_ID;
END$$ 
```

它应该像这样工作：我有名为 book、author、publisher 等的表。我的数据库中每个表中的 ID 列由两部分组成，即**table_name**和**_id**。因此，在 author 表中 ID 列名为**author_id**，在 book 表中名为**book_id**。例如，以下代码应该从 book 表中删除 ID 为 456 的行：

```
CALL delete_from_table_by_id('book', 456); 
```

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:53:58.823

您不能将变量用作表名或列名。

对您来说最简单的解决方案是使用[prepare](http://dev.mysql.com/doc/refman/5.1/en/prepare.html)和[execute](http://dev.mysql.com/doc/refman/5.1/en/execute.html)。

```
SET @s = 'DELETE FROM ? WHERE CONCAT(?, '_id') = ?';

PREPARE stmt2 FROM @s;

SET @inTableName = 'some_table';
SET @inRowId = 42;

EXECUTE stmt2 USING @inTableName, @inTableName, @inRowId; 
```

我把这段代码从脑海中抽出来；我还没试过。但我很确定它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T21:29:43.427

谢谢。这是我的有效代码：

```
CREATE PROCEDURE delete_from_table_by_id(IN IN_TABLE_NAME VARCHAR(255),
                                         IN IN_ROW_ID     INT UNSIGNED)
BEGIN
    SET @SQL = CONCAT('DELETE FROM ', IN_TABLE_NAME,
                      ' WHERE ', IN_TABLE_NAME,
                      '_id = ', IN_ROW_ID);
    PREPARE stmt FROM @SQL;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END$$ 
```

# listview - 带有弹出编辑器的 Kendo ListView

> ID：16069644
> 
> 赞同：1
> 
> 时间：2013-04-17T20:27:08.940
> 
> 标签：listview, popup, kendo-ui, edit

我想在弹出窗口中编辑列表视图项目。我拼凑了一些不同的例子，但一定遗漏了一些东西。这是我所拥有的，但我不知道如何将弹出窗口模板绑定到列表视图的数据源。

以下是我的处理方法：

窗口模板：

```
<div id="window"></div>

<script type="text/x-kendo-template" id="win-template">
        <div>#:StuId#</div>
</script> 
```

剑道/jQuery 代码：

```
<script>
    $(document).ready(function () {
            var dataSource = new kendo.data.DataSource({
                pageSize: 50,
                transport: {
                    read: {
                        url: "GetData.asmx/GetStudentsByFeederId",
                        dataType: "xml",
                        data: { feederId: ("0123") }
                    }
                },
                schema: {
                    type: "xml",
                    data: "/ArrayOfStudentVO/StudentVO",
                    model: {
                        id: "student_id",
                        fields: {
                            StuId: { field: "student_id/text()", type: "string" },
                            StuName: { field: "stu_name/text()", type: "string"},
                            MathRec: { field: "math_rec/text()", type: "string" },
                            EnglishRec: { field: "english_rec/text()", type: "string" }
                        }
                    }
                }
            });

            /* PAGER FUNCTION (Used in ListView) */

            $("#pager").kendoPager({
                dataSource: dataSource
            });

            /* LIST VIEW CREATION */

            var listView = $("#listView").kendoListView({
                editable: "true",
                selectable: "true",
                dataBound: onDataBound,
                change: onChange,
                dataSource: dataSource,
                template: kendo.template($("#template").html())
            }).data("kendoListView");

            function onChange() {
                var data = dataSource.view();
                selected = $.map(this.select(), function(item) {
                    return data[$(item).index()].StuId;
            });

            kendoConsole.log("Selected: " + selected.length + " item(s), [" + selected.join(", ") + "]");
            popUp(selected);
        }

       function popUp(d) {
            var window = $("#window"),
                undo = $("#undo")
                        .bind("click", function() {
                            window.data("d").open();
                            undo.hide();
                        });

            if (!window.data("d")) {
                window.kendoWindow({
                    width: "600px",
                    title: "Student Information",
                    close: onClose,
                    content: { template: kendo.template($("#win-template").html()) }
                });
            }
        }

        var onClose = function() {
                undo.show();
            }

    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T09:15:20.827

在代码中我可以看到两个问题，

您正在将列表视图与标识符 #listView 绑定 - 我无法在给定的 HTML 中看到该标识符。

在 HTML 中，您已将模板标识符指定为 #win-template，而在 Javascript 代码中，标识符为 #template - 它应该是相同的。

而且 HTML 中也没有给出 #pager 标识符。

# events - symfony2 的事件包

> ID：16069648
> 
> 赞同：0
> 
> 时间：2013-04-17T20:27:10.983
> 
> 标签：events, symfony, bundle

我正在寻找一些可以处理事件（如 Facebook 派对、生日或任何其他活动）的捆绑包，这些事件可以使它们公开或私有。

是否有满足该需求的捆绑包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:03:02.270

[KNPBundles](http://knpbundles.com/)是 Symfony2 捆绑包列表/信息的良好来源。

快速[搜索事件会](http://knpbundles.com/search?q=event)显示一堆选项。

# ubuntu - avconv timelapse 错误：没有这样的文件或目录

> ID：16069649
> 
> 赞同：1
> 
> 时间：2013-04-17T20:27:13.597
> 
> 标签：ubuntu, libavcodec, unix, avconv

我正在尝试从一堆 jpg 中制作游戏中时光倒流。它们已被丢弃在 /home/sd/capture

我尝试使用的命令是：

```
avconv -r 30 -i /home/sd/capture/0%04d.jpeg output.mpeg 
```

我的语法有问题吗？我试过的都没有用。所有文件都被重命名，以便我所拥有的内容可以与我在谷歌上搜索的内容一起使用。

你们中的任何人都可以看到我做错了什么吗？提前致谢。

[截屏](http://imgur.com/5sQEif2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:35:29.673

您的文件似乎没有后缀`.jpeg`. 这可能是一个很大的禁忌...

在 bash 中进行重命名的一种方法是：

```
$ for i in ?????; do mv $i $i.jpeg; done 
```

# java - JTextField 中的 Strange unicode 行为

> ID：16069650
> 
> 赞同：2
> 
> 时间：2013-04-17T20:27:13.767
> 
> 标签：java, swing, unicode, jtextfield, documentfilter

我正在编写一个 DocumentFilter，它将输入到 JTextField 中的所有单词“top”替换为逻辑顶部符号。

使用这个代码很好，但是它很烦人，因为用户必须重新输入他们的空间，他们可以这样做并且文本继续在同一行

```
temp.replaceAll("\\btop\\b", "\\\u22A4" ); 
```

使用此代码并添加替换空间会导致顶部符号和 JTextField 中的所有文本在用户继续输入文本时略微向上推，然后进入下方并开始新行

```
temp.replaceAll("\\btop\\b", "\\\u22A4 " ); 
```

谁能解释这种行为并希望提供解决方案？谢谢你。

```
 @Override
    public void replace(FilterBypass fb, int offset, int length,
        String string, AttributeSet attr)
            throws BadLocationException {
        int totalLength = fb.getDocument().getLength();
        String temp   = fb.getDocument().getText(0, totalLength);
        temp = temp.replaceAll("\\btop\\b",     "\\\u22A4" );  //needs space            
        super.remove(fb, 0, totalLength);
        super.insertString(fb, 0, temp, attr);
        super.replace(fb, offset, length, string, attr);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:48:30.990

我认为这可能是由于您用简单的空格替换了非空格单词边界（例如换行符或回车符）引起的。因此，文本的流向正在改变。

看到`\\b`锚依赖于`\\w`字符类，您可以改为匹配并捕获`\\W`“top”任一侧的非单词字符，然后将它们重新插入结果中：

```
temp = temp.replaceAll("(\\W)top(\\W)", "$1\\\u22A4$2" ); 
```

这样，您将捕获空格或换行符、回车符、制表符等，并将它们恢复到“顶部”替代的任一侧，以便文档保持完全相同，除了“顶部”已变为“⊤”。

# jquery - 当 Backbone 中的 hashchange 触发时，使用 jquery 滚动窗口无法设置动画

> ID：16069651
> 
> 赞同：0
> 
> 时间：2013-04-17T20:27:16.230
> 
> 标签：jquery, backbone.js, jquery-animate, hashchange

我有一个基本上看起来像这样的函数：

```
function scroll(scrollTop) {
  $("body,html").animate({scrollTop: scrollTop});
} 
```

在主干路由中，我尝试使用此功能滚动到页面上的某个位置，再次简化：

```
var Router = Backbone.Router.extend({
  routes: {
    "": "index",
    "foo": "foo"
  },

  index: function () {
    scroll(0);
  },

  foo: function () {
    scroll($("#foo").offset().top);
  }
}); 
```

这在页面加载（如果加载“/foo”）、手动调用函数或使用 pushState（而不是哈希片段）路由时效果很好。

但是使用哈希片段路由，动画会失败。滚动位置仍然会发生变化，但会立即发生变化，没有动画。

有解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:36:15.470

您所描述的实际上是浏览器在更改主题标签时的行为。也就是说，从`domain.com`to导航`domain.com#someId`就像是让浏览器“关注”页面中 id 为 的元素`someId`。所以窗口将移动到这个元素。不幸的是，我不知道有什么解决办法。

您可能想查看我在搜索可能的解决方案时发现的这个讨论：[修改 document.location.hash without page scrolling](https://stackoverflow.com/questions/1489624/modifying-document-location-hash-without-page-scrolling)。

# wcf - 为soapenv 使用备用命名空间

> ID：16069658
> 
> 赞同：0
> 
> 时间：2013-04-17T20:27:45.533
> 
> 标签：wcf, namespaces

我们公司认为它正在使用有效的 SOAP。但是，他们将这个命名空间声明用于 soapenv 命名空间前缀：

```
xmlns:cfg-env="http://www.co.com/schemas/cfg-env/" 
```

这体现在 xml/soap 请求消息中，如下所示：

```
<cfg-env:Envelope xmlns="http://www.co.com/schemas/CFX/" xmlns:cfg-           env="http://schemas.xmlsoap.org/soap/envelope/" xmlns:cfg-hdr="http://www.co.com/schemas/cfg-hdr/">
<cfg-env:Header> 
```

开箱即用的 WCF 无法识别此肥皂命名空间声明。当我将其更改为正确的soap 1.1 命名空间时，WCF 会识别请求并开始处理消息。

这是我们都熟悉的正确声明：xmlns:cfg-env="http://schemas.xmlsoap.org/soap/envelope/"

当我将此命名空间声明用于典型的 soapenv 前缀时，这里是 cfg-env WCF 识别请求消息。

有没有办法改变 WCF 来识别这个不正确的 soapenv 命名空间声明，这样我的消息就可以在不修改的情况下被识别？

鉴于这是一项要求，我将不得不更改请求消息 cfg-env 命名空间声明。让请求消息保持完整而不做任何更改对我来说是有帮助的，这样才能正常工作。

是否可以在 WCF 中应用替代命名空间声明，以及如何适应这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-08T10:07:16.767

这是可能的，但它不是一种配置。

看看这篇文章：

[http://vanacosmin.ro/Articles/Read/WCFEnvelopeNamespacePrefix](http://vanacosmin.ro/Articles/Read/WCFEnvelopeNamespacePrefix)

在这里您可以找到如何在服务器端执行此操作，但如果您使用 ApplyClientBehavior 而不是 ApplyDispatchBehavior，您可以配置相同的 MessageFormatter 以在您的 WCF 客户端应用程序上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:49:11.383

不，那是不可能的。贵公司生产的根本不是 SOAP。

# git - 有冲突的 git 采摘樱桃

> ID：16069668
> 
> 赞同：8
> 
> 时间：2013-04-17T20:28:13.820
> 
> 标签：git, cherry-pick

我有两个分支 Z 有一些变化，而 M 有一些相互冲突的变化。我想将 Z 上的第一个更改合并到 M 中。当我尝试查看哪些更改仍然存在时。（实际上还有一些变化，但这已经表明了问题）

```
$ git checkout M
$ git cherry M Z
+ 153c2f840f2192382be1fc435ceb069f0814d7ff
+ 4a7979d5dd526245b51769db21acf4c286825036

$ git cherry-pick 153c2f840f2192382be1fc435ceb069f0814d7ff
error: could not apply 153c2f8... add Z
hint: after resolving the conflicts, mark the corrected paths
hint: with 'git add <paths>' or 'git rm <paths>'
hint: and commit the result with 'git commit'
• (M|CHERRY-PICKING) $ git st
# On branch M
# Unmerged paths:
#   (use "git add/rm <file>..." as appropriate to mark resolution)
#
#   both modified:      README.txt
#
no changes added to commit (use "git add" and/or "git commit -a")
• (M|CHERRY-PICKING) $ vim README.txt 
```

我在这里解决了冲突

```
• (M|CHERRY-PICKING) $ git add README.txt
• (M|CHERRY-PICKING) $ git ci -m'cherry picked'
  [M dc5de35] cherry picked
  1 file changed, 1 insertion(+), 1 deletion(-)
• (M) $ git cherry M Z
+ 153c2f840f2192382be1fc435ceb069f0814d7ff
+ 4a7979d5dd526245b51769db21acf4c286825036 
```

因此，在我提交更改后，它仍然认为这两个更改都不是我所期待的精心挑选的：

```
- 153c2f840f2192382be1fc435ceb069f0814d7ff
+ 4a7979d5dd526245b51769db21acf4c286825036 
```

一周后我怎么知道我已经合并了 153c2f ？我怎样才能以它会知道该合并的方式进行挑选？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T21:37:52.010

**How will you know?**

Not by using `git cherry` since it only recognizes commits that have the same `git patch-id` ([see man page](https://www.kernel.org/pub/software/scm/git/docs/git-cherry.html)), i.e. not those where you have had to resolve non-trivial conflicts.

So you will have to know by looking at the commit message.

**How will future merges know about the cherry-pick?**

Since you have resolved the conflict when you applied the cherry-picked change, then that commit should merge trivially when you merge the whole branch in the future.

If you are really concerned about git remembering how you resolved the conflict, you could enable [git rerere](http://git-scm.com/2010/03/08/rerere.html):

```
git config --global rerere.enabled true 
```

# javascript - Javascript 最小值和最大值

> ID：16069670
> 
> 赞同：0
> 
> 时间：2013-04-17T20:28:18.513
> 
> 标签：javascript, jquery

我使用以下内容来限制文本字段中的值。只有当用户尝试删除并留空时，它才有效。它不会删除最小值。数量：

```
<input type="text" placeholder="none" name="notepad_and_pen" id="notepad_and_pen" maxlength="10" style="width:50px" tabindex=4 onchange="this.value = (this.value > 999999) ? 999999 : ((this.value < 400) ? 400 : this.value);"> 
```

我在标题中也有这个脚本作为空白文本字段的占位符，这可能会以某种方式影响：

```
$('input').focus(function(){
    $(this).val('');
}).blur(function(){
    if($(this).val() == "")
    {
        $(this).val($(this).attr('placeholder'))
    }
}
); 
```

请需要帮助。我是个菜鸟，你能教的任何东西都会很棒。谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:32:16.063

的值`this.value`是一个字符串。您正在将其与数字进行比较。在比较之前将其转换为数字，例如：

```
parseFloat(this.value) 
```

当然，如果您不使用内联事件处理程序，它会使调试和使用变得更加容易。你已经在使用 jQuery，所以试试这个：

```
$("#notepad_and_pen").on("change", function () {
    var $this = $(this),
        finalValue = $this.val(),
        myValue = parseFloat(finalValue);
    if (isNaN(myValue)) {
        finalValue = "";
    } else {
        if (myValue > 999999) {
            finalValue = 999999;
        } else if (myValue <= 0) {
            finalValue = "";
        } else if (myValue < 400) {
            finalValue = 400;
        }
    }
    $this.val(finalValue);
}); 
```

**演示：http:** [//jsfiddle.net/wTKxX/4/](http://jsfiddle.net/wTKxX/4/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T21:53:01.653

`#notepad_and_pen`可以通过单行来施加限制并允许删除。

[此页面](http://diveintohtml5.info/detect.html)提供了一种方法来检测是否原生支持占位符（从而避免了对 Modernizr 的需求）。

[这个页面](http://www.hagenburger.net/BLOG/HTML5-Input-Placeholder-Fix-With-jQuery.html)提供了一种非本地处理占位符的合理方法。

这是组合代码：

```
$(function() {
    //Impose limits on #notepad_and_pen
    $("#notepad_and_pen").on('change', function() {
        this.value = (this.value === '') ? '' : Math.max(400, Math.min(999999, Number(this.value)));
        //Use the following line to reject anything that's zero, blank or not a number, before applying the range limits.
        //this.value = (!Number(this.value)) ? '' : Math.max(400, Math.min(999999, Number(this.value)));
    });

    //With reference to http://diveintohtml5.info/detect.html
    function supports_input_placeholder() {
      var i = document.createElement('input');
      return 'placeholder' in i;
    }

    //With reference to http://www.hagenburger.net/BLOG/HTML5-Input-Placeholder-Fix-With-jQuery.html
    // 1\. Handle placeholders (in non-HTML5 compliant browsers).
    if(!supports_input_placeholder()) {
        $('[placeholder]').focus(function () {
            var input = $(this);
            if (input.val() == input.attr('placeholder')) {
                input.val('');
                input.removeClass('placeholder');
            }
        }).blur(function () {
            var input = $(this);
            if (input.val() == '' || input.val() == input.attr('placeholder')) {
                input.addClass('placeholder');
                input.val(input.attr('placeholder'));
            }
        }).blur();

        //2\. Prevent placeholder values being submitted to form's action script
        $('[placeholder]').eq(0).closest('form').submit(function () {
            $(this).find('[placeholder]').each(function () {
                var input = $(this);
                if (input.val() == input.attr('placeholder')) {
                    input.val('');
                }
            });
        });
    }
}); 
```

# c++ - fftw C++ 来自幅度和相位阵列的逆二维 FFT

> ID：16069672
> 
> 赞同：3
> 
> 时间：2013-04-17T20:28:22.580
> 
> 标签：c++, math, signal-processing, fft, fftw

使用 FFTW 实现 2D FFT/IFFT。

目前我有一个使用 SFML 加载的图像，并将其分解为它的幅度和相位分量`fftw_plan_dft_2d`。

这没问题，我已经对照已知的工作软件检查了我的幅度图像，结果是正确的。（[正向 FFT](http://i.imgur.com/zf367Uo.jpg)）

[我已经通过使用第一个 FFT 的实部和虚部输出直接从正向 FFT（ Inverse FFT](http://i.imgur.com/PlCAqun.png) ）直接执行逆 2D FFT 来检查 ifft 是否正常工作（在某处也存在问题，但这是另一个问题天）

我对重新组合幅度和相位以形成实数和复数部分以执行 IFFT 的方式更感兴趣。

谷歌返回了很多 MATLAB 的东西，我根本不明白，因此并没有真正的帮助。

旁注：数学不是我的强项。这就是为什么我觉得我有点挣扎。如果可能的话，请解释一下我是 10 岁！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T21:03:37.950

首先，您将幅度和相位值转换回复数（实数 + 虚数）：

```
re = mag * cos(phi);
im = mag * sin(phi); 
```

然后对这些复数值进行逆 FFT。

# charts - 在 SSRS 图表中显示中位数

> ID：16069685
> 
> 赞同：0
> 
> 时间：2013-04-17T20:29:12.713
> 
> 标签：charts, ssrs-2008, median

我正在开发 SSRS 2008 中的条形图报告。我只是希望条形图中的条形代表正在使用的查询中的值的中值。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:48:43.830

令人惊讶的是，SSRS 或 T-SQL 中没有内置的 Median 函数（假设这是您的数据源）。我会添加代码以预先计算到查询中，然后 SSRS 就可以呈现它。

T-SQL 的起点是 NTILE 函数：

[http://msdn.microsoft.com/en-us/library/ms175126.aspx](http://msdn.microsoft.com/en-us/library/ms175126.aspx)

请注意我在“社区添加”部分的评论——粗心的人会遇到一些陷阱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T14:07:15.427

我可以通过计算查询中的中位数来做到这一点，而不是试图让 SSRS 为我做这件事。我在查询中使用它来执行此操作： [在 Sql Server 中计算中位数的函数](https://stackoverflow.com/questions/1342898/function-to-calculate-median-in-sql-server)

# delphi - Delphi：堆叠几个底部对齐控件的方法是什么？

> ID：16069691
> 
> 赞同：1
> 
> 时间：2013-04-17T20:29:41.263
> 
> 标签：delphi

我正在使用 Delphi7 在设计时创建状态栏（来自 TBX 包）。在运行时，我创建了一个“停靠信息行”，它是一个带有`Align=alBOttom`.

问题：有时信息行出现在状态栏上方，有时在状态栏下方。

始终在状态栏上方显示面板的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:34:02.267

显示面板时（即当您将其`Visible`属性设置为 时`True`）还将其`Top`位置设置为状态栏上方（或将状态栏的顶部设置为面板下方）

```
Statusbar.Top := panel.Top + panel.Height; 
```

# php - 在 HTML 表格中每 n 个单元格创建一个新行

> ID：16069692
> 
> 赞同：0
> 
> 时间：2013-04-17T20:29:47.980
> 
> 标签：php, html, css

我有以下代码：

```
for($i=0; $i<count($gallery);$i++)
{
    $temp = array();
    $temp = $gallery[$i];
    echo "<img src='". $temp->path . "' />";

} 
```

现在此代码将内容打印在一行中。我只想每行打印 3 个，然后创建新行并打印另外 3 个，依此类推。如何才能做到这一点？

感谢支持:)

编辑：错误

> 遇到 PHP 错误
> 
> 严重性：通知
> 
> 消息：未定义的偏移量：5
> 
> 文件名：views/profile.php
> 
> 行号：105
> 
> 遇到 PHP 错误
> 
> 严重性：通知
> 
> 消息：试图获取非对象的属性
> 
> 文件名：views/profile.php
> 
> 行号：106

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T20:32:06.153

你可以做

```
$n = 3;
echo "<table><tr>";
for($i=0; $i<count($gallery);$i++){
    $temp = array();
    $temp = $gallery[$i];
    echo "<td><img src='". $temp->path . "' /></td>";
    if($i % $n ==0 && $i!=0 ){
        echo "</tr><tr>";
    }
}
echo '</tr></table>'; 
```

编辑：

如果您想以“正确”的方式进行操作 - 通过构建语法正确的 HTML，您需要执行以下操作：

```
$n = 3;
echo "<table><tr>"; 
$gallery_count = count($gallery);
for($i=0; $i<$gallery_count; $i++){
    $temp = array();
    $temp = $gallery[$i];
    echo "<td><img src='". $temp->path . "' /></td>";

    if($i != 0){
        if($i % $n == 0 && $i != $gallery_count-1){
            echo "</tr><tr>";
        }
        else{
            echo ""; //if it is the last in the loop - do not echo
        }
    }
}

//example - if the last 2 `td`s are  missing:
$padding_tds  = $gallery_count % $n;
if($padding_tds != 0 ){
    $k = 0;
    while($k < $padding_tds){
       echo "<td>&nbsp;</td>";
    }
}
echo '</tr></table>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:33:42.773

您只需要`modulus`检查已打印的数量 - 3 的任何倍数都会添加中断。

```
$x=0;
for($i=0; $i<count($gallery);$i++)
{
    $x++;       
    $temp = array();
    $temp = $gallery[$i];
    echo "<img src='". $temp->path . "' />";
    if (($x%3)==0) { echo "<br />"; }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:47:29.450

我只是用表格重新做了它，它更整洁，因为每件东西都会被格式化以看起来正确。这有点乱，因为我只是添加了一点 if 语句来释放表。

```
<table>
<?php
$number_per_row = 3;
for($i=0; $i<count($gallery);$i++)
{
    $temp = array();
    $temp = $gallery[$i];
    if(($i % $number_per_row) == 0) {
        echo "<tr>";
    }
    ?>
<td><?php echo "<img src='". $temp->path . "' />"; ?></td>
<?php
    if(($i % $number_per_row) == $number_per_row - 1) {
        echo "</tr>";
    }
}
?>
</table> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-17T20:46:16.480

```
$n = 3;
echo "<table>";
echo "<tr>";
for($i=0; $i<count($gallery);$i++){
    if(($i % n ==0) && ($i != 0)){
        echo "</tr><tr>";
    }
    $temp = array();
    $temp = $gallery[$i];
    echo "<td><img src='". $temp->path . "' /></td>";
}
echo "</tr>";
echo '</table>';`` 
```

# c# - 序列化：覆盖属性中的 DataMember 属性

> ID：16069693
> 
> 赞同：0
> 
> 时间：2013-04-17T20:29:49.390
> 
> 标签：c#, .net

鉴于以下代码片段...

```
public MyBaseClass
{
    ...
    [DataMember]
    public virtual Rectangle MyRectangle
    {
        get;
        set;
    }
    ....
}

public MyDerivedClass : MyBaseClass
{
    ...
    [DataMember] // Is that necessary?
    public override Rectangle MyRectangle
    {
        get { return base.MyRectangle; }
        set {
            ...
            base.MyRectangle = value;
        }
    }
    ....
} 
```

...我想知道是否也`[DataMember]`应声明为`MyDerivedClass.MyRectangle`？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-21T15:42:30.027

实际上，这取决于您对这些属性的用途。我遇到了一个场景，我使用这些属性与**ProtoBuf**进行序列化。没有覆盖属性上的 DataMember 属性，一切正常。然后我们决定也支持**JSON**格式的序列化。然后该属性是强制性的，正如 hawkee 所说，它不会影响现有行为。

# django - 如何在 Heroku 上托管的 Django 项目中使用 Werkzeug 交互式回溯调试器？

> ID：16069705
> 
> 赞同：3
> 
> 时间：2013-04-17T20:31:18.793
> 
> 标签：django, debugging, heroku, werkzeug

在您的 Django 项目中安装 django-extensions 后，您可以在本地机器上`manage.py runserver_plus`激活非常有用的 Werkzeug 调试器，以便 500 错误页面让您以交互方式浏览堆栈。

从 Heroku 运行时，如何激活启用 Werkzeug 的 500 页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-12T15:44:11.627

如果您使用 gunicorn 在 Heroku 上为您的 Django 应用程序提供服务，就像他们的教程[https://devcenter.heroku.com/articles/django](https://devcenter.heroku.com/articles/django)一样，您将无法看到 Werkzeug 调试器，因为 gunicorn 不使用 Werkzeug。

您必须使用基于 wsgi 的服务器在 Heroku 上为您提供 django 应用程序，该服务器使用像 uWSGI 这样的 Werkzeug。见-> [https://github.com/unbit/uwsgi-docs/blob/master/tutorials/heroku_python.rst](https://github.com/unbit/uwsgi-docs/blob/master/tutorials/heroku_python.rst)

还必须在您的 heroku 设置上设置 DEBUG = True。

非常不鼓励在您的生产环境（heroku）上设置 DEBUG = True，因为有人可以查看您的设置（密码）甚至代码。

# jquery - 必须单击 ASP.net 按钮两次才能调用 jquery 函数

> ID：16069706
> 
> 赞同：0
> 
> 时间：2013-04-17T20:31:25.050
> 
> 标签：jquery, asp.net, postback

**我需要什么：**我有需要更改和更新的工作代码。我有一个模态控件（就像一个弹出框），它在单击按钮时被调用。现在，我需要在 vb.net 代码中计算一些东西，然后决定调用它。（弹出框出现）

**问题：**它被调用，但我必须在我的按钮上单击两次。仅当 CssClass 设置如下时才会调用：`CssClass="osx ImageButton100"`

**背景：**我正在使用的模态控制：[http ://www.ericmmartin.com/projects/simplemodal-demos/](http://www.ericmmartin.com/projects/simplemodal-demos/)

**所做的更改：**

```
Before:

 <asp:Button ID="btnCheckOut" runat="server" Text="Preview Order" CssClass="osx ImageButton100"        /> 
```

现在：

```
 <asp:Button ID="btnCheckOut" runat="server" Text="Preview Order"   />
  btnCheckOut.CssClass = "osx ImageButton100" 
```

完整代码：

[http://forums.asp.net/post/5367139.aspx](http://forums.asp.net/post/5367139.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:03:06.443

在您的代码隐藏中，是什么`Utils.MessageBox`？（从您的按钮单击事件处理程序调用）。

无论如何，在我看来，您的代码的行为符合设计。脚步：

1.  用户点击按钮。
2.  回发发生时，服务器端代码在按钮上设置属性，将其配置为显示弹出窗口。
3.  页面响应发送回客户端。
4.  用户再次单击按钮，现在它显示一个模式（因为它的类已配置）。

您通过发出回发（按钮单击正在调用服务器端事件处理程序）来中断客户端代码流。如何进行流程有几种选择：

1.  继续使用回发，但让服务器端代码注册一个“启动”脚本以在 javascript 页面加载事件上执行。不过，这可能有点笨拙，尤其是当用户刷新页面时。
2.  让您的按钮单击执行回调而不是回发。有几种不同的方法可以解决这个问题，但我建议*不要*使用 WebForms`UpdatePanel`方法。
3.  将所有这些逻辑移动到客户端。

鉴于您的按钮单击事件处理程序非常简单，我建议您使用第三个选项。所以忘记`btnCheckOut`. 从已经设置为的按钮类开始`osx ImageButton100`。然后将您的 javascript 点击处理程序更改为更像：

```
$("input.osx, a.osx").click(function (e) {
    e.preventDefault();     

    var lineCount = $("#txtApprovalNotes").val()
                        .match(/[^\n]*\n[^\n]*/gi).length;

    if (lineCount > 20) {
        alert("Approval notes has a limit of 20 lines.";
    } else {
        $("#osx-modal-content").modal({
            overlayId: 'osx-overlay',
            containerId: 'osx-container',
            closeHTML: '<div class="close">
   <a href="#" class="simplemodal-close" style="font-size:150%;">x</a></div>',
            minHeight:80,
            opacity:65, 
            position:['0',],
            overlayClose:true,
            onOpen:OSX.open,
            onClose:OSX.close,
            appendTo:'form'
        });
    }
}); 
```

这不仅会使维护逻辑流程更简单，而且会减少回发，并使浏览器中的响应更加灵敏。

# .htaccess - 在哪里添加 htaccess 重写的时间段

> ID：16069711
> 
> 赞同：1
> 
> 时间：2013-04-17T20:31:41.120
> 
> 标签：.htaccess, url-rewriting

我的 htaccess 中有以下内容：

```
RewriteRule ^([a-zA-Z0-9\s_-]+)$ profile.php?uid=$1 
```

问题是一个句号会打破页面，例如：www.mydomain.com/john.smith

我怎样才能允许这个时期？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:34:29.680

根据您的情况/上下文，您可以检查和排除对 的请求`profile.php`，或者检查请求是否针对现有文件或目录：

```
RewriteCond %{REQUEST_URI} !/profile\.php
RewriteRule ^([a-zA-Z0-9\s_.-]+)$ profile.php?uid=$1 
```

或者

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9\s_.-]+)$ profile.php?uid=$1 
```

# python - PyQt 窗口在打开后立即关闭

> ID：16069713
> 
> 赞同：10
> 
> 时间：2013-04-17T20:31:45.613
> 
> 标签：python, pyqt4

尝试打开 PyQt 窗口时遇到问题。

下面的代码是我原始代码的示例。当我将模块导入`import Test`并运行`test.Start()`时，出现以下错误：

> QCoreApplication::exec: 事件循环已经在运行

经过一番研究，我发现这是因为我已经做了一个`QApplication`.

```
test.py....
import sys

def Start():
    app = QApplication(sys.argv)
    m = myWindow()
    m.show()
    app.exec_()

class myWindow():....

if __name__ == "__main__":
    Start() 
```

所以然后我读到我可以像这样重写我的代码，它会修复错误：

```
test.py....

def Start():
    m = myWindow()
    m.show()

class myWindow():....

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    Start()
    app.exec_() 
```

现在我不再收到**QCoreApplication::exec: The event loop is already running**错误，但我的窗口在打开后几乎立即关闭。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-17T20:57:35.143

您需要保留对打开窗口的引用，否则它会超出范围并被垃圾收集，这也会破坏底层 C++ 对象。尝试：

```
def Start():
    m = myWindow()
    m.show()
    return m

class myWindow():....

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    window = Start()
    app.exec_() 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-01T18:48:17.997

你也可以这样做：

```
def Start():
    global m
    m = myWindow()
    m.show()

class myWindow():....

if __name__ == "__main__":
    import sys
    app = QApplication(sys.argv)
    window = Start()
    app.exec_() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-09-22T18:19:27.780

使用以下代码。据我所知，您的问题在于您的导入并使用“show”作为函数的名称。你没有提供你在课堂上写的东西，所以很难猜。但是下面的代码就像一个魅力。;-)

最良好的祝愿，好运！

```
import sys
from PyQt5 import *
from PyQt5.QtGui import *
from PyQt5.QtWidgets import *

app = QApplication(sys.argv)
def Start():
    m = myWindow()
    m.showWid()
    sys.exit(app.exec())

class myWindow:
  def __init__(self):
    self.window = QWidget()
    self.window.setWindowTitle("Program Title")
    self.window.setFixedWidth(600)
    self.window.setStyleSheet("background: #18BEBE;")

  def showWid(self):
    self.window.show()

if __name__ == "__main__":
    Start() 
```

# box-api - 来自嵌入式链接的盒子项目的 ID？

> ID：16069717
> 
> 赞同：1
> 
> 时间：2013-04-17T20:31:57.327
> 
> 标签：box-api

我正在使用 C# 并尝试在框中找到文件的文件 id 或共享链接（我可以用来获取 id），以便用户可以提取有关文件的信息或下载它，但对文件的唯一引用我有的是嵌入链接。

如何从[https://www.box.com/embed/06giwf1i41bu6jo.swf](https://www.box.com/embed/06giwf1i41bu6jo.swf)等嵌入式框链接中找到文件的 ID 或共享链接？

# windows - WMI Process Call Create 将无法正确运行批处理脚本

> ID：16069724
> 
> 赞同：2
> 
> 时间：2013-04-17T20:32:25.397
> 
> 标签：windows, scripting, batch-file

这就是我想要做的：我有一个 NLB 集群。所述集群上有两台机器：**Node1**和**Node2**。我有第三台机器，它不在那个或任何集群中。这第三台机器被称为：**Monitor1**

每小时一次，我想运行一个脚本来检查 Node1 和 Node2 是否启动。该脚本将通过 TaskScheduler 运行。我正在使用以下命令在 Node1 和 Node2 上执行脚本：

```
wmic /node:NODE1,NODE2 process call create "C:\ClusterCheck.bat" 
```

ClusterCheck.bat 脚本内容如下：

```
NLB Query | findstr /i /R /C:"host . is stopped"
IF %ERRORLEVEL% EQU 0 (ECHO %COMPUTERNAME%_down)>DOWN.txt
IF %ERRORLEVEL% EQU 1 (ECHO %COMPUTERNAME%_up)>UP.txt
code here 
```

当我使用`wmic /node:"%1" process call create "C:\ClusterCheck.bat"`时没有输出。当我进入服务器并手动双击 ClusterCheck.bat 文件时，它会给我适当的输出，具体取决于节点是打开还是关闭。

有谁知道如何让这些文件输出？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T01:25:35.950

第一个问题，当你`wmic process call create`应该在你的命令前加上`cmd /c`.

接下来，你是对的。 `wmic`不会在本地控制台上显示远程创建的进程的结果输出。您要么需要使用专为此类事情设计的[psexec ，要么通过将命令输出传送到日志文件然后读取日志文件来破解解决方法。](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)类似于以下脚本。

我不太清楚，如果这将是一个计划任务，为什么你关心结果可用于标准输出。我怀疑您打算将输出重定向到某种日志。所以我也把它放在这里。

```
@echo off
setlocal

set "user=domainadmin"
set "pass=password"

for /f %%I in ('wmic os get localdatetime') do set "timestamp=%%I"
set "today=%timestamp:~0,8%"

set logfile=c:\users\me\Desktop\logs\%today%.log

if not exist "%logfile%" mkdir "%logfile%\.." 2>NUL
>>"%logfile%" echo %time%

for %%I in (NODE1 NODE2) do (
    (ping -n 1 %%I >NUL && (
        net use \\%%I /user:%user% %pass% >NUL 2>NUL
        wmic /node:%%I /user:%user% /password:%pass% process call create "cmd /c c:\clustercheck.bat >c:\cc.log"
        type \\%%I\c$\cc.log && del \\%%I\c$\cc.log
        net use \\%%I /delete >NUL 2>NUL
    ) || echo %%I unresponsive
)>>"%logfile%"

forfiles /p "%logfile%\.." /M *.log  /d -30 /c "cmd /c del @path" 
```

`Desktop\logs`如果它不存在，这应该创建，然后创建或附加到run on and`Desktop\logs\YYYYMMDD.log`的输出。最后，它会删除超过 30 天的日志文件。`C:\clustercheck.bat``NODE1``NODE2`

# c# - 未存储本地数据库插入

> ID：16069728
> 
> 赞同：2
> 
> 时间：2013-04-17T20:32:34.033
> 
> 标签：c#, database, sql-server-ce

这可能是我的一个愚蠢的错误..但我似乎无法理解。

我创建了一个新的空 C# Windows 窗体应用程序。

我添加了一个数据库（基于数据集）并将文件存储在我的解决方案资源管理器中。

我添加了一个`Test`带有 column的表`Name`。

我使用添加记录`new SqlCeCommand("insert into Test values('Name')", new SqlCeConnection(ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString)).ExecuteNonQuery();`

但是，我什至尝试检索相同的数据，并且一切正常。

但是当我停止我的项目并重建它时..所有数据又消失了？

有没有办法解决这个问题，或者当我开始使用这个项目来达到它的预期目的时这个问题会自行解决吗（没有每天重建 500 次？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:35:26.807

您的数据库文件列在具有此属性的项目中

```
 Copy to destination directory = Copy Always 
```

如果这是真的，那么每次重新启动项目时，都会将数据库文件的新（空）副本从项目目录复制到输出目录（BIN\DEBUG 或 BIN\RELEASE），从而覆盖上一次运行中使用的数据库文件。您可以避免将属性更改为`Copy Never`或`Copy if newer`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-04T13:26:00.257

史蒂夫给出的答案是不断地在现有数据库上复制数据库，这会导致删除所有数据。

我设法通过打开“始终复制”来解决这个问题，然后在资源管理器中将数据库移动到不同的位置并将其添加到项目中。这样数据库永远不会被覆盖，可以在程序中使用！

（但是，如果/当我将项目发布到另一台计算机时，这可能会引发问题）

# php - 带有数组的php表单电子邮件隐藏字段值

> ID：16069729
> 
> 赞同：0
> 
> 时间：2013-04-17T20:32:40.517
> 
> 标签：php, forms, while-loop

我在一个循环中有一个 while 语句从我的数据库中收集电子邮件

```
while($row = mysql_fetch_assoc($query)) {
    $email[] = $row['email'];
} 
```

然后我将 PHP 邮件程序作为我的邮件发送客户端。这收集了许多电子邮件地址……大约 50 个。

```
$mail->AddAddress("$email[0]");
$mail->AddAddress("$email[1]"); 
```

然后我用

```
$mail-> = "<form><input type=\"radio\" name=\"number\" value=\"1\" />";
$mail-> .= "<input type=\"radio\" name=\"number\" value=\"2\" />";
$mail-> .= "<input type=\"hidden\" name=\"email\" value=\"?\" />";
$mail-> .= "<input type=\"submit\" /> </form>"; 
```

我想知道如何向第一个人发送电子邮件并将他们的电子邮件放在隐藏字段类型中......然后给下一个人将其发送给他们并将他们的电子邮件放在隐藏字段中。有什么简单的方法可以做到这一点？我不想为每个人单独做。我尝试了增加数组编号 $i++ 的 while 循环，但这对我没有任何好处。任何人有任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:44:06.987

而不是一个`while`循环，你可以尝试一个`for`循环：

```
for($i = 0; $i < count($email); $i++)
{
    $mail-> = "<form><input type=\"radio\" name=\"number\" value=\"1\" />";
    $mail-> .= "<input type=\"radio\" name=\"number\" value=\"2\" />";
    $mail-> .= "<input type=\"hidden\" name=\"email\" value=\"$email[$i]\" />";
    $mail-> .= "<input type=\"submit\" /> </form>";
} 
```

我对该函数不太熟悉，`mail()`但我很确定语法`$mail-> .=`不正确。也许您的意思是使用`$mail[$i] = "<form>...</form>"`它应该创建一组准备发送的电子邮件。这个目的只是一个假设。

# json - Uncaught SyntaxError: Unexpected token B on live but not local server

> ID：16069730
> 
> 赞同：6
> 
> 时间：2013-04-17T20:32:41.450
> 
> 标签：json, asp.net-mvc-3, jquery, knockout.js, amazon-ec2

所以我正在发布一些 ajax 帖子，它似乎在 localhost 上运行良好，但是当我将它发布到亚马逊上的 ec2 服务器时，我得到 Uncaught SyntaxError: Unexpected token B. 这似乎指向 JSON 解析失败。完全相同的数据库、相同的浏览器和相同的方法被调用。为什么它可以在本地而不是在服务器上工作。

```
$.ajax({
                url: '@Url.Action("Action")',
                type: "POST",
                data: ko.toJSON(viewModel),
                dataType: "json",
                contentType: "application/json; charset:utf-8",
                success: function (result) {

                },
                error: function (xhr, textStatus, errorThrown) {
                    var errorData = $.parseJSON(xhr.responseText);
                    var errorMessages = [];

                    for (var key in errorData)
                    {
                        errorMessages.push(errorData[key]);
                    }
                    toastr.error(errorMessages.join("<br />"), 'Uh oh');
                }
            }); 
```

这是服务器端的基本布局：

```
[HttpPost]
        public JsonResult Action(ViewModel model)
        {
            try
            {

                Response.StatusCode = (int)HttpStatusCode.OK;
                return Json("Successfull");
            }
            catch (Exception ex)
            {
                logger.Log(LogLevel.Error, string.Format("{0} \n {1}", ex.Message, ex.StackTrace));
                Response.StatusCode = (int)HttpStatusCode.BadRequest;
                List<string> errors = new List<string>();
                errors.Add(ex.Message);
                return Json(errors);
            }

        } 
```

在**try**语句中，我对数据库进行了几次查询，并在**Authorize.Net ( [https://api.authorize.net/soap/v1/Service.asmx](https://api.authorize.net/soap/v1/Service.asmx) )上发布了一些计算**

如果 Authorize.net Web 服务调用有任何错误，那么我会返回如下错误：

```
if (profile.resultCode == MessageTypeEnum.Error)
{
     logger.Log(LogLevel.Error, string.Join(",", profile.messages.Select(x => x.text)));
     Response.StatusCode = (int)HttpStatusCode.BadRequest;
     List<string> errors = new List<string>();
     profile.messages.ToList().ForEach(x => errors.Add(x.text));
     db.SaveChanges();
     return Json(errors);
} 
```

我正在记录的这个错误：

```
 A public action method 'AddPromoCode' was not found on controller 'Flazingo.Controllers.PositionController'. at 
System.Web.Mvc.Controller.HandleUnknownAction(String actionName) at 
System.Web.Mvc.Controller.ExecuteCore() at 
System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) at
System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<>c__DisplayClassb.b__5() at 
System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass1.b__0() at 
System.Web.Mvc.MvcHandler.<>c__DisplayClasse.b__d() at 
System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() at 
System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& 
```

同步完成）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-25T02:21:59.253

你有另一篇文章[can't find action only on live server, works fine in local server](https://stackoverflow.com/questions/16199361/cant-find-action-only-on-live-server-works-fine-in-local-server)，所以我猜这篇文章与 javascript 部分特别相关，而不是服务器端部分。

听起来服务器上发生了一些不好的事情，服务器发回了某种类型的错误，并且您的错误处理程序（在 javascript 中）在尝试处理该响应时死亡。

> 我得到 Uncaught SyntaxError: Unexpected token B. 这似乎指向 JSON 解析失败。

这听起来很合理。让我们看一下代码：

```
.ajax({
  ...
  error: function (xhr, textStatus, errorThrown) {
      var errorData = $.parseJSON(xhr.responseText);
      var errorMessages = [];
      ...
  },
  ...
}); 
```

我强烈建议看看是什么`xhr.responseText`。我猜它不包含有效的 JSON，因此 parseJSON 方法会引发“意外令牌 B”错误。

要查看此值，您可以`console.log(xhr.responseText);`在 Web 浏览器或 fiddler 中放置或使用诸如 javascript 调试器之类的工具来查看其中的内容。

我的猜测是服务器正在发回一个字符串，`There was an error on the server`而不是你期望的 JSON。我看到您内置了错误处理 - 我的猜测是您的错误处理中存在错误，并且没有什么可以捕获它。我建议在服务器端进行调试，看看是否有你不期望的错误。

也许 profile.messages 只能枚举一次，当您再次尝试这样做时，它会引发错误。或者也许 DB.SaveChanges 出于某种原因引发了错误。其中任何一个都会导致您在客户端看到的行为所记录的消息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-29T03:25:32.150

您正在尝试使用您自己的自定义响应内容返回 400 响应（错误请求）。

我认为默认情况下 IIS 不允许您这样做，并且正如 CodeThug 所提到的，可能正在用服务器消息替换您的自定义 JSON 内容。

但似乎您可以覆盖此行为：

[http://develoq.net/2011/returning-a-body-content-with-400-http-status-code/](http://develoq.net/2011/returning-a-body-content-with-400-http-status-code/)

```
<system.webServer>
    <httpErrors existingResponse="PassThrough"></httpErrors>
</system.webServer> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-27T06:34:35.190

过去，在淘汰和引导程序中使用 ASP.NET 脚本捆绑时，我收到过类似的神秘错误，尤其是在捆绑中包含已经缩小的版本时。

如果您在本地主机上以调试模式运行，那么 ASP.NET 将不会缩小 javascript 库。但是，一旦部署，您可能不再处于调试模式，现在正在缩小/捆绑脚本。有时，这些脚本的捆绑/缩小可能会导致类似于您发布的语法错误。

如果是这样，您可以从 CDN 加载淘汰赛以避免捆绑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-08T18:39:51.200

似乎 JSON 正在发送，因为来自服务器的响应生成错误

```
ex: if a value in the database is hi "my" friends

    JSON file will be generated as text:"hi "my" friends" 
```

因此属性文本的值生成错误。

在生产/开发服务器中仔细检查这些值。

最佳做法是用转义字符替换引号

```
ex: text:"hi \"my\" friends" 
```

# ruby-on-rails - 如何显示单个微博的链接？（轨道上的红宝石 3 ）

> ID：16069733
> 
> 赞同：1
> 
> 时间：2013-04-17T20:32:46.707
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我遵循了 rails 3 教程，并试图让它正常工作。

用户发布的所有微博都列在`http://localhost:3000/users/username`

用户控制器

```
def show
    @user = User.find(params[:id])
    @microposts = @user.microposts.paginate page: params[:page], :per_page => 15
    end 
```

每个微博都有一个ID

```
create_table "microposts", :force => true do |t|
    t.text     "content"
    t.integer  "user_id"
    t.datetime "created_at",                         :null => false
    t.datetime "updated_at",                         :null => false
    t.string   "image"
    t.text     "comment_content"
  end 
```

如何设置它，以便`http://localhost:3000/users/username/micropost_id`（如果有效）之类的链接将指向只有该​​微帖子的页面？

我希望显示完全相同，只是在新页面上单独显示。

用户表

```
create_table "users", :force => true do |t|
    t.string    "name"
    t.string    "email"
    t.timestamp "created_at",                         :null => false
    t.timestamp "updated_at",                         :null => false
    t.string    "password_digest"
    t.string    "remember_token"
  end 
```

我的配置路线

```
MyApp::Application.routes.draw do
  resources :authentications

resources :microposts, :path => "posts"

root to: 'static_pages#home'

            ActiveAdmin.routes(self)

  resources :users do
    member do
      get :following, :followers
    end
  end
  resources :sessions, only: [:new, :create, :destroy]
  resources :microposts, only: [:create, :destroy]
  resources :relationships, only: [:create, :destroy]
  resources :microposts do
  resources :postcomments

end

  match '/signup',   to: 'users#new'
  match '/signin',   to: 'sessions#new'
  match '/signout',  to: 'sessions#destroy', via: :delete

  match '/post',    to: 'static_pages#post'
  match '/about',   to: 'static_pages#about'
  match '/contact', to: 'static_pages#contact'
  match '/users/:username/:id', to: 'microposts#show', via: :get, as: :user_micropost
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:02:52.697

您应该向您的 routes.rb 文件添加一条新路由，如下所示：

```
match '/users/:username/:id', to 'microposts#show', via: :get, as: :user_micropost 
```

在显示用户微博的页面上，将链接添加为：

```
<a href="<%= user_micropost_path(username: @user.username, id: micropost.id) %>">Whatever..</a> 
```

在 microposts 控制器上，添加方法 show：

```
def show
  @user = User.find_by_username(params[:username])
  @post = Post.find_by_id(params[:id])
  # handle any errors from the code above
end 
```

并在下创建

```
app/views/microposts/show.html.erb 
```

将显示微博的新页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T21:20:13.673

我想在你的路线中你提到过这样的事情

```
resources :users do
    resources :microposts
end 
```

在这种情况下，您可以在***/views/users/show.html.erb***中创建一个链接，如下所示

```
<% @microposts.each do |post|
   <%= link_to truncate(post.content, :length => 10, :separator => '...'), user_micropost_path(@user, post) %>
<% end %> 
```

# javascript - javascript：在创建自定义事件时获取“DOM Exception 9”

> ID：16069741
> 
> 赞同：0
> 
> 时间：2013-04-17T20:32:58.767
> 
> 标签：javascript, android, cordova

我正在使用 PhoneGap 开发一个安卓应用程序。在**index.html**中，我加载了一个这样的 js 文件：

**索引.html**

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<link rel="stylesheet" href="styles/style.css" />
<link rel="stylesheet" href="styles/loading.css" />
<script src="scripts/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="scripts/cordova-2.5.0.js"></script>
<script type="text/javascript" src="scripts/readImages.js"></script>

<script type="text/javascript">
    function onReadImage(event) {
        //do something
    }
    document.addEventListener("onReadImage", onReadImage, false);
</script>
</head>
<body>
<!--
  .....
-->
</body>
</html> 
```

**readImages.js**

```
// Some codes

window.readImageEvent= document.createEvent("readImageEvent"); // line 4
readImageEvent.initEvent("onWeddingCakesRead", true, true); 

//Some functions

readImageEvent.images = data;
document.dispatchEvent(readImageEvent); 
```

但是当我检查 LogCat 时，我看到了这个错误：

**未捕获的错误：NOT_SUPPORTED_ERR：文件中的 DOM 异常 9：///android_asset/www/scripts/readImages.js：4**

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:45:42.860

最后我发现了问题。

我更改了以下代码：

```
window.readImageEvent= document.createEvent("readImageEvent"); 
```

至：

```
window.readImageEvent= document.createEvent("Event"); 
```

因为“readImageEvent”不是正确的事件类型。[这个链接](https://developer.mozilla.org/en-US/docs/DOM/document.createEvent)对于这个问题可能非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:45:55.627

根据[developer.mozilla.org](https://developer.mozilla.org/en-US/docs/DOM/document.createEvent)

> createEvent 方法已弃用。

我想，你可以尝试这样的事情：

```
var readImageEvent = new CustomEvent(
    "onReadImage",
    {
        detail: {
            images: data
        },
        bubbles: true,
        cancelable: true
    }
);
document.dispatchEvent(readImageEvent); 
```

有关使用、兼容性等的更多信息可以在[**这里找到**](https://developer.mozilla.org/en-US/docs/DOM/Event/CustomEvent)

# iphone - 控制 UINavigationItem titleView 的大小/位置

> ID：16069744
> 
> 赞同：23
> 
> 时间：2013-04-17T20:33:05.483
> 
> 标签：iphone, ios, cocoa-touch, uinavigationcontroller, uinavigationbar

在我的应用程序中，我有一些自定义标题（带有不是字体的字体）存储在我想作为导航标题的 png 中。我希望标题中的字母对于每个不同的视图控制器都具有相同的大小，因此在 illustrator 中，我一直致力于使其大小和宽度都相同（提供空白空间以考虑较短的字符串）。我执行以下操作：

```
UIImageView *titleImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"SelectAnAlbumTitleLettering"]];
titleImageView.contentMode = UIViewContentModeCenter;
self.navigationItem.titleView = titleImageView;
[titleImageView release]; 
```

并且似乎图像是根据每个元素上包含的元素`navigationBar`（即后退按钮、右键等）任意调整大小和定位的。

我想知道，我怎样才能获得控制权，`titleView`这样我才能让它实现我想要的大小和位置，所以它不会被任意调整大小/重新定位。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-04-17T20:48:43.050

不要使用您的图像视图作为标题视图，而是创建另一个包含图像视图的视图。*将该*视图设置为导航项的标题视图；现在您可以在标题视图中自由调整图像视图的框架。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-04-17T20:55:52.790

您可以控制 UINavigationbar 标题视图的大小和位置。不要直接将 imageview 设置为 titleview。而是创建一个自定义 UIView，然后根据您的要求设置其框架并将您的 titleImageView 添加为其子视图。

```
UIView *backView =[[UIView alloc] initWithFrame:CGRectMake(0, 0, 200, 40)];// Here you can set View width and height as per your requirement for displaying titleImageView position in navigationbar 
[backView setBackgroundColor:[UIColor greenColor]];
UIImageView *titleImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"SelectAnAlbumTitleLettering"]];
titleImageView.frame = CGRectMake(45, 5,titleImageView.frame.size.width , titleImageView.frame.size.height); // Here I am passing origin as (45,5) but can pass them as your requirement. 
[backView addSubview:titleImageView];
//titleImageView.contentMode = UIViewContentModeCenter;
self.navigationItem.titleView = backView; 
```

希望它可以帮助你。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2015-10-16T09:57:00.607

在 Swift 中，你可以这样做：

```
 var titleView = UIView(frame: CGRectMake(0, 0, 100, 40))
    var titleImageView = UIImageView(image: UIImage(named: "cocolife"))
    titleImageView.frame = CGRectMake(0, 0, titleView.frame.width, titleView.frame.height)
    titleView.addSubview(titleImageView)
    navigationItem.titleView = titleView 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-04T11:38:54.463

更新了 Swift4 代码：

```
 var titleView = UIView(frame: CGRect(x: 0, y: 0, width: 100, height: 40))
    var titleImageView = UIImageView(image: UIImage(named: "headerlogo"))
    titleImageView.frame = CGRect(x: 0, y: 0, width: titleView.frame.width, height: titleView.frame.height)
    titleView.addSubview(titleImageView)
    navigationItem.titleView = titleView 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-28T15:38:42.537

**快速更新 5**

```
var titleView = UIView()
navigationItem.titleView?.translatesAutoresizingMaskIntoConstraints = false   
navigationItem.titleView = titleView 
```

# php - 使用 PHP 和 LDAP 列出所有 Active Directory 组？

> ID：16069747
> 
> 赞同：2
> 
> 时间：2013-04-17T20:33:10.237
> 
> 标签：php, ldap

我想在 PHP 页面上列出所有组，无论当前用户如何。我可以找到有关如何列出用户所属的所有组的信息，而不仅仅是列出每个组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T23:59:48.940

您必须查询 (objectClass=Group) 并列出结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-30T00:53:31.880

很老的帖子，但还没有合理的答案。如果有人正在寻找解决方案（比如我自己），您可以尝试：

```
$basedn = "OU=Managed,OU=Groups,DC=YOUR,DC=ORGANIZATION,DC=DETAILS,DC=com";
$sr = ldap_list($YOUR_LDAP_CONN, $basedn, "cn=*", array('cn'));
$info = ldap_get_entries($ldapconn, $sr); 
```

如果您不确定您的`$basedn`或以上`$basedn`不适合您。您可以使用[Active Directory Explorer GUI](https://technet.microsoft.com/en-us/sysinternals/bb963907.aspx://) 来查找您的`$basedn`

# vba - VBA 编辑 SharePoint 讨论帖 (PostItem) 和更新 Web 讨论

> ID：16069748
> 
> 赞同：3
> 
> 时间：2013-04-17T20:33:14.940
> 
> 标签：vba, sharepoint, outlook

我有一个与 Outlook 2010 同步的 SharePoint 讨论板。

我希望能够以编程方式在 Outlook VBA 中的 SharePoint 讨论板中修改我的帖子，并将这些更改反映在在线讨论板上。

下面的代码在测试用例中用于修改 Outlook 端的项目，但它不与 SharePoint 同步。

```
Private Sub modifySharePointItem()

    Dim obj As Outlook.PostItem
    Set obj = Application.ActiveExplorer.Selection.item(1)

    obj.Body = obj.Body + "test addition"
    obj.Save
    obj.Post

End Sub 
```

我假设我不仅需要，`Save`而且还需要`Post`一个额外的“同步”类型命令，但我不知道它是什么。

不幸的是，阅读数据模型`PostItem`基本上没有用，而且这些方法似乎都没有做我感兴趣的事情。

* * *

我发现（偶然.....）我可以从 Outlook 中删除帖子 - 所以我显然可以在这里得到很多，但我仍然不确定如何在修改项目时同步列表。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-05-07T19:19:18.457

您可以使用客户端对象模型在 Sharepoint 中进行修改和编辑。我一直都这样做。由于 Outlook 2010 编译为 CLI，因此您可以使用客户端对象模型 dll 来执行您需要的操作。如果你需要的话，我有一大堆 C# 代码可以分享。这是我以前开始的。

[http://msdn.microsoft.com/en-us/library/ee537247(v=office.14).aspx](http://msdn.microsoft.com/en-us/library/ee537247(v=office.14).aspx)

我希望这会有所帮助！

# c++ - GCC 4.8 的 C++11 问题

> ID：16069751
> 
> 赞同：2
> 
> 时间：2013-04-17T20:33:40.693
> 
> 标签：c++, netbeans, c++11, cygwin

我已经开始尝试 c++11 添加到该语言中的一些功能，并且在运行一些简单程序时遇到了问题。

首先，让我描述一下我运行这些测试的环境，然后我将提供一个简短的示例。

因为它似乎是对新标准支持最广泛的编译器，所以我决定使用我通过 cygwin 编译和安装的 GCC 4.8（我还要声明我的操作系统是 Windows 8，但我也经历过Windows 7 x64 上的相同问题）。

我不是手动编译，而是使用 Netbeans 7.3。

例子：

```
#include <cstdlib>
#include <iostream>
#include <random>

using namespace std;

int main(int argc, char** argv) {

   std::uniform_real_distribution<double> x { -1.0, 1.0 };
   std::default_random_engine re {};                

   cout << x( re );

   return 0;
} 
```

正如你所看到的，在这个例子中，我正在尝试使用 Stroustrup 网站上的最基本的生成器来生成一些随机双打。编译进行得很顺利，但是，当我实际运行生成的可执行文件时，Netbeans 内部控制台中会显示以下消息：

```
RUN FAILED (exit value 127, total time: 16ms) 
```

此外，当我尝试调试程序时，使用 gdb（通过 cygwin 安装）我得到以下信息：

```
During startup program exited with code 0xc0000135. 
```

我无法弄清楚这种行为的原因，但我不认为这是某种链接问题（但我可能是错的）。

我期待任何建议。

谢谢

# django - 使用 Django 禁用匿名用户 cookie

> ID：16069753
> 
> 赞同：10
> 
> 时间：2013-04-17T20:33:46.970
> 
> 标签：django, session, cookies, anonymous

我为我的网站使用 django auth，它需要安装会话中间件。

Django 会话中间件总是添加一个会话 cookie，即使对于匿名用户（未经身份验证的用户）也是如此。当他们进行身份验证时，cookie 将替换为另一个表明用户已登录的 cookie。

我想禁用匿名用户 cookie 以进行缓存（清漆）。

有没有办法在不删除使用身份验证的应用程序所必需的会话中间件的情况下禁用匿名用户 cookie？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-18T06:16:29.933

会话数据设置在 cookie`process_response`中`SessionMiddleware`。此函数不使用任何设置 或`request.user`，因此您无法在此方法中知道用户是登录用户还是匿名用户。因此，您不能禁用将会话 cookie 发送到浏览器。

但是，如果您想要此功能，则可以子类化`SessionMiddleware`和覆盖`process_response`.

```
from django.contrib.sessions.middleware import SessionMiddleware
from django.conf import settings

class NewSessionMiddleware(SessionMiddleware):

    def process_response(self, request, response):
        response = super(NewSessionMiddleware, self).process_response(request, response)
        #You have access to request.user in this method
        if not request.user.is_authenticated():
            del response.cookies[settings.SESSION_COOKIE_NAME]
        return response 
```

你可以用你`NewSessionMiddleware`的代替`SessionMiddleware`.

```
MIDDLEWARE_CLASSES = (
  'django.middleware.common.CommonMiddleware',
  'myapp.middleware.NewSessionMiddleware',
  'django.contrib.auth.middleware.AuthenticationMiddleware',
  'django.middleware.doc.XViewMiddleware',
  'django.contrib.messages.middleware.MessageMiddleware',
  'django.middleware.csrf.CsrfViewMiddleware',
) 
```

# excel - 按布尔值过滤数据透视表

> ID：16069757
> 
> 赞同：2
> 
> 时间：2013-04-17T20:33:57.800
> 
> 标签：excel, pivot-table, excel-2011

我的 Excel 数据透视表的源数据如下所示（这是一个简化）：

```
id name score
1 john  15
2 james 2
3 pat   14
4 jake  12
... 
```

我有一个将其用作数据源的数据透视表。现在，我想做的是让数据透视表只考虑 id 小于 100 的条目。这在理论上可以通过在 id 上使用报告过滤器并取消选择任何大于 100 的数字来实现。但这很荒谬。

如何使用布尔约束过滤掉数据？我尝试了各种方法，但都没有奏效。似乎计算字段是关键，但似乎不可能在计算字段上创建过滤器。

我正在使用 Excel 2011 for Mac，如果这有所不同的话。我是一名程序员，但我从来没有在 Excel 中编程，所以如果这是解决方案，我会要求婴儿步骤。：） 谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T21:31:41.300

AFAIK，在 Excel 2011 中，您不能使用报表过滤器来应用任何类型的过滤器。您必须手动选中/取消选中您想要或不想要的值。

我能想到的替代方法是在您的数据之前插入一列并输入公式

`=If(B2<100,TRUE,FALSE)`

并使用自动填充将其复制下来。（见下面的截图）

![在此处输入图像描述](https://i.stack.imgur.com/FcTAC.png)

现在创建一个数据透视表并将字段“小于 100”放在报告过滤器中，然后简单地选择`TRUE`（见下面的截图）

![在此处输入图像描述](https://i.stack.imgur.com/PJ8Kg.png)

如果您不想走这条路，则将 ID 字段从 REPORT FILTER 移至 ROW LABEL，您可以在其中使用过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:43:49.053

报告过滤器正是我要做的，但不是像您建议的那样手动取消选择字段，而是将标签过滤器应用到小于截止点，在您的示例中为 100。

我没有在 Mac 上使用 Excel，但在 Windows 上的 PivotTable Field List 上，在 id 字段右侧单击黑色小箭头，然后选择 Label Filters -> Less Than，然后在弹出的对话框中输入 100。

鉴于 PivotTables 的内在价值是能够针对这种情况准确地应用过滤器，我认为我不会做任何更复杂的事情。

# android - 限制来自适配器的 ListView 中的项目数

> ID：16069764
> 
> 赞同：0
> 
> 时间：2013-04-17T20:34:17.573
> 
> 标签：android, sqlite, listview, simplecursoradapter

我目前正在使用带有 ListView 的 SimpleCursorAdapter，它使用 CursorLoader 从 ContentProvider 和 SQlite DB 中提取项目。数据库包含大约 300 个项目，我想限制适配器通过 Listview 的数量，因此 ListView 不会显示数据库中的所有项目。我想避免对 db.query 施加限制，而是在 Adapter 中保留项目或限制 ListView。我还没有找到一个优雅的解决方案。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:45:44.123

制作一个自定义适配器，并覆盖 getCount 函数以返回 min(actual_number, max_you_want);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:58:31.677

> 数据库包含大约 300 个项目，我想限制适配器通过 Listview 的数量，因此 ListView 不会显示数据库中的所有项目。

游标相当有效，300 是一个相对较小的数字，因此您应该能够一次获取所有 300。它们仅在 ListView 滚动时绘制。因此，如果您看到性能缓慢，问题可能在于渲染行，而不是光标。

> 我想让适配器获取数据并让 ListView 仅在到达可见项目的末尾时才显示它，例如一次加载 25 个项目。

这很简单，考虑如下查询：

```
//db.query(tableName, columns, where, whereArgs, groupBy, having, orderBy, limit);
int limit = 25;
Cursor cursor = db.query(TABLE_NAME, null, null, null, null, null, null, String.valueOf(limit)); 
```

当您到达 ListView 的底部时，再添加 25 个`limit`并再次运行查询：

```
limit += 25;
cursor = db.query(TABLE_NAME, null, null, null, null, null, null, String.valueOf(limit)); 
```

以此类推，直到`limit >= cursor.getCount()`。

# php - 使用 PHP 通过表单进行多个 URL 重定向

> ID：16069767
> 
> 赞同：0
> 
> 时间：2013-04-17T20:34:27.980
> 
> 标签：php, forms

我希望看看我是否可以从我正在从事的项目中得到一些帮助。

我现在非常迷茫，但是我需要做的是，当用户填写表单时，如果他们选择了其中一个下拉菜单并选择了主页单选按钮，并且他们输入了圣地亚哥的邮政编码，则需要他们到该下拉列表中的任何 URL。

如果他们不输入圣地亚哥邮政编码，则会根据下拉菜单将他们带到国家页面。这部分实际上已经完全完成并且可以正常工作。客户然后转身说，如果他们选择了办公室单选按钮和列表中选定的下拉菜单之一，它会将他们带到办公室版本页面，无论该下拉菜单是什么。无论是送水、咖啡服务还是水过滤。

我完全不知道如何根据不同的单选按钮进行 url 重定向，因此他们需要 home 单选按钮转到常规下拉菜单，并且在选择办公室时需要转到基于完全不同的 url办公室选项。因此，它将是办公室供水或办公室咖啡服务。

我非常不确定如何根据一个办公室单选按钮选择进行三种不同的 url 重定向。无论如何，我真的可以帮上忙，谢谢。源代码如下。谢谢

```
<script type="text/javascript">
    function setAction(nPage){
        document.forms[0].action = nPage;
    }
</script>

<div class="home-form">
    <form method='get' id='gform_1' action='http://50.22.79.62/~pftech/form-handler/'>
        <div class="serviceinput"
            <label for="services">Services: </label>
            <select id="selection" name="selection">
                <option value=''>Select a Service</option>
                <option value='http://50.22.79.62/~pftech/water-delivery-service/'>Water Delivery</option>
                <option value='http://50.22.79.62/~pftech/coffee-delivery/'>Coffee Services</option>
                <option value='http://50.22.79.62/~pftech/water-filtration-systems/'>Water Filtration</option>
            </select>
        </div>
        &nbsp;
        <div class="zipcode">
            <label for="zip">Zip Code: </label>
            <input name="zip" type="text" maxlength="5" id="zip" /></div>
            <div class="frontradio"><input name="home" type="radio" id="homeradio" />
            <div class="homelabel"> <label for="homeradio">Home</label></div>
            <input name="home" type="radio" id="officeradio" />
            <label for="officeradio">Office</label></div>
            <div class="homebutton">
                <input type='submit' id="submithome" name="did_submit" value="Get Started!">
            </div>
        </div>
    </form>
</div> 
```

表单处理程序：

```
<?php
    if(isset($_GET['zip'])){
        $sandiego = array('91911', '91914', '91915', '91932', '91942', '91945', '91950', '92014', '92025', '92027', '92029', '92037', '92064', '92065', '92067', '92071', '92075', '92101', '92102', '92103', '92104', '92105', '92106', '92107', '92108', '92109', '92110', '92111', '92113', '92114', '92115', '92116', '92117', '92118', '92119', '92120', '92121', '92122', '92123', '92124', '92126', '92127', '92128', '92129', '92130', '92131', '92132', '92134', '92135', '92139', '92140', '92145', '92147', '92154', '92173', '92562', '92563', '92590', '92591', '92592', '92596');
        if (in_array($_GET['zip'], $sandiego)){
            header("Location: ".$_GET['selection']."?zip=".$_GET['zip']."&type=".$_GET['type']);
        } else {
            header("Location: http://www.pureflo.com/");
        }
    }
    exit;
?> 
```

表格实际位于的网站：

```
http://50.22.79.62/~pftech/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:42:29.450

我认为你混淆了你的优先事项。一方面，不要将目标 id 放入那些选项值中。使用简单的值，如“1”、“2”、“3”等。

“魔法”发生在您的评估方法中。首先，评估是选择家庭还是办公室。

```
if($_GET["home"] == 1) { //Assumes that selecting 'office' returns you this value.
} else {
} 
```

接下来，在该选择中，用目标数据填充数组。

```
$urls = array();
if($_GET["home"] == 1) { //Assumes that selecting 'office' returns you this value.
    $urls[] = "http://50.22.79.62/~pftech/water-delivery-service/"
    //rinse and repeat
} else {
    $urls[] = "http://45.22.79.62/~pftech/water-delivery-service/"
    //rinse and repeat
} 
```

此时，您有一个有效的数组，它与选定的下拉框直接相关，依赖于选定的单选按钮。

```
$URL = $urls[$_GET["selection"]]; 
```

现在您只需将该 URL 传递给您的标头函数即可。

只是为了完整起见，这里是建议的代码：

处理程序：

```
<?php
    if(isset($_GET['zip'])){
        $sandiego = array('91911', '91914', '91915', '91932', '91942', '91945', '91950', '92014', '92025', '92027', '92029', '92037', '92064', '92065', '92067', '92071', '92075', '92101', '92102', '92103', '92104', '92105', '92106', '92107', '92108', '92109', '92110', '92111', '92113', '92114', '92115', '92116', '92117', '92118', '92119', '92120', '92121', '92122', '92123', '92124', '92126', '92127', '92128', '92129', '92130', '92131', '92132', '92134', '92135', '92139', '92140', '92145', '92147', '92154', '92173', '92562', '92563', '92590', '92591', '92592', '92596');
        if (in_array($_GET['zip'], $sandiego)){
            $urls = array();
            if($_GET["home"] == 1) { //Assumes that selecting 'office' returns you this value.
                $urls[] = "http://50.22.79.62/~pftech/office_water-delivery-service/"
                $urls[] = "http://50.22.79.62/~pftech/office_coffee-delivery/"
                $urls[] = "http://50.22.79.62/~pftech/office_water-filtration-systems/"
            } else {
                $urls[] = "http://50.22.79.62/~pftech/home_water-delivery-service/"
                $urls[] = "http://50.22.79.62/~pftech/home_coffee-delivery/"
                $urls[] = "http://50.22.79.62/~pftech/home_water-filtration-systems/"
            }
            if($_GET['selection'] < 3 && $_GET['selection'] >= 0) {
                $URL = $urls[$_GET['selection']];
                header("Location: $URL?zip=$_GET[zip]");
            } else header("Location: http://www.pureflo.com/"); //Illegal input
        } else {
            header("Location: http://www.pureflo.com/");
        }
    }
    exit;
?> 
```

选择框的 HTML 如下所示：

```
<select id="selection" name="selection">
    <option value='-1'>Select a Service</option>
    <option value="0">Water Delivery</option>
    <option value="1">Coffee Services</option>
    <option value="2">Water Filtration</option>
</select> 
```

我希望这有帮助。

# ruby-on-rails - 如何在从不同类继承的两个类之间共享数组

> ID：16069783
> 
> 赞同：0
> 
> 时间：2013-04-17T20:35:04.043
> 
> 标签：ruby-on-rails, controllers, faye, data-sharing

我有一个带有 PubSub 服务器（Faye）作为中间件的 Rails 应用程序。我有用于模型、视图和控制器的常用 Rails 结构，并且我有一些用于套接字通道的控制器。（提供通过[FayeRails](https://github.com/jamesotron/faye-rails) )

**问题：** 我需要在我的套接字控制器和我的通用控制器之间共享一个客户端列表。这是因为身份验证是通过 Rails 控制器完成的（所以我可以使用会话）..

通常我会把这种东西放在我的`ApplicationController`所有继承的控制器和视图中，但是套接字控制器是从继承的，`FayeRails::Controller`所以不是一个选项。我不知道这些控制器的实例去哪里了。另外，我无法编辑初始化，因为所有控制器都是由 Rails 和 FayeRails gem 自动设置的。我尝试使用全局变量，但感觉不对。我也一直在考虑 ActiveRecord，但是将快速变化的数据添加到数据库中感觉不对。最后我想到了一个类似于 ActiveRecord 的类，它包含列表，但这感觉和全球一样..

我真的想不出在这两个控制器之间共享客户端列表的任何其他选项。

这样做的好方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:50:08.437

您可以将所需的内容放在 lib 目录中的模块中。将它包含在您的 application_controller 中，然后扩展主要的 FayeRails 控制器，也将模块包含在其中。要扩展，只需在您的控制器文件中创建一个具有相同名称的新的，也许确定类名是相同的，然后在您的 config/initializers/extensions.rb 文件中要求它。

例子

```
# config/initializers/extensions.rb
require "#{Rails.root}/app/controllers/whatever_controller.rb" 
```

至于速度，是的，如果您担心我会考虑将您需要的东西保存在持久性 redis 数据库中。但是如果 FayesRails 使用 ActiveRecord 方法，我不确定这将是多么容易/难。

# apache - 如何使用 FUSE 挂载具有适当权限的 S3 卷

> ID：16069784
> 
> 赞同：8
> 
> 时间：2013-04-17T20:35:06.747
> 
> 标签：apache, amazon-s3, ubuntu-12.04, fuse, s3fs

我有一个需要安装在 EC2 实例（Ubuntu 12.04.2）上的 Amazon S3 存储桶（我们称之为 static.example.com）。我已经安装了 s3fs。我可以挂载卷，但无法写入存储桶。我努力了：

```
sudo s3fs static.example.com -o use_cache=/tmp,allow_other,uid=33,gid=33 /mnt/static.example.com 
```

`cd /mnt`然后我可以`ls -la`看到：

```
drwxr-xr-x  5 root     root      4096 Mar 28 18:03 .
drwxr-xr-x 25 root     root      4096 Feb 19 19:22 ..
lrwxrwxrwx  1 root     root         7 Feb 21 19:19 httpd -> /httpd/
drwx------  2 root     root     16384 Oct  9  2012 lost+found
drwxr-xr-x  1 www-data www-data     0 Jan  1  1970 static.example.com 
```

这一切看起来都不错，但是当我`cd static.example.com`和时`mkdir test`，我得到：

```
mkdir: cannot create directory `test': Permission denied 
```

我可以实际创建目录或触摸文件的唯一方法是使用`sudo`. 但是，这不是一个可行的选择，因为我想从 Apache 将文件写入存储桶。我的 Apache 服务器以 user:group www-data 身份运行。运行`mount`产量：

```
s3fs on /mnt/static.example.com type fuse.s3fs (rw,nosuid,nodev,allow_other) 
```

如何以允许我写入存储桶的方式安装此存储桶？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-28T13:33:26.797

我是开源项目[RioFS](https://github.com/skoobe/riofs)的主要开发人员和维护人员：一个用于挂载 Amazon S3 存储桶的用户空间文件系统。

我们的项目是“s3fs”项目的替代方案，与“s3fs”相比的主要优点是：简单、操作速度和无错误代码。目前[该项目](https://github.com/skoobe/riofs)处于“测试”状态，但它已经在几个高负载文件服务器上运行了相当长的一段时间。

我们正在寻求更多的人加入我们的项目并帮助进行测试。从我们这边，我们提供快速的错误修复，并会听取您添加新功能的请求。

关于你的问题：

如果您使用[RioFS](https://github.com/skoobe/riofs)，则可以使用以下命令安装存储桶并对其具有写入权限（假设您已安装[RioFS](https://github.com/skoobe/riofs)并已导出 AWSACCESSKEYID 和 AWSSECRETACCESSKEY 环境变量）：

```
riofs  -o allow_other http://s3.amazonaws.com bucket_name /mnt/static.example.com 
```

（命令行参数请参考项目描述）

请注意，该项目仍在开发中，可能仍存在许多错误。

如果您发现某些事情没有按预期工作：请在[项目的 GitHub 页面](https://github.com/skoobe/riofs/issues?state=open)上填写问题报告。

希望它有所帮助，我们期待看到您加入我们的社区！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-11T23:04:34.960

这对我有用：

```
sudo s3fs bucketname /mnt/folder -o allow_other,nosuid,use_cache=/mnt/foldercache 
```

如果需要调试，只需添加`,f2 -f -d`：

```
sudo s3fs bucketname /mnt/folder -o allow_other,nosuid,use_cache=/mnt/foldercache,f2 -f -d 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-18T17:54:33.840

使用 S3Backer 尝试此方法：

```
mountpoint/
    file       # (e.g., can be used as a virtual loopback)
    stats      # human readable statistics 
```

阅读更多关于它的信息： [http ://www.turnkeylinux.org/blog/exploring-s3-based-filesystems-s3fs-and-s3backer](http://www.turnkeylinux.org/blog/exploring-s3-based-filesystems-s3fs-and-s3backer)

# c# - 在 Web 浏览器控件中单击按钮登录网站

> ID：16069798
> 
> 赞同：1
> 
> 时间：2013-04-17T20:35:54.277
> 
> 标签：c#, winforms, web-controls

我有一个我为工作创建的程序来跟踪信息。我们从各种 Intranet 站点获取此信息。我想在我的程序中包含一个表单，它本质上是一个定制的网络浏览器，让我可以更轻松地浏览这些网站。这对我来说是一个学习项目，所以请原谅我的经验不足。

对于这个问题，我正在寻找一种方法，在使用浏览器控件加载页面后，我可以从存储在字符串中的凭据登录到该页面。我无权访问我试图输入此信息的站点的 HTML 代码，并且已经看到了许多关于如何通过 GetElementId 执行此操作的教程，但是在使用 Firebug 之后，我发现我需要输入的两个文本框都没有一个 id（无论如何我都能看到）。该网站从未改变，我确实考虑过使用 GetElementFromPoint，但不确定如何以这种方式进行，而且它似乎不是最优的。GetElementsByTagName 似乎是最好的方法，但不确定如何实现代码。

这是我能够从萤火虫获得的两个元素的信息。

用户名文本框： `<input type="text" name="j_username" size="12" onblur="this.value=this.value.toLowerCase(); setUserIdCookie();" click="this.value=this.value.toLowerCase();" onkeyup="this.value=this.value.toLowerCase();">`

密码文本框：

```
<input type="password" onkeypress="checkCapsLock( event )" name="j_password" size="12"> 
```

所以我需要例如从我的 Winform 传递`usernameString`给 j_username，然后`passwordString`传递给 j_password，然后单击 `<input type="submit" name="submit" value="Login">`Web 控件中的按钮。如果我能从这个站点了解如何解决这个问题，我应该能够从中学到足够的知识，以便在其他站点中实施。

提前感谢您的帮助，如果需要任何其他信息，请告诉我。

完整的 HTML 代码：

```
<form method="POST"action="j_security_check" name="login"> 
<table border="0"width="30%"cellspacing="3"cellpadding="2">
  <tr>
     <td class="default"><b>Login</b></td>      
     <td class="default"><input onkeyup="this.value=this.value.toLowerCase();"
      click="this.value=this.value.toLowerCase();" 
      onblur="this.value=this.value.toLowerCase(); setUserIdCookie();"    
       type="text"size="12" name="j_username"></td>     
  </tr>     
  <tr>      
      <td class="default"><b>Password</b></td>      
      <td class="default"><input type="password" size="12"
      name="j_password"onKeyPress="checkCapsLock( event )"></td>    
  </tr>     

  <tr>      
  <td colspan="2" align="center"><p class="default">  
  <inputtype="submit"value="Login"name="submit"></td>   
  </tr>
  </table> 
  </form> 
```

**编辑**

我找到了一种输入框的方法

```
 var x = webBrowser1.Document.All.GetElementsByName("j_username");
        x[0].InnerText = (usernameString);
        var y = webBrowser1.Document.All.GetElementsByName("j_password");
        y[0].InnerText = (passwordString); 
```

但是我无法弄清楚如何单击登录按钮

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:00:08.767

当然，在发布了这篇不错的长篇文章并为此工作了几个小时后，我终于偶然发现了答案。对于任何遇到同样问题的人来说，我在这里是一种实现这一目标的方法。在我的场景中，这个解决方案效果很好：

```
private void button4_Click(object sender, EventArgs e)
{
   //Set username and password strings
   string usernameString = "username";
   string passwordString = "password";

   //Input in to username field
   var x = webBrowser1.Document.All.GetElementsByName("j_username");
   x[0].InnerText = (usernameString);

   //Input in to password fields
   var y = webBrowser1.Document.All.GetElementsByName("j_password");
   y[0].InnerText = (passwordString);

   //Click the login button
   var s = webBrowser1.Document.All.GetElementsByName("submit");
   s[0].InvokeMember("click");
} 
```

# android - 我希望在具有 imageView 和 TextView 的相对布局中有一个 mapView

> ID：16069799
> 
> 赞同：0
> 
> 时间：2013-04-17T20:35:59.387
> 
> 标签：android, android-mapview, android-relativelayout

要获得 MapView，我必须使用 MapActivity 扩展我的类。当我尝试执行此操作时，我收到错误“创建 MapActivity 类”。

如果我不使用 MapActivity 扩展它并改用 Activity，我会得到以下异常。

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.strive.gostrive/com.strive.gostrive.EventDetailActivity}: android.view.InflateException: Binary XML file line #168: Error inflating class com.google.android.maps.MapView 
```

我已经在 xml 文件、android 清单文件中进行了必要的更改。我还在我的项目中包含了 google play services 库。谷歌播放服务和我的应用程序的目标是相同的。

需要帮忙！！

这是我的xml文件

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@drawable/background"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context=".EventDetailActivity" >

<ImageView
    android:id="@+id/eventDImg"
    android:layout_width="fill_parent"
    android:layout_height="200dp"
    android:layout_alignBaseline="@+id/eventDEndDate"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:src="@drawable/innershadow" />

<TextView
    android:id="@+id/textView2D"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/eventDDateTV"
    android:layout_alignBottom="@+id/eventDDateTV"
    android:layout_toRightOf="@+id/eventDDateTV"
    android:text="-" />

<TextView
    android:id="@+id/eventDEndDate"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/textView2D"
    android:layout_toRightOf="@+id/textView2D"
    android:maxLength="10"
    android:text="End Date" />

<TextView
    android:id="@+id/eventDStartAge"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/eventDEndDate"
    android:layout_alignLeft="@+id/textView3D"
    android:layout_marginLeft="39dp"
    android:maxLength="2"
    android:text="frm" />

<TextView
    android:id="@+id/textView4D"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/eventDEndDate"
    android:layout_toRightOf="@+id/eventDStartAge"
    android:text="-" />

<TextView
    android:id="@+id/eventDAgeTV"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/eventDEndDate"
    android:layout_toRightOf="@+id/textView4D"
    android:maxLength="2"
    android:text="to" />

<TextView
    android:id="@+id/eventDTitleTV"
    android:layout_width="180dp"
    android:layout_height="wrap_content"
    android:layout_marginTop="48dp"
    android:maxLines="2"
    android:text="Event Title"
    android:textSize="20dp" />

<TextView
    android:id="@+id/eventDDateTV"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/eventDTitleTV"
    android:layout_centerVertical="true"
    android:maxLength="10"
    android:text="Strt Date" />

<TextView
    android:id="@+id/textView1D"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/eventDTitleTV"
    android:layout_marginLeft="180dp"
    android:layout_toLeftOf="@+id/eventDPriceTV"
    android:text="$"
    android:textSize="20dp" />

<TextView
    android:id="@+id/textView3D"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/eventDDayTV"
    android:layout_alignBaseline="@+id/eventDEndDate"
    android:layout_marginLeft="23dp"
    android:layout_toRightOf="@+id/eventDTitleTV"
    android:text="Ages:" />

<TextView
    android:id="@+id/eventDPriceTV"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/textView1D"
    android:layout_alignBottom="@+id/textView1D"
    android:layout_alignLeft="@+id/textView3D"
    android:text="Event Fee"
    android:textSize="20dp" />

<TextView
    android:id="@+id/eventDStrtTime"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/eventDDayTV"
    android:layout_marginTop="16dp"
    android:text="Strt Tym" />

<TextView
    android:id="@+id/eventDEndTime"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/eventDStrtTime"
    android:layout_alignLeft="@+id/eventDEndDate"
    android:layout_marginLeft="26dp"
    android:text="End tym" />

<TextView
    android:id="@+id/eventDVenueTV"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/eventDEndTime"
    android:layout_alignLeft="@+id/eventDGender"
    android:text="Venue" />

<TextView
    android:id="@+id/eventDDayTV"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/eventDImg"
    android:layout_below="@+id/eventDDateTV"
    android:layout_marginTop="31dp"
    android:text="M Tu W" />

<TextView
    android:id="@+id/eventDGender"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/eventDDayTV"
    android:layout_alignBottom="@+id/eventDDayTV"
    android:layout_toRightOf="@+id/textView1D"
    android:text="gender" />

<LinearLayout
    android:layout_width="wrap_content"
    android:layout_height="150dp"
    android:layout_alignLeft="@+id/eventDImg"
    android:layout_alignRight="@+id/eventDImg"
    android:layout_below="@+id/eventDImg"
    android:layout_marginTop="16dp"
    android:orientation="vertical" >

    <com.google.android.maps.MapView
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mapview"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:apiKey="***************************"
        android:clickable="true" />
</LinearLayout> 
```

这里是活动

```
import com.google.android.gms.maps.MapView;
import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import android.widget.TextView;

public class EventDetailActivity extends Activity{

MapView map;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_event_detail);

    Bundle bundle = getIntent().getExtras();
    int position =  bundle.getInt("position");

    map = (MapView) findViewById(R.id.mapview);

    TextView txtEventName = (TextView)findViewById(R.id.eventDTitleTV);
    TextView txtEventFee = (TextView)findViewById(R.id.eventDPriceTV); 

    TextView txtStartDate = (TextView)findViewById(R.id.eventDDateTV);
    TextView txtEndDate = (TextView)findViewById(R.id.eventDEndDate); 

    TextView txtStartAge = (TextView)findViewById(R.id.eventDStartAge);
    TextView txtEndAge = (TextView)findViewById(R.id.eventDAgeTV); 

    TextView txtDaysWeek = (TextView)findViewById(R.id.eventDDayTV); 
    TextView txtEventGender = (TextView)findViewById(R.id.eventDGender); 

    txtEventName.setText(EventModel.PREF_EVENTNAME); 
    txtEventFee.setText(EventModel.PREF_EVENTFEE);
    txtStartAge.setText(EventModel.PREF_EVENTSATRTAGE);
    txtEndAge.setText(EventModel.PREF_EVENTENDAGE);
    txtStartDate.setText(EventModel.PREF_EVENTSTARTDATE);
    txtEndDate.setText(EventModel.PREF_EVENTENDDATE);
    txtDaysWeek.setText(EventModel.PREF_EVENTDAYSWEEK);
    txtEventGender.setText(EventModel.PREF_EVENTGENDER);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.event_detail, menu);
    return true;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:46:48.133

您可以改用 MapFragment。这样你就不需要扩展 MapActivity。 [https://developers.google.com/maps/documentation/android/start?#add_a_map](https://developers.google.com/maps/documentation/android/start?#add_a_map)

要与较低版本一起使用，您可以使用[SupportMapFragment](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/SupportMapFragment)。要使用此类，您必须在构建路径中包含 Android 支持库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-27T05:57:28.327

这是一个在 RelativeLayout 内带有 MapView 的工作 Activity。

要显示地图，请在 Google APIs 上创建一个项目，启用地图 API，创建凭据，将密钥复制到您的应用程序中

```
src/debug/res/values/google_maps.xml
src/release/res/values/google_maps.xml 
```

在应用程序中更新 AndroidManifest.xml

```
 <!--
         The API key for Google Maps-based APIs is defined as a string resource.
         (See the file "res/values/google_maps_api.xml").
         Note that the API key is linked to the encryption key used to sign the APK.
         You need a different API key for each encryption key, including the release key that is used to
         sign the APK for publishing.
         You can define the keys for the debug and release targets in src/debug/ and src/release/.
    -->
    <meta-data
        android:name="com.google.android.geo.API_KEY"
        android:value="@string/google_maps_key" />

<activity android:name=".MapActivity"/> 
```

或者使用 RelativeLayout 和 TextViews 等创建活动布局。使用 findViewById 等。

```
package au.com.derpapps.derpapp;

import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;
import android.widget.RelativeLayout;

import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.MapView;
import com.google.android.gms.maps.OnMapReadyCallback;

public class MapActivity extends Activity implements OnMapReadyCallback  {

    // Private variables

    private MapView mapView;
    private GoogleMap googleMap;

    // Activity methods

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        RelativeLayout relativeLayout = new RelativeLayout(this);
        relativeLayout.setBackgroundColor(Color.WHITE);

        mapView = new MapView(this);
        mapView.onCreate(savedInstanceState);
        RelativeLayout.LayoutParams layoutParams = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.MATCH_PARENT, RelativeLayout.LayoutParams.MATCH_PARENT);
        layoutParams.setMargins(200, 200, 200, 200);
        mapView.setLayoutParams(layoutParams);
        relativeLayout.addView(mapView);
        setContentView(relativeLayout);

        mapView.getMapAsync(this);

    }

    public void onMapReady(GoogleMap googleMap) {
        this.googleMap = googleMap;

        mapView.onResume();
    }

} 
```

# php - 从 PHP 中的最高有效位和最低有效位计算十进制

> ID：16069804
> 
> 赞同：1
> 
> 时间：2013-04-17T20:36:26.440
> 
> 标签：php, bit

我在这里有点难过。我有 2 个 32 位整数，一个用于最高有效位，另一个是最少的。如何在 PHP 中找到这两者的十进制等价物？

*更新：* 我已经尝试了@bwoebi 的建议并对其进行了一些修改。这是代码：

```
$value=get64($msb, $lsb);

function get64($msb, $lsb) {
    $count = count($lsb);
    for($i=0; $i < $count; $i++) {
        $value[$i] = bcadd(bcmul($msb[$i], bcpow(2, 32)), $lsb[$i] > 0?$lsb[$i]:bcadd(bcsub(bcpow(2, 32), $lsb[$i]), 2 << 30)); // $a most significant bits, $b least significant bits
    }
} 
```

输出：

```
msb=Array ( [0] => INTEGER: 0 [1] => INTEGER: 0 ) 
lsb=Array ( [0] => INTEGER: 143 [1] => INTEGER: 0 ) 
value=Array ( [0] => 2147483648 [1] => 2147483648 ) 
```

输出看起来不正确...我预计 143 作为值 [0]。有输入吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:53:18.370

```
bcadd(bcmul($a, bcpow(2, 32)), $b >= 0?$b:bcsub(bcpow(2, 32), $b)); // $a most significant bits, $b least significant bits 
```

应该做的工作。我正在使用 bc 库，因为在 32 位系统上使用普通运算符时可能存在不精确（它将被转换为浮点数）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:52:47.727

您可以使用[BC Math](http://www.php.net/manual/en/book.bc.php)或[GNU Multiple Precision](http://www.php.net/manual/en/book.gmp.php)扩展来执行对于原生 PHP 变量来说值太大的算术运算。

# qt - 为 QGraphicsView 场景创建永久静态覆盖

> ID：16069805
> 
> 赞同：1
> 
> 时间：2013-04-17T20:36:30.180
> 
> 标签：qt, overlay, qgraphicsview, qpixmap, paintevent

我正在使用 Qt（当前为 4.8）制作一个应用程序，它显示来自大量 QGraphicsScene 项目的文字映射。我想用比例注释视图。我对比例的要求是它永久固定在视口小部件上。每当视图比例发生变化（放大等）时，都需要更新它。还有其他可能的叠加项目（指南针等），所以我更喜欢通用解决方案。

我已经查看了有关此问题的早期问题，这些问题表明：

*   使用 ItemIgnoresTransform
*   使用覆盖像素图。

我尝试了 IgnoresTransform 但这种方式不起作用：我无法弄清楚如何将它固定在（比如说）视口的底角，并且在让文本和线条始终以正确的大小显示时遇到了一些困难.

我废弃了它并将 QGraphicsView 子类化，通过重新实现paintEvent（调用原始像素图，然后在顶部绘制覆盖像素图）添加一个覆盖像素图，以及一个指示它去哪里的对齐选项。编写一些像素图绘制代码会在视图上生成可用的比例。耶！......但它不适用于卷轴 - 我得到整个比例的“破碎”渲染，或者有时根本没有比例。我认为这是因为 QGraphicsView::scrollViewportBy() 使用 viewport()->scroll() 所以我想知道切换到 ViewportSmartUpdate 是否会有所帮助，但这并没有足够的帮助。我不希望切换到 ViewportFullUpdate，因为这可能会降低应用程序的速度（场景中有数百万个项目，并且需要完全重新绘制才能移动）。

所以。从这里有什么想法吗？调整我的像素图代码以写入覆盖在视口上的新的大部分透明的小部件是更好的方法吗？

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T08:40:06.473

尽管这可能不是最好的方法，但过去我已经将自定义小部件添加到包含 QGraphicsView / QGraphicsScene 的窗口中，它们与场景中的 QGraphicObjects 具有相同的图形样式。当视图随后用于移动场景中的对象或场景本身时，窗口上的项目将保留在同一位置。
希望有帮助。

# regex - Notepad ++中特定长度搜索的通配符

> ID：16069806
> 
> 赞同：2
> 
> 时间：2013-04-17T20:36:30.450
> 
> 标签：regex, notepad++

我似乎找不到这个问题的答案。
我有一个小`.dat`文件。我想从那个文件中提取某些数据。如您所见，有一个 9 个字符长的字符串加上一个空格，然后是我想要找到的固定值字符串。一个特定的数据行是：

```
hEu 5RS67UCJ2 Fixed Value Ü  Ü 5UZZNKV0I Fixed Value Ü3  Ü3 3D910PZ9H Fixed Value Ú9.Ü")  Ú90Ü#- Ü") 5YWX8DMR2 Fixed Value Ü  Ü  54WI4OGWI Fixed Value Ü 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T20:55:21.313

如果你想匹配一个九字符的大写字母数字字符串，后跟“固定值”，那么下面的正则表达式应该可以解决问题：

```
([A-Z0-9]{9}) Fixed Value 
```

模式第一部分周围的括号形成一个捕获子组，因此您应该能够通过在您想要的位置使用`$1`或`\1`（取决于 Notepad++ 的工作方式）在“替换”值中引用这个捕获的部分要插入“替换”值的九个字符的字符串。

# ruby-on-rails - apache背后的瘦服务器，当我更新代码时停止工作

> ID：16069810
> 
> 赞同：0
> 
> 时间：2013-04-17T20:36:54.067
> 
> 标签：ruby-on-rails, apache, thin

我在瘦服务器上有一个 Rails 应用程序，作为通过 Apache 服务器代理的 Windows 服务。该应用程序正常工作，直到我尝试上传项目的新版本。然后我得到一个 502 bad gateway 错误。我尝试重新启动所有服务，但没有运气。看起来我也无法在本地端口 3000 上访问它。这是我的 apache httpd 摘录：

```
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_http_module modules/mod_proxy_http.so

<VirtualHost localhost:80>
       ServerName serverName
       DocumentRoot "C:/locationOfAppDir"
       ProxyPass / http://localhost:3000/
       ProxyPassReverse / http://localhost:3000/
       ProxyPreserveHost On
</VirtualHost>

<VirtualHost serverName>
       ServerName serverName
       DocumentRoot "C:/locationOfAppDir"
       ProxyPass / http://localhost:3000/
       ProxyPassReverse / http://localhost:3000/
       ProxyPreserveHost On
</VirtualHost> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T21:27:36.287

自我提示：当您使用新的 gem 添加更新的代码时运行 bundle install。

# asp.net - aspx.designer 没有找到我的控件

> ID：16069814
> 
> 赞同：0
> 
> 时间：2013-04-17T20:37:08.067
> 
> 标签：asp.net, visual-studio-2010

我的 aspx 页面的设计器文件有问题。每次我尝试定义脚本管理器、更新面板或任何类似的 asp 控件时...

```
<asp:ScriptManager ID="ScriptManager1" runat="server"> 
```

aspx.designer 文件出错，我得到“Type.Web.UI.ScriptManager”未定义，指向脚本管理器或任何其他控件。更新面板等。

我试过删除设计器文件无济于事。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:49:46.190

根据[ScriptManager MSDN 文档](http://msdn.microsoft.com/en-us/library/system.web.ui.scriptmanager.aspx)，它在`System.Web.Extensions`程序集中。

> **命名空间：** System.Web.UI
> **程序集：** System.Web.Extensions（在 System.Web.Extensions.dll 中）

也许您可能缺少`Web.config`文件中的程序集引用。
尝试创建一个全新的 Web 项目并比较您的`Web.config`文件。

检查你的`Web.config`文件`<pages> ==> <controls>`元素中是否有这个。

```
<pages>
    <controls>
        <add tagPrefix="asp"
             namespace="System.Web.UI"
             assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add tagPrefix="asp"
             namespace="System.Web.UI.WebControls"
             assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>

        <!-- other tag registrations -->
    </controls>
</pages> 
```

# python - 收到 Python 错误“来自：无法读取 /var/mail/Bio”

> ID：16069816
> 
> 赞同：104
> 
> 时间：2013-04-17T20:37:12.320
> 
> 标签：python

我正在运行一个（生物）python 脚本，导致以下错误：

```
from: can't read /var/mail/Bio 
```

看到我的脚本与邮件没有任何关系，我不明白为什么我的脚本在 /var/mail 中查找。

这里似乎有什么问题？我怀疑它会有所帮助，因为脚本似乎不是问题，但无论如何这是我的脚本：

```
from Bio import SeqIO
from Bio.SeqUtils import ProtParam

handle = open("examplefasta.fasta") 
for record in SeqIO.parse(handle, "fasta"): 
    seq = str(record.seq)
    X = ProtParam.ProteinAnalysis(seq)
    print X.count_amino_acids() 
    print X.get_amino_acids_percent() 
    print X.molecular_weight() 
    print X.aromaticity() 
    print X.instability_index() 
    print X.flexibility() 
    print X.isoelectric_point() 
    print X.secondary_structure_fraction() 
```

这里有什么问题？糟糕的python设置？我真的不认为这是剧本。

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2013-04-17T20:39:47.423

不，这不是脚本，而是你的脚本根本没有被 Python 执行。如果您的脚本存储在名为 的文件中`script.py`，则必须将其执行为`python script.py`，否则默认 shell 将执行它并在`from`关键字处退出。（顺便说一下，`from`是一个命令行实用程序的名称，它打印向给定用户名发送邮件的人的姓名，这就是它尝试访问邮箱的原因）。

另一种可能性是将以下行添加到脚本的顶部：

```
#!/usr/bin/env python 
```

这将指示您的 shell 通过执行脚本，`python`而不是尝试自行解释它。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2015-07-23T12:05:54.337

我遇到了类似的错误

“来自：无法读取 /var/mail/django.test.utils”

尝试运行命令时

```
>>> from django.test.utils import setup_test_environment
>>> setup_test_environment() 
```

在[https://docs.djangoproject.com/en/1.8/intro/tutorial05/的教程中](https://docs.djangoproject.com/en/1.8/intro/tutorial05/)

在阅读了 Tamás 的答案后，我意识到我不是在 python shell 中而是在终端中尝试这个命令（这可能发生在那些刚接触 linux 的人身上）

解决方案是首先使用命令 python 进入 python shell，当你得到这些 >>> 然后运行任何 python 命令

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-09-24T11:38:20.383

同样在这里。在 django 项目中从终端运行导入命令而没有通过 manage.py 激活 python3 shell 时出现此错误（是的，我还是个新手）。正如人们所预料的那样，激活 shell 可以正确解释命令。

```
./manage.py shell 
```

只有这样

```
>>> from django.contrib.sites.models import Site 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-07-11T06:56:56.273

把它放在你的 .py 文件的顶部（对于 python 2.x）

```
#!/usr/bin/env python 
```

或者对于 python 3.x

```
#!/usr/bin/env python3 
```

这应该查找 python 环境，没有它，它将执行代码，就好像它不是 python 代码一样，而是直接到 CLI。如果需要手动指定python环境放置的位置

```
#!/#path/#to/#python 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-04-08T12:29:59.120

我遇到了同样的错误，因为我试图继续运行

```
XXX-Macmini:Python-Project XXX.XXX$ from classDemo import MyClass

from: can't read /var/mail/classDemo 
```

为了解决这个问题，输入命令**python**，当你得到这些 >>> 然后运行任何 python 命令

```
>>>from classDemo import MyClass
>>>f = MyClass() 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-03-14T16:21:29.703

对于 Mac OS，只需转到应用程序并运行这些脚本 Install Certificates.command 和 Update Shell Profile.command，现在它就可以工作了。

# c# - 按 IEnumerable 分组 根本不起作用

> ID：16069818
> 
> 赞同：0
> 
> 时间：2013-04-17T20:37:19.010
> 
> 标签：c#, linq, grouping, iequalitycomparer

我不太确定，为什么分组`IEnumerable<string>`不起作用。当然，我提供自定义 IEqualityComparer。

```
public class StringCollectionEqualityComparer : EqualityComparer<IEnumerable<string>>
{
    public override bool Equals(IEnumerable<string> x, IEnumerable<string> y)
    {
        if (Object.Equals(x, y) == true)
            return true;
        if (x == null) return y == null;
        if (y == null) return x == null;

        return x.SequenceEqual(y, StringComparer.OrdinalIgnoreCase);
    }

    public override int GetHashCode(IEnumerable<string> obj)
    {
        return obj.OrderBy(value => value, StringComparer.OrdinalIgnoreCase).Aggregate(0, (hashCode, value) => value == null ? hashCode :  hashCode ^ value.GetHashCode() + 33);
    }
}

class A
{
    public IEnumerable<string> StringCollection { get; set; }
}

IEnumerable<A> collection = // collection of A

var grouping = collection.GroupBy(obj => a.StringCollection, StringCollectionEqualityComparer.Default).ToList(); 
```

（`ToList()`是强制评估，我有断点`StringCollectionEqualityComparer`，但不幸的是，**它们没有被调用**，正如预期的那样）

当我`collection`以这种*愚蠢*的方式分组时，它确实有效。

```
var grouping = collection.GroupBy(obj => String.Join("|", obj.StringCollection)); 
```

不幸的是，显然这不是我想要使用的东西。

通过不工作，我的意思是结果不是我期望的结果（使用愚蠢的方式，结果是正确的）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T20:40:17.617

`StringCollectionEqualityComparer.Default`是访问的有效替代方式`EqualityComparer<IEnumerable<string>>.Default`，因为后者是前者的基类。您需要创建 , 的实例`StringCollectionEqualityComparer`，只需使用`new StringCollectionEqualityComparer()`, 代替。

# php - preg_match、addslashes、mb_substr 不适用于长字符串

> ID：16069820
> 
> 赞同：1
> 
> 时间：2013-04-17T20:37:21.590
> 
> 标签：php, preg-match, multiline, addslashes

我正在解析一个 html 文件。我有一个大字符串，基本上是一个脚本。字符串看起来像这样：

> productId":"12666","chooseText":"选择选项...","taxConfig":{"includeTax":true,"showIncludeTax":true,"showBothPrices":false,"defaultTax":19.6,"currentTax ":19.6,"inclTaxTitle":"Incl. 税"}}); var colorarray = new Array();
> 
> ```
>  colorarray["c650"] = 'blush';
> 
>     Event.observe('attribute698', 'change', function() {
> 
>       var colorId = $('attribute698').value;
>       var attribute = 'attribute698';
>       var label = colorarray["c"+colorId];
> 
>       if ($('attribute698').value != '') {
>           setImages(attribute, colorId, label);
>         }
>     }); //        var currentColorLabel = 'blush'; //        var currentSku = '5010-4-n'; //        var currentPosition = 'v'; // // 
> ```
> 
> Event.observe(window, 'load', function() { //
> setImages('attribute698', null, currentColorLabel); // });

我需要从第一个“（”到第一个“;”中提取内容。我尝试进行字符串提取但失败了。我尝试过预匹配但失败了。请告诉我一些解决我的问题的方法。以下是我尝试过的解决方案和问题。

```
$strScript =  $tagscript->item(0)->nodeValue;
//this line returns empty string
$str_slashed = addslashes(trim($strScript) );   
$pattern = '/\((.*);/';
preg_match($pattern,$str_slashed,$matches);
echo 'matches'."<br />";
var_dump($matches);

//Add slashes works only if I use it before assignment to other string
$matches = array();
$strScript = addslashes ($tagscript->item(0)->nodeValue);//. "<br />";
$pattern = '/\((.*);/';
preg_match($pattern,$strScript,$matches);
echo 'matches'."<br />";
var_dump($matches);

//str extract method
$posBracket = stripos ($strScript,'(');
 echo $posBracket."<br />";
$posSemiColon = strpos ($strScript,';');
 echo $posSemiColon."<br />";
$temp = mb_substr ($strScript,$posBracket ,($posSemiColon-$posBracket));
echo $temp."<br />"; 
```

上面的代码适用于小字符串

```
$strScript = "manisha( [is goo girl] {come(will miss u) \and \"play} ; lets go home;"; 
```

但不适用于长字符串。我该如何解决这个问题？请帮助我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:41:47.697

您必须在正则表达式中添加多行开关。尝试`$pattern = '/\((.*);/s';`或`$pattern = '/\((.*);/m';`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:41:28.473

尝试使用`/\(([^;]*)/`作为您的模式。`[^;]`表示任何不是`;`.

编辑：也打开多行模式，如[rogers](https://stackoverflow.com/users/501894/rogers)建议的那样；因此整个模式应该看起来有点像 `/\(([^;]*)/s`。

编辑：你应该知道，这并不是真正的防错。比如说，您将获得`;`对象的某个属性，该对象的 JSON 表示包含在您的字符串中。

# foundation - ImportError：没有名为 Foundation 的模块（浅蓝色）

> ID：16069826
> 
> 赞同：1
> 
> 时间：2013-04-17T20:37:54.573
> 
> 标签：foundation, lightblue

我试图为 python 使用 lightblue 模块，我安装它没有问题，但是当我尝试导入它时，它给了我错误“ImportError：没有名为 Foundation 的模块”在 lightblue 中使用。我已经搜索了那个模块（Foundation），但我没有一个很好的答案去哪里得到它。

有什么建议吗？

PS：对不起我的英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-03T10:56:19.157

`export PYTHONPATH="/System/Library/Frameworks/Python.framework/Versions/2.7/Extras/lib/python/"`

如果它要求使用 Foundation 模块。还请检查您的蓝牙是否已打开，并且您已替换 setup.py 中的最后一行（编号 66），如下所示：

`os.system("xcodebuild install -arch 'x86_64' -target LightAquaBlue -configuration Release DSTROOT=/ INSTALL_PATH=/Library/Frameworks DEPLOYMENT_LOCATION=YES")`

最后但并非最不重要的一点是检查 _initblue.py（在 lightblue-0.4-master/src/mac 内）第 468 行 > 用这个 'signature="v@:@iZ"' 替换（在 goog 上仔细检查）

然后你运行：'sudo python setup.py install'

在多次失败后，我在 10.9 中尝试了所有这些，但它随后导入了模块并在我周围找到了蓝牙。祝你好运

# php - 表单复选框到 PHP 电子邮件 - 代码到目前为止不起作用

> ID：16069828
> 
> 赞同：0
> 
> 时间：2013-04-17T20:38:04.697
> 
> 标签：php, html, email

我有一个带有复选框的基本表单，提交时将通过电子邮件发送给管理员（并复制给客户）。我的代码仅回显最后一个复选框（因此仅在电子邮件上显示一个复选框） - 我无法让它发送电子邮件中的所有复选框信息（即使在此处尝试了多个版本的代码之后）。

```
<form method="POST" name="contactform" action="include/contactstationcode.php"> 
<h1>Quick Contact Form</h1> 
<p>
<section id="nameLabel" class="labelClass"><label id="Name">Full Name: </label><input name="name" id="name" size="30" class="inputField" type="text"><br></section>
<section id="nameLabel" class="labelClass"><label id="Student ID">Student ID: </label><input name="studentid" id="studentid" size="8" class="inputField" type="text"><br></section>
<section id="nameLabel" class="labelClass"><label id="Email">Email: </label><input name="email" id="email" size="30" class="inputField" type="text"><br></section>
<section id="nameLabel" class="labelClass"><label id="ContactNumber">Contact Number: </label><input name="contactnumber" id="contactnumber" size="30" class="inputField" type="text"><br></section>
<section id="nameLabel" class="labelClass"><label id="interests">Interests: <input type="checkbox" name="check_list[]" value="Presenting " checked> Presenting<br><input type="checkbox" name="check_list[]" value="Producing "> Producing<br><input type="checkbox" name="check_list[]" value="Audio Production ">Audio Production<br><input type="checkbox" name="check_list[]" value="Marketing "> Marketing<br><br><input type="checkbox" name="check_list[]" value="Web "> Web<br>
<section id="messageLabel" class="labelClass"><label>Relevant Experience:</label></section>
<section id="messageInput" class="inputClass"><textarea name="experience" id="experience" cols="30" rows="3"></textarea><br></section><br>
<section id="buttonClass" class="buttonClass"><input src="images/submit.png" onmouseover="this.src='images/submit2.png'" onmouseout="this.src='images/submit.png'" alt="submit" value="submit" height="25" type="image" width="70"></section>
</p>
</form> 
```

我拥有的 PHP 脚本是：

```
<?php date_default_timezone_set('Europe/London');
$from = 'From: company@company.com'; 
$today = date('l, F jS Y.'); 
$to = 'secret@secret.com'; 
//Form Fields
$name = $_POST['name'];
$studentid = $_POST['studentid'];
$email = $_POST['email'];
$contactnumber = $_POST['contactnumber'];
$experience = $_POST['experience'];
if(!empty($_POST['check_list'])) {
foreach($_POST['check_list'] as $check) {
        $check=$check.',';
}
}

//Admin Email Body
$subject = 'ClickTeesside.com Get Involved Request';
$bodyp1 = "You have received a Get Involved Request through the ClickTeesside website on $today \n\nFrom: $name ($studentid)\nEmail Address: $email\nContact Number: $contactnumber";
$bodyp2 = "\n\nInterests include: ".$check;
$bodyp3 = "\n\nPrevious Experience: $experience";
$bodyp4 = "\n\nIf suitable, please get in touch with this candidate as soon as possible - the candidate has also received an automated response.";
$body=$bodyp1.$bodyp2.$bodyp3.$bodyp4;
mail ($to, $subject, $body, $from);

//Candidate Email
$candidatesubject = 'ClickTeesside.com Get Involved: Automated Email';
$candidatefrom =  'From: ClickTeesside.com';
$cbody = "Thank you for emailing Click Radio about becoming involved with the station.\nWe've sent your details to our Station Management, who will review your application.\nIf successful, we will contact you in due course.\n\n";
$cbody2 = "Here is a copy of what you sent to us on $today:\n\nName: $name ($studentid)\nEmail Address: $email\nContact Number: $contactnumber\nSpecified Interested Areas: ".$check."\n\nPrevious Experience: $experience";
$candidatebody = $cbody.$cbody2;
mail ($email, $candidatesubject, $candidatebody, $from);

header("Location: http://www.google.co.uk/");
?> 
```

看不到我哪里出错了 - 所以如果你能指出我正确的方向:) 谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:51:40.050

问题在这里：

```
foreach($_POST['check_list'] as $check) {
    $check=$check.',';
} 
```

`$check`在循环的每次迭代中设置为当前项的值。在最后一个循环中，`$check`将设置为最后一项，然后您将追加`,`.

要解决此问题，请在循环中使用不同的变量名称：

```
$check = "";
foreach($_POST['check_list'] as $c) {
    $check .= $c.',';
} 
```

上面保留了更多的代码并更好地说明了问题，但是做到这一点的方法是使用`implode`函数。

```
$check = implode(",", $_POST['check_list']); 
```

这将为您提供没有尾随逗号的相同字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:45:10.710

编辑这个：

```
if(!empty($_POST['check_list'])) {
foreach($_POST['check_list'] as $check) {
    $check=$check.',';
}
} 
```

有了这个：

```
$allChecks = '';
if(!empty($_POST['check_list'])) {
foreach($_POST['check_list'] as $check) {
    $allChecks .= $check.',';
}
} 
```

然后通过邮件发送 $allChecks：

```
$bodyp2 = "\n\nInterests include: ".$allChecks; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:51:54.350

您在 foreach 中所做的是每次都替换该值。使用 .= 将下一个值添加到您的字符串中。

其他一些调整是检查 PHP 和客户端中是否存在所有字段。如果我编写纯 PHP，我倾向于使用相同的文件，所以 if(isset($_POST)): 所以表单动作是在引用自己。

祝你好运。

# ruby-on-rails - RoR - 在开发模式下不加载或请求任何资产

> ID：16069829
> 
> 赞同：1
> 
> 时间：2013-04-17T20:38:13.137
> 
> 标签：ruby-on-rails, ruby, configuration

我是 Rails 开发的新手，而且有点乱！**我已经获得了一个代码库，并且 HTML 中没有引用任何资产。没有失败的网络请求，它们根本没有包含在标记中！当我尝试使用他们的 URL 直接访问它们时，它们就在那里。**

作为比较 - 我的同事系统最终会收到大约 30 个左右的请求，并且最终结果是完全样式化的。但是我没有样式，只有基本标记。

我已经阅读了大量内容并检查了我的配置，检查了我是否在开发模式下运行等等。我真的很难过！

值得一提的是，我目前在一个跨平台的团队环境中工作，那里有使用 Linux、Windows 和 Mac OS X 的开发人员。没有人有这些问题；而且我很确定其他使用 Mac OS X 的开发人员的设置与我的完全相同！

源代码是从与其他人相同的 git 存储库中获取的，并且绝对是最新的。下面是 rails 的输出：注意没有错误。

```
=> Booting WEBrick
=> Rails 3.2.6 application starting in development on http://0.0.0.0:3000
=> Call with -d to detach
=> Ctrl-C to shutdown server
        SECURITY WARNING: No secret option provided to Rack::Session::Cookie.
        This poses a security threat. It is strongly recommended that you
        provide a secret to prevent exploits that may be possible from crafted
        cookies. This will not be supported in future versions of Rack, and
        future versions will even invalidate your existing user cookies.

    Called from: /******************/abstract_store.rb:28:in `initialize'.
[2013-04-17 21:20:55] INFO  WEBrick 1.3.1
[2013-04-17 21:20:55] INFO  ruby 2.0.0 (2013-02-24) [x86_64-darwin12.3.0]
[2013-04-17 21:20:55] INFO  WEBrick::HTTPServer#start: pid=22421 port=3000

Started GET "/" for 127.0.0.1 at 2013-04-17 21:21:05 +0100
Processing by AccountsController#home as HTML
Completed 401 Unauthorized in 6ms

Started GET "/users/sign_in" for 127.0.0.1 at 2013-04-17 21:21:05 +0100
Processing by Devise::SessionsController#new as HTML
  Rendered devise/shared/_links.erb (1.5ms)
  Rendered devise/sessions/new.html.erb within layouts/application (10.0ms)
  Rendered layouts/_navigation.html.erb (1.0ms)
  Rendered layouts/_messages.html.erb (0.3ms)
Completed 200 OK in 776ms (Views: 86.5ms | ActiveRecord: 647.5ms)

Started GET "/assets/application.js?body=1" for 127.0.0.1 at 2013-04-17 21:21:06 +0100
Served asset /application.js - 304 Not Modified (1ms)

Started GET "/assets/application.css?body=1" for 127.0.0.1 at 2013-04-17 21:21:06 +0100
Served asset /application.css - 304 Not Modified (1ms) 
```

![网络请求截图](https://i.stack.imgur.com/gquNo.png)

**注意：application.js 似乎只有 5 个`//=require`指令；并且 application.css 主要包含一些简单规则的注释 - 远不及应该存在的内容。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-20T03:21:15.763

我的解决方案是：安装 ruby​​ 版本 1.9.3 并将此版本设置为默认值。重启你的电脑。然后安装rails 3.2.6。然后为您的源代码克隆一个新的存储库（不要重复使用有错误的存储库）。运行捆绑安装。

在此之前，我也尝试使用 rvm 安装 ruby​​ 1.9.2 但它不起作用。然后我尝试使用 ruby​​ 1.9.3 并且它有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T21:27:14.340

我在之前的项目中遇到过类似的问题。我个人会尝试everett1992所说的，因为如果这样可以解决问题，那可能是最好的。但是当它不起作用时我使用的是这条线

```
config.assets.prefix = "/assets_dev" 
```

到我的 development.rb 文件。

现在，assets_dev 不是一个真正的目录，我从未创建过它。但是它迫使 Rails 看那里，然后当它看不到它时，rails 将从默认位置加载您的资产，就像在 rails 中应该发生的那样。

就像我说的，它可能会起作用，但我确信它不是最好的方法。我也在 OS X 上与其他人一起在跨平台项目上工作，我还没有弄清楚为什么有时会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-19T10:33:27.477

我正在使用 mac os x 10.6.8，我遇到了同样的问题，并尝试了上述所有解决方案。没有任何工作。包括： 1> 更新 gem 2> 移除 rvm，重新安装 rvm、ruby、rails... 3> 配置为 config(dot)assets(dot)prefix = "/assets_dev"

顺便说一句，我检查了 GoogleChrome 控制台，发现在 application(dot)css 中，仍然有如下语句：require_self require_tree。

这意味着这些参考根本不起作用。

同样的事情也发生在 application(dot)js

P/S：我正在使用 rails 3.2.6

# mod-rewrite - RewriteCond %{REQUEST_URI} 不起作用

> ID：16069831
> 
> 赞同：1
> 
> 时间：2013-04-17T20:38:22.070
> 
> 标签：mod-rewrite, url-rewriting, rewrite

我正在尝试使用以下规则将所有作为[http://portal.company.com/legacy](http://portal.company.com/legacy)进入 Web 服务器的请求重定向到[http://portal.company.com/wps/portal/public/legacy/legacyportlet](http://portal.company.com/wps/portal/public/legacy/legacyportlet) ，但它没有按预期工作。

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^portal\.company\.com$ [NC]
RewriteCond %{REQUEST_URI} ^/legacy$ [NC]
RewriteRule ^(.*)$ /wps/portal/public/legacy/legacyportlet$1 [NC,L,PT] 
```

我也试过

```
RewriteCond %{HTTP_HOST} ^portal\.company\.com$ [NC]
RewriteRule ^/legacy /wps/portal/public/legacy/legacyportlet [NC,L,PT] 
```

任何帮助将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:40:24.533

使用此规则：

```
RewriteCond %{HTTP_HOST} ^portal\.company\.com$ [NC]
RewriteRule ^legacy/?$ /wps/portal/public/legacy/legacyportlet [NC,L] 
```

**请记住**，在 .htaccess 中，RewriteRule 与 URI 的前导斜杠不匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T21:01:31.790

看起来您的源或目标 URL 没有任何变化，因此您最好使用 Apache 的基本[重定向指令](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#redirect)，它只是将一个 URL 重定向到另一个。

# php - PHP get names of multiple uploaded files

> ID：16069837
> 
> 赞同：2
> 
> 时间：2013-04-17T20:38:41.797
> 
> 标签：php, arrays, string, forms, file-upload

Hi im trying to create a script to upload multiple files. everythings works so far and all files are being uploaded.

My problem now is that i need to grap each file name of the uploaded files, so i can insert them in to a datebase.

Here is my html:

```
<form action="" method="post" enctype="multipart/form-data">

  <input type="file" name="image[]" multiple />
  <input type="submit" value="upload" /> 
```

And here is the php:

```
if (!empty($_FILES['image'])) { 
    $files = $_FILES['image'];

    for($x = 0; $x < count($files['name']); $x++) {
        $name       = $files['name'][$x];
        $tmp_name   = $files['tmp_name'][$x]; 
        $size       = $files['size'][$x]; 

        if (move_uploaded_file($tmp_name, "../folder/" .$name)) {
            echo $name, ' <progress id="bar" value="100" max="100"> </progress> done <br />';
        }
    }
} 
```

Really hope someone can help me with this. /JL

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:46:10.553

You have your indexes backwards. `$_FILES` is an array, with an element for each uploaded file. Each of these elements is an associative array with the info for that file. So `count($files['name'])` should be `count($files)`, and `$files['name'][$x]` should be `$files[$x]['name']` (and similarly for the other attributes. You can also use a `foreach` loop:

```
foreach ($_FILES as $file) {
  $name       = basename($file['name']);
  $tmp_name   = $file['tmp_name'];
  $size       = $file['size'];

  if (move_uploaded_file($tmp_name, "../folder/" .$name)) {
      echo $name, ' <progress id="bar" value="100" max="100"> </progress> done <br />';
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:54:02.513

I think the [`glob()`](http://php.net/manual/en/function.glob.php) function can help:

```
<?php
    foreach(glob("*.jpg") as $picture)
    {
        echo $picture.'<br />';
    }
?> 
```

demo result:

```
pic1.jpg
pic2.jpg
pic3.jpg
pic4.jpg
... 
```

be sure to change the file path and extension(s) where necessary.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T07:26:08.950

Thanks for the help, i got it to work by simply creating variables:

```
$image_1 = (print_r($files['name'][0], true)); 
$image_2 = (print_r($files['name'][1], true)); 
$image_3 = (print_r($files['name'][2], true)); 
```

# python - 从闭包表 SELECT 语句中渲染树？

> ID：16069840
> 
> 赞同：6
> 
> 时间：2013-04-17T20:38:55.980
> 
> 标签：python, sql, tree, hierarchical-data, transitive-closure-table

[[上一个问题]](https://stackoverflow.com/q/16065016/374470)

我正在尝试向应用程序添加类似 reddit 的评论，我决定使用闭包表模式来组织数据库。我的应用程序数据库看起来有点像这样：

### 帖子

```
+----+-------+
| id | title |
+----+-------+
|  1 | Hello |
+----+-------+ 
```

### 评论

```
+----+-----------+---------+------+
| id | parent_id | post_id | text |
+----+-----------+---------+------+
|  1 |      NULL |       1 | ...  |
|  2 |         1 |       1 | ...  |
|  3 |         2 |       1 | ...  |
|  4 |         3 |       1 | ...  |
|  5 |         3 |       1 | ...  |
|  6 |         5 |       1 | ...  |
|  7 |      NULL |       1 | ...  |
|  8 |         7 |       1 | ...  |
|  9 |         4 |       1 | ...  |
+----+-----------+---------+------+ 
```

### 评论路径

```
+-----------+----------+-------+
| parent_id | child_id | depth |
+-----------+----------+-------+
|         1 |        1 |     0 |
|         2 |        2 |     0 |
|         1 |        2 |     1 |
|         3 |        3 |     0 |
|         2 |        3 |     1 |
|         1 |        3 |     2 |
|         4 |        4 |     0 |
|         3 |        4 |     1 |
|         2 |        4 |     2 |
|         1 |        4 |     3 |
          [...snip...] 
```

现在，我正在运行这个查询：

```
SELECT c.*, p.*
FROM comments AS c
JOIN comment_paths AS p
    ON c.id = p.child_id
WHERE p.parent_id IN
    (SELECT c2.id FROM comments AS c2 WHERE c2.parent_id IS NULL AND c2.post_id = 1) 
```

获取基于他们的评论列表`post_id`。返回的数据是：

```
+------+-------------+-----------+--------+-------------+------------+---------+
| c.id | c.parent_id | c.post_id | c.text | p.parent_id | p.child_id | p.depth |
+------+-------------+-----------+--------+-------------+------------+---------+
|    1 |        NULL |         1 | ...    |           1 |          1 |       0 |
|    2 |           1 |         1 | ...    |           1 |          2 |       1 |
|    3 |           2 |         1 | ...    |           1 |          3 |       2 |
|    4 |           3 |         1 | ...    |           1 |          4 |       3 |
|    5 |           3 |         1 | ...    |           1 |          5 |       3 |
|    6 |           5 |         1 | ...    |           1 |          6 |       4 |
|    9 |           4 |         1 | ...    |           1 |          9 |       4 |
|    7 |        NULL |         1 | ...    |           7 |          7 |       0 |
|    8 |           7 |         1 | ...    |           7 |          8 |       1 |
+------+-------------+-----------+--------+-------------+------------+---------+ 
```

这代表树：

```
[1]
 |[2]
 | |[3]
 |   |[4]
 |   | |[9]
 |  [5]
 |   |[6]
[7]
 |[8] 
```

但是，我正在努力将返回的数据转换为 Python 树结构。本质上，我的目标是[这个问题](https://stackoverflow.com/questions/2794638/turn-database-result-into-array)和[这个关于](https://stackoverflow.com/questions/12986914/how-can-i-display-tree-structure-in-html-from-closure-table)最终输出 (HTML) 的问题，但我真的不想求助于递归 SQL 语句，因为我已经有了这些信息。我认为某种递归是必要的，因为我希望最终得到与此类似的结构：

```
[
  {
    'id': 1,
    ...
    'children': [
                  {
                    'id': 2,
                    ...
                    'children': [ ... ]
                  }
                ]
  },
  {
    'id': 7,
    ...
    'children': [
                {
                  'id': 8,
                  ...
                }
              ]
  }
] 
```

基本上是一个嵌套的字典列表，所以我可以使用[Jinja 的递归循环遍历](https://stackoverflow.com/a/6987333/374470)它们。有人有想法吗？

谢谢！

* * *

## 编辑 2013-04-17

乱七八糟，我有一个“工作”的解决方案，虽然它做了很多迭代，所以我不想把它标记为这个问题的答案。我使用的解决方案是：

```
comment_set = ... # previous query to grab data set

def create_tree(parent):
    parent['children'] = []
    for record in comment_set:
        if record['parent_id'] == parent['id']:
            parent['children'].append(create_tree(record))
    return parent

comment_tree = []
for record in comment_set:
    if record['parent_id'] is None: # if this is the start of a tree
        comment_tree.append(create_tree(record)) 
```

`comment_set`这并不理想，因为它会在每次调用时迭代`create_tree()`，即集合中的每条记录。然而，这是我目前拥有的最好的。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T01:16:44.450

你不需要递归，你只需要能够通过引用来处理节点对象。

这是一个在线性时间内创建嵌套数据结构的代码示例。将其视为伪代码，因为我尚未对此进行测试，而且我还不精通 python。

我使用两个 for 循环的原因是，否则我们必须假设树顶部的节点在树深处的节点之前被处理。对于如下所示的两个循环，不需要这样的假设。

```
for record in comment_set:
    nodes[record['id']] = record
for record in comment_set:
    if record['parent_id'] in nodes:
        nodes[record['parent_id']]['children'].append(record)
    else
        top = record;
return top 
```

在该循环结束时：

*   `nodes`将是层次结构中所有节点的一维字典。
*   每个节点都有一个自己的直接子节点列表。
*   `top`应该是唯一没有父节点的节点（即根节点）。

这类似于我在过去的 SO 帖子中发布的示例，[将数据库结果转换为数组](https://stackoverflow.com/questions/2794638/turn-database-result-into-array/2799135#2799135)：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-27T14:08:00.160

你可以做一些小的改变来帮助你改进你的代码::

```
comment_set = ... order by parent_id asc

def create_tree(parent, list):
    parent['children'] = []
    for record in comment_set:
        if record['parent_id'] == parent['id']:
            parent['children'].append(create_tree(record, list[1:]))
    return parent

comment_tree = []
for record in comment_set:
    if record['parent_id'] is None: # if this is the start of a tree
        comment_tree.append(create_tree(record, comment_set)) 
```

# c# - 通过节点从外部 Web 服务解析中捕获 xml

> ID：16069844
> 
> 赞同：0
> 
> 时间：2013-04-17T20:39:08.540
> 
> 标签：c#, .net, xml, web-services

我有一个 ac# web 应用程序，它有一个简单的任务：使用一个外部 web 服务，并循环通过它返回的 xml。

我正在使用这样的网络服务：

```
 WSExternal.SoapHeaderCredentials objHeaderCredentials = new WSExternal.SoapHeaderCredentials();
        objHeaderCredentials.UserName = "username";
        objHeaderCredentials.Password = "password";
        WSExternal.MembershipAuthenticationService objClient = new WSExternal.MembershipAuthenticationService();
        objClient.SoapHeaderCredentialsValue = objHeaderCredentials; 
```

我可以像这样调用单个暴露的 Web 方法：

```
objClient.GetMembershipUserList(false); 
```

如果我通过 SoapUI 或 XMLSpy 之类的客户端访问 Web 服务，它会返回如下 xml：

```
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">

  <soap:Body>
      <GetMembershipUserListResponse xmlns="http://namespaceofwebservice">
         <GetMembershipUserListResult>
            <UserList>
               <MembershipUserData>
                  <id>1</id>
                  <UserName>userone</UserName>
                  <PrimaryFirstName>User</PrimaryFirstName>
                  <PrimaryLastName>One</PrimaryLastName>
                  <Address>13 MAIN STREET</Address>
                  <City>ROCHESTER</City>
               </MembershipUserData>
               <MembershipUserData>
                  <id>2</id>
                  <UserName>usertwo</UserName>
                  <PrimaryFirstName>User</PrimaryFirstName>
                  <PrimaryLastName>Two</PrimaryLastName>
                  <Address>15 WEST AVE</Address>
                  <City>JERSEY CITY</City>
               </MembershipUserData>
            </UserList>
            <Page>0</Page>
         </GetMembershipUserListResult>
      </GetMembershipUserListResponse>
   </soap:Body> 
```

我的问题是，我如何从 web 方法中“捕获”这个 xml，并循环通过它以从节点中获取相关数据？

# python - 如何在 PyWin32 中访问 SAP2000 的 OpenAPI

> ID：16069845
> 
> 赞同：1
> 
> 时间：2013-04-17T20:39:13.697
> 
> 标签：python, vba, pywin32

`pywin32com.clients.Dispatch()`Python Win32 扩展可以使用函数调用与 Microsoft Office 应用程序（例如 Word 和 Excel）一起使用。使用 VBA 可以类似地访问其他应用程序。SAP2000（Computers and Structures Inc.）就是这样一种软件，它提供了所谓的 OpenAPI。

**如何在 Python Win32 扩展中访问 SAP2000 的 OpenAPI？**

从 Excel 中打开 SAP2000 的典型 VBA 函数如下：

```
Dim SapObject As Sap2000.SapObject    
Dim ret As Long

Sub SAP2000_open()
    Set SapObject = New Sap2000.SapObject
    SapObject.ApplicationStart
    SapObject.SapModel.InitializeNewModel (lb_ft_F)
    ret = SapObject.SapModel.File.NewBlank
End Sub 
```

通过将其附加到按钮单击事件来运行上述子例程时，将打开 SAP2000。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-06-28T15:26:20.343

请参阅 CSI OAPI 文档。

1.  下载并安装适用于 Windows 的 Python 3.0 或更高版本。Python 在 python.org 上免费提供。

2.  下载并安装“Python for Windows extensions”。它可从 sourceforge.net 免费获得。

3.  使用 PythonWin IDE 或任何文本编辑器创建 Python .py 文件并粘贴以下代码：......

# php - 使用他们的纬度/经度/城市获取用户在 php 中的当前时间

> ID：16069846
> 
> 赞同：1
> 
> 时间：2013-04-17T20:39:16.983
> 
> 标签：php, geolocation, timezone, timezone-offset

我正在使用[http://ipinfodb.com/](http://ipinfodb.com/) api 来获取用户纬度/经度... [我有](http://goawaymom.com/test.php)用户时区，格式为数组。该数组返回以下信息...

```
array(11) { 
     ["statusCode"]=> string(2) "OK"... 
     ["countryCode"]=> string(2) "CA" 
     ["countryName"]=> string(6) "CANADA" 
     ["regionName"]=> string(16) "BRITISH COLUMBIA" 
     ["cityName"]=> string(8) "VANCOUVER" ....
     ["timeZone"]=> string(6) "-07:00" 
} 
```

使用来自数组的信息，当我的时区格式为 -07:00、04:00 等时，我将如何找到用户的当前时间

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T21:25:39.893

“时区”不是偏移量！这么多 API 犯了这个常见的错误，这让我很困扰。不要被返回字段称为“timeZone”的事实所迷惑。

“时区”是全年可以有一个或多个偏移量的区域。您可以解决时区和日期的偏移量，但不能反其道而行之！ [TZDB 时区列表在这里](http://en.wikipedia.org/wiki/List_of_tz_database_time_zones)。

具体时区将是`America/Vancouver`- 不是因为您的纬度/经度与温哥华市匹配，而是因为温哥华恰好是您所在时区的参考城市。并非每个城市都有自己的时区 ID，因此您不能做出任何假设。

-07:00 是时区的*当前*偏移量`America/Vancouver`。它恰好是夏令时偏移量。当夏令时结束时，它将变为`-08:00`. 您正在使用的特定网络服务似乎不会显示此信息。

StackOverflow 上还有其他几个问题已经回答了如何从纬度/经度解析实际时区。您可以调用 Web 服务，也可以使用自己的数据库。以下是一些链接：

*   [从纬度经度查找时区](https://stackoverflow.com/q/41504/634824)
*   [将位置映射到时区](https://stackoverflow.com/q/3867450/634824)
*   [Ruby - 按时区对 MongoDB 记录进行排序？](https://stackoverflow.com/q/15867990/634824)
*   [时区查询](https://stackoverflow.com/q/2357030/634824)
*   [经度，纬度到时区](https://stackoverflow.com/q/4989404/634824)

我敢肯定还有更多。我很想把它作为一个副本关闭，但我之前没有看到 ipinfodb.com 被引用过。

如果您确定您的 API 返回*当前*偏移量，并且您只想要用户的*当前*时间，那么正如 Jonathon 在问题评论中指出的那样，您只需将偏移量应用于当前 UTC 时间，您就会知道时间在那个位置。但是你每次都必须这样做。您无法保存该偏移量并稍后再次使用它。为此，您需要完整的时区参考。

# objective-c - NSString 字节硬编码

> ID：16069847
> 
> 赞同：0
> 
> 时间：2013-04-17T20:39:17.050
> 
> 标签：objective-c

我有一个小资产，想嵌入字节。我获取了资产，打印出字节，然后将字节放入字节数组并将这些字节加载到字符串中。看起来像一个字节序问题。我在这里做错了什么？

字节打印机.app

```
 const char *helloworldc = "Hello, World!";
 NSString *helloworld = [NSString stringWithUTF8String:helloworldc];
 NSData *data = [helloworld dataUsingEncoding:NSUTF8StringEncoding];
 NSLog(@"%@", [data description]); 
```

输出：

```
<48656c6c 6f2c2057 6f726c64 21> 
```

ByteImporter.App

```
 const uint32_t bytes[] = {0x48656c6c, 0x6f2c2057, 0x6f726c64, 0x21};
  NSString *helloworld = [[NSString alloc] initWithBytes:bytes
                                                  length:sizeof(bytes)
                                                encoding:NSUTF8StringEncoding];
  NSLog(@"%@", helloworld); 
```

输出：

```
lleHW ,odlro! 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:57:20.303

跳过 NSString 步骤。像这样的问题可能会不断出现，因为您正在与框架对抗 NSString 的使用方式。NSStrings 用于人类可读的文本，而 NSData 用于字节序列。如果您想要一个保持逐字节准确性的任意字节列表，只需使用字节数组和 NSData ——这就是它们的用途。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:54:01.793

`[data descriptions]`返回按 4 个字节分组的每字节输出。

如果您想对字符串进行硬编码，请使用以下代码：

```
const unsigned char bytes[] = {0x48, 0x65, 0x6c, 0x6c, 0x6f, 0x2c, 0x20, 0x57, 0x6f, 0x72, 0x6c, 0x64, 0x21};
NSString *helloworld2 = [[NSString alloc] initWithBytes:bytes
                                                length:sizeof(bytes)
                                              encoding:NSUTF8StringEncoding];
NSLog(@"%@", helloworld2); 
```

我的代码返回正确的字符串

如果你想优化某些东西（问题：什么？）你必须关心字节序并`uint32_t`相应地更正你的数组

**更新：** 有一个代码可以通过您的 NSData 生成所需的硬编码数组：

```
const char *helloworldc = "Hello, World!";
NSString *helloworld = [NSString stringWithUTF8String:helloworldc];
NSData *data = [helloworld dataUsingEncoding:NSUTF8StringEncoding];

NSMutableString *outStr = [[NSMutableString alloc] init];

unsigned char *ubytes = (unsigned char*)[data bytes];

for (int i = 0; i < [data length]; i++) {
    [outStr appendFormat: @"0x%02x, ", ubytes[i]];
}

NSLog(@"%@", outStr); 
```

在输出时你会得到这样的字符串: `0x48, 0x65, 0x6c, 0x6c, 0x6f, 0x2c, 0x20, 0x57, 0x6f, 0x72, 0x6c, 0x64, 0x21,`，所以你必须在它周围添加括号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:42:43.200

看起来确实像字节顺序问题。`char`我会使用or的数组`unichar`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T20:45:11.890

这实际上不是经典的字节序问题，这是因为数据是使用“正常”、人类可读的输出打印的（无论如何，它也与字节序有关）。

# css - 响应式网页设计和高分辨率显示器 (iPhone 4/5)

> ID：16069856
> 
> 赞同：14
> 
> 时间：2013-04-17T20:39:43.637
> 
> 标签：css, mobile, responsive-design

我最近开始玩弄响应式网页设计，并在这里做了一个基本的测试：

[http://test.studev.net/](http://test.studev.net/)

它在桌面浏览器中运行良好，但是当加载到高分辨率设备（例如 iPhone 上的视网膜显示器）时，我对如何处理最小宽度设计有点困惑。由于这种类型的显示，这意味着例如在桌面上正常读取的 16 像素大小在 iPhone 4/5 上是不可能读取的。

这通常是如何处理的？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-17T20:58:51.570

好吧，如果您想在移动设备上使文本变小或变大，您会这样做

```
@media screen and (max-width: 480px) {
    font-size: 10px; /* Smaller */
} 
```

或者

```
@media screen and (max-width: 480px) {
    font-size: 20px; /*Larger*/
} 
```

并确保你的`<HEAD>`标签中有这个：

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

或者您也可以像这样禁用缩放：

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
```

对于 IE10 支持，请尝试：

```
@-ms-viewport{
    width:device-width
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-17T20:44:48.980

您可以根据屏幕宽度选择字体大小：

```
 /* Large desktop */
    @media (min-width: 1200px) {
        font-size: 18px;
    }

    /* Portrait tablet to landscape and desktop */
    @media (min-width: 768px) and (max-width: 979px) {
        font-size: 16px;
    }

    /* Landscape phone to portrait tablet */
    @media (max-width: 767px) {
        font-size: 14px;
    }

    /* Landscape phones and down */
    @media (max-width: 480px) {
        font-size: 12px;
    } 
```

要确保您的布局在移动屏幕上伸展，您必须使用视口元标记：

```
<meta name="viewport" content="width=device-width, initial-scale=1" /> 
```

此元标记需要在头标记内。“设备宽度”将是您的屏幕可以显示的最大像素。您还可以在那里设置一个常量值（600px）。

initial-scale=1 表示它会自动缩放到 100%。(0.5 => 50%)

# sql - 在组外使用 SQL 聚合函数

> ID：16069859
> 
> 赞同：1
> 
> 时间：2013-04-17T20:40:01.397
> 
> 标签：sql, tsql, aggregate

我有一张桌子，称之为 TEST，就像这样：

```
+----+--------+
| id | PRCNTG |
+----+--------+
|  1 | 10     | 
|  2 | 20     | 
|  2 | 30     | 
|  3 | 40     | 
|  4 | 50     | 
|  5 | 20     | 
|  5 | 10     | 
|  6 | 20     | 
+----+--------+ 
```

在这种情况下，该`PRCNTG`列总计 200。它不会总是如此。

如果我执行此查询：

```
SELECT ID, SUM(PRCNTG) FROM TEST GROUP BY ID; 
```

我希望得到以下结果：

```
+----+--------+
| id | PRCNTG |
+----+--------+
|  1 | 10     | 
|  2 | 50     | 
|  3 | 40     | 
|  4 | 50     | 
|  5 | 30     | 
|  6 | 20     | 
+----+--------+ 
```

但是，我实际上想`PRCNTG`从总数中获取列的百分比。换句话说，我想做这样的事情。

```
SELECT ID, 100 * (SUM(PRCNTG)/TOTAL(PRCNTG)) FROM TEST GROUP BY ID; 
```

`TOTAL()`忽略分组的一些理论函数在哪里。所以在这种情况下，它应该总是返回 200。理论上，这将导致如下输出：

```
+----+--------+
| id | PRCNTG |
+----+--------+
|  1 |  5     | 
|  2 | 25     | 
|  3 | 20     | 
|  4 | 25     | 
|  5 | 15     | 
|  6 | 10     | 
+----+--------+ 
```

基本上，我要问的是，是否有办法使用聚合函数并告诉它忽略分组？

简单的解决方法是在不分组的情况下运行相同的查询，只是将`SUM()`放入一个变量中，然后使用该变量代替`TOTAL(PRCNTG)`，但我希望有一种更优雅的方法来做到这一点。

```
SELECT @TOTAL = SUM(PRCNTG) FROM TEST;
SELECT ID, 100 * (SUM(PRCNTG)/@TOTAL) FROM TEST GROUP BY ID; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T20:46:49.403

你想要一个窗口函数。试试这个：

```
SELECT ID, 100 * (SUM(PRCNTG)/sum(sum(PRCNTG)) over ())
FROM TEST
GROUP BY ID; 
```

如果要存储`PRCNTG`为整数，则需要将其转换为某种定点或浮点格式：

```
SELECT ID, 100 * (SUM(cast(PRCNTG as float))/sum(sum(PRCNTG)) over ())
FROM TEST
GROUP BY ID; 
```

# ios - 将 NSString 从空间剪切到末尾

> ID：16069861
> 
> 赞同：0
> 
> 时间：2013-04-17T20:40:13.070
> 
> 标签：ios, objective-c, nsstring, cut

我有 NSString：

> sessid=os3vainreuru2hank3；__ubic1=MzcxMzjMDYuNjk0NDA1Mzc%3D; 自动登录=123；sid=kep8efpo7；最后一个用户=123；

我需要得到：

> __ubic1=MzcxMzjMDYuNjk0NDA1Mzc%3D; 自动登录=123；interpals_sessid=kep8efpo7；最后一个用户=123；

但是经过 sessid 的字符数可能会有所不同

谢谢！对不起简单的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:53:27.213

这应该可以解决问题。-

```
NSRange range = [yourString rangeOfString:@" "];
if (NSNotFound != range.location) {
    yourString = [yourString substringFromIndex:(range.location + 1)];
} 
```

基本上，您获得第一个`space`字符的索引，然后是从该索引到末尾的子字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T20:50:21.240

您至少需要一个可以搜索的字符。看起来双下划线会起作用。

```
NSRange stringStart = [originalString rangeOfString:@"__"];
NSString *extractedString = [originalString substringWithRange:NSMakeRange(stringStart.location, originalString.length - stringStart.location)]; 
```

那应该可以满足您的需求！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T21:13:12.923

```
NSMutableArray* array = [[originalString componentsSeperatedByString:@";"] mutableCopy];
[array removeObjectAtIndex:0];
NSString* newString = [array componentsJoinedByString:@";"]; 
```

我假设你用 sid 打错 interpals_sessid

# wordpress-theming - 没有“current_page_item”类被添加到顶级导航项

> ID：16069864
> 
> 赞同：0
> 
> 时间：2013-04-17T20:40:39.563
> 
> 标签：wordpress-theming, wordpress

如果您访问[www.lindysez.com](http://www.lindysez.com "林迪塞兹")并单击顶级导航链接，您会注意到位置存在由稍暗的背景指示（与悬停状态相同）。这适用于除“提示和技术”之外的每个链接。

如果我深入了解，我注意到“current_page_item”类没有被添加到父类中

*   [访问http://www.lindysez.com/tips](http://www.lindysez.com/tips)时的“提示和技巧”菜单项

    此外，奇怪的是，当在提示页面上时，父母

    *   “Blog”导航项的“current_page_parent”类获得了既不期望也不期望的类。从 UI 的角度来看，这是无害的，但可能表明潜在的问题可能是什么。

    任何人都知道为什么“提示和技术”菜单项一旦选择就没有获得“current_page_item”类？

    * * *

    ## 更新：指导@user2019515 的评论如下

    感谢您朝这个方向轻推，看来我可以创建一个解决此问题的解决方法。然而，夫妇的事情。

    1.  这处理问题的症状而不是根源。我想弄清楚如何让 wp 直接添加“current_page_item”类。知道是什么原因造成的吗？我认为这也可能与我遇到的另一个问题有关，该问题涉及未在 RSS 提要中显示的“提示”。我发布了另一个问题，但没有看到任何答案...... [https://stackoverflow.com/questions/15980846/custom-post-type-not-showing-up-in-wordpress-rss-feed](https://stackoverflow.com/questions/15980846/custom-post-type-not-showing-up-in-wordpress-rss-feed)

    2.  即使作为一种解决方法，我宁愿尝试避免依赖硬编码的“菜单项-##”的解决方案。我的开发和生产服务器都有不同的 ID#。我知道我可以解释这一点，但我希望有更好的、可扩展的解决方法。

    3.  您提供的代码对我不起作用，不是我可以从中找到任何错误，也没有任何错误。似乎它应该工作，但只是没有。我什至尝试创建一个非常简单的版本，为所有项目添加一个类，但这也没有执行。这是那个代码。

        ```
        function add_class_to_wp_nav_menu($classes, $item)
        {
            $classes[] = 'classy-class';
            return $classes;
        }
        add_filter('nav_menu_css_class', 'add_class_to_wp_nav_menu', 10, 2); 
        ```

    非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:01:36.430

提示页面是一个帖子存档页面，它显示帖子而不是普通页面，这就是博客被突出显示的原因。您可以通过将以下自定义 CSS 添加到`style.css`文件中轻松解决此问题。

```
.post-type-archive-tips .menu-item-23{
    background:url(images/nav-hover.png) repeat-x;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T15:08:02.783

您需要遍历菜单，默认情况下，当前页面类被添加到博客页面，因为最后是自定义帖子。

```
//Change current_page_parent for custom post type
function remove_parent_classes($class)
{
  // check for current page classes, return false if they exist.
  return ($class == 'current_page_item' || $class == 'current_page_parent' || $class == 'current_page_ancestor'  || $class == 'current-menu-item') ? FALSE : TRUE;
}

function add_class_to_wp_nav_menu($classes)
{
  switch (get_post_type()) {
    case 'portfolio':
      // we're viewing a custom post type, so remove the 'current_page_xxx and current-menu-item' from all menu items.
      $classes = array_filter($classes, "remove_parent_classes");

      // add the current page class to a specific menu item (replace ###).
      if (in_array('menu-item-14', $classes)) {
         $classes[] = 'current_page_parent';
      }
      break;
    case 'tips':
      // we're viewing a custom post type, so remove the 'current_page_xxx and current-menu-item' from all menu items.
      $classes = array_filter($classes, "remove_parent_classes");

      // add the current page class to a specific menu item (replace ###).
      if (in_array('menu-item-23', $classes)) {
         $classes[] = 'current_page_parent';
      }
      break;
  }
  return $classes;
}
add_filter('nav_menu_css_class', 'add_class_to_wp_nav_menu'); 
```

该函数中只有一种自定义帖子类型，但我相信您可以弄清楚如何添加更多。有任何问题，请随时发表评论！:)

# crystal-reports - 水晶报表交叉表计算

> ID：16069868
> 
> 赞同：2
> 
> 时间：2013-04-17T20:40:52.663
> 
> 标签：crystal-reports, percentage, crosstab, summarization

在我的交叉表中，我试图添加一个汇总字段，该字段将采用另外两个汇总字段并基于这些字段创建一个百分比。

一个字段汇总了供应商的所有预约（appt 计数），而另一个字段汇总了可能的销售机会的数量（opp 的总和）。我要添加的是一个汇总字段，它本质上是百分比形式的 opp/appt。

我该怎么做呢？

```
 Week 1 | Week 2 | Week 3 | Week 4|
Provider A          |        |        |       |
    Appts       3   |    3   |   4    |   1   |
    Opps        1   |    2   |   1    |   1   |
 Opps/Appts     ??  |   ??   |  ??    |   ??  | 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T17:21:23.287

在水晶报表 2008 中：

*   选择“Opps”计算字段；选择嵌入式摘要，然后插入嵌入式摘要
*   选择新创建的嵌入摘要字段；右键点击; 选择嵌入式摘要，然后选择编辑计算公式
*   添加以下文本：

    Local Numbervar Denominator:=GridValueAt (CurrentRowIndex, CurrentColumnIndex, 0); Local Numbervar Numerator:=GridValueAt (CurrentRowIndex, CurrentColumnIndex, 1);

    If Denominator<>0 Then Numerator/Denominator * 100;

# css - font-size 0 仍然显示在 IE7 中

> ID：16069869
> 
> 赞同：0
> 
> 时间：2013-04-17T20:40:54.787
> 
> 标签：css, internet-explorer-7, font-size

出于某种奇怪的原因，当我设置 font-size:0px; 在我的锚链接样式表中，IE7 仍然显示文本的微小版本。我应该考虑做些什么来完全隐藏文本而不使用文本缩进？

锚本身在 css 中使用背景图像。我只是想在 HTML 页面上隐藏锚链接中的文本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:48:35.833

`visibility: hidden`并且`display: none`是隐藏元素的标准。

两者之间的区别在于它的`visibility`作用类似于不透明度，其中元素被隐藏但仍会影响页面的布局（例如，200px 高的元素仍会使其下方的元素比不存在时低 200px）。

`display`就好像该元素根本不存在一样 - 如果第一个元素不存在，200px 高的元素不会使其下方的元素低 200px。

**摘要**：
因此，如果您想隐藏文本并在其位置留一个空格，请使用`visibility: hidden`. 如果您想隐藏文本并让它表现得好像它根本不存在，请使用`display: none`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:45:49.203

我建议您为文本创建一个单独的类并设置

```
visibility:hidden; 
```

对于那个班级。

# ruby-on-rails - RSpec - 如何创建可用于自动嵌入“it”测试的测试的辅助方法

> ID：16069873
> 
> 赞同：2
> 
> 时间：2013-04-17T20:41:02.720
> 
> 标签：ruby-on-rails, ruby, rspec

我是 ruby​​/rails/rspec 等的新手。

使用 rspec 2.13.1，我想创建一个模块，该模块的方法可以从我的测试中调用，从而导致随后调用 RSpec::Core::ExampleGroup 的“it”方法。

我的模块：

```
require 'spec_helper'

module TestHelper
  def invalid_without(symbols)
    symbols = symbols.is_a?(Array) ? symbols : [symbols]
    symbols.each do |symbol|
      it "should not be valid without #{symbol.to_s.humanize}" do
        # Gonna nullify the subject's 'symbol' attribute here
        # and expect to have error on it
      end
    end
  end
end 
```

上面的代码被添加到：

```
spec/support/test_helper.rb 
```

在我的 spec_helper.rb 中，在 RSpec.configure 块中，我添加了以下内容：

```
config.include TestHelper 
```

现在，在测试中，我执行以下操作：

```
describe Foo
    context "when invalid" do
        invalid_without [:name, :surname]
    end
end 
```

运行这个，我得到：

```
undefined method `invalid_without' for #<Class:0x007fdaf1821030> (NoMethodError) 
```

任何帮助表示赞赏..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T21:09:42.253

使用[共享示例组](https://www.relishapp.com/rspec/rspec-core/v/2-0/docs/example-groups/shared-example-group)。

```
shared_examples_for "a valid array" do |symbols|
  symbols = symbols.is_a?(Array) ? symbols : [symbols]
  symbols.each do |symbol|
    it "should not be valid without #{symbol.to_s.humanize}" do
      # Gonna nullify the subject's 'symbol' attribute here
      # and expect to have error on it
    end
  end
end

describe Foo do
  it_should_behave_like "a valid array", [:name, :surname]
end 
```

# vbscript - Windows 7 计划任务“运行”但不执行任何操作

> ID：16069875
> 
> 赞同：2
> 
> 时间：2013-04-17T20:41:05.273
> 
> 标签：vbscript, scheduled-tasks, windows-7-x64

我有一个 vbscript 文件，它必须在 64 位 Windows 7 机器上以 32 位运行，以便它可以连接到 32 位 Access 数据库。从运行框中我可以输入：

```
C:\Windows\SysWow64\WSCRIPT.EXE P:\Applicants\Applicants.wsf 
```

它运行良好。当我尝试将此作为计划任务运行时，它会在一秒钟内运行（它不应该那么快）并声称它已成功完成。这是我目前正在运行的“操作”：

```
Start a Program
C:\Windows\SysWow64\WSCRIPT.EXE
Arguments: //Nologo //B P:\Applicants\Applicants.wsf >> P:\Applicants\logfile.txt 
```

我也尝试在 CScript 而不是 WScript 下运行它，结果完全相同。

在我添加“//Nologo //B”（我在这里找到的提示）之前，它会开始运行并且永远不会停止。

可选的“开始于”框为空。如果我在其中输入任何值（尝试 P:\Applicants），则任务无法以“错误值：2147942667”开始。通过搜索此错误代码提供的解决方案均无效，因此我将此框留空。

日志文件甚至永远不会被创建，脚本执行的任何工作都没有完成。

该任务在我的网络帐户下运行，并且应该可以访问所有需要的驱动器和资源。

建议？如果没有日志文件，我什至不知道从哪里开始解决这个问题。

编辑：新信息：如果我将其设置为仅在我登录时运行，它工作正常。仅当设置为运行时，即使用户已注销，它也不起作用，即使我在运行时登录也是如此。

编辑 2：“即使用户已注销也运行”的安全上下文表明“”...无论用户是否登录，都选择标记为“运行”的单选按钮。如果选择此单选按钮，任务将不会以交互方式运行。要使任务以交互方式运行，请选择仅在用户登录时运行单选按钮。”

所以我猜它认为我的脚本在某种程度上是交互式的，但事实并非如此。没有任何类型的提示、对话框或 msgBox 调用，所以我不确定为什么会出现问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T15:02:20.593

知道了！问题是我在“操作”调用和脚本本身中都使用 P:\ 引用了映射驱动器。当我用完整的网络路径 \server\share 替换对 P 驱动器的所有调用时，一切正常。如果我没有登录，当然映射驱动器不可用，这很有意义：p

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:45:06.913

你有两个选择。

1.使用要运行的命令创建一个批处理文件，然后安排批处理文件而不是VBScript文件运行。

2.直接运行脚本文件，而不是使用`WScript`or `CScript`。

资料来源：[http ://social.technet.microsoft.com/Forums/en-US/windowsserver2008r2general/thread/464a3bb3-3bcd-47a0-ab03-f0b8910f2ed1/](http://social.technet.microsoft.com/Forums/en-US/windowsserver2008r2general/thread/464a3bb3-3bcd-47a0-ab03-f0b8910f2ed1/)

# android - 带有下拉导航的 ActionBarSherlock 不显示带有自定义视图的选项卡

> ID：16069877
> 
> 赞同：2
> 
> 时间：2013-04-17T20:41:10.170
> 
> 标签：android, tabs, actionbarsherlock

我正在使用操作栏导航，用户可以在其中动态添加选项卡。导航模式设置为：

```
 setNavigationMode(ActionBar.NAVIGATION_MODE_TABS); 
```

我在带有 android 4.0.3 的 7'平板电脑上运行应用程序，因此在横向和纵向模式下，我都嵌入了选项卡，直到操作栏空间不足并切换到下拉导航。

在单击视图之前是微调器的标准，在层次结构查看器中，它包含微调器 -> spinnerTabContainerView$TabView->FrameLayout->textView。这是图片：

[点击前](http://imgur.com/MBU5eOz)

当我单击它而不是向我显示选项卡列表时，它会向我显示如下内容：

[点击后](http://imgur.com/6tVUsyF)

基本上它向我显示了所有选项卡，但不在下拉列表中，也没有我的自定义视图。在 Hierarchy Viewer 中显示为 scrollingTabContainerView->LinearLayout-> 和许多 ScrollingTabContainerView$TabView

我几乎尝试了所有方法，但我不知道下一步该做什么。

以下是一些来源：

-SherlockActionBar 主题

```
<resources>
<style name="MyTheme" parent="Theme.Sherlock.Light">
    <item name="android:actionBarStyle">@style/MyActionBarStyle</item>
    <item name="actionBarStyle">@style/MyActionBarStyle</item>

    <item name="actionBarSize">56dip</item>
    <item name="android:actionBarSize">56dip</item>
</style>

<style name="MyActionBarTabStyle" parent="Widget.Sherlock.Light.ActionBar.TabView">
    <item name="android:padding">0dp</item>
</style>

<style name="MyActionBarStyle" parent="Widget.Sherlock.Light.ActionBar">
    <item name="android:background">#DABA79</item>
</style> 
```

- 我的自定义标签视图

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent">
<TextView
xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/action_custom_tab"
android:layout_width="match_parent"
android:layout_height="match_parent"
style="@android:style/TextAppearance.Large"

/>

</FrameLayout> 
```

# sql - SQL DB 调用在 dll 中还是在项目内部？

> ID：16069884
> 
> 赞同：0
> 
> 时间：2013-04-17T20:41:33.587
> 
> 标签：sql, dll

这似乎是一个基本问题，或者可能没有一个有限的答案，对此我深表歉意。

我的问题是在 DLL（它自己的项目）中进行数据库调用（在我的情况下是 SQL）与将它们放在带有应用程序的项目/网站中（例如在 app_code 文件夹中）的主要优点和/或缺点是什么）。所有 DB 调用仅针对这一特定应用程序，没有其他应用程序需要查看此 DLL。我不确定为什么我的前任会这样做，并试图理解它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T20:45:27.653

将应用程序分层只是一个普遍的好习惯。

可以使用各种技术来完成实际的分层：

使用命名空间，创建 DLL，使用项目中的文件夹，将每一层放在不同的物理机器上（尽管这在技术上也是不同的“层”）

您的前任只是选择将它放在不同的 DLL 中，以便他以后可以灵活地重用整个 DLL。虽然它只针对一个项目，但你永远不会知道。

正如他们所说：创建一个类不需要任何成本，DLL 也是如此。（不包括微小的性能差异）

# ruby-on-rails - 数据库关联，一个类可以has_many和belong_to同一个对象吗？

> ID：16069889
> 
> 赞同：0
> 
> 时间：2013-04-17T20:41:54.103
> 
> 标签：ruby-on-rails, activerecord, associations, has-many, belongs-to

所以我正在尝试创建一个简单的事件 Web 应用程序，其中类用户既可以创建类事件并参与它们。在用户类创建一个类事件的情况下，我希望该事件属于用户。但是，如果同一用户注册参加另一个活动，我希望该用户属于该活动，并且该活动属于拥有多个用户。我不知道这实际上是如何写在模型中的。

在一种情况下，用户类是属于该事件的参与者，而在另一种情况下，他们是主持人，而事件属于他们。如果我没有的话，我不想保持这种干燥并且不创建单独的用户类别（在这种情况下是主机和参与者）。一个简单的联合表似乎并不能解释这种条件关联。对最好的方法有什么建议吗？

类用户？？？

班级活动？？？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T21:16:24.457

您需要建立 2 个关联 - 一个链接到创建的事件，一个链接到订阅的事件：

```
create_table :event_subscriptions do |t|
  t.references :subscribed_user
  t.references :subscribed_event
end

create_table :events do |t|
  t.references :user
  # other fields
end

class User < ActiveRecord::Base
  has_many :events               # created Events
  has_many :event_subscriptions, :foreign_key => :subscribed_user_id
  has_many :subscribed_events, :through => :event_subscriptions  # subscribed Events
end

class EventSubscription < ActiveRecord::Base
  belongs_to :subscribed_user, :class_name => 'User'
  belongs_to :subscribed_event, :class_name => 'Event'
end

class Event < ActiveRecord::Base
  belongs_to :user               # the creating User
  has_many :event_subscriptions, :foreign_key => :subscribed_event_id
  has_many :subscribed_users, :through => :event_subscriptions   # subscribed Users
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T21:11:32.543

请注意，如果是事件，`has_many :users`则用户表必须有一`event_id`列，并且用户一次只能属于一个事件。我怀疑你想要用户和事件之间的多对多关系。如果是这种情况，您将使用[此处](http://guides.rubyonrails.org/association_basics.html#the-has_and_belongs_to_many-association)`has_and_belongs_to_many :users`记录的关联

也就是说，是的，你可以在同一个类上有多个关系。

```
class Event < ActiveRecord::Base
  has_many :users
  belongs_to :host, :class_name => 'User'
end 
```

events 表会有一个 column `host_id`，但 event.host 仍然会返回一个 User。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T20:59:42.877

我建议您使用`has_and_belongs_to_many`关联（[此处](http://guides.rubyonrails.org/association_basics.html#the-has_and_belongs_to_many-association)的文档）。根据您要完成的工作，我认为无法避免使用联合表。当然，这不应该让你气馁！

`string`我将向用户表（即主机或参与者）添加一个类型的“角色”列并使用`has_and_belongs_to_many`关联。请注意，您将需要创建一个`users_events`包含`:user_id`和`:event_id`列的联合表。

然后，您可以拥有一个角色为“主持人”的用户，创建一个事件并邀请其他角色为“参与者”的用户。

当然，这只是我的建议。有几种方法可以解决这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T21:04:11.127

我会在用户和事件之间使用 has_many 和 belongs_to 来处理这个问题。用户 has_many Events 和 Event belongs_to User。

剩下的就是你的逻辑了。您希望您的 has_many 关系成为您的活动所有者还是您的参与者。我假设 has_many 与事件所有者有关。

从那里在您的事件表中创建一个名为参与者的列。然后，在 Event 或 User 模型中，您可以创建一个 before_save 方法来插入参与者的 user_id。

然后，您可以在任一模型中创建一个范围，以返回事件所有参与者的列表。

# java - jsp中的if else语句

> ID：16069890
> 
> 赞同：1
> 
> 时间：2013-04-17T20:41:57.570
> 
> 标签：java, jsp, if-statement

我有以下问题 - if else 语句在 JSP 中不起作用，老实说我不知道​​为什么。基本上，我尝试`placeName`根据存储在名为 place 的字符串中的数字来更改。在浏览器中打印值后，我可以看到值没有改变。我敢肯定这很简单，但是……也许有人以前遇到过类似的问题？

```
<%
//requests the strings sent by previous page
String year = request.getParameter("year");
String place = request.getParameter("place");
out.print(year);
out.print(place);

String year2 = request.getParameter("year2");
String place2 = request.getParameter("place2");
//out.print(year2);
//out.print(place2);

if (place == "1")
{
placeName = "Belmullet";
}
else if (place == "2")
{
placeName = "Birr";
}
...more statements here...
else if (place == "15")
{
placeName = "Shannon airport";
};
%> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T20:44:42.697

更改 if 条件：

```
if (place == "1") {

} 
```

经过

```
if ("1".equals(place)) {

} 
```

和其他 if 条件相同的方式。

这个[SO question](https://stackoverflow.com/questions/767372/java-string-equals-versus)`==`可以帮助您了解和之间的区别`equals()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:43:55.727

这是因为您使用 == 比较字符串。相反，请使用该`.equals()`方法。

== 运算符测试两个对象引用是否引用了完全相同的对象实例。

.equals() 测试查看相互比较的两个对象是否相等。

# c++ - 不会使用 ifstream 读取空格

> ID：16069893
> 
> 赞同：1
> 
> 时间：2013-04-17T20:42:01.900
> 
> 标签：c++, string, whitespace, ifstream, sstream

我对 C++ 比较陌生，所以要温柔。我有一个要阅读的文本文件，但是当我阅读该文件时，它会跳过分隔单词之间的空格（空格）。

我试图带走尽可能多的垃圾代码，以便更容易阅读。

```
#include <iostream>
#include <string>
#include <sstream>
#include <fstream>

using namespace std;

int main(.....)
{
    ifstream in_file;
    string filename;
    string status;
    readStringToMem(in_file, status);

    cout << "Type in the filename :    ";
    getline(cin, filename);    
    in_file.open(filename);
    readStringToMem(in_file, status);
}

void readStringToMem(ifstream& in_file, string& string_value)
{
    string input_string;
    getline(in_file, input_string, '|');
    stringstream myInputStream(input_string);
    myInputStream >> string_value;
} 
```

我的文件可能如下所示：

> 状态正常 | 100

但是当我阅读它时，它是这样的：

> 状态 100

提前致谢！任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T21:27:32.787

你太努力了，这个

```
void readStringToMem(ifstream& in_file, string& string_value)
{
    string input_string;
    getline(in_file, input_string, '|');
    stringstream myInputStream(input_string);
    myInputStream >> string_value;
} 
```

应该是这个

```
void readStringToMem(ifstream& in_file, string& string_value)
{
    getline(in_file, string_value, '|');
} 
```

简单得多，实际上 readStringToMem 是如此简单，我想知道是否值得将其放入一个单独的函数中。

我认为您可能对整数大小写感到困惑。在这种情况下，您必须将使用 getline 读取的字符串转换为整数。你可以使用 stringstream 来做到这一点。但在字符串情况下，您已经有一个字符串，因此无需进行转换，也不需要字符串流。

# linux - inode 和 crtime 可以用作唯一的文件标识符吗？

> ID：16069898
> 
> 赞同：14
> 
> 时间：2013-04-17T20:42:24.300
> 
> 标签：linux, inode

我在**Linux**上有一个文件索引数据库。目前我使用文件路径作为标识符。但是如果一个文件被移动/重命名，它的路径就会改变，我无法将我的数据库记录与新文件匹配，并且必须删除/重新创建记录。更糟糕的是，如果一个目录被移动/重命名，那么我必须删除/重新创建所有文件和嵌套目录的记录。

我想使用**inode**编号作为唯一的文件标识符，但是如果删除文件并创建另一个文件，则可以重用 inode 编号。

所以，我想知道我是否可以使用一对`{inode,crtime}`作为唯一的文件标识符。我希望在 ext4 上使用 i_crtime，在 NTFS 上使用 creation_time。在我有限的测试（使用 ext4）中，inode 和 crtime 在同一文件系统中重命名或移动文件或目录时确实保持不变。

因此，问题是是否存在文件的 inode 或 crtime 可能更改的情况。例如，fsck 或碎片整理或分区大小调整是否可以更改 inode 或 crtime 或文件？

有趣的是 [http://msdn.microsoft.com/en-us/library/aa363788%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa363788%28VS.85%29.aspx) 说：

*   “*在 NTFS 文件系统中，一个文件在被删除之前保持相同的文件 ID。* ”
    但也：
*   "*在某些情况下，文件的文件 ID 会随着时间而改变。* "

那么，他们提到的那些案例是什么？

请注意，我研究了类似的问题：

*   [linux下如何判断文件的唯一性？](https://stackoverflow.com/questions/13172534/how-to-determine-the-uniqueness-of-a-file-in-linux)
*   [执行'mv A B'：'inode'会改变吗？](https://stackoverflow.com/questions/10702767/executing-mv-a-b-will-the-inode-be-changed)
*   [在 Linux 中检测文件移动或重命名的最佳方法是什么？](https://stackoverflow.com/questions/3514771/best-approach-to-detecting-a-move-or-rename-to-a-file-in-linux)

但他们没有回答我的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-08-28T23:42:27.003

Unix 中 i 节点的分配和管理取决于文件系统。因此，对于每个文件系统，答案可能会有所不同。

对于 Ext3 文件系统（最流行的），i-nodes 被重用，因此不能用作唯一的文件标识符，也不会根据任何可预测的模式发生重用。

在 Ext3 中，i 节点在位向量中跟踪，每个位代表一个 i 节点编号。当一个 i 节点被释放时，它的位被设置为零。当需要一个新的 i 节点时，会在位向量中搜索第一个零位，并重新使用 i 节点编号（可能先前已分配给另一个文件）。

这可能会导致一个幼稚的结论，即编号最小的可用 i 节点将被重用。然而，Ext3 文件系统是复杂且高度优化的，因此不应假设何时以及如何重用 i 节点编号，即使它们显然会。

来自 ialloc.c 的源代码，其中分配了 i 节点：

> 有两种分配 inode 的策略。如果新的 inode 是一个目录，则向前搜索一个具有空闲空间和低目录与 inode 比率的块组；如果失败，则在可用空间高于平均水平的组中，已选择目录最少的组。对于其他 inode，从父目录的块组中向前搜索以找到空闲的 inode。

管理 Ext3 的源代码称为 ialloc，最终版本在这里： [https ://github.com/torvalds/linux/blob/master/fs/ext3/ialloc.c](https://github.com/torvalds/linux/blob/master/fs/ext3/ialloc.c)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T21:05:56.910

*   *{device_nr,inode_nr} 是系统内*inode 的唯一标识符
**   将文件移动到不同的目录不会**改变**它的 inode_nr*   linux`inotify`界面使您能够监视对 inode（文件或目录）的更改*

 *额外说明：

*   *跨文件系统*移动文件的处理方式不同。（实际上是复制+删除）
*   网络文件系统（或挂载的 NTFS）不能总是保证 inodenumbers 的稳定性
*   Microsoft*不是*Unix 供应商，它的文档不包括 Unix 或其文件系统，应该被忽略（NTFS 的内部结构除外）

额外文本：旧的 Unix 格言“一切都是文件”实际上应该是：“一切都是 inode”。inode 携带有关文件（或目录，或特殊文件）的所有*元信息，但名称***除外**。文件名实际上只是碰巧链接到特定 inode 的目录条目。移动文件意味着：创建一个指向同一个 inode 的新链接，结束删除链接到它的旧目录条目。inode 元数据可以通过`stat()`and `fstat()`, and`lstat()`系统调用获得。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-04-07T07:47:36.170

我猜 dB 应用程序需要考虑文件需要从备份恢复的情况，这将保留文件 crtime，但不保留 inode 编号。*

# linux - 不了解makefile

> ID：16069900
> 
> 赞同：0
> 
> 时间：2013-04-17T20:42:38.300
> 
> 标签：linux, compilation, makefile

我正在为这个 Makefile 苦苦挣扎。它在最后一行爆炸。无法弄清楚我做错了什么。任何人都可以看到吗？谢谢！

```
CC           = gcc
CFLAGSFUSE   = `pkg-config fuse --cflags`
LLIBSFUSE    = `pkg-config fuse --libs`

CFLAGS = -c -g -Wall -Wextra
LFLAGS = -g -Wall -Wextra

encfs: encfs.o log.o xattr_new.o
    $(CC) $(LFLAGS) $^ -o $@ $(LLIBSFUSE)   

xattr_new: xattr_new.o
    $(CC) $(LFLAGS) $^ -o $@

encfs.o: encfs.c log.h params.h xattr_new.c
    gcc -g -Wall `pkg-config fuse --cflags` -c pa4-encfs.c

log.o : log.c log.h params.h
    $(CC) $(CFLAGS) $(CFLAGSFUSE) log.c

xattr_new.o: xattr_new.c
    $(CC) $(CFLAGS) $< 
```

> /usr/bin/ld: /usr/lib/debug/usr/lib/i386-linux-gnu/crt1.o(.debug_info): 重定位 0 有无效的符号索引 11
> 
> /usr/bin/ld:/usr/lib/debug/usr/lib/i386-linux-gnu/crt1.o(.debug_info): 重定位 1 有无效的符号索引 12
> 
> /usr/bin/ld:/usr/lib/debug/usr/lib/i386-linux-gnu/crt1.o(.debug_info): 重定位 2 有无效的符号索引 2
> 
> /usr/bin/ld: /usr/lib/debug/usr/lib/i386-linux-gnu/crt1.o(.debug_info): 重定位 3 有无效的符号索引 2
> 
> /usr/bin/ld: /usr/lib/debug/usr/lib/i386-linux-gnu/crt1.o(.debug_info): 重定位 4 有无效的符号索引 11
> 
> ...

# python - 架构迁移和默认值

> ID：16069906
> 
> 赞同：1
> 
> 时间：2013-04-17T20:43:04.773
> 
> 标签：python, django, django-south

我正在使用 South 来管理我的数据库。似乎每次我在创建模型的方式上进行一些细微的更改时，我最终都不得不为迁移做一堆体操。例如，假设我有一个这样的类：

```
class Entry(models.Model):

    title = models.CharField(max_length=80)
    author = models.ForeignKey(User)
    pubDate = models.DateTimeField()
    tags = models.ManyToManyField(Tag)
    text = models.TextField() 
```

和另一个`Entry`作为 ForeignKey 的类：

```
class Comment(models.Model):
    author = models.ForeignKey(User)
    entry = models.ForeignKey(Entry)
    pubDate = models.DateTimeField()
    text = models.TextField() 
```

这是微不足道的，但是如果我要做一些简单的事情，例如将名称 pubDate 更改为 pub_date in `Entry`，为了仅针对此名称更改正确执行模式迁移，我将不得不设置：

```
default=None, null=True 
```

对于 pubDate`Entry`和 中的`entry`字段`Comment`，否则在尝试运行迁移时会出现以下异常：

```
The field 'Comment.entry' does not have a default specified, yet is NOT NULL. 
```

那么我将不得不返回并取出默认/空值。有没有一种不那么乏味的方法来做到这一点，还是我只需要在将模型提交到迁移之前真正考虑一下我的模型？在开始阶段，如果您没有任何需要保留的数据，那么仅设置和拆除数据库是否更有意义？如果是这样，最简单的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:01:27.757

您需要创建一个迁移类，使用：

```
python manage.py datamigration yourapp change_name_to_pub_date 
```

并重写 forwards 和 backwards 方法：

```
# -*- coding: utf-8 -*-
import datetime
from south.db import db
from south.v2 import SchemaMigration
from django.db import models

class Migration(SchemaMigration):
    def forwards(self, orm):
        db.rename_column('yourapp_entry', 'pubDate', 'pub_date')
        db.rename_column('yourapp_comment', 'pubDate', 'pub_date')

    def backwards(self, orm):
        db.rename_column('yourapp_entry', 'pub_date', 'pubDate')
        db.rename_column('yourapp_comment', 'pub_date', 'pubDate') 
```

现在，运行：

```
python manage.py migrate yourapp 
```

# wix - Wix：组件更新无法按预期工作

> ID：16069908
> 
> 赞同：1
> 
> 时间：2013-04-17T20:43:19.563
> 
> 标签：wix, windows-installer

我有一个共享 dll（COM 对象），我们称之为 Utility.dll，它由多个产品安装。在我的 WIX 文件中，我将 Utility.dll 作为一个单独的组件安装。

现在我发布了新版本 2.0，并使用相同的组件 GUID 和路径。从理论上讲，他的组件应该引用计数，但这不是发生的事情：

1.  安装产品 1 1.0 ( Utility.dll 1.0)
2.  安装产品 2 2.0 ( Utility.dll 2.0)

磁盘上的 Utility.dll 是 2.0

1.  删除产品 1 1.0 并删除 Utility.dll。

以前的安装程序是在 InstallShield 中编写的，而当前的安装程序是在 Wix3 中编写的。Utility.dll 的组件 GUID 和路径相同（仔细检查）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-29T15:21:13.847

我刚刚遇到了同样的问题，并且文件被卸载，因为这两个组件之间的 KEYPATH 不同。在我的情况下，我在较新版本的安装程序中添加了一个伴随文件，以确保安装了最新的文本文件。因为一个文件不能是 KEYPATH 并且有一个伴随文件，所以我被迫更改 KEYPATH。

您可以通过反向搜索组件 GUID 的前 8 个字符在注册表中找到该组件。该注册表文件夹将为安装该 GUID 的每个 MSI 提供一个密钥，并且数据字段将显示 KEYPATH。我的猜测是 KEYPATH 对于 1.0 版的机器和 2.0 版的机器是不同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T21:02:25.103

在详细日志文件中查找`Component`. 您应该会看到指示是否有其他客户端（产品）的消息`Component`。这将解释为什么卸载会删除该文件。

# android - 无法在自定义对话框中优先使用时间选择器

> ID：16069909
> 
> 赞同：2
> 
> 时间：2013-04-17T20:43:29.337
> 
> 标签：android, android-preferences, android-dialog

因为我想自定义我自己的时间选择器对话框，所以我不使用提供的时间选择器对话框。但是，我发现如果我优先调用对话框，它就不起作用。但如果我把它放在一个普通的 xml 布局中，它就可以工作。eclipse没有检查代码错误，但是如果我在手机中运行，nullpointerexception从下面的粗线开始出现。

```
public class Prefs extends PreferenceActivity{

    Preference time;

    void openCustomDialog() {
        AlertDialog.Builder customDialog = new AlertDialog.Builder(Prefs.this);
        customDialog.setTitle("Set Delay Time");
        LayoutInflater layoutInflater = (LayoutInflater) getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        View view = layoutInflater.inflate(R.layout.timepicker, null); 
        TimePicker minute = (TimePicker) findViewById(R.id.mPicker);
        **minute.setOnTimeChangedListener(new TimePicker.OnTimeChangedListener()** {
            public void onTimeChanged(TimePicker view, int hourOfDay, int minute) {
            }
        });
        minute.setCurrentMinute(usb.minute);

        TimePicker second = (TimePicker) findViewById(R.id.sPicker);
        second.setOnTimeChangedListener(new TimePicker.OnTimeChangedListener() {
            public void onTimeChanged(TimePicker view, int hourOfDay, int second) {
            }
        });
        second.setCurrentMinute(usb.second);
        customDialog.setPositiveButton("OK",new DialogInterface.OnClickListener() {
                    @Override
                    public void onClick(DialogInterface arg0, int arg1) {
                    }
                });
        customDialog.setView(view);
        customDialog.show();

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.prefs);

        time = (Preference)findPreference("time");

        time.setOnPreferenceClickListener(new Preference.OnPreferenceClickListener() {
            @Override
            public boolean onPreferenceClick(Preference arg0) { 
                openCustomDialog();  
                return true;
            }
        });
} 
```

# soap - Java：到 Soap 的快速通用网关数据

> ID：16069916
> 
> 赞同：1
> 
> 时间：2013-04-17T20:43:58.070
> 
> 标签：soap, proxy, esb, mom, format-conversion

我确实想构建一个从嵌套映射（从二进制数据流生成）到 SOAP 客户端的通用网关。

背景：需要调用 SOAP-Services 的非 java-application 无法生成 json 或 SOAP/XML，但可以轻松生成自定义协议（在我们的控制之下）。

所以需要代理。不应在每次更改 WSDL 或推出下一个 Web 服务时重写该代理。

我的计划是：

*   将 url、port 和 service-name (url:port/service-name) 作为该代理的“严格”定义参数，

*   将 SOAP 操作作为“严格”定义的参数

*   请求（可能缓存） url:port/service-name?wsdl 的 wsdl 并动态启动存根调用（缓存），

*   将嵌套映射中存在的值填充到该存根

*   调用 SOAP 服务

*   将答案转换回该二进制协议。

如果缺少一些必要的值，它应该发送等效的 SOAP-Error。

当然，所有这些都具有小（负担得起的）延迟、高稳定性、绝对最小的部署停机时间（用于更新）和相当大的负载。

我看到了几种可能性：

a) 使用像 WSO2ESB 这样的 ESB。在那里，我将流格式实现为特殊的输入格式适配器，将其转换为内部 XMLStream（至少 json-adapter 似乎是这样工作的）并将其发送给中介。该调解员会尝试类似 [http://today.java.net/pub/a/today/2006/12/13/invoking-web-services-using-apache-axis2.html](http://today.java.net/pub/a/today/2006/12/13/invoking-web-services-using-apache-axis2.html) “创建动态客户端”并调用直接使用 SOAP 服务。

b) 使用像 ApacheMQ 这样的 MOM 中间件和 Camel，

c) 将其简化为 Apache Karaf 和 CXF

我有点迷失在所有这些可能性之间，而这些只是或多或少是各种任意样本。

对a）的想法：

*   减号：没有 ESB-Target 感觉有点奇怪，因为中介会直接调用给定的 SOAP-Requests

*   减：我想知道内部转换成 XML-Stream 是否不会花费额外的时间和资源

*   减号：据我所知，更改代码需要重新启动 WSO2ESB

*   另外：我可以定义使用 ESB 解析的符号名称，而不是 url、端口、服务名称——如果不需要额外的毫秒。

对于 b) 我还没有检查这些格式转换在 Camel 中的难易程度以及 SOAP-Service-Requests 是否适合消息发送和队列。

我已经对该主题进行了一些搜索，但是由于完全不同的产品的重叠范围，这确实令人困惑。我认为这是一个标准问题，但显然没有明显的解决方案 - 至少我没有找到它们。

我确实希望了解这些解决方案中的哪些可能会导致麻烦或大量工作（以及哪些容易成功），并且我希望我的方法中有一些原因。

感谢任何合格的评论！

马可

# javascript - 从标签选择选项打印值

> ID：16069917
> 
> 赞同：1
> 
> 时间：2013-04-17T20:44:00.803
> 
> 标签：javascript, printing, tags, option

我不知道为什么，但是当我单击打印按钮时，打印预览总是显示标签选择选项上的第一个选项

例如：testingprint.html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
</head>

<body>
<div id="printing">
    <table>
        <tr>
            <td>
                <select>
                <option>-</option>
                    <option>A</option>
                    <option>B</option>
                </select>
            </td>
            <td><input type="button" onclick="printPage('printing')"/></td>
        </tr>        
    </table>
</div>
</body>
</html> 
```

这里是javascript：java.js

```
<script type="text/javascript">
function printPage(id)
{ 

   var html="<html>";
   html+="<head>";
   html+="</head>";
   html+= document.getElementById(id).innerHTML;
   html+="</html>";

   var printWin = window.open('','','left=0,top=0,width=1024,height=768,toolbar=0,scrollbars=0,status  =0');
   printWin.document.write(html);
   printWin.document.close();
   printWin.focus();
   printWin.print();
   printWin.close();

}

</script> 
```

为什么即使我选择选项“A”或其他选项，打印预览总是显示该选项仍然是“ - ”？

谁能给我一些建议？..或者我应该用什么来打印脚本？

如果我使用 print() 函数，它将打印整个页面，我只想打印我选择的内容

谢谢你的帮助，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T21:12:00.107

更改选择框的值并不会真正改变 dom 树。您可以强制它更改 dom 树。只需在您选择的 onchange 中添加一些 javascript

```
 <select onchange="this.options[this.selectedIndex].setAttribute('selected','selected');">
     <option>-</option>
     <option>A</option>
     <option>B</option>
 </select> 
```

然后，innerHTML 将是`<option selected="selected">A</option>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:54:34.953

给你的`<select>`元素一个`id`属性：

```
<select id="select1">
    ...
</select> 
```

并使用这个 Javascript：

```
function printPage(id) { 
    var selectedIndex = document.getElementById("select1").selectedIndex;
    var html = "<html>";
    html += "<head></head>";
    html += "<body>";
    html += document.getElementById(id).innerHTML;
    html += "<script type='text/javascript'>";
    html += "document.getElementById('select1').selectedIndex = " + selectedIndex + ";";
    html += "<\/script>";
    html += "</body>";
    html += "</html>";

    var printWin = window.open('','','left=0,top=0,width=1024,height=768,toolbar=0,scrollbars=0,status  =0');
    printWin.document.open();
    printWin.document.write(html);
    printWin.document.close();
    printWin.focus();
    printWin.print();
    printWin.close();
} 
```

**演示：http:** [//jsfiddle.net/bkHC2/1/](http://jsfiddle.net/bkHC2/1/)

当您用于`.innerHTML`获取元素的内容时，不会复制有关其当前“状态”的任何内容。所以我“修复”的快速方法是将Javascript放在新窗口中，`selectedIndex`将`<select>`元素的设置为主页上的当前位置。

请注意，我将`<body>`元素包含在`html`变量中。

# vim - 如何检查 vim 窗口是否具有管理员权限以及如何将其添加到状态行？

> ID：16069924
> 
> 赞同：0
> 
> 时间：2013-04-17T20:44:28.573
> 
> 标签：vim, admin, status

我注意到：具有管理员权限的
Vim 只能从具有管理员权限的程序中打开文件。
没有管理员权限的 Vim 只能从没有管理员权限的程序中打开文件。

这使得我经常打开两个具有不同权限的 vim 窗口。
我经常不知道我使用的那个是否有管理员权限。

是否可以检查 vim 窗口是否具有管理员权限？

我想将管理员状态添加到状态行，如下所示：

```
function! CheckAdminMode()
  if &admin | return 'Admin' | else | return '' | endif
endfunction

set statusline+=%*\ %{&admin} 
```

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T21:29:02.730

如果你知道一个 shell 命令，你可以使用`system()`. 例如，对于大多数家庭 linux 设置

```
if system('echo $EUID') == 0 " Implicit type cast, string->int for left operand
    return 'Root'
else
    return ''
endif 
```

（`$EUID`通常是导出环境中不存在的 shell 特殊变量，因此`if $EUID == 0`无法使用），或者更快，

```
py import os
return (pyeval('os.geteuid()') == 0) ? 'Root' : '' 
```

. 当您要求管理员而不是 root 时，我假设您不在 linux 上，因此我无法帮助您检查命令。您始终可以使用间接检查：测试您是否有权写入某些仅对管理员可写的目录：

```
" filewritable() reports 2 for writable directories which is also true
return filewritable('C:\Windows\System32') ? 'Admin' : '' 
```

.

# sage - 求解二元线性系统 + SAGE

> ID：16069925
> 
> 赞同：1
> 
> 时间：2013-04-17T20:44:30.353
> 
> 标签：sage

我有方程 Ax=b，其中所有矩阵条目和向量 b 的所有条目都在 GF(2) 中。我将如何在 SAGE 软件中通过 GF(2) 求解这个线性系统方程？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T21:39:08.840

这在[sage-support](https://groups.google.com/forum/#!topic/sage-support/rIsMum3IONE)邮件列表中得到了回答。为了完整起见，我基本上会从那里剪切并粘贴答案：

```
sage: A = random_matrix(GF(2), 10000, 10000)
sage: A.det()
1
sage: b = random_vector(GF(2), 10000)
sage: x = A \ b
sage: A * x == b
True 
```

# javascript - 在javascript中正确传递参数

> ID：16069926
> 
> 赞同：0
> 
> 时间：2013-04-17T20:44:35.437
> 
> 标签：javascript, knockout.js

目前我正在将 url 和 id 硬编码到一个函数中，但我想将它们传递进去，所以它并不特定于硬编码。

**传入参数的代码 - 当前是硬编码的**

```
 Next = function () {
    var _page = $.views.Roster.ViewModel.CurrentPage() + 1;
    $.views.Roster.ViewModel.CurrentPage(_page);
    $.views.Roster.GetPage("/api/Roster", 9, _page);
} 
```

我希望将最后一行更改为：`$.views.Roster.GetPage(url, id, _page);`

**传入参数的当前方法**

```
$.views.Roster.GetPage = function (url, id, pageNumber) {
        $.ajax({
            Url: url,
            DataToSubmit: { pageNumber: pageNumber, id: id },
            DataType: "json",
            OnSuccess: function (data, status, jqXHR) {
                $.views.Roster.RosterViewModel.AddUsers(data);
            }
        });
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:47:00.160

您可以参数化您的功能：

```
 Next = function (url, id) {
    var _page = $.views.Roster.ViewModel.CurrentPage() + 1;
    $.views.Roster.ViewModel.CurrentPage(_page);
    $.views.Roster.GetPage(url, id, _page);
} 
```

# sql-server - SSIS 包和引发错误

> ID：16069927
> 
> 赞同：0
> 
> 时间：2013-04-17T20:44:37.567
> 
> 标签：sql-server, stored-procedures, ssis

我很抱歉这是重复。我找不到符合我要求的问题。（这类似于[我如何在存储过程中创建带有 RAISERROR 的参数？](https://stackoverflow.com/questions/10764287/how-can-i-create-out-parameters-with-raiserror-in-stored-procedure)）

我在 SQL Server 代理中有一个非常简单的工作，只需一步。该包只执行一个存储过程。存储过程有一个 try / catch 块，当我尝试引发异常时，它会被捕获但不会向上传播并导致作业报告错误。作业成功。我将错误记录到本地表中并提交它，所以我知道我确实进入了 catch 块。我尝试过使用严重级别 16 和 20 以及其他一些可能不值得一提的东西来引发错误。

这是导致它无法传播的包设置还是我的存储过程有问题？谢谢。

```
-- dumbed down structure
BEGIN

    SET NOCOUNT ON;

    -- buncha vars
    BEGIN TRY
    BEGIN TRANSACTION

      set @StepNumber = 10;

      select 1/0;

    COMMIT TRANSACTION;
    RETURN 0;
    END TRY
    BEGIN CATCH

        -- get the error
        SELECT @ErrorMessage = ERROR_MESSAGE(),
               @ErrorSeverity = ERROR_SEVERITY(),
               @ErrorState = ERROR_STATE();

        -- rollback the transaction
            ROLLBACK TRANSACTION;

        -- log the caught exception into the local log
        set @LogTimestamp = GETUTCDATE(); 
        set @LogMessage = @SessionGUID + ' - ' + CAST(@StepNumber AS NVARCHAR) + ' - ' + ' ERROR - ENTERED CATCH BLOCK - ERROR_MESSAGE()=' + @ErrorMessage + ' ERROR_SEVERITY()=' + cast(@ErrorSeverity as nvarchar) + ' ERROR_STATE()=' + CAST(@ErrorState as nvarchar) ;
        insert into @LocalLog(TimestampDT, SourceVch, MessageVch) values (@LogTimestamp, @LogSource, @LogMessage);

        -- transfer local log to master log table
        BEGIN TRANSACTION;
            --insert into RealTable selecting from @LocalLog;
        COMMIT TRANSACTION;

        -- slightly modify the error message before raising it to parent process
        SET @ErrorMessage = @LogSource + ' - error with @StepNumber=[' +CAST(@StepNumber as nvarchar)+ '] ERROR_MESSAGE()=' + @ErrorMessage;

        -- rethrow the error to the calling process
        RAISERROR (@ErrorMessage, @ErrorSeverity, @ErrorState);

        -- do we need this return?
        RETURN @StepNumber;
    END CATCH
END 
```

我得到的日志表告诉我我至少发现了错误（来自我的日志表）。“6a3e80fd-f480-459c-a42f-25fd3d5a42a8 - 125 - 错误 - 输入捕获块 - ERROR_MESSAGE()=除以零错误。ERROR_SEVERITY()=16 ERROR_STATE()=1”

# c - 释放内存 - 二维数组

> ID：16069933
> 
> 赞同：1
> 
> 时间：2013-04-17T20:45:05.020
> 
> 标签：c, visual-studio-2010

我使用 Visual C++ 2010，我正在尝试将 free() 与二维数组一起使用：

```
#include <stdio.h>
#include <stdlib.h>
#define SIZE 8

int main(){

    int **matrix = (int**)malloc(sizeof(int*)*SIZE);
    int i;
    for(i=0; i<SIZE; i++){
        matrix[i] = (int*)malloc(sizeof(int)*SIZE);
    }
    for(i=0; i<SIZE; i++){
        free(matrix[i]);
    }
    free(matrix);
    getch();
    return 0;
} 
```

我这样做对吗？

问候。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T20:50:50.030

基本上应该是对的。

顺便说一句，您不需要`malloc`为您尝试分配的二维数组的每一行调用（除非您有特定的理由这样做）。

您可以只使用一个`malloc`和一个`free`：

```
malloc(sizeof(int*)*ROW_NUM * COL_NUM); 
```

使用单个调用`malloc`还具有在内存中连续分配矩阵元素的好处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T20:51:33.800

看起来像。尽管您可以并且可能应该（出于效率目的）只做一个 malloc 和一个 free ，如此[处所示](https://stackoverflow.com/questions/8740195/how-do-we-allocate-a-2-d-array-using-one-malloc-statement)

如果您不需要明确地使用 C，那么可能值得看一下向量来为您处理内存。

# qt - 如何使 QWidget 对事件半透明？

> ID：16069936
> 
> 赞同：5
> 
> 时间：2013-04-17T20:45:09.913
> 
> 标签：qt

我见过类似的问题，但没有适合我需要的答案。我想要一个不可见的小部件，它位于我的整个应用程序之上（这里没有问题）。我希望这个小部件能够捕获事件，以便我可以打印关于它们的内容、记录它们等等。我目前连接了一个事件过滤器，可以很好地做到这一点。然后我希望它让事件通过小部件后面的任何东西。因此，例如，如果我尝试按下按钮，不可见的小部件应该注意到在该位置发生了按下，然后应该实际按下按钮。这可以通过简单的方式完成，还是我必须编写代码来模拟不可见小部件下的所有事件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T13:17:15.253

从您在评论中披露的所有信息中，我建议您按照前面的讨论过滤事件，然后使用[QCoreApplication::sendEvent](http://qt-project.org/doc/qt-4.8/qcoreapplication.html#sendEvent)将所需的事件转发到不可见的小部件。然后它将相应地将该事件传播给它的孩子。

编辑：好的，这是一个包含基于 QObject 的事件过滤器的快速示例，它将过滤小部件的事件，如果事件是鼠标事件，它将留给小部件处理和打印输出，如果事件是一个关键事件，它将被过滤并且不会转发回小部件：

事件过滤器类：

```
 class EventInfo : public QObject {
    Q_OBJECT
public:
    explicit EventInfo(QObject *parent = 0) : QObject(parent) {}

    bool eventFilter(QObject *, QEvent *e) {
        if (e->type() == QEvent::MouseButtonRelease){
            qDebug() << "click event not filtered";
            return false;
        }
        if (e->type() == QEvent::KeyRelease) {
            QKeyEvent *event = static_cast<QKeyEvent *>(e);
            if (event) qDebug() << "key" << event->key() << "filtered";
            return true;
        }
        return false;
    }
}; 
```

小部件：

```
class Widget : public QWidget {
    Q_OBJECT

public:
    Widget(QWidget *parent = 0) : QWidget(parent) {}

protected:
    void mouseReleaseEvent(QMouseEvent *e) {
        qDebug() << "widget clicked at position" << e->pos();
    }

    void keyReleaseEvent(QKeyEvent *e) {
        qDebug() << "pressed key" << e->key();
    }
}; 
```

主.cpp：

```
int main(int argc, char *argv[]) {
    QApplication a(argc, argv);
    Widget w;
    EventInfo info;
    w.installEventFilter(&info);
    w.show();    
    return a.exec();
} 
```

测试输出以显示键盘事件被过滤并且鼠标按下事件被转发到小部件：

```
click event not filtered
widget clicked at position QPoint(352,230) 

key 70 filtered 

click event not filtered
widget clicked at position QPoint(405,163) 

key 87 filtered 
```

# windows - 在 Windows 服务中使用 WinRT 搜索

> ID：16069952
> 
> 赞同：0
> 
> 时间：2013-04-17T20:45:58.887
> 
> 标签：windows, search, windows-runtime, contract

我是一名 C# 敏锐的开发人员，需要在 Windows 8 中通过 Windows 服务进行一些搜索。是否可以从普通的 Windows 服务搜索应用程序、设置和文件以及其他搜索合同注册的提供程序？

我将如何去做，我应该研究哪些命名空间等？我正在努力将 WinRT 与此处的其他 Windows 连接起来。

# asp.net-mvc-3 - SimpleMembershipProvider 与 WebSecurity

> ID：16069953
> 
> 赞同：0
> 
> 时间：2013-04-17T20:46:05.340
> 
> 标签：asp.net-mvc-3, authentication, asp.net-web-api, security

我有一个带有存储库层的 WebAPI 项目。对于与帐户相关的方法，我不确定在这里使用哪种方法：

```
public class RepositoryService : IRepositoryService
    {
        private readonly SimpleMembershipProvider _membership;
        public RepositoryService()
          {
            _membership = (SimpleMembershipProvider)Membership.Provider;
          } 
```

检查用户是否存在：

```
 public bool UserExists(string userName)
    {
        return WebSecurity.UserExists(userName);
    } 
```

或者

```
public bool UserExists(string userName)
{
    return _membership.GetUser(userName, true) != null;
} 
```

我想知道，因为在其他地方我认为我必须使用 _membership （例如，获取特定用户）：

```
public MembershipUser GetUser(string userName)
    {
        return _membership.GetUser(userName, false);
    } 
```

但是我必须使用 _membership 和 WebSecurity 似乎很奇怪。两者都使用有什么“臭味”吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:32:30.267

以下似乎表明您没问题：

来自MSDN 文档[http://msdn.microsoft.com/en-us/library/gg547905%28v=vs.111%29.aspx](http://msdn.microsoft.com/en-us/library/gg547905%28v=vs.111%29.aspx)：`WebSecurity class`

> 在幕后，WebSecurity 类与 ASP.NET 成员资格提供程序交互，后者依次执行执行安全任务所需的较低级别的工作。ASP.NET 网页中的默认成员资格提供程序是 SimpleMembershipProvider 类。

# opengl - GLSL如何确保最大可能的浮点值而不会溢出

> ID：16069959
> 
> 赞同：8
> 
> 时间：2013-04-17T20:46:22.073
> 
> 标签：opengl, floating-point, overflow, glsl

据我了解，GLSL 中没有 FLT_MAX 类型常量。

有什么方法可以确保浮点数代表最大可能值而不会溢出？

编辑：

因为有人问我用这个做什么：

我基本上将一个点扩展到“无穷大”。它用于 2D 阴影投射，在这里我完全重塑了 GPU 上的三角形条形阴影。因为我一次只能控制处理一个顶点，所以 w 组件存储它是留在船体上还是投影到无穷大。

如果两个“阴影边界”点是同一边，并且光线几乎与该边共线，我需要确保三角形仍然覆盖整个屏幕。它很难描述。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-11-10T14:31:09.327

在 GLSL 中，IEEE 754 无穷大可以方便地通过除以零来实现：

```
float infinity = 1.0 / 0.0; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-11-29T00:25:52.497

GLSL 使用 IEEE 754 浮点定义`float`：

> 作为处理单元之一的输入值，单精度或双精度浮点变量应与精度和动态范围的相应 IEEE 754 浮点定义相匹配。着色器中的浮点变量也根据 IEEE 754 规范对单精度浮点值进行编码（逻辑上，不一定是物理上）。虽然编码在逻辑上是 IEEE 754，但运算（加法、乘法等）不一定按照 IEEE 754 的要求执行。

最大可表示的[浮点值为](https://en.wikipedia.org/wiki/Single-precision_floating-point_format)(1 − 2^-24) × 2^128

## 典型的最大浮点值

因此，您可以使用它（取自[Microsoft 的 float.h](https://msdn.microsoft.com/en-us/library/6bs3y5ya.aspx)）

```
#define FLT_MAX 3.402823466e+38
#define FLT_MIN 1.175494351e-38
#define DBL_MAX 1.7976931348623158e+308
#define DBL_MIN 2.2250738585072014e-308 
```

## 精确的最大浮点值

此外，由于最大浮点值是

```
7f7f ffff = 0 11111110 11111111111111111111111 = 2139095039 
```

这是获得确切最大值的另一种有趣方法：

```
float fMaxFloat = intBitsToFloat(2139095039); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-18T08:38:39.867

是的，根据 4.1.4 中的[GLSL 语言规范](http://www.opengl.org/registry/doc/GLSLangSpec.4.20.11.clean.pdf)，它们是标准的 IEEE 754 数据类型。我想缺少 FLT_MAX 仅仅是因为有不同的长度可用：单精度（float）、双精度（double），有时甚至是半精度。您可以使用正无穷和负无穷，或者如果您需要有限的最大值/最小值，则可以使用浮点中可用的最高数字。如果您搜索stackoverflow，很容易找到确切的模式。

# delphi - 如何从派生类访问隐藏成员？

> ID：16069964
> 
> 赞同：1
> 
> 时间：2013-04-17T20:46:44.510
> 
> 标签：delphi, variables, scope, superclass

我有两个类，一个派生自另一个。这些类都引入了同名的变量。派生类中的变量隐藏了超类中的变量。

如何从派生类的方法中引用超类的变量？

```
type
  TClass1 = class
  protected
    FMyVar: Integer;
  end;

  TClass2 = class(TClass1)
  protected
    FMyVar: Integer;
  public
    procedure Foo;
  end;

procedure TClass2.Foo;
begin
  //here I want access to FMyVar from TClass1
end; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T20:49:05.057

没有什么特别的。每个子类都会自动访问其父类中的内容，但在父类中标记的成员除外`private`。

在与其父级相同的单元中声明的子类可以访问标记为 的成员`private`。`strict private`相反，使用它可以*真正*防止子类访问其继承的成员。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T21:20:57.683

您可以通过演员获得访问权限：

```
procedure TClass2.Foo;
begin
  DoSomething(TClass1(Self).FMyVar);
end; 
```

作为旁注，我建议您重新考虑您的设计。您所走的道路会导致混乱和错误。

# mysql - 如何在 3 个表上执行 SQL JOIN？

> ID：16069972
> 
> 赞同：0
> 
> 时间：2013-04-17T20:47:20.233
> 
> 标签：mysql, sql

我正在使用 MySQL，我试图从三个不同的表中获取数据，但不确定我应该使用的语法。

我有一个名为 full_daily_data_1 的表，其中包含以下字段 Symbol Trade_Date Day_Open Day_High

我还有一个名为 custom_indices_xref 的表，其中包含以下字段：符号 Custom_Index_Name

还有一个名为 daily_index_weightings 的表，其中包含以下字段： Custom_Index_Name Symbol Trade_date combo_weighting

现在，我把它作为一个选择语句来从两个表中获取我需要的数据：

```
SELECT 
    Symbol, 
    Trade_Date, 
    Day_Open, 
    Day_High
FROM 
    full_daily_data_1 
WHERE 
    trade_date >= '2012/01/01' AND
    trade_date <= '2012/01/31' AND 
    symbol in (SELECT symbol from custom_indices_xref WHERE Custom_Index_Name = 'Agricultural-Chemical-and-Fertilizer-Stocks'); 
```

但我想要的是日期范围符号 Day_Open Day_High, Custom_Index_Name Symbol Trade_date combo_weighting 中每个日期的每个符号的以下数据

所以基本上，需要从daily_index_weightings 表中为选定的日期和符号添加combo_weighting。我的 SQL 语句应该是什么样子才能完成这个？

我试过这个，但我得到一个 SQL 语法错误，所以不确定我做错了什么：

```
SELECT 
    full_daily_data_1.Symbol, 
    full_daily_data_1.Trade_Date,
    full_daily_data_1.Day_Open, 
    full_daily_data_1.Day_High,
    full_daily_data_1.Day_Low,
    daily_index_weightings.combo_weighting
FROM 
    full_daily_data_1
WHERE 
    trade_date >= '2012/01/01' AND  
    trade_date <= '2012/01/31' AND 
    Symbol in (SELECT symbol from custom_indices_xref WHERE Custom_Index_Name = 'Agricultural-Chemical-and-Fertilizer-Stocks')
JOIN 
    daily_index_weightings ON 
        daily_index_weightings.symbol = full_daily_data_1.Symbol AND 
        daily_index_weightings.Trade_Date = full_daily_data_1.Trade_Date ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:50:42.600

```
 SELECT fdd.Symbol, fdd.Trade_Date, fdd.Day_Open, fdd.Day_High, fdd.Day_Low, diw.combo_weighting 
 FROM full_daily_data_1 fdd 
 INNER JOIN custom_indicies_xref cix ON fdd.symbol=cix.symbol 
 INNER JOIN daily_index_weighings diw ON fdd.symbol = diw.symbol
 WHERE 
 trade_date >= '2012/01/01' AND  
 trade_date <= '2012/01/31' AND 
 cix.Custom_Index_Name = 'Agricultural-Chemical-and-Fertilizer-Stocks' 
```

如果需要，可以将 INNER JOINS 更改为 LEFT JOIN。

或者，由于您的第二个和第三个表也匹配 Custom_Index_Name 字段（顺便说一句，这是糟糕的设计）：

```
 SELECT fdd.Symbol, fdd.Trade_Date, fdd.Day_Open, fdd.Day_High, fdd.Day_Low, diw.combo_weighting  
 FROM full_daily_data_1 fdd 
 INNER JOIN (custom_indicies_xref cix ON fdd.symbol=cix.symbol 
      INNER JOIN daily_index_weighings diw ON cix.Custom_Index_Name = diw.Custom_Index_Name)
 ON fdd.symbol = cix.symbol
 WHERE 
 trade_date >= '2012/01/01' AND  
 trade_date <= '2012/01/31' AND 
 cix.Custom_Index_Name = 'Agricultural-Chemical-and-Fertilizer-Stocks' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:59:18.733

您的 sql 子句是乱序的，您应该为表名使用别名，这样更容易阅读。我注意到的另一件事是您在 WHERE 子句中的字段不明确。

```
SELECT 
    FDD.Symbol, 
    FDD.Trade_Date,
    FDD.Day_Open, 
    FDD.Day_High,
    FDD.Day_Low,
    DIW.combo_weighting
FROM 
    full_daily_data_1 FDD
JOIN 
    daily_index_weightings DIW ON 
        DIW.symbol = FDD.Symbol AND 
        DIW.Trade_Date = FDD.Trade_Date ; 
WHERE 
    FDD.trade_date >= '2012/01/01' AND  
    FDD.trade_date <= '2012/01/31' AND 
    FDD.Symbol in 
    (SELECT symbol from custom_indices_xref WHERE Custom_Index_Name = 'Agricultural-Chemical-and-Fertilizer-Stocks') 
```

# java - Jasypt 加密字符串无法在另一台机器上解密

> ID：16069974
> 
> 赞同：1
> 
> 时间：2013-04-17T20:47:27.453
> 
> 标签：java, encryption, salt, jasypt

我们的安全部门希望我们使用 256 位加密来加密 SSN、用户名等，因此我们决定使用 JASYPT，示例代码如下：

```
encryptor = new StandardPBEStringEncryptor();
encryptor.setProvider(new BouncyCastleProvider());
encryptor.setAlgorithm("PBEWITHSHA256AND256BITAES-CBC-BC");
encryptor.setPassword(OUR_KEY)
encryptor.encrypt("TEXT TO ECNCRYPT") 
```

我们注意到的问题是，当我们的应用程序从本地计算机创建加密记录时，app-dev 服务器上的应用程序无法解密它，反之亦然，即使密钥相同。似乎 JASYPT 正在盐中添加一些特定于机器的信息（Mac 地址等）。

即使使用`FixedStringSaltGenerator`或`ZeroSaltGenerator`没有帮助。这给我们带来了一个问题，因为如果我们曾经将生产服务器迁移到另一台机器，或者使用产品数据刷新生产前数据，我们可能需要几百万年才能恢复信息。

安全部门希望我们使用众所周知的库，而不是自己制定解决方案。有人可以就这个问题说明一下我们如何生成可以使用 jasypt 256 位加密在不同机器上解密的加密字符串，或者当我们用产品数据刷新 pre-prod 数据库时，我们如何能够恢复名称等通过不同的服务器加密？

任何有用的见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-03-28T01:39:05.780

您的密钥可能包含一些特殊字符，这些字符可以用其他东西代替。执行 echo "yourkey" > file 并检查该文件的内容。然后使用这个内容作为密钥来解密；它应该能够解密加密的字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-07T17:48:18.237

我知道这是一个很老的问题，但我最近遇到了这个问题，我的解决方案与机器操作系统字节序的差异无关。

它与密码本身中的一个字符有关，即美元符号字符 ($)，它在某种程度上被认为是 Linux 中的特殊字符，而不是 Windows 中的特殊字符。因此，在 Windows 中加密值一切正常，但是当我切换到 Linux 并尝试使用 jasypt 命令行 decrypt.sh 脚本使用相同的密码解密值时，我收到错误消息“无法操作（输入错误或参数）”，并注意到 jasypt 解密输出参数列表中的密码与我输入的密码不同（脚本显然从特殊字符中删除了密码部分，直到密码字符串的结尾）。

无论如何，我的解决方案是将密码更改为不使用特殊字符，然后它就起作用了。希望这对将来碰巧遇到同样问题的一些可怜的灵魂有所帮助，因为我在这上面浪费了 2 天时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-15T10:39:05.870

使用单引号而不是双引号来包装您的输入字符串。当我在使用 $ 加密和解密字符串时遇到问题时，此解决方案有效。

# .net - Visual basic：使用 OR 进行变量赋值

> ID：16069976
> 
> 赞同：4
> 
> 时间：2013-04-17T20:47:32.197
> 
> 标签：.net, vb.net, active-directory, bit-manipulation, bit

我不明白 OR 语句在此代码示例中的作用。

```
DE.Properties("UserAccountControl").Value = CInt(DE.Properties("UserAccountControl").Value) Or AccountOptionsEnum.UF_ACCOUNTDISABLE 
```

DE.Properties("UserAccountControl").Value 表示小数。

枚举是整数。

我知道这是用于停用 Active Directory 中的用户的代码，但我不明白“OR”在这里是如何工作的。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T20:57:30.627

[*或者*](http://msdn.microsoft.com/en-us/library/06s37a7f.aspx)是按位运算。`C = A or B`确保设置 C 中的所有位，这些位在 A*或*B

例子：

```
 01001001
or 00011000
   --------
   01011001 
```

`AccountOptionsEnum.UF_ACCOUNTDISABLE`可能是形式的值`2^x`，这意味着只设置了一个位。让我们假设它是右边的第四位：

```
00001000   = UF_ACCOUNTDISABLE 
```

该操作`X = X or UF_ACCOUNTDISABLE`确保在 X 中设置了第四位。如果之前已设置，则不会发生任何变化：

```
 00011100 old X
or 00001000 UF_ACCOUNTDISABLE
   --------
   00011100 new X 
```

如果尚未设置，则会设置：

```
 00010100 old X
or 00001000 UF_ACCOUNTDISABLE
   --------
   00011100 new X 
```

* * *

基本上，通常使用以下按位运算：

```
X = X or FLAG         ' sets FLAG in X
X = X and not FLAG    ' removes FLAG from X
X = X xor FLAG        ' toggles FLAG in X
if (X and FLAG) <> 0  ' checks if FLAG is set in X 
```

# c++ - 如何在并行编程中收集从从站返回到主站的值？

> ID：16069978
> 
> 赞同：0
> 
> 时间：2013-04-17T20:47:38.830
> 
> 标签：c++, c, multithreading, parallel-processing

我试图找到一种适当的方法来收集从并行编程中从从站返回到主站的值。我之前曾问过[类似](https://stackoverflow.com/questions/16050254/how-to-divide-each-pixel-calculation-of-mandelbrot-into-different-nodes)的问题，关于如何划分工作来计算曼德布洛特的像素。我得到了如何发送作品的答案，但仍在努力研究如何收集数据并将其绘制为像素。

节点 0：（主）

节点1：（从）

```
v[0]  = {2,3,4,5,67,86,56,5} // core 0 holds value of 8 threads of this core
v[1]  = {12,21,4,3,54,65,6,5,4} // core 1 holds value of 9 threads of this core
v[2]  = {1,3,4,54,6,5,65,7,4}  //core 2 holds value of 9 threads of this core 
```

节点2：（奴隶）

```
v[0]  = {2,3,4,5,67,86,56,5} // core 0
v[1]  = {12,21,4,3,54,65,6,5,4} // core 1 
v[2]  = {1,3,4,54,6,5,65,7,4}  //core 2 
```

节点3：（奴隶）

```
v[0]  = {2,3,4,5,67,86,56,5} // core 0
v[1]  = {12,21,4,3,54,65,6,5,4} // core 1 
v[2]  = {1,3,4,54,6,5,65,7,4}  //core 2 
```

所以当主人想要这些值时，奴隶应该附加向量并发送还是有其他更好的方法将值传递给主人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:24:33.667

如果您使用的是 C++11 线程库（或 Boost.Thread），那么您可能想要的是[`std::future`](http://en.cppreference.com/w/cpp/thread/future). 它们可以通过以下三种方式之一获得：

1.  通过将 a 传递[`std::promise`](http://en.cppreference.com/w/cpp/thread/promise)给线程并让它设置值。
2.  通过使用[`std::packaged_task`](http://en.cppreference.com/w/cpp/thread/packaged_task).
3.  通过调用[`std::async`](http://en.cppreference.com/w/cpp/thread/async).

这是一个使用示例`std::async`：

```
some_return_type my_work_function( some_input_type const & );

some_input_type inputs_to_slave_threads[] = { /* ... */ };

std::future< some_return_type >
  // launch the slaves, letting the OS decide whether to spawn new threads
  slave_0_future = std::async( my_work_function, std::ref( inputs_to_slave_threads[0] ) ),
  slave_1_future = std::async( my_work_function, std::ref( inputs_to_slave_threads[1] ) ),
  // ...
  slave_N_future = std::async( my_work_function, std::ref( inputs_to_slave_threads[N] ) );

some_return_type
  // block until results are ready
  result_of_slave_0 = slave_0_future.get(),
  result_of_slave_1 = slave_1_future.get(),
  // ...
  result_of_slave_N = slave_N_future.get();

process_results_of_slaves( result_of_slave_0, ..., result_of_slave_N ); 
```

# validation - Dom上的Jquery验证不显示消息

> ID：16069983
> 
> 赞同：0
> 
> 时间：2013-04-17T20:48:08.483
> 
> 标签：validation, jquery, dom, jquery-validate

我偶然发现了一些具有 jQuery 验证的代码，该验证是在将项目添加到 DOM 的 ajax 调用之后触发的。验证正在运行，但消息丢失。只是该字段被突出显示。我已经玩了一段时间来让它工作，但到目前为止还没有运气。任何想法，想法表示赞赏。

```
 $('#add-other-income-link').click(function (event) {
    event.preventDefault();
    var otherIncomesCount = $('#numberOfNewOtherIncomes').val();
    $('div[hideCorner = yep]').show();

    var url = $(this).attr('href');
    if (url) {
        $.ajax({
            url: url,
            type: 'GET',
            dataType: 'html',
            success: function (data) {
                $('#additional-other-income').append(data);

                var count = otherIncomesCount;

                var id = 0;
                $('#additional-other-income').find('table.other-income-table').each(function (i, item) {
                    id = $(item).find('input.other-income-id');
                    var additionalIncomeTypeIdLabel = $(item).find('label.other-income-type-id-label');
                    var amountLabel = $(item).find('label.other-income-amount-label');
                    var additionalIncomeTypeIdMenu = $(item).find('select.other-income-type-id');
                    var amountTextBox = $(item).find('input.other-income-amount');

                    var idIndexer = 'OtherIncome_' + count + '__';
                    var nameIndexer = 'OtherIncome[' + count + '].';
                    var indexer = '[' + i + ']';
                    id.attr('id', idIndexer + 'Id').attr('name', nameIndexer + 'Id');
                    additionalIncomeTypeIdLabel.attr('for', idIndexer + 'AdditionalIncomeTypeId');
                    amountLabel.attr('for', idIndexer + 'Amount');
                    additionalIncomeTypeIdMenu.attr('id', idIndexer + 'AdditionalIncomeTypeId').attr('name', nameIndexer + 'AdditionalIncomeTypeId');
                    amountTextBox.attr('id', idIndexer + 'Amount').attr('name', nameIndexer + 'Amount').attr('data-val', 'true');

                    ++count;

                    addOtherIncomeValidation(item);
                }); 
```

*对于 AdditionalIncomeTypeIDMenu 上的required*和amountTextBox 上的 required 和 positive 验证均成功，但两者的*消息*均未*显示*：

 **```
function addOtherIncomeValidation(container) {
if (container) {
    var additionalIncomeTypeIdMenu = $(container).find('select.other-income-type-id');
    var amountTextBox = $(container).find('input.other-income-amount');

    $(additionalIncomeTypeIdMenu).rules('add', {
        required: true,
        messages: {
            required: 'Please select an income type'
        }
    });

    $(amountTextBox).rules('add', {
        required: true,
        positive: true,
        messages: { positive: 'must be positive number'

        }
    });
}
} 
```

顺便说一句，ajax 调用在此处返回部分 EditorTemplate，您可以看到它使用了 ValidationMessageFor。

```
<div class="other-income" style="margin-bottom: 10px;">
<table class="other-income-table">
    <tr>
        <td>
            @Html.HiddenFor(x => x.Id, new { @class = "other-income-id" })
            @Html.LabelFor(x => x.AdditionalIncomeTypeId, "Type:", new { @class = "other-income-type-id-label" })
            <br />@Html.ValidationMessageFor(x => x.AdditionalIncomeTypeId)
        </td>
        <td>
            @Html.LabelFor(x => x.Amount, "Amount:", new { @class = "other-income-amount-label" })
            <br />@Html.ValidationMessageFor(x => x.Amount)
        </td>
        <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
        <td>@Html.DropDownListFor(x => x.AdditionalIncomeTypeId, new SelectList(Model.AdditionalIncomeTypes, "Value", "Text", Model.AdditionalIncomeTypeId), "--- Select One ---", new { @class = "other-income-type-id" })</td>
        <td>
            @Html.EditorFor(x => x.Amount, "Money", new { AdditionalClasses = "other-income-amount" })
        </td>
        <td>
            @{
                int? otherIncomeId = null;
                var removeOtherIncomeLinkClasses = "remove-other-income-link";
                if (Model.Id == 0)
                {
                    removeOtherIncomeLinkClasses += " new-other-income";
                }
                else
                {
                    otherIncomeId = Model.Id;
                }
            }
            @Html.ActionLink("Remove", "RemoveOtherIncome", "Applicant", new { applicationId = Model.ApplicationId, otherIncomeId = otherIncomeId }, new { @class = removeOtherIncomeLinkClasses })<img class="hide spinner" src="@Url.Content("~/Content/Images/ajax-loader_16x16.gif")" alt="Deleting..." style="margin-left: 5px;" />
        </td>
    </tr>
</table> 
```

HTML：

```
 <div id="OtherIncome" class="applicant-section">

<h2 class="header2">Other Income</h2>
<div class="cornerForm">

<div class="other-income" style="margin-bottom: 10px;">
    <table class="other-income-table">
        <tr>
            <td>
                <input class="other-income-id" data-val="true" data-val-number="The field Id must be a number." id="OtherIncome_0__Id" name="OtherIncome[0].Id" type="hidden" value="385" />
                <label class="other-income-type-id-label" for="OtherIncome_0__AdditionalIncomeTypeId">Type:</label>
                <br /><span class="field-validation-valid" data-valmsg-for="OtherIncome[0].AdditionalIncomeTypeId" data-valmsg-replace="true"></span>
            </td>
            <td>
                <label class="other-income-amount-label" for="OtherIncome_0__Amount">Amount:</label>
                <br /><span class="field-validation-valid" data-valmsg-for="OtherIncome[0].Amount" data-valmsg-replace="true"></span>
            </td>
            <td>&nbsp;&nbsp;</td>
        </tr>
        <tr>
            <td><select class="other-income-type-id" data-val="true" data-val-number="The field AdditionalIncomeTypeId must be a number." id="OtherIncome_0__AdditionalIncomeTypeId" name="OtherIncome[0].AdditionalIncomeTypeId"><option value="">--- Select One ---</option>
<option value="1">Alimony</option>
<option value="2">Child Support</option>
<option value="3">Disability</option>
<option value="4">Investments</option>
<option selected="selected" value="5">Rental Income</option>
<option value="6">Retirement</option>
<option value="7">Secondary Employment</option>
<option value="8">Separate Maintenance</option>
</select></td>
            <td>

<input class="money other-income-amount" data-val="true" data-val-number="The field Amount must be a number." id="OtherIncome_0__Amount" name="OtherIncome[0].Amount" style="" type="text" value="0.00" />
            </td>
            <td>
                <a class="remove-other-income-link" href="/Applicant/RemoveOtherIncome/XNxxxxx753/385">Remove</a><img class="hide spinner" src="/Content/Images/ajax-loader_16x16.gif" alt="Deleting..." style="margin-left: 5px;" />
            </td>
        </tr>
    </table>

</div>
<div class="other-income" style="margin-bottom: 10px;">
    <table class="other-income-table">
        <tr>
            <td>
                <input class="other-income-id" data-val="true" data-val-number="The field Id must be a number." id="OtherIncome_1__Id" name="OtherIncome[1].Id" type="hidden" value="412" />
                <label class="other-income-type-id-label" for="OtherIncome_1__AdditionalIncomeTypeId">Type:</label>
                <br /><span class="field-validation-valid" data-valmsg-for="OtherIncome[1].AdditionalIncomeTypeId" data-valmsg-replace="true"></span>
            </td>
            <td>
                <label class="other-income-amount-label" for="OtherIncome_1__Amount">Amount:</label>
                <br /><span class="field-validation-valid" data-valmsg-for="OtherIncome[1].Amount" data-valmsg-replace="true"></span>
            </td>
            <td>&nbsp;&nbsp;</td>
        </tr>
        <tr>
            <td><select class="other-income-type-id" data-val="true" data-val-number="The field AdditionalIncomeTypeId must be a number." id="OtherIncome_1__AdditionalIncomeTypeId" name="OtherIncome[1].AdditionalIncomeTypeId"><option value="">--- Select One ---</option>
<option selected="selected" value="1">Alimony</option>
<option value="2">Child Support</option>
<option value="3">Disability</option>
<option value="4">Investments</option>
<option value="5">Rental Income</option>
<option value="6">Retirement</option>
<option value="7">Secondary Employment</option>
<option value="8">Separate Maintenance</option>
</select></td>
            <td>

<input class="money other-income-amount" data-val="true" data-val-number="The field Amount must be a number." id="OtherIncome_1__Amount" name="OtherIncome[1].Amount" style="" type="text" value="22.00" />
            </td>
            <td>
                <a class="remove-other-income-link" href="/Applicant/RemoveOtherIncome/XN42093753/412">Remove</a><img class="hide spinner" src="/Content/Images/ajax-loader_16x16.gif" alt="Deleting..." style="margin-left: 5px;" />
            </td>
        </tr>
    </table>

</div>

    <div id="additional-other-income"></div>

    <input id="numberOfNewOtherIncomes" name="numberOfNewOtherIncomes" type="hidden" value="0" />
    <input data-val="true" data-val-number="The field OriginalOtherIncomeTotal must be a number." id="OriginalOtherIncomeTotal" name="OriginalOtherIncomeTotal" type="hidden" value="22.0000" />
    <a class="editable-link" href="/Applicant/AddOtherIncome?appId=XNxxxxx753" id="add-other-income-link">Add Other Income</a>
</div>        </div> 
```

验证码：

```
$.validator.addMethod('positive', function(value, element) {
var check = true;
if (value < 0) {
    check = false;
}
return this.optional(element) || check;
}, "Value must be a positive number."
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T16:51:52.073

I didn't think I would find my own answer but I did. first I have to apologize for my response to @Sparky with his request for *rendered* HTML. I did a "View page source" but that didn't include all the stuff which was added from the ajax call after the server delivered it's stuff. I suspect if I did include the extra DOM stuff at first, you would have pinpointed the issue sooner. My bad. Now on to the answer.

It appears that when injecting an EditorTemplate into the DOM in the way shown above, it doesn't properly process the page like you would expect in MVC. The code for @Html.ValidationMessageFor simply does not get parsed AT ALL. I am a little new to validation as you can see so I don't know why it behaves this way. To solve my problem here is what I did:

I updated my Editor Template slightly to look like this:

```
<div class="other-income" style="margin-bottom: 10px;">
<table class="other-income-table">
    <tr>
        <td>
            @Html.HiddenFor(x => x.Id, new { @class = "other-income-id" })
            @Html.LabelFor(x => x.AdditionalIncomeTypeId, "Type:", new { @class = "other-income-type-id-label" })
          <br />
            @Html.ValidationMessageFor(x=>x.AdditionalIncomeTypeId)
            <span id="AdditionalIncomeTypeIdValidation"></span>
        </td>
        <td>
            @Html.LabelFor(x => x.Amount, "Amount:", new { @class = "other-income-amount-label" })
            <br />
            @Html.ValidationMessageFor(x=>x.Amount)
            <span id="amountValidation"></span>
         </td>
        <td>&nbsp;&nbsp;</td>
    </tr>
    <tr>
        <td>@Html.DropDownListFor(x => x.AdditionalIncomeTypeId, new SelectList(Model.AdditionalIncomeTypes, "Value", "Text", Model.AdditionalIncomeTypeId), "--- Select One ---", new { @class = "other-income-type-id" })</td>
        <td>
            @Html.EditorFor(x => x.Amount, "Money", new { AdditionalClasses = "other-income-amount" })
        </td>
        <td>
            @{
                int? otherIncomeId = null;
                var removeOtherIncomeLinkClasses = "remove-other-income-link";
                if (Model.Id == 0)
                {
                    removeOtherIncomeLinkClasses += " new-other-income";
                }
                else
                {
                    otherIncomeId = Model.Id;
                }
            }
            @Html.ActionLink("Remove", "RemoveOtherIncome", "Applicant", new { applicationId = Model.ApplicationId, otherIncomeId = otherIncomeId }, new { @class = removeOtherIncomeLinkClasses })<img class="hide spinner" src="@Url.Content("~/Content/Images/ajax-loader_16x16.gif")" alt="Deleting..." style="margin-left: 5px;" />
        </td>
    </tr>
</table> 
```

Notice the new span tags, which is are added next to the @Html.ValidationMessageFor.

then in my success function from the ajax call in javascript I made these changes:

```
 $('#add-other-income-link').click(function (event) {
        event.preventDefault();
        var count = $('#numberOfNewOtherIncomes').val();
        $('div[hideCorner = yep]').show();

        var url = $(this).attr('href');
        if (url) {
            $.ajax({
                url: url,
                type: 'GET',
                dataType: 'html',
                success: function (data) {
                    $('#additional-other-income').append(data);

                    var id = 0;
                    $('#additional-other-income').find('table.other-income-table').each(function (i, item) {
                        id = $(item).find('input.other-income-id');
                        var additionalIncomeTypeIdLabel = $(item).find('label.other-income-type-id-label');

                        var amountLabel = $(item).find('label.other-income-amount-label');
                        var additionalIncomeTypeIdMenu = $(item).find('select.other-income-type-id');
                        var amountTextBox = $(item).find('input.other-income-amount');
                        var amountValidation = $(item).find('#amountValidation');
                        var typeIdValidation = $(item).find('#AdditionalIncomeTypeIdValidation');

                        var idIndexer = 'OtherIncome_' + count + '__';
                        var nameIndexer = 'OtherIncome[' + count + '].';
                        var indexer = '[' + i + ']';
                        amountValidation.attr('class', 'field-validation-valid')
                                        .attr('data-valmsg-for', nameIndexer + 'Amount')
                                        .attr('data-valmsg-replace','true');
                        typeIdValidation.attr('class', 'field-validation-valid')
                                        .attr('data-valmsg-for', nameIndexer + 'AdditionalIncomeTypeId')
                                        .attr('data-valmsg-replace','true');
                        id.attr('id', idIndexer + 'Id').attr('name', nameIndexer + 'Id');
                        additionalIncomeTypeIdLabel.attr('for', idIndexer + 'AdditionalIncomeTypeId');
                        amountLabel.attr('for', idIndexer + 'Amount');
                        additionalIncomeTypeIdMenu.attr('id', idIndexer + 'AdditionalIncomeTypeId').attr('name', nameIndexer + 'AdditionalIncomeTypeId');
                        amountTextBox.attr('id', idIndexer + 'Amount').attr('name', nameIndexer + 'Amount').attr('data-val', 'true');

                        ++count;

                        addOtherIncomeValidation(item); 
```

notice I am manually adding in the missing validation spans that were not rendering. Now the validation message shows up at validation! Yay. I am not sure however that this is the best fix. It looks and smells like a hack, but I got it to work. I am sure it can be done a better way. Thanks again for interaction and feedback.**

# jquery - 如何随着输入范围的每一步更改 div 背景颜色？

> ID：16069985
> 
> 赞同：-2
> 
> 时间：2013-04-17T20:48:13.597
> 
> 标签：jquery, html, input, native

我想为输入类型范围内的每个步骤（最多 10-15 个）定义一种颜色。并且在每一步更改时，div 都会更改其背景颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:52:47.460

`.css()`接受两个参数或一个映射`{}`；

```
$('.slider').change(function() {
    var green = this.value(2);
    $('.bar').css("background-color", "#ff0000");
}); 
```

当然，这不会改变每次幻灯片更改的背景颜色。但是您可能会自己弄清楚。你的 CSS 函数是固定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T20:53:37.590

您可以将处理程序绑定到输入元素的更改事件，并使用`switch`结构来决定显示哪种颜色。

```
$("input[type='range']").change(function(e) {
    var value = $(e.target).val();
    switch(value) {
        case "1":
            $("div").css({backgroundColor: "#AABBCC"});
            break;
        case "2":
            //and so on
    }
}); 
```

如果您需要对每个值执行其他任何操作，这可能会很有用。但是，如果您所做的只是更改背景颜色，则可以只使用数组查找：

```
var colors = ["#AABBCC", "#BBCCDD", "#CCDDEE", ...];
$("div").css({backgroundColor: colors[value]}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T21:08:42.000

不能真正理解你的问题，但这里是一个尝试：[jsfiddle](http://jsfiddle.net/AL2tK/) 输入一些东西并移至下一个......尝试删除......

**CSS：**

```
.done_class
{
background-color:green;    
-webkit-transition: all 0.3s ease;
-moz-transition: all 0.3s ease;
-o-transition: all 0.3s ease;
transition: all 0.3s ease;    
}
.def_class
{
   margin:5px;
   width:100px;
   height:50px;
   border:1px solid grey;
-webkit-transition: all 0.3s ease;
-moz-transition: all 0.3s ease;
-o-transition: all 0.3s ease;
transition: all 0.3s ease;   
} 
```

**HTML：**

```
<input type='text' class='change1' id='target1' />
<input type='text' class='change1' id='target2' />
<input type='text' class='change1' id='target3' />
<input type='text' class='change1' id='target4' />
            <br /><br />
<div id='target1' class='def_class' >target 1</div>
<div id='target2' class='def_class'>target 2</div>
<div id='target3' class='def_class'>target 3</div>
<div id='target4' class='def_class'>target 4</div> 
```

**脚本：**

```
('.change1').change(function(){
var id_change = $(this).attr('id');
var change_val = $(this).val();
if(change_val!='') {
$('div[id=' + id_change + ']').addClass('done_class').text(change_val);
} else {
$('div[id=' + id_change + ']').removeClass('done_class').text('target' + id_change);
}
}); 
```

非常简单 - 但效果很好......

# template-engine - 玉模板引擎 - 定义新的运营商

> ID：16069986
> 
> 赞同：0
> 
> 时间：2013-04-17T20:48:14.427
> 
> 标签：template-engine, emmet

是否可以使用玉定义新的运算符？

类似于[emmet](https://github.com/emmetio/emmet)中的缩写。

我想定义类似的东西

```
 k=v 
```

成为

```
<op key="k" value="v"/> 
```

和

```
k eq 1 
```

成为

```
<find value="k = 1"/> 
```

（虽然我喜欢 zencoding / emmet 我有时觉得它太简洁了。）

如果不是翡翠，也许类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:52:25.240

不，Emmet 不支持自定义运算符。而且，对于您的示例，它需要完全不同的解析器，您可能必须自己编写。

但是，您可以利用 Emmet 语法来创建类似的东西。例如，使用此*代码段定义*：

```
"op": "<op key=\"${id}\" value=\"${class}\" />" 
```

您可以扩展`op#k.v`缩写以获得所需的结果。

# c# - 透明代理 - 从端口 80 到 443

> ID：16069987
> 
> 赞同：2
> 
> 时间：2013-04-17T20:48:15.047
> 
> 标签：c#, http, https, proxy, transparent

我正在尝试开发一个透明代理，它将来自客户端的不安全 http 流量作为安全的 https 流量转发到服务器，然后再返回。为了更好地说明我的观点，请看下图。

![丰富的图片](https://i.stack.imgur.com/m2ifm.png)

假设由于各种原因客户端将仅使用 HTTP，它们不能将端口 443 用于 HTTPS。由于某些服务器不接受来自端口 80 的流量，因此我的代理需要将它们重新路由到端口 443。这是一种可能的情况：

1.  从客户端接收数据，这些数据指向 www.google.com 的端口 80
2.  初始化与[https://www.google.com](https://www.google.com)到端口 443 的连接（握手等）
3.  加密来自客户端的数据并将它们发送到[https://www.google.com](https://www.google.com)到端口 443。
4.  [从https://www.google.com](https://www.google.com)接收响应，解密它们并将它们发送回客户端到端口 80。

由于这是一个透明代理，因此客户端（在我的情况下是很多客户端）不需要任何额外的配置。网络已经配置好，以便他们的流量通过我的节点。目前，我的节点只是重新路由数据并阻止一些数据（如果它们包含病毒）。这是使用[WinPcap](http://www.winpcap.org/)访问低网络层完成的，但如果使用原始数据包（主要关注握手）太难完成，我愿意改变我的方法。

**我试过的：** 注意：www.google.com 可以是网络上的任何站点。它仅用作示例。

1.  铱星的建议。这不起作用，因为 TcpListener 仅在另一个应用程序使用 TcpClient 连接到它时才接受新连接。由于这是一个透明代理，它不起作用。
2.  改为使用 HttpListener。但是，这似乎不起作用，因为它只接受到我自己的 IP（而不是 www.google.com）的连接。
3.  像以前一样使用 HttpListener 但这次我将数据包转发到我自己的 IP，以便 HttpListener 接受连接。由于某种原因，这似乎不起作用（通过wireshark和TCP SYN数据包检查不断重新发送，不知道为什么或如何修复它）。
4.  使用 SslStream 连接到[https://www.google.com](https://www.google.com)，然后从客户端收到的原始数据包中获取内容并将它们写入流。这不起作用，因为 SslStream 自己处理 TCP 数据包（如 ACK 或 SYN）。流只需要 Http 请求。它不起作用的另一个原因是因为我无法从流中读取 TCP 数据包的内容，只能读取 HTTP 响应的内容（因此客户端坐在那里等待 ACK）。
5.  将 TCP 数据包从客户端原样转发到端口 443，从服务器转发到端口 80（因为只有 HTTP 请求和响应使用 SSL 加密，所以没有区别）并使用 HttpRequest 类发出所有 http 请求和响应（因为类自己处理握手）。这不起作用，因为双方的 ACK 都是错误的。

开发这种代理的最佳方法是什么？

编辑：有什么方法可以让 TcpListener 或 HttpListener 充当透明代理？（无需在客户计算机上进行配置）。HttpListener 究竟何时能够识别出客户端正在尝试连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T15:42:06.117

我真的不明白为什么你需要从`SslStream`. 如果我正确阅读了您的描述，您应该只需要：

*   等待客户端连接
*   当客户端连接时，连接到服务器
*   将服务器连接包装`NetworkStream`在一个`SslStream`和中`AuthenticateAsClient`
*   一旦通过身份验证，并行：
    *   从客户端读取数据并将其写入`SslStream`
    *   从客户端读取数据`SslStream`并将其写入客户端

在此过程中，我看不到您需要从`SslStream`.

以下是一个非常基本的示例（尽管完全未经测试）：

```
static void Main(string[] args)
{
    var listener = new TcpListener(IPAddress.Any, 11180);
    var clientConnection = listener.AcceptTcpClient();
    // When we get here, the client has connected, initiate the server connection
    var serverConnection = new TcpClient("your.server.name", 443);
    var serverStream = serverConnection.GetStream();
    var secureStream = new SslStream(serverStream);
    secureStream.AuthenticateAsClient("your.server.name");
    ConnectStreams(clientConnection.GetStream(), secureStream);
}

private static void ConnectStreams(Stream streamA, Stream streamB)
{
    ForwardStream(streamA, streamB, new byte[1024]);
    ForwardStream(streamB, streamA, new byte[1024]);
}

private static void ForwardStream(Stream source, Stream destination, byte[] buffer)
{
    source.BeginRead(buffer, 0, buffer.Length, r => Forward(source, destination, r, buffer), null);
}

private static void Forward(Stream source, Stream destination, IAsyncResult asyncResult, byte[] buffer)
{
    var bytesRead = source.EndRead(asyncResult);
    if (bytesRead == 0)
    {
        destination.Close();
        return;
    }
    destination.Write(buffer, 0, bytesRead);
    ForwardStream(source, destination, buffer);
} 
```

# asp.net - 即使在调试模式下，在 WebForms 中使用包也会输出缩小/组合的文件

> ID：16069989
> 
> 赞同：6
> 
> 时间：2013-04-17T20:48:21.240
> 
> 标签：asp.net, vb.net, webforms, web-optimization

我创建了一堆我想组合/缩小在一起的各种脚本文件。在我的文件后面的代码中（是的，对不起，它在 VB 中！）我将它添加到`<asp:placeholder />`这样`<head>`的

```
Me.PlhHeader.Controls.Add(New LiteralControl(Scripts.Render("~/bundles/main").ToHtmlString())) 
```

这会起作用，但它似乎总是输出压缩的缩小版本，即使`debug="true"`在 Web.Config 中也是如此。

无论如何，这就是输出：`<script src="/bundles/main"></script>`

在调试模式下，我需要做些什么来使这个输出成为单独的未压缩文件？

* * *

**编辑**

我还尝试手动设置该选项`BundleTable.EnableOptimizations = false`，它*仍然*输出单个缩小的脚本标签。我没主意了。

* * *

# 最终编辑

我用一些相关的代码做了一些非常愚蠢的事情，但从技术上讲，捆绑包的一切都很好并且工作正常。问题为我解决了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T01:44:53.227

我建议您安装 Microsoft.AspNet.WebOptimization.WebForms。它真的很好用。

[Microsoft.AspNet.WebOptimization.WebForms](http://nuget.org/packages/Microsoft.AspNet.Web.Optimization.WebForms/)

然后你可以使用：

```
<%: System.Web.Optimization.Scripts.Render("~/bundles/main") %> 
```

# jquery - 图像在 iPad 上不可见：覆盖 css 属性？

> ID：16069990
> 
> 赞同：0
> 
> 时间：2013-04-17T20:48:21.520
> 
> 标签：jquery, css, ipad

在我的 webapp 中，当使用 css 打开地图 div 时，屏幕上会添加一个按钮：

```
 background: url("../img/btn-map-fullscreen.png") no-repeat scroll 0 0;   / cover transparent; 
```

我不熟悉 '/cover transparent' 语法（这部分是别人写的）...

...但实际上，该按钮在 Chrome、FF 甚至 IE 中按预期显示...但该按钮在 iPad 上不可见。功能仍然存在；该按钮存在但不可见。

如果我只删除 ' / cover transparent ' ...然后这些按钮在 iPad（和我的桌面浏览器）上是可见的，但看起来不连贯，而且不正确。

我尝试了一些组合，但我还没有弄清楚如何使这些按钮在 iPad 上以与在我的桌面上一样的方式可见..想法？

我正在使用 JQuery 顺便说一句...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:53:21.720

您发布的代码使用[CSS 3 背景速记](http://dev.opera.com/static/dstorey/backgrounds/background-shorthand.html)并且`cover`是该[`background-size`](http://www.w3.org/TR/css3-background/#background-size)属性的值。简写还包括`background-origin`and`background-clip`属性。但是，我认为它在 iOS 中尚不支持，因此您应该尝试将其分开：

```
.class {
background-image: url("../img/btn-map-fullscreen.png");
background-repeat: no-repeat;
background-attachment: scroll;
background-size: cover;
background-color: transparent;
} 
```

# c# - HtmlAgilityPack 和 php 标签

> ID：16069991
> 
> 赞同：0
> 
> 时间：2013-04-17T20:48:25.203
> 
> 标签：c#, php, tags, html-agility-pack

我正在尝试使用 HtmlAgilityPack 制作、更改并保存文档。但是如果一个文档包含 php-tags，它们会在尝试保存时出错。正则表达式不想用，有很多坑。这个问题有什么优雅的解决方案吗？

代码：

```
var Doc = new HtmlAgilityPack.HtmlDocument();
Doc.DetectEncodingAndLoad("page.html");
.............
string Result = Doc.DocumentNode.OuterHtml; 
```

资源：

```
<html>
<?php echo "hello"; ?>
</html> 
```

结果：

```
<html>
<?php echo="" "hello";=""?>
</html> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T07:52:50.783

今天不支持它，但是如果您更改源代码并重新编译，您可以修复它（毕竟，这就是开源的用途......）。转到 HtmlNode.cs，找到该`internal void WriteAttributes(TextWriter outText, bool closing)`函数，然后添加以下代码：

```
internal void WriteAttributes(TextWriter outText, bool closing)
{
    if (Name.StartsWith("?"))
    {
        int len = _outerlength - 3 - _namelength;
        if (len > 0)
        {
            outText.Write(OwnerDocument.Text.Substring(_namestartindex + _namelength, len));
            return;
        }
    }
    ....
} 
```

# c# - C# 可空数组

> ID：16069997
> 
> 赞同：15
> 
> 时间：2013-04-17T20:48:44.990
> 
> 标签：c#, arrays, nullable

我有一个搜索功能，但我想`LocationID`成为一个整数数组，而不仅仅是一个整数。我不确定如何执行此操作，因为我希望它也可以为空。我已经看过了，`int?[]`但是我必须检查`HasValue`每个条目。有没有更好的办法？

这是我目前拥有的：

```
public ActionResult Search(string? SearchString, int? LocationId,
    DateTime? StartDate,  DateTime? EndDate) 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-17T20:50:24.273

数组始终是引用类型，`string`因此它们*已经*可以为空。您只需要使用（并且只能*使用*）`Nullable<T>`其中 T 是不可为空的值类型。

所以你可能想要：

```
public ActionResult Search(string searchString, int[] locationIds,
                           DateTime? startDate,  DateTime? endDate) 
```

请注意，我已更改您的参数名称以遵循 .NET 命名约定，并更改`LocationId`为`locationIds`表示它适用于多个位置。

您可能还想考虑将参数类型更改为`IList<int>`甚至`IEnumerable<int>`更通用，例如

```
public ActionResult Search(string searchString, IList<int> locationIds,
                           DateTime? startDate,  DateTime? endDate) 
```

这样，调用者就可以传入一个`List<int>`例子。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-17T20:49:53.770

数组是引用类型，所以你不需要做任何事情，你已经可以通过`null`：

可以使用所有参数调用具有以下签名的方法`null`：

```
public ActionResult Search(string SearchString, int[] LocationIds,
                           DateTime? StartDate, DateTime? EndDate)

foo.Search(null, null, null, null); 
```

请注意：我还删除了之后的问号，`string`因为它也是一个引用类型。

# php - CakePHP：如何在视图中使用 Controller::referer()

> ID：16069998
> 
> 赞同：5
> 
> 时间：2013-04-17T20:48:44.983
> 
> 标签：php, cakephp, cakephp-2.0

我收到以下错误：

```
Strict (2048): Non-static method Controller::referer() should not be called statically,
assuming $this from incompatible context [APP/View/Questions/admin_edit.ctp, line 20] 
```

原因如下：

```
//in app/View/Questions/admin_edit.ctp
echo $this->Html->link('Cancel', Controller::referer() ); 
```

为什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-17T20:50:06.370

你没有。您改为使用请求对象：

```
$this->request->referer(); 
```

控制器在内部不做任何其他事情。

小心：referer 可以为空，因此在这种情况下您可能希望在此处提供后备。

另请注意可选参数 $local：

`@param boolean $local If true, restrict referring URLs to local server`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-25T09:58:39.360

```
$referer_url = $this->referer('/', true); // you will get like (without base URL) "/users/profile"
$refererController = Router::parse($referer_url); // this will return $referer_url as array which contains 

Array ( 
   [controller] => users 
   [action] => profile 
} 
```

如果有人在您使用时遇到任何错误，`Router::parse($referer_url)`请在您的控制器中添加 cakephp 路由

```
use Cake\Routing\Router; 
```