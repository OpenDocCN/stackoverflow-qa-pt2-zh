# StackOverflow 问答 15283000-15283999

# actionscript-3 - 当mc击中mc时触发音效！闪存 AS3

> ID：15283006
> 
> 赞同：0
> 
> 时间：2013-03-07T22:26:48.520
> 
> 标签：actionscript-3, flash, triggers

我有两个 mc，我希望这个 mc 击中另一个 mc，然后它会发出一声巨响。我该怎么做？我也将使用键盘事件来配合它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:45:11.240

1.  创建一个新的 Flash ActionScript 3 文档。得救。

2.  将您的声音名称`boom.mp3`放在同一目录中。

3.  在舞台上绘制一个正方形并将其转换为影片剪辑符号。

4.  在舞台上总共放置 2 个此影片剪辑元件的实例。

5.  调出 Actions 面板并添加以下代码。

代码如下，只需将鼠标拖动到mc1和mc2碰撞时播放声音即可。是与声音播放的基本碰撞。

* * *

```
import flash.media.Sound;
import flash.events.MouseEvent;
import flash.net.URLRequest;

mc1.addEventListener(MouseEvent.MOUSE_DOWN, drag);
stage.addEventListener(MouseEvent.MOUSE_UP, drop);
var sound:Sound=new Sound();
sound.load(new URLRequest("boom.mp3"));

function drag(e:MouseEvent):void
{
    mc1.startDrag();
}

function drop(e:MouseEvent):void
{
    mc1.stopDrag();

    if (mc1.hitTestObject(mc2))
    {
        trace("Collision detected!");
        sound.play(0);
    }
    else
    {
        trace("No collision.");
    }
} 
```

如果你想使用 KeyboardEvent 试试这个：

```
function playIsCollision(char:DisplayObject, target:DisplayObject):void
{
    if(char.hitTestObject(target))
    {
        sound.play(0);
    }
}

stage.addEventListener(KeyboardEvent.KEY_DOWN, keyDownHandler);

function keyDownHandler(e:KeyboardEvent):void
{
    if(e.keyCode == Keyboard.RIGHT)
    {
        trace("right move");
        mc1.x += 1;
        playIsCollision(mc1,mc2);
    }
    else if(e.keyCode == Keyboard.LEFT)
    {
        trace("left move");
        mc1.x -= 1;
        playIsCollision(mc1,mc2);
    }
    else if(e.keyCode == Keyboard.UP)
    {
        trace("up move");
        mc1.y -= 1;
        playIsCollision(mc1,mc2);
    }
    else if(e.keyCode == Keyboard.DOWN)
    {
        trace("down move");
        mc1.y += 1;
        playIsCollision(mc1,mc2);
    }
} 
```

这是我的代码：[碰撞](http://www.fileswap.com/dl/178Sk8J3wr/)

# excel - 使用用户窗体删除行

> ID：15283007
> 
> 赞同：1
> 
> 时间：2013-03-07T22:26:55.733
> 
> 标签：excel, vba

我已经建立了一个简单`UserForm`的`Combobox`按名称删除行。

*   我已经`Combobox`使用宏填充了行源来构建一个名为“Combo_List”的命名范围。我将它静态地插入到 rowsource 属性中（意思是，我没有用代码这样做）。
*   还有`UserForm`一个`Checkbox`我想用于*确认*目的的。
*   一旦他们从列表中选择了用户名，他们需要检查，`Checkbox`然后他们可以单击删除按钮。

我不知道如何编写验证`Checkbox`然后删除所选行的代码。

如果有帮助，这里是构建命名范围的代码，然后显示`UserForm`：

```
Sub RecordDelete()

Dim LastRow As Long
ActiveSheet.Select

LastRow = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row 
Range("B3:B" & LastRow).Name = "Combo_List" 
frmDeleteData.Show

End Sub 
```

该复选框仅命名为“checkbox1”。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:45:33.663

一种方法是

1.  `Enabled`将删除的默认属性设置`CommandButton`为`False`设计模式
2.  将代码添加到`CheckBox`启用`CommandButton`时`Checkbox`
3.  将代码添加到删除`CommandButton`以删除整行

**代码**

```
Private Sub CheckBox1_Click()
 CommandButton1.Enabled = CheckBox1.Value
End Sub

Private Sub CommandButton1_Click()
    Dim rng1 As Range
    If Me.CheckBox1 Then
        Set rng1 = Range("Combo_List").Find(Me.ComboBox1.Value, , xlValues, xlWhole)
        If Not rng1 Is Nothing Then
            rng1.EntireRow.Delete
        Else
            MsgBox Me.ComboBox1.Value & "not found"
        End If
    Else
    `redundant if button is disabled
        MsgBox "Checkbox not checked!", vbCritical
    End If
End Sub 
```

# java - 如何将对象添加到链表中？

> ID：15283009
> 
> 赞同：4
> 
> 时间：2013-03-07T22:26:59.227
> 
> 标签：java, linked-list, doubly-linked-list

我一直在做一个项目，我必须实现一个 java 类来实现双向链表的使用。我用我所有的方法完成了 LinkedList 类。我只是不确定如何将节点对象实际添加到列表中。到目前为止，这是我的代码，底部有测试。任何帮助，将不胜感激。谢谢

```
public class LinkedList {

    private Node first;
    private Node current;
    private Node last;
    private int currentIndex;
    private int numElements;

    public LinkedList() {
        this.first = null;
        this.last = null;
        this.numElements = 0;
        this.current = null;
        this.currentIndex = -1;
    }

    private class Node {

        Node next;
        Node previous;
        Object data;
    }

    public boolean hasNext() {
        return (current != null && current.next != null);
    }

    public Object next() {
        if (!this.hasNext()) {
            throw new IllegalStateException("No next");
        }

        current = current.next;
        return current.data;

    }

    public boolean hasPrevious() {
        return (current != null && current.previous != null);

    }

    public Object previous() {
        if (!this.hasPrevious()) {
            throw new IllegalStateException("No previous");
        }
        current = current.previous;
        return current.data;

    }

   int nextIndex() {
        int index = numElements;
        if (hasNext()) {
            index = this.currentIndex + 1;
        }
        System.out.println(index + "The current index is " + current);
        return index;
    }

    int previousIndex() {
        int index = -1;
        if (hasPrevious()) {
            index = this.currentIndex - 1;
        }
        System.out.println(index + "The current index is " + current);
        return index;
    }

    public void set(Object o) {
        if (this.current == null) {
            throw new IllegalStateException("No node found, cannot set.");
        }
        current.data = o;
    }

    public int size() {
        return numElements;
    }

    public void add(Object o) {       
        Node newNode = new Node();
        newNode.data = o;
        if (first == null) {
            first = newNode;
            last = newNode;
            newNode.next = null;

        } else if (first != null) {
            if (current == null) {
                newNode.previous = null;
                newNode.next = first;
                first.previous = newNode;
                first = newNode;
            } else if (current == last) {
                newNode.previous = current;
                newNode.next = null;
                current.next = newNode;
                last = newNode;
            } else {
                newNode.previous = current;
                newNode.next = current.next;
                current.next.previous = newNode;
                current.next = newNode;
            }
        }
        current = newNode;
        numElements++;
        currentIndex++;

    }

    public void remove() {
        if (current != null) {
            if (current == first && current == last) {
                first = null;
                last = null;
            } else if (current == last) {
                current.previous = null;
                last = current.previous;
            } else if (current == last) {
                current.previous.next = null;
                last = current.previous;
            } else {
                current.previous.next = current.next;
                current.next.previous = current.previous;
            }
            current = current.next;
            numElements--;
        }
    }
}

import java.util.Scanner;

public class LinkedListTest {
    public static void main(String[] args) {
        Scanner keyboard = new Scanner(System.in);
        String name;
        int index;

        LinkedList<Object> listOne = new LinkedList<Object>();

        listOne.add(object o);

    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:55:21.867

发布的类 LinkedList 对我来说看起来很实用。

确保您的测试代码不会混淆`java.util.LinkedList`Java 为您提供的此类和 （它是现有 Collections 框架的一部分）。

为清楚起见，我建议将您的课程重命名为`MyLinkedList`

以下代码有效，输出为“0”，“2”：

```
public class MyLinkedListTest {

    public static final void main(String[] args) {

        MyLinkedList list = new MyLinkedList();
        System.out.println("Number of items in the list: " + list.size());

        String item1 = "foo";
        String item2 = "bar";

        list.add(item1);
        list.add(item2);

        System.out.println("Number of items in the list: " + list.size());      

        // and so on...
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T22:34:37.953

如果您的代码已编译，我会感到惊讶，因为您的类实际上不是通用的。只需将其初始化为`LinkedList listOne = new LinkedList();`（无尖括号）。

至于实际添加元素，您只需要添加一些的*实例*`Object`即可；任何事情都会做（假设您的内部代码正常工作）。在最后尝试一下：

```
Object objectToAdd = "Strings are Objects";
listOne.add(objectToAdd);
objectToAdd = new File("C:\\foo.bar"); // Or use any other Objects!
listOne.add(objectToAdd); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T22:37:51.960

您`LinkedList`没有泛型类型，因此您不能将其声明为

```
LinkedList<Object> listOne = new LinkedList<Object>(); 
```

而是作为

```
LinkedList listOne = new LinkedList(); 
```

现在添加元素只需使用您的`add`方法

```
listOne.add("something");
listOne.add(1);//int will be autoboxed to Integer objects 
```

* * *

此外，如果您想从键盘添加数据，您可以使用类似

```
String line="";
do{
    System.out.println("type what you want to add to list:");
    line = keyboard.nextLine();
    listOne.add(line);
}while(!line.equals("exit")); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-07T22:34:21.480

考虑编号列表并查看元素之间的关系

说我有清单：

1.  一个
2.  乙
3.  C

我必须对关系做什么才能得到列表：

1.  一个
2.  乙
3.  新节点
4.  C

B的新下一个节点是NewNode C的新的前一个节点是NewNode。因此，插入函数会想知道紧邻的前一个节点或紧邻的下一个节点，然后调整关系。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T22:41:12.963

线

`LinkedList<Object> listOne = new LinkedList<Object>();`

除非您将类声明更改为

`class LinkedList<T>`

或者你也可以写

`LinkedList listOne = new LinkedLis();`

之后，您应该能够将对象添加到列表中。但是，您需要创建一个对象来添加到它，`listOne.add(object o);`不会这样做 - 至少您必须编写`listOne.add(new Object())`. （您的代码没有实例化 Object，没有您已经调用过的 Object，`o`此外，`object o`在 Java 中没有任何意义，也不会编译。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-07T22:42:00.900

正如人们所提到的，您的列表并不通用。但是，由于他们建议您摆脱该参数，您也可以将`<Object>`或添加`<E>`到您的链表实现中，并保持列表的初始化不变。

因此，在您的链表类中，您应该执行以下操作：

```
public class LinkedList<E> 
```

这将确保您在使用时`LinkedList<Object> listOne = new LinkedList<Object>();`，`E`将被确认为`Object`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-07T22:47:24.973

让我们稍微改进一下您的测试，以便您的问题出在哪里（如果有的话）我注释掉了对 current() 方法的调用，因为您没有包含一个。（我会不理会它，因为它可能会让您感到困惑。）一般的想法是将项目添加到链接列表中，并在它中前后移动，检查每一步的项目。

```
public class LinkedListTest {
    public static void main(String[] args) {
        Scanner keyboard = new Scanner(System.in);
        String name;
        int index;

        LinkedList listOne = new LinkedList();
        //Initially we should be empty so we are positioned
        // at both the beginning and end of the list
        assert listOne.size() == 0 :"List should be empty";
        assert listOne.hasPrevious()==false: "Should be at the beginning of the list";
        assert listOne.hasNext()==false : "Should be at the end of the list";

        Object firstNode = "I am the first node";
        listOne.add(firstNode); //we've added something
//I left this commented out since you don't have a current() method.
//        assert firstNode == listOne.current() : "Our current item should be what we just added";
        assert listOne.hasPrevious()==false : "Should not have moved forward in our list yet";
        assert listOne.hasNext()==true : "should have an item after our current";
        assert listOne.size() == 1 : "Should only have one item in the list";
        Object secondNode = "I am the second node";
        listOne.add(secondNode);
        assert listOne.size() == 2 : "Should only have two items in the list";

        assert firstNode == listOne.next() : "1st call to next should return the 1st node";
        assert listOne.hasPrevious()==true : "We should be positioned after the 1st node";
        assert listOne.hasNext()==true : "We should be positioned before the 2nd node";
    }
} 
```

# javascript - JavaScript 任务

> ID：15283012
> 
> 赞同：-1
> 
> 时间：2013-03-07T22:27:12.643
> 
> 标签：javascript

我一直在学习 JavaScript，并且一直在做一些我在大学时完成的任务。任务是这样的：

> 制作一个网页，其中将出现 3 张 200x150 图像和 1 张 600x450 图像。添加 JavaScript 函数，这将确保显示的 600x450 图像将是 200x150 图像的放大图像，我们之前用鼠标指向该图像（使用 onMouseOver 调用该函数）。

第二个任务是这样的：

> 以某种方式完成任务1中的网页，当单击较小的图像时，我们单击的同一图像的较大图像将出现在一个新窗口中。

第一个任务的代码如下所示：

```
function bigImg(x)    
{
    x.style.height="600px";
    x.style.width="450px";
}

function normalImg(x)
{
    x.style.height="200px";
    x.style.width="150px";
}

...

<img onmouseover="bigImg(this)" onmouseout="normalImg(this)" border="0" src="slika1.jpg" alt="slika1" width="150" height="200">
<img src="slika2.jpg">
<img src="slika3.jpg"> 
```

对于第二个这样的：

```
function swipe() 
{
    var largeImage = document.getElementById('Slika1');
    largeImage.style.display = 'block';
    largeImage.style.width=450+"px";

    // enter code here

    var url=largeImage.getAttribute('src');
    window.open(url,'Image','width=largeImage.style.width,height=largeImage.style.height,resizable=1');
}

...

<img src="slika1.jpg" id= "Slika1" onClick="swipe();"/>
<img src="slika2.jpg">
<img src="slika3.jpg"> 
```

应该做些什么不同的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T22:58:39.910

```
<script>
function swipe(image) 
{
    newWidth=450+"px";
    newHeight=600+"px";

    var url=image.getAttribute('src');
    myWindow=window.open('','Image','width='+newWidth+',height='+newHeight+',resizable=1');
    myWindow.document.write('<img src="'+url+'" width="'+newWidth+'" height="'+newHeight+'" />');
}
</script>

<img src="slika1.jpg" onClick="swipe(this);"/>
<img src="slika2.jpg" onClick="swipe(this);"/>
<img src="slika3.jpg" onClick="swipe(this);"/> 
```

回答原海报的几个问题：

这里window.open()函数中的第一个参数是''（空字符串），基本上是创建一个空白网页。该函数调用的返回值是新打开的网页（赋值给变量myWindow）。然后深入到该窗口对象并调用它的 document.write() 函数来实际显示所需的 HTML（图像）。在您的原始代码中，您只是打开一个浏览到图像文件（而不是 HTML 页面）的窗口。既然是这种情况，您就无法实际设置图像的宽度或高度——您只是在设置（或尝试）窗口的宽度和高度。设置窗口的宽度和高度甚至在您的示例代码中都不起作用，因为您没有将变量从字符串中分离出来。于是在窗外。

> 宽度=450 像素，高度=600 像素，调整大小=1

但你实际上通过的是：

> 宽度=largeImage.style.width,height=largeImage.style.height,resizable=1

我们创建的 swipe() 函数接受一个参数“image”。当我们从 img 标签内的 onClick 事件调用这个函数时，我们使用关键字“this”来传递自身的引用。本质上，调用 swipe() 的 img 对象的副本作为参数传入。因此在函数中，image.getAttribute('src') 引用了调用它的 img 对象的“src”属性，您需要在打开的窗口中显示该属性。

# javascript - 如何使用 document.referrer 获取 url 的各个部分？

> ID：15283013
> 
> 赞同：4
> 
> 时间：2013-03-07T22:27:13.110
> 
> 标签：javascript

我需要用来`document.referrer`获取以前的 URL 我还需要能够获取 URL 的各个部分，例如：

```
window.location.protocol
window.location.host
window.location.pathname 
```

但我无法弄清楚如何使用`document.referrer`. 有人有什么想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-08T00:03:26.173

您可以创建一个以引用者为 url 的元素。

一个元素（带有href）可以像位置对象一样

```
var a=document.createElement('a');
a.href=document.referrer;
alert([a.protocol,a.host,a.pathname].join('\n'));
a=''; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-07T22:33:24.430

没有等同于`window.location`的，`document.referrer`所以你唯一的选择就是分解字符串本身。您可以编写一个正则表达式来执行此操作或依赖一系列字符串拆分：

```
var parts = document.referrer.split('://')[1].split('/');
var protocol = document.referrer.split('://')[0];
var host = parts[0];
var pathName = parts.slice(1).join('/'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T22:43:05.753

如果您想要方便并且负担得起重量，请查看[URI.js](http://medialize.github.com/URI.js/)或建议的[URL 解析器](https://github.com/medialize/URI.js#url-parsers)之一。如果你不需要任何花哨的东西，[`<a>`s href 分解](https://stackoverflow.com/a/3213643/515124)就可以完成这项工作。

# ant - NetBeans 7 corbetura 显示 0% 的覆盖率

> ID：15283017
> 
> 赞同：0
> 
> 时间：2013-03-07T22:27:31.283
> 
> 标签：ant, code-coverage, netbeans-7, junit4, cobertura

我将 Cobertura 1.9.4 与 NetBeans 7.2.1、Ant 1.8.3 和 JDK 1.7.0_05 与 JUnit 4.10 一起使用。

我的 HTML 覆盖率报告正在生成，但它们都列出了 0% 的单元测试覆盖率。这不应该是这种情况，因为我的单元测试涵盖了我的整个 util 类。

有趣的是，如果我通过更改在测试路径中包含检测类，我的所有单元测试都会开始失败

```
run.test.classpath=\
    ${javac.test.classpath}:\
    ${build.test.classes.dir} 
```

至

```
run.test.classpath=\
    ${build.instrumented.dir}:\
    ${javac.test.classpath}:\
    ${build.test.classes.dir} 
```

此外，如果我打开 emma 代码覆盖工具，我所有的测试用例也会中断。

注意：有一个几乎相同的帖子[Cobertura 显示 0% 的覆盖率](https://stackoverflow.com/questions/3692354/cobertura-showing-0-coverage)，但由于它没有得到答复，稍微过时并且我的配置不同，我想我会在这里捕获我的设置。这里有两个类似于我的配置的参考：1) [cobertura pdf](http://wiki.netbeans.org/wiki/images/4/4a/Cobertura.pdf) 2) [NetBeans CoberaturaAnt Wiki](http://wiki.netbeans.org/CoberturaAnt)

从我的**build.xml中截取**

```
<!-- this strangely doesn't work so i'm temporarily using hardcoded path below
<taskdef classpath="cobertura.jar"  resource="tasks.properties" />
 -->

<path id="cobertura.class.path">
    <pathelement location="libs/cobertura.jar" />
    <pathelement location="libs/asm-3.0.jar" />
    <pathelement location="libs/asm-tree-3.0.jar" />
    <pathelement location="libs/log4j-1.2.9.jar" />
    <pathelement location="libs/jakarta-oro-2.0.8.jar" />
</path>
<taskdef resource="tasks.properties" classpathref="cobertura.class.path" />

<target depends="-init-check,init" name="-init-check-cobertura">
    <fail unless="build.classes.dir">Must set build.classes.dir</fail>
</target>

<target name="-post-compile" depends="-init-check-cobertura,init">
    <delete dir="${build.instrumented.dir}" />
    <delete dir="${build.test.coverage.dir}" />
    <mkdir dir="${build.instrumented.dir}" />
    <mkdir dir="${build.test.coverage.dir}" />
    <cobertura-instrument todir="${build.instrumented.dir}" 
                          datafile="${build.dir}/cobertura.ser">
        <fileset dir="${build.classes.dir}">
            <include name="**/*.class"/>
        </fileset>
    </cobertura-instrument>
</target>

<target name="coverage-report" depends="test">
    <cobertura-report format="html" destdir="${build.test.coverage.dir}"
                                    datafile="${build.dir}/cobertura.ser"/>
    <delete file="${build.dir}/cobertura.ser" />
    <delete dir="${build.instrumented.dir}" />
</target> 
```

我还在我的**project.properties**文件中定义了这些

```
build.instrumented.dir=${build.dir}/instrumented
build.test.coverage.dir=${build.dir}/test/coverage 
```

仅供参考，我已经尝试将这些添加到我在 build-impl.xml 中的标签中。仍然是零覆盖。

```
<jvmarg value="-Dcobertura.use.java.nio=false"/>
<jvmarg value="-Dnet.sourceforge.cobertura.datafile=${basedir}/cobertura.ser"/> 
```

ant 测试目标来自 netbeans 生成的 build-impl.xml 文件

```
<target depends="init,compile-test,-pre-test-run,-do-test-run,test-report,-post-test-run,-test-browse" 
     description="Run unit tests." name="test"/> 
```

# android - 如何设置多个AlarmManager？

> ID：15283019
> 
> 赞同：3
> 
> 时间：2013-03-07T22:27:46.210
> 
> 标签：android, alarmmanager, alarm

我有一个应用程序需要在一周中的多天设置警报，具体取决于用户设置它们的日期。我让它在适当的时间触发警报的地方工作，但我想知道如何在不覆盖当前警报管理器的情况下执行多个操作。例如，这是我的测试代码：

```
final int alarmid = (int)System.currentTimeMillis();    //creates unique id for the alarm attached to the object
tempmainfrag.mainObjectList.returnSchedule(i).setAlarmId(alarmid);
for(int j = 0; j < 7; j++)
        {
            if(tempmainfrag.mainObjectList.returnSchedule(i).returnDays()[j])   //if this day of the week has an alarm
            {
                int adjustedday = j+2;  //makes time for DAY_OF_WEEK where sunday = 1, monday = 2, etc.
                if (adjustedday == 8)
                    adjustedday = 1;

                Calendar startcal = Calendar.getInstance();
                startcal.set(Calendar.DAY_OF_WEEK, adjustedday);
                startcal.set(Calendar.HOUR_OF_DAY, tempmainfrag.mainObjectList.returnSchedule(i).returnTimes()[0]);
                startcal.set(Calendar.MINUTE, tempmainfrag.mainObjectList.returnSchedule(i).returnTimes()[1]);
                startcal.set(Calendar.SECOND, 0);
                Log.i("mydebug","Starting cal day of week: " + adjustedday);
                Log.i("mydebug","Starting cal hour of day: " + tempmainfrag.mainObjectList.returnSchedule(i).returnTimes()[0]);
                Log.i("mydebug","Starting minute: " + tempmainfrag.mainObjectList.returnSchedule(i).returnTimes()[1]);
                Intent intent = new Intent(this, SilenceHandler.class);
                intent.putExtra("starttime",tempmainfrag.mainObjectList.returnSchedule(i));
                intent.putExtra("alarm_message", "Test!");  //FOR TESTING
                PendingIntent pendintent = PendingIntent.getBroadcast(this, alarmid, intent, PendingIntent.FLAG_UPDATE_CURRENT);
                AlarmManager alarmman = (AlarmManager)getSystemService(ALARM_SERVICE);
                alarmman.setRepeating(AlarmManager.RTC_WAKEUP, startcal.getTimeInMillis(), AlarmManager.INTERVAL_DAY * 7, pendintent);
//              startcal.set(Calendar.MINUTE, (tempmainfrag.mainObjectList.returnSchedule(i).returnTimes()[1])+1);
//              alarmman.setRepeating(AlarmManager.RTC_WAKEUP, startcal.getTimeInMillis(), AlarmManager.INTERVAL_DAY * 7, pendintent);
            }
        } 
```

for 循环遍历一周中的几天，并在每次迭代时检查是否应该为那一天设置警报。这段代码有效（大概），但是为了测试我是否可以在它上面设置另一个警报，我在此处注释掉的最后两行代码中添加了。这会使警报在一分钟后响起，但也不会提前一分钟。我这样做是为了证明，如果我希望此代码在一周中的多天工作，那么当前设置代码的方式将只为返回 true 的一周的最后一天设置警报。我怎样才能发出多个警报？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T22:34:56.550

问题是，尽管您正在为您的 创建一个唯一 ID `PendingIntent`，这将设置单独的警报，但在您的测试中，您正在重复使用相同的`PendingIntent`，这将覆盖您以前的。`PendingIntent`用不同的方法创建一个新的`alarmid`来测试它。

# wordpress - 在没有编辑器支持的情况下将媒体附加到帖子类型

> ID：15283026
> 
> 赞同：0
> 
> 时间：2013-03-07T22:28:01.170
> 
> 标签：wordpress, custom-post-type, meta-boxes

我正在尝试将附件添加到没有编辑器支持的自定义帖子类型（仅摘录）。

我已经设法显示了媒体管理器对话框，但我只能看到“插入帖子”按钮（无论如何它什么都不做），并且在上传图像时，它们不会附加到帖子中。

为了实现我到目前为止所做的事情，我在帖子类型中添加了一个非常简单的元框：

```
function add_gallery_post_media_meta_box()
{

    add_meta_box(
        'gallery_post_media',
        'Gallery Media',
        'gallery_post_media',
        'gallery',
        'side',
        'high'
    );

} // add_file_meta_box
add_action('add_meta_boxes', 'add_gallery_post_media_meta_box');

function gallery_post_media()
{

    echo '<a href="#" id="gallery-add-media" title="' . __('Add media') .'">' . __('Add media') .'</a>';

} // end post_media

function register_admin_scripts() {
    wp_enqueue_media();
    wp_register_script( 'gallery_post_media_admin_script', get_template_directory_uri() . '/library/cpt/gallery.js' );
    wp_enqueue_script( 'gallery_post_media_admin_script' );

} // end register_scripts
add_action( 'admin_enqueue_scripts', 'register_admin_scripts' ); 
```

和脚本：

```
jQuery(document).ready(function ($) {
    $('#gallery-add-media').click(function (e) {
        var send_attachment_bkp = wp.media.editor.send.attachment;
        var button = $(this);
        var id = button.attr('id').replace('_button', '');
        wp.media.editor.send.attachment = function (props, attachment) {
            $("#" + id).val(attachment.url);
            wp.media.editor.send.attachment = send_attachment_bkp;
        }

        wp.media.editor.open(button);
        event.preventDefault();
        return false;
    });
}); 
```

如果我能找到一些关于 的文档`wp.media.editor.send.attachment`，我可能会设法得到我想要的，但我找不到任何有用的东西。我发现的唯一解决方案都依赖于自定义字段，相反，我只想将这些图像附加到帖子中，而不像处理普通帖子那样将它们插入帖子内容中。

作为一个附带问题：是否可以告诉媒体管理器只接受图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-03T22:14:09.943

这是我用于媒体字段的 JavaScript。一旦你点击插入，你就可以对所选图像中的数据做任何你想做的事情

```
jQuery(document).ready(function() {
   //uploading files variable
   var custom_file_frame;
   jQuery(document).on('click', '.meida-manager', function(event) {
      event.preventDefault();
      $this = jQuery(this);
      //If the frame already exists, reopen it
      if (typeof(custom_file_frame)!=="undefined") {
         custom_file_frame.close();
      }

      //Create WP media frame.
      custom_file_frame = wp.media.frames.customHeader = wp.media({
         //Title of media manager frame
         title: "Sample title of WP Media Uploader Frame",
         library: {
            type: 'image'
         },
         button: {
            //Button text
            text: "insert text"
         },
         //Do not allow multiple files, if you want multiple, set true
         multiple: false
      });

      //callback for selected image
      custom_file_frame.on('select', function() {
         var attachment = custom_file_frame.state().get('selection').first().toJSON();
         //do something with attachment variable, for example attachment.filename
         //Object:
         //attachment.alt - image alt
         //attachment.author - author id
         //attachment.caption
         //attachment.dateFormatted - date of image uploaded
         //attachment.description
         //attachment.editLink - edit link of media
         //attachment.filename
         //attachment.height
         //attachment.icon - don't know WTF?))
         //attachment.id - id of attachment
         //attachment.link - public link of attachment, for example ""http://site.com/?attachment_id=115""
         //attachment.menuOrder
         //attachment.mime - mime type, for example image/jpeg"
         //attachment.name - name of attachment file, for example "my-image"
         //attachment.status - usual is "inherit"
         //attachment.subtype - "jpeg" if is "jpg"
         //attachment.title
         //attachment.type - "image"
         //attachment.uploadedTo
         //attachment.url - http url of image, for example "http://site.com/wp-content/uploads/2012/12/my-image.jpg"
         //attachment.width
         $this.val(attachment.url);
         $this.siblings('img').attr('src',attachment.url);
      });

      //Open modal
      custom_file_frame.open();
   });
}); 
```

# extjs - Sencha - store.each() - 数据不可用，它们只在数据类的深处

> ID：15283033
> 
> 赞同：2
> 
> 时间：2013-03-07T22:28:36.877
> 
> 标签：extjs

我有：

```
Ext.define("catcher.view.Login", {
   extend: "Ext.form.Panel",
// creating login form, including selectfield 
```

商店“锦标赛”是在商店中创建的 (autoload:true)，有它的模型。一切都设置好了。需要动态填充selectfield（还在view.Login类中）：

```
initialize: function(){
        var store = Ext.getStore("Tournaments");        
        var options = new Array();
        store.each(function(radek){
            options[radek.get("tournament_id")] = radek.get("tournament_name");
        });
    } 
```

我不想使用`store:"Tournaments"`配置选项，因为后来 form.submit(); 不从 发送正确的数据`selectfield`。

**有问题：** `console.log(store.getCount());`返回 0。使用`store.add({ ... })`我可以添加任何东西，getCount() 返回正确的计数 (0 + add())。

奇怪的部分：`console.log(store)`返回整个类，包括`data`包含所有项目的对象。下一个奇怪的部分 - 如果我在控制器中使用相同的代码，一切正常，存储正确加载，我可以使用 mystore.each();

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T23:05:34.000

商店加载是异步的，当您访问它时，它还没有加载。您需要监听商店加载事件。

就像是：

```
store.on('load', function(storeRef, records, successful){
    //Loop through records
}, this); 
```

[on() 文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.JsonStore-method-on)

[加载事件文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.JsonStore-event-load)

# c++ - 特定的随机数发生器

> ID：15283035
> 
> 赞同：0
> 
> 时间：2013-03-07T22:28:41.553
> 
> 标签：c++, random, numbers

我需要在特定范围之间生成数字，如果数字不适合，则在第一个周期之后，我需要将其从范围中删除。

例子：

> 我将从 [1-55] 范围内生成随机数。我想要数字 24，但通过随机生成器生成。在第一个周期随机生成器生成数字 4 之后。在下一个周期中，我想从相同范围内生成随机数，但不包括数字 4。所以范围是 - [1,54] / {4}。如果在下一个周期中生成了 28 号，则范围将更改为 - [1,54] /{4,28}。循环将重复，直到没有生成数字 24。

我的进化算法需要它。如果我使用大范围，通过随机数生成算法生成所需的数字需要很长时间。我将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:36:39.283

从包含完整范围的数组开始：

```
int range[55];
std::iota(range, range+55, 1); 
```

开始`n = 55`。

现在，在每一步：

*   `i`从`0`to 中选择一个随机数`n-1`
*   `range[i]`与交换`range[n-1]`。
*   递减`n`

如果您选择的索引处的值为 24，那么您就完成了。在 24 之前选择的值位于数组的右侧，其余未选择的值位于左侧。

我当然假设您需要知道这些值。如果您只需要生成值，`24`那么`int generate24() { return 24;}`应该这样做。如果您只需要知道生成 24 需要多少步，那么它会均匀分布在 to 的范围内`1`，`55`因此您可以通过生成单个随机数来伪造它。

# javascript - HTML5画布如何给它一个边界？

> ID：15283038
> 
> 赞同：0
> 
> 时间：2013-03-07T22:28:57.640
> 
> 标签：javascript, html, canvas, boundary

为了学校作业，我正在制作风筝游戏..

我是一个完全的 javascript 菜鸟，我真的需要一些帮助。

所以我现在可以通过按箭头按钮来移动图像。现在的问题是我的图像可以超出画布并且我不希望它..

我真的不知道该怎么做我已经尝试了多个教程，但它似乎不起作用。

```
 window.onload = function() {

 var canvas = document.getElementById("game");
 window.addEventListener('keydown', keyDown, true);

 var context = canvas.getContext("2d");
 var kite = document.getElementById("kite");

 var kite = new Image ();
 kite.src = "kite.png";

 context.drawImage(kite, 250, 300, 300, 150);

 var x = 250;
 var y = 300;

 function keyDown(e){

//  up
    if (e.keyCode == 38) {
        clearCanvas();
        y = y - 3;
        context.drawImage(kite, x, y, 300, 150);    
    }

//  down
    if (e.keyCode == 40) {
        clearCanvas();
        y = y + 3;
        context.drawImage(kite, x, y, 300, 150);
    }

//  left
    if (e.keyCode == 37) {
        clearCanvas();
        x = x - 10;
        context.drawImage(kite, x, y, 300, 150);
    }

//  right
    if (e.keyCode == 39) {
        clearCanvas();
        x = x + 10;
        context.drawImage(kite, x, y, 300, 150);
    }

}

function clearCanvas() {
    canvas.width = canvas.width;
}

}; 
```

如果有人可以帮助我，我将非常感激：D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T22:31:33.070

您需要为调整`x`or`y`变量的每个 keyStroke 执行这些操作。注意新的`if`声明：

```
//  up
if (e.keyCode == 38) {
    clearCanvas();
    if (y - 3 > 0) {
        y = y - 3;
    }
    context.drawImage(kite, x, y, 300, 150);    
}

//  down
if (e.keyCode == 40) {
    clearCanvas();
    if (y + 3 + 150 < canvas.height) {
        y = y + 3;
    }
    context.drawImage(kite, x, y, 300, 150);
}

//  left
if (e.keyCode == 37) {
    clearCanvas();
    if (x - 10 > 0) {
        x = x - 10;
    }
    context.drawImage(kite, x, y, 300, 150);
}

//  right
if (e.keyCode == 39) {
    clearCanvas();
    if (x + 10 + 300 < canvas.width) {
        x = x + 10;
    }
    context.drawImage(kite, x, y, 300, 150);
} 
```

# wpf - 如何在 ControlTemplate 中使用 ElementName 绑定？

> ID：15283039
> 
> 赞同：14
> 
> 时间：2013-03-07T22:29:11.987
> 
> 标签：wpf, xaml, binding, controltemplate

我有多个 TextBlocks，它们在我的应用程序中引用不同的元素。直接在页面中使用时，我的代码可以正常工作。但是，我想创建一个 ControlTemplate 和一个 ContentControl 来减少代码的重复。

如何使用 TemplateBinding 将 ElementName 的引用从 ContentControl 传递到 ControlTemplate？以下代码引发此错误：

> “无法将属性“ElementName”中的值转换为“System.String”类型的对象。“System.Windows.TemplateBindingExpression”类型的对象无法转换为“System.String”类型。”

除了 Tag 属性之外，我还尝试了 ContentStringFormat ，它也不起作用。

使用模板使其工作的正确方法是什么？

在此先感谢您的帮助，

--- 肖恩

这是代码示例：

```
<Page xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:sys="clr-namespace:System;assembly=mscorlib" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" >
    <Page.Resources>
        <ControlTemplate x:Key="MyTemplate" TargetType="{x:Type ContentControl}">
            <TextBlock Margin="{Binding ElementName={TemplateBinding Tag}, Path=Margin}" Text="{TemplateBinding Content}" TextAlignment="{Binding ElementName={TemplateBinding Tag}, Path=TextAlignment}" Width="{Binding ElementName={TemplateBinding Tag}, Path=Width}" />
        </ControlTemplate>
    </Page.Resources>
    <StackPanel>
        <TextBlock x:Name="AnotherElement" Margin="10" Text="Main TextBlock" TextAlignment="Center" Width="100" />
        <TextBlock x:Name="AnotherElement2" Margin="20" Text="Second TextBlock" TextAlignment="Left" Width="250" />
        <TextBlock Margin="{Binding ElementName=AnotherElement, Path=Margin}" Text="Here is my TextBlock!" TextAlignment="{Binding ElementName=AnotherElement, Path=TextAlignment}" TextTrimming="CharacterEllipsis" Width="{Binding ElementName=AnotherElement, Path=Width}" />
        <TextBlock Margin="{Binding ElementName=AnotherElement2, Path=Margin}" Text="Here is my Second TextBlock!" TextAlignment="{Binding ElementName=AnotherElement2, Path=TextAlignment}" TextTrimming="CharacterEllipsis" Width="{Binding ElementName=AnotherElement2, Path=Width}" />
        <ContentControl Content="Hello!" Tag="AnotherElement" Template="{StaticResource MyTemplate}" />
        <ContentControl Content="Hello Again!" Tag="AnotherElement2" Template="{StaticResource MyTemplate}" />
    </StackPanel>
</Page> 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-07T22:59:43.967

这似乎是一种有趣的模板化方式，但它可以做到，你只需要对你的绑定有点花哨。

以下将起作用，但我仍然认为这不是模板控件的好方法

将 绑定`TextBlock` `Tag`到实际元素，然后在`ControlTemplate`绑定`Tag`到`Tag`并使用那里的值，因为标签是元素，您可以使用其中的任何元素。

```
<Page.Resources>
    <ControlTemplate x:Key="MyTemplate" TargetType="{x:Type ContentControl}">
        <TextBlock Name="_this" Tag="{TemplateBinding Tag}" Margin="{Binding ElementName=_this, Path=Tag.Margin}" Text="{TemplateBinding Content}" TextAlignment="{Binding ElementName=_this, Path=Tag.TextAlignment}" Width="{Binding ElementName=_this, Path=Tag.Width}" />
    </ControlTemplate>
</Page.Resources>
<StackPanel>
    <TextBlock x:Name="AnotherElement" Margin="10" Text="Main TextBlock" TextAlignment="Center" Width="100" />
    <TextBlock x:Name="AnotherElement2" Margin="20" Text="Second TextBlock" TextAlignment="Left" Width="250" />
    <TextBlock Margin="{Binding ElementName=AnotherElement, Path=Margin}" Text="Here is my TextBlock!" TextAlignment="{Binding ElementName=AnotherElement, Path=TextAlignment}" TextTrimming="CharacterEllipsis" Width="{Binding ElementName=AnotherElement, Path=Width}" />
    <TextBlock Margin="{Binding ElementName=AnotherElement2, Path=Margin}" Text="Here is my Second TextBlock!" TextAlignment="{Binding ElementName=AnotherElement2, Path=TextAlignment}" TextTrimming="CharacterEllipsis" Width="{Binding ElementName=AnotherElement2, Path=Width}" />
    <ContentControl Content="Hello!" Tag="{Binding ElementName=AnotherElement}" Template="{StaticResource MyTemplate}" />
    <ContentControl Content="Hello Again!" Tag="{Binding ElementName=AnotherElement2}" Template="{StaticResource MyTemplate}" />
</StackPanel> 
```

# command-line - Batch File Replace Extracted File

> ID：15283044
> 
> 赞同：0
> 
> 时间：2013-03-07T22:29:27.107
> 
> 标签：command-line, batch-file, cmd, unzip

I have a .bat file that unzips a kml from a kmz. If I run the batch file again it prompts me if I want to replace the file. Is there away I can have it always replace the file without prompting the user or displaying a cmd window?

```
 @echo off
    md tempKml
    cd tempKml
    ..\unzip ..\%1 >nul 
    cd ..
    dir tempKml\*.kml /s/b 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:35:54.900

Use the -o option?

```
..\unzip -o ..\%1 >nul 
```

# c++ - 带有模板成员的模板类，检查实例化

> ID：15283046
> 
> 赞同：2
> 
> 时间：2013-03-07T22:29:35.010
> 
> 标签：c++, debugging, templates, compiler-errors

我有一个关于模板类的 C++ 项目（库）（不同类型的矩阵，每种类型都有不同的容器，容器有不同的 value_type - 向量等相同）。

每个模板类都有模板成员，因为

```
DenseRectangularMatrix<std::vector<long double>> //type-container-value_type 
```

必须能够（如果是 5x5）乘以

```
DenseSymmetricMatrix<std::array<float,15>> //(5x5) type-container-value_type 
```

我的问题是实例化的编译。由于许多模板关系，很难实例化所有可能的情况，不仅用于测试/调试，还用于检查是否发生编译器错误。

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T05:19:22.610

解决此类问题的 C 方法可能是使用宏和脚本来简化所有可能性的生成。但是，我们使用 C++ 进行编码，所以让我们用模板替换宏。毕竟，这些都是基本类型的宏。

所以我的想法是将你的类型分解为更基本的类型，并使用模板来构造它们。

```
enum {
    RECTANGULAR,
    SYMMETRIC,
} DimKind;

enum {
    DENSE,
    PARSE
} Density;

enum {
    STD_ARRAY,
    STD_VECTOR
} ContainerType;

enum {
    FLOAT,
    DOUBLE
} CoordType;

template <CoordType CT>
struct coord_def {
};

struct coord_def<FLOAT>{
    typedef float type;
};

struct coord_def<DOUBLE> {
    typedef double type;
};

template <ContainerType Cont, CoordType Coord, int Dimension>
struct container_def {
};

template <CoordType Coord, int Dim>
struct container_def<STD_ARRAY, Coord, Dim> {
    typedef std::array<Coord,Dim> type;
    static const int dim = Dim;
    // add any other helper function needed to build the test case for that particular
    // container
};

template <CoordType Coord, int Dim>
struct container_def<STD_VECTOR, Coord, Dim> {
    typedef std::vector<Coord> type;
    static const int dim = Dim;
};

template <Density D, DimKind DK, ContainerType Cont, 
                  CoordType Coord, int XDim, int YDim>
struct TestMatrix {
};

// here specialize the above according to the parameters
// you may need to include helper function to build an instance using the template
// parameters (dimension comesto mind) 
```

然后，您必须定义要测试的操作类型。它们当然可以归类为带分量的矩阵、带向量的矩阵、带矩阵的矩阵。

```
enum { 
    // matrix ops list
} MatrixOp;

template <MatrixOp Op, typename M1, typename M2, typename Ret>
Ret binary_op(M1 m1, M2 m2);

 // overload for specific functions

template <MatrixOp Op,
                  ContainerType Cont1, ContainerType Cont2
                   CoordType Coord1, CoordType Coord2,
                   int XDim1, int YDim1, int XDim2, int YDim2,
                   Denstity D1, Density D2,
                   DimKind K1, DimKind K2>
struct test_op {
    typedef TestMatrix<...>::type M1;
    typedef TestMatrix<...>::type M2;
    void test(M1 m1, M2 m2){
         binary_op<MatrixOp,M1,M2>(m1, m2);
     }
}; 
```

接下来，您的矩阵之间肯定存在代数关系，您可以将其编码为模板，并用于您的测试。

例如，`DenseSymmetricMatrix`模板的参数似乎指定了一个静态大小的容器类型，对于这样一个 *n 矩阵，数组的维度必须是 n * (n+1) / 2。`DenseRectangularMatrix`另一方面，它的维度似乎定义为运行。但是由于您具有上述维度的关系，您可以轻松地将两个测试用例编写为模板：一个构建两个维度匹配的矩阵，另一个构建维度不匹配的矩阵。

最后一步是所有可能性的产生。一个简单的脚本遍历所有枚举值应该有助于生成所有可能的测试。

我相信您也可以使用现有的单元测试框架（如 boost 框架）和这些模板来构建您的测试。

# java - GAE 从 URL 将大文件上传到 blobstore

> ID：15283051
> 
> 赞同：0
> 
> 时间：2013-03-07T22:29:46.383
> 
> 标签：java, google-app-engine

我想将 30MB 到 2GB 的大型视频文件上传到具有访问该文件的外部 URL 的 blob 存储。

到目前为止，我尝试过这样的事情，但它不适用于大文件，我认为是因为 32MB 的限制：

```
 //InputStream is = new URL(getUrlThumbnailFullSize(wistiaResponse)).openStream();
    HttpURLConnection con = (HttpURLConnection) new URL("URL of the file here").openConnection();
    con.setConnectTimeout(0);
    con.connect();
    InputStream is = con.getInputStream();
    //create file service to upload the video to the blob store
    FileService fileService = FileServiceFactory.getFileService();
    //create the App Engine File; assign MIME type and name
    AppEngineFile file = fileService.createNewBlobFile("content type here", "file name here");
    //lock when uploading file
    boolean lock = true;
    //open channel
    FileWriteChannel writeChannel = fileService.openWriteChannel(file, lock);
    //upload file
    writeChannel.write(ByteBuffer.wrap(IOUtils.toByteArray(is)));
    writeChannel.closeFinally();
    //release the lock
    lock = false;
    //get blob key
    BlobKey blobKey = FileServiceFactory.getFileService().getBlobKey(file); 
```

但我有以下堆栈跟踪：

> 严重：com.google.appengine.api.urlfetch.ResponseTooLargeException：来自 url [http://embed.wistia.com/deliveries/a0f8dc8ed210b53152af601eb0af40d76cd2929f.bin的响应](http://embed.wistia.com/deliveries/a0f8dc8ed210b53152af601eb0af40d76cd2929f.bin) 太大了。在 com.google.appengine.api.urlfetch.URLFetchServiceImpl.fetch(URLFetchServiceImpl.java:57) 在 com.google.apphosting.utils.security.urlfetch.URLFetchServiceStreamHandler$Connection.fetchResponse(URLFetchServiceStreamHandler.java:417) 在 com.google .apphosting.utils.security.urlfetch.URLFetchServiceStreamHandler$Connection.getInputStream(URLFetchServiceStreamHandler.java:296) 在控制器.CtrlWistia.download(CtrlWistia.java:149) 在控制器.CtrlWistia.ajax(CtrlWistia.java:89) 在控制器。 CtrlAjax.main(CtrlAjax.java:66) at vidaao.AjaxServlet.doPost(AjaxServlet.java:37) at javax.servlet.http.HttpServlet.service(HttpServlet.java:637) at javax.servlet.http.HttpServlet.service (HttpServlet.java:717) 在 org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511) 在 org.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T05:22:17.847

请使用[blobstoreService.createUploadUrl](https://developers.google.com/appengine/docs/java/blobstore/overview#Uploading_a_Blob)进行大文件上传。

[更新]啊，我想我明白了。目前这是不可能的，因为 URLFetch 服务有 32MB 的响应大小限制。作为一种解决方法，您可以从客户端 javascript 中的 URL 下载文件并使用 blobstore 服务创建的上传 URL 上传它吗？

[更新]好的，您需要在服务器端实现这一点，我从问题中不清楚。所以请忘记createUploadUrl。

如果服务器支持 Range 标头，您可以多次请求较小的数据块并将它们存储为单独的 blob 存储对象，以及所需的元数据，如文件名、mimetype、blob 键列表等。

此外，如果您想将它们合并到一个文件中，您可以使用 Google Cloud Storage。使用[Resumable upload option](https://developers.google.com/storage/docs/developer-guide#resumable)，您可以将数据块多次发送到 Google Cloud Storage。

# css - 为什么叫第一胎？

> ID：15283054
> 
> 赞同：4
> 
> 时间：2013-03-07T22:29:50.057
> 
> 标签：css

我期待一连串的反对票，但尽管如此，我想知道你们的想法。

如果你有，

```
<div>
    <p>Paragraph1</p>
    <p>Paragraph2</p>
</div>
<div>
</div> 
```

从字面上看，我希望`div:first-child`选择 for，`<p>Paragraph1</p>`因为`<p>Paragraph1</p>`它是的第一个子节点`div` 但是，正如我们所知，它选择 html 中的第一个，简单地调用它或者也许`div`更有意义吗？`:first``:first-sibling`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T22:32:25.407

jQuery 有一个扩展的选择器：[`:first`](http://api.jquery.com/first-selector/)，请注意，问题`:first`在于它在第一次匹配后停止查找元素，不像`:first-child`这里的示例为什么`:first`不是一个好名字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T22:35:58.827

根据[Mozilla 的参考文档](https://developer.mozilla.org/en-US/docs/CSS/Pseudo-classes)（强调我的）：

> CSS 伪类是添加到选择器的关键字，用于指定要选择 **的元素的特殊状态**。

伪类是现有选择器的修饰符。所以结果必须是现有选择器匹配的子集。因此，`div:first-child`不能返回除 a 之外的任何内容`div`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T22:41:10.667

至于为什么不`:first`因为首先与什么有关？整个页面的第一个 div？就在这一节？`:first-child`提供上下文，无论是文档、div 还是 ul。任何。

您所引用的“字面意思”实际上似乎是`div > :first-child`因为您正在考虑在 div 中选择一个元素。

`div:first`如果从字面上看，这意味着您遇到的第一个 div 。所以它总是页面上的第一个 div。

`div:first-child`字面意思是“一个 div，它是它的父级的第一个子级” 你需要记住，伪类描述了它们应用到的元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T22:32:09.223

:first-child 表示它是其父母的第一个孩子。我认为 :first 不够具体， :first-sibling .... 这似乎太等同于 first-child，因为两者都非常模棱两可。

# php - cURL 检索 CSV 文件

> ID：15283058
> 
> 赞同：-1
> 
> 时间：2013-03-07T22:29:54.763
> 
> 标签：php, curl, csv, file-transfer

我的托管公司必须更改他们的服务器或其他东西，我已经让这段代码完美地运行了 8-10 年..YEARS！.. 今天它停止了。我想知道今天 cURL 的使用是否与我 8 到 10 年前写这篇文章时发生了很大变化……请帮忙。它抓取 csv 并持续很长时间来获取文件.. 我在 20 分钟后退出浏览器.. 应该并且过去只需要 25 秒的时间。下面的第一行也是一个问题.. 不知何故，在任何其他服务器上它显示正确的 3 个月回溯日期.. 在我的服务器上，我的网站托管在.. 它显示 1969.. 所以起初我假设日期试图获取数据从 1969 年开始是滞后/滞留。但是当我将其修复为新代码时，它仍然滞后。

```
//$newdates = date("Ymd",strtotime(date('Ymj')) - (60 * 24 * 60 * 60));
// the above for some reason doesnt work anymore gives the 1969 date.. so below fixed

$newdates = date("Ymd", strtotime("-3 months")); 
$tm = "http://123.theserver.net/data/sel_data=*&query_str=lud>'$newdates'&dl_type=file&send_done=no&e=.csv"; 
$ch = curl_init($tm);  
$fp = fopen("/home/sites/www.mydomain.com/mx/data.csv", 'w'); 
curl_setopt($ch, CURLOPT_FILE, $fp);  
curl_setopt($ch, CURLOPT_HEADER, 0);  
curl_exec($ch); 
curl_close($ch); 
fclose($fp); 
```

有点沮丧，因为托管公司说他们没有改变任何东西......而且有 2000 英里远，所以我在这里缺少更新的更新代码吗？

非常感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:18:29.890

1.  检查 URL 的格式是否正确。
2.  确保*远程*服务器不是永远占用的服务器。
3.  检查服务器上的平均负载。由于严重的 IO 瓶颈，这可能是一个非常慢的写入。

此外，永远不要*对*你的主人说“我的代码在 X 年前运行良好，现在它已经坏了，所以这是*你的错*”，因为那正是我们停止放屁的确切时刻。*在这种特殊*情况下，您的代码可能不是问题，但是有很多人向我们提出这个借口，事实是 sh*t 代码可以工作多年，直到它达到其效率图的渐近线并且只有这么多级别不在乎...他们的工作是确保*服务器*正常工作，他们不会为您调试代码而获得报酬。

你*应该*做的是尽你最大的能力调查问题，包括你的发现和支持票证中的支持证据，并且永远不要暗示服务器操作“一定已经改变*了某些东西*”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:52:20.357

尝试：

```
$newdates = date("Ymd", strtotime("-3 months"));    
$url_init = "http://123.theserver.net/data/sel_data=*&query_str=lud>'$newdates'&dl_type=file&send_done=no&e=.csv";

$ch = curl_init($url_init);

    if (!$ch) die ("Curl not loaded");

$fp = fopen("/home/sites/www.mydomain.com/mx/data.csv", 'w'); 

curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_URL, $fp);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

if( ! $tmp = curl_exec($ch))
{
   echo curl_error($ch);
} 

else
{

header("Content-type: application/csv");
header("Content-Disposition: attachment; filename=$start.csv");
header("Pragma: no-cache");
header("Expires: 0");
echo $tmp;
}
curl_close($ch); 
```

# ruby-on-rails - ruby 和 gem rdiscount windows 8 64bit 的安装问题

> ID：15283059
> 
> 赞同：3
> 
> 时间：2013-03-07T22:29:55.923
> 
> 标签：ruby-on-rails, ruby, rubygems, jekyll, rdiscount

我正在尝试让 Jekyll 和 bower 在 Windows 8 中工作

我已经成功安装了 Ruby 和 DevKit，我尝试过，版本 2.0.2、1.9.3，然后再次使用来自[http://railsinstaller.org/的 Rails 安装程序](http://railsinstaller.org/)

我在下面遵循了场景 A 和 B，[https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-gems_fails_comspec_autorun](https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-gems_fails_comspec_autorun)但都与我无关，

COMSPEC 是我的 cmd.exe 位置，我没有自动运行？

我可以运行`gem install mysql`，但尝试执行任一 rdiscount 都会给出以下结果

```
c:\devkit>gem install rdiscount
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
ERROR:  Error installing rdiscount:
ERROR: Failed to build gem native extension.

C:/RailsInstaller/Ruby1.9.3/bin/ruby.exe extconf.rb
checking for random()... *** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=C:/RailsInstaller/Ruby1.9.3/bin/ruby
    --with-rdiscount-dir
    --without-rdiscount-dir
    --with-rdiscount-include
    --without-rdiscount-include=${rdiscount-dir}/include
    --with-rdiscount-lib
    --without-rdiscount-lib=${rdiscount-dir}/lib
C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler
failed to generate an executable file. (RuntimeError)
You have to install development tools first.
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:461:in `try_link 0'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:476:in `try_link'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:619:in `try_func'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:894:in `block in have_func'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:254:in `open'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:254:in `open'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'
    from C:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/mkmf.rb:893:in `have_fun c'
    from extconf.rb:5:in `<main>'

Gem files will remain installed in C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rdiscount-2.0.7.1 for inspection.
Results logged to C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rdiscount-2.0.7.1/ext/gem_make.out 
```

如果我运行，`gem install jekyll`我会收到以下错误

```
porter.c:238:4: warning: passing argument 2 of 'ends' discards 'const' qualifier from  pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:240:7: warning: passing argument 2 of 'ends' discards 'const' qualifier from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *' porter.c:240:7: warning: passing argument 2 of 'setto' discards 'const' qualifier from pointer target type [enabled by default]
porter.c:196:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:241:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:241:7: warning: passing argument 2 of 'setto' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:196:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:242:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:242:7: warning: passing argument 2 of 'setto' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:196:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:249:7: warning: passing argument 2 of 'setto' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:196:13: note: expected 'char *' but argument is of type 'const char *'
porter.c: In function 'step1c':
porter.c:257:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c: In function 'step2':
porter.c:267:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:267:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:268:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:268:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:270:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:270:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:271:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:271:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:273:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:273:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:275:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:275:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:280:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:280:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:281:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:281:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:282:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:282:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:283:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:283:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:285:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:285:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:286:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:286:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:287:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:287:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:289:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:289:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:290:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:290:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:291:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:291:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:292:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:292:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:294:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:294:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:295:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:295:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:296:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:296:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:298:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:298:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c: In function 'step3':
porter.c:308:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:308:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:309:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:309:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:310:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:310:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:312:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:312:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:314:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:314:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:315:14: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:315:14: warning: passing argument 2 of 'r' discards 'const' qualifier f
rom pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c:317:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:317:4: warning: passing argument 2 of 'r' discards 'const' qualifier fr
om pointer target type [enabled by default]
porter.c:205:13: note: expected 'char *' but argument is of type 'const char *'
porter.c: In function 'step4':
porter.c:325:4: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:326:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:327:17: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:328:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:329:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:330:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:331:17: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:332:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:333:17: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:334:17: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:335:17: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:336:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:337:17: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:339:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:340:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:341:17: warning: passing argument 2 of 'ends' discards 'const' qualifie
r from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:342:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:343:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
porter.c:344:7: warning: passing argument 2 of 'ends' discards 'const' qualifier
 from pointer target type [enabled by default]
porter.c:182:12: note: expected 'char *' but argument is of type 'const char *'
compiling porter_wrap.c
In file included from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/ruby.h
:1376:0,
                 from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby.h:32,
                 from porter_wrap.c:1:
c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/missing.h:41:8: error: redef
inition of 'struct timespec'
In file included from c:\devkit\mingw\bin\../lib/gcc/i686-w64-mingw32/4.7.2/../.
./../../i686-w64-mingw32/include/process.h:12:0,
                 from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/win32.
h:62,
                 from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/define
s.h:223,
                 from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/ruby.h
:67,
                 from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby.h:32,
                 from porter_wrap.c:1:
c:\devkit\mingw\bin\../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw
32/include/sys/types.h:89:8: note: originally defined here
In file included from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/ruby.h
:1376:0,
                 from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby.h:32,
                 from porter_wrap.c:1:
c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/missing.h:48:8: error: redef
inition of 'struct timezone'
In file included from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/win32.
h:63:0,
                 from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/define
s.h:223,
                 from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby/ruby.h
:67,
                 from c:/RailsInstaller/Ruby1.9.3/include/ruby-1.9.1/ruby.h:32,
                 from porter_wrap.c:1:
c:\devkit\mingw\bin\../lib/gcc/i686-w64-mingw32/4.7.2/../../../../i686-w64-mingw
32/include/time.h:260:8: note: originally defined here
make: *** [porter_wrap.o] Error 1

Gem files will remain installed in C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9
.1/gems/fast-stemmer-1.0.2 for inspection.
Results logged to C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/fast-stem
mer-1.0.2/ext/gem_make.out

c:\devkit> 
```

我也尝试过重新安装/更新 gem，但我所遵循的一切似乎都不起作用？

谁能想到我可以尝试的其他方法？或将我指向可以提供帮助的地方。

这是我对 Ruby 的第一次尝试，我运气不佳。

谢谢肖恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:59:46.193

rdiscount 2.0.7.2 修复了这个问题

```
gem install rdiscount -v 2.0.7.2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T22:51:29.277

问题不是 Ruby、RubyInstaller 或 DevKit，而是 RDiscount gem 在 Windows 上损坏，请参阅报告的[问题 #74](https://github.com/rtomayko/rdiscount/issues/74)。

您可以安装旧版本的 RDiscount，例如 1.6.x：

```
gem install rdiscount -v 1.6.8 
```

# javascript - 添加 到一个在用户打开它之前动态元素所有，我正在开发一个网络应用程序。其中一个关键屏幕包含一个相当大的表格 - 通常在 50-100 行之间。在每一行，我有两个 <select>元素；每个都包含 10-30 个 <option>元素。如果我要在每一行的每个</option></select> 上包含所有 <option>元素，我最终可能会得到超过 6,000 个元素（100 行 x 2 个选择 x 30 个选项）。所以，我的计划是将每个选</option>

> ID：15283064
> 
> 赞同：2
> 
> 时间：2013-03-07T22:30:14.447
> 
> 标签：javascript, jquery

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:52:27.663

试试这个：

**HTML**

```
<select class="sel">
    <option value="a">Option A</option>
</select> 
```

**jQuery**

```
jQuery(document).ready(function($){
    var option={
        "a":"option a",
        "b":"option b",
        "c":"option c"
    };
    $('.sel').on('click',function(){
        $('.sel').html('');
       $.each(option,function(i,n){
          $('.sel').append('<option value='+i+'>'+n+'</option>');
        });

    });
    $('.sel').on('change',function(){
        var selected_val=$(this).val();
        var selected_option=$("option:selected",this).text();
        $('.sel').html('');

          $('.sel').append('<option value='+selected_val+'>'+selected_option+'</option>');

    });

}); 
```

这是演示：http: [//jsfiddle.net/mHGQs/](http://jsfiddle.net/mHGQs/)

# c# - 对于简单功能，静态优于非静态的任何优势

> ID：15283071
> 
> 赞同：2
> 
> 时间：2013-03-07T22:30:45.430
> 
> 标签：c#, asp.net

这只是为了满足我的好奇心。做其中一个与另一个相比有什么区别或优势吗

```
public static void Save(Guid id, int a, string b)
{
     //Save a and b to the database using PK id
} 
```

超过：

```
Guid ID {get; set;}
int A {get; set;}
string B {get ;set;}

public void Save()
{
    //Save A and B to the database using PK ID
} 
```

编辑：好的一些上下文：所以 Web UI 将 JSON 传递给静态页面方法。页面方法解析 JSON 并将新变量传递给其他 DLL 中的静态类。然后使用实体框架来更新数据库。这个可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:09:48.273

我绝对更喜欢实例方法而不是静态方法。原因是静态方法意味着您必须将全局可变状态引入系统。为了发挥作用，静态方法需要访问某种数据库连接并以静态方式进行。

应尽可能避免全局可变状态。这是一个迫在眉睫的错误农场，会阻碍您对代码库的未来更改（例如引入多个线程）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T22:42:47.800

您给出的示例似乎表明您正在编写某种持久性 API，我强烈建议您使用可实例化的类。对于实用程序类之类的东西，使用静态方法是可以的，但是如果你过度使用静态方法，你会很快发现你的代码变得不可扩展和不可维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T22:39:07.693

密封函数总是优于非密封函数，因为 JITTER 可以（选择）内联前者。静态函数总是密封的，密封类中的所有方法也是如此。然而，避免将属性复制到静态也是首选。

因此，正如克里斯上面所说，您需要根据具体情况做出决定。99% 的情况下这无关紧要，因为性能足够好，或者瓶颈在其他地方，所以请保持代码干净。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T22:39:50.870

这基本上是“OOP 与结构化编程的优势”。在您的情况下，数据库连接会有所不同：它可以是类的字段，您可以在构造函数中提供一次。如果需要，这些方法可以使用它。使用静态方法，您需要在参数中提供所有内容，即使是始终相同的内容。

不依赖于对象内部状态的方法应该是静态的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T22:35:21.400

真的，这取决于您使用该方法的情况。

例如，如果您正在实现一个命令模式，并且您不想每次都实例化一个对象，那么静态方法可能会很有用。

同样，如果您只是向一个类添加一些功能，那么将方法设为静态确实没有任何意义。

这些都不意味着一个比另一个**更好**。这只是意味着它们有不同的用途。枪是一种非常有用的工具，但当你试图关掉电视时却不是这样。明白我的意思了吗？

# wordpress - 在子页面上时，在导航栏中保持父页面处于活动状态

> ID：15283074
> 
> 赞同：1
> 
> 时间：2013-03-07T22:31:02.870
> 
> 标签：wordpress, menu, navigation, parent

我没有在菜单中显示子页面，但是我想在三个子页面中突出显示导航栏中的父页面。

我的理解是样式表中已经存在的 CSS 应该可以解决问题，但事实并非如此！下面的 CSS。

```
#nav >ul>li.hovered,
#nav >ul>li.current-menu-ancestor,
#nav >ul>li.current-menu-item {
  color: #e30613 !important;
}
#nav >ul>li.hovered >a,
#nav >ul>li.current-menu-ancestor >a,
#nav >ul>li.current-menu-item >a {
  -moz-opacity: 1;
  filter: alpha(opacity=100);
  opacity: 1;
  color: #e30613 !important;
} 
```

任何帮助将不胜感激！

# intuit-partner-platform - 错误：该应用程序已被该公司的其他用户订阅

> ID：15283075
> 
> 赞同：0
> 
> 时间：2013-03-07T22:31:06.233
> 
> 标签：intuit-partner-platform

我正在本地测试与 Quickbooks IPP 集成的应用程序。我注册时已连接到 Quickbooks 开发人员计划提供的模拟账户，但它没有足够的数据，所以我创建了自己的模拟账户，并复制了一堆好的数据。然后，我从另一个演示帐户中清除了存储在我的应用程序中的令牌和内容，以便我可以重新开始。问题是，现在当我尝试将我的应用程序连接到这个新的 qb 帐户（使用 Quickbooks 的不同登录名）时，我一直收到此错误：

```
Oops! An error has occurred. 
Please close this window and try again. 

Error Code: invalid_database 
Message: The application has already been subscribed to by another user for this company 
```

我以前看不到任何人可以连接到这个本地应用程序，但以防万一，我去了“管理我的应用程序”屏幕，我看到的唯一东西是“QuickBooks Online”。

* * *

它可能不相关，但在 Intuit 弹出窗口中单击“授权”后，我也会收到一条 javascript 错误消息。

```
Line: 3
Error: Unexpected call to method or property access. 
```

当我尝试调试 javascript 时，它是 jQuery 中的代码，但似乎源于“Intuit.DFA.min.js”文件中的“notifyDoubleClickOfSalesActivity”函数。

* * *

此时我能做什么？我知道我的代码很好，因为我能够第一次连接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:58:57.867

转到您的开发者帐户并断开所有连接的连接。这应该可以解决问题。

如果没有，请通过 appcenter.intuit.com 提交支持票。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T16:04:32.287

如果您已经拥有特定公司的有效访问令牌/连接，则同一公司的其他用户无法再次授权访问。这就是你看到的错误。如果您在 appcenter 上进入您的帐户，您可以断开该 IA 连接，这样您就可以与其他用户重新创建它。您的代码还可以调用断开连接 API 来断开它，最后您可以以最终用户身份登录并转到您的帐户并断开应用程序。

震动

# c# - 除以零奇数

> ID：15283082
> 
> 赞同：4
> 
> 时间：2013-03-07T22:31:20.137
> 
> 标签：c#

我今天遇到了一个问题，我不小心被零除，但没有抛出异常。当我使用调试器时，我在调试器中看到了“NaN”。当我尝试用 NUnit 重新创建这个场景时，Assert 说我正在返回“Infinity”。不能完全让调试器显示 NaN，但我只是想知道为什么在这种情况下没有抛出错误？我花了很长时间才找到这个问题，我会假设应该抛出异常？

这是测试代码：

```
public class DivideByZero {

    private int TotalQaOneToFour;
    private int TotalGrade = 10;

    public DivideByZero(int TotalQaOneToFour) {
      this.TotalQaOneToFour = TotalQaOneToFour;
    }

    public Double QualityReportAverageRounded {
      get {
        return Math.Round((double)TotalGrade / TotalQaOneToFour, 2);
      }
    }
  }

  [TestFixture]
  public class DivideByZeroTest {

    [Test]
    public void TestThatDivideByZeroThrowsWhenUsingMathRound() {

      var dbz = new DivideByZero(0);

      Assert.AreEqual(0, dbz.QualityReportAverageRounded);
    }

  } 
```

这是 NUnit 输出：

> 测试“DivideByZeroTest.TestThatDivideByZeroThrowsWhenUsingMathRound”失败：
> 预期：0
> 但为：无穷
> 大 DivideByZero.cs(33,0)：在 DivideByZeroTest.TestThatDivideByZeroThrowsWhenUsingMathRound()
> 
> 0 次通过，1 次失败，0 次跳过，耗时 0.41 秒（NUnit 2.6.1）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-07T22:33:54.447

> 不能完全让调试器显示 NaN，但我只是想知道为什么在这种情况下没有抛出错误？

因为这会违反规范:) 基本上，这里没有必要抛出异常，因为 IEEE-754 a) 定义了如何处理除以 0；b) 对除以 0 的结果具有适当的值。对于整数类型（和`decimal`），这些都不是真的，这是你得到的地方`DivideByZeroException`。

如果你将任何非零、非 NaN 值除以零，你应该得到无穷大（正或负）。如果你将零（或 NaN）除以零，你应该得到 NaN。

示例代码：

```
using System;

class Test
{
    static void Main()
    {
        // Prevent everything being computed at compile-time
        double zero = 0d;
        Console.WriteLine(1d / zero);  // Infinity
        Console.WriteLine(0d / zero);  // NaN
        Console.WriteLine(-1d / zero); // -Infinity
    }
} 
```

从 C# 5 规范第 7.8.2 节（其他编号适用于其他版本）：

> **整数除法**
> 
> [...]
> 如果右操作数的值为零，则抛出 System.DivideByZeroException。
> [...]
> 
> **浮点除法**
> 
> 商是根据 IEEE 754 算术规则计算的。下表列出了非零有限值、零、无穷大和 NaN 的所有可能组合的结果。

（然后有一个表格给出了与我之前描述的相同类型的结果。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T22:34:43.443

浮点数除以零，就像你在这里一样，导致无穷大或非数字（NaN）。在整数中除以零会导致异常。

当您将非零值除以零时会产生无穷大。当您将零除以零时会产生 NaN。

# javascript - 有一个东西显示，一个又一个离开 jQuery

> ID：15283087
> 
> 赞同：1
> 
> 时间：2013-03-07T22:31:47.297
> 
> 标签：javascript, jquery, html, function, show-hide

我在这里在 JSFiddle 中制作了一个表格：http: [//jsfiddle.net/LCBradley3k/xqcJS/22/](http://jsfiddle.net/LCBradley3k/xqcJS/22/)

我做了一个简短的段落，只是说“Hello World”，但它似乎在表单隐藏后并没有运行（一旦所有用户输入正确的信息）。

这是Javascipt：

```
 if (correct) {

        $('#answer').html('Thank You!');
        setTimeout(function(){
    $('.inputs').hide("slide", { direction: "up" }, 1000);
    }, 2000);

        setTimein(function(){
    $('p').show("slide", { direction: "up" }, 1000);
    }, 2000);

 } 
```

您可以看到 .inputs 隐藏了，但是在完成之后，我希望 setTimein 执行（这显示了我的测试段落）。

出于某种原因，它不起作用。有什么理由吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T22:52:12.540

HTML

```
<div id="answer"></div>
<input id="txt" placeholder="Say Something Smart" />
<input type="submit" /> 
```

JS

```
var $answer = $('#answer'),
    $txt = $('#txt'),
    $submit = $('[type=submit]')

$submit.click(function(){
    if(!$txt.val())
        return alert('enter something');
    $answer.html('Thank You!');
    $('input')
        .hide(200)
        .delay(2000)
        .show(200,function(){
            $answer.html('');
            $txt.val('').attr('placeholder','say something else')
        });
}); 
```

密码笔

[http://codepen.io/anon/pen/uniGy](http://codepen.io/anon/pen/uniGy)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:43:03.880

setTimein 不存在。那不是一回事。使用 setTimeout(function () {...}, 2000)

# datasource - SmartGWT 同构数据源聚合 SQL 函数

> ID：15283088
> 
> 赞同：1
> 
> 时间：2013-03-07T22:31:52.697
> 
> 标签：datasource, aggregate-functions, smartgwt, smartgwt-pro

我希望从 com.isomorphic.datasource.DataSource 的实例中获取列的最大值。这可能吗？

一个通用的“**针对这个数据源运行这个 sql** ”会特别有帮助，因为稍后我会做更多的事情，包括为某些标准获取一个行“计数”。

我*可以从技术上*获取所有记录并自己遍历它们，尽管这显然不是最佳的。我似乎在 SmartGWT 文档中找不到任何相关内容。

我正在使用：SmartGWT Power v3.0.p20121127

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T15:32:43.857

在 DataSource 中，您可以使用具有不同参数的 applyFilter() 方法之一，并且可以使用 Criteria 和 AdvancedCriteria。

# iphone - 如何保存带有覆盖在照片上的标签的照片？

> ID：15283091
> 
> 赞同：0
> 
> 时间：2013-03-07T22:32:01.117
> 
> 标签：iphone, ios, objective-c, ipad, ios5

所以我有数据要在拍摄时叠加在照片上。这是我的代码。有没有更简单的方法可以在照片上叠加数据？

```
- (void)imagePickerController:(UIImagePickerController *)picker
didFinishPickingMediaWithInfo:(NSDictionary *)info 
{         
    UIImage *cameraImage = [info objectForKey:UIImagePickerControllerOriginalImage];
    UIImageView *imageViewToSave = [[UIImageView alloc] initWithImage:cameraImage];
    CGRect textFrame = CGRectMake(0, 0, imageViewToSave.frame.size.width-20, 325);
    UILabel *tempLabel = [[UILabel alloc] initWithFrame:textFrame];
    tempLabel.text = self.temperatureText.text;
    tempLabel.font = self.imageLabelFont;
    tempLabel.adjustsFontSizeToFitWidth = YES;
    tempLabel.textAlignment = NSTextAlignmentRight;
    tempLabel.textColor = self.tempGreen;
    tempLabel.backgroundColor = [UIColor clearColor];
    [imageViewToSave addSubview:tempLabel];

    UIGraphicsBeginImageContext(imageViewToSave.bounds.size);
    [imageViewToSave.layer renderInContext:UIGraphicsGetCurrentContext()];

    cameraImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    [self.library saveImage:cameraImage toAlbum:@"Node Therma" withCompletionBlock:^(NSError *error) 
    {
        if (error!=nil) 
        {
            NSLog(@"Big error: %@", [error description]);
        }
    }]; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:05:19.977

刚刚测试了这个，它可以工作......

```
- (UIImage *)imageWithBackground:(UIImage *)background text:(NSString *)text textColor:(UIColor *)textColor {

    UIImageView *imageView = [[UIImageView alloc] initWithImage:background];
    UIView *composition = [[UIView alloc] initWithFrame:imageView.bounds];
    [composition addSubview:imageView];

    UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(/* where you want the label */)];
    label.text = text;
    label.backgroundColor = [UIColor clearColor];
    label.textColor = textColor;
    [composition addSubview:label];

    UIGraphicsBeginImageContext(composition.bounds.size);
    [composition.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *composedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return composedImage;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:08:57.410

与我的代码相比，您的代码看起来不错，但在获取屏幕截图时尝试使用新的局部变量，如下所示：

```
UIImage *cameraImage2 = UIGraphicsGetImageFromCurrentImageContext(); 
```

然后保存cameraImage2。

还要确保 self.tempGreen 不是 ClearColor。

# dll - VB 6.0 中的 Microsoft MapPoint 18.0 对象库

> ID：15283100
> 
> 赞同：0
> 
> 时间：2013-03-07T22:32:30.720
> 
> 标签：dll, vb6, mappoint

我在 VB 6.0 中使用 Microsoft MapPoint 18.0 对象库作为参考。创建对象并传递地址参数后，程序不会返回任何有效地址的任何纬度、经度数据。想知道这是否是 VB 6.0 的 dll 问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T13:06:04.287

我刚刚使用参考“Microsoft MapPoint 19.0 对象库（北美）”进行了快速测试，以下代码对我有用：

```
Private Sub Command1_Click()
Dim mmpApp As MapPoint.Application, mmpMap As MapPoint.Map, _
        mmpFindResults As MapPoint.FindResults

Set mmpApp = New MapPoint.Application
Set mmpMap = mmpApp.ActiveMap

Set mmpFindResults = mmpMap.FindAddressResults( _
        "24 Sussex Drive", _
        "Ottawa", _
        "", _
        "ON", _
        "", _
        MapPoint.GeoCountry.geoCountryCanada)

If mmpFindResults.ResultsQuality = geoFirstResultGood Then
    MsgBox "First result returned: (" & mmpFindResults(1).Latitude & "," & _
            mmpFindResults(1).Longitude & ")"
Else
    MsgBox "The search returned poor, ambiguous, or non-existent results"
End If

Set mmpFindResults = Nothing
Set mmpMap = Nothing
Set mmpApp = Nothing
End Sub 
```

我希望它也可以在 18.0 版本下工作。

# jquery - 无法将 ID 添加到父级

> ID：15283102
> 
> 赞同：0
> 
> 时间：2013-03-07T22:32:41.793
> 
> 标签：jquery, addclass, attr

```
<div class="search_content_container float_left" style="margin-top:3px;">
            <input tabindex="2" id="simple_search_button" class="search_content_button spaceMar15L" type="button" value="Search" />
        </div> 
```

这是我一直在尝试使用的代码。无论我尝试什么，无论是 addClass 还是以下，都不会将类或 ID 添加到输入的父级

```
<script>$("input#simple_search_button").parent().attr('id', 'inputParent');</script> 
```

我能得到一些帮助吗？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:34:22.080

[您必须在准备好文档](http://api.jquery.com/ready/)时调用您的脚本，否则脚本将在您的 dom 元素存在之前执行，因此将无法选择和操作它们。

```
$(document).ready(function() {
   $("input#simple_search_button").parent().attr('id', 'inputParent');
}); 
```

# lua - 使用 Lua 检测键盘按键组合

> ID：15283104
> 
> 赞同：3
> 
> 时间：2013-03-07T22:32:49.640
> 
> 标签：lua, add-on, world-of-warcraft

我正在编写魔兽世界插件，我希望插件能够基于按键或按键组合执行某些功能。大多数关键状态现在都是受保护的 WoW API 功能，但插件仍然可以使用以下功能：

```
IsAltKeyDown()
IsControlKeyDown()
IsShiftKeyDown() 
```

我想要做的是根据这些键中的任何一个或其中的组合执行一项功能。

这就是我的工作：

```
function KeyCombos()
    total = 0
    if IsShiftKeyDown() then
        total = total + 1
    end
    if IsControlKeyDown() then
        total = total + 2
    end
    if IsAltKeyDown() then
        total = total + 4
    end
end 
```

现在我的问题不一定是关于 Lua，因为上面的函数正在工作，因为我可以检查总是否等于 6，例如查看 Control 和 Alt 是否都被按下。我的问题更多是算法问题。有没有更好的方法以编程方式执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T14:02:10.803

如果您要使用一张桌子，在一般情况下，最好保留同一张桌子。

```
function KeyCombos()
    keys = keys or {}

    keys.shift = IsShiftKeyDown()
    keys.control = IsControlKeyDown()
    keys.alt = IsAltKeyDown()
end 
```

或者，如果您愿意

```
function KeyCombos()
    if not keys then
        keys = {}
    end

    keys.shift = IsShiftKeyDown()
    keys.control = IsControlKeyDown()
    keys.alt = IsAltKeyDown()
end 
```

但是，问题中的原始示例使用整数数学的性能要好得多。

* * *

然而，这些示例都创建了全局变量。所以：

```
function GetKeyCombos()
    local keys = 0

    if IsShiftKeyDown() then
        keys = keys + 1
    end
    if IsControlKeyDown() then
        keys = keys + 2
    end
    if IsAltKeyDown() then
        keys = keys + 4
    end

    return keys
end 
```

会好很多。在《魔兽世界》中，所有插件共享相同的全球环境，因此最好保持清洁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:01:08.230

对我来说似乎已经很好听了。

但是，作为替代方案，您可以使用表格：

```
function KeyCombos()
    keys = {
        shift = IsShiftKeyDown(),
        control = IsControlKeyDown(),
        alt = IsAltKeyDown(),
    }
end 
```

然后你可以打电话`keys.alt`或`keys["alt"]`看看它是否被按下。

更具可读性？大概。更高效？不见得。但是我对 Lua 的表现不是很了解。

我只想在`KeyCombos`函数上方添加一个注释块，说明每个可能的组合及其含义。

[作为旁注，它是 Lua，而不是 LUA。](http://www.lua.org/about.html)

# python - 在 Python 中查找字符串中有多少个不同的字母

> ID：15283105
> 
> 赞同：3
> 
> 时间：2013-03-07T22:32:52.133
> 
> 标签：python, string, pangram

我对 Python 3 和编程非常陌生。我试图找到一种算法来找出一个句子何时是一个 pangram。借助 string 模块的功能，我已经解决了讨价还价的问题，但我还需要找出非 pangrams 中有多少不同的字母（已经将它们切换为小写字母）。

任何帮助都会非常受欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T22:34:07.873

尝试查看这组字母的长度：

```
len(set(yourstring))

In [8]: set('lowercase')
Out[8]: set(['a', 'c', 'e', 'l', 'o', 's', 'r', 'w'])

In [9]: len(set('lowercase'))
Out[9]: 8 
```

不要忘记删除空格。

```
In [10]: len(set('The quick brown fox jumps over the lazy dog'.lower().replace(' ', '')))
Out[10]: 26 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:12:34.223

如果您不想计算标点符号，请尝试以下操作：

```
s = "It's the economy, stupid!"
t = set(c.lower() for c in s if c.isalnum())
len(t) #returns 13 
```

或者，如果您只想要字母：

```
s = "It's the economy, stupid!!!11!!"
t = set(c.lower() for c in s if c.isalpha())
len(t) #returns 13 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-13T14:04:04.400

你可以试试这个：

```
s = 'The quick brown fox jumps over the lazy dog'
count = len(set(c.lower() for c in s if c != ' ')) 
```

在这里，计数将是 26。

# c# - 在 C# 中创建不可变类的最简洁方法是什么？

> ID：15283109
> 
> 赞同：8
> 
> 时间：2013-03-07T22:33:10.527
> 
> 标签：c#, tuples, immutability

我发现自己必须创建很多不可变的类，并且我想找到一种没有多余信息的方法。我不能使用匿名类型，因为我需要从方法中返回这些类。我想要智能感知支持，所以我不想使用字典、动态或类似的东西。我还想要名称良好的属性，它排除了 Tuple<>。到目前为止，我尝试过的一些模式：

```
// inherit Tuple<>. This has the added benefit of giving you Equals() and GetHashCode()
public class MyImmutable : Tuple<int, string, bool> {
   public MyImmutable(int field1, string field2, bool field3) : base(field1, field2, field3) { }

   public int Field1 { get { return this.Item1; } }
   public string Field2 { get { return this.Item2; } }
   public bool Field3 { get { return this.Item3; } }
}

///////////////////////////////////////////////////////////////////////////////////

// using a custom SetOnce<T> struct that throws an error if set twice or if read before being set
// the nice thing about this approach is that you can skip writing a constructor and 
// use object initializer syntax.
public class MyImmutable {
    private SetOnce<int> _field1;
    private SetOnce<string> _field2;
    private SetOnce<bool> _field3;

   public int Field1 { get { return this._field1.Value; } set { this._field1.Value = value; }
   public string Field2 { get { return this._field2.Value; } set { this._field2.Value = value; }
   public bool Field3 { get { return this._field3.Value; } set { this._field3.Value = value; }
}

///////////////////////////////////////////////////////////////////////////////////

// EDIT: another idea I thought of: create an Immutable<T> type which allows you to
// easily expose types with simple get/set properties as immutable
public class Immutable<T> {
    private readonly Dictionary<PropertyInfo, object> _values;       

    public Immutable(T obj) {
        // if we are worried about the performance of this reflection, we could always statically cache
        // the getters as compiled delegates
        this._values = typeof(T).GetProperties()
            .Where(pi => pi.CanRead)
            // Utils.MemberComparer is a static IEqualityComparer that correctly compares
            // members so that ReflectedType is ignored
            .ToDictionary(pi => pi, pi => pi.GetValue(obj, null), Utils.MemberComparer);
    }

    public TProperty Get<TProperty>(Expression<Func<T, TProperty>> propertyAccessor) {
        var prop = (PropertyInfo)((MemberExpression)propertyAccessor.Body).Member;
        return (TProperty)this._values[prop];
    }
}

// usage
public class Mutable { int A { get; set; } }

// we could easily write a ToImmutable extension that would give us type inference
var immutable = new Immutable<Mutable>(new Mutable { A = 5 });
var a = immutable.Get(m => m.A);

// obviously, this is less performant than the other suggestions and somewhat clumsier to use.
// However, it does make declaring the immutable type quite concise, and has the advantage that we can make
// any mutable type immutable

///////////////////////////////////////////////////////////////////////////////////

// EDIT: Phil Patterson and others mentioned the following pattern
// this seems to be roughly the same # characters as with Tuple<>, but results in many
// more lines and doesn't give you free Equals() and GetHashCode()
public class MyImmutable 
{
   public MyImmutable(int field1, string field2, bool field3)
   {
        Field1 = field1;
        Field2 = field2;
        Field3 = field3;
   }

   public int Field1 { get; private set; }
   public string Field2 { get; private set; }
   public bool Field3 { get; private set; }
} 
```

这些都比创建只读字段、通过构造函数设置它们并通过属性公开它们的“标准”模式稍微简单一些。然而，这两种方法仍然有很多冗余的样板。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:42:09.590

您可以将自动属性与私有设置器一起使用

```
public class MyImmutable 
{
   public MyImmutable(int field1, string field2, bool field3)
   {
        Field1 = field1;
        Field2 = field2;
        Field3 = field3;
   }

   public int Field1 { get; private set; }
   public string Field2 { get; private set; }
   public bool Field3 { get; private set; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T22:41:56.327

查看`public {get;private set;}`属性是否适用于您的情况 - 比单独的字段声明更紧凑，语义完全相同。

更新：正如 ChaseMedallion 在问题中评论和内联的那样，这种方法不提供与方法不同的自动生成`GetHashCode`和方法。`Equals``Tuple`

```
class MyImmutable 
{
    public int MyProperty {get; private set;}

    public MyImmutable(int myProperty)
    {
       MyProperty = v;
    }
} 
```

我喜欢`Tuple`这种方法，因为它提供了可以在有趣的上下文中安全使用的对象并提供了好听的名称。如果我需要创建许多这样的类型，我会考虑重新实现`Tuple`类：

*   在构建时预先计算`GetHashCode` 并存储为对象的一部分，以避免对集合/字符串进行无界检查。可能是可选的，以允许选择在`Dictionary`.
*   隐藏通用名称（即或仅使用[EditorBrowsableAttribute](http://msdn.microsoft.com/en-us/library/system.componentmodel.editorbrowsableattribute%28v=VS.80%29.aspx)`protected`隐藏智能），因此不会混淆 2 组名称。
*   考虑在调试构建/FxCop 规则中强制字段类型不可变...

旁注：查看 Eric Lippert[关于不可变类型的系列](http://blogs.msdn.com/b/ericlippert/archive/2007/11/13/immutability-in-c-part-one-kinds-of-immutability.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T17:14:14.350

当存在相应的可变类时，不可变类最有用，该类的内容可以轻松地从不可变类型实例加载或复制到新的不可变类型实例。如果一个不可变对象需要对其进行超过 2-3 次“更改”（即更改引用，使其指向与原始对象不同的不可变对象），则将数据复制到可变对象，更改它，并将其存储回来通常比创建一个以某种方式与原始对象不同的对象，然后创建一个以另一种方式不同于该对象的新对象等更实用。

一个很好的易于概括的方法是定义一个（可能是内部的）暴露字段结构类型，然后让可变和不可变类都保存该类型的字段。必须为两种类类型分别定义访问器属性，但可以同时将类型`GetHashCode`和`Equals`方法都链接到底层结构的相应方法。在给定另一个实例的情况下创建任何一种类型的实例都可以使用单个结构赋值来完成，而不必单独复制所有成员。

如果一个程序员了解结构的工作原理（我认为这种知识是基础知识，即使其他人不同意），那么可以将结构类型公开。即使结构是公共的，拥有一个可变持有者类也可能很有用，因为有时引用语义很有用（例如，人们可能希望能够更改存储在 a 中的某些内容`Dictionary`而不必更改其`Dictionary`本身），但是转换to-mutable/change/convert-to-immutable 模式在结构类型上比在类类型上效果更好。

# php - SELECT FROM 子查询性能

> ID：15283112
> 
> 赞同：0
> 
> 时间：2013-03-07T22:33:22.403
> 
> 标签：php, mysql, sql

我正在为我的项目（PHP+MySQL）寻找更高的性能，但查询似乎太慢了（从 1 个表中选择 2 个随机用户）

```
id  | name |  total | img
------------------------ --
1    user1   500      1
2    user2   600      2
3    user3   650      3 
```

__

```
SELECT id1, id2, name1, name2, img1, img2, total1, total2
FROM (
  SELECT
    C1.id AS id1, C1.img AS img1, C1.name AS name1,
    C2.id AS id2, C2.img AS img2, C2.name AS name2,
    C1.total AS total1, C2.total AS total2
  FROM users C1, users C2
  WHERE C1.id <> C2.id
    AND ABS(C1.total - C2.total) < 200
) as t
ORDER BY RAND()
LIMIT 1 
```

结果

```
id1  | id2|  name1 | name2 | img1 | img2 |  total1 | total2
------------------------ -------------------------------------
1       3    user1   user3    1      3        500      650 
```

有什么办法可以改善吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T22:34:32.453

确保为 where 子句中的所有列创建了索引：

```
CREATE TABLE `users` (
`id` INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`name` VARCHAR( 255 ) NOT NULL ,
`total` INT NOT NULL ,
`img` INT NOT NULL ,
INDEX ( `total`)
); 
```

另请注意，以下查询（没有子查询）将为您提供相同的结果

```
SELECT
  C1.id AS id1, C1.img AS img1, C1.name AS name1,
  C2.id AS id2, C2.img AS img2, C2.name AS name2,
  C1.total AS total1, C2.total AS total2
FROM users C1, users C2
WHERE C1.id <> C2.id 
  AND ABS(C1.total - C2.total) < 200
ORDER BY RAND()
LIMIT 1 
```

您可以在[sql fiddle进行检查](http://sqlfiddle.com/#!2/fe57e/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T22:39:12.377

您也许可以优化 inner `SELECT`，但 using`ORDER BY RAND()`将始终将性能转变为...我想不出比 sh*t 更好的词了。基本上，您是在告诉您的 DBMS 引入所有索引并重新排序整个数据集，一旦该数据集变得不仅仅是“小”，它将对性能造成非常显着的影响。

我今天刚刚写了[另一个关于这个的答案](https://stackoverflow.com/questions/15277684/select-a-random-row-but-not-an-equal-one-from-a-database-with-php/15278235#15278235)，只要你不介意结果不一定每次都不同，它应该可以工作。

## 编辑

我刚刚注意到您只选择*了*一行。试试这个：

```
$rs = $dbh->query(
"SELECT COUNT(*) AS 'count'
 FROM users C1, users C2
 WHERE C1.id <> C2.id
   AND ABS(C1.total - C2.total) < 200");
$target = rand(0,$rs[0]['count']);
$rs = $dbh->query(
  "SELECT 
   C1.id AS id1, C1.img AS img1, C1.name AS name1,
   C2.id AS id2, C2.img AS img2, C2.name AS name2,
   C1.total AS total1, C2.total AS total2
  FROM users C1, users C2
  WHERE C1.id <> C2.id
   AND ABS(C1.total - C2.total) < 200
  LIMIT ?,1",
array($target)); 
```

它将利用您的索引，并且不需要对可能很大的数据集进行重新排序。

在主键不等于自身的条件下自连接表也不是一个超级主意，您实际上是在平方数据集的大小。包含 1000 行的表将生成包含 999,000 行的集合。我认为将“总”条件滚动到显式 JOIN 会降低性能损失，但我不确定。

改变：

```
 FROM users C1, users C2
  WHERE C1.id <> C2.id
   AND ABS(C1.total - C2.total) < 200 
```

到：

```
 FROM users C1 INNER JOIN users C2
   ON C1.id <> C2.id
     AND ABS(C1.total - C2.total) < 200 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T22:51:46.933

正如已经建议的那样，您可以使用索引对其进行优化。但是，我建议以编程方式执行“随机”逻辑。尽管对较小的表使用 ORDER BY RAND() 非常好，但对于较大的表来说效率非常低（例如，如果您有一个包含 10,000 条记录的表，它必须生成 10,000 个随机数并且（AFAIK）选择最小的一个）。

我建议使用两个查询。选择 COUNT，从中生成一个随机数，然后在 LIMIT 子句中使用该值。

例子：

```
//get the total number of rows
$result= mysql_query(" SELECT  COUNT(*) AS total FROM `table` ");
$row = mysql_fetch_array($result);
$total=$row['total'];

//create random value from 1 to the total of rows 
$randomvalue =rand(1,$total);

//get the random row
$result= mysql_query(" SELECT  * FROM `table` limit $randomvalue,1"); 
```

在您的特定情况下，您可以生成两个随机数并选择两个用户（只需确保随机数不相等）。

[编辑：在这里](https://stackoverflow.com/questions/7960714/how-to-optimize-slow-mysql-query-due-to-order-by-rand)找到类似的例子。

# ios - 为什么我会收到 SQLITE_MISUSE : Out of Memory 错误？

> ID：15283117
> 
> 赞同：2
> 
> 时间：2013-03-07T22:33:38.863
> 
> 标签：ios, objective-c, sqlite

我正在编写一个*直接*访问`SQLite`. *我在Android*上做过很多次这样的事情，所以我很难看出我的错误在哪里 - 但是我的插入返回`SQLITE_MISUSE`错误（代码 21），并显示消息“内存不足”。以下是我为引导我进入此插页而采取的步骤。

一、建**表**：

```
NSString *sql = @"CREATE TABLE IF NOT EXISTS UsersTable (lastName TEXT,id TEXT PRIMARY KEY NOT NULL,picture BLOB,firstName TEXT,age TEXT,email TEXT,sex TEXT,height TEXT,weight TEXT)";

//create the database if it does not yet exist
NSFileManager *filemgr = [NSFileManager defaultManager];
if ([filemgr fileExistsAtPath: path ] == NO)
{
    const char *dbpath = [path UTF8String];

    //This was if (sqlite3_open(dbpath, &store) == SQLITE_OK) , but it has not made a difference.
    if (sqlite3_open_v2(dbpath, &store, SQLITE_OPEN_READWRITE | SQLITE_OPEN_CREATE, NULL) == SQLITE_OK)
    {
        char *errMsg = NULL;
        const char *sql_stmt = [sql UTF8String];

        if (sqlite3_exec(store, sql_stmt, NULL, NULL, &errMsg) != SQLITE_OK)
        {
            NSLog(@"Failed to create table: %s", errMsg);
        }
        if (errMsg)
            sqlite3_free(errMsg);
    }
    else
    {
        NSLog(@"Failed to open/create database");
    }
} 
```

接下来，**插入**（当前使用用户 ID 的电子邮件地址）：

```
INSERT INTO UsersTable (id,lastName,firstName,email) VALUES ("jsmith@foobar.com","Smith","John","jsmith@foobar.com") 
```

我为所有数据库交互使用了一个选择器，所以上面的文本在这里传递：

```
-(int)execSQL:(NSString *)statement
{
    NSLog(@"%@",statement);

    const char *insert_stmt = [statement UTF8String];
    sqlite3_stmt *stmnt;

    sqlite3_prepare_v2(store, insert_stmt, -1, &stmnt, NULL);
    int result = sqlite3_step(stmnt);

    sqlite3_finalize(stmnt);

    if (result != SQLITE_OK)
    {
        NSLog(@"Error: %s", sqlite3_errmsg(store));//This prints "Error: out of memory"
    }
    return result;
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-07T23:15:00.570

如果数据库不存在，您的打开例程只会创建/打开数据库。您的数据库可能已经存在，因此您的例程甚至没有打开它。

最重要的是，如果您尝试在不打开数据库的情况下调用 SQLite 函数，您将获得`SQLITE_MISUSE`返回码（这表明 SQLite 函数没有按正确的顺序调用）并且`sqlite3_errmsg`将返回神秘的“内存不足”错误。

* * *

其他一些不相关的观察：

1.  你真的应该检查返回码`sqlite3_prepare`：

    ```
    - (int)execSQL:(NSString *)statement
    {
        int result;

        NSLog(@"%@",statement);

        const char *insert_stmt = [statement UTF8String];
        sqlite3_stmt *stmnt;

        if ((result = sqlite3_prepare_v2(store, insert_stmt, -1, &stmnt, NULL)) != SQLITE_OK)
        {
            NSLog(@"%s: prepare failure '%s' (%d)", __FUNCTION__, sqlite3_errmsg(store), result);
            return result;
        }

        if ((result = sqlite3_step(stmnt)) != SQLITE_DONE)
        {
            NSLog(@"%s: step failure: '%s' (%d)", __FUNCTION__, sqlite3_errmsg(store), result);
        }

        sqlite3_finalize(stmnt);

        return result;
    } 
    ```

    `sqlite3_prepare_v2`根据我的经验，许多常见的开发问题都与 SQL 本身有关，可以通过检查语句的返回码来识别。

2.  您真的不应该在`NSString`. 您打开自己的 SQL 注入攻击，或者考虑到更良性的情况，如果某人的名字中有引号，则只是一个 SQL 错误，例如`The "Destroyer"`。您应该使用`?`占位符，然后使用[`sqlite3_bind_xxx`](http://sqlite.org/c3ref/bind_blob.html)函数来绑定值。就像是：

    ```
    - (int)insertIdentifier:(NSString *)identifier
                   lastName:(NSString *)lastName
                  firstName:(NSString *)firstName
                      email:(NSString *)email
    {
        int result;

        const char *insert_stmt = "INSERT INTO UsersTable (id, lastName, firstName, email) VALUES (?, ?, ?, ?);";
        sqlite3_stmt *stmnt;

        if ((result = sqlite3_prepare_v2(store, insert_stmt, -1, &stmnt, NULL)) != SQLITE_OK)
        {
            NSLog(@"%s: prepare failure '%s' (%d)", __FUNCTION__, sqlite3_errmsg(store), result);
            return result;
        }

        if ((result = sqlite3_bind_text(stmnt, 1, [identifier UTF8String], -1, NULL)) != SQLITE_OK)
        {
            NSLog(@"%s: bind #1 failure '%s' (%d)", __FUNCTION__, sqlite3_errmsg(store), result);
            sqlite3_finalize(stmnt);
            return result;
        }

        if ((result = sqlite3_bind_text(stmnt, 2, [lastName UTF8String], -1, NULL)) != SQLITE_OK)
        {
            NSLog(@"%s: bind #2 failure '%s' (%d)", __FUNCTION__, sqlite3_errmsg(store), result);
            sqlite3_finalize(stmnt);
            return result;
        }

        if ((result = sqlite3_bind_text(stmnt, 3, [firstName UTF8String], -1, NULL)) != SQLITE_OK)
        {
            NSLog(@"%s: bind #3 failure '%s' (%d)", __FUNCTION__, sqlite3_errmsg(store), result);
            sqlite3_finalize(stmnt);
            return result;
        }

        if ((result = sqlite3_bind_text(stmnt, 4, [email UTF8String], -1, NULL)) != SQLITE_OK)
        {
            NSLog(@"%s: bind #4 failure '%s' (%d)", __FUNCTION__, sqlite3_errmsg(store), result);
            sqlite3_finalize(stmnt);
            return result;
        }

        if ((result = sqlite3_step(stmnt)) != SQLITE_DONE)
        {
            NSLog(@"%s: step failure: '%s'", __FUNCTION__, sqlite3_errmsg(store));
        }

        sqlite3_finalize(stmnt);

        return result;
    } 
    ```

    然后你可以这样称呼它：

    ```
    [self insertIdentifier:@"jsmith@foobar.com"
                  lastName:@"Smith"
                 firstName:@"John"
                     email:@"jsmith@foobar.com"]; 
    ```

3.  正如您所看到的，当您开始编写代码时，您会适当地检查每个返回值、绑定每个变量等，您的 SQLite 代码会很快变得非常麻烦。我建议您考虑查看[FMDB](https://github.com/ccgus/fmdb)。它是 SQLite 函数的一个很好的薄包装器，它极大地简化了在 Objective-C 中编写 SQLite 代码的练习。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:48:52.153

您没有检查`sqlite3_prepare_v2`语句的值。如果不是，`SQLITE_OK`那就有问题了。

另外，数据库文件是否已经存在？如果没有，您需要创建它或从包中加载它。

# opencl - 如何在 pyOpenCL 中分散列表？

> ID：15283119
> 
> 赞同：1
> 
> 时间：2013-03-07T22:33:47.833
> 
> 标签：opencl, pyopencl

让我们的列表大小为 500，我们有 4 个内核，我们希望将列表的 1/4 分配给每个内核。我们如何在 OpenCL 或 pyOpenCl 中做到这一点？

我知道某处可能应该存在障碍，但是我们如何将数据发送到其他内核？OpenCL 中是否有 Scatter 的示例？

# javascript - JavaScript - 设置变量

> ID：15283120
> 
> 赞同：0
> 
> 时间：2013-03-07T22:33:54.047
> 
> 标签：javascript

在以下 JavaScript 代码中，function(result) 返回的值是正确的。所以我看到两个警报视图 - 一个具有正确的值，第二个警报只返回 1。所以我的问题是 - 我如何保存 mainResult 的值以便它显示相同的输出？

```
var mainResult = 1;
Download.beginDownload(arr,
       function(result){
          mainResult = result;
          alert(result);
          }, function(result){
                alert("here2");
                console.log(result);
          }
 );

alert(mainResult); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:37:46.600

您有某种异步调用，并且您正在像同步一样进行操作。

在回调发生之前调用警报。

# javascript - jquery内容过滤淡化效果

> ID：15283126
> 
> 赞同：0
> 
> 时间：2013-03-07T22:34:15.737
> 
> 标签：javascript, jquery, filter

* * *

我写了一个小的 jquery 内容过滤器： [jsfiddle](http://jsfiddle.net/k6BPs/5/)。

例如，如果我在“gfx”和“coding”之间切换，我会在红色父 div 上得到这种丑陋的高度调整效果。我的目标是在同一个地方淡出小 div。无需任何调整大小且不使用固定高度。（项目数量以后可能会有所不同）

有什么提示我可以做到这一点吗？

```
var filter = $(this).attr('data-filter');
$('#filter_container .filteritem:not(' + filter + ')').fadeOut('slow', function () {
    $('#filter_container ' + filter + '').fadeIn('fast');
}); 
```

有关详细信息和工作示例，请参阅 jsfiddle。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:47:48.273

[http://jsfiddle.net/k6BPs/8/](http://jsfiddle.net/k6BPs/8/)

显然为每个元素调用了 fadeOut() 回调。[见这里](https://stackoverflow.com/a/10183934/1503476)。这样，它会立即被触发，防止在fadeOut() 之后产生漂亮的fadeIn() 效果。

[`.promise()`](http://api.jquery.com/promise/)不过，您可以通过使用and`.done(function(){})`方法来克服这个问题。

# ios - 从 NSMutableArray 中的解析数据中检索元素值

> ID：15283127
> 
> 赞同：0
> 
> 时间：2013-03-07T22:34:21.243
> 
> 标签：ios, nsmutablearray

我有以下 XML 结构：

```
<product>
 <id>3482</id>
 <title>Product 1</title>
 <number>1</number>
 <description>Text</description>
</product>

<product>
 <id>4743</id>
 <title>Product 2</title>
 <number>2</number>
 <description>Text</description>
</product>

<product>
 <id>3864</id>
 <title>Product 3</title>
 <number>3</number>
 <description>Text</description>
</product> 
```

一切都被解析并保存在我的 NSMutableArray 中。现在我只想检索键“title”的值。但是当我打印我的 NSMutableArray 时，我得到：

```
"<ChartListDataParserEntries: 0x1edf3c00>" 
```

在 ChartListDataParserEntries.m 中，我正在管理已解析的 XML 文件的元素。

我已经尝试过：

for (ChartListDataParserEntries *CLDPE in self.parsedChartNew) {}

但这只是给我一个元素的一个结果。

那么我如何才能捕获所有“标题”值（产品 1、产品 2、产品 3...）？

## 编辑

```
- (id)initWithData:(NSData *)data delegate:(id <ChartListParserDelegate>)theDelegate
{
    self = [super init];

    if (self != nil)
    {
        self.dataToParse = data;
        self.delegate = theDelegate;
    }

    return self;
}

- (void)main
{
    NSXMLParser *parser = [[NSXMLParser alloc] initWithData:self.dataToParse];
    [parser setDelegate:self];
    [parser parse];

    self.dataToParse = nil;
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qualifiedName attributes:(NSDictionary *)attributeDict
{
    if ([elementName isEqualToString:@"chart"])
    {
        return;
    }
    else if ([elementName isEqualToString:@"new"])
    {
        self.fullyParsedChartNew = [NSMutableArray array];
        chartListDataEntries = [[ChartListDataParserEntries alloc] init];
    }
    else if ([elementName isEqualToString:@"soon"])
    {
        self.fullyParsedChartSoon = [NSMutableArray array];
        chartListDataEntries = [[ChartListDataParserEntries alloc] init];
    }
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string
{
    if (!self.parsingResults)
    {
        self.parsingResults = [NSMutableString stringWithString:string];
    }
    else
    {
        [self.parsingResults appendString:string];
    }
}

- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError
{
    NSLog(@"%@", parseError);
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{
    if ([elementName isEqualToString:@"chart"])
    {
        return;
    }
    else if ([elementName isEqualToString:@"new"])
    {
        [self.fullyParsedChartNew addObject:chartListDataEntries];
        chartListDataEntries = nil;
    }
    else if ([elementName isEqualToString:@"soon"])
    {
        [self.fullyParsedChartSoon addObject:chartListDataEntries];
        chartListDataEntries = nil;
    }
    else
    {
        [chartListDataEntries setValue:self.parsingResults forKey:elementName];
        self.parsingResults = nil;
    }
}

- (void)parserDidEndDocument:(NSXMLParser *)parser
{
    if (![self isCancelled])
    {
        NSLog(@"%@", [self.fullyParsedChartNew valueForKeyPath:@"product_title"]);
        [self.delegate didFinishParsing:self.fullyParsedChartNew andChart:self.fullyParsedChartSoon];
    }
} 
```

ChartListDataParserEntries.h

```
@interface ChartListDataParserEntries : NSObject
{
    NSString *product_id;
    NSString *product_title;
    NSString *product_genre;
    NSString *product_price;
    NSString *product_stock;
    NSString *product_stock_color;
    NSString *product_stock_text;

    UIImage *product_image;
}

@property (nonatomic, retain) NSString *product_id;
@property (nonatomic, retain) NSString *product_title;
@property (nonatomic, retain) NSString *product_genre;
@property (nonatomic, retain) NSString *product_price;
@property (nonatomic, retain) NSString *product_stock;
@property (nonatomic, retain) NSString *product_stock_color;
@property (nonatomic, retain) NSString *product_stock_text;

@property (nonatomic, retain) UIImage *product_image;

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:45:31.740

尝试：

```
NSArray *titleArray = [array valueForKey:@"title"]; 
```

这将返回一个包含所有标题的数组。

# java - 从数组中选择前 10 个最常出现的字符串，java

> ID：15283135
> 
> 赞同：1
> 
> 时间：2013-03-07T22:34:34.817
> 
> 标签：java, string, performance, algorithm, search

我有一个字符串数组，我想从中找到前 10 个最常出现的字符串。

这样做的一种原始方法当然是遍历数组一次，获取所有不同字符串的堆栈/队列，将这些不同的字符串存储在一个数组中，然后检查这个新数组中每个字符串在原始数组，最后将值存储在“n”个不同的整数中，其中 n 是不同字符串的数量。

显然，就时间效率而言，这是一种可怕的方法，所以我想知道是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:37:52.547

如果您不关心内存，则可以构建一个包含每个字符串的计数的哈希映射：您循环遍历所有字符串并为您执行的每个字符串

```
myhash[mystring] += 1 
```

如果字符串已经存在于哈希中，或者

```
myhash[mystring] = 1 
```

除此以外。

如果您认为在哈希映射中查找值是在恒定时间内进行的（这不可能是真的），那么这个算法是“唯一的” `O(n)`（但它会占用大量内存）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T22:48:21.903

如果您关心内存，您可以对数组进行排序，然后轻松计算每个字符串出现的次数（每个字符串将首先出现在位置 i、i+1、i+2、...、i+k 和其他位置） .

排序将花费 O(n log n)，而不是 O(n) 来计算字符串的出现次数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T22:49:00.297

您可以使用[Guava Multiset](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Multiset.html)添加所有字符串，然后`Multisets.copyHighestCountFirst()`仅查看前 10 个字符串

请参阅[此问题](https://stackoverflow.com/questions/4345633/simplest-way-to-iterate-through-a-multiset-in-the-order-of-element-frequency)以获取示例

# java - Java Eclipse 组织导入的 C++ 代码块等效选项

> ID：15283138
> 
> 赞同：1
> 
> 时间：2013-03-07T22:34:41.437
> 
> 标签：java, c++, eclipse, codeblocks

我已经在 Eclipse for Java 上工作了一段时间，最近我开始使用 CodeBlocks for C/C++，但我发现令人沮丧的是我不知道如何在 CodeBlocks 中“组织导入”。在 Eclipse 中它是 CTRL+SHIFT+O，虽然我不确定 CodeBlocks 中是否有类似的东西。有什么想法可以做到这一点，或者如何从程序本身中找到我在 CodeBlocks 中使用的函数的库名称（标题）？

# facebook - Facebook标签高度自动调整大小

> ID：15283146
> 
> 赞同：1
> 
> 时间：2013-03-07T22:35:01.997
> 
> 标签：facebook, tabs, facebook-apps

我有我创建的 Facebook 选项卡，其中包含 3 个 div 块，但高度太大，而且我有一个滚动条。这就是为什么我将“溢出：隐藏”CSS 与正文 html 放在一起。它不起作用。所以我在网上找到了一件好事：

```
<div id="fb-root"></div>
<script src="http://connect.facebook.net/en_US/all.js"></script>
<script>
FB.init({
appId : 'MY_APP_ID',
status : true, // check login status
cookie : true, // enable cookies to allow the server to access the session
xfbml : true // parse XFBML
});
</script>

<script type="text/javascript">
window.fbAsyncInit = function() {
FB.Canvas.setSize( { height: 1000 } );
}
</script> 
```

这仅适用于 Firefox 和 Safari，但在 Chrome 和 IE 上我没有滚动条，但如果我想进入标签底部，我必须左键单击才能滚动并查看底部。我如何在 Chrome 和 IE 上调整这个东西？你认为我的 CSS id 不好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T01:14:53.790

检查一下：[https](https://developers.facebook.com/docs/reference/javascript/FB.Canvas.setAutoGrow/) ://developers.facebook.com/docs/reference/javascript/FB.Canvas.setAutoGrow/并查看左列底部的其他 Canvas 方法链接。

自从我更新自己的应用程序大小调整代码以来已经有几个月了，而且这些东西一直在变化，但以下内容对我有用，放在页面的结束标记之前。我不能确定，但​​您可能还需要 style="overflow:hidden" 在您的开始正文标签中。

希望这可以帮助 ：）

```
<script type="text/javascript" language="javascript" src="http://connect.facebook.net/en_US/all.js"></script>
<script type="text/javascript" language="javascript">
    FB.init({
        appId: '<YOUR_APP_ID>',
        status: true, // check login status
        cookie: true, // enable cookies to allow the server to access the session
        xfbml: true// parse XFBML
    });
    window.fbAsyncInit = function () {
        FB.Canvas.setSize();
    }

    FB.Canvas.setAutoGrow(7);
</script> 
```

我还为您找到了这个：http: [//petetasker.wordpress.com/2012/10/31/facebook-set-auto-grow-a-version-that-actually-works/](http://petetasker.wordpress.com/2012/10/31/facebook-set-auto-grow-a-version-that-actually-works/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T18:20:36.533

调用 FB JS 时，请确保它不是绝对的。根据查看器的 SSL 设置，它可能会引发错误并且自动调整大小将不起作用。错误的：

```
<script type="text/javascript" src="https://connect.facebook.net/en_US/all.js"></script> 
```

正确的：

```
<script type="text/javascript" src="//connect.facebook.net/en_US/all.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T17:55:09.520

```
<script type="text/javascript" src="https://connect.facebook.net/en_US/all.js"></script>

<script type="text/javascript">
    window.fbAsyncInit = function() {
      FB.init({
        appId      : 'YOUR_APP_ID'
      });
      FB.Canvas.setAutoGrow();
    }
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-15T16:17:05.523

使用 setAutoGrow() 的答案都不适合我，所以我必须用 JavaScript 计算内容高度，然后相应地使用 setSize()。

```
window.fbAsyncInit = function() {

    FB.init({
        appId      : 1234567890,
        xfbml      : true,
        version    : 'v2.3'
    });

    // Find the container that spans your entire content
    var contentWrapper = document.getElementById("content-wrapper");

    // Calculate element height using different methods because some browsers might calculate the height differently, then choose the highest
    var contentHeight = Math.max(wrapper.scrollHeight, wrapper.offsetHeight, wrapper.clientHeight);

    // Set canvas size
    FB.Canvas.setSize({ width: 810, height: contentHeight});

}; 
```

# shell - 如何将 shell 变量传递给 autogen.sh 脚本

> ID：15283147
> 
> 赞同：3
> 
> 时间：2013-03-07T22:35:03.820
> 
> 标签：shell, makefile, configure, autoconf

我从其他 Makefile 调用 autogen.sh 脚本，并且从 shell 脚本调用这个 Makefile，如果我在这个更外部的脚本上设置一个变量 VAR，我可以在这个 Makefile 中正常使用它，真的 VAR 存在并被定义，但是当这个 Makefile 运行 autogen.sh 时，我不能在 configure.in 文件中使用变量 VAR，获得这个（或任何其他变量）的唯一方法是在更多外部 shell 中使用 export 命令。

编译：pushd $(DIRNAME); \如果测试！-e 生成文件；然后 \ 回声 $PKG_CONFIG_PATH; \ ./autogen.sh $(CONFIGURE_OPTIONS); \fi; \ 制作; \弹出

这是最好的方法吗？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:41:32.623

您可以遵循 Idelic 的建议，将变量`autogen.sh`作为命令的一部分显式传递：

```
PKG_CONFIG_PATH="$(PKG_CONFIG_PATH)" ./autogen.sh $(CONFIGURE_OPTIONS) 
```

或者，如果您有多个从中调用的脚本和命令，`Makefile`并且您想将一堆环境变量导出到从 this 调用的任何命令中`Makefile`，您可以将这些行添加到您的`Makefile`：

```
export PKG_CONFIG_PATH="YOUR_PKG_CONFIG_PATH"
export FOO="BLAH"
export BAR="BLAH-BLAH" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T22:37:48.000

您可以在`autogen.sh`调用中显式传递变量：

```
PKG_CONFIG_PATH="$(PKG_CONFIG_PATH)" ./autogen.sh $(CONFIGURE_OPTIONS) 
```

# symfony - Twig：在 if 条件下过滤

> ID：15283151
> 
> 赞同：2
> 
> 时间：2013-03-07T22:35:23.240
> 
> 标签：symfony, twig

我想在 Twig 的 if 条件中使用过滤器。原因是Symfony2的一个属性，我不能直接比较，得提前改一下。我从这段代码开始：

```
{% if app.request.attributes.get('_controller')|split('::')|first == 'some\controller\name' %}
  do something
{% endif %} 
```

不幸的是，这不起作用。所以我想我会在比较之前使用 set ：

```
{% set controller = app.request.attributes.get('_controller')|split('::')|first %}
{% if controller == 'some\controller\name' %}
  do something
{% endif %}
{{ controller }} {# would print 'some\controller\name' #} 
```

你猜怎么了？*即使变量控制器*现在存在并且具有我与之比较的值，也不会打印“做某事” 。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T22:58:31.010

好的，我测试了它，Twig 有一个奇怪的行为。“\”被转义或类似的东西。我用 var_dump 函数扩展了我的树枝环境，检查一下：

```
{{ var_dump("Sybio\Bundle\WebsiteBundle\Controller\MainController") }}
//string(48) "SybioBundleWebsiteBundleControllerMainController"

{{ var_dump(app.request.attributes.get('_controller')|split('::')|first) }}
// string(52) "Sybio\Bundle\WebsiteBundle\Controller\MainController"

{{ var_dump("Sybio\\Bundle\\WebsiteBundle\\Controller\\MainController") }}
// string(52) "Sybio\Bundle\WebsiteBundle\Controller\MainController" 
```

这就是为什么你的测试总是错误的。您需要将比较字符串的反斜杠加倍...

```
{% if app.request.attributes.get('_controller')|split('::')|first == 'some\\controller\\name' %}
  do something
{% endif %} 
```

# javascript - 调整浏览器大小时进行图像缩放

> ID：15283157
> 
> 赞同：0
> 
> 时间：2013-03-07T22:36:01.367
> 
> 标签：javascript, css

我正在尝试复制该网站的外观：

[http://www.vindrejse.net/](http://www.vindrejse.net/)

如果您尝试向下重新调整窗口大小，您可以看到图像大小也会重新调整大小，究竟是如何实现这一目标的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:40:04.397

我已经为这个问题写了一个 jQuery 插件：[https ://github.com/yckart/jquery.fitpic.js](https://github.com/yckart/jquery.fitpic.js)

这是给你的一个例子：http: [//yckart.github.com/jquery.fitpic.js](http://yckart.github.com/jquery.fitpic.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:44:14.400

如果您只是担心现代浏览器，您可以使用 CSS3

```
background-size: cover; 
```

宣言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:07:50.807

最接近行业标准的是 BackStretch 插件： [http ://srobbin.com/jquery-plugins/backstretch/](http://srobbin.com/jquery-plugins/backstretch/)

它适用于整页背景和 DIV 元素。非常简单的配置。支持过渡。

# asp.net-mvc - .NET MVC：计算 Web 应用程序中的操作方法

> ID：15283158
> 
> 赞同：4
> 
> 时间：2013-03-07T22:36:02.097
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我们有一个巨大的 ASP.NET MVC 3 应用程序。我们需要计算在 where 类中有多少公共方法`currentClass is System.Web.Mvc.Controller`。

任何符合此标准的类都将具有“AwesomeProduct.Web”的基本命名空间，但除了这些类可能属于哪个命名空间或有多少深度级别之外，无法保证。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-07T23:05:10.860

像这样的一些反射和LINQ应该这样做

```
var actionCount = typeof(/*Some Controller Type In Your MVC App*/)
                    .Assembly.GetTypes()
                    .Where(t => typeof(Controller).IsAssignableFrom(t))
                    .Where(t => t.Namespace.StartsWith("AwesomeProduct.Web"))
                    .SelectMany(t => t.GetMethods(BindingFlags.Public | BindingFlags.Instance))
                    .Where(m => typeof(ActionResult).IsAssignableFrom(m.ReturnType))
                    .Where(m => !m.IsAbstract)
                    .Where(m => m.GetCustomAttribute<NonActionAttribute>() == null)
                    .Count(); 
```

这不适合异步控制器操作。

# lego - 在 NXC 的循环中使用后如何将变量重置回 0

> ID：15283160
> 
> 赞同：0
> 
> 时间：2013-03-07T22:36:15.360
> 
> 标签：lego, mindstorms, nxc

出于某种奇怪的原因，当循环结束时，变量“角度”不会重置为 0。所有的数学只是计算 c = sqrt(a^2 + b^2 - 2abCos(theta)) 机器人不会在一行中完成所有的数学。在完整代码中，a 和 b 都是变化变量，并且基于超声波传感器输入。

sub 最多可以调用 3 次不同的时间，并且每次调用 sub 时角度变量都需要从 0 开始。

我试过把 float angle = 0; 或者只是角度= 0；在每个可以想象的地方，但没有任何效果。我什至尝试过使用 int angle = 0; 在多个地方。

```
int angle, a, b, c, csqr, theta, cosTheta, aSqrd, bSqrd, atmb, twoab;
#define pi 3.14159265359

sub calculate()  
{

 repeat(2)
 {
 float a = 172.42;
 float angle = angle + 3;
 float theta = ((angle)*(pi/180));
 float b = 172.42;
 float cosTheta = cos(theta);
 float aSqrd = pow(a, 2);
 float bSqrd = pow(b, 2);
 float atmb = (a * b);
 float twoab = (2 * atmb);
 float csqr = ((aSqrd + bSqrd) - (twoab * cosTheta));
 float c = sqrt(csqr);
 NumOut(0,0,angle);
 Wait(3000);
 ClearScreen();
 }
 float angle = 0;

}

task main()
{
     calculate();
     ClearScreen();
     calculate();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T22:38:05.057

因为`float angle`是本地计算方法并隐藏`int angle`在全局范围内。`int angle`没有初始化为任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:39:05.837

在 repeat(2) 循环中有一个未初始化的变量。

```
float angle = angle + 3; 
```

# iphone - 查看 Xcode 中调用了哪些方法

> ID：15283167
> 
> 赞同：2
> 
> 时间：2013-03-07T22:36:49.907
> 
> 标签：iphone, ios, objective-c, xcode

我有一个视图控制器，它会一遍又一遍地重新加载。我希望能够查看正在调用哪些方法，以便我可以看到不断触发重新加载的方法。我知道如果发生错误并且应用程序崩溃，我可以看到调用的内容。但是，在这种情况下没有崩溃。有没有办法监控整个应用程序中调用的所有方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T22:49:35.510

如果您是 XCode 和 Objective C 的新手并且正在寻找轻量级的东西并且您没有大量代码/许多方法，我会说：

```
 NSLog(@"%s",__PRETTY_FUNCTION__); 
```

在每一种方法中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T22:43:24.587

使用仪器。以分析模式启动您的代码并选择 CPU 时间工具。当应用程序运行时，Instruments 将定期收集有关每个调用堆栈的信息，这将允许您查看什么调用了什么。（使用“反转调用树”选项查看给定函数的调用者。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T23:28:16.650

我使用这个宏：

```
#define DEBUG 1

#if DEBUG
#   define NLog(fmt, ...) printf("%s\n", [[NSString stringWithFormat:@"%s:%d  %@", __PRETTY_FUNCTION__, __LINE__, [NSString stringWithFormat:fmt, ##__VA_ARGS__]] UTF8String])
#else
#   define NLog(...)
#endif 
```

然后我将我的 Macros.h 包含在我的 Application_Prefix.pch 文件中，以便它在任何地方都可用。在我发布之前，我将 DEBUG 设置为 0，这样所有的 NLogs 都会消失。

所以现在，我不使用 NSLog，而是使用 NLog。输出看起来像这样：

```
-[ApplicationDelegate applicationDidBecomeActive:]:86  applicationDidBecomeActive called! 
```

该解决方案基于这些较早的帖子：

1.  [如何打印出方法名称和行号并有条件地禁用 NSLog？](https://stackoverflow.com/questions/969130/how-to-print-out-the-method-name-and-line-number-and-conditionally-disable-nslog)
2.  [我需要在发布应用程序之前禁用 NSLog 吗？](https://stackoverflow.com/questions/2025471/do-i-need-to-disable-nslog-before-release-application)

您可以将 NLog 调用放在几个地方，以查看在视图控制器重新加载之前调用了哪些函数。如果您需要知道触发重新加载的确切函数，最好的办法是放置一个断点并检查调用堆栈，正如其他人提到的那样。

# canvas - 避免在画布元素中使用抗锯齿

> ID：15283168
> 
> 赞同：0
> 
> 时间：2013-03-07T22:36:51.403
> 
> 标签：canvas, antialiasing

我知道为了避免线条中的抗锯齿效果，我必须在 x 和 y 坐标中平移 0.5 px。但这在二次曲线中不起作用。我需要在没有抗锯齿效果的情况下绘制二次曲线。我需要用坐标 x,y 和属性 lineTo() 和 quadraticCurveTo() 绘制字母，但我不希望这些字母具有抗锯齿效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T00:31:28.133

**遗憾的是，您目前无法关闭抗锯齿功能。**

上次查看 whatWG 时还在考虑添加这个选项，但目前没有任何建议，也没有浏览器实现关闭抗锯齿功能。

我们得到的最接近的是绘制图像时：

```
context.imageSmoothingEnabled=false;  // see description below 
```

也许你可以拼凑一些使用 drawImage() 来渲染你的字母曲线的东西。我在某处读到three.js 使用这种方法来绘制更平滑的曲线——但是记忆失败了。

*imageSmoothingEnabled的描述*

*   返回是否填充图案，如果图像的像素与显示不完全对齐，drawImage() 方法将尝试平滑图像。可以设置，以更改图像是否平滑（真）或不（假）。见（[http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#image-smoothing](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#image-smoothing)）；

# python - 无法在 Python 中读取完整的文本文件

> ID：15283172
> 
> 赞同：0
> 
> 时间：2013-03-07T22:37:11.380
> 
> 标签：python, nltk

我在从 Python 中读取文件时遇到问题。

我在 Python 中读取的文件大小为 90 Mb。用word打开，总字数在1400万左右。但是当我用 Python 读取文件时，它给我的文件长度约为 900 万字（8,915,710 字）。

当我通过 python 命令查看文件中的最后 100 个单词时

```
print "The length of the Corpus is ", len(tokens), tokens[-100:] 
```

我只从原始文件的中间得到单词。

我使用的是 64 位 Windows 操作系统和 32 位版本的 Python。

PC 规格：i7、1.8Gz、6GB RAM

我想了解为什么 Python 拒绝阅读超过 8,915,710 个单词。

谢谢

代码：

```
f = open('testtext.txt')
raw = f.read()
corp = lowercase(raw)
tokens = nltk.word_tokenize(corp)
print "The number of words is ", len(tokens), tokens[-100:]
print "corp ", len(corp)
print "raw ", len(raw) 
```

我得到以下答案：

```
>> The number of words is  8915710
>> corp  53322476
>> raw  53322476 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:16:54.643

替换这一行：

```
f = open('testtext.txt') 
```

用这条线：

```
f = open('testtext.txt', 'rb') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:13:41.407

尝试将文件处理为二进制文件：

```
f = open('file.txt', "rb")
chunkSize = 1024
dataChunk = f.read(chunkSize)
while len(dataChunk):
    processData(dataChunk)
    dataChunk = f.read(chunkSize) 
```

# iterator - 用于 D 的 Boost.Filesystem 类库

> ID：15283174
> 
> 赞同：4
> 
> 时间：2013-03-07T22:37:21.893
> 
> 标签：iterator, filesystems, d, tree-traversal

有没有人写过一个类似于 Boost.Filesystem 的 D 库，提供迭代器/范围，例如文件系统目录树遍历？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-07T22:46:07.307

[`dirEntries`from`std.file`](http://dlang.org/phobos/std_file.html#.dirEntries)返回一个枚举文件和目录的范围，也可以选择在子目录下。

# wordpress - Apache、Domain、Wordpress、DynDNS 设置问题重定向

> ID：15283175
> 
> 赞同：0
> 
> 时间：2013-03-07T22:37:32.313
> 
> 标签：wordpress, apache, redirect, dns, dyndns

希望有人可以提供帮助，因为我在这里碰壁了！:)

我已经在家里设置了一个 apache web 服务器，并且我已经安装了 wordpress。

我也有自己的域和 dyndns 帐户，我已将 dyndns 记录重新指向不同端口上的主机名。

当我导航到我的网站时，它可以正常工作，但是如果我不在 dyndns 上启用伪装，它会显示我的主机名。我真的不想要这个，因为我希望它只显示我的域名。

如果我在 dyndns 上启用隐藏以使用我的域 url wordpress 排序但是如果我单击登录进入我的控制面板，我会得到一个空白页面，因为它试图导航到我的主机名：端口

请有人能指出我正确的方向吗？我相信他们一定是这样做的！

提前致谢

担

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T21:43:39.257

我使用 Dyn 来管理我的域和 DNS，但我以前从未使用过他们的 WebHop 功能。我检查了它，不幸的是，我认为它不会像您希望的那样为 WordPress 生成一个完全透明的代理。

问题是“当在 WebHop 上启用 Cloaking 时，框架用于掩盖地址和标题栏。” （参考：[这里](https://help.dyn.com/remote-access/webhops-and-redirects-in-dyn-remote-access/)）。`blog.example.com`如果您为该重定向定义了一个隐藏的 WebHop，`http://yourhome.dyndns.org:8080/wordpress/`则显示“属于”`blog.example.com`但显示来自框架内实际主机的内容的页面

```
<frame src="http://yourhome.dyndns.org:8080/wordpress/" name="redir_frame" frameborder="0"
scrolling="auto" noresize="noresize" marginheight="0" marginwidth="0"/> 
```

当您单击链接时，这些框架会让您感到困惑。在您的情况下，您会得到一个空白页，但在 IE9 下我看到

[![此内容无法在框架中显示](../Images/ac5c4d63cabc008d762c75cd3d88c321.png)](https://i.stack.imgur.com/Dud8O.png)

如果在您的 WordPress 设置中，您将“WordPress 地址 (URL)”设置为，`http://yourhome.dyndns.org:8080/wordpress/`然后单击“在新窗口中打开此内容”链接将起作用，但您已经失去了伪装。如果您尝试通过将“WordPress 地址 (URL)”更改为来保留伪装，`http://blog.example.com`那么您的 WordPress 网站也将无法正常工作。

所以，我认为你必须在以下之间做出选择：

1.  使用 WebHop 并公开您的实际主机名/端口（此时隐藏成为一个有争议的问题），或

2.  考虑在另一台服务器上设置反向代理以将流量重定向到您的“主站点”并将链接映射回代理（以实现完全透明）。

# javascript - Jquery 在 IE 9 或更早版本中不工作

> ID：15283181
> 
> 赞同：0
> 
> 时间：2013-03-07T22:37:48.167
> 
> 标签：javascript, jquery, internet-explorer

请原谅我不是最好的 JQuery 程序员，但我遇到了一个问题。我的 Jquery 在 FF/IE10 中完美运行，仅此而已。我不确定为什么，但这是我的代码。如果可能，请帮助！

文本框“custom-url”在加载时也不会 .hide，并且 .show 当下拉列表更改为选项“custom”时，就像在其他浏览器上一样。

我目前正在使用 jquery-1.5.1，这是我的文本框的 html：

```
<input type="text" id="custom-url" style="width:220px;"/> 
```

下一部分仅特定于当前页面，因此它被导入到使用它的页面中。

```
<script type="text/javascript">

    $(document).ready(function () {
        "use strict";
        $("#custom-url").hide();
    });

    $("select#url-list").change(function () {
        "use strict";
        var selectedItem = $("option:selected", $(this)),
        selectedValue = selectedItem.val();
        $("#url").val(selectedValue);
        if (selectedValue === "custom") {
            $("#custom-url").show();
        } else {
            $("#custom-url").hide();
        }
    });

    $("form").submit(function () {
        "use strict";
        var selectedItem = $("select#url-list option:selected"));
        var selectedvalue = selectedItem.val();
        if (selectedvalue === "custom") {
            $("#Url").val($("#custom-url").val());
        } else if (selectedvalue === '') {
        } else {
            $("#Url").val(selectedItem.val());
        }
    });

</script> 
```

下一部分是全局特定的，因此它被导入到 master 中。

```
<script src="@Url.Content("~/Scripts/MyScripts.js")" type="text/javascript"></script>

   $(document).ready(function () {
         var str = $('iframe').attr('src');
         var substr;
         var current_tab = "";

         $("#topNav ul:first-of-type li:last-child").hover(function () {
             $(this).addClass("elementHovered");

         }, function () {
             $(this).removeClass("elementHovered");
         });

         if (str == undefined) {
            // alert($("ul:first-of-type li:last-child").parent().html());

              current_tab = "Admin";

              $("#topNav ul:first-of-type li:last-child").children().addClass("elementHovered");             

         }
         else {

             substr = str.split('/');
             var str = "";
             var i;
             for (i = 0; i < substr.length; ++i) {
                 str = str + "subtri[" + i.toString() + "]" + substr[i] + "         ";
             }

             $('#topNav ul:first-of-type').children('li').each(function () {
                 if (substr[2] == "prototype.sunoconet2012.com") {
                     current_tab = "Documents";
                 }
                 else if (substr[3] == "admin") {
                     current_tab = "Home"
                 }
                 else {
                     switch (substr[1]) {

                         case 'contracts':
                             current_tab = "Account Information"
                             break;
                         case 'financials':
                             current_tab = "Financial"
                             break;
                         case 'pricing':
                             current_tab = "Pricing"
                             break;
                         case 'operations':
                             current_tab = "Operations";
                             break;
                         case 'support':
                             current_tab = "Support"
                             break;
                         case 'admin':
                             current_tab = "Support"
                             break;
                         case 'SunocoUniversity':
                             current_tab = "Training";
                             break;
                         case 'onlinetraining':
                             current_tab = "Training";
                             break;
                         default:
                             current_tab = "Administration";
                             break;
                     }
                 }

                 if (current_tab == $(this).text()) {
                    // alert("current_tab:  " + current_tab + "    this.text:  " + $(this).text());
                     //    alert("substr[1]      = " + substr[1] + "substr[2]      = " + substr[2] + " substr[3]      = '" + substr[3] + "'  current_tab    = " + current_tab + "  $(this).text() = " + $(this).text()); // "this" is the current element in the loop
                     $(this).children().css("background-color", "#4D77A7");
                     $(this).children().css("color", "white");
                 }
             });
         }

     }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T17:00:19.427

更新到 Jquery 1.9.1 就成功了！

# matlab - 根据可变数量的输入捕获所有可能的输出。

> ID：15283184
> 
> 赞同：5
> 
> 时间：2013-03-07T22:37:55.367
> 
> 标签：matlab, variables, capture

我希望 Matlab 返回变量输入函数的所有输出。例如，

[varargout]=cpd_intersect(varargin{:});

这仅返回最后一个输出，但我知道该函数被定义为提供多个输出。

而不是在 [A,B,C...]=pd_intersect(varargin{:}) 中定义虚拟变量 A、B、C 等。我想要一个像单元格一样的东西来存储基于输入值的所有输出值。我希望这是有道理的。提前谢谢了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-05T21:44:05.410

我知道这已经晚了，但我认为这就是你想要的：

```
function [varargout] = myfun(f, varargin)
% apply f to args, and return all its outputs

[ x{1:nargout(f)} ] = f(varargin{:}); % capture all outputs into a cell array
varargout = x;                        % x{:} now contains the outputs of f 
```

这里的见解是

1.  `NARGOUT`可以对函数进行操作并返回它们的最大输出数
2.  `[ X{1:2} ] = ...`当 X 未定义时在左侧使用 using ，相当于 do `[ X{1} X{2} ] = ...`，并且可以将 2 个单独的输出捕获到单独的变量中。

需要注意的两点：

1.  这也适用于匿名函数！例如`@(x)eig(x)`
2.  它不适用于使用 的函数`varargout`，即具有真正可变数量输出的函数。如果是这种情况，那么应该有一种方法来计算您将拥有多少输出，例如使用`nargin`.

PS 我从@gnovice 学到了这一点，[如果 MATLAB 函数返回可变数量的值，我怎样才能将它们全部作为一个单元格数组？](https://stackoverflow.com/questions/2821644/if-a-matlab-function-returns-a-variable-number-of-values-how-can-i-get-all-of-t)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T04:39:18.357

您可以通过返回一个[元胞数组来做到这一点](http://www.mathworks.com/help/matlab/cell-arrays.html?s_tid=doc_12b)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-08T11:22:37.437

我看到您不能在 Matlab 中强制使用变量逗号分隔的输出列表。遗憾。这会很有用。看来我必须明确分配每个输出。这很糟糕，因为我事先不知道我会得到多少输出。

# character-encoding - 如何解码这些字符？√° √© √≠

> ID：15283189
> 
> 赞同：5
> 
> 时间：2013-03-07T22:38:16.680
> 
> 标签：character-encoding, filemaker, mediawiki-api

我正在查询 MediaWiki API 以将 Wikipedia 数据输入我的 Filemaker 数据库。当我将数据加载到浏览器中时，字符会正确显示，但是当它进入 Filemaker 时，带有变音符号的字符会转换为这些奇数字符：á 转换为 √°（平方根符号 + 度数符号），é 转换为√©（平方根符号+版权符号），í转换为√≠（平方根符号+不等于符号）等等。那是什么字符编码？谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T04:50:33.200

正如@Joni 在他的评论中所建议的那样，这是 UTF-8 被误解为 MacRoman。[字母á](http://www.fileformat.info/info/unicode/char/e1/index.htm)在UTF-8中是C3 A1（十六进制），在[MacRoman](http://www.alanwood.net/demos/macroman.html)中C3是“√” ，A1是“°”。因此，您应该尝试将程序设置为将数据解释为 UTF-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T17:19:13.393

你对误解的字符都是正确的，我用来设置 FMP 的用户代理的 Troi URL FMP 插件（根据 MediaWiki API 的要求）负责拉入乱码。解决方案是绕过插件：FMP 脚本执行 Applescript “do shell script curl -A”来设置用户代理和查询 API 并将响应拉回 FMP 并且所有字符都能正常通过！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-20T17:56:28.563

我确定这不是完整列表，但它满足了我的需要。这是代码的查找：

√© é e

√° a

√≠ 我

√≥ ó o

√∂ ö o

√º ü 你

√¥ o

√® è e

√ßç

√±ññ

√∏ Ø o

√´ ë e

√§ 一个

√• 一个

√Å Á A

√∫你

√ª 你

√Ø 我

√âÉE

√† à a

√¶

√ÆÆÆ我

√¢ 一个

√£ã

√î Ô O

√ü ß ss

√ì Ó O

√≤ ò o

√Ω y

√ñ Ö O

√™ ê e

√ÄÀ A

√ò Ø O

√ÖÅ A

√∞ ð eth

√á Ç C

√Ç

√πù你

√í Ò O

√¨ ì 我

√ú ü U

√à È E

√û Þ

# javascript - CasperJS 中的文件 IO

> ID：15283190
> 
> 赞同：25
> 
> 时间：2013-03-07T22:38:21.203
> 
> 标签：javascript, node.js, casperjs

是否可以在 CasperJS 脚本中读/写文件？

```
var fs = require('fs');
var data = fs.readFileSync('testdata.data', 'utf-8');
console.log(data); 
```

调用`casperjs fileio.js`返回：

```
'undefined' is not a function 
```

就算跑了`npm install fs`。

如果没有加分：解释为什么？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-03-07T23:06:08.887

CasperJS 不使用 NodeJS 的`fs`模块。相反，它使用了[PhantomJS](http://phantomjs.org/api/fs/)

以下是如何使用 PhantomJS 的文件系统模块的简短示例：

```
var fs = require('fs');
var utils = require('utils');
var data = fs.read('testdata.dat');
utils.dump(data); 
```

# eclipse - 试图在 eclipse 上用纸莎草纸做 UML 图表，但没有显示图表......可能是什么问题？

> ID：15283192
> 
> 赞同：4
> 
> 时间：2013-03-07T22:38:22.643
> 
> 标签：eclipse, eclipse-plugin, uml, papyrus

我有 Eclipse 4.2 和纸莎草 0.9。我已经开始通过创建类 Diagrams 对项目进行建模，但问题是纸莎草不会在编辑器窗格上绘制图表。我可以从模型浏览器创建和添加属性和操作，我可以从那里查看它们，但我在编辑器上看不到任何图表。我在建模时确实使用了纸莎草透视图。所以我的问题是。

1.  我究竟做错了什么？
2.  我需要添加其他纸莎草组件吗？
3.  或者这就是纸莎草纸的工作原理？

但是从 eclipse papyrus 项目站点的 pdf 教程中显示了使用调色板视图绘制的图表，我似乎在我的 eclipse 中找不到..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-30T18:08:17.730

在 Eclipse Kepler (4.3) 和 Papyrus (4.3) 上，我无法找到从模型（模型资源管理器）更新视图（类图）的方法。如果我通过将操作节点从面板拖动到在视图中的类中，该操作已添加到图表和模型资源管理器中。

您需要切换到 Papyrus 透视图才能显示调色板视图。

我只是在博客上写了[这个和其他一些烦恼](http://www.selikoff.net/2013/06/30/creating-a-uml-diagram-with-eclipse-papyrus/)。（我意识到这个问题已经足够老了，你可能已经放弃了，但我在寻找解决同样问题的方法时发现了它。）

# java - 获取围绕 TextNode 的元素

> ID：15283194
> 
> 赞同：0
> 
> 时间：2013-03-07T22:38:34.197
> 
> 标签：java, xml, dom, textnode

我想获得围绕文本节点的元素节点。根据[这个](http://www.w3schools.com/dom/dom_nodes_get.asp)元素包含一个文本节点，反之亦然，一个文本节点应该被一个元素节点包围。

我需要元素节点（**openingTime**）来获取属性（**day**），但是 NodeList （从节点**openingHours**调用的 getChildNodes() ）只给了我文本节点，它们的父节点是元素节点（**openingHours**），但不是围绕文本节点的那个，而不是上面的那个。如果有人问，我需要使用 DOM，因为据我了解，它是最快的。

这是 XML：

```
<?xml version="1.0"?>

<stores>
<store name = "the Name of the Store">
    <category>2nd Hand</category>
    <locationAdress>sonstwo 18b, 12345 Bla</locationAdress>
    <telephoneNumber>1234567812</telephoneNumber>
    <openingHours>
        <!-- Opening Hours, day permitted values: 1(Monday) - 7(Sunday) and 8 (workweek) -->
        <openingTime day = "1">7:00 - 13:00 15:00 - 18:00</openingTime>
        <openingTime day = "2">7:00 - 13:00 15:00 - 18:00</openingTime>
        <openingTime day = "3">7:00 - 13:00 15:00 - 18:00</openingTime>
        <openingTime day = "4">7:00 - 13:00 15:00 - 18:00</openingTime>
        <openingTime day = "5">7:00 - 13:00 15:00 - 18:00</openingTime>
    </openingHours>
</store>
    </stores> 
```

这是我的java代码：

```
NodeList hoursList = storeElement.getElementsByTagName("openingHours").item(0).getChildNodes();
            for (int y = 0; y < hoursList.getLength(); y++) {
                Node hoursNode = hoursList.item(y);
                boolean isElement = hoursNode.getNodeType() == Node.ELEMENT_NODE;
                boolean hasChild = hoursNode.getChildNodes().getLength() != 0;
                String nameParent = hoursNode.getParentNode().getNodeName(); 
```

boolean isElement 为 false，hasChild 也为 false，String nameParent 为 openingHours。

# c++ - Argument list for class template is missing

> ID：15283195
> 
> 赞同：25
> 
> 时间：2013-03-07T22:38:42.673
> 
> 标签：c++, templates, typename

I'm having a curious issue, and I'm not quite sure what the issue is. I'm creating a class called LinkedArrayList that uses a typename template, as shown in the code below:

```
#pragma once

template <typename ItemType>

class LinkedArrayList 
{

private:

class Node {
    ItemType* items;
    Node* next;
    Node* prev;
    int capacity;
    int size;
};

Node* head;
Node* tail;
int size;

public:

void insert (int index, const ItemType& item);
ItemType remove (int index);
int find (const ItemType& item);
}; 
```

Now, this doesn't give any errors or problems. However, creating the functions in the .cpp file gives me the error "Argument list for class template 'LinkedArrayList' is missing." It also says that ItemType is undefined. Here is the code, very simple, in the .cpp:

```
#include "LinkedArrayList.h"

void LinkedArrayList::insert (int index, const ItemType& item)
{}

ItemType LinkedArrayList::remove (int index)
{return ItemType();}

int find (const ItemType& item)
{return -1;} 
```

It looks like it has something to do with the template, because if I comment it out and change the ItemTypes in the functions to ints, it doesn't give any errors. Also, if I just do all the code in the .h instead of having a separate .cpp, it works just fine as well.

Any help on the source of the problem would be greatly appreciated.

Thanks.

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-03-07T22:41:06.897

First of all, this is how you should provide a definition for member functions of a class template:

```
#include "LinkedArrayList.h"

template<typename ItemType>
void LinkedArrayList<ItemType>::insert (int index, const ItemType& item)
{}

template<typename ItemType>
ItemType LinkedArrayList<ItemType>::remove (int index)
{return ItemType();}

template<typename ItemType>
int LinkedArrayList<ItemType>::find (const ItemType& item)
{return -1;} 
```

Secondly, those definitions cannot be put in a `.cpp` file, because the compiler won't be able to instantiated them implicitly from their point of invocation. See, for instance, [**this Q&A** on StackOverflow](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-30T11:55:31.533

While providing the definition, if you are using template also mention them with your class

```
#include "LinkedArrayList.h"
template<typename ItemType>

void LinkedArrayList<ItemType>::insert (int index, const ItemType& item)
{} 
```

# php - 输出中出现意外字符

> ID：15283196
> 
> 赞同：0
> 
> 时间：2013-03-07T22:38:58.070
> 
> 标签：php, mysql, plesk

我有以下问题。

这段代码给了我某种错误的输出。

```
<?php 
header('Content-type: text/plain; charset=utf-8');
//setup php for working with Unicode data
mb_internal_encoding('UTF-8');
mb_http_output('UTF-8');
mb_http_input('UTF-8');
mb_language('uni');
mb_regex_encoding('UTF-8');
ob_start('mb_output_handler');
$con = mysql_connect("localhost","test","test");
mysql_query( "SET NAMES utf8", $con );
mysql_query( "SET CHARACTER SET utf8", $con );
if (!$con) {
  die('Could not connect: ' . mysql_error());
}
echo "this is a test";
?> 
```

这自动发生在我的所有文件中。我没有在我的服务器上更新任何东西。

请帮忙！快把我逼疯了！

我将数据发送到 iphone 应用程序，然后在文本前面得到一个 \n，如下所示：

```
\nthis is a test 
```

到底是怎么回事？

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T06:05:59.093

您可能需要应用此知识库文章[http://kb.parallels.com/115025](http://kb.parallels.com/115025)

# php - 我应该如何为我的 Android 应用程序构建/设计评级系统？

> ID：15283197
> 
> 赞同：0
> 
> 时间：2013-03-07T22:39:01.120
> 
> 标签：php, android, mysql, database, rating

我正在构建一个移动 Android 应用程序，用户可以在其中找到最近的位置，然后在查看这些位置时，允许他们查看详细信息并对其进行评分。最重要的是，他们可以在地图上添加新地点。我希望能够尽我所能降低人们添加假点的机会，所以这就是我想要实施评级系统的原因，这是假点的另一层安全性。

我不确定我应该如何设计我的数据库表。现在我只有：

```
Location: name, address, type, terrain, difficulty, lng, lat, rating. 
```

评级列仅允许值：1、2、3、4、5。

我还需要什么来保持收视率的总和？

设计好桌子后。我想知道计算平均收视率的最合适方法，然后能够根据他们的收视率将其删除。问题是，如果一个位置有 1 票，评分为 1，这是 100% 否定的，那么当一个位置有 100 票，90 票，1 票和 10 票，5 票时，它将被认为是糟糕的。当然，第一个应该认为更糟，然后删除。我该如何反击？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T00:40:51.720

我会说制作一个单独的表，其中包含位置 id 的外键和提交评论的用户的 id 会很有用（当然还有评分）。这样用户可以在以后编辑他们的评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:48:29.153

有很多方法可以做到这一点。更复杂的趋势监控系统缓冲投票并查看过去一天、一小时、一分钟等的比率。

但是，对于一个简单的系统，您可以查看总票数和平均评分。您可能不在乎总和（无论如何您都可以从其他两个中得到它）。

要更新评级：

```
average = ((average*total)+new)/(sum+1);
total ++; 
```

当您考虑删除它们时，您需要为最小投票数（总）设置阈值，然后根据平均评分删除。1 次差票可能还不够，你认为多少，取决于你的使用水平。

其他答案：[PHP/MySQL - “Top Rated”算法](https://stackoverflow.com/questions/1433425/php-mysql-algorithm-for-top-rated)

# javascript - 如何在这个现有循环中添加一个额外的循环

> ID：15283211
> 
> 赞同：2
> 
> 时间：2013-03-07T22:40:35.290
> 
> 标签：javascript, jquery, loops

我有以下小提琴（单击 1 查看板）：http: [//jsfiddle.net/mauricederegt/vNpYe/1/](http://jsfiddle.net/mauricederegt/vNpYe/1/)

`var levels = [`它从靠近脚本底部的部分创建一系列 div 。脚本的以下部分循环通过它来构建板：

```
for (var i = 0, lngi = levels[level].length; i < lngi; i++) {
                for (var j = 0, lngj = levels[level][i].length; j < lngj; j++) {
                    if (levels[level][i][j] > 0) {
                    etc etc.... 
```

这一切都很好。问题是，我想添加另一层块。在当前脚本中，我注释掉了名为`//layer2`. 完成第 1 层后，我想再次循环它以在第 1 层之上添加第 2 层（以及稍后的更多层），因此它看起来像这样： ![在此处输入图像描述](../Images/7b9508d5873191e70aafef5d921bb4dd.png)

当然需要做一些代码扩展。例如，`z-index`需要添加 a 并且需要重新编写循环。

我不擅长编码，但我做了一些尝试来做到这一点。看看我的尝试这个小提琴。我已经用以下内容标记了这些行：`//NEW added: etc`我在其中添加了一些东西来完成这项工作：http: [//jsfiddle.net/mauricederegt/PCmws/1/](http://jsfiddle.net/mauricederegt/PCmws/1/)

小提琴不起作用，因为编码还不完全正确。希望有人可以在这里帮助我。我错过了什么/做错了什么？

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T11:27:48.953

让我们分解一下您目前的位置以及您想要实现的目标：

*   您当前有一个循环遍历每一行并向该行添加图块。
*   您当前有一个循环遍历每一层并向该层添加行。
*   您现在需要的是一个循环，它遍历每个级别并将层添加到该级别。

* * *

在进一步讨论之前，我要求您为变量使用更详细的名称。虽然`i`，`j`并且`lngi`在上下文中可能有意义，但在我看来，最好用冗长来牺牲简洁性。
*好吧，至少在开发和原型设计期间。*

例如，如果您使用诸如`currentLevel`和`currentRow`之类的东西，它会使诸如此类的事情`currentTileType = currentRow[currentColumnIndex]`变得更加简单/直接:)

当然，总会有平衡，这纯粹是个人喜好/意见，但也许通过这个例子，我可以把你带到黑暗的一面……;）

* * *

Soo..让我们陷入困境......您将看到的主要变化是以下新增内容..

从逻辑上讲，与其中一个循环说“对于这一行中的每一列，我想这样做”的方式相同，它实际上只是包装现有循环说“对于我定义的每一层，我想做这（画出这些行）……”

* * *

```
 var currentGame = levels;

        console.info("currentGame = ", levels);

        // //Loop through levels in game
        // for (var currentLevelIndex = 0, numLevelsInGame = currentGame.length; currentLevelIndex < numLevelsInGame; currentLevelIndex++) {
            // var currentLevel = currentGame[currentLevelIndex];

            var currentLevel = currentGame[levelIndex];

            //Loop through layers in level
            for (var currentLayerIndex = 0, numLayersInLevel = currentLevel.length; currentLayerIndex < numLayersInLevel; currentLayerIndex++) {
                var currentLayer = currentLevel[currentLayerIndex];

                //Loop through rows in layer
                for (var currentRowIndex = 0, numRowsInLayer = currentLayer.length; currentRowIndex < numRowsInLayer; currentRowIndex++) {
                    var currentRow = currentLayer[currentRowIndex];

                    //Loop through columns in row
                    for (var currentColIndex = 0, numColsInRow = currentRow.length; currentColIndex < numColsInRow; currentColIndex++) {
                        var currentTileType = currentRow[currentColIndex];

                        //Do stuff based on what you have specified the current tile type as.. eg create it!! 
```

请参阅此小提琴以获取更新版本：http: [//jsfiddle.net/vNpYe/4/](http://jsfiddle.net/vNpYe/4/)

一旦你了解了这里发生的事情，将图层的 z-index 设置为“currentLayerIndex”（或其派生值）就很简单了

# ssl - 在初始 https 之后再次为 wss 握手？

> ID：15283212
> 
> 赞同：1
> 
> 时间：2013-03-07T22:40:36.503
> 
> 标签：ssl, websocket, keep-alive, handshake, spdy

假设一个 100% 安全的 websocket 站点，webserver 提供所有文件：html、js、css 等，websocket 提供客户端和服务器之间的所有数据。

显然最初的 ssl 握手是在默认 https 端口上的客户端和 webserver 之间进行的，但是 wss 将在不同的端口上，所以它必须再次握手吗？

我问的原因是因为 websockets 和 spdy 还没有一起工作（所以我已经读过），所以我希望通过在 web 服务器上安装 spdy 并依赖 wss 的 keep-alive 来解决它，因为有些握手后声称spdy并不比keep-alive快多少（如果有的话）[spdy比keep-alive https快吗？](https://stackoverflow.com/questions/15255039/spdy-faster-than-keep-alive-https).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T22:48:43.510

不。SSL 协议决定客户端和服务器如何协商要使用的密码套件、相互验证、传输证书、建立会话密钥和传输消息。握手成功完成后，所有流经新 SSL 的数据会话受到握手期间同意的加密算法和会话密钥的保护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:07:21.817

虽然特拉维斯所说的大部分内容都是事实，但我不清楚他为什么对你的问题回答“不”。

当客户端打开与 Web 服务器的 HTTPS 连接时，Web 服务器可能会提供 JS，该 JS 使用 wss:// 启动 WebSocket 连接到不同的源（可能是同一主机，但正如您所描述的，它是不同的端口）。这是一种*不同的联系*。必须为每个连接单独执行 SSL 握手。

Travis 所说的对于 SSL 会话是正确的，如果 WebSocket 使用与 https:// 文档获取相同的连接，那么回答“否”是正确的。但由于 wss:// WebSocket 连接初始化将使用不同的连接，它需要另一个 SSL 握手。

# javascript - 如何在 javascript 数组中插入缺失的日期和数据点？

> ID：15283213
> 
> 赞同：1
> 
> 时间：2013-03-07T22:40:47.013
> 
> 标签：javascript

说我有以下内容：

```
var sales = [5, 4, 2];
var months = ["Jan 2011", "Apr 2011", "Feb 2012"]; 
```

如果我有一个给定的范围说：

```
var range = ["Jan 2011", "Mar 2012"]; 
```

我想在几个月之间“插值”，以便得到以下结果：

```
var sales = [5, 4, 4, 4, ..., 2, 2];
var months = ["Jan 2011", "Feb 2011", "Mar 2011", ...., "Feb 2012", "Mar 2012"]; 
```

是否有必要创建一个包含所有“月+年”的“按顺序排列的所有可能日期范围”数组？或者是否有可能使用 javascript 不必这样做？如何做到这一点？

注意：假设是，如果月份数组中不存在日期，它将用任何以前可用月份的数据填充。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-10T15:52:35.767

如果您不需要严格使用以前已知的销售数据，您可以对销售数据使用一种很好的样条插值：

```
/* Fritsch-Carlson monotone cubic spline interpolation
   Usage example:
    var f = createInterpolant([0, 1, 2, 3], [0, 1, 4, 9]);
    var message = '';
    for (var x = 0; x <= 3; x += 0.5) {
        var xSquared = f(x);
        message += x + ' squared is about ' + xSquared + '\n';
    }
    alert(message);
*/
var createInterpolant = function(xs, ys) {
    var i, length = xs.length;

    // Deal with length issues
    if (length != ys.length) { throw 'Need an equal count of xs and ys.'; }
    if (length === 0) { return function(x) { return 0; }; }
    if (length === 1) {
        // Impl: Precomputing the result prevents problems if ys is mutated later and allows garbage collection of ys
        // Impl: Unary plus properly converts values to numbers
        var result = +ys[0];
        return function(x) { return result; };
    }

    // Rearrange xs and ys so that xs is sorted
    var indexes = [];
    for (i = 0; i < length; i++) { indexes.push(i); }
    indexes.sort(function(a, b) { return xs[a] < xs[b] ? -1 : 1; });
    var oldXs = xs, oldYs = ys;
    // Impl: Creating new arrays also prevents problems if the input arrays are mutated later
    xs = []; ys = [];
    // Impl: Unary plus properly converts values to numbers
    for (i = 0; i < length; i++) { xs.push(+oldXs[indexes[i]]); ys.push(+oldYs[indexes[i]]); }

    // Get consecutive differences and slopes
    var dys = [], dxs = [], ms = [];
    for (i = 0; i < length - 1; i++) {
        var dx = xs[i + 1] - xs[i], dy = ys[i + 1] - ys[i];
        dxs.push(dx); dys.push(dy); ms.push(dy/dx);
    }

    // Get degree-1 coefficients
    var c1s = [ms[0]];
    for (i = 0; i < dxs.length - 1; i++) {
        var m = ms[i], mNext = ms[i + 1];
        if (m*mNext <= 0) {
            c1s.push(0);
        } else {
            var dx = dxs[i], dxNext = dxs[i + 1], common = dx + dxNext;
            c1s.push(3*common/((common + dxNext)/m + (common + dx)/mNext));
        }
    }
    c1s.push(ms[ms.length - 1]);

    // Get degree-2 and degree-3 coefficients
    var c2s = [], c3s = [];
    for (i = 0; i < c1s.length - 1; i++) {
        var c1 = c1s[i], m = ms[i], invDx = 1/dxs[i], common = c1 + c1s[i + 1] - m - m;
        c2s.push((m - c1 - common)*invDx); c3s.push(common*invDx*invDx);
    }

    // Return interpolant function
    return function(x) {
        // The rightmost point in the dataset should give an exact result
        var i = xs.length - 1;
        if (x == xs[i]) { return ys[i]; }

        // Search for the interval x is in, returning the corresponding y if x is one of the original xs
        var low = 0, mid, high = c3s.length - 1;
        while (low <= high) {
            mid = Math.floor(0.5*(low + high));
            var xHere = xs[mid];
            if (xHere < x) { low = mid + 1; }
            else if (xHere > x) { high = mid - 1; }
            else { return ys[mid]; }
        }
        i = Math.max(0, high);

        // Interpolate
        var diff = x - xs[i], diffSq = diff*diff;
        return ys[i] + c1s[i]*diff + c2s[i]*diffSq + c3s[i]*diff*diffSq;
    };
}; 
```

这可以与以下代码一起使用来执行您想要的操作：

```
var monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
var fromMonthNumber = function(monthNumber) {
    return monthNames[monthNumber % 12] + ' ' + ((monthNumber / 12) | 0);
};

var toMonthNumber = function(monthName) {
    var date = new Date(Date.parse(monthName));
    return 12*date.getFullYear() + date.getMonth();
};

var interpolateSales = function(sales, months, range) {
    var f = createInterpolant(months.map(toMonthNumber), sales);

    var resultSales = [], resultMonths = [];
    var firstMonth = toMonthNumber(range[0]), lastMonth = toMonthNumber(range[1]);
    for (var x = firstMonth; x <= lastMonth; x++) {
        resultSales.push(Math.round(f(x)));
        resultMonths.push(fromMonthNumber(x));
    }

    return { sales: resultSales, months: resultMonths };
}; 
```

有了它，`interpolateSales([5, 4, 2], ["Jan 2011", "Apr 2011", "Feb 2012"], ["Jan 2011", "Mar 2012"])`就是：

```
{
    sales: [5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 2, 2, 2, 2],
    months: ["Jan 2011", "Feb 2011", "Mar 2011", "Apr 2011", "May 2011", "Jun 2011", "Jul 2011", "Aug 2011", "Sep 2011", "Oct 2011", "Nov 2011", "Dec 2011", "Jan 2012", "Feb 2012", "Mar 2012"]
} 
```

# android - Android Shell EOF

> ID：15283220
> 
> 赞同：5
> 
> 时间：2013-03-07T22:41:15.507
> 
> 标签：android, linux, shell, mksh

我为 Android 制作的脚本有一个小问题。我无法让“EOF”在“mksh”中工作。它在 'sh' 和 'bash' 中运行良好，但由于 'mksh' 正在成为 Android 中最常用的，所以我真的需要它才能正常工作。

```
cat <<EOF
  ... lines here ...
EOF 
```

此示例将导致休闲错误

> 无法创建临时文件/sqlite_stmt_journals/mksh。（随机）：没有这样的文件或目录

我见过其他人有这个问题，但没有真正的解决方案。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-14T18:23:42.930

问题来自于 /sqlite_stmt_journals*曾经*存在并且是一个世界可写的粘性目录，就像 /tmp 在普通的 Unix boxen 中一样，所以当我将 mksh 添加到 Android 时，我将它用作标准 TMPDIR。

最近的 Android 安全策略完全禁止全局可写目录。

我们（Android 团队和我）意识到了这个问题，但还没有提出*好的*解决方案；需要先创建“用户”主目录，然后才能（自动）使用它们，但一位 Google 员工告诉我他们有一些东西在队列中。

在此之前，请将 TMPDIR 设置为您的用户可写的内容。

这是 Android 环境的问题，而不是 mksh 本身的问题。

@Julian Fondren：您的 Android 设备可能来自该目录仍然存在的时候。

在 AOSP git master 中，默认的 TMPDIR 是 /data/local，它至少对 root 用户是可写的……所以，现在只需将其设置为对您可写的内容（如果您正在运行脚本，则将其导出）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T22:52:52.163

好吧，如果不愉快的话，有一个明显的解决方案：不要使用 HERE 文档；只需将每一行回显到一个临时文件。所以你的例子变成：

```
echo ... first line ... > $tmpfile
echo ... subsequent lines ... >> $tmpfile
cat $tmpfile
rm $tmpfile 
```

编辑：等等，什么？当然看起来 HERE 文档对我来说在 mksh 上工作得很好。在库存 Kindle Fire HD 上使用 mksh R39 会发生以下情况（不要介意 perl）：

```
$ perl <<FOO
print "hi\n"
FOO
hi
$ 
```

您的示例也可以按我的预期工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-06T07:24:59.813

1）**如果你有root权限：**

当您打开 android shell 时，如果您拥有该设备的 root 权限，则以 root 用户身份运行 adb。

```
adb root 
```

而不仅仅是

```
adb shell 
```

这将解决您的问题。

2）**如果你可以修改你的android设备中的sh二进制文件然后修改它会去查找路径**

```
/data/local/tmp/ 
```

或者

```
/data/local/atvc/  // In Motorola’s android device. 
```

上面的目录对 shell 用户具有读/写/执行权限。

3)**安装 Busybox 并运行为** `Busybox cat <<EOF`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-29T22:43:19.963

从这篇[文章](https://stackoverflow.com/a/22751947/51292)：

```
package=com.tayek.tablet.gui.android.cb7
cat <<EOF | adb -s 0a9196e8 shell
run-as $package
ls -l /data/data/$package
exit
exit
EOF 
```

# sql - 比较操作员错误

> ID：15283221
> 
> 赞同：0
> 
> 时间：2013-03-07T22:41:15.787
> 
> 标签：sql, function, postgresql, plpgsql

我在 plpgsql 中有以下查询：

```
FOR _t IN EXECUTE 'select distinct_network_point.id AS network_point_id
           from distinct_network_point, all_points_ordered
           where road_id='||road_id||' AND distinct_network_point.point = all_points_ordered.point AND all_points_ordered.point != st_setsrid(st_makepoint('||new_point||'),4326)
           order by st_distance(all_points_ordered.point,st_setsrid(st_makepoint('||new_point||'),4326))
           limit 1' 
```

对于某些人来说，它给了我以下错误：

![在此处输入图像描述](../Images/9de445a3934927d3d0a6303d4bdc5c0d.png)

如果我使用这个 <> 运算符，它会给我这个比：

![在此处输入图像描述](../Images/ee8becee0fa6b9ffe4c82592826dc2d4.png)

谁能解释它的真正含义？该查询在 sql 中运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:02:54.107

由于您正在处理几何类型，因此`!=`or`<>`运算符均无效。

[相反，请参阅以下几何运算符列表。](http://www.postgresql.org/docs/8.2/static/functions-geometry.html)

在这种情况下，由于您要检查两个点是否不相同，我相信您可以使用运算符*之间的距离*`<->`, 并检查您的两个点之间的距离是否大于某种非常小的 epsilon 值。

就像是：

```
AND all_points_ordered.point <-> st_setsrid(st_makepoint('||new_point||'),4326) > 0.0001 
```

# c++ - 挥发性功能

> ID：15283223
> 
> 赞同：17
> 
> 时间：2013-03-07T22:41:22.480
> 
> 标签：c++, c, volatile

**摘要**`volatile`：当应用于 C 和 C++ 中的函数声明时 ，关键字有什么作用？

**详情**：

我看到可以编译一个标记为`volatile`. 但是，我不确定这会阻止什么编译器优化（如果有的话）。例如，我创建了以下测试用例：

```
volatile int foo() {
  return 1;
}

int main() {
  int total = 0;
  int i = 0;
  for(i = 0; i < 100; i++) {
    total += foo();
  }

  return total;
} 
```

当我使用`clang -emit-llvm -S -O3 test.c`（gcc 也可以工作，但我认为 llvm IR 更具可读性）编译时，我得到：

```
target triple = "x86_64-unknown-linux-gnu"

define i32 @foo() #0 {
  ret i32 1
}

define i32 @main() #0 {
  ret i32 100
} 
```

所以很明显，编译器能够优化对函数的调用，`foo()`以便`main()`返回一个常量，即使`foo()`标记为`volatile`. 所以我的问题是`volatile`在限制编译器优化方面应用于函数声明时是否有任何作用。

（请注意，我对这个问题的兴趣主要是对了解做什么`volatile`而不是解决任何特定问题的好奇心。）

（另外，我将这个问题标记为 C 和 C++，不是因为我认为它们是同一种语言，而是因为我有兴趣知道`volatile`这两种语言在这种情况下的作用是否存在差异）。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-07T23:08:15.110

在您的代码中，`volatile`关键字不适用于函数，但适用于返回类型，它相当于：

```
typedef volatile int Type;
Type foo(); 
```

现在，在 C++ 中，您可以使用与限定符相同的方式创建*成员*函数，并且行为是相同的：`volatile``const`

```
struct test {
   void vfunction() volatile;
}; 
```

基本上，您不能在该类型的易失性（分别为 const）实例上调用非易失性（或者非 const）函数：

```
struct test {
   void vfunction() volatile;
   void function();
};
volatile test t;
t.vfunction();      // ok
t.function();       // error 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-07T23:08:14.813

`foo()`不挥发。

它是一个返回`volatile int`.

这是合法的。但奇怪的一回`int`。

另一方面，成员函数可能`volatile`出于相同的原因`const`——它们都描述了对象`this`所指向的对象。

# postgresql - 通过选择 postgres 组中的最后一个元素进行聚合

> ID：15283224
> 
> 赞同：0
> 
> 时间：2013-03-07T22:41:22.933
> 
> 标签：postgresql

我有一个表，其中包含 postges 中的对象统计信息，其中包含以下列：

*   **id**整数
*   **object_id**整数
*   **带时区的**时间戳****
***   **尺寸**特征变化*   **值**整数**

 **请注意，它使用的是实体-属性-值（eav）模式-实体是`object_id`，属性是`dimension`，值是`value`。

每晚运行一个作业，`dimension`为每个对象（由 指定）收集超过六个维度（由 指定`object_id`）的值。

我想建立一个报告页面，显示`value`每个`dimension`. `product`查询将如下所示：

`select object_id, dimension, FIRST(value) from pt_reading group by product_id, dimension order by product_id, dimension, timestamp desc;`

`FIRST`会选择第一个`value`，因为我是按时间戳降序排序的。不幸的是，FIRST 不是一个有效的聚合函数。

最好的设计模式是什么？我总是可以回退到用 python 编写它，但它似乎可以由数据库处理。另外，如果我应该使用不同的设计模式来做到这一点，请加入。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-07T22:55:49.187

```
select distinct on (object_id, dimension)
    object_id,
    dimension,
    value
from pt_reading
order by object_id, dimension, "timestamp" desc; 
```**

# plsql - 如何在 pl/sql 中追加

> ID：15283225
> 
> 赞同：-1
> 
> 时间：2013-03-07T22:41:24.693
> 
> 标签：plsql, plsqldeveloper

我目前陷入以下问题：

创建一个程序，通过在 STARS 列中为每 100 欧元的员工工资附加一个星号来奖励员工

一个。接受员工 ID 作为输入

湾。初始化变量以包含星串

C。为每 100 欧元的工资附加星号，例如工资 800、8 个星号

d。用星号字符串更新 STARS 列

e. 测试无薪员工和有薪员工

我已经完成了大部分工作，但让我感兴趣的部分是 C 部分，附加到一个字符串。我不是在寻找整个问题的答案，只是在寻找如何附加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T07:10:38.187

正如@Glenn 建议的那样使用 RPAD 功能

`'*'`假设您的薪水为欧元，则包括每 100 欧元

```
ltrim(rpad(' ',floor(salary/100)+1,'*')) 
```

`ltrim`仅在填充后删除字符串末尾的空格

# ios - iOS 模型视图控制器设计模式

> ID：15283228
> 
> 赞同：0
> 
> 时间：2013-03-07T22:41:36.860
> 
> 标签：ios

如何在我的代码中准确实现 MVC 设计模式？

1.  控制器 -> 使用 RestKit 调用 Rest 服务。
2.  将 JSON 绑定到一个对象 --> 这是一个模型
3.  控制器根据模型显示一堆数据。

现在我在哪里实现视图？我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T22:56:39.617

你的 ViewController 应该观察模型的变化并更新它的视图层次结构，它的根是`self.view`.

```
- (void)viewDidLoad {
    [super viewDidLoad];
    // observe the model, via kvo, or subscribe to notification, or make self == somebody's delegate, etc.
}

- (IBAction)doSomething:(id)sender {
    // change the model  [self.model change]
    // or start a web request with self as delegate
}

// called by kvo or delegate or notification or [self modelDidChange];

- (void)modelDidChange {
    // update self.view or children viewWithTag: or outlets setup to subviews
} 
```

# windows - 使用 wicked_pdf 拒绝权限

> ID：15283229
> 
> 赞同：2
> 
> 时间：2013-03-07T22:41:37.613
> 
> 标签：windows, ruby-on-rails-3, windows-7, wicked-pdf

我在用着

```
Windows 7  
Rails 3.2.11  
wkhtmltopdf 0.9.9 
```

在宝石文件中

```
gem 'wicked_pdf' 
```

在我的初始化程序中

```
WickedPdf.config = { :exe_path => 'C:\wkhtmltopdf' } 
```

exe位于

```
C:\wkhtmltopdf\wkhtmltopdf.exe 
```

当我从rails c运行时

```
irb(main):001:0> WickedPdf.new.pdf_from_string('<h1>Hello There!</h1>') 
```

我收到以下错误...

> " ***** ** *** ***** \"C:\wkhtmltopdf\"
> \"file:///C:/Users/bob/bob_rail s_demo/Course_Stats/wicked_pdf20130307-6328-7cuwz7.html\" \"C:/Users /bob/wful ts_rails_demo/Course_Stats/wicked_pdf_generated_file20130307-6328-n902yj.pdf\" * ***** ** *** ****" RuntimeError: 执行失败: "C:\wkhtmltopdf" "file:///C:/Users/bob/bob_rails_demo/Course_Stats/wicked_pdf20130307-6328-7cuwz7.html" "C:/Users/bob/bob_rails_demo/Course_Stats /wicked_pdf_generated_file20130307-6328-n902yj.pdf" 错误：权限被拒绝 - "C:\wkhtmltopdf" "file:///C:/Users/bob/wful ts_rails_demo/Course_Stats/wicked_pdf20130307-6328-7cuwz7.html" "C:/用户/bob /bob_rails_demo/Course_Stats/wicked_pdf_generated_file20130307-6328-n902yj.pd f" 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/wicked_pdf-0.9 .4/lib/wicked_pdf.rb :50:in `rescue in pdf_from_string' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/wicked_pdf-0.9 .4/lib/wicked_pdf.rb:34:in`pdf_from_string' 来自 (irb):1 来自 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 1/lib/rails/commands/console.rb :47:在`start' from C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 1/lib/rails/commands/console.rb:8:in`从 C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/railties-3.2.1 开始' 1/lib/rails/commands.rb:41:in`<top (required)>' from script/rails:6:in`来自 script/rails:6 ：在`'

如果我将此行更改为此...

```
WickedPdf.config = { :exe_path => 'C:\wkhtmltopdf\wkhtmltopdf.exe' } 
```

然后在 rails 命令行中运行它似乎可以工作，但在我的应用程序中，机架中间件只是挂起......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-01T21:44:38.843

我遇到了同样的问题，除了最初我的 exe 位于 C:\Program Files (x86)\wkhtmltopdf\wkhtmltopdf.exe

所以我把它改成了`C:\wkhtmltopdf\wkhtmltopdf.exe`（你已经有了），然后我做了`:exe_path`这个：`:exe_path => 'C:\wkhtmltopdf\wkhtmltopdf.exe'`

我相信您必须在 windows 环境中添加 .exe 的原因是因为 windows 需要明确路径文件。一旦我这样做了，它就像一个魅力。

让我知道进展如何（或进展如何）！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-10T12:27:22.213

我遇到了同样的问题，对我来说诀窍是更改文件的权限：

`chmod o+w /usr/local/bundle/gems/wkhtmltopdf-binary-0.12.6.5/bin/`

# android - 拔下充电器后，Android 相机自动对焦停止

> ID：15283239
> 
> 赞同：0
> 
> 时间：2013-03-07T22:42:29.050
> 
> 标签：android, camera, zxing, autofocus

我在我的应用程序中使用[ZXing Barcode Scanner 库，并且遇到以下错误：相机自动对焦仅在设备插入充电器时才有效。](https://code.google.com/p/zxing/)一旦我拔下设备，相机就会停止连续自动对焦，但一旦再次插入设备，自动对焦会立即恢复（图像每 2000 毫秒对焦一次）。测试设备的电池已充满电。

应该注意的是，来自 XZing 的示例代码可以正常工作，但是由于我在我的应用程序中使用了其中的一部分，所以我遇到了上述问题。

下面是 AutoFocusManager 类的代码：

```
/*Copyright (C) 2012 ZXing authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.myapp.utils.barcode.camera;

import android.content.Context;
import android.content.SharedPreferences;
import android.hardware.Camera;
import android.os.AsyncTask;
import android.preference.PreferenceManager;
import android.util.Log;

import java.util.ArrayList;
import java.util.Collection;

import com.myapp.utils.barcode.main.PreferencesActivity;
import com.myapp.utils.barcode.common.executor.AsyncTaskExecInterface;
import com.myapp.utils.barcode.common.executor.AsyncTaskExecManager;

final class AutoFocusManager implements Camera.AutoFocusCallback {

  private static final String TAG = AutoFocusManager.class.getSimpleName();

  private static final long AUTO_FOCUS_INTERVAL_MS = 2000L;
  private static final Collection<String> FOCUS_MODES_CALLING_AF;
  static {
    FOCUS_MODES_CALLING_AF = new ArrayList<String>(2);
    FOCUS_MODES_CALLING_AF.add(Camera.Parameters.FOCUS_MODE_AUTO);
    FOCUS_MODES_CALLING_AF.add(Camera.Parameters.FOCUS_MODE_MACRO);
  }

  private boolean active;
  private final boolean useAutoFocus;
  private final Camera camera;
  private AutoFocusTask outstandingTask;
  private final AsyncTaskExecInterface taskExec;

  AutoFocusManager(Context context, Camera camera) {
    this.camera = camera;
    taskExec = new AsyncTaskExecManager().build();
    SharedPreferences sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);
    String currentFocusMode = camera.getParameters().getFocusMode();
    useAutoFocus =
        sharedPrefs.getBoolean(PreferencesActivity.KEY_AUTO_FOCUS, true) &&
        FOCUS_MODES_CALLING_AF.contains(currentFocusMode);
    Log.i(TAG, "Current focus mode '" + currentFocusMode + "'; use auto focus? " + useAutoFocus);
    start();
  }

  @Override
  public synchronized void onAutoFocus(boolean success, Camera theCamera) {
    if (active) {
      outstandingTask = new AutoFocusTask();
      taskExec.execute(outstandingTask);
    }
  }

  synchronized void start() {
    if (useAutoFocus) {
      active = true;
      try {
        camera.autoFocus(this);
      } catch (RuntimeException re) {
        // Have heard RuntimeException reported in Android 4.0.x+; continue?
        Log.w(TAG, "Unexpected exception while focusing", re);
      }
    }
  }

  synchronized void stop() {
    if (useAutoFocus) {
      try {
        camera.cancelAutoFocus();
      } catch (RuntimeException re) {
        // Have heard RuntimeException reported in Android 4.0.x+; continue?
        Log.w(TAG, "Unexpected exception while cancelling focusing", re);
      }
    }
    if (outstandingTask != null) {
      outstandingTask.cancel(true);
      outstandingTask = null;
    }
    active = false;
  }

  private final class AutoFocusTask extends AsyncTask<Object,Object,Object> {
    @Override
    protected Object doInBackground(Object... voids) {
      try {
        Thread.sleep(AUTO_FOCUS_INTERVAL_MS);
      } catch (InterruptedException e) {
        // continue
      }
      synchronized (AutoFocusManager.this) {
        if (active) {
          start();
        }
      }
      return null;
    }
  }
} 
```

当设备连接到调试器时，LogCat 显示如下：

```
03-07 23:37:14.624: I/AutoFocusManager(2296): Current focus mode 'auto'; use auto focus? true 
```

测试设备是 HTC sense，操作系统 - Cyanogenmod 10 (Android 4.1.2)。

您有什么建议吗？这种行为的原因是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T14:41:50.013

zxing 2.1也发生了类似的情况

```
autoFocusThread X: AF fail 
```

在带有 android 4.0.4 和 Sonyericcson Xperia Neo / android 4.0.4 的三星 Galaxy (GT-P6200) 上。

ZXing 2.0 没有出现错误。 [您可以从这里下载 2.0 版。](https://code.google.com/p/zxing/downloads/detail?name=ZXing-2.0.zip&can=1&q= "你可以在这里下载")

试试吧，我希望也能解决你的自动对焦问题。

# asp.net-mvc - MVC 存储库模式 - 何时使用 AutoMapper？

> ID：15283244
> 
> 赞同：1
> 
> 时间：2013-03-07T22:42:48.923
> 
> 标签：asp.net-mvc, model-view-controller, asp.net-mvc-4

我们使用 Telerik ORM 来生成我们的领域模型，并将它们放在一个名为 DAL 的类库中。然后我们有我们的 UI 项目，它是一个 MVC 4 Web 应用程序。在这方面，我们有存储库和模型。这里的模型是视图模型，专门用于在视图上显示数据。

现在我的问题是：

1.  存储库是否应该直接返回视图模型？
2.  视图模型是否应该转换为实体？
3.  使用自动映射器有什么开销？应该在哪里使用？

如果我们不使用 automapper 转换为存储库中的视图模型，我们可能会对 db 进行不同的调用来填充对象的每个部分。页面的视图模型可能具有联系人列表和选定的联系人。选定的联系人将填充一个对存储库的调用，而联系人列表将填充另一个调用。此外，如果映射器处于存储库级别，如果我们只对“名称和 ID”感兴趣，那么删除所有“额外字段”（如性别）不是更好吗？

我听说存储库不应该返回视图模型，因为视图模型是特定于 UI 的，不应该参与数据层。这是真的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:14:48.547

您的存储库应返回纯域对象。ORM 映射器应将这些作为紧密映射到数据源的类输出。为了使您的存储库/控制器能够轻松插入各种形式，例如 Web 服务、Web 应用程序和其他项目，不应该应用任何 UI 属性。

当您针对存储库接口的多个实现（例如 DI 容器）时，Automapper 非常棒。在将域对象转换为存储类对象/从存储类对象转换时，它非常有用。基本上它减少了翻译课程的需要。

在 MVC.Model 区域，您可能需要创建您在 UI 中用作模型的域对象类的副本。随着项目的发展，您将看到这样做的优势，尤其是当您使用各种属性进行验证、显示、本地化等时。当您的类具有非常接近的命名约定时，像 Automapper 这样的工具会大大提高生产力。

如果您在 Mvc.Controller 类中使用映射器将数据/控制器转换为 MVC.Models，您还将看到生产力的提高。

关键是要与跨应用程序边界的类中的属性名称保持一致。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T22:47:40.100

这是目前正在讨论的问题。 [Jimmy Bogard](http://lostechies.com/jimmybogard/2009/06/30/how-we-do-mvc-view-models/)的建议是使用 Automapper 仅将域模型映射到视图模型。如果您想将后视图模型过于扁平化为域模型，我建议您尝试使用[Value Injecter](http://valueinjecter.codeplex.com/)

# java - mmddhhmmss 格式的 java 日期

> ID：15283245
> 
> 赞同：3
> 
> 时间：2013-03-07T22:42:53.683
> 
> 标签：java, date, datetime, simpledateformat, date-format

我想在文件中添加日期，以便维护存档。我想要这种格式的日期：mmddhhmmss

所以文件名是“cGroup0307131614”，只是我想添加时间戳。没必要它应该是 mmddhhmmss 格式，而是保持时间戳的格式。

我试过了：

```
java.util.Date date= new java.util.Date();
     System.out.println(new Timestamp(date.getTime())); 
```

但是 o/p 是 2013-03-07 14:59:30.252。我不想要任何空格冒号或特殊字符。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T22:47:32.673

```
SimpleDateFormat simpleDateFormat =
            new SimpleDateFormat("MMddhhmmss");
String dateAsString = simpleDateFormat.format(new Date());
System.out.println(dateAsString); 
```

输出：

```
0307114712 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-10T22:37:46.840

# jquery - jQuery UI datepicker 函数覆盖

> ID：15283246
> 
> 赞同：0
> 
> 时间：2013-03-07T22:43:01.583
> 
> 标签：jquery, jquery-ui, localization, datepicker

如何覆盖 jQuery UI datepicker 函数并使其每月通过 31 天？我需要这个改变来进行本地化。我使用以下代码更改`_getDaysInMonth`返回值但没有成功。

```
$.datepicker._getDaysInMonth = function(fyear, fmonth){
        return 31;
    }; 
```

jQuery UI datepicker 应该每个月显示 31 天，例如第 4 个月（4 月）默认为 30 天，但我需要 jQuery 显示 31 天块。谢谢。

# java - AndroidManifest.xml 添加代码后自行重写

> ID：15283252
> 
> 赞同：0
> 
> 时间：2013-03-07T22:43:09.560
> 
> 标签：java, android, android-manifest

当我使用 Eclipse 4.2.1 xml 编辑器手动将代码添加到 AndroidManifest.xml 时，代码会运行一段时间，但我添加的代码（例如权限）会随机消失，从而破坏应用程序。我是否编辑了错误的清单？添加权限等时我不使用GUI。当代码丢失时，我不会删除或修改文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:47:57.430

您是否正在编辑正确的 AndroidManifest.xml？您的项目的基本文件夹中有一个，这是您应该编辑的那个，而 bin 文件夹中有一个，编辑将导致您描述的行为。

# c# - Control.Add 更改控件位置

> ID：15283253
> 
> 赞同：0
> 
> 时间：2013-03-07T22:43:21.443
> 
> 标签：c#, winforms

这将很难解释。

这是我的自定义控件的工作方式：

1.  我制作了一个包含 ContainerControl 和 VScrollBar 的自定义列表视图
2.  列表视图中的项目被添加到 ContainerControl，在滚动移动时，项目在 ContainerControl 中重新定位。

这就是自定义列表视图的基本思想。

现在：每个 ListviewItem 的高度为 111 并且像魅力一样工作。直到我准确地添加了 295 个项目，这些项目之后的项目看起来有些奇怪。

每个 ListviewItem 在 Paint 事件中都包含图片框、进度条、标签、一些按钮和一些自定义绘画之类的东西。

现在，ListviewItems 上被绘制的所有内容（在 Paint 事件中）都已正确定位。但是，使用 Controls.Add() 添加的某些（！）控件不是，它们似乎获得了负 Y 值。

当我在 SomeControl.Location = new Point(x, y) 之后设置断点时，控件确实具有正确的值，但是在我使用 Controls.Add() 将控件添加到 ListviewItem 之后，Y 值为负。最奇怪的部分是一些控件没有得到这个，这可能是解决这个问题的一种方法。

我真的希望你能理解我想要弄清楚的东西，如果你不明白的话，请问我。

编辑：这是 WinForms。不能显示很多代码，因为它只是 Control.Location = x; 和 Controls.Add(c)；

# java - DefaultListSelectionModel 很慢，我怎样才能更快地添加选择？

> ID：15283265
> 
> 赞同：0
> 
> 时间：2013-03-07T22:44:05.583
> 
> 标签：java, swing, optimization, jtable

对于我的 JTable，我使用的是 DefaultListSelectionModel。有一个 setSelectionInteral(int index0, int index1) 和 addSelectionInteral(int index0, int index1)。如果我有一个连续的选择或单个选择，这些效果很好。如果我有很多单独的或不连续的选择怎么办？添加一千个单选非常慢。我应该使用另一个类来驱动我的 JTable 选择吗？我不明白为什么我不能一次提供所有选定索引的列表，为什么只能提供间隔？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:04:57.277

与其尝试在[您](https://stackoverflow.com/a/13919878/230513)`ListSelectionModel`的.`TableModel`

# c# - 为什么我的图像会自动重新缩放？

> ID：15283267
> 
> 赞同：1
> 
> 时间：2013-03-07T22:42:22.150
> 
> 标签：c#

我今天必须在课堂上开始制作拼图/图像拼图，这很好，除了我的图像保持/保持自身重新缩放的事实。

图片本身是300*300的，但是运行代码的时候就变成了192*192，虽然我是用图片自己的尺寸来声明尺寸的。

代码包括：

```
public partial class Form1 : Form
{
    private Bitmap Bmp;
    private Point BmpLoc;

    int x = 0, y = 0;

    public Form1()
    {
        InitializeComponent();
        this.Paint += new System.Windows.Forms.PaintEventHandler(Form1_Paint);
    }

    private void showButton_Click(object sender, EventArgs e)
    {
        Bmp = new Bitmap("C:\\Users\\Admin\\Desktop\\img.png");
        BmpLoc = new Point(0, 0);
        Rectangle R = new Rectangle(BmpLoc, Bmp.Size);
        int noot = Bmp.Size.Height;
        label3.Text = noot.ToString();

        this.Invalidate(R);
    }
    private void Form1_Paint(object sender, System.Windows.Forms.PaintEventArgs e)
    {
        if (Bmp != null)
        {
            e.Graphics.DrawImage(Bmp, BmpLoc);
        }
    } 
```

如您所见，矩形的大小采用位图大小，所以它不应该只显示 300*300 吗？

预先感谢您的回答

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:48:19.250

这是因为图像的 DPI。您可以使用[`Graphics.DrawImageUnscaled`](http://msdn.microsoft.com/en-us/library/system.drawing.graphics.drawimageunscaled.aspx)：

```
e.Graphics.DrawImageUnscaled(Bmp, BmpLoc); 
```

[`HorizontalResolution`](http://msdn.microsoft.com/en-us/library/system.drawing.image.horizontalresolution.aspx)您可以使用和[`VerticalResolution`](http://msdn.microsoft.com/en-us/library/system.drawing.image.verticalresolution.aspx)属性检查图像的 DPI（分辨率） 。通常屏幕的分辨率为 96 DPI（每英寸点数）。但是，这在 Windows 中是可配置的。如果图像的分辨率与此不同，则会缩放图像以保持其屏幕尺寸。

# ruby - 了解此 rspec gem 的工作原理

> ID：15283270
> 
> 赞同：0
> 
> 时间：2013-03-07T22:44:28.620
> 
> 标签：ruby, rspec

我正试图让这颗宝石工作，但运气不佳。虽然这是木偶相关的，但我的问题希望不是。

我试图理解以下`:rspec`if 语句的含义：

```
module RSpecHieraPuppet
  module HieraDefaultConfiguration
    extend RSpec::SharedContext
    let(:hiera_config) do
      { :backends => ['rspec'],
        :rspec => respond_to?(:hiera_data) ? hiera_data : {} } # this one
    end
  end
end 
```

来源：[https ://github.com/amfranz/rspec-hiera-puppet/blob/master/lib/rspec-hiera-puppet/rspec.rb](https://github.com/amfranz/rspec-hiera-puppet/blob/master/lib/rspec-hiera-puppet/rspec.rb)

有人可以澄清这里的`? hiera_data`意思吗？我似乎在 gem 的源代码中找不到任何对它的引用。

我的理解是，从 gem 的示例用法来看，响应正在监视示例响应中的触发器：

```
let(:hiera_data) do
  {  
    :key123  => ['abc'],
  }
end 
```

但我似乎无法追踪它触发后会发生什么，因为我没有看到任何与 `rspec_backend.rb`负责处理此问题的文件的连接。

任何帮助跟踪此处拨打的电话将不胜感激。（gem 只有 3 个文件可以使用）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:02:35.350

看来，如果您定义了一个

```
let(:hiera_data) { {:key => 'value'} } 
```

这将是 :rspec 键的值。那是因为在这种情况下，范围内的对象会响应 hiera_data。否则该值为 {}。

有关 respond_to 语法的信息？[在这里阅读](http://ruby-doc.org/core-2.0/Object.html#method-i-respond_to-3F)

我想这就是你要问的。

# java - 使用 Hibernate 从 Postgres 枚举到 Java

> ID：15283277
> 
> 赞同：2
> 
> 时间：2013-03-07T22:45:10.897
> 
> 标签：java, hibernate, jdbc, types, usertype

我试图在数据库上有一个枚举类型并将其转换为 java，我编写了一个 EnumUserType 类来进行转换，但它不识别 PGobject 类。

```
public Object nullSafeGet(ResultSet rs, String[] names, SessionImplementor si, Object owner)
        throws HibernateException, SQLException {
    Object object = rs.getObject(names[0]);
    if (rs.wasNull()) {
        return null;
    }

    if (object instanceof PGobject) {
        //code doesn't reach this line
    }

    log.info(object.getClass()); // prints class org.postgresql.util.PGobject
    return null;
} 
```

我检查了，我有完全相同的 postgresql 驱动程序版本。我看到了这篇文章：[Java enum with Eclipselink](https://stackoverflow.com/questions/10898369/mapping-java-enum-on-postgres-enum-with-eclipselink "带有 EclipseLink 的 Java 枚举")。这是一个我也会尝试的解决方案，但我的主要问题是：显然它是同一类，为什么它没有被识别为这样？我可以有两个具有相同名称和包的不同类吗？如果我仍然必须在 Postgres 中使用枚举，我该如何修复它以正确映射到我的 Java 枚举？

编辑：

我试图做一个：

```
PGobject pg = (PGobject) object; 
```

它抛出一个类转换异常：

```
org.postgresql.util.PGobject cannot be cast to org.postgresql.util.PGobject 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-11T09:03:43.400

我使用泛型类作为映射枚举的类型。然后，您可以使用它映射所有枚举。

课程是这样的：

```
public class GenericEnumUserType implements UserType, ParameterizedType {

private static final String DEFAULT_IDENTIFIER_METHOD_NAME = "name";
private static final String DEFAULT_VALUE_OF_METHOD_NAME = "valueOf";

private Class enumClass;
private Class identifierType;
private Method identifierMethod;
private Method valueOfMethod;
private NullableType type;
private int[] sqlTypes;

@Override
public void setParameterValues(Properties parameters) {
    String enumClassName = parameters.getProperty("enumClassName");
    try {
        enumClass = Class.forName(enumClassName).asSubclass(Enum.class);
    } catch (ClassNotFoundException cfne) {
        throw new HibernateException("Enum class not found", cfne);
    }

    String identifierMethodName = parameters.getProperty("identifierMethod", DEFAULT_IDENTIFIER_METHOD_NAME);

    try {
        identifierMethod = enumClass.getMethod(identifierMethodName, new Class[0]);
        identifierType = identifierMethod.getReturnType();
    } catch (Exception e) {
        throw new HibernateException("Failed to obtain identifier method", e);
    }

    type = (NullableType) TypeFactory.basic(identifierType.getName());

    if (type == null) {
        throw new HibernateException("Unsupported identifier type " + identifierType.getName());
    }

    sqlTypes = new int[] { type.sqlType() };

    String valueOfMethodName = parameters.getProperty("valueOfMethod", DEFAULT_VALUE_OF_METHOD_NAME);

    try {
        valueOfMethod = enumClass.getMethod(valueOfMethodName, new Class[] { identifierType });
    } catch (Exception e) {
        throw new HibernateException("Failed to obtain valueOf method", e);
    }
}

@Override
public Class returnedClass() {
    return enumClass;
}

@Override
public Object nullSafeGet(ResultSet rs, String[] names, Object owner) throws HibernateException, SQLException {
    Object identifier = type.get(rs, names[0]);
    if (rs.wasNull()) {
        return null;
    }

    try {
        return valueOfMethod.invoke(enumClass, new Object[] { identifier });
    } catch (Exception e) {
        throw new HibernateException("Exception while invoking " + "valueOf method " + valueOfMethod.getName()
                + " of enumeration class " + enumClass, e);
    }
}

@Override
public void nullSafeSet(PreparedStatement st, Object value, int index) throws HibernateException, SQLException {
    try {
        if (value == null) {
            st.setNull(index, type.sqlType());
        } else {
            Object identifier = identifierMethod.invoke(value, new Object[0]);
            type.set(st, identifier, index);
        }
    } catch (Exception e) {
        throw new HibernateException("Exception while invoking identifierMethod " + identifierMethod.getName()
                + " of enumeration class " + enumClass, e);
    }
}

@Override
public int[] sqlTypes() {
    return sqlTypes;
}

@Override
public Object assemble(Serializable cached, Object owner) throws HibernateException {
    return cached;
}

@Override
public Object deepCopy(Object value) throws HibernateException {
    return value;
}

@Override
public Serializable disassemble(Object value) throws HibernateException {
    return (Serializable) value;
}

@Override
public boolean equals(Object x, Object y) throws HibernateException {
    return x == y;
}

@Override
public int hashCode(Object x) throws HibernateException {
    return x.hashCode();
}

@Override
public boolean isMutable() {
    return false;
}

@Override
public Object replace(Object original, Object target, Object owner) throws HibernateException {
    return original;
}} 
```

枚举类应该是这样的：

```
public enum AccountStatus {
ACTIVE(1), BLOCKED(2), DELETED(3);

private AccountStatus(int id) {
    this.id = id;
}

private int id;

public int getId() {
    return id;
}

public void setId(int id) {
    this.id = id;
}

public static AccountStatus valueOf(int id) {
    switch (id) {
    case 1:
        return ACTIVE;
    case 2:
        return BLOCKED;
    case 3:
        return DELETED;
    default:
        throw new IllegalArgumentException();
    }
}} 
```

静态方法“valueOf”是从存储在数据库中的 id 转换为 java 对象所必需的。

那么，hibernate映射是这样的：

```
<hibernate-mapping>
<typedef class="path.to.GenericEnumUserType" name="accountStatusType">
    <param name="enumClassName">com.systemonenoc.hermes.ratingengine.persistence.constants.AccountStatus</param>
    <param name="identifierMethod">getId</param>
</typedef>
<class name="package.to.class.with.enum.Account" table="account" schema="public">
    <property name="accountStatus" type="accountStatusType" column="account_status" not-null="true" />
[...]
</hibernate-mapping> 
```

因此，您必须使用 typedef 将 GenericEnumUserType 类声明为类型，以及获取枚举 id 的方法（在本例中为 getId()）。在您的数据库中，将 id 作为值存储在整数列中，而在 java 中，您将拥有 enum 对象。

# java - 这些 Xmemcached 错误消息是什么？

> ID：15283279
> 
> 赞同：0
> 
> 时间：2013-03-07T22:45:12.187
> 
> 标签：java, tomcat, xmemcached

我是 Java 环境的新手（我是一个 JS 开发人员，直到现在才不得不使用大型环境），我的应用程序在 Tomcat 实例上运行，但我很好奇这些消息的含义。我的意思是，该应用程序在 localhost 端口 8080 上运行良好——我只是想知道我是否应该关注这些：

> 在 com.google.code.yanf4j.nio.impl.Reactor.run(Reactor.java:141) 2013-03-07 14:38:57,134 [Heal-Session-Thread] 错误 com.google.code.yanf4j.core .impl.AbstractController：重新连接到 127.0.0.1:11211 失败 2013-03-07 14:39:25,134 [Heal-Session-Thread] WARN com.google.code.yanf4j.core.impl.AbstractController：尝试连接到 127.0 .0.1:11211 15 次
> 
> 2013-03-07 14:39:25,135 [Xmemcached-Reactor-0] 错误 com.google.code.yanf4j.core.impl.AbstractController：控制器 java.io.IOException 发生异常：连接到 127.0.0.1:11211 失败，com.google.code.yanf4j.nio.impl.Reactor.dispatchEvent(Reactor.java:302) 的 net.rubyeye.xmemcached.impl.MemcachedConnector.onConnect(MemcachedConnector.java:406) 拒绝连接。 code.yanf4j.nio.impl.Reactor.run(Reactor.java:141) 2013-03-07 14:39:25,135 [Xmemcached-Reactor-0] 错误远程处理：反应堆调度事件错误 java.io.IOException：连接到127.0.0.1:11211 失败，com.google.code.yanf4j.nio.impl.Reactor.dispatchEvent(Reactor.java:302) 处的 net.rubyeye.xmemcached.impl.MemcachedConnector.onConnect(MemcachedConnector.java:406) 连接被拒绝) 在 com.google.code.yanf4j.nio.impl.Reactor。运行（Reactor.java:141）2013-03-07 14:39:25,135 [Heal-Session-Thread] 错误 com.google.code.yanf4j.core.impl.AbstractController：重新连接到 127.0.0.1:11211 失败 2013- 03-07 14:39:55,136 [Heal-Session-Thread] 警告 com.google.code.yanf4j.core.impl.AbstractController：尝试连接到 127.0.0.1:11211 16 次
> 
> 2013-03-07 14:39:55,136 [Xmemcached-Reactor-0] 错误 com.google.code.yanf4j.core.impl.AbstractController：控制器 java.io.IOException 发生异常：连接到 127.0.0.1:11211 失败，com.google.code.yanf4j.nio.impl.Reactor.dispatchEvent(Reactor.java:302) 的 net.rubyeye.xmemcached.impl.MemcachedConnector.onConnect(MemcachedConnector.java:406) 拒绝连接。 code.yanf4j.nio.impl.Reactor.run(Reactor.java:141)
> 
> 2013-03-07 14:39:55,136 [Heal-Session-Thread] 错误 com.google.code.yanf4j.core.impl.AbstractController：重新连接到 127.0.0.1:11211 失败
> 
> 2013-03-07 14:39:55,136 [Xmemcached-Reactor-0] 错误远程处理：反应堆调度事件错误 java.io.IOException：连接到 127.0.0.1:11211 失败，net.rubyeye.xmemcached.impl 连接被拒绝。 MemcachedConnector.onConnect(MemcachedConnector.java:406) 在 com.google.code.yanf4j.nio.impl.Reactor.dispatchEvent(Reactor.java:302) 在 com.google.code.yanf4j.nio.impl.Reactor.run(反应堆.java:141)
> 
> 2013-03-07 14:40:27,136 [Heal-Session-Thread] 警告 com.google.code.yanf4j.core.impl.AbstractController：尝试连接到 127.0.0.1:11211 17 次
> 
> 2013-03-07 14:40:27,137 [Xmemcached-Reactor-0] 错误 com.google.code.yanf4j.core.impl.AbstractController：控制器 java.io.IOException 发生异常：连接到 127.0.0.1:11211 失败，com.google.code.yanf4j.nio.impl.Reactor.dispatchEvent(Reactor.java:302) 的 net.rubyeye.xmemcached.impl.MemcachedConnector.onConnect(MemcachedConnector.java:406) 拒绝连接。 code.yanf4j.nio.impl.Reactor.run(Reactor.java:141)
> 
> 2013-03-07 14:40:27,137 [Xmemcached-Reactor-0] 错误远程处理：反应堆调度事件错误 java.io.IOException：连接到 127.0.0.1:11211 失败，net.rubyeye.xmemcached.impl 连接被拒绝。 MemcachedConnector.onConnect(MemcachedConnector.java:406) 在 com.google.code.yanf4j.nio.impl.Reactor.dispatchEvent(Reactor.java:302) 在 com.google.code.yanf4j.nio.impl.Reactor.run(反应堆.java:141)
> 
> 2013-03-07 14:40:27,137 [Heal-Session-Thread] 错误 com.google.code.yanf4j.core.impl.AbstractController：重新连接到 127.0.0.1:11211 失败
> 
> 2013-03-07 14:41:01,138 [Heal-Session-Thread] 警告 com.google.code.yanf4j.core.impl.AbstractController：尝试连接到 127.0.0.1:11211 18 次
> 
> 2013-03-07 14:41:01,138 [Xmemcached-Reactor-0] 错误 com.google.code.yanf4j.core.impl.AbstractController：控制器 java.io.IOException 发生异常：连接到 127.0.0.1:11211 失败，com.google.code.yanf4j.nio.impl.Reactor.dispatchEvent(Reactor.java:302) 的 net.rubyeye.xmemcached.impl.MemcachedConnector.onConnect(MemcachedConnector.java:406) 拒绝连接。 code.yanf4j.nio.impl.Reactor.run(Reactor.java:141)
> 
> 2013-03-07 14:41:01,138 [Xmemcached-Reactor-0] 错误远程处理：反应堆调度事件错误 java.io.IOException：连接到 127.0.0.1:11211 失败，net.rubyeye.xmemcached.impl 连接被拒绝。 MemcachedConnector.onConnect(MemcachedConnector.java:406) 在 com.google.code.yanf4j.nio.impl.Reactor.dispatchEvent(Reactor.java:302) 在 com.google.code.yanf4j.nio.impl.Reactor.run(反应堆.java:141)
> 
> 2013-03-07 14:41:01,138 [Heal-Session-Thread] 错误 com.google.code.yanf4j.core.impl.AbstractController：重新连接到 127.0.0.1:11211 失败

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T12:10:56.607

它尝试在 localhost:11211 连接到 memcached。您的应用程序正在使用 memcached，而 xmemcached 是一个 java 客户端。你可以通过 memcached 命令在你的机器上启动一个 memcached。

但首先，你必须安装 memcached： [https ://code.google.com/p/memcached/](https://code.google.com/p/memcached/)

# html - IE 的条件注释不起作用

> ID：15283280
> 
> 赞同：1
> 
> 时间：2013-03-07T22:45:12.900
> 
> 标签：html

我正在尝试使用条件注释包含一个仅限 IE7 的样式表：

```
<head>
  <meta charset="utf-8">
  <title>Title</title>
  <meta name="description" content="Description">
  <link href="/static/styles/bootstrap.min.css" rel="stylesheet">
  <link href="/static/styles/font-awesome.min.css" rel="stylesheet">
  <link href="/static/styles/main.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Quicksand:700' rel='stylesheet' type='text/css'>
  <!--[if lt IE 9]>
    <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <!-- [if IE 7]>
    <link type="text/css" rel="stylesheet" href="/static/styles/ie7.css">
  <![endif]-->
  <link rel="icon" type="image/png" href="/static/images/layout/favicon.png">
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
</head> 
```

我有一个 Windows 7 虚拟机（在 VirtualBox 上运行），我正在使用 IE9 中的开发人员工具将浏览器模式切换到 IE7。引用的样式表中的任何内容都不会应用于页面。我正在加载这个样式表，我正在使用所有其他样式表`!important`，并且我已经三重检查了文件名和路径，但样式仍然没有被应用。谁能看到我哪里出错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:50:24.733

有一个空间

```
<!--RIGHT HERE[... remove that one 
```

前：

```
<!-- [if IE 7]>
    <link type="text/css" rel="stylesheet" href="/static/styles/ie7.css">
 <![endif]--> 
```

后：

```
 <!--[if IE 7]>
    <link type="text/css" rel="stylesheet" href="/static/styles/ie7.css">
  <![endif]--> 
```

不知道是不是这样

# amazon-web-services - Amazon Glacier：如何将存档检索 SNS 响应与其作业 ID 相关联？

> ID：15283281
> 
> 赞同：0
> 
> 时间：2013-03-07T22:45:16.270
> 
> 标签：amazon-web-services, amazon, amazon-sns, amazon-glacier

我有一项将 zip 文件存档到 Glacier 的服务。我设置了一个简单通知服务，让我知道取消归档作业何时完成（“归档-检索”请求）。从我所知道的一切来看，响应将与 GetJob() 调用相同：

```
HTTP/1.1 200 OK 
x-amzn-RequestId: x-amzn-RequestId 
Date: Date
Content-Type: ContentType Content-Length: Length
x-amz-sha256-tree-hash: ChecksumComputedByAmazonGlacier

[Bytes of requested file.] 
```

（[来源](http://docs.aws.amazon.com/amazonglacier/latest/dev/api-job-output-get.html)）

出于处理目的，我需要能够接受响应并进行处理（标记谁取消归档文件，将其内容放在正确的位置等）。有没有办法将传入的 GetJob() 响应与 Job ID 或类似的东西相关联？

谢谢，

扎克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T16:58:54.990

SNS 消息的正文将包含从[InitiateJob](http://docs.aws.amazon.com/amazonglacier/latest/dev/api-initiate-job-post.html)请求返回的作业 ID。以下是 Glacier 检索请求的示例 SNS JSON 正文：

```
{
   "Action":"ArchiveRetrieval", 
   "ArchiveId":"ewhHkrpO1sNPI4sFpDK7y0xFVNSR-eHEYrbWR2XKfRSy0Mf6f77T6P_9RhBLBqwn09k9AkcB0h03pyJiKxCfXRCVUDbvvTl7vJHbZO2ozTgunqbJ88p3uY1ytfhTDf_41PysxSmz_Q", 
   "ArchiveSHA256TreeHash":"34bbe1a578aa9a7ce3ada96e6e291821bd34b1fee403e3653a32d0a4ab0c7194", 
   "ArchiveSizeInBytes":1100754352, 
   "Completed":true, 
   "CompletionDate":"2013-03-12T22:17:29.692Z", 
   "CreationDate":"2013-03-12T18:17:13.938Z", 
   "InventorySizeInBytes":null, 
   "JobDescription":null, 
   "JobId":"uwa_RxWK39KIY0UGfgL38OWxQw234I8Gpre93LgW8VAl93Ts6VffRZyMbzZqjIh3GqqkiArv9oAXBRNXuUFfFko8bdcF", 
   "RetrievalByteRange":"0-1100754351", 
   "SHA256TreeHash":"34bbe1a578aa9a7ce3ada96e6e291821bd34b1fee403e3653a32d0a4ab0c7194", 
   "SNSTopic":null, 
   "StatusCode":"Succeeded", 
   "StatusMessage":"Succeeded", 
   "VaultARN":"..."
} 
```

您可以将该`JobId`字段传递给[GetJobOutput](http://docs.aws.amazon.com/amazonglacier/latest/dev/api-job-output-get.html)请求以下载存档的内容。该值可以`InitiateJob`通过标头与原始响应相关联`x-amz-job-id`。

# types - 看不懂 OCaml trie 类型声明

> ID：15283284
> 
> 赞同：2
> 
> 时间：2013-03-07T22:45:32.107
> 
> 标签：types, ocaml

我试图了解人们如何在 OCaml 中编写 trie。我在网上找到了一个例子：

它定义了一个地图：

```
module CharMap = Map.Make(Char) 
```

然后它定义了 trie 的类型：

```
(* count of members of the set that end at this node * mapping from
     next char => children *)
type trie = Node of int * trie CharMap.t 
```

这是我的问题：什么是`trie CharMap.t`？我认为这是某种地图，但我无法弄清楚它是什么。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T23:06:34.813

为了扩展 rgrinberg 的答案：在 OCaml 中，类型构造函数位于其参数之后。所以你有`int list`，这是一个整数列表。在这里，您有一个类型构造函数`CharMap.t`，它构造其键为 type 的映射`char`。`int CharMap.t`从`char`s 到s 的映射也是如此`int`。的含义`trie CharMap.t`是完全类似的，除了可能是因为（正如 rgrinberg 指出的那样），这是对 type 的递归使用`trie`。它类似于树的定义，树的节点中包含的事物本身就是树。在这里，包含在 trie 中的东西本身就是尝试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T23:01:37.813

从您的代码段中，我猜`trie CharMap.t`是一个映射，其中键是字符，值是`trie`递归定义的类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-01T15:30:49.100

trie CharMap.t 是从 Char 到 trie 数据类型的映射类型。这使用参数类型。例如，

类型'parampaired_with_int = int *'param;;

然后您可以按如下方式指定类型：

type specific_pair = floatpaired_with_int;;

# android - 在移动 Android 手机上保存图像

> ID：15283285
> 
> 赞同：1
> 
> 时间：2013-03-07T22:45:33.033
> 
> 标签：android, file-io

我想将从输入流接收到的图像保存到设备。此图像使用`ImageView`和 函数显示`decodeStream()`。

如何将接收到的图像保存到手机上的特定路径（例如，SD卡上）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:03:23.310

要保存到您的外部存储，您可以获得如下路径：

```
Environment.getExternalStorageDirectory().toString(); 
```

然后，当您开始使用相机意图时，文件位置可以是任何路径。

```
camera.putExtra(android.provider.MediaStore.EXTRA_OUTPUT, [file location]); 
```

更多信息在这里：http: [//developer.android.com/reference/android/provider/MediaStore.html#EXTRA_OUTPUT](http://developer.android.com/reference/android/provider/MediaStore.html#EXTRA_OUTPUT)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:11:12.843

也从 decodestream 制作一个位图，比如 photo2

```
 mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory(
              Environment.DIRECTORY_PICTURES), "your apps name");   

 mediaFile = new File(mediaStorageDir.getPath() + File.separator +
                 "Image" + num + ".png"); // make a int num and save it and
        try {                      //add it to the file name, increment for every
                                     //save that you do
            fOut = new FileOutputStream(mediaFile);
        } catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        photo2.compress(Bitmap.CompressFormat.PNG, 100,fOut); 
```

# php - 用 JavaScript 编写的 Cookie 在 PHP 中仅显示为整数

> ID：15283287
> 
> 赞同：0
> 
> 时间：2013-03-07T22:45:40.470
> 
> 标签：php, javascript, cookies

我在正确读取用 JavaScript 编写的 PHP cookie 时遇到问题。具体来说，问题在于 PHP 将只读取整数，而忽略所有其他字符。例如，如果我将 'firstName' 存储为 'Bob'，而 'phoneNumber' 显示为 '555-1234'，PHP 将显示 0 代表 'firstName' 和 '555' 代表 'phoneNumber'。

我存储的示例数据（cookieName=value）

```
AreCookiesEnabled=344
firstName=Bob
lastName=Smith
email=bsmith@email.com
hpID=PL7H88
company=Bobcorp
phoneNumber=555-1234
language=en
os=Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; CMNTDF; BRI/1; .NET4.0C; .NET4.0E)
browser=5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; CMNTDF; BRI/1; .NET4.0C; .NET4.0E)
description=This is a description. 
```

这是我用来编写 cookie 的 JavaScript 函数：

```
function SetCookie(cookieName, cookieValue, nDays)
{
    //alert("SetCookie("+cookieName+", "+cookieValue+", "+nDays+")");
    var today = new Date();
    var expire = new Date();
    if (nDays==null || nDays==0)
    {
        nDays=1;
    }

    if(cookieValue == '')
    {
        cookieValue = 'none';
    }

    expire.setTime(today.getTime() + 3600000*24*nDays);
    document.cookie = cookieName+"="+escape(cookieValue)+";expires="+expire.toGMTString()+";domain=.ourdomain.com;path=/";
}// 
```

在 PHP 页面上，我有 phpinfo() 显示 cookie。对于 _REQUEST["firstName"] 和 _COOKIE["firstName"] 我得到 "Bob"，但是当我回显 $_COOKIE["firstName"] 时我得到 0。事实上，使用上面的示例信息，我得到这个输出：

```
Are cookies enabled: 108
First Name: 0
Last Name: 0
Email: 0
HP ID: 0
Company: 0
Phone Number: 555
Language: 0
Operating System: 0
Browser: 5
Description: 0 
```

我也做 print_r($_COOKIE); 并得到这个输出：

```
Array ( [testsession] => true [firstName] => Bob [lastName] => Smith [email] => bsmith@email.com [hpID] => PL7H88 [company] => Bobcorp [phoneNumber] => 555-1234 [language] => en [AreCookiesEnabled] => 108 [description] => This is a description. [browser] => 5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; CMNTDF; BRI/1; .NET4.0C; .NET4.0E) [os] => Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; CMNTDF; BRI/1; .NET4.0C; .NET4.0E) ) 
```

似乎一切都在那里并且正确，除了最终输出。谁能告诉我我在这里做错了什么？谢谢你。

**编辑：**根据大众的需求，这是 PHP 文件...

```
<?php
phpinfo();
phpversion();
print_r($_COOKIE);

echo("<p>An error has occurred.</p>");
echo("<p><b>Are cookies enabled:</b> ");
echo($_COOKIE['AreCookiesEnabled']+"<br /></p>");
echo("<p><b>First Name:</b> ");
echo($_COOKIE['firstName']+"<br /></p>");
echo("<p><b>Last Name:</b> ");
echo($_COOKIE['lastName']+"<br /></p>");
echo("<p><b>Email:</b> ");
echo($_COOKIE['email']+"<br /></p>");
echo("<p><b>HP ID:</b> ");
echo($_COOKIE['hpID']+"<br /></p>");
echo("<p><b>Company:</b> ");
echo($_COOKIE['company']+"<br /></p>");
echo("<p><b>Phone Number:</b> ");
echo($_COOKIE['phoneNumber']+"<br /></p>");
echo("<p><b>Language:</b> ");
echo($_COOKIE['language']+"<br /><br /></p>");
echo("<p><b>Operating System:</b> ");
echo($_COOKIE['os']+"<br /></p>");
echo("<p><b>Browser:</b> ");
echo($_COOKIE['browser']+"<br /><br /></p>");
echo("<p><b>Description:</b> <br /><br />");
echo($_COOKIE['description']+"</p>");
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T22:54:31.090

问题显然不在于会话数据本身，而在于您如何在 PHP 中获取它。

我在这里看到的行为是那些字符串（“Bob”和“555-1234”）正在被转换为 int。PHP 实际上将这些字符串分别转换为`0`和，如此[处](http://www.php.net/manual/en/language.types.string.php#language.types.string.conversion)`555`所述。

尤其：

> 该值由字符串的初始部分给出。如果字符串以有效的数字数据开头，这将是使用的值。否则，该值将为 0（零）。

检查您的脚本以进行 int 强制转换（定义为`(int)`）或任何隐式转换并将其删除。或者发布您的 PHP 代码，让我检查一下。

编辑：

在您的 PHP 代码中，您使用的`+`是为数值保留的运算符；因此导致隐式转换为 int。改为用于`.`字符串连接。

# javascript - 使用 D3 标记动画折线图

> ID：15283289
> 
> 赞同：1
> 
> 时间：2013-03-07T22:45:56.950
> 
> 标签：javascript, animation, d3.js, label, linechart

我是 D3 的新手，遇到了一个似乎无法解决的问题。

我已经使用[本教程](http://bost.ocks.org/mike/path/)构建了一个动画折线图，现在我正在尝试添加它。我认为这是一个很酷的想法，将标记折线图中的每条线，但将其标记在线的末尾。

[到目前为止，这是我想出的](http://jsbin.com/uvayof/1/)：

![在此处输入图像描述](../Images/ece1296ef6a958640c1438e9f2bb5cf9.png)

正如你所看到的，它充其量是次优的。我错误地定位了文本，但不明显的是如何以正确的方式定位它。这是有问题的代码。

```
name.transition()
    .duration(duration)
    .ease("linear")
    .attr("transform", function(d) { 
      return "translate(" + (width - margin.left - margin.right) +", " + y(d[n-2]) + ")";
    }); 
```

似乎“线性”缓动已关闭，并且有时似乎使用不同的比例。

有没有 D3 专家（或新手）愿意教我这样做的正确方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T00:56:55.517

这里似乎有两个问题：

1.  `.interpolate("basis")`- 您对标题使用线性插值，但对路径使用 B 样条插值。注释掉这条线可以使标题与您的数据线非常紧密（尽管它也会使线变得平滑 - 对于大多数数据图来说可能是一件好事）。

2.  轴刻度变化时“跳跃”。这是因为标题正在转换到新比例上的新位置，但它的起始位置仍然是相对于旧比例设置的，所以它可能从它所跟踪的线的上方或下方开始。`.attr`我认为您可以通过在开始转换之前添加直接设置来解决此问题，以修复标题的初始位置：

    ```
    name
        .attr("transform", function(d) {
           return "translate(" +
               (width - margin.left - margin.right) +", " + y(d[n-2]) + ")"
        })
        .transition()
        // etc 
    ```

见[http://jsbin.com/uvayof/2](http://jsbin.com/uvayof/2)

# unix - unix 命令“file -i”能够识别哪些文件编码？

> ID：15283291
> 
> 赞同：1
> 
> 时间：2013-03-07T22:46:15.030
> 
> 标签：unix

unix 命令“file -i”能够识别哪些文件编码？

手册页不存在“file -i”能够识别的可能文件编码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T03:54:50.813

I don't know whart your system has necessarily. `/usr/share/misc/magic` has the patterns that the file command uses to identify file flavors. You can edit that file and see what is available.

The `file -i` outputs information in mime format. But file can only determine file types based on the magic file, not the output types, because the output is mime encoded. I would take one of each flavor of file that you and see what you get for output.

You do realize that there are many platforms represented in the magic file, so enumerating everything would be both an antique-collecting activity and an incredible effort. That may be why google does not find much.

Got an old acorn?

# javascript - 使用 javascript 为 jwplayer 的 HTML 元素覆盖设置 wmode

> ID：15283293
> 
> 赞同：4
> 
> 时间：2013-03-07T22:46:19.517
> 
> 标签：javascript, overlay, transparent, jwplayer, wmode

我正在尝试`<div>`在我的 jwplayer 上覆盖 a。我相信为了做到这一点，我必须将“wmode”参数设置为“透明”。到目前为止，我一直没有成功尝试这种方式：

```
jwplayer('profile-video').setup(
                'width': '640',
                'height': '360',
                'skin' : "/jwplayer/skins/bekle.xml",
                'file' : video_url,
                'wmode' : 'transparent'
            ) 
```

任何人都知道我哪里出错了，或者“wmode”可能是要设置的错误参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-14T21:32:00.913

试试[http://totaldev.com/content/jw-player-textmark-plugin](http://totaldev.com/content/jw-player-textmark-plugin)。

该插件具有多个文本覆盖的灵活性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:00:49.543

这也应该没问题，但是在 JW Player 上真正覆盖 div 的最佳方式是通过 JavaScript 插件。我们在这里提供了一个 SDK，其中包含一个基于 Hello World JS 的示例插件 - [http://developer.longtailvideo.com/trac/](http://developer.longtailvideo.com/trac/)

# jquery - 添加/删除类转换不起作用

> ID：15283294
> 
> 赞同：1
> 
> 时间：2013-03-07T22:46:34.707
> 
> 标签：jquery

我有一个由“ul”列表制作的菜单。我有 2 个悬停样式和普通类。我想在鼠标悬停时为这两个类之间的过渡设置动画。

我有这个html：

```
<ul class="mainNav">
                <li><a href="#">Home</a></li>
                <li><a href="#">Store</a></li>
                <li><a href="#">About Us</a></li>
                <li><a href="#">Your Account</a></li>
                <li><a href="#">Contact</a></li>
</ul> 
```

课程：

> forHover, notHover

jQuery 1.9.1 ; 用户界面 1.10.1

jQuery代码：

```
$('.mainNav li:not(:last-child)').hover(function(){

    $(this).addClass("forHover",3000);
    return false;
},function(){

    $(this).removeClass("forHover",3000);
    return false;

}); 
```

悬停效果正常，但没有过渡。为什么不？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T22:56:23.260

我认为您正在使用标准 jQuery API 中的[**addClass**](http://api.jquery.com/addclass/)和[**removeClass**](http://api.jquery.com/removeClass/)。

您需要参考 UI 版本的 jQuery UI API。

* * *

[**DEMO**](http://jsfiddle.net/zc8Py/) -- 使用 UI API 参考 jQuery UI 1.10.1 工作正常

* * *

我下载了1.10.1版本的效果，添加到上面的DEMO中。
演示使用与您完全相同的版本，并且一切正常。由于 jQuery UI 开箱即用，您还遇到了其他一些本地化问题。

也许您引用的其他 API 或插件被覆盖`$.ui`或类似

演示按原样使用您的代码，并按原样使用 jQuery 1.9.1 + jQuery UI 1.10.1：

```
$('.mainNav li:not(:last-child)').hover(function () {
    $(this).addClass("forHover", 3000);
    return false;
}, function () {
    $(this).removeClass("forHover", 3000);
    return false;
}); 
```

**编辑**

我检查了你正在链接的网站，即使在使用了你的确切`forHover`CSS 之后，它仍然可以在最新的 Chrome、Firefox 和 IE10 中运行。

我无法完全看到和理解文件中所有其他 JavaScript 试图做什么，但我不得不猜测在那里的某个地方你正在对那些以某种方式抵消动画效果的菜单项做一些事情。

* * *

[**演示**](http://jsfiddle.net/zc8Py/1/)- 使用实际 forHover 中的 CSS

* * *

**编辑**

我现在看到正在发生的事情。使用开发人员工具，您可以在选择将`li`鼠标悬停在菜单项上时看到，`forHover`但会立即被您的`.mainNav li, .notHover {`样式覆盖！因此，所有样式`forHover`都被删除了。

您的 CSS 发生冲突！

一个肮脏的快速修复正在添加`!important`到`forHover`样式中，这应该使它们工作，但它是一个肮脏的修复。

最好将 CSS分配`.mainNav li, .notHover {`给 just `.notHover`，默认分配`notHover`给`li`元素，然后使用 jQuery UI `switchClass`，类似于此（下面的代码未经测试，但语法应该是正确的）：

```
$('.mainNav li:not(:last-child)').hover(function () {
    $(this).switchClass("notHover", "forHover", 3000);
    return false;
}, function () {
    $(this).switchClass("forHover", "notHover", 3000);
    return false;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:11:26.667

您不能使用 jQuery UI 的效果方法为背景图像设置动画。

[http://api.jqueryui.com/addClass/](http://api.jqueryui.com/addClass/)

> 并非所有样式都可以设置动画。例如，没有办法为背景图像设置动画。任何无法动画的样式都将在动画结束时更改。

# java - 傻瓜的 Android 应用程序开发 - 示例无法运行

> ID：15283298
> 
> 赞同：0
> 
> 时间：2013-03-07T22:47:01.673
> 
> 标签：java, android

一两年前我带来了*Android Application Development for Dummies ，我终于坐下来尝试了这些东西。*我在 5 年前学习软件工程，所以我有一些想法，但 Eclipse 打败了我。

我按照书中所述设置了开发环境（新版本的一些变体等）并设置了我的第一个应用程序，恰当地命名为“Hello Android”。一旦我完成向导，我就会得到错误。

我得到`R cannot be resolved to a variable`了，在谷歌搜索之后，我在这里找到了大量有用的信息。但似乎没有一个可以解决我的问题。我`R.Java`在`gen`文件夹里。当我尝试`Project > Clean`我得到

> 执行aidl 时出错。请检查 Aidl 是否存在于 C:\android\adt-bundle-windows-x86-20130219\sdkplatform-tools\aidl.exe

我检查了目录并且`\sdkplatform-tools\`不存在。相反，文件夹结构是`\sdk\platform-tools\`. 我想我会尝试解决这个问题，所以我将 的内容复制`\platform-tools\`到错误消息中指定的目录中，但没有运气。

另外，我尝试了 SDK 附带的一些示例，我得到了同样的错误。

所以，我认为我的设置从根本上是错误的，我只是不知道是什么。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T22:56:23.963

转到 Window -> Preferences -> Android 并确保您的 SDK 位置设置正确。

# c# - 我只想让我的客户向我的服务器问好，但不能

> ID：15283300
> 
> 赞同：2
> 
> 时间：2013-03-07T22:47:04.843
> 
> 标签：c#, vb.net, web-services, asyncsocket

好吧，这是一个如此简单的问题，但它让我很生气，以至于我不得不喝一整壶水来让自己平静下来。

**编辑**

在标签中也添加了 c#，ac# 答案也可以。

基本上，我在微软的网站[http://msdn.microsoft.com/en-us/library/bbx2eya8.aspx](http://msdn.microsoft.com/en-us/library/bbx2eya8.aspx)上实现了这个异步客户端/服务器示例。

现在我有一个运行服务器的项目实例，服务器正常，只是在等待连接。

我试图了解 .net 中的异步通信模型，我只是希望我的 client.vb 向正在本地侦听端口 2000 的服务器问好。

微软示例中的代码很长，我正在努力理解它，但现在我只想要一个简单的几行代码来向我等待的服务器说“你好”。

```
Dim ipHostInfo As IPHostEntry = Dns.Resolve(Dns.GetHostName())
    Dim ipAddress As IPAddress = ipHostInfo.AddressList(0)
    Dim localEndPoint As New IPEndPoint(ipAddress, 2000)
    clientSocket.BeginConnect("localhost", 2000, AddressOf ConnectionMade, clientSocket) 
```

以上不起作用，我得到一个空指针异常。microsoft 示例中有很多回调、acceptcallback 和其他方法，我相信我很快就会明白，但现在它令人难以置信的混乱。

请让我免于戴着我的笔记本电脑戴帽子和帮助。只需一个简单的“你好”字符串到服务器，我的生活就会很快乐。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:17:46.610

我使用您的代码创建了一个示例，我可以让它给我一个空引用异常的唯一方法是如果我没有正确实例化套接字。但是如果没有看到您声明的 clientSocket 或 ConnectionMade 方法，就很难说清楚。

```
IPHostEntry ipHostInfo = Dns.Resolve(Dns.GetHostName());
IPAddress ipAddress = ipHostInfo.AddressList[0];
IPEndPoint localEndPoint = new IPEndPoint (ipAddress, 2000);
Socket clientSocket = new Socket(SocketType.Raw, ProtocolType.IPv4);
clientSocket.BeginConnect("http://www.google.com", 80, new AsyncCallback(method), clientSocket); 
```

# c# - 如何防止 ToString("0,0") 返回 00

> ID：15283301
> 
> 赞同：3
> 
> 时间：2013-03-07T22:47:09.540
> 
> 标签：c#, .net, asp.net-mvc-3

我有一堆整数必须在我的一个视图中显示。

我以这种方式显示它们：

```
int myVariable = 12500;
myVariable.ToString("0,0", System.Globalization.CultureInfo.InvariantCulture).Replace(",", " ") 
```

如果 myVariable 包含 12500，它将显示：12 500。这正是我想要的。

但是，如果 myVariable 包含 0，它将显示：00。我希望显示 0 而不是 00。

我在 MSDN 上查看了自定义数字格式，但没有找到任何可以帮助我的东西。如果可能的话，我希望不能做更多的字符串管理（替换等）。只需将格式从 0,0 切换到适合我的格式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T22:51:40.967

我怀疑你想要：

```
myVariable.ToString("#,0", ...) 
```

虽然如果其中一种标准字符串格式不能处理这个问题，我会感到惊讶。例如，您可以使用：

```
myVariable.ToString("N0", ...) 
```

另请注意，您可以使用“”来创建自己的文化（可能基于不变的文化），而不是使用不变的文化然后用空格替换逗号[`NumberGroupSeparator`](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.numbergroupseparator.aspx)。

示例代码：

```
// You don't need to create this every time. Create it once and put it in a static variable.
var culture = (CultureInfo) CultureInfo.InvariantCulture.Clone();
culture.NumberFormat.NumberGroupSeparator = " ";

Console.WriteLine(12345.ToString("N0", culture)); // 12 345 
```

# c - 中断处理程序声明：armcc vs gcc

> ID：15283302
> 
> 赞同：0
> 
> 时间：2013-03-07T22:47:11.467
> 
> 标签：c, gcc, embedded, interrupt-handling, armcc

我想声明一个中断例程函数。

最初为 armcc 编写为：

```
extern "C" __irq void System_FiqDispatcher() SECTION_SRAM_2; 
```

我写的是一样的：

```
extern "C" __attribute__ (( interrupt("IRQ"))) void System_FiqDispatcher() SECTION_SRAM_2; 
```

我收到以下错误：`line XXX : Error: #1207-D: attribute "interrupt" ignored.` 可能是什么问题？

# c# - 我应该报告什么来报告后台工作人员 DoWork 事件的进度？

> ID：15283307
> 
> 赞同：0
> 
> 时间：2013-03-07T22:47:40.127
> 
> 标签：c#

这是代码：

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
        {
            BackgroundWorker worker = sender as BackgroundWorker;
            while (true)
            {

                if ((worker.CancellationPending == true))
                {
                    e.Cancel = true;
                    break;
                }
                else
                {
                    if (tempCpuValue >= (float?)nud1.Value || tempGpuValue >= (float?)nud1.Value)
                    {
                        soundPlay = true;
                        blinking_label();
                        NudgeMe();
                    }
                    else
                    {
                        soundPlay = false;
                        stop_alarm = true;

                    }
                    backgroundWorker1.ReportProgress(
                }
            }
        } 
```

我应该在这里放置或使用什么：（`backgroundWorker1.ReportProgress`我没有任何进度条或其他东西。我该怎么做？

之前的 DoWork 事件是这样的：

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
        {
            BackgroundWorker worker = sender as BackgroundWorker;
            while (true)
            {

                if ((worker.CancellationPending == true))
                {
                    e.Cancel = true;
                    break;
                }
                else
                {
                    if (tempCpuValue >= (float?)nud1.Value || tempGpuValue >= (float?)nud1.Value)
                    {
                        soundPlay = true;
                        blinking_label();
                        NudgeMe();
                    }
                    else
                    {
                        soundPlay = false;
                        stop_alarm = true;

                    }
                    cpuView();
                    gpuView();
                    //Thread.Sleep(1000);
                }
            }
        } 
```

在 cpuView() 里面我有：

```
this.Invoke(new Action(() =>
                                {
                                    data = new List<string>();
                                    data.Add("Gpu Temeprature --- " + sensor.Value.ToString());
                                    listBox1.DataSource = null;
                                    listBox1.DataSource = data;
                                    listBox1.Invalidate();
                                })); 
```

所以我认为正确的方法是使用进度报告并在进度报告事件中使用此 listBox 更新。而不是在 DoWork 事件中调用 cpuView 和 gpuView。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T22:58:06.703

```
 blinking_label(); 
```

您不能闪烁后台工作人员的标签。所以最好使用 ReportProgress() 来运行使标签闪烁的代码。该方法不仅对报告进度有用，它还具有在 UI 线程上运行代码的通用能力。

您确实需要做一些事情来避免一遍又一遍地眨眼和轻推，例如睡一会儿。你不能让 Sleep() 调用被注释掉。这段代码非常适合 Timer 的 Elapsed 事件处理程序而不是工作程序。这也将确保您使用用于更有效地运行此代码的线程池线程。然后使用 Control.BeginInvoke() 在 UI 线程上运行代码。

此外，由于获取 cpu 温度应该非常便宜，因此您很可能根本不需要线程池线程。这允许使用常规的 winforms Timer，现在一切都变得简单了。

# c# - 调用方法创建多个动态表单控件

> ID：15283310
> 
> 赞同：0
> 
> 时间：2013-03-07T22:47:54.730
> 
> 标签：c#, winforms

我有这个在表单上生成面板的方法：

```
private void createPanels(int spacing)
        {
            pnl1.Location = new Point(0, spacing);
            pnl1.BorderStyle = BorderStyle.FixedSingle;
            pnl1.Size = new Size(100, 93);
            tabRotaBuild.Controls.Add( pnl1);

        } 
```

然后我在表单加载中调用此方法：

```
 private void Form1_Load(object sender, EventArgs e)
    {
        createPanels(60);            
    } 
```

我接下来要做的是在它下面再次显示这个面板（一个新面板），而不清除现有的面板。我有一个按钮，单击时会生成新面板，但是当我单击它时，现有面板会在显示新面板时消失。

这是按钮背后的代码：

```
int s = 0;
        private void button1_Click(object sender, EventArgs e)
        {
            s += 100;
            createPanels(s);

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T22:52:09.560

检查方法，您只是更改现有的位置，`Panel`而 Control.Add 方法正在`Parent`再次设置属性，`BorderStyle`并且`Size` 已经设置为相同的值：

```
private void createPanels(int spacing)
        {
            pnl1.Location = new Point(0, spacing); //notice here
            pnl1.BorderStyle = BorderStyle.FixedSingle;
            pnl1.Size = new Size(100, 93);
            tabRotaBuild.Controls.Add( pnl1);

        } 
```

您需要在您的方法中创建新的`Panel` 添加`pnl1 = new Panel();`

```
private void createPanels(int spacing)
    {
        pnl1 = new Panel();
        pnl1.Location = new Point(0, spacing);
        pnl1.BorderStyle = BorderStyle.FixedSingle;
        pnl1.Size = new Size(100, 93);
        tabRotaBuild.Controls.Add( pnl1);

    } 
```

或者您可以在方法中声明并实例化新面板

```
Panel panel = new Panel(); 
```

请注意，您不会在添加的面板上获得参考。您可以将每个引用添加到`List<Panel>`方法外部声明的或类似的东西。

# scala - OCaml、Scala 和 Go 的结构类型实现

> ID：15283319
> 
> 赞同：10
> 
> 时间：2013-03-07T22:48:55.213
> 
> 标签：scala, types, go, ocaml, structural-typing

在研究结构类型时，我发现以下帖子描述[了 Go 中的接口如何在运行时转换为方法查找表](http://research.swtch.com/interfaces)。这篇文章中描述的过程似乎与为 Scala 的可选结构类型系统和 Java 语言的 White Oak 扩展描述的[反射和生成技术](http://infoscience.epfl.ch/record/138931/files/2009_structural.pdf)大不相同。

是否有任何深入的资源讨论如何在 OCaml 中实现结构类型？我对与标称类型系统进行优化或运行时性能比较的任何讨论特别感兴趣。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T07:28:15.727

您可以在Jake Donham的[这篇博](http://ambassadortothecomputers.blogspot.fr/2010/03/inside-ocaml-objects.html)文中找到关于 OCaml 对象内部的相当详细的描述。它的要点是对象支持主要是作为[一个内部库](https://github.com/ocaml/ocaml/blob/trunk/stdlib/camlinternalOO.ml)实现的，编译器本身只有一点逻辑（当然还有类型系统中的对象类型逻辑），主要是围绕有效的消息分发。

我不是这部分语言的专家，但经过粗略检查后，看起来 OCaml 依赖于排序方法类型中的方法查找（解析为方法表中的槽），并缓存最后调用的方法，和静态已知调用的优化，特别是方法实现中的自调用。最后，一些常用的函数（例如实例变量 getter 和 setter）被识别和编码（内部 OO 库中的[impl类型），以提高性能，并且可能更重要的是减少代码大小。](https://github.com/ocaml/ocaml/blob/trunk/stdlib/camlinternalOO.ml#L498)

# session - 如何使用 django-tastypie 获取当前登录的用户资源

> ID：15283324
> 
> 赞同：0
> 
> 时间：2013-03-07T22:49:04.060
> 
> 标签：session, backbone.js, tastypie

我正在使用带有 django 的主干.js，我想在对我的应用程序的初始请求之后立即`/`获取当前登录的用户。

我确实有一个`UserResource`设置，所以我可以进行 api 调用`api/v1/user/id`，但这意味着我必须知道`id`我正在寻找的我不知道。在传统的 django 请求视图中，我将拥有该`request.user`对象。我在客户端也可以使用它吗？如果没有，我该如何拨打电话`request.user`？

编辑：

由于我在 Django 中使用传统身份验证，并且在授权用户之后，主干从那里开始。我可以在我的 base.html 文件中创建一个变量来存储当前登录用户的唯一 ID，如下所示：

```
var user = {{user}}; // which shows the username 
```

这有什么风险吗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T01:37:01.333

查看 TastyPie Cookbook 中的“创建每个用户资源”示例

[http://django-tastypie.readthedocs.org/en/latest/cookbook.html#creating-per-user-resources](http://django-tastypie.readthedocs.org/en/latest/cookbook.html#creating-per-user-resources)

但是，文档已过时，并且 API 已更改。方法签名已更改，请求现在是捆绑包的一个属性。

def authorized_read_list(self, object_list, bundle):

您可以从`bundle.request.user`

另见[https://github.com/toastdriven/django-tastypie/issues/809](https://github.com/toastdriven/django-tastypie/issues/809)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T09:10:06.277

以下会将用户 ID 放在响应的元数据中：

```
def alter_list_data_to_serialize(self, request, data_dict):
    if isinstance(data_dict, dict):
        if 'meta' in data_dict:
            if request.user and request.user.pk:
                data_dict['meta']['user_id'] = request.user.pk

    return data_dict 
```

就个人而言，我从来没有需要这样做。我将用户对象放入页面上下文服务器端。即使对于单页 RESTful 应用程序，我也会在登录时发出标准请求/响应（不是 AJAX），并填充内容/上下文服务器端。

任何后续的 AJAX 请求**都不应**包含用户 ID，就像不应在 URL 中传递用户 ID 一样。您应该在服务器端识别用户并进行相应的过滤。Django 使这变得非常容易，使用 AuthenticationMiddleware 向用户公开。

# mysql - MySQL查询可以将时间+用户数据汇总为时间x用户报告吗？

> ID：15283327
> 
> 赞同：1
> 
> 时间：2013-03-07T22:49:09.517
> 
> 标签：mysql, sql, multidimensional-array, report, pivot

我有一个 MySQL 表，它具有以下记录用户活动的模式：

```
TABLE Activity:
id      INT AUTOINCREMENT  // the primary key
ts      TIMESTAMP          // similar to DATETIME
user    INT                // a unique ID for each user
action  INT                // action code 
```

每次用户执行操作时，都会在此表中添加一行。我现在要做的是生成一份总结每天总用户活动的报告。例如，它看起来像这样：

```
Date       | User 1 | User 2 | User 3
--------------------------------------
2013-03-05 |     12 |     34 |     56
2013-03-06 |     78 |     87 |     65
2013-03-07 |     43 |     21 |     12 
```

在这个例子中，用户 1 在 3 月 6 日做了 78 次操作，在 3 月 7 日做了 43 次操作，而用户 3 在 3 月 5 日做了 56 次操作。此时我不在乎某一天做了什么样的操作，只要特定用户执行的所有操作的总数。

现在编写一个 MySQL 查询将活动表中的条目汇总为单个用户的天数相对简单，我可以依次为每个用户运行这样的查询（尽管每个结果集中的天数列可能不会完全对齐）。有没有办法在一个查询中自动为所有用户执行此操作？

我认为这可能有点奇怪，因为结果中的列数可能会根据感兴趣的日期范围内有多少用户处于活动状态而有所不同。换句话说，报表中的列数可能少于数据库中的用户数。

本质上，与其让 MySQL 生成一维记录数组作为其输出，我希望它生成一个二维值数组，其中行和列的标签来自活动表。这甚至可能吗？

我想我总是可以浏览表中的原始数据并自己构建一个适当的二维数组（我将使用 PHP），但我想知道 MySQL 是否可以为我做这件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:06:16.350

枢轴（您正在尝试做的事情的技术术语）通常不值得麻烦。如果您只需要获取少数用户的数据，那很好，但如果您需要能够获取动态用户列表的数据，那么您最好执行按以下方式分组的单个`ts`查询`user`

```
SELECT DATE(`ts`) AS `Date`, `User`, COUNT(*) AS `Actions`
FROM `Activity`
#WHERE (conditions)
GROUP BY `Date`, `User` 
```

并在 PHP 中创建一个多维数组，如下所示：

```
$result; // result from DB call as an array of objects
$user_actions = array();
foreach($result as $row){
    $user_actions[$row->Date][$row->User] = $row->Actions;
} 
```

# c# - 保持过滤器选择的设计模式

> ID：15283329
> 
> 赞同：2
> 
> 时间：2013-03-07T22:49:15.367
> 
> 标签：c#, asp.net-mvc, design-patterns, session-variables

我想要一些关于解决我遇到的问题的正确设计模式或方法的建议。

基本上，在 MVC3 中，我有一个控制器，它具有多个操作，所有操作都简单地生成表数据。大多数（但不是全部）操作应该有一个可选的年份值，用于根据选定的年份过滤结果。目前，我通过查询字符串接受年份值，但如果未提供（或无效）则默认为当前年份。

我正在考虑创建简单的操作方法，该方法允许用户通过选择列表更改年份，将所选值（和当前页面）发布到将所选年份设置为会话变量（验证后）的操作并重定向用户回到他们所在的页面。然后对于所有后续请求，在控制器构造函数中，我将从会话变量中读取年份并将其存储在一个局部变量中，然后可以在每个操作中使用该局部变量。

但是，我犹豫要不要采用这种方法，因为有很多参考资料（很多在这个网站上）警告在控制器构造函数中使用会话变量。我可以继续在每个方法中将年份作为查询字符串参数传递，但以下是来自一个操作的代码片段，显示了我如何验证今年，​​并且在每个操作中复制它似乎违反了 DRY 原则。关于如何做到这一点的任何建议？

```
public ActionResult FundsAppropriationList(int? year = null)
{
  var fundsAppropriationListModel = new FundsAppropriationListModel(); 
  if (year != null && year >= 2000 && year <= 2099)
  {
    fundsAppropriationListModel.SelectedYear = (int)year;
  }
  else
  {
    fundsAppropriationListModel.SelectedYear = DateTime.Now.Year;
  }
  fundsAppropriationListModel.AvailableYearsList = new SelectList(_grantReviewServices.GetYearsForWhichReviewsExist().Select(x => new {value = x, text = x}), "value", "text");
  //... Remainder of model population here...
  return PartialView("_FundsAppropriationList", fundsAppropriationListModel);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T01:20:00.683

为什么您必须在每个操作中复制该代码？你不能把重复的代码封装到它自己的方法中吗？像这样的东西：

```
public ActionResult FundsAppropriationList(int? year = null)
{
  var fundsAppropriationListModel = new FundsAppropriationListModel(); 

  fundsAppropriationListModel.SelectedYear = AssignYear(year);

  fundsAppropriationListModel.AvailableYearsList = new SelectList(_grantReviewServices.GetYearsForWhichReviewsExist().Select(x => new {value = x, text = x}), "value", "text");
  //... Remainder of model population here...
  return PartialView("_FundsAppropriationList", fundsAppropriationListModel);
} 
```

“重复”代码：

```
internal static int AssignYear(int? year = null)
{
  if (year != null && year >= 2000 && year <= 2099)
  {
    return (int)year;
  }

  return DateTime.Now.Year;
} 
```

# jquery - jQuery动态设置对象的位置？

> ID：15283331
> 
> 赞同：1
> 
> 时间：2013-03-07T22:49:24.757
> 
> 标签：jquery, css, position, css-position

好的，所以我有一个奇怪的困境。当我得到一个元素的位置并输出它时，我实际上得到了对象的真实坐标。像下面这样：

```
var el = $('#element');

var position = el.position();

console.log(position); 
```

给出的输出类似于：

```
Object { top=0, left=120} 
```

效果很好，但是现在如果我将对象设置为**position:absolute**，我会得到一个奇怪的输出。下面的代码是我正在做的一个例子。

```
var el = $('#element');

var position = el.position();

el.css({
    top: position.top + 'px',
    left: position.left + 'px',
    position: 'absolute'
});

console.log(position); 
```

现在我得到的输出类似于下面的输出。

```
Object { top=0, left=0} 
```

所以似乎**position:absolute**正在重置顶部和左侧。

我的问题是......如何设置对象的左侧和顶部位置，同时通过 jQuery将其设置为**position:absolute ？**

[http://jsfiddle.net/sbe3C/2/](http://jsfiddle.net/sbe3C/2/)

更新 2：好的，正如我在下面评论的那样，问题似乎只有在我尝试将绝对位置设置为 each() 循环内的对象时才会发生。我在下面有一个 jsfiddle 示例。

[http://jsfiddle.net/geocalleo/atNFz/](http://jsfiddle.net/geocalleo/atNFz/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T20:57:26.483

我想到了！问题是我需要从下到上迭代项目。我从[StackOverflow 上的另一个问题中](https://stackoverflow.com/a/10477469/2146361)得到了答案。

所以它现在看起来像这样

```
$($('body > div').get().reverse()).each 
```

查看[jsFiddle](http://jsfiddle.net/geocalleo/atNFz/3/)。

# git - Git apply 不会创建新文件？

> ID：15283332
> 
> 赞同：13
> 
> 时间：2013-03-07T22:49:27.113
> 
> 标签：git, diff

我正在尝试通过它创建`diff`补丁`apply`。我的补丁有新文件并且在`apply`我收到错误之后。

```
git diff master origin/master > patch1.diff
git apply patch1.diff -v

Checking patch test3...
error: test3: No such file or directory 
```

修补：

```
diff --git a/test3 b/test3
deleted file mode 100644
index df6b0d2..0000000
--- a/test3
+++ /dev/null
@@ -1 +0,0 @@
-test3 
```

我做错了什么或`git apply`没有创建新文件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-07T22:55:11.610

您正在向后创建补丁 - 该补丁正在尝试*删除*该文件。我想你想要：

```
git diff origin/master master > patch1.diff 
```

您可能会发现`git format-patch`对您有所帮助。如果您当前已`master`签出，则可以执行以下操作：

```
git format-patch origin/master 
```

该命令将产生一堆补丁文件，每个提交在您的分支和`origin/master`. 然后，您可以应用这些使用`git am`并保留所有额外数据，例如提交消息和作者信息。

# opencv - OpenCV 2.4.3 PCA 类 - 当样本数小于维数时

> ID：15283338
> 
> 赞同：0
> 
> 时间：2013-03-07T22:49:55.390
> 
> 标签：opencv, pca

我正在尝试使用 OpenCv 中的 PCA 类在我的 C++ 应用程序中执行主成分分析操作。我是 OpenCV 的新手，我遇到了问题，所以我希望有人能提供帮助。

当我使用 2*10 数据数组和参数时，我正在 Matlab 和 PCA 类上尝试一个演示示例来检查答案`(CV_PCA_DATA_AS_COL)`，这里我有两个维度，所以我希望每个都有 2 个特征向量有 2 个元素，这和 Matlab 的结果一样好。

但是在使用 10*2 数据数组时（通常当样本数小于维数时），我得到 (2*10) 特征向量数组。即：10 个特征向量，每个特征向量有 2 个元素。这不是预期的，也不是 Matlab 给出的结果（Matlab 给出 10*10 的特征向量矩阵）。

我不知道为什么我会得到这些结果，因此我无法将数据投影到我的应用程序的主要组件上，有什么帮助吗？

PS：我使用的代码：

```
Mat Mean ;
Mat H(10, 2, CV_32F); // then the matrix is filled by data
    PCA pca(H,Mean,CV_PCA_DATA_AS_COL,0) ;
pca.operator()(H,Mean,CV_PCA_DATA_AS_COL,0) ;
    cout<<pca.eigenvectors.rows // gives 2 instead of 10
    cout<<pca.eigenvectors.cols // gives 10 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-21T10:59:42.077

我会这样说：

**如果样本数量小于数据维度，则保留组件的数量将被限制在样本数量上。**

我们为 uni 的力学科目做了 3x3 PCA，一些非线性控制算法也使用了类似的方法——我的记忆模糊不清，但它可能与关于伪逆和非方阵的假设有关......

一旦你深入研究了这个理论——网络搜索“样本少于维度的 pca”——它很快就会变得一团糟！

# php - 编写一个打开网站页面并将页面内容存储在变量中的 PHP 脚本

> ID：15283341
> 
> 赞同：2
> 
> 时间：2013-03-07T22:50:13.337
> 
> 标签：php, web-crawler

我一直在构建一个搜索引擎，但现在我需要一个可以在 PHP 中抓取我的网站以获取其内容的网络爬虫。

我不知道网络爬虫/蜘蛛是否是正确的词，但我希望并想知道是否有人可以帮助我编写一个简单的 PHP 脚本，打开以 .php 或 .html 结尾的域中的所有页面并获取内容在页面中并将其作为原始文本存储在变量中。每页一个变量。

如果有人知道一个好的开源脚本可以做到这一点或可以帮助我编写一个，请分享或这样做 - 我将非常感谢所有和任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:08:25.727

查看[http://sourceforge.net/projects/php-crawler/](http://sourceforge.net/projects/php-crawler/)

或者试试这个简单的代码来搜索是否存在 Google Analytics 跟踪代码：

```
// Disable time limit to keep the script running
set_time_limit(0);
// Domain to start crawling
$domain = "http://webdevwonders.com";
// Content to search for existence
$content = "google-analytics.com/ga.js";
// Tag in which you look for the content
$content_tag = "script";
// Name of the output file
$output_file = "analytics_domains.txt";
// Maximum urls to check
$max_urls_to_check = 100;
$rounds = 0;
// Array to hold all domains to check
$domain_stack = array();
// Maximum size of domain stack
$max_size_domain_stack = 1000;
// Hash to hold all domains already checked
$checked_domains = array();

// Loop through the domains as long as domains are available in the stack
// and the maximum number of urls to check is not reached
while ($domain != "" && $rounds < $max_urls_to_check) {
    $doc = new DOMDocument();

    // Get the sourcecode of the domain
    @$doc->loadHTMLFile($domain);
    $found = false;

    // Loop through each found tag of the specified type in the dom
    // and search for the specified content
    foreach($doc->getElementsByTagName($content_tag) as $tag) {
        if (strpos($tag->nodeValue, $content)) {
            $found = true;
            break;
        }
    }

    // Add the domain to the checked domains hash
    $checked_domains[$domain] = $found;
    // Loop through each "a"-tag in the dom
    // and add its href domain to the domain stack if it is not an internal link
    foreach($doc->getElementsByTagName('a') as $link) {
        $href = $link->getAttribute('href');
        if (strpos($href, 'http://') !== false && strpos($href, $domain) === false) {
            $href_array = explode("/", $href);
            // Keep the domain stack to the predefined max of domains
            // and only push domains to the stack that have not been checked yet
            if (count($domain_stack) < $max_size_domain_stack &&
                $checked_domains["http://".$href_array[2]] === null) {
                array_push($domain_stack, "http://".$href_array[2]);
            }
        };
    }

    // Remove all duplicate urls from stack
    $domain_stack = array_unique($domain_stack);
    $domain = $domain_stack[0];
    // Remove the assigned domain from domain stack
    unset($domain_stack[0]);
    // Reorder the domain stack
    $domain_stack = array_values($domain_stack);
    $rounds++;
}

$found_domains = "";
// Add all domains where the specified search string
// has been found to the found domains string
foreach ($checked_domains as $key => $value) {
    if ($value) {
        $found_domains .= $key."\n";
    }
}

// Write found domains string to specified output file
file_put_contents($output_file, $found_domains); 
```

我在[这里](http://webdevwonders.com/simple-php-crawler-example/)找到了。

# spring - 在 Spring MVC 3.1 控制器的处理程序方法中直接流到响应输出流

> ID：15283347
> 
> 赞同：24
> 
> 时间：2013-03-07T22:50:34.023
> 
> 标签：spring, spring-mvc, httpresponse

我有一个处理 ajax 调用并返回 JSON 的控制器方法。我正在使用来自 json.org 的 JSON 库来创建 JSON。

我可以执行以下操作：

```
@RequestMapping(method = RequestMethod.POST)
@ResponseBody
public String getJson()
{
    JSONObject rootJson = new JSONObject();

    // Populate JSON

    return rootJson.toString();
} 
```

但是将 JSON 字符串放在一起是低效的，只是让 Spring 将其写入响应的输出流。

相反，我可以将其直接写入响应输出流，如下所示：

```
@RequestMapping(method = RequestMethod.POST)
public void getJson(HttpServletResponse response)
{
    JSONObject rootJson = new JSONObject();

    // Populate JSON

    rootJson.write(response.getWriter());
} 
```

但似乎有更好的方法来做到这一点，而不是不得不求助于传递`HttpServletResponse`到处理程序方法。

是否有另一个可以从我可以使用的处理程序方法返回的类或接口以及`@ResponseBody`注释？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-08T07:50:51.340

您可以将输出流或写入器作为控制器方法的参数。

```
@RequestMapping(method = RequestMethod.POST)
public void getJson(Writer responseWriter) {
    JSONObject rootJson = new JSONObject();
    rootJson.write(responseWriter);
} 
```

@see [Spring 参考文档 3.1 第 16.3.3.1 章支持的方法参数类型](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-arguments)

ps 我觉得在测试中使用`OutputStream`or`Writer`作为参数仍然比 a `HttpServletResponse`- 更容易使用，感谢您关注[我所写](https://stackoverflow.com/a/13120104/280244)的内容;-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-04T03:21:41.167

最后，我为此写了一篇`HttpMessageConverter`。有了它，我可以做到以下几点：

```
@RequestMapping(method = RequestMethod.POST)
@ResponseBody
public JSONObject getJson()
    throws JSONException
{
    JSONObject rootJson = new JSONObject();

    // Populate JSON

    return rootJson;
} 
```

这是我的`HttpMessageConverter`课：

```
package com.example;

import java.io.IOException;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.nio.charset.Charset;
import org.json.JSONException;
import org.json.JSONObject;
import org.springframework.http.HttpInputMessage;
import org.springframework.http.HttpMessage;
import org.springframework.http.HttpOutputMessage;
import org.springframework.http.MediaType;
import org.springframework.http.converter.AbstractHttpMessageConverter;
import org.springframework.http.converter.HttpMessageNotReadableException;
import org.springframework.http.converter.HttpMessageNotWritableException;

public class JsonObjectHttpMessageConverter
    extends AbstractHttpMessageConverter<JSONObject>
{
    private static final Charset DEFAULT_CHARSET = Charset.forName("UTF-8");

    public JsonObjectHttpMessageConverter()
    {
        super(new MediaType("application", "json"), new MediaType("text", "javascript"));
    }

    @Override
    protected boolean supports(Class<?> clazz)
    {
        return JSONObject.class.equals(clazz);
    }

    @Override
    protected JSONObject readInternal(Class<? extends JSONObject> clazz,
                                      HttpInputMessage            inputMessage)
        throws IOException,
               HttpMessageNotReadableException
    {
        throw new UnsupportedOperationException();
    }

    @Override
    protected void writeInternal(JSONObject        jsonObject,
                                 HttpOutputMessage outputMessage)
        throws IOException,
               HttpMessageNotWritableException
    {
        PrintWriter writer = new PrintWriter(new OutputStreamWriter(outputMessage.getBody(),
                                                                    getContentTypeCharset(outputMessage)));

        try
        {
            jsonObject.write(writer);
            writer.flush();
        }
        catch (JSONException e)
        {
            throw new HttpMessageNotWritableException(e.getMessage(), e);
        }
    }

    private Charset getContentTypeCharset(HttpMessage message)
    {
        MediaType contentType = message.getHeaders().getContentType();

        Charset charset = (contentType != null) ? contentType.getCharSet() : null;

        return (charset != null) ? charset : DEFAULT_CHARSET;
    }
} 
```

`HttpMessageConverter`必须在 Spring 中注册。这可以在这样的`dispatcher-servlet.xml`文件中完成：

```
<beans ...>

    ...    

    <mvc:annotation-driven conversion-service="conversionService" validator="validator">
        <mvc:argument-resolvers>
            ...
        </mvc:argument-resolvers>
        <mvc:message-converters>
            <bean class="org.springframework.http.converter.StringHttpMessageConverter">
                <property name="supportedMediaTypes">
                    <list>
                        <value>text/plain;charset=UTF-8</value>
                        <value>application/json;charset=UTF-8</value>
                        <value>*/*</value>
                    </list>
                </property>
                <property name="writeAcceptCharset" value="false" />
            </bean>
            <bean class="com.example.JsonObjectHttpMessageConverter" />
            <bean class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
                <property name="objectMapper" ref="jacksonObjectMapper" />
            </bean>
        </mvc:message-converters>
    </mvc:annotation-driven>

    ...

</beans> 
```

如您所见，我也`HttpMessageConverter`注册了其他对象。顺序确实很重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-10-21T09:56:29.480

请注意，如果您使用 OutputStream 或 Writer，则需要您自己编写标头。

一种解决方法是使用 InputStreamResource/ResourceHttpMessageConverter

# oracle - SQL Loader - 如何转义终止字符

> ID：15283348
> 
> 赞同：2
> 
> 时间：2013-03-07T22:50:34.517
> 
> 标签：oracle, sql-loader

朋友们，

我有一个客户数据发送给我，要求将字段以“|”终止

问题是，一些字段值也有“|” 作为我们需要保留的性格。

我的数据文件中的问题行看起来像这样（地址“1 | 34-36 ...”中的“|”是问题）

```
 ID  |   Address                |UPDATEDATE
  1423  |   1|34-36 White Street   |02/01/199 
```

我的 .ctl 看起来像这样

```
options(errors=1000)
load data
into table client_address APPEND
fields terminated by '|'
TRAILING NULLCOLS
(
ID          INTEGER EXTERNAL, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:51:15.390

如果数据文件中的所有字段都是宽度对齐的，您可以使用这个 .ctl 文件：

```
load data
into table client_address APPEND
fields terminated by '~'
TRAILING NULLCOLS
(
line         BOUNDFILLER,
ID           "to_number(trim(substr(:line,1,8)))",
Address      "trim(substr(:line,10,26))",
UPDATEDATE   "to_date(trim(substr(:line,37)),'mm/dd/yyyy')"
) 
```

* * *

**编辑：**
如果字段不是宽度对齐的，而是`Address`唯一可以包含`'|'`char 的字段，那么使用这个 .ctl 文件

```
load data
into table client_address APPEND
fields terminated by '~'
TRAILING NULLCOLS
(
line         BOUNDFILLER,
ID           "to_number(trim(regexp_substr(:line,'^[^|]*')))",
Address      "trim(regexp_replace(:line,'^[^|]*\|(.*)\|[^|]*$','\1'))",
UPDATEDATE   "to_date(trim(regexp_substr(:line,'[^|]*$')),'mm/dd/yyyy')"
) 
```

# ruby - Ruby CSV 输入值格式

> ID：15283350
> 
> 赞同：0
> 
> 时间：2013-03-07T22:50:41.997
> 
> 标签：ruby, csv

我正在使用 ruby​​ CSV 模块读取 csv 文件。

csv 文件中的值之一的格式是 XXX_XXXXX，其中 X 是数字。实际上，我将此值视为字符串，但 CSV 模块将这些值读取为 XXXXXXXX，作为数字，这是我不想要的。

我目前使用的选项

```
f = CSV.read('file.csv', {:headers => true, :header_converters => :symbol, :converters => :all} ) 
```

有没有办法告诉 CSV 不要那样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:06:33.293

f = CSV.read('file.csv', {:headers => true, :header_converters => :symbol)}

省略`:converters => :all`; 尝试（除其他外）将所有具有数字外观的字符串转换为数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:14:15.760

:convertors => all 会导致这种情况，请尝试以下操作

```
require "csv"

CSV.parse(DATA, :col_sep => ",", :headers => true, :converters => :all).each do |row|
  puts row["numfield"]
end
__END__
textfield,datetimefield,numfield
foo,2008-07-01 17:50:55.004688,123_45678
bar,2008-07-02 17:50:55.004688,234_56789

# gives
# 12345678
# 23456789 
```

和

```
CSV.parse(DATA, :col_sep => ",", :headers => true).each do |row|
  puts row["numfield"]
end

__END__
textfield,datetimefield,numfield
foo,2008-07-01 17:50:55.004688,123_45678
bar,2008-07-02 17:50:55.004688,234_56789

# gives
# 123_45678
# 234_56789 
```

# php - HTML_quickform2 javascript

> ID：15283355
> 
> 赞同：0
> 
> 时间：2013-03-07T22:51:01.997
> 
> 标签：php, javascript, pear, quickform

我无法让客户端部分正常工作。我遇到的第一个问题是，它只加载 quickform.js 脚本，而不是其他 2。所以我现在将它们加载到头部。但我的问题仍然是表单只验证客户端。我觉得我错过了一些明显的东西？

```
require_once('HTML/QuickForm2.php');
require_once ('HTML/QuickForm2/Renderer.php');
require_once ('HTML/QuickForm2/JavascriptBuilder.php');

$form = new HTML_QuickForm2('uploads');
$fieldset = $form->addElement('fieldset');
$name = $fieldset->addElement('text', 'name', array('size' => 50, 'maxlength' => 255))->setLabel('Enter your name:');
$fieldset->addElement('submit', null, array('value' => 'Send!'));
$name->addFilter('trim');
$name->addRule('required', 'Please enter your name');
if ($form->validate()) {
echo '<h1>Hello, ' . htmlspecialchars($name->getValue()) . '!</h1>';
exit;
}
$renderer = HTML_QuickForm2_Renderer::factory('default');
$renderer->setJavascriptBuilder(new HTML_QuickForm2_JavascriptBuilder('js/quickform2'));
$form->render($renderer);
foreach ($renderer->getJavascriptBuilder()->getLibraries() as $link) {
echo $link . "\n";
}
echo $renderer; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T08:02:32.700

使用 JavascriptBuilder 的要点是仅在需要时才加载库，因此“其他 2”只会在您使用相应的元素（hierselect 和重复）时加载。

至于“仅验证客户端”，您可能是指“服务器端”，并且您缺少 addRule() 的参数：

```
$name->addRule('required', 'Please enter your name', null, HTML_QuickForm2_Rule::CLIENT_SERVER); 
```

# python - 用于制作、插入行和检索查询的类

> ID：15283361
> 
> 赞同：-3
> 
> 时间：2013-03-07T22:51:26.800
> 
> 标签：python, sqlite

我试图模仿集体智能的代码之一，但由于一些未知的错误而跌跌撞撞。除了用于检索查询的方法外，所有方法在类中都可以正常工作。

```
class Connect:
  # Create the Database
    def __init__(self,dbname):
        self.con = sqlite3.connect(dbname)
  # Add the row
    def create(self,date,name,age):
        self.con.execute('create table Profile(date text, name text,age real)')
  # Lock the changes
    def commit(self):
        self.con.commit()
  # Retrive the details
    def getentry(self,table,field,value):
        cursor = self.con.execute(
                     "select * from %s where %s = '%s'" % (table,field,value))
        result_set = cursor.fetchall()
        print result_set 
```

工作示例：

1.  创建数据库

C = 连接（'test.db'）

1.  添加行

C.create('2013-03-06','Joy',34)

1.  进行更改并锁定文件

C.commit()

1.  获取行

C.getentry(个人资料,姓名,'Joy')

错误：**NameError：未定义名称“配置文件”**

然后加上括号。

C.getentry('个人资料','姓名','Joy')

结果 = [ ]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:37:09.793

问题出在`Connect.create`. 它创建表但不填充它，因为其定义上方的注释似乎暗示。您需要将其更新为以下内容：

```
def create(self,date,name,age):
    self.con.execute( 'create table Profile(date text, name text,age real)' )
    self.con.execute( "insert into Profile values('{0}','{1}','{2}')"
                      .format(date,name,age) )
    return 
```

# javascript - img 和 XMLHttpRequest 有什么区别？

> ID：15283369
> 
> 赞同：0
> 
> 时间：2013-03-07T22:51:43.087
> 
> 标签：javascript, cors

我目前正在与 CORS 作斗争。我想请求一张根据请求生成的图片（例如来自 WMS 的地图）。

如果图片加载了`img`标签，则图片显示正确。但是，当我尝试使用 a 获取图片时`XMLHttpRequest`，结果是：

```
XMLHttpRequest cannot load http://vmap0.tiles.osgeo.org/wms/vmap0?[...].
Origin http://fiddle.jshell.net is not allowed by Access-Control-Allow-Origin. 
```

[你可以在jsfiddle](http://jsfiddle.net/QJ67M/)上找到一个简单的例子。

**这两种方法有什么区别？**

我想使用`XMLHttpRequest`，因为请求的图片将成为 WebGL 应用程序的纹理。

* * *

## 回答 #1

> 赞同：-4
> 
> 时间：2013-03-07T22:58:08.093

XMLHttpRequest 用于加载数据。

IMG 用于加载图像。

有什么好难理解的。

> [XMLHttpRequest 对象用于在后台与服务器交换数据。](http://www.w3schools.com/xml/xml_http.asp)

至于 Access-Control-Allow-Origin[规范](http://www.w3.org/TR/cors/#access-control-allow-origin-response-header)声明您必须让服务器检查来自客户端的 Origin 标头并将来源作为 Access-Control-Allow-Origin

# java - 主线程调用另一个线程的方法 - 这里到底发生了什么？

> ID：15283372
> 
> 赞同：-4
> 
> 时间：2013-03-07T22:51:49.873
> 
> 标签：java, android, multithreading

当主用户线程像这样在另一个线程中调用一系列方法时，我有点困惑

在主线程中：

```
otherThread.callMethod();
otherThread.callMethod();
otherThread.callMethod();
otherThread.callMethod();
otherThread.callMethod();
otherThread.callMethod();
otherThread.callMethod(); 
```

而`callMethod`在另一个线程中，正在像这样从套接字写入和读取：

```
mmOutStream.write(buffer);
mmOutStream.flush();
while (!finished) {
   if (mmInStream.available() > 0)
   if ((char) (c = (byte) mmInStream.read()) != 'x') {
      responseBuffer[responseBufferLen++] = c;
     } else {
      finished = true;
    }
} 
```

这显然是一个阻塞场景——但是虽然这些方法是按顺序调用的，但主用户线程并没有被阻塞。

我的意思是在所有按钮仍然有反应的情况下被阻止，用户可以毫无延迟地与屏幕进行交互。怎么可能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T22:57:42.640

不在线程上调用方法。它们被调用对象（或类，用于静态方法）。一个对象可以是 type `Thread`，但是在一个 type 的对象上`Thread`调用一个方法与在任何其他类型的对象上调用一个方法是完全一样的。该方法仍然由当前线程执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T22:58:15.503

线程没有方法。类有方法和实例。代码通过对象调用实例方法。这一切都在当前线程中执行。对象是线程这一事实没有任何区别。

# javascript - 用星号javascript/jquery替换数字？

> ID：15283374
> 
> 赞同：0
> 
> 时间：2013-03-07T22:51:53.160
> 
> 标签：javascript, replace, innerhtml

如何用 javascript/jquery 替换 span 元素中的文本或数字？这是我尝试过的，但控制台说“无法调用未定义的方法'替换'”不明白是什么问题，有人能指出我正确的方向吗？

```
 function changeNumber()
{
    var element = document.getElementsByClassName("grade").innerHTML; 
    var x = element.replace('1','*');
    document.getElementsByClassName("grade").innerHTML=x;
} 
```

如果我在javascript中动态创建的span元素很重要......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T22:52:57.057

`document.getElementsByClassName("grade")`返回一个[NodeList](https://developer.mozilla.org/en-US/docs/DOM/NodeList)，它不像`getElementbyId`，你需要循环它。

如果你只有一个

```
function changeNumber()
{
    var element= document.getElementsByClassName("grade")[0];
    var text = element.innerHTML; 
    var x = text.replace('1','*');
    element.innerHTML=x;
} 
```

如果你有一套

```
function changeNumber()
{
    var elements= document.getElementsByClassName("grade");
    for (var i=0; i<elements.length; i++) {
        var element = elements[i];
        var text = element.innerHTML; 
        var x = text.replace('1','*');
        element.innerHTML=x;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:58:31.023

如果您的页面中已经包含 jQuery，并且对它的使用感到满意，请尝试以下代码：

```
function changeNumber()
{
    $(".grade").each(function(){
        var self = this
        self.text(self.text().replace('1','*'))
    }); 
} 
```

工作演示：http: [//jsfiddle.net/pratik136/uUHv8/](http://jsfiddle.net/pratik136/uUHv8/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T01:33:45.267

虽然发布的答案是正确的，并且尽管您已经接受了答案，但我对创建一个`replace()`与 a `nodeList`（或者严格来说是 an `Object`）一起使用的函数的可能性很感兴趣，所以：

```
Object.prototype.replace = function (n, r) {
    var textMethod = this[0] && this[0].textContent !== undefined;
    for (var i = 0, len = this.length; i < len; i++) {
        if (textMethod) {
            this[i].textContent = this[i].textContent.replace(n, r);
        } else {
            this[i].innerText = this[i].innerText.replace(n, r);
        }
    }
    return this;
};

document.getElementsByTagName('p').replace(/1/, '*'); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/4jKKb/3/)。

我可以确认这适用于Win XP 下的 Chrome 25、Firefox 19（也是 14 和 18，有一段时间没有更新*这台计算机）。*我无法在 IE 中测试，因为它和 JS Fiddle[似乎有问题](https://stackoverflow.com/questions/15260947/why-jsfiddle-is-not-rendering-at-all-in-ie8-and-older-versions)。

这也可能不是一个好主意。但在我把它放在一起的时候，它似乎很有用（而且相对有趣）。希望它可能会有一些用处。

# java - 多态性：构造函数不接受参数

> ID：15283375
> 
> 赞同：0
> 
> 时间：2013-03-07T22:51:53.470
> 
> 标签：java, constructor, arguments, polymorphism

当我编译这个时，我收到一条错误消息，说 Video 的预期构造函数参数是“无参数”

```
import java.util.*;

abstract class Thing
{

}

class Video extends Thing
{
    String description;
    int price;
    String title;

    void Video ( String d , int p, String t)
    {
        this.description = d;
        this.price = p;
        this.title = t;
    }

    String getDescription()
    {
        return description;
    }
}

class BookOnTape extends Thing
{
    String description;

    void BookOnTape ( String d )
    {
        description = d;
    }

    String getDescription()
    {
        return description;
    }
}

class Funiture extends Thing
{
   String description;

    void Furniture ( String d )
    {
        description = d;
    }

    String getDescription()
    {
        return description;
    }
}

public class Lookup
{
    /*private static HashMap<Thing, Integer> rentalList;

    static
    {
        rentalList = new HashMap<Thing, Integer>();
        rentalList.put( new Video(5), new Integer( 0 ) );
    }*/

    public static void main( String args[] )
    {
        System.out.println("fart");

        Thing farmer = new Video( "fgfg", 5, "gfgf" );
    }
} 
```

当我编译这个：

```
class A
{
}

class B extends A
{
    String name;

    B ( String n )
    {
        this.name = n;
    }
}

class TestPoly
{
    public static void main( String args[] )
    {
        A poly = new B( "test" );
    }
} 
```

它工作正常。我看不出有什么区别。这里有什么问题吗？...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:53:20.047

```
void Video ( String d , int p, String t) 
```

这不是[构造函数](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)。这就是编译器抱怨的原因：它找不到构造函数`Video(String, int, String)`，因为它不在代码中。删除`void`会将其变成一，因为方法需要返回值，而构造函数没有返回值。

一个（更多）信息量更大的讨论在[这里](https://stackoverflow.com/questions/6801500/why-do-constructors-in-java-not-have-a-return-type)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T22:53:29.823

```
void Video ( String d , int p, String t) is a method not a constructor. 
```

> `Constructor's`没有返回类型甚至无效。

现在，这是一个构造函数：

```
 Video ( String d , int p, String t) 
```

# c# - 需要帮助将 C# 转换为 VB

> ID：15283376
> 
> 赞同：6
> 
> 时间：2013-03-07T22:51:53.727
> 
> 标签：c#, vb.net, c#-to-vb.net

我使用了一个工具将 C# 转换为 VB。当我在 VB 中运行程序时，出现以下错误：

> 不能使用具有返回类型的委托类型声明事件。

如何更正此代码？

**C＃：**

```
using System;
[assembly: CLSCompliant(true)]

namespace Link.API
{
  public delegate decimal DecimalStringDelegate(string s);
  public delegate long OrderDelegateStatus(Order o);
  public delegate void LongDelegate(long val);
}

using System;
using System.Collections.Generic;
using System.Text;

namespace Link.API
{
  public interface TLServer
  {
    event LongDelegate newOrderCancelRequest;
    event OrderDelegateStatus newSendOrderRequest;
    string ClientName(int clientnum);
    bool SymbolSubscribed(string sym);

    Basket AllClientBasket { get; }
  }
} 
```

**VB.NET：**

```
Imports System.Text
Imports System.Collections.Generic
Imports System
<Assembly: CLSCompliant(True)>

Namespace Link.API
  Public Delegate Function DecimalStringDelegate(ByVal s As String) As Decimal
  Public Delegate Function OrderDelegateStatus(ByVal o As Order) As Long
  Public Delegate Sub LongDelegate(ByVal val As Long)
End Namespace

Namespace Link.API
  Public Interface Server
    Event newOrderCancelRequest As LongDelegate
    Event newSendOrderRequest As OrderDelegateStatus
    Function ClientName(ByVal clientnum As Integer) As String
    Function SymbolSubscribed(ByVal sym As String) As Boolean
    ReadOnly Property AllClientBasket() As Basket
  End Interface
End Namespace 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T23:00:23.980

正如错误所暗示的，VB 不支持使用具有返回类型的委托的事件。所以不能*直接*转换代码。一种解决方法是将委托更改为使用`ByRef`参数：

```
Public Delegate Sub DecimalStringDelegate(ByVal s As String, ByRef retVal as Decimal)
Public Delegate Sub OrderDelegateStatus(ByVal o As Order, ByRef retVal As Long) 
```

# maven - 无法让maven文件工作

> ID：15283382
> 
> 赞同：1
> 
> 时间：2013-03-07T22:52:06.457
> 
> 标签：maven, jakarta-ee, eclipse-plugin

我正在尝试在 Eclipse 中创建一个简单的 Maven 应用程序。我正在使用弹簧。我在tomcat server.xml的以下行中添加了以下行

```
 <Context docBase="E:\Java\eclipse\Workspace\j2eeexample\target\j2eeexample-0.0.1-SNAPSHOT.war" path="/test" reloadable="true"/> 
```

docBase 的路径是正确的。我的 maven srs/main/webapp 中也有以下 jsp 文件：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Insert title here</title>
</head>
<body>
<h1> Hi kousha</h1>
</body>
 </html> 
```

当我作为 Maven install 运行程序时，我得到的唯一警告是：

```
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.

[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] Copying 0 resource 
```

接着：

```
[INFO] BUILD SUCCESS 
```

但是当我运行服务器并输入 URL (localhost:8020/test) 时，我得到一个 HTTP 状态 404 错误。

如果我错过了什么，知道吗？

顺便说一句，我尝试了“mvn --version”命令并且它可以工作（所以我猜maven安装没有问题）。

这是我在 Maven 安装模式下运行程序时的整个控制台：

```
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Marven_test 0.0.1-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-resources-plugin:2.5:resources (default-resources) @ j2eeexample ---
[debug] execute contextualize
[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] Copying 0 resource
[INFO] 
[INFO] --- maven-compiler-plugin:2.3.2:compile (default-compile) @ j2eeexample ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:2.5:testResources (default-testResources) @ j2eeexample ---
[debug] execute contextualize
[WARNING] Using platform encoding (Cp1252 actually) to copy filtered resources, i.e. build is platform dependent!
[INFO] Copying 0 resource
[INFO] 
[INFO] --- maven-compiler-plugin:2.3.2:testCompile (default-testCompile) @ j2eeexample ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:2.10:test (default-test) @ j2eeexample ---
[INFO] Surefire report directory: E:\Java\eclipse\Workspace\j2eeexample\target\surefire-reports

-------------------------------------------------------
T E S T S
-------------------------------------------------------

Results :

Tests run: 0, Failures: 0, Errors: 0, Skipped: 0

[INFO] 
[INFO] --- maven-war-plugin:2.1.1:war (default-war) @ j2eeexample ---
[INFO] Packaging webapp
[INFO] Assembling webapp [j2eeexample] in [E:\Java\eclipse\Workspace\j2eeexample\target\j2eeexample-0.0.1-SNAPSHOT]
[INFO] Processing war project
[INFO] Copying webapp resources [E:\Java\eclipse\Workspace\j2eeexample\src\main\webapp]
[INFO] Webapp assembled in [15 msecs]
[INFO] Building war: E:\Java\eclipse\Workspace\j2eeexample\target\j2eeexample-0.0.1-SNAPSHOT.war
[WARNING] Warning: selected war files include a WEB-INF/web.xml which will be ignored 
(webxml attribute is missing from war task, or ignoreWebxml attribute is specified as 'true')
[INFO] 
[INFO] --- maven-install-plugin:2.3.1:install (default-install) @ j2eeexample ---
[INFO] Installing E:\Java\eclipse\Workspace\j2eeexample\target\j2eeexample-0.0.1-SNAPSHOT.war to C:\Users\kousha\.m2\repository\Mave\j2eeexample\0.0.1-SNAPSHOT\j2eeexample-0.0.1-SNAPSHOT.war
[INFO] Installing E:\Java\eclipse\Workspace\j2eeexample\pom.xml to C:\Users\kousha\.m2\repository\Mave\j2eeexample\0.0.1-SNAPSHOT\j2eeexample-0.0.1-SNAPSHOT.pom
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.157s
[INFO] Finished at: Thu Mar 07 14:42:36 PST 2013
[INFO] Final Memory: 9M/243M
[INFO] ------------------------------------------------------------------------ 
```

# php - 如何通过类似于 facebook 分享按钮的 PHP SDK 分享图片或帖子？

> ID：15283385
> 
> 赞同：1
> 
> 时间：2013-03-07T22:52:14.130
> 
> 标签：php, facebook-graph-api, sdk, share

当我在我的 Facebook 页面上发布照片时，我想在我的个人资料上分享照片。 **我怎么能用 php sdk 做到这一点？**

类似于此图片中显示的分享链接 [http://g1303.hizliresim.com/17/8/kusyg.png](http://g1303.hizliresim.com/17/8/kusyg.png)

# android - 如何在 Canvas 中使用水龙头进行绘图？

> ID：15283386
> 
> 赞同：1
> 
> 时间：2013-03-07T22:52:20.183
> 
> 标签：android, drawing, android-canvas

如果我移动手指，这可以正常工作，但如果我只是点击（从 ACTION_DOWN 到 ACTION_UP 而没有经过 ACTION_MOVE）它不会画任何东西。任何想法？

```
@Override
protected void onDraw(Canvas canvas) {
    canvas.drawPath(path, paint);   
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    float eventX = event.getX();
    float eventY = event.getY();

    switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            path.moveTo(eventX, eventY);
            path.lineTo(eventX, eventY);
        return true;
        case MotionEvent.ACTION_MOVE:
            path.lineTo(eventX, eventY);
        break;
        case MotionEvent.ACTION_UP:
            path.lineTo(eventX, eventY);
        break;
        default:
        return false;
    }

    // Schedules a repaint.
    invalidate();
    return true;
}
} 
```

我想出的最接近的答案是检查 eventx 和 y 是否与 ActionUP 中的最后一个相同，并在 x 和 y 中添加 +1 ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:25:53.157

要让它在一个简单的水龙头上也能做一些事情，你必须做一些类似的事情：

```
boolean notMoved = true;
switch (event.getAction()) {

    case MotionEvent.ACTION_DOWN:
        path.moveTo(eventX, eventY);
    return true;

    case MotionEvent.ACTION_MOVE:
        path.lineTo(eventX, eventY);
        notMoved = false;
    break;

    case MotionEvent.ACTION_UP:
        if(notMoved) {
            //draw something
            path.lineTo(eventX, eventY);
        }
    break;
    default:
    return false;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:26:14.010

...在您的 MotionEvent.ACTION_UP 案例中做点什么而不是什么都不做。一个开始的东西：

```
if (moved) {
  moved = false;
  // on-tap behavior
} 
```

ACTION_MOVE 案例设置标志的位置。您的下一步：让 ACTION_DOWN 和 ACTION_MOVE 共享有关坐标的注释，从而更轻松地点击而不会意外“移动”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:25:48.687

也许

```
break; 
```

代替

```
return true; 
```

# ember.js - ember.js v1.0.0-rc.1 -- 使用模态出口，我如何在关闭时从模态中路由？

> ID：15283388
> 
> 赞同：2
> 
> 时间：2013-03-07T22:52:24.960
> 
> 标签：ember.js, modal-dialog, outlet

我正在尝试通过应用程序路由呈现我的所有模式，但是在我关闭模式后，我无法找出返回到先前状态的正确方法。

这是基本设置：

我的应用程序模板中有一个插座，用于显示模式对话框。

它看起来像：

```
{{ outlet modal }} 
```

在我的路线映射中，我为单个模态定义了钩子。例如，我的帮助对话框弹出：

```
App.HelpRoute = Ember.Route.extend({
    renderTemplate: function(controller, model) {
        this.render({ outlet: 'modal' });
    }
}); 
```

现在，我可以通过 uri 显示我的模态：

```
 foo.com/#/help 
```

我有一个使用 jQuery 解除模式的钩子：

```
$('#modalHelpWindow').modal('hide'); 
```

但这并没有真正的帮助，因为我只是隐藏了元素。我需要在解雇时更新 URI。如果我再次点击相同的路线，则模式已经隐藏，并且不会显示。

我应该使用什么方法来关闭模式，并将应用程序路由回之前的状态？我应该只使用 history.back() 吗？

请注意，我知道这个 SO 问题，但解决方案不是首选的“ember”做事方式，因为以编程方式创建的视图不会正确关联其控制器 [使用 Ember 路由器 v2 进入和退出模态状态的正确方法是什么?](https://stackoverflow.com/questions/14327949/whats-the-right-way-to-enter-and-exit-modal-states-with-ember-router-v2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:52:20.403

看起来我可以连接隐藏的处理程序以在我的视图的 didInsertElement 方法中执行 history.back() 调用，例如：

```
 didInsertElement: function() {
        var $me = this.$();
        $me.modal({backdrop:"static"});
        $me.on('hidden', function() {
            history.back();
        });
    }, 
```

# java - ContentPanel 中的 GXT 网格弄乱了 BorderLayout

> ID：15283402
> 
> 赞同：0
> 
> 时间：2013-03-07T22:53:17.763
> 
> 标签：java, gwt, gxt, uibinder, docklayoutpanel

**编辑**

尽管多亏了 Colin，Grid 本身的问题现在已经解决，但`BorderLayoutPanel`仍然在一个奇怪的（小）高度上初始化了网格，并且找不到中间边界。

--

我有一个 GWT 应用程序，它有一个 GXT 视口，其中包含一个 BorderLayoutContainer，其中包含另一个 BorderLayoutContainer，如下所示： ![页面结构草图](../Images/eb17edaca793212c2e2e5c56e2c74ee5.png)

现在，如果我将 Grid 替换为 GXT ，这将正常工作`ContentPanel`： ![使用 ContentPanel 而不是 Grid](../Images/1f307731edc5f735427e1b9385b76912.png)

但是，当我实现 Grid 时，我感到非常惊讶：

![网格不赞成我的编码](../Images/66963de968ed238e468f9028e0e3551a.png)

网格突然将 North 组件的大小变小了，它隐藏在标题下方（北方组件已经有 10px 的 margin-top），并且网格之间的线`TabPanel`不能再被抓取来调整大小视口。此外，人们希望网格在这种情况下显示滚动条。此外，在折叠 Grid 的 ContentPanel 时，中心组件不会按照应有的方式填充剩余空间。

当我使用 GWT 面板 ( , )`Grid`时效果很好，所以我继续将网格包装在 a (在 GXT 内)。没有发生任何变化。`DockLayoutPanel``SplitLayoutPanel``VerticalPanel``ContentPanel`

**DocGrid UiBinder**

```
<!DOCTYPE ui:UiBinder SYSTEM "http://dl.google.com/gwt/DTD/xhtml.ent"> 
```

```
<ui:with type="com.sencha.gxt.widget.core.client.grid.ColumnModel"
    field="cm"></ui:with>
<ui:with type="com.sencha.gxt.data.shared.ListStore" field="store"></ui:with>

<ui:with type="com.sencha.gxt.widget.core.client.grid.GridView"
    field="view">
    <ui:attributes stripeRows="true" forceFit="true"></ui:attributes>
</ui:with>

<gxt:ContentPanel ui:field="contentPanel" height="100%" width="100%">
    <row:VerticalLayoutContainer borders="false">
        <row:child>
            <grid:Grid ui:field="grid" cm="{cm}" store="{store}" view="{view}"
                loadMask="true" columnReordering="true" borders="false"
                height="500px">
            </grid:Grid>
        </row:child>
        <row:child>
            <toolbar:PagingToolBar pageSize="20" ui:field="toolBar" width="100%"></toolbar:PagingToolBar>
        </row:child>
    </row:VerticalLayoutContainer>
</gxt:ContentPanel> 
```

非常感谢任何帮助或线索。

**编辑**

按要求，`DocGrid.java`

```
package nl.opensatisfaction.postkamer.client.ui;

import java.util.ArrayList;
import java.util.Collections;
import java.util.Date;
import java.util.List;

import com.google.gwt.cell.client.DateCell;
import com.google.gwt.core.client.GWT;
import com.google.gwt.uibinder.client.UiBinder;
import com.google.gwt.uibinder.client.UiFactory;
import com.google.gwt.uibinder.client.UiField;
import com.google.gwt.user.client.rpc.AsyncCallback;
import com.google.gwt.user.client.ui.IsWidget;
import com.google.gwt.user.client.ui.Widget;
import com.sencha.gxt.core.client.IdentityValueProvider;
import com.sencha.gxt.core.client.Style.SelectionMode;
import com.sencha.gxt.data.shared.ListStore;
import com.sencha.gxt.widget.core.client.ContentPanel;
import com.sencha.gxt.widget.core.client.box.MessageBox;
import com.sencha.gxt.widget.core.client.grid.CheckBoxSelectionModel;
import com.sencha.gxt.widget.core.client.grid.ColumnConfig;
import com.sencha.gxt.widget.core.client.grid.ColumnModel;
import com.sencha.gxt.widget.core.client.grid.Grid;
import com.sencha.gxt.widget.core.client.grid.GridView;
import com.sencha.gxt.widget.core.client.grid.filters.DateFilter;
import com.sencha.gxt.widget.core.client.grid.filters.GridFilters;
import com.sencha.gxt.widget.core.client.grid.filters.StringFilter;
import com.sencha.gxt.widget.core.client.toolbar.PagingToolBar;

public class DocGrid implements IsWidget {
private static final DocumentNodeProperties props = GWT
        .create(DocumentNodeProperties.class);
AlfrescoServiceAsync metadata = GWT.create(AlfrescoService.class);

interface MyUiBinder extends UiBinder<Widget, DocGrid> {
}

private static MyUiBinder uiBinder = GWT.create(MyUiBinder.class);

@UiField
ColumnModel<DocumentNode> cm;

@UiField
ListStore<DocumentNode> store;

@UiField
Grid<DocumentNode> grid;

@UiField
GridView<DocumentNode> view;

@UiField
PagingToolBar toolBar;

@UiField
ContentPanel contentPanel;

@Override
public Widget asWidget() {
    IdentityValueProvider<DocumentNode> identity = new IdentityValueProvider<DocumentNode>();
    final CheckBoxSelectionModel<DocumentNode> sm = new CheckBoxSelectionModel<DocumentNode>(identity);
    sm.setSelectionMode(SelectionMode.MULTI);

    ColumnConfig<DocumentNode, String> nameCol = new ColumnConfig<DocumentNode, String>(
            props.nodeRef(), 100, "nodeRef");
    ColumnConfig<DocumentNode, String> documentIdCol = new ColumnConfig<DocumentNode, String>(
            props.documentIdentificatie(), 100, "Document ID");
    ColumnConfig<DocumentNode, Date> ontvangenCol = new ColumnConfig<DocumentNode, Date>(
            props.documentOntvangstdatum(), 100, "Ontvangen");
    ontvangenCol.setCell(new DateCell(OpenPostModule.DATE_FORMAT));
    ColumnConfig<DocumentNode, Date> aanschrijfCol = new ColumnConfig<DocumentNode, Date>(
            props.documentAanschrijfdatum(), 100, "Aangeschreven");
    aanschrijfCol.setCell(new DateCell(OpenPostModule.DATE_FORMAT));
    ColumnConfig<DocumentNode, String> doctypeCol = new ColumnConfig<DocumentNode, String>(
            props.documentTypeOmschrijving(), 100, "Type");
    ColumnConfig<DocumentNode, String> subjectCol = new ColumnConfig<DocumentNode, String>(
            props.afzenderIdentificatie(), 100, "BSN/KVK");
    ColumnConfig<DocumentNode, AlfrescoUser> behandelaarCol = new ColumnConfig<DocumentNode, AlfrescoUser>(
            props.documentBehandelaar(), 100, "Behandelaar"); 
    ColumnConfig<DocumentNode, AlfrescoObject> groepCol = new ColumnConfig<DocumentNode, AlfrescoObject>(
            props.documentGroep(), 100, "Groep");

    List<ColumnConfig<DocumentNode, ?>> l = new ArrayList<ColumnConfig<DocumentNode, ?>>();
    l.add(sm.getColumn());
    l.add(documentIdCol);
    l.add(ontvangenCol);
    l.add(aanschrijfCol);
    l.add(doctypeCol);
    l.add(subjectCol);
    l.add(groepCol);
    l.add(behandelaarCol);

    cm = new ColumnModel<DocumentNode>(l);
    store = new ListStore<DocumentNode>(props.key());

    Widget component = uiBinder.createAndBindUi(this);
    contentPanel.setCollapsible(true);
    contentPanel.setAnimCollapse(true);

    view.setAutoExpandColumn(nameCol);
    grid.setSelectionModel(sm);

    // Column filters
    StringFilter<DocumentNode> nameFilter = new StringFilter<DocumentNode>(props.documentIdentificatie());
    DateFilter<DocumentNode> dateFilter = new DateFilter<DocumentNode>(props.documentOntvangstdatum());
    DateFilter<DocumentNode> dateFilter2 = new DateFilter<DocumentNode>(props.documentAanschrijfdatum());
    StringFilter<DocumentNode> docTypeFilter = new StringFilter<DocumentNode>(props.documentTypeOmschrijving());
    StringFilter<DocumentNode> subjectFilter = new StringFilter<DocumentNode>(props.documentTitel());
    StringFilter<DocumentNode> groepFilter = new StringFilter<DocumentNode>(props.documentGroepLabel());
    StringFilter<DocumentNode> behandelaarFilter = new StringFilter<DocumentNode>(props.documentBehandelaarLabel());

    GridFilters<DocumentNode> filters = new GridFilters<DocumentNode>();
    filters.initPlugin(grid);
    filters.setLocal(true);
    filters.addFilter(nameFilter);
    filters.addFilter(dateFilter);
    filters.addFilter(dateFilter2);
    filters.addFilter(docTypeFilter);
    filters.addFilter(subjectFilter);
    filters.addFilter(groepFilter);
    filters.addFilter(behandelaarFilter);

    return component;
}

@UiFactory
ColumnModel<DocumentNode> createColumnModel() {
    return cm;
}

@UiFactory
ListStore<DocumentNode> createListStore() {
    return store;
}

public void fillGrid(AlfrescoUser user) {
    metadata.getPoststukken(user, new AsyncCallback<ArrayList<DocumentNode>>() {

        @Override
        public void onSuccess(ArrayList<DocumentNode> result) {
            // Sorts DocumentNode by its generatedPriority
            Collections.sort(result);
            store.addAll(result);
            if(result.size()==0) {
                new MessageBox("", "er zijn geen poststukken gevonden.").show();
            }
        }

        @Override
        public void onFailure(Throwable caught) {
            if(caught instanceof CustomException) {
                new MessageBox(((CustomException) caught).getTitle(), caught.getMessage()).show();
                if(caught instanceof CustomException) {
                    // TODO: move logic to PostCenter, then act appropriately
                    new MessageBox("Uitgelogd", "U bent uitgelogd.");
                }
            }
        }
    });
}

public void removeDocument(String documentIdentificatie) {
    for(DocumentNode doc : grid.getStore().getAll()) {
        if(doc.getDocumentIdentificatie().equals(documentIdentificatie)) {
            DebugClient.debug("Removing row with id " + doc.getDocumentIdentificatie(), this.getClass());
            grid.getStore().remove(doc);
            break;
        }
    }
}

public void updateRow(DocumentNode node) {
    DebugClient.debug("Updating row with id " + node.getDocumentIdentificatie(), this.getClass());
    grid.getStore().update(node);
} 
```

}

**编辑：BLP UiBinder**

这是包含 DocGrid 的 UiBinder 代码。这是直接在 RootPanel 上的那个。

```
<!DOCTYPE ui:UiBinder SYSTEM "http://dl.google.com/gwt/DTD/xhtml.ent"> 
```

```
<ui:style>
    .important {
        font-weight: bold;
    }
</ui:style>

<ui:with type="com.sencha.gxt.core.client.util.Margins" field="zeroMargins">
    <ui:attributes top="0" right="0" bottom="0" left="0" />
</ui:with>
<ui:with type="com.sencha.gxt.core.client.util.Margins" field="correctionMargins">
    <ui:attributes top="10" right="0" bottom="0" left="0" />
</ui:with>

<ui:with
    type="com.sencha.gxt.widget.core.client.container.BorderLayoutContainer.BorderLayoutData"
    field="northData">
    <ui:attributes size="35" collapsible="false" split="false"
        margins="{zeroMargins}" />
</ui:with>
<ui:with
    type="com.sencha.gxt.widget.core.client.container.BorderLayoutContainer.BorderLayoutData"
    field="southData">
    <ui:attributes size="20" collapsible="false" split="false"
        margins="{zeroMargins}" />
</ui:with>
<ui:with
    type="com.sencha.gxt.widget.core.client.container.BorderLayoutContainer.BorderLayoutData"
    field="innerWestData">
    <ui:attributes size="600" collapsible="true" split="true"
        margins="{zeroMargins}" />
</ui:with>
<ui:with
    type="com.sencha.gxt.widget.core.client.container.BorderLayoutContainer.BorderLayoutData"
    field="gridContainerData">
    <ui:attributes size="500" collapsible="true" split="true"
        margins="{correctionMargins}" />
</ui:with>

<container:Viewport>
    <container:BorderLayoutContainer
        ui:field="dockPanel">
        <container:north layoutData="{northData}">
            <os:Header ui:field="osHeader" />
        </container:north>

        <container:west layoutData="{innerWestData}">

            <container:BorderLayoutContainer
                ui:field="innerSplitPanel">
                <container:north layoutData="{gridContainerData}">
                    <os:DocGrid ui:field="docGrid" />
                </container:north>
                <container:center>
                    <os:MetaTabPanel ui:field="metaTabs"></os:MetaTabPanel>
                    <!-- <gxt:ContentPanel /> -->
                </container:center>
            </container:BorderLayoutContainer>

            <!-- <g:SplitLayoutPanel ui:field="innerSplitPanel"> <g:north size="500"> 
                <os:DocGrid ui:field="docGrid" /> </g:north> <g:center> <os:MetaTabPanel 
                ui:field="metaTabs" /> </g:center> </g:SplitLayoutPanel> -->

        </container:west>

        <container:center>
            <g:Frame ui:field="viewport" width="100%" height="100%"
                styleName="pdfPanel" />
        </container:center>

        <container:south layoutData="{southData}">
            <container:HtmlLayoutContainer
                ui:field="footer" />
        </container:south>
    </container:BorderLayoutContainer>
</container:Viewport>

</ui:UiBinder> 
```

相关的java是这样的（UiBinder类的构造函数）：

```
 initWidget(uiBinder.createAndBindUi(this));

    osHeader.setMenuLabel(this.user.getLabel());

    docGrid.fillGrid(user);

    // Docgrid selection handler
    docGrid.grid.getSelectionModel().addSelectionChangedHandler(new SelectionChangedHandler<DocumentNode>() {

        @Override
        public void onSelectionChanged(SelectionChangedEvent<DocumentNode> event) {
            List<DocumentNode> selected = event.getSelection();
            if (selected.size()>0) {
                documentSelected(selected.get(0));
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:13:11.003

将布局数据添加到该小部件中 VLC 内的 Grid 和 PagingToolbar。工具栏可能应该设置为 100% 宽度（即`width="1.0"`），并且只使用它需要的高度（`height="-1"`），并且 Grid 应该使用所有宽度和所有高度（`height="1.0"`和 `width="1.0"）。这可能看起来或多或少像这样（来自[http://www.sencha.com/examples/#ExamplePlace:paginguibindergrid](http://www.sencha.com/examples/#ExamplePlace:paginguibindergrid)）

```
<ui:with type="com.sencha.gxt.widget.core.client.container.VerticalLayoutContainer.VerticalLayoutData" field="middleData">
  <ui:attributes width="1" height="1" />
</ui:with>

<ui:with type="com.sencha.gxt.widget.core.client.container.VerticalLayoutContainer.VerticalLayoutData" field="bottomData">
  <ui:attributes width="1" height="-1" />
</ui:with>

<ui:with type="com.sencha.gxt.widget.core.client.grid.GridView" field="view">
  <ui:attributes stripeRows="true" forceFit="true"></ui:attributes>
</ui:with>

<gxt:FramedPanel ui:field="panel" headingText="Grid UiBinder Example" pixelSize="600, 300"
  collapsible="true" addStyleNames="margin-10">
  <row:VerticalLayoutContainer borders="true">
    <row:child layoutData="{middleData}">
      <grid:Grid ui:field="grid" cm="{cm}" store="{store}" view="{view}" loadMask="true" columnReordering="true"
        borders="false">
      </grid:Grid>

    </row:child>
    <row:child layoutData="{bottomData}">
      <toolbar:PagingToolBar pageSize="50" ui:field="toolBar"></toolbar:PagingToolBar>
    </row:child>
  </row:VerticalLayoutContainer>
</gxt:FramedPanel> 
```

然后，支持该 xml 文件的类能够被其父级调整大小也很重要。要么扩展`ResizeComposite`以获取该通知，要么实现`RequiresResize`并调用`ContentPanel`自己的`onResize`函数，或者根本不处理`Composite`，而只是实现`IsWidget`，并`asWidget()`返回`ContentPanel`.

在这种情况下，您的 Java 调整大小接线正确。但是，如果 asWidget() 被多次调用，您最终将生成一个小部件的多个副本 - 确保它始终返回相同的副本，可能通过将它存储在一个字段中并检查它是否为空（即 createAndBind 没有还没有被调用）。

# cocoa - 核心 MIDI：当我使用 MIDISend() 发送一个 MIDIPacketList 时，只有第一个数据包被发送

> ID：15283406
> 
> 赞同：1
> 
> 时间：2013-03-07T22:53:42.183
> 
> 标签：cocoa, core-audio, midi, coremidi

我正在尝试发送一个包含两个数据包的 MIDIPacketList，这些数据包描述了与 xy 样式控制器相关的控制器位置更改消息。

我试图实现的功能采用 x 和 y 位置，然后创建数据包并将它们发送到选定的目标设备，如下所示：

```
- (void)matrixCtrlSetPosX:(int)posX PosY:()posY {

    MIDIPacketList packetList;
    packetList.numPackets = 2;

    packetList.packet[0].length = 3;
    packetList.packet[0].data[0] = 0xB0;        // status: controller change
    packetList.packet[0].data[1] = 0x32;        // controller number 50
    packetList.packet[0].data[2] = (Byte)posX;  // value (x position)
    packetList.packet[0].timeStamp = 0;

    packetList.packet[1].length = 3;
    packetList.packet[1].data[0] = 0xB0;        // status: controller change
    packetList.packet[1].data[1] = 0x33;        // controller number 51
    packetList.packet[1].data[2] = (Byte)posY;  // value (y position)
    packetList.packet[1].timeStamp = 0;

    CheckError(MIDISend(_outputPort, _destinationEndpoint, &packetList), "Couldn't send MIDI packet list");
} 
```

我遇到的问题是程序似乎只发送了第一个数据包。

我已经尝试将输出分成两个单独的 MIDIPacketLists 和两个对 MIDISend() 进行两次调用，这确实有效，但我确信在构建 midi 数据包列表时一定有一些微不足道的东西，以便两条消息可以一次调用 MIDISend() 发送。我似乎无法弄清楚这里的问题是什么！这里的任何人都有这样做的经验，还是我完全以错误的方式去做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T01:17:27.830

仅声明 MIDIPacketList 不会分配内存或设置结构。有一个将数据包添加到列表的过程。这是一个快速而肮脏的例子：

```
- (void)matrixCtrlSetPosX:(int)posX PosY:(int)posY {
    MIDITimeStamp timestamp = 0;
    const ByteCount MESSAGELENGTH = 6;
    Byte buffer[1024];             // storage space for MIDI Packets
    MIDIPacketList *packetlist = (MIDIPacketList*)buffer;
    MIDIPacket *currentpacket = MIDIPacketListInit(packetlist);
    Byte msgs[MESSAGELENGTH] = {0xB0, 0x32, (Byte)posX, 0xB0, 0x33, (Byte)posY};
    currentpacket = MIDIPacketListAdd(packetlist, sizeof(buffer),
                                      currentpacket, timestamp, MESSAGELENGTH, msgs);

    CheckError(MIDISend(_outputPort, _destinationEndpoint, packetlist), "Couldn't send MIDI packet list");
} 
```

[我从这里](https://ccrma.stanford.edu/~craig/articles/linuxmidi/osxmidi)找到的 testout.c 改编了这段代码

# python - 如何使用鼻子测试实现全局 setUp() 进行多处理

> ID：15283407
> 
> 赞同：1
> 
> 时间：2013-03-07T22:53:46.050
> 
> 标签：python, multiprocessing, nosetests

到目前为止，我只使用了一个过程的鼻子测试，一切正常。

为了确保我的 setUp 只执行一次，我使用了一个布尔变量。

```
def setUp(self):
  if not self.setupOk:
    selTest.setupOk = True
    # start selenium
    # do other stuff which will be needed for all other tests to be able to run 
```

现在我想用 --processes=5 选项运行鼻子测试

如何确保 setUp(self) 仅由一个进程执行（而其他进程正在等待）。

我试过和

```
def setUp(self):
  lock = multiprocessing.Lock()
  lock.acquire()
      if not self.setupOk:
        selTest.setupOk = True
        # start selenium
        # do other stuff which will be needed for all other tests to be able to run 
  lock.release() 
```

但这似乎不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-27T17:16:43.613

setUp 将在每次测试运行之前调用。如果你想让一个方法只执行一次，你可以使用 setUpClass：

```
@classmethod
def setUpClass(cls):
    print "do stuff which needs to be run once" 
```

# vim - 如何在 vim 中更改当前缓冲区或窗格的背景颜色？

> ID：15283410
> 
> 赞同：5
> 
> 时间：2013-03-07T22:54:08.427
> 
> 标签：vim

想象一下，我正在编码，并且打开了不同的拆分窗格。当我从一个缓冲区/窗格切换到另一个缓冲区/窗格时，我应该将哪些设置传递给 vimrc 以更改背景颜色？

我试过了：

```
autocmd BufEnter * highlight Normal ctermbg=black                                                                                                                                                                                                                              
autocmd BufLeave * highlight Normal ctermbg=white 
```

我想补充一点，我确定我启用了 256 种颜色

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-10-25T16:12:04.443

实际上，有*一种*方法可以达到这种效果。请参阅@blueyed 对这个相关问题的回答：[vim - dim inactive split](https://stackoverflow.com/questions/8415828/vim-dim-inactive-split-panes) panes 。他提供了下面的脚本，当放置在我的 .vimrc 中时，它确实使非活动窗口的背景变暗。实际上，它使它们的背景与为 colorcolumn 指定的颜色相同（垂直线指示您所需的文本宽度）。

```
" Dim inactive windows using 'colorcolumn' setting
" This tends to slow down redrawing, but is very useful.
" Based on https://groups.google.com/d/msg/vim_use/IJU-Vk-QLJE/xz4hjPjCRBUJ
" XXX: this will only work with lines containing text (i.e. not '~')
" from 
if exists('+colorcolumn')
  function! s:DimInactiveWindows()
    for i in range(1, tabpagewinnr(tabpagenr(), '$'))
      let l:range = ""
      if i != winnr()
        if &wrap
         " HACK: when wrapping lines is enabled, we use the maximum number
         " of columns getting highlighted. This might get calculated by
         " looking for the longest visible line and using a multiple of
         " winwidth().
         let l:width=256 " max
        else
         let l:width=winwidth(i)
        endif
        let l:range = join(range(1, l:width), ',')
      endif
      call setwinvar(i, '&colorcolumn', l:range)
    endfor
  endfunction
  augroup DimInactiveWindows
    au!
    au WinEnter * call s:DimInactiveWindows()
    au WinEnter * set cursorline
    au WinLeave * set nocursorline
  augroup END
endif 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-08T07:24:14.587

你不能。这些`:highlight`组是全球性的；即当您有多个 window 时`:split`，所有窗口背景都将由相同的`Normal`高亮组着色。

活动窗口和非活动窗口之间的唯一区别是（闪烁）光标和不同突出显示的*状态行*（即`StatusLine`vs. `StatusLineNC`）。（您可以添加其他差异，例如仅`'cursorline'`在当前缓冲区中打开（请参阅我的[CursorLineCurrentWindow 插件](http://www.vim.org/scripts/script.php?script_id=4178)。））

Vim 的设计目标之一是在原始的、低颜色的控制台中与在 GUI GVIM 中一样好地工作。当您只有 16 种颜色可用时，背景颜色的区别可能会与语法突出显示发生冲突。我想这就是 Vim 没有也不会有这个功能的原因。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-09T05:58:28.153

基本上肯特上面所说的会奏效——出奇地好。唯一的限制是您只能使前景色变暗。将其复制到 vimrc 中，然后调用`:call ToggleDimInactiveWin()`.

```
let opt_DimInactiveWin=0
hi Inactive ctermfg=235
fun! ToggleDimInactiveWin()
    if g:opt_DimInactiveWin
        autocmd! DimWindows
        windo syntax clear Inactive
    else
        windo syntax region Inactive start='^' end='$'
        syntax clear Inactive
        augroup DimWindows
            autocmd BufEnter * syntax clear Inactive
            autocmd BufLeave * syntax region Inactive start='^' end='$'
        augroup end
    en
    let g:opt_DimInactiveWin=!g:opt_DimInactiveWin
endfun 
```

在写这篇文章时，我必须查查几件事：

(1)`windo`方便地跨所有窗口执行命令

(2) augroup 定义自动命令组，可以用`autocmd! group`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-06-25T12:01:14.823

Neovim 用户可以[`winhighlight`](https://neovim.io/doc/user/options.html#%27winhighlight%27)选择。帮助文件提供了以下示例：

> 示例：为非当前窗口显示不同的颜色：
> 
> ```
> set winhighlight=Normal:MyNormal,[NormalNC](https://neovim.io/doc/user/syntax.html#hl-NormalNC):MyNormalNC
> ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-08T03:18:57.333

就个人而言，我使用我的状态栏让我知道这一点。我使用 WinEnter 和 WinLeave 自动命令在离开时切换到非活动状态行（灰色），在进入时切换到活动状态行（亮色）。您提到的拆分窗格是vim中的窗口。这也有效，因为`:help statusline`它告诉我们它的设置是全局的或局部于窗口的，因此您可以使用`:setlocal statusline=...`or`let &l:statusline=...`仅应用于当前窗口。

您的方法将不起作用，因为 a) BufEnter 和 BufLeave 不一定是您想要的事件，并且 b) 突出显示组是全局的，因此更改 Normal 的定义会针对每个窗口更改它。

# c# - 如何获取没有文件的路径：\\ 在开头

> ID：15283414
> 
> 赞同：0
> 
> 时间：2013-03-07T22:54:20.200
> 
> 标签：c#

我正在处理 ac# 项目，我正在尝试获取我的可执行文件运行的当前路径。但是，我使用的方法是添加`file:\\`到开头，即`file:\\C:\\users\\user\\Project\\Debug`我想要的字符串是，`C:\\users\\user\\Project\\Debug`但我找不到这样做的方法。

下面是我正在使用的代码

```
string basePath = Path.GetDirectoryName(Assembly.GetExecutingAssembly().GetName().CodeBase); 
```

感谢您的任何帮助，您可以提供

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T22:58:24.367

```
string basePath = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T22:59:21.797

```
var basePath = AppDomain.CurrentDomain.BaseDirectory; 
```

# javascript - 查询嵌套 JSON

> ID：15283418
> 
> 赞同：3
> 
> 时间：2013-03-07T22:54:45.743
> 
> 标签：javascript, jquery, json

我有一些格式如下的 JSON 数据：

```
{
    "id": "ABC123",
    "offerPrice": 42.00,
    "regularPrice": 42.00,
    "variations": [{
        "key": "Style",
        "value": "Black"
    }, {
        "key": "Personalization",
        "value": "2 Lines of Personalization"
    }]
}, {
    "id": "987ZYX",
    "offerPrice": 52.00,
    "regularPrice": 52.00,
    "variations": [{
        "key": "Style",
        "value": "Black"
    }, {
        "key": "Personalization",
        "value": "3 Lines of Personalization"
    }]
} 
```

我需要做的是查询'variations'数组中的值，如果找到匹配则返回对象。

我可以很好地查询值的“第一级”：

```
var results = jQuery.grep(obj, function (element, index) {
    return element.offerPrice == "42.00";
}); 
```

如果我指定一个索引值（我显然不想这样做），我可以查询变化：

```
var results = jQuery.grep(obj, function (element, index) {
    return element.variations[1].key == "Personalization" && element.variations[1].value == "2 Lines of Personalization";
}); 
```

理想情况下，这是我想要做的，但它不起作用：

```
var results = jQuery.grep(obj.variations, function (element, index) {
    return element.key == "Personalization" && element.value == "2 Lines of Personalization";
}); 
```

我不断得到：

```
Uncaught TypeError: Cannot read property 'length' of undefined 
```

这是一个 jsFiddle：http: [//jsfiddle.net/VzqWW/3/](http://jsfiddle.net/VzqWW/3/)

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:11:47.347

没有这样的对象，`obj.variations`因为 obj 是一个数组。像这样的东西应该工作：

```
var results = jQuery.grep(obj, function (element, index) {
    res = jQuery.grep(element.variations, function (element2, index2) {
        return element2.key== "Personalization" && element2.value == "2 Lines of Personalization";
    });
    return (res.length != 0);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:12:06.027

`map`您可以使用作为 ES5 一部分的( [link](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map) )、`reduce`( [link](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/reduce%5d) ) 和`filter`( [link](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter) ) 方法的标准数组过滤来做到这一点，我已经更新了[jsfiddle](http://jsfiddle.net/qBzQe/1/)以使用它们，但代码在下面内联：

```
var variations = obj.map(function (x) { 
    return x.variations;
}).reduce(function (x, y) {
   return x.concat(y); 
});

var personalizationVariations = variations.filter(function (v) {
    return v.key== "Personalization" && v.value == "2 Lines of Personalization"
});
console.log('Personalization Variations', personalizationVariations); 
```

如果您支持 ES3 浏览器 (< IE9)，您将需要像[es5shim](https://github.com/kriskowal/es5-shim)这样添加这些方法的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T23:39:24.193

[使用jQuery.map](http://api.jquery.com/jQuery.map/)和 grep怎么样？

```
var allVariations = $.map(obj, function(element, i) {
    return element.variations;
});

var variations = $.grep(allVariations, function(variation, index) {
    return variation.key == "Personalization" && variation.value == "2 Lines of Personalization";
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T23:19:27.627

这对我有用。

```
var obj=[{
    "id": "ABC123",
    "offerPrice": 42.00,
    "regularPrice": 42.00,
    "variations": [{
        "key": "Style",
        "value": "Black"
    }, {
        "key": "Personalization",
        "value": "2 Lines of Personalization"
    }]
}, {
    "id": "987ZYX",
    "offerPrice": 52.00,
    "regularPrice": 52.00,
    "variations": [{
        "key": "Style",
        "value": "Black"
    }, {
        "key": "Personalization",
        "value": "3 Lines of Personalization"
    }]
}];
var result=$.grep(obj,function(element,index){
    return element.offerPrice=="42.00";
});
var variations=$.grep(result[0].variations, function(element, index){
    return element.key == "Personalization" && element.value == "2 Lines of Personalization";
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T23:29:21.953

在 ES5 中你可以这样写：

```
var filtered = obj.filter(function(el){
  return el.variations.some(function(el) {
    return el.key === "Personalization" && el.value === "2 Lines of Personalization";
  })
});

console.log(filtered); 
```

您可以`grep`在 jQuery 中使用来模拟`filter`，但据我所知，它没有类似`some`. 当然你也可以模仿。您还可以在 MDN 中找到[filter](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)的 shim和[一些。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/some)

一般来说，如果我们想支持旧版浏览器，为 ES5 功能添加一个 shim 总是好的。

# angularjs - AngularJS：如何在模块配置期间使用 Angular 服务？

> ID：15283423
> 
> 赞同：2
> 
> 时间：2013-03-07T22:55:21.713
> 
> 标签：angularjs, jasmine

请参阅此 plunkr 以获取实时示例：[http ://plnkr.co/edit/djQPW7g4HIuxDIm4K8RC](http://plnkr.co/edit/djQPW7g4HIuxDIm4K8RC)

在下面的代码中，该行在`var promise = serviceThatReturnsPromise();`模块配置期间运行，但我想模拟出服务返回的承诺。

理想情况下，我会使用该`$q`服务来创建模拟承诺，但我不能这样做，因为`serviceThatReturnsPromise()`在模块配置期间执行，然后才能访问`$q`. 解决这个先有鸡还是先有蛋的问题的最佳方法是什么？

```
var app = angular.module('plunker', []);

app.factory('serviceUnderTest', function (serviceThatReturnsPromise) {
  // We mock out serviceThatReturnsPromise in the test
  var promise = serviceThatReturnsPromise();
  return function() {
    return 4;
  };
});

describe('Mocking a promise', function() {
  var deferredForMock, service;

  beforeEach(module('plunker'));

  beforeEach(module(function($provide) {
    $provide.factory('serviceThatReturnsPromise', function() {

        return function() {
          // deferredForMock will be undefined because this is called
          // when `serviceUnderTest` is $invoked (i.e. at module configuration),
          // but we don't define deferredForMock until the inject() below because  
          // we need the $q service to create it. How to solve this chicken and
          // egg problem?
          return deferredForMock.promise;
        }
    });
  }));

  beforeEach(inject(function($q, serviceUnderTest) {
    service = serviceUnderTest;
    deferredForMock = $q.defer();
  }));

  it('This test won\'t even run', function() {
    // we won't even get here because the serviceUnderTest
    // service will fail during module configuration
    expect(service()).toBe(4);
  });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T12:49:44.263

我不确定我是否喜欢这个解决方案，但它是：

[http://plnkr.co/edit/uBwsJxJRjS1qqsKIx5j7?p=preview](http://plnkr.co/edit/uBwsJxJRjS1qqsKIx5j7?p=preview)

您需要确保在设置完所有内容*后才实例化“serviceUnderTest”。*因此，我将第二个`beforeEach`分成两个独立的部分：第一个实例化和使用`$q`，第二个实例化和使用`serviceUnderTest`。

我还必须包含`$rootScope`，因为 Angular 的承诺旨在在`$apply()`方法中工作。

希望有帮助。

# ruby - 在 RSpec 中，使用 let 分配正则表达式会产生意外的通过/失败行为 - 错误或用户错误？

> ID：15283425
> 
> 赞同：1
> 
> 时间：2013-03-07T22:55:46.047
> 
> 标签：ruby, rspec

带有被测对象的文件：`foo.rb`

```
class Foo
  def a_string
    "abcdef8"
  end
end 
```

规格文件：`foo_spec.rb`

```
require_relative "./foo"

describe Foo do
  let(:foo) {Foo.new}
  let(:my_matcher) {/^[a-z]+(\d)$/}

  # This test passes

  it "should match and pass" do
    my_str = foo.a_string

    my_matcher # <--- why does this affect the test?

    matcher = my_str.match(my_matcher)
    8.should == matcher[1].to_i
  end

  # This test fails

  it "should also match and pass but fails" do
    my_str = foo.a_string

    #my_matcher #<---- the only change between the tests

    matcher = my_str.match(my_matcher)  #<---- when called here, it behaves differently
    8.should == matcher[1].to_i
  end
end 
```

`rspec foo_spec.rb`

```
.F

Failures:

  1) Foo should also match and pass but fails
     Failure/Error: 8.should == matcher[1].to_i
     NoMethodError:
       undefined method `[]' for /^[a-z]+(\d)$/:Regexp
     # ./foo_spec.rb:18:in `block (2 levels) in <top (required)>'

Finished in 0.00095 seconds
2 examples, 1 failure

Failed examples:

rspec ./foo_spec.rb:14 # Foo should also match and pass but fails 
```

两个测试的唯一区别是是否`my_matcher`被调用。我在检查 my_matcher (ie `p my_matcher`) 时第一次注意到这个问题，但它也发生在仅调用`my_matcher`.

这是一个错误，还是我做错了什么？也许它与捕获正则表达式数据有关？

这似乎是非常奇怪的行为，尤其是对于 ruby​​。

对于它的价值，这是一个简单的（如果稍微不那么干燥）修复。如果`my_matcher`在`it`块中声明它按预期工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:38:30.557

这看起来像一个错误。您可以向 rspec-core 提出问题吗？

# class - 在 Haskell 中，你可以创建一个类的对象吗？

> ID：15283429
> 
> 赞同：2
> 
> 时间：2013-03-07T22:55:59.360
> 
> 标签：class, haskell, types

在我尝试调试的 Haskell 程序中，定义了一个类：

```
class Dictionary d where
  lookupIn :: d -> Word -> String 
```

我想创建一个名为的变量`runs`并将其设为类型`Dictionary`，以便我可以在 lookupIn 函数中使用它。但是，没有任何效果。我试过`type runs = Dictionary`了，甚至`data runs = Dictionary`但没有任何效果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T23:00:52.650

Haskell**不是**面向对象的语言。类型类不是类。变量不是“变量”（尽管这在这里无关紧要），当然也不是对象。

看到这个[帖子](https://stackoverflow.com/questions/5414323/does-haskell-support-object-oriented-programming)。

PS我想这是家庭作业。尝试先学习这门语言（甚至一点点），Haskell 很可能比你想象的更有趣。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-07T23:12:15.917

在 Haskell 中这是不可能的。在其他具有类型类结构的语言（Scala、Agda）中是可能的，但在 Haskell 中是不可能的。

可以在 Haskell 中创建一个类的实例：

```
instance Dictionary () where
    lookupIn _ _ = "no" 
```

然后使用它：

```
main = do
    putStrLn $ lookupIn () "hello" 
```

确实，实例的行为确实很像数据——它们在运行时由数据表示。这就是为什么在其他语言中您可以将实例存储在变量中，并显式地传递它们。

但是，在 Haskell 中，不可能命名一个实例，或者将它存储在一个变量中。也就是说，你不能这样做，或者类似的事情：

```
thisInstance :: Dictionary ()
thisInstance = ??? 
```

原因是在 Haskell 中，假设对于每个类型和类型类，只能有*一个*该类型类的实例应用于该类型。也就是说，您只能定义一个`instance Dictionary ()`。由于只能有一个，因此命名没有意义。这对于 Haskell 的类型推断很方便——任何需要的实例都可以拉到当前函数的“参数”（真正的类型类约束）。

* * *

当然，也有可能实现相同的行为，只是不能使用类型类——记录对此很有效：

```
data DictionaryType d = DictionaryData { lookupIn :: d -> Word -> String } 
```

现在`lookupIn`有了 type `DictionaryType d -> d -> Word -> String`，它是使用 typeclass 的 type 的字面翻译`(Dictionary d) => d -> Word -> String`。你可以像这样使用它：

```
myDictionary :: DictionaryType ()
myDictionary = DictionaryData (\_ _ -> "no")

main = do
    putStrLn $ lookupIn myDictionary () "hello" 
```

在功能上与 typeclass 解决方案相同，唯一的区别是语法和类型检查的工作方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-02T07:55:18.123

一种思考方式是：

在 OO 语言中，一个类定义了一个类型（即一组潜在值）和一组其他类型（即潜在的后代类）。

在 Haskell中，类型类*只*定义了一组类型（即类型类的潜在“实例”）。类型类本身不是类型。

（实际上我正在讨论[集合论中](https://scienceblogs.com/goodmath/2007/05/07/basics-sets-and-classes)集合和类之间的区别，这就是为什么它们被称为“typeclasses”而不是“typesets”。但这在这里并不重要。）

# image - 谷歌相似图片搜索 API

> ID：15283439
> 
> 赞同：10
> 
> 时间：2013-03-07T22:56:25.023
> 
> 标签：image, api, search

我试图找出是否有办法通过 API 进行谷歌类似的图像搜索？

我知道图像搜索 api 已被贬值，但它仍然可用吗？ [https://developers.google.com/image-search/](https://developers.google.com/image-search/)

另外...您似乎可以使用自定义搜索 api 进行图像搜索，但我似乎无法确定是否可以进行类似的图像搜索。 [http://thenextweb.com/dd/2012/02/14/googles-custom-search-api-now-supports-image-only-results/](http://thenextweb.com/dd/2012/02/14/googles-custom-search-api-now-supports-image-only-results/)

任何有关工作建议的线索我们将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-09-02T22:28:37.807

如果您有托管图像的 URL（使用 Dropbox、imgur 等），[https:](https://stackoverflow.com/a/15134958/116891) //stackoverflow.com/a/15134958/116891 上的答案会告诉您如何查找相似图像。基本上，

```
http://images.google.com/searchbyimage?image_url=YOUR_HOSTED_URL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-04T02:02:37.697

那已被弃用。但我需要类似图像结果的 JSON 格式。因此，我尝试使用 google cse，但这不支持搜索类似图像。它只是在自定义域中显示图像搜索结果。

我尝试的另一种方法是 URL。

> [http://images.google.com/searchbyimage?image_url=YOUR_HOSTED_URL](http://images.google.com/searchbyimage?image_url=YOUR_HOSTED_URL)

但这不是我需要的解决方案。这是因为能够在浏览器中使用。我需要 JSON。

最后，我决定使用 Google 的 Vision API。这很简单。

> [https://cloud.google.com/vision/](https://cloud.google.com/vision/)

你可以在上面试试。

1.  首先，访问 URL。
2.  其次，将您的图像文件上传到“Try API”。
3.  第三，单击结果上的“JSON”选项卡菜单。

你可以看到关于类似图像的 JSON。

# javascript - 如何根据下拉 JS 和 CRM 更改默认表单？

> ID：15283440
> 
> 赞同：2
> 
> 时间：2013-03-07T22:56:25.517
> 
> 标签：javascript, forms, dynamics-crm-2011, crm

好的，所以我在 CRM 2011 中尝试做的是有一个下拉菜单，其中有两个选项：“支持”和“教授服务”，这是针对案例实体的。现在，我有两种形式，一种名为“支持”，另一种名为“Prof. Services”。

我想要发生的是，如果一个案例在打开时将下拉菜单设置为“支持”，它应该以“支持”表单打开，如果下拉菜单设置为“教授服务”，它应该以“教授”打开.服务”形式。

我遇到了这篇文章：[http](http://social.microsoft.com/Forums/en-US/crmdevelopment/thread/5ba919f7-9f7c-4abf-ba88-224951bb7c11) ://social.microsoft.com/Forums/en-US/crmdevelopment/thread/5ba919f7-9f7c-4abf-ba88-224951bb7c11并在 JScript Web 资源中使用了该代码。然后在我的两个表单上，我转到表单属性并添加了一个 OnLoad 函数 setForm()（如下面的 JS 代码所示）。但这不起作用。未针对正确的大小写/下拉值显示正确的表单。这是我正在使用的代码：（任何帮助调试这将不胜感激）*请记住，我是初学者 JS'er :)

```
function setForm() {
var currentForm= Xrm.Page.ui.formSelector.getCurrentItem().getId();                         
var Information;
var cType = Xrm.Page.data.entity.attributes.get('new_CaseType').getText().toLowerCase();    
var forms = Xrm.Page.ui.formSelector.items.get();
var i = 0;

for (i = 0; i < forms.length; i++) {                            
    if (forms[i].getLabel().toLowerCase()==cType) {             
        if (currentForm!=forms[i].getId()) {                    
            forms[i].navigate();
        }
        return;
    }
    if (forms[i].getLabel().toLowerCase()=='information') {     
        Information=forms[i];                                   
    }
}
if (currentForm!=Information.getId()) {                         
    Information.navigate();
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T10:47:42.333

如需调试帮助，我建议阅读以下精彩文章：

1.  [如何在 Microsoft Dynamics CRM 2011 中调试 JScript](http://social.technet.microsoft.com/wiki/contents/articles/3256.how-to-debug-jscript-in-microsoft-dynamics-crm-2011.aspx)。
2.  [使用开发者工具调试脚本](http://msdn.microsoft.com/en-us/library/dd565625%28VS.85%29.aspx)。
3.  [How-to 系列：在 IE8 中轻松调试您的 CRM JavaScript 代码](http://www.furnemont.eu/2010/06/how-to-series-easily-debug-your-crm-javascript-code-in-ie8/)。

# r - 如何在 R 2.15 中阅读.jpeg

> ID：15283447
> 
> 赞同：20
> 
> 时间：2013-03-07T22:57:11.773
> 
> 标签：r, import, png, jpeg

这似乎很简单，但我无法将 jpeg 或任何类型的图像读入 R 2.15。在 R 2.10 中，我可以使用`rimage`库或`ReadImage`库来做到这一点 - 例如使用 read.jpeg - 但在 R 2.15 及更高版本中似乎没有办法做到这一点。对此有什么想法吗？

```
library('ReadImages') 
Error in library("ReadImages") : there is no package called ‘ReadImages’ > 
install.packages('ReadImages') Installing package(s) into ‘C:/Program Files/R/R-2.15.1/library’ (as ‘lib’ is unspecified) 

Warning in install.packages : package ‘ReadImages’ is not available (for R version 2.15.1) 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-03-09T00:07:36.720

正如评论中所指出的，请尝试 jpeg 包。

```
install.packages("jpeg")  ## if necessary

library(jpeg)
## get help
library(help = jpeg)
## get more help
?readJPEG 
```

示例，来自帮助：

```
# read a sample file (R logo)
img <- readJPEG(system.file("img", "Rlogo.jpg", package="jpeg")) 
```

另一种选择是 rgdal，它可以从大量的格式中读取。绘图和操作的处理方式不同。

```
install.packages("rgdal") ## if necessary
library(rgdal)
img <- readGDAL(file.path(R.home(), "doc", "html", "logo.jpg")) 
```

CRAN 上还有 readbitmap 包，对于您要查找的内容，始终值得对包列表进行基本搜索。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-09-22T00:00:09.077

还：

```
## if not already installed
install.packages("jpeg")  

library(jpeg)

?readJPEG()

img <- readJPEG("/Users/name/locationInFileDirectory/image.jpg", native = TRUE)

#this will display your image to test you read it correctly
if(exists("rasterImage")){
      plot(1:2, type='n')
      rasterImage(img,1,1,2,2)
} 
```

# c# - 用户在 Windows Phone 8 上完成文本输入时的默认操作

> ID：15283450
> 
> 赞同：0
> 
> 时间：2013-03-07T22:57:31.640
> 
> 标签：c#, windows-phone-8

我正在开发一个简单的 Windows Phone 8 应用程序，并使用 Url InputScope 正确显示键盘。在软键盘 (SIP) 的右下角会显示一个右箭头。

如何检测用户单击该按钮？

我已经尝试过 KeyUp 事件，但未定义 Key 类，因此我无法将 e.Key 与 Key.ENTER 进行比较 - 而且我也觉得检查密钥代码是不正确的，从语义上讲. 我宁愿在 HTML 中找到一些“onSubmit”事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:13:37.903

我首先添加了“使用 System.Windows.Input;”。到我的 .cs 文件的顶部。之后，Key 类变得可用。

XAML：

```
<TextBox KeyUp="txtUrl_KeyUp" x:Name="txtUrl" InputScope="Url"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" TextWrapping="Wrap" VerticalScrollBarVisibility="Disabled" ManipulationCompleted="txtUrl_ManipulationCompleted" Margin="0,127,0,0" Grid.RowSpan="2" /> 
```

C＃：

```
private void txtUrl_KeyUp(object sender, System.Windows.Input.KeyEventArgs e)
{
    if (e.Key.Equals(Key.Enter)) {
        navigateTo(txtUrl.Text);
        webBrowser.focus(); // Hides the input box
    }
} 
```

# mysql - 如何在工作台中禁用 mysql EXECUTE 命令的结果输出

> ID：15283456
> 
> 赞同：6
> 
> 时间：2013-03-07T22:58:06.833
> 
> 标签：mysql, mysql-workbench, prepared-statement, database-cursor

我正在尝试在游标中的 mysql 工作台中使用准备好的语句。游标适用于非常大的数据集，因此会执行多次。每次执行步骤都会显示一个新结果。由于打开的结果窗口太多，这最终导致 mysql 工作台崩溃。

在光标中，我执行以下操作：

```
PREPARE stmt2 FROM @eveningQuery;
EXECUTE stmt2; 
DEALLOCATE PREPARE stmt2; 
```

通常我使用类似的东西

```
set aVar = (EXECUTE stmt2); 
```

使查询静音，但 EXECUTE 不能那样工作。

有人知道如何在 mysql 中禁用 EXECUTE 命令的输出吗？

注意：我了解如何检索变量中的数据，但是我要防止它像这样显示在结果概述中![在此处输入图像描述](../Images/959c90185cbb6e73d29cc20caf1c5aaf.png)

当循环过多时，这将使 mysql-workbench 崩溃。

*编辑*，因为它被问到@eveningQuery 的一个例子。

> SET @eveningQuery = CONCAT('select @resultNm := exists (select idSplitBill from tb_SplitDay where idSplitBill =', idSplitBillVar, ' and ', @columnNameEv ,' = 1 and softdelete = 0)');

idSplitBillVar = 来自光标的 id。@columnNameEv = 我正在可变填写的列。

我添加了这个信息是因为它被问到了，但是在我看来这并不重要，因为即使是最简单的查询，这个问题仍然存在。当你执行一个准备好的语句时，你会得到一个输出结果。我只想禁用这种行为。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T08:13:13.607

您使用的查询会创建新的结果集，并且 GUI 客户端会显示它（...很多次） -

```
SELECT @resultNm:=EXISTS(
  SELECT idSplitBill FROM tb_SplitDay
  WHERE idSplitBill =', idSplitBillVar, ' AND ', @columnNameEv ,' = 1 AND softdelete = 0
) 
```

您可以重写此查询，并且不会创建结果集 -

```
SELECT EXISTS(
  SELECT idSplitBill FROM tb_SplitDay
  WHERE idSplitBill =', idSplitBillVar, ' AND ', @columnNameEv ,' = 1 AND softdelete = 0
)
INTO @resultNm 
```

# php - 比 if 语句更有效？

> ID：15283457
> 
> 赞同：3
> 
> 时间：2013-03-07T22:58:07.307
> 
> 标签：php

我正在用 PHP 制作游戏（不要问大声笑），玩家有一个整数位置。有一个旅行页面，这基本上显示了一个 5x5 平铺地图。每个图块都是玩家世界的不同部分。通过点击它，他可以前往那里。只是为了让您了解地图背后的整数：

*   11、12、13、14、15
*   21、22、23、24、25
*   31、32、33、34、35
*   41、42、43、44、45
*   51、52、53、54、55

假设玩家从 33（中间）开始，我想根据他走了多远向他收取不同的费率。因此，例如，任何方向的 1 个图块是 100 学分，2 个图块是 200，依此类推。

所以我想出的是这个。`$ol`代表玩家的当前位置，`$nl`是他们要去的地方...

```
if($ol-11==$nl || $ol-10==$nl || $ol-9==$nl || $ol+1==$nl || $ol+11==$nl || $ol+10==$nl || $ol+9==$nl || $ol-1==$nl || $ol-11==$nl ){
echo "cost 100 credits!";
}
else if($ol-22==$nl || $ol-21==$nl || $ol-20==$nl || $ol-19==$nl || $ol-18==$nl || $ol-8==$nl || $ol+2==$nl || $ol+12==$nl || $ol+22==$nl 

|| $ol+21==$nl || $ol+20==$nl || $ol+19==$nl || $ol+18==$nl || $ol+8==$nl || $ol-2==$nl || $ol-12==$nl ){
echo "cost 200 credits!";
} 
```

这是 1 和 2 瓦旅行的代码。如您所见，这是一个冗长的声明。

我基本上为我设置的网格制定了一个模式。例如，向上移动 1 个图块将始终是当前图块的 -10。

在我输入更可笑的长 if 语句之前，有没有更简洁或更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:01:22.417

我会使用不同的方法：由于第一个数字定义行，第二个数字定义列，我会将数字拆分为这两个数字，并使用这些数字来确定行进的行数和列数。

所以对于任何位置：

```
$row = floor($tile_value / 10);
$column = $tile_value % 10; 
```

有了这个，很容易计算距离。

**编辑：**一个测量绝对距离的小例子：

```
$row_org = floor($tile_org_value / 10);
$column_org = $tile_org_value % 10;

$row_new = floor($tile_new_value / 10);
$column_new = $tile_new_value % 10;

$row_diff = $row_new - $row_org;
$col_diff = $col_new - $col_org;

$distance = sqrt(pow($row_diff, 2) + pow($col_diff, 2)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:08:54.150

我可能会尝试一个坐标数组。这将允许您设置初始坐标。然后，您可以将新坐标传递给将移动位置并计算成本的函数。

```
<?php

$array = array( );

//populate the array with 0's
for( $i = 1; $i <= 5; $i++ ) {
    for( $j = 1; $j <= 5; $j++ ) {
        $array[$i][$j] = 0;
    }
}

//set beginning position
$array[3][3] = 1;

function newPosition( $array, $newX, $newY ) {
    $oldX = 0;
    $oldY = 0;

    //locate current position
    foreach($array as $key=>$subArray) {
        foreach($subArray as $subKey=>$val) {
            if($val === 1) {
                $oldX = $key;
                $oldY = $subKey;
            }
        }
    }

    //delete old position
    $array[$oldX][$oldY] = 0;

    //set new position
    $array[$newX][$newY] = 1;

    //Calculate x and y difference
    $xTravel = abs($oldX - $newX);
    $yTravel = abs($oldY - $newY);

    //Add x and y difference
    $totalTravel = $xTravel + $yTravel;

    //Calculate the cost
    $totalCost = $totalTravel * 100;

    echo "cost $totalCost credits!\n";

    return $array;
}

$array = newPosition( $array, 5, 2 );
$array = newPosition( $array, 1, 5 );
$array = newPosition( $array, 1, 5 );
$array = newPosition( $array, 3, 3 ); 
```

**输出**

```
花费300学分！
花费700学分！
花费0学分！
花费400学分！
```

[查看演示](http://codepad.org/sIpjDeQH)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T23:17:14.357

正如我在上面的评论中一样，您不能以单位测量距离，因为并非所有点都可以通过点直线到达。

您需要将这些点视为图形上的点（x，y 坐标）。然后你可以使用毕达哥拉斯得到任意两点之间的距离。

例如，如果我们将您的第一行视为坐标 (1,1) (1,2) 等等，如果人从 (1,1) 到 (4,3)，则行进的距离是正方形3 (4-1) 平方的根加上 2 (3-1) 平方，即 sqrt(9+4) = sqrt(13)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-03-07T23:02:30.610

您的代码似乎合法。您可以对条件进行排序，以便最常用的条件排在第一位。

# dynamics-crm-2011 - Crm 2011 为 QueueItem 设置标题

> ID：15283459
> 
> 赞同：2
> 
> 时间：2013-03-07T22:58:07.907
> 
> 标签：dynamics-crm-2011

我有一个启用队列的自定义实体。我可以使用工作流将其添加到队列中，但是队列项目标题仍然为空。无论我做什么，我似乎都无法设置它或让 CRM 自动设置它。有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T00:49:09.010

您是否尝试在自定义实体中的字段“名称”上设置值（模式名称“xxx_name”，其中 xxx 是您用于自定义的前缀）？

# java - Google Drive File List API 为 Items 返回一个空数组

> ID：15283461
> 
> 赞同：3
> 
> 时间：2013-03-07T22:58:17.757
> 
> 标签：java, google-drive-api

我正在尝试编写一个程序来使用 Google Drive API 列出我的 Google Drive 中的文件。

我为我的帐户创建了一个服务帐户。

这是我创建的服务对象

```
public static Drive getDriveService() throws GeneralSecurityException,
        IOException, URISyntaxException {
    HttpTransport httpTransport = new NetHttpTransport();
    JacksonFactory jsonFactory = new JacksonFactory();
    GoogleCredential credential = new GoogleCredential.Builder()
            .setTransport(httpTransport)
            .setJsonFactory(jsonFactory)
            .setServiceAccountId(SERVICE_ACCOUNT_EMAIL)
            .setServiceAccountScopes(
                    "https://www.googleapis.com/auth/drive")
            .setServiceAccountPrivateKeyFromP12File(
                    new java.io.File(SERVICE_ACCOUNT_PKCS12_FILE_PATH))
            .build();
    Drive service = new Drive.Builder(httpTransport, jsonFactory, null)
            .setApplicationName("FileListAccessProject")
            .setHttpRequestInitializer(credential).build();

    return service;
} 
```

使用这个服务对象，我调用了 file.list

```
 private static List<File> retrieveAllFiles(Drive service)
        throws IOException {
    List<File> result = new ArrayList<File>();
    Files.List request = service.files().list();

    do {
        try {
            FileList files = request.execute();
            System.out.println(files);
            result.addAll(files.getItems());
            request.setPageToken(files.getNextPageToken());
        } catch (IOException e) {
            System.out.println("An error occurred: " + e);
            request.setPageToken(null);
        }
    } while (request.getPageToken() != null
            && request.getPageToken().length() > 0);
    // System.out.println(result);
    return result;
} 
```

但这是返回一个空的 Items 数组

```
{"etag":"\"8M2pZwE_fwroB5BIq5aUjc3uhqg/vyGp6PvFo4RvsFtPoIWeCReyIC8\"",
"kind":"drive#fileList","selfLink":"https://www.googleapis.com/drive/v2/files",
 "items":[]} 
```

有人可以帮我解决这个问题，我错过了什么吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T05:11:42.717

您正在使用[应用程序拥有的帐户](https://developers.google.com/drive/service-accounts)，该帐户类似于普通帐户，但属于应用程序而不是用户。

应用程序拥有的帐户没有特殊权限，并且作为普通帐户，只能访问他们拥有或与他们共享的文档。因此，如果您的常规帐户拥有这些文件，则服务帐户将无法列出它们。

您可以使用域范围的委派来允许您的应用代表 Google Apps 域中的其他用户访问文件：

[https://developers.google.com/drive/delegation](https://developers.google.com/drive/delegation)

# windows - Windows Azure - 在 Web 角色的虚拟目录中包含 WCF 服务

> ID：15283469
> 
> 赞同：0
> 
> 时间：2013-03-07T22:58:48.760
> 
> 标签：windows, wcf, azure, cloud

是否可以在 Azure 上的 Web 角色的虚拟目录中存在 wcf 服务角色（或不确定该词是否适合 Azure）。

例如：

```
www.mydomain.com                  <- contains the web role or website
www.mydomain.com/myservice.svc    <- contains the WCF service 
```

我看到有人建议您可以更改配置以允许虚拟目录，但是我已经 RDP 到两个 VM 中，它们似乎不共享磁盘上的相同文件。

我是 Azure 新手，请原谅术语。但是有可能做我想做的事吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T02:16:29.770

如果网站和 WCF 服务都在同一个 Web 角色中，则可以使用上面列出的 URL 访问它们。如果您执行以下操作，您将获得上述 URL：

1.  在 Visual Studio 中创建一个新的云项目，指定一个 Windows Azure 云服务。
2.  在提示符处，添加一个 MVC Web 角色。
3.  在下一个提示中，选择 Internet 应用程序并按 OK。
4.  创建项目后，右键单击 MVC 项目并选择 Add --> New Item --> WCF Service。
5.  按 F5。将显示默认的 ASP.NET MVC 主页。然后导航到`http://yourlocalhostaddress/Service1.svc`。您将看到新 WCF 服务的典型“您已创建服务”登录页面。

# c - 使用 atoi 填充整数数组

> ID：15283473
> 
> 赞同：5
> 
> 时间：2013-03-07T22:58:56.920
> 
> 标签：c, arrays, atoi

第一次在这里提问。抱歉，如果已经有关于此的主题，但我进行了一些搜索，并没有完全找到我认为我正在寻找的东西。我对 C 语言非常陌生，并且正在为我的微控制器系统课程做一些家庭作业。在我们进入嵌入式 C 之前，我们目前正在通过简单的练习，我正在尝试编写一个程序，该程序将接收一行由逗号分隔的 10 个数字组成的文本，并`int`用它填充一个 s 数组。作为提示，我们被告知使用`substring`and `atoi`。我想我已经接近正确了，但我无法让它正确输出我的数字。

另外，我不是在寻找勺子喂食的答案。现在，一些提示就足够了。在寻求解决方案之前，我想尝试自己弄清楚。

这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    int a[10];
    char str[] = {1,2,3,4,5,6,7,8,9,10}; //contains string of numbers
    int i;
    puts("This prints out ten numbers:");

    for (i = 0; i < 10; i++)
    {
        a[i] = atoi(str);
        printf("%d", a[i]);
            //i'm guessing the problem lies in one of the above two lines
    }
    return 0;
} 
```

这将输出以下内容：

```
This prints out ten numbers:
0000000000 
```

感谢任何可以提供帮助的人！克里斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:07:57.953

您说您必须使用由逗号分隔的一行文本，但您实际上已经声明了一个`char`包含十个（二进制）整数的数组。要将其转换为字符串，您只需执行以下操作：

`char str[] = "1,2,3,4,5,6,7,8,9,10";`

然后您需要以某种方式处理此字符串以将每个数字取出并放入您的`int`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:20:35.980

首先，您应该声明 a`string`如下：

```
char str[] = {"1,2,3,4,5,6,7,8,9,10"}; 
```

使`"`数字成为一个完整的字符串。接下来，您需要标记它们并使用`<string.h>`在这种情况下非常方便的库。

以下是您如何进行标记化：

首先定义一个令牌缓冲区：

```
char* token;

token = strtok(str,",");   //think of it as substring, the part of the str before the comma
for (i = 0; i < 10; i++)
{
    a[i] = atoi(token);
    printf("%d\t", a[i]);
            //i'm guessing the problem lies in one of the above two lines
    token = strtok(NULL, ","); //this line is also required for tokenizing the next element
} 
```

使用该`strtok()`函数，您将逗号之间的元素分开，并得到自己的数字字符串。使用`atoi()`函数将它们转换为整数并打印出来。您可以[查看此功能参考](http://www.cplusplus.com/reference/cstring/strtok/)以`strtok()`获得更好的理解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:01:10.150

问题在于您如何创建字符串。
请原谅我之前的回答，我误解了你的问题：

简单来说，声明应该如下：

```
char str[] = "1,2,3,4,5,6,7,8,9, 10, 12"; 
```

接下来，您可以使用 strtok 将字符串分隔为省略分隔符的字符串数组（在您的情况下为逗号），然后将数组成员传递给`atoi`

现在，为什么您的代码不起作用？
首先，字符应该被撇号包围，否则编译器会将您传递的数字作为 ASCII 值。

其次，C 中的数组是这样的： `char str[] = {'1', '2', '3', '4', '5'};`不要表示逗号分隔的字符串，这些逗号分隔 ARRAY 成员，每个成员都有自己的索引，而不是整个字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T23:07:15.150

您的定义`char str[] = {1,2,3,4,5,6,7,8,9,10};`实际上将字符的值设置为 1 到 10。

在 ASCII 字符图中，这些是不可打印的控制字符。写 '1' 而不是 1 会将值设置为 ASCII 值 1，即 0x31。

另一个错误是你定义中的逗号只分隔定义中的值，所以结果是一个没有任何分隔符的字符数组，所以 12345678910。

所以正确的方法是 `char str[] = "1,2,3,4,5,6,7,8,9,10";`

# objective-c - Objective C错误线程停止运行

> ID：15283476
> 
> 赞同：0
> 
> 时间：2013-03-07T22:59:07.680
> 
> 标签：objective-c, methods

我试图让我的代码运行，但它总是停止。你们谁能帮我解决这个问题。由于某种原因，它不会接受这一点。

```
-(Animal *) getAnimalAt:(int)input {
    //NSLog(@"show input %ld", input);
    Animal *ani = [animals objectAtIndex:input];
    return ani;
} 
```

我在我的主要方法中调用此方法：

```
for(int i=0;i< count;i++){
        Animal *ani = [farm getAnimalAt:i];
        NSLog(@"ani :  %@",[ani makeSound]);
        NSLog(@"ani :  %@",[ani doFly]);
    } 
```

如果您需要更多信息或代码，请询问。

你们中的任何人都找到了一个很好的教程吗？我好像找不到一个？或者像codingbat这样的网站会很有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:10:31.583

如果动物只是一个`NSArray`你可以删除该`getAnimalAt:`方法并只使用 NSArray。然后你可以做类似的事情：

```
for (Animal *ani in animals) {
    NSLog(@"ani :  %@", [ani makeSound]);
    NSLog(@"ani :  %@", [ani doFly]);
} 
```

这将防止任何`count`大于元素数量的问题`animals`

# python - 在 python/django 中具有列表字典的类别标题

> ID：15283478
> 
> 赞同：0
> 
> 时间：2013-03-07T22:59:16.300
> 
> 标签：python, django

假设我在 django 中有以下列表字典：

```
items = [{'category':'apple','item':'granny smith'},
 {'category':'apple','item':'cox'},
 {'category':'apple','item':'pixie'},
 {'category':'orange','item':'premier'},
 {'category':'orange','item':'queen'},
 {'category':'orange','item':'westin'},
 {'category':'tea','item':'breakfast'},
 {'category':'tea','item':'lady grey'},
 {'category':'tea','item':'builders'},
 {'category':'coffee','item':'colombia'},
 {'category':'coffee','item':'kenya'},
 {'category':'coffee','item':'brazil'}] 
```

如何让它显示在模板中，例如：

```
apple:
    granny smith
    cox
    pixie
orange:
    premier
    queen
    ... 
```

我应该在视图中还是在模板中执行此操作（我的意思是逻辑）？如果我只想显示列表的前五个，会发生什么？我需要一个不会给我空类别的解决方案

**编辑**

我必须承认这是对我的问题的过度简化，我处理的实际列表已经按`datetime`如下方式排序：

```
items.sort(key=lambda item:item['created'], reverse=True) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:17:57.253

[`defaultdict`](http://docs.python.org/2/library/collections.html#collections.defaultdict)用于按类别对所有项目进行分组的解决方案：

```
from collections import defaultdict

items = [{'category':'apple','item':'granny smith'},
 {'category':'apple','item':'cox'},
 {'category':'apple','item':'pixie'},
 {'category':'orange','item':'premier'},
 {'category':'orange','item':'queen'},
 {'category':'orange','item':'westin'},
 {'category':'tea','item':'breakfast'},
 {'category':'tea','item':'lady grey'},
 {'category':'tea','item':'builders'},
 {'category':'coffee','item':'colombia'},
 {'category':'coffee','item':'kenya'},
 {'category':'coffee','item':'brazil'}]

result = defaultdict(list)
for item in items:
    result[item['category']].append(item['item']) 
```

在模板中：

```
{% for key, values in result.items() %}
    <span>{{key}}</span>
    <ul>
    {% for item in values %}
        <li>{{item}}</li>
    {% endfor %}
    </ul>
{% endfor %} 
```

# css - nivo 滑块和下拉菜单的 Z-index 问题

> ID：15283481
> 
> 赞同：0
> 
> 时间：2013-03-07T22:59:24.773
> 
> 标签：css

我认为这个问题的答案会相对直截了当，但到目前为止还不能让它为我工作。

基本上在这个网址上，我有一个滑块，它一直位于从内衣链接下拉的下拉菜单上方。

[http://cocoslingerie.co.uk/](http://cocoslingerie.co.uk/)

我已将下拉菜单设置为比 nivo 滑块更高的 z-index，但仍然没有运气。

有人可以提出任何建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T23:40:34.793

@mgrahamjo 答案是正确的，只是想我会添加另一种有趣的方法来解决这个问题

```
.slider-wrapper{
  opacity: 0.99;
} 
```

它利用了 z-index、不透明度和堆叠的古怪特性。更深入的解释在这里：

[http://philipwalton.com/articles/what-no-one-told-you-about-z-index/](http://philipwalton.com/articles/what-no-one-told-you-about-z-index/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:33:42.530

您需要设置滑块最外层包装的位置和 z-index：

```
#slide .slider {
    position: absolute;
    z-index: 0;
} 
```

# prolog - 将递归转换为尾递归？

> ID：15283482
> 
> 赞同：3
> 
> 时间：2013-03-07T22:59:25.260
> 
> 标签：prolog, exponentiation, logic-programming

我正在尝试编写一个谓词，它递归地找到某个数字的 n 次方 [A^n = A * A^(n-1)] 并使用快捷方式 A^(2n) = A^n * A^n。

这是迄今为止的解决方案。

```
p(_,0,1):-!.
p(A,N,R):-N mod 2=0,!,N1=N/2,p(A,N1,R1),R=R1*R1.
p(A,N,R):-N1=N-1,p(A,N1,R1),R=R1*A. 
```

现在我想让这个尾递归。我可以为简单的情况做tail，例如没有捷径的阶乘和幂（通过添加一个累加器），但这很难。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T10:52:33.823

毕竟这似乎是可能的，只需从另一端开始：

```
pow(A,N,R) :-
    pow(A,N,A,1,R).

pow(_,N,R,N,R) :- !.
pow(A,N,Acc,M,R) :-
    M =< N div 2, !,
    M1 is M*2,
    NewAcc is Acc * Acc,
    pow(A,N,NewAcc,M1,R).
pow(A,N,Acc,M,R) :-
    M < N,
    M1 is M+1,
    NewAcc is A * Acc,
    pow(A,N,NewAcc,M1,R). 
```

它将快捷方式应用到小于 N 的 2 的最大幂，这与您的算法正在执行的操作不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T14:42:48.833

鲍里斯是对的，他的算法所做的与原来的不一样。但是，如果您真的想要，可以通过以下方式重现它：

请注意，您可以从数字的二进制表示中确定操作的顺序。让`N=7`，然后二进制`N=111`，表示为`N=7~111`。

现在您在原始算法中看到了该方案：

```
N      Op     N'
7~111  Mul    6~110 (= zero last bit) 
6~110  Squ    3~011 (= shift right)
3~011  Mul    2~010 
2~010  Squ    1~001
1~001  Base 
```

考虑到由于算法的递归性质，这些步骤是从上到下进行的，你得到`Base - Squ - Mul - Squ - Mul = ((A*A)*A)*((A*A)*A))*A = A**7`

将此与 Boris 的算法进行对比：

```
N      Op     N'
1~001  Squ    2~010 (=shift left)
2~010  Squ    4~100 (=shift left)
4~100  Mul    5~101 (=add one)
5~101  Mul    6~110 (=add one)
6~110  Mul    7~111 (=add one) 
```

`Mul, Squ`所以这个首先进行所有的移位，而原来的考虑除了 N 中的第一个之外的每个位，从右到左，如果该位被设置或只是`Squ`如果它未设置，则依次“排队”（因为自下而上）.

为了重现这种行为（更有效，因为你永远不会做比平方更简单的乘法），你可以从`N`二进制开始并执行以下操作（这里是一般的伪代码，你可以很容易地翻译成序言）：

```
Acc=A
for i in (reverse(tail(bits(N)))):
    Acc*=Acc
    if i==1:
       Acc*=A 
```

这是为了`N>=1`. `N=0`是一种特殊情况，必须分开处理。

我很确定这是正确的。如果您有疑问，请考虑您的原始算法：测试`mod 2 == 0`与测试最后一位是否为零是相同的。如果不是，那么减一与将最后一位归零相同，而加倍和减半只是在二进制中左移或右移。

# python - 如何分发我的 Python/shell 脚本？

> ID：15283483
> 
> 赞同：5
> 
> 时间：2013-03-07T22:59:25.650
> 
> 标签：python, bash, shell

我为自己编写了一个非常简单的命令行实用程序。设置包括：

1.  包含应用程序/源的单个 .py 文件。
2.  运行 python 脚本的单个可执行 (chmod +x) shell 脚本。
3.  我的 .bash_profile 中的一行给我的命令起别名，如下所示`alias cmd='. shellscript'`：（因此它在相同的终端上下文中运行。）

如此有效，我可以打字`cmd`来运行它，一切都很好。

我的问题是，如何将其分发给其他人？显然我可以用我的代码写出这些指令并完成它，但是有没有更快的方法？我偶尔会看到您粘贴到控制台中以安装某些东西的那些单行字。我该怎么做？我似乎记得他们涉及`curl`和管道，`sh`但我不记得了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:25:54.600

将您的脚本上传到[ideone 之](http://ideone.com/O2n3Pg)类的东西。然后告诉你的朋友把它输入`python`. 示例脚本：

```
def print_message():
    print "This is my very special script!"

if __name__ == "__main__":
    print_message() 
```

运行脚本示例：

```
username@server:~$ curl http://ideone.com/plain/O2n3Pg 2>/dev/null | python
This is my very special script! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:10:45.490

chmod +x cmd.py

然后他们可以输入 ./cmd.py

他们也可以通过管道使用它。

我要补充一点，unix 用户可能已经知道如何使文件可执行并运行它，因此您所要做的就是使文件对他们可用。

请确保他们知道运行脚本所需的 python 版本。

# ruby - 未初始化的常量 Model1::Model2::Model3

> ID：15283487
> 
> 赞同：3
> 
> 时间：2013-03-07T22:59:32.017
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.2

我`uninitialized constant Project::Forum::Topic`正在

```
app/controllers/home_controller.rb:46:in `discussions' 
```

我有下面的代码，我正在从 转换`rails 2.3.x`为`rails 3.2.11`，我认为`routes`设置有问题。

任何想法我该如何解决？

**楷模**

```
class Project < ActiveRecord::Base
      # Relations under project model
      has_many :features, :dependent => :destroy
      has_many :forums, :class_name=>'Forum::Forum'
      has_many :topics, :class_name=>'Forum::Topic', :through=>:forums
class Forum::Forum < Feature
  # Relations under forum model
  has_many :topics, :class_name => 'Forum::Topic', :dependent => :destroy

class Feature < ActiveRecord::Base
  # Relations under feature model
  belongs_to :project

class Forum::Topic < ActiveRecord::Base
   # Relations under topic model
   belongs_to :forum, :foreign_key => :forum_id, :class_name => 'Forum::Forum', :include => :project 
```

**home_controller.rb**

```
def discussions
  @project ||= Project.find_by_name 'help'
  @forums = @project.forums
  @topics = @project.topics.recent # HERE I AM GETTING ERRORS
end 
```

**路线.rb**

```
scope :home, :controller => "home", :activity => 'read' do
 get :discussions, :path => '/forums', :service_type => 'public'
 get :forums, :action => "discussions"
end 
```

**错误**

```
uninitialized constant Project::Forum::Topic
app/controllers/home_controller.rb:46:in `discussions' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:54:43.483

我刚刚通过rails论坛回答了，再次在这里，

在您的项目模型类中，更改以下方式

老的：`has_many :topics, :class_name=>'Forum::Topic', :through=>:forums`

新的：`has_many :topics, :class_name=>'::Forum::Topic', :through=>:forums`

它应该工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:54:52.843

如果你自动加载那个类（也就是说，你不加载`require`它的源文件），原因可能是 Ruby 的 bug`autoload`无法自动加载嵌套 3 次或更多次的常量。

目前，我在互联网上找不到此信息的来源；但是，我记得它应该用 Ruby 2.0 解决，所以你可以修复它，从 删除你需要的文件，在你需要的地方`autoload`添加一个`require 'project/forum/topic'`，或者升级到 Ruby 2.0。

# java - 以随机顺序显示 CardLayout 的卡片？

> ID：15283488
> 
> 赞同：2
> 
> 时间：2013-03-07T22:59:41.163
> 
> 标签：java, swing, user-interface, layout-manager, cardlayout

我想在我的 CardLayout 中显示卡片或屏幕的随机顺序。我需要有关如何完成此任务的指导。我应该使用什么策略？

我尝试使用下面的代码，但它的顺序是固定的。我希望能够选择我喜欢的任何顺序。

**编辑 ！**

抱歉，按随机顺序，我不是指洗牌。但是，很高兴知道。我希望程序的用户能够输入一些输入。根据输入的值，显示特定的屏幕/卡片。

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

public class CardLayoutExample extends JFrame {

private int currentCard = 1;
private JPanel cardPanel;
private CardLayout cl;

public CardLayoutExample() {

    setTitle("Card Layout Example");
    setSize(300, 150);
    cardPanel = new JPanel();

    cl = new CardLayout();
    cardPanel.setLayout(cl);
    JPanel p1 = new JPanel();
    JPanel p2 = new JPanel();
    JPanel p3 = new JPanel();
    JPanel p4 = new JPanel();
    JLabel lab1 = new JLabel("Card1");
    JLabel lab2 = new JLabel("Card2");
    JLabel lab3 = new JLabel("Card3");
    JLabel lab4 = new JLabel("Card4");
    p1.add(lab1);
    p2.add(lab2);
    p3.add(lab3);
    p4.add(lab4);

    cardPanel.add(p1, "1");
    cardPanel.add(p2, "2");
    cardPanel.add(p3, "3");
    cardPanel.add(p4, "4");
    JPanel buttonPanel = new JPanel();
    JButton b1 = new JButton("Previous");
    JButton b2 = new JButton("Next");
    buttonPanel.add(b1);
    buttonPanel.add(b2);
    b1.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {
            if (currentCard > 1) {
                currentCard -= 1;
                cl.show(cardPanel, "" + (currentCard));
            }
        }
    });

    b2.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {
            if (currentCard < 4) {
                currentCard += 1;
                cl.show(cardPanel, "" + (currentCard));
            }
        }
    });
    getContentPane().add(cardPanel, BorderLayout.NORTH);
    getContentPane().add(buttonPanel, BorderLayout.SOUTH);
}

public static void main(String[] args) {
    CardLayoutExample cl = new CardLayoutExample();
    cl.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    cl.setVisible(true);
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T23:01:08.017

将 CartLayouts 放入列表中，打乱列表，按列表顺序添加到包含布局。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T07:27:14.450

这是直接跳转到卡片的简单方法。

```
final JButton jumpTo = new JButton("Jump To");
buttonPanel.add(jumpTo);
jumpTo.addActionListener( new ActionListener(){
    @Override
    public void actionPerformed(ActionEvent ae) {
        String[] names = {"1","2","3","4"};
        String s = (String)JOptionPane.showInputDialog(
            jumpTo,
            "Jump to card",
            "Navigate",
            JOptionPane.QUESTION_MESSAGE,
            null,
            names,
            names[0]);
        if (s!=null) {
            cl.show(cardPanel, s);
        }
    }
} ); 
```

显然，这将需要对其余代码进行一些更改。这是一个SSCCE。

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

public class CardLayoutExample extends JFrame {

private int currentCard = 1;
private JPanel cardPanel;
private CardLayout cl;

public CardLayoutExample() {

    setTitle("Card Layout Example");
    setSize(300, 150);
    cardPanel = new JPanel();

    cl = new CardLayout();
    cardPanel.setLayout(cl);
    JPanel p1 = new JPanel();
    JPanel p2 = new JPanel();
    JPanel p3 = new JPanel();
    JPanel p4 = new JPanel();
    JLabel lab1 = new JLabel("Card1");
    JLabel lab2 = new JLabel("Card2");
    JLabel lab3 = new JLabel("Card3");
    JLabel lab4 = new JLabel("Card4");
    p1.add(lab1);
    p2.add(lab2);
    p3.add(lab3);
    p4.add(lab4);

    cardPanel.add(p1, "1");
    cardPanel.add(p2, "2");
    cardPanel.add(p3, "3");
    cardPanel.add(p4, "4");
    JPanel buttonPanel = new JPanel();
    JButton b1 = new JButton("Previous");
    JButton b2 = new JButton("Next");
    buttonPanel.add(b1);
    buttonPanel.add(b2);
    b1.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {
            if (currentCard > 1) {
                currentCard -= 1;
                cl.show(cardPanel, "" + (currentCard));
            }
        }
    });

    b2.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent arg0) {
            if (currentCard < 4) {
                currentCard += 1;
                cl.show(cardPanel, "" + (currentCard));
            }
        }
    });

    final JButton jumpTo = new JButton("Jump To");
    buttonPanel.add(jumpTo);
    jumpTo.addActionListener( new ActionListener(){
        @Override
        public void actionPerformed(ActionEvent ae) {
            String[] names = {"1","2","3","4"};
            String s = (String)JOptionPane.showInputDialog(
                jumpTo,
                "Jump to card",
                "Navigate",
                JOptionPane.QUESTION_MESSAGE,
                null,
                names,
                names[0]);
            if (s!=null) {
                cl.show(cardPanel, s);
            }
        }
    } );

    getContentPane().add(cardPanel, BorderLayout.NORTH);
    getContentPane().add(buttonPanel, BorderLayout.SOUTH);
}

public static void main(String[] args) {
    CardLayoutExample cl = new CardLayoutExample();
    cl.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    cl.setVisible(true);
}
} 
```

顺便说一句 - 我的评论*“提示用户输入卡号的代码部分在哪里？”* 实际上是一种非常微妙的尝试和交流方式。 *为了尽快获得更好的帮助，请发布[SSCCE](http://sscce.org/)。*

# javascript - ScriptManager 不加载 Mono 下的 javascript 方法

> ID：15283493
> 
> 赞同：1
> 
> 时间：2013-03-07T22:59:56.170
> 
> 标签：javascript, asp.net, apache, mono

我一直在努力解决我在使用 asp.net ScriptManager.RegisterStartupScript() 时遇到的这个问题。

代码行如下 -

```
string script = string.Format("initGame('{0}','{1}');", var1, var2);

ScriptManager.RegisterStartupScript(Page, typeof(Page), "mainGameScript", script, true); 
```

该页面托管在运行 apache 2 和 mono 的 Ubuntu 机器上。无论我在 RegisterStartupScript 中写什么都行不通。

我尝试过的事情 -

1.  带有 IIS 的 Windows Server - 完美运行
2.  在调用 ScriptManager 之前立即输出一些 Web 文本 - 有效
3.  在调用“initGame()”方法的按钮中编码 - 有效
4.  将 javascript 直接放入 RegisterStartupScript 调用中 - 不起作用
5.  将javascript放在页面中 - 有效

对我来说，ScriptManager 行似乎存在问题，要么是微不足道的，要么是我需要做/更改以使其在 Mono 下运行的事情。如果你想看看，网址是[www.zephyrisgames.net/zephyrisgalaxies/Main.aspx](http://www.zephyrisgames.net/zephyrisgalaxies/Main.aspx)

谢谢，如果您需要更多信息，请告诉我，我会尽力制作它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T01:18:04.883

在对此一头雾水之后，我越来越确信 ScriptManager 存在问题。我什至从 repos 中安装了 Mono 3.07，但仍然没有解决任何问题。

解决它的方法是将 ScriptManager 替换为 ClientScript 类。该方法保持不变，尽管 ClientScript 类下的 RegisterStartupScript() 没有添加脚本标签的选项。

一个简单的补救措施如下 -

```
string tagStart = "<script type=\"text/javascript\">";
string tagEnd = "</script>";
string script = string.Format("initGame('{0}','{1}');", var1, var2);

script = tagStart + script + tagEnd;

if (!Page.ClientScript.IsStartupScriptRegistered("mainGameScript"))
{
     //ScriptManager.RegisterStartupScript(Page, typeof(Page), "mainGameScript", script, true);
     // Left in for historical purpose

    ClientScript.RegisterStartupScript(typeof(Page), "mainGameScript", script);
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-28T10:17:55.713

我遇到了同样的问题。如果在异步回发（ASP.NET 2.0、Ubuntu Server 13.10）中，“ScriptManager.RegisterStartupScript”不起作用。如果页面是第一次加载，它会很好地工作。

在浏览了 [https://github.com/mono/mono/blob/master/mcs/class/System.Web.Extensions/System.Web.UI/ScriptManager.cs](https://github.com/mono/mono/blob/master/mcs/class/System.Web.Extensions/System.Web.UI/ScriptManager.cs)上的 Mono 源代码后， 我看到有一些预将脚本添加到最终输出的编译器内容：

```
switch (scriptEntry.ScriptType) {
  case RegisteredScriptType.ClientScriptBlock:
    if (scriptEntry.AddScriptTags)
      WriteCallbackOutput(output, scriptBlock, scriptContentNoTags, scriptEntry.Script);
    else
      WriteCallbackOutput(output, scriptBlock, scriptContentWithTags, SerializeScriptBlock(scriptEntry));
    break;
#if NET_3_5
  case RegisteredScriptType.ClientStartupScript:
    if (scriptEntry.AddScriptTags)
      WriteCallbackOutput (output, scriptStartupBlock, scriptContentNoTags, scriptEntry.Script);
    else
      WriteCallbackOutput (output, scriptStartupBlock, scriptContentWithTags, SerializeScriptBlock (scriptEntry));
    break;
#endif
  case RegisteredScriptType.ClientScriptInclude:
    WriteCallbackOutput(output, scriptBlock, scriptPath, scriptEntry.Url);
    break;
  case RegisteredScriptType.OnSubmitStatement:
    WriteCallbackOutput(output, onSubmit, null, scriptEntry.Script);
    break;
} 
```

也许有人忘记定义“NET_3_5”，所以这部分不起作用。此外，在初始页面加载时，“ScriptManager.RegisterStartupScript”实际上调用了“ClientScript.RegisterStartupScript”（这就是它在这种情况下工作的原因）。

我的解决方案是使用“ScriptManager.RegisterClientScriptBlock”模拟行为（按预期工作）：

```
/// <summary>
/// Always adds script tags.
/// </summary>
public static void ScriptManagerRegisterStartupScript(Control control, Type type, string key, string script){
  if (!ScriptManager.GetCurrent(control.Page).IsInAsyncPostBack)
    control.Page.ClientScript.RegisterStartupScript(type, key, script, true);
  else {
    string hName = String.Format("h{0}", Guid.NewGuid().ToString("N"));  // Lazy way to get a unique name
    ScriptManager.RegisterClientScriptBlock(control, type, key,
      "function " + hName + " () {" + 
      "Sys.WebForms.PageRequestManager.getInstance().remove_pageLoaded(" + hName + ");" +
      script +  // This is why we do not support "addScriptTags==false"
      "}" +
      "Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(" + hName + ");",
      true);
  }
} 
```

# python - 如何使用 TDD 创建现有对象的数据库表示？

> ID：15283496
> 
> 赞同：1
> 
> 时间：2013-03-07T23:00:09.573
> 
> 标签：python, database, django, tdd

我使用 TDD 在 Python 中开发了一组类。这些对象包含数据字段、函数和彼此的链接。一切功能都按我的意愿工作。

最终，所有这些都应该存储在数据库中，以便在 Django Web 应用程序中使用。

我已经勾勒出一些可能的数据库模式来保存相同的信息，但与开发应用程序其余部分的传统 TDD 方式相比，我觉得这是一个“突然的大飞跃”。

所以，现在我想知道，我应该编写哪些测试来强制我以逐步 TDD 的方式将这些对象存储在数据库中？

使这个问题更具体一点，这些类目前是这样的：

```
class Connector(object):
  def __init__(self, title = None):
    self.value = None
    self.valid = False
    self.title = title
  ...

class Element(object):
  def __init__(self, title = None):
    self.title = title
    self.input_connectors = []
    self.output_connectors = []
    self.number_of_runs = 0

  def run(self):
    ...
    self.number_of_runs += 1

class Average(Element):
  def __init__(self, title = None):
    super(OpenCVMean, self).__init__(title = title)
    self.src = Connector("source")
    self.avg = Connector("average")
    self.input_connectors.append(self.src)
    self.output_connectors.append(self.avg)

  def run(self):
    super(Average, self).run()
    self.avg.set_value(numpy.average(self.src.value)) 
```

我意识到一些数据应该在数据库中，而处理函数不应该。我认为应该有一个表来表示 Element 的不同“类型/子类”的详细信息，同时也应该有一个存储实际实例的表。但是，正如我所说，我不知道如何使用 TDD 到达那里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:21:38.623

首先，问问自己你是要测试你的代码还是 Django ORM。大多数情况下，存储和阅读都可以。

您需要测试的内容是验证数据和任何不是模型字段的属性。我认为您应该通过在数据库的下一层编写测试来最终获得一个好的模式。

此外，使用[South](http://south.aeracode.org/)或其他一些迁移方式来降低架构更改的成本。这会让你安心一些。

如果您有多个级别的测试（例如集成测试），那么检查数据库配置是否完整是有意义的。大多数测试不需要命中数据库。您可以通过模拟模型或一些数据库操作（至少`save()`）来做到这一点。话虽如此，您可以通过这个简单的测试检查数据库写入和读取：

```
def test_db_access(self):
    input = Element(title = 'foo')
    input.save()

    output = Element.objects.get(title='foo')

    self.assertEquals(input, output) 
```

模拟保存：

```
def save(obj):
    obj.id = 1 
```

# delphi - IdTcpServer 崩溃

> ID：15283498
> 
> 赞同：1
> 
> 时间：2013-03-07T23:00:18.930
> 
> 标签：delphi, indy, tcpserver

![在此处输入图像描述](../Images/ea8b8500d0d9ec09b40828a60ee86571.png) ![在此处输入图像描述](../Images/687fd2c39b0577790e1d111c2171f3a9.png)

我正在使用 indy 的 tcp 服务器/客户端，一切正常（修复了一些错误），但有一个错误困扰着我。

当我冻结所有线程然后终止 tcp 客户端的进程时，服务器崩溃并在 tcpserver 中不停地引发该错误^。

有没有办法处理 Delphi 6 中的错误和其他套接字错误并防止服务器崩溃（我使用的是 delphi 6 / windows 8 64 位（可能不需要，但我从未在我的 win 7 上测试过，所以... )/ indy 9 / Indy TCP 服务器和客户端)？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T23:18:28.017

您的服务器没有崩溃。 客户端连接关闭/丢失时遇到`EIdSocketError`的完全正常的异常。`TIdTCPServer`那是正常的行为。 `TIdTCPserver`如果异常逃逸到服务器中，将为您在内部处理它并关闭套接字（您应该允许它这样做 - 如果您自己捕获它，完成后重新引发它）。您看到异常的唯一原因是调试器在您的应用程序看到它之前报告了它。只需按 F9 让调试器将其传递给应用程序进行正常处理，或者将调试器配置为忽略`EIdException`基于 Indy 的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T20:27:04.700

请确保您使用的 Indy 版本比 D7 中安装的版本更新（您需要先删除旧版本）。有崩溃的线程错误 < 9.0.18

# java - 杰克逊反序列化 - 聚合几个字段

> ID：15283502
> 
> 赞同：2
> 
> 时间：2013-03-07T23:00:27.933
> 
> 标签：java, json, jackson, deserialization, aggregation

假设我在 JSON 中有一组这样定义的人。

```
{
        "NOM": "Doe",
        "PRENOM": "John",
        "EMAIL": "john.doe@email.me",
        "VILLE": "Somewhere",
        "LIKE1": "Lolcats",
        "LIKE2": "Loldogs",
        "LIKE3": "Lolwut",
        "HATE1": "Bad stuff",
        "HATE2": "Bad bad stuff"
} 
```

是否可以编写一个 JsonDeserializer，它将LIKE* 和 HATE* 字段**聚合**并转换为 Liking 的集合，设置为 Person 的属性？（注意只有 LIKE1、LIKE2、LIKE3、HATE1、HATE2。）

最终结果属性将类似于：

```
public class Person {
    private final String lastName;
    private final String firstName;
    private final String email;
    private final String town;
    private final Collection<Liking> likings;
    // c-tor, getters
} 
```

我已经有可以将给定的 LIKE*/HATE* 属性反序列化为喜欢对象的逻辑，但我无法理解将它们聚合并将它们添加到 Person 喜欢属性。

提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:32:55.113

我很确定你不能按照你想要的方式做，像这样做怎么样：

```
{
        "NOM": "Doe",
        "PRENOM": "John",
        "EMAIL": "john.doe@email.me",
        "VILLE": "Somewhere",
        "likings": ["Lolcats", "Loldogs", "LIKE3": "Lolwut", "Bad stuff", "Bad bad stuff" ]
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:49:37.080

如果你有一些代码显示你开始自己解决这个问题，那就太好了。但是，这是一个示例自定义反序列化器，它几乎可以满足您的需求：

```
class PersonDeserializer extends JsonDeserializer<Person> {

    @Override
    public Person deserialize(final JsonParser parser,
            final DeserializationContext content) throws IOException,
            JsonProcessingException {

        final ObjectCodec codec = parser.getCodec();
        final JsonNode node = codec.readTree(parser);

        final Person person = new Person();
        final Iterator<String> fieldNameIter = node.getFieldNames();
        while (fieldNameIter.hasNext()) {
            final String fieldName = fieldNameIter.next();
            if (fieldName.equalsIgnoreCase("EMAIL")) {
                person.setEmail(node.get(fieldName).getTextValue());
            } else if (fieldName.equalsIgnoreCase("NOM")) {
                person.setFirstName(node.get(fieldName).getTextValue());
            } else if (fieldName.equalsIgnoreCase("PRENOM")) {
                person.setLastName(node.get(fieldName).getTextValue());
            } else if (fieldName.equalsIgnoreCase("VILLE")) {
                person.setTown(node.get(fieldName).getTextValue());
            } else if (fieldName.startsWith("LIKE")) {
                person.addLike(Liking.LikingType.LIKE, node.get(fieldName)
                        .getTextValue());
            } else if (fieldName.startsWith("HATE")) {
                person.addLike(Liking.LikingType.HATE, node.get(fieldName)
                        .getTextValue());
            }
        }

        return person;
    }
} 
```

它假定一个`Liking`与此类似的对象：

```
public class Liking {
    public static enum LikingType {
        LIKE, HATE;
    }

    private LikingType type;

    private String value;

    // Constructors, getters/setters
} 
```

`Person`我认为你可以弄清楚你的对象的一些变化。如果您打算以相同的自定义格式将对象序列化为 JSON，则必须编写相应的`JsonSerializer`.

另一种不太可靠的选择是过于简单地使用地图来完全按原样存储好恶。该解决方案将省略喜欢/不喜欢的任何显式映射，并利用`@JsonAny`注释来捕获它们。在这个方案中，Person 对象看起来像这样：

```
public class Person {
    private String lastName;
    private String firstName;
    private String email;
    private String town;
    @JsonAny
    private Map<String, Object> otherProperties;

    // Constructors, getters/setters
} 
```

将您的 JSON 反序列化为这个修改后的版本，`Person`会将所有无法识别的属性作为键值对放入哈希映射中。

# cordova - Phonegap InAppBrowser 退出不停止视频播放

> ID：15283505
> 
> 赞同：4
> 
> 时间：2013-03-07T23:00:33.347
> 
> 标签：cordova, inappbrowser

使用 PhoneGap`InAppBrowser`时，我正在加载带有视频的页面。如果我播放该视频并关闭`InAppBrowser`视频播放继续。我一直在寻找这个问题的答案。关闭时如何停止播放或删除连接`InAppBrowser`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T00:54:43.250

我找到了解决方案。您想要做的是将目标设置为从`_blank`到`_self`将导致它在您点击后退按钮时停止播放。

`var ref = window.open(url, '_self', options);`

[窗口打开](http://docs.phonegap.com/en/2.5.0/cordova_inappbrowser_inappbrowser.md.html#window.open)

# opengl - 低多边形锥 - 尖端的平滑阴影

> ID：15283508
> 
> 赞同：7
> 
> 时间：2013-03-07T23:00:45.443
> 
> 标签：opengl, 3d, geometry, directx, mesh

如果你将一个圆柱体细分为一个 8 面棱柱体，根据它们的位置计算顶点法线（“平滑着色”），它看起来还不错。

如果你将一个锥体细分为一个 8 面金字塔，根据它们的位置计算法线，你会卡在锥体的尖端（技术上是锥体的顶点，但我们称它为尖端以避免与网格顶点混淆） .

![8 面圆柱体与圆锥体](../Images/4695652cd724e5776410f37b7025cb26.png)

对于每个三角形面，您都希望匹配两条边的法线。但是因为您只能在三角形的每个顶点指定一条法线，所以您可以匹配一条边或另一条边，但不能同时匹配两者。您可以通过选择作为两个边缘平均值的尖端法线来妥协，但现在您的边缘看起来都不好。这是为每个尖端顶点选择平均法线的详细信息。

![具有尖端平均的面部细节](../Images/b425ce85452cde677e6f830a7f22605a.png)

在一个完美的世界中，GPU 可以光栅化一个真正的四边形，而不仅仅是三角形。然后我们可以用退化四边形指定每个面，允许我们为每个三角形的两个相邻边指定不同的法线。但是我们所要做的只是三角形......我们可以将锥体切割成多个“堆叠”，这样边缘不连续性只在锥体的尖端可见，而不是在整个物体上可见，但仍然会有小费！

有人对平滑阴影的低多边形锥体有任何技巧吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-05-12T13:01:25.987

我在由三角形组成的现代 OpenGL（即着色器）中苦苦挣扎，但后来我发现了一个非常简单的解决方案！我会说它比当前接受的答案中建议的要好得多，也更简单。

我有一组三角形（显然每个都有 3 个顶点），它们形成了锥面。我不关心底面（圆形底座），因为这真的很简单。在我所有的工作中，我使用以下简单的顶点结构：

*   `position: vec3`（通过添加 1.0f 作为最后一个元素，在着色器中自动转换为 vec4）

*   `normal_vector: vec3`（在着色器中保留为 vec3，因为它用于计算光方向的点积）

*   `color: vec3`（我没有使用透明度）

在我的顶点着色器中，我只变换顶点位置（乘以投影和模型视图矩阵）并变换法线向量（乘以模型视图矩阵的变换逆矩阵）。然后将转换后的位置、法线向量和未转换的颜色传递给片段着色器，在其中我计算光方向和法线向量的点积，并将这个数字与颜色相乘。

让我从我所做的并发现不令人满意的事情开始：

**尝试#1**：每个圆锥面（三角形）都使用恒定的法向量，即一个三角形的所有顶点具有相同的法向量。这很简单，但没有实现平滑的光照，每个面都有一个恒定的颜色，因为三角形的所有片段都具有相同的法向量。错误的。

**尝试#2**：我分别计算了每个顶点的法线向量。这对于圆锥体圆形底部的顶点来说很容易，但是圆锥体的尖端应该使用什么？我使用了整个三角形的法线向量（即与尝试#相同的值）。好吧，这更好，因为我在靠近锥体底部的部分有平滑的照明，但在尖端附近不平滑。错误的。

但后来我找到了解决方案：

**尝试#3**：除了**我在锥尖顶点中分配的法向量等于零向量 vec3(0.0f, 0.0f, 0.0f) 之外，我按照尝试#2 进行了所有操作。这是诀窍的关键！**然后这个零法线向量被传递给片段着色器，（即在顶点和片段着色器之间，它会自动插入其他两个顶点的法线向量）。当然**，您需要对片段（！）着色器中的向量进行归一化，**因为它没有恒定的大小 1（我需要点积）。所以我对其进行归一化——当然这对于法向量的大小为零的锥体尖端是不可能的。但它适用于所有其他点。就是这样。

有一件重要的事情要记住，要么你只能在片段着色器中对法线向量进行归一化。如果您尝试在 C++ 中对零大小的向量进行归一化，肯定会出错。因此，如果由于某种原因在进入片段着色器之前需要归一化，请确保排除大小为零的法线向量（即圆锥的尖端，否则会出错）。

这会在除锥尖点之外的所有点产生平滑的锥体阴影。但这一点并不重要（谁在乎一个像素......）或者你可以用一种特殊的方式来处理它。另一个优点是您甚至可以使用非常简单的着色器。唯一的变化是在片段着色器中而不是在顶点着色器甚至之前对法线向量进行归一化。

[![这里是光滑圆锥的例子](../Images/ddcba995232846b2a11e7ca4506a0f9e.png)](https://i.stack.imgur.com/rNkO9.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-17T17:02:12.510

是的，这当然是三角形的限制。我认为当您从圆柱体接近圆锥体时显示问题会使问题变得非常清楚：

![在此处输入图像描述](../Images/38aff5b5bfda535c643260460903bb43.png)

这里有一些你可以尝试的东西......

1.  使用四边形（如@WhitAngl 所说）。对新的 OpenGL而言，毕竟有四边形的用途*。*

2.  镶嵌得更均匀一些。将尖端的法线设置为一个共同的向上矢量可以消除任何粗糙的边缘，尽管在没有照明的一侧看起来有点奇怪。不幸的是，这违背了你的问题标题，*低多边形锥*。

    ![在此处输入图像描述](../Images/e91f106e3736187744478e4be192b088.png)

3.  确保您的锥体以对象空间原点为中心（或在顶点着色器中程序生成它），使用片段位置生成法线...

    ```
    in vec2 coneSlope; //normal x/z magnitude and y
    in vec3 objectSpaceFragPos;

    uniform mat3 normalMatrix;

    void main()
    {
        vec3 osNormal = vec3(normalize(objectSpaceFragPos.xz) * coneSlope.x, coneSlope.y);
        vec3 esNormal = normalMatrix * osNormal;
        ...
    } 
    ```

    也许你也可以做一些花哨的技巧来减少片段着色器操作。然后是细分更多与更昂贵着色器的整体平衡。

锥体是一个相当简单的物体，虽然我喜欢这个挑战，但实际上我看不出这是一个问题，除非你想要*很多*锥体。在这种情况下，您可能会进入几何着色器或实例化。更好的是，您可以在片段着色器中使用四边形和光线投射隐式锥体来绘制锥体。如果锥体都在一个平面上，您可以尝试法线贴图甚至视差贴图。

# javascript - 使用 JS 和 DOM 为多个 DIV 元素设置动画会导致低帧率

> ID：15283511
> 
> 赞同：6
> 
> 时间：2013-03-07T23:00:50.873
> 
> 标签：javascript, html, google-chrome, dom, frame-rate

## 前言

我刚开始使用 javascript 进行编程，目前正在开发我的这个爱好网站项目。该站点应该显示充满产品图像的页面，而不是可以“平移”到左侧或右侧。每个“页面”包含大约 24 张中等大小的图片，一页几乎完全填满了整个屏幕。当用户选择查看下一页时，他需要单击'n'向左拖动（例如）以让新页面（通过 AJAX 脚本动态加载）滑入视图。

## 问题

这需要我的 javascript 以屏幕宽度同步“滑动”其中两个提到的页面。这导致帧率非常低。Firefox 和 Opera 有点滞后，Chrome 尤其糟糕：1 帧动画大约需要 1 帧。100 毫秒，从而使动画看起来很“滞后”。

我不使用 jQuery，也不想使用它或任何其他库来“为我工作”。至少在我确定我正在尝试做的事情不能用几行自写的代码来完成之前是这样。

到目前为止，我已经发现我操作 DOM 的特定方式会导致性能下降。例程如下所示：

```
function slide() {
  this.t = new Date().getTime() - this.msBase;

  if( this.t > this.msDura ) {
    this.callB.call(this.ref,this.nFrames);
    return false;
  }

  //calculating the displacement of both elements

  this.pxProg = this.tRatio * this.t;

  this.eA.style.left = ( this.pxBaseA + this.pxProg ) + 'px';
  this.eB.style.left = (this.pxBaseB + this.pxProg) + 'px';

  if ( bRequestAnimationStatus )
    requestAnimationFrame( slide.bind(this) );
  else
    window.setTimeout( slide.bind(this), 16 );

  this.nFrames++;

}

//starting an animation

slide.call({
  eA:      theMiddlePage,
  eB:      neighboorPage, 
  callB:   theCallback,
  msBase:  new Date().getTime(),
  msDura:  400,
  tRatio:  ((0-pxScreenWidth)/400),
  nFrames: 0,
  ref:     myObject,
  pxBaseA: theMiddlePage.offsetLeft,
  pxBaseB: neighboorPage.offsetLeft
}); 
```

## 问题

我注意到当我让 AJAX 脚本在每个页面中加载更少的图像时，动画变得更快。单独的图像似乎比我预期的要产生更多的开销。

还有另一种方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T03:49:13.077

JAVASCRIPT 解决方案

好的，您可以尝试两种方法来加快速度。

首先，当您修改元素的样式时，您会强制浏览器重新呈现页面。这称为重绘。某些更改还会强制重新计算页面的几何形状。这称为回流。回流总是在它之后立即触发重绘。我认为为什么您在使用更多元素时会遇到更差的性能是因为对每个元素的每次更新都会触发至少一次重绘。通常建议在单个元素上修改多个样式时，要么通过添加或删除一个类一次全部完成它们，要么隐藏元素，进行操作，然后显示它，这意味着只有两次重绘（并可能回流）。

看来在这种特殊情况下，您可能已经做得很好了，因为您每次迭代只操作每个项目一次。

其次，requestAnimationFrame() 非常适合在画布元素上制作动画，但在 DOM 元素上的表现似乎有些不靠谱。在 Chrome 的分析器中打开您的页面以查看它挂断的确切位置。尝试使用 setTimeout() 来查看最终是否是这种情况。同样，分析器会告诉你挂断在哪里。requestAnimationFrame() 应该更好，但请验证这一点。以前，我已经适得其反了。

真正的解决方案

如果可以避免的话，不要在 JavaScript 中这样做。使用 CSS 过渡和翻译，通过注册为每个动画元素的 onTransitionEnd 事件处理程序的 JavaScript 函数来制作动画。让浏览器原生地做这些事情几乎总是比任何人编写的任何 JS 代码都要快。

唯一的问题是 CSS3 动画仅由较新的浏览器支持。为了你自己的造就，这样做。对于真正的实际应用程序，委托给一个库。如果可能的话，一个好的库会在本地完成它，并回退到在 JS 中为旧浏览器执行它的最佳方式。

阅读有关这些内容的好链接：http: [//www.html5rocks.com/en/tutorials/speed/html5/](http://www.html5rocks.com/en/tutorials/speed/html5/)

# c++ - 如何使立方体在 Open GL，C++ 中沿 Y 轴平滑下落

> ID：15283522
> 
> 赞同：0
> 
> 时间：2013-03-07T23:01:26.160
> 
> 标签：c++, opengl, game-physics

我正在尝试为一个学校项目创建一个非常简单的物理模拟器，我想要它做的就是有一个立方体，它会因重力而落下露水，当它撞到地板上时它会反弹等等，直到立方体没有能量并且它将停止移动，例如在地板上休息。我还没有添加碰撞检测，但大多数其他事情都很好，我唯一的问题是立方体不能平稳下降它非常跳跃，例如它下降并加速然后减速然后再次加速，我有不知道为什么。

我已包含以下代码：

```
timestep++;
velo += 0.005;
cout << velo << "\n";
glTranslatef(0.0, -velo, 0.0);//timestep * gravity, 0.0); 
```

我还包含了整个程序代码，以防万一它是其他地方的探针，上面的摘录就在显示功能的顶部

```
#include <GLTools.h>
#include <GLShaderManager.h>
#include <GLFrustum.h>
#include <GLBatch.h> 
#include <GLFrame.h>
#include <GLMatrixStack.h>
#include <GLGeometryTransform.h>
#include <StopWatch.h>

#include <math.h>
#include <stdio.h>

#ifdef __APPLE__
#include <glut/glut.h>
#else
#define FREEGLUT_STATIC
#include <GL/glut.h>
#endif

#include <iostream>;
using namespace std;

void display();
void specialKeys(int, int, int);
void animate();

double rotate_y = 0;
double rotate_x = 0;

// Gravity Varibles
int timestep = 0;
float gravity = 0.0098;
float velo = 0.0f;

int main( int argc, char* argv[] )
{
    glutInit(&argc, argv);
    glutInitDisplayMode( GLUT_DOUBLE | GLUT_RGBA | GLUT_DEPTH | GLUT_STENCIL );
    glutCreateWindow("DANIELS CUBE");
    glEnable(GL_DEPTH_TEST);
    glShadeModel(GL_SMOOTH);

    glutDisplayFunc(display);
    glutSpecialFunc(specialKeys);
    glutIdleFunc(animate);

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(-2.0, 2.0, -2.0, 2.0, -2.0, 2.0);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    gluLookAt(5.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0);
    glutMainLoop();

    return 0;
}

void animate()
{
    glutPostRedisplay();
}

void display()
{
    //Clears the window
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    // Changes the way the polygons are drawn so it looks like a wire frame
    glPolygonMode(GL_FRONT_AND_BACK, GL_LINE);

    ///////////
    // CUBE ///
    ///////////

    // Resets the transformation matrix
    glLoadIdentity();
    glScalef(0.2, 0.2, 0.2);
    // Rotates the cuube around the x by 'rotate_x'
    glRotatef( rotate_x, 1.0, 0.0, 0.0 );
    // Rotates the cuube around the y by 'rotate_y'
    glRotatef( rotate_y, 0.0, 1.0, 0.0 ); 

    // move dew to gravity
    timestep++;
    velo += 0.005;
    cout << velo << "\n";
    glTranslatef(0.0, -velo, 0.0);//timestep * gravity, 0.0);

    // Defines the folowing verticys as this polygon
    glBegin(GL_POLYGON);

    //Changes color
    glColor3f( 1.0, 0.0, 0.5 );
    // Adds verted to polygon
    glVertex3f( -0.5, -0.5, -0.5 ); // F1
    glColor3f( 0.0, 1.0, 0.0 );
    glVertex3f( -0.5, 0.5, -0.5  ); // F2
    glColor3f( 0.0, 0.0, 1.0 );
    glVertex3f( 0.5, 0.5, -0.5 );   // F3
    glColor3f( 1.0, 0.0, 1.0 );
    glVertex3f( 0.5, -0.5, -0.5 );  // F4

    // Closes the polygon
    glEnd();

    glBegin(GL_POLYGON);

    glColor3f( 1.0, 1.0, 1.0 );
    glVertex3f( 0.5, -0.5, -0.5 );  // Back1
    glVertex3f( 0.5, 0.5, -0.5  );  // Back2
    glVertex3f( 0.5, 0.5, 0.5 );    // Back3
    glVertex3f( 0.5, -0.5, 0.5 );   // Back4

    glEnd();

    glBegin(GL_POLYGON);

    glColor3f( 1.0, 0.0, 1.0 );
    glVertex3f( 0.5, -0.5, -0.5 );  // F1
    glVertex3f( 0.5, 0.5, -0.5  );  // F2
    glVertex3f( 0.5, 0.5, 0.5 );    // F3
    glVertex3f( 0.5, -0.5, 0.5 );   // F4

    glEnd();

    glBegin(GL_POLYGON);

    glColor3f( 0.0, 1.0, 0.0 );
    glVertex3f( -0.5, -0.5, 0.5 );  // F1
    glVertex3f( -0.5, 0.5, 0.5  );  // F2
    glVertex3f( -0.5, 0.5, -0.5 );  // F3
    glVertex3f( -0.5, -0.5, -0.5 ); // F4

    glEnd();

    glBegin(GL_POLYGON);

    glColor3f( 0.0, 0.0, 1.0 );
    glVertex3f( 0.5, 0.5, 0.5 );    // F1
    glVertex3f( 0.5, 0.5, -0.5  );  // F2
    glVertex3f( -0.5, 0.5, -0.5 );  // F3
    glVertex3f( -0.5, 0.5, 0.5 );   // F4

    glEnd();

    glBegin(GL_POLYGON);

    glColor3f( 1.0, 0.0, 0.0 );
    glVertex3f( 0.5, -0.5, -0.5 );  // F1
    glVertex3f( 0.5, -0.5, 0.5  );  // F2
    glVertex3f( -0.5, -0.5, 0.5 );  // F3
    glVertex3f( -0.5, 0.5, -0.5 );  // F4

    glEnd();

    ////////////
    // Floor //
    //////////

    glPolygonMode(GL_FRONT_AND_BACK, GL_FILL);
    glLoadIdentity();

    // Rotates the cuube around the x by 'rotate_x'
    glRotatef( rotate_x, 1.0, 0.0, 0.0 );
    // Rotates the cuube around the y by 'rotate_y'
    glRotatef( rotate_y, 0.0, 1.0, 0.0 );

    glColor3f(1.0, 1.0, 1.0);
    glBegin(GL_LINES);
    for( GLfloat i =  -2.5; i < 2.5; i += 0.25 )
    {
        glVertex3f(i, -1.0, 2.5);
        glVertex3f(i, -1.0, -2.5);
        glVertex3f(2.5, -1.0, i);
        glVertex3f(-2.5, -1.0, i);
    }
    glEnd();

    // Flushes the buffers
    glFlush();
    // Draws what has just been done on the screen
    glutSwapBuffers();
    }

void specialKeys( int key, int x, int y )
{
    if( key == GLUT_KEY_RIGHT )
    {
        rotate_y += 5;
    }
    else if( key == GLUT_KEY_LEFT )
    {
        rotate_y -= 5;
    }
    else if( key == GLUT_KEY_UP )
    {
        rotate_x += 5;
    }
    else if( key == GLUT_KEY_DOWN )
    {
        rotate_x -= 5;
    }

    glutPostRedisplay();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T23:17:09.673

我在您的代码中看到了几个问题：

**假设固定时间步** 您的显示函数不能保证以均匀间隔调用。本质上，您是以“每帧米数 ( `m/f`)”而不是“每秒米数 ( )”为单位给出立方体的速度`m/s`。（我在这里使用米作为一般距离单位）

所以，一些基本的数学告诉我`m/f = m/s * s/f`。换句话说，您希望通过自上一帧以来的实际时间步长来缩放每帧移动立方体的量。

**速度问题** 你的代码编写方式，你的`velo`变量实际上代表了位置，你用数字 0.005 更新它每一帧，我认为这就是你的意思是你的加速度。如果你想让某物由于重力而加速，你需要存储两个值，它的位置和速度。然后每一帧，您需要通过添加加速度来更新速度，并通过添加速度来更新位置。

这是一些同时完成这两件事的代码

```
int lastTime=0;

void display() {
    int time = glutGet(GLUT_ELAPSED_TIME); // Time since the start of the program
    if (lastTime>0) { // Don't move anything the first frame
        int deltaTime = time-lastTime; // millis elapsed since the last frame
        velo += -0.005*deltaTime; // Gravity accelerates downwards
        pos += velo*deltaTime; // Position updated by velocity
        glTranslateF(0.0, pos, 0.0); // Actually position the square in the correct location
    }
    lastTime = deltaTime;
} 
```

请注意，当我用加速度更新我的速度时，我如何按 deltaTime 缩放它，当我用速度更新我的位置时，我做同样的事情。同样，之前的单位分析是记住这一点的一种简单方法：`deltaTime`告诉您自上一帧以来经过的毫秒数，因此其单位是“s/f”。`velo`应该有单位“米/秒”，以使运动随着时间的推移平滑。此帧更新位置的量为 m/s * s/f = m/f。这些单位很有意义，它们测量每帧的距离。

# c++ - 将一维数组重塑为多维数组

> ID：15283523
> 
> 赞同：19
> 
> 时间：2013-03-07T23:01:37.590
> 
> 标签：c++, c++11, multidimensional-array, language-lawyer

考虑到整个 C++11 标准，任何符合要求的实现是否有可能成功下面的第一个断言但失败了后者？

```
#include <cassert>

int main(int, char**)
{  
    const int I = 5, J = 4, K = 3;
    const int N = I * J * K;

    int arr1d[N] = {0};
    int (&arr3d)[I][J][K] = reinterpret_cast<int (&)[I][J][K]>(arr1d);
    assert(static_cast<void*>(arr1d) ==
           static_cast<void*>(arr3d)); // is this necessary?

    arr3d[3][2][1] = 1;
    assert(arr1d[3 * (J * K) + 2 * K + 1] == 1); // UB?
} 
```

如果不是，这在技术上是否是 UB，如果第一个断言被删除，答案是否会改变（`reinterpret_cast`保证在这里保留地址？）？另外，如果重塑是在相反的方向（3d 到 1d）或从 6x35 阵列到 10x21 阵列进行的呢？

**编辑：**如果答案是因为 UB 是 UB `reinterpret_cast`，是否有其他严格兼容的重塑方式（例如，通过`static_cast`to/from a intermediate `void *`）？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-07T23:58:35.313

**2021 年 3 月 20 日更新：**

[最近在 Reddit 上提出了](https://www.reddit.com/r/cpp_questions/comments/m9a7fs/reinterpret_a_1d_array_as_a_2d_array/)同样的问题，有人指出我原来的答案是有缺陷的，因为它没有考虑到这个[别名规则](https://eel.is/c++draft/expr#basic.lval-11)：

> 如果程序尝试通过类型与以下类型之一不相似的泛左值访问对象的存储值，则行为未定义：
> 
> *   对象的动态类型，
> *   对应于对象动态类型的有符号或无符号类型，或
> *   char、unsigned char 或 std​::​byte 类型。

根据[相似性](https://eel.is/c++draft/expr#conv.qual-2)规则，对于上述任何情况，这两种数组类型都不相似，因此通过 3D 数组访问 1D 数组在技术上是未定义的行为。（这绝对是其中一种情况，在实践中，它几乎可以肯定适用于大多数编译器/目标）

*请注意，原始答案中的引用是指较旧的 C++11 草案标准*

# 原答案：

## `reinterpret_cast`参考文献

该标准规定，类型的左值`T1`可以是`reinterpret_cast`指向的引用，`T2`如果指向的指针`T1`可以`reinterpret_cast`指向指向的指针`T2`（第 5.2.10/11 节）：

> 如果可以使用 reinterpret_cast 将类型“pointer to”的表达式显式转换为“pointer to ”类型，则可以将类型的左值表达式强制`T1`转换为“reference to ”类型。`T2``T1``T2`

所以我们需要确定是否`int(*)[N]`可以将 a 转换为`int(*)[I][J][K]`。

## `reinterpret_cast`指针

一个指针`T1`可以`reinterpret_cast`指向一个指针，`T2`如果两者`T1`都是`T2`标准布局类型并且`T2`没有比`T1`（§5.2.10/7）更严格的对齐要求：

> 当“指向 T1 的指针”类型的纯右值 v 转换为“指向 cv T2 的指针”类型时，结果是`static_cast<cv T2*>(static_cast<cv void*>(v))`如果`T1`和`T2`都是标准布局类型（3.9）并且 的对齐要求`T2`不比 的更严格`T1`，或者如果任何一种类型都是无效的。

1.  是`int[N]`和`int[I][J][K]`标准布局类型吗？

    `int`是标量类型，标量类型的数组被认为是*标准布局类型*（第 3.9/9 节）。

    > 标量类型、标准布局类类型（第 9 条）、此类类型的数组以及这些类型的 cv 限定版本（3.9.3）统称为*标准布局类型*。

2.  没有`int[I][J][K]`比 更严格的对齐要求`int[N]`。

    运算符的结果`alignof`给出了完整对象类型的对齐要求（第 3.11/2 节）。

    > 运算符的结果`alignof`反映了完整对象情况下类型的对齐要求。

    由于这里的两个数组不是任何其他对象的子对象，因此它们是完整的对象。应用于`alignof`数组给出了元素类型的对齐要求（§5.3.6/3）：

    > 当`alignof`应用于数组类型时，结果应为元素类型的对齐方式。

    所以这两种数组类型都有相同的对齐要求。

这使得`reinterpret_cast`有效且等效于：

```
int (&arr3d)[I][J][K] = *reinterpret_cast<int (*)[I][J][K]>(&arr1d); 
```

where`*`和`&`是内置运算符，则相当于：

```
int (&arr3d)[I][J][K] = *static_cast<int (*)[I][J][K]>(static_cast<void*>(&arr1d)); 
```

## `static_cast`通过`void*`

标准转换（§4.10/2）允许to `static_cast`：`void*`

> “指向 cv 的指针`T`”类型的纯右值，其中`T`是对象类型，可以转换为“指向 cv void 的指针”类型的纯右值。将“指向 cv 的指针`T`”转换为“指向 cv void 的指针”的结果指向类型对象所在的存储位置的开始`T`，就好像该对象是类型最派生的对象 (1.8) `T`（即，而不是基类子对象）。

然后允许`static_cast`to `int(*)[I][J][K]`(§5.2.9/13)：

> “指向 cv1 的指针`void`”类型的纯右值可以转换为“指向 cv2 的指针”类型的纯右值`T`，其中`T`是对象类型，且 cv2 与 cv1 具有相同的 cv 限定或大于 cv1 的 cv 限定。

**所以演员阵容不错！**但是我们可以通过新的数组引用访问对象吗？

## 访问数组元素

对数组执行数组下标`arr3d[E2]`等价于`*((E1)+(E2))`(§5.2.1/1)。让我们考虑以下数组下标：

```
arr3d[3][2][1] 
```

首先，`arr3d[3]`等价于`*((arr3d)+(3))`。左值`arr3d`经过数组到指针的转换，得到一个`int(*)[2][1]`. 不要求底层数组必须是正确的类型才能进行此转换。然后访问指针值（第 3.10 节很好），然后将值 3 添加到它。这个指针算法也很好（§5.7/5）：

> 如果指针操作数和结果都指向同一个数组对象的元素，或者超过数组对象的最后一个元素，则计算不应产生溢出；否则，行为未定义。

这个 this 指针被取消引用以给出一个`int[2][1]`. `int`这对接下来的两个下标进行相同的过程，从而在适当的数组索引处产生最终的左值。由于`*`（§5.3.1/1）的结果，它是一个左值：

> 一元 * 运算符执行间接：应用它的表达式应该是指向对象类型的指针，或指向函数类型的指针，结果是一个左值，指向表达式指向的对象或函数。

然后通过这个左值访问实际`int`对象是非常好的，因为左值也是类型`int`（第 3.10/10 节）：

> 如果程序尝试通过非下列类型之一的泛左值访问对象的存储值，则行为未定义：
> 
> *   对象的动态类型
> *   [...]

所以除非我错过了什么。我会说这个程序定义明确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:11:36.683

我的印象是它会起作用。您分配同一块连续内存。我知道 C 标准保证它至少是连续的。我不知道 C++11 标准是怎么说的。

然而，第一个断言应该始终为真。数组的第一个元素的地址将始终相同。由于分配了同一块内存，因此所有内存地址都将相同。

因此，我还要说第二个断言将永远成立。至少只要元素的顺序始终按行主要顺序排列。C 标准也保证了这一点，如果 C++11 标准有不同的说法，我会感到惊讶。

# html - 在 MySQL 中批量查找和替换变量

> ID：15283526
> 
> 赞同：0
> 
> 时间：2013-03-07T23:01:57.727
> 
> 标签：html, mysql, joomla, phpmyadmin

我正在使用以下 SQL 查询在 phpMyAdmin 中批量查找和替换。

```
UPDATE `table_name` SET `field_name` = replace(same_field_name, 'unwanted_text', 'wanted_text') 
```

当 'unwanted_text' 是一个常数时，这很有效。但是“unwanted_text”有可能成为两个常量之间的变量吗？

这是我的具体例子。

我想批量查找并替换它：

```
<img src="images/stills/variable_1.jpg" />
<img src="images/stills/variable_2.jpg" />
<img src="images/stills/variable_3.jpg" /> 
```

和：

```
<img src="images/stills/1_constant_filename.jpg" /> 
```

这两个常数是：

```
"images/stills/ 
```

和

```
.jpg" /> 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:23:54.830

根据[此](http://www.mysqltutorial.org/mysql-string-replace-function.aspx)链接：

> 目前 REPLACE 函数不支持正则表达式，因此如果您需要使用模式替换文本字符串，则需要使用外部库中的 MySQL 用户定义函数 (UDF)，请在此处查看 [MySQL UDF with Regex](https://launchpad.net/mysql-udf-regexp)

在链接的首页上，它说：

> 此包将正则表达式函数实现为 MySQL 用户定义函数 (UDF)。该包实现的功能有：
> 
> *   REGEXP_LIKE（文本，模式 [，模式]）
> *   REGEXP_SUBSTR（文本，模式[，位置[，出现[，模式]]]）
> *   REGEXP_INSTR？（文本，模式[，位置[，出现[，return_end [，模式]]]]）
> *   REGEXP_REPLACE?(文本、模式、替换 [,位置 [,出现 [,return_end [,模式]]])

您很可能对 REGEXP_REPLACE 感兴趣。

# html - H3 正中右对齐，需要一个新的眼睛

> ID：15283532
> 
> 赞同：5
> 
> 时间：2013-03-07T23:02:32.297
> 
> 标签：html, css

我在这里有一个可能很愚蠢的问题。

我对一段偏离中心的欢迎文本感到不安。我通常很擅长解决我自己的 CSS 问题，但这让我非常生气。我已经剥离了所有额外的边距自动和文本对齐中心，以使其更清晰。您实际上可以删除整个 JS 段并将#welcome DIV 不透明度设置回 1 以进一步清晰。

[http://jsfiddle.net/Imperative/29Aat/88/](http://jsfiddle.net/Imperative/29Aat/88/)

这是相关的CSS：

```
html, body {
    height: 100%;
    margin: 0 auto;
}
body {
    margin: 0;
    padding: 0;
    font-family: sans-serif;
}
#wrap {
    zoom: 1;
    position: relative;
    min-height: 100%;
    overflow: hidden;
}
#welcome {
    position: relative;
    opacity: 0;
    top: 0px;
}
#welcome h3 {
    font-family:'Alegreya SC', serif;
    font-size: 42px;
    color: rgb(230, 230, 230);
} 
```

我显然错过了一些非常新手和非常明显的东西，但我在 88 次迭代中离这个东西太近了，我完全错过了这条船。

是什么从 html、body、wrap 向下级联并导致整个#welcome 块向右移动？我会期待很多职位，除了向右移动 50% 之外，没有任何努力集中在任何事情上？什么鬼？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:21:00.570

您的`<nav>`元素不能包含`<li>`元素。您必须将它们放入`<ul>`：

```
nav
  ul
    li
    li 
```

至于您的*实际*问题：您`header`正在崩溃，因为它包含浮动元素。给它`overflow: auto`，它会调整大小以适应它们：

```
header.topbar {
    overflow: auto;
    /* Get rid of this: height: 80px; */
} 
```

最后，将文本居中：

```
#welcome {
    text-align: center;
} 
```

它有效：http: [//jsfiddle.net/29Aat/103/](http://jsfiddle.net/29Aat/103/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T23:18:50.527

如果我理解正确，您希望标题完全位于中心。但是您没有定义导航宽度。这是更新的小提琴：[JSFiddle](http://jsfiddle.net/4b53B/)

这是我添加的内容：

```
nav {
    width: 100%;
}

#welcome h3 {
    text-align: center
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T23:27:53.470

最终成为一个简单的解决方案：

```
#welcome {
    position: relative;
    opacity: 0;
    top: 0px;
    clear: both;
}
#welcome h3 {
    font-family:'Alegreya SC', serif;
    font-size: 42px;
    color: rgb(230, 230, 230);
    text-align: center;
} 
```

我必须清除 Welcome 上的浮动，此时定位恢复正常。那时，将中心添加回 H3 按预期工作。

固定小提琴：http: [//jsfiddle.net/Imperative/29Aat/102/](http://jsfiddle.net/Imperative/29Aat/102/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T23:05:42.587

在没有看到 HTML 的情况下，我首先想知道 #wrap 是否位于 #welcome 旁边，导致它偏离中心？

好的，我还在学习这个 stackoverflow 的东西，所以请让我在操作上稍微放松一下。话虽如此，我现在看到了这个 jsfiddle 可以做什么。

查看 html 代码，您从未在打开 Welcome-div 之前关闭 wrap-div。

你看的那个问题？我尝试关闭 div 标签并在 CSS 中添加 text-align:center，但现在欢迎横幅消失了。

* * *

好的，一些代码修补导致了这一点：

1）关闭 Wrap-div 标签（我很确定我设法把它放在正确的位置） 2）修改 CSS 库：

```
position: absolute;
opacity: 0;
top: 25%;
width:100%;
text-align:center; 
```

# php - 自定义 Symfony 表单并更好地控制验证过程

> ID：15283538
> 
> 赞同：0
> 
> 时间：2013-03-07T23:03:00.990
> 
> 标签：php, doctrine, validation, symfony-1.4, symfony-forms

我使用教义：generate-admin 为我的一个名为“Alumnos”的模型构建 CRUD 操作。我知道 Symfony 在 /apps/site/modules/alumnos/views 下生成视图，我正在尝试使用 Twitter Bootstrap 框架自定义输入字段。_form.php 文件有以下代码：

```
<?php echo $form['nombres']->renderLabel() ?>
<?php echo $form['nombres']->renderError() ?>
<?php echo $form['nombres'] ?> 
```

但是我想在必填字段中添加一个**（*）**，一个用于输入字段的类，并`<div>`使用正确的标记将错误包装在标签内。我怎样才能做到这一点？

另外（不知道这部分开一个新问题是否更好）我有六个领域，需要实现这一点：

*   如果前三个字段（少说 1、2、3）填充了值，则验证通过
*   如果后三个字段（少说 4、5、6）填充了值，则验证通过
*   至少前三个字段或后三个字段是必需的，因此在所有情况下 1,2,3 不能为空或 4,5,6 不能为空

我如何处理这个验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T02:03:51.480

如果这只是一种形式，您可以采用 hacky 方式：`<?php echo $form['nombres']->renderLabel() ?>`用 HTML 替换，那么简单 ^^

对于您的第二个问题，您需要在表单中使用帖子验证器来检查多个字段。这是一个例子： [http ://symfony.com/legacy/doc/cookbook/1_2/en/conditional-validator](http://symfony.com/legacy/doc/cookbook/1_2/en/conditional-validator)

如果有帖子验证器示例，也许可以查看 jobeet 教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T07:32:34.590

对于您问题的第一部分，您应该查看页面底部的[http://symfony.com/legacy/doc/more-with-symfony/1_4/en/06-Advanced-Forms](http://symfony.com/legacy/doc/more-with-symfony/1_4/en/06-Advanced-Forms)他们描述了如何创建一个新的 WidgetFormSchemaFormatter。

对于第二部分，正如弗朗索瓦所说，使用后验证器或自定义验证器。

# saxon - 将 Saxon XsltTransformer 输出链接到 FOP

> ID：15283539
> 
> 赞同：0
> 
> 时间：2013-03-07T23:03:05.733
> 
> 标签：saxon, chaining, apache-fop

我需要将几个 XSL 转换的输出通过管道传输到 FopFactory 对象，但我不知道如何编写代码。我有管道工作，但最后一步是个谜。

```
DOMResult xmlRequest = new DOMResult();
marshaller.marshal(req,xmlRequest);

FopFactory fopFactory = FopFactory.newInstance();
FOUserAgent foUserAgent = fopFactory.newFOUserAgent();
ByteArrayOutputStream out = new ByteArrayOutputStream();
Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, foUserAgent, out);

XdmNode source = processor.newDocumentBuilder()
   .build(new DOMSource(xmlRequest.getNode()));

XsltTransformer step1 = templateCache.get("foo1.xsl").load();
XsltTransformer step2 = templateCache.get("foo2.xsl").load();
XsltTransformer step3 = templateCache.get("foo3_fo.xsl").load();

step1.setInitialContextNode(source);
step1.setDestination(step2);
step2.setDestination(step3);

// Here's what I really need to do -- pipe the output of step3 into the FO processor.
// Of course, the following statement doesn't work, but I don't know what I need
// to do to make the output of step3 piped into the fop, so the 
step3.setDestination(fop.getDefaultHandler());

step1.transform();

// at this point, the results of the FOP processor would be in the
// ByteArrayOutputStream "out". 
```

我怎样才能使这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T17:33:58.320

当然，在发布问题并进行更多搜索后，我找到了答案。这是我想出的（省略了上面的大部分代码）：

```
Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, foUserAgent, out);
SAXDestination fopDest = new SAXDestination(fop.getDefaultHandler());
.
step2.setDestination(step3);
step3.setDestination(fopDest);

step1.transform();
.
// Output is now in ByteArrayOutputStream out; 
```

# jquery - 使用 Javascript 库 Backbone、Zepto 和 jQuery 实现 REST 是否安全？

> ID：15283540
> 
> 赞同：0
> 
> 时间：2013-03-07T23:03:13.797
> 
> 标签：jquery, rest, backbone.js, zepto

我想使用浏览器可以管理的接近完整的 RESTful 风格。

`PUT`Backbone、jQuery和Zepto 是否以相同的方式实现非浏览器支持的方法`DELETE`？如果是这样，他们如何实施？

骨干：

```
myBackbone.model.destroy() // Calls Backbone.sync('DELETE', model, options) 
```

jQuery / Zepto：

```
$.ajax({ url:'/testUrl', type:'PUT' }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:11:56.933

显然 REST 从 JS 触发是安全的，并且已经存在很长时间了，只是不能从 HTML 表单中触发。

@马特惠普尔：

> 旧版浏览器不支持 HTML 表单中的所有 HTTP 方法。这不适用于 JS 代码。

@Benjamin Gruenbaum：

> 所有主要浏览器都支持 PUT 和 DELETE...。

# sql-server - SQL Case 语句 VS Union 所有性能

> ID：15283541
> 
> 赞同：9
> 
> 时间：2013-03-07T23:03:14.490
> 
> 标签：sql-server, tsql

我有一个需要包含条件逻辑的查询。有 4 种情况需要考虑，结果集是不相交的。

我可以使用单个`SELECT`and `CASE`/`WHEN`语句或使用多个`SELECT`语句 and来实现查询`UNION ALL`。

一般来说，这些实现中的一种可能比另一种更快吗？如果是这样，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:55:36.873

一个联合会同时进行许多选择，因此如果 from 语句不是那么复杂并且所有其他事情都相同，那么恕我直言，通常情况下会更好。但它们不是相似的 sql 结果：

'Case when ...' 将添加另一个水平行，并且默认情况下，选择的联合必须在集合中具有该数量的列，以便它会添加更多行。例如，如果您查询三个单独的表，然后将它们合并在一起，您将执行三个选择，但是如果您只执行三个案例，那么如果您查询一个表将是有效的。但是您可能要查询五个。在不知道来源的情况下，答案确实是：“取决于”。

我只是在对 SQL 引擎进行快速计时时设置了 ole 'set statistics time on' 来查看。人们可以争论语义，但当它告诉你发生了什么时，引擎不会说谎。SQL 2005 及更高版本我相信在菜单栏中也有“包括实际执行计划”。这是一个好看的小三方形图标，呈 L 形，L 点位于左上角。如果您有一些非常复杂的事情并且正在真正进行微调，那么这是检查引擎在您的查询中执行的操作的首选工具。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-08T17:14:34.060

这实际上完全取决于您期望从中选择的逻辑和数据是什么样的。如果您针对庞大的数据集运行此 SELECT 并且逻辑非常简单，例如 WHEN Val 在 A 和 B THEN C 之间，您可能会得到一点提升，将逻辑放在 where 子句中并执行 UNION ALL 但不是一吨的差异。在相对较小的数据集上，它可能根本没有任何区别。它还可能取决于您是否看到此代码是一成不变的，还是会定期更改。UNION ALL 肯定会多出几行代码，因为您基本上是用不同的 WHERE 子句一遍又一遍地编写相同的查询，但它也可能更易于阅读和维护。

# java - Java中方法的退出点

> ID：15283544
> 
> 赞同：5
> 
> 时间：2013-03-07T23:03:29.480
> 
> 标签：java, eclipse, debugging

在 Eclipse 中，有没有办法找到方法从哪个返回语句返回，而不在每个返回语句中记录标志？

例如：

```
@Override
 public boolean equals(Object obj) {
    if (this == obj) {
        return true;
    }
    if (obj == null) {
        return false;
    }
    if (!(obj instanceof ABC)) {
        return false;
    }
    ABC other = (ABC) obj;
    if (var1 == null) {
        if (other.var1 != null) {
            return false;
        }
    } else if (!var1.equals(other.var1)) {
        return false;
    }
    return true;
} 
```

在这种情况下，我如何找出我的 equals 方法返回的时间点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:05:46.587

不，这是一些人喜欢单点退出的原因之一： [为什么一个函数应该只有一个退出点？](https://stackoverflow.com/questions/4838828/why-should-a-function-have-only-one-exit-point)

还要注意关于该问题的第一条评论中的链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T23:06:08.680

不，但是更易于理解和调试友好的代码可以使用表示结果的布尔局部变量。

然后您可以使用调试器查看分配它的时间和返回之前的返回值。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-07T23:05:56.987

在调试模式下使用断点。

# c - 在 C 中创建大型数组时出现分段错误

> ID：15283546
> 
> 赞同：2
> 
> 时间：2013-03-07T23:03:39.180
> 
> 标签：c, arrays, sorting, segmentation-fault

你们用这段代码帮了我很多。让我先说我不太了解 C，并且正在努力做到这一点。

这是程序应该做的：

1.  创建一个长度为 1000 万的随机数列表
2.  使用 shell 排序函数对随机数列表进行排序（仍然无法正常工作......我认为这是我将指针传递给函数的方式）
3.  列一个长一百万的清单
4.  在记录时间时重复多达 1 亿次（由于某种原因，时间显示为 0.0000000）

我只是想测试这个 shell 排序程序与标准库中内置的快速排序。

我试过有和没有指针。注释掉的部分在完成后应该可以工作。它只会让事情变得更糟，哈哈

请帮帮我，你们到目前为止都很棒...

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

void shellSort(int *A, int n);
void checkSort(int *A, int n);

int main(){

    /*Initialize Random Array*/
    int unsorted_list[10000000];
    int *ptr = &unsorted_list[0];
    int random_number;
    int i;

    srand ( time(NULL) );
    for(i=0; i<10000000; i++){

        random_number = rand();
        unsorted_list[i] = random_number % 10000000;
    }

    //Do C Shell Sort
    double shell_results[10][2];

    double clock_diff;
    int j=10000000;
    clock_t t0, t1;
    int k;

    for(i=0;i<10;i++){

        /*Sort the list using shellSort and take the time difference*/
        t0 = clock();
        shellSort(ptr, j);
        t1= clock();

        /*Take difference in time*/
        clock_diff = (t1 - t0)/CLOCKS_PER_SEC;

        /*Add time and list length to the results array*/
        shell_results[i][0] = (double)j;
        shell_results[i][1] = clock_diff;

        /*Check to make sure the array has been sorted*/
        checkSort(ptr, j);

        /*Re-initialize a longer array*/
        //j+=1000000;
        //for(k=0; k<j; k++){
        //    random_number = rand();
        //    unsorted_list[k] = random_number % 1000000;
        //}

        printf("%d",(int)shell_results[i][0]);
        printf(" ");
        printf("%f",shell_results[i][1]);
        printf("\n");

    }

 return 0;
 }

 void shellSort(int *A, int n){

     int gap , i , j , temp;

     for (gap = n/2; gap>0; gap /=2)
         for (i=gap; i<n; i++)
             for(j = i-gap; j>=0 && A[j] > A[j+gap]; j-=gap){
                 temp = A[j];
                 A[j] = A[j + gap];
                 A[j + gap] = temp;
     }
 }

void checkSort(int *A, int n){

    int i;

    for(i=0;i<n;i++){

        if(A[i]>A[i+1]){

            printf("Error in sorting \n");
            break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T23:04:57.817

您可能没有 10 兆字节的堆栈空间。使该数组全局化，使用 声明它`static`，或使用 动态分配它`malloc()`。如果您选择后者，请不要忘记`free()`它。

稍后，当您需要使用 100,000,000 个元素的数组时，请确保为它使用新的分配！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:07:22.147

好吧，您不可能在堆栈上拥有这么多的可用空间。使用 malloc() 从堆中分配它。记得之后释放（）它。

# objective-c - NSTableView 组行文本字段选择

> ID：15283548
> 
> 赞同：3
> 
> 时间：2013-03-07T23:03:58.963
> 
> 标签：objective-c, macos, cocoa, nstableview

我想在我的表格视图中进行自定义文本选择。

我找到[了](https://stackoverflow.com/a/9596390/1320374)关于如何设置单元格的颜色、字体等的很棒的答案。

但是，有一个问题。

它不适用于组行。我看到该方法被调用，但我认为样式在`NSTableCellView`或`NSTableView`类中的某处被覆盖。

我怎样才能解决这个问题？

* * *

## 编辑

这是一个基于视图`NSTableView`

# c++ - HoughLinesP 和 opencv 内存管理

> ID：15283551
> 
> 赞同：0
> 
> 时间：2013-03-07T23:04:04.137
> 
> 标签：c++, memory-management, opencv

我目前正在研究计算机视觉并尝试使用 Hough-Transform 来查找一些线条。它本身的操作正在运行，但是即使是最小的示例代码也会产生释放错误。

```
#include <iostream>

#include <opencv2/imgproc/imgproc.hpp>
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>

using namespace std;
using namespace cv;

int main(int argc, char* argv[])
{
    int size[] = {100, 100};
    Mat img(1, size, CV_8U);
    img  = cv::Scalar(255);
    vector<Vec4i> lines;
    HoughLinesP(img, lines, 1, CV_PI/180, 100, 30, 5);

    cout << lines.size() << endl;
} 
```

请注意，如果我将行转换为 * 行，在堆上创建向量并且不删除它，则一切正常。我看不出代码有任何问题，它直接取自 OpenCV 示例。

异常发生在

```
msvcr110d.dll!_CrtIsValidHeapPointer(const void * pUserData) Line 2036  C++ 
```

我从 VS 2012 64 位版本编译并运行它，可执行文件也是 64 位的。操作系统是 Windows 7、64 位

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-18T16:29:25.000

此问题可通过以下两个选项之一解决：

*   将您的应用程序链接到与您的 OpenCV 库版本相同的 CRT，

*   重新编译 OpenCV 并禁用静态 CRT 链接。

这是因为 HoughLinesP 在通过引用传递的“行”对象内分配内存，但在调用 HoughLinesP 的函数结束时，您的应用程序将取消分配内存。因此，对于不同的 CRT，这会产生问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:15:36.937

您的应用程序可能在 Release 模式下运行，请尝试在 Debug 中运行它。
（我建议这样做是因为它使用了调试 DLL，msvcr110d.dll）。

我遇到了[这个](https://stackoverflow.com/questions/11677118/opencv-example-code-for-find-contours-vector-deallocation-issue)问题，您可能会发现它也很有用。

希望有帮助，让我知道它是怎么回事！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-10T14:29:33.933

```
vector<Vec4i> lines; 
line.reserve(1000); //create enough place for lines 
```

**涂鸦：**

> 这是因为 HoughLinesP 在通过引用传递的“行”对象内分配内存，...

如果您保留足够的行位，则不会出现内存问题，因为该函数不会仅使用保留的位置创建内存字段。

# .htaccess - htaccess：重写 - 但保留网站资源？

> ID：15283556
> 
> 赞同：0
> 
> 时间：2013-03-07T23:04:42.650
> 
> 标签：.htaccess, mod-rewrite

我知道这可能是一个经常被问到的问题，我一直在寻找答案，但找不到任何可以回答我的问题的答案。我假设这是因为我没有找出正确的搜索词，所以很抱歉如果这是多余的......谢谢你的时间！

我使用 .htaccess 将我的 URL 重写为对用户更友好的格式。这就是我想要做的所有事情，如果有更好的方法来做到这一点，我将不胜感激！

反正; 我将 localhost/room/2 重写为 index.php?p=room&id=2。这就像一个魅力。

```
RewriteRule ^room/([0-9]*)$ /index.php?p=room&id=$1 [L] 
```

您可能已经说出了我的问题：我正在使用 room/room_number 创建一个虚拟文件夹。因此，当我 - 例如 - 包含使用 IMG-Tag 的图片时，该 src-Attribute 也被重写以适应服务器假定的工作目录。而不是请求

```
localhost/img/image.jpg 
```

它要求

```
localhost/room/img/image.jpg 
```

这显然不是正确的位置。所以我的问题是；如何在将页面资源重新重定向到其原始路径的同时将*URL重写为好用且用户友好的内容？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:09:03.650

通过在路径前加上**前导斜杠**来使用相对于根目录的路径：

```
<img src="/img/image.jpg" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T13:30:52.720

这个问题的另一个（也是相当标准的）解决方案是添加一个 RewriteCond ，以便在请求确实存在的资源时永远不会应用该规则。

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^room/([0-9]*)$ /index.php?p=room&id=$1 [L] 
```

# tsql - 如何合并或组合查询的结果

> ID：15283557
> 
> 赞同：2
> 
> 时间：2013-03-07T23:04:48.527
> 
> 标签：tsql

我有一个查询，它返回来自不同州的当前和上个月销售的商品数量。

```
 States    Prior Month   Current Month
1    CA           1              2   
2    NY           8              4 
```

我将如何将两个结果行合并/组合成这样的：

```
 States      Prior Month    Current Month
   1 Other States      9               4 
```

或者这是我在查询期间必须做的事情？关于我应该如何解决这个问题的任何信息都会很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:14:05.697

假设您当前的查询是正确的并且执行您想要的操作，您可以将其包装在像这样的外部 SELECT 中

```
SELECT 1, 
       'Other States' States, 
       SUM([Prior Month]) 'Prior Month', 
       SUM([Current Month]) 'Current Month'
FROM 
(
   -- Put your current query here 
) t 
```

# ios - 生成打印页面时更新进度条

> ID：15283558
> 
> 赞同：1
> 
> 时间：2013-03-07T23:04:52.413
> 
> 标签：ios, objective-c, multithreading, nsthread, uiprogressview

我有一个生成要由用户打印的图像的类。这些图像是使用 QuartzCore（和一些 UIKit 元素）创建的，需要在主线程上运行。

在生成图像时用户可见的视图中，我有一个进度条。此视图是执行打印的类的委托，打印机在视图上调用一个方法来更新进度条。问题是，在打印机完成之前，进度条不会明显更新，因为打印机阻塞了主线程。我无法将进度条移出主线程，因为所有 UI 更新都必须在主线程上完成。

我对多线程相当陌生；我还有其他选择吗，或者我必须使用活动指示器或类似的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T00:21:41.847

更新您的代码，以便在后台线程上完成图像创建。这应该是安全的。

然后你可以调用主线程来更新进度条。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T00:41:30.523

你可以使用[GCD](https://developer.apple.com/library/mac/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html) , [Raywenderlich 教程](http://www.raywenderlich.com/4295/multithreading-and-grand-central-dispatch-on-ios-for-beginners-tutorial)

```
- (void)generatePage
{
    dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{
        /*
          Here you can generate page and update progress
          For example:
         */
        [self updateProgress:10.0f];
        sleep(1000);
        [self updateProgress:20.0f];
        sleep(3000);
        [self updateProgress:100.0f];
    });
}

- (void)updateProgress:(float)progress
{
    dispatch_async(dispatch_get_main_queue(), ^{
        progressView.progress = progress;
    });
} 
```

# google-app-engine - Google App Engine 配置中的静态文件集和资源文件集是否交互？

> ID：15283559
> 
> 赞同：0
> 
> 时间：2013-03-07T23:04:56.753
> 
> 标签：google-app-engine, gae-eclipse-plugin

Google App Engine appengine-web.xml 配置文件允许您指定哪些文件是静态内容，哪些文件是资源。当您将应用程序上传到 Google 时，只有指定为静态的内容才会放置在静态内容服务器上，并且只有指定为资源的文件才会被推送到应用程序服务器（解释自[https://developers.google.com/appengine/docs/ java/config/appconfig](https://developers.google.com/appengine/docs/java/config/appconfig)）。

我有一些配置语句看起来像......

```
 <static-files>
    <include path="/**.html" />
    <include path="/**.js" />
    <include path="/**.css" />
    <include path="/**.ico" />
    <include path="/**.png" />
    <include path="/**.jpg" />
    <include path="/**.gif" />
  </static-files>

  <resource-files>
    <include path="/**.ftl" />
  </resource-files> 
```

我的问题是...

当我将文件添加到静态文件列表时，这是否意味着它们也不会作为资源文件发送？

当我将文件添加到资源文件列表时，这是否意味着它们也不会作为静态文件发送？

还是我需要在每个部分中提供完整的排除路径集？

文档在这里模棱两可（至少我没有看到任何明确的内容）。由于这只是节省空间的优化（我猜还有一些上传时间），所以它对我来说可能还不太重要。但我似乎没有任何方法可以判断内容在推送到 Google 时是否进入静态或资源区域。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T10:20:23.177

几点：

1.  静态文件的重点是它们直接提供给最终用户。它们不是由 GAE 服务器提供服务，而是由专门的（内部）Google CDN 服务器提供服务。这提高了加载时间。对于静态文件，您还可以声明“缓存控制”标头，甚至进一步缩短加载时间（因为客户端缓存和下游缓存会缓存它）。

2.  资源文件旨在供应用程序代码使用，而不是直接提供。Afaik，它们仍然作为文件提供，但它们由 GAE 服务器提供，因为它们需要在 GAE 实例上。

3.  WAR 的公共部分中的文件默认被视为静态文件和资源文件。因此，如果您希望将它们用作文件，则需要明确排除它们。

4.  /WEB-INF 下的文件永远不会被提供，但[可以通过 code 访问](https://stackoverflow.com/questions/4340653/file-path-to-resource-in-our-war-web-inf-folder)。放入代码目录 (/src) 的文件也可以通过代码访问，但不会作为静态文件提供（它们将被复制到 /WEB-INF/classes 中）。

# c# - 是类子类还是对象

> ID：15283562
> 
> 赞同：1
> 
> 时间：2013-03-07T23:05:05.070
> 
> 标签：c#, reflection, attributes

注意：我问的是子类，而不是派生类。

基本上，我需要做的是检查对象的属性并查找具有特定属性集的对象。

我遇到的问题是很多属性都来自子类

```
public class ExampleAttribute : Attribute
{
    public object Whatever { get; set; }
}

public class MiddleEarth
{
    [Example]
    public Type EntityType { get; set; }
}

public class Elf : MiddleEarth
{
    [Example]
    public SubClass ItsLateAndImTired { get; set; }

    public IList<Arg> Args { get; set; }

    //Need to check properties of this object as well
    public class SubClass
    {
        public object SubProperty { get; set; }

        [Example]
        public object SubPropertyWithAttribute { get; set; }
    }

    public class Arg
    {
        [Example]
        public string Something { get; set; }
    }
} 
```

现在，我正在尝试按以下方式进行操作...但由于评论中指出的原因，它不起作用

```
public List<string> IterateProperties(object _o)
{
    List<string> problems = new List<string>();
    foreach (PropertyInfo info in _o.GetType().GetProperties())
    {
        //All 3 of these will return the exact same thing
        Type thisType = this.GetType();
        Type oType = _o.GetType();
        Type infoType = info.ReflectedType;

        //IsSubClassOf only checks for derived classes, 
        //so it's not the method I'm looking for
        if (info.ReflectedType.IsSubclassOf(this.GetType()))
        {
            object sub = info.GetValue(_o, null);
            if (sub != null)
            {
                problems.AddRange(this.IterateProperties(sub));
            }
        }

        object[] attributes = info.GetCustomAttributes(typeof(ExampleAttribute), true);
        foreach (object o in attributes)
        {
            if (info.GetValue(_o, null) == null)
            {
                problems.Add(String.Format("Attribute {0} in class {1} cannot be null", info.Name, info.ReflectedType.ToString()));
            }
        }
    }

    return problems;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:15:12.847

我相信你正在寻找的是`Type.GetNestedTypes()`

[http://msdn.microsoft.com/en-GB/library/493t6h7t.aspx](http://msdn.microsoft.com/en-GB/library/493t6h7t.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:08:52.457

我不确定，但认为 GetProperties 方法有一些可以帮助的标志......

# windows-mobile - 关于：来自 .NET Compact Framework 3.5 应用程序的随机本机异常 - ES400 细节

> ID：15283565
> 
> 赞同：0
> 
> 时间：2013-03-07T23:05:21.250
> 
> 标签：windows-mobile, compact-framework, windows-mobile-6.5, motorola-emdk

遇到[Random native exception from .NET Compact Framework 3.5 application](https://stackoverflow.com/questions/14518539/random-native-exception-from-net-compact-framework-3-5-application "来自 .NET Compact Framework 3.5 应用程序的随机本机异常") and have a same crash dump for an ES400 这个问题，但解决方案相当模糊，我需要澄清解决方案的细节和最新固件更新对摩托罗拉 ES400 设备的影响于 2013 年 1 月 15 日发布。

总结一下这个问题，一个在摩托罗拉 ES400 上运行的紧凑型框架 3.5 应用程序会以奇数的时间间隔抛出偶尔的且迄今为止无法重新创建的访问冲突。我可以发布故障转储，它对有用信息的了解相当少，并且与针对原始问题发现的相同，其答案似乎与系统状态信息监视和 ui 更新有关，但相当不具体。

我的问题是，什么系统状态信息/控制操作与这个已知问题相关？如果安装了截至 2013 年 1 月 15 日的最新固件版本，是否对解决方案有任何影响？

向对这个作为一个全新问题发布的任何人表示歉意，但我无法评论原始问题，因为我是堆栈溢出的新手。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T07:20:21.297

尽管您可以使用 try..catch 块包装所有有问题的调用，但这会消耗资源和性能。避免异常总是更好的。 *例如：您需要调用 Web 服务：您可以在 Web 服务调用周围放置一个 try/catch，但您也可以事先确保 Web 服务托管服务器是否可访问。*

作为第一次尝试，您只能将主窗体调用包装在 try (Exception ex) ..catch 中的 program.cs 中。未处理的异常将以树状方式处理，并从上到下冒泡，直到它们被处理（对不起我的英语）。使用您可以从 Exception 类获得的所有信息：Message、StackTrace、InnerException 等... 可能将这些信息写入文件，以便稍后查看。

无法捕获某些本机异常。我已经将其与条形码阅读器对象或其他特定于设备的 .NET 包装器对象结合使用。包装程序的程序员和他们使用的本机代码/DLL 可以对此类坏对象进行唯一的修复。例如：itcscan.dll 是一个用于访问条形码阅读器的 C DLL，DataCollection.cf2.DLL 是这个 itcscan.dll 的 .NET 包装器。如果 itcscan.dll 中存在本机异常，则可能会使 .NET 包装器 DLL 和您的应用程序崩溃。您将无法自己解决此问题。您必须向供应商索取新的本机和/或 .NET DLL。

## 如何找到原生异常的来源？

只需通过您的代码并考虑禁用一个或其他调用和测试。有一个很好的记录到一个文件，所有的函数调用和结果都被记录下来。您可能会在日志中找到引发本机异常的模式。重新思考如何实现一个功能。正如您提到的帖子中一样，作者将他的代码从事件驱动的图标状态更新更改为基于时间的定期检查。

# google-cloud-datastore - 使用 JDO 查询 Haversine

> ID：15283566
> 
> 赞同：0
> 
> 时间：2013-03-07T23:05:22.747
> 
> 标签：google-cloud-datastore, geospatial, jdo

我需要帮助才能使用 JDO 进行此查询：

```
SELECT id, ( 3959 * acos( cos( radians(lat_t) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(lng_t) )
   + sin( radians(lat_t) ) * sin( radians( lat ) ) ) ) AS distance 
FROM Stores HAVING distance < 25 
ORDER BY distance 
```

我正在尝试咨询邻近坐标和大量互联网搜索，我发现了这个算法 Haversine。[来源是谷歌](https://developers.google.com/maps/articles/geospatial)。

这就是你需要的：

```
public static ArrayList<User> getUsers(double lat, double lng, double distance) {
    PersistenceManager pm = PMF.get().getPersistenceManager();
    Query query = pm.newQuery(¿?¿?¿?);

    ...

    return users;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T11:44:37.673

来自：[http ://db.apache.org/jdo/jdoql_methods.html](http://db.apache.org/jdo/jdoql_methods.html)

```
When writing the "filter" for a JDOQL Query you can make use of some methods on the various Java
types. The range of methods included as standard in JDOQL is not as flexible as with the true Java
types, but the ones that are available are typically of much use. 
```

您应该查找您的值并对这些值应用您想要的任何方法。

对于订购部分，`Query`接口有一个名为 的方法`setOrdering`，传递给它`yourColumn ASC|DESC`（即`ASC`OR `DESC`）

# visual-studio - Resharper 导航到通用接口的具体实现？

> ID：15283573
> 
> 赞同：14
> 
> 时间：2013-03-07T23:05:51.870
> 
> 标签：visual-studio, resharper

无论如何让 Resharper 导航到特定类型的通用接口的具体实现。

例如`ICommandHandler<T>`并找到具体的实现？我可以让 Resharper 显示 T 的所有实现，`ICommandHandler`但不能让我轻松获得 T 类型的实现。我们有数百个处理程序，并且导航变得越来越慢。

我们正在使用 Resharper 7.1

更新

示例包括：

```
public class AddStockRequestLineItemCommandHandler : ICommandHandler<AddStockRequestLineItemCommand>
public class RemoveStockRequestLineItemCommandHandler : ICommandHandler<RemoveStockRequestLineItemCommand>
public class StockRequestFufillingUpdateCommandHandler : ICommandHandler<StockRequestFufilingUpdateCommand> 
```

在 MVC 控制器构造函数中的用法如：

```
public StockRequestController( ICommandHandler<RemoveStockRequestLineItemCommand> stockRequestLineItemRemoveHandler)
{
    this.stockRequestLineItemRemoveHandler = stockRequestLineItemRemoveHandler;
} 
```

我希望能够单击`ICommandHandler<RemoveStockRequestLineItemCommand>`并转到实施类`RemoveStockRequestLineItemCommandHandler`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-29T17:01:18.997

Resharper 9.1.1 支持查找通用接口的用法。右键单击 IComamndHandler，它将向您显示用法。但是，它会出现，仍然没有找到实现的方法。

我们想出的最佳解决方案是

```
/// <summary>
/// <see cref="ChangePersonAddressCommandHandler"/>
/// </summary> 
```

使用 cref 链接[http://msdn.microsoft.com/en-us/library/cc837134.aspx](http://msdn.microsoft.com/en-us/library/cc837134.aspx)和模板并将其添加到命令上方或我们的控制器中。

希望不必这样做，只需使用 Resharper 直接导航到那里

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-21T21:03:36.917

ReSharper 2016.1 RTM 现在支持使用 Ctrl+F12 导航到泛型类型的具体实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T03:52:35.887

If I right click on the base object I get a context menu that offers:

```
Go to Implementation (Ctrl+Shift+Alt+B) 
```

selecting that will then offer me the various derived objects (in your case the classes)

# javascript - 从服务器端设置onclick时如何获取点击事件参数？

> ID：15283575
> 
> 赞同：0
> 
> 时间：2013-03-07T23:05:58.127
> 
> 标签：javascript, jquery, onclick, eventargs

我正在尝试像弹出窗口一样打开一个 div，但是当它触发 onclick 事件时，它以鼠标所在的位置为中心。为了获得鼠标位置，我一直在关注这个例子

[http://docs.jquery.com/Tutorials:Mouse_Position](http://docs.jquery.com/Tutorials:Mouse_Position)

```
jQuery(document).ready(function(){
   $("#special").click(function(e){
      $('#status2').html(e.pageX +', '+ e.pageY);
   }); 
}) 
```

在该示例中，单击功能设置为客户端。但是，在我的场景中，我将在服务器端将 onclick 函数设置为许多动态创建的对象。我还将向我的函数添加一个参数，该参数对于创建的每个对象都是唯一的。

我面临的问题是，当我设置不使用 JQuery 的 onclick 事件时，我似乎无法获得 eventargs（“e”）。

最终，我试图实现的简化示例如下所示：

```
<div id="divSubscription" style="display: none; height: 0px; width: 0px; position: absolute;">some content</div>     
<input type="button" id="btnOpenPopup" value="Open" onclick='openPopup(8, e)' />

    function openPopup(subID, e) {
        var x = e.pageX;
        var y = e.pageY;
        $("#divSubscription").css("top", y);
        $("#divSubscription").css("left", x);
        $("#divSubscription").css("display", "block");
        $("#divSubscription").animate({ height: "400px", width: "400px" }, 300, "swing");

        $("#divSubscriptionContent").html(subID);
    } 
```

显然，这是行不通的，因为它不知道“e”是什么。有什么办法可以完成我想做的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:09:47.487

使用类名而不是 ids 和 data-id 属性来存储按钮特定的数据（即 subID）：

CSS：

```
jQuery(document).ready(function(){
   $(".special").click(function(e){
      var subID = $(this).attr('data-id'); 
      $("#divSubscriptionContent").html(subID);
   }); 
}) 
```

HTML：

```
<div id="divSubscription">some content</div>
<input class="special" data-id="8" type="button" id="btnOpenPopup" value="Open" /> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-07T23:09:39.363

尝试使用委托事件，其中 #BUTTON_ANCESTOR 是包含您的按钮的元素：

```
 jQuery(document).ready(function(){
      $("#BUTTON_ANCESTOR").on('click', 'input[type=button]', (function(e){
           $('#status2').html(e.pageX +', '+ e.pageY);
      }); 
 }) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-07T23:14:36.240

就个人而言，我认为您应该删除 onclick 并使用 jquery 或一些类似的框架来附加点击处理程序并监听事件。

简单地说，使用 jQuery

```
$('#btnOpenPopup').bind('click', {foo:bar}, openPopup(e)); 
```

在您的引导程序或初始化过程中执行此操作，并摆脱将 javascript 放入 html 文件的习惯。恕我直言，您应该只需要包含一个脚本。

# python - OrderedDict KeyError

> ID：15283578
> 
> 赞同：1
> 
> 时间：2013-03-07T23:06:10.470
> 
> 标签：python, collections, dictionary, comparison

```
import collections

d = collections.defaultdict(dict)

d["i"]["a"] = "111"
d["i"]["b"] = "222"

print d

od = collections.OrderedDict()

od["i"]["a"] = "111"
od["i"]["b"] = "222"

print od 
```

输出：

```
defaultdict(<type 'dict'>, {'i': {'a': '111', 'b': '222'}})
Traceback (most recent call last):
  File "app_main.py", line 51, in run_toplevel
  File "/Users/adam/Desktop/collections.py", line 12, in <module>
    od["i"]["a"] = "111"
KeyError: 'i' 
```

为什么 OrderedDict 的关键错误以及我能做些什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:11:00.350

一个`OrderedDict`不也是一个`defaultdict`。你必须做这样的事情：

```
import collections
od = collections.OrderedDict()
od["i"] = collections.OrderedDict()
od["i"]["a"] = "111"
od["i"]["b"] = "222"
print od 
```

输出：

```
OrderedDict([('i', OrderedDict([('a', '111'), ('b', '222')]))]) 
```

有关潜在的有序 ​​defaultdict 实现，请参阅[此答案。](https://stackoverflow.com/questions/6190331/can-i-do-an-ordered-default-dict-in-python)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-27T07:03:14.013

这就是 defaultdict 的主要优点，尤其是它会捕获 Keyerror 并调用作为参数传递给 defaultdict 的函数。但是 OrderedDict 用于不同的目的。

如果一个新的 dataStrcture 结合了这两种功能将是有益的。此外，使用 userDict() 必须可以实现这样的功能。

你可以参考我关于 Python Collections 的文章

[https://techietweak.wordpress.com/2015/11/11/python-collections/](https://techietweak.wordpress.com/2015/11/11/python-collections/)

希望这可以帮助。

# git - 如何为我的每个用户制作单独的 Gitweb“页面”？

> ID：15283580
> 
> 赞同：1
> 
> 时间：2013-03-07T23:06:23.943
> 
> 标签：git, gitweb

Gitweb 忽略

```
SetEnv GIT_PROJECT_ROOT /path/to/user/git 
```

即使它适用于git。我可以克隆并推送到我的存储库。如果我启用 gitweb，每个用户都可以看到所有用户存储库以及里面的代码。

如何为我的每个用户制作单独的 Gitweb“页面”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:06:23.943

这里的答案在于 gitweb.conf 文件中的 $per_request_config 变量（通常位于 /etc/gitweb.conf 中）

假设 /git/ 是您的 git 存储库的根目录，并且每个用户在该文件夹中都有一个目录，这将适用于您：

```
our $per_request_config = sub {
        $projectroot = "/git/" . $cgi->remote_user;
}; 
```

您的 apache Vhost 配置可能如下所示：

```
<VirtualHost *:443>
        SSLEngine on
        SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP

        SSLCertificateFile      /ssl/mydomain.com.crt
        SSLCertificateKeyFile   /ssl/mydomain.com.key

        DocumentRoot /git/user
        ServerName user.mydomain.com

        SetEnv GIT_PROJECT_ROOT /git/user
        SetEnv GIT_HTTP_EXPORT_ALL

        <Directory />
          Options ExecCGI +FollowSymLinks +SymLinksIfOwnerMatch
          AuthType Basic
          AuthName "Private Git Access"
          AuthUserFile "/git/git-auth"
          Require valid-user
          AddHandler cgi-script .cgi
          DirectoryIndex gitweb.cgi
        </Directory>

        # This pattern matches git operations and passes them to http-backend
        ScriptAliasMatch "(?x)^/(.*/(HEAD | info/refs | objects/(info/[^/]+ | [0-9a-f]{2}/[0-9a-f]{38} | pack/pack-[0-9a-f]{40}\.(pack|idx)) | git-(upload|receive)-pack))$" /usr/libexec/git-core/git-http-backend/$1

</VirtualHost> 
```

我发现这是我管理 git 和用户的最简单方法。

但是，如果您遵循更传统的模型，则可以链接到每个用户主目录中的文件夹“git”。

```
our $per_request_config = sub {
        $projectroot = "/home/" . $cgi->remote_user . "/git/";
}; 
```

# c# - 无法获得动态调整控件大小的锚点

> ID：15283581
> 
> 赞同：0
> 
> 时间：2013-03-07T23:06:24.030
> 
> 标签：c#, winforms, resize, anchor, dock

我在一个组框中有两个控件（“波形”）。我希望他们也可以按高度动态调整大小，但不能让它工作。我使用 left|top|right 锚点进行第一个控制（“左通道”）和 left|bottom|right 锚点用于第二个控制（“右通道”）。

这是一个关于问题的[简短视频](http://www.youtube.com/watch?v=_baVj48xt4s)。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:11:56.177

如果您希望您的控件共享 的垂直空间`GroupBox`，您可以使用 a[`TableLayoutPanel`](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)或 a [`SplitContainer`](http://msdn.microsoft.com/en-us/library/system.windows.forms.splitcontainer.aspx)。

通过使用，[`TableLayoutPanel`](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)您可以轻松地指定控件应如何共享垂直空间。例如，您可以向 中添加两行，[`TableLayoutPanel`](http://msdn.microsoft.com/en-us/library/system.windows.forms.tablelayoutpanel.aspx)并分别给它们整个高度的 50%。

通过使用[`SplitContainer`](http://msdn.microsoft.com/en-us/library/system.windows.forms.splitcontainer.aspx)，用户可以在运行时更改控件的占用高度。

# c# - 如何让 XDocument.Load 保留换行符

> ID：15283585
> 
> 赞同：4
> 
> 时间：2013-03-07T23:06:40.617
> 
> 标签：c#, .net

```
using (System.IO.StreamReader sr = new System.IO.StreamReader(path, System.Text.Encoding.GetEncoding("Windows-1252"), true))
{ 

    xdoc = XDocument.Load(sr);
} 
```

这是我的 XML

```
<sheet name="sheet1" bounds="160,128,464,288">
    <text name="text1" bounds="160,128,464,288" text="a

    b"/>
</sheet> 
```

XDocument.Load 转换

```
a

b 
```

到

```
a b 
```

如何保留我的换行符？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T23:16:09.823

默认情况下，属性中的空格被规范化以转换为空格。在元素中使用新行而不是属性中的文本要安全得多。

如果它超出您的控制 - 将[XmlTextReader.Normalization](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.normalization.aspx)设置为`false`应该防止默认行为。

以下文章的部分示例：

```
// Create the XML fragment to be parsed. 
string xmlFrag  = 
@"<item attr1='  test A B C
    1 2 3'/>
  <item attr2='&#01;'/>";                         
XmlTextReader reader = new XmlTextReader(xmlFrag, XmlNodeType.Element, context);

// Show attribute value normalization.
reader.Read();
reader.Normalization = false;
Console.WriteLine("Attribute value:{0}", reader.GetAttribute("attr1"));
reader.Normalization = true;
Console.WriteLine("Attribute value:{0}", reader.GetAttribute("attr1")); 
```

# c - C、Windows API 创建注册表项后的文件夹结构

> ID：15283586
> 
> 赞同：2
> 
> 时间：2013-03-07T23:06:40.853
> 
> 标签：c, windows, api, directory, registry

所以我试图**在注册表项之后创建一个文件夹结构**。这是我到目前为止所做的

```
#include "stdafx.h"
#include "windows.h"
#define MAX_KEY_LENGTH 200
#define MAX_VALUE_NAME 16383
DWORD retCode;
void RecursiveQueryKey(HKEY hKey)
{
    HKEY nextKey;
    WCHAR    achKey[MAX_KEY_LENGTH];
    DWORD    cbName;             
    DWORD retCode = NULL;
    DWORD i=0;

    while(retCode !=ERROR_NO_MORE_ITEMS)
    {
        cbName = MAX_KEY_LENGTH;
        retCode = RegEnumKeyEx(hKey, i,achKey,&cbName,NULL,NULL,NULL,NULL);
        if (retCode == ERROR_SUCCESS)
        {
            wprintf(L"(%d) %s\n", i+1, achKey);

            WCHAR path[MAX_KEY_LENGTH];
            wchar_t *wcsncat(wchar_t *path, const wchar_t *achKey, size_t n);

            if(CreateDirectoryEx(TEXT("D:\\csso\\"),achKey, NULL) != 0){
                wprintf(L"Directory created in D:\\csso\\%s\n", achKey); 
            } else {
                printf("Directory failed with the error:");
            }
            wprintf(L"%d\n", GetLastError());
            if(RegOpenKeyEx(hKey, achKey,  0, KEY_READ | KEY_WOW64_64KEY,  &nextKey) == ERROR_SUCCESS)
            {
                RecursiveQueryKey(nextKey);
            }
        }
        i++;    
    }

}

int _tmain(int argc, _TCHAR* argv[])
{

         HKEY hKey;
     if(RegOpenKeyEx(HKEY_LOCAL_MACHINE,  TEXT("SOFTWARE\\Apple Inc."),  0, KEY_READ | KEY_WOW64_64KEY,  &hKey) == ERROR_SUCCESS)
     {
         printf("RegOpenKeyEx() is OK!\n");
         RecursiveQueryKey(hKey);   
     }
     else
         printf("RegOpenKeyEx() failed!\n");

     RegCloseKey(hKey);

} 
```

我对此很陌生，但是当我第一次运行程序时，它说目录已经全部创建但它们没有，当我再次运行它时，我得到错误**183**（已经存在）。

我真的不确定这里有什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T09:13:25.530

好的，所以我想通了，问题出在我无法创建路径，显然这很简单，这是我的最终代码，也许它会帮助某人。

```
#include "stdafx.h"
#include "windows.h"
#include "tchar.h"
#include <iostream>

#define KEY_LENGHT 255
#define MAX_VALUE_NAME 16000

#define DEFAULT_KEY L"Apple Inc."
WCHAR path[1024] = L"D:\\csso\\" DEFAULT_KEY;

void Query(HKEY key, WCHAR *path) {
    HKEY  next;
    WCHAR name[KEY_LENGHT];
    DWORD lpcname;
    DWORD returncode = NULL;
    DWORD i = 0;
    WCHAR xpath[1024];

    while(returncode != ERROR_NO_MORE_ITEMS) {
        lpcname = KEY_LENGHT;
        returncode =
            RegEnumKeyEx(key, i, name, &lpcname, NULL, NULL, NULL, NULL);

        if (returncode ==ERROR_SUCCESS) {

            wcscpy(xpath, path);
            wcscat(xpath, L"\\");
            wcscat(xpath, name);

            if(CreateDirectory(xpath, NULL)) {
                wprintf(L"Creat Folder %s\n", xpath);
            } else {
                printf("Folder nu a putut fi creat! \n");
                wprintf(L"%d\n", GetLastError());
            }

            DWORD verif = 
                RegOpenKeyEx(key, name, 0, KEY_READ | KEY_WOW64_64KEY, &next);
            if(verif == ERROR_SUCCESS) {
                Query(next, xpath);
            }
            i++;
        }
    }
}

int _tmain(int argc, _TCHAR* argv[])
{
    HKEY key;
    DWORD verif = 
        RegOpenKeyEx(HKEY_LOCAL_MACHINE,  TEXT("SOFTWARE\\" DEFAULT_KEY),  0, KEY_READ | KEY_WOW64_64KEY,  &key);

    if(verif == ERROR_SUCCESS) {
        printf("RegOpenKeyEx SUCCESS! \n");

        if(!CreateDirectory(_T("D:\\csso\\" DEFAULT_KEY), NULL)) {
            printf("Folder nu a putut fi creat! \n");
        } else {
            Query(key, path);
        }
    } else {
        printf("RegOpenKeyEx FAIL! \n");
        wprintf(L"%d\n", GetLastError);
    }

    RegCloseKey(key);
} 
```

祝你们好运，祝你们好运。

# asp.net - Ajax AutoCompleteExtender 不调用 wcf 服务

> ID：15283587
> 
> 赞同：0
> 
> 时间：2013-03-07T23:06:44.423
> 
> 标签：asp.net, ajax, wcf

我正在使用 asp.net 4.0 (vs2010)。我正在尝试实现 AutoCompleteExtender ajax 控件。起初我尝试使用页面方法，但由于我在用户控件中有扩展器，因此我无法使用此方法。我花了几天时间研究并确定我需要使用启用 Ajax 的 WCF 服务。所以我做了这个。我脱离了我的应用程序并创建了一个测试应用程序来模仿我正在尝试做的事情并且它可以工作。我将控件放在页面上，将其指向服务，瞧，它会触发事件并且效果很好。因此，我将带有必要更改的代码移植到我的主应用程序中，但它不起作用。不起作用我的意思是它不会触发服务中的事件。我怀疑问题出在 ServicePath 上，但我尝试了很多很多不同的路径，但似乎没有任何效果。

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
<ContentTemplate>
    <div style="float: left">
        <asp:Label runat="server">Site Id:</asp:Label><br />
        <asp:TextBox ID="txtSiteId" runat="server" AutoPostBack="True"     OnTextChanged="TextChangedEvent"></asp:TextBox>
    </div>
    <div style="float: left; width: 200px; padding-left: 20px; margin-right: 5px">
        <asp:Label runat="server">Entered Site Id's:</asp:Label><br />
        <asp:Repeater ID="rptSiteIds" runat="server" OnItemCommand="rptSiteIds_ItemCommand">
            <ItemTemplate>
                <asp:LinkButton id="lnkRemove" Width="50" runat="server" Text="remove" CommandName="remove"></asp:LinkButton>
                <asp:Label ID="lblItem" runat="server" Text='<%# Eval("Item") %>'></asp:Label>
            </ItemTemplate>
            <SeparatorTemplate>
                <br>
            </SeparatorTemplate>
        </asp:Repeater>
    </div>

    <Controls:ConfirmationModal runat="server" ID="MaxSiteIdConfirmation" ModalType="Alert" OnOkClicked="ConfirmationOk_Clicked"
        Title="Site Id Validation" Message="Too many site id's"
        Width="300" />

    <ajaxToolkit:AutoCompleteExtender
        runat="server"
        ID="AutoCompleteExtender"
        TargetControlID="txtSiteId" 
        CompletionSetCount="10"
        UseContextKey="True"
        ServicePath="~\DataServices\WebDataServices.svc"
        ServiceMethod="GetCompletionList" />

</ContentTemplate> 
```

这是来自服务的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.ServiceModel;
using System.ServiceModel.Activation;
using System.ServiceModel.Web;
using System.Text;

namespace Web.Internal.DataServices
{
    [ServiceContract(Namespace = "WebDataServices")]
    [AspNetCompatibilityRequirements(RequirementsMode =                     AspNetCompatibilityRequirementsMode.Allowed)]
public class WebDataServices
{
    // To use HTTP GET, add [WebGet] attribute. (Default ResponseFormat is     WebMessageFormat.Json)
    // To create an operation that returns XML,
    //     add [WebGet(ResponseFormat=WebMessageFormat.Xml)],
    //     and include the following line in the operation body:
    //         WebOperationContext.Current.OutgoingResponse.ContentType = "text/xml";
    [OperationContract]
    public void DoWork()
    {
        // Add your operation implementation here
        return;
    }

    // Add more operations here and mark them with [OperationContract]
    [OperationContract]
    public string[] GetCompletionList(string prefixText, int count)
    {
        //return names;
        String[] autoCompleteWordList = (from s in CreateList()
                                         where s.Contains(prefixText)
                                         select s).Take(count).ToArray();

        return autoCompleteWordList;
    }

    private string[] CreateList()
    {
        using (UnitOfWork uow = new UnitOfWork("DataService"))
        {
            return new ServiceDetailsBusiness(uow).GetDistinctIds().ToArray();
        }

    } 
} 
```

}

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:15:15.063

你需要做几件事：

您的服务方法需要使用以下属性进行修饰：

```
[System.Web.Services.WebMethod()]
[System.Web.Script.Services.ScriptMethod()] 
```

更新您的 OperationContract 属性，使其如下所示：

```
[OperationContract WebInvoke(Method="POST", ResponseFormat = WebMessageFormat.Json)] 
```

`return autoCompleteWordList`在方法中的语句之前添加以下代码片段。

```
 if (WebOperationContext.Current != null)
        WebOperationContext.Current.OutgoingResponse.ContentType = "application/json"; 
```

此外，请确保您可以从 Web 浏览器正确执行 Web 服务调用，并且所有元数据信息都正确显示。您是否在 web.config 文件中添加了任何 EndPoint 信息？

让我知道这是否可行。

# c# - Appfabric GetObjectsByTag 反序列化问题

> ID：15283592
> 
> 赞同：3
> 
> 时间：2013-03-07T23:07:02.907
> 
> 标签：c#, appfabric

我`DataCache.GetObjectsByTag`用来在删除缓存项之前提取依赖项。我的 web 应用程序将项目添加到缓存中，win 服务可以从缓存中删除项目。Win 服务没有对​​保存在缓存中的对象的二进制引用。

当 win 服务尝试删除缓存对象时，我得到

> 'System.IO.FileNotFoundException：无法加载文件或程序集'Web.Services.Contracts'。

我添加“Web.Services.Contracts”来赢得服务，它可以正常工作。

这是否意味着`DataCache.GetObjectsByTag`反序列化每个对象？

感谢你的帮助。APL

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T13:03:28.463

当然[DataCache.GetObjectsByTag](http://msdn.microsoft.com/en-us/library/microsoft.applicationserver.caching.datacache.getobjectsbytag%28v=azure.10%29.aspx)会下载客户端中的所有缓存对象。它类似于 DataCache.Get 或 DataCache.GetItem 但针对区域。

DataCacheItem 对象以序列化的形式存储在缓存集群中。如果客户端需要从缓存中获取项目，那么与这些序列化对象关联的程序集也必须被客户端引用。

# objective-c - 我正在尝试在 NSArray 中搜索字符串，但我研究的方法都不起作用

> ID：15283596
> 
> 赞同：0
> 
> 时间：2013-03-07T23:07:10.850
> 
> 标签：objective-c, parse-platform

我正在使用[Parse](http://parse.com)，我正在从数据浏览器中检索一个名为“用户名”的类。我得到了类中的所有对象，并将它们存储在一个数组中。然后我想在数组中搜索用户名，以便用户可以登录。我会为密码做同样的事情。这是我的代码：

```
- (IBAction)login:(id)sender
{
if ([usernameLogin.stringValue isEqualTo:@""] || [passwordLogin.stringValue isEqualTo:@""]) {
    NSBeginAlertSheet(@"Error", @"OK", nil, nil, self.window, self, @selector(sheetDidEnd:resultCode:contextInfo:), NULL, NULL, @"Please fill in all fields.");
}

/* retrieve user from parse db */
PFQuery *usernameQuery = [PFQuery queryWithClassName:@"usernames"];
[usernameQuery findObjectsInBackgroundWithBlock:^(NSArray *usernames, NSError *error) {

    NSString *userString = [NSString stringWithFormat:@"%@", usernameLogin.stringValue];
    NSLog(@"USERS:\n %@", usernames);

    int i;
    for (i = 0; i < [usernames count]; i++) {
        NSString *userFind = [usernames objectAtIndex:i];
        if ([userString isEqualToString:userFind]) {
            NSLog(@"FOUND!!!");
        }
    }

    /*
    if ([usernames indexOfObject:usernameLogin.stringValue]) {
        NSLog(@"User: '%@' was found successfully!", usernameLogin.stringValue);

    } else {
        NSLog(@"User: '%@' doesn't exist in database, or password was incorrect!", usernameLogin.stringValue);
    }
    */
}];

gameCont = [[CSGameController alloc] initWithWindowNibName:@"CSGameController"];
[gameCont showWindow:self];
[gameCont.window makeKeyAndOrderFront:nil];
_window.isVisible = false;
} 
```

谁能解释我做错了什么？我正在搜索数据库以查看输入的用户是否存在。我设置了一个测试用户，它仍然说它不存在。非常感谢！添加：

```
 int i;
    for (i = 0; i < [usernames count]; i++) {
        NSString *userFind = [usernames objectAtIndex:i];
        NSLog(@"UserFind class = %@, value = %@", [userFind class], userFind);
    } 
```

输出：

```
[2438:303] UserFind class = PFObject, value = <usernames:kx7aG2xfkX:(null)> {
username = ryan; 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T17:38:11.540

看来您在这里尝试做很多没有意义的事情。请考虑阅读[Parse iOS 指南](https://parse.com/docs/ios_guide)。所有 PFQueries 都返回 PFObjects。PFObjects 在很多方面都像 NSDictionaries；它们是数据库中的一条记录，可以获取或存储。PFQuery 总是返回一个或多个 PFObject。一个 PFQuery 的结果应该几乎总是可以被确定为立即有用的。在这个例子中，equals 条件可以用 -[PFQuery whereKey:equalTo:] 来表达。*很多*_*让 Parse 更快地为您进行搜索。这还允许您通过 PFQueryTableViewController 创建由查询结果提供支持的 UI。最后，请不要制作自己的登录代码。您当前的代码很容易被黑客入侵，不仅允许任何人以任何人的身份登录，而且还可以学习任何人的密码。为用户帐户使用内置的 PFUser 类。它处理安全登录、凭据的离线缓存、密码重置、电子邮件验证，除了用户名/密码之外，您还可以让用户使用他们的 Facebook 或 Twitter 帐户登录，Parse 具有用于登录和创建帐户的内置视图控制器PF 用户。PFUsers 也是保护您数据的方式；PFACL 是一个访问控制列表，可让您决定哪些 PFUser 可以读取或写入数据。*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T00:43:13.837

您尝试使用的错误是`isEqualToString`：使用 userFind，即`PFObject`.

尝试与它的`username`属性进行比较：

```
 ...
    for (PFObject *aUsername in usernames) 
    {           
        NSString *userFind = [aUsername objectForKey:@"username"];

        if ([userString isEqualToString:userFind]) {
        NSLog(@"FOUND!!!");
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T03:12:20.553

问题已解决：我使用了 Parse 的 User 类。他们有预先存在的注册用户的方法，就像我在自己的课程中尝试做的那样。他们的注册方法是：

```
 PFUser *user = [PFUser user];
    user.email    = emailField.stringValue;
    user.username = usernameField.stringValue;
    user.password = passwordField.stringValue;
    [user signUpInBackgroundWithBlock:^(BOOL succeeded, NSError *error) { 
```*

# spring - 使用 WSDL 生成 Spring Source Endpoints

> ID：15283606
> 
> 赞同：0
> 
> 时间：2013-03-07T23:07:33.450
> 
> 标签：spring, wsdl, spring-ws

您能否使用来自 WSDL 的 @EndPoint 注释将完整的合同和请求/响应对象生成为 Spring Source Web Service 格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T13:34:27.693

这些对象不会自动生成。WSDL 就是合同——在那里您会找到**targetNamespace**和**localPart**。例如

```
<xsd:schema targetNamespace="this:is.the.target:namespace" xmlns="this:is.the.target:namespace" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
     <xsd:element name="myLocalPart">
        <xsd:complexType> 
```

localPart**是**SOAP 请求负载的根 XML 元素。现在，您定义一个端点：

```
@Endpoint
public class MyEndpoint {
    @PayloadRoot(namespace="this:is.the.target:namespace", localPart="myLocalPart")
    @ResponsePayload
    public void handleRequest(@RequestPayload final Element elem) {
        // do something here...
    } 
```

如果您正确设置了 Spring-Ws 调度程序，那么这至少足以接受请求。如果您希望请求自动解组，则必须设置一个编组器/解组器并以某种方式定义 OXM 映射。

# c++ - 将 C++ 模板类型 T 修改为“long T”？

> ID：15283607
> 
> 赞同：12
> 
> 时间：2013-03-07T23:07:34.160
> 
> 标签：c++, templates, types

有没有办法将乘法返回的精度加倍（以避免溢出）？

```
template<class T> class MyClass {
     T multiply (T a, T b) { return a * b; }
} 
```

就像是：

```
long T multiply (T a, T b) { return a * b; } 
```

因此，无论给出“int”、“long”还是“double”，乘法都会返回“long int”、“long long”或“long double”。

这是一个普遍的问题。我正在通过在内部使用双精度来解决它。但我的问题是，是否有任何机制可以将类型提升为 C++ 中的“长”变体？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-07T23:15:49.997

一个可能的解决方案是定义自己的类型特征：

```
template<typename T>
struct add_long { typedef T type; };

template<>
struct add_long<int> { typedef long int type; };

template<>
struct add_long<double> { typedef long double type; };

template<>
struct add_long<long int> { typedef long long int type; };

// And so on... 
```

这是您在课堂上使用它的方式：

```
template<class T>
class MyClass {
public:
    typedef typename add_long<T>::type longT;
    longT multiply (longT a, longT b) { return a * b; }
}; 
```

这是一个小测试：

```
#include <type_traits>

int main()
{
    MyClass<int> m;
    auto l = m.multiply(2, 3);
    static_assert(std::is_same<decltype(l), long int>::value, "Error!");
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-08T06:06:47.060

@Andy 有正确的答案，效果很好。但是对于那些想要在 MyClass 被实例化为没有“长”值的类型时出现编译时错误的人，我将它与@SteveJessop 的优秀评论相结合以提供以下解决方案：

```
// --- Machinery to support double-precision 'T' to avoid overflow in method 'multiply' ---
// Note: uncomment typedef if don't want compile-time errors 
// when no "long" type exists
// ----
template<typename T>
struct add_long { /*typedef T type;*/ };

template<> struct add_long<int8_t>   { typedef int16_t  type; };
template<> struct add_long<int16_t>  { typedef int32_t  type; };
template<> struct add_long<int32_t>  { typedef int64_t  type; };
template<> struct add_long<uint8_t>  { typedef uint16_t type; };
template<> struct add_long<uint16_t> { typedef uint32_t type; };
template<> struct add_long<uint32_t> { typedef uint64_t type; };

template<> struct add_long<float>    { typedef double        type; };
template<> struct add_long<double>   { typedef long double   type; }; 
```

“longT”的示例用法：

```
template<class T> class MyClass
{
    // Note: a compiler error on the next line means that 
    //       class T has no double-precision type defined above.
    typedef typename add_long<T>::type longT;
public:
    longT multiply (T a, T b) { return longT(a) * b; }
} 
```

MyClass 的示例用法：

```
MyClass<float> my;
printf("result = %lf\n", my.multiply(3.4e38, 3.4e38)); 
```

# ruby - 循环中的局部变量

> ID：15283608
> 
> 赞同：1
> 
> 时间：2013-03-07T23:07:37.850
> 
> 标签：ruby, erb

我在 ERB 模板中有以下代码：

```
<% ['foo', 'bar'].each do |var| %>
  <%= previous %>
  <% previous = "#{var}" %>
<% end %> 
```

我希望它输出`foo`，但它什么也不输出，`previous`总是`nil`。`previous`没有在循环之外定义，第一个赋值发生在第一个循环结束之后。

这就是我渲染模板的方式：

```
f.write ERB.new(File.read(node)).result(namespace.instance_eval { binding }) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:10:51.173

尝试这个

```
<% previous = "" %>
<% ['foo', 'bar'].each do |var| %>
  <%= previous %>
  <% previous = var %>
<% end %> 
```

# database - Google 的 Spanner DB 是否实现了 Epochal Time 的概念？

> ID：15283611
> 
> 赞同：0
> 
> 时间：2013-03-07T23:07:51.840
> 
> 标签：database, datomic, google-cloud-spanner

我正在阅读[Google 的 Spanner DB](http://static.googleusercontent.com/external_content/untrusted_dlcp/research.google.com/en/us/archive/spanner-osdi2012.pdf)的论文。这似乎解决了[Rich Hickey 的 Datomic 的](http://www.datomic.com/)一些类似问题。

Google 的 Spanner DB 是否实现了[Epochal Time](http://www.infoq.com/presentations/Datomic-Database-Value)的概念？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T03:22:02.713

*摘要：我是这么认为的，但我不确定“纪元时间”的概念到底是什么。*

* * *

我观看了问题中引用的整个视频（幸运的是，这是一个有趣的视频），除了 Hickey 将未来视为纯过去的功能（至少在数据库方面）[1]，或者更准确地说，作为一系列事务功能的组合。

字里行间，我相信其核心思想是时间可以被划分为量子，每一个量子代表单个事务函数的完整执行。（我猜 Hickey 会说这些量子是“纪元”，但也许我错了；Datomic 词汇表中“纪元”的定义只是有点相关。）因为每个事务函数有效地包含了它自己执行的断言，事务标识符可以被认为是时间量的代理；实际上，与单个交易者一起使用的交易标识符可能被迫成为与某些机器的时钟巧合地相关的单调递增的数字序列（尽管不完全相等，因为各个时钟可以不时地向后跳过。）

所以我将这个想法解释为两个方面：

1.  为每个突变附加一个“时间戳”；和

2.  安排突变以添加而不是替代过去的数据。

如果是这样，那么 Bigtable（具有一些实现限制）和 Spanner 都符合 Hickey 的模型。

* * *

Bigtable[2] 提供了一个键-时间戳-值映射，但它留给每个应用程序来保证时间戳的单调性。对于实现单调时间戳并使用单个写入器的应用程序，它看起来与 Datomic 非常相似；它还基于不可变的数据结构并允许基于时间戳的查询（“过去是现在的子范围”）。然而，正如 Spanner 论文 [3] 所指出的，Bigtable 不提供同步更新，因此无法保证从副本读取的两个不同键将具有相同的过去子范围。由于这显然导致 Google 内部团队使用昂贵、缓慢的 Bigtable 替代方案，因此 Spanner 旨在以相对有效的方式提供同步更新，即使以使交易更加昂贵为代价。如果我正确理解了 Spanner 论文，

尽管 Spanner 提供了“类似 SQL”的 API，但其内部数据存储（如 Bigtable）是键-时间戳-值。与 Bigtable 不同，时间戳由交易者提供，并保持在与实时的仔细监控偏差范围内（谷歌显然购买了自己的原子钟，“不那么昂贵”，以帮助维持这种保证）。Datomic 在设计上是一个单一的交易者系统，但允许配置备用交易者以实现高可用性。（只有一个，如果我正确阅读了文档。）这使得时间同步更容易，并且它还使用实时作为时间戳。

在某种程度上，所有三个数据库系统在概念上都提供了按时间排序的突变。它们在保证不同突变上时间戳的一致性和单调性方面有所不同，在提供全局读写一致性的实际能力方面也有所不同，但它们都满足了 Hickey 在演讲的前几分钟所提出的相同基本特征：突变（“更新”）是数据模型的一部分，易于解释，并且基本上是非破坏性的。

* * *

[1]：在视频大约 19 分钟后，Hickey 表示“纪元时间模型”只是他想出的一个短语，并没有正式的定义。

[2]：大约 42 分钟后，Hickey 描述了 Bigtable 架构，显然是他正在谈论的一个例子。Spanner 显然是一种后继技术，它扩展但不取代底层数据模型。

[3]：[PDF：来自 OSDI 2012 的扫描仪论文](http://static.googleusercontent.com/external_content/untrusted_dlcp/research.google.com/en//archive/spanner-osdi2012.pdf)

# datetime - Powershell - 将军事时间字符串转换为日期时间

> ID：15283618
> 
> 赞同：0
> 
> 时间：2013-03-07T23:08:13.963
> 
> 标签：datetime, powershell, time

我正在寻找一种将军事时间字符串（“22:12:02”）转换为日期时间对象的方法。

下面是代码示例：

```
$TimePrevious = $Null
[array]$TimeArray = "22:12:02.000", "22:12:03.000", "23:12:02.000"

$TimeArray | ForEach-Object {
    $TimeCurrent = $_.Substring(0,8)
    $TimeDifference = [datetime]$TimeCurrent.TimeOfDay - [datetime]$TimePrevious.TimeOfDay
    If ($TimeDifference.Second -lt "10") {Write-Host "$_ is less than 10 seconds"}
    $TimePrevious = $_
    } 
```

错误显示“无法将“System.TimeSpan”类型的“22:12:02”值转换为“System.DateTime”类型

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:16:54.173

默认解析器似乎可以使用：

```
[datetime]"22:12:02" 
```

2013 年 3 月 7 日星期四晚上 10:12:02

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:43:44.250

对不起。我刚刚开始工作：

```
$TimePrevious = $Null
[array]$TimeArray = "22:12:02.000", "22:12:03.000", "23:12:02.000"

$TimeArray | ForEach-Object {
    $TimeCurrent = $_.Substring(0,8)
    $TimeDifference = [datetime]$TimeCurrent - [datetime]$TimePrevious
    If ($TimeDifference.TotalSeconds -lt "10") {Write-Host "$_ is less than 10 seconds"}
    $TimePrevious = $_
    } 
```

感谢您的快速回复。

# c# - MVC、视图和 System.Data.Entity

> ID：15283622
> 
> 赞同：2
> 
> 时间：2013-03-07T23:08:22.887
> 
> 标签：c#, asp.net-mvc, entity-framework

我有一个添加到我的 MVC 应用程序的存储库项目。

在 MVC Web 应用程序的 C# 代码中，我必须添加对 System.Data.Entity 的引用，以便我可以从我的存储库访问对象。

因此，如果我没有添加参考，则以下失败；

```
DataRepository<Store> repo = new DataRepository<Store>();
List<Store> allSorted = repo.All(x => x.name); 
```

现在我想将该列表传递给我的局部视图，它位于 FVM 中，它是我传递给局部视图的 FVM。

所以index.aspx代码；

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master" Inherits="System.Web.Mvc.ViewPage<StoresFVM>" %>

<% Html.RenderPartial("StoreList", Model.StoreListFVM); %> 
```

以及 ASCX 代码；

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<StoreListFVM>" %>

<%        
    SelectList storeList = new SelectList(Model.Stores.Select(x => new { Value = x.number, Text = x.name }),"Value","Text");
%>

<%= Html.DropDownList("SelectedStore", storeList) %> 
```

但是，我收到一条错误消息，通知我需要在 ascx 中包含对 System.Data.Entity 的引用。我不明白为什么。

我尝试将命名空间添加到 web.config 文件中，并尝试在 ascx 页面的顶部导入命名空间。

想法？

**编辑**

> \nasfile02\Visual Studio 2010\Projects\TOM\TOM\Views\Stores\PartialViews\StoreList.ascx(4)：错误 CS0012：类型 'System.Data.Objects.DataClasses.EntityObject' 是在不是参考。您必须添加对程序集“System.Data.Entity，Version=4.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”的引用。

**编辑**

```
namespace TOM.FormViewModels
{
    public class StoresFVM
    {
        public StoreListFVM StoreListFVM { get; set; }
    }
}

namespace TOM.FormViewModels
{
    public class StoreListFVM
    {
        public List<Store> Stores { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-08T00:33:16.337

您应该确保 web.config 如下所示：

```
<compilation debug="true" targetFramework="4.0">
  <assemblies>
    <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
  </assemblies>
</compilation> 
```

也描述在：[https ://stackoverflow.com/a/3611040/1737862](https://stackoverflow.com/a/3611040/1737862)

# java - 将整数数组存储到列表整数数组中并按顺序访问这些变量

> ID：15283625
> 
> 赞同：0
> 
> 时间：2013-03-07T23:08:45.233
> 
> 标签：java, arrays, printing

好的，所以我有这段代码，我想存储整数数组 intwholef[x] 的值，并将这些值存储在数组 Wholelist[y] 中。唯一的问题是我设置它的方式是我取数组的前三个值并将它们存储在 intwholef[x] 中，然后 x 在下一行传递时正在重置。图形表示如下

这是存储在字符串数组中的文件内容

```
intwholef[0] = 1 3 10
intwholef[1] = 2 4 15
intwholef[2] = 3 6 8
intwholef[3] = 4 7 3
intwholef[4] = 5 9 12 
```

现在我想要的是像这样存储的那些值。

```
wholelist[] = 1,3,10,2,4,15,3,6,8,4,7,3,5,9,12 
```

并且可以访问

```
wholelist[2] * wholelist[5] = 150; 
```

我遇到的问题是我无法将值保存在这样的列表中，有什么想法吗？

这是整个代码，我正在谈论的部分在底部

```
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.Scanner;

public class project1
{
    @SuppressWarnings("null")
    public static void main(String[] args)
    {
        System.out.println("These are your following choices: ");
        System.out.println("1\. First-Come First-Served (FCFS): ");
        System.out.println("2\. Shortest Job Next (SJN): ");
        System.out.println("3\. Shortest Remaining Time (SRT): ");
        System.out.println("4\. Round Robin (RR) with time quantum = 4 ms: ");
        System.out.println("please enter your choice by entering 1, 2, 3, 4");
        Scanner in = new Scanner(System.in);
        int choice = in.nextInt();
        if(choice ==1)
        {
            System.out.println("your choice was first come first serve");
        }
        else if(choice == 2)
        {
            System.out.println("your choice was shortest job next");
        }
        else if(choice == 3)
        {
            System.out.println("your choice was shortest job remaining");
        }
        else if(choice == 4)
        {
            System.out.println("your choice was round robin (rr) with time quantum = 4 ms");
        }
        else
        {
            System.out.println("you entered an invalid choice");
        }
        BufferedReader file = null;

        System.out.println("Please enter the file path for your input");
        Scanner fp = new Scanner(System.in);
        String input = fp.nextLine();
        String fileloc;
        String[] wholef = null;
        int fline = 0;
        try 
        {
            file = new BufferedReader(new FileReader(input));
            fileloc = file.readLine();
            fline = Integer.parseInt(fileloc);  // this stands for file contents from the file to be read
            wholef = new String[fline];
            int i = 0;
            while((fileloc = file.readLine()) != null)
            {
                wholef[i] = fileloc;
                System.out.print("the contents of this file are: ");
                System.out.println(fileloc);
                i++;
            }
        System.out.println("This is the contents of the file stored in an array of strings");
        for(int n = 0; n < fline; n++)
        {
            System.out.println(wholef[n]);
        }
        } catch (IOException er)
        {
            er.printStackTrace();
        }
        finally
        {
        try
        {
            if(file != null)
            {
                file.close();
            }
        } catch(IOException erx)
        {
            erx.printStackTrace();
        }
        }

        System.out.println("This is the size of the contents of the file");
        for(int n = 0; n < fline; n++)
        {
            System.out.println(wholef[n].length());
        }

        System.out.println("this is the input file converted and stored into an array of integers");

        String[] parts = null;
        int[] intwholef = null;
        int[] wholelist =null;
        for(int x = 0; x < fline; x++)
        {
            parts = wholef[x].split(" ");

            intwholef= new int[parts.length];

            for(int n = 0; n < parts.length; n++)
            {
                intwholef[n] = Integer.parseInt(parts[n]);
                System.out.println(/*"intwholef[" + n + "] = " + */intwholef[n]);
                for(int m = 0; m < parts.length; m++)
                {
                    //wholelist[m]= intwholef[n];
                }
            }
        }

        System.out.println("this is the list of number from the conversion dumped into a singular array list");

        for(int i = 0; i < 15; i++)
        {
            System.out.println("intwholef[" + i + "] = " + wholelist[i]);
        }
        /*
        System.out.println("operations done with array of ints");
        for(int i = 0; i < 20; i++)
        {
            System.out.println(intwholef[i]);
        }
        //System.out.println(intwholef[0] * intwholef[3]);
        */

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:18:48.597

我建议您使用列表（如 ArrayList）而不是数组，因为它的大小可以改变。像这样：

```
ArrayList wholeList = new ArrayList<Integer>();
for(int x = 0; x < fline; x++)
    {
        parts = wholef[x].split(" ");
        for(int n = 0; n < parts.length; n++)
        {
            wholeList.add(Integer.parseInt(parts[n]));
        }
    } 
```

然后您可以使用 访问不同的值`wholeList.get(index)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:21:57.720

您可以简单地使用 ArrayList 来完成。如果您想以数组结尾，请使用该`toString`方法。用 分割字符串`\\s`，以便任何空格都可以用作分隔符。此外，您只需要循环，如下所示：

```
 int[] myArray = new int[10];
    List<Integer> list = new ArrayList<Integer>();
    while ((fileloc = file.readLine()) != null) {
        for (String s : fileloc.split("\\s+")) {
            list.add(Integer.parseInt(s));
        }
        System.out.println(Arrays.toString(myArray));
    }
    int[] wholelist = list.toArray(); 
```

# ios - Xcode 新手如何创建类

> ID：15283627
> 
> 赞同：3
> 
> 时间：2013-03-07T23:08:48.350
> 
> 标签：ios, objective-c, xcode

大家好，我目前已经开始使用 xcode 和 Objective C，我只想知道如何在我的程序中创建一个特定的类。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-07T23:22:02.317

以下是添加新类的步骤。

![新文件](../Images/462432cee83224ab411108c6ea2cf3ad.png) ![Objective-C 类](../Images/3e7086beeb1d92e5e83adb1616d01fbe.png) ![为新类命名](../Images/04bb3540017b286f29bb2ba8f3e702aa.png) ![选中目标框](../Images/65ac23df8fa9902539e5d59cf54c7651.png) ![查看新的类文件](../Images/1c381424ea148fc80479902d096bc1be.png)

# web-services - WebService 中的静态哈希表

> ID：15283634
> 
> 赞同：0
> 
> 时间：2013-03-07T23:09:11.980
> 
> 标签：web-services, hashtable, c#-2.0

我开发了一个简单的 XML Web 服务，它使用静态哈希表来存储数据库中的两个列表。哈希表最初在第一次调用 Web 服务时加载了值。Web 服务在 Visual Studio IDE 中运行良好。

当它部署在 IIS（7.0 版）中时，它会引发空指针异常。错误消息指向从哈希表中获取对值的函数。

我的问题是：1）是否可以在 Web 服务的整个生命周期中将静态哈希表存储在 Web 服务中。2）在访问哈希表之前是否应该每次检查哈希表是否为空？3) 使用静态哈希表的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:14:14.620

这里最可能的问题是，在生产环境中，您的 Web 服务正在处理多个同时调用。这些调用显示为单独的线程，它们`HashTable`以不安全的方式访问单个线程。这些不安全的访问导致内部数据`HashTable`被破坏，从而导致`NullReferenceException`

您需要`HashTable`使用锁来保护对此的访问，以便从 Web 服务中的静态字段安全地访问它

# asp.net - IE9标准模式和Compability View模式对齐

> ID：15283637
> 
> 赞同：0
> 
> 时间：2013-03-07T23:09:23.610
> 
> 标签：asp.net, css

我有以下 aspx 代码片段。在 IE9 标准模式下，即使第一个 listLabel 的左侧没有任何内容，第一个 listLabel 仍会向右对齐，并为剩余的 listLabel 及其 ListBoxes 强制下移一行。在 IE9 兼容视图模式下，所有 listLabels 和 ListBoxes 都在同一行。我尝试了许多 css 设置但没有成功。我不喜欢使用浮动。有谁知道为什么会发生这种情况以及如何解决这个问题？谢谢。

```
label.listLable
{
    /*vertical-align:top;*/
    font-weight:bold;
}

    <asp:Content ID="pageContent" ContentPlaceHolderID="ContentPlaceHolder1" runat="Server">
        <div>
            <div>
                <label for="<%=listPcpPanel.ClientID%>" class="listLable">Panel: </label>
                <asp:ListBox ID="listPcpPanel" runat="server" SelectionMode="Multiple" Rows="1">
                    <asp:ListItem Value="&lt;----- All -----&gt;" Selected="True"></asp:ListItem>
                </asp:ListBox>
                <label for="<%=listFacilityService.ClientID%>" class="listLable">Service: </label>
                 <asp:ListBox ID="listFacilityService" runat="server" SelectionMode="Single" Visible="true" Rows="1">
                    <asp:ListItem Value="&lt;---Select one---&gt;" Selected="True"></asp:ListItem>
                </asp:ListBox>
                <label for="<%=listRole.ClientID%>" class="listLable">Role: </label>
                <asp:ListBox ID="listRole" runat="server" SelectionMode="Multiple" Visible="true" Rows="1">
                    <asp:ListItem Value="&lt;----- All -----&gt;" Selected="True"></asp:ListItem>
                </asp:ListBox>
            </div>
        ...
        ...
        </div>
    </asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:07:34.343

我通过删除 <asp:content> 的第一个 <div> 子项解决了这个问题。

# android - OpenGL ES 2.0片段着色器中的Android YUV-RGB转换

> ID：15283638
> 
> 赞同：0
> 
> 时间：2013-03-07T23:09:26.227
> 
> 标签：android, opengl-es-2.0, fragment-shader

我试图在android上的OpenGL ES 2.0片段着色器代码中找到/弄清楚如何将YUV纹理（例如YUV420P）颜色转换为RGB。我找到了各种指针/提示，但无法正确转换。有谁知道是否有任何适用于 android 的示例工作项目？

# c# - 在 ComboBoxItem 模板中使用 DisplayMemberPath

> ID：15283639
> 
> 赞同：5
> 
> 时间：2013-03-07T23:09:27.500
> 
> 标签：c#, wpf, xaml

目前，我已经硬编码了应该显示的 DataContext 对象的属性 (DisplayName)。但通常您在 ComboBox 本身中使用属性 DisplayMemberPath 指定此路径。如何使用 DisplayMemberPath 指定的值作为要在内容呈现器中绑定的属性？

```
<Style TargetType="{x:Type ComboBoxItem}">
        <Setter Property="SnapsToDevicePixels" Value="True" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate>
                    <Border x:Name="ItemBorder"
                            Padding="2,0"
                            BorderThickness="1"
                            CornerRadius="3">

                        <ContentPresenter Content="{Binding DisplayName}"/>

                    </Border>

                    <ControlTemplate.Triggers>
                        <Trigger SourceName="ItemBorder" Property="IsMouseOver" Value="True">
                            <Setter TargetName="ItemBorder" Property="Background" Value="{StaticResource LightBlueBackgroundBrush}"/>
                            <Setter TargetName="ItemBorder" Property="BorderBrush" Value="{StaticResource LightBlueBackgroundBrush}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

作为参考，这是我的 ComboBox 样式。

```
<Style TargetType="{x:Type ComboBox}">
    <Setter Property="SnapsToDevicePixels" Value="True" />
    <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
    <Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
    <Setter Property="Height" Value="22"/>
    <Setter Property="Background" Value="White"/>
    <Setter Property="BorderBrush" Value="{StaticResource MidGreyBorderStroke}"/>
    <Setter Property="Border.CornerRadius" Value="3" />
    <Setter Property="IsEditable" Value="False" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type ComboBox}">

                <Border Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="1"
                        CornerRadius="{TemplateBinding Border.CornerRadius}"
                        Width="{TemplateBinding Width}"
                        Height="{TemplateBinding Height}">

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <ContentPresenter x:Name="ReadOnlyContentPresenter"
                                          Grid.Column="0"
                                          Margin="5,0"
                                          VerticalAlignment="Center"
                                          HorizontalAlignment="Left"
                                          Content="{TemplateBinding SelectionBoxItem}"
                                          ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                          ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" />

                        <TextBox x:Name="PART_EditableTextBox"
                                 Grid.Column="0"
                                 Margin="5,0"
                                 VerticalAlignment="Center"
                                 HorizontalAlignment="Center"
                                 Visibility="Hidden"
                                 IsReadOnly="{TemplateBinding IsReadOnly}" />

                        <Border Grid.Column="1"    
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="1,0,0,0"
                                Margin="0,2" />

                        <ToggleButton Grid.Column="2"
                                      Margin="1,0"
                                      Background="{TemplateBinding Background}"
                                      VerticalAlignment="Center"
                                      HorizontalAlignment="Right"
                                      Focusable="False"
                                      IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                      ClickMode="Press"
                                      Style="{StaticResource ComboBoxToggleButton}"/>

                        <Popup x:Name="PART_Popup"
                               AllowsTransparency="True"
                               Placement="Bottom"
                               IsOpen="{TemplateBinding IsDropDownOpen}"
                               Focusable="False"
                               PopupAnimation="Fade"
                               SnapsToDevicePixels="True">

                            <Grid Background="Transparent"
                                  MinWidth="{TemplateBinding ActualWidth}"
                                  MaxHeight="{TemplateBinding MaxDropDownHeight}">

                                <Border x:Name="DropDownBorder"
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="{TemplateBinding Border.CornerRadius}"
                                        Margin="0,2,0,0">

                                    <ScrollViewer Margin="6,0">
                                        <StackPanel IsItemsHost="True"
                                                    KeyboardNavigation.DirectionalNavigation="Contained" />
                                    </ScrollViewer>
                                </Border>
                            </Grid>
                        </Popup>
                   </Grid>
                </Border>

                <ControlTemplate.Triggers>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Opacity" Value=".65" />
                    </Trigger>

                    <Trigger Property="HasItems" Value="false">
                        <Setter TargetName="DropDownBorder" Property="MinHeight" Value="42"/>
                    </Trigger>

                    <Trigger Property="IsEditable" Value="True">
                        <Setter Property="IsTabStop" Value="false"/>
                        <Setter TargetName="PART_EditableTextBox" Property="Visibility" Value="Visible"/>
                        <Setter TargetName="ReadOnlyContentPresenter" Property="Visibility" Value="Hidden"/>
                    </Trigger>
                </ControlTemplate.Triggers>

            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-08T05:11:03.050

嗯，这实际上是一个有趣的问题，答案很简单。

**简短的回答**：

```
 <ContentPresenter /> 
```

**长答案：**

如果您已经覆盖了`ComboBoxItem`样式，但您仍想从中使用`DisplayMemberPath`，`ComboBox`则不必将任何内容放入 Styles`Content`绑定中，因为`Parent`(ComboBox) 将为您解决此问题。因为`DisplayMemberPath`只是一个字符串而不是实际属性，所以如果您绑定到`DisplayMemberPath`所有项目将只显示您输入的任何值`DisplayMemberPath`

所以你所要做的就是从Style中删除`Content`绑定`ComboBoxItem`

例子：

```
<Style TargetType="{x:Type ComboBoxItem}">
    .............
    <Border x:Name="ItemBorder" Padding="2,0"  BorderThickness="1"  CornerRadius="3">
        <ContentPresenter /> <!-- no content binding -->
    </Border> 
```

这是一个显示此工作的简单示例

xml:

```
<Window x:Class="WpfApplication13.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" x:Name="UI" Width="343" Height="744.625" >
    <Window.Resources>
        <Style TargetType="{x:Type ComboBoxItem}">
            <Setter Property="SnapsToDevicePixels" Value="True" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="ItemBorder" Padding="2,0"  BorderThickness="1"  CornerRadius="3">
                            <ContentPresenter />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <StackPanel DataContext="{Binding ElementName=UI}">
        <ComboBox ItemsSource="{Binding Items}" DisplayMemberPath="Name" HorizontalAlignment="Left" VerticalAlignment="Top" Width="120"/>
        <ComboBox ItemsSource="{Binding Items}" DisplayMemberPath="State" HorizontalAlignment="Left" VerticalAlignment="Top" Width="120"/>
    </StackPanel>

</Window> 
```

代码：

```
public partial class MainWindow : Window
{

    public MainWindow() 
    {
        InitializeComponent();

        for (int i = 0; i < 50; i++)
        {
            Items.Add(new ComboBoxModel { Name = "Name" + i, State = "State" + i });
        }
    }

    private ObservableCollection<ComboBoxModel> _items = new ObservableCollection<ComboBoxModel>();
    public ObservableCollection<ComboBoxModel> Items
    {
        get { return _items; }
        set { _items = value; }
    }

}

public class ComboBoxModel
{
    public string Name { get; set; }
    public string State { get; set; }
} 
```

结果：

![在此处输入图像描述](../Images/9997db78b126c156f8a80a787c3ecaea.png) ![在此处输入图像描述](../Images/cdb65b1c0f3c8167f9b6e5d5e25aab2d.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-07T23:13:20.940

试试这个

```
<ContentPresenter Content="{TemplateBinding DisplayMemberPath}"/> 
```

# rest - Sinatra 和 AngularJS 之间的 CORS 问题

> ID：15283640
> 
> 赞同：2
> 
> 时间：2013-03-07T23:09:31.673
> 
> 标签：rest, angularjs, xmlhttprequest, cross-domain, sinatra

我在使用一个非常基本的网络应用程序时遇到了麻烦。这是我的文件：

# 公共/index.html

```
<!DOCTYPE html>

<html lang="en" data-ng-app>
  <body>

    <div data-ng-controller="PlayersCtrl">
      <div data-ng-repeat="player in players">
        {{player.id}}
      </div>
    </div>

    <script src="/angular.min.js"></script>
    <script src="/players.js"></script>
  </body>
</html> 
```

# 公共/players.js

```
function PlayersCtrl($scope, $http) {
  $scope.players = [];

  $http({
    method: 'GET',
    url: 'http://localhost:9292/hi'
  }).success(function(data) {
    $scope.players = data;
  });
} 
```

# 客户端.rb

```
require 'sinatra'

get '/' do
  headers 'Access-Control-Allow-Origin' => '*'
  headers 'Access-Control-Allow-Headers' => 'Authorization,Accepts,Content-Type,X-CSRF-Token,X-Requested-With'
  headers 'Access-Control-Allow-Methods' => 'GET,POST,PUT,DELETE,OPTIONS'

  send_file File.join(settings.public_folder, 'index.html')
end 
```

# api.rb

```
require 'sinatra'
require 'json'

get '/hi' do
  headers 'Access-Control-Allow-Origin' => '*'
  headers 'Access-Control-Allow-Headers' => 'Authorization,Accepts,Content-Type,X-CSRF-Token,X-Requested-With'
  headers 'Access-Control-Allow-Methods' => 'GET,POST,PUT,DELETE,OPTIONS'

  [id: 1, name: "Bob"].to_json
end 
```

对我来说，这似乎很好。然后，我启动服务器：

# 启动 api.rb

```
$ ruby api.rb -p 9292
[2013-03-07 23:57:43] INFO  WEBrick 1.3.1
[2013-03-07 23:57:43] INFO  ruby 2.0.0 (2013-02-24) [x86_64-darwin12.2.0]
== Sinatra/1.3.5 has taken the stage on 9292 for development with backup from WEBrick
[2013-03-07 23:57:43] INFO  WEBrick::HTTPServer#start: pid=62634 port=9292 
```

# 启动客户端.rb

```
$ ruby client.rb
[2013-03-07 23:57:40] INFO  WEBrick 1.3.1
[2013-03-07 23:57:40] INFO  ruby 2.0.0 (2013-02-24) [x86_64-darwin12.2.0]
== Sinatra/1.3.5 has taken the stage on 4567 for development with backup from WEBrick
[2013-03-07 23:57:40] INFO  WEBrick::HTTPServer#start: pid=62610 port=4567 
```

但是当我在本地主机（端口 4567）上使用浏览器时，我有以下日志：

# api.rb 日志

```
127.0.0.1 - - [07/Mar/2013 23:57:46] "OPTIONS /hi HTTP/1.1" 404 442 0.0015
localhost - - [07/Mar/2013:23:57:46 CET] "OPTIONS /hi HTTP/1.1" 404 442
http://localhost:4567/ -> /hi 
```

# client.rb 日志

```
127.0.0.1 - - [07/Mar/2013 23:57:46] "GET / HTTP/1.1" 304 - 0.0093
localhost - - [07/Mar/2013:23:57:46 CET] "GET / HTTP/1.1" 304 0
- -> / 
```

我做了很多关于*跨域资源共享*的搜索，并测试了许多不同的方法。我目前不知道如何处理。感谢您的任何帮助。

**编辑：**

我的问题是，api.rb 服务器`error 404`在 AngularJS 调用之后返回一个。而且，有两个`OPTIONS /hi`请求，这很奇怪。我认为这是 CORS 症状，但我添加了一些标题以接受跨域查询。

取而代之的是，服务器应返回`200`带有 JSON 的 a。我真的不知道如何解决它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-11T16:26:34.940

我必须将以下内容添加到我的 sinatra 应用程序中才能使其与 CORS 和 angular 一起使用：

```
options "*" do
  response.headers["Allow"] = "HEAD,GET,PUT,DELETE,OPTIONS"

  # Needed for AngularJS
  response.headers["Access-Control-Allow-Headers"] = "X-Requested-With, X-HTTP-Method-Override, Content-Type, Cache-Control, Accept"

  halt HTTP_STATUS_OK
end 
```

我也使用[了 sinatra-cross_origin](https://github.com/britg/sinatra-cross_origin)，但您可能不需要在手动设置标题时看到它。

# windows - 确定现有连接是否在 Windows 下使用 TCP KeepAlive

> ID：15283649
> 
> 赞同：6
> 
> 时间：2013-03-07T23:10:22.043
> 
> 标签：windows, winsock, keep-alive

在 Windows（Vista 和更高版本）中，有一种方法或工具可以帮助确定是否使用 SO_KEEPALIVE 选项创建了现有的、已建立的传出 TCP 连接。

在 Unix 平台上，这通常可以使用 netstat 来查看（即，“netstat -o”将为 KEEPALIVE 显示单独的列）。

Windows 上的 Netstat 没有此功能。我测试过的其他 Microsoft/SysInternals 网络工具也没有。

我似乎无法找到可以提供此信息的工具。

场景是：在 Windows 2008 R2 服务器上运行的应用程序需要在它建立的所有连接上启用 TCP keepalive。某些应用程序没有启用 TCP keepalive 的选项，我需要一些方法来确定这些应用程序是否默认启用它。

需要说明的是：我需要一些工具，或者关于如何编写工具的建议，以显示现有的 winsock 连接是否启用了 TCP keepalive。虽然还有其他方法可以确定这一点（例如嗅探流量并查看是否发送了保活数据包），但它们都带有不确定性。此外，我们正在谈论大量的服务器和大量的应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-27T20:23:24.673

使用 WireShark 查看 TCP Keepalive 数据包。如果您需要像我一样检查环回，请使用[https://github.com/nmap/npcap](https://github.com/nmap/npcap)

# data-visualization - 如何从数据中创建“矢量电影”？

> ID：15283651
> 
> 赞同：1
> 
> 时间：2013-03-06T19:49:47.217
> 
> 标签：data-visualization

随着时间的推移，我可以使用哪些文件格式和软件将矢量图像表示为动画，而不会影响矢量格式的优势？

假设我生成的数据最好表示为平面中的单个点，随时间移动。我想做一个动画来显示这个点的运动。一种方法是制作一系列 2D 位图图像并将它们串在一起形成一个 AVI 文件。但这会产生巨大的文件（比基础数据集大几个数量级）或质量非常低的动画。一堆光栅图像是数据的一种非常低效的表示。

一个更好的表示将是[2D*矢量*图像](http://en.wikipedia.org/wiki/Vector_graphics)序列。矢量图像结合了非常高的保真度和小文件大小。但是有可能将这些图像串成动画吗？从底层数据集开始，可以使用什么样的软件来做到这一点？

我想可以在这里使用 Adob​​e Flash 之类的工具，但这似乎类似于在 Illustrator 中从头开始制作散点图：当然，它可以完成并且看起来不错，但这不是制作散点图的方式。您使用 R、Excel 或 MATLAB，然后可能在图形程序中润饰绘图。我正在寻找一个同样有效的解决方案，但用于制作动态可视化而不是绘图。

# mysql - mysql中的ActiveRecord DATETIME列值

> ID：15283653
> 
> 赞同：1
> 
> 时间：2013-03-07T23:10:31.410
> 
> 标签：mysql, ruby-on-rails, activerecord

我是新手`ActiveRecord`，正在尝试做一些相当简单的事情。我搜索了互联网，无法提出解决方案。

在 mysql 中，我有一个类型为`DATETIME`. 该表中已经包含许多值。此列的一些示例值为`NULL`、`0000-00-00 00:00:00`和`2009-04-30 10:30:22`

使用`rails`and`ActiveRecord`我可以从数据库中检索记录。但是，当我要求一个`DATETIME`字段的值时`0000-00-00 00:00:00`，我得到的结果值是一个`nil`对象。

的数据库值`NULL`也返回一个`nil`对象，这是有道理的。

`2009-04-30 10:30:22`返回的数据库值`Thu, 30 Apr 2009 10:30:22 UTC +00:00`也很有意义。

我认为使用`_before_type_cast`可能会有所帮助，但事实并非如此。

如何确定返回的对象是否具有数据库值`0000-00-00 00:00:00`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:54:09.680

似乎 Rails 中没有内置的方法可以绕过将该日期转换为非零值。

无法解决此问题的事实表明您可能正在以非最佳方式做某事，因此我的第一个建议是尽可能将所有`0000-00-00 00:00:00`值迁移到`nil`。

如果那不是一个选择。您可以`0000-00-00 00:00:00`通过 sql 条件查看是否有任何一条记录具有如下内容：

```
Post.where("date_field = '0000-00-00 00:00:00' && id = ?", post.id).exists? 
```

希望有帮助。

# java - Windows bat 文件确定 Java 安装是 32 位还是 64 位？

> ID：15283660
> 
> 赞同：3
> 
> 时间：2013-03-07T23:10:56.060
> 
> 标签：java, batch-file, 32bit-64bit

是否可以使用 Windows 批处理文件来确定安装的 Java 版本（假设为 7）是 32 位版本还是 64 位版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T23:33:04.547

这是一个小的 Windows 脚本，可以帮助您开始确定 Java32、Java64 和 JavaNotInstalled。

根据需要调整...

```
@echo off
java -d64 -version >nul 2>&1
if errorlevel 1 goto maybe32bit
echo Java is 64 bit 
goto EXIT
:maybe32bit
where java >nul 2>&1
if errorlevel 1 goto nojava
echo Java is 32 bit 
goto EXIT
:nojava
echo Java is not installed
:EXIT 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:16:06.463

是的，有可能。bat 文件可以运行`java -version`并解析输出。

# classification - 橙色用于数据挖掘和看不见的测试集

> ID：15283669
> 
> 赞同：2
> 
> 时间：2013-03-07T03:08:07.807
> 
> 标签：classification, data-mining, svm

我正在使用 Orange 进行数据挖掘 ( [http://orange.biolab.si/](http://orange.biolab.si/) ) 1 和 LinearSVM 尤其如此。有没有办法保存学习模型并将其与看不见的测试集一起使用？我需要查看预测结果并将模型应用于新数据。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T12:39:16.510

这里是

```
import Orange, cPickle
from Orange.classification import svm

data = Orange.data.Table("2_new.tab")
classifier = svm.LinearSVMLearner(data, folds=10)
cPickle.dump(classifier, open("linear_svm.pck", "wb"))

# later:

classifier = cPickle.load(open('linear_svm.pck'))
data_validation = Orange.data.Table('show.tab')
print 'predictions:'
for e in data_validation:
    print e, "\t", classifier(e) 
```

# php - 评论系统 CSS 文本开箱即用

> ID：15283672
> 
> 赞同：2
> 
> 时间：2013-03-07T23:11:37.090
> 
> 标签：php, css

我最近使用 PHP 编写了一个简单的评论系统。

[http://runescapepvp.net/jony/index.php](http://runescapepvp.net/jony/index.php)

正如您在我发布的以下链接中看到的那样，如果评论很长，它将开箱即用。我不确定为什么在我为文本设置最大宽度时会发生这种情况。

我用这个来调用盒子

```
function showComments() {
    $query = mysql_query("SELECT * FROM `comments` ORDER BY `comment_id` DESC LIMIT 5") or die (mysql_error());
    $allcomments = mysql_query("SELECT * FROM `comments` ORDER BY `comment_id`") or die (mysql_error());
    if (mysql_num_rows($query) == 0) {
        echo '<br /><br />';
        handleAlerts("noComments");
    } else {
        while ($row = mysql_fetch_assoc($query)) {
            echo "
            <br />
            <br />
            <div class='comments'>
                <div class='title'><span class='author'>Posted by: ".$row['comment_guest']."</span><span class='date'>At ".$row['comment_time'].", ".$row['comment_date']."</span></div>
                <div class='comment'>
                    <span class='message'>
                    ".$row['comment']."
                    </span>
                    <br />
                    <a href='index.php?delete=comment&id=".$row['comment_id']."'><div class='button_delete'>Delete</div></a>
                </div>
            </div>
            ";
        }
    }
        echo '<br /><br /><br />';
} 
```

CSS：

```
.title {
background-image: url("../img/header.png"); background-repeat: repeat-x;
width: 100%;
height: 56px;
border: solid 1px #a8a8a8;
line-height: 56px;
font-size: 17px;
color: grey;
text-align: left;
display: block;
}

.comments {
position: relative;
top: 50px;
}

.comment {
width: 640px;
height: auto;
display: block;
min-height: 100px;
background-color: #e6e6e6;
border-left: solid 1px #a8a8a8;
border-right: solid 1px #a8a8a8;
border-bottom: solid 1px #a8a8a8;
}

.message {
width: 600px;
display: block;
margin-left: auto;
margin-right: auto;
padding-top: 10px;
} 
```

为什么会这样？我不确定该错误是否与 PHP 有关。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:15:14.527

您可以尝试将此 CSS 添加到您的`.comment`课程中：

```
word-break: break-all; 
```

或者

```
overflow: auto; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:16:05.270

你可以在css中解决这个问题：

要隐藏不属于框的内容：

```
.comment {
  overflow: hidden;
} 
```

要使用新的 css3 属性来打断长字：

```
.comment {
  word-break: break-all;
} 
```

# qt4 - 在 QTreeView 上的子项上设置小部件

> ID：15283677
> 
> 赞同：4
> 
> 时间：2013-03-07T23:11:51.947
> 
> 标签：qt4, pyqt, qtreeview, qabstractitemmodel

多亏了这个[线程](https://stackoverflow.com/questions/9668983/qtreeview-vs-setindexwidget)`QAbstractItemView`，我能够将小部件添加[到](http://qt-project.org/doc/qt-4.8/qtreeview.html)`view`.

但是是否可以将小部件添加到子项？

这是我尝试过的部分进展顺利：

```
#!/usr/bin/env python
import os

from PyQt4.QtCore import QModelIndex, Qt
from PyQt4.QtGui import QApplication, QItemSelectionModel, \
                        QPushButton, QStandardItem, \
                        QStandardItemModel, QTreeView
from PyQt4.uic import loadUi

class PrvTreeviewNest(QTreeView):
    def __init__(self):
        super(PrvTreeviewNest, self).__init__()

        loadUi('/home/user/yourproject/resource/treeview_nest.ui')

        # row can be 0 even when it's more than 0.
        self._datamodel = QStandardItemModel(0, 2)
        self.setModel(self._datamodel)

        for i in range(4):
            self._add_widget(i + 1)

        self.show()

    def _add_widget(self, n):
        std_item = QStandardItem('{}th item'.format(n))
        self._datamodel.setItem(n, 0, std_item)

        node_widget = QPushButton('{}th button'.format(n))
        qindex_widget = self._datamodel.index(n, 1, QModelIndex())
        self.setIndexWidget(qindex_widget, node_widget)

        if n == 2:
            std_item_child = QStandardItem('child')
            std_item.appendRow(std_item_child)

            node_widget_child = QPushButton('petit button')
            qindex_widget_child = self._datamodel.index(n, 1, QModelIndex())
            self.setIndexWidget(qindex_widget_child, node_widget_child)

if __name__ == '__main__':
    import sys
    app = QApplication(sys.argv)
    # window = TreeviewWidgetSelectProve()
    window = PrvTreeviewNest()
    # window = TreeviewWidgetSelectProve()
    window.resize(320, 240)
    # window.show();
    window.setWindowTitle(
         QApplication.translate("toplevel", "Top-level widget"))
    # window.add_cols()

    sys.exit(app.exec_()) 
```

[treeview_nest.ui](http://pastebin.com/G0DhQay3)可用。

您在下图中看到该项目`child`没有显示按钮并且其父按钮被覆盖。显然我不知道如何为它编写代码。

![在此处输入图像描述](../Images/a6c95ceb9483a82fb6ace578f6b7ecef.png)

* * *

**更新**）我想出了如何为孩子添加小部件。棘手的是，使用[QStandardItem.insertRow](http://qt-project.org/doc/qt-4.8/qstandarditem.html#insertRow)与 index 结合可以完成工作。在我上面的示例代码中，替换`_add_widget`为以下内容：

```
 def _add_widget(self, n):
        item_toplevel = QStandardItem('{}th item'.format(n))
        self._datamodel.setItem(n, 0, item_toplevel)

        widget_toplevel = QPushButton('{}th button'.format(n))
        qindex_toplevel = self._datamodel.index(n, 1, QModelIndex())
        self.setIndexWidget(qindex_toplevel, widget_toplevel)

        if n == 2:
            item_child_col0 = QStandardItem('child col0')
            item_child_col1 = QStandardItem('child col1')
            #item_toplevel.appendRow(item_child_col0)

            item_toplevel.insertRow(0, [item_child_col0, item_child_col1])

            widget_child = QPushButton('child widget')
            qindex_child = item_child_col1.index()
            self.setIndexWidget(qindex_child, widget_child) 
```

我确信这不是最好/理想的设计方式，但似乎对我有用。在受到@Phlucious 回答的启发后，我提出了这个想法。谢谢！

![在此处输入图像描述](../Images/232e38f1ec7825e69c3052e796404820.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:50:32.833

你的错误在这一行：

```
qindex_widget_child = self._datamodel.index(n, 1, QModelIndex())
self.setIndexWidget(qindex_widget_child, node_widget_child) 
```

**它为您提供模型**第 2 行第 1 列的索引，这是“第 2 项”，而不是您的孩子。您的孩子位于 的第 1 行第 1 列`std_item`。在 Qt 中，尤其是在 QStandardItemModel 中，Children 是相对于它们的 parent 而存储的，而不是相对于模型。

我对 PyQt 不够熟悉，无法为您提供确切的代码，但您应该能够执行以下操作：

```
qindex_widget_child = std_item_child.index(QModelIndex())
self.setIndexWidget(qindex_widget_child, node_widget_child) 
```

或像这样：

```
qindex_widget_child = std_item.child(0, 1).index(QModelIndex())
self.setIndexWidget(qindex_widget_child, node_widget_child) 
```

# java - SSLContext 证书链未填充到上下文中

> ID：15283682
> 
> 赞同：1
> 
> 时间：2013-03-07T23:12:04.887
> 
> 标签：java, authentication, certificate

请帮助了解如何向 SSL 上下文提供证书链。

简介：我正在使用 EWSJavaAPI 1.2 连接到 ms 交换。它使用 TLS 连接和双向身份验证，基于我自己的公司颁发的证书，由 my-CA 签署，派生自 my-root-cert。所有这些实体都存在，但我只使用 PFX。

我用一个 PFX 密钥初始化 SLLcontext 并使用 TRUST-ALL 实现作为信任管理器。

我的项目依赖项：

```
 <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
    <dependency>
      <groupId>commons-httpclient</groupId>
      <artifactId>commons-httpclient</artifactId>
      <version>3.1</version>
    </dependency>
    <dependency>
      <groupId>commons-codec</groupId>
      <artifactId>commons-codec</artifactId>
      <version>1.7</version>
    </dependency>
    <dependency>
      <groupId>jcifs</groupId>
      <artifactId>jcifs</artifactId>
      <version>1.3.17</version>
    </dependency>
    <dependency>
      <groupId>commons-logging</groupId>
      <artifactId>commons-logging</artifactId>
      <version>1.1.1</version>
      <classifier>adapters</classifier>
    </dependency>
    <dependency>
      <groupId>EWSJavaAPI</groupId>

          <artifactId>EWSJavaAPI</artifactId>
          <version>1.2</version>
        </dependency>
      </dependencies> 
```

我要连接的示例：

```
package mail.msexchangetest;

import java.io.FileInputStream;
import java.io.IOException;
import java.net.URI;
import java.net.URISyntaxException;
import java.security.KeyStore;
import java.security.SecureRandom;
import java.security.cert.Certificate;
import javax.net.ssl.HandshakeCompletedEvent;
import javax.net.ssl.HandshakeCompletedListener;
import javax.net.ssl.KeyManagerFactory;
import javax.net.ssl.SSLContext;
import javax.net.ssl.SSLSession;
import javax.net.ssl.SSLSocket;
import javax.net.ssl.SSLSocketFactory;
import javax.net.ssl.TrustManager;
import javax.net.ssl.TrustManagerFactory;
import javax.net.ssl.X509TrustManager;
import microsoft.exchange.webservices.data.ClientCertificateCredentials;
import microsoft.exchange.webservices.data.EmailMessage;
import microsoft.exchange.webservices.data.ExchangeCredentials;
import microsoft.exchange.webservices.data.ExchangeService;
import microsoft.exchange.webservices.data.ExchangeVersion;
import microsoft.exchange.webservices.data.Folder;
import microsoft.exchange.webservices.data.FolderId;
import microsoft.exchange.webservices.data.Mailbox;
import microsoft.exchange.webservices.data.MessageBody;
import microsoft.exchange.webservices.data.ServiceLocalException;
import microsoft.exchange.webservices.data.WebCredentials;
import microsoft.exchange.webservices.data.WellKnownFolderName;

\/**
 * 
 *
 *\/
public class App \{

    private static TrustManagerFactory tmf;
    private static SSLContext ctx ;

    private static TrustManager[] trustAllCerts = new TrustManager[] {
        new X509TrustManager(){
            public java.security.cert.X509Certificate[] getAcceptedIssuers() {
                    return null;
            }

            public void checkClientTrusted(java.security.cert.X509Certificate[] certs, String    authType){
            }

            public void checkServerTrusted(java.security.cert.X509Certificate[] certs, String authType){
            }
        }};
        // The trust all certs.

        private static void setSSLConfigManual() throws Exception 
        {

            KeyStore ks=KeyStore.getInstance("pkcs12");
            ks.load(new FileInputStream("/home/user/Documents/private/mail-cert/compUser.pfx"),"mypass".toCharArray());

            System.out.println("init Stores...");

            KeyManagerFactory kmf=KeyManagerFactory.getInstance("SunX509");
            kmf.init(ks,"mypass".toCharArray());

            ctx= SSLContext.getInstance("TLS");

            ctx.init(kmf.getKeyManagers(), trustAllCerts, new SecureRandom());

            SSLContext.setDefault(ctx);

        }

    public static void main( String[] args ) throws URISyntaxException, Exception
    {

        setSSLConfigManual();

        System.out.println("=============BEGIN HANDSHAKE=============");
        testConnect();
        System.out.print(">");
        System.in.read();
        System.out.println("=============END HANDSHAKE=============");

        System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
        System.out.println("=============BEGIN EXCHANGE_2007 MESSAGE SEND=============");
        try{
            send2007Message();
        } catch (Exception ex){
            System.out.println("=============ERROR EXCHANGE_2007 MESSAGE SEND=============");
            System.out.print(">");
            System.in.read();
            ex.printStackTrace();
            System.out.print(">");
            System.in.read();
        }
        System.out.println("=============END EXCHANGE_2007 MESSAGE SEND=============");

        System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
        System.out.println("=============BEGIN EXCHANGE_2010 MESSAGE SEND=============");
        try{
            send2010Message();            
        } catch (Exception ex){
            System.out.println("=============ERROR EXCHANGE_2010 MESSAGE SEND=============");        
            System.out.print(">");
            System.in.read();
            ex.printStackTrace();
            System.out.print(">");
            System.in.read();
        }
        System.out.println("=============END EXCHANGE_2010 MESSAGE SEND=============");        

    }

    private static void send2010Message() throws ServiceLocalException, Exception, URISyntaxException {
        ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2010_SP2);

        ExchangeCredentials credentials = new WebCredentials(
                                                "username",
                                                "userpass","DOMAIN");
        service.setCredentials(credentials);

        service.setTraceEnabled(true);        
        service.setUrl(new URI("https://mail.server.country/"));

        service.setTimeout(100*1000);

        Folder myFolder = new Folder(service);
        myFolder.setDisplayName("My EWS Test Folder");
        FolderId rootFolderId = new FolderId(WellKnownFolderName.Root, new Mailbox("user@server.country" ));
        myFolder.save(rootFolderId);

        EmailMessage msg= new EmailMessage(service);
        msg.setSubject("Test message "+System.currentTimeMillis()); 
        msg.setBody(MessageBody.getMessageBodyFromText("Sent using the EWS Managed API."));
        msg.getToRecipients().add("User@gmail.com");

        msg.send();
    }

    private static void send2007Message() throws ServiceLocalException, Exception, URISyntaxException {
        ExchangeService service = new ExchangeService(ExchangeVersion.Exchange2007_SP1);

        ExchangeCredentials credentials = new WebCredentials(
                                                "user",
                                                "pass","DOMAIN");
        service.setCredentials(credentials);

        service.setTraceEnabled(true);                
        service.setUrl(new URI("https://legacy.server.country"));
        service.setTimeout(100*1000);

        EmailMessage msg= new EmailMessage(service);
        msg.setSubject("Test message "+System.currentTimeMillis()); 
        msg.setBody(MessageBody.getMessageBodyFromText("Sent using the EWS Managed API."));
        msg.getToRecipients().add("User@gmail.com");

        msg.send();
    }

    private static void testConnect() throws IOException {
        SSLSocketFactory factory = ctx.getSocketFactory();
        SSLSocket sslsocket = (SSLSocket) factory.createSocket( 
                "mail.server.country",443);
        sslsocket.setUseClientMode(true);
        sslsocket.setSoTimeout(100000);
        sslsocket.addHandshakeCompletedListener(new MyHandshakeListener());
        sslsocket.startHandshake();           
    }
    public static class MyHandshakeListener implements HandshakeCompletedListener {
        public void handshakeCompleted(HandshakeCompletedEvent e) {
            System.out.println("Handshake succesful!");
            System.out.println("Using cipher suite: " + e.getCipherSuite());
        }
    }

} 
```

微软交换响应：

> 403 禁止。该页面需要客户端证书作为身份验证过程的一部分。如果您使用智能卡，则需要插入智能卡以选择适当的证书。否则，请联系您的服务器管理员。(12213)

握手记录：

```
counrtrycoden:
init Stores...
***
found key for : inertnal-signed-user-alias-key-bla-bla-bla
chain [0] = [
[
  Version: V3
  Subject: CN=mycompuser, O=MYCOMP
  Signature Algorithm: SHA1withRSA, OID = 1.2.840.113549.1.1.5

  Key:  Sun RSA public key, 2048 bits
  modulus: BLABLABLA30690710815572912647945BLABLABLALABLA41197645359BLABLABLA883372709604731441625160BLABLABLA76697727043202584363067604BLABLABLA343388760502527327190704030612675772856546529931228983792825447712271
  public exponent: 65537
  Validity: [From: Thu Oct 25 09:44:41 MSK 2012,
               To: Mon Sep 01 15:04:44 MSK 2014]
  Issuer: CN=mycompany External CA, O=mycompany, C=counrtrycode
  SerialNumber: [    13bla267 00bla00 bla]

Certificate Extensions: 9
[1]: ObjectId: 1.bla13549.bla15 Criticality=false
Extension unknown: DER encoded OCTET string =
0000: 04 37 30 35 30 0E 06 08   2A 86 48 86 F7 0D 03 02  .7050...*.H.....
BLABLABLA

[2]: ObjectId: 1.3.6.1.4.1.311.21.10 Criticality=false
Extension unknown: DER encoded OCTET string =
0000: 04 28 30 26 30 0C 06 0A   2B 06 01 04 01 82 37 0A  .(0&0...+.....7.
BLABLABLA

[3]: ObjectId: 1.3.6.1.4.1.311.21.7 Criticality=false
Extension unknown: DER encoded OCTET string =
0000: 04 31 30BLABLABLA06   01 04 01 82 37 15 08 84  .10/.'+.....7...
0010: F3 D1 3C 87 F2 87 61 87   BD 9B BLABLABLA01 64  ..5.*...;...>..d
BLABLABLA

[4]: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false
AuthorityInfoAccess [
  [
   accessMethod: ocsp
   accessLocation: URIName: http://pki.mycompany.counrtrycode/pki/aia/Cert01.glupka-and-tupka.mcmp.counrtrycode_mycompany%20External%20CA.crt
, 
   accessMethod: caIssuers
   accessLocation: URIName: ldap:///CN=mycompany%20External%20CA,CN=AIA,CN=Public%20Key%20Services,CN=Services,CN=Configuration,DC=glupka-and-tupka,DC=mcmp,DC=counrtrycode?cACertificate?base?objectClass=certificationAuthority
, 
   accessMethod: ocsp
   accessLocation: URIName: http://extpki.glupka-and-tupka.mcmp.counrtrycode/CertEnroll/Cert01.glupka-and-tupka.mcmp.counrtrycode_mycompany%20External%20CA.crt
]
]

[5]: ObjectId: 2.5.29.35 Criticality=false
AuthorityKeyIdentifier [
KeyIdentifier [
0000: DB F3 38 88 08 D3 25 A2   D6 3E 5A C2 28 6D 21 09  ..8...%..>Z.(m!.
BLABLABLA
]
]

[6]: ObjectId: BLABLABLA.31 Criticality=false
CRLDistributionPoints [
  [DistributionPoint:
     [URIName: http://pki.mycompany.counrtrycode/pki/cdp/mycompany%20External%20CA.crl, URIName: ldap:///CN=mycompany%20External%20CA,CN=Cert01,CN=CDP,CN=Public%20Key%20Services,CN=Services,CN=Configuration,DC=glupka-and-tupka,DC=mcmp,DC=counrtrycode?certificateRevocationList?base?objectClass=cRLDistributionPoint, URIName: http://extpki.glupka-and-tupka.mcmp.counrtrycode/CertEnroll/mycompany%20External%20CA.crl]
]]

[7]: ObjectId: BLABLABLA Criticality=false
ExtendedKeyUsages [
  1.3.6.1.4.1.311.10.3.4
  emailProtection
  clientAuth
]

[8]: ObjectId: BLABLABLA Criticality=false
KeyUsage [
  DigitalSignature
  Key_Encipherment
  Data_Encipherment
]

[9]: ObjectId: BLABLABLA Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: A4 AD 53 4BLABLABLA8   56 FB 4B 52 E3 09 AD 01  .BLABLABLA.KR....
BLABLABLA                                     X...
]
]

]
  Algorithm: [SHA1withRSA]
  Signature:
0000: 9A C3 A3 3CBLABLABLAB9 80   8D F9 7CBLABLABLA8 11 EC  ...<.S......a...
BLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLA
SUPERLONGBLABLABLA
...
BLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLA
BLA0: DA 8FBLABLABLACC 96 B5   69 B2 BLABLABLADB 56  ...o`...i.V..h.V

]
***
trigger seeding of SecureRandom
done seeding SecureRandom
=============BEGIN HANDSHAKE=============
Ignoring unavailable cipher suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA
Ignoring unavailable cipher suite: TLS_DHE_RSA_WITH_AES_256_CBC_SHA
Ignoring unavailable cipher suite: TLS_ECDH_RSA_WITH_AES_256_CBC_SHA
Ignoring unsupported cipher suite: TLS_DHE_DSS_WITH_AES_128_CBC_SHA256
Ignoring unsupported cipher suite: TLS_DHE_DSS_WITH_AES_256_CBC_SHA256
Ignoring unsupported cipher suite: TLS_DHE_RSA_WITH_AES_128_CBC_SHA256
Ignoring unsupported cipher suite: TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256
Ignoring unsupported cipher suite: TLS_DHE_RSA_WITH_AES_256_CBC_SHA256
Ignoring unsupported cipher suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384
Ignoring unsupported cipher suite: TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384
Ignoring unsupported cipher suite: TLS_RSA_WITH_AES_256_CBC_SHA256
Ignoring unavailable cipher suite: TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA
Ignoring unsupported cipher suite: TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256
Ignoring unsupported cipher suite: TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384
Ignoring unavailable cipher suite: TLS_DHE_DSS_WITH_AES_256_CBC_SHA
Ignoring unsupported cipher suite: TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384
Ignoring unsupported cipher suite: TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256
Ignoring unsupported cipher suite: TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256
Ignoring unavailable cipher suite: TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA
Ignoring unavailable cipher suite: TLS_RSA_WITH_AES_256_CBC_SHA
Ignoring unsupported cipher suite: TLS_RSA_WITH_AES_128_CBC_SHA256
Allow unsafe renegotiation: false
Allow legacy hello messages: tcounrtrycodee
Is initial handshake: tcounrtrycodee
Is secure renegotiation: false
Allow unsafe renegotiation: false
Allow legacy hello messages: tcounrtrycodee
Is initial handshake: tcounrtrycodee
Is secure renegotiation: false
main, setSoTimeout(100000) called
%% No cached client session
*** ClientHello, TLSv1
RandomCookie:  GMT: 1362721181 bytes = { 236, 175, 168, 239, 233, 179, 57, 191, 201, 185, 133, 27, 224, 105, 83, 227, 128, 210, 87, 189, 75, 234, 192, 181, 96, 94, 243, 25 }
Session ID:  {}
Cipher Suites: [TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_AES_128_CBC_SHA, TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDH_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA, TLS_ECDHE_ECDSA_WITH_RC4_128_SHA, TLS_ECDHE_RSA_WITH_RC4_128_SHA, SSL_RSA_WITH_RC4_128_SHA, TLS_ECDH_ECDSA_WITH_RC4_128_SHA, TLS_ECDH_RSA_WITH_RC4_128_SHA, TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, SSL_RSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA, SSL_RSA_WITH_RC4_128_MD5, TLS_EMPTY_RENEGOTIATION_INFO_SCSV]
Compression Methods:  { 0 }
Extension elliptic_curves, curve names: {secp256r1, sect163k1, sect163r2, secp192r1, secp224r1, sect233k1, sect233r1, sect283k1, sect283r1, secp384r1, sect409k1, sect409r1, secp521r1, sect571k1, sect571r1, secp160k1, secp160r1, secp160r2, sect163r1, secp192k1, sect193r1, sect193r2, secp224k1, sect239k1, secp256k1}
Extension ec_point_formats, formats: [uncompressed]
Extension server_name, server_name: [host_name: services.mycompany.counrtrycode]
***
main, WRITE: TLSv1 Handshake, length = 174
main, READ: TLSv1 Handshake, length = 5660
*** ServerHello, TLSv1
RandomCookie:  GMT: 1362721181 bytes = { 237, 63, 191, 247, 95, 109, 54, 253, 237, 198, 229, 127, 137, 49, 141, 141, 138, 20, 157, 117, 43, 124, 8, 94, 102, 171, 72, 136 }
Session ID:  {8, 30, 0, 0, 253, 200, 140, 197, 123, 73, 65, 166, 251, 106, 43, 119, 244, 46, 193, 144, 144, 57, 178, 24, 197, 204, 154, 63, 191, 102, 249, 105}
Cipher Suite: TLS_RSA_WITH_AES_128_CBC_SHA
Compression Method: 0
Extension renegotiation_info, renegotiated_connection: <empty>
***
%% Initialized:  [Session-1, TLS_RSA_WITH_AES_128_CBC_SHA]
** TLS_RSA_WITH_AES_128_CBC_SHA
*** Certificate chain
chain [0] = [
[
  Version: V3
  Subject: CN=ol.mycompany.counrtrycode, OU=IT, O=mycompany, L=supercity, ST=counrtrycode, C=counrtrycode
  Signature Algorithm: SHA1withRSA, OID = BLA.2.BLABLA.BLA.49.1.1.5

  Key:  Sun RSA public key, 2048 bits
  modulus: BLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLA890852115164310867BLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLA2675606906943672823219951400362124850736118214751967190281153250333278526809862357346858437645387972960703158481657469928478498122472555889883930655301090187944200780810614568244173675337773013453127652176661961716518027910113380649734092379900012537169502795030097799607532413142973889150997564045268730052023211864684133008169849100098476577268849374370540710200206831212156277099733103668127156062641899305BLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLA
  public exponent: 65537
  Validity: [From: Thu Nov 15 08:56:19 MSK 2012,
               To: Mon Sep 01 15:04:44 MSK 2014]
  Issuer: CN=mycompany External CA, O=mycompany, C=counrtrycode
  SerialNumber: [    221f33ee 00000000 8011]

Certificate Extensions: 9
[1]: ObjectId: 1.3.BLABLA311.21.10 Criticality=false
Extension unknown: DER encoded OCTET string =
0000: 04 0BLA06 08   2B BLA05 BLA3 01  ..BLA...+BLA....

[2]: ObjectId: BLABLA.1.311.21.7 Criticality=false
Extension unknown: DER encoded OCTET string =
0000: BLA30 2F 06 27 2B 06   01 04 01 82BLA 08 84  .10/.'+.....7...
BLABLA                                      ...

[3]: ObjectId: 1.3.6.1.5.5.7.1.1 Criticality=false
AuthorityInfoAccess [
  [
   accessMethod: ocsp
   accessLocation: URIName: http://pki.mycompany.counrtrycode/pki/aia/Cert01.glupka-and-tupka.mcmp.counrtrycode_mycompany%20External%20CA.crt
, 
   accessMethod: caIssuers
   accessLocation: URIName: ldap:///CN=mycompany%20External%20CA,CN=AIA,CN=Public%20Key%20Services,CN=Services,CN=Configuration,DC=glupka-and-tupka,DC=mcmp,DC=counrtrycode?cACertificate?base?objectClass=certificationAuthority
, 
   accessMethod: ocsp
   accessLocation: URIName: http://extpki.glupka-and-tupka.mcmp.counrtrycode/CertEnroll/Cert01.glupka-and-tupka.mcmp.counrtrycode_mycompany%20External%20CA.crt
]
]

[4]: ObjectId: 2.5.29.35 Criticality=false
AuthorityKeyIdentifier [
KeyIdentifier [
0000: DB F3 38 88 08 D3 25 A2   D6 3E 5A C2 28 6D 21 09  ..8...%..>Z.(m!.
BLABLA                                       ....
]
]

[5]: ObjectId: 2.5.29.31 Criticality=false
CRLDistributionPoints [
  [DistributionPoint:
     [URIName: http://pki.mycompany.counrtrycode/pki/cdp/mycompany%20External%20CA.crl, URIName: ldap:///CN=mycompany%20External%20CA,CN=Cert01,CN=CDP,CN=Public%20Key%20Services,CN=Services,CN=Configuration,DC=glupka-and-tupka,DC=mcmp,DC=counrtrycode?certificateRevocationList?base?objectClass=cRLDistributionPoint, URIName: http://extpki.glupka-and-tupka.mcmp.counrtrycode/CertEnroll/mycompany%20External%20CA.crl]
]]

[6]: ObjectId: 2.5.29.37 Criticality=false
ExtendedKeyUsages [
  serverAuth
]

[7]: ObjectId: 2.5.29.15 Criticality=false
KeyUsage [
  DigitalSignature
  Key_Encipherment
]

[8]: ObjectId: 2.5.29.17 Criticality=false
SubjectAlternativeName [
  DNSName: services.mycompany.counrtrycode
  DNSName: autodiscover.mycompany.counrtrycode
  DNSName: post.mycompany.counrtrycode
]

[9]: ObjectId: 2.5.29.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: 22 4D BLABLA 68 FB FA   94 BLABLAEE 12  "M.L.h...9Y.....
BLABLA
]

]
  Algorithm: [SHA1withRSA]
  Signature:
0000: 1C B5 34 B8 79 83 40 8F   65 0F 22 63 46 EC F5 C4  ..4.y.@.e."cF...
0010: 71 01 19 B1 2D 08 D5 0A   0E 5C 01 C4 68 A8 E9 7D  q...-....\..h...
0020: EC 29 65 F5 DD 7C C5 75   4F 51 D2 07 3D 14 44 E5  .)e....uOQ..=.D.
0030: E5 4E 7C 39 F3 50 CA 69   FF 44 3E 01 0F A7 BF BF  .N.9.P.i.D>.....
BLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLABLA
...
BLABLABLABLABLABLABLABLA
01F0: CB EF A7 1C 85 77 91 AF   AF 5C C3 E9 40 20 24 6E  .....w...\..@ $n

]
chain [1] = [
[
  Version: V3
  Subject: CN=mycompany External CA, O=mycompany, C=counrtrycode
  Signature Algorithm: SHA1withRSA, OID = 1.2.840.113549.1.1.5

  Key:  Sun RSA public key, 4096 bits
  modulus: BLABLABLABLABLABLABLABLABLABLABLABLA98237839144558867BLABLA952659709867024101076930335BLABLA3611BLABLA3074298630BLABLA
  Validity: [From: Wed Sep 01 14:54:44 MSD 2010,
               To: Mon Sep 01 15:04:44 MSK 2014]
  Issuer: CN=mycompany Root CA, O=mycompany, C=counrtrycode
  SerialNumber: [    6BLABLAe5f 00000000 000a]

Certificate Extensions: 8
[1]: ObjectId: BLABLA.311.20.2 Criticality=false
Extension unknown: DER encoded OCTET string =
0000: 0BLABLAA 00 53 00 75   00 62 BLABLA3 00 41        .....S.u.b.C.A

[2]: ObjectId: BLABLA1.311.21.1 Criticality=false
Extension unknown: DER encoded OCTET string =
0000: 04BLABLA1 00                                     .....

[3]: ObjectId: BLABLA7.1.1 Criticality=false
AuthorityInfoAccess [
  [
   accessMethod: caIssuers
   accessLocation: URIName: http://pki.mycompany.counrtrycode/pki/aia/mycompany%20Root%20CA.crt
, 
   accessMethod: caIssuers
   accessLocation: URIName: ldap:///CN=mycompany%20Root%20CA,CN=AIA,CN=Public%20Key%20Services,CN=Services,CN=Configuration,DC=glupka-and-tupka,DC=mcmp,DC=counrtrycode?cACertificate?base?objectClass=certificationAuthority
, 
   accessMethod: caIssuers
   accessLocation: URIName: ldap:///CN=mycompany%20Root%20CA,CN=AIA,CN=Public%20Key%20Services,CN=Services,CN=Configuration,DC=ca,DC=mcmp,DC=counrtrycode?cACertificate?base?objectClass=certificationAuthority
, 
   accessMethod: caIssuers
   accessLocation: URIName: http://extpki.glupka-and-tupka.mcmp.counrtrycode/CertEnroll/rootca_mycompany%20Root%20CA.crt
, 
   accessMethod: caIssuers
   accessLocation: URIName: http://intpki.ca.mcmp.counrtrycode/CertEnroll/rootca_mycompany%20Root%20CA.crt
]
]

[4]: ObjectId: 2.5.29.35 Criticality=false
AuthorityKeyIdentifier [
KeyIdentifier [
0000: 4BLABLAF2 BB 22   B0 DB 4E ACBLABLA85 20  A..@<.."..N.... 
0010: BLABLA 02                                        .*..
]
]

[5]: ObjectId: BLABLA.19 Criticality=tcounrtrycodee
BasicConstraints:[
  CA:tcounrtrycodee
  PathLen:0
]

[6]: ObjectId: BLABLA.29.31 Criticality=false
CRLDistributionPoints [
  [DistributionPoint:
     [URIName: http://pki.mycompany.counrtrycode/pki/cdp/mycompany%20Root%20CA.crl, URIName: ldap:///CN=mycompany%20Root%20CA,CN=rootca,CN=CDP,CN=Public%20Key%20Services,CN=Services,CN=Configuration,DC=glupka-and-tupka,DC=mcmp,DC=counrtrycode?certificateRevocationList?base?objectClass=cRLDistributionPoint, URIName: ldap:///CN=mycompany%20Root%20CA,CN=rootca,CN=CDP,CN=Public%20Key%20Services,CN=Services,CN=Configuration,DC=ca,DC=mcmp,DC=counrtrycode?certificateRevocationList?base?objectClass=cRLDistributionPoint, URIName: http://extpki.glupka-and-tupka.mcmp.counrtrycode/CertEnroll/mycompany%20Root%20CA.crl, URIName: http://intpki.ca.mcmp.counrtrycode/CertEnroll/mycompany%20Root%20CA.crl]
]]

[7]: ObjectId: BLABLA29.15 Criticality=false
KeyUsage [
  DigitalSignature
  Key_CertSign
  Crl_Sign
]

[8]: ObjectId: BLABLA.14 Criticality=false
SubjectKeyIdentifier [
KeyIdentifier [
0000: DB F3 38 88 08 D3 25 A2   D6 3E BLABLAD 21 09  ..8...%..>Z.(m!.
BLABLA                                        ....
]
]

]
  Algorithm: [SHA1withRSA]
  Signature:
0000: 62 85 DBLABLAA0 A9   74 3ABLABLA 78 3BLABLA 3A 93  b...h0..t:.x6Q:.
BLABLABLABLABLABLA
01F0: 06 D8 BLABLA 34   28 32 01 6A 4BLABLA E7 EC  ......r4BLABLA

]
***
*** CertificateRequest
Cert Types: RSA, DSS, ECDSA
Cert Authorities:
<CN=CERTBServer, DC=glupka-and-tupka, DC=mcmp, DC=counrtrycode>
<CN=mycompany Root CA, O=mycompany, C=counrtrycode>
<OU=Class 3 Public Primary Certification Authority, O="VeriSign, Inc.", C=US>
<CN=GTE CyberTcounrtrycodest Global Root, OU="GTE CyberTcounrtrycodest Solutions, Inc.", O=GTE Corporation, C=US>
<CN=Symantec Root CA, O=Symantec Corporation>
<CN=Microsoft Root Authority, OU=Microsoft Corporation, OU=Copyright (c) 1997 Microsoft Corp.>
<CN=Symantec Root 2005 CA, O=Symantec Corporation, C=US>
<CN=Microsoft Root Certificate Authority, DC=microsoft, DC=com>
<CN=NT AUTHORITY>
*** ServerHelloDone
*** Certificate chain
***
*** ClientKeyExchange, RSA PreMasterSecret, TLSv1
main, WRITE: TLSv1 Handshake, length = 269
SESSION KEYGEN:
PreMaster Secret:
0000: 03 BLABLA 57 E5   32 68 13 0F BLABLAD C1 1B  ...BLABLA....
0010: 01 DE 2F FD C6 89 8B DF   24 55BLABLA8 DB 8A 2F  ../...BLABLA.(../
0020: A1 0BLABLA59 7A 5B   34 2BLABLA6 93 67 1D 43  .....BLABLA.g.C
CONNECTION KEYGEN:
Client Nonce:
0000: 51 39BLABLAA8 EF   E9 B3 39 BF BLABLA 85 1B  BLABLA9.....
0010: E0 69 53 BLABLA2 57 BD   4B EA C0 B5 60 5E F3 19  .iS.BLABLA..`^..
Server Nonce:
0000: 51 39 BLABLA ED 3F BF F7   5F 6DBLABLA C6 E5 7F  Q9z..BLABLA6.....
0010: 89 31 8D 8D 8A 14 9D 75   2B 7C 08 5E 66 AB 48 88  .1....BLABLA.H.
Master Secret:
0000: B5 3BLABLA02 45   BLABLA2A 21 49 B4  .8.BLABLA!I.
0010: DC E7BLABLA36 7E 4E 22   79 60 BLABLA75 CD 26  ....6.BLABLAu.&
0020: 2D 6BLABLAD2 1E 29   7EBLABLA7D 63 9E  -h..BLABLA...c.
Client MAC write Secret:
0000: 38 BLABLAB 0D 91 8D   67 8BLABLA40 81  8.BLABLA..b@.
0010: 0D C5 4D D6                                        ..M.
Server MAC write Secret:
0000: 42BLABLA 79 98   BD 57 50BLABLA D2 25 36  B..BLABLAPm..%6
0010: D4 8F E9 06                                        ....
Client write key:
0000: CBLABLAF 76 82   31 06 3FBLABLA41 6D  ....BLABLA..Am
Server write key:
0000: 1BLABLABLABLA F3   A1 3BLABLABLABLA 24  .BLABLA...<.BLABLA.$
Client write IV:
0000: BLABLA3 28 09   AD 68 AD 1BLABLA7 76 86  .(.BLABLA.h..ugv.
Server write IV:
0000: BLABLAC 8F E2 CC   EA 5A BLABLA1 BC BD BC  BLABLA.....
main, WRITE: TLSv1 Change Cipher Spec, length = 1
*** Finished
verify_data:  { BLA, 165, 142, 254, 222, BLA, 58, 72, BLA, 131, 19, 122 }
***
main, WRITE: TLSv1 Handshake, length = 48
main, READ: TLSv1 Change Cipher Spec, length = 1
main, READ: TLSv1 Handshake, length = 48
*** Finished
verify_data:  { 73, BLA, 110, BLA, 55, 62, BLA, 155, 179, BLA, 90, 19 }
***
%% Cached client session: [Session-1, TLS_RSA_WITH_AES_128_CBC_SHA]
>Handshake succesful!
Using cipher suite: TLS_RSA_WITH_AES_128_CBC_SHA 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T13:11:54.437

问题是由于 EWSJavaAPI 的实现和我自己使用客户端证书进行双向身份验证的必要性一起出现的。

首先我们应该正确地初始化上下文。EWSJavaAPI 使用不再支持的 apache commons HttpClient 3.1，移到另一个包 httpcomponents。但是我们使用传统，它看起来像工作。我们初始化 SslContext，然后创建 SSL 套接字工厂，并向这个工厂注册协议。

```
KeyStore ks = KeyStore.getInstance("PKCS12");            
ks.load(new FileInputStream("cert.pfx"),"pass".toCharArray());

System.out.println("init Stores...");

ctx = SSLContext.getInstance("TLS");
ctx.init(new KeyManager[] { new MyKeyManager(ks, "pass") }, trustAllCerts, new SecureRandom());                       
SSLContext.setDefault(ctx);

ProtocolSocketFactory psf = new SSLProtocolSocketFactory();   
Protocol https = new Protocol("https", psf, 443);
Protocol.registerProtocol("https", https); 
```

MyKeyManager 看起来像：

```
public class MyKeyManager extends X509ExtendedKeyManager {

    KeyStore keystore = null;
    String password = null;
    public MyKeyManager(KeyStore keystore, String password) {
        this.keystore = keystore;
        this.password = password;
    }

    @Override
    public String chooseClientAlias(String[] arg0, Principal[] arg1, Socket arg2) {
        return ""; // can't be null
    }

    @Override
    public String chooseServerAlias(String arg0, Principal[] arg1, Socket arg2) {
        return null;
    }

    @Override
    public X509Certificate[] getCertificateChain(String arg0) {
        try {
            X509Certificate[] result = new X509Certificate[keystore.getCertificateChain(keystore.aliases().nextElement()).length];
            for (int i = 0; i < result.length; i++){
                result[i] = (X509Certificate) keystore.getCertificateChain(keystore.aliases().nextElement())[i];
            }
            return result;
        } catch (Exception e) {
        }
        return null;
    }

    @Override
    public String[] getClientAliases(String arg0, Principal[] arg1) {
        try {
            return new String[] { keystore.aliases().nextElement() };
        } catch (Exception e) {
            return null;
        }
    }

    @Override
    public PrivateKey getPrivateKey(String arg0) {
        try {
            return ((KeyStore.PrivateKeyEntry) keystore.getEntry(keystore.aliases().nextElement(),
                new KeyStore.PasswordProtection(password.toCharArray()))).getPrivateKey();
        } catch (Exception e) {
        }
        return null;
    }

    @Override
    public String[] getServerAliases(String arg0, Principal[] arg1) {
        return null;
    }
} 
```

在 EmailMessage.send() 期间，我们将访问 microsoft.exchange.webservices.data.HttpClientWebRequest 。而且......惊喜：

```
@Override
public void prepareConnection() throws EWSHttpException {
    // ...
    Protocol.registerProtocol("https", 
            new Protocol("https", new EwsSSLProtocolSocketFactory(), 443));
    // ...
} 
```

我们重新注册套接字工厂，我们的证书将永远不会被填充。让我们看看什么是 EwsSSLProtocolSocketFactory：

```
public EwsSSLProtocolSocketFactory() {
    super();
}

private static SSLContext createEasySSLContext() {
    try {
        SSLContext context = SSLContext.getInstance("SSL");
        context.init(
            null, 
            new TrustManager[] {new EwsX509TrustManager(null, trustManager)}, 
            null);
        return context;
    } catch (Exception e) {
        System.out.println(e.getMessage()+e);
        throw new HttpClientError(e.toString());
    }
}

private SSLContext getSSLContext() {
    if (this.sslcontext == null) {
        this.sslcontext = createEasySSLContext();
    }
    return this.sslcontext;
} 
```

将使用超级容易创建的 SSLContext。它不允许使用自己的密钥，只能检查受信任的证书，并且只能从默认的 /usr/local/java/1.7.X/../cacerts 中检查。

幸运的是，提供了资源，我们第一次可以评论“Protocol.registerProtocol”，它解决了一个问题。

# php - 检测句子结构

> ID：15283689
> 
> 赞同：0
> 
> 时间：2013-03-07T23:12:36.123
> 
> 标签：php, artificial-intelligence, grammar

有没有办法把句子翻译成名词、代词、形容词、动词、副词、连词、介词和感叹词？

我正在寻找在 PHP 中执行此操作，我确实知道这个问题可能没有明确的答案，但我仍在寻找可以尽可能接近地完成此任务的最新库，最好是在 PHP 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:33:00.480

看看 Ian Barber 的[Brill Parser](http://phpir.com/part-of-speech-tagging/)的 PHP 实现。这是一个英语语言实现。我知道非英语语言有类似的算法（您没有指定语言），但我无法提供任何链接。

# php - 如何更好地排序？

> ID：15283693
> 
> 赞同：0
> 
> 时间：2013-03-07T23:13:10.487
> 
> 标签：php, arrays, sorting

我有 2 个数组，它们都是多维的，具有相同数量的元素和相同的值，它们位于不同的位置（这些值实际上是我数据库中的 ID，所以一个 ID 只出现一次）。如何使用第一个数组中的值对第二个数组进行排序？

例如 - 如果第一个数组看起来像：

```
$array1[0][0] = 1;
$array1[0][x] = it doesn't matter what's here
$array1[1][0] = 4;
$array1[1][x] = it doesn't matter what's here
$array1[2][0] = 3;
$array1[2][x] = it doesn't matter what's here
... 
```

如何对第二个数组进行排序，使其在索引 [0][0]、[1][0]、[2][0] 等上具有与 array1 相同的值。

我如何解决问题是：

```
$i=0
while ($i < (count($array1)-2)){ // * check down

  $find_id = $array1[$i][0];

  // here I need to search for index of that ID in other array
  $position = give_index($find_id, $array2);

  // swapping positions
  $temp = array2[$i][0];
  $array2[$i][0] = $array2[$position][0];
  $array2[$position][0] = $temp;

  // increasing counter
  i++;
}

function give_index($needle, $haystack){
  for ($j = 0, $l = count($haystack); $j < $l; ++$j) {
        if (in_array($needle, $haystack[$j][0])) return $j;
  }
  return false;
} 
```

*   *只有 -2 因为索引从 0 开始，并且对于您不需要检查的最后一个元素，因为它将由 while 循环的最后一次迭代自动排序。

我觉得这个解决方案不好，因为我认为这是一个非常简单的问题（也许它甚至不正确）。PHP 中是否有我缺少的更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T00:40:06.217

这是我能想到的最有效的方法：

```
function swap(&$a, &$b) { 
    $t = $a;
    $a = $b;
    $b = $t;
}

function find_index($id, $array, $from = 0) {
    $index = false;
    for ($i = $from, $c = count($array); $i < $c; $i++) {
        if ($array[$i][0] == $id) {
            $index = $i;
            break;
        }
    }
    return $index;
}

for ($i = 0, $c = count($array1); $i < ($c - 2); $i++) {
    if ($array1[$i][0] != $array2[$i][0]) {
        $fi = find_index($array1[$i][0], $array2, $i);
        swap($array2[$i][0], $array2[$fi][0]);
    }
} 
```

**你的有什么变化？**

*   我已经定义了一个`swap()`函数来交换任何变量。这不会花费任何东西，并使一切看起来更好。如果需要，您也可以稍后重用该功能。
*   在`find_index`（`give_index`在您的代码中）中，一旦找到正确的索引，我们就会停止循环。我们还避免了`in_array`函数调用的成本。
*   我们将`find_index`函数修改为仅从我们尚未检查的数组部分开始。导致一种更有效的方式来扫描阵列。
*   在 for 循环中（`while`那里的循环是错误的）我们`count`将数组的 存储一次，避免多次调用。
*   `$array2`此外，我们仅在它们位于错误位置时才交换这些值。

**其他改进**

如果您知道`$array2`阵列的任何其他内容，则可以使其性能更高。例如，如果您知道索引是交替的，`$array1`您可以更改主 for 循环：

```
for ($i = 0, $c = count($array1); $i < ($c - 2); $i++) { 
```

到

```
for ($i = 0, $c = count($array1); $i < ($c - 2); $i+2) { 
```

（注意`$i+2`最后）你也可以在`find_index`函数中做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T00:59:00.963

查看 usort ( [http://php.net/manual/en/function.usort.php](http://php.net/manual/en/function.usort.php) )。

它提供了一种使用用户提供的比较函数对数组进行排序的简单方法。

# android - 有没有办法自动完成架构 URI？

> ID：15283694
> 
> 赞同：0
> 
> 时间：2013-03-07T23:13:11.177
> 
> 标签：android, eclipse, autocomplete

今天我学习了如何使用`Ctrl`+`Space`来自动完成属性，有没有办法对模式 URI 做同样的事情`http://schemas.android.com/apk/res/android`？

目前，我只是从这样的示例中复制和粘贴它们......

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".AnimatedActivity" >
</RelativeLayout> 
```

# list - 文件夹混乱

> ID：15283696
> 
> 赞同：0
> 
> 时间：2013-03-07T23:13:11.850
> 
> 标签：list, haskell, lambda

我在解释器上执行这个语句

```
foldr (\x (a, b) -> if x == '_' then (a+1, [((div a 3), (mod a 3))] ++ b) else (a, b)) (0, []) "_______OX" 
```

我希望输出是

```
(7,[(0,0),(0,1),(0,2),(1,0),(1,1),(1,2),(2.0)]) 
```

但是输出是

```
(7,[(2,0),(1,2),(1,1),(1,0),(0,2),(0,1),(0,0)]) 
```

我究竟做错了什么。据我所知， foldr 从列表的最后一个元素开始，我的 lambda 函数将其附加到累加器列表的开头。所以我应该得到 (0,0) 作为第一个元素。然而，事实恰恰相反，我很困惑。:(

另外，一个小问题 - 我如何为这些问题分配标签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:33:27.920

在'X'之后你有

```
 (0,[]) 
```

在'0'之后你有

```
 (0,[]) 
```

在第一个'_'之后你有

```
 (1,[(0,0)]) 
```

在第二个'_'之后你有

```
 (2,[(0,1),(0,0)]) -- you prepend in: [((div a 3), (mod a 3))] ++ b 
```

在第三个'_'之后你有

```
 (3,[(O,2),(0,1),(0,0)]) 
```

...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:37:30.943

让我们稍微简化一下，以便更好地解释：

```
foldr (\c (a,b) -> (a+1, a:b)) (0, []) "hi" 
```

文件夹定义为

```
foldr f a [] = a
foldr f a (x:xs) = f x (foldr f a xs) 
```

让我们调用 lambda 函数`g` 因此，上面的表达式的踪迹：

```
g 'h' (foldr g (0,[]) "i") 
g 'h' (g 'i' (foldr g (0,[]) ""))
g 'h' (g 'i' (0, []))
g 'h' (1, [0])
(2, [1,0]) 
```

# canvas - 图像未加载到画布上

> ID：15283698
> 
> 赞同：4
> 
> 时间：2013-03-07T23:13:23.770
> 
> 标签：canvas, html5-canvas

我的问题是我在将本地托管的图像加载到画布上时遇到问题。我曾尝试在 Web 服务器上使用 XAMPP 和本地托管代码，但 LightBlue.jpg 图像似乎永远不会加载。但是，当我使用来自网站的外部图像时，代码可以完美运行。我在下面提供了一个示例。

HTML：

```
<canvas id="Section1Canvas" width="500" height="95" style="border:1px solid #d3d3d3;">Your browser does not support the HTML5 canvas tag.</canvas> 
```

JAVASCRIPT：

```
<script>
    var canvas = document.getElementById('Section1Canvas'),
    context = canvas.getContext('2d');
    make_base();
    function make_base()
    {
        base_image = new Image();
        base_image.onload = function()
        {
            context.drawImage(base_image, 10, 10);
        }
        base_image.src = 'images\Selection\Bag\Section1\LightBlue.jpg';
    }
</script> 
```

该脚本出现在我的代码中结束 HTML 标记的正上方。我已经托管了我的网络服务器的所有信息，并且图像仍然拒绝加载。如果我要使用外部图像将代码更改为以下内容，则画布会完美地加载图像：

```
<script>
    var canvas = document.getElementById('Section1Canvas'),
    context = canvas.getContext('2d');
    make_base();
    function make_base()
    {
        base_image = new Image();
        base_image.onload = function()
        {
            context.drawImage(base_image, 10, 10);
        }
        base_image.src = 'http://www.html5canvastutorials.com/demos/assets/darth-vader.jpg';
    }
</script> 
```

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T23:17:45.487

**你离得太近了！**

您需要在函数`base_image.src` **之后**`base_image.onload`放置：

```
<script>
    var canvas  = document.getElementById('Section1Canvas'),
        context = canvas.getContext('2d');
    make_base();

    function make_base()
    {
        base_image = new Image();
        base_image.onload = function()
        {
           // test that the image was loaded
           alert(base_image);  // or console.log if you prefer
           context.drawImage(base_image, 10, 10);
        }
        base_image.src = 'images\Selection\Bag\Section1\LightBlue.jpg';
    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-17T20:58:22.263

function() 中缺少一个 }。你打开它但忘记关闭它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-13T12:44:39.420

对我来说，把 src 放在后面，会让事情变得更糟......这就是事情 - 在我的情况下，这是每 25 毫秒更新一次。首先是两根针（未显示），然后是针上的这个小圆盖。

针每次都绝对有效 - 顶部会在它认为合适时出现。

```
 ctx.save();
  ctx.beginPath();
  ctx.translate(cX, cY);
  if (centre.complete) ctx.drawImage(centre, kn1, kn2, kn3, kn4); 
  else centre.onload = function () { ctx.drawImage(centre, kn1, kn2, kn3, kn4); } 
  ctx.restore(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-16T07:17:45.657

在调用 drawImage 函数时还要指定图像的宽度和高度。

```
context.drawImage(img, x, y, width, height); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-06-14T21:57:32.180

阻止 XAMPP 处理画布脚本的一个功能是`mod_rewrite`. 这显然是一个简单的修复。就是这样。。

> 1：
> 使用您喜欢的文本编辑器打开 apache 的配置文件。配置文件一般位于：{apache_dir}/conf/httpd.conf 如果您使用的是 XAMPP 或 WAMP 包，那么您将在：{xampp_dir}/apache/conf/httpd.conf {wamp_dir}/apache/conf 中找到该文件/httpd.conf
> 2：
> 搜索以下字符串：#LoadModule rewrite_module modules/mod_rewrite.so 并取消注释（删除“#”号）。
> 3：
> 现在搜索另一个字符串 AllowOverride None 并将其替换为 AllowOverride All
> 4：
> 最后保存更改，关闭文本编辑器并重新启动 apache 服务器。

那应该将您的 localhost 设置为正确的参数。

# c++ - 链接器错误 - 链接两个“应用程序”类型的项目以使用 Google 测试

> ID：15283699
> 
> 赞同：7
> 
> 时间：2013-03-07T23:13:27.423
> 
> 标签：c++, linker-errors, googletest

我正在尝试使用 Google Test 测试功能。

似乎一切都设置正确，并且在没有 gtest 的情况下构建和执行都很好......（代码有点复杂，所以我无法在此处列出所有源文件，但不添加 gtest，文件正在链接正确，并按应有的方式运行）。

这是一个应用程序类型的项目。它有许多库依赖项......无关紧要。

测试项目作为单独的项目添加到解决方案中。它具有经过测试的项目作为依赖项。测试项目的.h文件只指向gtest....cpp（不是main，是标准的InitGoogleTest main）添加了自己的头文件，测试项目的头文件，有如下图所示的测试.

项目构建时会自动创建一个 TestedProject.lib，即使它是一个应用程序。我已将 TestedProject.lib 作为库依赖项添加到 TestProject（在链接中）。

```
Class x
{
public:
  x(){}    // I didn't really need this, I only added the class so I have access to 
  ~x(){};  // non-class methods with gtest - but it still doesn't work
  bool myFunction(std::string a, double b, bool c);  
}; 
```

执行：

```
bool x::myFunction(std::string a, double b, bool c)
{
  // implementation
  return false;
}

somewhere_else
{
  x x_instance;
  y = x_instance.myFunction("a", 1, false);   // works, all builds, executes, life is great
} 
```

添加单元测试：

```
class TheTest : public ::testing::Test
{
protected:
    x x_instance;
};

TEST_F(TheTest, Fail)
{
    EXPECT_FALSE(x_instance.myFunction("a", 1, false));     
} 
```

不建。链接错误（已修改，和上面的示例代码一样，用了简化的名字，希望没有把内容弄乱）

```
Error   2   error LNK2019: unresolved external symbol 
"public: bool __thiscall x::myFunction(class std::basic_string<char,struct std::char_traits<char>,double,bool)" 
(?myFunction@x@@QAE_NV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@00000NNNN_N1@Z) 
referenced in function "private: virtual void __thiscall TheTest_Fail_Test::TestBody(void)" 
(?TestBody@TheTest_Fail_Test@@EAEXXZ)   C:\path\file.obj 
```

我以前做过这个——解决了链接错误——用谷歌测试写了几个测试——但我看不到任何遗漏。

作为测试，我写了一点

int test(){return 4;} 在头文件中，在类声明中...

然后，将测试替换为 EXPECT_EQ(x.test(), 4);

有效。伟大的。但这意味着将所有经过测试的代码都放在一个文件、一个 cpp 或其他东西中……这简直是不合理的。此应用程序项目中有几个文件。

我该如何解决这个问题？如何使用带有标头和实现文件的类进行 Google 测试链接和测试？当该标头/实现位于“应用程序”类型的不同项目中时？

到目前为止，我发现的唯一类似问题是：[C++ linking issue on Visual Studio 2008 when crosslinking different projects on same solution](https://stackoverflow.com/questions/2507595/c-linking-issue-on-visual-studio-2008-when-crosslinking-different-projects-on)

请帮我找到解决办法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-31T14:50:54.923

还有另一种解决方案，我更喜欢它，因为这意味着您可以避免更改主项目：

向主项目添加“构建后操作”，以便为完全相同的源文件创建静态库。然后你可以简单地将这个依赖添加到你的 gtest 项目中。

每次编译主项目时，它都会构建应用程序和静态库。

这样您就不必创建第三个项目并保持配置同步。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-28T16:19:36.033

所以我会有一个答案：

我的问题有 2 个解决方案：

1）将应用项目拆分为2个项目，一个会成为一个库，大部分代码；另一个将是一个应用程序，包含一个调用真实代码入口点的微小 main() （如参数解析方法或其他东西）。

然后，我可以添加一个单元测试项目 - 来测试 lib。

2) 不要拆分项目。添加一个 gtest 项目，不要创建任何依赖项。将要测试的文件添加到 gtest 项目中。gtest 项目将是一个单独的可执行文件......所有它都需要快乐。（优点：没有测试依赖）

我更喜欢第一个版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-17T03:24:36.240

对此还有另一种解决方案。

只需为 Google 测试框架创建一个新项目。（当然，在你现有的应用解决方案下）。

然后，在您确保所有 Google 测试框架设置正确之后。（您可以在新创建的解决方案下测试它）

从您的主项目中手动包含您想要测试的代码（使用 Add -> Existing Item），然后您可以在不生成额外库的情况下测试您的代码。

这样做的好处是，当您测试一些需要 Windows DLL 的应用程序时，它要求应用程序使用多线程调试 DLL。（在您的项目属性设置中，转到 C/C++ -> 代码生成 -> 运行时库，看看你得到了什么）

并且 Google 测试框架使用了一个非常不同的运行时库（多线程调试 (/MTd)）。

在链接阶段，编译器会说将应用程序生成的 lib 与多线程 DLL 和谷歌框架的 lib（多线程）链接起来有些困难。

这样就可以避免两个项目的依赖问题。（一个用于 /Mtd，一个用于 /Md）

# c++ - Linux ncurses 覆盖由 box() 创建的边框

> ID：15283707
> 
> 赞同：1
> 
> 时间：2013-03-07T23:13:45.867
> 
> 标签：c++, linux, border, ncurses

当我执行此代码时，我创建的边框的左侧将在右上角的框中被覆盖。即使代码看起来相同，问题似乎也仅限于该区域。如何防止它覆盖我的边框？我正在使用 g++ -lncurses 编译并在 Ubuntu 终端中运行

```
#include <ncurses.h>
#include <string.h> 
#define WINDOWY 24
#define WINDOWX 80
#define ROW1 3
#define RROW1 1
#define COL1 2
#define COL2 23
#define COL3 33 
#define COL4 38
#define MEMORYROW 9
#define MEMORYCOL 1
#define COMMANDROW 1
#define COMMANDCOL 41

int closeUp(void);
void printMockup(void);
void drawBorders(void);
WINDOW *create_newwin(int height, int width, int starty, int startx);

int main()
{
    char input = ' ';
    int row,col;    

    //initialize ncurses stuff
    initscr();      
    cbreak();
    curs_set(0);

    //check window is right size
    getmaxyx(stdscr,row,col);
    if (row < WINDOWY || col < WINDOWX)
    {
        printw("You need to increase the terminal size to at least 24 x 70");
        return closeUp();
    }

    //draw border
    drawBorders();

    //draw UI
    printMockup();

    getch();
    endwin();

    return 0;
}

int closeUp(void)
{
    getch();
    endwin();
    return 0;
}

void printMockup(void)
{
    mvprintw(1, 2, "6808 Emulator");
    mvprintw(ROW1, COL1, "Accumulator:");
    mvprintw(ROW1, COL2, "0x00");
    mvprintw(ROW1+1, COL1, "Program Counter:");
    mvprintw(ROW1+1, COL2, "0x0000");
    mvprintw(ROW1+2, COL1, "Stack Pointer:");
    mvprintw(ROW1+2, COL2, "0x0000");
    mvprintw(ROW1+3, COL1, "Index Register Low:");
    mvprintw(ROW1+3, COL2, "0x00");
    mvprintw(ROW1+4, COL1, "Index Register High:");
    mvprintw(ROW1+4, COL2, "0x00");

    mvprintw(RROW1, COL3, "PC:");
    mvprintw(RROW1, COL4, "0");
    mvprintw(RROW1+1, COL3, "C:");
    mvprintw(RROW1+1, COL4, "0");
    mvprintw(RROW1+2, COL3, "Z:");
    mvprintw(RROW1+2, COL4, "0");
    mvprintw(RROW1+3, COL3, "N:");
    mvprintw(RROW1+3, COL4, "0");
    mvprintw(RROW1+4, COL3, "I:");
    mvprintw(RROW1+4, COL4, "0");
    mvprintw(RROW1+5, COL3, "H:");
    mvprintw(RROW1+5, COL4, "0");
    mvprintw(RROW1+6, COL3, "V:");
    mvprintw(RROW1+6, COL4, "0");

    mvprintw(COMMANDROW+1, COMMANDCOL+11, "r - Run");
    mvprintw(COMMANDROW+2, COMMANDCOL+11, "s - Step");
    mvprintw(COMMANDROW+3, COMMANDCOL+11, "a - Auto-step");
    mvprintw(COMMANDROW+4, COMMANDCOL+11, "x - Reset");
    mvprintw(COMMANDROW+5, COMMANDCOL+11, "m - Main menu");

    mvprintw(MEMORYROW+1, MEMORYCOL+1, "PC:");
    mvprintw(MEMORYROW+1, MEMORYCOL+1, "0");

}

WINDOW *create_newwin(int height, int width, int starty, int startx)
{   
    WINDOW *local_win;

    local_win = newwin(height, width, starty, startx);
    //wborder(local_win, '|', '|', '-', '-', '+', '+', '+', '+');
    box(local_win, 0 , 0);
    wrefresh(local_win);

    return local_win;
}

void drawBorders(void)
{
    refresh();
    create_newwin(WINDOWY, WINDOWX, 0, 0);
    create_newwin(WINDOWY-(WINDOWY-MEMORYROW-1)-2, WINDOWX-COMMANDCOL-1, COMMANDROW, COMMANDCOL);
    create_newwin(WINDOWY-MEMORYROW-1, WINDOWX-MEMORYCOL-1, MEMORYROW, MEMORYCOL);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T01:04:11.450

您通常会打印到一个窗口中，然后刷新它。对于这个特殊问题，我们可以通过只关注您的“命令窗口”来解决它。给定代码的结构，创建一个全局变量来保存命令窗口指针。

```
WINDOW *command_window; 
```

然后，从您的`drawBorders()`函数初始化它。

```
command_window = create_newwin(WINDOWY-(WINDOWY-MEMORYROW-1)-2,
                               WINDOWX-COMMANDCOL-1,
                               COMMANDROW, COMMANDCOL); 
```

修改将命令打印到主窗口的代码以将其打印到主窗口中`command_window`。然后，刷新`command_window`.

```
mvwprintw(command_window, 1, 11, "r - Run");
mvwprintw(command_window, 2, 11, "s - Step");
mvwprintw(command_window, 3, 11, "a - Auto-step");
mvwprintw(command_window, 4, 11, "x - Reset");
mvwprintw(command_window, 5, 11, "m - Main menu");
wrefresh(command_window); 
```

# php - 将网站移至新服务器后，无法上传图片

> ID：15283708
> 
> 赞同：0
> 
> 时间：2013-03-07T23:13:49.400
> 
> 标签：php, http, iis, upload, permissions

我正在尝试使用下面的脚本上传图像。

我们的旧服务器完全没有问题。一旦我将站点迁移到 windows 2012、iis 8、php 5.2（相同版本），我们就无法使其正常工作。

不幸的是，我们花了几个小时试图启用 php 日志记录但没有成功。

我怀疑问题出在权限上。

**问题** 要使用下面的脚本，需要什么权限？我立即为一个可怕的问题道歉，但我对 php 的了解很少，我需要开始尝试解决这个问题的指导。

```
<?php

include '../Check.php';

function cropImage($nw, $nh, $source, $stype, $dest) {

    $size = getimagesize($source);
    $w = $size[0];
    $h = $size[1];

    switch($stype) {
        case 'gif':
        $simg = imagecreatefromgif($source);
        break;
        case 'jpg':
        $simg = imagecreatefromjpeg($source);
        break;
        case 'png':
        $simg = imagecreatefrompng($source);
        break;
    }

    $dimg = imagecreatetruecolor($nw, $nh);

    $wm = $w/$nw;
    $hm = $h/$nh;

    $h_height = $nh/2;
    $w_height = $nw/2;

    if($w> $h) {

        $adjusted_width = $w / $hm;
        $half_width = $adjusted_width / 2;
        $int_width = $half_width - $w_height;

        imagecopyresampled($dimg,$simg,-$int_width,0,0,0,$adjusted_width,$nh,$w,$h);

    } elseif(($w <$h) || ($w == $h)) {

        $adjusted_height = $h / $wm;
        $half_height = $adjusted_height / 2;
        $int_height = $half_height - $h_height;

        imagecopyresampled($dimg,$simg,0,-$int_height,0,0,$nw,$adjusted_height,$w,$h);

    } else {
        imagecopyresampled($dimg,$simg,0,0,0,0,$nw,$nh,$w,$h);
    }

    imagejpeg($dimg,$dest,100);
} 

// JQuery File Upload Plugin v1.4.1 by RonnieSan - (C)2009 Ronnie Garcia
if (!empty($_FILES)) {
//  $filename = $_FILES['Filedata']['tmp_name'];
//  $targetPath = $_SERVER['DOCUMENT_ROOT'] . $_GET['path'] . '/';
//  $filename2 =  str_replace('//','/',$targetPath) . $_FILES['Filedata']['name'];
//  
//  // Uncomment the following line if you want to make the directory if it doesn't exist
//  // mkdir(str_replace('//','/',$targetPath), 0755, true);
//  
//  move_uploaded_file($filename,$filename2);

              $imagename = $_FILES['Filedata']['name'];
              $source = $_FILES['Filedata']['tmp_name'];
              $target = "../Account/uploadimages/".$imagename;
              move_uploaded_file($source, $target);

              $imagepath = $imagename;

              //Save Original

              $save = "../Account/uploadimages/" . $USR_ID . ".jpg" ; //This is the new file you saving
              $file = "../Account/uploadimages/" . $imagepath; //This is the original file

              list($width, $height) = getimagesize($file) ; 

              $modwidth = 500; 
              $modheight = 500; 

              $diff = $width / $modwidth;

              $modheight = $height / $diff; 
              $tn = imagecreatetruecolor($modwidth, $modheight) ; 
              $image = imagecreatefromjpeg($file) ; 
              imagecopyresampled($tn, $image, 0, 0, 0, 0, $modwidth, $modheight, $width, $height) ; 

              imagejpeg($tn, $save, 100) ; 

                //Save Small Version    

              $save = "../Account/profile_small/" . $USR_ID . ".jpg" ; //This is the new file you saving
              $file = "../Account/uploadimages/" . $USR_ID . ".jpg" ; //This is the original file

              list($width, $height) = getimagesize($file) ; 

              $modwidth = 225; 

              $diff = $width / $modwidth;

              $modheight = $height / $diff; 
              $tn = imagecreatetruecolor($modwidth, $modheight) ; 
              $image = imagecreatefromjpeg($file) ; 
              imagecopyresampled($tn, $image, 0, 0, 0, 0, $modwidth, $modheight, $width, $height) ; 

              imagejpeg($tn, $save, 100) ; 

                //Save Square Version   

              $save = "../Account/profile_square/" . $USR_ID . ".jpg"; //This is the new file you saving
              $file = "../Account/uploadimages/" . $USR_ID . ".jpg" ; //This is the original file

                cropImage(60, 60, $file, 'jpg', $save);

            include '../khhCustomConnect.php';
 //Set their USR_HasImage to 1 on their associate profile so that it checks before trying to display profile photo.
            $update_hasimage = mssql_query("UPDATE Associate SET USR_HasImage = '1' WHERE USR_ID = '$USR_ID'") or die ("Error - No option deleted"); 

//Send email to helpdesk
    //Get User that submitted email address for from address
    $emaillookup = mssql_query("Select * FROM Associate Where USR_ID = '$USR_ID'");
    $USR_Email = mssql_result($emaillookup,0,'USR_Email');
    $USR_First = mssql_result($emaillookup,0,'USR_First');
    $USR_Last = mssql_result($emaillookup,0,'USR_Last');

//Start Menu Permission Detail - Change Variable and Title.

// Email will go to their Email. 
$to  = 'helpdesk@khhsl.com'; // note the comma

// subject
$subject = $USR_First . ' ' . $USR_Last . ' - New Picture Uploaded';

// message
$message = '
' . $USR_First . ' ' . $USR_Last . ' has changed their photo on khhConnect. Please upload to AD. Here is link to image: http://xx/xx/Account/profile_small/' . $USR_ID . '.jpg 

<br /><a href="http://xx/xx/Account/profile_small/' . $USR_ID . '.jpg">http://xx/xx/Account/profile_small/' . $USR_ID . '.jpg</a><br><br>

<img src="http://xx/xx/Account/profile_small/' . $USR_ID . '.jpg"><img />

';

// To send HTML mail, the Content-type header must be set
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

// Additional headers
$headers .= 'From: ' . $USR_First . ' ' . $USR_Last . ' <' . $USR_Email . '>' . "\r\n";

// Mail it
mail($to, $subject, $message, $headers) or exit("could not send");

}

echo '1'; // Important so upload will work on OSX
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:15:12.680

您可能想要检查是否在临时文件夹中找到上传的文件，可能想要添加 IUSR_MACHINENAME 或 IUSR_MYMACHINENAME 帐户写入权限，并在文件未上传时指定您尝试写入的文件夹。

# git - Git：显示给定工作日的所有提交

> ID：15283713
> 
> 赞同：9
> 
> 时间：2013-03-07T23:14:15.900
> 
> 标签：git, git-log

我可以查看所有在周日进行的提交吗？任何和所有的星期天，要清楚。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T18:35:45.277

根据 jingx 的回答，以下内容将为您提供周日所有提交的日志。

```
git log --pretty='format:%h %cd' | grep 'Sun' |  awk '{print $1}' | while read rev; do
    git show $rev | head -6
done 
```

**解释**

`git log --pretty='format:%h %cd'`给出所有提交的简短日志及其 SHA 和提交日期。这些日期也包含星期几。

`grep 'Sun'`过滤掉该日志中带有“Sun”的所有行，即在星期日进行的所有提交。

`awk '{print $1}'`提取每行的第一个单词，即每次提交的 SHA 值。

`while read rev`循环遍历从前一个提取的每个 SHA 值`awk`。在每次迭代中，SHA 值将存储在`rev`变量中。

`git show $rev`使用 SHA 显示提交日志`$rev`。

`head -6`提取该日志的前 6 行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-08T03:17:19.523

就像是

```
git log --pretty='format:%h %cd' |grep Sun 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-21T23:04:27.337

**jingx**的回答是正确的，点赞！

我只想提一下，在某些时候我也想检索相同的特异性，就像任何和所有提交一样：

*   整`-9 GMT`点
*   在`33rd`第二个
*   上`Fri 13th`
*   在`1337`文件上
*   `777` *有影响*（`insertions`- `deletions`）_

...并发现`git log`界面有点缺乏。但是数据在那里！

因此，我创建了[https://github.com/dreamyguy/gitlogg](https://github.com/dreamyguy/gitlogg)，它将任意数量的存储库的提交解析为一个方便清理的`JSON`文件。享受！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T23:25:01.750

您可以尝试使用：

```
--since and --until 
```

命令键`git log`。

# c++ - Boost C++ 代码未构建，有人可以帮助我进行库链接吗？

> ID：15283715
> 
> 赞同：1
> 
> 时间：2013-03-07T23:14:17.083
> 
> 标签：c++, eclipse, boost, libraries

我已经按照[这里](http://scrupulousabstractions.tumblr.com/post/37052323632/boost-mingw-eclipse)的教程来设置我的 Eclipse 安装和 Boost 以及教程底部的示例来测试编译工作。我正在尝试`asio`用于套接字，但在编译时收到以下内容：

```
**** Build of configuration Debug for project Client ****

**** Internal Builder is used for build               ****
g++ -IC:\MinGW\Boost\include\boost-1_53 -O0 -g3 -Wall -c -fmessage-length=0 -o src\Client.o ..\src\Client.cpp
g++ -LC:\MinGW\Boost\lib -o Client.exe src\Client.o
src\Client.o: In function `__static_initialization_and_destruction_0':
C:/MinGW/Boost/include/boost-1_53/boost/system/error_code.hpp:214: undefined reference to `boost::system::generic_category()'
C:/MinGW/Boost/include/boost-1_53/boost/system/error_code.hpp:215: undefined reference to `boost::system::generic_category()'
C:/MinGW/Boost/include/boost-1_53/boost/system/error_code.hpp:216: undefined reference to `boost::system::system_category()'
src\Client.o: In function `boost::system::error_code::error_code()':
C:/MinGW/Boost/include/boost-1_53/boost/system/error_code.hpp:315: undefined reference to `boost::system::system_category()'
src\Client.o: In function `boost::asio::error::get_system_category()':
C:/MinGW/Boost/include/boost-1_53/boost/asio/error.hpp:216: undefined reference to `boost::system::system_category()'
src\Client.o: In function `boost::asio::detail::winsock_init_base::startup(boost::asio::detail::winsock_init_base::data&, unsigned char, unsigned char)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/winsock_init.ipp:39: undefined reference to `__imp_WSAStartup'
src\Client.o: In function `boost::asio::detail::winsock_init_base::cleanup(boost::asio::detail::winsock_init_base::data&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/winsock_init.ipp:48: undefined reference to `__imp_WSACleanup'
src\Client.o: In function `boost::asio::detail::socket_ops::clear_last_error()':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:51: undefined reference to `__imp_WSASetLastError'
src\Client.o: In function `boost::asio::detail::socket_ops::close(unsigned long long, unsigned char&, bool, boost::system::error_code&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:297: undefined reference to `__imp_closesocket'
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:314: undefined reference to `__imp_ioctlsocket'
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:329: undefined reference to `__imp_closesocket'
src\Client.o: In function `boost::asio::detail::socket_ops::recv(unsigned long long, _WSABUF*, unsigned long long, int, boost::system::error_code&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:683: undefined reference to `__imp_WSARecv'
src\Client.o: In function `boost::asio::detail::socket_ops::send(unsigned long long, _WSABUF const*, unsigned long long, int, boost::system::error_code&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:1066: undefined reference to `__imp_WSASend'
src\Client.o: In function `boost::asio::detail::socket_ops::socket(int, int, int, boost::system::error_code&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:1294: undefined reference to `__imp_WSASocketA'
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:1305: undefined reference to `__imp_setsockopt'
src\Client.o: In function `boost::asio::detail::socket_ops::poll_read(unsigned long long, unsigned char, boost::system::error_code&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:1716: undefined reference to `__imp_select'
src\Client.o: In function `boost::asio::detail::socket_ops::poll_connect(unsigned long long, boost::system::error_code&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:1797: undefined reference to `__imp_select'
src\Client.o: In function `boost::asio::detail::socket_ops::translate_addrinfo_error(int)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:2869: undefined reference to `__imp_WSAGetLastError'
src\Client.o: In function `boost::asio::detail::socket_ops::getaddrinfo(char const*, char const*, addrinfo const&, addrinfo**, boost::system::error_code&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:2887: undefined reference to `__imp_getaddrinfo'
src\Client.o: In function `boost::asio::detail::socket_ops::freeaddrinfo(addrinfo*)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:2930: undefined reference to `__imp_freeaddrinfo'
src\Client.o: In function `unsigned long long boost::asio::detail::socket_ops::error_wrapper<unsigned long long>(unsigned long long, boost::system::error_code&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:62: undefined reference to `__imp_WSAGetLastError'
src\Client.o: In function `int boost::asio::detail::socket_ops::error_wrapper<int>(int, boost::system::error_code&)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:62: undefined reference to `__imp_WSAGetLastError'
src\Client.o: In function `int boost::asio::detail::socket_ops::call_connect<int>(int boost::asio::detail::socket_ops::msghdr::*, unsigned long long, sockaddr const*, unsigned long long)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:452: undefined reference to `__imp_connect'
src\Client.o: In function `int boost::asio::detail::socket_ops::call_setsockopt<int>(int boost::asio::detail::socket_ops::msghdr::*, unsigned long long, int, int, void const*, unsigned long long)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:1340: undefined reference to `__imp_setsockopt'
src\Client.o: In function `int boost::asio::detail::socket_ops::call_getsockopt<int>(int boost::asio::detail::socket_ops::msghdr::*, unsigned long long, int, int, void*, unsigned long long*)':
C:/MinGW/Boost/include/boost-1_53/boost/asio/detail/impl/socket_ops.ipp:1426: undefined reference to `__imp_getsockopt'
collect2.exe: error: ld returned 1 exit status
Build error occurred, build is stopped
Time consumed: 4033  ms. 
```

我假设在链接库时我在某个地方出错了。有人可以解释一下该教程的作者是什么意思吗

```
Under libraries, add the specific boost libraries you need. 
For example I have added:

boost_thread-mgw47-mt-d-1_52
boost_system-mgw47-mt-d-1_52 
```

并解释（详细）如何在 Eclipse 中解决这个问题（对于调试和发布）？谢谢。

哦，如果您想要代码，只需在[此处](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/tutorial/tutdaytime1/src.html)找到代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T00:34:23.933

由于缺少库（可能是您列出的库），您得到的错误确实是链接错误。

快速搜索导致这两个 SO 条目：

*   [如何将库添加到eclipse c项目](https://stackoverflow.com/questions/8370809/how-to-add-a-library-to-eclipse-c-project)

*   [C++：CDT 中的外部库](https://stackoverflow.com/questions/8834883/c-external-library-in-eclipse-cdt)

请注意，在某些版本的 eclipse/CDT 中，符号和路径配置窗口中有一个 Library 选项卡，但它似乎并不存在于所有版本中，因此您必须使用链接器配置面板，如上面链接的答案中所述.

如果您从问题中链接的同一站点（关于设置 eclipse 和 cdt 的站点）浏览了上一个教程，并设法编译了示例程序，那么 2 个 boost 库是唯一缺失的。否则，您可能需要添加一些其他符号（错误消息中缺少的一些符号与 winsock 系统库有关）。

# php - 使用 url “mod_rewrite”中的名称进行 php 分析

> ID：15283716
> 
> 赞同：-1
> 
> 时间：2013-03-07T23:14:19.223
> 
> 标签：php, mod-rewrite, profile

我正在为一家公司创建一个网站，`php`我需要为每个成员创建他的个人资料页面，例如 facebook 的 url

```
www.mywebsite.com/my.name 
```

不是这样的：

```
www.mywebsite.com/?profile_id=65497 
```

有任何想法吗 ？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T13:07:08.327

我假设您知道只有当您有一些将 id 映射到名称的源时才能做到这一点。`mod_rewrite`可以在查找表中查找字符串并在替换中使用结果。

例如，假设您有一个包含名称到 id 映射的文件。

```
# Mapping of names to UserIDs
Bill.Gates    100
Barack.Obamaq 101
Arsan.Gamal   102 
```

然后，您可以将以下内容添加到您的 apache 配置中：

```
RewriteEngine On
RewriteMap UserIDs   txt:/path/to/userids.txt
RewriteRule /(.*)   /?profile_id=${UserIDs:$1|NOTFOUND}   [PT] 
```

现在，当请求 /Bill.Gates 时， / 之后的部分被正则表达式反向引用捕获，并用于在 userids.txt 中查找值。这个值不是在你的替换中使用的。

还有其他可能性。如果您的用户名和 ID 存在于数据库中，您可以在 RewriteMap 中使用数据库查询。有关您可以使用 RewriteMaps 做什么以及如何操作的更多信息，请参见此处的手册： [http ://httpd.apache.org/docs/2.4/rewrite/rewritemap.html](http://httpd.apache.org/docs/2.4/rewrite/rewritemap.html)

# ios - 在没有笔尖的子视图中加载图像

> ID：15283717
> 
> 赞同：0
> 
> 时间：2013-03-07T23:14:21.270
> 
> 标签：ios, image

我正在添加一个新的子视图

```
 self.editView = [[EditView alloc] initWithFrame:CGRectMake(0,0,320,296) WithImageView:self.mainImageView.image];
            self.mainImageView.hidden=YES;
            [self.view addSubview:self.editView]; 
```

新观点是：

```
- (id)initWithFrame:(CGRect)frame WithImageView: (UIImage *) image
{
self = [super initWithFrame:frame];
if (self) {
    self.panRecognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePan:)];
    self.rotationRecognizer = [[UIRotationGestureRecognizer alloc] initWithTarget:self action:@selector(handleRotation:)];
    self.pinchRecognizer = [[UIPinchGestureRecognizer alloc] initWithTarget:self action:@selector(handlePinch:)];
    self.tapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleTap:)];

    self.panRecognizer.cancelsTouchesInView = NO;
    self.panRecognizer.delegate = self;
    [self.frameView addGestureRecognizer:self.panRecognizer];
    self.rotationRecognizer.cancelsTouchesInView = NO;
    self.rotationRecognizer.delegate = self;
    [self.frameView addGestureRecognizer:self.rotationRecognizer];
    self.pinchRecognizer.cancelsTouchesInView = NO;
    self.pinchRecognizer.delegate = self;
    [self.frameView addGestureRecognizer:self.pinchRecognizer];
    self.tapRecognizer.numberOfTapsRequired = 2;
    [self.frameView addGestureRecognizer:self.tapRecognizer];

    [self updateCropRect];

    [self reset:NO];

    self.retainedImage = image;

    self.sourceImage = image;
    self.imageView.image = self.previewImage;

    if(self.previewImage != self.sourceImage) {
        dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
            CGImageRef hiresCGImage = NULL;
            CGFloat aspect = self.sourceImage.size.height/self.sourceImage.size.width;
            CGSize size;
            if(aspect >= 1.0) { //square or portrait
                size = CGSizeMake(kMaxUIImageSize*aspect,kMaxUIImageSize);
            } else { // landscape
                size = CGSizeMake(kMaxUIImageSize,kMaxUIImageSize*aspect);
            }
            hiresCGImage = [self newScaledImage:self.sourceImage.CGImage withOrientation:self.sourceImage.imageOrientation toSize:size withQuality:kCGInterpolationDefault];

          //  dispatch_async(dispatch_get_main_queue(), ^{
                self.imageView.image = [UIImage imageWithCGImage:hiresCGImage scale:1.0 orientation:UIImageOrientationUp];
                CGImageRelease(hiresCGImage);
          //  });
        });
    }

}
return self;
} 
```

还有图像的自定义设置器方法。

```
- (UIImage *)previewImage
{
if(_previewImage == nil && _sourceImage != nil) {
    if(self.sourceImage.size.height > kMaxUIImageSize || self.sourceImage.size.width > kMaxUIImageSize) {
        CGFloat aspect = self.sourceImage.size.height/self.sourceImage.size.width;
        CGSize size;
        if(aspect >= 1.0) { //square or portrait
            size = CGSizeMake(kPreviewImageSize,kPreviewImageSize*aspect);
        } else { // landscape
            size = CGSizeMake(kPreviewImageSize,kPreviewImageSize*aspect);
        }
        _previewImage = [self scaledImage:self.sourceImage  toSize:size withQuality:kCGInterpolationLow];
    } else {
        //self.previewImage = [self.sourceImage retain];
        _previewImage = self.retainedImage;
    }
}
return  _previewImage; 
```

}

我无法在子视图中加载图像。我知道属性不会在初始化时设置。但是我该如何设置它们。我尝试使用另一个属性retainedImage，并在其setter方法中将其分配给预览图像，但不起作用。

这是在[这里找到的自定义库](https://github.com/heitorfr/ios-image-editor)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T03:20:09.527

创建对象时，对象的属性将设置为 nil。如果要将属性更改为其他值，可以在任何方法中设置它们。

您没有看到图像的原因有很多。

1.  self.imageView 为零
2.  self.imageView.image 为零
3.  self.imageView 的大小为 0
4.  self.imageView 被隐藏
5.  self.imageView 未附加到任何视图
6.  self.imageView 被其他视图遮挡

根据您的描述，很难判断是哪一个原因造成的。

# c# - 控制器方法中的 FileContentResult null

> ID：15283718
> 
> 赞同：0
> 
> 时间：2013-03-07T23:14:30.170
> 
> 标签：c#, asp.net-mvc

我的控制器中有以下方法；

```
 [HttpGet]
        public ActionResult Process(int id)
        {
                var file = ServiceUtilities.FileManager.GetFile(id);

                if (file != null)
                {
                    var fcr = new FileContentResult(new byte[1], @"Image\Gif");
                    return fcr;
                }

                return RedirectToAction("Index", "Error");
        } 
```

我从我的单元测试中调用这段代码如下；

```
var response =
            new Controllers.FileController().Process(1) as FileStreamResult;

Assert.IsNotNull(response); 
```

但是，响应始终为空。如果我在控制器代码中设置断点`fcr`，它不为空。

为了澄清，`file`是一个模拟对象并且不为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:19:47.467

我可能遗漏了一些东西，但是`FileContentResult`（您从方法返回的）不是`FileStreamResult`（您在测试中将其转换为的）。它们都继承自`FileResult`，但为了让您的测试通过，`FileContentResult`需要继承自`FileStreamResult`。

或者这是一个错误的类型？

# javascript - Why are for..in faster than for loops when looping through an array

> ID：15283720
> 
> 赞同：0
> 
> 时间：2013-03-07T23:14:42.367
> 
> 标签：javascript, arrays, performance, for-loop

I have been wonder where a `for` loop or a `for..in` loop would be farther on an array.

I have tested this using [jsperf](http://jsperf.com/forloops-methodstest).

My `For` Loop had `16,676,377 op/s`
while the `for..in` only had `519,853 op/s`

So why is:

```
var a = ["hi", "hi2", "bye", "bye2"];

for (var i in a) {
  return a[i];
} 
```

Slower compared to:

```
var a = ["hi", "hi2", "bye", "bye2"];

for (var i = 0; i < a.length; i++) {
  return a[i];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:26:52.713

The answer for your question is simple: for in loop was not created to deal with arrays and does additional things as well and should not be used.

The main purpose of the for-in statement is to iterate thought object's properties, not through the array. This statement will also go into the array prototype chain, iteration through inherited properties and I think you do not need this or even do not know about this.

Another funny thing that you even do not know in what order it will be iterated.

So the main thing to remember - do not use for in with arrays. Only with objects.

P.S as RobG correctly added:

> A for loop will search for properties on the [[Prototype]] chain too if they aren't found on the array. E.g. a for loop over [0,,2] will search for 1 all the way to Object.prototype[[Prototype]]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:27:19.180

There are a couple of things wrong here.

1.  your `return` in the loop's body causes the loop to abort after the first iteration, your tests are useless
2.  `for..in` loops over an object's properties, an array's elements are *not its only properties*! were you to add a property, such as `a.foo = true`; that would be included in iterating with `for..in` but not in `for`.

Please don't use `for..in` to loop arrays. Not. Ever.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:22:41.870

It really depends on the JavaScript engine implementation. Because JavaScript is dynamically typed, the interpreter has to do some work to establish the type of a given variable. I suspect there are optimisations in the engine for the classic integer iterator for loop that aren't available when using for...in.

**EDIT:**

for..in iterates through the enumerable properties of a variable, so var i is assigned the value of each string in your array on each loop.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T23:27:24.920

To explain why a `for` loop is faster than a `for in` loop is basically understand the underlying data structures used to store the data in memory. Looping through an indexed based array is naturally faster because of the way an array is stored in memory. It's just a location in memory and the items in the array are stored in consecutive locations, aka. in order and next to each other. Generally it's fast to retrieve elements in consecutive order because you don't have to spend time to find it, you just know the next item is always the next location beside it. And because it knows the `array.length` and can determine which chunks of memory has been portioned off for the array.

# objective-c - 在实例中使用 connectiondidFinishLoading 并将数据返回到另一个视图

> ID：15283721
> 
> 赞同：2
> 
> 时间：2013-03-07T23:14:45.353
> 
> 标签：objective-c, xcode, cocoa, ios6, nsurlconnectiondelegate

我是 Cocoa 和 Objective-c 的初学者——所以请原谅我一个可能微不足道的问题。

我目前正在开发一个 XCODE-Project，它通过 NSJSONSerialization 获取一些数据并将其存储以供进一步工作。

在这一步，我将把获取数据的过程封装到一个类中，该类具有一些用于所需参数的设置器（要从中获取的 url 和应该解析为数组的层）。为了使用这个过程，我在这个类中创建了一个方法，它创建一个连接和一个请求并返回*应该*包含数据的数组。经过一些测试后，我尝试创建此类的一个实例并调用开始获取数据的方法。

我的问题是，从我的新实例“block_stats”调用方法 data_array 并将数据存储在相同类型的数组中 - 数组为空

```
table_data = [block_stats data_array]; 
```

这种行为的原因是 (didReceiveResponse,didReceiveData,connectionDidFinishLoading) 中的方法的使用是异步工作的，并且 data_array 的返回是在下载完成之前完成的。

* * *

包含下载部分的类中的方法：

```
- (NSMutableArray *)data_array
{
    [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;
    if(data_array)
    {
        [data_array removeAllObjects];
    } else {
        data_array = [[NSMutableArray alloc] init];
    }

    NSURLRequest *request = [NSURLRequest requestWithURL:data_url];
    connection = [NSURLConnection connectionWithRequest:request delegate:self];
    if(connection)
    {
        webdata = [[NSMutableData alloc]init];
    }
    return data_array;    
} 
```

* * *

另一个视图中的 IBAction，它创建实例并调用方法来获取数据

```
- (IBAction)refresh:(UIBarButtonItem *)sender {
    KDJSONparser *block_stats = [[KDJSONparser alloc]init];
    [block_stats setURL:[NSURL URLWithString:@"*JSONDATA_URL*"]];
    [block_stats setLayer:@"blocks"];
    table_data = [block_stats data_array];
} 
```

* * *

如果有人可以提供一些建议，我将非常高兴。如果它对我来说尽可能容易理解，那就太好了。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T07:25:15.827

您的问题的解决方案在于授权（顾名思义，当情况出现时，您将任命其他人采取行动。）

您已经在以下代码中使用了它。

```
NSURLRequest *request = [NSURLRequest requestWithURL:data_url];

connection = [NSURLConnection connectionWithRequest:request delegate:self]; 
```

在这里，当您将 self 设置为 NSURLConnection 的委托时，您是在告诉编译器向您发送与连接相关的任何适当消息。这些消息包括didReceiveResponse、didReceiveData、connectionDidFinishLoading。

所以让我们在你的类中实现这些方法，它们看起来像这样。

KDJSONParser.m

```
- (NSMutableArray *)fetchData
{
    [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;

    NSURLRequest *request = [NSURLRequest requestWithURL:data_url];
    connection = [NSURLConnection connectionWithRequest:request delegate:self];
    if(connection)
    {
        webdata = [[NSMutableData alloc]init];
    }    
}

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    // This method is called when the server has determined that it
    // has enough information to create the NSURLResponse.

    // It can be called multiple times, for example in the case of a
    // redirect, so each time we reset the data.

    // receivedData is an instance variable declared elsewhere.
    [webdata setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    // Append the new data to receivedData.
    // receivedData is an instance variable declared elsewhere.
    [webdata appendData:data];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    [connection release];

    //Parse the webdata here. Your array must be filled now.
    [self parseTheJSONData];
}

-(void)parseTheJSONData
{
  //Do your parsing here and fill it into data_array
  [self.delegate parsedArray:data_array];
} 
```

在你的其他类中，在你的刷新方法中添加这一行

```
block_stats.delegate = self; 
```

并实施

```
-(void)parsedArray:(NSMutableArray *)data_array; 
```

# qt - QGraphicsView/QGraphicsScene 渲染故障

> ID：15283731
> 
> 赞同：0
> 
> 时间：2013-03-07T23:15:29.170
> 
> 标签：qt, qgraphicsview, qgraphicsscene, qt4.8

假设我将一个图像添加到一个场景和一条线，使其端点之一恰好位于像素的一个角上。当我放大或缩小视图时，我看到线的端点相对于背景图像移动。当我改变缩放级别时，差异会发生变化。如果我添加更多线条或省略号，它们不会相对于彼此移动。

这是一个错误还是我没有正确使用某些东西？

我使用在 VMWare Player 中运行的 Ubuntu 12.04 附带的 Qt4.8。

# php - 将外部源文件添加到 PHP IDE

> ID：15283735
> 
> 赞同：3
> 
> 时间：2013-03-07T23:15:45.267
> 
> 标签：php, netbeans, ide, phpstorm

我正在尝试设置我的开发环境，但在为我的项目包含外部源文件时遇到了问题。

开发环境位于远程服务器上。使用 PHPStorm 和 Netbeans，我设置了一个远程项目并将 /var/www/site 作为我的项目位置。这会将文件下载到我的本地计算机并且工作正常。

问题是，当我单步执行代码时，一些包含文件位于项目目录（/etc/includes）之外，因此我无法进入它们。有没有办法将外部文件包含到 Netbeans 和 PHPStorm 的项目中？

我认为这也是我无法使用 Netbeans 单步执行代码的原因，它会加载调试，但我无法单步执行，只能继续。在 PHPStorm 我可以单步执行，但外部文件出错。

谢谢你。

# drawable - 如何将paintdrawable设置为视图背景？

> ID：15283736
> 
> 赞同：0
> 
> 时间：2013-03-07T23:15:47.640
> 
> 标签：drawable, paint

我正在尝试将 PaintDrawable 设置为视图的背景，以便动态更改颜色并保持边框，但是当我编写时：

```
vi.setBackground(pd);` 
```

我收到一个错误：NoSuchMethodError 这是我的代码：

```
PaintDrawable pd = new PaintDrawable(color);

pd.setCornerRadius(4);
pd.setPadding(1, 1, 1, 1);
vi.setBackground(pd)                         
DyL.addView(vi); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T20:10:24.393

`setBackground(Drawable)`在 Android SDK 16 中引入。如果您希望与早期的 SDK 兼容，您应该使用已弃用的 setBackgroundDrawable 或显式测试 SDK 版本。

# javascript - 忽略下划线模板中未定义的数据/变量

> ID：15283741
> 
> 赞同：19
> 
> 时间：2013-03-07T23:16:10.703
> 
> 标签：javascript, backbone.js, underscore.js

还在学习骨干，请多多包涵；

我正在尝试将带有空白字段的新模型添加到视图中，但是我创建的模板有一大堆

```
<input value="<%= some_value %>" type="whatever" /> 
```

获取数据时工作得非常好，它填充它并且一切顺利。当我想创建一个新的（空白）渲染视图时，问题就出现了，它给了我

```
Uncaught ReferenceError: some_value is not defined 
```

我可以设置`defaults`（我已经为一些在数据库中具有默认值的设置），但这意味着用空格输入超过 40 个；有没有更好的方法来处理这个？

我正在摆弄下划线模板本身，尝试类似的东西，`<%= if(some_value != undefined){ some_value } %>`但这似乎也有点麻烦。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-07T23:23:49.997

在包装器对象中传递模板数据。缺少属性访问不会引发错误：

所以，而不是：

```
var template = _.template('<%= foo %><%= bar %>');
var model = {foo:'foo'};
var result = template(model); //-> Error 
```

尝试：

```
var template = _.template('<%= model.foo %><%= model.bar %>');
var model = {foo:'foo'};
var result = template({model:model}); //-> "foo" 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-05-22T13:50:40.013

实际上，您可以`arguments`在模板内部使用：

```
<% if(!_.isUndefined(arguments[0].foo)) { %>
       ...
<% } %> 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-03-07T23:26:17.957

**不，**

由于下划线模板的实现方式，对此没有实际的*修复。*

请参阅有关它的[讨论](https://github.com/documentcloud/underscore/issues/237)：

> 恐怕这只是 with(){} 在 JS 中的工作方式。如果未声明变量，则为 ReferenceError。在保留模板行为的其余部分的同时，我们无能为力。

您可以完成您正在寻找的唯一方法是将对象与另一个对象（如建议的其他答案）包装在一起，或者设置默认值。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-07-07T16:35:17.563

如果您检查生成的模板函数的源代码，您将看到如下内容：

```
with (obj||{}) {
  ...
  // model property is used as variable name
  ...
} 
```

这里发生了什么：起初 JS 试图在“obj”中找到你的属性，它是模型（更多关于[with](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Statements/with)语句）。在“obj”范围内找不到该属性，因此 JS 向上遍历直到全局范围并最终抛出异常。

因此，您可以直接指定您的范围来解决此问题：

```
<input value="<%= obj.some_value %>" type="whatever" /> 
```

至少它对我有用。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-23T00:33:17.720

实际上，您可以访问变量，如初始对象属性。

如果您将调试器激活到模板中，您可以找到包含所有数据的变量“obj”。

所以`<%= title %>`你应该写而不是`<%= obj.title %>`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-28T07:14:48.703

lodash，一个下划线的替代品，提供了一个带有内置解决方案的[模板函数。](https://lodash.com/docs#template)它可以选择将数据包装在另一个对象中，以避免导致错误的“with”语句。

API 文档中的示例用法：

```
// using the `variable` option to ensure a with-statement isn’t used in the compiled template
var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });
compiled.source;
// → function(data) {
//   var __t, __p = '';
//   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';
//   return __p;
// } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-18T15:13:21.127

一个非常简单的解决方案：您可以确保您的数据集合是规范化的，即所有属性都存在于每个对象中（如果它们未使用，则为空值）。像这样的功能可以帮助：

```
function normalizeCollection (collection, properties) {
  properties = properties || [];
  return _.map(collection, function (obj) {
    return _.assign({}, _.zipObject(properties, _.fill(Array(properties.length), null)), obj);
  });
} 
```

（注：`_.zipObject`和`_.fill`在最新版本的 lodash 中可用，但没有下划线）

像这样使用它：

```
var coll = [
  { id: 1, name: "Eisenstein"},
  { id: 2 }
];

var c = normalizeCollection(coll, ["id", "name", "age"]);
// Output =>
// [
//  { age: null, id: 1, name: "Eisenstein" },
//  { age: null, id: 2, name: null }
// ] 
```

当然，您不必永久转换数据 - 只需在调用模板渲染函数时动态调用该函数：

```
var compiled = _.template(""); // Your template string here
// var output = compiled(data); // Instead of this
var output = compiled(normalizeCollection(data)); // Do this 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-02-23T21:32:13.653

您可以通过向模型添加函数并在模板中使用它来进一步抽象@Dmitri 的答案。

例如：

模型 ：

```
new Model = Backbone.Model.extend({
    defaults: {
        has_prop: function(prop) {
            return _.isUndefined(this[property]) ? false : true;
        }
    }
}); 
```

模板：

```
<% if(has_prop('property')) { %>
    // Property is available
<% } %> 
```

正如他的回答中的评论所暗示的那样，这更具可扩展性。

# list - Scala 将项目列表映射到一个值

> ID：15283742
> 
> 赞同：0
> 
> 时间：2013-03-07T23:16:11.157
> 
> 标签：list, scala, map

我有一个句子的*二元组列表和另一个**相关*二元组的原始列表，我想检查句子中是否存在任何*相关*二元组，然后我想返回句子。我正在考虑按如下方式实现它：将列表中的每个二元组映射到它们来自的句子，然后对键进行搜索并返回值。

例子：

```
relevantbigrams = (This is, is not, not what)
bigrams List(list(This of, of no, no the),list(not what, what is)) 
```

所以每个列表都是一个单独的句子的二元组。这里第二句中的“不是什么”匹配，所以我想返回第二句。我计划制作一张地图（“This of”->“This of no the”、“of no”->“This of no the”、“not what”->“not what is”）。等并返回在相关二元组上匹配的句子，所以在这里我返回“不是什么”

这是我的代码：

```
val bigram = usableTweets.map(x =>Tokenize(x).sliding(2).flatMap{case Vector(x,y) => List(x+" "+y)}.map(z => z, x))
for(i<- 0 to relevantbigram.length)
    if(bigram.contains(relevantbigram(i)))) bigram.get(relevantbigram(i))
    else useableTweets.head 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T00:37:51.347

你得到了订单或`flatMap`错误`map`的方式：

```
val bigramMap = usableTweets.flatMap { x => 
    x.split(" ").sliding(2).
      map(bg => bg.mkString(" ") -> x)
} toMap 
```

然后你可以像这样进行搜索：

```
relevantbigrams collect { rb if theMap contains rb => bigramMap(rb) } 
```

或者

```
val found = 
  for { 
    rb <- relevantbigrams
    sentence <- theMap get rb
  } yield sentence 
```

两者都应该给你一个列表，但是从你的代码看来，如果你的搜索什么也没找到，你希望默认为第一句：

```
found.headOption.getOrElse(usableTweets.head) 
```

# neo4j - 为用户删除 Neo4j 中的所有关系和连接节点

> ID：15283743
> 
> 赞同：4
> 
> 时间：2013-03-07T23:16:13.700
> 
> 标签：neo4j, spring-data-neo4j

我们选择 neo4j 作为我们 Web 应用程序的数据库。用户有大量的关系和连接的节点。截至目前，一个用户大约有 20 个关系。其中一项功能是新闻源功能。如果我想完全删除用户，密码查询是最好的删除方式还是有其他选择？

由于我们仍在计划添加新功能，因此连接到用户的关系和节点也会增加。因此，如果我们使用密码查询，则必须针对添加的每个新关系修改查询。请指教。

谢谢，帕万

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T23:43:52.303

是的，您可以使用 Cypher 删除用户。当然，还有其他方法，具体取决于您在 Web 应用程序中使用的语言或框架。如果您想就此提出建议，请详细说明您是如何使用 Neo4j 的。

请注意，您必须首先删除所有关系（传出和传入）才能删除节点。

例子：

```
START n = node(3)
MATCH n-[r]-()
DELETE n, r 
```

这个例子取自官方手册：[http ://docs.neo4j.org/chunked/milestone/query-delete.html](http://docs.neo4j.org/chunked/milestone/query-delete.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-13T14:43:51.657

从 Neo4j 2.3 开始，还有另一种方法可以做到这一点：

```
MATCH (n { name:'Andres' })
DETACH DELETE n 
```

我在文档中找到了这个例子：http: [//neo4j.com/docs/stable/query-delete.html](http://neo4j.com/docs/stable/query-delete.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T09:32:07.123

另一种方法是编写一个 gremlin 脚本，该脚本从您的用户开始遍历您的图表，并将您打算删除的关系和节点放入两个集合中。如果您想删除所有内容，也许您可​​以在 Gremlin 中实现深度优先遍历并在遍历时删除。

# php - 为什么 Symfony 2 安装到 web 根目录中？

> ID：15283745
> 
> 赞同：1
> 
> 时间：2013-03-07T23:16:17.750
> 
> 标签：php, symfony

我正在考虑下载和学习 Symfony 2。我以前没有真正看过 PHP 框架。

我知道这里不允许讨论，但我很确定我的问题不是主观的，而且我的问题有一个明显的明确答案。

为什么 Symfony 2 被下载到公共网络根目录？

当然它应该是非公开的，只有 HTML/CSS 等应该是公开的？

显然我错了，但会很感激这个原因。

这是否意味着有人可以访问[http://mysite.com/symfony/classes/database.php](http://mysite.com/symfony/classes/database.php)等（不是特定的 URL，只是为了强调我的观点）并运行各种脚本？显然这可能只是一个类文件，但它仍然不适合我。

另外，我想在同一个框架上运行 5 或 6 个不同的站点。如果它安装在 web 根目录中，那并不意味着我需要为每个站点（在每个站点的 web 根目录中）安装整个 Symfony 代码库——就好像它托管在 web 根目录之外，那么每个站点都可以引用它（例如'../../symfony/classes/database.php'等）（只要所有站点都在同一台服务器上）。

我必须错过一些非常清楚和明显的东西。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-07T23:45:24.980

虽然许多框架确实将所有代码都放在了 Web 根目录中，但 Symfony 却没有。

Instead, the standard distribution has a /web folder, which you should make your webroot.

If you are on a server where you cannot configure the webroot to be within your Symfony project folder, you can instead use a [symbolic link](http://en.wikipedia.org/wiki/Symbolic_link) between the webroot folder and the Symfony web folder. This is common practice for things such as shared hosting plans.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:30:38.453

我对 Symfony 没有太多经验，但我相信它`.htaccess`在根目录中有一个文件，可能有这样的一行：

```
RewriteRule ^$ web/app.php 
```

这意味着对根目录的所有请求都会被重定向到 /web/app.php 文件。唉，除了那个文件，没有人可以去任何地方。

正如其他人指出的那样，在生产环境中，出于更严格的安全考虑，您应该将您的 webroot 指向 /web 目录。我上面的回答只是想指出为什么它以开箱即用的方式工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:27:54.093

当您将框架数据放在服务器上时，它希望公开。只有文件夹`public`通过虚拟主机指向 VPS 服务器并视为公共文件夹。Symfony 公用文件夹是`web`这样你应该指向虚拟主机来加载 index.php

看更多关于：[在 Symfony 1.4 中重命名“web”文件夹](https://stackoverflow.com/questions/3946840/rename-web-folder-in-symfony-1-4)

示例如何在 symfony2 上设置文档根目录：[symfony2 安装说明请帮助](https://stackoverflow.com/questions/8815285/symfony2-installation-instruction-help-please)

版本 2 与 1.4 类似，因为您只需要指向路径。

# mysql - 如何使用 MIN (MySQL) 从三个表中获取信息

> ID：15283746
> 
> 赞同：0
> 
> 时间：2013-03-07T23:16:23.380
> 
> 标签：mysql, sql, join, min

我有四个表，如下所示：

```
items
| id | name  | category |
-------------------------
| 1  | item1 | toy      |  
| 2  | item2 | toy      |
| 3  | item3 | home     |
-------------------------
items2
| id | name  | category | size |
--------------------------------
| 1  | itemA | toy      | s    |
| 2  | itemB | home     | l    |
--------------------------------
prices
| items.id | price |
--------------------
|  1       |  10   |
|  1       |  15   |
|  2       |  20   |
|  3       |  25   |
|  3       |  20   |
--------------------
prices
| items2.id | price |
--------------------
|  1        |  15   |
|  2        |  50   |
|  2        |  40   |
-------------------- 
```

我需要得到一个同时包含 items 和 items2 的结果，以及每个价格的 MIN。在这个例子中，结果应该是这样的：

```
| id | name  | category | size | minprice |
-------------------------------------------
| 1  | item1 | toy      | null | 10       |
| 2  | item2 | toy      | null | 20       |
| 3  | item3 | home     | null | 20       |
| 1  | itemA | toy      | s    | 15       |
| 2  | itemB | home     | l    | 40       |
------------------------------------------- 
```

我也应该能够`ORDER BY minprice`，但我确信当我知道如何加入他们时，我也能做到。

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T23:21:53.157

我建议您合并表项目和项目2。如果一个字段不适用于某个项目（例如本例中的大小），这就是 null 的用途。

我还没有测试过它是否有效，但你想要这样的东西：

```
SELECT i.id, name, category, null as size, min(prices.price) from items i
JOIN prices on prices.id = i.id
GROUP BY i.id, i.name, i.category, size
UNION ALL
SELECT i2.id, name, category, size, min(prices2.price) from items2 i2
JOIN prices2 on prices2.id = i2.id
GROUP BY i2.id, i2.name, i2.category, i2.size 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:21:40.023

据我所知，你把事情复杂化了。你只需要一张桌子。对于没有大小的项关系中的元组，只需将其标记为空。

这可能过于简单化了。如果价格是“销售”或类似的东西，您可以使用左连接来建立您正在寻找的关系

所以

SELECT i.id, i.name, i.category, i.size, p.price as min_price FROM items i LEFT JOIN price p where p.price <= 40 ORDER BY min_price

# c# - Char 到 int 的转换以获得 ASCII

> ID：15283747
> 
> 赞同：10
> 
> 时间：2013-03-07T23:16:27.447
> 
> 标签：c#

这可能是一个不成熟的问题，可能缺少一些东西，但我的问题是

尝试将 a 转换为`char`ASCII`int`值*，*在`char`大多数情况下，我得到了特定的正确/预期的*ASCII*码`char`，在某些情况下我没有。有人可以解释我为什么吗？

例子：

```
// Example 1:-   

Console.WriteLine((int)'a');

// gives me 97 perfect!

// Example 2:-

Console.WriteLine((char)1); gives me ☺

// now 

Console.WriteLine((int )'☺');

// this should give me 1, instead it gives me 9786 why? 
```

这发生在 ASCII >`127`或 ASCII < `32`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-07T23:20:37.307

`\01`是不可打印的字符，因为结果控制台可以自由使用任何替换来使其可见。

此外，默认的 Windows 控制台对 Unicode 不是很友好，所以当您打印默认可打印 ASCII 范围之外的字符时会发生奇怪的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-07T23:20:55.037

首先，没有“ASCII > 127”之类的东西——ASCII 只能达到 127（或 126；我不记得 delete 是否正确地属于 ASCII）。

基本上，当您打印出诸如 U+0001（“标题开始”）之类的不可打印字符时，由显示设备决定如何处理。有些控制台会打印正方形，有些会打印笑脸等等。你当然不应该期望它是可逆的。不过，您*可以*期望转换本身在代码中是可逆的：

```
char c = '\u0001';
int i = c; // i = 1
char d = (char) i;
Console.WriteLine(c == d); // True 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T23:44:01.817

在回答您的问题时，为什么`Console.WriteLine((int )'☺');`返回 9786，这是因为 Unicode 中的“☺”由字节 58 38 表示，整数表示为 9786。

c# 中的字符是 Unicode 字符。

# ios - 以编程方式选择单元格并转到 tabbarcontroller

> ID：15283748
> 
> 赞同：0
> 
> 时间：2013-03-07T23:16:33.347
> 
> 标签：ios, objective-c, uitableview, uitabbarcontroller, segue

我有一个主视图（uitableviewcontroller），它有一个表和一个按钮
，该按钮与模态segue链接到另一个视图以将对象添加到表（在主视图上）
，并且单元格与模态segue链接到一个tabbarcontroller第一个选项卡显示有关此对象的详细信息

我试图在创建新对象后自动转换到详细视图（到第一个选项卡）

我不知道如何
使用 performSegueWithIdentifier 失败，演示已经在进行中
，并且使用 tableView didSelectRowAtIndexPath 我无法完全创建此转换的逻辑

帮助将不胜感激
谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T00:25:18.033

按钮有关联的动作吗？如果是这样，您可以使用 performselector 来模拟按钮按下。

```
[self performSelector:@selector(buttonAction:) withObject:nil afterDelay:0.01]; 
```

如果由于正在呈现而导致触发segue的问题失败，您也可以使用我上面提到的方法在适当的延迟后调用一个方法，以确保视图已经呈现。可能您会将它与 viewDidAppear 方法结合使用。我希望这可以帮助你。

# java - facebook 中的元素列表

> ID：15283750
> 
> 赞同：1
> 
> 时间：2013-03-07T23:16:51.277
> 
> 标签：java, android

我想创建一个应用程序，它在页面底部有一个列表，当我向下滚动屏幕时，屏幕顶部消失并只显示元素列表（当我再次向上滚动时，它显示顶部再次页面）- 与 facebook 应用程序中的相同..

我试图实现它，这是我的带有列表视图和滚动视图的 xml，但是它没有按预期工作..

当我滚动页面时，页面保持原样，并且只有当我滚动列表视图时，列表视图才会下降，但是页面顶部保持不变，列表视图保持相同大小）

我怎样才能做与 facebook android 应用程序中相同的列表？

多谢

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:fillViewport="true" >

 <RelativeLayout
     android:layout_width="fill_parent"
     android:layout_height="wrap_content"
     android:background="#ffffff" >

     <!-- Header  Starts -->

     <LinearLayout
         android:id="@+id/header"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content"
         android:background="@layout/header_gradient"
         android:paddingBottom="5dip"
         android:paddingTop="5dip" >

         <!-- Logo Start -->
         <!-- Logo Ends -->

         <com.facebook.widget.ProfilePictureView
             android:id="@+id/profilePictureView1"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:layout_marginLeft="18dp"
             android:layout_weight="1" >
         </com.facebook.widget.ProfilePictureView>

         <TextView
             android:id="@+id/profileNameText"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
             android:layout_marginTop="80dp"
             android:layout_weight="1"
             android:ems="10"
             android:inputType="textPersonName" />
     </LinearLayout>
     <!-- Header Ends -->

     <ImageView
         android:id="@+id/freinds"
         android:layout_width="50dp"
         android:layout_height="50dp"
         android:layout_alignParentRight="true"
         android:layout_below="@+id/detailsText"
         android:layout_marginRight="40dp"
         android:layout_marginTop="17dp"
         android:src="@drawable/logo" />

     <ImageView
         android:id="@+id/LikeImage"
         android:layout_width="50dp"
         android:layout_height="50dp"
         android:layout_alignTop="@+id/freinds"
         android:layout_marginRight="27dp"
         android:layout_toLeftOf="@+id/freinds"
         android:src="@drawable/logo" />

     <TextView
         android:id="@+id/detailsText"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:layout_below="@+id/header"
         android:layout_marginTop="16dp"
         android:layout_toLeftOf="@+id/freinds"
         android:ems="10"
         android:inputType="textMultiLine" >

         <requestFocus />
     </TextView>

     <LinearLayout
         android:id="@+id/linearLayout1"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content"
         android:layout_alignParentLeft="true"
         android:layout_below="@+id/freinds" >

         <Button
             android:id="@+id/registerTwitter"
             android:layout_width="0dp"
             android:layout_height="fill_parent"
             android:layout_weight="1"
             android:text="Sale" />

         <Button
             android:id="@+id/registerFB"
             android:layout_width="0dp"
             android:layout_height="fill_parent"
             android:layout_weight="1"
             android:text="Deliver" />

         <Button
             android:id="@+id/clearCredentials"
             android:layout_width="0dp"
             android:layout_height="fill_parent"
             android:layout_weight="1"
             android:text="Group" />
     </LinearLayout>

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_below="@+id/linearLayout1"
        android:orientation="vertical" >

                <EditText android:id="@+id/EditText01"
                                android:layout_height="wrap_content"
                                android:layout_width="fill_parent"
                                android:hint="Search">                               
                </EditText>

                <ListView android:id="@+id/ListView01"
                                android:layout_height="wrap_content"
                                android:layout_width="fill_parent">
                </ListView>

    </LinearLayout>

 </RelativeLayout>

</ScrollView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:31:49.917

我认为你想要的比 xml 布局更复杂一点，但也许我想念理解，试着玩一下滚动视图事件。

您想在用户向上滚动时立即显示页面顶部，因此您需要注册滚动视图的 onscroll 事件，并检查滚动方向，以显示页面顶部。这更清楚吗？

# java - 错误：未定义 xyz 类的构造函数

> ID：15283754
> 
> 赞同：0
> 
> 时间：2013-03-07T23:17:06.977
> 
> 标签：java, android

```
public class MainActivity extends Activity {

    private String md5(String in) {
        MessageDigest digest;
        try {
            digest = MessageDigest.getInstance("MD5");
            digest.reset();
            digest.update(in.getBytes());
            byte[] a = digest.digest();
            int len = a.length;
            StringBuilder sb = new StringBuilder(len << 1);
            for (int i = 0; i < len; i++) {
                sb.append(Character.forDigit((a[i] & 0xf0) >> 4, 16));
                sb.append(Character.forDigit(a[i] & 0x0f, 16));
            }
            return sb.toString();
        } catch (NoSuchAlgorithmException e) {
            e.printStackTrace();
        }
        return null;
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Button btn = (Button) findViewById(R.id.button1);
        btn.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                EditText text = (EditText) findViewById(R.id.editText1);
                EditText text1 = (EditText) findViewById(R.id.editText2);
                String userid = text.getText().toString();
                String pass = text1.getText().toString();

                Toast.makeText(
                        MainActivity.this,
                        "Entered " + userid + " and password entered is "
                                + pass, Toast.LENGTH_LONG).show();

                pass = md5(pass + "@string/salt");

                Toast.makeText(
                        MainActivity.this,
                        "Password after adding a salt and md5 hashing is now equal to "
                                + pass, Toast.LENGTH_LONG).show();

                /* This Line */DBAdapter db = new DBAdapter(this); // This Line.
                db.open();
                Cursor c = db.getPasswordForUserName(userid);
                if (c.moveToFirst()) {
                    if (c.getString(1) == pass) {
                        Toast.makeText(MainActivity.this,
                                "Authentication Succeded", Toast.LENGTH_SHORT)
                                .show();
                        // proceed
                    } else {
                        Toast.makeText(MainActivity.this, "@string/AuthFail",
                                Toast.LENGTH_SHORT).show();
                        // AuthFailure
                    }
                } else {
                    Toast.makeText(MainActivity.this, "@string/UserNotFound",
                            Toast.LENGTH_SHORT).show();
                    // where to from here
                }
            }
        });
    }
} 
```

我对 Android 编程很陌生。所以我从很多地方获取了代码片段，然后将它们组合起来。

基本上我想要做的就是在本地 SQLite DB 中查询`UserName`和`Password`+的现有值`salt(with md5 hash)`。

所以我复制了一些代码来创建一个数据库助手类（`DBAdapter`），它有非常基本的方法来处理数据库。

现在的问题是在`MainActivity.java`文件中。代码中标记为*“此行”*的行给出了错误*构造函数 DBAdapter(new View.OnClickListener(){}) 未定义。*我不知道这是什么意思。我应该怎么做才能让它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:22:39.047

我只能猜测尝试 MainActivity.this ，有预感..

```
DBAdapter db = new DBAdapter(MainActivity.this); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:30:36.257

我建议阅读更多有关 android 工作原理的信息。在这种特殊情况下，您需要了解[Contexts](http://developer.android.com/reference/android/content/Context.html)，但我将从[这里](http://developer.android.com/guide/components/fundamentals.html)开始。

如前所述，您可以使用**MainActivity.this**为 DBAdapter 提供正确的应用程序上下文。

# jqgrid - 带有本地排序数据的jqGrid，如何手动正确添加、更改、删 除行

> ID：15283760
> 
> 赞同：1
> 
> 时间：2013-03-07T23:17:31.760
> 
> 标签：jqgrid

我是 jqGrid 的新手，但学习速度很快......

我正在将 jqGrid 与本地数据一起使用。它显示某些对象的状态，并且它们正在实时更改。我通过基于彗星的 API 接收状态更改，这些更改需要我在表中添加/更改/删除行。数据需要保持按隐藏的“排序顺序”列排序。我认为，这使得静态排序更容易。

所以我没有使用“数据”参数，我没有“加载”任何数据，我一次添加一行。

我正在考虑进行每次插入，我可以在每次插入后重新排列行，或者更好地遍历表数据中的项目，直到最后，或者找到一个比一个更大的（通过这个排序值）我正在补充。然后在这一行之前添加新的。目前我将它们全部添加到第 1 行，每个对象都像这样：

```
 jQuery("#mygrid").jqGrid('addRowData',1, obj); 
```

所以我看到了它们，它们看起来很棒，但它们的顺序还不是正确的。

删除（我认为）很容易。我还没有到那里。

但是，变化呢？数据的更改可能包括“排序顺序”值的更改，因此我希望在每次更改后重新使用数据。我相信我可以将这个隐藏列定义为排序列，当数据发生变化时，改变底层数据。有没有一种简单的方法可以让网格“重新排序”它拥有的行？我尝试了 $('#mygrid').trigger("reloadGrid") 但这并没有采取任何措施......在使用上面的 'addRowData' 调用加载初始数据后，它没有任何效果。数据还是一样...

我在正确的轨道上吗？是否有一个示例以编程方式添加行、更改行、删除行、使用网格真的只是为了显示事物的当前排序状态？

这是我在 $(document).ready() 中创建的网格定义

html: <table id='mygrid'></table>

```
 jQuery("#mygrid").jqGrid({
                datatype: "local",
                loadonce: true,
                scroll:1,
                height: "auto",
                width: '100%',
                colNames:['A','B', 'C', 'D', 'SortKey'],
                colModel:[
                    {name:'a',index:'a'},
                    {name:'b',index:'b'},
                    {name:'c',index:'c'},
                    {name:'d',index:'d'},
                    {name:'sortordering',index:'sortordering', hidden:true} 
                ],
                rowNum:200,
                sortname: 'sortordering',
                sortorder: 'asc',
                shrinkToFit: true,
                autowidth: true,
                viewrecords: true,
                multiselect: false,
                imgpath: "lib/basic/images",
                caption: "Testing 123"
            }); 
```

网格与我添加的数据看起来很棒，我现在只需要对其进行排序并管理状态更改......

感谢您的任何建议！

编辑#1：我一直在忙着尝试和学习什么是最好的。到目前为止，这是我所知道的：

1) $('#mygrid').trigger("reloadGrid") 不适用于“loadonce”/“本地”数据。如果您正在这样做，它用于从主机获取/刷新数据。

2）我在任何更改后成功采取的唯一方法是调用 jQuery("#mygrid").jqGrid('sortGrid',"sortordering",false); 但是，我必须调用它两次 :-( 因为每次调用都会切换方向（升序或降序），就像我单击了列一样。无法在“sortGrid”调用中指定方向 - 应该是我的附加参数观点...

3) 对于更改数据，我需要使用 jQuery("#mygrid").jqGrid('setRowData',...); 并且可能在那之后诉诸

4）删除数据我需要使用 jQuery("#mygrid").jqGrid('delRowData',...);

我的下一个任务是找出正确的方法来找到我想要更改的行的 rowID，希望不要遍历所有这些，但如果我必须这样做，我会这样做......

编辑#2：我现在了解 rowID 的重要性，这很有帮助！正如我在这里解释的那样，您也可以指定一个列值作为 rowID 值（最好是唯一的！），这使得以后引用该行变得非常容易......所以，当新信息到达时，您需要编辑 (setRowData) 或删除 (delRowData)，将此列的值作为 setRowData 或 delRowData 的 rowID 参数传递，然后将整个对象（作为新数据）传递给您。如果您不想在网格中看到这个“键”，只需将其隐藏即可。要将此列指定为隐藏列并在 colModel 规范中指定为 rowID（将主键更改为数据中的任何属性名称）：

```
 {name:'primarykey',index:'primarykey', key: true, hidden:true} 
```

顺便说一句 - 在我上面的示例中，我昨天尝试使用“排序顺序”列作为键，但是虽然它始终是唯一的，但它实际上会随着时间的推移而变化，因此它不适合作为键的候选：true 属性.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T03:22:29.713

试试这个，

插入后更改并`sortname: 'sortordering',`重新加载网格。所以网格总是会在加载时和插入后对asc中的A列数据进行排序`sortname: 'a',``$('#mygrid').trigger("reloadGrid")`

我不明白列排序的用途是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T14:21:11.103

看起来您将被设置为：

```
$('#GridName').jqGrid().sortGrid('ColumnName',true); 
```

如果您想在刚刚设置的列的 colModel 中更改该列的默认排序方向：

```
firstsortorder: 'desc', 
```

# c++ - c++ 函数——第一个/最后一个日期是哪个日期？

> ID：15283762
> 
> 赞同：1
> 
> 时间：2013-03-07T23:17:36.787
> 
> 标签：c++

我的一个 c++ 函数根据其他变量的值进行一些计算。该程序要求提供一堆信息，包括 2 个单独事件的开始日期和结束日期。

`p1.start_date`和`p2.start_date`; `p1.end_date`并且`p2.end_date`其中每个都存储有日、月和年。

我需要设置`combined.start_date`较早发生的情况（`p1.start_date`或`p2.start_date`），并且需要设置`combined.end_date`较晚发生的情况。

我可以在开始这个过程中得到一些帮助吗？这是我现在拥有的：http: [//pastebin.com/huJprtHj](http://pastebin.com/huJprtHj)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:20:44.630

至少假设所涉及的日期是合理的当前¹，将月/日/年填充到 a`struct tm`并用于`mktime`转换为 a `timt_t`，那么您可以`time_t`直接比较这两个 s。

如果您需要/想要支持更广泛的日期，您可以考虑[Ray Gardner 的 Julian Date routines](http://www8.cs.umu.se/~isak/snippets/jdn.c)。

* * *

1.  至少在典型情况下，从 1970 年到至少 2038 年的日期是可行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:21:05.357

通常，可以通过两种方式进行基于日期的计算。

1.  将日期转换为“自某个固定日期（例如 1970 年 1 月 1 日）以来的天数”。
2.  使用日期组件（年、月、日）。

如果这就是您需要做的全部，只需比较每个部分（与“最高优先”）就可以了 - 您只需要一个可以告诉您 date1 是否小于 date2 的比较函数。

你剩下的问题应该是非常简单的编程。

编辑：澄清：对于 DATE 计算，从设定日期开始的天数就可以了。系统库函数的函数使用秒 [在某些系统中，为几分之一秒] 的完整时间可以低至几秒。这对于比较不涉及时间的日期不是必需的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:20:37.093

做这个功能。我猜您的日期存储在一个名为 的对象中`Date`，因为您没有指定。

```
bool operator< ( const Date& left, const Date &right )
{
   // ...
} 
```

然后你可以比较你的日期对象，就像它们是内置类型一样`int`。

# mono - Mono 与 .NET 中可能的评估顺序差异

> ID：15283763
> 
> 赞同：1
> 
> 时间：2013-03-07T23:17:39.513
> 
> 标签：mono, protobuf-net

我在一个对象上有一个 Equals 覆盖，以检查使用预编译的 protobuf-net 序列化器对象反序列化的两个对象之间的值相等性。我已经验证了反序列化按预期发生（在那张纸条上，protobuf-net 很棒）。

这个类非常简单，但是其他更复杂的类也会出现类似的问题，所以我将使用它作为模型。

这是有问题的代码片段：

```
public bool Equals (CompressionConfiguration other) {
    if (ReferenceEquals(null, other)) return false;
    if (ReferenceEquals(this, other)) return true;
return string.Equals (AlgorithmName, other.AlgorithmName) &&
        (AlgorithmConfiguration == null ? other.AlgorithmConfiguration == null : 
        AlgorithmConfiguration.SequenceEqual(other.AlgorithmConfiguration));
} 
```

在 .NET 运行时执行时，这会按预期进行计算，允许 AlgorithmConfiguration 为空值，它是 byte[] 类型的。在 Mono 下，我得到一个 SequenceEqual 空参数错误，特别是 ArgumentNullException。是什么赋予了？这不应该发生，因为只有在 AlgorithmConfiguration != null 时才应该调用 SequenceEqual。

这绝对是源头，因为如果我为 CompressionConfiguration 提供零长度字节 []，则不会发生故障。如果可能的话，我真的宁愿不发送零长度数组。我必须具有 Mono 兼容性，因为这将用于 Xamarin.Android (MonoDroid) 和 MonoTouch，以及 Mono 服务器，然后是 .NET 桌面应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:55:00.070

奇怪的是，在 Mono 下重新编译序列化程序程序集解决了这个问题，即使这不是 ArgumentNullException 的起源，而且我已经验证了对象已正确反序列化。现在一切正常。

# javascript - 将 Clusterfck 数组转换为 JavaScript InfoVis Toolkit json 层次结构

> ID：15283771
> 
> 赞同：3
> 
> 时间：2013-03-07T23:17:52.603
> 
> 标签：javascript, d3.js, cluster-computing, hierarchical-clustering, infovis

目前我正在使用 javascript 库[Clusterfck](http://harthur.github.com/clusterfck/)来执行数据分组。该库生成以下格式的数组：

```
[
  {"canonical":[20,120,102],
   "size":1
  },
  {"canonical":[250,255,253],
   "left":{
      "canonical":[250,255,253],
      "size":1
    },
   "right":{
      "canonical":[255,255,240],
      "size":1
    },
   "size":2
  },
  {"canonical":[100,54,300],
   "size":1
  }
] 
```

但是用于数据可视化的 javascript 库如何 D3.js 和[Jit](http://philogb.github.com/jit/index.html)使用 JSON 结构如下所示：

```
{
    "canonical":"Pai",
    "children":[
        {"canonical":[20,120,102],  "size":1},
        {
            "canonical":[250,255,253],
            "children": [
                {"canonical":[250,255,253], "size":1},
                {"canonical":[255,255,240], "size":1}               
            ],
            "size":2
        },
        {
            "canonical":[100,54,300],
            "size":1
        }
    ]
} 
```

我想使用 JavaScript 或 PHP 转换这些结构。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T00:36:52.633

如果您只想在这些结构之间进行转换，这非常简单。见工作小提琴：http: [//jsfiddle.net/nrabinowitz/vuk94/](http://jsfiddle.net/nrabinowitz/vuk94/)

```
function convert(input, rootName) {
    // top level
    if (Array.isArray(input)) {
        return {
            "canonical": rootName,
            "children": input.map(convert)
        };
    }
    // node
    else {
        ['left', 'right'].forEach(function(side) {
            if (input[side]) {
                input.children = input.children || [];
                input.children.push(convert(input[side]));
                delete input[side];
            }
        });
        return input;
    }
} 
```

这使用了一些 ECMAScript 1.5 特性（`Array.isArray`、`forEach`和`map`），但如果您使用的是 d3，那么您可能会针对支持此功能的浏览器。

# jquery - Firefox 中的高度错误（画布绘图）

> ID：15283772
> 
> 赞同：1
> 
> 时间：2013-03-07T23:17:55.820
> 
> 标签：jquery, css, html5-canvas

我需要一个脚本在画布红色框中与右侧的 html-table-tds 并排绘制...

它是如何完成的：http: [//jsfiddle.net/KaDnQ/1/](http://jsfiddle.net/KaDnQ/1/)

html:

```
<table border="1">
<tr>
    <td valign="top">
        <table class="t2" border="1">
        <tr><td>1</td></tr>
        <tr><td>2</td></tr>
        <tr><td>3</td></tr>
        <tr><td>4</td></tr>
        <tr><td>5</td></tr>
        <tr><td>6</td></tr>
        <tr><td>7</td></tr>
        <tr><td>8</td></tr>
        <tr><td>9</td></tr>
        <tr><td>10</td></tr>
        <tr><td>11</td></tr>
        <tr><td>12</td></tr>
        <tr><td>13</td></tr>
        <tr><td>14</td></tr>
        <tr><td>15</td></tr>
        <tr><td>16</td></tr>
        <tr><td>10</td></tr>
        <tr><td>11</td></tr>
        <tr><td>12</td></tr>
        <tr><td>13</td></tr>
        <tr><td>14</td></tr>
        <tr><td>15</td></tr>
        <tr><td>16</td></tr>
        <tr><td>10</td></tr>
        <tr><td>11</td></tr>
        <tr><td>12</td></tr>
        <tr><td>13</td></tr>
        <tr><td>14</td></tr>
        <tr><td>15</td></tr>
        <tr><td>16</td></tr>
        <tr><td>10</td></tr>
        <tr><td>11</td></tr>
        <tr><td>12</td></tr>
        <tr><td>13</td></tr>
        <tr><td>14</td></tr>
        <tr><td>15</td></tr>
        <tr><td>16</td></tr>
        <tr><td>10</td></tr>
        <tr><td>11</td></tr>
        <tr><td>12</td></tr>
        <tr><td>13</td></tr>
        <tr><td>14</td></tr>
        <tr><td>15</td></tr>
        <tr><td>16</td></tr>
        <tr><td>10</td></tr>
        <tr><td>11</td></tr>
        <tr><td>12</td></tr>
        <tr><td>13</td></tr>
        <tr><td>14</td></tr>
        <tr><td>15</td></tr>
        <tr><td>16</td></tr>
        </table>
    </td>
    <td valign="top"><canvas id="x"></canvas></td>
</tr>
</table> 
```

CSS：

```
body {
    margin: 30px;
}

.t2 {
    border-collapse: collapse;
    border-spacing: 0;
}

.t2 td {
     padding: 5px;
     text-align: center;
}

canvas {
    border: 1px dashed green;
} 
```

JS：

```
var canvasWidth = $(".t2").outerWidth()*3;
var canvasHeight = $(".t2").outerHeight();
var c = document.getElementById("x");
var c2 = c.getContext("2d");

c.width = canvasWidth;
c.height = canvasHeight;

$('.t2 td:odd').each(function() {

    var cur = $(this);
    var topOffset = 0;
    var shouldCount = true;
    var h = $(this).outerHeight();

    $('.t2 td').each(function() {    
        if (shouldCount) {
            topOffset += h;

            if (cur.is(this)) {
                topOffset -= h;
                shouldCount = false;
            }
        }
    });

    c2.fillStyle = '#f00';
    c2.beginPath();
    c2.moveTo(0, topOffset);
    c2.lineTo(25, topOffset);
    c2.lineTo(25, topOffset+h);
    c2.lineTo(0, topOffset+h);
    c2.closePath();
    c2.fill();
}); 
```

[http://jsfiddle.net/KaDnQ/1/](http://jsfiddle.net/KaDnQ/1/)

这是它在 Chrome 中的样子（正确）： ![在 Chrome 中正确渲染：并排](../Images/a2477555a34d669b411eb818496eb7f2.png)

问题是**Firefox**中的下部框从它们的“父母” tds 中抵消了。 ![下框偏移](../Images/ef6d4a779315c379f0b895c2ca819edf.png)

**Firefox 渲染错误的原因是什么以及如何解决？**

* * *

**更新： FF 19 (mac)**和**IE 9 (win)**出现错误渲染！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T17:55:56.803

花了很多时间研究和调试，我准备回答我自己的问题：

问题是“容器高度并不总是等于里面所有元素的总和”。发现，这是因为“ **line-height** ”属性。

此处描述了类似的问题： [设置 CSS 属性 line-height 时的高度计算不正确](https://stackoverflow.com/questions/4136264/incorrect-height-calculation-when-css-property-line-height-is-set)

这是一个稍加修改的工作解决方案（经过 Chrome 和 FF 测试）：http: [//jsfiddle.net/BgYpw/3/](http://jsfiddle.net/BgYpw/3/)

如何解决的想法：将容器内所有元素的高度/外部高度相加，并将该值应用于 canvas.height。

在上面的示例中，它是这样简单地完成的：

```
c.height = $('#le div').length * $('#le div:first').outerHeight(); 
```

内部所有元素的计数乘以 first 的 outerHeight。如果内部元素的高度可能不同，则该解决方案不适用。在这种情况下，您可以通过执行**$.each**循环并特别是对高度求和来获得高度......

希望我的回复能为某人节省几个小时:)

# rest - 如何为基于休息的服务生成 xml 和 json？

> ID：15283776
> 
> 赞同：0
> 
> 时间：2013-03-07T23:18:21.950
> 
> 标签：rest

我正在尝试从我的休息服务中生成 xml 和 json。

```
 @Produces({"application/xml", "application/json"}) 
```

但是，当我尝试使用 curl/SOAPUI 使用该服务时，我会返回 xml 或 json，具体取决于首先提到的是哪个。简单来说，只考虑第一种方法。有解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T22:09:54.730

您应该检查此链接 - [@Produces 的 oracle 文档](http://docs.oracle.com/cd/E19776-01/820-4867/ghrns/)

规范说，如果请求中的媒体类型指定可以接受，它确实默认为第一个。您应该检查您的soapUI 工具并查看您发送的标头。如果它们都被发送，您将收到 @Produces 注释中列出的第一个响应。

# perl - 如何设置$！在 perl 中

> ID：15283782
> 
> 赞同：3
> 
> 时间：2013-03-07T23:18:54.463
> 
> 标签：perl

我想用 perl 写一些函数来设置 $! 以类似于内置 perl 函数的方式。当我尝试这样做时，它抱怨“参数“无法创建管理员用户”在标量赋值中不是数字”。我试过用谷歌搜索，但不幸的是谷歌不会在 $ 上观看！所以很难得到结果。

```
if(!createUser('admin')) { print $!; }

sub createUser
{
  my ($user) = @_;
  if($user eq "admin")
  {
    $! = "Cannot create admin user";
    return 0;
  }
  #create user here
  return 1;
} 
```

PS。我知道 Try::Tiny 等，但我想与脚本的其余部分保持一致，如果我切换到 try/catch，我想移动我还没有准备好的整个脚本。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-07T23:24:30.587

`$!`是一个魔法变量，对应于操作系统的数字错误代码（`errno`在 Unix-y`libc`库中，`GetLastError()`在`kernel32.dll`Windows 中类似）。

您只能将其设置为一个数字。当 Perl 想在字符串上下文中使用它时，它会将其转换为适当的文本错误消息。

例子：

```
$! = 4;
print $!, "\n";
print 0+$!, "\n"; 
```

产生（无论如何在我的系统上）：

```
Interrupted system call
4 
```

`$!`设置为与系统上的某些标准错误相对应是完全合适的（如果不可移植，因为不同的系统可以自由使用不同的整数值来表示标准错误代码） ：

```
sub my_do_something_with_file {
    my $file = shift;
    if (! -f $file) {
        $! = 2; # "No such file or directory" on my system
        return;
    }
    ...
} 
```

但是没有工具可以创建您自己的自定义错误消息以与`$!`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T23:22:34.897

如[perlvar](http://perldoc.perl.org/perlvar.html)中所述，`$!`包含一个 C `errno`，它是一个数字。文本的 Perl 级别错误消息出现在 中`$@`，*通常*由 设置`die`。我*不*建议手动设置它，尤其是因为它是一个全局转包。

`Try::Tiny`如果那是你需要的，就使用它。如果脚本的其余部分写得不好，那么与它保持一致不会有太多收获。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T23:40:15.640

你可以设置$！到恰好匹配 C errno 值并设置预期字符串值的数值。不幸的是，这不是很便携。

如果 $! 不是一个神奇的变量，您可以使用 dualvar() 分配一个双重数字/字符串值，这在 Scalar::Util 中可用，它是一个核心包。

```
使用 Scalar::Util qw(dualvar) ;
我的 $x = dualvar( 44, "Hello, world" );
打印 "string=$x, number=" 。(0+$x), "\n"
```

但是用美元！只有这个数字在我之前的尝试中幸存下来。

# c# - 绑定属性不起作用

> ID：15283789
> 
> 赞同：1
> 
> 时间：2013-03-07T23:19:33.970
> 
> 标签：c#, .net, silverlight, xaml

好吧，标题可能没有多大帮助，但这是我的问题。我在 SILVERLIGHT 中的控件之间绑定属性时遇到问题。这是结构：

1.  有一个名为“ProjectItemList”的控件，该控件将接收一个字符串并以非常简单的方式显示它。
2.  有一个名为“ProjectList”的控件，该控件将接收一个字符串数组，并使用控件“ProjectItemList”来表示数组中的每个字符串。
3.  有一个名为“ProjectWindow”的窗口，该窗口包含一个“ProjectList”控件和一个名为“Nombres”的依赖属性。

上下文：“ProjectWindow”窗口包含一个“ProjectList”控件，ProjectWindow的依赖属性“Nombres”和依赖属性“ListOfNames”之间有一个绑定，这里是“ListOfNames”依赖属性的代码：

```
public static DependencyProperty ListOfNamesProperty =
        DependencyProperty.Register("ListOfNames", typeof(string[]), typeof(ProjectList), new PropertyMetadata(null));
public string[] ListOfNames
{
   get
   {
      return (string[])GetValue(ListOfNamesProperty);
   }

   set
   {
      SetValue(ListOfNamesProperty, value);
      List<ProjectItemList> auxList = new List<ProjectItemList>();
      foreach (string s in value)
      {
         ProjectItemList il = new ProjectItemList();
         il.Nombre = s;
         this.lb_projects.Items.Add(il);
      }
    }
 } 
```

问题是，虽然“ProjectList”中的列表控件代表“Nombres”属性，但从未调用“ListOfNames”的“Set”，所以我无法创建每个“ProjectItemList”对象并表示数据。

我对 XAML 和 Silverlight 还很陌生，所以我可能不会考虑一些简单的事情。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:25:58.907

当您使用依赖属性时，set 和 get 不会通过 ui 绑定调用，这是您的问题。WPF ui 控件直接使用dependeny 属性，无需通过您的getter 和setter。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:39:47.670

您需要指定回调来监控属性更改：

```
public static DependencyProperty ListOfNamesProperty =
    DependencyProperty.Register("ListOfNames", typeof(string[]), typeof(ProjectList),
    new PropertyMetadata(ListOfNamesChaned));

private static void ListOfNamesChaned(DependencyObject d, DependencyPropertyChangedEventArgs e)
{
    List<ProjectItemList> auxList = new List<ProjectItemList>();
    foreach (string s in value)
    {
        ProjectItemList il = new ProjectItemList();
        il.Nombre = s;
        this.lb_projects.Items.Add(il);
    }
}

public string[] ListOfNames
{
    get
    {
        return (string[])GetValue(ListOfNamesProperty);
    }

    set
    {
        SetValue(ListOfNamesProperty, value);
    }
} 
```

请参阅**Chen Kinnrot**的回答以了解原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-26T08:32:43.983

为此，可以使用 Raise Property Change 事件，即与 propertychanged 事件处理程序一起使用，代码片段如下：

```
 public event PropertyChangedEventHandler PropertyChanged;
    private void OnPropertyChanged(string propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    } 
```

使用 OnPropertyChanged 绑定属性，如果该属性有任何更改。它将通知您的绑定属性将自动更改，并且将更新绑定到这些属性的 ui。

# variables - pygame - python 使用访问者模式获取变量

> ID：15283795
> 
> 赞同：0
> 
> 时间：2013-03-07T23:19:49.657
> 
> 标签：variables, methods, pygame, visitor-pattern

我正在尝试使用访问者模式从第一类获取 self.coin 值并将其返回给第二类中的方法，但它不起作用，它总是不返回任何内容......有人可以帮忙吗？

```
class coin_collector(Observer):
    def __init__(self):
        super(Observer, self).__init__()
        self.coin_count = 0
        self.run = True
        self.coin = 0

    def acceptVisitor(self, visitor):
        visitor.visit(self)

    def update(self, observable, other):
        me = coin_collector()
        me.coin_Count(other, True)

    def coin_Count(self, value, TF):
        run = TF
        if run:
            self.coin = value
            print self.coin
        return self.coin

    def __str__(self):
        return self.__class__.__name__

#this is part of a different class in a different file 
    def visit(self, location):
        location.coin_Count(0, False)

    def update(self):
        visitee = coin_collector()
        self.c_Count = self.visit(visitee) # for some reason this always returns none
        print self.c_Count, "working" # this always prints none... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T20:45:02.543

好的，让我们从`Coin Collector`. 他的`coin`属性设置为 0。您还有第二个带有`update`and`visit`函数的类。

update 函数在每次调用时创建一个**新函数。** `coin_collector`然后它将`visit`函数的返回值分配给`self.c_Count`。现在让我们看看这个`visit`函数。

它接受一个全新的`coin collector`并返回**None**`coin`如果您传递`True`as ，它会将其 value 参数分配给该字段`TF`。

从`coin_count`函数返回后，您不会在`visit`函数中执行任何操作，因此返回值会丢失。这就是为什么当您尝试分配 的结果时`self.visit`，您会得到一个`None`.

# jquery - 启动彩盒，在加载前取消，启动第二个不同的彩盒，都在同一个窗口中加载

> ID：15283796
> 
> 赞同：0
> 
> 时间：2013-03-07T23:19:54.430
> 
> 标签：jquery, colorbox

一段时间以来，我一直在用头撞墙。

我在一个页面上有多个颜色框链接。当我单击一个时，colorbox 启动，并触发一个 ajax 请求，该请求恰好需要 10 秒左右才能返回。如果我单击第一个颜色框，然后单击第二个颜色框链接，则两个页面都加载到第二个颜色框窗口中，彼此堆叠在一起。

有没有办法可以中止第一个 colorbox ajax 请求，或者至少阻止它在第二个窗口中加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:02:53.573

colorbox 的作者在这里。没有办法取消 ajax 请求，但今天晚些时候我会考虑让 colorbox 忽略结果。

*更新：自 v.1.4.4 起已修复

# c - 无法打印结构变量

> ID：15283797
> 
> 赞同：0
> 
> 时间：2013-03-07T23:20:03.227
> 
> 标签：c, struct, printf

```
#include <stdio.h>
#include <stdlib.h>

typedef struct {
    char name[20];
    int age;
} employee;

int main(int argc, char** argv)
{
    struct employee em1 = {"Jack", 19};
    printf("%s", em1.name);
    return 0;
} 
```

这似乎不起作用，因为正如编译器所说，该变量的“struct employee”类型不完整。怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T23:21:46.800

从中删除结构

```
 struct employee em1 = {"Jack", 19}; 
```

你用过

```
typedef struct
{
char name[20];
int age;
} 
```

目的是不再需要输入 struct 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-07T23:21:58.243

问题是您创建了结构 a `typedef`，但仍然使用`struct`.

这将起作用：

```
 employee em1 = {"Jack", 19}; 
```

或删除`typedef`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:28:25.487

要使用`struct employee em1 = ...`，您需要使用标签声明结构。

```
struct employee /* this is the struct tag */
{
char name[20];
int age;
} em1, em2; /* declare instances */
struct employee em3; 
```

`typedef`创建一个您在没有`struct`关键字的情况下使用的类型别名。

```
typedef struct employee employee;
employee em4; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-02T08:42:10.287

由于您已经对结构进行了 typedef，因此无需再次添加 struct 关键字。

```
typedef struct Employee{
    char name[20];
    int age;
} employee;

int main(int argc, char** argv)
{
    employee em1 = {"Jack", 19};
    printf("%s", em1.name);
    return 0;
} 
```

# file-upload - 将多个文件上传到 cocoon

> ID：15283800
> 
> 赞同：1
> 
> 时间：2013-03-07T23:20:23.057
> 
> 标签：file-upload, apache-cocoon

我很乐意看到 cocoon 处理用户上传的多个文件。我的表格类似于

```
<input name="file" type="file" multiple /> 
```

对于单个文件（没有多个 attr），这似乎很容易。调用`cocoon.request.get("file")`流程脚本显然会返回实例，`org.apache.cocoon.servlet.multipart.Part`所以我想我错过了一些明显的东西？

# python - 文本文件创建问题，在未真正 EOL 时创建新行

> ID：15283801
> 
> 赞同：0
> 
> 时间：2013-03-07T23:20:24.897
> 
> 标签：python, xml, regex, csv, cygwin

我正在将我在 python 中创建的一组文件（将元数据/xml 记录转换为文本）中的一些文本数据导入到 excel 中。除了在文本只是在段落中的点处插入新行之外，它大部分工作正常。这是文件创建过程中的一个问题。

是否可以自动清理数据以将数据保留在同一行中，直到遇到转义/新字符？

由于该站点不允许附件，因此我[在此处附上了示例。](http://www.excelforum.com/excel-programming-vba-macros/905025-import-txt-to-table-issue-with-new-lines-created-when-not-eol.html?p=3148886#post3148886)

1.  anz*_log.txt -- 我使用“^”作为分隔符的原始文本文件。如果excel可以使用它仅在存在时创建新行，我可以强制它在每个已知行的末尾添加另一个字符。
2.  anz*_xml.xls Excel 导入 - 工作表 (*log) 原始导入数据）并清理了我使用公式正确获取值的位置。
3.  rowChar_anz*log.txt - 原始文本文件，每行开头带有 ':;:' 以表明它应该是一个新行（与 1 相同，但行有额外的分隔符）

这只是在测试数据集上，我需要在 1000 个文件上运行它。请参阅第 9、13、54 行等中的问题。

我可以使用 python（或者如果需要 cygwing/SED）来

1.  查找“行首”字符串 - ':;:' 和“行尾”字符串 ';:;'
2.  如果两者都不存在于一行中，则将行附加到上一行

或者（理想情况下）可以在使用以下代码创建文件时完成此操作吗？也许使用 re.compile （如[查询 CSV 并将原始 CSV 和结果写入单个 CSV Python](https://stackoverflow.com/questions/14863627/query-csv-and-write-original-csv-and-results-to-single-csv-python)）？

```
#-------------------------------------------------------------------------------
# Name:        Convert xml data to csv with anzlic tagged data kept seperate
# Purpose:  Also has an excel template to convert the data into standard columns
#
# Author:      georgec@atgis.com.au
#
# Created:     05/03/2013
# Copyright:   (c) ATGIS. georgec 2013
# Licence:     Creative Commons
#-------------------------------------------------------------------------------

import os, xml, shutil, datetime
from xml.etree import ElementTree as et

SourceDIR=r'L:\Vector_Data'
rootDir=os.getcwd()
log_name='vector'
x=0

def locatexml(SourceDIR,x, rootDir):
    xmllist=[]
    for root, dirs, files in os.walk(SourceDIR, topdown=False):
        for fl in files:
            currentFile=os.path.join(root, fl)
            ext=fl[fl.rfind('.')+1:]
            if ext=='xml':
                xmllist.append(currentFile)
                print currentFile
                x+=1
                try:
                    processxml(currentFile,x, rootDir)
                except:
                    print "Issue with file: "+ currentFile
                    log=open(rootDir+'\\'+log_name+'issue_xml_log.txt','a')
                    log.write(str(x)+'^'+currentFile+'\n')
                    log.close

    print "finished"
    return xmllist, x, currentFile

def processxml(currentFile,x, rootDir):
    from lxml import etree
    seperator='^'
    with open(currentFile) as f:
        tree = etree.parse(f)
    xmltaglist=[]
    for tagn in tree.iter(tag=None):
        #print tagn.tag
        xmltaglist.append(tagn.tag)
    if 'anzmeta' in str(tree.getroot()):
        log=open(rootDir+'\\'+log_name+'anzmeta_xml_log.txt','a')
        log.write(':;:'+seperator+str(x)+seperator+currentFile+seperator)
        for xmltag in xmltaglist:
            for element in tree.iter(xmltag):
                #print element[x]
                for child in element.getchildren():
                    print "{0.tag}: {0.text}".format(child)
                    log.write("{0.tag}".format(child)+"::"+"{0.text}".format(child)+seperator)
        log.write('\n')
        log.close
    else:
        print currentFile+" not an anzlic metadata file...logging seperately"
        log=open(rootDir+'\\'+log_name+'non_anzmeta_xml_log.txt','a')
        log.write(':;:'+seperator+str(x)+seperator+currentFile+seperator)
        for xmltag in xmltaglist:
            for element in tree.iter(xmltag):
                #print element[x]
                for child in element.getchildren():
                    print "{0.tag}: {0.text}".format(child)
                    log.write("{0.tag}".format(child)+"::"+"{0.text}".format(child)+seperator)
        log.write('\n')
        log.close

locatexml(SourceDIR,x, rootDir) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:53:49.167

找到答案....只需将 .replace('\n','') 添加到写入每个条目的命令中。几个小时前就应该想到这个！！！

# python - 从文件中读取矩阵，制作边缘列表，并将边缘列表写入文件

> ID：15283803
> 
> 赞同：2
> 
> 时间：2013-03-07T23:20:34.350
> 
> 标签：python, networkx

这应该很简单，但我无法弄清楚。我只需要

*   将文件中的矩阵读入 Python（该矩阵没有标题/行名）
*   将其转换为边缘列表
*   将边缘列表写入文件

我可以分别做这些，但我不知道如何从导入的矩阵到 networkx 模块中的图形对象。如果我能够转换为 networkx 图，那么我可以制作一个边缘列表并写入文件。

要读取的矩阵示例（保存在 .txt 文件中）

```
1 0 1 0 1
1 0 1 0 0
1 0 1 0 1
0 0 1 0 0
1 1 1 1 0
1 1 1 0 1
1 0 1 0 0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T05:17:09.913

这使用 numpy 读取矩阵并将邻接数据转换为边列表。然后它创建一个networkx Graph，并绘制一个图。

```
import numpy as np
import networkx as nx
import matplotlib.pyplot as plt

# Load the adjacency matrix into a numpy array.
a = np.loadtxt('matrix.txt', dtype=int)

print "a:"
print a

num_nodes = a.shape[0] + a.shape[1]

# Get the row and column coordinates where the array is 1.
rows, cols = np.where(a == 1)

# We label the nodes corresponding to the rows with integers from 0 to
# a.shape[0]-1, and we label the nodes corresponding to the columns with
# integers from a.shape[0] to a.shape[0] + a.shape[1] - 1.
# Rearranges the list of rows and columns into a list of edge tuples.
edges = zip(rows.tolist(), (cols + a.shape[0]).tolist())
print "U nodes:", np.arange(a.shape[0])
print "V nodes:", np.arange(a.shape[1]) + a.shape[0]
print "edges"
print edges

# Create a Graph object (from the networkx library).
b = nx.Graph()
b.add_nodes_from(range(num_nodes))  # This line not strictly necessry.
b.add_edges_from(edges)

# Draw the graph.  First create positions for each node. Put the U nodes
# on the left (x=1) and the V nodes on the right (x=2).
pos = dict([(k, (1, k - 0.5 * a.shape[0]))
            for k in range(a.shape[0])])
pos.update(dict([(k + a.shape[0], (2, k - 0.5 * a.shape[1]))
                  for k in range(a.shape[1])]))
nx.draw_networkx(b, pos=pos, node_color=(['c'] * a.shape[0]) + (['y'] * a.shape[1]))

plt.axis('off')
plt.show() 
```

输出：

```
a:
[[1 0 1 0 1]
 [1 0 1 0 0]
 [1 0 1 0 1]
 [0 0 1 0 0]
 [1 1 1 1 0]
 [1 1 1 0 1]
 [1 0 1 0 0]]
U nodes: [0 1 2 3 4 5 6]
V nodes: [ 7  8  9 10 11]
edges:
[(0, 7), (0, 9), (0, 11), (1, 7), (1, 9), (2, 7), (2, 9), (2, 11), (3, 9), (4, 7), (4, 8), (4, 9), (4, 10), (5, 7), (5, 8), (5, 9), (5, 11), (6, 7), (6, 9)] 
```

剧情： ![二分图](../Images/6e9118f0e749f0fc3bb4c642709bf6bb.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T04:52:01.823

您不需要 NetworkX 转换为简单的边缘列表：

```
adj = """1 0 1 0 1
1 0 1 0 0
1 0 1 0 1
0 0 1 0 0
1 1 1 1 0
1 1 1 0 1
1 0 1 0 0"""

for row,line in enumerate(adj.split('\n')):
    for col,val in enumerate(line.split(' ')):
        if val == '1':
            print row,col 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-11T03:17:42.353

```
import numpy as np

#read matrix without head.
a = np.loadtxt('admatrix.txt', delimiter=',', dtype=int)  #set the delimiter as you need
print "a:"
print a
print 'shape:',a.shape[0] ,"*", a.shape[1]

num_nodes = a.shape[0] + a.shape[1]

num_edge = 0
edgeSet = set()

for row in range(a.shape[0]):
    for column in range(a.shape[1]):
        if a.item(row,column) == 1 and (column,row) not in edgeSet: #get rid of repeat edge
            num_edge += 1
            edgeSet.add((row,column))

print '\nnum_edge:', num_edge
print 'edge Set:', edgeSet
print ''
for edge in edgeSet:
    print edge[0] , edge[1] 
```

此代码将读取以逗号分隔的邻接矩阵文件，并打印输出边缘列表。

例如，adj-matrix.txt 是：

```
0, 1, 0, 1
1, 0, 1, 0
0, 1, 0, 0
1, 0, 0, 0 
```

edgelist 的输出将是：

```
0 1
0 3
1 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T23:55:37.990

1.  对于读取文件，你需要 python`fp = open('\path\to\filename.txt')`

    [docs.python.org](http://docs.python.org/2/index.html)提供了如何执行此操作[的大量信息](http://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files)，并且通常是您第一次学习时搜索答案的好地方。

2.  您可能会查看边缘列表的[networkx](http://networkx.github.com/)包。他们有如何做到这一点的[例子。](http://networkx.github.com/examples.html)如果你已经安装了 setuptools，你可以用`easy_install networkx`

# c# - 如何写入csv中的单独列

> ID：15283810
> 
> 赞同：0
> 
> 时间：2013-03-07T23:20:51.730
> 
> 标签：c#, asp.net, csv, visual-studio-2012

我有一个 html 表，我正在尝试将其写入 csv 文件。我的数组中的行由 \n 分隔，当我将其打印到 csv 文件时，一切正常，除了我遇到的一个问题。我希望每个逗号值都打印在下一列中。不幸的是，它没有这样做。我当前的代码将 html 表中每一行的所有值写入 csv 中的正确行。

```
try
        {
            string filepath = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);

            StreamWriter sw = new StreamWriter(Environment.GetFolderPath(Environment.SpecialFolder.Desktop) + "\\spreadsheet.csv", true);

            foreach (var i in valueArray)
            {
                if (i.ToString() == "\n")
                {
                    sw.Write("\n");
                }
                else
                {
                    {
                        sw.Write(i.ToString());
                        sw.Write("\t");//my failed attempt
                    }
                }
            }
            sw.Flush();
            sw.Close();

            saveOK = true;
        } 
```

数组中的值看起来像："first,second,third,fourth,fith,last,\n, first, ....,last,\n,"

在 csv 中它显示为：

```
 column 1                            column 2
row1 :firstsecondthirdfourthfithlast
row2 :firstsecond.......        last 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:28:26.090

```
foreach (var i in valueArray)
{
   if (i.ToString() == "\n")
   {
      sw.Write(sw.NewLine);
   }
   else
   {
      sw.Write(i.ToString() + ",");
   }
} 
```

# objective-c - 增加一个 NSNumber

> ID：15283814
> 
> 赞同：0
> 
> 时间：2013-03-07T23:21:03.213
> 
> 标签：objective-c, cocoa, math, increment, nsnumber

这里是 obj-C 和 Cocoa 的新手

我试图在方法中增加一个变量，并且习惯于 C++，我只想使用变量 ++ 的术语，但这不适用于 NSNumber，所以我想出了

> player1Points = [NSNumber numberWithInt: ([ player1Points intValue ] + 1) ];

我很想在标题中将 player1Points 重新声明为 int，但我想保留 @synthesize 和 @property，这样我就不必编写 get 和 set 例程。

有没有更简单的方法来编写这行代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T23:23:31.803

您仍然可以将其声明为 NSInteger，属性也可以是原始类型：

```
@property (nonatomic,assign) NSInteger player1Points; 
```

你仍然可以合成它。

或者，有一种新语法可以使 NSNumber 的使用更加舒适：

```
player1Points = @(player1Points.integerValue+1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:24:29.650

您可以使用原语作为属性，如下所示：

```
@property (nonatomic, assign) int player1Points; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:30:25.813

同意所有答案，另一种选择（尽管可能过度编码）是`NSNumber`使用称为增加（或其他）的实例方法创建一个类别。所以你可以`[player1Points increase];`在你的应用程序的任何地方拥有类似的东西。

# image - 具有手风琴效果的图像

> ID：15283816
> 
> 赞同：2
> 
> 时间：2013-03-07T23:21:19.777
> 
> 标签：image, matlab, transformation, stretch

我已将图像文件读入 MATLAB，我试图将其拉伸到一个方向，但数量可变（正弦曲线）。这会在图像上产生手风琴效果。我玩弄了imresize，但是它只会线性调整图像的大小。我希望每个图像行的“拉伸”量有所不同。我试图用以下代码传达这一点：

```
periods = 10; % Number of "stretch" cycles
sz = size(original_image,2)/periods;
s = 0;
x = 0;
for index = 1:periods
    B = original_image(:,round(s+1:s+sz));
    if mod(index,2) == 0
        amp = 1.5;
    else
        amp = 0.75;
    end
    xi = size(B,2)*amp;
    new_image(:,x+1:x+xi) = imresize(B, [size(B,1) size(B,2)*amp]);
    s = s + sz;
    x = x+xi;
end 
```

您可以看到图像的各个部分被拉伸、压缩、拉伸等等，就像手风琴一样。但是，每个部分都有一个统一的拉伸量，而我希望它随着您沿着图像移动而增加然后减少。

我还查看了 MATLAB 的[将正弦变换应用于棋盘](http://www.mathworks.com/help/images/examples/creating-a-gallery-of-transformed-images.html)的示例，这似乎非常适用于我的问题，但是我一直在尝试，但我无法让它为我的图像产生所需的结果。任何帮助深表感谢。

* * *

更新：

谢谢你的答案#1。我无法让它为我工作，但也意识到它会导致数据丢失，因为代码只要求原始图像中的某些行，而其他行将被忽略。

在进一步实验之后，我开发了下面的代码。我以棋盘格为例。虽然很整洁，但它确实完成了工作。但是，在使用实际的高分辨率图像尝试脚本时，它非常慢，最终由于内存不足而失败。我相信这是因为循环中使用了过多的“imresize”命令。

```
I = checkerboard(10,50);
I = imrotate(I,90);
[X Y] = size(I);
k = 4; % Number of "cycles"
k = k*2;
x = 1;
y = 2;
z = 2;
F = [];
i = 1;
t = 0;
s = 0;

for j = 1:k/2
    t = t + 1;
    for inc = round(s+1):round(Y/k*t)
        Yi = i + 1;
        F(:,(x:y)) = imresize(I(:,(inc:inc)),[X Yi]);
        x = y + 1;
        y = x + z;
        z = z + 1;
        i = i + 1;
    end
    y = y - 2;
    z = z - 4;
    for inc = round(Y/k*t+1):round(Y/k*(t+1))
        Yi = i - 1;
        F(:,(x:y)) = imresize(I(:,(inc:inc)),[X Yi]);
        x = y + 1;
        y = x + z;
        z = z - 1;
        i = i - 1;
    end
    y = y + 2;
    z = z + 4;

    s = Y/k*(t+1);
    t = t + 1;
end
Fn = imresize(F, [X Y]);
imshow(Fn); 
```

有谁知道实现这一目标的更简单方法？如果你运行上面的代码，你可以看到我想要达到的效果。不幸的是，我上面的方法也不允许我调整“拉伸”的幅度，只能调整“周期”的数量或频率。对此的帮助也将不胜感激。非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T02:39:17.007

这是我将如何处理它：

1.  确定最终图像 F 中每个点的坐标如何映射到大小为 (M,N) 的初始图像 I

    由于您只想水平拉伸，给定最终图像中的一个点 (xF,yF)，该点将是初始图像中的 (xI,yI)，其中 xI 和 yI 可以按如下方式获得：

    yI = yF;
    xI = xF + L *sin(xF* K);

    笔记：

    *   这些方程不能保证 xI 保持在 [1:N] 范围内，因此需要添加裁剪
    *   K 控制您想要在手风琴效果中产生多少皱纹。例如，如果你只想要一个皱纹，K 将是 2*pi/N
    *   L 控制要应用多少拉伸
2.  然后简单地用你在 1 中的变换从图像 I 中表达你的图像 F。

综上所述，下面的代码创建了一个示例图像 I 并生成图像 F，如下所示：

```
 % Generate a sample input image
  N=500;
  xF=1:N;
  I=(1:4)'*xF/N*50;

  % Set the parameters for your accordion transform
  K=2*pi/N;
  L=100;

  % Apply the transform
  F=I(:, round(min(N*ones(1,N), max(ones(1,N), (xF + L*sin(xF*K))))) );

  % Display the input and output images side by side
  image(I);
  figure;
  image(F); 
```

如果你运行这个确切的代码，你会得到：

![在此处输入图像描述](../Images/ef89ad171e8975f2a64ac40529be3cf3.png)

如您所见，右侧的最终图像拉伸了左侧图像的中心部分，为您提供了带有皱纹的手风琴效果。

您可以摆弄 K 和 L 并调整公式以获得您想要的确切效果，但请注意通过以矩阵形式表示变换，MATLAB 如何在几分之一秒内执行代码。如果你有一个收获，那就是你应该尽可能远离 for 循环和复杂的处理。

玩得开心！

# unity3d - 为什么 unity3d 应用程序很大？

> ID：15283818
> 
> 赞同：4
> 
> 时间：2013-03-07T23:21:23.867
> 
> 标签：unity3d

我刚刚在 unity3D 基本版上制作了一个非常基本的 3D 应用程序。它有一个平面、3 个立方体和 1 个 FPC。构建的文件大约为 10mb。为什么文件这么大？是否可以减小尺寸？我打算为 android 制作应用程序，因此我需要知道如何保持文件大小最小。

# python - Python 文档中的错误？

> ID：15283821
> 
> 赞同：9
> 
> 时间：2013-03-07T23:21:29.767
> 
> 标签：python, import, module

我正在阅读[http://docs.python.org/2/tutorial/modules.html#more-on-modules](http://docs.python.org/2/tutorial/modules.html#more-on-modules)并想知道以下内容是否正确：

> 模块可以导入其他模块。将所有导入语句放在模块（或脚本，就此而言）的开头是习惯但不是必需的。**导入的模块名称放置在导入模块的全局符号表中。**

显然不是：

```
>>> def foo(): import sys
... 
>>> foo()
>>> sys.path
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'sys' is not defined 
```

有关在线演示，请参见[http://ideone.com/cLK09v 。](http://ideone.com/cLK09v)

那么，这是 Python 文档中的错误还是我不明白？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-07T23:25:32.057

是的，这是一个文档错误。该`import`语句将名称导入*当前*命名空间。通常`import`在函数和类之外使用，但正如您所发现的，它确实在它们内部工作。在您的示例函数中，模块在调用函数时被导入函数的本地命名空间。（您没有这样做，但这不会使其在函数之外可用。）

但是，该`global`关键字在这里有效：

```
def foo():
    global sys
    import sys

foo()
sys.path 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:40:01.520

我不认为这实际上是文档中的错误，而是更多的误解。你只是有一个范围问题。您正在将它导入函数 foo() 的范围内。您当然可以按照文档的建议进行操作，并将导入放在文件底部或文件中仍与您的模块具有相同全局范围的其他位置。问题是“导入的模块名称放置在导入模块的全局符号表中”，您要导入的模块的范围包含在函数 foo() 中，而不是模块的全局级别。

# javascript - 如何通过 javascript 访问 processing.js 变量

> ID：15283831
> 
> 赞同：1
> 
> 时间：2013-03-07T23:22:01.747
> 
> 标签：javascript, variables, processing.js

我正在尝试使用 javascript 更改处理变量。

HTML：

```
<canvas id="Processing_test" data-processing-sources="test06-controller.pde">
</canvas> 
```

加工：

```
float posX = 500;

void setup() {
  size(600,600);
  background(100);
  ellipseMode(CENTER);
}
void draw() {
  background(100);
  fill(200);
  ellipse(posX,300,260,260);
} 
```

Javascript：

```
var p = Processing.getInstanceById('Processing_test');
alert(p.posX); 
```

问题是没有出现警报。如果我写

```
alert(p); 
```

它显示：未定义。我知道我可以使用我在 Javascript 中声明的全局变量，但我想反过来访问它。那可能吗？

（警报只是一个测试，这不是我最终想要做的；））

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T14:50:36.887

现在，Processing.js 在你的草图上唯一暴露的是函数，所以你可以编写一个 getter/setter：

```
float getPosX() { return posX; }
void setPosX(float v) { posX = v; } 
```

现在您可以随心所欲地获取和设置变量。

但是，通常，如果您想基于草图在 JavaScript 中执行操作，则让草图调用 JS 函数更有意义。例如，如果`posX`需要在页面上的某个地方更新，您的草图可以调用

```
javascript.xPosUpdated(posX); 
```

（假设您在草图启动时绑定了 javascript）。这样 JS 就不需要“进入”你的草图，你只需将它需要的所有信息交给它来执行你想要的更新。

# ios - 查看顶部景观支持

> ID：15283840
> 
> 赞同：0
> 
> 时间：2013-03-07T23:23:06.580
> 
> 标签：ios, objective-c, uiview

我正在使用以下代码创建一个视图并将其放在顶部：

```
UIWindow* mainWindow = [[UIApplication sharedApplication] keyWindow];
CGRect viewRect = mainWindow.frame;
topView = [[UIView alloc] initWithFrame:viewRect];
[topView setBackgroundColor:[UIColor colorWithWhite:0.2 alpha:0.4]];
[mainWindow addSubview:topView]; 
```

它工作得很好，但我的问题是如果我在视图中写任何东西（比如使用标签）并且我的设备处于横向位置，文本处于垂直位置。我附上了一张图片，以使其更清楚。有什么办法可以解决吗？![在此处输入图像描述](../Images/b05a62fe5a72084cc3e13f8f1ebbb678.png)

编辑：如果我使用 UIApplication.sharedApplication.keyWindow.rootViewController 而不是 mainWindow，我会得到这个：

![在此处输入图像描述](../Images/d1f58b10afb521f89efd1f5c51d2ddae.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:25:34.517

如果不将给定的视图添加到视图控制器，就无法修复它（`UIWindow`从来没有打算处理旋转，并且没有这样做的逻辑）。

您遇到的不稳定的视图旋转结果实际上是 UIView 的 default 的`autoresizingMask`结果

```
topView = [[UIView alloc] initWithFrame:viewRect];
[topView setBackgroundColor:[UIColor colorWithWhite:0.2 alpha:0.4]];
[topViewsetAutoresizingMask:(UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth)]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:26:13.753

看到这个答案：

[查看所有内容：UIWindow 子视图 VS UIViewController 子视图](https://stackoverflow.com/questions/8774495/view-on-top-of-everything-uiwindow-subview-vs-uiviewcontroller-subview)

基本上，只有主窗口的第一个子视图获得旋转事件，所以你必须以其他方式来做。

# sql-server - INNER/RIGHT/LEFT JOIN 怎么会比 FULL JOIN 慢 14 倍？

> ID：15283841
> 
> 赞同：5
> 
> 时间：2013-03-07T23:23:11.413
> 
> 标签：sql-server, sql-server-2012

我有一个查询，使用 FULL JOIN 需要 2.5 秒，使用 INNER、RIGHT 或 LEFT JOIN 需要 40 秒。

这是查询。子查询（完成两次）只需要 1.3 秒。

```
SELECT T1.[time], T1.Total, T1.rn, T2.[time], T2.Total, T2.rn
FROM
(
select [time], MAX(ComputedValue) as Total, row_number() over (order by [time]) as rn
FROM
(
    select SUBSTRING(CONVERT(CHAR(10), IntervalStartTime, 108), 0, 6) as [time], ComputedValue
    from LoadTestTransactionSample
    where LoadTestRunId=285
    and CounterName='Total Transactions' 
    and TransactionName='Export'
) foo
group by [time]
) T1
_____ JOIN
(
select [time], MAX(ComputedValue) as Total, row_number() over (order by [time]) as rn
FROM
(
    select SUBSTRING(CONVERT(CHAR(10), IntervalStartTime, 108), 0, 6) as [time], ComputedValue
    from LoadTestTransactionSample
    where LoadTestRunId=285
    and CounterName='Total Transactions' 
    and TransactionName='Export'
) foo
group by [time]
) T2
ON T1.rn = T2.rn - 1 
```

该`select SUBSTRING`位只是从 DateTime 中获取 HH:MM 字符串。 `LoadTestTransactionSample`实际上是一个跨 8 个表连接的 VIEW。（仅供参考，数据库是 Visual Studio 负载测试结果存储）。以下是其（相关）列：

```
LoadTestRunId INT NOT NULL
CounterName NVARCHAR(255) NOT NULL
TransactionName NVARCHAR(64) NOT NULL
IntervalStartTime DATETIME NOT NULL
IntervalEndTime DATETIME NOT NULL
ComputedValue REAL 
```

一个 FULL JOIN 返回一个多余的不需要的行，所以我需要做一个 RIGHT JOIN 才能得到正确的答案。

*我并不是真的在寻找解决方案*（我有一个：使用 SQL Server 2012 分析函数“LAG”~~将子查询预取到表变量中~~，感谢@a1ex07），只是对**可能导致极端差异的原因有所了解在这些连接类型之间的性能**。

* * *

**编辑：** 这是[慢速右连接查询计划](http://sdrv.ms/10hzuky) 和[快速全连接查询计划](http://sdrv.ms/10hB2Lk)。它们太大，无法发布屏幕截图。

**编辑 2：** 实际上查询计划的 RIGHT JOIN 为 45%，FULL JOIN 为 55%，结果完全不准确（实际上它最终比 99%/1% 差）。我想这意味着我必须依赖实际的执行统计数据。

**编辑 3：** 慢速 RIGHT JOIN 的统计信息：

```
(40 row(s) affected)
Table 'LoadTestPerformanceCounterCategory'. Scan count 0, logical reads 37556, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestPerformanceCounter'. Scan count 0, logical reads 176464, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestScenario'. Scan count 0, logical reads 176464, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestCase'. Scan count 0, logical reads 176464, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'WebLoadTestTransaction'. Scan count 0, logical reads 13411100, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestPerformanceCounterInstance'. Scan count 0, logical reads 36563718, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestPerformanceCounterSample'. Scan count 19721, logical reads 269657, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestRunInterval'. Scan count 41, logical reads 205, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

SQL Server Execution Times:
    CPU time = 36754 ms,  elapsed time = 36763 ms. 
```

快速 FULL JOIN 的统计信息：

```
(41 row(s) affected)
Table 'Worktable'. Scan count 0, logical reads 0, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestPerformanceCounterCategory'. Scan count 0, logical reads 1832, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestPerformanceCounter'. Scan count 0, logical reads 8608, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestScenario'. Scan count 0, logical reads 8608, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestCase'. Scan count 0, logical reads 8608, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'WebLoadTestTransaction'. Scan count 0, logical reads 654200, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestPerformanceCounterInstance'. Scan count 0, logical reads 1783596, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestPerformanceCounterSample'. Scan count 962, logical reads 13154, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.
Table 'LoadTestRunInterval'. Scan count 2, logical reads 10, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

SQL Server Execution Times:
    CPU time = 1950 ms,  elapsed time = 1944 ms. 
```

尽管查询计划明显相似，但 RIGHT JOIN 比 FULL JOIN 执行更多的读取和扫描。

Worktable (in **FULL** JOIN) 是一个提示吗？那是临时表吗？

这似乎表明查询优化器已损坏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T21:52:22.367

好的，事实证明答案是：坏的数据库统计。很坏。如题，从未更新。

`exec sp_updatestats;`FTW。

[*[羞愧地捂住头]*]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T08:06:04.913

这是类似查询的执行计划。桌子非常小。

![执行计划](../Images/e2400573a8b3aeea9c7f233b8945822d.png)

**查询 1**：

*   用途`INNER JOIN`.

*   执行计划看起来更小。

*   但是，占用了总时间的 62%。

**查询 2**：

*   用途`FULL JOIN`.

*   执行计划看起来很大。

*   但是，占用总时间的 38%。

**原因**：在我的情况下，INNER JOIN 使用的是 HASH MATCH。FULL JOIN 使用的是嵌套循环。这由 SQL 优化器决定必须使用哪个物理连接（但是我们可以为它使用其他物理连接）。检查你的执行计划，它会有所帮助。

# c# - 使用逐字字符串文字和附加格式时的索引（从零开始）错误

> ID：15283842
> 
> 赞同：3
> 
> 时间：2013-03-07T23:23:15.347
> 
> 标签：c#, stringbuilder

我正在尝试使用字符串生成器和附加格式来构建一些 html。如何在不出现以下错误的情况下使用逐字字符串文字和附加格式：“索引（从零开始）必须大于或等于零且小于参数列表的大小。”

看这个例子：

```
StringBuilder sb = new StringBuilder(5469);<br />
sb.AppendFormat(@"<td width=""155"">{0}</td>", localVariable); // zero index error here <br />
return sb; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:25:15.270

是`localVariable`数组的类型吗？如果是这样，则数组被解释为 params 数组，而不是 params 数组的第一个参数。要解决此问题，您需要`object`在调用时将其显式转换为`AppendFormat`

```
sb.AppendFormat(@"{0}", (object)localVariable); 
```

# angularjs - 如何在 ui bootstrap modal 指令中嵌入内容

> ID：15283846
> 
> 赞同：9
> 
> 时间：2013-03-07T23:23:29.297
> 
> 标签：angularjs, angularjs-directive, angular-ui

我在 ui bootstrap modal 指令之上创建了一个自定义指令，因此我可以在我的应用程序的任何地方使用相同的模态模板。

我的指令一直有效，直到我尝试将其内容嵌入到模板中：

[http://plnkr.co/edit/YPESA3?p=preview](http://plnkr.co/edit/YPESA3?p=preview)

* * *

### 来自 index.html

```
<div ng-controller="ModalDemoCtrl">
  <button class="btn" ng-click="open()">Open me!</button>

  <my:modal open="shouldBeOpen" close="close()">
    <h1>Content</h1>
  </my:modal>
</div> 
```

### 模块代码：

```
angular.module('plunker', ['ui.bootstrap'])

.controller('ModalDemoCtrl', function($scope) {
  $scope.open = function () {
    $scope.shouldBeOpen = true;
  };

  $scope.close = function () {
    $scope.closeMsg = 'I was closed at: ' + new Date();
    $scope.shouldBeOpen = false;
  };

  $scope.items = ['item1', 'item2'];

})

.directive('myModal', function() {
  return {
    restrict : 'E',
    templateUrl: 'myTpl.html',
    //transclude: true,
    scope : {
      open : '=',
      close : '&'
    }
  };
}); 
```

### 模态模板：

```
<div modal="open">
    <div class="modal-header">
        <h4>I'm a modal!</h4>
    </div>
    <div class="modal-body">
      <!--<div ng-transclude/>-->
    </div>

    <div class="modal-footer">
      <button class="btn btn-warning cancel" ng-click="close()">Cancel</button>
    </div>
</div> 
```

从指令和模板中取消注释 transclude 属性，你会看到你得到一个`TypeError: undefined is not a function.`

我无法弄清楚我做错了什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T03:30:41.610

OP，你的片段正是我想要做的——谢谢！

我设法让你的笨拙通过传递`replace:true`以及`transclude: true`

这是更新的 plunk [http://plnkr.co/edit/gxCS2V?p=preview](http://plnkr.co/edit/gxCS2V?p=preview)

我是 Angular 的新手，所以我很想知道为什么：

> replace - 如果设置为 true，则模板将替换当前元素，而不是将模板附加到元素。
> 
> （通过 Angular 文档）

一旦你知道，这当然是有道理的。

很高兴知道您是否想让您的指令特别可回收。模态是非常完美的例子。

相关：[ui-bootstrap](http://angular-ui.github.com/bootstrap/)值得一试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-08T00:32:48.503

检查此解决方案，您不需要额外的控制器或 angular-ui 只传递一个简单的处理程序并使用它

## 例子.js

```
angular.module('plunker', [], function() {

})

.directive('modal', function() {
  return {
    restrict : 'E',
    templateUrl: 'myTpl.html',
    transclude: true,
    controller: function($scope) {
      // you need get a better unique generator
      $scope.modal_id = 'modal_' + Math.floor((Math.random()*100+1));
      $scope.handler = $scope.modal_id;
    },
    scope : {
      handler : '='
    }
  };
})
.run(); 
```

## 索引.html

```
<!doctype html>
<html ng-app="plunker">
  <head>    
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">    
  </head>
<body>

<div ng-init="handler = null">  
  <modal handler="handler">
    <h1>Content</h1>
  </modal>  
  <a href="#{{handler}}" role="button" class="btn primary" data-toggle="modal">Open me</a>
</div>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.0.5/angular.js"></script>    
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
    <script src="example.js"></script>
</body>
</html> 
```

## 我的Tpl.html

```
<div id="{{modal_id}}" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="{{modal_id}}Label" aria-hidden="true">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h4 id="{{modal_id}}Label">I'm a modal!</h4>
    </div>
    <div class="modal-body">
      <div ng-transclude></div>
    </div>    
    <div class="modal-footer">
      <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
    </div>
</div> 
```

看看[plunker是如何工作的](http://plnkr.co/edit/7opZuK?p=preview)

# python - 从 numpy 数组中分离出最大/最小的标记补丁

> ID：15283849
> 
> 赞同：3
> 
> 时间：2013-03-07T23:23:49.287
> 
> 标签：python, numpy, scipy

我有一个大的 numpy 数组，并用 scipy 中的连接组件标记对其进行标记。现在我想创建这个数组的子集，其中只剩下最大或最小的标签。两个极值当然可以出现多次。

```
import numpy
from scipy import ndimage
....
# Loaded in my image file here. To big to paste
....
s = ndimage.generate_binary_structure(2,2) # iterate structure
labeled_array, numpatches = ndimage.label(array,s) # labeling
# get the area (nr. of pixels) of each labeled patch
sizes = ndimage.sum(array,labeled_array,range(1,numpatches+1)) 

# To get the indices of all the min/max patches. Is this the correct label id?
map = numpy.where(sizes==sizes.max()) 
mip = numpy.where(sizes==sizes.min())

# This here doesn't work! Now i want to create a copy of the array and fill only those cells
# inside the largest, respecitively the smallest labeled patches with values
feature = numpy.zeros_like(array, dtype=int)
feature[labeled_array == map] = 1 
```

有人可以给我提示如何继续前进吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T12:37:04.497

这是完整的代码：

```
import numpy
from scipy import ndimage

array = numpy.zeros((100, 100), dtype=np.uint8)
x = np.random.randint(0, 100, 2000)
y = np.random.randint(0, 100, 2000)
array[x, y] = 1

pl.imshow(array, cmap="gray", interpolation="nearest")

s = ndimage.generate_binary_structure(2,2) # iterate structure
labeled_array, numpatches = ndimage.label(array,s) # labeling

sizes = ndimage.sum(array,labeled_array,range(1,numpatches+1)) 
# To get the indices of all the min/max patches. Is this the correct label id?
map = numpy.where(sizes==sizes.max())[0] + 1 
mip = numpy.where(sizes==sizes.min())[0] + 1

# inside the largest, respecitively the smallest labeled patches with values
max_index = np.zeros(numpatches + 1, np.uint8)
max_index[map] = 1
max_feature = max_index[labeled_array]

min_index = np.zeros(numpatches + 1, np.uint8)
min_index[mip] = 1
min_feature = min_index[labeled_array] 
```

笔记：

*   `numpy.where`返回一个元组
*   标签1的大小是sizes[0]，所以需要在结果中加1`numpy.where`
*   要获取具有多个标签的掩码数组，可以将`labeled_array`其用作标签掩码数组的索引。

结果：

![在此处输入图像描述](../Images/08a1d52b0f1c9a1bfdec11c5e25800da.png)

![在此处输入图像描述](../Images/82f6c799e49a8bd9e5cec8ec145b947f.png)

![在此处输入图像描述](../Images/9c2e8d193c613222fcc6368d3cb619e8.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-07-18T10:33:38.237

首先你需要一个带标签的掩码，给定一个只有 0（背景）和 1（前景）的掩码：

```
labeled_mask, cc_num = ndimage.label(mask) 
```

然后找到最大的连通分量：

```
largest_cc_mask = (labeled_mask == (np.bincount(labeled_mask.flat)[1:].argmax() + 1)) 
```

您可以使用 argmin() 推断最小的对象查找。

# ruby-on-rails - 资源在 Heroku 上加载了两次

> ID：15283858
> 
> 赞同：1
> 
> 时间：2013-03-07T23:24:37.613
> 
> 标签：ruby-on-rails, heroku, asset-pipeline

我在 heroku 上运行 rails 3.2.11。我的脚本被加载了两次，导致：

```
<script src="/assets/jquery-08bbde0e2625ba65b3f4d03e5cf1c05d.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery_ujs-a3266ec390218bd1ea234887ff70ab4e.js?body=1" type="text/javascript"></script>
<script src="/assets/dropdown-504c410c0872c88a73fa906195712053.js?body=1" type="text/javascript"></script>
<script src="/assets/registration-db60840d5dd61a97052f0d3fe669f478.js?body=1" type="text/javascript"></script>
<script src="/assets/jquery.Jcrop-9819495b75d1a185b32ae5bcf2b071fe.js?body=1" type="text/javascript"></script>
<script src="/assets/clean-42820428d4061c499712d032b87a19e7.js?body=1" type="text/javascript"></script>
<script src="/assets/application-5a65a574df27b941748dc66c7373b32b.js?body=1" type="text/javascript"></script> 
```

所有的`jquery`, `jquery_ujs`, `dropdown`, `registration`,`jquery.Jcrop`和`clean`也在`application`. 我不明白为什么只`application`应该加载这些文件。

以下是 的内容`application.js`：

```
//= require jquery
//= require jquery_ujs
//= require dropdown
//= require 'registration'
//= require 'jquery.Jcrop'
//= require clean 
```

我如何将它包含在我的布局中：

```
= javascript_include_tag 'application' 
```

内容`application.rb`（部分与资产有关）：

```
# Enable the asset pipeline
config.assets.enabled = true
config.assets.initialize_on_precompile = false
# Do not compress assets
config.assets.compress = false
# Expands the lines which load the assets
config.assets.debug = true

config.assets.precompile += [
  'active_admin.js',
  'application.js',
  'landing.js.coffee',
  'active_admin.css.scss', 
  'application.css.sass',
  'landing.css.sass'
  ] 
```

内容`production.rb`（部分与资产有关）：

```
# Compress JavaScripts and CSS
config.assets.compress = true
# Don't fallback to assets pipeline if a precompiled asset is missed
config.assets.compile = true
# Generate digests for assets URLs
config.assets.digest = true 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T01:58:29.310

看起来您的问题是您已`config.assets.debug = true`投入生产。尝试添加`config.assets.debug = false`到`production.rb`.

# iphone - 使用当前时间以编程方式添加 UILabel

> ID：15283861
> 
> 赞同：3
> 
> 时间：2013-03-07T23:25:10.847
> 
> 标签：iphone, ios, objective-c

我有一个问题。也许我在错误的地方或什么地方有什么东西，但是我就是想不通！任何帮助，将不胜感激。

我试图简单地以编程方式制作一个仅在我的子视图中显示的时钟。

我已经设置了一个计时器以及一个我想在我创建的子视图中显示的更新器 -(void)。我正在以编程方式构建子视图，这就是不添加 IBOutlet 并将其连接到我的故事板的原因 - 我正在尝试仅使用代码来完成所有操作。

我的 updateTimer 标签上出现错误，上面写着 - 使用未声明的标识符“rightLabel”，这对我来说不起作用。哈哈 - 任何帮助将不胜感激！

。H

```
@interface DemoRootViewController : UIViewController <PaperFoldViewDelegate> {
    NSTimer *timer;
}
@property (nonatomic, strong) UIView *rightView;
-(void)updateTimer; 
```

.m

```
- (id)init
{
    self = [super init];
    if (self) {

        //Timer Setup
        timer = [NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(updateTimer) userInfo:nil repeats:YES];

        //PaperFold Setup
        _paperFoldView = [[PaperFoldView alloc] initWithFrame:CGRectMake(0,0,[self.view bounds].size.width,[self.view bounds].size.height)];
        [_paperFoldView setAutoresizingMask:UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleWidth];
        [self.view addSubview:_paperFoldView];

        //Setup Subview
        _rightView = [[UIView alloc] initWithFrame:CGRectMake(0,0,240,[self.view bounds].size.height)];

        //Setup UILabel
        UILabel *rightLabel = [[UILabel alloc] initWithFrame:_rightView.frame];
        [_rightView addSubview:rightLabel];

        //Using PaperFold Framework to Add the Subview (this works fine)
        [_paperFoldView setRightFoldContentView:_rightView foldCount:2 pullFactor:1];

    }
    return self;
}

-(void)updateTimer {
    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"hh:mm:ss"];
    //This is where I get my error "Use of Undeclared Identifier 'rightLabel' 
    rightLabel.text = [formatter stringFromDate:[NSDate date]];
}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:29:19.943

您没有`rightLabel`声明为属性（或实例变量）。只需将您的 .m 更改为以下代码：

.m

```
@interface DemoRootViewController ()
@property (nonatomic, strong) UILabel *rightLabel;
@property (nonatomic, strong) NSDateFormatter *dateFormatter;
@end

@implementation DemoRootViewController
- (id)init
{
    self = [super init];
    if (self) {

        //Timer Setup
        timer = [NSTimer scheduledTimerWithTimeInterval:0.5 target:self selector:@selector(updateTimer) userInfo:nil repeats:YES];

        //PaperFold Setup
        _paperFoldView = [[PaperFoldView alloc] initWithFrame:CGRectMake(0,0,[self.view bounds].size.width,[self.view bounds].size.height)];
        [_paperFoldView setAutoresizingMask:UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleWidth];
        [self.view addSubview:_paperFoldView];

        //Setup Subview
        _rightView = [[UIView alloc] initWithFrame:CGRectMake(0,0,240,[self.view bounds].size.height)];

        //Setup UILabel
        self.rightLabel = [[UILabel alloc] initWithFrame:_rightView.frame];
        [_rightView addSubview:self.rightLabel];

        //Using PaperFold Framework to Add the Subview (this works fine)
        [_paperFoldView setRightFoldContentView:_rightView foldCount:2 pullFactor:1];

        //Formatter setup
        self.formatter = [[NSDateFormatter alloc] init];
        [self.formatter setDateFormat:@"hh:mm:ss"];
    }
    return self;
}

-(void)updateTimer {
    self.rightLabel.text = [self.formatter stringFromDate:[NSDate date]];
}

@end 
```

该`@interface DemoRootViewController ()`部分称为类扩展。它本质上允许您“私有”属性，因此它们不会通过头文件公开。如果您希望它们公开，只需将两个属性定义放入 .h 文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T23:30:00.513

由于您要更新标签，请将标签变量设为实例变量。然后你可以在方法中创建它并在`init`方法中访问它`updateTimer`。

此外，使日期格式化程序成为实例变量，因此您只需在`init`方法中创建一次。无需每半秒创建一个新的日期格式化程序。

并且由于您`timer`应该是私有实例变量，因此请将其从 .h 文件中删除并放入 .m 文件中。

```
@implementation DemoRootViewController {
    NSTimer *timer;
} 
```

也在那里添加`rightLabel`和`formatter`ivars。

此外，`updateTimer`从 .h 文件中删除声明。这是仅由 .m 文件中的实现使用的私有方法。将其添加到 .h 文件允许其他类调用该方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T04:09:34.207

您必须在 .h 文件中声明 UILabel *rightLabel ，因为您也在另一个方法中使用 rightLabel 。

# c++ - 具有构造函数定义但没有实现它的代码的 c++ 类？

> ID：15283864
> 
> 赞同：4
> 
> 时间：2013-03-07T23:25:17.093
> 
> 标签：c++, class, copy-constructor, function-declaration

我在一个 .h 文件中有以下类：

```
class MyClass
{
protected:
   MyClass();
   ~MyClass();

private:
   MyClass(const MyClass&);
   MyClass& operator=(const MyClass&);
};

inline MyClass::MyClass()
{
}

inline MyClass::~MyClass()
{
} 
```

令我困惑的是，没有实现**MyClass(const MyClass&)**复制构造函数和**MyClass& operator=(const MyClass&)**赋值运算符重载的代码。该类只有定义，但没有别的。

我在我正在分析的代码中看到了这一点，它编译得很好。我是 C++ 新手，在我见过的所有示例中，我都在类中找到了定义，在下面或在单独的 .cpp 文件中找到了实现

那么，任何人都可以解释为什么这段代码可以编译，为什么只包含函数的声明而不包含它的实现？

谢谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T23:30:15.930

作者明确禁止复制构造和分配。

如果在外部使用，会报错（因为是`private`）。如果它被内部引用或被 a 引用`friend`，那么它将产生链接错误，因为定义不存在。

在 C++11 中，这更清楚地写成：

```
MyClass(const MyClass&) = delete;
MyClass& operator=(const MyClass&) = delete; 
```

在这里，编译器将在编译时注意到这一点 - 没有链接器错误和明确的意图，无需额外的文档:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:28:02.580

如果函数已定义但未使用，则代码将编译。如果它们被定义并且从未使用过，优化器将删除它们。但是，如果使用它们，您将收到链接器错误。

定义一个函数而不填写它是不好的做法。特别是如果其他人将使用此代码。

虽然，克里斯在评论中提出了一个很好的观点。如果您不希望人们使用默认功能，它可能会很有用。这也是为什么它位于私人部分的原因，当某些东西像`copy`或`=`应该正常公开时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:28:48.337

如果显式定义构造函数，则会禁用所有其他隐式构造函数。因此，这具有影响，并且在许多情况下都很有用。但是，我认为没有理由定义析构函数并将其留空（甚至没有声明为虚拟的）。

# r - R order 和 reorder 之间的区别

> ID：15283865
> 
> 赞同：1
> 
> 时间：2013-03-07T23:25:19.300
> 
> 标签：r

我正在尝试按两列对数据框进行排序，我可以通过 order 轻松完成此操作，并且可以通过打印它来查看它的工作原理。但是，当我尝试使用 ggplot 时，它似乎忽略了排序。

当我使用 reorder ggplot 得到正确的排序。问题是我还没有找到一种方法来使用重新排序按两个不同的列排序，只是排序。

所以我有一个包含“name”、“a”和“b”列的数据框

**使用顺序**：

```
dfm <- dfm[order(dfm$a, dfm$b, decreasing=TRUE), ]
print (dfm) # prints correct ordering by two columns
ggplot(dfm, aes(x=name, y=a)) + geom_bar(aes(fill=tipo)) # plots in alphabetical ordering by name 
```

**仅排序或按列 a，ggplot 正确：**

```
dfm$name <- reorder (dfm$name, dfm$a)
print (dfm) # prints correct ordering by one column
ggplot(dfm, aes(x=name, y=a)) + geom_bar(aes(fill=tipo)) # plots in order by a 
```

实际上我正在绘制一个堆积条形图，所以 y 不是真正的 a 而是 a 和 b，但排序行为总是相同的。

有任何想法吗？我已经为此苦苦挣扎了一段时间...

# ios - 在 iOS 中解析和接收电子邮件

> ID：15283870
> 
> 赞同：0
> 
> 时间：2013-03-07T23:25:35.230
> 
> 标签：ios, ios5, ios6, email, email-client

假设我有一个电子邮件地址，它只接收特定类型的电子邮件，即从交易中自动生成的收据电子邮件。

我想构建一个 iOS 应用程序来接收来自该电子邮件地址的电子邮件文本，并根据预定义的格式进行解析并显示结果。是否可以在不直接从应用程序处理电子邮件服务器的情况下执行此操作？

意思是我可以例如背负本机邮件客户端（假设它设置为接收发送到电子邮件地址的推送电子邮件）。我尝试浏览 Apple 的 iOS 文档，但找不到任何有用的东西。有人知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:58:01.563

第三方应用程序无法与邮件应用程序集成或使用用户在设备上设置的任何已配置邮件帐户。

但是，如果用户提供所有常用电子邮件帐户详细信息，您可以编写一个可以访问外部电子邮件帐户的应用程序。App Store 有几个 3rd 方邮件应用程序可替代 Apple 的邮件应用程序。

如果您的应用程序是为使用特定电子邮件帐户而编写的，而不是由应用程序用户输入的，那么您可以硬编码应用程序中的所有帐户详细信息。

您的应用程序基本上是运行电子邮件客户端。您只需要知道如何访问 IMAP 或 POP3 帐户、检索电子邮件并根据需要处理它们。

同样，您的应用程序无法拦截或利用用户设置用于标准邮件应用程序的任何电子邮件帐户访问的任何电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:43:44.887

你的问题至少有两个方面：

1.  如何获取要在我的 iOS 应用程序中打开的电子邮件？
    将数据放在附件中并查看此[链接](https://stackoverflow.com/questions/3401900/how-to-show-open-in-when-a-user-tries-to-open-email-attachments-in-ios)
2.  我可以在电子邮件附件中使用什么格式来传输持久对象？
    使用 NSKeyedArchive 作为交换格式，我取得了不错的结果。还有很多其他选择，具体取决于生成收据附件的内容。

发布您的选择的后续行动。祝你好运！

# python - 如何使用链式比较对数组进行布尔掩码？

> ID：15283872
> 
> 赞同：1
> 
> 时间：2013-03-07T23:25:37.193
> 
> 标签：python, numpy

如何使用一对不等式过滤 numpy 数组，例如：

```
>>> a = np.arange(10)
>>> a[a <= 6]
array([0, 1, 2, 3, 4, 5, 6])
>>> a[3 < a]
array([4, 5, 6, 7, 8, 9])
>>>
>>> a[3 < a <= 6]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ValueError: The truth value of an array with more than one element is ambiguous.
 Use a.any() or a.all() 
```

如果我尝试，我会得到相同的响应`a.all(3 < a <= 6)`

`np.array([x for x in a if 3 < x <= 6])`有效，但看起来很讨厌。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T23:41:15.377

你需要做：

```
a[(3 < a) & (a <= 6)] 
```

这是python中的“疣”。在 python`(3 < a <=6)`中被翻译为`((3 < a) and (a <= 6))`. 但是 numpy 数组不适用于该`and`操作，因为 python 不允许`and`and`or`运算符的重载。因为那个 numpy 使用`&`and `|`。大约一年前有一些关于解决这个问题的讨论，但从那以后我似乎没有太多关于它的事情。

[http://mail.python.org/pipermail/python-dev/2012-March/117510.html](http://mail.python.org/pipermail/python-dev/2012-March/117510.html)

# d3.js - 在没有 iframe 的情况下定位 d3 可视化的最佳方式？

> ID：15283873
> 
> 赞同：2
> 
> 时间：2013-03-07T23:25:46.897
> 
> 标签：d3.js

我在 d3js.org 上查看的[所有示例都使用 iframe 将可视化定位在页面顶部和中心。](https://github.com/mbostock/d3/wiki/Gallery)

当我尝试直接在页面上嵌入可视化而不使用 iframe 时，它​​会下降到页面的左下角，在所有其他页面元素下。

除了使用 iframe 之外，任何人都知道定位的任何好选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-16T00:01:55.493

您可以为此使用 CSS：

```
svg{
    position:absolute;
    top:50%;
    left:0px;
} 
```

此示例将其定位在屏幕的下半部分，左对齐。设置 SVG 的高度和宽度时，宽度在 d3 中定义，如下所示：

```
var width = $(window).width();
var height = $(window).height()/2;

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height); 
```

显然（也许不是），你不需要使用 jQuery 来获取窗口的宽度和高度。根据需要重新调整用途。关键是CSS位。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T20:32:57.547

使用 DIV。我就是做这个的。[你可以在这里](http://blog.stephenboak.com/2011/08/07/easy-as-a-pie.html)看到一个例子——

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T01:12:14.430

没有看到就很难诊断......你在使用 SVG 吗？如果是这样，可能是您的`<svg>`标签缺少一个`display:block`？

更笼统地说：

构成可视化的 div —— 宽度小于页面宽度的 div —— 应该`margin: 0 auto`在其父元素中居中。[更多信息在这里](https://stackoverflow.com/questions/1423651/center-div-inside-another-100-width-div)。

# php - 通过ajax将单选按钮选择添加到数据库？

> ID：15283875
> 
> 赞同：0
> 
> 时间：2013-03-07T23:25:49.017
> 
> 标签：php, javascript, ajax, button, radio

当我测试我的表单时，它成功地将数据添加到我的数据库表中，但单选按钮选择始终是“未分组”，这是组中的第一个单选按钮。我尝试给他们单独的 id，但是在我的 ajax.js 文件中，我的函数使用了这个：

```
var group = encodeURI(document.getElementById('group').value); 
```

这意味着现在我正在调用一个不存在的 id（我认为这就是发生的事情）。我怎样才能做到这一点，以便当我的 ajax 函数调用单选按钮选择时，为了将其发送到将其添加到数据库的我的 php 文件，它会选择正确的。

我希望这是有道理的，如果需要更多细节，我可以添加更多。

这是我的表单，它在一个 php 文件中，因为它必须按照我的分配（必须使用 ajax 调用）：

```
<!-- Include AJAX Framework -->
<script src="ajax.js" language="javascript"></script>

<?php   $addContact = $_GET['addContact']; //index which sends new contact form to the html page via ajax function.

//form which users can use to enter the details of a new contact to add to the database.
echo "Add A Contact:";
echo "<form action='javascript:insert()' method='get'>";
echo "<table>";
echo "<tr>";
echo "<td>First Name:</td><td><input name='newFname' type='text' id='newFname' value='' size'20'></input></td>";
echo "</tr>";
echo "<tr>";
echo "<td>Last Name:</td><td><input name='newLname' type='text' id='newLname' value='' size'20'></input></td>";
echo "</tr>";
echo "<tr>";
echo "<td>Phone Number:</td><td><input name='newPhone' type='text' id='newPhone' value='' size'20'></input></td>";
echo "</tr>";
echo "<td>Email Address:</td><td><input name='newEmail' type='text' id='newEmail' value='' size'20'></input></td>";
echo "</tr>";
echo "<tr>";
echo "<td>Postal Address:</td><td><input name='newAddress' type='text' id='newAddress' value='' size'20'></input></td>";
echo "</tr>";
echo "<td>Group:</td><td><input type='radio' id='Ungrouped' name='group' value='Ungrouped'>No Group <input type='radio' id='Friends' name='group' value='Friends'>Friend";
echo "<input type='radio' id='Colleagues' name='group' value='Colleagues'>Colleagues <input type='radio' id='Family' name='group' value='Family'>Family";
echo "</table>";
//submit button that submits the contact information to an ajax function.
echo "<input type='submit' name='Submit' value='Add Contact'/>";
echo "</FORM>"; 
```

这是我的 php 文件，它连接到我的数据库并使用插入语句将数据保存到其中：

```
<!-- Include Database connections info. -->
<?php include('config.php'); ?>

<?php

if(isset($_GET['newFname']) && isset($_GET['newLname']) && isset($_GET['newPhone']) && isset($_GET['newEmail']) && isset($_GET['newAddress']) && isset($_GET['group'])) 
{

    $newFname = $_GET["newFname"] ;
    $newLname = $_GET["newLname"] ;
    $newPhone = $_GET["newPhone"] ;
    $newEmail = $_GET["newEmail"] ;
    $newAddress = $_GET["newAddress"] ;
    $group = $_GET["group"] ;

    $insertContact_sql = "INSERT INTO `test`.`contacts` (`newFname`, `newLname`, `newPhone`, `newEmail`, `newAddress`, `group`) VALUES ('{$newFname}' , '{$newLname}' , '{$newPhone}' , '{$newEmail}' , '{$newAddress}' , '{$group}')";
    $insertContact= mysql_query($insertContact_sql) or die(mysql_error());

} 

else 
{ 
    echo 'Error! Please fill all fileds!';
}

?> 
```

这是我的 ajax（它的相关 ajax 代码，还有其他函数（即调用我的表单到我的 html 页面的函数），但它们不适用于解决这个问题）：

```
function createObject() 
{
    var request_type;
    var browser = navigator.appName;
    if(browser == "Microsoft Internet Explorer")
    {
        request_type = new ActiveXObject("Microsoft.XMLHTTP");
    }

    else    
    {
        request_type = new XMLHttpRequest();
    }

    return request_type;
}

var http = createObject();

//value solve an Internet Explorer cache issue
var nocache = 0;
function insert() 
{
    // Optional: Show a waiting message in the layer with ID login_response
    document.getElementById('content02').innerHTML = "Just a second..."
    // Required: verify that all fileds is not empty. Use encodeURI() to solve some issues about character encoding.
    var newFname= encodeURI(document.getElementById('newFname').value);
    var newLname = encodeURI(document.getElementById('newLname').value);
    var newPhone = encodeURI(document.getElementById('newPhone').value);
    var newEmail = encodeURI(document.getElementById('newEmail').value);
    var newAddress = encodeURI(document.getElementById('newAddress').value);
    var group = encodeURI(document.getElementById('group').value);

    // Set te random number to add to URL request
    nocache = Math.random();
    // Pass the login variables like URL variable
    http.open('get', 'newContact.php?newFname='+newFname+'&newLname=' +newLname+'&newPhone=' +newPhone+'& newEmail=' +newEmail+'&newAddress=' +newAddress+'&group=' +group+'&nocache = '+nocache);
    http.onreadystatechange = insertReply;
    http.send(null);
    }
    function insertReply() {
    if(http.readyState == 4)
    { 
        var response = http.responseText;
        // else if login is ok show a message: "Site added+ site URL".
        document.getElementById('content02').innerHTML = 'Your contact was successfully added!'+response;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T00:30:21.113

您需要做的是循环浏览所有单选按钮并选择已选中的单选按钮。然后，您可以在 AJAX 请求中仅发送该单选按钮的值。像这样的东西：

```
 var radios = document.getElementsByName('group');
    var selectedRadio = null;
    for (var i = 0; i < radios.length; i++) {
        if (radios[i].checked === true) {
            selectedRadio = radios[i]; 
            break;
        }
    }

    var group = encodeURI(selectedRadio.value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T00:40:26.480

你可以试试 jQuery 来解决这个问题。

通过将此行添加到您的`<head>`部分，在您的 HTML 中包含 jQuery：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.pack.js"></script> 
```

然后使用 jquery 选择器通过替换 AJAX 文件中的以下行来获取所需的值

```
var group = encodeURI(document.getElementById('group').value); 
```

通过这些：

```
var groupValue = ($("input[name='group']:checked") != null) ? $("input[name='group']:checked").value : "NOT_CHECKED";
var group = encodeURI(groupValue); 
```

确保无线电输入具有属性`name`。忽略`id`，因为它对手头的目的没有用。此外，在未选中任何按钮时设置您自己的值（如果您没有为其保留默认值）。

您也可以在[https://stackoverflow.com/a/2564019/772020](https://stackoverflow.com/a/2564019/772020)阅读。

请告诉我们是否有帮助。

# c++ - 堆栈指针模板

> ID：15283877
> 
> 赞同：0
> 
> 时间：2013-03-07T23:25:51.363
> 
> 标签：c++, templates, metaprogramming, template-meta-programming, boost-mpl

我正在阅读“现代 C++ 设计”并想到了构建一个类似于指针的类，但它将在堆栈上而不是在堆上分配对象。它可以用在通常返回指向堆上分配的对象的指针的函数中。

在粘贴代码之前我会问我的问题：

1.  已经有类似的东西了吗？
2.  有机会使用吗？（当然如果更准确地实施）
3.  为什么使用`boost::mpl::max_element`（注释掉）的版本不起作用？
4.  如果没有参数，如何调用模板化构造函数？（我的意思是：）`template <class U> StackPointer() { ... }`？

这是代码：

```
#include <iostream>

#include <boost/mpl/vector.hpp>
#include <boost/mpl/max_element.hpp>
#include <boost/mpl/empty.hpp>
#include <boost/mpl/pop_front.hpp>
#include <boost/mpl/size.hpp>
#include <boost/mpl/front.hpp>

template <class V, size_t VS=boost::mpl::size<V>::type::value>
struct max_size
{
    typedef typename boost::mpl::pop_front<V>::type subvector;
    typedef typename boost::mpl::front<V>::type front_type;
    static size_t const value = sizeof(front_type) > max_size<subvector>::value ?
                sizeof(front_type) : max_size<subvector>::value;
};

template <class V>
struct max_size<V, 0>
{
    static size_t const value = 0;
};

class StackPointerImplBase
{
public:
    virtual void clone(char const* from, char* to) const = 0;
};

template <class T>
class StackPointerImpl : public StackPointerImplBase
{
public:
    virtual void clone(char const* from, char *to) const
    {
        new(to) T(*reinterpret_cast<T const*>(from));
    }
};

template <class Base, class DerivedTypes>
class StackPointer
{
public:
    template <class T>
    StackPointer(T const& t)
    {
        std::cout << "Size of m_buf: "  << sizeof(m_buf) << std::endl;
        new(m_impl_buf) StackPointerImpl<T>();
        new(m_buf) T(t);
    }

    StackPointer(StackPointer const& sp)
    {
        //TODO: COPY m_impl_buf
        reinterpret_cast<StackPointerImplBase const*>(sp.m_impl_buf)->clone(sp.m_buf, m_buf);
    }

public:
    ~StackPointer()
    {
        get_pointer()->~Base();
    }

    Base* operator->()
    {
        return get_pointer();
    }

private:
    Base* get_pointer()
    {
        return reinterpret_cast<Base*>(m_buf);
    }

private:
    //typedef max_size<DerivedTypes> xxx_type;
    //typedef typename boost::mpl::max_element<DerivedTypes>::type::type biggest_type;
    //char m_buf[sizeof(typename boost::mpl::max_element<DerivedTypes>::type::type)];
    char m_buf[max_size<DerivedTypes>::value];
    char m_impl_buf[sizeof(StackPointerImplBase)];
};

class Shape
{
public:
    virtual ~Shape() {}

    virtual void say() const { std::cout << "I'm a shape" << std::endl; }
};

class Circle : public Shape
{
public:
    virtual void say() const { std::cout << "I'm a circle" << std::endl; }

private:
    float m_x;
    float m_y;
    float m_r;
};

class Line : public Shape
{
public:
    virtual void say() const { std::cout << "I'm a Line" << std::endl; }

private:
    float m_x1;
    float m_y1;
    float m_x2;
    float m_y2;
};

typedef StackPointer<Shape, boost::mpl::vector<Circle, Line> > ShapeStackPtr;

ShapeStackPtr read_shape()
{
    Line c;
    return ShapeStackPtr(c);
}

int main(int argc, char *argv[])
{

    {
        ShapeStackPtr shape = read_shape();
        shape->say();
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T23:27:55.210

[Boost optional](http://www.boost.org/doc/libs/1_53_0/libs/optional/doc/html/index.html)与您所描述的非常相似。

它使用指针语法，因此它可以模拟`NULL`指针语言中的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:35:41.470

您不能在堆栈上分配一个对象，然后返回任何指向它的东西。从函数返回后，堆栈帧消失了，指向该内存无效。

当您在函数中声明局部变量时，它们被分配在堆栈上，然后在函数返回之前被销毁，并且堆栈框架已过时。

因此，您可以为堆上的对象分配内存并通过指针引用它们。或者在堆栈上的函数中有局部变量。

或者你的意思是作为一种处理被调用函数的返回值的方法？但是，无论如何您都需要将数据从堆复制到堆栈，所以`T obj = *foo()`如果您需要/想要堆栈上的副本，为什么不直接使用。

对我来说，这听起来像是您试图使编译器已经有效处理的事情复杂化。

# html - 在 asp 页面上运行表单操作

> ID：15283880
> 
> 赞同：0
> 
> 时间：2013-03-07T23:25:57.173
> 
> 标签：html, forms, asp-classic

是否可以从经典的 .asp 页面执行传统的表单操作？

我正在开发的这个应用程序使用表单到电子邮件网关（我无法查看其源代码）

```
<form method="post" action="http://xxxx:7462/forms/7">
[FORM FIELDS HERE]
<input type="submit" value="Submit Form" />
</form> 
```

该 xxxx:7462/forms/7 操作将字段发送到邮件网关，该网关将电子邮件发送给某人并重定向到名为thankyou.asp的页面

问题是执行thankyou.asp 需要很长时间，我们需要立即执行。是否可以存储表单信息并从thankyou.asp 页面调用此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T03:24:50.940

您可以使用 javascript/jquery 从thankyou.asp 提交表单。首先将数据发布到thankyou.asp，然后抓取表单字段并将它们插入到jquery post中

```
<script type="text/javascript">
   $.ajax({
        type: "POST",
        data: {field1: <%=request.form("field1").value%>, field2: <%=request.form("Field2").value%>,etc...},
        url: "http://xxxx:7462/forms/7",
        success: function() {
            //do whatever here after it's done processing
            alert("Email Sent");
        },
        dataType: "html"
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T12:36:03.503

是的，这在经典 ASP 中使用 serverXMLHTTP 对象是可能的，该对象是 MSXML.DLL 的一部分，存在于任何现代 Windows 系统上。

Microsoft 在这里描述了如何使用它（POST 和 GET，以及处理结果）：

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms766431(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms766431(v=vs.85).aspx)

希望这可以帮助，

埃里克

# django - 对 HTML 表或字典键进行排序以进行特定布局

> ID：15283887
> 
> 赞同：0
> 
> 时间：2013-03-07T23:26:16.380
> 
> 标签：django, django-templates

我需要对 dict 项目进行排序或以某种方式重新组织 html 表以根据我自己的布局显示数据。

```
<table>
    <tr>
        <th>title</th>
        <th>name</th>
        <th>quantity</th>
        <th>street 1</th>
        <th>street 2</th>
        <th>county</th>
        <th>city</th>
        <th>country</th>
        <th>postal</th>
        <th>shipping</th>
    </tr>

    {% for order in orders %}
    <tr>
        {% for key, value in order.items %}

        <td>
            {% if key == "title" %}
            {{value}}
            {% endif %}

            {% if key == "name" %}
            {{value}}
            {% endif %}

            {% if key == "quantity" %}
            {{value}}
            {% endif %}

            {% if key == "street1" %}
            {{value}}
            {% endif %}

            {% if key == "street2" %}
            {{value}}
            {% endif %}

            {% if key == "county" %}
            {{value}}
            {% endif %}

            {% if key == "city" %}
            {{value}}
            {% endif %}

            {% if key == "country" %}
            {{value}}
            {% endif %}

            {% if key == "postal" %}
            {{value}}
            {% endif %}

            {% if key == "shipping" %}
            {{value}}
            {% endif %}
        </td>

        {% endfor %}
    </tr>
    {% endfor %}
</table> 
```

订单是带有字典的列表。

因为字典中的项目不再按特定顺序排列，我怎样才能将每个 dict 项目放在适当的列中？

我仍然需要在显示列标题时显示它们。从左到右 - “title”是第一个，“name”是第二个等等。

现在，城市在标题下显示，名称在数量下等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T02:59:55.730

如果您试图确保列按特定顺序排列，请不要扩展项目的键和值；而是使用点符号来根据键查找值。您已经知道哪些元素按哪个顺序排列，因此只需遍历每个项目并按照您需要的顺序访问键，将每个键放入相应的列中。

```
{% for order in orders %}
    <tr>
        {% for item in order.items %}
            <td>{{ item.title }}</td>
            <td>{{ item.name }}</td>
            <td>{{ item.quantity }}</td>
            <td>{{ item.street1 }}</td>
            <td>{{ item.street2 }}</td>
            <td>{{ item.county }}</td>
            <td>{{ item.city }}</td>
            <td>{{ item.country }}</td>
            <td>{{ item.postal }}</td>
            <td>{{ item.shipping }}</td>
        {% endfor %}
    </tr>
{% endfor %} 
```

根据 Django 文档（[https://docs.djangoproject.com/en/1.4/topics/templates/#variables](https://docs.djangoproject.com/en/1.4/topics/templates/#variables)），您可以使用点符号进行字典查找。因此，如果您在普通 python 中使用类似的东西，您可以通过Django 模板`item['title']`访问相同的元素。`{{ item.title }}`

另请注意，如果任何值是空白的，Django 模板系统不会混淆；它会优雅地忽略空/空白/不存在的值（因此您不需要 if 构造来决定是否访问数据）。根据上述链接文档：

> 如果您使用不存在的变量，模板系统将插入 TEMPLATE_STRING_IF_INVALID 设置的值，默认设置为 ''（空字符串）。"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T03:02:18.277

```
{% for order in orders %}
<tr>
    {% for key, value in order.items %}

    <td>
        {% if key == "title" %}
        {{order.title}}
        {% endif %}

        .............
    {% endfor %}
</tr>
{% endfor %} 
```

# vba - 搜索条件不支持的操作

> ID：15283891
> 
> 赞同：0
> 
> 时间：2013-03-07T23:26:34.673
> 
> 标签：vba, ms-access

我试图在 VB 中创建一个简单的搜索功能。它的构造如下：

```
Dim rst As recordSet
Dim lastName As String
Dim firstName As String
Dim eventTitle As String

'Current Record set
Set rst = CurrentDb.OpenRecordset("tblWebMeetingData")

If (IsNull(Me.txtFldLastName) = False) Then
    lastName = Me.txtFldLastName
    rst.FindFirst "[Last Name] = " & lastName
    MsgBox ("Found record")
Else
    MsgBox ("Record not found")
End If

If (IsNull(Me.txtFldFirstName) = False) Then
    firstName = Me.txtFldFirstName
End If

If (IsNull(Me.txtFldEventTitle) = False) Then
    eventTitle = Me.txtFldEventTitle
End If 
```

但我不断收到“此类对象不支持操作”的错误消息。是什么赋予了？姓氏字段在表格中隔开

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:33:41.190

如果这是引发错误的行...

```
rst.FindFirst "[Last Name] = " & lastName 
```

`[Last Name]`可能是文本数据类型，因此在`.FindFirst`字符串中使用引号。

```
rst.FindFirst "[Last Name] = '" & lastName & "'" 
```

如果姓氏可能包含撇号，请将它们加倍。

```
rst.FindFirst "[Last Name] = '" & Replace(lastName, "'", "''") & "'" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T11:31:17.307

我收到错误的原因是因为我试图对表对象而不是动态集或快照对象使用 Find First 方法。为了解决这个问题，我将 .OpenRecordSet 中的参数替换为一条 SQL 语句，该语句接收我想要搜索的内容。

感谢您的帮助 Hans Up，因为您所说的工作需要进行。

# javascript - 在 IE 9 中设置对象“对象不支持此操作”

> ID：15283892
> 
> 赞同：2
> 
> 时间：2013-03-07T23:26:48.800
> 
> 标签：javascript, jquery, internet-explorer

尝试将对象的属性设置为新对象，IE 9 给我一个奇怪的错误“对象不支持此操作”我不明白为什么这是唯一抱怨的浏览器。

[http://jsfiddle.net/billpull/QNm6f/1/](http://jsfiddle.net/billpull/QNm6f/1/)

我按照它被解析的顺序编写了代码，想知道这是否是问题所在，因为从技术上讲，浏览器会在对象存在之前到达这部分，但是当代码实际执行时它确实存在。

```
var project = {};

project.viewModels = {};

project.myViewLocator = {
    viewOne: null,
    viewTwo: null
};

$(function () {
   project.myViewLocator.viewOne = new project.viewModels.ViewOneModel(); 
});

project.viewModels.ViewOneModel = function () {
  // some logic  
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:31:49.707

您的 jsFiddle 有这个排序问题，因为您`onload`在左侧面板中设置了它。这意味着当你打电话时：

```
$(function () {
   project.myViewLocator.viewOne = new project.viewModels.ViewOneModel(); 
}); 
```

文档已加载，因此它立即执行回调，因此`ViewOneModel()`尚未定义。

如果您将左侧面板更改为“No wrap in `<body>`”，那么排序问题就会消失，因为文档尚未准备好，并且在定义构造函数之前不会调用回调函数。

如果您看到浏览器之间的时间差异，那可能是由于 jQuery 在不同浏览器中实现 DOMReady 方法的方式不同。但是，在所有情况下，等待运行代码直到`onload`触发将意味着 DOM 已经准备好，并且 DOMReady 代码可能已经触发或者可能在注册时立即触发。

* * *

最简单的建议是在使用之前定义任何函数，而不必担心这样的时间问题。

* * *

更多信息：在通过 jQuery 实现`.ready()`（或您正在使用的表单）进行跟踪时，您可以找到以下代码块：

```
// Do we need to add the callbacks to the
// current firing batch?
if ( firing ) {
    firingLength = list.length;
    // With memory, if we're not firing then
    // we should call right away
} else if ( memory ) {
    firingStart = start;
    fire( memory );
} 
```

这表明（您可以阅读评论）如果 DOM 已经准备好，jQuery 会在您注册它时立即调用回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:32:38.843

您正在注册回调以在定义它*之前*`dom ready`进行初始化。*我猜 IE9 是在定义之前*执行回调，因为 DOM 已经准备好了。`ViewOneModel`

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:34:35.293

您假设 $() 是一个异步方法。然而，事实上，如果 dom 在调用它之前就已经准备好了，这是一个错误的假设。

更改顺序将起作用：

```
var project = {};

project.viewModels = {};

project.myViewLocator = {
    viewOne: null,
    viewTwo: null
};

project.viewModels.ViewOneModel = function () {
  // some logic  
};

$(function () {
   project.myViewLocator.viewOne = new project.viewModels.ViewOneModel(); 
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T00:12:49.473

试试这个它应该可以正常工作，问题是你在定义之前调用一个对象上的函数。

这是[jsffidle](http://jsfiddle.net/QNm6f/4/)

```
var project = {};

project.viewModels = {};

project.myViewLocator = {
    viewOne: null,
    viewTwo: null
};
$(document).ready(function() {
$(function () {
   project.myViewLocator.viewOne = new project.viewModels.ViewOneModel(); 
});

project.viewModels.ViewOneModel = function () {
  // some logic  
    alert('it s working fine ...');
};

}) 
```**

# python - 在 python 中处理巨大的列表

> ID：15283893
> 
> 赞同：10
> 
> 时间：2013-03-07T23:26:49.200
> 
> 标签：python, itertools, poker

如何管理一个包含 100+ 百万个字符串的庞大列表？我怎样才能开始处理如此庞大的列表？

示例大列表：

```
cards = [
            "2s","3s","4s","5s","6s","7s","8s","9s","10s","Js","Qs","Ks","As"
            "2h","3h","4h","5h","6h","7h","8h","9h","10h","Jh","Qh","Kh","Ah"
            "2d","3d","4d","5d","6d","7d","8d","9d","10d","Jd","Qd","Kd","Ad"
            "2c","3c","4c","5c","6c","7c","8c","9c","10c","Jc","Qc","Kc","Ac"
           ]

from itertools import combinations

cardsInHand = 7
hands = list(combinations(cards,  cardsInHand))

print str(len(hands)) + " hand combinations in texas holdem poker" 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-07T23:30:29.030

有很多很多的内存。Python 列表和字符串实际上是*相当*有效的，所以只要你有内存，它应该不是问题。

也就是说，如果您要存储的是专门的扑克牌，那么您绝对可以提出更紧凑的表示形式。例如，您可以使用一个字节来编码每张牌，这意味着您只需要一个 64 位 int 来存储一手牌。然后，您可以将它们存储在 NumPy 数组中，这将比 Python 列表更有效。

例如：

```
>>> cards_to_bytes = dict((card, num) for (num, card) in enumerate(cards))
>>> import numpy as np
>>> hands = np.zeros(133784560, dtype='7int8') # 133784560 == 52c7
>>> for num, hand in enumerate(itertools.combinations(cards, 7)):
...     hands[num] = [cards_to_bytes[card] for card in hand] 
```

为了加快最后一行的速度：`hands[num] = map(cards_to_bytes.__getitem__, hand)`

这将只需要 7 * 133784560 = ~1gb 的内存......如果你将四张卡打包到每个字节中，这可能会减少（我不知道这样做的语法......）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-07T23:45:45.510

如果您只是想遍历所有可能的手来计算它们或找到具有特定属性的手，则**无需将它们全部存储在内存中**。

您可以只使用迭代器而不转换为列表：

```
from itertools import combinations

cardsInHand = 7
hands = combinations(cards,  cardsInHand)

n = 0
for h in hands:
    n += 1
    # or do some other stuff here

print n, "hand combinations in texas holdem poker." 
```

> 德州扑克中的 85900584 手牌组合。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-14T21:54:43.480

另一个允许您创建数据流以进行处理的无内存选项是使用生成器。例如。

打印总手数：

```
sum (1 for x in combinations(cards, 7)) 
```

打印包含梅花 A 的手数：

```
sum (1 for x in combinations(cards, 7) if 'Ac' in x) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-07T23:37:48.473

通常在您花费多长时间编码和运行代码需要多长时间之间进行权衡。如果您只是想快速完成某件事并且不希望它经常运行，那么您建议的方法就可以了。只是让列表变得很大——如果你没有足够的 RAM，你的系统会搅动虚拟内存，但你可能会比学习如何编写更复杂的解决方案更快地得到你的答案。

但是，如果这是一个您希望定期使用的系统，那么您应该想办法把所有东西都存储在 RAM 中。SQL 数据库可能是您想要的。它们可能非常复杂，但因为它们几乎无处不在，所以有很多优秀的教程。

您可能会寻找一个文档完善的框架，例如 django，它通过 ORM 层简化了对数据库的访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-26T06:03:48.217

我的公共领域[OneJoker](https://github.com/lcrocker/OneJoker)库有一些方便的组合函数。它有一个 Iterator 类，可以为您提供有关组合集的信息，而无需存储它们甚至运行它们。例如：

```
 import onejoker as oj
  deck = oj.Sequence(52)
  deck.fill()

  hands = oj.Iterator(deck, 5)    # I want combinations of 5 cards out of that deck

  t = hands.total                 # How many are there?
  r = hands.rank("AcKsThAd3c")    # At what position will this hand appear?
  h = hands.hand_at(1000)         # What will the 1000th hand be?

  for h in hands.all():           # Do something with all of them
     dosomething(h) 
```

您可以使用 Iterator.rank() 函数将每只手减少为单个 int，将它们存储在紧凑数组中，然后使用 Iterator.hand_at() 按需生成它们。

# c++ - 比较c++中排序的函数用于索引排序

> ID：15283897
> 
> 赞同：0
> 
> 时间：2013-03-07T23:27:10.887
> 
> 标签：c++, sorting

我正在尝试根据 array2 的排序顺序对 array1 的元素进行排序。在我的例子中，array1 和 array2 都是同一个类的成员并且它们是公共的。我正在尝试在我的类中使用嵌套类将 std::sort 的 compare() 函数编写为仿函数，以便嵌套类可以访问 array2。这是代码：

```
#include <iostream>
#include <algorithm>

using namespace std;

class sort_test {
public:
  sort_test() { //some initialization
  }

  int array1[10];
  int array2[10]; 
  int index[10];

  void sorting() {
    sort (index, index+5, sort_test::Compare());
  }

  class Compare {
    public:
      sort_test *s;
      bool operator() (const int i, const int j) {
        return (s->array2[i] < s->array2[j]);
      }
  };
};

int main(void) {
    int res[5];
    sort_test st;

    st.array2[0] = 2;
    st.array2[1] = 1;
    st.array2[2] = 7;
    st.array2[3] = 5;
    st.array2[4] = 4;

    st.array1[0] = 8;
    st.array1[1] = 2;
    st.array1[2] = 3;
    st.array1[3] = 2;
    st.array1[4] = 5;

    for (int i=0 ; i<5 ; ++i) {
        st.index[i] = i;
    }

    st.sorting();

    for (int i=0 ; i<5; ++i) {
        res[i] = st.array1[st.index[i]];
    }

    for (int i=0; i<5; ++i) {
        cout << res[i] << endl;
    }

    return 0;
} 
```

代码编译良好，但出现分段错误。代码的预期输出是 2 8 5 2 3

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:39:59.217

比较运算符取消引用未初始化的指针`s`。这可能会导致异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T00:04:25.453

```
sort_test::Compare() 
```

这会将`Compare`对象中的指针初始化为 null；因此，当您尝试访问数组时，您将获得未定义的行为（实际上是分段错误，如果数组索引足够小）。

你要

```
sort_test::Compare(this) 
```

使用适当的构造函数初始化`s`：

```
explicit Compare(sort_test * s) : s(s) {} 
```

在 C++11 中，您可以省略构造函数并对其进行初始化，`Compare{this}`但无论如何添加构造函数都是一个好主意，以使类不易出错。

# python - 将控制台应用程序链接到 python 中的图形应用程序

> ID：15283899
> 
> 赞同：0
> 
> 时间：2013-03-07T23:27:22.137
> 
> 标签：python, import, console

我正在尝试用python（使用pygame）制作一个游戏，它使用控制台菜单作为初始程序，如果选择了相应的选项，它会打开一个由pygame生成的图形窗口。我有一个名为“bship.py”的文件，其中包含一个典型的 pygame 应用程序，该应用程序打开一个 800x600 窗口，当按下“1”时我不知道如何打开它……我试过“导入”功能但无济于事。这是代码！

```
print 'MAIN MENU'
print '----------'
print '\n'
print '1\. Play'
print '2\. Exit'
print '3\. Credits\n\n\n\n\n\n'
menuAnswer = raw_input("> ")
if menuAnswer == '1':
    #What is supposed to go here?
    #How can I run my pygame file? :P
    #"import bship" doesn't seem to work

elif menuAnswer == '2':
    exit()

elif menuAnswer == '3':
    import Credits

elif menuAnswer != ('1', '2', '3', '4'):
    print 'Invalid selection...'
    print 'learn to type, \n'
    print 'Press ENTER when you are ready'
    print 'to accept the repsonsibilities'
    print 'of being a player...'
    raw_input() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T08:51:18.333

```
if menuAnswer == '1':
     game = subprocess.Popen([sys.executable, "bship.py"])
     game.communicate() 
```

使用 Crayzeewulf 的建议，我使用 subprocess 模块来解决问题！呜呜呜：D

# objective-c - 如何在关闭视图时刷新我的 UILabel？

> ID：15283901
> 
> 赞同：1
> 
> 时间：2013-03-07T23:27:26.357
> 
> 标签：objective-c, xcode, uiviewcontroller

我目前正在使用下面的代码来关闭故事板表格视图，用户可以在其中进行应用内购买，然后显示 .xib，这是我的应用的主视图，并在 UILabel 中显示总积分。问题是他们刚刚通过购买添加的新积分总额此时未显示在 UILabel 中。一旦我完全关闭应用程序并重新打开它，它们就会出现。有没有办法在我的关闭操作中添加代码，在关闭当前视图时刷新 .xib 视图或类似的内容。因此，一旦视图被关闭，新的学分总数就会显示在标签中？任何帮助都是极好的！顺便说一句，我对此很陌生，所以在您的回答中，请假设我不太了解！我也使用默认值来存储积分的值。

```
- (IBAction)dismiss:(id)sender {

    [self.presentingViewController dismissModalViewControllerAnimated:YES];
} 
```

这是我管理积分/硬币的方式。

```
-(id) initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {

    if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {
        coins = [[[NSUserDefaults standardUserDefaults] valueForKey:@"coins"] unsignedLongLongValue];
    }
    return self;
}

-(void) viewWillAppear:(BOOL)animated{

    labelCoins.text = [NSString stringWithFormat:@"%lld", coins];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:38:15.313

在某个地方，您有逻辑将适当的文本添加到 UILabel。它目前可能在`viewDidLoad`. 把这个逻辑`viewWillAppear:`写成这样：

```
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    //example code to update label
    self.creditsLabel.text = numberOfCredits;
} 
```

如果您的 UILabel （该示例中的 creditsLabel ）不是属性，则它必须是一个属性才能起作用。

* * *

根据您刚刚添加的新代码，这并没有真正解决您的问题。您需要做的就是将您的`coins`作业添加到`viewWillAppear`. 原因是您需要从用户默认值中重新提取硬币值（当您更改默认值时，此值不会自动更新）。

```
-(void) viewWillAppear:(BOOL)animated{
    coins = [[[NSUserDefaults standardUserDefaults] valueForKey:@"coins"] unsignedLongLongValue];
    labelCoins.text = [NSString stringWithFormat:@"%lld", coins];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:36:12.397

UILabel 是表格视图中单元格的一部分，还是出现在您当前显示的视图中的其他位置？

如果是后者，则将您的 UILabel 连接到 IBOutlet ，然后您可以执行以下操作：

```
- (IBAction)dismiss:(id)sender {
    [myCreditsLabel setText: [NSString stringWithFormat: @"my credits are worth $%4.2f", creditsAsFloat]];
    [self.presentingViewController dismissModalViewControllerAnimated:YES];
} 
```

（“creditsAsFloat”上面只有一个浮点数，但在这种情况下它需要是视图控制器对象的成员）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:40:48.227

`dismissModalViewControllerAnimated`是旧的和过时的。

现代方法是将其发送到您的`presentingViewController`：

```
- (void)dismissViewControllerAnimated:(BOOL)flag completion:(void (^)(void))completion 
```

它允许您提供一个完成块，您可以在其中更新您的呈现视图控制器。

或者，您可以为呈现的视图控制器的委托声明一个协议以符合 - 这将使您对整个过程进行细粒度控制（我不知道您知道什么 - 如果您需要了解更多信息，我可以扩展答案。 ..)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T23:45:37.393

首先，我们可能会给你不准确的建议，因为我们无法清楚地告诉 UILabel 在哪里：

*   认为被驳回
*   在呈现视图中

猜猜第二个选项对您提出问题更有意义。

其次，您有两种选择：

*   又丑又快
*   又好又贵

## 又丑又快

只需在 NSDefaults 键中添加一个观察者，用于将信用额度存储在控制器中，该控制器保留对 UILabel 的引用。在 Xcode 文档中查找

```
Registering for Key-Value Observing 
```

或者

```
addObserver:forKeyPath:options:context: 
```

做一次并没有那么糟糕，但由于它既简单又快速，你很快就会陷入真正的混乱。

## 好又贵

使用委托模式告诉您的呈现控制器更新 UILabel 的内容。

你应该选择第二个选项。你可能听起来矫枉过正和无聊，但从长远来看，它会有所回报。

祝你好运。

# scala - 如何尝试这个 Scala 代码？

> ID：15283907
> 
> 赞同：0
> 
> 时间：2013-03-07T23:27:58.733
> 
> 标签：scala, date, eclipse-juno

如果我想尝试这段代码来练习 Scala 如何处理时间和日期，我应该在 Eclipse 中创建一个新的 Scala 应用程序还是只创建一个新的 Scala 类：

```
sealed abstract class SmartTime extends Ordered[SmartTime] { x =>
        def compare(y: SmartTime) = {
                x match {
                        case InfiniteFuture => 1
                        case InfinitePast => -1
                        case ConcreteTime(x) =>
                                y match {
                                        case InfiniteFuture => -1
                                        case InfinitePast => 1
                                        case ConcreteTime(y) => x compare y
                                }
                }
        }
}
case class ConcreteTime(t: Long) extends SmartTime
case object InfiniteFuture extends SmartTime
case object InfinitePast extends SmartTime

object Main {
        def main(args: Array[String]): Unit = {
                val y = ConcreteTime(100)
                val z = ConcreteTime(10)
                val x = InfiniteFuture
                val p = InfinitePast
                println(Vector(y, z, x, p).sortWith(_ < _))
        }
} 
```

[https://softwareengineering.stackexchange.com/questions/164843](https://softwareengineering.stackexchange.com/questions/164843)

我尝试了 python、java 和 C++ 的日期、日历和时间处理，我认为它们都不是很好。Python 是最好的，因为用时间戳和时间增量来说明你想要的内容相对容易，但我认为 Java 让我们感到困惑，迫使我们使用我们不必在 python 中使用的 Calendar 对象。现在我想尝试在 Scala 中处理时间戳和时间来学习 Scala。上面的代码已发布，我想尝试一下。你能帮助我吗？

![在此处输入图像描述](../Images/3e392a0c9c9d01b9c979f65b04ee3eb0.png)

我可以运行代码并在 Eclipse 中更改它，现在我想尝试编写我的测试用例或尝试无论您在未来的哪个日期，无限的未来仍然在那个日期之前。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T02:41:28.703

Simply Scala 的本地对应物是运行 Scala REPL：

```
% scala
Welcome to Scala version 2.10.0 (Java HotSpot(TM) 64-Bit Server VM, Java 1.7.0_17).
Type in expressions to have them evaluated.
Type :help for more information. 
```

我总是有一个终端选项卡，其中运行着一个股票 Scala REPL。（我什至编写了一个脚本，它会自动重新启动它，以防我摸到 CTRL-D 或遇到结束 REPL 或 JVM 的错误。）

如果您有一个具有依赖项的项目并且您正在使用 SBT（您*正在*使用 SBT，对吗？），您可以启动一个 REPL，其类路径包含您的代码和您的依赖项，这非常方便！

```
% sbt
> console
[info] Compiling 1 Scala source to /Users/rschulz/Projects/scribble/target/scala-2.10/classes...
[info] Starting scala interpreter...
[info]
Welcome to Scala version 2.10.0 (Java HotSpot(TM) 64-Bit Server VM, Java 1.7.0_17).
Type in expressions to have them evaluated.
Type :help for more information.

scala> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T23:34:57.207

如果你真正想要的是最快的方法来知道这个程序的输出是什么而没有任何麻烦，那么你可以使用[http://www.simplyscala.com/](http://www.simplyscala.com/)，它是一个在线 scala 解释器（scala 2.8）。只需将您的代码粘贴到编辑框中，然后单击“评估”。然后输入`Main.main(Array.empty)`并再次单击“评估”。主程序将评估，你会得到你的结果。

然后，如果你真的打算学习 scala，网上有足够多的关于 Eclipse/IntelliJ/SBT 和 scala 使用的教程。一本好书也可能有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T11:47:48.233

在 Eclipse 中，您还可以使用[Scala 工作表](https://github.com/scala-ide/scala-worksheet/wiki/Getting-Started)。

虽然 Java 日期/时间处理通常被认为很糟糕，但有一个非常广泛使用的替代方案：[Joda-Time](http://joda-time.sourceforge.net/)和一个[Scala 包装器](https://github.com/jorgeortiz85/scala-time)。

# 3d - XNA 4.0 中的 3D Beam

> ID：15283914
> 
> 赞同：0
> 
> 时间：2013-03-07T23:28:18.743
> 
> 标签：3d, xna, textures, xna-4.0

我正在寻找一种在 XNA 4.0 中创建 3D 光束效果的方法。目前，我正在投射一条射线并绘制它，所以我有必需品，但我只需要图形。

我正在寻找类似于此人所要求的内容：

[https://gamedev.stackexchange.com/questions/46912/how-to-make-a-3d-beam-effect-with-xna-4-0](https://gamedev.stackexchange.com/questions/46912/how-to-make-a-3d-beam-effect-with-xna-4-0)

我查看了作为对此问题的回复发布的链接：

[http://www.catalinzima.com/samples/lightning-sample/](http://www.catalinzima.com/samples/lightning-sample/)

但是，该实现仅适用于 2D，我要求它以 3D 呈现。我尝试在我的项目中使用它，但纹理有时不会以某些角度呈现。我看过广告牌，但我认为因为光束的来源靠近相机，而目的地很远，所以纹理会被拉伸很多。至于在上面的例子中使用广告牌，我不知道从哪里开始或者它将如何工作。

我对如何处理这件事有点困惑，如果有人能给我一些建议，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:38:05.097

我解决这个问题的方法是使用一系列拉伸的“豹纹”风格纹理（在光束发射期间旋转/移动）将一个或多个圆柱体从光束源渲染到光束目标，并应用模糊以赋予它柔软边缘。

一个人如何实现所有这些实际上取决于一个人是否计划使用 High Def 或 Reach 配置文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T00:53:04.837

我通过对 2d 纹理进行广告牌制作了 3d 空间中的激光束，使得纹理的法线始终与从枪到相机的向量共面，另一个向量朝着激光枪指向的方向前进。这很容易。我制作了一个简短的视频来说明它是如何完成的：

[http://www.screencast.com/t/LDzD2NXOZ](http://www.screencast.com/t/LDzD2NXOZ)

# html - 当我明确设置文本框的高度时，为什么要更改它？

> ID：15283918
> 
> 赞同：0
> 
> 时间：2013-03-07T23:28:38.593
> 
> 标签：html, css

由于某种原因，`input`文本框没有遵守我使用的明确高度。为什么会这样？我尝试使用 Firebug 查看代码中的差异，但它的发生是出于某种原因。在萤火虫中，它显示`height`没有`16px`解释。

css

```
#login_form input[type=text],
#login_form input[type=password]{
  height:26px !important;
  display:inline-block;
} 
```

html

```
<form method="post" id="login_form" >
  <input type="text" size="30">
  <input type="password" size="30">
</form> 
```

萤火虫截图
![萤火虫截图](../Images/2a3f2c769192b1a96c0e7438ad1a3d93.png)

# java - 持久性 JPA

> ID：15283920
> 
> 赞同：0
> 
> 时间：2013-03-07T23:28:48.513
> 
> 标签：java, jpa, persistence

我有一个实体类

公共候选人（）{}

```
public Candidatos(Integer identificacion) {
    this.identificacion = identificacion;
}

public Integer getIdentificacion() {
    return identificacion;
}

public void setIdentificacion(Integer identificacion) {
    this.identificacion = identificacion;
}

public String getNombre() {
    return nombre;
}

public void setNombre(String nombre) {
    this.nombre = nombre;
}

public String getApellido() {
    return apellido;
}

public void setApellido(String apellido) {
    this.apellido = apellido;
}

public String getCurso() {
    return curso;
}

public void setCurso(String curso) {
    this.curso = curso;
}

public Integer getVotos() {
    return votos;
}

public void setVotos(Integer votos) {
    this.votos = votos;
}

@Override
public int hashCode() {
    int hash = 0;
    hash += (identificacion != null ? identificacion.hashCode() : 0);
    return hash;
}

@Override
public boolean equals(Object object) {
    // TODO: Warning - this method won't work in the case the id fields are not set
    if (!(object instanceof Candidatos)) {
        return false;
    }
    Candidatos other = (Candidatos) object;
    if ((this.identificacion == null && other.identificacion != null) || (this.identificacion != null && !this.identificacion.equals(other.identificacion))) {
        return false;
    }
    return true;
}

@Override
public String toString() {
    return "entidades.Candidatos[ identificacion=" + identificacion + " ]";
} 
```

}

和我的 JPA 控制器

公共类 CandidatosJpaController 实现 Serializable {

```
public CandidatosJpaController(EntityManagerFactory emf) {
    this.emf = emf;
}
private EntityManagerFactory emf = null;

public EntityManager getEntityManager() {
    return emf.createEntityManager();
}

public void create(Candidatos candidatos) throws PreexistingEntityException, Exception {
    EntityManager em = null;
    try {
        em = getEntityManager();
        em.getTransaction().begin();
        em.persist(candidatos);
        em.getTransaction().commit();
    } catch (Exception ex) {
        if (findCandidatos(candidatos.getIdentificacion()) != null) {
            throw new PreexistingEntityException("Candidatos " + candidatos + " already exists.", ex);
        }
        throw ex;
    } finally {
        if (em != null) {
            em.close();
        }
    }
}

public void edit(Candidatos candidatos) throws NonexistentEntityException, Exception {
    EntityManager em = null;
    try {
        em = getEntityManager();
        em.getTransaction().begin();
        candidatos = em.merge(candidatos);
        em.getTransaction().commit();
    } catch (Exception ex) {
        String msg = ex.getLocalizedMessage();
        if (msg == null || msg.length() == 0) {
            Integer id = candidatos.getIdentificacion();
            if (findCandidatos(id) == null) {
                throw new NonexistentEntityException("The candidatos with id " + id + " no longer exists.");
            }
        }
        throw ex;
    } finally {
        if (em != null) {
            em.close();
        }
    }
}

public void destroy(Integer id) throws NonexistentEntityException {
    EntityManager em = null;
    try {
        em = getEntityManager();
        em.getTransaction().begin();
        Candidatos candidatos;
        try {
            candidatos = em.getReference(Candidatos.class, id);
            candidatos.getIdentificacion();
        } catch (EntityNotFoundException enfe) {
            throw new NonexistentEntityException("The candidatos with id " + id + " no longer exists.", enfe);
        }
        em.remove(candidatos);
        em.getTransaction().commit();
    } finally {
        if (em != null) {
            em.close();
        }
    }
}

public List<Candidatos> findCandidatosEntities() {
    return findCandidatosEntities(true, -1, -1);
}

public List<Candidatos> findCandidatosEntities(int maxResults, int firstResult) {
    return findCandidatosEntities(false, maxResults, firstResult);
}

private List<Candidatos> findCandidatosEntities(boolean all, int maxResults, int firstResult) {
    EntityManager em = getEntityManager();
    try {
        CriteriaQuery cq = em.getCriteriaBuilder().createQuery();
        cq.select(cq.from(Candidatos.class));
        Query q = em.createQuery(cq);
        if (!all) {
            q.setMaxResults(maxResults);
            q.setFirstResult(firstResult);
        }
        return q.getResultList();
    } finally {
        em.close();
    }
}

public Candidatos findCandidatos(Integer id) {
    EntityManager em = getEntityManager();
    try {
        return em.find(Candidatos.class, id);
    } finally {
        em.close();
    }
}

public int getCandidatosCount() {
    EntityManager em = getEntityManager();
    try {
        CriteriaQuery cq = em.getCriteriaBuilder().createQuery();
        Root<Candidatos> rt = cq.from(Candidatos.class);
        cq.select(em.getCriteriaBuilder().count(rt));
        Query q = em.createQuery(cq);
        return ((Long) q.getSingleResult()).intValue();
    } finally {
        em.close();
    }
} 
```

}

但是当我实例化这个类时

```
public static void main(String[] args) {
    Candidatos candi = new Candidatos();
    candi.setIdentificacion(1);
    candi.setNombre("juan");
    candi.setApellido("ovalle");
    candi.setCurso("1001");
    candi.setVotos(1);
    CandidatosJpaController control = new CandidatosJpaController(); 
```

说我 CandidatosJpaController 类中的构造函数 CandidatosJpaController 不能应用于给定类型，需要：EntityManagerFactory。

发生什么事？因为如果我创建一个空的构造函数说我：线程“主”java.lang.UnsupportedOperationException 中的异常：尚不支持。在 controladores.CandidatosJpaController.(CandidatosJpaController.java:31) 在 votaciones.Votaciones.main(Votaciones.java:26)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-20T16:51:32.317

您还需要解决方案吗？或者也许其他用户需要它。

用这个改变你的构造函数：

```
CandidatosJpaController control = new CandidatosJpaController(Persistence.createEntityManagerFactory("XXX")); 
```

用你的持久性单元名称替换`XXX`值，看看你`persistence.xml`就知道了。

# c++ - 在 C++ 中动态定义函数

> ID：15283922
> 
> 赞同：2
> 
> 时间：2013-03-07T23:29:15.947
> 
> 标签：c++, interface, c++-cli, implementation

在 C++ 中，是否可以在另一个类的函数中实现一个类的函数（除了依赖关系之外不相关）类的函数？我正在寻找的行为可以使用在匿名内部类中实现的抽象方法和/或接口在 Java 中实现，如下所示：

```
Interface IFoo{

public void doFoo();

}

Class Bar {
private IFoo impl;
public Bar(IFoo implArg){
    impl = implArg;
}

}
static void main(String[] args) {
Bar myBar = new Bar(new IFoo(){
    @Override
    public void doFoo(){
        System.out.println("hello foo impl!");
    }
});
} 
```

在 C++ 中可以实现同样的效果吗？如果可以，如何实现？我想到的用例是动态定义规则，如下所示：

抽象规则.h

```
#ifndef _ABSTRACT_RULE_H_
#define _ABSTRACT_RULE_H_

#include <stdio.h>

class AbstractRule{
private:

public:
AbstractRule();
~AbstractRule();
void enforceAbstractRule();
};

#endif 
```

抽象规则.cpp

```
#include "AbstractRule.h"
AbstractRule::AbstractRule(){
}
AbstractRule::~AbstractRule(){
}

void AbstractRule::enforceAbstractRule(){
printf("placeholder impl of enforceRule-- should not see this in production");
} 
```

主文件

```
#include "AbstractRule.h"

int main(int argc, char** argv){
AbstractRule myRule;
//do something here so that myRule.enforceAbstractRule() call prints "enforced 
    //myRule!"
myRule.enforceAbstractRule();
} 
```

问题是，我需要在“在这里做点什么......”评论中做什么才能达到预期的效果？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:39:10.347

Java 有一个叫做“无名类”的东西，这是您的示例使用的 - 请注意，您的“概念”有点“错误”，因为您实际上并没有“动态”声明一个函数，而是“在”声明一个新类苍蝇”。

在 C++ 中，所有类都必须有一个名称 [1]。

因此，对于您想要做的事情，您需要声明一个扩展基类的类：

```
class MyRule : public Rule
{
   void enforceRule();
};

void MyRule::enforceRule()
{
   ... stuff goes here ... 
} 
```

当然，您也可以将声明`inline`放在类声明中。但是要让它可以使用，你需要给它一个名字。

现在，你的主要将有：

```
MyRule myRule; 
```

[或者，更有可能的是，您调用一个工厂函数来选择“正确”的规则类，创建一个新对象，并返回一个指向该对象的指针]

[1] 并非总是如此，但对于这种特殊用途，您确实需要一个类名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T23:36:15.823

如果您只对可内联定义的小函数感兴趣，您将需要查看 C++11 中添加的 std::function 和 lambda 支持。如果这不是一个选项，您也许可以使用一些 boost 库，但您可能需要定义一些命名的一次性类。

# maven - 如果它是两个目录，我如何在 Maven 中引用本地 Mercurial 存储库？

> ID：15283926
> 
> 赞同：0
> 
> 时间：2013-03-07T23:29:24.363
> 
> 标签：maven, mercurial

我们一直在 POM 文件中使用 SCM URL，如下所示：

```
<scm>
    <connection>scm:hg:file:///${basedir}</connection>
    <developerConnection>scm:hg:file:///${basedir}</developerConnection>
</scm> 
```

它要求我们使用“mvn release:prepare -DpushChanges=false”开始发布过程，但无论如何我们都必须这样做（hg 插件无法正确处理身份验证）。对我们来说最大的好处是，如果发布过程在任何时候出错，我们都可以“剥离”——除了本地开发人员之外，没有人会看到这一点。

如果我们在 Mercurial 结帐中有一个目录，则相同的过程也有效。在这种情况下，以下 URL 可以解决问题：

```
<scm>
    <connection>scm:hg:file:///${basedir}/..</connection>
    <developerConnection>scm:hg:file:///${basedir}/..</developerConnection>
    <tag>HEAD</tag>
</scm> 
```

但是：当那里有另一个级别时，一切都会出错。我已经尝试了文件 URL 的多种变体，但它们似乎都失败了。

使用“scm:hg:file:///${basedir}/../..”的幼稚方法会导致站点插件和发布插件都失败。前者会告诉我：

```
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-site-plugin:3.2:site (default-site) on project epik-protocol-spec: Execution default-site of goal org.apache.maven.plugins:maven-site-plugin:3.2:site failed: This SCM url 'scm:hg:file:///../epik-protocol-spec' is invalid due to the following errors:
[ERROR] * An hg 'file' url must be on the form 'file:///' or 'file://localhost/'.
[ERROR] For more information about SCM URL Format, please refer to: http://maven.apache.org/scm/scm-url-format.html 
```

（'epik-protocol-spec' 是正在运行的构建中的模块的名称）

发布插件遇到类似的问题：在发布：准备之后，release.properties 文件会将 scm.url 设置为“file:///..”，然后在发布期间将无法获取标记代码的副本：履行。解决方法是在步骤之间手动修复属性。我还没有找到使网站构建工作的方法。

我的目标是：

*   有一个开箱即用的构建（即从 IDE 克隆项目并运行任何目标）
*   能够在构建服务器上生成站点（并运行其他构建）
*   能够使用发布插件运行发布，在推送之前审查所有更改

有没有人解决这个问题？为什么 URL 会被严重破坏——是方法不好还是我们遇到了 Maven 问题？

## 编辑

按照 Charlee 的建议，我检查了 mvn help:effective-pom 的输出。SCM URL 在其中受到破坏。它还显示 Maven 将模块名称附加到 URL，这意味着有必要在每个模块上定义 URL——假设可以停止奇怪的修改。

像这样的自定义属性：

```
<properties>
    <test.property>scm:hg:file:///${basedir}/../..</test.property>
</properties> 
```

不会被破坏，它会按预期得到解决（也使用有效的 POM 检查）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T06:10:30.380

Maven SCM 提供程序正在缩短基于“../”和“..\”匹配方案的 URL。如果这些字符序列中的一个匹配，它将向后搜索匹配的斜杠（过去的斜杠），将所有内容删除。这条规则意味着我的文件 URL，看起来像这样：

```
scm:hg:file:///C:\some\local\path/../.. 
```

由于“../”序列会触发缩短，然后它将删除回到上一个*正*斜杠，这意味着回到“C：”之前的斜杠，从而删除整个路径。

如果点后面没有斜线，则不会触发此行为，因此在我的 URL 末尾的步骤不会造成任何伤害 - 这解释了为什么我在上一级没有问题。

解决方案（解决方法？）是使用这个：

```
scm:hg:file:///${basedir}${file.separator}..${file.separator}.. 
```

然后，无论操作系统如何，URL 缩短都会遇到匹配的斜杠，它会再次开始工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T01:51:05.060

关于[SCM 实施：Mercurial](http://maven.apache.org/scm/mercurial.html)，它在示例中提到如下：-

```
scm:hg:http://host/v3
scm:hg:file://C:/dev/project/v3 (windows drive) 
              <--- only 2 slashes + [os, e.g. drive:/path/...]
scm:hg:file:///home/smorgrav/dev/project/v3 (linux drive) 
              <--- only 2 slashes + [os, e.g. /home/...]
scm:hg:/home/smorgrav/dev/project/v3 (local directory) 
```

无论如何，Maven告诉我们

```
This SCM url 'scm:hg:file:///../epik-protocol-spec' 
is invalid due to the following errors 
```

请纠正我，如果我错了。我了解您在 Microsoft Windows 环境中，可能只使用 2 个斜线来满足您的要求。

无论如何，另一个怀疑可能是`${basedir}`被解决为`../epik-protocol-spec`。如果我理解正确，它应该是一个完整的路径。

我希望这可能会有所帮助。

# powershell - 在 PowerShell 中使用回车和换行符查找/替换字符串

> ID：15283931
> 
> 赞同：4
> 
> 时间：2013-03-07T23:30:04.663
> 
> 标签：powershell, control-characters

有没有办法让 PowerShell 找到并用回车和换行符（**\r\nE** ）替换字符串（例如**~}}|{{E**）？

 **例如：

```
$filenames = @("E:\blergfest.csv")
foreach ($file in $filenames) {
    $outfile = "$file" + ".out"

    Get-Content $file | Foreach-object {
        $_ -replace '\~}}|{{E', '\r\nE' `
            -replace '\|\r\n', '\r\n'
    } | Set-Content $outfile
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:51:57.760

要创建包含带有回车和换行的控制字符的字符串，您可以使用双引号并使用反引号字符 `，这是 powershell 转义码。像这样：

```
"`r`nE" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T23:48:32.853

这个怎么样：

```
$filenames = @("E:\blergfest.csv")
foreach ($file in $filenames) {
    $outfile = "$file" + ".out"

    Get-Content $file | Foreach-object {
        $_ -replace '\~}}|{{E', "`r`nE" `
            -replace '\|\r\n', "`r`n"
    } | Set-Content $outfile
} 
```**

# c - 需要 sigsuspend 的解释

> ID：15283934
> 
> 赞同：10
> 
> 时间：2013-03-07T23:30:24.980
> 
> 标签：c, unix, process, signals

我需要澄清 sigsuspend 主题。我有一个简化的例子

```
sigset_t mask, oldmask;
sigemptyset (&mask);
sigaddset (&mask, SIGRTMIN+1);
sigprocmask (SIG_BLOCK, &mask, &oldmask);

sigsuspend(&oldmask);

sigprocmask (SIG_UNBLOCK, &mask, NULL); 
```

我是这样理解的：

*   sigemptyset 清除信号列表（掩码） - 因为它是用当前阻塞的信号初始化的（？）*   sigaddset 将 SIGRTMIN+1 添加到掩码*   sigprocmask 将 mask+oldmask 中的所有信号设置为阻塞*   sigsuspend(&oldmask) 暂停线程执行，直到阻塞信号之一到达？如果我想阻止 SIGRTMIN+1，不应该有 sigsuspend(&mask) 吗？

    其次，假设我在一个循环中有这样的 sigsuspend 并且到达了一些 SIGRTMIN+1 信号。对于每个信号，这样的循环会继续吗？在某种队列中？

    ```
    while(1){
        sigsuspend(&oldmask)
        printf("recieved signal");
    } 
    ```

    这样对于每个信号我都打印了“接收到的信号”？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-07T23:55:41.090

^(*这个答案的前一版的主要部分是错误的。我为我的错误道歉。我感谢[Wotim](https://stackoverflow.com/users/2032279/wotim)指出错误。*)

### POSIX 的定义`sigsuspend()`

POSIX 标准[`sigsuspend()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigsuspend.html)相当清楚地描述：

> `#include <signal.h>`
> 
> `int sigsuspend(const sigset_t *sigmask);`
> 
> 描述
> 
> 该`sigsuspend()`函数应将调用线程的当前信号掩码替换为所指向的信号集，`sigmask`然后暂停线程，直到传递一个信号，该信号的作用是执行信号捕获函数或终止进程。这不会导致任何其他可能在进程上挂起的信号在线程上变为挂起。
> 
> 如果该操作是终止进程，则`sigsuspend()`永远不会返回。如果该动作是执行信号捕获函数，`sigsuspend()`则应在信号捕获函数返回后返回，信号掩码恢复为`sigsuspend()`调用前存在的集合。
> 
> 无法阻止无法忽略的信号。这是由系统强制执行的，不会导致指示错误。
> 
> 返回值
> 
> 由于`sigsuspend()`无限期暂停线程执行，所以没有成功完成返回值。如果发生返回，则应返回 -1 并设置 errno 以指示错误。
> 
> 错误
> 
> 如果出现以下情况，该`sigsuspend()`功能将失败：
> 
> `[EINTR]` 调用进程捕获信号，并从信号捕获函数返回控制。

此外，POSIX[信号概念](http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04)说：

> 每个线程都有一个“信号掩码”，它定义了当前阻止传递给它的信号集。

### 应用到您的代码片段

该`sigsuspend()`函数是旧[`pause()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pause.html)函数的现代类似物。

^(*主要变化：两个代码块颠倒了。*)

它允许您将线程发送到睡眠状态，直到其选定的信号之一发生。如果您希望它在 SIGRTMIN+1 到达之前一直休眠，请使用：

```
sigfillset(&mask);
sigdelset(&mask, SIGRTMIN+1);
sigsuspend(&mask); 
```

这会阻塞除 SIGRTMIN+1 之外的所有信号。

如果你想睡觉直到 SIGRTMIN+1 以外的信号到达，你使用：

```
sigemptyset(&mask);
sigaddset(&mask, SIGRTMIN+1);
sigsuspend(&mask); 
```

这仅阻止 SIGRTMIN+1。

除非您在末尾添加换行符，否则您的循环将无法`Received signal`可靠打印（甚至可能不会；您可能需要`fflush(stdout)`或等效）。但是，如果您在正常的事件过程中阻止了 SIGRTMIN+1，然后设置`&oldmask`为仅允许 SIGRTMIN+1，那么当您的代码位于`sigsuspend()`.

您的描述[`sigprocmask()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/sigprocmask.html)不正确：

 ~~> ~~`sigprocmask`将所有信号设置`mask+oldmask`为阻塞~~

当你这样做时：

```
sigset_t mask, oldmask;
sigemptyset(&mask);
sigaddset(&mask, SIGRTMIN+1);
sigprocmask(SIG_BLOCK, &mask, &oldmask); 
```

您将 SIGRTMIN+1 添加到阻塞信号列表中（因为您使用了 SIG_BLOCK 并且`mask`仅包含 SIGRTMIN+1）。in 的输出`oldmask`是添加 SIGRTMIN+1 之前的信号掩码。它可能已经包含也可能不包含 SIGRTMIN+1。`pthread_sigprocmask()`进程的信号掩码从其当前值更改为包含 SIGRTMIN+1 的新值（如果您需要为线程设置信号掩码，则改为使用），您会被告知旧值。

### 从评论中

> `sigsuspend(&oldmask)`如果我想阻止 SIGRTMIN+1，那么在我的第一个示例中使用是错误的吗？

^(*重大变化。*)

~~是的，这是错误的。调用`sigsuspend(&oldmask)`会使您的线程进入睡眠状态，直到`oldmask`收到其中一个信号。的内容`oldmask`是在您添加 SIGRTMIN+1 之前被阻止的信号集。~~

是的，这是错误的。调用`sigsuspend(&oldmask)`将您的线程发送到睡眠状态，直到收到*未*输入的信号之一`oldmask`。的内容`oldmask`是在您添加 SIGRTMIN+1 之前被阻止的信号集。

^(*以下两段被撤回，而不是必然被谴责为错误。我认为两者都有真实的元素，尽管两者也有改进的余地。*)

~~您不使用`sigsuspend()`阻止信号本身；你用它来等待一组指定的信号之一到达。~~

~~如果要忽略SIGRTMIN+1，则需要使用`sigaction()`，也可以照常使用`sigprocmask()`；专门阻止 SIGRTMIN+1 以及所有其他已被阻止的信号。~~

> 我是否正确理解它会像以前一样阻止相同的信号？

~~假设“它”是`sigsuspend()`，那么它将阻止任何未输入`oldmask`的信号并等待其中一个信号`oldmask`到达。~~

假设“它”是`sigsuspend()`，那么它将阻止任何信号进入`oldmask`并等待其中一个*未*进入的信号`oldmask`到达。

> 如果我这样做`sigsuspend(&mask)`了，它会阻止 SIGRTMIN+1 和所有信号，`oldmask`因为`sigprocmask(SIG_BLOCK, &mask, &oldmask)`？

^(重大变化)

~~绝对不！这将暂停线程，直到其中一个信号`mask`到达。由于唯一的信号`mask`是 SIGRTMIN+1，只有当它到达时才会`sigsuspend()`返回。`sigprocmask()`报告在调用之前被阻止的内容`oldmask`；它根本没有修改`mask`（你的变量）；它确实通过添加 SIGRTMIN+1 修改了进程的信号掩码。~~

绝对不！这将挂起线程，直到*未*输入的信号之一`mask`到达。由于唯一的信号`mask`是 SIGRTMIN+1，因此只有该信号被阻塞，当任何其他信号到达时，它将被处理并`sigsuspend()`返回。`sigprocmask()`报告在调用之前被阻止的内容`oldmask`；它根本没有修改`mask`（你的变量）；它确实通过添加 SIGRTMIN+1 修改了进程的信号掩码。

* * *

我强烈建议阅读或重读 POSIX [Signal 概念](http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_04)和操纵信号处理的各种函数。（是的，这部分是“医生，治愈你自己”的处方。）

*如果这里还有错误，请告诉我。*~~

# asp.net-mvc - SignalR 命名空间冲突？无法使用 MapHubs()

> ID：15283941
> 
> 赞同：1
> 
> 时间：2013-03-07T23:30:45.987
> 
> 标签：asp.net-mvc, .net-4.0, signalr

试图在我的项目中更新信号器库，突然解决方案没有建立。

我参考了这些人：

```
Microsoft.AspNet.SignalR.Core.dll
Microsoft.AspNet.SignalR.SystemWeb.dll 
```

我在 global.asax 中有这个：

```
using System;
using System.Web;
using System.Web.Routing; 
```

Intellisense 发现 RouteTable.Routes.MapHubs() 来自 SignalRRouteExtensions，但仍会中断构建。项目是 .net 4.0 MVC 3 应用程序。应该没有任何问题。

你们有什么想法为什么会这样吗？

```
Error 71 'System.Web.Routing.RouteCollection' does not contain a definition for 'MapHubs' and no extension method 'MapHubs' accepting a first argument of type 'System.Web.Routing.RouteCollection' could be found (are you missing a using directive or an assembly reference?)    Global.asax.cs 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T19:41:15.453

您是否手动引用了 SignalR dll 而不是通过 NuGet 安装？如果是这样，我建议确保您`Microsoft.AspNet.SignalR.SystemWeb.dll`的目标是 .NET 4.0 而不是 4.5。SignalR 提供该程序集的不同版本。

你可以使用 Reflector 或 ildasm 来帮助你。只需查看`TargetFrameworkAttribute::.ctor(string)`清单中的程序集并确保它包含“.NETFramework,Version=v4.0”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-22T03:20:38.967

我还发现，当使用不稳定的 2.0.0-beta 版本时，会发生这种情况。当降级到 1.1.3 时它工作正常。

# javascript - Javascript：单击提交按钮时如何将隐藏的输入标签附加到表单中？

> ID：15283945
> 
> 赞同：3
> 
> 时间：2013-03-07T23:31:28.083
> 
> 标签：javascript, forms, function, input

我有隐藏输入标记的变量名称和值，我想在单击提交按钮时将其附加到表单中。我该如何进行编码？

这是我的代码：

```
<script type="text/javascript">

hname="reference";
hvalue="1";

function insertInput(){
document.write( "<input type='hidden' name='" + hname + " ' value=' " + hvalue + " '/><br/>");
}

</script>

<form id="form1">
    <p><label>Username:</label> <input type="text" name="username" size="10"/></p>
    <p><label>Password:</label> <input type="password" name="password" size="10"/></p>

    <p id="hidden"><!-- Insert Hidden input tag here --></p>

    <button type="submit' onClick="insertInput();">Log In</button>  
</form> 
```

我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T00:09:48.017

试试这个：

```
<form id="form1">
        <p><label>Username:</label> <input type="text" name="username" size="10" /></p>
        <p><label>Password:</label> <input type="password" name="password" size="10" /></p>

        <p id="hidden"><!-- Insert Hidden input tag here --></p>

        <button type="submit" onclick="return insertInput();">Log In</button>
</form>

<script type="text/javascript">

    hname="reference";
    hvalue="1";

    function insertInput(){
        var para, hiddenInput, br;
        para = document.getElementById('hidden');
        hiddenInput = document.createElement('input');
        hiddenInput.type = 'hidden';
        hiddenInput.name = hname;
        hiddenInput.value = hvalue;
        para.appendChild(hiddenInput);
        br = document.createElement('br'); //Not sure why you needed this <br> tag but here it is
        para.appendChild(br);

        return false; //Have this function return true if you want to post right away after adding the hidden value, otherwise leave it to false
    }

</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T23:38:56.403

`document.write()`仅在解析文档时有效。一旦文档处于就绪状态（即`DOMContentLoaded`事件已被触发），`document.write`就会隐式调用`document.open()`，这反过来会重置您的文档。

您想为此使用 DOM 方法：

```
var form = document.getElementById('form1');
form.addEventListener("submit", function() {
  var input = document.createElement('input');
  input.type = 'hidden';
  input.name = 'reference';
  input.value = '1';
  this.appendChild(input);
}, true); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-07T23:51:43.487

这是行不通的，因为`document.write`只有在页面加载时才有效，在页面加载后尝试使用它会失败。

你可以使用纯 DOM 脚本来完成，但我建议使用[jQuery](http://jquery.com/)之类的 DOM 库，它们可以让这样的事情变得更容易。

这是您可以使用 jQuery 完成的一种方法：

```
<form id="form1">
    <p><label>Username:</label> <input type="text" name="username" size="10"/></p>
    <p><label>Password:</label> <input type="password" name="password" size="10"/></p>

    <button type="submit">Log In</button>  
</form>

<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script>
$(function () {
    var hname = "reference",
        hvalue = "1";

    $("#form1").on("submit", function () {
        $(this).append("<input type='hidden' name='" + hname + " ' value=' " + hvalue + " '/><br/>");
    });
});

</script> 
```

# python - python构建鸡蛋但没有任何反应

> ID：15283947
> 
> 赞同：0
> 
> 时间：2013-03-07T23:31:37.083
> 
> 标签：python, easy-install, egg

我正在尝试用我的应用程序构建一个鸡蛋，但它不起作用。

我的机器上安装了easy_install。

在带有应用程序的文件夹中，我创建了包含以下内容的文件 setup.py：

```
from setuptools import setup 
```

然后我运行：

```
$ python setup.py bdist_egg 
```

但什么也没发生。知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:39:46.430

我设法解决了它。

有什么帮助是添加：

```
#!/usr/bin/env python 
```

在文件的开头和：

```
setup(
    name='project_name',
    version='0.1',
    description='desc',
    author='Name Surname',
    author_email='my@email.com',
    url='http://my.website.com',
    ) 
```

在导入行下面的内容中

# html - 手动摘录上的 Wordpress html 标签条

> ID：15283948
> 
> 赞同：1
> 
> 时间：2013-03-07T23:31:44.347
> 
> 标签：html, wordpress, strip

我试图制作链接，br 和斜体标签适用于手动摘录但没有运气，没有摘录中断。我尝试了许多不同的代码，例如[http://bacsoftwareconsulting.com/blog/index.php/wordpress-cat/how-to-preserve-html-tags-in-wordpress-excerpt-without-a-plugin/](http://bacsoftwareconsulting.com/blog/index.php/wordpress-cat/how-to-preserve-html-tags-in-wordpress-excerpt-without-a-plugin/)什么都没有，现在我有这个代码：

```
 function wp_trim_all_excerpt($text) {
global $post;
$raw_excerpt = $text;
//Add the allowed HTML tags separated by a comma
$excerpt_length = apply_filters('excerpt_length', 150000);
$text = wp_trim_words( $text, $excerpt_length ); //since wp3.3
$allowed_tags = '<p>,<a>,<em>,<strong>,<i>,<br>';
$text = strip_tags($text, $allowed_tags);

return apply_filters('wp_trim_excerpt', $text, $raw_excerpt); //since wp3.3
}

remove_filter('get_the_excerpt', 'wp_trim_excerpt');
add_filter('get_the_excerpt', 'wp_trim_all_excerpt'); 
```

但是 $allowed_tags 没有保存任何东西，我想是因为我有 wp_trim 但我已经玩了好几个小时了，我也尝试了高级摘录插件，我在页面中激活了摘录，但是，不知道为什么，有html作品。

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T03:49:21.643

上面的方案还是有局限性的，因为有些 HTML 标签是成对出现的。如果摘录包含一个开始标签但没有相应的结束标签，那么网页的其余部分很可能格式不正确。

此代码检查此类标签的摘录并根据需要添加结束标签：

```
<?php
/******************************************************************************
* @Author: Richard Chonak
* @Date:   August 6, 2013
* @Description: Ensures closure of HTML tags opened in an automatically generated excerpt.
* Also trims off any trailing incomplete HTML tag at the end of the excerpt.
* @Tested: Up to WordPress version 3.6
*
* @Author: Boutros AbiChedid 
* @Date:   June 20, 2011
* @Websites: http://bacsoftwareconsulting.com/ ; http://blueoliveonline.com/
* @Description: Preserves HTML formating to the automatically generated Excerpt.
* Also Code modifies the default excerpt_length and excerpt_more filters.
* @Tested: Up to WordPress version 3.1.3
*******************************************************************************/
function custom_wp_trim_excerpt($text) {
$raw_excerpt = $text;
if ( '' == $text ) {
    //Retrieve the post content. 
    $text = get_the_content('');

    //Delete all shortcode tags from the content. 
    $text = strip_shortcodes( $text );

    $text = apply_filters('the_content', $text);
    $text = str_replace(']]>', ']]&gt;', $text);

    $allowed_tags = '<img>,<small>,<strong>,<em>,<b>,<i>,<p>,<br>,<a>,<blockquote>,<ul>,<li>'; /*** MODIFY THIS. Add the allowed HTML tags separated by a comma.***/
    $twopart_tags = '<small>,<strong>,<em>,<b>,<i>,<p>,<br>,<a>,<blockquote>,<ul>,<li>'; /*** MODIFY THIS. Add the twopart HTML tags separated by a comma.***/
    /* turn tag list into one big search pattern */
    $search_patterns = "/" . str_replace(",","|",str_replace(">", "[^>]*>",$twopart_tags)) . '/';

    $text = strip_tags($text, $allowed_tags);

    $excerpt_word_count = 200; /*** MODIFY THIS. change the excerpt word count to any integer you like.***/
    $excerpt_length = apply_filters('excerpt_length', $excerpt_word_count); 

    $excerpt_end = '[...]'; /*** MODIFY THIS. change the excerpt endind to something else.***/
    $excerpt_more = apply_filters('excerpt_more', ' ' . $excerpt_end);

    $words = preg_split("/[\n\r\t ]+/", $text, $excerpt_length + 1, PREG_SPLIT_NO_EMPTY);
    if ( count($words) > $excerpt_length ) {
        array_pop($words);
        $text = implode(' ', $words);
        $text = $text . $excerpt_more;
    } else {
        $text = implode(' ', $words);
    };

    /* if fragment ends in open tag, trim off */
    preg_replace ("/<[^>]*$/", "", $text);

    /* search for tags in excerpt */
    preg_match_all ($search_patterns, $text, $matches);
    /* if any tags found, check for matching pairs */
    $tagstack = array (""); 
    $tagsfound = $matches[0];
    while ( count ($tagsfound) > 0) {
        $tagmatch = array_shift($tagsfound);
    /* if it's a closing tag, hooray; but if it's not, then look for the closer */
        if ( !strpos($tagmatch,"</") && !strpos ($tagmatch,"/>") ) {
      preg_match("/\pL+/",$tagmatch, $tagwords);
          $endtag = "</" . $tagwords[0] . ">";
          /* if this tag was not closed, put the closing tag on the stack */
          if (!in_array($endtag, $tagsfound) ) {
        array_push($tagstack,$endtag);
          };
        };
    };

    /* if any unbalanced tags were found, add the closing tags */
    while (count ($tagstack) > 1) {
    $text = $text . array_pop($tagstack);
    }
}
return apply_filters('wp_trim_excerpt', $text, $raw_excerpt);
}
remove_filter('get_the_excerpt', 'wp_trim_excerpt');
add_filter('get_the_excerpt', 'custom_wp_trim_excerpt');
?> 
```

# jquery - jQuery 验证错误消息位置

> ID：15283951
> 
> 赞同：3
> 
> 时间：2013-03-07T23:31:48.420
> 
> 标签：jquery, jquery-validate

我正在使用 jQuery 验证插件来检查我的输入，并且在调整错误消息的位置时遇到了麻烦。这是我的代码的[演示](http://jsfiddle.net/godhong/USsrw/1/)。

我想在有问题的单元格下显示错误消息，而不是在它旁边。我检查了参考资料，发现我应该专注于`errorPlacement`功能。所以如果我想在单元格下显示错误消息，我应该创建一个新的`<tr>`然后插入错误消息吗？感谢您的任何建议。

```
$("#myform").validate({
  errorPlacement: function(error, element) {
     error.appendTo( element.parent("td").next("td") );
   },
   debug:true
 }) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T00:16:24.920

错误消息在元素“旁边”的唯一原因是因为两者都是内联元素（`<select>`和`<label>`）。您可以简单地将错误消息移到下面：

1）用一些CSS来定位错误标签，给它一个`display: block;`

或者

2）在插入之前将错误标签包装在某个块元素中（您可以使用上面发布的代码，然后在附加之前将错误包装在 div 中）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T00:58:40.770

只需添加`display:block`到您的 CSS。为我工作。

```
.error{
    border-color: #F78181;
    color:red;
    display:block;
} 
```

要使其`label`宽度与 相同`select`，您可以[使用 CSS 下一个兄弟的命名法来设置它的样式，`+`](https://stackoverflow.com/questions/1817792/css-previous-sibling-selector)如下所示：

```
select + label{
    width:300px;
    background: blue;
} 
```

# javascript - 我发现了一个 jQuery UI 错误吗？

> ID：15283959
> 
> 赞同：2
> 
> 时间：2013-03-07T23:32:26.613
> 
> 标签：javascript, jquery-ui

我有一个带有`:hover`我调用的状态的元素`$.draggable()`。助手是一个克隆，所以当我拖动元素时，会创建一个克隆，然后拖动它。但是，有时，`:hover`我的可拖动元素上的状态没有关闭，我必须在不拖动的情况下执行第二次鼠标悬停/移出，然后该元素将返回其原始状态。这都是相当标准的东西，这是`$.draggable()`电话：

```
$("#" + slot).draggable({
    helper: "clone",
    appendTo: "body",
    scope: "my_scope",
    start: function (event, ui) {
        // do some stuff when the element starts being dragged
    },
    stop: function () {
        // do some stuff when the element stops being dragged
    }
}); 
```

以下是该元素具有的所有 CSS 样式：

```
.inventory_item {
    width: 50px;
    height: 50px;
    background-color: #222;
    font-family: Courier;
    text-align: center;
    margin: 10px;
    line-height: 50px;
    font-size: x-large;
    opacity: 1;
    cursor: pointer;
    border-radius: 5px;
    -moz-border-radius: 5px;
    -webkit-box-shadow: inset 0 0 5px #111;
    -moz-box-shadow: inset 0 0 5px #111;
    box-shadow: inset 0 0 5px #111;
} 
```

及其`:hover`状态：

```
.inventory_item:hover {
     -webkit-box-shadow: inset 0 0 10px #555;
     -moz-box-shadow: inset 0 0 10px #555;
     box-shadow: inset 0 0 10px #555;
} 
```

现在，据我所知，没有办法`:hover`使用 Javascript 更改元素的状态。那么，我的另一个选择是使用类和 Javascript mouseover/out 事件来模拟可控`:hover`状态。但在我这样做之前，是否有任何已知的修复方法？这是一个常见的 jQuery UI 错误吗？我的搜索没有发现任何东西。

这是问题的屏幕截图：

![问题图片](../Images/5dbc671028874975e8dd2533a8b8ee14.png)

由于我的屏幕截图软件，您看不到那里的鼠标光标，但它就在被拖出的元素上方。即使它不在突出显示的可拖动元素上方，该元素的`:hover`状态也是打开的。不酷。

# vb.net - 如何在visual basic中单击网页上的链接

> ID：15283960
> 
> 赞同：0
> 
> 时间：2013-03-07T23:32:28.300
> 
> 标签：vb.net, click, hyperlink

我之前在vb中搜索过如何点击网页上的链接，实际上在这个网站上得到了很好的答案。但现在我试图点击另一个链接，让我发布它的代码，这样更容易理解。（第一次问问题，所以放轻松我哈哈）

```
<div class="pauseButton" style="display: block;"><a href="#" address="true"></a></div> 
```

这是我的代码（这是潘多拉的顺便说一句，这是我的代码让你登录。）

```
Public Class fMain

Dim elementCollection As HtmlElementCollection

Private Sub fMain_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    wb.Navigate("http://www.pandora.com")
End Sub

'buttons

Private Sub bLogin_Click(sender As Object, e As EventArgs) Handles bLogin.Click
    elementCollection = wb.Document.GetElementsByTagName("input")

    For Each ele As HtmlElement In elementCollection
        If ele.GetAttribute("name").Equals("email") Then
            ele.SetAttribute("Value", tbEmail.Text)
        End If

        If ele.GetAttribute("name").Equals("password") Then
            ele.SetAttribute("Value", tbPassword.Text)
        End If

        If ele.GetAttribute("type") = "submit" Then
            ele.InvokeMember("click")
        End If
    Next
End Sub

Private Sub bSignOut_Click(sender As Object, e As EventArgs) Handles bSignOut.Click

End Sub

Private Sub bPlay_Click(sender As Object, e As EventArgs) Handles bPlay.Click
    Dim IsRightElement As Boolean = False

    For Each ele As HtmlElement In wb.Document.Links
        If IsRightElement Then
            ele.InvokeMember("click")
            IsRightElement = False
            Exit For
        End If

        If ele.GetAttribute("class") = "playButton" Then
            IsRightElement = True
        End If
    Next
End Sub

Private Sub bPause_Click(sender As Object, e As EventArgs) Handles bPause.Click

End Sub

Private Sub bFavorite_Click(sender As Object, e As EventArgs) Handles bFavorite.Click

End Sub
End Class 
```

任何帮助将不胜感激，如果我让问题变得混乱，我很抱歉，但我几乎知道如何单击具有特定 href="link.com" 的链接，但在这里，唯一将播放按钮与任何其他按钮区分开来的是它的 href="#" 所以帮助不大。再次感谢先进。（：

编辑：我正在尝试制作潘多拉流媒体，我应该在前面提到过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T00:01:14.973

如果您使用的是 Visual Studio.NET，请执行以下操作： 1\. 放置一个 HyperLink 控件 2\. 在 NavigateUrl 属性下，单击省略号。您现在应该会看到一个包含项目中所有文件的屏幕 3\. 选择您的 HTML 文件。如果它不属于您的项目，请使用浏览添加它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T00:12:57.643

在 HTML 中，我给链接一个 ID：

```
<div class="pauseButton" style="display: block;"><a id="LinkID" href="#" address="true"></a></div> 
```

VB.Net 代码通过 Id 获取元素并调用它：

```
Private Function ClickSubmitButton()

        Dim theButton As HtmlElement

        Try

            ' Link the ID from the web form to the Button var
            theButton = webbrowser1.Document.GetElementById("LinkID")

            ' Now do the actual click.
            theButton.InvokeMember("click")
            Return True

        Catch ex As Exception

            Return False

        End Try

    End Function 
```

更新：

好的，如果没有 LinkID，您需要遍历所有元素，一旦确定了 DIV，您就知道下一个元素是链接...

```
Dim IsRightElement as Boolean = False
For Each ele As HtmlElement In wb.Document.Links
        If IsRightElement Then
           ele.InvokeMember("click")
           IsRightElement = False
           Exit For
        End If
        If ele.GetAttribute("class") = "playButton" Then
            IsRightElement = True
        End If
    Next 
```

# javascript - 如何使用jQuery获取每行的每个单元格值

> ID：15283964
> 
> 赞同：0
> 
> 时间：2013-03-07T23:32:51.213
> 
> 标签：javascript, jquery, html, web, tablerow

我在我的网页中动态地添加行，有一次我想获取一行中每个单元格的值。

这是我的行的声明：

```
<tr class="template-upload fade">
<td class="name"><span>{%=file.name%}</span></td>
<td class="title"><label>Andar: <input name="andar" required></label></td>
</tr> 
```

如您所见，我的行有两个单元格：名称和标题。我正在尝试使用 jQuery 获取“名称”单元格的值和输入“andar”的值。

这是我到目前为止所拥有的：

```
$('.template-upload tr').each(function () {
        var item = $(this); //this should represent one row

        var name = item.find('.name').text();
        var andar = item.find('input:text[name=andar]').val();
}); 
```

但是，我在这两个变量中没有得到任何东西。

我在这里能错过什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:36:11.600

你很接近，你只需`tr`要从你的选择器中删除。您的行已经有类`.template-upload`，所以`$('.template-upload tr')`不存在：

```
$('.template-upload').each(function () {
        var item = $(this); //this should represent one row
        var name = item.find('.name').text();
        var andar = item.find('input:text[name=andar]').val();
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/XwZJB/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:36:21.853

`tr`从您的选择器中删除。

```
$('.template-upload') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:36:27.347

你确定你的选择器是对的吗？查看它，您的选择器`.template-upload tr`意味着您正在使用类查找`tr`元素*内*的元素`.template-upload`。

我想你会想要：

```
$('tr.template-upload').each(...) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T23:37:01.907

`.template-upload` *是*你的`tr`

将您的选择器更改为：

```
$('.template-upload').each(function(node){ /* logic */ } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T23:38:08.433

你有错别字...

```
$('tr.template-upload').each(function () {
    ...
}); 
```

# fullcalendar - 在 jQuery FullCalendar 中仅显示当前周

> ID：15283965
> 
> 赞同：0
> 
> 时间：2013-03-07T23:32:51.900
> 
> 标签：fullcalendar

我使用 jQuery FullCalendar，我想在月份显示上只显示实际的一周

这是我想要的图像：http: [//hpics.li/c6680b1](http://hpics.li/c6680b1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:57:52.130

设置日历时，只需使用`defaultView: 'basicWeek'`

```
$('#calendar').fullCalendar({
    header: {
        left: '',
        center: 'title',
        right: ''
    },
    defaultView: 'basicWeek',
   ...your other settings.  
 }); 
```

来源：[基本周](http://arshaw.com/fullcalendar/views/basicWeek/)和[可用视图](http://arshaw.com/fullcalendar/docs/views/Available_Views/)

# git - 如何使用一个命令将克隆点文件 git 克隆到我的主目录中？

> ID：15283971
> 
> 赞同：9
> 
> 时间：2013-03-07T23:33:04.807
> 
> 标签：git, bash

当您执行典型的“git clone [https://github.com/foo/bar.git](https://github.com/foo/bar.git) ”时，您会在当前目录中获得一个文件夹，其中包含该目录中的所有文件。

我正在寻找的是一个可选的命令行参数，它可以让你从那个 git repo（包括 .git 本身）中删除你发出克隆命令的目录中的所有文件。

如果这是一个问题，我正在使用 bash - 提前谢谢你！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-08T00:18:29.313

我明白你想要什么。您可以将 git 存储库初始化到您的主目录，然后添加远程源并拉取。

```
cd
git init
git remote add origin https://github.com/foo/bar.git
git pull 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:35:51.553

您正在寻找点`.`？

```
git clone https://github.com/foo/bar.git . 
```

从 git clone 手册页：

```
git clone [--template=<template_directory>]
          [-l] [-s] [--no-hardlinks] [-q] [-n] [--bare] [--mirror]
          [-o <name>] [-b <name>] [-u <upload-pack>] [--reference <repository>]
          [--separate-git-dir <git dir>]
          [--depth <depth>] [--recursive|--recurse-submodules] [--] <repository>
          [<directory>] 
```

其中 (target)directory 是最后一个参数。请注意，您必须确保当前文件夹`.`为空

# sitecore - 强制“选择关联内容”（数据源）对话框

> ID：15283972
> 
> 赞同：0
> 
> 时间：2013-03-07T23:33:10.510
> 
> 标签：sitecore, sitecore6

是否可以配置占位符/渲染以强制“选择关联内容”（即数据源）对话框出现在页面编辑器中，即使当前页面具有渲染控件允许的模板？

**更新**为了澄清，这里是重现的步骤（我正在运行 6.6）：

1.  使用定义占位符`Repro`的默认布局定义模板`related-repros`
2.  定义`Repro Rendering`允许具有单个数据源模板的渲染`Repro`
3.  `related-repros`定义仅允许的占位符设置`Repro Renderings`
4.  基于`Repro`：`Repro-1`和创建两个内容项`Repro-2`
5.  在页面编辑`Repro-1`器中编辑并添加`Repro-2`到`related-repros`占位符作为`Repro Rendering`

没有出现“选择关联内容”对话框，需要`Repro-2`事后通过更改数据源进行设置。这可能是因为`Repro-1`（当前页面）是 .data 的数据源的有效值`Repro Rendering`。我想要做的是强制对话框出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T00:05:59.350

您的问题不太清楚，但我假设您在谈论页面编辑器和占位符设置？

在这种情况下，如果您使用首选模板设置子布局的“数据源模板”字段并且未预填充子布局的“数据源”字段，则会自动出现“选择关联内容”对话框。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T14:01:19.090

我试图重现它，但不能：如果我使用页面编辑器添加一个组件，该组件需要用于创建当前项目的同一模板的数据源，我仍然会得到*关联内容*对话框。

但是，如果我将`Datasource Location`渲染上的字段留空，我可以重现它。但在这种情况下，对话框*永远不会*显示，即使当前项目是不同的模板也是如此。

你能确认你已经为`Datasource Location`你的渲染配置了一个值吗？

您能否确认您正在运行最新版本的 6.6（修订版 20130214）？

如果这个建议不是解决方案，我会进一步深入研究，因为我很肯定这很容易解决，因为整个过程可以使用管道处理器进行操作。

# c# - 未命名的命名空间添加到 xmlnode

> ID：15283974
> 
> 赞同：0
> 
> 时间：2013-03-07T23:33:30.057
> 
> 标签：c#, namespaces

我想向我的根 xmlnode 添加一个未命名的命名空间。我该怎么做呢？

错误信息 - -

元素或属性的本地名称不能为 null 或空字符串。

```
 System.Xml.XmlDocument xmlDoc = new System.Xml.XmlDocument();

        XmlNode ShipmentReceiptNotification0Node = xmlDoc.CreateElement("ShipmentReceiptNotification", "", "namespacename");

        ShipmentReceiptNotification0Node.InnerText = String.Empty;
        xmlDoc.AppendChild(ShipmentReceiptNotification0Node); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:45:08.690

使用[CreateElement](http://msdn.microsoft.com/en-us/library/z1k08cbx.aspx)的另外 2 个参数覆盖。

```
var node = xmlDoc.CreateElement("ShipmentReceiptNotification", "namespacename"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:45:34.447

尝试像这样更改您的代码：

```
XmlNode ShipmentReceiptNotification0Node = xmlDoc.CreateElement("ShipmentReceiptNotification", "namespacename"); 
```

# c# - 在不同的 smtp 端口上发送带有附件的电子邮件

> ID：15283977
> 
> 赞同：4
> 
> 时间：2013-03-07T23:33:39.807
> 
> 标签：c#, smtp, email-attachments

我目前正在开发 ac# 应用程序，我正在制作自己的电子邮件服务器，用于侦听包括附件数据在内的 SMTP 流量，然后找到 MX 记录电子邮件地址并将其转发给收件人。

除了一个我不明白的奇怪问题外，这一切都很好。

该问题仅影响在 Mono 下在 Linux 上运行 C# 程序，在 Windows 上一切正常。

问题是，如果我的电子邮件服务器程序在端口 26 上运行（端口 25 已在使用中），那么我的 Windows PC 上有一个用于发送文件的测试 c# 程序。然后我得到附件数据，成功地将附件写入临时文件，重新创建附件对象并随消息发送附件。收到电子邮件后，电子邮件内容不再存在并调用附件`noname`，如果我查看附件，它包含电子邮件标题的一部分和构成附件的基本 64 字符串。

但是，如果我然后将程序更改为在端口 25 上运行，那么一切都会以完全相同的方式完成，但是这次当电子邮件到达我的 gmail 帐户时，电子邮件与邮件正文和附件完全一致正确的名称和格式。我不明白为什么在不同端口下的 linux 上运行我的程序会导致这个问题。我检查了工作和非工作之间的标题，一切似乎都很好。

这是单声道的问题吗？当我在 MX 记录上发送它时，我还尝试将 smtp 客户端的端口设置为端口 25，但没有任何不同。以下是我发送附件的方式。

```
FileStream fileStream = new FileStream(attachmentTempName, FileMode.Open, FileAccess.Read);
Attachment attachment = new Attachment(fileStream, attachments[0].realFileName, MediaTypeNames.Application.Octet);
message.Attachments.Add(attachment);
message.From = new MailAddress(emailInfo["EmailFrom"]);
                    message.To.Add(emailInfo["EmailTo"]);
                    message.Subject = emailInfo["Subject"];
                    if (emailInfo["Headers"] != "")
                    {
                        message.Headers.Add(getHeaders(emailInfo["Headers"]));
                    }
                    message.Body = emailInfo["Body"];
                    message.Body = "This is a test hardcoded";
                    if (emailInfo["EmailFormat"] == ManageEmail.EmailFormat.HTML.ToString())
                    {
                        message.IsBodyHtml = true;
                    }
                    else
                    {
                        message.IsBodyHtml = false;
                    }

                    SmtpClient smtp = new SmtpClient(mxRecords[0]);
                    smtp.DeliveryMethod = SmtpDeliveryMethod.Network;
                    smtp.Port = 25;
                    smtp.Send(message); 
```

感谢您的任何帮助，您可以提供。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-15T02:51:40.117

@Boardy，

唯一引起我注意的是以下行：

```
Attachment attachment = new Attachment(fileStream, attachments[0].realFileName, MediaTypeNames.Application.Octet); 
```

Attachment 构造函数的第二个参数应该是**ContentType**，而不是文件名。

```
 message.Attachments.Add(new Attachment(imageFile.InputStream, imageFile.ContentType, MediaTypeNames.Image.Jpeg)); 
```

有关更多信息，请点击此链接： [C# 发送带有附件的电子邮件（图片）](https://stackoverflow.com/questions/34787198/c-sharp-sending-email-with-attached-file-image/34789840#34789840)

干杯。

# c++ - 复制 std::map > 到 std::map >

> ID：15283981
> 
> 赞同：2
> 
> 时间：2013-03-07T23:33:51.427
> 
> 标签：c++

我们可以使用不同类型的键将内容从一张地图复制到另一张地图吗？ `copy std::map<int, vector<int>> to std::map<std:string, vector<int>>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T23:49:16.040

你不能复制它们。虽然地图是从同一个类模板实例化的，但它们仍然是不相关的类型，就像`struct Foo {};`和`struct Bar {};`

但是，您可以[`transform`](http://en.cppreference.com/w/cpp/algorithm/transform)一对一：

```
std::map<int, std::vector<int>> m1;
std::map<std::string, std::vector<int>> m2;

std::transform(m1.begin(), m1.end(), std::inserter(m2, m2.end()),
    [](const std::pair<int, std::vector<int>>& p)
    {
        return std::make_pair(std::to_string(p.first), p.second);
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:40:20.563

恭敬地从@Ceasars 偷走[最后一次被问到的](https://stackoverflow.com/questions/15281111)答案...

1.  创建一个`std::map<std::string, vector<int>>`
2.  遍历旧地图
3.  将密钥更改为 std::string
4.  插入新地图

第 3 步可以使用`boost::lexical_cast`, `std::to_string`（在 C++11 中）或非标准的`itoa`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:37:23.003

当然，您只需要将 int 转换为字符串。我会建议这样的事情：

```
string newKey(itoa(key)); 
```

（首先检查它是否有效:)）

# ruby - 没有 Rails 的 Mongoid

> ID：15283984
> 
> 赞同：14
> 
> 时间：2013-03-07T23:34:33.923
> 
> 标签：ruby, mongodb, mongoid, mongoid3

我正在使用独立的 ruby​​ 应用程序，无法配置 Mongoid 3.0.13 工作。

我遇到了几个具有配置块的示例应用程序，例如：

```
Mongoid::Config.instance.from_hash({"database" => "oid"}) 
```

或者

```
Mongoid.configure do |config|
 name = "mongoid_test_db"
 host = "localhost"
 port = 27017
 config.database = Mongo::Connection.new.db(name)
end 
```

这些导致：

```
undefined method `database=' for Mongoid::Config:Module (NoMethodError) 
```

配置设置似乎最近发生了变化。

我也试过：

```
Mongoid::Config.connect_to("sweet") 
```

但这似乎无济于事。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-07T23:58:09.900

“独立”我假设你的意思不是轨道。Mongoid 实际上提供了一种简单的方法来完成这项工作，无论您如何运行它。

1.  `mongoid.yml`像往常一样定义一个包含数据库连接信息的文件。

```
development:
  clients:
    default:
      database: mongoid
      hosts:
        - localhost:27017 
```

2.  确保您的应用程序中需要 Mongoid。
3.  调用`Mongoid.load!`让 Mongoid 解析您的配置文件并初始化自身。

```
require 'mongoid'
Mongoid.load!('/path/to/your/mongoid.yml') 
```

此信息也可以在“Sinatra、Padrino 和其他”部分下找到：http: [//mongoid.org/en/mongoid/docs/installation.html](http://mongoid.org/en/mongoid/docs/installation.html)

同样的方法也适用于非 webapps。希望有帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-01T02:24:13.280

尝试这个：

```
prompt> ruby myapp.rb 
hello world 
```

* * *

```
prompt> cat mongoid.yml 
development:
  sessions:
    default:
      database: myapp
      hosts:
        - localhost:27017 
```

* * *

```
prompt> cat myapp.rb 
require 'mongoid'
Mongoid.load!("mongoid.yml", :development)
puts "hello world" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-27T20:43:40.003

使用 Mongoid.load 之前的答案是正确的！如果你想从一个 mongoid 配置文件加载。我遇到了需要将 Mongoid 配置嵌入另一个配置文件的情况。因此，我需要一种从哈希加载配置的方法。

在 >3.1 中，您将能够调用 Mongoid.load_configuration(hash)。

不幸的是，这个函数在 3.0 中是私有的。因此，在加载 Mongoid 之前设置一个公共别名方法是可行的：

```
module Mongoid
  module Config
    def load_configuration_hash(settings)
      load_configuration(settings)
    end
  end
end 
```

确保在 require 'mongoid' 之前调用此代码。现在你可以调用 Mongoid.load_configuration_hash(hash)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-02T05:43:18.863

您可以确认您可以创建数据库，将集合添加到数据库并直接从 IRB 将文档添加到集合中：

```
$ rvm use 2.4.1

$ rvm-prompt
$ ruby-2.4.1

$ rvm gemset create mongoid_test
$ rvm use @mongoid_test

$ gem install mongoid

$ gem list | grep mongoid
$ mongoid (7.0.2)

$ rvm-prompt
$ ruby-2.4.1@mongoid_test

$ irb
> require 'mongoid'
 => true

> Mongoid.load!('mongoid.yml', :development)
 => {"clients"=>{"default"=>{"database"=>"mongoid_test", "hosts"=>["localhost:27017"]}}} 

> class LineItem
   include Mongoid::Document
   include Mongoid::Attributes::Dynamic
 end

> item = LineItem.new
> item['cost'] = 12.00
> item['quantity'] = 3
> item['name'] = 'Protein Bars'
> item.save!
 => true 
> LineItem.all.size
 => 1 
> i = LineItem.first
 => #<LineItem _id: 5c552b8d496a9d0828b374b5, cost: 12.0, quantity: 3, name: "Protein Bars"> 
> i.fields.keys
 => ["_id"] 
i.inspect_dynamic_fields
 => ["cost: 12.0", "quantity: 3", "name: \"Protein Bars\""] 
```

打开 MongoDB shell 并确认您的数据在那里：

```
$ mongo
> show dbs
admin
config
local
mongoid_test

> use mongoid_test
switched to db mongoid_test
> show collections
line_items
> db.line_items.find({ cost: 12.0, quantity: 3, name: 'Protein Bars'}, {_id: 0})
{ "cost" : 12, "quantity" : 3, "name" : "Protein Bars" } 
```

直截了当，灵活，而且非常有活力。

# android - Android Java 编程 Uri.parse(string) vs uri typed

> ID：15283986
> 
> 赞同：0
> 
> 时间：2013-03-07T23:34:37.687
> 
> 标签：android, parsing, media-player, uri

我已经搜索了这些主题，但我没有找到任何帮助。我有这个问题。当我使用类似 MediaPlayer 的东西时。

```
//This one is ok
mp.create(MainActivity.this,R.raw.something);
mp.start();
//This one drives me crazy
String a="R.raw.something"
Uri uriss=Uri.parse(a);
mp.create(MainActivity.this,uriss);
mp.start(); 
```

它让我出错（1，-2147483648）这是 MediaPlayer 错误的错误，这不是我的错误 媒体文件错误，这不是我的错误 FilePath 错误，这可能是我的错误，但我不明白为什么，我该如何解决这个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T23:59:19.370

该类`R.java`是自动生成的，并包含其他内部类，这些内部类代表与您的应用程序一起打包的不同资源类型，并且每个内部类都包含`static final int`代表资源的字段。

举一个基本的例子。`/res/values/strings.xml`我项目中的文件有一个`String`“ MyApp `app_name`”。在我的`R.java`课堂上，有一个内部类如下......

```
public static final class string {

    // Various resource identifiers

    public static final int app_name=0x7f0a0038;

} 
```

换句话说，`R.string.app_name`它实际上不是代表“MyApp”的，它是一个资源标识符，它允许我的代码在运行时`String`找到它。`String`

尝试做`String a = "R.raw.something";`的基本上是尝试将 an 分配`int`给 a`String`但用 "" 包围`R.raw.something`将不起作用，因为`"R.raw.something"`它实际上作为资源标识符毫无意义。

之所以`mp.create(MainActivity.this,R.raw.something);`有效，是因为该`create(...)`方法将 an`int`作为其第二个参数，然后将其用作资源标识符来查找实际的原始资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T23:54:31.700

在您的示例中，方法的`String`参数`Uri.parse`应该是符合 RFC 2396 的编码 URI。请参考[http://developer.android.com/reference/android/net/Uri.html#parse(java.lang.String)](http://developer.android.com/reference/android/net/Uri.html#parse(java.lang.String))。报告的错误对应于`0x80000000`未定义的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:51:19.400

利用：

```
String path1 = "android.resource://[your package name]/[res type]/[res id]"
Uri uri1 = Uri.parse("android.resource://com.music.sample/raw/myMusic"); 
```

或者

```
String path2 = "android.resource://[your package name]"
Uri uri2 = Uri.parse("android.resource://com.music.sample/" + R.raw.myMusic); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-03-07T23:40:05.067

“R.raw.something”对我来说看起来不是一个有效的 URI。你可能想要

```
String a = R.raw.something; 
```

并不是

```
String a = "R.raw.something"; 
```

# php - PHP 错误处理，当错误是文本消息而不是抛出的异常时

> ID：15283990
> 
> 赞同：2
> 
> 时间：2013-03-07T23:35:08.553
> 
> 标签：php, error-handling, try-catch

所以，我只是第一次开始了一些 PHP 开发。我正在尝试使用 HTML DOM 导航/解析库。我选择了 ganon，但并不真正关心我最终使用哪一个。

但我马上注意到 PHP 与我见过的所有其他编码语言有着根本的不同。当我查看错误处理时，这一点非常明显。如果一个包含的类/脚本只是打印它的错误，我不能简单地用 try/catch 捕获它。我相信这就是这里正在发生的事情。我没有控制权，即使我是告诉 file_get_dom 运行的人。它可以做任何它想做的事情，并将它想要的任何东西写入生成的 HTML 文件。

这是不好的做法，它肯定把我搞砸了。解决办法是什么？我可以捕捉到它试图写的文本（用隐藏的 div 包围它）吗？但是，在我想阻止这个类写任何它想要的东西的同时，我也知道是否发生了错误，以便我可以采取适当的步骤。

注意：做更多的测试，即使我抛出自己的错误或使用“或死亡”，它并没有完全符合我的预期。所以也许我也只是不知道如何使用 Try/Catch，即使我已经在一些教程中看到它与此完全一样。但是即使这是一个语法错误，我最初的问题仍然存在，如何控制包含的类，以免它们污染我的 html 文件。

```
<?php
try{
 include_once('ganon.php');
}catch(Exception $e){ echo  "OUT: $e->getMessage()"; }

class GamesSummery{
  public function __construct(){

    try{
        $html = file_get_dom('web site adress');
    }catch(Exception $e){ echo "Main: $e->getMessage()"; }
  }
}    $test = new GamesSummery(); 
```

输出（S）：

> “致命错误：第 238 行 C:\xampp\htdocs\hockey\ganon.php 中的最大执行时间超过了 30 秒”

或者

> “警告：file_get_contents()：第 19 行 C:\xampp\htdocs\hockey\ganon.php 中的文件名不能为空”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:42:27.883

首先，增加你的php.ini执行时间，set_time_limit：[http://php.net/manual/en/function.set-time-limit.php](http://php.net/manual/en/function.set-time-limit.php)

其次，您创建的文件名是空的，因此您需要检查或放置一个新文件名：

您需要在访问之前创建一个文件名或写入一个新文件名。创建一个文件作为示例：

> $ourFileName = "示例";
> 
> $ourFileHandle = fopen($ourFileName, 'w') 或 die("无法打开文件");
> 
> fclose($ourFileHandle);

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T23:43:13.947

*   将（可捕获的）错误转换为异常：创建一个执行此操作的函数并使用`set_error_handler()`.
*   防止不良编码员的输出：使用`ob_start()`& `ob_end_clean()`，但更重要的是，尝试找出那个编码员住在哪里，并在他家门口拉屎。
*   使用`exit()`或在他们的库中的人：立即转储库，*根本*`die()`没有理由信任该代码。

 *不幸的是，致命错误通常是……致命的。没有例外。但这就是我们有`error_log`(on) & `display_errors`(off in production, on in dev) 指令的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T23:42:41.420

第一个：在 php 中存在*致命*错误，例如**无法捕获**的语法错误（和其他错误） 。在这种情况下，程序将立即终止。

* * *

对于所有其他人来说，有一种方法可以使用[`set_error_handler()`](http://www.php.net/manual/en/function.set-error-handler.php).

我为您准备了一个自定义错误处理函数，它将所有错误或警告转换为异常。请注意，函数的输出（我注册它的方式）取决于 php.ini 设置`error_reporting`。

首先注册错误处理程序：

```
set_error_handler('errorHandler', ini_get('error_reporting')); 
```

这是函数本身：

```
function errorHandler(
            $errno,
            $errstr,
            $errfile = null,
            $errline = null,
            $errcontext = null
) {
    $message = sprintf("%s: %s, file: %s, line: %s",
        $errno, $errstr, $errfile, $errline
    );
    // -->
    throw new ErrorException($message, 0, $errno, $errfile, $errline);
} 
```

* * *

您可以使用以下示例尝试代码：

```
try {
   $a = 1 / 0; // will throw a warning
} catch ( Exception $e) {
   echo $e->getMessage();
} 
```*

# python - Python 正则表达式删除和替换字符

> ID：15283996
> 
> 赞同：-1
> 
> 时间：2013-03-07T23:35:51.643
> 
> 标签：python, regex

我需要使用从下面`python`删除并用空格替换它。`%22``NAME`

那怎么做？

```
NAME = 'best%22buy' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T23:37:30.463

使用字符串替换而不是正则表达式。

```
NAME = NAME.replace("%22", ' ') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T23:36:53.227

`NAME='best%22buy'.replace('%22',' ')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T23:54:03.047

要回答您的问题，如果您**真的**想为此使用正则表达式，我会这样做：

```
 re.sub(r'\%22', '', 'best%22buy') 
```

否则，我会按照其他人所说的去做并进行查找替换：

```
'best%22buy'.replace('%22', '') 
```

我认为第二种选择更好，*除非*您在同一区域有大量其他正则表达式并且您希望保持一切一致。或者，如果您对正则表达式*感到疯狂*......就像您重新循环大量查找/替换参数一样。

# node.js - 如何在 node.js 中修补环境模块？

> ID：15283997
> 
> 赞同：1
> 
> 时间：2013-03-07T23:35:56.010
> 
> 标签：node.js, npm, mocha.js, monkeypatching

我已经在全球范围内安装了 mocha 并使用它来运行一些测试：

```
$> mocha test.js 
```

在 test.js 文件的根目录中，我想对 mocha 进行猴子补丁：

```
require('mocha').Runner.prototype.runTests = function() {...} 
```

但是 require('mocha') 失败，因为 mocha 不在 node_modules 中，而是全局安装。

如果我在我的项目中本地安装 mocha，则 require('mocha') 会找到它，但它与用于执行的环境模块不同，因此补丁不好。

如果我从本地存储库而不是全局存储库运行 mocha，那么一切正常：

```
$> ./node_modules/mocha/bin/mocha test.js 
```

但是我想从全局存储库中运行 mocha。任何想法？

编辑：我放弃了访问全局 mocha 模块的尝试，似乎在本地运行 mocha 并且在本地需要它对于[我的用例](https://github.com/yaronn/test-creep)来说已经足够了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-19T11:52:32.403

鉴于它`npm root -g`告诉您所有全局节点模块的安装目录（`/usr/local/lib/node_modules`在我的机器上）并且您可以将绝对路径传递给`require`，因此可以这样做：

```
var mocha = require("/usr/local/lib/node_modules/mocha"); 
```

这会加载 mocha 的全局安装。

# jakarta-ee - JSPX让messageDetail消息显示在页面顶部的消息区域？

> ID：15283998
> 
> 赞同：0
> 
> 时间：2013-03-07T23:36:05.877
> 
> 标签：jakarta-ee, myfaces, jspx, trinidad

我在**tr:validateDateTimeRange**中为我的**tr:inputDate**组件设置了一条**messageDetailNotInRange**消息。它出现在组件的正下方。有没有办法让它出现（并替换）出现在页面顶部的默认消息（正在添加到 FacesContext）？

 *****注意：更改此错误消息的替代解决方案无效。我只能得出结论，它是在服务器端抛出的。我无权访问 trinidad 消息包（它必须位于服务器端）。在我可以截获消息或日期值（不是存储在 bean 中，而是存储在 processScope 中）之前，似乎服务器端验证正在发生，这对自定义我的错误消息提出了很大的挑战。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T13:29:40.233

只需[`<tr:messages/>`](http://myfaces.apache.org/trinidad/trinidad-api/tagdoc/tr_messages.html)在页面顶部即可，您就完成了。

> 消息 bean 用于在应用程序页面的顶部为用户提供重要的消息传递信息。它将自动显示添加到 FacesContext 的任何消息。

您可以使用选择器对它们进行蒙皮[`af|messages`](http://myfaces.apache.org/trinidad/skin-selectors.html)（搜索“tr:messages 组件”的文档）

> 这个 tr:messages 组件是使用嵌套在外部表中的内部 div 实现的。外部容器用于布置消息的图标。内部容器包含消息的实际内容。如果使用任何透明图标，则可能应该通过 af|messages::body 选择器在内部表格上设置背景颜色等样式属性。****