# StackOverflow 问答 15467000-15467999

# excel-2007 - 在 Excel 2007 中计算与开始/停止时间的时间差

> ID：15467001
> 
> 赞同：0
> 
> 时间：2013-03-17T22:25:19.133
> 
> 标签：excel-2007

我有一个excel问题。excel 文件中有两次 -`"start time"`和`"restore time"`. 时间实际上是`date/time`这样的格式 -`"2013-3-17 12:06:26".`

我怎样才能减去这两次并将差值放在未使用的列中？

```
Start time - 2013-3-17 12:06:26 Restore time - 2013-3-17 12:07:57 
```

理想情况下，答案应该是（在名为 outage time 的新列中）`0days 1m 31s or just 1m 31s`。

这是示例文件：

[https://www.dropbox.com/s/pf06ese53ybdveg/sample.xlsx](https://www.dropbox.com/s/pf06ese53ybdveg/sample.xlsx)

我真的很感激这方面的任何帮助。我不确定它是否需要使用宏或公式，所以我只是在这里问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:17:02.277

示例文件中的值是真实的日期/时间值，因此您可以使用如下公式

```
=E2-C2 
```

来计算时间差。使用自定义格式格式化结果

```
d \da\y(\s), h \hr, mm \m, ss \s 
```

要不就

```
d \da\y(\s), h:mm:ss 
```

# javascript - 在 javascript 中对闭包方法进行原型设计

> ID：15467005
> 
> 赞同：0
> 
> 时间：2013-03-17T22:25:44.160
> 
> 标签：javascript, oop, interface, closures

我是 javascript 新手，我的问题可能非常愚蠢。我无法为此获得正确的参考。

我正在尝试用 javascript 编写一个控制器对象。这里的想法是使它成为一个接口对象，任何人都可以从它的原型继承并覆盖他们存在的方法。

我只想向对象公开一个方法“process()”，这个方法将调用所有剩余的方法和属性。我试图通过使用闭包将所有其他方法和属性设为私有来实现这一点。这是我的代码的示例片段

```
var ViewController = function() {

    var _viewName = null;

  var loadView = function(viewName) {

    console.log("now loading view : "+viewName+ " ...");
  };

    return {
        process : function(viewName){
            _viewName = viewName;
            loadView(_viewName);
        }
    };

};

var vController = ViewController();
vController.process("alphaView"); 
```

现在这工作得很好。但是，如果我想使用原型覆盖方法 PreProcess、loadView、initView 和 PostProcess，它就不起作用。我尝试使用 Object.create 覆盖

```
var vController2 = Object.create(ViewController, {

  LoadView : function(viewName) {
    //some custom implementation
  },
  //and so forth
}); 
```

而且，如果我更改实现以使用原型定义外部方法也不起作用。像

```
 var ViewController = function() {

      var _viewName = null;

      return {
        process : function(viewName){
          _viewName = viewName;
          loadView(_viewName);
        }
      };

    };

    ViewController.prototype.loadView = function(viewName) {

        console.log("now loading view : "+viewName+ " ...");
    }; 
```

我的问题的要点是我想要（a）控制器的接口对象，用户可以在其中覆盖一个基本方法（LoadView，）（b）所有这些成员都是控制器对象私有的，并且可以通过“过程（）”方法

请指教！

编辑：编辑代码以使其简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T22:35:35.140

将您希望人们能够覆盖的方法放在原型上，以便它们是真正的方法并被`process()`. 然后，一旦您创建了这种类型的对象，您就可以为任何方法创建新的覆盖定义，`process()`并将自动调用它们而不是原始方法。一种方法是这样的：

```
function ViewController() {
}

ViewController.prototype = {
    loadView: function(viewName) {
        console.log("now loading view : "+viewName+ " ...");
    },
    preProcess: function(viewName) {
        console.log("now Pre Processing view : "+viewName+ " ...");
    },
    // other methods here ...
    process: function(viewNmae) {
        this.viewName = viewName;
        console.log(_viewName);
        this.preProcess(_viewName);
        this.loadView(_viewName);
        this.initView(_viewName);
        this.postProcess(_viewName);
    }
}

var controller = new ViewController();
controller.loadView = function(viewName) {
    // override function for loadView
}
controller.process(viewName); 
```

* * *

如果，你真的想禁止调用覆盖方法，那么你就会放弃使用javascript的内置原型机制（因为它是公共的，可以调用任何方法）。因此，您可以使用自己的方案，只需添加新的公共方法来设置覆盖函数。在您现有的代码中，更改此：

```
return {
    process : function(viewName){
        _viewName = viewName;
        loadView(_viewName);
    }
}; 
```

对此：

```
return {
    process : function(viewName){
        _viewName = viewName;
        loadView(_viewName);
    },
    setLoadViewFn: function(fn) {
        loadView = fn;
    }
    // add other override setting functions here
};

// create controller object
var controller = new ViewController();
// set override function for loadView
controller.setLoadViewFn(function(viewName) {
    // override function for loadView
});
controller.process(viewName); 
```

# mysql - 尝试编写 SQL JOIN 的语法错误

> ID：15467008
> 
> 赞同：0
> 
> 时间：2013-03-17T22:25:50.267
> 
> 标签：mysql, sql

SQL 绝对不是我的强项。我知道这足以应付。我从来没有真正学好是如何使用连接。我永远无法让条件语句与连接一起使用，我也不知道为什么。所以我想我会弄清楚的。我正在制作私人新闻提要，这是我要从数据库中获取的 sql

```
SELECT * FROM feed
WHERE INNER JOIN friends ON feed.user = friends.user1
WHERE friends.user2 = ? AND day = ?
ORDER BY id DESC
LIMIT 15 
```

PDO 语句返回的错误是：

*   'SQLSTATE[42000]: 语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的语法，以便在 'INNER JOIN friends ON feed.user = friends.user1 WHERE friends.user2 =' at line 1' 附近使用

如果您在 'AND day = ? 但它不像现在写的那样工作。所以这个陈述有效

```
SELECT * FROM feed
INNER JOIN friends ON feed.user = friends.user1
WHERE friends.user2 = ?
ORDER BY id DESC
LIMIT 15 
```

我的问题是如何添加“AND day =？” 成语句的正确方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T22:33:12.503

```
SELECT * FROM feed 
INNER JOIN friends ON feed.user = friends.user1 
WHERE friends.user2 = ? AND feed.day = ? 
ORDER BY feed.id DESC LIMIT 15 
```

# python - `struct.unpack_from` 不适用于 `bytearray`？

> ID：15467009
> 
> 赞同：5
> 
> 时间：2013-03-17T22:25:52.383
> 
> 标签：python, binary-data

从字符串中解包有效：

```
>>> import struct
>>> struct.unpack('>h', 'ab')
(24930,)
>>> struct.unpack_from('>h', 'zabx', 1)
(24930,) 
```

但如果它是`bytearray`：

```
>>> struct.unpack_from('>h', bytearray('zabx'), 1)
Traceback (most recent call last):
  File "<ipython-input-4-d58338aafb82>", line 1, in <module>
    struct.unpack_from('>h', bytearray('zabx'), 1)
TypeError: unpack_from() argument 1 must be string or read-only buffer, not bytearray 
```

这似乎有点奇怪。我实际上应该怎么做呢？显然我可以：

```
>>> struct.unpack_from('>h', str(bytearray('zabx')), 1)
(24930,) 
```

但我明确地试图*避免*复制可能大量的内存。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T22:31:33.297

看起来`buffer()`是解决方案：

```
>>> struct.unpack_from('>h', buffer(bytearray('zabx')), 1)
(24930,) 
```

`buffer()`不是原件的副本，它的观点：

```
>>> b0 = bytearray('xaby')
>>> b1 = buffer(b0)
>>> b1
<read-only buffer for ...>
>>> b1[1:3]
'ab'
>>> b0[1:3] = 'nu'
>>> b1[1:3]
'nu' 
```

或者，你（我？）可以只使用 python 3；解除限制：

```
Python 3.2.3 (default, Jun  8 2012, 05:36:09) 
[GCC 4.7.0 20120507 (Red Hat 4.7.0-5)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import struct
>>> struct.unpack_from('>h', b'xaby', 1)
(24930,)
>>> struct.unpack_from('>h', bytearray(b'xaby'), 1)
(24930,)
>>> 
```

# python - 从 OAuth2 流程结束获取用户详细信息

> ID：15467011
> 
> 赞同：2
> 
> 时间：2013-03-17T22:26:03.670
> 
> 标签：python, google-app-engine, oauth

我不确定如何在成功 oauth2 流后获取使用详细信息。

代码：

```
from oauth2client.client import OAuth2WebServerFlow
flow = OAuth2WebServerFlow(...
...

auth_uri = flow.step1_get_authorize_url()
self.redirect(str(auth_uri))
....

credentials = flow.step2_exchange(code)
# credentials prints empty string 
```

谢谢。

# haskell - 如何加入两个高阶函数？

> ID：15467012
> 
> 赞同：0
> 
> 时间：2013-03-17T22:26:12.350
> 
> 标签：haskell

我想求解一个动态生成的方程。我在 HackageDB 中找到了一个很好的库，可以使用 Newton-Raphson 方法计算近似根。但是，牛顿函数将函数（具有类型签名 Num a => a -> a ）作为方程。我的问题是，可以将函数附加在一起吗？例如：（语法不正确）

```
join :: (a->a) ->(a->a)->(a->a)
join func1 func2 = func1+func2

For instance:
if func1 = 1+2*X+5*X^2 , func2 = 5 + 4*x + 2*x^3
then func3 = join func1 func2  
func3 is `6 + 6*x +  5*x^2 + 2*x^3? 
```

我正在考虑两种方法来做到这一点。因为每个小函数都是动态生成的，所以我必须将函数简化为上面的形式，然后将信息存储在数据类型中，例如：（语法不正确）

```
data FuncInfo = Info [Double]    
  if 1 + 2*x + 3*x^2   ---->  Info [1,2,3]
     5 + 4*x^3         ---->  Info [5,0,0,4] 
```

这样添加两个数据并创建新函数应该很容易。然而，实际上这并不容易，因为动态生成的小函数确实很难简化（一个小函数可能看起来像这样：） `10 / (1+x)^5`。

我在想的另一种方法是将函数附加在一起，这样就不需要进行简化，也不需要存储到新的数据类型中，例如：

```
func1 = 10 / (1+x) ^5
func2 =  25 / (1+x) ^9
newfunc = (10 / (1+x) ^5) + (25 / (1+x) ^9) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T22:30:58.620

当然。但是，函数值必须具有加法的概念，因此我们必须限制为 type 的函数`(Num b) => a -> b`。然后你可以简单地做

```
functionSum :: (Num b) => (a -> b) -> (a -> b) -> (a -> b)
functionSum f g x = (f x) + (g x) 
```

（我避免使用 name `join`，因为大多数人可能会想到[这个](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad.html#v%3ajoin)完善的功能）。

因此，例如，如果

```
func1 :: Double -> Double
func1 x = 1+2*x+5*x^2

func2 :: Double -> Double
func2 x = 5+4*x+2*x^3 
```

然后

```
*> :t (functionSum func1 func2)
(functionSum func1 func2) :: Double -> Double 
```

* * *

您似乎在部分问题中指出您将多项式存储为系数列表。如果`[a0, a1, a2, ...]`描述了多项式 a0 + a1*x + ...，那么您还可以使用`zipWith (+) list1 list2`来生成表示两个多项式之和的新系数列表。小心处理不同长度的有限列表的情况，认为（提示：在较短的列表中添加零以匹配较长的列表的长度）。

# java - 为伪装的 URL 地址抛出新的异常

> ID：15467013
> 
> 赞同：5
> 
> 时间：2013-03-17T22:26:20.167
> 
> 标签：java, url, exception

我做了一些东西来检索我输入的 URL 的 IP 地址。

```
InetAddress ip = InetAddress.getByName("www.fake.cao");
return ia.getHostAddress(); 
```

我还抛出了 UnknownHostException 来尝试捕获错误 URL 的错误。

问题是，www.fake.cao 被识别为真正的 URL 并返回给我一个不可用的 IP 地址，并且不会抛出异常。

谁能告诉我我能做些什么来捕捉这些自命不凡的 URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T00:07:56.433

问题是您的 ISP 为不存在的 DNS 域返回了一个虚假页面。这种（不好的）做法被称为 NXDOMAIN 重定向。

JRE 无法判断`81.200.64.50`是 的实际 IP 地址`www.fake.cao`，还是您的 ISP 注入的虚假页面。

除了实际尝试打开套接字并检查它是否连接（请注意，即使主机不存在，它也可以连接，例如，如果您尝试打开 HTTP 连接），您可能会比较该主机的返回 IP **，**使用已知无效主机的返回 IP（例如`does-not-exist.invalid`）。

```
InetAddress ip = InetAddress.getByName("www.fake.cao");

InetAddress fake;
try {
   fake = InetAddress.getByName("does-not-exist.invalid");      
} catch (UnknownHostException e) {
   //www.fake.cao exists, but invalid does not
   return ip;
} 
if (Arrays.equals(ip.getAddress(),fake.getAddress())) {
    //both ip and fake resolves to the same IP
    throw new UnknownHostException();
}

//invalid does exist, but it is different from ip
return ip; 
```

这种方法并不完整，因为您的 ISP 可能会为不同的不存在的主机返回不同的地址，但至少会尝试解决该问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T22:35:33.970

尝试打开一个指向该地址的套接字，如果该地址无效，则会抛出异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T22:55:07.573

根据 IP 规范，地址 0.0.0.0 表示不可用、无效或未知的主机。如果您没有收到错误 URL 的异常，也许您可​​以检查 IP 地址。如果是 0.0.0.0，那么主机可能不存在。

如果你从你的 ISP 那里得到一些不存在的通用地址，那么也许你可以尝试执行手动 NS 查找。基本上，您必须重写 InetAddress 类中的整个代码。这将包括获取 DNS 服务器 IP 地址、打开一个套接字、发布 NS 查询和读取解析响应。

如果您不喜欢平台独立性，您可以使用 JNI 连接到平台 DNS 工具。`nslookup.exe`例如，对于 Windows。

# delphi - 使用 for 循环字符串到字符数组的字符串 [0] 始终为空

> ID：15467017
> 
> 赞同：1
> 
> 时间：2013-03-17T22:27:24.807
> 
> 标签：delphi, delphi-2010

```
procedure TfmCypher.btn1Click(Sender: TObject);
var
  i: integer;
 MasterkeyArray: array of char;
 Masterkey : string;
 j : integer;
begin
Masterkey := edtKey.text;
setlength(MasterKeyArray, length(edtkey.text));

for i:= 0 to length(masterkey) do
begin
 MasterkeyArray[i] := masterkey[i];
end; 
```

在上面的代码中，我试图弄清楚为什么 MasterKeyArray 填充为 { #0, a, b} MasterKeyArray 总是 #0。最终，我只想要一个字符串主密钥的 charArray。我一直遇到将 masterkey[0] 分配为 #0 的问题。Masterkey 字符串是从 editbox.text 中收集的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T23:56:42.180

字符串是 1 索引的，但数组是 0 索引的。您的循环正在尝试访问无效的字符串索引 0，并且您也超出了数组的上限。

试试这个：

```
procedure TfmCypher.btn1Click(Sender: TObject);
var
  i: integer;
  MasterkeyArray: array of Char;
  Masterkey : string;
begin
  Masterkey := edtKey.text;
  SetLength(MasterKeyArray, Length(Masterkey));

  for I := 1 to Length(MasterKey) do
  begin
    MasterkeyArray[I-1] := Masterkey[I];
  end;
end; 
```

一个更简单的解决方案是完全摆脱循环并使用`Move()`：

```
procedure TfmCypher.btn1Click(Sender: TObject);
var
  i: integer;
  MasterkeyArray: array of Char;
  Masterkey : string;
begin
  Masterkey := edtKey.text;
  SetLength(MasterKeyArray, Length(Masterkey));
  if Masterkey <> '' then begin
    Move(Masterkey[1], MasterKeyArray[0], Length(Masterkey) * SizeOf(Char));
  end;
end; 
```

# opencart - Opencart 检查客人是否结帐

> ID：15467020
> 
> 赞同：-2
> 
> 时间：2013-03-17T22:27:35.470
> 
> 标签：opencart

我正在对 Opencart 安装进行一些修改，其中一个是显示 x 等的第 1 步。

有没有办法检查用户是否正在使用访客结帐，因为这似乎比注册用户结帐少一步。我认为是因为他们将付款和送货地址合并在一页中。所以我想要的是，如果使用客人结帐显示 1 of 3、2 of 3 等，否则显示 1 of 4、2 of 4 等。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T22:40:49.383

要了解用户是否已登录（注册），您可以使用

```
$this->customer->isLogged() 
```

`true`如果他们已登录（注册）或者`false`是访客，它将返回

# jquery - 破解 jQuery 序列化的值和不在表单中的元素我一直在查看 stackoverflow 和其他地方的很多帖子来寻找这个答案，但我仍在努力寻找适合我的应用程序边界的东西。我正在构建一个现有的插件 (http://johnny.github.com/jquery-sortable/) 来为小学生创建一个拖放式 html 编辑器。该插件使用 jQuery 将输出序列化为类似于 HTML 源代码的格式，从而自动更新网页预览窗口。Contenteditable 跨度可以很好地允许用户

> ID：15467024
> 
> 赞同：7
> 
> 时间：2013-03-17T22:27:49.823
> 
> 标签：jquery, select, serialization, input, jquery-ui-sortable

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-17T22:47:45.117

尝试将所有内容包装在一个`div`

```
<div id="wrapper">
    <input type="text" value="text text" name="text"> <br> 
    <select name="single">
      <option>Single</option>
      <option>Single2</option>
    </select>
    <textarea name="textarea">textarea text</textarea>
</div> 
```

然后序列化这个里面的所有元素`div`

```
$("#wrapper").find("select,textarea, input").serialize(); 
```

# ****[演示](http://jsfiddle.net/4Zfgn/)****

# php - PHP中的简单视图函数

> ID：15467034
> 
> 赞同：1
> 
> 时间：2013-03-17T22:29:50.230
> 
> 标签：php, function, parameters, parameter-passing

我根据一些 net.tutplus.com 教程在 php 中使用 MVC 模式制作了一个简单的博客。不过，我对 php 很陌生，所以请帮助我了解它是如何工作的。

我在这里把它分解成几个简单的文件。3 个文件，index.php、index.view.php 和 function.php 我想知道的是为什么我必须将我的 $data 数组作为视图函数中的第二个参数传递才能在我的 index.view 上访问它.php？如果我将 $data 作为视图函数中的第二个参数删除，我会得到未定义的变量，并且无法在我的 index.view.php 页面上访问 $data。

**索引.php**

```
<?php

require('function.php');    
$data = array('item0', 'item1', 'item3');    
view('index', $data); 
```

**index.view.php**

```
<?php
    foreach($data as $item) {
        echo $item;
    }
?> 
```

**函数.php**

```
function view($path, $data) {
    include($path . '.view.php');
} 
```

我在这里有点困惑，因为每当我从视图函数中删除 $data 变量作为第二个参数并在我的索引文件中替换**view('index', $data);** 包含**（'view.index.php'）；**$data 变量正像预期的那样从 index.php 传递到 index.view.php。

但是当我在没有 $data 参数的情况下放回视图函数时，我得到了未定义的变量数据。我认为我的视图函数与**include('view.index.php');完全相同。**?

希望这是有道理的，有人可以向菜鸟解释发生了什么，否则我会尝试改写一下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T22:48:50.247

将包含视为复制和粘贴调用包含的代码主体。

如果您复制并粘贴所有包含和要求所在的代码主体，您会得到：

```
function view($path, $data) {
    foreach($data as $item) {
        echo $item;
    }
}  
$data = array('item0', 'item1', 'item3');
view('index', $data); 
```

该代码应该可以工作，但是如果您`$data`从 view() 函数中删除参数，则会得到不同的结果：

```
function view($path) {
    // $data doesn't exist here, not local to the function.
    // The foreach() loop therefore is trying to access $data variable which doesn't exist.
    foreach($data as $item) {
        echo $item;
    }
}
$data = array('item0', 'item1', 'item3');    
view('index'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T22:50:22.157

> 我认为我的视图函数与 include('view.index.php'); 完全一样？

正如你已经证明的那样，事实并非如此。

```
<?php
$data = array('item0', 'item1', 'item3');    
include('view.index.php'); 
```

在这个例子中，看到的变量范围[是](http://php.net/manual/en/language.variables.scope.php).`view.index.php``{$data}`

```
<?php
$foo = "hello world"; // note this extra variable
$data = array('item0', 'item1', 'item3');    
view('index', $data);
function view($path, $data) {
    include($path . '.view.php');
} 
```

在这个例子中，`view.index.php`看到的变量范围是`{$path, $data}`. 这是因为`include`发生在函数的范围内。

```
<?php
$data = array('item0', 'item1', 'item3');    
view('index');
function view($path) {
    include($path . '.view.php');
} 
```

因此，在此示例中，变量范围`view.index.php`为`{$path}`.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-17T22:50:17.517

您必须设置默认值才能允许调用`view('index');`

```
function view($path, $data = array()) {
    // Do some stuff
    include($path . '.view.php');
} 
```

如果你想让你的全局变量在你的函数中可见，使用`global`

```
function view($path) {
    global $data;
    include($path . '.view.php');
} 
```

# asp.net - 如何显示请求的查询字符串以及 aspxerrorpath

> ID：15467037
> 
> 赞同：1
> 
> 时间：2013-03-17T22:30:05.947
> 
> 标签：asp.net

我在 asp.net 和 web.config 中有一个 Web 应用程序，它是写的

```
<customErrors mode="On" defaultRedirect="error.aspx" /> 
```

假设我有一个页面`abcd.aspx`。我已经在浏览器中发送了一个请求`abcd.aspx?p1=cvb&p2=dfg`

现在，如果发生任何错误，它会重定向到`error.aspx?aspxerrorpath=abcd.aspx.` 但我想通过`p1`，`p2`以及。IE `error.aspx?aspxerrorpath=abcd.aspx&p1=cvb&p2=dfg`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T22:32:31.023

我建议查看[ELMAH](https://code.google.com/p/elmah/)以获取 asp.net 错误日志记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:51:09.393

你不能，这是内部函数调用的一部分，你不能改变它。这是使重定向及其`this.Request.Path`参数不包含完整 url 的函数。

```
internal bool RedirectToErrorPage(string url, CustomErrorsRedirectMode redirectMode)
{
    try
    {
        if (string.IsNullOrEmpty(url))
        {
            return false;
        }
        if (this._headersWritten)
        {
            return false;
        }
        if (this.Request.QueryString["aspxerrorpath"] != null)
        {
            return false;
        }
        if (redirectMode == CustomErrorsRedirectMode.ResponseRewrite)
        {
            this.Context.Server.Execute(url);
        }
        else
        {
            if (url.IndexOf('?') < 0)
            {
                url = url + "?aspxerrorpath=" + HttpEncoderUtility.UrlEncodeSpaces(this.Request.Path);
            }
            this.Redirect(url, false);
        }
    }
    catch
    {
        return false;
    }
    return true;
} 
```

再说几句。
当您到达该错误页面时，您将失去控制，这意味着您遇到了编程错误或一些未处理的异常。该错误记录在您的 EventViewer 上，但您也可以使用`Application_Error`global.asax 上的个人记录它并将其写入您的日志文件。

相对：
[如何在 asp.net 应用程序中捕获未处理的异常？](https://stackoverflow.com/questions/10968370/how-to-catch-unhandled-exceptions-in-an-asp-net-application/10968500#10968500)
[如何在我的 ASP.NET 应用程序中创建一个“一般错误”页面，以便它处理在提供该页面本身时触发的错误？](https://stackoverflow.com/questions/10751363/how-do-i-make-a-generic-error-page-in-my-asp-net-application-so-that-it-handle/10751939#10751939)

# c++ - 在编译和链接时，不同的 C/C++ 模块之间有什么通信？

> ID：15467038
> 
> 赞同：0
> 
> 时间：2013-03-17T22:30:06.323
> 
> 标签：c++, boost, g++

我正在编写一个程序的三个主要部分，例如：startwrapper.cpp deviceAcomms.cpp deviceBcomms.cpp

应用程序从一种设备读取数据，然后使用不同的协议（管理客户端）将数据提供给另一台设备。

startwrapper 基本上控制作为守护进程启动应用程序、将 i/o 重定向到 syslog、捕获信号等。在设置守护进程环境后，它调用 deviceAcomms 的 StartServer 方法并传入 argv/argc。

我的问题是我试图查看 Boost 程序选项库是如何存储和处理命令行选项的，但是当我对 syslog 进行额外调用时，/var/log/messages 中没有出现任何新内容。

那么，第二个线程是否可以访问 syslog 调用，还是必须将其传递给下一个方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:01:35.377

是的，第二个线程应该可以使用`syslog`. 通过 POSIX 规范`syslog`应该是线程安全的，所以你的问题可能在其他地方。

# javascript - JavaScript 范围查询？

> ID：15467039
> 
> 赞同：2
> 
> 时间：2013-03-17T22:30:14.410
> 
> 标签：javascript

```
var my_var = 3;

function doIt() {

    console.log( my_var ); //why undefined?

    var my_var = 7;

    return ++my_var; 
} 

doIt(); // returns 8 as expected 
```

为什么 my_var 返回*未定义*而不是全局值 (3)？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-17T22:31:30.830

您在函数内部定义`my_var`为局部变量。JavaScript将变量[提升](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)到作用域的顶部，因此您的函数实际上是这样的：

```
function doIt() {
    var my_var;

    console.log( my_var );

    my_var = 7;

    return ++my_var; 
} 
```

# c++ - 易失性但不受保护的读取能否产生无限期的陈旧值？（在真实硬件上）

> ID：15467042
> 
> 赞同：28
> 
> 时间：2013-03-17T22:30:58.887
> 
> 标签：c++, multithreading, c++11, atomic, volatile

在回答[这个问题](https://stackoverflow.com/questions/15445758/jmp-to-self-instruction-compiled-by-gcc4-4-6-3/)时，出现了一个关于 OP 情况的进一步问题，我不确定：这主要是一个处理器架构问题，但也有一个关于 C++ 11 内存模型的连锁问题。

基本上，由于以下代码（为简单起见稍作修改），OP 的代码在更高的优化级别无限循环：

```
while (true) {
    uint8_t ov = bits_; // bits_ is some "uint8_t" non-local variable
    if (ov & MASK) {
        continue;
    }
    if (ov == __sync_val_compare_and_swap(&bits_, ov, ov | MASK)) {
        break;
    }
} 
```

`__sync_val_compare_and_swap()`GCC 的原子 CAS 内置在哪里。`bits_ & mask`在进入循环之前检测到的情况下，GCC（合理地）将其优化为无限循环，`true`完全跳过 CAS 操作，因此我建议进行以下更改（可行）：

```
while (true) {
    uint8_t ov = bits_; // bits_ is some "uint8_t" non-local variable
    if (ov & MASK) {
        __sync_synchronize();
        continue;
    }
    if (ov == __sync_val_compare_and_swap(&bits_, ov, ov | MASK)) {
        break;
    }
} 
```

在我回答之后，OP 指出更改`bits_`为`volatile uint8_t`似乎也有效。我建议不要走那条路，因为`volatile`通常不应该用于同步，而且在这里使用栅栏似乎没有太大的缺点。

但是，我想得更多，在这种情况下，语义是这样的，即`ov & MASK`检查是否基于陈旧值并不重要，只要它不是基于无限期陈旧的值（即只要循环最终被打破），因为实际的更新尝试`bits_`是同步的。那么，对于任何现有的处理器，如果由另一个线程更新，那么`volatile`这里足以保证这个循环最终终止吗？换句话说，在没有显式内存栅栏的情况下，实际上是否可以无限期地由处理器有效地优化未由编译器优化的读取？（**编辑：**`bits_``bits_ & MASK == false`**为了清楚起见，我在这里询问现代硬件实际上可能会做什么，因为假设读取是由编译器在循环中发出的，所以这在技术上不是一个语言问题，尽管用 C++ 语义表达它很方便。）**

 **这是它的硬件角度，但要稍微更新它并使其也成为有关 C++11 内存模型的可回答问题，请考虑对上述代码进行以下变体：

```
// bits_ is "std::atomic<unsigned char>"
unsigned char ov = bits_.load(std::memory_order_relaxed);
while (true) {
    if (ov & MASK) {
        ov = bits_.load(std::memory_order_relaxed);
        continue;
    }
    // compare_exchange_weak also updates ov if the exchange fails
    if (bits_.compare_exchange_weak(ov, ov | MASK, std::memory_order_acq_rel)) {
        break;
    }
} 
```

[cppreference](http://en.cppreference.com/w/cpp/atomic/memory_order)声称这`std::memory_order_relaxed`意味着“对围绕原子变量的内存访问的重新排序没有限制”，因此独立于实际硬件会或不会做什么，确实意味着在符合实现的另一个线程上更新后，从`bits_.load(std::memory_order_relaxed)`技术上讲**永远不会**读取更新的值`bits_`?

**编辑：**我在标准（29.4 p13）中找到了这个：

> 实现应该使原子存储在合理的时间内对原子负载可见。

因此，显然等待更新值“无限长”（大部分？）是不可能的，但是除了应该“合理”之外，没有任何具体的新鲜时间间隔的硬性保证；尽管如此，关于实际硬件行为的问题仍然存在。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-17T23:05:42.877

C++11 原子处理**三个**问题：

1.  确保在没有线程切换的情况下读取或写入完整的值；这可以防止撕裂。

2.  确保编译器不会在原子读取或写入的线程内重新排序指令；这确保了线程内的排序。

3.  确保（对于适当的内存顺序参数选​​择），将在原子写入之前写入线程中写入的数据，将通过读取原子变量并看到所写值的线程看到。这是可见性。

当您使用时，`memory_order_relaxed`您无法从轻松的存储或加载中获得可见性保证。你确实得到了前两个保证。

实现“应该”（即被鼓励）使内存写入在合理的时间内可见，即使是放松的排序。这是可以说的最好的了；这些事情迟早会出现。

因此，是的，正式地，从不让轻松写入对轻松读取可见的实现符合语言定义。在实践中，这不会发生。

至于做什么`volatile`，请询问您的编译器供应商。这取决于实施。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-17T23:11:47.113

`std::memory_order_relaxed`从技术上讲，负载永远不会为负载返回新值是合法的。至于是否有任何实现会这样做，我不知道。

参考： http: [//www.developerfusion.com/article/138018/memory-ordering-for-atomic-operations-in-c0x/](http://www.developerfusion.com/article/138018/memory-ordering-for-atomic-operations-in-c0x/) *“唯一的要求是不能从同一个线程访问单个原子变量重新排序：一旦给定线程看到原子变量的特定值，该线程的后续读取将无法检索该变量的早期值。”*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-18T00:53:25.097

如果处理器没有缓存一致性协议或者它非常简单，那么它可以“优化”从缓存中获取陈旧数据的负载。现在大多数现代多核 CPU 都实现了缓存一致性协议。但是A9之前的ARM没有。非 CPU 架构也可能没有缓存一致性（尽管它们可能不符合 C++ 内存模型）。

另一个问题是许多架构（包括 ARM 和 x86）允许重新排序内存访问。我不知道处理器是否足够聪明，可以注意到对同一地址的重复访问，但我对此表示怀疑（在极少数情况下会花费空间和时间，因为编译器应该能够注意到它，但好处很小，因为以后的访问可能会是 L1 命中），但从技术上讲，它可以推测将采用分支，并且它可以在第一个访问之前重新排序第二个访问（不太可能，但如果我正确阅读 Intel 和 ARM 手册，这是允许的）。

最后，还有一些不符合缓存一致性的外部设备。如果 CPU 通过内存映射 IO/DMA 进行通信，则该页面必须标记为不可缓存（否则在 L1/L2/L3/... 缓存中的数据将是陈旧的数据）。在这种情况下，处理器通常不会重新排序读取和写入（有关详细信息，请参阅您的处理器手册 - 它可能具有更细粒度的控制） - 编译器可以因此您需要使用`volatile`. 但是，由于原子通常是基于缓存的，因此您不需要或可以使用它们。

恐怕我无法回答未来的处理器是否会提供如此强大的缓存一致性。我建议严格遵循规范（“将指针存储在 int 中有什么问题？肯定没有人会使用超过 4GiB 的用户，因此 32b 地址足够大。”）。正确性由其他人回答，所以我不会包括它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-18T00:41:24.693

这是我对它的看法，虽然我对这个话题了解不多，所以对它持保留态度。

关键字效果很可能取决于编译器`volatile`，但我会假设它实际上做了我们直观的期望，即避免别名或任何其他不会让用户在调试器中随时检查变量值的优化在该变量的生命周期内执行。这与关于 volatile 含义的[答案](https://stackoverflow.com/a/3604623/1769720)非常接近（并且可能相同） 。

直接的含义是任何访问该`volatile`变量的代码块`v`都必须在修改它后立即将其提交到内存中。Fences 将使它与其他更新一起按顺序发生，但无论哪种方式，如果在源级别进行修改，则`v`在程序集输出中将有一个存储。`v`

实际上，您要问的问题是，如果`v`加载到寄存器中的 没有被某些计算修改，那么是什么迫使 CPU`v`再次执行对任何寄存器的读取，而不是简单地重用它之前已经获得的值。

我认为答案是 CPU*不能*假设存储单元从上次读取时没有改变。即使在单核系统上，内存访问也不是严格保留给 CPU 的。许多其他子系统可以读写访问它（这是[DMA](http://en.wikipedia.org/wiki/Direct_memory_access)背后的原理）。

CPU 可以做的最安全的优化可能是检查缓存中的值是否更改，并将其用作`v`内存状态的提示。缓存应该保持同步。由于 DMA 附带的缓存失效机制，因此具有内存。在这种情况下，问题会回到[多核上的缓存一致性](http://www.windowsnetworking.com/articles-tutorials/common/Cache-Coherency.html)，以及多线程情况下的“写后写”。最后一个问题不能用简单`volatile`的变量有效地处理，因为它们的修改操作不是原子的，正如你已经知道的。**

# html - 子 DOM 元素大小不正确

> ID：15467043
> 
> 赞同：2
> 
> 时间：2013-03-17T22:30:59.887
> 
> 标签：html, css

我已经构建了大量的 div，其中有一个作为包装器的父元素，其中一个子元素将调整为父元素的一部分，然后滚动以溢出，但由于某种原因无法获得这个特定的权利。

我有一个父容器->第一个孩子是标题->第二个孩子包含内容并且大小可以填充父容器-标题。

我已经将父级定位为绝对并附加到 document.body 以便它可以填充整个屏幕减去一点宽度和高度。

当我调整我的内容元素的大小以在超过给定高度时滚动时，行为就好像它根本没有父级，甚至没有 document.body。宽度完美；但是，仅在将高度设置为百分比时才会发生不良行为，如果以像素为单位设置则有效。但是在这种特定情况下，由于填充了整个屏幕，我需要以百分比设置高度，而且人们有很多不同类型的屏幕，具有不同的像素设置。

blueprintsViewer div 大小正确。

printContainer div 溢出 blueprintsViewer 并超过屏幕高度。行为与我没有正确设置它的位置或它的父位置一样。

```
<div id="blueprintsViewer" style="max-width: 98.75%; max-height: 98%;">

  <div class=" blueprintsHead"><span class=" rndClose" title="Close"></span><a class=" acLink" title="Append door schedule">Door schedule</a></div>

  <div class=" printContainer" style="max-height: 75%;"><img src="/api/drawings a=e&amp;id=4309"><img src="/api/drawings?a=d&amp;id=4309"></div>

</div> 
```

--这是.css样式

```
 #blueprintsViewer {
    position: absolute;
    top: 5px;
    left: 10px;
    padding: 10px;
    height:auto;
    overflow:visible;
    background-color: rgba(45, 45, 45, 0.65);
    border-radius: 5px;
    -moz-border-radius: 5px;
    z-index: 20001;
    -webkit-background-clip: padding-box;
    -moz-background-clip: padding;
    background-clip: padding-box;
    -webkit-box-shadow: 0 4px 12px rgba(0,0,0,.4),inset 0 1px 0 rgba(255,255,255,.5);
    -moz-box-shadow: 0 4px 12px rgba(0,0,0,.4),inset 0 1px 0 rgba(255,255,255,.5);
    box-shadow: 0 4px 12px rgba(0,0,0,.4),inset 0 1px 0 rgba(255,255,255,.5);

}

   .blueprintsHead {
        width: 100%;
        height: 40px;
        position:relative;
        /*cursor: move;*/
        padding: 2px;
        background-color: #fff;
        border-bottom: 2px groove #39c;
        background-image: url(in25.png);
        background-repeat: no-repeat;
        background-position: 5px center;
        text-align: right;
        border-top-right-radius: 3px;
        border-top-left-radius: 3px;
        -moz-border-radius-topleft: 3px;
        -moz-border-radius-topleft: 3px;
    }

        .blueprintsHead > a {
            text-decoration: underline;
            margin-right: 4em;
            margin-top: 1em;
            padding: .2em;
            display:block;
            width:80px;
        }
    .blueprintsHead >span.rndClose {zoom:1.4 !important; top:5px;right:5px;}
    #blueprintsViewer img {
        margin-bottom:10px;
    }

    #blueprintsViewer .printContainer {
        position: relative;
        margin: 5px;
        margin-left:-1px;
        width: 100%;
        overflow:scroll;
    } 
```

--这是一个屏幕快照。

在较暗背景下方的屏幕截图中，父级“div#blueprintsViewer”和 div.printContainer 溢出了 div#blueprintsViewer，这是我想要克服的行为。

![溢出的屏幕快照](../Images/f55b313ebb44d39d9c354410ff9d5c07.png)

---------------------------------工作查看器的快照--------- ------------

![帮助后正确大小的蓝图查看器](../Images/5a9e0006626c22feec3f2615c7e4eece.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:08:02.470

这不可能。css 规范说，仅当显式指定包含块的高度时，才可能以百分比表示高度值。

见[http://www.w3.org/TR/CSS21/visudet.html#the-height-property](http://www.w3.org/TR/CSS21/visudet.html#the-height-property)

在您的示例中，div.printContainer 的高度计算为“auto”，因为 div#blueprintsViewer 的高度没有明确设置，而是取决于内容高度。因此 div.printContainer 高度适合其内容，因此没有滚动条处于活动状态。

但是你可以把它`overflow: auto;`放在 div#blueprintsViewer 中。不要忘记设置`html,body{height: 100%;}`。你`position: absolute`在 div#blueprintsViewer 上需要什么？改用边距。

见[http://jsfiddle.net/QxUWW/2/](http://jsfiddle.net/QxUWW/2/)

# jquery - 为什么要添加“助手：”克隆“；” 到这个 ui-draggable 元素防止它被拖动？

> ID：15467050
> 
> 赞同：2
> 
> 时间：2013-03-17T22:32:03.300
> 
> 标签：jquery, html, jquery-ui, draggable, pseudo-element

我想要的只是`<ul>`在它的子元素上出现一个带有盒子阴影的盒子`<li>`，并且这些元素可以在`<ul>`.

这是一个[jsfiddle](http://jsfiddle.net/rrETm/3/)，这是代码：

HTML：

```
<ul class="shadowed">
    <div class="dragMe"></div>
</ul> 
```

CSS：

```
.shadowed {
    width: 256px;
    height: 64px;
    margin: 100px;
    background: #777;
}

.shadowed:before { 
    content: "";
    width: 256px; 
    height: 64px;
    position: absolute;
    margin: 100px;
    top: 0; 
    left: 0;
    box-shadow: inset 0px 0px 10px 2px #000;
}

.dragMe {
    width: 64px;
    height: 64px;
    background: red;
} 
```

JAVASCRIPT：

```
$(function() {
    $( ".dragMe" ).draggable({

        /* try dragging the red square, then remove this line and try again. */
        helper: "clone",

        revert: "invalid",
        stack: ".dragMe"
    });

    $( ".shadowed" ).droppable().sortable().disableSelection();   
}); 
```

在这个例子中，我有`<ul>`一个孩子`<li>`（红色框）。“`<ul>`具有”一个伪元素形式的盒子阴影，以使阴影出现在子元素上。

红框——在通过 jQuery-UI 可拖动之前——按预期出现在阴影下方。但是，在使该元素可拖动时，它会出现在阴影上方。在此状态下拖动红色框按预期工作。

**为什么使元素可拖动将其放置在阴影前面？**

此外，给红色框 a`helper: "clone"`将其放回阴影下方，但防止它被拖动。

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T03:51:56.063

因此，元素顶部的框阴影覆盖使下面的 div 不可点击。

我更新了 jsfidle 示例，通过添加另一个 div 和制作另一个 mod 来明确这一点

```
 <div class="dragMe"> </div> 
```

[http://jsfiddle.net/rrETm/4/](http://jsfiddle.net/rrETm/4/)

一种可能的补救方法是拦截点击，隐藏框阴影覆盖然后模拟点击，然后重新显示框阴影，但看起来有点复杂。开始使用这种方法的一些代码在下面的链接示例中。

[Jquery通过点击元素](https://stackoverflow.com/questions/5398787/jquery-pass-click-through-element)

# java - LibGDX 没有运行 render() 方法

> ID：15467053
> 
> 赞同：5
> 
> 时间：2013-03-17T22:32:25.730
> 
> 标签：java, android, libgdx

我在使用 LibGDX 时遇到问题。

我有一个`Screen`并且在它的`render`方法中我有：

```
public class LoadingScreen implements Screen{
private OrthographicCamera guiCam;
private TankChallenge tankChallenge;
private SpriteBatch batcher;
private GL10 OpenGL;

public LoadingScreen(TankChallenge tankChallenge) {
    this.tankChallenge=tankChallenge;
    Gdx.graphics.setTitle("RobotChallange Beta - Loading");

    float AR = Gdx.graphics.getHeight()/Gdx.graphics.getWidth();
    guiCam = new OrthographicCamera(10,10 * AR);
    guiCam.position.set(10f/2,AR*10f/2,0);
    batcher = new SpriteBatch();

    OpenGL = Gdx.graphics.getGL10();
    //loadAssets();
}

@Override
public void render(float delta) {
    OpenGL.glClearColor(1, 0.5f, 1, 1);
    OpenGL.glClear(GL10.GL_COLOR_BUFFER_BIT);

    System.out.print("e");
    guiCam.update();
    Sprite sp = new Sprite();
    sp.setColor(1f,1f,0, 1);
    sp.setSize(100,100);
    sp.setOrigin(20, 0);

    batcher.setProjectionMatrix(guiCam.combined);
    batcher.begin();
    batcher.disableBlending();
    sp.draw(batcher);
    batcher.end();
} 
```

我通过在实现`ApplicationListener`类中设置它来调用它。我知道它正在到达 LoadingScreen，因为 Title 实际上设置为“RobotChallenge Beta - Loading”。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-01T09:42:57.643

我找到了解决这两个问题的方法。我在游戏扩展类中添加了这个：

```
public void render() {
    super.render();
} 
```

由于这个问题解决了，我不需要重写 SetScreen 方法。谢谢！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T00:49:13.890

将其设置为您的屏幕后，您需要立即调用`super.render()`您的`Game`扩展类。例如，我在我的主`Game`扩展类中使用以下方法来设置屏幕：

```
@Override
public void setScreen(Screen screen)
{
    super.setScreen(screen);
    super.render();
} 
```

这似乎开始`render()`被调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-31T23:56:52.023

只需在 Game 扩展类中删除 @Override render() 即可解决问题。覆盖 setScreen 方法会导致您提到的闪烁。

# c++ - wxWidgets wxTextCtrl 删除时崩溃

> ID：15467055
> 
> 赞同：-1
> 
> 时间：2013-03-17T22:32:31.193
> 
> 标签：c++, visual-studio-2010, wxwidgets

wxTextCtrl 在尝试删除或更改其值时会导致一些内存分配问题。以下是一些代码见解：

```
 wxTextCtrl* s = new wxTextCtrl(...);
    s->SetValue("abc");//crash
    delete s//crash 
```

就好像它的所有成员都是 const 的。这是 VisualStudio 在崩溃时所说的：

```
 An unhandled exception of type 'System.AccessViolationException' 
    occurred in Unknown Module.

    Additional information: Attempted to read or write protected memory. 
    This is often an indication that other memory is corrupt. 
```

即使我尝试使用 wxWidgets 默认销毁：

```
 parent->DestroyChildren(); //ofc the parent is wxPane passed in constructor of s 
```

任何帮助将不胜感激。

下面是调用 wxTextCtrl 的唯一函数的一些实际代码：

```
 void AddButton::OnAction(wxSize* frame){

if ( !DoAction ){
    if ( ! thy )
    {

        thy = new wxPanel
            (mParent, -1, 
            wxPoint(0, 0),
            wxSize(PanelWidth, mParent->GetSize().GetHeight()), 
            wxBORDER_NONE | wxFRAME_FLOAT_ON_PARENT );
        thy->SetBackgroundColour(wxColor(30,30,30));
        thy->Show();
        if ( ! AddPanelDialog ){
            //AddPanelDialog = (new _Text
                //(this, thy, "add link...", wxPoint(1, 30), wxSize(PanelWidth - 30, 20),
                //wxBORDER_NONE | wxTE_PROCESS_ENTER ));
            wxTextCtrl* s = new wxTextCtrl(thy, -1, "", wxPoint(1, 30), wxSize(PanelWidth - 30, 20),
                wxBORDER_NONE | wxTE_PROCESS_ENTER );
            s->Connect(wxEVT_COMMAND_TEXT_ENTER, wxCommandEventHandler(_Text::OnEnter));
            s->Show();
        }
        if ( !ConfirmPanel ){
            ConfirmPanel = new wxPanel
                (thy, -1, wxPoint(PanelWidth - 28, 30), wxSize(27, 20), 
                wxBORDER_NONE | wxFRAME_FLOAT_ON_PARENT );
            ConfirmPanel->SetBackgroundColour(wxColor(38, 145, 232));
            ConfirmPanel->Show();
        }

    }
    else {
        thy->Show();
    }
    gui* rmd = (gui*)mParent;
    rmd->LeftPanelActivate();
    rmd->SetNewPositions(rmd->GetParent()->GetSize());
    Button::Update();
    helper::SendRedrawEvent(mParent);
    DoAction = true; // indicates action activated
}
else{
    thy->Hide();
    gui* rmd = (gui*)mParent;
    rmd->LeftPanelActivate(false);
    rmd->SetNewPositions(rmd->GetParent()->GetSize());
    Button::Update();
    helper::SendRedrawEvent(mParent);
    DoAction = false; // indicates action activated
}
    } 
```

和调用 SetValue() 的函数

```
 void AddButton::OnEnter(wxCommandEvent& event)//enter button handler
   {
       wxTextCtrl* _t = (wxTextCtrl*)this;
       _Clear();
       *_t<<"sup";
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:21:33.753

我认为您对`Connect()`. 如果您使用它连接到不同对象的方法，则**必须**将指向该对象的指针作为最后一个参数（`eventSink`在[文档](http://docs.wxwidgets.org/trunk/classwx_evt_handler.html#a78719e8b82c9f9c6e4056b3449df1943)中调用）传递。几乎可以肯定您的方法是在错误的对象指针上调用的。

而且你绝对不应该`this`像你在`OnEnter()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T22:47:33.243

你确定你真的需要删除 wxTextCtrl 吗？如果这个文本控件被放到sizer 中，那么sizer 负责它，并在需要时销毁它。您可能需要从 sizer 中分离文本控件，然后将其删除。此外，您应该使用[Destroy()](http://docs.wxwidgets.org/trunk/classwx_window.html#a6bf0c5be864544d9ce0560087667b7fc)方法而不是`delete`运算符。这在文档中有明确的解释。

至于`SetValue()`随叫随到：你试过用`wxT("abc")`吗？另外，您使用的是什么版本的 wxWidgets、操作系统和编译器？wxWidgets 根本没有遇到过这样的问题。也许您可以发布一些有意义的代码来帮助识别问题？

# javascript - 可拖动在 Chrome/Safari 中无法正常工作

> ID：15467070
> 
> 赞同：3
> 
> 时间：2013-03-17T22:33:36.243
> 
> 标签：javascript, jquery, draggable, jquery-ui-draggable, jquery-draggable

每当您尝试拖动需要向下滚动才能查看的图像（第一次加载时不可见的任何内容）时，图像都会被拍摄到页面顶部，而不是停留在光标上。这只发生在 Chrome 或 Safari 中，在 Firefox 中效果很好。我已经尝试过 Draggable 之外的方法来解决这个问题，但它们只会导致额外的问题。

这是所需代码的最简单版本，我只是找不到要使用的正确类，但答案必须在[此处](http://api.jqueryui.com/draggable/)

```
 $( "img" ).draggable({ stack: "img" }); 
```

我相信它使用 jquery-ui-1.10.0.custom.min.js 进行拖动功能。

这是正在测试的 URL：http: [//julian-berman.com/test/2/](http://julian-berman.com/test/2/)

所以它几乎不知道如何在初始窗口容器之外重新调整图像的 Y 位置，而且我一生都无法弄清楚如何做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:14:16.027

将图像位置从 更改`relative`为 有`absolute`帮助。但我认为您应该尝试使可拖动的不是图像，而是其父 div。所以：

```
$(".photo").draggable({ handle: "img", stack: ".photo" }); 
```

# javascript - 应该听捏捏和捏出的JS不起作用

> ID：15467073
> 
> 赞同：0
> 
> 时间：2013-03-17T22:34:09.640
> 
> 标签：javascript, jquery, multi-touch, gestures, hammer.js

我正在尝试在捏合身体时执行一个功能，然后在捏出时执行另一个功能。由于我已经在本文档中使用 jquery.hammer.js 并且hammer 可以监听进出捏，我认为最好使用它来监听捏。但是，我暂时不运行这些函数，而是只运行警报。

这似乎应该可以工作，但是当我捏捏捏捏时，不会触发警报。

我究竟做错了什么？

这是我的代码：

```
<!Doctype HTMl>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Pinch me!</title>
    </head>
    <body>

        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script type="text/javascript" src="//raw.github.com/EightMedia/hammer.js/master/dist/jquery.hammer.min.js"></script>
        <script type="text/javascript">
        var element = $('body').get();
        var hammertime = Hammer(element).on("pinchin", function(event) {
            alert("pinch in!");
        });
        var hammertimes = Hammer(element).on("pinchout", function(event) {
            alert("pinch out!");
        });
        </script>
    </body>
</html> 
```

我将非常感谢任何帮助让这些警报在捏入和捏出时触发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T22:46:55.583

我认为您的脚本格式错误？[.get()](http://api.jquery.com/jQuery.get/)用于进行 Ajax 调用。要选择一个元素，只需将其包装在 jQuery 选择器中。

尝试像这样设置元素 -

```
var element = $('body'); 
```

我也不清楚为什么在这个简单的示例中将捏事件绑定到变量，但它不应该阻止它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T22:48:43.397

你在这里不需要 jQuery。只需使用`Hammer(document.body).on(...)`

# google-chrome-extension - 将“n”拖放文件拖放到 Chrome 包应用程序？

> ID：15467074
> 
> 赞同：6
> 
> 时间：2013-03-17T22:34:11.507
> 
> 标签：google-chrome-extension, google-chrome-app

有没有人成功地将文件从桌面拖放到应用程序？

我尝试将[这个拖放示例](http://html5demos.com/dnd-upload)放入索引文件中，但我只是收到此错误：

```
Can't open same-window link to "file:///C:/Users....whatever"; try target="_blank". 
```

请分享您的故事，您尝试过的内容以及是否成功**:)**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:59:58.490

一些可以帮助您的资源：

我们一直在研究的新 Chrome 打包应用程序代码实验室涵盖了 AngularJS 和纯 JavaScript 中的拖放。

AngularJS 拖放：[https ://github.com/GoogleChrome/chrome-app-codelab/tree/master/lab5_data/angularjs/2_drop_files](https://github.com/GoogleChrome/chrome-app-codelab/tree/master/lab5_data/angularjs/2_drop_files)

JavaScript 拖放：[https ://github.com/GoogleChrome/chrome-app-codelab/tree/master/lab5_data/javascript/2_drop_files](https://github.com/GoogleChrome/chrome-app-codelab/tree/master/lab5_data/javascript/2_drop_files)

在 developer.chrome.com/trunk/apps/app_codelab5_data.html#handle_drag_and_dropped_files_and_urls 上也有用于 AngularJS 拖放的早期版本文档

不过，我们正在研究文档以涵盖这两个示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T05:08:14.137

我前一阵子做过这个，它奏效了。

您遇到的问题是您正在创建一个文件 url，然后尝试导航到该 url。导航失败，而不是阅读。它由于 CSP 而失败，并且由于我们对允许的 CSP 施加的安全限制，您可能无法使用不同的 CSP 覆盖它。

但是，您应该能够只读取文件并使用内容。您需要更改该示例代码以使用 ReadAsText 或 ReadAsArrayBuffer 而不是 readAsDataURL。[在这里](http://www.w3.org/TR/FileAPI/#reading-a-file)查看更多详细信息。

请让我们知道您的进展情况！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-07T19:35:27.227

只听是`drop`行不通的。您将不得不阻止`dragover`.

```
document.body.addEventListener('dragover', function(e) {
  e.preventDefault();
}

document.body.addEventListener('drop', function(e) {
  alert('it works!')
} 
```

# c++ - C++ Break omp 并行用于

> ID：15467075
> 
> 赞同：1
> 
> 时间：2013-03-17T22:34:14.767
> 
> 标签：c++, parallel-processing, openmp

这是我的主要猎人的一部分。我想在条件满足并且 b 设置为 false 之后尽快打破 omp 并行：

```
#pragma omp parallel for
for( long l = 1; l <= n; l++ ) {
if (m % p[l] == 0) {
b = false;
*// Break omp parallel for*}
} 
```

我试图通过循环来实现这一点，但我无法弄清楚。请问有人可以帮我修改吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T22:43:21.727

我相信唯一的方法是添加一个失败变量，但它不会给你任何性能提升；

```
#pragma omp parallel for
for( long l = 1; l <= n; l++ ) {
    if (b) {
        if (m % p[l] == 0) {
            b = false;
        }
    }
} 
```

如果它真的会那么长，最好将循环分成几段；

```
#pragma omp parallel for
for( long l = 1; l < n / 2; l++ ) {
    if (m % p[l] == 0) {
        b = false;
    }
}
if (b) {
    #pragma omp parallel for
    for( long l = n / 2; l <= n; l++ ) {
        if (m % p[l] == 0) {
            b = false;
        }
    }
} 
```

只需将其拆分为您认为最好的数量即可。

对于使用手动线程（但允许`break`ing）的更复杂的答案，请参阅此答案：[https ://stackoverflow.com/a/9813239/1180785](https://stackoverflow.com/a/9813239/1180785)

# php - 在 jquery click 命令上调用 mysql 数据库

> ID：15467077
> 
> 赞同：0
> 
> 时间：2013-03-17T22:34:43.937
> 
> 标签：php, jquery, mysql

我已经在网上搜索过，也许我忽略了答案，但是几天前我遇到了这个问题，我无法解决。

我正在尝试在 jQuery 中创建一个下拉菜单。当您将鼠标悬停在从 sql 数据库生成的类别上时，它应该只显示该类别中的所有列表项。作为解决方案，我想在我的 jQuery 中对每个列表 id 项进行查询，我通过 .

这是我的代码：

```
find_li.on('click', function()
    {
        //sub_menu.fadeIn(200);
        var dir = $(this).data('dir');

        console.log(dir);

        if (dir == 1)
        {
            console.log("1");

            //first query here    

        }
        else if (dir == 2)
        {
            console.log("2");
            //second query here
        }

    }); 
```

所以我想从数据库中通过 ID 获取正确的类别。有没有办法在每次鼠标悬停时按 ID 对每一行进行排序？

我希望我说清楚了。

谢谢。

# post - Paypal IPN 通过 GET 而不是 POST 发送数据，即使 rm 值为 2

> ID：15467081
> 
> 赞同：0
> 
> 时间：2013-03-17T22:35:30.600
> 
> 标签：post, paypal, notifications, paypal-ipn

我已经完全按照应该编码的方式对贝宝 IPN 进行了编码，包括确认页面。一切都在沙箱中完美运行，但在真实环境中，即使在保持 rm 值 =2 之后，paypal 仍然通过 GET 而不是 post 发送数据。所以我阅读了一些文章并更改了自动返回。它仍然通过GET返回，然后我再次将自动返回更改为关闭，它仍然通过GET返回......

我需要通过 POST 获得的信息，包括我传递的变量...有人请在这里帮助我....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T22:40:02.837

您是否在 GoDaddy 上使用共享主机托管？您的主机可能不允许来自 3rd 方服务器的 POST 请求？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T01:41:25.887

确保您的帐户中没有启用 PDT 的自动退货功能。这将导致帖子成为 GET。如果您在代码中传递返回 URL 并将变量“rm”设置为“2”，它应该作为帖子返回。如果这仍然不起作用，您能否提供您正在使用的按钮代码，以便我查看代码和帐户。

我刚刚用我的帐户对此进行了测试，它工作正常。

# c# - 无法删除该对象，因为它在 ObjectStateManager #2 中找不到

> ID：15467087
> 
> 赞同：1
> 
> 时间：2013-03-17T22:35:55.493
> 
> 标签：c#, .net, wpf, database, entity-framework

我在屏幕截图中遇到了问题： ![问题](../Images/fa5fef08078f65a5de3e74a3e52159ad.png)

这是程序开头的代码：

```
 public MainWindow()
    {
        InitializeComponent();

        BlackoutDates();

        variables.date = Convert.ToDateTime(MainCalendar.DisplayDate);
        DateOutput.Content = MainCalendar.DisplayDate.DayOfWeek + ", " + MainCalendar.DisplayDate.ToShortDateString();

    }

    //initialises entities
    WpfApplication7.AllensCroftEntities1 allensCroftEntities1 = new WpfApplication7.AllensCroftEntities1();
    private Booking ObjectIndex; 
```

这是加载窗口时的代码

```
 private void Bookings_Loaded(object sender, RoutedEventArgs e)
    {

       WpfApplication7.AllensCroftEntities1 allensCroftEntities1 = new WpfApplication7.AllensCroftEntities1();
        // Load data into Rooms.
        var roomsViewSource = ((CollectionViewSource)(this.FindResource("roomsViewSource")));
        var roomsQuery = this.GetRoomsQuery(allensCroftEntities1);
        roomsViewSource.Source = roomsQuery.Execute(MergeOption.AppendOnly);

    } 
```

这是导致错误的删除按钮的代码：

```
 private void btnDelete_Click(object sender, RoutedEventArgs e)
    {

        //prevents user trying to delete nothing/unselected row
        if (ObjectIndex == null)
        {
            MessageBox.Show("Cannot delete the blank entry");
        }
        else
        {

            //deletes object from dataset, saves it and outputs a message
            allensCroftEntities1.DeleteObject(ObjectIndex);

            allensCroftEntities1.SaveChanges();
            MessageBox.Show("Booking Deleted");
        }
    } 
```

这是对象索引的代码：

```
 private void listrow_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {

        //outputs index of the selected room
        ObjectIndex = listrow.SelectedItem as Booking;
    } 
```

编辑，

我试过

```
 allensCroftEntities1.Attach(ObjectIndex); 
```

![附](../Images/b39aba449588253ef842d4df24ffb920.png)

编辑，

当我注释掉预订加载事件中的实体时，我收到此错误，此代码过去可以正常工作，但我不知道为什么会发生所有这些问题。

![可为空的](../Images/ff760a7042ecbfc1232b1a9e651c210b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T22:37:46.987

首先尝试将实体附加到上下文：

```
allensCroftEntities1.Attach(ObjectIndex);
allensCroftEntities1.DeleteObject(ObjectIndex); 
```

`Bookings_Loaded`或者通过删除该行来使用在类范围中声明的上下文而不是事件处理程序中的本地上下文：

```
WpfApplication7.AllensCroftEntities1 allensCroftEntities1 = new WpfApplication7.AllensCroftEntities1(); 
```

# mongodb - Mongodb存储和选择订单

> ID：15467099
> 
> 赞同：1
> 
> 时间：2013-03-17T22:37:16.920
> 
> 标签：mongodb

基本问题。mongodb find 命令是否总是按照添加到集合中的顺序返回文档？如果没有，如何以正确的顺序实施选择文档？种类？但是，如果同时添加的文档并说创建日期相同，但仍然有订单怎么办。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:08:16.210

嗯，是的，而且……不完全是。文档默认按自然顺序排序。最初是文档存储在磁盘上的顺序，实际上是文档添加到集合中的顺序。但是，此顺序不是确定性的，因为一旦这些文档在更新操作后增长，文档可能会在磁盘上移动，并且不再适合当前空间。这样初始（插入）顺序可能会改变。

只要 _id 是 ObjectId 类型，保证插入顺序排序的方法就是按**{_id : 1}排序。**这将返回按升序排序的文档。

写操作不会同时发生。写锁是在数据库级别（V 2.4 及更高版本）施加的。_id 的前四个字节是插入时间戳，最后 3 个数字是一个随机计数器，用于区分（和排序）具有相同时间戳的 ObjectId 实例。

_id 字段默认索引

# ruby-on-rails - activerecord 疯了？还是我做错了什么

> ID：15467100
> 
> 赞同：0
> 
> 时间：2013-03-17T22:37:18.180
> 
> 标签：ruby-on-rails, ruby, activerecord, ruby-on-rails-3.2

这是这样的：

```
class Prijave < ActiveRecord::Base
   belongs_to :timovi
   belongs_to :liga
end

class Timovi < ActiveRecord::Base
    belongs_to :sportovi
    has_many :timoviusers, :dependent => :destroy
    has_many :prijaves, :dependent => :destroy
end 
```

当我试图删除一个 Timovi 时，我得到：未初始化的常量 Timovi::Prijafe

另外，在控制台

```
1.9.3p194 :001 > a=Timovi.find(6)
  Timovi Load (0.2ms)  SELECT `timovis`.* FROM `timovis` WHERE `timovis`.`id` = 6 LIMIT 1
1.9.3p194 :007 > a.prijaves
NameError: uninitialized constant Timovi::Prijafe 
```

普里哈菲斯？我没有在任何地方声明...我在任何地方都没有...错误？我做错了什么吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T22:49:46.510

Active Record 使用主动支持变形器从复数形式中计算出类名应该是什么。这不是万无一失的，尤其是当这个词看起来不是英语时。

您可以添加变形器规则来教 rails 您要使用的复数/单数（在初始化程序中应该有一个示例文件显示如何执行此操作），或者您可以将 :class_name 选项指定给 has_many 以便活动记录不会必须猜测类名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T22:49:57.487

“Prijafe”的复数形式是“Prijaves”

因此，当您调用 a.prijaves 时，您会得到未初始化的常量。

这是一个链接：[Ruby on Rails：如何在 Rails 中明确定义复数名称和单数名称？](https://stackoverflow.com/questions/3517989/ruby-on-rails-how-do-you-explicitly-define-plural-names-and-singular-names-in-r)

# meteor - Meteor 中的自定义列表渲染

> ID：15467102
> 
> 赞同：0
> 
> 时间：2013-03-17T22:37:30.790
> 
> 标签：meteor

我需要将项目显示为情侣。像这样的例子：

```
Template.container.couples = function() {
    var items = Items.find({}, {sort: {sort_field: 1}}).fetch();
    var couples = [];
    for (var i = 0; i < items.length; i++) {
        couples.push({
            itemA: items[i],
            itemB: items[i + 1]
        });
        i++;
    }
    return couples;
};

<template name="container">
   <ul>
       {{#each couples}}
           <li>
               <p class="item-a">{{>item itemA}}</p>
               <span>|</span>
               <p class="item-b">{{>item itemB}}</p>
           </li>
       {{/each}}
   <ul>
</template>

<template name="item">
    <strong>{{title}}</strong>
</template> 
```

项目看起来像：

```
{
   sort_field: 1,
   title: 'Item 1',
   type: 'A'
},
{
   sort_field: 2,
   title: 'Item 2',
   type: 'B'
},
{
   sort_field: 3,
   title: 'Item 3',
   type: 'A'
},
{
   sort_field: 4,
   title: 'Item 4',
   type: 'B'
},
{
   sort_field: 5,
   title: 'Item 5',
   type: 'A'
} 
```

此代码运行良好，但是当我更新其中一个项目的标题时，所有项目都会重新呈现。

如何解决？如何创建这种具有反应性的布局？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-20T13:59:31.227

从 Meteor 0.8.0 开始，[Meteor 将自动仅重新渲染更改的内容。](https://github.com/meteor/meteor/blob/devel/History.md#v080-2014-mar-27)

# android - 自定义 Android WebView 以在内部打开除 YouTube 链接之外的所有链接

> ID：15467104
> 
> 赞同：4
> 
> 时间：2013-03-17T22:37:43.867
> 
> 标签：android, webview, youtube

我有一个 WebView 应用程序，我希望它的行为如下：

用户可以点击任何链接并在同一个 WebView 中打开新页面，除非目标是 YouTube，在这种情况下我想要两种可能的情况：

1.  打开 YouTube Android 应用以查看视频
2.  打开标准浏览器查看视频。

我的主要活动如下：

```
package com.prgguru.android;
import android.os.Bundle;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.webkit.WebView;

@SuppressLint("SetJavaScriptEnabled")
public class MainActivity extends Activity {
     WebView browser;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        browser=(WebView)findViewById(R.id.webkit);     
        browser.getSettings().setJavaScriptEnabled(true);
        browser.getSettings().setDefaultFontSize(20);
        browser.loadUrl("http://exo-agency.com/funnytube/");   
    }
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-28T05:44:20.203

[user2180451](https://stackoverflow.com/users/2180451/user2180451)的回答：

我刚刚编辑为答案：

终于解决了这个问题。

对于任何有这个问题的人来说，我是如何让它工作的

在这里，我留下一个模板主要活动放入 src > MainActivity.java 用你的网址填充它

```
/** YOUR PACKACGE NAME SHOULD GO HERE **/

import android.app.Activity;
import android.net.Uri;
import android.os.Bundle;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.content.Intent;
import android.net.Uri;

public class MainActivity extends Activity {
    /** Called when the activity is first created. */
     @ Override

     public void onCreate (Bundle savedInstanceState) {
         super. onCreate (savedInstanceState);
         setContentView (R.layout.main);

         WebView web = (WebView) findViewById (R.id.webView);
         web.getSettings().setJavaScriptEnabled (true);
         web.getSettings().setJavaScriptCanOpenWindowsAutomatically(false);
         web.getSettings().setPluginsEnabled (true);
         web.getSettings().setSupportMultipleWindows (false);
         web.getSettings().setSupportZoom (false);
         web.setVerticalScrollBarEnabled (false);
         web.setHorizontalScrollBarEnabled (false);

         web.loadUrl ("THE URL TO YOUR WEBVIEW SITE SHOULD GO HERE");

         web.setWebViewClient(new WebViewClient () {
             @ Override public boolean shouldOverrideUrlLoading(WebView view, String url) {
             if (url.startsWith("vnd.youtube")){
                 startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(url)));
                 return true;
             }
             else {
                 return false;
             }
             }
         });
     }

 } 
```

之后，在您的实际网页 HTML 网络应用程序中，您可以调用 YouTube 应用程序来播放带有此条目的视频

```
<a href="vnd.youtube://VIDEOID">WATCH ME</a> 
```

只需将 VIDEOID 替换为您要观看的视频的实际视频 ID，当您单击它时，它将启动带有视频的 YouTube 应用程序。

如果您想要图像缩略图而不是文本链接来简单地打开视频

# qt - 确定 QTextDocumentWrite 写入失败的原因

> ID：15467106
> 
> 赞同：0
> 
> 时间：2013-03-17T22:37:51.463
> 
> 标签：qt

Windows 7 SP1
MSVS 2010
Qt 4.8.4

QTextDocumentWriter[函数 write](http://qt-project.org/doc/qt-4.8/qtextdocumentwriter.html#write)只返回一个布尔值。

有没有办法找出失败的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T00:16:54.347

`myTextDocumentWriter->device()->errorString()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T22:42:22.953

乍一看，当 QTextDocumentWriter::write() 返回 bool 时，我没有找到任何关于失败状态的文档。您是否尝试过单步执行函数调用以确定错误原因？

# c++ - 如何修复“未找到重载的成员函数”错误？

> ID：15467115
> 
> 赞同：1
> 
> 时间：2013-03-17T22:39:42.723
> 
> 标签：c++, compiler-errors

我不断收到以下错误：

> `"overloaded function not found in 'pizza'"`

这指的是`void outputDescription`和`double computePrice`功能，下面。我不知道出了什么问题。

我是 C++ 的初学者，但代码看起来不错。这是上课用的。我应该至少有 1 个 mutator 函数和 1 个 accessor 函数，一个计算价格的函数和一个输出比萨饼描述的函数。

这是我的代码：

```
#include <iostream>
#include <string>
using namespace std;

class pizza
{
    public:
        void getOrder (string, string, int, int) ;
        void outputDescription (string&, string&, int&, int&) const;
        double computePrice (string&, int&, int&) const;
    private:
        string type;
        string size;
        int pepperoni;
        int cheese;
};

int main ()
{
    pizza customerpizza;
    double price;
    string type;
    string size;
    int pepperoni;
    int cheese;

    customerpizza.getOrder (type, size, pepperoni, cheese);
    customerpizza.outputDescription (type, size, pepperoni, cheese);
    price = customerpizza.computePrice (size, pepperoni, cheese);

    cout << "Total cost is $" << price << ".\n";

    system("PAUSE");
    return 0;
}

void pizza::getOrder (string type, string size, int pepperoni, int cheese)
{
    int pizzaType;
    int pizzaSize;

    cout << "Please choose 1 for deep dish, 2 for hand tossed, or 3\n";     cout << " for pan pizza.\n";
    cin >> pizzaType;

    switch(pizzaType)
    {
        case 1: type = "deep dish";
        break;
        case 2: type = "hand tossed";
        break;
        case 3: type = "pan";
        break;
        default: cout << "You entered an invalid choice. Please\n";              
                 cout << " enter 1 for deep dish, 2 for hand\n";             
                 cout << " tossed, or 3 for pan pizza.\n";
    }

    cout << "Please choose 1 for small, 2 for medium, or 3 for\n"; 
    cout << " large pizza.\n";
    cin >> pizzaSize;

    switch(pizzaSize)
    {
        case 1: size = "small";
        break;
        case 2: size = "medium";
        break;
        case 3: size = "large";
        break;
        default: cout << "You entered an invalid choice. Please\n";
                 cout << " enter 1 for small, 2 for medium, or\n";
                 cout << " 3 for large pizza.\n";
    }

    cout << "How many pepperoni servings on this pizza?\n";
    cin >> pepperoni;

    cout << "How many cheese servings on this pizza?\n";
    cin >> cheese;
}

void pizza::outputDescription (string type, string size, int pepperoni, int cheese) 
{
    cout << "You ordered a " << size << << type << " pizza with \n"; 
    cout << pepperoni << " servings of pepperoni and "<< cheese << endl;   
    cout << "servings of cheese.\n";

}

double pizza::computePrice (string size, int pepperoni, int cheese)
{
    double price;

    if (size = "small")
    {
        price = 10 + (2 * (pepperoni + cheese));
    }

    else if (size = "medium")
    {
        price = 14 + (2 * (pepperoni  + cheese));
    }

    else if (size = "large")
    {
        price = 17 + (2 * (pepperoni + cheese));
    }

    return price;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-17T22:42:34.860

您以这种方式声明您的成员`outputDescription()`函数：

```
void outputDescription (string&, string&, int&, int&) const;
//                      ^^^^^^^  ^^^^^^ 
```

但是您提供的定义具有以下签名：

```
void pizza::outputDescription (
    string type, string size, int pepperoni, int cheese) const
//  ^^^^^^       ^^^^^^       ^^^            ^^^         ^^^^^
//                REFERENCES ARE MISSING!                Qualifier! 
```

您忘记在函数定义中使用引用，并且忘记添加`const`限定符。成员函数定义中使用的签名必须与成员函数声明的签名匹配，而您的则不然。只需将这些参数类型*引用*到`string`and`int`并添加`const`限定符，与您声明函数的方式一致。

`computePrice()`成员函数也有同样的问题。这是您声明它的方式：

```
double computePrice (string&, int&, int&) const;
//                   ^^^^^^^  ^^^^  ^^^^ 
```

这是它的定义：

```
double pizza::computePrice (string size, int pepperoni, int cheese) const
//                          ^^^^^^       ^^^            ^^^         ^^^^^
//                              REFERENCES ARE MISSING!             Qualifier! 
```

当然，解决方法是一样的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T22:44:14.817

错误是由于您**在声明（头文件）中的方法签名和定义不同**（您忘记了 &）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T23:51:00.287

将我在其他地方的评论变成答案……</p>

实际的解决方案是删除所有这些参数 ( `string type, string size, int pepperoni, int cheese`)，因为它们不必要地[隐藏](https://stackoverflow.com/q/2804880/78845)成员变量（正如[John 在评论](https://stackoverflow.com/questions/15467115/how-can-i-fix-overloaded-member-function-not-found-error#comment21888469_15467115)中指出的那样）并且应该由您的编译器指出！

您还需要确保方法上的[cv 限定符](http://en.cppreference.com/w/cpp/language/cv)对于声明和定义是相同的。

因此，您的声明应该是：

```
 void getOrder();
    void outputDescription() const;
    double computePrice() const; 
```

定义应如下所示：

```
void pizza::getOrder()

void pizza::outputDescription() const

double pizza::computePrice() const 
```

这将使调用[`main()`](http://liveworkspace.org/code/Cg5yb$1)看起来更整洁：

```
int main()
{
    pizza customerpizza;
    customerpizza.getOrder();
    customerpizza.outputDescription();
    double price = customerpizza.computePrice();

    cout << "Total cost is $" << price << ".\n";
} 
```

还有一些其他的事情需要注意，也...

在`computePrice()`中，您将相等 ( **`==`**) 与赋值 ( **`=`**) 混淆了。那`if (size = "small")`应该是`if (size == "small")`，对于其他`size`s) 也是如此)。

在`outputDescription()`中，以下行缺少某些内容：

```
cout << "You ordered a " << size << << type << " pizza with \n"; 
// --------------------------------^
// Did you mean to include a space? (' ')? 
```

学习阅读和理解编译器错误（和警告）是学习 C++ 的重要组成部分。继续练习！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-17T22:41:57.590

你的方法有签名

```
void outputDescription(string&, string&, int&, int&) const; 
```

但您将其定义为

```
void pizza::outputDescription(string type, string size, int pepperoni, int cheese) 
```

一方面，参数类型不匹配，并且您没有将后者限定为 const 成员函数。

由于您的方法不匹配，编译器会尝试找到合适的重载，如果找不到，则会出现错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-04-24T21:13:48.390

其他人已经很好地回答了您的问题，但我想指出您的代码的另外两个问题。

1.  成员函数`void getOrder (string, string, int, int) ;`应该使用变量的引用，否则您无法设置成员值的值。

2.  在成员函数`double pizza::computePrice`中，您应该`if (!size.compare("small"))`使用`if (size = "small")`.

# c - 在 C 中本地声明巨大的数组

> ID：15467116
> 
> 赞同：6
> 
> 时间：2013-03-17T22:39:43.813
> 
> 标签：c, arrays

为什么在 C 中本地声明巨大的数组不好？例如：int a[1000000]；

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T22:41:02.273

因为它们进入堆栈，堆栈上只有有限的空间，

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-17T22:40:45.080

因为如果您在本地声明它们，它们就会在堆栈上声明 - 如果堆栈变得太大，您将出现堆栈溢出并且您的程序将崩溃。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-17T22:46:47.173

堆栈很小（大约 4kb），但堆在机器上的大小变体更大，使用指向 int malloc() 的指针动态分配数组，

注意指针，祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T22:44:25.500

虽然可以在一定程度上预先调整堆栈空间，但也需要考虑通过函数从执行路径调用同一个函数的可能性。例如：

```
void a() { int a[10000000]; b(); }
void b() { d(); c(); }
void c() { a(); } 
```

由于这种分析并不总是直截了当的，因此可能会导致溢出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-17T22:52:17.760

堆栈和堆可以是任意大小（如果实现是这样配置的，堆栈可以比堆大 100 倍），但通常堆栈非常小，并且会因大量分配而溢出 - 特别是在递归函数中。

# include - 球拍方案：包含具有动态文件名的外部 rkt 文件

> ID：15467117
> 
> 赞同：3
> 
> 时间：2013-03-17T22:39:44.707
> 
> 标签：include, scheme, racket

我想从函数的参数加载球拍方案中的外部 rkt 文件。例如，

```
(define (test fileName)
   (include fileName)
) 
```

但是，我收到错误消息，表明 fileName 不是路径名字符串，`file' form, or`lib' 形式。

有没有办法解决这个问题，还是有另一种更好的方法来包含来自动态文件名的文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T22:43:32.053

做到这一点的最好方法是使外部文件成为一个模块，并使用[`dynamic-require`](http://docs.racket-lang.org/reference/Module_Names_and_Loading.html?q=dynamic-require#%28def._%28%28quote._~23~25kernel%29._dynamic-require%29%29).

# php - zend framework url helper - 如何在控制器之前传递变量？

> ID：15467119
> 
> 赞同：0
> 
> 时间：2013-03-17T22:39:57.153
> 
> 标签：php, zend-framework, zend-router, url-helper

我对 Zend Framework (1.12) - url helper 有特定的问题。

我有网站，以这种形式按语言划分：

/en/contact /de/gallery/gal1

ETC..

我已将路由器更改为接受第一个参数作为变量，并且可以通过 GET 访问它。

如何设置 URL 帮助程序以遵循此指南并在 URL 中的控制器之前传递此变量？（我没有使用模块）。

非常感谢。伊万

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T11:26:25.903

让我回答我自己。路由器设置：

```
 $router = $frontController->getRouter();

  $routeLang = new Zend_Controller_Router_Route(
        ':lang/:controller/:action/*',
        array(
            'lang' => 'de',
            'controller' => 'index',
            'action'    => 'index'
        ),
        array('lang' => '[a-z]{2}')
   );

  $router->addRoute('lang', $routeLang); 
```

网址创建：

```
$this->url(array('lang' => 'bar', 'controller'=>'contact','action'=>'index')); 
```

如果我的理解有误，请纠正我。

伊万

# r - 如何在 R 中实现这个模型选择算法？

> ID：15467121
> 
> 赞同：2
> 
> 时间：2013-03-17T22:40:09.373
> 
> 标签：r, statistics, mgcv

我有一个复杂的半参数模型，我正在 R 中拟合。我从一个基于理论的模型开始。它有很多交互术语。我想把它筛选下来：一个一个地删除每个交互项或未交互的主效应，检查 AIC，并保留给我最低 AIC 的模型。然后我想在保留的模型上重复这个过程。

这是一个简单的例子：

```
set.seed(42)
library(mgcv)
N=220
fac = ceiling(runif(N)*2)
a = rnorm(N); b = rnorm(N); c = rnorm(N); d = runif(N); e = rnorm(N); 
y = a^fac + b*e + d/(e+1)

m1 = gam(y~     as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,b,c)   
+   te(a,d,by=as.factor(fac))
)

m2 = gam(y~     as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(b,c) 
+   te(a,d,by=as.factor(fac))
)

m3 = gam(y~     as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,c) 
+   te(a,d,by=as.factor(fac))
)

m4 = gam(y~     as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,b) 
+   te(a,d,by=as.factor(fac))
)

m5 = gam(y~     as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,b,c)   
+   te(d,by=as.factor(fac))
)

m6 = gam(y~     as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,b,c)   
+   te(a,by=as.factor(fac))
)

m7 = gam(y~     as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,b,c)   
+   te(a,d)
)

selection = AIC(m1,m2,m3,m4,m5,m6,m7)
selection 
```

df AIC

米1 14.53435 1626.611

平方米 12.52501 1622.635

立方米 12.54566 1622.615

米4 12.52652 1622.633

m5 13.14108 1620.759

米6 10.99684 1621.156

米7 10.98136 1622.229

m5是最好的

```
m5 = gam(y~     as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,b,c)   
+   te(d,by=as.factor(fac))
)

m5.1 = gam(y~   as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(b,c) 
+   te(d,by=as.factor(fac))
)

m5.2 = gam(y~   as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,c) 
+   te(d,by=as.factor(fac))
)
m5.3 = gam(y~   as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,b) 
+   te(d,by=as.factor(fac))
)

m5.4 = gam(y~   as.factor(fac)
+   s(a)
+   s(b)
+   s(c)
+   s(d)
+   te(a,b,c)   
#+  te(d,by=as.factor(fac))
)

selection.2 = AIC(m5,m5.1,m5.2,m5.3,m5.4)
selection.2 
```

df AIC

m5 13.363029 1621.183

m5.1 9.671656 1617.641

m5.2 9.730047 1617.549

m5.3 9.706424 1617.569

m5.4 9.857504 1620.028

5.2是最好的

...等等。接下来我将在 m5.2 中尝试每个交互项或非交互主效应。问题是我怎样才能自动化呢？从一个模型（在我的例子中是 m1）开始，并让 R 在运行这个算法之后给我最好的模型，直到根据这个算法不再有任何“更好”的模型？

现在我可以手动完成，但随着时间的推移添加数据，模型选择可能会改变。

提前感谢您的任何提示。

# javascript - 如何获得与应用了比例变换的 div 相关的正确鼠标位置

> ID：15467122
> 
> 赞同：16
> 
> 时间：2013-03-17T22:40:26.827
> 
> 标签：javascript, jquery, css, jquery-events, css-transforms

我正在使用 CSS 变换比例在 div 上创建平滑缩放。问题是即使按比例放大，我也希望能够获得相对于 div 的正确鼠标位置，但我似乎可以找出正确的算法来获取这些数据。我正在从以下位置检索当前比例因子：

```
var transform = new WebKitCSSMatrix(window.getComputedStyle($("#zoom_div")[0]).webkitTransform);
scale = transform.a; 
```

当我在各种比例设置下读取 div 的位置时，它似乎报告了正确的位置，即当我缩放 div 直到屏幕更大时，左侧和顶部的位置值为负并且看起来是正确的，就像返回比例值：

```
$("#zoom_div").position().left
$("#zoom_div").position().top 
```

为了获得当前的鼠标位置，我正在从点击事件中读取 x 和 y 位置并移除偏移量。这在比例值为 1（无比例）时正常工作，但在 div 放大时不能正常工作。这是我的基本代码：

```
$("#zoom_div").on("click", function(e){
    var org = e.originalEvent;

    var pos = $("#zoom_div").position();

    var offset = {
        x:org.changedTouches[0].pageX - pos.left,
        y:org.changedTouches[0].pageY - pos.top
    }

    var rel_x_pos = org.changedTouches[0].pageX - offset.x;
    var rel_y_pos = org.changedTouches[0].pageY - offset.y;

    var rel_pos = [rel_x_pos, rel_y_pos];
    return rel_pos;
}); 
```

我已经多次尝试将比例因子相乘除以 pageX / Y 或从中减去比例因子，但没有任何运气。谁能帮我弄清楚如何获得正确的价值。

（我已经从原始代码简化了我的代码，希望使我的问题更清楚，您在上面的代码中可能发现的任何错误都是由于向下编辑造成的。我的原始代码除了鼠标位置问题外）。

为了说明我在说什么，我做了一个快速的 jsfiddle 示例，它允许使用 translate3d 拖动 div。当比例正常 (1) 时，div 被拖动到单击的位置。当 div 放大 (2) 时，它不再从单击的点正确拖动。

[http://jsfiddle.net/6EsYG/12/](http://jsfiddle.net/6EsYG/12/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T11:04:51.557

您需要设置 webkit 转换原点。基本上，当你扩大规模时，它将来自中心。这意味着偏移量将是错误的。0,0 将从正方形的中心开始。但是，如果将原点设置为左上角，则缩放时将保持正确的坐标。这是您设置原点的方式：

```
#zoom_div{
    -webkit-transform-origin: 0 0;
} 
```

这与将偏移量乘以对我有用的比例相结合：

```
offset = {
  "x" : x * scale,
  "y" : y * scale
} 
```

[查看 jsFiddle 演示](http://jsfiddle.net/YzLHc/1/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-18T15:24:45.750

不要使用`event.pageX - pos.left`, but `event.offsetX`（或对于某些浏览器：`event.originalEvent.layerX`

```
div.on('click',function(e) {
    var x = (e.offsetX != null) ? e.offsetX : e.originalEvent.layerX;
    var y = (e.offsetY != null) ? e.offsetY : e.originalEvent.layerY;
}); 
```

看我的 jsFiddle 例子：http: [//jsfiddle.net/Yukulele/LdLZg/](http://jsfiddle.net/Yukulele/LdLZg/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-22T09:30:14.927

您可以在 iframe 中嵌入缩放的内容。在 iframe 之外缩放以启用 iframe 内的缩放鼠标事件，因为鼠标事件是文档范围。

# php - DATE php 和 mysql 唯一

> ID：15467125
> 
> 赞同：1
> 
> 时间：2013-03-17T22:40:36.450
> 
> 标签：php, mysql, datetime

好的，我的问题很奇怪我在 php 中有这段代码传递了三个变量日月和年

```
$MONTH=$_POST['day']; 
$DAY=$_POST['month']; 
$YEAR=$_POST['year'];
$newdate="$YEAR/$DAY/$MONTH";
$DATEOFBITH=date("Y-m-d H:i:s", strtotime($newdate)); 
```

$newdate 的输出：1967/1/1

看起来不错，但是当我查看 mysql 时，它显示为零，但是如果我编写如下代码。并将其插入 mysql 它可以工作！

```
$newdate="1986/1/1";
$DATEOFBITH=date("Y-m-d H:i:s", strtotime($newdate)); 
```

我尝试了一切仍然没有得到它！

如果也做了比较

```
$MONTH=$_POST['day']; 
$DAY=$_POST['month']; 
$YEAR=$_POST['year'];
$olddate="$YEAR/$DAY/$MONTH";
$newdate="1986/1/1";
if($newdate==$olddate){
echo "the same";
} 
```

它输出：相同

那么，问题是什么？当我使用 POST 时，它不适用于 mysql，但如果我手动输入日期，它就可以正常工作！

我试过修剪/（字符串）没有工作:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T22:50:50.377

改变：

```
$newdate="$YEAR/$DAY/$MONTH"; 
```

至：

```
$newdate=$YEAR.'-'.$MONTH.'-'.$DAY; 
```

基本上，您需要使用 SQL 标准日期格式来确保 PHP 不会“猜测”该格式。

# python - 在另一个模块中导入模块本地变量

> ID：15467126
> 
> 赞同：0
> 
> 时间：2013-03-17T22:40:43.673
> 
> 标签：python, python-2.7, pygame, python-import

大家好，我想知道为什么这段代码有效

```
from pygame.locals import *
print QUIT 
```

这不起作用

```
import pygame
print pygame.locals.QUIT 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T22:42:14.763

`locals`是 的嵌套子包`pygame`，您必须先导入它：

```
import pygame.locals 
```

它*不是*`pygame`自身的属性；仅当`pygame/__init__.py`文件本身要执行时才有效`from . import locals`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T22:42:43.920

你必须导入`pygame.locals`，而不是`pygame`。包内的模块不会因为您导入包而自动导入。

# javascript - 如何使用开发人员工具打印具有嵌套属性的 javascript 对象，而嵌套属性没有指向错误的引用

> ID：15467132
> 
> 赞同：2
> 
> 时间：2013-03-17T22:41:13.270
> 
> 标签：javascript, console

例子：

```
var o = {
a: 12,
gg: {
    mm: {
        a: 15
    }
}
}
console.log(o, _.copy(o))
o.gg.mm.a = 44 
```

在这种情况下，在开发人员工具中，它会打印两次“o”，并且 o.gg.mm.a 的值会有所不同

在第一个中，值为 44

在第二个中，值为 15 -- 感谢 jquery 复制功能或下划线克隆功能

当打印更复杂的主干模型时，它会不断打印指向错误引用的对象，即 44 而不是 15（无论是否使用克隆/复制）

有几个选项可以显示这些属性（即使是 Backbone 模型），但它们都很糟糕：

*   使用具有已知限制的包装器，即克隆/复制/扩展来处理嵌套属性
*   复制/克隆/扩展特定属性以获取嵌套对象，即 console.log(_.copy(o.gg.mm))
*   直接在值上使用 console.log 即 console.log(o.gg.mm.a) 以获得正确的值
*   启动调试器并检查值

有没有更简单的？我想查看对象及其属性，而不会让 console.log 误读我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T22:55:59.140

不幸的是，控制台是延迟评估的——也就是说，只有在您单击查看对象后才会获取对象属性的值。

如果您使用的是 Chrome，您可能需要考虑设置一个断点来停止代码执行，以便您可以在对象被修改之前查看它。

可以在此处找到有关断点的更多信息：[https ://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints](https://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints)

# c# - 如何学习 WriteAllBytes 进度

> ID：15467135
> 
> 赞同：6
> 
> 时间：2013-03-17T22:41:24.443
> 
> 标签：c#, progress

我可以使用进度条来显示进度吗

```
File.WriteAllBytes(file, array) 
```

在 C# 中？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-17T22:49:47.347

不。

您需要使用循环将字节写入块中。类似以下内容应该可以帮助您入门。请注意，这需要在后台线程中运行。我您使用的是 WinForms，您可以使用`BackgroundWorker`.

```
using(var stream = new FileStream(...))
using(var writer = new BinaryWriter(stream)) {
    var bytesLeft = array.Length; // assuming array is an array of bytes
    var bytesWritten = 0;
    while(bytesLeft > 0) {
        var chunkSize = Math.Min(64, bytesLeft);
        writer.WriteBytes(array, bytesWritten, chunkSize);
        bytesWritten += chunkSize;
        bytesLeft -= chunkSize;
        // notify progressbar (assuming you're using a background worker)
        backgroundWorker.ReportProgress(bytesWritten * 100 / array.Length);
    }
} 
```

编辑：正如 Patashu 在下面指出的那样，您也可以执行任务并等待。我认为我的方法相当简单，不需要任何额外的线程（除了你需要执行操作的一个后台线程）。这是传统的方式，效果很好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-17T22:47:05.607

由于`WriteAllBytes`是一种同步方法，因此在操作完成之前，您什么也不做，也不知道操作。

您需要做的是有一个像 WriteAllBytes 这样的方法，但写入是异步的，例如在[http://msdn.microsoft.com/en-AU/library/jj155757.aspx](http://msdn.microsoft.com/en-AU/library/jj155757.aspx)中。您可以让异步方法每隔一段时间停止并向 GUI 报告其进度，因为它是单独运行的。

# php - 具有相同 URL 的 Google 和多语言网站

> ID：15467136
> 
> 赞同：1
> 
> 时间：2013-03-17T22:41:35.657
> 
> 标签：php, url, indexing, multilingual

我正在使用 geoplugin php 类构建一个具有多语言支持的网站来检测国家代码。这是我的地理定位代码：

```
//GEOLOCATE
$geoplugin = new geoPlugin(); 
$geoplugin->locate();
define('REAL_COUNTRY', strtoupper($geoplugin->countryCode));

//AVAILABLE COUNTRIES
function available_countries(){
    $countries_array = array();
    $sql = mysql_query("SELECT id FROM countries WHERE enabled = '1';") or die(mysql_error());
    while($row = mysql_fetch_array($sql)) array_push($countries_array, $row['id']);
    return $countries_array;
}

//RETURN COUNTRY CODE
function detect_language(){
    if(isset($_COOKIE['country'])) return $_COOKIE['country'];
    else if(isset($_SESSION['country'])) return $_SESSION['country'];
    else if(in_array(REAL_COUNTRY, available_countries())) return REAL_COUNTRY;
    else return 'EN';
} 
```

根据返回的国家代码，我的 php 脚本然后从数据库加载内容。

我希望链接格式如下：

英文网站：sitename.com/contact
德文网站：sitename.com/kontakt
斯洛文尼亚文网站：sitename.com/kontakt

请注意，德语和斯洛文尼亚语站点的 URL 是相同的，但它仍然会根据 IP 和 geoplugin 返回的代码加载不同的内容。

该网站运行良好，但我担心的是谷歌和其他搜索引擎。Google 是否会找到除“EN”以外的其他语言的页面，还是使用更经典的方法并向 URL 添加语言 ID 会更好，如下所示：

英文网站：sitename.com/ **en** /contact
德文网站：sitename.com/ **de** /kontakt
斯洛文尼亚文网站：sitename.com/ **si** /kontakt

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T18:06:15.823

我建议您使用描述性 URL。它使任何搜索引擎基于 URL 100% 不同，从而消除了混淆。

请确保您还将每个页面上的 META 信息更改为正确的语言。这将有助于从一开始就对语言进行分类。

通过使用这种方法，您还可以确保无论网站的哪个部分被链接并因此在搜索引擎中得到改进，整个域都将获得更好的排名，从而使您的 SEO 工作保持一致。

可读的 URL 在各个方面都是这十年的最佳创意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-06-26T09:37:40.130

用于隐藏谷歌工具栏的 CSS

```
.goog-te-banner-frame.skiptranslate {
    display: none !important;
}
#google_translate_element{
    display: none !important;   
} 
```

翻译的回调函数

```
function googleTranslateElementInit() {
    new google.translate.TranslateElement({
        pageLanguage: 'de', 
        //includedLanguages: 'ar,en,gu,hi,pa,ur',       
        autoDisplay: false,

    }, 'google_translate_element');
} 
```

```
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> 
```

页面加载时触发事件

```
function fireEvent(element, event) {
  if (document.createEventObject) {
    var evt = document.createEventObject();
    return element.fireEvent('on' + event, evt)
  } else {
    var evt = document.createEvent("HTMLEvents");
    evt.initEvent(event, true, true);
    return !element.dispatchEvent(evt);
  }
}

var jObj = $('.goog-te-combo');
var db = jObj.get(0);
jObj.val('gu');
fireEvent(db, 'change'); 
```

# android - 安卓系统应用

> ID：15467137
> 
> 赞同：2
> 
> 时间：2013-03-17T22:41:36.247
> 
> 标签：android, system

我正在为 Android 开发一个远程控制应用程序。我希望能够锁定/解锁屏幕。

为此，有两种方法：

*   使应用程序成为设备管理员。
*   使用[`PowerManager.goToSleep()`](http://developer.android.com/reference/android/os/PowerManager.html#goToSleep(long))，需要[DEVICE_POWER](http://developer.android.com/reference/android/Manifest.permission.html#DEVICE_POWER)权限，**这是一个系统权限**。

所以eclipse告诉我“这个权限只授予系统应用程序”。我真的需要在我的应用程序中使用这个和其他一些系统权限，因为它是一个必须能够控制系统功能的远程控制应用程序。

从[支持页面](http://support.google.com/googleplay/android-developer/answer/113469)：

> 上传系统应用程序
> 
> 大多数开发人员不需要上传系统应用程序，可能会忽略此部分。系统应用程序可能已预装在某些设备上，并且可能已在 Play 商店中发布，也可能尚未发布。如果您需要上传系统应用程序并在上传时遇到错误信息，请联系我们。请务必选择发布问题和分发选项。

如果我理解正确的话，可以制作一个系统应用程序。**如何？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:04:32.300

> 我正在为 Android 开发一个远程控制应用程序

幸运的是，这是不可能的，除非您以 root 身份运行，或者您下载 Android 源代码，对其进行修改，然后将其放入您自己的 ROM 模块中。

> 如果我理解正确的话，可以制作一个系统应用程序。如何？

构建自己的 ROM 模组。使用与用于签署您的 ROM mod 相同的签名密钥对应用程序进行签名。将您的应用程序放入您的 ROM 模块中。在您的设备上安装您的 ROM 模块。

当然，这会将您的应用程序的分发限制在运行您的 ROM 模块的那些设备上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-06T21:04:06.373

许多“系统”权限是真正的`SIGNATURE_OR_SYSTEM`权限。对于这些，您需要执行以下操作之一：

1.  构建 APK 后，将其安装为系统应用程序。
2.  使用与您设备上的 Android 发行版相同的密钥对应用进行签名。

对于第一个选项，您需要在您的设备上成为 root。常规 APK 位于 中`/data/app`，而系统 APK 需要放在不同的文件夹中（在 Android 6 和 7 上`/system/priv-app`，早期版本可能有所不同）。但是，这不太适合分发给最终用户的应用程序，特别是如果您的目标受众不是非常精通技术。

对于第二个选项，您需要为您的目标设备从源代码构建 Android。如果您使用与您的 Android 版本相同的密钥对应用程序进行签名，则运行该 Android 版本的用户可以以通常的方式安装它。

# authentication - 使用 Zend Framework 2 通过 HTTP 身份验证阻止访问

> ID：15467138
> 
> 赞同：5
> 
> 时间：2013-03-17T22:41:41.883
> 
> 标签：authentication, zend-framework2

我正在尝试通过[有关 HTTP Authentication Adapter 的 ZF2 文档](http://framework.zend.com/manual/2.1/en/modules/zend.authentication.adapter.http.html)`Zend\Authentication\Adapter\Http`中的说明来实现基于 HTTP 的身份验证。

我想阻止每个传入的请求，直到用户代理通过身份验证，但是我不确定如何在我的模块中实现它。

如何设置我的 Zend\Mvc 应用程序以拒绝访问我的控制器？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-18T01:55:33.387

您正在寻找的可能是附加到[`Zend\Mvc\MvcEvent::EVENT_DISPATCH`](https://github.com/zendframework/zf2/blob/release-2.1.3/library/Zend/Mvc/MvcEvent.php#L24)应用程序事件的侦听器。

为了阻止通过身份验证适配器访问任何操作，您必须执行以下操作。首先，定义一个负责生产您的身份验证适配器的工厂：

```
namespace MyApp\ServiceFactory;

use Zend\ServiceManager\FactoryInterface;
use Zend\ServiceManager\ServiceLocatorInterface;
use Zend\Authentication\Adapter\Http as HttpAdapter;
use Zend\Authentication\Adapter\Http\FileResolver;

class AuthenticationAdapterFactory implements FactoryInterface
{
    public function createService(ServiceLocatorInterface $serviceLocator)
    {
        $config         = $serviceLocator->get('Config');
        $authConfig     = $config['my_app']['auth_adapter'];
        $authAdapter    = new HttpAdapter($authConfig['config']);
        $basicResolver  = new FileResolver();
        $digestResolver = new FileResolver();

        $basicResolver->setFile($authConfig['basic_passwd_file']);
        $digestResolver->setFile($authConfig['digest_passwd_file']);
        $adapter->setBasicResolver($basicResolver);
        $adapter->setDigestResolver($digestResolver);

        return $adapter;
    }
} 
```

这个工厂基本上会给你一个配置的身份验证适配器，并将它的实例化逻辑抽象掉。

让我们继续并为我们的应用程序的`dispatch`事件附加一个侦听器，以便我们可以阻止任何具有无效身份验证标头的请求：

```
namespace MyApp;

use Zend\ModuleManager\Feature\ConfigProviderInterface;
use Zend\ModuleManager\Feature\BootstrapListenerInterface;
use Zend\EventManager\EventInterface;
use Zend\Mvc\MvcEvent;
use Zend\Http\Request as HttpRequest;
use Zend\Http\Response as HttpResponse;

class MyModule implements ConfigProviderInterface, BootstrapListenerInterface
{
    public function getConfig()
    {
        // moved out for readability on SO, since config is pretty short anyway
        return require __DIR__ . '/config/module.config.php';
    }

    public function onBootstrap(EventInterface $event)
    {
        /* @var $application \Zend\Mvc\ApplicationInterface */
        $application    = $event->getTarget();
        $serviceManager = $application->getServiceManager();

        // delaying instantiation of everything to the latest possible moment
        $application
            ->getEventManager()
            ->attach(function (MvcEvent $event) use ($serviceManager) {
            $request  = $event->getRequest();
            $response = $event->getResponse();

            if ( ! (
                $request instanceof HttpRequest
                && $response instanceof HttpResponse
            )) {
                return; // we're not in HTTP context - CLI application?
            }

            /* @var $authAdapter \Zend\Authentication\Adapter\Http */
            $authAdapter = $serviceManager->get('MyApp\AuthenticationAdapter');

            $authAdapter->setRequest($request);
            $authAdapter->setResponse($response);

            $result = $adapter->authenticate();

            if ($result->isValid()) {
                return; // everything OK
            }

            $response->setBody('Access denied');
            $response->setStatusCode(HttpResponse::STATUS_CODE_401);

            $event->setResult($response); // short-circuit to application end

            return false; // stop event propagation
        }, MvcEvent::EVENT_DISPATCH);
    }
} 
```

然后是模块默认配置，在这种情况下被移动到`MyModule/config/module.config.php`：

```
return array(
    'my_app' => array(
        'auth_adapter' => array(
            'config' => array(
                'accept_schemes' => 'basic digest',
                'realm'          => 'MyApp Site',
                'digest_domains' => '/my_app /my_site',
                'nonce_timeout'  => 3600,
            ),
            'basic_passwd_file'  => __DIR__ . '/dummy/basic.txt',
            'digest_passwd_file' => __DIR__ . '/dummy/digest.txt',
        ),
    ),
    'service_manager' => array(
        'factories' => array(
            'MyApp\AuthenticationAdapter'
                => 'MyApp\ServiceFactory\AuthenticationAdapterFactory',
        ),
    ),
); 
```

这是你如何完成它的本质。

显然，您需要`my_app.auth.local.php`在目录中放置类似文件的内容`config/autoload/`，并使用特定于当前环境的设置（请注意，此文件不应提交给您的 SCM）：

```
<?php
return array(
    'my_app' => array(
        'auth_adapter' => array(
            'basic_passwd_file'  => __DIR__ . '/real/basic_passwd.txt',
            'digest_passwd_file' => __DIR__ . '/real/digest_passwd.txt',
        ),
    ),
); 
```

最后，如果您还想拥有更好的可测试代码，您可能希望将定义为闭包的侦听器移动到实现[`Zend\EventManager\ListenerAggregateInterface`](https://github.com/zendframework/zf2/blob/release-2.1.3/library/Zend/EventManager/ListenerAggregateInterface.php).

您可以使用[`ZfcUser`](https://github.com/ZF-Commons/ZfcUser)由 a 支持的`Zend\Authentication\Adapter\Http`，与 结合来实现相同的结果[`BjyAuthorize`](https://github.com/bjyoungblood/BjyAuthorize/)，它处理未授权操作的侦听器逻辑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-02T15:58:29.097

[@ocramius](https://stackoverflow.com/users/347063/ocramius)的答案是接受答案**但是**您忘记描述如何编写两个文件`basic_password.txt`和`digest_passwd.txt`

根据[Zend 2 Official Doc about Basic Http Authentication](http://framework.zend.com/manual/current/en/modules/zend.authentication.adapter.http.html#file-resolver)：

*   `basic_passwd.txt`文件包含用户名、领域（与您的配置相同的领域）和纯密码 ->`<username>:<realm>:<credentials>\n`

*   `digest_passwd.txt`文件包含用户名、领域（与您的配置相同的领域）和密码散列使用 MD5 散列 ->`<username>:<realm>:<credentials hashed>\n`

例子：

如果`basic_passwd.txt`文件：

```
user:MyApp Site:password\n 
```

然后`digest_passwd.txt`归档：

```
user:MyApp Site:5f4dcc3b5aa765d61d8327deb882cf99\n 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-12T11:05:49.967

或者，您可以使用 Apache Resolver for HTTP Adapter

```
use Zend\Authentication\Adapter\Http\ApacheResolver;

$path = 'data/htpasswd';

// Inject at instantiation:
$resolver = new ApacheResolver($path);

// Or afterwards:
$resolver = new ApacheResolver();
$resolver->setFile($path); 
```

根据 [https://zendframework.github.io/zend-authentication/adapter/http/#resolvers](https://zendframework.github.io/zend-authentication/adapter/http/#resolvers)

# networking - 发送的数据包与接收的数据包不同

> ID：15467143
> 
> 赞同：-1
> 
> 时间：2013-03-17T22:42:02.987
> 
> 标签：networking, tcp, network-programming

我使用原始套接字创建 TCP 数据包，重点是序列号和 TCP 标志（SYN，ACK）

我用一台机器 S 发送一个 tcp ACK 数据包（标志 ACK 设置为 1）和另一台机器 R 接收它这两台机器在不同的子网中，都在我的学校

同时，我使用 tcpdump 来捕获数据包。

奇怪的事情发生了！在机器 S 上，捕获的数据包与预期的一样，它是一个 ACK​​ 数据包，但是在接收机器 R 上，数据包变成了一个 SYN 数据包，并且序列号发生了变化，seq no 比预期的小 1 并且 ack_seq 变为0！

潜在的问题是什么？我的猜测是路由器/防火墙将 ACK 数据包修改为 SYN 数据包，因为它从未在 ACK 之前看到 SYN SYN/ACK 交换？有可能吗？

两个捕获的数据包是：

[https://docs.google.com/file/d/0B09y_TWqTtwlVnpuUlNwUmM1YUE/edit?usp=sharing](https://docs.google.com/file/d/0B09y_TWqTtwlVnpuUlNwUmM1YUE/edit?usp=sharing) [https://docs.google.com/file/d/0B09y_TWqTtwlTXhjUms4ZnlkMVE/edit?usp=sharing](https://docs.google.com/file/d/0B09y_TWqTtwlTXhjUms4ZnlkMVE/edit?usp=sharing)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T22:58:41.983

您将遇到的最大问题是，在每种情况下，接收 TCP 堆栈都会接收数据包并可能会回复它。您正在尝试的事情确实是不可能的。

# mysql - MySQL 用户表和帖子表 - 匹配 ID

> ID：15467148
> 
> 赞同：1
> 
> 时间：2013-03-17T22:42:26.907
> 
> 标签：mysql, matching, userid

我对数据库很陌生，所以如果这听起来很愚蠢，我提前道歉。我正在创建一个模拟微博网站的基本 Web 应用程序。我有三张桌子`authors`，`posts`& `comments`。

该`authors`表描述如下：

```
aId int(20) NO  PRI NULL    auto_increment
aUser   varchar(30) NO  UNI NULL    
aPass   varchar(40) NO      NULL    
aEmail  varchar(30) NO  UNI NULL    
aBio    mediumtext  YES     NULL    
aReg    datetime    NO      NULL 
```

下`posts`表描述如下：

```
pId int(20) NO  PRI NULL    auto_increment
pAuthor int(20) NO  MUL NULL    
pTitle  tinytext    NO      NULL    
pBody   mediumtext  NO      NULL    
pDate   datetime    NO      NULL 
```

我了解关系的基础知识，但我可以问一下，如果我想在我的 Web 应用程序上显示帖子并包括发布者，有没有办法这样做，所以结果集将显示实际的用户名，而不是数字ID ？每次创建帖子时，我都会捕获用户 ID，因此创建的每个帖子都是由有效的用户 ID 和帖子表记录创建它的人的用户 ID，但是在选择查询中查看帖子时，它会显示数字而不是作者表中与它们关联的名称。我们在那里有一个查询，我可以用来执行此操作或执行此操作的方式，因此当使用作者的 select * 时，它显示用户名而不是用户 ID。谢谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:06:28.447

我认为您正在寻找 SQL 查询：

```
SELECT pTitle, pDate, aUser 
FROM posts
LEFT JOIN authors ON aId=pAuthor
ORDER BY pDate DESC 
```

在`SELECT`您告诉 MySQL 您想查看哪些列之后，`LEFT JOIN`您将表连接在一起（按`aId`和`pAuthor`）并`ORDER BY`告诉 mysql 按从最新开始的日期排序给您`pDate DESC`（最高日期在前）

```
SELECT posts.*, authors.aUser 
FROM posts 
LEFT JOIN authors ON aId=pAuthor
WHERE pTitle LIKE "%news%"
ORDER BY pDate DESC, aUser ASC 
```

在搜索标题包含“新闻”的帖子时查看作者的姓名，从最新帖子中排序，如果两个帖子具有相同的时间戳，则按用户名排序（亚当将排在 Zachariash 之前）

如果您不需要查看标题、日期和用户名以外的内容，请使用上面第一个查询的第一行

# java - 用于计算玩家手中牌的Java数据结构

> ID：15467151
> 
> 赞同：0
> 
> 时间：2013-03-17T22:42:37.720
> 
> 标签：java, data-structures

玩家总是有4张牌，它们存储在一个数组中，玩家需要选择最不需要的牌并返回不需要的牌的索引（从0到3），规则如下

1.  如果一个等级出现在玩家手中的次数最多，则随机选择一张不同等级的牌。
2.  否则，从玩家的整个手牌中随机选择一张牌。

我花了两个小时，问题是我需要知道每个卡片等级的出现及其在数组中的位置，所以我使用了

```
Map<Rank, ArrayList<Integer>> 
```

而且决策部分非常混乱，有没有更好的方法来做到这一点？

例子：

如果我的手牌是 A,10,10,A 那么我随机选择一个。如果我的手牌是 3,3,3,A 那么我选择 A 如果我的手牌是 2,2,4,5 那么我随机选择 4 或 5。如果我的手牌是 A,2,3,4 那么我随机选择一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:54:23.430

您需要定义模型类，而不是尝试跟踪数组列表映射中的所有内容。

```
public class Card {
    private String rank;
    private String value:
} 
```

.

```
public class Hand {
    private List<Card> cards;
} 
```

.

```
public class Player {
    private Hand hand;
} 
```

.

```
public class CardGame {
    private List<Player> players;
} 
```

您可以使用其余的游戏信息填写这些模型类。

# c++ - 是否可以使用在构造函数中初始化的成员在头文件中初始化私有数组？C++

> ID：15467152
> 
> 赞同：0
> 
> 时间：2013-03-17T22:42:39.717
> 
> 标签：c++, templates

我想在头文件中声明一个数组，但我想在构造类时声明数组的大小。这可能吗？我在这个网站上发现了很多数组声明，但不是这个。当我尝试下面的代码时，我收到错误“数组绑定不是']'标记之前的整数常量”

foo.h

```
class foo{
   private:
      uint16_t _size;
      uint16_t array[_size];
   public:
      foo(uint16_t size);
      virtual ~foo();
} 
```

foo.cpp

```
#include "foo.h"
foo::foo(uint16_t size)
:_size(size)  
{ 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T22:48:37.513

一种特殊的做法是这样

```
class foo
{
public:
   foo(uint16_t size);
private:
   uint16_t _size;
   uint16_t* array;
};

foo::foo(uint16_t size) :_size(size)
{
    array = new int[_size];
} 
```

这将允许您在运行时动态创建一个数组，但我建议您使用 std::vector ，因为通常它们比 C++（IMO）中的数组要好得多，但如果您有特定的理由使用数组，那就是我会这样做的。使用静态意味着如果您想在其他地方使用该类，那么 _size 将在实例之间共享相同的值，我也不认为这会编译，因为只有静态函数可以访问静态成员。

EDT：在我匆忙回答时我忘了说你应该在你的类中添加一个析构函数以在类超出范围时销毁数组这样

```
foo:~foo()
{
    delete[] array;
} 
```

之所以被否决，是因为我从未添加对三规则的引用。理想情况下，无论如何您都不应该使用动态初始化的数组，而只使用向量这里是三[规则 C++ 三规则的链接](http://en.wikipedia.org/wiki/Rule_of_three_%28C++_programming%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T22:48:52.710

理想情况下，您应该使用`std::vector<uint16_t>`: 它可以让您动态决定大小，如下所示：

```
vector<uint16_t> array;
...
foo(size_t size) : array(size) {}
... 
```

或者，您可以使用指针而不是数组，在构造函数中分配它，并在析构函数中删除：

```
uint16_t *array;
...
foo(size_t size) : array(new uint16_t[size]) {}
...
~foo() {delete[] array;} 
```

这不太好，因为一旦定义了析构函数，就需要处理[三的规则](http://en.wikipedia.org/wiki/Rule_of_three_%28C++_programming%29)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T23:01:49.397

如果你真的必须使用数组，你可以使用模板参数来定义数组大小：

```
template<size_t N>
class foo{
private:
    uint16_t array[N];

public:
    foo()
    {
    }
};

foo<3> f; 
```

`std::vector`是C++中的动态数组，它提供了丰富的接口来操作数组，没有理由不用`std::vector`。

```
class foo{
private:
    std::vector<uint16_t> array;

public:
    foo(uint16_t size) : array(size)
    {
    }
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-17T23:02:43.320

你不能那样做。数组的大小必须是编译时间常数。在您的情况下，类 foo 实例的大小取决于数组的大小。如果您在编译时知道每次使用 class 时包含的数组的大小`foo`，那么您可以使用模板：

```
template <size_t N>
class foo {
    uint16_t array[N];
public:
    foo() {}
}; 
```

否则，您应该使用 C++ 提供的可调整大小的数组`std::vector`：：

```
class foo {
    std::size_t size;
    std::vector<uint16_t> array;
public:
    foo(std::size_t size_) 
    : size(size_)
    , array(size_)
    {}
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-17T22:49:15.670

这不是初始化静态变量的方式。方法如下（通常在 CPP 文件中）：

```
uint16_t foo::_size = /* something */; 
```

但我不认为你想要一个静态变量。我建议您改用动态分配的数组：

```
class foo{
   private:
      uint16_t _size;
      uint16_t* array;
      static uint16_t* copy(uint16_t* a, uint16_t s) {
          if (!a) return 0;
          uint16_t* ret = new uint16_t[s];
          for (int i = 0; i < s; i++) ret[i] = a[i];
          return ret;
      }
   public:
      foo(const foo& f) : _size(f._size), array(0) { array = copy(f.array, f._size); }
      foo(uint16_t size = 0) : _size(size), array(0) {
          if (size == 0) return;
          array = new uint16_t[_size];
      }
      ~foo() { delete[] array; }
} 
```

甚至更好的解决方案是使用标准库容器之一，例如`std::vector`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-17T22:50:47.610

使用向量。

```
class foo{
   private:
      std::vector<uint16_t> array;
   public:
      foo(uint16_t size)
};

foo::foo(uint16_t size) : array(size)  
{ 
} 
```

# ios - 在 iOS 应用程序设计中采用 Flat UI 的最佳方式是什么？

> ID：15467156
> 
> 赞同：3
> 
> 时间：2013-03-17T22:43:03.333
> 
> 标签：ios, user-interface, user-experience

由于 Flat UI 越来越流行。越来越多的应用程序正在使用平面 UI 设计。

一些关于平面 UI 设计的文章

[移动设计师不再将 Apple 视为 iOS 设计的最前沿。](http://gigaom.com/2013/01/04/mobile-designers-no-longer-see-apple-on-the-forefront-of-ios-design/)

[扁平化设计与拟物化之间的较量](http://sachagreif.com/flat-pixels/)

作为一名 iOS 开发人员而非设计师，我想在我的应用程序中采用 Flat UI。在 iOS 应用程序设计中采用 Flat UI 的最佳方式是什么？让我分解这个问题。

1.  任何平面 UI 设计的设计指南？
2.  有什么关于如何在 iOS 应用中采用 Flat UI 的好文章吗？
3.  我可以参考任何使用平面 UI 设计的开源项目吗？
4.  当我在 iOS 应用中应用 Flat UI 时，是否需要单独编码每个单独的部分，例如导航栏、工具栏、按钮、应用图标？或者我可以使用全局代码将整个应用程序重置为平面 UI。
5.  我可以使用任何好的 UI 模型吗？

提前致谢。

# java - 创建一种在数组索引中搜索重复值的方法

> ID：15467161
> 
> 赞同：0
> 
> 时间：2013-03-17T22:43:35.487
> 
> 标签：java, arrays, methods, equals, equality

我正在尝试编写一种方法，该方法将搜索名为“items”的数组的索引，以查看相同的字符串是否包含在多个索引中（忽略大小写）。如果一个字符串不止一次出现在数组中，该方法应该输出一条消息并退出。就我现在所拥有的而言，循环有时有效，有时无效 - 例如，如果存储了字符串“house”和“hOuse”，它不会捕获它，尽管它应该。我最初有休息；找到后=真；并认为删除它可能会有所帮助，但它没有。有什么建议吗？

```
public void equals() {
    boolean found = false;
    for (int i = 0; i < items.length; i++) {
        for (int j = 1; j > i && j < items.length; j++) {
            if (items[i].equalsIgnoreCase(items[j])) {
                found = true;
            }
        }
    }
    if (found) {
        System.out.println("You listed the same item more than once.  Please restart and try again.");
        System.exit(0);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T22:50:12.500

这是你的问题

```
 for (int i = 0; i < items.length; i++) {
        for (int j = 1; j > i && j < items.length; j++) { 
```

将其更改为

```
 for (int i = 0; i < items.length; i++) {
        for (int j = i+1; j > i && j < items.length; j++) { 
```

推理：如果 i 是 2 并且 j 是 1，则 j 立即不 > 1 并且内部循环立即返回。这显然不是您想要的，因为这意味着只对数组中的第一个字符串进行比较。

当然，由于 j 现在总是 > i，我们可以放弃检查：

```
 for (int i = 0; i < items.length; i++) {
        for (int j = i+1; j < items.length; j++) { 
```

好多了。

顺便说一句，您可以通过将所有字符串添加到`HashSet<String>`（[http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html)）并检查长度来使您的算法真正快速您的 HashSet 与原始集合的长度 - 如果它较低，则存在重复。这将在 O(nlog(n)) 而不是 O(n^2) 中运行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T22:51:01.243

你应该改变：

```
for (int j = 1; j > i && j < items.length; j++) 
```

至

```
for (int j = i + 1; j < items.length; j++) 
```

编写该方法的更短和更简单的方法是：

```
public void equals() {
    Set<String> set = new TreeSet<String> (String.CASE_INSENSITIVE_ORDER);
    set.addAll(Arrays.asList(items));
    if (set.size() != items.length) {
        System.out.println("You listed the same item more than once.  Please restart and try again.");
    }
} 
```

最后，为了让你的方法可重用，你可以这样写：

```
public boolean hasDuplicatesIgnoreCase(String[] items) {
    ...
    return true / false;
} 
```

# c - 在 eclipse cdt 中调试 fork()

> ID：15467162
> 
> 赞同：12
> 
> 时间：2013-03-17T22:43:41.237
> 
> 标签：c, eclipse, gdb, fork, eclipse-cdt

我正在尝试使用 eclipse cdt (Juno) 调试一些 fork() 机制。我用 C 编写了程序。

```
 if( -1 == (pid = fork()) ) /* error */
    goto cleanup;
  else if ( 0 == pid ) /* child */
  {
    execlp("gcc", "gcc", cFilePath, "-o" , GCC_OUTPUT_FILE_NAME, NULL);
    goto cleanup; /* Arrives here only on error! */
  }
  else if (pid > 0) /* parent - checks: correct pid returns, returns normally, with exit status = 0*/
  {
      returnedpid = wait(exitStatus);
      if( pid != returnedpid || exitStatus == NULL || !WIFEXITED(*exitStatus) || !WEXITSTATUS(*exitStatus) )
          goto cleanup;
  } 
```

我尝试添加“ `set follow-fork-mode child`”，如此处所述：http: [//unix.derkeiler.com/Newsgroups/comp.unix.programmer/2006-02/msg00435.html](http://unix.derkeiler.com/Newsgroups/comp.unix.programmer/2006-02/msg00435.html)

**1.如何调试代码段在哪里`(0==pid)`？**

**2.当我到达wait语句时，调试器立即返回，不是wait（）假设暂停直到孩子返回吗？为什么会立即返回？**

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-18T13:17:28.600

您的问题可能是由于“分叉分离”被设置为关闭。DSF 默认设置这个（这也是 gdb 的默认设置）。

1) 在带有“execlp...”和“returnedpid =...”的行上放置一个断点。2) 在调试配置中启用“不间断模式”和“自动调试分叉进程”。3) 开始调试会话。您将在子级或父级中遇到断点。现在查看调试视图。

![调试视图](../Images/2baefd7055573b426aaa29a40aa46525.png)

您会注意到您的二进制文件显示了两个线程。

4) 单击一个或另一个（上图中带有 main() 的行）以切换调试上下文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T02:37:30.760

这可能是因为 init 进程在您等待之前收割了孩子。在你进入 fork 时尝试阻塞 sigchld，然后在你的 fork/execs 之后解除阻塞信号。也许这应该让你对到底发生了什么有所了解。

使用 sigprocmask 应该会对您有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-21T16:29:00.577

1.  在调试配置窗口 -> 调试器 -> 选中“自动调试分叉进程”
2.  打开断点窗口 -> 查看菜单 -> 添加事件断点 C/C++ -> “fork called”
3.  现在一旦发生事件断点，按 F6 -> 您将在调试窗口中看到新进程
4.  选择新进程并按 F6 - 您在子进程中
5.  享受

# sql-server-2008 - 如何获取 SQL Server 2008 中所有未付款的订单 ID？

> ID：15467163
> 
> 赞同：1
> 
> 时间：2013-03-17T22:43:46.150
> 
> 标签：sql-server-2008

我想获取到目前为止尚未付款的选定客户的所有订单编号，我的数据显示如下：

![在此处输入图像描述](../Images/08ce7e0d2ba43a6088cde72f1e538bd3.png)

我想要的是写一个回答这个问题的 SELECT 语句：

```
select orderID 
from order 
where customer id = @custID 
and Total cashmovementValue 
        for current order id 
    is less than total (sold quantity * salePrice ) 
        for current order id 
```

怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T22:58:18.373

您需要将每个订单行的总和与每个订单的每次付款总和进行比较。[GROUP BY](http://msdn.microsoft.com/en-au/library/ms177673%28v=sql.105%29.aspx)和一些子查询是完成工作所需要的。

像这样的东西应该工作：

```
SELECT
    O.OrderID
FROM [Order] O
INNER JOIN (
   -- Add up cost per order
   SELECT 
       OrderID,
       SUM(SoldQuantity * P.SalePrice) AS Total
   FROM OrderLine
   INNER JOIN Product P ON P.ProductID = OrderLine.ProductID     
   GROUP BY OrderID
) OL ON OL.OrderID = O.OrderID
LEFT JOIN (
    -- Add up total amount paid per order
    SELECT
        OrderID,
        SUM(CashMovementValue) AS Total
    FROM CashMovement
    GROUP BY OrderID
) C ON C.OrderID = O.OrderID
WHERE
    O.CustomerID = @custID
    AND ( C.OrderID IS NULL OR C.Total < OL.Total ) 
```

**编辑**

我刚刚注意到您没有在每个订单行上存储销售价格。我已经相应地更新了我的答案，但这是一个非常糟糕的主意。如果商品价格发生变化，您的旧订单会怎样？通过在每个订单行上存储销售时的价格来对数据进行非规范化是可以的（实际上也是最佳实践）。

# c - 为什么 readline() 将标准输入回显到标准输出？

> ID：15467164
> 
> 赞同：3
> 
> 时间：2013-03-17T22:44:00.457
> 
> 标签：c, readline

我编写了一个小型 C 程序，用于`readline("")`从标准输入读取输入。我没有从终端与其交互，而是编写了一个测试工具来执行 C 程序并为其提供输入：

```
test harness --stdout--> | --stdin--> C program
         ^------stdin--- | <--stdout-----/ 
```

这个测试工具正在接收其输出的回声，即使程序本身也是如此。为什么 readline() 回显其输入，我可以禁用它吗？或者我不应该在非交互式环境中使用 readline() 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T22:50:07.983

[readline](http://www.gnu.org/software/readline/)库仅用于交互式使用。您的程序可能应该回退到使用`fgets()`if`isatty(STDIN_FILENO)`为 false。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-04-15T09:37:15.137

默认情况下，Readline 将用户输入回显到标准输出，但它是可配置的。

来自 readline[文档](http://web.mit.edu/gnu/doc/html/rlman_2.html)：

> 变量：文件 * **rl_outstream**
> 
> Readline 对其执行输出的 stdio 流。

只需在程序的开头设置`rl_outstream`为`stderr`，因此它将回显到 stderr；例如：

```
#include <readline/readline.h>
#include <stdio.h>
...
int main() {
    rl_outstream = stderr;
... 
```

事实上**bash(1)**也是这样做的。

而且我也同意，如果您的程序不是为交互使用而设计的，您应该使用另一种更简单的方法从标准输入获取行，例如**getline(3)**、**fgets(3)**或**getchar(3)**。

# java - 将打印按钮添加到 JPanel

> ID：15467165
> 
> 赞同：2
> 
> 时间：2013-03-17T22:44:00.540
> 
> 标签：java, swing, button, printing, jpanel

我有一个 JPanel，有一些组件，如按钮、标签、表格等。

我想做的是添加一个功能（一个 jButton），单击该按钮会指示我打印整个面板以及标签和组件。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T09:41:27.843

只需制作一个调用此代码的 JButton：

```
public void printComponent() {

  PrinterJob pj = PrinterJob.getPrinterJob();
  pj.setJobName(" Print Component ");

  pj.setPrintable (new Printable() {    
    public int print(Graphics pg, PageFormat pf, int pageNum) {
      if (pageNum > 0) return Printable.NO_SUCH_PAGE;

      Graphics2D g2 = (Graphics2D) pg;
      g2.translate(pf.getImageableX(), pf.getImageableY());
      componenet_name.paint(g2);
      return Printable.PAGE_EXISTS;
    }
  });

  if (pj.printDialog() == false) return;

  try {
    pj.print();
  } catch (PrinterException ex) {
    // handle exception
  }
} 
```

（取自：[如何打印单个 JPanel 的内容？](https://stackoverflow.com/questions/750310/how-can-i-print-a-single-jpanels-contents)）

# scala - 播放框架：通过服务器发送的事件广播来自参与者的消息

> ID：15467166
> 
> 赞同：1
> 
> 时间：2013-03-17T22:44:10.800
> 
> 标签：scala, playframework, akka, server-sent-events, enumerator

我用 Akka-IO 编写了一个简单的套接字客户端，它使用来自套接字服务器的字符串（它发送由 \n 分隔的字符串）：

```
class SocketClient(endpoint: InetSocketAddress) extends Actor {
  override def preStart() {
    IOManager(context.system).connect(endpoint)
  }
  def receive = {
    case IO.Read(socket, bytes) => ??? ! bytes.utf8String
  }  
} 
```

我需要将使用服务器发送事件接收到的字符串广播给所有请求它的客户端。如何定义一个枚举器，其中包含演员收到的所有消息，以作为来自 Play 控制器的流？

# php - $_SESSION 变量和 AJAX 表单 - 变量更新问题

> ID：15467167
> 
> 赞同：1
> 
> 时间：2013-03-17T22:44:11.860
> 
> 标签：php, ajax, session, session-variables

我四处搜寻，找不到这个特定问题的答案。我有一个联系表格，我将其用作基于本教程的 RSVP 表格：http: [//net.tutsplus.com/tutorials/html-css-techniques/build-a-neat-html5-powered -联系表/](http://net.tutsplus.com/tutorials/html-css-techniques/build-a-neat-html5-powered-contact-form/)

该表单上的操作转到一个 PHP 脚本，该脚本将数据写入数据库并发送一些电子邮件。它是通过 AJAX 完成的。数据库交互和电子邮件工作得很好。

发布数据后，我正在使用 $_SESSION 将变量带回表单，以便我可以检查错误并使用条件。问题是这个会话数据似乎只有在我**第二**次点击提交按钮时才可用。

我将尝试简洁地解释这个问题：

1.  我从 rsvp 的下拉菜单中选择一个值，然后按提交。我存储在 $_SESSION 变量中的该选择的值在我测试时不会回显。
2.  我从同一个下拉菜单中选择**不同的值，然后再次按提交。****FIRST**值从该 $_SESSION 变量中回显。

这是我的 submit.php 文件。我已经遗漏了很多，但我认为这是重要的东西：

```
<?php session_start(); ?>
<?php require_once("includes/connection.php"); ?>
<?php require_once("includes/functions.php"); ?>
<?php
if(isset($_POST)) {
    //form validation vars
    $formok = true;
    $errors = array();  
    //sumbission data
    $ipaddress = $_SERVER['REMOTE_ADDR'];
    $date = date('Y-m-d');
    $time = date('H:i:s');
    $timestamp = $date . " " . $time;   
    //form data
    $firstname = mysql_prep($_POST['firstname']);
    $lastname = mysql_prep($_POST['lastname']);
    $dinner = mysql_prep($_POST['dinner']);
    $reqsong = mysql_prep($_POST['reqsong']);
    $email = mysql_prep($_POST['email']);
    $rsvp = mysql_prep($_POST['rsvp']);
    $message = mysql_prep($_POST['message']);
    //what we need to return back to our form
    $returndata = array(
        'posted_form_data' => array(
            'firstname' => $firstname,
            'lastname' => $lastname,
            'dinner' => $dinner,
            'reqsong' => $reqsong,
            'email' => $email,
            'rsvp' => $rsvp,
            'message' => $message
        ),
        'form_ok' => $formok,
        'errors' => $errors
     ); 
```

然后这是我的 rsvp.php 表单：

```
<?php session_start(); ?>
<div id="contact-form" class="clearfix">            
            <?php
                //init variables
                $cf = array();
                $sr = false;            
                if(isset($_SESSION['cf_returndata'])){
                    $cf = $_SESSION['cf_returndata'];
                    $sr = true;
                }
            ?>
        <ul id="errors" class="<?php echo ($sr && !$cf['form_ok']) ? 'visible' : ''; ?>">
            <li id="info">There were some problems with your form submission:</li>
            <?php 
            if(isset($cf['errors']) && count($cf['errors']) > 0) :
                foreach($cf['errors'] as $error) :
            ?>
            <li><?php echo $error ?></li>
            <?php
                endforeach;
            endif;
            ?>
        </ul>
   <?php if($cf['posted_form_data']['rsvp'] == "Will Attend"): ?>
            <p id="success" class="<?php echo ($sr && $cf['form_ok']) ? 'visible' : ''; ?>">Thank you for your RSVP! <br> You will receive an email with additional information soon. <br><br> If your invitation was addressed to more than one person, please enter their information and submit again. <br><br> We look forward to seeing you soon!</p>
        <?php endif; ?>
        <?php if($cf['posted_form_data']['rsvp'] == "Will Not Attend"): ?>
            <p id="success" class="<?php echo ($sr && $cf['form_ok']) ? 'visible' : ''; ?>">Too bad you can't make it.</p>
        <?php endif; ?>
        <form method="post" action="submit.php">
            <input type="text" id="firstname" name="firstname" value="<?php echo ($sr && !$cf['form_ok']) ? $cf['firstname'] : '' ?>" placeholder="First Name" required autofocus />
            <input type="text" id="lastname" name="lastname" value="<?php echo ($sr && !$cf['form_ok']) ? $cf['lastname'] : '' ?>" placeholder="Last Name" required autofocus />
            <input type="email" id="email" name="email" value="<?php echo ($sr && !$cf['form_ok']) ? $cf['email'] : '' ?>" placeholder="Email Address" required />          
            <select id="rsvp" name="rsvp">
                <option value="Will Attend">Will Attend</option>
                <option value="Will Not Attend">Will Not Attend</option>
            </select>
            <select id="dinner" name="dinner">
                <option value="select">Dinner Selection</option>
                <option value="Chicken" <?php echo ($sr && !$cf['form_ok'] && $cf['posted_form_data']['dinner'] == 'Chicken') ? "selected='selected'" : '' ?>>Chicken</option>
                <option value="Pork" <?php echo ($sr && !$cf['form_ok'] && $cf['posted_form_data']['dinner'] == 'Pork Fillet') ? "selected='selected'" : '' ?>>Pork</option>
            </select>                
            <input type="reqsong" id="reqsong" name="reqsong" value="<?php echo ($sr && !$cf['form_ok']) ? $cf['posted_form_data']['reqsong'] : '' ?>" placeholder="Request a Song to be Played!"/>
            <textarea id="message" name="message" placeholder="Leave us a message if you like! If you have any allergies or dietary needs, please indicate them here."><?php echo ($sr && !$cf['form_ok']) ? $cf['posted_form_data']['message'] : '' ?></textarea>                
            <span id="loading"></span>
            <input type="submit" value="Submit" id="submit-button" />
        </form>
        <?php unset($_SESSION['cf_returndata']); ?>
    </div> 
```

抱歉这里有大量代码。您的任何想法将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T22:55:36.130

您假设您总是得到一个过帐值，但情况并非总是如此。

确保检查实际发布的内容：

```
$firstname = isset($_POST['firstname']) ? $_POST['firstname'] : false;
$lastname = isset($_POST['lastname']) ? $_POST['lastname'] : false;
// And so on. 
```

现在，您可以执行以下操作：

```
$noLastname = "Last name not found.";
if(!($name)){ $_SESSION['errorMessage'] .= $noLastname; }else{ $_SESSION['lastname'] = $lastname; } 
```

因此，我认为您通过构建该数组使代码过于复杂，仅使用单个会话，您可能会在其中存储一些空值，而这毫无意义。

如何使用它的示例：

```
<input type="text" id="firstname" name="firstname" value="<?php if(isset($_SESSION['firstname'])){echo $_SESSION['firstname'];}else{echo '';}?>" placeholder="First Name" required autofocus /> 
```

终止数组，确保您实际使用的是存在的数据，等等。你会看到光。

# matlab - 在 GUI 中中断/禁用 ROI 绘制功能

> ID：15467171
> 
> 赞同：1
> 
> 时间：2013-03-17T22:44:33.583
> 
> 标签：matlab, user-interface, selection, roi

我正在编写一个用于选择图像中感兴趣区域 (ROI) 的 GUI。`impoly`可以使用内置的 MATLAB 函数（例如/ ）选择几种区域`imellipse`。

下面，我提供了一个可以解决我的问题的 GUI 的最小工作示例。

问题是：假设一个用户误点击了 ROI 选择按钮之一（即当目标是选择多边形时选择选择椭圆）我如何取消用于 ROI 选择的交互式工具以避免工作区中的错误？

我知道按“Esc”键会取消交互工具，但我想避免错误。

一个想法是让另一个按钮（中止）来执行中断，但我一直无法想出代码来执行此操作。

```
function roiData = testGUI(sourceImage)

% Initialize main figure
hdl.mainfig = figure();

% Initialize roiData and roiCounter
roiData    = [];
roiCounter = 0;

% Select Elliptical ROI button
hdl.selectEllipseButton = uicontrol(hdl.mainfig, 'Units', 'normalized', 'Position',[0.05 0.7 0.2 0.1], 'String', 'Select Ellipse', 'Callback', @selectEllipse);
% Select Polygonal ROI button
hdl.selectPolygonButton = uicontrol(hdl.mainfig, 'Units', 'normalized', 'Position',[0.05 0.6 0.2 0.1], 'String', 'Select Polygon', 'Callback', @selectPolygon);
% Abort Button
hdl.abort = uicontrol(hdl.mainfig, 'Units', 'normalized', 'Position',[0.05 0.2 0.2 0.2], 'String', 'Abort', 'Callback', @abort);
% Axes
hdl.axes = axes('Parent',hdl.mainfig, 'Units', 'Normalized', 'Position', [0.35 0.2 0.6 0.6]);

    function selectEllipse(~, ~, ~)
        imshow(sourceImage, [], 'Parent', hdl.axes);
        roiCounter = roiCounter + 1;
        h = imellipse(hdl.axes);
        mask = uint16(createMask(h));
        wait(h);            
        roiData(roiCounter).mask = mask;
    end

    function selectPolygon(~, ~, ~)
        imshow(sourceImage, [], 'Parent', hdl.axes);
        roiCounter = roiCounter + 1;
        h = impoly(hdl.axes);
        mask = uint16(createMask(h));
        wait(h);
        roiData(roiCounter).mask = mask;
    end

    function abort(~, ~, ~)
        cla(hdl.axes)
        % I need something else here... (see above)
    end

% Pause until figure is closed
waitfor(hdl.mainfig);

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:30:30.513

试试这个：

```
function roiData = testGUI(sourceImage)
% Initialize main figure
hdl.mainfig = figure();

% Initialize roiData and roiCounter
roiData    = [];
roiCounter = 0;

% Select Elliptical ROI button
hdl.selectEllipseButton = uicontrol(hdl.mainfig, 'Units', 'normalized', 'Position',[0.05 0.7 0.2 0.1], 'String', 'Select Ellipse', 'Callback', @selectEllipse);
% Select Polygonal ROI button
hdl.selectPolygonButton = uicontrol(hdl.mainfig, 'Units', 'normalized', 'Position',[0.05 0.6 0.2 0.1], 'String', 'Select Polygon', 'Callback', @selectPolygon);
% Abort Button
hdl.abort = uicontrol(hdl.mainfig, 'Units', 'normalized', 'Position',[0.05 0.2 0.2 0.2], 'String', 'Abort', 'Callback', @abort);
% Axes
hdl.axes = axes('Parent',hdl.mainfig, 'Units', 'Normalized', 'Position', [0.35 0.2 0.6 0.6]);

% Callbackrunning parameter
callbackrunning = false;

    function selectEllipse(hObject,eventdata)   
        if(callbackrunning)
            return;
        end

        callbackrunning = true;

        imshow(sourceImage, [], 'Parent', hdl.axes);
        roiCounter = roiCounter + 1;
        h = imellipse(hdl.axes);
        if(~callbackrunning)
            return;
        end
        mask = uint16(createMask(h));
        roiData(roiCounter).mask = mask;

        callbackrunning = false;
    end

    function selectPolygon(hObject,eventdata)   
        if(callbackrunning)
            return;
        end

        callbackrunning = true;

        imshow(sourceImage, [], 'Parent', hdl.axes);
        roiCounter = roiCounter + 1;
        h = impoly(hdl.axes);
        if(~callbackrunning)
            return;
        end
        mask = uint16(createMask(h));
        roiData(roiCounter).mask = mask;

        callbackrunning = false;
    end

    function abort(hObject,eventdata)   
        if(callbackrunning)
            disp('Fire escape key to cancel previous imrect');
            % Create robot that fires an escape key
            robot = java.awt.Robot;
            robot.keyPress    (java.awt.event.KeyEvent.VK_ESCAPE);
            robot.keyRelease  (java.awt.event.KeyEvent.VK_ESCAPE);   
            callbackrunning = false;
        end
    end

% Pause until figure is closed
waitfor(hdl.mainfig);
end 
```

机器人对象触发取消不正确的退出键。

# jquery - 如何使用 jquery 和 rails 3 发送具有嵌套形式的动态参数？

> ID：15467173
> 
> 赞同：1
> 
> 时间：2013-03-17T22:44:46.430
> 
> 标签：jquery, ruby-on-rails, parameters, nested-forms

我是 Rails 新手，我正在尝试使用 jquery 实现我自己的动态字段。我已经将字段添加到表单中，但是我的参数没有按照我想要的方式发送。这是我的 jQuery：

```
$('form').on('click', '#add_ingredient', function(){
    count = 1;
    field = $('#ingredient_list li').first()
        .clone()
            .find('input')
                .val('')
                    .end()
                        .find('input')
                            .prop({id: 'entry_ingredients_attributes_' + count + '_name', name: 'entry[ingredients_attributes][' + count +'][name]'  })
                                .end();
    $('#ingredient_list').append(field);
    count += 1;
}) 
```

这允许我添加多个列表项，并且它们的 id 和名称会递增，因此它们是唯一的。

我已经正确设置了模型以使用 Accepts_nested_attributes_for，我正在创建一个烘焙日志，其中包含模型条目、成分和关联条目成分。我的问题如下：

当我提交表单时，即使我添加了多个字段，我也只会发送一种成分，只有最后一个会被提交。这是我提交包含超过 1 个成分的表单时我的参数的输出：

```
"ingredients_attributes"=>{"0"=>{"name"=>"Flour", "_destroy"=>"false"}, "1"=>{"name"=>""}}}} 
```

如果您有兴趣了解它是如何创建的，这也是我的表格：

```
 <div id="ingredients">
      <%= f.fields_for :ingredients, @entry.ingredients.build do |builder| %>
      <%= render 'ingredient_fields', :f => builder %>
      <% end %>
  </div>
  <div id='add_ingredient'>Add Ingredient</div>
  <div class="actions">
    <%= f.submit %>

#_ingredient_fields
<ul id="ingredient_list">
    <li>
      <%= f.label :name %>
      <%= f.text_field :name %>
      <%= f.hidden_field :_destroy %>
      <%= link_to "Remove", "#", :class => "remove_fields" %>
    </li>
</ul> 
```

谁能指出我正确的方向？

* * *

**解决方案**

按照 Zaid Crouch 在下面答案中的建议，结果证明我的选择器没有做正确的事情。我的 JS 现在是这样的：

```
$('form').on('click', '#add_ingredient', function(){
    count = $('#ingredient_list li').length;
    field = $('#ingredient_list li').first()
        .clone()
            .find('input')
                .val('')
                    .end()
                        .find('input :first')
                            .prop({id: 'entry_ingredients_attributes_' + count + '_name', name: 'entry[ingredients_attributes][' + count +'][name]'  })
                                .end()
                                    .find('input :last')
                                        .prop({id: 'entry_ingredients_attributes_' + count + '__destroy', name: 'entry[ingredients_attributes][' + count +'][_destroy]', value: 'false'  })
                                            .end();
    $('#ingredient_list').append(field);
}) 
```

如果有人可以推荐一种更好的方法来选择那些我正在更改属性的元素，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:07:04.873

如果您只收到提交的最后一个值，那么这可能是一个很好的提示，表明您有带重复的输入`names`。您应该能够通过检查 .js 添加的 html（使用 firebug 或 webkit 检查器）来验证是否发生了这种情况。

查看您的函数，您正在初始化函数中的`count`变量；一旦函数返回，它就会超出范围，因此每次调用函数时都会使用`count = 1`. 您应该可以通过更改来解决此问题

```
count = 1; 
```

到

```
count = $('#ingredient_list li').length; 
```

（你也可以去掉函数末尾的增量，因为它什么都不做）。

您还需要确保更新`_destroy`隐藏字段的名称和 ID。

# c# - WPF 中的多线程编程

> ID：15467174
> 
> 赞同：1
> 
> 时间：2013-03-17T22:45:19.587
> 
> 标签：c#, wpf, .net-4.5

当我将浏览器控件传递给跟踪浏览器控件值的后台任务时，出现此错误。我需要对代码进行哪些更改，以便我可以安全地将这个浏览器控件传递给我的后台爬虫类。

**错误**

```
The calling thread must be STA, because many UI components require this. 
```

这是我将浏览器控制传递给我的后台单例类的方式。

```
 public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            brwser.Navigate("https://xyz.com");
        }

        private void Button_Click_1(object sender, RoutedEventArgs e)
        {
            Task.Factory.StartNew(() =>
           {
               if (BfScrapper.Instance.CanStart)
                   BfScrapper.Instance.StartTask(brwser);
           });
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:08:17.353

您必须启动一个正在运行 STA 线程的任务。

为此，您需要使用[TaskScheduler.FromCurrentSynchronizationContext](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskscheduler.fromcurrentsynchronizationcontext.aspx)（假设您从中创建任务的线程本身就是一个 STA 线程）。

您可以将其传递给接受 TaskScheduler 参数的[TaskFactory.StartNew的重载之一。](http://msdn.microsoft.com/en-gb/library/dd321439.aspx)

例如：

```
Task.Factory.StartNew
(
    () =>
    {
        if (BfScrapper.Instance.CanStart)
            BfScrapper.Instance.StartTask(brwser);
    },
    CancellationToken.None,
    TaskCreationOptions.None,
    TaskScheduler.FromCurrentSynchronizationContext()
); 
```

我还建议您使用谷歌*FromCurrentSynchronizationContext STA*，因为这些东西远非显而易见，并且会产生影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:19:26.547

我猜您正在尝试更改传递的 UI 元素中的某些内容。最简单的方法是这样的：

`UIElement.Dispatcher.BeginInvoke(/*do stuff here*/);`

我有一个方便的扩展方法：

```
public static DispatcherOperation DispatcherCall<T>(this T obj, Action action, DispatcherPriority priority) where T : DispatcherObject
        {
            return obj.Dispatcher.BeginInvoke(priority, action);
        } 
```

用法如下所示：

```
mLabel.DispatcherCall(() => mLabel.Text = "Test...", DispatcherPriority.Normal); 
```

这避免了总是不得不在同步上下文之间来回切换的相当大的成本

# javascript - 使用 javascript/hmlt5 的类库项目。是否可以？

> ID：15467178
> 
> 赞同：0
> 
> 时间：2013-03-17T22:46:13.913
> 
> 标签：javascript, html, windows-runtime, windows-store-apps, winjs

我正在学习使用 java-script 和 html5 创建 Windows 8 商店应用程序。我的问题是，如果我需要为这个项目创建一些类库，可以使用 javascript/html5 创建这些类库吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T01:18:15.500

使用 HTML 和 JavaScript 为 Windows 应用商店应用程序创建可重用的 JavaScript 库非常简单。

首先创建一个新的 JavaScript 文件，使用您喜欢的任何名称（理想情况下应该是唯一的），例如 myMathLib.js。

使用模块模式启动你的库，就像这样（注意，最后的括号会导致匿名函数内的所有代码在文件加载时立即执行，这对于设置变量、对象等很有用，有时会提到to 作为立即调用的函数表达式）：

```
(function () {

// your library code

})(); 
```

这将防止匿名函数内的任何变量或对象对外界可见，除非您明确选择公开它。

接下来，添加您希望库具有的任何变量和/或函数。例如，如果我们正在构建一个数学库，我们可能有一个 add 函数：

```
(function () {

    function add(num1, num2) {
        return num1 + num2;
    }

})(); 
```

显然，此时库不是很有用，因为库外的代码无法访问 add 函数。因此，对于 Windows Store 应用程序，我们可以使用方便的 WinJS.Namespace.define 函数：

```
(function () {

    WinJS.Namespace.define('myMathLib', {
        addTwoNumbers: add
    });

    function add(num1, num2) {
        return num1 + num2;
    }

})(); 
```

为了定义命名空间及其成员，我们首先传递命名空间的名称，我们将通过它引用成员（在本例中为“myMathLib”），然后传递一个具有一个或多个名称/值对的对象，其中name 是我们从库外部引用成员的名称，value 是内部名称。这意味着我们可以在内部和外部使用不同的名称。

我们简单的 JavaScript 库已经可以使用了。要使用它，我们需要在 HTML 页面中引用它，就像使用任何其他 JavaScript 文件一样，通过添加引用我们文件的标签：

```
<script src="/js/myMathLib"></script> 
```

然后在该页面的 JavaScript 中，我们可以使用以下代码来执行我们的库函数：

```
var num1 = 2, num2 = 40, result;
result = myMathLib.addTwoNumbers(num1, num2)
// result = 42 
```

您可以使用此技术来构建可重用的库，这些库可以根据需要简单或复杂。另一个需要注意的有用的 WinJS 实用程序是[WinJS.Class.define](http://msdn.microsoft.com/en-us/library/windows/apps/hh967790.aspx)（以及 WinJS.Class 中的其他函数），它有助于在 JavaScript 中创建类型。

希望这可以帮助！

有关 Windows 应用商店应用开发的更多信息，请注册[App Builder](http://bit.ly/gd30tolaunch)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:46:36.067

我不太确定你在问什么，但是...

您始终可以创建可重用的 javascript 库。实际上，有很多这样的例子（jquery、knockoutjs、prototype 等）。

如果您是 javascript 新手，学习 jquery 之类的东西可以帮助您学习如何编写可重用的 javascript 代码。

# xcode4 - 如何识别 IF 语句中加载的先前 ViewController

> ID：15467181
> 
> 赞同：0
> 
> 时间：2013-03-17T22:46:47.300
> 
> 标签：xcode4, uiviewcontroller, nsstring

我有一个名为 stringToDisplay 的 NSString，如果访问了某个 ViewController，我想在其中分配一个不同的值。我怎么能设置这个？这甚至可能吗？...我想要的示例：

```
If ([prevViewController.visited] == Yes)
{
   stringToDisplay = value2;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:25:20.743

假设您使用的是导航控制器，您可以这样做：

```
NSArray *views = self.navigationController.viewControllers;
UIViewController *previous = [views objectAtIndex:[views count]-2]; 
```

`[views objectAtIndex:[views count]-1]`当前的 ViewController在哪里；

# javascript - 停止循环的 javascript 画布动画

> ID：15467187
> 
> 赞同：1
> 
> 时间：2013-03-17T22:47:23.850
> 
> 标签：javascript, html, loops, animation, canvas

当对象与另一个对象碰撞时，我希望它只动画一次，此时它第一次动画很好，然后第二次，第三次等一直在后台运行。

```
var imgEx = new Image();
imgEx.src = 'images/explosion.png';

var xpos = 0;
var ypos = 0;
var index = 0; 
var numFrames = 74; 
var frameSize = 100;

function explosion () {
xpos += frameSize;

index += 1;

if (index >= numFrames) {
xpos =0;
ypos =0;
index=0;    
return;             
} 
else if (xpos + frameSize > imgEx.width){
xpos =0;
ypos += frameSize;
}
} 
```

这是我称之为动画的磨损。

```
 Jet.prototype.checkEnemyCollision = function () {
    for (var i = 0; i < enemies.length; i++) {
        if (this.drawX < enemies[i].drawX + enemies[i].width && this.drawX + this.width > enemies[i].drawX && this.drawY < enemies[i].drawY + enemies[i].height && this.drawY + this.height > enemies[i].drawY) {
            if (score > highScore) {
                highScore = score;
            }

            // Added the functions below, removed score = 0

            ctxGameOver.drawImage(imgEx, xpos, ypos, frameSize, frameSize, (jet1.drawX - 50), (jet1.drawY - 50), frameSize, frameSize);
            if (xpos < 800) {
                setInterval(explosion, 1000 / 74);
            }
            if (xpos === 800) {
                stopLoop();
                clearCtxGame();
                gameOver();
            }
        }
    }
}; 
```

基本上我已经制作了一个游戏，当喷气机击中一个物体时，它会显示一个动画并将我带到屏幕上的游戏，当我再次按下播放时，动画已经在背景中循环播放并减慢游戏速度，如果我碰巧一次玩 3 或 4 次游戏，它在后台运行循环 3/4 次，使游戏非常慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T16:59:42.990

您可以尝试以下方法。将间隔分配给一个变量，然后在游戏结束时将其清除。

```
 if (xpos < 800) {
            this.explosion = setInterval(explosion, 1000 / 74);
        }
        if (xpos === 800) {
            stopLoop();
            clearInterval(this.explosion);
            clearCtxGame();
            gameOver();
        } 
```

或者我认为更好的方法，

```
 if (xpos < 800) {
            explosion();
        } 
```

爆炸功能。

```
function explosion() {
    xpos += frameSize;

    index += 1;

    if (index >= numFrames) {
        xpos = 0;
        ypos = 0;
        index = 0;
        return;
    } else if (xpos + frameSize > imgEx.width) {
        xpos = 0;
        ypos += frameSize;
        setTimeout(explosion, 1000 / 74);
    }
} 
```

所以基本上发生的事情是你调用`explosion()`，然后`explosion()`在它停止时让函数处理。如果它完成了`timeOut`，它不会被调用，它会自行停止。

# c# - 使用 SCPI 通过 GPIB 和 RS-232/COM 进行通信

> ID：15467190
> 
> 赞同：0
> 
> 时间：2013-03-17T22:47:37.707
> 
> 标签：c#, com, serial-port, gpib

我目前正在寻找通过 C# 与[SCPI](https://en.wikipedia.org/wiki/Standard_Commands_for_Programmable_Instruments)兼容设备进行通信的不同可能性。我已经通过 COM 接口在 LabWindows/CVI（语言：C）中编写了我的第一个代码，并且正如我所说的那样“手动”完成了它：

```
ComOpen(ComId, "Com1",....);
ComWrite("SYST:...\r");
ComRead(&value)` 
```

像这样的东西。对我来说，问题是我不喜欢纯 C，而且缺乏 OOP 只是愚蠢的，因为我有想要交流的真实对象。亲爱的 National Instruments，为什么不使用 OOP 来控制对象呢？

现在有人给了我提示，我应该查看全局 SCPI 文档，因为信息比设备手册中的要多。而且我发现了一组与 .NET 兼容的命令。例如，

```
IIviDCPwr Ivi.DCPwr.Create(String resourceName,
                           Boolean idQuery,
                           Boolean reset,
                           LockType lockType,
                           String accessKey,
                           String options); 
```

与 SCPI 设备建立面向对象的通信。因为我真的很喜欢 C#，所以我想在接下来的几周内尝试一下。

但我真的看不到连接设置，因为 resourceName 似乎只是之后释放所考虑设备的名称，而其他设置在连接已设置时使用。IIviDCPwr 的实例如何知道应该使用哪个连接（TCP/IP、COM 或 GPIB）？

我只看到了使用套接字的 TCP/IP 解决方案。但我认为这不适用于 COM 和 GPIB？

另一种解决方案是使用 National Instruments VISA 包。但是我不喜欢使用 NI 提供的专有包的想法（我认为使用 CVI 后我觉得新开发的对 NI 的排斥）。

你能提供代码片段或文档来处理这个问题吗？你有使用VISA的经验吗？我可以使用套接字进行 COM/GPIB 通信吗？

顺便说一句：如何在代码片段中创建新行？enter 和`Shift`+ `Enter`, \r, \n, \ 都不适合我...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-24T12:28:25.580

您可以使用 .NET [SerialPort](https://msdn.microsoft.com/en-us/library/system.io.ports.serialport(v=vs.110).aspx)和[Socket](https://msdn.microsoft.com/en-us/library/system.net.sockets.socket%28v=vs.110%29.aspx?f=255&MSPPError=-2147217396)（不使用 VISA）通过它们的读/写方法与您的设备进行通信。关于 GPIB，您的硬件应该有一个 .NET 驱动程序，使用类似的方法。

如何使用 SerialPort 与设备通信的一些示例（带有一些伪 SCPI）

```
 SerialPort port = new SerialPort("COM1", 9600);
        port.Open();
        port.WriteLine(":DEVICE:OUT 1"); //turn on
        port.WriteLine(":DEVICE:MEAS:VOLT?"); //measure voltage
        float v = float.Parse(port.ReadLine()); //reading from device
        Console.WriteLine("The measured voltage is " + v ); 
```

现在您可以创建设备类，其中每个实例都有自己的协议（SerialPort、Socket、GPIB）和方法

```
public class SomeDevice
{
    private SerialPort _port;
    public SomeDevice(string  serialPortName)
    {
        // do the connection work...
    }
    public void SetVoltage(float voltage)
    {
        port.WriteLine(":VOLT " + voltage.ToSring("N2"));
    }
    public float GetVoltage()
    {
        port.WriteLine(":DEVICE:MEAS:VOLT?");
        return float.Parse(port.ReadLine()); //reading from device
    } 
```

}

您甚至可以通过创建通用连接的接口（比如说 - GenConnection）（使用常见的读/写方法）来改进您的类以使用任何类型的连接（SerialPort、Socket、GPIB ...），并且然后创建实现此接口的连接类型的子节点 - 然后您的每个设备将只有 GenConnection 实例，而不“知道”它实际上是哪种连接（只需重载每种连接的构造函数）

需要记住的几点：

*   编程手册有助于避免常见错误
*   连接配置（波特率、奇偶校验...）
*   行尾字符，您应该记住使用设备行尾发送和分隔读数 - 通常`<CR>`或`<CR><LF>`（C# 中的“\r”或“\r\n”）。

    SerialPort 的`ReadLine`&`WriteLine`正在使用指定的 SerialPort`NewLine`属性为您执行此操作

*   您可以使用[TeraTerm](http://logmett.com/tera-term-the-latest-version)使用您的端口和套接字来按预期查看所有内容

# java - 线程“主”java.lang.NullPointerExceptionat Board 中的异常。在 (Board.java:23) 在 PiratesDriver.main(PiratesDriver.java:14)

> ID：15467197
> 
> 赞同：1
> 
> 时间：2013-03-17T22:48:28.297
> 
> 标签：java, jcreator

嗨，我收到此错误消息，我需要帮助

```
Exception in thread "main" java.lang.NullPointerException
at Board.<init>(Board.java:23)
at PiratesDriver.main(PiratesDriver.java:14) 
```

我的代码是

```
import java.util.Scanner;
import java.util.Random;
public class Board {
private final int SIZE=30;
private final int NUM_PLAYERS=2;
**private int diffLevel;**
private Player[] players= new Player[NUM_PLAYERS];
private char[] hurdles=new char[SIZE];

public Board() {
    System.out.println("|||||||||||||||||||||||||||||||||||||||||||||"+"\n||||||||||||||||||||START||||||||||||||||||||\n"+"|||||||||||||||||||||||||||||||||||||||||||||" );
    System.out.print("Enter Diffculty Level for the Game (0=easy, 1=50/50 i.e. not too easy, not too hard, 2=HARD):");
    **SetDifficulty();**
    System.out.println("");
    players[0].SetName(GetPlayerName(0));
    System.out.println("");
    players[1].SetName(GetPlayerName(1));
    DisplayPlayerDetails();
    System.out.println("");
    System.out.println("<<<--GAME BOARD LEGEND-->>>");
    System.out.println("e = This cell contains an easy enemy pirate.");
    System.out.println("t = This cell contains a treasure island.");
    System.out.println("a = This cell contains an abandoned ship.");
    System.out.println("m = This cell contains a mystery island.");
    System.out.println("j = This cell contains a magic chamber.");
    System.out.println(",P = This cell has a player in it.");
    System.out.println("<<<------- ----- ------->>> ");
    System.out.println("");
    SetHurdles();
    DisplayBoard();
}

**void SetDifficulty(){
    Scanner scan= new Scanner(System.in);

    boolean invalid = true;
    diffLevel= scan.nextInt();
    while (!((diffLevel <=2) && (diffLevel>=0))){
        System.out.println("Error, please enter a valid value");
         diffLevel= scan.nextInt();**

    }

}
public String GetPlayerName(int index){
    Scanner scan= new Scanner(System.in);
    System.out.print("Enter Player "+(index+1)+"'s Name: ");
    String playername= scan.nextLine();
    System.out.println(playername+" has no Voodoo doll.");
    System.out.println(playername+" does not have a Ship.");
    return playername;
}
public void DisplayPlayerDetails(){
    System.out.println("------------- PLAYER DETAILS -------------");
    for (int i=0;i<players.length;i++){
        System.out.println("-->Player "+(i+1)+"<--");
        System.out.println("Name: "+players[i].GetName());
        System.out.println("Health: "+players[i].GetHealth()+" potions");
        System.out.println("Treasure: "+players[i].GetWealth()+" gold coins");
        System.out.println("Weapon: "+players[i].WeaponName(players[i].GetWeapon()));
        System.out.println("Voodoo Doll: "+players[i].GetVoodoo());
        System.out.println("Ship: "+players[i].GetShip());
        System.out.println("Position: "+(players[i].GetPosition()+1));
        System.out.println("     ------><------");
    }
    System.out.println("---------------------------------------------");

}
public void SetHurdles(){
    Random randNumGenerator = new Random();
    boolean bool=true;
    int rand;
    int e,h,t,a,m,j;
    if (diffLevel==0){
        e=12;
        h=0;
        }
    else if (diffLevel==1){
        e=6;
        h=6;
    }
    else {
        h=12;
        e=0;
    }
    t=6;
    a=6;
    m=3;
    j=3;
    for (int i=0;i<hurdles.length;i++){

        while(bool){
            rand=randNumGenerator.nextInt(6);
            if (rand==0&& e!=0){
                hurdles[i]='e';
                e--;
                bool=false;
            }
            else if (rand==1&& h!=0){
                hurdles[i]='h';
                h--;
                bool=false;
            }
            else if (rand==2&& t!=0){
                hurdles[i]='t';
                t--;
                bool=false;
            }
            else if (rand==3&& a!=0){
                hurdles[i]='a';
                a--;
                bool=false;
            }
            else if (rand==4&& m!=0){
                hurdles[i]='m';
                m--;
                bool=false;
            }
            else if (rand==5&& j!=0){
                hurdles[i]='j';
                j--;
                bool=false;
            }
            bool=true;
        }
    }

    }
    public void DisplayBoard(){
        System.out.println("---------------------------------------------");
        System.out.println("********PIRATES OF 125 GAME BOARD********");
        for (int i=0;i<5;i++){
            if ((players[0].GetPosition()==i)||(players[1].GetPosition()==i))
                System.out.print((i+1)+":   "+hurdles[i]+"P");
             else 
                System.out.print((i+1)+":   "+hurdles[i]);
        }
        System.out.println("");
        for (int i=5;i<10;i++){
            if ((players[0].GetPosition()==i)||(players[1].GetPosition()==i))
                System.out.print((i+1)+":   "+hurdles[i]+"P");
             else 
            System.out.print((i+1)+":   "+hurdles[i]);
        }
        System.out.println("");
        for (int i=10;i<15;i++){
            if ((players[0].GetPosition()==i)||(players[1].GetPosition()==i))
                System.out.print((i+1)+":   "+hurdles[i]+"P");
             else 
            System.out.print((i+1)+":  "+hurdles[i]);
        }
        System.out.println("");
        for (int i=15;i<20;i++){
            if ((players[0].GetPosition()==i)||(players[1].GetPosition()==i))
                System.out.print((i+1)+":   "+hurdles[i]+"P");
             else 
            System.out.print((i+1)+":  "+hurdles[i]);
        }
        System.out.println("");
        for (int i=20;i<25;i++){
            if ((players[0].GetPosition()==i)||(players[1].GetPosition()==i))
                System.out.print((i+1)+":   "+hurdles[i]+"P");
             else 
            System.out.print((i+1)+":  "+hurdles[i]);
        }
        System.out.println("");
        for (int i=25;i<30;i++){
            if ((players[0].GetPosition()==i)||(players[1].GetPosition()==i))
                System.out.print((i+1)+":   "+hurdles[i]+"P");
             else 
            System.out.print((i+1)+":  "+hurdles[i]);
        }
        System.out.println("");
        System.out.println("---------------------------------------------");
    }
    public void Play(){
        Board game=new Board();
        for (int i=0; i<players.length;i++){
            DisplayPlayerDetails();
            while(players[i].GetPosition()<hurdles.length){

            players[i].Move();
            if (hurdles[players[i].GetPosition()]=='e'){
                EasyPirate e= new EasyPirate();

            }
            }

        }       
    }
} 
```

我的主要动力是

```
public class PiratesDriver {

     public static void main(String[] args) {
Board piratesOf125 = new Board(); //Instantiate a new board
piratesOf125.Play(); //Play the game 

 }
} 
```

我已经尝试了一个多小时了，我知道问题出在我的 diffLevel 为 null 之类的问题上，但我似乎无法修复它，我猜我必须在 SetDifficulty() 中修复它这就是 diffLevel 定义的地方。需要帮助。哦，第 14 行是私有的 int diffLevel；

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:25:15.273

写

```
players[0] = new Player();
players[1] = new Player(); 
```

在开始，然后使用它。请记住：当您创建数组的新实例时，您会在单元格中使用 null（默认）值创建它。您必须在使用它之前创建对象的实例。

也可以看看：

*   [在 Java 中创建对象数组](https://stackoverflow.com/questions/5364278/creating-an-array-of-objects-in-java)。
*   [对象数组](http://www.oopweb.com/Java/Documents/ThinkCSJav/Volume/chap11.htm)

# java - 字段中的列“”不明确

> ID：15467206
> 
> 赞同：0
> 
> 时间：2013-03-17T22:49:05.690
> 
> 标签：java, mysql, jdbc, sql-update

我在 java 中使用 MySQL。

我正在尝试更新表“regApartmentsTable”、“gardApartmentsTable”、“penthousesTable”之一中的“所有者”字段，该表为空，对应于特定的公寓编号和街道，并将其替换为字符串“newOwners”。

为此，我编写了以下代码：

```
st=connection.prepareStatement("UPDATE regApartmentsTable,gardApartmentsTable,penthousesTable SET owners=? " +
                "WHERE owners=? AND apartmentNum=? AND street=?");
st.setString(1, newOwners);
st.setString(2, "");
st.setInt(3, apartmentNum);
st.setString(4, streetName+" "+buildingNum); 
```

我包括 3 个表格，因为我需要查看所有表格。（所需的公寓，没有所有者，并且与公寓编号和街道相匹配，如果它可以帮助任何人，则不能在一张以上的桌子上）。

但是，当我尝试运行此代码时，我收到“字段中的列‘所有者’不明确”错误。任何想法我应该如何编写 SQL 命令？提前谢谢！

编辑：我没有得到足够的答案来解决我的问题......好吧，我知道异常会引发，因为“所有者”字段在这三个表中很常见。然而，我该如何解决这个问题？我无法在表格名称中添加前缀，因为我不知道要在哪个表格中找到所需的公寓……如果我知道，我就不会在 3 个表格中进行搜索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:18:22.817

MySQL中的多表UPDATE只是表连接、使用`regApartmentsTable.owners`等的一种形式。

您需要对此处的每个表进行单独的 UPDATE，因为连接不是您想要更新的内容。或者做一个基表。

```
str = connection.prepareStatement("UPDATE regApartmentsTable SET owners=? " +
                "WHERE owners=? AND apartmentNum=? AND street=?");
str.setString(1, newOwners);
str.setString(2, "");
str.setInt(3, apartmentNum);
str.setString(4, streetName+" "+buildingNum);

str = connection.prepareStatement("UPDATE gardApartmentsTable SET owners=? " +
                "WHERE owners=? AND apartmentNum=? AND street=?");
stg.setString(1, newOwners);
stg.setString(2, "");
stg.setInt(3, apartmentNum);
stg.setString(4, streetName+" "+buildingNum);

stp = connection.prepareStatement("UPDATE penthousesTable SET owners=? " +
                "WHERE owners=? AND apartmentNum=? AND street=?");
stp.setString(1, newOwners);
stp.setString(2, "");
stp.setInt(3, apartmentNum);
stp.setString(4, streetName+" "+buildingNum); 
```

# iphone - 在 UILabel 中使用 Unicode

> ID：15467207
> 
> 赞同：2
> 
> 时间：2013-03-17T22:49:12.867
> 
> 标签：iphone, objective-c, unicode, nsstring, uilabel

我有一个`UILabel`, 并且我想要一个 unicode 字符。我在另一个应用程序中看到了这个示例代码，它运行良好；但是，在我的应用程序中，我得到了一个空白方块。任何帮助将非常感激！

```
[self.button setTitle:@"\uf05a" forState:UIControlStateNormal]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T22:53:59.103

这是因为该 Unicode 转义中包含的汉字*不是*有效的 Unicode 字符。这意味着虽然它可能存在于 Unicode 规范中，但尚未实现或标准化，因此 UILabel 无法呈现它。与字体设计师交谈，了解如何在自定义字体包中获取该字形，或使用其他字体。

# java - 我希望图片在滚动时留在 jscrollpane 的左上角

> ID：15467210
> 
> 赞同：5
> 
> 时间：2013-03-17T22:49:22.227
> 
> 标签：java, swing, jscrollpane, imageicon, jviewport

我在 JScrollpane 中有一个 JPanel。我在显示在 JPanel 上的 BufferedImage 上绘图。在 JScrollpane 的左上角，我想要一张图片，当我向下滚动查看我的 JPanel 的其余部分时，它总是停留在那个角落。这里是 Jpanel 的 paintComponent 方法：

```
@Override
public void paintComponent(Graphics g){
    super.paintComponent(g);
    if (bufferedImage != null){
        g.drawImage(bufferedImage, 0, 0, this);
        Point p = parent.getViewPosition();
        System.out.println("paintComponent(): "+ p.x + "," + p.y);
        g.setColor(Color.RED);
        g.fillRect(p.x + 20, p.y + 20, 200, 200);
    }
} 
```

parent.getViewPosition() 在哪里给我 scrollPane.getViewport().getViewPosition()。当我启动时，我可以看到左上角带有红色矩形的缓冲图像。当我向下滚动时，我可以看到缓冲图像的其余部分，但是红色矩形向上移动然后消失，并且当我向上滚动时不再出现。在控制台中，我可以看到滚动时点 p 发生了变化：

```
paintComponent(): 0,0
paintComponent(): 0,10
paintComponent(): 0,20
paintComponent(): 0,30
paintComponent(): 0,40
paintComponent(): 0,50 
```

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T00:08:41.550

您可以为此使用玻璃窗格并告诉它在取决于视口位置的位置绘制图像。例如：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Point;
import java.awt.RenderingHints;
import java.awt.image.BufferedImage;

import javax.swing.*;

@SuppressWarnings("serial")
public class ScrollImgGlass extends JPanel {
   private static final int BI_W = 40;
   private static final int BI_H = BI_W;
   private static final String[] DATA = { "One", "Two", "Three", "Four",
         "Five", "Six", "Seven", "Eight", "Nine", "Zero", "One", "Two",
         "Three", "Four", "Five", "Six", "Seven", "Eight", "Nine", "Zero",
         "One", "Two", "Three", "Four", "Five", "Six", "Seven", "Eight",
         "Nine", "Zero", "One", "Two", "Three", "Four", "Five", "Six", "Seven",
         "Eight", "Nine", "Zero" };
   private BufferedImage img = null;
   private JViewport viewport;

   public ScrollImgGlass(JViewport viewport) {
      setOpaque(false);
      this.viewport = viewport;
      img = new BufferedImage(BI_W, BI_H, BufferedImage.TYPE_INT_ARGB);
      Graphics2D g2 = img.createGraphics();
      g2.setColor(Color.red);
      g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
            RenderingHints.VALUE_ANTIALIAS_ON);
      g2.fillOval(0, 0, BI_W, BI_H);
      g2.dispose();
   }

   @Override
   protected void paintComponent(Graphics g) {
      Point vpLocation = viewport.getLocationOnScreen();
      Point gpLocation = getLocationOnScreen();

      int x = vpLocation.x - gpLocation.x;
      int y = vpLocation.y - gpLocation.y;

      super.paintComponent(g);
      if (img != null) {
         g.drawImage(img, x, y, this);
      }
   }

   private static void createAndShowGui() {
      JList<String> jList = new JList<String>(DATA);
      jList.setOpaque(false);

      JViewport viewport = new JViewport();
      JScrollPane scrollpane = new JScrollPane();
      scrollpane.setViewport(viewport);
      viewport.setView(jList);

      ScrollImgGlass glass = new ScrollImgGlass(viewport);

      JFrame frame = new JFrame("ScrollImg");
      frame.setGlassPane(glass);
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(scrollpane, BorderLayout.CENTER);

      // just to show that this works if the viewport is shifted over
      frame.getContentPane().add(Box.createRigidArea(new Dimension(20, 20)), BorderLayout.NORTH);
      frame.getContentPane().add(Box.createRigidArea(new Dimension(20, 20)), BorderLayout.WEST);

      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);

      glass.setVisible(true);
   }

   public static void main(String[] args) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            createAndShowGui();
         }
      });
   }
} 
```

会显示如下：

![在此处输入图像描述](../Images/032a557442fa4ba6301385d24aceee64.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-18T02:36:29.060

正如 MadProgrammer 所建议的，JLayer 确实有效：

```
import java.awt.*;
import javax.swing.*;
import javax.swing.plaf.*;

public class FixedImageLayerUI extends LayerUI<JComponent>
{
    @Override
    public void paint(Graphics g, JComponent c)
    {
        super.paint(g, c);

        Graphics2D g2 = (Graphics2D) g.create();

        g2.setColor( Color.RED );
        g2.fillOval(0, 0, 10, 10);

        g2.dispose();
    }

    private static void createAndShowUI()
    {
        String[] data =
        {
            "a", "b", "c", "d", "e", "f", "g", "h", "i", "j",
            "k", "l", "m", "n", "o", "p", "q", "r", "s", "t",
            "u", "v", "w", "x", "y", "z"
        };

        JList<String> list = new JList<String>( data );
        JScrollPane scrollPane = new JScrollPane( list );

        LayerUI<JComponent> layerUI = new FixedImageLayerUI();
        JLayer<JComponent> layer = new JLayer<JComponent>(scrollPane, layerUI);

        JFrame frame = new JFrame("FixedImage");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add( layer );
        frame.pack();
        frame.setLocationByPlatform( true );
        frame.setVisible( true );
    }

    public static void main(String[] args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                createAndShowUI();
            }
        });
    }
} 
```

此外，正如 MadProgrammer 所指出的，覆盖 JScrollPane 的绘制方法不起作用。但是，如果您使 JList 不透明，它确实可以工作：

```
import java.awt.*;
import javax.swing.*;
import javax.swing.plaf.*;

public class FixedImageScrollPane
{

    private static void createAndShowUI()
    {
        String[] data =
        {
            "a", "b", "c", "d", "e", "f", "g", "h", "i", "j",
            "k", "l", "m", "n", "o", "p", "q", "r", "s", "t",
            "u", "v", "w", "x", "y", "z"
        };

        JList<String> list = new JList<String>( data );
        list.setOpaque( false );

        JScrollPane scrollPane = new JScrollPane( list )
        {
            @Override
            public void paint(Graphics g)
            {
                super.paint(g);
                g.setColor( Color.RED );
                g.fillOval(0, 0, 10, 10);
            }
        };

        JFrame frame = new JFrame("FixedImage");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add( scrollPane );
        frame.pack();
        frame.setLocationByPlatform( true );
        frame.setVisible( true );
    }

    public static void main(String[] args)
    {
        EventQueue.invokeLater(new Runnable()
        {
            public void run()
            {
                createAndShowUI();
            }
        });
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T23:42:38.717

不要将图片放在滚动的面板中。将其放在不同的面板中，并使用布局管理器排列两个面板。

我建议看一下 BorderLayout；它在 n、s、e 和 w 处有区域，并且在中心有一个区域，但您不必使用所有这些区域（很少使用所有这些区域）。您可以创建一个 JPanel，将其布局管理器设置为 BorderLayout，将包含您的图像的面板放在该面板的 NORTH 部分，然后将您的滚动面板放在 CENTER 中。作为免费的奖励，当/如果调整窗口大小时，位于中心的 JPanel 将在两个维度上拉伸，因为这就是 BorderLayout 的工作方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-18T01:17:14.853

在您的代码中的某处，您创建了一个 JScrollPane。

改变

```
 final JScrollPane scrollpane = new JScrollPane(); 
```

到：

```
 final JScrollPane scrollpane = new JScrollPane() {
        @Override
        public void paint(final Graphics g) {
            super.paint(g);
            // Put you drawing here...example, draw a geen dot...
            g.setColor(Color.GREEN);
            g.fillOval(0, 0, 30, 30);
        }
    }; 
```

编辑：根据评论，需要对放置在 JScrollPane 中的对象执行 setOpaque(false)。

例子：

```
 list.setOpaque(false);
    scrollpane.setViewportView(list); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-25T18:41:33.390

好的，以下代码适用于 JTabbedPane。我必须在选项卡式窗格中的面板中添加一个 componentListener，因为当窗格不在屏幕上时，方法“getLocationOnScreen()”出现异常。

```
public class GlassFrame {
    private JPanel panel;
    private JScrollPane scrollPane;
    private BufferesImage img;

    public GlassFrame() {
        panel = new JPanel(){
            @Override
            public void paintComponent(Graphics g){
                super.paintComponent(g);
                img = new BufferedImage(500, 500, BufferedImage.TYPE_INT_ARGB);
                Graphics2D g2 = img.createGraphics();
                g2.setPaint(Color.WHITE);
                   Rectangle2D rect = new Rectangle2D.Float(0, 0, 420, 420);
                   g2.fill(rect);
                   g2.setPaint(Color.BLACK);
                   for (int i = 0; i <= 10; i++) {
                       g2.draw(new Line2D.Float(10 + i * 40,10,10 + i * 40,410));
                       g2.draw(new Line2D.Float(10,10 + i * 40,410,10 + i * 40));
                   }
                g2.dispose();
                g.drawImage(img, 0, 0, this);
            }
        };
        panel.setPreferredSize(new Dimension(420, 420));
        panel.setOpaque(false);

        scrollPane = new JScrollPane(panel, ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS,
                ScrollPaneConstants.HORIZONTAL_SCROLLBAR_ALWAYS);
        scrollPane.getVerticalScrollBar().setUnitIncrement(10);

        JFrame frame = new JFrame("ScrollPane and GlassPane");
        final GlassPane glass = new GlassPane(scrollPane.getViewport());
        frame.setGlassPane(glass);

        JTabbedPane tab = new JTabbedPane();
        JPanel panelInTab = new JPanel();
        panelInTab.setLayout(new BorderLayout());
        tab.add("first tab", panelInTab);
        tab.add("second tab", new JPanel());
        panelInTab.add(scrollPane, BorderLayout.CENTER);
        panelInTab.add(new JButton("testbutton"), BorderLayout.NORTH);
        panelInTab.addComponentListener(new ComponentAdapter() {
            @Override
            public void componentShown(ComponentEvent arg0) {
                glass.setVisible(true);
            }
            @Override
            public void componentHidden(ComponentEvent arg0) {
                glass.setVisible(false);
            }
        });

        frame.getContentPane().add(tab);    
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setPreferredSize(new Dimension(300, 400));
        frame.pack();
        frame.setLocation(200, 200);
        frame.setVisible(true);
        glass.setVisible(true);
    }

    class GlassPane extends JPanel{
        private JViewport viewport;
        private BufferedImage image = null;

        public GlassPane(JViewport viewport){
            setOpaque(false);
            this.viewport = viewport;
            image = new BufferedImage(58, 58, BufferedImage.TYPE_INT_ARGB);
            Graphics2D g2 = image.createGraphics();
            g2.setColor(Color.red);
            g2.setStroke(new BasicStroke(3.0f));
            g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                    RenderingHints.VALUE_ANTIALIAS_ON);
            g2.drawOval(5, 5, 50, 50);
            g2.dispose();
        }

        @Override
        protected void paintComponent(Graphics g) {
            Point vpLocation = viewport.getLocationOnScreen();
            Point gpLocation = getLocationOnScreen();

            int x = vpLocation.x - gpLocation.x;
            int y = vpLocation.y - gpLocation.y;

            super.paintComponent(g);
            if (image != null) {
                g.drawImage(image, x, y, this);
            }
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                GlassFrame frame = new GlassFrame();
            }
        });
    }
} 
```

# css - 带有 CSS 的 PHP 电子邮件在 gmail 上不起作用

> ID：15467211
> 
> 赞同：-1
> 
> 时间：2013-03-17T22:49:23.677
> 
> 标签：css, gmail, html-email

我已经阅读了很多关于此的线程，他们都说 gmail 不支持样式标签，所以我必须使用内联样式来解决问题。问题是我查看了我在 gmail 上收到的大多数电子邮件的源代码，其中大多数都使用 css 样式标签，这与其他人所说的相矛盾。

所以问题是，为什么我通过 php 邮件发送的带有 css 的电子邮件在 gmail 上没有正确显示。虽然它在 Yahoo 和 Hotmail 上显示正常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:36:47.070

对不提供具体细节的问题提供详细答案有点困难，所以我将发表一些一般性评论......

与为不同的电子邮件客户端设计 HTML 电子邮件相比，跨 Web 浏览器设计是小菜一碟。电子邮件客户端比网络浏览器多得多，它们对 HTML 和 CSS 渲染的支持也有更多变化。本身没有“标准”。

你需要保持一切简单并发挥最低的共同元素。这不仅仅是`style`标签是否实现的问题，不同的客户端可能支持也可能不支持不同的样式。您需要在尽可能多的客户端上试验哪些有效，哪些无效。

如果您还没有阅读这些内容，请为您阅读更多内容：

*   [http://css-tricks.com/using-css-in-html-emails-the-real-story/](http://css-tricks.com/using-css-in-html-emails-the-real-story/)
*   [http://coding.smashingmagazine.com/2012/03/13/techniques-overcome-poor-css-support-email/](http://coding.smashingmagazine.com/2012/03/13/techniques-overcome-poor-css-support-email/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T15:47:09.857

许多人在样式标签中使用 CSS 进行设计，然后在发送之前使用工具将其内联，使其与 Gmail 兼容。根据工具的不同，它可能不会删除原始 css，从而有效地加倍。另一个原因可能是这些 css 声明是针对非 Gmail 客户端的。一个常见的例子是媒体查询，它不能内联工作，这使得它们与 Gmail 不兼容。

这是我写的一篇相关[博客文章](http://dzyncreative.tumblr.com/post/39668246864/inline-your-email-css)，其中还包括一些流行的 CSS 内联工具的链接

# windows-8 - TideSDK 应用可以提交到 Windows 8 应用商店吗？

> ID：15467213
> 
> 赞同：4
> 
> 时间：2013-03-17T22:49:33.147
> 
> 标签：windows-8, tidesdk, windows-store

有没有人成功地将使用 TideSDK 创建的应用提交到 Windows 8 应用商店？周围有什么有用的教程吗？

如果这个问题是重复的，我深表歉意 - 我一直在寻找资源，但无济于事。

谢谢。

# php - 循环中的单个值

> ID：15467214
> 
> 赞同：0
> 
> 时间：2013-03-17T22:49:34.553
> 
> 标签：php, arrays, loops, foreach

我正在运行一个循环：

```
$array = $_POST['d'];

foreach($array as $a){
    print_r($a);
} 
```

$array 包含数组（数组的数量不同），结果我得到了这个。我只想知道如何在循环中单独调用这些值。例如： $thing = 循环中 methv 的值

```
Array ( 
   [1173627548] => Array ( 
     [num] => 1173627548 
     [methv] => dont know 
     [q1] => - 
     [q2] => - 
     [q3] => U 
     [q4] => - 
     [comm] => 
    ) 
) 
```

对不起，如果我不清楚

print_r($array) 显示：

```
Array ( [0] => Array ( [1173627548] => Array ( [num] => 1173627548 [methv] => dont know [q1] => - [q2] => - [q3] => U [q4] => - [comm] => ) ) [1] => Array ( [1182868902] => Array ( [num] => 1182868902 [methv] => dont know [q1] => - [q2] => - [q3] => U [q4] => - [comm] => ) ) ) Array ( [0] => Array ( [1173627548] => Array ( [num] => 1173627548 [methv] => dont know [q1] => - [q2] => - [q3] => U [q4] => - [comm] => ) ) [1] => Array ( [1182868902] => Array ( [num] => 1182868902 [methv] => dont know [q1] => - [q2] => - [q3] => U [q4] => - [comm] => ) ) ) 
```

注意：我现在在这个数组中有 2 个数组

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:53:55.423

我猜你想在 array 上循环`$a`，每个元素也是数组。

当您循环 $array 时，有一个项目的信息是您所说的：

```
Array ( 
   [1173627548] => Array ( 
     [num] => 1173627548 
     [methv] => dont know 
     [q1] => - 
     [q2] => - 
     [q3] => U 
     [q4] => - 
     [comm] => 
    ) 
) 
```

如果要访问`methv`元素，应执行以下操作：

```
foreach($array as $a){
    echo $a["methv"]; // this would access $array[ 1173627548 ][ "methv" ]
} 
```

在 foreach 继续的同时，您将继续访问所有`$array[ ][ "methv" ]`值希望它有所帮助。

* * *

**根据您的评论表明`print_r($array)`.**

首先，让我缩进它，以便我们更好地了解数组：

```
 Array ( 
    [0] => Array ( 
    [1173627548] => Array ( 
        [num] => 1173627548 
        [methv] => dont know 
        [q1] => - 
        [q2] => - 
        [q3] => U 
        [q4] => - 
        [comm] => 
        )
      )
    [1] => Array ( 
     [1182868902] => Array ( 
        [num] => 1182868902 
        [methv] => dont know 
        [q1] => - 
        [q2] => - 
        [q3] => U 
        [q4] => - 
        [comm] => )
        )
)
 Array (
    [0] => Array (
    [1173627548] => Array ( 
        [num] => 1173627548 
        [methv] => dont know 
        [q1] => - 
        [q2] => - 
        [q3] => U 
        [q4] => - [comm] => 
        )
     )
    [1] => Array (
     [1182868902] => Array (
        [num] => 1182868902 
        [methv] => dont know 
        [q1] => - 
        [q2] => - 
        [q3] => U 
        [q4] => -
        [comm] => 
        )
    )
) 
```

我猜您要打印两次，因为我们可以一个接一个地看到两个完全一致的数组。

如果您想获取`[methv]`项目，您需要访问：

```
$array[ 0 ][ 1173627548 ][ "methv" ]
$array[ 1 ][ 1182868902 ][ "methv" ] 
```

所以你可以做的是使用`foreach`两次：

```
foreach ($array as $a) {
    foreach ($a as $v) {
        echo $v[ "methv" ];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:03:10.577

对于调试，我建议进行一些粗略但可读的调试，如下所示：

```
function trace($a) { print "<pre>".var_export($a, 1)."</pre>"; }
// then you can do:
trace($array); 
```

至于您的问题，您可以像这样访问 methv 键：（`$array[0][1173627548]['methv']`或者`$array[1173627548]['methv']`如果上面的跟踪是完整的 $array 变量）。

# scala - 如何使用 Play 框架和 Scala 在 Heroku 上将 http:// 重定向到 http://www

> ID：15467215
> 
> 赞同：0
> 
> 时间：2013-03-17T22:49:35.920
> 
> 标签：scala, heroku, playframework-2.0

我看到可以使用 Rails 在Heroku 上将 http: // 重定向到 [ [http://www] ，如](http://www])[Heroku 如何将 http:// 重定向到 http://www](https://stackoverflow.com/questions/5389575/heroku-how-to-redirect-http-to-http-www)中所述。

是否（已经）可以使用 Scala 和 Play 2 来做到这一点？

感谢您的回答

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:01:17.160

您不能直接使用 Play 执行此操作，但此问题的最佳解决方案是您链接的同一个问题。您应该[在 DNS 级别](https://stackoverflow.com/a/12325021/772743)解决这个问题。

# r - 不使用 ddply 计算“组特征”并合并

> ID：15467219
> 
> 赞同：7
> 
> 时间：2013-03-17T22:49:55.953
> 
> 标签：r, merge, plyr

我想知道是否有比我通常采用的方法更直接的方法来计算某种类型的变量......

下面的示例可能最好地说明了这一点。我有一个包含 2 列的数据框（水果以及水果是否腐烂）。我想为每一行添加例如腐烂的同一类别的水果的百分比。例如，apple 有 4 个条目，其中 2 个是 rotten，因此 apple 的每一行应为 0.5。目标值（仅作为说明）包含在“期望结果”列中。

我以前通过 * 对水果变量使用“ddply”命令（以 sum/lenght 作为函数）来解决这个问题，创建一个新的 3*2 数据帧 *使用“合并”命令将这些值链接回旧数据帧.

这感觉像是一种迂回的方式，我想知道是否有更好/更快的方式来做到这一点！理想情况下是一种通用方法，如果需要确定是否所有水果都腐烂，任何水果都腐烂等等等等，而不是百分比，那么它很容易调整。

提前谢谢了，

W

```
 Fruit Rotten Desired_Outcome_PercRotten
1   Apple      1                        0.5
2   Apple      1                        0.5
3   Apple      0                        0.5
4   Apple      0                        0.5
5    Pear      1                       0.75
6    Pear      1                       0.75
7    Pear      1                       0.75
8    Pear      0                       0.75
9  Cherry      0                          0
10 Cherry      0                          0
11 Cherry      0                          0

#create example datagram; desired outcome columns are purely inserted as illustrative of target outcomes
Fruit=c(rep("Apple",4),rep("Pear",4),rep("Cherry",3))
Rotten=c(1,1,0,0,1,1,1,0,0,0,0)
Desired_Outcome_PercRotten=c(0.5,0.5,0.5,0.5,0.75,0.75,0.75,0.75,0,0,0)
df=as.data.frame(cbind(Fruit,Rotten,Desired_Outcome_PercRotten))        
df 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-17T23:14:48.093

`ddply`你可以用和来做到这一点`mutate`：

```
# changed summarise to transform on joran's suggestion
# changed transform to mutate on mnel's suggestion :)
ddply(df, .(Fruit), mutate, Perc = sum(Rotten)/length(Rotten))

#     Fruit Rotten Perc
# 1   Apple      1 0.50
# 2   Apple      1 0.50
# 3   Apple      0 0.50
# 4   Apple      0 0.50
# 5  Cherry      0 0.00
# 6  Cherry      0 0.00
# 7  Cherry      0 0.00
# 8    Pear      1 0.75
# 9    Pear      1 0.75
# 10   Pear      1 0.75
# 11   Pear      0 0.75 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-17T23:16:34.037

`data.table`超级快，因为它通过引用更新。使用它怎么样？

```
library(data.table)

dt=data.table(Fruit,Rotten,Desired_Outcome_PercRotten)

dt[,test:=sum(Rotten)/.N,by="Fruit"]
#dt
#     Fruit Rotten Desired_Outcome_PercRotten test
# 1:  Apple      1                       0.50 0.50
# 2:  Apple      1                       0.50 0.50
# 3:  Apple      0                       0.50 0.50
# 4:  Apple      0                       0.50 0.50
# 5:   Pear      1                       0.75 0.75
# 6:   Pear      1                       0.75 0.75
# 7:   Pear      1                       0.75 0.75
# 8:   Pear      0                       0.75 0.75
# 9: Cherry      0                       0.00 0.00
#10: Cherry      0                       0.00 0.00
#11: Cherry      0                       0.00 0.00 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-18T04:44:36.000

基础 R 中的一种解决方案是使用`ave`.

```
within(df, {
  ## Because of how you've created your data.frame
  ##   Rotten is actually a factor. So, we need to
  ##   convert it to numeric before we can use mean
  Rotten <- as.numeric(as.character(Rotten))
  NewCol <- ave(Rotten, Fruit)
})
    Fruit Rotten Desired_Outcome_PercRotten NewCol
1   Apple      1                        0.5   0.50
2   Apple      1                        0.5   0.50
3   Apple      0                        0.5   0.50
4   Apple      0                        0.5   0.50
5    Pear      1                       0.75   0.75
6    Pear      1                       0.75   0.75
7    Pear      1                       0.75   0.75
8    Pear      0                       0.75   0.75
9  Cherry      0                          0   0.00
10 Cherry      0                          0   0.00 
```

或更短：

```
transform(df, desired = ave(Rotten == 1, Fruit)) 
```

应用的默认函数`ave`是`mean`，因此我没有在此处包含它。`FUN = some-function-here`但是，如果您想做一些不同的事情，您可以通过附加来指定不同的函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-18T13:24:59.527

正如`ave`已经发布的那样，让我使用我选择的基本 R 函数添加一个解决方案：`aggregate`.

您可以通过以下方式获得所需的数据：

```
aggregate(as.numeric(as.character(Rotten)) ~ Fruit, df, mean) 
```

但是，您需要在`merge`之后（或一件）将其静止：

```
merge(df, aggregate(as.numeric(as.character(Rotten)) ~ Fruit, df, mean)) 
```

# jquery - 如何从 Jquery 对象中删除元素

> ID：15467220
> 
> 赞同：1
> 
> 时间：2013-03-17T22:49:56.530
> 
> 标签：jquery

执行以下操作后：`$hold=$('<div>').load('page.php #somediv)`我正在尝试删除该 html 中`removediv`根据 cookie 的值调用的元素。我试过了：

```
if ($.cookie('mycookie') !== null){
$hold=$hold.not('#removediv');
}else{
document.cookie = "mycookie=1;expires=Thu, 31 Dec 2020 23:59:59 UTC; path=/"
}
$('#divtwo').html($hold); 
```

但`removediv`即使设置了 cookie，该元素也会始终显示。我也试过`$hold.find('#removediv').remove()`了，但这也没有用。

有任何想法吗？

编辑： $hold html 看起来像这样：

```
<div>
 <div id="somediv">
  <div id="removediv" class="stuff"></div>
  <div id="okdiv" class="stuff"></div>
  <div id="okdiv" class="stuff"></div>
  <div id="okdiv" class="stuff"></div>
 </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:16:57.837

这是我对如何完成这项工作的最佳猜测。用于从 html 片段`remove`中删除`removediv`，并将代码放在方法的“完成”回调中`load`：

```
$hold = $('<div>').load('page.php #somediv', function(response, status, xhr) {
    if ($.cookie('mycookie') !== null){
        $hold.find('#removediv').remove();
    } else {
        document.cookie = "mycookie=1;expires=Thu, 31 Dec 2020 23:59:59 UTC; path=/"
    }
    $('#divtwo').html($hold);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:17:16.363

尝试在这样的回调函数中这样做

```
$('<div>').load('page.php #somediv', function(data) {
  $hold = data;

  if ($.cookie('mycookie') !== null){
    $hold.find('#removediv').remove();
   } else {
    document.cookie = "mycookie=1;expires=Thu, 31 Dec 2020 23:59:59 UTC; path=/"
   }
   $('#divtwo').html($hold);

}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-17T23:18:09.060

这就是为什么事情不适用于您的示例：

*   `load()`是异步调用，所以只有在调用结束时才需要继续治疗
*   `$hold.find('#removediv').remove()`只会选择 div，而不是实际删除它

对于您需要的代码工作，使用[`callback`](http://api.jquery.com/load/)和[`end`](http://api.jquery.com/end/)，如下所示：

```
<script>
$(function() {
  $("#l").click(function() {

    var url = 'b.htm';

    $("#content").load(url + " #somediv", function(data) {

      var allHtml = $(data),
          newHtml = allHtml.find("#removediv").remove().end();

      console.log(newHtml.html());
    });

  });
});
</script> 
```

假设您有一个包含此 html 的文件：

```
<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8 />
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
  <title>Stackoverflow example</title>
</head>
<body>
  <h1>Hello</h1>

  <a href="#" id="l">load content</a>
  <div id="content">Empty</div>

</body>
</html> 
```

并且`b.htm`有

```
<div>
 <div id="somediv">
  <div id="removediv" class="stuff">A</div>
  <div id="okdiv" class="stuff">B</div>
  <div id="okdiv" class="stuff">C</div>
  <div id="okdiv" class="stuff">D</div>
 </div>
</div> 
```

输出将是（在 Firefox 中，Chrome 会阻止调用`b.htm`作为跨域调用，因为它是本地文件）

![在此处输入图像描述](../Images/e2cb9335aa6b6818ac7711573b9be8b1.png)

输出显示：

```
console.log('data');
console.log(data);  
console.log('newHtml');
console.log(newHtml.html()); 
```

> [](https://www.dropbox.com/sh/t46rp4i0nxbdl6h/d8bRIOKOtg)**如果您需要查看这两个文件，[示例在我的](https://www.dropbox.com/sh/t46rp4i0nxbdl6h/d8bRIOKOtg)[**Dropbox上。**](https://www.dropbox.com/sh/t46rp4i0nxbdl6h/d8bRIOKOtg)**

 *** * *

使用您自己的代码：

```
$(function() {

    $('<div/>').load('page.php #somediv', function(data) {

        // 'data' has the page.php #somediv part
        var allHtml = $(data);

        if ($.cookie('mycookie') !== null)
            allHtml = allHtml.find("#removediv").remove().end();
        else
            document.cookie = "mycookie=1;expires=Thu, 31 Dec 2020 23:59:59 UTC; path=/"

        $('#divtwo').html(allHtml);
    });
}); 
```**

# java - 在java记事本中查找单词jtextfield

> ID：15467224
> 
> 赞同：2
> 
> 时间：2013-03-17T22:50:13.103
> 
> 标签：java, swing, jtextfield, jtextcomponent, text-comparison

我应该设置什么条件才能突出显示 JTextArea 中的所有单词？此代码在没有 while 循环的情况下工作，但它只查找并突出显示第一个单词匹配。

```
String findstr = findTextField.getText().toUpperCase(); // User Input Word to find
int findstrLength = findstr.length();                   
String findtextarea = textarea.getText().toUpperCase(); // TextArea Content
Highlighter h = textarea.getHighlighter();
h.removeAllHighlights();
try
    {
        int index=0;
        while(index>=0)                             // What should I put here ??
        {
            index = findtextarea.indexOf(findstr,index);
            h.addHighlight(index,index+findstrLength, DefaultHighlighter.DefaultPainter);
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T22:51:32.033

```
 while(index>=0) {
        index = findtextarea.indexOf(findstr,index);
        if (index > 0) {
           h.addHighlight(index,index+findstrLength, DefaultHighlighter.DefaultPainter);
        }
        index++; // try adding this to allow you to look for the next index.
    } 
```

# python - Python中的自动化Excel

> ID：15467229
> 
> 赞同：8
> 
> 时间：2013-03-17T22:50:28.027
> 
> 标签：python, excel, pyxll

在我公司，我们在开发和生产环境中使用 Linux。但是我们有一台运行 Windows 和 Excel 的机器，因为我们使用第三方应用程序 excel 插件来获取机器的金融市场数据。插件提供了一些函数（就像 Excel 函数），用于将这些数据获取到本地计算机，然后发送回 MySql 数据库。我们还开发了一些 VBA 脚本来自动化任务，但仍然对结果不满意。我正在考虑使用 Python 来完成所有这些工作，但在开始之前，我需要找到一个可以做的 python 包

1.  使用python操作Excel（及其加载项）并在不打开Excel的情况下使用其功能？
2.  如果我需要打开 Excel，我需要每天自动执行脚本的任务，或者在一天中的特定时刻（市场数据需要在特定时间提供）

感谢您的建议

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-17T23:01:43.033

您将需要 Python Win32 扩展 - [http://sourceforge.net/projects/pywin32/](http://sourceforge.net/projects/pywin32/)

（现已迁移到 GitHub：[https](https://github.com/mhammond/pywin32) ://github.com/mhammond/pywin32 ）

然后你就可以使用COM了。

```
from win32com.client import Dispatch
excel = Dispatch('Excel.Application')
wb = excel.Workbooks.Open(r'c:\path\to\file.xlsx')
ws = wb.Sheets('My Sheet')
# do other stuff, just like VBA
wb.Close()
excel.Quit() 
```

您可以将脚本放在 Windows 任务计划程序上，以便在您需要的时间运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-04-18T08:45:42.047

作为替代方案，您可以考虑使用 openpyxl。

```
import openpyxl
wb= openpyxl.Workbook()
ws = wb.get_active_sheet()
ws.title = 'My Title'
wb.save('C:\\Development\\Python\\alpha.xlsx') 
```

这是我正在阅读的书中的一章。

[https://automatetheboringstuff.com/chapter12/](https://automatetheboringstuff.com/chapter12/)

运气

# javascript - 将 varbales 称为传入函数的对象

> ID：15467230
> 
> 赞同：0
> 
> 时间：2013-03-17T22:50:30.860
> 
> 标签：javascript

问题。我需要创建一个名为的全局函数

> layerdiable(层);

在许多情况下，这个功能就像......

> layerdiable(heatmap_tree); layerdiable(heatmap_house); layerdiable(heatmap_person);

以上每个都有相关的变量

> 变热图树=假；var heatmap_house = 假；

等等我想做的基本上是....

> 函数 distroylayer(layer){
> layer =! 层; }

（我想真正像....一样工作）

> 功能 distroylayer(heatmap_tree){
> heatmap_tree !=heatmap_tree ; }

使 heatmap_tree 与其当前值相反...（应该是假的...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T22:53:31.457

你不能。诸如布尔值之类的原语是按值传递的，而不是按引用传递的。

但是您不需要为此提供功能。所有你需要的是：

```
somevar = !somevar; 
```

这将`somevar`在真假之间切换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T22:53:59.760

您可以将全局变量称为`window`对象成员：

```
function disableLayer(layer) {
    window[layer] = !window[layer];
}

disableLayber('heatmap_tree'); 
```

# assembly - 用keil uvision 4模拟汇编代码（arm cortex m3）

> ID：15467231
> 
> 赞同：1
> 
> 时间：2013-03-17T22:50:39.667
> 
> 标签：assembly, arm, keil

我使用了这个指南[模拟 ARM 代码](https://stackoverflow.com/questions/14539787/simulating-arm-code)，它展示了如何模拟汇编代码（arm 7 little endian）并且运行良好。我刚刚将设备从 arm 7 little endian 更改为 arm cortex m3，这些是错误：

```
Build target 'Target 1' 
assembling test.s...
linking...
sa.axf: Error: L6320W: Ignoring --entry command. Cannot find argument 'Reset_Handler'.
sa.axf: Warning: L6320W: Ignoring --first command. Cannot find argument '__Vectors'.
Target not created 
```

我认为问题在于我的项目没有一些启动文件。如果是这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T11:58:30.423

Cortex-M 系列使用与“经典 ARM”[不同的异常模型，因此需要不同的启动。](https://stackoverflow.com/a/6140567/422797)我不确定 Keil 是如何使用它的，但也许可以尝试`Reset_Handler`在代码的开头添加一个标签。您可能还需要添加带有矢量定义的启动文件。使用他们应该提供的一些示例或新项目向导（如果有的话）可能会更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T18:32:44.933

显然 main() 函数入口点以前被定义为“Reset_Handler”函数，现在你的项目中没有它，所以链接器会抱怨。这可能只是你的问题的开始。

如果您想将现有示例从 ARM7 架构移植到 Cortex M3，那么使用汇编程序可能不是一个好主意，因为它们是非常不同的架构。

如果您绝对必须这样做，那么至少为新架构找到一些工作示例（不必做您需要的），然后从那里开始以获得工作启动文件、工具集项目文件（s )，以及总体上已知的良好工作环境。然后一步一步开始移植旧的东西。

# winmerge - Winmerge - 块作为一个单一的差异

> ID：15467236
> 
> 赞同：0
> 
> 时间：2013-03-17T22:51:01.927
> 
> 标签：winmerge

请看下面的屏幕截图：

![WinMerge 屏幕截图](../Images/72e2c4535336d7e7f48e65e115efebfb.png)

为什么以下文本以黄色突出显示：这是一个 Test2。文本出现在两个文件中。

我从以下网站找到了一个报价：http: [//manual.winmerge.org/Intro_diffs.html](http://manual.winmerge.org/Intro_diffs.html)。引用是：“将整个行块视为单个差异也很有用”。因此，如果一个块被视为一个单一的差异，我会徘徊。这是在哪里配置的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:22:54.860

WinMerge 按行进行比较，并将具有差异的行块视为单个差异。您本身并没有配置它。那不是你的问题。

您的问题是 Test2.txt 没有以回车结束。

所以 WinMerge 比较`This is a Test2\r\n`和`This is a Test2<eof>`这些是不同的。

（并注意 WinMerge 如何将 Test1.txt 中的其余行视为“单一差异”）。

*使用 WinMerge 2.14.0.0 确认*

# python - 在 subprocess.Popen 中使用 && 进行命令链接？

> ID：15467237
> 
> 赞同：7
> 
> 时间：2013-03-17T22:51:11.757
> 
> 标签：python, linux, python-2.7, popen, chaining

我正在使用`subprocess.Popen`with `Python`，我还没有遇到一个优雅的解决方案来`&&`通过`Popen`.

我可以这样做：

```
p1 = subprocess.Popen(["mmls", "WinXP.E01"], stdout=subprocess.PIPE)
result = p1.communicate()[0].split("\n")
for line in result:
    script_log.write(line)

script_log.write("\n")

p1 = subprocess.Popen(["stat", "WinXP.E01"], stdout=subprocess.PIPE)
result = p1.communicate()[0].split("\n")
for line in result:
    script_log.write(line) 
```

* * *

但这真的不是很美观（特别是如果我通过`Popen`.

* * *

**我想在尽可能少的命令块中复制这个输出。**

```
not@work ~/ESI/lab3/images $ mmls WinXP.E01 && echo -e "\n" && stat WinXP.E01
DOS Partition Table
Offset Sector: 0
Units are in 512-byte sectors

     Slot    Start        End          Length       Description
00:  Meta    0000000000   0000000000   0000000001   Primary Table (#0)
01:  -----   0000000000   0000000062   0000000063   Unallocated
02:  00:00   0000000063   0020948759   0020948697   NTFS (0x07)
03:  -----   0020948760   0020971519   0000022760   Unallocated

  File: `WinXP.E01'
  Size: 4665518381  Blocks: 9112368    IO Block: 4096   regular file
Device: 14h/20d Inode: 4195953     Links: 1
Access: (0644/-rw-r--r--)  Uid: ( 1000/    nott)   Gid: ( 1000/    nott)
Access: 2013-03-16 23:20:41.901326579 -0400
Modify: 2013-03-04 10:05:50.000000000 -0500
Change: 2013-03-13 00:25:33.254684050 -0400
 Birth: - 
```

* * *

## 有什么建议么？

注意：我想避免将其输入`subprocess.Popen`

```
p1 = subprocess.Popen(["mmls WinXP.E01 && echo -e '\n' && stat WinXP.E01"], stdout=subprocess.PIPE) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T01:19:25.543

&& 是一个 shell 操作符，POpen 默认不使用 shell。

如果您想使用 shell 功能，请在您的 POpen 调用中使用 shell=True，但请注意它会稍微慢一些/占用更多内存。

```
p1 = subprocess.Popen(["mmls", "WinXP.E01", "&&", "echo", "-e", "\"\n\"", "&&", "stat", "WinXP.E01"],
                      stdout=subprocess.PIPE, shell=True) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T02:38:18.000

这个怎么样：

```
from subprocess import Popen, PIPE

def log_command_outputs(commands):
    processes = [Popen(cmd, stdout=PIPE) for cmd in commands]
    outputs = [proc.communicate()[0].split() for proc in processes]
    for output in outputs:
        for line in output:
            script_log.write(line)
        script_long.write("\n") 
```

这会并行启动命令，这可能比一个一个地执行命令要快一点（但可能不会很大）。由于`communicate`调用是顺序的，任何具有大输出（超过管道缓冲区）的命令都会阻塞，直到轮到它被清理为止。

对于您的示例命令链，您可以调用：

```
log_command_outputs([["mmls", "WinXP.E01"], ["stat", "WinXP.E01"]]) 
```

# php - 用它后面的子词替换嵌入的@符号

> ID：15467238
> 
> 赞同：0
> 
> 时间：2013-03-17T22:51:27.203
> 
> 标签：php, replace

我有一项任务需要我用`@`紧跟在它后面的子词替换以符号结尾的字符模式。因此，`presymbol@postsymbol`例如，替换将产生`postsymbol`.

我目前正在使用这种模式`'/(^|\s)@([a-z0-9_]+)/'`进行替换，但我的测试人员给我的反馈是，将“放在 @ 前面会导致替换失败。

如何修复此模式以正确输出。类似的东西`'/(^|\s)(@|"@)([a-z0-9_]+)/'`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:01:06.863

```
/(^|\s)(@|"@)([a-z0-9_]+)/ 
```

如果添加新的[匹配组](http://www.regular-expressions.info/brackets.html)，`$2`则变为`$3`。

您应该做的只是使`"`可选：

```
...."?@.... 
```

或者使用非捕获匹配组：

```
....(?:@|"@).... 
```

或者可能将其作为另一种选择放入第一组：

```
....(^|\s|").... 
```

# c# - 使用事件传递参数

> ID：15467239
> 
> 赞同：0
> 
> 时间：2013-03-17T22:51:28.423
> 
> 标签：c#, events

在我的代码中，我有一个`button`和一个`textbox`. 我想通过点击`button`，将变量 k 的值发送到`textbox`. 但是当我单击按钮时，我的代码没有任何问题。这是我的代码。

```
 public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent(); 
        }
        public delegate string fac(int x);
        public static fac intostring = factory;

        public static string inst= null;
        public static string factory(int x)
        {
           inst = x.ToString();
           return inst;
        }

        public delegate void myeventhandler(string newvalue);
        public class EventExample
        {
           private string thevalue;
           public event myeventhandler Valuechanged;

           public string val
           {
              set
               {
                  this.thevalue = value;
                  this.Valuechanged(thevalue);
               }          
           }
       }

 public void uu(string newvalue)
 {
   this.textBox1.Name = (newvalue);
 }

 static int k=0;
 private void button1_Click(object sender, EventArgs e)
 {
    k = 1;
    intostring(k);
 }

 private void Form1_Load(object sender, EventArgs e)
 {
   EventExample myevt = new EventExample();
   myevt.Valuechanged += new myeventhandler(uu);
   myevt.val = inst;                          
  }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:14:30.497

只需将其设置在`button1_Click`

```
 private void button1_Click(object sender, EventArgs e)
 {
    k = 1;
    intostring(k);
    this.textBox1.Text = thevalue;
 } 
```

# c++ - 堆排序错误：表达式必须是指向完整对象类型的指针？

> ID：15467243
> 
> 赞同：0
> 
> 时间：2013-03-17T22:52:07.277
> 
> 标签：c++, function-call

我正在为一项任务实施堆排序。我们必须像她在课堂上用她的伪代码那样做，否则我们不会得到荣誉。

在我的 Max_Heapify 函数中，当我调用 Left() 和 Right() 函数时出现错误，即“***表达式必须是指向完整对象类型的指针***”。我直接离开psedocode，所以我不确定是什么导致了这个错误，有人可以帮忙吗？

```
void Max_Heapify(int heapArray[],int i)
{
int n = SIZE;
int largest = 0;
int l = Left[i];//<--Error here on Left
int r = Right[i];//<--Error here on Right

if(( l <= n) && (heapArray[l] > heapArray[i]))
{
    largest = l;
}
else
{
    largest = i;
}

if( (r <= n) && ( heapArray[r] > heapArray[largest]))
{
    largest = r;
}

int temp;
if(largest != i)
{
    temp = heapArray[i];
    heapArray[i] = heapArray[largest];
    heapArray[largest] = temp;

    Max_Heapify(heapArray,largest);
}

return;
} 
```

..................................................... .........................................................

如果有帮助的话，这里是 Left() 和 Right() 函数

```
int Left(int i)
{
return (2*i);
}

int Right(int i)
{
return ((2*i)+1);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T22:55:28.457

Left & Right 是函数；您的代码正在使用它们，就好像它们是数组一样。要调用函数，请使用 ()，而不是 []。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T22:55:14.750

你需要`Left(i)`and `Right(i)`，而不是`Left[i]`and`Right[i]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T22:55:24.413

```
int l = Left[i];//<--Error here on Left
int r = Right[i];//<--Error here on Right

int l = Left(i);//should be
int r = Right(i);//should be 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T23:22:42.503

如果您想查看堆排序的最佳实现，请查看 linux 内核。

```
http://lxr.free-electrons.com/source/lib/sort.c 
```

我记得我刚接触 C 的时候就盯着它看，这样我就可以吸收完美。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-17T23:00:45.400

这是一个错误，因为我们使用 () 来表达 C++ 中的函数调用。你必须改变

```
int l = Left[i]; 
```

进入

```
int l = Left(i); 
```

# php - 如果链接不存在，请尝试另一个

> ID：15467248
> 
> 赞同：1
> 
> 时间：2013-03-17T22:52:22.117
> 
> 标签：php

我正在寻找最快的方法来检查链接是否在远程服务器上工作/存在，如果没有尝试另一个链接。类似于 nginx 中的“try_files”，仅用于链接...

例如：

```
try first 
header("Location:" . $VIDEO_1);
if there's no $VIDEO_1 try
header("Location:" . $VIDEO_2);
if there's no $VIDEO_2 try
header("Location:" . $VIDEO_3); 
```

目前我正在使用一个检查大小并发送标题的函数......但是文件大小检查很慢

```
if($file_size > "9000000"){
        header("Content-type: video/x-flv");
        header("Location:" . $VIDEO . $dop);
}else{
        header("Content-type: video/x-flv");
        header("X-Accel-Redirect: /".$_GET["filename"].$dop);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:10:17.417

由于它在远程服务器上，您可以使用[get_headers()](http://php.net/get_headers)：

```
$header = get_headers("http://stackoverflow.com/users/flair/1401975.png");
preg_match('/\d{3}/', $header[0], $code); // Extracting the HTTP status code

if($code[0] < 400){ // Or maybe just $code[0] == 200 ? http://en.wikipedia.org/wiki/List_of_HTTP_status_codes
    echo 'EXISTS !!!';
}else{
    echo 'Doesn\'t exists';
} 
```

# regex - 字符串中间的正则表达式

> ID：15467249
> 
> 赞同：4
> 
> 时间：2013-03-17T22:52:23.160
> 
> 标签：regex

如何获取 SIP URI 的一部分？例如我有 URI `sip:username@sip.somedomain.com`，我需要 get`username`并且我使用`[^sip:](.*)[$@]+`表达式，但出现的结果是`username@`. 如何从匹配中排除`@`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-17T22:58:19.237

这应该做的工作

```
(?<=^sip:)(.*)(?=[$@]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:04:27.510

如果前瞻在您的正则表达式风格中不可用（例如 POSIX 正则表达式缺少它们），您仍然可以匹配您最终不想返回的正则表达式中的部分字符串，如果您使用捕获组并且只获取一些内容其中。

例如

`^sip:(.*?)[$@]+`然后只返回第一个捕获组的内容

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T22:59:45.690

使用前瞻而不是实际匹配@：

```
^sip:(.*?)(?=@|\$) 
```

要么你使用了一种非常奇怪的正则表达式风格，要么你的起始字符类是一个错误。`[^sip:]`匹配不属于`s`、`i`或`p`的单个字符`:`。我也不确定这个`$`字符的用途，因为这不是 SIP 语法的一部分。

# html - 悬停在图像上时工具提示弹出文本？

> ID：15467250
> 
> 赞同：2
> 
> 时间：2013-03-17T22:52:26.870
> 
> 标签：html, tooltip

链接应该是 1em sans-serif 字体，填充为 5 和 10 像素，边距为 0 0 1 像素（提示：使用速记属性）；右边框应为 5 像素和颜色 #ff1828

湾。当用户将鼠标悬停在链接上时，右边框应该是双倍样式，白色 5 像素

C。启动时，三个意大利面图像下方不应显示任何文字；使用标签控制悬停时的显示文本弹出；将文本块定位为绝对，上边距为 220 像素，左边距为 550 像素；块的宽度至少应为 180 像素，具体取决于您在研究中找到多少文本；使用 5 像素的填充和 10 像素的边距；文本应该是黑色背景上的白色。

我一直在尝试一切，这就是我到目前为止所拥有的，没有任何效果。我不太确定我做错了什么？如果有人可以提供帮助，我一定会很感激。到目前为止，这是我的代码：

```
<!DOCTYPE html
   PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Lab 7-3</title

<style type="text/css">
<!--

#links {font: 1 em sans-serif; padding: 5px 10px; margin: 0px 0px 1px, border-right: 5px color: #ff1828}

div.links:hover {border-right: double 5px; color:white}

<span>
div#sizes a:hover img.large {position: absolute; top: 220px; left: 550px; 
                            width: 180px; border:none; padding: 5px; margin: 10px
                            background-color: #000000; color: #ffffff}

</span>     
-->
</style>                    

</head>

<body>

<img src="sabatinaslogo.jpg" width="735" height="190" alt="Sabatina's logo" />
<p style="font-size: large">Hover over a photo to read about the pasta dish and its nutrition information.</p> 

<div id="links" "demo">
<table style="text-align: center">
    <tr>

    <td>
        <a><img class="picture" src="fettuccine.jpg" width="200" height="200" alt="Fettucine"  title="Ingredients include:enriched durum flours, egg, water, soy lecithin. Nutritional facts: Approximately 200 calories, 3.2% total fat, 12.5% cholesterol, 16.7% protein, 1.7% calcium and 8.3% iron"/>

    </td>

    <td>
        <a><img class="picture" src="lasagna.jpg" width="200" height="200" alt="Lasagna" title=" Ingredients include: ground beef, cheese, enriched pasta and tomato sauce. Nutritional facts: Approx. 377 calories per serving, 13% fiber, approx. 50% protein, and approx. 35% sodium" />
    </td>

    <td>
        <a><img class="picture" src="ravioli.jpg" width="200" height="200" alt="Ravioli" title=" Ingredients include: water, durum wheat semolina, beef, wheat flour, egg, vegetable oil, salt, onion flavoring, tomatoes, sugar, cornflour, herb extracts, salt, garlic salt, spice extracts, black pepper. Nutritional facts: 2.6g of protein, 1.6g of fat, 0.8 g of fiber and 0.3g of sodium" />
    </td>
    </td>
</table>

</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-20T10:45:05.133

你试过使用`<img src='' title='popup' />`吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-25T09:17:38.327

很久没有问这个问题了，但是为了将来人们在谷歌上搜索这个问题，另一个可能的解决方案是使用 Twitter 的 Bootstrap CSS 平台。见这里： http: [//getbootstrap.com/javascript/#popovers](http://getbootstrap.com/javascript/#popovers)

您需要实现 JQuery 以及 CSS 文件，但这可以通过添加 2 行代码相对容易地实现（请参阅文件顶部的入门部分）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T23:04:11.023

您的标题标签未关闭：p

此外，除了

```
img.large 
```

尝试

```
img.title 
```

或者

```
.picture.title 
```

这将分别是您的 img 标签选择器或 img 标签的类选择器。

.className 指的是任何给定元素的类名，其中后者指的是元素的标题属性。

所以试试这个，我还没有测试过，所以不能确定结果，但希望它有帮助：

代替：

```
div#sizes a:hover img.large 
```

用。。。来代替：

```
img.title **or** .picture.title 
```

祝你好运。

（使用 CSS 作为经验，w3schools 作为参考）

# php - 插入前检查数据库中是否存在随机数

> ID：15467251
> 
> 赞同：0
> 
> 时间：2013-03-17T22:52:44.690
> 
> 标签：php, jquery, mysql, ajax, json

我制作了一个生成不同类型代码的小代码，但我会让它更简单，

我在提交时提交了一个注册表单我收集了一些关于用户的信息，我为他创建了一个随机的，但我希望这个随机对于这个用户来说是唯一的。

所以我有3个案例：

```
$code_random = rand(1000,9999);
    if($code_random < 0){
    $code_random = -$code_random;
    }

$random = $fname.$code_random; //case 1
$random = $lname.$code_random; //case 2
$random = $fname.lname.$code_random; //case 3 
```

但是我想创建案例 1 检查数据库中是否存在此随机数，如果它确实使用了第二种情况，如果它确实使用了第三种情况，则在提交表单之前并且不为用户显示任何内容。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T22:59:14.270

不要重新发明轮子 - SQL 数据库有两种很好的方法来为每一行分配唯一的 ID。

1) 自动递增主键 - 每增加一个新行。由数据库管理，保证不会对两行错误地使用相同的值。漂亮又小又简单。[http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html](http://dev.mysql.com/doc/refman/5.0/en/example-auto-increment.html)

2) GUID（也称为 UUID）——用于生成 GUID 的算法意味着您永远不会看到同一个 GUID 两次。与自动递增整数相比，它们具有不可预测、可在数据库之外生成以及在其数据库表上下文之外有意义的优点。[http://www.php.net/manual/en/function.uniqid.php#94959](http://www.php.net/manual/en/function.uniqid.php#94959) [http://dev.mysql.com/doc/refman/5.0/en/miscellaneous-functions.html#function_uuid](http://dev.mysql.com/doc/refman/5.0/en/miscellaneous-functions.html#function_uuid)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:59:23.560

有一种使信息唯一的简单方法：在数据库列上创建唯一索引。

然后只需插入您想要的内容并检查数据库是否抱怨违反唯一索引。如果是这种情况，请使用您的替代查询之一并再次检查。

如果最后一个查询仍然不起作用怎么办？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T23:03:39.107

如果你真的想使用一个随机整数，你可以使用这个[`MySQL - rand()`](http://dev.mysql.com/doc/refman/5.5/en/mathematical-functions.html#function_rand)函数

```
insert into users (id, ...) values (FLOOR(1000 + RAND() * (9999 – 1000)), ...) 
```

# android - 如何在android中按日期获取通话记录？

> ID：15467253
> 
> 赞同：2
> 
> 时间：2013-03-17T22:52:47.083
> 
> 标签：android, sqlite, android-cursor, calllog

我正在尝试按日期获取通话记录。但是要坚持使用要传递给光标以获取值的日期格式。

**通话记录光标**

```
Calendar calendar = Calendar.getInstance();
SimpleDateFormat dateFormatter = new SimpleDateFormat("yyyy-MM-dd");

String selection = CallLog.Calls.DATE + " = "+dateFormatter.format(calendar.getTime());

Cursor mCallLogCursor = mContext.getContentResolver().query(
            CallLog.Calls.CONTENT_URI, projection, selection, null,
            CallLog.Calls._ID + " DESC"); 
```

尝试了各种 dateformatter 类型，但都没有工作。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T23:37:12.863

试试这个：

```
Cursor c = contentResolver.query(CallLog.Calls.CONTENT_URI,
                new String[] { CallLog.Calls.DATE, CallLog.Calls.DURATION,
                        CallLog.Calls.NUMBER, CallLog.Calls._ID },
                CallLog.Calls.DATE + ">?",
                new String[] { String.valueOf(sinceDate.getTime())},
                CallLog.Calls.NUMBER + " asc"); 
```

`sinceDate`是一个 Date 变量，设置为您要涵盖的期间的开始。

# checkbox - 用复选框过滤特定的

> ID：15467254
> 
> 赞同：-1
> 
> 时间：2013-03-17T22:52:50.677
> 
> 标签：checkbox

我的问题是我想要一个过滤系统，该系统将通过选中的复选框进行过滤。该工具是我比较电视套餐的比较网站。

1.  我的访客应该按他们想要的电视频道过滤包裹。

例子;
复选框 1：探索
复选框 2：动物星球
复选框 3：迪士尼频道

输出应该是匹配的电视包
包 1：（包含探索和迪士尼频道）
包 2：（包含动物星球，迪士尼频道）
包 3：（包含动物星球）

因此，如果复选框 1 被选中，它应该只显示包 1。
如果复选框 1 + 复选框 2 被选中，它应该说“没有找到匹配项，但是这个包最接近你的选择”
如果复选框 2 + 复选框 3 被选中，它应该只显示与访问者选择完全匹配的包 2。

我希望你能帮助我。我一直在寻找这个特定的解决方案，但没有成功。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T23:04:54.847

我认为它应该在 Jquery 中。我看过一些类似的过滤示例，但没有一个像我上面的愿望。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-15T15:23:42.130

This is an old question, but... I'll take a shot. Working jsfiddle: [http://jsfiddle.net/a0nnrfua/](http://jsfiddle.net/a0nnrfua/)

I think a lot really depends on how you intend to define "closest", but presuming a jQuery solution and hopefully your browser requirements aren't TOO far in the past, you could use the data- attributes and jQuery to come up with some relatively simple functions. Or even use the value portions of the checkboxes really.

Psuedocode, it would look like:

1.  Define a click or change handler to detect whenever a checkbox has been touched/changed.
2.  Define a function that will scan all checked items and pass the values into your "closest package" function.
3.  Based on the results of that function, filter your package selection so that your choices are highlighted or marked in some way.

So let's presume the following HTML markup:

```
 <h3>TV Channels</h3>

<div id="TVChannelSelections">
    <input type="checkbox" class="tvchannel" name="tvchannel" id="tvchannel_Discovery" value="Discovery" />
    <label for="tvchannel_Discovery">Discovery Channel</label>
    <br/>
    <input type="checkbox" class="tvchannel" name="tvchannel" id="tvchannel_AnimalPlanet" value="Animal Planet" />
    <label for="tvchannel_AnimalPlanet">Animal Planet</label>
    <br/>
    <input type="checkbox" class="tvchannel" name="tvchannel" id="tvchannel_DisneyChannel" value="Disney Channel" />
    <label for="tvchannel_Disney">Disney Channel</label>
    <br/>
</div>

<div id="message"></div>
<h3>Packages</h3>

<div id="FilteredPackages">
    <div class="package deselected" id="Package1" data-channels="Discovery,Disney Channel">Package #1</div>
    <div class="package deselected" id="Package2" data-channels="Animal Planet,Disney Channel">Package #2</div>
    <div class="package deselected" id="Package3" data-channels="Animal Planet">Package #3</div>
</div> 
```

So in jQuery, your generic change or click handler would be defined in code: Note that I'm saying, any element on your page that has the class "tvchannel" defined, if there's ever a change that occurs, run my filter function.

```
<script type="text/javascript" src="../path/to/jQuery/library"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $(".tvchannel").on("change", function() {
            FilterMySelectedChannels();
        });
    });
</script> 
```

Now we can define your Filter function. We're going to assume two things. #1, that we want to find all the selected checkboxes and their values. Then we're going to iterate through the data-channels property of all of our packages (defined as elements with class = "package"). We'll use some form of string comparison and boolean logic to define what a complete match is vs. a close but no cigar match vs. a complete fail.

In order to keep track of things I'm using 3 classes, selected, deselected, and close.

In css, you can decide whether you want notselected to mean "hide the package completely" (i.e. display: none;) or maybe you want it to be visible but greyed out and "struck out" (i.e. text-decoration: strikethrough; color: grey;}

I'm going to use kind of a brute force way of doing the comparison. There are better array functions and comparison functions in javascript, but this should be relatively clear for most people and I trust the good folks at stackoverflow to chime in with better solutions. But this should get you started. :)

```
<script type="text/javascript">
    function FilterMySelectedChannels() {
        $checkedboxes = $(".tvchannel:checked");
        $packages = $(".package");
        var bAnyFound = false;
        $packages.each(function () {
            var bCloseButNoCigar = false;
            var bCompleteMatch = true;
            var packagearray = $(this).data("channels").split(",");
            var $currentPackage = $(this);
            $checkedboxes.each(function () {
                if ($.inArray($(this).val(), packagearray) != -1) {
                    bCloseButNoCigar = true;
                } else {
                    bCompleteMatch = false;
                }
            });

            if (bCompleteMatch) {
                $currentPackage.removeClass("selected").removeClass("deselected").removeClass("close").addClass("selected");
                bAnyFound = true;
            } else if (bCloseButNoCigar) {
                $currentPackage.removeClass("selected").removeClass("deselected").removeClass("close").addClass("close");
            } else {
                $currentPackage.removeClass("selected").removeClass("deselected").removeClass("close").addClass("deselected");
            }
        });

        if (bAnyFound) {
            $("#message").html("The following matches were found");
        } else {
            $("#message").html("No actual matches were found, but here are some close matches based on your selections");
            $(".package.close").removeClass("deselected").removeClass("close").removeClass("selected").addClass("selected");
        }
    }
</script>

<style type="text/css">
    .selected {
        color: red;
        background-color: yellow !important;
    }

    .deselected {
        color: grey;
        text-decoration: strike-through !important;
        background-color: white !important;
    }
</style> 
```

There are obvious optimizations that could probably work here, but it's a start for those trying to do something similar. Note that it assumes that your markup is dynamically generated or properly coded. If you need to guard against human typos, converting your text using .toLowerCase/UpperCase and using the .Trim functions to eliminate extra space will assist. But you still have to choose your data values wisely so there's no overlap. And if you choose them well enough you can use better techniques such as regular expressions and wildcard searches to make the code a bit shorter.

Hope this helps someone!

# android - getDownTime() 和 getEventTime()

> ID：15467255
> 
> 赞同：5
> 
> 时间：2013-03-17T22:53:02.680
> 
> 标签：android, android-event

getEventTime() 和 getDownTime() 有什么区别？在文档[http://developer.android.com/reference/android/view/MotionEvent.html](http://developer.android.com/reference/android/view/MotionEvent.html) 两者似乎都做同样的事情，但它们输出不同的值。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-01T18:55:43.720

`getDownTime`返回这一系列事件开始的时间。例如，如果你得到：

`ACTION_DOWN`, `ACTION_MOVE`, 然后`ACTION_MOVE`.

如果您调用`getDownTime`此最新事件，您将获得 的时间，`ACTION_DOWN`即开始该系列的事件。

如果你打电话`getEventTime`，你会得到最近`ACTION_MOVE`发生的时间。

# delphi - 如何强制处理线程内的消息？

> ID：15467263
> 
> 赞同：0
> 
> 时间：2013-03-17T22:53:46.253
> 
> 标签：delphi, winsock

尽管有仅适用于主 VCL 线程的 Application.ProcessMessages，但 TThread 类是否有类似的方法？或者我怎样才能自己写一个？

假设在客户端我使用 SendBuf 2 次...

```
SendBuf(....
SendBuf(.... 
```

在服务器端，OnRead 被触发了 2 次，但是在我们之间，我已经在一次 OnRead 调用中读取了套接字缓冲区，那么我如何避免第二次没有例外？我能想到的唯一方法是处理消息队列中的消息，以便它们已经离开那里并且不会再次触发该事件。（边读边做）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-17T23:51:48.190

如果要在工作线程中处理消息，则必须手动运行消息循环，例如：

```
procedure TMyThread.Execute;
var
  Msg: TMsg;
begin
  ...
  while GetMessage(Msg, 0, 0, 0) > 0 then
  begin
    TranslateMessage(Msg);
    DispatchMessage(Msg);
  end;
  ...
end; 
```

或者：

```
procedure TMyThread.Execute;
var
  Msg: TMsg;
begin
  ...
  while not Terminated do
  begin
    ...
    if PeekMessage(Msg, 0, 0, 0, PM_REMOVE) then
    begin
      TranslateMessage(Msg);
      DispatchMessage(Msg);
    end;
    ...
  end;
  ...
end; 
```

或者：

```
procedure TMyThread.Execute;
var
  Msg: TMsg;
begin
  ...
  while not Terminated do
  begin
    ...
    if MsgWaitForMultipleObjects(0, nil, FALSE, SomeTimeout, QS_ALLINPUT) = WAIT_OBJECT_0 then
    begin
      while PeekMessage(Msg, 0, 0, 0, PM_REMOVE) do
      begin
        TranslateMessage(Msg);
        DispatchMessage(Msg);
      end;
    end;
    ...
  end;
  ...
end; 
```

# ios - JASidePanels 黑盒

> ID：15467267
> 
> 赞同：0
> 
> 时间：2013-03-17T22:54:11.647
> 
> 标签：ios, cocoa-touch

请看下图。请记住，我也在使用 xcode 4.5.2。[我按照来自github](https://github.com/gotosleep/JASidePanels) Example #2的 JASidePanels 上的示例进行操作，但我似乎无法摆脱这个黑匣子！否则 SidePanel 实际上会按预期工作。=)

[问题图片](http://imgur.com/EoJq9zf)

我的 centerViewController 和 leftViewController 看起来也一样（代码如下）。但是当我尝试像示例中所说的那样做时，我没有这样的运气，所以我不得不继承 JASidePanelController：

中心视图控制器.h：

```
#import "JASidePanelController.h"

@interface centerViewController : JASidePanelController

@end 
```

中心视图控制器.m

```
#import "centerViewController.h"

@interface centerViewController ()

@end

@implementation centerViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

我会不会错过一些东西？我已经注释掉了几行代码来删除主 JASidePanelController 本身上的 rightViewController，认为这可能会导致问题并且只会导致更多问题。我没有示例中 rightViewController 的代码，因为我只使用左侧和中心。因此，我将代码设置回其默认值，并且在我的模拟器中的应用程序上留下了一个黑框。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:37:37.530

不要从`JASidePanelController`您的中心视图控制器继承。将 a`JASidePanelController`视为可以容纳 3 个视图控制器的容器视图。这是我`AppDelegate`的一个项目中的一个示例：

```
self.panelController = [[JASidePanelController alloc] init];

UIStoryboard *storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];
UIViewController *centerViewController = [storyboard instantiateInitialViewController];
self.panelController.centerPanel = centerViewController;
self.panelController.delegate = centerViewController;
self.panelController.rightPanel = [[DBRightViewController alloc] init];
self.panelController.leftPanel = [[DBLeftViewController alloc] init]; 
```

这样想，你需要一个单独`JASidePanelViewController`的 ，它将容纳你的其他视图控制器。这可以是 的子类`JASidePanelViewController`，但只要您将对它的引用存储在某处，就可能不需要它。在我的示例中，我将.`panelController`作为属性存储在我的`AppDelegate`.

然后，您的每个视图控制器都将是`UIViewController`.

# android - 两个具有不同任务的不同搜索栏

> ID：15467268
> 
> 赞同：0
> 
> 时间：2013-03-17T22:54:19.627
> 
> 标签：android, google-maps

我有一个`SeekBar`执行特定任务的。我想添加另一个`SeekBar`不同的任务。

我怎么能放

```
seekbar.setOnSeekBarChangeListener(this); 
```

每个人都是独一无二的`SeekBar`。现在，当我触摸任一搜索栏时，结果相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:01:14.557

你有几个选择：

1）常见的做法是使用匿名类。像这样：

```
curSlider.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {

            @Override
            public void onStopTrackingTouch(SeekBar seekBar) {
                Log.d("slider","stop tracking");

            }

            @Override
            public void onStartTrackingTouch(SeekBar seekBar) {

            }

            @Override
            public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {

            }
        }); 
```

2）如果要使用`this`，则需要使用一些逻辑来确定`SeekBar`正在移动的内容（使用 ids 或对象引用）。喜欢：

```
public void onProgressChanged(SeekBar seekBar, int progress,
                    boolean fromUser) {
    if (seekBar == mySeekBar1) {

    } else if (seekBar == mySeekBar2) {

    }

} 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2017-01-26T13:35:19.667

您可以添加任何编号。搜索栏和每个人都做某事我有一个带有 3 个搜索栏的示例代码，每个搜索栏都发送其​​进度值，并共同创建一个颜色以设置为 imageview 的背景

```
import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;
import android.widget.ImageView;
import android.widget.SeekBar;
public class MainActivity extends Activity {
    SeekBar seekBar1, seekBar2, seekBar3;
    ImageView imageView;
    public int pro1,pro2,pro3;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        imageView = (ImageView) this.findViewById(R.id.imageView);
        seekBar1 = (SeekBar) this.findViewById(R.id.seekBar1);
        seekBar2 = (SeekBar) this.findViewById(R.id.seekBar2);
        seekBar3 = (SeekBar) this.findViewById(R.id.seekBar3);
        seekBar1.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {
            @Override
            public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {
              pro1= progress;
                imageView.setBackgroundColor(Color.argb(200, pro1, pro2, pro3));
            }
            @Override
            public void onStartTrackingTouch(SeekBar seekBar) {
            }
            @Override
            public void onStopTrackingTouch(SeekBar seekBar) {
            }
        });
        seekBar2.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {
            @Override
            public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {
               pro2= progress;
                imageView.setBackgroundColor(Color.argb(200, pro1, pro2, pro3));
            }
            @Override
            public void onStartTrackingTouch(SeekBar seekBar) {
            }
            @Override
            public void onStopTrackingTouch(SeekBar seekBar) {
            }
        });
        seekBar3.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {
            @Override
            public void onProgressChanged(SeekBar seekBar, int progress, boolean fromUser) {
               pro3=progress;
                imageView.setBackgroundColor(Color.argb(200, pro1, pro2, pro3));
            }
            @Override
            public void onStartTrackingTouch(SeekBar seekBar) {
            }
            @Override
            public void onStopTrackingTouch(SeekBar seekBar) {
            }
        });
    }
} 
```

这个 YouTube [https://youtu.be/AM6lJnze9nA](https://youtu.be/AM6lJnze9nA)

# visual-studio-2010 - 在 Visual Studio 中，如何编写将日期插入评论的宏？

> ID：15467271
> 
> 赞同：4
> 
> 时间：2013-03-17T22:55:04.977
> 
> 标签：visual-studio-2010, visual-studio, macros, comments, visual-studio-macros

我的问题和它一样准确。我想知道是否可以将日期或日期和时间插入评论中而无需手动写出。但我真正想知道的是，有没有办法做到这一点，我是否必须用 Visual Studio 实现一些东西来为我做这件事，如果是这样，我该怎么做？任何帮助将不胜感激！:)
另外，我正在使用 C-Sharp 进行编码，并且正在使用 Visual Studio 2010。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T09:15:39.667

在 Visual Studio 2010 中，您可以在 Visual Basic 中编写宏并将它们添加到宏资源管理器中。然后在使用 C# 代码编辑器时调用宏。我将我最喜欢的宏绑定到组合键，所以我可以在需要时快速运行它们。

如果您不熟悉宏和 Visual Studio 宏编辑器，请查看此链接。 [宏的 MSDN 文档](http://msdn.microsoft.com/en-us/library/b4c73967%28v=VS.80%29.aspx)

这是向 C# 代码添加注释和日期的代码。

```
 Public Sub AddCommentWithDate()
    Dim doc As Document = DTE.ActiveDocument
    ' only modify the doc, if it is a text document in VS
    Dim textDoc As TextDocument = _
       CType(doc.Object("TextDocument"), TextDocument)

    ' verify that the code editor is C#
    If doc.ProjectItem.ContainingProject.Kind = _
       VSLangProj.PrjKind.prjKindCSharpProject Then
        textDoc.StartPoint.CreateEditPoint()
        textDoc.Selection.Insert("// A comment " & Date.Now)
    End If
End Sub 
```

这是 C# 文件中的结果。

```
// A comment 3/18/2013 2:13:38 AM 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:04:44.447

您可以在 Visual Studio 中编写宏或使用一些外部程序（例如[AutoHotKey](http://www.autohotkey.com/)）为您*键入*文本。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-17T23:06:27.370

当有人发表评论并且您在服务器端处理表单数据时，您可能会添加硬返回（
或 chr(13)），然后在将评论持久化到数据库或 xml 文件之前添加日期。

所以你最终会得到类似......

```
Comments == Comments + Strings.Chr(13) + System.DateTime.Today 
```

或者

```
Comments == Comments + ("<br />") + System.DateTime.Today 
```

# objective-c - OSX/Cocoa 创建状态栏项目时出现问题（Apple 指南不适合我）

> ID：15467273
> 
> 赞同：3
> 
> 时间：2013-03-17T22:55:14.133
> 
> 标签：objective-c, cocoa, nsstatusitem

我相信我正确地遵循了这个例子。（[https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/StatusBar/Tasks/creatingitems.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/StatusBar/Tasks/creatingitems.html)）

```
@interface AppDelegate : NSObject <NSApplicationDelegate> {
NSStatusItem *testItem;
NSMenu *testMenu;
} 
```

...

```
@implementation AppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    testMenu = [[NSMenu alloc] init];
    [testMenu addItemWithTitle:@"An Item" action:nil keyEquivalent:nil];
    [testMenu addItemWithTitle:@"Another Item" action:nil keyEquivalent:nil];

    NSStatusBar *bar = [NSStatusBar systemStatusBar];

    testItem = [[NSStatusItem alloc] init];
    testItem = [bar statusItemWithLength:NSVariableStatusItemLength];
    [testItem setTitle: @"X"];
    [testItem setHighlightMode:YES];
    [testItem setMenu:testMenu];
    [testItem setEnabled:YES];
} 
```

我构建并运行。看不到新的状态栏项目。为什么不？如果我是一个无知的新手，请原谅我。我假设我忽略了一些基本的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T23:07:45.597

`keyEquivalent`因为`addItemWithTitle`不能为零。当您这样做时，会发生异常，因此它永远不会超过这些行。用这样的东西改变这两行：

```
[testMenu addItemWithTitle:@"An Item" action:nil keyEquivalent:@"a"];
[testMenu addItemWithTitle:@"Another Item" action:nil keyEquivalent:@"i"]; 
```

现在一切正常。您可以通过查看调试器的输出来解决此类问题。在这种情况下，给出正确线索的输出是“无效参数不满足：charCode！= nil”。

您可以从[`NSMenu's`文档](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/nsmenu_Class/Reference/Reference.html#//apple_ref/occ/instm/NSMenu/addItemWithTitle:action:keyEquivalent:)中获得更多信息：

> 一个字符串，标识用作菜单项的等效键的键。如果您不希望菜单项具有等效键，则 keyEquiv 应为空字符串 (@"") 而不是 nil。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:33:25.583

我知道这是基本的东西。应该是我检查的第一件事。`- (void)applicationDidFinishLaunching:(NSNotification *)aNotification`没有被调用。现在修好了。

# html - 不了解伪元素的堆叠上下文

> ID：15467278
> 
> 赞同：5
> 
> 时间：2013-03-17T22:55:34.820
> 
> 标签：html, css

这是我的 jsfiddle：http: [//jsfiddle.net/vSJnL/4/](http://jsfiddle.net/vSJnL/4/)

我的`#generated`div 的 a`z-index`为 1，而伪元素的 a`z-index`为 -1 *，但*只显示 div 文本，而不是 div 出现在生成的内容上方，就像我预期的那样。此外，如果我给伪元素一个正的 z-index 和 div 一个更大的 z-index，[那么伪元素后面的](http://jsfiddle.net/vSJnL/3/)`<div>`剩余部分..

谁能解释为什么会这样？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T23:47:16.150

假设您的内容不会为空（为了清楚起见），即`content: "generated";`：http: [//jsfiddle.net/vSJnL/5/](http://jsfiddle.net/vSJnL/5/)

然后它会呈现如下：

```
<div id="over">
    <div id="generated">
    Hello World!
    <span>generated</span>
    </div>
</div> 
```

见[http://jsfiddle.net/vSJnL/6/](http://jsfiddle.net/vSJnL/6/)

请参阅 w3c 的规范：http: [//www.w3.org/TR/CSS21/generate.html#before-after-content](http://www.w3.org/TR/CSS21/generate.html#before-after-content)

所以生成的元素在文本节点之后的 div#generated**内部**，而不是在 div#generated 本身之后。

考虑到这一点，堆叠上下文是不言自明的：伪元素`z-index: -1`成为*最低*堆叠位置（只有背景在下方）。结果，Textnode 覆盖了伪元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T01:00:55.623

我试验了你的 HTML 元素：

```
<div id="over" class="case{0,1,2}">
    <div class="generated">Hello World!</div>
</div> 
```

并使用以下 CSS 查看了 3 个案例。为了演示，我稍微改变了生成内容的样式：

```
.generated {
    background-color: gray;
    border: 1px dotted black;
    color: white;
    width: 20rem;
    position: relative;
}
.generated::after {
    content:"\00A0";
    display: block;
    width: 0;
    height: 0;
    border-width: 20px;
    border-color: khaki blue khaki red;
    border-style: solid;
    position: absolute;
    left: 0;
    top: 0;
}

.case0 .generated {
}
.case0 .generated::after {
}

.case1 .generated {
}
.case1 .generated::after {
    z-index: -1;
}

.case2 .generated {
    z-index: 200
}
.case2 .generated::after {
    z-index: -1;
} 
```

默认情况下，我不设置，`z-index`并且生成的内容会滑过文本注释内容，只是使用绝对定位重叠内容。

在情况 1 中，应用于`z-index: -1`生成的内容，它会移动到元素下方。

在情况 2 中，将`z-index: 200`（或任何数字 1 或更大）应用于生成的内容，在这种情况下，生成的内容出现在节点文本和元素之间`.generated`。`z-index: -1`

在情况 1 中，您只是将生成的内容 1 的 z 索引沿 z 轴筛选。由于节点文本及其容器位于同一 z 轴级别，因此生成的内容出现在容器和节点文本下方。

在情况 2 中，您将节点文本从其容器中向上移动，然后将生成的内容向下移动 1 到节点文本下方，因此生成的内容在容器上方但在节点文本下方。

这可能是一种有用的 CSS 技术。

小提琴参考：http: [//jsfiddle.net/audetwebdesign/9sR8B/](http://jsfiddle.net/audetwebdesign/9sR8B/)

# php - PHP 形式中 mime 类型的差异

> ID：15467286
> 
> 赞同：0
> 
> 时间：2013-03-17T22:56:44.473
> 
> 标签：php, mime-types

我想上传 .docx，但是

在`$_FILES['field']['type']`是`application/vnd.openxmlformats-officedocument.wordprocessingml.document`，但作为`mime_content_type()`回报`application/zip`

为什么这些类型不同？哪个好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:02:31.027

DOCX 格式由许多不同的文件组成，这些文件都封装在一个 zip 文件中。您正在使用的软件正在检查文件，发现它是一个 zip 文件，并使用标准 MIME 类型的 zip 报告它。

“好”有点受制于人，但`application/vnd.openxmlformats-officedocument.wordprocessingml.document`可能更好，因为它更具体。

# linux - 如何在 Linux 中实现发布/订阅，而无需手动记录订阅列表，也无需像 D-Bus 这样的用户空间助手？

> ID：15467287
> 
> 赞同：1
> 
> 时间：2013-03-17T22:56:45.303
> 
> 标签：linux, sockets, publish-subscribe, multicast

我想要多播 AF_UNIX 数据报套接字（类似的低级）。

Linux内核中是否已经为此实现了一些东西？我希望它将发布/订阅逻辑保留在内核中，而不是任何用户空间守护进程中。一个系统调用——我们发布——N 个唤醒线程——他们通知了。

```
/* in publisher: */
send(fd, "first\n", 6, TO_ALL_THREADS_PLEASE);
send(fd, "second\n", 7, TO_ALL_THREADS_PLEASE);

/* in the first subscriber thread: */
sleep(1);
recv(fd, buf, 100, 0); /* receive "first" */
recv(fd, buf, 100, 0); /* receive "second" */

/* meanwhile in the second subscriber thread: */
recv(fd, buf, 100, 0); /* receive "first" */
sleep(1);
recv(fd, buf, 100, 0); /* receive "second" */ 
```

# java - Android 错误：令牌“}”上的语法错误，删除此令牌

> ID：15467291
> 
> 赞同：0
> 
> 时间：2013-03-17T22:57:05.367
> 
> 标签：java, android

我有以下代码，但似乎无法弄清楚为什么我会收到上述错误消息。我显然知道这意味着什么，但我检查了括号，它们对我来说似乎是正确的。我正在运行 ADT 21.1.0。到目前为止，我已经尝试重新启动 Eclipse；重新启动我的电脑；并重新构建项目。

```
package cct.mad.lab;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;

public class WalkList extends ListActivity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // storing string resources into Array
        String[] players = getResources().getStringArray(R.array.players);

        // Binding resources Array to ListAdapter
        this.setListAdapter(new ArrayAdapter<String>(this, R.layout.list_item, R.id.label, players));
    }

    protected void onListItemClick (ListView 1, View v, int position, long id) {
        String item = (String) getListAdapter().getItem(position);
    Toast.makeText(this, item + " selected", Toast.LENGTH_LONG).show();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:06:47.447

这几乎可以肯定是因为定义中定义的标识符无效`onListItemClick`。

`ListView`将标识符`onListItemClick`从更改`1`为其他内容（有效标识符）。

从[jls-3.8](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.8)：

> 标识符是 Java 字母和 Java 数字的无限长度序列，**其中第一个必须是 Java 字母**。

有关 Java 信函的更多信息：

> “Java 字母”包括大写和小写的 ASCII 拉丁字母 `A-Z (\u0041-\u005a)`和`a-z (\u0061-\u007a)`, 以及出于历史原因的 ASCII 下划线`(_, or \u005f)`和美元符号 ( `$`, 或 `\u0024`)。该`$`字符应仅用于机械生成的源代码中，或者很少用于访问遗留系统上预先存在的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:07:41.770

使用“1”作为标识符使编译器感到困惑。[这个答案](https://stackoverflow.com/questions/1645273/why-can-an-identifier-not-start-with-a-number)希望能提供一些关于为什么 Java 中的变量名不能以数字开头的见解，但从根本上说，它在[语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.8)中。

# cocoa - 如何阻止逗号破坏 Cocoa 中的浮点转换？

> ID：15467292
> 
> 赞同：1
> 
> 时间：2013-03-17T22:57:18.040
> 
> 标签：cocoa, nsstring

我有一个带有表格视图的简单 Cocoa 应用程序。表格的每个单元格代表一个浮点值。浮点数存储在具有 5 个浮点属性的对象中，其名称与我为表视图中的列设置的标识符相匹配。

我已经设法将它们全部连接起来，以便存储的浮点值是可编辑的，除了当问题的数字恰好是 1,000 或更多时，这一切都很好。在这种情况下，输入数字后，它会返回到用逗号格式化的表格视图。

到目前为止一切顺利，除非您输入一个带有逗号的数字，否则逗号之后的所有内容都会在浮点转换中丢失。

因此，例如：

*   45.0 变为 45
*   999.9 变成 999.9
*   0 变成 0.0（不知道为什么小数点显示为零）
*   1000 变成 1,000
*   1,000 变成 1
*   2,312 变成 2

所以问题出在最后三个例子上。对于 1000 或更大的数字，会自动插入逗号，但如果输入逗号，则无法正确解释。

我没有在我的代码中明确地进行浮点转换，当我在属性上调用 setValueForKey 时正在后台处理它，当我调用 valueForKey 时正在发生字符串转换 - 在我的代码中传递了 ID。

这是我的数据控制器中的相关代码：

```
- (id)tableView:(NSTableView *)tableView objectValueForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {
    TCPointGroup *pg = [points objectAtIndex:row];
    NSString *ident = [tableColumn identifier];
    return [pg valueForKey:ident];
}

- (void)tableView:(NSTableView *)tableView setObjectValue:(id)object forTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {
    TCPointGroup *pg = [points objectAtIndex:row];
    NSString *ident = [tableColumn identifier];
    [pg setValue:object forKey:ident];
} 
```

这是保存浮点值的对象的定义：

```
@interface TCPointGroup : NSObject {

}

@property float pt_Xw;
@property float pt_Yw;
@property float pt_Zw;
@property float pt_xd;
@property float pt_yd;

+ (id)newWithArray:(NSArray*)array;
- (id)initWithArray:(NSArray*)array;

@end 
```

对我来说，逗号是由浮点到字符串的转换插入的，但在发生的字符串到浮点的转换中没有正确理解，这对我来说似乎很奇怪。

关于如何使其以预期方式工作的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T10:00:46.030

看来我找到了解决方案。NSNumberFormatter 类能够理解带有逗号的浮点数的字符串版本。解决方案是实例化一个 NSNumberFormatter，将其格式设置为十进制样式并调用 numberFromString。然后可以将此 NSNumber 对象发送到期望浮点数的对象。

更新了以下相关方法的代码...

```
- (void)tableView:(NSTableView *)tableView setObjectValue:(id)object forTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {
    NSNumber* value = [_formatter numberFromString:object];
    if( value ) {
        TCPointGroup *pg = [points objectAtIndex:row];
        NSString *ident = [tableColumn identifier];
        [pg setValue:value forKey:ident];
    }
} 
```

_formatter 对象是在数据处理类的初始化阶段创建的，如下所示：

```
 _formatter = [[NSNumberFormatter alloc] init];
    [_formatter setNumberStyle:NSNumberFormatterDecimalStyle]; 
```

**编辑**感谢@yinkou 下面的评论导致只创建一个格式化程序，而不是每次调用创建和销毁一个格式化程序。

# wpf - WPF TabControl - 我是否需要 ItemTemplateSelector *和* ContentTemplateSelector？

> ID：15467294
> 
> 赞同：1
> 
> 时间：2013-03-17T22:57:57.900
> 
> 标签：wpf, tabcontrol, contenttemplateselector, itemtemplateselector

所以我在我的 WPF 应用程序中拥有一个主要的用户控件`TabControl`，它将支持几个不同的视图（基本上是用于数据输入的表单）及其底层视图模型（基本上是 ORM 映射。）

我构建了一个`ContentTemplateSelector`为所选项目抛出正确的内容视图。

所以我的问题是：

我应该建立一个`ItemTemplateSelector`选择将从底层视图模型中选择正确的属性，该模型将充当标签标题标题吗？

或者，我应该将每个视图模型的属性分配给另一个名为 DisplayTitle 的属性，然后在`ItemTemplate`?

更一般地说，有没有办法将 ItemTemplate 和 ContentTemplate 的“选择”组合在一个选择器下？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T02:38:21.427

我通常对内容使用[基于类型的](http://msdn.microsoft.com/en-us/library/system.windows.datatemplate.datatype.aspx)数据模板，并为标题使用公共属性（设置为`DisplayMemberPath`）或类上的[属性](http://msdn.microsoft.com/en-us/library/system.componentmodel.displaynameattribute.aspx)（如果每个类有一个项目）。

我怀疑您是否可以方便地组合选择器，我也不喜欢一般的选择器......

# java - Java SDK 管理器在命令行输出中出现“flashplayerplugin”崩溃

> ID：15467295
> 
> 赞同：8
> 
> 时间：2013-03-17T22:58:06.030
> 
> 标签：java, android, command-line

我阅读了一些关于`sdk manger`Java 问题的主题，但我的问题与任何问题都不对应。当我启动时，`SDK manager.exe`我得到输出：

```
flashplayerplugin 
```

当我认为这是我启动的 Java 问题时`sdk\tools\libs\find_java.exe`（.bat 返回一个空行）

我得到输出：

```
flashplayerpluginC:\Program Files\Java\jdk1.7.0_17\bin\java.exe 
```

我真的不明白为什么这`flashplayerplugin`会出现在输出中并使程序崩溃。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-24T12:54:54.930

我遇到过同样的问题。我的问题是由工具引起的`airfoil`。它在以下位置写入了一个注册表项：

`HKEY_CURRENT_USER\Software\Rogue Amoeba\Airfoil\WhiteList\WhiteListItem_12`

有条目：

`name = *flashplayerplugin`

解决方法：去掉`*`之前的`flashplayerplugin`，然后`SDK Manager.exe`就可以正常启动了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T22:05:23.280

这不是 Java 的问题，而是 Flash 的问题。请参阅[此超级用户线程](https://superuser.com/questions/567203/cmd-exe-text-injection-whats-going-on)。那里的海报能够解决它，但我不能并且不得不使用系统还原来回到我更新到最新的 Flash 播放器之前的点。就我而言，我认为不同之处可能在于 Chrome 的自定义 Flash 播放器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-27T00:09:26.087

如果您可以选择，只需卸载 Airfoil 即可。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-03-17T23:01:49.210

更新 Flash Player 和 Java ...可能会有所帮助

# c++ - 内存泄漏能走多远？

> ID：15467298
> 
> 赞同：121
> 
> 时间：2013-03-17T22:58:24.987
> 
> 标签：c++, c, memory, memory-leaks

我多次遇到内存泄漏。通常当我`malloc`像没有明天一样，或者`FILE *`像脏衣服一样晃来晃去的时候。我通常假设（阅读：绝望地希望）至少在程序终止时所有内存都被清理了。是否存在程序终止或崩溃时不会收集泄漏内存的情况？

如果答案因语言而异，那么让我们关注 C(++)。

请注意短语的双曲用法，“就像没有明天”和“晃来晃去……像脏衣服一样”。不安全* `malloc`*ing 会伤害您所爱的人。此外，请谨慎使用脏衣服。

* * *

## 回答 #1

> 赞同：116
> 
> 时间：2013-03-17T23:00:25.740

不会。操作系统在进程退出时释放进程持有的所有资源。

这适用于操作系统维护的所有资源：内存、打开的文件、网络连接、窗口句柄......

也就是说，如果程序在没有操作系统的嵌入式系统上运行，或者在非常简单或有缺陷的操作系统上运行，则内存可能在重新启动之前无法使用。但如果你处于那种情况下，你可能不会问这个问题。

操作系统可能需要很长时间才能释放某些资源。例如，网络服务器用来接受连接的 TCP 端口可能需要几分钟才能空闲，即使被程序正确关闭。联网的程序也可以保存*远程*资源，例如数据库对象。当网络连接丢失时，远程系统应该释放这些资源，但它可能需要比本地操作系统更长的时间。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-03-17T23:01:17.627

C 标准没有指定`malloc`在程序终止时释放分配的内存。这是由操作系统完成的，并不是所有的操作系​​统（通常在嵌入式世界中）都会在程序终止时释放内存。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-03-18T03:22:37.940

由于所有答案都涵盖了现代操作系统问题的大部分方面，但从历史上看，如果您曾经在 DOS 世界中编程过，那么有一个值得一提。[终止和驻留](http://en.wikipedia.org/wiki/Terminate_and_Stay_Resident)（TSR）程序通常会将控制权返回给系统，但会驻留在内存中，可以通过软件/硬件中断来恢复。在这些操作系统上工作时，看到诸如*“内存不足！尝试卸载一些 TSR”之*类的消息是正常的。

所以从技术上讲，**程序终止**了，但是因为它仍然驻留在内存中，所以除非你卸载程序，否则任何内存泄漏都不会被释放。

因此，除了操作系统不回收内存之外，您可以认为这是另一种情况，因为它有问题或因为嵌入式操作系统旨在这样做。

我还记得一个例子。[客户信息控制系统](http://en.wikipedia.org/wiki/CICS)(CICS) 是一种主要在 IBM 大型机上运行的事务服务器，它是伪对话的。执行时，它处理用户输入的数据，为用户生成另一组数据，传输到用户终端节点并终止。激活注意键后，它会再次恢复处理另一组数据。因为它的行为方式再次从技术上讲，操作系统不会从终止的 CICS 程序中回收内存，除非您回收 CICS 事务服务器。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-03-18T00:53:10.173

正如其他人所说，大多数操作系统将在进程终止时回收分配的内存（可能还有其他资源，如网络套接字、文件句柄等）。

话虽如此，在处理 new/delete（而不是原始 malloc/free）时，内存可能不是您唯一需要担心的事情。在 new 中分配的内存可能会被回收，但可能在对象的析构函数中完成的事情不会发生。也许某些类的析构函数在销毁时将标记值写入文件。如果进程刚刚终止，文件句柄可能会被刷新并回收内存，但不会写入该标记值。

故事的道德，总是在自己之后清理。不要让事情悬而未决。不要依赖操作系统进行清理。自己打扫干净。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-03-17T23:02:10.033

这更可能取决于操作系统而不是语言。最终，任何语言的任何程序都会从​​操作系统中获得它的内存。

我从未听说过在程序退出/崩溃时不回收内存的操作系统。因此，如果您的程序在需要分配的内存上有一个上限，那么只分配而不释放是完全合理的。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-03-17T23:18:34.473

所有当之无愧的操作系统都将清理您的进程在终止后造成的混乱。但是总是有不可预见的事件，如果它以某种方式被拒绝访问并且一些可怜的程序员没有预见到这种可能性，所以它不会稍后再试一次怎么办？如果内存泄漏对任务至关重要，那么清理自己总是更安全 - 否则，如果这项工作代价高昂，IMO 就不值得付出努力。

编辑：您确实需要清理内存泄漏，如果它们在它们会累积的地方，比如在循环中。我所说的内存泄漏是在整个程序过程中不断累积的，如果你有任何其他类型的泄漏，它很可能迟早会成为一个严重的问题。

用技术术语来说，如果您的泄漏是内存“复杂性”O(1)，在大多数情况下它们都很好，O(logn) 已经令人不快（在某些情况下是致命的）并且 O(N)+ 无法忍受。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2013-03-18T01:32:20.590

如果程序曾经变成一个动态组件（“插件”）并加载到另一个程序的地址空间中，这将是很麻烦的，即使在具有整洁内存管理的操作系统上也是如此。我们甚至不必考虑将代码移植到功能较弱的系统上。

另一方面，释放所有内存*会*影响程序清理的性能。

我正在处理的一个程序，某个测试用例需要 30 秒或更长时间才能退出程序，因为它正在遍历所有动态内存的图形并逐个释放它。

一个合理的解决方案是拥有该功能并用测试用例覆盖它，但在生产代码中将其关闭，以便应用程序快速退出。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-03-20T08:12:18.703

POSIX 兼容系统上的共享内存一直存在，直到调用 shm_unlink 或系统重新启动。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-03-18T11:01:02.163

如果您有进程间通信，这可能会导致其他进程永远不会完成和消耗资源，具体取决于协议。

举个例子，当我在打印机作业的中间终止 JVM 时，我曾经尝试用 Java 打印到 PDF 打印机，PDF 假脱机进程仍然处于活动状态，我必须在任务管理器中将其杀死才能完成重试打印。

# php - 请求纬度经度 - G_GEO_BAD_KEY

> ID：15467303
> 
> 赞同：0
> 
> 时间：2013-03-17T22:59:09.423
> 
> 标签：php, google-maps, geocoding

我有一个脚本`PHP`来获取地址的纬度和经度。我从来没有使用过`API KEY`，但代码总是有效的。几周前，它停止工作所以，我得到了一个`API Key`. 但是，不起作用。

按照脚本的一部分：

```
function loadURL($url){
    if (function_exists('curl_init')) {
       $cURL = curl_init($url);
       curl_setopt($cURL, CURLOPT_RETURNTRANSFER, true);
       curl_setopt($cURL, CURLOPT_FOLLOWLOCATION, true);
       $result = curl_exec($cURL);
       curl_close($cURL);
    } else {
       $result = file_get_contents($url);
    }    
    if (!$result) 
       return false;        
    return $result;        
} 
```

我用另一个例子做了一个测试： **1600 Amphitheatre Parkway, Mountain View, CA**

谷歌使用的相同示例。

这是网址： http://maps.googleapis.com/maps/geo?q=1600+Amphitheatre+Parkway,+Mountain+View,+CA&output=csv&sensor=true_or_false&key=
[your_api_key](http://maps.googleapis.com/maps/geo?q=1600+Amphitheatre+Parkway,+Mountain+View,+CA&output=csv&sensor=true_or_false&key=your_api_key)

我把我的`API key`，设置`true`或`false`传感器，但结果是：

```
Status: 610 (**G_GEO_BAD_KEY**) 
```

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:16:34.007

You are using the v2 version of the geocoder. The v2 geocoder only works with v2 keys which are no longer available [(reference: this post in the Google Maps API v2 group)](https://groups.google.com/group/google-maps-api/browse_frm/thread/6076465c15645dac#)

If you have a v2 key use that. If not, get a v3 key and transition to the [v3 Geocoding web service](https://developers.google.com/maps/documentation/geocoding/).

# c - 我可以使用哪种索引方法将 X^2 向量之间的距离存储在没有冗余的数组中？

> ID：15467304
> 
> 赞同：0
> 
> 时间：2013-03-17T22:59:11.983
> 
> 标签：c, vector, indexing, distance, redundancy

我正在做一个需要大量向量数学的演示，在分析中，我发现它花费最多的时间来查找给定向量之间的距离。

现在，它遍历一组 X^2 向量，并找到每个向量之间的距离，这意味着它运行距离函数 X^4 次，即使（我认为）只有 (X^2)/2 唯一距离。

它的工作原理是这样的：（伪c）

```
#define MATRIX_WIDTH 8

typedef float vec2_t[2];
vec2_t matrix[MATRIX_WIDTH * MATRIX_WIDTH];

...

for(int i = 0; i < MATRIX_WIDTH; i++)
{
    for(int j = 0; j < MATRIX_WIDTH; j++)
    {
        float xd, yd;
        float distance;

        for(int k = 0; k < MATRIX_WIDTH; k++)
        {
            for(int l = 0; l < MATRIX_WIDTH; l++)
            {
                int index_a = (i * MATRIX_LENGTH) + j;
                int index_b = (k * MATRIX_LENGTH) + l;

                xd = matrix[index_a][0] - matrix[index_b][0];
                yd = matrix[index_a][1] - matrix[index_b][1];

                distance = sqrtf(powf(xd, 2) + powf(yd, 2));
            }
        }

        // More code that uses the distances between each vector
    }
} 
```

我想做的是创建并填充 (X^2) / 2 距离的数组，没有冗余，然后在我最终需要它时引用该数组。但是，我对如何以可行的方式索引该数组持空白。哈希表可以做到这一点，但我认为对于一个似乎可以通过巧妙的索引方法解决的问题来说，它太复杂和太慢了。

编辑：这是一个植绒模拟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T00:18:47.310

性能理念：a）如果可能的话，使用平方距离，以避免根计算 b）永远不要使用 pow 来表示常数，整数幂 - 而是使用 xd*xd

我会考虑改变你的算法 - O(n^4) 真的很糟糕。在处理物理中的相互作用时（对于 2d 场中的距离也是 O(n^4)），人们会实施 b-trees 等并忽略影响较小的粒子相互作用。但这将取决于“使用距离的更多代码......”的真正作用。

只是做了一些考虑：唯一距离的数量是 0.5*n*n(+1)，其中 n = w*h。如果你记下发生唯一距离的时间，你会发现两个内环都可以减少，从 i 和 j 开始。

此外，如果您只需要通过矩阵索引访问这些距离，您可以设置一个 4D 距离矩阵。

如上所述，如果内存有限，我们可以节省近 50%，正如 Code-Guru 所说，使用可以访问三角矩阵的查找功能。我们可能会预先计算线路索引以避免总结访问

```
float distanceArray[(H*W+1)*H*W/2];
int lineIndices[H];

searchDistance(int i, int j)
{
    return i<j?distanceArray[i+lineIndices[j]]:distanceArray[j+lineIndices[i]];
} 
```

# c# - 使用 Visual Studio 2010 在 C# 中编写热键

> ID：15467306
> 
> 赞同：0
> 
> 时间：2013-03-17T22:59:19.323
> 
> 标签：c#, visual-studio-2010, checkbox, hotkeys

我有一个小表格，里面有 9 个复选框。我正在尝试为与 Numpad 对应的那些框制作热键，但我的时间最长。我有两个主要问题：

1.

```
 private void checkBox1_KeyDown(object sender, KeyEventArgs e)
    {
        if (e.KeyCode == Keys.NumPad7)
        {
            MessageBox.Show("It's working");

        }
    } 
```

那是我的代码。它有效，但没有做我想要的。它会显示一条消息，但前提是该复选框被突出显示。我认为 KeyPreview 在这种情况下可能会有所帮助，但 MSDN 数据库并没有帮助我解决我试图弄清楚如何使 KeyPreview 工作的问题。

其次，我希望代码在我按下热键时选中该框。我认为使用 CheckState 的任何组合似乎都不起作用。如果有人有一些煽动，我将不胜感激。

* * *

评论中的代码：

```
public Form2() 
{ 
    InitializeComponent(); 
    this.KeyPreview = true; 
    this.KeyDown += new KeyEventHandler(Form2_KeyDown);
} 

private void Form2_KeyDown(object sender, KeyEventArgs e) 
{ 
    switch (e.KeyCode) 
    { 
        case Keys.NumPad7: 
            MessageBox.Show("ABC"); 
            break; 

        default: 
            break; 
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T02:04:16.763

您的问题并未说明您是否希望这是特定于应用程序的热键或系统热键。我在假设它是特定于应用程序的假设下进行操作。您的假设是正确的，您需要将 Forms KeyPreview 属性设置为 true。然后，您需要将用于设置和清除复选框的代码放入 Forms Keydown 事件中，如下所示：

```
private void Form1_KeyDown(object sender, KeyEventArgs e)
{
    switch (e.KeyCode )
    {
        case Keys.NumPad1:
            if (checkBox1.Checked)
                checkBox1.Checked = false;
            else
                checkBox1.Checked = true;

            break;
        case Keys.NumPad2:
            if (checkBox2.Checked)
                checkBox2.Checked = false;
            else
                checkBox2.Checked = true;

            break;
        case Keys.NumPad3:
            if (checkBox3.Checked)
                checkBox3.Checked = false;
            else
                checkBox3.Checked = true;

            break;
        case Keys.NumPad4:
            if (checkBox4.Checked)
                checkBox4.Checked = false;
            else
                checkBox4.Checked = true;

            break;
        case Keys.NumPad5:
            if (checkBox5.Checked)
                checkBox5.Checked = false;
            else
                checkBox5.Checked = true;

            break;
        case Keys.NumPad6:
            if (checkBox6.Checked)
                checkBox6.Checked = false;
            else
                checkBox6.Checked = true;

            break;
        case Keys.NumPad7:
            if (checkBox7.Checked)
                checkBox7.Checked = false;
            else
                checkBox7.Checked = true;

            break;
        case Keys.NumPad8:
            if (checkBox8.Checked)
                checkBox8.Checked = false;
            else
                checkBox8.Checked = true;

            break;
        case Keys.NumPad9:
            if (checkBox9.Checked)
                checkBox9.Checked = false;
            else
                checkBox9.Checked = true;

            break;
        default:
            break;
        }
    } 
```

然后，您可以为 CheckedChanged 事件创建一个通用的 EventHandler，并检查选择了哪个 Checkbox 来运行相应的方法。

```
void checkBox_CheckedChanged(object sender, EventArgs e)
{
    CheckBox cb = (CheckBox)sender;

    switch(cb.Name)
    {
        case "checkBox1":
            if (cb.Checked)
                // Method to use when checkBox1 is checked
            else
                // Method to use when checkBox1 is unchecked

            break;

        case "checkBox2":
            if (cb.Checked)
                // Method to use when checkBox2 is checked
            else
                // Method to use when checkBox2 is unchecked

            break;

        case "checkBox3":
            if (cb.Checked)
                // Method to use when checkBox3 is checked
            else
                // Method to use when checkBox3 is unchecked

            break;

        default:
            break;

        //Implement your other checkBox's the same way.
        }

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-04-13T02:15:28.967

现在可以在要使用 ALT 启用的字母之前简单地添加一个 & 符号。欲了解更多信息：

[https://docs.microsoft.com/en-us/dotnet/desktop/winforms/controls/how-to-create-access-keys?view=netdesktop-5.0](https://docs.microsoft.com/en-us/dotnet/desktop/winforms/controls/how-to-create-access-keys?view=netdesktop-5.0)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T23:11:52.640

为所有复选框中的事件分配相同的事件处理程序：

```
_checkbox1.KeyDown += checkBox_KeyDown;
_checkbox2.KeyDown += checkBox_KeyDown;

// And so on... 
```

然后，在里面做检查：

```
private void checkBox_KeyDown(object sender, KeyEventArgs e)
{
    var checkbox = sender as CheckBox;
    if (checkbox == null) { return; }

    if (e.KeyCode == Keys.NumPad1)
    {
        _checkbox1.IsChecked = !_checkbox1.IsChecked;
        return;
    }

    if (e.KeyCode == Keys.NumPad2)
    {
        _checkbox2.IsChecked = !_checkbox2.IsChecked;
        return;
    }

    // And so on...
} 
```

# java - 带有 Java 应用程序的 Mac OS X 上的 PackageMaker

> ID：15467311
> 
> 赞同：0
> 
> 时间：2013-03-17T22:59:53.613
> 
> 标签：java, macos, packagemaker, jarbundler

第 1 步：我有一个 Java 应用程序，我通过 Jar Bundler 将它捆绑到一个 .app 文件中。Java 文件依赖于一些文件夹，其中一个名为“Config”

第 2 步：我右键单击 MyApplication.app，选择“显示包内容”，然后将 Config 文件夹绘制到“资源”文件夹中。

第 3 步：然后，我使用 PackageMaker 制作应用程序安装文件。那太好了。

但是，当我在自己的计算机上安装应用程序以对其进行测试并运行应用程序时，当我尝试写入 Config 文件夹时会出现 Java 错误。即，它是一个 IOException: Permission Denied。当我运行在步骤 2 中生成的应用程序时，不会发生这种情况。我该如何解决这个问题？PackageMaker 步骤 3 的某些原因导致 Java 代码无法写入配置文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:16:46.140

Mac OS X 应用程序不应写入它们自己的包，并且您正在创建的打包应用程序具有（正确）不允许这样做的权限。

您的应用程序写入的文件应该存储在用户的 Library 文件夹中的某个地方，可能在 Application Support 或 Preferences 目录下，具体取决于它们是什么。

# ruby-on-rails - 自动创建一个类的包含模块

> ID：15467313
> 
> 赞同：4
> 
> 时间：2013-03-17T23:00:09.800
> 
> 标签：ruby-on-rails, ruby

在 Rails 中，您可以在 下创建模型`app/foo/bar.rb`，其中 bar.rb 包含：

```
class Foo::Bar
  def some_method
    puts "I work fine"
  end
end 
```

如果您尝试在纯 ruby​​ 应用程序中执行此操作，`NameError: uninitialized constant Foo`除非您已经初始化了一个模块，否则您会得到一个`Foo`。

Rails 做了什么来允许它在不首先初始化包含模块的情况下创建类？是否可以通过诸如 activesupport 之类的东西来导入这种行为，还是让我们自己实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:51:06.167

Rails 修改`Class`类以包含一个[`const_missing`](http://www.ruby-doc.org/core-2.0/Module.html#method-i-const_missing "常量缺失")在使用未定义类时调用的方法。然后它会加载一些东西来尝试加载请求的类。

这在 ActiveSupport 中的实现是在`lib/active_support/dependencies.rb`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-17T23:13:53.117

实际创建的模型类扩展为 < ActiveRecord::Base

# android - 其他进程调用 GC，这会减慢我的游戏速度

> ID：15467314
> 
> 赞同：11
> 
> 时间：2013-03-17T23:00:13.387
> 
> 标签：android, garbage-collection

我正在为 Android >= 2.1 编写实时街机游戏。在游戏过程中，我不分配内存，不引诱 GC。因为如果 GC 调用，它需要处理器 70-200 毫秒。用户将此视为*“哦，不，该游戏落后......”*。

我检查了 LogCat。有很多 GC_FOR_MALLOC 或 GC_EXPLICIT。但是......不是来自我的进程的PID！我的游戏没有引起他们。它们是由于其他进程在后台运行而引起的。一些壁纸、小部件、收音机、电子邮件、天气检查和其他服务......

我完全不明白。例如，当壁纸消失时，我想它的 onPause() 会被调用。因此，它应该停止所有线程并且当然不分配任何内存（或调用 System.gc()）。也许它被错误地实施了？我不知道。但是有一些Android服务，也会时不时造成GC……很奇怪。

这是一个很大的 Android <= 2.2 架构缺陷吗？Android 2.3[引入了](http://developer.android.com/about/versions/android-2.3-highlights.html#gaming)并发 GC，耗时更少。

我可以做些什么来确保我的游戏能够顺利运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T13:25:50.873

首先，您在 LogCat 中看到的内容会因设备而异。如果您确定 GC 不是来自您的应用程序，那么您绝对无能为力。你总是会发现 GC 正在做……某事。确保你的代码保持干净和精简。

另外，请记住，一般来说，在存在垃圾收集器的情况下，手动调用 GC 绝不是好的做法。GC 是围绕启发式算法组织的，这些算法在留给自己的设备时效果最好。手动调用 GC 通常会降低性能。

有时，在一些相对罕见的情况下，人们可能会发现特定的 GC 出错了，然后手动调用 GC 可能会在性能方面有所改善。这是因为实际上不可能实现一个“完美”的 GC 来在所有情况下都以最佳方式管理内存。这种情况很难预测，并且取决于许多微妙的实现细节。“好的做法”是让 GC 自己运行；手动调用 GC 是一个例外，只有在适当地见证了实际性能问题之后才能设想。

我不认为这是 Android <= 2.2 上的缺陷。它发生在更高版本上吗？你测试过吗？

# c++ - 帮助 GCC 进行自动矢量化

> ID：15467316
> 
> 赞同：4
> 
> 时间：2013-03-17T23:00:28.500
> 
> 标签：c++, gcc, mingw, sse, vectorization

我有一个需要优化的着色器（有很多矢量操作），我正在试验 SSE 指令以便更好地理解问题。

我有一些非常简单的示例代码。通过`USE_SSE`定义，它使用显式的 SSE 内在函数；没有它，我希望 GCC 会为我完成这项工作。自动矢量化感觉有点挑剔，但我希望它能为我节省一些头发。

编译器和平台是：gcc 4.7.1 (tdm64)，目标 x86_64-w64-mingw32 和 Ivy Bridge 上的 Windows 7。

这是测试代码：

```
/*
    Include all the SIMD intrinsics.
*/
#ifdef USE_SSE
#include <x86intrin.h>
#endif
#include <cstdio>

#if   defined(__GNUG__) || defined(__clang__) 
    /* GCC & CLANG */

    #define SSVEC_FINLINE __attribute__((always_inline))

#elif defined(_WIN32) && defined(MSC_VER) 
    /* MSVC. */

    #define SSVEC_FINLINE __forceinline

#else
#error Unsupported platform.
#endif

#ifdef USE_SSE

    typedef __m128 vec4f;

    inline void addvec4f(vec4f &a, vec4f const &b)
    {
        a = _mm_add_ps(a, b);
    }

#else

    typedef float vec4f[4];

    inline void addvec4f(vec4f &a, vec4f const &b)
    {
        a[0] = a[0] + b[0];
        a[1] = a[1] + b[1];
        a[2] = a[2] + b[2];
        a[3] = a[3] + b[3];
    }

#endif

int main(int argc, char *argv[])
{
    int const count = 1e7;

    #ifdef USE_SSE
    printf("Using SSE.\n");
    #else
    printf("Not using SSE.\n");
    #endif

    vec4f data = {1.0f, 1.0f, 1.0f, 1.0f};

    for (int i = 0; i < count; ++i)
    {
        vec4f val = {0.1f, 0.1f, 0.1f, 0.1f};
        addvec4f(data, val);
    }

    float result[4] = {0};
    #ifdef USE_SSE
    _mm_store_ps(result, data);
    #else
    result[0] = data[0];
    result[1] = data[1];
    result[2] = data[2];
    result[3] = data[3];
    #endif

    printf("Result: %f %f %f %f\n", result[0], result[1], result[2], result[3]);

    return 0;
} 
```

这是编译的：

```
g++ -O3 ssetest.cpp -o nossetest.exe
g++ -O3 -DUSE_SSE ssetest.cpp -o ssetest.exe 
```

除了显式 SSE 版本更快一点之外，输出没有区别。

这是循环的程序集，首先是显式 SSE：

```
.L3:
subl    $1, %eax
addps   %xmm1, %xmm0
jne .L3 
```

它内联了调用。很好，或多或少只是一个直线上升`_mm_add_ps`。

数组版本：

```
.L3:
subl    $1, %eax
addss   %xmm0, %xmm1
addss   %xmm0, %xmm2
addss   %xmm0, %xmm3
addss   %xmm0, %xmm4
jne .L3 
```

它正在使用 SSE 数学，但在每个数组成员上。不是很可取。

我的问题是，我怎样才能帮助 GCC 以便它可以更好地优化数组版本`vec4f`？

*任何特定于 Linux 的技巧也很有帮助，这就是真正的代码将运行的地方。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-17T23:06:51.340

这篇`LockLess`关于[使用 gcc 4.7 进行自动矢量化](http://locklessinc.com/articles/vectorize/)的文章是我见过的最好的文章，我花了一段时间寻找关于类似主题的好文章。他们还有很多其他[文章](http://locklessinc.com/articles/)，您可能会发现它们对处理所有低级软件开发方式的类似主题非常有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-19T08:47:50.793

以下是基于您的代码的一些提示，可以使 gcc 自动矢量化工作：

*   **使循环向上成为 const**。为了向量化，GCC 需要将循环拆分 4 次迭代以适应 128 位长度的 SSE XMM 寄存器。一个 const 循环上限将帮助 GCC 确保循环有足够的迭代，并且向量化是有利可图的。
*   **删除`inline`关键字**。如果代码被标记为内联，GCC 无法知道数组的起始点是否对齐，而无需通过`-O3`.

    因此，要使您的代码矢量化，您的`addvec4f`函数应修改如下：

    ```
    void addvec4f(vec4f &a, vec4f const &b)
    {
        int i = 0;
        for(;i < 4; i++)
          a[i] = a[i]+b[i];
    } 
    ```

顺便提一句：

*   GCC 也有一些标志来帮助你确定一个循环是否已经被矢量化。`-ftree-vectorizer-verbose=2`, 数字越大输出信息越多，目前可以是`0`, `1`, `2`. [这](http://gcc.gnu.org/projects/tree-ssa/vectorization.html)是此标志和其他一些相关标志的文档。
*   **小心对齐**。`bus error`数组的地址要对齐，编译器不运行是无法知道地址是否对齐的。一般情况下，如果数据不对齐，就会出现a 。[这](https://stackoverflow.com/questions/13400694/why-does-instruction-data-alignment-exist/13411045#13411045)就是原因。

# opencv - 手势/姿势识别的特征提取方法

> ID：15467317
> 
> 赞同：5
> 
> 时间：2013-03-17T23:00:37.050
> 
> 标签：opencv, machine-learning, gesture-recognition, hidden-markov-models, feature-extraction

我目前正在开发一个手语识别应用程序，我想使用隐马尔可夫模型作为分类阶段，这意味着我将对手势/姿势进行分类以获得相关的字母或单词。

我目前已经完成了检测手的第一阶段。目前，我可以获得一些可用于机器学习阶段的参数（特征），例如：

*   手凸包
*   凸面缺陷
*   手心
*   包围旋转的椭圆/矩形（例如获得旋转所需的任何角度）
*   手的轮廓
*   时刻（我不确定这些到底是什么）

这些都可以通过 openCv 完成。

我的问题：一旦我拥有了所有这些特征，我该如何执行“特征提取”阶段？即，如果机器学习算法，在这种情况下 HMM 需要一组概率，我该如何使用上述信息？

我的一个想法是创建一个特殊的数据结构，其中包含唯一标识每个手势的此类信息，但我如何将其提供给机器学习技术？（在这种情况下是隐马尔可夫模型）

谁能指导我在这个特定阶段至少应该寻找什么，或者指导我展示我真正遇到的困难是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T11:52:01.253

准备好一组观察结果后，您可以将其输入维特比算法，以检测可能产生这些观察结果的最佳状态序列。此外，您可以使用 Baum-Welch 算法在样本数据集上训练您的 HMM。你可以看看[我的博客文章](https://blogshivinsaxena.quora.com/The-Hidden-Markov-Model-For-Dummies-like-me)，它是使用 HMM 识别动态手势的简单解释（尽管我没有使用 openCV 或扫描手的轮廓）。希望这可以帮助您大致了解处理和学习阶段。

# php - 以 XML 格式输出 PHP

> ID：15467326
> 
> 赞同：0
> 
> 时间：2013-03-17T23:01:14.933
> 
> 标签：php, xml

我正在尝试以 XML 格式输出 PHP 脚本的结果，但效果不佳。

这是我得到的单行 XML 文件（没有错误消息）

```
<?xml version="1.0" encoding="UTF-8"?> 
```

这就是我想看到的

```
<data>
    <thread>
        <id>my data here</id>
        <author>
            <name>my data here/name>
            <url>my data here</url>
            <id>my data here</id>
        </author>
        <title>my data here</title>
        <reactions>my data here</reactions>
        <dislikes>my data here</dislikes>
        <userScore>my data here</userScore>
        <createdAt>my data here</createdAt>
        <slug>my data here</slug>
        <postNumber>my data here</postNumber>
        <link>my data here</link>
        <likes>my data here</likes>
        <message>my data here</message>
        <category>my data here</category>
        <score>my data here</score>
        <categoryLink>my data here</categoryLink>
    </thread>        
</data> 
```

这是我的代码：

```
//Create XML

$xml = new DOMDocument("1.0", 'UTF-8');

$root = $xml->createElement("data");
$xml->appendChild($root);

$thread = $xml->createElement("thread");

$threadID = $xml->createElement("id");
$threadID->appendChild($xml->createTextNode($details->id));
$thread->appendChild($threadID);

$author = $xml->createElement("author");                          
$thread->appendChild($author);

 $authorName = $xml->createElement("name");
 $authorName->appendChild($xml->createTextNode($parsed_authorName));
 $author->appendChild($authorName);

 $authorUrl = $xml->createElement("url");
 $authorUrl->appendChild($xml->createTextNode($parsed_authorUrl));
 $author->appendChild($authorUrl);

 $authorID = $xml->createElement("id");
 $authorID->appendChild($xml->createTextNode($details->author));
 $author->appendChild($authorID);

$threadTitle = $xml->createElement("title");
$threadTitle->appendChild($xml->createTextNode($details->title));
$thread->appendChild($threadTitle);

$threadReactions = $xml->createElement("reactions");
$threadReactions->appendChild($xml->createTextNode($details->reactions));
$thread->appendChild($threadReactions);

$threadDislikes = $xml->createElement("dislikes");
$threadDislikes->appendChild($xml->createTextNode($details->dislikes));
$thread->appendChild($threadDislikes);

$threadUserScore = $xml->createElement("userScore");
$threadUserScore->appendChild($xml->createTextNode($details->userScore));
$thread->appendChild($threadUserScore);

$threadCreatedAt = $xml->createElement("createdAt");
$threadCreatedAt->appendChild($xml->createTextNode($details->createdAt));
$thread->appendChild($threadCreatedAt);

$threadSlug = $xml->createElement("slug");
$threadSlug->appendChild($xml->createTextNode($details->slug));
$thread->appendChild($threadSlug);

$threadPostNumber = $xml->createElement("postNumber");
$threadPostNumber->appendChild($xml->createTextNode($details->posts));
$thread->appendChild($threadPostNumber);

$threadLink = $xml->createElement("link");
$threadLink->appendChild($xml->createTextNode($details->link));
$thread->appendChild($threadLink);

$threadLikes = $xml->createElement("likes");
$threadLikes->appendChild($xml->createTextNode($details->likes));
$thread->appendChild($threadLikes);

$threadMessage = $xml->createElement("likes");
$threadMessage->appendChild($xml->createTextNode($parsed_threadMessage));
$thread->appendChild($threadMessage);

$threadCategory = $xml->createElement("category");
$threadCategory->appendChild($xml->createTextNode($details->category));
$thread->appendChild($threadCategory);

$threadScore = $xml->createElement("likes");
$threadScore->appendChild($xml->createTextNode($parsed_threadScore));
$thread->appendChild($threadScore);

$threadCategoryLink = $xml->createElement("likes");
$threadCategoryLink->appendChild($xml->createTextNode($parsed_threadCategoryLink));
$thread->appendChild($threadCategoryLink);

$thread->appendChild($root);

$xml->formatOutput = true;

echo "<xmp>". $xml->saveXML() ."</xmp>";

$xml->save("test1.xml") or die("Error"); 
```

我附加 XML 元素的顺序可能是错误的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:07:28.993

接近尾声，你写

```
$thread->appendChild($root); 
```

我认为这是

```
$root->appendChild($thread); 
```

因为您想将 THREAD 节点添加到 ROOT 节点

# jquery - Jquery检查输入字段是否在每个键位上都发生了变化

> ID：15467330
> 
> 赞同：0
> 
> 时间：2013-03-17T23:01:42.610
> 
> 标签：jquery

我有这个 jQuery 脚本，它检查输入字段是否已更改，如果已更改，它会向图标添加一个类（然后更改颜色以让用户知道他们已填写该字段）。

```
$('.input-icon input').change(function() {
    $(this).next(".icon").addClass('complete');
}); 
```

它仅在文本输入后取消选择相关字段时才有效。我需要的是每次按下一个键时运行它并相应地更新。

多谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:04:51.437

见 [http://api.jquery.com/keyup/](http://api.jquery.com/keyup/)

```
$('.input-icon input').on('keyup',function() {
    // check if input has something in it
    $(this).next(".icon").addClass('complete');
}); 
```

# [演示](http://jsfiddle.net/ZyfbM/)

# android - 如何通过android模拟器获取当前的经度和纬度

> ID：15467335
> 
> 赞同：1
> 
> 时间：2013-03-17T23:02:00.413
> 
> 标签：android, emulation, latitude-longitude

你好专家我需要帮助我想从模拟器中获取经度和纬度该程序在我的手机上运行但它在模拟器上不起作用我需要在模拟器上获取经度和纬度以进行测试并完成我的项目请帮助和这里是我的代码

# actionscript-3 - 如何使用 Actionscript 3 添加升级屏幕

> ID：15467342
> 
> 赞同：0
> 
> 时间：2013-03-17T23:02:47.493
> 
> 标签：actionscript-3, flash, actionscript, action

好吧，我有一个射击游戏，它可以正常工作，但我想添加一个升级屏幕以获得更好的武器。谁能给我一个方向，甚至可以为我写一些代码。？

所以在玩家杀死 50 个敌人后，他的分数会显示出来，然后从我想带他到升级屏幕，如果他买了东西就从那里升级它并带他进入下一个级别.. 我知道我可能不会给详细信息，但请帮助我并告诉我是否需要更多详细信息。

在动作脚本 3 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:22:57.293

在此站点上，用户可以回答其他用户的技术问题。如果您需要程序员为您编写代码，则必须找到提供该服务的站点之一。

您所描述的大致如下。或许以这种伪代码的方式进行布局会对您有所帮助。如果您对此处的某事或我未在此处代表的某事有技术问题，请随时修改您的问题。

```
// This is JavaScript syntax. It may be different from ActionScript.
// At this early stage it doesn't really matter.

function play_a_game() {
    while (!game_over) {
        // Let the player play.
        // Game events happen.
        player_kills_enemy();
        // More game events happen.
    }
}

function player_kills_enemy() {
    increment_kill_count();
    if (get_kill_count() >= 50) {
        offer_upgrade();
        set_kill_count(0);
    }
}

function offer_upgrade() {
    // Display stuff and get the player's choice.
    if (bought_something) {
        replace_weapon();
        increment_level();
    }
} 
```

# javascript - 使用 ajax 响应在 jQuery Mobile 中手动加载页面

> ID：15467345
> 
> 赞同：1
> 
> 时间：2013-03-17T23:03:00.570
> 
> 标签：javascript, jquery, jquery-mobile

我有一个表单提交，由于某种原因我无法使用普通的 jQuery 移动 ajax 提交来提交。我有类似的东西：

```
$('form[name="myForm"]').submit(function(e){
    var self = $(this)
    if ( validatefunction( self )  ) {
        e.preventDefault();
        $.post(self.attr('action'), self.serialize(), function (response) {
            // Here I would load the server response as a page
        });
    }
}); 
```

关键是我不知道如何使用服务器响应在 jQuery mobile 中加载新页面。

# visual-studio-2012 - 在 VS2012 中无法更改 LESS 突出显示颜色

> ID：15467347
> 
> 赞同：1
> 
> 时间：2013-03-17T23:03:14.500
> 
> 标签：visual-studio-2012, less, syntax-highlighting

**问题：**我正在使用 VS2012 Dark 主题，我无法读取标准颜色的 LESS 语法，所以我想更改它们，但是当我去`tools`-> `options...`-> `environment`-> `fonts and colors`->`Text editor`在列表中时，我看不到 LESS 选项.

**脚步：**

1.  安装VS2012
2.  网络要点 2012
3.  视觉工作室 SP 1
4.  ASP.NET 网络工具 2012.2
5.  重启电脑

我已经这样做了 6 到 7 次，从来没有遇到过这样的问题。我需要重新安装整个视觉工作室吗？

## 解决方案

安装了 Visual Studio 2012 颜色和主题编辑器扩展，并出现了 LESS 选项。

# php - jsoncallback 应该在哪里？

> ID：15467348
> 
> 赞同：0
> 
> 时间：2013-03-17T23:03:15.930
> 
> 标签：php, javascript, json, cordova

```
function start(){

$('#detailsPage').live('pageshow', function(event) {
    var user_name = getUrlVars()["user_name"];
    //var user_name = "studentB";
    $.getJSON('http://mydomain.com/getStudent.php?user_name='+user_name+'&jsoncallback=?', displayStudent);
});
} 
```

上面是js，下面是php

```
<?php 

header("Cache-Control: no-cache, must-revalidate");
header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");
header("Content-type: application/json");

include('mysqlConfig.php');

$user_name = $_GET["user_name"];

$sql="SELECT * FROM tbl_user WHERE user_name='$user_name'";
$result=mysql_query($sql);

$rows = array();

//retrieve and print every record
while($r = mysql_fetch_assoc($result)){
    // $rows[] = $r; has the same effect, without the superfluous data attribute
    $rows[] = array('data' => $r);
}

// now all the rows have been fetched, it can be encoded
//echo json_encode($rows);

$data = json_encode($rows);
echo $_GET['jsoncallback'] . '(' . $data . ');';
?> 
```

我想知道这种方法是否有效？在我的应用程序中，第 n 个是显示。我不确定 jsoncallback 值是否被错误地实现。您的意见将有很大帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:08:52.310

回调函数应采用三个参数：

数据，文本状态，jqXHR

其中 data 是 php 页面返回的内容。

所以你的JS应该是：

```
function start(){

    $('#detailsPage').live('pageshow', function(event) {
        var user_name = getUrlVars()["user_name"];
        //var user_name = "studentB";
        $.getJSON('http://mydomain.com/getStudent.php?user_name='+user_name, displayStudent);
    });
}

function displayStudent (data, textStatus, jqXHR) {
    // data will be the json encoded $rows data from your php file 
    // ... do stuff here
} 
```

你 PHP，我想（我已经有 12 年没用过 PHP 了……），只需要：

```
<?php 

header("Cache-Control: no-cache, must-revalidate");
header("Expires: Sat, 26 Jul 1997 05:00:00 GMT");    
header("Content-type: application/json");

include('mysqlConfig.php');

$user_name = $_GET["user_name"];

$sql="SELECT * FROM tbl_user WHERE user_name='$user_name'";
$result=mysql_query($sql);

$rows = array();

//retrieve and print every record
while($r = mysql_fetch_assoc($result)){
    // $rows[] = $r; has the same effect, without the superfluous data attribute
    $rows[] = array('data' => $r);
}

// now all the rows have been fetched, it can be encoded

echo json_encode($rows);
?> 
```

# postgresql - 自定义 Heroku 数据库备份

> ID：15467351
> 
> 赞同：0
> 
> 时间：2013-03-17T23:03:33.780
> 
> 标签：postgresql, heroku

我在 Heroku 应用程序上使用 PG Backups 插件，但我想安排更多的数据库备份并将它们上传到我自己的 AWS S3 帐户。

我怎样才能从 rake 任务中做到这一点？我曾尝试使用该`pg_dump`命令，但它在 heroku 服务器上不可用。

我也尝试使用`heroku pgbackups:capture`这样我可以获得最新的 URL，然后上传它，但该`heroku`命令在服务器上也不可用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T01:22:58.703

在您用于将数据推送到 S3 的 EC2 服务器上安装`pg_dump`或工具。`heroku`您可以使用`pg_dump`通过 SSL 保护的 PostgreSQL 数据库连接远程连接到 Heroku 机器，或者您可以使用`heroku`命令来执行此操作。

# javascript - 即使省略号也如何获得行

> ID：15467353
> 
> 赞同：1
> 
> 时间：2013-03-17T23:03:36.913
> 
> 标签：javascript, jquery, youtube-api, thumbnails

我怎样才能使每个缩略图即使是下一个等等，并且在每个达到最大值后文本/标题都会变成省略号。行/列的宽度/高度。这是[站点](http://netx.clanteam.com/test7.html)，这是需要转换的代码。

```
 <script>
$(document).ready(function(){
    $("button").click(function(){
        $("body").append("<div id = 'data'><ul>jffnfjnkj</ul></div>");
        var dataContainer = $("#data ul");
        $.ajax({
            url:'http://gdata.youtube.com/feeds/api/users/sony/uploads?alt=jsonc&v=2&callback=?',
            dataType: "jsonp",
            timeout: 5000,
            success: function(data){

                     $.each(data.data.items, 
                               function(i, val) {

                                 if (typeof(val.player) !== 'undefined' && typeof(val.title) !== 'undefined') {
                                    dataContainer.append('<div style="float:left;width:150px;height:150px;overflow:none;text-overflow:ellipsis"><a href='+val.player["default"]+' target="_blank">'+val.title+'</a><br /><img src="'+val.thumbnail.sqDefault+'" width="120" height="90" alt="'+val.title+'"/><br />Views '+val.viewCount+'</div>');
                                 }
                         });
                    }
                });
            });
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:30:44.503

当您尝试省略多行时（在本例中为 2），我过去发现`text-overflow`它不起作用，这仅适用于单行文本。

在这种情况下，我使用了非常方便且易于使用的[DotDotDot jQuery 插件。](http://dotdotdot.frebsite.nl/)

在您的情况下，我看到您的多行作为锚标签，因此您可以使用 CSS 为您的可见区域设置固定的宽度和高度，如下所示..

```
a {width:150px; height:40px;} 
```

并以 JS 作为一个非常基本的例子，它将是......

```
$("a").dotdotdot({ellipsis:'...'}); 
```

请看这个基本的工作[小提琴](http://jsfiddle.net/cpvaW/1/)。

抱歉，我找不到链接的 JS 文件，所以我不得不在小提琴中包含插件......实际代码在底部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:32:50.437

您可以使用 CSS 来做到这一点，尽管只能使用较新的浏览器：

```
text-overflow: ellipsis 
```

[http://davidwalsh.name/css-省略号](http://davidwalsh.name/css-ellipsis)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T23:10:13.000

添加`white-space: nowrap`到 div 样式

[例子](http://jsfiddle.net/E7P6W/)

# ruby-on-rails - 使用 Omniauth-Facebook 提示用户名

> ID：15467355
> 
> 赞同：0
> 
> 时间：2013-03-17T23:03:46.303
> 
> 标签：ruby-on-rails, facebook, devise, omniauth

我正在将 Devise 与我的 Rails 应用程序一起使用，并且正在考虑使用[Omniauth-Facbook gem](https://github.com/mkdynamic/omniauth-facebook)。我的应用程序具有按用户名显示用户的视图。我无法弄清楚的是如何在执行此操作时提示用户输入用户名。

我知道如果用户创建了 FB 用户名，我可以从 Facebook 请求。许多人没有为他们的 FB 帐户指定用户名，所以这似乎不是最好的方法。我已经阅读了其他答案，这些答案表明也许应该使用电子邮件，如果用户名仅用于登录，这将有效，但如果用户名将显示在用户视图上，这显然不是一个好主意。

如果有人可以提供有关如何在通过 Omniauth-Facebook 注册某人时最好地提示或获取用户名的指导，那将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:08:17.753

当您注册facebook时，请检查他们是否在facebook中有用户名，如果没有，则只需重定向到您的路径以更新用户名？

# asp.net-mvc - 如何避免在 MVC4 中使用 ViewBag 在控制器和视图之间传递查询值

> ID：15467356
> 
> 赞同：2
> 
> 时间：2013-03-17T23:03:47.943
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4

我已经读到[使用 ViewBags 通常是一种不好的做法，](https://stackoverflow.com/a/13779319/96505)并且混合 ViewBag 和 ViewModels 也不好，但是我使用一些 ViewBags`sort order`在我的控制器和视图之间传递参数，尽管我可以在`ViewModel`视图上创建属性我在我首先创建模型之前需要这些值，所以看不到如何解决这个问题。

**控制器**

```
public ActionResult Index(string sortOrder, string searchString, 
                          string currentFilter, int? page, 
                          bool? includeComplete)
{

 ViewBag.CurrentSort = sortOrder;
 ViewBag.NameSortParam = string.IsNullOrWhiteSpace(sortOrder) ? "Name desc" : "";
 ViewBag.DateSortParam = sortOrder == "Date" ? "Date desc" : "Date";

 if (Request.HttpMethod == "GET")
     searchString = currentFilter;
 else
     page = 1;

 ViewBag.CurrentFilter = searchString;
 bool showCompleted = (includeComplete == null || includeComplete == false)
                        ? false : true;
 ViewBag.IncludeCompleted = showCompleted;

 int pageNumber = (page ?? 1);

 var query = Session.QueryOver<ToDo>();

 if (!string.IsNullOrWhiteSpace(searchString))
     query = query.WhereRestrictionOn(td => td.TaskName)
                      .IsInsensitiveLike(string.Format("%{0}%", searchString));

 if (!showCompleted)
     query.And(td => td.IsComplete == false);

 switch (sortOrder)
 {
    case "Name desc":
      query = query.OrderBy(td => td.TaskName).Desc;
      break;
        case "Date":
      query = query.OrderBy(td => td.DueDate).Asc;
      break;
    case "Date desc":
      query = query.OrderBy(td => td.DueDate).Desc;
      break;
    default:
      query = query.OrderBy(td => td.TaskName).Asc;
      break;
 }

 var result = query.Fetch(p=>p.Priority).Eager
           .Fetch(s=>s.Staff).Eager
           .List();

 var viewModel = AutoMapper.Mapper.Map<IEnumerable<ToDo>, 
                     IEnumerable<IndexToDoViewModel>>(result)
                     .ToPagedList(pageNumber, PageSize);
 return View(viewModel); 
```

}

然后在我看来，我将使用 ViewBag 将值传递回控制器，例如`sortOrder`在我可以将其应用到构成方法主体的查询中之前我需要拥有的值`NHibernate`，例如：

```
@Html.ActionLink("Name", "Index", new {sortOrder=ViewBag.NameSortParam, 
                                      includeComplete = ViewBag.IncludeCompleted}) 
```

**我的视图模型**

```
public class IndexToDoViewModel
{
    [DataType(DataType.Date)]
    [DisplayFormat(DataFormatString = "{0:dd MMM yyyy}")]
    [DisplayName("Date Due")]
    public DateTime? DueDate { get; set; }

    public Guid Id { get; set; }

    [DisplayName("Is Complete")]
    public bool IsComplete { get; set; }

    [DataType(DataType.MultilineText)]
    public String Notes { get; set; }

    public string Priority { get; set; }

    public string Staff {get; set;}

    [DisplayName("Name")]
    public String TaskName { get; set; }

    // These would potentially replace my ViewBag?
    public string CurrentSort { get; set; }
    public string CurrentFilter { get; set; }
    public string NameSortParam { get; set; }
    public string DateSortParam { get; set; }
    public bool IncludeCompleted { get; set; }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:25:13.057

> 然后在我看来，我将使用 ViewBag 将值传递回控制器

不，您正在将值传递给*下一个*控制器。当控制器的新实例将处理请求时，这些值将（可能）在浏览器往返后使用。

由于您没有将任何内容传递回*当前*控制器，因此无需使用`ViewBag`. 如果您愿意，可以将值放入模型中。

* * *

即使您将数据从视图发送到控制器（这是非常不寻常的），使用模型仍然可以实现。例子：

```
MyModel viewModel = new MyModel();
ActionResult result = View(viewModel);

// here you can access anything that the view would put in the model

return result; 
```

当然，您不能使用控制器中视图的任何值来创建模型，因为您必须在视图之前创建模型。如果您需要视图中的任何数据来为其获取数据，您可以将其作为方法放在模型中而不是控制器中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:08:59.770

我建议为您创建的每个视图创建一个 ViewModel，因为您很可能需要将更多信息传递给您的视图。

在这种情况下，您将拥有一个具有分页列表数据属性的 ViewModel，并且您可以为 SortOrder 添加另一个属性。

例如：

```
public class MyViewModel
{
    public IEnumerable<ToDo> TodoList { get; set; }
    public string SortOrder { get; set; }
} 
```

请参阅 SO 问题：[ViewModel 最佳实践](https://stackoverflow.com/questions/664205/viewmodel-best-practices)

# php - php 中 substr 和 mkdir 函数的奇怪结果

> ID：15467358
> 
> 赞同：0
> 
> 时间：2013-03-17T23:03:57.303
> 
> 标签：php, file-upload, substr, mkdir

我有一个用 php 上传的文件，但这无关紧要，因为我真正的问题是我有这个代码：

```
if (!empty($_FILES)) {
    $tempFile = $_FILES['Filedata']['tmp_name'];
$real = $_FILES['Filedata']['name'];
$finfo = pathinfo($real);
$time = time();
$rand1 = substr(sha1($real.$time),0,4);
$rand2 = substr(sha1($real.$time),5,-22);
$fname = preg_replace("#[^A-Za-z1-9]#","_", $_FILES['Filedata']['name']);
mkdir(UPLOAD_TO."/".$rand2,0777);
$targetFile = UPLOAD_TO."/".$rand2."/".$real;
            move_uploaded_file($tempFile,$targetFile);
   $query = $db->prepare("INSERT INTO files (realname,filename,extension,filesize,rand1,rand2,uppedby,created) VALUES(:real,:filename,:extension,:filesize,:rand1,:rand2,:uppedby,:created)");
$query->execute(array(
":real" => $real,
":filename" => $fname,
":extension" => $finfo['extension'],
":filesize" => filesize($tempFile),
":rand1" => $rand1,
":rand2" => $rand2,
":uppedby" => $_SERVER['REMOTE_ADDR'],
":created" => time()
));

} 
```

文件已上传，我正在从实际时间戳和真实文件名创建一个 sha1 哈希。在我切割它们之后，`substr()`但有一个棘手的部分。mkdir 不是用剪切的字符串而是用另一种奇怪的组合创建目录。我不知道我做错了什么。你能看一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:10:41.567

`$rand2 = sha1(sha1($real.$time),0,4);`

这应该是`$rand2 = substr(sha1($real.$time),0,4);`#RAND2

请删除`$do = ;`

> ```
> Under "dev mod" an error would show up:
> 
> Warning: sha1() expects at most 2 parameters, 3 given 
> ```

只是你有一个错字或类似的东西

**我用这样的代码快速检查了我的本地服务器，它可以工作**

```
<?php
DEFINE('UPLOAD_TO',"C:/env/php/www/tests/");
if (!empty($_FILES))
{
    $tempFile = $_FILES['Filedata']['tmp_name'];
    $real = $_FILES['Filedata']['name'];
    $finfo = pathinfo($real);
    $time = time();
    $rand1 = substr(sha1($real.$time),0,4);
    $rand2 = substr(sha1($real.$time),5,-22);
    $fname = preg_replace("#[^A-Za-z1-9]#","_", $_FILES['Filedata']['name']);
    mkdir(UPLOAD_TO."/".$rand2,0777);
    $targetFile = UPLOAD_TO."/".$rand2."/".$real;
    move_uploaded_file($tempFile,$targetFile);
}
?>
<form method="POST" enctype="multipart/form-data" action="">
    <input type="file" name="Filedata" />
    <input type="submit" />
</form> 
```

你可以检查一下，但问题是你的`sha1`功能应该被替换为`substr`

**更新 2**

由于您的文件夹名称有问题并且对其名称不满意，您可以尝试更改`$rand2 = substr(sha1($real.$time),5,-22);`为`$rand2 = substr(sha1($real.$time),1,5);`

阅读[php.net substr](http://php.net/substr)上的 substr 手册并满足您的需要，顺便说一句，它非常基础。

substr 的三个参数是`$STRING, $START and $LENGTH which is optional`。摘录`php.net`可能会为您清除一切：

> 如果 start 为非负数，则返回的字符串将从字符串的第 start 位置开始，从零开始计数。例如，在字符串 'abcdef' 中，位置 0 的字符是 'a'，位置 2 的字符是 'c'，等等。

在我看来，下面的部分会让你更加清醒**（注意负面部分）**

> 如果给出了长度并且是正数，则返回的字符串将最多包含从 start 开始的 length 个字符（取决于字符串的长度）。
> 
> > 如果给定长度并且为负数，那么将从字符串末尾省略很多字符（在开始位置为负数时计算开始位置之后）。如果 start 表示此截断的位置或超出该位置，则将返回 false。

# matlab - 在索引 i 处创建 1 的向量的最惯用方法是什么？

> ID：15467359
> 
> 赞同：3
> 
> 时间：2013-03-17T23:04:05.347
> 
> 标签：matlab, vector

在 Matlab 中，假设我想创建一个长度为 0 的向量`L`，但 index 处的 1 除外`i`？

例如，类似：

```
>> mostlyzeros(6, 3)

ans =

     0     0     1     0     0     0 
```

目的是我可以将它用作“选择”向量，我将按元素与另一个向量相乘。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-17T23:39:49.857

我能想到的最简单的方法是：

```
a = (1:N)==m; 
```

其中N>=m。话虽如此，如果您想将结果向量用作“选择向量”，我不知道为什么要将两个向量逐元素相乘，因为我预计这会相对缓慢且效率低下。如果您想获得一个仅包含第 m 个位置的向量 v 的第 m 个值的向量，这将是一种更直接的方法：

```
b = ((1:N)==m)*v(m); 
```

尽管最自然的方法必须是这样：

```
b(N)=0;
b(m)=v(m); 
```

假设在此之前没有定义 b （如果定义了 b ，则需要使用零而不是仅仅将第 N 个值分配为零 - 根据我的经验，创建之前不存在的零向量或矩阵是最容易通过将它的最后一个元素分配为零来完成 - 它对于扩展矩阵或向量也很有用）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T23:08:39.517

我很难想到比以下更明智的事情：

```
Vec = zeros(1, L);
Vec(i) = 1; 
```

但我很高兴被证明是错误的！

**更新：** @GlenO 提供的单线解决方案非常简洁！但是，请注意，如果效率是主要标准，那么在我的机器上进行的一些速度测试表明，这个答案和其他两个答案中提出的简单方法要快 3 或 4 倍......

**下一个更新：**啊！这就是你所说的“选择向量”。@GlenO 很好地解释了为什么对于这个操作，一个和零的向量不是惯用的 Matlab - 但是你选择构建它。

ps 尽量避免`i`用作下标，因为它实际上是一个[matlab函数](http://www.mathworks.com.au/help/matlab/ref/i.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-18T08:11:02.047

只是为了它的乐趣，另一个单线：

```
function [out] = mostlyzeros(idx, L)
out([L, idx]) = [0 1]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-17T23:08:49.447

我能想到：

```
function mostlyones(m,n)

mat=zeros(1,m);
mat(n)=1; 
```

另外，要注意一件事。在 MATLAB 中，索引从 1 开始，而不是从 0 开始。所以你的函数调用应该是`mostlyzeros(6,3)`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-17T23:09:59.703

我会简单地创建一个零向量并将您喜欢的任何值更改为一个：

```
function zeroWithOne(int numOfZeros, int pos)
a = zeros(numOfZeros,1);
a(pos) = 1; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-18T13:30:29.637

另一个应该很快的单行选项是：

`vec = sparse(1, ii, 1, 1, L);`

# ios - iOS-sharekit-设置facebook

> ID：15467365
> 
> 赞同：-2
> 
> 时间：2013-03-17T23:04:40.080
> 
> 标签：ios, settings, sharekit

我有一个 sharekit 实现，一切正常，但是如果没有为 facebook 设置帐户，则在按下设置按钮后，操作表将被关闭，用户返回到应用程序，而不是系统首选项中的设置页面。

如何获取设置按钮以将用户发送到设置页面？

我用来初始化操作表的代码：

```
NSURL *url = [NSURL URLWithString:@"http://test"];
SHKItem *item = [SHKItem URL:url title:@"test"];

SHKActionSheet *actionSheet = [SHKActionSheet actionSheetForItem:item];

// Display the action sheet
[actionSheet showFromTabBar:self.tabBarController.tabBar]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T01:14:26.233

这是ShareKit的一个[已知的、未解决的问题。](https://github.com/ideashower/ShareKit/issues/376)[你可以提交一个拉取请求来修复它，或者通过检查SLComposeViewController](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Reference/SLComposeViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40012205)来解决它：

```
if([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) {
    // show ShareKit
} else {
    // tell them to get Facebook
} 
```

在显示 ShareKit 之前。当然，这会让没有 Facebook 的用户（比如只有 Twitter 的人）无法使用 ShareKit。另一方面，您可以切换到 Apple 的 Share Sheets，或者自己编写，但这些也有其缺点。有点像第22条。

# android - 我怎样才能使一个身体有时不会与其他身体发生碰撞？

> ID：15467367
> 
> 赞同：0
> 
> 时间：2013-03-17T23:04:48.023
> 
> 标签：android, box2d, andengine

我怎样才能使一个身体有时不会与其他身体发生碰撞？我有这个物体，我希望它与所有物体发生碰撞，除非我指定它应该与没有物体发生碰撞。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T13:00:23.660

碰撞过滤是一种可行的方法，尤其是出于您的目的，因为您可以在运行时为某些固定装置设置过滤器，以便随时启用或禁用碰撞检测。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T04:20:43.133

您可以将 isSenor() 设置为 true

bodyDef.isSensor = true;

“当您想知道物体何时会发生碰撞而不触发碰撞响应时，请将 isSensor() 设置为 true。”

# jquery - SignalR 1.0.1 与 Chrome 的跨域请求 (CORS)

> ID：15467373
> 
> 赞同：7
> 
> 时间：2013-03-17T23:05:18.287
> 
> 标签：jquery, asp.net-mvc, google-chrome, signalr, cors

我正在尝试使用 SignalR 1.0.1 和 Chrome（版本 25.0.1364.172）实现跨域调用。因为我在一个主机（localhost：16881）中有我的用户界面，而在另一台主机（localhost：16901）中有“服务”。

我已经准备好了主题[如何使用 SignalR 的跨域连接（CORS - 访问控制允许来源）](https://stackoverflow.com/questions/9984534/signalr-cross-domain-connections-cors-access-control-allow-origin-issues)

```
 add jQuery.support.cors = true; before opening a connection
set up $.connection.hub.url = 'http://localhost:16901/signalr';, pointing to your subdomain

allow cross-domain requests on server side, by adding the following header description:

<add name="Access-Control-Allow-Origin" value="http://localhost:16881" />

inside system.WebServer/httpProtocol/customHeaders section in Web.config file. 
```

我还为 SignalR 1.0.1 的 global.asax 中的路由映射设置了 HubConfiguration

```
 RouteTable.Routes.MapHubs(new HubConfiguration()
            {
                EnableCrossDomain = true
            }); 
```

在 IE10 和 FF22 中一切看起来都很好。但是在 Chrome 中，当 SignalR 尝试握手时，它给了我一个错误。

```
XMLHttpRequest cannot load http://localhost:16901/signalr/negotiate?_=1363560032589\. Origin http://localhost:16881 is not allowed by Access-Control-Allow-Origin. 
```

我知道我可以通过使用 --disable-web-security 启动它来使其与 Chrome 一起使用，但它并不真正符合我的要求。请帮忙！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-17T23:24:01.720

这是您需要做的：

1.  删除 jQuery.support.cors = true
2.  消除`<add name="Access-Control-Allow-Origin" value="http://localhost:16881" />`

然后它应该可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-19T19:02:57.537

你不需要使用

> jQuery.support.cors = true;

相反，您可以在 Configuration 方法的 Startup 类上启用 CORS 支持。下面是一些例子：

```
 // Branch the pipeline here for requests that start with "/signalr"
        app.Map("/signalr", map =>
        {
            // Setup the CORS middleware to run before SignalR.
            // By default this will allow all origins. You can 
            // configure the set of origins and/or http verbs by
            // providing a cors options with a different policy.
            map.UseCors(CorsOptions.AllowAll);
            var hubConfiguration = new HubConfiguration 
            {
                // You can enable JSONP by uncommenting line below.
                // JSONP requests are insecure but some older browsers (and some
                // versions of IE) require JSONP to work cross domain
                // EnableJSONP = true
            };
            // Run the SignalR pipeline. We're not using MapSignalR
            // since this branch already runs under the "/signalr"
            // path.
            map.RunSignalR(hubConfiguration);
        }); 
```

# android - 如何编辑片段并保存其状态？

> ID：15467377
> 
> 赞同：0
> 
> 时间：2013-03-17T23:05:29.937
> 
> 标签：android, fragment, android-fragmentactivity, fragmentpageradapter

当我单击按钮（按钮添加）时，我必须在*片段*（Details()）中添加*TextViews*和*EditTexts 。*我能够插入它们，但是当我滑动我的 6 个片段并在第一个片段中返回时，这些项目消失了。

 *有人能帮我吗？

**片段活动类：**

```
public class SubActivityTab extends FragmentActivity
{
    SectionsPagerAdapter spa;
    ViewPager vp;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.scrolltab_layout);

       spa = new SectionsPagerAdapter(getSupportFragmentManager(), this);

       vp = (ViewPager) findViewById(R.id.pager);
       vp.setAdapter(spa);
    }
} 
```

**FragmentPagerAdapter 类：**

```
public class SectionsPagerAdapter extends FragmentPagerAdapter 
{   
    Context c;

    public SectionsPagerAdapter(FragmentManager fm, Context c) {
      super(fm);
      this.c = c;
    }

    @Override
    public Fragment getItem(int position) {
      switch(position)
      {
           case 0: 
           return Details.newInstance();
           ...
      }
      return null;
    }

    @Override
    public int getCount() {
    return 6;
    }

    @Override
    public CharSequence getPageTitle(int position) {
      Locale l = Locale.getDefault();
      switch (position) 
      {
         case 0:
        return c.getString(R.string.tab1).toUpperCase(l);
                 ...
      }
      return null;
   }    
} 
```

**片段类：**

```
public final class Details extends Fragment {

    public static View layout;
    public static LinearLayout ll;

    public static Details newInstance()
    {       
      return new Details();
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
    {
       super.onCreateView(inflater, container, savedInstanceState);

       layout = inflater.inflate(R.layout.details, container, false);
       ll = (LinearLayout) layout.findViewById(R.id.linearlayout2);
       Button add = (Button) layout.findViewById(R.id.button_add);

       add.setOnClickListener(new OnClickListener(){

       @Override
       public void onClick(View v) {

       insertLine();
       insertClassEditText();
       insertLevel();
       }});

       return layout;
    }

    private void insertLine()
    { 
      View temp = (View) layout.findViewById(R.id.line);
      View v = new View(temp.getContext());
      v.setBackgroundColor(Color.rgb(209, 209, 209));
      v.setId(0);
      v.setLayoutParams(temp.getLayoutParams());
      ll.addView(v);

    }

    private void insertClassEditText()
    {
      TextView label_classe = (TextView) layout.findViewById(R.id.textView10);
      EditText edit_classe = (EditText) layout.findViewById(R.id.editText9);

      TextView new_label_classe = new TextView(label_classe.getContext()); 
      EditText new_edit_classe = new EditText(edit_classe.getContext());

      new_label_classe.setId(1);
      new_edit_classe.setId(2);

      new_label_classe.setText("Label");
      new_label_classe.setTextAppearance(new_label_classe.getContext(), android.R.style.TextAppearance_Medium);
      ll.addView(new_label_classe);

      new_edit_classe.setInputType(edit_classe.getInputType());
      new_edit_classe.setLayoutParams(edit_classe.getLayoutParams());
      ll.addView(new_edit_classe);

    }

    private void insertLevel()
    {
      TextView label_lv = (TextView) layout.findViewById(R.id.textView11);
      EditText edit_lv = (EditText) layout.findViewById(R.id.editText10);

      TextView new_label_lv = new TextView(label_lv.getContext());
      EditText new_edit_lv = new EditText(edit_lv.getContext());

      new_label_lv.setId(3);
      new_edit_lv.setId(4);

      new_label_lv.setText(label_lv.getText());
      new_label_lv.setTextAppearance(new_label_lv.getContext(), android.R.style.TextAppearance_Medium);
      ll.addView(new_label_lv);

      new_edit_lv.setInputType(edit_lv.getInputType());
      new_edit_lv.setLayoutParams(edit_lv.getLayoutParams());
      ll.addView(new_edit_lv);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:17:38.213

我相信`ViewPager`在您滑动时会回收视图，因此当您返回时，它会从`onCreateView`.

我建议设置一些标签并传递给`onSaveInstanceState`.

```
private void onSaveInstanceState(Bundle b) {
  if (label_classe != null) {
    b.putBoolean("label_classe", true);
  }
} 
```

然后在`onCreateView`你采取`savedInstanceState`，检查创建了哪些元素并重新创建它们。

所以在片段中：

```
 @Override
 public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
  {

    ....
    if (savedInstanceState.getBoolean("label_classe")) {
       insertClassEditText();
    }

    ....
} 
```

可以肯定的是，在活动中：

```
public class SubActivityTab extends FragmentActivity
{
    SectionsPagerAdapter spa;
    ViewPager vp;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
       super.onCreate(savedInstanceState);
       setContentView(R.layout.scrolltab_layout);

       spa = new SectionsPagerAdapter(getSupportFragmentManager(), this);

       vp = (ViewPager) findViewById(R.id.pager);
       vp.setSaveState(true);
       vp.setSaveFromParentEnabled(true);
       vp.setAdapter(spa);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-18T07:35:50.900

尝试将您的`onCreateView`方法更改为：

```
 @Override
 public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState){

    if(layout ==null){
       layout = inflater.inflate(R.layout.details, container, false); //Dont inflate every time.layout saved, data of layout,like EidtText also saved.
    }

    ViewParent parent = mLayout.getParent();
    if(parent!=null){
        ((ViewGroup)parent).removeView(layout);//the view will be add to NoSaveStateFrameLayout after onCreateView,so remove self everytime
    }
    return layout;
} 
```*

# django - Heroku 创建了表，但是当我迁移时，他说没有创建

> ID：15467389
> 
> 赞同：3
> 
> 时间：2013-03-17T23:07:12.620
> 
> 标签：django, deployment, heroku

我在 Heroku 中创建了 syncdb（Python/Django 应用程序），他创建了表 south_migrationhistory，

```
(venv-project)username@username:~/projectapp$ heroku run python manage.py syncdb
Running `python manage.py syncdb` attached to terminal... up, run.5529
Syncing...
Creating tables ...
Creating table auth_permission
Creating table auth_group_permissions
Creating table auth_group
Creating table auth_user_groups
Creating table auth_user_user_permissions
Creating table auth_user
Creating table django_content_type
Creating table django_session
Creating table django_site
Creating table django_admin_log
Creating table south_migrationhistory 
```

(...)

```
Synced:
 > django.contrib.auth
 > django.contrib.contenttypes
 > django.contrib.sessions
 > django.contrib.sites
 > django.contrib.messages
 > django.contrib.staticfiles
 > django.contrib.admin
 > south

Not synced (use migrations):
 - core
 - galeria
(use ./manage.py migrate to migrate these) 
```

但是当我迁移应用程序时，他说没有创建该表：

```
(venv-project)username@username:~/projectapp$ heroku run python manage.py migrate core
Running `python manage.py migrate core` attached to terminal... up, run.7542 
```

（......可怕的日志......）

```
File "/app/.heroku/python/lib/python2.7/site-packages/django/db/backends/sqlite3/base.py", line 337, in execute
    return Database.Cursor.execute(self, query, params)
django.db.utils.DatabaseError: no such table: south_migrationhistory 
```

可以是什么？谢谢。

**编辑**：解决了，我输入了 settings_local gitignore，从而识别了数据库 postgres heroku。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-05-13T13:51:59.080

**在 Django 1.9 上测试**

设置.py

```
in_heroku = False
if 'DATABASE_URL' in os.environ:
    in_heroku = True

import dj_database_url
if in_heroku:
    DATABASES = {'default': dj_database_url.config()}
else:
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.sqlite3',
            'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
        }
    } 
```

然后运行：

```
heroku addons:create heroku-postgresql:hobby-dev
sudo apt-get intall postgresql libpq-dev
pip install dj-database-url psycopg2
pip freeze >requirements.txt
git add .
git commit -m 'msg'
git push heroku master
heroku run python manage.py migrate 
```

参考：

*   没有更多了`syncdb`，只是`migrate`：[在 Django 1.9 中我应该使用什么来代替 syncdb？](https://stackoverflow.com/questions/29683494/what-should-i-use-instead-of-syncdb-in-django-1-9)
*   [https://devcenter.heroku.com/articles/deploying-python](https://devcenter.heroku.com/articles/deploying-python)
*   [https://devcenter.heroku.com/articles/heroku-postgresql](https://devcenter.heroku.com/articles/heroku-postgresql)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-19T03:55:18.543

**local_settings.py**

```
import os

SITE_ROOT = os.path.dirname(__file__)

DEBUG = True
TEMPLATE_DEBUG = DEBUG

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': os.path.join(SITE_ROOT, 'data.sqlite3'),
    }
} 
```

在您的 gitignore 中，添加以下内容：

```
project_name/local_settings.py
*.sqlite3 
```

# ruby-on-rails - 在 Heroku Cedar Stack (Ruby buildpack) 上带有 image_optim gem 的 libjpeg

> ID：15467390
> 
> 赞同：3
> 
> 时间：2013-03-17T23:07:14.807
> 
> 标签：ruby-on-rails, heroku, libjpeg, libjpeg-turbo

我正在尝试让[image_optim](https://github.com/toy/image_optim) gem 与 Heroku 的 Cedar 堆栈上的 Rails 4 应用程序一起使用，以优化 png/gif/jpeg 图像。

我将所需的二进制文件 ( `advpng`, `gifsicle`, `jpegoptim`, `jpegtran`, `optipng`, `pngcrush`, `pngout`) 放入`/bin`并设置`ENV['PATH'] = "#{Rails.root}/bin:#{ENV['PATH']}"`在初始化程序中。这适用于 gif 和 png，但我遇到了 jpeg 的问题。

在 Rails 控制台中，我得到：

`irb(main):001:0> `jpegoptim``

`jpegoptim: error while loading shared libraries: libjpeg.so.8: cannot open shared object file: No such file or directory`

我应该如何`libjpeg`在 Heroku 上安装？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-21T07:27:35.410

将二进制文件部署到 Heroku 的正确方法是使用 buildpacks： [https ://devcenter.heroku.com/articles/buildpacks](https://devcenter.heroku.com/articles/buildpacks)

如果你想打包多个二进制文件，请使用这个： [https ://github.com/ddollar/heroku-buildpack-multi](https://github.com/ddollar/heroku-buildpack-multi)

已经为各种二进制文件创建了许多构建包，但没有为您列出的那些构建包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-09T09:19:25.007

我创建了一个允许您在 heroku 上运行 image_optim 的 gem：

[https://github.com/mooktakim/image_optim_bin](https://github.com/mooktakim/image_optim_bin)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-18T00:41:15.513

您可能正在寻找这个：[Heroku Image-Optim Buildpack](https://elements.heroku.com/buildpacks/sensedata/image-optim-buildpack)

或者这个：[https ://github.com/bobbus/image-optim-buildpack](https://github.com/bobbus/image-optim-buildpack)

# php - 使用带有希伯来语字符串的 file_get_contents

> ID：15467399
> 
> 赞同：1
> 
> 时间：2013-03-17T23:08:13.600
> 
> 标签：php, url, character-encoding, hebrew

我需要有关该`file_get_contents()`功能的帮助。

当我尝试从包含一些希伯来语字符的 url 中获取数据时，我收到来自主机的错误（无效链接）。

例如：

```
file_get_contents('http://domain.com/page/עברית'); 
```

对我不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:14:44.350

网址不能包含 UTF-8 字符。它们必须首先进行 url 编码。它们可能在您的浏览器中显示为 UTF-8 字符，但这只是您的浏览器让它看起来更漂亮。

```
When a new URI scheme defines a component that represents textual
data consisting of characters from the Universal Character Set [UCS],
the data should first be encoded as octets according to the UTF-8
character encoding [STD63]; then only those octets that do not
correspond to characters in the unreserved set should be percent-
encoded.  For example, the character A would be represented as "A",
the character LATIN CAPITAL LETTER A WITH GRAVE would be represented
as "%C3%80", and the character KATAKANA LETTER A would be represented
as "%E3%82%A2". 
```

[https://www.rfc-editor.org/rfc/rfc3986#section-2.5](https://www.rfc-editor.org/rfc/rfc3986#section-2.5)

# sql - 将值组合转换为列的 SQL 查询

> ID：15467409
> 
> 赞同：0
> 
> 时间：2013-03-17T23:09:16.367
> 
> 标签：sql, postgresql, crosstab

我有一张这样的桌子：

```
user_id, gender, sent
1        M       100
1        F       120
2        M       20
2        F       30 
```

我想要从上面这样的表：

```
user_id, male_sent, female_sent, total_sent 
1        100        120          220 
2        20         30           50 
```

我缺少（Postgres）SQL foo 来解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:11:31.037

您可以使用带有`CASE`表达式的聚合函数来获取结果：

```
select user_id,
  sum(case when gender = 'M' then sent else 0 end) male_sent,
  sum(case when gender = 'F' then sent else 0 end) female_sent,
  sum(sent) total_sent
from yourtable
group by user_id 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/b1dc6/3)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T23:14:28.233

你用的是什么数据库？

如果您使用的是 SQL Server，则可以执行以下操作：

```
SELECT user_id,sum(case when gender = 'M' then sent else 0 end) as male_sent,
sum(case when gender = 'F' then sent else 0 end) as female_sent,
sum(sent) as total_sent
FROM your_table_name
GROUP BY user_id 
```

# php - 全局错误处理程序

> ID：15467410
> 
> 赞同：0
> 
> 时间：2013-03-17T23:09:18.697
> 
> 标签：php, function, include, global

我制作了一个 php ErrorHandler，它只能通过使用

> include_once("ErrorHandler.php");

这需要添加到每个页面，我想使用错误处理程序，我想知道是否有全局函数。所以我可以告诉服务器/php在每个页面上调用“ErrorHandler.php”，这可能吗，在php的限制范围内？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:12:20.627

您可以使用PHP 的[auto_prepend_file](http://php.net/manual/en/ini.core.php#ini.auto-prepend-file)设置。

# python - 如何通过单击它和使用 Tkinter 的相应按钮在子帧中绘制几何图形

> ID：15467411
> 
> 赞同：0
> 
> 时间：2013-03-17T23:09:22.987
> 
> 标签：python, tkinter

我已经创建了一个框架，但不知道如何在子框架上绘制几何图形。

这是我当前窗口的代码：

```
class App:
    def __init__(self, master):
        frame = Frame(master)
        frame.grid()

        self.Quit = Button(frame, text = "QUIT", command = frame.quit)
        self.Quit.grid(row = 0, column = 48, sticky = N)

        self.adpt = Button(frame, text = "Add Point", command = self.adpt)
        self.adpt.grid(row = 0, column = 49, sticky = N)

        self.adln = Button(frame, text = "Add Line", command = self.adln)
        self.adln.grid(row = 0, column = 50, sticky = N)

        self.adpg = Button(frame, text = "Add Polygon", command = self.adpg)
        self.adpg.grid(row = 0, column = 51, stick = N)

        iframe = Frame(frame, bd = 2, relief = RAISED,  width=1000, height=500)
        iframe.grid(row = 1, columnspan = 100, sticky = N)

    def adpt(self):
        pass

    def adln(self):
        pass

    def adpg(self):
        pass 
```

我需要通过点击相应的按钮来创建各种几何图形，然后在子框架上绘制它，但我不知道如何使用事件在子框架（iframe）中绘制几何图形。例如，要绘制点，请单击“添加点”按钮。然后点击子帧生成一个点。双击子帧将点保存到点列表中。

第一个问题是如何通过单击在子帧上绘制点。

第二个问题是如何使子框架手柄双击和单独单击。当我双击一个小部件时，它首先经过单击事件，然后是双击事件。

我创建了用画布绘制几何图形的类。点、线、多边形类可以用画布绘制几何图形。

以下是点类的示例代码：

```
class Point:
    def __init__(self,x, y):
        self.x = x
        self.y = y
    def __str__(self):
        return " (" + str(self.x) + "," + str(self.y) + ")"
    def draw(self,canvas):
        canvas.create_line(self.x-10,self.y,self.x+10,self.y)
        canvas.create_line(self.x,self.y-10,self.x,self.y+10) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:06:46.530

如果您使用按钮选择几何类型，则可以在其事件处理程序上设置将要使用的类。然后您可以使用事件信息的坐标在画布上绘制项目。

```
self.adln = Button(frame, text = "Add Line", command=self.adln)
self.adpt = Button(frame, text = "Add Point", command=self.adpt)
self.canvas.bind("<Button-1>", self.click)

#...
def adln(self):
    self.geometry = "Line"
def adpt(self):
    self.geometry = "Points"
#...

def click(self, event):
    if self.start is None:
        self.start = (event.x, event.y)
    else:
        self.draw_geometry()
        self.start = None
def draw_geometry(self):
    if self.geometry == "Points":
        p1 = Point(*self.start)
        p2 = Point(event.x, event.y)
        p1.draw(self.canvas)
        p2.draw(self.canvas)
    elif self.geometry == "Line":
        line = Line(event.x, event.y, *self.start)
        line.draw(self.canvas) 
```

请注意构造函数的参数数量和`draw`方法的存在可能与您所拥有的不对应，因为这只是一个示例。这有点*unpythonic*，但这是我出来的最简单的方法。

另一方面，由于事件`<Button-1>`总是在双击时触发，我建议您使用另一个按钮来执行单独的操作，例如`<Button-2>`或`<Button-3>`。

# c++ - C++ cin 只接受数值

> ID：15467412
> 
> 赞同：1
> 
> 时间：2013-03-17T23:09:25.700
> 
> 标签：c++, validation

我编写了这段代码，允许用户选择输入值 1 或 2。除了一个小问题之外，这一切都很好：

如果用户输入诸如“1asdaosd”之类的内容，则输入仅被识别为 1。

我已经尝试使用 isdigit 函数，但我仍然没有设法完成这项工作。

```
`bool validInput;
    do
    {
        cout << "Choose the game type: ";
        cin >> gametype;
        validInput = true;
        if (cin.fail())
        {
            validInput = false;
            cin.clear();
            cin.ignore(std::numeric_limits<int>::max(), '\n');
        }
        if (gametype<1 || gametype>2) {
            validInput = false;
        }
    } while (!validInput);` 
```

预期的行为应该是：

除了“1”或“2”之外的任何东西都不应被视为有效输入，因此会重复循环。发生的事情是“1asdasd”或“2aods”被认为是有效输入，但我希望它失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-05T14:31:21.513

下面是一种基于我在 Stroustrup 的《*编程：使用 C++ 的原理和实践》*的早期章节中阅读的内容以及Duoas 在 cplusplus.com 上提供的[答案的方法。](http://www.cplusplus.com/forum/general/42594/)它定义了一个函数 ,`get_int_between()`允许您执行以下操作：

```
int my_variable;
get_int_between(my_variable, min, max, prompt, error_msg); 
```

这将提示、验证并存储到 my_variable。

只是为了好玩，我还包含了一个函数，`get_int(my_variable, prompt, error_msg)`，它做同样的事情，但允许任何值的整数。

```
#include <iostream>
#include <sstream> // stringstream

void get_int(int& d, std::string prompt, std::string fail);

void get_int_between(int& d, int min, int max, std::string prompt, std::string fail);

int main()
{
    int my_number = 1; // initialize my_number

    get_int(my_number, "Please enter an integer: ", "Sorry, that's not an integer.\n"); 
    //Do something, e.g. 
    std::cout << "You entered: " << my_number << "\n";

    get_int_between(my_number, 1, 2, "Choose the game type (1 or 2): ", "Sorry, that's not an integer.\n");
    //Do something, e.g.:
    std::cout << "Let's play Game " << my_number << "!\n";

    return 0;
}

void get_int(int& d, std::string prompt, std::string fail)
{
    while(1) {

        std::cout << prompt;
        std::string str;
        std::cin >> str;

        std::istringstream ss(str);
        int val1;
        ss >> val1;

        if(!ss.eof()) {
            std::cout << fail;
            continue;
        } else {
            d = val1;
            break;
        }
    }
}

void get_int_between(int& d, int min, int max, std::string prompt, std::string fail)
{
    while(1) {
        get_int(d, prompt, fail);
        if(d > max || d < min) {
            std::cout << "Sorry, your choice is out of range.\n";
            continue;
        }
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:18:56.530

如果要使用字符串，请使用[getline](http://www.cplusplus.com/reference/istream/istream/getline/)。

```
#include <iostream>     // std::cin, std::cout
int main () 
{
char name[256], title[256];

std::cout << "Please, enter your name: ";
std::cin.getline (name,256);

std::cout << "Please, enter your favourite movie: ";
std::cin.getline (title,256);

std::cout << name << "'s favourite movie is " << title;

return 0;
} 
```

如果您将游戏类型设置为*int*，它将仅接受 1 或 2（当然您必须防止其他数字被接受）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T23:12:17.180

这是因为`gametype`是一个整数，所以它试图读取对整数有效的尽可能多的内容。`1asdaosd`不是一个有效的整数，所以它停在`1`. 例如，如果您想完整地阅读该内容，则必须创建`gametype`一个字符串，但是您将无法像以前那样将其与整数进行比较。

如果需要，您可以将其作为字符串读取，并且如果您想同时处理字符串和整数的情况，那么您可以使用类似[`stoi`](http://en.cppreference.com/w/cpp/string/basic_string/stol)尝试将字符串转换为整数的方法。然后捕获`std::invalid_argument`异常，以便您可以知道字符串是否*可以*转换为整数。如果不能，那么您知道将其保留为字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T23:13:04.340

只要输入可以这样解释，它就会读取一个 int 。然后停止。如果你读入一个字符串变量，它会得到它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-17T23:16:01.160

1.  将数据读入字符串变量。
2.  检查数据是否为有效整数。
3.  将字符串转换为整数。

乏味，但这是唯一的方法

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-18T01:03:28.047

我猜你想要每一行都有一个输入值。您需要将其读取为字符串，然后检查您是否得到了超出您要求的内容。如果您需要它作为整数，您可以稍后转换读取的字符串。

我还假设您只需要读取一位数整数。更多的数字需要循环中的字符串到整数的转换以及更多的检查。

```
string gametype;
do
{
    cout << "Choose the game type: ";
    // read one word as string, no conversion, so will not fail (may hit eof though)
    cin >> gametype;
    // ignore rest of line (assuming you want next valid input on next line)
    cin.ignore(std::numeric_limits<int>::max(), '\n');
}
while ( gametype.size() != 1 || gametype.at(0) < '1' || gametype.at(0) > '2') );

// char to int conversion (single digit only)
int gametypeint = gametype.at(0) - '0';

// other way to convert string to int
istringstream iss(gametype);
iss >> gametypeint;

// yet another way (C++11)
gametypeint = stio(gametype); 
```

# r - 将箭头附加到点

> ID：15467415
> 
> 赞同：1
> 
> 时间：2013-03-17T23:10:10.703
> 
> 标签：r, ggplot2

我正在可视化一个 4 维数据集。让我们将变量表示为`x, y1, y2`和`y3`，其中`x`是日期，`y`是一个连续变量并且`y2, y3`是二维向量 的分量`(y2, y3)`。现在我想为`x`and绘制一个线图，另外为at points`y1`附加箭头。`(y2, y3)``(x, y1)`

我试过了

```
ggplot(data=data,aes(x=x,y=y1)) + geom_line() +
      geom_segment(aes(xend=x+y2,yend=y1+y3), arrow = arrow()) 
```

但它效果不佳，所以我想我可能需要做一些重新调整。我该怎么做`ggplot`？

**更新**：我附上了一个[示例数据集](https://www.dropbox.com/s/xsmfbmsyj8rru0p/elnino)（连同它的[列定义](https://www.dropbox.com/s/z3xwm09nkt4s7ka/elnino.col)）。该数据集包含从位于整个赤道太平洋的一系列浮标中获取的海洋学和地表气象读数。预计这些数据将有助于理解和预测厄尔尼诺/南方涛动 (ENSO) 周期（来自[储存库](http://kdd.ics.uci.edu/databases/el_nino/el_nino.html)的描述）。现在，例如，我想`x=day, y1=humidity, y2=zon.winds, y3=mer.winds`用上面描述的符号进行可视化。

**UPDATE2**：例如，我想为一个特定的浮标绘制这个 ![在此处输入图像描述](../Images/cf79df39cdc5ca40e4e2e857c869c525.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-31T11:49:03.917

我无法确定您要显示的内容。据我所知，您的数据集有 50 个浮标，每个浮标每天都会进行一次测量。

```
library(ggplot2)
elnino <- read.table('elnino.txt', col.names=c('buoy','day','latitude','longitude','zon.winds','mer.winds','humidity','air.temp','ss.temp'), as.is=TRUE, na='.')
elnino <- elnino[elnino$humidity > 40,]  # removing a single point that seems to be an outlier.

ggplot(elnino, aes(x=day,y=humidity, group=buoy)) + geom_point()
ggplot(elnino, aes(x=day,y=humidity, group=buoy)) + geom_line() 
```

这给出了这两个结果。 ![在此处输入图像描述](../Images/a126494ce734c892d8571bc6e5ed11ec.png) ![在此处输入图像描述](../Images/f02343ef4af917ebf81c7bca03ee3376.png)

我看不到的是你想如何显示 ''zon.winds'' 和 ''mer.winds'' 变量？我认为这些组合给出了一个向量，但是你想把它们放在哪里？你会得到大约 700 个箭头填充你的情节。

**更新** 在这种情况下，您做对了，您必须使用 geom_segment 并计算 ''x''、''xend''、''y'' 和 ''yend''，请参阅[geom_segment](http://docs.ggplot2.org/0.9.2.1/geom_segment.html)。

```
# We select a single buoy
el <- subset(elnino, buoy==1)

library(grid)
ggplot(el, aes(x=day,y=humidity, group=buoy)) + geom_line() + geom_segment(aes(yend=humidity+zon.winds, xend=day+mer.winds), arrow = arrow(length = unit(0.1,"cm"))) 
```

然而，这看起来不太好，因为 ''zon.winds'' 和 ''mer.winds'' 中的坐标被视为绝对坐标！因此，要使用它们，我们需要对它们进行一些手动转换。我的价值观是绝对任意的。

```
el <- transform(el, zon.winds = zon.winds * -0.3, mer.winds=mer.winds * -0.3) 
```

![在此处输入图像描述](../Images/c65b0298150baba6b61d44778f1988f6.png)

# ruby-on-rails - REST request with oauth gem

> ID：15467418
> 
> 赞同：1
> 
> 时间：2013-03-17T23:10:24.110
> 
> 标签：ruby-on-rails, oauth

I am missing something that should be very easy!

I am using oauth-plugin gem to access jira. I could easily build the consumer part, but now I don't know how to make a rest request.

It says in documentation:

![enter image description here](../Images/529309b2209635246f1e2ef864999b23.png)

The gem's author assumes that it is self-explanatory how to make a get/post-request. But I cannot figure it out.

I've tried to use Net::HTTP as follows:

```
uri = URI.parse('/oauth_consumers/jira/client/rest/api/2/project')
request = Net::HTTP.get(uri,{}) 
```

And I am getting `Connection refused - connect(2)` error.

I thought it could work, if I use current_user and his token (jira in my case):

```
current_user.jira.get('/oauth_consumers/jira/client/rest/api/2/project') 
```

And RoR says that jira doesn't have such a method.

I've tried to search online, but there are very few projects that use oauth-plugin gem.

Thank you in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T22:16:12.383

You are almost right with `current_user.jira.get`.
Just add `client` after jira and change path a little bit:

```
current_user.jira.client.get('/rest/api/2/project') 
```

JiraToken doesn't have `get` method, while AccessToken (`client`) does.

# java - 如何使用 Jackson 处理命名空间重复的 xml 标签

> ID：15467421
> 
> 赞同：4
> 
> 时间：2013-03-17T23:11:04.513
> 
> 标签：java, xml, annotations, jackson

是否可以使用 Jackson 来处理基于名称空间的重复 xml 标签？

下面的代码抛出一个 JsonMappingException ：表示属性“url”的多个字段

```
private final ObjectMapper xmlMapper = new XmlMapper();

private static final String xml =
        "<example xmlns:test='http://test.com/'>" +
            "<test:url>www.namespace.com'</test:url>" +
            "<url>www.url.com'</url>" +
        "</example>";

@Test
public void parseXml() throws Exception {
    Example example = xmlMapper.readValue(xml, Example.class);

    assert example.namespaceUrl.equals("www.namespace.com");
}

public static class Example {

    @JsonProperty("url")
    public String namespaceUrl;

    @JsonProperty("url")
    public String url;

} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T17:33:02.317

目前没有办法做到这一点——您不能使用仅因命名空间而异的属性。这不是基本限制；也就是说，通过更多的工作，它可以得到支持；但这是目前的限制。

# java - Java 在整个树中搜索最小值

> ID：15467433
> 
> 赞同：1
> 
> 时间：2013-03-17T23:12:18.740
> 
> 标签：java, recursion, tree, binary-tree, min

这不是二叉搜索树，不遵循任何严格的规则。

唯一的规则是每个节点都是一个正整数，并且每个节点可以没有孩子、一个左孩子或两个孩子。（不仅仅是一个正确的孩子）。

我想使用递归遍历整个树并返回完成后找到的最小值。

如果您不修改方法的签名或使用除 Math.min() 之外的任何其他方法，我将不胜感激

```
public static int minValue(MyNode n) {
    int root, left, right;
    int min = -1;
    if (n.obj != null) {
        root = (int) n.obj;
        left = minValue(n.left);
        right = minValue(n.right);
        if (left < right)
            min = left;
        else
            min = right;
        if (root < min)
            min = root;
    }
    return min;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:26:01.343

也许问题是对于不存在的孩子，你返回 -1，但后来你不计入这种可能性。您需要从分析中删除 -1：

```
public static int minValue(MyNode n) {
    int root, left, right;
    int min = -1;
    if (n != null) {
        root = (int) n.obj;
        left = minValue(n.left);
        right = minValue(n.right);
        if (left > -1){
            if(right > -1){
                min = Math.min(left, right);
                min = Math.min(root, min);
            }
            else{
                min = Math.min(left, root);
            }
        }
        else{
            min = root;
        }
    }
    return min;
} 
```

# jquery - JQuery：拆分图像并导致拆分在鼠标悬停时消失

> ID：15467439
> 
> 赞同：1
> 
> 时间：2013-03-17T23:12:49.363
> 
> 标签：jquery, css, image

我正在尝试为一个大学项目制作一个拼图网站，而我想到的其中一个拼图让我有点发疯。我想让页面拍摄一张 png 图像，将其拆分为一堆 32 像素 x 34 像素的正方形，并让这些正方形在光标位于它们上方时消失。

这是我想要的粗略图： [粗略图](https://dl.dropbox.com/u/4222914/s%27cool/Web/advwebproj2/Puzzle2Diagram.jpg) （忽略滑块的东西）

我发现的最接近的是[本教程](http://marakana.com/s/post/1175/jquery_puzzle_image_tutorial_plugin_ui)的某个部分，其中图像被分成不同的拼图块，但我似乎无法获取他使用的代码并对其进行返工以完成我需要做的事情。

我知道这可能是愚蠢的复杂和非常情境，但我不认为它应该太难......希望。

编辑：我没有尝试太多，因为我不是一个真正的 jQuery 用户或编码器。到目前为止我使用的东西我几乎不明白，可能不会有太大用处，但我可以发布它。

我制作了一个名为 image_split.js 的 .js 文件，其中包含以下内容：

```
(function($)
{
    $.fn.jSplit=function(options)
{
                var piece=$('<span></span>').addId("curtain" +     this.id.substring(4)).css(
        {
            'width': 32+'px',
            'height': 34+'px',
            'display': 'inline-block',
            'float': 'left',
            'background-image': 'url("images/curtain.png")',
            'background-position': (-32)+'px '+(-34)+'px',
        })
};
})(jQuery); 
```

然后在 HTML 中调用它。

```
<script>            
        $(document).ready(function() {
            $('#actor').jSplit();
        });
</script> 
```

那是为了分割图像。至于让它消失，我有这个：

```
<script type="text/javascript">
      $(document).ready(function() {
          $("div[id^=curtain]").hover(
            function(){
                $("#curtain" + this.id.substring(4)).css({"visibility":"visible"});
            },
            function(){
                $("#curtain" + this.id.substring(4)).css({"visibility":"hidden"});
            }
        );
      });
</script> 
```

我知道它不起作用，我确信所有这些代码都很糟糕，但如果它对你们有帮助，那就更好了，我猜。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:55:23.400

听起来您有些基础，但是如果没有生成的html，很难给出正确的答案，但是我会尽力而为。我已经包含了一个带有示例的 JSFiddle。我不完全确定你是如何添加`<span>`标签的，但是我很懒所以我在 jQuery 中处理它。

[http://jsfiddle.net/vmex151/xvvvy/](http://jsfiddle.net/vmex151/xvvvy/)

这和你正在寻找的东西一样吗？

# jquery - Jquery .append 重写

> ID：15467446
> 
> 赞同：2
> 
> 时间：2013-03-17T23:13:51.267
> 
> 标签：jquery, for-loop, append

我有以下 jQuery 代码（x 为 3，i 为 1，storeid 为 4）：

```
function addNewTableRow(x,i,storeid){
    $('#kds_resultsTable tbody').append('<tr></tr>'); //tr:nth-child('+(i)+')'
    for (var a=1; a<=x; a++) {
        if(a==1){
            $('#kds_resultsTable tbody tr:nth-child('+(i)+')').append($.parseHTML("<td class='"+i+"'></td>"));
        }else{
            $('#kds_resultsTable tbody tr:nth-child('+(i)+')').append($.parseHTML("<td class='"+i+" kds_elementstoreid_"+storeid+"></td>"));
        }
    }
} 
```

但是，如果 x 确实是 3（表明 else 的情况应该被打印两次），那么 HTML 输出是这样的（以单个表格行为例）：

```
<tr>
    <td class="5 kds_elementsstoreid_4"></td>
</tr> 
```

似乎 .append 覆盖了之前在 for 循环中附加的文本，只剩下循环最后一次迭代中生成的 HTML。我本来希望有 3 个`<td></td>`元素，而不仅仅是一个。

在这里使用正确`.append()`的 jQuery 函数，还是应该使用其他不会覆盖我以前的内容的东西？我不确定在不使用`.append()`.

作为参考，我使用的是 jQuery 的最新可用版本（截至 2013 年 15 月 3 日）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:39:45.417

回答你的问题：是的，`.append()`是正确的调用函数。它不应该覆盖以前附加的`<td>`元素。

我看不出你的代码有什么问题。看起来“i”参数应该与新附加行的编号匹配，以便`tr:nth-child(i)`引用该行。

我建议重写此函数以避免使用`tr:nth-child(i)`.

您可以尝试以下方法：

```
function addNewTableRow(x, i, storeid) {
    var $row = $('<tr></tr>');
    for (var a = 1; a <= x; a++) {
        var $cell = $('<td class="' + i + '"></td>');
        if (a > 1) {
            $cell.addClass('kds_elementstoreid_'+ storeid);
        }
        $row.append($cell);
    }
    $('#kds_resultsTable').find('tbody').append($row);
} 
```

注意：我不认为调用 to`$.parseHTML()`是必要的，但它们不是问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:51:09.410

在这里，您忘记了 else 语句中的最后一个单引号。改变这个

```
else{
            $('#kds_resultsTable tbody tr:nth-child('+(i)+')').append($.parseHTML("<td class='"+i+" kds_elementstoreid_"+storeid+"></td>"));
        } 
```

对此

```
else{
            $('#kds_resultsTable tbody tr:nth-child('+(i)+')').append($.parseHTML("<td class='"+i+" kds_elementstoreid_"+storeid+"'></td>"));
        } 
```

[http://jsfiddle.net/Eru5M/7/](http://jsfiddle.net/Eru5M/7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T23:32:45.300

不要使用追加，而是尝试使用 .after();

```
$('#kds_resultsTable tbody').after('<tr></tr>'); //tr:nth-child('+(i)+')'
for (var a=1; a<=x; a++) {
    if(a==1){
        $('#kds_resultsTable tbody tr:nth-child('+(i)+')').append($.parseHTML("<td     class='"+i+"'></td>"));
    }else{
        $('#kds_resultsTable tbody tr:nth-child('+(i)+')').append($.parseHTML("<td class='"+i+" kds_elementstoreid_"+storeid+"></td>"));
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T23:45:37.413

如果你传递 i = 1，它会一直在寻找第一个元素吗？

尝试将其更改为：

```
$('#kds_resultsTable tbody tr:nth-child('+(a)+')') 
```

还

```
 $('#kds_resultsTable tbody tr:nth-child('+(i)+')').append($.parseHTML("<td class='"+i+" kds_elementstoreid_"+storeid+"></td>")); 
```

看起来它缺少一个结束撇号。

# php - Opencart 将尺寸选项添加到搜索结果

> ID：15467448
> 
> 赞同：0
> 
> 时间：2013-03-17T23:13:55.030
> 
> 标签：php, opencart

我想知道是否有人可以解释如何向我的搜索结果（类别、制造）等添加选项。我只需要它们在选择标签中（不需要任何操作）。我尝试了与产品选项类似的代码，但没有奏效。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:26:32.623

找到解决方案：[http ://www.opencartaz.com/opencart/attribute-options-on-category-page.html](http://www.opencartaz.com/opencart/attribute-options-on-category-page.html)

```
<?php foreach ($products[$j]['options'] as $option) { ?>
    <select name="option[<?php echo $option['option_id']; ?>]">
        <?php foreach ($option['option_value'] as $option_value) { ?>
            <option value="<?php echo $option_value['option_value_id']; ?>"><?php echo $option_value['name']; ?></option>
        <?php } ?>
    </select>
<?php } ?> 
```

# python - 自动从 SEC.gov 接收 RSS 提供的 ffile，尽可能小程序，最好在 python 中，有什么建议吗？

> ID：15467449
> 
> 赞同：-1
> 
> 时间：2013-03-17T23:14:01.807
> 
> 标签：python, file, hyperlink, rss

具体来说，我想用尽可能少的代码保留 RSS 在 sec.gov 中发布的所有 xml 文件。任何包裹？工具？方法？

多谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:36:42.523

既然你更喜欢 Python，那么[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)来拯救你！

如果您只想保存纯 XML 文件，则可以使用 curl 等命令行工具：

`curl -O http://www.sec.gov/rss/news/press.xml`

您还可以查看其他 RSS Python 包，例如 feedparser：

[https://pypi.python.org/pypi/feedparser](https://pypi.python.org/pypi/feedparser)

您确实有很多选择，但您需要更具体地说明您尝试过的内容。

# c# - Access和C#之间不同的两个双字段的计算

> ID：15467450
> 
> 赞同：0
> 
> 时间：2013-03-17T23:14:08.643
> 
> 标签：c#

因此，我正在将一个在 Access 中运行多年的应用程序转换为 C#/web 应用程序。它处理一些非常精确的数学，我遇到了计算两个双精度值的问题。

所以在Access中我有以下代码：

```
If Abs(varPartDataLocal(i, 0) - dblX_Star) < dblTemp Then 
```

其中 varPartDataLocal(i, 0) = 1.00000232 （作为字符串存储在数据库中）和 dblX_Star = 1.00000226 （由转换为双精度并除以 2 的两个字符串值计算）以及当我在 Access I 中获得这两个值的 Abs 时得到：

> 5.999999986E-08

而当我在 C# 中执行相同的代码时：

```
if (Math.Abs(Convert.ToDouble(varPartDataLocal[i, 0]) - dblX_Star) < dblTemp) 
```

我结束了我们：

> 6.0000000079441E-08

但是，如果我在 C# 中执行此操作（基本上与上面相同，我只是不将其从字符串转换为双精度）：

```
Math.Abs(1.00000232d - 1.00000226d) 
```

然后我得到

> 5.99999998573963E-08（与我在 Access 中执行此操作时相同）

那么问题是为什么会有差异？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:08:14.197

鉴于无论我如何获得值，下面的代码都会给出相同的答案，我建议您的问题在于 的计算`dblX_Star`，这在您的问题中没有显示。

```
const double dbl1 = 1.00000232d;
const double dbl2 = 1.00000226d;
double rslt1 = dbl1 - dbl2;

const string str1 = "1.00000232";
const string str2 = "1.00000226";

double d1 = double.Parse(str1);
double d2 = double.Parse(str2);

double rslt2 = d1 - d2;

double dd1 = Convert.ToDouble(str1);
double dd2 = Convert.ToDouble(str2);
double rslt3 = dd1 - dd2;

Console.WriteLine("rslt1 = {0}", rslt1);
Console.WriteLine("rslt2 = {0}", rslt2);
Console.WriteLine("rslt3 = {0}", rslt3); 
```

输出是：

```
rslt1 = 5.99999998573963E-08
rslt2 = 5.99999998573963E-08
rslt3 = 5.99999998573963E-08 
```

# android - 查找资源 ID

> ID：15467453
> 
> 赞同：1
> 
> 时间：2013-03-17T23:14:23.327
> 
> 标签：android

在我正在处理的项目中，我尝试将“纹理”加载到图块中。“纹理”只不过是我的 Res 文件夹中的 *.png 文件。告诉我将图像和图块链接在一起的信息来自 SQLite 数据库。那里的问题是我将此信息作为字符串获取（例如 Rock.png）。如何从这个字符串获取资源 id (@drawable/rock)？

我的第一个猜测是编写一个带有巨大案例开关的类，我将它们连接在一起，但后来我得出结论，这将是相当静态的（如果不是完全迟钝的话）。所以一定有更好的方法，但直到现在我一直找不到它......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:18:33.647

您可以通过执行此操作获取资源 ID

```
int resourceID = MainActivity.this.getResources().getIdentifier(img, "drawable",
                     MainActivity.this.getPackageName()); 
```

在哪里

**MainActivity** ==> 您当前的活动
**img** ==> 不带扩展名的视图/drawable 名称，例如 (.png) 和 R.(id/string/color....)
**drawable** ==> “img”
**MainActivity.this 的类型。 getPackageName()** ==> 当前包名

# python - 从列表中删除所有多次出现的项目的最快方法？

> ID：15467458
> 
> 赞同：4
> 
> 时间：2013-03-17T23:15:05.163
> 
> 标签：python

从任意项目列表（在我的示例中为列表列表）中删除所有多个出现项目的最快方法是什么？结果，只有在列表中出现过一次的项目才会显示出来，从而删除所有重复项。

输入：[[1, 2], [1, 3], [1, 4], [1, 2], [1, 4], [1, 2]]

输出：[[1, 3], ]

这个解决方案很慢：

```
output = [item for item in input if input.count(item)==1] 
```

这个解决方案更快：

```
duplicates = []
output = []
for item in input:
    if not item in duplicates:
        if item in output:
            output.remove(item)
            duplicates.append(item)
        else:
           output.append(item) 
```

有没有更好的解决方案，可能是首先对列表进行排序？任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-17T23:18:13.613

如果您不关心保留顺序：

```
from collections import Counter

def only_uniques(seq):
    return [k for k,n in Counter(seq).iteritems() if n == 1] 
```

如果您确实关心保留顺序：

```
from collections import Counter

def only_uniques_ordered(seq):
    counts = Counter(seq)
    return [k for k in seq if counts[k] == 1] 
```

两种算法都能`O(n)`及时运行。

* * *

**编辑：**忘记你有一个列表列表。为了能够散列一个序列，它需要是不可变的，所以你可以这样做：

```
list_of_tuples = [tuple(k) for k in list_of_lists] 
```

然后运行`list_of_tuples`上述函数之一。请注意，您将从其中得到一个元组列表 - 但除非您在此之后再次专门修改序列，否则元组应该同样适用于您的目的。

如果你*确实*需要转换回来，它几乎是一样的：

```
list_of_lists = [list(k) for k in list_of_tuples] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T23:36:29.480

```
a = [[1, 2], [1, 3], [1, 4], [1, 2], [1, 4], [1, 2]]
print list(set(tuple(i) for i in a)) 
```

上面一个班轮完成这项工作。

用户$时间 python foo.py
[(1, 2), (1, 3), (1, 4)]

真实 0m0.037s
用户 0m0.024s
系统 0m0.010s

仅打印发问者要求的独特项目。解决方案是 Amber 解决方案的一个变体，只是我没有使用集合模块。

```
a = [[1, 2], [3, 4], [1, 3], [1, 4], [1, 2], [1, 4], [1, 2]]
d = {tuple(i): a.count(i) for i in a}
print [k for k, v in d.iteritems() if v == 1] 
```

**输出：**

```
[(1, 3), (3, 4)] 
```

# java - 在 JFrame(Panel) 中加载 .Jar Applet

> ID：15467459
> 
> 赞同：0
> 
> 时间：2013-03-17T23:15:17.690
> 
> 标签：java, swing, applet, jframe

我正在尝试为我最喜欢的 Java 游戏之一制作一个 JFrameable“加载器”，但我不知道如何将实际的 .Jar 加载到`JFrame`面板中（有人告诉我这被称为 Applet，我猜我落后了一点点）

我已经`JFrame`设置了面板和我想要的所有东西，但我不知道如何去加载 .jar 并向它发送参数并告诉它我想要它在哪里。

任何帮助或链接将不胜感激......因为我找不到任何东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T01:32:28.660

由于您没有提供正在使用的站点，我将仅解释一些部分。

首先，您需要下载游戏 .JAR 文件或使其可访问。

其次，您需要了解通常称为“main.class”的主类。

第三，您需要类似于下面的代码来加载 .jar 文件的主文件。再次将“main.class”变量更改为实际的“.class”。

```
URL url[] = { 
    new File(directory.concat("/gamepack.jar")).toURI().toURL() 
};

URLClassLoader classLoader = new URLClassLoader(url);
applet = (Applet)classLoader.loadClass("main").newInstance(); 
applet.setBounds(0, 0, width, height);

applet.setBackground(Color.BLACK);
applet.setStub(stub);

applet.init();
applet.start();

mainFrame.getContentPane().add(applet); 
```

您会注意到方法“applet.setStub(stub)”。您需要创建一个 AppletStub 类。与以下类似的操作就足够了。

```
package com;

import java.util.Map;
import java.util.HashMap;
import java.net.URL;
import java.applet.AppletStub;
import java.applet.AppletContext;

public class AppletEnvironment implements AppletStub
{
private final Map<String, String> PARAMETERS = new HashMap<String, String>();
private final URL URLBASE;

public AppletEnvironment(final URL URLBASE)
{
    this.URLBASE = URLBASE;
}

public boolean put(String key, String param)
{
    if (PARAMETERS.containsKey(key))
        return false;
    PARAMETERS.put(key, param);
    return true;
}

@Override
public String getParameter(String name) 
{
    return PARAMETERS.get(name);
}

@Override
public URL getCodeBase() 
{
    return URLBASE;
}

@Override
public URL getDocumentBase() 
{
    return URLBASE;
}

@Override
public boolean isActive() 
{
    return true;
}

@Override
public AppletContext getAppletContext()
{
    return null;
}

@Override
public void appletResize(int width, int height) 
{

}
} 
```

现在要使该课程正常工作，您将需要以下内容。因此，您可以创建“存根”变量。

```
AppletEnvironment stub = new AppletEnvironment(url); 
```

您会注意到 AppletEnvironment 类有一个方法“put(String key, String param)”。这必须正确完成。当您解析网站时，您会发现有用于生成客户端的客户端参数。如果没有找到，那么您可以忽略它。如果你想看看需要什么。

然后在“getParameter(String name);”中添加如下代码 方法。

```
System.out.println(name); 
```

# r - 如何在R中绘制双变量法线轮廓

> ID：15467460
> 
> 赞同：1
> 
> 时间：2013-03-17T23:15:21.377
> 
> 标签：r

给定二元正态分布的均值 (mu) 和协方差矩阵 (sigma)，如何在 R 中绘制精确的等高线？谢谢！

# python - Python中的模运算

> ID：15467461
> 
> 赞同：1
> 
> 时间：2013-03-17T23:15:24.133
> 
> 标签：python, list-comprehension, modular-arithmetic

来自 Project Euler 的问题 48 描述：

> 系列，1^1 + 2^2 + 3^3 + ... + 10^10 = 10405071317。找到系列的最后十位，1^1 + 2^2 + 3^3 + ... + 1000^1000。

我刚刚在 Python 中使用单线解决了这个问题：

```
print sum([i**i for i in range(1,1001)])%(10**10) 
```

我几乎立即就这样做了，因为我记得除法 mod n 在 Python 中非常快。但我仍然不明白这在幕后是如何工作的（Python 做了哪些优化？）以及为什么*这么*快。

你能给我解释一下吗？该`mod 10**10`操作是否针对列表推导的每次迭代而不是整个总和进行了优化？

```
$ time python pe48.py 
9110846700

real 0m0.070s
user 0m0.047s
sys  0m0.015s 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T23:19:42.943

鉴于

`print sum([i**i for i in range(1,1001)])%(10**10)`

和

`print sum([i**i for i in range(1,1001)])`

在 Python 中功能同样快，你最后一个问题的答案是“不”。

因此，Python 必须能够非常快速地进行整数求幂。碰巧整数幂是 O(log(n)) 乘法：[http ://en.wikipedia.org/wiki/Exponentiation#Efficient_computation_of_integer_powers](http://en.wikipedia.org/wiki/Exponentiation#Efficient_computation_of_integer_powers)

基本上所做的是，你意识到 2^100 也是 2^64 * 2^32 * 2^4 ，而不是做 2^100 = 2*2*2*2*2... 100 次，你可以一遍又一遍地平方 2 得到 2^2 然后 2^4 然后 2^8... 等等，一旦你找到了所有这三个分量的值，你就可以将它们相乘以获得最终答案。这需要更少的乘法运算。具体如何实现它有点复杂，但是 Python 已经足够成熟，可以在这样一个核心特性上进行很好的优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:20:19.787

不，它适用于整个金额。总和本身的计算速度非常快。如果参数是整数，那么做指数并不难。

# ruby-on-rails - 如何通过使用 simple_form 和嵌套表单的关联为 has_many 创建嵌套表单？

> ID：15467465
> 
> 赞同：4
> 
> 时间：2013-03-17T23:16:17.070
> 
> 标签：ruby-on-rails, nested-forms, simple-form, has-many-through, nested-form-for

我有一个 Rails 应用程序，它有一个专辑和歌曲模型，其中有很多关系。我正在尝试使用[simple_form](https://github.com/plataformatec/simple_form)和[nested_form](https://github.com/ryanb/nested_form) gem 将歌曲添加到专辑中。

如果我使用 simple_form，则很容易创建关联，但我无法让它与nested_form 一起使用。看来这应该工作：

```
<%= f.fields_for :songs do |song_form| %>
  <%= song_form.association :songs %>
  <%= song_form.link_to_remove "Remove this song" %>
<% end %>
<p><%= f.link_to_add "Add a song", :songs %></p> 
```

但我得到这个错误：`RuntimeError in Albums#new Association :songs not found`。如果我只使用 simple_form，该关联就可以正常工作。

正确的语法是什么？还是这些宝石不兼容？如果这两个 gem 不兼容，那么您将如何仅使用 nested_form 从专辑中添加和删除歌曲？

/views/albums/_form [https://gist.github.com/leemcalilly/51e7c5c7e6c4788ad000](https://gist.github.com/leemcalilly/51e7c5c7e6c4788ad000)

/models/专辑 [https://gist.github.com/leemcalilly/9a16f43106c788ab6877](https://gist.github.com/leemcalilly/9a16f43106c788ab6877)

/models/song [https://gist.github.com/leemcalilly/0ccd29f234f6722311a0](https://gist.github.com/leemcalilly/0ccd29f234f6722311a0)

/models/albumization [https://gist.github.com/leemcalilly/c627ad2b178e1e11d637](https://gist.github.com/leemcalilly/c627ad2b178e1e11d637)

/controllers/albums_controller [https://gist.github.com/leemcalilly/04edf397b2fb2a3d0d1d](https://gist.github.com/leemcalilly/04edf397b2fb2a3d0d1d)

/controllers/songs_controller [https://gist.github.com/leemcalilly/bcbccc9259c39d0b6b7a](https://gist.github.com/leemcalilly/bcbccc9259c39d0b6b7a)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T16:28:07.567

表单构建器`song_form`代表一个`Song`对象，而不是一个`Album`，这就是找不到关联的原因。

在下面的块`fields_for`中，您可以手动为歌曲创建表单。就像@david 在他的评论中提到的那样，您应该使用`simple_fields_for`而不是`fields_for` [让所有 simple_form 方法可用](https://github.com/plataformatec/simple_form#simple-fields-for)。结果是：

```
<%= f.simple_fields_for :songs do |song_form| %>
  <%= song_form.input :artwork %>
  <%= song_form.input :track %>
  ...
  <%= song_form.link_to_remove "Remove this song" %>
<% end %> 
```

# rest - 在同一台机器上托管 WWW 和 RESTful 服务

> ID：15467468
> 
> 赞同：0
> 
> 时间：2013-03-17T23:16:30.150
> 
> 标签：rest, iis, web

可以同时托管 WCF RESTful 服务和常规站点/www 服务吗？还是我需要一台单独的机器来托管 WCF？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:36:59.917

是的。它们可以托管在同一台机器上（取决于您是否使用共享主机）。如果您有权限，您只需要将它们绑定到不同的端口。

例如，如果您的网站托管在端口 80（通常是默认端口）上，那么您可以在托管在端口 8080 上的同一台计算机上为 WCF HTTP 服务创建另一个网站。

如果您的网站是 .NET 应用程序池，您甚至可以使用虚拟目录将 WCF 服务托管在与您的网站相同的应用程序池中。

此外，如果您通过主机标头区分它们，您可以在同一端口上托管多个网站。

# actionscript-3 - 如何在 Flash 上正确使用 KeyboardEvent

> ID：15467477
> 
> 赞同：0
> 
> 时间：2013-03-17T23:17:19.013
> 
> 标签：actionscript-3, flash, flash-cs5

我在开始的游戏中使 KeyboardEvent 工作时遇到问题。我有三个类，一个用于处理关卡，一个是实际关卡，一个用于表示头像：

**等级**

```
import flash.display.MovieClip;
import flash.events.Event;

public class Fase extends Cena
{
    var avatar:Avatar;

    public function Fase()
    {
        // constructor code
        this.addEventListener(Event.ADDED_TO_STAGE, onAdded);
    }

    public function onAdded(e:Event)
    {
        avatar = new Avatar();
        this.addChild(avatar);
        avatar.x = stage.width/2;
        avatar.y = 30;

    }

    public function die()
    {
        this.removeEventListener(Event.ADDED_TO_STAGE, onAdded);
        (this.parent as ScreenHandler).removeChild(this);
    }

} 
```

**阿凡达**

```
public class Avatar extends MovieClip
{

    public function Avatar()
    {
        // constructor code
        this.addEventListener(Event.ADDED_TO_STAGE, onAdded);
    }

    public function onAdded(e:Event)
    {
        //stage.focus=this;
        this.addEventListener(KeyboardEvent.KEY_DOWN, apertou);
    }

    public function apertou(event:KeyboardEvent)
    {
        trace("o");
        if(event.keyCode == Keyboard.LEFT)
        {
            this.x++;
        }
    }

} 
```

如果我在 Avatar 上使用 stage.focus=this，我在这两个类上都有所有的包，但如果我在游戏执行期间单击其他地方，焦点就会丢失并且不再起作用。请问有人可以帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T01:35:13.923

键盘事件仅在分配给它们的对象是当前焦点时触发。

幸运的是，`stage`默认情况下总是有焦点。这意味着您可以将事件侦听器添加到阶段，以始终按预期触发键盘事件：

```
stage.addEventListener(KeyboardEvent.KEY_DOWN, apertou); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:20:52.270

您可以将键处理程序从化身移动到关卡或舞台，然后将您的化身移动到那里。

```
public class Fase extends Cena
{
    var avatar:Avatar;

    public function Fase()
    {
        // constructor code
        this.addEventListener(Event.ADDED_TO_STAGE, onAdded);
    }

    public function onAdded(e:Event)
    {
        avatar = new Avatar();
        this.addChild(avatar);
        avatar.x = stage.width/2;
        avatar.y = 30;
        addEventListener(KeyboardEvent.KEY_DOWN, apertou);

    }

    public function die()
    {
        this.removeEventListener(Event.ADDED_TO_STAGE, onAdded);
        (this.parent as ScreenHandler).removeChild(this);
    }

    public function apertou(event:KeyboardEvent)
    {
        if(event.keyCode == Keyboard.LEFT)
        {
            avatar.x++;
        }
    }

} 
```

# haskell - Hackage 有 API 吗？

> ID：15467478
> 
> 赞同：4
> 
> 时间：2013-03-17T23:17:20.013
> 
> 标签：haskell, hackage

我希望能够搜索一个包并获得一个下载链接以及所有依赖项的列表。有没有一种简单的方法可以通过命令行或 Haskell 模块来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T01:13:29.150

`cabal`（可以从`cabal-install`包中获得，如果你还没有的话）可以做到这一点。我将无耻地使用我刚刚发布的`universe`包作为运行示例。对于搜索：

```
sorghum:~% cabal list universe
* universe
    Synopsis: Classes for types where we know all the values
    Default available version: 0.0
    Installed versions: 0.0
    License:  BSD3

* universe-th
    Synopsis: Construct a Dec's ancestor list.
    Default available version: 0.0.0.6
    Installed versions: [ Not installed ]
    Homepage: http://github.com/jfishcoff/universe-th
    License:  BSD3 
```

对于依赖信息：

```
sorghum:~% cabal info universe
* universe         (library)
    Synopsis:      Classes for types where we know all the values
    Versions available: 0.0
    Versions installed: 0.0
    Homepage:      [ Not specified ]
    Bug reports:   [ Not specified ]
    Description:   A small package, in the spirit of data-default, which allows
                   the munging of finite and recursively enumerable types
    Category:      Data
    License:       BSD3
    Author:        Daniel Wagner
    Maintainer:    daniel@wagner-home.com
    Source repo:   [ Not specified ]
    Dependencies:  base ==4.*, void >=0.1 && <0.6
    Documentation: /home/dmwit/.cabal/x86_64/share/doc/universe-0.0/html
    Cached:        No
    Modules:
        Data.Universe
        Data.Universe.Helpers 
```

下载和解压：

```
sorghum:~% cabal unpack universe
Downloading universe-0.0...
Unpacking to universe-0.0/ 
```

您也可以直接下载而不用解压`cabal fetch`，您可能会喜欢这个`--no-dependencies`标志（或者可能不会）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:21:27.233

AFAIK 当前的 hackage 没有它。但是新的[有](http://new-hackage.haskell.org/api)一些基本的 API 调用。它们中的大多数返回 html，但其中一些返回 JSON 表示。

# c++ - 这是将类的私有 HWND 分配给另一个类的正确方法吗？

> ID：15467479
> 
> 赞同：1
> 
> 时间：2013-03-17T23:17:26.417
> 
> 标签：c++, windows, winapi, pointers, hwnd

我有 Game 类，它在某些时候会使其私有 HWND 成员 m_hWnd 获得一个值：

```
m_hWnd=CreateWindowEx(NULL,
            "Window Class",
            "Game", // Replace with gameName
            WS_OVERLAPPEDWINDOW,
            CW_USEDEFAULT,
            CW_USEDEFAULT,
            CW_USEDEFAULT,
            CW_USEDEFAULT,
            NULL,
            NULL,
            hInst,
            this); 
```

稍后，将创建一个 D2DResources 对象，其中必须传递游戏的 m_hWnd。

```
void Game::CreateRessources(HINSTANCE hInst)
{   
    CreateWindowClass(hInst); //m_hWnd gains its value it this function

    pMessageLog=CreateMessageLog();
    pD2DResources=CreateD2DResources(m_hWnd);
    pD2DResources->Initialize(m_hWnd);

    pWinsock=CreateWinsock();

} 
```

很快进入 pD2DResources->Initialize(m_hWnd) 一个 RenderTarget 被创建：

```
HRESULT D2DResources::Initialize(HWND hwnd)
{
    HRESULT hr;

    hr = D2D1CreateFactory(D2D1_FACTORY_TYPE_SINGLE_THREADED, &pD2DFactory); // Create factory

    RECT rc;
    GetClientRect(hwnd,&rc);

    if(SUCCEEDED(hr)) // Creates render target
    {
        pD2DFactory->CreateHwndRenderTarget(
            D2D1::RenderTargetProperties(),
            D2D1::HwndRenderTargetProperties(
                hwnd,
                D2D1::SizeU(
                    rc.right - rc.left,
                    rc.bottom - rc.top)),
                &pRT);
    } 
```

最重要的是这一行：

```
pD2DFactory->CreateHwndRenderTarget(
                D2D1::RenderTargetProperties(),
                D2D1::HwndRenderTargetProperties(
                    hwnd,
                    D2D1::SizeU(
                        rc.right - rc.left,
                        rc.bottom - rc.top)),
                    &pRT); 
```

HwndRenderTargetProperties 的第一个参数 HWND 将是渲染目标从其绘图命令发出输出的 HWND。在我上面的代码中，渲染目标会将其顺序发布到在 Game 对象中创建的相同 HWND 还是副本？我遇到了一些错误，也许是因为向错误的 HWND 发出命令，我不知道。

那么，上面的代码是否可以工作（渲染目标是否会将 m_hWnd 命令发送到 Game 对象中）？如果它不起作用，解决办法是什么？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:19:20.630

是一样的。将 HWND 视为指向底层操作系统资源的“指针”。当您复制 HWND 时，您将“指针”复制到资源，而不是资源本身。

# php - 在 GET 上显示 Select

> ID：15467481
> 
> 赞同：1
> 
> 时间：2013-03-17T23:17:45.247
> 
> 标签：php, html, forms, select

如果我有一个选择表单，例如：

```
 <form action='?' method='get' name='form_filter' class="sortoptions" >
        <select name="sort" >  
          <option value="None">None</option>  
          <option value="PriceLow">Price (Low to High)</option>  
          <option value="PriceHigh">Price (High to Low)</option> 
          <option value="NameAZ">Name (A-Z)</option>  
          <option value="NameZA">Name (Z-A)</option>  
          </select> 
```

我正在使用 GET 方法提交，但需要一种方法来确定何时提交，并在结果页面上选择要显示的选项。

所以说，如果选择了“价格（从高到低）”，那么它会在提交后显示在结果页面的选择框中

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:20:12.553

```
$_GET['sort'] 
```

在提交的页面中会给你选择的选项。并检查表单是否已提交：

```
if(isset($_GET['submit'])) {
    // do something with the result
} 
```

其中“提交”是提交按钮的名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:23:45.197

当您提交表单时（假设您的表单中有一个提交按钮），所有数据都将发送到 PHP，您将在 $_GET（全局变量）中检索所有数据

```
$_GET['sort'] 
```

将包含选定的值。

然后如果你想预先选择，你只需要在你的 HTML 中添加一些 PHP 代码

```
<option value="PriceLow" <?php echo ((!empty($_GET['sort']) && $_GET['sort'] == 'PriceLow') ? 'selected="selected"' : '') ?>>Price (Low to High)</option> 
```

您必须对选择的每个选项执行相同的操作。这将允许您在第一次提交后预先选择好的选项。

解决方案2：

如果您不想在 HTML 代码中插入太多 PHP，您可以将发布的值存储在 javascript var 中，然后在加载 DOM 时选择好的选项（例如，使用像 jQuery 这样的好的 JS 库）

您的 HTML 代码：

```
<select name="sort" >  
    <option value="None">None</option>  
    <option value="PriceLow">Price (Low to High)</option>  
    <option value="PriceHigh">Price (High to Low)</option> 
    <option value="NameAZ">Name (A-Z)</option>  
    <option value="NameZA">Name (Z-A)</option>  
</select> 
```

以及标签中的一些 JS`<script>`代码

```
// Need jQuery !
$(document).ready(function() {

    // Generate the selected var in JS using the value in PHP
    var selectedOption = '<?php echo $_GET['sort']; ?>';

    // Select the selected option and append the selected attribute
    $("select[name=sort] option[value=" + selectedOption + "]").attr('selected', 'selected');

}); 
```

加载页面后，此代码将自动选择好的选项。

信息：好处是您拥有更清晰和可维护的 HTML 代码。不好的一点是，如果客户端上没有启用 JavaScript，您的自动选择将不起作用（当您使用 PHP 在 HTML 中添加“选定”时，它总是会起作用）。因此，您必须评估利弊并做出选择。

注意：您可以将操作留空而不是“？”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T23:29:57.303

试试这个代码，它可能是你想要的。我假设您正在将它写在您的`.php`文件或其他扩展中，可能`.html`在其中启用了 php 代码（可能通过`.htaccess`文件）

```
<?php if (isset($_GET['sort'])){ ?>
<?php $sel= $_GET['sort']; # format? ?>

<strong><?php print($sel);?></strong>

<?php } ?>

<form action='' method='GET' name='form_filter' class="sortoptions" >
<select name="sort" >
    <?php
        $ff = Array(
            'None' => 'None',
            'PriceLow' => 'Price (Low to High)',
            'PriceHigh' => 'Price (High to Low)',
            'NameAZ' => 'Name (A-Z)',
            'NameZA' => 'Name (Z-A)',
        );
    ?>
    <?php foreach ($ff as $v => $t) {?>
        <option value="<?php print($v);?>" <?php if (isset($_GET['sort']) && ($_GET['sort'] == $v)) print('selected="selected"');?>"><?php print($t);?></option>
    <?php } ?>
</select>
<input name="submit" type="submit" />
</form> 
```

# nginx - nginx重写的问题

> ID：15467482
> 
> 赞同：0
> 
> 时间：2013-03-17T23:18:08.277
> 
> 标签：nginx, rewrite

嗨所以我需要重写这个：

```
www.site.com/foo.php?var1=value1&var2=value2 
```

对此：

```
www.site.com/value2 
```

我试过这个：

```
location /value2 {
  rewrite ^/value2/?$ /foo.php?var1=value1&var2=value2;
} 
```

这个变体似乎有效，但关键是变量没有通过......

和这个：

```
location /foo.php {
if ($arg_var2 ~ "value2") {
        rewrite ^ http://site.com/$arg_var2? permanent;
    }
} 
```

但它没有用......有什么想法吗？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T09:19:53.493

如果 value1 和 value2 是常数，您可以使用：

```
 if ($args ~ "var1=value1&var2=value2") {
          set $args / ;
          rewrite ^.*$  /const2 permanent;
    } 
```

另一种解决方案是更灵活的东西，它应该与其他值一起使用，但我没有设法使用正则表达式（这个不起作用，但它不应该太远）：

```
location / {
    rewrite ^/foo.php.*var2=.*$ /$2 redirect;   
} 
```

# javascript - 异步 html5 验证

> ID：15467484
> 
> 赞同：11
> 
> 时间：2013-03-17T23:18:09.993
> 
> 标签：javascript, html, validation

由于某种原因，当我使用异步请求时未显示 html5 验证消息。

在这里你可以看到一个例子。

[http://jsfiddle.net/E4mPG/10/](http://jsfiddle.net/E4mPG/10/)

```
setTimeout(function() {                
  ...
  //this is not working
  target.setCustomValidity('failed!');                
  ...
}, 1000); 
```

未选中复选框时，一切都按预期工作，但选中时，消息不可见。

有人可以解释应该做什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T13:01:01.320

我想通了，原来 HTML5 验证消息只会在表单提交过程中弹出。

这是我的解决方案背后的过程（检查超时时）：

1.  提交表格
2.  设置`forceValidation`标志
3.  设置超时功能
4.  调用超时函数时，重新提交表单
5.  如果`forceValidation`设置了标志，则显示验证消息

基本上执行两次提交，第一次由按钮触发，第二次在调用超时函数时触发。

[jsFiddle](http://jsfiddle.net/Tyriar/US7h7/3/)

```
var lbl = $("#lbl");
var target = $("#id")[0];

var forceValidation = false;

$("form").submit(function(){
    return false;
});

$("button").click(function (){                
    var useTimeout = $("#chx").is(":checked");         

    lbl.text("processing...");
    lbl.removeClass("failed");
    target.setCustomValidity('');    
    showValidity();     

    if (forceValidation) {
        forceValidation = false;
        lbl.text("invalid!");
        lbl.addClass("failed");
        target.setCustomValidity('failed!');
        showValidity();
    } else if (useTimeout) {
        setTimeout(function () {
            forceValidation = true;
            $("button").click();
        }, 1000);
    } else {
        lbl.text("invalid without timeout!");
        lbl.addClass("failed");
        target.setCustomValidity('failed!');
        showValidity();            
    }
});

function showValidity() {                    
    $("#lbl2").text(target.checkValidity());
}; 
```

我在 Chrome 版本 25.0.1364.172 m 上运行。

# spell-checking - 如何将 ispell 字典导入 hunspell？

> ID：15467485
> 
> 赞同：3
> 
> 时间：2013-03-17T23:18:11.040
> 
> 标签：spell-checking, aspell, hunspell, ispell

我下载了字典：American-huge for ispell，我正在尝试从中提取单词列表。我很难将它导入 aspell 并使用 aspell 转储它，但我不想:(

我读到 hunspell 我可以在我的程序中使用 hunspell，所以下一个选择是使用 hunspell 字典，但问题是我没有找到 hunspell 的等效字典（巨大）。

有没有办法将 ispell 字典导入 hunspell ？

# python - RRule 设置为一天中的天数和小时数

> ID：15467488
> 
> 赞同：0
> 
> 时间：2013-03-17T23:18:31.163
> 
> 标签：python, datetime, forex, rrule

我正在使用 python 的规则来计算交易时间。这几天很容易，我正在使用我在这个网站上找到的一个稍微修改过的例子：

```
def get_rset(start_date):    
    # Create a rule to recur every weekday starting today
    r = rrule.rrule(rrule.DAILY,
                    byweekday=[rrule.MO, rrule.TU, rrule.WE, rrule.TH, rrule.FR],
                    dtstart=start_date)
    # Create a rruleset
    rs = rrule.rruleset()
    # Attach our rrule to it
    rs.rrule(r)
    # Add holidays as exclusion days
    for exdate in holidays:
        rs.exdate(exdate)
    return rs 
```

问题是虽然这对股票很有效，但我需要以不同的方式计算外汇日期。我需要按小时工作，加上公共假期等。

在UTC，我相信市场从周日晚上10点到下周五晚上10点开放。

为了使这成为一个规则，我现在需要 6 个不同的日子，周日和周五需要特殊时间，其余工作日被视为所有时间。我很确定我需要混合使用规则 byday 和 byhour，但我没有任何好的例子来说明这一点。

非常欢迎任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T12:11:00.450

在与谷歌单独相处一段时间后，我找到了一种更简单的方法，代码和类文档。它使用了轻微的（但适当的）作弊。请参阅下面的示例解决方案。

```
from dateutil import rrule
from datetime import  timedelta , datetime
holidays = [] # This is just a list of dates to exclude

def datetime_in_x_trading_hours(start_dt,future_hours):
    # First we add two hours. This is because its simpler to view the timeset
    # as 24hrs MON - FRI. (This also helps align the dates for the holidays)
    print start_dt
    start_dt += timedelta(hours=2)
    rs = get_fx_rset(start_dt)
    # Now using the set get the desired time and put the the missing hours
    future_time = rs[future_hours]
    future_time -= timedelta(hours=2)
    return future_time

def get_fx_rset(start_date_time):

    # Create a rule to recur every weekday starting today
    r = rrule.rrule(rrule.HOURLY,
                    byweekday=[rrule.MO, rrule.TU, rrule.WE, rrule.TH, rrule.FR],
                    byhour=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],
                    byminute=[0],
                    bysecond=[0],
                    dtstart=start_date_time)

    # Create a rruleset
    rs = rrule.rruleset()
    # Attach our rrule to it
    rs.rrule(r)
    # Add holidays as exclusion days
    for exdate in holidays:
        rs.exdate(exdate)

    return rs

today = datetime.now() - timedelta(days=2)
print datetime_in_x_trading_hours(today, 7) 
```

# php - 数据库问题 - 不同行中的相同值

> ID：15467491
> 
> 赞同：0
> 
> 时间：2013-03-17T23:18:37.150
> 
> 标签：php, mysql

我正在努力使我的投票系统正常工作。我有 3 个数据库表：用户、帖子、投票

表用户具有字段用户名作为主键。表 post 具有 post_id 作为主键。（有更多字段，但它们不会影响问题/问题）

在投票表中，我有 3 个字段：`username, post_id, vote`. 投票是`enum` `('positive', 'negative')`。我想要实现的是，如果用户为页面上显示的特定帖子投票，则查询：`INSERT INTO votes ('username','post_id','vote') VALUES('$user_name','$post_id', 'positive')`; 将被执行。

如果假设用户`123123`还没有投票给任何帖子，它就可以工作。当这个用户投票让我们说帖子 1 时，这个查询工作正常。但是，如果该用户想为不同的帖子投票，（他的投票被计算在内 - 我只是复制了不起作用的部分代码，其余部分很好并且可以工作）插入查询不会执行。如果用户`abcd`想为特定的帖子投票，这又可以正常工作，但只有一次。在我看来，数据库存在某种问题，因此只能有一个具有相同`username`or的条目`post_id`。如果我希望一个用户能够为多个帖子投票，我该如何解决这个问题？有没有更好的策略呢？

```
if($runloggedin->num_rows == 1)
{
    // If there was no vote for the current posting, then execute this query
    $query = "SELECT * FROM posts WHERE post_id='".$post_id."' AND user_name='".$user_name."'";         //get username and the post id
    $result = $mysqli->query($query);
    $query1 = "SELECT * FROM votes WHERE post_id='".$post_id."' AND username='".$user_name."'";         //check if there is a vote for this post already
    $result1 = $mysqli->query($query1);

    if ($result->num_rows == 1 && $result1->num_rows == 0)
    {
        $vote = "INSERT INTO votes ('username','post_id','vote') VALUES('$user_name','$post_id', 'positive')";          // this isn't working. everything else seems to be working (still test it more)
        $savevote = $mysqli->query($vote);
        $addvote = "UPDATE posts SET posvotes=posvotes+1 WHERE post_id='".$post_id."'";
        $runvote = $mysqli->query($addvote);
        echo "Thank you for your vote";
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:29:19.653

在没有看到您的`votes`表是如何创建的情况下，我猜测它`username`已被设置为主键。这将使第一个`INSERT`工作，但所有未来的工作都失败了。您需要做的是将其更改为拥有`username`并`post_id`成为主键

```
ALTER TABLE  `votes` DROP PRIMARY KEY , ADD PRIMARY KEY (  `username`, `post_id` ) 
```

# android - 如何在 android 应用程序中使用外部 java 项目

> ID：15467493
> 
> 赞同：0
> 
> 时间：2013-03-17T23:19:20.273
> 
> 标签：android, classnotfoundexception, android-build

这几天我一直在为这个问题苦苦挣扎……

简而言之，我会解释我的问题....

我有一个简单的 java 项目（不是 android 库或更复杂的东西），我想用作我的模型..

假设它被称为 mymodel 并且它有一个简单的类模型。

我也有一个 android 应用程序 myandroidapp 并且在主要活动中我想创建类模型的一个实例。

我可以将 mymodel 作为项目添加到构建路径并进行编译，但是当我运行此应用程序时，它会抛出类未找到异常。我怎样才能让它工作？

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:28:05.010

第 1 步：根据您的“简单 Java 项目”创建一个 JAR

第 2 步：将 JAR 放入`libs/`Android 项目的目录中

你完成了。

永远不要手动弄乱 Android Eclipse 项目的构建路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T01:36:03.127

在 Eclipse 中，您可以按照以下步骤操作：

**创建 JAR 文件**

1.  右键单击`mymodel`项目的根目录，然后单击“导出...”
2.  在出现的窗口中，展开“Java”类别/文件夹，选择“JAR 文件”并单击“下一步”
3.  在下一个窗口中，选择您想要的选项，特别注意“导出目的地”的位置。完成后，单击“完成”。JAR 文件现在将位于“导出目的地”。

**将 JAR 添加到 Android 项目**

1.  在您的 android 项目 ( `myandroidapp`) 中，将 JAR 文件复制到`libs/`文件夹中。您可以通过简单地复制和粘贴或拖放等来做到这一点。
2.  然后，右键单击文件`libs`夹中的 JAR 文件，继续“构建路径”，然后从出现的菜单中单击“添加到构建路径”

您现在应该可以在您的 Android 项目中使用这个 JAR 文件了。

# java - 为什么我的 toString() 重写方法必须是公开的？

> ID：15467496
> 
> 赞同：14
> 
> 时间：2013-03-17T23:19:38.367
> 
> 标签：java, object-to-string

我是 Java 新手，正在学习基础知识。我正在研究该`toString`方法以及如何在我自己的课程中覆盖它。我只是想知道为什么必须`toString`这样做`public`？是因为它是在`Object`类中定义的吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-17T23:23:43.793

来自官方 Oracle[文档](http://docs.oracle.com/javase/tutorial/java/IandI/override.html)：

> **修饰符**
> 
> 覆盖方法的访问说明符**可以允许比覆盖方法更多但不能更少的访问**。例如，超类中的受保护实例方法可以在子类中公开，但不能私有。

这是因为继承在两个类之间创建了[IS-A](http://en.wikipedia.org/wiki/Is-a)关系，对此[Liskov 替换原则](http://en.wikipedia.org/wiki/Liskov_substitution_principle)必须有效。如果没有先前的约束，那将是不可能执行的。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-03-17T23:27:10.303

想一想：您将 Gizmo 子类化为 MyGizmo。这意味着任何可以使用 Gizmo 的地方，您都可以在该地方使用 MyGizmo。如果某些程序这样做`gizmoObject.toString()`，那么即使 gizmoObject 不是 Gizmo 而是 MyGizmo，它也应该可以工作。

特别`toString`是用于打印和转储对象，并且需要在所有对象上都可以访问。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-03-17T23:21:39.383

当您覆盖任何方法时，覆盖的可见性必须至少与基方法一样可见。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-17T23:23:25.197

覆盖任何方法时，覆盖的可见性必须**等于**或**大于**基方法的可见性

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-17T23:21:46.447

重写方法时，应将重写方法的可见性声明为基类或更广泛的方法。

这是关于我自己编写的最重要规则的注释，作为对我的参考：

> /* 访问修饰符 */
> 
> 1- 孩子中的访问修饰符应该相同或更大（顺序：公共 - 保护 - 默认（包私有） - 私有）。父级中的访问修饰符不应是私有的。如果子级无法访问父级的方法，则在没有 @Override 注释的情况下覆盖该方法会将其视为新方法。
> 
> /* 返回类型 */
> 
> 2- child 中的返回类型应该是相同的类或子类。
> 
> /* 异常 */
> 
> 3- 如果父方法抛出检查异常，那么子方法可以： a- 抛出相同的异常或子类。b- 不抛出任何异常。c- 抛出运行时异常。
> 
> 4- 如果父方法抛出未经检查的异常，那么子方法可以： a- 不抛出任何异常。b- 抛出运行时异常。
> 
> 5- 如果parnet 的方法没有抛出异常，那么child 的方法可以： a- 不抛出任何异常。b- 抛出运行时异常。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-17T23:23:46.820

因为您要**覆盖**一个方法，所以您必须将其定义为原型方法或更多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-18T08:46:16.297

当您覆盖子类方法时，可见性必须比父类更宽。

从宽到严的顺序：

公共 默认 保护 私有

# openxava - 如何修复 Openxava 3.1 中的集合添加元素错误

> ID：15467499
> 
> 赞同：0
> 
> 时间：2013-03-17T23:19:53.693
> 
> 标签：openxava

org.openxava.util.XavaException：无法在集合中添加新元素，因为实体属性是只读的..但是我没有在我的实体类中放入只读属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:34:49.580

这是一个类型不匹配的问题。当我仔细查看代码并为实体属性输入正确的类型时......它起作用了！我能够为该系列添加元素。

# windows - 尝试提交 Git 文件但得到 :: fatal: LF 将被替换为 CRLF

> ID：15467507
> 
> 赞同：67
> 
> 时间：2013-03-17T23:21:17.947
> 
> 标签：windows, visual-studio, git

当我尝试提交一些更改的文件时，我收到以下 TortoiseGit 错误消息

`fatal: LF would be replaced by CRLF in <some file in the repo>`

现在，在我得到通常的`LF vs CRLF`答案之前，我知道并理解辩论的内容。其次，我还将全局设置设置为：

`core.autocrlf true`

第三，[我有一个`.gitattributes`文件](https://gist.github.com/PureKrome/5184077)。

所以我 - 想 - 确保文件被迫拥有`CRLF`.

我不明白的是，它在说`FATAL`并阻止我继续。一个警告？当然！我知道我想要做什么吗？我愿意！

**我只想让它静默转换 STFU**。

或者，如果它被迫阻止我，有没有办法可以将 repo 中的所有文件更新为`CRLF`，因此不再发出此警告？

这些存储库是私有的，因此永远不会在 Windows + Visual Studio 之外开发。

我该如何进行？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-03-18T06:45:16.870

`core.safecrlf`如果您只需要警告而不是致命错误，则可能需要设置为“警告”。

来自[“ `git config`”管理页面](http://git-scm.com/docs/git-config)：

核心.safecrlf

> 如果为真，当行尾转换处于活动状态时，让 git 检查转换 CRLF 是否可逆。Git 将验证命令是否直接或间接修改了工作树中的文件。
> 例如，提交一个文件然后签出同一个文件应该会在工作树中产生原始文件。**如果 core.autocrlf 的当前设置不是这种情况，git 将拒绝该文件**。
> 该变量可以设置为“警告”，在这种情况下，git 只会警告不可逆的转换，但会继续操作。
> 
> CRLF 转换可能会损坏数据。
> 启用后，git 将在提交期间将 CRLF 转换为 LF，在签出期间将 LF 转换为 CRLF。
> **git 无法重新创建在提交之前包含 LF 和 CRLF 混合的文件**。
> 对于文本文件，这是正确的做法：它更正了行尾，以便我们在存储库中只有 LF 行尾。
> **但对于意外归类为文本的二进制文件，转换可能会损坏数据**。
> 
> 如果您及早发现这种损坏，您可以通过在`.gitattributes`.
> 提交后，您的工作树中仍然有原始文件，并且该文件尚未损坏。你可以明确告诉 git 这个文件是二进制文件，git 会适当地处理这个文件。
> 
> 不幸的是，无法区分清理具有混合行结尾的文本文件的预期效果和损坏二进制文件的不良效果。
> 在这两种情况下，CRLF 都会以不可逆的方式被移除。对于文本文件，这是正确的做法，因为 CRLF 是行尾，而对于二进制文件，转换 CRLF 会破坏数据。

我更喜欢确定我想`.gitattributes`仅使用文件（使用`core.eol`您拥有的设置）强制 eol 的确切文件或文件类型，并将其保留`autocrlf`为 false。

例如，对于具有混合 eol 的文本字段，此[博客文章](http://www.sutanaryan.com/web-development/fatal-lf-would-be-replaced-by-crlf-git-version-control-system/)建议：

> 如果您的计算机中安装了 Notepad++，只需按照以下步骤操作。
> 
> 1.  打开有致命问题的文件。
> 2.  单击`Edit -> EOL Conversion`然后选择 Windows 格式或任何您遇到问题的提交。

* * *

警告，如果您有 Git 2.17 或 2.18：在 Git 2.17 周期中的[8462ff4](https://github.com/git/git/commit/8462ff43e42ab67cecd16fdfb59451a53cc8a945)（“ `convert_to_git()`:`safe_crlf/checksafe`变为`int conv_flags`”，2018-01-13，Git 2.17.0）中引入的回归导致`autocrlf`重写产生警告消息，**尽管设置`safecrlf=false`**了.

请参阅[Anthony Sottile ( ) 的](https://github.com/asottile)[提交 6cb0912](https://github.com/git/git/commit/6cb09125bea69d9bdb461b8ecacd5c50c9e6a4f5)（2018 年 6 月 4 日[）](https://github.com/asottile)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([8063ff9 提交中](https://github.com/git/git/commit/8063ff9cf595dc9414e7a27d3310ae1031f5c883))^(，2018 年 6 月 28 日）)[`asottile`](https://github.com/asottile)
^([`gitster`](https://github.com/gitster))

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2015-11-25T18:33:05.337

```
git config --global core.safecrlf false 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-11-10T05:26:17.740

这将禁用 crlf 致命警告。

```
git config core.autocrlf false
git config core.safecrlf false 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-05-07T16:23:34.173

由于您的仓库是私有的，您可以`git-config`这样设置：

`git config --global core.autocrlf false`

这将解决您的问题。如果您还有任何问题，您可以阅读[《Pro git》</a>：](https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration#Formatting-and-Whitespace)

 [> **如果您是一名 Windows 程序员，正在做一个仅限 Windows 的项目，那么您可以关闭此功能，通过将配置值设置为****false**将回车记录在存储库中： `$ git config --global core.autocrlf false`

但是在协作时，您最好在下面执行这些操作：](https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration#Formatting-and-Whitespace) 

[](https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration#Formatting-and-Whitespace)
2.  [add `.gitattributes`,](https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration#Formatting-and-Whitespace) [Github help - 处理行尾](https://help.github.com/articles/dealing-with-line-endings/)会有帮助。
3.  `git config --global core.safecrlf true`
4.  *   视窗：`git config --global core.autocrlf true`
    *   mac 或 linux：`git config --global core.autocrlf input`

您可能想阅读[Git docs-git config](https://git-scm.com/docs/git-config)了解更多信息。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-11T21:42:02.330

`git config --global core.autocrlf false`将使用不习惯的 CRLF 签入文件。

我在 Windows 上注意到，`core.autocrlf true`git 不喜欢带有 LF 的文件，`core.autocrlf input`也不喜欢 CRLF。

所以：提交 CRLF 文件`core.autocrlf true`和 LF 文件`core.autocrlf input`（或将它们转换为 CRLF）。

通常带有 LF 的文件由代码生成器自动生成（例如[https://start.spring.io](https://start.spring.io)或[http://yeoman.io/](http://yeoman.io/)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-16T09:15:29.943

使用 .gitattributes 文件，使用

```
*.h text=auto
*.cpp text=auto
*.txt text=auto 
```

如 [https://git-scm.com/docs/gitattributes](https://git-scm.com/docs/gitattributes)中所述。

# java - 无法从 Java 项目访问终端中的 .png 文件

> ID：15467520
> 
> 赞同：1
> 
> 时间：2013-03-17T23:23:06.790
> 
> 标签：java, eclipse, applet, terminal

如果您需要比这更多的代码，请告诉我！

我可以在 Eclipse 中完美地运行该程序。但是一旦我访问文件并在终端中运行 java Frame，它只会显示我游戏的一部分。它不显示任何 .png 文件。

这是我的主要方法：

```
import javax.swing.*;
import java.awt.*;

public class Frame extends JFrame {
public static String title = "Tower Defense Alpha";
public static Dimension size = new Dimension(700, 550);

public Frame() {
    setTitle(title);
    setSize(size);
    setResizable(false);
    setLocationRelativeTo(null);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    init();

}

public void init(){

    setLayout(new GridLayout(1,1,0,0));

    Screen screen = new Screen(this);
    add(screen);

    setVisible(true);

}

public static void main(String args[]){
    Frame frame = new Frame();

} 
```

}

这是我在 Eclipse 中访问文件的方式，这在终端中似乎不起作用：

```
for (int i=0; i<tileset_ground.length; i++) {
        tileset_ground[i] = new ImageIcon("res/tileset_ground.png").getImage();
        tileset_ground[i] = createImage(new FilteredImageSource(tileset_ground[i].getSource(), 
                                        new CropImageFilter(0, 26*i, 26, 26)));
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:43:33.250

似乎问题在于，在终端上，程序正在从 运行`Client/src folder`，因此它试图在 上查找`Client/src/res`不存在的图像。

另一方面，Eclipse 保留单独的文件夹并使用项目文件夹作为其根文件夹启动程序：

```
Client
|
+-- bin (classes compiled by Eclipse)
|
+-- res (images)
|
+-- src (source code) 
```

通过`javac *.java`while 在`src`文件夹上运行，您将在文件夹上创建已编译类的副本`src`。

在终端上，您需要返回到客户端文件夹并从那里启动您的程序`java -classpath bin Frame`

# javascript - 无法在循环中添加 Jquery 插件

> ID：15467522
> 
> 赞同：1
> 
> 时间：2013-03-17T23:23:15.950
> 
> 标签：javascript, jquery, loops, plugins

您好我有一个 JQuery 插件，它接受一个订单数组并为数组中的每个订单创建行。这里没有问题。但是，如果其中一个订单满足条件，则应在其中一个 TD 单元格中添加一个文本框。当我调试时，我可以看到它添加了文本框，但是当创建需要文本框的下一行时，前一个文本框被删除。我把这个关在里面，所以不知道该怎么做。所以结果是我只在最后一行得到文本框。

如果我将文本框添加为 html，它可以正常工作，但我希望它作为插件，因为我需要绑定几个事件 KeyUp/Down MouseWheel，Click。等文本框插件控件（gep_inputcontrol）只是创建html并绑定事件，没什么特别的。

任何帮助表示赞赏。

* * *

```
var _table = $('#orderTable', this);
for (var i = 0; i < params.orders.length; i++) {
    var row = createRow(params.orders[i]);
    _table.append(row);
} 
```

* * *

```
function createRow(order){
    var unmatchedStake = (order.requestedStake - order.matchedStake);
    var partMatched = (unmatchedStake > 0);

    var tr = $(String.format('<tr id="order_{0}" class="{1}"/>' ,order.orderId, ((i % 2) == 0) ? 'gep-altrow' : 'gep-row'));

            tr.append(String.format('<td class="gep-icon gep-status">{0}</td>', order.orderStatusId));
            tr.append(String.format('<td class="gep-selectionname">{0} {1} {2}</td>', GBEUtils.getEventName(order.eventClassifierFullName()), gep._settings.resources.general.polarity[order.polarityId], order.selectionName()));
            tr.append(String.format('<td class="gep-odds betSlipRowPrice">{0}</td>', order.averageMatchedPrice));
            tr.append(String.format('<td class="gep-unmatched betSlipRowStake">{0}</td>', com.base.formatDecimal(order.requestedStake - order.matchedStake,2)));
            tr.append(String.format('<td class="gep-matched">{0}</td>', com.base.formatDecimal(order.matchedStake,2)));
            tr.append(String.format('<td class="gep-action"><span  class="gep-icon"/></td>', order.orderStatusId));

             //var tablerow = $(String.format('#order_{0}',order.orderId), _table);
            //(function (_table, tr, i, unmatchedStake, tablerow) {
            if(unmatchedStake > 0)//part matched
            {

                $('.gep-unmatched', tr).gep_inputcontrol({
                    type:'STAKE', 
                    ccSymbol:clientObject.state.ccSymbol,
                    value: unmatchedStake,  
                    decimalValue:unmatchedStake,
                    onMouseWheeled: function(e, ev){
                        gep.inputControlWheeled(e, ev);
                        gep.calculateRowProfit(e, false);
                        return false;
                        },
                    onArrowClicked: function(e){
                        gep.onArrowClick(e);
                        return false;
                        }
                    });

                    //$('.gep-unmatched', tr).html($('.gep-unmatched', tr).html());

                $('.gep-odds', tr).gep_inputcontrol({
                    type:'PRICE', 
                    value:order.requestedPrice, 
                    decimalValue:order.requestedPrice,
                    onMouseWheeled: function(e, ev){
                        gep.inputControlWheeled(e, ev);
                        gep.calculateRowProfit(e, false);
                        return false;
                    },
                    onArrowClicked: function(e){
                        gep.onArrowClick(e);
                        return false;
                    }
                    });

                $('.gep-action .gep-icon', tr).addClass("gep-icon-delete");

                $('.gep-icon-delete', tr).bind("click", function(){
                    alert("delete");
                    toggleCurrentBetSlipBet(this);
                    return false;
                });

            }

            // })(_table, tr, i, unmatchedStake, tablerow);

            return tr; 
```

}

文本框插件创建一个带有输入框和两个锚标签的表格。

```
/********************
GEP.gep_inputcontrol // stake input, price input box
********************/
(function ($) {

var _templatePrice = $('<table class="gep-inputcontrol" cellpadding="0" cellspacing="0"><tr><td rowspan="2"><input type="text" size="5" class="gep-inputcontrol-price" /></td><td><a tabindex="-1" href="javascript:void(0);" class="gep-inputup"></a></td></tr><tr><td> <a tabindex="-1" href="javascript:void(0);" class="gep-inputdown"></a> </td></tr></table>');
var _templateStake = $('<table class="gep-inputcontrol" cellpadding="0" cellspacing="0"><tr><td rowspan="2"><span class="gep-ccsymbol" /> <input type="text" size="5" class="gep-inputcontrol-stake" /> </td> <td> <a tabindex="-1" href="javascript:void(0);" class="gep-inputup"></a></td></tr><tr><td> <a tabindex="-1" href="javascript:void(0);" class="gep-inputdown"></a> </td></tr> </table>');
var _template;

var _settings = null;
var _instance;
var methods = {
    init: function (options) {
        _settings = options;
        //options.type = 'STAKE'or 'PRICE'

        _template = (options.type == 'STAKE')? _templateStake: _templatePrice;

        $('.gep-ccsymbol',_template).html(options.ccSymbol);

        this.html(_template);
        $('input', this).attr('value', options.value);
        $('input', this).attr('initialvalue', options.decimalValue);
        $('input', this).attr('decimalValue', options.decimalValue);

        $('input', this).bind("mousewheel", function (ev) {
            _settings.onMouseWheeled.call(null, this, ev.originalEvent);
        });      

        $('.gep-inputup', this).bind("click", function (e) {
            _settings.onArrowClicked.call(null, this);
        });            
        $('.gep-inputdown', this).bind("click", function (e) {
            _settings.onArrowClicked.call(null, this);
        });

        _instance = this;
        return this;

    },
    show: function (params) {
        alert("show" + params);
    },
    hide: function () {
        // GOOD
    },
    update: function (content) {
        // !!! 
    }
};

$.fn.gep_inputcontrol = function (method) {

    // Method calling logic
    if (methods[method]) {
        return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
    } else if (typeof method === 'object' || !method) {
        return methods.init.apply(this, arguments);
    } else {
        $.error('Method ' + method + ' does not exist on jQuery.gep_inputcontrol');
    }

};

})(jQuery); 
```

为了详细说明，我做了一些小的单元测试

这有效..

```
$('.gep-odds', clientObject.liveBetsPane).gep_inputcontrol({
        type: 'PRICE',
        value: 5,
        decimalValue: 5,
        onMouseWheeled: function (e, ev) {
            gep.inputControlWheeled(e, ev);
            gep.calculateRowProfit(e, false);
            return false;
        },
        onArrowClicked: function (e) {
            gep.onArrowClick(e);
            return false;
        }
    }); 
```

这不起作用...（仅将文本框放在最后一行）但我需要这样做，因为我需要每一行的值。

```
$('.gep-odds', clientObject.liveBetsPane).each(function () {
    $(this).gep_inputcontrol({
        type: 'PRICE',
        value: 5,
        decimalValue: 5,
        onMouseWheeled: function (e, ev) {
            gep.inputControlWheeled(e, ev);
            gep.calculateRowProfit(e, false);
            return false;
        },
        onArrowClicked: function (e) {
            gep.onArrowClick(e);
            return false;
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:42:37.440

我从模板中删除了美元，它工作正常。

```
var _templatePrice = $('<table cla... 
```

现在是
var _templatePrice = '<table cla...

尽管它为最后一行设置了 html，但它正在为其他行移动。

谢谢我.... :)

# angularjs - ng-include 禁止运行路由

> ID：15467525
> 
> 赞同：3
> 
> 时间：2013-03-17T23:23:36.083
> 
> 标签：angularjs

我在 AngularJS 应用程序中有一个非常奇怪的行为：我正在使用 $routeProvider 注册路由。除非*我*在. `ng-include`_*`ng-view`*

 *目前我有两种选择来修复它：

*   将 移动到元素`ng-include`之后的位置。`ng-view`
*   包裹`ng-include`内部`<div>`元素。

知道什么可能导致这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-08T13:37:14.740

试试看

```
 <div ng-controller="MainCtrl" ng-include src="template">

    angular.module('App')
        .controller('MainCtrl',['$route','$scope', function($route,$scope){
                $scope.template= 'main.html';
        }]);

In main.html, place the ng-view tag. 
```

在这种情况下，您需要使用控制器处理 ng-include 并将 $route 作为依赖项注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-26T14:23:28.213

我也对 $route 有一些问题。解决我的问题的一个想法是仅将 ng-switch 用于 ng-include 而不是 ng-view [angularjs 中的条件 ng-include](https://stackoverflow.com/questions/15974086/conditional-ng-include-in-angularjs)*

# java - mutator 方法可以修改变量/对象并返回它吗？

> ID：15467526
> 
> 赞同：0
> 
> 时间：2013-03-17T23:23:36.323
> 
> 标签：java

是否可以编写一个修改变量/对象并返回值的 mutator 方法？例如，实现返回排序数组的排序算法的函数？

这会被认为是一种变异方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:26:01.857

虽然这不是编写 mutator 的常用方法，但只要您明确返回更新的值，它就没有错。

# sql - 存储为字符串的时间戳的 SQL 平均时间

> ID：15467531
> 
> 赞同：3
> 
> 时间：2013-03-17T23:24:13.443
> 
> 标签：sql, sql-server, casting, group-by, average

我在 Microsoft SQL Server 表中有两列称为`date`和。`starthour`

两列都是char；另一个人做到了，我不知道为什么它是这样建造的。:)

```
date                     starthour

20/01/2011               8:10:00
20/01/2011               8:20:00
20/01/2011               8:30:00
20/01/2011               8:40:00
21/01/2011               8:10:00
21/01/2011               8:20:00
21/01/2011               8:30:00 
```

我想确定`starthour`每个日期的平均值。

```
date                     starthour
20/01/2011               8:25:00
21/01/2011               8:20:00 
```

我尝试了以下方法：

```
SELECT date, Avg(cast(starhour as datetime())) AS starhour
FROM table
GROUP BY date 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:38:17.090

```
SELECT [date], 
  CAST(DATEADD(second, AVG(DATEDIFF(second, 0 , starhour)), '00:00:00') AS time)
FROM dbo.test17
GROUP BY [date] 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/de37f/1)上的演示[](http://sqlfiddle.com/#!3/de37f/1)

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:30:19.000

**不要将日期、日期时间或时间戳存储为 varchar。**例如，MySQL 对所有这三种类型都有本机类型，这保证您不会在其中包含无效数据，并且 MySQL 将知道如何处理它们：[http ://dev.mysql.com/doc/refman /5.1/en/datetime.html](http://dev.mysql.com/doc/refman/5.1/en/datetime.html)

您应该做的是有一个字段，`date`即`timestamp`类型，包含日期和时间。您应该重构您的数据库并通过转换将所有数据转换为新格式，这样您就不必再担心了。

之后，您需要做的事情会根据您的 SQL 风格而有所不同。例如，这个答案将适用于 MySQL，但每种风格都有不同的日期时间函数（不幸的是！）。

MySQL 的日期时间函数是[http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html)

未经测试，但类似：

`GROUP BY EXTRACT(day from date)`

`AVG(EXTRACT(hour from date)*60 + EXTRACT(minute from date))`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T23:36:51.780

让我们不要拐弯抹角：您应该尽快修复此架构。

同时，这将返回正确的值。

```
select [date], 
 CONVERT(VARCHAR(8), 
 cast((avg(cast(cast(starhour as datetime)  as float)))   as datetime) , 108)
  from table
group by [date] 
```**

# list - 交换第一个和最后一个元素haskell

> ID：15467533
> 
> 赞同：1
> 
> 时间：2013-03-17T23:24:44.243
> 
> 标签：list, haskell

我试图在haskell中交换列表的第一个和最后一个元素。我已经尝试过模式匹配、表达式、函数等。这是我最后一次尝试：

`cambio xs = [ cabeza++([x]++cola)|x<-xs, cabeza <- init x, cola <- last x, drop 1 x, drop 0 ([init x])]`

我的编译器抛出下一个错误：

```
Couldn't match expected type `Bool' with actual type `[a0]'
    In the return type of a call of `drop'
    In the expression: drop 1 x
    In a stmt of a list comprehension: drop 1 x 
```

谁能帮我？我已经尝试这样做了 2 天

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T23:44:18.070

这里有一些提示：

1.  你不能用列表理解来解决这个问题。
2.  确定基本（琐碎）案例 - 空列表和一个元素列表。写出涵盖这些情况的方程式。
3.  在所有其他情况下，输入列表的长度将 >= 2。您想要的列表是

    [z] ++ xs ++ [a]

其中 z 是最后一个元素，a 是输入列表的第一个元素，xs 是输入的中间部分。

现在告诉我（或你自己），如果输入字符串的长度为 k，xs 将有多长？

1.  写出包含超过 1 个元素的列表情况的等式。您可以使用 head、last、length、drop 或 take 等函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T23:43:38.260

我认为列表不是执行此操作的最佳数据结构，但在这里：

```
swap list = last list : (init . tail $ list) ++ [head list] 
```

这将需要遍历列表，并且在长列表中会很慢。这就是链表的本质。

* * *

更新了提问者的基本案例：

```
swap [] = [] 
swap [a] = [a] 
swap list = last list : (init . tail $ list) ++ [head list] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-18T02:39:17.343

这是一件相当简单的事情，尤其是使用标准列表函数：

```
swapfl [] = []
swapfl [x] = [x]
swapfl (x:xs) = (last xs : init xs) ++ [x] 
```

或者没有它们（尽管这不太可读，通常不做，也不推荐）：

```
swapfl' [] = []
swapfl' [x] = [x]
swapfl' (x:xs) = let (f, g) = sw x xs in f:g
  where sw k [y] = (y, [k])
        sw k (y:ys) = let (n, m) = sw k ys in (n, y:m) 
```

或许多其他方式之一。

我希望这会有所帮助......我知道我没有做太多解释，但坦率地说，就这个功能而言，很难确切地说出你遇到了什么问题，因为你似乎也完全误解了列表理解。我认为如果我解释这些可能是最有益的？

> 为什么这不能通过列表理解来解决？我强硬他们就像函数但有不同的形式

并不真地。列表推导式对于轻松定义列表很有用，并且它们与数学中的集合构建符号非常密切相关。这对于这个特定的应用程序没有用处，因为虽然它们非常擅长修改列表的元素，但推导式并不擅长重新排序列表。

在理解中，您包含三个部分：列表中元素的定义、一个或多个输入列表以及零个或多个谓词：

```
[ definition | x <- input1, y <- input2, predicate1, predicate2 ] 
```

该定义描述了我们正在制作的列表的单个元素，根据输入中的箭头指向的变量（在本例中为 x 和 y）。每个输入在箭头右侧都有一个列表，在左侧有一个变量。我们正在制作的列表中的每个元素都是通过将输入列表中的每个元素组合提取到这些变量中来构建的，并使用这些值评估定义部分。例如：

```
[ x + y | x <- [1, 3], y <- [2, 4] ] 
```

这会产生：

```
[1 + 2, 1 + 4, 3 + 2, 3 + 4] == [3, 5, 5, 7] 
```

此外，您可以包含谓词，类似于过滤器。每个谓词都是根据输入元素定义的布尔表达式，并且只要有新的列表元素，就会对每个谓词进行评估。如果任何谓词结果为假，则这些元素不会放在我们正在制作的列表中。

让我们看看你的代码：

```
cambio xs = [ cabeza++([x]++cola) | x<-xs, cabeza <- init x, cola <- last x,
                                    drop 1 x, drop 0 ([init x])] 
```

这种理解的输入是`x <- xs`、`cabeza <- init x`和`cola <- last x`。第一个意味着其中的每个元素`xs`都将用于为新列表定义元素，并且每个元素都将被命名`x`。另外两个没有任何意义，因为`init`and`last`是 type `[a] -> a`，但是在箭头的右侧，所以必须是列表，并且`x`必须是列表的元素，因为它在箭头的左侧，所以在为了使它甚至可以编译， xs 必须是 type `[[[a]]]`，我敢肯定这不是您想要的。

您使用的谓词是`drop 1 x`and `drop 0 [init x]`。我有点理解你试图用第一个做什么，删除列表的第一个元素，但这不起作用，因为`x`它只是列表的一个元素，而不是列表本身。在第二个中，`drop 0`表示“从以下列表的开头删除零个元素”，这绝对不会做任何事情。在任何一种情况下，将类似的东西放在谓词中都行不通，因为谓词需要是一个布尔值，这就是你得到编译器错误的原因。这是一个例子：

```
pos xs = [ x | x <- xs, x >= 0 ] 
```

这个函数接受一个数字列表，删除所有负数，并返回结果。谓词是`x >= 0`，它是一个布尔表达式。如果表达式的计算结果为 false，则正在计算的元素会从结果列表中过滤掉。

您使用的元素定义是`cabeza ++ [x] ++ cola`. 这意味着“结果列表中的每个元素本身就是一个列表，由列表中的所有元素组成`cabeza`，后跟一个包含 的元素`x`，然后是列表中的所有元素`cola`”，这似乎与您的意图相反为了。请记住，管道字符之前的部分定义了单个元素，而不是列表本身。另外，请注意，将方括号括在变量周围会创建一个包含该变量的新列表，并且仅包含该变量。如果你说`y = [x]`，这意味着 y 包含单个元素 x，并且没有说明 x 是否是列表。

我希望这有助于澄清一些事情。

# emacs - 如何在 emacs lisp 中使用 defjump 跳转到文件中的函数？

> ID：15467542
> 
> 赞同：0
> 
> 时间：2013-03-17T23:25:54.147
> 
> 标签：emacs, elisp, emacs24

我想做的是，当我在一个来源线上时，例如：`<a href="foo.html">foo</a>`

我按下“跳转”键，它应该匹配`href="foo.html"`并打开文件`c:/project/root/templates/foo.html`。

我找到`jump.el`了（emacs 24 中的包 'jump'）并正在尝试开始`defjump`工作：

```
(require 'jump)
(defjump
  'my-follow-ref
  '(("href=\"\\1\"" . "templates/\\1"))
  "c:/project/root/"
  "Follow a logical link from one part of the source to another.") 
```

我的代码基于帮助中的示例，但我遇到了一个非常基本的 emacs lisp 错误：

```
mapcar: Wrong type argument: listp, quote 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T01:38:49.063

`jump.el`emacs 24 源代码树中没有，谷歌也没有帮助，但是，我想，你的问题是不必要的引用：可能`defjump`是一个宏。

这很有可能会起作用：

```
(defjump
  my-follow-ref
  (("href=\"\\1\"" . "templates/\\1"))
  "c:/project/root/"
  "Follow a logical link from one part of the source to another.") 
```

# java - 如何在方法类型参数中指定具有未知泛型类型的泛型类类型

> ID：15467544
> 
> 赞同：1
> 
> 时间：2013-03-17T23:26:01.657
> 
> 标签：java, generics

下面给了我一个**“类型 KeyType 没有类型参数”**。请注意，AttributeKey 确实有一个类型参数，我希望 getAttribute 方法的输入使用一个特定的类，该类使用 AttType 扩展 AttributeKey。我还没有发现这是否可行，或者如果可以，该怎么做。:)

```
public interface AttributeMap<KeyType extends AttributeKey> 
{
    public <AttType> AttType getAttribute(KeyType<AttType> key);
} 
```

# jquery - jquery ui 菜单显示为透明或在其他元素后面。

> ID：15467548
> 
> 赞同：3
> 
> 时间：2013-03-17T23:26:23.477
> 
> 标签：jquery, css, jquery-ui

如果你能帮我解决 CSS 和 jQuery UI 问题。我是这些水域的新手，所以我会尽力解释我的需求。

我使用了 jQuery UI 手风琴和 jQuery UI 菜单。菜单位于活动的手风琴“选项卡”内。当我打开菜单时，会出现选项，但问题是手风琴标题（折叠的内容）在我的菜单选项上方。请检查这个 jsFiddle，它会更好地解释事情。

[小提琴](http://jsfiddle.net/QAUbX/2/)

我已经检查过 FireBug，这个类`.ui-accordion .ui-accordion-header`有`position: relative`，我认为这会造成问题，但是当我关闭属性图标时会中断。我怎样才能使这项工作？

提前谢谢你，亲切的问候！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T00:12:13.637

简单的！！只需将您的 CSS 更改为：

```
 .ui-menu { 
    width: 150px; 
    z-index: 2;
} 
```

在此处查看[演示](http://jsfiddle.net/6LLnS/1/)。**请记住**，当您处理相对、绝对或固定的定位元素时，您可以使用[z-index](http://www.w3.org/wiki/CSS/Properties/z-index)来改变堆叠顺序。

# c# - 使用 MVVM 从 WPF 中的 TextBox 进行正确的 DataGrid 搜索

> ID：15467553
> 
> 赞同：20
> 
> 时间：2013-03-17T23:27:00.423
> 
> 标签：c#, wpf, search, mvvm, datagrid

我是 MVVM 模式的新手，对何时使用 Code Behind 有点困惑。我现在有一个非常简单的表单，其中包括一个 TextBox 和一个 DataGrid。我想要的是能够让 DataGrid 基于 TextBox 更改其选定的项目。

我已经在后面的代码中完成了这项工作，并且使用以下代码可以正常工作：

```
private void textBox1_TextChanged(object sender, TextChangedEventArgs e)
{
    for (int i = 0; i < dataGrid1.Items.Count; i++)
    {
        string cellContent = dtReferral.Rows[i][0].ToString();
        try
        {
            if (cellContent != null && cellContent.Substring(0, textBox1.Text.Length).Equals(textBox1.Text))
            {
                object item = dataGrid1.Items[i];
                dataGrid1.SelectedItem = item;
                dataGrid1.ScrollIntoView(item);
                //row.MoveFocus(new TraversalRequest(FocusNavigationDirection.Next));
                break;
            }
        }
        catch { }
    }
} 
```

现在，我只想突出显示 Datagrid 中以文本框中的文本开头的项目，并允许用户按下按钮来编辑所选项目。

可以在代码隐藏文件中包含此逻辑吗？还是我需要通过某种绑定来做到这一点？如果我应该通过带有绑定的视图模型来做到这一点，任何方向都将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-03-18T02:48:26.293

如果您只想使用来自 的文本突出显示单元格，您`TextBox`可以`AttatchedProperty`为`DataGrid`接受您的搜索值`TextBox`并`AttatchedProperty`为 然后我们创建一个来检查与 search 匹配的值。`Cell``Cell``IMultiValueConverter``Cell``Text`

这样它就可以在其他项目上重用，因为你只需要`AttachedProperties`和`Converter`

绑定`AttachedProperty` `SearchValue`到您的`TextBox` `Text`财产。

```
 <DataGrid local:DataGridTextSearch.SearchValue="{Binding ElementName=SearchBox, Path=Text, UpdateSourceTrigger=PropertyChanged}" 
```

如果单元格文本`Style`与`DataGridCell``AttachedProperty` `IsTextMatch``IMultiValueConverter``SearchValue`

```
<Setter Property="local:DataGridTextSearch.IsTextMatch">
    <Setter.Value>
        <MultiBinding Converter="{StaticResource SearchValueConverter}">
            <Binding RelativeSource="{RelativeSource Self}" Path="Content.Text" />
            <Binding RelativeSource="{RelativeSource Self}" Path="(local:DataGridTextSearch.SearchValue)" />
        </MultiBinding>
    </Setter.Value>
</Setter> 
```

然后我们可以使用`Cells`附加的`IsTextMatch`属性来设置一个突出显示`Trigger`

```
<Style.Triggers>
    <Trigger Property="local:DataGridTextSearch.IsTextMatch" Value="True">
        <Setter Property="Background" Value="Orange" />
    </Trigger>
</Style.Triggers> 
```

## 这是一个显示我的杂乱无章的工作示例:)

代码：

```
namespace WpfApplication17
{
    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();
            for (int i = 0; i < 20; i++)
            {
                TestData.Add(new TestClass { MyProperty = GetRandomText(), MyProperty2 = GetRandomText(), MyProperty3 = GetRandomText() });
            }
        }

        private string GetRandomText()
        {
            return System.IO.Path.GetFileNameWithoutExtension(System.IO.Path.GetRandomFileName());
        }

        private ObservableCollection<TestClass> _testData = new ObservableCollection<TestClass>();
        public ObservableCollection<TestClass> TestData
        {
            get { return _testData; }
            set { _testData = value; }
        }
    }

    public class TestClass
    {
        public string MyProperty { get; set; }
        public string MyProperty2 { get; set; }
        public string MyProperty3 { get; set; }
    }

    public static class DataGridTextSearch
    {
        // Using a DependencyProperty as the backing store for SearchValue.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty SearchValueProperty =
            DependencyProperty.RegisterAttached("SearchValue", typeof(string), typeof(DataGridTextSearch),
                new FrameworkPropertyMetadata(string.Empty, FrameworkPropertyMetadataOptions.Inherits));

        public static string GetSearchValue(DependencyObject obj)
        {
            return (string)obj.GetValue(SearchValueProperty);
        }

        public static void SetSearchValue(DependencyObject obj, string value)
        {
            obj.SetValue(SearchValueProperty, value);
        }

        // Using a DependencyProperty as the backing store for IsTextMatch.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty IsTextMatchProperty =
            DependencyProperty.RegisterAttached("IsTextMatch", typeof(bool), typeof(DataGridTextSearch), new UIPropertyMetadata(false));

        public static bool GetIsTextMatch(DependencyObject obj)
        {
            return (bool)obj.GetValue(IsTextMatchProperty);
        }

        public static void SetIsTextMatch(DependencyObject obj, bool value)
        {
            obj.SetValue(IsTextMatchProperty, value);
        }
    }

    public class SearchValueConverter : IMultiValueConverter
    {
        public object Convert(object[] values, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            string cellText = values[0] == null ? string.Empty : values[0].ToString();
            string searchText = values[1] as string;

            if (!string.IsNullOrEmpty(searchText) && !string.IsNullOrEmpty(cellText))
            {
                return cellText.ToLower().StartsWith(searchText.ToLower());
            }
            return false;
        }

        public object[] ConvertBack(object value, Type[] targetTypes, object parameter, System.Globalization.CultureInfo culture)
        {
            return null;
        }
    }
} 
```

xml:

```
<Window x:Class="WpfApplication17.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication17"
        Title="MainWindow" Height="350" Width="525" Name="UI">

    <StackPanel DataContext="{Binding ElementName=UI}">
        <TextBox Name="SearchBox" />
        <DataGrid x:Name="grid" local:DataGridTextSearch.SearchValue="{Binding ElementName=SearchBox, Path=Text, UpdateSourceTrigger=PropertyChanged}" 
                  ItemsSource="{Binding TestData}" >
            <DataGrid.Resources>
                <local:SearchValueConverter x:Key="SearchValueConverter" />
                <Style TargetType="{x:Type DataGridCell}">
                    <Setter Property="local:DataGridTextSearch.IsTextMatch">
                        <Setter.Value>
                            <MultiBinding Converter="{StaticResource SearchValueConverter}">
                                <Binding RelativeSource="{RelativeSource Self}" Path="Content.Text" />
                                <Binding RelativeSource="{RelativeSource Self}" Path="(local:DataGridTextSearch.SearchValue)" />
                            </MultiBinding>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="local:DataGridTextSearch.IsTextMatch" Value="True">
                            <Setter Property="Background" Value="Orange" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.Resources>
        </DataGrid>
    </StackPanel>
</Window> 
```

结果：

![在此处输入图像描述](../Images/74ec473607434998dea73ab01b45f4ed.png) ![在此处输入图像描述](../Images/5a5a58ba04c8795120248d38af926613.png)

## 编辑：

如果您只想基于单个列选择行，您可以很容易地修改:)。

覆盖样式`DataGridRow`而不是`DataGridCell`。

```
 <Style TargetType="{x:Type DataGridRow}"> 
```

首先将您想要的属性传入`IMultiValueConverter`this 应该是您的`DataContext`

```
<MultiBinding Converter="{StaticResource SearchValueConverter}">
    <Binding RelativeSource="{RelativeSource Self}" Path="DataContext.MyProperty" />
    <Binding RelativeSource="{RelativeSource Self}" Path="(local:DataGridTextSearch.SearchValue)" />
</MultiBinding> 
```

然后将`Trigger`设置更改`IsSelected`为`Row`

```
<Style.Triggers>
    <Trigger Property="local:DataGridTextSearch.IsTextMatch" Value="True">
        <Setter Property="IsSelected" Value="True" />
    </Trigger>
</Style.Triggers> 
```

应该是这样的：

```
 <DataGrid x:Name="grid" local:DataGridTextSearch.SearchValue="{Binding ElementName=SearchBox, Path=Text, UpdateSourceTrigger=PropertyChanged}" 
              ItemsSource="{Binding TestData}" >
        <DataGrid.Resources>
            <local:SearchValueConverter x:Key="SearchValueConverter" />
            <Style TargetType="{x:Type DataGridRow}">
                <Setter Property="local:DataGridTextSearch.IsTextMatch">
                    <Setter.Value>
                        <MultiBinding Converter="{StaticResource SearchValueConverter}">
                            <Binding RelativeSource="{RelativeSource Self}" Path="DataContext.MyProperty" />
                            <Binding RelativeSource="{RelativeSource Self}" Path="(local:DataGridTextSearch.SearchValue)" />
                        </MultiBinding>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="local:DataGridTextSearch.IsTextMatch" Value="True">
                        <Setter Property="IsSelected" Value="True" />
                    </Trigger>
                </Style.Triggers>
            </Style>
        </DataGrid.Resources>
    </DataGrid> 
```

结果：

![在此处输入图像描述](../Images/18acec77175b0a96871bfecc7ac5792c.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T02:01:54.780

我已经使用 MVVM 很长一段时间了，我仍然更喜欢将它用作指导而不是严格的实践，部分原因是完全按照 MVVM 模式做所有事情并不总是可行的，如果你不是，更是如此太熟悉了。
我建议只是玩弄它，直到您设法找到适合您的 MVVM 形式。
如果代码与 UI 相关，我不认为在 MVVM 的代码中包含代码是禁忌。
ScrollIntoView 不是 Bindable 属性，因此如果要绑定到它，则必须创建一个依赖属性来间接处理绑定。至于设置所选项目，您可以通过以下方式完成：

看法：

```
<TextBox Height="23" Text={Binding Path=Selected, UpdateSourceTrigger=PropertyChanged} HorizontalAlignment="Left" Margin="90,147,0,0" Name="textBox1" VerticalAlignment="Top" Width="120" />
<DataGrid AutoGenerateColumns="True" 
          ItemsSource="{Binding Path=ItemList}" 
          SelectedItem="{Binding Path=Selected}" >
</DataGrid> 
```

视图模型：

```
 private string _selected = "";
 public string Selected
 {
      get{ return _selected; }
      set
      {
            if(_selected == value) return;
            _selected = value;
            base.OnPropertyChanged("Selected");
      }
 } 
```

# sql - 查询三张表无输出

> ID：15467556
> 
> 赞同：2
> 
> 时间：2013-03-17T23:27:46.440
> 
> 标签：sql, sql-server, database

我有三个表，如下面的屏幕截图所示： ![数据集](../Images/4cc7277a5302c6251d8725bd220395b6.png)

但是当我想执行以下查询时，我没有得到任何结果，即使所有三个表中都有数据：

![询问](../Images/b2f621777a87175a886c72fde55d83cf.png)

这是生成的代码：

```
SELECT Clients.ClientID, Clients.FirstName, Clients.Surname, Clients.Internal, Clients.Organisation, Clients.LandlineNo, Clients.MobileNo, Clients.Address1, Clients.Town, 
              Clients.Postcode, Clients.Email, Clients.NHS, Clients.PurchaseOrderNumber, Bookings.Date, Bookings.Timebegan, Bookings.Timefinished, Bookings.Price, 
              Bookings.Repeats, Bookings.Rweeks, Bookings.Rdays, Bookings.Rmonths, Bookings.Occurrences, Rooms.Roomname
FROM     Clients INNER JOIN
              Bookings ON Clients.ClientID = Bookings.ClientID INNER JOIN
              Rooms ON Bookings.RoomID = Rooms.RoomID 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T00:13:21.943

```
Try

SELECT *
FROM     Clients LEFT OUTER JOIN
         Bookings ON Clients.ClientID = Bookings.ClientID 
         LEFT OUTER JOIN Rooms ON Bookings.RoomID = Rooms.RoomID 
```

请参阅[SQL Join 的可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)以更好地了解使用什么

如果性能是一个问题，还有其他一些方法。

# iphone - 为旧版 Xcode 集成 Facebook SDK 以支持 iOS 5 和 iOS 6

> ID：15467558
> 
> 赞同：2
> 
> 时间：2013-03-17T23:28:16.383
> 
> 标签：iphone, ios, facebook, facebook-ios-sdk

我仍在使用 XCode 4.3.2 和 iOS 5.1 基础 SDK。我想要实现的是为 iOS 5.0+ 设备集成 Facebook API。只是基本功能，例如代表发帖和获取基本用户信息。

我假设哪个 Facebook SDK 可以在 iOS 5 上运行，也可以在 iOS 6 上运行，但我不确定。

作为 Facebook 集成的新手，任何人都可以对这个问题有所了解。（因为我正在做这个项目，升级 XCode 和 iOS SDK 不是一个选项）

*   我应该研究哪个 iOS SDK？
*   我可以使用基本 SDK 5.1 和 XCode 4.3 同时支持 iOS 5 和 6 吗？
*   是否有支持两个 iOS 版本的 API？
*   Facebook 集成有什么要求吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T07:30:32.883

首先，您阅读了 Facebook 开发人员发布的这篇文章

[http://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/](http://developers.facebook.com/docs/getting-started/facebook-sdk-for-ios/)

在第 1 步中，它也适用于 xcode 4.3

你仔细阅读了所有步骤n实施

在第 6 步中，您在 Facebook Btn Pressed 的位置编写如下代码

```
 - (IBAction)facebookBtnPressed:(id)sender
{

        // if it is available to us, we will post using the native dialog
        BOOL displayedNativeDialog = [FBNativeDialogs presentShareDialogModallyFrom:self
                                                                        initialText:[NSString stringWithFormat:@"Here U write code which u want to post on facebook"]
                                                                              image:[UIImage imageNamed:@"1.jpg"]
                                                                                url:[NSURL URLWithString:@""]
                                                                            handler:nil];

        if (!displayedNativeDialog)
        {
            NSString *shareStr = [NSString stringWithFormat:@"Here U write code which u want to post on facebook"];
            NSMutableDictionary* params = [[NSMutableDictionary alloc] initWithObjectsAndKeys:
                                           shareStr,@"description",
                                           @"sharelink", @"link",
                                           @"ImageName", @"picture",
                                           nil];

            [self performPublishAction:^{

                [FBRequestConnection startWithGraphPath:@"me/feed" parameters:params HTTPMethod:@"POST" completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {

                    if (error)
                    {
                        NSLog(@"error in post");
                    }
                    else
                    {
                        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Success" message:@"Post Successfully" delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:nil];
                        [alert show];
                    }

                }];
            }];
        }
    //}

    //===set delagate in Viewcontroller.h of mySLComposerSheet
    [mySLComposerSheet setCompletionHandler:^(SLComposeViewControllerResult result) {
        NSString *output;
        switch (result) {
            case SLComposeViewControllerResultCancelled:
                output = @"Action Cancelled";
                break;
            case SLComposeViewControllerResultDone:
                output = @"Post Successfully";
                break;
            default:
                break;
        } //check if everything worked properly. Give out a message on the state.
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Facebook" message:output delegate:nil cancelButtonTitle:@"Ok" otherButtonTitles:nil];
        [alert show];
    }];
}

- (void) performPublishAction:(void (^)(void)) action {
    if ([[FBSession activeSession]isOpen]) {
        /*
         * if the current session has no publish permission we need to reauthorize
         */
        if ([[[FBSession activeSession]permissions]indexOfObject:@"publish_actions"] == NSNotFound) {
            [[FBSession activeSession] reauthorizeWithPublishPermissions:[NSArray arrayWithObject:@"publish_actions"]
                                                         defaultAudience:FBSessionDefaultAudienceOnlyMe
                                                       completionHandler:^(FBSession *session, NSError *error) {
                                                           action();
                                                       }];
        }else{
            action();
        }
    }else{
        /*
         * open a new session with publish permission
         */
        [FBSession openActiveSessionWithPublishPermissions:[NSArray arrayWithObject:@"publish_actions"]
                                           defaultAudience:FBSessionDefaultAudienceOnlyMe
                                              allowLoginUI:YES
                                         completionHandler:^(FBSession *session, FBSessionState status, NSError *error) {
                                             if (!error && status == FBSessionStateOpen) {
                                                 action();
                                             }else{
                                                 NSLog(@"error");
                                             }
                                         }];
    }
} 
```

# php - 如何在 PDO 中获取查询语句的类型？

> ID：15467561
> 
> 赞同：5
> 
> 时间：2013-03-17T23:29:00.727
> 
> 标签：php, mysql, pdo

在[MySQL Reference Manual](http://dev.mysql.com/doc/refman/5.6/en/sql-syntax.html)中，数据定义语句和数据操作语句之间存在区别。

现在我想知道查询是否插入数据库记录、更新一条、删除一条或修改表结构等等，或者更准确地说，是受影响行的确切数量，但前提是它适用。

例如，声明

```
SELECT *
FROM SomeTable
WHERE id=1 OR id=2 
```

返回许多受影响的行（在本例中为**2**），但使用该`SELECT`语句，数据库中没有任何修改，因此该数字将为**0**。

如何获取查询的类型？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-11-05T16:55:11.633

我一直在寻找相同的答案并偶然发现了 [这篇文章](http://www.kitebird.com/articles/php-pdo.html)。它最后一次更新是在八月。其中，有一个部分：“确定语句的类型”您基本上可以做出以下假设：（从文章中复制）

*   如果 columnCount() 为零，则该语句未生成结果集。相反，它修改了行，您可以调用 rowCount() 来确定受影响的行数。
*   如果 columnCount() 大于零，则语句生成结果集，您可以获取行。要确定有多少行，请在获取它们时对它们进行计数。

我会为您省去麻烦，只需在此处粘贴代码示例

```
$sth = $dbh->prepare ($stmt);
$sth->execute ();
if ($sth->columnCount () == 0)
{
    # there is no result set, so the statement modifies rows
     printf ("Number of rows affected: %d\n", $sth->rowCount ());
}
else
{
    # there is a result set
    printf ("Number of columns in result set: %d\n", $sth->columnCount ());
    $count = 0;
    while ($row = $sth->fetch (PDO::FETCH_NUM))
    {
    # display column values separated by commas
       print (join (", ", $row) . "\n");
       $count++;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-18T07:37:21.540

我一直在考虑同样的问题，并得出结论，在这件事上我不需要自动化。

这种自动检测的唯一用途是一些魔术函数，它将返回受影响的行数。但是这样的魔法，虽然在语法上加了点糖，但总是让代码支持成为一场噩梦：
当你调用一个函数时，它可以根据上下文返回不同类型的值，你无法分辨哪个是返回的每一个特定的时刻。因此，它使调试变得更加困难。

因此，为了便于阅读，只需调用适当的函数即可获得您目前需要的结果——ffectedRows 或 numRows。它不会使您的代码臃肿，但会使其更具**可读性。**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-09-28T01:33:11.527

我正在使用这个：

```
substr($statement->queryString, 0, strpos($statement->queryString, ' ')); 
```

其中 $statement 是一个 PDOStatement 对象，这里需要注意的一些事情是，在使用它之前，您应该验证 $statement 是一个 PDOStatement 对象，而且我们可能应该将 strpos 从 substr 语句中取出，以防 strpos 返回 false，这将可能会导致错误，最后，这只适用于单字语句类型，如 SELECT、INSERT 等，而不适用于多字语句类型，如 ALTER TABLE

# node.js - Array.push，数组保持为空

> ID：15467564
> 
> 赞同：3
> 
> 时间：2013-03-17T23:29:23.560
> 
> 标签：node.js, coffeescript, redis

我正在尝试从我的 redis 数据库中获取所有 hget 值。但阵列日志保持为空。请问各位大神可以看一下吗？谢谢

```
getAllHMSets = (cb) ->
  client.keys "log:*", (err, logKeys) ->
    if not err and logKeys isnt null
      logs = new Array()
      i = 0
      while i < logKeys.length
        client.hgetall logKeys[i], (err, log) ->
          if not err and log isnt null
            logs.push log
        i++

      if logs.length is logKeys.length
        cb logs  if typeof cb is "function" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T11:33:28.303

我认为您的代码有两个问题：

1.  你应该用更惯用的 CoffeeScript 来写它

2.  您对 hgetall 的调用也必须使用回调，否则您的数组将永远不会被填充。

```
getAllHMSets = (cb) ->
  client.keys "log:*", (err, logKeys) ->
    if not err and logKeys isnt null

      logs = []

      for value in logKeys
        client.hgetall logKeys[i], (err, log) ->
          if not err and log isnt null
            logs.push log
            if logs.length is logKeys.length
              cb logs  if typeof cb is "function" 
```

# assembly - 文件 IO 和缓冲区

> ID：15467570
> 
> 赞同：0
> 
> 时间：2013-03-17T23:30:09.007
> 
> 标签：assembly, file-io, 68000

我想从文件中读取数字，但是当我这样做时，是否将从文件中读取的所有内容都放入缓冲区？还是只有1个号码？文件将包含`5 6 7 10 9`

这就是我用来从文件中读取的内容：（EASy68K 程序）

```
 ORG    $1000
START:                  ; first instruction of program

    lea     filename,a1
    move #52,d0
    trap #15

    lea     buffer,a1
    move    #datasize,d2    # bytes to read
    move    #53,d0          read from file
    trap    #15

    SIMHALT             ; halt simulator

filename    dc.b    'test1.txt',0

    END    START        ; last line of source 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:16:47.503

那应该从 .`datasize`开始将字节读入内存`buffer`。加载多少数字取决于数字有多大以及有多大`datasize`。如果`datasize`是 1，那么它只会加载一个数字。如果`datasize`是 3，那么它将加载`5 6`.

假设我正确阅读了代码......已经有几年了。. .

# sql - 使用局部变量设置 NOCOUNT 状态

> ID：15467573
> 
> 赞同：2
> 
> 时间：2013-03-17T23:30:21.723
> 
> 标签：sql, sql-server, tsql, sql-server-2012-express

我正在尝试存储 NOCOUNT 状态，以便在我的过程结束时将其恢复到原始状态，但它所做的只是给我一个`Incorrect syntax near 'NOCOUNT'.`错误。

我究竟做错了什么？

```
IF @@OPTIONS & 512 <> 0     /* check original state of NOCOUNT */
      PRINT N'This user has SET NOCOUNT turned ON.';
  ELSE
      PRINT N'This user has SET NOCOUNT turned OFF.';

DECLARE @NCStat bit
    SET @NCStat = ( @@OPTIONS & 512 )   /* sets @NCStat to original state of NOCOUNT */

SET NOCOUNT ON ;

IF @@OPTIONS & 512 <> 0     /* verify state of NOCOUNT */
      PRINT N'This user has SET NOCOUNT turned ON.';
  ELSE
      PRINT N'This user has SET NOCOUNT turned OFF.';

PRINT N'NCStat = ' + cast(@NCStat as nvarchar) ;        /* verify value of @NCStat */

/* line 23 */  SET NOCOUNT  @NCStat ;       /* return NOCOUNT to original state */

IF @@OPTIONS & 512 <> 0     /* verify state of NOCOUNT */
      PRINT N'This user has SET NOCOUNT turned ON.';
  ELSE
      PRINT N'This user has SET NOCOUNT turned OFF.';
GO 
```

如果注释掉第 23 行，则所有其他行都可以正常工作，但第 23 行给出了上述错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:56:39.710

您不能使用变量来设置`NOCOUNT`：

```
/* line 23 */  SET NOCOUNT  @NCStat ; /* not legal syntax */ 
```

我会这样做：

```
/* line 23 */
if @NCStat = 1
    SET NOCOUNT ON
else
    SET NOCOUNT OFF 
```

# c - 为什么我的矩阵的最后一列没有打印出来？

> ID：15467575
> 
> 赞同：1
> 
> 时间：2013-03-17T23:30:52.967
> 
> 标签：c, multidimensional-array

我有一个`char`以列主顺序存储的 2x3 矩阵（是的，我知道这有点令人困惑，但请耐心等待），作为多维`char[3][2]`数组（注意索引的切换）。现在，我想打印这个矩阵。但是，由于某种原因，最后一列没有打印出来。这是为什么？

这是我的代码：

```
#include <stdio.h>

#define ARRAY_SIZE(x) ((sizeof (x)) / (sizeof((x)[0])))

typedef char matrix[3][2];

void print_matrix(matrix a)
{
    for (size_t i = 0; i < ARRAY_SIZE(a[0]); i++) {
        printf("[");
        for (size_t j = 0; j < ARRAY_SIZE(a); j++) {
            printf(" %c", a[j][i]);
        }   
        printf(" ]\n");
    }
}

int main(int argc, char *argv[])
{
    matrix a = {{'a','b'},{'c','d'},{'e','f'}};
    printf("sizeof(a) = %zu\n", ARRAY_SIZE(a));
    printf("sizeof(a[0]) = %zu\n", ARRAY_SIZE(a[0]));
    print_matrix(a);
    return 0;
} 
```

编译和运行给了我这个：

```
$ gcc -Wall -std=c99 foo.c; ./a.out
sizeof(a) = 3
sizeof(a[0]) = 2
[ a c ]
[ b d ] 
```

预期输出：

```
[ a c e ]
[ b d f ] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:53:27.303

这是因为你的功能是有效的：

```
void print_matrix(char a[3][2]) 
```

但这真的是：

```
void print_matrix(char (*a)[2]) 
```

因此，您的宏使用`sizeof`（您正在计算指针的大小和两个元素`char`数组的大小）产生错误的结果。如果将这两个值作为参数传递给函数并在循环中使用它们，它应该可以工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T23:54:24.477

添加：

```
printf("ARRAY_SIZE(a) = %zu\n", ARRAY_SIZE(a));
printf("ARRAY_SIZE(a[0]) = %zu\n", ARRAY_SIZE(a[0])); 
```

到`print_matrix`，你会看到问题：

```
ARRAY_SIZE(a) = 2
ARRAY_SIZE(a[0]) = 2 
```

您已经被 C 的一个奇怪的极端案例所困扰。多维数组并没有像它们看起来那样得到完全支持。特别是，将它们作为参数传递给函数并不会完全创建您期望的数据类型，因此 ARRAY_SIZE 宏不能在函数参数上正常工作。

幕后实际发生的事情很奇怪，我不确定我是否理解得足够好来真正解释它，但简短的版本是作为函数参数的数组退化为指针。所以函数参数 char a[3][2] 实际上变成了一个隐约相当于 char *a[2] 的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T20:13:43.307

sizeof 运算符不起作用，因为作为参数发送的数组被转换为指针并且发生了指针的衰减！所以在函数内部你不知道矩阵的大小。

# node.js - 从 node.js (msnodesql) 连接到 SQL-Azure 的“登录失败”

> ID：15467578
> 
> 赞同：0
> 
> 时间：2013-03-17T23:31:36.237
> 
> 标签：node.js, azure, odbc, azure-sql-database

我按照这里的教程在 Azure 上构建了一个连接到 SQL-Azure DB 的 node.js 网站：

[http://www.windowsazure.com/en-us/develop/nodejs/tutorials/web-site-with-sql-database/](http://www.windowsazure.com/en-us/develop/nodejs/tutorials/web-site-with-sql-database/)

这是我的 .js 代码的样子：

```
var sql = require('msnodesql'),
nconf = require('nconf');

exports.authenticate = function(req, res){

var select = "select userID, clientID from users where username_e = '?' AND pwd_e = '?'";
nconf.env().file({ file: 'config.json' });
var conn = nconf.get("SQL_CONN");
console.log(conn);

sql.query(conn, select, [req.param('username'), req.param('password')], function(err, results) {
    if(err)
        throw err;
    console.log(results);

    if(results.length == 0) {
        // no match
        res.redirect('/login?failed=true');
    } else {
        // authenticated
        res.redirect('/start');
    }
});
return; 
```

};

但是当我在本地 node.js 上运行它时，我不断得到

```
"Login failed for user 'mylogin'" 
```

*   我直接从 Azure 管理站点复制了 ODBC 连接字符串
*   我用我的密码替换了 {your password here}
*   我四次检查用户名和密码是否正确（我可以成功登录管理工具，并且可以通过本地 SQL Server Management Studio 连接到数据库）
*   我为我的公共 IP 地址添加了一个 IP 例外，这是一个很好的衡量标准
*   我尝试在这里和那里编辑连接字符串（将用户名更改为 mylogin 而不是 mylogin@server，尝试使用 ADO 连接字符串代替）

我还能够使用 jdbc 在 Java 中成功连接。这是有效的 jdbc 连接字符串：

```
jdbc:sqlserver://xxxmyserver.database.windows.net:1433;DatabaseName=mydb;user=mylogin@xxxmyserver;password=pwd 
```

这是不起作用的 node.js ODBC 连接字符串：

```
Driver={SQL Server Native Client 10.0};Server=tcp:xxxmyserver.database.windows.net,1433;Database=[mydb];Uid=mylogin@xxxmyserver;Pwd=pwd;Encrypt=yes;Connection Timeout=30; 
```

我在这里完全不知所措，特别是因为我可以使用 SSMS 从本地连接良好。还有其他人遇到同样的问题吗？

万一这很重要，我使用的是 node.js v0.8.2（因为那是 Azure 虚拟机上的内容）和 msnodesql v0.2.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-17T19:53:08.127

对于遇到此问题并且即使在取出方括号后仍然遇到问题的其他人，您需要在 Azure 管理门户中设置一个标志，以使其他 Azure 服务能够连接到您的 Azure SQL 数据库。为了增加混淆，当您第一次创建它时，它会将您的 IP 地址添加到列表中，这就是为什么您似乎能够从您的开发机器但不能从您的 Azure 实例连接到它的原因。

无论如何，要做到这一点，请进入 Azure 管理门户中的数据库设置，转到“允许的 IP 地址”并在底部允许的服务下启用“Windows Azure 服务”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T22:55:05.023

尝试不带问号参数引号的查询。

```
var select = "select userID, clientID from users where username_e = ? AND pwd_e = ?"; 
```

字符串（或任何类型的）参数不需要引号。参数是带外发送的，而不是直接替换到查询中。这就是使它们更加安全的原因，因为它们从不使用 SQL 进行评估。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T03:09:53.580

问题出在我的连接字符串的数据库部分 - 数据库名称周围的方括号导致了问题。Azure 告诉您使用的 ODBC 连接字符串如下所示：

```
Driver={SQL Server Native Client 10.0};Server=tcp:xxxmyserver.database.windows.net,1433;Database=[mydb];Uid=mylogin@xxxmyserver;Pwd=pwd;Encrypt=yes;Connection Timeout=30; 
```

相反，当您需要使用它时：

```
Driver={SQL Server Native Client 10.0};Server=tcp:xxxmyserver.database.windows.net,1433;Database=mydb;Uid=mylogin@xxxmyserver;Pwd=pwd;Encrypt=yes;Connection Timeout=30; 
```

请注意数据库名称周围缺少方括号。

这看起来像是 Azure 管理工具中的一个错误，有望很快消失。希望这可以节省其他人几个小时的调试时间。

# dart - Dart 组件不起作用 - 为什么我的设置错误？

> ID：15467580
> 
> 赞同：1
> 
> 时间：2013-03-17T23:31:39.393
> 
> 标签：dart, dart-webui, dart-editor

所以我让一些 Dart 项目正常工作。但是当我尝试使用 web-ui 时，没有任何效果。我导入了我想的东西，有什么问题？

所以这里是代码（它是一个从 git 中获取的例子）。

项目.html：

```
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <title>Shout This!</title>
    <link rel="stylesheet" href="project.css">
  </head>
  <body>
    <h1>Shout This!</h1>

      <input type="text" bind-value="shoutThis" placeholder="Shout This!">

      <div>      Length: {{ shoutThis.length }} </div>
      <div>     Shouted: {{ shoutThis.toUpperCase() }} </div>
      <div>   Substring: {{ (shoutThis.length >= 6) ?
                         shoutThis.substring(1, 5) :
                         shoutThis.substring(0, 0) }} </div>
      <div> Palindromic: {{ palindrome() }} </div>

    <script type="application/dart" src="project.dart"></script>
    <script src="packages/browser/dart.js"></script>
  </body>
  </html> 
```

项目飞镖：

```
 import 'dart:html';
  import 'package:web_ui/web_ui.dart';
  import 'package:web_ui/watcher.dart' as watchers;

  String shoutThis='';

  void main() {
    window.alert('test');
  }

  String palindrome() {
    var buffer = new StringBuffer(shoutThis);
    for (int i = shoutThis.length - 1; i >= 0; i--) {
      buffer.write(shoutThis[i]);
    }
    return buffer.toString();
  } 
```

当我启动项目时，我的测试消息出现了，但是 web ui 不起作用，我得到了这个：{{ sayThis.length }} 以文本形式显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T19:21:01.760

单击（运行）“out”目录中的 html 文件，而不是您正在编辑的源文件。请记住，您当时已选择构建/启动文件。

确保您也事先创建了 build.dart 文件。

# asp.net - 从远程 SQL 数据库创建产品列表

> ID：15467581
> 
> 赞同：0
> 
> 时间：2013-03-17T23:32:08.503
> 
> 标签：asp.net, vb.net

## 问题：

我是 ASP.Net 的新手，我需要一些指导，从哪里开始，做什么？我已经阅读了我在不同网站上找到的几篇文章。但是，有些人没有使用 VB 代码，我对自己的 C# 编码知识没有信心。

我已经包含了我的数据库中的一个表和一个 PHP 代码，以帮助可视化我想要创建的内容。

## 我的桌子

```
 ------------------------------------------------------------------------------------------
    |  items_id   |  items_name  |      items_description     | items_price | items_quantity |
    ------------------------------------------------------------------------------------------
    |     1       |    Spoon     |       Shiny and Silver     |     50      |       20       |
    |     2       |     Fork     |       Shiny and Silver     |     50      |       20       |
    |     3       |    China     |      Clean and Polished    |     90      |       20       |
    ------------------------------------------------------------------------------------------ 
```

## PHP 代码

```
 $sql = mysql_query("SELECT * FROM tbl_items");
    $productCount = mysql_num_rows($sql); 
    if ($productCount > 0) {
        while($row = mysql_fetch_array($sql)){ 
                 $id = $row["items"];
                 $name = $row["items_name"];
                 $description = $row["items_description"];
                 $price = $row["items_price"];
                 $quantity = $row["items_quantity"];
                 $check_pic = 'venues/'.$id.'/'.$id.'.jpg';
                if (file_exists($check_pic)) {
                    $img_src = 'venues/'.$id.'/'.$id.'.jpg';
                    } else {
                    $img_src = 'venues/0/0.jpg'; 
                }

                 $dynamicList .= '<li class="span3">
                    <div class="thumbnail">
                        <p><b>'.$name. '</b></p><br />
                       <img src="'.$img_src.'" alt="" style="box-shadow: 0 2px 3px rgba(0,0,0,0.2);">
                      <div class="caption">
                         <p align="center" class="lead" style="color:#053750;"> '.$venue.'</p> 
                          <hr />
                        <p><b>Description: </b> '.$description. '</p><br />
                        <p><b>Price: </b> '.$price. '</p><br />
                        <p><b>Quantity: </b> '.$quantity. '</p><br />
                        <p><a href="items_details.php?items_id='.$id.'" class="btn btn-info btn-block">Choose</a> </p>
                      </div>
                    </div>
                  </li>';
        } 
```

### 我读过的一些文章：

[第 4 部分：列出产品](http://www.asp.net/web-forms/tutorials/tailspin-spyworks/tailspin-spyworks-part-4)- ASP 部分非常易于理解，但我不知道如何将它与数据库的连接替换为 ODBC。

[将通用列表绑定到中继器 - ASP.NET](https://stackoverflow.com/questions/674204/binding-a-generic-list-to-a-repeater-asp-net) - 后面的代码是 C#，即使在 C# 到 VB 转换器的帮助下，我也很难转换

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:47:24.553

从 PHP 代码到 .NET 代码的最直接映射是使用这样的库： [http ://www.mysql.com/products/connector/](http://www.mysql.com/products/connector/)

使用 MySqlConnection 类连接到您的数据库服务器，使用 MySqlCommand 类来构建您的查询，并使用 MySqlDataReader 来迭代结果并构建您的标记。

这将使您启动并运行，然后如果您想研究 .NET 与中继器或其他控件的绑定，您可以从那里开始工作。

# javascript - 为每个新添加的元素提供 id？

> ID：15467582
> 
> 赞同：2
> 
> 时间：2013-03-17T23:32:12.017
> 
> 标签：javascript, jquery

我正在尝试捕获用户选择的文本，然后将其附加到可选区域下方。我通过捕获`copy`事件来做到这一点：

```
$("p").on("copy", highlight);

function highlight() {
    var text = window.getSelection().toString();
    var selection = window.getSelection().getRangeAt(0);
    var selectedText = selection.extractContents();
    var span = $("<span class='highlight'>" + selectedText.textContent + "</span>");
    selection.insertNode(span[0]);
    if (selectedText.childNodes[1] != undefined) {
        $(selectedText.childNodes[1]).remove();
    }
    var txt = $('#Text').html();
    var re = new RegExp("<\/span>(?:\s)*<span class='highlight'>","g");
    $('#Text').html(txt.replace(re, ''));
    $("#output").append("<li>" + text + "</li>");
    clearSelection();
}

function clearSelection() {
    if (document.selection) {
        document.selection.empty();
    } else if (window.getSelection) {
        window.getSelection().removeAllRanges();
    }
} 
```

当所选文本与当前可能突出显示的文本重叠时，这也会处理文本的突出显示。然后，我通过以下方式将所选文本附加到可选区域下方：

```
$("#output").append("<li>" + text + "</li>"); 
```

这样做的问题是，如果用户选择了一些文本，然后选择了该文本的一部分，它将附加下面的每个部分（应该如此）。这就是我的意思（括号表示选定的文本）：

```
Suspendisse [dictum] feugiat nisl ut dapibus. 
```

将在下面附加`dictum`：

```
[Suspendisse [dic]tum] feugiat nisl ut dapibus. 
```

将在下面附加`Suspendisse dic`。

这是标准的，但会导致在下方添加突出显示区域的多个部分，同时将它们合并到可选文本中。

**那么**，如何合并下面附加的文本，使其模仿合并的突出显示文本？

我发布的代码的一个活生生的例子在这里：http: [//jsfiddle.net/charlescarver/FLwxj/77/](http://jsfiddle.net/charlescarver/FLwxj/77/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T00:47:47.567

这是实现这一目标的一个选项。我不会声称这是最好或最有效的方法，但它确实有效。

从您的 Javascript 中替换这一行：

```
$("#output").append("<li>" + text + "</li>"); 
```

使用这些代码行：

```
$('#Text').html($('#Text').html().replace(/<\/span><span class="highlight">/g, ''));
$('#output').html('');
$('#Text span.highlight').each(function() {
   $('#output').append("<li>" + $(this).text() + "</li>"); 
}); 
```

这是您的 Fiddle 的一个[分支，](http://jsfiddle.net/jvanscoy/EtFjD/)它显示了这一点。

# oracle - oracle sql中的求和和条件

> ID：15467583
> 
> 赞同：-1
> 
> 时间：2013-03-17T23:32:12.360
> 
> 标签：oracle

您好，我需要有关此查询的帮助我有以下数据

```
Part   OderQty ShippedQty  QOH
10510   10          5       10
10510   10          0       10
10510   10          0       10
10511   10          10      20
10511   20          0       20 
```

我需要过滤 OrderQty 的总和 - 已发货数量的总和 < QOH。例子：

```
Part 10510
total sum Ordered: 30
total sum Shipped: 5
Balance: 25
QOH: 10 
```

我需要条件类似于 10510 部分的所有部分，第二个部分编号很好，因为我需要 30 个，发货 10 个，手头有 20 个，你如何为 oracle 编写这个查询，

谢谢ld

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T05:51:40.867

```
select part 
from your_table
group by part
having 
  sum(OrderQty) - sum(ShippedQty) < max(QOH) 
```

# navigation - FlexSlider 2 controlNav 错误

> ID：15467585
> 
> 赞同：1
> 
> 时间：2013-03-17T23:32:18.773
> 
> 标签：navigation, controls, thumbnails, flexslider, manual

我目前正在尝试为 FlexSlider 设置自定义缩略图导航，并且我正在使用以下代码，根据官方 flexslider 文档，我认为这是正确的：

```
$(document).ready(function(e) {
  $('.flexslider').flexslider({
    animation: "slide",
    controlsContainer: ".flex_thumbs",
    controlNav: true,
    manualControls: ".custom_controls li img",
    animationSpeed: 1200,
  }); 
}); 
```

问题是当我运行我的页面时，我在控制台日志中遇到以下错误：

> a.controlNav.live 不是函数

当然，我的自定义缩略图不起作用。

有没有人遇到过这个特定的错误？我尝试在线搜索，但找不到此特定问题的任何答案。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T09:30:27.313

我也刚遇到这个问题。你在使用 jQuery 1.9 吗？

jQuery 版本 >=1.9.x 已放弃对 .live 方法的支持，因此必须使用 .on 。

[https://github.com/woothemes/FlexSlider/pull/597](https://github.com/woothemes/FlexSlider/pull/597)

我把我的改回 jquery 1.8.3，它现在可以工作了。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-11T15:38:27.787

如果你仍然有这个问题，解释如下：

不推荐使用jQuery 方法`.live()`，如果由于某种原因您必须坚持使用您正在使用的 flexslider 版本，您可以通过查看 flexslider js 代码并将任何出现的方法替换为方法来解决`.live`问题`.on`。寻找`.live(`所以你得到的方法不是其他变量或其他东西，然后用它替换它，`.on(`你应该已经准备好了。

# javascript - 为什么这个回调没有异步调用

> ID：15467586
> 
> 赞同：0
> 
> 时间：2013-03-17T23:32:21.393
> 
> 标签：javascript, callback

单击开始挂钩按钮时会立即调用函数 asyncMsg。仅当用户单击按我按钮时，如何更改为调用。我需要将 2 项数据传递到此回调中。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<script type="text/javascript">

function bindEvent(el, eventName, eventHandler) {
   if (el.addEventListener){
      el.addEventListener(eventName, eventHandler, false); 
   } else if (el.attachEvent){
      el.attachEvent('on'+eventName, eventHandler);
   }
}

function asyncMsg(data, fldid) {
   alert("asynchronous message with param1=" + data + " param2=" + fldid);
}

function dohooking() {
   var toinsert = "Duck";
   var fldid = "10";
   var btn = document.getElementById("hookee");
   bindEvent(btn, 'click', asyncMsg(toinsert, fldid));
}

</script>

<title></title>

</head>
<body>

<input type="button" id="sethooking" value="start hooking" onclick="dohooking();">
<br />

<input type="button" id="hookee" value="press me">
<br />

</body>
</html> 
```

我可以看到如果我只是传递函数，如下所示：

```
bindEvent(btn, 'click', asyncMsg); 
```

然后它被异步调用，但是我该如何传递这两个参数呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:36:39.180

您立即调用函数，而不是将函数本身传递给函数 - 因为调用函数是在函数上使用“运算符”`bindEvent`时发生的事情。`()`

你想要的是这样的：

```
bindEvent(btn, 'click', asyncMsg.bind(null, toinsert, fldid)); 
```

函数的[`bind()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)方法返回另一个可调用函数，它将使用给定的上下文（`null`在本例中）和提供的参数执行函数。

另一个也适用于旧版浏览器的选项是创建一个匿名函数，然后调用您的函数：

```
bindEvent(btn, 'click', function() {
    asyncMsg(toinsert, fldid);
}); 
```

# android - 快速检测预付卡号码的方法

> ID：15467587
> 
> 赞同：0
> 
> 时间：2013-03-17T23:32:25.120
> 
> 标签：android, opencv, image-processing, computer-vision, ocr

我正在尝试检测 Vodafone 等预付卡上的号码。我正在寻找一种快速且简单的方法来做到这一点。所以我打算使用Fast CV，因为它是为支持霓虹灯的ARM优化的，而且还想用字符对预定义的图像做一个简单的NCC，而不是实时检测图像，只是想捕捉图像然后进行分析。我想知道从卡中检测字符的过程。它只是简单的阈值，找到轮廓吗？

# php - jquery附加形式的php变量

> ID：15467588
> 
> 赞同：0
> 
> 时间：2013-03-17T23:32:25.430
> 
> 标签：php, jquery

我在通过小书签附加的表单内的页面上获取可用的 php 变量时遇到问题

书签代码：

```
<a class="bookmarklet" href="javascript:(function(){var%20script=document.createElement('script');script.src='http://webcreationcentre.com.au/manage/manage.js';document.body.appendChild(script);})()">title checker</a> 
```

manage.js 代码：

```
(function(){

// the minimum version of jQuery we want
var v = "1.3.2";

// check prior inclusion and version
if (window.jQuery === undefined || window.jQuery.fn.jquery < v) {
    var done = false;
    var script = document.createElement("script");
    script.src = "http://ajax.googleapis.com/ajax/libs/jquery/" + v + "/jquery.min.js";
    script.onload = script.onreadystatechange = function(){
        if (!done && (!this.readyState || this.readyState == "loaded" || this.readyState == "complete")) {
            done = true;
            initMyBookmarklet();
        }
    };
    document.getElementsByTagName("head")[0].appendChild(script);
} else {
    initMyBookmarklet();
}

function initMyBookmarklet() {
    (window.myBookmarklet = function() {

    var title = '<?php echo $data->title; ?>';
    alert(title);

    $('body').append($('<div></div>').css('width','100%')
        .append($('<form></form>')
        .append($('<label for="title">Title</label>'))
        .append($('<input type="text" name="title" value="<?php echo $data->title; ?>">'))));
        // your JavaScript code goes here!
    })();
}

})(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:39:45.500

如果您的 JS 只是在一个名为的静态文件中，`manage.js`那么 PHP 将永远不会处理它，因此简单地添加`<?php ... ?>`到它不会做任何有用的事情。

如果它*是*由PHP 处理的（例如它*实际上*`manage-js.php`是PHP 关心）因此必须在生成 JS 的 PHP 文件中进一步定义，并且对您运行小书签的位置一无所知。*`$data->title`*

# jpf - 使用验证 API 时如何获取 jpf 启发式实时计数

> ID：15467594
> 
> 赞同：0
> 
> 时间：2013-03-17T23:33:14.760
> 
> 标签：jpf

我正在使用类似的东西

int y = Verify.getIntFromList(intArray); boolean z = Verify.getBoolean();

//对y和z做一些事情，即y和z的所有可能排列等。

我有兴趣获得 jpf 的实时计数，因为它通过每个排列。例如，如果 intArray 中有 10 个 int，并且我们知道 boolean 的 false 和 true，那么总共会有 20 个排列。但我想要实时计数，因为它正在逐个遍历所有 20 个。想在我的程序中使用这个实时计数。

希望我已经清楚地解释了我想做什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T19:23:07.077

在上述陈述之前，请致电 Verify.setCounter(0,0); 每次调用Verify.getXXX() 调用Verify.incrementCounter(0,1);

counter 语句中的第一个参数是计数器索引，您可以定义多个计数器并根据您的逻辑递增每个计数器。

计数器类似于 JPF 的静态变量。

# jquery - 复选框 jQuery 操作

> ID：15467595
> 
> 赞同：0
> 
> 时间：2013-03-17T23:33:17.303
> 
> 标签：jquery

我试图在按钮单击时操作一系列复选框，但我似乎无法弄清楚如何去做。我需要实现以下操作：

1.  选中所有复选框

2.  选择复选框 1-12

3.  选择奇数复选框

4.  选择偶数复选框

5.  清除复选框

6.  控制滑块范围以选择周

一直在更新复选框。

这是我的 jsFiddle：http: [//jsfiddle.net/dYsg7/](http://jsfiddle.net/dYsg7/)

最初，我使用以下代码来满足第 1-5 点，但由于我更改了复选框的布局，我无法弄清楚如何在我的新设计中实现它：

```
 $('#week_none').click(function () {
        $('#week_boxesForm li').each(function (index) {
            $(this).find('input:checkbox').prop("checked", false);
        });
    });

    $('#week_all').click(function () {
        $('#week_boxesForm li').each(function (index) {
            $(this).find('input:checkbox').prop("checked", true);
        });
    });

    $('#week_term').click(function () {
        $('#week_boxesForm li').each(function (index) {
            if (index < 12) $(this).find('input:checkbox').prop("checked", true);
            else $(this).find('input:checkbox').prop("checked", false);
        });
    });

    $('#week_odd').click(function () {
        $('#week_boxesForm li').each(function (index) {
            if (index % 2 === 0) $(this).find('input:checkbox').prop("checked", true);
            else $(this).find('input:checkbox').prop("checked", false);
        });
    });

    $('#week_even').click(function () {
        $('#week_boxesForm li').each(function (index) {
            if (index % 2 !== 0) $(this).find('input:checkbox').prop("checked", true);
            else $(this).find('input:checkbox').prop("checked", false);
        });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:45:50.103

以下是第 1 - 6 点的操作方法：

**Javascript**

```
$(".slider_weekRange2").slider({
    range: true,
    min: 1,
    max: 15,
    step: 1,
    values: [1, 12],
    slide: function (event, ui) {
        $(".search_weekRange2").val(ui.values[0] + "-" + ui.values[1]);
        $('input:checkbox[name="weeks_1"]').prop("checked", false);
        $('input:checkbox[name="weeks_1"]').slice(ui.values[0] - 1, ui.values[1]).prop("checked", true);
    }
});

$(".search_weekRange2").val($(".slider_weekRange2").slider("values", 0) +
    "-" + $(".slider_weekRange2").slider("values", 1));

$('.week_none').on('click', function () {
    $('input:checkbox[name="weeks_1"]').prop("checked", false);
});

$('.week_all').on('click', function () {
    $('input:checkbox[name="weeks_1"]').prop("checked", true);
});

$('.week_term').on('click', function () {
    $('input:checkbox[name="weeks_1"]').prop("checked", false);
    $('input:checkbox[name="weeks_1"]').slice(0, 12).prop("checked", true);
});

$('.week_odd').on('click', function () {
    $('input:checkbox[name="weeks_1"]').prop("checked", false);
    $('input:checkbox[name="weeks_1"]:even').prop("checked", true);
});

$('.week_even').on('click', function () {
    $('input:checkbox[name="weeks_1"]').prop("checked", false);
    $('input:checkbox[name="weeks_1"]:odd').prop("checked", true);
}); 
```

**[演示](http://jsfiddle.net/dYsg7/3/)**

# android - Android Shell 命令在启动时执行

> ID：15467601
> 
> 赞同：0
> 
> 时间：2013-03-17T23:34:16.820
> 
> 标签：android, root

在一个 Android 应用程序中，我正在尝试开发该应用程序在启动时通过 Receiver`onReceive()`方法中的两个函数运行命令运行一些 shell 命令，但我有两个问题：

1.  第一个函数通过三个调用执行三个单独的命令`executeCommand()`，但由于在我的`executeCommand()`函数的代码中包含`Process.waitFor()`，接收器中的某些内容超时并且并不总是执行所有命令。
2.  第二个函数命令应该在前面三个 shell 命令执行并返回结果之后执行，这不会发生。如果我删除了`Process.waitFor()`所有执行的命令，但是由于第一个命令还没有返回结果，所以它们的行为是错误的。

有没有办法延长等待时间？只运行一个连续的命令而不是三个单独的命令将减少总时间`Process.waitFor()`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T02:47:09.720

[BroadcastReceiver 文档](http://developer.android.com/reference/android/content/BroadcastReceiver.html)特别建议不要在`onReceive()`调用的主线程上执行长时间运行的命令。更好的解决方案是创建一个[`IntentService`](http://developer.android.com/reference/android/app/IntentService.html)来处理 shell 命令并按顺序执行它们。这不会阻止，`BroadcastReceiver`甚至应该提高启动速度。

# python - pyusb：功能一次运行良好，第二次失败

> ID：15467607
> 
> 赞同：1
> 
> 时间：2013-03-17T23:34:49.800
> 
> 标签：python, usb, raspberry-pi, pyusb, raspbian

我有一个树莓派（我使用的是 linux）和一个测量一些值的设备。

我有一个 python 服务器，当客户端发送“我想要值”命令时，我会询问设备一些值。这是我的设备的功能：

```
def usbDevice:
      dev = usb.core.find(idVendor=0xXXXX, idProduct=0xXXXX)
      if dev is None:
         return 'Not found'
      dev.set_configuration()
      dev.write(1, '\x05', 0) # ask for the values
      time.sleep(2)
      ret = dev.read(0x81,2048 , 0,1200) # endpoint, siz, interf, timeout ->meas. vals
      print ret
      return ret 
```

当我开始通信时它总是很顺利（两种方式，我发送命令并得到正确的响应......）。但是，我第二次尝试它（无论我是否等待太久）我没有得到设备的响应。我知道我可以发送请求（我使用打印“步骤 XX”来查看失败的位置），但我没有得到任何答案......我通常会收到超时异常，但有时会收到“资源繁忙”异常。

第一次使用后是否应该关闭usb通讯？如何？尽管如此，我总是使用 sudo 权限进行编译，但我创建了一个 .rules 文件，所以我认为没有问题。

除此之外，我真的很想知道这种建立USB通信的方式是否有问题，因为我过去使用过类似的东西。（而且我不擅长python...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T00:59:06.013

您能否提供其他信息，例如 linux 发行版和内核编号，例如

```
 uname -a 
```

存在[已知的 USB 问题](https://stackoverflow.com/questions/14736270/raspberry-pi-usb-redirect-issue/14866397#14866397)。好消息是[最近的修复](http://www.raspberrypi.org/phpBB3/viewtopic.php?f=28&t=23544&start=200)可能已经解决了这些问题。基本上，使用[rpi-update](https://github.com/Hexxeh/rpi-update)它应该更新内核（你至少需要#389）。

# javascript - jQuery 日期/时间选择器未通过 .serialize() 进行序列化）

> ID：15467609
> 
> 赞同：2
> 
> 时间：2013-03-17T23:35:23.617
> 
> 标签：javascript, jquery

我在[这里使用 jQuery 日期/时间选择器显示](http://trentrichardson.com/examples/timepicker/)，我有它的形式。当按下提交按钮时，我序列化表单并将序列化保存到 localStorage。

IE

```
localStorage.form_data = $('myform').serialize(); 
```

除了使用 jQuery 日期/时间选择器的表单输入之外，我的一些表单数据显示在序列化字符串中，有人知道为什么吗？或者如果有解决方法..

我可以使用我自己的序列化方法解决它，但我很好奇 .serialize() 和 .serializeArray() 何时崩溃......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:48:54.727

对于要包含在序列化字符串中的表单元素的值，该元素必须具有 name 属性。来自复选框和单选按钮（“单选”或“复选框”类型的输入）的值仅在它们被选中时才被包括在内。来自文件选择元素的数据未序列化。

文档 - [http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

注意 - 确保所有元素都有一个名称属性

# c++ - 期货、承诺和例外

> ID：15467610
> 
> 赞同：6
> 
> 时间：2013-03-17T23:35:25.770
> 
> 标签：c++, asynchronous, c++11

```
std::promise<int> p1;
auto f = p1.get_future();

{
    std::promise<int> p2(std::move(pr));
}

bool valid = f.valid(); // true
f.wait(); // does not throw, or fail, but returns immediately
f.get(); // throws an exception 
```

有没有办法在调用之前检查未来是否会抛出`get`？我希望`valid`会检查...我不太确定如何`valid`返回 false。`promise`在不设置值的情况下销毁它是行不通的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T00:15:19.993

> 有没有办法在调用 get 之前检查未来是否会抛出？

不，因为这在某种程度上等于接收未来存储的值。

> 我希望valid会检查......我不太确定如何让valid返回false。

如果未来引用只能由或创建的共享状态`std::async`，则 Valid 将返回 true 。一个反例是默认构造的。一旦您调用或在有效（有效==真）未来一次，有效也将是错误的。在无效（有效 == 假）的未来 调用任何其他函数或移动赋值运算符是 UB。`std::packaged_task``std::promise``std::future``get``share`
`valid`

> 在不设置值的情况下破坏承诺是不行的。

不，如上所述，这不是有效的点，因为未来仍然指的是共享状态，只是另一方 - 承诺 - 没有实现。如果在销毁 Promise 时没有设置任何值或异常，则会设置一个异常来指示已损坏的 Promise。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T11:27:08.197

> 有没有办法在调用 get 之前检查未来是否会抛出？

您的问题相当于：
有没有办法在调用函数之前检查*函数*是否会抛出？

总的来说，这两个问题的答案是否定的。

考虑：

```
int func_that_might_throw()
{
  if (rand() % 2)
    throw 1;
  return 0;
}

std::future<int> f = std::async(&func_that_might_throw);

int result = f.get(); 
```

该`async`调用可能会返回一个延迟函数，在这种情况下，该函数甚至在您调用 之前都不会运行`get()`，因此通常无法提前判断结果是值还是异常。（您可以通过调用来检测延迟函数`f.wait_for(std::chrono::seconds(0))`，但`async`可能不会返回延迟函数，在这种情况下，当您尝试检查它是否有存储的异常时，该函数仍可能异步运行，因此您必须检查它是否准备好并且有一个存储的异常，所以检查变得非常混乱。）

具有共享状态且就绪的有效`future`状态具有结果，该结果可以是值，也可以是异常。两者都是有效的结果。如果您不想处理异常，则应首先确保未在共享状态下设置异常。

# mysql - SQL CSV 跨表导入/导出发布数据

> ID：15467611
> 
> 赞同：0
> 
> 时间：2013-03-17T23:35:32.523
> 
> 标签：mysql, sql, import, export, multiple-tables

我需要：

连接来自多个表的 wordpress 数据，以便与每个帖子有关的所有数据都驻留在单行上以导出到 CSV。

和

在导入 CSV 期间将数据拆分回各个表。

我相信这可以通过 2 个 mySQL 查询来完成。

我的目的是导出数据、操作单元格值并添加新行，以便批量编辑和创建新的 wp 帖子。

到目前为止，我已经明白我可以非常明确地整理数据以进行导出，如下所示：

```
SELECT DISTINCT
  ID, post_author, post_content, post_title
  ,(SELECT meta_value 
    FROM wp_postmeta
    WHERE wp_postmeta.meta_key = 'wpcf-album-title'
      AND wp_postmeta.post_id = wp_posts.ID
   ) as "wpcf-album-title"
,(SELECT id FROM wp_geo_mashup_locations, wp_geo_mashup_location_relationships WHERE wp_geo_mashup_locations.id = wp_geo_mashup_location_relationships.location_id AND wp_geo_mashup_location_relationships.object_id = wp_posts.ID) as "id"
FROM wp_posts
WHERE post_type = 'post' 
ORDER BY
 ID, post_author, post_content, post_title
INTO OUTFILE '/tmp/test.csv'
FIELDS TERMINATED BY ','
ENCLOSED BY '~'
LINES TERMINATED BY '\n' 
```

上面给了我一个选择并导出到 CSV 文件。

我如何以另一种方式返回，将数据拆分回表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:35:07.010

它看起来像是`wp_geo_mashup_location_relationships.location_id`一个有效表中的一个有效字段（最后在这里找到它[http://psc.apl.washington.edu/wordpress/wp-content/uploads/_people/PSCAdmin-migrate-5cb4d.sql](http://psc.apl.washington.edu/wordpress/wp-content/uploads/_people/PSCAdmin-migrate-5cb4d.sql)），所以.. .

`wp_geo_mashup_location_relationships`您需要通过将表包含在子句中来让 SQL 知道该表`FROM`，否则您将收到该错误。

```
,(SELECT lat 
  FROM wp_geo_mashup_locations, wp_geo_mashup_location_relationships
  WHERE wp_geo_mashup_locations.id = wp_geo_mashup_location_relationships.location_id
    AND wp_geo_mashup_location_relationships.object_id = wp_posts.ID
 ) as "lat" 
```

# canvas - 控制由其他画布库创建的外来对象

> ID：15467612
> 
> 赞同：2
> 
> 时间：2013-03-17T23:35:37.417
> 
> 标签：canvas, 3d, 2d, three.js, paperjs

我想知道是否可以使用 paper.js 创建 2D 元素并让它们生活在共享画布上，并由 three.js 在 3D 空间中移动？

我在某处读到 2d 元素可以应用于 3d 面，我不知道这是否仅限于图像或其他“平面”元素。

我需要在画布、表单、按钮、统计信息等中创建界面元素。它用于推文可视化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:37:17.637

是的，可以在 three.js 网格中使用画布作为纹理。例如，请参阅：

[http://stemkoski.github.com/Three.js/Texture-From-Canvas.html](http://stemkoski.github.com/Three.js/Texture-From-Canvas.html)

有关纹理重复更新的示例，请参见：

[http://stemkoski.github.com/Three.js/Texture-Animation.html](http://stemkoski.github.com/Three.js/Texture-Animation.html)

# angularjs - 内部通信（向控制器提供服务的指令）

> ID：15467615
> 
> 赞同：2
> 
> 时间：2013-03-17T23:36:10.140
> 
> 标签：angularjs

我正在开发一个多文件上传模块，但在不使用`$rootScope`.

指令监视文件输入并将文件`onchange`交给服务，在那里它们被上传并监控上传进度。根据响应（来自成功、错误和进度更改），父控制器应显示拇指和进度。

我不想在我的 上使用`$emit`and ，因为我需要经常安静的模式并且只有一个父控制器需要知道上传。`$on``$rootScope`

我创建了一个简化的（！）**[Plunkr](http://plnkr.co/edit/46ERnMyb7n2LBzqTn9IM?p=preview)**，其中包含一些附加信息，以更好地理解问题。

我的控制器是否有另一种方式来响应更改（发生在服务工厂内）？
或者也许是一种完全不同的方式来实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T01:09:17.677

使用 Angular 处理异步操作的正确方法是使用[promises](http://docs.angularjs.org/api/ng.%24q)。

您可以从服务调用中返回一个承诺并将其解析为`src`拇指。然后，您根本无法使用指令。

您的控制器将以这种方式使用该服务：

```
function ParentController($scope, imageService) {
  $scope.change = function() {
    $scope.src = imageService.change();

    $scope.then(function(result) {
      // the loading ended, but there is no need to set the src
      // as it will already bind to src when ends. 
    }, function(err) {
      // something went wrong
    });
  };
 } 
```

您的服务：

```
app.factory('imageService', function($q, $rootScope) {

  function doTheUploading(defer) {
    if (everythingOk) {
      defer.resolve(thumbSrcString); 
    } else {
      defer.reject({something: 'an error ocurred'});
    }
  }

  return {
    change: function() {
      // creates the promise
      var defer = $q.defer();
      doSomethingAsync(defer);
      return defer.promise;
    }
  };

}); 
```

至少，您的 HTML 应该如下所示：

```
<div ng-controller="ParentController">
  <img src="{{ src }}"><br><br>
  <span class="btn" ng-click="change()">Change!</span>
</div> 
```

关于进度，您需要使用回调或返回一个可以带来承诺和进度指示器的对象（即：）`return {promise: defer.promise, percent: 0}`。然后应该从服务内部更新进度指示器。

如果您需要在将服务器返回的 URL 设置为`src`属性之前对它进行任何转换，您也可以链接您的承诺，即：

```
$scope.src = imageService.change().then(function(result) {
    return 'http://dummyimage.com/' + result;
  }); 
```

更新[了您的 Plunker](http://plnkr.co/edit/Bs6WDGzZCzE7fJA7wJCC?p=preview)。

# sed - sed 给了我“：意外的 EOF (pending }'s) 错误，我不知道为什么

> ID：15467616
> 
> 赞同：4
> 
> 时间：2013-03-17T23:36:14.317
> 
> 标签：sed

我正在尝试将 GNU sed 命令移植到 BSD sed（在 OSX 中）。命令是：

```
cat -- "$1" | sed -n -e "\${/^#/H;x;/${tapPrintTapOutputSedPattern}/p;}" \
-e "/${tapPrintTapOutputSedPattern}/{x;/${tapPrintTapOutputSedPattern}/p;b;}" \
-e "/^#/{H;b;}" \
-e "x;/${tapPrintTapOutputSedPattern}/p" \
-e "/^Bail out!/q" 
```

它适用于 GNU sed，但 BSD sed 给出了这个错误：

```
sed: 2: "/^Bail out!/q
": unexpected EOF (pending }'s) 
```

这是变量扩展后的命令，以防相关：

```
cat -- "test021.tap" | sed -n \
-e "\${/^#/H;x;/^not ok\|^ok \([0-9]\+ \)\?# [tT][oO][dD][oO]\|^Bail out!/p;}" \
-e "/^not ok\|^ok \([0-9]\+ \)\?# [tT][oO][dD][oO]\|^Bail out!/{x;/^not ok\|^ok \([0-9]\+ \)\?# [tT][oO][dD][oO]\|^Bail out!/p;b;}" \
-e "/^#/{H;b;}" \
-e "x;/^not ok\|^ok \([0-9]\+ \)\?# [tT][oO][dD][oO]\|^Bail out!/p" \
-e "/^Bail out!/q" 
```

关于为什么/如何解决它的任何想法？

干杯!

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-18T06:05:14.433

尝试使用换行符而不是分号，至少在`b`语句中的分支命令 ( ) 之前。看看这是否有效：

```
sed -n "
  \${
    /^#/H
    x
    /${tapPrintTapOutputSedPattern}/p
  }
  /${tapPrintTapOutputSedPattern}/{
    x
    /${tapPrintTapOutputSedPattern}/p
    b
  }
  /^#/{
    H
    b
  }
  x
  /${tapPrintTapOutputSedPattern}/p
  /^Bail out!/q
" "$1" 
```

# php - 贝宝 IPN 订阅 (php)

> ID：15467617
> 
> 赞同：2
> 
> 时间：2013-03-17T23:36:15.757
> 
> 标签：php, paypal, subscription, paypal-ipn

我正在尝试使用 Paypal 和他们的 IPN 系统设置订阅几天。我无法理解大多数教程，最后找到了一个对我有意义的教程。

在 Sean 的帮助下，我稍微更改了代码，但仍然没有运气。

要创建订阅按钮，我使用以下代码：

```
<form action="https://sandbox.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_xclick-subscriptions">
<input type="hidden" name="business" value="info@mydomain.com">
<input type="hidden" name="lc" value="NL">
<input type="hidden" name="item_name" value="Mydomain.com Abonnement">
<input type="hidden" name="no_note" value="1">
<input type="hidden" name="no_shipping" value="2">
<input type="hidden" name="notify_url" value="http://www.mydomain.com/pp-ipn-handler.php">
<input type="hidden" name="return" value="http://www.mydomain.com/ppsuccess.php">
<input type="hidden" name="src" value="1">
<input type="hidden" name="currency_code" value="EUR">
<input type="hidden" name="bn" value="PP-SubscriptionsBF:btn_subscribeCC_LG.gif:NonHosted">
<input type="hidden" name="custom" value="'. $username .'">
<table>
<tr><td><input type="hidden" name="on0" value="Betaalperiode"><strong>Kies uw betaalperiode:</strong></td></tr><tr><td><select name="os0">
    <option value="Per maand">Per maand : &euro;25.00 EUR</option>
    <option value="Per jaar">Per jaar : &euro;240.00 EUR</option>
</select> </td></tr>
</table>
<input type="hidden" name="currency_code" value="EUR">
<input type="hidden" name="option_select0" value="Per maand">
<input type="hidden" name="option_amount0" value="25.00">
<input type="hidden" name="option_period0" value="M">
<input type="hidden" name="option_frequency0" value="1">
<input type="hidden" name="option_select1" value="Per jaar">
<input type="hidden" name="option_amount1" value="240.00">
<input type="hidden" name="option_period1" value="Y">
<input type="hidden" name="option_frequency1" value="1">
<input type="hidden" name="option_index" value="0">
<input type="image" src="https://www.paypalobjects.com/nl_NL/NL/i/btn/btn_subscribe_LG.gif" border="0" name="submit" alt="PayPal, de veilige en complete manier van online betalen.">
</form> 
```

为了处理 ipn 响应，我有一个名为 pp-ipn-handler.php 的文件，其中包含以下代码：

```
<?php
// read the post from PayPal system and add 'cmd'
$req = 'cmd=_notify-validate';
foreach ($_POST as $key => $value) {
$value = urlencode(stripslashes($value));
$req .= "&$key=$value";
}
// post back to PayPal system to validate
$header .= "POST /cgi-bin/webscr HTTP/1.0\r\n";
$header .= "Content-Type: application/x-www-form-urlencoded\r\n";
$header .= "Content-Length: " . strlen($req) . "\r\n\r\n";
// assign posted variables to local variables
$payment_status = $_POST['payment_status'];
$payment_amount = $_POST['mc_gross'];
// $payment_currency = $_POST['mc_currency'];
$payment_currency = 'EUR';
$ppusername = $_POST['custom'];
$fp = fsockopen ('sandbox.paypal.com', 80, $errno, $errstr, 30);
if (!$fp)
{
}
else
{
fputs ($fp, $header . $req);
while (!feof($fp))
{
$res = fgets ($fp, 1024);
if (strcmp ($res, "VERIFIED") == 0)
{
// When a payment has gone trough
    //When payment is 25EUR make it a month validity
    if ($ppusername&&($payment_currency=='EUR')&&($payment_amount=='25'))
    {
        $period = '+1 month';       
    }
    //When payment is 240EUR make it a year validity
    else if ($ppusername&&($payment_currency=='EUR')&&($payment_amount=='25'))
    {
        $period = '+1 year';        
    }
    //There is incorrect information in this payment
    else
    {

    }

    //Lets first get the date in mysql format
    $date = date('m/d/Y h:i:s', time());
    $date = date('m/d/Y h:i:s', strtotime("$date -7 hours"));
    //Now lets update the subscription records
    require_once('core/dbconnect.php');
    $subscriptionrecordexists = mysql_query("SELECT * FROM subscriptions WHERE username='$ppusername'");
    if (mysql_num_rows($subscriptionrecordexists))
    {
        //User has purchase before. Adjust his subscription record and ad an invoice.
        require_once('core/dbconnect.php');
        $subscriptionrecord = mysql_query("SELECT * FROM subscriptions WHERE username='$ppusername'");
        $row = mysql_fetch_array($subscriptionrecord);
        //Update subscription record
        $currentvalidity = $row['validity'];
        if ($currentvalidity >= $date)
        {
            //Add period if subscription is still valid
            $newvalidity = date('m/d/Y h:i:s', strtotime("$currentvalidity $period"));
            require_once('core/dbconnect.php');
            mysql_query("UPDATE subscriptions SET validity='$newvalidity' WHERE username='$ppusername'");
            //Add invoice to user
            if ($period == '+1 month')
            {$product = 'NLTVMee.com voor 1 maand';}
            if ($period == '+1 year')
            {$product = 'NLTVMee.com voor 1 jaar';}
            $paymentmethode = 'Paypal';
            $oldvalid = $currentvalidity;
            $newvalid = $newvalidity;
            require_once('core/dbconnect.php');
            mysql_query("INSERT INTO invoices VALUES ('','$date','$ppusername','$product','$paymentmethode','$payment_currency','$payment_amount','$oldvalid','$newvalid')");
        }
        else
        {
            //Add period from current date if validity is not valid anymore
            $newvalidity = date('m/d/Y h:i:s', strtotime("$date $period"));
            require_once('core/dbconnect.php');
            mysql_query("UPDATE subscriptions SET validity='$newvalidity' WHERE username='$ppusername'");
            //Ad invoice to user
            if ($period == '+1 month')
            {$product = 'NLTVMee.com voor 1 maand';}
            if ($period == '+1 year')
            {$product = 'NLTVMee.com voor 1 jaar';}
            $paymentmethode = 'Paypal';
            $newvalid = $newvalidity;
            require_once('core/dbconnect.php');
            mysql_query("INSERT INTO invoices VALUES ('','$date','$ppusername','$product','$paymentmethode','$payment_currency','$payment_amount','','$newvalid')");
        }
    }
    else
    {
        //User has never purchased before. Make new subscription record and add invoice.
        //Add period from current date if validity is not valid anymore
        $newvalidity = date('m/d/Y h:i:s', strtotime("$date $period"));
        require_once('core/dbconnect.php');
        mysql_query("INSERT INTO subscriptions VALUES ('','$ppusername','$newvalidity')");
        //Ad invoice to user
        if ($period == '+1 month')
        {$product = 'NLTVMee.com voor 1 maand';}
        if ($period == '+1 year')
        {$product = 'NLTVMee.com voor 1 jaar';}
        $paymentmethode = 'Paypal';
        $newvalid = $newvalidity;
        require_once('core/dbconnect.php');
        mysql_query("INSERT INTO invoices VALUES ('','$date','$ppusername','$product','$paymentmethode','$payment_currency','$payment_amount','','$newvalid')");
    }

}
//End
else if (strcmp ($res, "INVALID") == 0)
{

}
}
fclose ($fp);
}
?> 
```

正如你所看到的，它现在配置了 Paypal 沙箱 URL 来试用它，但是当我这样做并付款时，数据库中没有任何变化，正如你所见，IPN 处理程序页面应该会改变一些事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:55:38.373

这是一个空白页面，因为您将 ipn 侦听器作为您的`return`值，这是完成后发送给您的地方，但没有发送任何信息。回发到 Paypal 将没有任何值，您的代码将失败。
（[来自文档](https://www.x.com/developers/paypal/documentation-tools/paypal-payments-standard/integration-guide/Appx_websitestandard_htmlvariables)-*买家完成付款后，PayPal 将他们的浏览器重定向到的 URL。例如，在您的网站上指定一个显示“感谢您的付款”页面的 URL。*）

```
<input type="hidden" name="return" value="http://www.mydomain.com/pp-ipn-handler.php"> 
```

您需要使用 （[来自文档](https://www.x.com/developers/paypal/documentation-tools/paypal-payments-standard/integration-guide/Appx_websitestandard_htmlvariables)- *PayPal 以即时付款通知消息的形式发布有关付款信息的 URL。*）[`notify_url`](https://www.x.com/developers/paypal/documentation-tools/paypal-payments-standard/integration-guide/Appx_websitestandard_htmlvariables#id08A6HF00TZS__id08A6I0980HH)

 *```
<input type="hidden" name="notify_url" value="http://www.mydomain.com/pp-ipn-handler.php">
<input type="hidden" name="return" value="http://www.mydomain.com/payment_complete_thank_message.php"> 
```

* * *

**编辑**
我在代码中看到 3 个额外的错误

您在第 65 行的查询是`$subscriptionrecord`，但在第 66 行您正在使用`$userinfo`

```
 $subscriptionrecord = mysql_query("SELECT * FROM subscriptions WHERE username='$ppusername'");
    $row = mysql_fetch_array($userinfo); 
```

*更正*
以下这些不正确，因为将它们括在引号`"$currentvalidity $period"`中与`$currentvalidity.$period`

在第 72 行，你需要在里面连接`$currentvalidity`&`$period``strtotime()``$currentvalidity.$period`

```
$newvalidity = date('m/d/Y h:i:s', strtotime("$currentvalidity $period")); 
```

在第 #91 和 #111 行，你需要在里面连接`$date`-`$period``strtotime()``$date.$period`

```
$newvalidity = date('m/d/Y h:i:s', strtotime("$date $period")); 
```*

# sql - 使用 LEFT JOIN 查询不返回计数为 0 的行

> ID：15467624
> 
> 赞同：43
> 
> 时间：2013-03-17T23:36:58.060
> 
> 标签：sql, postgresql, count, left-join

我正在尝试获取以下内容以返回在 PostgreSQL 中使用左连接的每个组织的计数，但我无法弄清楚它为什么不起作用：

```
 select o.name as organisation_name,
         coalesce(COUNT(exam_items.id)) as total_used
  from organisations o
  left join exam_items e on o.id = e.organisation_id
  where e.item_template_id = #{sanitize(item_template_id)}
  and e.used = true
  group by o.name
  order by o.name 
```

使用`coalesce`似乎不起作用。我无计可施！任何帮助都将不胜感激！

为了澄清什么不起作用，目前查询仅返回计数大于 0 的组织的值。我希望它为**每个**组织返回一行，无论计数如何。

表定义：

```
TABLE exam_items
  id serial NOT NULL
  exam_id integer
  item_version_id integer
  used boolean DEFAULT false
  question_identifier character varying(255)
  organisation_id integer
  created_at timestamp without time zone NOT NULL
  updated_at timestamp without time zone NOT NULL
  item_template_id integer
  stem_id integer
  CONSTRAINT exam_items_pkey PRIMARY KEY (id)

TABLE organisations
  id serial NOT NULL
  slug character varying(255)
  name character varying(255)
  code character varying(255)
  address text
  organisation_type integer
  created_at timestamp without time zone NOT NULL
  updated_at timestamp without time zone NOT NULL
  super boolean DEFAULT false
  CONSTRAINT organisations_pkey PRIMARY KEY (id) 
```

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2013-03-18T00:30:49.223

## 修复`LEFT JOIN`

这应该有效：

```
SELECT o.name AS organisation_name, count(e.id) AS total_used
FROM   organisations   o
LEFT   JOIN exam_items e ON e.organisation_id = o.id 
                        AND e.item_template_id = #{sanitize(item_template_id)}
                        AND e.used
GROUP  BY o.name
ORDER  BY o.name; 
```

你有 a`LEFT [OUTER] JOIN`但后来的`WHERE`条件使它表现得像一个 plain `[INNER] JOIN`。
将条件移至`JOIN`子句以使其按预期工作。这样，只有满足所有这些条件的行首先被连接（或者*右*表中的列被填充为 NULL）。就像您所拥有的一样，连接的行实际上会*在之后*测试附加条件，如果它们不通过则将其`LEFT JOIN`删除，就像使用普通`JOIN`.

`count()`从不返回 NULL 开头。在这方面，聚合函数是一个例外。因此，即使有附加参数，也*永远不会*有意义。[手册：](https://www.postgresql.org/docs/current/functions-aggregate.html)~~`COALESCE(COUNT(col))`~~

 *> 需要注意的是，**除了 之外`count`**，这些函数在没有选择行时返回空值。

大胆强调我的。看：

*   [计算一行为 NULL 的属性数](https://stackoverflow.com/questions/31444591/count-the-number-of-attributes-that-are-null-for-a-row/31445274#31445274)

`count()`必须位于已定义的列上`NOT NULL`（如`e.id`），或示例中连接条件保证的列`NOT NULL`（`e.organisation_id`、`e.item_template_id`或`e.used`）。

既然`used`是类型`boolean`，表现`e.used = true`就是燃烧到刚刚的噪音`e.used`。

由于`o.name`未定义`UNIQUE NOT NULL`，您可能希望`GROUP BY o.id`改为（`id`作为 PK） - 除非您*打算*折叠具有相同名称的行（包括 NULL）。

### 先聚合，后加入

如果在该过程中计算了大部分或所有行，`exam_items`则此等效查询通常会更快/更便宜：

```
SELECT o.id, o.name AS organisation_name, e.total_used
FROM   organisations o
LEFT   JOIN (
   SELECT organisation_id AS id   -- alias to simplify join syntax
        , count(*) AS total_used  -- count(*) = fastest to count all
   FROM   exam_items
   WHERE  item_template_id = #{sanitize(item_template_id)}
   AND    used
   GROUP  BY 1
   ) e USING (id)
ORDER  BY o.name, o.id; 
```

（这是假设您不想像上面提到的那样折叠具有相同名称的行 - 典型情况。）

现在我们可以`count(*)`在子查询中使用更快/更简单的，我们不需要`GROUP BY`在外部`SELECT`。

看：

*   [单个查询中的多个 array_agg() 调用](https://stackoverflow.com/questions/27622398/multiple-array-agg-calls-in-a-single-query/27626358#27626358)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-10-08T16:26:11.567

为了清楚起见，

重要的是`GROUP BY MAIN_TABLE`，它将处理来自的 NULL 值`SOME_TABLE`

```
SELECT COUNT(ST.ID)
FROM MAIN_TABLE MT
LEFT JOIN SOME_TABLE ST ON MT.ID = ST.MT_ID

GROUP BY MT.ID -- this line is a must 
```*

# python - 我怎样才能取几段文字，看看是否有句子有代词，然后选择所有这些句子来组成一个新段落？

> ID：15467627
> 
> 赞同：0
> 
> 时间：2013-03-17T23:37:08.857
> 
> 标签：python, nltk

1.  我应该使用 NLTK 还是正则表达式来拆分它？
2.  我该如何选择代词（他/她）。我想选择任何有代词的句子。

这是一个更大项目的一部分，我是 Python 新手。你能给我指出任何有用的代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:17:46.950

NLTK 是您最好的选择。给定一串句子作为输入，您可以通过执行以下操作获得包含代词的句子列表：

```
from nltk import pos_tag, sent_tokenize, word_tokenize
paragraph = "This is a sentence with no pronouns. Take it or leave it."
print [sentence for sentence in sent_tokenize(paragraph)
       if 'PRP' in {pos for _,pos in pos_tag(word_tokenize(sentence))}] 
```

回报：

```
['Take it or leave it.'] 
```

基本上，我们将字符串拆分为句子列表，将这些句子拆分为单词列表，并将每个句子的单词列表转换为一*组*词性标签（这很重要，因为如果我们不这样做，当我们有多个句子中的代词，我们会得到重复的句子）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:57:58.167

我正在做一个有类似需求的 NLP 项目。我建议您使用**NLTK**，因为它使事情变得非常简单，并为我们提供了很大的灵活性。由于您需要收集所有带有代词的句子，您可以将文本中的所有句子拆分并保存在一个列表中。然后，您可以遍历列表并查找包含代词的句子。还要确保记下句子的索引（在列表中），或者您可以形成一个新列表。

**下面的示例代码：**

```
from nltk.tokenize import word_tokenize
from nltk.tag import pos_tag

sentences = ['alice loves to read crime novels.', 'she also loves to play chess with him']
sentences_with_pronouns = []

for sentence in sentences:
    words = word_tokenize(sentence)
    for word in words:
        word_pos = pos_tag([word])
        if word_pos[0][1] == 'PRP':
            sentences_with_pronouns.append(sentence)
            break

print sentences_with_pronouns 
```

**输出：**

```
['she also loves to play chess.'] 
```

**PS**还要检查[pylucene](http://lucene.apache.org/pylucene/)和[whoosh](https://pypi.python.org/pypi/Whoosh)库，它们是非常有用的 NLP python 包。

# php - 可以|| 运算符用于在 PHP 中的非布尔类型的值之间进行选择？

> ID：15467631
> 
> 赞同：5
> 
> 时间：2013-03-17T23:37:23.653
> 
> 标签：php, syntax, echo

是否可以回显 using `||`，以便它使用第一个评估为 true 的变量？

例如，

```
$a = false;
$b = 'b';
echo $a || $b || 'neither'; // evaluates to 1 ? 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T23:38:36.023

[三元运算符](http://php.net/manual/en/language.operators.comparison.php)

```
echo (($a) ? : $b) ? : 'neither'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:48:23.717

```
echo $a ? $a : ($b ? $b : ($c ? $c : 'neither')); 
```

如果有更多的变量，你会这样继续下去，但如果太长，它会变得丑陋且难以阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T23:40:01.073

终极三元

```
$a = false;
$b = 'b';
echo ($a)?$a:(($b)?$b:'neither'); 
```

# python - pandas.Dataframe：填充来自另一个 DF 的缺失值

> ID：15467638
> 
> 赞同：0
> 
> 时间：2013-03-17T23:38:08.827
> 
> 标签：python, pandas, dataframe, missing-data

例如我有这个：

```
df_1 = pd.DataFrame({'A': [3 for _ in xrange(10)],
                     'B': [3 for _ in xrange(10)],
                     'C': [3 for _ in xrange(10)]})
df_2 = pd.DataFrame({'A': [2 for _ in xrange(5)],
                     'B': [2 for _ in xrange(5)],
                     'C': [2 for _ in xrange(5)]})

print(df_1 - df_2) 
```

和输出将如预期：

```
 A   B   C
0   1   1   1
1   1   1   1
2   1   1   1
3   1   1   1
4   1   1   1
5 NaN NaN NaN
6 NaN NaN NaN
7 NaN NaN NaN
8 NaN NaN NaN
9 NaN NaN NaN 
```

如何用来自的值填充新创建的 DF 中的缺失值`df_1`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-17T23:56:05.860

您可以使用[`combine_first`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.combine_first.html)来填写缺失值：

```
In [2]: (df_1 - df_2).combine_first(df_1)
Out[2]:
   A  B  C
0  1  1  1
1  1  1  1
2  1  1  1
3  1  1  1
4  1  1  1
5  3  3  3
6  3  3  3
7  3  3  3
8  3  3  3
9  3  3  3 
```

# javascript - 通过添加 html 标签重新格式化文本

> ID：15467641
> 
> 赞同：2
> 
> 时间：2013-03-17T23:38:37.470
> 
> 标签：javascript, jquery, html, css

我在一个电子商务网站上工作，但在按设计方式格式化价格时遇到了问题。

它以这种方式显示价格：

```
 <p class="price">£900.00</p> 
```

我需要获取网站中显示的所有价格（课程价格）并以这种方式重新格式化：

```
<p class="price"><span>£</span> 900 <span>.00<span></p> 
```

所以在我可以将特定的css样式添加到小数和£符号之后

你有什么想法吗？

顺便说一句，我需要通过 JS / jquery 来完成，因为我是在后端完成的，而且它产生了一些冲突，所以需要在客户端完成

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T00:01:24.950

以下适用于各种货币符号。[这](http://jsfiddle.net/EWgwr/)是工作小提琴。

```
$('.price').each(function (idx, val) {
    var price = $(this).text();
    var newOne = price.match(/^(.)(\d+)\.(\d+)$/);
    $(this).html("<span>" + newOne[1] + "</span>" + newOne[2] + ".<span>" + newOne[3] + "</span>");
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-17T23:53:28.030

在前端没有必要这样做，因为最好用后端“冲突”来指出我们，但是：

```
$(function(){

  var $el, price;

  $('.price').each(function(item){

    $el = $(this);
    price = $el.text().substr(1);
    $el.empty().append(

      $("<span></span>", { class : "currency", text: "£"})

    ).append( price.split('.')[0])
    .append(

      $("<span></span>", { class : "decimals", text: "." + price.split('.')[1]})    

    );

  });

}); 
```

[工作小提琴](http://jsfiddle.net/WdTFr/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-17T23:52:38.473

# [演示](http://jsfiddle.net/WdTFr/4/)

这适用于 : `£900.00`,之类的字符串`£900000.00123` ，`$560125.14500`其余的你都知道..

```
var val = '£900.00';
var currSign = val.charAt(0); 
```

`currSign`将会`£`

```
var amount = val.substring(1); 
```

`amount`将会`900.00`

```
 var left = amount.split('.')[0];
 var right = "."+amount.split('.')[1]; 
```

`left`将是`900` `right`将是`.00`

随心所欲地使用它。

```
<p class="price"><span>$currSign</span> $left <span>$right<span></p> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-17T23:52:09.620

```
$("p.price").each(function() {
    var oldprice = $(this).text();
    var split = oldprice.match(/^£(\d+)(\.\d+)$/);
    if (split) {
       $(this).html('<span>£</span> ' + split[1] + ' <span>'+split[2]+'</span>');
    }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-17T23:53:31.213

```
$('.price').each(function() {
    $(this).html($(this).text().replace(/(£)(\d+)(\.\d\d)/, '<span>$1</span> $2 <span>$3</span>');
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-18T00:05:16.317

我建议：

```
$('.price').html(function(i,h){
    return h.replace(/([£$])(\d+)(.\d{2})/,'<span>$1</span><span>$2</span><span>$3</span>');
}); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/nvr6p/)。

*   `([£$])`捕获一个货币字符，要么是`£`要么`$`，
*   `(\d+)`捕获一个或多个数字字符，
*   `(.\d{2})`捕获一个句点和两个以下数字。

,`$1`和`$2`依次`$3`引用这些匹配项。

并设置这些样式（即使没有明确的类名：

```
p span {
    color: #000;
}

p span:first-child {
    color: #999;
}

span:first-child + span {
    font-weight: bold;
}

span:last-child {
    font-size: 80%;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/nvr6p/1/)。

参考：

*   [`html()`](http://api.jquery.com/html/).
*   [JavaScript 正则表达式 (MDN)](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)。

# php - 创建 php 脚本来解析这个 json

> ID：15467642
> 
> 赞同：-2
> 
> 时间：2013-03-17T23:39:15.320
> 
> 标签：php, json, parsing

我想在 php 中解析这个 json 数据，任何人都可以在脚本中帮助我。

下面的代码

> {成员”：[{“成员”：{“id”：464258，“display_name”：“test1”，“mitch_rank_index”：6.64，“距离”：0.56009166639932，“unread_messages_from”：0，“explorer”：假，“ online": true, "favourite": false, "fan": false, "thumbnail_url": "link", "profile_photo_url": "link" } }, { "member": { "id": 1009345, "display_name" ：“测试2”，“mitch_rank_index”：6.32，“距离”：0.583112841628013，“unread_messages_from”：0，“explorer”：false，“online”：false，“favourite”：false，“fan”：false，“thumbnail_url”：“link”，“ profile_photo_url": "Link" } }, { "member": { "id": 1052568, "display_name": null, "mitch_rank_index": 5.699999999999999, "distance": 0.597684462292014, "unread_messages_from": 0, "explorer": false ,“在线”：真，“最爱”：假，“粉丝”：假，“thumbnail_url”：“链接”，“profile_photo_url”：“链接”}}]

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:41:06.357

尝试使用：

```
json_decode() 
```

您可以在此处阅读有关此功能的更多信息：http: [//php.net/manual/en/function.json-decode.php](http://php.net/manual/en/function.json-decode.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T23:53:54.137

这是一个有效的 json 和从中生成的数组。像对待 PHP 数组一样对待它。

```
<?php

$json = <<<JSON
{
    "members": [
        {
            "member": {
                "id": 464258,
                "display_name": "test1",
                "mitch_rank_index": 6.64,
                "distance": 0.56009166639932,
                "unread_messages_from": 0,
                "explorer": false,
                "online": true,
                "favourite": false,
                "fan": false,
                "thumbnail_url": "link",
                "profile_photo_url": "link"
            }
        },
        {
            "member": {
                "id": 1009345,
                "display_name": "Test2",
                "mitch_rank_index": 6.32,
                "distance": 0.583112841628013,
                "unread_messages_from": 0,
                "explorer": false,
                "online": false,
                "favourite": false,
                "fan": false,
                "thumbnail_url": "link",
                "profile_photo_url": "Link"
            }
        },
        {
            "member": {
                "id": 1052568,
                "display_name": null,
                "mitch_rank_index": 5.699999999999999,
                "distance": 0.597684462292014,
                "unread_messages_from": 0,
                "explorer": false,
                "online": true,
                "favourite": false,
                "fan": false,
                "thumbnail_url": "link",
                "profile_photo_url": "link"
            }
        }
    ]
}
JSON;

$json = json_decode($json,true);

print("<pre>");
print_r($json);
print("</pre>");

?> 
```

**更新**

要显示 JSON 中的所有 ID，您可以从以下代码中获取示例

```
// $ids will contain array of all ID that ara available in JSON
foreach ($json['members'] as $members) $ids[] = $members['member']['id'];

// you can use $ids array from now
// following code just shows how array can look like in php
print("<pre>");
print_r($ids);
print("</pre>");

// use foreach to go through all IDs and do something for each of them
// this code simply goes through all IDs and prints each of them on screen
// again, this is a way to manipulate through all IDS from your JSON
foreach ($ids as $id)
{
    // you can use $id here in this loop
    print("id: ".$id."<br />");
} 
```

# c++ - 为什么我的 HeapSort 会跳过数组中的第一个元素？

> ID：15467646
> 
> 赞同：-1
> 
> 时间：2013-03-17T23:39:47.133
> 
> 标签：c++, heapsort

我在我的算法类中为分配实现 HeapSort，我终于完成了，但由于某种原因，排序跳过了我数组中的第一个元素。

原始数组：

```
int heapArray[SIZE] = {  5 ,99, 32, 4, 1, 12, 15 , 8, 13, 55 }; 
```

HeapSort() 之后的输出

```
5 99 32 15 13 12 8 4 1 
```

我浏览了所有功能，但无法弄清楚为什么它会跳过第一个元素。谁能帮我吗？Iv 包括了下面的所有 HeapSort 函数。我知道它有很多值得一看的地方，但我太接近了。

```
int main()
{
int heapArray[SIZE] = {  5 ,99, 32, 4, 1, 12, 15 , 8, 13, 55 };
HeapSort(heapArray);

return 0;

} 
```

..................................................... ……………………………………………………………………………………………………………………………………

```
void HeapSort(int heapArray[])
{   
int heap_size = SIZE;
int n = SIZE;
int temp;

Build_Max_Heap(heapArray);

for(int i = n-1; i >= 2; i--)
{
    temp = heapArray[1];
    heapArray[1] = heapArray[i];
    heapArray[i] = temp;

    heap_size = heap_size-1;
    Max_Heapify(heapArray,1);
}

return;
} 
```

..................................................... .........................................................

```
void Build_Max_Heap(int heapArray[])
{
double n = SIZE;

for(double i = floor((n-1)/2); i >= 1; i--)
{
    Max_Heapify(heapArray,i);
}

return;
} 
```

..................................................... .........................................................

```
void Max_Heapify(int heapArray[],int i)
{
int n = SIZE;
int largest = 0;
int l = Left(i);
int r = Right(i);

if(( l <= n) && (heapArray[l] > heapArray[i]))
{
    largest = l;
}
else
{
    largest = i;
}

if( (r <= n) && ( heapArray[r] > heapArray[largest]))
{
    largest = r;
}

int temp;
if(largest != i)
{
    temp = heapArray[i];
    heapArray[i] = heapArray[largest];
    heapArray[largest] = temp;

    Max_Heapify(heapArray,largest);
}

return;
} 
```

..................................................... .........................................................

```
int Parent(int i)
{
return (i/2);
}

int Left(int i)
{
return (2*i);
}

int Right(int i)
{
return ((2*i)+1);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T01:31:00.930

您的代码中有几个问题：

首先：数组索引从0开始，而不是1，因此，索引错误的地方很多，如下所示：

在堆排序函数中：

```
for(int i = n-1; i >= 2; i--)  {
                   //should be 1 not 2
    temp = heapArray[1]; //should be 0 not 1 in those 2 statements
    heapArray[1] = heapArray[i];
     heapArray[i] = temp;  
}

Max_Heapify(heapArray,1);
                  //should start from 0 not 1 
```

除了：

```
for(double i = floor((n-1)/2); i >= 1; i--)
{                             //should start from 0 not 1
    Max_Heapify(heapArray,i);
} 
```

You Parent, Left 和 Right 有类似的错误，可以看上面两个帖子。

同时，您的 HeapSort 和 Max_Heapfiy 函数存在逻辑错误。您定义 heap_size 并更新它，但您从未真正使用过它。您必须将它传递给 Max_Heapify 函数。由于每次将当前最大的元素放在数组的末尾时，您只需要将剩余的元素堆起来，而不是整个堆。这也意味着您的 heapify 函数有错误，因为您从未真正使用过 heap_size。正确的 HeapSort 和 Max_Heapify 以及 Build_Max_Heap 函数应该是：

堆排序：

```
void HeapSort(int heapArray[]) 
{   
  //do what you did before this sentence
  Build_Max_Heap(heapArray,heap_size); 
  //need to pass heap_size since Max_Heapify use heap_size
  for(int i = n-1; i >= 1; i--)
  {
     //...same as you did but pay attention to index
     heap_size = heap_size-1;
     Max_Heapify(heapArray,0,heap_size); //remember to use heap_size
   }
   //you declared void, no need to return anything
 } 
```

Build_Max_Heap 函数：

```
void Build_Max_Heap(int heapArray[], int heapSize) //should use heapSize
{
    int n = SIZE;
    for(int i = floor((n-1)/2); i >= 0; i--) //here should be 0 not 1
   {
      Max_Heapify(heapArray,i,heapSize); //should use heapSize
    }
 } 
```

Max_Heapify 函数：

```
void Max_Heapify(int heapArray[],int i, int heap_size) //should use heap_size
{
    //....here similar to what you did
    if(( l < heap_size) && (heapArray[l] > heapArray[i]))
    {   //^^compare with heap_size not SIZE
        //skip identical part
    }

    if( (r < heaps_ize) && ( heapArray[r] > heapArray[largest]))
    {
       //same error as above
    }

   //skip identical part again
   Max_Heapify(heapArray,largest, heap_size); //have to use heap_size
 }
} 
```

您可能需要从伪代码中更好地理解 HeapSort 算法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:44:23.680

这里

```
Build_Max_Heap(heapArray);

for(int i = n-1; i >= 2; i--)
{                 ^^^^^
    temp = heapArray[1];
    heapArray[1] = heapArray[i];
    heapArray[i] = temp;

    heap_size = heap_size-1;
    Max_Heapify(heapArray,1);
}

return;
} 
```

你停止在 i=2 上循环，将其减少到 1，不要取 heapArray 的第一个元素，它的索引为**0**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-17T23:46:59.457

,`Parent`和函数适用于基于 1 的数组`Left`。`Right`对于基于 0，您需要使用：

```
int Parent(int i)
{
    return (i - 1) / 2;
}

int Left(int i)
{
    return (2 * i) + 1;
}

int Right(int i)
{
    return 2 * (i + 1);
} 
```

正如您可以检查示例堆：

```
 0
   / \
  1   2
 / \ / \
3  4 5  6 
```

# javascript - 为多输入形成警报

> ID：15467648
> 
> 赞同：0
> 
> 时间：2013-03-17T23:39:58.183
> 
> 标签：javascript, html, forms, validation, alert

我有以下代码，需要获取一个警报，该警报将指定哪些字段为空或空，并为每个空或空字段返回一个警报。我是 JavaScript 新手，在这方面遇到了很多困难。有人可以给我一些建议吗？

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<TITLE></TITLE>

<SCRIPT LANGUAGE="JavaScript">
<!--
    function checkForm(form){
        var len = form.length;

        //create for loop
        for (var i=0; i<len; i++){
            if (form.elements[i].type=="text" || form.elements[i].type==null){
                if (form.fax number.value=="" || form.fax number.type==null){
                    alert("Please fill out the fax number field");
                }
            }
        }
    }

    function emailTest(emailText){
        var email = emailText.value;
        var emailPattern = /^.+@.+\..{2,}$/;
        if (!(emailPattern.test(email))) {
            alert("Please enter a valid email address.");
            document.myForm[1].focus();
        }
    }
// -->
</SCRIPT>

</HEAD>

<BODY>
<H3>Assignment 2 Form</H3>
<HR>

<FORM NAME="myForm" METHOD="post"
ACTION="mailto:joeschmoe@blahblah.ca">
    Name:<BR>
    <INPUT TYPE="text" size="30" NAME="name"><br>
    Email address:<BR>
    <INPUT TYPE="text" size="30" NAME="email address" onBlur="emailTest(this);"><br>
    Phone number:<BR>
    <INPUT TYPE="text" size="30" NAME="phone number"><br>
    Fax number:<BR>
    <INPUT TYPE="text" size="30" NAME="fax number"><p>
    <INPUT TYPE="submit" VALUE="Submit Data" onClick="return checkForm(this.form);">
    <INPUT TYPE="reset" VALUE="Reset Form">
</FORM>

</BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:46:46.257

好吧……哇。我在这上面花了太多时间。您的表单应如下所示：

```
<FORM NAME="myForm" id="myForm">
<label for="name">Name:</label><br />
    <INPUT TYPE="text" size="30" NAME="name" /><br />
<label for="email_address">Email address:</label><BR />
    <INPUT TYPE="text" size="30" NAME="email_address" /><br />
<label for="phone_number">Phone number:</label><BR /> 
    <INPUT TYPE="text" size="30" NAME="phone_number" /><br />
<label for="fax_number">Fax number:</label><BR />
    <INPUT TYPE="text" size="30" NAME="fax_number" /><br />
    <INPUT TYPE="button" VALUE="Submit Data" onClick="return checkForm()" />
    <INPUT TYPE="reset" VALUE="Reset Form" />
</FORM> 
```

### 表格摘要：

*   您应该为表单元素使用标签
*   切勿在名称属性或任何标识属性（名称、类、id）中使用空格
*   `input`s 应该以`/>`任何没有结束标签的标签结尾（`<br />`也是）
*   我退出了该`onBlur`事件，并将其添加为整个验证过程的一部分。不需要太复杂
*   我使用`button`输入类型而不是`submit`输入类型。在 JavaScript 中了解原因

然后是你的 JavaScript：

```
function checkForm() {
    var valid = false; //Set a boolean variable that will be changed on each block 
                       //of validation
    if (document.myForm.fax_number.value === "") {
        alert("Please fill out the fax number field");
    }

    if (document.myForm.email_address.value === "") {
        alert("Email address is required");
    } else {
        valid = emailTest(document.myForm.email_address.value);
    }

    //all other checks within if statements

    if (valid) {
        document.myForm.action = "mailto:soandso@so.com";
        document.myForm.submit();
    }
}

function emailTest(emailText) {
    var emailPattern = /^.+@.+\..{2,}$/;
    var ret = false;
    if (!(emailPattern.test(emailText))) {
        alert("Please enter a valid email address.");
    } else {
        ret = true;
    }
    return ret;
} 
```

### Javascript 总结

*   在与 HTML 表单交互的 JavaScript 中，表单是这样调用的：form 标签属性中的字符串`document.formName`where或页面上表单的数字实例where是，即页面上的第一个表单是，因此它是称为`formName``name=""``document.forms[i]``i``i = 0``document.forms[0]`
*   检查每个`input`by以`name`查找s属性中的字符串在哪里。`value``document.myForm.(elementName).value``elementName``<input>``name`
*   我没有使用 ，而是`submit`使用了常规`button`. 单击表单中的“提交数据”按钮时，它会运行`checkForm()`以确保一切有效
*   如果一切都有效，它会为表单分配一个动作，`document.myForm.action=youraction`然后通过 JavaScript 提交它`document.myForm.submit()`

### 笔记

*   永远不要使用[W3Schools](http://w3fools.com)来学习任何东西。
*   [在此处](http://www.quirksmode.org/js/forms.html)阅读有关表格的更多信息

# java - 使用二分查找按顺序添加到 ArrayList

> ID：15467651
> 
> 赞同：2
> 
> 时间：2013-03-17T23:40:22.003
> 
> 标签：java, search, arraylist, binary

大家好，希望你能在这里帮助我，

我的问题是我需要能够使用二进制搜索来搜索 ArrayList 并找到添加对象的正确位置，以便列表保持有序。我不能使用集合排序，因为这是一个家庭作业。我已经正确实现了一个布尔方法，它告诉列表是否包含您要搜索的项目。该代码在这里：

```
 public static boolean search(ArrayList a, int start, int end, int val){
    int middle = (start + end)/2;
    if(start == end){
        if(a.get(middle) == val){
            return true;
        }
        else{
            return false;
        }
    }
    else if(val < a.get(middle)){
        return search(a, start, middle - 1, val);
    }
    else{
        return search(a, middle + 1, end, val); 
    }
} 
```

我需要做的是使用此方法查看列表中是否已经存在该数字，如果返回 false，那么我需要能够使用另一个二进制搜索来确定列表中的数字（val）应该去哪里。任何帮助都非常感谢，谢谢！！！

贾斯汀

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:46:40.020

好吧，您可以返回搜索中的最后一个索引，而不是返回 true 或 false。因此，如果该值不在 List 中，则返回您访问的最后一个索引，并查看该值是否小于或大于该索引处的当前值，并相应地添加新值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T00:14:10.767

您应该返回已经找到的值位置，而不是返回布尔值。递归解决方案是可以的，但是对于非常大的列表，找到结果将是一个问题。尝试实现基于循环的解决方案，而不是使用循环。我创建了一个小演示，它将帮助您理解它：

```
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class SourceCodeProgram {

    private List<Integer> integers = new ArrayList<Integer>();

    public static void main(String argv[]) throws Exception {
        SourceCodeProgram test = new SourceCodeProgram();
        test.addIntegerToSortedListVerbose(10);
        test.addIntegerToSortedListVerbose(2);
        test.addIntegerToSortedListVerbose(11);
        test.addIntegerToSortedListVerbose(-1);
        test.addIntegerToSortedListVerbose(7);
        test.addIntegerToSortedListVerbose(9);
        test.addIntegerToSortedListVerbose(2);
        test.addIntegerToSortedListVerbose(5);
        test.addIntegerToSortedListVerbose(1);
        test.addIntegerToSortedListVerbose(0);
    }

    private void addIntegerToSortedListVerbose(Integer value) {
        int searchResult = binarySearch(integers, value);
        System.out.println("Value: " + value + ". Position = " + searchResult);
        integers.add(searchResult, value);

        System.out.println(Arrays.toString(integers.toArray()));
    }

    private int binarySearch(List<Integer> list, Integer value) {
        int low = 0;
        int high = list.size() - 1;

        while (low <= high) {
            int mid = (low + high) / 2;
            Integer midVal = list.get(mid);
            int cmp = midVal.compareTo(value);

            if (cmp < 0)
                low = mid + 1;
            else if (cmp > 0)
                high = mid - 1;
            else
                return mid;
        }
        return low;
    }
} 
```

程序打印：

```
Value: 10\. Position = 0
[10]
Value: 2\. Position = 0
[2, 10]
Value: 11\. Position = 2
[2, 10, 11]
Value: -1\. Position = 0
[-1, 2, 10, 11]
Value: 7\. Position = 2
[-1, 2, 7, 10, 11]
Value: 9\. Position = 3
[-1, 2, 7, 9, 10, 11]
Value: 2\. Position = 1
[-1, 2, 2, 7, 9, 10, 11]
Value: 5\. Position = 3
[-1, 2, 2, 5, 7, 9, 10, 11]
Value: 1\. Position = 1
[-1, 1, 2, 2, 5, 7, 9, 10, 11]
Value: 0\. Position = 1
[-1, 0, 1, 2, 2, 5, 7, 9, 10, 11] 
```

# jquery - 仅在 IE10 中闪烁白色条纹（IE10 中的错误？）

> ID：15467653
> 
> 赞同：0
> 
> 时间：2013-03-17T23:40:34.670
> 
> 标签：jquery, internet-explorer, fadein, fadeout, visual-glitch

自从 IE10 出现以来，我的一些客户抱怨我的一些项目中出现了令人讨厌的故障（显示闪烁的白色条纹）。当屏幕的一部分淡入或淡出时会出现此问题。我认为这与不透明度有关。这只是 IE10 的问题，因为其他浏览器的代码没有任何问题，包括早期版本的 IE。

奇怪的是，它并不总是存在，有时没有问题，但总体来说很烦人。举个例子，请访问以下站点（使用 IE10）： [http](http://www.meezingeninrotterdam.nl) ://www.meezingeninrotterdam.nl （这是一个荷兰站点）

下一步：例如单击页面上的搜索图标，您可以在菜单栏的右侧找到它。您会注意到故障（可能也在幻灯片中），如果没有，请关闭对话框并再次打开它。

我认为这是 IE10 中的一个错误，但是当我能够通过对代码稍作更改来解决此问题时，我会尝试一下。

供你参考：

*   使用 jQuery 1.5.1
*   该站点主要基于 Ajax，例如幻灯片和对话框
*   除了 jQuery，我不使用任何第三方代码（或插件）
*   该站点是跨浏览器兼容的，不使用黑客攻击，并且是 W3C 有效的（除了 CSS，这在所有类型的浏览器中都是不可能的）。
*   所有代码都经过编译（Google 附件编译器）或缩小（YUI 压缩器）以进行分发

我不想做的事情：

*   网站结构发生巨大变化
*   仅 IE10 没有额外的 CSS 文件
*   由于一些不兼容问题，更新到较新版本的 jQuery。

我试过的：

*   升级 jQuery，但存在与现有代码不兼容的问题
*   使用原始代码（未缩小）但具有上述相同的问题
*   分析代码但没有找到可能有问题的原因

有人对此有一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T09:59:25.053

经过很长一段时间，我得到了问题的答案（但不是真正的答案）。仍然认为是IE的bug，和使用的硬件有关。我的笔记本电脑中有两张卡，集成显卡和更强大的 NVIDIA 显卡。

IE 默认使用更强大的硬件（NVIDIA 卡）3D 设置，此时出现问题。当我使用 NVIDIA 配置控制台强制 IE 必须使用集成显卡而不是 NVIDIA 显卡时，闪烁问题就消失了。

这不是我的客户的解决方案，因为他们中的大多数人在他们的系统中只有一个图形卡并且对此无能为力。

证明我的代码没有问题，是IE结合系统中使用的显卡（DirectX 3D设置）的问题。

**编辑：** 另见：

*   [http://steamcommunity.com/app/20500/discussions/0/810921273846416279/](http://steamcommunity.com/app/20500/discussions/0/810921273846416279/)

*   [http://www.bit-tech.net/news/bits/2013/03/04/ie10-bug-hybrid-graphics/1](http://www.bit-tech.net/news/bits/2013/03/04/ie10-bug-hybrid-graphics/1)

# javascript - 将参数更改为另一个符号的函数

> ID：15467657
> 
> 赞同：0
> 
> 时间：2013-03-17T23:42:05.517
> 
> 标签：javascript, jquery

我动态创建此列表元素，当单击按钮时，用户输入的信息会显示在其中，“信息”是文本，应该按原样显示，但“等级”是一个数字，我想用函数 changeNumber() 但我是 javascript 新手，不知道如何制作这个函数，任何人都可以提出建议或指出正确的方向吗？

```
 var list = $("#filmlista");
    var list_array = new Array();

    function updateFilmList()
{
        document.getElementById("name").value = '';
        document.getElementById("star").value = 0;
        var listan = list_array[0][0];
        var grade = list_array[0][1];
        var element = '<li class="lista">' + list + '<span class="grade">'+ changeNumber(grade) +'</span></li>';
        list.append(element);

} 
```

我应该使用innerHTML 吗？我不明白它是如何工作的？如果我必须将许多不同的数字替换为数字的符号数量，我该如何使用替换方法？

例如，如果数字是 5，它应该显示为：`*****`，如果数字是 3，则显示为：`***`等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:45:31.510

这是一些应该可以解决问题的代码：

将此函数添加到您的脚本中。

```
function changeNumber(number) {
    var finalProduct = "";

    for (var i = 0; i < number; i++) {
        finalProduct += "*";
    }

    return finalProduct;
} 
```

用此代码替换 updateFilmsList。

```
document.getElementById("name").value = '';
document.getElementById("star").value = 0;
var listan = list_array[0][0];
var grade = changeNumber(list_array[0][1]);
var element = '<li class="lista">' + list + '<span class="grade">'+ grade +'</span></li>';

list.append(element); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:44:25.693

看起来您正在尝试做类似 PHP 的`str_repeat`. 在这种情况下，[`str_repeat`从 PHPJS看一下](http://phpjs.org/functions/str_repeat/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T00:18:42.930

除了循环之外，还有其他选项：

```
function charString(n, c) {
  n = n? ++n : 0;
  return new Array(n).join(c);
}

charString(3, '*'); // *** 
```

您可以使用 innerHTML 来设置元素的文本内容，前提是所有文本都不会被误认为是标记。否则，适当设置 textContent（符合 W3C）或 innerText（IE 专有但广泛实施）属性。

# java - 动态生成视图时忽略 JSF 组件 ID

> ID：15467658
> 
> 赞同：1
> 
> 时间：2013-03-17T23:42:23.387
> 
> 标签：java, jsf, primefaces

我遇到了一点问题。

我通过 c:forEach 标记迭代字符串列表，然后通过 facelets 包含标记来动态生成视图。

这适用于构建布局，但会显示一些奇怪的行为。

我有一个包含 2 个选项卡的 primefaces tabview。对于第一个选项卡（最初显示的选项卡），设置了组件 ID（例如 tabview:categoryTab），但对于第二个选项卡并非如此，这里我只得到 tabview: 用于组件 ID（但它实际上应该成为 tabview:usrTab)

为什么 JSF 会覆盖我为第二个选项卡设置的 id？我是否遗漏了规范中的一些重要信息？

我将 JSF 2 与 Primefaces 3.6（快照构建）一起使用（是的，我故意使用快照构建，并且也使用稳定的 PF 版本对其进行了测试，但是会发生相同的行为）

* * *

编辑

代码：admin.xhtml

```
<ui:composition template="/templates/commonLayout.xhtml">
    <ui:define name="content">
        <p:panel id="parentPanel">
            <h:outputText value="Verwaltung" />
            <br />
            <p:tabView id="tabview">
                <!-- insert marker -->
                <c:forEach items="#{adminTabs}" var="tab">
                    <ui:include src="#{tab}" />
                </c:forEach>
            </p:tabView>
        </p:panel>
    </ui:define>
</ui:composition> 
```

catTab.xhtml

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets">
    <p:tab title="Categories Tab" id="catTab">
            ....
    </p:tab>
</ui:composition> 
```

usrTab.xhtml

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets">
    <p:tab title="Users Tab" id="usrTab">
            ....
    </p:tab>
</ui:composition> 
```

testTab.xhtml

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets">
    <p:tab title="TestTab" id="testTab">
            ....
    </p:tab>
</ui:composition> 
```

内容提供者.java

```
 public class ContentProvider {
    ....

    @Produces
    @Named("adminTabs")
    public List<String> getTabs(){
        List<String> components = new ArrayList<String>();
        components.add("/templates/tabs/catTab.xhtml");
        components.add("/templates/tabs/usrTab.xhtml");
        components.add("/templates/tabs/testTab.xhtml");
        return components;   
    }

    ....

} 
```

这会生成：

```
<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all" role="tablist">
<li class="ui-state-default ui-tabs-selected ui-state-active ui-corner-top" aria-expanded="true" role="tab">
<a href="#tabview:catTab">Categories</a>
</li>
<li class="ui-state-default ui-corner-top" aria-expanded="false" role="tab">
<a href="#tabview:j_idt31">TestTab</a>
</li>
<li class="ui-state-default ui-corner-top" aria-expanded="false" role="tab">
<a href="#tabview:j_idt32">Benutzer und Rollen</a>
</li>
</ul> 
```

因此，重申一下：仅保留第一个选项卡的 id，尽管在 xhtml 代码中设置了其他选项卡的 id...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T23:02:16.947

`id`我遇到了与 Richfaces 4 和 JSF 2 非常相似的东西。我设法通过在属性中包含一个 EL 表达式来绕过它。为了我

```
<h:form id="staticName"> 
```

被渲染成

```
<form id="j_idblah> 
```

但是一旦我这样做了

```
<h:form id="#{_objectInContext}"> 
```

它开始正确渲染。相当hacky，但现在它会工作。祝你好运！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-13T15:18:53.913

I ran into the same problem when including facelets with a c:forEach loop.

What worked for me was specifying the Ids as EL-Constants: id="#{'address_street'}"

# database - Talend ESB 数据库同步

> ID：15467661
> 
> 赞同：0
> 
> 时间：2013-03-17T23:42:38.507
> 
> 标签：database, synchronization, soa, esb, talend

我正在尝试实现 ESB 以连接两个不同的应用程序。我需要同步他们的数据库，也就是说一旦第一个数据库发生变化，应该同时自动反映到第二个数据库上。

第一个应用程序（Java EE/Hibernate）有一个 Oracle 数据库，第二个应用程序（PHP/Symfony2）有一个 MySQL 数据库。我正在使用 Talend Open Studio for ESB V5.2。

我真的需要一些帮助，尤其是我对这个 ESB 事物不熟悉。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-19T09:37:15.297

要获得有关 Talend Open Studio for ESB 的帮助，您可能需要访问 TalendForge 上的教程页面并查看应用程序集成教程。他们应该帮助你：[http ://www.talendforge.org/tutorials/menu.php](http://www.talendforge.org/tutorials/menu.php)

最好的，Talend 数据。

# delphi - jlcSysInfo 中的 Delphi XE3 致命编译错误

> ID：15467665
> 
> 赞同：0
> 
> 时间：2013-03-17T23:43:38.247
> 
> 标签：delphi, delphi-xe3, jedi-code-library

XE3 的新手，当我尝试编译一个带有 JVCL 组件的小型应用程序时，我收到以下错误：

```
[dcc32 Fatal Error] JclSysInfo.pas(1402): F2051 Unit JclRegistry was compiled
with a different version of JclBase.HexFmt 
```

谁能提供一个解决方案？

# c++ - 用 C++ 读写二进制信息

> ID：15467667
> 
> 赞同：0
> 
> 时间：2013-03-17T23:43:43.523
> 
> 标签：c++, file-io, binaryfiles

我在读取和写入二进制信息时遇到了一些问题。我可以成功地将一个简单的字符串写入文本文件，在这种情况下，我的文件 'output.dat' 包含句子“你好，这是一个句子”。

但是，我无法读回我的信息。我无法确定问题所在。我打算稍后更改从二进制文件中读取的信息的每个字节，因此将值作为字符串返回会有所帮助。

感谢您的任何帮助，您可以提供。

```
#include <iostream>
#include <fstream>
#include <string>
using namespace std;

void write(const string &input) {
    fstream output("output.dat", ios::out | ios::binary);
    if (output.is_open()) {
        output.write(input.c_str(), input.size());
        output.close();
    }
}

string read(const string &fname) {
    int size;
    char* buffer;
    fstream input(fname, ios::in | ios::binary);
    if (input.is_open()) {
        input.seekg(0, ios::end);
        size = input.tellg();
        input.seekg(0, ios::beg);
        buffer = new char[size];
        input.read(buffer, size);
        input.close();
    }
    string result(buffer);
    return result;
}

int main () {
    cout << read("output.dat") << endl;

    system("pause");

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:50:27.810

错误就在这里。

```
char* buffer;
input.read(buffer, size); 
```

您正在阅读指向的内存`buffer`。

但它指向哪里？指针`buffer`从未被初始化。

如果你知道你需要多少空间，这样的方法就会奏效。

```
std::vector<char> buffer(size);
input.read(&buffer.front(), size); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:40:05.807

我真的无法理解这段代码出了什么问题，因为它看起来很好，并且对我来说很好用。不过，您分配的缓冲区缺少用于标记字符字符串结束的空终止符。只需将其更改为：

```
buffer = new char[size+1];
input.read(buffer, size);
buffer[size] = 0; 
```

# c# - 将数据库中具有相同id的多行错误下载到xls文件中

> ID：15467669
> 
> 赞同：0
> 
> 时间：2013-03-17T23:43:54.107
> 
> 标签：c#, asp.net, sql, sql-server

我目前正在使用这段代码来下载存储在 sql 数据库中 fildemo 表中的“data”和“data2”列中的错误。

```
 protected void helloGridView_SelectedIndexChanged(object sender, EventArgs e)
        {
            String connectionString = DAO.GetConnectionString();
            String sqlQuery = String.Empty;

            using (SqlConnection con = new SqlConnection(connectionString))
            {
                con.Open();
                sqlQuery = "select data,data2 from filedemo where id=@id";
                SqlCommand cmd = new SqlCommand(sqlQuery, con);
                cmd.Parameters.AddWithValue("id", surgicalGridView.SelectedRow.Cells[1].Text);
                SqlDataReader dr = cmd.ExecuteReader();

                if (dr.Read())
                {

                    HttpContext.Current.Response.ClearContent();
                    HttpContext.Current.Response.AddHeader("content-disposition", "attachment;filename=" + dr["name"].ToString() + ".xls");
                    HttpContext.Current.Response.ContentType = "application/excel";
                    Response.Charset = "";
                    Response.Cache.SetCacheability(HttpCacheability.NoCache);
                    Response.Write(dr["data"] + "\t");
                    Response.Write(dr["data2"] + "\t");
                    Response.End();

                }
            }

        } 
```

我想从具有相同 ID 的不同行中提取错误，并将它们存储在 excel 文件中的单独行中。我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:53:18.900

你试过`Response.Write(dr["data"] + "\t\n\r");`吗？

# c++ - 当有多个合适时设置首选运算符

> ID：15467671
> 
> 赞同：0
> 
> 时间：2013-03-17T23:44:07.857
> 
> 标签：c++, operator-overloading, std

我有一个名为的类`mc_int`，它实际上是一个 int，具有一些特殊能力。它已设置`operator int()`：

```
mc_int::operator int() {
        return value;   //int mc_int::value - the real int value of the class
} 
```

但是当我尝试`cout<<`上课时，我必须始终将课程转换为 int ( `cout<<(int)mc_int_instance`，因为我收到错误：

> 多个运算符“<<”匹配这些操作数。

同样，这可能是由于**该类还** `<<`定义了运算符。在这里做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:57:59.263

如果您使用的是 C++11，则可以使用`explicit`关键字来制作它，因此您必须显式转换为`int`. 更多信息[在这里](http://en.cppreference.com/w/cpp/language/explicit)：

```
explicit mc_int::operator int() 
```

现在，当您使用它时，应该使用`<<`您定义的运算符方法，并且它对编译器应该不再模棱两可。如果您确实想使用 int，只需像您一样或使用`static_cast<int>(the_object)`.

# sql - SQL 根据 select 更新行

> ID：15467677
> 
> 赞同：-1
> 
> 时间：2013-03-17T23:44:36.147
> 
> 标签：sql

我有以下表格的表格

```
id username postcode assign .....
1  dave     123456   1      .....
2  steve    932495   2      .....
.. ..       ..       ..     .....
n  barry    92394    n      ..... 
```

我有一个选择查询，它挑选出相关的用户 ID

```
SELECT id FROM users WHERE postcode LIKE "something" 
```

`assign`对于我的查询选择的所有用户，将列设置为某个预定整数的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-17T23:46:41.880

如果您要更新同一个表中的列，这是一个非常基本的 UPDATE 语句。

```
UPDATE users SET assign = 5 WHERE postcode LIKE "something" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-17T23:46:52.140

尝试这个..

```
update users 
set assign = m
where postcode LIKE "something"; 
```

m 将是您要为这些记录设置的整数。

谢谢！，@leo

# angularjs - AngularJS 和 AngularUI 是如何相互关联的？

> ID：15467680
> 
> 赞同：28
> 
> 时间：2013-03-17T23:45:19.900
> 
> 标签：angularjs, angular-ui

[我想知道AngularJS](http://angularjs.org/)和[AngularUI](http://angular-ui.github.com/)之间的关系是什么？

快速查看贡献者列表似乎表明这两个项目都是由独立团队开发的。

有谁更了解这两个项目之间的关系？

特别有趣的是 AngularUI 提供的东西是否会（有朝一日）合并到 AngularJS 中的问题。这对于诸如[ui-router](https://github.com/angular-ui/ui-router)之类的东西非常有用。

有谁比我更了解;-)？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-18T00:12:48.617

[AngularUI 是一个](https://github.com/angular-ui)最初作为一个项目开始的组织，旨在整合人们在整个社区早期所做的努力，为 AngularJS 创建事实上的小部件和指令（就像 jQueryUI 之于 jQuery）。尽管它开始时是一个包含多个小部件包装器的项目，但它已经发展成为一个具有多个团队和具有不同重点的项目的组织。

虽然我们一开始并没有任何 AngularJS 核心团队成员，但我们一直在与他们密切合作以改进 AngularJS 社区，今天我们有 2 名团队成员（[Pete Bacon Darwin](https://github.com/petebacondarwin)和[Pawel Kozlowski](https://github.com/pkozlowski-opensource)）已被添加到AngularJS 核心团队。

其中一些项目包括：

*   AngularUI（即将分解为 0 依赖实用程序和小部件包装器）
*   UI-Bootstrap：在原生 AngularJS 中重新实现所有 Bootstrap 组件（根据社区和核心团队本身的流行需求）
*   UI-Router：尝试为复杂/嵌套路由创建事实上的解决方案，我们希望最终合并到核心中
*   uiBot (UniBot)：#angularjs 频道的 IRC 机器人
*   NG-Grid：受 SlickGrid 启发的 AngularJS 虚拟网格解决方案

我们也一直在积极与[Jim Hoskins](https://github.com/jimrhoskins)（[ngmodules.org](http://ngmodules.org/)背后的人）交谈，为整个社区创建一个基于 AngularJS 的包分发和组织系统/标准。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-03-17T23:56:02.550

基本上 AngularJS 是 MVC 框架本身，而 AngularUI 是一堆基于 Angular 构建的 UI 组件。[以与jQuery](http://jquery.com)和[jQueryUI](http://jqueryui.com/)相同的方式思考。

有一些实用程序指令，例如`ui-router`和`ui-keypress`，`ui-event`但主要是关于预构建的小部件。

您将在 AngularJS 项目中看不到这样的小部件。没有`tab`、`button`或`calendar`任何其他小部件。只有原始指令、资源和工具才能让您开发项目所需的任何东西。

添加第三个相关项目，而 AngularUI 使用[Twitter Bootstrap](http://twitter.github.com/bootstrap/)布局，AngularUI 团队有一个名为[UI Bootstrap](http://angular-ui.github.com/bootstrap/)的项目，它是通过 AngularJS 而不是 jQuery 实现 Bootstrap 组件。

某些基本指令/服务（如`ui-event`or `ui-keypress`）可能会成为项目的一部分，但由于其性质，没有计划，至少没有明确的计划来合并两个项目。换句话说，小部件（`ui-calendar`, `ui-button`, `ui-date`）几乎不可能被合并。

# android - 我可以使用调试键在手机上运行我的地图应用程序吗？

> ID：15467681
> 
> 赞同：0
> 
> 时间：2013-03-17T23:45:20.030
> 
> 标签：android, google-maps, google-maps-api-3, android-emulator

在安卓中使用谷歌地图服务有两种证书。一个是调试，另一个是生产。我已经使用调试密钥库/证书创建了密钥。我有以下问题：

1) 我在 Eclipse 中创建了几个模拟器，但是当我尝试运行 Map 应用程序时，这些模拟器没有显示在运行选项中。

2) 我可以使用使用调试证书创建的密钥在我的 Android 手机上运行 Map 应用程序吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:00:29.503

对于问题 2：是的。我使用 Google Map v2 运行我的应用程序，并使用我的调试密钥对其进行测试。但是你必须[在 Google API 控制台](https://developers.google.com/maps/documentation/android/start?hl=fr#the_google_maps_api_key)上记录它：

我从来没有在模拟器上运行过地图 API……对不起……

# ios - NSKeyedArchiver 不想编码图案颜色

> ID：15467682
> 
> 赞同：1
> 
> 时间：2013-03-17T23:45:24.650
> 
> 标签：ios, objective-c, xcode

在我正在进行的一个项目中，我让用户选择一种颜色，该颜色将用作某个视图的背景。他们可以选择任何主要颜色（例如“redColor”/“blueColor”）或创建具有自定义 RGB 值的颜色。当他们选择一种颜色时，它会将其存储到“以前使用的颜色”的数组中，以便他们以后想要重新使用它时可以轻松地再次选择它。

现在一切正常，我正在使用以下方法将颜色存储到 NSUserDefaults 中：

```
NSData *data = [NSKeyedArchiver archivedDataWithRootObject:colorArray];
[[NSUserDefaults standardUserDefaults] setObject:data forKey:@"colors"]; 
```

这完美地工作，但是每当我存储带有图案的颜色（例如 underPageBackgroundColor）时，我都会收到警告：

```
we're encoding a color that has a pattern selector (underPageBackgroundColor) but not a system color name - that shouldn't happen 
```

它并没有阻止它工作，它仍然存储颜色，我可以稍后检索它。我应该担心这个错误并将图案颜色存储为字符串，还是应该忽略它，因为它似乎不会导致任何故障？

另外，有人知道这个警告的原因吗？它似乎不是由任何未按预期工作引起的。

# c - TCP 客户端数学运算无法正常工作

> ID：15467683
> 
> 赞同：0
> 
> 时间：2013-03-17T23:45:26.603
> 
> 标签：c

用户输入 2 个数字和 +、-、/、* 并且应该得到答案。问题是，它没有显示他们正确输入的内容，也没有计算。为什么是这样？我提供了一个屏幕截图来显示我得到了什么。我该如何解决？[http://imageshack.us/photo/my-images/404/mathfn.jpg/](http://imageshack.us/photo/my-images/404/mathfn.jpg/)

```
#include <iostream>
using namespace std;

#include <stdio.h>
#include <string.h>
#include <winsock.h>

// Function prototype
void StreamClient(char *szServer, short nPort);

// Helper macro for displaying errors
#define PRINTERROR(s)   \
        fprintf(stderr,"\n%s: %d\n", s, WSAGetLastError())

////////////////////////////////////////////////////////////

void main(int argc, char **argv)
{
    WORD wVersionRequested = MAKEWORD(1,1);
    WSADATA wsaData;
    int nRet;
    short nPort;

    //
    // Check for the host and port arguments
    //
    if (argc != 3)
    {
        fprintf(stderr,"\nSyntax: TCPTimeClient ServerName PortNumber\n");
        return;
    }

    nPort = atoi(argv[2]);

    //
    // Initialize WinSock and check the version
    //
    nRet = WSAStartup(wVersionRequested, &wsaData);
    if (wsaData.wVersion != wVersionRequested)
    {   
        fprintf(stderr,"\n Wrong version\n");
        return;
    }

    //
    // Go do all the stuff a datagram client does
    //
    StreamClient(argv[1], nPort);

    //
    // Release WinSock resources
    //
    WSACleanup();

    printf("\nPlease enter a floating point number: ");
float number1;
scanf("%f", &number1);

printf("\nPlease enter a mathematical operator (+,-,*,/): ");
char mathOperator;
scanf("%f", &mathOperator);

printf("\nPlease enter a floating point number: ");
float number2;
scanf("%f", &number2);

printf("\nCalculating %f %f %f...", &number1, &mathOperator, &number2);

printf("\nPlease enter a floating point number: ");
float number3;
scanf("%f", &number2);

}

////////////////////////////////////////////////////////////

void StreamClient(char *szServer, short nPort)
{
    int nRet;                       // return code
    char szBuf[256];                // client buffer area 
    char szSvr[256];                // server name

    LPHOSTENT lpHostEntry;          // host data structure
    SOCKET  theSocket;              // client socket
    SOCKADDR_IN saClient;           // socket address structure

    //
    // Get local machine name
    //
    nRet = gethostname(szSvr, sizeof(szSvr));

    //
    // Check for errors
    //
    if (nRet == SOCKET_ERROR)
    {
        PRINTERROR("gethostname()");
        return;
    }

    // 
    // Display an informational message
    //
    printf("Datagram Client [%s] sending to server [%s] on port %d...\n",
                                szSvr, szServer, nPort);

    //
    // Find the server
    //
    lpHostEntry = gethostbyname(szServer);
    if (lpHostEntry == NULL)
    {
        PRINTERROR("gethostbyname()");
        return;
    }

    //
    // Create a TCP/IP datagram socket
    //
    theSocket = socket(AF_INET,         // Address family
                       SOCK_STREAM,     // Socket type
                       0);              // Protocol

    //
    // Check for errors
    //
    if (theSocket == INVALID_SOCKET)
    {
        PRINTERROR("socket()");
        return;
    }

    //
    // Fill in the address structure of the server
    //
    saClient.sin_family = AF_INET;
    saClient.sin_addr = *((LPIN_ADDR)*lpHostEntry->h_addr_list);
                                        // ^ Client's address
    saClient.sin_port = htons(nPort);   // Port number from command line

    //
    // Connect to the server
    //
    nRet = connect(theSocket, 
            (struct sockaddr *)&saClient, 
            sizeof(saClient));

    //
    // Check for errors
    //
    if(nRet == SOCKET_ERROR)
    {
      PRINTERROR("Connect()");
      return;
    }

    //
    // Prepare some data to send to the server
    //
    sprintf(szBuf, "From the Client [%s]", szSvr);

    //
    // Send data to the server
    //
    nRet = send(theSocket,                  // Socket
                  szBuf,                    // Data buffer
                  (int)strlen(szBuf),       // Length of data
                  0);                       // Flags

    //
    // Check for errors
    //
    if (nRet == SOCKET_ERROR)
    {
        PRINTERROR("send()");
        closesocket(theSocket);
        return;
    }

    //
    // Zero out the incoming data buffer
    //
    memset(szBuf, 0, sizeof(szBuf));

    //
    // Wait for the reply
    //
    nRet = recv(theSocket,                  // Socket
                szBuf,                      // Receive buffer
                sizeof(szBuf),              // Length of receive buffer
                0);                         // Flags

    //
    // Check for errors
    //
    if (nRet == SOCKET_ERROR)
    {
        PRINTERROR("recv()");
        closesocket(theSocket);
        return;
    }

    //
    // Display the data that was received
    //
    printf("\n%s", szBuf);

    //
    // Close the socket
    //
    closesocket(theSocket);
    return;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:51:59.640

我不明白为什么你不能输入字符，所以我创建了一个测试程序 - 果然是相同的行为！我不经常 scanf()，但我猜想 scanf("%c") 正在抓取缓冲区中的任何字符 - 如果有的话 - 并在我们有机会输入任何内容之前继续。所以我把它完全明确了——为 fscanf/fgetchar 流指定“stdin”并执行 fflush() 以确保在读取之前它是空的。此外，我完全停止使用 scanf() 只是为了获得一个字符。就是这样！这是完整的程序：

```
printf("Please enter a floating point number: ");
float number1;
fscanf(stdin,"%f", &number1);

printf("Please enter a mathematical operator (+,-,*,/): ");
char mathOperator;
//fscanf(stdin,"%f", &mathOperator);

fflush(stdin);
mathOperator = (char)fgetc(stdin);

printf("Please enter a floating point number: ");
float number2;
fscanf(stdin,"%f", &number2);

printf("\nCalculating %f %c %f...", number1, mathOperator, number2);

float result = 0.0F;
switch (mathOperator) {
case '+':
    result = number1 + number2;
    break;
case '-':
    result = number1 - number2;
    break;
case '/':
    result = number1 / number2;
    break;
case '*':
    result = number1 * number2;
    break;
default:
    printf("\nInvalid operator entered!");
}

printf( "\n\nThe answer is %0.1f\n", result );

fflush(stdin);
char ch = getc(stdin);  // wait for keypress 
```

这是测试运行的输出：

```
Please enter a floating point number: 3.4
Please enter a mathematical operator (+,-,*,/): *
Please enter a floating point number: 2

Calculating 3.400000 * 2.000000...

The answer is 6.8 
```

[结束更新]

您使用 printf() 遇到的具体问题是您正在传递浮点值的地址 - 而不是值本身。

```
printf("\nCalculating %f %f %f...", &number1, &mathOperator, &number2); 
```

应该：

```
printf("\nCalculating %f %f %f...", number1, mathOperator, number2); 
```

下一个问题是“mathOperator”——看起来您要求用户输入一个字符，但在 printf() 中指定的数据类型是浮点数。那是行不通的。

所以 printf*真的*应该更像：

```
printf("\nCalculating %f %c %f...", number1, mathOperator, number2); 
```

假设“mathOperator”中有一个“+”、“-”等。

至于它为什么不计算 - 我没有看到（可能只是为了简洁而省略）任何代码来实际进行计算。

[计算更新]

由于唯一允许的运算符是 '+'、'-'、'/'、'*' 并且操作数始终是浮点数，因此计算逻辑非常简单：

```
float result = 0.0F;
switch (mathOperator) {
case '+':
    result = number1 + number2;
    break;
case '-':
    result = number1 - number2;
    break;
case '/':
    result = number1 / number2;
    break;
case '*':
    result = number1 * number2;
    break;
} 
```

然后你可能想添加一个 printf() 来输出结果（和/或通过 TCP 发回）：

```
printf( "The answer is" "%0.1f\n", result ); 
```

如果您进行更高级的计算，您必须担心运算符优先级、类型转换等。一个简单的“案例”是不够的。您需要查看解析器以从表达式构建解析树并根据某些规则（语法）对其进行评估。但相信我——你想先掌握*这个*;-)

请参阅此[问题](https://stackoverflow.com/questions/7597410/how-to-build-parse-tree)以了解所涉及的内容。

# c++ - printf 如何知道格式参数的长度？

> ID：15467690
> 
> 赞同：4
> 
> 时间：2013-03-17T23:46:31.157
> 
> 标签：c++, c, assembly, printf

```
int printf (const char* format, ... ); 
```

这是 printf 的签名。我不明白的是， printf 如何知道第一个参数的长度（`const char* format`）。

它知道开始（因为它是一个指针，我明白了），但指针没有结束之类的。通常当你想打印一些东西时，你必须给出一个长度（例如，Linux 的`sys_write`）那么 printf 是怎么知道的呢？

编辑：

我一直在查看我在 ASM 中编写的代码，我认为它只是在寻找一个`\0`字符。那是对的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-17T23:48:14.147

它是一个以 null 结尾的字符串（与 C 中的所有字符串一样），因此第一个 ASCII NUL（`'\0'`或 plain `0`）字节表示字符串的结尾。

如果你`"meow"`在 C 中有一个字符串，它实际上使用 5 个字节的内存，在内存中看起来像这样。这`\0`显然是一个值为 0 的单字节。

```
meow\0 
```

如果您想知道如何表示实际`'0'`数字：数字 0..9 的 ASCII 值是 48..57，因此在其第三个位置`"me0w"`有`48`字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T00:00:03.127

当一个字符串被正确声明时，它的末尾总是有一个 NULL (\0) 值，该标记用于标记所有这些打印函数的字符串的结尾。如果它被省略（在大多数情况下很难做到），打印函数将保持打印内存，直到它在内存中运行到 0 值。

"Anything" 是一个以 ing \0 结尾的字符数组

编辑： '\0' == 0 和 '0' != 0

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T12:54:29.753

它不知道。试试`printf("Hello \0 World\n");`。`printf`不知道该字符串包含 15 个字符。

# java - 我在 Java 中得到不同的冒泡排序运行时间

> ID：15467692
> 
> 赞同：1
> 
> 时间：2013-03-17T23:46:40.673
> 
> 标签：java, bubble-sort

我创建了一个新的冒泡排序项目，我想知道它需要多少时间。因此，我添加了一个`getTime()`返回 nanotime 的方法。我还创建了一个包含 9 个静态值的数组。当我运行我的代码时，我得到不同的运行时间（即：通常我得到 3849 ns，但有时是 6432 或 4277 ns）。怎么会这样？

我的代码如下：

```
long time2;
public void sort(int[] dizi){
    long time = System.nanoTime();
    for (int i = dizi.length-1; i >0; i--) {
        for (int j = 0; j < i; j++) {
            if(dizi[j]>dizi[j+1]){
                super.swap(dizi, j, j+1);
            }
        }
    }
    time2 = System.nanoTime() - time;
}
public long getTime(long time){
      return time;
}
main(){
      BubbleSort bubbleSort = new BubbleSort();
      int[] arr = {4,2,1,8,9,5,3,7,6};
      bubbleSort.sort(arr);
      Sysout(bubbleSort.getTime(time2));
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:46:13.290

有多种因素可能会影响结果。

JVM 可能会开始运行垃圾收集（这绝对不是您的情况），而运行您的程序 JVM 可能会分配一些内存，并且底层操作系统服务发现它应该交换一些内存，因为它已经用完了可用的 RAM，等等......

没有可用的 JVM（适用于 Mac、Windows 和 Linux/Unix）在实时系统上运行，但即使有一天它会运行 - 您的 JVM 可能会决定您的程序与某些 JVM 活动相比具有较低的优先级。

尝试一些更大的数组，结果会更稳定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:34:11.433

除非您运行的硬件可以准确地测量纳秒（提示 - 它不能），否则 Java 无法为您提供以 ns 为单位的准确时间戳。

最重要的是，Java 在代码的运行时间方面不是确定性的。在任何时候，您的代码都可能被 JVM 正在运行的大量其他内务处理任务打断，尤其是垃圾收集。

还有一个 Hot Spot 编译器，它将识别一段经常运行的字节代码，并将其重新编译为本机代码，这会导致暂停，但随后运行时性能会有所提高。如果你想从方程中去除热点效应，你需要通过运行代码几万次来浸泡测试你的代码，以确保它已被编译为本机代码，然后执行实际的定时运行以查看代码的效率如何。

如您所见，最终结果是代码可以运行多次，产生相同的结果，但返回该结果需要不同的时间，而对于各地的强迫症编码员来说，坏消息是您永远不会使数字相同每次测试运行。

对于这样的性能测试，我通常希望运行代码可能 1000 次，并在我的时间记录上记录最快时间、最慢时间、平均时间和标准偏差，以准确了解特定代码的运行时间。如果出现意外的缓慢运行，我会在 VM 上启用详细 GC 选项时在日志中查找完整的 GC 事件。

哦，别忘了运行你的 JVM 的操作系统也提供了可变数量的运行时，操作系统也有它正在运行的内务处理。

# java - 制作三角计算器时如何处理运算顺序

> ID：15467697
> 
> 赞同：3
> 
> 时间：2013-03-17T23:47:05.547
> 
> 标签：java

更新：不幸的是，我无法完成这项任务，虽然截止日期已经过去，但我觉得我在这方面投入了太多时间，只是把它搁置一边，我知道我已经接近解决方案了。这是我过去几天生成的代码

```
/* 

 "[5*sin(3*t+0.523),4*cos(2*t)]"

*/

import java.util.*;             // 
import javax.swing.*;           // 
import javax.swing.JFrame;      // lets me create the window 
import java.awt.Graphics;       // for drawing 
import java.awt.Point;          // allows the use of points 
import java.awt.Graphics2D;     // for drawing 
import javax.swing.JComponent;  // for drawing 
import javax.swing.JPanel;     // for drawing 
import java.lang.Math;         // for trig 
import java.util.Iterator;
import java.util.LinkedList;
import java.util.Queue;

public class Graph 
{   

//-------------------Queue---String----------------------------------------------------------------//

  public static double[] queue_str(String str, double[] results)
  {
    Queue<Character> token = new LinkedList<Character>();
    Queue<Double> numbers = new LinkedList<Double>();
    double[] t_vals = new double [5];
    int t_vals_len = t_vals.length;
    int numbers_sz = 0;
    int token_sz = 0;
    t_vals[0] = 7.0;
    t_vals[1] = 2.0;
    t_vals[2] = 3.0;
    t_vals[3] = 4.0;
    t_vals[4] = 3.0;
    char temp_token;
    char temp_char; 
    double p1_num = 0, temp_num = 0, p2_num = 0;

    if(results.length == 0){}

    for(int i = 0; i < str.length(); i++)
    {
        if(str.charAt(i) == '*' && str.charAt(i) != 't'  || str.charAt(i) == '+'&& str.charAt(i) != 't' || str.charAt(i) == '-' && str.charAt(i) != 't' || str.charAt(i) == '/' && str.charAt(i) != 't')
        {
            temp_token = str.charAt(i);
            token.add(temp_token);
            token_sz ++;
            String[] parts = str.split("\\" + String.valueOf(temp_token));
            String str1 = parts[0];
            String str2 = parts[1];

            if(str1.matches("-?\\d+(\\.\\d+)?"))
            {
                p1_num = Double.parseDouble(str1);
                numbers.add(p1_num);
                numbers_sz ++;
            }

            if(str2.matches("-?\\d+(\\.\\d+)?"))
            {
                p2_num = Double.parseDouble(str2);
                numbers.add(p2_num);
                numbers_sz ++;
            }
        }
            else if(str.charAt(i) == 't')
            {
                temp_token = str.charAt(i);

                String [] t_char = str.split(String.valueOf(temp_token));

                for(int k = 0; k < t_vals_len; k++)
                {
                    temp_num = t_vals[k];
                    numbers.add(temp_num);
                    numbers_sz ++;
                }
            }

    }
      double[] dbl_numbs = new double [numbers_sz];

      while(numbers.peek()!=null)
      {
           for (int iter = 0; iter < numbers_sz; iter++)
           {
             dbl_numbs [iter] = numbers.poll();
           }  
      }

         while(token.peek()!=null)
          {
               temp_token = token.peek();
               token.poll();

               if(temp_token== '+')
               {

                 eval_inner_add(dbl_numbs, numbers_sz);
                 results = eval_inner_add(dbl_numbs,numbers_sz);

               }
               else if(temp_token == '-')
               {

                eval_inner_add(dbl_numbs, numbers_sz);
               }
               else if(temp_token == '*')
               {
                 results  = eval_inner_multi(dbl_numbs, numbers_sz);

               }
               else if(temp_token == '/')
               {

                eval_inner_div(dbl_numbs, numbers_sz);
               }
          }

      return t_vals;
  }
//-----------------Removing---Brackets-------------------------------------------------------------//  
  public static String [] remove_brackets(String remove_brack)
  {
     String [] substring = remove_brack.split ("[\\[,\\]]");
     String rest_of_str = substring [1];
     String rest_of_str_2 = substring [2];
     return new String [] {rest_of_str,rest_of_str_2};
  } 
//-----------------Removing---Parenthesis-------------------------------------------------------------//    
   public static String [] remove_paren(String remove_paren)
  {
     String [] substring = remove_paren.split ("[\\(,\\)]");
     String rest_of_str = substring [0];
     String rest_of_str_2 = substring [1];
     return new String [] {rest_of_str,rest_of_str_2};
  } 
//---------------Retrieving--Far-Left--Number----------------------------------------------------//  
  public static double get_first_exp (String get_left_exp)  
  {
    double eval_num = 0;

    if(get_left_exp.matches("[-]"))
    {
        String [] check_neg = get_left_exp.split("[\\-]");
        String neg_num = check_neg[0];
        eval_num = Double.parseDouble(neg_num);
        eval_num = eval_num * (-1.0);
        return eval_num;
    }
    else
    {
        String [] parts = get_left_exp.split("[\\/,\\*,\\+]");
        String sub_str_1 = parts [0];
        eval_num = Double.parseDouble(sub_str_1);
        return eval_num;
    }
  }
//-------------Evaluating--equations--containing--sine----------------------------------------//

  public static double eval_sin (String sin_eq)
  {
   double number = 0;
   String [] split = remove_paren(sin_eq);
   String inner_exp = split[1];
   double [] nothing = new double [0];

   number = get_first_exp (sin_eq);
   queue_str(inner_exp, nothing);
   return number;
  }

//-------------Evaluating--equations--containing--cosine----------------------------------------//
  public static double eval_cos (String cos_eq)
  {
   double number = 0;
   double [] nothing = new double [0];
   String [] split = remove_paren(cos_eq);
   String inner_exp = split[1];

   number = get_first_exp (cos_eq);
   queue_str(inner_exp, nothing);
   return number;
  }
//---------------Evalutating--points-------------------------------------------------------------//  
  public static double[] eval_inner_multi (double [] numbers, int numbers_sz)
  {
   String nothing  = "";
   double[] results = new double [numbers_sz];
   double  first_num = numbers[0];
   System.out.println(first_num);

    for(int i = 1; i < numbers_sz-1; i++)
    {
     results[i] = first_num * numbers[i]; 
     System.out.println(results[i]);
    }
      queue_str(nothing,results);
      return results; 
  }

  public static double[] eval_inner_add (double [] numbers, int numbers_sz)
  {
   String nothing  = "";
   double[] results = new double [numbers_sz];
   double  first_num = numbers[0];

    for(int i = 1; i < numbers_sz-1; i++)
    {
     results[i] = first_num + numbers[i]; 
     System.out.println(results[i]);
    }
      queue_str(nothing,results);
      return results; 
  }

  public static double[] eval_inner_sub(double [] numbers, int numbers_sz)
  {
   double[] t_vals = new double [5];
   return t_vals; 
  }

  public static double[] eval_inner_div(double [] numbers,int numbers_sz)
  {
   double[] t_vals = new double [5];
   return t_vals; 
  }
//------------------------------Main------------------------------------------------------------------------//  
  public static void main(String[] args) 
    {
      String left_exp = "";
      String right_exp = "";
      double left_sin_num , right_sin_num, left_cos_num, right_cos_num = 0;

      for(String s: args)  // taking in user input for command line 
      {
           String [] new_str  =  remove_brackets(s);
           left_exp = new_str[0];
           right_exp = new_str[1];
      }

      if(left_exp.contains("sin")) // add SINE, SIN, COSINE, COS
      {
           left_sin_num = eval_sin(left_exp);
      }
      else if (right_exp.contains("sin"))
      {
           right_sin_num = eval_sin(right_exp);
      }
      if (right_exp.contains("cos"))
      {
           right_cos_num = eval_cos(right_exp);
      }
      else if (left_exp.contains("cos"))
      {
           left_cos_num = eval_cos(left_exp);
      }

    } 
```

}

这项任务的目的是创建一个程序来评估参数方程并连接坐标以绘制图形。我遇到的问题是，当我在 queue_str() 函数中发送我的双精度数组以进行评估时，我有两个操作的实例存在于我们面前。我无法正确地将内容发送回 queue_str() 以由第二个操作数评估例如考虑到我的顶级评论中的示例函数我能够发送 3*t 其中 t_vals 是要乘以三个的测试用例. 在这种情况下，我必须将数组的大小设为 -1，因为我必须考虑数组中的第一个和最后一个元素。这就是我卡住的地方我怎样才能正确评估这个表达式？我会很感激任何帮助，我为这一段道歉，我只知道我很接近让它工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-17T23:50:51.563

您应该将表达式解析为树，而不是从左到右评估它们。

```
 sin
   |
   +
  / \
  *  5
 / \
2  t 
```

[此处](https://www.student.cs.uwaterloo.ca/~cs135/handouts/08-trees-post3up.pdf)将对此进行更详细的说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T23:56:33.283

我正在解决与您类似的问题，并且为了使所有事情的顺序正确，我使用了词法分析器和解析器 - 在 Python 中，我使用了 PLY，这里有很好的记录[http://www.dabeaz.com/ply/](http://www.dabeaz.com/ply/) [http ://www.dabeaz.com/ply/ply.html](http://www.dabeaz.com/ply/ply.html)

在文档中，这里很好地说明了解析器期间“幕后”发生的事情：[http ://www.dabeaz.com/ply/ply.html#ply_nn22](http://www.dabeaz.com/ply/ply.html#ply_nn22)

我的标记器/解析器结构的灵感来自于 Java 用来评估其表达式的相同结构。[http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.8](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.8)

如果您以前从未考虑过解析器结构，那么有一些事情需要习惯。如：

- 根标记 - 称之为表达式 - 可以从数字或名称或功能调用或任何其他“组件”升级为，并通过允许将其他所有内容折叠到其中来“增长”以“消耗”整个结构。

- 原始数字或名称在成为表达式之前经过的多级提升令牌 - 每个阶段查看是否可以在允许再次提升之前对其应用从一元到较高优先级到较低优先级的运算符。像 YACC 这样的解析器通过只应用一个规则来完成这项工作，如果它可以选择最大的或者知道它的选择是明确的，否则它会在做出决定之前从标记器中获取更多标记。

- 它的递归性质 - sin(...) 内部是一个参数列表，它是一个表达式或参数列表，表达式，表达式本身可以和外部表达式一样复杂...一旦函数调用发生，在检查运算符的所有优先级后，它将被提升为表达式本身！等等。

一般来说，我会阅读有关 PLY 的文档，因为它可以帮助您理解所有这些:) 如果没有标记和解析，您就不能通过原始字符串/子字符串操作进行表达式计算，我非常努力但是总是有一些边缘案例愚弄了我。

# sql - 带有 max 函数的 select 语句

> ID：15467702
> 
> 赞同：0
> 
> 时间：2013-03-17T23:47:33.347
> 
> 标签：sql, sql-server-2008, select, max

我正在尝试写一份声明，该声明将向我展示超过 2 个月没有接机的客户，我已经有更新程序并且它必须按照

```
update Clients
set StatusID=4
from (SELECT P.ClientID, MAX(p.PickupDate) MaxPickupDate
      FROM Pickup P
      group by P.Clientid) P
     join Clients C on P.ClientID= C.ClientID
where   C.StatusID in (1, 2)and C.WIC=0
      AND P.MaxPickupDate<DATEADD(month,-2,GETDATE()); 
```

我还有其他选择

```
select P.ClientID
   ,LastName+' '+FirstName as Name 
   ,Address
   ,max(p.PickupDate)
from Pickup P
join Clients C on P.ClientID= C.ClientID
where max(p.PickupDate)<DATEADD(month,-2,GETDATE())
group by p.clientid, lastname + ' ' + firstname,address 
```

它应该只向我显示超过 2 个月没有提货的客户，但它给我带来了错误

> 聚合可能不会出现在 WHERE 子句中，除非它位于 HAVING 子句或选择列表中包含的子查询中，并且被聚合的列是外部引用。

看起来它不喜欢这条线 `where max(p.PickupDate)<DATEADD(month,-2,GETDATE())`任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T23:57:28.447

使用 HAVING 而不是 WHERE 因为需要在聚合完成之后而不是之前应用逻辑：

```
select P.ClientID
   ,LastName+' '+FirstName as Name 
   ,Address
   ,max(p.PickupDate)
from Pickup P
join Clients C on P.ClientID= C.ClientID
group by p.clientid, lastname + ' ' + firstname,address
HAVING max(p.PickupDate)<DATEADD(month,-2,GETDATE()) 
```

# windows - Flex - 使用“-lfl”库编译和链接 lex.yy.c 以生成可执行的 a.out

> ID：15467707
> 
> 赞同：1
> 
> 时间：2013-03-17T23:48:38.887
> 
> 标签：windows, gcc, flex-lexer

FLEX 从输入文件 *.lex 或从标准输入读取扫描仪的规范，并生成 C 源文件 lex.yy.c 作为输出。

我从 windows CMD 运行此命令并成功生成 lex.yy.c：

```
> flex inputfile.lex 
```

然后，lex.yy.c 应该编译并与“-lfl”库链接以生成可执行的 a.out。我不知道如何从 Windows 命令行运行此命令...

```
> gcc lex.yy.c -lfl 
```

发生此错误：'gcc' 不是内部或外部命令、可运行程序或批处理文件。

我应该怎么办？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-19T07:23:03.780

例如，如果您的 .lex 文件位于 c:/user/flex 中，则意味着您在文件夹中也包含 gcc.exe。这有助于解决您的错误。还可以生成 a.out

**gcc -oa lex.yy.c -lfl**试试这个

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-29T19:26:31.880

为 gcc 设置你的环境变量这将起作用

# c++ - C++：是否绝对有必要手动分配内存？

> ID：15467709
> 
> 赞同：8
> 
> 时间：2013-03-17T23:49:14.913
> 
> 标签：c++, memory, memory-management

我对 C++ 编程的一些更高级的方面相对较新，而且我在理解是否真的有必要在 C++ 中分配内存时遇到了一些麻烦（无论是通过 malloc、new 等）。例如，在 C 中，我知道您需要分配内存以执行动态大小的数组或其他任务。在 C++ 中，在我看来并非如此，您可以只使用 std::vector、std::string 或其他已通过设计动态调整大小的内置方法。我也明白访问分配的内存比堆栈慢。

因此，考虑到这一点，您是否有时必须在 C++ 中分配内存，如果是，那么其中的一个例子是什么？这当然不包括您的 C++ 代码必须与 C 程序交互的时间。让我们假设程序纯粹用 C++ 编写。

编辑：为了减轻混淆，我知道向量和其他结构正在分配自己的内存，但这是在幕后发生的事情，不需要程序员使用 new、malloc 等，它会自动清理。所以我真正想知道的是，是否有必要在 C++ 中手动执行内存管理

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-17T23:50:21.450

堆栈的大小有限，有些东西不能可靠地放入其中。动态分配的内存也具有*动态*特性，有时在程序执行的某个时刻之前，您不确定数组中需要多少对象或元素。

看看[这个问题](https://stackoverflow.com/questions/408670/stack-static-and-heap-in-c)，它很好地描述了每个可能的用例：

> 当您想要比上述更灵活时，堆分配（动态分配的内存）很有用。通常，调用函数来响应事件（用户单击“创建框”按钮）。正确的响应可能需要分配一个新对象（一个新的 Box 对象），该对象在函数退出后应该保留很长时间，因此它不能在堆栈上。但是你不知道在程序开始时你想要多少个盒子，所以它不能是静态的。

反映您的编辑：事实上，它并不是真正需要的，或者更确切地说，它通常被抽象出来，就像`vector`and的情况一样`string`。您有各种容器，例如`vector`可以为您处理的容器。当您设计自己的类时，我们鼓励您使用[资源分配即初始化](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)(RAII) 技术，该技术抽象出典型的手动内存管理。事实上，在某些情况下，尤其是在处理 C 代码时，我们鼓励您在使用 RAII 的 C++ 类包装器中或使用 C++ 智能指针（例如 C++11 中引入的那些）管理该内存：[`shared_ptr`](http://en.cppreference.com/w/cpp/memory/shared_ptr)和[`unique_ptr`](http://en.cppreference.com/w/cpp/memory/unique_ptr)（它们本身雇用 RAII）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-17T23:56:43.340

> 例如，在 C 中，我知道您需要分配内存以执行动态大小的数组或其他任务。在 C++ 中，在我看来并非如此，您可以只使用 std::vector 或其他已通过设计动态调整大小的内置方法。

`std::vector`但是，它不是建立在魔法和仙尘之上的：它在内部分配内存。

你是对的，在 C++ 中[你很少需要*手动*](http://klmr.me/slides/modern-cpp/)分配内存。在某些情况下，这是最简单的方法¹。关键是 C++ 使手动*释放*完全没有必要，因为析构函数会处理这个问题。

* * *

¹非常*非常*罕见。大多数编写良好的代码根本不需要这个。在处理较低级别的细节时（例如在实现容器时），它有时很有用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-18T00:33:12.477

如果您的问题是，“ *C++ 中是否不需要动态分配的内存？* ”答案是非常必要且非常重要。

如果您的问题是“*使用现代 C++11 类和功能，我的代码需要多久手动使用‘ **new** ’和‘ **delete** ’* ”？

答案是“很少”。大多数 new 和 delete 调用将隐藏在容器（***std::vector***，***std::map***等）和智能指针（**std::shared_ptr**和**std::unique_ptr**）中，并通过调用**std:: :make_shared()**。

您会在极少数情况下需要手动调用“新建”和“删除”吗？这取决于您正在制作的程序类型，但如果它们是视频游戏，我会说是的，可能有 1% 的时间（我的经验，但是 YMMV），您需要使用手动***新建***和***删除*****std ::make_shared()**和**std::shared_ptr** - 不过，这又取决于项目。

一般来说，更喜欢在堆栈上分配的局部变量和成员变量（忽略它们是否在内部分配动态内存），其次更喜欢 C++11 托管的动态内存（智能指针），最后使用***new***和***delete***作为最后的手段，如果性能需要它（但不要预先优化 - 分析并找到真正的瓶颈）。

请注意，仅仅因为您使用智能指针管理内存，并不意味着您应该禁止代码中的所有原始指针 - 即使您的所有内存都被管理，与内存生命周期管理无关的原始指针仍然非常有用.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-18T11:15:29.193

正如您所观察到的，永远不需要`new`与标准容器（`vector`,`map`等）一起使用。

使用智能指针时，使用总是比使用`make_shared`;`new`更好`shared_ptr`。因为`unique_ptr`缺少`make_unique`是一个缺陷（[make_unique 和完美的转发](https://stackoverflow.com/questions/7038357/make-unique-and-perfect-forwarding)），应该尽快解决；出于清晰和异常安全的原因，复制粘贴和使用`make_unique`比自己`new`放入s 更好。`unique_ptr`

如果您正在编写自己的容器，请尽可能尝试编写标准库设施（现有容器和智能指针），这样您就不必担心生命周期管理。

有一个标准设施，`new`预计使用；`std::locale`默认情况下采用 a的模板化构造函数`Facet *`期望`Facet *`分配 by `new`，因为一旦实例`delete static_cast<locale::facet*>(f)`不再使用它，它将被处置。`std::locale`（请注意，它有一个虚拟析构函数。）如果这让您感到不舒服，您可以通过在构建构面时传递参数`std::locale::facet`来安排自己管理构面的生命周期：[所有权/删除区域设置中的构面（std::locale )](https://stackoverflow.com/questions/5330459/ownership-deleteing-the-facet-in-a-locale-stdlocale) .`1``refs`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-18T00:09:02.100

你不需要自己。我一直在做类似下面的事情

```
void foo(MyStruct&v) { v.bar=1234 }
vector<MyStruct> v;
v.push_back(...); 
```

本质上，单个值在堆栈上，而集合在堆栈上，但将所有内容都放在堆中。我从不在我的大多数应用程序中使用 new 关键字或指针。

# c++ - 无法使用 TBB 和 lambda 编译基本 C++ 程序

> ID：15467710
> 
> 赞同：3
> 
> 时间：2013-03-17T23:49:22.567
> 
> 标签：c++, lambda, tbb

我尝试使用 TBB 和 lambda 表达式编写一个基本的 C++ 程序，但我无法编译它。

 `````
#include <iostream>
#include <cstdlib>
#include <tbb/parallel_for.h>
#include <tbb/blocked_range.h>

using namespace std;
using namespace tbb;

void Foo(int number) {
    cout<<number<<endl;
}

void ParallelApplyFoo(int* a, size_t n) {
    parallel_for(blocked_range<size_t > (0, n),
            [ = ](const blocked_range<size_t>& r){
        for (size_t i = r.begin(); i != r.end(); ++i)
                Foo(a[i]);
        }
    );
}

int main(int argc, char** argv) {
    int num = 10;
    int* a = new int[num];
    for(int i = 0; i < num; i++)
        a[i] = i;
    ParallelApplyFoo(a,num);
    return 0;
} 
````  `和编译器消息：

```
main.cpp：在函数'void ParallelApplyFoo（int *，size_t）'中：
main.cpp:25:9：警告：lambda 表达式仅适用于 -std=c++11 或 -std=gnu++11 [默认启用]
main.cpp:26:5: 错误: 没有匹配函数调用'parallel_for(tbb::blocked_range, ParallelApplyFoo(int*, size_t)::&)>)'
main.cpp:26:5: 注意：候选人是：
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:161:6: 注意：模板 void tbb::parallel_for(const Range&, const Body&)
main.cpp:26:5: 错误：'template void tbb::parallel_for(const Range&, const Body&)' 的模板参数使用本地类型 'ParallelApplyFoo(int*, size_t)::&)>'
main.cpp:26:5: 错误: 试图实例化'template void tbb::parallel_for(const Range&, const Body&)'
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:168:6: 注意：模板 void tbb::parallel_for(const Range&, const Body&, const tbb::simple_partitioner&)
/usr/include/tbb/parallel_for.h:168:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：候选人需要 3 个参数，提供 2 个
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:175:6: 注意：模板 void tbb::parallel_for(const Range&, const Body&, const tbb::auto_partitioner&)
/usr/include/tbb/parallel_for.h:175:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：候选人需要 3 个参数，提供 2 个
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:182:6: 注意：模板 void tbb::parallel_for(const Range&, const Body&, tbb::affinity_partitioner&)
/usr/include/tbb/parallel_for.h:182:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：候选人需要 3 个参数，提供 2 个
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:190:6: 注意：模板 void tbb::parallel_for(const Range&, const Body&, const tbb::simple_partitioner&, tbb::task_group_context&)
/usr/include/tbb/parallel_for.h:190:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：候选人需要 4 个参数，提供 2 个
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:197:6: 注意：模板 void tbb::parallel_for(const Range&, const Body&, const tbb::auto_partitioner&, tbb::task_group_context&)
/usr/include/tbb/parallel_for.h:197:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：候选人需要 4 个参数，提供 2 个
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:204:6: 注意：模板 void tbb::parallel_for(const Range&, const Body&, tbb::affinity_partitioner&, tbb::task_group_context&)
/usr/include/tbb/parallel_for.h:204:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：候选人需要 4 个参数，提供 2 个
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:248:6: 注意：模板 void tbb::strict_ppl::parallel_for(Index, Index, const Function&, tbb::task_group_context&)
/usr/include/tbb/parallel_for.h:248:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：推断出参数“索引”的冲突类型（“tbb::blocked_range”和“ParallelApplyFoo(int*, size_t)::&)>”）
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:235:6: 注意：模板 void tbb::strict_ppl::parallel_for(Index, Index, Index, const Function&, tbb::task_group_context&)
/usr/include/tbb/parallel_for.h:235:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：推断出参数“索引”的冲突类型（“tbb::blocked_range”和“ParallelApplyFoo(int*, size_t)::&)>”）
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:228:6: 注意：模板 void tbb::strict_ppl::parallel_for(Index, Index, const Function&)
/usr/include/tbb/parallel_for.h:228:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：推断出参数“索引”的冲突类型（“tbb::blocked_range”和“ParallelApplyFoo(int*, size_t)::&)>”）
在 main.cpp:10:0 包含的文件中：
/usr/include/tbb/parallel_for.h:215:6: 注意：模板 void tbb::strict_ppl::parallel_for(Index, Index, Index, const Function&)
/usr/include/tbb/parallel_for.h:215:6：注意：模板参数推导/替换失败：
main.cpp:26:5：注意：推断出参数“索引”的冲突类型（“tbb::blocked_range”和“ParallelApplyFoo(int*, size_t)::&)>”）
gmake[2]: *** [build/Release/GNU-Linux-x86/main.o] 错误 1

```

我尝试了编译器标志“-std=c++11”和“-std=gnu++11”，然后输出：

```
g++ -std=gnu++11 -o dist/Release/GNU-Linux-x86/test build/Release/GNU-Linux-x86/main.o  
build/Release/GNU-Linux-x86/main.o: 在函数 `tbb::interface6::internal::start_for, ParallelApplyFoo(int*, unsigned int)::{lambda(tbb::blocked_range const&)#1} , tbb::auto_partitioner>::~start_for()':
main.cpp:(.text+0x6): 未定义对 `vtable for tbb::task' 的引用
build/Release/GNU-Linux-x86/main.o: 在函数 `tbb::interface6::internal::start_for, ParallelApplyFoo(int*, unsigned int)::{lambda(tbb::blocked_range const&)#1} , tbb::auto_partitioner>::~start_for()':
main.cpp:(.text+0x26): undefined reference to `vtable for tbb::task'
build/Release/GNU-Linux-x86/main.o: 在函数 `tbb::interface6::internal::start_for, ParallelApplyFoo(int*, unsigned int)::{lambda(tbb::blocked_range const&)#1} , tbb::auto_partitioner>::run(tbb::blocked_range const&, {lambda(tbb::blocked_range const&)#1} const&, ParallelApplyFoo(int*, unsigned int)::{lambda(tbb::blocked_range const&)# 1} 常量&)':
main.cpp:(.text+0x9d): 未定义对 `tbb::task_group_context::init()' 的引用
main.cpp:(.text+0xb5): undefined reference to `tbb::internal::allocate_root_with_context_proxy::allocate(unsigned int) const'
main.cpp:(.text+0xe1): 未定义引用 `tbb::internal::get_initial_auto_partitioner_divisor()'
main.cpp:(.text+0x107): 未定义引用 `tbb::task_group_context::~task_group_context()'
main.cpp:(.text+0x116): 未定义对 `tbb::task_group_context::~task_group_context()' 的引用
main.cpp:(.text+0x12a): 未定义对 `vtable for tbb::task' 的引用
main.cpp:(.text+0x138): undefined reference to `tbb::internal::allocate_root_with_context_proxy::free(tbb::task&) const'
build/Release/GNU-Linux-x86/main.o: 在函数 `tbb::interface6::internal::start_for, ParallelApplyFoo(int*, unsigned int)::{lambda(tbb::blocked_range const&)#1} , tbb::auto_partitioner>::execute()':
main.cpp:(.text+0x251): undefined reference to `tbb::internal::allocate_continuation_proxy::allocate(unsigned int) const'
main.cpp:(.text+0x27b): 未定义引用`tbb::internal::allocate_child_proxy::allocate(unsigned int) const'
main.cpp:(.text+0x313): undefined reference to `tbb::internal::allocate_continuation_proxy::allocate(unsigned int) const'
main.cpp:(.text+0x33d): undefined reference to `tbb::internal::allocate_child_proxy::allocate(unsigned int) const'
main.cpp:(.text+0x4b6): undefined reference to `tbb::internal::allocate_continuation_proxy::allocate(unsigned int) const'
main.cpp:(.text+0x4e8): undefined reference to `tbb::internal::allocate_child_proxy::allocate(unsigned int) const'
main.cpp:(.text+0x585): 未定义引用 `tbb::task_group_context::is_group_execution_cancelled() const'
build/Release/GNU-Linux-x86/main.o：在函数`tbb::interface6::internal::flag_task::~flag_task()'中：
main.cpp:(.text._ZN3tbb10interface68internal9flag_taskD2Ev[_ZN3tbb10interface68internal9flag_taskD5Ev]+0x6): 未定义对 `vtable for tbb::task' 的引用
build/Release/GNU-Linux-x86/main.o：在函数“tbb::interface6::internal::signal_task::~signal_task()”中：
main.cpp:(.text._ZN3tbb10interface68internal11signal_taskD2Ev[_ZN3tbb10interface68internal11signal_taskD5Ev]+0x6)：未定义对“tbb::task vtable”的引用
build/Release/GNU-Linux-x86/main.o：在函数“tbb::interface6::internal::signal_task::~signal_task()”中：
main.cpp:(.text._ZN3tbb10interface68internal11signal_taskD0Ev[_ZN3tbb10interface68internal11signal_taskD0Ev]+0x6)：未定义对“tbb::task vtable”的引用
build/Release/GNU-Linux-x86/main.o：在函数`tbb::interface6::internal::flag_task::~flag_task()'中：
main.cpp:(.text._ZN3tbb10interface68internal9flag_taskD0Ev[_ZN3tbb10interface68internal9flag_taskD0Ev]+0x6): 未定义对 `vtable for tbb::task' 的引用
build/Release/GNU-Linux-x86/main.o:(.rodata+0x20): undefined reference to `typeinfo for tbb::task'
build/Release/GNU-Linux-x86/main.o:(.rodata._ZTVN3tbb10interface68internal11signal_taskE[_ZTVN3tbb10interface68internal11signal_taskE]+0x14): 未定义引用`tbb::task::note_affinity(unsigned short)'
build/Release/GNU-Linux-x86/main.o:(.rodata._ZTVN3tbb10interface68internal9flag_taskE[_ZTVN3tbb10interface68internal9flag_taskE]+0x14): 未定义引用 `tbb::task::note_affinity(unsigned short)'
build/Release/GNU-Linux-x86/main.o:(.rodata._ZTIN3tbb10interface68internal11signal_taskE[_ZTIN3tbb10interface68internal11signal_taskE]+0x8)：未定义对“tbb::task 的类型信息”的引用
build/Release/GNU-Linux-x86/main.o:(.rodata._ZTIN3tbb10interface68internal9flag_taskE[_ZTIN3tbb10interface68internal9flag_taskE]+0x8)：未定义对“tbb::task 的类型信息”的引用

```

我正在使用 Fedora 18（当然安装了 tbb 和 tbb-devel 软件包）。

请问有人有什么想法吗？代码从这里复制：http: [//software.intel.com/en-us/blogs/2009/08/03/parallel_for-is-easier-with-lambdas-intel-threading-building-blocks](http://software.intel.com/en-us/blogs/2009/08/03/parallel_for-is-easier-with-lambdas-intel-threading-building-blocks)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T00:22:04.650

使用 -ltbb 编译器标志解决了它，在这里找到：http: [//goparallel.sourceforge.net/compiling-tbb-programs-and-examples-on-linux-ubuntu/](http://goparallel.sourceforge.net/compiling-tbb-programs-and-examples-on-linux-ubuntu/)。无论如何，谢谢大家的帮助:)``

# ruby-on-rails - 在生产环境中启动 Rails 应用程序

> ID：15467712
> 
> 赞同：2
> 
> 时间：2013-03-17T23:50:08.813
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, web-deployment, production-environment

计划启动您的第一个 Rails 应用程序？我也是，任何可以在启动初始 Rails 应用程序时提供的指南都将非常有用！

话虽如此，将应用程序从开发阶段带到生产阶段的最佳实践是什么？

例如; 我已经读过在 WEBrick 上运行生产服务器是不好的做法，并且香草 MySQL（和 Postgres 就此而言）配置很糟糕。所以最好不要在没有适当调整它们的情况下打开生产。

在生产中启动 Rails 应用程序时，任何其他想法、经验或最佳实践来源都会很棒！理想情况下，我想提前避免尽可能多的问题，所以这是一个关键时刻。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:16:04.987

如果您计划使用 heroku 启动您的第一个应用程序，请参阅以下详细指南：[Heroku 指南](https://devcenter.heroku.com/articles/rails3)。话虽如此，在您将应用程序启动到 heroku 之前，最好的做法是`rake assets:precompile RAILS_ENV=production`. 这会预编译您的资产。完成后，请参阅提供的指南。

# paypal - 如何使用带有签名而不是证书的 PayPal API？

> ID：15467714
> 
> 赞同：0
> 
> 时间：2013-03-17T23:50:09.567
> 
> 标签：paypal

我正在尝试使用该`signature`选项而不是，`certificate`但我没有看到该选项。

![在此处输入图像描述](../Images/9c37ecb7f1a1cb3583f69db3db41e078.png)

我在哪里可以找到签名？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:34:33.410

找到了。我不得不吊销证书才能做到这一点。您显然可以拥有其中一个。

# python - 在linux中获取keystates

> ID：15467715
> 
> 赞同：0
> 
> 时间：2013-03-17T23:50:10.873
> 
> 标签：python, linux, language-agnostic, macros, keyboard

所以我试图让我的`Capslock`钥匙`Escape`在被敲击时，以及`Control`当它与另一个钥匙一起使用时。

如何查看 X 的键状态？Vim 说 /dev/input 中的文件不是文件，这很奇怪，我不能`cat`。

我尝试了这个python代码片段，但它冻结了`read()`：

```
KBD=open("/dev/input/event0",'rb')
event=KBD.read(72) 
```

我也对其他想法持开放态度。`autokey`, `xbindkeys`, `xmacro`, 等等（虽然我试过这些都没有运气）。

编辑：这适用于在 Ubuntu 中运行的 X windows。

# php - 在php中输入变量的弹出框？

> ID：15467717
> 
> 赞同：-2
> 
> 时间：2013-03-17T23:50:21.777
> 
> 标签：php, variables, popup

我正在尝试制作一个添加/删除文件脚本，我想要的是一个脚本，它可以弹出一个窗口，我在其中输入一个字符串，该字符串保存到一个变量中。我找了很久没有运气。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:53:45.353

这是不可能的。PHP 是一种服务器端语言，而 JavaScript（您*可以*在其中使用 创建此类弹出窗口`prompt()`）是一种客户端语言。

最简单的解决方案是创建一个 HTML 表单，其中包含`<input>`用户输入字符串的简单元素。提交表单（使用`<input type="submit">`按钮）时，您的 PHP 脚本（将其名称放在 的`action`属性中`<form>`）接收该值并使其可用，`$_POST['whatever']`假设您`method="POST"`在表单中使用并`name="whatever"`用于文本输入。

当然，您可以使用 CSS 设置该表单的样式，使其看起来有点像 JavaScript`prompt()`对话框。或者您可以实际使用 JavaScript，然后将值放入隐藏字段并使用 JavaScript 提交表单。或者你可以使用 AJAX。但是好的旧形式是最简单的方法。

# sql-server - 如果 in 失败，t-sql 返回一个值

> ID：15467720
> 
> 赞同：0
> 
> 时间：2013-03-17T23:50:36.583
> 
> 标签：sql-server, tsql

我正在使用 T-sql。我需要一些关于我的 SQL 的帮助。我正在使用 IN 语句，例如，我查找 1,32,21 现在某些记录将只有两个数字是否可以以某种方式返回，如果它在列表中，则为“是”和“否” ' 如果不是，那么如果是，则数数。

**更新！！**

```
id  firstName   uid   value name                     amount typeofthing
161 sture       10470   1   Engineer Officer Class 1    1   certificate
444 kumba       10472   1   Engineer Officer Class 1    3   certificate 
```

这是我的数据！如您所见，**UID 10470**
的用户仅持有 1 个证书。我想要实现的是像这样对我的数据有一个新的行

```
id  firstName   uid   value name                     amount typeofthing HasorNot
161 sture       10470   1   Engineer Officer Class 1    1   certificate YES
161 sture       10470   32  Engineer Officer Class 2    1   certificate NO 
161 sture       10470   21  Engineer Officer Class 3    1   certificate NO 
```

并且该数量是根据每种类型的 YES:es 数量计算的。我想让这个得到他们没有的课程/证书的名称？我使用的 SQL 如下。谢谢

```
select  
   tuc.id, tu.firstName, tuc.uid, tuc.value, tc.name, 
   count(tuc.value) over (PARTITION BY tuc.uid) as 'amount', 'certificate' as 'typeofthing' 
from 
   t_user_certificates tuc, t_certificates tc, t_users tu 
where 
   tuc.[value] IN (1,32,21)
   AND tuc.value = tc.id
   AND tu.id = tuc.uid

union 

select 
   tuc.id, tu.firstName, tuc.uid, tuc.value, tc.name, 
   count(tuc.value) over (PARTITION BY tuc.uid) as 'amount', 
   'courses' as 'typeofthing' 
from 
   t_user_courses tuc, t_courses tc, t_users tu 
where 
   tuc.[value] IN(2,16,21) 
   AND tuc.value = tc.id
   AND tu.id = tuc.uid 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T23:57:15.343

`CASE WHEN count(tuc.value) = 0 THEN 'YES' ELSE 'NO' END`如果我没看错，您的选择列表中似乎可能有类似的东西

或者不是，在看到数据更新之后。我认为这会做到：

第 1 步是在 tu 和 tuc 表之间使用外连接。请参阅@marc_s 的评论。
第 2 步是去掉输出中的“id”列，或者允许它为空。看来，如果用户没有给定的证书，tuc 中将没有行，因此该列对所有行都没有意义。
第 3 步是添加一列 `CASE WHEN tuc.value IS NULL THEN 'NO' ELSE 'YES' END AS 'HasOrNot'`

# r - R 的新稳定 Web 界面

> ID：15467730
> 
> 赞同：1
> 
> 时间：2013-03-17T23:51:21.983
> 
> 标签：r, web, interface, cloud, chromebook

寻找基于 Web 的 R 编译器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-17T23:53:12.450

好吧，如果你可以将它安装在你自己的服务器上，*Rstudio 服务器*似乎是要走的路。您将在 Web 浏览器中获得与 Rstudio 桌面几乎相同的界面：

[http://www.rstudio.com/ide/](http://www.rstudio.com/ide/)

如果您只想开发执行 R 代码的特定 Web 应用程序，您还可以查看 Shiny ：

[http://www.rstudio.com/shiny/](http://www.rstudio.com/shiny/)

# spring - Spring JSF 2 查看范围 $Proxy115 没有属性

> ID：15467731
> 
> 赞同：1
> 
> 时间：2013-03-17T23:51:23.663
> 
> 标签：spring, jsf, scope, view-scope

我正在使用 Spring 3 和 JSF 2 创建一个应用程序。我使用了来自[https://github.com/michail-nikolaev/primefaces-spring-scopes](https://github.com/michail-nikolaev/primefaces-spring-scopes)的自定义 ViewScope 实现。我注册了自定义范围。

问题是，当我尝试访问使用视图范围 bean 的页面时，出现以下异常：

```
INFO - ViewScope - Creating bean {editUser}
INFO - EditUser - EditUser() - class[com.myapp.beans.EditUser@f0ac4], rewId[null]
INFO - ViewScope - registerDestructionCallback for bean editUser
INFO - ViewScope - Session event bound sessionBindingListener
INFO - ViewScope - Bean created {com.myapp.beans.EditUser@f0ac4}
2013-03-18 00:30:30 com.sun.faces.lifecycle.ProcessValidationsPhase execute
WARNING: /editUser.xhtml @10,78 value="#{editUser.rewId}": The class '$Proxy115' does not have the property 'rewId'.
javax.el.PropertyNotFoundException: /editUser.xhtml @10,78 value="#{editUser.rewId}": The class '$Proxy115' does not have the property 'rewId'. 
```

当 bean 是会话范围时，一切正常。

我会很感激你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T05:53:31.437

看起来您的问题是由为处理`@Transactional`注释而生成的基于 JDK 的代理引起的。

JDK代理仅针对类实现的*接口*创建（在您的情况下`Serializable)`。因此，您的代理仅具有来自`Serializable`接口的方法（根本没有）。

要解决此问题，您需要切换到另一种代理模式（使用 cglib），例如使用： `@EnableTransactionManagement(proxyTargetClass = true)`. 另外，添加`cglib:cglib-nodep:2.2`到项目的依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T13:37:59.673

这是一个 ViewScope 问题，它会创建虚拟版本，请在此处阅读：http: [//forum.primefaces.org/viewtopic.php? f=3&t=24082](http://forum.primefaces.org/viewtopic.php?f=3&t=24082)

# php - 如何在php和python之间建立连续连接

> ID：15467732
> 
> 赞同：1
> 
> 时间：2013-03-17T23:51:31.407
> 
> 标签：php, python

我想做一个实时应用程序。所以这里是场景 - 我有数据通过我的一个 COM 端口进入我的计算机，然后由 python 获取并显示。为此，我只使用了一个简单的 python`serial`模块，它通过串行端口读取数据并显示它。

现在这些数据对我来说是本地的。出于高端目的，我需要将这些数据发布到我的一个在线网站上，该网站运行着**apache**网络服务器，它将在全球范围内显示数据。

所以为了实时，我需要持续监控串口，取数据，并持续发布到web服务器（PHP端）。（读取串行数据并将其发布到服务器并行运行）。

现在的问题是——

1.  如何*同时*监控来自 COM 端口的数据以将其发布到网络服务器？

2.  如果我连续发送数据，网络服务器如何知道数据是否连续？对于这种方法，我想将数据保存到 webserver 的数据库中，并制作 PHP 脚本来持续监控数据库。告诉我一个更好的方法，如果你有

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:07:53.550

在 Python 方面，最简单的方法是拥有两个线程。线程 1 将从串行线路读取，使用阻塞调用，并将它读取的所有数据放入[线程安全队列](http://docs.python.org/2/library/queue.html)中。线程 2 将抓取队列中的任何内容，将其发布到远程 PHP，（重试直到成功），休眠 2 秒并重复。

从 Python 调用的 PHP 脚本只需要将数据插入数据库。前端 PHP 脚本将从数据库中抓取数据并显示出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:43:27.610

通常，当处理一个在一个接口上接收并在另一个接口上发送的实时应用程序时，您将需要几个线程和至少几个队列。
如果您希望您的程序是事件驱动的（强烈推荐！），您还应该包括在收到输入时触发的事件。

对于您的问题，我建议：

1 个 COM 读取
线程 1 个 COM 写入线程（如果您需要写入）
1 个 PHP 写入
线程 1 个 PHP 读取线程（如果您需要读取）
1 个 COM 输入队列
1 个 COM 输入事件

每次在 com 端口上接收到一些数据时，您都会让 COM 读取线程写入 COM 输入队列，如果您愿意，可以在将其放入队列之前验证这些数据。

然后 COM 输入队列会将 COM 输入事件设置为 true，这充当 PHP 写入队列的“停止”。

然后，PHP 队列将遍历所有已添加到 COM 输入队列的内容，直到它为空，将 COM 输入事件设置为 false，并在再次循环之前等待更多输入。

确保队列是线程安全的，或者在它周围放置一个互斥锁，这里有几个链接可以帮助你：

[Python 锁](http://docs.python.org/2/library/threading.html#threading.Lock)
[Python 事件](http://docs.python.org/2/library/threading.html#event-objects)
[Python 队列](http://docs.python.org/2/library/collections.html#deque-objects)

* * *

对于 Web 服务器端，您应该在向 Web 服务器发送数据时使用 http[`POST`](http://en.wikipedia.org/wiki/POST_%28HTTP%29)消息，根据您在请求中输入的内容，您可以将数据发送到 Web 服务器上的脚本，该脚本将验证、处理和存储它。

不幸的是，我不是这方面的专家，所以我不能给出很多提示。

# c++ - C++ Eclipse 的运行配置

> ID：15467734
> 
> 赞同：3
> 
> 时间：2013-03-17T23:51:39.127
> 
> 标签：c++, eclipse, configuration, eclipse-cdt

我刚刚开始学习 C++，但我无法让 CDT 与 eclipse 一起工作。我已经安装了 MinGW 和 MSYS 1.0。当我尝试第一次运行 Hello World 教程程序时，我收到一条错误消息，类似于“未指定运行程序”。所以，我尝试设置我的运行配置，但我不知道在 C/C++ 应用程序下放置什么。要进入运行配置菜单，我去了运行 > 运行配置。我应该在 C/C++ 应用程序下放置什么来完成这项工作？我的代码编译得很好，但我无法运行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:07:33.510

自从我在 Eclipse 中开发 C++ 以来已经有很长时间了。当然，我可以写很多指令，比如单击哪个复选框以及在哪个文本字段中写什么，但这不会很有趣，不是吗？相反，我强烈建议您首先通过以下方式创建一个**Hello World**项目：

`File -> New -> C++ Project -> Executable -> Hello World C++ Project -> Next -> Next -> Finish`

现在构建它。并尝试运行。你会看到一切正常。现在去`Run -> Run Configurations...`检查它是如何配置的。然后简单地为您的项目做同样的事情。我相信这对您来说会更好，因为您将进行一些练习并了解 Eclipse 如何更好地管理项目。

如果您有麻烦，我当然可以扩展我的答案。

# perl - mod_perl 在输出中使用请求输入属性？提示？

> ID：15467746
> 
> 赞同：1
> 
> 时间：2013-03-17T23:53:01.523
> 
> 标签：perl, mod-perl2

使用 mod_perl2，我正在尝试访问请求参数，例如

```
$r->args() 
```

在输出滤波器中。可能吗？

我考虑过使用[pnotes](http://perl.apache.org/docs/2.0/api/Apache2/RequestUtil.html#C_pnotes_)但是如果我根据请求 ($r) 存储 pnote 引用，我如何在输出过滤器中检索它？似乎[r](http://perl.apache.org/docs/2.0/api/Apache2/Filter.html#C_r_)在输出过滤器中对我不可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T09:23:54.637

对文档的简要检查表明可以使用代码示例访问 Apache2::RequestRec ($r)。

[http://perl.apache.org/docs/2.0/user/handlers/filters.html#HTTP_Request_Output_Filters](http://perl.apache.org/docs/2.0/user/handlers/filters.html#HTTP_Request_Output_Filters)

# javascript - 通过 HTML5 文件和 URL API 正确创建和提供 PDF Blob

> ID：15467747
> 
> 赞同：27
> 
> 时间：2013-03-17T23:53:09.360
> 
> 标签：javascript, html, file, blobs

好的，假设我在某处存储了文档数据，我们随意取[这个 pdf](http://www.grida.no/climate/ipcc_tar/wg1/pdf/tar-01.pdf)。

问题 #1。我想要做的是对该 URL 进行 AJAX 调用（因为我需要传递一些身份验证标头并且它是跨域的）。然后获取返回的数据，为其创建一个[blob url](https://developer.mozilla.org/en-US/docs/DOM/window.URL.createObjectURL)，将 iFrame 附加到 DOM，并将其定向`src`到 blob url。

目前我的代码如下所示：

```
$.ajax({
  url:'http://www.grida.no/climate/ipcc_tar/wg1/pdf/tar-01.pdf'
}).done(function(data){
   var file = new Blob([data], {type:'application/pdf'}),
       url = URL.createObjectURL(file),
       _iFrame = document.createElement('iframe');
      _iFrame.setAttribute('src', url);
      _iFrame.setAttribute('style', 'visibility:hidden;');
      $('#someDiv').append(_iFrame);
}); 
```

不幸的是，我在 iFrame 中收到“无法渲染 PDF”。

问题 #2。我希望这会导致文件下载提示。不确定如何保证这一点，因为 PDF 自然只会显示在 iFrame 中。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-05-23T10:42:00.770

jQuery.ajax 当前不支持 blob，请参阅此[错误报告 #7248](http://bugs.jquery.com/ticket/7248) ，该报告已作为 wontfix 关闭。

然而，在没有 jQuery 的情况下对 blob 进行 XHR 处理很容易：

```
var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://www.grida.no/climate/ipcc_tar/wg1/pdf/tar-01.pdf', true);
xhr.responseType = 'blob';

xhr.onload = function(e) {
  if (this.status == 200) {
    // Note: .response instead of .responseText
    var blob = new Blob([this.response], {type: 'application/pdf'}),
        url = URL.createObjectURL(blob),
        _iFrame = document.createElement('iframe');

    _iFrame.setAttribute('src', url);
    _iFrame.setAttribute('style', 'visibility:hidden;');
    $('#someDiv').append(_iFrame)        
  }
};

xhr.send(); 
```

无耻地从[HTML5rocks](http://www.html5rocks.com/en/tutorials/file/xhr2/)复制。

*如果 jQuery 确实支持 Blob 类型*，它可以很简单：

```
$.ajax({
  url:'http://www.grida.no/climate/ipcc_tar/wg1/pdf/tar-01.pdf',
  dataType:'blob'
})... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-07T08:46:51.267

我已经使用@Ciantic 的答案来调整我的答案。我避免使用 iframe obj，用户可以直接从页面下载文件。

```
var link = 'http://www.grida.no/climate/ipcc_tar/wg1/pdf/tar-01.pdf';
$("body").addClass("loading"); // adding the loading spinner class

var xhr = new XMLHttpRequest();
xhr.open('GET',link,true);
xhr.responseType = 'blob';

        xhr.onload = function(e){
                 if (this.status == 200) {
                    var a = document.createElement('a');
                    var url = window.URL.createObjectURL(new Blob([this.response], {type: 'application/pdf'}));
                    a.href = url;
                    a.download = 'report.pdf';
                    a.click();
                    window.URL.revokeObjectURL(url);
                    $('body').removeClass("loading"); //removing the loading spinner class
                  }else{
                      $('body').removeClass("loading") //removing the loading spinner class
                      console.log(this.status);
                      alert('Download failed...!  Please Try again!!!');
                  }
            };
            xhr.send(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-16T11:03:09.117

```
var src_url = your url here;
var contentDisposition = 'AlwaysInline';
var src_new = src_url.replace(/(ContentDisposition=).*?(&)/, '$1' + contentDisposition + '$2'); 
```

通过这样做，您将能够查看 pdf 而不是下载它，

Header ContentDisposition 应该是“AlwaysInline”，然后它只会显示您的文件而不是下载它。

# php - 在循环中为数组赋值

> ID：15467752
> 
> 赞同：-1
> 
> 时间：2013-03-17T23:53:22.540
> 
> 标签：php, arrays, foreach

我正在运行一个循环：

```
$array = $_POST['d'];

foreach($array as $a){
    print_r($a);
} 
```

$array 包含数组（数组的数量不同），结果我得到了这个。我只想知道如何在循环中单独调用这些值。例如：$thing = methv 的值。我想在循环中调用这个值，所以每次它运行时都会有数组中的下一个值等

```
Array ( 
   [1173627548] => Array ( 
     [num] => 1173627548 
     [methv] => dont know 
     [q1] => - 
     [q2] => - 
     [q3] => U 
     [q4] => - 
     [comm] => 
    ) 
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T04:50:57.707

试试这个 ：

```
$array = $_POST['d'];

foreach($array as $a){
   $thing = $a['methv'];
} 
```

# deployment - WAR 不会从自动部署中重新部署到 Glassfish 中

> ID：15467756
> 
> 赞同：2
> 
> 时间：2013-03-17T23:53:39.813
> 
> 标签：deployment, glassfish-3, autodeploy

我第一次将 WAR 放在`domains/domain1/autodeploy`dir 下时就能够部署它。但是，在进行了一些更改并将 WAR 重新部署到`autodeploy`目录后，这些更改没有被拾取。我什至删除了`domains/domain1/applications/myapp`（`myapp`对应于`myapp.jar`正在部署的位置），但没有重新部署 WAR。服务器通过以下方式启动和停止`asadmin`：

```
asadmin start-domain
asadmin stop-domain 
```

我做错了什么以至于应用程序没有被重新部署？

**更新：** 我尝试手动（重新）部署（也使用`--force`选项）WAR，但出现以下错误`server.log`：

```
[#|2013-03-17T20:47:36.177-0400|SEVERE|glassfish3.1.2|javax.enterprise.system.tools.admin.org.glassfish.deployment.admin|_ThreadID=72;_ThreadName=Thread-2;|Application with name myprojectname is already registered. Either specify that redeployment must be forced, or redeploy the application. Or if this is a new deployment, pick a different name|#] 
```

我不知道如何取消注册/取消部署曾经部署过的应用程序。我尝试删除对我的应用程序的所有引用，`domain.xml`但没有成功。这似乎是软件中一个非常基本的错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-12-29T03:45:24.697

我知道这是很久以前回答的，但如果其他人像我一样通过谷歌到达这里，我还有另一个可能的答案......

遇到同样的问题后，我发现以下内容...... autodeploy/.autodeploystatus 目录仍然有一个文件引用我试图通过将战争复制到 autodeploy 目录来重新部署的应用程序。我不得不删除 autodeploy/.autodeploystatus 目录中的文件，然后在将战争复制到 autodeploy 目录时部署了我的应用程序。

希望有帮助。

注意：显然，对于使用 glassfish 的其他人来说，[很明显](https://java.net/jira/browse/GLASSFISH-20234?focusedCommentId=360753&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-360753)，您必须从隐藏的 .autodeploystatus 目录中删除所有这些内容才能让您的重新部署工作。为什么对他们来说很明显？我们可能永远不会知道。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T14:40:36.477

您可以通过 asadamin 取消部署：

```
asadmin undeploy yourapplication 
```

您还可以访问 glassfish 管理控制台`http://localhost:4848`并通过图形界面取消部署（查看应用程序）。

一般来说，重新自动部署应该可以工作，但我建议使用正常的部署方法或通过像 NetBeans 这样的 IDE 进行增量重新部署......

# orchardcms - 如何升级 Orchard 中的模块

> ID：15467763
> 
> 赞同：0
> 
> 时间：2013-03-17T23:53:54.570
> 
> 标签：orchardcms

有人可以向我解释如何升级分类模块吗？我目前正在运行分类模块的 1.4 版，我看到当前版本是 1.4.2。

我必须在后端禁用模块并克隆 contrib.taxonomies 的新源并在 VS 中重建吗？

我正在运行 Orchard 的 1.6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T18:04:38.703

除非在模块的发行说明中另有说明，否则您可以简单地用新源覆盖旧源（或使用库中的新版本过度安装它，或者您将其作为克隆存储库，然后只需更新到提示）。数据库迁移会自行解决，您不必重新构建解决方案，因为动态编译将在下一页加载时编译新代码。（也就是说，除非您部署了禁用动态编译的 Orchard 站点。）

# string - Matlab：如何比较两个字符串数组，然后选择与这些字符串关联的数值？

> ID：15467768
> 
> 赞同：0
> 
> 时间：2013-03-17T23:54:51.843
> 
> 标签：string, matlab, compare

我有一个字符串数组，我想用它来从我拥有的更大的数据矩阵中提取样本。现在我有一个字符串数组，`1200x1`. 我的实际数据“名称”（表示值对应的字符串数组，`6855x1`“数据”是`6855x2`.

这就是我想出的：

```
C = intersect(names,sites) %To find common strings 
```

%要查找这些字符串在我的原始数据集中的位置：

```
Q=zeros(length(C),1)
for i=1:length(C)
    for j=1
   while strcmp(C(i),names(j))==0
       j=j+1
       Q(i)=j
   end 
    end
end 
```

%然后使用上面的值来编译一个新向量，其中包含来自“数据”的实际数据值：

```
A=zeros(length(Q),1)
for i=1:length(Q)
A(i) = mock(Q(i),1) 
```

唯一的问题是我正在运行我现在列出的第二组循环，很明显这需要几个小时。我认为必须有一种更快的方法，而无需设置三个循环。有谁知道更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:46:37.800

首先要注意的是，您在 Q 上的循环可以轻松加速，如下所示：

```
A = mock(Q,1); 
```

尽管我怀疑您的意思是数据（Q，2）。

如果您将您的名单存储在一个元胞数组而不是常规数组中，您应该能够进一步加快速度。假设数据是一个元胞数组、名称{1:6855} 和值列表编号(1:6855)。

```
A = zeros(length(C),1);
for i1=1:length(C)
    A(i1)=numbers(strcmp(C(i1),names));
end 
```

# ruby - ruby 中的静态变量，就像在 C 函数中一样

> ID：15467769
> 
> 赞同：3
> 
> 时间：2013-03-17T23:54:51.977
> 
> 标签：ruby

Ruby 中的静态变量之类的东西会像在 C 函数中那样表现吗？

这是我的意思的一个快速示例。它将“6\n7\n”打印到控制台。

```
#include <stdio.h>

int test() {
        static int a = 5;
        a++;
        return a;
}

int main() {

        printf("%d\n", test());
        printf("%d\n", test());

        return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T00:02:06.650

Ruby中没有与 C 变量等效的语法`static`，而且我从未在具有相似抽象级别的语言中看到类似的东西，例如 Javascript、Python、Elixir 等。

我对这段 C 代码的理解是，第一次调用函数时，编译器会用初始值初始化变量。后续调用只会获取变量的当前值。

这就是我用红宝石术语翻译相同逻辑的方式：

```
def test()
  @a ||= 5 # If not set, set it. We need to use an instance variable to persist the variable across calls.
  @a += 1 # sum 1 and return it's value
end

def main()
  puts test
  puts test
  0
end 
```

这也适用于课堂之外。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T00:08:24.267

在方法中限定变量并返回 lambda

```
def counter
  count = 0
  lambda{count = count+1}
end

test = counter
test[]
#=>1
test[]
#=>2 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-18T00:04:29.913

类似于 nicooga 的答案，但更独立：

```
def some_method
  @var ||= 0
  @var += 1
  puts @var
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-18T00:01:55.853

您可以使用全局变量：

```
$a = 5
def test
  $a += 1
end

p test #=> 6
p test #=> 7 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-05T13:32:10.123

在单例类中使用变量（静态类本身）

```
class Single
  def self.counter
    if @count  
      @count+=1
    else
      @count = 5
    end
  end
end 
```

在 ruby​​ 中，任何类都是只有一个实例的对象。因此，您可以在类上创建一个实例变量，它将作为“静态”方法工作；）

输出：

```
 ruby 2.5.5p157 (2019-03-15 revision 67260) [x86_64-linux]

=> :counter
   Single.counter
=> 5
   Single.counter
=> 6
   Single.counter
=> 7 
```

要在主范围内获得此行为，您可以执行以下操作：

```
module Countable
  def counter
    if @count  
      @count+=1
    else
      @count = 5
    end
  end
end

=> :counter
   self.class.prepend Countable # this "adds" the method to the main object
=> Object
   counter
=> 5
   counter
=> 6
   counter
=> 7 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-18T01:29:53.533

我认为执行此操作的标准方法是使用`Fiber`.

```
f = Fiber.new do
  a = 5
  loop{Fiber.yield a += 1}
end

puts f.resume # => 6
puts f.resume # => 7
... 
```

# android - 是否可以检测到应用程序从哪里请求 httpRequest？

> ID：15467770
> 
> 赞同：0
> 
> 时间：2013-03-17T23:54:53.450
> 
> 标签：android

假设我有**两个**应用程序，都从以下位置请求同一个`php`文件：
**`http://www.blablabla.com/request.php`**.

作为用户的某人是否有可能检测到这两个应用程序是从同一个地方请求的？

# sql-server - 带有 Rails 4 的 MS SQL 服务器

> ID：15467772
> 
> 赞同：8
> 
> 时间：2013-03-17T23:55:35.733
> 
> 标签：sql-server, ruby-on-rails-4

我想在 Rails 4 上创建一个使用现有 MS SQL 数据库的应用程序。此应用程序可以从使用 Rails 4 及其所有新功能中受益匪浅但似乎每个人都推荐使用的 gem - activerecord-sqlserver-adapter 不支持 rails 4.0.0 - [https://github.com/rails-sqlserver/ activerecord-sqlserver-adapter/issues/250](https://github.com/rails-sqlserver/activerecord-sqlserver-adapter/issues/250) 有人可以建议是否有其他方法可以在不使用此 gem 的情况下连接到 MS SQL Server？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-01T21:41:15.210

我只是在寻找相同的叉子时发现了这个叉子：[https](https://github.com/arthrex/activerecord-sqlserver-adapter) ://github.com/arthrex/activerecord-sqlserver-adapter 。不能说它有多完整。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-30T11:37:21.220

您可以尝试使用下面的[gem](http://rubygems.org/gems/sic-activerecord-sqlserver-adapter)将 MS SQL Server 5 和更高版本与 Rails 4 一起使用。

```
sudo gem install sic-activerecord-sqlserver-adapter 
```

这肯定适用于 Rails 4，我已经尝试过了。谢谢。

另一个好消息，为 activerecord-sqlserver-adapter 发布了 rails 4 支持版本

现在我们可以将下面的 gem 用于带有 Rails 4 的 MS-SQL

```
gem 'activerecord-sqlserver-adapter', '~> 4.0.0' 
```

以及运行时依赖项

```
activerecord ~> 4.0.0 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-20T15:32:25.730

来自问题的讨论有更新：[https ://github.com/rails-sqlserver/activerecord-sqlserver-adapter/pull/278](https://github.com/rails-sqlserver/activerecord-sqlserver-adapter/pull/278)

恕我直言，到目前为止（我可以测试的）最好的分支是[https://github.com/annaswims/activerecord-sqlserver-adapter/tree/rails-4](https://github.com/annaswims/activerecord-sqlserver-adapter/tree/rails-4)，主要是为了让测试基地的进展保持透明。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-01T19:09:17.230

该适配器现在也支持 v4.2。 [https://github.com/rails-sqlserver/activerecord-sqlserver-adapter](https://github.com/rails-sqlserver/activerecord-sqlserver-adapter)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-12T22:18:55.603

[rails-sqlserver/activerecord-sqlserver-adapter](https://github.com/rails-sqlserver/activerecord-sqlserver-adapter/)现在根据[https://github.com/rails-sqlserver/activerecord-sqlserver-adapter/issues/250支持 rails 4](https://github.com/rails-sqlserver/activerecord-sqlserver-adapter/issues/250)

# css - 在 Internet Explorer 10 中移动或配置 ::-ms-clear

> ID：15467775
> 
> 赞同：7
> 
> 时间：2013-03-17T23:55:55.723
> 
> 标签：css, internet-explorer-10

在 IE10 中，包含值的焦点文本框将`x`在它们的右侧添加一点。这`x`允许用户单击文本框以清除其值。

其他[问题](https://stackoverflow.com/questions/10842665/internet-explorer-10-windows-8-remove-text-input-and-password-action-icons/10854498#10854498)涉及从用户视图中删除此功能，但除了在文本框右侧添加我自己的图标（例如搜索图标）之外，我还想保留该功能。不幸的是，这些图标最终会发生碰撞，所以我需要确定一种移动图标的方法，而我的搜索从未出现任何结果。

[`::-ms-clear`](http://msdn.microsoft.com/en-us/library/windows/apps/hh465740.aspx)我一直试图回答的问题：IE10+伪元素可以使用哪些其他属性？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-17T23:55:55.723

**更新**：正如另一位回答者所指出的，MS 文档已于 2013 年 6 月 19 日更新，以包含[`::-ms-clear`](http://msdn.microsoft.com/en-us/library/windows/apps/hh465740.aspx). 目前尚不清楚这是否适用于 IE10 而不是当前即将推出的 IE11，因此我将在下面留下其余的答案。

为了完整起见，他们还更新了 的文档[`::-ms-reveal`](http://msdn.microsoft.com/en-us/library/windows/apps/hh465773.aspx)，这似乎与`::-ms-clear`.

下面的答案至少适用于 IE10。

* * *

我找不到详尽的清单，这导致我进行实验：

```
::-ms-clear {
   margin: *; /* except margin-left */
   background: *;
   color: *;
   display: none|block;
   visibility: *;
} 
```

不幸的是，我无法欺骗 IE 的开发人员模式 (F12) 向我显示`::-ms-clear`样式树中的属性，所以我不得不手动尝试并重新加载页面以进行实验。我什至尝试通过添加作弊`onblur=this.focus()`，但这不起作用。

做了一些事情并且看起来很有用的 CSS 属性：

*   `margin`: 边距给了我一种从文本框右侧移动它的方法。我将它移动了图标的大小，再加上 1-3 个像素以提供缓冲区。只是`margin-left`似乎不起作用。
*   `background`: 刚刚的背景`x`。应用任何`background`设置都会将您想要的内容放在后面；它不能代替`x`！
*   `color`：控制 的颜色`x`。
*   `display`：作为让我来到这里的问题笔记，`none`将隐藏`x`.
*   `visibility`: 似乎可以像预期的那样工作，类似于`display`.

您**可以**组合`color`和`background`用不同的背景图像**替换**它`x`，只要它适合给定大小的`x`，这似乎是大约 20 像素，但这只是我的眼球。

```
::-ms-clear {
    color: transparent;
    background: no-repeat url("../path/to/image") center;
} 
```

*做了一些事情*，但似乎没有用的 CSS 属性：

*   `padding`：它会影响`x`，但从未像我实际预期的那样影响它（一切似乎都隐藏了图标，或者至少将其移出视线）。
*   `position`：与 相同的行为`padding`。诚然，我更像是一个程序员而不是一个设计师，所以这可能是我自己的缺点。

我猜想可能会做一些事情的 CSS 属性，但根本没有做任何事情：

*   `text-align`
*   `float`

添加其他 CSS 伪元素不会影响`::-ms-clear`. 具体来说，我尝试使用它`::after`，但没有一个得到结果。`::before``content: "y"`

显然，这取决于您打算应用于文本框的配套图标的大小，但我使用 14-16 像素的图标，我发现这`margin-right: 17px`给出了`x`一个明显的间隙，这会将`x`我的右对齐图标的左侧移动。有趣的是，`margin-left`似乎没有任何效果，但您可以为`margin-right`.

我最终使用的实际 CSS 阻止了我的图标被`x`.

```
[class^="tbc-icon-"]::-ms-clear, [class*=" tbc-icon-"]::-ms-clear {
    margin-right: 17px;
} 
```

我的图标都共享相同的基本名称，`tbc-icon-`，这意味着`::-ms-clear`伪元素会在应用时自动应用于所有图标。在所有其他情况下，伪元素以其默认方式运行。

有趣的是，`::-ms-reveal`似乎行为方式相同，如果您要将图标应用于密码字段（我期望的可能性要小得多），那么您可以按照上面的示例进行操作：

```
[class^="tbc-icon-"]::-ms-clear, [class*=" tbc-icon-"]::-ms-clear,
[class^="tbc-icon-"]::-ms-reveal, [class*=" tbc-icon-"]::-ms-reveal {
    margin-right: 17px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-01T14:14:20.103

至少可以在 MS 网站上找到一份清单。 [http://msdn.microsoft.com/en-us/library/windows/apps/hh465740.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/hh465740.aspx)

（但也许我误解了这个问题。）

# c# - 尝试调试时打开保存对话框

> ID：15467777
> 
> 赞同：0
> 
> 时间：2013-03-17T23:55:55.970
> 
> 标签：c#

当我尝试调试我的程序时，保存对话框打开并要求我保存我的一个类，如果关闭对话框没有任何反应，如果我按保存它会说“访问*类*的文件路径被拒绝”并且它不会调试。如果我只是删除导致问题的类并将其代码复制粘贴到具有相同名称的新类中，它会工作一段时间，但是一旦我向该类添加更多代码，就会出现同样的问题，我不知道是什么做这件事，感谢任何想法。可能值得一提的是，它是一个团队项目，使用 teamfoundation 源代码控制，可能与此有关，但不确定。

# java - 由文本文件动态生成的球和迷宫之间的碰撞检测

> ID：15467781
> 
> 赞同：0
> 
> 时间：2013-03-17T23:56:32.163
> 
> 标签：java, android, maze

好的，所以我正在创建一个球倾斜游戏，你可以在迷宫中导航一个球。球有效，并且在该区域一切都很好，但是我在迷宫中遇到了一些问题。

迷宫是通过包含 1 和 0（1 是墙，0 是地板）的 .txt 文件以编程方式创建的。我有一个 for 循环遍历整个 .txt 文件并放置一个白色（墙壁）或黑色（地板) 在画布上的适当坐标处形成正方形。[如果您已经看到它的链接](https://code.google.com/p/apps-for-android/source/browse/#git/Amazed/src/com/example/amazed)，这类似于apps-for-android Amaze 游戏。然而，他没有在他的瓷砖上放置墙壁类型检测，而是重置游戏并在用户滚动到“空”瓷砖上时扣除生命值。

但是，我希望有“墙壁”而不是“空隙”。如果球碰到墙壁，它不会超过那个点，但仍然可以在另一个轴上自由移动。当然，除非它撞到角落。

我遇到的问题实际上是创建此检测。我尝试了多种方法，但到目前为止没有任何方法成功或有用。

我尝试过： - 有一个包含墙砖所有坐标的 ArrayList，并且每次游戏滴答声，它都会检查球是否接触到一个。然而，这只是让游戏慢下来，非常糟糕。- 检查球在哪个瓷砖上，如果它在墙瓷砖上，让它停在一个轴上，但让它在另一个轴上自由移动，但这仍然不起作用，因为当球在时出现了一些问题在墙砖的右侧，但也在其下方，它无法向上移动，因为代码检测到它在球下方。

还有其他一些方法，但我真的不记得了！有点忙。

所以，我在问，如果有人在这方面有任何经验，请他们给我推动正确的方向吗？我希望能在周二之前对迷宫墙进行分类，但它看起来很糟糕！

如果您需要更多信息，请询问。

预先感谢您的任何和所有回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T02:51:38.530

与其拥有一个必须迭代的 ArrayList，为什么不以与文本文件相同的方式存储迷宫呢？使用填充`true`了墙壁和`false`地板的 2D 布尔数组，反之亦然。

这大大简化了查找墙壁的过程。您所要做的就是弄清楚球在网格中的位置。然后你可以检查它周围的细胞。即使您包括对角线（这对于全 90 度迷宫来说可能不是必需的），这也等同于检查数组中的 8 个布尔值，基本上是即时的。

至于轴的问题，就停止*那个方向*的运动。无需冻结整个轴。例如，如果墙是你的权利，只是不允许`x`走高。除非左边有一堵墙，否则没有理由不让它降低。

不过，这只是一个普遍的想法。因为这是家庭作业，所以没有代码给你；）

**编辑：**

2D 阵列就是这样，`boolean[][]`它适用于您想要墙壁的每个位置。当您读入文本文件时，只需立即分配它。

假设文本中的每一行对应`y`一行，并且每个 0/1 是该`x`列的，当您阅读 a 时`1`， assign `map[x][y] = true`。

老实说，我不确定您还需要详细说明什么。不过，这是制作基于图块的简单地图的常用格式。如果你用谷歌搜索“2d array tile map”，你会找到一些资源来帮助它。

# sockets - Erlang：进程何时终止以及 gen_tcp:controlling_process(Socket, Pid) 是如何工作的？

> ID：15467788
> 
> 赞同：1
> 
> 时间：2013-03-17T23:57:03.487
> 
> 标签：sockets, process, erlang

我想知道的是，`Pid`如果使用创建控制进程`gen_tcp:controlling_process(Socket, Pid),`以及套接字在什么条件下发送此消息，则当套接字关闭时进程是否终止`{tcp_closed, Socket}`？有没有办法防止服务器端的套接字关闭，或者这总是正常的？还有什么特定的方法可以终止一个知道的进程`Pid`吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T08:44:56.977

gen_tcp:controlling_process(Socket, Pid) 用于将 Socket 的控制权交给进程 Pid。当 Socket 关闭时，它不暗示该进程的行为。

有需要考虑的情况：

*   您以 {active,false} 模式打开服务器 Socket，在这种情况下，服务器会在调用 gen_tcp:recv(Sock, Len) 得到答案 {error, closed} 而不是预期的函数时知道 Socket 已关闭{好的，二进制}。如果您打算使用 gen_tcp:controlling_process(Socket, Pid)，我建议您使用此模式，因为它允许您避免代码中的竞争条件。

*   您以 {active,true} 或 {active,once} 模式打开服务器 Socket，这种情况下，服务器会收到一条消息 {tcp_closed, Socket}。在这种情况下，存在竞争条件，请参阅主题[Erlang: Avoiding race condition with gen_tcp:controlling_process](https://stackoverflow.com/questions/11409656/erlang-avoiding-race-condition-with-gen-tcpcontrolling-process)

我认为服务器的作用不是阻止任何 Socket 关闭，而是始终准备好接受连接。

最后，总是可以终止一个进程，使用你自己的协议来顺利结束，例如 Pid ！{stop,Reason} 或更粗暴的方式使用 exit(Pid, Reason)。

# c - 如何求解具有指数函数的联立非线性方程？

> ID：15467792
> 
> 赞同：2
> 
> 时间：2013-03-17T23:57:41.140
> 
> 标签：c, static-libraries, simultaneous, equation-solving, nonlinear-functions

我有一个方程组来求解`x1`和`x2`：

```
2*erf(A*x2)*exp(B*x1^2+C*x2^2)-D*erf(x1)=0

2*erf(D*x2)*exp(E*x1^2+F*x2^2)-G*erf(x1)-erf(H*x2)*exp(I*x1^2)=0 
```

其中`B`和`C`是负数，而其余常数是正数。

我尝试使用 GSL 库中的多根函数在 C 中解决它。似乎多根无法解决系统问题。我为非线性同时多项式函数（其中没有指数部分）尝试了相同的多根实现，它运行良好并给出了正确的结果。关于如何解决这样一个系统的任何建议？或者任何其他可用于此类方程的强大库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:24:11.543

寻找一种数值方法，例如备受推崇的[“数值食谱”一书。](http://www.nr.com)求解非代数方程是一个广阔而复杂的领域。这样的方程组更是如此。

# java - Slick2D 碰撞检测 - 奇怪的运动

> ID：15467793
> 
> 赞同：0
> 
> 时间：2013-03-17T23:57:42.177
> 
> 标签：java, collision-detection, slick2d

我目前使用的集合检测方法可以解释碰撞，但会根据方向产生奇怪的效果。它会：

*   如果玩家击中对象的右侧，则始终工作。
*   如果玩家击中对象的顶部或底部，则将玩家推到一边。
*   如果玩家撞到对象的左侧，则第一次工作，但下次在左侧检测到碰撞时会将玩家传送到对象的另一侧。

这是当前的碰撞检测代码：

```
if(player.playerBounds.intersects(portal.bounds)&&player.isMovingLeft){
       player.playerX=(portal.x+portal.width);
       player.playerX++;
    }
    else if(player.playerBounds.intersects(portal.bounds)&&player.isMovingRight){
        player.playerX=(portal.x-player.width);
        player.playerX--;
    }
    else if(player.playerBounds.intersects(portal.bounds)&&player.isMovingUp){
        player.playerY=(portal.y+portal.height);
        player.playerY--;
    }
    else if(player.playerBounds.intersects(portal.bounds)&&player.isMovingDown){
        player.playerY=(portal.y+player.height);
        player.playerY++;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T02:17:35.847

在这里回答我自己的问题。前进方向的标志从未改变过，这是问题的根源。一个方向是正常的，因为它与我通常会进入的第一个方向对齐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T02:31:06.867

你可以试试下面的代码，看看它是否有效？

```
bool collide = player.playerBounds.intersects(portal.bounds);

if(collide && player.isMovingLeft){
   player.playerX = (portal.x + portal.width) + 1;
}
else if(collide && player.isMovingRight){
    player.playerX = (portal.x - player.width) - 1;
}
else if(collide && player.isMovingUp){
    player.playerY = (portal.y + portal.height) + 1;
}
else if(collide && player.isMovingDown){
    player.playerY = (portal.y + player.height) - 1;
} 
```

可能的原因可能是：

*   多次检查碰撞。
*   移动玩家正在改变移动的方向。
*   其他一些代码与此代码冲突。
*   isMovingX 无法正常工作。

# java - 找出我从文件中得到多少数组元素（还不知道列表）

> ID：15467801
> 
> 赞同：0
> 
> 时间：2013-03-17T23:58:00.677
> 
> 标签：java, arrays, io

我需要帮助制作一个数组列表，以便在我从文本文件中读取数组时找出数组需要多少个元素。我还没有学会如何做到这一点，我们将不胜感激。如果我没有正确存储在数组中，我将显示需要修复的代码部分，因为我得到 null。这篇文章需要帮助，但下面是完整的代码。

```
public static void output(tokens[], correct[], percentage[], letterGrade[], double      totalAVG, int highScore, int lowScore)
 { 
PrintWriter pw = new PrintWriter(new FileWriter("Result.txt")) ;

for (int t=0 ; t< tokens.length ; t+=2 )
{   
    g = 0 ;
    pw.println(tokens[t] + "," + correct[g] + percentage[g] + letterGrade[g]) ;
    g++ ;
}
    pw.println("Average: " + totalAVG + "% (" + totalGrade + ")") ;
    pw.println("High Score: " + highScore*2) ;  
    pw.println("Low Score: " + lowScore*2) ;

pw.close() ;

import java.util.* ;
import java.io.* ;

public class Proj5 
{

public static void main(String[] args) throws IOException
{

Scanner s = new Scanner(System.in) ; 
```

/* 这部分打开与文件的连接，分割每一行，然后将这些部分放入一个数组（令牌）中。*/

```
String[] tokens= information(fileCheck) ; 
```

/* * * 打开到带有 id 和答案的文件的连接，并将它们分开返回。* @param (String a) 拉入文件名以在方法中使用 * @return 返回一个包含拆分文件的数组。*/

```
public static String[] information(String a) throws IOException
{   
    Scanner inFile = new Scanner (new File(a)) ; // opens connection with file
    String[] quarters = new String[] ;
    int index = 0 ;
    int lengthArray = 0 ;
    while (inFile.hasNext()) 
    {
        lengthArray++ ;
    }   
    while (inFile.hasNext()) 
```

// 当文件中有更多行时循环

```
 String line = inFile.nextLine() ;           // brings in next line to be broken up
        String[] array = line.split(",") ;
        quarters[index] = array[0]  ;           //stores lines into array tokens
        index++ ;
        quarters[index] = array[1] ;
        index++ ;
    }       
        inFile.close() ;                            // close connection to file
        return quarters ;
} // end information 
```

/** * (打印出需要的信息) * * @param 拉入数据数组 * @param 拉入数字正确数组 * @param 拉入百分比正确数组 * @param * (列出所有参数，每行一个) * @ return None */ public static void output(tokens[], correct[], percent[], letterGrade[], double totalAVG, int highScore, int lowScore) { PrintWriter pw = new PrintWriter(new FileWriter("Result.txt") ) ;

```
for (int t=0 ; t< tokens.length ; t+=2 )
{   
    g = 0 ;
    pw.println(tokens[t] + "," + correct[g] + percentage[g] + letterGrade[g]) ;
    g++ ;
}
    pw.println("Average: " + totalAVG + "% (" + totalGrade + ")") ;
    pw.println("High Score: " + highScore*2) ;  
    pw.println("Low Score: " + lowScore*2) ;

pw.close() ; 
```

} // 结束输出

} // 结束类

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:27:49.093

我太矮了，爬不了那堵墙。我会给你一个 ArrayList 的例子：

```
ArrayList<String> dinosaur = new ArrayList<String>(); // <String> is an explicit type declaration

    // This will reference one line at a time
    String line = null;
    int i=0;
    try 
    {
      // FileReader reads text files in the default encoding.
      FileReader fileReader = new FileReader("file.txt");

      //create buffered reader obj 
      BufferedReader bufferedReader = new BufferedReader(fileReader);

//while not EOF, store line in array element
      while ( (line = bufferedReader.readLine ()) != null) {

        dinosaur.add(line);

        i++;
      }

      // Always close files.
      bufferedReader.close();
    }
    //handle exceptions
    catch(FileNotFoundException e) 
    {
      System.out.println("Unable to open file" + e);
    }
    catch(IOException e) 
    {
      System.out.println("Error reading file" + e);
    } 
```

这将从文本文件中读取每一行并将其作为字符串存储在 ArrayList 中（尽管 List 更常见）。ArrayList 是动态的，因此您不需要知道要存储多少元素（文件中的行数）......只要堆栈中有足够的内存来处理它：p

希望这会有所帮助=)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:27:56.737

以下是一些方法：

1）是提前读取文件，计算它有多少行（例如使用扫描仪的HasNextLine（[http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner. html#hasNextLine()](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html#hasNextLine())），然后您可以将数组初始化为那么大并再次计数。

2）是使用一个集合，例如`ArrayList<String>`并在遍历文件时简单地向其中添加行。ArrayList 会根据您的需要自动调整大小以包含尽可能多或尽可能少的条目，因此您不必事先担心文件计数的行数。使用它在概念上与数组相同 -`[i]`可以在 ArrayList 上正常工作，以及更改 ArrayList 中的条目数`add`而`remove`不是编辑已经存在的条目数的方法。

# sql - 创建表，检查可能的文本值

> ID：15467802
> 
> 赞同：1
> 
> 时间：2013-03-17T23:58:21.233
> 
> 标签：sql, ms-access

我正在使用 MS Access 2010，并且正在尝试使用 SQL 创建表。我想加入一些检查约束，但我遇到了一些麻烦：

```
CREATE TABLE Test (
tester Text CHECK (tester IN ('ABC', 'BCD', 'CDE'))
); 
```

我收到语法错误，

有什么建议么？

谢谢！

编辑：对不起，如果我不清楚。我实际上想要的是检查测试人员是“ABC”、“BCD”还是“CDE”，这些是他唯一可以拥有的值。

EDIT2：我尝试了别的东西：

```
CREATE TABLE Test (
tester Text NOT NULL,
CONSTRAINT m_pk PRIMARY KEY(tester),
CONSTRAINT check_tester CHECK (DATALENGTH(tester) > 2)
); 
```

我也得到一个语法错误。检查文本值有什么我真的不理解的吗？我不可能看到其中任何一个是错误的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T01:57:52.777

从 Jet 4 开始，`CHECK`从 ADO 执行的 Access DDL 支持约束，但从 DAO 不支持。

您可以执行单个 DDL 语句，该语句`Test`使用您的约束创建表。您无需执行一条语句来创建表，然后执行另一条语句来添加约束。

```
CREATE TABLE Test
    (
        tester TEXT(255),
        CONSTRAINT ABC_or_BCD_or_CDE CHECK
            (
                tester IN ('ABC', 'BCD', 'CDE')
            )
    ); 
```

我以这种方式对其进行了格式化，以便更容易检查这些作品。您可以使用此 VBA 执行语句：

```
strSql = "CREATE TABLE Test ( tester Text(255)," & vbCrLf & _
    "CONSTRAINT ABC_or_BCD_or_CDE" & vbCrLf & _
    "CHECK ( tester IN ('ABC', 'BCD', 'CDE')));"
Debug.Print strSql
CurrentProject.Connection.Execute strSql 
```

笔记：

*   `CurrentProject.Connection`是一个 ADO 对象，所以它的`.Execute`方法成功。使用（DAO 方法）的相同语句`CurrentDb.Execute`将失败。
*   使用 ADO，将字段声明为`TEXT`不包含长度（`tester TEXT`而不是`tester TEXT(255)`）将为您提供备注字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T00:31:47.097

您将需要针对连接运行：

```
ssql = "CREATE TABLE Test (tester Text)"
CurrentProject.Connection.Execute ssql

ssql = "ALTER TABLE test ADD CONSTRAINT " _
     & "myrule CHECK (tester IN ('ABC', 'BCD', 'CDE'))"
CurrentProject.Connection.Execute ssql 
```

或者

```
sSQL = "CREATE TABLE Test (tester Text, " _
     & "CONSTRAINT myrule CHECK (tester IN ('ABC', 'BCD', 'CDE')))" 
```

请注意，在这种情况下，名称 myrule 必须不存在，即使对于不同的表也是如此。

一些注意事项：[是否可以在访问和/或 DAO 中创建检查约束？](https://stackoverflow.com/questions/1660512/is-it-possible-to-create-a-check-constraint-in-access-and-or-dao)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-18T00:42:11.730

我的错，似乎 MS Access 不允许检查约束，除了主键和外键。我的老师直到去年才用 Oracle 教授她的课程，显然没有看到这不能在 MS Access 中完成。

# php - 基于布尔 PHP 变量的条件 CSS

> ID：15467804
> 
> 赞同：0
> 
> 时间：2013-03-17T23:58:36.467
> 
> 标签：php, html, css

仅当特定的 PHP 变量为 true 并且该变量的其他 CSS 负载为 false 时，我如何才能获得特定的 CSS 负载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T00:04:41.390

```
<link rel="stylesheet" type="text/css" href="<?php echo ($var) ? "css1" : "css2"; ?>.css"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T00:02:21.293

将它放在 2 个单独的文件中，并根据布尔状态加载正确的文件，或者使用 if 语句根据布尔状态在文档中回显您想要的代码。

```
<style type='text/css'>
  <?php
    if(boolean)
    {
      echo "elementName { attribute: value; } ";
      echo "elementName2 { attribute: value;} ";
    }
    else
    {
       //echo css here
    }
  ?>
</style> 
```

或者，在 head 标签中：

```
<?php

    if (boolean)
    {

      echo "<link rel='stylesheet' type='text/css' href='1.css'>";

    }
    else
    {

      echo "<link rel='stylesheet' type='text/css' href='2.css'>";

    }
?> 
```

此外，形式与内容；将 CSS 保存在单独的文件中并根据变量加载特定的 CSS 脚本而不是将 CSS 与 HTML 混合起来会更实用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-18T00:01:43.417

在您的 HTML 页面中`<head>`，您可以在 PHP 中编写一些简单的条件来包含或不包含 CSS：

```
<?php

    if ($yourCondition)
    {
?>
    <link rel="stylesheet" type="text/css" href="http://path/to/css1.css" />

<?php
    }
    else
    {
?>
    <link rel="stylesheet" type="text/css" href="http://path/to/css2.css" />
<?php
    } 
```

注意：避免使用内部样式，因为所有样式都应该在 CSS 中（表示层与 HTML 分离，HTML 是结构和数据层）

# php - php将mysql单元格插入div

> ID：15467805
> 
> 赞同：0
> 
> 时间：2013-03-17T23:58:37.073
> 
> 标签：php, mysql

我有一个包含值的 SQL 表

```
weight_lbs | height_inches|  img_location

150   |   70   |    70_150.jpg

150  |    75  |     75_150.jpg

160   |   70   |    70_160.jpg

160   |   75  |     75_160.jpg 
```

PHP代码：

```
if (isset($_GET['gender'])&&isset($_GET['weight'])&&!empty($_GET['gender'])&&!empty($_GET['weight'])) {

$gender = $_GET['gender'];
$height = $_GET['height'];
$weight = $_GET['weight'];

$query = "SELECT `gender`, `height_inches`, `weight_lbs`, `img_location` FROM `tablename` WHERE `gender`='$gender' AND `height_inches`='$height'";

  $query_run = mysql_query($query);

  if ($query_run = mysql_query($query)) {

while ($query_row = mysql_fetch_assoc($query_run)) {

  $gender = $query_row['gender'];
  $height= $query_row['height_inches']; 
  $img_name = $query_row['img_location']; 

         }
        }
      } 
```

我想使用 PHP 运行 SQL 查询以`img_location`根据`weight_lbs`字段获取单元格。所以选择`weight_lbs = 150`将返回`70_150.jpg` 和`75_150.jpg`

然后我想`70_150.jpg`放入某个 DIV（高度为 70）（可能通过使用它设置为的变量），然后`75_150.jpg`放入另一个 DIV（高度为 75）可能具有不同的变量。

我在考虑 mysql_results 函数，做类似的事情

```
$height70 = mysql_results($query_run, $height=70, img_location)

$height75 = mysql_results($query_run, $height=75, img_location) 
```

但这行不通。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:24:45.200

你的`mysql_results()`参数是错误的。

从手册 - h​​ttp: [//php.net/manual/en/function.mysql-result.php](http://php.net/manual/en/function.mysql-result.php)

> 字符串 mysql_result ( 资源 $result , int $row [, mixed $field = 0 ] )

您需要`row`在第二个参数中引用，如果您使用的是`column`名称而不是偏移量，则它需要用引号`""`/`''`

```
$height70 = mysql_results($query_run, 0, "img_location")
$height75 = mysql_results($query_run, 1, "img_location") 
```

这假定`70`是返回的第一行`[0]`，并且`75`是返回的第二行`[1]`。

* * *

注意：从手册页的顶部 -

> **警告**
> 自 PHP 5.5.0 起不推荐使用此扩展，并将在未来删除。相反，应该使用[MySQLi](http://www.php.net/manual/en/book.mysqli.php)或[PDO_MySQL扩展。](http://www.php.net/manual/en/ref.pdo-mysql.php)另请参阅[MySQL：选择 API](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)指南和[相关的常见问题解答](http://www.php.net/manual/en/faq.databases.php#faq.databases.mysql.deprecated)以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:26:08.773

我无法确切地看到您在这里想要实现的目标，但作为一个陈述点，这有帮助吗？

```
$query = '
    SELECT height, img_location
    FROM your_table
    WHERE weight = "150"
';

$result = mysql_query($query) 
    or die(mysql_error());

while ($row = mysql_query($result)) {

    $weight_150[$row['height']] = $row['img_location'];
} 
```

现在根据您在示例表中给出的值，

```
// $weight_150['70'] will return 70_150.jpg
// $weight_150['75'] will return 75_150.jpg 
```

# mysql - 确定结果是哪个行号 - mysql

> ID：15467807
> 
> 赞同：0
> 
> 时间：2013-03-17T23:59:18.130
> 
> 标签：mysql

我怎样才能找到表格中特定行的数字结果？

例如，带有名称和评级的表（评级不会保持不变），

```
| name  |  rating  |
+-------+----------|
|  me   +     14   |
+-------+----------|
|  you  +    15    |
+-------+----------| 
```

该查询一次只能选择一行，因此我想将其合并到其中。

`select name,rating,?????? from table where name = 'you' ORDER BY rating`

我怎样才能回来`'you','15','2'`？

我觉得我在这里错过了一些非常简单的东西......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:05:54.277

这没关系：

```
SELECT @i:=@i+1 AS iterator, t.name, t.rating
FROM table t,(SELECT @i:=0) foo 
```

# ios - 将 `lastModified` 记录添加到 Core Data 托管对象

> ID：15467812
> 
> 赞同：4
> 
> 时间：2013-03-18T00:00:06.900
> 
> 标签：ios, macos, core-data

一个对象需要提交到服务器，我想通过显示`lastModified`日期/时间和`lastSubmitted`日期/时间来向用户表明该对象需要提交。

（是的，必须手动提交记录。）

我目前正在侦听`NSManagedObjectContextObjectsDidChangeNotification`，检查对象的实体是否为`RetailLocation`，如果是，则设置其`lastModified`日期/时间（当然，仅当`lastModified`不是唯一被修改的属性时）。由于这似乎高度混淆了撤消管理器，我用它`performSelector:SOMESEL withObject:retailLocation afterDelay:0.0`来设置`lastModified`属性。

可悲的是，这几乎更糟：这导致两个动作被添加到撤消堆栈中！

有人可以推荐一种`lastModified`在 Core Data 管理的记录中实现属性的好方法吗？或者，我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:21:55.053

如果您不希望修改日期不可撤销，您可以`disableUndoRegistration`在进行更改之前和完成后调用您的 NSUndoManager `enableUndoRegistration`。

如果你需要一个，你可以通过调用你的 NSManagedObjectContext 来获得一个指向 NSUndoManager 的指针`undoManager`，但是如果你在 iOS 中工作，你应该已经有了一个。

此外，请注意 Apple 建议`NSManagedObjectContextWillSaveNotification`为此使用通知，因为不一定会保存更改。

# ruby - 为什么这段代码需要 8 分钟才能完成？

> ID：15467813
> 
> 赞同：1
> 
> 时间：2013-03-18T00:00:15.177
> 
> 标签：ruby

这是项目欧拉问题之一的（相当糟糕的）解决方案。问题是要找到第 10_001 个素数。下面的代码做到了，但运行需要 8 分钟。你能解释一下为什么会这样以及如何优化它吗？

```
primes = []
number = 2.0

until primes[10000] != nil
  if (2..(number - 1)).any? do |n|
    number % n == 0
  end == false
    primes << number
  end
  number = number + 1.0
end

puts primes[10000] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T00:17:30.600

素数发现的一些简单优化：

*   首先将 2 推入素数列表，然后检查 3 是否为素数。（这消除了为数字 0 到 2 编写特殊情况代码的需要）

*   您只需要检查主要候选人的奇数。（或者，如果您从添加 2/3/5 并检查 7 开始，则只需在执行 % 6 后检查 1 或 5 的数字。或者......你明白了）

*   你只需要看看你当前的候选人`x`是否可以被直到 sqrt( `x`) 的因子整除——因为上面的任何因子都会`sqrt(x)`将 x 分成下面的数字`sqrt(x)`，并且你已经检查了所有这些。

*   你只需要检查你的素数列表中的数字，而不是所有数字，`x`因为所有合数都可以被素数整除。例如，81 是 9*9 - 但 9*9 是 3*3*9，9 是合数，因此当您与 3 对比时，您会发现它是质数。因此，您永远不需要测试 9 是否是一个因数，依此类推，适用于每个复合因子。

有非常优化、加速的素数查找功能（请参阅[阿特金筛法](http://en.wikipedia.org/wiki/Sieve_of_Atkin)开始），但这些是很容易提出的常见优化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T00:06:03.513

您真的需要检查该数字是否与所有先前的数字相除吗？只检查你已经发现的较小的素数。另外，为什么在整数非常好的地方使用浮点数？

**编辑：**

一些可能的变化（不是最好的算法，可以改进）：

```
primes = [2, 3, 5]
num = 7

until primes[10000]
  is_prime = true
  i = 0
  sqrtnum = Math.sqrt(num).ceil
  while (n=primes[i+=1]) <= sqrtnum
    if num % n == 0
      is_prime = false
      break
    end
  end
  if is_prime
    primes << num
  end
  num += 2
end

puts primes[10000] 
```

在我的电脑上（1000 个素数）：

```
 Yours:
real    0m3.300s
user    0m3.284s
sys     0m0.000s

 Mine:
real    0m0.045s
user    0m0.040s
sys     0m0.004s 
```

# c# - 识别对象的属性

> ID：15467814
> 
> 赞同：0
> 
> 时间：2013-03-18T00:00:20.847
> 
> 标签：c#, asp.net-mvc

我正在编写一个控件，它将生成一些 JavaScript 以将表格行写入 HTML 表格并绑定回服务器端的 IEnumerable。

有什么方法可以识别：

1.  每个对象有多少个字段
2.  这些属性被称为什么以及
3.  他们的数据类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:07:18.950

是的，它被称为反射。或者您可以简单地以声明方式提供这些值，例如当您创建 GridView 并指定列时......

[http://msdn.microsoft.com/en-us/library/ms173183(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/ms173183(v=vs.110).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T00:13:56.830

看看`Type`班级和`PropertyInfo`班级。

# c# - Asp.net datagrid - 将米格式化为英尺

> ID：15467815
> 
> 赞同：0
> 
> 时间：2013-03-18T00:00:29.007
> 
> 标签：c#, asp.net, gridview

使用asp.net 4.5，我有一个绑定到sqlserver 表的gridview。

我有一列浮点类型，其中包含以米为单位的距离值。

但是，我想以英尺为单位向用户显示价值，最后以英尺为单位。

喜欢：3.28 英尺

是否有机会对用户看到的内容进行复杂的转换？

此外，如果用户输入“3.28 英尺”的值，我想将其转换为米并将其存储到数据库中。这也可能吗？

如果其中任何一个是可能的，你能指出我如何做到这一点的大方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T03:09:15.557

您可以使用 CellFormatting 和 CellParsing 事件来控制向用户显示的内容与实际基础数据值之间的差异。CellFormatting 发生在数据值显示之前，并允许您在将其呈现给用户之前对其进行编辑。CellParsing 发生在用户编辑值之后，并允许您将输入值从一种或多种格式转换回原始数据类型。

[MSDN 关于 CellFormatting](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellformatting.aspx)
[MSDN 关于 CellParsing](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellparsing.aspx)

# java - 接近警报类不会触发 Android

> ID：15467818
> 
> 赞同：0
> 
> 时间：2013-03-18T00:00:47.007
> 
> 标签：java, android, google-maps, proximity

我正在尝试根据所选标记的位置设置接近警报，其坐标存储在外部文件中并读入数组，然后再绘制坐标。

```
 googleMap.setOnInfoWindowClickListener(
            new OnInfoWindowClickListener(){
     public void onInfoWindowClick(Marker marker) {

         LatLng clickedMarkerLatLng = marker.getPosition();
                double lat =  clickedMarkerLatLng.latitude;
                double long1 =  clickedMarkerLatLng.longitude;

            Log.e("hello", "Output=" + lat + long1);

     LocationManager lm;
    // double lat=0;
 //  double long1=0;    //Defining Latitude & Longitude
     float radius=3000;

    lm=(LocationManager) getSystemService(LOCATION_SERVICE);
    Intent i= new Intent("com.example.sleepertrain5.proximityalert");           //Custom Action
    PendingIntent pi = PendingIntent.getBroadcast(getApplicationContext(), -1, i, 0);
    lm.addProximityAlert(lat, long1, radius, -1, pi);
    Toast.makeText(getBaseContext(), 
            "Info Window clicked@" + lat + "dddjdj" + long1, 
            Toast.LENGTH_SHORT).show();

    class ProximityReceiver extends android.content.BroadcastReceiver {

     @Override
     public void onReceive(Context arg0, Intent arg1) {
      // TODO Auto-generated method stub
      // The reciever gets the Context & the Intent that fired the broadcast as arg0 & agr1 

      String k=LocationManager.KEY_PROXIMITY_ENTERING;
     // Key for determining whether user is leaving or entering 

      boolean state=arg1.getBooleanExtra(k, false);
      //Gives whether the user is entering or leaving in boolean form

      if(state){
       // Call the Notification Service or anything else that you would like to do here
       Toast.makeText(arg0, "Welcome to my Area", 600).show();
      }else{
       //Other custom Notification 
       Toast.makeText(arg0, "Thank you for visiting my Area,come back again !!", 600).show();

      }

    }

    }
            }

});
} 
```

所选标记的坐标被传递给位置管理器，但接近警报不起作用。显然，目前它只是显示了一个祝酒词，但它甚至没有这样做。根据日志，从未调用过 Proximity 接收器类，但我不知道为什么。我已经尝试了不同大小的半径，但它仍然无法正常工作。有什么想法或帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-12T12:09:24.090

您需要使用用于 PendingIntent 的 Intents 操作注册 BroadcastReceiver。您可以通过添加以下行在 AndroidManifest.xml 中执行此操作：

```
<receiver android:name="MyScheduleReceiver" >
    <intent-filter>
        <action android:name="com.example.sleepertrain5.proximityalert" />
    </intent-filter>
</receiver> 
```

# java - 需要帮助传递变量和标记 JPanel

> ID：15467830
> 
> 赞同：2
> 
> 时间：2013-03-18T00:01:44.573
> 
> 标签：java, swing, global-variables, jpanel, joptionpane

我一直在解决这个问题，我越来越困惑。我想完成几件事：

1.  添加 2 个标签到 JTextField 1。第一个要求他们输入电子邮件。第二个表示已经为他们输入了@address.com。

2.  我很困惑如何传递字符串变量，也许我应该只有一种方法？

    ```
    import javax.swing.*;
    import java.awt.*;

    public class Email {

        public static void main(String[] args) {    //main method

            //get user input
            JPanel panel = new JPanel();  //create new JPanel

            JTextField field1 = new JTextField(20);  //create a field for email and show 20 characters
            panel.add(field1);

            JTextField field2 = new JTextField(6); //create a field for grade and show to 6 characters
            panel.add(field2);

            int iValue = JOptionPane.showConfirmDialog (
            null,
            panel,
            "Please enter students email adress and test grade",
            JOptionPane.OK_OPTION); //create button in panel

            if (iValue == JOptionPane.OK_OPTION) {

                //capture email address as String
                String sEmail = field1.getText() + "@address.com"; 

                //capture numerical grade input and convert it to a float    
                float fGrade = Float.parseFloat(field2.getText());
            }
        } //end main

        public void convertGrades(float fGrade) {

            /***"shortcut if" grade conversion***********
            String sLetterGrade =    (fGrade >= 97) ? "A+" :
            (fGrade >= 94) ? "A" :
            (fGrade >= 90) ? "A-" :
            (fGrade >= 87) ? "B+" : 
            (fGrade >= 84) ? "B" :
            (fGrade >= 80) ? "B-" :
            (fGrade >= 77) ? "C+" :
            (fGrade >= 74) ? "C" :
            (fGrade >= 70) ? "C-" :
            (fGrade >= 67) ? "D+" :
            (fGrade >= 64) ? "D" :
            (fGrade >= 60) ? "D-" : "F";
            *************************************************************************/

            //experimental grade conversion
            // Determine letter grade
            String sAlphaGrade =    (fGrade >= 90) ? "A" :
            (fGrade >= 80) ? "B" :
            (fGrade >= 70) ? "C" :
            (fGrade >= 60) ? "D" : "F";
            //determine + or -
            if (fGrade >= 60) {
                float fGradeModifier = (fGrade % 10); 
                String sAlphaModifier = (fGradeModifier >= 7) ? "+" :
                (fGradeModifier >= 4)? "" : "-";

                //concatenate letter grade and modifier
                String sLetterGrade = sAlphaGrade + sAlphaModifier;

            } // end if

            String sResults =    getInput.sEmail  + "\n" +
            sMessage + "\n" +
            "your test score is: " + fGrade + "\n" + 
            "your letter grade is: " + sLetterGrade;

            JOptionPane.showMessageDialog(null, sOutput,"Email and Grade",
            JOptionPane.INFORMATION_MESSAGE);

        } //end convertGrades
    } //end class Email 
    ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T02:16:16.993

您的代码在声明和访问变量的位置存在一些问题。`sMessage`并且`sOutput`从未在任何地方声明或赋予值。此外，您尝试`sEmail`在`convertGrades`方法中声明它时访问它`main`，并尝试在声明它的块`sLetterGrade`之外访问。`if`

如果要`sEmail`在`convertGrades`方法中使用，则需要在调用时将其传递给方法。`sLetterGrade`必须在`if`块之外声明以供以后使用。此外，您从未真正`convertGrades`从您的`main`方法中调用，因此这些代码都不会执行。

要标记您的`JTextField`，我建议将所有标签和字段放在[`Box`](http://docs.oracle.com/javase/7/docs/api/javax/swing/Box.html). 这将确保它们都以正确的顺序保持在一起。

这是您编辑的代码以包含所有这些更改：

```
 import javax.swing.*;
    import java.awt.*;

    public class Email {

        public static void main(String[] args) {    //main method

            //get user input
            JPanel panel = new JPanel();  //create new JPanel

            Box field1Box = Box.createHorizontalBox(); // Box to hold field1 and its labels
            field1Box.add(new JLabel("Enter email: ")); // JLabels can be added directly; we don't need to keep a reference
            JTextField field1 = new JTextField(20);  //create a field for email and show 20 characters
            field1Box.add(field1);
            field1Box.add(new JLabel("@address.com"));
            panel.add(field1Box); // Adds the Box containing field1 and the two labels to panel

            JTextField field2 = new JTextField(6); //create a field for grade and show to 6 characters
            panel.add(field2);

            int iValue = JOptionPane.showConfirmDialog (
            null,
            panel,
            "Please enter student's email adress and test grade",
            JOptionPane.OK_OPTION); //create button in panel

            if (iValue == JOptionPane.OK_OPTION) {

                //capture email address as String
                String sEmail = field1.getText() + "@address.com"; 

                //capture numerical grade input and convert it to a float    
                float fGrade = Float.parseFloat(field2.getText());

                //call convertGrades to display the results
                convertGrades(fGrade, sEmail);
            }
        } //end main

        // convertGrades must be static to be called from main
        public static void convertGrades(float fGrade, String sEmail) {

            /***"shortcut if" grade conversion***********
            String sLetterGrade =    (fGrade >= 97) ? "A+" :
            (fGrade >= 94) ? "A" :
            (fGrade >= 90) ? "A-" :
            (fGrade >= 87) ? "B+" : 
            (fGrade >= 84) ? "B" :
            (fGrade >= 80) ? "B-" :
            (fGrade >= 77) ? "C+" :
            (fGrade >= 74) ? "C" :
            (fGrade >= 70) ? "C-" :
            (fGrade >= 67) ? "D+" :
            (fGrade >= 64) ? "D" :
            (fGrade >= 60) ? "D-" : "F";
            *************************************************************************/

            //experimental grade conversion
            // Determine letter grade
            String sAlphaGrade =    (fGrade >= 90) ? "A" :
            (fGrade >= 80) ? "B" :
            (fGrade >= 70) ? "C" :
            (fGrade >= 60) ? "D" : "F";
            String sLetterGrade; // This needs to be visible outside of the if
            //determine + or -
            if (fGrade >= 60) {
                float fGradeModifier = (fGrade % 10); 
                String sAlphaModifier = (fGradeModifier >= 7) ? "+" :
                (fGradeModifier >= 4)? "" : "-";

                //concatenate letter grade and modifier
                sLetterGrade = sAlphaGrade + sAlphaModifier;

            } // end if
            else {
                // sLetterGrade still needs to get a value
                sLetterGrade = sAlphaGrade;
            }

            String sResults =    sEmail  + "\n" +
            // sMessage has been commented out so the program will compile and run
            // Uncomment it if you declare it and give it a value somewhere.
            // sMessage + "\n" +
            "your test score is: " + fGrade + "\n" + 
            "your letter grade is: " + sLetterGrade;

            // Assuming sOutput was meant to mean sResults
            JOptionPane.showMessageDialog(null, sResults,"Email and Grade",
            JOptionPane.INFORMATION_MESSAGE);

        } //end convertGrades
    } //end class Email 
```

# django - django logout 将我重定向到管理页面

> ID：15467831
> 
> 赞同：41
> 
> 时间：2013-03-18T00:01:46.993
> 
> 标签：django, logout

我提供了一个简单的登录功能。对于注销，我尝试使用内置的。这是我的 urls.py：

```
(r'', include('django.contrib.auth.urls')), 
```

这是我的模板文件：

```
{% if user.is_authenticated %}
logged in as {{ user }}
(<a href="{% url "logout" %}">logout</a>)
{% else %} 
```

我还启用了默认的 django 管理站点。当我单击`logout`时，它会显示管理注销视图。如何通过 logout next page 属性告诉 django 要呈现哪个视图？

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2015-12-11T00:09:30.063

如果您看到的是 Django 管理站点的注销页面而不是您自己的注销页面 (your_application/templates/registration/logged_out.html)，请检查项目的 INSTALLED_APPS 设置并确保 django.contrib.admin 出现在后面'你的申请'。两个模板都位于相同的相对路径中，Django 模板加载器将使用它找到的第一个。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-02-20T13:19:16.490

**在 Django 1.6 上测试：**

我所做的是将它添加到我的`urls.py`：

```
(r'^management/logout/$', 'django.contrib.auth.views.logout'), 
```

然后使用它：

```
<a href="{% url "django.contrib.auth.views.logout" %}?next=/">Log out</a> 
```

对于`next`参数，您指向正确的 URL。

**在 Django 2.1 上测试**

附加`urlpatterns`到`urls.py`：

```
from django.contrib.auth import views as auth_views

urlpatterns = [
    path('logout/', auth_views.LogoutView.as_view(), name='logout'),
] 
```

然后在模板中使用它：

```
<a href="{% url "logout" %}?next=/">logout</a> 
```

更多信息可以在[这里](https://docs.djangoproject.com/en/2.1/topics/auth/default/#using-the-views)找到。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-03-18T02:55:24.737

根据文档，您可以将 next_page 参数提供给注销视图。 [https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.views.logout](https://docs.djangoproject.com/en/dev/topics/auth/#django.contrib.auth.views.logout)

```
(r'^logout/$', 'django.contrib.auth.views.logout',
    {'next_page': '/logged_out/'}) 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2017-09-11T15:53:26.390

最简单的解决方案是：

1.  确保您的应用位于已安装的应用*之前* 。`django.contrib.admin``settings.py`

2.  确保您的模板被称为`logged_out.html`.

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-18T00:04:54.413

这在手册中都有很好的解释，你有什么不明白的地方吗？

[https://docs.djangoproject.com/en/dev/topics/auth/default/#how-to-log-a-user-out](https://docs.djangoproject.com/en/dev/topics/auth/default/#how-to-log-a-user-out)

```
from django.contrib.auth import logout

def logout_view(request):
    logout(request)
    # Redirect to a success page. 
```

或者，如果您不想创建自己的视图

[https://docs.djangoproject.com/en/dev/topics/auth/default/#django.contrib.auth.views.logout](https://docs.djangoproject.com/en/dev/topics/auth/default/#django.contrib.auth.views.logout)

```
{% url 'logout' next='/some/url/' %} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-05-21T16:25:11.117

我在 Django 之后遇到了同样的问题……发现这个 url 对我有用

```
url(r'^logout/$', 'django.contrib.auth.views.logout', { 'template_name': 'account/logout.html',}, name='logout' ), 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-03-12T09:29:38.447

您可以`LOGOUT_REDIRECT_URL`在`settings.py`文件中放入要重定向到的 url 名称，例如`LOGOUT_REDIRECT_URL = 'index'`

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2019-12-13T23:48:21.087

转到 settings.py 并添加此代码。“/”会将您重定向到主页

```
# Where to redirect during authentication
LOGIN_REDIRECT_URL = "/" #To go to home after login instead of getting redirected to accounts/profile on login which is default
LOGOUT_REDIRECT_URL = "/" #To logout back to the home page instead of the default admin logout page 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-04-23T08:30:59.050

我很惊讶没有人提到这一点，你可以把它放在你的 settings.py 中，以便在登录和注销时重定向：

```
LOGIN_REDIRECT_URL = '/go-here-after-login/'
LOGOUT_REDIRECT_URL = '/go-here-after-logout/' 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-07-04T14:12:37.660

最常见的解决方案总结：

确保 your_app 在 settings.py 文件的 INSTALLED_APPS 列表中位于 django.contrib.admin 之前。

还要确保您的注销页面称为“logged_out.html”，如上面的答案中所指出的那样。我的被​​称为 logout.html 并没有工作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-03-12T15:44:30.860

您也可以在 href 标记中提供要呈现的模板

```
{% if user.is_authenticated %}

  logged in as {{ user }}
  (<a href="{% url "logout" %}?next=myapp/templates/logoutmessage.html">logout</a>)

{% else %}
  ...
{% endif %} 
```

如果您使用 settings.py 中的默认值。适用于 Django 3.1。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-09-14T04:37:45.683

只需在此处替换 loader，auth 模板将在“your_progect_apps/templates/registration”中找到：

```
TEMPLATES = [
{
    'BACKEND': 'django.template.backends.django.DjangoTemplates',
    'DIRS': [os.path.join(BASE_DIR, 'templates')],
    'OPTIONS': {
        'context_processors': [
            'django.template.context_processors.debug',
            'django.template.context_processors.request',
            'django.contrib.auth.context_processors.auth',
            'django.contrib.messages.context_processors.messages',
        ],
        'loaders': [
            'django.template.loaders.filesystem.Loader',
            'django.template.loaders.app_directories.Loader',
        ],
    },
}, 
```

]

Django v2.1

# c++ - 有没有一种正统的方法来避免编译器警告 C4309 - 二进制文件输出的“常量值截断”？

> ID：15467837
> 
> 赞同：16
> 
> 时间：2013-03-18T00:02:27.567
> 
> 标签：c++, file-io, compiler-warnings, binary-data, truncation

我的程序执行将二进制数据写入文件的常见任务，符合某种非文本文件格式。由于我正在写入的数据尚未存在于现有块中，而是在运行时逐字节放在一起，因此我使用`std::ostream::put()`而不是`write()`. 我认为这是正常程序。

该程序运行良好。它同时使用`std::stringstream::put()`和`std::ofstream::put()`使用两位十六进制整数作为参数。但是每当参数`put()`大于 0x7f 时，我都会收到编译器警告 C4309：“常量值截断”（在 VC++ 2010 中）。显然编译器期望 a `signed char`，并且常量超出范围。但我认为实际上并没有发生任何截断。字节就像它应该的那样被写入。

编译器警告让我觉得我没有以正常的、可接受的方式做事。我描述的情况必须是常见的。*有没有避免这种编译器警告的常用方法*？或者这是一个应该忽略的毫无意义的编译器警告的例子？

我想了两种不优雅的方法来避免它。我可以`mystream.put( char(0xa4) )`在每次通话时使用语法。或者`std::stringstream`我可以使用而不是使用`std::basic_stringstream< unsigned char >`，但我认为该技巧不适用于`std::ofstream`，它不是模板类型。我觉得这里应该有更好的解决方案，特别是因为`ofstream`它是用来编写二进制文件的。

你的意见？

**- 编辑 -**

啊，我误认为`std::ofstream`不是模板类型。实际上是这样`std::basic_ofstream<char>`，但我尝试了那个方法，并意识到由于缺少定义的方法和与`std::ostream`.

这是一个代码示例：

```
stringstream ss;
int a, b;
/* Do stuff */
ss.put( 0 );
ss.put( 0x90 | a ); // oddly, no warning here...
ss.put( b );        // ...or here
ss.put( 0xa4 );     // C4309 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-18T20:49:25.520

我找到了令我满意的解决方案。它比显式地将每个常量转换为`unsigned char`. 这就是我所拥有的：

```
ss.put( 0xa4 ); // C4309 
```

我认为“截断”发生在隐式转换`unsigned char`为`char`，但丛旭指出，整数常量被假定为有符号，任何大于 0x7f 的都被提升为`char`to `int`。如果传递给`put()`. 通过使用后缀“u”，我可以指定一个无符号整数常量，如果它不大于 0xff，它将是一个`unsigned char`. 这就是我现在所拥有的，没有编译器警告：

```
ss.put( 0xa4u ); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-18T00:30:13.507

```
std::stringstream ss;
ss.put(0x7f);
ss.put(0x80); //C4309 
```

正如您猜到的那样，问题在于`ostream.put()`期望 a `char`，但`0x7F`它是 的最大值`char`，并且任何更大的值都会被提升为`int`。您应该转换为`unsigned char`，它的宽度应尽可能安全地`char`存储任何内容`char`，但也要使截断警告合法：

```
ss.put(static_cast<unsigned char>(0x80)); // OK
ss.put(static_cast<unsigned char>(0xFFFF)); //C4309 
```

# class - 无法在 ReSharper 中将方法设为静态，因为菜单显示为灰色

> ID：15467838
> 
> 赞同：0
> 
> 时间：2013-03-18T00:02:35.883
> 
> 标签：class, function, resharper

我正在尝试按照一些步骤使用*ReSharper 7.1.1*将方法从一个类移动到另一个类。执行此操作的步骤之一涉及使方法静态，但是，上下文菜单条目`Make Method Static...`似乎被禁用并变灰。奇怪的是它以前在同一个功能上没有变灰，但是在我放弃我的更改再次执行它之后，它现在似乎变灰了。

我尝试突出显示函数名称和整个函数本身以尝试使菜单条目处于活动状态，但仍然没有运气。如何`Make Method Static...`再次启用菜单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T09:32:33.660

请检查您的方法是否不是虚拟的，并且不用于实现接口。否则，请提供代码示例。

# google-sheets - 如何获取未来两周的数据？

> ID：15467846
> 
> 赞同：0
> 
> 时间：2013-03-18T00:03:56.223
> 
> 标签：google-sheets, google-drive-api

我有几个直截了当的计划者，像这样：

```
| date       | person | person 2 | description |  
 2013-03-01      peter      pam    painting  
 2013-03-18      john       carl   cleaning  
 2013-03-20      max        anne   washing 
```

在另一张纸上，我只想过滤接下来 2 周的“事件”。我怎样才能做到这一点？我尝试了几种方法，但都没有奏效。

有了`=ARRAYFORMULA(DAYS360(B2:B;NOW()))`我可以在不同的列中得到一个天数。0 = 今天，1 = 昨天，-1 明天等等。事实上，我需要过滤 -1 到 -14 天。有时只有 2 场活动，有时 2 周内只有 5 场。

**编辑：**我发现的一些东西

*   首先，我过滤了正确的天数 `=filter(A2:A50;A2:A50>-14;A2:A50<0)`

*   然后，我做了一个`=vlookup(G32,A1:E49;5;false)`
    vlookup（其中 G32 是过滤器命令，A2:A50 是天数，A1:E49 是所有数据）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T16:45:00.657

这是[QUERY](http://support.google.com/drive/bin/answer.py?hl=en&answer=1388882)命令和[查询语言](https://developers.google.com/chart/interactive/docs/querylanguage)的好机会。

我假设您的数据在“表 1”中的 4 列 A:D 中。

```
=query('sheet 1'!A:D,"select * where datediff( A, now()) < 14 and datediff( A, now()) > 0") 
```

# java - 如何查找子数组在 Java 的二维数组中是否有特定的总和？

> ID：15467855
> 
> 赞同：5
> 
> 时间：2013-03-18T00:05:07.493
> 
> 标签：java, algorithm, multidimensional-array, dynamic-programming

我试图通过比较源图像和图案图像中像素的平均颜色来解决图像匹配问题。我已将此问题简化为子数组求和问题，但无法找到解决方法。

假设我有一个所有正整数的二维数组 ARR。我有一个数字 x（这是小图案图像中像素颜色的平均值）。我只需要在 ARR 中找到任何具有确切总和 x 的子数组。我发现了一个类似的问题，可以在这里用动态编程解决。

[http://www.geeksforgeeks.org/dynamic-programming-set-27-max-sum-rectangle-in-a-2d-matrix/](http://www.geeksforgeeks.org/dynamic-programming-set-27-max-sum-rectangle-in-a-2d-matrix/)

但这谈论的是找到一个具有**最大总和**的子数组，而不是已经给出的总和。

```
所以如果这是给定的数组。

3 4 8 9 3
2 10 4 2 1
8 1 4 8 0
3 5 2 12 3
8 1 1 2 2

如果给定的总和是 19，那么它应该返回这个窗口

3 4 8 9 3
2    10 4    2 1
8    1 4    8 0
3 5 2 12 3
8 1 1 2 2

如果给定的总和是 23，那么它应该返回这个窗口

3 4 8    9 3 
2 10 4    2 1 
8 1 4    8 0
3 5 2 12 3
8 1 1 2 2

```

我怎样才能有效地找到这个？可以在这里使用动态编程吗？请帮帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T02:41:16.337

使用相同的原理，但针对更简单的问题。**首先，我预先计算了数组每一列**的累积和，即 A[i][j] += A[i-1][j]。

然后，对于每对开始/结束行 (i1, i2)，我将它们视为单个数组 B[j]，这意味着 B[j] = A[i2][j] - A[i1-1][ j]。然后，我们需要找到具有精确总和的子数组。由于数组仅由正数组成，我可以在 O(n) 中找到它。

总的来说，这个算法是 O(n^3)。

对于您提供的值，我能够找到一些附加数组：

对于目标 = 19：

```
Found between (0,0) and (1,1)
Found between (0,3) and (2,4)
Found between (0,2) and (4,2)
Found between (1,1) and (2,2)
Found between (1,2) and (2,4)
Found between (2,0) and (4,0)
Found between (3,3) and (4,5) 
```

目标 = 23：

```
Found between (0,2) and (1,3)
Found between (0,3) and (2,4)
Found between (2,0) and (3,2)
Found between (2,3) and (3,4)
Found between (3,1) and (4,4) 
```

我使用的代码：

```
public static void main(String[] args) {
    int[][] A = {
            {3, 4, 8, 9, 3},
            {2, 10, 4, 2, 1},
            {8, 1, 4, 8, 0},
            {3, 5, 2, 12, 3},
            {8, 1, 1, 2, 2},
    };

    int target = 19;

    for (int i = 1; i < A.length; i++)
        for (int j = 0; j < A[i].length; j++)
            A[i][j] += A[i - 1][j];

    for (int i1 = 0; i1 < A.length; i1++) {
        for (int i2 = i1 + 1; i2 < A.length; i2++) {
            int j1=0, j2=0, s=0;

            while(j2<A[i1].length) {
                while(s<target && j2<A[i1].length) {
                    s += A[i2][j2] - (i1 > 0 ? A[i1-1][j2] : 0);
                    j2++;
                    if (s==target)
                        System.out.println(String.format("Found between (%d,%d) and (%d,%d)", i1, j1, i2, j2-1));
                }
                while(s>=target) {
                    s -= A[i2][j1] - (i1 > 0 ? A[i1-1][j1] : 0);
                    j1++;
                    if (s==target)
                        System.out.println(String.format("Found between (%d,%d) and (%d,%d)", i1, j1, i2, j2));
                }
            }
        }
    }
} 
```

# mysql - MySQL 触发新旧查询

> ID：15467858
> 
> 赞同：0
> 
> 时间：2013-03-18T00:05:20.917
> 
> 标签：mysql, sql, triggers

我正在尝试创建触发器，因此当“`update`订单”表中的“名字”行时，新值将保存在表 triggers.FirstName 中。

我以这种方式构建了 MySQL 查询，但是我得到“您的 SQL 语法有错误；” 我想我做错了什么：

```
DELIMITER $$
CREATE TRIGGER when_updated
BEFORE UPDATE 
ON order
FOR EACH ROW 
BEGIN
INSERT INTO triggers (timestamp, FirstName) VALUES (now(), NEW.FirstName)
END$$
DELIMITER; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T00:06:38.340

你没有终止`INSERT`声明，

```
DELIMITER $$ 
CREATE TRIGGER when_updated 
BEFORE UPDATE ON `order` FOR EACH ROW 
BEGIN 
    INSERT INTO triggers (timestamp, FirstName) 
    VALUES (now(), NEW.FirstName);
                              -- ^ HERE
END$$ 
DELIMITER; 
```

另外，`ORDER`是一个保留的关键字。用反引号分隔它，以便它可以用作表名。

# windows - WiX Burn Bootstrapper - 无法检测到注册表项

> ID：15467859
> 
> 赞同：3
> 
> 时间：2013-03-18T00:05:24.510
> 
> 标签：windows, wix, registry, 64-bit, wix3.6

我正在安装一个需要 Visual C++ 可再发行组件 (x64) 的产品。首先，我的引导程序尝试检测是否已经安装了 vcredist (x64) ...

```
<util:RegistrySearch Root="HKLM" Key="HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\11.0\VC\Runtimes\x64" Value="Installed" Variable="vcredist"/> 
```

关键是“虚拟化”（我认为），在 regedit 中它出现在...

```
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\VisualStudio\11.0\VC\Runtimes\x64 
```

请注意，我没有将“Wow6432Node”位放在我的搜索中，因为我认为这应该被操作系统隐藏？这个搜索总是失败....

```
[131C:0BC0][2013-03-18T12:42:17]: Registry key not found. Key = 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\11.0\VC\Runtimes\x64' 
```

我尝试添加`Win64="yes"`到我的注册表搜索，但没有成功。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T04:56:13.827

我认为您希望您的搜索看起来像这样：

```
<util:RegistrySearch Root="HKLM" Key="SOFTWARE\Microsoft\VisualStudio\11.0\VC\Runtimes\x64"
                     Value="Installed" Variable="vcredist"/> 
```

您当前的代码正在搜索名为`HKEY_LOCAL_MACHINE`HKLM 的密钥。我怀疑存在。;)

# xslt - Xslt 对所有数据进行排序

> ID：15467862
> 
> 赞同：2
> 
> 时间：2013-03-18T00:05:46.087
> 
> 标签：xslt

嘿，我刚开始学习 xslt 我遇到了问题。我有 xml 文件，如：

```
<projects>
<project nr="1">
<description>z</description>
<description>a</description>
</project>
</projects> 
```

像这样的项目很少有描述，我想做的是创建一个 html 表，其中包含所有项目的所有排序描述。总的来说，如果我有 5 个项目和 2 个描述，那么将有 10 个排序的行。到目前为止，我已经设法对所有项目的第一个描述进行排序，不知道如何包含第二个以及是否会有第三个第四个等。有什么线索吗？感谢帮助。

@edit 到目前为止，我已经开始使用平面文件，但这没关系。到目前为止我有

```
<xsl:output method="text"/>
<xsl:template match="projects">
<xsl:apply-templates>
<xsl:sort select="description" />
</xsl:apply-templates>
</xsl:template>
<xsl:template match="project">
 Description: <xsl:apply-templates select="description"/>
<xsl:text>
 </xsl:text>
 </xsl:template> 
```

我一直在搞乱 for:each 循环但是老实说我不确定应该怎么做

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T01:09:58.620

**这种转变：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="/*">
  <xsl:copy>
   <xsl:apply-templates select="*/description">
    <xsl:sort/>
   </xsl:apply-templates>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于以下 XML 文档时**（基于提供的和扩展的）：

```
<projects>
    <project nr="1">
        <description>z</description>
        <description>a</description>
    </project>
    <project nr="2">
        <description>b</description>
        <description>y</description>
    </project>
    <project nr="3">
        <description>c</description>
        <description>x</description>
    </project>
    <project nr="4">
        <description>d</description>
        <description>w</description>
    </project>
    <project nr="5">
        <description>e</description>
        <description>u</description>
    </project>
</projects> 
```

**产生想要的结果**：

```
<projects>
   <description>a</description>
   <description>b</description>
   <description>c</description>
   <description>d</description>
   <description>e</description>
   <description>u</description>
   <description>w</description>
   <description>x</description>
   <description>y</description>
   <description>z</description>
</projects> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T01:10:42.783

你是对的，你想使用一个 for-each 循环，像这样：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="/">
    <xsl:for-each select="//project/description">
      <xsl:sort select="." />
      <xsl:copy-of select="."/>
    </xsl:for-each>
  </xsl:template>
</xsl:stylesheet> 
```

这将返回所有`<description>`项目中的所有节点，按升序排序。如果您想返回它们的非 xml 表示，您可以用或任何您喜欢的方式替换`<xsl:copy-of select="."/>`节点。`Description: <xsl:value-of select="."/>`

# ruby-on-rails - routes.rb 和控制器

> ID：15467870
> 
> 赞同：2
> 
> 时间：2013-03-18T00:06:56.557
> 
> 标签：ruby-on-rails, controller

抱歉，我以为我理解了这一点，但现在我必须重新评估我对 routes.rb 的理解。希望你能帮忙。

浏览器请求发送到应用程序控制器，控制器告诉显示什么，对吧？- 什么 erb 文件，数据库的东西，随便什么……

在我的 routes.rb 文件中，我有：

```
 root :to => 'static_pages#FAQ' 
```

直到最近我还以为发生了什么：routes.rb 正在查看我的 static_pages_controller.rb 文件，查看 FAQ 方法，然后查看要做什么。如果FAQ 方法中没有任何内容——就像这种情况一样——那么Rails 就会发挥它的魔力并在我的视图中访问我的FAQ.html.erb，这是最接近的东西。

但即使我更改名称：

```
def FAQ
end 
```

在我的控制器中，或者完全删除 static_pages_controller.rb，它仍然会转到我的 FAQ.html.erb 文件。那么 routes.rb 甚至不看控制器吗？它会直接进入“查看”文件吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:59:44.690

以大写字母开头的方法名称在 ruby​​ 中似乎是一个非常糟糕的主意，因为 ruby​​ 会将任何以大写字母开头的标识符视为常量。我个人要做的第一件事就是在我的路由和控制器代码中将“FAQ”更改为“faq”。如果您真的想在浏览器 url 中大写“FAQ”，您可以通过以下方式实现：

```
root :to => static_pages#faq, :as => 'FAQ' 
```

要检查您的方法是否被调用，请使用记录器：

```
def faq
   Rails.logger.warn "faq method did get called after all"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:22:37.363

首先提供静态页面，这就是始终提供 FAQ.html.erb 的原因。

另外“浏览器请求发送到应用程序控制器，控制器告诉显示什么，对吗？-什么 erb 文件，数据库内容，等等……”

我是这样想的：请求首先通过路由，然后到有问题资源的控制器，控制器从 application_controller 继承，然后根据需要查询模型，根据需要计算变量，然后在编译时使用查看页面是编译，以 HTML 格式发送。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T00:23:11.787

你的想法基本上是正确的；Rails 将尝试渲染 static_page 控制器的 FAQ 方法，如果该操作没有显式渲染视图（或其他输出），该方法会隐式渲染“FAQ”视图。

您缺少的是，如果缺少任何一个控制器/动作部件，Rails 将填补空白。您需要做的就是定义视图，Rails 会假设您根本不想定义一个空动作。

# c++ - 无法链接 GLFW C++；添加了 .dll、.h、.lib，但仍然获得 LNK2019

> ID：15467872
> 
> 赞同：2
> 
> 时间：2013-03-18T00:07:10.687
> 
> 标签：c++, opengl, properties, glfw, lnk2019

我已将 .dll 添加到 Windows/System32，将 .lib 添加到 VS/lib，将 .h 添加到 VS/include。

剩下的就是通过项目链接它。这就是我所拥有的：

* * *

```
#include <glfw.h>

int main(void)
{
    /* Initialize the library */
    if (!glfwInit())
        return -1;

    /* Create a windowed mode window and its OpenGL context */
    if (!glfwOpenWindow(640, 480, 8, 8, 8, 0, 24, 0, GLFW_WINDOW))
        return -1;

    /* Loop until the user closes the window */
    while (glfwGetWindowParam(GLFW_OPENED))
    {
        /* Render here */

        /* Swap front and back buffers and process events */
        glfwSwapBuffers();
    }

    return 0;
} 
```

* * *

```
1>Main.obj : error LNK2019: unresolved external symbol _glfwSwapBuffers referenced in function _main
1>Main.obj : error LNK2019: unresolved external symbol _glfwGetWindowParam referenced in function _main
1>Main.obj : error LNK2019: unresolved external symbol _glfwOpenWindow referenced in function _main
1>Main.obj : error LNK2019: unresolved external symbol _glfwInit referenced in function _main
1>C:\Users\Danny\documents\visual studio 2010\Projects\OGL2\Debug\OGL2.exe : fatal error LNK1120: 4 unresolved externals 
```

* * *

我去了项目>属性>配置属性>链接器>在附加依赖项中添加了以下内容：

* * *

```
opengl32.lib;GLFW.lib;glu32.lib;kernel32.lib;user32.lib;gdi32.lib;winspool.lib;comdlg32.lib;advapi32.lib;shell32.lib;ole32.lib;oleaut32.lib;uuid.lib;odbc32.lib;odbccp32.lib;%(AdditionalDependencies) 
```

* * *

为了更好地衡量，我还将忽略所有默认库设置为“否”。

我知道我应该链接：`opengl32.lib, GLFW.lib, glu32.lib, kernel32.lib and user32.lib`

不幸的是，LNK 2019 问题仍然存在。真的不确定为什么。非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-18T00:19:50.550

~~外部名称表明您的项目正在为 64 位目标构建（32 位 DLL 导出通常具有`@nn`stdcall 调用约定使用的后缀）。我敢打赌，您的库是为 32 位目标构建的。~~

~~将项目设置更改为 Win32 而不是 x64。~~

我猜错了 - 未解析的外部符号（例如）`_glfwSwapBuffers`表明您正在为 32 位目标构建。为 64 位目标构建时，外部名称不会用下划线修饰。

但基本解决方案是相同的 - 确保正在构建的目标与您拥有的库的目标相同。因此，如果您下载了 64 位 GLFW 库，请确保您的 VS 项目是为 Win64 目标构建的。

在将 64 位 GLFW 二进制发行版提取到以下位置后，我能够编译并链接您的测试程序`c:\temp`：

```
C:\temp>cl /I c:\temp\glfw-2.7.7.bin.WIN64\include\GL test.cpp c:\temp\glfw-2.7.7.bin.WIN64\lib-msvc110\GLFWDLL.lib
Microsoft (R) C/C++ Optimizing Compiler Version 17.00.50727.1 for x64
Copyright (C) Microsoft Corporation.  All rights reserved.

test.cpp
Microsoft (R) Incremental Linker Version 11.00.50727.1
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:test.exe
test.obj
c:\temp\glfw-2.7.7.bin.WIN64\lib-msvc110\GLFWDLL.lib

C:\temp> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-13T11:46:12.193

我得到了完全相同的错误信息。我注意到我的glfw文件夹中没有.lib文件，因为我下载了源包，你需要下载预编译的二进制版本，然后我就可以使用了；[![在此处输入图像描述](../Images/f64cc563476362ae402c257955bb312c.png)](https://i.stack.imgur.com/W2mvl.jpg)

# javascript - 引导弹出窗口在 iPad 上不起作用

> ID：15467873
> 
> 赞同：2
> 
> 时间：2013-03-18T00:07:18.470
> 
> 标签：javascript, jquery, twitter-bootstrap

我有一个引导弹出窗口工作，所以：

1.  弹出框点击打开
2.  在弹出框外部单击时弹出框关闭
3.  如果 JS 被禁用，Popover 有默认的 href

代码是：

```
<a class="badge badge-popover"
    data-original-title="title here"
    data-trigger="focus"
    data-placement="right"
    data-content="<p>Content Here</p>" data-html="true"
    href="/help">?</a>

$('.badge-popover').click(function(e){
    e.preventDefault();
}).popover(); 
```

它在所有浏览器上都可以正常工作，但在 iPad 上却不行。任何想法为什么？我哪里错了？谢谢 ：）

我正在使用 Jquery 1.9.1，引导程序 2.1.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T12:10:51.593

尝试使用该`hover`事件：

这应该通过（触摸）触发桌面上的弹出框`hover`和移动/平板电脑上的弹出框。`click`

```
<a class="badge badge-popover"
   data-original-title="title here"
   data-placement="right"
   data-trigger="hover"
   data-content="<p>Content Here</p>" data-html="true"
   href="/help">?</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-10T23:01:17.350

刚遇到同样的问题。换`data-trigger="focus"`工作`data-trigger="click"`。悬停也有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-13T04:49:06.380

请参阅以下代码片段以使其正常工作：

```
$('[data-toggle="popover"]').popover();

$('body').on('click', function (e) {
$('[data-toggle="popover"]').each(function () {
    //the 'is' for buttons that trigger popups
    //the 'has' for icons within a button that triggers a popup
    if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {
        $(this).popover('hide');
    }
 });
}); 
```

这是检测主体点击并关闭页面上所有工具提示的最简单方法。

[您可以在此处](http://jsfiddle.net/mattdlockyer/C5GBU/2/)查看实时示例

谢谢！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-11T10:07:37.827

将 data-trigger="focus" 更改为 data-trigger="click" 几乎可以正常工作，但问题是即使您在其外部单击弹出框仍保持打开状态，并且只有单击元素才能将其关闭，即启动了弹出窗口...

# jquery - 在 Asp.Net 中使用 jQuery ajax 调用

> ID：15467881
> 
> 赞同：1
> 
> 时间：2013-03-18T00:07:56.833
> 
> 标签：jquery, asp.net, ajax, asp.net-mvc-3

我对 ASP 有点陌生。我想进行 ajax 调用，但我无法确定要发送到的 URL。应用程序的实际 URL 到底是什么？当然，它在浏览器中显示为 http:// localhost : someport/ （因为链接违反了 SO 问题而添加了空格）。当我尝试输入 ["index","default"].["asp","aspx","htm","html","asm","asmx"] 之后我得到一个错误。

相关的 JavaScript 部分如下所示：

```
$.ajax({
   "url": "Default.aspx/ProcessReq", 
```

我控制器中的相关 C# 代码如下所示：

```
[WebMethod]
public object ProcessReq(string s) { 
```

我在配置文件中添加了以下内容：

```
<configuration>
   <system.web>
      <webServices>
        <protocols>
           <add name="HttpGet"/>
           <add name="HttpPost"/>
         </protocols>
      </webServices>
   </system.web>
</configuration> 
```

我确定我做错了什么，我再次强调 ASP 对我来说相当新。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T01:22:37.780

似乎您来到 MVC 时仍然对 Web 表单记忆犹新。这很常见。

不幸的是，MVC 与 WebForms 非常不同。您不会直接调用视图（aspx 或 razor）。你称你为 Action Method: /home/index ... 并且 default.aspx 可以省略。尝试一下。

ActionResult 是控制器动作返回的响应类型的基类

```
public ActionResult ProcessReq()
{
    return View(model)
} 
```

或者您的 ProcessReq 可以是 Json 类型

```
public ActionResult ProcessReq()
{
    Json(new { page= "<HTML></HTML>", control= "<input type='text' id='control'>" });
} 
```

Action Results 可以返回 Views'、PartialView's 和 JSON（以及许多其他可能性）。在这种情况下，您必须根据设计的实现要求来决定您想要哪种响应类型。

# ruby - 使用地理编码器计算铁轨外的距离

> ID：15467882
> 
> 赞同：1
> 
> 时间：2013-03-18T00:07:59.323
> 
> 标签：ruby, rubygems, rails-geocoder

地理编码器 gem 可以轻松计算轨道内 2 个坐标之间的距离：

```
obj.distance_from([40.714,-100.234]) 
```

如何在 Rails 之外的 ruby​​ 脚本中实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:37:54.340

如果你愿意假设地球是一个球体，那么有一个简单的公式可以计算两个点之间的距离，因为它们的纬度、经度和地球的半径：

[http://en.wikipedia.org/wiki/Great-circle_distance#Formulas](http://en.wikipedia.org/wiki/Great-circle_distance#Formulas)

我在这里实现了它（见`Point#distance`），没有考虑地球的半径（或者，你可以说我的测量单位是一个地球半径）：

[https://gist.github.com/amitkgupta/5019163](https://gist.github.com/amitkgupta/5019163)

如果您想要以米、英里等为单位的结果，您需要乘以适当的半径值。

# android - 如何在android中长时间存储数据？

> ID：15467894
> 
> 赞同：0
> 
> 时间：2013-03-18T00:09:37.633
> 
> 标签：android, database, sqlite, oncreate, create-table

我正在尝试开发 android 应用程序（第一次），所以我使用 SQLite 来存储数据。但是每次我运行应用程序时，所有数据都是空的！我认为问题在于当我运行应用程序时，它会重新创建所有表，并且它们以新的空表的形式出现！

任何人都可以帮助或举例说明如何检查表是否已经创建，如果是则复制数据，如果没有创建，这意味着这是第一次！如何使用 SQLite 长时间存储数据？如果我不能存储数据的最佳方式是什么？

```
 //food
        private static final String food= "food";
        //---- columns ----- 
        private static final String fid = "fid";
        private static final String fname= "fname";
        private static final String category = "category";
        private static final String quantity= "quantity";
        private static final String unit= "unit";
        private static final String carbs= "carbs";

        //food
            private static final String DATABASE_CREATE_Food="CREATE TABLE "
        +food+" ("+fid
        + " INTEGER PRIMARY KEY AUTOINCREMENT , "
        +fname+ " TEXT NOT NULL, "
        +category+" TEXT Not NULL, "
        +quantity+" Double Not Null, "
        +carbs+" Integer NOT NULL, "
        +unit+" TEXT NOT NULL" 
        +");";

public void onCreate(SQLiteDatabase database) {
        database.execSQL(DATABASE_CREATE_Food);

    }
    /** Called when the DATABASE_VERSION is changed to higher version */
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(MyAppDB.class.getName(),
                "Upgrading database from version " + oldVersion + " to "
                        + newVersion + ", which will destroy all old data");

        db.execSQL("DROP TABLE IF EXISTS" + food);

        onCreate(db);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:15:46.380

在 android 中存储数据的方法有很多，SQLite 就是其中之一。
您的代码可能有问题，因为每次启动应用程序时它都不应该为空。在此处发布您的代码，以便有人可以找出问题所在。

有关在 android 中存储数据的其他方式，请查看 developer.android 网站
[http://developer.android.com/guide/topics/data/data-storage.html中的此链接](http://developer.android.com/guide/topics/data/data-storage.html)

# string - TCL-如何将字符串解释为 tcl 程序中的多个参数？

> ID：15467896
> 
> 赞同：5
> 
> 时间：2013-03-18T00:09:59.727
> 
> 标签：string, function, split, tcl, procedures

我有一个程序需要接受一定数量的参数来制作数组。我有一个 csv 文件，其中包含每行参数的信息。使用命令*[split $line ,]*，返回中间有空格的信息，除了程序将其视为一个参数而不是 7 或 8 个参数。如何获取 csv 行，如下所示：

```
 day-month-year,34,3,12,5,1,54,21,$big money 
```

被视为多个参数，例如：

```
 date num1 num2 num3 num4 num5 num6 num7 money 
```

或如下变体：

```
 day month year num1 ... num7 big money 
```

拆分命令返回：

```
 date num1 num2 num3 num4 num5 num6 num7 {big money} 
```

这很好，只是它被视为单个参数。我的电话看起来像这样：

```
 procName [split $line ,] 
```

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-18T00:47:09.487

如果您使用的是 Tcl 8.5 或更高版本：

```
procName {*}[split $line ,] 
```

如果您使用的是 Tcl 版本 8.4，则 {*} 结构尚不存在，您别无选择，只能执行以下操作：

```
eval procName [split $line ,] 
```

请注意，评估可能不安全，尤其是在输入来自未知来源的情况下。

### 更新

{*} 构造称为*参数扩展*。我所知道的是：

```
procName {*}{a b c} 
```

是相同的：

```
procName a b c 
```

此功能在 Tcl 改进提案 (TIP) [293](http://www.tcl.tk/cgi-bin/tct/tip/293.html)中提出，并在[Tcl'er Wiki](http://wiki.tcl.tk/9468)中进行了讨论。

# ios - 如何将对对象的引用传递给包含在导航控制器中的模态呈现的视图控制器？

> ID：15467897
> 
> 赞同：0
> 
> 时间：2013-03-18T00:10:08.657
> 
> 标签：ios, objective-c, uinavigationcontroller, modalviewcontroller, presentmodalviewcontroller

我在传递对我的数据对象的引用时遇到问题。呈现视图控制器具有对数据对象的引用。模态视图控制器连接到导航控制器，并且是它的根视图控制器。这是我的做法：

介绍VC：

```
- (IBAction)changeCustomerButtonPress:(UIButton *)sender {    
    UINavigationController *customersNC = [self.storyboard instantiateViewControllerWithIdentifier:@"customersNC"];
    SCCustomersVC *customersVC = (SCCustomersVC *)[self.storyboard instantiateViewControllerWithIdentifier:@"customersVC"];
    customersVC.dataObject = self.splitVC.dataObject;

    //at this point, customersVC.dataObject exists

    [self presentViewController:customersNC animated:YES completion:nil];
} 
```

当模态VC出现时，self.dataObject为nil。

```
- (void)viewWillAppear:(BOOL)animated
{       
    //self.dataObject is nil here.
} 
```

这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T00:17:53.983

您在 IB 中的导航控制器是否有根视图控制器？如果，不应该。但是假设你有一个，你不应该实例化 SCCustomersVC，因为导航控制器在实例化时会这样做。要传递数据，只需使用 topViewController 获取对该控制器的引用：

```
SCCustomersVC *customersVC = (SCCustomersVC *)[customerNC topViewController];
    customersVC.dataObject = self.splitVC.dataObject; 
```

# javascript - 仅当文档与数据库不同时才更新文档？

> ID：15467898
> 
> 赞同：3
> 
> 时间：2013-03-18T00:10:30.940
> 
> 标签：javascript, node.js, mongodb, express, mongoskin

我在 mongodatabase 中有一个文档

```
user:{
    name:'bruce',
    surname:'wayne',
    job:'batman',
    email:'onlyifdanger@batman.com',
} 
```

所以当用户更新信息时，我必须：

1.  如果用户存在，则查询数据库
2.  如果存在获取数据库的值
3.  将数据库的值与用户发送的表单值进行比较
4.  如果数据库中的值相等，则丢弃该操作
5.  如果数据库中的值不同，则使用表单值更新值
6.  关闭数据库并发送.response

所以在这种情况下，如果用户发送这个：

```
form.newUserInfo:{
    name:'bruce albert',
    surname:'wayne',
    job:'batman only at night',
    email:'onlyifdanger@batman.com',
} 
```

只需更新姓名和工作。

有什么方法可以在不到 6 步的时间内做到这一点？我正在使用 nodejs v0.10、mongodb 2.2.3、expressjs 和 mongoskin v0.5

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T16:58:09.950

您可能已经从其他评论/答案中获得了所需的信息。但这是一种非常强大的插入数据的方法。

使用 $findAndModify 你可以控制乐观并发和 upsert。

如果您愿意，您可以找到差异，但如果您可以确定文档与用户打开它时的文档相同，您将使用 findAndModify 自动更新文档，其中值与加载时的文档相同.

此命令中的更新部分会更新所有值，但如果您愿意，可以根据差异轻松限制它。

查询匹配文档在修改之前的所有值。这确保了自用户打开它以来它没有被更改。

```
db.people.findAndModify( {
   query: {
        name:'bruce',
        surname:'wayne',
        job:'batman',
        email:'onlyifdanger@batman.com',
    },    
   update: {
        name:'bruce',
        surname:'wayne',
        job:'business owner',
        email:'bruce@wayne.com',
    },
   upsert: true
   // uncomment next line to get the updated / new document return
   // ,new : true
} ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T12:43:15.453

听起来您正在寻找更新结果的特定字段而不是整个对象本身。即如果用户*只*提供名称的更新参数，您只想更新数据库中的名称。使用您的名字：'bruce albert' 示例，newUserInfo 将是

```
newUserInfo: {
  name: 'bruce albert',
  surname: '',
  job: '',
  email: ''
} 
```

并且您不想简单地使用这些值进行更新，因为您要么擦除已有的信息，要么添加一条信息较少的重复记录。

在这种情况下，您只能优化到目前为止。

1.  如果用户存在，则查询数据库
2.  如果存在，则获取数据库的值
3.  将数据库的值与用户发送的表单值进行比较
4.  如果数据库中的值相等，则丢弃该操作
5.  如果数据库中的值不同，则使用表单值更新值
6.  关闭数据库并发送响应

步骤 1 和 2 可以合并，因为 findOne() （或类似的东西）将返回记录匹配参数，但前提是对象存在。如果它不存在，您可能需要插入用户传递的值。

可以删除第 4 步，因为本质上它什么也没做。

第 5 步可能是最重要的，因为您必须定义值如何“不同”。想一想，你想用 job='' 更新吗？因为这与“蝙蝠侠”“不同”，尽管您可能不想使用该值进行更新。

我的步骤是

1.  查看该记录是否存在于数据库中。
    *   如果不是，请插入对象并转到步骤 3
    *   如果是，请转到步骤 2
2.  将数据库对象中的值与用户提供的值进行比较。
    *   如果值不同（以您想要的方式），请根据需要更新每个字段。
    *   如果值相同，则无事可做，转到步骤 3
3.  关闭数据库并向用户发送响应

希望这可以帮助。

# java - 为什么双击和命令提示符时 Java 应用程序的行为不同

> ID：15467899
> 
> 赞同：3
> 
> 时间：2013-03-18T00:10:48.223
> 
> 标签：java, swing, executable-jar, text-rendering

我有一个 java 应用程序，与使用命令提示符启动它相比，通过双击 jar 文件在 Windows 中启动它时，它的行为有所不同。

我特别注意到的行为是当我覆盖 JLabel 以使用以下内容更好地呈现时

```
 lblDate = new ATimeLabel(ATimeLabel.DATE_LETTERS) {
        private static final long serialVersionUID = 1L;

        @Override
        protected void paintComponent(Graphics g) {

            Graphics2D g2d = (Graphics2D) g;

            g2d.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING,
                    RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
            g2d.setRenderingHint(RenderingHints.KEY_RENDERING,
                    RenderingHints.VALUE_RENDER_QUALITY);
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                    RenderingHints.VALUE_ANTIALIAS_ON);
            g2d.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS,
                    RenderingHints.VALUE_FRACTIONALMETRICS_ON);

            super.paintComponent(g2d);
        }
    }; 
```

当我从我的 IDE 启动应用程序或从命令提示符启动 jar 时会出现效果，但是当我双击我的应用程序时，它会显示没有`paintComponent()`覆盖效果的标签。

将不胜感激帮助弄清楚如何能够在双击我的应用程序时产生相同的效果。

**编辑：**

我还应该提到，我在创建 2 个 JLabels 之一后添加了以下字体更改

```
lblDate.setForeground(Color.gray);
lblDate.setFont(boldFont.deriveFont(Font.PLAIN, timeFontSize)); 
```

这是它的外观的屏幕截图。左边的那个显然具有我正在寻找的抗锯齿和干净的文本渲染，而右边的那个更胖而且不那么锐利。（我也临时加了红色边框，表示paint方法有效）

![](../Images/e6d891b659f4625ca382431f2c4d35f6.png)

**编辑2：**

似乎当我双击 JVM 是 1.7 并且我的 IDE 使用 JDK 1.6 时，我不明白为什么字体的 RenderingHints 在 Java6 和 Java7 上看起来不一样，它们都在 API 中并且运行时没有例外......

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:39:43.233

似乎对我来说工作得很好......

从左到右，在 IDE 中，从命令行并双击...

![在此处输入图像描述](../Images/f35d1a42cf1d7f9770bb6621dac8161b.png)

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridBagLayout;
import java.awt.RenderingHints;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class TestPaintLabel {

    public static void main(String[] args) {
        new TestPaintLabel();
    }

    public TestPaintLabel() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JLabel lblDate = new JLabel("Hello, is it me you're looking for?") {
                    private static final long serialVersionUID = 1L;

                    @Override
                    protected void paintComponent(Graphics g) {

                        Graphics2D g2d = (Graphics2D) g.create();

                        g2d.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING,
                                RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
                        g2d.setRenderingHint(RenderingHints.KEY_RENDERING,
                                RenderingHints.VALUE_RENDER_QUALITY);
                        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                                RenderingHints.VALUE_ANTIALIAS_ON);
                        g2d.setRenderingHint(RenderingHints.KEY_FRACTIONALMETRICS,
                                RenderingHints.VALUE_FRACTIONALMETRICS_ON);

                        super.paintComponent(g2d);
                        g2d.setColor(Color.RED);
                        g2d.drawRect(0, 0, getWidth() - 1, getHeight() - 1);
                        g2d.dispose();

                    }

                    @Override
                    public Dimension getPreferredSize() {
                        return new Dimension(200, 50);
                    }

                };

                JFrame frame = new JFrame("Testing");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new GridBagLayout());
                frame.add(lblDate);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }
} 
```

尝试添加一些额外的绘画以确定该`paint`方法是否实际被调用。

# jquery - jQuery倒计时时区

> ID：15467900
> 
> 赞同：0
> 
> 时间：2013-03-18T00:10:56.933
> 
> 标签：jquery, timer, timezone, countdown

我正在使用这个[jQuery 倒计时插件](https://github.com/zackperdue/Countdown.git)

这是[js文件](https://github.com/zackperdue/Countdown/blob/master/jquery.countdown.js)

我想知道这个插件是否会根据您所在的国家/地区自动设置时区。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:28:12.633

因为他使用的是 Javascript Date 对象，所以答案是肯定的。时间计算使用运行浏览器的机器的时区。

( [http://www.w3schools.com/jsref/jsref_obj_date.asp](http://www.w3schools.com/jsref/jsref_obj_date.asp) )

# ruby-on-rails - 带有 ActiveMerchant 的 PayPal API（旧代码）

> ID：15467901
> 
> 赞同：2
> 
> 时间：2013-03-18T00:11:15.697
> 
> 标签：ruby-on-rails, paypal

我继承了一些遗留的 Rails 代码（2.1.3），并且似乎有 a`public_cert`和`signature`. 我以为 PayPal 使用了其中一种，但我的配置似乎两者兼有：

```
config.app_config.pay_pal.merge!(
  :password=>"WHATEVER",
  :public_key=>"-----BEGIN CERTIFICATE-----\nMIICmTCCAgKgAwIBAgIDEcmhMA0GCSqGSIb3DQEBBQUAMIGZMQswCQYDVQQGEwJV\nUzETMBEGA1UECBMKQ2FsaWZvcm5pYTERMA8GA1UEBxMIU2FuIEpvc2UxFTATBgNV\nBAoTCHANGEDSTUFFqe0RzCDhQmVhgtNWZxeqzjVbVrCx80jF1\nWi/+ksJQLPViFj9+F4WS5i4MjMeCIwIDAQABow0wCzAJBgNVHRMEAjAAMA0GCSqG\nSIb3DQEBBQUAA4GBAMwavx4Eh2JCOCOc/WvL7zdRL07So48mQ9aJr4Bxdgib+/z2\nkqX0ZPJv9T6NQ1h9lcwohIuaJMXtLAysJMjvKcvPdzcHqB6Xv+OGpi2REJjUdB39\n9amutkxQVhKBfK3hCP4+8UlM1yzxejyK8SVWSJCbc5zvJFoLV4SZcbNevtw9\n-----END CERTIFICATE-----\n",
  :business=>"me@site.com",
  :business_id=>"4WSDFSFSDF",
  :login=>"me_api1.site.com",
  :cert_id=>"AAAA",
  :private_key=>"-----BEGIN RSA PRIVATE KEY-----\nMIICXAIBAAKBgQDm5fXKcp6ht6+Be4Y7VOaNvEPZwVqRt0CHANGEDMORESTUFFKTF7Mozcg12qiq1VDqFYwQF\n8gteGGLFy3GKPWlpqtJzAI4xfpI07d2ivgfXkk4Q74np+P8udulM0bEA+WAoGO6e\nHZ7g0/EbutA0+H5TTSp3gUYa5xcUhSrMiYN/r6HK+aeKnNECQQD8D/oBjEsZwsAB\n2KxDLZfEcrmFiLxjqQSBKPtMJP0Lrhl7OyB2v1o3QDA5+QdbDFbRxA1RNQfw+ZXo\nPuP49DRpAkEA6oFYlNnGvNWlHxDmVob5q88HEgP/ZEWFJXzZcSsAkJNrbdyPCdSj\nxN2M0duJlegJlfsr6l9OyBeFcSXnrVSAqwJBAO7BP2FJ/zUGeJMHJpx3SkOFG9+1\nliScSy0AoZANlTcEERTd+7EfLZgaD9RJ40LF3FLTbn3WSpBiCTG0qIH+5skCQF4K\n5SU8eJC99OwScOz+UB3wdltpMwBZSN4RxXm2zxErrYdvTgWZOtv2JUT7j5+IYF+/\nTIs/EW74z9DibJh8LOUCQEsMclIUTorjVVtAgI5LiSwenDSCgf9Ra0r3CoL3dAGz\n1RskSziPqfQyA2QDFfSPkmycgxPlZvP0G8fwuBs6sjI=\n-----END RSA PRIVATE KEY-----\n",
  :signature=>"AwhNvKUCHANGEDSTUFF9xveB4"
) 
```

我正在使用`PayPal Payments Standard`我相信的 Rails `ActiveMerchant`。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T15:26:15.170

PayPal 只允许您使用其中一种。可能是之前的人生成了证书或签名并将其添加到代码中，只是为了在以后切换到其他方法并且从未将其从代码中删除。如果它当前正在使用 PayPal 帐户并正在处理付款，您可以登录 PayPal 帐户并查看该帐户当前处于活动状态的帐户。你只会看到一个或另一个。无论您看到哪一个，都意味着另一个不会被使用。如果它不显示，它将不再有效。

另一种选择是，您可以浏览代码并查看 API 调用的位置，并检查它发送给 PayPal 的是哪个。

# api - 有没有办法通过产品广告 API 告诉某人从您的网站购买了哪些商品？

> ID：15467902
> 
> 赞同：0
> 
> 时间：2013-03-18T00:11:16.663
> 
> 标签：api, amazon

是否可以查看用户是否购买了您在您的网站上列出的商品？

我希望能够跟踪用户通过我的网站从亚马逊购买的商品。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-12T22:30:23.200

我认为这可以使用远程购物车来实现。 [http://docs.aws.amazon.com/AWSECommerceService/latest/DG/CreatingaRemoteShoppingCart.html](http://docs.aws.amazon.com/AWSECommerceService/latest/DG/CreatingaRemoteShoppingCart.html)

当然，您需要一些代码来将您网站中的用户与购物车 ID 相关联。

# css - CSS 导航图像不会停止堆叠

> ID：15467905
> 
> 赞同：0
> 
> 时间：2013-03-18T00:11:47.440
> 
> 标签：css, navigation, rollover

这是我第一次使用这个网站，我一直在尝试做一些翻转导航。所有图像都会产生悬停效果，但它们彼此堆叠而不是彼此相邻。如何让它们水平布局而不是垂直布局？

我的代码如下。

## CSS：

```
html, body{margin: 0; padding: 0; background-color: #c0c0c0;}
p{width:900px; position: relative; left: 30px;}
h2{width:900px; position: relative; left: 30px;}
.container{width:960px; margin: auto;}  

.header{height: 124px;}                     
.navigation{height: 59px; width: 960px;}

.navigation1{
        display: block;
    width: 136px;
    height: 59px;
        background-image: url('http://fakehost:8888/TheWorksPlumbing/images/navigationImages/nav_01.jpg');
    background-position:0px -59px;
        text-indent: -99999px;
}
.navigation1:hover{background-position:0px 0px;}

.navigation2{
        display: block;
        width: 138px;
    height: 59px;
        background-image: url('http://fakehost:8888/TheWorksPlumbing/images/navigationImages/nav_02.jpg');
    background-position:0px -59px;
        text-indent: -99999px;
}
.navigation2:hover{background-position: 0 0;}

.navigation3{
        display: block;
        width: 170px;
    height: 59px;
        background-image: url('http://fakehost:8888/TheWorksPlumbing/images/navigationImages/nav_03.jpg');
    background-position:0px -59px;
        text-indent: -99999px;
}
.navigation3:hover{background-position: 0 0;}

.navigation4{
        display: block;
        width: 138px;
    height: 59px;
        background-image: url('http://fakehost:8888/TheWorksPlumbing/images/navigationImages/nav_04.jpg');
    background-position:0px -59px;
        text-indent: -99999px;
}
.navigation4:hover{background-position: 0 0;}

.navigation5{
        display: block;
        width: 168px;
    height: 59px;
        background-image: url('http://fakehost:8888/TheWorksPlumbing/images/navigationImages/nav_05.jpg');
    background-position:0px -59px;
        text-indent: -99999px;
}
.navigation5:hover{background-position: 0 0;}

.navigation6{       
        display: block;
        width: 210px;
    height: 59px;
        background-image: url('http://fakehost:8888/TheWorksPlumbing/images/navigationImages/nav_06.jpg');
    background-position:0px -59px;
        text-indent: -99999px;
}
.navigation6:hover{background-position: 0 0;}

.mainAd{height: 271px;}                     
.mainbody{background-color: white;}
.map{position: relative; left: 30px;}
.footer{height: 197px;} 
```

## HTML：

```
 <div class="container">
            <div class="header"><img src="http://localhost:8888/TheWorksPlumbing/images/Layout_01.jpg"></div>
             <div class="navigation" >
                 <div class="navigation1"><a href="home">Home</a></div>
                 <div class="navigation2"><a href="about">About</a></div>
                 <div class="navigation3"><a href="services">Services</a></div>
                 <div class="navigation4"><a href="rates">Rates</a></div>
                 <div class="navigation5"><a href="specials">Specials</a></div>
                 <div class="navigation6"><a href="contact">Contact</a></div>
             </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:22:32.490

```
float: left; 
```

在每个导航元素上都会使它们水平。

尽管我认为您的代码过于复杂。也许尝试使用一个列表并将您的常见样式浓缩在

```
ul.navigation li {
     float: left
     .....
} 
```

此外，您可能需要向父元素添加溢出：隐藏，以便它环绕导航的浮动列表项。

```
ul.navigation {
    width: 960px;
    overflow: hidden;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:22:43.137

添加这个CSS：

```
.navigation div {
    float: left;
} 
```

# ruby - 如何解码通过 UTF8 中的 Net::IMAP 获取的主题？（红宝石）

> ID：15467906
> 
> 赞同：6
> 
> 时间：2013-03-18T00:11:48.567
> 
> 标签：ruby, utf-8, jruby, imap

我正在使用 Net::IMAP.fetch 从 Gmail 中获取一些邮件。但是，当我获取具有 UTF8 主题（即西里尔文）的消息时，我会得到如下信息：

```
=?UTF-8?B?0KHRgNC/0YHQutC4INGE0L7RgNGD0Lwg0YLRgNCw?= =?UTF-8?B?0LbQuCDQuNC30LHQvtGA0L3QuCDQvNCw0YLQtdGA0Lg=?= =?UTF-8?B?0ZjQsNC7INC4INC90LAg0ZvQuNGA0LjQu9C40YY=?= =?UTF-8?B?0LggLSBjaXJpbGFjZSB0ZXN0?= 
```

如何将上述字符串转换为 UTF8？

注意：这是针对 ruby​​ 1.8.7

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T00:44:22.770

答案是：

`Mail::Encodings.unquote_and_convert_to( string, 'utf-8' )`

关键是电子邮件主题的编码是“QUOTED-PRINTABLE”编码（Gmail 默认情况下）。

# django - haystack whoosh 没有结果-rebuild_index 显示索引 [number]

> ID：15467908
> 
> 赞同：1
> 
> 时间：2013-03-18T00:12:09.503
> 
> 标签：django, django-haystack, whoosh

当我跑步时，`./manage.py rebuild_index`我会得到读数，例如：

`Indexing 4574 <django.utils.functional.__proxy__ object at at 0x1aab690> .`

看到其他用户的读数后，这应该显示搜索索引/模型的名称，我想知道这是否可以解释为什么我在网站上没有遇到搜索结果并且似乎没有对象执行时索引：

```
>>> from haystack.query import SearchQuerySet
>>> sqs = SearchQuerySet().all()
>>> sqs.count() 
```

我最初没有 def _ *unicode* _self(): return self.name 在我正在索引的模型上，但后来我添加了它，即使做了之后似乎也没有任何改变`rebuild_index`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T20:50:40.543

这是 Django Haystack 的 GitHub [pull request #746](https://github.com/toastdriven/django-haystack/pull/746)，现已合并。

我在本地（开发）设置中看到了同样的问题。更新为我解决了“功能代理”占位符问题。

我运行了以下命令：

```
pip install -e git+git://github.com/toastdriven/django-haystack.git@master#egg=django-haystack 
```

您可能需要调整命令以适应您自己的需要和/或环境。

# c++ - 没有实例化的属性除数？

> ID：15467909
> 
> 赞同：8
> 
> 时间：2013-03-18T00:12:11.123
> 
> 标签：c++, opengl, opengl-3

我知道这`glVertexAttribDivisor`可用于修改在实例化渲染期间通用顶点属性的推进速率，但我想知道是否有任何方法可以在不实例化的情况下以特定速率推进属性。

这是我的意思的一个例子：

假设您正在定义组成一系列线的顶点位置列表，并且您希望与每条线关联一个 ID。因此，您创建了两个 vbo，每个 vbo 都包含与这些属性之一相关的数据（所有顶点位置或所有顶点 ID）。传统上，这意味着每个 vbo 必须是行数 X 2 的大小（以元素为单位）（因为每个点包含两条线）。这当然意味着我为一行中的每个点复制相同的 ID 值。

相反，我想做的是指定顶点位置缓冲区每 2 个元素推进 1 个元素的 ID。我知道这需要首先声明我的顶点位置缓冲区（以便我可以引用它来告诉 OpenGL 多久推进一次 ID 缓冲区），但它似乎仍然是可能的。但是，我在 OpenGL 规范中找不到任何允许这种操作的函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T02:19:49.933

你想要的东西在 OpenGL 中通常是不可能的。[它实际上是多索引渲染](https://stackoverflow.com/questions/11148567/rendering-meshes-with-multiple-indices)的一种受限形式，因此您必须使用其中一种技术来获得它。

# android - 从 getSharedPreferences（自定义文件）迁移到 getDefaultSharedPreferences()

> ID：15467916
> 
> 赞同：1
> 
> 时间：2013-03-18T00:13:29.560
> 
> 标签：android, sharedpreferences

当我最初编写和发布我的应用程序时，我使用自定义的书面活动来处理应用程序设置。我使用自定义文件名来存储共享首选项，如下所示：

```
getSharedPreferences("custom_settings_file",MODE_PRIVATE); 
```

但现在我正在重构我的应用程序，我想实现`PreferenceActivity`或[PreferenceFragment](http://developer.android.com/reference/android/preference/PreferenceFragment.html)和一个带有`PreferenceScreen`部分的 xml 文件。我见过的每个教程或示例都在使用

```
getDefaultSharedPreferences(context); 
```

检索共享首选项，因为 PreferenceActivity 假定默认文件名来存储首选项，并且无法告诉它使用不同的首选项（至少在搜索和阅读文档一小时后我找不到一个）。

所以现在我有一个问题。如果我只是简单地使用新的默认文件，我的应用程序的现有用户将在更新应用程序时丢失他们的设置，因为新应用程序将不知道任何关于“custom_settings_file”的信息。在应用程序更新时将数据从旧文件移动到新文件的最佳方法是什么？

以下是我可以提出的可能选项：

*   扩展`Application`类并在 onCreate() 中实现一段代码，这样每次启动我的应用程序时，它都会检查“custom_settings_file”是否存在并将其内容移动到新的。但是在每次应用程序启动时运行一段代码似乎对于只需要运行一次的操作浪费了太多的处理资源。
*   只需通知用户他们的旧设置已消失。但显然这是不能接受的。

有比选项 1 更好的解决方案吗？也许有人已经面临类似的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T00:55:43.033

是什么阻止你只做一次第一？只需在新的共享首选项中添加一个“迁移”布尔值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T01:04:23.177

如果您还加载了 xml 首选项文件，那么您可以试试这个：

```
PreferenceManager.setDefaultValues(context, YOUR_PREFERENCE_NAME, MODE_PRIVATE, R.xml.preference_file, false); 
```

如果没有（您想在代码中动态添加每个首选项），那么您可以这样做：

```
PreferenceManager pm = getPreferenceManager();
pm.setSharedPreferencesMode(MODE_PRIVATE);
pm.setSharedPreferencesName(YOUR_PREFERENCE_NAME); 
```

如果您仍然想使用`defaultSharedPreference`并处理迁移，那么......我正在写这个，我看到了 Nicklas 的答案，所以我在这里完成了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T00:57:20.067

您能否在记录您是新安装还是升级的新 SharedPreferences 中添加价值。如果您的共享首选项中没有该设置，请检查您是否有以前的旧首选项文件。然后将这些首选项转换为您的新方法，并设置您的私人设置以表明它已升级。然后只需设置指示新状态的新值，您就无需再检查旧的偏好。

# django - django - 具有字符和整数的查询集 order_by 字段

> ID：15467920
> 
> 赞同：2
> 
> 时间：2013-03-18T00:13:53.747
> 
> 标签：django, django-queryset

我有一个模型，它有一个`this_field`存储为`string`. 中的值`this_field`采用格式`Char###`- 就像在中一样，它们具有以下值：`A4`或`A34`或`A55`（请注意，它们将始终具有相同的第一个字符）。

有没有办法选择所有记录并按此字段排序？目前，当我这样做时，`.order_by('this_field')`我会收到这样的订单：

`A1` `A13` `A2` `A25` ETC...

我想要的是：

`A1` `A2` `A13` `A25` ETC...

是否有任何最佳方法或解决方案来实现此查询集的正确排序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T01:07:25.137

查询集排序由数据库后端处理，而不是由 Django。这限制了更改排序方式的选项。您可以加载所有数据并使用 Python 对其进行排序，也可以向查询添加其他选项，以使数据库通过定义函数来使用某种自定义排序。

使用 queryset [extra()](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.extra)函数将允许您通过执行自定义 SQL 进行排序来做您想做的事情，但代价是降低了可移植性。

在您的示例中，将输入字段拆分为两组数据、初始字符和剩余的整数值可能就足够了。然后，您可以对两列应用排序。这是一个示例（未经测试）：

```
qs = MyModel.objects.all()

# Add in a couple of extra SELECT columns, pulling apart this_field into
# this_field_a (the character portion) and this_field_b (the integer portion).

qs = qs.extra(select={
              'this_field_a': "SUBSTR(this_field, 1)",
              'this_field_b': "CAST(substr(this_field, 2) AS UNSIGNED)"}) 
```

该`extra`调用将两个新字段添加到`SELECT`调用中。第一个子句提取字段的第一个字符，第二个子句将字段的其余部分转换为整数。

现在应该可以`order_by`在这些字段上。通过为 指定两个字段`order_by`，排序首先适用于字符字段，然后适用于整数字段。

例如

```
qs = qs.order_by('this_field_a', 'this_field_b') 
```

这个例子应该适用于 MySql 和 SQLite。还应该可以创建一个仅用于排序的额外字段，允许您在`order_by()`调用中仅指定一个字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-18T15:26:38.863

如果您经常使用这种排序顺序并且在更大的表上，您应该考虑两个包含分隔值的单独字段：

1.  alpha 值应仅小写，在文本或字符字段中，`db_index=True`设置
2.  数值应该在一个整数字段中，`db_index=True`并对其进行设置。

`qs.order_by('alpha_sort_field', 'numeric_sort_field')`

否则，您可能会遇到一些（或最大的）性能影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-18T01:45:50.270

另一种方法是根据 int 部分对 QuerySet 进行排序`this_field`：

```
qs = ModelClass.objects.all()
sorted_qs = sorted(qs, key=lambda ModelClass: int(ModelClass.this_field[1:])) 
```

# node.js - 如何修复 WebStorm 无法识别某些 Node.js Express 属性？

> ID：15467921
> 
> 赞同：23
> 
> 时间：2013-03-18T00:13:54.387
> 
> 标签：node.js, intellij-idea, express, syntax-highlighting, webstorm

执行`express mysite`和 npm install -d 后，我用 WebStorm 打开生成的目录，IDE 无法识别以下 Express 方法：

```
app.use(express.favicon());
app.use(express.logger('dev'));
app.use(express.bodyParser());
app.use(express.methodOverride()); 
```

如何解决？

[注意：在我这样](http://blog.jetbrains.com/webide/2012/03/attaching-the-sources-of-node-js-core-modules/)做后IDE能够识别很多新事物并在设置中将模块目录添加为JavaScript库，但仍然无法识别上述方法。查看图像以了解 IDE 到目前为止识别的内容![在此处输入图像描述](../Images/83c0f728a5926314ef58c03b9d7d2f4a.png)

在下图中，您可以看到 IDE 仍然无法识别的内容：

![在此处输入图像描述](../Images/819124866511dab9ee730c54726167a1.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-05-17T23:24:08.093

这适用于几乎所有的 JS 项目。您应该明确定义对象的属性*或*编写 JSDocs：

```
/**
 * @memberOf   myLib
 * or
 * @name       myLib.MyDynamicallyLoadedModule
 */
var MyDynamicallyLoadedModule = {}; 
```

否则，WebStorm 无法理解您拥有动态属性。

（是的，我知道你指的是 Express，但这就是 WebStorm 的工作方式）

# haskell - 在 Haskell 中维护复杂状态

> ID：15467925
> 
> 赞同：66
> 
> 时间：2013-03-18T00:14:26.167
> 
> 标签：haskell, functional-programming, state

假设您正在 Haskell 中构建一个相当大的模拟。有许多不同类型的实体，它们的属性会随着模拟的进行而更新。例如，假设您的实体称为猴子、大象、熊等。

维护这些实体状态的首选方法是什么？

我想到的第一个也是最明显的方法是：

```
mainLoop :: [Monkey] -> [Elephant] -> [Bear] -> String
mainLoop monkeys elephants bears =
  let monkeys'   = updateMonkeys   monkeys
      elephants' = updateElephants elephants
      bears'     = updateBears     bears
  in
    if shouldExit monkeys elephants bears then "Done" else
      mainLoop monkeys' elephants' bears' 
```

在`mainLoop`函数签名中明确提到每种类型的实体已经很丑陋了。你可以想象如果你有 20 种实体，它会变得多么糟糕。（20 对于复杂的模拟来说并非不合理。）所以我认为这是一种不可接受的方法。但它的可取之处在于，like 函数`updateMonkeys`的作用非常明确：它们获取一个 Monkey 列表并返回一个新的。

所以接下来的想法是将所有内容滚动到一个包含所有状态的大数据结构中，从而清理 的签名`mainLoop`：

```
mainLoop :: GameState -> String
mainLoop gs0 =
  let gs1 = updateMonkeys   gs0
      gs2 = updateElephants gs1
      gs3 = updateBears     gs2
  in
    if shouldExit gs0 then "Done" else
      mainLoop gs3 
```

有人会建议我们`GameState`在 State Monad 中结束，然后`updateMonkeys`在`do`. 没关系。有些人宁愿建议我们用函数组合来清理它。也很好，我想。（顺便说一句，我是 Haskell 的新手，所以也许我对其中的一些错误。）

但问题是，像`updateMonkeys`这样的函数并没有从它们的类型签名中给你有用的信息。你不能确定他们在做什么。当然，`updateMonkeys`是一个描述性的名称，但这并不能算是安慰。当我传入一个[上帝对象](http://en.wikipedia.org/wiki/God_object)并说“请更新我的全局状态”时，我感觉我们回到了命令世界。*感觉就像是另一个名字的全局变量：你有一个对全局状态做某事*的函数，你调用它，你希望它是最好的。（我想你仍然可以避免一些在命令式程序中会出现在全局变量中的并发问题。但是，并发几乎不是全局变量的唯一错误。）

另一个问题是：假设对象需要交互。例如，我们有一个这样的函数：

```
stomp :: Elephant -> Monkey -> (Elephant, Monkey)
stomp elephant monkey =
  (elongateEvilGrin elephant, decrementHealth monkey) 
```

假设这被调用`updateElephants`，因为这是我们检查是否有任何大象在任何猴子的踩踏范围内的地方。在这种情况下，你如何优雅地将变化传播给猴子和大象？在我们的第二个示例中，`updateElephants`接受并返回一个上帝对象，因此它可以影响两种更改。但这只会进一步混淆水域并强化我的观点：使用上帝对象，您实际上只是在改变全局变量。如果您不使用上帝对象，我不确定您将如何传播这些类型的更改。

该怎么办？当然，许多程序都需要管理复杂的状态，所以我猜测有一些众所周知的方法可以解决这个问题。

只是为了比较，这就是我可能如何解决 OOP 世界中的问题。会有`Monkey`,`Elephant`等对象。我可能有类方法可以在所有活体动物的集合中进行查找。也许您可以按位置、ID 等进行查找。由于查找函数底层的数据结构，它们将保持在堆上分配。（我假设 GC 或引用计数。）它们的成员变量会一直发生变异。任何类的任何方法都可以使任何其他类的任何活体动物发生变异。例如，一个`Elephant`可以有一个`stomp`方法会减少传入`Monkey`对象的健康，并且不需要传递它

同样，在 Erlang 或其他面向角色的设计中，您可以相当优雅地解决这些问题：每个角色都维护自己的循环，从而维护自己的状态，因此您永远不需要上帝对象。消息传递允许一个对象的活动触发其他对象的更改，而无需将一堆东西一直传递到调用堆栈。然而，我听说 Haskell 中的演员不受欢迎。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-18T01:47:46.607

答案是[函数式反应式编程](http://www.haskell.org/haskellwiki/FRP)（FRP）。它混合了两种编码风格：组件状态管理和时间相关值。由于 FRP 实际上是一整套设计模式，我想更具体一点：我推荐[Netwire](http://hackage.haskell.org/package/netwire)。

基本思想非常简单：您编写许多小的、自包含的组件，每个组件都有自己的本地状态。这实际上等同于时间相关值，因为每次查询此类组件时，您可能会得到不同的答案并导致本地状态更新。然后你结合这些组件来形成你的实际程序。

虽然这听起来很复杂且效率低下，但实际上它只是围绕常规函数的一个非常薄的层。Netwire 实现的设计模式受到 AFRP（箭头函数响应式编程）的启发。它可能足够不同，值得拥有自己的名字（WFRP？）。您可能想阅读[教程](http://hackage.haskell.org/packages/archive/netwire/latest/doc/html/Control-Wire.html)。

无论如何，下面是一个小演示。你的构建块是电线：

```
myWire :: WireP A B 
```

将此视为一个组件。它是类型*B*的时变值，取决于类型*A*的时变值，例如模拟器中的粒子：

```
particle :: WireP [Particle] Particle 
```

它依赖于粒子列表（例如所有当前存在的粒子）并且本身就是一个粒子。让我们使用预定义的线（具有简化类型）：

```
time :: WireP a Time 
```

*这是Time* (= *Double* )类型的时变值。好吧，是时候了（从 0 开始，从有线网络启动时算起）。由于它不依赖于另一个随时间变化的值，因此您可以随心所欲地提供它，因此是多态输入类型。还有一些固定线（不随时间变化的时变值）：

```
pure 15 :: Wire a Integer

-- or even:
15 :: Wire a Integer 
```

要连接两条线，您只需使用分类组合：

```
integral_ 3 . 15 
```

这为您提供了一个从 3（积分常数）开始以 15 倍实时速度（15 随时间积分）的时钟。由于各种类实例，电线非常方便组合。您可以使用常规运算符以及应用样式或箭头样式。想要一个从 10 点开始并且是实时速度两倍的时钟吗？

```
10 + 2*time 
```

想要一个以 (0, 0) 速度开始和 (0, 0) 并以每秒 (2, 1) 每秒加速的粒子吗？

```
integral_ (0, 0) . integral_ (0, 0) . pure (2, 1) 
```

想要在用户按下空格键时显示统计数据？

```
stats . keyDown Spacebar <|> "stats currently disabled" 
```

这只是 Netwire 可以为您做的一小部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-28T17:32:47.673

我知道这是老话题。但是我现在在尝试从 exercism.io 实施 Rail Fence 密码练习时面临同样的问题。看到如此普遍的问题在 Haskell 中没有得到如此低的关注，真是令人失望。我不认为做一些像维护状态这样简单的事情，我需要学习 FRP。所以，我继续谷歌搜索，发现解决方案看起来更简单 - State monad：[https ://en.wikibooks.org/wiki/Haskell/Understanding_monads/State](https://en.wikibooks.org/wiki/Haskell/Understanding_monads/State)

# php - 阿帕奇，水银32，PHP邮件。无法让它工作

> ID：15467927
> 
> 赞同：0
> 
> 时间：2013-03-18T00:15:00.380
> 
> 标签：php, php-ini

我无法让 PHP 邮件发送电子邮件...

所有这些只是为了在我的本地主机设置中测试我的 php 邮件功能。XAMPP-apache,mercury,mysql,windowXP

我很确定我正确安装了mercury 32，如果我用它向root@localhost.com 发送电子邮件，它工作正常，我看到它已发送，并在我的雷鸟收件箱中进行了设置。

php.ini 是我有点困惑的地方

```
[mail function]
;---- I left this as is(out), since I AM using Mercury
; XAMPP: Comment out this if you want to work with an SMTP Server like Mercury
;SMTP = localhost
;smtp_port = 25

; For Win32 only.
; http://php.net/sendmail-from
;sendmail_from = postmaster@localhost
;---- I created a root user in mercury
sendmail_from = root@localhost

; XAMPP IMPORTANT NOTE (1): If XAMPP is installed in a base directory with spaces (e.g. c:\program filesD:\xampp) fakemail and mailtodisk do not work correctly.
; XAMPP IMPORTANT NOTE (2): In this case please copy the sendmail or mailtodisk folder in your root folder (e.g. C:\sendmail) and use this for sendmail_path.  

; XAMPP: Comment out this if you want to work with fakemail for forwarding to your mailbox (sendmail.exe in the sendmail folder)
;sendmail_path = "\"D:\xampp\sendmail\sendmail.exe\" -t"

; XAMPP: Comment out this if you want to work with mailToDisk, It writes all mails in the D:\xampp\mailoutput folder
;---- I left this as is(in), but I feel it should be commented out, but if I take out i get error in pho mail() code
sendmail_path = "D:\xampp\mailtodisk\mailtodisk.exe" 
```

* * *

邮件（）的PHP代码；

```
 .....
   $mailSubject   = "Hello there!!!";
   $mailFrom      = "From: me123@gamil.com" . "\r\n";
   $mailTo        = "root@localhost.com";

   if (mail($mailTo, $mailSubject, $mailMessage, $mailFrom)){
      echo("Message successfully sent! $mailTo");
   } 
   else {
      echo("Message delivery failed...");
   } 
```

邮件被发送，但发送到哪里？我永远找不到它

一些图片： **测试 Mercury。转到“文件>发送邮件”以获取此屏幕并创建一封电子邮件进行测试** ![测试水星。 去了](../Images/d2b2d2bdffb46f27f9d9b678143ed88a.png)

**客户电子邮件收件箱-上述图像/测试的结果** ![客户电子邮件收件箱-上述图像/测试的结果](../Images/e340508e53f38f6514a8f291a577cce5.png)

**浏览器中的脚本输出** ![屏幕输出](../Images/8373b53578656dce72d68dd515e16040.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-15T05:56:21.490

（第一：对不起我的英语不好）为了解决这个问题，我像这样配置了 php.ini 和 sendmail.ini：

php.ini：

```
[mail function]
; XAMPP: Comment out this if you want to work with an SMTP Server like Mercury
 SMTP = 127.0.0.1
 smtp_port = 25
 sendmail_from = postmaster@localhost

; For Win32 only.
; http://php.net/sendmail-from
;sendmail_from = postmaster@localhost

; XAMPP IMPORTANT NOTE (1): If XAMPP is installed in a base directory with spaces (e.g. c:\program filesC:\xampp) fakemail and mailtodisk do not work correctly.
; XAMPP IMPORTANT NOTE (2): In this case please copy the sendmail or mailtodisk folder in your root folder (e.g. C:\sendmail) and use this for sendmail_path.  
; XAMPP: Comment out this if you want to work with fakemail for forwarding to your mailbox (sendmail.exe in the sendmail folder)
;sendmail_path = "\"C:\xampp\sendmail\sendmail.exe\" -t"
;sendmail_path = "C:\xampp\sendmail\sendmail.exe\ -t"

; XAMPP: Comment out this if you want to work with mailToDisk, It writes all mails in the C:\xampp\mailoutput folder
;sendmail_path="C:\xampp\mailtodisk\mailtodisk.exe" 
```

还有 sendmail.ini

```
[sendmail]

; you must change mail.mydomain.com to your smtp server,
; or to IIS's "pickup" directory.  (generally C:\Inetpub\mailroot\Pickup)
; emails delivered via IIS's pickup directory cause sendmail to
; run quicker, but you won't get error messages back to the calling
; application.

;smtp_server=mail.mydomain.com

smtp_server=localhost 
```

记得在 PHP.ini 上评论 sendmail_path 现在它对我有用 :)

# java - 去其他活动时出错

> ID：15467931
> 
> 赞同：2
> 
> 时间：2013-03-18T00:15:31.940
> 
> 标签：java, android

我有一个带有两个按钮“设置”和“任务”的主页，它们可以打开不同的活动。当我直接进入“任务”活动时，它总是强制关闭，但如果我先进入“设置”，然后返回主菜单并按“任务”，它就可以正常工作。我认为这可能会发生，因为我在“设置”活动中有一些变量，因此必须在我转到“任务”之前启动它们。特别是在 logcat 中写到错误在 xml 文件的第 6 行，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

   <com.example.splasher.ScrollTextView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"

        android:gravity="center_vertical"
    android:id="@+id/scrolltext">
    </com.example.splasher.ScrollTextView>

</LinearLayout> 
```

错误是：致命异常：main。无法启动活动 componentinfo (com.example.splasher/com.example.splasher.Views):android.view.InflateException: Binary XML line #7:error inflating class com.example.splasher.ScrollTextView ScrollTextView.java 的代码是：

```
package com.example.splasher;

import android.content.Context;
import android.graphics.Rect;
import android.text.TextPaint;
import android.util.AttributeSet;
import android.view.animation.LinearInterpolator;
import android.widget.Scroller;
import android.widget.TextView;

public class ScrollTextView extends TextView {

    // scrolling feature
    private Scroller mSlr;

    // milliseconds for a round of scrolling
    private int mRndDuration = Integer.parseInt(Settings.speed[Settings.Speed.getSelectedItemPosition()]);

    // the X offset when paused
    private int mXPaused = 0;

    // whether it's being paused
    private boolean mPaused = true;

    /*
    * constructor
    */
    public ScrollTextView(Context context) {
    this(context, null);
    // customize the TextView
    setSingleLine();
    setEllipsize(null);
    setVisibility(INVISIBLE);
    }

    /*
    * constructor
    */
    public ScrollTextView(Context context, AttributeSet attrs) {
    this(context, attrs, android.R.attr.textViewStyle);
    // customize the TextView
    setSingleLine();
    setEllipsize(null);
    setVisibility(INVISIBLE);
    }

    /*
    * constructor
    */
    public ScrollTextView(Context context, AttributeSet attrs, int defStyle) {
    super(context, attrs, defStyle);
    // customize the TextView
    setSingleLine();
    setEllipsize(null);
    setVisibility(INVISIBLE);
    }

    /**
    * begin to scroll the text from the original position
    */
    public void startScroll() {
    // begin from the very right side
    mXPaused = -1 * getWidth();
    // assume it's paused
    mPaused = true;
    resumeScroll();
    }

    /**
    * resume the scroll from the pausing point
    */
    public void resumeScroll() {

    if (!mPaused)
    return;

    // Do not know why it would not scroll sometimes
    // if setHorizontallyScrolling is called in constructor.
    setHorizontallyScrolling(true);

    // use LinearInterpolator for steady scrolling
    mSlr = new Scroller(this.getContext(), new LinearInterpolator());
    setScroller(mSlr);

    int scrollingLen = calculateScrollingLen();
    int distance = scrollingLen - (getWidth() + mXPaused);
    int duration = (new Double(mRndDuration * distance * 1.00000
    / scrollingLen)).intValue();

    setVisibility(VISIBLE);
    mSlr.startScroll(mXPaused, 0, distance, 0, duration);
    mPaused = false;
    }

    /**
    * calculate the scrolling length of the text in pixel
    *
    * @return the scrolling length in pixels
    */
    private int calculateScrollingLen() {
    TextPaint tp = getPaint();
    Rect rect = new Rect();
    String strTxt = getText().toString();
    tp.getTextBounds(strTxt, 0, strTxt.length(), rect);
    int scrollingLen = rect.width() + getWidth();
    rect = null;
    return scrollingLen;
    }

    /**
    * pause scrolling the text
    */
    public void pauseScroll() {
    if (null == mSlr)
    return;

    if (mPaused)
    return;

    mPaused = true;

    // abortAnimation sets the current X to be the final X,
    // and sets isFinished to be true
    // so current position shall be saved
    mXPaused = mSlr.getCurrX();

    mSlr.abortAnimation();
    }

    @Override
    /*
    * override the computeScroll to restart scrolling when finished so as that
    * the text is scrolled forever
    */
    public void computeScroll() {
    super.computeScroll();

    if (null == mSlr) return;

    if (mSlr.isFinished() && (!mPaused)) {
    this.startScroll();
    }
    }

    public int getRndDuration() {
    return mRndDuration;
    }

    public void setRndDuration(int duration) {
    this.mRndDuration = duration;
    }

    public boolean isPaused() {
    return mPaused;
    }
   } 
```

任何想法出了什么问题？整个日志：

```
03-18 00:04:26.161: E/AndroidRuntime(24081): FATAL EXCEPTION: main
03-18 00:04:26.161: E/AndroidRuntime(24081): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.splasher/com.example.splasher.Views}: android.view.InflateException: Binary XML file line #7: Error inflating class com.example.splasher.ScrollTextView
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1872)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1893)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.app.ActivityThread.access$1500(ActivityThread.java:135)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1054)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.os.Looper.loop(Looper.java:150)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.app.ActivityThread.main(ActivityThread.java:4385)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at java.lang.reflect.Method.invokeNative(Native Method)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at java.lang.reflect.Method.invoke(Method.java:507)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:849)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:607)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at dalvik.system.NativeStart.main(Native Method)
03-18 00:04:26.161: E/AndroidRuntime(24081): Caused by: android.view.InflateException: Binary XML file line #7: Error inflating class com.example.splasher.ScrollTextView
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.view.LayoutInflater.createView(LayoutInflater.java:518)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:570)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:623)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.view.LayoutInflater.inflate(LayoutInflater.java:408)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.view.LayoutInflater.inflate(LayoutInflater.java:320)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.view.LayoutInflater.inflate(LayoutInflater.java:276)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:250)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.app.Activity.setContentView(Activity.java:1742)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at com.example.splasher.Views.onCreate(Views.java:26)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1836)
03-18 00:04:26.161: E/AndroidRuntime(24081):    ... 11 more
03-18 00:04:26.161: E/AndroidRuntime(24081): Caused by: java.lang.reflect.InvocationTargetException
03-18 00:04:26.161: E/AndroidRuntime(24081):    at java.lang.reflect.Constructor.constructNative(Native Method)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at java.lang.reflect.Constructor.newInstance(Constructor.java:415)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at android.view.LayoutInflater.createView(LayoutInflater.java:505)
03-18 00:04:26.161: E/AndroidRuntime(24081):    ... 21 more
03-18 00:04:26.161: E/AndroidRuntime(24081): Caused by: java.lang.NullPointerException
03-18 00:04:26.161: E/AndroidRuntime(24081):    at com.example.splasher.ScrollTextView.<init>(ScrollTextView.java:17)
03-18 00:04:26.161: E/AndroidRuntime(24081):    at com.example.splasher.ScrollTextView.<init>(ScrollTextView.java:40)
03-18 00:04:26.161: E/AndroidRuntime(24081):    ... 24 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:27:50.130

问题出现在这里：

```
private int mRndDuration = Integer.parseInt(Settings.speed[Settings.Speed.getSelectedItemPosition()]); 
```

有东西/在`null`那里（`speed`和`Speed`）

推理为什么当你直接去`Task`而不是从`Settings`到时它会崩溃`Task`：

这些静态变量似乎是`Settings`活动的一部分。如果您还没有访问过它，那么这些变量应该保留`null`，因为没有什么可以给它们任何非`null`. 从而造成NPE。

我建议你重新考虑你的方法，你不能让 UI 组件以这种方式依赖于变量，尤其是因为 UI 组件是通过`xml`.

您应该将所需的值传递给下一个 Activity 并*从下*一个 Activity 更新 UI，或者将值保存到持久存储中。

最后，给出有意义且唯一的变量名，`speed`并且`Speed`只有一个字母大小写，容易混淆阅读代码的任何人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:28:09.447

这里不对劲

```
private int mRndDuration = Integer.parseInt(Settings.speed[Settings.Speed.getSelectedItemPosition()]); 
```

你的问题来自那里。

我想你的 Settings.Speed 是空的

# php - 计算数据库表中的行数

> ID：15467932
> 
> 赞同：-2
> 
> 时间：2013-03-18T00:15:37.723
> 
> 标签：php, mysql, database, count

我正在尝试在我的网站上显示数据库表的计数。我正在使用的代码是：

```
<?php 
    $results = mysql_query("SELECT COUNT('id') from `idols`");
    $count = mysql_result($results, 0);
    $idols = number_format($count); 
    echo "$idols";
?> 
```

但是当我测试代码时，它给了我这个警告：

> 警告：mysql_result() 期望参数 1 是资源，在第 92 行给出布尔值。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:51:03.183

您的查询返回布尔值 false。

将其放在查询之后以查看您遇到的错误。

```
if (mysql_errno()) {
    printf(mysql_error());
} 
```

此外，常规的 mysql 扩展已经过时了，您可能需要考虑使用[PDO](http://php.net/manual/en/book.pdo.php)或至少使用[Mysqli](http://php.net/manual/en/book.mysqli.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:46:04.620

您遇到的问题是 PHP 在遇到错误时会为某些对象返回 FALSE。首先打印或 print_r $results 对象，并且只有在确定其值后才能继续。

使用示例 #1 中给出的语法：http: [//php.net/manual/en/function.mysql-query.php](http://php.net/manual/en/function.mysql-query.php)

此外，不推荐使用 mysql_query 并且您可能不应该使用它，以防您的站点最终想要升级到 PHP 5。

# php - 没有扩展名的 PHP 链接

> ID：15467937
> 
> 赞同：-7
> 
> 时间：2013-03-18T00:16:55.647
> 
> 标签：php, hyperlink

我如何更改链接

```
www.example.com/index.php?id=123&g=123 
```

至

```
www.example.com/index/id/123/g/123 
```

?

谢谢 ：）

编辑：请不要告诉我“使用 mod rewrite”，告诉我如何使用它：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:19:24.287

您想使用**URL 重写**。请参阅本文以完成此操作：

[http://www.addedbytes.com/articles/for-beginners/url-rewriting-for-beginners/](http://www.addedbytes.com/articles/for-beginners/url-rewriting-for-beginners/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:17:47.660

您可以进行 mod 重写（更改`.htaccess`文件）

# java - 精灵无法正常移动。libgdx

> ID：15467939
> 
> 赞同：0
> 
> 时间：2013-03-18T00:17:30.793
> 
> 标签：java, libgdx, sprite, orthographic

我是 libgdx 的新手，我正在尝试在相机跟随时进行精灵移动。我可以让精灵完美地移动，直到我将相机连接到它。当我单击时，精灵会移动到任何感觉（看起来）的地方，并且相机会正确跟随。我尝试了一些不同的东西，但此时它只是猜测和检查。

```
public class MyGdxGame implements ApplicationListener {
OrthographicCamera mCamera;
SpriteBatch mBatch;
Texture mTexture, mMap;
Sprite sprite;
float touchX, touchY;
float spriteX, spriteY, speed = 5;

@Override
public void create() {
    float CAMERA_WIDTH = 480, CAMERA_HEIGHT = 320;

    mBatch = new SpriteBatch();
    mTexture = new Texture(Gdx.files.internal("data/logo.png"));
    mMap = new Texture(Gdx.files.internal("data/sc_map.png"));
    mCamera = new OrthographicCamera(CAMERA_WIDTH, CAMERA_HEIGHT);
    mCamera.setToOrtho(false, CAMERA_WIDTH, CAMERA_HEIGHT);
}

@Override
public void dispose() {

}

@Override
public void render() {
    Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);

    mBatch.setProjectionMatrix(mCamera.combined);
    mCamera.update();
    mBatch.begin();
    updateInput();
    drawD();
    mBatch.end();

}

@Override
public void resize(int width, int height) {
}

@Override
public void pause() {
}

@Override
public void resume() {
}

public void drawD() {
    mCamera.position.set(spriteX, spriteY, 0);
    mBatch.draw(mMap, 0, 0);
    mBatch.draw(mTexture, spriteX, spriteY);

}

public void updateInput() {

    if (Gdx.input.justTouched()) {

        touchX = Gdx.input.getX();
        touchY = Gdx.input.getY();

    }
    if (touchX != spriteX) {

        if (spriteX < touchX) {
            spriteX += speed;
        }
        if (spriteX > touchX) {
            spriteX -= speed;
        }
    }
    if (touchY != spriteY) {
        if (spriteY > Gdx.graphics.getHeight() - touchY) {
            spriteY -= 10;
        }
        if (spriteY < Gdx.graphics.getHeight() - touchY) {
            spriteY += 10;
        }
    }

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T18:21:31.723

由于您已经花费了相当多的时间并试图让它发挥作用，所以我会给您一点推动力，使其更接近您正在寻找的东西。查看我所做的更改，下面我将概述我所做的以帮助您更好地理解代码。

*   正交相机，当您设置相机时，0,0 是屏幕的中心。宽度和高度是您在构造函数中指定的。所以顶边是 x, 160，底边是 x, -160。左边缘为 -240, y，右边缘为 240, y。
*   drawD() 请注意，我在图像中间绘制精灵并且它没有移动。相反，我将地图朝相反的方向移动（y 是倒置的）。
*   updateInput() 请注意，我传入了一个增量值（这是帧之间的时间，以秒为单位），这使您可以平滑地移动事物。速度为 120，因此这将以 120/秒的速度平稳移动您的角色。
*   if 条件基本上是比较浮点值的一种简单方法，因此当它足够接近时它会停止。这可以防止它过度射击目标位置然后来回弹跳，因为它可能无法达到准确的值。
*   我为您加载的纹理添加了 dispose 调用，这些调用很重要，因为您不想填满内存。

我希望这可以帮助您开始并指出正确的方向。开发游戏需要大量工作并且需要时间，所以请耐心等待，并准备好在此过程中学到很多东西！

根据您的评论，我相信您正在寻找的是更接近此的东西：

```
public class MyGdxGame implements ApplicationListener {
    OrthographicCamera mCamera;
    SpriteBatch mBatch;
    Texture mTexture, mMap;
    float touchX, touchY;
    float spriteX, spriteY, speed = 120;

    final float CAMERA_WIDTH = 480, CAMERA_HEIGHT = 320;

    @Override public void create() {
        mCamera = new OrthographicCamera(CAMERA_WIDTH, CAMERA_HEIGHT);

        mBatch = new SpriteBatch();
        mTexture = new Texture(Gdx.files.internal("data/logo.png"));
        mMap = new Texture(Gdx.files.internal("data/sc_map.png"));
    }

    @Override public void dispose() {
        mTexture.dispose();
        mMap.dispose();
    }

    @Override public void render() {
        Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);

        updateInput(Gdx.graphics.getDeltaTime());
        mCamera.update();
        mBatch.setProjectionMatrix(mCamera.combined);
        mBatch.begin();
        drawD();
        mBatch.end();
    }

    @Override public void resize(final int width, final int height) {}

    @Override public void pause() {}

    @Override public void resume() {}

    public void drawD() {
        mBatch.draw(mMap, -spriteX - (mMap.getWidth() / 2), spriteY - (mMap.getHeight() / 2));
        mBatch.draw(mTexture, -32, -32, 64, 64);
    }

    public void updateInput(final float delta) {
        if (Gdx.input.justTouched()) {
            touchX = Gdx.input.getX() - (Gdx.graphics.getWidth() / 2);
            touchY = Gdx.input.getY() - (Gdx.graphics.getHeight() / 2);
        }
        final float dv = delta * speed;
        if (Math.abs(touchX - spriteX) > 1) {
            if (spriteX < touchX) {
                spriteX += dv;
            }
            if (spriteX > touchX) {
                spriteX -= dv;
            }
        }
        if (Math.abs(touchY - spriteY) > 1) {
            if (spriteY > touchY) {
                spriteY -= dv;
            }
            if (spriteY < touchY) {
                spriteY += dv;
            }
        }
    }
} 
```

# javascript - 无法让 getJSON 与 codeigniter 一起使用

> ID：15467947
> 
> 赞同：0
> 
> 时间：2013-03-18T00:18:02.400
> 
> 标签：javascript, ajax, json, codeigniter

我正在尝试使用 getJSON，这样我就可以从我的数据库中获取最新信息。到目前为止我所做的是将它存储到一个数组中并且`json_encode(the array)`. 之所以可行，是因为我可以看到视图上的信息，但问题是 ajax 方法无法识别它。也许我错过了一些非常愚蠢的东西。

控制器：

```
public function insertJSON()
{
    $this->load->model("values");
    $queryresults = $this->values->getDb(); 
    $arr = array();

    foreach($queryresults as $row)
    {
        $arr[] =  $row->postcode;
    }

    $data['arr'] = $arr;    
    echo json_encode($arr); 
    $this->load->view('answer', $data);

} 
```

看法：

```
<html>
<head>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script>
    <script>            
        $.post('/localhost/codeigniter/index.php/welcome/insertJSON', function(data) {
            alert(data);
        });
    </script>
    </script>
</head>
<body>
</body>
</html> 
```

$arr 变量的 Var 转储：

```
array(4) {
  [0]=>
  string(5) "test1"
  [1]=>
  string(5) "test2."
  [2]=>
  string(5) "test3"
  [3]=>
  string(5) "test4"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:41:23.977

您通过调用它 ( ) 将`$data`数组（其中包含）发送到视图，并且就在它之前回显 JSON 数据。`$arr``$this->load->view('answer', $data);`

因此，您要做的是在其顶部调用一个视图，在任何 html 或 javascript 具有包含 json 编码的纯文本之前`$arr`。

这显然是错误的，而不是您要寻找的。

您应该执行以下任一选项：

1.  在标签内的 > 部分回显`$arr`at 视图。不过，您不必使用 AJAX 调用。 `<head``<script>`
2.  只是 `$arr`在控制器处回显，但不要在它之后调用视图。您可能应该为此制作另一个控制器。一个回显`$arr`，一个调用视图。这样您就可以对第一个控制器进行 AJAX 调用。
3.  将 传递`$arr`给只会回显 JSON 编码数据的视图。这类似于选项#2，但它使用视图来显示数据而不是控制器，这是遵循 MVC 模式的最合适的方式。控制器不应回显任何内容。

我建议遵循选项#3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T00:41:41.413

所以。如果您想回显一个可以使用 ajax 提取的 JSON obj，那么您需要确保您的页面的输出 mime 类型可以提供 JSON 数据。

还请注意，您无法使用您想要的 json 数据从您的函数中回显任何其他内容。正如我在你的代码中看到的，你 echo json 然后加载一个视图！你需要把它分成2个单独的页面

使固定：

```
public function _JSON()
{
    $this->load->model("values");
    $queryresults = $this->values->getDb();

    $arr = array();

    foreach($queryresults as $row)
    {
       $arr[] =  $row->postcode;
    }

    return $arr;

}

public function json_body(){
    $this->load->view('answer',array('data'=>$this->_JSON()));
}

public function getJSON(){
    $this->output
    ->set_content_type('application/json')
    ->set_output(json_encode($this->_JSON()));
}
///note that $this->_JSON() now return ur $arr so u can use it in many methods. 
```

现在加载页面你可以去`/json_body`'重命名为你想要的'，js应该是

```
<script>
$.post('<?=base_url('welcome/getJSON')?>', function(data) {
alert(data);
});
</script>
<!--notice that base_url show echo out ur url base on ur config.php file--> 
```

笔记：

函数 getJson get 使用 CI 输出类的力量来设置页面的 mime 类型，并确保这个数组是唯一的输出。这不是必须的，但它只是最佳实践。如果你愿意，你可以用简单的方式重复所有 3 行，`echo json_encode($this->_JSON());`它也可以工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T00:23:17.660

我想问题是您的帖子网址：

```
$.post('//localhost/codeigniter/index.php/welcome/insertJSON', function(data) {
   alert(data);
 }); 
```

你错过了双斜杠 (//)

# python - Python if 语句读取不正确

> ID：15467950
> 
> 赞同：0
> 
> 时间：2013-03-18T00:18:37.790
> 
> 标签：python, if-statement

所以我正在开发一款基于文本的游戏，我有一家商店可以出售矿石。我有一个 if 语句检查您要出售的矿石数量是否大于您拥有的数量。无论我输入什么数字，它都表示我没有足够的数字。

```
copore = 100 #testing
    op = raw_input(p)
    if op.lower() == "copper":
        print"""
You have %r copper ore.
How much would you like to sell?
        """ % copore
        op = raw_input(p)
        if op.lower() > copore:
            print"""
You do not have that much copper ore.
You have %r copper ore.
            """ % copore
            menu()
        elif op.lower() <= copore:
            copore = copore - op
            gold = gold + (op * 2)

            print"""
You sell your copper ore for 2 gold each.
You now have %r copper ore.
and %r gold.
            """ % (copore, gold)
            menu()
        else:
            print"""
That is not a valid number
            """
            menu() 
```

这很可能是我自己的愚蠢，但我认为让别人看它不会有什么坏处。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-18T00:22:07.373

您需要将输入 from 转换`raw_input`为整数。如果不转换它，您将进行字符串和整数比较。

```
>>> a = raw_input("Test amount:")
Test amount:10
>>> type(a)
<type 'str'>
>>> a > 10
True
>>> a > 100
True
>>> b = int(a)
>>> b > 100
False 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:22:01.630

当您需要输入文本中的数字时，您需要将其包装在转换函数中，如`int(op)`.

# php - php搜索引擎

> ID：15467957
> 
> 赞同：0
> 
> 时间：2013-03-18T00:19:37.570
> 
> 标签：php, mysql, database, search, mysqli

我有 3 个表我想用我的搜索 php 访问。其中 2 个包含所有用户的个人资料信息。一种称为 cprofile，另一种称为 bprofile。它们都链接到包含用户名、电子邮件、密码和最重要的个人资料图片的用户表。

通过搜索引擎，我试图访问从搜索到个人配置文件表的信息，并从用户表中收集帐户信息。这是我搜索这两种类型的用户的代码：

```
$search_output = "";
if( isset($_POST['searchquery']) && $_POST['searchquery'] != "" ) {
    $searchquery = preg_replace('#[^a-z 0-9?!]#i', '', $_POST['searchquery']);
    if($_POST['filter1'] == "Whole Site") {
        $sqlCommand = "(SELECT count(*) FROM cprofile WHERE firstname ='%".$searchquery."%' OR lastname ='%".$searchquery."%')
            UNION (SELECT  count(*) FROM bprofile WHERE cname ='%".$searchquery."%')";
        $query = mysqli_query( $db_conx, $sqlCommand ) or die( mysqli_error($db_conx) );
        $count = mysqli_num_rows( $query ); 
        while( $row = mysqli_fetch_array($query, MYSQLI_ASSOC) ) {
            $userid = $row["userID"];
            $ret = mysqli_query($db_conx, "SELECT id, username FROM users WHERE id='$userid'");
            while($raw = mysqli_fetch_array($ret, MYSQLI_ASSOC)) {
                $username = $raw['username']; $file= $raw['avatar'];
            }
        }
    }
} 
```

有谁注意到我哪里出错了，我该如何解决这个问题？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T02:32:29.367

我可能在这里走错了方向，但是您从查询中获取计数，然后在 while 循环中查找用户 ID。如果你想要两个然后做类似的事情

```
$sqlCommand = "
  (SELECT userid, count(*) as count FROM cprofile WHERE firstname ='%".$searchquery."%' OR lastname ='%".$searchquery."%')
    UNION 
  (SELECT userid, count(*) as count FROM bprofile WHERE cname ='%".$searchquery."%')
"; 
```

# wicket - 是否可以在扩展组件中使用 Wicket 片段？

> ID：15467959
> 
> 赞同：1
> 
> 时间：2013-03-18T00:19:56.610
> 
> 标签：wicket, wicket-1.5

我正在尝试在扩展组件中使用片段，但它会引发 MarkupNotFoundException。

代码与此类似：

**BasePanel.html**

```
<?xml version="1.0" encoding="UTF-8" ?>
<wicket:panel xmlns:wicket="http://wicket.apache.org">

    <div wicket:id="dialog">
        <div class="titlebar">
            <h3 wicket:id="dialogTitle">[[ dialog title ]]</h3>
            <div wicket:id="dialogCloseBtn" class="closeBtn right"></div>
        </div>
        <wicket:child />
    </div>

</wicket:panel> 
```

**ChildPanel.html**

```
<?xml version="1.0" encoding="UTF-8" ?>

<wicket:extend xmlns:wicket="http://wicket.apache.org">

    <wicket:panel wicket:id="panel1" />

    <wicket:fragment wicket:id="fragment1">
    </wicket:fragment>

</wicket:extend> 
```

**ChildPanel.java**

```
public class ChildPanel extends Panel  
{
    public ChildPanel(String id, IModel<?> model) 
    {
         super(id, model);
         add(new Fragment("panel1", "fragment1", this); 
    }
} 
```

问题存在于 Wicket *Markup.java*类中：

```
public final IMarkupFragment find(final String id)
{
    Args.notEmpty(id, "id");

    MarkupStream stream = new MarkupStream(this);
    stream.setCurrentIndex(0);
    while (stream.hasMore())
    {
        MarkupElement elem = stream.get();
        if (elem instanceof ComponentTag)
        {
            ComponentTag tag = stream.getTag();
            if (tag.isOpen() || tag.isOpenClose())
            {
                if (tag.getId().equals(id))
                {
                    return stream.getMarkupFragment();
                }
                if (tag.isOpen() && !tag.hasNoCloseTag() && !(tag instanceof WicketTag) &&
                    !"head".equals(tag.getName()) && !tag.isAutoComponentTag())
                {
                    stream.skipToMatchingCloseTag(tag);
                }
            }
        }

        stream.next();
    }

    return null;
} 
```

当应用程序遍历流时，它会在**BasePanel 标记**中查找。在查看打开标记后`<div wicket:id="dialog">`，它会迭代到结束标记`</div>`，因此它没有查看**ChildPanel 标记**内部。

您有什么建议或解决方案吗？

谢谢，曼努埃尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T15:33:39.470

有一个与此主题相关的未解决的 jira 问题。您可以按照说明在这里解决它：[https](https://issues.apache.org/jira/browse/WICKET-4545) ://issues.apache.org/jira/browse/WICKET-4545 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T03:17:44.710

您可以声明一个`<wicket:fragment>`inside `<wicket:extend>`，但不能声明一个`<wicket:panel>`(panel1)。尝试`<wicket:container>`改用。

# c# - MailItem.Reply() 不内联回复

> ID：15467960
> 
> 赞同：0
> 
> 时间：2013-03-18T00:19:58.967
> 
> 标签：c#, outlook

我希望能够在我的程序中内联回复电子邮件，但调用回复功能似乎只为我填写收件人：和主题：字段。我似乎无法在网上找到任何关于它的信息，而且它似乎没有打开内联回复的过载。

我发现每个 MailItem 都有一个对话，所以我想知道是否必须手动进行内联回复？（我真的很想避免这种情况，重复对话会很痛苦，我们中的一些人可能有数百封电子邮件）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T02:04:35.297

我发现这段代码有助于实现这一点；

```
Document oldDoc = itemToReplyTo.GetInspector.WordEditor;
Document newDoc = newMailItem.GetInspector.WordEditor;

if (oldDoc != null)
{
    Microsoft.Office.Interop.Word.Selection oldSelect = oldDoc.Windows[1].Selection;
    Microsoft.Office.Interop.Word.Selection newSelect = newDoc.Windows[1].Selection;

    oldSelect.Find.Execute("From:");
    oldSelect.Collapse(WdCollapseDirection.wdCollapseStart);
    oldSelect.MoveEnd(WdUnits.wdStory, 1);
    oldSelect.Copy();

    newSelect.Move(WdUnits.wdStory, 1);
    newSelect.InlineShapes.AddHorizontalLineStandard();
    newSelect.Paste();
    newSelect.Move(WdUnits.wdStory, -1);
    newSelect.InsertAfter("Reply Text here");
    newSelect.Find.ClearFormatting();
    newSelect.Find.Execute(mailItem.SenderEmailAddress);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-23T22:26:31.007

我尝试了以下方法，它使用 Outlook 2010 对我有用。

```
 Outlook.MailItem reply1 = mailItem.Reply();                           
                        //prepend text to email
                        reply1.HTMLBody = "<html><body><strong>Test Body</strong><p><p></body></html>" + reply1.HTMLBody;
                        reply1.Display(false); //display message or .Send() to send 
```

# c# - EF NotSupportedException - 从 LINQ2SQL 转换

> ID：15467961
> 
> 赞同：0
> 
> 时间：2013-03-18T00:20:27.187
> 
> 标签：c#, entity-framework, exception, linq-to-sql

我正在从`LINQ2SQL`EF 过渡，并且在使用一些基本的 lambda 表达式时遇到了一些问题。

在下面的示例中，我试图检索客户端相关数据的基本列表。此语句在使用`LINQ2SQL`数据上下文运行时可以正常工作。

```
var data = db.Clients.Select(c => c.Id + ":" + c.Firstname);
foreach (var item in data)
{

} 
```

当我针对 EF 数据上下文执行它时，我得到：

```
 NotSupportedException - Unable to cast the type 'System.Int32' to type 'System.Object'. LINQ to Entities only supports casting EDM primitive or enumeration types. 
```

`NB`: Id 字段是一个整数。

我已经能够通过`ToArray()`在 db.Clients 之后添加一个来修复错误。

有人可以解释一下如果..

a) 我需要对解决方案中的每个预先存在的语句进行这种代码更改，以使其与 EF 一起使用；和

b) 为什么 EF 在`LINQ2SQL`正常的情况下在基本串联方面会遇到这么多麻烦？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T00:50:50.640

我不能告诉你为什么它在 Linq2SQL 中而不是在实体框架中工作，但我可以帮助你解决你的问题。

我建议你使用该[`SqlFunctions.StringConvert`](http://msdn.microsoft.com/en-us/library/dd466166.aspx)功能。

```
var data = db.Clients.Select(c => 
    SqlFunctions.StringConvert((double)c.Id) + ":" + c.Firstname); 
```

就个人而言，如果我必须进行任何字符串操作，我会尝试仅将其放在我的客户端代码中，如下所示：

```
var data = db.Clients.Select(c => { c.Id, c.Firstname });
foreach (var item in data)
{
    var stringData = String.Format("{0}:{1}", item.Id, item.Firstname);
    ...
} 
```

# java - android加速度计检测跳跃？

> ID：15467964
> 
> 赞同：2
> 
> 时间：2013-03-18T00:21:15.173
> 
> 标签：java, android

你好！

我刚刚开始进行 Android 开发，我想知道 Android 手机中是否有任何内置机器能够检测一个人是否蹲着（如果一个人手里拿着手机并保持手稳定，那么手机将其高度更改大约 1 m) 或跳跃。在这两种情况下，用户都将手机握在手中。如果有，应该研究什么样的包来使用那些内置的检测器？

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T01:23:22.197

在这两种情况下，您都需要使用内置的加速度计。但是，蹲下很难可靠地检测到。跳跃可能很容易。例如，在跳跃时，会出现一个明显大于重力的向上加速度，然后是自由落体，然后是另一个向上的向上加速度。（降落）。

# session - CakePHP - 尝试添加到模型的选项数组时从会话变量中获取 NULL

> ID：15467966
> 
> 赞同：0
> 
> 时间：2013-03-18T00:21:19.970
> 
> 标签：session, cakephp

我正在使用 cakephp 2.3.0。我在手册中搜索了很长时间并搜索了互联网，但我没有找到答案。这是我的高级场景：

** 基本上，我只是想向选项数组添加一个变量和一个值，这样当 cakephp 构建 SQL 插入到语句时，它就有这个必需的列和值。**

*   用户使用用户名和密码登录网页
*   在控制器中，我使用模型来查询我的用户表以获取用户的 id #
*   我将 ID # 放入会话变量中
*   接下来，用户登录，然后填写网络表单并提交
*   在我的控制器中，我尝试将存储在会话变量中的 id 的值添加到模型的选项数组中（这是我的麻烦所在）......请参阅下面的详细信息

在我的用户控制器中，我有这个代码片段：

```
public function login() {
        if ($this->request->is('post')) {
            if ($this->Auth->login()) {                    
                $condition = array("User.username" => $this->request->data['User']['username']);
                $this->Session->write('userId', $this->User->find('first', 
                            array (
                            'conditions' => array ($condition),
                            'fields' => array ('User.id'))));                   
                $this->redirect($this->Auth->redirect());                   
            } else {
                $this->Session->setFlash(__('Invalid username or password, try again'));
            }
        }
    } 
```

在我的活动控制器中，我有这个：

```
class ActivitiesController extends AppController {

    var $components = array('Session');

    public function createActivity() {
        if ($this->request->is('post')) {
              $this->Activity->create();
             $user = $this->Session->read('userId');
            //debug($user);
            debug($user['User']['id']);
            $ownerID = ($user['User']['id']);
            $this->Activity->set(array('owner_id' => $ownerID));
            if ($this->Activity->save($this->request->data)) {
                $this->Session->setFlash(__('The user has been saved'));
                $this->redirect(array('action' => 'home'));
            } else {
                $this->Session->setFlash(__('The user could not be saved. Please, try again.'));
            }
        } 
```

我的调试将打印一个值 5，这是我希望看到的。但是，我得到的是一个数据库错误，它在网页上输出 SQL INSERT INTO 代码，它告诉我我的 owner_id 不能为 NULL。这是正确的，因为这就是我在数据库表中设置它的方式。

因此，当尝试将会话变量中的 ID 值放入我的选项数组时，我得到了一个 NULL。我仍然认为自己更像是 cakephp 的初学者。任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T08:44:43.070

您正在尝试做框架已经做的事情。

登录功能不需要更多：

```
public function login() {
    if ($this->request->is('post')) {
        if($this->Auth->login()){
            $this->Session->setFlash('Your logged in now.');
            $this->redirect( array('controller' => 'activities', 'action' => 'createActivity'));
        }
        else{
            $this->Session->setFlash('Username or password is incorrect', 'default', array(), 'auth');
        }
    }
} 
```

在你的活动控制器中

```
public function createActivity() {
    if ($this->request->is('post')) {
        $this->request->data['Activity']['user_id'] = $this->Auth->user('id');
        $this->Activity->create();
        if ($this->Activity->save($this->request->data)) {
            $this->Session->setFlash(__('The user has been saved'));
            $this->redirect(array('action' => 'home'));
        } else {
            $this->Session->setFlash(__('The user could not be saved. Please, try again.'));
        }
    } 
```

AppController 应该包含

```
App::uses('Controller', 'Controller');

class AppController extends Controller {

    public $components = array(
        'Auth',
        'Session',
    );

} 
```

也建议遵循 Cake 的约定，如果你将 Activity 链接到 User，则将外键名称设置为 user_id 而不是 owner_id [模型关联](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-18T00:53:36.017

不要使用 $_SESSION 来存储用户信息。Auth 组件已经在处理所有事情。您可以通过调用来获取控制器中的用户 ID，`$this->Auth->user('id');`我认为使用该变量可能会解决您的问题。

在此处查看 API 文档：http: [//api.cakephp.org/2.3/class-AuthComponent.html#method-AuthComponentuser](http://api.cakephp.org/2.3/class-AuthComponent.html#method-AuthComponentuser)

# django - 我是否需要在命令 [django] 中关闭数据库连接

> ID：15467969
> 
> 赞同：1
> 
> 时间：2013-03-18T00:21:37.697
> 
> 标签：django, django-commands

根据这个（[http://djangosnippets.org/snippets/926/](http://djangosnippets.org/snippets/926/)）片段，连接在句柄中关闭。但这是一种旧代码。

在 django 1.4 中，我们必须关闭连接吗？我查看了 django 代码，但找不到关闭连接的代码。

如果 django 关闭连接，它在哪里？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T02:46:36.010

正如片段所述：

```
# Close the DB connection. This is required as a workaround for an
# edge case in MySQL: if the same connection is used to
# create tables, load data, and query, the query can return
# incorrect results. 
```

来自 Django：

```
So, yes, if you do something to deliberately create lots of connections, 
lot of connections will be created. However, Django closes its connection to the 
database at the end of each request/response cycle, so there is only one connection 
in operation per thread or process handling requests and responses. If you're not 
using the HTTP layer, it's still only one connection per thread of execution and 
you are in complete control of the number of threads you create. 
```

[https://code.djangoproject.com/ticket/9878](https://code.djangoproject.com/ticket/9878)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T01:03:35.373

首先是免责声明：我不是专家（远非如此）。

无论如何，您引用的代码片段指的是两张票：[Django](https://code.djangoproject.com/ticket/7572)票建议关闭连接已包含在用于加载固定装置的代码中（请参阅*django/core/management/commands/loaddata.py*中的第 55-60 行）。[MySQL](http://bugs.mysql.com/bug.php?id=37735)票表明他们方面没有太大变化。

无论如何，我认为这取决于你想要做什么。最重要的是，“连接关闭”修复似乎是 MySQL 唯一的事情。如果您使用任何其他数据库，则不应出现代码段中的注释建议的错误。

# java - Websphere 自定义错误页面不起作用

> ID：15467970
> 
> 赞同：4
> 
> 时间：2013-03-18T00:21:40.860
> 
> 标签：java, struts2, struts, websphere, custom-error-pages

我一直在努力获取诸如 404（找不到文件）之类的错误的 Websphere 自定义错误页面。

我在 /WEB-INF/ 下的 web.xml 中添加了以下内容

```
<error-page>

    <error-code>404</error-code>
    <location>/html/error404/error404.html</location>

</error-page> 
```

并且还创建了一个正确的路径 /html/error404 并添加了 error404.html 并在用户请求不存在的文件时显示警告消息。

我还重新启动了我的 WAS 和浏览器，但我仍然收到默认错误消息：

```
Error 404: SRVE0190E: File not found: /xyz.htm 
```

而不是我的自定义 html 错误页面。

我在这里想念什么？

谁能帮帮我，谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T07:14:58.497

您可能正在修改 installedApps 目录中的 web.xml 文件，而您应该修改了 config 目录中的文件。

例如，对于 IBMUTC 应用程序，web.xml 位于：

```
c:\WAS\config\cells\f11Node01Cell\applications\IBMUTC.ear\deployments\IBMUTC\UTC.war\WEB-INF 
```

请谨慎使用，因为在 ND 环境中，当重新同步配置时，节点上的修改可能会丢失。在这种情况下，修改 DMgr 本身的配置，然后强制重新同步。这会将配置更改推送到节点。

在所有情况下，请记住在某个时候重建 EAR 并重新部署。

# python - Django WSGI 多线程和连接问题

> ID：15467977
> 
> 赞同：3
> 
> 时间：2013-03-18T00:22:13.183
> 
> 标签：python, django, apache, wsgi

我已按照 Graham 的说明使用 mod_wsgi 将 Apache 与 Django 集成：[http](http://blog.dscpl.com.au/2010/03/improved-wsgi-script-for-use-with.html) ://blog.dscpl.com.au/2010/03/improved-wsgi-script-for-use-with.html ，但仍然遇到连接问题和响应时间。由于它是随机发生的，并且 Apache 日志文件中没有任何错误，因此很难理解发生了什么。

我的 Apache 是用 pre-fork 构建的，配置如下：

```
<IfModule prefork.c>
StartServers       8
MinSpareServers    5
MaxSpareServers   20
ServerLimit      256
MaxClients       256
MaxRequestsPerChild 0
</IfModule> 
```

WSGI 相关配置：

```
LogLevel info
LoadModule wsgi_module modules/mod_wsgi.so
WSGISocketPrefix run/wsgix
WSGIDaemonProcess somename user=apache group=apache threads=25 processes=1
WSGIScriptAlias / /wsgi-dir/script.wsgi
WSGIImportScript /wsgi-dir/script.wsgi process-group=somename application-group=%{GLOBAL}

<Directory /wsgi-dir/script.wsgi>
   Order deny,allow
   Allow from all
   WSGIProcessGroup  somename
</Directory> 
```

在请求处理器中，我使用以下内容来监视活动线程：

```
logger.info("Active threads: {0}".format(threading.active_count())) 
```

我注意到尽管我在配置中最多有 25 个线程，但活动线程数永远不会大于 4，同时一些客户端可以等待新连接超过 1 分钟，而请求处理时间约为 2 秒。

如果一个请求到达服务器，它会被快速处理，但在某些情况下（大约每 100 个请求中有 1 个）客户端只是等待连接，并且由于 Apache 的限制有时甚至会超时：

```
Timeout 60 
```

我认为，这种行为在网络应用程序世界中很容易被忽视，其中 100 个请求中的 1 个不起重要作用（用户只需重新加载页面），但在服务世界中，这确实是一个问题。

我无法理解这一点——如果所有线程都忙于为其他客户端服务，为什么 Django 不产生另一个线程？如果不是关于线程，那么它可能是什么？格雷厄姆写的应用程序重新加载问题？

这是我的版本：

```
python26-2.6.8-3.30.amzn1.x86_64
Django-1.4.3
mod_wsgi-3.2-1.6.amzn1.x86_64
Server version: Apache/2.2.23 (Unix)
Server loaded:  APR 1.4.6, APR-Util 1.4.1
Compiled using: APR 1.4.6, APR-Util 1.4.1
Architecture:   64-bit
Server MPM:     Prefork
  threaded:     no
    forked:     yes (variable process count) 
```

================== 实施格雷厄姆建议的第一次更新 ========================= ======

格雷厄姆等人，

感谢您的意见和建议。我检查了 mod_wsgi 版本，它是 3.2（见上文）。我的 WSGI 配置现在如下所示：

```
LogLevel info
LoadModule wsgi_module modules/mod_wsgi.so
WSGISocketPrefix run/wsgix
WSGIDaemonProcess somename user=apache group=apache threads=25
WSGIScriptAlias /  /wsgi-dir/script.wsgi process-group=somename application-group=%{GLOBAL}

<Directory /wsgi-dir>
   Order deny,allow
   Allow from all
</Directory> 
```

启动 50 个 EC2 客户端，每个客户端在启动时间向服务发送几条消息就足够了，一个客户端的延迟为 49 秒，而所有其他客户端的平均响应为 2.2 秒，最多为7 秒。

我检查了应用程序日志文件，发现“收到的请求”和“发出的响应”之间的增量延迟请求为 0.16 秒，而从客户的角度来看，延迟为 49 秒。

它给我们留下了两种可能性：

1.  客户端在将近 49 秒内无法建立连接
2.  建立了连接，但服务器（实际上是 Django/WSGI 内部）无法快速读取请求。

很难说是 #1 还是 #2，因为我在客户端使用 Python 的“请求”模块来连接服务。我认为它是 #2，因为如果延迟稍微高于 64-65 秒，Apache 发送/接收超时就会启动，我可以在 Apache 的日志文件中看到它。

以下是我将尝试做的进一步澄清它：

1.  创建一个简单的控制器，如下所示：

    def 侦听器（请求）：

    ```
    logger.info("Started, active threads: {0}".format(threading.active_count()))    
    time.sleep(3)
    logger.info("Finished, active threads: {0}".format(threading.active_count()))    
    return HttpResponse('OK') 
    ```

注意：记录器也会记录时间。

1.  创建一个简单的统计接口（我不想分析所有客户端 EC2 上的日志）：

    定义日志（请求）：

    ```
    id = request.REQUEST['id']
    time = request.REQUEST['time']
    res = request.REQUEST['res']

    if (id and time):
        logger.info("STAT Instance: {0}, Processing time: {1}, Response: {2}".format(id,time,res))

    return HttpResponse('OK') 
    ```

客户将像这样工作：

1.  向“侦听器”URL 发送几个请求并计算客户端的处理时间
2.  将处理时间与 EC2 实例 ID 一起发送到“日志”URL

    如果我能够用这种简单的方法重现问题，它将变得可重现，我希望 Django 团队能够从那里解决问题。

任何其他建议也表示赞赏。非常感谢所有回答的人。

================== 建议测试的第二次更新 =========================== =====

我已经实现了建议的侦听器，并且可以重现该问题，并希望其他人也能这样做——您只需要一个 AWS 账户就可以启动大量 EC2 客户端——通常 50 个就足够了，但有时我需要到 100 才能看到延迟。

有趣的是，在这个测试中，活动线程的数量从 1 逐渐增加到 8，可能是因为服务器上的平均处理时间增加了，所以它确实有效，但仍然不足以防止延迟。

我将客户的脚本放入 EC2 的用户数据中，如下所示。如果您需要有关如何与所有这些客户一起创建 auto-sclaing 组的快速说明，请告诉我。

```
#!/bin/bash

do_send() {

        d1=`date +%s`
        res=`python ~ec2-user/client/fetch.py ${URL_ROOT}/init/`
        res=`echo $res | tr '\n' ' ' | tr ' ' +`
        d2=`date +%s`
        delta=`expr $d2 - $d1`
        echo $ami $ins $res $delta >>$LOG
        curl -s  "${URL_ROOT}/stat/?id=$ami&time=$delta&res=$ins:$res" >/dev/null 2>&1
}

URL_ROOT=<SERVICE-ROOT_URL>
LOG=~ec2-user/log.txt

ins=`curl -s http://169.254.169.254/latest/meta-data/instance-id 2>/dev/null`
ami=`curl -s http://169.254.169.254/latest/meta-data/ami-id 2>/dev/null`
echo "Instance=[$ins]" >$LOG

# First request
do_send

# Second request
do_send 
```

fetch.py​​ 客户端如下所示：

```
@author: ogryb
'''
import requests
import datetime
import socket

from optparse import OptionParser
usage = "usage: %prog [options] init_url\n   init_url - http://<host>/init/ server's address"
parser = OptionParser(usage=usage)
parser.add_option("-i", "--id", dest="id",
                  help="instance ID", metavar="STRING")
parser.add_option("-p", "--phost", dest="phost",
                  help="public hostname", metavar="STRING")
parser.add_option("-l", "--lhost", dest="lhost",
                  help="local hostname", metavar="STRING")
parser.add_option("-t", "--type", dest="type",
                  help="instance type", metavar="STRING")
parser.add_option("-q", "--quiet",
                  action="store_true", dest="quiet", default=False,
                  help="Quiet mode")
(opt, args) = parser.parse_args()
ip = socket.gethostbyname(socket.gethostname())
if (not opt.quiet):
    print ("=== Getting metadata:\t{0} {1}".format(datetime.datetime.utcnow(), ip))
if not opt.id:
    r = requests.get(url='http://169.254.169.254/latest/meta-data/instance-id')
    opt.id = r.text
if not opt.phost:
    r = requests.get(url='http://169.254.169.254/latest/meta-data/public-hostname')
    opt.phost = r.text
if not opt.lhost:
    r = requests.get(url='http://169.254.169.254/latest/meta-data/local-hostname')
    opt.lhost = r.text
if not opt.type:
    r = requests.get(url='http://169.254.169.254/latest/meta-data/instance-type')
    opt.type = r.text
body = "id={0}&phost={1}&lhost={2}&type={3}".format(opt.id, opt.phost, opt.lhost, opt.type)
if (not opt.quiet):
    print ("=== Start sending:\t{0} {1} {2}".format(datetime.datetime.utcnow(), ip, opt.id))
r = requests.post(url=args[0], data=body, verify=False)
if (not opt.quiet):
    print ("=== End sending:\t{0} {1} {2}".format(datetime.datetime.utcnow(), ip, opt.id))
print r.text
if (not opt.quiet):
    print "Request Body={0} url={1}".format(body,args[0])
    print "Response: {0}\n{1}".format(r.status_code, r.text) 
```

============ 03/19/13 - 23:45 来自错误日志的附加信息 ===

我已将 Apache 日志级别更改为调试，并在 Apache error_log 中找到以下内容。请让我知道这是否可能是延误的原因以及对此可以采取的措施。我在某处读到“KeyError”是无害的，但你永远不知道。

一位客户在 6:37:28 延迟了 41 秒。错误日志最接近的事件发生在 @ 06:37:15：

```
Wed Mar 20 06:37:15 2013] [info] mod_wsgi (pid=27005): Initializing Python.
[Wed Mar 20 06:37:15 2013] [info] mod_wsgi (pid=27005): Attach interpreter ' 
```

完整的错误日志如下：

```
Wed Mar 20 06:29:45 2013] [info] Server built: Oct 21 2012 20:35:32
[Wed Mar 20 06:29:45 2013] [debug] prefork.c(1023): AcceptMutex: sysvsem (default: sysvsem)
[Wed Mar 20 06:29:45 2013] [info] mod_wsgi (pid=26891): Attach interpreter ''.
[Wed Mar 20 06:29:45 2013] [info] mod_wsgi (pid=26892): Attach interpreter ''.
[Wed Mar 20 06:29:45 2013] [info] mod_wsgi (pid=26893): Attach interpreter ''.
[Wed Mar 20 06:29:45 2013] [info] mod_wsgi (pid=26895): Attach interpreter ''.
[Wed Mar 20 06:29:45 2013] [info] mod_wsgi (pid=26894): Attach interpreter ''.
[Wed Mar 20 06:37:15 2013] [debug] proxy_util.c(1820): proxy: grabbed scoreboard slot 0 in child 27005 for worker proxy:reverse
[Wed Mar 20 06:37:15 2013] [debug] proxy_util.c(1839): proxy: worker proxy:reverse already initialized
[Wed Mar 20 06:37:15 2013] [debug] proxy_util.c(1936): proxy: initialized single connection worker 0 in child 27005 for (*)
[Wed Mar 20 06:37:15 2013] [info] mod_wsgi (pid=27005): Initializing Python.
[Wed Mar 20 06:37:15 2013] [info] mod_wsgi (pid=27005): Attach interpreter ''.
[Wed Mar 20 06:38:10 2013] [debug] proxy_util.c(1820): proxy: grabbed scoreboard slot 0 in child 27006 for worker proxy:reverse
[Wed Mar 20 06:38:10 2013] [debug] proxy_util.c(1839): proxy: worker proxy:reverse already initialized
[Wed Mar 20 06:38:10 2013] [debug] proxy_util.c(1936): proxy: initialized single connection worker 0 in child 27006 for (*)
[Wed Mar 20 06:38:10 2013] [info] mod_wsgi (pid=27006): Initializing Python.
[Wed Mar 20 06:38:10 2013] [info] mod_wsgi (pid=27006): Attach interpreter ''.
[Wed Mar 20 06:38:11 2013] [info] mod_wsgi (pid=26874): Destroying interpreters.
[Wed Mar 20 06:38:11 2013] [info] mod_wsgi (pid=26874): Cleanup interpreter ''.
[Wed Mar 20 06:38:11 2013] [info] mod_wsgi (pid=26874): Terminating Python.
[Wed Mar 20 06:38:11 2013] [error] Exception KeyError: KeyError(140627014572000,) in <module 'threading' from '/usr/lib64/python2.6/threading.pyc'> ignored
[Wed Mar 20 06:38:11 2013] [info] mod_wsgi (pid=26874): Python has shutdown.
[Wed Mar 20 06:38:44 2013] [debug] proxy_util.c(1820): proxy: grabbed scoreboard slot 0 in child 27007 for worker proxy:reverse
[Wed Mar 20 06:38:44 2013] [debug] proxy_util.c(1839): proxy: worker proxy:reverse already initialized
[Wed Mar 20 06:38:44 2013] [debug] proxy_util.c(1936): proxy: initialized single connection worker 0 in child 27007 for (*)
[Wed Mar 20 06:38:44 2013] [info] mod_wsgi (pid=27007): Initializing Python.
[Wed Mar 20 06:38:44 2013] [info] mod_wsgi (pid=27007): Attach interpreter ''.
[Wed Mar 20 06:38:45 2013] [info] mod_wsgi (pid=26880): Destroying interpreters.
[Wed Mar 20 06:38:45 2013] [info] mod_wsgi (pid=26880): Cleanup interpreter ''.
[Wed Mar 20 06:38:45 2013] [info] mod_wsgi (pid=26880): Terminating Python.
[Wed Mar 20 06:38:45 2013] [error] Exception KeyError: KeyError(140627014572000,) in <module 'threading' from '/usr/lib64/python2.6/threading.pyc'> ignored
[Wed Mar 20 06:38:45 2013] [info] mod_wsgi (pid=26880): Python has shutdown. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T05:30:34.403

配置：

```
<Directory /wsgi-dir/script.wsgi>
   Order deny,allow
   Allow from all
   WSGIProcessGroup  somename
</Directory> 
```

应该：

```
<Directory /wsgi-dir>
   Order deny,allow
   Allow from all
   WSGIProcessGroup  somename
   WSGIApplicationGroup %{GLOBAL}
</Directory> 
```

作为一个开始。

处理请求时，具有您所拥有的 WSGI 应用程序将以嵌入式模式而不是守护程序模式运行。那是因为 Directory 指令的路径是错误的，而不是应有的目录。您不能像以前那样使用文件路径。您应该使用以下方法验证它的运行位置：

*   [http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Embedded_Or_Daemon_Mode](http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Embedded_Or_Daemon_Mode)

同时，您将在守护进程模式进程中加载​​一个冗余副本，而这些副本从未被 WSGIImportScript 使用过。

即使在修复了指令路径之后，预加载也在不同的子解释器中处理请求。您需要上面给出的 WSGIApplicationGroup 以确保它们在同一个子解释器（应用程序组）中。

如果使用 mod_wsgi 3.0+，你最好删除 WSGIImportScript 指令，而是使用：

```
WSGIScriptAlias / /wsgi-dir/script.wsgi process-group=somename application-group=%{GLOBAL}

<Directory /wsgi-dir>
   Order deny,allow
   Allow from all
</Directory> 
```

使用 WSGIScriptAlias 同时指定进程组和应用程序组，无需单独的 WSGIProcessGroup 和 WSGIApplicationGroup。指定两者还具有预加载脚本的副作用，从而替换了 WSGIImportScript 正在执行的操作，因此可以删除 WSGIImportScript 的原因。

至于为什么请求需要这么长时间的性能问题，您可以安装并尝试 New Relic 来挖掘问题所在。

对于一般的 Apache 配置，还建议您阅读我刚刚做的 PyCon US talk 中的幻灯片：

*   [http://www.slideshare.net/GrahamDumpleton/pycon-us-2013-making-apache-suck-less-for-hosting-python-web-applications](http://www.slideshare.net/GrahamDumpleton/pycon-us-2013-making-apache-suck-less-for-hosting-python-web-applications)

视频应该在本周末发布。

我去年的 PyCon 演讲也应该很有趣。

*   [http://lanyrd.com/2012/pycon/spcdg/](http://lanyrd.com/2012/pycon/spcdg/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-07T03:29:34.893

很抱歉回答迟了，也没有提供太多细节，但这不是 Django 或 Apache 的问题。这是它运行的环境的问题。我确切地知道“环境”出了什么问题，但由于 NDA 不能透露更多细节。我希望你明白我所说的“环境”是什么意思。

另一个提示：当我在原始帖子中假设它是＃2时，我错了 - 它实际上是＃1。

我认为知道这不是 Django 或 Apache 问题对于仍在研究此问题的每个人来说都是一个巨大的帮助。我不在乎这个答案会得到多少反对或赞成，只是想提供帮助，因为我知道研究所有这些需要多少时间。

谢谢。

# actionscript-3 - 新实例未重置其计时器和子代

> ID：15467983
> 
> 赞同：0
> 
> 时间：2013-03-18T00:22:51.807
> 
> 标签：actionscript-3, flash, oop, instance, main

*（我在 AS3 和 Adob​​e AIR for iOS SDK 中工作）。*

该程序有两个类：第一个是`Program.as`FLA 文件链接到的类。其中`Program.as`有一个启动程序的功能和另一个重新启动程序的功能。第二个类是我的`Main.as`类，它调用`finishNow();`函数`Program.as`来重新启动程序。

它在第一次运行时运行良好。问题是，几乎只要它重新启动，它似乎就会自行重新启动。它也给出了相当多的`ArgumentError: Error #2025: The supplied DisplayObject must be a child of the caller.`错误。我还注意到，当程序重新启动时，某些功能（例如 TIMERS）不会再次从 0 开始？？我真的很难过，因为逻辑似乎没问题，但痕迹却不然。

将跟踪放在里面`Program.as`表明该`finishNow();`函数在第一次运行后被重复调用。问题在于`programRestartTimer`没有在新实例上重置。通过暂时调用`stop();`函数来解决这个问题。`programRestartTimer`从`Error #2025`不断显示的情况来看，我怀疑在第一次运行中未删除的显示子项（或类似的 - 例如其他计时器也未重置）会导致此问题。这表明程序没有创建一个全新的实例，或者 AS3 不可能？

程序.as：

```
package  {

    import flash.display.MovieClip;

    public class Program extends MovieClip {

        var runMain:Main;

        public function Program() {
            startNow();
        }

        function startNow() {
            runMain = new Main(this);
            addChild(runMain);
        }

        function finishNow() {
            removeChild(runMain);
            runMain = new Main(this);
            addChild(runMain);
        }
    }
} 
```

主要作为：

```
package {

    import flash.display.Sprite;

    public class Main extends Sprite
    {
        public var program:Program;
        var programRestartTimer:Timer = new Timer(8 * 1000);

        public function Main(stageHolderTemp) {
            program = stageHolderTemp;
            trace(program);

            someFunctionsThatDrawGraphics();
            moreFunctions();
        }

        function callFinishFunction():void { // this is called at the end of the animation
            programRestartTimer.start();
            programRestartTimer.addEventListener(TimerEvent.TIMER, restartProgram);
        }

        function restartProgram(e:TimerEvent):void {
            programRestartTimer.stop(); // this line is a temporary "fix" to stop the program from constantly restarting
            // it doesn't actually fix the full problem
            program.finishNow();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T04:14:17.450

在 AS3 中确实可以设计一个类，以便它能够重新初始化自己。但这需要仔细设计重启程序。

首先，您的`callProgramRestart()`函数向 Program 实例添加了一个侦听器，但它从未被删除，这将导致您的程序在第二次调用后重置两次，这很可能是您的删除子错误的原因 - 您在一次删除它们两次排。`flash.utils.setTimeout()`您可以通过使用（[手册](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/utils/package.html#setTimeout%28%29)）并将其定位为调用`restartProgram`函数来完全消除该侦听器的需要。

```
function callFinishFunction():void { // this is called at the end of the animation
    flash.utils.setTimeout(restartProgram,8000);
}
function restartProgram():void {...} 
```

其次，您应该在某处进行“完全”重新初始化。您创建另一个`Main`类实例的方法很可能会起作用，但是在调用它之前，您应该`Main`正确清除您的侦听器之前的实例。

# android - mediaelement.js - android 默认浏览器和 dolphin 浏览器加载 mp3 问题

> ID：15467992
> 
> 赞同：1
> 
> 时间：2013-03-18T00:24:07.837
> 
> 标签：android, browser, load, mediaelement.js, dolphin-browser

再会，

我目前正在为自己建立一个网站（我是一名作曲家/制作人），并且我正在将 Media Element 用于主演示页面。该页面正在建设中，链接如下：

[http://www.vincentrubinetti.com/listen.html](http://www.vincentrubinetti.com/listen.html)

[http://www.vincentrubinetti.com/listen.js](http://www.vincentrubinetti.com/listen.js)

以下是我认为的相关功能和代码：

```
function initPlayer()
{
    player = new MediaElementPlayer('#listen_player',{
        success: function (mediaElement, domObject) 
        { 
            mediaElement.addEventListener('play', resumeSong, false);
            mediaElement.addEventListener('ended', playNextSong, false);
            mediaElement.addEventListener('pause', pauseSong, false);
        }
    });

    [omitted]
}

function setSong(element)
{
    if (element != "")
    {
        unselectAllSongs();
        document.getElementById(element).className = "listen_song_highlight";

        [omitted]

        var newSrc = document.querySelector("#"+element+" .listen_song_source").title;
        player.pause();
        player.setSrc(newSrc);
        player.load();
    }
}

function playSong(element)
{
    document.querySelector("#"+element+" .listen_song_status").innerHTML = "playing";
    player.play();
}

function playNextSong()
{
    var newSong = document.querySelector(".listen_song_highlight + div.listen_song");
    if (autoplay && newSong != null)
    {
        setSong(newSong.id);
        playSong(newSong.id);
    }
    else
    {
        document.querySelector(".listen_song_highlight .listen_song_status").innerHTML = "stopped";
    }
} 
```

这一切的 CSS 结束似乎都很好。它找到列表中的下一首歌曲并设置新的来源；我已经通过警报和其他调试验证了它是否正确执行此操作。但是在Android默认浏览器和Dolphin浏览器上，有时似乎无法加载mp3，过早触发“end”事件去下一首歌曲。结果是在播放完一首歌曲后似乎跳过了 2-3 首歌曲。甚至要让它播放一个，单击歌曲 div 和播放器播放按钮也需要一些技巧。我可以输入与 html 相同的 url，浏览器会很好地播放/下载它，访问或加载它没有问题。

以下是在播放列表中重复播放的 3 个 mp3 文件，以供参考。它们是我的，但它们是真实音乐的占位符。

```
NEW/music/creation.mp3
NEW/music/startup.mp3
NEW/music/win.mp3 
```

请注意，所有这些都可以在 Chrome、Firefox、IE8+ 和 Android Chrome 上正常运行（我还没有测试过 iPhone 或 iPad）。

我的诊断正确吗？谁能指出我正确的方向？是否有任何 MediaElement 在 Android 默认浏览器和 Dolphin 浏览器上无法正常工作的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-24T15:43:49.853

我在android中有同样的问题（但有视频......）

有人告诉我这是文件没有及时下载的问题——即浏览器开始下载，但由于文件没有下载，它的长度为 0:00，因此触发了结束事件。

如果有办法使视频/音频可以更快地下载，它可以解决问题。

奇怪的是，如果设备有良好的 WiFi，那么这个问题基本上就消失了。

看看 John Dyer 在这里怎么说：

[https://github.com/johndyer/mediaelement/issues/543](https://github.com/johndyer/mediaelement/issues/543)

# ruby-on-rails - link_to text - 对 html 文本使用 ruby 代码

> ID：15467995
> 
> 赞同：0
> 
> 时间：2013-03-18T00:24:22.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我希望我的视图上的链接文本显示为医院，国家。Country 是一个guidelines 属性，所以我需要能够从'hospital' 访问guidelines.country 并显示它

例如 Get Well 医院、Sickland

我不确定如何正确编码。目前在我的视图文件中，我有

```
<% @list.each do |hospital| %>

        <tr class="tablerow">
            <td><%= link_to (hospital, country), :action => :topichospital, :hospital => hospital, :country=>country %></td>
        </tr> 
```

当我刚有的时候它工作了，但我不知道如何添加国家

```
 <% @list.each do |hospital| %>

            <tr class="tablerow">
                <td><%= link_to hospital, :action => :topichospital, :hospital => hospital %></td>
            </tr> 
```

我在guidelines_controller.rb 中的listhospital 行动是

```
def listhospital
    @list = Guideline.order(:hospital).uniq.pluck(:hospital)
    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @guidelines }
    end
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T00:34:45.187

将您的 link_to 更改为

```
<%= link_to "#{hospital}, #{country}", { :action => :topichospital, :hospital => hospital, :country=>country } %> 
```

这会将传递的第一个参数转换为字符串。我不确定rails`(hospital, country)`在作为第一个参数传递时如何解释link_to，但这将确保`to_s`为每个参数调用方法。

更新：IIRC，您可以`pluck`用来组合属性

```
# postgre
@list = Guideline.order(:hospital).uniq.pluck("hospital || ', ' || country")

# mysql
@list = Guideline.order(:hospital).uniq.pluck("CONCAT(hospital, ', ', country)") 
```

然后你可以`link_to hospital`在视图中使用。

更新：这变得有点像黑客了。我建议您将控制器更改为

```
@list = Guideline.select('hospital, country').order(:hospital).uniq 
```

那么在你看来

```
<% @list.each do |guideline| %>
  <tr class="tablerow">
    <td><%= link_to "#{guideline.hospital}, #{guideline.country}", { :action => :topichospital, :hospital => guideline.hospital, :country => guideline.country }%></td>
  </tr>
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T00:34:41.230

我想你正在寻找：

```
<%= link_to "#{hospital}, #{country}", :action => :topichospital, :hospital => hospital, :country=>country %> 
```

您还可以将块传递给`link_to`：

```
<%= link_to :action => :topichospital, :hospital => hospital, :country=>country do %>
  <%= hospital %>, <%= country %>
<% end %> 
```

[http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-link_to)

# c - 如何处理像这些寄存器这样的结构中的所有字段？

> ID：15467997
> 
> 赞同：0
> 
> 时间：2013-03-18T00:24:39.587
> 
> 标签：c, struct, microcontroller, pic, mplab

如果您对微控制器进行了编程，您可能熟悉操作给定寄存器的选择位，或将一个字节写入整个事物。例如，在使用 C 的 PIC 上，我可以将整个字节写入 PORTA 以设置所有位，或者我可以简单地寻址 PORTAbits.RA# 以设置单个位。我试图模仿这些结构/联合的定义方式，这样我就可以对程序中的变量做同样的事情。具体来说，当微控制器打开时，我希望能够重置我自己定义的寄存器，例如

```
REGISTER = 0; 
```

相对

```
REGISTERbits.BIT0 = 0;
REGISTERbits.BIT1 = 0; 
...
//or
REGISTERbits = (0,0,0,0,0,0,0,0); 
```

等等

显然前者更加优雅，节省了大量的行空间。微控制器的头文件是这样的：

```
#ifndef __18F2550_H
#define __18F2550_H
....

extern volatile near unsigned char       LATA;
extern volatile near struct {
  unsigned LATA0:1;
  unsigned LATA1:1;
  unsigned LATA2:1;
  unsigned LATA3:1;
  unsigned LATA4:1;
  unsigned LATA5:1;
  unsigned LATA6:1;
} LATAbits; 
```

...对于每个寄存器，并且具有多个字节的寄存器使用结构的联合作为其寄存器位。由于我的初始化/声明位于主源文件而不是标题中，因此我已将 extern 删除并靠近我的：

```
volatile unsigned char InReg;
volatile struct{
    unsigned NSENS:1;   //One magnetic sensor per direction
    unsigned SSENS:1;
    unsigned ESENS:1;
    unsigned WSENS:1;
    unsigned YBTN:1;    //One crosswalk button input per axis
    unsigned XBTN:1;    //(4 buttons tied together each)
    unsigned :2;
} InRegbits; 
```

...但是在编译时，InReg 和 InRegbits 被定义为内存中的两个独立位置，这意味着我无法写入 InReg 来更改 InRegbits。如何更改它以使其正常工作？我要复制的那个是不是因为它是一个特殊的微控制器寄存器才起作用？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-18T00:33:54.890

```
volatile union InReg {
    unsigned char InRegAll;
    struct near {
        unsigned NSENS:1;   //One magnetic sensor per direction
        unsigned SSENS:1;
        unsigned ESENS:1;
        unsigned WSENS:1;
        unsigned YBTN:1;    //One crosswalk button input per axis
        unsigned XBTN:1;    //(4 buttons tied together each)
        unsigned :2;
    } InRegbits;
} 
```

请注意，此代码可能不可移植。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-18T01:03:57.017

为了保证相同的结果，您需要在一个联合中拥有两个结构。该标准规定，如果联合的成员是结构，其中第一个结构成员类型是兼容的（并且与相同的位宽相关），您可以对它们中的任何一个进行相同的操作。否则，通过另一个访问任何联合成员是未定义的行为。

例如

```
volatile union {
    volatile struct {
        unsigned int InReg;
    } InReg;
    volatile struct {
        unsigned NSENS:1;       //One magnetic sensor per direction
        unsigned SSENS:1;
        unsigned ESENS:1;
        unsigned WSENS:1;
        unsigned YBTN:1;        //One crosswalk button input per axis
        unsigned XBTN:1;        //(4 buttons tied together each)
        unsigned:2;
    } InRegbits;
} Reg_s; 
```