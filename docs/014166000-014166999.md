# StackOverflow 问答 14166000-14166999

# javascript - 是否检查 js 变量是否为 d3 选择？

> ID：14166000
> 
> 赞同：6
> 
> 时间：2013-01-04T22:24:41.940
> 
> 标签：javascript, d3.js

我有一些变量进入我的函数。

如果其中第一个是 d3 选择，我想使用它，否则我想使用默认选择。

如何检查变量是否为 d3 选择？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-04T22:52:36.870

检查变量`sel`是否为 d3.selection：

```
var isselection = sel instanceof d3.selection; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-29T20:49:31.017

请注意，`(sel instanceof d3.selection)`文档中提供的上面引用的答案：[https](https://github.com/mbostock/d3/wiki/Selections#d3_selection) ://github.com/mbostock/d3/wiki/Selections#d3_selection在 IE9 中不起作用。

这在这里解释：[https ://github.com/mbostock/d3/issues/851](https://github.com/mbostock/d3/issues/851)

这是 IE9 的问题，不会在 D3 中修复。可以在此提交中找到解决方法：[https ://github.com/palantir/plottable/pull/637](https://github.com/palantir/plottable/pull/637)

改为使用 `(typeof sel[0] !== "string")`。这不是很清楚，但这取决于您是否需要支持 IE9。

# llvm - llvm::DIInstruction getFilename 返回带有目录的文件名，我只想要文件名

> ID：14166004
> 
> 赞同：4
> 
> 时间：2013-01-04T22:25:02.217
> 
> 标签：llvm, clang

我正在尝试使用 DILocation 类从 llvm 指令中获取调试元数据。

但是，当我在 DILocation 中查询指令来自的文件名时，我会得到一个文件名，其中的目录标记在前面。

我虽然它只会返回文件，并且应该通过调用 getDirectory() 来检索整个目录路径。

例如，我最终得到 pbg/XMain_0.c 而不是 XMain_0.c

我像这样编译了我的位码：

```
XMain_0.o: pbg/XMain_0.c
    $(CC) <snip> -c pbg/XMain_0.c 
```

我在源文件中传递了一个目录这一事实是否意味着元数据将源文件名保存为输入？

这是一个精简的例子：

```
 const llvm::Instruction* inst  //passed in
  MDNode *n = inst->getMetadata("dbg");
  DILocation loc(n);  

  file = loc.getFilename().str(); // =>  pbg/XMain_0.c
  dir = loc.getDirectory().str(); // => /projects/pbg/pbg-m/DIR 
```

我可以打电话来“规范化”这些数据还是我需要手动完成？

如果重要的话，Clang 3.1。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T13:36:56.920

我认为这取决于编译器的调用。如果你运行：

```
clang -c somedir/somefile.c 
```

然后完整的`somedir/somefile.c`将是文件名。

您的调用看起来如何？

* * *

没有什么奇怪的。调试器将查找相对于某个项目根目录的源文件，如果您像这样编译文件，这就是找到它们的方式。gcc 做同样的事情：

```
/tmp$ pwd
/tmp
/tmp$ cat subdir/test.c 
int foo() {
  return 42;
}

/tmp$ gcc -g -O0 -c subdir/test.c -o test.o
/tmp$ readelf --debug-dump=info test.o | grep -A4 compile_unit
 <0><b>: Abbrev Number: 1 (DW_TAG_compile_unit)
    <c>   DW_AT_producer    : (indirect string, offset: 0x0): GNU C 4.6.3   
    <10>   DW_AT_language    : 1    (ANSI C)
    <11>   DW_AT_name        : (indirect string, offset: 0xc): subdir/test.c    
    <15>   DW_AT_comp_dir    : (indirect string, offset: 0x1a): /tmp 
```

# ios - 父视图控制器如何通知其子视图控制器已自行删除？

> ID：14166006
> 
> 赞同：17
> 
> 时间：2013-01-04T22:25:10.710
> 
> 标签：ios, uiviewcontroller

子视图控制器在子视图控制器的实现中被以下代码删除：

```
- (void)commandFinishVC
{
    [ self.view removeFromSuperview];
    [ self removeFromParentViewController ];
} 
```

子视图控制器及其视图已成功删除，但是如何通知父级呢？-viewDidDisappear 未被调用并且 -viewDidUnload 已被弃用。

从我可以找到的示例中，始终假定父视图控制器是指定要删除的子项的事件的发起者，但是（对我而言）子项在其完成逻辑中应该是自主的。

是否应该通过使用 self.parentViewController 属性并在父视图控制器中使用类似以下内容来调用删除方法？

```
- (void)commandFinishVC
{
    [ childVC.view removeFromSuperview];
    [ childVC removeFromParentViewController ];
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-04T23:07:48.423

是的，您的父控制器通常应该控制子控制器的添加和删除，因此您的第二种方法似乎更适用。请参阅*UIViewController 类参考的*[实现容器视图控制器](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW81)部分。

 *我怀疑您可以摆脱以前的方法，即孩子正在移除自己，但苹果在他们的文档中是一致的，并且关于[实现 UIViewController](https://developer.apple.com/videos/wwdc/2011/?id=102)包含的 WWDC 2011 会议说容器控制器承担管理孩子的责任。

因此，在回答您关于孩子如何通知父母它已被移除的问题时，没有既定的协议。但这并不奇怪，因为假定父母将启动此过程。如果孩子需要启动这个过程，文档建议父母应该有一个公共 API 来管理子控制器。

因此，虽然没有孩子通知父母的协议，但是有一个已发布的 API，父母控制器通过该 API 通知孩子他们已被移动/移除。具体来说，当父控制器移除子控制器时，它应该调用[`willMoveToParentViewController`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/willMoveToParentViewController%3a). [该文档](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/willMoveToParentViewController%3a)明确指出我们必须执行此通知：

> 如果你正在实现自己的容器视图控制器，它必须在调用方法`willMoveToParentViewController:`之前调用子视图控制器的`removeFromParentViewController`方法......

因此，正如*View Controller Programming Guide的*[添加和删除子](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW13)部分中所讨论的，在删除子时，我们应该：

 *```
[childVC willMoveToParentViewController:nil];
[childVC.view removeFromSuperview];
[childVC removeFromParentViewController]; 
```

毫不奇怪，文档[`didMoveToParentViewController`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/didMoveToParentViewController%3a)同样明确：添加子控制器时，必须`didMoveToParentViewController`在动画/过渡（如果有）完成时调用。我不知道如果我们不调用这两种通知方法会发生什么，但 Apple 表示我们必须这样做，因此这样做似乎是谨慎的。**

# asp.net-mvc - 保护 ViewModel 中的对象

> ID：14166007
> 
> 赞同：0
> 
> 时间：2013-01-04T22:25:18.997
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我正在尝试从数据库中获取模型中对象的安全设置。我想根据登录用户的安全设置启用/禁用/隐藏渲染视图上的控件。

这是我到目前为止所得到的：

```
public class RestrictedObjectsViewModel
{
    [SecureObject(ObjectId = 1)]
    [Display(Name = "Name")]
    public string Name { get; set; }

    [SecureObject(ObjectId = 2)]
    [Display(Name = "Address")]
    public string Address { get; set; }

    [SecureObject(ObjectId = 3)]
    [Display(Name = "Phone Number")]
    public string PhoneNumber { get; set; }
} 
```

使用这种方法，我将在数据库中查询每个正在渲染的对象。是否可以对模型中的整个对象只查询一次数据库以获得对象的权限列表？我该如何设置？

更新：

好的，让我详细介绍一下。

在我的代码中，当我将以下属性设置为一个对象时，我已经编写了我的 HTML 来隐藏渲染对象的关联表格行：

```
[SecureObject(IsInvisible = true)] 
```

上面的代码在我的测试中正常工作。但是，当我尝试执行以下操作时：

```
public class RestrictedObjectsViewModel
{
    [SecureObject(IsInvisible = ObjectId3Invisible)]
    [Display(Name = "Phone Number")]
    public string PhoneNumber { get; set; }

    public RestrictedObjectsViewModel(bool setPermissions = false)
    {
        if (setPermissions)
        {
            ObjectId3Invisible = true;
        }
    }
    public bool ObjectId3Invisible = false;
} 
```

我收到一条错误消息，提示“非静态字段、方法或属性‘MyProject.Models.RestrictedObjectsViewModel.ObjectId3Invisible’需要对象引用”

这是控制器：

```
public ActionResult RestrictedObjects()
{
    return View(new Models.RestrictedObjectsViewModel(true));
} 
```

如果我将其更改`ObjectId3Invisible`为静态，我将无法在运行时将值更改为 true 或 false。

有什么建议么？

# c++ - 游戏的 C++ 输入验证

> ID：14166016
> 
> 赞同：1
> 
> 时间：2013-01-04T22:26:09.320
> 
> 标签：c++, validation

我正在努力让输入验证适用于我的游戏。

```
#include <iostream>
#include <ctime>
using namespace std;

int main()
{

    int iGumballs;
    int iUserguess;
    int iGuesses = 0;

    while (true)
    {
        system("CLS");
        cin.clear();
        iGuesses = 0;

    srand(static_cast<unsigned int>(time(0)));
    iGumballs = rand()%1000+1;
    cout << "How many gumballs are in the bumball jar? You guess! 1-1000" << endl;

    do
    {
        cout << "Enter your guess: ";

    cin >> iUserguess;

    if(iUserguess > iGumballs)
    {
        cout << "Too high!" << endl << endl;
    }

    if(iUserguess < iGumballs)
    {
        cout << "Too low!" << endl << endl;
    }
    iGuesses ++;
    }
    while(iUserguess > iGumballs || iUserguess < iGumballs);
    cout << "You guessed the right amout of gumballs" << endl << endl;
    cout << "You took " << iGuesses << " guesses" << endl << endl;
    system ("pause");
    }
    return 0;
} 
```

我基本上希望程序显示

```
Your Guess: Sorry, incorrect input - try again 
```

当用户输入小于 1 且大于 1000 的数字时，以及确保输入数字而不是字母或符号的某种验证。我尝试了 cin.fail() 但我无法让它完全正常工作。

谢谢，约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:44:23.530

您将需要一些测试来查看是否是数字，试试这个：

```
#include <iostream>
#include <string>
#include <ctime>
#include <boost/lexical_cast.hpp> //dependency that can be optional
using namespace std;

bool is_number(const std::string& s)
{
    std::string::const_iterator it = s.begin();
    while (it != s.end() && std::isdigit(*it)) ++it;
    return !s.empty() && it == s.end();
}

int main()
{

    int iGumballs;
    std::string iUserguessStr;
    int iUserguess;
    int iGuesses = 0;

    while (true)
    {
        system("CLS");
        cin.clear();
        iGuesses = 0;

    srand(static_cast<unsigned int>(time(0)));
    iGumballs = rand()%1000+1;
    cout << "How many gumballs are in the bumball jar? You guess! 1-1000" << endl;

    do
    {
        cout << "Enter your guess: ";

    cin >> iUserguessStr;
    if(is_number(iUserguessStr))
        iUserguess = boost::lexical_cast<int>(iUserguessStr); //you can make your own or maybe use lexical cast to transform a string into integer
    else
        continue; //put some fancy message here warning the user

    if(iUserguess > iGumballs)
    {
        cout << "Too high!" << endl << endl;
    }

    if(iUserguess < iGumballs)
    {
        cout << "Too low!" << endl << endl;
    }
    iGuesses ++;
    }
    while(iUserguess > iGumballs || iUserguess < iGumballs);
    cout << "You guessed the right amout of gumballs" << endl << endl;
    cout << "You took " << iGuesses << " guesses" << endl << endl;
    system ("pause");
    }
    return 0;
} 
```

我的回答是基于一个相关问题：[How to determine if a string is a number with C++?](https://stackoverflow.com/questions/4654636)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T23:03:39.453

Yo 可用于`if(cin)`检查输入流的状态，并且由于 operator>> 将返回传递给它的输入流，因此您可以使用`if(cin>>iUserguess)`

如果 cin 处于失败状态 - 可能是因为用户输入了非数字 - 表达式`if(cin>>iUserguess)`将评估为 false。

如果用户输入非数字，您需要调用`cin.clear()`以清除流状态并`cin.ignore()`丢弃输入，然后再尝试再次读取数字。

因此，使用您的示例，可以将其更改为：

```
#include <iostream>
#include <ctime>
#include <limits>
using namespace std;

int main()
{

    int iGumballs;
    int iUserguess;
    int iGuesses = 0;

    while (true)
    {
        system("CLS");

        iGuesses = 0;

        srand(static_cast<unsigned int>(time(0)));
        iGumballs = rand()%1000+1;
        cout << "How many gumballs are in the bumball jar? You guess! 1-1000" << endl;

        do
        {
            cout << "Enter your guess: ";
            if(cin >> iUserguess)
            {
                iGuesses ++;
                if(iUserguess > iGumballs)
                {
                    cout << "Too high!" << endl << endl;
                    continue;
                }

                if(iUserguess < iGumballs)
                {
                    cout << "Too low!" << endl << endl;
                    continue;
                }
            }
            else
            {
                cout<<"incorrect input - try again\n\n";
                cin.clear();
                cin.ignore(numeric_limits<streamsize>::max(),'\n');
                continue;
            }
        }
        while(iUserguess > iGumballs || iUserguess < iGumballs);
        cout << "You guessed the right amout of gumballs" << endl << endl;
        cout << "You took " << iGuesses << " guesses" << endl << endl;
        system ("pause");
    }
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T23:10:59.703

要验证字符，您可以使用[try-catch](http://msdn.microsoft.com/en-us/library/6dekhbbc%28v=vs.80%29.aspx)结构。

-首先读入一个字符串并尝试[对其进行类型转换](http://www.cprogramming.com/tutorial/lesson11.html)并使用try-catch处理错误。
- 然后使用条件来确保输入在范围内。
- 如果输入无效，您可以编写一条错误消息以显示。

# objective-c - iOS将图像拉伸到全屏

> ID：14166019
> 
> 赞同：0
> 
> 时间：2013-01-04T22:26:57.460
> 
> 标签：objective-c, ios, uiscrollview, uiimageview, uiimage

我有一个滚动视图，里面有一个图像视图。我想知道是否有可能让图像视图中的图像比屏幕的分辨率小得多，并且能够以某种方式拉伸它以适应屏幕。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:43:11.767

设置`contentMode`并`UIImageView`更改其大小。

```
[UIImageView setContentMode:UIViewContentModeScaleToFill]; 
```

查看文档以获取有关 UIViewContentMode 的更多信息：

[http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW69](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW69)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:35:31.580

当然，只需更改 imageView 的边界。

我在这里错过了什么吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T01:49:45.773

您的 UIImageView 在我理解的 UIScrollView 内？

这将通过调整滚动视图和适当地调整图像视图来工作。但是，不建议这样做。你会迷失在带有恼人影响的小错误中。

我建议添加一个可以匹配屏幕边界的额外 UIView。将该视图添加到底层“视图”对象并使用 bringSubviewToFront 方法。

您也可以确保这个新的 UIView 是最底层视图对象的第一个子视图。您可以通过操作子视图数组结构来实现这一点 - 我一般不建议您完全了解视图层次结构的所有内容。您也可以通过在添加任何其他视图之前先添加其他视图来实现这一点。（在 IB 中，只需确保新视图位于树中的最顶层，紧邻视图控制器“视图”。）然后将其隐藏，直到您真正需要它为止。然后你取消隐藏它。当不再需要它时，再次隐藏它，既不将其删除，也不将其从其超级视图中删除。

# intuit-partner-platform - QBO 查询和 SpecifyOperatorOption

> ID：14166026
> 
> 赞同：0
> 
> 时间：2013-01-04T22:28:11.720
> 
> 标签：intuit-partner-platform, quickbooks-online

我正在尝试向 QBO 查询帐户等实体，并且遇到了几个问题。我正在使用 .Net Dev Kit v 2.1.10.0（我使用 NuGet 更新到最新版本）并且当我使用以下技术时：

```
Intuit.Ipp.Data.Qbo.AccountQuery cquery = new Intuit.Ipp.Data.Qbo.AccountQuery();
IEnumerable<Intuit.Ipp.Data.Qbo.Account> qboAccounts =     cquery.ExecuteQuery<Intuit.Ipp.Data.Qbo.Account>(context); 
```

（即只需创建一个适当类型的新 AccountQuery 并调用 ExecuteQuery）我得到一个错误。似乎请求 XML 没有正确创建，我只在 XML 文件中看到了一行。然后我查看了在线文档并尝试在那里模拟代码：

```
 Intuit.Ipp.Data.Qbo.AccountQuery cquery = new Intuit.Ipp.Data.Qbo.AccountQuery();
        cquery.CreateTime = DateTime.Now.Date.AddDays(-20);

        cquery.SpecifyOperatorOption(Intuit.Ipp.Data.Qbo.FilterProperty.CreateTime,
        Intuit.Ipp.Data.Qbo.FilterOperatorType.AFTER);

        cquery.CreateTime = DateTime.Now.Date;
        cquery.SpecifyOperatorOption(Intuit.Ipp.Data.Qbo.FilterProperty.CreateTime,
        Intuit.Ipp.Data.Qbo.FilterOperatorType.BEFORE);
        // Specify a Request validator
        Intuit.Ipp.Data.Qbo.AccountQuery cquery = new Intuit.Ipp.Data.Qbo.AccountQuery();
        IEnumerable<Intuit.Ipp.Data.Qbo.Account> qboAccounts = cquery.ExecuteQuery<Intuit.Ipp.Data.Qbo.Account>(context); 
```

不幸的是，VS 2010 坚持认为 AccountQuery 不包含 SpecifyOperatorOption 的定义，并且没有该名称的扩展方法。所以我被困住了。

任何如何解决此问题的想法将不胜感激。

# javascript - 在 ExtJS 中的被调用类中引用调用者类

> ID：14166036
> 
> 赞同：0
> 
> 时间：2013-01-04T22:28:47.210
> 
> 标签：javascript, extjs

我是 ExtJS 的新手，遇到以下问题：我有一个类 LoginWindow，它实现了一个 FormPanel：

```
Ext.define('WebDesktop.LoginWindow', {
  extend: 'Ext.window.Window',

  title: Translator.get("login_window:Anmeldung"),
  layout: 'fit',
  closable: false,
  resizable: false,

  constructor: function() {
    this.callParent();
  },

  initComponent: function () {
    var me = this;

    me.loginPanel = new WebDesktop.LoginPanel(me);

    me.items = [
        me.loginPanel
    ],

    me.callParent();
  },
});

Ext.define('WebDesktop.LoginPanel', {
  extend: 'Ext.form.Panel',

  header: false,
  bodyPadding: 5,
  reset: true,

  waitMsgTarget: true,
  url: Routing.generate('_route_core_login'),

  items: [{
    xtype: 'textfield',
    fieldLabel: Translator.get("login_window:Benutzername"),
    name: '_username',
    width: 300,
  },
  {
    xtype: 'textfield',
    fieldLabel: Translator.get("login_window:Passwort"),
    name: '_password',
    inputType: 'password',
    width: 300,
  }],

  buttons: [{
    text: Translator.get("login_window:Anmelden"),
    handler:  function() {

        var form = this.up('form').getForm();

        if (form.isValid()) {
            // Submit the Ajax request and handle the response
            form.submit({
                success: /* Call a function that is defined in main application class */,
                failure: function(form, action) {

                    Ext.Msg.show({
                        title: Translator.get("login_window:Benutzeranmeldung"), 
                        msg: action.result ? action.result.message : 'No response',
                        buttons: Ext.Msg.OK,
                        icon: Ext.Msg.ERROR
                    });

                    form.reset();
                }
            });
        }
    }
  }],
}); 
```

现在，在我的主应用程序类中，我创建了一个 LoginWindow 实例并将其显示给用户。在这个主类中还定义了一个函数，当登录窗口的表单成功提交时应该调用它。但我不知道如何引用该函数。我试图将调用者类的引用传递给被调用类并将其保存在那里，但这不起作用。如您所见，我没有使用 MVC 架构，我知道这不是最佳实践......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:41:06.517

```
me.loginPanel = new WebDesktop.LoginPanel();
me.loginPanel.referenceToParentWindow = me; 
```

这是你想要的？我很迷茫。

# c# - 字节数组到字符串 - 更好的方法

> ID：14166037
> 
> 赞同：3
> 
> 时间：2013-01-04T22:28:49.100
> 
> 标签：c#

> **可能重复：**
> [字节 [] 到 c# 中的字符串](https://stackoverflow.com/questions/1003275/byte-to-string-in-c-sharp)

我有一个从流中读取的字节数组。我想将其转换为字符串。

这对我有用：

```
var str= new string(bytearr.Select(x=>(char)x).ToArray()); 
```

但我觉得有更好的方法吗？有没有？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-04T22:30:31.253

```
Encoding.UTF8.GetString(bytearr); 
```

您需要知道正确的编码并使用它，UTF8 只是一个示例。根据对你有用的东西，我猜你要么有 UTF8 要么 ASCII。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T22:32:28.023

您可以使用以下内置函数`Encoding`：

```
string myString = Encoding.UTF8.GetString(bytearr); 
```

[http://msdn.microsoft.com/en-us/library/aa332098(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/aa332098(v=vs.71).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T22:31:09.857

```
var str = System.Text.Encoding.UTF8.GetString(byte[]) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T22:31:57.430

你可以用`System.Text.Encoding`

```
string result = Encoding.UTF8.GetString(bytearr); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T23:02:44.477

您应该使用 Encoding 的实例

来自 msdn

```
public UTF8Encoding(
    bool encoderShouldEmitUTF8Identifier,
    bool throwOnInvalidBytes
) 
```

参数

编码器ShouldEmitUTF8标识符

类型：System.Boolean true 指定提供 Unicode 字节顺序标记；否则为假。

throwOnInvalidBytes

类型：System.Boolean

true 指定在检测到无效编码时抛出异常；否则为假。

所以使用

```
 var encoding = new UTF8Encoding(false,true);

encoding.GetString (byteArr); 
```

# javascript - 使用网络移动框架？

> ID：14166038
> 
> 赞同：8
> 
> 时间：2013-01-04T22:28:50.957
> 
> 标签：javascript, cordova, jquery-mobile, sencha-touch, titanium

我目前正在一个新的项目上实现移动应用程序。客户还没有决定，我必须提出几个解决方案。需要与 Android（2.2+ 版）的兼容性，iOS 和其他操作系统可能会很好。我们只能为 Android 开发，但我想使用 Web 移动框架。

由于我从未使用过它们，我开始寻找现有的解决方案。我听说过PhoneGap、Titanium、Sencha Touch 和jQuery Mobile。

这是我发现的可能性：

*   PhoneGap + Sencha Touch
*   PhoneGap + jQuery Mobile（或同等产品）
*   Sencha Touch (API + UI)
*   钛

该应用程序的关键点是允许用户拍照并对其进行编辑：调整大小、添加一些文本……在 Android 上，这在技术上是可行的，但我不知道使用 Web 移动框架。

以 PhoneGap 和 jQuery Mobile 为例，有可能做到吗？我找到了每个功能的部分代码，但没有很完整，并且不确定它是否能在很多手机上兼容。对于开发时间，也许做 2 个原生应用程序而不是尝试使用移动框架（并用 Javascript 开发图片版）更好？

我在每个框架上发现了很多意见，但其中一些已经发布了一年多，而且它们的发展如此之难，以至于对所有解决方案都有清晰的认识。

所以我想知道我是否可以用这些解决方案之一来实现这个图片版本，哪个可能是最好的。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-01-04T23:15:35.693

## 介绍

从技术上讲，它可以使用你所有的可能性来完成，我会按照难度从低到难排列它们，我会更多的可能性。此外，我为我的博客写了更广泛的**[文章](http://www.gajotres.net/top-7-mobile-application-html5-frameworks/)**。

## PhoneGap/Cordova + jQuery Mobile（低难度）

Phonegap 是您需要的，jQuery Mobile 仅用于 UI。这种组合仍然很容易一起实现，并且有很多工作示例。Phonegap 充当 HTML5/JS/CSS 的包装器，它可以让您访问手机功能专家。Phonegap 将用于拍照，jQM 将用于修改。

[**这是**](http://www.gajotres.net/building-a-native-mobile-app-with-phonegap-and-jquery-mobile-1-4/)一个相当新的PhoneGap + jQuery Mobile 教程。如果您想查看该文章的 MACOS 版本，请查看**[此处](http://www.gajotres.net/creating-phonegap-project-on-macos/)**。

如果您想找到有关 jQuery 和 jQuery Mobile 之间差异的良好信息来源，请查看**[这里。](http://www.gajotres.net/document-onpageinit-vs-document-ready/)**

## PhoneGap/Cordova + Sencha Touch（中/难）

与 jQM 不同，Sencha Touch 学习起来有点困难（或者更难，取决于您的 javascript 知识），尤其是如果您没有良好的 javascript 背景知识或没有 Sencha Touch 设计器工具的许可证。只有当你有足够的时间来学习新东西时，才走这条路。Sencha Touch 版本 2 有自己的应用程序包装器，因此不再需要 Phonegap。

如果您想了解更多信息，请查看这篇讨论 jQuery Mobile 和 Sencha Touch 之间区别的**[文章。](http://www.gajotres.net/sencha-touch-vs-jquery-mobile/)**

## 钛加速器（中等难度）

与前两个选项不同，Titanium 的工作方式略有不同。jQM 和 Sencha 用于创建混合移动应用程序，Titanium appcelerator 用于从 javascript 代码创建本机应用程序。掌握起来并不难，说实话js代码很简单。虽然快速的开发工具将更难正确设置您的原生应用程序的样式（从头开始构建原生应用程序时更容易处理）。

## Inter App Framework / ex jqMoby (低难度)

这个框架几乎和 jQuery Mobile 一样古老，现在它归英特尔所有。与 Sencha Touch 一样，该框架的主要目标是开发混合移动应用程序，并且效果很好。它针对 Android 和 iOS 进行了优化，因此期望比 jQuery Mobile 更快的执行速度，就像 Sencha Touch 一样，这个框架有自己的原生应用程序包装器。当然，这个框架很少有不好的方面，比如糟糕的文档（至少在撰写本文时）。如果您想了解有关此框架的更多信息，请查看此**[文章](http://www.gajotres.net/switching-from-a-jquery-mobile-to-appframework/)**。

## 剑道用户界面（低难度）

jQuery Mobile 的绝佳替代品。以任何方式更好，更快。只有一个问题，它是一种商业产品。这将花费你 200 美元。

**[在这里](http://www.gajotres.net/html5-frameworks-kendo-ui-from-a-jquery-mobile-perspective/)**找到更多信息。

## PhoneJS（低难度）

jQuery Mobile 和 Kendo UI 的另一个出色替代品。比 jQuery Mobile 快得多，与 Kendo UI 处于同一级别。它有一个很棒的文档，是我迄今为止最好的文档之一。

**[在这里](http://www.gajotres.net/in-depth-review-of-phonejs-html5-javascript-framework/)**找到更多信息。

**[在这里](http://www.gajotres.net/html5-frameworks-kendo-ui-from-a-jquery-mobile-perspective/)**阅读它。

## 荣誉奖

去罗莫比尔。类似于 Phonegap/Cordova 但较少使用。

从开发时间的角度来看，创建混合应用程序比创建原生应用程序更快。在您的情况下，如果您有 Java/Objective C 知识，请坚持使用本机应用程序。无论您花费多少时间进入混合应用程序，它都会足够好或足够快。

## 编辑 ：

这是一个 Phonegap + jQuery Mobile 的例子：[http](http://therockncoder.blogspot.com/2012/07/jquery-mobile-phonegap-and-camera.html) ://therockncoder.blogspot.com/2012/07/jquery-mobile-phonegap-and-camera.html ，在那里你会找到一个用于 Android 和 iOS 实现的 github 链接。

如果您从未使用过 jQuery，请坚持使用**Dawson Toth** Titanium 示例。但如果可能的话，坚持使用 jQuery Mobile。

## 更新 1

您可能还对开源[PropertyCross](http://propertycross.com/)项目感兴趣，该项目演示了使用一系列跨平台框架（包括 Sencha、jQM 和 PhoneGap）实现的相同应用程序。

## 更新 2

过去几周我一直在审查其他 HTML5 移动框架。我的评论可以在**[这里](http://www.gajotres.net/top-7-mobile-application-html5-frameworks/)**和**[这里](http://www.gajotres.net/top-7-notable-less-known-mobile-html5-frameworks/)**找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-05T03:51:53.327

是的，您可以在 Titanium 中执行此操作。下面是一个简单的实现，在 5 分钟内起草和测试。

为了让您了解它的外观，请参阅以下内容。然后看看 Pedro Enrique 的 TiDraggable，如果你想增强它以让用户在文本或图像之间相互拖动：[https ://github.com/pec1985/TiDraggable](https://github.com/pec1985/TiDraggable)

```
// This app consists of two visual parts: a canvas where the user does stuff,
// and a save button in the bottom right.
var win = Ti.UI.createWindow({
    backgroundColor: 'black'
});

// First, the canvas.
var canvas = Ti.UI.createView({
    bottom: 50,
    backgroundColor: 'white'
});
// It has a scroll view so the user can...
var scroll = Ti.UI.createScrollView({
    // ... zoom content in or out.
    maxZoomScale: 2, minZoomScale: 0.1,
    // .. and freely position the image.
    contentWidth: 1000, contentHeight: 1000
});
// Add the image to the middle of the scroll view.
scroll.add(Ti.UI.createImageView({
    image: 'http://appc.me/Content/kitten.jpg',
    width: 750, height: 426,
    hires: true
}));
canvas.add(scroll);
// Add some text.
canvas.add(Ti.UI.createLabel({
    text: 'Kittens are the best.', textAlign: 'center',
    font: { fontSize: 28 },
    color: '#000',
    bottom: 20
}));
// Add the canvas to the win.
win.add(canvas);

// Second, create the "save" button.
var save = Ti.UI.createButton({
    title: 'Save to Gallery',
    height: 30, width: Ti.UI.SIZE,
    bottom: 10, right: 10
});
save.addEventListener('click', function (evt) {
    // Turn our "canvas" view (and its children) in to an image,
    // and save it to the gallery.
    Ti.Media.saveToPhotoGallery(canvas.toImage(), {
        success: function () {
            alert('Saved!');
        },
        error: function () {
            alert('Oh no...');
        }
    });
});
// Add it to the win.
win.add(save);

win.open(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-12T09:56:57.747

请参阅对 5 个最佳移动 Web 应用程序框架的深入审查和比较：

*   [煎茶触摸](http://moduscreate.com/5-best-mobile-web-app-frameworks-sencha-touch/)
*   [jQuery Mobile + 骨干网](http://moduscreate.com/5-best-mobile-web-app-frameworks-jquery-mobile-backbone-part4/)
*   [剑道UI移动](http://moduscreate.com/5-best-mobile-web-app-frameworks-kendo-ui-part2/)
*   [AngularJS + 离子](http://moduscreate.com/5-best-mobile-web-app-frameworks-ionic-angulalrjs/)
*   [反应](http://moduscreate.com/5-best-mobile-web-app-frameworks-reactjs/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-19T20:52:50.340

忽略 JQM，它给您的应用程序增加了太多开销。我会推荐[Ionic](http://ionicframework.com/)。PhoneGap/Cordova + Angularjs（可选）+ Ionic 会让你走得很远。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-03-21T07:09:13.607

我会说去**离子**- [http://ionicframework.com](http://ionicframework.com)

Ionic 提供了一个针对移动设备优化的 HTML、CSS 和 JS CSS 组件、手势和工具的库，用于构建高度交互的应用程序。使用 Sass 构建并针对 AngularJS 进行了优化。

它是一个专注于性能且专注于本机的框架，具有强大的 CLI。

它允许您开发

1.  iOS
2.  安卓
3.  Windows Phone/通用
4.  移动网络

# java - java eclipse：加载nxt usb comm驱动程序失败

> ID：14166040
> 
> 赞同：1
> 
> 时间：2013-01-04T22:28:52.463
> 
> 标签：java, nxt

我有 java eclipse indigo 的问题，用于 nxt 砖的插件 lejos。问题是我已经安装了需要对其进行编程的漏洞软件/驱动程序。

操作系统：windows 7

* * *

但控制台说：

```
Linking ...
Program has been linked successfully
Uploading ...
leJOS NXJ> Error: Failed to load USB comms driver.
leJOS NXJ> Caused by lejos.pc.comm.NXTCommException: Cannot load NXTComm driver
leJOS NXJ>  at lejos.pc.comm.NXTCommFactory.newNXTCommInstance(NXTCommFactory.java:110)
leJOS NXJ> Caused by lejos.internal.jni.JNIException: library jfantom.dll was not       found in C:\Program Files (x86)\leJOS NXJ\lib\pc\native, architecture    windows/x86_64
leJOS NXJ>  at lejos.internal.jni.JNILoader.loadLibrary(JNILoader.java:127)
Native Library intelbth_x64 not available
Native Library bluecove_x64 not available
leJOS NXJ> Error: Exception connecting to NXT.
leJOS NXJ> Caused by lejos.pc.comm.NXTCommException: Open of NXT_PETER failed.
leJOS NXJ>  at lejos.pc.comm.NXTCommBluecove.open(NXTCommBluecove.java:136)
leJOS NXJ> Caused by javax.bluetooth.BluetoothStateException: BlueCove libraries not available
leJOS NXJ>  at com.intel.bluetooth.BlueCoveImpl.createDetectorOnWindows(BlueCoveImpl.java:896)
leJOS NXJ> Failed to connect to any NXT
No NXT found - is it switched on and plugged in (for USB)?
uploading the program failed with exit status 1 
```

* * *

LeJOS_HOME 已配置，jfantom.dll 位于文件夹中......并且在设备管理器中是声明的机器人。

请帮我！谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T12:03:02.703

您应该使用所有 32 位软件。

由于lego只支持32bit的usb驱动，所以当你使用64bit的eclipse时，它找不到写版驱动上传程序到你的NXT。

32bit的所有软件包括32bit jdk和32bit eclipse。

# silverlight - 使用 WCF RIA 和 WF4 处理批量数据时出现 OutOfMemoryException

> ID：14166041
> 
> 赞同：0
> 
> 时间：2013-01-04T22:28:53.260
> 
> 标签：silverlight, workflow-foundation-4, wcf-ria-services, silverlight-5.0

我有一个现有的 Silverlight 5 应用程序。我正在向其中添加一个页面，以允许用户处理对第三方数据库系统中数据的大量更新。该应用程序当前使用 WCF RIA 服务通过 SOAP 与第 3 方系统进行通信。更新的功能包含在我创建的 Workflow 4 应用程序中，并作为 SL 应用程序服务器端的程序集引用。最后，该应用程序现在托管在我在 Windows 7 上运行的本地 IIS 7.5 实例中；我也在用 IIS 调试，而不是 VS 开发服务器。

在基础层面，应用程序的功能如下：

*   选择文本文件
*   点击“开始”按钮
*   事件处理程序创建一个用户定义类型的实例，用于跟踪批次
*   事件处理程序创建一个新`BackgroundWorker`实例并为`DoWork`、`ProgressChanged`和`RunWorkerCompleted`事件连接处理程序
*   事件处理程序调用`RunWorkerAsync()`

这是事件处理程序的简短代码`DoWork`，因为这是完成大部分工作的地方。

```
private void BwOnDoWork(object sender, DoWorkEventArgs doWorkEventArgs, BatchContainerControl batchProcess)
{
   var worker = sender as BackgroundWorker;
   // Iterate through each record of data file and call the 'UpdateAddress' function
   // of the AddressDomainService which, in turn, executes the Workflow
   foreach (var item in batchProcess.FileData)
   {
      // Check if operation has been cancelled
      if (worker.CancellationPending)
      {
          doWorkEventArgs.Cancel = true;
          break;
      }

    . . .

      // Invoke THINKComm.CustomerAddressUpdate Workflow via AddressContext
      var invokeOp = _addressDomainContext.UpdateAddress(activityData);
      // 'activityData' is an instance of Dictionary<string, string>

      invokeOp.Completed += (o, args) => InvokeOpOnCompleted(o, args, batchProcess);
   }
} 
```

`ProgressChanged`和事件的处理程序`RunWorkerCompleted`，以及所有实例的`Completed`事件，`InvokeOperation`在大多数情况下，都会更新 UI 的一部分。如果您认为发布任何代码会有所帮助，我很乐意更新帖子。

说到 UI，事件处理程序更新的部分是两个`ProgressBar`控件 - 一个在从文件中读取记录时跟踪记录，第二个在第 3 方数据库上发生更新时跟踪记录。

进入实际问题...

我已经毫无问题地处理了 10、100 和 1,000 条记录的文件。然后，我尝试处理包含约 15,000 条记录（或 1,907KB 数据）的完整文件。该过程开始，我可以在调试器输出中看到正在执行工作流。大约进行了四分之一左右，我得到了一个`OutOfMemoryException`. 这是堆栈跟踪：

```
at System.ServiceModel.DomainServices.Client.WebDomainClient`1.BeginInvokeCore(InvokeArgs invokeArgs, AsyncCallback callback, Object userState)
at System.ServiceModel.DomainServices.Client.DomainClient.BeginInvoke(InvokeArgs invokeArgs, AsyncCallback callback, Object userState)
at System.ServiceModel.DomainServices.Client.DomainContext.InvokeOperation(String operationName, Type returnType, IDictionary`2 parameters, Boolean hasSideEffects, Action`1 callback, Object userState)
at THINKImportSystem.Web.Address.AddressDomainContext.UpdateAddress(Dictionary`2 activityData)
at THINKImportSystem.BatchProcessPage.BwOnDoWork(Object sender, DoWorkEventArgs doWorkEventArgs, BatchContainerControl batchProcess)
at THINKImportSystem.BatchProcessPage.<>c__DisplayClass10.<StartButtonClick>b__6(Object s, DoWorkEventArgs args)
at System.ComponentModel.BackgroundWorker.OnDoWork(DoWorkEventArgs e)
at System.ComponentModel.BackgroundWorker.OnRun(Object argument) 
```

然后，JIT 调试器弹出错误`Unhandled Error in Silverlight Application Code:4004`消息`System.ServiceModel.DomainServices.Client.DomainOperationException: Invoke operation 'UpdateAddress' failed. Error HRESULT E_FAIL has been returned from a call to a COM component.`

我应该提一下，有时我会先获得 JIT 调试器。我在调试输出中看到线程仍在退出，然后大约 10 或 20 秒后，VS 调试器弹出内存不足异常。

我最好的猜测是，某处的对象（可能与 DomainService 有关？）没有被释放，因此内存使用量正在增加。据我了解，IIS 对应用程序可以使用的内存量进行了限制，但我不知道这里是否是这种情况。

我在想，每次处理文件中的记录时，与其处理相关的对象都会被释放，因此整体内存使用率会很低。但显然我不明白一切是如何执行的！

我还想知道使用 TPL 是否`BackgroundWorker`会有所作为？

# python - 如何在列表内的嵌入式文档中指定一个字段是全局唯一的

> ID：14166043
> 
> 赞同：0
> 
> 时间：2013-01-04T22:29:03.343
> 
> 标签：python, mongodb, pymongo, mongoengine

我想创建一个嵌入文档的列表，并且在每个嵌入文档中都有一个特定的字段不仅在列表上是唯一的，而且在整个集合中的所有列表上都是唯一的。

所以我这样做了：

```
class User(Document):
    emails = ListField(EmbeddedDocumentField(Email))

class Email(EmbeddedDocument):
    email = StringField(unique=True) # This doesn't work!
    verified = BooleanField(default=False) 
```

这只是行不通，我仍然可以向同一用户或跨用户添加重复的邮件！
请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:58:55.220

MongoDB 索引中的唯一性是按文档执行的，而不是按数组中的元素执行的。如果要强制执行，则必须将这些文档拆分为单独的集合。

# memory - 将 8051 连接到外部 RAM-EEPROM

> ID：14166044
> 
> 赞同：0
> 
> 时间：2013-01-04T22:29:08.837
> 
> 标签：memory, external, 8051, microprocessors

当我将8051连接到外部存储器时，我应该在软件中更改RD和WR信号还是在我使用MOVX命令时由处理器本身进行？

例如，我将从内存中的某个位置读取，

```
;CLR RD
MOV DPTR,#SOMELOCATION
MOVX A,@DPTR 
```

此处是否需要 CLR 读取命令，或者处理器只是通过查看代码是否正确来清除它自己

```
MOVX A,@DPTR ;or
MOVX @DPTR,A 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-14T10:10:48.307

如果处理器有 RD 和 WR 线，那么是的，处理器将在执行“movx @dptr,A”指令时按照数据表中所述的时序脉冲写入线。此外，ALE 将被脉冲以锁存存储器地址的低字节。

如果由于某种原因需要使用上面所说的清除位指令来操作芯片写入，那么您在错误的地方进行操作。在地址和数据发生任何其他更改之前，您需要设置地址和数据然后脉冲写入低电平，然后将其返回高电平。

# android - ORMLite 连接查询和排序依据

> ID：14166046
> 
> 赞同：3
> 
> 时间：2013-01-04T22:29:38.880
> 
> 标签：android, ormlite

我正在尝试加入两个表并获取两个表中的所有列，我这样做了：

```
QueryBuilder<A, Integer> aQb = aDao.queryBuilder();
QueryBuilder<B, Integer> bQb = bDao.queryBuilder();
aQb.join(bQb).prepare(); 
```

这相当于：

```
SELECT 'A'.* FROM A INNER JOIN B WHERE A.id = B.id; 
```

但我想要：

```
SELECT * FROM A INNER JOIN B WHERE A.id = B.id; 
```

另一个问题是在按 B 的字段排序时，例如：

```
aQb.orderBy(B.COLUMN, true); 
```

我收到一条错误消息，提示“没有表列 B”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T23:52:58.070

当您使用 时`QueryBuilder`，它期望返回`B`对象。它们不能包含`A`in 中的所有字段`B`。如果这就是您的意思，它不会充实外国子领域。该功能尚未跨越[ORMLite的](http://ormlite.com/)*lite*障碍。

也不支持在连接表上排序。您当然可以添加，`bQb.orderBy(B.COLUMN, true)`但我认为这不会满足您的要求。

您当然可以为此使用[原始查询](http://ormlite.com/docs/raw-queries)，尽管它不是最佳的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-10T16:16:33.947

实际上，我设法做到了，而无需将整个查询编写为原始查询。这样，我不需要替换我的查询构建器代码（这非常复杂）。为此，我遵循了以下步骤：

（假设我有两个表**my_table**和**my_join_table**及其 daos，我想通过**my_join_table**的列**order_column_1对****my_table**的查询进行排序）

 ****1-加入两个查询构建器并使用`QueryBuilder.selectRaw(String... columns)`方法来包括原始表+我想在外部排序中使用的列。例子：

```
QueryBuilder<MyJoinTable, MyJoinPK> myJoinQueryBuilder = myJoinDao.queryBuilder();
QueryBuilder<MyTable, MyPK> myQueryBuilder = myDao.queryBuilder().join(myJoinQueryBuilder).selectRaw("`my_table`.*", "`my_join_table`.`order_column` as `order_column_1`"); 
```

2- 包括我的订单由这样的条款：

```
myQueryBuilder.orderByRaw("`order_column_1` ASC"); 
```

3- 设置所有选择列和 order by 子句后，是时候准备语句了：

```
String statement = myQueryBuilder.prepare().getStatement(); 
```

4- 从 dao 获取表信息： TableInfo tableInfo = ((BaseDaoImpl) myDao).getTableInfo();

5-创建了我的自定义列到对象映射器，它忽略了未知的列名。通过这样做，我们避免了自定义列的映射错误（`order_column_1`在这种情况下）。例子：

```
RawRowMapper<MyTable> mapper = new UnknownColumnIgnoringGenericRowMapper<>(tableInfo); 
```

6-查询表的结果：

```
GenericRawResults<MyTable> results = activityDao.queryRaw(statement, mapper); 
```

7-最后，将通用原始结果转换为列表：

```
List<MyTable> myObjects = new ArrayList<>();
for (MyTable myObject : results) {
    myObjects.add(myObject);
} 
```

这是我通过修改（只是吞下异常）创建的自定义行映射器，`com.j256.ormlite.stmt.RawRowMapperImpl`以避免未知的列映射错误。您可以将其复制并粘贴到您的项目中：

```
import com.j256.ormlite.dao.RawRowMapper;
import com.j256.ormlite.field.FieldType;
import com.j256.ormlite.table.TableInfo;

import java.sql.SQLException;

public class UnknownColumnIgnoringGenericRowMapper<T, ID> implements RawRowMapper<T> {

    private final TableInfo<T, ID> tableInfo;

    public UnknownColumnIgnoringGenericRowMapper(TableInfo<T, ID> tableInfo) {
        this.tableInfo = tableInfo;
    }

    public T mapRow(String[] columnNames, String[] resultColumns) throws SQLException {
        // create our object
        T rowObj = tableInfo.createObject();
        for (int i = 0; i < columnNames.length; i++) {
            // sanity check, prolly will never happen but let's be careful out there
            if (i >= resultColumns.length) {
                continue;
            }
            try {
                // run through and convert each field
                FieldType fieldType = tableInfo.getFieldTypeByColumnName(columnNames[i]);
                Object fieldObj = fieldType.convertStringToJavaField(resultColumns[i], i);
                // assign it to the row object
                fieldType.assignField(rowObj, fieldObj, false, null);
            } catch (IllegalArgumentException e) {
                // log this or do whatever you want
            }
        }
        return rowObj;
    }
} 
```

这很 hacky 并且对于这个操作来说似乎有点矫枉过正，但我​​绝对需要它，而且这种方法效果很好。****

# matrix - 以矩阵的形式将数据导入 Mathematica

> ID：14166049
> 
> 赞同：1
> 
> 时间：2013-01-04T22:29:45.183
> 
> 标签：matrix, wolfram-mathematica

我有一个文件，当我导入 Mathematica 时，它看起来像这样：{{1,1,n1},{1,2,n2},{1,3,n3},{2,1,n4},{ 2,2,n5},{2,3,n6}} 其中 n1...n6 是一些我想作为矩阵导入的数字，如下所示：

![在此处输入图像描述](../Images/078f282bead0392dc524ed681e1600fc.png)

每个块中的第一个数字指定行，第二个指定列，但它们不是矩阵的一部分。只有每个块中的第三个数字是矩阵的一部分。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:56:44.190

如果

```
data = {{1, 1, n1}, {1, 2, n2}, {1, 3, n3}, {2, 1, n4}, {2, 2, n5}, {2, 3, n6}}; 
```

你可以简单地做

```
mat = Partition[data[[All, 3]], 3, 3] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T05:37:29.870

我能想到对这个问题的几种解释。

如果您的数据是常规格式，并且您希望以内存有效的方式阅读它，我建议仔细查看`ReadList`我[已经指导您](https://stackoverflow.com/q/13746642/618728)的相关功能以及`Partition`其他答案说明的功能。

相反，我将关注数据不是完全规则形式的想法，因为给定的行和列索引对于描述数据在数组中的位置是必要的。为此，最自然的方法是使用`SparseArray`at 它以位置和值对的形式接受数据`Rule`：

```
data = {{1, 1, n1}, {1, 2, n2}, {1, 3, n3}, {2, 1, n4}, {2, 2, n5}, {2, 3, n6}};

array = SparseArray[{#, #2} -> #3 & @@@ data];

array // MatrixForm 
```

![数学图形](../Images/237fa22a2bc48a991068c93907dd8235.png)

该函数`Normal`可用于根据需要将 转换`SparseArray`为常规 list-of-lists 数组：

```
Normal @ array 
```

> ```
> {{n1, n2, n3}, {n4, n5, n6}} 
> ```

还有[一个 StackExchange 站点](http://mathematica.stackexchange.com)专门用于*Mathematica*，我鼓励您去探索。

# objective-c - （可能很简单）initWithString 似乎不起作用

> ID：14166051
> 
> 赞同：1
> 
> 时间：2013-01-04T22:29:56.187
> 
> 标签：objective-c, nsstring

我正在关注的 objc 教程使用以下初始化：

```
NSString* p = [[NSString alloc] initWithString:@"something"]; 
```

但是，同一教程在前一章中指出，这些类型的构造可以分解为以下部分：

```
NSString* p = [NSString alloc];
[p initWithString: @"something"]; 
```

但是，如果我尝试使用 NSLog 显示*p*的值，则会发生异常：

```
main: Uncaught exception NSInternalInconsistencyException, reason: attempt to use uninitialised string 
```

这可能是一个简单的问题，但我似乎无法找到答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-04T22:31:14.403

您必须将变量设置为 init 的返回值：

```
NSString* p = [NSString alloc];
p = [p initWithString: @"something"]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T22:48:56.307

这是来自[NSObject](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSObject_Class/Reference/Reference.html)的手册，关于 init 方法：

> 在某些情况下，init 方法可能会返回一个替代对象。因此，在后续代码中，您必须始终使用 init 返回的对象，而不是 alloc 或 allocWithZone: 返回的对象。

# java - Spring Security OAuth2 cookie

> ID：14166056
> 
> 赞同：1
> 
> 时间：2013-01-04T22:30:25.153
> 
> 标签：java, spring, oauth, spring-security, oauth-2.0

我使用 Spring Security 在我的应用程序中实现了 OAuth2。目前，它适用于“access_token”请求参数。我在哪里可以添加一些自定义来接受来自 cookie 的令牌？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T22:40:34.630

您无法从 Cookie 获取令牌 - 使用 oAuth，获取它的唯一方法是通过调用 oAuth 服务器，获取代码，然后获取令牌......您可以阅读[oAuth 规范](https://www.rfc-editor.org/rfc/rfc6749)。

如果您谈论应用程序端（而不是 oAuth），它可能是可能的。检查令牌是持有受保护资源的应用程序的责任。在那里，它可以检查 Cookie，而不是从请求的标头中获取令牌。

# jquery - 如何为 jQuery Simple Color Picker 实现 OnColorChange 事件？

> ID：14166066
> 
> 赞同：0
> 
> 时间：2013-01-04T22:31:14.510
> 
> 标签：jquery, jquery-ui, jquery-plugins

我有一个包含 2 列的 html 表（代码如下所示）

```
<tbody>
        @foreach (DTRow vr in Model.Values)
        {
            <tr id="@vr.FieldID">
                <td>@vr.FieldName</td>
                <td><input class="RowColorField" @string.Format("id={0}{1}", vr.FieldID, "_colorField") type="text" name="colorField" value="@vr.Color"/></td>
            </tr>
        }
</tbody> 
```

我正在使用 jQuery 插件“Really Simple Color Picker”来显示表中第二列的调色板。所以我在 document.ready 函数中有以下代码。当颜色改变时，需要向服务器发送一个请求，其中包含新的颜色值和改变颜色的行的id。我的问题是如何从该特定行中捕获这两个值？关于如何实现这一点的任何想法？谢谢你的帮助。

```
$(".RowColorField").colorPicker( {transparency: true}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T00:39:41.707

[自述](https://github.com/laktek/really-simple-color-picker#readme)文件显示可以在`colorPicker`选项中指定回调，如下所示：

```
$('.RowColorField').colorPicker({
    onColorChange : function(id, newValue) {
        // send id and newValue to the server here
    }
}); 
```

# knockout.js - 如何将计算的 observable 添加到映射的视图模型？

> ID：14166067
> 
> 赞同：0
> 
> 时间：2013-01-04T22:31:26.460
> 
> 标签：knockout.js, knockout-mapping-plugin

我想简单地将计算的 observable 添加到映射的对象。我想避免添加父视图模型。我尝试使用映射选项创建，但这似乎不起作用。

```
$.getJSON(apiUrl, function (data) {

         var mappingOptions = {

          // overriding the default creation / initialization code
          create: function (options) {

          ko.mapping.fromJS(options.data, {}, this);

           // setup the computed binding
           this.FullNameComputed= ko.computed(function () {
                   return this.FirstName() + this.LastName();
                  }, this);               
            }        
          };

          ko.mapping.fromJS(data, mappingOptions, self.Users);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T16:19:54.000

您可以在执行映射后添加计算的 observable：

```
$.getJSON(apiUrl, function (data) {

  var vm = ko.mapping.fromJS(data);

  vm.FullName = ko.computed(function(){
    return vm.FirstName() + ' ' + vm.LastName();
  });
}); 
```

# android - 角色上的 Android 2D 动画

> ID：14166068
> 
> 赞同：0
> 
> 时间：2013-01-04T22:31:31.893
> 
> 标签：android, animation

我已经创建了一个角色，我想知道如何为它制作动画：

*   它在静止位置时必须移动，例如眨眼、闭嘴。
*   它必须根据玩家手势在屏幕上移动。
*   它必须参与碰撞。

我读到了 AnimationDrawable、SurfaceView、Canvas ……但哪种方式最好？

非常感谢 ！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T12:14:48.440

如果您正在尝试制作游戏，您应该考虑[使用 GLSurfaceView](http://developer.android.com/reference/android/opengl/GLSurfaceView.html)和[textures](http://www.jayway.com/2010/12/30/opengl-es-tutorial-for-android-part-vi-textures/)。 [这](http://www.jayway.com/?s=openGL+ES)是一个很好的教程，虽然它包含一些编码错误，但它使概念非常清晰！

OpenGLES 方法比动画视图提供更多的自由，但可能更难掌握。

# ruby - Facebook Sinatra 应用程序无法登录

> ID：14166070
> 
> 赞同：2
> 
> 时间：2013-01-04T22:31:46.567
> 
> 标签：ruby, facebook, sinatra

我正在尝试使用提供的 Ruby Heroku 包开发 Facebook 应用程序。我之前已经尝试过这个，但只是创建了一个新的应用程序来开发。我遇到无法使用该应用程序登录的问题。我点击一个按钮登录，但在重定向之后，我发现什么都没有发生。不过，每 20 次左右尝试一次，它就会让我正确登录。

对于那些从未使用过 Facebook 的 Heroku 主机的人来说，[这里](https://github.com/heroku/facebook-template-ruby)是安装的模板。我所做的唯一更改是将应用程序模块化。

相关路由如下：

```
get "/auth/facebook" do
  session[:access_token] = nil
  redirect authenticator.url_for_oauth_code(:permissions => FACEBOOK_SCOPE)
end

get '/auth/facebook/callback' do
  session[:access_token] = authenticator.get_access_token(params[:code])
  redirect '/'
end 
```

有没有人经历过这种情况？如果您想尝试自己，[这](https://blooming-fortress-5933.herokuapp.com/)就是应用程序的位置。我有一个类似的运行没有出现这个问题，所以我真的无法弄清楚。

编辑：我想我发现了问题。根据 New Relic[的这条信息](https://newrelic.com/docs/ruby/no-data-with-unicorn)，我将 Unicorn preload_app 设置为 false 。将 preload_app 设置为 true 已经解决了这个问题。不幸的是，我不记得为什么我首先将其设置为 false（我已经从以前的应用程序中调整了一些配置内容）。也许有人比我有更好的知识。

# sql - 从一个表 SQL 服务器中获取行和行

> ID：14166078
> 
> 赞同：0
> 
> 时间：2013-01-04T22:32:25.983
> 
> 标签：sql, sql-server, sql-server-2008

我在 sql server 中有评论表，结构为

```
CREATE TABLE [dbo].[LS_Commentes](
    [CommentId] [int] IDENTITY(1,1) NOT NULL,
    [OwnerId] [uniqueidentifier] NULL,
    [OwnerName] [nvarchar](50) NULL,
    [Email] [nvarchar](250) NULL,
    [Date] [nvarchar](15) NULL,
    [ParentId] [int] NULL,
    [CommentText] [nvarchar](400) NULL,
    [ItemId] [int] NULL,
    [upVotes] [int] NULL,
    [downVotes] [int] NULL,
    [isApproved] [bit] NULL,
 CONSTRAINT [PK_LS_MsgCommentes] PRIMARY KEY CLUSTERED 
(
    [CommentId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

我有这样的样本数据：

```
CommentId   OwnerId OwnerName   Email   Date    ParentId    CommentText ItemId  upVotes downVotes   isApproved
1   NULL    Test Commneter  NULL    1/4/2013    NULL    test    9   0   0   NULL
2   NULL    Test Commneter  NULL    1/4/2013    1   test    NULL    0   0   NULL
3   NULL    Test Commneter  NULL    1/4/2013    1   test    NULL    0   0   NULL 
```

我想写一个查询可以让我所有行都有 itemid = 9 并且行有 parentid = 选择的评论 id（因为 itemid = 9）

看这里我也可以通过在子评论中添加项目 ID 9 来解决它，但我只想知道是否可以在不向评论和子评论中添加项目 ID 的情况下解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:45:22.493

我认为以下查询可以满足您的要求：

```
select *
from ls_comments c
where c.itemID = 9 or
      c.parentID in (select c2.commentId from ls_comments c2 where c2.itemId = 9) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T22:47:02.387

递归[公用表表达式](http://msdn.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)会给您想要的结果吗？

```
;with cte as 
(
    --Anchor
    select 
        commentid,
        ParentId
    from 
        LS_Commentes
    where
        ItemId = 9
    union all
    --Recursive member
    select 
        c.commentId,
        c.ParentId
    from
        LS_Commentes c join cte on c.ParentId = cte.CommentId

)
select * from cte 
```

如果要在结果中包含更多列，请确保两个部分（锚点和递归成员）具有相同的列。

说明：递归查询的锚部分（第一个选择）选择 ItemId = 9 的所有行，第二部分使用结果中的现有记录来包括满足它的 criter 的更多记录（ParentId = cte.CommentId） 这继续直到没有更多的选择。然后必须在最后选择整个结果（在 CTEs 定义之后）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T22:47:13.650

我认为使用嵌入式 SQL 查询会很好

```
 SELECT * 
 FROM `LS_Commentes` 
 WHERE `ItemId` = '9' 
     AND `ParentID`= (SELECT `CommentID` FROM `LS_Commentes` WHERE `ItemId` = 9); 
```

# postgresql - PostgreSQL 的颜色有什么区别？

> ID：14166080
> 
> 赞同：13
> 
> 时间：2013-01-04T22:32:30.617
> 
> 标签：postgresql, heroku

我正在尝试根据[https://devcenter.heroku.com/articles/heroku-postgresql#local-setup](https://devcenter.heroku.com/articles/heroku-postgresql#local-setup)上的说明设置 PostgreSQL 的本地版本，以便在 Heroku 上与我的 Rails 应用程序一起使用。

当我为不同的heroku配置grep时

```
(heroku config | grep HEROKU_POSTGRESQL) 
```

我得到以下回报：

```
HEROKU_POSTGRESQL_AQUA_URL:   postgres://mzqgqmkhlsgufo:Hk-Nu5SF6amY9mgl2n6u-Yi6U-@ec2-54-243-228-246.compute-1.amazonaws.com:5432/d8jndm2sub3lbt
HEROKU_POSTGRESQL_VIOLET_URL: postgres://nviwubpznhhgkv:siEYPLdOknBWOj1K3HePMn21DS@ec2-54-243-188-54.compute-1.amazonaws.com:5482/ddr1fm1ou7ha9s 
```

不同的颜色有什么意义吗？我会更好地使用一种而不是另一种，还是它们只是随机的颜色？对不起，如果这是一个愚蠢的问题，但我不打算找到解决这个问题的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T00:41:17.273

在没有深入研究的情况下，我认为对*你*来说主要的区别在于他们监听的端口。Aqua 监听 PostgreSQL 默认端口 5432；5482 上的紫罗兰色。它们似乎也有不同的 IP 地址，这可能会或可能不会影响您。（我不记得应用程序是如何连接到 Heroku 的。）

如果您在本地安装，并且您以前从未安装过 PostgreSQL，它可能会在默认端口 5432 上进行侦听。

颜色名称对 PostgreSQL 没有任何意义。这似乎只是 Heroku 在管理其服务时使用的命名约定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-07-07T23:24:22.500

**简短回答：** 它们是**随机颜色**。

只有在您的应用程序中添加了多个数据库时，您才会获得这些颜色。

# 引用 Heroku：

> 作为配置过程的一部分，一个 DATABASE_URL 配置变量被添加到您的应用程序的配置中。这包含您的应用程序用来访问数据库的 URL。如果您的应用程序已经有 Heroku Postgres 数据库并且您刚刚配置了另一个数据库，则此配置变量的名称改为采用 HEROKU_POSTGRESQL__URL 格式（例如，HEROKU_POSTGRESQL_YELLOW_URL）。

来源： [https ://devcenter.heroku.com/articles/heroku-postgresql](https://devcenter.heroku.com/articles/heroku-postgresql)

# javascript - 我可以拥有多个本地存储实例吗？

> ID：14166082
> 
> 赞同：1
> 
> 时间：2013-01-04T22:32:42.473
> 
> 标签：javascript, html, local-storage

我有一些代码可以将提示的 Ajax 请求存储在 localstorage 中，每个请求一个键即可正常工作。我还将其他持久性数据存储在同一个地方——我使用唯一的键前缀将其分开，这样就不会干扰我的 Ajax 提示。

我现在需要存储更多数据，我认为它变得混乱了。

有没有办法拥有多个本地存储实例？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:45:16.050

你不能有多个 localStorage 实例，你不能实例化它。如果可以在逻辑上将它们分组在一起，则不必将具有唯一键前缀的每一位数据分开。只要可以序列化这些数据，您就可以执行以下操作：

```
var requests = {reqId2 : reqObj, reqId2 : reqObj};
localStorage.setItem("ajax_requests", JSON.stringify(requests));

// then when you want to add additional requests into localStorage
var requests = JSON.parse(localStorage.getItem("ajax_requests"));
requests[reqId] = reqObj; 
```

只要记住存储所有可以在逻辑上组合在一起的数据，它应该对您的组织有所帮助。

# actionscript-3 - 在 ActionScript3 中流畅地处理多个按键

> ID：14166083
> 
> 赞同：2
> 
> 时间：2013-01-04T22:32:53.200
> 
> 标签：actionscript-3

我目前正在为平台游戏构建引擎，但我注意到 ActionScript3 在使用多个按键时难以保持流畅。例如;

```
 function onKeyDown(event:KeyboardEvent):void {
        if (event.keyCode == Keyboard.UP || event.keyCode == Keyboard.W || event.keyCode == Keyboard.SPACE) {
            if (isTouchingGround()) {
                isJumping = true;
                yv = -100;
            }
        } else if (event.keyCode == Keyboard.DOWN || event.keyCode == Keyboard.D) {
            if (xv == 0) {
                player.gotoAndPlay(275);
            }
        } else if (event.keyCode == Keyboard.LEFT || event.keyCode == Keyboard.A) {
            if (xv == 0) {
                xv = -24;
            } else if (xv != -120) {
                xv-=2;
            }
        } else if (event.keyCode == Keyboard.RIGHT || event.keyCode == Keyboard.D) {
            if (xv == 0) {
                xv = 24;
            } else if (xv != 120) {
                xv+=2;
            }
        }
    } 
```

因此，如上所述，使用 UP（或 W，或 Space）键会触发玩家跳跃（单独的 onframe 事件处理程序处理重力等）。使用 RIGHT（或 D..）键触发器会增加玩家加速度，这会在单独的 onframe 事件处理程序中再次应用于玩家。

一切都可以正常工作-但是当使用多次击键时就会出现问题。如果一名球员开始向右移动，并击中跳跃，他将停止加速。同时，他不会按照 Keyboard.UP 方法中的指示减速。相反，他将保持当前速率不变，直到再次按下 RIGHT 键。

简而言之，就好像 Actionscript 开始忽略 RIGHT 或 LEFT 移动键的 keyboard.down 和 keyboard.up 方法，直到它们不再被按下。这显然会导致一些非常严格的游戏玩法 - 有没有人愿意与我分享这方面的任何解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T22:37:44.810

您的问题在于您的 if 条件后面跟着 if else 条件。删除 else 并只使用 if 条件。基本上，如果用户按住空格，则不会测试其他 if 条件，因为空格被按住并且它是第一个 if 语句。因此，只需将 else 从 if 中删除。只需删除测试击键的 if else 条件，而**不是**处理击键的 if 语句中的条件。

这是您的代码应如下所示：

```
function onKeyDown(event:KeyboardEvent):void {
    if (event.keyCode == Keyboard.UP || event.keyCode == Keyboard.W || event.keyCode == Keyboard.SPACE) {
        if (isTouchingGround()) {
            isJumping = true;
            yv = -100;
        }
    }
    if (event.keyCode == Keyboard.DOWN || event.keyCode == Keyboard.D) {
        if (xv == 0) {
            player.gotoAndPlay(275);
        }
    }
    if (event.keyCode == Keyboard.LEFT || event.keyCode == Keyboard.A) {
        if (xv == 0) {
            xv = -24;
        } else if (xv != -120) {
            xv-=2;
        }
    }
    if (event.keyCode == Keyboard.RIGHT || event.keyCode == Keyboard.D) {
        if (xv == 0) {
            xv = 24;
        } else if (xv != 120) {
            xv+=2;
        }
    }
} 
```

您可能会注意到的另一件事是，当同时按住 UP 键和 RIGHT 键时，计算机似乎冻结了键盘输入，但是当按住 W 键和 D 键时，您仍然可以按其他键，计算机将注册他们的输入。这个问题的答案就[在这里](https://gaming.stackexchange.com/questions/6669/how-do-i-remove-the-limit-on-pc-keyboard-button-presses)。

## 更新：

对于流畅的部分，与其在击键发生时触发某些东西，不如使用一个布尔变量，例如`keyUP`or `UP`，如果按键按下则保持 true ，或者当按键向上时保持 false 。然后有一个函数在为真`onEnterFrame(event:Event):void {}`时执行一个动作。`keyUP`像这样：

```
import flash.events.*;

public class keyEvents extends MovieClip {
    private var keyRIGHT:Boolean = false;

    public function keyEvents():void
    {
        this.addEventListener(KeyboardEvent.KEY_DOWN, onKeyDown);
        this.addEventListener(KeyboardEvent.KEY_UP, onKeyUp);
        this.addEventListener(Event.ENTER_FRAME, onEnterFrame);
    }

    function onKeyDown(event:KeyboardEvent):void
    {
        if(event.keyCode == Keyboard.RIGHT) {
            this.keyRIGHT = true;
        }
    }

    function onKeyUp(event:KeyboardEvent):void
    {
        if(event.keyCode == Keyboard.RIGHT) {
            this.keyRIGHT = false;
        }
    }

    function onEnterFrame(event:Event):void
    {
        if(this.keyRIGHT) {
            // This code is executed while the RIGHT arrow key is down.
        }
    }
} 
```

如果上面的代码不起作用，我认为您的问题出在您的键盘上，而不是它坏了或其他任何东西，但它的制作方式可能会把事情搞砸。

如果这没有帮助，请告诉我，我会继续尝试。

# android - 向小部件绘制渐变时如何摆脱条带？

> ID：14166086
> 
> 赞同：1
> 
> 时间：2013-01-04T22:33:08.603
> 
> 标签：android, widget, gradient

我已经看到很多类似的问题得到了解答，说明了如何在窗口中删除条带，但我一直无法找到任何东西来为我指明关于主屏幕小部件的正确方向。

该应用程序将 gradientDrawable 绘制到画布上，然后将其用作小部件的背景。在主应用程序活动中，我已经能够使用以下代码使其看起来更好：

```
Window window = getWindow();
window.setFormat(PixelFormat.RGBA_8888); 
```

但是有没有办法在小部件中以某种方式实现相同的效果？我尝试过使用`gradientDrawable.setDither(true);` ，但这似乎没有任何效果。

我会很感激任何指点，谢谢

# regex - Perl 正则表达式替换替换 1 太多字符

> ID：14166087
> 
> 赞同：1
> 
> 时间：2013-01-04T22:33:09.723
> 
> 标签：regex, perl, substitution

我在 perl 正则表达式替换方面相当有能力，但我有点生疏了，这是我通常不做的事情。这是为 XML 转义一个 & 字符，但防止在已经转义的字符中替换 &。它似乎工作正常，只是它删除或替换了它右侧的字符。我错过了什么？

```
$str =~ s/&[^amp;|lt;|gt;|quot;|#39;]/&amp;/g; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T22:38:55.920

您将否定字符类误认为是否定[前瞻](http://perldoc.perl.org/perlre.html#Extended-Patterns)。

你的正则表达式真的意味着：

```
/&[^#39aglmopqtu;|]/ # mixed a few letters and removed duplicates 
```

但你*的意思是*：

```
/&(?!amp;|lt;|gt;|quot;|#39;)/ 
```

方括号表示字符类，而不是分组！

如果你真的想避免匹配 XML 实体，你应该使用像这样的正则表达式

```
m{& (?! (?:
   (?:\#[0-9]+)
  |(?:\#x[0-9a-fA-F]+)
  |(?:[lg]t|amp|apos|quot) # predefined XML entities
); )}x 
```

（比较[XML 规范](http://www.w3.org/TR/xml/#sec-predefined-ent)）并以某种方式添加您的文档或引用的 DTD 声明的所有实体。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T22:39:50.777

看来您需要零宽度的负前瞻。就像是

```
$str =~ s/&(?!amp;|lt;|gt;|quot;|#39;)/&amp;/g; 
```

# html - 在高度可以变化的表格下方放置一个 div

> ID：14166088
> 
> 赞同：0
> 
> 时间：2013-01-04T22:33:11.973
> 
> 标签：html, css

我想知道如何在高度可以变化的桌子下方放置一个 div。

这是一个购物车后端页面：我有一个包含购物车项目的表，它可以是 1 到 15 个项目之间的任何列表，因此可以有 1 到 15 行。在这下面大约 100px 我想要一个包含输入字段的 div 来收集帐单和送货地址。我不想将表格的高度设置为任何特定的高度，只需设置它所需的行数的高度，地址 div 就在它的正下方。

我研究并尝试了所有的 CSS 定位可能性，但没有发现任何帮助。请帮忙？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:42:05.810

只需将 div 放在表格后面，并给它一个 css 样式，其中包括`margin-top:100px;`

# c# - C# 字符串与 f 一起浮动

> ID：14166089
> 
> 赞同：-2
> 
> 时间：2013-01-04T22:33:21.440
> 
> 标签：c#, string, parsing, unity3d

顺便说一句：xposs 是从服务器收到的，所以我不能只说它是一个浮点数，我需要将它转换为一个浮点数，后面有 0.0f：

```
xposs = "951.9791"

xspawn = float.Parse(yposs); 
```

这只是以浮点数返回 951.9791 但我想要 951.9791f

我也试过：

```
xposs = "951.9791"

xspawn = float.Parse(yposs) + 0.0f; 
```

这仍然不起作用。

我需要它是 0.0f 格式，因为我在 Vector3() 中使用它，并且没有 f 似乎不起作用（它工作得很好，但坐标完全错误，如果我在它工作后手动按下 f。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-04T22:35:59.690

`f`后缀仅适用于代码中的文字。它用于将文字值表示为`float`. 如果不存在后缀 - 文字值将是类型`double`

您可以在 Unity 3d 中将结果传递`float.Parse(stringValue)`到构造函数参数中`Vector3`并`Vector2`作为构造函数参数接下来的代码创建一个 Vector3 对象，其中 xyz 等于字符串中设置的值

```
string sideSize = "12.5";
float vectorSide = float.Parse(sideSize, CultureInfo.InvariantCulture);
Vector3 resultVector = new Vector3(vectorSide, vectorSide, vectorSide); //create vector3 with x = y = z = 12.5 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-04T22:34:33.473

“f”后缀以字面值形式提供以表示数据类型

*   f 为浮点数
*   m 为小数
*   d 为双

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-04T22:35:56.823

浮点数只是一个带有 type 的数值`System.Single`。他们没有`f`背后的支持。这只是 C# 用于`float`文字的表示法。`float.Parse`返回 a `float`，不可能或没有必要添加`f`.

# javascript - 用函数推数组

> ID：14166090
> 
> 赞同：0
> 
> 时间：2013-01-04T22:33:21.957
> 
> 标签：javascript

```
var books = new Array();

books[0] = "Silmarillion: ";
books[1] = "Horus Rising: ";
books[2] = "Lord of the Rings: ";

var ratings = new Array();

ratings[0] = "9 ";
ratings[1] = "8 ";
ratings[2] = "7 ";

function printBooks()
{
    for(var i = 0; i < books.length; i++)
    {
    document.writeln(books[i] +" " + ratings[i]);
    }

}

printBooks(); 
```

我有这段代码，它（基本上）实现了我想要它做的事情，但它很糟糕。我想在两个函数中使用它，一个函数 (addBooks(title, rating)) 用于添加我的书籍，另一个函数 (printBooks()) 用于打印它们。我希望用户被要求添加一本书，询问它的评级并执行三遍。在此之后，我希望它被打印出来。

我试过这样做，但我不知道如何编写一个添加到数组中的函数。我只知道我应该使用 push() 但不再使用了。我希望它足够清楚。

编辑

除此之外，我还想有一种方法来计算所添加书籍的平均分数。我现在得到的代码是：

```
function averageRating ()
{
var sum = 0;
for(var u = 0; u < ratings.length; u++)
{
    sum += parseInt(ratings[u]);
}
var avg = sum/ratings.length;
document.writeln("<br>Number of books read: " + ratings.length + "<br>The average rating of the books are: " + avg);

averageRating(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T22:44:22.527

这个概念是你有一个图书馆，里面有一些书。因此，OOP 方法可能是使用某种方法创建类库。像：

```
function Library() {
    var books = [];
    this.addBook = function(bookName,rate) {
        books.push({name:bookName, rating:rate});
    }
    this.printBooks = function() {
        for(var i = 0; i < books.length; i++)  {
            document.writeln(books[i].name +": " + books[i].rating);
        }
    }
} 
```

代码：

```
var myLibrary = new Library();
myLibrary.addBook('Silmarillion',9);
myLibrary.addBook('Horus Rising',8);
myLibrary.addBook('Lord of the Rings',7);

myLibrary.printBooks(); 
```

**但是，它可以改进。**您可以创建一个类`Book`：

```
function Book(name,options) {
    this.name = name;
    this.rating = options.rating;
} 
```

类库变为：

```
function Library() {
    var books = [];
    this.addBook = function(book) {
        books.push(book);
    }
    this.printBooks = function() {
        for(var i = 0; i < books.length; i++)  {
            document.writeln(books[i].name +": " + books[i].rating);
        }
    }
    // EDIT: ADDED for new features required
    this.countBook = function() {
          return books.length;
    }
    this.calculateRatingAverage = function() {
         var sum = 0;
         for(var i = 0; i < books.length; i++) {
            sum += books[i].rating;
         }
        return sum/books.length;
     }
} 
```

它的用途变成：

```
var myLibrary = new Library();
myLibrary.addBook(new Book('Silmarillion',{rating:9}));
myLibrary.addBook(new Book('Horus Rising',{rating:8}));
myLibrary.addBook(new Book('Lord of the Rings',{rating:7}));

myLibrary.printBooks();
document.writeln("<br>Number of books read: " + myLibrary.countBook() + "<br>The average rating of the books are: " + myLibrary.calculateRatingAverage()); 
```

所以你有一个坚实的结构，你可以优化和处理它。

# grails - Grails - 如何在操作期间连接到另一个数据库

> ID：14166091
> 
> 赞同：0
> 
> 时间：2013-01-04T22:33:22.790
> 
> 标签：grails, datasource

我需要做的是（在操作或服务中）：

```
someAction() {
    // connect to database
    def otherDatasource = new Datasource(otherOptions)

    if (otherDatasource.isOnline()) {
        def list = ExclusiveDomainFromOtherDatasource.list()

        // do stuff with the data...

        otherDatasource.close()
    }
} 
```

我没有使用数据源插件，因为其他数据库可能处于脱机状态并且应用程序在首次运行期间连接，或者我可能忘记了某些东西。

我知道我可以使用一些基本的 jdbc 库并制作一个原始 sql 来获取数据，但这不是很时髦，这是唯一的方法吗？还是有一个插件可以让我这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:39:31.410

除非您使用某种自定义 DataSource，否则没有 isOnline() 方法，因此您不妨只使用 DataSources 插件。

实际上，较新版本的 grails 内置了多数据源支持，因此您不需要该插件。

我认为您只需要尝试从 DataSource 获取连接，并准备好捕获并处理数据库离线时您将获得的异常。

配置良好的数据库连接池应该允许您在数据库上线后开始成功连接。

# php - 用于转到新页面并开始下载的 HTML 表单

> ID：14166095
> 
> 赞同：1
> 
> 时间：2013-01-04T22:33:43.860
> 
> 标签：php, html, header

我有一个像这样的 HTML 表单：

```
<form method="post" enctype="multipart/form-data" action="script.php" align="center">
    <input type="submit" value="Run Program"/>
</form> 
```

然后我有 PHP 页面 script.php。我希望它被显示并自动开始下载。但是，当我添加标题以开始下载时：

```
header('Content-Description: File Transfer');
header('Content-Disposition: attachment; filename=' . $_FILES['upload']['name'] . '.tbx');
header('Content-Type: application/force-download');
header('Content-Length: ' . filesize($tbx)); 
```

下载开始了，但页面本身没有加载（可能是因为标题说我们只是要传输一个文件）。如何使页面正确显示*并*自动开始下载？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:45:14.607

您需要先加载 HTML 页面，然后在页面末尾对下载文件执行 JavaScript 定位请求。

```
<html>
... your HTML ....
<script type="text/javascript">
document.location = '... location of file to download ...';
</script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T22:43:53.703

你不能在服务器端做。你必须做那个客户端。

您一次只能通过 HTTP 发送一个资源！只需将包含 JavaScript 重定向的页面发送到您的下载脚本即可。

# sorting - 使用 Knuth 序列进行 Shell 排序的时间复杂度？

> ID：14166097
> 
> 赞同：2
> 
> 时间：2013-01-04T22:34:10.257
> 
> 标签：sorting, time-complexity, shellsort

我的 shell 排序实现的时间复杂度是多少？

```
void shellsort(int items[],int n)   
{
    int j=1;
    int d = (pow(3.0,j)-1) / 2;

    while(d < ceil(n/3))
    {
        for(int i=d;i<n;i++)
        {
            item tmp = items[i];
            int k;
            for(k = i; k >= d && items[k-d] > tmp; k -= d)
                items[k]=items[k-d];
            items[k]=tmp;
        }

        j++;
        d = (pow(3.0,j)-1) / 2;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-19T20:30:33.807

Knuth 根据公式 (3k – 1) / 2 或 [1, 4, 14, 40, 121, ...] 提出了自己的增量序列。

使用 Knuth 增量序列进行 shell 排序的时间复杂度为 O(n^3/2)。

来源：[https ://web.archive.org/web/20181026010135/http://www.stoimen.com:80/blog/2012/02/27/computer-algorithms-shell-sort/](https://web.archive.org/web/20181026010135/http://www.stoimen.com:80/blog/2012/02/27/computer-algorithms-shell-sort/)

# javascript - 如何在表格中间动态添加元素到网页

> ID：14166100
> 
> 赞同：0
> 
> 时间：2013-01-04T22:34:39.837
> 
> 标签：javascript, html, dom

我有一个具有客户搜索功能的管理网页。我键入名称，然后使用 ajax 将匹配客户的表（以及每个客户的相关数据有限）注入到页面中。我希望能够单击客户（一行）并显示客户的个人资料。配置文件可能包括多个元素、表单、按钮和复杂功能。

我不想让这个配置文件出现在单独的页面或其他东西上，我希望它被注入到我点击的位置（在客户行的下方），然后在我完成后关闭它。

我尝试将这些元素添加到 DOM，但标签之间的任何内容都作为表格的一部分出现（全部压缩到一个单元格中）。我应该先以某种方式拆分桌子吗？还是一开始就不使用桌子？

我正在寻找一个强大的解决方案，因为我也需要在站点的其他部分中像这样“插入模块”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:10:19.433

去年我做了类似的实现。

与其他人的建议相反，我认为添加行不是一个好主意。原因是您需要使用[事件委托](http://davidwalsh.name/event-delegate)来处理用户点击，而添加行会弄乱或至少使您的实现复杂化。

我的选择是在现有客户行中插入一个表。叠加层或工具提示将提供更简洁的实现，但仅在您一次只需要扩展一个客户时才有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:38:52.347

**如果您希望数据显示为内联（将其他内容向下推）**
，我会`<tr>`在与您的客户（或替换它）的数据之后 添加一秒钟，并将`<td>`其`colspan`设置为填充表格的宽度。`display:none`然后，您可以在不再需要时删除或删除该行。

**如果您希望数据显示为覆盖（覆盖其他内容）**
，我将使用 JavaScript 来确定您的行中第一个 TD 的屏幕坐标，并在该位置放置一个绝对定位的 div。（这类似于内容丰富的“工具提示”。）

如果可以合理地预期用户希望将“个人资料”中的数据与其他客户屏幕上已经显示的数据进行比较，我个人会使用第一个。如果不是这种情况，我会使用第二种解决方案，以尽量减少页面上的内容更改量（以便用户保持定向）。

# spring - 我们可以使用 Spring-AOP 摆脱 Aspects 的 bean 定义吗

> ID：14166103
> 
> 赞同：5
> 
> 时间：2013-01-04T22:34:53.047
> 
> 标签：spring, spring-aop, aop

我的方面如下：

```
@Aspect
public class SomeAspect{
    //define pointcuts
    // define Advices pertaining to pointcuts
} 
```

我的方面配置 xml 文件：

```
<?xml ...?>
  <beans ...
   xmlns:aop
   xmlns:context ..>
      <bean id="someAspect" class="...SomeAspect"/>
      <aop:aspectj-autoproxy />

  </beans> 
```

这运行得很好

**我需要什么：**

我想摆脱在我的配置 xml 文件中为每个方面编写 bean 定义，如上所示。

**我尝试了以下方法：**

`@Component`在包含我的方面的相应包中添加`SomeAspect`和在 xml 中添加`<context-component-scan>`，希望我的类作为 Bean 和方面被拾取。但是，我的 Aspect 根本没有被接受。

任何指针？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T23:22:24.313

该`context:component-scan`元素有一个子元素，您可以使用它来包含注释类，以供扫描使用。

查看`context:include-filter`元素及其属性。

```
<context:component-scan base-package="my.package.to.scan">
    <context:include-filter type="annotation" expression="org.aspectj.lang.annotation.Aspect"/>
</context:component-scan> 
```

我认为您尝试过的东西会起作用，但是如果没有完全按照您的做法看到它，很难确定。

# php - Javascript 表单提交 onclick 在 Google Chrome 中不起作用

> ID：14166105
> 
> 赞同：1
> 
> 时间：2013-01-04T22:35:15.353
> 
> 标签：php, javascript, forms

我正在尝试通过单击锚点提交表单。这是代码：

```
function submitLink() {
    document.forms["background-form"].submit();
    return false;
} 
```

此代码适用于 FF 和 IE，但不适用于 Chrome。有谁知道为什么？我这样调用函数：

```
<a href="<?php echo "background.php?cred=".$cred['id']; ?>" onclick="submitLink();">Remove</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:37:33.047

您需要从 onclick 函数返回 false 以防止默认操作。否则，您只需点击链接即可。

像这样试试

```
<a href="<?php echo "background.php?cred=".$cred['id']; ?>" onclick="return submitLink();">Remove</a> 
```

我还应该注意，您的链接不是锚链接，锚链接需要有一个[碎片标识符](http://en.wikipedia.org/wiki/Fragment_identifier)。您的链接只是一个链接，单击该链接后，浏览器将通过 http get 请求导航到该链接，从而导致当前页面卸载。

但是，通过 jQuery 绑定事件处理程序并使用内置的 preventDefault 功能会更好。

在此处阅读有关它的更多信息

[http://api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:43:49.813

如果您发现该`onClick`事件在 Google Chrome 上不起作用，那么这里有一个快速修复它的方法：

将`onclick`表单 id 替换为其名称，例如，假设您有以下内容：

```
<form id="form1" name="checkform1" 
```

查找 JS 事件：

```
onclick="document.form1.cSSld.value=''" 
```

用。。。来代替：

```
onclick="document.checkform1.cSSld.value=''" 
```

可以了，好了。它现在适用于所有网络浏览器。

# jquery - JQuery - 使用静态链接删除动态创建的表

> ID：14166108
> 
> 赞同：1
> 
> 时间：2013-01-04T22:35:25.467
> 
> 标签：jquery, dynamic, html-table, append

我有一个页面，其中有两个链接 - 已注册和已完成。单击任一创建一个包含相关数据的表。单击按钮时，需要从页面中删除当前表，并创建新表（通过 Javascript）并附加。出于某种原因，`.remove()`并`.empty()`没有在动态创建的表上工作。已注册和已完成链接始终存在于页面上。

HTML：

```
<body>
    <a id="completed" class="btn" title="Completed">Completed</a>
    <a id="enrolled" class="btn" title="Enrolled">Enrolled</a>
    <div id="table_container">
        <table id="courses_table"></table>
    </div>
</body> 
```

Javascript：

```
$(document).ready(function() {
    $("a[class*=btn]").click(function(e) { 
        display_type = this.id; 

        getTags(display_type);

        e.preventDefault();
    }); 
});

function getTags(type) {
    $('#courses_table').remove();

    //ajax call to get data, create string of new table html, append it to the container div
    var table_data = '<table id="courses_table">...</table>';

    $('#table_container').append(table_data);
} 
```

我尝试将其`.remove()`移入点击事件或成功函数，并删除整个包含的 div，但没有任何乐趣。附加没有问题。我敢肯定这是我想念的简单的东西。

编辑：console.log`#table_container.children()`是`[img images/calendars.png, div.width-100, table#courses_table]`.

一个 console.log`#courses_table`得到我`[table#courses_table]`。如果我正确解释了这些结果，则该表存在，所以我回到为什么它没有被删除。

编辑第二个：我忘了提到我要删除的表有多个 tbody 标签。也许这会导致问题？我确实尝试在删除它之前清空桌子，但它没有用。

这是一个显示我所看到的小提琴：http: [//jsfiddle.net/c4Y3U/13/](http://jsfiddle.net/c4Y3U/13/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T00:35:44.500

而不是使用

```
id="courses_table" 
```

利用

```
class="courses_table" 
```

当然相应地更新 jQuery 选择器，请参阅[http://jsfiddle.net/c4Y3U/22/](http://jsfiddle.net/c4Y3U/22/)

# javascript - javascript扩展模块模式

> ID：14166115
> 
> 赞同：3
> 
> 时间：2013-01-04T22:35:58.773
> 
> 标签：javascript, design-patterns, module, decorator

第一次在这里发帖。找不到任何人问同样的问题，所以我一定是做错了。

背景故事：我正在编写我的第一个基于钱包 JS 画布的 8 位冒险游戏。我写了一个我非常满意的概念证明，现在我想回去重构我的工作，使其尽可能干净、优雅和可重用。我熟悉高级 JS 和设计模式，我想尽可能多地使用它们。

我在哪里：我有以下对象：Screen、Controls、Scene、Player、Sprite 和 Main，它们都使用 Module 模式，并通过 requireJS 加载。

现在我想制作更多的游戏对象，以不同的行为扩展基础 Sprite 对象。是否甚至可以扩展模块模式，以便您仍然可以访问底层原型的方法？

例如，我想向某些模块添加步行和谈话行为，这会影响它们的底层更新和绘制方法。我认为通过原型链调用每个原型方法将是基本的，但事实证明它比我预期的要困难。

任何人都有一个装饰器或组合模式的例子，可以应用于模块模式并创建具有不同行为的对象？

如果不可能，我该怎么做？我应该完全放弃模块模式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T22:54:22.003

应该是可能的：

```
define('mod1', function() {
   ...
});

define('mod2', ['mod1'] function(Mod1) {
   Mod1.prototype.newFunction = function() {
   ...
   };
}); 
```

# wcf - 将 NetworkCredentials 对象传递给 WCF 服务

> ID：14166123
> 
> 赞同：0
> 
> 时间：2013-01-04T22:36:34.900
> 
> 标签：wcf, active-directory, networkcredentials

编辑-我改写了这个问题以（希望）更好地集中它。

需要交互的组件有：ASP.NET website <--> WCF service <--> 3rd party web service

第 3 方 Web 服务需要通过在构建代理期间指定网络凭据来进行 Windows 身份验证。例如：

```
ICredentials myCredentials = new NetworkCredential("myUsername", "myPassword", "myADdomain");
VendorWebService webService = new VendorWebService {Credentials = myCredentials}; 
```

据我所知，这是我们的 WCF 服务可以模拟用户访问 3rd 方 Web 服务的唯一方式。Windows 身份验证（通过网络凭据）是唯一受支持的模拟方式 - 无法在第 3 方 Web 服务和 WCF 服务之间建立某种信任。

该网站在服务帐户下运行，而不是在个人用户的帐户下运行。当我们的用户登录到我们的网站时，我们使用 ActiveDirectory 验证他们，但我们只是使用 AD 说“是的，这是一个有效的名称和密码组合”。

我需要一种方法来获取我在网站上知道的信息（用户名、密码）并将其转换为 WCF 服务上的网络凭据。我所读到的所有内容都表明，传递用户名/密码甚至网络凭据对象（如果可能的话）是一个很大的安全风险，也是一种非常糟糕的做法。

当网站不在用户帐户下运行时，可以使用哪些选项/技术使网站用户的 Windows 身份可用于 WCF 服务？

感谢您的任何见解。

PS 我确实找到了这篇文章：[How do you pass user credentials from a process to another for Impersonation in .NET 1.1?](https://stackoverflow.com/questions/3096267/how-do-you-pass-user-credentials-from-one-process-to-another-for-impersonation-i) 在我发布我的问题并且我正在使用它的内容之后。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T15:30:26.140

我正在发布我自己的问题的答案，以向未来的读者确认缺少其他答案已经意味着什么——不要这样做。

我认为我的问题的核心是我试图让一个匿名进程（在系统帐户下运行的网站会话）以 Microsoft / Active Directory 不支持的方式（也不是大多数理智的安全性）向收件人（WCF 服务）标识自己战略家）。我试图在通信内容中传递身份，而不是作为通信协议的一部分。在我的网络和系统安全速成课程中，这将是一个非常危险的策略。

简而言之，一端需要对 Active Directory（第 3 方软件）进行身份验证，而另一端需要匿名（网站会话）。

展望未来，我们有两种可能的解决方案——围绕通信构建我们自己的安全性，以便我们可以尽可能安全地传递 Active Directory 名称/密码，或者说服第 3 方供应商放宽他们的身份验证要求（即票务代理）。

# python - 从文本文件中删除特定字符串后的多行，然后替换为新文本

> ID：14166132
> 
> 赞同：1
> 
> 时间：2013-01-04T22:37:12.107
> 
> 标签：python

我正在尝试编写一个可以读取目录中多个 .xml 文件的脚本当找到特定字符串（每个文件都有此脚本）时，我需要它删除该字符串之后的所有内容并将其全部替换为新内容（如果这更容易，可以从另一个文件中提取）。

这里有很多行被删除/写入。

目前我正在手动浏览文件并删除字符串后面的所有文本，然后保存文件并运行这个 python 脚本：

```
import fileinput
import sys
import os

os.chdir("F:\Desktop\PyTest")
rootdir='F:\Desktop\PyTest'

for subdir, dirs, files in os.walk(rootdir):
    for file in files:
        f=open(file, 'r')
        lines=f.readlines()
        f.close()
        f=open(file, 'a')
        f.write("\n      <Text>Lorem Ipsum</Text>")
        f.write("\n      <Text>Lorem Ipsum</Text>")
        f.write("\n      <Text>Lorem Ipsum</Text>")
        f.write("\n      <Text>Lorem Ipsum</Text>")
    f.close 
```

我花了一段时间从教程中拼凑起来，虽然我已经设法找到教程来搜索特定字符串并替换它，但我无法删除字符串后的所有内容并替换为新的。

任何建议将不胜感激 ：）

不必在 Python 中，但我正在运行 Windows 环境。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:50:51.507

对于大文件来说，这显然不是最快的实现，但应该可以。

```
for subdir, dirs, files in os.walk(rootdir):
    for file in files:
        output=[]
        with open(file, 'r') as inF:
            for line in inF:
                output.append(line)
                if 'criteria' in line: break
        f=open(file, 'a')
        Lorem_list=['Lorem Ipsum','Lorem Ipsum','Lorem Ipsum']
        #The '\n' may look strange, but I am using your previous syntax.
        #This also will result in a blank line. I would suggest revising the
        #way you place text to follow the (x+'\n') format.
        [f.write(x) for x in output]
        [f.write('\n      '+x) for x in Lorem_list]
        f.close() 
```

将“条件”替换为您要查找的字符串。

要清楚：

```
Lorem_list=['Lorem Ipsum','Lorem Ipsum','Lorem Ipsum']
[f.write('\n      '+x) for x in Lorem_list] 
```

方法：

```
 f.write("\n      Lorem Ipsum")
    f.write("\n      Lorem Ipsum")
    f.write("\n      Lorem Ipsum") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:48:11.703

如果你想在一个特定的字符串正则表达式听起来像你的东西之后删除所有东西！类似这样的东西：

```
import re

def trim(test_string, removal_string):
    return re.sub(r'^(.*?)('+ removal_string + ')(.*)$', r'\1' + r'\2', test_string)

example = "I want to remove everything after quips, this for instance is useless"
print trim(example, 'quips')

returns "I want to remove everything after quips 
```

"

希望有帮助

如果要对文件执行此操作，则可以像这样调用上面的代码：

```
def cleanFile(file_path):
    with open(file_path) as master_text:
        return trim(master_text) 
```

就那么简单。如果您可以将开放行稍微详细地写为

```
with open(file_path, 'r').read() as master_text: 
```

如果你想让它更清楚一点，但它应该做同样的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T22:54:50.453

如果您正在编辑 XML，您希望查看像[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)这样的 XML 编辑器。

至于你问什么，假设这是我们的字符串：

```
str = """Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum libero sem, 
sollicitudin nec bibendum nec, condimentum sed magna. Duis malesuada, mi vel aliquet auctor, 
mi dui molestie massa, ac dapibus velit justo ut lorem. Donec fermentum euismod elementum. 
Etiam et ligula nisi, in porta lacus. 0 Nam laoreet, ligula pretium facilisis eleifend, 
purus dolor commodo nisi, eget iaculis dolor arcu eu neque. Integer sit amet blandit est. In 
eu ipsum nec turpis sagittis tincidunt""" 
```

并且您想在 0 个新内容之后替换所有内容。

```
new_stuff = '''
               No breeze, O majestic nose, can give thee cold - save when the north 
               winds blow.
            '''

better_string = str[0:str.index('0')] + new_stuff 
```

# asp.net - 是/否字段（访问）在下拉列表中显示为真/假，而不是 0/1 根据 db

> ID：14166135
> 
> 赞同：1
> 
> 时间：2013-01-04T22:37:31.890
> 
> 标签：asp.net, sql, vb.net, ms-access, ms-access-2003

Dropdownlist 由 accessdatasource 驱动，该`[Being Used]`字段是`Yes/No`access 中的一种数据类型，它`0/1`作为输入，但 dropdownlist 将值显示为`True/False`而不是`0/1`or `Yes/No`。所以当我选择 fasle/true 我得到一个数据类型不匹配错误，如何解决这个问题？任何帮助表示赞赏！

```
 <asp:DropDownList ID="DropDownList5" runat="server" AppendDataBoundItems="True" AutoPostBack="True" CausesValidation="True" DataSourceID="AccessDataSource6" DataTextField="Being Used in Target" DataValueField="Being Used" EnableViewState="True">    
<asp:ListItem Selected="True" Text="Select Being Used or not" Value= '2' ></asp:ListItem>
        </asp:DropDownList>

           <asp:RequiredFieldValidator ID="RequiredFieldValidator4" runat="server" 
           ControlToValidate="DropDownList5"></asp:RequiredFieldValidator>

        <asp:AccessDataSource ID="AccessDataSource6" runat="server" DataFile="~/App_Data/SimSEAT.mdb"
            SelectCommand="SELECT DISTINCT test.[Being Used] FROM `test` WHERE 
            ((Labs.[Lab Name])= [WhichLabName] OR [WhichLabName] = '0') AND
            (((Labs.[Target])= [WhichTarget] OR [WhichTarget] = '0')  
             )">

        <SelectParameters>
            <asp:ControlParameter ControlID="DropDownList3" Name="Lab Name"   PropertyName="SelectedValue"/>
            <asp:ControlParameter ControlID="DropDownList4" Name="Target"   PropertyName="SelectedValue" />

            </SelectParameters>
        </asp:AccessDataSource> 
```

# html - 无法识别网站上垂直线的来源

> ID：14166138
> 
> 赞同：2
> 
> 时间：2013-01-04T22:37:36.180
> 
> 标签：html, css

我正在使用 JS Bin 开发一些高级 JavaScript。我目前的项目可以在[http://jsbin.com/uciviy/20](http://jsbin.com/uciviy/20)看到。

但是，此时此页面显示一条垂直的灰线。（它在 Sales Costing 标题的右侧可见，并继续到页面底部。）

我似乎无法确定是什么原因造成的。不管怎样，我不想要。谁能看到它来自哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T22:42:55.327

您的 HTML 正文似乎有一个 CSS 样式，它在 master.css 中添加了一个背景图像，其来源为“../images/leftmenu_background.gif”，我相信它正在创建您的垂直线。

这是有问题的图片：[https ://ovation.viperdmc.com/images/leftmenu_background.gif](https://ovation.viperdmc.com/images/leftmenu_background.gif)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T22:45:08.500

在第 1 行的 master.css 中删除此代码

```
 background-image: url(../images/leftmenu_background.gif); 
```

# android - 如何管理已安装的应用程序（必要时具有 root 权限）？

> ID：14166142
> 
> 赞同：5
> 
> 时间：2013-01-04T22:38:09.193
> 
> 标签：android, package, uninstallation

Android 用户可以转到“管理应用程序”（又名“应用程序管理器”）屏幕，选择一个应用程序，然后使用“应用程序信息”屏幕选择在那里做什么。

我希望制作一个允许用户以更简单的方式做出这些选择的应用程序（甚至可能是批处理操作）。

我如何访问那里的每个功能？我需要哪些权限以及无法通过 API 获得的功能，我如何通过 root 访问获得它们？

我正在谈论的功能是：

1.  强制停止。
2.  卸载最后的更新。
3.  禁用。
4.  卸载 - 为此我实际上知道该怎么做，但它当然需要确认：

    ```
    final Uri packageURI=Uri.parse("package:"+packageName);
    final Intent uninstallIntent=new Intent(Intent.ACTION_DELETE,packageURI); 
    ```

5.  切换“显示通知”。

6.  清除数据
7.  清除缓存
8.  清除默认值。我还想知道如何设置为默认值并获取所有已注册的意图及其当前的默认应用程序（将处理它们）。
9.  查看外部和内部存储（和缓存）中的应用存储使用情况

如果你不明白我的意思，这里是 app-info 页面的截图：

![在此处输入图像描述](../Images/39d702efc954f55d2275d758bd4a18b5.png)

* * *

我还发现了一些自 API 1 以来就存在的有趣的 Android 权限，但我找不到任何如何使用它们的示例。此类权限是[`CLEAR_APP_CACHE`](http://developer.android.com/reference/android/Manifest.permission.html#CLEAR_APP_CACHE)、[`DELETE_PACKAGES`](http://developer.android.com/reference/android/Manifest.permission.html#DELETE_PACKAGES)和[`CLEAR_APP_USER_DATA`](http://developer.android.com/reference/android/Manifest.permission.html#CLEAR_APP_USER_DATA)。

我发现的是一个三星代码示例（可[在此处](http://developer.samsung.com/android/samples/Circle-Launcher)获得），它的权限为`CLEAR_APP_CACHE`，但我找不到他们在哪里使用它，如果有的话。

# javascript - 我可以判断滚动条是否已经处理了鼠标滚轮事件吗？

> ID：14166143
> 
> 赞同：3
> 
> 时间：2013-01-04T22:38:22.000
> 
> 标签：javascript, jquery, mousewheel

这是我要完成的工作：

我有一个页面上有一个水平滚动区域，我希望用户能够使用鼠标滚轮事件左右滚动（https://github.com/brandonaaron/jquery-mousewheel/blob/master /jquery.mousewheel.js)——所以我正在我的水平滚动区域上监听鼠标滚轮事件，如果我看到有任何 deltaY 则滚动它。

但是，如果水平滚动条中有一个组件，我希望它垂直滚动，而不是冒泡并在水平滚动条上滚动。

所以假设简化的标记看起来像这样——其中 .horizo​​ntal 提供了一个薄的水平内容，而 #vertical 是垂直可滚动的：

```
<div class="horizontal">
    <div id="noscroll"></div>
    <div id="vertical"></div>
</div> 
```

还有一些 javascript 看起来像这样：

```
$('body').on('.horizontal', 'mousewheel', function(e){
  // check whether e has already triggered a scroll on an element
  if(hasAlreadyScrolledSomething(e)){ // how can I implement hasAlreadyScrolledSomething 
    e.stopPropagation();
  } else {
    // scroll the horizontal scroll bar using deltaY
    // this part is already implemented
  }
}); 
```

鼠标滚轮事件中是否有任何我可以查看的内容？请记住，#vertical 内部可能有东西，所以 e.target 可能不是#vertical，而是内部的东西。

编辑：这里是一些示例代码来查看概念的代码。[http://jsfiddle.net/jTskZ/](http://jsfiddle.net/jTskZ/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T03:50:20.090

考虑一下：

```
$( '.horizontal' ).on( 'mousewheel', function ( e, delta, deltaX, deltaY ) {
    if ( deltaY && !$( e.target ).closest( '#vertical' )[0] ) {
       this.scrollLeft -= ( deltaY * 30 );   
    }
}); 
```

**现场演示：http:** [//jsfiddle.net/jTskZ/1/](http://jsfiddle.net/jTskZ/1/)

因此，在处理程序中，您检查鼠标光标是否位于元素上方*。*`#vertical`如果不是，则进行水平滚动。

# c++ - 有没有什么简单的方法可以在 C/C++ 中获得 Linux 下的夏令时转换时间

> ID：14166145
> 
> 赞同：6
> 
> 时间：2013-01-04T22:38:33.467
> 
> 标签：c++, c, linux, dst

我想通过给定时区或 TZ 环境来获得 Linux 下 DST 的过渡时间。我的方法很愚蠢，给年初的时间然后每小时尝试一次，然后检查本地时间的 tm_isdst 值以获取过渡时间。有一些简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:44:35.630

glibc中有源代码，你可以在这里浏览：http: [//sourceware.org/git/ ?p=glibc.git;a=tree;f=timezone](http://sourceware.org/git/?p=glibc.git;a=tree;f=timezone)

或者您可以在此处使用时区数据库：ftp: [//ftp.iana.org/tz/releases/tzdata2012c.tar.gz](ftp://ftp.iana.org/tz/releases/tzdata2012c.tar.gz)

由于您没有给出特定的时区/位置，因此我无法查找并为您提供确切的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T02:56:30.063

您也可以使用[boost_datetime](http://www.boost.org/doc/libs/1_52_0/doc/html/date_time/local_time.html)。

```
#include <iostream>
#include <boost/date_time/local_time/local_time.hpp>

using namespace boost::local_time;
using namespace boost::posix_time;

int main()
{
  tz_database tz_db;
  tz_db.load_from_file("/path_to_boost/boost/libs/date_time/data/date_time_zonespec.csv");
  time_zone_ptr zone = tz_db.time_zone_from_region("America/New_York");
  ptime t1 = zone->dst_local_start_time(2013);
  ptime t2 = zone->dst_local_end_time(2013);
  std::cout << t1 << std::endl;
  std::cout << t2 << std::endl;
} 
```

一些相关的SO链接： [c ++如何在考虑夏令时的情况下找到国外的时间？](https://stackoverflow.com/questions/8318024/c-how-to-find-the-time-in-foreign-country-taking-into-account-daylight-saving) [您如何获取特定日期某个位置的时区（偏移量）？](https://stackoverflow.com/questions/12251020/how-do-you-get-the-timezone-offset-for-a-location-on-a-particular-date)

但正如 RedX 之前所说，政治可能会改变时区。因此，实际上您的原始解决方案具有使用底层操作系统自动更新的优势。此外，您可以使用二分搜索改进现有解决方案。

# ruby - 如何重构 ruby 代码？

> ID：14166147
> 
> 赞同：2
> 
> 时间：2013-01-04T22:38:41.967
> 
> 标签：ruby, refactoring

嗨，我有一个要重构的代码

```
def gear_type
  @gear_type ||= self.class.gear_types.find{|gears| gears["id"]==source["gear_type_id"]}["text"] if source["gear_type_id"]
end

def brand
  @brand ||= self.class.brands.find{|node| node["id"]==source["brand_id"].to_s}["text"] if source['brand_id']
end 
```

什么是最好的方法？使用评估或定义方法？我已经尝试过了，但是我还没有发现一些错误：

```
%w(gear_type brand).each do |meth|
  define_method(meth){
    instance_variable_get("@#{meth}") rescue
      instance_variable_set("@#{meth}", self.class.send(meth.pluralize).find{|node| node["id"]==source["#{meth}_id"]}["text"]) if source["#{meth}_id"]
  }
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T23:00:05.740

我只是编写一个可以参数化的通用查找器方法：

```
def gear_type
  @gear_type ||= generic_finder :gear_types, "gear_type_id"
end

def brand
  @brand ||= generic_finder :brands, "brand_id"
end

def generic_finder(collection, primary_key)
  self.class.send(collection).each do |object|
    return object["text"] if object["id"] == source[primary_key]
  end if source[primary_key]
  nil
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T22:48:19.367

`instance_variable_get("@#{meth}")`如果未设置实例变量，则不会引发错误，它返回 nil。所以你必须做几乎和你一样的事情：

```
%w(gear_type brand).each do |meth|
  define_method(meth){
    instance_variable_get("@#{meth}") || instance_variable_set("@#{meth}", self.class.send(meth.pluralize).find{|node| node["id"]==source["#{meth}_id"]}["text"]) if source["#{meth}_id"]
  }
end 
```

您还应该重构该行。它上面有很多东西

```
%w(gear_type brand).each do |meth|
  def source(meth)
    @source ||= source["#{meth}_id"]
  end

  def class_meths(meth)
    self.class.send(meth.pluralize)
  end

  def look_for(meth)
    class_meths(meth).find{|node| node["id"] == source(meth)}["text"]
  end

  define_method(meth) do
    value = instance_variable_get("@#{meth}")
    instance_variable_set("@#{meth}", look_for(meth)) if !value && source(meth)
  end
end 
```

这是一个尝试。不确定它是否变得更好，但我认为它更容易阅读。

哦！我刚刚意识到这些方法可能不会在元数据的范围内？方法被调用。但是哦，好吧，我认为这仍然是一个很好的例子:)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-04T22:48:42.567

仅使用 eval 可能更清洁：

```
%w(gear_type brand).each do |meth|
  eval <<-RUBY
    def #{meth}
      @#{meth} ||= self.class.#{meth.plural}.find{|item| item["id"]==source["#{meth}_id"]}["text"] if source["#{meth}_id"]
    end
  RUBY
end 
```

# java - 逗号分隔值的正则表达式

> ID：14166149
> 
> 赞同：1
> 
> 时间：2013-01-04T22:38:43.963
> 
> 标签：java, regex

我是编写正则表达式的新手，所以请帮忙。

我想匹配这个模式（在 Java 中）：

```
"ABC",010,00,"123",0,"time","time",01,00, 10,    10,88,217," ",," " 
```

我得到的数据将始终采用上述格式，具有 16 个值。但格式永远不会改变。

我不是在寻找解析，因为这也可以通过 java split 解析。我将拥有大量这些数据，因此想要捕获前 16 个数据点并与此模式匹配以检查我是否正确接收到它，否则忽略。

到目前为止，我只尝试过这个正则表达式：

```
^(\".\"),.,(\".\"),.,(\".\"),(\".\"),.,.,.,.,.,.,(\".\"),.,(\".\")$ 
```

我仍在构建它的过程中。

我只需要匹配给定池中的模式。我取前 16 个数据点并尝试查看它是否与此模式匹配，否则忽略。

谢谢！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-04T23:03:59.247

这应该可以解决问题。请记住，他并不关心数据点的出现顺序（即它们都可以是字符串或所有数字）。

```
(\s?("[\w\s]*"|\d*)\s?(,|$)){16} 
```

[你可以在这里](http://regexpal.com/?flags=g&regex=%28%5Cs?%28%22%5B%5Cw%5Cs%5D%2a%22%7C%5Cd%2a%29%5Cs?%28,%7C%24%29%29%7B16%7D&input=%22ABC%22,010,00,%22123%22,0,%22time%22,%22time%22,01,00,%2010,10,88,217,%22%20%22,,%22%20%22)试试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-27T15:52:52.480

请在下面的代码中找到包含对**String**、**Number**和**Decimal**的逗号分隔评估的代码。

```
 public static void commaSeparatedStrings() {       
    String value = "'It\\'s my world', 'Hello World', 'What\\'s up', 'It\\'s just what I expected.'";

    if (value.matches("'([^\'\\\\]*(?:\\\\.[^\'\\\\])*)[\\w\\s,\\.]+'(((,)|(,\\s))'([^\'\\\\]*(?:\\\\.[^\'\\\\])*)[\\w\\s,\\.]+')*")) {
        System.out.println("Valid...");
    } else {
        System.out.println("Invalid...");
    }
}

/**
 * 
 */
public static void commaSeparatedDecimals() {
    String value = "-111.00, 22111.00, -1.00";
    // "\\d+([,]|[,\\s]\\d+)*"
    if (value.matches(
            "^([-]?)\\d+\\.\\d{1,10}?(((,)|(,\\s))([-]?)\\d+\\.\\d{1,10}?)*")) {
        System.out.println("Valid...");
    } else {
        System.out.println("Invalid...");
    }
}

/**
 * 
 */
public static void commaSeparatedNumbers() {
    String value = "-11, 22, -31";      
    if (value.matches("^([-]?)\\d+(((,)|(,\\s))([-]?)\\d+)*")) {
        System.out.println("Valid...");
    } else {
        System.out.println("Invalid...");
    }
} 
```

# python - 在 python 源/脚本中查找依赖项

> ID：14166151
> 
> 赞同：4
> 
> 时间：2013-01-04T22:38:53.233
> 
> 标签：python, dependencies, abstract-syntax-tree

我在 Python 中有一堆简单的脚本，它们带有简单的表达式 [1]，例如：

```
C = A+B
D = C * 4 
```

我需要执行它们，但最重要的是我需要知道我依赖的对象是什么；在前一种情况下，对象*A*和*B*是外部依赖项。例如。*鉴于我在一个名为source*的 var 中有以前的代码，我希望能够：

```
deps = { "A" : 1 , "B": 2}
exec source in deps 
```

所以绝对有必要知道如何构建 dict *deps*。

我潜入了*ast* Python 模块，但我不知道。

* * *

[1] 简单的数学聚合，在某种程度上是`for`循环，仅此而已。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T22:46:33.433

您可以使用标准库中的[tokenize](http://docs.python.org/2/library/tokenize.html)模块对Python 源代码进行标记。这将允许您找到脚本中使用的所有变量名称。

现在假设我们将“非依赖”定义为紧接在`=`符号之前的任何变量名。然后，根据您的脚本代码的简单程度（请参阅下面的注意事项），您可以通过这种方式确定不是非依赖项的变量名称：

```
import tokenize
import io
import token
import collections
import keyword

kwset = set(keyword.kwlist)
class Token(collections.namedtuple('Token', 'num val start end line')):
    @property
    def name(self):
        return token.tok_name[self.num]

source = '''
C = A+B
D = C * 4
'''

lastname = None
names = set()
not_dep = set()
for tok in tokenize.generate_tokens(io.BytesIO(source).readline):
    tok = Token(*tok)
    print(tok.name, tok.val)
    if tok.name == 'NAME':
        names.add(tok.val)
        lastname = tok.val
    if tok.name == 'OP' and tok.val == '=':
        not_dep.add(lastname)

print(names)
# set(['A', 'C', 'B', 'D'])
print(not_dep)
# set(['C', 'D'])

deps = dict.fromkeys(names - not_dep - kwset, 1)
print(deps)
# {'A': 1, 'B': 1} 
```

* * *

**注意事项**：

*   如果您的脚本包含简单赋值以外的语句，则`names`可能会填充不需要的变量名称。例如，

    ```
    import numpy 
    ```

    将两者都添加`'import'`到`'numpy'`集合`names`中。

*   如果您的脚本包含使用左侧元组解包的赋值，例如

    ```
    E, F = 1, 2 
    ```

    那么上面的幼稚代码只会识别出`F`它不是依赖项。

# android - 尝试获取片段中媒体文件的资源 ID

> ID：14166153
> 
> 赞同：1
> 
> 时间：2013-01-04T22:39:01.483
> 
> 标签：android, resources, fragment

我正在尝试获取片段中 mp3 文件的资源 ID，但我不知道如何执行此操作。以下代码为资源 ID 返回零。是的，该文件在原始目录中。（我正在使用 ActionBarSherlock，但我不确定这是否重要。）

```
public class NavigationFragment extends SherlockFragment {

  @Override
  public View onCreateView(LayoutInflater inflater,
                         ViewGroup container,
                         Bundle savedInstanceState) {
    View nav =inflater.inflate(R.layout.navigation, container, false);
  } 

  @Override
  public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    try {
        int resourceID = getResources().getIdentifier("bell01", "raw", "com.webnation.yogatest");
        Log.d("We're Here", "resourceID =" + resourceID);

        bell = MediaPlayer.create(getActivity(), resourceID);
    } catch (Exception e) {
        // TODO Auto-generated catch block
        Log.d("Exception", e.toString());
    }
  } //onActivityCreated

} 
```

清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.webnation.yogatest"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="7"
    android:targetSdkVersion="15" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/Theme.Sherlock" >
    <activity
        android:name="com.webnation.yogatest.YogaTestActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".EulaActivity"
        android:label="@string/title_eula_activity" >
    </activity>
  </application>

</manifest> 
```

# c# - WatiN DialogHandler WaitUntilExists 在 IE9 中超时

> ID：14166154
> 
> 赞同：0
> 
> 时间：2013-01-04T22:39:02.387
> 
> 标签：c#, .net, internet-explorer-9, watin

我正在尝试在弹出的对话框中单击“确定”。我读过 IE9 不能很好地与 WatiN 的对话框处理程序配合使用。我正在使用 WatiN-2.1.0.1196-net-4.0。

下面是我的方法。基本上它会进入警报页面。在该页面上，您可以单击每行单独删除或选择多个复选框并批量删除。我抓住了单个警报删除按钮集合中的第一个删除按钮，并检查它是否存在。如果是这样，请单击全选按钮，然后单击删除所有选定的警报按钮。

到目前为止，一切似乎都正常，现在确认删除的对话框已经启动。然后该方法在 browser.waituntilexists() 上超时。

我尝试增加等待时间，并尝试将处理程序类型切换为 DialogHandler、ConfirmDialogHandler、AlertDialogHandler 等。它们似乎都没有找到弹出的对话框窗口。

我需要一个解决方法，以便我可以确认此对话框。

```
 private void DeleteAlerts(Browser browser)
    {
        browser.GoTo(URLs.CompleteUrl + "/alerts.aspx?apid=" + PID);
        while (browser.Page<AlertsAspx>().deleteMessage.Exists)
        {
            var handler = new ConfirmDialogHandler();
            browser.Page<AlertsAspx>().SelectAll.Click();
            using (new UseDialogOnce(browser.DialogWatcher, handler))
            {
                //Assert.Fail("Never Sees Dialog");
                browser.Page<AlertsAspx>().Delete.ClickNoWait();
                handler.WaitUntilExists(50);
                handler.OKButton.Click();
                browser.WaitForComplete();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:45:41.133

这是一种快速而肮脏的方法：

```
 public void ConfirmOKTest()
{
    using (IE ie = new IE("http://localhost/confirmtest.htm"))
    {
        ConfirmDialogHandler handler = new ConfirmDialogHandler();
        using (new UseDialogOnce(ie.DialogWatcher, handler))
        {
            ie.Button("myButton1").ClickNoWait();
            handler.WaitUntilExists();
            handler.OKButton.Click();
        }
        ie.WaitForComplete();
        Assert.AreEqual("Clicked OK", ie.Button("myButton1").Text);
    }
} 
```

编辑：我不知道为什么我的代码没有格式化。

编辑：终于明白了。

# java - 如何解决类版本冲突？

> ID：14166156
> 
> 赞同：0
> 
> 时间：2013-01-04T22:39:22.057
> 
> 标签：java, jar

假设我们有一个依赖于 lib1.jar 和 lib2.jar 的应用程序。

在 lib1.jar 中，它包含例如一些 slf4j-v1 类。

在 lib2.jar 中，它包含相同但不同版本的 slf4j-v2 类。

现在我正在建造自己的罐子。解决版本冲突问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T00:44:56.460

如果有人对答案感兴趣，我最终使用“jarjar”在一个 jar 中重命名包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T01:01:07.260

我认为最简单的方法是合并 lib1.jar + slf4j-v1.jar => lib1.jar 和 lib2.jar + slf4j-v2.jar => lib2.jar，在这种情况下它应该像你一样工作想要它。

# c# - 使用 SignalR Hub 内的 Windsor Castle 工作单元

> ID：14166157
> 
> 赞同：0
> 
> 时间：2013-01-04T22:39:26.403
> 
> 标签：c#, asp.net-mvc, castle-windsor, signalr, windsor-3.0

我正在使用 SignalR 和 Windsor Castle 从事 ASPNET MVC 4 项目。我的 mvc 控制器和 WebApi 控制器可以使用 Castle 正常工作和实例化，但是我的 Unit of Work 类在 SignalR 的集线器内使用时没有实例化。

有什么我想念的吗？

这是我的代码：

**IocConfig 类**

```
public static class IocConfig
    {
        public static IWindsorContainer Container { get; private set; }

        public static void RegisterIoc(HttpConfiguration config)
        {
            // Set the dependency resolver for Web API.
            var webApicontainer = new WindsorContainer().Install(new WebWindsorInstaller());
            GlobalConfiguration.Configuration.DependencyResolver = new WebApiWindsorDependencyResolver(webApicontainer);

            // Set the dependency resolver for Mvc Controllers
            Container = new WindsorContainer().Install(new ControllersInstaller());
            DependencyResolver.SetResolver(new MvcWindsorDependencyResolver(Container)); 
            ServiceLocator.SetLocatorProvider(() => new WindsorServiceLocator(Container)); 
            var controllerFactory = new WindsorControllerFactory(Container.Kernel); 
            ControllerBuilder.Current.SetControllerFactory(controllerFactory); 
        }
    }
} 
```

**WebWindsorInstaller 类**

```
 internal class WebWindsorInstaller : IWindsorInstaller
    {
        public void Install(IWindsorContainer container, IConfigurationStore store)
        {
            container.Register(Component
                .For<RepositoryFactories>()
                .ImplementedBy<RepositoryFactories>()
                .LifestyleSingleton());

            container.Register(Component
                .For<IRepositoryProvider>()
                .ImplementedBy<RepositoryProvider>()
                .LifestylePerWebRequest());

            container.Register(Component
                .For<IGdpUow>()
                .ImplementedBy<GdpUow>()
                .LifestylePerWebRequest());

            container.Register(Classes
               .FromAssemblyContaining<Api.MessagesController>()
               .BasedOn<IHttpController>()
               .If(t => t.Name.EndsWith("Controller"))
               .LifestylePerWebRequest());

        } 
```

**ControllerInstaller 类**

```
public class ControllersInstaller : IWindsorInstaller
    {
        public void Install(IWindsorContainer container, IConfigurationStore store)
        {
            container.Register(FindControllers().Configure(c => c.LifestyleTransient()));

            container.Register(Component
                .For<RepositoryFactories>()
                .ImplementedBy<RepositoryFactories>()
                .LifestyleSingleton());

            container.Register(Component
                .For<IRepositoryProvider>()
                .ImplementedBy<RepositoryProvider>()
                .LifestylePerWebRequest());

            container.Register(Component
                .For<IGdpUow>()
                .ImplementedBy<GdpUow>()
                .LifestylePerWebRequest());
        }

        private static BasedOnDescriptor FindControllers()
        {
            return AllTypes.FromThisAssembly()
                .BasedOn<IController>()
                .If(t => t.Name.EndsWith("Controller"));
        } 
```

**中心**

```
using Microsoft.AspNet.SignalR.Hubs;

[HubName("iServerHub")]
public class IServerHub : Hub
{
    protected IGdpUow Uow;

    public void Send(string name, string message)
    {
        var messagesList = Uow.UdsMessages.GetAll();       
        Clients.All.broadcastMessage(messagesList);
    }
} 
```

在 Send 方法中，Uow 为空。

**控制器继承自这个基类**

```
 public abstract class CustomControllerBase : Controller
    {
        protected IGdpUow Uow { get; set; }
    } 
```

当我在控制器中使用 Uow 时，它会被实例化。我不明白在集线器内使用它的区别。

**笔记**

我正在按照此处找到的有关如何设置 Windsor Castle 以使其与 SignalR 一起使用的说明进行操作，但我无法对其进行测试，因为我收到以下错误（似乎无法创建代理）：

```
Cannot read property client of undefined 
```

表示未创建集线器的代理

这就是我在服务器中的方式

公共类 IServerHub : 集线器

在客户端像这样

var clientServerHub = $.connection.iServerHub;

我可以在这里看到动态创建的文件：

/GdpSoftware.Server.Web/signalr/hubs

那么，为什么没有创建代理？

**这是我的安装程序文件**

```
public class HubsInstaller : IWindsorInstaller
{
    public void Install(IWindsorContainer container, IConfigurationStore store)
    {
        container.Register(Component
            .For<RepositoryFactories>()
            .ImplementedBy<RepositoryFactories>()
            .LifestyleSingleton());

        container.Register(Component
            .For<IRepositoryProvider>()
            .ImplementedBy<RepositoryProvider>()
            .LifestylePerWebRequest());

        container.Register(Component
            .For<IGdpUow>()
            .ImplementedBy<GdpUow>()
            .LifestylePerWebRequest());

        container.Register(Classes.FromThisAssembly()
            .BasedOn<Hub>()
            .LifestyleTransient());
    }
} 
```

提前致谢！吉列尔莫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:43:01.263

你希望它在哪里得到解决？我没有看到那个代码。

我不太了解 ASP.NET MVC，但上次我使用它时，控制器通过构造函数接收依赖项。您的控制器的 ctor 看起来如何？他们是否将 IGdpUow 作为参数？如果不是如何注入？我认为 Windsor 只能在您拥有财产的公共二传手时才能注入 - [Castle Windsor property injection](http://docs.castleproject.org/Default.aspx?Page=How-properties-are-injected&NS=Windsor&AspxAutoDetectCookieSupport=1)。

所以我猜你的控制器有 ctors 而你的 IServerHub 没有（顺便说一句，.NET 这个名字对一个类有点误导）

# python - 在简单的上下文中解释搜索（Sphinx/Haystack）？

> ID：14166161
> 
> 赞同：0
> 
> 时间：2013-01-04T22:39:38.627
> 
> 标签：python, django, search, nosql, full-text-search

您能否解释一下 Sphinx、Haystack 等搜索引擎如何融入 Web 框架。如果您能以 Web 开发新手可以理解的方式进行解释，那将有所帮助。

我为这个问题编写的一个示例用例是图书搜索功能。假设我有一个 noSQL 数据库，其中包含书籍对象，每个对象都包含作者、标题、ISBN 等；像 Sphinx/Haystack/其他搜索引擎这样的搜索引擎如何适应我的数据库来搜索具有给定 ISBN 的书籍？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:50:57.880

首先，Haystack 不是一个搜索引擎，它是一个为现有搜索引擎（如 Solr 和 Whoosh）提供 Django API 的库。

也就是说，你的例子并不是一个很好的例子。您不会使用单独的搜索引擎按 ISBN 进行搜索，因为您的数据库已经在 Book 表上有一个索引，可以有效地进行搜索。搜索引擎可能出现在两个地方。首先，您可以索引本书的部分或全部内容以进行搜索：数据库不太擅长全文搜索，但这是搜索引擎大放异彩的领域。其次，您可以一次性提供针对多个字段的搜索——例如，作者、标题、出版商和描述。

此外，搜索引擎提供了有用的功能，如建议、分面等，您不会从数据库中获得这些功能。

# php - 向正则表达式添加排除项

> ID：14166166
> 
> 赞同：0
> 
> 时间：2013-01-04T22:39:50.803
> 
> 标签：php, regex

我目前有以下正则表达式来解析数据。还有一系列“排除”

```
$userNameArray = (userName1, user Name2, User Name 3);

$re = '/^(?<timeMined>[0-9]{2}:[0-9]{2}:[0-9]{2}) # timeMined 
     \s+
     (?<userName>[\w\s]+)        # user name
     \s+(?:has\s+looted)\s+    # garbage text between name and amount
     (?<amount>\d+)              # amount
     \s+x\s+                     # multiplication symbol
     (?<item>.*?)\s*$            # item name (to end of line)
   /xmu';
preg_match_all($re, $sample, $matches, PREG_SET_ORDER);
foreach ($matches as $value){
    code
} 
```

我的代码当前有一个 if 语句，如果`$value['userName']`在`$userNameArray`其中执行部分代码，如果不是，则执行不同的部分。但是，如果我可以在正则表达式中解析出不良用户，这将变得容易得多。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T23:02:33.863

虽然您可以使用[负前瞻](http://www.regular-expressions.info/lookaround.html)，如

```
$re = '/^(?<timeMined>[0-9]{2}:[0-9]{2}:[0-9]{2}) # timeMined 
     \s+
     (?!user1|user2|user3)       # exclude users <--
     (?<userName>[\w\s]+)        # user name
     \s+(?:has\s+looted)\s+    # garbage text between name and amount
     (?<amount>\d+)              # amount
     \s+x\s+                     # multiplication symbol
     (?<item>.*?)\s*$            # item name (to end of line)
   /xmu'; 
```

这会将重要的应用程序逻辑编码为正则表达式。最有可能的是，您当前的解决方案更易于理解、更具可读性且更易于更改。

# php - ajax PHP 进度条

> ID：14166167
> 
> 赞同：0
> 
> 时间：2013-01-04T22:40:08.800
> 
> 标签：php, jquery, ajax, progress-bar

我有一个代码，它获取一些数据并将其发送到一个 php 页面，该页面生成该过程并最终显示该过程的结果而无需重新加载页面：

所以，我有这个调用 process.php 文件的代码。

```
 $(document).ready(function(){
    $("#btEnviar").click(function (){
      var datos = $("#formulario").serialize();
    $.ajax({
    type: "POST", 
      url: "process.php",
     data: datos, 
     contentType: "application/x-www-form-urlencoded", 
    beforeSend: function() {
    $("#status").html("Enviando...."); 
     },
   dataType: "html",
      success: function(datos){ 
    if(datos == 1){ 
     $("#status").html("Script procesado satisfactoriamente"); 
    }else if(datos == 0){ 
     $("#status").html("Error al procesar script"); 
    }
    }
    });
    });
    }); 
```

可以制作 process.php 的进度条吗？

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T19:46:09.027

您可以使用一些现成的解决方案，例如[Reload Progress Bar](http://codecanyon.net/item/reloadprogressbar-jquery-plugin/5392218)。但是，请先检查这篇文章[使用 jQuery 的文件上传进度条](https://stackoverflow.com/questions/15410265/file-upload-progress-bar-with-jquery)。我希望它有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:01:40.037

你看过[http://php.net/manual/en/session.upload-progress.php](http://php.net/manual/en/session.upload-progress.php)

注意，它在 fastCGI 模式下不起作用

# c++ - 没有重载函数“CVector4::operator”的实例与指定的类型/术语匹配不评估为采用 2 个参数的函数

> ID：14166169
> 
> 赞同：0
> 
> 时间：2013-01-04T22:40:25.817
> 
> 标签：c++, class, matrix, operator-overloading, implementation

我正在尝试在 C++ 中同时实现 Vector4 类和 Matrix4x4 类，以便更好地处理该语言。我环顾四周，似乎没有什么能真正回答我遇到的问题，但如果我错过了什么，我深表歉意。

编辑：原来的错误似乎不再发生（它是由循环包含引起的）。但是，现在我收到以下错误：

```
1>main.cpp(35): error C2064: term does not evaluate to a function taking 2 arguments 
```

我只能想象这是因为我在 CMatrix4x4 中重载了 () 运算符，但是当我从 main() 调用时，它并没有出现在我之前的代码中。

请求的 SSCCE 案例：

```
#include <assert.h>
#include <cmath>
#include <iostream>

class CMatrix4x4;

class CVector4
{
public:
    float x, y, z, w;

    CVector4();
    CVector4(float, float, float, float);
    ~CVector4();

    CVector4    operator*(CMatrix4x4&);
};

CVector4::CVector4()
{
    x, y, z, w = 0;
}
CVector4::CVector4(float cx, float cy, float cz, float cw)
{
    x = cx, y = cy, z = cz, w = cw;
}

//No instance of overloaded function "CVector4::operator" matches the specified type
//<error-type> m
//DOES NOT occur with forward declaration of class, only when including matrix.h
//from a separate file.
//Now causes "term does not evaluate to a function taking 2 arguments" at lines: 35-38
//Whenever I call the overloaded operator ()
CVector4 CVector4::operator*(CMatrix4x4& m)
{
    CVector4 v;
    v.x = x*m(0, 0) + y*m(1, 0) + z*m(2, 0) + w*m(3, 0);
    v.y = x*m(0, 1) + y*m(1, 1) + z*m(2, 1) + w*m(3, 1);
    v.z = x*m(0, 2) + y*m(1, 2) + z*m(2, 2) + w*m(3, 2);
    v.w = x*m(0, 3) + y*m(1, 3) + z*m(2, 3) + w*m(3, 3);
    return v;
}

class CMatrix4x4
{
public:
    CMatrix4x4();
    ~CMatrix4x4();

    void SetRow(int r, CVector4);

    float operator()(int r, int c);

    private:
    float   matrix4x4[4][4];
};

CMatrix4x4::CMatrix4x4()
{
    for(int r = 0; r < 4; r++)
    {
        for(int c = 0; c < 4; c++)
        {
            matrix4x4[r][c] = 0;
        }
    }
}

CMatrix4x4::~CMatrix4x4()
{
}

float CMatrix4x4::operator()(int r, int c)
{
    assert(r >= 0 && r < 4);
    assert(c >= 0 && c < 4);
    return matrix4x4[r][c];
}

void CMatrix4x4::SetRow(int r, CVector4 v)
{
    assert(r >= 0 && r < 4);
    matrix4x4[r][0] = v.x;
    matrix4x4[r][1] = v.y;
    matrix4x4[r][2] = v.z;
    matrix4x4[r][3] = v.w;
}

int main()
{
    CMatrix4x4 m;
    CVector4 vec1(1, 2, 3, 4);
    CVector4 vec2;

    m.SetRow(0, CVector4(1, 0, 0, 0));
    m.SetRow(1, CVector4(0, 1, 0, 0));
    m.SetRow(2, CVector4(0, 0, 1, 0));
    m.SetRow(3, CVector4(0, 0, 0, 1));
    vec2 = vec1 * m;
    std::cout << vec2.x;
    std::cin.ignore();
    return 0;
} 
```

编辑：感谢所有提供帮助的人。我设法通过将函数实现移动到单独的 .cpp 文件来解决这个问题（我应该从一开始就这样做。我不知道为什么我没有这样做），并在其中包含所需的头文件，并在头文件中使用前向声明.

我不确定这是否是正确的解决方案，但它似乎确实有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T23:51:46.227

与之前提出的许多问题相同的问题：您的代码的原始版本显然有两个头文件 -`vector.h`并且`matrix.h`- 相互包含。这是循环包含，没有任何意义。

您可能在头文件中包含的包含保护确保包含不会变得无限。但是它们对解决数据类型之间的循环依赖没有任何作用。您的`CMatrix4x4`中的 完全未知`vector.h`，这会导致错误。

`CMatrix4x4`in的前向声明`vector.h`是朝着正确方向迈出的一步。但是，无论如何，您都必须摆脱这种无用的循环包含。而且你必须记住，这`CMatrix4x4`将是一个不完整的类型`vector.h`，这意味着你将无法访问它的内部`vector.h`。

后者意味着你`CVector4 CVector4::operator*(CMatrix4x4& m)`必须在定义*之后*定义`CMatrix4x4`，而不是之前。在您的代码中，它是之前定义的`CMatrix4x4`。此时类型`CMatrix4x4`仍然不完整，这意味着您不能使用它的`()`运算符。像这样的表达式`m(0, 0)`不会因为这个原因而专门编译。这就是您遇到错误的原因。

PS 另外，

```
x, y, z, w = 0; 
```

没有做你可能认为它会做的事情。它将分配`0`给`w`，但保持其他数据成员不变（阅读 C++ 中的逗号运算符）。

# css - 连续两个圆形边框框？

> ID：14166170
> 
> 赞同：0
> 
> 时间：2013-01-04T22:40:27.980
> 
> 标签：css

```
<style>
#firstname
{
border: 2px solid #3b5998;
padding: 10px 40px;
width: 100px;
background: #daf0ff;

}
</style>
</head>
<body>

<p id="firstname">This is a box,This is a box,This is a box,This is a box,This is a box, </p><p id="firstname">This is a box,This is a box,This is a box,This is a box,This is a box,</p> 
```

在 Bowser 上查看后，它显示不同行中的框....如何将它们放在同一行中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:42:43.967

在您的标签上使用`float: left`或。`display: inline-block``<p />`

**说明：**
您在此处使用块元素 ( `<p />`)。除非您浮动它们，否则它们将始终强制换行。您可以使用内联元素（例如`<span/>`并排显示它们，但这会破坏`padding`. 所以要么`float`他们要么我们混合`display: inline-block`

# c# - 尝试通过 LINQ 读取 XML 属性

> ID：14166173
> 
> 赞同：1
> 
> 时间：2013-01-04T22:40:43.020
> 
> 标签：c#, xml, linq

xDoc 变量加载 XML 内容，但我无法检索任何信息。它返回 NULL：

```
var xDoc = XDocument.Load(Config.CredentialFileName);

//method 1
IEnumerable<XElement> rows = from row in xDoc.Descendants("domain")
                             where (string)row.Attribute("name") == "TEST"
                             select row;
//method 2
var list = xDoc.Descendants("domain")
    .Select(d => new
    {
        name = d.Attribute("name").Value,
        username = d.Attribute("username").Value,
        password = d.Attribute("password").Value //,
    })
    .Where(a => a.name == "TEST")
    .ToList(); 
```

XML 文件：

```
<domains>
  <domain name="TEST" userName="test" password="tSEvmlsmwEkjSxUwrCVf3G6"/>
</domains> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:02:06.993

您的第一种方法适用于您提供的 xml。确保您正在解析具有完全相同结构的 xml。还要检查您是否有至少一个名称等于的域元素`TEST`。并确保您的 xml 中没有定义命名空间。

第二种方法在`userName`属性名称中有错字（你有小写`username`）：

```
var list = xDoc.Descendants("domain")
                .Select(d => new {
                    name = d.Attribute("name").Value,
                    username = d.Attribute("userName").Value, // <-- typo here
                    password = d.Attribute("password").Value
                })
                .Where(a => a.name == "TEST")
                .ToList(); 
```

* * *

另外，我建议使用强制转换而不是读取节点`Value`属性，因为如果节点不存在，获取此属性将引发异常。

```
var domains = from d in xDoc.Descendants("domain")
              let name = (string)d.Attribute("name")
              where name == "TEST"
              select new {
                  Name = name,
                  Username = (string)d.Attribute("userName"),
                  Password = (string)d.Attribute("password")
              }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:48:11.480

见下文。

```
 var xDoc= XElement.Load(Config.CredentialFileName);             

var result =  xDoc.Elements("domain").Where(x => x.Attribute("name").Value.Equals("TEST")).ToList(); 
```

# python - float 类型的子进程参数不可迭代

> ID：14166175
> 
> 赞同：2
> 
> 时间：2013-01-04T22:40:50.320
> 
> 标签：python, python-2.7

运行下面的代码时，子进程模块中出现错误。参数水平偏差和垂直偏差是浮点数，我正在运行一个二进制 .exe 文件卡检测器，它采用命令行浮点参数。

```
 **Traceback (most recent call last):
  File "C:\Python27\card_detection_test\run_card_detection_test.py", line 174, in <module>
    process_dataset(dataset, args)
  File "C:\Python27\card_detection_test\run_card_detection_test.py", line 102, i
n process_dataset
    output_file)
  File "C:\Python27\card_detection_test\run_card_detection_test.py", line 38, in
 run_recognition
    subprocess.check_call(args, stdout=fout, stderr=dmp)
  File "C:\python27\lib\subprocess.py", line 506, in check_call
    retcode = call(*popenargs, **kwargs)
  File "C:\python27\lib\subprocess.py", line 493, in call
    return Popen(*popenargs, **kwargs).wait()
  File "C:\python27\lib\subprocess.py", line 679, in __init__
    errread, errwrite)
  File "C:\python27\lib\subprocess.py", line 855, in _execute_child
    args = list2cmdline(args)
  File "C:\python27\lib\subprocess.py", line 587, in list2cmdline
    needquote = (" " in arg) or ("\t" in arg) or not arg
TypeError: argument of type 'float' is not iterable**

def run_recognition(carddetector,
                 init_path,
                 horizontaldeviation,
                 verticaldeviation,
                 imgwidth,
                 imgheight,
                 input_path,
                 output_file):
carddetector = os.path.abspath(carddetector)
init_path = os.path.abspath(init_path)
input_path = os.path.abspath(input_path)
output_file = os.path.abspath(output_file)
args =[carddetector,
                 init_path,
                 horizontaldeviation,
                 verticaldeviation,
                 imgwidth,
                 imgheight,
                 input_path,
                 output_file]
res = True
dmp = open(output_file + '.dmp', 'w')
out_dir = output_file + '.dir'
curr_dir = os.getcwd()
try:
    fout = open(output_file, 'w')
    try:
        subprocess.check_call(args, stdout=fout, stderr=dmp)
    except subprocess.CalledProcessError:
        print 'runner failed at: ' +  input_path
        res = False
    finally:
        fout.close()
except IOError:
    print 'cannot open', output_file
    res = False
finally:
    dmp.close()
os.chdir(curr_dir)
return res
def process_dataset(dataset, cfg):
print 'processing: ', dataset
item_path = os.path.join(cfg.datasets,dataset)

if not os.path.isdir(item_path):
    print "not a directory:", item_path
    return
run_args = []
files_in_dir = os.listdir(item_path)
for input_file in files_in_dir:
    print 'input file', input_file
    if fnmatch.fnmatch(input_file,'*.png'):
        input_path = os.path.join(item_path, input_file)
        output_file = os.path.join(cfg.output, input_file + '.yaml')
        run_args.append((cfg.carddetector,
                    cfg.init_path,
                    cfg.horizontaldeviation,
                    cfg.verticaldeviation,
                    cfg.imgwidth,
                    cfg.imgheight,
                    input_path,
                    output_file))
        print 'run_args', run_args

        run_recognition(cfg.carddetector,
                    cfg.init_path,
                    cfg.horizontaldeviation,
                    cfg.verticaldeviation,
                    cfg.imgwidth,
                    cfg.imgheight,
                    input_path,
                    output_file) 
```

# java - 硬币翻转码错误/问题

> ID：14166179
> 
> 赞同：2
> 
> 时间：2013-01-04T22:41:05.923
> 
> 标签：java

所以..我正在尝试学习更多Java，并决定创建一个简单的正面/反面硬币翻转，但似乎无法让它工作。在“else”上给出错误，并在“标记“else”上出现语法错误，{ 预期”，但在行尾我已经有一个 {。谁能给我解释一下？或者我做错了什么？谢谢

```
import java.util.Random;

class CoinFlip {
    static int flip;
    public static void main(String[] args) {
    coin();
    }

    static void coin() {
    Random rand = new Random();
    flip = rand.nextInt(2);
    System.out.println("You flipped a " + flip);
    heads(flip);
    }

    static void heads(int flip) {
    if (flip == 1)
        System.out.println("Heads");
    }

         else if (flip == 2) {
         System.out.println("You win! Congratulations!");
         }  
      }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:42:25.530

你错过了一个开**括号**`if statement`

```
 if (flip == 1) {
        System.out.println("Heads");
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T22:42:48.723

这一行： `if (flip == 1)`

应改为：

`if (flip == 1){`

那应该解决它！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T22:45:37.377

正如其他答案所表明的那样，您在`if`-statement 中错过了一个左大括号。我将添加一些其他建议。

*   考虑通过缩进方法中的代码部分来正确格式化代码。这样做会使所有内容都更具可读性（并帮助您找到这样的错误！）。某些 IDE（例如 Eclipse）能够为您自动格式化代码。

*   为什么不做`flip`一个`boolean`？有`true`头`false`有尾。`boolean`是这个变量更合适的类型。如果您进行了更改，则可以使用[`nextBoolean`](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#nextBoolean%28%29)方法 of`Random`而不是`nextInt`。

如果您进行了第二个项目符号中提到的更改，则可以将`if`as

```
if (flip) {
    System.out.println("Heads");
} else {
    System.out.println("You win! Congratulations!");
} 
```

在我看来要清楚得多。

# php - 在 xpath 中合并两个 DOMNodeList

> ID：14166180
> 
> 赞同：7
> 
> 时间：2013-01-04T22:41:15.453
> 
> 标签：php, xpath

我有两个 DOMNodeLists

```
$textNodes = $xpath->query('//text()'); 
```

和

```
$titleNodes = $xpath->query('//@title'); 
```

**如何将它们合并到 DOMNodeLists 以便我可以将它与`foreach`循环一起使用？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-04T22:49:16.823

XPath 支持`|`组合两个节点集的运算符：

```
$textNodes = $xpath->query('//text() | //@title'); 
```

想象一下这个简单的例子：

```
$xml = '<?xml version="1.0"?>
<person>
  <name>joe</name>
  <age>99</age>
</person>';

$doc = new DOMDocument();
$doc->loadXml($xml);
$selector = new DOMXPath($doc);

$nodes = $selector->query('//name | //age');

foreach($nodes as $node) {
    echo $node->nodeName, PHP_EOL;
} 
```

# facebook - 了解 Pinterest 实现 facebook 登录的方式

> ID：14166181
> 
> 赞同：0
> 
> 时间：2013-01-04T22:41:19.253
> 
> 标签：facebook, facebook-javascript-sdk

当我`InspectElement`在 Pinterest 的 facebook 登录按钮上进行操作时，我看到了这个：

```
<a href="/facebook/register/?scope=email,user_likes,user_birthday,publish_actions" class="BigButton facebook" data-network="facebook" data-callback-url="/facebook/register/">
              <span class="logo"></span>
              Facebook
            </a> 
```

我找不到与使用 APP_ID 调用 Facebook JS SDK、设置 cookie、会话等相关的任何内容。
这里是如何实现的？什么是`data-network`和`data-callback-url`标签？它们是由 Pinterest 的开发人员开发的自定义标签吗？
如何使用相同的清洁方法实施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T23:46:20.740

Pinterest 正在使用服务器端登录。因此，您将找不到基于 FB.login 的 FB 客户端 JS SDK 调用。但是，他们似乎使用 JS SDK 来获取登录状态，这就是他们有 FB.init 调用的原因。

这些 'data-' 属性是 HTML5 的一部分。快速搜索将帮助您获得有关如何将其与 JS/JQuery 一起使用以及它如何简化代码的文档。在他们的情况下，他们在 JS 中使用“network”和“callback-url”的值来处理某些事情（我没有看到你上面提到的代码来进一步评论）。

# mercurial - Mercurial：修复具有多个头的存储库

> ID：14166182
> 
> 赞同：1
> 
> 时间：2013-01-04T22:41:34.153
> 
> 标签：mercurial

我的存储库只有两个分支：默认和稳定。我在稳定的分支中弄得一团糟，但我不知道如何修复它。

![当前存储库](../Images/18251cb7d237279acf63011c609776ac.png)

默认分支用于新功能

```
92 is the revision created by the maven-release-plugin.
93 commit on stable
94 merge stable into default
95 to 98 commit on default
99 merge default into stable
100 to 103 commit on stable
104 try to fix the mess with a hg merge -r 98 
```

因为`default`我想要头是`98`。为了稳定，我想回到一个单一的头，包括提交`94`到`98`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T02:30:50.277

`Default`的头应该是98；不是吗？运行`hg heads default`以获取`default`分支上的变更集列表。从你的图表来看，这是 98 并且只有 98。

对于稳定版，听起来您想要`hg merge`提交 103 和 104。为此，更新到其中一个 ( `hg update 103`)，然后将另一个合并到 ( `hg merge 104`) 中。

您仍然需要处理提交 93。您是否也想拥有它`stable`？或者你不想有它的影响？如果你想拥有它`stable`，也只需将它合并。

如果您根本不想要它的影响`stable`，那么您需要做的事情会有所不同，具体取决于发生在它身上的事情。它只是在您的本地计算机上，还是您已经将其推送到上游？如果它只是在您的本地计算机上，则运行`hg strip 93`会将其从您的存储库中删除，并且不会被远程推送。为此，您必须启用[mq 扩展](http://mercurial.selenic.com/wiki/MqExtension)。

如果你已经往上游推了 93，你就不能剥离它。但是，您可以做一个提交，通过更新到变更集 93 来撤消 93 的影响，然后运行`hg backout 93`​​. 然后，您可以将新提交合并到`stable`分支中，就*好像*您从未提交过 93。93 将在您的历史记录中，但它的代码更改已消失。

# php - 可以覆盖 system.xml 吗？

> ID：14166184
> 
> 赞同：2
> 
> 时间：2013-01-04T22:41:44.580
> 
> 标签：php, xml, magento

核心 system.xml 是否可以像块一样被覆盖，通过将它的“版本”放置在原始目录的本地/表示中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T23:36:01.473

执行此操作的官方® 方法是创建一个自定义模块，`<depends />`其中包含您希望覆盖的内容的模块声明。在自定义模块的*system.xml*中，*只*需要包含那些您希望覆盖其文本值的 xpath 的*system.xml 。*这意味着升级时的工作量会减少。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T22:45:23.367

不，因为您在 app/etc/modules/* XML 文件中定义了每个模块的代码池，并且 app/code/code_pool/MODULE/etc/*.xml 中的相应模块文件是针对该配置加载的。

编辑：相比之下，对于 *.php 文件，您可以覆盖，因为这些文件是使用自动加载器加载的，该自动加载器总是在核心之前检查本地之前的社区

Edit2：为了清楚起见：Magento 自动加载器不对 Xml 文件负责。因此，对于 Xml 文件，本地优先于社区的加载优先于核心的加载优先级不成立。但是，您仍然可以通过创建一个本地模块来编辑 Xml，如 Benmarks 的回答中所指出的那样

# c++ - Sublime C++ 指针支持

> ID：14166190
> 
> 赞同：0
> 
> 时间：2013-01-04T22:42:33.643
> 
> 标签：c++, clang, sublimetext2

```
class Test
{
public:

    int i;
};

int main(int argc, char const *argv[])
{
    Test *i = new Test;
    return 0;
} 
```

是否有可能获得对箭头符号的支持？所以如果我写`i.`它会自动扩展为`i->`

我正在使用 SublimeClang。如果不存在这样的东西，是否有可能创建这样的插件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T22:48:03.440

看看[Autohotkey](http://www.autohotkey.com/) for windows，使用本[教程](http://www.autohotkey.com/docs/Hotstrings.htm)。或在 Linux 上按照本[教程使用](http://www.webupd8.org/2009/07/automatic-text-replacement-application.html)[Autokey](http://code.google.com/p/autokey/)。

但是，像克里斯所说的那样，输入一个额外的字符有多难？如果不是一切都是指针怎么办？

# sql - 将一个表中的 ID 链接到另一个表中的数据 - 但在多对多关系中

> ID：14166192
> 
> 赞同：0
> 
> 时间：2013-01-04T22:42:43.390
> 
> 标签：sql, sql-server, database

我一直在看外键和其他东西，因为我有一个任务要完成，所以我试图掌握一切，所以我准备好了。我正在查看[将一个表中的 ID 链接到另一个表中的数据，](https://stackoverflow.com/questions/9720011/linking-id-from-one-table-to-data-in-another-table)答案提到了一种在多对多关系中执行此操作的方法，但我在任何地方都看不到它，所以我想知道该怎么做这个。

在查看链接的问题时，我想要一个示例 many`ContactPerson`可以适用于 many `Company`。

我不确定以这种格式提出问题是否正确，但我认为链接到现有问题而不是重写它更容易。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:51:29.587

您需要一个多对多关系，它由 3 个表组成：

1.  公司
2.  联系人
3.  公司2联系人

这里的例子：http: [//sqlrelationship.com/many-to-many-relationship/](http://sqlrelationship.com/many-to-many-relationship/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T14:06:28.833

只是为了回答我自己的问题，可以在这里找到深入的解释和示例：[http ://www.singingeels.com/Articles/Understanding_SQL_Many_to_Many_Relationships.aspx](http://www.singingeels.com/Articles/Understanding_SQL_Many_to_Many_Relationships.aspx)

# django - 为不同的用户设置 Django 登录以不同的方式过期

> ID：14166195
> 
> 赞同：2
> 
> 时间：2013-01-04T22:42:48.103
> 
> 标签：django, django-authentication, django-sessions

我找到了 SESSION_COOKIE_AGE 和类似的设置，但它们是全局的。是否可以根据不同的用户类型告诉 django 的身份验证模块以不同的方式过期登录？那么，例如，超级用户是否会在一周内到期，而普通用户会在 6 小时（或浏览器关闭时）到期？

我发现它似乎唯一可行的方法是在会话中设置到期时间：

request.session.set_expiry(值)

但是让用户过期似乎不起作用，只是为了摆脱会话数据。

# php - 在模型层注册新用户。我做对了吗？

> ID：14166197
> 
> 赞同：1
> 
> 时间：2013-01-04T22:42:48.837
> 
> 标签：php, oop, model-view-controller, design-patterns, domain-driven-design

在过去的几天里，我一直在阅读关于 DDD 的很多内容，但找不到一个可靠的例子来说明某人如何在他们的网站上简单地注册用户，所以经过大量阅读后，我把它放在一起，我希望得到你的反馈因为我确信它远非完美，它甚至可能是完全错误的，但它是这样的：

**注册控制器**

```
$userMapper = $this->dataMapperFactory->build('user');
if($userMapper->fetchByUsername($username) !== NULL) {
    // Error: The chosen username already exists
}
else {

    if($userMapper->fetchByEmail($email) !== NULL) {
        // Error: The email address already exists
    }
    else {

        $userDO = $this->domainObjectFactory->build('user');
        // Set the properties of the $userDO object here with the ones
        // from the registration form

        // Insert the new user into the database            
        $userMapper->save($userDO);

    }

} 
```

我已经用自己的`FormValidation`类完成了所有表单验证，所以当我将属性添加到 $userDO 对象时，它们都 100% 准备好插入数据库（正确的长度、类型、格式、范围等），那么代码如何看你？

我认为我走在正确的轨道上，我非常感谢有关如何改进我的代码的任何提示。

另外，我检查他们选择的用户名是否已经被使用的方式，有没有更好的方法来做到这一点？而不是每次都创建一个对象来检查？就像我以前用简单的方法做的那样：

```
SELECt COUNT(*) FROM users WHERE username = 'john' 
```

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T21:07:16.610

### 一些与理论相关的“废话”：

您可能知道，MVC 和受 MVC 启发的设计模式的核心概念是[SoC](http://en.wikipedia.org/wiki/Separation_of_concerns)。它要求您将这些模式划分为主要层：表示层和域模型层。

在这种情况下，它很重要，因为您当前的控制器结构包含*应用程序逻辑*（交互域逻辑实体和存储抽象），而控制器应该只负责更改模型层的状态（有时 - 当前视图）基于用户输入。

你最终违反了上面提到的 SoC 和[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)。

> [**注意：**在基于 Web 的 MVC 变体的上下文中，*“用户”*是 Web 浏览器，而不是坐在它后面的人。]

相反，您应该将应用程序逻辑封装在服务中（如[@Gordon](https://stackoverflow.com/questions/14166197/registering-a-new-user-in-the-model-layer-am-i-doing-it-right#comment19627174_14166197)所述）。在完全实现的模型层中，不同的服务变成了类似于*公共*API 的东西，表示层通过它与模型交互。

不过，取消 Gordon 的链接，我建议您的服务范围更广一些。`CommunityService`在用户注册的情况下，我会将其作为`MembershipService`. 就模型层而言，处理用户帐户管理的所有方面的结构。

### 代码位：

在控制器中使用的一种方法如下所示：

```
public function postUser( $request )
{
    $community = $this->serviceFactory->build('Community');
    $community->addUser( $request->getParameter('username'),
                         $request->getParameter('password'),
                         $request->getParameter('repeated_password'),
                         $request->getParameter('email') );
} 
```

虽然这是一种有效的方法，但您可能已经注意到一个可能的问题。即使用户注册只需要最少的数据，您最终传递给服务的参数量也会使其难以使用。

将其传递`$request`给服务**并不是有效的改进**。你最终会违反[得墨忒耳法则](http://c2.com/cgi/wiki?LawOfDemeter)。相反，我会推荐类似的东西：

```
$keys = ['username', 'password', 'repeated_password', 'email'];
$community->addUser( $request->getParameters( $keys ) ); 
```

该`getParameters()`方法的实现类似于：

```
public function getParameters( $keys )
{
    $response = [];
    foreach( $keys as $parameter )
    {
        $response[ $parameter ] = $this->getParameter( $parameter );
    }
    return $response;
} 
```

### 领域逻辑和验证

您提到，`FormValidation`您用来确保您的`User` [域对象](http://c2.com/cgi/wiki?DomainObject)实例接收正确值的某个类。实际上，数据验证是域对象的职责之一。您仍然可以使用单独的验证类来避免代码重复，但这将是一个依赖项，它由域对象的工厂注入以在实例之间共享。

> [**注意：**根据我的个人经验，除了空检查之外，验证的重复很少见。每个复杂的验证规则集都针对一个特定域对象的字段。在我看来，这使得验证类变得非常多余……除非您希望在多个项目之间共享相同的验证类。]

代码流通常是这样的，当您需要存储来自域对象的数据时，您检查它是否没有获取错误状态，如果有错误，您实际上将其转储到会话中，以便在重定向后检索.

```
if ( $user->isValid() )
{
    $sqlMapper->store( $user );
}
else
{
    $sessionMapper->storeUser();
} 
```

在这个用例中，预先验证的输入最终实际上是有害的。

# python - Python：从项目列表中定义构造函数中的属性

> ID：14166198
> 
> 赞同：0
> 
> 时间：2013-01-04T22:42:49.253
> 
> 标签：python, class, properties

我想在我的类的构造函数中声明属性。

MaterialOne 类展示了我目前拥有它的方式。每个属性都必须单独定义。但是，我将有一组相似的属性，我想给出相同的 fset/fget/fdel。

由于需要大量代码来显式编写所有属性，因此我想以更简洁的方式定义属性。因此，我想到让构造函数处理这个问题。MateralTwo 类展示了我的想法。

不幸的是，它不起作用，因为我得到了 TypeErrors：

```
TypeError: get_property() takes exactly 1 argument (2 given) 
```

我可以理解它为什么会抱怨，但我想不出任何解决方案。我不一定要从构造函数的列表中定义属性。我正在寻找的是一种更简洁和干净的定义它们的方法。

```
class MaterialOne(object):
    def __init__(self):
        pass;

    def del_property(attr):
        """Abstract deller"""
        def del_attr(self):
            setattr(self, attr, None);
        return del_attr

    def set_property(attr):
        """Abstract setter."""
        def set_attr(self, x):
            setattr(self, attr, x);            
        return set_attr

    def get_property(attr):
        """Abstract getter"""
        def get_attr(self):
            if getattr(self, attr) is not None:
                return getattr(self, attr); 
            else:
                return 'Some calculated value..'
        return get_attr

    _young = None;
    _shear = None;
    _poisson = None;

    young = property(fget=get_property('_young'), fset=set_property('_young'), fdel=del_property('_young'));
    shear = property(fget=get_property('_shear'), fset=set_property('_shear'), fdel=del_property('_shear'));
    poisson = property(fget=get_property('_poisson'), fset=set_property('_poisson'), fdel=del_property('_poisson'));

class MaterialTwo(object):
    def __init__(self):
        properties = ['young', 'shear', 'poisson'];
        self.create_properties(properties)

    def del_property(attr):
        """Abstract deller"""
        def del_attr(self):
            setattr(self, attr, None);
        return del_attr

    def set_property(attr):
        """Abstract setter."""
        def set_attr(self, x):
            setattr(self, attr, x);            
        return set_attr

    def get_property(attr):
        """Abstract getter"""
        def get_attr(self):
            if getattr(self, attr) is not None:
                return getattr(self, attr); 
            else:
                return 'Some calculated value..'
        return get_attr        

    def create_properties(self, items):
        for item in items:
            storage = '_'+item;
            setattr(self, storage, None);
            setattr(self, item, property(fget=self.get_property(storage), fset=self.set_property(storage), fdel=self.del_property(storage)));

steel = MaterialOne(); 
steel.young = 2e11;
steel.poisson = 0.3;
print steel.poisson
print steel.shear

carbon = MaterialTwo();
carbon.young = 2e11;
carbon.poisson = 0.3;
print carbon.poisson
print carbon.shear 
```

澄清一些关于代码的更多信息。我想写的是材料类，固体、液体、气体，它们每个都是材料的子类。许多材料属性将被分配。有些可以根据已经定义的来计算。例如，给定两个弹性模量，可以计算出第三个。

我现在使用与 MaterialOne 非常相似的东西实现了这一点。然而，随着我获得更多的材料属性，并且还将包括更多此类计算，我想让它更清洁、更有条理。像我在 MaterialTwo 中那样编写它对我来说是一种可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:54:18.463

> ```
> setattr(self, item, property(... 
> ```

这最终是你的问题。由于属性是**描述符**，它们必须绑定到类，而不是实例。您将需要[覆盖`__getattr__()`、`__setattr__()`和`__delattr__()`](http://docs.python.org/2/reference/datamodel.html#customizing-attribute-access)并在那里实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:48:10.663

所有定义都应该`self`作为第一个参数。

这些功能应该是这样的：

```
def del_property(self, attr):
def sel_property(self, attr):
def get_property(self, attr): 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-04T22:52:03.660

当在 Python 中对对象调用方法时，该对象会作为第一个参数静默传递，这就是为什么您会收到错误消息，指出您传递了太多参数。正如其他人所说，您需要将 self 作为函数的第一个参数。

# android - 如何在arm的内联汇编中执行qadd命令？

> ID：14166199
> 
> 赞同：-1
> 
> 时间：2013-01-04T22:42:53.823
> 
> 标签：android, c, assembly, arm, inline-assembly

当我尝试使用`qadd`命令编译内联程序集时出现错误。

> 错误：不能接受宽度后缀 -- `qadd r7,r7,r1'

我知道[ARMv5TE](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0489c/Cihidceh.html)`qadd`支持

> 这些 ARM 指令在 ARMv6 及更高版本以及 ARMv5T 的 E 变体中可用。

C/asm 代码：

```
inline int __qadd(int a, int b) {
    __asm__ (
            "qadd %0, %1, %2" : "=r" (a) : "r" (a), "r" (b));
    return a;
} 
```

我的cpu特点是：

```
LOGI("__ARM_ARCH__='%d'", __ARM_ARCH__);
LOGI("__ARM_HAVE_5TE='%d'", __ARM_HAVE_5TE); 
```

输出：

> __ARM_ARCH__='5'
> __ARM_HAVE_5TE='1'

我有下一个编译器标志：

> LOCAL_CFLAGS += -std=c99 -ffast-math -march=armv5te

此外，我尝试过替换`add`而不是`qadd`- 效果很好，但`qadd`代码无法编译。

我做错了什么？谁能提供汇编中 qadd 命令的工作示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:28:21.130

此处的解决方案[No qsort_r for Android（或如何禁用强制 Thumb 在 Android ARM 代码中使用 CLZ）](https://stackoverflow.com/questions/14033017/no-qsort-r-for-android-or-how-to-disable-force-thumb-to-use-clz-in-android-arm)

> 在您的 Android.mk 文件中，将“.arm”添加到文件名中，它们将被编译为 ARM 模式而不是 Thumb 模式（例如 sort.c.arm）。我在 Android 本机库中混合了 Thumb/ARM 代码，它运行良好。

问题已关闭。

# android - 在 IOS 和 Android 上播放仅 HLS 音频流，但保留音频控制

> ID：14166203
> 
> 赞同：1
> 
> 时间：2013-01-04T22:43:14.290
> 
> 标签：android, ios, html5-audio, jwplayer, jplayer

这里是它的短处。我正在为我正在开发的 iOS/Android 应用程序使用带有 JWPlayer6 的 HLS 流。JWPlayer [http://www.longtailvideo.com/](http://www.longtailvideo.com/)运行良好，可以优雅地回退到其他流媒体和播放器类型。问题是这样的，当我只想在 iOS 中安全地播放音频时，播放器只是一个压缩的黑色矩形，中间有一个播放图标，如果我点击音频它可以正常播放，但它会在 quicktime 窗口中启动文件，并且quicktime 播放器窗口完全覆盖了应用程序，因此您无法收听文件并继续使用该应用程序。

是否有任何可能的方法来播放仅使用实际可嵌入播放器的音频流，而不是在 iOS 和 Android 上启动音频媒体类型的默认机制。

我已经使用 JPlayer 实现了我想要的功能，将 js/css 播放器放置在应用程序底部的固定位置，以便在播放文件时仍然可以浏览应用程序，但这只是演示解决方案我的老板向他展示它是如何工作的，但最终我们将需要一个解决方案，它可以使用播放器安全地流式传输音频，让您将控件保留在页面上的应用程序中，而不是在播放文件后启动 quicktime不会将您返回到应用程序的其他视图。

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-10T14:31:06.180

大声笑...无论如何，我终于找到了在我的特定情况下对我有用的解决方案。由于我们应用程序的 html 部分位于 iOS 上的 webview 中，多亏了 phonegap，我能够执行以下操作。

[iPhone 与 iPad/浏览器上的 HTML5 内嵌视频](https://stackoverflow.com/questions/3699552/html5-inline-video-on-iphone-vs-ipad-browser)

现在播放器终于像 iPad 一样在线播放了。我对此进行了测试，它完美无缺。我还在应用程序代码中未添加 obj-c 标志的情况下对其进行了测试，但它不起作用。这意味着我提供的解决方案仅在您使用 html 和 obj-c （如 phonegap 或 Titanium 等）打包应用程序时才有效。这正是我想要的。现在我可以利用 jw 的所有优点，并且仍然可以很好地使用 iOS，并为我们所有的成员提供出色的用户体验……感谢您的时间和耐心。作为旁注，内嵌音频播放器甚至可以完美地与 Android 一起编写，而不是编辑任何东西所需的 java 代码。让我感到惊讶，因为我知道 HLS 在 Android 上还没有得到很好的支持。

# haskell - 如何将 IOError 异常与本地相关异常结合起来？

> ID：14166205
> 
> 赞同：4
> 
> 时间：2013-01-04T22:43:21.763
> 
> 标签：haskell, exception-handling

我正在构建一个 Haskell 应用程序并试图弄清楚我将如何构建错误处理机制。在实际应用程序中，我正在使用 Mongo 进行大量工作。但是，为此，我将通过对文件进行基本 IO 操作来简化操作。

因此，对于这个测试应用程序，我想读入一个文件并验证它是否包含正确的斐波那契数列，每个值用空格分隔：

```
1 1 2 3 5 8 13 21 
```

现在，在读取文件时，实际上可能有很多事情是错误的，我将[在 Haskell 对单词的用法中调用所有这些异常](http://www.haskell.org/haskellwiki/Error_vs._Exception)。

```
data FibException = FileUnreadable IOError
                  | FormatError String String
                  | InvalidValue Integer
                  | Unknown String

instance Error FibException where
    noMsg = Unknown "No error message"
    strMsg = Unknown 
```

编写一个纯函数来验证序列并在序列无效的情况下抛出错误很容易（尽管我可能会做得更好）：

```
verifySequence :: String -> (Integer, Integer) -> Either FibException ()
verifySequence "" (prev1, prev2) = return ()
verifySequence s (prev1, prev2) =
    let readInt = reads :: ReadS Integer
        res = readInt s in
    case res of
        [] -> throwError $ FormatError s
        (val, rest):[] -> case (prev1, prev2, val) of
            (0, 0, 1) -> verifySequence rest (0, 1)
            (p1, p2, val') -> (if p1 + p2 /= val'
                then throwError $ InvalidValue val'
                else verifySequence rest (p2, val))
            _ -> throwError $ InvalidValue val 
```

之后，我想要读取文件并验证序列的函数：

```
type FibIOMonad = ErrorT FibException IO

verifyFibFile :: FilePath -> FibIOMonad ()
verifyFibFile path = do
    sequenceStr <- liftIO $ readFile path
    case (verifySequence sequenceStr (0, 0)) of
        Right res -> return res
        Left err -> throwError err 
```

如果文件格式无效（返回`Left (FormatError "something")`）或文件的编号乱序（`Left (InvalidValue 15)`），则此函数完全符合我的要求。但如果指定的文件不存在，则会引发错误。

如何捕获 readFile 可能产生的 IO 错误，以便将它们转换为 FileUnreadable 错误？

作为一个附带问题，这甚至是最好的方法吗？我看到了调用者`verifyFibFile`不必设置两种不同的异常处理机制而可以只捕获一种异常类型的优点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T20:13:34.070

你可能会考虑`EitherT`和`errors`包一般。 [http://hackage.haskell.org/packages/archive/errors/1.3.1/doc/html/Control-Error-Util.html](http://hackage.haskell.org/packages/archive/errors/1.3.1/doc/html/Control-Error-Util.html)有一个`tryIO`用于捕捉`IOError`的实用程序`EitherT`，您可以使用它`fmapLT`来将错误值映射到您的自定义类型。

具体来说：

```
type FibIOMonad = EitherT FibException IO

verifyFibFile :: FilePath -> FibIOMonad ()
verifyFibFile path = do
    sequenceStr <- fmapLT FileUnreadable (tryIO $ readFile path)
    hoistEither $ verifySequence sequenceStr (0, 0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T16:32:59.737

@Savanni D'Gerinel：你走在正确的轨道上。*让我们从verifyFibFile*中提取您的错误捕获代码以使其更通用，并稍微修改它，使其直接在 ErrorT 中工作：

```
catchError' :: ErrorT e IO a -> (IOError -> ErrorT e IO a) -> ErrorT e IO a
catchError' m f =
    ErrorT $ catchError (runErrorT m) (fmap runErrorT f) 
```

*verifyFibFile*现在可以写成：

```
verifyFibFile' :: FilePath -> FibIOMonad ()
verifyFibFile' path = do
    sequenceStr <- catchError' (liftIO $ readFile path) (throwError . FileUnReadable)
    ErrorT . return $ verifySequence sequenceStr' (0, 0) 
```

注意我们在*catchError'*中所做的事情。我们已经从`ErrorT e IO a`动作中剥离了 ErrorT 构造函数，也从错误处理函数的返回值中剥离出来，知道之后我们可以通过再次将控制操作的结果包装在 ErrorT 中来重构它们。

事实证明，这是一种常见的模式，可以使用 ErrorT 以外的 monad 转换器来完成。但它可能会变得很棘手（例如，如何使用 ReaderT 做到这一点？）。幸运的是，[monad-control](http://hackage.haskell.org/package/monad-control)包已经为许多常见的变压器提供了这个功能。

monad-control 中的类型签名起初看起来很可怕。从只看一个函数开始：[control](http://hackage.haskell.org/packages/archive/monad-control/0.3.1.4/doc/html/Control-Monad-Trans-Control.html#v%3acontrol)。它具有以下类型：

```
control :: MonadBaseControl b m => (RunInBase m b -> b (StM m a)) -> m a 
```

`b`让我们通过be使其更具体`IO`：

```
control :: MonadBaseControl IO m => (RunInBase m IO -> IO (StM m a)) -> m a 
```

*m是建立在**IO*之上的 monad 堆栈。在您的情况下，它将是*ErrorT IO*。

`RunInBase m IO`是一个魔法函数的类型别名，它接受一个类型的值`m a`并返回一个类型的值`IO *something*`，*这*是一些复杂的魔法，它编码 IO 内整个 monad 堆栈的状态，并让你在`m a`之后重建值，一旦你有“愚弄”只接受 IO 值的控制操作。*control*为您提供该功能，并为您处理重建。

将此应用于您的问题，我们再次将*verifyFibFile*重写为：

```
import Control.Monad.Trans.Control (control)
import Control.Exception (catch)

verifyFibFile'' :: FilePath -> FibIOMonad ()
verifyFibFile'' path = do
    sequenceStr <- control $ \run -> catch (run . liftIO $ readFile path) 
                                           (run . throwError . FileUnreadable)     
    ErrorT . return $ verifySequence sequenceStr' (0, 0) 
```

请记住，这仅在`MonadBaseControl b m`存在适当的实例时才有效。

[这](http://www.yesodweb.com/blog/2011/08/monad-control)是对 monad-control 的一个很好的介绍。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T03:45:41.523

所以，这是我开发的答案。它围绕着被`readFile`包裹成正确的`catchError`陈述，然后被提升。

```
verifyFibFile :: FilePath -> FibIOMonad ()
verifyFibFile path = do
    contents <- liftIO $ catchError (readFile path >>= return . Right) (return . Left . FileUnreadable)
    case contents of
        Right sequenceStr' -> case (verifySequence sequenceStr' (0, 0)) of
            Right res -> return res
            Left err -> throwError err
        Left err -> throwError err 
```

因此，`verifyFibFile`在此解决方案中更加嵌套。

`readFile path`显然有 type `IO String`。在这种情况下，类型为`catchError`：

```
catchError :: IO String -> (IOError -> IO String) -> IO String 
```

因此，我的策略是捕获错误并将其转换为 Either 的左侧，并将成功的值转换为右侧，将我的数据类型更改为：

```
catchError :: IO (Either FibException String) -> (IOError -> IO (Either FibException String)) -> IO (Either FibException String) 
```

我通过在第一个参数中简单地将结果包装到 Right 中来做到这一点。我认为除非成功，否则我实际上不会执行`return . Right`代码的分支。`readFile path`在要捕获的另一个参数中，我以 开头`IOError`，将其包装在 中`Left`，然后将其返回到`IO`上下文中。之后，无论结果如何，我都会将 IO 值提升到`FibIOMonad`上下文中。

我对代码变得更加嵌套的事实感到困扰。我有`Left`价值观，所有这些`Left`价值观都会被抛出。我基本上是在一个`Either`上下文中，并且我认为该类`Either`的实现的好处之一是值将简单地通过绑定操作传递，并且不会执行该上下文中的其他代码。我很想对此进行一些说明，或者看看如何从这个函数中删除嵌套。`Monad``Left`

也许不能。然而，调用者似乎可以`verifyFibFile`重复调用，并且执行基本上停止第一次`verifyFibFile`返回错误。这有效：

```
runTest = do
    res <- verifyFibFile "goodfib.txt"
    liftIO $ putStrLn "goodfib.txt"
    --liftIO $ printResult "goodfib.txt" res

    res <- verifyFibFile "invalidValue.txt"
    liftIO $ putStrLn "invalidValue.txt"

    res <- verifyFibFile "formatError.txt"
    liftIO $ putStrLn "formatError.txt"

Main> runErrorT $ runTest
goodfib.txt
Left (InvalidValue 17) 
```

鉴于我创建的文件，invalidValue.txt 和 formatError.txt 都会导致错误，但这个函数会`Left (InvalidValue ...)`为我返回。

没关系，但我仍然觉得我的解决方案遗漏了一些东西。而且我不知道我是否能够将其转换为使 MongoDB 访问更加健壮的东西。

# php - Symfony 1.4/Doctrine：将日期时间存储为 UTC，但在生成的管理员中显示所有时间为东部时间

> ID：14166206
> 
> 赞同：2
> 
> 时间：2013-01-04T22:43:22.223
> 
> 标签：php, doctrine, timezone, symfony-1.4, symfony-forms

我们有一个带有生成管理应用程序的 Symfony 项目，我们需要将日期时间字段显示为东部时间。现在，Symfony 设置为将所有日期时间值作为 UTC 处理。这是设计使然，因为与该项目挂钩的各种其他事物都处理 UTC 日期时间。我们只需要管理员显示和接受日期时间输入，就好像用户在东部时区一样。

以下是我们为尝试实现这一目标所做的事情的简短列表：

1.  将应用程序 setting.yml 中的 default_timezone 设置更改为“America/New York”。首先，它似乎并没有真正改变日期时间字段在管理员中的显示方式；它似乎只设置 date_default_timezone_set()。其次，我们实际上需要 PHP 来处理 UTC 时间，因为我们的一些辅助函数被编写为假定 UTC。最后，我们需要将日期时间作为 UTC 存储在 MySQL 数据库中，并且因为我们已将它们全部定义为 DATETIME 列（而不是时间戳），据我所知，它们是时区天真的。（不过，我在这里可能是错的。）

2.  修改相关的管理表单对象以在保存/编辑对象时将日期时间从 ET 转换为 UTC，并在编辑表单中预填充相同的值时创建自定义小部件以进行相反的转换。所以这实际上对我们有用，但这里存在重大问题。我们必须创建自定义小部件，例如；不过，这没什么大不了的。我们还必须为每个包含日期时间字段的类修改管理表单。这有点让人头疼。我们还必须向受影响的类添加辅助函数，因为虽然管理表单将显示正确的值，但如果这些日期时间列中的任何一个出现在管理列表中，它们仍将显示为 UTC 时间而不是 ET 时间。然后我们还必须扩展 Timestampable 行为，因为 THOSE 还需要以 UTC 格式显示在 ET/store 中。

3.  覆盖受影响类的 save() 和 load() 函数。我们尝试将我们从管理表单中获得的 ET 日期时间字符串转换为 UTC，并使用内置的 setter 函数更改对象，然后调用父 save()。那工作得很好。然而，试图对 load() 函数做同样的事情却惨遭失败。调用父 load() 函数很好，但使用内置设置器将时间从 UTC 更改回 ET 失败。事实证明 load() 函数实际上并没有执行，据我们所知；当我们尝试为现有对象加载表单时，不会执行 var_dump() 和 exit() 命令。我们仍然不知道为什么这不起作用。

4.  覆盖受影响类的 preSave() 和 postLoad() 函数。我们遇到了与 #4 相同的问题：preSave() 工作正常，但 postLoad() 失败。

5.  覆盖受影响类的 preSave() 函数，然后覆盖类中日期时间字段的相关 getter 函数。这有效，但只有当我们通过访问对象的内部 $_data 数组而不是使用 getter 来获取原始日期时间值时。我们需要这样做，因为显然调用任何 setter 最终也会调用该字段的 getter，导致我们应用太多时区转换。所以这是可行的，但访问 $_data 数组感觉就像一个巨大的黑客，正在乞求被打破。

除此之外，我们只有尚未研究的理论方法。例如，我们可以在 Symfony 中的某个地方修改 datetime 字段本身的定义，无论是在 Doctrine 中还是在其他地方，但我们想不出一个不涉及深入挖掘 Doctrine 核心的地方。

在这一点上，我们有点卡住了。所有这一切似乎都是为了让管理员将日期时间显示为 ET 并将 ET 日期时间作为 UTC 保存在数据库中的大量工作，所以我们一定做错了什么——我们只是不知道我们应该做什么正在做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T00:16:13.180

我们基本上已经完成了 (2) - 数据库和系统时区是 UTC，这是正确和自然的，并且我们有自定义时区感知日期时间小部件和验证器。

我们所做的另一件事是`$model->getDateTimeObject($fieldName)`向我们的学说模型基类添加一个方法（参见[http://oldforum.symfony-project.org/index.php/m/96066/](http://oldforum.symfony-project.org/index.php/m/96066/)），它将返回一个`DateTime`带有相关`DateTimeZone`集的方法。

例如：

```
abstract class ourDoctrineRecord extends sfDoctrineRecord
{
  /**
   * @param string $fieldName
   * @return DateTime
   */
  public function getDateTimeObject($fieldName)
  {
    // chose a relevant timezone based on user/app etc, or throw
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-05T21:40:48.403

问题出在 Doctrine 中，当它使用 getter 时，它会在默认的 Symphony 时区获取新的日期时间，因此必须通过向 ORM 添加自定义日期时间类型来更改这一点，类似于本教程；您可以在哪里使用它来设置和获取 UTC

[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/cookbook/working-with-datetime.html](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/cookbook/working-with-datetime.html)

# r - 避免全局变量

> ID：14166207
> 
> 赞同：6
> 
> 时间：2013-01-04T22:43:22.810
> 
> 标签：r, global-variables

我想制作一个基本的分析工具来收集时间戳并生成带有注释的运行时间。唯一的问题是我无法弄清楚如何在不使用全局变量的情况下做到这一点。实现我想要实现的功能的“正确”方法是什么？如果 R 已经内置了这个功能，那就太棒了，但我在这里真正想弄清楚的是如何避免使用全局变量并编写更健壮的代码。

```
timeStamps = c()
runTimes = list()

appendRunTimes <- function(note) {
  if(length(timeStamps) < 1) {
    timeStamps <<- Sys.time()
  }
  else {
    timeStamps <<- c(timeStamps, Sys.time())
    diff <- timeStamps[length(timeStamps) ] - timeStamps[length(timeStamps) - 1]
    runTimes <<- c(runTimes,  format(diff))
    names(runTimes)[length(runTimes)] <<-  note
  }

}

appendRunTimes('start')
Sys.sleep(4)
appendRunTimes('test') 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T23:40:04.603

这是您使用闭包重写的示例：

```
RTmonitor <- local({
  timeStamps = c()
  runTimes = list()

  list(
    appendRunTimes=function(note) {
      if(length(timeStamps) < 1) {
        timeStamps <<- Sys.time()
      }
      else {
        timeStamps <<- c(timeStamps, Sys.time())
        diff <- timeStamps[length(timeStamps) ] - timeStamps[length(timeStamps) - 1]
        runTimes <<- c(runTimes,  format(diff))
        names(runTimes)[length(runTimes)] <<-  note
      }
    },
    viewRunTimes=function() {
      return(list(timeStamps=timeStamps,runTimes=runTimes))
    })
})

> RTmonitor$appendRunTimes("start")
> RTmonitor$appendRunTimes("test")
> RTmonitor$viewRunTimes()
$timeStamps
[1] "2013-01-04 18:39:12 EST" "2013-01-04 18:39:21 EST"

$runTimes
$runTimes$test
[1] "8.855587 secs" 
```

观察值存储在闭包内，而不是全局环境中：

```
> timeStamps
Error: object 'timeStamps' not found
> runTimes
Error: object 'runTimes' not found
> RTmonitor$timeStamps
NULL
> RTmonitor$runTimes
NULL 
```

更多关于闭包和避免全局变量的阅读：

*   [闭包作为数据合并习语的解决方案](https://stackoverflow.com/questions/7797273/closures-as-solution-to-data-merging-idiom)
*   [local() 与 R 中的其他闭包方法有何不同？](https://stackoverflow.com/questions/7901916/how-does-local-differ-from-other-approaches-to-closure-in-r)
*   [为什么使用 `<<-` 不受欢迎，我该如何避免呢？](https://stackoverflow.com/questions/9851655/why-is-using-frowned-upon-and-how-can-i-avoid-it)
*   [R 和 Stata 中全局变量的危险示例](https://stackoverflow.com/questions/5526322/examples-of-the-perils-of-globals-in-r-and-stata)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-05T17:21:52.930

现在使用 ReferenceClasses 来做到这一点：

```
RTmonitor = setRefClass("RTmonitor",
  fields=list(
    timeStamps="POSIXct",
    runTimes = "list"
    ),
  methods=list(
    appendRunTimes=function(note){
      if(length(timeStamps)==0){
        timeStamps <<- Sys.time()
      }else{
        timeStamps <<- c(timeStamps, Sys.time())
        diff <- timeStamps[length(timeStamps) ] - timeStamps[length(timeStamps) - 1]
        runTimes <<- c(runTimes,  format(diff))
        names(runTimes)[length(runTimes)] <<-  note
      }
    }
    )
  ) 
```

现在您已经定义了一个类，实例化一个对象并使用它：

```
> r = RTmonitor$new()
> r$appendRunTimes("start")
> r$appendRunTimes("test")
> r
Reference class object of class "RTmonitor"
Field "timeStamps":
[1] "2013-01-05 14:52:25 GMT" "2013-01-05 14:52:31 GMT"
Field "runTimes":
$test
[1] "5.175815 secs" 
```

与闭包方法非常相似，但更正式。例如，我必须将`timeStamps`字段定义`POSIXct`为 。您也可以通过`RTmonitor`这种方式创建多个对象并且它们独立工作——您必须编写一个封装了闭包的闭包构造函数才能做到这一点。

# ruby - 如何在 Heroku 中设置 postgres 数据库

> ID：14166210
> 
> 赞同：4
> 
> 时间：2013-01-04T22:43:53.700
> 
> 标签：ruby, postgresql, heroku

我对 Heroku 和 Postgres 完全陌生，我正在尝试弄清楚如何在 Heroku Ruby 应用程序中设置和访问 Postgres 数据库。

我不确定如何进行设置。我找到了一些有关使用该命令的信息：

`rake db:create`

我在哪里输入这个命令？我对此一无所知。

任何有关如何在 Heroku 中设置/访问 Postgres 数据库的帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T02:11:23.663

如果没有关于您正在构建什么类型的 Ruby 应用程序、您可能正在使用什么 gem 或者您可能正在构建什么框架的信息，就不可能完全指导您如何将您的 Ruby 应用程序连接到 Heroku Postgres 数据库。但这里有几件事可以为您指明正确的方向：

*   按照@jordan.baucke 的建议安装[Heroku Toolbelt 。](https://toolbelt.heroku.com/)除了添加插件之外，您还将在几乎所有与 Heroku 相关的操作中使用此工具带。只需点击链接，下载并安装。简单的！
*   现在您有了工具带，从命令行登录到您的帐户：`heroku login`.
*   现在制作你的应用程序。在您的应用程序文件夹中（在命令行上），执行：`heroku apps:create <app name> -s cedar`.
*   现在添加 Postgres 数据库：`heroku addons:add heroku-postgresql:dev -a <app name>`
*   在 Ruby 中，您可以通过环境变量连接到数据库：`ENV['DATABASE_URL']`.
*   通过 git: 部署应用程序`git push heroku master`。

从这里开始，我们真的不能给你任何进一步的指导，因为我们不知道你是如何与 Postgres 交互的。但上述步骤至少应该让您能够从 Heroku 应用程序连接到数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T22:56:41.853

首先，您使用的是[Heroku 工具带](https://toolbelt.heroku.com/)吗？（命令行工具？）

您也可以从网站上执行此操作，但使用工具带，您可以输入`heroku addons:add heroku-postgresql:dev --app *your app name*`

当您将应用程序部署到 Heroku 时，Heroku 会自动将数据库注入您应用程序的 database.yml。

最后，您需要将生产数据库迁移到当前迁移。您可以再次使用工具带远程执行此操作：

```
$ heroku run rake db:migrate 
```

这将远程连接控制台并将您的迁移拉入服务器上的生产数据库。

# php - 在另一个字符串 [php] 中找到一个字符串 - 出于某种原因匹配所有？

> ID：14166211
> 
> 赞同：0
> 
> 时间：2013-01-04T22:43:55.580
> 
> 标签：php, regex

我正在尝试将表单提供的 UTC 时间和表单提供的事件名称字符串与从文件中读取的数组进行匹配。问题是它似乎总是匹配，即使它不应该匹配。文件的格式将始终保持不变，所以我知道我会在双引号内寻找一个值，所以在使用 strpos() 无法获得结果后，我尝试了 preg_match ...现在匹配所有内容。代码和示例输出如下（$utc 和 $event_name）在我们到达这里时已经设置并正确）：

```
$match1 = "/\"{$utc}\"/";
       $match2 = "/\"{$event_name}\"/";
       print "Match Values: $match1, $match2<p>";

foreach($line_array as $key => $value) {
   print "Value = $value<p>";

   if ((preg_match($match1,$value) == 1) and (preg_match($match2,$value) == 1))
   {
       print "Case 1 - False<p>";
   } else {
      print "Contains targets: $value<p>";
      //code to act on hit will go here
   }
} 
```

这就是返回的内容：

```
Match Values: /"1371033000000"/, /"Another test - MkII "/

Value = { "date": "1357999200000", "type": "meeting", "title": "Plant and Animal Genome     Conference, San Diego, CA", "description": "NCGAS to present at Plant and Animal Genome   Conference, San Diego, CA", "url": "http://www.event1.com/" }

Contains targets: { "date": "1357999200000", "type": "meeting", "title": "Plant and Animal Genome Conference, San Diego, CA", "description": "NCGAS to present at Plant and  Animal Genome Conference, San Diego, CA", "url": "http://www.event1.com/" }

Value = { "date": "1357693200000", "type": "meeting", "title": "Testing Addition",  "description": "This is a fake event.", "url": "http://pti.iu.edu" }

Contains targets: { "date": "1357693200000", "type": "meeting", "title": "Testing Addition", "description": "This is a fake event.", "url": "http://pti.iu.edu" }

Value = { "date": "1371033000000", "type": "meeting", "title": "Another test - MkII", "description": "This is a fake event.", "url": "http://pti.iu.edu" }

Contains targets: { "date": "1371033000000", "type": "meeting", "title": "Another test - MkII", "description": "This is a fake event.", "url": "http://pti.iu.edu" } 
```

我应该只匹配最后一个，但它们都匹配。我一直在玩正则表达式，似乎找不到合适的魔法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:12:26.557

简化它并得到我想要的：

```
foreach($line_array as $key => $value) {
   print "Value = $value<p>";
   if (preg_match("/$utc/",$value) and preg_match("/$event_time/",$value))
   {
       print "Contains targets: $value<p>";
   } else {
       print "Case 1 - False<p>";
      //code to act on hit will go here
   }
} 
```

但是答案 2 让我朝着正确的方向前进。谢谢，伊恩！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:49:23.533

您不需要在双引号字符串中做任何奇怪的事情，只需将变量按原样放入...

```
$match1 = "/$utc/";
$match2 = "/$event_name/"; 
```

我怀疑您的正则表达式正在寻找零长度字符串。

此外，这一行不需要这么多括号......

```
if (preg_match($match1,$value) == 1 and preg_match($match2,$value) == 1) {
    [...]
} 
```

# c++ - c++ UTF-16 ofstream文件创建Windows

> ID：14166213
> 
> 赞同：0
> 
> 时间：2013-01-04T22:44:18.793
> 
> 标签：c++, windows, utf-16, ofstream

> **可能重复：**
> [如何使用 unicode 文件名打开 std::fstream（ofstream 或 ifstream）？](https://stackoverflow.com/questions/821873/how-to-open-an-stdfstream-ofstream-or-ifstream-with-a-unicode-filename)

我有一个以 UTF-16 编码的字符串，我想创建一个文件，其中文件的名称就是这个字符串。

UTF-16LE 字符串如下所示：

![在此处输入图像描述](../Images/8bab78cbf0eac0a546ae37d4cb091675.png)

首先，我想确保系统正确地看到并显示这个名称。

我尝试：

```
char *output=some address (points to memory where line is held)
ofstream out(output);
out.close(); 
```

在输出时，我没有得到正确的名称。
看起来像：
![在此处输入图像描述](../Images/e7b84bed62dd26d8f29125dbceb646fa.png)

为了创建突出显示的文件，我附加了 UTF-16LE 标记，未突出显示的文件是仅使用原始 UTF-16 行创建的 - 没有一种方法有效。

是否有一些方法可以在没有 WinApi (CreateFilew) 的情况下仅使用 C++ 功能在 Windows 中创建具有 UTF-16LE 名称的文件？

我的编译器是 MinGW 4.0.4，Windows XP（但我希望它可以在所有 Windows 上运行）

提前感谢您的任何提示！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T01:28:24.827

谢谢大家，但在这种情况下，C++ 流似乎是无能为力的（至少我有这样的意见）。

所以我使用了 WinApi：

```
 #ifndef WIN32    // for Linux
   ofstream out(output);
   out.close();
 #else  // for Windows
   LPWSTR lp=(LPWSTR )output;
   CreateFileW(lp,GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ |  
        FILE_SHARE_WRITE,     NULL,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,NULL );
  #endif 
```

我得到了一个名称正确的输出文件：

![在此处输入图像描述](../Images/8fe58a1e86ef620929c5258e4318182d.png)

再次感谢！

# php - php会话安全

> ID：14166217
> 
> 赞同：3
> 
> 时间：2013-01-04T22:44:29.630
> 
> 标签：php, session

我不久前查过这个，它对我来说仍然很模糊。当我使用它时，我想知道以下关于会话的事情是否正确：`$_SESSION['username'] = "pete";`

*   `$_SESSION`是一个全局变量，只能在服务器上更改
*   何时`$_SESSION['username']`声明 cookie 将在客户端设置
*   这意味着客户端可以查看数据但不能编辑它
*   何时`$_SESSION['username']`声明 cookie 也将在服务器端设置

如果第三个陈述为真，那么为什么我登录后找不到包含用户名的 cookie？我确实找到了一个会话 cookie，但它包含一个类似`tkcsq66lucpra9m7j3ogqol5h7`. 现在还不是一个名字是吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-04T22:47:56.117

> `$_SESSION`是一个全局变量，只能在服务器上更改

这是一个超级全局的……但是在脚本执行之间填充了保存的数据。

> 何时`$_SESSION['username']`声明 cookie 将在客户端设置

不会。会话开始时会创建一个 cookie（除非设置已被修改）

> 这意味着客户端可以查看数据但不能编辑它

不，cookie 包含会话 ID，而不是数据

> 何时`$_SESSION['username']`声明 cookie 也将在服务器端设置

Cookie 仅存储在客户端上。数据将存储在服务器上，并将与存储在发送到浏览器的 cookie 中的标识符相关联。

> 如果第三个陈述为真，那么为什么我登录后找不到包含用户名的 cookie？

这不是真的。

> 我确实找到了一个会话 cookie，但它包含类似 tkcsq66lucpra9m7j3ogqol5h7 的代码。

那是标识符。

如果您自己构建会话系统（而不是使用 PHP 的内置库），那么您可能会在数据库中存储类似这样的内容：

```
session                     key       value
tkcsq66lucpra9m7j3ogqol5h7  username  pete 
```

然后，会话库可以在会话开始时填充`$_SESSION`，`"username" => "pete"`并在其中接收到 cookie `sessionId=tkcsq66lucpra9m7j3ogqol5h7`。

PHP 的内置系统不是那么便宜和讨厌（而且它是透明的，所以你不需要担心实现细节）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:49:13.823

cookie 中的这个字符串“tkcsq66lucpra9m7j3ogqol5h7”是会话标识符。所有`$_SESSION`数据只能由服务器访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T22:51:29.680

客户端的 cookie 是对服务器端会话内容的引用，无论是用于存储会话的存储机制。

因此，如果您的会话设置将会话数据存储在文件中，那么您的服务器上的某处将有一个名为 tkcsq66lucpra9m7j3ogqol5h7 的文件，其中包含会话数据（或者，如果您将 memcached 用于会话数据，那么将有一个带有该会话密钥的 memcached 密钥）。

# android - 触摸发生时是否可以检测到指纹？

> ID：14166219
> 
> 赞同：5
> 
> 时间：2013-01-04T22:44:46.967
> 
> 标签：android

我试图在用户触摸 android 设备显示屏时获取他们的指纹。有没有办法做到这一点？

像这样的东西：

![指纹](../Images/65ceb2afea875860ffeefd65c39885c9.png)

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-04T22:54:51.040

简短的回答是否定的。触摸屏不够灵敏，无法检测到那一分钟的压力差异或区分靠近的触摸。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T22:54:28.930

抱歉，这是不可能的。触摸传感器基于从手指流到屏幕的电流，而指纹传感器则需要分析从手指上流出的油脂。我们还没有！

# java - 在 java 中运行 JFrame 时出现 StackOverflowError

> ID：14166225
> 
> 赞同：-1
> 
> 时间：2013-01-04T22:45:12.657
> 
> 标签：java, stack-overflow

我在java中编写了一个JFrame（framePanel），但是在运行它或通过实例化这个类的一个对象并调用方法'create_ShowGUI（）'从另一个类运行它时，我得到了一个StackOverflowError。

基本上我希望在调用 main() 方法时，调用 initComponents() 方法来初始化我的组件（设置单选按钮，将它们分组，将 Actionlistener 添加到所有单选按钮，创建 JPanel（menuFrame）并将按钮添加到它） . 在 initComponents() 完成其工作后，初始化 JFrame，将 JPanel 添加到其中并最终显示该框架。

你能帮我解决错误吗？

**编辑**：我创建了各种应用程序，但使用的是 NetBeans GUI Builder Tool。这是我第一次尝试从头开始。因此，如果有不清楚的地方，请原谅。

**编辑**：用评论更新代码

**编辑**：顺便说一句，我用 netbeans 编码

代码从这里开始：

```
import java.awt.Container;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import javax.swing.ButtonGroup;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JRadioButton;

/**
 *
 * @author jtech
 * @version 1.0.0
 * 
 * 'c' loop variable is initialized to 1
 * 'c1' loop variable is initialized to 0
 */
public class BankMainMenuFrame 
{      

//    public void BankMainMenuFrame()
//    {                
//        initComponents(); 
//        create_ShowGUI();
//    }

    private void initComponents()
    {
//        JRadioButton defaultOpt = new JRadioButton();
//        defaultOpt.setText(bankMainMenuOpts[0]);
//        defaultOpt.setMnemonic(0x30);
//        defaultOpt.setActionCommand("Default");
//        defaultOpt.setSelected(true);

        //initializes the first button aside the loop that initializes others (default)
        aJB[0] = new JRadioButton();
        aJB[0].setText(bankMainMenuOpts[0]);
        aJB[0].setMnemonic(KeyEvent.VK_0);
        aJB[0].setSelected(true);
        aJB[0].setActionCommand("Default");
        aJB[0].addActionListener(new ActionListener() 
        {
            @Override
            public void actionPerformed(ActionEvent evt)
            {
                aJBActionPerformed(evt, c);
            }
        });

        //the other buttons are initialized here
        while (c < bankMainMenuOpts.length)
        {
            aJB[c] = new JRadioButton();
            aJB[c].setText(bankMainMenuOpts[c]);
            aJB[c].setMnemonic((vK_nums + c));
            aJB[c].setActionCommand(aJB[c].getText());   
            groupRadioButtons.add(aJB[c]);

            aJB[c].addActionListener(new ActionListener() 
            {
                @Override
                public void actionPerformed(ActionEvent evt)
                {
                    aJBActionPerformed(evt, c);
                }
            });

            c++;
        }

        framePanel = new JPanel(new GridLayout(0, 1));

        //buttons will be added to the panel one by one
        while (c1 < bankMainMenuOpts.length)
        {
            framePanel.add(aJB[c1]);

            c1++;
        }

    }

//other methods go here; like 'private void defaultOptActionPerformed(java.awt.event.ActionEvent evt) {}

    public void create_ShowGUI()
    {        
        initComponents();

        menuFrame = new JFrame("Bank Main Manu Program");
        menuFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        menuFrame.add(framePanel); //framePanel is added to menuFrame
        menuFrame.setContentPane(new Container());
        menuFrame.pack();
        menuFrame.setVisible(true);
    }

    public void aJBActionPerformed(ActionEvent e, int optionNum)
    {
      //  aCA_MainMenuFrame.executeSelectedMenuOption(); 
        //calls a method which is in another class & that class isn't posted here due to its large 
       //amount of code         
    }

    public static void main(String[] args)
    {

                //instance of this class is created to call create_ShowGUI() method
                new BankMainMenuFrame().create_ShowGUI();

    }

    //<editor-fold defaultstate="collapsed" desc="variables decrlarations">
    private static char vK_nums = 0x30;
    private static int c = 1, c1 = 0;
    private static String[] bankMainMenuOpts = {"Select an option..",     //[0] (pre-selected)
        "Deposit Money",                                                  //[1]
        "Withdraw Money",                                                 //[2]
        "Display Balance",                                                //[3]
        "Exit Bank Account Program"};                                     //[4]

    private static JFrame menuFrame = null;
    private static JPanel framePanel = null;
    private static JRadioButton[] aJB = new JRadioButton[5];
    private static ButtonGroup groupRadioButtons = new ButtonGroup();

    //</editor-fold>   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:40:19.457

您似乎对 BankMainMenuFrame 的第 135 行有循环依赖。我怀疑构造函数正在循环中执行初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T00:12:12.387

堆栈溢出似乎已得到纠正。剩下两个错误；

```
 while (c < bankMainMenuOpts.length) { //ERROR was <=

   //ERROR menuFrame.setContentPane(new Container()); 
```

# batch-file - 将 DateTime 和 Seconds 批量附加到文件夹名称

> ID：14166234
> 
> 赞同：0
> 
> 时间：2013-01-04T22:45:38.443
> 
> 标签：batch-file

我如何将日期、时间和秒附加到我的所有文件夹名称中。

for /D %%f in (C:\Reports*) 重命名 "%%f" "%%~nxf"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T19:27:18.687

这会将文件夹重命名为以下格式：`Folder Name YYYY-MM-DD-HH-MM`. 抱歉，除非您使用`robocopy`或，否则批量没有秒分辨率`forfiles`。我假设您希望将上次修改的日期和时间附加到文件夹名称上。如果您想要一个不同的日期，您需要指定尽可能多的日期。

年 = `%%V`, 月 = `%%T`, 日 = `%%U`, 时 = `%%W`, 分 = `%%X`, 子午 =`%%Y`

```
@echo off
pushd "C:\Reports"
for /D %%D in (*) do for /f "tokens=1,2,3,4,5,6 delims=/: " %%T in ("%%~tD") do rename "%%~fD" "%%~nxD %%V-%%T-%%U-%%W-%%X"
popd 
```

# shell - Jenkins 通过 ssh 杀死进程（Tomcat）的工作

> ID：14166240
> 
> 赞同：1
> 
> 时间：2013-01-04T22:46:08.893
> 
> 标签：shell, jenkins, kill, exit-code

我正在使用 Jenkins 作业来运行一些简单的 shell 命令（通过 ssh，通过 Jenkins SSH 插件）；这些命令应该关闭正在运行的 Tomcat 服务器：

```
sudo /opt/tomcat/bin/catalina.sh stop
ps xu | awk '/[t]omcat/{print $2}' | xargs -r kill -9 
```

该作业执行良好并且确实终止了Tomcat，但不幸的是它也失败了；完整的输出是：

```
[SSH] executing pre build script:

sudo /opt/tomcat/bin/catalina.sh stop
ps xu | awk '/[t]omcat/{print $2}' | xargs kill -9
[SSH] exit-status: -1
Finished: FAILURE 
```

知道为什么命令的退出代码为 -1 吗？我已经尝试了几种变体，但没有任何运气。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T01:33:17.903

您应该检查`ps xu`. 由于`kill`会按顺序杀死进程，因此如果有多个`tomcat`进程由 产生`ps xu`，其他进程将在第一个终止后自动终止。然后`kill`尝试终止不再存在的进程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-05T19:45:00.597

我怀疑詹金斯不喜欢`no process killed`它的 kill 命令打印不运行。尝试将标准输出重定向到 /dev/null。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-20T10:01:34.023

这些问题有点老了，但当我偶然发现时，这里有另一个建议。

```
ps xu | awk '/[t]omcat/{print $2}' 
```

返回正在运行的 tomcat 和 awk 进程本身，请参见此处

```
<user>     2370  0.0  0.0  26144  1440 pts/7    R+   10:51   0:00 awk /[t]omcat/{print $2} 
```

awk 进程在运行 xargs 之前立即自行结束，因此其中一个 xargs 的退出代码不等于 0。

尝试运行`killall tomcat`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-25T13:10:52.637

你能做到`pkill tomcat`吗？

# javascript - Appfog 与 node.js 如何使用 javascript 访问 mysql 数据库？

> ID：14166243
> 
> 赞同：2
> 
> 时间：2013-01-04T22:46:31.827
> 
> 标签：javascript, mysql, node.js, appfog, node-mysql

我在 appfog 中发布了一个 node.js 应用程序，但是当我尝试使用（[https://github.com/felixge/node-mysql](https://github.com/felixge/node-mysql)）通过 javascript 访问 mysql 数据库时，似乎没有安装“node-mysql”，这样做的方法是什么？appfog 网站上没有文档。谢谢。

服务器app.js的代码：

```
if(process.env.VCAP_SERVICES){
var env = JSON.parse(process.env.VCAP_SERVICES);
var cre = env['mysql-5.1'][0]['credentials'];
}
var Client = require('mysql').Client,
client = new Client();
client.user = cre.user;
client.password = cre.password;
client.host=cre.host;
client.port=cre.port;
client.database=cre.name;
client.connect();

client.query(
    'SELECT * FROM scores ',
    function selectPlayers(err, results, fields) {
        if (err) {
            console.log("Error: " + err.message);
            throw err;
        }
        console.log("Number of rows: "+results.length);
        console.log(results);
        client.end();
    }); 
```

和错误：

```
module.js:340
throw err;
      ^
Error: Cannot find module 'mysql'
at Function.Module._resolveFilename (module.js:338:15) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:58:07.293

你应该添加

```
"mysql": "2.0.x || 2.1.x", 
```

到 package.json 文件中的依赖项，然后执行

```
npm install 
```

您可以在此处查看 Appfog 的[文档](https://docs.appfog.com/languages/node)。有一个关于依赖管理的部分

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T23:02:52.067

Appfog 支持 NPM，这是在 node.js 中安装依赖项的标准方式。

您可以通过控制台执行此操作，也可以`npm install mysql`将 mysql 添加到您的`package.json`文件中并执行`npm install`.

第二种方式将自动为您的应用安装所有依赖项。

来源：[https ://docs.appfog.com/languages/node#node-dep-mgmt](https://docs.appfog.com/languages/node#node-dep-mgmt)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T19:59:00.197

嗨，您只需要在本地下载并安装 node.js，这将在您的机器上启用 npm 命令，然后转到 AppFog 面板上的“服务”部分为您创建 mySQL 服务（VCAP_SERVICES）

当您配置服务并将其绑定到您的应用程序时，AppFog 会创建一个名为 VCAP_SERVICES 的环境变量。

此变量包含一个 JSON 文档，其中包含绑定服务的所有凭据和连接信息的列表。

下面是一个应用程序的环境变量示例，该应用程序绑定了两个 MySQL 数据库服务：

```
{"mysql-5.1":[
{
    "name":"mysql-4f700",
    "label":"mysql-5.1",
    "plan":"free",
    "tags":["mysql","mysql-5.1","relational"],
    "credentials":{
        "name":"d6d665aa69817406d8901cd145e05e3c6",
        "hostname":"mysql-node01.us-east-1.aws.af.cm",
        "host":"mysql-node01.us-east-1.aws.af.cm",
        "port":3306,
        "user":"uB7CoL4Hxv9Ny",
        "username":"uB7CoL4Hxv9Ny",
        "password":"pzAx0iaOp2yKB"
    }
},
{
    "name":"mysql-f1a13",
    "label":"mysql-5.1",
    "plan":"free",
    "tags":["mysql","mysql-5.1","relational"],
    "credentials":{
        "name":"db777ab9da32047d99dd6cdae3aafebda",
        "hostname":"mysql-node01.us-east-1.aws.af.cm",
        "host":"mysql-node01.us-east-1.aws.af.cm",
        "port":3306,
        "user":"uJHApvZF6JBqT",
        "username":"uJHApvZF6JBqT",
        "password":"p146KmfkqGYmi"
    }
}
]} 
```

您可以使用应用程序的特定语言工具来调用环境变量。

在 Java 中：

```
 java.lang.System.getenv("VCAP_SERVICES") 
```

在红宝石中：

```
 ENV['VCAP_SERVICES'] 
```

在 Javascript 中：

```
 process.env.VCAP_SERVICES 
```

在 Python 中：

```
 os.getenv("VCAP_SERVICES") 
```

在 PHP 中：

```
 getenv("VCAP_SERVICES") 
```

# c# - 如何将这些 LINQ 结果加载到我的 ViewModel 类中？

> ID：14166245
> 
> 赞同：11
> 
> 时间：2013-01-04T22:46:47.967
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-3, linq

`PictureGallery`我有一个 LINQ 查询，它返回与我的班级匹配的结果。我需要将它们加载到我的`ViewModel`但我收到以下错误：

> 无法将类型“System.Linq.IQueryable”隐式转换为“System.Collections.Generic.IEnumerable”。存在显式转换（您是否缺少演员表？）

我对 C# 比较陌生。如何将“结果”投射到我的“图片库”viewmddel 类中？

提前致谢！

控制器：

```
//Test MediaID
var MediaID = 75;

//Query Results
var Results = from g in DB.Galleries
              join m in DB.Media on g.GalleryID equals m.GalleryID
              where g.GalleryID == GalleryID
              orderby m.MediaDate descending, m.MediaID descending
              select new { g.GalleryTitle, Media = m };

//Create my viewmodel
var Model = new GalleryViewModel
{
    MediaID = MediaID,
    PictureGallery = Results, //This line throws the error.
    PictureCount = Results.Count()
}; 
```

视图模型：

```
public class GalleryViewModel
{
    public int? MediaID { get; set; }
    public IEnumerable<PictureGallery> PictureGallery { get; set; }
    public int PictureCount { get; set; }
}

public class PictureGallery
{
    public int GalleryID { get; set; }
    public string GalleryTitle { get; set; }
    public int MediaID { get; set; }
    public string MediaTitle { get; set; }
    public string MediaDesc { get; set; }
    public double Rating { get; set; }
    public int Views { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-04T22:51:30.783

将您的查询改写为：

```
//Query Results
var Results = from g in DB.Galleries
              join m in DB.Media on g.GalleryID equals m.GalleryID
              where g.GalleryID == GalleryID
              orderby m.MediaDate descending, m.MediaID descending
              select new PictureGallery {
                                GalleryID = g.GalleryId,
                                GalleryTitle = g.GalleryTitle,
                                MediaID = m.MediaID,
                                MediaTitle = m.MediaTitle,
                                MediaDesc = m.MediaDesc,
                                Rating = m.Rating,
                                Views = m.Views} ; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T22:49:35.690

您正在尝试将 an 设置`IEnumerable<PictureGallery>`为`IQueryable<anonymous>`. 您需要转换为正确的类型：

```
var Model = new GalleryViewModel
{
    MediaID = MediaID,
    PictureGallery = Results
        .Select(r => new PictureGallery {
            GalleryID = r.Media.GalleryID,
            GalleryTitle = r.GalleryTitle,
            MediaID = r.Media.MediaID,
            ... // and so on
        }),
    PictureCount = Results.Count()
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-24T13:04:07.503

然后你可以写 var list = result.ToList();

然后像这样将它传递给视图 return View(list);

您可以像 @model List 一样在您的视图中接受它

其中 ViewModel 是一个简单的类，具有在查询执行后接受结果值的属性。

您可以查看这些附件[Linq 查询、查看模型、查看[在此处输入图像描述](http://i.stack.imgur.com/c4f4y.jpg)[][1]](http://i.stack.imgur.com/c4f4y.jpg)

# regex - 想要检查一个字符串是否包含 -

> ID：14166249
> 
> 赞同：3
> 
> 时间：2013-01-04T22:47:01.200
> 
> 标签：regex, if-statement, lookahead

我在弄清楚如何检查该行是否包含破折号（`-`）然后捕获其中的一部分时遇到了一些麻烦。

这是我可以作为输入的字符串示例：

```
abc,xyz,ijk-a,opq

abc,xyz,ijk,opq 
```

我想提取破折号之前的部分，如果它存在的话，即`ijk`. 如果没有破折号，我只想要`ijk`（如第二个字符串所示）。

以下正则表达式使用带有前瞻断言的 if 条件并完成这项工作，但始终生成一个空组，如此处[Regex code here](http://regex101.com/r/nB8dQ7)所示。我希望只有一个捕获组返回`ijk`。

我认为正则表达式 if 条件只会返回 if 或 else 条件的组，而不是两者。

```
.*,(?(?=.*?-.*?)(.*?)-.*?|(.*?)), 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:52:21.873

使用 Perl 风格的正则表达式：

```
/[^,]*,[^,]*,([^,-]*)/ 
```

使用两个给定情况的示例：

```
perl -lane 'print $1 if /[^,]*,[^,]*,([^,-]*)/;' input 
```

输出

```
ijk
ijk 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T22:51:16.477

尝试类似`'([^-]+)(-([^-]+))?'` 您的字符串，后跟连字符或不加连字符，将在第一个捕获组中。

# objective-c - 是否可以在 Objective-C 中标记具有多个属性的方法？

> ID：14166256
> 
> 赞同：3
> 
> 时间：2013-01-04T22:47:50.607
> 
> 标签：objective-c

在 Objective-C 中，您可以使用不同的属性标记方法，例如 NS_DEPRECATED、NS_RETURNS_NOT_RETAINED 等。

是否可以标记具有多个属性的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T22:49:28.787

当然。把它们都排成一排。

```
- (id)foo NS_RETURNS_NOT_RETAINED NS_DEPRECATED(...); 
```

（请注意，NS_DEPRECATED 并不是真的供您使用。它需要 iOS 或 Mac 版本范围的参数，目的是表明操作系统版本中的可用性。）

# xslt - XSLT 默认模板混淆

> ID：14166259
> 
> 赞同：2
> 
> 时间：2013-01-04T22:48:01.757
> 
> 标签：xslt

我对 XSLT 处理器节点的方式感到困惑，假设我有一个这样的 XML Doc：

```
<object>
        <animal>
                <man men="asd">man1</man>
                <man>man2</man>
                <man>man3</man>
                <man>man4</man>
                <cat>cat1</cat>
                <cat>cat2</cat>
                <cat>cat3</cat>
                <cat>cat4</cat>
        </animal>
        <vehicule>
                <car>car1</car>
                <car>car2</car>
                <car>car3</car>
                <car>car4</car>
        </vehicule>
</object> 
```

当我有一个没有任何模板匹配的 XSLT（如下所示）时，它返回所有文本节点且没有属性节点，没关系

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
</xsl:stylesheet> 
```

但是当我有一个像下面这样的时，它不会返回任何东西：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
        <xsl:template match="object">
        </xsl:template>
</xsl:stylesheet> 
```

是不是如果我有一个父节点的显式模板，我应该有一个父节点的所有子节点的显式模板？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-04T22:52:17.727

您所看到的只是[内置规则](http://www.w3.org/TR/xslt#built-in-rule)的效果，它输出节点的文本值并将模板应用于其所有子节点。

如果你覆盖了内置模板，那么你的模板就会生效。您想对的所有子级[应用](http://www.w3.org/TR/xslt#section-Applying-Template-Rules)内置规则`object`：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:template match="object">
    <xsl:apply-templates select="*" />
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T22:55:34.303

您在 #2 中的规则说什么都不做，所以它什么也不做。你需要在里面写点东西。见[`xsl:copy`](http://www.w3.org/TR/xslt#copying)和[`xsl:apply-templates`](http://www.w3.org/TR/xslt#section-Defining-Template-Rules)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T06:27:43.270

[http://cafeconleche.org/books/xmljava/chapters/ch17.html#d0e31297](http://cafeconleche.org/books/xmljava/chapters/ch17.html#d0e31297)

正如其他人所说，XSLT 默认模板规则的定义方式是，默认情况下，它们将匹配文档的顶部节点，然后递归处理每个子节点，一直到底部。您的模板会覆盖根节点的默认规则，并且没有任何指令可以对它进行任何操作，因此它不会再进一步​​。如果你有这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
        <xsl:template match="object">
            <xsl:apply-templates />
        </xsl:template>
</xsl:stylesheet> 
```

它将使用默认规则继续向下处理。只要您以他们的方式发送处理，您不一定需要做任何特定的事情来处理子节点。

# javascript - Javascript 和 JQuery - IdCeption

> ID：14166261
> 
> 赞同：-1
> 
> 时间：2013-01-04T22:48:08.917
> 
> 标签：javascript, jquery, html

```
var html = $("#inline_content").html();

$(html).$("#chartDIV").html('<div id="chart_div" style="height: 300px; width: 300px;"></div>'); 
```

第 1 行：我收到一个 div 的 html。工作正常！

第 2 行：然后我在这里尝试（它不起作用...）是更改 var html 中的一个元素，因为它是一些无字符串的（就像它在实际文档中一样）div。

那么这怎么可能呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:50:47.337

尝试以下操作：

```
$("#inline_content #chartDIV").html('<div id="chart_div" style="height: 300px; width: 300px;"></div>'); 
```

如果您不打算直接操作 dom 而只是操作克隆，那么您必须执行以下操作。

```
var html = $("#inline_content").clone();
html.find('#chartDIV').html('<div id="chart_div" style="height: 300px; width: 300px;"></div>'); 
```

现在 html 变量包含具有被操纵的 html 的元素的副本。

# java - 将 JTable 保存为文本文件

> ID：14166269
> 
> 赞同：1
> 
> 时间：2013-01-04T22:48:34.590
> 
> 标签：java, swing, jtable

我正在保存一个 .txt 和 .doc 文件，其中包含来自我的 JTable 的数据。在保存的那一刻，它会像在表格中一样放置文本，但由于数据长度不同，它不适合。所以我试图让日期安排如下：

第 1 列名称：第 1 行第 1 列数据

第 2 列名称：第 1 行第 2 列数据

第 3 列名称：第 1 行第 3 列数据

第 4 列名称：第 1 行第 4 列数据

第 1 列名称：第 2 行第 1 列数据

第 2 列名称：第 2 行第 2 列数据

第 3 列名称：第 2 行第 3 列数据

第 4 列名称：第 2 行第 4 列数据

等等

我现在的代码是：

```
private void saveResultsActionPerformed(ActionEvent evt) {

    int returnVal = fileChooser.showSaveDialog(NewJFrame.this);
    if (returnVal == JFileChooser.APPROVE_OPTION) {
        try {
            File file = fileChooser.getSelectedFile();
            PrintWriter os = new PrintWriter(file);
            os.println("");
            for (int col = 0; col < table.getColumnCount(); col++) {
                os.print(table.getColumnName(col) + "\t");
            }

            os.println("");
            os.println("");

            for (int i = 0; i < table.getRowCount(); i++) {
                for (int j = 0; j < table.getColumnCount(); j++) {
                    os.print(table.getValueAt(i, j).toString() + "\t");

                }
                os.println("");
            }
            os.close();
            System.out.println("Done!");
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

但请记住，我的每个表都有不同的列数和行数。我尝试将列和数据保存在数组中，我觉得这是解决问题的正确方法，但我不知道如何按照我提到的顺序打印它，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T23:21:12.110

算法很简单：

```
for (int row = 0; row < table.getRowCount(); row++) {
    for (int col = 0; col < table.getColumnCount(); col++) {
        os.print(table.getColumnName(col));
        os.print(": ");
        os.println(table.getValueAt(row, col));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:41:42.703

下面提供了我制作的一个最小示例。我给出了以下形式的输出：

名字：凯西
姓氏：史密斯
运动：单板滑雪
年数：5

名字：约翰
姓氏：Doe
运动：赛艇
年数：2

```
 String[] columnNames = {"First Name", "Last Name","Sport","# of Years"};

    Object[][] data = {
            {"Kathy", "Smith", "Snowboarding", "5"},
            {"John", "Doe", "Rowing", "2"},
            {"Sue", "Black", "Knitting", "8"},
            {"Jane", "White", "Speed reading", "10"},
            {"Joe", "Brown", "Pool", "20"}
    };

    JTable table = new JTable(data, columnNames);

    for(int row = 0; row < table.getRowCount(); row++) {

        for(int column = 0; column < table.getColumnCount(); column++) {
            System.out.print(table.getColumnName(column) + ": ");
            System.out.println(table.getValueAt(row, column));
        }
        System.out.println(""); // Add line space
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-07T00:33:44.960

以下代码使用子字符串来允许列在文本文件中有序。它有点乱，但第一个 for 循环处理列标题，第二个 for 循环处理所有数据。如果您想更改每条数据的大小，请将 20 更改为您喜欢的大小。

```
BufferedWriter bfw = new BufferedWriter(new FileWriter(
                    "Data.txt"));

            for (int i = 0; i < table.getColumnCount(); i++) {//first loop is used for titles of each column

                String name = String.valueOf(table.getColumnName(i));

                if (name.length() > 20) {//20 (characters long) is the constant I chose to make each value
                    name = name.substring(0, 20);
                } else if (name.length() == 20) {

                } else {
                    String spaces = "";
                    int diff = 20 - name.length();
                    while (diff > 0) {
                        spaces = spaces + " ";
                        diff--;
                    }
                    name = name.concat(spaces);
                }

                bfw.write(name);
                bfw.write("\t");
            }

            for (int i = 0; i < table.getRowCount(); i++) {//for all the data in the Jtable excluding column headers
                bfw.newLine();
                for (int j = 0; j < table.getColumnCount(); j++) {

                    if (table.getValueAt(i, j) == null) {
                        bfw.write("                    ");
                        bfw.write("\t");
                    }

                    else {

                        String name = String.valueOf((table
                                .getValueAt(i, j)));

                        if (name.contains("(")) {
                            name = name.substring(0, name.indexOf("("));
                        }

                        if (name.length() > 20) {
                            name = name.substring(0, 20);
                        } else if (name.length() == 20) {

                        } else {
                            String spaces = "";
                            int diff = 20 - name.length();
                            while (diff > 0) {
                                spaces = spaces + " ";
                                diff--;
                            }
                            name = name.concat(spaces);
                        }

                        bfw.write(name);
                        bfw.write("\t");
                    }
                }
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-11T17:21:47.747

除了已经提供的答案之外，我还实现了一个解决方案，将内容保存到 .csv（逗号分隔值）类型的文本文件中。

*   首先，我创建了一个将 JTable 的内容放入 Object 类型的二维数组的方法。我选择了 Object 类型，因为 JTable 中的各种列可能存储不同类型的数据，例如数字、字符串等。此方法位于我的 GUI 前端：

    ```
     /**
            *
            * This method extrapolates the data from the JTable and places 
            * it into a two-dimensional object array. <p>
            * 
            * It then returns the object array in preparation for writing 
              to disk
            *
            * 
            * @param  aTable - the selected table for rendering into a two-

               dimensional object array
            *
            * @return Object[][] - the two-dimensional object array which 

               shall be written to disk
            * 
            * @see 
            *
            */
            public Object[][] getTableData(JTable aTable)
            {

              int rowCount = aTable.getModel().getRowCount();
              int columnCount = aTable.getModel().getColumnCount();

              Object[][] curTableData = 

                   new Object[rowCount][columnCount];

              for ( int row = 0; row < rowCount; row++)
              {
                for (int column = 0; column < columnCount; column++)
                {

                  curTableData[row][column]  = 
                       aTable.getModel().getValueAt(row,column);

         //         System.out.println("curTableData["+row+"]["+column+"] = "+curTableData[row][column]);

                }
              }

              return curTableData;

            } 
    ```

*   其次，我创建了一个类，负责将二维对象数组的内容（JTable 内容）写入磁盘。这概述如下：

    ```
    import java.io.*;

    /**
    *
    * This class is responsible for writing the 2D object to disk.
    * The 2d Object contains your JTable contents 
    * <p>
    *
    * @author      Mark Burleigh
    * @version     %I%, %G%
    * @since       1.0
    *
    */
    public class WriteJTableContents
    {
    /**
     *
     * This constructor takes in two parameters. It is also responsible
     * for writing the JTable contents to disk (to csv file)
     * 
     * 
     * @param  aData - the JTable data to be saved to disk
     * @param  afile  - the name of the file where the data shall be saved
     * (this is a .CSV type file)
     *
     *
     */
      public WriteRandomSampleData(Object[][] aData, String afile)
      {
            writeToDisk(aData,afile);

      // This method prints the two-dimensional array to the command console
      //  printData();

      }

      /**
      *
      * This method is responsible for writing the contents of a JTable (2d 
      * array object) to disk (csv text file)
      * <p>
      * 
      * @param  aData - the 2D data (Jtable contents) to be stored to disk
      * @param  aDatafile - the file where the data shall be stored
      * to disk. This shall be of type.CSV
      *
      * @return 
      * 
      * @see 
      *
      */
      public void writeToDisk(Object[][] aData, String aDatafile)
      {

        try
         {

            FileOutputStream fout =  new FileOutputStream(aDatafile, false);

            BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(fout));

            //Headers
            bw.append("Script No., Candidate No., Mark, Grade,Script No., Candidate No., Mark, Grade");
            // End of data row (Jable row) so append new line character in csv file
            bw.append('\n');

            for (int row = 0; row < aData.length; row++)
            {

              for (int column = 0; column < aData[row].length; column++)
              {

                if(aData[row][column] == null)
                {
                  bw.append("null");
                  // The comma separated value
                  bw.append(',');
                }
                else
                {
                  /* In my particular example, I am doing some checking on 

                      the 2d array for types: 
                      if the data is not of type null (as checked above)
                      then it must be of type Integer.
                      This is because the 2D data array only contains data of either
                      Integer or null

                      each of these object types have a method called toString().
                      we need this in order to convert the types to a string prior to wrting them to
                      the file.

                  */
                  bw.append(aData[row][column].toString());
                  bw.append(',');
                }

              }//end column loop (inner loop)

              bw.append('\n');

            }//end row loop (outer loop)

            bw.close();

        }
        catch (Exception e)
        {

            e.getStackTrace();
        }

      }//end of readFileFromDisk

      /**
      *
      * These methods is responsible for printing the random sample scripts
      * Into the command console.
      * <p>
      * 
      *
      */
      public void printData()
      {
          //System.out.println();
          //System.out.println("=======WriteRandomSampleData Class===========");
          //System.out.println();

          for (int row = 0; row < data.length; row++)
          {
            for (int column = 0; column < data[row].length; column++)
            {
                System.out.println("data["+row+"]["+column+"] = " +data[row][column]);
            }
          }

      }

    //==================Instance Variables=============================
      // JTable contents hedata
      private Object[][] data;

     //====================Test Driver============================

      public static void main(String args[])
      {
       // file seperator for windows platform '\\'
        String aFileLocation = "C:\\dirA\\subdir1\\subdir2\\";

        // Dummy values - 2D array which stores the contents of a 
        // JTable into a csv text file
         Object[][] testData = new Object [][] {

                        {new Integer(1),new Integer(1),null,null,new Integer(11),new Integer(1),null,null},
                        {new Integer(2),new Integer(1),null,null,new Integer(12),new Integer(1),null,null},
                        {new Integer(3),new Integer(1),null,null,new Integer(13),new Integer(1),null,null},
                        {new Integer(4),new Integer(1),null,null,new Integer(14),new Integer(1),null,null},
                        {new Integer(5),new Integer(1),null,null,new Integer(15),new Integer(1),null,null},
                        {new Integer(6),new Integer(1),null,null,new Integer(16),new Integer(1),null,null},
                        {new Integer(7),new Integer(1),null,null,new Integer(17),new Integer(1),null,null},
                        {new Integer(8),new Integer(1),null,null,new Integer(18),new Integer(1),null,null},
                        {new Integer(9),new Integer(1),null,null,new Integer(19),new Integer(1),null,null},
                        {new Integer(10),new Integer(1),null,null,new Integer(20),new Integer(1),null,null}

                         };
    // SampleData_TEST.csv gets created in the particular directory
    // and the file gets populated with the contents of the JTable
                         new WriteRandomSampleData(testData,aFileLocation2+"SampleData_TEST.csv");

      }
    } 
    ```

生成的 SampleData_TEST.csv 文件的内容概述如下：

[![在此处输入图像描述](../Images/3be8ecaa1cfa108d1d68c7125365863e.png)](https://i.stack.imgur.com/XYEOZ.jpg)

如上所述，csv 文件格式可以在 Microsoft Excel 中打开，它比 .doc 或 .txt 文件更通用（取决于数据类型）

# ios - iOS 的演示叠加层

> ID：14166274
> 
> 赞同：1
> 
> 时间：2013-01-04T22:49:05.840
> 
> 标签：ios, touchesbegan, touchesmoved, first-responder, becomefirstresponder

当我向远程团队演示我的触摸应用程序时，另一端的人不知道我在触摸哪里。为了解决这个问题，我一直在研究一个事件拦截视图/窗口，它可以显示对应用程序的触摸。无论我调用 nextResponder 的变化有多大，我都无法对触摸做出反应并将其传递给下面的控制器。特别是滚动视图不会做出反应，按钮也不会。

有没有办法获取一个事件，获取它的位置，然后将它传递给最初会响应它的组件（下面的控制器）？

**更新：**
我在 UIView 方面取得了一些进展。新视图总是返回 NO 到 pointInside。这适用于触摸开始时，但它不跟踪移动或释放。**是否有向触摸添加手势识别器以跟踪其事件生命周期的策略？**

乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:57:35.953

您可以尝试创建自己的`UIApplication`overrides子类`sendEvent:`。您的实现应`[super sendEvent:event]`根据需要调用和处理事件。

更新您`main.m`的自定义`UIApplication`类的名称并将其作为第三个参数传递给`UIApplicationMain`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T00:39:37.157

经过更多的尽职调查，我发现了我的疏忽。在顶部并显示触摸的层中，需要将用户交互设置为 false。一旦我将其设置为 false，我就可以使用该图层进行显示，同时在下面的图层上捕获事件。这个项目还没有完成，但我离我更近了一步。

保重，乔

# java - java server http server 收到来自 Chrome 的空请求

> ID：14166282
> 
> 赞同：0
> 
> 时间：2013-01-04T22:49:25.277
> 
> 标签：java, http, sockets

当从 Chrome 向 localhost 发送请求时，程序会收到两个请求：一个（可能是两个）空请求和一个带有普通 HTTP 请求的请求。
当我对 Firefox 执行相同操作时，有时会收到一个空的 HTTP 请求，其他的都很好。
我认为它与favicon有关，我不确定为什么没有任何东西`outputStream`

```
ServerSocket server=null;
Socket socket;
try 
{   server=new ServerSocket(80);
    while(true)
    {   try 
        {   socket = server.accept();
            Worker worker=new Worker(socket);
            (new Thread(worker)).start();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

....
//Worker.java

public class Worker implements Runnable 
{   private Socket socket;
    public void run()
    {   try 
        {   InputStream inStream = new BufferedInputStream(
                                                     socket.getInputStream());
            byte[] array = new byte[1000];
            ByteArrayOutputStream outputStream = new ByteArrayOutputStream( );
            while(inStream.available()>0)
            {   outputStream.write(array);
            }
            System.out.println("-----------------------------------------");
            System.out.println(outputStream);
            System.out.println("-----------------------------------------");

            } 
            catch (IOException e) 
            {   e.printStackTrace();
            }
            try 
            {   socket.close();
            } 
            catch (IOException e) 
            {   e.printStackTrace();
            }
        }
        public Worker(Socket socket)
        {   this.socket=socket;
        }
    } 
```

来自 Chrome 的示例请求：

```
-----------------------------------------

-----------------------------------------
-----------------------------------------

-----------------------------------------
-----------------------------------------
GET / HTTP/1.1
Host: localhost
Connection: keep-alive
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3

----------------------------------------- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:59:24.843

available() 不是流结束的有效测试。请参阅 Javadoc。您应该逐行阅读所有标题，直到出现空行。

# eclipse - Tomcat 转到 jsp、servlet 等 jar 和崩溃的 .m2 目录

> ID：14166286
> 
> 赞同：-1
> 
> 时间：2013-01-04T22:49:29.553
> 
> 标签：eclipse, tomcat, maven

我无法让 Tomcat 在启用 maven 的项目上运行 JSP（Eclipse 3.7，Tomcat 6 上有最新的 m2 插件，在 Eclipse Java EE 中作为服务器运行）：

```
java.lang.NullPointerException
    at org.apache.jsp.index_jsp._jspInit(index_jsp.java:22) 
```

此错误表明 Tomcat 提供的 JSP、servlet 等 jar 与项目 jar 冲突。不过，似乎一切都已正确设置：

```
<dependency>
  <groupId>javax.servlet</groupId>
  <artifactId>servlet-api</artifactId>
  <version>2.5</version>
  <scope>provided</scope>
</dependency>
<dependency>
  <groupId>javax.servlet.jsp</groupId>
  <artifactId>jsp-api</artifactId>
  <version>2.1</version>
  <scope>provided</scope>
</dependency> 
```

如果我在 VM 上打开类跟踪，我会看到启动时来自 Tomcat 的 lib 目录的 jsp jar 被用于 JspFactory：

```
[Loaded javax.servlet.jsp.JspFactory from file:/C:/tomcat-6.0.28/lib/jsp-api.jar] 
```

当服务器启动并且我准备好第一次访问 jsp 页面时，我得到了不同的结果：

```
[Loaded javax.servlet.jsp.JspFactory from file:/C:/Users/alice/.m2/repository/javax/servlet/jsp/jsp-api/2.1/jsp-api-2.1.jar] 
```

因此，出于某种我无法理解的原因，Web 应用程序正在使用来自 m2 存储库的 jsp jar，即使 pom.xml 中的范围设置为提供。我已经用尽了谷歌搜索。还有哪些**其他**配置问题可能导致此问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T22:55:47.120

在过去几年中，我经常看到与 Tomcat Eclipse 插件相关的各种配置问题。

我建议帮自己一个大忙 - 转储插件。运行独立的 Tomcat。这并不难做到。

将 Tomcat 配置为指向 Eclipse 构建的 war 文件也很容易，因此您不必显式部署它。

设置独立 Tomcat 实例的调试也非常容易。

好处是您不必处理插件的变幻莫测，一般来说， stuf 就可以了。据我所知，没有缺点。

# iphone - 自定义 UITableViewCell 中的 UIButton 未注册点击

> ID：14166294
> 
> 赞同：0
> 
> 时间：2013-01-04T22:50:17.257
> 
> 标签：iphone, objective-c, xcode, xcode-storyboard

我有一个自定义 UITableView，自定义 UITableViewCells 的高度是动态的。我在情节提要中创建了自定义单元格的骨架，其中包括（为简单起见）仅顶部的标签（静态高度）、中间的标签（动态高度）和底部的标签（静态高度）。

我在底部标签上有一个点击手势设置。

我遇到的问题是底部标签上的点击手势不起作用（一直）。当中间标签较短（2 行）时，它似乎比它较长（2 行以上）时有效。如果我将标签移动到顶部，并将其锚定到超级视图的顶部，则每次都会注册点击事件。

有没有其他人经历过这个，也许有解决这个问题的方法？

如果我以编程方式添加标签，它似乎工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:42:21.167

你确定你的底部标签没有被中间的标签遮挡吗？标签具有默认的透明背景，也许您的底部标签可见但无法通过点击手势访问。尝试缩小中间标签的大小或将点击手势兼容性添加到中间标签，以便您了解它是否会从底部标签中移除点击手势。如果是这种情况，您可以通过将底部标签放在前面来修复它

```
[tableCellView bringSubviewToFront:bottomLabel]; 
```

# javascript - 奇怪的部分刷新行为

> ID：14166297
> 
> 赞同：1
> 
> 时间：2013-01-04T22:50:32.160
> 
> 标签：javascript, xpages

我有一个由 3 个不同部分构建的自定义控件。

*   菜单栏
*   内容表（这是一个重复控件）
*   页脚

内容表是一个重复控件，其中正在呈现另一个自定义控件。现在我有以下xml：

```
<xp:table styleClass="lotusTable" id="table">
    <thead>
        <tr>
            <th>header</th>
        </tr>
    </thead>
    <xc:TimeGridBody id="timeGridBody"></xc:TimeGridBody>
    <xc:TimeGridFooter id="TimeGridFooter"></xc:TimeGridFooter>
</xp:table> 
```

在时间网格中有一个时间线自定义控件，它具有以下事件处理程序

```
<xp:eventHandler
    event="onclick"
    submit="true"
    refreshMode="partial"
    execMode="partial"
    execId="timeLineRow"
    immediate="false" refreshId="timeLineRow">

    <xp:this.action>
        <![CDATA[#{javascript:
            timeLineFactory.toDocument(compositeData.TimeLine);
            var editModeKey = "EditMode"+compositeData.TimeLine.getFdMe();
            viewScope.put(editModeKey, false);
        }]]>
    </xp:this.action>

    <xp:this.onComplete>
        <![CDATA[
            XSP.partialRefreshPost("#{id:TimeGridFooter}", {});
        ]]>
    </xp:this.onComplete>

</xp:eventHandler> 
```

如您所见，有一些事情正在发生，完成后它将刷新 timegridfooter 控件。我可以在我的萤火虫中看到正在执行 partialrefresh get 方法，并且调用的返回正文包含刷新的数据。但由于某种原因，这些数据不会在我的浏览器上刷新。有人可以澄清我为什么会这样吗？这是因为 partialrefreshget 在页面的更深部分（也就是不同的自定义控件）中存在问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T13:10:04.463

看来这是一个错字。经过一夜好眠后，我再次检查了它，现在它可以工作了。

# slf4j - Mahout movieLens 推荐器，输出文件在哪里？

> ID：14166304
> 
> 赞同：1
> 
> 时间：2013-01-04T22:51:01.797
> 
> 标签：slf4j, mahout, mahout-recommender

在命令之后成功构建之后，我正在运行位于 mahout wiki stater 中的 mahout Recommender：

```
mvn exec:java -Dexec.mainClass="org.apache.mahout.cf.taste.example.grouplens.GroupLensRecommenderEvaluatorRunner" -Dexec.args="-i ratings.dat" 
```

我看到了这个日志文件，但找不到任何输出：

```
[INFO] Scanning for projects...
[INFO] Searching repository for plugin with prefix: 'exec'.
[INFO] ------------------------------------------------------------------------
[INFO] Building Mahout Examples
[INFO]    task-segment: [exec:java]
[INFO] ------------------------------------------------------------------------
[INFO] Preparing exec:java
[INFO] No goals needed for project - skipping
[WARNING] POM for 'asm:asm:pom:3.1:compile' is invalid.

Its dependencies (if any) will NOT be available to the current build.
[INFO] [exec:java {execution: default-cli}]
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL 
```

[信息] --------------------------------------------- ------------------------- [INFO] 总时间：20 秒 [INFO] 完成时间：Fri Jan 04 14:47:33 PST 2013 [ INFO] 最终内存：31M/697M [INFO] ---------------------------------------- ---------------------------------

日志/输出在哪里？如何启用日志？建议在哪里？难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T15:09:23.593

您正在运行的该类被描述为***“一个简单的示例“跑步者”类，它将评估 GroupLensRecommender 的当前实现的性能”***，它只会为您提供***“用户的预测评分和实际评分之间的平均绝对差”***，也称为作为***“平均平均误差”***

因此，您并没有真正生成建议。

Ted Dunning 的 github 帐户有 Mahout In Action 书籍示例（[链接](https://github.com/tdunning/MiA/tree/master/src/main/java/mia)）。你应该看看。

# asp.net - 如何配置 web.config，使用 .aspx 文件作为站点地图文件？

> ID：14166316
> 
> 赞同：0
> 
> 时间：2013-01-04T22:51:41.190
> 
> 标签：asp.net, web-config, sitemap, web.sitemap

我目前正在尝试创建自己的站点地图提供程序。一个 aspx (ashx?) 文件，将根据请求动态创建站点地图文件。没有静态站点地图文件。一切都是从数据库中读取的。

为什么？我在同一个子域上有多个帐户（使用通配符），并且每个用户的站点地图文件都不同。站点地图文件仅用于 google 和其他搜索引擎。

```
user1.domain.com
user2.domain.com
user3.domain.com
...
user1000.domain.com 
```

所有这些子域共享相同的文件。如果我创建一个“/web.sitemap”，那么所有人都共享同一个站点地图，但那是不正确的。因为所有用户都在他们的主页上创建自己的页面。所以他们需要不同的站点地图。

所以。我希望所有搜索引擎都可以访问我的站点地图。而且我认为正确的方法是在 web.config 中注册站点地图。正确的？还是有其他方法可以做到这一点？

现在的文件是：sitemap.aspx 或 sitemap.ashx。（我还没说完）

我如何注册我的站点地图，以便所有搜索引擎都能找到它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:18:27.560

我[在 ASP.NET 中的动态站点](http://www.blackbeltcoder.com/Articles/asp/dynamic-sitemaps-in-asp-net)地图一文中介绍了创建动态站点地图的代码。

您可以使用 URL 路由将您的动态站点地图称为 sitemap.xml，或者您可以简单地将站点地图页面的真实名称提交给 Google 和 Bing。

但是我在理解你想要做什么时遇到了一些麻烦。你需要 web.config 做什么？谷歌爬虫将如何根据用户改变这一点？

# plugins - IntelliJ 如何找到远程依赖项？

> ID：14166322
> 
> 赞同：1
> 
> 时间：2013-01-04T22:52:09.223
> 
> 标签：plugins, playframework, intellij-idea, playframework-2.0

我将[Mailer 插件](https://github.com/typesafehub/play-plugins/tree/master/mailer)添加到我的 Play Framework 2 项目中。它编译和工作正常，但 IntelliJ 无法解析它的任何类。我通常只是将 jar 作为模块添加到我的 IntelliJ 项目设置中，但我没有 jar。据我了解，该插件会自动从某个存储库中提取。那么如何让 IntelliJ 意识到它呢？

我将此添加到 conf/play.plugins

```
1500:com.typesafe.plugin.CommonsMailerPlugin 
```

这作为 project/build.scala 中的依赖项

```
"com.typesafe" %% "play-plugins-mailer" % "2.0.4" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T02:04:18.047

[我用sbt-idea](https://github.com/mpeltonen/sbt-idea) SBT 插件解决了这样的问题。只需将其添加到您的`project/plugins.sbt`文件中：

```
addSbtPlugin("com.github.mpeltonen" % "sbt-idea" % "1.2.0") 
```

然后，每当您更改项目依赖项时，运行`sbt idea`并且您的 IntelliJ 项目将被更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T20:24:14.530

我必须先在我的 plugins.sbt 文件中删除对 com.github.mpeltonen 的引用。然后正如比尔所说，我需要跑步`play idea`。如果我尝试在`play idea`不删除引用的情况下运行，我会收到此异常：

```
java.lang.NoSuchMethodError: org.sbtidea.SbtIdeaPlugin$.ideaSettings()Lscala/collection/Seq; 
```

# html - HTML 是否符合 XML 规范？

> ID：14166323
> 
> 赞同：1
> 
> 时间：2013-01-04T22:52:15.563
> 
> 标签：html, xml, specifications

HTML 和 XML 在语法上非常相似，所以我想知道有效的 HTML 代码是否始终符合 XML 规范。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T22:54:26.387

不，不会的。

HTML 2 到 4.x 是 SGML 应用程序，而不是 XML 应用程序。（HTML+ 也可能是一个 SGML 应用程序，从规范的简短浏览中并不清楚）

HTML 5 有自己的解析规则。

（XHTML 和 HTML 5 的 XML 序列化将是 XML）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T23:02:35.017

> HTML 是否符合 XML 规范？

不，不是的。HTML 支持：

*   未闭合的标签（例如`<img>`，代替`<img />`）
*   错误嵌套的标签（例如`<b><i>bla</b></i>`，而不是`<b><i>bla</i></b>`）
*   不带引号的属性（例如`<a name=foo>...</a>`）
*   未正确编码的内容（例如`<em>this & that</em>`，代替`<em>this &amp; that</em>`）
*   明确必须包含未编码内容的标签（即`<script>`）
*   命名实体（例如`&copy;`，代替`&#169;`）

该标准并未明确*允许*所有这些概念，但所有 HTML 解析器都理解并支持它们。

它们在 XML 中都不合法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T22:55:34.737

HTML 更宽松。例如，

```
<!DOCTYPE html>
<title>foo</title>
bar 
```

是一个有效的 HTML5 文档，但它显然不是有效的 XML，因为 XML 需要一个包含整个文档的顶级元素。

但是，您可以使用其中一种[XHTML](http://en.wikipedia.org/wiki/XHTML)语言，它们是 XML 的应用程序，其语义与相应的 HTML 标准相同。

# php - 新图片后div延迟

> ID：14166328
> 
> 赞同：-1
> 
> 时间：2013-01-04T22:52:24.700
> 
> 标签：php, javascript, html, delay

好的，我有一个脚本可以在您每次评分时更改图像，并且效果很好，但问题是人们可以向评分系统发送垃圾邮件，所以我认为可以在包含 div 之前进行某种延迟设置新图像后显示评分

应该延迟的评级栏代码：

```
<div id="button" onclick="changeSrc2()">
<div class="rate_widget" id="<? echo $id;?>">
<div class="star_1 ratings_stars"></div>
<div class="star_2 ratings_stars"></div>
<div class="star_3 ratings_stars"></div>
<div class="star_4 ratings_stars"></div>
<div class="star_5 ratings_stars"></div>
<div class="total_votes">vote data</div>
</div>
</div> 
```

在评分栏上单击更改图像的代码：

```
$number="1";
$wrongnumber="2";
$random = mysql_query("SELECT * FROM images ORDER BY RAND()");
$place="upload/";
echo '<script type="text/javascript"> ';
while($wor = mysql_fetch_array($random))
  {
  $ids=$wor['id'];
  $name = $wor['name'];
  $images = $place . $wor['name'];
  $number=$number + 1;
  $wrongnumber=$wrongnumber + 1;
echo 'function ' . 'changeSrc' . $number . '() '; ?>
{
document.getElementById("rand").src="<? echo $images;?>";
document.getElementById("button").onclick=changeSrc<? echo $wrongnumber;?>;
document.getElementsByClassName('rate_widget')[0].id = <? echo $ids;?>;
}
<?
  }
?> 
</script> 
```

和显示第一张图片的代码：

```
 /*Display images*/
$r = mysql_query("SELECT * FROM images ORDER BY RAND() LIMIT 1");

while($wor = mysql_fetch_array($r))
{  
    $place="upload/";
    $id=$wor['id'];
    $name = $wor['name'];
    $image = $place . $wor['name'];
    echo '<img id="rand" src="'.$image.'" style="max-height:330px;">';  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T22:59:52.250

尝试使用`sleep()`函数。它看起来像这样：

```
<?php
sleep(2);
echo '
 <div id="button" onclick="changeSrc2()">
 <div class="rate_widget" id=' . $id . '">
 <div class="star_1 ratings_stars"></div>
 <div class="star_2 ratings_stars"></div>
 <div class="star_3 ratings_stars"></div>
 <div class="star_4 ratings_stars"></div>
 <div class="star_5 ratings_stars"></div>
 <div class="total_votes">vote data</div>
 </div>
 </div>
';
?> 
```

# java - 捕获异常后恢复循环

> ID：14166329
> 
> 赞同：1
> 
> 时间：2013-01-04T22:52:33.220
> 
> 标签：java, java.util.scanner, do-while

我在我的 main 方法中捕获了一个 inputMismatchException，并希望我的 do-while 循环在捕获异常后再次迭代。我什至编写了一个明确的 continue 语句，但这不起作用。我该怎么做？

```
public class AddressBookApp {

public static void main(String[] args) {
    AddressBook abook = new AddressBook();

    System.out.println("Welcome to the Address Book Application\n");
    Scanner sc = new Scanner(System.in);

    int menuNumber = 4;
    loop:
    do {
        abook.menu();

        try{
            menuNumber = sc.nextInt();
            System.out.println();

            if (menuNumber < 1 || menuNumber > 4){
                System.out.println("Please enter a valid menu number\n");
            } else if (menuNumber == 1) {
                abook.printEntries();
            } else if (menuNumber == 2) {
                abook.addEntry();
            } else if (menuNumber == 3) {
                abook.removeEntry();
            } else {
                System.out.println("Thanks!  Goodbye.");
                sc.close();
                return;
            }

        } catch (InputMismatchException ime) {
            System.out.println("Please enter an integer");
            sc.next();

            continue loop;
        }

    } while (menuNumber != 4);
    sc.close();
  } 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T22:57:12.867

你留下`menuNumber`等于 4，这是你的循环的终止条件。当然你的循环会结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T23:01:27.350

您将 menuNumber 初始化为 4，但在出现异常时不要更改它。循环确实尝试继续，但由于语句`menuNumber != 4`为假而退出。

```
int menuNumber = 4;
loop:
do {
    abook.menu();

    try{
        menuNumber = sc.nextInt();
        System.out.println();

        if (menuNumber < 1 || menuNumber > 4){
            System.out.println("Please enter a valid menu number\n");
        } else if (menuNumber == 1) {
            abook.printEntries();
        } else if (menuNumber == 2) {
            abook.addEntry();
        } else if (menuNumber == 3) {
            abook.removeEntry();
        } else {
            System.out.println("Thanks!  Goodbye.");
            sc.close();
            return;
        }

    } catch (InputMismatchException ime) {
        System.out.println("Please enter an integer");
        sc.next();

        continue loop;
    }

} while (menuNumber != 4); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T23:01:11.847

试试这个

```
 } catch (InputMismatchException ime) {
    if (fatal(ime)) {
        throw ime;
    } else {
        // try again
        continue;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T23:05:38.410

循环不会继续，因为抛出了类型为 OTHER 而非 InputMistmatchException 的异常。将捕获更改为：

```
catch (Exception e) 
```

或至少添加所有包含捕获条件。

更好的解决方案是准确检查引发了哪些异常以及引发异常的原因，然后修复导致异常的问题。理论上，使用 continue 语句进行全方位捕获可能会导致无限循环，因为 menuNumber 不会递增。

# gcc - 将“dfwin”Fortran 库与 gfortran 一起使用

> ID：14166333
> 
> 赞同：0
> 
> 时间：2013-01-04T22:52:47.260
> 
> 标签：gcc, fortran, gfortran

我尝试在 fortran 中动态加载 DLL 库，所以我需要从库中使用`loadlibrary`和运行。`getprocaddress``dfwin`

但是当我编译这个时：

```
program helloworld
    use dfwin
end 
```

我刚得到：

```
Fatal Error: Can't open module file 'dfwin.mod' for reading at (1): No such file or directory 
```

我可以以任何方式安装或链接到**gfortran** GCC 编译器的`dfwin`模块吗？

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T05:58:52.217

不可以。编译器生成的 mod 文件特定于该编译器（在某些情况下，特定于编译器版本）。

（即使您有 dfwin 模块的源代码，它也使用特定于 DEC/Compaq/Intel 编译器谱系的扩展。）**

# ruby-on-rails - 如何将变量作为文本注释添加到转换选项中？

> ID：14166337
> 
> 赞同：1
> 
> 时间：2013-01-04T22:53:20.413
> 
> 标签：ruby-on-rails, ruby-on-rails-3, paperclip

我想将**UserProfile.nickname**作为文本注释插入转换选项。
这就是我现在所拥有的。我怎样才能解决这个问题？

**user_profile.rb**

```
before_save :text_to_insert

def text_to_insert
    nickname = self.nickname 
end

has_attached_file :user_avatar,
    :styles => {
    :thumb=> "100x100>",
    :small  => "400x400>" }, 
     :convert_options => {
      :small => lambda {|a| %Q{ -gravity south  -pointsize 25 -fill black -annotate +0+0 "#{nickname}" -fill white -annotate +2+2 "#{nickname} "} } } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-16T04:56:42.103

尝试 #{:nickname} 或 #{self.nickname} 代替。

我有同样的问题。通常他们建议您创建一个自定义回形针处理器来执行此操作，但几年前我以一种记住您问题中提到的 o 的方式做了类似的事情，但我不记得具体如何。

如果您完成了，请在此处发布您的解决方案并让我知道是否可行；）

# jquery - 根据标签文本检查 Radio

> ID：14166338
> 
> 赞同：0
> 
> 时间：2013-01-04T22:53:27.537
> 
> 标签：jquery

我有以下 HTML：

```
<input type="radio" value="213490" id="lt_1133041_213490" name="lt_1133041[]">
<label for="lt_1133041_213490">LH License</label>
<input type="radio" value="213491" id="lt_1133041_213491" name="lt_1133041[]">
<label for="lt_1133041_213491">PC License</label> 
```

我需要做的是能够根据标签文本检查收音机，所以如果我通过“LH License”，它将检查 id lt_1133041_213490，如果我通过“PC License”，它将检查 id lt_1133041_213491。

不确定该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T23:00:14.813

```
id = $("label:contains("+label_text+")").attr('for');
$('#' + id).prop('checked', true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T23:00:46.713

你在寻找这样的东西吗？见[小提琴](http://jsfiddle.net/bplumb/xjMLH/)。

```
function checkRadio(text){
    $('#'+$('label:contains('+text+')').attr('for')).attr('checked', 'checked');  
}

checkRadio('LH License'); 
```

这将创建一个函数，当传递一个字符串时将检查相应的单选按钮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T23:01:45.473

```
function checkRadio( text){
    $('input:radio').filter(function(){
      return $(this).next('label').text()==text;
    }).prop('checked', true);\

} 
```

使用功能：

```
checkRadio( 'LH License'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T22:59:42.567

这完美地工作。

```
var _radio = $("label:contains('LH License')").attr("for");
i = $("#" + _radio).attr('id'); 
```

# c++ - 分叉和传递套接字c ++

> ID：14166340
> 
> 赞同：0
> 
> 时间：2013-01-04T22:53:38.813
> 
> 标签：c++, networking, fork

我是使用分叉的新手，我无法理解如何实现我想要的。我会尽力解释。

我有进程 A，它是在 Linux 上运行的功能性伯克利套接字服务器。

我需要进程 A 将程序从磁盘加载到后台状态下的单独非阻塞进程（进程 B）中。然后进程 A 需要通过进程 B 对进程 A 的套接字的控制。最后进程 A 需要结束，让进程 B 继续运行。

如果旧进程结束，我不清楚将套接字传递给新进程需要什么，以及创建允许原始进程结束的非阻塞新进程的最佳方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T22:57:34.393

你不需要做任何特别的事情。只需确保为您希望进程 B 继承的任何文件描述符清除了[close on exec标志，并为您不希望进程 B 继承的任何文件描述符设置。](https://stackoverflow.com/a/6125112/721269)然后调用`exec`以进程 B 替换进程 A。进程 B 将以完整的所有可继承文件描述符开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:00:55.613

如果您需要在不使用继承-通过-fork 的情况下传递打开的文件（例如套接字），请使用`ioctl`with `I_SENDFD`。[这是一个非常详细的描述](http://infohost.nmt.edu/~eweiss/222_book/222_book/0201433079/ch17lev1sec4.html)。（有相应的接收它的机制。）您可以使用连接进程的命名管道或通过变体使用 Unix 域套接字来执行此操作。

# objective-c - 将向量数组函数相加

> ID：14166341
> 
> 赞同：-1
> 
> 时间：2013-01-04T22:53:43.990
> 
> 标签：objective-c, arrays, math, double

此代码按预期工作，为我提供这 10 个输入字段中的数字。现在，我希望将它们全部加到一个数字上。（所有 miTimesFrac 结果。）有什么真正有效的方法吗？

```
double fraction[10] = {methane, ethane, propane, nbutane, ibutane,npentane,ipentane,nhexane,nitrogen,oxygen};
double Mi[10] = {16.0426,30.064,44.0962,558.123,558.123,72.1498,72.1498,86.1766,28.0134,31.9988};
double miTimesFrac[10];
for (int i=0; i<10; ++i) miTimesFrac[i] = Mi[i] * fraction[i]; 
```

我已经尝试了一些东西，像这样

```
double TMiTimesFrac;
for (int i=1; i<10; ++i) TMiTimesFrac = miTimesFrac[i]+miTimesFrac[i-1]; 
```

每次都返回相同的值。我缺少任何功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:16:21.690

这：

```
double TMiTimesFrac;
for (int i=1; i<10; ++i) 
    TMiTimesFrac = miTimesFrac[i]+miTimesFrac[i-1]; 
```

不做这项工作，因为您没有跟踪 TMiTimesFrac 的所有先前值，因此只有最后一个值 (miTimesFrac[9]+miTimesFrac[8]) 对 TMiTimesFrac 的最终值有贡献。

所以首先将 TMiTimesFrac 初始化为零。然后将每个值添加到它：

```
double TMiTimesFrac= 0.0;
for(unsigned int i=0; i<10; i++)
{
    TMiTimesFrac+=miTimesFrac[i];
} 
```

现在您应该能够在不粘贴代码的情况下完成此操作。我建议尝试一下。

# c - 如何在C中显示矩阵

> ID：14166350
> 
> 赞同：2
> 
> 时间：2013-01-04T22:54:36.340
> 
> 标签：c, printing, matrix

我有一个 matrix.txt 文件，其中有一个这样写的矩阵：

```
1 2 3

4 5 6

7 8 9 
```

我需要编写一个小 C 程序，将此文件作为输入，并以与 .txt 文件相同的方式打印此矩阵。

这意味着当“./a.out matrix.txt”的输出必须与我的 .txt 文件中的内容完全相同时：

```
1 2 3

4 5 6

7 8 9 
```

我的问题是我所能做的就是这个功能：

```
void printMatrice(matrice) {
    int x = 0;
    int y = 0;

    for(x = 0 ; x < numberOfLines ; x++) {
        printf(" (");
        for(y = 0 ; y < numberOfColumns ; y++){
            printf("%d     ", matrix[x][y]);
        }
        printf(")\n");
    }
} 
```

但这一点都不好。

有人有想法吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-04T23:00:13.690

试试这个简单的代码

```
int row, columns;
for (row=0; row<numberOfLines; row++)
{
    for(columns=0; columns<numberColumns; columns++)
    {
         printf("%d     ", matrix[row][columns]);
    }
    printf("\n");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-01T20:41:36.533

我稍微修改了 user1929959 的代码，因为我有一些奇怪的打印。如果您愿意，可以尝试复制粘贴此代码，看看它是如何运行的。这里只是一个n00b学生。希望我能有所帮助（我也在挣扎）；）

# 矩阵打印代码

```
void main ()
{

    int matrix [3][4] = { {1, 2, 3, 4},
                           {5, 6, 7, 8},
                           {9, 10, 11, 12}
                         };

    int row, column=0;

    for (row=0; row<3; row++)
     {
        for(column=0; column<4; column++)
            {printf("%d     ", matrix[row][column]);}
            printf("\n");
     }

    getchar();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-02T22:04:21.677

您需要添加的只是： put //printf("\n"); 在循环中，负责打印 ROWS。因此，\n：它将在每行完成后更改行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-04T11:35:55.527

这是怎么做的

```
#include <stdio.h>

#include <stdlib.h>

void main()
{
 int matrix[3][3]={{1,2,3},
{4,5,6},{7,8,9}};
int columns,rows;
for(columns=0;columns<=2;columns++){
    for(rows=0;rows<=2;rows++){
        printf(" %d " ,matrix[columns][rows]);
    }
    printf("\n");
} 
```

}

# java - 使用变量名创建 Java 数组

> ID：14166357
> 
> 赞同：-1
> 
> 时间：2013-01-04T22:55:02.273
> 
> 标签：java, arrays, multidimensional-array

我正在为 Minecraft 服务器制作插件，我需要一种方法将玩家存储在他们所在竞技场的数组中。例如：

该插件加载所有创建的竞技场：`Arena1` `Arena2` `Arena3`

我需要它来创建和调用`Arenas`数组，并在其中为每个竞技场创建一个数组，我可以在其中存储玩家姓名，以便我知道谁在哪个竞技场中。我希望你明白我的意思。我将它以表格格式为您提供：

```
Arenas{
    Arena1{
        "Player1"
    }
    Arena2{

    }
    Arena3{

    }

} 
```

我希望你能理解，我希望你能帮助我。我知道你们很好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T22:59:40.533

您所追求的编程概念称为[关联数组](http://en.wikipedia.org/wiki/Associative_array)，Java 中最常用的一种是`java.util.HashMap`. arenas 的名称用作键，它们与值列表相关联。所以一个简单的例子就像：

```
Map<String, List<String> arenas = new HashMap<>();
//create player list for Arena1
arenas.put("Arena1", new ArrayList<String>());
//add a player
arenas.get("Arena1").add("player1"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T22:57:39.843

A`Map<Arena, Set<Player>>`应该做得很好。给定一个竞技场，它将为您提供其中的一组玩家。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T22:57:40.020

我会做一个`Map<String, List<String>>`

key 是竞技场的名字，在列表中是玩家的名字。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T22:58:39.633

收藏品可能是您的解决方案：

```
class Arena {
  Set<Player> players = HashSet<Player>();
} 
```

`HashMap<String, Arena>`如果您需要按名称访问它们或者`ArrayList<Arena>`如果随机访问就足够了，则将它们存储在其中。

# python - 逐元素字符串比较

> ID：14166358
> 
> 赞同：-9
> 
> 时间：2013-01-04T22:55:03.237
> 
> 标签：python, string, comparison, element

我需要一个快速函数来对两个字符串进行逐元素比较。例子：

```
text1 = 'absabeadg'
text2 = 'abSatyaxguz'
diff = compare(text1,text2) # should return diff=[1,1,0,1,0,0,1,0,1,0,0] 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-04T23:05:05.923

显示了零努力，但到底是什么，这是周末：

```
>>> text1 = 'absabeadg'
>>> text2 = 'abSatyaxguz'
>>> 
>>> from itertools import izip_longest
>>> 
>>> [int(c0==c1) for c0, c1 in izip_longest(text1, text2)]
[1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0] 
```

这使用[izip_longest](http://docs.python.org/2/library/itertools.html#itertools.izip_longest)将（可能）不同长度的序列组合在一起，`int(True) == 1`以及`int(False) == 0`.

[更新：]

由于关于这个输出是否有意义似乎存在一些争议，这里有一种不同的方法，它给出了相同的答案：

```
>>> [int(text1[i:i+1] == text2[i:i+1]) for i in range(max(len(text1), len(text2)))]
[1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0] 
```

（据我所知，辩论似乎是关于在将无与某物进行比较时返回是否有意义`0`。我认为这是完全合理的，并且是字符串切片的行为方式——我们可以将空字符串与非空字符串进行比较字符串并总是得到`False == 0`。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T23:25:02.430

对于 no-import-modules-readable-solution 我猜你可以使用这个:)

```
text1 = "absabeadg"
text2 = "abSatyaxguz"
len1 = len(text1)
len2 = len(text2)
result = []
for index in range(min(len1, len2)):
    result.append(int(text1[index] == text2[index]))
result.extend([0]*abs(len1-len2))
print result 
```

对于列表理解的乐趣：

```
text2 = "absabeadg"
text1 = "abSatyaxguz"
len1 = len(text1)
len2 = len(text2)

print [int(text1[i] == text2[i]) for i in range(min(len1, len2))] + [0]*abs(len1-len2) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T23:05:59.047

你可以使用 numpy/pylab：

```
import pylab as p

a = p.fromstring("asdfg", dtype=p.int8)
b = p.fromstring("aqwer", dtype=p.int8)

print a == b 
```

如果字符串的长度不同，您必须自己填充结果，并且可以选择将布尔值数组转换为整数列表（如果需要）。

# database - 从 joomla 数据库到屏幕的结果问题

> ID：14166360
> 
> 赞同：0
> 
> 时间：2013-01-04T22:55:04.797
> 
> 标签：database, joomla

我似乎被困住了。我已经检查了这个文档[JDatabase 3.0](http://docs.joomla.org/Accessing_the_database_using_JDatabase/3.0)

而且我无法弄清楚为什么我的列中的结果不会显示在屏幕上。它可能是 WHERE 语句的问题，但它确实回显了正确的用户名，所以我不确定。这是我一直在操作的代码。

```
{source 0}
<?php
$user =& JFactory::getUser();
if (!$user->guest)
$name = $user->username;

$db =& JFactory::getDbo();

$query = $db->getQuery(true);
$query = "SELECT image_url FROM #__image_data WHERE user_name = $name";

$db->setQuery($query);

$results = $db->image_url();  //also tried $results = $db->loadObjectList
                                       and loadAssocList

echo $results

?>
{/source} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T22:58:21.380

你需要

```
$list = $db->loadObjectList();

foreach ($list as $item){
    echo $item->image_url.'<br />';
} 
```

# java - Java：算法 RSA 的密钥不适合对称加密。

> ID：14166367
> 
> 赞同：1
> 
> 时间：2013-01-04T22:55:50.480
> 
> 标签：java, aes, rsa, cbc-mode

我正在尝试使用 AES/CBC 加密文件，密钥必须是随机的并使用 RSA 加密。我得到“算法 RSA 的密钥不适合对称加密。”......这似乎是什么问题？

这是我的代码的一部分：

```
 Security.addProvider(new BouncyCastleProvider());
    byte[] input = "Encryption Test".getBytes();
    Cipher cipher = Cipher.getInstance("AES/CBC/PKCS5Padding", "BC"); // init Cipher to use AES/CBC
    SecureRandom random = new SecureRandom(); // IV is random 
    KeyPairGenerator generator = KeyPairGenerator.getInstance("RSA", "BC"); // Key will be generated with RSA

    generator.initialize(512, random);
    KeyPair pair = generator.generateKeyPair();
    Key pubKey = pair.getPublic();
    //Key privKey = pair.getPrivate();

    cipher.init(Cipher.ENCRYPT_MODE, pubKey, random); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T00:48:29.940

恭喜您希望使用密钥交换密码进行密钥交换！有时我想知道为什么互联网上有这么多人试图将 RSA 变成流密码。

下面的示例代码向您展示了如何执行此操作。

```
import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

import java.io.*;
import java.security.*;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;

public class Test {

    /**
     * Generate an RSA key pair and save it to the file
     */
    public static KeyPair genKeys(File keyFile) throws Exception {
        System.out.println("Generating RSA keys");

        KeyFactory factory = KeyFactory.getInstance("RSA");
        KeyPairGenerator kpg = KeyPairGenerator.getInstance("RSA");
        kpg.initialize(2048);
        KeyPair kp = kpg.generateKeyPair();
        X509EncodedKeySpec pubSpec = factory.getKeySpec(kp.getPublic(),
                X509EncodedKeySpec.class);
        PKCS8EncodedKeySpec privSpec = factory.getKeySpec(kp.getPrivate(),
                PKCS8EncodedKeySpec.class);

        FileOutputStream out = new FileOutputStream(keyFile);
        DataOutputStream dat = new DataOutputStream(out);

        byte[] enc = pubSpec.getEncoded();
        dat.writeInt(enc.length);
        dat.write(enc);

        enc = privSpec.getEncoded();
        dat.writeInt(enc.length);
        dat.write(enc);
        dat.flush();
        dat.close();

        System.out.println("RSA keys saved to " + keyFile.getPath());

        return kp;
    }

    /**
     * Load an RSA key pair from the file
     */
    public static KeyPair loadKeys(File keyFile) throws Exception {
        System.out.println("Loading RSA keys");

        FileInputStream in = new FileInputStream(keyFile);
        DataInputStream dat = new DataInputStream(in);

        int len = dat.readInt();
        byte[] enc = new byte[len];
        dat.readFully(enc);
        X509EncodedKeySpec pubSpec = new X509EncodedKeySpec(enc);

        len = dat.readInt();
        enc = new byte[len];
        dat.readFully(enc);
        PKCS8EncodedKeySpec privSpec = new PKCS8EncodedKeySpec(enc);

        dat.close();

        KeyFactory factory = KeyFactory.getInstance("RSA");
        PublicKey pub = factory.generatePublic(pubSpec);
        PrivateKey priv = factory.generatePrivate(privSpec);

        System.out.println("RSA keys loaded from " + keyFile.getPath());
        return new KeyPair(pub, priv);
    }

    /**
     * Decrypt a file
     */
    public static void decrypt(KeyPair kp, File inFile, File outFile) throws Exception {
        Cipher rsa = Cipher.getInstance("RSA/ECB/OAEPWithSHA1AndMGF1Padding");

        FileInputStream in = new FileInputStream(inFile);
        DataInputStream dat = new DataInputStream(in);

        // read RSA encrypted AES key
        int len = dat.readInt();
        byte[] buf = new byte[len];
        dat.readFully(buf);
        rsa.init(Cipher.DECRYPT_MODE, kp.getPrivate());

        SecretKeySpec key = new SecretKeySpec(rsa.doFinal(buf), "AES");

        // read the AES IV
        len = dat.readInt();
        buf = new byte[len];
        dat.readFully(buf);
        IvParameterSpec iv = new IvParameterSpec(buf);

        Cipher aes = Cipher.getInstance("AES/CBC/PKCS5Padding");
        aes.init(Cipher.DECRYPT_MODE, key, iv);

        // process the rest of the file to get the original back
        FileOutputStream out = new FileOutputStream(outFile);

        buf = new byte[1000];
        int r = -1;
        while( (r = dat.read(buf)) != -1 ) {
            byte[] sec = aes.update(buf, 0, r);
            if (sec != null) out.write(sec);
        }
        out.write(aes.doFinal());
        out.flush();
        out.close();
        in.close();
    }

    public static void encrypt(KeyPair kp, File inFile, File outFile) throws Exception {
        Cipher rsa = Cipher.getInstance("RSA/ECB/OAEPWithSHA1AndMGF1Padding");

        // create new AES key
        KeyGenerator gen = KeyGenerator.getInstance("AES");
        gen.init(256);
        SecretKey key = gen.generateKey();

        // RSA encrypt AES key
        byte[] keyEnc = key.getEncoded();
        rsa.init(Cipher.ENCRYPT_MODE, kp.getPublic());
        byte[] keySec = rsa.doFinal(keyEnc);

        // Create AES cipher
        Cipher aes = Cipher.getInstance("AES/CBC/PKCS5Padding");
        aes.init(Cipher.ENCRYPT_MODE, key);
        byte[] iv = aes.getIV();

        FileOutputStream out = new FileOutputStream(outFile);
        DataOutputStream dat = new DataOutputStream(out);

        // save encrypted AES key and IV
        dat.writeInt(keySec.length);
        dat.write(keySec);
        dat.writeInt(iv.length);
        dat.write(iv);

        // save the encrypted file
        FileInputStream in = new FileInputStream(inFile);
        byte[] buf = new byte[1000];
        int r = -1;
        while( (r = in.read(buf)) != -1 ) {
            byte[] sec = aes.update(buf, 0, r);
            if (sec != null) dat.write(sec);
        }
        dat.write(aes.doFinal());
        dat.flush();
        dat.close();
        in.close();
    }

    /**
     * @param args
     */
    public static void main(String[] args) throws Exception {
        if (args.length != 4) {
            System.out.println("Usage: java Test (encrpyt|decrypt) keyFile inFile outFile");
            return;
        }
        KeyPair kp;
        File keyFile = new File(args[0]);
        if (!keyFile.canRead()) {
            kp = genKeys(keyFile);
        } else {
            kp = loadKeys(keyFile);
        }

        boolean isEnc = args[1].equalsIgnoreCase("encrypt");
        boolean isDec = args[1].equalsIgnoreCase("decrypt");
        File inFile = new File(args[2]);
        File outFile = new File(args[3]);
        if (!(isEnc || isDec) || !inFile.canRead()) {
            System.out.println("Usage: java Test (encrpyt|decrypt) keyFile inFile outFile");
            return;
        }

        if (isEnc) {
            encrypt(kp, inFile, outFile);
        } else {
            decrypt(kp, inFile, outFile);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T22:59:42.233

您不能将 RSA 密钥与 AES 密码一起使用...

改用这个：

```
 KeyGenerator keyGen = KeyGenerator.getInstance("AES", "BC");
 keyGen.init(256);
 Key key = keyGen.generateKey(); 
```

在这里你可以找到一个[代码示例。](http://jexp.ru/index.php/Java_Tutorial/Security/Advanced_Encryption_Standard)

# linux - 传播由子执行脚本完成的变量更改

> ID：14166373
> 
> 赞同：1
> 
> 时间：2013-01-04T22:56:52.020
> 
> 标签：linux, bash, ubuntu, debian, sh

我的问题是自我描述的：

script1.sh 包含：

```
#!/bin/sh
export SOMEVAR=0
echo "1, SOMEVAR=$SOMEVAR"
./script2.sh
echo "2, SOMEVAR=$SOMEVAR" 
```

script2.sh 包含：

```
#!/bin/sh
SOMEVAR=1 
```

./script1.sh 给出：

```
1, SOMEVAR=0
2, SOMEVAR=0 
```

虽然我想：

```
1, SOMEVAR=0
2, SOMEVAR=1 
```

我怎样才能获得想要的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T23:01:13.890

使用`source`(aka. `.`) 而不是调用脚本，子进程不能改变父环境：

```
#!/bin/sh
export SOMEVAR=0
echo "1, SOMEVAR=$SOMEVAR"
. ./script2.sh
echo "2, SOMEVAR=$SOMEVAR" 
```

# android - 我想给 Button 我自己的视图，但我得到运行时异常

> ID：14166376
> 
> 赞同：-1
> 
> 时间：2013-01-04T22:57:08.150
> 
> 标签：android

我想查看我的按钮，如下所示，但我不能这样做，所以我搜索并发现我应该使用 ViewGroup.addView()。

这是我的 Menu.java 活动

```
 protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.menu);

    View v=null;

    btn_timeTable=(Button)findViewById(R.id.btn_timeTable);
    ViewGroup vg_timeTable = (ViewGroup)findViewById(R.id.btn_timeTable);
    vg_timeTable.addView(getView(v, "TimeTable", R.drawable.table_1));

    btn_subjects=(Button)findViewById(R.id.btn_subjects);
    ViewGroup vg_subjects = (ViewGroup)findViewById(R.id.btn_subjects);
    vg_subjects.addView(getView(v, "Subjects", R.drawable.books));

    btn_lesson_timeTable=(Button)findViewById(R.id.btn_lesson_timeTable);
    ViewGroup vg_lesson_timeTable = (ViewGroup)findViewById(R.id.btn_lesson_timeTable);
    vg_lesson_timeTable.addView(getView(v, "Lesson\ntimeschedule", R.drawable.clock));
}

private View getView(View v, String text, int picture) {
    Helper helper=null;
    if (v == null) {
        LayoutInflater inflater = getLayoutInflater();
        v = inflater.inflate(R.layout.btn_view, null);
        helper = new Helper(v);
        v.setTag(helper);
    } else {
        helper = (Helper) v.getTag();
    }

    helper.setView(text, picture);
    return v;
}

class Helper {
    View v = null;

    public Helper(View v) {
        this.v = v;
    }

    void setView(String text, int picture) {
        TextView tv_name = (TextView) v.findViewById(R.id.btn_text);
        ImageView iv_picture = (ImageView) v.findViewById(R.id.btn_picture);

        tv_name.setText(text);
        iv_picture.setImageResource(picture);
    }
} 
```

这是我的 btn_view.xml 文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" 
    android:background="@drawable/tab_selector">

    <ImageView
        android:id="@+id/btn_picture"
        android:layout_width="50dip"
        android:layout_height="50dip"
        android:layout_gravity="center_vertical|center_horizontal"
        android:src="@drawable/kmenuedit" >
    </ImageView>

    <TextView
        android:id="@+id/btn_text"
        android:layout_width="70dip"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:gravity="center_horizontal"
        android:ellipsize="marquee"
        android:marqueeRepeatLimit="marquee_forever"
        android:scrollHorizontally="true"
        android:singleLine="true"
        android:focusable="true"
        android:text="@string/text" 
        android:textColor="@color/White">
    </TextView>

</LinearLayout> 
```

但我得到运行时异常

这是我的日志猫

```
 01-04 22:37:19.921: D/dalvikvm(392): GC_EXTERNAL_ALLOC freed 700 objects / 54672 bytes in 53ms
    01-04 22:37:19.951: D/AndroidRuntime(392): Shutting down VM
    01-04 22:37:19.951: W/dalvikvm(392): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
    01-04 22:37:19.961: E/AndroidRuntime(392): FATAL EXCEPTION: main
    01-04 22:37:19.961: E/AndroidRuntime(392): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.homeassignment/com.example.homeassignment.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.homeassignment/com.example.homeassignment.Menus}: java.lang.ClassCastException: android.widget.Button
    01-04 22:37:19.961: E/AndroidRuntime(392):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at android.os.Handler.dispatchMessage(Handler.java:99)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at android.os.Looper.loop(Looper.java:123)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at android.app.ActivityThread.main(ActivityThread.java:4627)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at java.lang.reflect.Method.invokeNative(Native Method)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at java.lang.reflect.Method.invoke(Method.java:521)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
    01-04 22:37:19.961: E/AndroidRuntime(392):  at dalvik.system.NativeStart.main(Native Method) 
```

谁能帮我？提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:06:04.537

您在 R.layout.menu 中有问题。java.lang.ClassCastException: android.widget.Button 表示 android 无法将某些内容投射到按钮上。所以我认为 btn_timeTable （或 btn_subjects/btn_lesson_timeTable ）不是一个按钮，你正试图将它转换为一个按钮，所以它失败并抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:01:59.283

我认为这可能是问题的一部分：

```
Unable to start activity ComponentInfo{com.example.homeassignment/com.example.homeassignment.MainActivity} 
```

我猜想这条路应该是：

```
com.example.homeassignment/MainActivity 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T23:11:46.307

其他两个答案都对了一半。您似乎正在尝试将不是按钮的视图转换为按钮，但您的日志猫也表示它在您的主要活动中。在您的主要活动中查找您声明按钮的所有位置，并仔细检查 ID。

# android - 易于理解的复杂颜色选择器

> ID：14166381
> 
> 赞同：0
> 
> 时间：2013-01-04T22:57:31.243
> 
> 标签：android, ios, drawing, color-picker

我正在制作一个应用程序，该应用程序要求用户从颜色选择器中选择多种颜色，并设置某些颜色被选择的概率大于相等的概率。

一个例子：假设用户选择红色、绿色和蓝色，并选择红色应该有 3 个机会被选中，而另一个只有 1 个机会。所以最终红色将有 60% 的机会，绿色 20% 和蓝色 20 %。

现在我想这样做，但图形化且易于理解。

我有一些想法，但我不确定哪个好……或容易……或其他什么。

**想法1：**

![选择器1](../Images/5df14cf8e44299173f4d84cc14666687.png)

用户选择哪种颜色更有可能获得。这些数字基本上是附加到每种颜色的权重。这样做的问题是，由于显而易见的原因，您不能完全拥有完整的颜色光谱（全部 16,777,216 种）......所以您需要相对较少的颜色（约 150 种或其他颜色）。

**想法2：**

![选择器2](../Images/110cf11e96a8e79c9e6fff91a8aa5cef.png)

用户从区域中选择颜色。这更好，因为您可以拥有全系列的颜色......但我想不出一种简单的方法来获得更多机会选择的颜色（如上面的重量）。

这些只是我有缺陷的想法。您可以改进这些或提供其他想法。一个指向颜色选择器源代码的链接，它完全符合我的要求，不过会更好。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:06:23.437

似乎您正在寻找如何在移动设备上处理它的“创新想法”。对不起，那是你的功课。

但是，这篇文章可能会给您一些启发。

[http://www.fastcompany.com/3002676/magical-tech-behind-paper-ipads-color-mixing-perfect](http://www.fastcompany.com/3002676/magical-tech-behind-paper-ipads-color-mixing-perfection)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:03:22.650

你应该在用户选择颜色的地方做，一旦他完成，他可以选择不同颜色的权重。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T23:22:04.910

如果我猜对了，用户必须在颜色和数字/重量之间进行分配。我可以看到它如何轻松地与 Idea #1 一起使用，但不适用于 #2，因为在后者中，您没有要检查的不同颜色值。

您可能唯一能做的就是将用户形状输入（那些 blob）转换为矩形（或只允许以它们开头）并将它们存储在您的应用程序中，每个矩形也分配了权重。

根据该信息，您可以计算一些“体重范围”：

1.  假设：三个矩形（它们在屏幕上的位置无关紧要，但为了清楚起见，我将其命名为左、中、右）：左（权重 4）、中（权重 2）、右（权重 6）

2.  将所有权重相加 (12)

3.  找到归一化因子以从总和到范围 0..1 -> 因子 = 1/12

4.  对于每个矩形计算归一化权重：
    L = 4 * 1/12 = 0.333
    M = 2 * 1/12 = 0.167
    R = 6 * 1/12 = 0.500

=> 产生三个波段：
#1 从 0.0 到 0.167
#2 从 0.167 到 0.500 (= 0.167 + 0.333)
#3 从 0.500 到 1.000

1.  生成介于 0 和 1 之间的随机值，例如 0.75。

2.  比较随机值，与归一化的权重带 -> 0.75 在 0.5 和 1.0 之间 -> 第三个矩形

现在您已经找到了相关的矩形，获取另外两个随机值，其边界是您确定的矩形的 X（对于第一个值）和 Y（对于第二个值）坐标的最小值和最大值（这些矩形是在用户首先绘制了这些斑点/矩形）。

最后一步是在刚刚生成的新坐标处查找上面显示的颜色范围纹理中的颜色值，瞧，您的颜色是根据分配给矩形的权重确定的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T00:20:26.977

我在某些地方尝试过第一种方法……但理想的方法是使用调色板对颜色进行分组。这就是本杰明摩尔等大多数色彩公司的做法。这样你就可以控制你想要的颜色阈值/重量。

看看这个

[http://www.colourloves.com/palettes/most-loved/all-time/meta](http://www.colourlovers.com/palettes/most-loved/all-time/meta)

# hibernate - criteria.createAlias() 乘以数据

> ID：14166389
> 
> 赞同：1
> 
> 时间：2013-01-04T22:57:42.633
> 
> 标签：hibernate, hibernate-criteria

我正在使用以下代码来检索我的数据

```
Criteria cr = session.createCriteria( JobProcess.class );
cr.createAlias("sendMarcs", "sm");
cr.addOrder( Order.desc( "processedTime") );
cr.addOrder( Order.asc( "sm.ats" ) ); 
```

它返回所有数据，但所有数据多次出现，`673`当它应该是size 列表时返回一个 size 列表`99`。我不知道为什么会这样。

是的，我查看了 hibernate 正在使用的 SQL，它是正确的。

此外，如果我删除别名及其顺序，则数据会按预期显示。不相乘，但不排序。

JobProcess.java

```
@Entity
@Table(name = "jobprocess")
@Cache(usage = CacheConcurrencyStrategy.READ_WRITE)
public class JobProcess {

    @Id
    @GeneratedValue
    private Long id;

    @Basic(optional = false)
    @Column(length = 20, name="customerid")
    private String customerId;

    @Basic(optional=false)
    @Column(length = 100)
    private String ATS;

    @Basic(optional=true)
    @Temporal(TemporalType.TIMESTAMP)
    @Column(name="timeprocessed")
    private java.util.Date processedTime;

    @Basic(optional=false)
    @Column(length = 1)
    private String state;

    @Column(length = 300)
    private String notes;

    @Basic(optional = false)
    private long nos;

    @OneToMany(mappedBy = "jobprocessid")
    private Set<SendMarc> sendMarcs = new HashSet<SendMarc>();

    // getters and setters
} 
```

SendMarc.java

```
@Entity
@Table( name = "sendmarc" )
@Cache( usage = CacheConcurrencyStrategy.READ_WRITE )
public class SendMarc
{
    @Id
    @GeneratedValue
    private BigInteger id;

    @Basic( optional = true )
    private BigInteger marcfileid;

    @Basic( optional = false )
    private long jobprocessid;

    @Basic( optional = false )
    @Column( length = 50 )
    private String ats;

    // getters and setters
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T23:14:45.667

它为每个检索的行返回一个对象，就像没有 distinct 的 HQL 查询一样。使用标准，您必须使用

```
cr.setResultTransformer(CriteriaSpecification.DISTINCT_ROOT_ENTITY); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:16:58.930

`#createAlias()`为它也加入的关联创建别名。在您的情况下，如果没有它，您只需从没有连接的表中检索所有行`JobProcess`，并且在附加连接的情况下，您会得到不同的结果。

# objective-c - 在越狱的 iPod touch 上使用 gdb 调试 iOS 应用 Objective-C 符号

> ID：14166390
> 
> 赞同：3
> 
> 时间：2013-01-04T22:57:54.050
> 
> 标签：objective-c, ios, gdb

我正在寻找在越狱的 iPod Touch 4、iOS (5.1.1) 上调试应用程序。唯一的问题是 GDB 似乎对应用程序的类/选择器名称一无所知。

附加和设置地址断点有效，但在尝试使用objective-c名称时无法识别符号。例如，`break -[Class Selector:]`会失败。（我知道`+`并`-`代表不同的班级类型。）

另外，我没有这个应用程序的源代码，也无法获得它。

我希望在没有 xcode 或源的设备上纯粹使用 GDB。

有没有人成功地做到过这一点？提前感谢您的任何答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T23:53:28.070

假设您正在尝试从商店/发布版本中调试应用程序，那么您的二进制文件将被编译器从其中剥离符号。只有调试版本保留符号：发布版本没有理由保留它们。

要找出名称，您需要手动反汇编二进制文件并从那里找出您需要的内容。这是一个冗长的话题，太长了，无法在此处详细输入（O'Reilly 的*Hacking & Securing iOS Applications* book 有一个很好的分步教程）。

请记住，在底层，Objective-C 消息传递框架是由 C 组成的：如果您不熟悉诸如`objc_msgSend`函数系列之类的东西，您可能会发现更好地了解它们会对您有所帮助。由于 Objective-C 中的每个方法调用都是使用发送的，`objc_msgSend`因此您可以通过每次调用时断点来有效地找出类和方法名称（或者更确切地说，断点并自动转储内容：它将被调用很多次来执行它手动将花费太长时间）。

但是，这只会帮助您识别符号名称：当符号从二进制文件中剥离时，您仍然必须在地址本身上设置断点。

# javascript - 为 HTML5 CORS 生成缩略图

> ID：14166397
> 
> 赞同：0
> 
> 时间：2013-01-04T22:58:15.967
> 
> 标签：javascript, canvas, html5-canvas, html5-video, cors

这个问题有两个部分，真的 - 使用画布获取缩略图是直截了当的。K Scott Allen 在[这里发了一个帖子](http://odetocode.com/blogs/scott/archive/2013/01/04/capturing-html-5-video-to-an-image.aspx)

基本上，这是代码，我已经尝试过了：

```
$output = $("#output");
var video = $("#video").get(0);
var canvas = document.createElement("canvas");
    canvas.width = $video.videoWidth * scale;
    canvas.height = $video.videoHeight * scale;
    canvas.getContext('2d')
          .drawImage($video, 0, 0, canvas.width, canvas.height);

    var img = document.createElement("img");
    img.src = canvas.toDataURL();
    $output.prepend(img); 
```

第二部分比较复杂。由于我的 .mpg 视频由 Azure 媒体服务提供，因此对 canvas.getDataUrl() 的调用是跨域请求并且失败。

设置 CORS 标头/标志应该可以工作，但不能。[此处](https://stackoverflow.com/questions/7129178/browser-canvas-cors-support-for-cross-domain-loaded-image-manipulation)StackOverflow 问题的答案中包含图像的解决方法。

此解决方法具有以下代码示例函数，该函数在体负载上运行：

```
function initialize() {

    //will fail here if no canvas support
    try {
        var can = document.getElementById('mycanvas');
        var ctx = can.getContext('2d');
        var img = new Image();
        img.crossOrigin = '';
        //domain needs to be different from html page domain to test cross origin security
        img.src = 'http://lobbydata.com/Content/images/bg_price2.gif';
    } catch (ex) {
        document.getElementById("results").innerHTML = "<span style='color:Red;'>Failed: " + ex.Message + "</span>";
    }

    //will fail here if security error
    img.onload = function () {
        try {
            var start = new Date().getTime();
            can.width = img.width;
            can.height = img.height;
            ctx.drawImage(img, 0, 0, img.width, img.height);
            var url = can.toDataURL(); // if read succeeds, canvas isn't dirty.
            //get pixels
            var imgd = ctx.getImageData(0, 0, img.width, img.width);
            var pix = imgd.data;
            var len = pix.length;
            var argb = []; //pixels as int
            for (var i = 0; i < len; i += 4) {
                argb.push((pix[i + 3] << 24) + (pix[i] << 16) + (pix[i + 1] << 8) + pix[i + 2]);
            }
            var end = new Date().getTime();
            var time = end - start;
            document.getElementById("results").innerHTML = "<span style='color:Green;'>" +
            "Success: Your browser supports CORS for cross domain images in Canvas <br>"+
            "Read " + argb.length+ " pixels in "+ time+"ms</span>";
        } catch (ex) {
            document.getElementById("results").innerHTML = "<span style='color:Red;'>Failed: " + ex + "</span>";
        }

    }

} 
```

所以我的问题是如何修改 K. Scott Allens 的代码以正确设置 CORS 标头并从视频而不是示例中的 img 生成缩略图？

我尝试在视频元素和画布上设置 crossOrigin ="" 和 crossOrigin="Anonymous" ，但没有成功。

任何帮助，将不胜感激。

罗伯托

PS。这里有一个对浏览器 CORS 图像支持的[测试](http://maplarge.com/CrossOriginImageTest.html)。这种获取缩略图的方法确实有效。[有一个页面在这里](http://html5-canvas-test.vipserv.org/)使用它（虽然，没有跨域的东西）

# domain-driven-design - 在 DDD 中，每个存储库或有界上下文或事务有一个 UoW？

> ID：14166405
> 
> 赞同：5
> 
> 时间：2013-01-04T22:59:12.510
> 
> 标签：domain-driven-design, repository-pattern, unit-of-work

在 DDD 中，聚合根可以有一个存储库。让我们采用一个**Order**聚合，它是非持久性对应物**OrderRepository**和持久性对应物**OrderUoW**。我们还有**ProductVariant**聚合，它跟踪订单中产品的库存。它可以有**ProductVariantRepository**和**ProductVariantUoW**。

Order 和 ProductVariant 的工作方式是在保留订单之前检查库存。如果有库存，订单将通过调用 OrderUoW.Commit() 进行持久化。是的，接下来会调用 ProductVariantUoW.Commit() 来更新产品的库存。

不幸的是，事情可能会变糟，用户在短时间内购买了相同的产品（将其视为两个用户购买相同产品的网络应用程序）。现在，第二个用户的整个交易应该会因为恢复刚刚创建的订单而失败。我应该调用 OrderUoW 来回滚更改（应该从数据库中删除订单）吗？或者我应该把两个 UoW.Commit() 操作都放在一个事务范围内，所以一个 commit() 失败会回滚更改？或者两个存储库（Order、ProductVariant）都应该只有 UoW 并且只需要一个事务范围？

我可以通过说，在涉及多个存储库的情况下如何处理事务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T05:45:20.673

您使用工作单元的方式似乎有点细粒度。以防万一您还没有阅读 Martin Fowler 的观点：[http ://martinfowler.com/eaaCatalog/unitOfWork.html](http://martinfowler.com/eaaCatalog/unitOfWork.html)

话虽如此，您希望在用例级别处理事务。预先检查库存的事实只是一种方便（UX），并且在持久化各种位时也应该检查库存水平。库存不足可以引发异常。

应设置事务隔离级别，以便两个“同时”部分连续执行。因此，无论谁先更新库存水平，都会“获胜”。然后第二个将引发异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-10T10:15:06.580

如果您可以使用单个 UoW，那么就这样做，因为它更容易。

如果您的存储库位于不同的数据库上（或者一个是基于文件的，而其他的不是），那么您可能会被迫使用多个 UoW，但是您也在编写回滚命令，因为如果 UoW1 将更改保存到 SqlRepo好的，但是 UoW2 无法保存对 FileRepo 的更改，那么您需要回滚 SqlRepo。如果可以避免的话，不要费心编写所有回滚命令的东西！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T01:06:08.200

我们可以问的一个问题是谁在做以下事情：

> Order 和 ProductVariant 的工作方式是在保留订单**之前检查库存。如果有库存，订单将**通过调用 OrderUoW.Commit() 进行持久化。是的，接下来会调用 ProductVariantUoW.Commit() 来更新产品的库存。

有人认为这种工作属于服务层，它允许服务层将跨聚合对象的事物放入单个事务中。

根据[http://www.infoq.com/articles/ddd-in-practice](http://www.infoq.com/articles/ddd-in-practice)：

> 一些开发人员更喜欢在 DAO 类中管理事务，这是一个糟糕的设计。这导致太细粒度的事务控制，无法灵活管理事务跨越多个域对象的用例。服务类应该处理事务；这样，即使事务跨越多个域对象，服务类也可以管理事务，因为在大多数用例中，服务类处理控制流。

我认为作为使用单个事务的替代方法，您可以使用 ProductVariant 声明库存，并且，如果所有必要的库存项目都可用，那么您可以提交订单。否则（即，您无法领取订单所需的所有产品）您必须退回使用补偿交易成功领取的库存。结果是，在一个订单提交不成功的情况下，一些库存会暂时出现其他订单不可用，但好处是你可以在没有分布式事务的情况下工作。

尽管如此，这个逻辑仍然属于服务层，而不是 DAO 类。

# list - 如何将默认图像添加到 SharePoint 2010 自定义列表实例图像列

> ID：14166406
> 
> 赞同：0
> 
> 时间：2013-01-04T22:59:11.363
> 
> 标签：list, sharepoint

我正在 Visual Studio for SharePoint 2010 中创建自定义列表定义。在列表定义元素文件中，我为列表实例提供了一些默认值，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
<ListInstance Title="News"
            OnQuickLaunch="FALSE"
            TemplateType="10000"
            Url="Lists/News"
            Description="Contains news articles related to happenings at Corporate.">
<Data>
  <Rows>
    <Row>
      <!-- Default list data -->
      <Field Name="Photo">http://myserver/sites/foobar/Style%20Library/Images/Custom/myimage.png</Field>
      <Field Name="Title">My Title</Field>
      <Field Name="Body">My article.</Field>
      <Field Name="Modified">12-21-2012</Field>
      <Field Name="Author">99;#mydomain\bsmith</Field>
      <Field Name="Expires">01-22-2013</Field>
    </Row>
  </Rows>
</Data> 
```

使用上述值成功创建了默认列表，但照片和作者列显示为空白。关于如何正确填充这些列的任何想法？我知道照片 URL 是有效的，因为我可以浏览到它。另一个帖子指出作者列的“99;#”前缀——没有前缀，列表中的每一列都显示为空白。

此外，如果重要的话，这里是列表模式字段：

```
<Field ID="{d3a92d97-2b77-4a25-9698-3ab54874bc17}"
         Name="Photo" ShowInNewForm="TRUE" ShowInEditForm="TRUE"
         Type="Image" DisplayName="Photo"
         Required="TRUE"></Field>
  <Field ID="{d3a92d97-2b77-4a25-9698-3ab54874bc11}"
         Name="Title"
         Type="Text" DisplayName="Title"
         Required="TRUE"></Field>
  <Field ID="{d3a92d97-2b77-4a25-9698-3ab54874bc16}"
         Name="Body"
         Type="Note" DisplayName="Body"
         Required="TRUE" NumLines="100"></Field>
  <Field ID="{d3a92d97-2b77-4a25-9698-3ab54874bc13}"
         Name="Modified"
         Type="DateTime" DisplayName="Modified"
         Required="TRUE"></Field>
  <Field ID="{d3a92d97-2b77-4a25-9698-3ab54874bc14}"
         Name="Author"
         Type="Text" DisplayName="Author"
         Required="FALSE"></Field>
  <Field ID="{d3a92d97-2b77-4a25-9698-3ab54874bc15}"
         Name="Expires"
         Type="DateTime" DisplayName="Expires"
         Required="FALSE"></Field> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-08T21:53:51.307

尝试在您的列表实例中像这样配置您的字段数据。

```
<Field Name="Photo"><![CDATA[<IMG SRC="/sites/foobar/Style%20Library/Images/Custom/myimage.png"></IMG>]]></Field> 
```

# html - 如何居中和垂直对齐到页面内的 div 中间？

> ID：14166412
> 
> 赞同：1
> 
> 时间：2013-01-04T22:59:44.260
> 
> 标签：html, css, format, positioning

我已经在互联网上搜索了无数小时以寻找解决方案，但我似乎永远找不到它。如果我有一个登录页面，并且我想让它完全位于页面的中心怎么办。

我从来没有想出如何做到这一点，希望有人能帮助我解决我缺乏知识的问题。

这是一个例子 ![在此处输入图像描述](../Images/18cbf3cbfc402d64bfabae564d5cc7c4.png)

我想要的是有一个高度为 410 像素、宽度为 756 像素的 div 以屏幕为中心。所以垂直和水平。然后我希望能够将 other 与内容一起放入其中。例如，也许我想在那里放一个登录页面或博客文章或任何东西。

**提前致谢！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:01:12.920

使用`margin: auto;`.

HTML：

```
​&lt;div class="middle">middle</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

CSS：

```
​.middle
{
    width: 100px;
    height: 50px;
    border: solid 1px red;
    margin: auto;
}​ 
```

[有关垂直居中的信息，请参阅此链接](http://www.jakpsatweb.cz/css/css-vertical-center-solution.html)。

这是一个[完整的工作示例](http://jsfiddle.net/ydWQF/)。

# c++ - Doxygen/C++：如何链接到匿名命名空间变量

> ID：14166416
> 
> 赞同：11
> 
> 时间：2013-01-04T23:00:11.263
> 
> 标签：c++, doxygen

我正在使用 Doxygen 来记录我的代码。许多代码在定义常量的 cpp 文件中都有匿名名称空间。我已经设定：

`EXTRACT_ANON_NSPACES = YES`

在我的 Doxygen 文件中，所有匿名命名空间都根据需要记录。

我的问题是我想引用匿名命名空间中的变量。例如，假设命名空间之一在我的 Doxygen 文档中定义在`MyClass::anonymous_namespace{MyFile.cpp}::kMyConstant`. 我认为另一个注释块（例如，对于一个函数）可以链接到该常量，例如：

`@see MyClass::anonymous_namespace{MyFile.cpp}::kMyConstant`

不幸的是，我得到的唯一链接是 MyFile.cpp，但不是通过匿名命名空间到常量变量。显然我想这样做，以便如果常量的值发生变化，文档将在重新运行 Doxygen 时引用新值。如果常量发生变化，将常量的显式值放入文档中会很危险。

我上面的格式不正确吗？我已经为此广泛寻找答案，但无济于事。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-05T18:05:04.817

你想要的还没有实现，但我同意它很有用，你使用的格式是正确的，应该可以工作。

我将在下一个版本中实现这一点。

# angularjs - 停止 AngularJS 插入使用 ng-include

> ID：14166420
> 
> 赞同：3
> 
> 时间：2013-01-04T23:00:26.957
> 
> 标签：angularjs, zurb-foundation, css-selectors

我正在使用 Foundation 布局框架，它会自动将最后一个兄弟浮动`.column`到右侧，我非常感谢这是一种行为。然而，AngularJS 会自行`span.ng-scope`在 every 之后插入`div.column`，这会以某种方式导致浏览器将最后一个 span 视为最后一个兄弟`.column`（即使它不是）。

具体来说，Foundation 中负责此操作的 css 是：

```
[class*="column"] + [class*="column"]:last-child { float: right; } 
```

据我了解，`[attribute*="substring"]`应该只选择匹配的兄弟姐妹，因此，对于上述内容，只选择其类属性包含`column`（包括`columns`）的元素。我认为跨度标签的`class`属性不包含不`column`应该匹配（因此被忽略`:last-child`）。然而，情况似乎并非如此。

无论如何，跨度*会*导致问题：

*   [Angular](http://jsfiddle.net/jshado1/F5VdG/)搞砸了（jsfiddle）
*   [没有 Angular 也能正常工作](http://jsfiddle.net/jshado1/F5VdG/1/)（同样的 jsfiddle，没有*ng-include*）

有没有办法配置角度来停止插入这些`span`标签？我会不情愿地修改css选择器以某种方式忽略所有span标签；但是我最终可能需要/想要使用跨度标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T23:21:53.803

由于您表示可以将 div 移到内部，因此可以：

```
<ng-include src="'main.tmpl'"></ng-include> 
```

然后在您的模板中：

```
<div class="row">
   <article id="sidepanels" class="four columns">
   ...
</div> 
```

我不知道有什么方法可以防止 angular 插入 span 标签（我认为它会以这种方式跟踪范围——用于垃圾收集）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T18:55:21.137

您也可以尝试我的不创建范围的包含指令版本：[Gist source](https://gist.github.com/4387706)。

由于没有创建范围，AngularJS 不应该创建额外的元素来维护范围（它实际上使用数据属性来存储到范围的链接）。

# jquery - 图库图片延迟加载？

> ID：14166423
> 
> 赞同：0
> 
> 时间：2013-01-04T23:00:47.367
> 
> 标签：jquery, html, gallery

我在一个网站中有这个画廊页面，该页面已被分类为多个部分。问题是它在第一次加载时加载了整个图像，这反过来又使网站非常滞后且无响应。

据我了解，延迟加载在这里对我有帮助，但显然它不适用于当前代码。如果您有任何其他想法，请告诉我，甚至是解决延迟加载问题的方法。

抱歉，这是网站当前的图库页面。 [http://www.hishamomran.com/zahabia3/gallery.html](http://www.hishamomran.com/zahabia3/gallery.html)

非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:05:12.007

延迟加载不起作用，因为插件 URL 错误，在控制台上查看，它会引发 404 错误。 [http://www.hishamomran.com/zahabia3/js/jquery.lazyload.js](http://www.hishamomran.com/zahabia3/js/jquery.lazyload.js)

编辑：`<img data-original=“img/example.jpg” src=“img/grey.gif”&gt;`这就是你的图像应该是什么样子。如果您将其放入 src 属性，它肯定会加载您的图像。

# c++ - “#if Foo - 0 == 0”和“#if defined(Foo) && Foo == 0”有什么区别？

> ID：14166426
> 
> 赞同：12
> 
> 时间：2013-01-04T23:01:11.310
> 
> 标签：c++, c, qt, c-preprocessor

在[qt 文档](http://qt-project.org/wiki/Coding-Conventions)中找到它。和有什么区别

```
#if defined(Foo) && Foo ==  0 
```

和

```
#if Foo - 0 ==  0 
```

据我了解，如果 Foo 未定义，后者也将是错误的？我在哪里可以读到这个？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-04T23:06:04.110

如果`Foo`未定义，则后者将转换为

```
#if 0 - 0 == 0 
```

这是*真的*，不是假的。请记住，在`#if`所有未定义的标识符下都将替换为文字`0`（当然，一旦`defined()`评估了所有运算符）。这甚至适用于匹配语言关键字的预处理标记。`0`在 C 语言中，所有关键字都在此上下文中替换为。在 C++ 中的关键字`true`和`false`免于替换，而所有其他关键字都被替换。

（顺便说一句，这意味着在 C`true`中将悄悄地替换为`0`if`<stdbool.h>`不包括在内，而`1`if`<stdbool.h>`包括在内。）

同时

```
#if defined(Foo) && Foo == 0 
```

`Foo`未定义时为假。所以，这就是你的不同之处。

Qt 文档确实似乎表明前者与后者相同。我不知道他们为什么要这样做，因为它们肯定是不等价的。这似乎是 Qt 文档中的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T23:19:53.937

Foo == 0 和 Foo - 0 == 0 之间的区别在于，在前者中，Foo 必须定义一个值：

```
#define Foo 0 
```

并且不能是：

```
#define Foo  //  Foo == 0 would give an error, cannot evaluate Foo 
```

而在 Foo - 0 == 0 的情况下，可以在没有值的情况下定义 Foo

所以：

```
#if defined(Foo) && Foo ==  0 
```

表示 Foo 已定义并且它有一个值（在这种情况下为 0）。

和：

```
#if Foo - 0 ==  0 
```

意味着 Foo 要么用 0 定义，要么用不带值定义，但由于它没有第一种情况下的 defined(Foo) ，因此 Foo undefined 也将适用。

# jquery - jQueryUI 对话框/日期选择器自动打开

> ID：14166430
> 
> 赞同：12
> 
> 时间：2013-01-04T23:01:22.423
> 
> 标签：jquery, jquery-ui, dialog, datepicker

我目前有一个对话框，其中包含两个输入作为其内容（两个输入使用`.datepicker()`）。当我打开对话框时，第一个输入成为焦点，第一个日期选择器自动出现。我曾尝试隐藏 div 并模糊输入，但这会导致日期选择器不再出现在焦点上。

理想情况下，我希望能够做到以下几点：

*   打开对话框（不显示日期选择器）。
*   单击第一个输入并显示日期选择器。

这是我当前的代码：

JAVASCRIPT：

```
$("#to").datepicker({
      onClose: function (selectedDate) {
         $("#from").datepicker("option", "minDate", selectedDate);
      }
    });

    $("#from").datepicker({
     onClose: function (selectedDate) {                            
         $("#to").datepicker("option", "maxDate", selectedDate);
    }
});

$("#settingsDialog").dialog({
     autoOpen: false,
    open: function (event, ui) {
                     if ($(".ui-datepicker").is(":visible"))
                         $(".ui-datepicker").hide();

                     $("#to").blur();
                     $this.focus().click();
                 },
     close: function () {
         $(this).dialog("close");
     }
}); 
```

我还做了一个 jsfiddle 演示：http: [//jsfiddle.net/ARnee/19/](http://jsfiddle.net/ARnee/19/)

我在网上搜索了一个解决方案，发现了类似的[问题](https://stackoverflow.com/questions/932420/jquery-ui-datepicker-opens-automatically-within-dialog)，但似乎没有任何帮助。谁能帮帮我？！

编辑：

我使用的浏览器是 Chrome。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-06-21T07:53:59.717

尝试将包含日期选择器的输入上的**tabindex**属性设置为 -1。

```
<input type="text" id="to" tabindex="-1" /> 
```

***编辑：***

```
<input id="to" type="text" tabindex="-1" />
<input id="from" type="text" tabindex="-1" /> 
```

演示：http: [//jsfiddle.net/ARnee/32/](http://jsfiddle.net/ARnee/32/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-04T23:36:16.683

可以在没有高度的对话框中粘贴虚拟输入，因此不会被看到。将它放在日期选择器字段之前

```
<input style="height:0px; border:none"/> 
```

演示：http: [//jsfiddle.net/ARnee/20/](http://jsfiddle.net/ARnee/20/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T23:32:31.063

您可以在打开对话框时创建日期选择器，如下所示：

```
$("#settingsDialog").dialog({
    autoOpen: false,
    open: function (event, ui) {
                     //if ($(".ui-datepicker").is(":visible"))
                     //    $(".ui-datepicker").hide();

                     $("#to").blur();
                 },
     close: function () {
         $("#to").datepicker("destroy");
         $("#from").datepicker("destroy");
         $(this).dialog("close");
     }
});

$("#b1").click(function(){
      $("#settingsDialog").dialog("open");
      $("#to").datepicker({
         onClose: function (selectedDate) {
            $("#from").datepicker("option", "minDate", selectedDate);
         }
      });

      $("#from").datepicker({
         onClose: function (selectedDate) { 
            $("#to").datepicker("option", "maxDate", selectedDate);
         }
      });
}); 
```

​</p>

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T23:50:45.413

```
$(document).ready(function(){

$("#settingsDialog").dialog({
     autoOpen: false,
    open: function (event, ui) {
        $("#to").datepicker({
        onClose: function (selectedDate) {
            $("#from").datepicker("option", "minDate", selectedDate);
        }
    });

    $("#from").datepicker({
        onClose: function (selectedDate) {                            $("#to").datepicker("option", "maxDate", selectedDate);
    }
});
                     if ($(".ui-datepicker").is(":visible"))
                         $(".ui-datepicker").hide();

                     $("#to").blur();
                     $this.focus().click();
                 },
     close: function () {
         $("#to").datepicker( "destroy" );
         $("#from").datepicker( "destroy" );
         $(this).dialog("close");
     }
});

    $("#b1").click(function(){
       $("#settingsDialog").dialog("open");
    });

});
​ 
```

# algorithm - 寻找可能利润的算法

> ID：14166431
> 
> 赞同：0
> 
> 时间：2013-01-04T23:01:22.530
> 
> 标签：algorithm

我正在寻找一种算法（除了天真的蛮力解决方案没有运气），它有效地（O（n ^ 2）最好）执行以下操作：

假设我正在玩一个游戏，在这个游戏中我必须回答 n 个问题（每个问题来自不同的类别）。对于每个类别“i” i=1,...,n 我计算了概率 p_i 以给出正确答案。

对于每个连续的 k 个正确答案，我得到 k^4 分。预期的平均利润是多少？

我将在以下示例中阐明预期利润的含义：

在 n=3 且 p_1=0.2,p_2=0.3,p_3=0.4 的情况下

预期利润为

EP= (0.2* 0.3* 0.4 )3^4+ （我得到所有 3 个答案正确）

*   (0.2* 0.3* 0.6 )2^4+ (0.8* 0.3* 0.4 )2^4+ (0.2* 0.7* 0.4 )2+ （2个答案正确）

*   0.2* 0.7* 0.6 ) + (0.8* 0.3* 0.6 )+ (0.8*0.7* 0.4 ) （1个答案正确）

    显然，对于每个可能的结果，我都在计算概率并将其乘以获得的分数。然后从所有这些中扣除总和。

有任何想法吗？我只对总和本身感兴趣。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:18:42.460

假设,或'th 问题被错误回答，设 为问题`A[t]`后的预期利润。然后你可以计算`t``t = 0``t = n``t`

`A[0] = 0`

`A[t]`= sum(i = 0..t-1) (得到问题的概率`i`..`t-2`对与`t-1`错) * (( `t-i-1`) ⁴ + A[i]) when `0 < t < n`.

`A[n]`计算类似于上面的一般情况，除了你还应该添加一个术语来表示`i`正确回答 th 之后的所有问题。

# php - PDO插入成功但不成功？

> ID：14166433
> 
> 赞同：2
> 
> 时间：2013-01-04T23:01:33.707
> 
> 标签：php, mysql, pdo

我正在尝试使用 PDO 插入 MySQL 表。代码：

```
public function sendMail($to, $body) {
    /* this all works
     *
    error_reporting(E_ALL);
    ini_set('display_errors', '1');
    $stmt = $this->database->prepare("SELECT * FROM users");
    $stmt->execute();
    $fetch = $stmt->fetchAll();
    print_r($fetch);
     */

    $stmt = $this->database->prepare("INSERT INTO 
        inbox_unread (date, body, to, from) VALUES (:date, :body, :to, :from)");
    echo $stmt->bindParam(":date", date("Y-m-d H:i:s"));
    echo $stmt->bindParam(":body", $body);
    echo $stmt->bindParam(":to", $to);
    echo $stmt->bindParam(":from", $_SESSION['username']);
    if ($stmt->execute()) {
        echo "yes";
    } else {
        print_r($this->database->errorInfo());
    }
} 
```

这是我得到的输出：

```
1111Array ( [0] => 00000 [1] => [2] => ) 
```

数据库：

```
SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;

--
-- Database: `sandbox`
--

-- --------------------------------------------------------

--
-- Table structure for table `inbox_unread`
--

CREATE TABLE IF NOT EXISTS `inbox_unread` (
  `mail_id` int(11) NOT NULL AUTO_INCREMENT,
  `date` datetime NOT NULL,
  `body` text NOT NULL,
  `to` varchar(255) NOT NULL,
  `from` varchar(255) NOT NULL,
  PRIMARY KEY (`mail_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 AUTO_INCREMENT=1 ;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */; 
```

'00000' 显然意味着成功，但如果成功则不应打印。没有向数据库中插入任何内容。我确定这是一个错字，但我找不到它。

SQL 语句：

```
INSERT INTO inbox_unread (date, body, to, from) VALUES ('2013-01-04 23:40:58', 'test', 'will', 'will') 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T23:53:12.140

您的查询中有一个保留字：

```
 $stmt = $this->database->prepare("INSERT INTO 
    inbox_unread (date, body, to, `from`) VALUES (:date, :body, :to, :from)"); 
```

Stackoverflow 语法高亮显示实际上很明显。使用这样的通用列名，最好将它们全部放在反引号中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T23:39:54.247

假设您的值都是非空且有效的（您已经用来`var_dump()`确保按预期收集它们的值）......</p>

首先，您可能想使用`$stmt->errorInfo()`而不是`$this->database->errorInfo()`因为您使用的是准备好的语句。 [文档](http://php.net/manual/en/pdo.errorinfo.php)，在**“返回值”**部分的最后一段中写道：

> **`PDO::errorInfo()`**仅检索直接在数据库句柄上执行的操作的错误信息。如果通过[**`PDO::prepare()`**](http://php.net/manual/en/pdo.prepare.php)or创建 PDOStatement 对象[**`PDO::query()`**](http://php.net/manual/en/pdo.query.php)并在语句句柄上调用错误，**`PDO::errorInfo()`**则不会从语句句柄中反映错误。您必须调用[**`PDOStatement::errorInfo()`**](http://php.net/manual/en/pdostatement.errorinfo.php)以返回对特定语句句柄执行的操作的错误信息。

您可以做的另一件事是`var_dump`调用`$stmt->execute()`，以便您准确了解它返回的内容。

最后，[马里奥](https://stackoverflow.com/users/345031/mario)关于打开错误报告是正确的。如果您想了解有关这些的更多详细信息，请查看文档中的[**PDO 错误和错误处理**](http://php.net/manual/en/pdo.error-handling.php)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T23:29:15.527

替换这一行：

```
echo $stmt->bindParam(":date", date("Y-m-d H:i:s")); 
```

用这些：

```
$date = date("Y-m-d H:i:s");
echo $stmt->bindParam(":date", $date); 
```

因为**通过引用**而不是按值`bindParam()`绑定变量。

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T23:09:42.577

尽管我对 Binds 没有那么丰富的经验，但您的绑定手册与您所做的背道而驰。

[http://php.net/manual/en/pdostatement.bindparam.php](http://php.net/manual/en/pdostatement.bindparam.php)

尝试删除您`echo`的脚本，使您的脚本如下所示：

```
 $stmt->bindParam(":date", date("Y-m-d H:i:s"));
   $stmt->bindParam(":body", $body);
   $stmt->bindParam(":to", $to);
   $stmt->bindParam(":from", $_SESSION['username']); 
```**

# mongodb - 如何在meteor中建立单独的测试和开发数据库

> ID：14166436
> 
> 赞同：7
> 
> 时间：2013-01-04T23:01:46.137
> 
> 标签：mongodb, tdd, meteor

我已经为我的流星应用程序编写了一些测试。由于它们具有删除所有文档或填充新文档的设置和拆卸方法，因此我想在专用于测试的数据库上运行它们。

我注意到数据库存储在 .meteor/local/db 中。理想情况下，我希望从不同的端口访问 db_test 和 db_dev。

这可能吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-05T05:34:50.753

您必须运行两个`mongod`进程，例如

```
# Dev
mongod --port 27017 --dbpath .meteor/local/db_dev

# Testing
mongod --port 28017 --dbpath .meteor/local/db_test 
```

* * *

[编辑] 这应该有效。使用排行榜示例项目：

```
MONGO_URL="mongodb://127.0.0.1:27017/appname_dev" meteor run --port 3000
MONGO_URL="mongodb://127.0.0.1:28017/appname_test" meteor run --port 4000 
```

那将使用单独的数据库。

# ios - UIScrollView 子视图不会调整大小

> ID：14166442
> 
> 赞同：3
> 
> 时间：2013-01-04T23:02:12.987
> 
> 标签：ios, objective-c, uiscrollview, uiimageview

**设计：**
视图层次结构如下：

*   `UIScrollView`（用于分页多个图像）
    *   `UIScrollView`（用于启用缩放`UIImageView`）
        *   `UIImageView`

            *   `UIView`（原点，大小相对于`UIImage`in `UIImageView`）
            *   `UIView`
            *   `UIView`...
    *   `UIScrollview`
        *   `UIImageView`
            *   `UIView`
            *   `UIView`...
    *   `UIScrollView`... 等等

**执行：**

```
- (id)init  
{  
self = [super init];  
if (self) {  
    // Custom initialization  
    self.minimumZoomScale = 1.0f;  
    self.maximumZoomScale = 4.0f;  
    self.zoomScale = 1.0f;  
    self.bouncesZoom = true;  
    self.bounces = true;  
    self.tag = 10;  
    self.alwaysBounceHorizontal = false;  
    self.autoresizesSubviews = YES;  

    self.zoomView = [[UIImageView alloc] init];
    self.zoomView.userInteractionEnabled = YES;
    self.zoomView.autoresizesSubviews = YES;
}

return self;
}  
- (void)displayImage:(UIImage *)image  
{    
// Set the image in the view  
[_zoomView setImage:image];  

// Set the Frame size to the size of image size  
// Ex. Resulting ScrollView frame = {0,0},{1250,1500}  
// Ex. Resulting ImageView frame = {0,0}, {1250,1500}  
CGRect scrollFrame = self.frame;  
scrollFrame.size.width = image.size.width;  
scrollFrame.size.height = image.size.height;  
self.frame = scrollFrame;  

CGRect iViewFrame = _zoomView.frame;  
iViewFrame.size.width = image.size.width;  
iViewFrame.size.height = image.size.height;  
_zoomView.frame = iViewFrame;  

// Add subviews before resetting the contentsize  
for (customClass* field in list.fields) {  

    UIView* view = [[UIView alloc] initWithFrame:CGRectMake([field.x floatValue], [field.y floatValue], [field.width floatValue], [field.height floatValue])];  
    view.backgroundColor = [UIColor redColor];  
    view.autoresizingMask = UIViewAutoresizingFlexibleBottomMargin | UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleTopMargin |UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;  

    [_zoomView addSubview:view];  
}  

// Set the Frame size to the size of scrollview frame size  
// Ex. Resulting ScrollView Frame = {0,0},{320,460}  
// Ex. Resulting ImageView Frame = {0,0},{320,460}  
CGRect scrollViewFrame = self.frame;  
scrollViewFrame.size.width = 320.0f;  
scrollViewFrame.size.height = 460.0f;  
self.frame = scrollViewFrame;  

CGRect imageViewFrame = _zoomView.frame;  
imageViewFrame.size.width = self.bounds.size.width;  
imageViewFrame.size.height = self.bounds.size.height;  
_zoomView.frame = imageViewFrame;  

self.contentSize = _zoomView.bounds.size;  

[self addSubview:_zoomView];  
} 
```

以上是我尝试实现的代码。它将`UIView`s添加`UIImageView`到`UIScrollView`. 但是 的相对原点`UIView`不正确（调整大小之前和之后）。

`UIView`为了让s 正确放置在 s中，我应该做些什么不同的事情`UIImageView`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T09:58:57.967

这是“滚动视图子视图不会调整大小”在谷歌上的热门话题。对于遵循该链接的其他任何人：

查看您的源代码并与我的源代码进行比较，我意识到在 Interface Builder 中，我的 NIB 文件的“自动大小子视图”复选框未选中。我有一个模糊的记忆，这可能是因为在旧版本的 Xcode 中（这是一个已经维护了一段时间的旧项目）...... UIScrollView 默认将其关闭。

所以：检查你是否在 Xcode/Interface Builder 中正确设置了它，和/或你在代码中设置它。

# vb.net - 实体框架，立即在返回的类中过滤循环 Icolleciton 列表

> ID：14166448
> 
> 赞同：-1
> 
> 时间：2013-01-04T23:02:40.260
> 
> 标签：vb.net, entity-framework-4, linq-to-entities

使用新的 MVC 4 框架探索 REST 服务的精彩世界。我偶然发现了一个问题，即在返回的 JSON 数据中我想立即过滤而不用 EF。

我的员工班级：

```
 Imports System
    Imports System.Collections.Generic
Partial Public Class EMPLOYEE
    Public Property EM_ID As Long
    Public Property EM_FIRSTNAME As String
    Public Property EM_LASTNAME As String

    Public Overridable Property AS_EM As ICollection(Of AS_EM) = New HashSet(Of AS_EM)
End Class 
```

我的 AS_EM 课程

```
Partial Public Class AS_EM
    Public Property ASE_ID As Long
    Public Property ASE_STATUS As String
    Public Property ASE_MOVE As String
    Public Property ASE_WHEN As Date
    Public Property ASE_EM_FK As Long
    Public Overridable Property EMPLOYEE As EMPLOYEE
End Class 
```

简化图如下。

![数据库模式](../Images/d2e3917d2b0b73a9b59ad427b85b137a.png)

一名员工可以有多个资产分配给他/她。

我的 EmployeeController 是这样构造的

```
 Public Function getEmployeebyOW(ByVal OW As String) As EMPLOYEE

        Dim context1 As New amsadmEntities
        Dim result = (From e In context1.EMPLOYEE
                 Where e.EM_CORPID = OW
                 Select e
                 ).FirstOrDefault
        Return result
    End Function 
```

当我运行它时，我得到了我想要的东西，一个 json 序列化的员工，其中包含他的所有资产历史，包括 ACT(ive) 和 PAS(sive)。屏幕截图显示了具有 PAS(ive) 资产分配的第一个

![在此处输入图像描述](../Images/eccf96356ea64b534529ca39ef865660.png)

我想知道如何直接过滤资产分配列表，所以我只得到具有 ASE_STATUS="ACT" 的资产，直接在 LINQ 过滤器中应用它，而不使用匿名类型。

到目前为止，我发现的唯一方法是首先检索 Employee 和他的资产分配集合，然后将其删除，过滤该列表并重新附加。

```
 Public Function getEmployeebyOW(ByVal OW As String) As EMPLOYEE

        Dim context As New amsadmEntities
        Dim result = (From e In context.EMPLOYEE
                 Where e.EM_CORPID = OW
                 Select e
                 ).FirstOrDefault

        Dim goodentries As ICollection(Of AS_EM) =
               (From a In context.AS_EM
               Where a.ASE_EM_FK = result.EM_ID And a.ASE_STATUS = "ACT"
               Select a).ToList
        result.AS_EM.Clear()
        For j = 0 To goodentries.Count - 1
            result.AS_EM.Add(goodentries(j))
        Next
        Return result
    End Function 
```

有没有更好更快的方法？无法在主 Linq 查询中对 Icollection 应用 Where 条件。

我想保持 EF 原样，因为员工的资产历史对于其他控制器和视图至关重要。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T11:30:19.520

更好的方法是使用两个单独的 EF 查询来加载员工及其（他们的）活动资产。如果您在同一个上下文实例上执行这些查询，EF 应该会自动填充导航属性。

如果您只需要加载单个员工，甚至可以使用[`EntityCollection.CreateSourceQuery`](https://stackoverflow.com/questions/10901553/will-the-orberby-for-an-icollection-be-performed-on-the-database-level-or-appl/10901621#10901621). [这里](https://stackoverflow.com/questions/5602371/entity-framework-4-how-to-cap-the-number-of-child-elements-from-another-table/5603857#5603857)提到了过滤导航属性的所有典型选项。

# dart - 为 dart-html5-samples 运行“pub install”会导致奇怪的错误

> ID：14166451
> 
> 赞同：0
> 
> 时间：2013-01-04T23:02:57.063
> 
> 标签：dart, dart-pub

在为 dart-html5-samples 运行“pub install”时遇到了一些奇怪的错误。第一个是：

```
Illegal argument(s): join(): part 0 was null, but part 1 was not. 
```

第二个是：

```
Running pub install ...
Pub install failed, [1] Resolving dependencies...
Could not find package "unittest 0.0.0-r.13075" at http://pub.dartlang.org. 
```

发生了什么事，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:02:57.063

第一个错误是：

```
Illegal argument(s): join(): part 0 was null, but part 1 was not. 
```

那是因为 pubspec.yaml 包含：

```
dependencies:
  htmlescape:
    sdk: htmlescape 
```

htmlescape 不再随 SDK 一起提供。删除依赖项解决了这个问题。我只是在我的 lib 目录中制作了 htmlescape.dart 的副本。最终，一旦修复了以下错误，我将不再需要我自己的副本：

[http://code.google.com/p/dart/issues/detail?id=1657](http://code.google.com/p/dart/issues/detail?id=1657)

第二个错误是：

```
Running pub install ...
Pub install failed, [1] Resolving dependencies...
Could not find package "unittest 0.0.0-r.13075" at http://pub.dartlang.org. 
```

dart-html5-samples 依赖于 vector_math，而 vector_math 又依赖于 unittest。我认为他们一定改变了 pub 加载 unittest 的方式。运行`pub update`解决了问题。

# javascript - JavaScript 命令未在 Safari 中按顺序执行

> ID：14166459
> 
> 赞同：3
> 
> 时间：2013-01-04T23:03:31.980
> 
> 标签：javascript, macos, safari

我在处理另一个问题时发现了这个错误。列出的 JavaScript 命令的顺序与它们在 Safari 中的执行顺序不同：

例子：

```
alert('here');
document.write('This is the hidden message.');
alert('You should be seeing the hidden message by now.'); 
```

在我的浏览器中，在语句`alerts`之前执行。`document.write()`我已经在使用 Safari 版本 5.17、6.0 和 6.0.2 的两个不同 Mac OS X 上看到了这个错误，但我还没有确认其他人已经看到了这个错误。

这是小提琴：

[http://jsfiddle.net/akJD7/](http://jsfiddle.net/akJD7/)

谁能确认他们看到了这一点，如果是，请告诉我为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T23:09:01.250

我不认为这是一个错误，严格来说。只是都是同步的，第二次alert之前没有repaint。重绘通常不会在浏览器事件循环的同一“滴答”内发生（尽管`document.write`似乎在其他浏览器中强制重绘，例如 Chrome）。

这个（丑陋的）解决方法应该解决它：

```
alert('here');
document.write('This is the hidden message.');
setTimeout(function() {
    alert('You should be seeing the hidden message by now.');
}, 0); 
```

​</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T23:11:56.010

试试这个，如果你有 jQuery：http: [//jsfiddle.net/2Kcuz/](http://jsfiddle.net/2Kcuz/)

根据我的评论，我的猜测是您添加的文本`document.write`尚未呈现（但它仍然存在）。

# android - Android EditText在焦点更改为其他元素后窃取焦点

> ID：14166460
> 
> 赞同：1
> 
> 时间：2013-01-04T23:03:35.740
> 
> 标签：android

我知道这里有很多答案可以防止 EditTexts 窃取对活动创建的关注。但是，我有一个不同的问题。

我有一个滚动视图，其中包含各种编辑文本和普通视图，其 onclicks 会拉出各种对话框。如果我单击 EditText，然后单击其中一个视图。完成一个对话框后，我返回到我的主要活动，重点是 EditText。

我试过类似的东西：

```
onClick(View v){
  viewClickAction();
  view.setFocusable(true);
  view.requestFocus();
} 
```

强行把注意力集中在这些观点上，但没有积极的结果。

还有其他想法吗？

# wpf - 我的列表框数据绑定有什么问题？

> ID：14166463
> 
> 赞同：0
> 
> 时间：2013-01-04T23:03:43.393
> 
> 标签：wpf, vb.net, data-binding, listbox

我主要在`ComboBox`es 和`DataGrid`s 上进行数据绑定，并且我认为 a 的`ListBox`工作方式相同，但我似乎遗漏了一些东西，因为`ListBox`当我将 Scan 对象添加到我的可观察集合时，我仍然是空白的。知道我在这里缺少什么吗？

```
 <ListBox Height="480" HorizontalAlignment="Left" Margin="551,77,0,0" Name="ListBox_scans" VerticalAlignment="Top" Width="415" ItemsSource="{Binding}" >
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel>
                    <TextBlock Text="{Binding Path=time}" />
                    <TextBlock Text="{Binding Path=station_name}"/>
                    <TextBlock Text="{Binding Path=Barcode}"/>
                </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox> 
```

扫描类：

```
Public Class Scan
Public Property Barcode As String
Public FromStation As Station
Public DateTimeUTC As DateTime
Public ScanType As String 'LotID, Employee Badge, Break, Complete, Duplicate
Public Duplicate As Boolean = False
Public IsWIPCleanUp As Boolean = False
Public IsComplete As Boolean = False

Public Property station_name As String
    Get
        If (Not FromStation Is Nothing) Then
            Return FromStation.Name
        Else
            Return "Station: No Station"
        End If
    End Get
    Set(value As String)

    End Set
End Property

Public Property time As String
    Get
        Return DateTimeUTC.ToLocalTime.ToShortTimeString()
    End Get
    Set(value As String)

    End Set
End Property

End Class 
```

然后我只是在一些主代码中绑定：

```
Private scan_collection As New ObservableCollection(Of Scan)

ListBox_scans.ItemsSource = scan_collection 
```

# c# - VisualStudio 缓存页面中的 IE9 调试不正确

> ID：14166467
> 
> 赞同：0
> 
> 时间：2013-01-04T23:04:23.627
> 
> 标签：c#, asp.net, internet-explorer-9, dynamic-data

我可能在某处缺少一个设置，但我对这个问题完全傻眼了。我有一个动态数据网站，它使用基于角色的权限来限制特定用户可以查看、编辑和删除的内容。当用户首次登录并被重定向到默认页面时，它会显示该用户角色的所有正确表格。单击任何可用表后，然后单击浏览器后退按钮，默认页面将显示**每个**无论用户角色规定什么，数据库中的表。我傻眼了，因为在任何时候都没有任何用户角色可用的每个表的视图，但 ie9 设法缓存了这个虚构的页面版本。我知道这一定是缓存问题，因为单击后退箭头时不会触发默认页面上的 page_load。如果我刷新默认页面，它将再次正确显示。

我正在使用母版页，并明确关闭了我在其页面加载中能想到的所有形式的缓存。

```
HttpContext.Current.Response.Cache.SetAllowResponseInBrowserHistory(false);
HttpContext.Current.Response.Cache.SetCacheability(HttpCacheability.NoCache);
HttpContext.Current.Response.Cache.SetNoStore();
Response.Cache.SetExpires(DateTime.Now.AddSeconds(-1));
Response.Cache.SetValidUntilExpires(true); 
```

需要注意的另一件事是，当我在 ff、chrome 或 safari 中测试网站时，这似乎只是 ie9 的问题，事情按预期工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T05:00:42.007

您必须将登录用户的角色存储在会话变量中，然后根据该值显示所需的数据（表或其他）。如果数据是根据用户在会话中的角色显示的，那么我不会认为你会有任何问题。`Response.Cache.SetNoStore();`您也可以通过提供页面加载功能来禁用缓存。

# c# - 为什么实体框架没有在我的模型上正确保存枚举属性？

> ID：14166468
> 
> 赞同：3
> 
> 时间：2013-01-04T23:04:31.807
> 
> 标签：c#, asp.net-mvc, entity-framework, enums, ef-code-first

这是我的模型及其相关枚举，下面是我与实体框架 5 和 asp.net mvc4 codefirst 一起使用的模型。我也在使用便携式数据库文件（.mdf）

```
public class Project
    {
        public Project()
        {
            Images = new List<ProjectImage>();
        }

        public int ProjectId { get; set; }
        [Required]
        public string Title { get; set; }
        public virtual ICollection<ProjectImage> Images { get; set; }
        public string Description { get; set; }
        public ProjectType Type { get; set; }
        public ProjectState State { get; set; }
    }

    public enum ProjectType
    {
        Phone,
        Web,
        Windows
    }

    public enum ProjectState : byte
    {
        InProgress,
        NotStarted,
        Done
    } 
```

从视图回发模型后，除枚举字段外，所有字段都正确保存到数据库中。它们会被保存，但即使在视图中选择了不同的值后，也只会保存每种枚举类型的第一个值。

我也尝试过保存编辑，同样的情况发生了。

我已经逐步完成了我的 create post 方法的开头，在我的上下文中调用 savechanges 后一切似乎都很好，但是当我重定向回索引页面时，它显示枚举属性值作为枚举上的初始值（即第一个枚举值)

我的创建和编辑方法如下。希望它不是一个错误，但请帮忙，因为我已经为此拉头发了几天。我刚开始使用 codefirst 和枚举。谢谢。

创建帖子方法

```
[HttpPost]
        public ActionResult Create(Project project, HttpPostedFileBase file)
        {
            try
            {
                if (file != null && file.ContentLength > 0 && file.ContentType.Contains("image"))
                {
                    //create a new unique filename with using guid, filename and project title
                    string relativePath = Constants.PortfolioImagesBaseFolder + 
                                        project.Title.Replace(" ", "") + 
                                        Guid.NewGuid().ToString() +
                                        Path.GetFileName(file.FileName);

                    string absolutePath = Server.MapPath(relativePath);

                    //save the file
                    file.SaveAs(absolutePath);

                    if (ModelState.IsValid)
                    {
                        project.Images.Add(new ProjectImage()
                        {
                            IsProjectMainImage = true,
                            Url = relativePath,
                            Title = "Main Project Image"
                        });
                        context.Projects.Add(project);
                        context.SaveChanges();

                        return RedirectToAction("Index");
                    }
                }

                ViewBag.ProjectTypes = CreateSelectListFromEnumType<ProjectType>();

                ViewBag.ProjectStates = CreateSelectListFromEnumType<ProjectState>();

                return RedirectToAction("Index");
            } 
```

编辑帖子方法

```
[HttpPost]
        public ActionResult Edit(int id, Project project)
        {
            try
            {
                if (ModelState.IsValid)
                {
                    //Project projectFromDb = context.Projects.Single(p => p.ProjectId == id);
                    //projectFromDb.State = project.State;
                    //projectFromDb.Type = project.Type;
                    //projectFromDb.Title = project.Title;
                    //projectFromDb.Description = project.Description;
                    EntityState entityState = context.Entry(project).State;
                    context.Entry(project).State = EntityState.Modified;
                    context.SaveChanges();
                    return RedirectToAction("Index");
                }

                ViewBag.ProjectTypes = CreateSelectListFromEnumType<ProjectType>();

                ViewBag.ProjectStates = CreateSelectListFromEnumType<ProjectState>();

                return View(project);
            } 
```

同样在标记为重复之前，我在 stackoverflow 上查看了许多答案，但没有一个可以帮助我，干杯，因此在提问之前等待两天。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T05:07:56.597

根据您的评论 - 由于您以 .NET Framework 4 为目标，因此未发现枚举属性并将其添加到模型中，因为 .NET Framework 4 的一部分的 EF 4 不支持枚举，并且该应用程序无法在只有已安装 .NET Framework 4（而不是 .NET Framework 4.5，它是就地更新）。出于同样的原因，安装在面向 .NET Framework 4 的项目中的 EF5 不允许在面向 .NET Framework 4.5 时使用 EF5 中可用的功能（枚举、地理空间类型、TVF 等）。将您的项目重新定位到 .NET Framework 4.5 并重新安装 EF5 将使所有这些功能可用。

# powershell - Powershell 错误捕获

> ID：14166471
> 
> 赞同：1
> 
> 时间：2013-01-04T23:04:52.167
> 
> 标签：powershell, error-handling

我有一个脚本可以进行一些服务器维护。部分工作是停止和重新启动主机服务器上的服务。判断服务何时再次完全在线的最简单方法是尝试连接到管理端口。一旦您能够连接到管理端口，服务就已启动并准备好开展业务。很简单。这段代码将循环直到它重新上线：

```
function test-port {
$PortProbe = New-Object Net.Sockets.TcpClient
$ErrorActionPreference = "SilentlyContinue"

while ($PortProbe.Connected -eq 0){
$PortProbe.Connect("localhost",3041) 
write-host "Server is off line... waiting for it to come online."
sleep 1

}
write-host "Server is back online!"
$ErrorActionPreference = "Continue"
 $PortProbe.Close()
}

test-port 
```

因此，在我的脚本中，我完成了我的工作，重新启动服务，然后调用“test-port”让脚本等待服务重新联机，然后再继续。

我遇到的问题是，如果我在脚本中有一个通用陷阱，它会在端口尚未准备好时捕获连接错误。

```
Exception calling "Connect" with "2" argument(s): "No connection could be made because the target machine actively refused it 127.0.0.1:3041"
At line:6 char:27
+         $PortProbe.Connect <<<< ("localhost",3041) 
+ CategoryInfo          : NotSpecified: (:) [], MethodInvocationException
+ FullyQualifiedErrorId : DotNetMethodException 
```

最后我有一个陷阱声明，以防发生一些非常奇怪的错误，它会启动电子邮件警报。但它破坏了测试端口功能的功能。

理论上，我可以捕获这个特定的 TCP/IP 连接错误并告诉它继续继续，就像什么都没发生一样，但我不知道如何判断错误消息的类别是什么。我认为它会是这样的：

```
trap [Net.Sockets.TcpClient] { #Don't Panic
} 
```

但这是不对的。

有什么建议么？我需要完全不同地处理这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:48:08.547

`Get-Service`为什么不在循环中使用 cmdlet 来检查服务的状态，而不是放入套接字，例如：

```
do { 
    $svc = Get-Service -ComputerName Localhost w3svc
    $connected = $false
    if ($svc -and $svc.Status -eq 'Running')     { 
        $connected = $true 
    }
    Start-Sleep -Milliseconds 500 
} while (!$connected) 
```

# jquery - Backbone.bootstrap-modal.js 不工作

> ID：14166474
> 
> 赞同：3
> 
> 时间：2013-01-04T23:04:55.817
> 
> 标签：jquery, jquery-ui, backbone.js, modal-dialog, backbone-forms

我正在关注这个小提琴[http://jsfiddle.net/evilcelery/4XZMb/](http://jsfiddle.net/evilcelery/4XZMb/)

```
$(function() {
    //Use BootstrapModal for object List editor
    Backbone.Form.editors.List.Modal.ModalAdapter = Backbone.BootstrapModal;

    //Main model definition
    var User = Backbone.Model.extend({
        schema: {
            title:      { type: 'Select', options: ['', 'Mr', 'Mrs', 'Ms'] },
            name:       'Text',
            email:      { validators: ['required', 'email'] },
            birthday:   'Date',
            password:   'Password',
            notes:      { type: 'List' },
            weapons:    { type: 'List', itemType: 'Object', subSchema: {
                name: { validators: ['required'] },
                number: 'Number'
            }}
        }
    });

    var user = new User({
        title: 'Mr',
        name: 'Sterling Archer',
        email: 'sterling@isis.com',
        birthday: new Date(1978, 6, 12),
        password: 'dangerzone',
        notes: [
            'Buy new turtleneck',
            'Call Woodhouse',
            'Buy booze'
        ],
        weapons: [
            { name: 'Uzi', number: 2 },
            { name: 'Shotgun', number: 1 }
        ]
    });

    //The form
    var form = new Backbone.Form({
        model: user
    }).render();

    //Add it to the page
    $('body').append(form.el);
}); 
```

对于我的申请。但是，我无法在单击“武器”列表时查看模态对话框视图。它在小提琴中正确显示，但是当我尝试在我的应用程序中做同样的事情时，它不包括我的视图中的模式对话框。有人可以帮助我吗？在我的应用程序中添加模态对话框视图是否需要任何特殊的事件处理程序？

# javascript - 链接以显示特定的 div，从侧面（在父级内）具有动画入口

> ID：14166481
> 
> 赞同：1
> 
> 时间：2013-01-04T23:05:10.363
> 
> 标签：javascript, jquery, css, html

我有一个与一些 jQuery 和 html/css 相关的问题。

我一直在研究一个侧面滚动的 div，其中包含几个 div，其中链接指的是“较小”的 div 之一（它们的入口应该是动画的）。

我在网上找到了一些东西，和我想要的类似：http: [//jsfiddle.net/NGL8P/21/](http://jsfiddle.net/NGL8P/21/) 不同的是我想要一个按钮链接到一个特殊的div（但动画应该基本相同）。

这是我到目前为止所做的版本：http: [//jsfiddle.net/jkUzF/2/](http://jsfiddle.net/jkUzF/2/)

每个项目符号点都应链接到其中一个 div。有 15 个按钮，但我现在只制作了 5 个 div。五个 div 彼此相邻放置（由于溢出：隐藏，它们不可见）。

我的主容器（包含所有可见的东西）被称为：`#mainsection` looong div（应该来回移动）被称为：`#wrap` 那些应该有 15 个的 div 被称为：`.container`

**编辑1：** 有人认为这是为了理解我想要什么，所以我会尽量让它更清楚：

网站上有 15 个圆形按钮。它们中的每一个都应该链接到一个特定的 DIV（当前包含一些 lorem ipsum）。这些 DIV 中的每一个都排成一列，但除非将溢出更改为滚动，否则您看不到它们。当我按下按钮时，我希望它们从侧面进来。例如，当我按下“项目 1”下的第三个按钮时，我希望包含 lorem ipsum 的第三个 div 从侧面进入。当我按下第一个按钮时，我希望第一个 Div 从另一侧进入。一切都应该是动画的，当我“跳过”一个 div（从第 1 个跳到第 3 个）时，我希望我跳过的那些（在本例中为 nr 2）快速“流动”。那更好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T02:43:06.353

```
$("a.circle").click(function(e) {
     e.preventDefault();
     var pos = $('a.circle').index(this);
     var newleft= -510 * pos;
     $("#wrap").animate({"left": newleft +"px"}, "slow");
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T11:09:50.777

我不知道发生了什么事，但今晚一定有人通过梦和我说话，因为当我醒来时，我就像：“我必须试试！”

我的问题的答案是使用以下代码：

```
$("#button").click(function() {
    $('#shit_that_moves').animate({left:"-510px"}, 500);
}); 
```

# php - php根据带空格的文件名自动创建超链接

> ID：14166484
> 
> 赞同：0
> 
> 时间：2013-01-04T23:05:37.310
> 
> 标签：php, file, hyperlink, directory

可能只是一些小东西，但我正在使用下面的代码来读取目录中的文件并将它们打印为自身的超链接。

它会打印出完整的文件名，但它会创建一个不完整的超链接，只使用直到第一个空格的字符。问题是如何为包含空格的文件创建功能超链接？

```
$dir = '.';
$dh = opendir($dir);
$file_count = 0;
while (false !== ($file = readdir($dh))) {
    $files[] = $file;
    $file_count += 1;
    echo $file;
}
for ($x = 0; $x < $file_count; $x += 1) {
    echo "<a href=$files[$x]>" . "$files[$x]" . "</a><br>";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T23:14:58.570

```
$dir = '.';
$dh = dir($dir);
while (FALSE !== ($file = $dh->read())) 
{
    if ('.' !== $file[0]) // ignore any entry that begins with a '.'
        echo "<a href='" . urlencode($file) . "'>". $file . "</a><br />\n";
}
$dh->close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T23:17:52.053

我已经在上面的评论中建议了[`urlencode`](http://php.net/urlencode)and的用法。[`htmlspecialchars`](http://php.net/htmlspecialchars)

我还建议您使用，[`FilesystemIterator`](http://php.net/FilesystemIterator)因为在您的情况下使用它非常方便：

```
$dir = '.';
$files = new FilesystemIterator($dir);

foreach ($files as $path => $fileinfo) {
    $name  = $fileinfo->getBasename();
    $url   = urlencode($name);
    $label = htmlspecialchars($name);
    printf("<a href=\"%s\">%s</a><br>\n", $url, $label);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T23:12:59.657

尝试使用`glob();`

```
foreach (glob("*.*") as $filename) {
        echo "<a href=\"$filename\">$filename</a> <br>";
} 
```

您可以通过扩展名指定，或者我指定的内容`*.*`将在它们自己的超链接上显示所有文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T23:11:36.127

您可能希望在锚标记内的 HREF 属性中添加引号：

```
 echo "<a href='$files[$x]'>$files[$x]</a><br>"; 
```

客户可能会认为空格后面的文件名部分是另一个属性。（您可能还想使用 htmlentities() 来转义 href 属性中的文件名。）

# iphone - 在drawRect中绘制形状

> ID：14166490
> 
> 赞同：1
> 
> 时间：2013-01-04T23:06:00.177
> 
> 标签：iphone, objective-c, ios, ipad

我有以下代码：

```
- (void)drawRect:(CGRect)rect
{
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGFloat commentHeight = 0;

        CGSize commentSize = [self.highlightItem_.comment sizeWithFont:[UIFont fontWithName:kProximaNova size:18] constrainedToSize:CGSizeMake(rect.size.width, CGFLOAT_MAX) lineBreakMode:NSLineBreakByWordWrapping];
        commentHeight = commentSize.height + 50;

        CGContextSetRGBStrokeColor(context, 68/255.f, 68/255.f, 68/255.f, 1.0);
        CGContextSetRGBFillColor(context, 68/255.f, 68/255.f, 68/255.f, 1.0);
        CGContextSetLineJoin(context, kCGLineCapSquare);
        CGContextSetLineWidth(context, 1.0);

        CGMutablePathRef pathRef = CGPathCreateMutable();

        CGPathMoveToPoint(pathRef, NULL, 0, rect.size.height - commentHeight);
        CGPathAddLineToPoint(pathRef, NULL, 20, rect.size.height - commentHeight);
        CGPathAddLineToPoint(pathRef, NULL, 25, rect.size.height - commentHeight - 10);
        CGPathAddLineToPoint(pathRef, NULL, 30, rect.size.height - commentHeight);
        CGPathAddLineToPoint(pathRef, NULL, rect.size.width, rect.size.height - commentHeight);
        CGPathAddLineToPoint(pathRef, NULL, rect.size.width, rect.size.height);
        CGPathAddLineToPoint(pathRef, NULL, 0, rect.size.height);
        CGPathCloseSubpath(pathRef);

        CGContextAddPath(context, pathRef);
        //CGContextFillPath(context);
        CGContextDrawPath(context, kCGPathFill);

        CGPathRelease(pathRef);
} 
```

由于某种原因，它没有画出我想要的形状。事实上它什么也没画。有什么我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T23:14:44.400

上面的代码工作得很好。

我猜你正在画出屏幕，因为我在使用全屏视图时看到 iPhone 5 屏幕最底部的评论气泡。

使用小的居中视图时，请查看下面的结果。

![在此处输入图像描述](../Images/d4417c1f5d5f15567768073b10d331ee.png)

# android - Android中如何动态创建大量imageView

> ID：14166493
> 
> 赞同：0
> 
> 时间：2013-01-04T23:06:07.837
> 
> 标签：android, imageview, android-imageview

您好，我正在制作一个拼图应用程序，为此我从一个高度 = 宽度 = 240 的大型位图制作了 16 个较小的位图。现在我必须一次在一个活动中动态显示这些位图。我尝试的代码无法正常工作，因为它在一行中显示所有图像并且图像尺寸太小。这是代码：

```
public void display()
    {
        float x =0;
        float y = 0;
        LinearLayout llMain = new LinearLayout(this);
        for(int i=0;i<3;i++)
        {
            LinearLayout llRow = new LinearLayout(this);
            for(int j=0;j<tiles.length/4;j++)
            {
                ImageView iv = new ImageView(this);
                iv.setImageBitmap(tiles[j]);// get bitmap from image path
                iv.setX(x);
                iv.setY(y);
                x = y = x + 60;
                llRow.addView(iv);
            }
            llMain.addView(llRow);
        }
        setContentView(llMain);
       }
} 
```

这是LogCat：

```
01-05 00:32:35.820: D/dalvikvm(11346): GC_EXTERNAL_ALLOC freed 47K, 52% free 2599K/5379K, external 1990K/2108K, paused 135ms
01-05 00:32:44.183: D/dalvikvm(11346): GC_EXTERNAL_ALLOC freed 43K, 50% free 2739K/5379K, external 2477K/2527K, paused 18ms
01-05 00:32:45.156: I/dalvikvm(11346): Could not find method android.widget.ImageView.setX, referenced from method com.maju.jigsawpuzzle.PlayBoard.display
01-05 00:32:45.156: W/dalvikvm(11346): VFY: unable to resolve virtual method 3236: Landroid/widget/ImageView;.setX (F)V
01-05 00:32:45.156: D/dalvikvm(11346): VFY: replacing opcode 0x6e at 0x002e
01-05 00:32:45.156: D/dalvikvm(11346): VFY: dead code 0x0031-003e in Lcom/maju/jigsawpuzzle/PlayBoard;.display ()V
01-05 00:32:45.179: D/AndroidRuntime(11346): Shutting down VM
01-05 00:32:45.179: W/dalvikvm(11346): threadid=1: thread exiting with uncaught exception (group=0x40015578)
01-05 00:32:45.187: E/AndroidRuntime(11346): FATAL EXCEPTION: main
01-05 00:32:45.187: E/AndroidRuntime(11346): java.lang.NoSuchMethodError: android.widget.ImageView.setX
01-05 00:32:45.187: E/AndroidRuntime(11346):    at com.maju.jigsawpuzzle.PlayBoard.display(PlayBoard.java:164)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at com.maju.jigsawpuzzle.PlayBoard.shuffleArray(PlayBoard.java:143)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at com.maju.jigsawpuzzle.PlayBoard.breakImage(PlayBoard.java:123)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at com.maju.jigsawpuzzle.PlayBoard.onCreate(PlayBoard.java:40)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1615)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at android.app.ActivityThread.access$1500(ActivityThread.java:117)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at android.os.Looper.loop(Looper.java:123)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at android.app.ActivityThread.main(ActivityThread.java:3687)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at java.lang.reflect.Method.invokeNative(Native Method)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at java.lang.reflect.Method.invoke(Method.java:507)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
01-05 00:32:45.187: E/AndroidRuntime(11346):    at dalvik.system.NativeStart.main(Native Method) 
```

第 164 行是以下行：

iv.setX(x);

有人知道解决方案吗？此外，我必须向他们注册 onClick ......

预先感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:30:25.960

如果您想支持旧的 android 版本，请不要使用 setX/setY。而是设置 LayoutParams (LinearLayout.LayoutParams) 来指定 ImageView 的 x/y 参数。阅读这篇文章：[Android - 在 api 8 中使用 view.setX() 和 setY](https://stackoverflow.com/questions/12195768/android-use-of-view-setx-and-sety-in-api-8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:22:33.543

根据[文档](http://developer.android.com/reference/android/view/View.html#setTranslationX%28float%29)

> setX 方法仅在 API 级别 11 中可用。

这意味着如果您使用的是 Android 2.x，您的应用将会崩溃。

我猜您的代码中收到了一些 Lint 警告，不是吗？

我从未使用过 setX 方法，也帮不上什么忙，但我希望你能在预 Honeycomb 设备上找到一些替代方法。

当你找到它时，你可以使用

```
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB){} 
```

# qt - 如何在qt中访问布局内的布局

> ID：14166499
> 
> 赞同：2
> 
> 时间：2013-01-04T23:07:03.503
> 
> 标签：qt

运行我的 qt 程序时出现错误。（在我添加这个新函数*以做某事**之前，它曾经可以正常工作并且可以完美编译`void perfectPanel::aaaf`*。 ）错误消息是，

`QLayout::parentWidget: A layout can only have another layout as a parent. Segmentation fault (core dumped)`

发生这种情况是因为我试图向我的布局添加一个新小部件`gridLayoutSub_`，但布局`gridLayoutSub_`位于另一个名为`gridLayout_`

```
void perfectPanel::aaaf()
{
    // some codes ...
    gridLayoutSub_->addWidget(kkk, 6, 0, 1, 1);
} 
```

任何人都知道出了什么问题以及如何解决？

## 更多细节：这两种布局的声明

在 mymainwindow 类中，有一个停靠小部件。为了自定义这个停靠小部件，我编写了一个名为的新类`perfectPanel`，它是 的子类`QWidget`，然后在 this 的构造函数中`perfectPanel`，我有以下代码：

```
groupBoxA = new QGroupBox(tr("groupBoxA"));
QGridLayout* gridLayoutA = new QGridLayout(groupBoxA);

VBoxLayoutPanel = new QVBoxLayout(this);
VBoxLayoutPanel->addWidget(groupBoxA);

groupBoxA->setLayout(gridLayoutA);
setLayout(VBoxLayoutPanel); 
```

如您所见，`gridLayoutA`在另一个布局内`VBoxLayoutPanel`。我提到的错误发生在我稍后在 function 中尝试 addWidget 到 gridLayoutA 时`void perfectPanel::aaaf`，期间：

`gridLayoutA->addWidget(kkk, 6, 0, 1, 1);`

## `perfectPanel`类的标题

```
class perfectPanel : public QWidget
{
    Q_OBJECT

public:

    explicit perfectPanel(QWidget *parent = 0);
    ~perfectPanel();

private:
    // ...
} 
```

# twitter-bootstrap - 处理 twitter bootstrap carousel 的不同高度的图像和 carousel 中图像的链接

> ID：14166502
> 
> 赞同：3
> 
> 时间：2013-01-04T23:07:24.790
> 
> 标签：twitter-bootstrap, carousel

处理不同高度的图像最有效的方法是什么？

a) 我有很多图像，其中一些比其他图像高。我想让它们限制在旋转木马的区域。但是，如果我明确定义轮播尺寸（如 .carousel { width: 500px; height: 500px; } ），那么我将失去引导程序所做的自动调整大小，这对于使网站在移动网站上看起来不错至关重要。

b) 是否可以在 twitter 引导程序中为图像提供超链接/链接？

有谁知道怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-23T23:02:00.507

`img { width: 100%; }`在图像和`#carousel_container_id_here { max-height: XXXpx; overflow-y: hidden; }`

请注意，它将剪切超过`max-height`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T09:57:34.163

我认为您可以指定`max-height`eg `.carousel { max-height: 500px; }`。这样，重新调整大小应该可以工作，并且设计也不会破坏。

# json - API 设计：HATEOAS、json、版本控制和媒体类型

> ID：14166503
> 
> 赞同：8
> 
> 时间：2013-01-04T23:07:27.290
> 
> 标签：json, api, rest, hateoas

我喜欢 REST HATEOAS 的概念，即通过超链接让您的 API 可被发现。人们喜欢使用 ATOM 格式的 XML 链接，您甚至可能不需要对 API 进行版本控制。但是，我只在做 JSON，我想对我的 API 进行版本控制并且仍然做 HATEOAS。

似乎最好的做法是使用供应商媒体类型，`application/vnd.me.v1+json`但所有这些都在讨论 JSON 中的超链接没有格式，以及 HAL、JSON+Colleton 和 Siren 等具有自己的媒体类型的东西。

所以，这是我的困惑。首先，为什么要通过媒体类型指定格式？为什么在 JSON 中包含链接不能只是客户遵循的约定？hm-json 浏览器不就是这样发现链接的吗？

而且，如果必须将其定义为媒体类型，那么这样的事情是否有效？

```
application/vnd.me.v1.hal+json 
```

任何人？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-05T20:58:56.687

> 首先，为什么要通过媒体类型指定格式？

是的，您可以对链接的格式有一个约定，但是，只有在解压缩 HTTP 消息的正文后才能发现任何约定。由于媒体类型是标头，因此消息的主体可以作为一个整体被接受或拒绝。对于不支持所提供媒体类型的消费者，这使得处理请求更加高效。

> 应用程序/vnd.me.v1.hal+json

据我了解，媒体类型可以限定为适合您所描述的 API 的级别。因此，您可以选择为单个表示、一组都遵循相同服务的表示或整个组织的单一媒体类型选择一种媒体类型。

考虑到媒体类型[，这是一篇很好的 SO 帖子：](https://stackoverflow.com/questions/880881/rest-media-type-explosion)

# java - 无法访问列表中的元素：“表达式必须是数组类型”

> ID：14166504
> 
> 赞同：0
> 
> 时间：2013-01-04T23:07:29.253
> 
> 标签：java, list, compiler-errors

我写了一个方法

```
public static final List<String> FooBar{

List<String> foobarlist = new ArrayList<String>();
 foobarlist.add("foo");
 foobarlist.add("bar");
 return foobarlist; 
```

}

```
public static void man(String[] args){
   List<String> foobarlist = Foobar();
   String foo = foobarlist[0];<-- error here

} 
```

我收到此错误

> 表达式的类型必须是数组类型，但它解析为 List

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T23:08:58.610

```
String foo = foobarlist.get(0); 
```

老实说，您在此处发布的内容甚至都无法编译。无论如何，我建议您清理该部分。方法名称应以 Java 中的小写字母开头，最后应有括号。

```
public static final List<String> foobar() { 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T23:09:17.720

利用

```
 String foo = foobarlist.get(0); 
```

代替

```
 String foo = foobarlist[0]; 
```

[..] 表示法只允许用于数组而不用于列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T23:09:49.757

我看到的两个问题：

1\. 方法声明中缺少括号：

```
public static final List<String> FooBar() {  // Although "foobar" / "fooBar"
                                             // would better follow naming
                                             // conventions (camelCase). 
```

2. `List`元素通过以下方式访问[`get`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#get%28int%29)：

```
String foo = foobarlist.get(0); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T23:11:33.433

字符串数组将允许您执行此操作：

`String foo = fooBarArray[0];`

但是，由于您在此处使用 List，因此您需要使用它：

`String foo = foobarlist.get(0);`

这是因为`List`它是一个容器类，而一个数组是，嗯.. 一个数组：P

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-04T23:13:23.993

Java 没有.net 中描述的索引器。你必须使用get方法。尝试这个：

```
String foo = foobarlist.get(0); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-04T23:14:57.977

由于 foobarlist 是 List 而不是数组，因此您无法通过 [] 访问列表的元素。您将需要使用 foobarlist.get(0) 来访问第一个元素，使用 foobarlist.get(1) 来访问第二个元素......等等。[在这里查看](https://stackoverflow.com/questions/10487104/difference-between-list-and-array)数组和列表之间的区别

# python - 基于值的字典中的python查询键

> ID：14166508
> 
> 赞同：3
> 
> 时间：2013-01-04T23:07:42.703
> 
> 标签：python, dictionary

让我们有一个以下字典：

```
 table = {x1: {y1: 1, y2:2},
         x2: {y1: 3, y2:4},
         x3: {y3: 5, y2:6}
         } 
```

考虑到值是唯一的，有没有办法有效地根据值查询键路径，或者使用值作为键来重建字典更好？

例子：

```
 result = magic_function(table, 3)
   result --> [x2, y1] 
```

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T23:21:40.590

“反转”字典的惯用方式是这样的：

```
i = {v: k for (k, v) in d.items()} 
```

如果您使用的是 Python 2 而不是 3，并且`d`可能很大，请`iteritems`改用。

在您的情况下，您有 a `dict`of `dicts`，并且如果我理解正确的话，您想将其双重反转为 a `dict`of 路径。但是你不知道怎么写。所以，让我们先明确地写出来，很长的路要走：

```
i = {}
for k, v in d.items():
    for k2, v2 in v.items():
        i[v2] = (k, k2) 
```

您可以将其转换为字典理解，但您希望它是您真正理解的东西，而不是您不假思索地复制和粘贴的某种魔术调用，所以我将这部分留给您（但我很乐意如果您有任何问题，请提供帮助）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T23:23:22.173

反转可能是更好的方法：

```
In [17]: d = {table[k1][k2]: (k1,k2) for k1 in table for k2 in table[k1]} 
```

这是一个处理任意深度和“参差不齐”的字典的解决方案：

```
def invert_arbitrary(d, ldict, p=[]):
    for k, v in ldict.items():
        if isinstance(v, dict):
            invert_arbitrary(d, v, p + [k])
        else:
            d[v] = p + [k] 
```

例子：

```
table = {'x1': {'y1': 1, 'y2': 2}, 
         'x2': {'y1': 3,
                'y2': {'z1': 4, 'z2': 5}},
         'x3': 6}

In [40]: d = dict()
In [41]: invert_arbitrary(d, table)

In [42]: d
Out[42]: 
{1: ['x1', 'y1'],
 2: ['x1', 'y2'],
 3: ['x2', 'y1'],
 4: ['x2', 'y2', 'z1'],
 5: ['x2', 'y2', 'z2'],
 6: ['x3']} 
```

# javascript - 如果在网页中找到特定文本，则 javascript 显示警报消息

> ID：14166511
> 
> 赞同：0
> 
> 时间：2013-01-04T23:07:46.697
> 
> 标签：javascript

我有一个名为“X”的网页，另一个网页位于名为“Y”的 iframe 中。页面“Y”每半小时更新一次，新信息到达。如果页面“Y”中有特定的文本字符串可用，我希望在页面“X”中插入一个 javascript 代码以显示警告框。

我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T23:11:06.790

这仅在 iframe 内的页面与您的父页面位于同一域中时才有效。否则您的浏览器将不允许。

您可以使用`contentWindow.document`iframe 对象上的成员访问 iframe 内的页面。小例子

```
// assuming your iframe has an id of "myframe"
document.getElementById("myframe").contentWindow.document.getElementById("someId") 
```

# c# - 由于删除/创建 SQL Server 视图而导致登录到 ASP 应用程序时出现死锁

> ID：14166519
> 
> 赞同：13
> 
> 时间：2013-01-04T23:08:42.407
> 
> 标签：c#, sql-server, reporting-services

我一直在追这个问题一天，很困惑，所以我想我会把它发给你们，以获得一些灵感。当谈到死锁和 SQL Server 锁定模式时，我有点新手，我很少需要深入研究。

## 短篇小说：

当用户登录到我们的应用程序时，我们希望根据他们现在拥有“会话”这一事实来更新 SQL Server 视图，以便当他们随后基于报表模型运行 SQL Server Reporting Services 报表时，它包括安全性他们的会话设置。

我注意到的常规死锁发生在 DROPs 和 reCREATEs 视图（我称之为 AuthRuleCache）的进程与试图从视图中选择的 Microsoft SQL Server Reporting Services 2008 (SSRS) 报告之间。

如果我正确读取 SQL Profiler 死锁事件，则 AuthRuleCache 具有 Sch-M 锁，并且报告具有 IS 锁。

AuthRuleCache 代码是 DotNet 程序集中的 C#，它在用户登录到我们的 Classic ASP 应用程序时执行。

显然，我想避免死锁，因为它会阻止登录 - 只要我不需要损害任何其他功能，我不介意如何实现这一点。我已经完全控制了 AuthRuleCache 和数据库，但我想说我们对企业 DBA 专业知识“轻”。

下面是一个来自 SQL Profiler 的死锁事件示例：

```
<deadlock-list>
 <deadlock victim="process4785288">
  <process-list>
   <process id="process4785288" taskpriority="0" logused="0" waitresource="OBJECT: 7:617365564:0 " waittime="13040" ownerId="3133391" transactionname="SELECT" lasttranstarted="2013-01-07T15:16:24.680" XDES="0x8005bd10" lockMode="IS" schedulerid="8" kpid="20580" status="suspended" spid="83" sbid="0" ecid="0" priority="0" trancount="0" lastbatchstarted="2013-01-07T15:15:55.780" lastbatchcompleted="2013-01-07T15:15:55.780" clientapp=".Net SqlClient Data Provider" hostname="MYMACHINE" hostpid="1176" loginname="MYMACHINE\MyUser" isolationlevel="read committed (2)" xactid="3133391" currentdb="7" lockTimeout="4294967295" clientoption1="671088672" clientoption2="128056">
    <executionStack>
     <frame procname="adhoc" line="2" stmtstart="34" sqlhandle="0x02000000bd919913e43fd778cd5913aabd70d423cb30904a">
SELECT
    CAST(1 AS BIT) [c0_is_agg],
    1 [agg_row_count],
    COALESCE([dbo_actions2].[ActionOverdue30days], 0) [ActionOverdue30days],
    COALESCE([dbo_actions3].[ActionOverdueTotal], 0) [ActionOverdueTotal],
    COALESCE([dbo_actions4].[ActionOverdue90daysPLUS], 0) [ActionOverdue90daysPLUS],
    COALESCE([dbo_actions5].[ActionOverdue60days], 0) [ActionOverdue60days],
    COALESCE([dbo_actions6].[ActionOverdue90days], 0) [ActionOverdue90days],
    COALESCE([dbo_actions7].[ActionPlanned30days], 0) [ActionPlanned30days],
    COALESCE([dbo_actions8].[ActionPlanned60days], 0) [ActionPlanned60days],
    COALESCE([dbo_actions9].[ActionPlanned90days], 0) [ActionPlanned90days],
    COALESCE([dbo_actions10].[ActionPlanned90daysPLUS], 0) [ActionPlanned90daysPLUS],
    COALESCE([dbo_actions11].[ActionPlannedTotal], 0) [ActionPlannedTotal],
    CASE WHEN [dbo_actions12].[CountOfFilter] > 0 THEN 'Overdue0-30days' WHEN [dbo_actions13].[CountOfFilter] > 0 THEN 'Overdue90daysPlus' WHEN [dbo_actions5].[Count     </frame>
    </executionStack>
    <inputbuf>
  SET DATEFIRST 7
  SELECT
    CAST(1 AS BIT) [c0_is_agg],
    1 [agg_row_count],
    COALESCE([dbo_actions2].[ActionOverdue30days], 0) [ActionOverdue30days],
    COALESCE([dbo_actions3].[ActionOverdueTotal], 0) [ActionOverdueTotal],
    COALESCE([dbo_actions4].[ActionOverdue90daysPLUS], 0) [ActionOverdue90daysPLUS],
    COALESCE([dbo_actions5].[ActionOverdue60days], 0) [ActionOverdue60days],
    COALESCE([dbo_actions6].[ActionOverdue90days], 0) [ActionOverdue90days],
    COALESCE([dbo_actions7].[ActionPlanned30days], 0) [ActionPlanned30days],
    COALESCE([dbo_actions8].[ActionPlanned60days], 0) [ActionPlanned60days],
    COALESCE([dbo_actions9].[ActionPlanned90days], 0) [ActionPlanned90days],
    COALESCE([dbo_actions10].[ActionPlanned90daysPLUS], 0) [ActionPlanned90daysPLUS],
    COALESCE([dbo_actions11].[ActionPlannedTotal], 0) [ActionPlannedTotal],
    CASE WHEN [dbo_actions12].[CountOfFilter] > 0 THEN 'Overdue0-30days' WHEN [dbo_actions13].[CountOfFilter] > 0 THEN 'Overdue90daysPlus' WHEN [db    </inputbuf>
   </process>
   <process id="process476ae08" taskpriority="0" logused="16056" waitresource="OBJECT: 7:1854941980:0 " waittime="4539" ownerId="3132267" transactionname="user_transaction" lasttranstarted="2013-01-07T15:16:18.373" XDES="0x9a7f3970" lockMode="Sch-M" schedulerid="7" kpid="1940" status="suspended" spid="63" sbid="0" ecid="0" priority="0" trancount="2" lastbatchstarted="2013-01-07T15:16:33.183" lastbatchcompleted="2013-01-07T15:16:33.183" clientapp=".Net SqlClient Data Provider" hostname="MYMACHINE" hostpid="14788" loginname="MYMACHINE\MyUser" isolationlevel="read committed (2)" xactid="3132267" currentdb="7" lockTimeout="4294967295" clientoption1="671088672" clientoption2="128056">
    <executionStack>
     <frame procname="adhoc" line="3" stmtstart="202" stmtend="278" sqlhandle="0x02000000cf24d22c6cc84dbf398267db80eb194e79f91543">
  DROP VIEW [sec].[actions_authorized]     </frame>
    </executionStack>
    <inputbuf>

  IF EXISTS ( SELECT * FROM sys.VIEWS WHERE object_id = OBJECT_ID(N'[sec].[actions_authorized]'))
  DROP VIEW [sec].[actions_authorized]
      </inputbuf>
   </process>
  </process-list>
  <resource-list>
   <objectlock lockPartition="0" objid="617365564" subresource="FULL" dbid="7" objectname="617365564" id="lock932d2f00" mode="Sch-M" associatedObjectId="617365564">
    <owner-list>
     <owner id="process476ae08" mode="Sch-M"/>
    </owner-list>
    <waiter-list>
     <waiter id="process4785288" mode="IS" requestType="wait"/>
    </waiter-list>
   </objectlock>
   <objectlock lockPartition="0" objid="1854941980" subresource="FULL" dbid="7" objectname="1854941980" id="locke6f0b580" mode="IS" associatedObjectId="1854941980">
    <owner-list>
     <owner id="process4785288" mode="IS"/>
    </owner-list>
    <waiter-list>
     <waiter id="process476ae08" mode="Sch-M" requestType="convert"/>
    </waiter-list>
   </objectlock>
  </resource-list>
 </deadlock>
</deadlock-list> 
```

## 长篇大论：

我决定将其作为问答。

问：为什么您必须频繁更改架构以强制报告安全性？

A：嗯，我之所以采用这种方法，是因为我们的 SSRS 报告机制完全基于报告模型，并且我们的应用程序通过应用规则来支持行级安全性。规则本身在数据库中定义为小的 SQL 片段。这些片段在运行时重新组合，并根据 a) 用户是谁、b) 他们想要做什么以及 c) 他们想要做什么来应用。因此，每个用户都可能拥有基于适用于他们的规则的独特数据视图。我们有用户创作和保存他们自己的报告，所以我希望在模型中强制执行这种安全性，以防止他们偶然发现他们不应该访问的数据。

我们面对报表模型的挑战是它们基于只能由静态源组成的数据源视图 (DSV)，例如表、命名查询、视图。您不能将一些 C# 代码注入 DSV 以使其动态响应运行报告的特定用户。您确实在模型 (SMDL) 处获得了用户 ID，因此您可以将其用于过滤。我们的解决方案是让 DSV 公开一个视图，其中包含所有当前登录用户的唯一规则集（即 AuthRuleCache）的所有数据，然后 SMDL 会将其过滤回请求用户的唯一规则集。嘿-presto，您已经在 SSRS 报告模型中获得了动态的行级、基于规则的安全性！

规则很少更改，因此在用户会话期间这些规则的行为方式相同是可以的。因为我们有成千上万的用户，但在 24 小时内只有几百个左右的用户可以登录，所以我决定在用户​​登录时刷新 AuthRuleCache 并在 24 小时后将其过期，因此它只包含以下安全信息具有当前会话的用户。

问：AuthRuleCache 采用什么形式？

A：这是一种结合了许多其他观点的观点。每个用户都有自己的视图，例如widgets_authorized_123，其中widgets 是包含受保护数据的表，123 是用户ID。然后，有一个主视图（例如widgets_authorized）将所有用户视图联合在一起

问：这听起来效率低得可怕，你是个白痴吗？

答：可能 - 但是由于 SQL 查询处理器的强大功能，对于实时用户报告来说，这一切似乎都运行得又好又快。我尝试使用缓存表来实际保存用于应用程序安全性的记录 ID，发现这会导致表膨胀并延迟刷新和从缓存中读取。

问：好吧，你可能仍然是个白痴，但让我们探索另一种选择。您可以异步重建 AuthRuleCache 而不是让用户在登录时等待吗？

答：嗯，用户在登录后做的第一件事是点击包含基于模型的报告的仪表板 - 所以我们需要在登录后立即启动并运行安全规则。

问：您是否探索过不同的锁定模式和隔离级别？

答：有点——我尝试启用更改数据库 read_committed_snapshot ON 但这似乎没有任何区别。回想起来，我认为我正在尝试执行 DROP/CREATE VIEW 并需要 Sch-M 锁这一事实意味着读取提交的快照隔离 (RCSI) 无济于事，因为它是关于处理 DML 语句的并发性，而我正在做 DDL。

问：您是否出于报告目的探索过整个数据库的数据库快照或镜像？

答：我不排除这种可能性，但我希望更多的是以应用程序为中心的解决方案，而不是进行基础设施更改。这将是资源利用和维护开销的跳跃，我需要将其升级给其他人。

问：还有什么我们应该知道的吗？

A: 是的，AuthRuleCache 刷新过程包含在事务中，因为我想确保没有人看到不完整/无效的缓存，例如当 widget_authorized_123 因为用户会话过期而被删除时，widget_authorized 视图引用了 widget_authorized_123。我在没有事务的情况下进行了测试，死锁停止了，但我开始从 SQL Profiler 获取阻塞的进程报告。我在登录时看到了大约 15 秒的延迟，有时还会出现超时 - 所以把交易放回原处。

问：它多久发生一次？

A：AuthRuleCache 目前在生产环境中是关闭的，所以不会影响用户。我对 100 次连续登录的本地测试表明，可能有 10% 的死锁或失败。我怀疑对于在仪表板上拥有基于长期运行报表模型的报表的用户来说，情况会更糟。

问：报告快照如何？

A：也许是一种可能性 - 不确定这与参数化报告的效果如何。我担心的是，我们确实有一些用户会在插入记录时感到震惊，但直到半小时后才在仪表板上看到它。另外，我不能总是保证每个人都会一直正确使用报表快照，所以不要让门敞开，让死锁在以后偷偷溜回来。

问：我可以看到 AuthRuleCache 刷新事务的完整 T-SQL 吗？

答：以下是从 SQL Profiler 捕获的一个事务中针对一个用户登录发出的语句：

查找过期会话 - 如果找到，我们将删除相关视图

```
SELECT TABLE_SCHEMA + '.' + TABLE_NAME
FROM INFORMATION_SCHEMA.VIEWS
WHERE TABLE_SCHEMA + '.' + TABLE_NAME LIKE 'sec.actions_authorized_%'
  AND RIGHT(TABLE_NAME, NULLIF(CHARINDEX('_', REVERSE(TABLE_NAME)), 0) - 1) NOT IN (
    SELECT DISTINCT CAST(empid AS NVARCHAR(20))
    FROM session
    ) 
```

删除用户“myuser”的任何预先存在的视图，id 298

```
IF EXISTS (
    SELECT *
    FROM sys.VIEWS
    WHERE object_id = OBJECT_ID(N'[sec].[actions_authorized_298]')
    )
  DROP VIEW [sec].[actions_authorized_298] 
```

为用户 id 298 创建一个视图

```
CREATE VIEW [sec].[actions_authorized_298]
AS
SELECT actid
  ,'myuser' AS username
FROM actions
WHERE actid IN (
    SELECT actid
    FROM actions
    WHERE (
        --A bunch of custom where statements generated from security rules in the system prior to this transaction starting
    ) 
```

获取操作实体的所有用户特定视图的列表

```
SELECT TABLE_SCHEMA + '.' + TABLE_NAME
FROM INFORMATION_SCHEMA.VIEWS
WHERE TABLE_SCHEMA + '.' + TABLE_NAME LIKE 'sec.actions_authorized_%' 
```

删除现有的主操作视图

```
IF EXISTS (
    SELECT *
    FROM sys.VIEWS
    WHERE object_id = OBJECT_ID(N'[sec].[actions_authorized]')
    )
  DROP VIEW [sec].[actions_authorized] 
```

创建一个新的主操作视图，我们就完成了

```
CREATE VIEW [sec].[actions_authorized]
AS
SELECT actid
  ,username
FROM sec.actions_authorized_182    
UNION
SELECT actid
  ,username
FROM sec.actions_authorized_298
UNION
-- Repeat for a bunch of other per-user custom views, generated from the prior select
-- ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T10:28:06.823

感谢所有提供建议的人。我已经确定了一个我认为对我们有用的解决方案。在我得到最终代码之前可能需要一段时间，但我已经做了一些测试并且看起来很积极 - 我想用我计划的方法来结束这个问题。

首先，僵局是我从一开始就试图做的事情的完全适当的结果。据我了解，重新创建视图需要模式修改锁 - 并且从该视图读取中间的任何过程都需要模式稳定性锁。根据时间的不同，这些相互竞争的锁会在繁忙时段导致大约 10% 的登录尝试出现死锁。

当我在运行视图删除/重新创建之前更改代码以执行 SET TRANSACTION ISOLATION LEVEL SERIALIZABLE 时，死锁消失了，因为它对可能同时发生的事情有更多的限制，牺牲了响应速度以获得稳定性。

不幸的是，我看到的不是死锁，而是阻塞进程报告，其中进程等待超过 10 秒才能获得必要的锁。仍然没有真正解决我的问题。

我重新考虑了使用大 UNIONed 视图组合多个视图的“奇怪解决方案”。让我明确一点，我没有选择这种方法，我只是试图解决 SSRS 报告模型中的一个限制，即您无法在模型底层的表/命名查询中实现参数。

我在 MS 文档中发现，当将多个表中的行合并到一个视图中时，分区视图可以使用类似的结构，例如：http: [//msdn.microsoft.com/en-us/library/ms190019(v=sql. 105).aspx](http://msdn.microsoft.com/en-us/library/ms190019(v=sql.105).aspx)

所以我不是唯一一个以这种方式使用视图的人。我需要这个 UNIONed 视图，但是删除和重新创建视图将是一个性能问题。因此，我使用 Service Broker 进行了一些测试，发现我可以将视图删除/重新创建操作排队，从而允许用户快速登录，而无需等待 DDL 完成。我将遵循@usr 的建议并尽可能精简事务，将对于完成登录（例如过期旧会话）不重要的内容移出事务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:21:09.047

让我们将您的示例与小部件一起使用，我假设有一个表格说明每个用户授权了哪些小部件（如果您有用户组，它只是有点复杂）

当您使用 User_ID 时，我假设您有另一个带有用户登录名的表。

用户 (User_ID, Login) 小部件 (Widget_ID, ...) widgets_authorized (User_ID, Widget_ID)

将表 Widgets 重命名为 AllWidgets

创建视图小部件：

```
CREATE VIEW widgets
AS
SELECT AW.*
FROM AllWidgets AW
INNER JOIN widgets_authorized WA ON WA.Widget_ID = AW.Widget_ID
INNER JOIN Users U ON WA.User_ID = U.User_ID
WHERE U.Login = SYSTEM_USER 
```

您可以保持以前的模型链接到视图小部件而不是以前的表格小部件，它们返回相同的列，数据根据连接的用户进行过滤。

如果你有性能问题试试这个，我有一个类似的问题：

```
CREATE VIEW widgets
AS
SELECT AW.*
FROM AllWidgets AW
INNER JOIN widgets_authorized WA ON WA.Widget_ID = AW.Widget_ID
WHERE WA.User_ID IN (SELECT U.User_ID FROM Users U WHERE U.Login = SYSTEM_USER) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-13T22:30:34.350

另一个更接近你奇怪解决方案的建议。

与其使用单个架构创建多个视图，不如创建具有唯一名称和多个架构的视图：sec_182.actions_authorized

使用“FROM actions_authorized”运行查询，不要显式模式，sql 引擎将使用属于已连接用户模式的视图。

可以使用后台进程或在用户登录时创建模式及其视图（CREATE TRIGGER ... ON ALL SERVER ... AFTER LOGON ...）

# php - 在 php 或 javascript 中未检测到 Cookie

> ID：14166520
> 
> 赞同：-1
> 
> 时间：2013-01-04T23:08:43.810
> 
> 标签：php, javascript, html, cookies

我不确定我哪里出错了。我有一个表单，当表单的内容被处理并发送到数据库时，它还会设置一个 cookie

```
setcookie("bgremkey",$checkkey, time()+2592000); 
```

然后它将用户重定向回他们来自的页面。所有这一切都很好（禁止饼干位）

然后我将它设置在每个页面的顶部，前提是没有活动的会话来检查 cookie 是否存在以及它是否重定向但它不会工作。我确定 cookie 在那里，但它不会把它捡起来

```
<?php
                if(isset($_COOKIE['bgremkey']))
                {

                    header("location:'Check.php?cklog=1");
                } 
```

?>

```
<script type="text/javascript" language="JavaScript">
var acookie = ReadCookie("bgremkey");
if(acookie.length != 0)
 { 
  window.location = " Check.php?cklog=1";
 } 
```

这段代码不会产生任何错误，但它也不会做任何事情。我已经尝试将它放在页面中，但是没有用，所以我然后尝试了正文，但没有工作检查页面做了很多其他的东西，但这不是问题，因为重定向永远不会发生

我通过 chrome 检查了 cookie 并且 cookie 存在并且它的路径是 / 所以问题肯定是阅读它们。它存在但由于某种原因无法检测到

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:14:56.340

[http://php.net/manual/en/function.setcookie.php](http://php.net/manual/en/function.setcookie.php)

`setcookie("cookiename","cookievalue", $time);`只会为当前路径设置它

而：`setcookie("cookiename","cookievalue", $time,"/");` 将为该域上的所有页面/文件夹设置 cookie（请注意包含*路径*的第 4 个参数）。

如果您在 google chrome 中按 CTRL+SHIFT+J，然后单击“资源”选项卡，您可以找到 cookie 及其有效路径。我会检查一下。也许这就是为什么？

# python - 如何从 Python 代码访问 ${buildout:directory}？

> ID：14166526
> 
> 赞同：1
> 
> 时间：2013-01-04T23:09:23.463
> 
> 标签：python, pyramid, buildout, paster

我有一个用 zc.buildout 管理的 Pyramid Web 应用程序。在其中，我需要读取磁盘上的一个文件，该文件位于 buildout 目录的子目录中。

问题在于确定文件的路径 - 我不想硬编码绝对路径，并且在生产中提供应用程序时仅提供相对路径不起作用（可能是因为工作目录不同）。

所以我正在考虑的有前途的“钩子”是：

*   “根”构建目录，我可以在 buildout.cfg 中将其寻址为`${buildout:directory}`- 但是，我无法弄清楚如何“导出”它以便 Python 代码可以访问它

*   启动应用程序的 Paster 的 .ini 文件的位置

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T08:31:15.473

就像@MartijnPieters 在对您自己的答案的评论中建议的那样，我会使用[collective.recipe.template](http://pypi.python.org/pypi/collective.recipe.template)在`.ini`. 我想知道我如何才能在我的项目中访问这些数据，所以我解决了:-)

让我们倒退到你需要的东西。首先在您想要构建目录的视图代码中：

```
def your_view(request):
    buildout_dir = request.registry.settings['buildout_dir']
    .... 
```

`request.registry.settings`（[参见文档](http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/api/registry.html#pyramid.registry.Registry.settings)）是一个“类似字典的部署设置对象”。请参阅[部署设置](http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/narr/startup.html#deployment-settings)，这就是`**settings`传递给您的主要方法的内容，例如`def main(global_config, **settings)`

这些设置是`[app:main]`您`deployment.ini`或`production.ini`文件的一部分。所以在那里添加 buildout 目录：

```
[app:main]
use = egg:your_app

buildout_dir = /home/you/wherever/it/is

pyramid.reload_templates = true
pyramid.debug_authorization = false
... 
```

但是，这是最后一步，您不希望在其中包含硬编码路径。因此，使用模板生成 .ini。该模板`development.ini.in`使用`${partname:variable}`扩展语言。在您的情况下，您需要`${buildout:directory}`：

```
[app:main]
use = egg:your_app

buildout_dir = ${buildout:dir}
#              ^^^^^^^^^^^^^^^

pyramid.reload_templates = true
pyramid.debug_authorization = false
... 
```

添加一个构建部分以从以下`buildout.cfg`生成：`development.ini``development.ini.in`

```
[buildout]
...
parts =
    ...
    inifile
    ...

[inifile]
recipe = collective.recipe.template
input = ${buildout:directory}/development.ini.in
output = ${buildout:directory}/development.ini 
```

请注意，您可以使用collective.recipe.template 做各种很酷的事情。例如，在 your和 your`${serverconfig:portnumber}`中生成匹配的端口号。玩得开心！`production.ini``your_site_name.nginx.conf`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T15:34:55.580

如果相对于构建根目录或 paste.ini 位置的文件路径始终相同，这似乎来自您的问题，您可以在 paste.ini 中设置它：

```
[app:main]
...
config_file = %(here)s/path/to/file.txt 
```

然后从注册表中访问它，如 Reinout 的回答：

```
def your_view(request):
    config_file = request.registry.settings['config_file'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T00:43:25.443

这是我设计的一个相当笨拙的解决方案：

在`buildout.cfg`我使用`extra-paths`选项`zc.recipe.egg`将构建目录添加到`sys.path`：

```
....
[webserver]
recipe = zc.recipe.egg:scripts
eggs = ${buildout:eggs}
extra-paths = ${buildout:directory} 
```

然后我将一个名为的文件`app_config.py`放入 buildout 目录：

```
# This remembers the root of the installation (similar to {buildout:directory}
# so we can import it and use where we need access to the filesystem.
# Note: we could use os.getcwd() for that but it feels kinda wonky
# This is not directly related to Celery, we may want to move it somewhere
import os.path
INSTALLATION_ROOT = os.path.dirname(__file__) 
```

现在我们可以在 Python 代码中导入它：

```
from app_config import INSTALLATION_ROOT
filename = os.path.join(INSTALLATION_ROOT, "somefile.ext")
do_stuff_with_file(filename) 
```

如果有人知道更好的解决方案，欢迎您:)

# asp.net-mvc - Mvc ModelBinder 序列化器/反序列化器

> ID：14166533
> 
> 赞同：0
> 
> 时间：2013-01-04T23:10:37.427
> 
> 标签：asp.net-mvc, rest, serialization, asp.net-web-api

任何人都知道 Asp.NET Mvc 正在使用哪种序列化程序？

当您尝试将以下类打印到视图时，我相信您已经注意到了。

```
public class Class
{
     Pupil[] Pupils {get;set;}
     Instructor Instructor {get;set;}
} 
```

你在回发时会得到这样的东西：

```
Pupils[0]=Me&Pupils[1]=Abc&Instructor=Some1 //Ala Mvc Modelbinder when you post the model back to server. 
```

或者，如果您从 jQuery AJAX 调用控制器操作，JSON 对象将被序列化为 URI 中的以下查询：

```
Class[Pupil][0]=Me&Class[Pupil][1]=Abc&Class[Instructor]="Some1" //Ala. JQuery Get Serializer 
```

上面两个序列化器叫什么名字？这个库在 C# 中在哪里？

我想利用模型绑定器能够将上述内容绑定到正确的复杂类型的事实，通过 URI (http GET) 将复杂类型传递到我的 WebAPI。可以从客户端（通过 JavaScript）和服务器端（在 C# 中）调用 Web API。

# html - 为什么以这种方式使用数据属性？

> ID：14166538
> 
> 赞同：2
> 
> 时间：2013-01-04T23:10:46.983
> 
> 标签：html, twitter-bootstrap, custom-data-attribute

学习如何使用 Bootstrap，我注意到缩略图对图像源有奇怪的标记（至少，对我来说很奇怪。）

```
<img data-src="holder.js/260x120" alt="260x120" style="width: 260px; height: 120px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAB4CAYAAAAUn4wEAAAGP0lEQVR4Xu3aPUsdWxQG4LEwKiSFTbQTsUwsRfDvp7KRVBFrEVIEsRFT+HHvHJjDODrH96ghQ9aT5nLD8rjXs/Z+3TNx5fLy8qHxhwABAv8LrAgE+4AAgU5AINgLBAjMBQSCzUCAgECwBwgQeCrghmBXECDghmAPECDghmAPECCwQMAjg+1BgIBHBnuAAAGPDPYAAQIeGewBAgQSAe8QEiU1BIoICIQig9YmgURAICRKaggUERAIRQatTQKJgEBIlNQQKCIgEIoMWpsEEgGBkCipIVBEQCAUGbQ2CSQCAiFRUkOgiIBAKDJobRJIBARCoqSGQBEBgVBk0NokkAgIhERJDYEiAgKhyKC1SSAREAiJkhoCRQQEQpFBa5NAIiAQEiU1BIoICIQig9YmgURAICRKaggUERAIRQatTQKJgEBIlNQQKCIgEIoMWpsEEgGBkCipIVBEQCAUGbQ2CSQCAiFRUkOgiIBAKDJobRJIBARCoqSGQBEBgVBk0NokkAgIhERJDYEiAgKhyKC1SSAREAiJkhoCRQQEQpFBa5NAIiAQEiU1BIoICIQig9YmgURAICRKaggUERAIRQatTQKJgEBIlNQQKCIgEIoMWpsEEgGBkCipIVBEQCAUGbQ2CSQCAiFRUkOgiIBAmOCgT09Pm4uLi/nKPn361BweHj5a6eXlZfP9+/fm/v5+9vfP1ZyfnzdnZ2fzr9vd3W329vZe3fHJyUnTft+tra1mf3//0ecka37v9by6EV84KiAQJrY5ukM3XFb/wA/DoKvtH9Th4etqXhsK/c8bBkKy5vdez8TG9s8sRyBMaJS3t7fNt2/fmru7u6Y7uP2D9PXr1+bz58/N8fFxc319/aRmZWWlOTo6atbW1uY13eHtfoKvr6/Pbhurq6tx58MD3w+EZdf8HuuJF65waQGBsDTZn/uC7vB3B3tjY6MZHridnZ1ZaLSPCu3hb2uGf/o3iDZEtre3Z1f99hHj4eFh9nU3NzfzR44ufIZf1w+f9nu0YfL79+9HjwzJmjc3N+ffa2w9z/Xx56R98piAQJj43hge0g8fPswOV/vf9oBeXV3NOuj/1B4e/mGwdIey+8nffs7BwUHT/n978+g+qw2d9jby8ePH5suXL09uHWN0Y2vuwmhsPRMfRYnlCYQJj7k7kO0h7d4hjD2Lt20MaxbdNNqXi/3bR3uL+PnzZ9P/mj5Nfy3PvVTsahet+aX1THgUZZYmECY66v7B6h+kfiAM3zN0db9+/Zr960JyANM3/0kgvLTmZD0THUeZZQmECY567GC1S00eB7rHiuSK3r8ljN0O2u/7UiC8dc3tDcWfvy8gEP7+DB6tYNHBWjYQ2s966SXe8PcHxh4HFgVCuuZkPRMbR7nlCISJjbx70bfMs/zwTX/6z47920b70vDHjx+zm0AXIuk7hNes+S3/DDqxkf1TyxEIExrn2C8cdUt87ncT+stf5heTnvuJv+iQjt0Q3rrm1/6i1ITG9k8tRSBMaJzD6/twaf3DMzyIz131F70w7L7X2Iu+4eeNBcIya05fYE5oJOWWIhDKjVzDBMYFBILdQYDAXEAg2AwECAgEe4AAgacCbgh2BQECbgj2AAECbgj2AAECCwQ8MtgeBAh4ZLAHCBDwyGAPECDgkcEeIEAgEfAOIVFSQ6CIgEAoMmhtEkgEBEKipIZAEQGBUGTQ2iSQCAiEREkNgSICAqHIoLVJIBEQCImSGgJFBARCkUFrk0AiIBASJTUEiggIhCKD1iaBREAgJEpqCBQREAhFBq1NAomAQEiU1BAoIiAQigxamwQSAYGQKKkhUERAIBQZtDYJJAICIVFSQ6CIgEAoMmhtEkgEBEKipIZAEQGBUGTQ2iSQCAiEREkNgSICAqHIoLVJIBEQCImSGgJFBARCkUFrk0AiIBASJTUEiggIhCKD1iaBREAgJEpqCBQREAhFBq1NAomAQEiU1BAoIiAQigxamwQSAYGQKKkhUERAIBQZtDYJJAICIVFSQ6CIgEAoMmhtEkgEBEKipIZAEQGBUGTQ2iSQCAiEREkNgSICAqHIoLVJIBEQCImSGgJFBARCkUFrk0AiIBASJTUEiggIhCKD1iaBREAgJEpqCBQREAhFBq1NAonAfyCREfyopr43AAAAAElFTkSuQmCC"> 
```

这里发生了什么，为什么要这样做？图像是否在 base64 的某个时间点以某种方式保存到本地存储？

为了澄清，我在问这个`src="image:/`部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T23:29:24.857

您看到的不是[HTML5 数据属性](http://www.w3.org/TR/html51/dom.html#embedding-custom-non-visible-data-with-the-data-%2a-attributes)，而是[数据 URI 方案](https://en.wikipedia.org/wiki/Data_URI_scheme)。引用维基百科：

> 数据 URI 方案 ... 提供了一种在网页中包含内嵌数据的方法，就好像它们是外部资源一样。这种技术允许在单个 HTTP 请求中获取通常单独的元素，例如图像和样式表，而不是多个 HTTP 请求，这可能更有效。

您看到的是 base64 编码的图像数据，在本例中为 PNG。当浏览器看到这一点时，它们会按照指示对数据进行解码，并将其显示为就好像它是外部资源一样。

鉴于此图像的大小，Bootstrap 的创建者正确地认为，像这样内联图像比将其分开更有效。如果他们将其分开，则需要额外的 HTTP 请求来加载图像，这会增加页面的总加载时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-21T15:30:58.403

在 Bootstrap 的情况下，我认为您看到的是 Javascript 用于生成 src 属性中的数据。

如果您查看原始源（不是检查器中的源），您可能不会看到 src 属性，只有 data-src。

data-src 属性是 javascript 使用 holder.js 脚本生成要进入 src 的数据的指令。

因此 holder.js 生成图像，然后将其作为数据 uri 加载到 img 中，如其他答案所述。

# java - 如何重写此方法以删除多余的 if 语句？

> ID：14166545
> 
> 赞同：3
> 
> 时间：2013-01-04T23:11:20.690
> 
> 标签：java, performance

如何重写此方法以最大程度地提高代码效率并最小化代码长度？

**注意**：`HEADER`是之前定义的常量。

```
private static URL getURL(String OS, String type, String size) {
        String prefix = "";
        String prefixLarge = "";
        if (type.equals("image")) {
            prefix = HEADER + "/image";
            prefixLarge = HEADER + "/image_large";
        } else {
            prefix = HEADER + "/file";
            prefixLarge = HEADER + "/file_raw";
        }
        String suffix = ".zip";
        String url = "";
        if (OS.contains("Win7.32bit")) {
            // win7-32bit system
            url = prefix + "Win7.32bit" + suffix;
            if (size.contains("origin")) {
                url = prefixLarge + "Win7.32bit" + suffix;
            }
        } else if (OS.contains("Win7.64bit")) {
            // win7-64bit system
            url = prefix + "Win7.64bit" + suffix;
            if (size.contains("origin")) {
                url = prefixLarge + "Win7.64bit" + suffix;
            }
        } else if (OS.contains("WinXP")) {
            // winxp-32bit system
            url = prefix + "WinXP" + suffix;
            if (size.contains("origin")) {
                url = prefixLarge + "WinXP" + suffix;
            }
        } else if (OS.contains("WinXP.64bit")) {
            // winxp-64bit system
            url = prefix + "WinXP.64bit" + suffix;
            if (size.contains("origin")) {
                url = prefixLarge + "WinXP.64bit" + suffix;
            }
        } else if (OS.contains("10.04")) {
            // ubuntu10.04 system
            url = prefix + "ubuntu10.04" + suffix;
            if (size.contains("origin")) {
                url = prefixLarge + "ubuntu10.04" + suffix;
            }
        } else if (OS.contains("12.04")) {
            // ubuntu12.04 system
            url = prefix + "ubuntu12.04" + suffix;
            if (size.contains("origin")) {
                url = prefixLarge + "ubuntu12.04" + suffix;
            }
        }
        return url;
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-04T23:15:16.230

`Strings`创建一个包含所有操作系统名称的数组。然后用循环遍历该数组`for`。

像这样：

```
String[] osNames = { "Win7.32bit", "Win7.64bit", "10.04" };
String[] osTypes = { "Win7.32bit", "Win7.64bit", "ubuntu10.04" };
for (int i = 0; i < Math.min(osNames.length, osTypes.length); i++) {
    if (OS.contains(osName[i])) {
        url = prefix + osType[i] + suffix;
        if (size.contains("origin")) {
            url = prefixLarge + osType[i] + suffix;
        }
        break;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-04T23:31:13.903

```
 private static Map <String, String> osMap = new HashMap<String, String>();
    static {
      osMap.put("Win7.32bit", "Win7.32bit");
      osMap.put("Win7.64bit", "Win7.64bit");
      osMap.put("WinXP", "WinXP");
      osMap.put("WinXP.64bit", "WinXP.64bit");
      osMap.put("10.04", "ubuntu10.04");
      osMap.put("12.04", "ubuntu12.04");
    }

    private static URL getURL(String os, String type, String size) {
        String prefix = "";
        String prefixLarge = "";
        if (type.equals("image")) {
            prefix = HEADER + "/image";
            prefixLarge = HEADER + "/image_large";
        } else {
            prefix = HEADER + "/file";
            prefixLarge = HEADER + "/file_raw";
        }
        String suffix = ".zip";
        String url = "";
        String systemType = "";

        for(String key : osMap.keySet()) {
           if(os.contains(key) {           
              url = prefix + osMap.get(key) + suffix;
              if (size.contains("origin")) {
                url = prefixLarge + osMap.get(key) + suffix;
              }
              break;
           }
        }
        return url;
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-04T23:42:36.963

```
private static URL getURL(String OS, String type, String size) {

    return  HEADER
            +
            size.contains("origin") 
                            ? ((type.equals("image") ? "/image_large" : "/file_raw" ))
                            : ((type.equals("image") ? "/image" : "/file" )) 
            +
            OS.contains("Win7.32bit")   ? "Win7.32bit" :
            OS.contains("Win7.64bit")   ? "Win7.64bit" : 
            OS.contains("WinXP.64bit")  ? "WinXP.64bit" :       
            OS.contains("WinXP")        ? "WinXP" : 
            OS.contains("10.04")        ? "ubuntu10.04" : 
            OS.contains("12.04")        ? "ubuntu12.04" : 
            ""
            +
            ".zip";
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-04T23:18:59.480

```
String[] osNames={"Win7.32bit", "Win7.64bit"};
        for(String os : osNames){
            if(OS.contains(os)){
                url = prefix + os + suffix;
                if (size.contains("origin")) {
                    url = prefixLarge + os + suffix;
                }
                break;
            }
        } 
```

这是删除 if-else 条件的代码的一部分。注意 break 语句。

# javascript - 谷歌地图绘图管理器限制为 1 个多边形

> ID：14166546
> 
> 赞同：17
> 
> 时间：2013-01-04T23:11:30.113
> 
> 标签：javascript, google-maps, google-maps-api-3, dom-events

我正在使用 google maps v3 API 创建地图。使用绘图管理器绘制形状。有没有办法在绘制 1 个多边形后禁用多边形按钮？我一直在通过 API 阅读，但找不到任何多边形启动事件，仅适用于多边形完成。

也许一种检测绘图模式变化的方法？或删除`google.maps.drawing.OverlayType.POLYGON`但如果当前多边形已删除，则将其放回原处？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-01-05T00:49:21.363

[文档](https://developers.google.com/maps/documentation/javascript/overlays#drawing_tools)。

1.  从[这个示例](https://developers.google.com/maps/documentation/javascript/examples/drawing-tools)开始。

2.  隐藏多边形完成事件中的绘图控件

    ```
     drawingManager.setOptions({
          drawingControl: false
        }); 
    ```

3.  在deleteSelectedShape函数中添加绘图控件

    ```
     drawingManager.setOptions({
       drawingControl: true
     }); 
    ```

4.  将绘图管理器配置为仅添加多边形

    ```
     drawingControlOptions: {
        drawingModes: [
          google.maps.drawing.OverlayType.POLYGON
        ]
      }, 
    ```

[工作示例](http://geocodezip.com/v3_GoogleEx_drawing-tools_single.html)

**代码片段：**

```
var drawingManager;
var selectedShape;
var colors = ['#1E90FF', '#FF1493', '#32CD32', '#FF8C00', '#4B0082'];
var selectedColor;
var colorButtons = {};

function clearSelection() {
  if (selectedShape) {
    selectedShape.setEditable(false);
    selectedShape = null;
  }
}

function setSelection(shape) {
  clearSelection();
  selectedShape = shape;
  shape.setEditable(true);
  selectColor(shape.get('fillColor') || shape.get('strokeColor'));
}

function deleteSelectedShape() {
  if (selectedShape) {
    selectedShape.setMap(null);
    // To show:
    drawingManager.setOptions({
      drawingControl: true
    });
  }
}

function selectColor(color) {
  selectedColor = color;
  for (var i = 0; i < colors.length; ++i) {
    var currColor = colors[i];
    colorButtons[currColor].style.border = currColor == color ? '2px solid #789' : '2px solid #fff';
  }

  // Retrieves the current options from the drawing manager and replaces the
  // stroke or fill color as appropriate.
  var polylineOptions = drawingManager.get('polylineOptions');
  polylineOptions.strokeColor = color;
  drawingManager.set('polylineOptions', polylineOptions);

  var rectangleOptions = drawingManager.get('rectangleOptions');
  rectangleOptions.fillColor = color;
  drawingManager.set('rectangleOptions', rectangleOptions);

  var circleOptions = drawingManager.get('circleOptions');
  circleOptions.fillColor = color;
  drawingManager.set('circleOptions', circleOptions);

  var polygonOptions = drawingManager.get('polygonOptions');
  polygonOptions.fillColor = color;
  drawingManager.set('polygonOptions', polygonOptions);
}

function setSelectedShapeColor(color) {
  if (selectedShape) {
    if (selectedShape.type == google.maps.drawing.OverlayType.POLYLINE) {
      selectedShape.set('strokeColor', color);
    } else {
      selectedShape.set('fillColor', color);
    }
  }
}

function makeColorButton(color) {
  var button = document.createElement('span');
  button.className = 'color-button';
  button.style.backgroundColor = color;
  google.maps.event.addDomListener(button, 'click', function() {
    selectColor(color);
    setSelectedShapeColor(color);
  });

  return button;
}

function buildColorPalette() {
  var colorPalette = document.getElementById('color-palette');
  for (var i = 0; i < colors.length; ++i) {
    var currColor = colors[i];
    var colorButton = makeColorButton(currColor);
    colorPalette.appendChild(colorButton);
    colorButtons[currColor] = colorButton;
  }
  selectColor(colors[0]);
}

function initialize() {
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 10,
    center: new google.maps.LatLng(22.344, 114.048),
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    disableDefaultUI: true,
    zoomControl: true
  });

  var polyOptions = {
    strokeWeight: 0,
    fillOpacity: 0.45,
    editable: true
  };
  // Creates a drawing manager attached to the map that allows the user to draw
  // markers, lines, and shapes.
  drawingManager = new google.maps.drawing.DrawingManager({
    drawingMode: google.maps.drawing.OverlayType.POLYGON,
    drawingControlOptions: {
      drawingModes: [
        google.maps.drawing.OverlayType.POLYGON
      ]
    },
    markerOptions: {
      draggable: true
    },
    polylineOptions: {
      editable: true
    },
    rectangleOptions: polyOptions,
    circleOptions: polyOptions,
    polygonOptions: polyOptions,
    map: map
  });

  google.maps.event.addListener(drawingManager, 'overlaycomplete', function(event) {
    if (event.type == google.maps.drawing.OverlayType.CIRCLE) {
      var radius = event.overlay.getRadius();
    }
  });
  google.maps.event.addListener(drawingManager, 'overlaycomplete', function(e) {
    if (e.type != google.maps.drawing.OverlayType.MARKER) {
      // Switch back to non-drawing mode after drawing a shape.
      drawingManager.setDrawingMode(null);
      // To hide:
      drawingManager.setOptions({
        drawingControl: false
      });

      // Add an event listener that selects the newly-drawn shape when the user
      // mouses down on it.
      var newShape = e.overlay;
      newShape.type = e.type;
      google.maps.event.addListener(newShape, 'click', function() {
        setSelection(newShape);
      });
      setSelection(newShape);
    }
  });

  // Clear the current selection when the drawing mode is changed, or when the
  // map is clicked.
  google.maps.event.addListener(drawingManager, 'drawingmode_changed', clearSelection);
  google.maps.event.addListener(map, 'click', clearSelection);
  google.maps.event.addDomListener(document.getElementById('delete-button'), 'click', deleteSelectedShape);

  buildColorPalette();
}
google.maps.event.addDomListener(window, 'load', initialize);
```

```
#map,
html,
body {
  padding: 0;
  margin: 0;
  height: 100%;
}

#panel {
  width: 200px;
  font-family: Arial, sans-serif;
  font-size: 13px;
  float: right;
  margin: 10px;
}

#color-palette {
  clear: both;
}

.color-button {
  width: 14px;
  height: 14px;
  font-size: 0;
  margin: 2px;
  float: left;
  cursor: pointer;
}

#delete-button {
  margin-top: 5px;
}
```

```
<script src="https://maps.google.com/maps/api/js?key=AIzaSyCkUOdZ5y7hMm0yrcCQoCvLwzdM6M8s5qk&libraries=drawing"></script>
<div id="panel">
  <div id="color-palette"></div>
  <div>
    <button id="delete-button">Delete Selected Shape</button>
  </div>
</div>
<div id="map"></div>
```

# android - 如何从列等于NULL的表中获取数据

> ID：14166550
> 
> 赞同：0
> 
> 时间：2013-01-04T23:11:36.707
> 
> 标签：android, sqlite, android-sqlite

我有表：

```
CREATE TABLE Reports (
         _id INTEGER NOT NULL PRIMARY KEY,member_id INTEGER, 
      is_conf BOOLEAN,
         name TEXT, 
      started INTEGER,

     finished INTEGER,
    description TEXT, 
       obj_id INTEGER NOT NULL, 
     FOREIGN KEY (obj_id) REFERENCES Objects (_id));
```

我想在哪里获取数据`member_id = NULL`。
但是查询：

```
String sql = "SELECT _id, name FROM Reports WHERE member_id = NULL";
Cursor cursor = db.rawQuery(sql, null);
```

不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-04T23:14:00.503

您将需要使用这个：

```
String sql = "SELECT _id, name FROM Reports WHERE member_id IS NULL"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:14:39.800

[按照http://www.sqlite.org/lang_corefunc.html#ifnull](http://www.sqlite.org/lang_corefunc.html#ifnull)文档中的说明使用 IFNULL

# emacs - 在 Emacs Shell 模式下显示 TTY

> ID：14166553
> 
> 赞同：2
> 
> 时间：2013-01-04T23:11:49.083
> 
> 标签：emacs

使用 Emacs shell 模式时有什么方法可以显示当前的 TTY？现在我通过将 tty 显示为提示的一部分来解决问题，但这需要向后滚动

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T01:08:02.610

您可以在模式行上显示它。

查看 elisp 手册第 23.4 节中的文档 - `Mode Line Format`。在 23.4.2 小节中写了你是如何做到的：你编写一个返回你感兴趣的值的表单。

```
`(:eval FORM)'
 A list whose first element is the symbol `:eval' says to evaluate
 FORM, and use the result as a string to display.  Make sure this
 evaluation cannot load any files, as doing so could cause infinite
 recursion. 
```

# php - PHP按值删除关联数组中的元素

> ID：14166555
> 
> 赞同：-1
> 
> 时间：2013-01-04T23:11:56.040
> 
> 标签：php, arrays

> **可能重复：**
> [使用 PHP 删除数组中小于 X 的整数](https://stackoverflow.com/questions/2619944/remove-integers-in-array-less-than-x-with-php)

```
$array = array( 
    "a" => 10, 
    "b" => 9, 
    "c" => 8, 
    "d" => 7,
    "e" => 6,
    "f" => 5,
    "g" => 4,
    "h" => 3 
    ); 
```

如果值小于 6，如何删除该项目？即，我怎样才能得到以下数组？

```
$array = array( 
    "a" => 10, 
    "b" => 9, 
    "c" => 8, 
    "d" => 7,
    "e" => 6
    ); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T23:13:59.253

[`array_filter`](http://php.net/array-filter)非常适合：

```
$new = array_filter($old,function($a) {return $a >= 6;}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T23:17:27.940

一个简单的迭代将是：

```
$new_array = array();
foreach($arras as $key => $value){
  if($value >= 6)new_array[$key] = $value;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T23:17:49.773

```
foreach($array as $index=>$value) {
  if ( $value < 6) {
    unset($array[$index]);
  }
} 
```

或者

```
foreach($array as $index=>$arr_value) {
  if ( $value >= 6) {
    $new_array[$index] = $arr_value;
  }
} 
```

# javascript - JQuery：查找（索引）具有特定数据属性值的行

> ID：14166557
> 
> 赞同：15
> 
> 时间：2013-01-04T23:12:04.253
> 
> 标签：javascript, jquery

我正在尝试在与此类似的表中的特定行之后附加一个字符串 myoutput：

```
<table>
<tr data-my_id='1'> <td> content </td> </tr>
<tr data-my_id='2' data-my_other_id='1' > <td> content </td> </tr>
<tr data-my_id='3' data-my_other_id='2' > <td> content </td> </tr>
</table> 
```

所以假设我想在 tr 之后附加我的输出字符串`data-my_other_id='2'` （请注意，在我的代码中，`my_other_id = 2`已经）

我正在尝试这样做：

```
var want = $("tr").find("[data-my_other_id='" + my_other_id + "']").index(); 
```

找到索引后，我想将我的输出字符串附加到这一行......

```
$(want).insertAfter(...?); 
```

还有……我每次做的时候都注意到了

```
alert( want = $("tr").find("[data-my_other_id='" + my_other_id + "']").length) 
```

我得到0 ...

请帮助并让我知道我的问题是否不够清楚，以便我可以更好地解释。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-04T23:27:09.507

我假设您想要更新内容而不是追加，但它并没有真正改变任何东西。我认为您不想那样使用 find() 。尝试类似：

```
var $row = $('tr[data-my_other_id="' + id + '"]');
// should be the index of the tr in the <table>
// this may not be a good idea though - what if you add a header row later?
var index = row.index() + 1; // if you want 1-based indices
$row.find("td").text("I am row #" + index); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T23:18:31.657

这是因为 find 不会搜索兄弟姐妹，只会搜索孩子。尝试将您的搜索附加到表格中。

html:

```
<table>
<tr data-my_id='1'> <td> content </td> </tr>
<tr data-my_id='2' data-my_other_id='1' > <td> content </td> </tr>
<tr data-my_id='3' data-my_other_id='2' > <td> content </td> </tr>
</table>​ 
```

js：

```
var my_other_id = 2;
alert( $("table").find("[data-my_other_id='" + my_other_id + "']").length);​ 
```

演示：http: [//jsfiddle.net/gDb3A/](http://jsfiddle.net/gDb3A/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T23:19:01.337

您不需要使用 find 方法，因为 data 属性位于 tr 本身上。此外，您对索引的使用也不起作用。请尝试以下操作。

```
$("tr[data-my_other_id='" + my_other_id + "']").insertAfter(...?); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-04T23:19:12.503

`find`寻找后代。A`TR`不能是它自己的后代。

尝试使用`filter()`

```
$("tr").filter("[data-my_other_id='" + my_other_id + "']").index(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-25T09:56:45.077

在具体的表中查找这样会更快，可以使用这种方法。

JS：

```
$('any-button').click(function(){
    var id = 23;
    var $row = $('.your-class tbody tr[data-id="' + id + '"]');
    $row.remove();
}); 
```

html

```
<table class="table table-striped your-class">
        <thead>
        <tr>...<tr/>
       </thead>
      <tbody>
        <tr data-id="23">Some text</tr>
       <tr data-id="43">Some text</tr>
       <tr data-id="43">Some text</tr>
     </tbody>
</table> 
```

# arrays - 添加新的 HighChart 系列

> ID：14166561
> 
> 赞同：10
> 
> 时间：2013-01-04T23:12:20.927
> 
> 标签：arrays, highcharts, live, series

在此代码 javascrip 给出错误

```
$.each(JSON, function(i, array) {                        
    chart.series[i].name = array.teamName;
    chart.series[i].setData(array.teamPower, true);
}); 
```

我必须定义chart.series[i]，因为它说“无法设置未定义的属性'名称'”，但我找不到这样做的方法。

因为它的功能与 requestData 一起运行，所以它是在图表确定选项之后出现的

```
function showGraph() {  
    chart = new Highcharts.Chart(option);       
} 
```

* * *

```
chart: {
    renderTo: 'graphicShow',
    type: 'spline',
    events: {
        load: requestData
    }
} 
```

* * *

...在选项中...

```
title: {
    text: 'Power %'
},
series: [] 
```

...

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-05T10:58:31.670

您需要查看 API 的“方法和属性”部分。请参阅[http://api.highcharts.com/highcharts#Chart](http://api.highcharts.com/highcharts#Chart)（文档页面上也有一个 jsFiddle）。

```
var chart = new Highcharts.Chart(options);
chart.addSeries({                        
    name: array.teamName,
    data: array.teamPowher
}); 
```

如果要添加多个系列，则应将`redraw`标志设置为 false，然后手动调用 redraw，因为这样会快得多。

```
var chart = new Highcharts.Chart(options);
chart.addSeries({                        
    name: array.teamName,
    data: array.teamPower
}, false);
chart.addSeries({                        
    name: array.teamName,
    data: array.teamPower
}, false);
chart.redraw(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T20:31:29.560

您也可以指定为`addSeries`布尔值的第二个选项，指示它是否重绘

# iphone - 向 UIButton 添加声音的可靠方法

> ID：14166563
> 
> 赞同：2
> 
> 时间：2013-01-04T23:12:47.057
> 
> 标签：iphone, ios, audio, avaudioplayer, system-sounds

我正在尝试向 UIButton 添加点击声音以在按下时播放。到目前为止，我已经尝试了两种方法，但没有一种方法能达到我希望的效果。

1.  我尝试过使用简单的 SystemSounds，但它们是一个丑陋的解决方案，因为用户无法（或者说非常有限）控制音量。

2.  我还尝试了以下形式的 AVAudioPlayer（在 ViewController 的 init 方法中调用）：

    ```
    [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryAmbient 
                                           error:nil];
    [[AVAudioSession sharedInstance] setActive:YES error:nil];
    [[AVAudioSession sharedInstance] setDelegate:self];

    NSString *filePath = [[NSBundle mainBundle] 
                         pathForResource: @"button_pushed"
                                  ofType: @"wav"];
    NSURL *fileURL = [[NSURL alloc] initFileURLWithPath: filePath];
    self.buttonPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL: fileURL
                                                               error: nil];
    [buttonPlayer prepareToPlay];
    [buttonPlayer setDelegate: self]; 
    ```

第二种方法似乎比第一种方法好得多。特别是当我用以下语句调用声音时：

```
 if (self.clickPlayer.playing) {
        [self.clickPlayer stop];
        self.clickPlayer.currentTime = 0;
        [self.clickPlayer play];
    }
    else {
        [self.clickPlayer play];
    } 
```

以上确保了我在反复按下按钮时得到了非常快速的响应。顺便说一句，快速响应时间在我的应用程序中是必不可少的，不幸的是，这是第二种方法失败的地方。

如果我让应用程序空闲大约 10 秒，加载第一个声音需要一个明显的延迟（然后，它会再次变得快速和响应）。不仅如此，它还会延迟按钮被按下。虽然这个延迟非常小（可能只有几分之一秒），但不幸的是它确实影响了我的应用程序的可用性。就好像声音正在自动释放，每次我有一段时间不使用它时都需要初始化或放入内存。

**是否有解决方法可以始终保持声音可用并避免延迟或其他可能简单的方法来实现按钮声音？**

更多信息： 1\. 我使用 ARC 2\. 我不使用 IB 3\. 目前，没有实现音频委托方法 4\. 从其他应用程序在后台播放音频的能力很重要 5\. 发生延迟在 iPhone 5 上；所以，我只能想象在功能较弱的设备上需要多长时间......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T10:13:10.790

我设法通过创建一个“空白”播放器来解决这个问题，该播放器不断地发出一个没有声音的微小 .wav 文件，从而使 AVPlayer 保持活动状态。这可能不是最优雅的解决方案，但它确实有效，而且似乎不会影响程序的性能。这是您需要做的：

1.  创建一个 0.1 秒长的无声 .wav 文件（越小越好）。

2.  为它初始化一个播放器：

    ```
    NSString *filePath = [[NSBundle mainBundle] pathForResource: @"silence"
                                                         ofType: @"wav"];
    NSURL *fileURL = [[NSURL alloc] initFileURLWithPath: filePath];
    silencePlayer = [[AVAudioPlayer alloc] initWithContentsOfURL: fileURL
                                                           error: nil];
    [silencePlayer prepareToPlay];
    [silencePlayer setDelegate: self]; 
    ```

3.  然后让它每隔一秒左右触发一次：

    ```
    timer = [NSTimer scheduledTimerWithTimeInterval:1.0f
                                             target:self
                                           selector:@selector(repeatSilence)
                                           userInfo:nil
                                            repeats:YES]; 
    ```

4.  最后，创建被调用的方法 (- (void) repeatSilence { } ) 来播放声音：

    ```
    if (self.silencePlayer.playing) {
        [self.silencePlayer stop];
        self.silencePlayer.currentTime = 0;
        [self.silencePlayer play];
    }
    else {
        [self.silencePlayer play];
    } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T03:26:48.427

`[[AVAudioPlayer alloc] initWithContentsOfURL`不完全确定，但是如果您将路径设置为 NSData 并更改为，它会不会更快`[[AVAudioPlayer alloc] initWithData`？

# java - 实时应用程序引擎上的“PictureBook 类型对象和身份 yyy 未正确分离”

> ID：14166565
> 
> 赞同：0
> 
> 时间：2013-01-04T23:12:54.137
> 
> 标签：java, google-app-engine, jdo

我有一个对象 PictureBook ，其中包含一个带有持久性注释的 List< Picture> 。

```
@PersistenceCapable(identityType = IdentityType.APPLICATION,
    detachable = "true")
public class PictureBook {

/**
 * primary key - type encoded String
 */
@PrimaryKey
@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
@Extension(vendorName = "datanucleus", key = "gae.encoded-pk", value = "true")
private String key;

@Persistent
private String name;

@Persistent
private String creator;

@Persistent
private String link;

@Persistent
private String cover;

@Persistent(mappedBy = "pictureBook")
private List<Picture> pictures; 
```

图片类有对pict​​ureBook类的引用

```
@PersistenceCapable(identityType = IdentityType.APPLICATION,
    detachable = "true")
public class Picture implements Serializable {

/**
 * primary key - type encoded String
 */
@PrimaryKey
@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)
@Extension(vendorName = "datanucleus", key = "gae.encoded-pk", value = "true")
private String key;

@Persistent
private String albumName;

@Persistent
private String creator;

@Persistent
private String link;

@Persistent
private PictureBook pictureBook;

public Picture() {
}

public Picture(String albumName, String creator, String link) {
    this.albumName = albumName;
    this.creator = creator;
    this.link = link;
} 
```

在本地测试时，一切都按预期进行，但是当我部署到 appengine 时，我得到一个异常，告诉“xxx 类型的对象和身份 yyy 没有正确分离”。当我查询我的所有 PictureBook 实体时，我得到了这个。任何人都可以帮助我我真的坚持这个：/查询的方法如下：

```
 public List<PictureBook> getAllPictureBooks() {
    log.info("retrieving all PictureBooks from datastore...");
    PersistenceManager persistenceManager = PMF.getInstance().getPersistenceManager();
    Query retrieveAllPictureBooks = persistenceManager.newQuery(PictureBook.class);
    List<PictureBook> albumList = null;
    List<PictureBook> albums = null;
    try {
        albumList = (List<PictureBook>) retrieveAllPictureBooks.execute();
                    for(PictureBook pictureBook: albumList){
                            System.out.println(pictureBook.getPictures().size());
                    }
        albums = (List<PictureBook>)persistenceManager.detachCopyAll(albumList);
    } catch (Exception e) {
        log.error("an exception occured: \n" + e.getMessage());
    } finally {
        if (persistenceManager != null) {
            persistenceManager.close();
            log.info("persistenceManager closed");
        }
    }
    return albums;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T07:53:28.580

将图画书实体中的图片添加到默认获取组中修复了它

# javascript - javascript中的流利服务API

> ID：14166568
> 
> 赞同：0
> 
> 时间：2013-01-04T23:13:03.233
> 
> 标签：javascript, angularjs

我想在委托给它时公开一个类似于 AngularJS $http API 的流畅服务 API。

就像是：

```
login(user).success(function(data, status) {
    // success case    
}).error(function(data, status) {
    // fail case
}).go(); 
```

该实现实际上会以某种方式调用 AngularJS $http API。

```
$http.post('/api/login', user).success(function(data, status) {
    // success case    
}).error(function(data, status) {
    // fail case
}); 
```

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T23:23:45.777

`this`秘密就像为每个可链接的方法调用返回一样简单：

```
var MyApi = {
    something : function() {
        console.log('something');
        return this;
    },

    elseIsh : function() {
        console.log('else');
        return this;
    },

    again : function() {
        console.log('again');
        return this;
    }
}

MyApi.something().again().elseIsh().again(); 
```

并使用这样的新构造函数进行初始函数调用：

```
var does = function() {
    if(this.constructor !== does) {
        return new does();
    }
    console.log('does');
}

does.prototype.something = function() {
    console.log('something');
    return this;
}

does.prototype.elseIsh = function() {
    console.log('else');
    return this;
}

does.prototype.again = function() {
    console.log('again');
    return this;
}

does()​.again().something().elseIsh().again();​ 
```

# arrays - CGridView 显示来自 dataProvider 的数据

> ID：14166569
> 
> 赞同：0
> 
> 时间：2013-01-04T23:13:19.880
> 
> 标签：arrays, yii, dataprovider, cgridview

我有一个数据提供程序，它生成如下内容：

```
array(
    [0] => ParentObjects array(
         Child1Object array(...),
         Child2Object array(...),
    )
) 
```

该数组的第一级将始终为 1。我想在 CGridView 中显示两个孩子的内容。

```
$dataProvider=new CActiveDataProvider('Campanii', array(
    'criteria'=>array(
        'with'=>array('stocs','produse'),
    ),
    'pagination'=>array(
        'pageSize'=>20,
    ),
)); 
$this->widget('zii.widgets.grid.CGridView', array(
        'dataProvider'=>$dataProvider,
        'columns'=>array(
                    array('name'=>'Cod','value'=>'$data->stocs[0]->cod_produs'),
                ),
)); 
```

如您所见，该列`cod`的值为`array('name'=>'Cod','value'=>'$data->stocs[1]->cod_produs')`。请注意 [0]。我想要一个迭代器之类的东西，而不是那个零。在这种情况下，它会在一列中显示该属性的内容。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T07:37:44.143

是的，您可以编写任何您想要的复杂表达式。但是，为了便于阅读，最好使用实际函数。此示例假定 PHP 5.3+，如果您的环境不支持，只需创建一个普通函数而不是匿名函数（或找到更好的环境）。

```
$this->widget('zii.widgets.grid.CGridView', array(
  'dataProvider' => $dataProvider,
  'columns' => array(
    array(
      'name' => 'Cod',

      // needed when returning HTML instead of plain text
      'type' => 'raw',

      // this function is called each time a cell needs to be rendered
      'value' => function(Companii $data) {
        $codes = array();
        foreach($data->stocs as $stoc) {
          $code = CHtml::encode($stoc->cod_produs);
          $codes []= CHtml::tag('li', array(), $code);
        }

        $codes = implode("\n", $codes);
        return CHtml::tag('ul', array(), $codes);
      },
    ),
  ),
)); 
```

# python - 我可以使用 selenium webdriver 读取浏览器 url 吗？

> ID：14166572
> 
> 赞同：8
> 
> 时间：2013-01-04T23:13:30.893
> 
> 标签：python, selenium, beautifulsoup, selenium-webdriver

我正在使用 python2.7 和`beautiful Soup4 and Selenium webdriver`. 现在在我的网络自动化脚本中，我将打开链接或 URL 并进入主页。现在我需要点击一些`anchor Labels`来浏览其他页面。我一直这样做到现在。现在当我要去一个新页面时，我需要`URL`从浏览器中获取新页面，因为我需要将它传递`Beautiful Soup4`给网页抓取。所以现在我关心的是如何获得这样的 URL 动态方式？

有的话请指教！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-04T23:19:27.110

你得到`current_url`驱动程序的属性：

```
from selenium import webdriver
browser = webdriver.Firefox()
browser.get('http://www.google.com')
print(browser.current_url) 
```

# java - 通过队列接口（如 Java 中的 JMS）模拟阻塞函数调用

> ID：14166575
> 
> 赞同：0
> 
> 时间：2013-01-04T23:14:09.787
> 
> 标签：java, design-patterns, jms, blocking, nonblocking

我有处理引擎，它只能通过队列接口对我可用（公开）。

我想将基于 Que 的接口抽象为一个简单的阻塞接口，可以由多个线程同时调用。

单个 JVM 进程每秒将调用此接口大约 500 次。

高层次的问题是：如何将基于 Que 的接口转换为 Java 中的线程安全阻塞函数调用。

笔记：

1.  我将请求放在 Request_Q
2.  请求是我生成唯一 id 的表单的 JSON 对象，有效负载是我要处理的消息：

    {id：1234567890，有效载荷：“foo”}

3.  引擎完成处理此请求后，它将响应放入队列 Response_Q

4.  响应消息与请求对象的形式相同，只是payload对应于处理后的消息，id与请求对象相同。例如，对所述请求对象的响应可能如下所示：

    {id：1234567890，有效载荷：“bar”}

5.  我弹出 Response_Q 的消息

我希望将这个基于队列的处理系统封装在以下形式的传统阻塞函数调用中：

```
public String process (String payload) {

   JSONObject request = new JSONObject();
   request.set("id", /* ... some way to generate a random key */ );
   request.set("payload", payload);

   // push the request onto Request_Q

   // Question
   // What is an elegant way to organize the code from here down?
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T01:16:55.217

您可以为此使用 Apache Camel，一些常见的企业集成适用于这种类型的用例。

一般来说，你需要做的任何事情总是适合一个或多个 EIP，而 Camel 就像脚手架一样，可以帮助你对那些定义明确且解决良好的问题进行编码。

最适合这里的可能是请求/回复

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T23:56:59.233

这是一种方法：

*   创建一个从 response_q 读取的后台线程
*   创建一个`Map<String, Queue>`响应线程可以访问的全局变量

**在阻塞函数中**

1.  向映射添加新条目，请求 id 作为键，新队列作为值，它是这个请求的私有队列
2.  写入 request_q
3.  在 private_q 中等待响应
4.  可用时，删除映射条目并返回从队列中读取的响应

**在后台线程中，在无限循环中**

1.  从全局 response_q 读取响应
2.  从响应中提取 id
3.  从全局映射中识别私有队列
4.  写入私有队列

需要一些同步。探索更好的私有队列数据结构。

**更新**

如`msandiford`评论所述，使用无锁`ConcurrentHashMap`和[`BlockingQueue`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/BlockingQueue.html).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-04T23:39:22.717

虽然我认为您最好弄清楚如何使您的代码成为非阻塞而不是阻塞队列，但这是一种方法：

在您的 process() 方法中，设置一个查看队列的循环，并且仅在找到对该方法调用中发送的消息的响应时才退出。这将非常低效，但我认为没有一种有效的方法可以做到这一点。

# ruby-on-rails-3 - 使用带有 Capybara 和 Rspec 的 Devise 测试 Rails 应用程序不会导致方法错误

> ID：14166578
> 
> 赞同：0
> 
> 时间：2013-01-04T23:14:32.277
> 
> 标签：ruby-on-rails-3, devise, capybara, rspec-rails

我刚刚开始对我使用 Devise 进行身份验证的 Rails 应用程序进行一些测试。我刚刚生成了 rspec 并且只添加了

```
RSpec.configure do |config|
  config.include Devise::TestHelpers, :type => :controller
end 
```

到我的 spec/support/devise.rb 文件。我还在我的 gemfile 中将 Capybara 添加到了测试组中，运行了 bundle 命令等。但是当我在测试中访问时，我得到了一个 no method 错误。这是我的 user_spec.rb 的示例：

```
require 'spec_helper'

describe "Club" do
  before(:each) do
    @club ||= FactoryGirl.create(:club)
    FactoryGirl.create(:membership)
    User.all.each{|x| x.delete}
  end
  describe "privacy" do
    it "shouldn't be shown any tournament if the user is private" do
      attributes = FactoryGirl.attributes_for(:user)
      user = User.create!({private: true}.merge(attributes))
      assert(user.private)
      visit "/user/#{user.id}/tournaments"

      page.should have_no_selector(".tournament-list")
    end
  end
end 
```

当我运行 rspec 时，会出现这样的错误：

```
Failures:

  1) Club privacy shouldn't be shown any tournament if the user is private
     Failure/Error: visit "/user/#{user.id}/tournaments"
     NoMethodError:
       undefined method `visit' for #<RSpec::Core::ExampleGroup::Nested_3::Nested_1:0x007ff0ea113108>
     # ./spec/user_spec.rb:14:in `block (3 levels) in <top (required)>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-22T04:39:05.217

对于水豚规格，我使用：

```
describe "Club", :type => :feature, :js => true do
  include Capybara::DSL

  it "..."
end 
```

而不是 User.all.each{|x| x.delete}，使用 DatabaseCleaner

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-29T14:01:15.350

您可以轻松地将 Capybara::DSL 添加到 RSpec 配置 spec_helper.rb

```
RSpec.configure do |config|
  .....
  .......
  config.include(Capybara::DSL)

end 
```

# api - OpenGraph API 用户对象有时会返回 404 的链接

> ID：14166582
> 
> 赞同：12
> 
> 时间：2013-01-04T23:14:46.993
> 
> 标签：api, facebook-graph-api, facebook-opengraph

在我的应用程序中，我允许用户通过 oauth 连接他们的 Facebook 帐户，以便通过我们的界面发布。我们支持页面帐户和仅管理页面的常规帐户。

我们还检查 opengraph API 调用的结果，以获取指向其个人资料或页面的有效 URL。我们使用的主要端点是[https://graph.facebook.com/me](https://graph.facebook.com/me)（带有 oauth 凭据）。对于某些仅页面帐户，返回的对象具有一个“链接”值，当输入到 Web 浏览器时，该值是 404。

我见过的不良 URL 分为两种不同的情况：

URL 可以是 'www.facebook.com/{page_id}' 的形式，在某些页面上是 404，但在其他页面上则不是。

URL 可以是 'www.facebook.com/profile.php?id={user_id}' 的形式，通常是 404。

我见过的唯一适用于所有帐户的 URL 格式是 www.facebook.com/profile.php?id={page_id}。在第一种情况下，我们检测到“链接”字段的格式不正确（使用 profile.php?id=...），并构造了一个具有正确结构的 URL，并且它可以工作。

我正在考虑添加的下一个启发式方法是查看 URL 的格式是否正确......但使用 {user_id} 作为 profile.php 的 id 参数，并使用 {page_id} 构造 URL。显然，这越来越荒谬了。

那么，有没有一种好方法可以知道一个帐户是否会返回一个无效的链接？这是 API 中的错误吗？给定开放图形 API 上的用户，获取指向其个人资料/页面的有效链接的最可靠方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T14:09:11.620

使用 'www.facebook.com/{page_id}' 或 'www.facebook.com/profile.php?id={user_id}' 将始终有效 - 它们都是相同的。您会看到 404 的唯一原因是该页面是否已取消发布/删除，或者用户是否已停用其帐户。

# java - 包装 span 的内容

> ID：14166590
> 
> 赞同：1
> 
> 时间：2013-01-04T23:15:19.210
> 
> 标签：java, jsoup

我有这个跨度：`<span style="font-weight:bold;">bold. </span>`以及对它（元素）的引用，称为跨度。

我想将我的 span 元素中的所有内容包装在一些新标签中，例如`<p>`标签：`<span style="font-weight:bold;"><p>bold. </p></span>`

我知道我可以调用`span.wrap("<p></p>")`，但这包含跨度而不是跨度内容。当我尝试`span.append("<p>")`在内容的开头创建新标签时，appendElement 也会发生同样的情况。

包装跨度/元素内容而不是整个元素的最佳方法是什么？

更新： Elements 也有 wrap 但调用 span.getAllElements() 然后 wrap 提供与 span.wrap() 相同的结果，并且 span.children() 在此示例中为 0。

更新 2：作为一种解决方法，我能够使用 span.html() 获取内容，将其存储为临时字符串，在该内容周围添加所需的标签，然后通过 span.html(newContent ); 如果没有更好的方法，我只会回答我自己的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T00:50:05.167

为了包装文本节点使用

```
span.childNode(0).wrap("<p>"); 
```

编辑：具有各种用例的示例：

```
String html = "<span style=\"font-weight:bold;\">bold.</span><span></span><span><a>text</a></span>";
Document parsedDoc = Jsoup.parse(html);
Elements selects = parsedDoc.select("span");

for (Element span : selects) {
    List<Node> childNodes = span.childNodes();
    if (childNodes.size() > 0 && span.childNode(0).childNodes().size() == 0) {
        span.childNode(0).wrap("<p>");
    }
} 
```

# javascript - 使用 grunt 自动化 npm 和 bower 安装

> ID：14166591
> 
> 赞同：63
> 
> 时间：2013-01-04T23:15:27.180
> 
> 标签：javascript, node.js, npm, bower, gruntjs

我有一个节点/角度项目，它使用 npm 进行后端依赖管理，使用 bower 进行前端依赖管理。我想使用 grunt 任务来执行这两个安装命令。我一直无法弄清楚该怎么做。

我尝试使用`exec`，但它实际上并没有安装任何东西。

```
module.exports = function(grunt) {

    grunt.registerTask('install', 'install the backend and frontend dependencies', function() {
        // adapted from http://www.dzone.com/snippets/execute-unix-command-nodejs
        var exec = require('child_process').exec,
            sys  = require('sys');

        function puts(error, stdout, stderr) { console.log(stdout); sys.puts(stdout) }

        // assuming this command is run from the root of the repo
        exec('bower install', {cwd: './frontend'}, puts);
    });

}; 
```

当我`cd`进入前端，打开`node`并从控制台运行此代码时，它工作正常。我在 grunt 任务中做错了什么？

（我也尝试使用 bower 和 npm API，但也无法实现。）

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2013-09-03T11:54:29.667

`npm install`要在安装服务器端库的同时安装客户端组件，您可以添加`package.json`

```
"dependencies": {
    ...
    "bower" : ""
},
"scripts": {
    ...
    "postinstall" : "bower install"
} 
```

我更喜欢区分安装和测试/构建

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-01-11T18:10:06.580

`.exec`您需要通过调用`this.async()`方法、获取回调并在 exec 完成时调用它来告诉 grunt 您正在使用异步方法 ( )。

这应该有效：

```
module.exports = function(grunt) {
    grunt.registerTask('install', 'install the backend and frontend dependencies', function() {
        var exec = require('child_process').exec;
        var cb = this.async();
        exec('bower install', {cwd: './frontend'}, function(err, stdout, stderr) {
            console.log(stdout);
            cb();
        });
    });
}; 
```

请参阅[为什么我的异步任务没有完成？](http://gruntjs.com/frequently-asked-questions#why-doesn-t-my-asynchronous-task-complete)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-07T04:09:55.503

仅供参考，这就是我现在的位置。

你也可以用另一种方式解决这个问题，即让 npm 处理 bower 的执行，最终让 grunt 处理 npm。请参阅[将 bower 与 heroku 一起使用](http://xseignard.github.com/2013/02/18/use-bower-with-heroku/)。

```
grunt.registerTask('install', 'install the backend and frontend dependencies', function() {
    var async = require('async');
    var exec = require('child_process').exec;
    var done = this.async();

    var runCmd = function(item, callback) {
        process.stdout.write('running "' + item + '"...\n');
        var cmd = exec(item);
        cmd.stdout.on('data', function (data) {
            grunt.log.writeln(data);
        });
        cmd.stderr.on('data', function (data) {
            grunt.log.errorlns(data);
        });
        cmd.on('exit', function (code) {
            if (code !== 0) throw new Error(item + ' failed');
            grunt.log.writeln('done\n');
            callback();
        });
    };

    async.series({
        npm: function(callback){
            runCmd('npm install', callback);
        },
        bower: function(callback){
            runCmd('bower install', callback);  
        }
    },
    function(err, results) {
        if (err) done(false);
        done();
    });
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-12T13:15:46.253

完成这项工作的 Grunt 任务（根据上面 Sindre 的解决方案）：

[https://github.com/ahutchings/grunt-install-dependencies](https://github.com/ahutchings/grunt-install-dependencies)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-27T10:04:27.900

执行 bower install 命令的 Grunt 任务： [https ://github.com/yatskevich/grunt-bower-task](https://github.com/yatskevich/grunt-bower-task)

另外，您可以使用 [https://github.com/stephenplusplus/grunt-bower-install](https://github.com/stephenplusplus/grunt-bower-install)

将您的依赖项自动注入 index.html 文件

# node.js - node.js 快速路由到 socket.io 中的新页面

> ID：14166592
> 
> 赞同：-1
> 
> 时间：2013-01-04T23:15:33.420
> 
> 标签：node.js, express, socket.io

我在页面上有一个按钮，当它被点击时，我希望页面调用一些 node.js 服务器代码。我通过socket.io连接了这个。我遇到的问题是我需要 socket.io 代码根据一些业务逻辑重定向我的网页。不确定通过 express（res.redirect？）实现此目的的最佳方法是什么，以及如何在 socket.io 调用中访问它。任何帮助，将不胜感激！

应用程序.js

```
var dashboard = require('./middleware/dashboard.js');
...
app.get("/dashboard", function (req, res) {
    dashboard.show(req, res);
});
...
var http = require('http');
var server = http.createServer(app);
var io = require('socket.io').listen(server);

io.set('log level',2); // sets socket io log level 0=error, 1=warn, 2=info, 3=debug
...
dashboard.wireUpSocketIO(io);
... 
```

仪表板.js

```
var savedResponse;

exports.show = function(req, res) {
    savedResponse = res;
    res.render("dashboard.jade"});
};

exports.wireUpSocketIO = function(io){
    io.sockets.on('connection', function (socket) {
        socket.on('dashboardOnButtonClick', function(msg) {

            <biz logic>

             savedResponse.render("someOtherPage.jade", {
                    locals: {
                        title: "someOtherPage",
                        filter: msg.filter
                    }
             });
        });
    });
} 
```

仪表板.jade

```
button#btnFilter(class='btn btn-info') Test Button

script(src="/socket.io/socket.io.js")
script .
  var socket = io.connect('http://localhost');
  var emitMessage = { blah: false, filter:"n/a"};

  $('#btnFilter').click(function(){
      emitMessage.blah = true;
      emitMessage.filter = "filterByBlah";
      socket.emit('dashboardOnButtonClick', emitMessage);
  }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T23:47:55.240

我认为从客户端更容易做到，即javascript：

1.  服务器端逻辑完成后，您将消息发送回客户端并将其更改为新消息`window.location`。
2.  服务器完成后，客户端可以向服务器发出请求，该请求将使用 HTTP 301/302 重定向进行响应。这样您就可以在该 Express 请求上调用 res.Redirect。

问候，

# entity-framework-5 - EF 5.0 Code First 退出创建数据库

> ID：14166596
> 
> 赞同：2
> 
> 时间：2013-01-04T23:16:08.123
> 
> 标签：entity-framework-5

通过设置和工作的自动迁移，我一切正常。我刚刚在我的域类中进行了一些外键更改，当我启动我的应用程序时，我得到了一个非法列“CreatedOn”异常。浏览我发现这个错误通常是由于从 ef 4 移动到 ef 5 并返回。我一直只使用 ef 5。我找不到任何错误原因，所以我决定回到基础。我关闭了迁移并将我的初始化程序设置为“DropAndCraeteAlways”。它删除了数据库，但没有创建新数据库。所以我进一步回到基础并完全删除了迁移并将初始化程序设置为“CreateIfNoneExists”。仍然没有创建数据库。我不知道还能尝试什么或如何调试。我唯一的例外 我得到的是当我尝试初始化数据库时，我得到了一个未找到的数据库，这很明显。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T15:30:31.770

如果实体框架无法弄清楚如何解决关系，它会变得有点脾气暴躁——你有更多关于错误的细节吗？请记住，您看到的最终错误可能是链中早期故障的结果。

您可以通过在包管理器控制台中运行 Update-Database 命令来查看更多信息。

可能值得一看[Fluent Relationship API](http://msdn.microsoft.com/en-us/data/hh134698.aspx)，它是为 4.1 编写的，但我相信它大致相同。

# facebook - 在遵循规则的 htaccess 重定向 url

> ID：14166597
> 
> 赞同：-1
> 
> 时间：2013-01-04T23:16:12.127
> 
> 标签：facebook, .htaccess, redirect

`enter code here`例如，我在apps.facebook.com/myappname/ 上开发了一个facebook 应用程序，它是myappname.mydomain.com 上的一个Web 应用程序主机。

在 facebook 应用程序中只是 url base 不同，第二部分 url 是相同的，例如：

myappname.mydomain.com/home apps.facebook.com/myappname/home

myappname.mydomain.com/product apps.facebook.com/myappname/product

我只想显示 facebook url，而不是真正的 url，因此我需要在 htaccess 中创建一个规则重定向。我的意思是一条规则，它只将基本 url 从 apps.facebook.com/myappname/ 更改为 myappname.mydomain.com/

有可能吗？TX，最好的问候

等待帮助我正在研究解决方案，也许这是其中之一。在 htaccess 我添加了这段代码

```
RewriteEngine On
RewriteBase /
RewriteCond %{HTTP_HOST} !apps.facebook.com/myappname$ [NC]
RewriteRule ^(.*)$ https://apps.facebook.com/myappname/$1 [L,R=301] 
```

但正如您所知，facebook 应用程序就像一个 iframe，所以以这种方式启动一个包含的循环，我的应用程序不起作用。我需要在这条规则中添加条件，“当 url 不在 facebook iframe 中时”有想法吗？发送

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:46:46.813

两个工作日后，我明白了，tx 为您的回复，这是我的 javascript 解决方案

```
 <script>
if (parent.location.href == self.location.href) {
    window.location.href = 'https://apps.facebook.com/myappname' + window.location.pathname;
    //alert(window.location.pathname);
}
</script> 
```

PS。TX 到 MAX ！！！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T11:42:33.907

> RewriteCond %{HTTP_HOST} !apps.facebook.com/myappname$ [NC]

这始终是正确的，因为到达*您的*服务器的请求永远不会将 HTTP_HOST 设置为 apps.facebook.com。（并且 URL 的路径部分不是域名的一部分……）

在这种情况下，您可以使用 mod_rewrite 做的唯一一件事就是检查 HTTP 引荐来源网址，我猜——如果它不是 apps.facebook.com，那么您的应用很可能在 FB iframe 之外被调用。（但是referer的不可靠程度，现在应该是常识了。）

* * *

最好的办法是使用 JavaScript 检查您的应用是在 iframe 中调用还是单独调用（如果它在 iframe 中，则假设它在 apps.facebook.com 上。）

```
if(top == window) {
  // not in iframe, redirect:
  window.location.href = "{your app’s URL on facebook}";
} 
```

仅当您的应用程序直接在顶部浏览器窗口中调用时才会触发 - 如果它是框架的，无论是否在 facebook.com 上，此代码都不会执行任何操作。

您可以在您的服务器配置中添加一个`X-Frame-Options`标头，这样您的应用程序将只被允许显示在 apps.facebook.com 上的 (i) 框架中，而不是其他任何地方。如果你将它与 JS 方法结合起来，你可以很确定如果你的应用是“框架的”，它是在 apps.facebook.com 上而不是其他地方。

# php - 如何添加额外的空格或虚线符号来选择选项？

> ID：14166605
> 
> 赞同：1
> 
> 时间：2013-01-04T23:17:25.620
> 
> 标签：php, hierarchical

我想为我的类别制作一个选择树。这是无序列表。

```
function generate_menu($parent, $menu_array = null)
{
    $has_childs = false;
    foreach ($menu_array as $key => $value) {
        if ($value['parent'] == $parent) {
            if ($has_childs === false) {
                $has_childs = true;
                echo "<ul>\n";
            }
            echo '<li><a href="#">'.$value['name'].'</a>';
            generate_menu($key, $menu_array);
            echo "</li>\n";
        }
    }
    if ($has_childs === true)
        echo "</ul>\n";
} 
```

这是无序列表的 HTML 输出。

```
<ul>
  <li>
    Ford
    <ul>
      <li>
        Falcon
        <ul>
          <li>
            Futura
            <ul>
              <li>FPV</li>
              <li>GT</li>
              <li>F6</li>
              <li>GS</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>F150</li>
  <li>Festiva</li>
</ul> 
```

**问题**：如何使当前功能`select option`和结果将是这样的。

```
<select name="categories">
    <option value="Ford">Ford</option>
    <option value="Falcon">-Falcon</option>
    <option value="Futura">--Futura</option>
    <option value="FPV">--FPV</option>
    <option value="GT">---GT</option>
    <option value="F6">---F6</option>
    <option value="GS">---GS</option>
    <option value="F150">-F150</option>
    <option value="Festiva">-Festiva</option>
</select> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-04T23:24:19.923

我会使用你已经拥有的文本列表，将它变成`<select>`元素很容易：

```
$list = <<<LIST
Ford
| Falcon
| | Futura
| | FPV
| | | GT
| | | F6
| | | GS
| F150
| Festiva
LIST;

echo '<select name="categories">', "\n";
foreach (explode("\n", $list) as $entry) {
    $label = strtr($entry, ['| ' => '-']);
    $value = trim($entry, ' |');
    printf("  <option value=\"%s\">%s</option>\n", htmlspecialchars($value), htmlspecialchars($label));
};
echo "</select>\n"; 
```

输出：

```
<select name="categories">
  <option value="Ford">Ford</option>
  <option value="Falcon">-Falcon</option>
  <option value="Futura">--Futura</option>
  <option value="FPV">--FPV</option>
  <option value="GT">---GT</option>
  <option value="F6">---F6</option>
  <option value="GS">---GS</option>
  <option value="F150">-F150</option>
  <option value="Festiva">-Festiva</option>
</select> 
```

否则，如果您无法生成此文本列表而只能生成`ul/li`列表，则以相同的方式处理该 HTML。

更新并提供 HTML 后，`ul/li`列表字符串 ( `$ul`) (PHP 5.4) 的作用如下：

```
echo '<select name="categories">', "\n";
foreach ((new SimpleXMLelement($ul))->xpath('//li') as $li) {
    $label = htmlspecialchars(trim($li->xpath('text()[1]')[0]));
    $level = count($li->xpath('ancestor::li'));
    printf(
        "  <option value=\"%s\">%s%s</option>\n",
        $label, str_repeat('-', $level), $label
    );
}
echo "</select>\n"; 
```

我的早期回答中更详细地概述了它的工作原理：[如何从 PHP 中的 HTML 列表中提取结构化文本？](https://stackoverflow.com/a/14086249/367456). 那个`DomDocument`不像`SimpleXMLElement`这里，但是，或多或少的主要部分是两者都提供的xpath。

这一切都很好，花花公子。但是，您一定有些错过了实际提供示例数组 - 我刚刚假设：

```
array (
  1 => 
  array (
    'parent' => 0,
    'name' => 'Ford',
  ),
  2 => 
  array (
    'parent' => 1,
    'name' => 'Falcon',
  ),
  3 => 
  array (
    'parent' => 2,
    'name' => 'Futura',
  ),
  4 => 
  array (
    'parent' => 3,
    'name' => 'FPV',
  ),
  5 => 
  array (
    'parent' => 3,
    'name' => 'GT',
  ),
  6 => 
  array (
    'parent' => 3,
    'name' => 'F6',
  ),
  7 => 
  array (
    'parent' => 3,
    'name' => 'GS',
  ),
  8 => 
  array (
    'parent' => 0,
    'name' => 'F150',
  ),
  9 => 
  array (
    'parent' => 0,
    'name' => 'Festiva',
  ),
) 
```

为您指出一些与您已经为`ul/li`列表所做的一致的方法，一个适用于您的数组的递归函数：

```
function generate_dropdown($menu_array, $parent = 0, $level = -1) {
    ++$level || print('<select name="categories">'. "\n");
    foreach ($menu_array as $key => $value) {
        if ($value['parent'] != $parent) continue;
        $label = htmlspecialchars($value['name']);
        printf("  <option value=\"%s\">%s%s</option>\n", $label, str_repeat('-', $level), $label);
        generate_dropdown($menu_array, $key, $level);
    }
    $level-- || print('</select>');
}

generate_dropdown($array); 
```

输出：

```
<select name="categories">
  <option value="Ford">Ford</option>
  <option value="Falcon">-Falcon</option>
  <option value="Futura">--Futura</option>
  <option value="FPV">---FPV</option>
  <option value="GT">---GT</option>
  <option value="F6">---F6</option>
  <option value="GS">---GS</option>
  <option value="F150">F150</option>
  <option value="Festiva">Festiva</option>
</select> 
```

# mysql - 迁移的 Joomla 站点显示表不存在

> ID：14166607
> 
> 赞同：0
> 
> 时间：2013-01-04T23:17:30.597
> 
> 标签：mysql, joomla

我在我的机器上本地创建了一个 joomla 2.5 站点，我已经迁移到一个运行 nginx、php 和 mysql 的 vps。这是我按顺序做的：

```
 1\. Uploaded all the joomla files in the public_html
 2\. Changed all the files permission to 644 and all the folders to 755
 3\. Imported the database.sql to mysql using these commands: 

--> mysql> create database databasename;    
--> mysql> GRANT ALL PRIVILEGES ON
databasename.* TO username@localhost IDENTIFIED BY 'password';   
--> mysql> flush privileges;    
--> mysql> exit    
--> user@vps:~$ mysql -p -u username database_name < file.sql 
```

我已经可以在数据库中看到我的所有表，并更改了我的 joomla 上所有需要的信息，`configuration.php`但是当我打开我的网站时，我收到了这个错误：

```
Table 'databasename.s1t3j0s_session' doesn't exist SQL=INSERT INTO `s1t3j0s_session` (`session_id`, `client_id`, `time`) VALUES ('rh249ehb2tbsqkdff34v177d76', 0, '1357339991') 
```

我哪里弄错了？

我已将 wordpress 站点迁移到同一台服务器，没有出现错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-20T09:37:39.807

通过检查实际使用的 db 前缀，确保Joomla 目录下的`$dbprefix`in值具有正确的值（*打开 phpMyAdmin 并选择 Joomla 数据库进行检查*）。`configuration.php`

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T13:11:41.663

几个星期以来我一直遇到麻烦。我需要的是我系统上的备份副本。但是，当我将数据库从远程服务器上传到本地主机时，我收到了与会话表不存在相关的错误消息（与您遇到的错误相同）。

我尝试了所有与删除和重新创建表相关的技巧，但这不起作用。

唯一能 100% 工作的解决方案——我今天终于发现，是重新安装 Joomla 2.5（我使用全新安装），然后执行以下操作：

不要从包含正确内容的站点上传数据库，而是通过 SQL 文件本身（即在遇到问题之前您将导出上传的文件），并直接将每个插入语句手动处理到 SQL 控制台（我'正在使用 PHPMyadmin）。换句话说，不要像往常一样尝试导入整个文件。这样做只会导致错误。

出于某种原因，Joomla 2.5 存在一个问题，即已经填充了数据的表被转储文件替换或替换，有时是重复的数据。因此需要全新安装....

在单独处理每个安装语句之前（这可能需要一段时间 - 我花了大约一个半小时），检查每个 Joomla 表并确保其中没有填充任何数据（因此当你处理安装语句，它们不会替换现有数据 - 因为您将从填充的表中删除所有数据）。

只要您确保在迁移之前没有向表中添加任何 INSERTED 数据，这将解决您的问题。

总结一下： 1/ 安装全新的 J2.5。2/ 从每个 joomla 表中删除所有填充的表数据。3/ 从包含正确数据的导出 mysql 文件中复制并粘贴每个插入语句。单独处理每条语句（这是可选的，但强烈建议：这样做可以让您在发生时应对和查明任何单个错误 - 无需查看整个 mysql 文件）

...转到您的网站：宾果游戏 - 它应该可以工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-25T08:34:43.597

我遇到了这个问题，在我的情况下，我通过 cpanel 导入了数据库，后来收到了这个错误消息。后来我发现通过cpanel导入数据库并没有导入表，只是数据库名称。所以我去了phpmyadmin并再次在那里导入数据库，并解决了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-05T05:13:36.370

只需截断会话表中的数据并再次执行该过程。您无需担心截断，因为没有有价值的数据。会话表有时会弄乱一些东西。

在 Unix 上，表名区分大小写。在 Windows 上，它们不是。有趣，不是吗？有点像他们各自的文件系统。你认为这是巧合吗？

警告：它可能取决于表类型；MyISAM。

无论如何，字段名称都不区分大小写。*

# ssl - 带有 https 的 HTTP 客户端

> ID：14166609
> 
> 赞同：0
> 
> 时间：2013-01-04T23:17:46.107
> 
> 标签：ssl, https, httpclient, apache-httpclient-4.x

使用 HTTP 组件 HTTPClient 4 项目使用 SSL 处理 HTTP GET 方法的最佳方法是什么？参数化认证信息的最佳方法是什么？属性文件？将方法重新加载到守护程序服务？

```
 HttpClient httpClient = new DefaultHttpClient();
    String url = "https://xxx.190.2.45/index.jsp";
    HttpGet get = new HttpGet(url);
    try {
                    //TODO
                    HTTPHelper.addSSLSupport(httpClient);
        HttpResponse response = httpClient.execute(get);

        BasicResponseHandler responseHandler = new BasicResponseHandler();
        String responseString = responseHandler.handleResponse(response);

    } catch (ClientProtocolException e) {
        throw new RuntimeException(e);
    } catch (IOException e) {
        throw new RuntimeException(e);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:58:04.663

您需要启用 SSL 支持，有关更多信息，请参阅[教程](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/connmgmt.html#d5e512)

我的印象是您正在为服务器使用自签名证书。您可能应该做的是查看获取 openssl，为自己生成 CA 和服务器证书。将 CA 证书（不是私钥）放入“信任库”并配置套接字工厂。

如果您需要有关如何执行此操作的更多详细信息，请对此发表评论，我会补充更多内容。我在简单的本地项目上取得了巨大的成功！

# php - Drupal db_select 和一个 MYSQL 函数作为条件

> ID：14166615
> 
> 赞同：3
> 
> 时间：2013-01-04T23:18:00.920
> 
> 标签：php, mysql, drupal, drupal-7

好的，让我解释一下我的情况。我正在尝试这样进行mysql查询：

```
Select * FROM dates n WHERE (MONTH(FROM_UNIXTIME(n.date)) = '12'); 
```

但我需要查询位于 db_select 函数中。

如果我添加：

```
$this->query->condition('MONTH(FROM_UNIXTIME(n.date))', 12, '='); 
```

Drupal 删除括号并将函数封装在引号中。

我将如何添加这样的条件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-04T23:29:31.817

好的，我想出了我自己的答案！非常愚蠢，但在花了一个多小时搜索之后，我敢打赌我可以在路上帮助别人。

我变了

```
$this->query->condition('MONTH(FROM_UNIXTIME(n.date))', 12, '='); 
```

至

```
$this->query->where('MONTH(FROM_UNIXTIME(n.date)) = :val', array('val'=>12)); 
```

奇迹般有效！！！

# php - 需要一种方法来检测页面回发

> ID：14166616
> 
> 赞同：-1
> 
> 时间：2013-01-04T23:18:08.903
> 
> 标签：php

我是一个php初学者。我希望每次运行我的项目时都创建一个唯一的文件，为此我使用了 uniqid()。只有每次重新加载我的页面以显示从服务器收到的新数据时，它才会创建一个具有统一名称的新文件。但我想保留创建的第一个文件，直到应用程序关闭。

这是我的代码：

```
$uniq = uniqid();
if(!isset($_COOKIE['firsttime'])){
  setcookie('firsttime', 'no');
  $num = $uniq;
  $myfile = 'file/'.$num.'.txt';
  if(file_exists($myfile) == FALSE){
    $fo = fopen($myfile, 'w')or die();
    $code = '<form action = "" method = "post">';
    fwrite($fo, $code, strlen($code)) ;
    fclose($fo);
  }else{
    unlink($myfile);
    $file = new File();
  } 
} 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:22:57.940

看来，如果我没看错的话，您应该将 cookie 指定为唯一名称，然后使用它而不是每次都生成一个新名称。现在，您说如果它不是回发，您希望它运行。我假设您的意思是发布表单，因此您只运行一次，然后如果用户在页面上发布表单，那么您不会创建新的 ID，而是使用当前正在使用的 ID。 .

```
if(!isset($_POST['some_form_element']))
{
    if(isset($_COOKIE['firsttime'])){
      $myfile = 'file/'.$_COOKIE['firsttime'].'.txt';

    }
    else
    {
        $uniq = uniqid();
        setcookie('firsttime', $uniq);
        $myfile = 'file/'.$uniq.'.txt';
    }

    if(file_exists($myfile) == FALSE){
        $fo = fopen($myfile, 'w')or die();
        $code = '<form action = "" method = "post">';
        fwrite($fo, $code, strlen($code)) ;
        fclose($fo);
    }else{
        unlink($myfile);
        $file = new File();
    } 
} 
```

其中“some_form_element”是表单中的任何元素，或隐藏字段等。最好使用特定的东西，而不仅仅是！$_POST。

如果我对您的需求有误，请告诉我。我可以更新。

# android - 在 OnClickListener Android 上刷新 SurfaceView-->Canvas

> ID：14166620
> 
> 赞同：1
> 
> 时间：2013-01-04T23:18:37.337
> 
> 标签：android, canvas, surfaceview

我希望每次按下屏幕上的矩形按钮之一来改变位置。或者整个 SurfaceView 刷新。

该应用程序似乎正在运行，但矩形不会随计数器改变位置。

非常感谢。

野兔是xml代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >
<SurfaceView
    android:id="@+id/surface"
    android:layout_width="match_parent"
    android:layout_height="match_parent" />
<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@string/hello_world"
    tools:context=".MainActivity" />
<Button
    android:id="@+id/l"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="16dp"
    android:text="L" />
<Button
    android:id="@+id/r"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/textView1"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="19dp"
    android:text="R" />
</RelativeLayout> 
```

这是Java：

```
package com.example.rectangle;

import android.app.Activity;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.os.Bundle;
import android.view.SurfaceHolder;
import android.view.SurfaceHolder.Callback;
import android.view.SurfaceView;
import android.view.View;
import android.view.Window;
import android.view.WindowManager;
import android.widget.Button;
import android.widget.TextView;

public class MainActivity extends Activity {
DrawView drawView;
Paint paint = new Paint();
int w, h, edge, axis_w;
int counter;
Button add, sub;
TextView display;

@Override
public void onCreate(Bundle savedInstanceState) {
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
            WindowManager.LayoutParams.FLAG_FULLSCREEN);
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    counter = 0;
    add = (Button) findViewById(R.id.r);
    sub = (Button) findViewById(R.id.l);
    display = (TextView) findViewById(R.id.textView1);

    add.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            counter += 10;
            display.setText("Total is" + counter);

        }
    });

    sub.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            counter -= 10;
            display.setText("Total is" + counter);
        }
    });

    SurfaceView surface = (SurfaceView) findViewById(R.id.surface);

    surface.getHolder().addCallback(new Callback() {

        public void surfaceCreated(SurfaceHolder holder) {

            Canvas canvas = holder.lockCanvas();

            w = canvas.getWidth();
            h = canvas.getHeight();
            edge = 5;
            axis_w = 3;
            // canvas.drawRect(left, top, right, bottom, paint)
            // Background
            paint.setColor(Color.rgb(255, 255, 255));
            canvas.drawRect(0, 0, w, h, paint);
            // Canvas Background Color
            paint.setColor(Color.rgb(0, 206, 209));
            // Borders
            canvas.drawRect(0, 0, w, edge, paint);
            canvas.drawRect(0, h - edge, w, h, paint);
            canvas.drawRect(0, 0, edge, h, paint);
            canvas.drawRect(w - edge, 0, w, h, paint);
            // Axis
            canvas.drawRect(((w - axis_w) / 2) + counter, 0,
                    ((w + axis_w) / 2) + counter, h, paint);
            canvas.drawRect(0, (h - axis_w) / 2, w, (h + axis_w) / 2, paint);

            holder.unlockCanvasAndPost(canvas);
        }

        public void surfaceDestroyed(SurfaceHolder holder) {
        }

        public void surfaceChanged(SurfaceHolder holder, int format,
                int width, int height) {
        }
    });
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T12:11:42.250

好的。尝试另一种解决方案。尝试制作自己的 View 类，您将在其中绘制矩形。我为你准备了一些代码。根据您的需要定制它。

简单的 XML

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:id="@+id/mainL"
    >
<Button
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="Hello World, MainActivity"
    android:id="@+id/button"
    />
</LinearLayout> 
```

和java代码

```
public class MainActivity extends Activity
{
    MyRectg myRectg;
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        myRectg = new MyRectg(this);
        ((LinearLayout)findViewById(R.id.mainL)).addView(myRectg);
        ((Button)findViewById(R.id.button)).setOnClickListener(new View.OnClickListener() {

        public void onClick(View arg0)
        {
            myRectg.invalidate();
        }
    });
}

public class MyRectg extends View
{
    public MyRectg(Context c)
    {
        super(c);
    }

    @Override
    public void onDraw(Canvas c)
    {
        //this simulate new positions calculating
        Random rnd = new Random();
        Paint p = new Paint();
        p.setColor(Color.GREEN);
        c.drawRect(rnd.nextFloat()*100, rnd.nextFloat()*500, rnd.nextFloat()*300, rnd.nextFloat()*500, p);
    }
} 
```

现在，当您单击按钮时，画布会随机移动。这是你想要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:45:03.043

尝试在 SurfaceView 上调用 Invalidate 方法以在每次位置更改后对其进行刷新。

编辑：

并将位置计算从surfaceCreated 移动到surfaceChanged 方法。

# php - 根据 if/else 语句设置正文的背景颜色

> ID：14166621
> 
> 赞同：0
> 
> 时间：2013-01-04T23:18:39.273
> 
> 标签：php, css

我不知道这是否可能，但我想知道是否可以根据 if/else 语句设置页面的背景颜色？

我想要的是，如果满足 if 语句，那么我希望主体的背景颜色为白色，如果在包含 div 的地方满足 else 语句，那么我希望主体的背景颜色为灰色。

这可以做到吗？

```
 <?php

if (page()){

//all the code in the page

}else{
?>

<div class="boxed">

</div>

<?php   

}

?> 
```

更新：

```
<?php

        if (page()){
?>

    <body class="bodypage <?php echo page()? "color1":"color2" ?>" >

    </body>

<?php

    }else{

    <div class="boxed">
    <a href="<?php echo $pages[$currentPages+1] ?>">Continue with Current Assessment</a>
    </div>

    }

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T23:22:39.723

是的，可以。您如何使用具有所需背景颜色的预定义类：

```
.color1 {
   background-color:red;
}
.color2 {
   background-color:yellow;
}

<body class="boxed <?php echo page()? "color1":"color2" ?>" >

</body> 
```

### 更新：

```
<body class="bodypage <?php echo page()? "color1":"color2" ?>" >
<?php if (page()){?>
... all the page code
<?php else {?>
<div class="boxed">
   <a href="<?php echo $pages[$currentPages+1] ?>">Continue with Current Assessment</a>
</div>
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:27:45.500

尽量减少 php 对您的设计的影响。（CSS 用于设计，html 用于语义，php 用于结构，javascript 用于交互）

为此，我建议向浏览器发送一个包含值的隐藏输入：

```
if(statement) {
  $color = '#ffffff';
} else {
  $color = '#ff0000';
}

echo '<input id="pageColor" type="hidden" value="'.$color.'" />'; 
```

现在使用（例如）jquery 执行以下操作：

```
$(document).ready(function() {
  //change bg color based on input value
  $('body').css('background-color', $('#pageColor').val());
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T23:31:13.063

是的，你可以这样做。

最优雅的方式之一：

PHP部分：

```
<?php
$style = 'background:'; # property
$given = page() ? 'red;' : 'black;'; # Ternary operator
$style .= $given; # Concatenate two strings
?> 
```

HTML部分：

```
<div class="boxed" style='<?php echo $style; ?>'></div> 
```

您还可以使用预定义的各种 CSS 属性创建特殊的 CSS 类：

PHP部分：

```
<?php
$class = page() ? 'first' : 'second'; # CSS classes defined in your stylesheet.
?> 
```

HTML部分：

```
<div class="boxed <?php echo $class;?>"></div> 
```

给你。这只是一个快速演示，您可以将其替换为您的参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T23:22:38.923

有无数种方法可以做到这一点。

PHP：

```
$bodyClass = $condition ? 'foo' : 'bar';
...
echo <<< END_HTML
    <body class="$bodyClass">
       <!-- stuff here -->
    </body>
END_HTML; 
```

CSS：

```
body.foo { background-color:#fff; }
body.bar { background-color:#888; } 
```

..是一种方法。

干杯

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T23:22:50.243

尝试这个

```
<body <?php if(true) {echo('style="background:red"'); } else { echo('style="background:white"'); } ?> >

</body> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-04T23:25:29.020

您可以使用 javascript 和 jQuery 这样做：

```
<script>
$(document).ready(function(condition){
  if (cond) {
    $(body).css("background-color","red");
  } else {
    $(body).css("background-color","blue");
  }
});
</script> 
```

或者在 php 中，您可以只回显该代码，并进行一些更改。

# java - Java 显示消息问题

> ID：14166622
> 
> 赞同：0
> 
> 时间：2013-01-04T23:18:41.553
> 
> 标签：java, swing, user-interface, jframe, jbutton

我有一个创建这样的 JFrame 的 java 程序：

```
 javax.swing.SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            gui.setFrame(new gui(), 1000, 300);
        }
    }); 
```

我还有一个实现 setFrame 的类（gui.java）：

```
 public static void setFrame(final JFrame frame, final int width, final int height) {
 SwingUtilities.invokeLater(new Runnable() {
 public void run() {
   f1=frame;
 frame.setTitle("Testing");
 frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
 frame.setSize(width, height);
 frame.setVisible(true);   
}
});
} 
```

如果用户尝试单击提交（我创建的一个按钮）并且 JFrame 中的字段未填写，则会引发错误。错误消息的代码是：

```
 submit.addMouseListener(new MouseListener(){

@Override
public void mouseClicked(MouseEvent e) {}
@Override
public void mouseEntered(MouseEvent e) {}

@Override
public void mouseExited(MouseEvent e) {}

@Override
public void mousePressed(MouseEvent e) {}

@Override
public void mouseReleased(MouseEvent e) {
    //check to make sure all values filled in
          if(chooser.getSelectedFile().toString()!=null&&saveChooser.getSelectedFile().toString()!=null)
        parseFile.readFile(chooser.getSelectedFile(),saveChooser.getSelectedFile(),startSpanText.getText(),(String)col2.getSelectedItem(),(String)col3.getSelectedItem(),(String)col4.getSelectedItem(),(String)col5.getSelectedItem(),(String)col6.getSelectedItem());     
    else
        JOptionPane.showMessageDialog(f1,"Bad");
} 
```

});

//注意：f1是我最初收到的帧的静态版本

我得到的错误是：

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
at gui$3.mouseReleased(gui.java:133)
at java.awt.AWTEventMulticaster.mouseReleased(Unknown Source)
at java.awt.Component.processMouseEvent(Unknown Source)
at javax.swing.JComponent.processMouseEvent(Unknown Source)
at java.awt.Component.processEvent(Unknown Source)
at java.awt.Container.processEvent(Unknown Source)
at java.awt.Component.dispatchEventImpl(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
at java.awt.Container.dispatchEventImpl(Unknown Source)
at java.awt.Window.dispatchEventImpl(Unknown Source)
at java.awt.Component.dispatchEvent(Unknown Source)
at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
at java.awt.EventQueue.access$000(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.awt.EventQueue$3.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue$4.run(Unknown Source)
at java.awt.EventQueue$4.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
at java.awt.EventQueue.dispatchEvent(Unknown Source)
at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
at java.awt.EventDispatchThread.run(Unknown Source) 
```

我做错什么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T23:37:05.713

其中一个变量为空。它可能是：

*   选择器
*   选择器.getSelectedFile()
*   保存选择器
*   saveChooser.getSelectedFile()
*   解析文件
*   开始跨度文本
*   col2 到 col6

使用堆栈跟踪中的行号和代码中的一个或多个调试器来了解是哪一个。我的猜测是选定的文件之一，因为调用没有意义

```
chooser.getSelectedFile().toString() != null 
```

要么没有选定的文件，它抛出一个 NPE，因为`getSelectedFile()`返回 null，或者有一个，它`toString()`永远不会为 null。

此外，您不应该在按下按钮时使用鼠标侦听器来执行某些操作。这就是 ActionListener 的用途。它会更简单，并且当用户用键盘按下按钮时也可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T23:36:00.927

您的异常消息应该指向您的答案。您在`mouseReleased`方法中使用的项目之一为空：

```
@Override
public void mouseReleased(MouseEvent e) {
  //check to make sure all values filled in
  if(chooser.getSelectedFile().toString()!=null && 
      saveChooser.getSelectedFile().toString()!=null)
    parseFile.readFile(chooser.getSelectedFile(), saveChooser.getSelectedFile(),
        startSpanText.getText(), (String)col2.getSelectedItem(), 
        (String)col3.getSelectedItem(), (String)col4.getSelectedItem(),
        (String)col5.getSelectedItem(), (String)col6.getSelectedItem());     
  else
    JOptionPane.showMessageDialog(f1,"Bad");
} 
```

使用调试器检查设置了哪些变量。使用异常消息中的行号来帮助您。

# asp.net - Visual Studio 中的用户输入查询参数

> ID：14166624
> 
> 赞同：0
> 
> 时间：2013-01-04T23:18:41.090
> 
> 标签：asp.net, database, visual-studio-2010, controlparameter

我是 Visual Studio 和 ASP.NET 的新手。

我正在为我在大学的数据库课程创建这个项目，我想使用 Visual Studio 使其基于 Web。所以我已经创建了我的站点，导入了数据库等，现在我想创建一个带有用户输入参数的查询。使用查询生成器，我创建了以下 SQL 语句：

```
SELECT [Column1], [Column2], Column3 
FROM [DataBaseTable]
WHERE ([Column1] = ?) 
```

查询构建器的下一步是我需要定义参数源的地方。我发现我需要一个控制源，使用 DropDownList。我已经创建了列表项并通过控制选项将列表分配给参数。

所以，现在当我启动我的网站时，查询正在工作，从第一个列表项中获取值。问题是我想通过选择不同的列表项来动态更改查询值。我需要做什么才能做到这一点？

编辑：这是代码：

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" DataSourceID="AccessDataSource1" Height="269px" Width="923px">
    <Columns>
        <asp:BoundField DataField="Column1" HeaderText="Column1" SortExpression="Column1" />
        <asp:BoundField DataField="Column2" HeaderText="Column2" SortExpression="Column2" />
        <asp:BoundField DataField="Column3" HeaderText="Column3" SortExpression="Column3" />
    </Columns>
</asp:GridView>
<asp:AccessDataSource ID="AccessDataSource1" runat="server" DataFile="~/Road.accdb" SelectCommand="SELECT [Column1], [Column2], [Column3] FROM [Второкласни пътища] WHERE ([Column1] = ?)">
    <SelectParameters>
        <asp:ControlParameter ControlID="DropDownList1" DefaultValue="" Name="?" PropertyName="SelectedValue" />
    </SelectParameters>
</asp:AccessDataSource>
<asp:DropDownList ID="DropDownList1" runat="server">
    <asp:ListItem>1</asp:ListItem>
    <asp:ListItem>2</asp:ListItem>
    <asp:ListItem>3</asp:ListItem>
</asp:DropDownList> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T02:38:16.927

根据您的代码，我认为您可能只需要进行一点小改动。将“AutoPostBack="true" 添加到您的 DDL。我还会给您的 ListItems 明确的值，以便更清楚。这样您可以将 ListItem 文本设置为有用的东西（无论数字应该在您的数据库中表示什么）。

```
<asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="true">
    <asp:ListItem Value="1">1</asp:ListItem>
    <asp:ListItem Value="2">2</asp:ListItem>
    <asp:ListItem Value="3">3</asp:ListItem>
</asp:DropDownList> 
```

# css - 在 IE 8 中打印多个副本时触发响应式媒体查询

> ID：14166632
> 
> 赞同：0
> 
> 时间：2013-01-04T23:19:30.457
> 
> 标签：css, printing, responsive-design, media-queries

因此，在 IE 8 中的桌面版网站上，我将按两次打印按钮来打印网页的两份副本。但是，第二个副本（以及随后的每个副本）正在打印，就好像在响应版本上一样。我已经尝试过@print body 100% @screen body 100%，但除了注释掉我的 css 的 @media only screen 和 (max-width:30em) 部分之外，似乎没有什么可以解决它。有想法该怎么解决这个吗？

# java - 是否可以通过反射提供变量名称来使用变量？

> ID：14166633
> 
> 赞同：-1
> 
> 时间：2013-01-04T23:19:38.983
> 
> 标签：java, android

我正在尝试访问在运行时在 R.java 类中生成的一些字符串资源。

R.java：

```
 public static final class string {
   public static final int app_name=0x7f040000;
    public static final int eightOvereight=0x7f040030;
    public static final int eightOvernine=0x7f040031;
    public static final int fiveOvereight=0x7f040027;
    public static final int fiveOverfive=0x7f040024;
    public static final int fiveOvernine=0x7f040028;
    public static final int fiveOverseven=0x7f040026;
    public static final int fiveOversix=0x7f040025;
    public static final int fourOvereight=0x7f040022;
    public static final int fourOverfive=0x7f04001f;
    { 
```

在运行时我有：

```
 String current = getStringId(); // assume current = "eightOvereight" after this line

     //now I would like to use R.string.eightOvereight. I don't want to use a switch statement. 
```

我可以通过反思来实现这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-04T23:34:09.320

你可以使用反射，但是......不要使用反射。它应该只在非常非常罕见的情况下使用。这不是其中之一。

Android 提供了一种在运行时选择可变资源的机制。

```
String current = getStringId();

Resources res = context.getResources(); // Must provide an Activity or Context object here
int resourceId = res.getIdentifier(current, "string", context.getPackageName());
// Do whatever with resourceId 
```

您可能需要在 上查找[文档`getIdentifier()`](http://developer.android.com/reference/android/content/res/Resources.html#getIdentifier%28java.lang.String,%20java.lang.String,%20java.lang.String%29)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T23:26:19.193

如果应用程序并不真正需要它，那么使用反射实际上并不是一个好主意。您可以在运行时根据条件（屏幕大小、API 版本、语言环境等）[使用资源文件](http://developer.android.com/guide/topics/resources/providing-resources.html)来获取不同的资源，方法是在具有适当名称的不同文件夹中定义资源。

如果可能，尽量避免反思。您还分配`getStringId()`了应该是`int`字符串变量的值。

```
String current = getStringId(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-04T23:33:50.370

是的，有可能。但是为此使用反射是混乱、复杂、低效且可能脆弱的。

最好使用`HashMap`;进行查找。例如，假设您需要这些变量作为静态变量存在，然后添加：

```
 private static Map<String, Integer> MAP = new Map<String, Integer> {{
      put("eightOvereight", eightOvereight);
      put("eightOvernine", eightOvernine);
      ....
  } 
```

然后使用`MAP.get(str)`.

* * *

注意 - 这是一个通用的 Java 解决方案。@Eric 的回答提供了更好的 Android 专用解决方案。

# visual-studio - 将 TFSService 构建发布到 Azure 失败并出现 DirectoryNotFoundException

> ID：14166634
> 
> 赞同：2
> 
> 时间：2013-01-04T23:19:43.030
> 
> 标签：visual-studio, azure, tfsbuild, azure-web-app-service, azure-devops

我将我的 TFSService 帐户连接到我的 Azure 帐户，并尝试将 TFSService 构建的结果发布到我的 Azure 帐户。很确定我的构建定义设置正确 - 一切都编译得很好，这很好，但每次我尝试部署时，我都会收到以下错误：

```
Exception Message: Could not find a part of the path 'C:\a\bin\_PublishedWebsites'. (type DirectoryNotFoundException)
Exception Stack Trace: at System.Activities.Statements.Throw.Execute(CodeActivityContext context)
at System.Activities.CodeActivity.InternalExecute(ActivityInstance instance, ActivityExecutor executor, BookmarkManager bookmarkManager)
at System.Activities.Runtime.ActivityExecutor.ExecuteActivityWorkItem.ExecuteBody(ActivityExecutor executor, BookmarkManager bookmarkManager, Location resultLocation) 
```

有人知道可能出了什么问题吗？作为记录，通过在 Visual Studio 中右键单击我的项目手动发布工作正常（并且使用相同的发布配置文件），因此不确定交易是什么。我也不是 100% 什么信息对人们在调试时使用有帮助，所以请让我知道你们想看到什么，我会更新问题。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:27:29.583

我通过简单地删除 Azure 中的 TFS 集成和 TFS 中的相关构建配置来解决此问题，然后重新添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-14T10:18:06.790

当输出位置设置不正确时会发生此错误。输出位置的值可以是“AsConfigured”、“PerProject”或“SingleFolder”。 [http://msdn.microsoft.com/en-us/library/dd647547.aspx#output](http://msdn.microsoft.com/en-us/library/dd647547.aspx#output)

例如。如果您在模板中有一个具有一个配置设置的项目，则输出位置设置为 SingleFolder。

# scope - AngularJS：如何对克隆范围的指令说？

> ID：14166637
> 
> 赞同：0
> 
> 时间：2013-01-04T23:19:57.033
> 
> 标签：scope, angularjs

我有这个[小提琴](http://jsfiddle.net/honzajde/u7tAs/2/)，不能让它工作。我相信原因在于两个具有自定义指令就地编辑的 li 元素共享范围。解决方案是对指令说创建绑定在父级上的范围的副本 - 可以嵌入帮助吗？

```
angular.module('bla', [])
    .directive('editInPlace', ['$parse','$compile', function($parse, $compile) {
    return {
        restrict: 'A',
        scope: true,
        link: function (scope, element, attribs) {
            var inputStart = '<input style="border: 2 solid black" name="inPlaceInput" style="display:none" value="';
            var inputEnd = '">';

            scope.editModeAccessor = $parse(attribs.editInPlace);
            scope.modelAccessor = $parse(attribs.ngBind);

            scope.$watch(attribs.editInPlace, function(newValue, oldValue){
                if (newValue){
                    console.debug("click");
                    console.debug("value: " + scope.modelAccessor(scope));
                    var inputHtml = inputStart + scope.modelAccessor(scope) + inputEnd;
                    element.after(inputHtml);
                    jQuery(element).hide();
                    scope.inputElement = jQuery("input[name=inPlaceInput]");
                    scope.inputElement.show();
                    scope.inputElement.focus();
                    scope.inputElement.bind("blur", function() {
                        blur();
                    });
                } else {
                    blur();
                }
            });

            function blur(){
                console.debug("blur secondary");
                if (scope.inputElement){
                    console.debug("blur secondary inputElement found");
                    var value = scope.inputElement.val();
                    console.debug("input value: "+ value);
                    scope.inputElement.remove();
                    jQuery(element).show();
                    scope.editModeAccessor.assign(scope, false);
                    scope.modelAccessor.assign(scope, value);
                }
            }
        }
    }
                            }]);

function ContactsCtrl($scope, $timeout){
    $scope.contacts = [{number:'+25480989333', name:'sharon'},{number:'+42079872232', name:''}];
    $scope.editMode = false;
    var editedId;
    $scope.edit = function(id){
        $scope.editMode = true;
        jQuery("#"+id).hide();
        editedId = id;
        //TODO show delete button
    }
    $scope.$watch('editMode', function(newValue, oldValue){
        if (!newValue && editedId){
            jQuery("#"+editedId).show();
        }
    });
}

<div ng-app="bla">
<div ng-controller="ContactsCtrl">
<h4>Contacts</h4>
<ul>
    <li ng-repeat="contact in contacts">
        <span edit-in-place="editMode" ng-bind="contact.number"></span>
        <span edit-in-place="editMode" ng-bind="contact.name"></span>
        <span id="{{$index}}" ng-click="edit($index)"><i class="icon-edit">CLICKtoEDIT</i></span>
    </li>
</ul>
</div></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T08:00:02.453

我认为克隆范围不是最好的解决方案。

在 Angular 中创建指令时，您应该将**所有**功能封装在指令中。你也应该避免在你不需要的时候混入 jQuery。大多数时候（如本例），您只是在引入不必要的复杂性。最后，类是控制显示的最佳方式，而不是`style`元素上的属性。

我冒昧地以更“有角度”的方式重写了您的指令 - 没有 jQuery。从更新后的[jsFiddle](http://jsfiddle.net/joshdmiller/NDFHg/)可以看出，它更简单、更干净。此外，它有效！

可以轻松修改此指令以添加许多其他很棒的功能。

```
app.directive( 'editInPlace', function() {
  return {
    restrict: 'E',
    scope: { value: '=' },
    template: '<span ng-click="edit()" ng-bind="value"></span><input ng-model="value"></input>',
    link: function ( $scope, element, attrs ) {
      // Let's get a reference to the input element, as we'll want to reference it.
      var inputElement = angular.element( element.children()[1] );

      // This directive should have a set class so we can style it.
      element.addClass( 'edit-in-place' );

      // Initially, we're not editing.
      $scope.editing = false;

      // ng-click handler to activate edit-in-place
      $scope.edit = function () {
        $scope.editing = true;

        // We control display through a class on the directive itself. See the CSS.
        element.addClass( 'active' );

        // And we must focus the element. 
        // `angular.element()` provides a chainable array, like jQuery so to access a native DOM function, 
        // we have to reference the first element in the array.
        inputElement[0].focus();
      };

      // When we leave the input, we're done editing.
      inputElement.prop( 'onblur', function() {
        $scope.editing = false;
        element.removeClass( 'active' );
      });
   }
}; 
```

});

# function - 函数的 Haskell 类型同义词

> ID：14166641
> 
> 赞同：0
> 
> 时间：2013-01-04T23:20:29.510
> 
> 标签：function, haskell, types

假设我们在 Haskell 中有以下内容，

```
type Bag a = a -> Int

data Gems = Sapphire|Emerald|Diamond|Ruby deriving (Show)

myBag :: Bag Gems
myBag Sapphire = 3
myBag Diamond = 2
myBag Emerald = 0 

emptyBag :: Bag Gems
emptyBag Sapphire = 0
emptyBag Diamond = 0
emptyBag Emerald = 0 
```

我们将如何定义一个函数 addItem 以便 addItem xb 将单个出现的项目 x 添加到包 b 中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T04:47:14.777

你想要一个类型的函数

```
addItem :: Gems -> Bag Gems -> Bag Gems 
```

注意`BagGems`this 的定义与

```
addItem :: Gems -> (Gems -> Int) -> Gems -> Int 
```

因此，我们期望`addItem`开始定义

```
addItem gemToAdd bag gem = --some Int expression 
```

好的，所以让我们也考虑一下逻辑

1.  If `gem`is a different gem from `gemToaAdd`we should get out what ever give us 如果是一个不同的宝石，我们应该拿出曾经`bag`给我们的东西
2.  如果它是一样的，我们应该再买一个

因此

```
addItem gemToAdd bag gem = if gem == gemToAdd then (bag gem) + 1 else bag gem 
```

你也可以写

```
addItem gemToAdd bag gem | gem == gemToAdd = (bag gem) + 1
                         | otherwise       = bag gem 
```

现在，这将产生一个错误，因为`Eq`没有为`Gems`. 解决这个问题的最简单方法是定义

```
data Gems = Sapphire|Emerald|Diamond|Ruby deriving (Show, Eq) 
```

你完成了

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T23:11:08.763

First of all, you can't change anything in Haskell, everything is immutable. So what you're trying to do right now is wrong.

```
myBag Sapphire = 3 
```

Will always be 3.

So you will have to return a new bag instead of changing it.

Also, I think it would be better to create a list of Gems instead of pattern matching. As such:

```
data Gems = Sapphire|Emerald|Diamond|Ruby deriving (Show, Eq)

type Gem = (Gems, Int)
type Bag = [Gem] 
```

You can now do things such as

```
[(Ruby, 30), (Sapphire, 20)] :: Bag 
```

for example.

Next we want to be able to adjust this bag.

```
removeGem :: Gems -> Bag -> Bag
removeGem _ [] = []
removeGem gem (x:xs) | gem == (fst x)  = removeGem gem xs
                     | otherwise = x : removeGem gem xs 
```

This code will let you remove a gem from a bag. It's very simple, it just goes through the list and checks each item if it's the selected gem. If that's not the case it will add it to the function list. In the end it will return a new list without the selected gem.

With this function we can add gems to a bag with the following code:

```
addToBag :: Gem -> Bag -> Bag
addToBag item@(gem,amount) bag = 
  case lookup gem bag of 
    Nothing -> item : bag
    _       -> let (Just oldAmount) = lookup gem bag
               in (gem, (amount + oldAmount)) : (removeGem gem bag) 
```

This code will let you add new gems to a bag like so:

```
(Diamond, 10) `addToBag` [(Ruby, 30), (Sapphire, 20)] :: Bag 
```

Will return:

```
[(Diamond,10),(Ruby,20),(Sapphire,30)] 
```

"lookup" is a function that looks up a "key" in a list of tuples. The key being the first tuple value, in our case the Gems.

If the lookup doesn't find the gem we want to add, it will simply append it to the list.

If however it does find it, we will store the amount it has of that gem into "oldAmount", delete the gem and add the new amount and old amount together to create a new gem for your bag. For example:

```
(Ruby,20) `addToBag` [(Diamond,10),(Ruby,20),(Sapphire,30)] 
```

Will return:

```
[(Ruby,40),(Diamond,10),(Sapphire,30)] 
```

instead of:

```
[(Ruby,20),(Diamond,10),(Ruby,20),(Sapphire,30)] 
```

So it adds up the amount instead of adding the same gem name over and over.

If you want to find a gem and amount from your bag, you can simply use the "lookup" function.

I hope this answers your question.