# StackOverflow 问答 16172000-16172999

# java - 高级 Eclipse Java 搜索

> ID：16172001
> 
> 赞同：12
> 
> 时间：2013-04-23T14:29:37.900
> 
> 标签：java, eclipse, eclipse-plugin, search-engine

有一种方法可以在 Eclipse 中使用 Search > Java 来搜索类型或方法声明或引用。但是，如何指定一些更高级的搜索条件，例如：

*   在 A 类的子类中查找 B 类的所有引用。
*   在实现接口 I 的类和/或名为 com.foo.*.service 的包中查找所有名为 insert* 的方法。

我一直在处理一个非常大的代码库，并且拥有这些类型的查询将有很大帮助。浏览 Eclipse Marketplace，我能找到的最接近的是[SEA-QL](http://marketplace.eclipse.org/content/sea-ql-java-code-search-engine#.UXaYm7X-F8E)，但它甚至无法创建工作区中所有项目的索引。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T12:08:28.480

你所要求的对我来说听起来很棒 - 我不知道有任何内置功能可以轻松满足你的要求。也许有人会建议一个插件。

但是，您是否考虑过以下组合： - “工作集” - 正则表达式 - 已保存的搜索

帮助减轻一些痛苦？

对您的第二个示例的建议：创建一个包含 com.foo.* 包的“工作集” 使用选中的正则表达式选项执行“文件”（不是 Java）搜索，在 *.java 类型的文件中搜索类似的内容：

```
implements.*I.*\R.*insert 
```

您可以根据“插入”方法的方法签名或多或少地明确正则表达式。

保存搜索将允许您建立（和共享）常用表达式库。

我从另一个 SO 问题和一些博客中破解了这个示例： [用于 Eclipse 搜索的有用正则表达式](http://ganeshtiwaridotcomdotnp.blogspot.com/2011/09/some-useful-regular-expressions-for.html)和 [Eclipse 正则表达式查找和替换](https://stackoverflow.com/questions/3458119/eclipse-regex-find-and-replace)等。

您还可以通过复习您的正则表达式技能获得额外的好处（我知道我需要自己做一些事情！）

顺便说一句，您使用的是什么源代码控制平台？您可以将搜索工具（想想 Google）插入到某些源代码控制系统中。例如，我使用这个工具：[SVN Query](http://svnquery.tigris.org/ "SVN 查询")，我相信还有其他的。对于您的要求，这也不是一个干净的解决方案。对不起，我没有一个直接的答案！希望有人有有用的建议！

# asp.net-mvc - WebBackgrounder 注册新工作

> ID：16172004
> 
> 赞同：1
> 
> 时间：2013-04-23T14:29:40.667
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我已经在我的 asp.net mvc 应用程序中配置了 WebBackgrounder，并且它正在运行，我在 App_Start 的 WebBackgrounderSetup 中的应用程序开始时注册了一份工作。

现在我需要从控制器操作中注册另一个作业，我该如何注册它？我在 JobManager 中没有看到任何方法，这可能吗？

# webdav - WebDAV 链接第一次以只读方式打开

> ID：16172008
> 
> 赞同：2
> 
> 时间：2013-04-23T14:29:47.117
> 
> 标签：webdav

我已将 WebDAV 服务器集成到我的网站中（使用 IT Hit 的产品），以允许用户对 Office 文档进行“在线编辑”，而无需下载和重新上传。除了用户第一次尝试打开链接外，它通常似乎可以工作，它始终是只读的。在他们第一次打开任何 WebDAV 链接后，它似乎工作正常。查看 Fiddler，与后续时间相比，第一次打开文件的请求集有所不同。

第一次（HTTP 方法 - URL - 用户代理）：

```
GET - Files/doc.docx - Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64;   Trident/6.0)
OPTIONS - Files/ - Microsoft Office Protocol Discovery
OPTIONS - Files/ - Microsoft Office Excel 2013
HEAD - Files/doc.docx - Microsoft Office Excel 2013
GET - Files/doc.docx - Microsoft Office Excel 2013
PROPFIND - Files/doc.docx - Microsoft Office Excel 2013 
```

随后的时间：

```
OPTIONS - Files/ - Microsoft Office Excel 2013
HEAD - Files/doc.docx - Microsoft Office Excel 2013
LOCK - Files/doc.docx - Microsoft Office Excel 2013
GET - Files/doc.docx - Microsoft Office Excel 2013
PROPFIND - Files/doc.docx - Microsoft Office Excel 2013 
```

当您在每种情况下单击链接时，浏览器也会以不同的方式处理链接。第一次，它会打开通常的打开/另存为/取消框，但之后会出现一个 Microsoft Office 对话框，询问您是否要打开此文件。

It does not seem to be just my implementation though, as the same behaviour happens when using this: [http://ajaxbrowser.com/](http://ajaxbrowser.com/) (you need to be in IE).

I have tried intercepting the requests that are not going to work by checking the user agent but it seems that stops it working out how to open the links correctly in future.

Has anyone come across this before and found a way around it? It isn't great if the first time a user tries the new functionality, it doesn't work. It also isn't that obvious that it hasn't worked and I can easily see some users saving the read only file locally and expect that it has synced with the server. Any solution that would avoid that situation is welcome.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-19T12:01:21.917

This turns out to be a bug relating to Office 2013\. It seems to work fine for Office 2010\.

我让 IT Hit 看一下，如果您使用以下 javascript 打开链接，他们找到了解决方法：

```
window.location('ms-word:ofe|u|' + documentLocation); 
```

其中 agent 是 ms-word 可以根据文件类型替换为 ms-excel。

# python - Python中的Json：接收/检查重复键错误

> ID：16172011
> 
> 赞同：7
> 
> 时间：2013-04-23T14:29:56.337
> 
> 标签：python, json

当映射中有重复键时，python的`json`模块会起到一些规范的作用：

```
import json
>>> json.loads('{"a": "First", "a": "Second"}')
{u'a': u'Second'} 
```

我知道[文档](http://docs.python.org/2/library/json.html#repeated-names-within-an-object)中指定了这种行为：

> RFC 指定 JSON 对象中的名称应该是唯一的，但没有指定如何处理 JSON 对象中的重复名称。默认情况下，此模块不会引发异常；相反，它会忽略给定名称的最后一个名称-值对以外的所有内容：

**对于我当前的项目，我绝对需要确保文件中不存在重复的键，如果是这种情况，我会收到错误/异常？如何实现？**

我仍然坚持使用 Python 2.7，所以一个也适用于旧版本的解决方案对我帮助最大。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-23T14:35:29.403

好吧，您可以尝试使用[`JSONDecoder`](http://docs.python.org/2/library/json.html#json.JSONDecoder)该类并指定一个 custom `object_pairs_hook`，它将在重复数据被删除之前接收它们。

```
import json

def dupe_checking_hook(pairs):
    result = dict()
    for key,val in pairs:
        if key in result:
            raise KeyError("Duplicate key specified: %s" % key)
        result[key] = val
    return result

decoder = json.JSONDecoder(object_pairs_hook=dupe_checking_hook)

# Raises a KeyError
some_json = decoder.decode('''{"a":"hi","a":"bye"}''')

# works
some_json = decoder.decode('''{"a":"hi","b":"bye"}''') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-04T05:44:41.983

下面的代码将采用任何具有重复键的 json 并将它们放入一个数组中。例如取这个 json 字符串 '''{"a":"hi","a":"bye"}''' 并给出 {"a":['hi','bye']} 作为输出

```
import json
def dupe_checking_hook(pairs):
    result = dict()
    for key,val in pairs:
        if key in result:
            if(type(result[key]) == dict):
                temp = []
                temp.append(result[key])
                temp.append(val)
                result[key] = temp
            else:
                result[key].append(val)
        else:
            result[key] = val
    return result

decoder = json.JSONDecoder(object_pairs_hook=dupe_checking_hook)
#it will not raise error
some_json = decoder.decode('''{"a":"hi","a":"bye"}''') 
```

# amazon-cloudfront - WordPress MU Cloudfront。尾部斜杠重定向到错误的域

> ID：16172015
> 
> 赞同：3
> 
> 时间：2013-04-23T14:30:05.020
> 
> 标签：amazon-cloudfront, wordpress

我在 wordpress 重定向中的重定向遇到了一些问题，导致域发生变化。

示例：站点 - noncdn.somedomain.com CDN URL - www.domain.com

当我打开带有 oa 斜杠的链接时，会出现 301 重定向：转到此处：www.domain.com/page 将您带到此处：noncdn.somedomain.com/page/

由于 Cloudfront 使用 Origin Domain 访问服务器，因此服务器甚至不知道请求来自不同的域。

如何强制此 301 使用带有正确 CDN 域的 FQDN 而不是进行相对重定向？

我已经添加了这个，以便站点上的链接和图像都从 Cloudfront 域加载，但它似乎对重定向行为没有影响：

```
 add_filter('home_url','home_url_cdn',10,2);

function home_url_cdn( $path = '', $scheme = null ) {
    return get_home_url_cdn( null, $path, $scheme );
}

function get_home_url_cdn( $blog_id = null, $path = '', $scheme = null ) {  
    $cdn_url = get_option('home');
    if(get_option('bapi_site_cdn_domain')){
        $cdn_url = get_option('bapi_site_cdn_domain');
    }
    $home_url = str_replace(get_option('home'),$cdn_url,$path);
    //echo $home_url; 

    return $home_url;
} 
```

任何帮助深表感谢！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-10T17:34:59.917

在 Nginx 上运行的标准静态网站的 Cloudfront 分发版中，我一直在追踪一个非常相似的问题。症状是相同的，带有尾部斜杠的链接（例如 www.acme.com/products/）正常工作，但省略尾部斜杠会导致用户被重定向到源。

问题是网络服务器软件本身没有正确地尝试解析 URI，而是通过重定向到它可以服务的 URL 来响应。您可以使用 curl 对您的网站进行测试：

```
$ curl http://myhost.com/noslashurl
HTTP/1.1 301 Moved Permanently [...] 
```

CloudFront 将准确返回您的服务器返回的内容，在本例中为 301 重定向*到您的原始 URL*。CloudFront 不遵循重定向并缓存它，而是缓存重定向本身。纠正此问题的唯一方法是确保您的源正确处理请求并且不响应 301。

在我的特殊情况下，这意味着在 nginx 配置中更新我所在位置的[try_files 指令](http://nginx.org/en/docs/http/ngx_http_core_module.html#try_files)。正如我提到的，这是一个静态站点，所以我的 try_files 变成了：

```
location / {
    [...]
    try_files    $uri $uri/index.shtml /index.shtml =404;
} 
```

您要确保 try_files 有一个残局，以避免重定向循环，这将导致您的服务器在请求不存在的 URL 时返回 500 服务器错误。在这种情况下，/index.shtml 是最后一次尝试，如果失败，它将返回 404。

我知道这并不能准确回答您的问题，但您的问题是我在搜索“没有尾随斜杠重定向到原点的云端”时发现的少数几个问题之一，而您已经一年没有答案了，所以我想通了值得发送回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-09T19:05:52.290

我有同样的问题。

我修复了更改一些 wordpress 参数的问题。

在 elasticbeanstalk 中，我`CUSTOM_URL`为我的自定义域设置了参数，在文件中，`/var/www/html/wp-includes/load.php` 我将参数`HTTP_HOST`和设置`SERVER_NAME`为相同的值`CUSTOM_URL`，它解析了重定向到 elasticbeanstalk url。

```
$_SERVER['HTTP_HOST'] = $_SERVER['CUSTOM_URL'];
$_SERVER['SERVER_NAME'] = $_SERVER['CUSTOM_URL']; 
```

# gwt - 在按钮侦听器 GWT 上添加新标签

> ID：16172016
> 
> 赞同：0
> 
> 时间：2013-04-23T14:30:08.620
> 
> 标签：gwt, button, label, gxt

我正在尝试向面板添加新标签，这是单击按钮时，实际上标签的数量是未知的，因为我的应用程序包括从文件中提取一些信息，然后在标签中显示每个信息，所以我有上传文件然后提取信息，我创建了一个上传文件，我能够提取信息，但是我在标签中显示每个信息时遇到问题，我不能创建很多标签，然后使用 label.settext( ) 在其标签中制作每个信息，因为标签/信息的数量是可变的。

所以你能建议/帮助我，这样我就可以做到这一点。

此致。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:42:56.827

如果你从一个`Array`例子中得到结果，你可以这样做：

```
String[] data; //You can add you data here

addButton.addClickHandler(new ClickHandler() {

        @Override
        public void onClick(ClickEvent event) {
             for (String s : data) {
                      RootPanel.get().add(new Label(s));
             }
        }
    }); 
```

这样您就可以根据需要添加尽可能多的标签

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:44:10.547

您可以使用 LinkedList 创建可变数量的标签。

```
 int count =  x ; //Quantity of labels you need;
    LinkedList<Label> labelList = new LinkedList<Label>();
    for (int i = 0; i < count ;i++)
    {
        Label tmpLabel  = new Label();
        tmpLabel.setText(STUFF) //Here you have to set your content
        labelList.add(tmpLabel);
    }
            // Now we add the Labels to the Panel
             for (int ind = 0; ind < labelList.size() ;ind++)
    {
        panel.add(labelList.get(ind)); //panel is the panel you show
    } 
```

如果您以后不必访问标签，则不需要 LinkedList 并且可以将它们直接添加到您的面板中。你没有说你是如何准确附加标签的，但如果你使用网格，你必须根据你的信息设置它的大小。

# c# - 检查 SVN 是否已更新 C#

> ID：16172018
> 
> 赞同：0
> 
> 时间：2013-04-23T14:30:16.840
> 
> 标签：c#, svn, batch-file, svn-update

我正在尝试检查 svn 是否已更新，并且我不想使用 SharpSVN。我正在尝试使用该`Process`课程。

在批处理中，这是我通常会做的：`svn st -u <svn path> | find "*"`

这是我的代码：

```
private void checkSVN()
{
        Process newProcess= new Process();
        newProcess.StartInfo.FileName = "svn";
        newProcess.StartInfo.WorkingDirectory = "";
        newProcess.StartInfo.Arguments = "st -u C:\\SVN | find " + @"""*""";
        newProcess.StartInfo.UseShellExecute = false;
        newProcess.StartInfo.RedirectStandardOutput = true;
        newProcess.OutputDataReceived += new DataReceivedEventHandler(parseStandartOutput);

        newProcess.Start();
        newProcess.BeginOutputReadLine();
}
private static void parseStandartOutput(object sendingProcess, DataReceivedEventArgs outLine)
{
    if (!String.IsNullOrEmpty(outLine.Data))
        m_svnOutput += outLine.Data + " ";
} 
```

问题是`find "*"`不起作用 - The`newProcess.StartInfo.Arguments`设置为`"st -u C:\\SVN | find \"*\*""`，当然，这不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:34:10.607

你试过简单

```
 newProcess.StartInfo.Arguments = "st -u C:\\SVN | find \"*\""; 
```

# java - yWorks UML Doclet Netbeans Java

> ID：16172030
> 
> 赞同：2
> 
> 时间：2013-04-23T14:30:40.293
> 
> 标签：java, netbeans, uml

我已按照此页面[yWorks UML Doclet](http://www.yworks.com/en/downloads.html#yDoc)中的说明在 netbeans 中生成 UML 图。我已成功安装并生成了 javadoc，但 javadoc 中没有**UML 图**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-18T06:48:08.960

您可以生成 Javadoc（项目 > 右键单击​​ > 生成 Javadoc），您将在项目（浏览器）的 javadoc 中看到 UML 图。但在此之前您必须将 yworks 相关代码添加到 javadoc

![在此处输入图像描述](https://i.stack.imgur.com/FYyiB.png)

在框中：Additional Javadoc options，输入以下文本（替换与您的安装对应的 yDoc 的路径）：

```
-docletpath /opt/umldoclet/lib/ydoc.jar -resourcepath /opt/umldoclet/resources -doclet ydoc.doclets.YStandard -umlautogen 
```

然后生成如下UML图

![在此处输入图像描述](https://i.stack.imgur.com/ABrRU.png)

# c# - 从代码到表单设计器的 Datagridview 连接

> ID：16172034
> 
> 赞同：0
> 
> 时间：2013-04-23T14:31:01.413
> 
> 标签：c#, sql-server, ado.net

我今天一直在关注 C#station 的 ADO.net 教程，我已经了解了数据网格示例 ( [http://csharp-station.com/Tutorial/AdoDotNet/Lesson05](http://csharp-station.com/Tutorial/AdoDotNet/Lesson05) )，它在设计器后面构建了一个数据网格，在以编程方式编写 form.cs 文件。

在允许我从工具箱中拖动 DatagridView 并使用它之前，我是否必须使用服务器资源管理器使用向导连接到我的 SQL Server？我想设计我的表单而不用填充等。在 .cs 文件中

谢谢，罗斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:33:39.833

您不必这样做，但任何数据提供者都需要配置数据来检索它，因此如果您不使用向导，则必须手动设置它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T20:14:37.700

在代码中创建 SQLConnection 对象时，您只需使用 SQL Server 实例的连接字符串。

```
public void Initdata()
{
// instantiate the connection
conn = new SqlConnection([YourConnectionString]);   
} 
```

出于测试目的，这可以像教程给出的示例中那样硬编码，但最好将数据库连接字符串存储在配置文件中，然后在运行时引用配置。请参阅有关连接字符串的[这篇文章。](http://msdn.microsoft.com/en-us/library/ms254494%28v=vs.90%29.aspx)

# javascript - Browserify：如果需要，使用 module.exports，否则暴露全局

> ID：16172035
> 
> 赞同：40
> 
> 时间：2013-04-23T14:31:02.130
> 
> 标签：javascript, browserify

我正在考虑为我的一些项目采用[browserify](http://browserify.org/)，但想确保其他人如果想使用（捆绑的）代码就不必使用browserify。显而易见的方法是`module.exports`通过`window.`全局和全局公开模块导出。但是，我宁愿不要污染那些正在`require`编写脚本的人的全局命名空间。

是否可以检测脚本是否正在被`require`d？如果是，那么我可以执行以下操作：

```
var mymodule = (function() { ... })();
if (isRequired()) {
  module.exports = mymodule;
} else {
  window.mymodule = mymodule;
} 
```

请注意，无论如何，这将预先捆绑，因此`var mymodule`不会暴露全局。此外，目前我正在使用[显示模块模式](https://web.archive.org/web/20140929031405/http://www.klauskomenda.com/code/javascript-programming-patterns/)，但愿意切换到更适合 browserify 的东西。

使模块既`require`能干又`<script src=`能干的最好方法是什么？在这两种情况下最好只公开一个全局变量吗？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2014-01-19T02:05:10.340

Forbes Lindesay 有一篇很好的文章解释了如何进行独立构建： [http ://www.forbeslindesay.co.uk/post/46324645400/standalone-browserify-builds](http://www.forbeslindesay.co.uk/post/46324645400/standalone-browserify-builds)

简短版本，使用独立选项：

```
browserify beep.js --standalone beep-boop > bundle.js 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-10-24T14:07:51.563

我正在处理建立图书馆的同样问题，这是一个粗略的意见。我认为我们需要首先将图书馆的*受众*分为几类：

1.  使用 browserify 和**NPM的人**
2.  那些只会下载 mylib.min.js 并使用一种或另一种方式的人
3.  AMD（有凉亭？），可能是第三类。

因此，对于**1**来说，这很容易，您将拥有一个 index.js 模块：

```
module.exports = function () { /* code */ } 
```

你的 package.json 将有一个 main

“主”：“index.js”

请注意，我没有向 index.js 添加任何 window.xx 代码。

对于**2**，我认为最好的主意是创建一个`standalone.js`

```
var mylib = require('./index.js');
global.window.mylib = mylib; 
```

这就是 browserify 应该构建的。

对于**3**（如果您关心的话），您可以按如下方式调整standalone.js：

```
var mylib = require('./index.js');
if (typeof global.window.define == 'function' && global.window.define.amd) {
  global.window.define('mylib', function () { return mylib; });
} else {
  global.window.mylib = mylib;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-27T15:51:32.543

假设另一个库没有创建全局 module.exports 对象，您可以简单地检查 module.exports 的存在

```
var mymodule = (function() { ... })();
if (module && module.exports) {
  module.exports = mymodule;
} else {
  window.mymodule = mymodule;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-09T11:22:23.930

为什么不直接用闭包包裹整个东西并`exports`作为参数传递呢？

```
(function (exports) {
    // code here
    // ...
    exports.foo = bar;
})(exports || this); 
```

这样它也会将其导出到 WebWorker 范围和其他“无窗口”环境。

# spring - Maven 资源过滤 - Spring 应用

> ID：16172038
> 
> 赞同：1
> 
> 时间：2013-04-23T14:31:08.233
> 
> 标签：spring, maven, profiles

我只是想知道，Maven 资源过滤机制在什么时候将配置文件中的值注入目标文件？我问是因为我的应用程序正在使用 Spring，并且取决于 JVM 属性，它将调用我的应用程序环境文件之一，该文件又用于在创建 Spring bean 时向它们提供配置信息。

我想将环境文件中的密码和数据库类型信息移动到 Maven Settings.xml 文件中，但是我想知道 Spring 会覆盖或与 Maven 资源过滤的工作方式发生冲突吗？

Spring 的目标是决定应用程序在什么环境中运行，并选择一个环境文件，该文件已经具有 Maven 注入的必要值。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T17:52:05.123

Maven 在流程资源阶段替换占位符。请参阅[http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html](http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html)

因此，当 spring 开始创建其上下文时，值就在那里。

您可以使用 PropertyPlaceholderConfigurer 读取属性文件并使它们在 spring 上下文中可用：

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
        <list>
            <value>file://${config.dir}/external-config.properties</value>
        </list>
    </property>
</bean> 
```

“config.dir”在系统属性中：java -Dconfig.dir=/dir/ 或者我认为它也可以是上下文参数。

在属性文件中的 spring 上下文中 ${key} 可用于配置 bean。根据 spring 的版本，注释也可用。或者 PropertyResolver 也有一个命名空间。

所以 maven 过滤和 spring 可以很好地协同工作。

# rest - Spring绑定一个bean来休息post请求

> ID：16172039
> 
> 赞同：1
> 
> 时间：2013-04-23T14:31:09.667
> 
> 标签：rest, spring-mvc

我围绕 Spring 构建了以下 REST 服务。我想实现一个可以添加用户的 POST 方法。用户的数据在请求正文中，可以是 JSON/XML。我想要服务器端实现

1.  自动将传入数据映射到 Java bean
2.  并使用单一实现处理两种类型的数据（JSON/XML）。

我尝试过使用`@ModelAttribute`in`addUser`方法，`UserController`但将对象中的所有字段都设为空`user`。有什么线索吗？

这是Spring配置文件

```
<mvc:annotation-driven />

<context:component-scan base-package="com.rest.sg.controller" />

<bean
    class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
    <property name="order" value="1" />
    <property name="mediaTypes">
        <map>
            <entry key="json" value="application/json" />
            <entry key="xml" value="application/xml" />
        </map>
    </property>

    <property name="defaultViews">
        <list>
            <!-- JSON View -->
            <bean
                class="org.springframework.web.servlet.view.json.MappingJacksonJsonView">
            </bean>
            <!--  XML view -->
            <bean class="org.springframework.web.servlet.view.xml.MarshallingView">
                <constructor-arg>
                    <bean class="org.springframework.oxm.jaxb.Jaxb2Marshaller">
                        <property name="classesToBeBound">
                            <list>
                                <value>com.rest.sg.bean.User</value>
                            </list>
                        </property>
                    </bean>
                </constructor-arg>
            </bean>
        </list>
    </property>
    <property name="ignoreAcceptHeader" value="true" />

</bean> 
```

UserController 类和 addUser 方法

```
@Controller
public class UserController {

    @RequestMapping(method=RequestMethod.POST, value="/user")
    @ResponseBody
    public User addUser(@ModelAttribute("user") User user) {
        userService.addUser(user);
        return user;
    }

} 
```

和用户 Bean

```
@Entity
@XmlRootElement
@Table(name = "user", catalog = "blahblah")
public class User implements java.io.Serializable {

    // Fields
    // Getter , Setters
    ...

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T20:43:36.520

您的控制器需要知道如何映射数据。默认是在对象属性上映射请求参数。

如果您发送代表`User`对象的 JSON，您可以尝试

```
public User addUser(@RequestBody User user) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T19:40:14.587

这样做：

```
 @RequestMapping(value="/persons", method = RequestMethod.POST, 
                headers="Accept=*/*", 
                consumes="application/json")
public User addUser( @RequestBody User u){
              //Code.
} 
```

发送请求时，发送header

```
Content-Type:application/json //This is important
Accept: application/json 
```

# html - 滚动条在 iframe 中不可见

> ID：16172049
> 
> 赞同：0
> 
> 时间：2013-04-23T14:31:41.193
> 
> 标签：html, iframe, dojo

我正在尝试使用 iframe 和 src 指向在 dojo 框架中制作的网站。我的 URL 在不同的服务器上，而我的 iframe 在不同的服务器上。我只是使用 URL 在 iframe 中加载 URL 的内容。但是我看不到带有 iframe 的滚动条，尽管页面内容超过了 iframe。

我的代码是：

```
<div style="overflow:visible; width: 100%;">
    <iframe src="http://172.27.135.85:2040/feg/ngfeeui/public/" width="80%" height="400px" frameborder="0" scrolling="auto" style="overflow: auto;"></iframe>
</div> 
```

如果这个问题是由于 dojo 框架中使用的一些 javascript 或 css 引起的，有人可以帮助我吗？如果需要，我还可以发布 URL 的完整代码，我可以在 firebug 中看到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:43:45.100

对不起，这是一个答案，我还没有评论的要点。你的浏览器支持 iframe 吗？在这里查看： [http ://www.w3schools.com/tags/tryit.asp?filename=tryhtml_iframe_scrolling](http://www.w3schools.com/tags/tryit.asp?filename=tryhtml_iframe_scrolling)

# c++ - 如何在 OpenSource IDE (codelite) 中迁移到 C++ 11

> ID：16172050
> 
> 赞同：1
> 
> 时间：2013-04-23T14:31:43.343
> 
> 标签：c++, compiler-construction, c++11, static-libraries, codelite

我在 Ubuntu QQ 上使用 CodeLite 5.1。默认情况下，根据之前使用 QQ 和其他工具安装的内容，我有 gtCC 和 gt++ 工具链可用。我总是使用 gt++，这似乎与 Boost 相处得很好。

想要使用 C++ 11 运行 - 我需要采取哪些步骤？我需要安装 C++ 11 库吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T14:58:09.687

**更新**见下文

我在 Linux ^([1](https://i.stack.imgur.com/Wiag6.png))上试过：

首先，在构建选项下，为相关的编译器开关创建一个条目：

> ![在此处输入图像描述](https://i.stack.imgur.com/Wiag6.png)

放大：

> ![在此处输入图像描述](https://i.stack.imgur.com/am9rr.png)

使用 g++ 进行演示：

1.  创建项目

> ![在此处输入图像描述](https://i.stack.imgur.com/J5ZuH.png)

1.  设置构建标志（全局设置）

> ![在此处输入图像描述](https://i.stack.imgur.com/XuS7O.png)

1.  构建并运行

> ![在此处输入图像描述](https://i.stack.imgur.com/eOoxI.png)

## 成功！

## 更新：

您可能还想勾选“代码完成”下的***启用 C++11 标准复选框：***

![在此处输入图像描述](https://i.stack.imgur.com/ag8Vo.png)

* * *

^([1](https://i.stack.imgur.com/Wiag6.png))在 Ubuntu Quantal 上，不要使用发行版 - 打开项目时它会崩溃。利用

```
deb http://repos.codelite.org/ubuntu/ quantal universe 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T14:46:51.660

您需要向`-std=c++11`正在使用的编译器提供（或类似的）命令。请查阅您选择的编译器的文档。

除非您当前的代码受到C++11 引入的[重大更改](https://stackoverflow.com/questions/6399615/what-breaking-changes-are-introduced-in-c11)的影响，否则您当前的代码将继续“按原样”运行。验证您的所有测试是否继续运行，然后您就可以开始使用编译器支持的[新功能了。](http://wiki.apache.org/stdcxx/C++0xCompilerSupport)由于对 C++11 的支持非常不稳定，您可能必须将编译器升级到其最新版本。

# javascript - 如何在 Ember 中发送事件？

> ID：16172052
> 
> 赞同：0
> 
> 时间：2013-04-23T14:31:49.987
> 
> 标签：javascript, ember.js, handlebars.js, dom-events, ember-data

我的 html 页面中有这段代码：

```
<script type="text/x-handlebars" data-template-name="logged">
    <h1>Page</h1>
          {{view.name}}
        {{#view App.LoginButton}}
          <button type="button">This is a clickable area!</button>
        {{/view}}

</script> 
```

我的 js 脚本中有这段代码：

```
App=Ember.Application.create();
App.Route= Ember.Route.extend({
  events: {
   /* turnItUp: function(level){
      alert("ee");
    }*/
  }
});

App.Router.map(function() {
    this.resource('logged', {path: '/'});
});

App.LoginButton= Ember.View.extend({
  click: function(evt) {
   this.get('controller').send('turnItUp', 11); 
  }
});
App.PlaybackController = Ember.Controller.extend({
 events:{
  turnItUp: function(level){
    alert(level);
  }
}
}); 
```

当我单击一个按钮时，我收到此错误：

> 未捕获的错误：没有处理事件“turnItUp”。

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T18:17:33.843

> 当我单击一个按钮时，我收到此错误：

```
Uncaught Error: Nothing handled the event 'turnItUp'. 
```

> 为什么？？？

因为控制器或路由都没有设置来处理 turnItUp 事件。这是发生了什么：

1.  用户单击按钮触发`App.LogginButton.click()`
2.  `click()`调用`get('controller')`返回 a `<(generated logged controller)>`- 可能不是您所期望的。
3.  `click()`发送`turnItUp`至`<generated logged controller>`
4.  `<generated logged controller>`没有`turnItUp`方法，所以委托给当前路线
5.  当前路线或其任何父母都没有`turnItUp`事件，因此您会看到错误

因此，将来要调试这种东西，请尝试添加控制台日志以确保控制器是您认为应该的：

```
App.LoginButton= Ember.View.extend({
  click: function(evt) {
    console.log('controller: ', this.get('controller').toString());
    this.get('controller').send('turnItUp', 11); 
  }
}); 
```

现在需要改变的另一件事是控制器事件不应该嵌套在`events`属性下 - 这只是用于路由。所以为了让事情顺利进行，试试这个：

```
App.LoggedController = Ember.Controller.extend({
  turnItUp: function(level){
    alert(level);
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:50:25.847

您正在寻找的东西在 ember 中被称为 Action

[http://emberjs.com/guides/templates/actions/](http://emberjs.com/guides/templates/actions/)

[http://emberjs.com/api/classes/Ember.Handlebars.helpers.html#method_action](http://emberjs.com/api/classes/Ember.Handlebars.helpers.html#method_action)

```
<button {{action turnItUp 11}}>This is a clickable area!</button>

App.PlaybackController = Ember.Controller.extend({
  turnItUp: function( value ){
    alert(value);
  }
}) 
```

（假设 PalyBackController 是视图的当前控制器）

# php - PHP中将一个多维数组附加到另 一个的最佳方法是什么？

> ID：16172056
> 
> 赞同：0
> 
> 时间：2013-04-23T14:32:13.287
> 
> 标签：php, multidimensional-array

我需要粘合几个包含`n`关联数组的索引数组（下面的示例）。我不关心外部数组的索引，我只关心内部数组的键。我已经尝试了几种方法，并且（令人惊讶的是）其中只有一种 - 最丑陋的 - 确实有效。所以我开始怀疑我是否缺少一些聪明/快速的东西。

PHP 版本：5.3+（如果重要的话）

**这就是我所拥有的：**

```
$arrayA = array(
        array(
            'foo' => 1,
            'bar' => 2,
            'baz' => 3
        ),
        array(
            'foo' => 12,
            'bar' => 22,
            'baz' => 32
        ),
    );

    $arrayB = array(
        array(
            'foo' => 21,
            'bar' => 22,
            'baz' => 23
        ),
        array(
            'foo' => 212,
            'bar' => 222,
            'baz' => 232
        ),
    ); 
```

**这就是我想要的：**

```
 $arrayC = array(
        array(
            'foo' => 1,
            'bar' => 2,
            'baz' => 3
        ),
        array(
            'foo' => 12,
            'bar' => 22,
            'baz' => 32
        ),
        array(
            'foo' => 21,
            'bar' => 22,
            'baz' => 23
        ),
        array(
            'foo' => 212,
            'bar' => 222,
            'baz' => 232
        ),
    ); 
```

**这是我尝试过的：**

```
 $arrayD = $arrayA;
    foreach($arrayB as $value)
    {
        $arrayD[] = $value;
    }

    $arrayE = array_push($arrayA, $arrayB);
    $arrayF = $arrayA + $arrayB;
    $arrayG = array_merge($arrayA, $arrayB);

    print_r($arrayC == $arrayD); //TRUE - it works
    print_r($arrayC == $arrayE); //FALSE
    print_r($arrayC == $arrayF); //FALSE
    print_r($arrayC == $arrayG); //FALSE 
```

**为什么我认为这`array_merge($arrayA, $arrayB)`不起作用：**

```
 $arrayD = $arrayA;
    foreach($arrayB as $value)
    {
        $arrayD[] = $value;
    }

    $arrayE = array_push($arrayA, $arrayB); // <-- after this line $arrayA is already broken
    $arrayF = $arrayA + $arrayB;
    $arrayG = array_merge($arrayA, $arrayB); // because $arrayA was broken I thought it didn't work 
```

有没有比 foreach() 方法更简单/更快/更聪明的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:34:44.637

很确定[array_merge()](http://php.net/manual/en/function.array-merge.php)应该可以正常工作。也许它们并不完全相同，但它们应该几乎相同。这可能是一种语义阻止它返回 true，为什么不将它们并排打印并找出区别呢？

也可能用[这种方法](http://www.php.net/manual/en/function.array-merge.php#51121)代替。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T14:36:32.343

我认为[`array_merge`](http://php.net/manual/de/function.array-merge.php)这是您正在寻找的：

```
 $arrayC = array_merge($arrayA, $arrayB); 
```

请参阅此处的工作示例：http: [//codepad.org/IJ8UM6Uz](http://codepad.org/IJ8UM6Uz)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T15:01:20.077

我不确定为什么 OP 说这`array_merge`不起作用：

```
<?
$arrayA = array(
        array(
            'foo' => 1,
            'bar' => 2,
            'baz' => 3
        ),
        array(
            'foo' => 12,
            'bar' => 22,
            'baz' => 32
        ),
    );

    $arrayB = array(
        array(
            'foo' => 21,
            'bar' => 22,
            'baz' => 23
        ),
        array(
            'foo' => 212,
            'bar' => 222,
            'baz' => 232
        ),
    );

//using ARRAY_MERGE
echo "<pre>";
$arrayC = array_merge($arrayA,$arrayB);
echo "ArrayC<br>";
print_r($arrayC); 

//using OP's method
$arrayD = $arrayA;
    foreach($arrayB as $value)
    {
        $arrayD[] = $value;
    }
echo "ArrayD<br>";
print_r($arrayD); 
?> 
```

结果：

```
ArrayC //array_merge
Array
(
    [0] => Array
        (
            [foo] => 1
            [bar] => 2
            [baz] => 3
        )

    [1] => Array
        (
            [foo] => 12
            [bar] => 22
            [baz] => 32
        )

    [2] => Array
        (
            [foo] => 21
            [bar] => 22
            [baz] => 23
        )

    [3] => Array
        (
            [foo] => 212
            [bar] => 222
            [baz] => 232
        )

)

ArrayD //OP's method..
Array
(
    [0] => Array
        (
            [foo] => 1
            [bar] => 2
            [baz] => 3
        )

    [1] => Array
        (
            [foo] => 12
            [bar] => 22
            [baz] => 32
        )

    [2] => Array
        (
            [foo] => 21
            [bar] => 22
            [baz] => 23
        )

    [3] => Array
        (
            [foo] => 212
            [bar] => 222
            [baz] => 232
        )

) 
```

我想知道区别...

# c# - 如何修剪使用实体框架查询数据库的数据库字段空间？

> ID：16172061
> 
> 赞同：3
> 
> 时间：2013-04-23T14:32:31.187
> 
> 标签：c#, .net, linq, entity-framework, trim

在数据库中我有一个字段`PhoneNumber = '123 456 789'`

查询返回 null：

```
return context.Clients.FirstOrDefault(c => с.PhoneNumber.Trim() == "123456789") 
```

是否可以使用 EF 修剪空白？

提前致谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T14:34:22.760

[Trim()](http://msdn.microsoft.com/en-gb/library/system.string.trim(v=vs.71).aspx)只会修剪前导和尾随空格：-

*string.Trim() - 从该实例的开头和结尾删除所有出现的空白字符。*

你可以使用：

```
string.Replace(" ", string.Empty): 
```

用法：

```
return context.Clients.FirstOrDefault(c => с.PhoneNumber.Replace(" ", string.Empty)) == "123456789") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T14:35:07.407

Trim 仅删除前导和尾随空格。

因此，您应该尝试以下方法：

```
return context.Clients.FirstOrDefault(c => с.PhoneNumber.Replace(" ","") == "123456789") 
```

个人认为，这种过滤方式会极大地影响大数据的性能。您应该考虑将数字存储在已经格式化且没有空格的数据库中。

# asp.net - VB.Net 传递/调用变量

> ID：16172062
> 
> 赞同：0
> 
> 时间：2013-04-23T14:32:32.613
> 
> 标签：asp.net, vb.net

如何将值传递给模块/函数。每当我在这里或谷歌搜索时，我都会得到 C# 而不是 VB.net 的代码

我希望能够单击一个按钮并将一个值传递给一个模块并对其进行操作。每个按钮都有一个值 1、2、3、4 等......它们会返回以使面板可见 = true/false。

即我想说下面的内容，但是当我单击 btnShow1 时，我想将其作为值传递给函数并隐藏/显示我正在谈论的面板。

当前代码

```
 Protected Sub btnShowQ1_Click(sender As Object, e As System.EventArgs) Handles btnShowQ1.Click

        If panel1.Visible = True Then
            panel1.Visible = False
        Else
            panel1.Visible = True
        End If

    End Sub 
```

猜码

```
 'Protected Sub btnShowQ1_Click(sender As Object, e As System.EventArgs) Handles btnShowQ1.Click
             vpanel = btnShowQ1.value
        Call fncPanel(vpanel as string) as string

    End Sub 
```

然后在某个地方 - 我猜在 App_code 中我创建了 function.vb

```
Imports Microsoft.VisualBasic

Public Class ciFunctions
    Public Function fncPanel(vPanel as string)as string
            If (vPanel).visible = False then
                (vPanel).visible = true
            Else
                (vPanel).visible = false
             End IF 
    End Function
End Class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:54:25.293

您应该能够将 Panel 类型的参数添加到 sub，并在 btnShow 事件中传递该项目。

```
Public Sub ChangePanelVis(panel as Panel)
    If panel.Visible then
        panel.Visible = True
    Else
        panel.Visible = True
    End If
End Sub

Protected Sub btnShowQ1_Click(sender As Object, e As System.EventArgs) Handles btnShowQ1.Click
    ChangePanelVis(panel1)
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:21:57.847

将按钮的 CommandArgument 属性设置为其显示或隐藏的面板编号：

```
<asp:Button ID="Button1" runat="server" Text="Show/Hide" CommandArgument="1" />
<asp:Button ID="Button2" runat="server" Text="Show/Hide" CommandArgument="2" /> 
```

在按钮单击事件上：

```
Private Sub Button_Click(sender As Object, e As EventArgs) Handles Button1.Click, Button2.Click, ...
    ' get the button which triggers this event
    Dim thisButton As Button = DirectCast(sender, Button) 

    ' construct the panel name to toggle visibility from the button's CommandArgument property
    Dim panelName as String = "panel" & thisButton.CommandArgument

    ' call the function, passing the panel name and the reference to current page
    TogglePanel(Me, panelName)
End Sub 
```

您可以将所有按钮单击事件处理程序添加到此子程序，方法是将它们添加到 Handles... 列表中，如上所述。因此，您不必为页面上的每个按钮创建事件处理程序。只需一个即可处理所有问题。

创建函数来切换可见性：

```
Sub TogglePanel(pg As Page, panelName As String)
    ' get the panel control on the page
    Dim panel As Panel = DirectCast(pg.FindControl(panelName), Panel)

    ' toggle its visibility
    panel.Visible = Not panel.Visible
End Sub 
```

`pg`如果将此函数放在一个类而不是它运行的页面或模块中，则该参数是必需的。如果函数位于同一个页面类中，则不需要 pg。

# oracle - 有没有快速刷新水晶报表中Oracle表结构的方法

> ID：16172063
> 
> 赞同：0
> 
> 时间：2013-04-23T14:32:33.470
> 
> 标签：oracle, crystal-reports-2010

我有一个使用多个具有复杂链接的 Oracle 表的 CR。我必须更改 1 个表格的结构（实际上是添加一个字段），但新结构并未反映在水晶报表中。我已尝试刷新或更新位置，但无法看到新添加的字段。我知道“解决”问题的一种不太聪明的方法是删除表格并将其重新添加，但这样做，我将不得不重新创建链接，重新排列报告，重新创建计算字段......基本上重写整个报告...任何可以帮助我快速更新我的 ORACLE 表结构的建议将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T11:54:28.353

好吧，偶然发现了这一点。我更新了数据库位置并刷新了它，但新架构没有更新。无论如何我还是决定运行报表... 在报表执行的时候，CR 意识到表结构发生了变化并更新了它！所以我认为解决这个问题的方法是更新位置然后执行报告，CR 会自动更新它。不需要删除表并将其添加回来，因为这样做会删除表所引用的所有链接和字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T23:06:48.817

您实际需要做的是验证数据库。

# jquery - 在父元素中找到子节点单击的节点名称

> ID：16172067
> 
> 赞同：0
> 
> 时间：2013-04-23T14:32:49.073
> 
> 标签：jquery, html

考虑这个简单的**html**列表：

```
<ul>
    <li><a href="http://google.com/">Test</a></li>
    <li><a href="http://google.com/">Test2</a>
        <ul>
            <li><a href="http://google.com">Test2 - 1</a></li>
            <li><a href="#3">Test2 - 2</a></li>
        </ul>
    </li>
</ul> 
```

现在这 3条**jQuery 行使**其可折叠：

```
$('ul > li').on('click', function(e) {
    e.preventDefault();
    $(this).find('ul').slideToggle(); 
}); 
```

这里的问题是，如果一个链接被点击得更深，`ul`我希望它跟随链接，在 jQuery 中将是：

```
if(this.nodeName != 'A') {
    e.preventDefault();
} 
```

目前`nodeName`是`LI`并且不是最后点击的子元素。

**问题**：是否可以在*没有第二个事件处理程序的情况下执行此操作以处理更深的元素*？（即`$('ul > li ul li a').click()`：）

我尝试`e.stopPropagation`了很多其他`css selectors`（`ul > *`等`ul li`）但没有成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:05:25.063

尝试这个：

```
$('li > ul').prev().on('click', function(e) {
    e.preventDefault();
    $(this).next().slideToggle();
}); 
```

[这里](http://jsfiddle.net/F26PH/)是 jsfiddle 的链接。这里`li > ul`选择器找到每个`ul`孩子，`li`然后`.prev()`选择上一个兄弟（即`a`标签）。这样我们可以防止`a`标签的默认行为（即跟随链接）和slideToggle下一个（即`ul`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:38:03.397

由于您的根选择器是`'ul > li'`，它只会匹配 LI。即，您无法将点击与使用该选择器绑定的处理程序内的其他元素相匹配。

您可以做的是在处理程序中使用更通用的选择器和过滤器：

例如：

```
$('ul *').on('click', function(e) {

    // leaf LIs only
    if($(this).is('li') && $(this).children().length == 0) {
        e.preventDefault();
        $(this).find('ul').slideToggle();  
    }

}); 
```

* * *

或者，您可以组合选择器并使用*一个*处理程序来处理它，例如：

```
$('ul > li, ul > li ul li a').on('click', function(e) {
    if($(this).is('a')) return true; // follow links
    e.stopPropagation();
    $(this).find('ul').slideToggle(); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T14:32:49.073

经过一些研究，我得出了这个答案：

```
$('ul > li').on('click', function(e) {
     e.stopPropagation();

    if(!$(this).find('ul').length == 0) {
         e.preventDefault();
         $(this).find('ul').slideToggle();     
    } 
}); 
```

`ul`因此，如果在单击的元素中没有创建任何元素，它将跟随链接。如果您有更好的解决方案，请分享:)。

[JSFiddle 在这里](http://jsfiddle.net/ajGAW/)。

此解决方案不适用于指定`ul`的 by `ID`：

```
$('ul#test > li').on('click', function(e) {
     e.stopPropagation();

    if(!$(this).find('ul').length == 0) {
         e.preventDefault();
         $(this).find('ul').slideToggle();     
    } 
}); 
```

在这里看到[更新的小提琴](http://jsfiddle.net/ajGAW/1/)，有人可以解释为什么吗？

好的，感谢`Simon`我与我的听众一起纠正了`li`来自`ul#test`：

```
$('ul#test').on('click', 'li', function(e) {
     e.stopPropagation();

    if(!$(this).find('ul').length == 0) {
         e.preventDefault();
         $(this).find('ul').slideToggle();     
    } 
}); 
```

精彩的 ！

# rest - 基于权限的 WebApi 端点的上下文序列化

> ID：16172076
> 
> 赞同：9
> 
> 时间：2013-04-23T14:33:08.133
> 
> 标签：rest, serialization, asp.net-web-api, data-security

我正在使用 Asp.Net Web Api。我希望能够根据连接的客户端访问权限过滤掉响应对象上的某些字段。

例子：

```
class Foo
{
    [AccessFilter("Uberlord")]
    string Wibble { get; set; }

    string Wobble { get; set; }
} 
```

返回数据时，`Wibble`仅当当前用户上下文可以满足“Uberlord”的值时，才应返回该字段。

我正在探索三种途径，但我没有找到可行的解决方案：

1.  自定义 WebApi MediaTypeFormatter。
2.  自定义 json.net IContractResolver。
3.  用于操作响应对象的控制器的某种 AOP 包装器

我的问题是：

*   自定义格式化程序感觉不是正确的地方，但可能是唯一的选择。
*   自定义 json 序列化程序无法访问当前上下文，所以我必须解决这个问题。
*   使用前两个选项，您需要针对每种响应格式、json、xml、某些自定义格式等进行特定的实现。这意味着如果支持另一种响应类型，则需要自定义格式化程序/序列化程序来防止敏感数据泄漏。
*   AOP 控制器包装器需要大量反射。

另一个好处是使用相同的机制从入站请求对象的字段中删除值。

我错过了一个明显的钩子吗？这是否已通过其他方式解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-04T13:55:50.393

它实际上比我最初想象的要简单得多。我没有意识到的是，[`DelegatingHandler`](http://msdn.microsoft.com/en-us/library/system.net.http.delegatinghandler.aspx)可以用来操纵响应以及[Web Api Pipeline](http://www.asp.net/posters/web-api/ASP.NET-Web-API-Poster-grayscale.pdf)中的请求。

## [ASP.NET Web API 消息的生命周期](http://www.dotnetcurry.com/ShowArticle.aspx?ID=888)

> 委托处理程序
> 
> * * *
> 
> 委托处理程序是消息管道中的一个可扩展点，允许您在将请求传递到管道的其余部分之前对其进行按摩。返回途中的响应消息也必须通过委托处理程序，因此任何响应也可以在此扩展点进行监视/过滤/更新。
> 
> 如果需要，委托处理程序也可以绕过管道的其余部分并自己发回 Http 响应。

## 例子

这是 DelegatingHandler 的示例实现，它可以操作响应对象或完全替换它。

```
public class ResponseDataFilterHandler : DelegatingHandler
{
    protected override System.Threading.Tasks.Task<HttpResponseMessage> SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)
    {
        return base.SendAsync(request, cancellationToken)
            .ContinueWith(task =>
            {
                var response = task.Result;

                //Manipulate content here
                var content = response.Content as ObjectContent;
                if (content != null && content.Value != null)
                {
                    ((SomeObject)content.Value).SomeProperty = null;
                }

                //Or replace the content
                response.Content = new ObjectContent(typeof(object), new object(), new JsonMediaTypeFormatter());

                return response;
            });
    }
} 
```

有关如何实现委托处理程序并将其添加到管道的 Microsoft 文章。[ASP.NET Web API 中的 HTTP 消息处理程序](https://docs.microsoft.com/en-us/aspnet/web-api/overview/advanced/http-message-handlers)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-03T16:03:04.957

我在这里的工作中有一个类似的问题：[ASP.NET WebAPI Conditional Serialization based on User Role](https://stackoverflow.com/questions/17451715/asp-net-webapi-conditional-serialization-based-on-user-role)

我提出的一个建议的解决方案是让我的 ApiController 从 BaseApiController 继承，它覆盖 Initalize 函数以根据用户的角色设置适当的格式化程序。我还没有决定我是否会走这条路，但也许它对你有用。

```
protected override void Initialize(System.Web.Http.Controllers.HttpControllerContext controllerContext)
{
    base.Initialize(controllerContext);
    // If the user is in a sensitive-data access role
    controllerContext.Configuration.Formatters.Add(/*My Formatter*/);
    // Otherwise use the default ones added in global app_start that defaults to remove sensitive data
} 
```

# php - Slim PHP：使 $app 在类中可用

> ID：16172077
> 
> 赞同：1
> 
> 时间：2013-04-23T14:33:09.940
> 
> 标签：php, class, slim

我使用控制器/方法作为应用程序路由的回调。

例如：

```
$app->get('/user/login', array('User', 'login')); 
```

这是示例`User`类：

```
Class User {
  public function login() {
    print 'Login page.';
  }
} 
```

如何使`$app`变量在所有类中自动可用？
我知道我可以使用`getInstance()`方法来获取它，但是我每次都需要手动调用它。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T14:35:58.383

创建一个提供公共元素的基类，并在每个控制器中扩展该基类。这是一个示例基类：

```
class BaseController { 
   $app = new YourApp();

    function __construct() {
           $this->app->get('/user/login', array('User', 'login'));

} 
```

然后，您可以扩展您的控制器以访问该类`$app`：

```
class User extends BaseController {

    function yourFunction() {
        // $this->app is already set!
} 
```

**更新以参数化路线：**

在基本控制器中：

```
function __construct($route) {
       $this->app->get($route, array('User', 'login')); 
```

然后在初始化类时包含路由参数：

```
$user = new User('/user/login'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-15T12:23:51.443

*编辑：对不起，只看到你关于以后不想调用 getInstance() 的注释。无论哪种情况，我都会在此处留下我的初始答案作为参考。*

您可以简单地调用 getInstance() 方法：`$app = \Slim\Slim::getInstance();`

[自 2013 年 11 月以来，您现在可以通过称为“类控制器](https://github.com/codeguy/Slim/releases/tag/2.4.0)”的功能使用控制器类实例作为 Slim 应用程序路由（及其参数）的回调：

```
$app->map('/foo/:bar/:baz', '\Foo:fun')->via('GET', 'POST'); 
```

在回调类实例中获取 $app 的实例非常简单：

```
class Foo {
    public function fun($var1, $var2) {
        $app = \Slim\Slim::getInstance();
    }
} 
```

# c# - 调度员没有定义

> ID：16172078
> 
> 赞同：0
> 
> 时间：2013-04-23T14:33:11.880
> 
> 标签：c#, winforms, dispatcher

我收到错误

> “socketServer.Form1”不包含“Dispatcher”的定义，并且找不到接受“socketServer.Form1”类型的第一个参数的扩展方法“Dispatcher”

从

```
private void tbAux_SelectionChanged(object sender, EventArgs e)
{
    this.Dispatcher.BeginInvoke(DispatcherPriority.Normal, (ThreadStart)delegate()
    {
        textBox.Text = tbAux.Text;
    }
    );
} 
```

根据[文档](http://msdn.microsoft.com/en-us/library/ms615907%28v=vs.100%29.aspx)，`Dispatcher`该类是`System.Windows.Threading`我正在使用的命名空间的一部分。

我错过了另一个参考吗？

如果它是相关的，我在使用服务器/客户端套接字收到“跨线程操作无效”的错误后添加了这个。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-23T14:38:30.710

WinForms 中没有`Dispatcher`。

为了发布异步 UI 更新（这正是这样`Dispatcher.BeginInvoke`做的），只需使用 `this.BeginInvoke(..)`它是来自`Control`基类的方法。在你的情况下，你可以有这样的东西（从 MSDN[模式](http://msdn.microsoft.com/en-us/library/0b1bf3y3%28v=vs.80%29.aspx)采用）：

```
private delegate void InvokeDelegate();
private void tbAux_SelectionChanged(object sender, EventArgs e)
{
   this.BeginInvoke(new InvokeDelegate(HandleSelection));
}
private void HandleSelection()
{
   textBox.Text = tbAux.Text;
} 
```

如果要同步更新，请使用`this.Invoke`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:40:48.390

[Dispatcher](http://msdn.microsoft.com/en-IN/library/system.windows.threading.dispatcher.aspx)概念属于 WPF 技术，您在Winforms 上使用 Winforms，您可以使用它或控制 .Begin 或 BeginInvoke 这两者都类似于 Dispatcher.Begin 或 Dispatcher.BeginInvoke

基本上，这两个都来自 CLR 在运行时为您实现的 Delegate 类。

# php - PHP PDO 查询不起作用

> ID：16172083
> 
> 赞同：1
> 
> 时间：2013-04-23T14:33:24.557
> 
> 标签：php, mysql, pdo

我知道这些值是正确的，因为我对它们进行了测试，我知道查询在控制台中有效 - 但我正在拔头发，试图看看它是如何不起作用的。我没有收到任何错误，但`var_dump($row)`=== 错误。

你能看出我哪里错了吗？

```
<?php
include('config.php');
//include('classes/db.class.php');
session_start();
var_dump($_SESSION['cart_id']);
$db = new PDO('mysql:host=' . DB_HOST .';dbname=' . DB_NAME, DB_USER, DB_PASS);
$db->setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC); 
$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
if(isset($_POST['add2cart']))
{
    if(!isset($_SESSION['cart_id']))
        $_SESSION['cart_id'] = md5(my stuff here);
    try{
        $stmt = $db->prepare("
            SELECT *
            FROM cart
            WHERE cart_id = ':cartid'
            AND sku = ':sku'
        ");
        $stmt->bindParam(':cartid', $_SESSION['cart_id'], PDO::PARAM_STR);
        $stmt->bindParam(':sku', $_POST['sku'], PDO::PARAM_STR);
        $stmt->execute();
        //print_r($stmt);
        $row = $stmt->fetch();
        var_dump($row);
    } catch(PDOException $e)
    {
        die($e->getMessage());
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T14:35:04.640

您应该删除参数名称周围的单引号。它所做的是基本上将参数名称更改为字符串文字，

```
SELECT *
FROM cart
WHERE cart_id = :cartid AND sku = :sku 
```

# postgresql - Postgresql 只加入最具体的 cidr 匹配

> ID：16172084
> 
> 赞同：2
> 
> 时间：2013-04-23T14:33:33.020
> 
> 标签：postgresql, join, cidr

我有一个表“test_networks”，它是一个网络列表，其中描述了每个网络是什么以及它所在的位置。

```
CREATE TABLE test_networks
(
  id serial PRIMARY KEY,
  address cidr,
  description text
); 
```

“地址”字段将是以下任何一项：

*   10.0.0.0/8
*   10.1.0.0/16
*   10.1.1.0/24
*   10.2.0.0/16
*   10.3.0.0/16
*   10.3.1.0/24
*   10.3.2.0/24
*   10.3.3.0/24
*   10.15.1.0/24
*   10.15.2.0/24
*   10.15.3.0/24

我还有一个表“test_systems”，其中包含系统及其属性的列表（我还有一些属性，但这些无关紧要）：

```
CREATE TABLE test_systems
(
  id serial PRIMARY KEY,
  address inet,
  owner text
); 
```

假设我的系统具有以下地址：

*   10.1.1.1
*   10.2.0.1

我想创建所有系统及其最近*网络*描述的报告（如果未找到网络，则为空描述）。如您所见，10.1.1.1 匹配多个网络，因此我只想为每个系统列出最具体的一个（即具有最高 masklen() 的那个）。示例输出为：

```
 hostaddr |   netaddr   |  description
 ----------+-------------+----------------
  10.1.1.1 | 10.1.1.0/24 | third network
  10.2.0.1 | 10.2.0.0/16 | 4th network 
```

我尝试使用此查询：

```
SELECT s.address AS hostaddr, n.address AS netaddr, n.description AS description
FROM test_systems s
LEFT JOIN test_networks n
ON s.address << n.address; 
```

但是，这会给我一个所有系统+网络对的列表，例如：

```
 hostaddr |   netaddr   |  description
----------+-------------+----------------
 10.1.1.1 | 10.0.0.0/8  | first network
 10.1.1.1 | 10.1.0.0/16 | second network
 10.1.1.1 | 10.1.1.0/24 | third network
 10.2.0.1 | 10.0.0.0/8  | first network
 10.2.0.1 | 10.2.0.0/16 | 4th network 
```

有谁知道我如何只查询每个系统的最具体的网络？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T14:45:21.397

您正在寻找“组中前 n 个”查询，在这种情况下，n = 1。您可以使用`row_number()`窗口函数执行此操作：

```
SELECT x.hostaddr, x.netaddr, x.description FROM (
  SELECT
      s.address AS hostaddr,
      n.address AS netaddr,
      n.description AS description,
      row_number() OVER (
          PARTITION BY s.address
          ORDER BY masklen(n.address) DESC
      ) AS row
  FROM test_systems s
  LEFT JOIN test_networks n
  ON s.address << n.address
) x
WHERE x.row = 1; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:09:55.650

```
SELECT distinct on (s.address)
    s.address AS hostaddr,
    n.address AS netaddr,
    n.description AS description
FROM
    test_systems s
    LEFT JOIN
    test_networks n ON s.address << n.address
order by s.address, masklen(n.address) desc 
```

# algorithm - 三角形内的最大面积

> ID：16172085
> 
> 赞同：7
> 
> 时间：2013-04-23T14:33:35.243
> 
> 标签：algorithm, math, geometry, computational-geometry

在准备比赛时，我遇到了以下有趣的问题。

你有一个三角形，边长`a, b, c`为 ，绳子长为`L`。您需要找到由具有最大表面积的绳子包围的曲面，并且它必须完全在三角形内。

所以，如果`L = a + b + c`，那么它就是三角形的面积。

`L`否则，我们知道圆的表面积最大`L.`

所以，剩下的情况是 `alfa < L < a + b + c`，其中`alfa`是内接圆的周长。

任何想法都会很棒！

`EDIT`: 我想知道我是否应该专注于某种算法来解决这个问题或试图找出一个数学公式。比赛以某种方式包含了两者的结合。边数可长达100，精度为`a,b,c,L`小数点后4位。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:35:47.187

由于圆的面积/周长最大，因此从[内切圆](http://en.wikipedia.org/wiki/Incircle_and_excircles_of_a_triangle)开始。如果 L 小于那个周长，则适当收缩。如果 L 更长，则增大 3 个弧中的任何一个使 dA/dL 最大化。我不知道是否有封闭的形式，但最大的弧将在三角形的第三个，边最接近平行。

用算法解决这个问题应该很简单。精确到小数点后 4 位，增量为 0.0001，检查每条弧线，查看单次增量中哪条弧线的 dA/dL 最大。

我在一夜之间绘制了几何图形： ![带内圆的三角形](https://i.stack.imgur.com/DOkU4.jpg) 通过平分每个角度并找到平分线的交点来构造内切圆。我已经将半角标记为“a1”（所有相关变量都有“1”）。非圆形部分的面积是两个梯形（一个用红色轮廓表示）。我们可以计算单个梯形的面积为 L1 * (m1 + R)/2 （注意当 L1、L2、L3 都为零时，这些梯形都为零，我们就得到了内接圆的面积）。圆形帽的半径为 m1，以保持与三角形的边相切。对于给定的 L1 选择，m1 = R(x1-L1)/x1。

从这里您可以轻松计算三个扇区中每个扇区的周长和面积并进行数值求解。

我不能**证明**这是最大的面积，只是这就是如何计算这个建筑的面积和周长。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T05:38:11.300

在阅读了这个问题的答案后：[https](https://math.stackexchange.com/questions/4808/why-circle-encloses-largest-area) ://math.stackexchange.com/questions/4808/why-circle-encloses-largest-area ，我同意nm，并认为最优曲线验证：

*   当它接触三角形时，曲率要么是恒定的，要么是平坦的，这意味着它由位于三角形边上的线段和圆弧组成，它们都具有相同的半径。
*   没有角度，这意味着弧与三角形边相切。

在这些条件下，解决方案由三个具有相同半径 R 的圆获得，每个圆都与三角形的两侧相切（见下文）。当 R 在 0 和内接圆的半径之间变化时，我们从三角形本身开始，到内接圆结束，三个圆都重合。曲线的长度是半径为 R 的圆的周长 + 小三角形的周长 (p)：L = 2*Pi *R + p。面积是较小三角形的面积 (a) + 一个半径为 R 的圆盘 + 其余矩形：A = Pi* R^2 + p*R + a。

![所描述的假设解决方案](https://i.stack.imgur.com/8o5Tt.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T16:45:43.930

如果绳子的周长太小或太大，答案都是微不足道的。有趣的例子是一个有 6 个顶点的形状，它是 line-arc-line-arc-line-arc。圆弧都与它们的相邻线相切，并且它们的半径相等。我没有严格的证据，但想象一个充满空气并挤压在三角形两侧之间的二维气球。

很容易表达整体形状，因此给定半径的周长；然后很容易在数字上找到相反的方向（周长到半径）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-24T16:15:02.187

..回答我自己的评论/问题，可以证明半径必须相等，

这是一个有用的公式：

![在此处输入图像描述](https://i.stack.imgur.com/31Cbt.jpg)

灰色区域 A 是

```
A = r^2 ( alpha - Pi + 2/tan(alpha/2) ) /2 
```

但更有用..弧长很简单：

```
s = 2 ( b - A/r ) 
```

从这里可以直接看出三个半径必须彼此相等：

写出绳索长度和封闭面积：

```
ropelength = trianglelength  - 2  Sum[r[i]  a[i]  ]
ropearea = trianglearea -  Sum[r[i]^2  a[i] /2 ] 
```

在哪里

```
 a[i]=( alpha[i] - Pi + 2/tan(alpha[i]/2) ) 
```

经过一些操作，最大化面积会导致所有 r[i] 相等。请注意，三个 a[i]、ropelength、trainglearea、trianglelength 都是不需要计算的常量。学究式地将 sub 求解`r[l] = f( constants, r[2],r[3] )`到第二个表达式中，并求解
`d ropearea /d r[2] = 0`和`d /d r[3] = 0`结果：

```
r =(1/2) (triangle_length - rope_length) /(Sum(1/tan(alpha[i]/2)) - Pi) 
```

（a[i] 的混乱表达式仅在最后一步被替换）最后..

```
ropearea = trianglearea - (trianglelength-ropelength)^2/(8 Sum[a[i])
     = trianglearea - (1/2)(trianglelength-ropelength)  r 
```

编辑——一个有用的身份..带有a，b，c，边长。

```
Sum(1/tan(alpha[i]/2))  = Sqrt( S^3 / ((S-a)(S-b)(S-c)) )
S = 1/2 (a+b+c)   ! S is semiperimeter not to be confused with arc length s 
```

然后可以使用上述表达式来重现内切圆的公式，

```
 rinscribed = Sqrt( ((S-a)(S-b)(S-c))  / S ) 
```

# video-streaming - 视频流中的导航，golang中的反向代理

> ID：16172090
> 
> 赞同：2
> 
> 时间：2013-04-23T14:33:56.193
> 
> 标签：video-streaming, go, reverse-proxy

我正在测试一个反向代理。主要用于通过底层 nginx 播放视频和来自其他后端服务器的流式视频。

问题是在浏览视频时。例如，通过代理使用 vlc 播放时 - 视频正常启动，但在尝试导航时停止。但是如果我直接从 nginx 播放这个视频 - 它工作正常。

我预计导航播放器会与`Range: N-`标题创建新连接，但没有新连接，只有在再次启动视频时。

**问题：**

播放视频流时，播放器如何导航？它向服务器发送什么请求？也许我在连接处理中遗漏了一些东西？

这是用于测试的非常基本的版本，它从本地 nginx 流式传输视频，（本地视频 url - `http://localhost/31285611`）：

```
package main

import (
    "net/http"
)

func main() {
    (&proxy{}).start()
}

type proxy struct {
    // ...
}

func (p *proxy) start() {
    http.HandleFunc("/play", p.connection)
    http.ListenAndServe("localhost:8040", nil)
}

func (p *proxy) connection(w http.ResponseWriter, r *http.Request) {
    disconnect := make(chan bool, 1)
    go p.send(w, r, disconnect)

    // ...

    <-disconnect
}

func (p *proxy) send(rv http.ResponseWriter, rvq *http.Request, disconnect chan bool) {

    rq, _ := http.NewRequest("GET", "http://localhost/31285611", rvq.Body)
    rq.Header = rvq.Header

    rs, _ := http.DefaultClient.Do(rq)
    for k, v := range rs.Header {
        rv.Header().Set(k, v[0])
    }
    rv.WriteHeader(http.StatusOK)

    buf := make([]byte, 1024)

    // for testing sending only first part.
    for i := 0; i < 100000; i++ {
        n, e := rs.Body.Read(buf[0:])
        if n == 0 || e != nil {
            break
        }
        rv.Write(buf[0:])
    }

    disconnect <- true

} 
```

**更新（标头转储）：**

第一个玩家连接：

```
map[User-Agent:[VLC/2.0.0 LibVLC/2.0.0] Range:[bytes=0-] Connection:[close] Icy-Metadata:[1]] 
```

在 go 中创建连接时来自 nginx 的响应：

```
map[Server:[nginx/1.3.4] Date:[Tue, 23 Apr 2013 13:29:00 GMT] Content-Type:[application/octet-stream] Content-Length:[8147855699] Last-Modified:[Tue, 21 Aug 2012 20:47:20 GMT] Etag:["5033f3d8-1e5a66953"] Content-Range:[bytes 0-8147855698/8147855699]] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T14:13:36.673

我知道它并没有真正回答你的问题（而且我还没有足够的评论点，很抱歉提供这个作为答案！）但是你是否尝试过使用 Go 内置的 http.ReverseProxy （[http://golang.org /pkg/net/http/httputil/#ReverseProxy](http://golang.org/pkg/net/http/httputil/#ReverseProxy)）？

这里似乎有一个很好的简单示例*https://groups.google.com/forum/?fromgroups=#!topic/golang-nuts/1u* [​​fEw_IEVM4](https://groups.google.com/forum/?fromgroups=#!topic/golang-nuts/1ufEw_IEVM4)我在下面稍作修改：

 *```
package main

import (
    "log"
    "net/http"
    "net/http/httputil"
    "net/url"
)

func main() {
    proxy := httputil.NewSingleHostReverseProxy(&url.URL{Scheme: "http", Host: "www.google.com", Path: "/"})

    err := http.ListenAndServe(":8080", proxy)
    if err != nil {
        log.Fatal("ListenAndServe: ", err)
    }
} 
```

看看这是否有效。

此外，在之前链接的 Google Groups 讨论中，提到了 NginX 存在分块编码问题。可能值得检查这是否相关。*

# android - 尽管调用了 onSaveInstanceState，但 OnCreate 包为空

> ID：16172097
> 
> 赞同：1
> 
> 时间：2013-04-23T14:34:05.333
> 
> 标签：android, bundle, android-lifecycle

在按下 home 并重新打开应用程序后，我正在尝试恢复我以前的状态，`Activity`所以我正在保存我需要的内容`onSaveInstanceState`：

```
protected void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);

        outState.putInt(STATE_ACTIVE_VIEW_ID, mActiveViewId);

        Log.v(TAG, this.toString() + " onSaveInstanceState");

    } 
```

那就是所谓的，但在`onCreate`里面`Bundle`总是`null`。

这是 OnCreate()：

```
@Override
public void onCreate(Bundle inState) {
    super.onCreate(inState);
    setContentView(R.layout.main);

    setMenuDrawer();

    if (inState != null) {

        int activeViewID = inState.getInt(STATE_ACTIVE_VIEW_ID);
        View activeView = findViewById(activeViewID);
        menuDrawer.setActiveView(activeView);
        switchSelectedFragment(activeView);
        Log.v(TAG, this.toString() + " onCreate " + inState.toString());

    } else {
        switchSelectedFragment(findViewById(R.id.homeView));

    }

    Log.v(TAG, this.toString() + " onCreate");

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T04:17:56.617

`onSaveInstanceState` *按下主页按钮时调用，但*除非*`onCreate`Activity 被销毁（配置更改或内存原因），否则不会再次调用。*

 *您应该能够简单地保留成员变量，以处理`onPause`/ `onResume`（这是我们实际讨论的内容）。如果您没有看到您期望的 Fragment（从 Home press 返回后），那么您遇到了不同的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-23T17:32:40.220

你必须在 onPause() 方法中完成所有的保存工作，最好像 Raghunandan 所说的那样使用 sharedPreferences 。*

# c# - 具有强类型返回类型的抽象方法

> ID：16172100
> 
> 赞同：7
> 
> 时间：2013-04-23T14:34:08.027
> 
> 标签：c#, generics, inheritance, overriding, abstract-class

考虑以下类：

```
public abstract class Animal
{
    public abstract Animal GiveBirth();
}

public class Monkey : Animal
{
    public override Animal GiveBirth()
    {
        return new Monkey();
    }
}

public class Snake : Animal
{
    public override Animal GiveBirth()
    {
        return new Snake();
    }
}

//That one doesnt makes sense.
public class WeirdHuman: Animal
{
    public override Animal GiveBirth()
    {
        return new Monkey();
    }
} 
```

我正在寻找一种方法来强制执行被覆盖`GiveBirth`方法的返回类型，以便它始终返回实际的类类型，这样就不会`WeirdHuman`产生`Monkey`.

我觉得答案是关于泛型类型，但我不知道我该怎么做。

预期结果示例：

```
public abstract class Animal
{
    public abstract /*here a way to specify concrete type*/ GiveBirth();
}

public class Monkey : Animal
{
    public override Monkey GiveBirth() //Must returns an actual Monkey
    {
        return new Monkey();
    }
} 
```

如果解释清楚，“绝对不可能”*可能是一个答案。*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T14:37:49.077

这是协变返回，C# 不支持。我每天都在感叹这件事。最好的解决方法是使用泛型返回类型并在泛型类型上指定 where 条件，但这也可能导致您在未来遇到其他具有匹配泛型参数要求的问题。

```
public abstract class Animal<TBirthType> where TBirthType : Animal<TBirthType>
{
    public abstract TBirthType GiveBirth();
}

public class Monkey<TBirthType> : Animal<TBirthType> where TBirthType : Monkey<TBirthType>
{
    public override TBirthType GiveBirth()
    {
        return new Monkey<Monkey>();
    }
} 
```

或者，如果您不需要任何进一步的继承，您可以关闭泛型。

```
public class Monkey : Animal<Monkey>
{
    public override Monkey GiveBirth()
    {
        return new Monkey();
    }
} 
```

请注意，单独的协方差仍然不足以确保不会形成行为不端的派生类型，但它允许将返回的类型指定为正在使用的类型。尽管如此，仍然没有办法将其锁定在抽象类之外。您也许可以通过在基本级别实现的方法的反射来管理运行时检查，该方法将在运行时检查类型，但这也可能非常混乱。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T14:46:56.957

你可以做这样的事情，它强制实现者`Animal<T>`实现一个`Animal<T> GiveBirth()`返回与类型参数相同类型的方法，它本身被限制为一种动物。

这不是您想要的，但您可以看到：

```
public abstract class Animal<T> where T: Animal<T>
{
    public abstract Animal<T> GiveBirth();
}

public class Monkey: Animal<Monkey>
{
    public override Animal<Monkey> GiveBirth()
    {
        return new Monkey();
    }
}

public class Snake: Animal<Snake>
{
    public override Animal<Snake> GiveBirth()
    {
        return new Snake();
    }
}

public class WeirdHuman: Animal<WeirdHuman>
{
    public override Animal<WeirdHuman> GiveBirth()
    {
        return new Monkey(); // Won't compile of course.
    }
} 
```

如果你注释掉这些`public override Animal<Monkey> GiveBirth()`方法，你会看到编译器抱怨并说：

> 错误 1 ​​'ConsoleApplication1.Monkey' 没有实现继承的抽象成员 'ConsoleApplication1.Animal.GiveBirth()'

不幸的是，您必须使用`SomeKindOfAnimal: Animal<SomeKindOfAnimal>`语法声明类，但也许这对您有用。

（[另见此线程。](https://stackoverflow.com/questions/16142620/what-does-this-parameter-type-constraint-mean/16142684#16142684)）

唉，这不太行，因为它允许你这样做：

```
public class Monkey: Animal<WeirdHuman>
{
    public override Animal<WeirdHuman> GiveBirth()
    {
        return new WeirdHuman();
    }
} 
```

换句话说，它把类型参数约束为一种动物，同时也约束返回类型`GiveBirth()`与类型参数相同；但仅此而已。在某些情况下，这已经足够了，但可能不适合您的目的。

不过，也许这种方法值得了解。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-23T15:04:35.357

据我所知，没有干净的方法可以纯粹在单个类层次结构中支持这一点。使用重复的泛型类型参数，例如

```
public class Animal<T> where T : Animal<T> { } 
```

如果您控制整个层次结构可能是可以接受的，因此可以排除像

```
public class WierdHuman<Monkey> { } 
```

您真正想要的是类似于 Haskell 的类型类，您可以在其中抽象类本身的具体类型。在 C# 中最接近的方法是定义一个实现所需功能的代理对象，然后将其传递到您需要的任何地方。

在您的情况下，这意味着创建一个用于分娩的接口，并为每种具体的动物类型实现它。

然后，需要此功能的方法需要“类型类实例”的额外参数。这些方法可以将通用动物类型限制为相同：

```
public interface ISpawn<T> where T : Animal
{
    public T GiveBirth();
}

public void Populate<T>(T parent, ISpawn<T> spawn) where T : Animal
{
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-05T08:52:42.090

如果您的**基类由于各种原因而无法泛型**，则此方法可能很有用：

```
abstract class Animal {
}
interface ICanGiveBirth<T> {
   T GiveBirth();
}
static class CanGiveBirthHelper {
   public static T GiveBirth<T>(this T v) where T: ICanGiveBirth<T> => v.GiveBirth();
}
class Monkey : Animal, ICanGiveBirth<Monkey> {
   public Monkey GiveBirth() {
      throw new NotImplementedException();
   }
}
class Snake : Animal, ICanGiveBirth<Snake> {
   public Snake GiveBirth() {
      throw new NotImplementedException();
   }
} 
```

如果您**无法向子类添加接口**，并且仍然**无法向 Base 类型添加泛型，则**此方法可能很有用：（不幸的是，您无法使 GiveBirthImpl 受保护，因为不允许辅助类位于基类中)

```
abstract class Animal {
   public abstract T GiveBirthImpl<T>() where T:Animal;
}
static class CanGiveBirthHelper {
   public static T GiveBirth<T>(this T v) where T: Animal => v.GiveBirthImpl<T>();
}
class Monkey : Animal {
   public override T GiveBirthImpl<T>() {
      throw new NotImplementedException();
   }
}
class Snake : Animal {
   public override T GiveBirthImpl<T>() {
      throw new NotImplementedException();
   }
} 
```

在这两种情况下，这都会按预期工作：

```
class Tester
{
   Monkey TestIt() => new Monkey().GiveBirth();
} 
```

# python - Python - 正则表达式 - 查找函数名称但不查找函数调用

> ID：16172103
> 
> 赞同：0
> 
> 时间：2013-04-23T14:34:11.290
> 
> 标签：python, regex

好的，所以我有一堆 C 和 C++ 代码，我需要过滤并找到函数定义。我不知道函数类型/返回值，也不知道函数定义或函数调用中的参数数量等。

到目前为止，我有：

```
import re, sys
from os.path import abspath
from os import walk

function = 'msg'
regexp = r"(" + function + ".*[^;]){"

found = False
for root, folders, files in walk('C:\\codepath\\'):
    for filename in files:
        with open(abspath(root + '/' + filename)) as fh:
            data = fh.read()
            result = re.findall(regexp, data)
            if len(result) > 0:
                sys.stdout.write('\n Found function "' + config.function + '" in ' + filename + ':\n\t' + str(result))
                sys.stdout.flush()
    break 
```

然而，这会产生一些不需要的结果。正则表达式必须是错误的，例如这些组合：

在say的所有突变中找到“msg”定义而不是“msg（）”调用：

```
void
shapex_msg (struct shaper *s)
{
  msg (M_INFO, "Output Traffic Shaping initialized at %d bytes per second",
       s->bytes_per_second);
} 
```

或者

```
void shapex_msg (struct shaper *s)
{
  msg (M_INFO, "Output Traffic Shaping initialized at %d bytes per second",
       s->bytes_per_second);
} 
```

或者

```
void shapex_msg (struct shaper *s) {
  msg (M_INFO, "Output Traffic Shaping initialized at %d bytes per second",
       s->bytes_per_second);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:47:13.630

可能类似于以下正则表达式：

```
def make_regex(name):
    return re.compile(r'\s*%s\s*\([^;)]*\)\s*\{' % re.escape(name)) 
```

测试你的例子：

```
>>> text = '''
... void
... shapex_msg (struct shaper *s)
... {
...   msg (M_INFO, "Output Traffic Shaping initialized at %d bytes per second",
...        s->bytes_per_second);
... }
... 
... void shapex_msg (struct shaper *s)
... {
...   msg (M_INFO, "Output Traffic Shaping initialized at %d bytes per second",
...        s->bytes_per_second);
... }
... 
... void shapex_msg (struct shaper *s) {
...   msg (M_INFO, "Output Traffic Shaping initialized at %d bytes per second",
...        s->bytes_per_second);
... }'''
>>> shapex_msg = make_regex_for_function('shapex_msg')
>>> shapex_msg.findall(text)
['\nshapex_msg (struct shaper *s)\n{', ' shapex_msg (struct shaper *s)\n{', ' shapex_msg (struct shaper *s) {'] 
```

它仅适用于多行定义：

```
>>> shapex_msg.findall('''int
        shapex_msg      (
int a,
int b
)  

        {'''
['\n   \tshapex_msg   \t(\nint a,\nint b\n)  \n\n\t{'] 
```

同时，使用函数调用：

```
>>> shapex_msg.findall('shapex_msg(1,2,3);')
[] 
```

请注意，您的正则表达式不起作用，因为`.*`它是贪婪的，因此它与正确的右括号不匹配。

# asp.net - 向 asp.net 添加样式表（使用 Visual Studio 2010）

> ID：16172106
> 
> 赞同：5
> 
> 时间：2013-04-23T14:34:20.823
> 
> 标签：asp.net, css, inline, navigationbar

我正在尝试将样式表添加到 asp.net Web 表单中的母版页。基本上试图为页面顶部创建一个内联导航菜单。我有问题。我已经创建了样式表（如果这是一个 html 站点，我将创建相同的方式）并将它放在您在下面看到的目录中。我看不到下面的代码如何显示与样式表的任何关系。

就像在 html 中一样，我会

*   家
*   关于
*   接触

然后我的样式表看起来像这样......

```
ul {
list-style-type:none;
margin:0;
padding:0;
}

li {
display:inline;
padding:20px;
} 
```

CSS 会让它内联显示（在顶部）。但我不知道该去哪里。

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="MasterPage.master.cs" Inherits="MasterPage" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>AR Toolbox</title>
<asp:ContentPlaceHolder id="Stylesheets" runat="server">
    <link rel="Stylesheet" href="/css/master.css" type="text/css" />
</asp:ContentPlaceHolder>
<style type="text/css">
    .style1
    {
        width: 100%;
    }
    .style2
    {
        height: 459px;
    }
    .style3
    {
        width: 100%;
        height: 100%;
    }
    .style6
    {
        height: 79px;
    }
    .style7
    {
        width: 345px;
        height: 73px;
    }
</style>
</head>
<body>
<form id="form1" runat="server">
<table class="style1">
    <tr>
        <td style="background-color: #A3A3A3; color: #FFFFFF; font-family: 'Arial Black'; font-size: large; font-weight: bold;" 
            class="style6">
            <asp:Menu ID="Menu1" runat="server">
                <Items>
                    <asp:MenuItem Text="Home" Value="Home"></asp:MenuItem>
                    <asp:MenuItem Text="About" Value="About"></asp:MenuItem>
                    <asp:MenuItem Text="Compliance" Value="Compliance">
                        <asp:MenuItem Text="Item 1" Value="Item 1"></asp:MenuItem>
                        <asp:MenuItem Text="Item 2" Value="Item 2"></asp:MenuItem>
                    </asp:MenuItem>
                    <asp:MenuItem Text="Tools" Value="Tools"></asp:MenuItem>
                    <asp:MenuItem Text="Contact" Value="Contact"></asp:MenuItem>
                </Items>
            </asp:Menu>
        </td>
    </tr>
    <tr>
        <td style="background-color: #A3A3A3; color: #FFFFFF; font-family: 'Arial Black'; font-size: large; font-weight: bold;" 
            class="style6">
            <img alt="South University'" class="style7" 
                src="file:///C:/Users/jnewnam/Documents/Visual%20Studio%202010/WebSites/WebSite1/img/suo_n_seal_hor_pantone.png" /></td>
    </tr>
    <tr>
        <td class="style2">
            <table class="style3">
                <tr>
                    <td>
                        &nbsp;</td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td style="color: #FFFFFF; background-color: #A3A3A3">
            This is the footer.</td>
    </tr>
</table>
</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T14:38:06.350

这里有几件事。

首先，你在 3 个地方定义你的 CSS！

在线，头部和外部。我建议你只选择一个。我要向外部提出建议。

我建议您从 ASP 表单中更新您的代码

```
<td style="background-color: #A3A3A3; color: #FFFFFF; font-family: 'Arial Black'; font-size: large; font-weight: bold;" 
        class="style6"> 
```

对此：

```
<td  class="style6"> 
```

然后也更新你的CSS

```
.style6
    {
        height: 79px; background-color: #A3A3A3; color: #FFFFFF; font-family: 'Arial Black'; font-size: large; font-weight: bold;
    } 
```

这将删除内联。

现在，将它从 webForm 的头部移动。

```
<%@ Master Language="C#" AutoEventWireup="true" CodeFile="MasterPage.master.cs" Inherits="MasterPage" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>AR Toolbox</title>
    <link rel="Stylesheet" href="css/master.css" type="text/css" />
</head>
<body>
<form id="form1" runat="server">
<table class="style1">
    <tr>
        <td class="style6">
            <asp:Menu ID="Menu1" runat="server">
                <Items>
                    <asp:MenuItem Text="Home" Value="Home"></asp:MenuItem>
                    <asp:MenuItem Text="About" Value="About"></asp:MenuItem>
                    <asp:MenuItem Text="Compliance" Value="Compliance">
                        <asp:MenuItem Text="Item 1" Value="Item 1"></asp:MenuItem>
                        <asp:MenuItem Text="Item 2" Value="Item 2"></asp:MenuItem>
                    </asp:MenuItem>
                    <asp:MenuItem Text="Tools" Value="Tools"></asp:MenuItem>
                    <asp:MenuItem Text="Contact" Value="Contact"></asp:MenuItem>
                </Items>
            </asp:Menu>
        </td>
    </tr>
    <tr>
        <td class="style6">
            <img alt="South University'" class="style7" 
                src="file:///C:/Users/jnewnam/Documents/Visual%20Studio%202010/WebSites/WebSite1/img/suo_n_seal_hor_pantone.png" /></td>
    </tr>
    <tr>
        <td class="style2">
            <table class="style3">
                <tr>
                    <td>
                        &nbsp;</td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td style="color: #FFFFFF; background-color: #A3A3A3">
            This is the footer.</td>
    </tr>
</table>
</form>
</body>
</html> 
```

现在，在一个名为 master.css 的新文件中（在您的 css 文件夹中）添加

```
ul {
list-style-type:none;
margin:0;
padding:0;
}

li {
display:inline;
padding:20px;
}
.style1
{
    width: 100%;
}
.style2
{
    height: 459px;
}
.style3
{
    width: 100%;
    height: 100%;
}
.style6
{
    height: 79px; background-color: #A3A3A3; color: #FFFFFF; font-family: 'Arial Black'; font-size: large; font-weight: bold;
}
.style7
{
    width: 345px;
    height: 73px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-16T14:48:27.507

在此处添加您的风格：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site.master.cs" Inherits="BSC.SiteMaster" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head runat="server">
    <title></title>
    <link href="~/Styles/Site.css" rel="stylesheet" type="text/css" />
    <link href="~/Styles/NewStyle.css" rel="stylesheet" type="text/css" />

    <asp:ContentPlaceHolder ID="HeadContent" runat="server">
    </asp:ContentPlaceHolder>
</head> 
```

然后在页面中：

```
<asp:Table CssClass=NewStyleExampleClass runat="server" > 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-23T14:20:07.057

您唯一需要做的就是在 cshtml 文件的头部添加以下行：

```
 @Styles.Render("~/Content/Main.css") 
```

整个头部看起来像这样：

```
 <head>
         <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
         <title>HTML Page</title>
         @Styles.Render("~/Content/main.css")
    </head> 
```

希望能帮助到你！！

# c# - sql server 2008 r2 中的当前月份和年份

> ID：16172109
> 
> 赞同：6
> 
> 时间：2013-04-23T14:34:27.273
> 
> 标签：c#, asp.net, sql-server-2008

我目前是 C# & SQL 的新手。

如何在 SQL Server 2008 R2 中获取当前月份和年份？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-23T14:38:41.033

SQL 服务器

```
SELECT GETDATE() AS CurrentDateTime
     , YEAR(GETDATE()) AS CurrentYear
     , MONTH(GETDATE()) AS CurrentMonth 
```

C＃

```
var now = DateTime.Now;
var currentYear = now.Year;
var currentMonth = now.Month; 
```

# c# - 带有浮点数的除法在 C# 中没有给出预期的结果

> ID：16172112
> 
> 赞同：-1
> 
> 时间：2013-04-23T14:34:33.337
> 
> 标签：c#, double, division

我在 C# 中划分数字时遇到问题。

请参阅我在 C# 中的代码进行除法

```
double openRate = 0,

long a=542;
long b=4795;

openRate =(a/b)*100 
```

这给`11.303..`了我的计算器。但是c#给了我 `0.0`

可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:38:30.680

`a`和`b`是整数并使用`operator/`of`long`进行除法，得到整数除法。

> 542 / 4795 = 0 ~~.113~~

在此之后，它们乘以 100，它也是一个整数。

> 0 * 100 = 0

最后但并非最不重要的一点是（仍然是整数）结果 get 转换为`double`. 你想写的是这样的：

```
openRate = ((double)a / (double)b) * 100.0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T14:43:17.167

当你写

```
long a = 542;
long b = 4795; 
```

因为因为`a / b`被计算为*整数值*；任何小数部分都被删除了。所以在这一点上`a / b`是不相等的。`0``0,113..`

来自小学数学；

```
0 * 100 = 0 
```

您的计算器可能使用浮动除法，因此实际上它是这样计算的；

```
double openRate = 0;

long a = 542;
long b = 4795;

openRate =((double)a / b) * 100; // 11.303... 
```

# crystal-reports - SAP Crystal Reports Viewer 不显示在浏览器中

> ID：16172114
> 
> 赞同：4
> 
> 时间：2013-04-23T14:34:42.930
> 
> 标签：crystal-reports, report, viewer

我拥有一个带有框架 4.5 的 ASP.NET Web 项目。为 VS2012 Crystal Reports Developer 安装并实现了一个 SAP 报表。

在本地报告中，它在浏览器（Chrome、Firefox、IE）中正常工作，并且数据在正确的出口中。现在，在发布时（在另一台服务器上），我们做的第一件事是安装相同版本的 SAP，以便有必要的库等。

我遇到的问题是 Report Viewer 的块，我的意思是，repot 容器是什么，没有显示在浏览器中，打开这个嵌入的窗口，但在 Report Viewer 中没有显示任何内容，报告看起来会更少.

认为可能是数据错误或其他原因，我试图更改报告并留一个空白，其中显示的只是文本，没有连接或类似的东西，并删除后面代码中不需要的代码，我刚刚停止加载报告。

在新的本地作品中，但在网络上发布，报告查看器仍然是

任何人都可以帮我一点吗？我正在寻找有关它的一些信息，但我在相关论坛中发现，没有看到报告，但没有看到报告查看器。

非常感谢您提前。

PS：我检查了服务器日志是否有任何问题或 Asp.Net Crystal Reports 的错误，没有留下任何东西。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-12-07T11:00:31.633

我有微笑问题并找到了解决方案。

`Resource-Uri`我认为从默认的资源中查找用于格式化水晶报表的资源存在一些问题。

为了正确格式化`C:\inetpub\wwwroot\aspnet_client\system_web\4_0_30319\crystalreportviewers13`将此文件夹复制到您的项目中。

并将这些行添加到您的 web.config 文件中

## 

```
<configSections>
<sectionGroup name="businessObjects">
  <sectionGroup name="crystalReports">
    <section name="rptBuildProvider" type="CrystalDecisions.Shared.RptBuildProviderHandler, CrystalDecisions.Shared, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304, Custom=null" />
       <section name="crystalReportViewer" type="System.Configuration.NameValueSectionHandler" />
  </sectionGroup>
</sectionGroup>
  </configSections> 
```

## 

```
<businessObjects>
  <crystalReports>
    <rptBuildProvider>
      <add embedRptInResource="true" />
    </rptBuildProvider>
    <crystalReportViewer>
          <add key="ResourceUri" value="/crystalreportviewers13" />
  </crystalReportViewer>
  </crystalReports>
</businessObjects> 
```

[检查这个](http://social.msdn.microsoft.com/Forums/en-US/ef56f72b-7ede-47d8-ba9e-9e63b9ac0203/bobj-is-undefined?forum=vscrystalreports)

这将对您有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-06-06T06:26:47.117

解决了.... 100 % 会工作的。请按照以下两个步骤操作：

1.更新应用程序文件夹。

> “C:\inetpub\wwwroot\aspnet_client\system_web\4_0_30319\crystalreportviewers13”进入您的应用程序根文件夹 asp 下面的快照。 [![在此处输入图像描述](https://i.stack.imgur.com/VH798.png)](https://i.stack.imgur.com/VH798.png)

2.  通过以下代码更新 Web.Config 文件。

[![在此处输入图像描述](https://i.stack.imgur.com/YsNY2.png)](https://i.stack.imgur.com/YsNY2.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-03T10:51:15.477

将文件夹***“C:\inetpub\wwwroot\aspnet_client\system_web\4_0_30319\crystalreportviewers13”***复制到您的应用程序根文件夹后，请务必复制并粘贴给定代码：

```
<configSections>
<sectionGroup name="businessObjects">
  <sectionGroup name="crystalReports">
    <section name="rptBuildProvider" type="CrystalDecisions.Shared.RptBuildProviderHandler, CrystalDecisions.Shared, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304, Custom=null" />
       <section name="crystalReportViewer" type="System.Configuration.NameValueSectionHandler" />
  </sectionGroup>
</sectionGroup>
  </configSections>

<businessObjects>
  <crystalReports>
    <rptBuildProvider>
      <add embedRptInResource="true" />
    </rptBuildProvider>
    <crystalReportViewer>
          <add key="ResourceUri" value="/crystalreportviewers13" />
  </crystalReportViewer>
  </crystalReports>
</businessObjects> 
```

**在 web.config 文件中的< 配置 >**标记之后。对我来说，任何其他地方都不起作用并生成错误消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-20T21:59:25.947

对我来说，当我将文件复制到 4_0_30319 文件夹中时，网页开发者工具（F12 然后控制台选项卡）显示服务器正在寻找 root/aspnet_client/system_web/4_6_1069 文件夹。我重命名了文件夹和 BAM！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-18T12:44:00.223

我相信您需要将其部署为 .Net 4，而不是 .Net 4.5。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-23T10:16:19.237

对于我们这些运行从 .Net 4.0 或更低版本到 4.5+ 的迁移项目的人，我进行了观察。似乎如果包含查看器的页面位于子目录中，那么图像 url 是相对于该页面而不是 Web 应用程序的根目录生成的。例如，如果您的页面是 /gl/accounts.aspx，则图像可能是 /gl/crystalimagehandler.aspx 等 解决此问题的快速方法是将处理程序映射更改为以 crystalimagehandler.aspx 结尾的通配符，或将以下代码放入 Global .asax

```
protected void Application_BeginRequest(object sender, EventArgs e)
        {
            var p = Request.Path.ToLower().Trim();
            if (p.EndsWith("/crystalimagehandler.aspx") && p!= "/crystalimagehandler.aspx")
            {
                var fullPath=Request.Url.AbsoluteUri.ToLower();
                var index = fullPath.IndexOf("/crystalimagehandler.aspx");
                Response.Redirect(fullPath.Substring(index));
            }
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-31T14:37:07.073

我有一种情况，我使用连接“SQL Server Native Client 11.0”创建了一些 Crystal Reports，而一些使用连接“Microsoft OLE DB Provider for SQL Server”创建了一些 Crystal Reports。两者都在运行 IIS 6 的旧服务器上工作。但是，当我们迁移到运行 IIS 8.5 的新服务器时，一些报表按预期工作，而另一些则显示一个空的 Crystal Reports 查看器。经过 4 到 5 天的努力并尝试了我能想到的一切，我终于比较了有效报告与无效报告之间的所有内容。我发现的是使用“Microsoft OLE DB Provider for SQL Server”连接的报告。一旦我做了这个改变，报告就完美地服务了。

# asp.net - 将 Web 应用程序迁移到 Azure 的难易程度如何？

> ID：16172116
> 
> 赞同：-2
> 
> 时间：2013-04-23T14:34:44.030
> 
> 标签：asp.net, asp.net-mvc, azure

我几乎完成了 MVC 4 和 EF 5 (.net 4.5) 的开发。我需要将它部署在 azure 上。我可以简单地部署它而不修改我的代码吗？或者该应用程序必须专门为 azure 开发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:26:48.867

这实际上取决于您是要使用 Web 角色还是要使用 Azure 托管站点。如果要使用 Web 角色，则需要添加一个 Azure 发布项目，该项目创建 XML 文件以配置 Web 角色以供使用（主机标头、访问密钥、操作系统版本等）。

至于您的实际代码，不，azure 只是 IIS 的一个托管实例（在大多数情况下），任何典型的应用程序都应该毫无问题地运行。但是，如果您计划使用 SQL Azure，那么它与您需要解决的独立 SQL 之间存在一些差异。

顺便说一下，MSDN 上有很多关于 azure 托管和迁移的资源，这里有一些可以帮助您入门。

[http://msdn.microsoft.com/en-us/library/windowsazure/dn194221.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/dn194221.aspx)

[http://msdn.microsoft.com/en-us/library/windowsazure/dn194225.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/dn194225.aspx)

# linux - 每个 dma_map_single 调用是否都需要相应的 dma_unmap_single？

> ID：16172118
> 
> 赞同：5
> 
> 时间：2013-04-23T14:34:50.183
> 
> 标签：linux, linux-kernel, linux-device-driver

我正在将大型代码库移植到 Linux 内核设备驱动程序。ASIC 使用大量的 DMA 通道。

我用 .kmalloc 内存`GFP_KERNEL|GFP_DMA`。在启动 DMA 之前，我使用 dma_map_single 获取硬件（物理）内存地址以提供给硬件。（也从 dcache 刷新/使内存无效？）一旦 DMA 完成，我有时需要 CPU 访问数据，但不经常。在通过代码访问数据之前，我会执行 dma_unmap_single 以避免缓存一致性问题。

在我不需要 CPU 访问的情况下，我还需要调用`dma_unmap_single`吗？我应该`dma_unmap_single`每个指针`dma_map_single`吗？是否`dma_map_single`消耗`dma_unmap_single`将释放的资源（例如，表条目）？

DMA-API.txt 并不清楚良好的 DMA 内存卫生。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T21:57:58.720

与`dma_map_single`您一起映射内存以进行 DMA 传输。您获得指向内存的物理指针，因此设备可以 DMA 到该地址。

随着`dma_unmap_single`您取消映射上面映射的内存。您应该在转帐结束时执行此操作。

您可以*映射*一个内存区域，并将其用于多个 DMA 传输，然后在作业完成后*取消映射。*每次要访问 DMA 内存时，都必须对其进行同步。如果设备要访问内存，你应该这样做`dma_sync_single_for_device`；如果主机要访问内存，你应该这样做`dma_sync_single_for_cpu`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-04T00:07:21.020

dma_map api 可能会分配反弹缓冲区，在这种情况下，您需要调用 dma_unmap 函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-16T13:33:46.007

**简短的回答：**

是的。您应该`dma_unmap_single`使用映射的每个缓冲区`dma_map_single`。

**长答案：**

也是的。
您应该`dma_unmap_single`在每个 DMA 事务结束时调用。

但由于这`dma_map_single / dma_unmap_single`是一项昂贵的操作，有时我们可能更喜欢（当数据包不太大时）重用 DMA 映射缓冲区，因此我们不是`dma_unmap_single`在 DMA 事务结束时调用，而是调用`dma_sync_single_for_cpu`，然后从将 DMA 映射的缓冲区放入其他缓冲区，然后调用`dma_sync_single_for_device`，因此现在我们可以重用已经 DMA 映射的缓冲区，而无需在下一次 DMA 事务之前取消映射并重新映射它。

我猜想不同架构之间数据包变化的阈值应该被测量。

```
measure_time(dma_sync_single_for_cpu + memcpy(packet_size) + dma_sync_single_for_device) 
>?<
measure_time(dma_unmap_single + dma_map_single) 
```

**简短的例子：**

```
 if (frame_len < FRAME_LEN_THRESHOLD) {            
        skb = netdev_alloc_skb_ip_align(priv->dev, frame_len);
        if (unlikely(!skb)) {
            printk("packet dropped\n");
            continue;
        }

        dma_sync_single_for_cpu(priv->device, rx_skbuff_dma[entry],                                   
                                frame_len, DMA_FROM_DEVICE);

        // same as memcpy
        skb_copy_to_linear_data(skb, rx_skbuff[entry]->data, frame_len);

        dma_sync_single_for_device(priv->device, rx_skbuff_dma[entry],
                                   frame_len, DMA_FROM_DEVICE);

        /* now we can reuse rx_skbuff_dma[entry]. 
           no need to call dma_unmap_single */                           
    } else {
        skb = rx_skbuff[entry];
        if (unlikely(!skb)) {
            printk("packet dropped\n");
            continue;
        }

        rx_skbuff[entry] = NULL;

        dma_unmap_single(priv->device, rx_skbuff_dma[entry],
                         priv->dma_buffer_size, DMA_FROM_DEVICE);

        /* if we want to use rx_skbuff_dma[entry] for another DMA transaction, 
           we will need to realocate a buffer and call dma_map_single */                 
    } 
```

# c# - linq to xml 不返回任何结果可能的命名空间问题？

> ID：16172123
> 
> 赞同：0
> 
> 时间：2013-04-23T14:34:56.690
> 
> 标签：c#, xml, linq, xelement

这是我的 XML 文档的前几行：

```
<?xml-stylesheet type="text/xsl" href="/3.0/style/exchange.xsl"?>
<ops:world-patent-data xmlns="http://www.epo.org/exchange" xmlns:ops="http://ops.epo.org" xmlns:xlink="http://www.w3.org/1999/xlink">
<ops:meta name="elapsed-time" value="83" />
<exchange-documents>
<exchange-document system="ops.epo.org" family-id="34916979" country="EP" doc-number="1726228" kind="A1">
  <bibliographic-data>
    <publication-reference>
      <document-id document-id-type="docdb">
        <country>EP</country>
        <doc-number>1726228</doc-number>` 
```

我正在尝试使用以下代码提取文档编号：

```
 public class biblio
    {
        public string appNumber { get; set; }
    }

    XElement xDoc = XElement.Load(@"pathToMyXml.xml");
        XNamespace xn = "http://ops.epo.org";
        var bib = from exchange in xDoc.Descendants(xn + "exchange-document")
                  where exchange.Attribute("kind").Equals("A1")
                  select new biblio
                  {
                      appNumber = exchange.Element("doc-number").Value
                  }; 
```

但是，这不会返回任何结果。

我哪里错了？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:36:59.077

的命名空间`doc-number`是`http://www.epo.org/exchange`. 它是从根节点继承而来的。您需要在查询中指定。此外，`doc-number`is 不是`exchange-document`. 它是一个后代。

```
XNamespace d = "http://www.epo.org/exchange";
var bib = from exchange in xDoc.Descendants(xn + "exchange-document")
          where (string)exchange.Attribute("kind") == "A1"
          select new biblio
          {
              appNumber = (string)exchange.Descendant(d + "doc-number")
          }; 
```

请注意，我更改`exchange.Attribute("kind").Equals("A1")`为`(string)exchange.Attribute("kind") == "A1"`和。`exchange.Descendant(d + "doc-number").Value``(string)exchange.Descendant(d + "doc-number")`

`NullReferenceException`如果属性或后代不存在，这会阻止s 。

# java - 关闭 GUI，但主程序应该继续运行并打开一个新的

> ID：16172125
> 
> 赞同：0
> 
> 时间：2013-04-23T14:35:01.083
> 
> 标签：java, swing

我正在尝试实现以下目标：显示登录窗口，然后从工厂确定`GUIclass`要打开的内容（例如`admin`/ `dev`/ `tester`）。

我无法弹出第二个窗口；我尝试使用 dispose 它关闭程序但不运行主程序到最后。

**主要的：**

```
public static void main(String[] args){
        LoginGui loginGuiWindow = null;
        DeveloperGui devGui = null;
        TesterGui tesGui = null;
        UserCntrl uc = new UserCntrl();
        try {
            loginGuiWindow = new LoginGui(uc);
        } catch (Exception e) {
            e.printStackTrace();
        }
        System.out.print("Checking instance of: ");
        if(loginGuiWindow.loggingResult > 0){
            System.out.print("Checking instance of: ");
            if (uc.user instanceof Developer) {
                System.out.println("is instanceOf developer");
                devGui = new DeveloperGui(uc);
            }
            if (uc.user instanceof Tester ) {
                System.out.println("is instanceOf tester");
                tesGui = new TesterGui(uc);
            }
        }
    } 
```

**登录界面：**

```
btnNewButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                int res;
                String nick = textUser.getText();
                String pass = textPassword.getText();
                if((res = uc.handleLogin(nick, pass)) > 0){
                    loggingResult = res;
                    uc.handleUi(res);
                    frame.setVisible(false);
                    frame.dispose();
                }
                else{
                    JOptionPane.showMessageDialog(frame,
                        "Wrong username or password.",
                        "Logging error",
                        JOptionPane.PLAIN_MESSAGE);
                }
            }
        }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:41:51.040

当您显示窗口时，它不是阻塞调用，请在显示之前尝试 setModal(true)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:38:44.067

确保 LoginGui 的对话框是模态的。

如果不是，控制将在使其可见后返回到您的原始方法。loggingResult 永远不会 > 0，因此“检查实例”永远不会运行。然后，当用户最终登录时，该代码已经运行，并且没有任何反应。

使对话框模态本质上将在您打开对话框的行上“暂停”。当对话框关闭时，控制将从那里恢复，这就是你想要的（在这种情况下）

# excel - 使用公式选择图表数据

> ID：16172131
> 
> 赞同：0
> 
> 时间：2013-04-23T14:35:24.063
> 
> 标签：excel, excel-formula

我有一个包含许多不同测量值和参数的大型数据表。我正在尝试创建许多基于参数组织数据系列的图表。例如，如果我有这样的数据：

```
    Xval Yval ParA ParB
    22 5 10 0.25
    27 7 10 0.5
    26 6 20 0.25
    25 8 20 0.5

```

我可能想创建两个图表 - 一个为每个 ParA 值提供一个系列，另一个为每个 ParB 值提供一个系列。我想要做的是能够在论坛上定义系列数据，比如（sudocode）

```
Series1x = Xval, IF(ParA==10)
Series1y = Yval, IF(ParA==10)
Series2x = Xval, IF(ParA==20)
Series2y = Yval, IF(ParA==20) 
```

这样我就可以继续按我喜欢的方式进行排序，并且不会更改图表。我知道我可以 F9 将所选数据转换为原始数字，但我希望能够在多个数据集上重用系列选择。

有谁知道这在 Excel 中是否可行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:03:41.253

这里有一些东西可以帮助您入门。每次对数据进行排序/重新排序时，您都必须运行宏“UpdateChart”，但这似乎对我有用。

我`Names`在宏中创建了一些，然后将系列值和 XValues 设置为这些范围，尽管这并不是绝对必要的。

![截图](https://i.stack.imgur.com/vgj1Q.jpg)

```
Sub UpdateChart()
    Dim cht As Chart
    Dim srs As Series
    Dim s1xVals As Range
    Dim s1Vals As Range
    Dim s1Test As Double
    Dim s2Test As Double
    Dim nmAddress As String
    Dim nm1 As Name
    Dim nm2 As Name
    Dim parAVals As Range

    Set parAVals = GetRange("Define the ParA range?")

    Set s1xVals = GetRange("X Values?")
    Set s1Vals = GetRange("Y Values?")
    s1Test = Application.InputBox("What filter value for ParA?", "Series 1 Filter")
    s2Test = Application.InputBox("What filter value for ParA?", "Series 2 Filter")

    'Get the address of all cells matching the filter rule for series 1.'
    nmAddress = GetAddress(s1xVals, parAVals, s1Test)

    'Add the name to the workbook:'
    ActiveWorkbook.Names.Add Name:="Srs1_XValues", RefersTo:=Range(nmAddress), Visible:=True
    'Repeat for the Y Values'
    nmAddress = GetAddress(s1Vals, parAVals, s1Test)
    ActiveWorkbook.Names.Add Name:="Srs1_YValues", RefersTo:=Range(nmAddress), Visible:=True

    'Repeat for series 2:'
    nmAddress = GetAddress(s1xVals, parAVals, s2Test)
    ActiveWorkbook.Names.Add Name:="Srs2_XValues", RefersTo:=Range(nmAddress), Visible:=True
    nmAddress = GetAddress(s1Vals, parAVals, s2Test)
    ActiveWorkbook.Names.Add Name:="Srs2_YValues", RefersTo:=Range(nmAddress), Visible:=True

    Set cht = ActiveSheet.ChartObjects(1).Chart '## Modify as needed.'

    'remove any existing data in the chart, or modify as needed.'
    For Each srs In cht.SeriesCollection
        srs.Delete
    Next

    'Add the first series:'
    Set srs = cht.SeriesCollection.NewSeries
        srs.XValues = Range("srs1_XValues")
        srs.Values = Range("srs1_YValues")
        srs.Name = "Series 1 Name"          '## modify as needed.'

    'Add the second series:'
    Set srs = cht.SeriesCollection.NewSeries
        srs.XValues = Range("srs2_xValues")
        srs.Values = Range("srs2_YValues")
        srs.Name = "Series 2 Name"          '## modify as needed.'

End Sub

Function GetAddress(srsVals As Range, filterVals As Range, filterCriteria As Double)

    Dim cl As Range
    Dim c As Long: c = 1
    Dim tmpAddress As String

    For Each cl In filterVals
        If cl.Value = filterCriteria Then
            Debug.Print srsVals.Cells(c).Value
            'Create a string value of cell address matching criteria'
            If tmpAddress = vbNullString Then
                tmpAddress = srsVals.Cells(c).Address
            Else:
                tmpAddress = tmpAddress & "," & srsVals.Cells(c).Address
            End If
        End If
        c = c + 1
    Next

    GetAddress = tmpAddress

End Function

Private Function GetRange(msg As String) As Range

    Set GetRange = Application.InputBox(msg, Type:=8)

End Function 
```

**修订**

当返回超过 255 个字符的字符串时，上述方法失败，无法将地址分配给 a`Name`或系列。

这是一个不使用的修改版本`Names`，它只是将过滤后的分数收集到一个数组中，并使用这些*值*来定义系列。

与上述解决方案一样，您必须在任何时候更改数据时运行它。

```
Sub UpdateChartNoNames()
    Dim cht As Chart
    Dim srs As Series
    Dim s1xVals As Range
    Dim s1Vals As Range
    Dim s1Test As Double
    Dim s2Test As Double
    Dim parAVals As Range

    Set parAVals = GetRange("Define the ParA range?")
    Set s1xVals = GetRange("X Values?")
    Set s1Vals = GetRange("Y Values?")

    '## Alternatively, you could set these ranges without using the inputbox:'
    'Set parAvals = Range("C2:C300")    '
    'Set s1XVals = Range("A2:A300")     '
    'Set s1Vals = Range("B2:B300")      '

    s1Test = Application.InputBox("What filter value for ParA?", "Series 1 Filter")
    s2Test = Application.InputBox("What filter value for ParA?", "Series 2 Filter")

    Set cht = ActiveSheet.ChartObjects(1).Chart '## Modify as needed.'

    'remove any existing data in the chart, or modify as needed.'
    For Each srs In cht.SeriesCollection
        srs.Delete
    Next

    'Add the first series:'
    Set srs = cht.SeriesCollection.NewSeries
        srs.XValues = GetValues(s1xVals, parAVals, s1Test)
        srs.Values = GetValues(s1Vals, parAVals, s1Test)
        srs.Name = "Series 1 Name"          '## modify as needed.'

    'Add the second series:'
    Set srs = cht.SeriesCollection.NewSeries
        srs.XValues = GetValues(s1xVals, parAVals, s2Test)
        srs.Values = GetValues(s1Vals, parAVals, s2Test)
        srs.Name = "Series 2 Name"          '## modify as needed.'

End Sub

Function GetValues(srsVals As Range, filterVals As Range, filterCriteria As Double) As Variant

    Dim cl As Range
    Dim c As Long: c = 0
    Dim tmpVar As Variant

    ReDim tmpVar(0)
    For Each cl In filterVals
        If cl.Value = filterCriteria Then
            'Debug.Print srsVals.Cells(c).Value'
            'Create a string value of cell address matching criteria'
            ReDim Preserve tmpVar(c)
            tmpVar(c) = srsVals.Cells(c).Value
            c = c + 1
        End If
    Next

    GetValues = tmpVar

End Function

Private Function GetRange(msg As String) As Range

    Set GetRange = Application.InputBox(msg, Type:=8)

End Function 
```

# python - Python Bottle Micro-Web 框架

> ID：16172137
> 
> 赞同：0
> 
> 时间：2013-04-23T14:35:39.330
> 
> 标签：python, web, frameworks, bottle

好的，所以我访问了[http://bottlepy.org/docs/dev/](http://bottlepy.org/docs/dev/)网站，并尝试按照他们的说明来包含bottle.py 框架，并进行他们在网站上的小测试Web 服务测试。

我遇到的问题是python脚本无法识别“从瓶子导入路线，运行，模板”，所以代码不执行。我找不到任何东西来展示如何正确包含瓶子框架。

我去了 YouTube，在 StackOverflow 上发布了多个帖子，但我不确定自己做错了什么。

一些信息：我将 Eclipse 与 PyDev 一起使用，并且我在 Windows 7 64 位上运行。另外，我用其他语言（Java、C#、Objective-C）编写，但我是 Python 新手，所以也许我犯了一个新手错误......？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:40:06.603

您需要安装 Botte 软件包。引用来自[Bottle 网站](http://bottlepy.org/docs/dev/)的“下载和安装”部分：

> [通过PyPi](http://pypi.python.org/pypi/bottle) ( )安装最新的稳定版本`easy_install -U bottle`或将[bottle.py](https://github.com/defnull/bottle/raw/master/bottle.py) (unstable) 下载到您的项目目录中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-25T22:51:00.703

如果`easy_install bottle`不起作用，请尝试`pip install bottle`.

# javascript - 是否有比骨干 js 开发速度更快的替代方案？/ 骨干替代品

> ID：16172140
> 
> 赞同：0
> 
> 时间：2013-04-23T14:35:50.060
> 
> 标签：javascript, backbone.js

我已经开发骨干应用程序 2 个月了，我必须说这个框架很棒。然而，当我将骨干 js 的开发速度与 Rails/Ruby Web 应用程序进行比较时，我觉得带有骨干的 javascript 需要花费太多时间来开发。你知道是否存在像 rails 一样工作的主干替代品？我的意思是我正在寻找一个类似于 ruby​​ 的 rails 的 javascript 框架（生成控制器、模型、视图等的命令）。

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:39:15.323

这是一个有点宽泛的问题，但是是的，有**大量**的 JS 框架。[Ember](http://emberjs.com/)似乎是新的热点（Yehuda Katz 是核心团队的成员，所以你会在那里找到一些受到 Rails 启发的爱）。它是结构化的（与许多随心所欲的 JS 框架不同），并且最近获得了很大的动力。

据我所知，ember 不包含用于以您想要的方式生成视图的 CLI/实用程序。有一个第三方插件[Ember Tools](https://github.com/rpflorence/ember-tools)可能与您想要的类似。

要查看其他框架的列表和一些很好的示例，请查看[MVC](http://todomvc.com/)

# c - 文件读取错误

> ID：16172146
> 
> 赞同：0
> 
> 时间：2013-04-23T14:36:00.390
> 
> 标签：c

当我正在阅读一个金额以“\n”分隔的文件时。它的代码是：

```
while(fscanf(fp,"%llu",&amt) == 1)
 {
  fscanf(fp,"%ld",&amt);
  printf("\n %d",i);
  printf("   %ld",amt);
  t_amt=t_amt+amt;
  i++;
 } 
```

问题是如果这个数字是

99000 100 1000 123 456 12000 6000 780000

然后程序打印

```
1 100
2 123
3 12000
4 780000 
```

问题：

1.  它正在跳过一些数字。请帮我纠正错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T14:37:51.007

> 它在重复最后一个数字。请帮我纠正错误。

[`feof()`](http://en.cppreference.com/w/c/io/feof)直到尝试读取文件末尾之后才设置。当读取最后一个值时，下一次调用[`fscanf()`](http://en.cppreference.com/w/c/io/fscanf)失败而`amt`保持不变。立即检查结果`fscanf()`：

```
/* Returns number of assignments made. */
while(fscanf(fp," %llu",&amt) == 1)
{
} 
```

> 此外，我将 amt 声明为 unsigned long long 以存储正值。范围从 1 到 9999999。请告诉我要用于此目的的值或数据类型。

要确定整数类型的范围，请参见头限制.h 中定义的宏[、](http://en.cppreference.com/w/c/types/limits)、`INT_MAX/INT_MAX`、`LONG_MIN/LONG_MAX`和`LLONG_MIN/LLONG_MAX`，但`UINT_MAX`标准保证（来自C99 标准*的整数类型的第 5.2.4.2.1*节）足以存储所需值的范围：`ULONG_MAX``ULLONG_MAX``long`

 **   long int LONG_MIN 类型的对象的最小值 -2147483647 // -(231-1)
*   long int LONG_MAX 类型对象的最大值 +2147483647 // 231-1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:57:14.180

您在尝试读取另一个值**之前**检查了 !feof(fp) ，因此对于最后一次迭代，没有更多数据要读取，但您也没有到达文件的末尾 - 再次尝试读取，失败，并且值**amt**的值与上一次迭代相比没有变化。

更好的循环结构是将读取命令合并到条件测试中，如下：

```
char line[1000];
while(fgets(line,1000,fp)!=NULL) {
    if(sscanf(line,"%llu",&amt)==1) t_amt=t_amt+amt;
} 
```

请注意，使用 fgets 和 sscanf 比使用 fscanf 更好。为什么？因为 fscanf()如果遇到单独的“-”或“.”，将无法为**amt**赋值。，但在发生这种情况时仍然可以返回一个“1”表示读取成功，大概是因为“-”和“.”。可能是有效数字中的第一个字符，即使后面没有数字。手册似乎没有提到这一点！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T14:45:35.113

> 问题 2 此外，我将 amt 声明为 unsigned long long 以存储正值。范围从 1 到 9999999。请告诉我要用于此目的的值或数据类型。

如果 的范围`amt`在 0 到 9999999 之间，那么您可以使用`unsigned int`type `"%u"`。它在范围内

您甚至可以使用从 -2147483647 到 +2147483647 的`int`类型`"%d"`*

# android - 列表中的视图大小不正确

> ID：16172151
> 
> 赞同：0
> 
> 时间：2013-04-23T14:36:16.003
> 
> 标签：android, listview, layout, size, height

我有一个列表视图和一个适配器。我的问题是列表中的行总是`"wrap content"`即使我特别将高度声明为`"150dp"`.

这是我的适配器：

```
private class LiveEventsAdapter extends BaseAdapter {

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View contentView = convertView;
        if (contentView == null) {
            LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            contentView = inflater.inflate(R.layout.live_match_row, null);
            TypefaceManager.getInstance(LiveMatchActivity.this).assignTypeface(contentView);
        }

        if (events != null) {
            Event event = events.getEventsList().get(position);

            TypefaceManager typefaceManager = TypefaceManager.getInstance(LiveMatchActivity.this);
            TextView eventText;
            TextView minute;
            ImageView eventIcon;

            minute = (TextView) contentView.findViewById(R.id.live_match_minute);
            if (event.getOrientation().equals("home")) {
                eventText = (TextView) contentView.findViewById(R.id.home_team_event_text);
                eventIcon = (ImageView) contentView.findViewById(R.id.home_team_event_img);
            } else {
                eventText = (TextView) contentView.findViewById(R.id.away_team_event_text);
                eventIcon = (ImageView) contentView.findViewById(R.id.away_team_event_img);
            }
            minute.setText(event.getMinute() + "\'");
            eventText.setText(event.getDescription());
            minute.setTypeface(typefaceManager.getTypeface("bold"));
            eventText.setTypeface(typefaceManager.getTypeface("bold"));
        }   
} 
```

我就是这样`"setadapter"`：

```
ListView eventsListView = (ListView) findViewById(R.id.live_match_list);
        eventsListView.setAdapter(new LiveEventsAdapter()); 
```

这就是我的`rows layout`：

```
<?xml version="1.0" encoding="utf-8"?><RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="150dp"
android:background="@drawable/background_button" >

<TextView
    android:id="@+id/live_match_minute"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="82&apos;" />

<TextView
    android:id="@+id/home_team_event_text"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="false"
    android:layout_alignRight="@+id/home_team_event_img"
    android:layout_centerVertical="true"
    android:paddingLeft="4dp"
    android:paddingRight="4dp" />

<ImageView
    android:id="@+id/home_team_event_img"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentTop="true"
    android:layout_centerVertical="true"
    android:layout_marginRight="4dp"
    android:layout_toLeftOf="@+id/live_match_minute" />

<ImageView
    android:id="@+id/away_team_event_img"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="false"
    android:layout_centerVertical="true"
    android:layout_marginLeft="4dp"
    android:layout_toRightOf="@+id/live_match_minute" />

<TextView
    android:id="@+id/away_team_event_text"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="false"
    android:layout_centerVertical="true"
    android:layout_toRightOf="@+id/away_team_event_img"
    android:paddingLeft="4dp"
    android:paddingRight="4dp" /> 
```

为什么我的列表中的行总是设置为相同的大小，无论我输入什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:40:53.860

这将不起作用。

这是你应该做的。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content" >

    <RelativeLayout 
    android:layout_width="match_parent"
    android:layout_height="150dp"
    android:background="@drawable/background_button" >

        <TextView
            android:id="@+id/live_match_minute"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_centerVertical="true"
            android:text="82&apos;" />

    </RelativeLayout>
</RelativeLayout> 
```

基本上，添加另一个布局并指定该布局的高度。使用适配器视图时，为根布局指定高度不起作用。

# regex - 正则表达式检测匹配的逗号（，）是否不在正则表达式中

> ID：16172153
> 
> 赞同：0
> 
> 时间：2013-04-23T14:36:22.380
> 
> 标签：regex

我试图找出一种方法来确定我匹配的逗号（，）是否不在正则表达式中。基本上，如果它位于正则表达式中，我不想匹配我的角色。

我想出的正则表达式是`,(?<!.+\/)(?!.+\/)`但它不是很有效。有任何想法吗？

我想跳过`/some,regex/`但匹配任何其他逗号。

**编辑：** 现场示例：[http ://rubular.com/r/WjrwSnmzyP](http://rubular.com/r/WjrwSnmzyP)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:22:34.803

这是适合您的正则表达式：

```
,(?!\s)(?=(?:(?:[^/]*\/){2})*[^/]*$) 
```

### 现场演示：[http ://rubular.com/r/37buDdg1tW](http://rubular.com/r/37buDdg1tW)

**说明：**表示匹配逗号后跟偶数个正斜杠`/`。因此，不会匹配`comma (,)`2 个字符之间的字符，而会匹配外部字符（因为它们后面是偶数个字符）。`slash (/)``/`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:22:44.360

# sql-server - 如果填充了参数，则选择带有过滤器的 ROW_NUMBER()？

> ID：16172156
> 
> 赞同：1
> 
> 时间：2013-04-23T14:36:33.067
> 
> 标签：sql-server, sql-server-2008

我有以下 SQL Server 2008 查询。我想扩充它，以便在填充 @Filter 参数时将该值传递给每个字段（跨列）。如果没有过滤器，查询就可以完美运行。我不确定过滤器是否应该放在我拥有它们的地方。任何帮助将非常感激：

```
ALTER PROCEDURE [dbo].[pd_Get_Team2]
@OutTotalRecCount INT OUTPUT, 
@CurrentPage INT, 
@PageSize INT, 
@Token as nvarchar(50),
@UserID as nvarchar(50),
@SortDirection INT,
@SortField nvarchar(50),
@Filter nvarchar(50)

AS     
SELECT * FROM          
(SELECT ROW_NUMBER() OVER (
ORDER BY
CASE WHEN @SortDirection = 1 AND @SortField = 1 THEN pd_Role.UserID END ASC, 
CASE WHEN @SortDirection = 2 AND @SortField = 1 THEN pd_Role.UserID END DESC
) AS Row, 
pd_Role.id,      
pd_Role.Edit_Rights, 
pd_Role.UserID, 
pd_Role.Is_Approved, 
pd_Role.Login_Date, 
pd_Role.Team  

FROM pd_Role INNER JOIN  
pd_Token ON pd_Role.Token = pd_Token.Token 
WHERE 
(pd_Token.Token = @Token) AND (pd_Token.UserID = @UserID) 

 --how do I structure a filter on these fields if the filter is populated?
 --CASE WHEN LEN(@Filter)> 1  
 --AND pd_Role.Edit_Rights LIKE '%' + @Filter + '%' OR 
 --AND pd_Role.UserID LIKE '%' + @Filter + '%' OR 
 --AND pd_Role.Team LIKE '%' + @Filter + '%' 
 --
  ) 
  AS TeamWithRowNumbers 
  WHERE  Row >= (@CurrentPage - 1) * @PageSize + 1 AND Row <= @CurrentPage*@PageSize     

  SELECT @OutTotalRecCount = COUNT(*) FROM pd_Role 
  WHERE (pd_Role.Token = @Token) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:44:37.237

如果 @Filter 从不为 NULL（但可能为空）：

```
WHERE 
(pd_Token.Token = @Token) AND (pd_Token.UserID = @UserID) 

AND (
    pd_Role.Edit_Rights LIKE '%' + @Filter + '%' -- '%' + '' + '%' = Matches all
    OR pd_Role.UserID LIKE '%' + @Filter + '%'
    OR pd_Role.Team LIKE '%' + @Filter + '%' 
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:43:50.517

尝试这个：

```
AND ((@Filter IS NULL) OR
  (pd_Role.Edit_Rights LIKE '%' + @Filter + '%' OR 
   AND pd_Role.UserID LIKE '%' + @Filter + '%' OR 
   AND pd_Role.Team LIKE '%' + @Filter + '%')
) 
```

确保`@Filter`在未提供或使用时为空`@Filter = ''`- 我喜欢第一种方法。

# ssis - 将 SSIS 中的列拆分为数字部分和列值的其余部分

> ID：16172160
> 
> 赞同：0
> 
> 时间：2013-04-23T14:36:40.813
> 
> 标签：ssis

我试图弄清楚如何将我现有的 DTS 文件转换为托管在 SQL 2005 服务器上的 DTSX。

在我的第一次尝试（第一次 DTS）中，我已经被卡住了。

我不想看使用 DTS 是如何完成的，而是想专注于新的 DTSX 技术。

必须做什么。

*   检查输入文件是否存在，否则退出。（尚未完成）
*   截断目标表
*   将文件导入数据库
*   报告一切是否正常。

步骤导入文件是我卡住的地方。我有一个固定列大小的平面 tekst 文件，其中门牌号和扩展名在一个列中。数据库有两列。

我首先尝试了一个派生列，但可以找到拆分（第一个）数字部分的检查。

在搜索使用正则表达式时，我读到了我读到的“脚本组件”与 SQL 2005 不兼容。

还有另一种可能吗？

这让我想到了第二个问题：是否可以将 SQL Server Data Tools (SSDT) 与 SQL Server 2005 一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:05:04.600

你有一份工作摆在你面前。您将需要使用[派生列](http://msdn.microsoft.com/en-us/library/ms141069.aspx)转换，因此请查找它们。将[数据查看器](http://msdn.microsoft.com/en-us/library/ms140318.aspx)添加到您的数据流中会很有帮助，这样您就可以看到哪些数据在流中移动，以及 SSIS 认为其中的内容。

在您的情况下，您将不得不操作字符串。有两种字符串数据类型，DT_STR 和DT_WSTR（例如，VARCHAR 和NVARCHAR）。SSIS 对数据类型非常特别，您可能必须使用强制转换操作将一种类型转换为另一种类型。例如，(DT_WSTR, 50)Blah 将 Blah 列中的 50 个字符转换为 DT_WSTR。DT_STR 类型也需要知道代码页。例如1252之类的东西。

您可能需要 SSIS 版本的[Immediate If](http://msdn.microsoft.com/en-us/library/ms141680.aspx)，它检查条件是否为真，并返回一个结果或另一个： Blah==100?1:0 对于那些列 Blah 的记录，结果将为 1等于 100，所有其他记录为 0。您可以嵌套这些立即 If 语句，一个在下一个中，在下一个中，adn 等等。

您将需要在派生列小部件中创建至少两个新列，一个用于数字，一个用于后面的内容。所以这是一种非常痛苦的方式来做你想做的事。使用字符串函数检查第一个字符是否为数字，然后返回或不返回。对第二个字符等执行相同的操作。

当然，我确信有更好的方法来做到这一点。您的工具箱包含派生列小部件中的功能，因此您必须使用这些功能。（或者，在这种情况下，您可能会使用 SQL UPDATE 语句做得更好，您将在上面的控制流中作为后续任务执行，而不是在下面的数据流中。）

公平的警告：SSIS 的 SQL Server 2005 版本有很多很多的错误和挫折，这些错误和挫折在更高版本的 SQL Server 中得到了修复或改进。即使您只是使用 SQL Server 2008，您也会省去很多麻烦。

# python - 为什么使用 classmethod 而不是 staticmethod？

> ID：16172163
> 
> 赞同：31
> 
> 时间：2013-04-23T14:36:47.163
> 
> 标签：python, class, python-3.x, static-methods, class-method

我知道他们做了什么，并且我已经看到了很多这两个例子，但是我还没有找到一个我必须使用`classmethod`而不是用`staticmethod`.

`classmethod`我见过的最常见的例子是**创建一个**类本身的新实例，像这样（非常简单的例子，没有使用 atm 方法。但你明白了）：

```
class Foo:
    @classmethod
    def create_new(cls):
        return cls() 
```

这将`Foo`在调用时返回一个新实例`foo = Foo.create_new()`。现在为什么我不能只使用它：

```
class Foo:
    @staticmethod
    def create_new():
        return Foo() 
```

它完全一样，我为什么要使用 a `classmethod`over a `staticmethod`？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-23T14:41:30.800

您的示例几乎没有什么区别，但是假设您创建了一个子类`Foo`并在子类上调用了该`create_new`方法...

```
class Bar(Foo):
    pass

obj = Bar.create_new() 
```

...那么这个基类将导致创建一个新`Bar`对象...

```
class Foo:
    @classmethod
    def create_new(cls):
        return cls() 
```

...而这个基类会导致创建一个新`Foo`对象...

```
class Foo:
    @staticmethod
    def create_new():
        return Foo() 
```

...所以选择将取决于您想要哪种行为。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-23T14:43:53.733

是的，这两个类会做同样的事情。

但是，现在想象一下该类的子类型：

```
class Bar (Foo):
    pass 
```

现在调用`Bar.create_new`做一些不同的事情。对于静态方法，您会得到一个`Foo`. 对于类方法，您会得到一个`Bar`.

所以重要的区别是类方法获取作为参数传递的类型。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-23T14:44:26.757

从[docs](http://docs.python.org/2/library/functions.html#classmethod)中，类方法接收其类作为隐式参数，而静态方法不知道它们所在的类。

这在您有一个继承的静态方法想要用子类中的不同行为覆盖的情况下很有用。

# silverlight - Silverlight 在 iframe 中成功登录后出现 http302 错误

> ID：16172168
> 
> 赞同：0
> 
> 时间：2013-04-23T14:37:06.140
> 
> 标签：silverlight, iframe, http-status-code-302

我有一个 silverlight 4 应用程序，其中包含一个 iframe 来显示 aspx 页面。silverlight 应用程序和 iframe 中的应用程序都托管在同一个 Web 服务器中。

首先，有两个 login.aspx 页面。一个在 silverlight 应用程序中，另一个在另一个嵌入 iframe 的站点中。我的 silverlight 应用程序将首先加载并成功登录 silverlight 应用程序。

然后，在我的 silverlight 应用程序中，有一个链接按钮可以将 aspx 页面加载到 iframe 中。

当我第一次访问 iframe 中的 aspx 页面时，它会转到它的 login.aspx 并成功登录。之后，我回到 silverlight 应用程序，我立即收到 http 302 错误。但是我访问aspx页面和silvelight应用程序之间的持续时间，不大于会话超时的时间。

那么任何人都能够弄清楚是什么导致了错误？

PS 只有在aspx页面登录成功后才会出现。如果我不触摸 iframe 中的 aspx 页面，只访问 silverlight 页面，它不会出错。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T13:43:30.977

今天找到了根本原因并解决了。这是由于两个应用程序被放置在同一台机器上。然后，第二次登录将覆盖第一次登录的身份验证 cookie。（这意味着调用第二个的 FormsAuthentication.SetAuthCookie() 将覆盖第一个。）所以解决方案非常简单。只是为了使他们的身份验证cookie名称不同：

`

```
 <authentication mode="Forms">
   <forms name=".SecondAuthCookie" loginUrl="login.aspx"
    defaultUrl="default.aspx" />
</authentication> 
```

`

# php - 对数据库结果的任意用户定义约束

> ID：16172171
> 
> 赞同：1
> 
> 时间：2013-04-23T14:37:13.077
> 
> 标签：php, mysql, database, constraints

在一个调查框架中，用户输入（即“询问”调查问题，而不是回答它们）是相当可信的，我的前任几乎直接从用户定义的约束构建一个 MySQL 查询（即没有对恶意的可能性做太多SQL 注入，因为 SQL 注入是预期的结果）。

在大多数情况下，这些约束类似于跳过这个问题，如果`sex = 1`它会转化为类似的查询

`SELECT IF(sex = 1) AS test FROM Survey1 WHERE user_id = 12`

在更复杂的情况下，约束可能是
`Survey1.agreed = 1 OR (Survey2.age < 50 AND Survey2.age > 18) OR Survey3.number_of_children IN(2,3,5,7)` 他必须建立连接等以支持无限复杂性和嵌套。

显然，有很多方法让用户几乎指定查询的 WHERE 部分可能会出错，即使恶意用户很少见。
他尝试自己解析这些约束，但在复杂的情况下，这表现得非常糟糕，最终他采用了不安全但快速的方法。

什么是解决这个问题的安全、高效的解决方案？

# android - 通过 ID 令牌从服务器检索 Google 用户数据

> ID：16172176
> 
> 赞同：4
> 
> 时间：2013-04-23T14:37:30.993
> 
> 标签：android, oauth, google-api, google-api-client

我已经用头撞墙了大约两天了，是时候寻求帮助了。

我一直在努力解决以下问题：

移动应用程序用户使用以下方式之一登录应用程序：

*   谷歌
*   Facebook
*   ETC...

我将首先关注谷歌，登录有效（用户同意许可）。然后该应用程序检索一个令牌：`GoogleAuthUtil.getToken(mActivity, mEmail, mScope);` 范围的形式是`audience:server:client_id:XXXXXX` And `XXXXXXX`is the client_id of my webservice。

（移动应用程序也在 Google Console 上注册，并且与网络服务器在同一个项目中）

接下来，应用程序将检索到的令牌发送到我的网络服务器，服务器可以使用`$client->verifyIdToken( $id_token );`. 我的服务器正在使用[Google API Client](http://code.google.com/p/google-api-php-client/)。

但我现在希望使用它让服务器从谷歌检索用户数据，而不向用户请求进一步的权限（因为他们已经给了应用程序权限）。那么我如何从有效载荷中获取从谷歌请求用户数据呢？

我仍然认为我可能完全误解了整个 Oauth2.0 / SSO 过程，因此非常感谢任何指针！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:46:10.547

您在范围内获得的唯一`audience:server:client_id:XXXXXX`用户数据是用户的电子邮件地址，这是您在网络服务器上收到`email`的 JSON 编码字段（[此博客文章](http://android-developers.blogspot.com/2013/01/verifying-back-end-calls-from-android.html)具有 Java/Ruby 等效项，我假设 PHP 有类似的帮助函数） .`$id_token`

如果您需要他们的电子邮件地址之外的其他用户数据，则需要重新请求其他范围，例如[Google+ API 范围](https://developers.google.com/+/api/oauth)或旧版[Google Profile API 范围](https://developers.google.com/google-apps/profiles/auth)之一。

# email - 是否有拒绝自动回复的电子邮件协议？

> ID：16172177
> 
> 赞同：3
> 
> 时间：2013-04-23T14:37:32.647
> 
> 标签：email, auto-responder

如果我的程序正在向 1000 人的双重选择列表发送电子邮件提醒，我不在乎让他们各自的自动回复。

是否有电子邮件标头（或任何其他机制），即使是非标准的，也会通知 gmail、hotmail、exchange 或其他大型电子邮件平台不发送自动回复？

伪码头...

```
{"auto-respond":"false"} 
```

理想情况下，解决方案不是从“NO-REPLY@example.com”发送，因为我真的希望人们在需要时回复，我只是想保存由 OOF 自动回复生成的所有额外电子邮件。

感谢您的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T14:31:20.510

我不认为有。不过，您可以使用如此基本的文本搜索来做一些事情。只需在消息中的“不在办公室”上创建一个过滤器。

你也可以看看 sendgrid，他们可能会提供一些东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T15:28:09.223

不幸的是，SMTP 协议不允许这样的事情。就像克里斯提到的那样，您能做的最好的事情就是编写一个过滤器，以自动删除/删除这些。

——戴夫

# visual-studio-2012 - Windows 商店中的 BitmapImage WriteableBitmap - 地铁

> ID：16172178
> 
> 赞同：2
> 
> 时间：2013-04-23T14:37:34.630
> 
> 标签：visual-studio-2012, windows-store-apps

如何在 Metro 应用程序中将 BitmapImage 转换为 WriteableBitmap 对象？我一直在寻找一段时间，但我没有得到任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T15:30:00.527

据我了解，没有第三方库真的很难做到。

不过，您可以从**StorageFile创建****WritableBitmap**。

 **```
public static async Task<WriteableBitmap> writableImageFromFile(StorageFile file)
{
    IRandomAccessStream fileStream = await file.OpenAsync(FileAccessMode.Read);

    WriteableBitmap writableBitmap = new WriteableBitmap(1, 1);
    writableBitmap.SetSource(fileStream);

    return writableBitmap;
} 
```

不要忘记这一点：

```
using System;
using System.Threading.Tasks;
using Windows.Storage;
using Windows.Storage.Streams;
using Windows.UI.Xaml.Media.Imaging; 
```**

# json - json响应回调加载存储extjs

> ID：16172183
> 
> 赞同：0
> 
> 时间：2013-04-23T14:37:41.380
> 
> 标签：json, extjs, callback, store

我有一个从 PHP 脚本加载数据的 JSON 存储。此脚本调用 Web 服务，有时它会出现一些错误，我需要捕获它们并在我的应用程序中显示它们。在我的脚本中，当我收到错误时会打印这一行：

```
echo '{"success": "false", "error": "'.$res->state->Description.'"}'; 
```

在我的应用程序中，我有这个代码来加载商店

```
targheStore.load({
                            params: { targa: searchForm.getValues().targa },
                            callback: function(records, operation, success) {
                                Ext.getBody().dom.style.cursor = "default";
                                if(!success){
                                    $("#message2").slideDown('fast');
                                    setTimeout(function() {
                                        $("#message2").slideUp('medium')
                                    }, 2700);
                                }
                            }

                        }); 
```

jQuery 代码是从顶部显示消息“未找到记录”，但我想显示从 json 收到的错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:01:22.940

操作参数内部是一个请求和响应对象。使用响应对象，就像任何 Ajax 响应都应该允许您以您喜欢的方式处理消息一样。

我建议声明一个全局可用的处理程序来处理操作以查找 JSON.parse(response.responseText).hasOwnProperty("error") 并以这种方式执行您的自定义操作。

如果您不使用 JSONP 进行通信，则可以将消息填充到从 HTTP 错误代码 (400+) 返回的原始文本中，并且 ajax 中的 {error:} 处理程序将是路由错误的最佳方式。

# ios - 如何在核心数据iOS中获取每个实体的最后一个条目

> ID：16172197
> 
> 赞同：0
> 
> 时间：2013-04-23T14:38:12.230
> 
> 标签：ios, database, core-data, nsmanagedobject, nsfetchrequest

我正在 iOS 中制作聊天应用程序。我保存了每个朋友的最后一次谈话。我的核心数据实体有 3 个字段 - jID、消息和时间戳。我没有在任何字段上设置索引。我只想获取每个 jID 的最后一条消息。所以，请帮助我并告诉我是否在任何字段上设置索引，以便获取过程是合适的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T18:26:03.617

您还可以在您的实体和最后一次对话之间添加一对一的关系（您必须自己维护它，如果您透露您的模型，我可能会更具体一点）。

用于过滤数据并用于访问元素的属性可能应该被索引。

这意味着您可能希望您的`jID`和`timestamp`索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:41:57.847

如果要获取最后一个对象，则需要对它们进行排序。时间戳就可以了。如果您想获取最后一个对象，请颠倒顺序并仅获取第一个对象。

如果您想使用`jID`，则 ID 必须按某种顺序排列。

# c# - 从文本文件中获取 csv 类型的数据

> ID：16172202
> 
> 赞同：-1
> 
> 时间：2013-04-23T14:38:21.153
> 
> 标签：c#, serialization, csv, deserialization

我有字符串，它提供的数据更像 csv 格式。

```
&stamp;field1;field2;field3;field4;&event 
10:44:00.6100;0.000;0.000;0.000;0.000; 10:44:00.7100;23.2;0.230;411.2;0.000; 10:44:00.8100;0.000;0.000;1.022;0.000;      10:44:00.9100;8.000;0.000;232.3;0.000;
 10:44:01.2100;0.000;0.000;0.000;0.000; 10:44:01.3100;23.2;0.230;411.2;0.000; 10:44:01.5100;0.000;0.000;1.022;0.000; 10:44:01.7100;8.000;0.000;232.3;0.000; 
```

我想反序列化这些数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:46:33.683

这将为您提供每个字符串“拆分”的列表；字符。您将需要修剪和解析之后的值。希望这可以帮助

```
var stringOfData = "0:44:00.6100;0.000;0.000;0.000;0.000;     10:44:00.7100;23.2;0.230;411.2;0.000; 10:44:00.8100;0.000;0.000;1.022;0.000;      10:44:00.9100;8.000;0.000;232.3;0.000;";
List<string> parsed = new List<string>();
parsed.AddRange(stringOfData.Split(';')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:59:21.177

```
string line = String.Empty;
string[] parts = null;
using (StreamReader sr = new StreamReader(new FileStream(@"C:\yourfile.csv", 
                                          FileMode.Open)))
{
    while ((line = sr.ReadLine()) != null)
    {
        parts = line.Split(new [] { ';' });
        //Do whatever you want to do with the array of values here
    }
} 
```

至于问题的反序列化部分；您需要指定所需的格式类型。如果您只想要一个要循环的数字集合，您可以将每个值添加到通用列表中。

如果您需要特定格式，您可以为每个值创建一个包含字段的类，并使用这些值填充该类的通用列表。

# java - 如何从可变 Java 映射构建 Scala 不可变映射？

> ID：16172214
> 
> 赞同：2
> 
> 时间：2013-04-23T14:38:45.263
> 
> 标签：java, scala, scala-java-interop

下面的类导致编译器错误：

```
value toMap is not a member of 
 java.util.Map[java.lang.String,java.util.List[com.recommendations.TestObject]]

class ProcessData(var distanceMap : java.util.Map[java.lang.String , java.util.List[TestObject]]) {

    def apply = {

      val m2: Map[String, Any] = distanceMap.toMap

    }

} 
```

此行导致错误：

```
val m2: Map[String, Any] = distanceMap.toMap 
```

错误是因为 Map distanceMap 的值是可变的 java.util.List ，因此这些值也需要是不可变的吗？

如何从上面的可变 distanceMap 构建 Scala 不可变映射？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T14:41:24.567

```
import scala.collection.JavaConversions._

val m = new java.util.HashMap[String, Object]()
m.put("Foo", java.lang.Boolean.TRUE)
m.put("Bar", java.lang.Integer.valueOf(1))

val m2: Map[String, Any] = m.toMap
println(m2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:23:30.980

您只是缺少 JavaConversions 导入。您的代码将编译为：

```
import scala.collection.JavaConversions._
class ProcessData(var distanceMap : java.util.Map[java.lang.String , java.util.List[TestObject]]) {
    def apply = {
      val m2: Map[String, Any] = distanceMap.toMap
    }
} 
```

# ruby-on-rails - 为特定行着色 ActiveAdmin

> ID：16172215
> 
> 赞同：0
> 
> 时间：2013-04-23T14:38:48.847
> 
> 标签：ruby-on-rails, colors, row, activeadmin

嗨，我正在使用 Ruby on Rails 和 ActiveAdmin，在我的网页中，我有一个表，如果该表的值变为负数，我希望该特定行变为红色。我之前正在阅读有关 CodeRay 的信息，但它似乎只是为文件中的行着色而不是表中的行。

关于我该怎么做的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:22:50.480

首先在一个文件中设置CSS颜色`/app/assets/stylesheets/`

```
.bg-red { background-color: red; } # or a nicer shade of red 
```

然后在你的桌子上：

```
<tr class="#{"red" if object.value < 0}">
  <td><%= object.attribute1 %></td>
  <td><%= object.attribute2 %></td>
</tr> 
```

因此，如果您的对象的值小于 0（负），`"red"`将输出到 that 的类`tr`，否则不会添加任何内容。

# r - data.table 不能很好地与 checkUsage 配合使用

> ID：16172216
> 
> 赞同：10
> 
> 时间：2013-04-23T14:38:50.260
> 
> 标签：r, data.table

[`data.table`](http://cran.r-project.org/web/packages/data.table/)是一个很棒的包，唉，它会产生无根据[`checkUsage`](http://cran.r-project.org/web/packages/codetools/)的警告（代码来自[这里](https://stackoverflow.com/questions/16132625/how-to-avoid-an-optimization-warning-in-data-table)和[这里](https://stackoverflow.com/questions/16152161/understanding-optimisation-messages-on-assignment-by-reference-in-a-data-table)）：

```
> library(compiler)
> compiler::enableJIT(3)
> dt <- data.table(a = c(rep(3, 5), rep(4, 5)), b=1:10, c=11:20, d=21:30, key="a")
> my.func <- function (dt) {
  dt.out <- dt[, lapply(.SD, sum), by = a]
  dt.out[, count := dt[, .N, by=a]$N]
  dt.out
}
> checkUsage(my.func)
<anonymous>: no visible binding for global variable ‘.SD’ (:2)
<anonymous>: no visible binding for global variable ‘a’ (:2)
<anonymous>: no visible binding for global variable ‘count’ (:3)
<anonymous>: no visible binding for global variable ‘.N’ (:3)
<anonymous>: no visible binding for global variable ‘a’ (:3)
> my.func(dt)
Note: no visible binding for global variable '.SD' 
Note: no visible binding for global variable 'a' 
Note: no visible binding for global variable 'count' 
Note: no visible binding for global variable '.N' 
Note: no visible binding for global variable 'a' 
   a  b  c   d count
1: 3 15 65 115     5
2: 4 40 90 140     5 
```

`a`可以通过替换来避免`by=a`关于的警告`by="a"`，但是我该如何处理其他3个警告？

这对我来说很重要，因为这些警告会使屏幕混乱并掩盖合法的警告。由于警告是在`my.func`调用时发出的（启用 JIT 编译器时），而不仅仅是由发出的`checkUsage`，我倾向于将其称为[bug](https://r-forge.r-project.org/tracker/index.php?func=detail&aid=2723&group_id=240&atid=975)。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-09-10T10:26:39.630

**更新**：现在在 v1.8.11 中解决。来自[新闻](https://r-forge.r-project.org/scm/viewvc.php/pkg/NEWS?view=markup&root=datatable)：

> `.SD`, `.N`, `.I`,`.GRP`和`.BY`现在被导出（作为`NULL`）。这样就不会通过`R CMD check`或`codetools::checkUsage`via为它们生成注释`compiler::enableJIT()`。`utils::globalVariables()`被考虑过，但选择了出口。感谢 Sam Steingold 提出，[#2723](https://r-forge.r-project.org/tracker/?func=detail&group_id=240&aid=2723&atid=975)。

并且要解析列名符号`count`和的注释`a`，它们都可以用引号括起来（甚至在 的 LHS 上`:=`）。使用新的 R 会话（因为注释只是第一次），以下现在不产生注释。

```
$ R
R version 3.0.1 (2013-05-16) -- "Good Sport"
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)
> require(data.table)
Loading required package: data.table
data.table 1.8.11  For help type: help("data.table")
> library(compiler)
> compiler::enableJIT(3)
[1] 0
> dt <- data.table(a=c(rep(3,5),rep(4,5)), b=1:10, c=11:20, d=21:30, key="a")
> my.func <- function (dt) {
  dt.out <- dt[, lapply(.SD, sum), by = "a"]
  dt.out[, "count" := dt[, .N, by="a"]$N]
  dt.out
}
> my.func(dt)
   a  b  c   d count
1: 3 15 65 115     5
2: 4 40 90 140     5
> checkUsage(my.func)
> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T13:34:50.173

看来此时唯一的办法就是

```
my.func <- function (dt) {
  .SD <- .N <- count <- a <- NULL  # avoid inappropriate warnings
  dt.out <- dt[, lapply(.SD, sum), by = a]
  dt.out[, count := dt[, .N, by=a]$N]
  dt.out
} 
```

即，在本地绑定报告为未绑定全局变量的变量。

感谢@GSee 的链接。

# c++ - 使用代码：Linux 上的块在 C++ 中的函数中的“未在范围内声明”

> ID：16172217
> 
> 赞同：0
> 
> 时间：2013-04-23T14:38:50.287
> 
> 标签：c++, function, addition

这是我的代码：

```
 #include <iostream>
    #include "rlutil.h"
    #include <cmath>
    #include <string>

    using namespace std;

    int getNumber()
    {
        int firstNumber;
        int secondNumber;
        cout << "Please Enter Your First Number." << endl;
        cin >> firstNumber;
        cout << "Please Enter Your Second Number." << endl;
        cin >> secondNumber;
        return 0;
    }

    int writeNumber()
    {
        getNumber();
        rlutil::setColor(3);
        cout << firstNumber + secondNumber << endl;
        return 0;
    } 
```

当我编译它以检查错误时，它给了我：

/home/bresser/Documents/LearnC++/main.cpp||在函数'int writeNumber()'中：| /home/bresser/Documents/LearnC++/main.cpp|24|错误：“firstNumber”未在此范围内声明| /home/bresser/Documents/LearnC++/main.cpp|24|错误：“secondNumber”未在此范围内声明| ||=== 构建完成：2 个错误，0 个警告 ===|

我有点明白它在说什么，只是不明白如何解决它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:40:30.373

最简单的解决方法是采取

```
int firstNumber;
int secondNumber; 
```

退出 getNumber 函数并赋予它们全局范围。也就是说，将它们放在`using namespace std;`代码行的下方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:42:15.350

由于您在 getNumber() 中声明 firstNumber 和 secondNumber，因此 writeNumber() 无法访问它们。如果您不想将变量移动到全局范围，您可以这样做（使用[pass by reference ）：](http://www.learncpp.com/cpp-tutorial/73-passing-arguments-by-reference/)

```
void getNumber(int &firstNumber, int &secondNumber)
{
    cout << "Please Enter Your First Number." << endl;
    cin >> firstNumber;
    cout << "Please Enter Your Second Number." << endl;
    cin >> secondNumber;
}

int writeNumber()
{
    int firstNumber;
    int secondNumber;
    getNumber(firstNumber, secondNumber);
    rlutil::setColor(3);
    cout << firstNumber + secondNumber << endl;
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T14:42:17.333

这是因为这两个变量 (`firstNumber`和`secondNumber`) 超出了范围——即第二种方法无法“看到”它们，因为它们是在第一种方法中声明的。

使这些变量全局化将解决问题 - 只需移动：

```
int firstNumber;
int secondNumber; 
```

到顶部，在您的定义之上`getNumber()`。

# php - 使用带有 ISO-8859-1 字符集的 Javascript/jQuery 复制 HTML 表单 POST

> ID：16172218
> 
> 赞同：0
> 
> 时间：2013-04-23T14:38:52.483
> 
> 标签：php, javascript, forms, post, character-encoding

我的 PHP Web 应用程序以 ISO-8859-1 编码运行。当我将带有 accept-charset="ISO-8859-1" 的 HTML 表单发布到 PHP 服务器时，这就是我在服务器端收到的内容

一个。原始形式的 ASCII 字符。

湾。可以在 ISO-8859-1 中以其原始形式表示的特殊字符。

C。无法在 ISO-8859-1 中表示的特殊字符转换为 HTML 实体。

所有数据都作为正确的 ISO-8859-1 编码字符接收。我想用 JavaScript 或 jQuery 复制完全相同的行为。我尝试过的所有解决方案最终都将所有特殊字符作为双编码字符发送到 PHP 文件，我必须对它们进行 utf8_decode。

我制定了一个可行的解决方案，如下所示：

一个。将不受支持的特殊字符转换为 HTML 实体。

湾。使用 XMLHttpRequest/ActiveXObject 发送 JavaScript AJAX 发布请求。为此，我必须对数据进行“编码 URIComponent()”。

C。在服务器上接收发布数据并使用“utf8_decode()”，因为“encodeURIComponent()”将特殊字符编码为 UTF-8。

我想要一个 JavaScript 解决方案，它可以确保我从服务器端的 POST 接收到正确的 ISO-8859-1 编码数据，这样我就不必执行“utf8_decode()”。换句话说，我希望 JavaScript 解决方案能够准确地复制带有 accept-charset="ISO-8859-1" 的表单行为。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:49:13.793

据我所知，javascript 中没有万无一失的方法可以做到这一点。字符编码不是 Javascript 的强项，我认为这主要是因为它将这些区域留给其他人自行决定，例如描述内容的 HTML、进行解析的服务器语言或提供环境的 Web 服务器。

就 JS 中的任何 URI 编码/解码函数而言，它都是 UTF-8 并且是内置的，因为没有参数可以传递来覆盖它。

您还可以尝试覆盖 MimeType 并指定一个新的，例如：

```
var xhr = new XMLHttpRequest();
if (xhr.overrideMimeType) {
    xhr.overrideMimeType('application/x-javascript; charset=ISO-8859-1');
} 
```

不确定它有多稳定，但这是您可能想要探索的一个方向..

# symfony - 在树枝中显示货币符号

> ID：16172222
> 
> 赞同：4
> 
> 时间：2013-04-23T14:39:08.437
> 
> 标签：symfony, twig, currency

如何在树枝中显示货币符号？我保存了符号的数值，如：

```
for EURO : &#8364;
for DOLLAR: &#36; 
```

当我渲染这些值时，`&`转换为`&amp;`并且货币符号不显示。任何想法将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T14:49:00.543

要做到这一点，您必须添加一个[函数](http://twig.sensiolabs.org/doc/advanced.html#id2)或过滤器，该函数或[过滤器](http://twig.sensiolabs.org/doc/advanced.html#id3)被称为帮助器，以在您的树枝模板中呈现货币符号。

要使用以下功能，

```
{{ currency('en_US') }} 
```

您必须添加一个[树枝扩展](http://twig.sensiolabs.org/doc/advanced.html)，如下所示，

```
xxx.twig.your_extension:
    class: XXX\YourBundle\Twig\YourExtension
    tags:
        - { name: twig.extension } 
```

然后你必须添加一个`currency`功能，

```
namespace XXX\YourBundle\Twig;

class YourExtension extends \Twig_Extension
{
    public function getFunctions() {
        return array(
            'currency' => new \Twig_Function_Method($this, 'currencyFunction'),
        );
    }

    public function currencyFunction($locale) {
        $formatter = new \NumberFormatter($locale, \NumberFormatter::CURRENCY);
        $symbol = $formatter->getSymbol(\NumberFormatter::CURRENCY_SYMBOL);

        return $symbol;
    }

    public function getName() {
        return 'your_extension';
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T14:49:39.007

我想到了。渲染的时候需要用到twig的[**raw**](http://twig.sensiolabs.org/doc/filters/raw.html) filter。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-08T22:52:22.997

这是一个旧线程，但对于来到这里的新人，Twig 现在有一个货币符号的扩展（带有新的过滤器 |currency_symbol ），如您在[文档中所见](https://twig.symfony.com/doc/2.x/filters/currency_symbol.html)

# log4net - 是否可以配置 log4net 以在错误时发出通知？

> ID：16172224
> 
> 赞同：2
> 
> 时间：2013-04-23T14:39:17.227
> 
> 标签：log4net

*我重新表述了这个问题，以避免将 C# 异常视为异常。*

按照设计，log4net 是静默实用程序，或者如常见问题所描述的那样，它是故障停止系统。

然而，这种行为与我所需要的相反。我需要这个：

*   配置错误——通知事件
*   缺少数据库提供程序——通知事件
*   无法登录数据库——通知事件

等等等等。

那么是否有可能（如果是，如何？）配置 log4net 以发出错误通知而不是默默地忽略它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:44:17.017

你说的是log4net内部调试吗？

您可以按照此处所述启用此功能：http: [//logging.apache.org/log4net/release/faq.html#trouble-file-perm](http://logging.apache.org/log4net/release/faq.html#trouble-file-perm)。

这将确保也记录内部 log4net 异常。

**编辑**log4net 可以在运行时抛出异常吗？ *不，log4net 不可靠。这是一个尽力而为和故障停止的日志记录系统。通过故障停止，我们的意思是 log4net 不会在运行时抛出意外异常，可能导致您的应用程序崩溃。*请参阅[http://logging.apache.org/log4net/release/faq.html](http://logging.apache.org/log4net/release/faq.html)。

# javascript - 避免来自单个赋值操作的重复 JS 对象属性？

> ID：16172231
> 
> 赞同：1
> 
> 时间：2013-04-23T14:39:41.957
> 
> 标签：javascript, database

我正在大型数据集上运行脚本以扩展现有信息。例如：

```
...
{
    id : 1234567890
},
{
    id : 1234567891
},
... 
```

变成

```
...
{
    id : 1234567890,
    Name : "Joe"
},
{
    id : 1234567891,
    Name : "Bob"
},
... 
```

我通过以下代码执行此操作：

```
for(var cur in members)
{
    curMember = members[cur];
    // fetch account based on curMember.id to 'curAccount'

    if(curAccount != null)
    {
        curMember.DisplayName = curAccount.DisplayName;
    }
} 
```

在大多数情况下，这按预期工作。但是，偶尔（大约数万个条目），结果如下所示：

```
...
{
    id : 1234567891,
    Name : "Bob",
    Name : "Bob"
},
... 
```

我现在的数据格式无效，数据库无法读取，因为重复的属性名称没有意义。当脚本重新运行时，随机条目会发生这种情况，而不是每次都相同。我需要一种方法来防止这种情况发生，或者检测它已经发生，这样我就可以简单地重新处理条目。有人知道这里发生了什么吗？

编辑：经过进一步调查，问题似乎只有在被修改的对象来自 MongoDB 查询时才会出现。似乎如果代码多次显式地为同一个元素名称设置一个值，则该字段将被重复。所有同名元素似乎都设置为最近指定的值。如果它像我原来的问题一样只分配一次，那么它只会很少重复。我正在使用 MongoDB 2.4.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T13:48:52.980

都想通了。MongoDB 在 shell 版本 2.4.1 之前有一个错误，它允许为查询结果对象设置重复的元素名称。本周一发布的 2.4.3 版有一个修复程序。请参阅[https://jira.mongodb.org/browse/SERVER-9066](https://jira.mongodb.org/browse/SERVER-9066)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:48:59.557

我真的不明白你的问题。如果您在 ECMAscript 中将相同的属性名称应用于对象，则该属性将被覆盖。您的代码段中的构造永远不能以这种形式存在于活动对象（不包括 JSON 字符串）上。

如果您只想*检测*创建已经存在的属性的尝试，则需要事先缓存该对象引用（以便循环其键）-或者-您需要应用*ES5 strict mode*。

```
"use strict"; 
```

在文件或函数的顶部。这将确保您的解释器在尝试创建两个相同的属性键时会抛出异常。~~当然，您可以使用`try - catch`语句来拦截该故障。~~

似乎您无法拦截由于*严格模式违规*而引发的错误。

# sql - 如何在 MS Access 2007 中使用 DateTime 查询 sql 查找最小值和最大值？

> ID：16172232
> 
> 赞同：1
> 
> 时间：2013-04-23T14:39:43.810
> 
> 标签：sql, ms-access, datetime, ms-access-2007

我在 MS Access 2007 中查询 sql。我想用 datetime 找到 mix 和 max 函数。

**此代码：**

```
SELECT inf.SSN AS EmpNo, ck.CHECKTIME AS CHKDATE,Min(ck.CHECKTIME) AS TIMEIN, Max(ck.CHECKTIME) AS TIMEOUT
FROM CHECKINOUT ck INNER JOIN USERINFO inf ON ck.Badgenumber = inf.Badgenumber
WHERE (((ck.CHECKTIME)>=#20/03/2013#)
Group By inf.SSN, ck.CHECKTIME
ORDER BY inf.SSN, ck.CHECKTIME 
```

**结果：**

```
EmpNo   |     CHKDATE    |  TIMEIN             | TIMEOUT
1290005 | 20/3/2556 7:24:52  |  20/3/2556 7:24:52  | 20/3/2556 7:24:52
1290005 | 20/3/2556 19:07:54 |  20/3/2556 19:07:54 | 20/3/2556 19:07:54
1290005 | 21/3/2556 7:14:29  |  21/3/2556 7:14:29  | 21/3/2556 7:14:29
1320004 | 20/3/2556 7:28:57  |  20/3/2556 7:28:57  | 20/3/2556 7:28:57
1320004 | 20/3/2556 17:05:23 |  20/3/2556 17:05:23 | 20/3/2556 17:05:23
1320004 | 21/3/2556 7:15:30  |  21/3/2556 7:15:30  | 21/3/2556 7:15:30 
```

**但我想要结果：**

```
EmpNo   |     CHKDATE    |  TIMEIN             | TIMEOUT
1290005 | 20/3/2556 00:00:00 |  20/3/2556 7:24:52  | 20/3/2556 19:07:54
1290005 | 21/3/2556 00:00:00 |  21/3/2556 7:14:29  | 21/3/2556 7:14:29
1320004 | 20/3/2556 00:00:00 |  20/3/2556 7:28:57  | 20/3/2556 17:05:23
1320004 | 21/3/2556 00:00:00 |  21/3/2556 7:15:30  | 21/3/2556 7:15:30 
```

如何在 Access 2007 中查询此结果。感谢您的宝贵时间。;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:49:26.977

我想你想按 EmpNo 和 ChkDate 分组

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:16:50.810

Access SQL supports a `DateValue()` function which returns the date portion of a Date/Time value. (Actually it gives you midnight for that date.) I think it should be useful for what you want.

```
SELECT
    inf.SSN AS EmpNo,
    DateValue(ck.CHECKTIME) AS CHKDATE,
    Min(ck.CHECKTIME) AS TIMEIN,
    Max(ck.CHECKTIME) AS TIMEOUT
FROM
    CHECKINOUT ck
    INNER JOIN USERINFO inf
    ON ck.Badgenumber = inf.Badgenumber
WHERE ck.CHECKTIME>=#2013/03/20#
GROUP BY inf.SSN, DateValue(ck.CHECKTIME)
ORDER BY 1, 2; 
```

# android - 在android中取消AsyncTask类

> ID：16172233
> 
> 赞同：0
> 
> 时间：2013-04-23T14:39:44.950
> 
> 标签：android, eclipse

我有两个按钮。第一个启动媒体播放器，第二个取消它：媒体播放器在`AsyncTask`并且我使用（线程-while）重复它我需要媒体播放器播放，直到用户在我启动它时按下取消它正在运行并且当我按下取消它停止（当我不出去页面布局时，）

```
private DoSomething doSomething;
    @Override   
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.first);
final MediaPlayer mp;
mp=MediaPlayer.create(this,R.raw.ab);

//===================================================
    final Button first=(Button)findViewById(R.id.button1);
    final Button second=(Button)findViewById(R.id.button2);
    first.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) { 
            //start your asynctask
           if(doSomething == null || doSomething.isCancelled()){
            doSomething = new DoSomething();
                doSomething = (DoSomething) doSomething.execute();
           }  }
    });

    second.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) {
   doSomething.cancel(true);

        }  });} 
```

问题：当我退出布局并返回以取消异步任务时，出现问题

```
doSomething.cancel(true); 
```

因为空指针doSomething看到asyntask在运行时没有运行

我用`Status g=doSomething.getStatus();` 的是 PENDING not RUNNING

```
class DoSomething extends AsyncTask<Void, Void, Void>{

    @Override
    protected Void doInBackground(Void... params) {

        while(true){
            if(isCancelled()){
                break;
            }
            final MediaPlayer mp;
            mp=MediaPlayer.create(getBaseContext(),R.raw.ab);

                        mp.start();
                        mp.setOnCompletionListener(new OnCompletionListener() {

                            public void onCompletion(MediaPlayer mp) {
                                mp.release();
                            }
                        });

                try {
                    Thread.sleep(8 * 1000);
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace()  }}
        return null;
    }} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:20:52.110

解决问题的简单方法是将第二次点击更改为

```
second.setOnClickListener(new OnClickListener() {

        public void onClick(View arg0) {
          if(doSomething != null && !doSomething.isCancelled()){
              doSomething.cancel(true);
        }  
    })
; 
```

# ios - iOS：在字符串中查找 url 并将字符串更改为可点击（可点击）

> ID：16172236
> 
> 赞同：3
> 
> 时间：2013-04-23T14:39:56.260
> 
> 标签：ios, iphone

我有一个字符串（例如：“这是一些带有特定[http://goo.gl/45hz](http://goo.gl/45hz)网址的文本”）。我需要找到字符串中的所有 URL（如果有），然后以某种方式转换字符串，以便地址可以点击（如果用户点击它，safari 将打开），我需要在标签中显示带有 URL 的整个字符串（如果可能） .

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:57:43.237

您可以使用从该位置`NSRange` 查找第`http://`一个和和，丢弃之前的文本`http://`，最后您可以使用空格分隔剩余的字符串，获取剩余字符串的第一部分，其中将包含 URL。

```
NSString *givenStr = @"This is some text with specific http://goo.gl/45hz web address in it";
NSRange range = [givenStr rangeOfString:@"http://" options:NSCaseInsensitiveSearch];

if (range.location != NSNotFound) {

  NSString *urlString = [givenStr substringFromIndex:range.location]; 
   // urlString="http://goo.gl/45hz web address in it"

  NSArray *urlStrArray = [urlString componentsSeparatedByString:@" "];

  NSURL *finalURL=[NSURL URLWithString:[urlStrArray objectAtIndex:0]];
   // [urlStrArray objectAtIndex:0]="http://goog.gl/45hz"
} 
```

如@calampunay 所说，为了使 URL 可点击，您应该使用`UITextView`而不是`UILabel`因为`UILabel`只显示纯文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:50:26.793

您可以使用 a`UITextView`而不是`UILabel`. 设置`editable`为`NO`然后修改该属性`@property(nonatomic) UIDataDetectorTypes dataDetectorTypes`以检测 URL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T14:50:52.003

为了找到一个字符串中的所有 URL

```
NSError *error = NULL;

NSString *string = @"This is some text with specific http://goo.gl/45hz web adress in it";
NSDataDetector *detector = [NSDataDetector dataDetectorWithTypes:NSTextCheckingTypeLink error:&error];
NSArray *matches = [detector matchesInString:string
                                     options:0
                                       range:NSMakeRange(0, [string length])];
for (NSTextCheckingResult *match in matches) {
    if ([match resultType] == NSTextCheckingTypeLink) {
        NSURL *url = [match URL];
        NSLog(@"url...%@", url);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T17:26:21.850

如果这是来自 UI 标签，请使用 TTTAttributedLabel - [https://github.com/mattt/TTTAttributedLabel](https://github.com/mattt/TTTAttributedLabel)

非常适合我们。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-03T11:33:58.453

我在 swift 3 中实现了相同的功能。下面是检测字符串中的 url 并使其可点击的完整代码：

```
//put these lines of code inside your function
//add Tap Gesture
    let tapGesture = UITapGestureRecognizer(target: self, action: #selector(tapLabel))
    myLabel?.addGestureRecognizer(tapGesture)

    let input = “tap on url http://www.google.com, to go to google search”
    myLabel?.attributedText = getAttributedString(input: input);

/*** functions to perform complete task ***/

//function to get attributed string with url
func getAttributedString(input : String) -> NSMutableAttributedString {

    let matches = getURLRange(input: input)
    let attributedString = NSMutableAttributedString(string:input)

    for match in matches {
        let url = (input as NSString).substring(with: match.range)
        print(url)

        let linkText = NSMutableAttributedString(string:url, attributes:[NSForegroundColorAttributeName : UIColor.blue] as [String : Any])
        attributedString.replaceCharacters(in: match.range, with: linkText)
    }

    return attributedString
}

//function to get urls range
func getURLRange(input : String) -> [NSTextCheckingResult] {

    let detector = try! NSDataDetector(types: NSTextCheckingResult.CheckingType.link.rawValue)
    let matches = detector.matches(in: input, options: [], range: NSRange(location: 0, length: input.utf16.count))

    return matches
}

// function to check if URL is taped
func tapLabel(gesture: UITapGestureRecognizer) {

    let matches = getURLRange(input: (myLabel?.text)!)

    let tapLocation = gesture.location(in: myLabel)

    let indexOfCharacter = didTapAttributedTextInLabel(label: myLabel!, tapLocation: tapLocation)

    for match in matches {

        if NSLocationInRange(indexOfCharacter, match.range) {

            //open selected URL
            let mainText = myLabel?.text as NSString?
            let urlToOpen = URL(string: (mainText?.substring(with: match.range))!)
            UIApplication.shared.open(urlToOpen!)
            break;
        }else {
            print("Tapped none")
        }

    }

}

//function to get index Of selected Character in string
func didTapAttributedTextInLabel(label: UILabel, tapLocation: CGPoint) -> Int  {

    //here myLabel is the object of UILabel
    //added this from @warly's answer
    //set font of attributedText
    let attributedText = NSMutableAttributedString(attributedString: myLabel!.attributedText!)
    attributedText.addAttributes([NSFontAttributeName: myLabel!.font], range: NSMakeRange(0, (myLabel!.attributedText?.string.characters.count)!))

    // Create instances of NSLayoutManager, NSTextContainer and NSTextStorage
    let layoutManager = NSLayoutManager()
    let textContainer = NSTextContainer(size: CGSize(width: (myLabel?.frame.width)!, height: (myLabel?.frame.height)!+100))
    let textStorage = NSTextStorage(attributedString: attributedText)

    // Configure layoutManager and textStorage
    layoutManager.addTextContainer(textContainer)
    textStorage.addLayoutManager(layoutManager)

    // Configure textContainer
    textContainer.lineFragmentPadding = 0.0
    textContainer.lineBreakMode = myLabel!.lineBreakMode
    textContainer.maximumNumberOfLines = myLabel!.numberOfLines
    let labelSize = myLabel!.bounds.size
    textContainer.size = labelSize

    // get the index of character where user tapped
    let indexOfCharacter = layoutManager.characterIndex(for: tapLocation, in: textContainer, fractionOfDistanceBetweenInsertionPoints: nil)

    return indexOfCharacter
} 
```

它在我的应用程序中经过测试并且运行良好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-23T21:24:13.060

**Ankur**答案的Swift 4 实现：

```
let messageLabel: UILabel = {
        let label = UILabel()
        label.translatesAutoresizingMaskIntoConstraints = false
        label.numberOfLines = 0
        label.font = UIFont.systemFont(ofSize: 14, weight: UIFont.Weight.regular)
        label.isUserInteractionEnabled = true

        return label
    }()

override init(style: UITableViewCell.CellStyle, reuseIdentifier: String?) {
        super.init(style: style, reuseIdentifier: reuseIdentifier)

        self.addSubview(messageLabel)
        // setup messageLabel constraints 

        let tapGesture = UITapGestureRecognizer(target: self, action: #selector(tapLabel))
        messageLabel.addGestureRecognizer(tapGesture)

    }

//function to get attributed string with url
    func getAttributedString(input : String) -> NSMutableAttributedString {

        let matches = getURLRange(input: input)
        let attributedString = NSMutableAttributedString(string:input)

        for match in matches {
            let url = (input as NSString).substring(with: match.range)

            let linkText = NSMutableAttributedString(string:url, attributes:[NSAttributedString.Key(rawValue: NSAttributedString.Key.foregroundColor.rawValue) : UIColor.appleBlue()])
            attributedString.replaceCharacters(in: match.range, with: linkText)
        }

        return attributedString
    }

    func getURLRange(input : String) -> [NSTextCheckingResult] {

        let detector = try! NSDataDetector(types: NSTextCheckingResult.CheckingType.link.rawValue)
        let matches = detector.matches(in: input, options: [], range: NSRange(location: 0, length: input.utf16.count))

        return matches
    }

    //function to get index Of selected Character in string
    func didTapAttributedTextInLabel(label: UILabel, tapLocation: CGPoint) -> Int  {

        //here myLabel is the object of UILabel
        //added this from @warly's answer
        //set font of attributedText
        let attributedText = NSMutableAttributedString(attributedString: messageLabel.attributedText!)
        attributedText.addAttributes([NSAttributedString.Key.font: messageLabel.font], range: NSMakeRange(0, (messageLabel.attributedText?.string.count)!))

        // Create instances of NSLayoutManager, NSTextContainer and NSTextStorage
        let layoutManager = NSLayoutManager()
        let textContainer = NSTextContainer(size: CGSize(width: messageLabel.frame.width, height: messageLabel.frame.height+100))
        let textStorage = NSTextStorage(attributedString: attributedText)

        // Configure layoutManager and textStorage
        layoutManager.addTextContainer(textContainer)
        textStorage.addLayoutManager(layoutManager)

        // Configure textContainer
        textContainer.lineFragmentPadding = 0.0
        textContainer.lineBreakMode = messageLabel.lineBreakMode
        textContainer.maximumNumberOfLines = messageLabel.numberOfLines
        let labelSize = messageLabel.bounds.size
        textContainer.size = labelSize

        // get the index of character where user tapped
        let indexOfCharacter = layoutManager.characterIndex(for: tapLocation, in: textContainer, fractionOfDistanceBetweenInsertionPoints: nil)

        return indexOfCharacter
    }

    // function to check if URL is taped
    @objc func tapLabel(gesture: UITapGestureRecognizer) {

        let matches = getURLRange(input: (messageLabel.text)!)

        let tapLocation = gesture.location(in: messageLabel)

        let indexOfCharacter = didTapAttributedTextInLabel(label: messageLabel, tapLocation: tapLocation)

        for match in matches {

            if NSLocationInRange(indexOfCharacter, match.range) {

                //open selected URL
                let mainText = messageLabel.text as NSString?
                if let urlToOpen = URL(string: (mainText?.substring(with: match.range))!) {
                    UIApplication.shared.open(urlToOpen)
                } else {
                    print("We have error with URL")
                }
                break
            } else {
                print("Tapped none")
            }

        }

    } 
```

# networking - 找出/预测路由器正在/将用于给定连接的端口

> ID：16172240
> 
> 赞同：1
> 
> 时间：2013-04-23T14:40:09.093
> 
> 标签：networking, nat, hole-punching

我知道[ipchicken.com](http://www.ipchicken.com)会告诉你路由器的 IP 地址和它用于连接的端口。但是这些信息可以“本地”获得吗？（不依赖网站）。

我想要的是在两个随机主机之间建立连接……中间没有“专用服务器”。我的问题是通过 NAT 到达。我认为最好的选择是一种 TCP 打孔，两台主机都连接到某个地方，然后相互告知（可以通过电话或聊天或类似方式）当前的 IP 地址和路由器正在使用的端口号。它应该欺骗路由器将数据包转发到主机，尽管来自与它们最初连接的不同来源。

[是否有可能以比ipchicken.com](http://www.ipchicken.com)更本地的方式找到您的路由器用来修补您的端口号？对解决此问题的其他可能方法有什么想法吗？

编辑：在这种情况下，在路由器上设置端口转发不是一个选项，因为很多人（包括我）对他们的路由器没有管理员权限，我不想将这样的任务强加给我的应用程序的“用户”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T05:31:04.690

路由器将为每个传出连接使用不同的源端口，因此基于传出连接的检查不适用于您的用例。

对于传入连接，即，如果您想访问 NAT 设备后面的特定机器（如家庭路由器），您必须明确打开路由器上的一些端口并设置转发规则。然后，路由器将侦听该端口上的传入连接，并根据配置的规则将其转发到 machine:port。

你如何做到这一点取决于特定的路由器品牌/型号。搜索网页或登录到管理界面并环顾四周，应该很容易找到。但是，请确保您了解在路由器上打开端口的安全隐患！

**基于已编辑问题的更新：**

如果没有端口转发并且两个设备都在 NAT 之后，您唯一的解决方案是拥有一个中间服务器！如果其中只有一个在 NAT 之后，您可以让该机器启动连接。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-11-22T21:21:30.103

您可以使用 Stun 服务器作为外部全局可访问服务器。

# regex - 用bash中的正则表达式匹配字符串中所有匹配字符的位置

> ID：16172245
> 
> 赞同：2
> 
> 时间：2013-04-23T14:40:13.840
> 
> 标签：regex, bash, hex, match

我正在尝试通过正则表达式匹配特定字符的所有位置。我可以用*expr 索引*来做到这一点，但这只匹配字符串中的第一个字符。

```
echo $(expr index "$z" '[\x1F\x7F-\x9F]') 
```

**注意：$z 是包含字符串的 var**

这（正确）返回：

```
6 
```

我知道在这个字符串中，我在位置 6 和 12 有两个匹配的字符，我想返回匹配字符的所有位置，而不仅仅是第一个。

你能帮助我吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T13:37:39.387

这是一个使用 awk 的命令。它打印与正则表达式匹配的所有位置`/0-9/`

```
echo $z | awk  '{s=$0; i=1; idx=0; 
       while(i>0){ 
           i=match(s, /[0-9]/); 
           if(i>0) {
                  idx += i;
                  print idx; 
                  s=substr(s, i+1);
           }
       }
}' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-06-06T09:24:44.847

您可能喜欢使用`grep`.

```
#!/bin/bash

matches=();

# Used a "Process Substitution" because of the loop's subshell
while read match
do
    matches+=( "$match" );
done \
< <(
    printf '%s\n%s' \
        'somedata{a917am}some{8ka81a}data' \
        'awd123{ad123d}adad' \
        | grep -Eobn '\{[0-9a-z]{6}\}' # The magic is here
);

for (( i = 0; i < ${#matches[@]}; i++ ));
do
    matchRaw="${matches[$i]}";
    match="${matchRaw#*\:}";
    match="${match#*\:}";
    matchLine="${matchRaw%%\:*}";
    matchChar="${matchRaw#*\:}";
    matchChar="${matchChar%%\:*}";
    matchLength="${#match}";

    printf 'Match #%s, line %2s, char %2s, length %2s: "%s"\n' \
        "$((i + 1))" \
        "$matchLine" \
        "$matchChar" \
        "$matchLength" \
        "$match";
done 
```

输出：

```
Match #1, line  1, char  8, length  8: "{a917am}"
Match #2, line  1, char 20, length  8: "{8ka81a}"
Match #3, line  2, char 39, length  8: "{ad123d}" 
```

适用于`grep (GNU grep) 2.25`.

有关的：

```
grep --help

# -E, --extended-regexp     PATTERN is an extended regular expression (ERE)
# -o, --only-matching       show only the part of a line matching PATTERN
# -b, --byte-offset         print the byte offset with output lines
# -n, --line-number         print line number with output lines 
```

[进程替换](https://www.gnu.org/software/bash/manual/bash.html#Process-Substitution)（[来自](https://stackoverflow.com/a/22691677/5113030)）

# python - 从文本文件中检索随机预格式化的文本

> ID：16172247
> 
> 赞同：2
> 
> 时间：2013-04-23T14:40:15.220
> 
> 标签：python, regex, gettext

我正在编写一个 python 脚本来获取格式化为`StartTime="mm/dd/yyyy hh:mm:ss:ccc"`并`EndTime="mm/dd/yyyy hh:mm:ss:ccc"`位于文本文件中的字符串。

所以我继续搜索`StartTime`，`Endtime`但我怎样才能得到 ( `="mm/dd/yyyy hh:mm:ss:ccc"`) 之后的内容？当我得到`StartTime`and`EndTime`字符串时，我想将它们保存在另一个带有函数的文本文件中，`saveIntoFile(File, textToSave)`但我想我可以自己处理这部分。

```
def getTimeCode(File) :
    fopen = open(File, 'r')    
    text = fopen.read()
    for t in text :
        if t == "StartTime" :
            #what should I do now ?
        if t == "EndTime" :
            #what should I do now ?

def saveIntoFile(filename, textToSave): 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:43:27.403

```
import re

def getTimeCode(fn):
    with open(fn, 'r') as f:
        for line in f:
            m = re.search(r'(\w)="(\d\d/\d\d/\d\d\d\d \d\d:\d\d:\d\d:\d\d\d)"', line)
            if m:
                if m.group(1) == 'StartTime':
                    # do something with m.group(2)
                elif m.group(1) == 'EndTime':
                    # do something with m.group(2)
                else:
                    # m.group(1) unknown 
```

# jinja2 - Jinja2 for 循环的行为类似于 with

> ID：16172253
> 
> 赞同：0
> 
> 时间：2013-04-23T14:40:30.423
> 
> 标签：jinja2

我想迭代一组对象并找到一个特定属性的最大值，但是 jinja2 忽略迭代器内对在迭代器外部声明的变量的任何操作。例如：

```
{% set maximum = 1 %}
{% for datum in data %}
    {% if datum.frequency > 1 %}
        {% set maximum = datum.frequency %}
    {% endif %}
{% endfor %}
{# maximum == 1 #} 
```

`datum.frequency``datum`对于某些in肯定大于 1 `data`。

**编辑（解决方案）**

这与[这篇文章](https://stackoverflow.com/questions/9486393/jinja2-change-the-value-of-a-variable-inside-a-loop)*类似*，但还有更多内容。以下工作并且非常难看。

```
{% set maximum = [1] %}
{% for datum in data %}
    {% if datum.freq > maximum[-1] %}
        {% if maximum.append( datum.freq ) %}{% endif %}
    {% endif %}
{% endfor %}
{% set maximum = maximum[-1] %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T14:27:06.543

您是否考虑过编写自定义过滤器来返回集合中特定属性的最高值？作为维护“关注点分离”的一部分，我更喜欢尽量减少在 Jinja2 模板中使用的逻辑量。

这是一个非常好的示例的链接，该示例说明了如何用 python 编写： [Custom jinja2 filter for iterator](https://stackoverflow.com/questions/5481205/custom-jinja2-filter-for-iterator)

一旦你的过滤器返回你需要使用'|'访问它的值 像这样：

```
{% set maximum = datum|filtername %} 
```

# php - 在输入的序列和存储在数据库中的序列之间创建百分比匹配（问卷）PHP MySQL

> ID：16172255
> 
> 赞同：0
> 
> 时间：2013-04-23T14:40:32.283
> 
> 标签：php, mysql, match

我想知道是否有人可以帮助我。

客户完成评估，每个答案是 1-5 之间的单选值，共有 10 个问题。因此，因此；

***评估表***

评估ID | 学生证 | q1 | q2 | q3.....q10

1 - 1001 - 1 - 5 - 3 - 2

职业表有 10 个职业，每个职业的评分在 1-5 之间（这是为每个职业设置的）

***职业表***

职业生涯 | 职业名称 | q1 | q2 | q3.....q10

1 - 医生 - 5 - 2 - 1 - 3

我试图创建一个结果页面，该页面将检查一个序列与另一个序列，例如评估表中的 q1 与职业表中的 q1。

为了进一步解释，用户将为问题 1 输入一个介于 1-5 之间的值。这将与职业 1 的 q1 值相匹配。这将针对每个问题重复，直到问题 10。将显示总体结果（匹配百分比） - 即用户和特定职业的匹配百分比。然后将针对所有剩余的职业重复此过程。

我希望结果以降序显示，并且只显示前 5 个。

结果应显示为

职业名称（结果匹配百分比） 超链接（到外部网站）

目前我让它工作，但它有很多查询，例如：

```
<?php
$career1sequence1 = mysql_result (mysql_query ("SELECT `q1` FROM `careers` WHERE `careerid ` = '1'"), 0):
$question1 = mysql_result (mysql_query ("SELECT `q1` FROM `assessment` WHERE `studentid` = $session_studentid"), 0);
$career1result1 = $question1/$career1sequence1;
if ($career1result1>1)  {
    $career1result1 = $careersequence1/$question1
}
?> 
```

对每个问题输入/职业序列值重复此查询。有谁知道是否有更简单的方法可以更直接地做到这一点？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-31T17:27:17.720

我们有一个应用程序，我们希望在其中验证用户在 Web 应用程序中输入的姓名，并根据庞大的姓名数据库实时检查。如果找到任何匹配的名称，则必须报告。我已经看到您的输出结果（[C# 中的模糊文本（句子/标题）匹配](https://stackoverflow.com/questions/53480/fuzzy-text-sentences-titles-matching-in-c-sharp?rq=1)）几乎与我们需要的相似。我们正在使用 MS SQL 数据库并使用 Levenshtein 逻辑和匹配的 %。目前执行交易需要将近 2 分钟。希望能帮助我优化/调整它们。谢谢

# sql-server - 消息 8152，字符串或二进制数据将被截断

> ID：16172259
> 
> 赞同：18
> 
> 时间：2013-04-23T14:40:41.830
> 
> 标签：sql-server, error-handling

我有这张桌子：

```
CREATE TABLE Vendors

(
    VendorID            NUMERIC(10)     NOT NULL,
    VendorName          CHAR(50)        NOT NULL,
    VendorAddress       VARCHAR(30)     NULL,
    VendorCityName      VARCHAR(20)     NOT NULL,
    VendorStateName     CHAR(2)         NOT NULL,
    VendorZip           VARCHAR(10)     NULL,
    VendorContactName   CHAR(50)        NOT NULL,
    VendorContactPhone  VARCHAR(12)     NOT NULL,
    VendorContactEmail  VARCHAR(20)     NOT NULL,
    VendorSpecialty     CHAR(20)        NOT NULL

    CONSTRAINT VendorsPK        PRIMARY KEY (VendorID)      
); 
```

而这个插入：

```
INSERT INTO Vendors(VendorID, VendorName, VendorAddress, 
  VendorCityName, VendorStateName, VendorZip, VendorContactName, 
  VendorContactPhone, VendorContactEmail, VendorSpecialty)
VALUES(151330, 'Hyperion', '77 West 66th Street', 'New York', 
  'NY', 10023, 'John Hinks', '212-337-6564', 
  'jhinks@hyperionbooks.com', 'Popular fiction') 
```

为什么这个语句会产生 8152 错误？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-04-23T14:45:30.890

`VendorContactEmail`只有 20 个字节。第一行 ( ) 上的电子邮件地址`jhinks@hyperionbooks.com`比这更长 - 24 个字节。而且许多电子邮件地址会更长。谁决定在电子邮件地址栏中只允许 20 个字符？根据标准，这应该是`VARCHAR(320)`- 64 个字符`<localpart>`+ 1 `@`+ 255 个`<domain>`.

至于错误信息本身，今天比当时更容易找到罪魁祸首。

*   [字符串或二进制数据将被截断：替换臭名昭著的错误 8152](https://blogs.msdn.microsoft.com/sql_server_team/string-or-binary-data-would-be-truncated-replacing-the-infamous-error-8152/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-02-09T17:39:13.513

## 如何强制导致截断的操作仍然执行

*   你知道什么是截断吗？
*   你知道什么会被截断吗？
*   您是否打算截断长数据以适应？

**当且仅当您对上述问题回答*“是”*时，您可以强制插入忽略警告并运行。**如果您对以上任何一项的回答为否，请继续阅读。

```
SET ANSI_WARNINGS  OFF;
-- Your operation TSQL here.
SET ANSI_WARNINGS ON; 
```

[（资源）](https://stackoverflow.com/a/28651555/2350083)

### 在这种情况下截断是什么

截断只是将尽可能多的值放入列中，然后丢弃任何不适合的部分。例如，将*The quick brown fox jumps over the lazy dog*截断为 13 个字符将是*The quick bro*

### 为什么我会收到此错误消息

当您尝试插入不适合目标列定义的数据时，您会收到此错误，因为数据太短。

### 我正在尝试插入多行数据并想确定哪些行不适合

[Aaron 的出色回答](https://stackoverflow.com/a/16172377/2350083)指出，如果您运行的是 SQL Server 2019 或更高版本，您实际上会收到一条[消息](https://docs.microsoft.com/en-us/archive/blogs/sql_server_team/string-or-binary-data-would-be-truncated-replacing-the-infamous-error-8152)，其中包含不适合的列和值 - 这太棒了！但是，如果您运行的不是新版本，请继续阅读以获取提示。

如果您在尝试批量插入多行数据时收到此错误消息，您可以尝试将插入拆分为多个插入并分别运行它们以缩小 long 值的位置。

或者，您可以将数据插入到一个新的临时表中，并在该临时表中搜索不适合您的目标表的值。

```
--(insert into new temp table #Vendors)
INSERT INTO #Vendors(VendorID, VendorName, VendorAddress, 
  VendorCityName, VendorStateName, VendorZip, VendorContactName, 
  VendorContactPhone, VendorContactEmail, VendorSpecialty)
VALUES(151330, 'Hyperion', '77 West 66th Street', 'New York', 
  'NY', 10023, 'John Hinks', '212-337-6564', 
  'jhinks@hyperionbooks.com', 'Popular fiction') 
```

然后查询不适合的行。

```
--(query for values that don't fit)
SELECT *,
LEN(VendorContactEmail) AS Length
FROM #Vendors
WHERE LEN(VendorContactEmail) > 20 --set your destination column length is here 
```

有关空白处理和二进制数据长度的信息，另请参阅[`LEN`](https://docs.microsoft.com/en-us/sql/t-sql/functions/len-transact-sql)和[`DATALENGTH`](https://docs.microsoft.com/en-us/sql/t-sql/functions/datalength-transact-sql)文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-12-26T06:17:44.957

您还可以使用以下表达式最小化列值的长度：

```
LEFT(columnName, 250) + '...' 
```

我试过了，它有效。

# build - TFS 2012 构建服务器不工作，收到 HTTP 错误代码 500

> ID：16172261
> 
> 赞同：1
> 
> 时间：2013-04-23T14:40:44.153
> 
> 标签：build, tfsbuild

我们已经设置了一个新的 TFS 2012 构建服务器，但我们无法让它工作。即使配置并启用了构建控制器和代理，排队的构建也不会显示任何进度。

当我们单击 TFS 管理控制台中构建配置节点上的“详细信息”链接时，我们会收到错误“HTTP Code 500: System.ServiceModel.ServiceActivationException”。

我们如何解决这个问题？

PS 我们已经安装在 Windows Server 2012 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:03:49.240

发现了问题。不是多个主机标头，而只是应用层上的 SSL 绑定 - 为此调整了 web.config。我们有构建和日志，yippee！

# prolog - Prolog 家谱编译错误

> ID：16172263
> 
> 赞同：1
> 
> 时间：2013-04-23T14:40:48.440
> 
> 标签：prolog

编译时收到两条错误消息：

```
"Clauses of (-)/1 are not together in source-file" and
"Singleton variables: [X]" 
```

...这两个是我遇到的错误的例子...

我已经尝试删除源代码中的一些事实，这样所有事实都不会发生冲突，并且我尝试将人定义为原子而不是子句......它们都没有像我希望的那样起作用，有任何想法吗？

```
male(X).
female(X).
parent(X,Y).
father(X,Y):- male(X), parent(X,Y).
mother(X,Y):- female(X), parent(X,Y).
descendant(X,Y):- parent(Y,X).
sibling(X,Y):- descendant(X,Z), descendant(Y,Z).
brother(X,Y):- male(X), sibling(X,Y).
sister(X,Y):- female(X), sibling(X,Y).
grandparent(X,Y):- parent(X,Z), parent(Z,Y).
paternalgrandparent(X,Y):- father(X,Z), father(Z,Y).
ancestor(X,Y):- parent(X,Y).
ancestor(X,Y):- ancestor(X,Z), parent(Z,Y).
male(edward).
male(sean).
male(kevin).
female(vicky).
male(malcolm).
male(claude).
male(matthew).
female(stephania).
male(kurt).
male(david).
male(mark).
male(raymond).
female(therese).
female(nadine).
female(nathalie).
male(richard).
female(mary).
male(john).
female(lilian).
female(inez).
male(william).
female(rose).
male(richie).
female(alice).
brother(edward,vicky).
brother(kevin,sean).
brother(sean,vicky).
sister(vicky,edward).
brother(malcolm,claude).
brother(claude,malcolm).
brother(matthew,stephania).
brother(kurt,matthew).
sister(stephania,kurt).
brother(david,mark).
brother(mark,david).
sister(therese,nadine).
sister(nadine,therese).
sister(lilian,inez).
sister(inez,lilian).
father(david,edward).
mother(therese,edward).
father(mark,malcolm).
mother(nathalie,malcolm).
father(raymond,matthew).
mother(nadine,matthew).
father(richard,david).
mother(mary,david).
father(john,therese).
mother(lilian,therese).
paternalgrandparent(richard,edward).
grandparent(mary,edward).
grandparent(lilian,edward).
grandparent(john,edward).
paternalgrandparent(richard,malcolm).
grandparent(mary,malcolm).
grandparent(lilian,matthew).
grandparent(john,matthew).
father(william,richard).
mother(rose,richard).
paternalgrandparent(william,david).
grandparent(rose,david).
father(richie,william).
mother(alice,william).
paternalgrandparent(richie,richard).
grandparent(alice,richard).
ancestor(richie,william).
ancestor(alice,william).
ancestor(william,richard).
ancestor(rose,richard).
ancestor(richard,david).
ancestor(mary,david).
ancestor(david,edward).
ancestor(therese,edward).
ancestor(lilian,therese).
ancestor(john,therese).
ancestor(lilian,nadine).
ancestor(john,nadine).
ancestor(richard,mark).
ancestor(mary,mark). 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:52:47.833

“子句不在一起”是最容易修复的错误：只需重新排列程序的事实，使所有具有相同名称的事实（例如`male/1`，`female/1`等）一起出现在程序的源代码中。

“单例变量”错误来自以下几行：

```
male(X).
female(X).
parent(X,Y). 
```

当一个变量在实体规则或事实中只被提及一次时，它是单例的。如果您确实需要这些变量，则应将它们替换为下划线。但是，在您的情况下，您不需要这些变量：否则，像这样的规则

```
male(_). 
```

会断言任何人都是男性，而您不希望这种情况发生。您应该简单地删除这些规则以使单例错误消失。

但是，您的程序最大的问题似乎是您试图为已经通过规则定义的事物定义事实。您需要的事实是`male/1`、`female/1`和`parent/2`。其他一切都可以通过规则正确推导出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:56:13.610

它们应该只是警告而不是错误。第一条消息是告诉您一起定义谓词。

所以例如

```
male(edward).
male(sean).
male(kevin).
female(vicky).
male(malcolm). 
```

不好。这样做的原因是你传播了男性的定义，代码变得完全不可读。

第二个是告诉你，如果你在头部使用一个变量，你应该在正文中使用它。

所以例如

```
male(X). 
```

不好。你可以写

```
male(_). 
```

同样，单例变量经常会导致您尝试编写的内容出现错误，因此最好使用 _ 来明确使用它们。

# python - Python 列表帮助（递增计数，追加）

> ID：16172268
> 
> 赞同：2
> 
> 时间：2013-04-23T14:40:55.347
> 
> 标签：python, arrays, list

我正在尝试连接 google 的 geocode api 和 github api 来解析用户的位置并从中创建一个列表。

我要创建的数组（列表）是这样的：

```
location, lat, lon, count
San Francisco, x, y, 4
Mumbai, x1, y1, 5 
```

从谷歌地理编码中解析位置、纬度和经度，计数是该位置的出现。每次添加新位置时：如果它存在于列表中，则计数增加，否则将其附加到具有位置、纬度、经度的数组（列表），并且计数应为 1。

另一个例子：

```
location, lat, lon, count
Miami x2, y2, 1 #first occurrence
San Francisco, x, y, 4 #occurred 4 times already
Mumbai, x1, y1, 5 #occurred 5 times already
Cairo, x3, y3, 1 #first occurrence 
```

我已经可以从 github 获取用户的位置，并且可以从 google 获取地理编码数据。我只需要在我正在努力解决的 python 中创建这个数组。

谁能帮我？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T14:57:32.170

使用`collections.Counter`，您可以执行以下操作：

```
from collections import Counter

# initial values
c=Counter({("Mumbai", 1, 2):5, ("San Francisco", 3,4): 4})

#adding entries
c.update([('Mumbai', 1, 2)])
print c  # Counter({('Mumbai', 1, 2): 6, ('San Francisco', 3, 4): 4})

c.update([('Mumbai', 1, 2), ("San Diego", 5,6)])
print c  #Counter({('Mumbai', 1, 2): 7, ('San Francisco', 3, 4): 4, ('San Diego', 5, 6): 1}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T14:46:02.740

这将更好地存储为字典，按城市名称索引。您可以将其存储为两个字典，一个用于纬度/经度的元组字典（因为纬度/经度永远不会改变）：

```
lat_long_dict = {}
lat_long_dict["San Francisco"] = (x, y)
lat_long_dict["Mumbai"] = (x1, y1) 
```

和 a`collections.defaultdict`用于计数，因此它始终从 0 开始：

```
import collections
city_counts = collections.defaultdict(int)

city_counts["San Francisco"] += 1
city_counts["Mumbai"] += 1
city_counts["San Francisco"] += 1
# city counts would be
# defaultdict(<type 'int'>, {'San Francisco': 2, 'Mumbai': 1}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T14:50:32.493

Python 有一个专门用于计算事物发生次数的预烘焙类：它称为[`collections.Counter`](http://docs.python.org/3.3/library/collections.html#collections.Counter). `(city, lat, lon)`如果您可以生成一个迭代器，该迭代器从您的输入数据中给出连续的元组（可能使用生成器表达式），只需将其传递`Counter`给您将直接为您提供所需的内容。例如，

```
>>> locations = [('Miami', 1, 1), ('San Francisco', 2, 2), ('Mumbai', 3, 3), ('Miami', 1, 1), ('Miami', 1, 1)]
>>> Counter(locations)
Counter({('Miami', 1, 1): 3, ('San Francisco', 2, 2): 1, ('Mumbai', 3, 3): 1}) 
```

如果您需要能够在程序运行时添加更多位置而不是批处理它们，请将相关元组放入该计数器的`update`方法中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T15:15:45.663

这是所有其他推荐想法的融合：

```
from collections import defaultdict

inputdata = [('Miami', 'x2', 'y2'),
             ('San Francisco', 'x', 'y'),
             ('San Francisco', 'x4', 'y4'),
             ('Mumbai', 'x1', 'y1'),
             ('Cairo', 'x3', 'y3')]

counts, coords = defaultdict(int), defaultdict(list)

for location, lat, lon in inputdata:
    coords[location].append((lat,lon))
    counts[location] += 1

print counts, coords 
```

这使用了 defaultdict，正如您所看到的，它提供了一种简单的方法：

1.  *按城市*统计出现次数
**   保持纬度/经度对完好无损*

 *回报：

```
defaultdict(<type 'int'>, {'Miami': 1, 'San Francisco': 2, 'Cairo': 1, 'Mumbai': 1}) 
defaultdict(<type 'list'>, {'Miami': [('x2', 'y2')], 'San Francisco': [('x', 'y'), ('x4', 'y4')], 'Cairo': [('x3', 'y3')], 'Mumbai': [('x1', 'y1')]}) 
```

这个答案做出了一个（未经验证的）假设，即您的纬度/经度对的粒度不太可能重复，但实际上您只对按城市进行计数感兴趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T14:48:20.547

使用python dict怎么样？你可以在这里阅读它们

[http://docs.python.org/2/tutorial/datastructures.html#dictionaries](http://docs.python.org/2/tutorial/datastructures.html#dictionaries)

这是一个示例实现：

```
// Create an empty dictionary.
dat = {}

if dat.has_key(location):
    dat[location] = dat[location] + 1
else:
    dat[location] = 1 
```*

# css - CSS 向右浮动 - 不清楚计算的高度和边距是如何工作的

> ID：16172272
> 
> 赞同：1
> 
> 时间：2013-04-23T14:41:10.380
> 
> 标签：css, html

为什么是这个 HTML 代码：

```
<html>
    <head>
        <style type="text/css">
            .left { background-color: yellow; }
            .right { float: right;  background-color: lightgray; width: 150px; }
        </style>
    </head>
    <div>
        <div class="right">
            <p>right</p>
        </div>

        <div class="left">
            <p>left</p>
        </div>
    </div>
</html> 
```

...导致比（在 FF 和 chrome 中） `div.right`更高（高度大于）：`div.left`![在此处输入图像描述](https://i.stack.imgur.com/J1aeU.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:43:45.183

重置您的`<p>`标签。

```
p {margin:0;padding:0;} 
```

更多关于重置 CSS。

[http://meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:13:05.967

因为你是浮动的`right div`而不是浮动的`left div`。这意味着`margin`on the`p`在内部，`right div`而对您`left div`来说它位于外部`div`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:23:50.107

您在这里看到的是折叠边距和浮动之间的交互。

考虑以下 HTML：

```
<div class="wrap">
    <div class="right">
        <p>right</p>
    </div>
    <div class="left">
        <p>left</p>
    </div>
</div> 
```

除了包装器元素之外，这基本上就是您所拥有的。

现在看看CSS：

```
.wrap {
    outline: 2px dotted red;
    padding: 1px;
}
p {
    outline: 1px dotted blue;
    margin: 2.00em 0;
}
.left {
    background-color: yellow;
}
.right {
    float: right;
    background-color: lightgray;
    width: 150px;
} 
```

我添加`.wrap`了 1px 填充以确保您可以看到边距的效果。

现在这里是小提琴：http: [//jsfiddle.net/audetwebdesign/9hhkk/](http://jsfiddle.net/audetwebdesign/9hhkk/)

您在此处看到的是同一基线上的两个文本，以及您期望的右侧浮动文本。左右元素具有相同的边距。

在您的示例中，`.left`折叠的上边距与其包含块的上边距一起折叠。但是，该`.right`元素是浮动的，并且浮动元素的边距不会塌陷，因此您会看到额外的填充。

我设置了我的演示，以便流入元素的边距不会折叠。

# php - 在调试模式下添加扩展得到：“chmod（）：不允许操作”

> ID：16172277
> 
> 赞同：1
> 
> 时间：2013-04-23T14:41:28.817
> 
> 标签：php, yii, file-permissions, yii-extensions, font-awesome

当我向 Yii 添加扩展（EfontAwesome，参考：[www.yiiframework.com/extension/efontawesome](http://www.yiiframework.com/extension/efontawesome/)）时，我得到“chmod（）：不允许操作”
调用堆栈看起来像这样。

```
/opt/lampp/htdocs/yii-1.1.13/framework/utils/CFileHelper.php(133)

121         while(($file=readdir($folder))!==false)
122         {
123             if($file==='.' || $file==='..')
124                 continue;
125             $path=$src.DIRECTORY_SEPARATOR.$file;
126             $isFile=is_file($path);
127             if(self::validatePath($base,$file,$isFile,$fileTypes,$exclude))
128             {
129                 if($isFile)
130                 {
131                     copy($path,$dst.DIRECTORY_SEPARATOR.$file);
132                     if(isset($options['newFileMode']))
133                         chmod($dst.DIRECTORY_SEPARATOR.$file,$options['newFileMode']);
134                 }
135                 elseif($level)
136                     self::copyDirectoryRecursive($path,$dst.DIRECTORY_SEPARATOR.$file,$base.'/'.$file,$fileTypes,$exclude,$level-1,$options);
137             }
138         }
139         closedir($folder);
140     }
141 
142     /**
143      * Returns the files found under the specified directory and subdirectories.
144      * This method is mainly used by {@link findFiles}.
145      * @param string $dir the source directory
Stack Trace
#0  
+  /opt/lampp/htdocs/yii-1.1.13/framework/utils/CFileHelper.php(133): chmod("/opt/lampp/htdocs/im/assets/6950b6ca/css/font-awesome.css", 438)
#1  
+  /opt/lampp/htdocs/yii-1.1.13/framework/utils/CFileHelper.php(136): CFileHelper::copyDirectoryRecursive("/opt/lampp/htdocs/im/protected/extensions/EFontAwesome/assets/cs...", "/opt/lampp/htdocs/im/assets/6950b6ca/css", "/css", array(), ...)
#2  
+  /opt/lampp/htdocs/yii-1.1.13/framework/utils/CFileHelper.php(63): CFileHelper::copyDirectoryRecursive("/opt/lampp/htdocs/im/protected/extensions/EFontAwesome/assets", "/opt/lampp/htdocs/im/assets/6950b6ca", "", array(), ...)
#3  
+  /opt/lampp/htdocs/yii-1.1.13/framework/web/CAssetManager.php(251): CFileHelper::copyDirectory("/opt/lampp/htdocs/im/protected/extensions/EFontAwesome/assets", "/opt/lampp/htdocs/im/assets/6950b6ca", array("exclude" => array(".svn", ".gitignore"), "level" => -1, "newDirMode" => 511, "newFileMode" => 438))
#4  
–  /opt/lampp/htdocs/im/protected/extensions/EFontAwesome/components/EFontAwesome.php(41): CAssetManager->publish("/opt/lampp/htdocs/im/protected/extensions/EFontAwesome/assets", false, -1, true)
36     public function getAssetsUrl() {
37         if (isset($this->_assetsUrl))
38             return $this->_assetsUrl;
39         else {
40             $assetsPath = Yii::getPathOfAlias('efontawesome.assets');
41             $assetsUrl = Yii::app()->assetManager->publish($assetsPath, false, -1, YII_DEBUG);
42             return $this->_assetsUrl = $assetsUrl;
43         }
44     }
45 } 
```

这仅在调试模式下发生，而不是在生产模式下发生。该目录可由 Web 进程写入（可以看出它在生产模式下工作），并且这个扩展在几天前在调试模式下运行良好，

一个简短的谷歌搜索只在 github 上购买了这个已关闭的问题：[https](https://github.com/yiisoft/yii/issues/1853) ://github.com/yiisoft/yii/issues/1853关于forcedCopy 和linkAssets 配置冲突，这在Yii-1.1.13（我的版本）中已修复使用），为了安全起见，我还尝试在这样的主配置文件中将两者的配置设置为 false

```
'assetManager' => array(
            'linkAssets' => false,
            'forceCopy'=>false,
        ), 
```

但问题仍然存在，关于如何解决这个问题的任何想法？

# android - 从服务启动已经运行的活动

> ID：16172282
> 
> 赞同：0
> 
> 时间：2013-04-23T14:41:35.537
> 
> 标签：android, android-intent, service, broadcastreceiver

我正在尝试制作锁定屏幕，所以我在它的广播接收器和 MainActivity 中创建了服务类 n。它一直工作到屏幕关闭，当屏幕打开时，主要活动关闭并显示异常。请帮我解决它。

我的服务.java

```
package com.example.broadcast_receiver;
import android.app.Service;
...

public class MyService extends Service {

    @Override
    public IBinder onBind(Intent intent) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public void onCreate() {
        // TODO Auto-generated method stub
        Log.i("[myService]", "onCreate");
        registerReceiver(mybroadcast, new IntentFilter(Intent.ACTION_SCREEN_ON));
        registerReceiver(mybroadcast, new IntentFilter(Intent.ACTION_SCREEN_OFF));
    }

    @Override
    public void onStart(Intent intent, int startId) {
        Toast.makeText(this, "My Service Started", Toast.LENGTH_LONG).show();
        Log.i("[myService]", "onStart");  
    }

    @Override
    public void onDestroy() {
        Toast.makeText(this, "MyService Stopped", Toast.LENGTH_LONG).show();
        Log.i("[myService]", "onDestroy");
    }

    BroadcastReceiver mybroadcast = new BroadcastReceiver(){

        @Override
        public void onReceive(Context context, Intent intent) {
            // TODO Auto-generated method stub
            Log.i("[BroadcastReceiver]", "MyReceiver");

            if(intent.getAction().equals(Intent.ACTION_SCREEN_ON)){
                Log.i("[BroadcastReceiver]", "Screen ON");
                Intent i=new Intent(context, MainActivity.class);
                i.setFlags(Intent.FLAG_ACTIVITY_PREVIOUS_IS_TOP);
                context.startActivity(i);

            }
            else if(intent.getAction().equals(Intent.ACTION_SCREEN_OFF)){
                Log.i("[BroadcastReceiver]", "Screen OFF");
            }
        }

    };
} 
```

MainActivity.java

```
package com.example.broadcast_receiver;
import android.os.Bundle;
...

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Log.i("[MainActivity]", "Created");

        try{
        boolean a=isMyServiceRunning();
        if(a==false){
            startService(new Intent(this,MyService.class));
        }
        }catch (Exception e) {
            // TODO: handle exception
            Log.i("Error", e.getMessage().toString());
            Toast.makeText(this, e.getMessage().toString(), Toast.LENGTH_LONG).show();
        }
    }

    private boolean isMyServiceRunning() {
        ActivityManager manager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
        for (RunningServiceInfo service : manager.getRunningServices(Integer.MAX_VALUE)) {
            if (MyService.class.getName().equals(service.service.getClassName())) {
                return true;
            }
        }
        return false;
    }
} 
```

AndroidManifest.xml（未添加用户权限）

```
 <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >

         <service android:name="com.example.broadcast_receiver.MyService"
             android:label="@string/app_name"
             android:icon="@drawable/ic_launcher" ></service>

        <activity
            android:name="com.example.broadcast_receiver.MainActivity"
            android:label="@string/app_name"
            android:launchMode="singleTop" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application> 
```

请帮我解决dis问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:28:40.177

该错误告诉您，如果`startActivity()`不`Activity`设置`Intent flag NEW_TASK`. 致电前添加`Intent.FLAG_ACTIVITY_NEW_TASK`到您的`Intent``startActivity()`

```
Intent i=new Intent(context, MainActivity.class);
i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
context.startActivity(i); 
```

# ios - 编译错误：#error“此文件应仅在 ARM 模式下编译。”

> ID：16172283
> 
> 赞同：0
> 
> 时间：2013-04-23T14:41:40.023
> 
> 标签：ios, ipad, compilation, compiler-errors, arm

尝试将应用程序安装到我的 ipad 4 时出现编译错误：

# 错误“此文件应仅在 ARM 模式下编译。”

会发生什么以及如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:45:25.400

该应用程序可能是为 IOS 模拟器而不是为实际设备编译的，这正是它所说的，应该为 arm 编译，但你为 intel 编译

# c# - 从另一个类运行 Nunit 断言

> ID：16172289
> 
> 赞同：0
> 
> 时间：2013-04-23T14:41:56.063
> 
> 标签：c#, unit-testing, nunit, assertions

我有两个课程来建立订单。基本上创建订单的类工作正常，但我想使用断言来验证返回的信息。第一个类使用通用值建立订单，并为我在另一个类中应用实际信息做好准备。这是一个示例：

```
 public static OrderService Build(int Id, string password)
        {  
            var req = new OrderRequest
                {
                    Start = run,
                    Passsword = password,
                    ID = custId,
                };

            return req;
        } 
```

这是该类的示例，它将使用我通过的示例数据测试结果：

```
 [TestCase(12565, "passWord")]
    public static void Case(int custId, string password)
    {
        var create = new Order();

        var req = Order.Build(custId, password);
        if (req == null) return;

        create.Resp = ws.Run(req) as OrderResponse;
        Assert.IsNotNull(create.Resp);
    } 
```

这些测试将自行运行并对服务进行排序，但我的问题是能够将断言实现到第一个类中，因此我不必将其放入实际的测试用例中。我正在使用来自 Web 服务的请求和响应，所以它对我来说有点棘手。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:45:39.357

您应该使用[moq](http://code.google.com/p/moq/)等模拟框架，而不是实际调用 Web 服务。

对数据库或 Web 服务等外部技术的调用不会包含在单元测试中。单元测试测试业务逻辑。

**单元测试**：测试类的内部工作——通常在方法级别。它应该是与其他资源或系统无关的独立测试。

**集成测试**：测试多个子系统的正确互操作。

# asp.net - 动态传递集合名称

> ID：16172293
> 
> 赞同：0
> 
> 时间：2013-04-23T14:42:13.853
> 
> 标签：asp.net, collections, http-headers

任何人都可以建议一个简单但棘手的查询。我有一个像

```
public object GetPropertyValue(object obj_, string property_)
{
      return HttpContext.Current.Request.Headers[property_];
} 
```

但我想使用 Obj_ 而不是硬编码返回值中的标题。因为它可以是 Headers/cookies/...或任何东西

像 HttpContext.Current.Request.obj_[property_];

请问有人吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:47:14.727

您可以使用

```
HTTPContext.Current.Request[YOUR_PROPERTY_NAME] ; 
```

它有一个从 QueryString、Form、Cookies 或 ServerVariables 集合中读取的索引器。

[http://msdn.microsoft.com/en-gb/library/system.web.httprequest.item.aspx](http://msdn.microsoft.com/en-gb/library/system.web.httprequest.item.aspx)

# scalability - Scaling Puppet - 什么时候对 WEBrick 来说太过分了？

> ID：16172294
> 
> 赞同：4
> 
> 时间：2013-04-23T14:42:14.683
> 
> 标签：scalability, puppet, webrick

我在[Docs 中找到了以下内容：Scaling Puppet](http://docs.puppetlabs.com/guides/scaling.html)：

> 您使用的是默认网络服务器吗？
> 
> WEBrick 是用于启用 Puppet 的 Web 服务连接的默认 Web 服务器，它本质上是一个参考实现，并且在超过大约 10 个托管节点之后变得不可靠。在服务于许多节点的任何类型的生产环境中，您应该切换到更高效的 Web 服务器实现，例如Passenger 或 Mongrel。

“十个受管节点”中的数字 10 来自哪里？

我有超过 20 个节点，我可能很快就会有超过 30 个节点。我是否应该更改为乘客？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-14T20:31:39.550

当您开始遇到 WEBrick 问题时（或稍早一些），您应该更改为Passenger。何时发生这种情况取决于您的工作量。

WEBrick 最大的问题是单线程和阻塞；一旦它开始处理一个请求，它就不能处理任何其他请求，直到它完成第一个请求。因此，对您来说不同的是 Puppet 花费了多少时间来处理请求。

每次客户询问其目录时，这就是一个请求。通过 URL 检索到的每个单独文件`puppet:///`也是一个请求。如果您轻量地使用 Puppet，则每个目录的生成时间不会太长，您不会在任何给定的 Puppet 运行中分发许多文件，并且每个客户端不会花费超过四到六秒的服务器时间每隔一小时。如果每个客户端每小时花费 4 秒的服务器时间，则 10 个客户端有 5% 的机会发生冲突⁰——至少一个客户必须等待另一个客户的请求被处理。对于 20 或 30 个客户，这些机会分别为 19% 和 39%。只要每个请求都很短，你就可以忍受一些争用，但是冲突的几率会很快增加，所以如果你有超过 50 个主机（75% 的冲突几率）你真的应该通过使用乘客，除非你正在做积极的性能测量，表明你做得很好。

但是，如果您更努力地使用 Puppet 大师——需要更长时间来生成目录、提供大量文件、提供大文件或其他任何东西——你需要尽快切换到Passenger。我继承了一组大约 30 台主机和一个 WEBrick Puppet master，一切正常，但是当我开始部署新系统时，由新部署（包括几个千兆字节文件¹）引起的所有 Puppet 流量都阻止了其他主机从获得他们的更新，所以那是我被迫切换到乘客的时候。

简而言之，如果您没有对 Puppet 做任何过于紧张的事情，您可能会使用 30 个节点，但此时您至少*需要*监控您的 Puppet Master 的性能，最好还监控您的客户端的更新状态，因此您将知道何时开始运行超出 WEBrick 的功能。

⁰这是一个标准的[生日悖论](https://en.wikipedia.org/wiki/Birthday_paradox)计算；如果*n*是客户端的数量，*s*是每个客户端每小时使用的服务器时间的平均秒数，则在一小时内至少发生一次冲突的机会由 给出`1-(s/3600)!/((s/3600)^n*((s/3600)-n)!)`。

^(在任何情况下， 1) Puppet 都不是分发这种大小文件的好方法。我最终切换到将它们放在所有主机都可以访问的 NFS 共享上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:05:24.170

对于 20-30 个节点，应该没有任何问题。请注意，它`passenger`提供了一些附加功能。为节点提供服务可能会更快，但我不确定如果您只有 30 个节点，您将获得多少改进。

`passenger`如果您使用超过一百个节点，您应该更改为。当从 puppet-master 请求服务的节点数量达到大约 200 个时，我开始看到问题。在我的情况下，使用默认 Web 服务器，大约 5% 的节点（随机）在每小时运行期间无法接收目录。

# ios - 在某些 XCode / Mac OS 上面临 PNGCrush 问题（不具体）

> ID：16172298
> 
> 赞同：0
> 
> 时间：2013-04-23T14:42:22.783
> 
> 标签：ios, xcode, macos, png, pngcrush

我使用 Mac OS 10.7.5 和 XCode 4.6.2 开发了一个应用程序。应用程序在我的机器上运行良好，没有任何错误/警告。

但是当我尝试在另一台机器 Mac OS 10.8 和 XCode 4.6.2 上运行时，它显示该机器中某些图像的 pngcrush 错误。尽管存在很少的 pngcrush 错误，但应用程序仍然可以在模拟器或设备上正常运行。

我的问题是：为什么两端的调试存在差异以及如何解决它。（如何避免此类错误）

**错误信息**

```
While reading ImagePath/ImageName.png pngcrush caught libpng error: Not a PNG file. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T05:30:52.187

Pngcrush 是 Xcode 用于压缩应用程序中包含的 PNG 图像的 PNG（便携式网络图形）文件的优化器，目的是减少构建的数据包的最终大小。

这将在下面的路径下

```
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin 
```

应该有两种可能

1.  您的图像已损坏。从 Photoshop 将其重新保存为 .png 或使用新的。
2.  检查您是否在 Xcode 中添加了两个/多个引用。如果是，则删除旧引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-23T03:44:41.217

“不是 PNG 文件”的图像可能已经通过 Apple 的专用 Xcode SDK 版本的 pngcrush 运行，它会生成不再是有效 PNG 文件的“优化”文件。

查看引发错误的文件的开头并查看从字节 12 开始的字节是否是“CgBI”而不是“IHDR”。如果是这样，您需要撤消更改。搜索“pngcrush”和“CgBI”以了解如何。

# ios - iOS 应用在归档后表现不同

> ID：16172303
> 
> 赞同：2
> 
> 时间：2013-04-23T14:42:52.233
> 
> 标签：ios, xcode, asihttprequest, objective-c-blocks

在我手机上直接从 xcode 运行应用程序时，一切运行良好。将其归档并将其作为归档文件运行后，应用程序的行为会有所不同，并且不会按预期运行。这是从存档运行时 asihttprequest 永远不会结束的部分。我会很高兴得到一些帮助。

```
id<GAITracker> tracker = [[GAI sharedInstance] defaultTracker];

[tracker sendEventWithCategory:@"uiAction"
                    withAction:@"station pressed"
                     withLabel:@"Station number"
                     withValue:num];

NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"http://server.com/servlet?stationId=%d",    [num intValue]]];

__weak ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
NSLog(@"0");

[request setCompletionBlock:^{
    @try {
        NSLog(@"1");
        StopParser *stop = [[StopParser alloc]init];
                    NSLog(@"2");
        timesArray = [stop getStationsListfromString:[request responseString]];
                    NSLog(@"3");
        [stView.downlodingLabel setHidden:YES];
        [stView.downloadingIndicator setHidden:YES];
        [stView.tableview reloadData];
        [stView.tableview setHidden:NO];

    }
    @catch (NSException *exception) {
                    NSLog(@"4");
        [stView.downloadingIndicator setHidden:YES];
        [stView.downlodingLabel setHidden:NO];
        [stView.downlodingLabel setText:@"נא לנסות מאוחר יותר"];
        [stView.tableview setHidden:YES];

    }
    @finally {
        [refreshControl endRefreshing];
    }

}];
[request setFailedBlock:^{
                NSLog(@"5");
    [stView.downloadingIndicator setHidden:YES];
    [stView.downlodingLabel setHidden:NO];
    [stView.downlodingLabel setText:@"נא לנסות מאוחר יותר"];
    [stView.tableview setHidden:YES];
    [refreshControl endRefreshing];

}];
[request startAsynchronous]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:51:21.433

我认为`__weak`是你的问题。改为使用`__block`。

没有为 保存强引用`request`，因此将其释放。

[ARC 推出新的终身资格赛](http://developer.apple.com/library/mac/#releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011226-CH1-SW4)

*   `__weak`指定不使被引用对象保持活动状态的引用。当对象没有强引用时，弱引用设置为 nil。

[__block 存储类型](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/Blocks/Articles/bxVariables.html#//apple_ref/doc/uid/TP40007502-CH6-SW6)

`__block`变量存在于变量的词法范围和在变量的词法范围内声明或创建的所有块和块副本之间共享的存储中。因此，如果在帧内声明的块的任何副本在帧结束后仍然存在（例如，通过在某处排队以供以后执行），则存储将在堆栈帧的破坏中幸存下来。给定词法范围内的多个块可以同时使用一个共享变量。

* * *

**更新**

明确我的建议是替换：

```
__weak ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url]; 
```

和：

```
__block ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url]; 
```

这不应导致保留周期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T17:25:03.517

通常存档具有与在模拟器中运行更常见的调试配置不同的构建配置。确保您以两种方式测试相同的配置。每个版本之间可能有所不同。

我们使用调试、临时和发布构建配置。后两者用于归档。ad-hoc 可以直接从 Xcode 构建和运行，因此来自该配置的存档应该是相同的。

# rest - REST - 扩展关系

> ID：16172304
> 
> 赞同：6
> 
> 时间：2013-04-23T14:42:53.430
> 
> 标签：rest

我正在构建一个事件管理系统。架构如下所述。API 理解这些关系并在请求结果中返回相关资源的链接。例如，

```
GET /Events/1

    "links": {
    "Venue": "/Venues/1",
    "Tickets": "/Tickets?event_id=1",
    "Teams": "/Teams?event_id=1",
    "Registrations": "/Registrations?event_id=1"
} 
```

我读过的关于 REST 和 HATEOAS 的大部分内容都表明这是“正确”的做法，但效率非常低。例如，如果我想生成参与事件的用户和团队的报告，它需要许多请求。这类似于运行多个选择查询，而不是针对数据库运行单个连接查询。所以我的问题是，我应该扩展关系并将相关资源嵌入资源请求中吗？这也带来了一个问题，b/c 上面的请求将返回大量数据。答案可能是坚持使用关系链接并设置适当的缓存。无论如何，我想听听你的意见。

```
Schema

events
    hasMany registrations
    hasMany tickets
    hasMany teams

team
    belongsTo event

ticket
    belongsTo event
    hasMany registrations

user
    hasMany registrations

registrations
    belongsTo event
    belongsTo ticket
    belongsTo user
    belongsTo team 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T15:30:28.157

在另一个请求的正文中返回资源的完整表示并没有错。正如您所提到的，这可能是冗长的。

鉴于服务的某些调用者可能只希望返回 URI，但有时您希望减少跨网络的往返次数，即您希望在一次调用中完成所有操作，您要搜索的术语是*projections*。

这些是满足客户需求的资源的不同表示形式。

您可以在 URI 参数中指定这些，例如，`GET /Events/1?venueProjection=full,teamProjection=uri`

然后根据客户的要求返回投影。

```
"links": {
"Venue": {
    "uri": "/Venues/1",
    "attr1": "value1",
    "attrN": "valueN"
},
"Tickets": "/Tickets?event_id=1",
"Teams": "/Teams?event_id=1",
"Registrations": "/Registrations?event_id=1"
} 
```

**注意：**始终返回带有您的投影的 URI，这样，如果它们未满，客户端稍后可以轻松访问完整的资源。

我建议您阅读 Google 的“休息预测”或查看 RESTful Cookbook。

# batch-file - 批量转换文件名中包含空格的目录中的所有文件

> ID：16172308
> 
> 赞同：0
> 
> 时间：2013-04-23T14:42:56.870
> 
> 标签：batch-file, batch-processing

我已经完成了这个批处理文件，它应该转换给定文件夹中的所有 mp3 文件，但是，我不知道为什么，它不起作用......

这是代码：

```
@echo off
title Converting...

set fold=C:\Users\Username\Music\Music to convert\
set ext=*.mp3
set dest=C:\Users\Username\Music\Converted Music\

for %%f in (%fold%%ext%) do ffmpeg -i %%f -b 192k %dest%%%f

pause>nul
exit 
```

我认为这是因为文件名和文件夹名称中的空格，但我实际上并不知道......有人可以验证并找出正确的代码吗？

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:17:43.903

简单的。

```
for %%f in ("%fold%%ext%") do ffmpeg -i "%%f" -b 192k "%dest%%%~nxf" 
```

（修改版）

这是我的测试批次

```
@echo OFF
SETLOCAL
REM title Converting...

set fold=U:\Users\Username\Music\Music to convert\
set ext=*.mp3
set dest=U:\Users\Username\Music\Converted Music\

:: This makes the directories, then creates two dummy files
:: only used for testing.

MD "%fold%"
MD "%dest%"
dir>"%fold%file1.mp3"
dir>"%fold%file two.mp3"

for %%f in ("%fold%%ext%") do ECHO ffmpeg -i "%%f" -b 192k "%dest%%%~nxf" 
```

最后`ECHO`一行是显示将要执行的内容。验证后，删除`ECHO`关键字以激活`FFMPEG`命令。

`%%~nxf`是文件名+扩展名`%%f`

结果：

```
ffmpeg -i "U:\Users\Username\Music\Music to convert\file1.mp3" -b 192k "U:\Users\Username\Music\Converted Music\file1.mp3"
ffmpeg -i "U:\Users\Username\Music\Music to convert\file two.mp3" -b 192k "U:\Users\Username\Music\Converted Music\file two.mp3" 
```

嗯......也许你需要`USERNAME`在设置`FOLD`时`DEST`更换`%username%`

* * *

修改为添加对多种文件类型的处理

```
@echo OFF
SETLOCAL
REM title Converting...

set fold=U:\Users\Username\Music\Music to convert\
set ext=*.mp3 *.wma *.m4a
set dest=U:\Users\Username\Music\Converted Music\

:: This makes the directories, then creates dummy files

MD "%fold%"
MD "%fold%subdir"
MD "%dest%"
dir>"%fold%file1.mp3"
dir>"%fold%file two.mp3"
dir>"%fold%file3.wma"
dir>"%fold%subdir\file four.wma"

 for /r "%fold%" %%f in (%ext%) do ECHO ffmpeg -i "%%~ff" -b 192k "%dest%%%~nxf" 
```

请注意，我没有更改`FFMPEG`命令 - 您知道您需要的参数。命令像往常一样回响。

如果您想使用恒定的输出扩展名，例如 .MP3，请更改`"%dest%%%~nxf"`为`"%dest%%%~nf.MP3"`

修改后的批量输出：

```
ffmpeg -i "U:\Users\Username\Music\Music to convert\file1.mp3" -b 192k "U:\Users\Username\Music\Converted Music\file1.mp3"
ffmpeg -i "U:\Users\Username\Music\Music to convert\file two.mp3" -b 192k "U:\Users\Username\Music\Converted Music\file two.mp3"
ffmpeg -i "U:\Users\Username\Music\Music to convert\file3.wma" -b 192k "U:\Users\Username\Music\Converted Music\file3.wma"
ffmpeg -i "U:\Users\Username\Music\Music to convert\subdir\file four.wma" -b 192k "U:\Users\Username\Music\Converted Music\file four.wma" 
```

# git - 在 Git 中，当我尝试删除本地分支时出现错误

> ID：16172314
> 
> 赞同：1
> 
> 时间：2013-04-23T14:43:10.160
> 
> 标签：git, github

我环顾四周，但找不到任何关于我所遇到错误的答案。

我创建了一个新分支，但我忘了事先做一些事情，所以我需要删除我刚刚从本地机器创建的新分支。问题是，当我这样做时，`git branch -d <branch_name>`我收到此错误： `Cannot delete the branch <branch_name> which you are currently working on.`

但我什么也没做，我只是想删除它。

删除本地分支并使错误不再出现的步骤是什么？

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T14:44:08.907

您无法从脚下删除*当前分支。*
在你可以删除一个分支之前，你必须切换到一个不同的分支：

```
git checkout other-branch 
```

# ssrs-2008 - 在 SSRS 中创建辅助 Y 轴

> ID：16172319
> 
> 赞同：1
> 
> 时间：2013-04-23T14:43:19.903
> 
> 标签：ssrs-2008, reporting-services

我正在尝试使用 ssrs 2008 r2 创建具有主要和次要 y 轴的图形。浏览论坛，我发现唯一建议的答案是使用 Dundas (www.dundas.com)。

我已经能够创建辅助 y 轴，但无法更改值类型或图表类型。

有人可以指出我正确的方向来创建一个主要的 y 轴，一个具有不同主要/次要值的次要 y 轴，并更改主要和次要 y 轴之间的图表类型。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-12T11:36:05.933

右键单击要更改其图表类型的系列值，然后选择图表类型。

# android - Android - 几秒钟后性能变低

> ID：16172320
> 
> 赞同：0
> 
> 时间：2013-04-23T14:43:22.817
> 
> 标签：android, asynchronous

我使用以下代码非常快速地增加 30 个 TextViews 的数量。在最初的 30 个步骤中，Everythig 运行良好。之后变化非常缓慢。

```
 handler = new Handler();
        updater = new Runnable() {
            @Override
            public void run() {
                About30Textviews.increment;
                    handler.postDelayed(this, 10);
            }
        };
        startButton.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                handler.post(updater);
            }
        }); 
```

有人可以解释为什么吗？或者有人知道解决方案吗？多谢！

# javascript - JQuery 在多个 div 之间切换

> ID：16172321
> 
> 赞同：1
> 
> 时间：2013-04-23T14:43:25.967
> 
> 标签：javascript, jquery

我正在尝试在 div 之间切换，以便在单击标签时显示 div。单击另一个 a 标签时，该 div 将替换显示的 div。

这就是我所做的。

HTML：

```
<a href="#" rel="#slidingDiv">a</a><br>
<a href="#" rel="#slidingDiv_2">b</a><br>
<a href="#" rel="#slidingDiv_3">c</a><br>
<a href="#" rel="#slidingDiv_4">d</a><br>

<div id="slidingDiv">a</div>
<div id="slidingDiv_2">a</div>
<div id="slidingDiv_3">a</div>
<div id="slidingDiv_4">a</div> 
```

查询：

```
function ($) {
$.fn.showHide = function (options) {

    //default vars for the plugin
    var defaults = {
        speed: 1000,
        easing: '',
        changeText: 0,
        showText: 'Show',
        hideText: 'Hide'

    };
    var options = $.extend(defaults, options);

    $(this).click(function () { 

                var toggleDiv;

                var $divA = $('#slidingDiv'),
                    $divB = $('#slidingDiv_2'),
                        $divC = $('#slidingDiv_3'),
                        $divD = $('#slidingDiv_4'),
                        $divE = $('#slidingDiv_5'),
                        $divF = $('#slidingDiv_6'),
                        $divG = $('#slidingDiv_7'),
                        $divH = $('#slidingDiv_8'),
                        $divI = $('#slidingDiv_9');

                if( $divA.is( ':visible' ) ){
                        $divA.hide();
            }
                if( $divB.is( ':visible' ) ){
                        $divB.hide();
            }
                if( $divC.is( ':visible' ) ){
                        $divC.hide();
            }
                if( $divD.is( ':visible' ) ){
                        $divD.hide();
            }
                if( $divE.is( ':visible' ) ){
                        $divE.hide();
            }
                if( $divF.is( ':visible' ) ){
                        $divF.hide();
            }
                if( $divG.is( ':visible' ) ){
                        $divG.hide();
            }
                if( $divH.is( ':visible' ) ){
                        $divH.hide();
            }
                if( $divI.is( ':visible' ) ){
                        $divI.hide();
            }

                // this reads the rel attribute of the button to determine which div id to toggle
                toggleDiv = $(this).attr('rel'); 

      $('.toggleDiv').slideUp(options.speed, options.easing);   

                // this var stores which button you've clicked
      var toggleClick = $(this);

          var toggleDiv = $(this).attr('rel');

              // here we toggle show/hide the correct div at the right speed and using which easing effect
          $(toggleDiv).slideToggle(options.speed, options.easing, function() {
            // this only fires once the animation is completed
                // if(options.changeText==0){
              //$(toggleDiv).is(":visible") ? toggleClick.text(options.hideText) : toggleClick.text(options.showText);
               //}

          });

      return false;

    });

};
})(jQuery); 
```

这目前有效，但我知道这可以做得更好，而不是使用 if 语句。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T14:52:21.333

我们开始吧：http: [//jsfiddle.net/fqK36/5/](http://jsfiddle.net/fqK36/5/)

你的整个功能变成：

```
$.fn.showHide = function (options) {

    //default vars for the plugin
    var defaults = {
        speed: 1000,
        easing: '',
        changeText: 0,
        showText: 'Show',
        hideText: 'Hide',
        slideDiv: '.slide-div'
    };
    var options = $.extend(defaults, options);

    return this.each(function () {
        $(this).click(function () {
            $(options.slideDiv).hide();
            // this var stores which button you've clicked
            var toggleClick = $(this),
                toggleDiv = $(this).data('slide-id');
            // here we toggle show/hide the correct div at the right speed and using which easing effect
            $(toggleDiv).slideToggle(options.speed, options.easing, function () {
                // this only fires once the animation is completed
                // if(options.changeText==0){
                //$(toggleDiv).is(":visible") ? toggleClick.text(options.hideText) : toggleClick.text(options.showText);
                //}

            });

        });

    });

}; 
```

然后你可以像这样使用它：

```
$('a').showHide({'slideDiv' : '.slide-div'}); 
```

该`slideDiv`选项可以是您正在使用的自定义选择器，也可以是您希望滑动的 div。

所有幻灯片都分配了一个类，这意味着您可以一次将它们全部隐藏。然后，您可以`div`通过获取单击链接的`data-slide-id`属性来显示目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:56:45.117

通常，我通过创建一个`hidden`类来做到这一点。当你去切换到一个新的 div 时，你可以这样做：

```
$(this).click(function(){
    $(this).removeClass('hidden') 

    $('div:not(#' + $(this).attr('id') + ')').addClass('hidden')
}); 
```

这使用`not`选择器来查找除当前项目之外的所有内容。没有动画，这是最简单的方法。您还可以通过使用抓取未隐藏的任何内容`$('div:not(.hidden)')`，然后在该选择器中的所有内容上运行您的切换。

```
$(this).click(function(){

    if($(this).hasClass('hidden'){
        $(this).show()

        $(this).removeClass('hidden')
    }

    $('div:not(#' + $(this).attr('id') + ') :not(.hidden.)')
        .hide().addClass('hidden')
}); 
```

可能有助于清理一些东西。

# android - Android SampleBrowserPlugin 安装失败

> ID：16172323
> 
> 赞同：1
> 
> 时间：2013-04-23T14:43:28.927
> 
> 标签：android, android-ndk, npapi, android-source

我正在尝试安装 android 源代码中给出的 samplebrowserplugin。正如这里给出的（[https://github.com/android/platform_development/tree/master/samples/BrowserPlugin](https://github.com/android/platform_development/tree/master/samples/BrowserPlugin)），我可以按照它进行第二步（`make SampleBrowserPlugin`）。我现在有 .apk 文件，但是当我尝试使用 adb 安装它时，我得到的只是

```
Failure [INSTALL_FAILED_DEXOPT] 
```

当我运行 logcat 时，在各种消息中，我看到

```
DexOptZ: zip archive '/data/app/com.android.sampleplugin-1.apk' does not include classes.dex 
```

# mysql - 如何修复数据类型大小？

> ID：16172324
> 
> 赞同：-1
> 
> 时间：2013-04-23T14:43:30.110
> 
> 标签：mysql, sql

我对我的表格数据大小有疑问。如何准确地修复数据类型及其大小。请在这里帮助我。

```
mysql> show create table AssignmentPolicy\G
*************************** 1\. row ***************************
       Table: AssignmentPolicy
Create Table: CREATE TABLE `AssignmentPolicy` (
  `AssignmentPolicyID` int(11) NOT NULL AUTO_INCREMENT,
  `AssignmentPolicyGroupID` smallint(3) unsigned DEFAULT NULL,
  `AssignmentPolicyName` varchar(50) NOT NULL DEFAULT '',
  `AssignmentPolicyTitle` varchar(250) NOT NULL DEFAULT '',
  `AssignmentPolicyDescription` tinytext NOT NULL,
  `Order` smallint(3) unsigned NOT NULL DEFAULT '0',
  `Editable` tinyint(1) unsigned NOT NULL DEFAULT '1',
  `DefaultValue` tinyint(1) unsigned zerofill NOT NULL DEFAULT '0',
  `Dependency` int(11) DEFAULT NULL,
  PRIMARY KEY (`AssignmentPolicyID`)
) ENGINE=InnoDB AUTO_INCREMENT=28 DEFAULT CHARSET=latin1
1 row in set (0.00 sec)

Tables:

mysql> show create table Item\G
*************************** 1\. row ***************************
       Table: Item
Create Table: CREATE TABLE `Item` (
  `Item_ID` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `Reviewer_User_ID` int(10) unsigned DEFAULT NULL,
  `Author_User_ID` int(10) unsigned DEFAULT NULL,
  `Status_Code` enum('live','in_progress','needs_revision','ready_for_review','ready_for_final_review','hidden','deprecated') DEFAULT 'in_progress',
  `Topic_ID` mediumint(8) unsigned DEFAULT NULL,
  `Title` varchar(255) DEFAULT NULL,
  `Cognitive_Type` enum('conceptual','quantitative','vocabulary') DEFAULT NULL,
  `Difficulty` enum('easy','medium','hard') DEFAULT NULL,
  `Description` mediumtext,
  `bookQNum` varchar(50) DEFAULT NULL,
  `Is_EOC` tinyint(4) NOT NULL DEFAULT '0',
  `Propagate_Algos` tinyint(4) NOT NULL DEFAULT '0',
  `Regenerate_Algos` tinyint(4) NOT NULL DEFAULT '0',
  `Visibility` enum('private','system') DEFAULT 'system',
  `Source_Taxonomy` smallint(5) unsigned DEFAULT NULL,
  `Date_Created` datetime DEFAULT NULL,
  `ItemCopied_ID` int(10) unsigned DEFAULT NULL,
  `TemplateCopied_ID` int(10) unsigned DEFAULT NULL,
  `ibis_compatible` enum('false','true') NOT NULL DEFAULT 'true',
  `sequoia_compatible` enum('false','true') NOT NULL DEFAULT 'false',
  PRIMARY KEY (`Item_ID`),
  KEY `Topic_ID` (`Topic_ID`),
  KEY `Status_Code` (`Status_Code`),
  KEY `Author_User_ID` (`Author_User_ID`),
  KEY `Reviewer_User_ID` (`Reviewer_User_ID`),
  KEY `ItemCopied_ID` (`ItemCopied_ID`),
  KEY `TemplateCopied_ID` (`TemplateCopied_ID`),
  KEY `Item2Taxonomy` (`Source_Taxonomy`),
  CONSTRAINT `Item2Author_User_ID` FOREIGN KEY (`Author_User_ID`) REFERENCES `User` (`userID`) ON UPDATE CASCADE,
  CONSTRAINT `Item2content__taxonomy` FOREIGN KEY (`Source_Taxonomy`) REFERENCES `content`.`taxonomy` (`Key`) ON UPDATE CASCADE,
  CONSTRAINT `Item2content__topic` FOREIGN KEY (`Topic_ID`) REFERENCES `content`.`topic` (`Key`) ON UPDATE CASCADE,
  CONSTRAINT `Item2Item_Copied` FOREIGN KEY (`ItemCopied_ID`) REFERENCES `Item` (`Item_ID`) ON DELETE SET NULL ON UPDATE CASCADE,
  CONSTRAINT `Item2Template_Copied` FOREIGN KEY (`TemplateCopied_ID`) REFERENCES `Item` (`Item_ID`) ON DELETE SET NULL ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=41885 DEFAULT CHARSET=latin1
1 row in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:54:25.377

诸如 int 之类的数字类型没有动态大小。如果你设置 int(11) 你设置填充级别，而不是“整数大小”，它是......你知道......毕竟是整数大小。因此，如果不是有意设置填充，我首先会删除所有 int/tinyint/etc "(xx)" 值。如果要更改表中的列，则必须使用 ALTER TABLE，这里有一些很好的示例：http: [//dev.mysql.com/doc/refman/5.1/en/alter-table-examples.html](http://dev.mysql.com/doc/refman/5.1/en/alter-table-examples.html)

# ember.js - Ember.js - 第二次调用时出现 linkTo 错误

> ID：16172326
> 
> 赞同：1
> 
> 时间：2013-04-23T14:43:33.027
> 
> 标签：ember.js

我在使用 ember 时遇到问题，尤其是 linkTo 助手。

这是：[jsfiddle](http://jsfiddle.net/Hb377/5/)

我无法使 jsfiddle 工作，但这里有一个运行版本的链接：[running version on cloudfoundry](http://fifemberresource.cloudfoundry.com/dummy/index)

我使用 ember-resource.js 来获取数据。

我有两条路线，“列表”和“项目”。

```
Ember modules :
List (controller, route, view and template)
Item (controller, route, view and template)
ItemDetail (controller, view and template) which is included with the controller helper in the Item handlebars template. 
```

问题是：从默认路由（“#/list”）访问应用程序时，上一个链接可以正常工作。但是当我从项目路由（“#/item/1”）访问应用程序时，上一个链接第一次工作正常，然后不再工作......

老实说，我不知道我做错了什么......

任何帮助将不胜感激......不要犹豫，询问额外的信息提前谢谢

注意：我真的很感谢 ember-resource.js，但 stackoverflow 标签不存在......任何有 1500 个代表的人都可以创建它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T09:33:01.927

实际上，这是 ember.js 中的一个错误，已解决但尚未发布。

在 childViews 上调用 rerender 的控件助手中...取消注释此行解决了问题。

# database - FACT_ACTIVITIES 未在 Worklight 中更新

> ID：16172327
> 
> 赞同：0
> 
> 时间：2013-04-23T14:43:38.030
> 
> 标签：database, ibm-mobilefirst

我有一个包含两个应用程序的 Worklight 项目：一个是 Native，另一个是 Hybrid（仅限 Web）。

该`APP_ACTIVITY_REPORT`表正在为两者正确更新；但是，该`FACT_ACTIVITIES`表仅针对本机应用程序进行更新。

混合应用程序非常简单。此外，“init”和“login”值被写入`APP_ACTIVITY_REPORT.ACTIVITY`列，它还使用`logActivity()`客户端 JS 函数记录。

Worklight 报告计划似乎正在适当地写入原始数据，但不适用于两个应用程序......为什么没有将本机和混合应用程序数据写入`FACT_ACTIVITIES`表中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:27:05.710

您说的是“混合（仅限网络）”。根据定义，混合应用程序的 UI 使用部分或全部 HTML 呈现，但包装在本机容器中，因此安装时就像是设备上的本机应用程序一样。我假设“（仅限网络）”是指它只能通过网络浏览器访问。

如果我的假设是正确的，那么您描述的行为是预期的。记录源自浏览器的活动的 APP_ACTIVITY_REPORT 数据未记录在 FACT_ACTIVITIES 表中。这是设计使然。

至于“为什么”的问题，我不得不问 Worklight 架构师。:)

# android - android中的ListView应该在整个屏幕和底部的其他元素中出现

> ID：16172328
> 
> 赞同：0
> 
> 时间：2013-04-23T14:43:40.950
> 
> 标签：android, android-layout

我的屏幕上有一个列表视图和其他文本视图。我想在整个屏幕和列表底部的其他元素中显示列表。

下面是我使用的代码。

```
 <?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/relative_layout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/background_light_blue" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="@drawable/background_light_blue"
        android:orientation="vertical" >

        <LinearLayout
            android:id="@+id/header1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:background="@layout/header_gradients"
            android:orientation="vertical"
            android:paddingBottom="8dip"
            android:paddingTop="8dip" >

            <TextView
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_marginLeft="10dip"
                android:layout_weight="1"
                android:gravity="center"
                android:text="@string/shopping_cart"
                android:textColor="@color/white"
                android:textSize="15sp"
                android:textStyle="bold" />
        </LinearLayout>

        <ScrollView
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" >

            <LinearLayout
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:background="@drawable/background_light_blue"
                android:orientation="vertical" >

                <RelativeLayout
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginLeft="5dip"
                    android:layout_marginRight="5dip"
                    android:layout_marginTop="5dip"
                    android:background="@color/white"
                    android:orientation="horizontal"
                    android:padding="5dp" >

                    <TextView
                        android:id="@+id/purchase_order"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_marginLeft="6dp"
                        android:layout_marginTop="2dp"
                        android:text="Requisitioner"
                        android:textColor="@color/black"
                        android:textSize="15sp"
                        android:typeface="sans" />

                    <TextView
                        android:id="@+id/requisitioner"
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/purchase_order"
                        android:layout_marginBottom="3dp"
                        android:layout_marginLeft="6dp"
                        android:layout_marginTop="5dp"
                        android:text="Requisitioner"
                        android:textColor="@color/black"
                        android:textSize="15sp" />

                    <ImageView
                        android:id="@+id/imageView1"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:layout_alignParentRight="true"
                        android:layout_centerVertical="true"
                        android:contentDescription="@string/image"
                        android:src="@drawable/shopping_cart" />
                </RelativeLayout>

                <TextView
                    android:id="@+id/products_and_services"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:layout_marginBottom="3dp"
                    android:layout_marginTop="15dp"
                    android:gravity="center_horizontal"
                    android:text="@string/products_and_services"
                    android:textColor="@color/black"
                    android:textSize="17sp"
                    android:textStyle="bold" />

                <RelativeLayout
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content" >

                    <LinearLayout
                        android:id="@+id/lr1"
                        android:layout_width="wrap_content"
                        android:layout_height="wrap_content"
                        android:orientation="vertical" >

                        <ListView
                            android:id="@android:id/list"
                            android:layout_width="wrap_content"
                            android:layout_height="0dp"
                            android:layout_marginLeft="5dp"
                            android:layout_marginRight="5dp"
                            android:layout_weight="0.12" >
                        </ListView>
                    </LinearLayout>

                    <LinearLayout
                        android:id="@+id/pagingPanel"
                        android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:layout_below="@id/lr1"
                        android:background="@drawable/background_light_blue"
                        android:orientation="vertical" >

                        <TextView
                            android:id="@+id/note_to_approver"
                            android:layout_width="fill_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginBottom="3dp"
                            android:layout_marginTop="10dp"
                            android:gravity="center_horizontal"
                            android:text="@string/note_to_approver"
                            android:textColor="@color/black"
                            android:textSize="17sp"
                            android:textStyle="bold" />

                        <TextView
                            android:id="@+id/note"
                            android:layout_width="fill_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginLeft="5dp"
                            android:layout_marginRight="5dp"
                            android:layout_marginTop="2dp"
                            android:background="@color/white"
                            android:maxLines="10"
                            android:padding="5dp"
                            android:text="hijnjn"
                            android:textColor="@color/black"
                            android:textSize="15sp"
                            android:typeface="sans" />

                        <TextView
                            android:id="@+id/approver"
                            android:layout_width="fill_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginBottom="1dp"
                            android:layout_marginTop="15dp"
                            android:gravity="center_horizontal"
                            android:text="@string/approvers"
                            android:textColor="@color/black"
                            android:textSize="17sp"
                            android:textStyle="bold" />

                        <Button
                            android:id="@+id/approvers"
                            android:layout_width="fill_parent"
                            android:layout_height="wrap_content"
                            android:layout_marginLeft="5dp"
                            android:layout_marginRight="5dp"
                            android:layout_marginTop="5dp"
                            android:background="@drawable/options_menu"
                            android:drawableRight="@drawable/arrow_right"
                            android:gravity="left|center"
                            android:text="@string/approvers"
                            android:textColor="@color/black"
                            android:textSize="16sp"
                            android:textStyle="bold"
                            android:typeface="sans" />
                    </LinearLayout>
                </RelativeLayout>
            </LinearLayout>
        </ScrollView>

    </LinearLayout>

    <LinearLayout
        android:id="@+id/relativeLayout1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:background="@layout/btn_background" >

        <Button
            android:id="@+id/release_button"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:layout_marginLeft="15dp"
            android:layout_marginRight="15dp"
            android:layout_marginTop="5dp"
            android:layout_weight="1"
            android:background="@drawable/btn_blue"
            android:text="Approve(1)/Reject(0)"
            android:textColor="@color/white"
            android:textSize="15sp"
            android:textStyle="bold" />
    </LinearLayout>

</RelativeLayout> 
```

![现在屏幕看起来像这样](https://i.stack.imgur.com/rMDyq.jpg)

我的要求：现在列表在给定区域内滚动。我想在整个屏幕上显示，滚动应该只针对屏幕。

请帮助我做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-17T13:29:04.687

您不应将垂直滚动小部件/视图 (ListView) 放在另一个垂直滚动视图 (ScrollView) 中。[虽然这里](https://stackoverflow.com/questions/5415011/listview-inside-a-scrollview)和[这里](https://stackoverflow.com/questions/6210895/listview-inside-scrollview-is-not-scrolling-on-android)提到了一些方法可以帮助你实现你想要的，但这会增加 CPU 负载。

# php - 如何限制在数组中打印的条目数

> ID：16172332
> 
> 赞同：0
> 
> 时间：2013-04-23T14:43:46.547
> 
> 标签：php, printing, listings, limiting

我正在 Drupal 7 中使用 Php 开发自定义模块。

在“云提供商：”部分下，我试图将打印出来的条目数限制为 4。到目前为止，带有 BREAK 的 IF 语句是我解决此问题的尝试。

几个小时以来，我一直试图弄清楚这一点，这让我发疯了。任何帮助，将不胜感激。我已将代码放在此底部。

预先感谢您的所有帮助。

```
 <?php
/**
 * @file
 */
?>

    <div class="item-body">
      <div class="overview">

        <div class="label">Cloud Providers:</div>
        <div class="data">
          <?php 
            $i = 0;
            foreach($company['service_providers'] as $provider): ?>
            <div>
                <?php 
                if($i = 3) break;
                print $provider;
                $i++;
                ?>
            </div>
          <?php endforeach; ?>
        </div>

      </div>
      <div class="details">
        <?php print theme('cloud_computing_item_details', array('company' => $company)); ?> 
      </div>
    </div>
    <div style="clear: both; height: 5px;">&nbsp;</div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:44:55.640

`if($i = 3) break;`

应该：

`if($i == 3) break;`

而你目前拥有它的方式，你总是设置`$i`等于`3`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:45:33.513

```
$providers = array_slice($company['service_providers'], 0, 4);
foreach($providers as $provider): 
```

**编辑**

或者干脆

```
foreach(array_slice($company['service_providers'], 0, 4) as $provider): 
```

# c++ - C++ 递归分段错误

> ID：16172333
> 
> 赞同：0
> 
> 时间：2013-04-23T14:43:48.813
> 
> 标签：c++

```
#include <iostream>

using namespace std;

int findSumofOdds(int n);

int main()
{

  int n = 88;
  int x;

  x = findSumofOdds(n);
  cout << x << endl;

  return 0;
}

int findSumofOdds(int n)
{
  if (n != 1)
  {
    if( n % 2 == 0)
      n = (n - 1);

    return(findSumofOdds(n-1) + 1);
  }
  else
    return 1;
} 
```

为什么这个递归不起作用？它尝试运行然后崩溃。请告诉我。老师说可以，但是不行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T14:45:55.237

什么时候`n`是偶数，你减`n`2。如果跳过`n == 1`，它将递归，直到导致堆栈溢出。由于`n`从 88 年开始，这就是正在发生的事情。

```
int findSumofOdds(int n)
{
    if (n != 1)
    {
        if( n % 2 == 0)
            n = (n - 1); // <== first decrement

        return(findSumofOdds(n-1) + 1); // <== second decrement
    }
    else
        return 1;
} 
```

此外，您似乎在*计算*奇数的数量，而不是添加它们。我的猜测是你实际上想要这样的东西：

```
int findSumofOdds(int n)
{
    if (n != 1)
    {
        if( n % 2 == 0)
            return(findSumofOdds(n - 1));

        return(findSumofOdds(n-1) + n); // or + 1 to just count
    }
    else
        return 1;
} 
```

如果你想练习递归，那很好。但是有一种更简单的方法可以编写一个函数来将奇数相加并包括`n`：

```
int fundSumofOdds(int n) {
    n = (n + 1) / 2;
    return n * n;
} 
```

这是因为有一个通用公式：

> 1 + 3 + 5 + ... + 2n-1 = n ²

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:46:11.087

你必须成功

```
if (n > 1) 
```

`n = 2`在这里考虑

```
 if (n != 1)
 {
   if( n % 2 == 0)  // Yes
      n = (n - 1);  // n = 1

   return(findSumofOdds(n-1) + 1);  // n = 0  <-- will not stop. 
```

* * *

并改变这一点。现在它只是在计算奇数的数量。你需要对它们求和。

```
 return(n + findSumofOdds(n - 1));
}
else
    return 0; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:10:18.893

如果您打印`n`，`findSumofOdds`您可以看到正在发生的事情 -`n`变为负数并且您获得无限递归。如果您的程序没有提前崩溃，您可能会`n`出现整数溢出（当低于 的最小值时`int`），这会产生未定义的行为。要更正此问题，您可以执行以下操作：

```
int findSumofOdds(int n)
{
    if(n < 1)
    {
        return 0;
    }

    if(n % 2 == 0)
    {
        return findSumofOdds(n - 1) + 1;
    }
    return findSumofOdds(n - 2) + 1;
} 
```

您可以从最后一条语句中减去 2 `n`，因为您只需要奇数，并且您知道`n`此时不能是偶数（因为`if(n % 2 == 0)`）。

`n`此外，您是否需要找到所有小于（例如`4`( `== 1 + 3`) for ）的奇数的总和，`n=5`还是只需要计算它们（这就是您现在正在做的）？如果你想对数字求和，你必须在返回时添加`n`而不是。`1`

# jquery - 使用 Jquery 的条件验证有时不起作用

> ID：16172339
> 
> 赞同：2
> 
> 时间：2013-04-23T14:43:54.363
> 
> 标签：jquery, jquery-validate

我已经实现了 Jquery Validator，但面临一些有时无法正常工作的条件验证的问题。

1.  如果选择了单选按钮，我有一个要求，我已经创建了被调用的函数，并且我正在将单选按钮名称传递给它。
2.  我在其他验证中遇到了这个问题，其中仅当从 3 个单选按钮中选择了两个单选按钮中的任何一个时才需要控件。

当我每次调用警报时向功能添加警报但验证没有
我已经截断了我的验证代码让我知道如果我做错了什么

Js代码： -

```
$('#ConditionalLiability').validate({
    onfocusout: false,
    onkeyup: false,
    rules: {
        ConcernsNoted: {
            required: true
        },
        ConcernsWithExteriorWalls: {
            required: ValidationRadio("ConcernsNoted", 'Y')
        },
        chkExteriorWalls: {
            required: ValidationRadio("ConcernsWithExteriorWalls", 'Y')
        },
        GranularLossComments: {
            required: Conditional("GranularLoss")
        }
    },
    showErrors: function (errorMap, errorList) {
        var messages = "";
        var check = 0;
        $.each(errorList, function (index, value) {
            check = 1;
            var id = $(value.element).attr('id');
            messages += (index + 1) + ". " + value.message + "\n";
        });
        messages = "Please correct following errors \n" + messages;
        if (check == 1) {
            alert(messages);
        }
    },
    submitHandler: function () {
        SaveData();
    },
    messages: {
        ConcernsNoted: {
            required: "Please select a value for Concerns With Home Exterior"
        },
        ConcernsWithExteriorWalls: {
            required: "Please select a value for Concerns With Exterior Walls"
        },         
        chkExteriorWalls: {
            required: "Please select at least one option for Concerns with Exterior Walls"
        },
        GranularLossComments: { required: "Please enter comments for GranularLoss"
        }

    }
});

function Conditional(id) {
    var element = "input:radio[name='" + id + "']:checked";
    var radio_value = $(element).val();
    if ((radio_value == 'M') || (radio_value == 'S')) {
        return true;
    } else {
        return false;
    }
}

function ValidationRadio(id, check) {
    var element = "input:radio[name='" + id + "']:checked";
    var radio_value = $(element).val();
    if (radio_value == check) {
        alert('true');
        return true;
    } else {
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T20:25:54.620

`.validate()`是插件的*初始化*方法，但是，[根据您的 jsFiddle](http://jsfiddle.net/3D8ce/6/)，您将其称为测试表单有效性的方法...

```
$(document).ready(function () {
      $('#submit').click(function () {
        submitForm();
    });
});

function submitForm() { 
    $('#ConditionalLiability').validate({
        // options & rules
    });
}

function Conditional(id) {
    // your code
}

function ValidationRadio(id, check) {
    // your code
} 
```

初始化后，插件会*自动*捕获提交按钮的点击事件。

*   摆脱你的`click`处理程序。您不需要它，而且在许多情况下，它会干扰插件的默认行为。

还：

*   由于您使用的是 jQuery Mobile，请使用`.on('pageinit', function()`而不是`.ready(function()`

*   摆脱损坏的外部条件函数并`depends`改用子选项（见下文）。

将您的代码重新分解为...

```
$(document).on('pageinit', function () {

    $('#ConditionalLiability').validate({
        onfocusout: false,
        onkeyup: false,
        rules: {
            ConcernsNoted: {
                required: true
            },
            ConcernsWithExteriorWalls: {
                required: {
                    depends: function (element) {
                        return $("[name='ConcernsNoted'][value='Y']").is(":checked");
                    }
                }
            },
            chkExteriorWalls: {
                required: {
                    depends: function (element) {
                        return $("[name='ConcernsWithExteriorWalls'][value='Y']").is(":checked");
                    }
                }
            },
            GranularLossComments: {
                 required: {
                    depends: function (element) {
                return ( $("[name='GranularLoss'][value='M']").is(":checked") || $("[name='GranularLoss'][value='S']").is(":checked") );
                    }
                 }
            }
        },
        showErrors: function (errorMap, errorList) {
            var messages = "";
            var check = 0;
            $.each(errorList, function (index, value) {
                check = 1;
                var id = $(value.element).attr('id');
                messages += (index + 1) + ". " + value.message + "\n";
            });
            messages = "Please correct following errors \n" + messages;
            if (check == 1) {
                alert(messages);
            }
        },
        submitHandler: function () {
            SaveData();
        },
        messages: {
            ConcernsNoted: {
                required: "Please select a value for Concerns With Home Exterior"
            },
            ConcernsWithExteriorWalls: {
                required: "Please select a value for Concerns With Exterior Walls"
            },
            chkExteriorWalls: {
                required: "Please select at least one option for Concerns with Exterior Walls"
            },
            GranularLossComments: {
                required: "Please enter comments for GranularLoss"
            }
        }
    });

}); 
```

**演示：http: [//jsfiddle.net/6GHKN/](http://jsfiddle.net/6GHKN/)**

# r - 如何将 Emacs ESS 模式与 R markdown 一起使用？

> ID：16172345
> 
> 赞同：53
> 
> 时间：2013-04-23T14:44:08.017
> 
> 标签：r, emacs, ess, r-markdown

有没有办法配置 Emacs 以便它识别（并允许执行）R markdown (.Rmd) 文件中的 R 代码块，类似于它识别 .Rnw (Sweave) 或 .org (org-mode) 中的代码块的方式文件？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-23T18:02:41.017

[polymode](https://github.com/vitoshka/polymode)正在开发中，它确实/将允许您使用 R 块编写降价（用于处理`knitr`）。

设置 polymode+rmarkdown 的说明在[README中](https://github.com/vspinu/polymode/blob/master/readme.md)

它尚未完成，但正在取得进展。另请参阅 ess-help 邮件列表上的讨论（[gmane 存档](http://comments.gmane.org/gmane.emacs.ess.general/6994)|[邮件列表存档](https://stat.ethz.ch/pipermail/ess-help/2013-March/008755.html)）

* * *

更新：polymode 已在 MELPA 上发布，通过使用 emacs 现有的包机制简化了安装过程。请在[此处查看 ESS 邮件列表中的公告](https://stat.ethz.ch/pipermail/ess-help/2014-May/009926.html)。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-04-27T17:03:54.360

`polymode`从[github.com/vitoshka/polymode](https://github.com/vitoshka/polymode.git)下载 zip，或者，如果您是“git 人”，您可以使用：

```
git clone https://github.com/vitoshka/polymode.git 
```

将此函数添加到您的 Emacs 初始化文件中：

```
(defun rmd-mode ()
  "ESS Markdown mode for rmd files"
  (interactive)
  (setq load-path 
    (append (list "path/to/polymode/" "path/to/polymode/modes/")
        load-path))
  (require 'poly-R)
  (require 'poly-markdown)     
  (poly-markdown+r-mode)) 
```

现在，如果您已经安装了 ESS，只需打开您的 rmd 文件并输入`Meta`-`X``rmd-mode`并观察 Emacs 的美妙之处。

## MELPA 用户更新

`polymode`从 MELPA 使用*平面*文件结构。当您通过`M-x list-packages`或类似工具从 Emacs 存储库安装时，您可以直接将包文件放在它们应该放在的位置，即：`(expand-file-name "~/.emacs.d/elpa")`，因此请注释上述`load-path`代码：

```
;;  (setq load-path 
;;      (append (list "path/to/polymode/" "path/to/polymode/modes/")
;;          load-path)) 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2020-01-15T11:38:18.197

其他答案相当过时，`polymode`现在提供了一个专门用于处理`.Rmd`文件的包。只需使用[来自 MELPA](https://melpa.org/#/poly-R)`poly-R`的包，它的[源代码在 Github 上。](https://github.com/polymode/poly-R)

以下内容可能会添加到您`init.el`或您使用的任何地方`use-package`：

```
(use-package poly-R
  :ensure t
  :pin melpa-stable) 
```

有关修改默认键盘映射的更详细用例，请参阅[此配置](https://dotdoom.rgoswami.me/config.html#org17909a2)。该[文档描述](https://polymode.github.io/usage/)了默认的键盘映射。

# c++ - 使用“逗号初始化”初始化静态特征矩阵

> ID：16172352
> 
> 赞同：0
> 
> 时间：2013-04-23T14:44:17.500
> 
> 标签：c++, eigen

我在这里使用 Eigen 库：[http ://eigen.tuxfamily.org/index.php?title=Main_Page](http://eigen.tuxfamily.org/index.php?title=Main_Page)

尝试编译时，它返回

```
error: expected constructor, destructor, or type conversion before '.' 
```

抱怨我将 xaxis...zaxis 添加到矩阵的行。是否可能是因为 gcc4.3（这是我正在使用的编译器）不喜欢这种类型的初始化，因为点通常是一个函数调用（它不适用于未初始化的对象）？

但对我来说，它似乎完全遵循这里的教程示例：http: [//eigen.tuxfamily.org/dox/TutorialAdvancedInitialization.html](http://eigen.tuxfamily.org/dox/TutorialAdvancedInitialization.html)，除了静态，但没有它的错误是一样的。我尝试使用逗号分隔的初始化，但还是一样。

```
// axis system
static Eigen::Matrix<double, 3, 1>    s_xAxis(1.,0.,0.);            //!< global x Axis;
static Eigen::Matrix<double, 3, 1>    s_yAxis(0.,1.,0.);            //!< global y Axis;
static Eigen::Matrix<double, 3, 1>    s_zAxis(0.,0.,1.);            //!< global z Axis;

// origin
static Eigen::Matrix<double, 3, 1>    s_origin(0.,0.,0.);           //!< origin position

static Eigen::Matrix<double, 3,3>     s_idRotationZinverse;
s_idRotationZinverse.col(0) << s_yAxis;
s_idRotationZinverse.col(1) << s_xAxis;
s_idRotationZinverse.col(2) << -s_zAxis; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T11:13:14.103

哦，我明白了。

这段代码：

```
s_idRotationZinverse.col(0) << s_yAxis; 
```

不是声明；这是一个必须在函数体内的语句。

您可能试图在任何函数之外执行它，这在语法上不正确并[导致您提到的错误](http://ideone.com/kAmdLR)。

您可能被 Eigen 文档欺骗了，该文档将这种语法称为“逗号初始化”，它应该是“逗号赋值”左右。初始化是指在定义变量时为其赋予值，而不是作为单独的步骤。初始化在语法上是声明的一部分，因此可以在函数体之外完成。

我建议 fork Eigen 以支持[`std::initializer_list`](http://en.cppreference.com/w/cpp/utility/initializer_list)基于 new 的初始化（如果尚未完成）并提交拉取请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:30:33.687

你有没有尝试过：

```
s_idRotationZinverse.col(0) = s_yAxis; 
```

# oracle - 顶点检索默认项目值

> ID：16172355
> 
> 赞同：1
> 
> 时间：2013-04-23T14:44:30.737
> 
> 标签：oracle, oracle11g, oracle-apex

是否可以使用 plsql 获取默认项目值？我有一个验证，如果它失败，我想将项目重置为其默认值。我尝试使用`apex_util.set_session_state('P_ITEM_NAME', null)`，但没有任何明显的效果。

如何检索默认项目或重置项目本身？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T06:52:43.623

在创建页面进程时，有一个叫做“显示内联验证错误”的条件，也许这会有所帮助？在此过程中，您可以将项目重置为空，然后当页面加载时，项目值将恢复为默认值。

升级版：

创建过程：

*   处理点：在标头前加载

*   条件：显示内联验证错误

*   工艺来源：

    ```
    begin
      for i in (
       select t.ITEM_DEFAULT, t.item_name
        from apex_application_page_items t
        where t.application_id = :APP_ID
          and t.page_id = :APP_PAGE_ID
      ) loop
        apex_util.set_session_state(i.item_name, i.item_default);
      end loop;
    end; 
    ```

这会将所有页面项目恢复为其默认值。这个解决方案有些难看，但我不知道这个问题的另一种解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:00:20.357

`:P_ITEM_NAME := null;`

这里的区别是项目前面的“：”。像这样使用它可以访问该项目。我相信不需要使用撇号。

如果这不适用于您的版本，请尝试不使用 ;。

所以你可以使用：

```
:P_ITEM_NAME 
```

获得价值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T18:52:27.820

我找不到任何可以使用项目返回默认值的函数。但是我可以使用默认项目设置来模仿这一点。当页面出现验证错误时，页面进程不会运行，因此我添加了条件页面进程，它执行与我的验证相同的检查，当这些检查表明验证失败时，它只会清除项目状态。

这很丑陋，因为它需要重复检查，并且似乎有必要在需要这种重置机制的所有页面中复制几乎相同的页面控件。

# javascript - 响应式表格，可以继承嵌套表格单元格的宽度

> ID：16172356
> 
> 赞同：1
> 
> 时间：2013-04-23T14:44:32.643
> 
> 标签：javascript, jquery, css, html-table, responsive

我有一个响应式表格，每行有不同的内容，每行有一个六角手风琴机制。

手风琴本质上在当前行下方添加了另一个表格行，该行有一个 td 和一个 colspan，用于表示表格中的单元格数量。

在这个手风琴内，我有另一个表格，我需要表格单元格与父表格对齐。我很欣赏这可能单独使用 HTML/CSS 是不可能的，并且可能需要使用 JS 来完成？

还是有其他方法？

我不能在这里发布我的所有代码，但这是我的意思的截图

![在此处输入图像描述](https://i.stack.imgur.com/TnWha.png)

```
<table class="parent-table">
<tr>
    <td>Cell 1</td>
    <td>Cell 2</td>
    <td>Cell 3</td>
    <td>Cell 4</td>
    <td>Cell 5</td>
    <td>Cell 6</td>
</tr>
<tr>
    <td colspan="6" class="concertina">
        <div>
            <table>
                <tr>
                    <td>Other 1</td>
                    <td>Other 2</td>
                    <td>Other 3</td>
                    <td>Other 4</td>
                    <td>Other 5</td>
                    <td>Other 6</td>
                </tr>
            </table>
        </div>
    </td>
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:57:33.663

简短的回答是“不”，仅使用 HTML/CSS 是不可能的。我自己正在研究一个带有可调整大小列的固定标题、可滚动表格，以及双击列标题边框以自动调整。它远未完成，我可以告诉你，如果这大致是你前进的方向，你可能想深呼吸。

**以下更新**

从截图来看，您是否考虑过修改 HTML 结构？

从下面的标记中，您有多个`<tbody>`部分，每个部分都有一个`<tr>`包含`<th>`元素的第一个部分。其余的将显示详细数据，`<tr>`其中包含典型`<td>`元素的行。

在 jQuery 中，您可以使用`$('tr:has(th)')`选择标题行和`$('tr:has(td)')`选择数据行。

`<th>`标题中的最后一个将容纳您的“更多/更少”控件，它只是显示/隐藏后续数据行。

这对你有用吗？

```
<table class="master-table">
        <tbody class="concertina">
            <tr>
                <th>Header 1</th>
                <th>Header 2</th>
                <th>Header 3</th>
                <th>Header 4</th>
                <th>Header 5</th>
                <th>Header 6</th>
                <th>More</th>
            </tr>
            <tr>
                <td>Cell 1</td>
                <td>Cell 2</td>
                <td>Cell 3</td>
                <td>Cell 4</td>
                <td>Cell 5</td>
                <td colspan="2">Cell 6</td>
            </tr>
        </tbody>
        <tbody class="concertina">
            <tr>
                <th>Header 1</th>
                <th>Header 2</th>
                <th>Header 3</th>
                <th>Header 4</th>
                <th>Header 5</th>
                <th>Header 6</th>
                <th>More</th>
            </tr>
            <tr>
                <td>Cell 1</td>
                <td>Cell 2</td>
                <td>Cell 3</td>
                <td>Cell 4</td>
                <td>Cell 5</td>
                <td colspan="2">Cell 6</td>
            </tr>
        </tbody>
    </table>
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:55:13.220

使用以下 CSS 重置您的表格：

```
table {
    border-collapse: collapse;
    border-spacing: 0;
} 
```

然后你必须设置`<td>`s的宽度

# objective-c - 如何在 Objective-C 的 NSTextField 中将 char 与 int 结合起来？

> ID：16172370
> 
> 赞同：0
> 
> 时间：2013-04-23T14:45:23.307
> 
> 标签：objective-c, xcode, cocoa, nstextfield

例如，我有以下代码，其中`lblPercent`是`NSTextField`：

```
double Progress = progress( Points);
[lblPercent setIntValue:(Progress)]; 
```

我将它设置为整数值，因此它会抛出小数，因为出于某种原因，`NSProgressIndicator`我不得不使用双精度数。无论如何，在进度条旁边的标签中，我希望它看到旁边带有百分号的数字 x%。

我尝试了标准的连接技术，但没有骰子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:07:03.920

您应该使用[带有百分比样式的 NSNumberFormatter](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSNumberFormatter_Class/Reference/Reference.html#//apple_ref/doc/uid/20000202-BCIIABFH)

```
NSNumberFormatter* formatter = [[NSNumberFormatter alloc] init];
[formatter setNumberStyle: NSNumberFormatterPercentStyle];
// Any other format settings you want
NSString* formattedNumber = [formatter stringFromNumber: [NSNumber numberWithDouble: progress]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:58:17.577

```
NSInteger percentageProgress = (NSInteger) (Progress * 100);
[lblPercent setText:[NSString stringWithFormat:@"%d%%", percentageProgress]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T14:48:12.180

尝试

```
[lblPercent setText:[NSString stringWithFormat:@"%d%%",[Progress intValue]]]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-11T18:33:14.017

```
NSString *string = [NSString stringWithFormat:@"%.0f%@",Progress, @"%"];
[lblPercent setStringValue:string]; 
```

这似乎对我有用，就像我做的那样......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T14:55:59.913

您可以`unicode characters`使用`percent sign`.

IE

`double value;`

`myLabel.text = [NSString stringWithFormat:@"%d\u0025", value ]`

[u0025](http://www.fileformat.info/info/unicode/char/25/index.htm)是 Unicode 字符`'percent sign'`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-23T14:55:18.867

```
NSMutableString *value = lblPercent.text;
[value appendString:@"%"];
[lblPercent setText:value]; 
```

# c# - Datagrid图像列以编程方式添加wpf

> ID：16172371
> 
> 赞同：0
> 
> 时间：2013-04-23T14:45:25.113
> 
> 标签：c#, wpf

我正在寻找一种方法来以编程方式将显示图像的列添加到数据网格。我一直在寻找如何找到解决方案很长时间没有成功。

我现在的做法是这样的：

```
DataGridTemplateColumn col1 = new DataGridTemplateColumn();
col1.Header = "Betaald";
FrameworkElementFactory factory1 = new FrameworkElementFactory(typeof(System.Windows.Controls.Image));
Binding b1 = new Binding("Picture") { Mode = BindingMode.TwoWay };
factory1.SetBinding(System.Windows.Controls.Image.SourceProperty, b1);
DataTemplate cellTemplate1 = new DataTemplate();
cellTemplate1.VisualTree = factory1;
col1.CellTemplate = cellTemplate1;
dtgVerkoopsdocumenten.Columns.Add(col1); 
```

这应该创建一个我可以显示图像的列。我从数据库中获得的所有数据，我存储在这样的列中：

```
System.Windows.Controls.Image image = new System.Windows.Controls.Image(); //this is on top of my class

MySqlDataReader reader = cmd.ExecuteReader();
while (reader.Read())
{
    string naam = getKlant(reader.GetInt32(2));

    if (reader.GetBoolean(7) == false)
    {
        BitmapImage betalen = new BitmapImage(new Uri("/WpfApplication1;component/Images/false.png", UriKind.Relative));
        image.Source = betalen;
    }
    else
    {
        BitmapImage betalen = new BitmapImage(new Uri("/WpfApplication1;component/Images/true.png", UriKind.Relative));
        image.Source = betalen;
    }

    dtgVerkoopsdocumenten.Items.Add(new DataItem
    {
        ID = reader.GetInt32(1),
        klant = naam,
        netto = reader.GetDouble(3),
        btw = reader.GetDouble(4),
        bruto = reader.GetDouble(5),
        datum = reader.GetDateTime(6).ToString("dd-MM-yyyy"),
        soort2 = soort,
        Picture = image
        });
    }
    reader.Close(); 
```

DataItem 是一个自己制作的类，我存储在我的所有绑定中：

```
//more code, but the one below is the one I'm talking about
public System.Windows.Controls.Image Picture { get; set; } 
```

我现在得到的绝对没有。我没有收到任何错误。

所以我的问题是：如何将图像存储到数据网格中，而不必过多地处理 xaml 文件。

输出：

```
System.Windows.Data Error: 1 : Cannot create default converter to perform 'two-way' conversions between types 'System.Windows.Controls.Image' and 'System.Windows.Media.ImageSource'. Consider using Converter property of Binding. BindingExpression:Path=Picture; DataItem='DataItem' (HashCode=435249); target element is 'Image' (Name=''); target property is 'Source' (type 'ImageSource')
System.Windows.Data Error: 5 : Value produced by BindingExpression is not valid for target property.; Value='System.Windows.Controls.Image' BindingExpression:Path=Picture; DataItem='DataItem' (HashCode=435249); target element is 'Image' (Name=''); target property is 'Source' (type 'ImageSource')
System.Windows.Data Error: 1 : Cannot create default converter to perform 'two-way' conversions between types 'System.Windows.Controls.Image' and 'System.Windows.Media.ImageSource'. Consider using Converter property of Binding. BindingExpression:Path=Picture; DataItem='DataItem' (HashCode=45279885); target element is 'Image' (Name=''); target property is 'Source' (type 'ImageSource')
System.Windows.Data Error: 5 : Value produced by BindingExpression is not valid for target property.; Value='System.Windows.Controls.Image' BindingExpression:Path=Picture; DataItem='DataItem' (HashCode=45279885); target element is 'Image' (Name=''); target property is 'Source' (type 'ImageSource') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:53:08.797

您应该使用`SetBinding`方法而不是`SetValue`，因为您正在将绑定分配给属性，而不是为属性分配值。

从：

```
factory1.SetValue(System.Windows.Controls.Image.SourceProperty, b1); 
```

至：

```
factory1.SetBinding(System.Windows.Controls.Image.SourceProperty, b1); 
```

您的绑定声明也可以写成：

```
Binding b1 = new Binding("Picture") { Mode = BindingMode.TwoWay }; 
```

# css - 如何设置仅适用于特定类别的边距？

> ID：16172393
> 
> 赞同：1
> 
> 时间：2013-04-23T14:45:56.763
> 
> 标签：css, image, html, margin

在我的页面的头部，我有 html：

```
img {
margin-top:5px;
margin-left:15px;
margin-bottom:5px;
margin-right:15px;
} 
```

我设置这些规则以影响某个 CSS 类中的翻转图像，但我希望页面上的其余图像不受影响。有没有办法在类中指定这些规则？像一种 img 变体规则？

我试图影响的类在我附加的样式表中如下所示：

```
.menu {
margin-top: 0px;
margin-right: auto;
margin-bottom: 0px;
margin-left: auto;
text-align: center;
padding-top: 0px;
padding-bottom: 0px;
width: 500px;
} 
```

# ios - IOS6 Safari Ajax 微调器

> ID：16172394
> 
> 赞同：4
> 
> 时间：2013-04-23T14:45:59.417
> 
> 标签：ios, ajax, mobile-safari, cors, safari

我可以使 CORS Ajax 帖子在 IOS6 上正常工作，但是关于小微调器有一些非常奇怪的行为，表明尽管请求完成，浏览器仍在加载某些内容。

我在[这里提供了一个演示此行为的实时页面](http://s3-eu-west-1.amazonaws.com/ios6.spinner/ios6.html)

node.js + express 服务器的源代码可[在此处获得](https://s3-eu-west-1.amazonaws.com/ios6.spinner/ios6.zip)

请注意，这只发生在 IOS6 上，此外它在选项卡之间的行为不一致，例如，您可以导航到同一选项卡上的另一个页面，它将继续旋转，但打开第二个选项卡，加载页面，然后关闭第一个选项卡并消失了。

此外，如果您运行测试页面，然后使用相同的浏览器选项卡转到不同的站点，则微调器将继续在新站点上旋转。

所以我正在寻找的是一些可能使它以一种明智的方式表现的黑客，我对不使用 Ajax、CORS 或 POST 不感兴趣。

感谢您抽出时间来看看。

更新：Apple 已经确认了这个问题，但仅此而已，所以只能等着看下一个版本是否能解决它。我将停止测试服务器，但保留可用的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-05T07:06:44.023

我今天也独立遇到了这个问题。我减少了我的测试用例，发现这只发生在触发预检请求的 CORS 请求上。所以它让我相信它与连续触发的两个请求有关。选项，然后是您请求的任何方法。

一旦触发预检CORS请求，微调器永远不会消失，您在哪个阶段触发请求也无关紧要。

更新：刚刚尝试了 iOS7 测试版，这个错误仍然存​​在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T11:25:31.323

把它放在你的代码中。

```
$(document).ready(function(){
    getUpdates();
});

function getUpdates() {
    $.post("status.jsp", {}, function(status){

        // do client-side rendering here

        setTimeout(getUpdates, 5000);
    }, "json");
} 
```

去这个网站了解更多信息。 [http://www.devthought.com/2012/09/22/understanding-the-ios6-ajax-bugs/](http://www.devthought.com/2012/09/22/understanding-the-ios6-ajax-bugs/)

# angularjs - angularjs - 需要延迟搜索指令的帮助

> ID：16172397
> 
> 赞同：1
> 
> 时间：2013-04-23T14:46:05.107
> 
> 标签：angularjs, angularjs-directive

在这里摆弄：http: [//jsfiddle.net/graphicsxp/QA4Fa/2/](http://jsfiddle.net/graphicsxp/QA4Fa/2/)

我正在尝试创建一个搜索指令。基本上它只是一个检测用户输入的文本框，并在 1 秒延迟后调用搜索方法。

它还没有工作，我有两个问题。

首先，为什么当用户输入文本时 filterCriteria 没有在 span 中更新？

其次，filterCriteria 上的监视在页面加载时触发，而不是在文本框中输入文本时触发。

```
<div ng-app="myApp" ng-controller="myController">   
  <delayed-search ng-model="filterCriteria"></delayed-search>
   <span>filter criteria is : {{filterCriteria}}</span>
</div>

angular.module('myApp', []).directive("delayedSearch", ['$timeout', function($timeout) {
return {
    restrict: "E",
    template: '<input type="text"  />',
    scope: {
        filterCriteria : '='
    },
    link: function (scope, element, attrs) {

    },
    controller: function ($scope) {
        var timer = false;
        $scope.$watch('filterCriteria', function () {
            if (timer) {
                $timeout.cancel(timer);
            }
            timer = $timeout(function () {
                alert('timeout expired');
            }, 1000)
        });
    }
}
}]).controller('myController', function($scope){  }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:00:24.477

```
You should NOT use a controller with a directive ( until you understand it ! ) . 
```

指令中的控制器用于指令到指令的通信（我希望他们将其命名为其他名称！）。

@Langdon 做对了。但这是另一个相同的实现。请注意，在两个答案中都缺少控制器。

[http://jsfiddle.net/QA4Fa/4/](http://jsfiddle.net/QA4Fa/4/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T14:50:08.797

> 首先，为什么当用户输入文本时 filterCriteria 没有在 span 中更新？

你的范围是错误的，应该是`scope: { ngModel : '=' },`，你的模板应该是`template: '<input type="text" ng-model="ngModel" />`。

> 其次，filterCriteria 上的监视在页面加载时触发，而不是在文本框中输入文本时触发。

和第一个问题一样，你应该看`ngModel`。

此外，您不需要控制器的开销，只需使用链接功能即可。这是一个更新的小提琴：http: [//jsfiddle.net/QA4Fa/3/](http://jsfiddle.net/QA4Fa/3/)

# backbone.js - Fine-Uploader 如何为每个文件捕获额外的参数，同时仍然允许多个文件

> ID：16172404
> 
> 赞同：1
> 
> 时间：2013-04-23T14:46:15.933
> 
> 标签：backbone.js, marionette, fine-uploader

我需要允许用户选择要上传的文件，然后需要从用户那里捕获适用于该特定文件的其他所需信息，这些信息将在上传时作为参数发送到服务器。

到目前为止，我一直在通过处理精细上传器 onSubmit 回调并显示带有我需要的输入的模式来做到这一点。如果输入通过验证，我会存储文件 id 和相关参数，否则，如果它们关闭/取消模式，我会调用 Fine-uploader 取消 api 并取消具有给定 id 的文件。

用户可以多次执行此操作，将文件排入标准精细上传器列表，然后他们将按“上传”以实际同时开始上传。

所有这一切都很好，我的问题是因为我启用了“多个”选项，用户可以同时选择或拖动多个文件，但我需要**单独**向每个文件呈现模态。onSubmit 事件是为每个文件单独触发的，那么在我取消或保存前一个文件之前，如何防止第二个、第三个等模式打开？

作为记录，我实际上是在使用 Backbone/Marionette 并为每个 onSubmit 回调触发一个“文件：添加”事件。这是我创建模态视图并显示它的地方，但是，该解决方案不需要绑定到主干。

此外，如果有更好的方法来使用 Fine-uploader 为文件收集参数，我不一定会使用这种方法 - 只需要确保每个文件都填充了额外的数据，否则无法上传。

这是 Fine Uploader onSubmit 回调：

```
.on('submit', function(event, id, name) {
   var args = {};
   args.id = id;
   args.fileName = name;
   uploadDocsVent.trigger('file:added', args);  
}) 
```

这是我的代码，它正在侦听该事件，创建文件主干模型，并实例化要在模态区域中显示的视图。

```
uploadDocsVent.on("file:added", function(args){
    var file = new UploadDocuments.File( args );    
    var addlInfoView = new UploadDocuments.Views.FileInfo({ 
        model: file, 
        categories: App.uploadedFilesCategories 
    });
    App.appLayout.modalConfirmRegion.show(addlInfoView);
}); 
```

在我看来，我有此代码响应模态点击：

```
onDialogPrimaryClicked: function () {
    UploadDocuments.claimsUploadWidget.addFileWithInfo( this.model );
    this.trigger("dialog:close");
},

onDialogSecondaryClicked: function () {
    UploadDocuments.uploadView.uploader.fineUploader('cancel', this.model.get('id'));
    this.trigger("dialog:close");
} 
```

在此先感谢您提供有关如何解决/解决此问题的任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T19:51:30.517

安德鲁 - 我想我知道你在说什么。很明显，您只是希望 Fine Uploader 仅在用户以您在 onSubmit 处理程序中为该文件显示的模式提交信息后处理一批选定文件中的文件。您正在寻找的是一种在 onSubmit 处理程序中返回承诺或“延迟”的方法。一旦您的用户提交了相关的模式，这将允许您回叫 Fine Uploader（并说“继续，上传/提交此文件并继续下一个”）。

我已经创建了一个[`qq.Promise`](http://docs.fineuploader.com/api/promise.html)实现[承诺模式](http://blogs.msdn.com/b/ie/archive/2011/09/11/asynchronous-programming-in-javascript-with-promises.aspx)的“类” 。Fine Uploader 将 Promise 视为`onPasteReceived`此时仅用于回调的有效返回值。允许它作为其他回调的有效返回值可能是有意义的，例如`onSubmit`. 这将允许您推迟文件的上传/提交，直到用户处理了相关的模式。`multiple`由于 Fine Uploader 在“单文件模式”下的工作方式，现在 将选项设置为“false”可能是也可能不是您想要的选项。

我认为允许在某些回调（例如这个回调）中返回承诺以允许用户交互可能很有价值。你能在 Github 项目中[打开一个功能请求吗？](https://github.com/Widen/fine-uploader/issues/new)在那里，我们可以进行更多讨论，您可以跟踪我放入库中的任何相关更改的进度。

# java - log4j 在带有 Spring 的 JAX-WS 中无法正常工作

> ID：16172405
> 
> 赞同：2
> 
> 时间：2013-04-23T14:46:19.240
> 
> 标签：java, web-services, log4j, websphere, jax-ws

我用 Spring 设置了一个 JAX-WS，除了 log4j 之外，一切都有效：

我正在关注官方的 sping 文档： [http ://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/remoting.html#remoting-web-services-jaxws-export-servlet](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/remoting.html#remoting-web-services-jaxws-export-servlet)

端点定义如下：

```
import org.springframework.web.context.support.SpringBeanAutowiringSupport;

@WebService(serviceName="AccountService")
public class AccountServiceEndpoint extends SpringBeanAutowiringSupport {

@Autowired
private AccountService biz;

@WebMethod
public void insertAccount(Account acc) {
   biz.insertAccount(acc);
} 
```

然后我尝试在 AccountService 的 impl 中写入日志：

```
public class AccountServiceImpl implements AccountService {
    private static Logger logger =   Logger.getLogger(AccountServiceImpl.class.getName()); 
     ... 
     public void insertAccount(Account acc) {
         logger.debug("someting... " ) 
         ....
     }   
 } 
```

并在 web.xml

```
<context-param>   
 <param-name>log4jConfigLocation</param-name>   
 <param-value>classpath:my_log4j.xml</param-value>
 </context-param>
 <listener>   
  <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
 </listener> 
```

我已经测试了 my_log4j.xml，配置是绝对正确的，而且我在启动时也得到了显示 my_log4j.xml 在 WebApplicationContext 初始化之前加载的日志

我想知道是否是因为 WebService 用完了 Spring 那么 log4jConfigLocation 不起作用

我使用的服务器是 Websphere Application Server 7.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T03:57:14.343

最后通过将类加载器策略更改为 PARENT_LAST 来修复，问题已关闭

# c# - C#如何创建一个包含4个或更多字段的文件？

> ID：16172407
> 
> 赞同：-1
> 
> 时间：2013-04-23T14:46:27.700
> 
> 标签：c#, c++, filestream, field, records

我有这段代码来创建一个名为“SomeFile.txt”的文件

```
FileStream fsw = new FileStream("SomeFile.txt", FileMode.Append, FileAccess.Write); 
```

我想知道如何在这个文件中插入 4 个字段和大约 10 条记录，因为我不擅长 C# 编码。

提前致谢。

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:50:55.297

```
string path = @"C:\somefile.txt";
using (StreamWriter writer = (File.Exists(path) ? File.AppendText(path) : new StreamWriter(path)))
    writer.WriteLine("whatever you want to write"); 
```

# android - 使用actionbarsherlock时如何隐藏标签？

> ID：16172408
> 
> 赞同：0
> 
> 时间：2013-04-23T14:46:28.797
> 
> 标签：android, actionbarsherlock

使用actionbarsherlock时，当有很多选项卡时如何隐藏其他选项卡并且只显示三个或四个选项卡，当我滑动选项卡时我可以看到隐藏的选项卡？

谢谢~

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:30:27.410

尽管您对问题进行了简短描述，但我想以下链接应该会给您答案： [SwipeyTabs - how to create Swipey Tabs using ActionBarSherlock Library?](https://stackoverflow.com/questions/10912602/swipeytabs-how-to-create-swipey-tabs-using-actionbarsherlock-library)

如果这没有帮助，请在阅读后尝试改写您的问题：http: [//developer.android.com/design/patterns/actionbar.html](http://developer.android.com/design/patterns/actionbar.html)

# jboss - 仅在 Jboss 7 上限制对本地 IP 的访问

> ID：16172410
> 
> 赞同：1
> 
> 时间：2013-04-23T14:46:32.730
> 
> 标签：jboss, jboss7.x

Jboss 7.0（默认情况下）配置为通过在以下位置定义来限制对本地 ip 的访问`standalone.xml`：

```
<interfaces>
    <interface name="public">
        <inet-address value="127.0.0.1"/>
    </interface>
</interfaces 
```

我知道我可以通过以下方式更改它以使其对所有 ips 公开可用：

```
<interfaces>
    <interface name="public">
        <any-address/>
    </interface>
</interfaces 
```

但是我怎样才能将其限制为仅本地 IP，例如所有以 开头的 IP 地址`10.x.x.x`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T16:07:30.333

我认为这可能会有所帮助：[https ://docs.jboss.org/author/display/AS71/Interfaces+and+ports](https://docs.jboss.org/author/display/AS71/Interfaces+and+ports)

```
<interface name="default">
   <!-- Match any interface/address on the right subnet -->
   <subnet-match value="192.168.0.0/16"/>
</interface> 
```

通过这种方式，您可以匹配给定子网中的所有地址。

# android - 来自文本文件（来自资产）的按钮文本和字符串应该相同，但在 Android 中不同

> ID：16172414
> 
> 赞同：0
> 
> 时间：2013-04-23T14:46:44.323
> 
> 标签：android, string, gettext, readline, settext

我想做一个测验程序。问题位于资产文件夹中的文本文件中。答案也在名为问题编号的资产文件夹中（例如：第一个问题的答案在名为 1 的文本文件中）。我想随机给出问题和答案（按钮的答案）。直到这一切都很好（也许不是最短的解决方案，但效果很好）。然后用户可以点击正确的按钮回答问题。这就是问题所在。我得到按钮的文本和答案文件的第一行（第一行总是答案文本文件中的正确答案）。应该是一样的，然后我签字，这是正确答案。但它不一样，我不知道为什么。从答案文件中将文本放入按钮并从答案文件中获取第一行，所以应该是一样的。我把它打印出来记录猫，看起来它们是一样的。我不知道可能出了什么问题。谁能帮帮我。

这是我设置按钮文本（随机）并比较第一行和按钮文本的地方：

```
BufferedReader br2 = new BufferedReader(is2, 8192);

                        for(int k2=0; k2<3; k2++){
                            try {
                                kerdes2[k2] =  br2.readLine();
                                final ArrayList <Integer> kerdesno2 = new ArrayList<Integer>();
                                for(int j=0;j<3;j++) kerdesno2.add(j);
                                Collections.shuffle(kerdesno2);
                                System.out.println(kerdesno2);
                                answ.setText(kerdes2[kerdesno2.get(0)]);
                                answ2.setText(kerdes2[kerdesno2.get(1)]);
                                answ3.setText(kerdes2[kerdesno2.get(2)]);
                            } catch (IOException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }
                        }
                            answ.setOnClickListener(new View.OnClickListener() {

                                @Override
                                public void onClick(View v) {
                                    // TODO Auto-generated method stub
                                    InputStreamReader is3 = null;
                                    try {
                                        is3 = new InputStreamReader(am.open(i3), "ISO-8859-1");
                                    } catch (UnsupportedEncodingException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    } catch (IOException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    }
                                    BufferedReader br3 = new BufferedReader(is3, 8192);
                                    try {
                                        String helyes = br3.readLine();
                                        System.out.println(helyes);
                                        String gomb = answ.getText().toString();
                                        System.out.println(gomb);

                                        for(int f=0; f<helyes.length(); f++)
                                        {
                                            char c = helyes.charAt(f);
                                            char d = gomb.charAt(f);
                                            if(c != d){
                                                System.out.println(c);
                                                System.out.println(((String) gomb).indexOf(c));
                                            }
                                        }

                                        if(gomb == helyes)                                  
                                        {
                                            x++;
                                            TextView eredmeny = (TextView)findViewById(R.id.eredmeny);
                                            eredmeny.setText("Eredményed: " + Math.round(x*100/i2) + "%");
                                        }
                                        else
                                        {
                                            TextView eredmeny = (TextView)findViewById(R.id.eredmeny);
                                            eredmeny.setText(gomb + " = " + helyes);
                                        }
                                    } catch (IOException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    }
                                }
                            });

                            answ2.setOnClickListener(new View.OnClickListener() {

                                @Override
                                public void onClick(View v) {
                                    // TODO Auto-generated method stub
                                    InputStreamReader is3 = null;
                                    try {
                                        is3 = new InputStreamReader(am.open(i3), "ISO-8859-1");
                                    } catch (UnsupportedEncodingException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    } catch (IOException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    }
                                    BufferedReader br3 = new BufferedReader(is3, 8192);
                                    try {
                                        String helyes = br3.readLine();
                                        System.out.println(helyes);
                                        String gomb = answ2.getText().toString();
                                        System.out.println(gomb);
                                        if(gomb == helyes)                                          
                                        {
                                            x++;
                                            TextView eredmeny = (TextView)findViewById(R.id.eredmeny);
                                            eredmeny.setText("Eredményed: " + Math.round(x*100/i2) + "%");
                                        }
                                        else
                                        {
                                            TextView eredmeny = (TextView)findViewById(R.id.eredmeny);
                                            eredmeny.setText(gomb + " = " + helyes);
                                        }
                                    } catch (IOException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    }
                                }
                            });

                            answ3.setOnClickListener(new View.OnClickListener() {

                                @Override
                                public void onClick(View v) {
                                    // TODO Auto-generated method stub
                                    InputStreamReader is3 = null;
                                    try {
                                        is3 = new InputStreamReader(am.open(i3), "ISO-8859-1");
                                    } catch (UnsupportedEncodingException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    } catch (IOException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    }
                                    BufferedReader br3 = new BufferedReader(is3, 8192);
                                    try {
                                        String gomb = answ3.getText().toString();
                                        String helyes = br3.readLine();
                                        System.out.println(gomb);
                                        System.out.println(helyes);
                                        if(gomb == helyes){
                                            x++;
                                            TextView eredmeny = (TextView)findViewById(R.id.eredmeny);
                                            eredmeny.setText("Eredményed: " + Math.round(x*100/i2) + "%");
                                        }
                                        else
                                        {
                                            TextView eredmeny = (TextView)findViewById(R.id.eredmeny);
                                            eredmeny.setText(gomb + " = " + helyes);
                                        }
                                    } catch (IOException e) {
                                        // TODO Auto-generated catch block
                                        e.printStackTrace();
                                    }
                                }
                            }); 
```

如您所见，我尝试遍历这两个字符串以了解问题出在哪里，但是我找不到...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:59:23.640

字符串是一个对象。比较对象时，使用 .equals()，而不是 ==。

你的代码：

```
if(gomb == helyes) 
```

应该：

```
if(gomb.equals(helyes)) 
```

通过使用 == 您正在比较内存，而不是实际的 String 对象。有时你会得到预期的结果，但有时你不会。.equals() 将始终测试字符串本身。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:00:03.217

我可以看到你在比较

```
if(gomb == helyes){ 
```

虽然它应该是

```
if(gomb.equals(helyes)){ 
```

# jquery - Wordpress 中的自定义搜索自动建议

> ID：16172425
> 
> 赞同：0
> 
> 时间：2013-04-23T14:47:14.943
> 
> 标签：jquery, wordpress, autosuggest

我正在尝试让自动建议搜索在 Wordpress 中从非 WP 表中提取数据。我正在使用“在帖子和页面中允许 PHP”插件。

我的搜索页面运行页面中定义的此代码

```
[php]
$themeDir = get_bloginfo('template_url');

echo "<html>";
echo "<head>";
echo "<script type='text/javascript' src='jquery/js/jquery-1.4.2.min.js'></script>";
echo "<script type='text/javascript' src='jquery/js/jquery-ui-1.8.2.custom.min.js'></script>";
echo "<script type='text/javascript'> jQuery(document).ready(function(){
  $('#zipsearch').autocomplete({source:'http://127.0.0.1/wp/?page_id=230', minLength:2});
});

</script>";
echo "<link rel='stylesheet' href='jquery/css/smoothness/jquery-ui-1.8.2.custom.css' />";
echo "<style type='text/css'><!--

/* style the auto-complete response */
li.ui-menu-item { font-size:12px !important; }--></style>";
echo "</head>";

echo "<body>";

echo "<form onsubmit='return false;'>Enter a Zipcode:<input id='zipsearch' type='text' />";
echo "</form>";

echo "</body>";
echo "</html>";

[/php] 
```

从中调用的结果页面 (page_id=230) 是

```
[php]
//$term = mysql_real_escape_string($_REQUEST['term']);
$term = $_REQUEST['term'];
$sql = "select zip, city, state from zipcode where zip like '$term%' order by zip asc  limit 0,10";
$rs = mysql_query($sql);
$num = mysql_num_rows($rs);
$data = array();
if ($num > 0) {

  for ($i=0;$i<$num;$i++) {
    $zip = mysql_result($rs,$i,'zip');
    $city = mysql_result($rs,$i,'city');
    $state = mysql_result($rs,$i,'state');
    $data[] = array('label' => $zip .', '. $city.' '. $state,'value' => $zip);

  }
}

echo json_encode($data);
flush();
[/php] 
```

结果页面似乎正在工作，因为如果我输入此 url (/wp/?page_id=230&term=331)，我会得到以下结果

```
[{"label":"33101, Miami FL","value":"33101"},{"label":"33102, Miami FL","value":"33102"},{"label":"33107, Miami FL","value":"33107"},{"label":"33109, Miami Beach FL","value":"33109"},{"label":"33110, Miami FL","value":"33110"},{"label":"33111, Miami FL","value":"33111"},{"label":"33112, Miami FL","value":"33112"},{"label":"33114, Miami FL","value":"33114"},{"label":"33116, Miami FL","value":"33116"},{"label":"33119, Miami Beach FL","value":"33119"}] 
```

问题是结果页面看不到从 jquery 正确调用，因为没有结果弹出到搜索窗口中。如果我检查元素，我可以看到结果页面的标记。

我在这里有一个截屏视频[http://screencast.com/t/RH5NsErLf6BN](http://screencast.com/t/RH5NsErLf6BN)，它显示了会发生什么。

希望我已经清楚了，如果没有，请告诉我在哪里可以澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:34:31.373

看看这个页面。这是关于自动建议显示元数据

[https://wordpress.stackexchange.com/questions/58592/auto-suggest-to-display-meta-data-but-not-to-include-it-upon-click](https://wordpress.stackexchange.com/questions/58592/auto-suggest-to-display-meta-data-but-not-to-include-it-upon-click)

这可以帮助你！

# django - django ModelMultipleChoiceField 在模板中显示

> ID：16172428
> 
> 赞同：2
> 
> 时间：2013-04-23T14:47:28.690
> 
> 标签：django

```
class AddRoleForm(forms.Form):
     roles=forms.ModelMultipleChoiceField(queryset=Role.objects.all(),widget=forms.CheckboxSelectMultiple()) 
```

在模板中：</p>

```
{{ form.roles }} 
```

结果是这样的：

```
 <ul>
    <li><label for="id_roles_0"><input type="checkbox" value="1" name="roles" id="id_roles_0"> User object</label></li>
    <li><label for="id_roles_1"><input type="checkbox" value="2" name="roles" id="id_roles_1"> User object</label></li>
    </ul> 
```

我想在每一行中显示角色的名称，并在 chebox 中获取角色的 id，例如：

```
<ul>
    <li><label for="id_roles_0"><input type="checkbox" value="100" name="roles" id="id_roles_0">boss</label></li>
    <li><label for="id_roles_1"><input type="checkbox" value="101" name="roles" id="id_roles_1">employee</label></li>
    </ul> 
```

我应该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-24T07:06:17.523

检查您的模型“角色”

你需要添加

```
def __unicode__(self):
    return self.name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:54:55.703

我想你这篇文章可能会对你有所帮助。

看看：[Django - 在模板中单独渲染 CheckboxSelectMultiple() 小部件（手动）](https://stackoverflow.com/questions/15323724/django-render-checkboxselectmultiple-widget-individually-in-template-manual)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:23:20.310

*   要更改`value`参数，您必须执行以下步骤：

    1.  编写自己的`CheckboxInput`重载`render`函数。你必须改变

        ```
        final_attrs['value'] = force_text(value) 
        ```

        像这样的东西：

        ```
        final_attrs['value'] = force_text(str(int(value) + 99)) 
        ```

        其他部分可以复制而无需更改。

    2.  编写自己的`CheckboxSelectMultiplue`重载`render`函数。你必须改变

        ```
        cb = CheckboxInput(final_attrs, check_test=lambda value: value in str_values) 
        ```

        到您的`CheckboxInput`.

    3.  使用您的新小部件而不是内置小部件。

    *注意：部分代码可能会有所不同，因为它们可能取决于 Django 版本*

*   关于问题`User object`：我不确定，但请尝试检查您的`__unicode__`功能。

# sql-server - TSQL：将 XML 嵌套标签提取到列中

> ID：16172432
> 
> 赞同：0
> 
> 时间：2013-04-23T14:47:38.537
> 
> 标签：sql-server, xml, tsql

**使用 SQLServer2008R2**

我目前在 XML 标签内（不在它们之间）有带有数据的 XML 标签，例如：

```
<zooid="1"><animals key="all" zebras="22" dogs="0" birds="4" /><animals key="all" workers="yes" vacation="occasion" /> ... *(more)*</zooid>
<zooid="2"><animals key="house" zebras="0" dogs="1" birds="2" /><animals key="house" workers="no" vacation="no" /> ... *(more)*</zoodid> 
```

如果我查询 XML 或对它使用 value 函数，它会返回空白值，因为它试图在标签之间读取 - 其中不存在任何值。我需要它来读取标签*内部*，将等号之前的值解析为列，将引号之间的值解析为这些列中的值（当然，我可以创建一个可以执行此操作的函数，但这会非常细致，我很好奇这样的东西是否已经存在）。**在列**中应该是这样的：

```
Key | Zebras | Dogs | Birds | Key | Workers | Vacation | ... *(more)* 
```

...这在**数据行中**：

```
all   | 22 | 0 | 4 | all   | yes | occasion | ... *(more)*
house | 0  | 1 | 2 | house | no  | no       | ... *(more)* 
```

所以最终的输出（现在只使用从头开始的两个 XML 行），看起来像下面的表格形式的数据：

```
Key   | Zebras | Dogs | Birds | Key    | Workers | Vacation | ... *(more)*
================================================================
all   | 22     | 0    | 4     | all   | yes     | occasion | ... *(more)*
house | 0      | 1    | 2     | house | no      | no       | ... *(more)* 
```

除了查询 XML、使用该`.query`工具甚至尝试该`.node`工具（使用`CROSS APPLY`见此[线程](https://stackoverflow.com/questions/15115232/query-xml-field-with-t-sql)）之外，我无法生成它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:02:10.640

您的 xml 似乎无效。你怎么能指定这样的元素：？一般xml结构是<(elementName) (Attribute)="(Value)"/>。除非我弄错了，如果您以这种方式将文本转换为 xml，它将失败。说我可以在一个将在 SQL 管理 Studio 中按原样运行的自提取示例中展示一个正确 xml 的工作示例。

```
declare @text1 varchar(max) = '<zooid="1"><animals="all" zebras="22" dogs="0" birds="4" /><animals="all" workers="yes" vacation="occasion" /></zooid>'
,   @text2 varchar(max) = '<a zooid="1"><b animals="all" zebras="22" dogs="0" birds="4" /><b animals="all" workers="yes" vacation="occasion" /></a>'
,   @xml xml
;

begin try 
    set @xml = cast(@text1 as xml)
end try
begin catch
    set @xml = '<ElementName Attribute="BadData Elements are not named" />'
end catch 

select @xml

begin try 
    set @xml = cast(@text2 as xml)
end try
begin catch
    set @xml = '<ElementName Attribute="BadData" />'
end catch 

select  
    @xml.value('(/a/b/@animals)[1]', 'varchar(20)') as AnimalsValue
,   @xml.value('(/a/b/@zebras)[1]', 'int') as ZebrasValue
,   @xml.value('(/a/b/@dogs)[1]', 'int') as DogsValue
,   @xml.value('(/a/b/@birds)[1]', 'int') as BirdsValue
,   @xml.value('(/a/b/@workers)[1]', 'varchar(16)') as Workers
,   @xml.value('(/a/b/@vacation)[1]', 'varchar(16)') as Vacation 
```

'.value' 方法是一种用于在 SQL 中查询 xml 的语法。我基本上是在找到元素（我做了包含 b 的 a 的泛型）。然后在我想要的级别上，“@animals”代表“名称动物的属性”。[1] 是一个位置，因为我一次只能返回一个东西，所以我选择了第一个位置。然后它需要一个数据类型来返回。文本是 varchar，数字是整数。

XML 查询方法：http: [//msdn.microsoft.com/en-us/library/ms190798.aspx](http://msdn.microsoft.com/en-us/library/ms190798.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T05:50:46.160

试试这个——

```
DECLARE @YourXML NVARCHAR(MAX)
SELECT @YourXML = '
    <zooid="1">
        <animals key="all" zebras="22" dogs="0" birds="4" />
        <animals key="all" workers="yes" vacation="occasion" />
    </zooid>
    <zooid="2">
        <animals key="house" zebras="0" dogs="1" birds="2" />
        <animals key="house" workers="no" vacation="no" />
    </zoodid>'

DECLARE @XML XML
SELECT @XML = 
    REPLACE(
          REPLACE(@YourXML, 'zooid=', 'zooid id=')
        , '</zoodid>'
        , '</zooid>')

SELECT 
      d.[Key]
    , Dogs = MAX(d.Dogs)
    , Zebras = MAX(d.Zebras)
    , Birds = MAX(d.Birds)
    , Workers = MAX(d.Workers)
    , Vacation = MAX(d.Vacation)
FROM (
    SELECT 
          [Key] = t.p.value('./@key', 'NVARCHAR(50)')
        , Zebras = t.p.value('./@zebras', 'INT')
        , Dogs = t.p.value('./@dogs', 'INT')
        , Birds = t.p.value('./@birds', 'INT')
        , Workers = t.p.value('./@workers', 'NVARCHAR(20)')
        , Vacation = t.p.value('./@vacation', 'NVARCHAR(20)')
    FROM @XML.nodes('/zooid/animals') t(p)
) d
GROUP BY d.[Key] 
```

# android - 无法显示进度对话框

> ID：16172433
> 
> 赞同：0
> 
> 时间：2013-04-23T14:47:44.427
> 
> 标签：android, android-asynctask, progressdialog

我正在准备一个应用程序。最初我必须将大量数据放入数据库。为了实现这一点，我使用`AsyncTask`如下：

这是我的java代码：

```
package com.hippieapp;

import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Locale;

import android.app.Activity;
import android.app.ProgressDialog;
import android.content.ContentValues;
import android.content.SharedPreferences;
import android.database.sqlite.SQLiteDatabase;
import android.os.AsyncTask;
import android.os.Bundle;
import android.preference.PreferenceManager;

public class Home extends Activity {

    static SQLiteDatabase database;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_home);

        SharedPreferences prefs = PreferenceManager
                .getDefaultSharedPreferences(this);
        if (!prefs.getBoolean("firstTime", false)) {

            new CheckTypesTask().execute();

            SharedPreferences.Editor editor = prefs.edit();
            editor.putBoolean("firstTime", true);
            editor.commit();
        }
    }

    private void insert_in_questions() {
        // TODO Auto-generated method stub

        loadDatabase();

        String currentDate = new SimpleDateFormat("yyyy/MM/dd").format(Calendar
                .getInstance().getTime());
        ContentValues values = new ContentValues();

        values.put("question",
                "How many inch your hair long reaches past your shoulders ?");
        values.put("ans_type", "textinput");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Are you male ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "For males- Have you gotten flack for having long hair ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "For Females- Have you gotten flack for wearing no makeup ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Are you over the age of 40 and still have not cut your hair ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Do you have a brownie recipe that includes ingredients you can not get at the local A&P ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Is your dwelling is decorated with beads hanging from the door, a lava lamp or fillmore posters ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Do you have a bean bag chair in your \"groovy pad\" ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Does the bean bag chair is the only piece of furniture you have ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Is your home decorated with homemade art ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you do pottery ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you know how to do macrame ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you know how to do the macaroon ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Did you were at Woodstock ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Do you think you may have been at Woodstock, but aren't entirely sure ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Who is your favorite Beatle ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Do you have fire drills to practice getting all your Grateful Dead tapes out of the house ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "How many state line you've crossed on your longest road trip to see a 60s era musical artist or band in concert ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Have you have traveled to another country to see such a band or artist ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Were you were affected personally by Jerry Garcia's death ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you know what bag you're in ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you own an incense burner ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you own, or have owned a VW bus ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Is the bus painted multiple colors ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you play the sitar ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Have you written a song protesting war, bucking the establishment, or containing a reference to illegal drugs ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Have you written songs about all three protesting war, bucking the establishment, or containing a reference to illegal drugs ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Were you actually alive in the 1960s ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Do you really, really wish you had been alive in the 1960s ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you believe that \"All You Need is Love\" ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you believe in good medical plan ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Does the word \"trip\" not make you think of a vacation ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Does the word \"man\" peppers your conversations ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Have you used the word \"groovy\" or the phrase \"Can you dig it ?\" with a straight face?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Have you used words \"groovy\" and the phrase \"Can you dig it ?\" both in the same sentence ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Have you taken part in a peace march ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Have you started a petition ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Have you taken part in a sit-in ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Have you \"taken part in a peace march\", \"started a petition\" and \"taken part in a sit-in\" all three ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Have you ever received junk mail addressed to \"dear radical\" ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Do you think \"social action\" is a frat party on a saturday night ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Have your children names like Windsong, Freedom or Peace Love Understanding Smith ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Do you wish your parents had named you Peace Love Understanding Smith ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Do you say \"thank you\" when someone calls you a hippy ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Do you say \"Groovy man, like, you think I'm a hippy? Far out, can you dig that?\"");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you wear Birkenstocks ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you make your own sandals ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Do you have a bumper sticker reading \"save the whales\", \"think green\" or has dancing bears on it ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Does bumper stickers like \"save the whales\", \"think green\" or has dancing bears on it; are holding your car together ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Are you a vegetarian ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Does the only reason you call yourself a \"vegetarian\" is that you stopped eating Big Macs ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you smell like patchouli ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Have you have sold any hand-made item in the parking lot of a concert ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you think money is the root of all evil ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Do you add the phrase \"and may the devil smite me with it\" ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Do you think Jim Morrison's poetry is profound ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you think John Lennon's drawings are art ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you like Bob Dylan's singing voice ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Have you ever heard of Jim Morrison, John Lennon or Bob Dylan?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Do you have a necklace with either wooden beads, seeds, a peace or yin yang symbol ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Do you have \"wooden beads\", \"seeds\" and \"a peace or yin yang symbol\" all together ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Did you use to have \"wooden beads\", \"seeds\" and \"a peace or yin yang symbol\" all of the three but you gave them away or traded them for concert tickets");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Does your computer screen name or password is related to a 60s musical performer ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Are the only CDs or records in your collection that were recorded after 1980 were recorded by artists who were most famous in the 60s or 70s ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Have you been to San Francisco ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Have you wore flowers in your hair ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Have you lived in a commune ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Have you quit the commune because you were tired of being the one to do all the work ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you own a tie dyed article of clothing ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Did you dye article of clothing yourself ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question", "Do you own any clothing items made of hemp ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Have you practiced Transcendental Meditation, have seriously studied Eastern religion, or been a Jesus freak ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put(
                "question",
                "Have you done \"practiced Transcendental Meditation\", \"have seriously studied Eastern religion\", and \"been a Jesus freak\" all of the these ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();

        values.put("question",
                "Have you had a chemically induced spiritual experience ?");
        values.put("ans_type", "yesno");
        values.put("creation_date", currentDate);
        values.put("is_delete", "0");
        values.put("is_publish", "1");
        database.insert("questions", null, values);
        values.clear();
      .
      .
      .

    }

    private void create_database_and_tables() {
        // TODO Auto-generated method stub

        database = openOrCreateDatabase("HippieDatabase.db",
                SQLiteDatabase.CREATE_IF_NECESSARY, null);
        database.setLocale(Locale.getDefault());
        database.setVersion(1);

        String create_table_questions = "create table if not exists questions (q_id INTEGER PRIMARY KEY AUTOINCREMENT, "
                + "question TEXT, "
                + "ans_type TEXT, "
                + "creation_date TEXT, "
                + "is_delete INTEGER, "
                + "is_publish INTEGER);";
        database.execSQL(create_table_questions);

        String create_table_answer_option = "create table if not exists answer_option (ao_id INTEGER PRIMARY KEY AUTOINCREMENT, "
                + "q_id INTEGER, "
                + "ans_option TEXT, "
                + "ans_point INTEGER, "
                + "is_delete INTEGER, "
                + "is_publish INTEGER);";
        database.execSQL(create_table_answer_option);
    }

    private void loadDatabase() {

        database = openOrCreateDatabase("HippieDatabase.db",
                SQLiteDatabase.OPEN_READWRITE, null);
    }

    class CheckTypesTask extends AsyncTask<Void, Void, Void> {

        ProgressDialog Asycdialog = new ProgressDialog(Home.this);
        String typeStatus;

        @Override
        protected void onPreExecute() {

            Asycdialog.setMessage("First time initialization. Please wait...");
            Asycdialog.show();
            super.onPreExecute();
        }

        @Override
        protected Void doInBackground(Void... arg0) {

            create_database_and_tables();

            insert_in_questions();

//          insert_in_answer_option();

            return null;
        }

        @Override
        protected void onPostExecute(Void result) {

            database.close();
            Asycdialog.dismiss();

            super.onPostExecute(result);
        }
    }

//  public void insert_in_answer_option() {
//      // TODO Auto-generated method stub
//      
//      
//  }
} 
```

如您所见，我在数据库中完成了 76 个条目，但我仍然无法查看`ProgressDialog`. 在第一次运行应用程序时还有更多数据要插入。

谁能告诉我为什么？代码有什么问题，还是数据不够大，无法显示`ProgressDialog`？请帮我。这是我第一次与`AsyncTask`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:50:30.310

`super.onPreExecute()`必须是 on`onPreExecute`方法中的第一条指令

# spring - 未从 PropertyEditorSupport 调用 ControllerAdvice ExceptionHandler

> ID：16172437
> 
> 赞同：1
> 
> 时间：2013-04-23T14:48:01.220
> 
> 标签：spring, spring-mvc, exception-handling

我正在使用 Spring 3.2.1 并且有一个`PropertyEditorSupport`强制参数我想自动转换为大写的枚举，以便它转换错误大小写的参数。如果`IllegalArgumentException`参数 String 无法转换为枚举，则可以抛出一个。我的问题是状态码在应该是 400 时返回为 500。我创建了一个`ResponseEntityExceptionHandler`带有注释`@ControllerAdvice`的方法和一个方法 annotated `@ExceptionHandler (IllegalArgumentException.class)`，打算在那里设置状态码，但是当抛出异常时该方法永远不会被调用。为什么不？和这里讨论的问题一样吗，[MaxUploadSizeExceededException 没有调用 Spring 中的异常处理方法](https://stackoverflow.com/questions/14298265/maxuploadsizeexceededexception-doesnt-invoke-the-exception-handling-method-in-s)？IE

> “...在请求到达调度程序 servlet 之前引发异常。因此，您的异常处理程序不会被调用，因为在引发异常时目标控制器尚未确定。”

如果是这样，我怎样才能返回正确的状态码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T14:45:14.020

精简版：

将`@ExceptionHandler(Exception)`带注释的方法放在`@Controller`类中。

* * *

更长的版本：

我注意到类中的带`@ExceptionHandler(XxxException.class)`注释的方法只有在“在”使用 match 输入方法之后`@ControllerAdvice`才会被调用。`XxxException``@RequestMapping`

`MaxUploadSizeExceededException`和之类的条件`MethodArgumentNotValidException`会导致 SpringMVC 不进入`@RequestMapping`方法，因此不应用建议。

我的解决方案是遗憾地将`@ExceptionHandler(XxxException.class)`带注释的方法放在实际的控制器类中。不好但有效。

希望这可以帮助。如果有人知道更好的解决方案（使用时`@ControllerAdvice`），请分享。

# windows-7 - 将命令的返回值存储到 bat 文件中的变量中

> ID：16172438
> 
> 赞同：0
> 
> 时间：2013-04-23T14:48:04.257
> 
> 标签：windows-7, batch-file

我有一个程序，我在其中获取 IP 列表，对它们运行 nslookup，然后将它们存储到两个不同的文件中，一个包含 IP，一个仅包含 nslookup 的输出。要将对 nslookup 的调用减半，我想调用一次，将其存储在变量中，然后写入两个文件。但是，一个简单的商店是行不通的。

```
set val=nslookup %ip% 
```

显示

```
nslookup 127.0.0.1 
```

而不是运行它的结果。

我找到了一种方法来做到这一点

```
nslookup %ip% | find "Name"> tempFile
set /P result=<tempFile 
```

但我现在正在写入文件，然后取回值。对于这个成本，我还不如调用 nslookup 两次。它还需要我选择一条线（这一次对我来说很好，但在其他情况下它可能不起作用）。

我也尝试过使用 for 循环技巧

```
for /f "delims=" %%a in ('nslookup %ip% ^| find "Name"') do set name=%%a 
```

但这只会返回最后一行或我用 find 指定的一行。仍然比前面的示例更好，因为没有临时文件，但仍然不完美。

所以我的问题是，是否有更好的方法将命令的返回值存储到变量中。

编辑：考虑

```
nslookup 127.0.0.1 
```

返回

```
Server: fake.com
Address:  0.0.0.0

Name:  localhost
Address:  127.0.0.1 
```

现在，我想要的只是名称，因此返回一行适用于我当前的批处理文件。但是如果我还需要知道服务器怎么办，所以我想要

```
for /f "delims=" %%a in ('nslookup 127.0.0.1') do set returnVal=%%a
echo %returnVal% 
```

显示

```
Server: fake.com
Address:  0.0.0.0

Name:  localhost
Address:  127.0.0.1 
```

现在它只显示在哪里

```
Address:  127.0.0.1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:37:50.350

下面的批处理文件将 nslookup 显示的四个非空行存储在一个包含四个元素的*数组中：*

```
@echo off
setlocal EnableDelayedExpansion
set n=0
for /f "delims=" %%a in ('nslookup 127.0.0.1') do (
   set /A n+=1
   set returnVal[!n!]=%%a
)

rem To show all non-empty lines:
for /L %%i in (1,1,%n%) do echo !returnVal[%%i]!

rem Or:
echo Line with Name: %returnVal[3]% 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:06:51.647

尝试：

```
 @echo off
 setlocal
 for /f "usebackq tokens=1,2 delims=:" %%a in (`nslookup %ip%`) do echo %%a:%%b 
```

# javascript - 使用 .html() 后 jquery 脚本不起作用

> ID：16172439
> 
> 赞同：1
> 
> 时间：2013-04-23T14:48:05.080
> 
> 标签：javascript, jquery, html

当我使用 .html() 放置数据时，jQuery 脚本不适用于新数据。代码是这样的：

```
<html>
<head>
<script>
$(document).ready(function(){
    $("#newhtml").on("click", function(){
        alert("I'm the NEW one!");
    });
    $("#put_new").on("click", function(){
        $("#newdiv").html("<input type = 'button' id = 'newhtml' value = 'click on me'/>");
    });
});
</script>
</head>
<body>
<div id="newdiv"></div>
<input type="button" id="put_new" value="put new html" />
</body>
</html> 
```

这是一个简单的示例，但我要放置更多数据，并且我希望新元素以这种方式与脚本一起使用。我试图在 stackoverflow.com 上搜索，但没有找到任何适用的。太感谢了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T14:49:37.050

那是因为在执行当前`.on()`语句时，该元素`#newhtml`不存在。

将您的事件绑定更改为：

```
$(document).on('click', '#newhtml', function(){
    alert("I'm the NEW one!");
}); 
```

您调用的主要元素在调用`on()`时必须存在。在第二个参数中，您可以为绑定时可能不存在的元素指定选择器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T14:51:02.393

使用这个：- [http://jsfiddle.net/FQjUZ/](http://jsfiddle.net/FQjUZ/)

```
 $("#newdiv").on("click", "#newhtml", function(){
        alert("I'm the NEW one!");
    });
    $("#put_new").on("click", function(){
        $("#newdiv").html("<input type = 'button' id = 'newhtml' value = 'click on me'/>");
    }); 
```

原因是，对于*稍后将元素添加到 DOM 的*这种功能，您需要使用委托事件处理程序，而不仅仅是绑定。

**事件处理程序仅绑定到当前选定的元素；在您的代码调用时，它们必须存在于页面上`[.on()](http://api.jquery.com/on/).`**

> 委托事件的优点是它们可以处理来自以后添加到文档的后代元素的事件。通过选择在附加委托事件处理程序时保证存在的元素，您可以使用委托事件来避免频繁附加和删除事件处理程序的需要。例如，该元素可以是模型-视图-控制器设计中视图的容器元素，或者如果事件处理程序想要监视文档中的所有冒泡事件，则可以是文档。在加载任何其他 HTML 之前，文档元素在文档头部是可用的，因此在此处附加事件是安全的，而无需等待文档准备好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T14:51:30.490

newHtml 上的事件将不起作用，因为您在将节点添加到 DOM 之前附加了事件，因此为了使其工作，您需要在调用 html 方法后实现您的事件。

```
 $(document).ready(function(){
    $("#put_new").on("click", function(){
      $("#newdiv").html("<input type = 'button' id = 'newhtml' value = 'click on me'/>");
      $("#newhtml").on("click", function(){
           alert("I'm the NEW one!");
       });
   });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:07:10.537

尝试这样的事情。

```
var f00 = "doStuff()";

$("#newdiv").html('<input type="button" id="newhtml" value="click on me" onclick="' + f00 + '"/>');

function doStuff() {
    //stuff
} 
```

# c++ - Differences using std::string in C++ Builder and VC++

> ID：16172444
> 
> 赞同：0
> 
> 时间：2013-04-23T14:48:20.427
> 
> 标签：c++, visual-studio-2010, c++builder

since I can get hands on the new RAD Studio Xe4 I thought I'd give it a try. Unfortunatly, I am not so experienced with C++ and therefore I was wondering why the Code that works perfectly fine in VC++ doesn't work at all in C++ Builder. Most of the problems are converting different var-types. For example :

```
std::string Test = " ";
GetFileAttributes(Test.c_str()); 
```

works in VC++ but in C++ Builder it won't compile, telling me "E2034 Cannot convert 'const char *' to 'wchar_t *'. Am I missing something? What is the reason that doesn't work the same on all compilers the same? Thanks

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T14:51:07.870

Welcome to Windows Unicode/ASCII hell.

The function

```
GetFileAttributes 
```

is actually a macro defined to either `GetFileAttributesA` or `GetFileAttributesW` depending on if you have `_UNICODE` (or was it `UNICODE`, or both?) defined when you include the Windows headers. The `*A` variants take `char*` and related arguments, the `*W` functions take `wchar_t*` and related arguments.

I suggest calling only the wide `*W` variants directly in new code. This would mean switching to std::wstring for Windows only code and some well-thought out design choices for a cross-platform application.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:52:04.590

Your C++ Builder config is set to use UNICODE character set, which means that Win32 APIs are resolved to their wide character versions. Therefore you need to use wide char strings in your C++ code. If you would set your VS config to use UNICODE, you would get the same error.

You can try this:

```
// wstring = basic_string<wchar_t>
// _T macro ensures that the specified literal is a wide char literal
std::wstring Test = _T(" ");     
GetFileAttributes(Test.c_str()); // c_str now returns const wchar_t*, not const char* 
```

See more details about _T/_TEXT macros here: [http://docwiki.embarcadero.com/RADStudio/XE3/en/TCHAR_Mapping](http://docwiki.embarcadero.com/RADStudio/XE3/en/TCHAR_Mapping)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T14:52:04.697

You have defined `_UNICODE` and/or `UNICODE` in Builder and not defined it in VC.

Most Windows APIs come in 2 flavours the ANSI flavour and the UNICODE flavour.

For, when you call `SetWindowText`, there really is no `SetWindowText` functions. Instead there are 2 different functions - `SetWindowTextA` which takes an ANSI string and - `SetWindowTextW` which takes a UNICODE string.

If your program is compiled with /DUNICODE /D_UNICODE, `SetWindowText` maps to SetWindowTextW`which expects a`const wchar_t *`.

If your program is compiled without these macros defined, it maps to `SetWindowTextA` which takes a `const char *`.

The windows headers typically do something like this to make this happen.

```
#ifdef UNICODE
#define SetWindowText  SetWindowTextW
#else
#define SetWindowText  SetWindowTextA
#endif 
```

Likewise, there are 2 `GetFileAttributes`.

```
DWORD WINAPI GetFileAttributesA(LPCSTR lpFileName);

DWORD WINAPI GetFileAttributesW(LPCWSTR lpFileName); 
```

In VC, you haven't defined UNICODE/_UNICODE & hence you are able to pass `string::c_str()` which returns a `char *`.

In Builder, you probably have defined UNICODE/_UNICODE & it expects a `wchar_t *`.

You may not have done this UNICODE/_UNICODE thing explicitly - may be the IDE is doing it for you - so check the options in the IDE.

You have many ways of fixing this

*   find the UNICODE/_UNICODE option in the IDE and disable it.

or

*   use `std::w_string` - then `c_str()` will return a `wchar_t *`

or

*   Call `GetFileAttributesA` directly instead of `GetFileAttributes` - you will need to do this for every other Windows API which comes with these 2 variants.

# c# - 如何将实体框架 DbContext 注入 SharpRepository 的 ConfigurationBasedRepository

> ID：16172448
> 
> 赞同：20
> 
> 时间：2013-04-23T14:48:27.910
> 
> 标签：c#, entity-framework, repository, ninject, sharp-repository

我真的很想将[SharpRepository](https://github.com/SharpRepository/SharpRepository)与[Ninject](http://www.ninject.org)一起使用，但我不明白如何配置 Ninject 以在存储库之间共享 Entity Framework DbContext。

我正在使用实体框架版本 5 和 Ninject 版本 3。

目前我`Ef5Repository`在我的源代码中使用，但我想用`ConfigurationBasedRepository`. 但我无法弄清楚如何将 EF 传递（或注入）`DbContext`到存储库。

**示例（当前状态）：**

```
using SharpRepository.Repository;

public interface IProductRepository : IRepository<Product>
{
}

using SharpRepository.Ef5Repository;
using System.Data.Entity;

// TODO Tightly coupled to Ef5Repository.
public class ProductRepository : Ef5Repository<Product>, IProductRepository
{
    // TODO The DbContext has to be injected manually.
    public ProductRepository(DbContext context) : base(context)
    {
    }

    // [...]
} 
```

**目标：**

```
using SharpRepository.Repository;

public interface IProductRepository : IRepository<Product>
{
}

public class ProductRepository : ConfigurationBasedRepository<Product, int>, IProductRepository
{
    // [...]
} 
```

我已经阅读了两篇博客文章[SharpRepository: Getting Started](http://fairwaytech.com/2012/12/sharprepository-getting-started)和[SharpRepository: Configuration](http://fairwaytech.com/2013/02/sharprepository-configuration)，但它们都对我没有帮助，因为：

1.  使用的 DIC 是 StructureMap，而不是 Ninject。
2.  源代码示例不完整（例如使用未声明的变量）。

所以我的问题：有人可以为我提供一些源代码示例如何实现上述目标（`DbContext`在所有扩展的存储库之间共享一个实体框架实例`ConfigurationBasedRepository`）吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-23T16:15:30.320

首先，您需要安装[SharpRepository.Ioc.Ninject NuGet 包](http://nuget.org/packages/SharpRepository.Ioc.Ninject/)。这里有一些扩展方法用于连接 Ninject 以处理加载通用存储库并设置 SharpRepository 使用的依赖解析器。

无论您在哪里设置 Ninject 绑定规则（所有对 kernel.Bind<> 的调用），您都需要添加：

```
kernel.BindSharpRepository(); 
```

接下来，在您的 Global.asax、App_Start 代码或 Bootstrapper 逻辑（无论您在哪里调用应用程序启动代码）中，您需要添加以下内容：

```
// kernel is the specific kernel that you are setting up all the binding for
RepositoryDependencyResolver.SetDependencyResolver(new NinjectDependencyResolver(kernel)); 
```

这将告诉 SharpRepository 在获取新的 DbContext 时使用此 Ninject Kernel。

最后要做的是为 DbContext 本身设置绑定规则。如果您在 Web 应用程序中，您很可能希望 DbContext 的范围是每个请求。我个人不使用 Ninject，但我找到了使用[InRequestScope](https://github.com/ninject/Ninject.Web.Common/wiki/InRequestScope)的参考。我相信你的代码看起来像这样：

```
kernel.Bind<DbContext>().To<MyCustomEfContext>().InRequestScope().WithConstructorArgument("connectionString", ConfigurationManager.ConnectionStrings["MyCustomEfContext"].ConnectionString); 
```

大多数人不需要下一部分，但如果您的 CustomEfContext 中有自定义逻辑（例如，我有一个用于登录 SaveChanges() 调用的覆盖），那么您需要在配置文件中定义您的自定义上下文类型像这样：

```
<repositories>
  <repository name="ef5Repository" connectionString="CustomEfContext" cachingStrategy="standardCachingStrategy" dbContextType="My.Data.CustomEfContext, My.Data" factory="SharpRepository.Ef5Repository.Ef5ConfigRepositoryFactory, SharpRepository.Ef5Repository" />
</repositories> 
```

其中 dbContextType 使用完整类型命名空间语法定义您正在使用的自定义 DbContext 的类型。如果这样做，则需要通过将 .Bind<DbContext>() 更改为 .Bind<CustomEfContext>()，将 Ninject 设置为在自定义上下文中绑定。但就像我通常所说的那样，您可以直接使用 DbContext 而不会出现问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-25T09:41:01.250

首先，Jeff T 在答案中提供的解决方案有效！

我将总结我为使[Ninject](http://ninject.org)在 ASP.NET MVC 4 + EF 5 项目中工作所采取的步骤。值得一提的是，在以下示例中，*特定存储库*模式是通过[SharpRepository实现的。](https://github.com/SharpRepository/SharpRepository)

* * *

# 所需软件

1.  [通过NuGet](http://nuget.org)安装[Ninject](http://ninject.org)和“Ninject.MVC3”（也安装“Ninject.Web.Common”）。
2.  [通过NuGet](http://nuget.org)安装[SharpRepository](https://github.com/SharpRepository/SharpRepository)、“SharpRepository for EF5”和“SharpRepository with Ninject IOC” 。

# 定义*存储库*层

1.  创建一个[DbContext 派生类](http://msdn.microsoft.com/jj729737)，例如`Domain.EfContext`。它是

    > “推荐的使用上下文的方式”。

    *   将所有必需的声明`DbSet<T>`为公共属性，例如`public DbSet<Product> Products { get; set; }`
    *   ~~在类中声明以下两个构造函数`Domain.EfContext`：~~

         ~~```
        public EfContext() : base() {}
        public EfContext(string connectionName) : base(connectionName) {} 
        ```~~ 

~~*   *为特定存储库*定义一个接口，例如：

    ```
    // TODO By extending IRepository, the interface implements default Create-Read-Update-Delete (CRUD) logic.
    // We can use "traits" to make the repository more "specific", e.g. via extending "ICanInsert".
    // https://github.com/SharpRepository/SharpRepository/blob/master/SharpRepository.Samples/HowToUseTraits.cs
    public interface IProjectRepository : IRepository<Project>
    {
        // TODO Add domain specific logic here.
    } 
    ```

    *   定义一个实现*特定存储库*并继承自的类`SharpRepository.Repository.ConfigurationBasedRepository<T, TKey>`，例如：

    ```
    public class ProductRepository : ConfigurationBasedRepository<Product, int>, IProductRepository
    {
        // TODO Implement domain specific logic here.
    } 
    ```~~ 

 ~~# 定义*消费者*层

1.  创建一个控制器，例如`Controllers.ProductController`.

    ```
    public class ProductController : Controller
    {
        private IProductRepository Repository { get; private set; }

        // TODO Will be used by the DiC.
        public ProductController(IProductRepository repository)
        {
            this.Repository = repository;
        }
    } 
    ```

# 通过依赖注入容器 (DiC) Ninject 设置依赖注入 (DI)

该文件`App_Start/NinjectWebCommon.cs`由 Ninject.Web.Common 自动创建，我们可以`RegisterServices(IKernel kernel) : void`在类的方法中加载我们的模块并注册我们的服务`NinjectWebCommon`。以下是该示例方法的完整源代码：

```
 private static void RegisterServices(IKernel kernel)
    {
        kernel.BindSharpRepository();
        RepositoryDependencyResolver.SetDependencyResolver(
            new NinjectDependencyResolver(kernel)
        );

        string connectionString = ConfigurationManager.ConnectionStrings["EfContext"].ConnectionString;
        kernel.Bind<DbContext>()
            .To<EfContext>()
            .InRequestScope()
            .WithConstructorArgument("connectionString", connectionString);

        kernel.Bind<IProductRepository>().To<ProductRepository>();
    } 
```

在 中定义以下`sharpRepository`部分`Web.config`：

```
 <sharpRepository>
        <repositories default="ef5Repository">
            <repository name="ef5Repository"
                connectionString="EfContext"
                cachingStrategy="standardCachingStrategy"
                dbContextType="Domain.EfContext, Domain"
                factory="SharpRepository.Ef5Repository.Ef5ConfigRepositoryFactory, SharpRepository.Ef5Repository"
            />
        </repositories>
    </sharpRepository> 
```

此外，`connectionStrings`使示例完整的部分（我使用的是 SQL Server LocalDB）。

```
 <connectionStrings>
        <add name="EfContext" providerName="System.Data.SqlClient" connectionString="Data Source=(localdb)\v11.0;Initial Catalog=Domain;Integrated Security=True" />
    </connectionStrings> 
```

* * *

我希望这个结论可以帮助其他人将 ASP.NET MVC 4 与 Entity Framework 5 和 SharpRepository 一起启动并运行！

如果我采取了一个或多个不必要的步骤，或者如果您看到改进示例中描述的架构的可能性，请给我回复。

~~顺便说一句，我**必须**将`dbContextType`属性添加到该`repository`部分以使其工作（与 Jeff T 的答案相反）。~~

* * *

**编辑（2013-08-28）：**删除了不必要的步骤（最新版本的 SharpRepository 不需要）。~~

# python - 将 django 项目编译为桌面应用程序

> ID：16172451
> 
> 赞同：8
> 
> 时间：2013-04-23T14:48:30.800
> 
> 标签：python, django

我有一个 Web 应用程序，我想在桌面上有一个版本。如果我可以编译它而不是重写它，那将是非常棒的。（很遗憾，我不能给客户代码）

我做了一些研究，发现了一些一般编译 python 的解决方案。这些解决方案是：

*   cx_freeze
*   py2exe
*   pyinstaller（这个声称它支持 django 但仍未发布）
*   dbuilder.py

该桌面应用程序将主要在 Windows 上运行，但如果我能找到一个解决方案，使其也能在 Linux 和 Mac 上运行，那就太好了。

有没有人设法正确地做到这一点？如果是这样，你能指出我正确的方向吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T23:05:25.743

是的，我在 OSX 上这样做。这并不简单，据我所知，我可能是第一个在 OSX 上成功完成它的人，所以 YMMV。

Pyinstaller，截至 3 月，还没有为 Django 支持做好准备。当我尝试使用它来打包我的应用程序时，我已经提交了几张票，但我承认我还没有解决这些问题。

最终，我选择了 py2app，因为我之前在其他应用程序中使用过它。我用 py2app 和 Django 制作了一个示例项目并将其[放在 Github 上](https://github.com/kevinlondon/django-py2app-demo)。您可能会发现它很有用。我还链接了一些我在此过程中发现有用的页面，如下所示：

[https://groups.google.com/forum/?fromgroups=#!topic/django-users/-VGqvHew35g](https://groups.google.com/forum/?fromgroups=#!topic/django-users/-VGqvHew35g)

[http://misunderstandings.wordpress.com/2008/06/26/django-desktop-app/](http://misunderstandings.wordpress.com/2008/06/26/django-desktop-app/)

[https://bitbucket.org/Lawouach/cherrypy-recipes/src/9c35b4b62ef1/frameworks/django_?at=default](https://bitbucket.org/Lawouach/cherrypy-recipes/src/9c35b4b62ef1/frameworks/django_?at=default)

如果我必须再做一次，我可能会使用 SQLAlchemy 和 wxPython 或 PySide。我建议仔细考虑使用 Django 作为打包应用程序想要实现的目标，因为它引入了很多复杂性。

# sql-server - 只能从 isql 发出一条 sql 语句

> ID：16172454
> 
> 赞同：0
> 
> 时间：2013-04-23T14:48:47.150
> 
> 标签：sql-server, odbc, freetds, isql

我正在运行 Debian，打开与网络上 MSSQL 数据库的 ODBC 连接。当我运行 isql 时，我可以很好地发出一条 sql 语句。如果我第二次发出相同的请求，它将返回 0 行。如果我第三次运行相同的命令，连接最终会退出，我必须关闭当前会话并启动一个新的 isql。前两个请求在我的日志中看起来不错，尽管第二个请求总是返回 0 行，但第三个请求因服务器的 EOF 而失败。

> ODBC][3270][1366728023.855922][SQLExecute.c][344] 退出：[SQL_ERROR] DIAG [01000] [FreeTDS][SQL Server]来自服务器的意外 EOF

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:31:54.830

编辑：实际上我记得我现在将 freeTDS 更新为 0.91 并手动编译它们，这似乎解决了我的问题，同时确保我的 MSSQL 版本具有正确的 tds 版本。似乎对于 2008 年，您应该选择 8.0 作为所选版本。不过，这似乎没有在 freetds 页面上的任何地方记录。

我不知道我做了什么，但经过两天的斗争，现在一切正常。我所做的只是再次打开我的配置文件（freetds.conf、odbcinst.ini、odbc.ini）进行保存然后关闭它们。不像我没有做过一百万次试图解决我的问题，但在那之后，现在一切都在完美地工作。我什至可以执行 select * ，这在 isql 处理第一个查询而不是后续查询时无法做到。

# android - 在应用程序上下文中获取移动状态

> ID：16172457
> 
> 赞同：1
> 
> 时间：2013-04-23T14:48:49.900
> 
> 标签：android

我想知道我在启动我的应用程序时是否有移动网络：

```
final ConnectivityManager connMgr = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
final android.net.NetworkInfo mobileInfo = connMgr.getNetworkInfo(ConnectivityManager.TYPE_MOBILE); 
```

在我的开始应用程序类中：

```
public class StartApplication extends Application { 
```

我遇到了一些错误：

```
04-23 14:41:36.683: E/AndroidRuntime(1280): FATAL EXCEPTION: main
04-23 14:41:36.683: E/AndroidRuntime(1280): java.lang.RuntimeException: Unable to instantiate application com.chipsat.sigue.StartApplication: java.lang.NullPointerException
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.app.LoadedApk.makeApplication(LoadedApk.java:504)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.app.ActivityThread.handleBindApplication(ActivityThread.java:4364)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.app.ActivityThread.access$1300(ActivityThread.java:141)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1294)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.os.Looper.loop(Looper.java:137)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at java.lang.reflect.Method.invokeNative(Native Method)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at java.lang.reflect.Method.invoke(Method.java:511)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at dalvik.system.NativeStart.main(Native Method)
04-23 14:41:36.683: E/AndroidRuntime(1280): Caused by: java.lang.NullPointerException
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.content.ContextWrapper.getSystemService(ContextWrapper.java:495)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at com.chipsat.sigue.StartApplication.<init>(StartApplication.java:82)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at java.lang.Class.newInstanceImpl(Native Method)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at java.lang.Class.newInstance(Class.java:1319)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.app.Instrumentation.newApplication(Instrumentation.java:983)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.app.Instrumentation.newApplication(Instrumentation.java:968)
04-23 14:41:36.683: E/AndroidRuntime(1280):     at android.app.LoadedApk.makeApplication(LoadedApk.java:499)
04-23 14:41:36.683: E/AndroidRuntime(1280):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:20:22.963

I guess the problem is you call getSystemService before onCreate. You can check [Exception on getSystemService(Context.AUDIO_SERVICE)](https://stackoverflow.com/questions/4422866/exception-on-getsystemservicecontext-audio-service) and [System services not available to Activities before onCreate?](https://stackoverflow.com/questions/5905587/system-services-not-available-to-activities-before-oncreate). Basically, the Context is not available yet when you use it.

Edit: I'm not 100% sure but you can try:

```
ConnectivityManager connMgr;
android.net.NetworkInfo mobileInfo

//in onCreate
connMgr = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
mobileInfo = connMgr.getNetworkInfo(ConnectivityManager.TYPE_MOBILE); 
```

Note: the code is not tested.

# vba - 我希望 msgBox 显示单元格的定义名称，而不是 2010 年的单元格地址

> ID：16172460
> 
> 赞同：0
> 
> 时间：2013-04-23T14:48:57.240
> 
> 标签：vba, excel-2010

我正在使用下面的代码来验证单元格在保存工作簿之前是否具有信息。该程序运行良好，但显示单元格地址（$P$14）。我希望它显示单元格定义的名称（CompanyName）。

```
For Each myRange In .Range("P14,P20,P23,P26,P29,P32,P33,P39")

    If myRange.Value = 0 And myRange.Offset(0, 0) = "" Then

        MsgBox ("You must make an entry in ") & myRange.Offset(0, 0).Address

        Cancel = True

    End If

Next myRange 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:14:54.557

如果您的意思是单元格的定义名称是您添加文本的列中的第一行（即“A1”、“B1”等）（例如您提到的“公司名称”），您可以这样做：
`Target.Worksheet.Cells(1, Target.Column).Value`

如果您指的是特定单元格的“给定名称”，即从（例如）“A1”重命名为“uncleFOO”，那么您必须参考
`[object].Name.Name`
例如，`myRange.Offset(0, 0).Name.Name`。

希望这可以帮助！

# c# - 从 ViewModel 关闭窗口

> ID：16172462
> 
> 赞同：110
> 
> 时间：2013-04-23T14:49:00.043
> 
> 标签：c#, wpf, mvvm

我使用 a 创建登录`window control`以允许用户登录到`WPF`我正在创建的应用程序。

到目前为止，我已经创建了一个方法来检查用户是否在登录屏幕上的a`username`和`password`a中输入了正确的凭据，两个.`textbox``binding``properties`

我通过创建一个`bool`方法来实现这一点，就像这样；

```
public bool CheckLogin()
{
    var user = context.Users.Where(i => i.Username == this.Username).SingleOrDefault();

    if (user == null)
    {
        MessageBox.Show("Unable to Login, incorrect credentials.");
        return false;
    }
    else if (this.Username == user.Username || this.Password.ToString() == user.Password)
    {
        MessageBox.Show("Welcome " + user.Username + ", you have successfully logged in.");

        return true;
    }
    else
    {
        MessageBox.Show("Unable to Login, incorrect credentials.");
        return false;
    }
}

public ICommand ShowLoginCommand
{
    get
    {
        if (this.showLoginCommand == null)
        {
            this.showLoginCommand = new RelayCommand(this.LoginExecute, null);
        }
        return this.showLoginCommand;
    }
}

private void LoginExecute()
{
    this.CheckLogin();
} 
```

我也有一个`command`我`bind`到我的按钮内的`xaml`类似这样的；

```
<Button Name="btnLogin" IsDefault="True" Content="Login" Command="{Binding ShowLoginCommand}" /> 
```

当我输入用户名和密码时，它会执行适当的代码，无论是对还是错。但是，当用户名和密码都正确时，如何从 ViewModel 关闭此窗口？

我之前尝试过使用 a`dialog modal`但效果不佳。此外，在我的 app.xaml 中，我做了类似以下的操作，它首先加载登录页面，然后一旦为真，加载实际的应用程序。

```
private void ApplicationStart(object sender, StartupEventArgs e)
{
    Current.ShutdownMode = ShutdownMode.OnExplicitShutdown;

    var dialog = new UserView();

    if (dialog.ShowDialog() == true)
    {
        var mainWindow = new MainWindow();
        Current.ShutdownMode = ShutdownMode.OnMainWindowClose;
        Current.MainWindow = mainWindow;
        mainWindow.Show();
    }
    else
    {
        MessageBox.Show("Unable to load application.", "Error", MessageBoxButton.OK);
        Current.Shutdown(-1);
    }
} 
```

**问题：如何`Window control`从 ViewModel 关闭登录？**

提前致谢。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2013-04-24T14:56:25.413

您可以使用`CommandParameter`. 请参阅下面的示例。

我已经实现了一个`CloseWindow`将 Windows 作为参数并关闭它的方法。窗口通过 传递给 ViewModel `CommandParameter`。请注意，您需要为`x:Name`应该关闭的窗口定义一个。在我的 XAML 窗口中，我通过调用此方法`Command`并将窗口本身作为参数传递给 ViewModel，使用`CommandParameter`.

```
Command="{Binding CloseWindowCommand, Mode=OneWay}" 
CommandParameter="{Binding ElementName=TestWindow}" 
```

*视图模型*

```
public RelayCommand<Window> CloseWindowCommand { get; private set; }

public MainViewModel()
{
    this.CloseWindowCommand = new RelayCommand<Window>(this.CloseWindow);
}

private void CloseWindow(Window window)
{
    if (window != null)
    {
       window.Close();
    }
} 
```

*看法*

```
<Window x:Class="ClientLibTestTool.ErrorView"
        x:Name="TestWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:localization="clr-namespace:ClientLibTestTool.ViewLanguages"
        DataContext="{Binding Main, Source={StaticResource Locator}}"
        Title="{x:Static localization:localization.HeaderErrorView}"
        Height="600" Width="800"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen">
    <Grid> 
        <Button Content="{x:Static localization:localization.ButtonClose}" 
                Height="30" 
                Width="100" 
                Margin="0,0,10,10" 
                IsCancel="True" 
                VerticalAlignment="Bottom" 
                HorizontalAlignment="Right" 
                Command="{Binding CloseWindowCommand, Mode=OneWay}" 
                CommandParameter="{Binding ElementName=TestWindow}"/>
    </Grid>
</Window> 
```

请注意，我使用的是 MVVM 轻框架，但主体适用于每个 wpf 应用程序。

这个解决方案违反了 MVVM 模式，因为视图模型不应该知道关于 UI 实现的任何事情。如果要严格遵循 MVVM 编程范式，则必须使用接口抽象视图的类型。

**MVVM 符合解决方案**（前 EDIT2）

用户**Crono**在评论部分提到了一个有效点：

> 将 Window 对象传递给视图模型会破坏 MVVM 模式恕我直言，因为它会强制您的 vm 知道正在查看它的内容。

您可以通过引入包含 close 方法的接口来解决此问题。

*界面：*

```
public interface ICloseable
{
    void Close();
} 
```

您重构的 ViewModel 将如下所示：

*视图模型*

```
public RelayCommand<ICloseable> CloseWindowCommand { get; private set; }

public MainViewModel()
{
    this.CloseWindowCommand = new RelayCommand<IClosable>(this.CloseWindow);
}

private void CloseWindow(ICloseable window)
{
    if (window != null)
    {
        window.Close();
    }
} 
```

您必须在视图中引用并实现`ICloseable`接口

*查看（后面的代码）*

```
public partial class MainWindow : Window, ICloseable
{
    public MainWindow()
    {
        InitializeComponent();
    }
} 
```

**回答原问题：（**前EDIT1）

您的登录按钮（添加了 CommandParameter）：

```
<Button Name="btnLogin" IsDefault="True" Content="Login" Command="{Binding ShowLoginCommand}" CommandParameter="{Binding ElementName=LoginWindow}"/> 
```

你的代码：

```
 public RelayCommand<Window> CloseWindowCommand { get; private set; } // the <Window> is important for your solution!

 public MainViewModel() 
 {
     //initialize the CloseWindowCommand. Again, mind the <Window>
     //you don't have to do this in your constructor but it is good practice, thought
     this.CloseWindowCommand = new RelayCommand<Window>(this.CloseWindow);
 }

 public bool CheckLogin(Window loginWindow) //Added loginWindow Parameter
 {
    var user = context.Users.Where(i => i.Username == this.Username).SingleOrDefault();

    if (user == null)
    {
        MessageBox.Show("Unable to Login, incorrect credentials.");
        return false;
    }
    else if (this.Username == user.Username || this.Password.ToString() == user.Password)
    {
        MessageBox.Show("Welcome "+ user.Username + ", you have successfully logged in.");
        this.CloseWindow(loginWindow); //Added call to CloseWindow Method
        return true;
    }
    else
    {
        MessageBox.Show("Unable to Login, incorrect credentials.");
        return false;
    }
 }

 //Added CloseWindow Method
 private void CloseWindow(Window window)
 {
     if (window != null)
     {
         window.Close();
     }
 } 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2013-04-23T15:37:54.873

当我需要这样做时，我通常会在视图模型上放置一个事件，然后`Window.Close()`在将视图模型绑定到窗口时将其连接到

```
public class LoginViewModel
{
    public event EventHandler OnRequestClose;

    private void Login()
    {
        // Login logic here
        OnRequestClose(this, new EventArgs());
    }
} 
```

并且在创建登录窗口时

```
var vm = new LoginViewModel();
var loginWindow = new LoginWindow
{
    DataContext = vm
};
vm.OnRequestClose += (s, e) => loginWindow.Close();

loginWindow.ShowDialog(); 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-04-24T01:49:10.653

保持 MVVM，我认为使用 Blend SDK (System.Windows.Interactivity) 中的行为或 Prism 的自定义交互请求对于这种情况非常有效。

如果走行为路线，这是一般的想法：

```
public class CloseWindowBehavior : Behavior<Window>
{
    public bool CloseTrigger
    {
        get { return (bool)GetValue(CloseTriggerProperty); }
        set { SetValue(CloseTriggerProperty, value); }
    }

    public static readonly DependencyProperty CloseTriggerProperty =
        DependencyProperty.Register("CloseTrigger", typeof(bool), typeof(CloseWindowBehavior), new PropertyMetadata(false, OnCloseTriggerChanged));

    private static void OnCloseTriggerChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var behavior = d as CloseWindowBehavior;

        if (behavior != null)
        {
            behavior.OnCloseTriggerChanged();
        }
    }

    private void OnCloseTriggerChanged()
    {
        // when closetrigger is true, close the window
        if (this.CloseTrigger)
        {
            this.AssociatedObject.Close();
        }
    }
} 
```

然后在您的窗口中，您只需将 CloseTrigger 绑定到一个布尔值，当您希望窗口关闭时将设置该值。

```
<Window x:Class="TestApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        xmlns:local="clr-namespace:TestApp"
        Title="MainWindow" Height="350" Width="525">
    <i:Interaction.Behaviors>
        <local:CloseWindowBehavior CloseTrigger="{Binding CloseTrigger}" />
    </i:Interaction.Behaviors>

    <Grid>

    </Grid>
</Window> 
```

最后，当您希望窗口像这样关闭时，您的 DataContext/ViewModel 将具有您设置的属性：

```
public class MainWindowViewModel : INotifyPropertyChanged
{
    private bool closeTrigger;

    /// <summary>
    /// Gets or Sets if the main window should be closed
    /// </summary>
    public bool CloseTrigger
    {
        get { return this.closeTrigger; }
        set
        {
            this.closeTrigger = value;
            RaisePropertyChanged(nameof(CloseTrigger));
        }
    }

    public MainWindowViewModel()
    {
        // just setting for example, close the window
        CloseTrigger = true;
    }

    protected void RaisePropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

（设置你的 Window.DataContext = new MainWindowViewModel()）

* * *

## 回答 #4

> 赞同：26
> 
> 时间：2017-09-30T14:45:13.470

可能晚了，但这是我的答案

```
foreach (Window item in Application.Current.Windows)
{
    if (item.DataContext == this) item.Close();
} 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-04-23T15:11:59.967

那么这是我在几个项目中使用的东西。它可能看起来像一个黑客，但它工作正常。

```
public class AttachedProperties : DependencyObject //adds a bindable DialogResult to window
{
    public static readonly DependencyProperty DialogResultProperty = 
        DependencyProperty.RegisterAttached("DialogResult", typeof(bool?), typeof(AttachedProperties), 
        new PropertyMetaData(default(bool?), OnDialogResultChanged));

    public bool? DialogResult
    {
        get { return (bool?)GetValue(DialogResultProperty); }
        set { SetValue(DialogResultProperty, value); }
    }

    private static void OnDialogResultChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var window = d as Window;
        if (window == null)
            return;

        window.DialogResult = (bool?)e.NewValue;
    }
} 
```

现在您可以绑定`DialogResult`到 VM 并设置其属性值。`Window`设置值时将关闭。

```
<!-- Assuming that the VM is bound to the DataContext and the bound VM has a property DialogResult -->
<Window someNs:AttachedProperties.DialogResult={Binding DialogResult} /> 
```

**这是在我们的生产环境中运行的摘要**

```
<Window x:Class="AC.Frontend.Controls.DialogControl.Dialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:DialogControl="clr-namespace:AC.Frontend.Controls.DialogControl" 
        xmlns:hlp="clr-namespace:AC.Frontend.Helper"
        MinHeight="150" MinWidth="300" ResizeMode="NoResize" SizeToContent="WidthAndHeight"
        WindowStartupLocation="CenterScreen" Title="{Binding Title}"
        hlp:AttachedProperties.DialogResult="{Binding DialogResult}" WindowStyle="ToolWindow" ShowInTaskbar="True"
        Language="{Binding UiCulture, Source={StaticResource Strings}}">
        <!-- A lot more stuff here -->
</Window> 
```

如您所见，我`xmlns:hlp="clr-namespace:AC.Frontend.Helper"`先声明命名空间，然后再声明 binding `hlp:AttachedProperties.DialogResult="{Binding DialogResult}"`。

`AttachedProperty`外观是这样的。这与我昨天发布的不一样，但恕我直言，它不应该有任何影响。

```
public class AttachedProperties
{
    #region DialogResult

    public static readonly DependencyProperty DialogResultProperty =
        DependencyProperty.RegisterAttached("DialogResult", typeof (bool?), typeof (AttachedProperties), new PropertyMetadata(default(bool?), OnDialogResultChanged));

    private static void OnDialogResultChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var wnd = d as Window;
        if (wnd == null)
            return;

        wnd.DialogResult = (bool?) e.NewValue;
    }

    public static bool? GetDialogResult(DependencyObject dp)
    {
        if (dp == null) throw new ArgumentNullException("dp");

        return (bool?)dp.GetValue(DialogResultProperty);
    }

    public static void SetDialogResult(DependencyObject dp, object value)
    {
        if (dp == null) throw new ArgumentNullException("dp");

        dp.SetValue(DialogResultProperty, value);
    }

    #endregion
} 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2014-12-28T13:28:46.863

简单的方法

```
public interface IRequireViewIdentification
{
    Guid ViewID { get; }
} 
```

实现到 ViewModel

```
public class MyViewVM : IRequireViewIdentification
{
    private Guid _viewId;

    public Guid ViewID
    {
        get { return _viewId; }
    }

    public MyViewVM()
    {
        _viewId = Guid.NewGuid();
    }
} 
```

添加通用窗口管理器助手

```
public static class WindowManager
{
    public static void CloseWindow(Guid id)
    {
        foreach (Window window in Application.Current.Windows)
        {
            var w_id = window.DataContext as IRequireViewIdentification;
            if (w_id != null && w_id.ViewID.Equals(id))
            {
                window.Close();
            }
        }
    }
} 
```

并在视图模型中像这样关闭它

```
WindowManager.CloseWindow(ViewID); 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2019-02-08T21:17:24.763

我知道这是一篇旧帖子，可能没有人会滚动这么远，我知道我没有。所以，经过几个小时的尝试不同的东西，我找到了这个博客，老兄把它杀了。最简单的方法，尝试了它，它就像一个魅力。

[博客](http://jkshay.com/closing-a-wpf-window-using-mvvm-and-minimal-code-behind/)

在视图模型中：

```
...

public bool CanClose { get; set; }

private RelayCommand closeCommand;
public ICommand CloseCommand
{
    get
    {
        if(closeCommand == null)
        (
            closeCommand = new RelayCommand(param => Close(), param => CanClose);
        )
    }
}

public void Close()
{
    this.Close();
}

... 
```

向 ViewModel 添加一个 Action 属性，但从 View 的代码隐藏文件中定义它。这将让我们在 ViewModel 上动态定义一个指向 View 的引用。

在 ViewModel 上，我们将简单地添加：

```
public Action CloseAction { get; set; } 
```

在视图上，我们将其定义为：

```
public View()
{
    InitializeComponent() // this draws the View
    ViewModel vm = new ViewModel(); // this creates an instance of the ViewModel
    this.DataContext = vm; // this sets the newly created ViewModel as the DataContext for the View
    if ( vm.CloseAction == null )
        vm.CloseAction = new Action(() => this.Close());
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-09-02T13:05:08.730

这是一个使用 MVVM Light Messenger 而不是事件的简单示例。单击按钮时，视图模型会发送关闭消息：

```
 public MainViewModel()
    {
        QuitCommand = new RelayCommand(ExecuteQuitCommand);
    }

    public RelayCommand QuitCommand { get; private set; }

    private void ExecuteQuitCommand() 
    {
        Messenger.Default.Send<CloseMessage>(new CloseMessage());
    } 
```

然后在窗口后面的代码中接收它。

```
 public Main()
    {   
        InitializeComponent();
        Messenger.Default.Register<CloseMessage>(this, HandleCloseMessage);
    }

    private void HandleCloseMessage(CloseMessage closeMessage)
    {
        Close();
    } 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-05-09T08:39:41.527

[这个](http://jkshay.com/closing-a-wpf-window-using-mvvm-and-minimal-code-behind/)怎么样？

视图模型：

```
class ViewModel
{
    public Action CloseAction { get; set; }
    private void Stuff()
    {
       // Do Stuff
       CloseAction(); // closes the window
    }
} 
```

在您的 ViewModel 中使用 CloseAction() 关闭窗口，就像上面的示例一样。

看法：

```
public View()
{
    InitializeComponent();
    ViewModel vm = new ViewModel (); // this creates an instance of the ViewModel
    this.DataContext = vm; // this sets the newly created ViewModel as the DataContext for the View
    if (vm.CloseAction == null)
        vm.CloseAction = new Action(() => this.Close());
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-01-20T08:52:20.027

您可以像这样在 ViewModel 中创建新的事件处理程序。

```
public event EventHandler RequestClose;

    protected void OnRequestClose()
    {
        if (RequestClose != null)
            RequestClose(this, EventArgs.Empty);
    } 
```

然后为 ExitCommand 定义 RelayCommand。

```
private RelayCommand _CloseCommand;
    public ICommand CloseCommand
    {
        get
        {
            if(this._CloseCommand==null)
                this._CloseCommand=new RelayCommand(CloseClick);
            return this._CloseCommand;
        }
    }

    private void CloseClick(object obj)
    {
        OnRequestClose();
    } 
```

然后在 XAML 文件集中

```
<Button Command="{Binding CloseCommand}" /> 
```

在 xaml.cs 文件中设置 DataContext 并订阅我们创建的事件。

```
public partial class MainWindow : Window
{
    private ViewModel mainViewModel = null;
    public MainWindow()
    {
        InitializeComponent();
        mainViewModel = new ViewModel();
        this.DataContext = mainViewModel;
        mainViewModel.RequestClose += delegate(object sender, EventArgs args) { this.Close(); };
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-03-06T13:37:09.117

我提供的方法是在 ViewModel 中声明事件并使用混合 InvokeMethodAction，如下所示。

示例视图模型

```
public class MainWindowViewModel : BindableBase, ICloseable
{
    public DelegateCommand SomeCommand { get; private set; }
    #region ICloseable Implementation
    public event EventHandler CloseRequested;        

    public void RaiseCloseNotification()
    {
        var handler = CloseRequested;
        if (handler != null)
        {
            handler.Invoke(this, EventArgs.Empty);
        }
    }
    #endregion

    public MainWindowViewModel()
    {
        SomeCommand = new DelegateCommand(() =>
        {
            //when you decide to close window
            RaiseCloseNotification();
        });
    }
} 
```

I Closeable 界面如下，但不需要执行此操作。ICloseable 将有助于创建通用视图服务，因此如果您通过依赖注入构造视图和 ViewModel，那么您可以做的是

```
internal interface ICloseable
{
    event EventHandler CloseRequested;
} 
```

使用 ICloseable

```
var viewModel = new MainWindowViewModel();
        // As service is generic and don't know whether it can request close event
        var window = new Window() { Content = new MainView() };
        var closeable = viewModel as ICloseable;
        if (closeable != null)
        {
            closeable.CloseRequested += (s, e) => window.Close();
        } 
```

下面是Xaml，即使你不实现接口也可以使用这个xaml，它只需要你的视图模型来引发CloseRquested。

```
<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:local="clr-namespace:WPFRx"
xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity" 
xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" 
xmlns:ViewModels="clr-namespace:WPFRx.ViewModels" x:Name="window" x:Class="WPFRx.MainWindow"
    mc:Ignorable="d"
    Title="MainWindow" Height="350" Width="525" 
d:DataContext="{d:DesignInstance {x:Type ViewModels:MainWindowViewModel}}">

<i:Interaction.Triggers>
    <i:EventTrigger SourceObject="{Binding Mode=OneWay}" EventName="CloseRequested" >
        <ei:CallMethodAction TargetObject="{Binding ElementName=window}" MethodName="Close"/>
    </i:EventTrigger>
</i:Interaction.Triggers>

<Grid>
    <Button Content="Some Content" Command="{Binding SomeCommand}" Width="100" Height="25"/>
</Grid> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-12-06T17:08:17.430

您可以`Messenger`从 MVVMLight 工具包中使用。在您`ViewModel`发送这样的消息：
`Messenger.Default.Send(new NotificationMessage("Close"));`
然后在您的 Windows 代码后面，之后`InitializeComponent`，像这样注册该消息：

```
Messenger.Default.Register<NotificationMessage>(this, m=>{
    if(m.Notification == "Close") 
    {
        this.Close();
    }
   }); 
```

您可以在此处找到有关 MVVMLight 工具包的更多信息： [Codeplex 上的 MVVMLight 工具包](http://mvvmlight.codeplex.com/)

**请注意，MVVM 中没有“完全没有代码隐藏规则”，您可以在视图代码隐藏中注册消息。**

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2013-04-23T15:14:42.393

这很简单。您可以为 Login 创建自己的 ViewModel 类 - LoginViewModel。您可以创建视图 var dialog = new UserView(); 在您的 LoginViewModel 中。并且您可以将 Command LoginCommand 设置为按钮。

```
<Button Name="btnLogin" IsDefault="True" Content="Login" Command="{Binding LoginCommand}" /> 
```

和

```
<Button Name="btnCancel" IsDefault="True" Content="Login" Command="{Binding CancelCommand}" /> 
```

视图模型类：

```
public class LoginViewModel
{
    Window dialog;
    public bool ShowLogin()
    {
       dialog = new UserView();
       dialog.DataContext = this; // set up ViewModel into View
       if (dialog.ShowDialog() == true)
       {
         return true;
       }

       return false;
    }

    ICommand _loginCommand
    public ICommand LoginCommand
    {
        get
        {
            if (_loginCommand == null)
                _loginCommand = new RelayCommand(param => this.Login());

            return _loginCommand;
        }
    }

    public void CloseLoginView()
    {
            if (dialog != null)
          dialog.Close();
    }   

    public void Login()
    {
        if(CheckLogin()==true)
        {
            CloseLoginView();         
        }
        else
        {
          // write error message
        }
    }

    public bool CheckLogin()
    {
      // ... check login code
      return true;
    }
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-07-08T21:58:55.770

这是我很简单的一种方式：

**YourWindow.xaml.cs**

```
//In your constructor
public YourWindow()
{
    InitializeComponent();
    DataContext = new YourWindowViewModel(this);
} 
```

**YourWindowViewModel.cs**

```
private YourWindow window;//so we can kill the window

//In your constructor
public YourWindowViewModel(YourWindow window)
{
    this.window = window;
}

//to close the window
public void CloseWindow()
{
    window.Close();
} 
```

我认为您选择的答案没有任何问题，我只是认为这可能是一种更简单的方法！

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-11-07T08:45:41.727

您可以将 window 视为服务（例如 UI 服务）并通过**interface**将自身传递给 viewmodel ，如下所示：

```
public interface IMainWindowAccess
{
    void Close(bool result);
}

public class MainWindow : IMainWindowAccess
{
    // (...)
    public void Close(bool result)
    {
        DialogResult = result;
        Close();
    }
}

public class MainWindowViewModel
{
    private IMainWindowAccess access;

    public MainWindowViewModel(IMainWindowAccess access)
    {
        this.access = access;
    }

    public void DoClose()
    {
        access.Close(true);
    }
} 
```

该解决方案具有将视图本身传递给 viewmodel 而没有破坏 MVVM 的缺点，因为尽管将物理视图传递给 viewmodel，后者仍然不知道前者，它只看到一些`IMainWindowAccess`. 因此，例如，如果我们想将此解决方案迁移到其他平台，则只需`IMainWindowAccess`为`Activity`.

我在这里发布解决方案是为了提出与事件不同的方法（尽管它实际上非常相似），因为它似乎比事件实现（附加/分离等）简单一点，但仍然与 MVVM 模式很好地对齐。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-04-11T16:59:15.643

在 MVVM WPF 中，我通常将 View 设计为 UserControl。这只是你想如何显示它的问题。如果你希望它在一个窗口中，那么你可以做一个 WindowService 类：

```
public class WindowService
{
   //...

   public void Show_window(object viewModel, int height, int width, string title)
   {
     var window = new Window
     {
       Content = viewModel,
       Title = title,
       Height = height,
       Width = width,
       WindowStartupLocation = WindowStartupLocation.CenterOwner,
       Owner = Application.Current.MainWindow,
       Style = (Style)Application.Current.FindResource("Window_style") //even style can be added
      };

      //If you own custom window style, then you can bind close/minimize/maxmize/restore buttons like this 
      window.CommandBindings.Add(new CommandBinding(SystemCommands.CloseWindowCommand, OnCloseWindow));
      window.CommandBindings.Add(new CommandBinding(SystemCommands.MaximizeWindowCommand, OnMaximizeWindow, OnCanResizeWindow));
      window.CommandBindings.Add(new CommandBinding(SystemCommands.MinimizeWindowCommand, OnMinimizeWindow, OnCanMinimizeWindow));
      window.CommandBindings.Add(new CommandBinding(SystemCommands.RestoreWindowCommand, OnRestoreWindow, OnCanResizeWindow));

      window.ShowDialog();
   }

   public void Close_window(object viewmodel)
   {
       //Close window
       foreach (Window item in Application.Current.Windows)
       {
          if (item.Content == viewmodel) item.Close();
       }
    }
} 
```

使用我的方法很简单。通常你想在它发生某些事情时关闭窗口。因此，当它这样做时，只需从相应的 ViewModel 调用**Close_window**方法——即显示在窗口中的 UserControl 的 DataContext 方法。看底部示例：

1.) 我们从一些 Viewmodel 打开 Window：

```
public class MyViewModel // ViewModel where you open window
{
   private readonly WindowService _windowservice // or inject/inherit from Base

   public MyViewModel()
   {
     _windowservice = new WindowService();
   }  

   private void Example_method()
   {
        //...Open window
        _windowservice.Show_window(new WindowViewModel(),100,100,"Test window");
   }

} 
```

2.）我们的窗口已经打开，现在我们要关闭它：

```
 public class WindowViewModel // ViewModel which is your Window content!
 {
     private readonly WindowService _windowservice // or inject/inherit from Base

     public MyViewModel()
     {
       _windowservice = new WindowService();
     }  

     private void Example_method()
     {
          //Close window
          _windowservice.Close(this); //Pass a reference of viewmodel to method
     }

  } 
```

这个解决方案远没有其他公认的答案那么优雅，但对我来说它有效。我在项目中广泛使用它，到目前为止它没有问题。但我敢肯定，有人会说“这违反了 MVVM 原则”。

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2014-07-15T06:42:23.680

您只需使用以下代码即可关闭当前窗口：

```
Application.Current.Windows[0].Close(); 
```

* * *

## 回答 #18

> 赞同：-7
> 
> 时间：2014-05-09T08:21:25.363

System.Environment.Exit(0); 在视图模型中会起作用。

# jquery - jQuery 滑块 FadeIn()

> ID：16172464
> 
> 赞同：0
> 
> 时间：2013-04-23T14:49:00.200
> 
> 标签：jquery, fadein, fadeout

正在制作带有淡入/淡出过渡的横幅。真的很简单。每隔一段时间，图像就会随机变化。一切正常。

问题在于淡出部分。当前显示的图像不会淡出。有什么建议么 ：） ？

如果有任何善良的人可以提供有关如何为我重构 js 代码的提示......我仍然是一名初级人员，对于这个项目，我不想使用任何插件。

```
$(function () {

        var myPix = [ 'img/1.jpg', 'img/2.jpg', 'img/3.jpg', 'img/4.jpg', 'img/5.jpg', 
                                    'img/6.jpg', 'img/7.jpg', 'img/8.jpg', 'img/9.jpg', 'img/10.jpg',
                                    'img/11.jpg', 'img/12.jpg', 'img/13.jpg' 
                                ],
                randomNum = Math.floor(( Math.random() * myPix.length )),
                aa = '<img src="' + myPix[randomNum] + '" />';

        $('header').append($(aa).fadeIn(1000));

        setInterval( function () {
            var myPix = [ 'img/1.jpg', 'img/2.jpg', 'img/3.jpg', 'img/4.jpg', 'img/5.jpg', 
                                        'img/6.jpg', 'img/7.jpg', 'img/8.jpg', 'img/9.jpg', 'img/10.jpg',
                                        'img/11.jpg', 'img/12.jpg', 'img/13.jpg' 
                                    ],
                    randomNum = Math.floor(( Math.random() * myPix.length )),
                    aa = '<img src="' + myPix[randomNum] + '" />';

        $('header img').fadeOut(5000).replaceWith($(aa).fadeIn(2000));

        }, 6000);

}); 
```

[http://jsfiddle.net/simomultimedia/vVyph/](http://jsfiddle.net/simomultimedia/vVyph/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:54:31.037

把`fadeIn()`里面的`fadeOut()`回调函数：

```
$('header img').fadeOut(5000, function() {
    $(this).replaceWith($(aa).fadeIn(2000));
}); 
```

### [更新的小提琴](http://jsfiddle.net/vVyph/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:56:48.657

使用以下内容：

```
 $('header img').fadeOut(5000, function(){$(this).replaceWith($(aa).fadeIn(2000))}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:05:03.167

将淡入放在淡出的完整功能中，所以只有在淡出后才会启动：

```
$('header').append($(aa).fadeIn(1000));
    setInterval( function () {
        randomNum = Math.floor(( Math.random() * myPix.length )),
        source = "http://nunstoprecords.co.za/"+myPix[randomNum];
        $('header img').fadeOut(2000, function() {$('header img').attr("src",source).fadeIn(2000)});
    }, 5000); 
```

此外，如果您想同时淡入和淡出它们，请使用两个图像容器。

# python - 用于 Python 和 Tkinter 的 Linux 上的字体管理

> ID：16172466
> 
> 赞同：1
> 
> 时间：2013-04-23T14:49:13.700
> 
> 标签：python, linux, fonts, tkinter

我在 Python2.7/Tkinter 中编写了一个应用程序。我有 2 台 Linux 机器：
1 台带有 python 2.7.4 的 Xubuntu 1 台带有 python 2.7.1 的 CentOS (5.2) （不幸的是，在有人问之前，我无法升级这台机器）

我通过 SSH 从我的 WindowsXP 笔记本电脑连接到两台机器，然后导出显示。Xming 作为 X 服务器安装在 windows 机器上。两台机器上的脚本完全相同（两台机器上都安装了共享驱动器）。

在脚本中我有：

```
# show which fonts the system know 
print tkFont.families()
# configure the default font
default_font = tkFont.nametofont("TkDefaultFont")
default_font.configure(family="Liberation Sans", size="10")
master.option_add("*Font", default_font) 
```

字体“Liberation”安装在 Linux 机器和 Xming 中（并已配置）。
在应用程序中我使用了网格管理器，因此字体对结果界面有很大影响。

当我从 Xubuntu 启动应用程序时：

*   应用程序界面看起来很漂亮。`tkFont.families`给我看一些 Xming 中没有安装的字体（但在 Xubuntu 上）

当我从 CentOs 启动应用程序时：

*   应用程序界面丑陋几乎不可读，完全变形。`tkFont.families`仅当在 Xming 中安装和配置时，才在列表中显示“解放”字体。

从今天早上开始我就挠头了，我什至将Xubuntu的liberation*.ttf文件复制到所有其他机器上，但没有成功

如何抑制两台机器之间的这种差异，我的界面在两台机器上看起来都一样？

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-24T17:14:48.800

猜测一下，您的 tk 安装服务器端依赖于 X Core 字体子系统来呈现字体（这就是它显示 xming 字体的原因）。

这个子系统很久以前就被 fontconfig 取代了（但是 tk 切换的很晚）。Centos 5.2 可能已经足够老了，它的 tk 版本仍然依赖于 X Core 字体子系统。然而，Fedora 和 Red Hat 很久以前就停止将系统 truetype 字体公开为 X Core 字体（它破坏了遗留应用程序）。

所以你的解决方案是：

– 要么升级到可以使用 fontconfig 的 tk（或重新配置它以使用 fontconfig）：这样它将看到安装在 Centos 中的现代字体，包括 Liberation [http://wiki.tcl.tk/9015](http://wiki.tcl.tk/9015)

– 或者，使用所有遗留魔法在 xfs 中公开 liberation 字体（mkfontdir 和朋友，如所有 2000 年以前的 Linux 字体指南中所述）。并且祈祷不要破坏其他东西，X核心字体系统并不是特别强大。

[https://www.centos.org/docs/5/html/5.2/Deployment_Guide/s1-x-fonts.html](https://www.centos.org/docs/5/html/5.2/Deployment_Guide/s1-x-fonts.html)

中期你必须以 fontconfig 的方式进行，因为 x 核心字体即将推出（大约在 2007 年发布 RHEL 5 时已经是这种情况）。

# php - 在多维数组中使用 in_array

> ID：16172470
> 
> 赞同：-2
> 
> 时间：2013-04-23T14:49:28.757
> 
> 标签：php

我将通过显示我的代码来解释：

```
if($_POST)
{
for ($records = 1; $records <= $_POST['numberofrecords']; $records++)
    {
    if((!in_array($_POST['user'][$records], $assigned_users, true))||($_POST['user'][$records]==''))    
       {
       $phonePost['user']       = $_POST['user'][$records];
       $phonePost['id']     = $_POST['id'][$records];

       $this->autoprov_model->update_phone_user($phonePost);
       }                        
   else
       {    
       //other actions.....
       } 
```

ETC....

$assigned_users 是一个列出当前选择的所有 ID 的查询。

相关的html是

```
<select name=user[<?=$lines;?>] style="position: relative; right: 120px;" onchange="submitform(this)">
    <?php if($phone['user_id']=='')echo '<option value="">Unassigned</option>'?>
    <?php foreach ($users_list as $user):?>
    <?php if($user['id']==$phone['user'])$selected = 'selected="selected"'; else $selected = '';?>
    <option value="<?=$user['id'];?>" <?=$selected?>><?=$user['name'];?></option>
    <?php endforeach;?>
</select> 
```

发生的事情是我发布了各种 ID（与 $assigned_user 数组相关），但实际上并未在数组中。而且当我发布''（空白）时，它们永远不会更新，只会到达第二部分。

我在这里问我是否错过了将值发布为数组的技巧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:03:02.990

1.  您应该在您的选择标签中将名称放在引号中。像这样：`name="user[<?=$lines;?>]"`。
2.  `$assigned_users`应该是一个数组。
3.  检查存在`isset($_POST['user'][$records])`而不是将其与空字符串进行比较，或者简单地试试这个`if((@in_array($_POST['user'][$records], $assigned_users, true)==false){`：

# sql - Microsoft SQL Server 2005 对字符串的查询：<''

> ID：16172471
> 
> 赞同：0
> 
> 时间：2013-04-23T14:49:30.803
> 
> 标签：sql, sql-server, sql-server-2005

我有一个`tbl`带有以下记录的 Microsoft SQL 表：

```
clmn1 (smallint NOT NULL) = '2012'
clmn2 (char (10) NOT NULL) = '620100' 
clmn3 (char (1) NOT NULL) = '' 
```

当我执行以下查询时：

```
select * 
from tbl with (rowlock)  
where clmn1 = 2012 and clmn2 = '620100' and clmn3 <= ' ' 
```

然后找到上面的行，是正确的。

但是在执行以下查询时：

```
select * 
from tbl with (rowlock)  
where clmn1 = 2012 and clmn2 = '620100' and clmn3 < ' ' 
```

然后它没有发现任何不正常的东西。因为 clmn3 是空的 ('')。`'' < ' ' = true`.

必须使用 2 个 sql 查询的这种格式，因为我们正在使用 Xisam 将他自己的 sql 查询转换为上述 sql 查询格式。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T14:50:50.957

`CHAR(1)`变成......*所以*不是。`''`_ 如果您希望将空字符串视为空字符串，请停止使用并使用.`' '``' '` *`< ' '``CHAR``VARCHAR`*

 *```
DECLARE @c CHAR(1);
SET @c = '';
SELECT 'x' + @c + 'x'; 
```

结果：

```
x x -- not xx 
```*

# android - 与 Linux 相比，Android 是否有任何网络限制？

> ID：16172474
> 
> 赞同：1
> 
> 时间：2013-04-23T14:49:39.530
> 
> 标签：android, linux, networking, linux-kernel

我刚刚阅读了Linux Foundation 的 Benjamin Zores*[在“嵌入式​​系统中 Android 的发展”](http://training.linuxfoundation.org/free-linux-training/download-training-materials/growth-of-android-in-embedded-systems)* [(PDF)中的以下内容：](http://storage.pardot.com/6342/90356/lft_pub_growth_of_android.pdf)

> 最后但同样重要的是，在开发网络和连接层时，Android 故意阻碍了 Linux 的一项关键资产。操作系统一次无法处理多个网络连接，一次无法处理多个设备驱动程序（每种连接类型），并且每种连接类型无法处理多个接口。

我找不到对此的任何其他参考。这到底是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T14:57:34.637

Android 开发人员通过以下方式节省了时间和金钱：

*   一次只允许一个网络连接到一个网络，例如，您不能同时将 IP 流量路由到连接的 WiFi 网络和 3G 网络。
*   每种连接类型只允许一个网络设备驱动程序在任何时间点运行。因此，您可能有一个用于 3G 网络的驱动程序、另一个用于 WiFi 网络的驱动程序、另一个用于 USB 网络共享的驱动程序，但您不能同时加载两个单独的 WiFi 驱动程序。
*   不支持单个物理网络的多个逻辑接口。在 Linux 中，您可能拥有`eth0`并`net0`指向同一个 NIC，但 Android 不支持这一点。

这些网络功能是桌面和服务器操作系统的基础，但在移动系统上被认为是不必要的，因此被牺牲了。

# sql - SQL - 带有多个 then 的 Case 语句

> ID：16172495
> 
> 赞同：1
> 
> 时间：2013-04-23T14:50:50.383
> 
> 标签：sql, sql-server-2008, tsql

我正在使用 T-SQL，我试图让 then 语句返回多个值，以便我可以搜索“年份”列多年。

如果年份大于 2013，那么我想搜索当前年份和上一年。因此，如果年份是 2016，我想搜索 2016 AND 2015。

这段代码不起作用，但这是我想要完成的。

```
SELECT *
FROM [DB_NAME].[dbo].[TABLE_NAME] 
WHERE 
YR_CLMN in 
(
case when YEAR(GETDATE()) = 2013 then YEAR(GETDATE()) 
when YEAR(GETDATE()) > 2013 then (YEAR(GETDATE()), YEAR(GETDATE())-1)
end
) 
```

提前致谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T14:59:02.657

我不是 100% 确定我理解这个问题，但我相信它会给你你想要的

```
SELECT *
FROM [DB_NAME].[dbo].[TABLE_NAME] 
WHERE 
YR_CLMN >= 
(
case when YEAR(GETDATE()) > 2013 then YEAR(GETDATE())-1) 
ELSE YEAR(GETDATE())
end
) AND YR_CLMN <= YEAR(GETDATE()) 
```

这是

# [SQLFiddle](http://sqlfiddle.com/#!3/81451/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:06:16.190

尝试：

```
SELECT * FROM [DB_NAME].[dbo].[TABLE_NAME] 
WHERE YR_CLMN in 
(YEAR(GETDATE()), 
 case when YEAR(GETDATE()) > 2013 then YEAR(GETDATE())-1 else YEAR(GETDATE()) end) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T14:58:54.780

```
DECLARE @Dates Table
(
  YR_CLMN DateTime
  BringOut bit DEFAULT ( 0 )
)

--Get all columns
INSERT INTO @Dates ( YR_CLMN )
SELECT YR_CLMN
FROM [dbo].[YourTable]

--Where YR_CLMN = 2013
UPDATE @Dates SET BringOut = 1
WHERE YEAR(YR_CLMN) = 2013

--Where YR_CLMN is within a year of now
UPDATE @Dates SET BringOut = 1
WHERE YEAR(YR_CLMN) = YEAR(GETDATE()) OR YEAR(YR_CLMN) = YEAR(GETDATE()) - 1

SELECT YR_CLMN
FROM @Dates
WHERE BringOut = 1 
```

或者，如果上述方法不可接受。您本质上是在说 if `YR_CLMN = 2013 OR (YR_CLMN = YEAR(GETDATE()) AND YR_CLMN = YEAR(GETDATE()) - 1)`， using`IN`在性能方面确实不是很有成效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:56:22.243

到目前为止，有很多好的建议，所以我将采取稍微不同的课程。

假设您可以访问[数字表](https://dba.stackexchange.com/questions/11506/why-are-numbers-tables-invaluable)。如果没有，那就去买一个吧！:) 让我们也假设它以`Numbers`column命名`Number`。

另外，让我们使用[CTE](http://msdn.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)来提高可读性。这是一个非常简洁的查询。

```
; WITH ValidYears AS
(
    SELECT Number AS ValidYear
    FROM [dbo].[Numbers]
    WHERE Number >=  2013
        AND Number >= YEAR(GETDATE()) - 1
        AND NUmber <= YEAR(GETDATE())
)
SELECT *
FROM [DBName].[dbo].[TABLE_NAME] a
JOIN ValidYears b
    ON a.YR_CLMN = b.ValidYear 
```

我喜欢的是你将查询分成逻辑单元。CTE 处理年份逻辑，下面的查询决定如何处理它。

当然，您不必使用数字表。我只是觉得它看起来更好。

这是我的本地数字表的示例，以及 CTE 结果的样子。如果您的索引正确，将会有一个聚集索引搜索 - 非常有效。（旁注：我的表名为“整数”）

```
DECLARE @CurrentYear INT
SET @CurrentYear = 2016

SELECT value AS ValidYear
FROM [dbo].Integers
WHERE value >=  2013
    AND value >= @CurrentYear - 1
    AND value <= @CurrentYear 
```

# java - Mediaplayer 错误 (-19 0) 不适用于 release()

> ID：16172496
> 
> 赞同：0
> 
> 时间：2013-04-23T14:50:50.940
> 
> 标签：java, android, media-player, android-mediaplayer

我正在编写一个音板，当您在声音上单击 20 次以上时我遇到了问题。

首先，我收到 MediaPlayer 错误（-19 0），您再也听不到任何声音了。我知道这是我的记忆。所以当我尝试添加 Release(); 听起来一点也不。

这是一个播放声音的按钮：

```
public void click7(View v) {
MediaPlayer mp = MediaPlayer.create(NewActivity3.this, R.raw.hahah);
mp.start(); 
    } 
```

我也一直在尝试发布，然后没有声音：

```
public void click7(View v) {
        MediaPlayer mp = MediaPlayer.create(NewActivity3.this, R.raw.hahah);
        mp.start();
        mp.stop();
        mp.reset();
        mp.release();
    } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T09:40:41.250

使用以下代码

```
MediaPlayer mp=MediaPlayer.create(NewActivity3.this, R.raw.hahah);

   public void click7(View v) {
    if(mp!=null ){
    mp.reset();
    mp.prepare();
    mp.start(); 
   } 
```

每当您按下按钮并且您想播放声音文件时，此代码将非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:22:05.990

当您使用释放功能时，MediaPlayer 会清除内存中的所有内容。

释放与此 MediaPlayer 对象关联的资源。**使用完 MediaPlayer**后调用此方法被认为是一种好习惯**. 特别是，每当应用程序的 Activity 暂停（调用其 onPause() 方法）或停止（调用其 onStop() 方法）时，应调用此方法以释放 MediaPlayer 对象，除非应用程序有特殊的需要保持对象周围。除了占用不必要的资源（例如内存和编解码器的实例）外，如果不再需要 MediaPlayer 对象，则未能立即调用该方法还可能导致移动设备持续消耗电池，如果没有，其他应用程序播放失败设备上支持同一编解码器的多个实例。即使支持同一编解码器的多个实例，当同时使用不必要的多个实例时，可能会出现一些性能下降。**

# database - Worklight Server 是否支持存储 JSON 文件？

> ID：16172498
> 
> 赞同：1
> 
> 时间：2013-04-23T14:50:51.957
> 
> 标签：database, json, caching, ibm-mobilefirst

我正在寻找一种将 JSON 文件存储在 Worklight Server 上的方法。这样做的目的是它将是一个可由许多设备访问的 JSON 文件。在连接到服务器时，将对驱动应用程序的数据库进行初始检查，以查看版本号是什么。如果它与 JSON 文件中当前的内容匹配，则不会执行任何操作（实际上将使用“缓存的”JSON 文件）。但是，如果没有匹配，则将从数据库中提取新的 JSON 文件。

有没有人这样做过，有人知道这是否可能吗？如果有人对我如何实现这一点有任何建议，我将不胜感激。

干杯!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T14:55:53.193

Worklight Server 更像是一个“管道”，它在应用程序和后端之间使用适配器。我认为你不应该在上面保存任何东西。IMO，您应该拥有一些文件服务器（不是 Worklight Server），您的适配器将从其中获取 JSON 文件。

# c - 尝试复制数组 C 时出现分段错误（核心转储）

> ID：16172507
> 
> 赞同：0
> 
> 时间：2013-04-23T14:51:11.600
> 
> 标签：c, segmentation-fault

当我运行以下分段错误时...目标是将 argv 数组复制到 allowdip 数组。

```
char *allowdip;
int *allowdipcount;

int main(int argc, char *argv)
{
  int xer;

  allowdipcount = argc;

  for(xer=0; xer<allowdipcount; xer++) {
    allowdip[xer]=argv[xer];
  }

  for(xir=0; xir<allowdipcount -1; xir++) {
    printf("%s\n", allowdip[xir]);
  }

exit(EXIT_SUCCESS);
} 
```

关于我做错了什么的任何想法？

**更新**

谢谢，现在我的代码是：

```
char **allowdip;
int allowdipcount;

int main(int argc, char *argv)
{
  int xer;
  int xir;

  allowdipcount = argc;
  char **allowdip = malloc(allowdipcount * sizeof(char*));
  for(xer=0; xer<argc; xer++) {
      allowdip[xer]=argv[xer];
  }

    for(xir=1; xir<allowdipcount; xir++)
    printf("%s\n", allowdip[xir]);
    exit(EXIT_SUCCESS);

} 
```

它返回：

```
 testscript2.c:51: warning: assignment makes pointer from integer without a cast 
```

第 51 行包含：

```
 allowdip[xer]=argv[xer]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T14:52:23.330

`allowdip`是一个未初始化的指针。你需要为它分配内存

```
#include <stdlib.h>
#include <stdio.h>

int main(int argc, char *argv[])
{
  int xer;
  int allowdipcount = argc;
  char **allowdip = malloc(allowdipcount * sizeof(char*));

  for(xer=0; xer<allowdipcount; xer++) {
      allowdip[xer]=argv[xer];
  }

  for(xer=0; xer<allowdipcount; xer++) {
    printf("%s\n", allowdip[xer]);
  }
  free(allowdip);
  return EXIT_SUCCESS;
} 
```

请注意，我在您的代码中进行了一些其他更改

*   `allowdipcount`应该是类型`int`（否则你也需要为它分配存储空间）
*   `allowdip`已将类型更改为`char`指针数组
*   的签名`main`不太正确 -`argv`应该是一个`char*`数组
*   将您的全局变量更改为本地变量，`main`因为没有明显需要它们是全局变量
*   更改`printf`循环以遍历所有程序参数。它跳过了您问题中的最后一个参数。
*   `allowdip`完成后释放我们分配的内存
*   `main`文森特建议的简化回报

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:57:01.427

你没有分配内存，你的类型都是错误的。

计数器应该是整数，而不是指针：

```
int allowdipcount; 
```

并且数组应该是指针数组，而不是字符数组：

```
char **allowdip; 
```

然后你可以分配：

```
allowdip = malloc(argc * sizeof *allowdip); 
```

并复制数组：

```
memcpy(allowdip, argv, argc * sizeof *allowdip); 
```

请注意，这不会复制实际的参数字符串，只会复制指向字符串的指针数组。它也不包括终止数组的`NULL`指针。`argv[argc]`

# directx - 如何在没有 d3dx9 的 DirectX 9 中创建纹理？

> ID：16172508
> 
> 赞同：1
> 
> 时间：2013-04-23T14:51:11.657
> 
> 标签：directx, windows-store-apps

Windows 8 商店不想`d3dx9`在我的应用程序中看到，那是用`DirectX 9`. 但我需要`D3DXCreateTexture`功能。我被发现`DirectXTex`了，不过就是这样`DirectX 11`。有什么办法可以避免全部重写`DirectX 11`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T19:55:31.573

首先，您必须加载原始位图数据。有很多方法：

*   编写你自己的加载器（不是在 21 世纪 oO）
*   将库用于您需要的格式。比如 libpng、libjpeg，更多在 Google =)
*   使用多格式库（[C/C++ 图像加载](https://stackoverflow.com/questions/3284498/c-c-image-loading)）。FreeImage 是我的最爱。

然后你必须通过[D3DXCreateTextureFromFileInMemory](http://msdn.microsoft.com/en-us/library/windows/desktop/bb172803%28v=vs.85%29.aspx)或[D3DXCreateTextureFromFileInMemoryEx创建](http://msdn.microsoft.com/en-us/library/windows/desktop/bb172804%28v=vs.85%29.aspx)[IDirect3DTexture9](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205909%28v=vs.85%29.aspx)并且你准备好了 =)

**更新：**

好的。我们不能使用它`D3DXCreateTextureFromFileInMemory`。所以...我们可以实现它。如前所述，我们必须以某种方式将位图加载到内存中（我更喜欢使用 FreeImage）。然后我们通过**[CreateTexture()](http://msdn.microsoft.com/en-us/library/windows/desktop/bb174363%28v=vs.85%29.aspx)**方法创建*空的* [IDirect3DTexture9* 。](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205909%28v=vs.85%29.aspx)然后我们使用[LockRect()](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205913%28v=vs.85%29.aspx) / [UnlockRect()](http://msdn.microsoft.com/en-us/library/windows/desktop/bb205914%28v=vs.85%29.aspx)将位图的内容复制到该纹理。那个时候我们肯定准备好了，因为我已经测试过了！=) 测试包含FreeType的VS2012解决方案：[链接](http://www.sendspace.com/filegroup/pN70/fb6Ogl9iiFN12rI8g)（乱七八糟，请重写并封装在一个类中）核心功能：

```
void CreateTexture(const wchar_t* filename)
{
unsigned int width(0), height(0);
std::vector<unsigned char> bitmap;
LoadBitmapFile(filename, bitmap, width, height); // Wrapped FreeImage

// Create empty IDirect3DTexture9*
pDevice->CreateTexture(width, height, 1, 0, 
                           D3DFMT_A8R8G8B8, D3DPOOL_MANAGED, &pTexture, 0);
if (!pTexture)
{
    throw std::runtime_error( "CreateTexture failed");
}

D3DLOCKED_RECT rect;
pTexture->LockRect( 0, &rect, 0, D3DLOCK_DISCARD );
unsigned char* dest = static_cast<unsigned char*>(rect.pBits);
memcpy(dest, &bitmap[0], sizeof(unsigned char) * width * height * 4);
pTexture->UnlockRect(0); 
```

}

希望能帮助到你。

PS 其实还有一个问题：投影矩阵。您将需要手动创建它或使用一些数学库，因为您无法使用 D3DXMatrix..() 函数。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-24T08:24:43.713

似乎`DirectX 9`代码必须用`DirectX 11`, cause `DirectXTK`,重写`DirectXTex`，`DirectXMath`libs 仅适用于 DX11。我在[http://social.msdn.microsoft.com/Forums/en-US/wingameswithdirectx/thread/c082b208-0d95-4c41-852f-9450340093f4/找到了更多信息](http://social.msdn.microsoft.com/Forums/en-US/wingameswithdirectx/thread/c082b208-0d95-4c41-852f-9450340093f4/)

# python - 在pyqt中发送文本信号

> ID：16172514
> 
> 赞同：0
> 
> 时间：2013-04-23T14:51:25.820
> 
> 标签：python, pyqt

我正在用 pyqt 编写一个 GUI 程序。我写了它的框架，现在我想把它写进`LineEdit`我的程序并做一些工作。我知道我应该使用信号，但我找不到它的功能。我应该怎么写？

之后我想展示改变它的结果`TextEdit`。这怎么可能？

这是我的代码：

```
from PyQt4 import QtGui, QtCore
import sys

class Rss(QtGui.QWidget):

  def __init__(self):
        super(Rss,self).__init__()
        self.resize(350,200)
        self.center()
        self.setWindowTitle("Rss Reader")
        btn = QtGui.QPushButton("OK",self)
        btn.setGeometry(300,40,40,20)
        lbl = QtGui.QLabel("insert the site here :",self)
        lbl.setGeometry(10,10,100,20)
        txt = QtGui.QLineEdit(self)
        txt.setGeometry(120,10,220,20)
        res = QtGui.QLabel("The Result Is :",self)
        res.setGeometry(10,60,100,20)
        result = QtGui.QTextEdit(self)
        result.setGeometry(10,80,330,100)
        self.show()

  def center(self):
        qr = self.frameGeometry()
        cp = QtGui.QDesktopWidget().availableGeometry().center()
        qr.moveCenter(cp)
        self.move(qr.topLeft())

app = QtGui.QApplication(sys.argv)
rss = Rss()
sys.exit(app.exec_()) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:13:08.840

如果您查看[文档](http://pyqt.sourceforge.net/Docs/PyQt4/qlineedit.html)，您会在那里找到所有可用的信号。您只需要向您的类添加一个应该完成工作并将它们连接到的方法`__init__`：

```
txt.editingFinished.connect(self.do_the_work) 
```

您可能还希望保留对`txt`小部件的引用（替换`txt`为`self.txt`...），以便您可以轻松查找新值...

# c# - 我在这里迭代这个可枚举两次吗？

> ID：16172518
> 
> 赞同：2
> 
> 时间：2013-04-23T14:51:32.350
> 
> 标签：c#, algorithm, optimization

考虑以下代码块：

```
using (FileStream fs = new FileStream(@"C:\bad_records.txt", 
                                      FileMode.Create, 
                                      FileAccess.Write))
{
    var badEnumerable = _cache.Where(kvp => !kvp.Value.Item1);

    fs.WriteLine(string.Format("BAD  RECORDS ({0})", badEnumerable.Count()));
    fs.WriteLine("==========");

    foreach (var item in badEnumerable)
    {
        fs.WriteLine(string.Format("{0}: {1}", item.Key, item.Value.Item2));
    }
} 
```

where`_cache`定义如下：

```
static Dictionary<string, Tuple<bool, string, string>> _cache; 
```

**我是否将这个可枚举迭代了两次？**一次与`Count()`一次与`foreach`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T14:53:09.233

是的，您正在迭代可枚举两次。

一个简单的测试方法是使用这样的辅助方法：

```
private static int count = 0;
public static IEnumerable<T> CountIterations<T>(IEnumerable<T> sequence)
{
    count++;
    //or some other debug type logging
    Console.WriteLine("Iterated {0} times.", count);
    foreach(var item in sequence)
        yield return item;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T14:55:27.623

你使用你的字典`_cache`作为`IEnumerable`。 Where 方法已延迟执行。 所以你枚举它两次： in和 in 。`KeyValuePair`

`Count``foreach`

您可以将其更改为：
`var badEnumerable = _cache.Where(kvp => !kvp.Value.Item1).ToArray();`
和`fs.WriteLine(string.Format("BAD RECORDS ({0})", badEnumerable.Length));`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T15:07:46.913

是的， the`.Count()`和 the`foreach`都将导致`_cache`被枚举两次并针对`Where`原因中的谓词进行验证。

至于这是否是一个问题，取决于许多事情：

1.  内存中的所有值是否都已`_cache`在内存中，或者它是否正在查询底层源（例如数据库）。
2.  查询的集合中有多少项目以及比较的成本是多少。
3.  可以多次安全地枚举源。

例如，如果 in`_cache`的值已经在内存中并且谓词是一个简单的布尔属性比较，那么枚举缓存两次可能更有效并且不会增加额外的内存开销，而添加 a`.ToList()`仍然会导致 2 个枚举（其中一个`_cache`和一个列表）但是谓词检查只会发生一次（在`.ToList()`调用中）并且`foreach`将有更少的对象要枚举，但您将添加额外列表的额外内存开销。

如果缓存来自数据库，那么在`.ToList()`之后添加 a 的内存开销`.Where()`几乎肯定会比对数据库执行 2 个单独的查询要好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T15:25:30.817

简短的回答是肯定的。

根据 的基础类型`badEnumerable`，它**可能会**被枚举两次。这是由于所谓的“[延迟执行](http://msdn.microsoft.com/en-us/library/bb738633.aspx)”。延迟执行意味着您的 LINQ 查询“直到在 foreach 或 For Each 循环中迭代查询变量”（MSDN）才真正执行。您的`foreach`语句显然是对变量的迭代，并且`Enumerable.Count()`还执行迭代（在这种情况下）。

但在某些情况下，这不会导致两次迭代。当[`badEnumerable`它实际上是 的子类`ICollection`](https://stackoverflow.com/a/7969468/1438242)时会发生这种情况。在这种情况下，调用`.Count()`实际上引用了基础`.Count`属性，而**不是**枚举它。

由于`badEnumerable`is a `Dictionary<TKey, TValue>`，并且因为调用`Enumerable.Where()`返回一个泛型`IEnumerable`（不是 an `ICollection`），所以您的特定情况不会遇到这种情况，并且会迭代两次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T14:54:40.627

是的，为避免重复两次，请使用 a`List` 您可以在初始迭代后打印计数。另一种解决方案是保存循环中写入的文本并在打印计数后打印。

编辑更正：

```
using (FileStream fs = new FileStream(@"C:\bad_records.txt", FileMode.Create, FileAccess.Write))
{
    var badEnumerable = _cache.Where(kvp => !kvp.Value.Item1);

    int count = 0;
    foreach (var item in badEnumerable)
    {
        count++;
        Console.WriteLine(string.Format("{0}: {1}", item.Key, item.Value.Item2));
    }

    Console.WriteLine("==========");
    Console.WriteLine(string.Format("BAD  RECORDS ({0})", count));
} 
```

# php - 插入/更新 PHP 变量以及 SQL 中其他表的值

> ID：16172519
> 
> 赞同：2
> 
> 时间：2013-04-23T14:51:32.760
> 
> 标签：php, mysql, sql, extjs, extjs4

我有一张桌子叫`Users`. 此表包含参数： `userID`、`userName`、`functionID`、`supervisorID`、`firstName`和`lastName`。`email`

当我将用户加载到使用 EXT JS 创建的应用程序中时，我在 PHP 中使用以下查询：

```
public function getEmployees(stdClass $params)
{
    global $DBH;
    $STH = $DBH->query(
        "SELECT u.id, u.userName AS 'userName', f.functionName, us.userName AS 'supervisorName', u.firstName, u.lastName, u.email 
         FROM users AS u 
         INNER JOIN functions AS f ON u.functionID=f.id
         LEFT JOIN users AS us ON u.supervisorID=us.id 
         ORDER BY u.id");
    return $STH->fetchAll(PDO::FETCH_ASSOC);
} 
```

所以不是通过`functionID`and`supervisorID`我通过`functionName`and `supervisorName`。
我的应用程序上的网格显示`userName`, `functionName`(not ID), `supervisorName`(not ID), `firstName`,...

现在我对如何创建新用户以及如果我的应用程序通过 , `userName`（`functionName`因此需要将其转换为`functionID`）、`supervisorName`（需要转换为`supervisorID`）`firstName`、...
已经尝试了许多查询，但我似乎无法弄清楚。

有人可以帮我吗？

提前致谢！

**评论后更新：**
我应该提到我的网站是用 Sencha 的 EXT JS 构建的。
只有管​​理员可以编辑或创建新用户。
创建/编辑在 EXT Grid 中完成，JSON 数据通过 Ext.Direct 传递给 PHP。
所以我需要一种方法来获取与应用程序传递的`functionID`和`supervisorID`相关联的`functionName`和。`supervisorID`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:21:03.783

我想您的表单有组合框 ( `<select>`) 或类似的控件（单选按钮集、列表）来选择功能和主管。制作`select`ID 的值，而不是名称：

```
<select name="function">
    <option value="1">Boss</option>
    <option value="2">Stableman</option>
    <option value="3">Servant</option>
    <option value="4">Shepherd</option>
</select> 
```

然后你不需要做任何映射。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T18:10:42.240

马丁是对的，这是一个客户端问题。如果您不知道如何配置组件以使它们在请求中提交 id，您宁愿在 ExtJS 代码中发布问题。

对于初学者，您应该使用`valueField`和[组合](http://docs.sencha.com/extjs/4.2.0/#!/api/Ext.form.field.ComboBox)`displayField`选项，再加上一个[列渲染器](http://docs.sencha.com/extjs/4.2.0/#!/api/Ext.grid.column.Column-cfg-renderer)以在网格中显示名称而不是 id，即使用户没有编辑（即单元格不使用组合呈现） .

# sql - SQL 语句转换为 Linq

> ID：16172520
> 
> 赞同：-1
> 
> 时间：2013-04-23T14:51:38.093
> 
> 标签：sql, linq

我需要将以下 SQL 语句转换为 LINQ。我基本上是从数据库视图转移到一块 LINQ，我正在努力让 NOT IN 和内部 Select 工作

```
SELECT  DISTINCT *  

FROM TFund F3,TFundMapping FM

WHERE F3.ID NOT IN 
(SELECT ParentFundID
 FROM TFundMapping)
AND FM.ChildFundID = F3.ID 
```

作为背景知识，对于我的其他 LINQ 查询，我使用以下样式

```
public TxxxType[] GetxxxType()
    {
        var query = from item in _context.TxxxType
                    orderby item.ID
                    select item;

        return _context.SelectPOCOsWCF(query);
    } 
```

我似乎无法使语法正确并适合上述风格 - 任何帮助都将不胜感激，因为我在这个问题上遇到了一堵砖墙

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:58:21.670

该工具将帮助您实现目标

[http://www.sqltolinq.com/](http://www.sqltolinq.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:21:02.857

你可以试试这个，但它未经测试：

```
var result = ( from record in _context.TFund

               join fundMappingRecord in _context.TFundMapping
                 on record.ID equals fundMappingRecord.ChildFundID

               where ( from subResult in _context.TFundMapping
                       select subResult.ParentFundID 
                     ).Contains( record.ID ) == false 

               select new 
               {
                   record,
                   fundMappingRecord
               } ).Distinct( ); 
```

您仍然会遇到问题，因为您无法将匿名类型传递给另一个方法。

# php - PHP中的依赖注入没有接口也没有抽象类

> ID：16172522
> 
> 赞同：0
> 
> 时间：2013-04-23T14:51:40.053
> 
> 标签：php

我有一个实现远程命令调用的类 RemoteCall/Client。例如，通过 SSH 在远程系统上运行命令。

此类使用适配器（目前，我只使用 SSH 适配器）。

```
RemoteCall/Client.php
RemoteCall/Adapter/AdapterAbstract.php
RemoteCall/Adapter/SSH.php 
```

为了实现 SSH 协议，我下载了一个名为 Ipworks_SEexec 的外部库（现在不要问我）。

我的类 SSH.php 是否应该在 Ipworks_SExec 和她之间使用依赖注入？

```
public function __construct($driver = null)
{
    $this->_driver = $driver;
} 
```

或者最好不实现依赖注入并拥有类似的东西：

```
public function __construct()
{
    $this->_driver = new Ipworks_SEexec();
} 
```

我的 SSH.php 类仅适用于 Ipworks_SEexec 类。如果我决定使用另一个库，那将是不可能的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T14:57:50.777

没有“驱动程序”，因为您使用的是具体的 3rd 方库，所以只需要求这个类：

```
public function __construct(Ipworks_SExec $ssh_client)
{
...
} 
```

当然，您可以为 SSH 驱动程序创建代理接口并基于此 Ipworks_SExec 类实现第一个适配器，但如果您现在不需要不同的适配器，那将是多余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:00:03.423

> 我的类 SSH.php 是否应该在 Ipworks_SExec 和她之间使用依赖注入？

我对你的问题有点困惑。然而，依赖注入是为了动态加载依赖。正如您所说，您的 SSH 类必须使用 Ipworks_SExec 那么依赖注入可能没有什么意义（只是硬编码）。

除非 Ipworks_Exec 真的是可变的，并且每次使用它时都需要正确且唯一地设置，在这种情况下，您可以使用依赖注入来使您的代码更易于维护。

# c# - C# .NET Windows 窗体阻止/禁止在 Web 浏览器组件中上传文件

> ID：16172523
> 
> 赞同：0
> 
> 时间：2013-04-23T14:51:46.360
> 
> 标签：c#, .net, winforms, upload, browser

有没有办法阻止从组件网络浏览器（C#）访问的网站上传文件（任何文件）？我一直在尝试几种方法，但没有任何效果...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T19:08:47.370

我终于解决了这个问题！

解决方案是：隐藏对话框！我使用对象 id（窗口 id）来查找对话框。这是“阻止”任何对话框的唯一方法！

见下面的代码：

```
 // P/Invoke declarations
    [DllImport("user32.dll", SetLastError = true)]
    static extern IntPtr FindWindow(string id, string caption);

    [DllImport("user32.dll")]
    private static extern IntPtr SendMessage(IntPtr hWnd, int msg, IntPtr wp, IntPtr lp);

    public void Execute()
    {
        IntPtr hWnd = FindWindow("#32770", null);

        if (!hWnd.Equals(IntPtr.Zero))
        {
            SendMessage(hWnd, 0x0010, IntPtr.Zero, IntPtr.Zero);
        }
    } 
```

我希望这个解决方案可以帮助其他用户！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T11:59:16.397

我不知道有什么简单或困难的方法来实现这一点，因为在单击 html 输入文件字段时，MSHTML.dll 会自动调用 openFileDialog。没有任何接口、方法或属性可以以编程方式覆盖或阻止对话框打开。

我找到了一种我认为适用于这种情况的方法。您需要做的是通过“WebBrowser.Navigating”事件识别每个包含“Content-Type: multipart/form-data”的 HTTP 标头，因为每次文件即将从本地计算机流式传输到服务器。然后您可以立即取消数据流。

# http - 网络服务器响应 GET 请求可以返回的数据长度限制

> ID：16172524
> 
> 赞同：35
> 
> 时间：2013-04-23T14:51:48.033
> 
> 标签：http, rest, webserver, jetty

我在码头服务器上运行了一个**REST**服务，它使用一些资源数据响应**GET请求。**到目前为止，我检索的数据大约为几 kb。我希望使用一个类似的 REST 服务，它可能会返回大量数据，可能是 100 mb 或更多。由于请求量很低，并且码头服务器和休息客户端进程都已配置足够的内存，因此预计不会出现内存问题。

我想知道码头或任何网络服务器是否对它可以返回给客户端以响应 GET 的数据长度进行了限制。如果是这样，它可以在码头配置吗？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-04-23T15:10:17.583

**原答案：**

Jetty 的 HTTP 响应返回的数据量没有限制。

您可以将数据流式传输回客户端，直到[宇宙热寂](http://en.wikipedia.org/wiki/Heat_death_of_the_universe)前不久。

从技术上讲，你可以有一个没有`Content-Length`指定的 HTTP 响应，它可以使用[Chunked Transfer-Encoding](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)返回，或者只是一个原始的字节流，`Connection: close`在结束时指示数据何时完成（完成发送）底层连接。这两者本质上都是无限的。

如果您使用带有`Content-Length`标头的 HTTP 响应，请注意 Content-Length[实际上是一个 32 位数字，但更现代的浏览器支持 64 位版本](https://stackoverflow.com/questions/8811824/http-content-length-and-chunked-transfer-encoding-is-there-a-2gb-limit)。

**更新（2019 年 8 月）：**

Jetty 9.4.20.v20190813 现在可以处理`Content-Length`最大大小的标头[`Long.MAX_VALUE`](https://docs.oracle.com/javase/8/docs/api/java/lang/Long.html#MAX_VALUE)（[9,223,372,036,854,775,807](https://en.wikipedia.org/wiki/9,223,372,036,854,775,807)字节）

# javascript - Javascript 错误后缺少名称。变量函数运算符

> ID：16172526
> 
> 赞同：-1
> 
> 时间：2013-04-23T14:51:52.820
> 
> 标签：javascript, html, dom

我需要修复这个 javascript 错误，我有“变量上的 . 运算符后缺少名称”。这是我正在尝试使用的当前代码。

```
 <!DOCTYPE html>
<html>
<body onload="myFunction()">

<select>
    <option>1</option>
</select>
<br/>
<select>
    <option>1</option>
</select>

<script>
function myFunction()
{
    if(typeof document.body.ontouchstart == "undefined"){actionIn = "onmouseover"; actionOut = "onmouseout"}
    else{actionIn = "ontouchstart"; actionOut = "ontouchend";}

    var elem = document.getElementsByTagName("SELECT");
    for (var i = 0;i < elem.length; i++){
        elem[i].[actionIn] = function(){this.style.background='red';}
        elem[i].[actionOut] = function(){this.style.background='';}
    }
}
</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T14:52:55.357

使用[点](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Member_Operators#Dot_notation)*或* [括号表示法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Member_Operators#Bracket_notation)，而不是两者：

```
elem[i][actionIn] = function(){this.style.background='red';}
elem[i][actionOut] = function(){this.style.background='';} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T14:52:46.860

`.`两个方括号对之间不需要 a 。

`elem[i][actionIn]`和`elem[i][actionOut]`

应该足够了。

# mysql - MYSQL 使用另一个表中的参数更新表

> ID：16172527
> 
> 赞同：0
> 
> 时间：2013-04-23T14:51:58.790
> 
> 标签：mysql

我正在尝试使用另一个表中的 id 更新一个 void 字段，该字段具有第一个表中的 id 的字段：

用户：

*   id_user
*   一些字段
*   id_account

帐户：

*   id_account
*   id_user
*   一些字段

account 表中的 id_user 已经满了，但我想将 id_account 放到第一个表中，因为我有一些用户与某个帐户相关，但他们不是该帐户的所有者（如父母的帐户和孩子，链接到父母的帐户）。

来自帐户的 id_user 是该帐户的所有者。

关于如何做的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:05:29.283

如果一个人与多个账户相关（即，如果它为 2 个孩子开设了一个账户）怎么办？最好的解决方案是使用另一个表：

```
UserAccountUnrelated

id_user
id_account 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:09:13.223

我会说您的数据模型并不完全正确。如果用户和账户是一对一的关系，那么只需要在账户表上携带id_user，用户表上不需要id_account。

也就是说，根据您现在所拥有的，这应该会更新您的列：

```
update user u
set id_account = (select id_account from account a where a.id_user = u.id_user) 
```

# java - 使用 Jaxb / Jersey 将动态 JSON 对象映射到 Java POJO

> ID：16172529
> 
> 赞同：0
> 
> 时间：2013-04-23T14:52:01.810
> 
> 标签：java, json, jaxb, jersey, pojo

我想使用 Jaxb/Jersey 从 JSON-Response 映射到我的 Java 对象。我有这样的 Json 响应：

```
{
"fuzzy": false,
"hits": [
    { ... }
],
"filters": {
    "category": {
        "selected": false,
        "values": { }
        },
        "id": "category",
        "name": "Kategorie"
    },
    "shop": {
        "selected": false,
        "values": {
            "7817": {
                "count": 2,
                "selected": false,
                "numeric_sort_key": null,
                "id": "7817",
                "name": "AZUGA"
            }
        },
        "id": "shop",
        "name": "Shop"
    },
    "11223": {
        "selected": false,
        "values": { },
        "id": "certificate",
        "name": "Vertrauensgarantie"
    },
    "11334": {
        "selected": false,
        "values": {
            "2290": {
                "count": 1,
                "selected": false,
                "numeric_sort_key": null,
                "id": "2290",
                "name": "22.90"
            }
        },
        "id": "price",
        "name": "Preis"
    }
},
"total_hits": 2 
```

}

这是我想将 Json 响应映射到的 bean：

```
import java.util.List;

import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlRootElement;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

@XmlRootElement
public class RestBean {

    @XmlElement
    private String fuzzy;

    @XmlElement
    private List<HitsBean> hits;

    @XmlElement
    private Filters filters;

    @XmlElement
    private String total_hits;
} 
```

问题是，“过滤器”的子元素是动态的，这意味着无法提前知道子元素“11223”和“11334”的名称，因为它们是在运行时创建的。这是我的过滤器 bean：

```
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.xml.bind.annotation.XmlAccessType;
import javax.xml.bind.annotation.XmlAccessorType;
import javax.xml.bind.annotation.XmlAnyElement;
import javax.xml.bind.annotation.XmlElement;
import javax.xml.bind.annotation.XmlMixed;
import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement(name="filters")
@XmlAccessorType(XmlAccessType.FIELD)
public class Filters {

    @XmlElement
    private Filter category;

    @XmlElement
    private Filter shop;

    @XmlAnyElement
    @XmlMixed
    private List<Filter> filt;
} 
```

但是注释@XmlAnyElement 总是抛出这样的错误：

```
23.04.2013 16:26:11 com.sun.jersey.spi.container.ContainerResponse mapMappableContainerException
SCHWERWIEGEND: The RuntimeException could not be mapped to a response, re-throwing to the HTTP container
org.w3c.dom.DOMException: INVALID_CHARACTER_ERR: An invalid or illegal XML character is specified. 
at com.sun.org.apache.xerces.internal.dom.CoreDocumentImpl.checkQName(CoreDocumentImpl.java:2582)
at com.sun.org.apache.xerces.internal.dom.ElementNSImpl.setName(ElementNSImpl.java:117)
at com.sun.org.apache.xerces.internal.dom.ElementNSImpl.<init>(ElementNSImpl.java:80)
at com.sun.org.apache.xerces.internal.dom.CoreDocumentImpl.createElementNS(CoreDocumentImpl.java:2095)
at com.sun.org.apache.xalan.internal.xsltc.trax.SAX2DOM.startElement(SAX2DOM.java:164)
at com.sun.org.apache.xml.internal.serializer.ToXMLSAXHandler.closeStartTag(ToXMLSAXHandler.java:204)
at com.sun.org.apache.xml.internal.serializer.ToSAXHandler.flushPending(ToSAXHandler.java:277)
at com.sun.org.apache.xml.internal.serializer.ToXMLSAXHandler.startElement(ToXMLSAXHandler.java:646)
at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerHandlerImpl.startElement(TransformerHandlerImpl.java:263)
at com.sun.xml.internal.bind.v2.runtime.unmarshaller.DomLoader.startElement(DomLoader.java:107)
... 
```

我的问题是，我应该如何映射动态生成的 Json-Response，在这种情况下是“11223”和“11334”？非常感谢您提前。

问候， 苏帕诺

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:01:55.337

**使用杰克逊**映射器和`@JsonAnyGetter/@JsonAnySetter`（`org.codehaus.jackson.annotate`包）注释非常简单。
**类过滤器**（在这里使用 getter/setter 和默认 XmlAccessorType 很重要）

```
public class Filters {

    private Filter category;

    private Filter shop;

    private Map<String, Filter> filt = new HashMap<String, Filter>();  

    @JsonAnyGetter
    public Map<String, Filter> any() {
       return filt;
    }

    @JsonAnySetter
    public void set(String name, Filter value) {
        filt.put(name, value);
    }

    // getters/setters for category and shop  
} 
```

此外，不要`@XmlAccessorType(XmlAccessType.FIELD)`在所有类中使用序列化为 JSON。使用 getter/setter 对和默认访问器类型。

# javascript - 获取 column-index > 3 和 value > 6 的 td

> ID：16172534
> 
> 赞同：3
> 
> 时间：2013-04-23T14:52:19.297
> 
> 标签：javascript, jquery, html

我想`td`用`column-index>3`and获得`value>6`，我已经编写了代码来获得`td`with `column-index>3`：

```
$.extend($.expr[':'], {
            gtchild: function (elem) {
          var $elem = $(elem),
            $row = $elem.parent();
        return  $row.find("td").index($elem) > 3;
    }
}); 
```

我可以得到`td`类似`value>6`的

```
return $row.find("td").text()>6 
```

我如何将它们组合在一起？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T14:55:49.437

只需结合您的 2 个条件：

```
$.extend($.expr[':'], {
    gtchild: function (elem) {
        var $elem = $(elem),
            $row = $elem.parent();
        return $row.find("td").index($elem) > 3 && $elem.text() > 6;
    }
}); 
```

看到这个小提琴：http: [//jsfiddle.net/scaillerie/jjnUj/](http://jsfiddle.net/scaillerie/jjnUj/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:59:40.553

使用类似的东西

```
$row.children().slice(3).filter(function() {
    return parseInt($(this).text(), 10) > 6;
}); 
```

如果您有超过一排，请切换到`.find("td:nth-child(n+4)")`.

# c# - Visual Studio 2012 中的 SDK

> ID：16172538
> 
> 赞同：1
> 
> 时间：2013-04-23T14:52:23.790
> 
> 标签：c#, visual-studio-2012, sdk

我是 Visual Studio 的新手。我多年来一直在使用 Java 进行编码，但已经承担了一个需要我使用 c# 和 Visual Studio 2012 的项目。

我需要知道的是如何使用不同的 SDK。我想使用称为 Honeywell SDK 的东西，而不是 Visual Studios 固有的 SDK，但我无法找到更改此设置的位置。如果有人有答案，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:39:27.197

作为一名 Java 开发人员，您可能习惯于导入并且大概了解如何使用 import 语句来导入命名空间中的类。

在 C# 中，您必须做的第一件事是添加对包含所需方法的库的引用 - 这通常通过在解决方案资源管理器中右键单击您的项目，单击添加引用，然后选择浏览以浏览到该位置通常是一个包含相关库方法的 DLL。

添加对项目的引用后，您可以使用完全限定名称访问库中的类，例如访问 .NET 的 System.Threading 命名空间中的 Thread 类，完全限定使用如下：

```
System.Threading.Thread thread = new Thread(); 
```

或者，您可以将 using 指令放在您打算使用客户端的每个文件的顶部，以避免需要完全限定名称。例如：

```
using System.Threading; 
```

然后在代码中，您可以简单地单独使用类名的缩短版本：

```
Thread thread = new Thread(); 
```

如您所见， using 指令实际上是 C# 的 Java 的 import 指令等价物。请注意，要导入命名空间中的所有类，您不需要在 using 指令末尾使用 .* 通配符，因为您执行等效的 Java 导入语句。

在实践中，您可能需要参考必须确认他们使用哪些命名空间的文档，以及需要添加引用以使用他们的库的文件，因为此详细信息将是特定于供应商的。有关 using 指令的更多详细信息和更彻底的解释，那么 MSDN 文档可能是最有用的来源：

[http://msdn.microsoft.com/en-gb/library/sf0df423%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-gb/library/sf0df423%28v=vs.80%29.aspx)

和：

[http://msdn.microsoft.com/en-gb/library/z2kcy19k%28v=vs.80%29.aspx](http://msdn.microsoft.com/en-gb/library/z2kcy19k%28v=vs.80%29.aspx)

.NET 项目本身没有固有的 SDK，但通常会添加对 .NET 框架和默认使用指令的引用。您可能会发现这些很有用，因为它们包含核心功能，并且通常默认添加到新项目中的引用将为您提供对集合等内容的访问权限。

最后一点是，C# 有一个 using 语句以及 using 指令，因此如果搜索有关该指令的其他信息，请注意不要将其与 using 语句混淆。

# css - 在表单输入上设置外部边框样式

> ID：16172539
> 
> 赞同：0
> 
> 时间：2013-04-23T14:52:27.213
> 
> 标签：css

我希望有人能帮我回答这个问题，因为谷歌搜索数小时并没有结果。我目前有这个代码样式我的表单标签：

```
label {
    display:inline-block;
    height: 15px;
    width: 350px;
    float: left;
    padding: 5px;
    border-top: 1px solid black;
    color: black;
    font-size: 12px;
} 
```

我想为我的输入、文本区域和选择标签设置相同的边框顶部属性。但是，在这些元素上设置border-top 的样式很明显，即元素本身周围的边框。我想知道是否可以在外面显示边框，或者我是否需要使用其他属性来达到我想要的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:16:12.340

如果你的意思是边框看起来比你需要的简单

```
input {
   border: 0;
   border-top: 1px solid #333;
} 
```

如果你的字面意思是外面，那么你可以使用影子之类的东西来欺骗

[**演示**](http://jsfiddle.net/AwKyN/)

CSS

```
input {
    box-shadow: 0px -1px 1px -1px #333;
    border: none;
    margin: 50px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:09:17.957

如果你想在元素之外有一个边框，你需要在每个`input`, `textarea`or周围有一个块元素`select`（`div`如果没有元素在语义上相关）。这些块将接收边框，您可以调整表单元素和边框之间的`padding-top`距离`div`

这也有一个优点，即`border`on`div`比`border`表单元素得到更好的支持。

# c++ - C++ 运行时将 gif 转换为 png

> ID：16172542
> 
> 赞同：0
> 
> 时间：2013-04-23T14:52:40.790
> 
> 标签：c++, png, gif

尽管我发现了很多关于将 PNG 转换为各种语言和平台的 GIF 的知识，但有趣的是，使用 C++ 将 GIF 转换为 PNG 的东西很少。我正在使用 mimeTeX 渲染 GIF 图像，并希望使用[libharu](http://libharu.org/)[将](http://www.forkosh.com/mimetex.html)它们绘制到我的 PDF. 问题是 mimeTeX 不能渲染 PNG，libharu 也不能绘制 GIF。我对这两种格式的了解非常有限（只是我从官方 PNG 网站和维基百科阅读的一些基本内容），因此无法将 GIF 转换为 PNG。很抱歉，我无法向您展示我的尝试，因为我找不到起点。另请注意，所有图像都将在运行时创建。我可以使用任何适用于 Windows 7 的库；而且由于我的代码已经过于复杂，我真的不想让它变得更复杂。如果这项特定工作存在一个简单的技巧，我们将不胜感激。感谢那。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:04:35.233

ImageMagick 是要走的路；甚至还有一个 C++ 库：[http ://www.imagemagick.org/script/magick++.php](http://www.imagemagick.org/script/magick++.php)

# java - 为什么没有 UI 调用时出现 CalledFromWrongThreadException？

> ID：16172543
> 
> 赞同：0
> 
> 时间：2013-04-23T14:52:41.990
> 
> 标签：java, android, android-asynctask

我有一个`AsyncTask`调用 webservice 方法并将返回的数据发送回主线程。此任务不会影响任何 UI 元素，但会`CalledFromWrongThreadException`在调用行中引发`onResultSuccess`。我还有很多其他`AsyncTask`的工作方式基本完全相同，更改调用的 Web 服务方法和参数等，但这是唯一失败的。有人发现可能是什么问题吗？`AsyncTask`看起来像：

```
public static class ClockOff extends AsyncTask<String, Void, Void> 
{

public OnAsyncResultClockOff onAsyncResultClockOff;
public void setOnResultListener(OnAsyncResultClockOff onAsyncResultClockOff) {
    if(onAsyncResultClockOff != null) {
        ResultClockOff = onAsyncResultClockOff;
    }
}

private static final String SOAP_ACTION = "http://tempuri.org/ClockOff";
private static final String METHOD_NAME = "ClockOff";
private static final String NAMESPACE = "http://tempuri.org/";
private static final String URL = GlobalFunction.URL;
@Override
protected Void doInBackground(String... strArgs) 
{
    try
    {
        SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME);
         Request.addProperty("Items", strArgs[0]);
         Request.addProperty("ID", strArgs[1]);

         SoapSerializationEnvelope soapEnvelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
         soapEnvelope.dotNet = true;
         soapEnvelope.setOutputSoapObject(Request);
         HttpTransportSE transport= new HttpTransportSE(URL);
         transport.call(SOAP_ACTION, soapEnvelope);
         SoapObject result = (SoapObject) soapEnvelope.bodyIn;

         String ReturnMessage = ((SoapObject) result.getProperty(0)).getPropertyAsString(0);
         String ReturnMessageHeader = ((SoapObject) result.getProperty(0)).getPropertyAsString(1);
         String ActionType = ((SoapObject) result.getProperty(0)).getPropertyAsString(2);
         String SelectedCompleted = ((SoapObject) result.getProperty(0)).getPropertyAsString(3);
         String ClockOffItems = ((SoapObject) result.getProperty(0)).getPropertyAsString(4);

         //Exception thrown on the below line
         onAsyncResultClockOffItem.onResultSuccess(ReturnMessage, ReturnMessageHeader, ActionType, SelectedCompleted, ClockOffItems);
         return null;
    }
    catch (Exception e) 
    {
        onAsyncResultClockOffItem.onResultFail();
        return null;
    }
}
} 
```

`OnAsyncResultClockOff`很简单：

```
public interface OnAsyncResultClockOff {
    public abstract void onResultFail();
    public abstract void onResultSuccess(String returnMessage,
            String returnMessageHeader, String actionType,
            String selectedCompleted, String clockOffItems);
} 
```

它通过以下方式调用：

```
ClockOff co= new ClockOffItem();
co.setOnResultListener(onAsyncResultClockOff);
co.execute(items, ID); 
```

Where`onAsyncResultClockOff`实现了`OnResultFail()`和`OnResultSuccess`方法。

# angularjs - 使用 angularjs 重新加载列表

> ID：16172545
> 
> 赞同：1
> 
> 时间：2013-04-23T14:52:45.017
> 
> 标签：angularjs, reload

我刚开始玩 angularJS，所以也许我在问一些容易做的事情，但我找不到方法。情况如下：我有一个由 ng-repeat 填充的列表，该列表从作用域控制器变量中获取值。这个变量是通过 jsonp 调用在页面加载时加载的，这很好用。当我需要根据另一个选择重新加载此列表时，问题就来了。例如，如果在选择中选择“天”值，我需要显示一些值，而当我选择“周”时，我需要显示其他值（也通过 ajax 加载）。

我尝试过的是拥有一个加载数据并返回它的服务，并且在控制器中有两种方法，一种用于第一次加载，另一种用于使用变量执行 $scope.apply 的第二种方法。然后我在选择值更改时调用第二种方法（我已经用 jquery 完成了它以简化它，直到我可以解决这个问题）。

这是我的 HTML 的一部分

```
<div x-ng-controller='LeaderboardCtrl'>
    <select id='leaderboard-select'>
        <option value='day'>day</option>
        <option value='week'>week</option>
        <option value='month'>month</option>
    </select>
    <div x-ng-repeat='p in leaderboard'>
        <p>{{p}}</p>
    </div>
</div> 
```

这是影响此功能的代码的一部分

```
var lead = angular.module("lead",[]);

function LeaderboardCtrl($scope,$attrs,$http,jtlanService) {
    $scope.leaderboard = [];
    $scope.period = 'day';

    var data = {
        period:$scope.period
    };

    $scope.loadLeaderboard = function(){
        myService.loadLeaderboard(data).then(function(leaderboard) {
            $scope.leaderboard = [];
            $scope.leaderboard.push.apply($scope.leaderboard,leaderboard);
        });
    }

    $scope.reloadLeaderboard = function() {
        myService.loadLeaderboard(data).then(function(leaderboard) {
            $scope.$apply(function() {
                $scope.leaderboard = [];
                $scope.leaderboard.push.apply($scope.leaderboard,leaderboard);
            });
        });
    }

    $scope.loadLeaderboard()
}

lead.service("myService",["$http", function($http) {
    var myService = {
        loadLeaderboard : function(data) {
            var promise = $http.jsonp("/widget/leaderboardJSONP?callback=JSON_CALLBACK&_="+new Date(),{
                params:data,
                cache:false,
                ajaxOptions: { cache: false }
            }).then(function(response) {
                return response.data;
            });
            return promise;
        }
    };
    return myService;
}]);

$("#leaderboard-select").change(function(){
    scope.period = $("#leaderboard-select").val();
    scope.reloadLeaderboard();
}); 
```

这是一个代码：http: [//jsfiddle.net/WFGqN/3/](http://jsfiddle.net/WFGqN/3/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:34:50.783

你的小提琴充满了问题：

1.  `ng-app`您的标记中没有
2.  您需要将第二个 Framework Extensions 下拉列表更改为“No wrap”选项之一
3.  您的服务需要在您的控制器之上定义
4.  您的控制器正在引用“jtlanService”，但您已经定义了“myService”
5.  您的`$http.jsonp`呼叫不会按原样工作，但您可以使用可以使用 echo 服务（请参阅左侧的 Ajax 请求）来模拟请求
6.  您不能也不应该使用 jQuery 事件来调用 Angular 控制器。您应该使用`ng-change`而不是`$().change`（即使您使用 jQuery 进行事件绑定，您也应该使用`$().on('change')`）。
7.  您不需要`$scope.$apply`在`loadLeaderboard`函数中使用，因为当您调用它时，您已经在 $apply 调用中。
8.  不需要 2 种加载+重新加载排行榜方法。
9.  毕竟，您实际上并不需要 jQuery。

这是一个可以解决问题的小提琴，我认为可以满足您的需求：http: [//jsfiddle.net/WFGqN/5/](http://jsfiddle.net/WFGqN/5/)。您当然需要最终修复服务，但您明白了。

[如果我有 jQuery 背景，](https://stackoverflow.com/questions/14994391/how-do-i-think-in-angularjs-if-i-have-a-jquery-background)我建议阅读这个 SO 答案： “Thinking in AngularJS”？

# perl - 在 apache/unix 上使用 Perl 脚本的系统调用范围

> ID：16172549
> 
> 赞同：0
> 
> 时间：2013-04-23T14:52:50.320
> 
> 标签：perl, apache, unix

我有一个关于 unix/apache 会话范围的示例和问题。这是我正在使用的测试脚本：

```
#! /usr/bin/perl -I/gcne/etc 

$pid = $$;
system("mkdir -p /gcne/var/nick/hello.$pid");
chdir "/gcne/var/nick/hello.$pid";

$num = 3;
while($num--){

    system("> blah.$pid.$num");
    #sleep(5);
    system("sleep 5");
}
system("> blahDONE.$pid"); 
```

我注意到，如果我从 Web 浏览器调用此脚本 TWICE，它将按顺序执行这些请求 - 总共 30 秒。Perl/unix 如何处理并行执行和使用系统命令？使用系统调用时是否有可能出现跨会话问题？或者 apache 是否将这些服务器调用中的每一个都视为一个新的控制台会话进程？

在此示例中，我基本上是在尝试测试是否会在“错误的”PID 文件夹中创建不同的 PID 文件。

CentOS 发布 5.3 Apache/2.2.3 2009 年 7 月 14 日

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T09:56:07.237

如果您通过正常的 CGI 接口调用脚本，那么每次您请求网页时都会调用您的脚本。这意味着每次它获得一个新的进程 ID。基本上，对于 CGI 来说，Apache 和您的程序之间的接口是命令行参数、环境变量`STDOUT`和`STDERR`. 否则一切都是正常的命令调用。

当您使用 mod_perl 之类的机制时，情况会有所不同，但您似乎不使用此 ATM。

Apache 不进行任何同步，因此您可以期待`MaxClients`（参见 apache 文档）脚本的并行调用。

PS 来自 apache 和来自 shell 的调用之间的环境变量有点不同，但这与您的问题无关（但您可能想知道是否缺少例如 USER 或类似变量）。

另请参阅以获取更多信息：[http](http://httpd.apache.org/docs/2.4/howto/cgi.html) ://httpd.apache.org/docs/2.4/howto/cgi.html 特别是：[http ://httpd.apache.org/docs/2.4/howto/cgi.html#behindscenes](http://httpd.apache.org/docs/2.4/howto/cgi.html#behindscenes)

浏览器一次只能发出一个调用（用 firefox 测试），因此在测试时可能会出现请求被一个接一个地处理。这与服务器无关，而是由网络浏览器引起的。

# ember.js - ember-data 中的日期属性

> ID：16172553
> 
> 赞同：1
> 
> 时间：2013-04-23T14:52:55.387
> 
> 标签：ember.js, ember-data

如何告诉 ember-data 将 date attr 的值作为时间戳发送？目前它将通过 RESTAdapter 作为字符串以这种格式“2013 年 4 月 22 日 22:00:00 GMT”发送，而我的后端（带有杰克逊的播放框架）不想识别它

# wordpress - 如何在 wordpress 管理面板中编辑页面标题？

> ID：16172558
> 
> 赞同：0
> 
> 时间：2013-04-23T14:53:05.367
> 
> 标签：wordpress, wordpress-theming

我正在为自定义 wordpress 管理面板主题制作插件，我已经根据我的要求使用钩子更改了大部分内容，但我无法在 wordpress 的管理面板中更改页面标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T07:07:17.583

我正在尝试这个，这对我来说很好，任何人都有更好的解决方案

```
add_filter( 'gettext', 'change_post_to_article1' );
add_filter( 'ngettext', 'change_post_to_article1' );
function change_post_to_article1( $translated ) 
{  
   $translated = str_replace( 'Users', 'Customers', $translated );
   $translated = str_replace( 'Add New User', 'Add New Customer', $translated );
   return $translated;
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:47:45.967

我不确定你的管理面板怎么样，但你可以试试这个

```
array( "name" => "Heading",
    "desc" => "Select heading style",
    "id" => $shortname."_style",
    "type" => "select",
    "options" => array("heading.css", "heading2.css"),
    "std" => ""), 
```

heading.css 是您的设置文件。在这种情况下，您有一个或多个特殊的 css 文件，您可以在其中设置标题。

告诉我好不好！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T12:55:46.407

就像我说的，创建一个 Wordpres 主题管理面板并不容易，但它们是互联网上的很多教程。经过几天的搜索，我终于创建了主题管理面板。

我将分享这个：

[http://5wpthemes.com/blog/how-to-create-a-wordpress-theme-admin-panel/](http://5wpthemes.com/blog/how-to-create-a-wordpress-theme-admin-panel/)

# ruby-on-rails - 邮件程序的 Rails delay_job 参数错误

> ID：16172562
> 
> 赞同：0
> 
> 时间：2013-04-23T14:53:11.180
> 
> 标签：ruby-on-rails, heroku, actionmailer, delayed-job

当我尝试将邮件发送到delayed_job 时，我收到“错误数量的参数（2 对1）”错误。如果我不尝试将其推到后台，一切都会完美。下面是我的带延迟作业的控制器：

```
def export
  @user = User.where("id = ?", params[:user_id])

  @logs = VehicleMileage.export_logs(params, @user)

  if @logs['log_count'] > 0
    ExportLogsMailer.delay.email_logs(@user, @logs['sending_to'])
  end

  respond_to do |format|
    formats # index.html.erb
    format.json { render json: @logs }
  end
end 
```

当我`ExportLogsMailer.email_logs(@user, @logs['sending_to']).deliver`的邮件工作正常。我正在使用`gem 'delayed_job_active_record'`and `gem 'rails', '3.2.13'`。

下面是 ExportLogsMailer 的样子：

```
class ExportLogsMailer < ActionMailer::Base
default :from => "support@myconsultantapp.com"

def email_logs(user, emails)

    # make sure emails are unique
    emails.uniq

    first_name = user[0].first_name
    last_name = user[0].last_name

    # encoded_content =  Base64.strict_encode64(File.read("#{Rails.root}/tmp/test.xls"))
    # puts encoded_content
    # attachments['test.xls'] = { :content => encoded_content,
    #                           :encoding => 'Base64'
    #                         }

    # Name of template in your Mandrill template area
    headers['X-MC-Template'] = 'Export Logs' 

    # Tags help classify your messages
    headers['X-MC-Tags'] = 'mileage logs' 

    # Enable open or click-tracking for the message.
    # Only can track to at a time. Possibilies: opens, clicks, clicks_htmlonly, clicks_textonly
    headers['X-MC-Track'] = 'opens, clicks' 

    # Automatically generate a plain-text version of the email from the HTML content.
    headers['X-MC-Autotext'] = 'true'   

    # Add dynamic data to replace mergetags that appear in your message content. Should be a JSON-formatted 
    # object and flat, so if you more than one recipient then add another X-MC-MergeVars to the header.  The
    # below example will change anywhere where *|FNAME|* or *|LNAME|* to the respective value.
    mergeVars = 
    { 
        "fname"             => first_name,
        "lname"             => last_name
    }
    headers['X-MC-MergeVars'] = mergeVars.to_json

    # Add Google Analytics tracking to links in your email for the specified domains.
    headers['X-MC-GoogleAnalytics'] = 'http://www.myconsultantapp.com/' 

    # Add an optional value to be used for the utm_campaign parameter in Google Analytics tracked links.
    # headers['X-MC-GoogleAnalyticsCampaign'] = '' 

    # Information about any custom fields or data you want to append to the message.
    # Up to 200 bytes of JSON-encoded data as an object. The object should be flat; nested object structures are not supported.
    # headers['X-MC-Metadata'] = ''  

    # Whether to strip querystrings from links for reporting. "true" or "false"
    # headers['X-MC-URLStripQS'] = 'true' 

    # Whether to show recipients of the email other recipients, such as those in the "cc" field. "true" or "false"
    headers['X-MC-PreserveRecipients'] = 'false' 

    message = prepare_message   :subject => "1 myConsultant logs",
         :to      => emails,
         :content_type => "multipart/mixed"

    message.alternative_content_types_with_attachment(
        :text => 'text',
        :html => 'html'
    ) do |i|
        i.inline['test.xls'] = File.read("#{Rails.root}/tmp/test.xls")
    end

    message
end 
```

结尾

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:30:56.310

您是否尝试仅检索一个用户？然后做：

```
@user = User.find(params[:user_id]) 
```

否则，如果您尝试将对象数组传递给delayed_job，我认为您需要`all`在最后添加：

```
@objects = Model.where(...).all 
```

# html - 如何在 SoundCloud Mini HTML5 播放器中更改元素颜色

> ID：16172567
> 
> 赞同：1
> 
> 时间：2013-04-23T14:53:23.857
> 
> 标签：html, parameters, widget, soundcloud

我们在我们的网站上嵌入了 SoundCloud HTML5 迷你播放器。我们正在尝试更改玩家元素的颜色，但没有成功。有没有办法改变 BG 颜色和文本颜色以适应我们网站的调色板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-22T10:12:42.670

这只是一半的答案。您需要将播放器的视觉标签设置为 false。从 2015 年 4 月起，您无法更改背景。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:55:00.643

`color`您可以在嵌入小部件时提供参数：

```
https://w.soundcloud.com/player/?url=http://api.soundcloud.com/tracks/6981096&color=2b877f 
```

这将使小部件以提供的颜色为主题。

如果您想要更多自定义，您需要使用[SoundManager2](http://www.schillmania.com/projects/soundmanager2/)或[Audio5JS](http://zohararad.github.com/audio5js/)等库构建自定义播放器，或者使用[SoundCloud JavaScript SDK](http://developers.soundcloud.com/docs/api/sdks)来播放来自 SoundCloud 的声音。

我希望这有帮助！

# java - 程序化 Joda 时间格式化程序

> ID：16172568
> 
> 赞同：1
> 
> 时间：2013-04-23T14:53:24.090
> 
> 标签：java, jodatime

我正在尝试创建一个 Joda 2.2`DateTimeFormatter`来重构我的代码。我试图重现的行为是

```
private String getSemesterLabel() {
    StringBuilder sb = new StringBuilder(date.toString("yyyy"));
    if (date.getMonthOfYear() < 7) {
        sb.insert(0, "first semester ");
    } else {
        sb.insert(0, "second semester ");
    }
    return sb.toString();
} 
```

获得`DateTimeFormatter`封装上述行为的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:20:52.830

您无法使用内置模式符号打印学期信息（请参阅[错误报告中的类似问题](http://sourceforge.net/p/joda-time/discussion/337835/thread/79259c3c/)）。你有两个选择：

1.  **从头开始构建逻辑**

    您可以`DateTimeFormatter`使用`DateTimeFormat`类中的静态方法生成实例：

    ```
    DateTimeFormatter format = DateTimeFormat.forPattern("yyyy"); 
    ```

    `DateTime`您还可以通过调用以下方式从 Joda 检索一年中的月份：

    ```
    myDateTime.monthOfYear().get(); 
    ```

2.  **用于`DateTimeFormatterBuilder`构造格式化程序**

    另一种方法可能是用于[`DateTimeFormatterBuilder`](http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimeFormatterBuilder.html)构建`DateTimeFormatter`显示您喜欢的文本的自定义。就像是：

    ```
    DateTimeFormatterBuilder builder = new DateTimeFormatterBuilder();
    builder.append(DateTimeFormat.forPattern("yyyy"));
    builder.appendLiteral(' ');
    builder.append(new SemesterPrinter());
    return builder.toFormatter(); 
    ```

    `SemesterPrinter`需要在哪里实施[`DateTimePrinter`](http://joda-time.sourceforge.net/apidocs/org/joda/time/format/DateTimePrinter.html)并负责生成文本`first semester`或`second semester`根据提供的日期信息..

# cuda - 启用 cuda 的 nvidia GPU 比较

> ID：16172569
> 
> 赞同：0
> 
> 时间：2013-04-23T14:53:33.640
> 
> 标签：cuda, gpu, nvidia

我想提出一个关于 Nvidia 卡的计算能力的理论问题。根据我相对较短的经验，我注意到带有 CC 2.0 的卡可以比 1.3 的卡执行得更好。这可能真的取决于内核的性质和每个 SM 将使用的占用率。

但是既然一切都有其优点和缺点，那么2.0卡的缺点和1.3的优点是什么？

1.3 卡如何能够比 2.0 更快地执行某个内核，以及该内核应该具有哪些特性。

任何个人经验都被很好地接受，如果通过每张卡的架构有完整的解释就更好了。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:02:40.920

一般来说，计算能力越高，GPU的能力就越多。 [查看维基百科](http://en.wikipedia.org/wiki/CUDA#Version_features_and_specifications)

当然，如果您为 CC 为 3.5 的 GPU 编写糟糕的代码，而为 CC 为 2.0 的 GPU 编写出色的代码，则 2.0 的 GPU*可以*胜过 3.5 的 GPU。

# javascript - 使用javascript从excel电子表格中读取数据的最简单方法？

> ID：16172572
> 
> 赞同：10
> 
> 时间：2013-04-23T14:53:46.363
> 
> 标签：javascript, excel

我在 Excel 电子表格中有一个机场代码、名称和位置列表，如下所示：

```
+-------+----------------------------------------+-------------------+
|  Code |               Airport Name             |      Location     |
+-------+----------------------------------------+-------------------+
|  AUA  |   Queen Beatrix International Airport  |  Oranjestad, Aruba|
+-------+----------------------------------------+-------------------+ 
```

我的 Javascript 传递了一个应该是航空公司代码的 3 个字符串。发生这种情况时，我需要在电子表格上找到代码并返回机场名称和位置。

我在想这样的事情：

```
var code = "AUA";

console.log(getAirportInfo(code));

function getAirportInfo(code) {

// get information from spreadsheet
//format info (no help needed there)

return airportInfo;
} 
```

日志将写出的位置：

`Oranjestad, Aruba (AUA): Queen Beatrix International Airport`

从电子表格中获取所需数据的最简单方法是什么？

**额外信息：**

1.  该电子表格有超过 17,000 个条目
2.  上面提到的函数最多可以连续调用 8 次
3.  **我不必使用我现在拥有的 Excel 电子表格**
4.  我永远不需要用我的代码编辑电子表格

我确实在网上搜索过，但我能找到的一切都比我试图做的要复杂得多，所以很难理解我在寻找什么。

感谢您为我指明正确方向的任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-17T02:01:06.013

I ended up using a tool at shancarter.com/data_converter to convert my flie to a JSON file and linked that to my page. Now I just loop through that JSON object to get what I need. This seemed like the simplest way for my particular needs.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T15:10:19.383

我使用的是纯文本文件（csv 或 tsv 都可以直接从 Excel 导出）

通过 xmlhttprequest 将其加载到字符串 var 中。通常，浏览器缓存将不再需要在每次页面加载时下载文件。

然后让正则表达式根据需要解析出这些值。

所有这些都没有使用任何第三方......如果你愿意，我可以挖掘代码。

示例：您需要将 data.txt 文件放在与此页面相同的 Web 文件夹中，或者更新路径...

```
 <html>
      <head>
        <script>

          var fileName = "data.txt";
          var data = "";

          req = new XMLHttpRequest();
          req.open("GET", fileName, false);

          req.addEventListener("readystatechange", function (e) {
            data = req.responseText ;
          });

          req.send();

          function getInfoByCode(c){
            if( data == "" ){
              return 'DataNotReady' ;
            } else {
              var rx = new RegExp( "^(" + c + ")\\s+\\|\\s+(.+)\\s+\\|\\s+\\s+(.+)\\|", 'm' ) ;

              var values = data.match(rx,'m');
              return { airport:values[2] , city:values[3] };
            }
          }

          function clickButton(){
            var e = document.getElementById("code");
            var ret = getInfoByCode(e.value);

            var res = document.getElementById("res");

            res.innerText = "Airport:" + ret.airport + " in " + ret.city;

          }

        </script>
       </head>
       <body>
        <input id="code" value="AUA">
        <button onclick="clickButton();">Find</button>
        <div id="res">
        </div>

       </body>
    </html> 
```

# php - 无法验证答案

> ID：16172577
> 
> 赞同：0
> 
> 时间：2013-04-23T14:54:03.253
> 
> 标签：php

我有一个包含文本字段的表单。当用户提交数据时，它会根据表格中的“答案”列检查输入的数据是否正确。

但这是问题所在 - 它接受任何内容，而无需根据正确答案验证提交的文本字段。

我是php新手，所以请帮忙。这是代码。

```
 $myuser = $_SESSION["myusername"]; $mypass = $_SESSION["mypassword"];
 $host="localhost"; // Host name 
 $username="f123"; // Mysql username
 $password="t"; // Mysql password 
 $db_name="f"; // Database name 
 $tbl_name="members"; // Table name 
 $tbl_name2="quiz"; // Table name 2

mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

if(isset($_POST['qno']))
{
$sql3="SELECT * FROM $tbl_name2 WHERE id='".$_POST['qno']."'";
$result3=mysql_query($sql3);

$disp3=mysql_fetch_assoc($result3);

$sql4="SELECT * FROM $tbl_name WHERE username='$myuser' and password='$mypass'";
$result4=mysql_query($sql4);

$disp4=mysql_fetch_assoc($result4);

if($disp3['Answer']==$_POST['Answer'])
{

$sql5="UPDATE $tbl_name SET level_crossed='".($disp4['level_crossed']+1)."',
Score='".($disp4 ['Score']+1)."' WHERE username='$myuser' and password='$mypass'";
 $result5=mysql_query($sql5);
}
else {
$sql5="UPDATE $tbl_name SET level_crossed='".($disp4['level_crossed']+1)."' 
WHERE    username='$myuser' and password='$mypass'";
$result5=mysql_query($sql5);

<form name="quizq" action="quiz.php" method="post" >
<input name="qno" type="hidden" value="<?php echo $disp['level_crossed']+1; ?>" />
<input type="text"  name="Answer"  />
<input type="submit" value="Submit Answer" /></p>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:08:09.047

自己调试就好了。`$disp3['Answer']==$_POST['Answer']`添加前

```
var_dump($disp3);
var_dump($_POST); 
```

`Answer`检查两个数组中是否有任何内容。如果不这样做，请检查您的数据库字段名称和您的 POST 字段/输入（两者都区分大小写）

我还要补充一点，您需要检查 SQL 注入并转义您的字段，或者更好的是，使用 PDO 和准备好的语句。

# c# - C# - SignalR 如何删除我的事件处理程序

> ID：16172578
> 
> 赞同：4
> 
> 时间：2013-04-23T14:54:10.300
> 
> 标签：c#, delegates, xamarin.ios, signalr, xamarin

我是一个 C# 新手，试图在我的 Xamarin IOS 应用程序中实现 SignalR。

我的代码很简单：

```
 _connection = new Microsoft.AspNet.SignalR.Client.Hubs.HubConnection (Common.signalRAddress);

feedHub = _connection.CreateHubProxy ("feedHub");

_connection.Received += data =>  { OnReceiveData (data); };

_connection.Start (); 
```

我的问题是如何删除我的代表？写够了吗？

```
_connection.Received -= data =>  { OnReceiveData (data); }; 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-23T18:13:23.013

您正在使用集线器，为什么不使用内置的 on/off 进行方法调用？

又名：

```
var doSomething = feeHub.On<int>("doSomething", val => {
    // Do something with int val
}); 
```

然后要删除它，您可以执行以下操作：

```
doSomething.Dispose(); 
```

如果您真的想收听流经集线器的所有数据，那么使用 Received 是正确的方法，@Dracanus 的答案将起作用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T15:08:31.570

我可能是错的，但如果你这样做，它实际上不会取消订阅该事件。

无论如何，它并没有出现在我编写的一个小测试应用程序中。

而是创建一个函数，例如

```
void Connection_Recieved(string obj)
{
} 
```

并做 connection.Recieved += Connection_Recieved; 和 connection.Recieved -= Connection_Recieved;

我不认为匿名事件函数是去这里的方式:)

我假设，看看你可以做的代码示例，

```
 connection.Recieved += OnReceiveData;
   connection.Recieved -= OnReceiveData; 
```

# c# - 如果它为空或为空，如何从序列化中忽略可为空的属性？

> ID：16172581
> 
> 赞同：5
> 
> 时间：2013-04-23T14:54:14.527
> 
> 标签：c#, asp.net, xml, serialization

我有一个用于 Xml 序列化的类。

在其中我有一个用 XmlAttribute 装饰的可为空的属性：

```
 [XmlAttribute("lastUpdated")]
 public DateTime? LastUpdated { get; set; } 
```

如果属性为空或为空，如何从序列化中忽略该属性？

我已经尝试过以下方法，但是当有值时它不会序列化（总是忽略）：

```
 [XmlIgnore]
        public DateTime? LastUpdatedValue { get; set; }

        [XmlAttribute("lastUpdated")]
       public DateTime LastUpdated { get; set; }

        public bool ShouldSerializeLastUpdated()
        {
            return LastUpdatedValue.HasValue;
        } 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-23T15:40:08.180

XmlSerialization 不直接支持 Nullable。

如果要使用可为空的属性，则必须使用不可为空的属性并添加一个与属性同名的布尔属性，后缀为“指定”，指定何时该属性必须是可序列化的。

您的案例示例：

```
 private DateTime? _lastUpdated;

    [XmlAttribute("lastUpdated")]
    public DateTime LastUpdated {
        get {
            return (DateTime)_lastUpdated;
        }
        set
        {
            _lastUpdated = value;
        }
    }

    public bool LastUpdatedSpecified
    {
        get
        {
            return _lastUpdated.HasValue;
        }
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-06-03T17:58:13.363

我知道这个话题很老了。这是我带来的解决方案。封装类型的类，并隐式转换为类型。序列化时，成员变量可以用**IsNullable = false**标记，不会出现编译器错误，并且在为空时阻止它被序列化。

```
public class Optional<T> where T : struct, IComparable
{
    public Optional(T valueObject)
    {
        Value = valueObject;
    }

    public Optional()
    {
    }

    [XmlText]
    public T Value { get; set; }

    public static implicit operator T(Optional<T> objectToCast)
    {
        return objectToCast.Value;
    }

    public static implicit operator Optional<T>(T objectToCast)
    {
        return new Optional<T>(objectToCast);
    }
} 
```

然后在你的课堂上使用它

```
[Serializable]
[XmlRoot(ElementName = "foo")]
public class foo
{
   [XmlElement(ElementName = "myInteger", isNullable = false)]
   Optional<int> myInt;
} 
```

你可以做类似的事情

```
 myFoo.myInt = 7;
        int j = 8 + myFoo.myInt; 
```

出于所有目的，它是一个 int。出于序列化目的，它可以为 null 并阻止被序列化。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-07-29T06:15:29.040

这对我有用。

```
 [XmlIgnore]
    public float? Speed { get; set; }

    [XmlAttribute("Speed")]
    public float SpeedSerializable
    {
        get
        {
            return this.Speed.Value;
        }
        set { this.Speed = value; }
    }

    public bool ShouldSerializeSpeedSerializable()
    {
          return Speed.HasValue;
    } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-12-18T08:02:51.717

您可以使用**[XmlElementAttribute.IsNullable](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlelementattribute.isnullable.aspx)**：

```
[Serializable]
public class Result
{
    [XmlElement(IsNullable = true)]
    public DateTime? LastUpdated  { get; set; }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-10-25T08:41:30.153

注意：这肯定适用于 WCF 中的 SOAP 合同。我没有在其他 Xml 序列化场景中测试过。

使用`[DataContract]`时可以使用

`[DataMember(EmitDefaultValue = false)]`

*   对于 a`boolean`它只会在它是 时发出值`true`。
*   对于 a`nullable boolean`它只有在不是 时才会发出`null`。
*   对于 a`string`它只会在不是时发出值`null`。
*   对于 an`int`它只会在不是时发出值`0`。

等等

确保将`[DataContract]`类本身和`[DataMember]`您想要序列化的所有成员都放在上面，无论您是否指定`EmitDefaultValue`。

> 不建议将 EmitDefaultValue 属性设置为 false。只有在有特殊需要时才应该这样做（例如为了互操作性或减少数据大小）。

[https://msdn.microsoft.com/en-us/library/system.runtime.serialization.datamemberattribute.emitdefaultvalue(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/system.runtime.serialization.datamemberattribute.emitdefaultvalue(v=vs.110).aspx)

# sql - SQL嵌套案例 - 快捷逻辑？

> ID：16172582
> 
> 赞同：1
> 
> 时间：2013-04-23T14:54:16.653
> 
> 标签：sql, logic, case, shortcut

我试图摆脱我所有的动态 SQL 代码。这个存储过程似乎需要一些带有 WHERE 子句的嵌套 CASE 语句。这按预期工作。但是，我担心性能。如果父 CASE 语句不正确，是否会执行嵌套的 ( GuarantorNumber not in ( select... ) ) 语句？

```
WHERE 1 = CASE WHEN ( @method='ADDED_RECORDS' ) THEN
      CASE WHEN 
        ( pt.[GuarantorNumber] not in (select cpg.GuarantorNumber from [CorepointProtectedGuarantor] cpg) ) THEN
          1
          ELSE 0 END -- NEW_RECORDS

       WHEN ( @method='DELETED_RECORDS' ) THEN
      CASE WHEN 
        ( pt.[GuarantorNumber] not in (select mpg.GuarantorNumber from [MeditechProtectedGuarantor] mpg) ) THEN
          1
          ELSE 0 END -- DELETED_RECORDS

       WHEN ( @method='UPDATED_RECORDS' ) THEN
      CASE WHEN 
        ( pt.[GuarantorNumber] in 
            (SELECT mpg.GuarantorNumber FROM 
                  [MeditechProtectedGuarantor] mpg, 
                  [CorepointProtectedGuarantor] cpg 
            WHERE 
                  mpg.GuarantorNumber = cpg.GuarantorNumber and
                  (mpg.[LastName] <> cpg.[LastName] OR 
                        mpg.[FirstName] <> cpg.[FirstName] OR 
                        mpg.[MiddleName] <> cpg.[MiddleName] OR 
                        mpg.[Address] <> cpg.[Address] OR 
                        mpg.[AddressLine2] <> cpg.[AddressLine2] OR 
                        mpg.[City] <> cpg.[City] OR 
                        mpg.[State] <> cpg.[State] OR 
                        mpg.[ZIP] <> cpg.[ZIP] OR 
                        mpg.[Phone] <> cpg.[Phone])

            ) -- end of SELECT clause
            ) -- end of WHEN clause 
            THEN
          1
          ELSE 0 END -- UPDATED_RECORDS 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T12:01:17.617

```
Declare @query nvarchar(max) 

Declare @selectoneCount int

Declare @Temp int

SET @Temp =1

Declare @val nvarchar(max)

SET @val =''

select 
       @query = case @Temp

       when 1 

       then       
          case @val

          when 'NULL'

          then
            ('Select Diameter from BallsProbes where Remark =2') 

          else
            ('Select Diameter from BallsProbes where Remark =3')   
            END 
       when 2 
       then ('Select Diameter from BallsProbes where Remark =6')
       end

EXEC(@query) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T16:47:44.877

搜索到的 CASE 表达式：

*   返回计算结果为 TRUE 的第一个 input_expression = when_expression 的 result_expression。

在您的情况下，如果 @method='ADDED_RECORDS' 和 @method='DELETED_RECORDS' 为假，那么将在 SQLServer2008 中执行下一条语句 WHEN(@method='UPDATED_RECORDS') 以通过按 Cntl+L 来分析此行为。

# mysql - MySQL按百分比排名计算分数

> ID：16172583
> 
> 赞同：-1
> 
> 时间：2013-04-23T14:54:21.590
> 
> 标签：mysql

我正在使用 MYSQL 创建一个评级系统来实现我的数据库。我想要做的是通过一些计算按百分比对每个属性进行评分。这是示例数据库：

```
| ID | VALUE1 | VALUE2| 
-----------------------
|  2 |      5 |    20 | 
|  4 |      5 |    30 | 
|  1 |      3 |     5 | 
|  3 |      2 |     8 | 
```

这是我需要的理想输出：

```
| ID | VALUE1 | RANK1 | Score1 | VALUE2 | RANK2 | Score2 |
---------------------------------------------------------
|  2 |      5 |     1 |     10 |     20 |      2|     8.3|
|  4 |      5 |     1 |     10 |     30 |      1|      10|
|  1 |      3 |     2 |     7.5|      5 |      4|       5|
|  3 |      2 |     3 |      5 |      8 |      3|     6.6| 
```

分数计算公式为

```
5+5*(MaxRank-rank)/(MaxRank-MinRank) 
```

如何生成像表格一样的多个排名？我努力了

```
SELECT
    @min_rank := 1 AS min_rank
  , @max_rank1 := (SELECT COUNT(DISTINCT value1) FROM table) AS max_rank1
  , @max_rank2 := (SELECT COUNT(DISTINCT value2) FROM table) AS max_rank2
  ;
SELECT
    ID
  , R1
  , TRUNCATE(5.0+5.0 * (@max_rank1 - R1) / (@max_rank1 - @min_rank), 2) AS Score1
  , R2
  , TRUNCATE(5.0+5.0 * (@max_rank2 - R2) / (@max_rank2 - @min_rank), 2) AS Score2
FROM (
  SELECT
      ID
    , value1
    , FIND_IN_SET( `value1`, (SELECT GROUP_CONCAT(DISTINCT `value1` ORDER BY `value1` DESC) FROM table)) AS R1
    , value2
    , FIND_IN_SET( `value2`, (SELECT GROUP_CONCAT(DISTINCT `value2` ORDER BY `value2` DESC) FROM table)) AS R2
  FROM table
) ranked_table; 
```

它适用于低于 170 的排名。我的数据库对某些值有大约 200+ 的排名，当它返回时，排名大于 170 将被视为 0。在这种情况下，排名 >170 的分数将被错误计算。感谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:14:09.217

这看起来很难计算。

像这样的事情可能会做到

```
SELECT a.ID, a.VALUE1, Sub1.Rank1, (5.0+5.0 * (Sub3.MaxRank1 - Sub1.Rank1) / (Sub3.MaxRank1 - 1)) AS Score1, a.VALUE2, Sub2.Rank2, (5.0+5.0 * (Sub4.MaxRank2 - Sub2.Rank2) / (Sub4.MaxRank2 - 1)) AS Score2
FROM TestTable a
INNER JOIN (SELECT DISTINCT z.VALUE1, (SELECT ((COUNT(DISTINCT VALUE1) + 1)) FROM TestTable y WHERE z.VALUE1 < y.VALUE1)  AS RANK1
FROM TestTable z
) Sub1 ON a.VALUE1 = Sub1.VALUE1
INNER JOIN (SELECT DISTINCT z.VALUE2, (SELECT ((COUNT(DISTINCT VALUE2) + 1)) FROM TestTable y WHERE z.VALUE2 < y.VALUE2)  AS RANK2
FROM TestTable z
) Sub2 ON a.VALUE2 = Sub2.VALUE2
CROSS JOIN (SELECT COUNT(*) + 1 AS MaxRank1 FROM TestTable CROSS JOIN (SELECT MAX(VALUE1) AS MaxValue1 FROM TestTable) Sub3a WHERE VALUE1 < MaxValue1) Sub3
CROSS JOIN (SELECT COUNT(*) + 1 AS MaxRank2 FROM TestTable CROSS JOIN (SELECT MAX(VALUE2) AS MaxValue2 FROM TestTable) Sub4a WHERE VALUE2 < MaxValue2) Sub4 
```

注意我不确定你的分数计算。在我看来，您给出的方程式并没有给出您示例中的结果。但我可能只是误读了它。

# mysql - mysql每组几列排名

> ID：16172588
> 
> 赞同：0
> 
> 时间：2013-04-23T14:54:39.070
> 
> 标签：mysql

我有这种格式的表格数据

```
studno  name    level   year   term  subject1  subject2  subject3 
212    victor     l1    2000    1      45        56        80
213     HOM       l1    2000    1      42        56        70
214     ken       l1    2000    1      60        70        50
215    ted        l1    2000    1      46        36        47
212    victor     l1    2000    2      45        36        68
213    Hom        l1    2000    2      38        78        49
214    ken        l1    2000    2      38        34        62 
```

我想要的输出如下

```
studno  name    level   year   term  subject1 sub1rank subject2  sub2rank 
213    victor     l1    2000    1      42        3       56        2 
214    HOM        l1    2000    1      60        1       70        1 
215    TED        l1    2000    1      46        2        36       3 
212   victor      l1    2000    2      45      2           36      1  
213    hOM        l1    2000    2      38      3           36      1  
214    KEN        l1    2000    2      38      3           32      3  
215    TED        l1    2000    2      90      1           30      4 
```

我已经设法获得排名，但问题是如何获得每年、级别、学期和学科的排名。另一个问题是，如果我使用嵌套语句并尝试在 mysql 数据库中创建视图，则会引发错误，“视图的 SELECT 包含 FROM 子句中的子查询”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:16:34.420

You can do this with correlated subqueries in the `select` clause. If I understand correctly, something like this:

```
select t.*,
       (select COUNT(distinct t1.subject1)
        from t t2
        where t2.level = t.level and t2.year = t.year and t2.term = t.term and
              t2.subject1 >= t.subject1
       ) as subj1rank,
       (select COUNT(distinct t2.subject2)
        from t t2
        where t2.level = t.level and t2.year = t.year and t2.term = t.term and
              t2.subject2 >= t.subject2
       ) as subj2rank
from t 
```

The `count(*)` might be `count(distinct subject1)` (etc.), depending on how you treat ties.

# html - Twitter Bootstrap 模式不适用于 MVC3

> ID：16172604
> 
> 赞同：0
> 
> 时间：2013-04-23T14:55:29.387
> 
> 标签：html, asp.net-mvc-3, model-view-controller, twitter-bootstrap, modal-dialog

我正在尝试在我的 MVC3 应用程序中实现一个模式对话框。现在我只是在摆弄它。这是我的代码：

```
@model AROrdering.Models.Category 
@{
    ViewBag.Title = "Browse";
    Layout = null;
}
<html>
<head>
<title>test</title>
<link href="@Url.Content("~/Content/testbootstrap.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/testbootstrap.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/testjquery-1.9.1.js")" type="text/javascript"></script>
<script>
    $(document).ready(function () {
        $('#showGame').click(function () {
            $('#gameModal').modal('show');
        });
    });
</script>
</head>
<body>
<div class="container">
    <div id="gameModal" class="modal hide fade in">
        <div class="modal-header">
            <a class="close" data-dismiss="modal">×</a>
            <h3>This is a Modal Heading</h3>
        </div>
        <div class="modal-body">
            <h4>Text in a modal</h4>
            <p>You can add some text here.</p>
        </div>
        <div class="modal-footer">
            <a href="#" class="btn btn-primary">Call to action</a>
            <a href="#" class="btn" data-dismiss="modal">Close</a>
        </div>
    </div>
    <button id="showGame" class="btn btn-primary btn-large">Show Game Listing</button>
</div>
</body>
</html> 
```

如果我在应用程序外部的纯 html 页面中实现这个精确的 html，模式对话框就可以工作。但是当我将代码移过来时，它不会。我正在使用相同的 css 和 javascript 文件。有谁知道为什么当我转移到 MVC3 时会中断？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T14:56:41.327

jQuery 需要在引导 javascript 之前加载。修复脚本引用的顺序，它应该可以工作。

# python - 从 PYTHON 中的 SQLCMD 获取错误消息

> ID：16172607
> 
> 赞同：1
> 
> 时间：2013-04-23T14:55:32.267
> 
> 标签：python, subprocess, sqlcmd

我真的很亲近。这给出了查询的输出，但我只需要检索错误消息。我觉得稍微调整一下就可以了...

```
import subprocess

command_process = subprocess.Popen(
    ['sqlcmd', '-E', '-V1', '-S', '1070854A\AISP', '-i', 'NewStructures.sql'],
    shell=True,
    stdin=subprocess.PIPE,
    stdout=subprocess.PIPE,
    stderr=subprocess.STDOUT,
)
command_output = command_process.communicate()[0]

print command_output 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:33:01.260

像这样的东西？

```
import subprocess

command_process = subprocess.Popen(
    ['sqlcmd', '-E', '-V1', '-S', '1070854A\AISP', '-i', 'NewStructures.sql'],
    shell=True,
    stdin=subprocess.PIPE,
    stdout=subprocess.PIPE,
    stderr=subprocess.PIPE,
)
command_output = command_process.communicate()[0]

print command_process.stderr.read() 
```

# string - 每个控制变量必须是变量或对象

> ID：16172608
> 
> 赞同：6
> 
> 时间：2013-04-23T14:55:33.207
> 
> 标签：string, excel, vba, for-loop, each

对 VBA 来说真的很新……我环顾四周，试图拼凑一些代码来满足我的需要。认为它几乎就在那里，但我遇到的错误可能很容易克服，但我不知道如何克服。

该代码查看当前工作表 (STOCK)，并从单元格 A2 中获取“目标”文本值。然后它在另一个工作表“其他”中搜索命名范围。如果它确定 Other 中的一个单元格 ('cand') 等于目标值，则“True”值将应用于 STOCK 表中的 G 列，位于原始目标的同一行。

希望这是有道理的。我已经复制了代码，这可能会更清楚地说明事情。

```
将目标调暗为字符串
将糖果点心为字符串
将当前行变暗为整数

子 search_named_range()

    ' 这个范围是硬编码的；如果硬代码版本有效，我们可以尝试 A:A '
    For Each target In Worksheets("STOCK").Range("A2:A1000")

    ' 检索当前范围的行，用于设置目标值时 '
    currentrow = Range(target).Row

        ' FOR 循环在 Mojave 中搜索零件编号范围 '
        For Each cand In Worksheets("Other").Range("N9:N150")
            如果 StrConv(cand.Value, 2) = StrConv(target, 2) 那么
                Worksheets("STOCK").Range("G" + currentrow) = "True"
                转到 FORend
            万一
        下一个糖果

'如果没有找到零件，什么都不做，返回寻找下一个目标'
FORend：下一个目标

结束子

```

目前我收到错误“对于每个控制变量必须是变体或对象”，但找不到任何解释为什么会这样的地方。我敢肯定，这很明显，但我会非常感激引导。

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-23T16:10:13.293

您不能在 For Each 中使用字符串变量。您在 For Each 循环中使用`tartget`and`cand`作为控制变量，但您已将它们定义为字符串。它们需要是一个对象，特别是一个包含您正在迭代的对象集合的对象。您正在迭代一个范围，该范围是范围的集合，因此您的控制变量需要是 Range 对象。

```
Sub search_named_range()

    Dim rCell As Range
    Dim rCand As Range

    For Each rCell In Worksheets("STOCK").Range("A2:A1000").Cells
        For Each rCand In Worksheets("Other").Range("N9:N150").Cells
            If StrComp(rCand.Value, rCell.Value, vbTextCompare) = 0 Then
                rCell.Offset(0, 6).Value = "True"
                Exit For 'exits the rCand For, but no the rCell one
            End If
        Next rCand
    Next rCell

End Sub 
```

其他未纠正错误的更改：

我不知道你为什么在 sub 之外声明你的变量，但我把它们放在里面。

您不需要`.Cells`在 For Each 行的末尾定义，但我喜欢这样做。您可以遍历`.Rows`或`.Columns`使用`.Areas`Range（尽管`.Cells`是默认设置）。

StrConvert 没有任何问题，但您也可以使用 LCase() 或者像我一样使用 StrComp。

由于我已经引用了当前行 (rCell) 上的单元格，因此我使用它和 Offset 来填充我想要的列。

# javascript - 对浏览器停止按钮单击执行操作

> ID：16172610
> 
> 赞同：6
> 
> 时间：2013-04-23T14:55:47.617
> 
> 标签：javascript, jquery

抱歉，如果这太简单了；我是 JQuery 的新手。我已经搜索并找到了这样的问题[，](https://stackoverflow.com/questions/11220581/jquery-browsers-stop-button-event)但他们似乎并没有完全回答我的问题。

我正在使用 JQuery 为需要很长时间的操作显示一个愚蠢的进度指示器：

```
$(document).ready(function() {
    $('form').submit(function() {
        $('#progress').show();
    });
}); 
```

当用户单击表单按钮时，我只显示一个带有动画 gif 的 div。此 div 在页面可见的其余时间可见。表单操作完成后，将加载一个新页面。

这很好用，但是如果用户在操作完成之前点击浏览器中的“停止”会怎样？如何让 div 消失？有没有办法捕捉到这个事件，或者有没有更好的方法来处理整个情况？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T13:33:48.313

您可以使用“onstop”事件来处理这个问题，但它只适用于 IE。我认为您无法为其他浏览器处理此类事件。

您可以尝试在小超时后使进度对话框消失：

```
$('form').submit(function() {
    $('#progress').show();
    setTimeout(function(){
             $('#progress').hide();  
    },3000);
}); 
```

# javascript - 在 iFramed 网站上单击“搜索”？

> ID：16172612
> 
> 赞同：0
> 
> 时间：2013-04-23T14:55:51.023
> 
> 标签：javascript, jquery, iframe

我实际上想创建一个在 iFrame 中有另一个站点的网站。我要创建的站点，假设它的站点 A。应该包含的站点将是站点 B。

站点 B 包含我只在 iframe 中显示的搜索表单。

我希望当人们访问站点 A 并单击搜索按钮时，它应该将插入的文本发送到站点 B 的搜索表单并单击提交。

如果这两个站点位于不同的域中，实际上是否有可能？如果是的话，有人可以让我知道如何开始这个想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:03:14.303

使站点 B 接受 HTTP 请求并调用它`searchboxvalue`。让站点 B 设置搜索框的值，例如`siteB.php?searchboxvalue=ABC`将值更改为`ABC`. 单击站点 A 上的提交按钮时，从站点 A 的搜索框中获取值并使用它将 iframe 设置为`siteB.php?searchboxvalue=value`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:59:17.690

您可以[`postMessage`](https://developer.mozilla.org/en-US/docs/DOM/window.postMessage)用来跨不同来源的帧进行通信。

这取决于两个站点合作发送和接收消息（出于明显的安全原因）。

* * *

您最好只在站点 a 上提交带有`<form action="http://siteB.example.com" target="yourFrame">`适当字段的表单。[但是，如果站点 B 实施了针对CSRF](http://en.wikipedia.org/wiki/Csrf)的保护，这将不起作用。

# android - 为动态数量的视图设置动画，然后将它们设置为不可见/消失

> ID：16172616
> 
> 赞同：1
> 
> 时间：2013-04-23T14:56:00.967
> 
> 标签：android, animation

在一个活动中，我正在从服务器检索数据。有限数量的`TableRow`s 包含布局 xml 文件中预定义的更多视图，全部设置为`android:visibility="gone"`. 此外，java 类中有一个数组，其中包含这些`TableRow`s 的所有 ID。对于每个输入的“数据条目”，我填充这样一个`TableRow`，将其设置为可见并为其设置动画（动画是从随机选择的垂直侧“推入”）。作为进一步的提示，这在本问题后面很重要，从服务器检索的每个数据包都与一个月有关。

每当我获取数据时，我都会执行以下过程

1.  用信息填充仍然不可见`TableRow`的s
2.  每次执行第 1 步时，布尔数组中的一个值被设置为`true`
3.  称呼`showAnimation()`
4.  对于布尔数组中为真的每个条目，获取id 数组中的`TableRow`索引`i`，设置动画并将可见性设置为可见

这工作正常。即使在开始动画之前设置了可见性，也没关系，因为这需要的时间很短，动画在我们眼中已经开始了。

现在问题来了：相反的方式行不通。让我澄清一下：我想要将`TableRow`s 推出窗口，然后设置为不可见的响应。每当我更改实际月份时就消失了，然后将新条目推入。问题是，一旦动画开始，`View`s 就被设置为不可见/消失。我试图用第一个答案中解释[的](https://stackoverflow.com/questions/5591686/an-easy-way-to-make-gone-animation-work)`AnimationListener`类似方法来解决这个问题。这导致了两种可能的方式：

1.  `AnimationListener`为每个定义这样一个`TableRow`并在`onAnimationEnd()`. 我觉得这很丑陋，因为它不是动态的。
2.  可以访问 中的一种索引，并为每个的动画`AnimationListener`设置相同的侦听器。**在这里我不知道怎么可能解决这个问题**。正如我之前发现的那样，在循环中设置 s 上的动画（在我的情况下为 for 循环）会导致动画在循环完成时启动，而不是在设置时启动。因此，即使我在那个 for 循环中携带一个全局索引变量以在 中使用，它显然也会一事无成。`TableRow`**`View``onAnimationEnd()`**

 **有人知道实现这一点的更好方法吗？用 a 解决它`Handler.postDelayed()`并不能解决问题，因为新数据可能已经来自服务器，因此新条目已经可见（因此新条目设置为不可见）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:46:06.503

好的，我想了很多，老实说，我同意你的观点，这不是最好的方式，但由于框架的限制，第一种方式仍然是最好的方式。

如果我们可以从侦听器回调中执行以下操作，那就太好了：

```
public void onAnimationEnd (Animation animation){
    animation.getView().setVisibility(View.Visible);
}
// but this doesn't exist. 
```

只要确保每次设置动画开始执行：

```
Animation anim = row.getAnimation()
if(anim!=null){
     anim.setListener(null); // to avoid the listener to be called
     anim.cancel(); // to stop it from running
}
// and then go ahead and setup a new animation with new listener
anim = new MyAnimation();
anim.setListener(new SetToInvisibleListener());
row.startAnimation(anim); 
```**

# c++ - Visual C++ 如何调试按钮单击？

> ID：16172619
> 
> 赞同：-4
> 
> 时间：2013-04-23T14:56:10.997
> 
> 标签：c++, .net, winforms

我对visual c++非常陌生，我认为让调试器能够调试按钮点击就像vb/c#.net一样简单，但显然不是:)我很难在网上找到任何解释你如何调试的东西视觉 C++ 按钮点击。既然没有像 VB 那样的事件，那么如何去做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:02:18.017

不管有问题的框架，或者真正有问题的语言，在使用 Visual Studio 调试应用程序时，您只需在有问题的行上放置一个断点。

![调试时要停止的行](https://i.stack.imgur.com/fetay.png)

您可以通过在要停止的行上按 F9 来放置断点，或者右键单击该行并转到 Breakpoint > Insert Breakpoint。

![断点上下文菜单](https://i.stack.imgur.com/iilbA.png)

话虽如此，如果您没有代码来“处理”（一般意义上，因为我不确定您使用的是什么框架）按钮单击，那么您将没有代码可以插入断点.

# typo3 - f:form.select 不显示数据

> ID：16172622
> 
> 赞同：0
> 
> 时间：2013-04-23T14:56:20.290
> 
> 标签：typo3, fluid, extbase, typo3-flow

我有一个对象追随者，其中包含对象等级（类：等级，成员：$uid，$abelGrade）。我想在数据库表“成绩”中显示所有成绩。所以我为我的视图分配了一个成绩（一个成绩数组），我写了这个代码：

```
<f:form.select property="grade" value="{adherent.grade.labelGrade}" options="{grades}" optionValueField="uid" optionLabelField="labelGrade" size="1" id="category" /> 
```

但问题是它没有显示任何内容。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T06:41:40.533

The problem could be missing $grade->getUid() and $grade->getLabelGrade() methods. These are called due to the optionValueField and optionLabelField. If thats not the problem, set a breakpoint where you assign the {grades} array to the view and check if it's really an array or an ObjectStorage. Thats everything I can think of right now, maybe you'd like to provide some further code.

# java - CA 证书位置

> ID：16172623
> 
> 赞同：1
> 
> 时间：2013-04-23T14:56:37.813
> 
> 标签：java, certificate, x509certificate, bouncycastle

我有**1) X509 证书（子）** -> **身份验证 CA（父）**证书和-> **根 CA（根）**证书。

问题：

1.  我可以从当前的 X509Certificate 证书中检索此**身份验证 CA**证书吗？

2.  当我双击我的证书时，我会看到证书的层次结构。从这里，我可以打开每一个。那么，我可以从该证书中获取 **身份验证 CA 证书**位置或类似的位置吗？

3.  您可以推荐哪些方法来检索**身份验证 CA**证书？

我需要使用java代码来做到这一点。不是关键工具或类似的东西。我有根 CA 证书和 X509 证书（子）。我需要孩子的父母证明。

我使用 bouncycastle 和 java 的类来处理证书。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:05:03.983

X.509 证书中不包含颁发 CA 的证书。如果您双击子证书并看到一个链，这表明您的操作系统可以访问中间证书（以某种方式）。

如果您需要一个证书链，那么您需要从某个外部来源检索它。许多协议（例如 SSL）会默认提供完整的证书链。答案实际上取决于您的问题的上下文，这从您的问题中不清楚。

# python - 计算 CSV 中有多少列？

> ID：16172635
> 
> 赞同：1
> 
> 时间：2013-04-23T14:57:07.533
> 
> 标签：python, django

我只是在玩一些课程和方法作为学习练习。

我正在努力创建的方法是一种计算 CSV 中有多少列的新方法。

**如何锻炼 CSV 中有多少列？**

到目前为止，我的班级，*（很高兴您指出，这也是错误的）*。

```
import csv

class CSV:

    def __init__(self, file=None):
        self.file = file

    def read_file(self):
        data = []
        file_read = csv.reader(self.file)
        for row in file_read:
            data.append(row)
        return data

    def get_row_count(self):
        return len(self.read_file())

    def get_data(self, rows=1):
        data = self.read_file()

        return data[:rows] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:38:23.977

如果您确定所有行都具有相同的列数，那么您可以简单地读取第一行并获取其长度：

```
self.file_read = csv.reader(self.file)
self.columns = len(self.file_read.next()) 
```

请注意，`.next()`消耗一排。（如果使用 Python 3，你会做`len(next(self.file_read))`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:00:09.400

我能想到的最简单的方法就是抓取 csv 中的第一行并返回它的长度。CSV 文件实际上无法读取其长度，因此首先必须将行放入数组中。我将调用您的`read_file()`函数以将数据**作为数组**获取并获取第一行：

```
def get_column_number(self):
    new_data = self.read_file()
    return len(new_data[0]) 
```

# android - 当重新创建其布局包含视图的活动时，视图的“标签”是否恢复？

> ID：16172637
> 
> 赞同：12
> 
> 时间：2013-04-23T14:57:08.970
> 
> 标签：android, android-activity, android-view, android-lifecycle

有关娱乐状态的[文档：](http://developer.android.com/training/basics/activity-lifecycle/recreating.html)`Activity`

> 默认情况下，系统使用 Bundle 实例状态来保存有关您的活动布局中每个 View 对象的信息（例如输入到 EditText 对象中的文本值）。因此，如果您的活动实例被销毁并重新创建，则布局的状态将恢复到之前的状态，而您不需要任何代码。

View.setTag(Object) 状态的[文档：](http://developer.android.com/reference/android/view/View.html#setTag%28java.lang.Object%29)

> 设置与此视图关联的标签。标签可用于在其层次结构中标记视图，并且在层次结构中不必是唯一的。标签还可用于在视图中存储数据，而无需求助于其他数据结构。

我的问题是：如果我在我的活动布局中的视图（具有唯一 ID）上设置了一个标签，然后该活动被系统销毁并随后重新创建，那么该视图在重新创建时是否会自动被标记为我最初设置的对象？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T15:35:34.100

> 如果我在我的活动布局中的视图（具有唯一 ID）上设置了一个标签，然后该活动被系统销毁并随后重新创建，那么该视图在重新创建时是否会自动使用我最初设置的对象进行标记?

不，根据我对源代码的阅读。

> 系统希望在以后的某个日期重新创建活动，因此我可以看到它保持对原始标签的引用。

这并不总是可行的，因为保存的实例状态`Bundle`需要跨进程边界传输。

# hibernate - 使用 H2 进行适当的拆卸休眠测试

> ID：16172640
> 
> 赞同：5
> 
> 时间：2013-04-23T14:57:26.367
> 
> 标签：hibernate, jpa, tdd, jpa-2.0, h2

目前，我在测试套件中的每次测试后都使用以下内容。然而，它使它变得非常慢，因为 H2 必须在每次测试后重新加载应用程序上下文。有没有更快的方法来清除我的所有对象，这样我就不会在测试之间结转？

```
@org.junit.After
public void tearDown() throws Exception {
    context.close();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-02T04:03:44.490

尝试**`context.clear()`**

EntityManager.clear：清除持久性上下文，导致所有托管实体分离。对尚未刷新到数据库的实体所做的更改将不会被持久化。

Session.clear：完全清除会话。

此外，您可以通过实现单例模式来确保每个测试中使用的实体管理器/会话是相同的。您可以使用动态 SQL 脚本来清除所有表中的数据。两者都在 PersistenceHelper 下进行[了](http://www.objectpartners.com/2010/11/09/unit-testing-your-persistence-tier-code)描述。

# url - Joomla URL Additional Get 变量破坏了 SEF URL

> ID：16172649
> 
> 赞同：0
> 
> 时间：2013-04-23T14:57:42.097
> 
> 标签：url, joomla, parameters, sef

我正在使用 Joomla 3，在菜单项中我创建了两个名为 City 和 County 的附加字段，我手动输入值并将其作为 Get 变量传递给 URL。

在 components/com_content/views/article/tmpl/default.xml 我创建了这两个字段。

```
<field name="City" type="text" default="" label="Enter City ID" description="" size="10" />
<field name="County" type="text" default="" label="Enter County ID" description="" size="10" /> 
```

例如，普通文章 URL 看起来像 index.php?option=com_content&view=article&id=22

但是当我填充 City 和 County 字段时，URL 变成这样 index.php?option=com_content&view=article&id=22&City=4&County=1

但是，在启用 SEF URL 之前，一切似乎都可以正常工作。但是当我启用 SEF URL 时，这些额外的城市和县参数不会被传递，它会破坏整个站点。

我在某处读过这是用 router.php 和 jroute 做一些事情，我不是程序员，仍在学习我的绳索。请有人告诉我如何告诉 jroute 或 jrouter 将这些作为参数传递，我不想丢失 SEF URL。

或者，如果您有其他方法，我会非常满意。感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T09:29:41.837

我已经设法通过使用 ArtioSEF JoomSEF 插件解决了这个问题。当我使用这个插件时，所有 SEF 和所有 get 参数都按应有的方式传递。

谢谢

# javascript - 目标父下一个 div

> ID：16172654
> 
> 赞同：2
> 
> 时间：2013-04-23T14:57:48.413
> 
> 标签：javascript, jquery, html

我正在尝试以 a 为目标，`<div>`它是函数`<li>`父级的下一个。我试过, , 等等...没有运气，有什么想法吗？`<div>``show_projectinfo()``.next()``.closest()`

功能是，如果我单击`a.more_info`然后`li.slider img`隐藏...我不知道它是否完全超出范围...这是一个重复的 div，所以我不能只使用 ID。

标记：

```
 <li class="info">
        <a id="previous-slider"> < </a>
        <span>01/15</span>
        <a id="next-slider" href="javascript:void(0)"> > </a>  
        <a class="more_info" href="javascript:void(0)" onclick="show_projectinfo()">Info</a>
    </li>
    <li class="slider">
        <img src="img/horizontal.jpg" alt="horizontal" width="624" height="429">
    </li> 
```

这是脚本：

```
 function show_projectinfo(){
        $(this).closest('.slider img').hide();
        $('.info_content').fadeIn();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:05:38.640

基本问题是您正在调用该方法，`onclick`而不是将其与 jquery 绑定。

在您使用它的方式中，`this`指的是窗口而不是被单击的元素。

```
function show_projectinfo(e){
    e.preventDefault();
    $(this).parent().next().find('img').hide();
    $('.info_content').fadeIn();
}

$(function(){
    $('.more_info').click(show_projectinfo);
}); 
```

并从 html 中删除`onclick`属性

* * *

如果您***有***（*尽管您不应该*）使用该`onclick`属性，那么将其`this`作为参数传递

```
function show_projectinfo(element){
    $( element ).parent().next().find('img').hide();
    $('.info_content').fadeIn();
} 
```

和

```
<a class="more_info" href="javascript:void(0)" onclick="show_projectinfo(this)">Info</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:00:25.343

尝试：

```
$(this).parent().next() // parent() should be the <li> then next() will get your next <li> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:04:13.947

```
$('.more_info').click(function(e){
    e.preventDefault();
    $(this).parent().next().find('img').hide();
    $('.info_content').fadeIn();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:05:23.530

而不是`.closest`使用`.parent`and `.next`，然后选择 img with `.find`。

看看这个[jsFiddle](http://jsfiddle.net/3VuhJ/)：

```
$("a.more_info").bind("click", function(e){
    e.preventDefault();
    $(this).parent("li").next("li.slider").find("img").hide();
    $('.info_content').fadeIn();
    return false;
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T15:14:08.297

```
$('li').click( function (){
       var nextLi = $(this).closest('div').next().children('li:first-child').attr('id');
    console.log(nextLi);    
}); 
```

考虑以下标记：

```
<div id='div1'>
    <li id='1'>1</li>
    <li id='2'>2</li>
    <li id='3'>3</li>
</div>
<div id='div2'>
    <li id='4'>4</li>
    <li id='5'>5</li>
    <li id='6'>6</li>
</div> 
```

您可以查看我的实时[jsFiddle](http://jsfiddle.net/puQ8b/)了解更多详细信息。

# javascript - 不同的 *Target 属性的目的是什么？

> ID：16172656
> 
> 赞同：6
> 
> 时间：2013-04-23T14:57:51.710
> 
> 标签：javascript, mouseevent, dart

在 MouseEvent 类中有多个 *Target 事件：

*   [目标](http://api.dartlang.org/docs/releases/latest/dart_html/MouseEvent.html#target)
*   [当前目标](http://api.dartlang.org/docs/releases/latest/dart_html/MouseEvent.html#currentTarget)
*   [相关目标](http://api.dartlang.org/docs/releases/latest/dart_html/MouseEvent.html#relatedTarget)

它们在 MouseEvent 上下文中的目的是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T16:56:09.830

这些属性等价于 JavaScript 鼠标事件。JavaScript 事件遍历 DOM（称为“冒泡”）。`target`是最初在其上调度事件的对象。`currentTarget`是您的事件处理程序已附加到的对象。

**例子**

你有这个 HTML 结构：

```
<ul id="list">
  <li>Entry 1</li>
  <li>Entry 2</li>
</ul> 
```

然后向`<ul>`元素添加一个点击处理程序（通过 JavaScript 或 Dart，概念是相同的）。

然后，当您单击“条目 2”时，将调用您的单击处理程序（因为事件“冒泡”到它）。`target`将是`<li>`元素，而`currentTarget`将是`<ul>`元素。您必须使用哪一个取决于您想在处理程序中执行的操作 - 例如，您可以使用 隐藏“条目 2”本身`target`，或者使用 隐藏整个列表`currentTarget`。

引用的元素`relatedTarget`取决于 MouseEvent 的类型 - 可以在此处找到列表：[event.relatedTarget](https://developer.mozilla.org/en-US/docs/DOM/event.relatedTarget)。在上面的例子中，它会是`null`，因为点击事件没有任何相关的目标。

相关 MDN 链接： [event.currentTarget](https://developer.mozilla.org/en-US/docs/DOM/event.currentTarget) , [event.target](https://developer.mozilla.org/en-US/docs/DOM/event.target)

# c - 如何在 C 中实现包含 PIC 函数调用的堆栈

> ID：16172657
> 
> 赞同：0
> 
> 时间：2013-04-23T14:57:58.543
> 
> 标签：c, stack, interrupt, pic

我目前正在使用 MPLAB X（+ 编译器 XC8）用 C 语言编写 PIC

在我的代码中，我有一些中断（inter1、inter2、..），每个中断都由紧急和非紧急操作（urg1、urg2、..、n_urg1、n_urg2、..）组成。

所以我想要一个具有以下结构的代码：

```
stack s; // FIFO or other
main() {
   while (true) {
      if (!isEmpty(s)) {
         doNextFunction(s);
      }
   }
 }

void interrupt inter1() {
   urg1(); // urgent code
   addStack(n_urg1);
}

void n_urg1() {
   // non-urgent code
} 
```

我怎样才能实现那种堆栈？标准库中有什么东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:32:08.020

如果我没记错的话，那么那个编译器相当原始，我认为你不能使用 std 库。

如果你需要自己实现它，你可以使用一个函数指针数组：

```
#include <string.h> // for memmove()

#define STACK_MAX   10

typedef enum
{
    Int,
    Boolean
} VariantType;

typedef struct
{
    VariantType type;
    union {
        int intValue;
        bool booleanValue;
    } value;
} Variant;

typedef bool (*FunctionPtr)(Variant data);

typedef struct
{
    FunctionPtr ptr;
    Variant var;
} FunctionCall;

FunctionCall functionStack[STACK_MAX];
int functionStackUse = 0;

bool addStack(FunctionPtr ptr, Variant var)
{
    if (functionStackUse >= STACK_MAX)
        return false; // stack full
    functionStack[functionStackUse].ptr = ptr;
    functionStack[functionStackUse].var = var;
    functionStackUse++;
    return true;
}

bool callNextFunction(void)
{
    // TODO: disable inter1
    if (functionStackUse > 0)
    {
        // get first function on stack
        FunctionCall functionCall = functionStack[0];
        functionStackUse--;
        // remove first function from stack
        memmove((void*)functionStack, (void*)(functionStack + 1), functionStackUse * sizeof(functionStack[0]));
        // TODO: re-enable inter1
        // call function with arguments
        return (*functionCall.ptr)(functionCall.var);
    }
    else
    {
        // TODO: re-enable inter1
        return false; // no more functions
    }
}

void main()
{
    while (1)
    {
        callNextFunction();
        // TODO add some delay otherwise you're constantly disabling inter1 (in doNextFunction)
    }
}

bool n_urg1(Variant var)
{
    if (var.type == Int)
    {
        int i = var.value.intValue;
        // do something
        return true;
    }
    return false;
}

void inter1(void)
{
    Variant var;
    var.type = Int;
    var.value.intValue = 45;
    addStack(n_urg1, var);
} 
```

# python - TypeError：在插入参数时，并非所有参数都在字符串格式化期间转换

> ID：16172660
> 
> 赞同：1
> 
> 时间：2013-04-23T14:58:07.013
> 
> 标签：python, mysql, database

我正在尝试将一个整数、一个字符串和一个列表作为单个记录插入到数据库中，但我遇到了一个错误。

这是我的代码：

```
values=nprnd.randint(10, size=48) #NUMPY ARRAY
valuelist= map(None, values); #Convert to list
guid=''.join(random.choice(string.ascii_uppercase + string.digits) for x in range(20)) #Generate guid
for x in range(4):
    var_string = ', '.join('?' * 48)
    valuelist.insert(0,x)
    valuelist.insert(0,ent_guid)
    #50 coloums in table, guid, x and 48 randomly generated values
    query_string = 'INSERT INTO schema1 VALUES (%s,%d,%s);' % (guid, x, var_string) 
    cursor.execute(query_string, valuelist) 
```

我不断收到错误消息：

```
Traceback (most recent call last):
  File "script.py", line 19, in <module>
    cursor.execute(query_string, valuelist)
  File "/Library/Python/2.7/site-packages/MySQL_python-1.2.4b4-py2.7-macosx-10.8-intel.egg/MySQLdb/cursors.py", line 184, in execute
    query = query % db.literal(args) 
```

我知道这个错误的原因（即使 SO 对同一个错误有几个问题），但我尝试过的解决方案都没有为我解决这个错误

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:33:09.780

我相信 MySQL-python 使用 printf 格式代码（例如“%s”）而不是“？” 占位符。尝试`var_string`这样设置：

```
 var_string = ', '.join(['%s'] * 48) 
```

我也同意[Endophage](https://stackoverflow.com/users/432193/endophage)似乎`valuelist`太长了。我认为您不需要插入`al`and `ent_guid`。

插入时还需要在 guid 周围加上引号：

```
 query_string = 'INSERT INTO schema1 VALUES (\'%s\',%d,%s);' % (guid, x, var_string) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:13:37.993

在生成 48 '?'s 后，您将 2 个元素插入到 valuelist 中，您是否考虑过这些？以下代码将更加健壮：

```
values=nprnd.randint(10, size=48) #NUMPY ARRAY
valuelist= map(None, values); #Convert to list
guid=''.join(random.choice(string.ascii_uppercase + string.digits) for x in range(20)) #Generate guid
for x in range(4):
    valuelist.insert(0,al)
    valuelist.insert(0,ent_guid)

    # moved this line and using len(valuelist)
    var_string = ', '.join('?' * len(valuelist)) 

    #50 coloums in table, guid, x and 48 randomly generated values
    query_string = 'INSERT INTO schema1 VALUES (%s,%d,%s);' % (guid, x, var_string) 
    cursor.execute(query_string, valuelist) 
```

**更新：**

从您在下面的评论中，听起来您正在尝试双重插入 guid 和 x 值，因此，将 query_string 分配（以及我在上面所做的其他更改）更改为：

```
query_string = 'INSERT INTO schema1 VALUES (%s);' % (var_string) 
```

这比您当前的字符串插值更安全，因为这`cursor.execute`将确保值被适当地转义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T16:44:54.350

看起来您`valuelist`每次通过循环时都会将大小增加 2。

`valuelist.insert`在现有列表的开头添加一个新项目，因此第一次通过循环，`valuelist`包含 50 个元素，然后是 52 个元素，下一个是 54 个元素，依此类推。

`query_string`虽然只包含 48 个项目的占位符，所以这会导致错误。

如果您删除这些行，并更改“？” 到'%s'，你应该有更好的结果，例如：

```
for x in range(4):
    var_string = ', '.join('%s' * 48) 
    query_string = "INSERT INTO schema1 VALUES ('%s',%d,%s);" % (guid, x, var_string) 
    cursor.execute(query_string, valuelist) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-23T15:04:18.097

尝试在查询中用单引号将您的值括起来。

```
query_string = "INSERT INTO schema1 VALUES ('%s','%d','%s');" % (guid, x, var_string) 
```

# iphone - 录制应用程序中的特定部分

> ID：16172664
> 
> 赞同：0
> 
> 时间：2013-04-23T14:58:15.000
> 
> 标签：iphone, ios, objective-c

在我的应用程序中，我需要访问要在应用程序中打开的相机。目标是仅记录盒子内的部分，如附图所示

![我的应用程序中的相机应用程序](https://i.stack.imgur.com/MpraO.png) 所以有人知道如何做到这一点？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:06:21.243

您无法使用任何公共 API 录制屏幕。也许您可以尝试使用 UIImagePickerController 录制视频，然后剪切您想要的帧。

# asp.net - ASP.Net 登录/注册中的自定义字段？

> ID：16172666
> 
> 赞同：0
> 
> 时间：2013-04-23T14:58:19.963
> 
> 标签：asp.net

我必须编辑 ASP 提供的登录/注册以包含`dropdown`保存到数据库的自定义（“BranchID”）菜单，以便每个用户都有自己的分支。我正在使用 ASP 会员系统，当然它会保存到`ASPNETMDF`它创建的数据库中。谷歌搜索给我带来了一些结果，但我很困惑。我知道有“用户配置文件”，并且 II 可以保存此配置文件数据，但我不太确定它是临时措施还是确实记录到数据库中。

我可以制作自己的自定义会员系统，使用构建的并对其进行调整或使用用户配置文件。最好的行动方案是什么？我非常喜欢调整/编辑内置的会员系统并将我需要的数据添加到其中，但我仍然没有明确的答案来回答我应该做什么或什么是最好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:09:19.250

你有两个选择：

1.  创建一个`CustomMembershipProvider`，如果你需要一个`CustomRoleProvider`，你可以通过实现 .NET 的`MembershipProvider`. 示例： http: [//www.codeproject.com/Articles/165159/Custom-Membership-Providers](http://www.codeproject.com/Articles/165159/Custom-Membership-Providers)

2.  创建一个单独的表来存储其他用户信息，即“BranchID”，并`one-to-one`在您的表和 .NET 的 Membership 之间添加关系

这真的取决于你选择哪一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:37:43.180

MembershipProvider 很容易扩展。假设分支是他们必须选择进行身份验证的东西？您应该能够扩展身份验证以执行以下操作：

```
public class MyCustomMembershipProvider : MembershipProvider
{
/*
....
*/
    public bool ValidateUser(string username, string password, string branch)
    {
        return (::ValidateUser(username, password) && MyCustomRoutine(username, branch));
    }

} 
```

# php - PHP推送到消息队列；多线程python客户端的进程？

> ID：16172668
> 
> 赞同：0
> 
> 时间：2013-04-23T14:58:28.497
> 
> 标签：php, python, message-queue

这就是我正在尝试做的事情：使用 PHP 将消息推送到队列中（或者`Beanstalkd`，，，`IronMQ`）`Amazon SQS`。

然后我想要一个 Python 脚本来立即接收消息。我想我只有 1 个 Python 脚本运行一个`while(true)`循环来继续轮询消息服务器？

然后为每个作业使用一个新线程来处理它。如果队列中有 10 条消息，我希望 python 运行 10 个线程，每个作业 1 个。

我的问题是：

1.  这是一种可靠的做事方式，还是有更好的方法来设置它？
2.  如何确保我的 Python 脚本启动并永远轮询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:11:24.700

> 这是一种可靠的做事方式，还是有更好的方法来设置它？

[对我来说听起来很合理，但如果您期望同时有大量作业，您可能希望通过使用线程池](http://en.wikipedia.org/wiki/Thread_pool_pattern)来限制线程总数。

对于 CPU 密集型线程，当线程总数超过 CPU 内核总数时，您不会获得更多的 CPU 性能，并且如果线程需要大量磁盘 I/O，您需要限制它们以避免颠簸磁盘。

> 如何确保我的 Python 脚本启动并永远轮询？

守护进程通常有另一个进程来监视它们，并在它们崩溃或无响应时重新启动它们。一个简单的 cronjob 可能就足够了。

# php - 关系（外键） CakePhp

> ID：16172669
> 
> 赞同：0
> 
> 时间：2013-04-23T14:58:30.980
> 
> 标签：php, cakephp, foreign-keys, cakephp-2.0, foreign-key-relationship

我在创建 mi 模型（表）之间的关系（外键）时遇到问题，我遵循了 cake 文档但不起作用

关系是 Marca 1-N Modelos

模型 Marca.php

```
<?php
class Marca extends AppModel
{
    var $name = 'Marca';
    public $displayField = 'nombre';
    var $hasMany = array(
        'Modelo' => array(
            'className' => 'Modelo',
            'foreignKey' => 'marca_id'
        )
    );

}

?> 
```

模型 Modelo.php

```
<?php
class Modelo extends AppModel
{
    var $name = 'Modelo';
    var $belongsTo = array(
        'Marca' => array(
            'className' => 'Marca',
            'foreignKey' => 'marca_id'
        )
    );

}

?> 
```

模型控制器

```
<?php
class ModelosController extends AppController{
    var $name = 'Modelos';
    var $helpers = array('Html','Form');
    //var $scaffold;

    function index(){
        $modelos = $this->Modelo->find('all',array(
            'fields'=>array(
                'Modelo.nombre',
                'Modelo.valido',
                'Modelo.id',
                'Modelo.marca_id'),
            'order'=>'Modelo.nombre ASC')
        );
        $this->set('modelos',$modelos);
    }

    function add(){
        if (!empty($this->data)){
            $this->Modelo->create();

            if ($this->Modelo->save($this->data)){
                $this->Session->SetFlash('Modelo Nuevo Creado');
                $this->redirect(array('action'=>'index'),null,true);
            }else{
                $this->Session->SetFlash('No se ha Agregado el Modelo, intente de Nuevo');
            }
        }
        // $this->loadModel('Marca');
        $marcas = $this->Modelo->Marca->find('list');    <<-----this is 31 line, where is the error
        debug($marcas);
        $this->set(compact('marcas'));
    }

    function edit($id = null){
        if (!$id){
            $this->Session->SetFlash('Modelo Incorrecto');
            $this->redirect(array('action'=>'index'),null,true);
        }

        if (empty($this->data)){
            $this->data = $this->Modelo->find('first',array('conditions'=>array('Modelo.id'=> $id)));     
        }else{
            if ($this->Modelo->save($this->data)) {
                $this->Session->SetFlash('El Modelo se ha Guardado');
                $this->redirect(array('action'=>'index'),null,true);
            }else{
                $this->Session->SetFlash('La Modelo No fue Guardado, intente de Nuevo');
            }
        }
    } 
}

?> 
```

抛出的错误是：

错误：在非对象文件上调用成员函数 find()：/var/www/tlfmovil/app/Controller/ModelosController.php
行：31

我认为错误是因为关系设置不正确，请帮帮我。

对不起，我的英语不好！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:28:14.567

即使使用 ，您的关联似乎也很好`var`，这也不应该是数据库问题，否则 Cake 会通知您缺少数据库表。

但是，您应该更多地遵守 CakePHP 约定，以确保问题不是来自拼写错误。使用 cake bake 控制台或[在线 CakePHP 烘焙工具](http://patisserie.keensoftware.com/en/cakes/bake)生成模型和控制器文件（之后您可以随时将翻译更改为西班牙语）以排除代码中的约定问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:19:45.850

Try using `public` instead of `var` when specifying `$belongsTo` and `$hasMany` vars.

# javascript - 骨干视图中的 tagName、id 和 className 属性有什么用？虽然我们可以使用 el 访问 dom 元素

> ID：16172671
> 
> 赞同：36
> 
> 时间：2013-04-23T14:58:35.197
> 
> 标签：javascript, model-view-controller, backbone.js

为什么属性`tagName`,`id`和`className`存在于主干视图中？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-04-23T15:06:21.457

如果您的视图必须创建自己的元素，即如果它在实例化时没有`el`属性，则使用这些属性（各种原因，我可以在这件事上更进一步）。因此，您将拥有一个具有 id `id`、 classes`className`和 attributes的新元素`attributes`。

您可以在[此处找到相关的代码](https://github.com/jashkenas/backbone/blob/d52ed125a853519b74786fa3d6a3518c8c634d21/backbone.js#L1185)。此`_ensureElement`方法在视图的构造函数中使用。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-04-24T04:52:56.593

所有 Backbone 视图都有一个 el 属性[Read doc here](http://backbonejs.org/#View-el)。如果在实例化视图时不传递 el，它将创建一个空`DIV`并使用它。

*   现在，只是说您不想`DIV`用作容器来呈现您的视图。你希望它是一个`UL`。只需`tagName`为您的视图指定属性，它将被使用。

*   如果要向容器中添加一些 css 类，请使用`className`.

*   如果你想给它添加一些属性（例如你想给`data-*`你的 el 添加属性）使用`attributes`Backbone 视图的属性。

# java - 在 REST API 中创建“假”ID

> ID：16172672
> 
> 赞同：4
> 
> 时间：2013-04-23T14:58:41.297
> 
> 标签：java, rest, jakarta-ee

我有一个`Post`实体列表，每个帖子都有一个`Comment`实体列表。`Post`实体是一个组合对象。没有帖子，系统中就不存在评论。

URI 示例：

`/posts/3453/comments/8547`

这将检索特定评论，也用于删除和更新特定评论。现在，如果我的 API 有这样的东西会不会更好：

`/posts/3453/comments/1`

第一个 URI 中的评论 id 8547 与最后一个相同，但 id 在帖子的上下文中。它从一开始，随着更多评论的添加而增加。但是，如果您有 10 条 id 为 1-10 的评论，然后删除数字 5，它是否应该以某种方式更新 id 以便应用 1-9？

这听起来合理吗？我刚刚开始考虑，还是应该只使用数据库中的唯一 ID（主键）？如果没有，您将如何创建这种 id？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:06:28.900

数字`8547`和`1`只是看起来一样，但它们代表不同的概念：`8547`是*标识符*，`1`而是*序列号*。序列号可以更改，但 ID 不能更改。

我建议使用带有 ID 的 URI 来标识特定的评论资源，并添加一个具有查询功能的 UIR，以便按其序列号搜索评论资源，如下所示：

```
/posts/3453/comments?sequence=1 
```

这样就不会有关于“规范”资源 URI 的问题，但客户端将能够查询评论而无需提供完整的标识。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T15:25:17.843

如果您选择通过序列号来识别评论，那是您的偏好。如果在您的应用程序的概念中，将评论的唯一标识设置为与帖子标识符相关的序列号是有意义的，只要记录在案，这就是完美的设计。

您的重新排序方法至少有两个主要缺点，这可能会导致您的应用程序 URI 设计存在缺陷。第一个缺点是 URI 上的 GET 方法应该是可缓存的，重新排序打破了这个合同，因为第 2 项没有改变，但是因为第 1 项你现在改变了 /2 的含义。接下来，这显然会破坏人们可能已经创建的链接。

我确实喜欢序列查询参数的概念，但是我认为从我对您的问题的有限理解来看，仅仅使用标识符是有意义的，因为我上面列出的两个缺点不再是问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T15:05:04.793

我肯定会使用评论的实际 ID，而不是使用索引方案。原因是如果连续有多个更新会发生什么？用户 A 删除了索引 2 的评论，同时用户 B 删除了索引 3 的评论。那么，哪些评论真的应该被删除呢？实际删除将由执行顺序决定。如果您使用真实 ID，则不会有任何争用。

# android - 在 Android 上的 PayPal 移动支付库上将货币设置为欧元时没有出现登录屏幕

> ID：16172674
> 
> 赞同：0
> 
> 时间：2013-04-23T14:58:43.053
> 
> 标签：android, localization, paypal

我在 Android 上使用 PayPal 的移动支付库来接受服务付款。但是，将货币设置为欧元时，我没有弹出登录屏幕。仅适用于美元。任何人都可能知道为什么？我没有收到任何消息、错误或回调。将不胜感激任何帮助。谢谢

```
public void PayPalButtonClick(View arg0) {
          // Create a basic PayPal payment
          PayPalPayment payment = new PayPalPayment();

          // Set the currency type
          payment.setCurrencyType("EUR");

          // Set the recipient for the payment (can be a phone number)
          payment.setRecipient("email@email.com");

         // Set the payment amount, excluding tax and shipping costs
          payment.setSubtotal(new BigDecimal(9999.9));

          // Set the payment type--his can be PAYMENT_TYPE_GOODS,
          // PAYMENT_TYPE_SERVICE, PAYMENT_TYPE_PERSONAL, or PAYMENT_TYPE_NONE
          payment.setPaymentType(PayPal.PAYMENT_TYPE_SERVICE);

          // PayPalInvoiceData can contain tax and shipping amounts, and an
          // ArrayList of PayPalInvoiceItem that you can fill out.
          // These are not required for any transaction.
          PayPalInvoiceData invoice = new PayPalInvoiceData();

          // Set the tax amount
          invoice.setTax(new BigDecimal(99.0));

          Intent paypalIntent = PayPal.getInstance().checkout(payment, this);
          this.startActivityForResult(paypalIntent, 1);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-04T11:07:14.030

你是对的......对于欧元货币，每笔交易的默认限额为 8,000.00 欧元</p>

你可以[在这里查看](https://developer.paypal.com/docs/classic/api/currency_codes/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:16:25.700

终于找到答案了……真的很蠢。小计为 9999.0。我所做的只是将这个数字减少到 99.0。原因可能是当切换到欧元时，超出了限制或其他原因。不确定，但它确实有效。所以要小心我猜的那些高默认数字。

# perforce - p4 merge 接受他们的，但实际上是合并

> ID：16172676
> 
> 赞同：2
> 
> 时间：2013-04-23T14:58:50.453
> 
> 标签：perforce

期间`p4 resolve`，在显着更改本地文件后，我确定要解决与“他们的”版本的所有冲突。但是，如果我`at`在提示符（默认为`e`编辑）上运行（接受他们的），perforce 只会覆盖文件的新版本，然后我会丢失我所做的所有更改。

我想合并新的更改，*只通过选择他们的来解决冲突*。我相信如果给出“接受他们的”来解决冲突，这就是 git 的行为方式。是否有命令告诉 Perforce 这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T15:44:10.133

正如您所指出的， Perforce`accept theirs`是不同的。它为每次更改选择源文件增量，而不仅仅是冲突。

您可能希望`accept merged`然后选择如何解决 P4Merge 中的冲突。

# jquery - 在 jquery find 中转义

> ID：16172679
> 
> 赞同：-1
> 
> 时间：2013-04-23T14:58:54.253
> 
> 标签：jquery

我在变量中有一个 DOM 元素的 id

```
var elm = 'myelement'; 
```

我能怎么做

```
$('#myelement a') 
```

我只知道

```
$('#' + elm) .. how to put anchor tag  here ? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:00:29.803

您以这种方式添加到您的串联中-

```
$('#' + elm + ' a') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:02:16.740

你有两个选择：

```
$('#' + elm + ' a') // basically is $('#myelement a') 
```

或者：

```
$('#' + elm).find('a') // basically is $('#myelement').find('a') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:00:43.293

您可以简单地使用该`find()`功能。

```
var elm = $('#myelement');
var anchorElement = elm.find('a'); 
```

请记住，这将返回**所有**锚同级锚标记。您可能想要添加一个额外的类或选择器。例如，要仅返回第一个锚标记，您可以使用 -

```
var firstAnchorElement = elm.find('a:first'); 
```

* * *

如果您只想使用一个选择器，那么您可以从您拥有的所有元素名称中创建一个选择器。

```
var elementId = 'myId';
var childElement = 'a';
var anchorElement = $("#" + elementId + " " + childElement ); 
```

尽管使用这种方法，如您所见 - 您的代码开始变得越来越不可读。

# ruby-on-rails - 如何使用 Rails 项目配置 Postgresql？

> ID：16172682
> 
> 赞同：1
> 
> 时间：2013-04-23T14:59:05.743
> 
> 标签：ruby-on-rails, ruby, postgresql, database-connection

我对红宝石很陌生。我正在尝试运行`BBYIDX`并遵循[如何在 Windows 上安装 BBYIDX？](https://stackoverflow.com/questions/8640297/how-to-install-bbyidx-on-windows)

当我尝试`rake db:migrate`时，它会重现错误

```
(in /home/virinchy/BBYIDX-2/BBYIDX-master)  
DEPRECATION WARNING: Rake tasks in vendor/plugins/acts_as_tsearch/tasks,   vendor/plugins/acts_as_tsearch/tasks, vendor/plugins/delayed_job/tasks,   vendor/plugins/nested_scenarios/tasks, vendor/plugins/rails-authorization-plugin/tasks, and   vendor/plugins/rails_rcov/tasks are deprecated. Use lib/tasks instead. (called from /usr/local/rvm/gems/ruby-1.8.7-p371/gems/rails-2.3.11/lib/tasks/rails.rb:10)  
rake aborted!  
FATAL:  password authentication failed for user "bbyidx"  
FATAL:  password authentication failed for user "bbyidx"
Bundle install was succesful with message as:Your bundle is complete!  
Use `bundle show [gemname]` to see where a bundled gem is installed. 
```

但是`rake db:migrate`会产生这个错误。我正在跑步`ubuntu 12.04`, `ruby-1.8.7`,`rails-2.3.11`和`gem 1.5.3`

我该如何解决这个问题？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:16:41.407

Did you set a password for your `postgres` user?

In your `config/database.yml` you should have your databases set up properly:

```
development:
  adapter: postgresql
  encoding: unicode
  database: your_app_development # name your development app something
  host: localhost
  pool: 5
  username: your_username
  password: your_password # or leave blank if you didn't set a password

test:
  adapter: postgresql
  encoding: unicode
  database: your_app_test
  host: localhost
  pool: 5
  username: your_username
  password: your_password 
```

# php - 未使用 DAVLockDB 指令指定锁定数据库。必须指定一个才能使用锁定功能。[500，#401]

> ID：16172683
> 
> 赞同：1
> 
> 时间：2013-04-23T14:59:06.003
> 
> 标签：php, maven, web, apache2, webdav

我正在尝试使用 WebDAV 协议将我的 maven 项目网站部署到 apache 2.2 中。服务器。

当我将应用程序部署到服务器时，我遇到了上述错误。

我在`httpd-dav.conf`. 但我仍然在 ahache_error.log 文件中发现上述错误。谁能帮我在这里找到原因。

```
DavLockDB "c:/apache2.2/var/DavLock"
Alias /sites "c:/apache2.2/sites"

<Directory "c:/apache2.2/sites">
    Dav On

    Order Allow,Deny
    Allow from all

    AuthType Digest
    AuthName DAV-upload

    Options Indexes

    AuthUserFile "c:/wamp/bin/apache/apache2.2.22/user.passwd"
    AuthDigestProvider file

    # Allow universal read-access, but writes are restricted
    # to the admin user.
    <LimitExcept GET OPTIONS>
        require user admin
    </LimitExcept>
</Directory> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T08:22:57.740

实际上我在 2 天后找到了答案，答案很简单。

我`"c:/apache2.2/var/DavLock"`从 httpd-dav.conf 文件中删除了 DavLockDB 并将这一行放在 httpd.conf 文件中

这是我所做的唯一更改，现在我可以使用 web dav 协议访问 apache2.2 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-09T16:22:13.417

在 Windows 上也可以正常工作。

我在使用 Laragon 从 Ipad 上的 GoodReader 连接到 Windows 10 上的 WebDav 时遇到了同样的问题。

代码 C:\laragon\bin\apache\httpd-2.4.35-win64-VC15\conf\httpd.conf

在 WebDAV Apache 模块下添加了这一行：

```
LoadModule dav_module modules/mod_dav.so
LoadModule dav_fs_module modules/mod_dav_fs.so
LoadModule dav_lock_module modules/mod_dav_lock.so
DavLockDB "C:/www/webdav/DavLock" 
```

# c# - Xaml - 带有额外标题的组样式

> ID：16172686
> 
> 赞同：0
> 
> 时间：2013-04-23T14:59:11.580
> 
> 标签：c#, wpf, visual-studio-2010, xaml

我整天都在努力让这个工作。我在最后一个职位。我正在通过 collectionviewsource 使用组描述符，并试图操纵标头。

```
<GroupStyle>
    <GroupStyle.ContainerStyle>
        <Style TargetType="{x:Type GroupItem}">
            <Setter Property="Margin" Value="0,0,0,5"/>
            <Setter Property="Template">
              <Setter.Value>
                <ControlTemplate TargetType="{x:Type GroupItem}">
                    <Border Height="Auto" Margin="4,2,2,0" CornerRadius="5" BorderThickness="1" BorderBrush="#FF9B9595" Background="#FFFDF9CA">
                        <StackPanel >
                            <TextBlock Foreground="Firebrick" Text="{Binding Path=Name,StringFormat=dd/MM/yyyy}" FontSize="13" Margin="10,0,0,0"/>                                               
                            <TextBlock Text="{Binding Items[0].NameOfDay}"/>
                            <ItemsPresenter/>
                        </StackPanel>               
                    </Border>                                           
                </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </GroupStyle.ContainerStyle>
    <GroupStyle.Panel>
        <ItemsPanelTemplate>
            <WrapPanel></WrapPanel>
        </ItemsPanelTemplate>
    </GroupStyle.Panel>
</GroupStyle> 
```

我正在寻找标题以显示日期（其分组依据）和星期几（在记录集中）您可以在上面看到我的尝试。在此先感谢斯科特

# ios - Container/Child UIViewControllers 和状态栏

> ID：16172694
> 
> 赞同：1
> 
> 时间：2013-04-23T14:59:30.123
> 
> 标签：ios, objective-c, uiviewcontroller

我正在尝试让父视图控制器显示子视图控制器的视图。我在父母的中有以下内容`viewDidLoad`：

```
-(void)viewDidLoad
{
    [super viewDidLoad];

    // create child view controller
    [self setMenuController:[[MenuViewController alloc] initWithNibName:@"MenuView" bundle:nil]];
    [self addChildViewController:[self menuController]];

    // move the child view down 30 pt
    CGRect frame = [[[self menuController] view] frame];
    frame.origin.y = 30;
    [[[self menuController] view] setFrame:frame];
    [[self menuController] setWantsFullScreenLayout:YES];

    [[self view] addSubview:[[self menuController] view]];

    [[[self menuController] view] setNeedsLayout];
} 
```

子视图控制器的 xib 只是一个居中、部分透明的红色视图`UIImageView`（以查看重叠）。

如果我禁用状态栏`application:didFinishLaunchingWithOptions:`，我会得到以下信息：

![没有状态栏](https://i.stack.imgur.com/ktOfR.png)

如果我启用状态栏，我会得到：

![状态栏](https://i.stack.imgur.com/QHHd3.png)

使用状态栏，子控制器`UIView`会自动调整，为状态栏的位置腾出空间（因为图像视图居中，即顶部和底部各 10 分）。由于这是一个子视图，因此无论父视图是否有状态栏，它都应该始终使用视图控制器视图的完整大小。除了将任何子视图的大小调整为大 20 像素或在子视图控制器中使用包装器视图之外，还有什么方法可以实现这一点？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-23T15:29:25.403

尝试将框架设置为 menuController 的视图边界而不是其框架。另外，我不确定您是否需要 setWantsFullScreen ，这会导致视图与状态栏重叠。

**编辑后：**

像这样尝试，看看这是否有效。

```
-(void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];
    [self setMenuController:[[MenuViewController alloc] initWithNibName:@"MenuView" bundle:nil]];
    [self addChildViewController:menuController];
    [menuController didMoveToParentViewController:self];
    menuController.view.frame = CGRectMake(self.view.bounds.origin.x, self.view.bounds.origin.y +30, menuController.view.frame.size.width, menuController.view.frame.size.height);
    [self.view addSubview:menuController.view];
} 
```

# git - 防止 git 将删除和带有更改的新文件视为移动

> ID：16172696
> 
> 赞同：8
> 
> 时间：2013-04-23T14:59:34.630
> 
> 标签：git

我正在使用 Git 跟踪对虚拟机的 XML 配置的更改。许多 XML 配置是相似的，只有几个字段不同。我经常删除虚拟机配置并添加新配置。将这些更改添加到存储库时，Git 将其视为文件重命名，只需进行一些更改。我可以明白为什么 git 会这样做，并了解它的用例。

我想知道是否有办法防止这种情况发生，而是让 git 将其视为文件删除，而是创建新文件。在查看提交日志时，更容易辨别“哦，今天我删除了这个 VM 并创建了一个新的”

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-23T15:10:21.157

重命名只是输出中显示的内容，在内部它们就像常规删除和创建一样存储。

如果要禁用重命名检测，可以使用以下`--no-renames`选项：

```
git log --stat --no-renames 
```

（也适用于`git diff`,`git show`等）

如果您不想一直添加此选项，可以将其添加到您的配置中：

```
git config diff.renames false 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T15:09:56.270

别担心，Git 只是将更改显示为重命名，因为它*看起来*像重命名。它不会将其存储为重命名，因为 Git 无法做到这一点。重命名检测发生在提交显示上，而不是在记录时间。

`git show --no-renames`即使您默认启用它，您也可以使用它来避免重命名检测。

# iphone - 在 iOS 中保持 ISO 不变

> ID：16172697
> 
> 赞同：3
> 
> 时间：2013-04-23T14:59:39.807
> 
> 标签：iphone, ios, camera, avfoundation, iso

有什么方法可以保持 ISO 值不变？我正在设计一个用于在 iOS 中捕获图像的应用程序。我通过选择不同的测光点来改变曝光率，但它同时改变了曝光率和 ISO。有没有办法解耦这些东西？

# php - ob_get_contents 的问题 - 返回不可读的东西

> ID：16172700
> 
> 赞同：0
> 
> 时间：2013-04-23T14:59:40.913
> 
> 标签：php, caching, ob-get-contents

我想创建一个缓存。在我的 php 索引的开头，我使用：

```
if ($docache) {
    $folder_cache = dirname(__FILE__).'/cache/';
    $seconds_cache = 15*60; // 15 minutes
    $url_cache = $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];
    $file_cache = $folder_cache . md5($url_cache) . '.cache';
    $file_cache_existe = ( @file_exists($file_cache) ) ? @filemtime($file_cache) : 0;    
    if ($file_cache_existe > time() - $seconds_cache ) {
        @readfile($file_cache);
        exit();
    }
}
ob_start(); 
```

然后，最后：

```
if ($docache) {
    $folder_cache = dirname(__FILE__).'/cache/';
    $url_cache = $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];
    $file_cache = $folder_cache . md5($url_cache) . '.cache';   
    $filehandler = @fopen($file_cache, 'w');    
    @fwrite($filehandler, ob_get_contents());
    @fclose($filehandler);
} 
```

嗯，它起作用了……缓存文件在我们第一次看到页面时创建，然后我们返回，它显示缓存中的文件……问题是缓存中的文件只包含一些不可读的字符就像��<�r㶒�V��。

似乎 ob_get_contents 函数返回的不是真正显示的内容？我真的不明白为什么！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:06:48.240

您可以从删除错误抑制并检查输出内容开始。

您很可能遇到字符编码问题。

# ios - 将屏幕截图、文本添加到“SoundCloud 应用程序”

> ID：16172701
> 
> 赞同：0
> 
> 时间：2013-04-23T14:59:48.697
> 
> 标签：ios, objective-c, sdk, soundcloud

我们`SoundCloud SDK`在我们的应用程序中使用，以便用户可以轻松地将声音上传到其 SoundCloud 页面。

我们还使用我们的 SoundCloud 帐户创建了一个应用程序，我们可以编辑一些应用程序信息，例如：

*   标题
*   指向我们网站的链接
*   令牌
*   ...

但我们无法像其他应用程序那样添加其他信息（添加屏幕截图、一些文本......）

如何做呢？

该应用程序目前处于测试阶段，尚未提交给 Apple。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T09:24:19.970

应用程序库的内容是发布过程的一部分，[不再接受](http://developers.soundcloud.com/blog/the-next-app-gallery-update)应用程序库的提交：

> 展望未来，我们将主动联系符合此标准的人，将他们的应用程序添加到 App Gallery，而不是像过去那样接受大量提交。

# vb.net - 在 vb.net 网站上使用 daypilot

> ID：16172703
> 
> 赞同：0
> 
> 时间：2013-04-23T14:59:52.257
> 
> 标签：vb.net, linq, calendar, timetable, daypilot

我已经下载了 lite 版本，`DayPilot`我`http://www.daypilot.org/daypilot-lite.html` 已经开始使用它来尝试让它运行。我已经建立了一个网站，我打算将其链接到该网站。该站点是 vb.net，我正在使用 linq to sql。有人用过这个日历吗？我不确定如何使用它。我已经在我的侧边栏上创建了控件，并且可以将它拖到页面中没有问题。问题是网站上有我已经开始研究的教程。但是，当我使用教程中的代码时，无法识别控件。好像我需要向我的网站添加更多文件才能使控件正常工作。我在售后控制或编码方面不是很有经验。例如，我复制了以下代码：

```
Protected Sub DayPilotCalendar1_EventMove(ByVal sender As Object, ByVal e As DayPilot.Web.Ui.Events.EventMoveEventArgs) Handles DayPilotCalendar1.EventMove
    dbUpdateEvent(e.Value, e.NewStart, e.NewEnd)
    DayPilotCalendar1.DataSource = dbGetEvents(DayPilotCalendar1.StartDate, DayPilotCalendar1.Days)
    DayPilotCalendar1.DataBind()
    DayPilotCalendar1.Update()
End Sub 
```

这些行`DayPilot.Web.Ui.Events.EventMoveEventArgs)`并`DayPilotCalendar1.Update()`出现错误“未定义类型 DayPilot.Web.Ui.Events.EventMoveEventArgs”和“更新不是 DayPilot.Web.UI.DayPilotCalendar 的成员”。任何提示或建议。顺便说一句，我觉得自己的时间表不够熟练，除非有人知道如何做的相当全面的指南。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T16:27:31.853

DayPilot.Web.Ui.Events.EventMoveEventArgs 在适用于 ASP.NET WebForms 的 DayPilot Lite 中不可用（不支持 EventMove 事件）。

您需要切换到**专业**版（付费）： [http ://www.daypilot.org/try.html](http://www.daypilot.org/try.html)

或将 DayPilot Lite 用于 ASP.NET **MVC**（开源）： [http ://mvc.daypilot.org/lite/](http://mvc.daypilot.org/lite/)

# android - 未找到 android.test.InstrumentationTestRunner 类

> ID：16172704
> 
> 赞同：3
> 
> 时间：2013-04-23T14:59:52.497
> 
> 标签：android, android-testing

尝试运行 android 测试用例时，我得到以下最后两行：

```
[2013-04-22 17:11:10 - ProjectTest] Launching instrumentation android.test.InstrumentationTestRunner on emulator-5554
[2013-04-22 17:11:12 - ProjectTest] Test run failed: Instrumentation run failed due to 'java.lang.ClassNotFoundException' 
```

我相信我需要在我的构建路径中包含一个 jar。知道我需要包含哪个 jar 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:18:21.720

我想你应该在互联网上研究了一下或在 Stackoverflow 上搜索过。Stackoverflow 中有类似的问题陈述：[Test run failed: Instrumentation run failed due to 'java.lang.ClassNotFoundException'](https://stackoverflow.com/questions/16046474/test-run-failed-instrumentation-run-failed-due-to-java-lang-classnotfoundexcep)

# javascript - Kendo UI：无法将 footerTemplate 添加到网格

> ID：16172710
> 
> 赞同：4
> 
> 时间：2013-04-23T15:00:03.873
> 
> 标签：javascript, jquery, mvvm, kendo-ui

我正在尝试在 footerTemplate 中显示字段的计数。跟随是小提琴：

[http://jsbin.com/ajoyug/8/edit](http://jsbin.com/ajoyug/8/edit)

但是，没有 footerTemplate 它可以正常工作。但是一旦我添加了 footerTemplate，它就会停止工作。

在 aggregateResult 对象中，我得到了 count 的值。但是那我该如何将它添加到footerTemplate？

请帮帮我。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T20:20:45.597

问题在于您的方法网格被*渲染*了两次，第一次是在 Kendo UI `init`ialization 上（第一次是隐式的`bind`），第二次`bind`是在实际数据时。

第一次数据仍然不可用，然后失败。

如果无论如何你想遵循这条路，你应该这样做：

```
<div id="myListView" data-role="grid" class="transaction-grid"
     data-columns="[
            { field: 'name', title: 'Name', width:'20%' },
            { 
                field: 'age',
                title: 'Age' , 
                width:'35%', 
                footerTemplate: 'Total Count: # if (data.age) { # #= age.count # # } #'  
            }
            ]"
     data-bind="source: dataSource">
</div> 
```

即检查是否`data.age`可用，然后是当您打印它时。

否则，我建议遵循@UmankantPatil 的建议，不要使用`data-*`JavaScript 来初始化小部件和绑定数据。

[在此处](http://jsbin.com/ajoyug/49/edit)检查您的 JSBin 的修改版本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T18:58:06.423

我无法解释为什么它不起作用。但是我尝试过用其他方式来做你的例子，效果很好。

这里是链接。

[http://jsbin.com/ajoyug/35/edit](http://jsbin.com/ajoyug/35/edit)

# python - 如何在 DrawingArea 上绘制完整的 ImageSurface？

> ID：16172711
> 
> 赞同：0
> 
> 时间：2013-04-23T15:00:06.023
> 
> 标签：python, gtk, cairo, imagesource, pycairo

我正在开发一个 Python+Gtk+Cairo 应用程序。我的应用程序需要做一些非常复杂（且昂贵）的绘图。

出于性能原因，我首先在 ImageSurface（屏幕外）上绘制，然后在我的 DrawingArea 对象上绘制 ImageSurface 内容。

***注意：***我需要缩放/翻译我的图纸以使其可见；否则，大图纸会掉出窗外。

不幸的是，出了点问题：如您所见，我无法绘制 ImageSurface 的全部内容。通过使用“规范” Context.set_source_surface(imageSurface, xCoord, yCoord) Context.paint()

我只得到[这个](http://i1141.photobucket.com/albums/n589/IT00/Wrong.jpg)错误的输出：

[这](http://i1141.photobucket.com/albums/n589/IT00/Right.jpg)是我想要达到的结果：

如何强制绘制整个图像表面？

下面的示例代码：

```
import gtk
import cairo

def main():
    w = gtk.Window()
    w.add(RubberTest())
    w.show_all()
    gtk.main()

class RubberTest(gtk.DrawingArea):
    def __init__(self, model=None):
        gtk.DrawingArea.__init__(self)
        self.set_size_request(800, 500)
        self.connect("expose-event", self._expose, self.create_basic_image())
        self.add_events(gtk.gdk.EXPOSURE_MASK
                      | gtk.gdk.BUTTON_PRESS_MASK
                      | gtk.gdk.BUTTON_RELEASE_MASK
                      | gtk.gdk.POINTER_MOTION_MASK)

    def create_basic_image(self):
        img = cairo.ImageSurface(cairo.FORMAT_ARGB32, 24, 24)
        cr = cairo.Context(img)

        # due to large coordinates, the drawing fall out of the window
        self.points = [(10000, 10000), (790000, 10000), (790000, 490000), (10000, 490000)]

        xMax, yMax, xMin, yMin = max([c[0] for c in self.points]), max([c[1] for c in self.points]), min([c[0] for c in self.points]), min([c[1] for c in self.points])
        maxRectWidth = xMax - xMin
        maxRectHeight = yMax - yMin

        w = 800
        h = 500
        width_ratio = float(w) / maxRectWidth
        height_ratio = float(h) / maxRectHeight

        # scale factor
        scaleFactor = min(height_ratio, width_ratio)

        cr.set_line_width(4)
        cr.set_source_rgb(1, 0, 0)

        cr.save()

        # scale + translate
        cr.scale(scaleFactor, scaleFactor)
        cr.translate(-xMin, -yMin)

        for i in range(0, len(self.points)):
            currPoint = self.points[i]
            currX = float(currPoint[0])
            currY = float(currPoint[1])
            nextIndex = i + 1
            if (nextIndex == len(self.points)):
                nextIndex = 0
            nextPoint = self.points[nextIndex]
            nextX = nextPoint[0]
            nextY = nextPoint[1]
            cr.move_to(currX, currY)
            cr.line_to(nextX, nextY)
        cr.restore()
        cr.close_path()
        cr.stroke_preserve()
        return img

    def _expose(self, sender, event, img):
        cr = self.window.cairo_create()
        cr.set_source_surface(img, 0, 0)
        cr.paint()
        return True

if __name__ == '__main__':
    main() 
```

谢谢，它

# html - Firefox下浮动栏中Facebook按钮的水平移位

> ID：16172716
> 
> 赞同：1
> 
> 时间：2013-04-23T15:00:15.753
> 
> 标签：html, css, facebook, firefox, mozilla

我有一个包含 5 个社交按钮的浮动栏。只有 Facebook 按钮向左移动了大约 20 像素。

在元素检查器下按钮的数十个 CSS 元素中，当我停用`position: absolute;`下面的代码时，按钮会转到其正常位置。但我不确定这是否是合适的解决方案，因为它会影响其他浏览器中的行为。

```
.fb_iframe_widget iframe {
    position: absolute;
} 
```

你对这个问题有什么想法吗？感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T00:58:39.747

您可以尝试将其添加到您的 CSS：

```
.fb_iframe_widget iframe {
    position: relative !important;
} 
```

那应该解决它。

我今天也遇到了这个问题。Facebook 最近似乎对“赞”按钮进行了更改。我现在使用 Fb Like 按钮将此代码添加到我的所有网站。

# visual-studio - visual studios 2012 打开一个文件后，我找不到我在 Document Well 中打开的上一个文件

> ID：16172717
> 
> 赞同：2
> 
> 时间：2013-04-23T15:00:15.903
> 
> 标签：visual-studio, visual-studio-2012

任何人都知道如何使文档像vs2010一样好？每次我在解决方案中打开一个文件时，我都会丢失前一个文件，除非我将其固定。我希望它像一个堆栈。

谢谢尼克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:28:13.653

我双击一个文件，你的行为与 VS10 中的行为相同。您可以在解决方案资源管理器中停用预览功能（我相信其中一个正确的按钮 - 不幸的是我现在手头没有 VS12，所以我可以知道确切的位置）。

# c++ - 从 std::priority_queue 派生的类不使用比较器谓词/模板参数

> ID：16172726
> 
> 赞同：1
> 
> 时间：2013-04-23T15:00:35.307
> 
> 标签：c++, templates, priority-queue, derived-class

我对从模板派生不是很熟悉，请参见以下内容：

```
class BCQueue_;

template<typename T,
         typename Sequence = std::vector<T>,
         typename Compare = std::less<typename Sequence::value_type> >
class FixedPriorityQueue : public std::priority_queue<T> {
    friend class BCQueue_; // to access private member maxSize_

public:

    FixedPriorityQueue(unsigned int maxSize) 
    : maxSize_(maxSize) {}

    // smallest item will be dropped if queue id full
    void insertWithOverflow(const T& x) {
        // ...
        this->push(x);
        // ...
    }
private:
    FixedPriorityQueue() {}

    const unsigned int maxSize_;
};

class ScoreLessThan : public std::binary_function<CCandidate *, CCandidate *, bool> {
public:

    bool operator()(
        const CCandidate * a, const CCandidate * b) const {
        std::wcout << a->score << " < " << b->score << std::endl;
        return a->score > b->score;
    }
};

class BCQueue_ : public FixedPriorityQueue<
    CCandidate *, std::vector<CCandidate *>, ScoreLessThan> {
public:
    BCQueue_(size_t maxSize)
    : FixedPriorityQueue(maxSize)   {}

    bool willInsert(float score) {
        return size() < maxSize_ || top()->score < score;
    }
};

BSQueue bc(20);
bs.insertWithOverflow(new CCandidate( ... ));
// ... 
```

在 FixedPriorityQueue 中，我有一个称为`insertWithOverflow`通过删除最小元素来插入元素（如果队列已满）的方法。为了让事情有点分开，我从 FixedPriorityQueue 派生。基本上一切正常，除了比较器`ScoreLessThan`似乎从未被调用过。当我置顶/弹出元素时，它们并不像我期望的那样按（分数的）顺序排列。

所以这可能更像是一个语法/使用问题，请多多包涵，但我找不到任何答案来解决这个问题。我虽然通过定义模板参数都可以解决。我在这里缺少什么？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:09:00.220

这是问题所在。

```
template<typename T,
         typename Sequence = std::vector<T>,
         typename Compare = std::less<typename Sequence::value_type> >
class FixedPriorityQueue : public std::priority_queue<T> {
//               Wrong base class ^^^^^^^^^^^^^^^^^^^^^^ 
```

任何`FixedPriorityQueue<A,B,C>`源自`std::priority_queue<A,(default),(default)>`

更改它以使基类使用相同的模板参数。

```
template<typename T,
         typename Sequence = std::vector<T>,
         typename Compare = std::less<typename Sequence::value_type> >
class FixedPriorityQueue : public std::priority_queue<T,Sequence,Compare> { 
```

**警告：**有些人——根据经验——会告诉你**永远不要**从标准库容器类派生。 [（阅读原因）](https://stackoverflow.com/questions/6806173)

为了给您一些余地，我只会警告您**不要向**您的类添加显式析构函数或添加**具有非平凡析构函数的成员变量**。由于您唯一的成员是`unsigned int`，因此显示的代码不会有问题。

# ssis - 找到增量的最佳实践是什么？

> ID：16172727
> 
> 赞同：0
> 
> 时间：2013-04-23T15:00:37.930
> 
> 标签：ssis, delta

我是使用 SSIS 包的新手，并且对在将数据从登陆到登台时找到增量的最佳实践感到困惑。要求是从 Consolidated Data Store (CDS) 创建几个报告，数据从源头流到 Landing 到 Staging 到 CDS 作为 ETL 包，最后从 CDS 构建报告。

我已经成功创建了将数据从源移动到着陆的包，因为它们非常简单。将数据从 Landing 移动到 Staging 有点令人困惑，因为修改日期是不够的，因为从上次 ETL 运行进行 2 次更改可以将数据返回到前一个日期的数据，这意味着自上次 ETL 运行以来没有任何更改。例如，一个值从 A 变为 B，然后又变为 A - 表示数据已返回到原始状态，但 modifiedOn 列发生了变化。

那么，应该将 Landing 中的所有列与 Staging 中的现有列连续进行比较，还是仅将与交付报告相关的列进行比较？还是有其他方法可以找到增量？

如果不清楚或需要更多详细信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:14:38.190

这是您的业务的问题。我们希望他们在我们的需求文档中定义什么是增量。对一些人来说，它只是几个领域，而对另一些人来说，它就是一切。这取决于业务需要。我会把这个问题发给任何给你要求的人。如果您很好地了解您的业务，您可以在电子邮件中包含有关您认为增量会是什么的建议，并且大多数时候他们会重新体验，而不必自己弄清楚并且会接受您的建议。但只有在您真正了解与数据相关的正常业务需求时才这样做。您还可以向他们提供各种可能性的利弊，以帮助他们做出决定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T18:36:23.420

为什么要获得确切的增量？我的意思是，如果没有发生真正的变化，您为什么不希望已经提交到 CDS 的行重新提交？如果您没有商业原因（报告需要）这样做，那么听起来您在不需要的地方增加了复杂性。

无论如何，如果您真的需要这个，我建议您计算有趣列的 CHECKSUM 并使用旧行的校验和检查新行的校验和。该[博客](http://www.sqlis.com/sqlis/post/Checksum-Transformation.aspx)应该可以帮助您了解如何使用校验和。

# r - 如何计算R中矩阵的幂

> ID：16172731
> 
> 赞同：10
> 
> 时间：2013-04-23T15:00:57.310
> 
> 标签：r, matrix

我正在尝试计算以下矩阵的 -0.5 幂：

```
S <- matrix(c(0.088150041, 0.001017491 , 0.001017491, 0.084634294),nrow=2) 
```

在 Matlab 中，结果为 ( `S^(-0.5)`)：

```
S^(-0.5)
ans =
 3.3683   -0.0200
-0.0200    3.4376 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T15:38:16.813

```
> library(expm)
> solve(sqrtm(S))
            [,1]        [,2]
[1,]  3.36830328 -0.02004191
[2,] -0.02004191  3.43755429 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-23T15:31:52.690

一段时间后，出现了以下解决方案：

```
"%^%" <- function(S, power) 
   with(eigen(S), vectors %*% (values^power * t(vectors))) 
S%^%(-0.5) 
```

结果给出了预期的答案：

```
 [,1]        [,2]
  [1,]  3.36830328 -0.02004191
  [2,] -0.02004191  3.43755430 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-23T16:42:53.733

矩阵的平方根不一定是唯一的（大多数实数至少有 2 个平方根，因此不仅仅是矩阵）。有多种算法可用于生成矩阵的平方根。其他人已经展示了使用 expm 和特征值的方法，但 Cholesky 分解是另一种可能性（参见`chol`函数）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-23T18:55:43.697

为了将此答案扩展到平方根之外，以下函数`exp.mat()`概括了矩阵的“ [Moore-Penrose 伪逆](http://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_pseudoinverse)”，并允许通过奇异值分解 (SVD) 计算矩阵的幂（甚至适用于非方阵，尽管我不知道什么时候需要它）。

### `exp.mat()`功能：

```
#The exp.mat function performs can calculate the pseudoinverse of a matrix (EXP=-1)
#and other exponents of matrices, such as square roots (EXP=0.5) or square root of 
#its inverse (EXP=-0.5). 
#The function arguments are a matrix (MAT), an exponent (EXP), and a tolerance
#level for non-zero singular values.
exp.mat<-function(MAT, EXP, tol=NULL){
 MAT <- as.matrix(MAT)
 matdim <- dim(MAT)
 if(is.null(tol)){
  tol=min(1e-7, .Machine$double.eps*max(matdim)*max(MAT))
 }
 if(matdim[1]>=matdim[2]){ 
  svd1 <- svd(MAT)
  keep <- which(svd1$d > tol)
  res <- t(svd1$u[,keep]%*%diag(svd1$d[keep]^EXP, nrow=length(keep))%*%t(svd1$v[,keep]))
 }
 if(matdim[1]<matdim[2]){ 
  svd1 <- svd(t(MAT))
  keep <- which(svd1$d > tol)
  res <- svd1$u[,keep]%*%diag(svd1$d[keep]^EXP, nrow=length(keep))%*%t(svd1$v[,keep])
 }
 return(res)
} 
```

### 例子

```
S <- matrix(c(0.088150041, 0.001017491 , 0.001017491, 0.084634294),nrow=2)
exp.mat(S, -0.5)
#            [,1]        [,2]
#[1,]  3.36830328 -0.02004191
#[2,] -0.02004191  3.43755429 
```

可以在[此处](http://menugget.blogspot.de/2012/03/exponentiation-of-matrix-including.html)找到其他示例。

# c# - 我如何能够在测验 C# 中检查正确答案？

> ID：16172732
> 
> 赞同：0
> 
> 时间：2013-04-23T15:00:59.747
> 
> 标签：c#, wpf

我一直在尝试制作我的第一个应用程序，一个测验应用程序，但我似乎无法理解当点击相应的按钮然后继续下一个问题时我将如何验证正确答案。

测验页面：

```
public partial class Page1 : PhoneApplicationPage
{
    // list array
    List<Question> qu;

    //counter for moving to next question
    int questionNumber;

    // correct answer counter
    int correctAnswer;

    public void main()
    {
        // method for adding more questions to the list
        qu = new List<Question>();
        qu.Add(new Question("what is your favourite colour?", 
                            "blue", 
                            "red", 
                            "green", 
                            "blue"));

        qu.Add(new Question("what is your favourite film?", 
                            "The Matrix", 
                            "Star Wars", 
                            "Wrath Of Khan", 
                            "The Matrix"));

        qu.Add(new Question("what is your favourite car?", 
                            "BMW", 
                            "VW", 
                            "Mercedes", 
                            "BMW"));
        questionNumber = 0;
        correctAnswer = 0;

    }

    public Page1()
    {
        InitializeComponent();
        main();
        // counter for displaying next question
        displayQuestion(questionNumber);

    }

    // button for quitting back to the start screen
    private void btn_quit_Click(object sender, RoutedEventArgs e)
    {

        NavigationService.Navigate(
           new Uri("/MainPage.xaml", UriKind.Relative));
    }

    private void btn_Answer_A_Click(object sender, RoutedEventArgs e)
    {
        endQuestion();
    }

    private void btn_Answer_C_Click(object sender, RoutedEventArgs e)
    {
        endQuestion();
    }

    private void btn_Answer_B_Click(object sender, RoutedEventArgs e)
    {
        endQuestion();
    }

    // method for ending a question, inc : counter for 
    // moving on to next question and
    // checking if the answer is correct or not
    public void endQuestion()
    {
        //check the answer
            //if it's correct
                questionNumber++;
                displayQuestion(questionNumber);
            //otherwise 
                //stay on question
    }

    public void displayQuestion(int counter)
    {
        // where the question and answers are displayed 
        // in the buttons and txt block
        txt_block_question.Text = counter + ". " + qu[counter].question;
        btn_Answer_A.Content = qu[counter].a;
        btn_Answer_B.Content = qu[counter].b;
        btn_Answer_C.Content = qu[counter].c;
    }
} 
```

问题类

```
public class Question
{

    public String question;
    public String answer;
    public String a;
    public String b;
    public String c;

    public Question(string q, string an, string optionA, string optionB, string optionC)
    {
        question = q;
        answer = an;
        a = optionA;
        b = optionB;
        c = optionC;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:11:45.507

根据您显示的代码，我认为解决方案相当简单：

首先，您需要将一个变量传递给`endQuestion()`，告诉它选择了哪个答案。由于每个答案按钮都将答案文本存储在其`Content`值中，因此您可以传递它。

其次，您需要更新`endQuestion()`以获取“答案”参数，并将该答案与存储在`Question`变量 ( `qu[counter].answer`) 中的正确答案进行比较。使用[String.Compare(string, string)](http://msdn.microsoft.com/en-us/library/84787k22.aspx)将是执行比较的好方法。

这应该是您开始所需的全部内容。我将把实际的代码实现留给你。

# appconkit - AppConKit 3：如何启用设备日志视图？

> ID：16172733
> 
> 赞同：1
> 
> 时间：2013-04-23T15:01:02.680
> 
> 标签：appconkit

目前，我正在使用 AppConKit 3 开发一个应用程序。在 IDE 的调试透视图中，底部有一个名为“设备日志”的视图。它应该显示移动设备生成的日志消息。有两个字段可以输入 URL 和端口以及“连接”按钮。我不确定要使用哪些设置，端口 4012 的默认设置 127.0.0.1 对我不起作用 - 我看不到任何日志消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:57:35.500

要启用日志视图，您必须在应用程序的服务器部分启用日志服务器。切换到 Java 透视图，展开“WebContent”区域以及“WEB-INF”。在那里，您应该找到该`ibiz.prop`文件。在该文件中，取消注释这两行

```
#the port the remote device connects to
devicelogport            = 4000
#the port the remote UI connects to 
guilogport                = 4012 
```

当您现在重新启动您的应用程序（服务器）时，您应该能够连接到设备日志服务器并查看日志消息。

# c - #define 使用结构化指针中的成员

> ID：16172741
> 
> 赞同：-2
> 
> 时间：2013-04-23T15:01:23.747
> 
> 标签：c, macros

我有一个像这样的结构：

```
struct spidev_data {
  int busy;
  int irq;
}; 
```

我只想通过定义访问成员（如 spidev->busy ），所以我试试这个：

```
#define BUSY spidev->busy 
```

但它不起作用......

有人可以告诉我该怎么做吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:06:22.047

你应该试试这个

```
spidev_data *spidev = /* ... new or malloc ... */;

BUSY = 1; 
```

但更优雅的是

```
#define BUSY(X) (X)->busy

...

BUSY(spidev) = 1; 
```

因为它不是专门针对某个对象的。

# rpm - 同一节点的多个 RPM

> ID：16172742
> 
> 赞同：0
> 
> 时间：2013-04-23T15:01:29.120
> 
> 标签：rpm, puppet

我们有一个项目，它使用 puppet 和 RPM 部署，它将一个 WAR 文件部署到 tomcat 并且它工作得很好。

问题是我们正在为项目添加另一场战争，我们还不确定（还）它们是两个独立的项目还是一个。此外，我们希望保留仅发布一场战争的选项。

我最初的想法是创建 2 个 RPM 并将它们部署在同一个节点上，如果我们决定将它们分开，我们只需更改其中一个的节点，但我被告知我不能将 2 个 RPM 放在同一个节点上（尽管我在网上找不到有关此限制的任何信息）。

所以我有两个问题：

1.  我不能在同一个节点上部署 2 个 RPM 是真的吗？

2.  除了创建 3 个木偶脚本项目之外，还有其他方法吗？（每个1个，组合1个）当我们开始进行第三次战争时，哪个会造成很多重复和麻烦？

**现在，我们希望将两场战争部署在同一个节点上**

提前谢谢了

# php - 这个正则表达式究竟做了什么？

> ID：16172744
> 
> 赞同：0
> 
> 时间：2013-04-23T15:01:31.863
> 
> 标签：php, regex, pcre

PHP代码是：

```
$cleanedVer = preg_replace('/[^0-9,.,a-z,A-Z-]/','',$someVer); 
```

它会清除版本刺痛，但有时会清除太多信息。

我不确定这个[PCRE](http://en.wikipedia.org/wiki/Perl_Compatible_Regular_Expressions)正则表达式对上面代码片段中的字符串做了什么。有人愿意解释吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T15:03:20.677

它会删除任何**不是**字母数字、点 (.)、逗号 (,) 或连字符 (-) 的字符。

# c# - 如何使用 Invoke 和 Begin Invoke 在另一个表单中同步创建和控制表单？

> ID：16172746
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:01:40.187
> 
> 标签：c#, multithreading, delegates, invoke, begininvoke

我正在做一个项目，我需要在另一个表单中运行一个表单，例如我有两个表单类：form1 和 form2

在表格1中：

```
public void func1()
{
  form2 f=new form2();
  f.show();
  Thread.sleep(2000);  
} 
```

当我运行它时，`f`这是 form2 的一个实例挂起，直到线程在 2 秒后唤醒。

我尝试使用另一个线程，但它不能正常工作。我知道我应该使用`Invoke`，`BeginInvoke()`但我不知道如何在这里使用它们。我是 Delegate 和 Invoke 的新手，我读的越多，我就越困惑！请帮我。

**Edit1（更多信息）** form1 是主表单，form2 是一个简单的表单，在 form1 中有一个按钮，我创建并显示 form2，如下所示：

```
public partial class Form1 : Form
    {

        public delegate void showdel();
        public Form2 f;
        public Form1()
        {
            InitializeComponent();
            f = new Form2();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Thread t = new Thread(sstart);
            t.Start();
            Thread.Sleep(3000);
        }

        public void sstart()
        {
            f.Show();
        }

    } 
```

但是当我运行这段代码时，form2 会出现片刻，然后很快就消失了。即使我为 sstart() 尝试此代码，它的工作原理也是一样的：

```
public void sstart()
        {
            if (f.InvokeRequired == true)

                f.BeginInvoke(new showdel(sstart));

            else
                f.Show();
        } 
```

我还有挂起问题。但进一步我想控制form1中的form2，例如更改表单2的标题。不幸的是，我没有太多关于backgroundworker及其工作原理的信息？有人对此有任何参考吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:13:16.920

如果您只是想让 form2 启动并只显示两秒钟，我会在构造函数中添加一个计时器来关闭它。

```
 public Form2()
    {
        InitializeComponent();
        System.Windows.Forms.Timer Timer = new Timer();
        Timer.Interval = 2000;
        Timer.Enabled = true;
        Timer.Tick += new EventHandler(Timer_Tick);

    }
    private void Timer_Tick(object o, EventArgs a)
    {

            this.Close();
    } 
```

可能是一种更好的方法（Backgroundworker等）。

# python - pyEphem - 计算非地球卫星的位置

> ID：16172748
> 
> 赞同：4
> 
> 时间：2013-04-23T15:01:46.093
> 
> 标签：python, math, geometry, astronomy, pyephem

我正在尝试获取不绕地球运行的卫星的地球距离和赤经（相对于我在地球上的观察点），但 pyEphem 没有返回与其他太阳体相同的属性。

以木卫三（木星最大的卫星）为例：

```
import math, ephem

Observer = ephem.city('London')
Observer.date = '2013-04-23'
Observer.pressure, Observer.elevation = 0, 100

moonGanymede = ephem.Ganymede(Observer)

print math.cos(moonGanymede.ra) # right ascension
print moonGanymede.earth_distance * ephem.meters_per_au # distance 
```

我收到此错误：

```
AttributeError: 'Ganymede' object has no attribute 'earth_distance' 
```

~~该`ra`属性存在，但它是相对于我的`Observer`还是相对于木星的？~~

*似乎是相对的`Observer`，因为如果我改变位置，值也会改变。*

我已经阅读[了文档](http://rhodesmill.org/pyephem/quick.html#bodies)，我知道这些属性不是为卫星定义的，但我不知道如何计算相对于地球的那些属性，因为月球体的附加定义属性：

> 在行星卫星上，还设置：
> 
> 月球相对于行星的位置（以行星半径测量）
> 
> ```
> x — offset +east or –west
> y — offset +south or –north
> z — offset +front or –behind 
> ```

正在做：

```
print moonGanymede.x, moonGanymede.y, moonGanymede.z 
```

输出：

```
-14.8928060532 1.52614057064 -0.37974858284 
```

由于木星的平均半径为 69173 公里，这些值转化为：

```
moonGanymede.x = 1030200 kilometers (west)
moonGanymede.y = 105570 kilometers (south)
moonGanymede.z = 26268 kilometers (behind) 
```

鉴于我知道木星相对于 的距离和赤经，`Observer`我***如何计算`moonGanymede`（也相对于`Observer`）***的距离和赤经？

我正在使用 pyEphem 3.7.5.1（使用 Python 2.7）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T05:20:32.137

只是一些想法；您可能需要执行两个步骤。

1.  获取卫星相对于母行星的位置
2.  获取行星相对于观察者的位置
3.  三角计算；获取卫星相对于观察者的位置。

您已经完成了 1，并且可以轻松完成 2。将所有值转换为 x、y、z，然后再添加回 angular。或者我确定您/ephym 可以直接为您执行此操作。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-19T10:30:52.427

看起来赤经、赤纬、方位角等计算正确：

```
In [31]: g = ephem.Ganymede(Observer)

In [32]: j = ephem.Jupiter(Observer)

In [33]: g.ra, g.az, g.dec
Out[33]: (1.3024204969406128, 5.586287021636963, 0.38997682929039)

In [34]: j.ra, j.az, j.dec
Out[34]: (1.303646765055829, 5.5853118896484375, 0.39010250333236757) 
```

Ganimede 和 Jupiter 的值足够接近，看起来除了到物体的距离之外，您可以得到正确的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-20T00:42:59.020

我仍在试图弄清楚（如果有人发现了什么，请告诉我），但如果*我*这样做了：

```
sqrt((-14.8928060532)^2 + (1.52614057064)^2 + (-0.37974858284)^2) = 14.9756130481 
```

我总是会得到一个始终落在距轨道中心的最小/最大距离内的值（14.95 - 14.99）。

由于这是在轨道中心半径中指定的，因此我需要将其乘以 69173 * 1000 以获得 SI 单位：

```
14.9756130481 * 69173 * 1000 = 1.0359080813762213 * 10^9 meters 
```

由于 pyEphem 处理与 AU 的距离：

```
print (1.0359080813762213 * 10**9) / ephem.meters_per_au # 0.00692461785302 
```

同时，地球与木星的距离为`5.79160547256`AU。

现在，要获得距离，我应该根据`z`坐标的符号添加或减去：

```
5.79160547256 - 0.00692461785302 = 5.78468085470698 AU 
```

为今天（现在）运行相同的代码返回`6.03799937821`似乎非常接近[WolframAlpha](http://www.wolframalpha.com/input/?i=Ganymede%20distance)`6.031`目前返回的值，它不匹配 100%，但这可能是由一些不同的基础星历库或数据造成的资源。没有把握...

# ios - 通用工具栏和选择器。我需要每次都复制代码吗？

> ID：16172752
> 
> 赞同：0
> 
> 时间：2013-04-23T15:02:06.200
> 
> 标签：ios, objective-c, ios5, ios6, uipopovercontroller

我决定在我的导航控制器中有一个自定义工具栏。为此，我创建了这个通用工具栏类，我的每个视图控制器都会将其添加到其导航项中。

```
@implementation MainLeftToolbar

- (id)init
{
    self = [super initWithFrame:CGRectMake(0, 0, 133, 44)];
    if(self) {
        NSMutableArray* buttons = [[NSMutableArray alloc] initWithCapacity:5];

        // create a standard "add" button
        UIBarButtonItem* bi = [[UIBarButtonItem alloc]
                               initWithBarButtonSystemItem:UIBarButtonSystemItemAdd target:self action:NULL];
        bi.style = UIBarButtonItemStyleBordered;
        [buttons addObject:bi];

        // create a spacer
        bi = [[UIBarButtonItem alloc]
              initWithBarButtonSystemItem:UIBarButtonSystemItemFixedSpace target:nil action:nil];
        [buttons addObject:bi];

        // create a standard "refresh" button
        bi = [[UIBarButtonItem alloc]
              initWithBarButtonSystemItem:UIBarButtonSystemItemRefresh target:self action:@selector(refresh:)];
        bi.style = UIBarButtonItemStyleBordered;
        [buttons addObject:bi];

        // stick the buttons in the toolbar
        [self setItems:buttons animated:NO];
    }
    return self;
}
@end 
```

它是这样设置的：

```
MainLeftToolbar *leftMenuToolbar = [[MainLeftToolbar alloc]init];
self.navigationItem.leftBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:leftMenuToolbar]; 
```

但是，我有按钮，其中之一是显示相机（UIPopover）。我似乎无法让相机出现在 UIToolbar 类中，因此，我需要让它出现在添加了该工具栏的视图控制器中。我考虑过使用委托方法，但这意味着我将不得不复制代码以**在每个**具有此自定义工具栏的视图控制器中显示相机。有任何想法吗？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:24:08.170

好的，我可以在这里想到两个选择：

*   为所有视图控制器创建一个**基类**并在那里实现委托方法。

*   在您的自定义 MainLeftToolbar 中创建一个存储呈现视图控制器的**属性**`MainLeftToolbar`，您在每次创建工具栏时设置它，这样您就可以在类中编写通用代码。

就个人而言，我更喜欢第**一种**方法，这样你也可以在基础 VC 的 init 中编写一次工具栏创建代码，并且它也遵循 MVC 模式。

# java - 如何判断一个函数是返回错误还是产生异常？

> ID：16172753
> 
> 赞同：0
> 
> 时间：2013-04-23T15:02:09.207
> 
> 标签：java

库和 API 有时会返回 -1 或 null 以指示错误。

在其他情况下，它们会产生异常。

如果我必须编写自己的函数，我应该在什么时候使用返回值来指示错误以及什么时候出现异常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:10:09.567

如果使用`String.indexOf(...)`，您将看到它返回 -1，但这不是错误。在查询数据库时也是如此，如果找不到所需的内容，则返回 null。

但是对于真正的错误，真正的问题，最好抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:13:04.517

如果它真的是一个错误（由于一些内部意外错误或因为参数违反了某些约束，函数未能完成它应该做的事情）那么你应该抛出一个异常 - 这就是异常的用途。

例如，您可以返回`null`或 -1 来表示“在给定字符串中查找子字符串的位置”以表示“未找到”。但这不是错误，这是正确和预期的（“非异常”）行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:09:24.703

通常，当某个方法返回一个值时，这是因为是由另一个方法调用的内部方法并在用户可以访问它们时生成异常，您可以处理此异常而不向用户显示错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:09:32.687

编辑：我在不知不觉中冒险进入 java-land.. 这个答案的代码是 c#.. 对此感到抱歉

异常是昂贵的（它们会使你的程序变慢），所以它们应该只用于非常特殊的情况。我的做法是，大多数时候，我只在我的私人函数中返回 -1，因为它们不需要像其他函数那样严格的文档。如果错误经常出现，使用该格式的函数`bool TrySomething(in, out result)`也是一个很好的约定。

然后客户端可以做

```
if(TrySomething(in, out result))
    handle(result);
else
    //failed Something 
```

如果这不切实际，那么通常异常会更安全，因为它们不会给您任何静默错误（除非您使用空`catch`块处理异常）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T15:22:52.340

异常会向开发人员（有时是您自己，通常是其他人）传达特定方法或函数所说的：

> 我无法处理这个问题，这是别人的责任。

例如，如果您的方法正在解析一个字符串并返回一个 int，如果它传递了一个像“xyzzy”这样的字符串，它是否应该返回 -1？

不，-1 会返回错误的错误值，因为“-1”是代表合法 int 的合法字符串。

这是您希望解析方法抛出异常的情况。调用方法必须处理解析异常。您（和未来的）开发人员会明白，处理解析错误是调用者的责任。

编辑：在这种特殊情况下，您可以让函数返回整数而不是 int。然后，您可能有一个合同，它对 Integer 有效但对 int 无效，表示某种错误。但是因为 null 是单个值，所以您的调用程序将无法区分字符串是不可解析的（“xyzzy”）还是太大而无法表示（“2147483648”）。

# javascript - 匹配一个字符后跟另一个字符

> ID：16172754
> 
> 赞同：0
> 
> 时间：2013-04-23T15:02:16.127
> 
> 标签：javascript, regex, match

我想找到 a`.`并在找到 a 后使用正则表达式获取任何字符`(`。我如何做到这一点？

我还想看到一些关于 Javascript 正则表达式的好教程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:06:00.797

看来您在*escaping*的概念上遇到了麻烦。和字符在正则表达式中具有特殊含义，因此您需要通过在它们前面放置一个来转义`.`它们。例如，要匹配文字点，您可以使用`(``\``\.`

对于重复，您可以分别使用`*`or`+`表示 0+ 和 1+。这些用作前面表达式的*修饰符。*因此，例如，`A+`表示“一个或多个`A`字符”，而`A*`表示“零个或多个`A`字符”。您也可以使用`?`修饰符来改变这些匹配的“贪婪”行为，但这是一个更复杂的话题。

如果您需要限制确切的重复次数，可以使用`{n}`语法。例如，您可以使用`A{10}`精确匹配 10 个`A`字符，或`A{3,5}`匹配 3 到 5 个`A`字符。

这些也适用于组和类，例如`[A-Z]{3}`or `(a*b+){3}`。

就 RegEx 教程而言，几乎*没有任何地方*比Regular-Expressions.info[更好](http://www.regular-expressions.info/)，尽管[关于 RegEx 的 MDN 文章在](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)JavaScript 方面也可能有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:17:33.907

Following regex should work for you:

```
[.]([^(]*)[(] 
```

Text you want to capture will be available in group # 1.

Javascript Code:

```
var str='here is a sentance. and some other text ( here )';
var match = str.match(/[.]([^(]*)[(]/);
console.log(match[1]); //  and some other text 
```

### Live Demo: [http://www.rubular.com/r/ALqusiC9EQ](http://www.rubular.com/r/ALqusiC9EQ)

# java - 页面无法加载，Bean 名称 ' ' 的 BindingResult 或普通目标对象可用作请求属性“

> ID：16172758
> 
> 赞同：0
> 
> 时间：2013-04-23T15:02:27.313
> 
> 标签：java, spring-mvc, modelattribute

“ Bean name 'relationForm' 的 BindingResult 和普通目标对象都不能用作请求属性” 我对上面的错误有一些问题，我将在此处发布代码的重要部分。

感谢你们的任何想法controller.java

```
@RequestMapping(value = "addremoverelation/{caseId}", method = RequestMethod.POST)
public ModelAndView addRelation( @ModelAttribute("relationForm") CaseCompleteForm ccf,
    @PathVariable Long caseId,HttpServletRequest request, BindingResult result) {
    //my code
} 
```

jsp 文件

```
<form:form action="${pageRoot}case/addremoverelation/${caseBase.id}"  method="post" id="CaseCompleteForm" modelAttribute="relationForm"> <div>....</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-08T17:48:18.353

创建页面时，您可能没有将“relationForm”对象传递给表单。准备页面时尝试将其添加为模型属性。

```
@RenderMapping
public String viewPage(Model model)
{
    if(relForm == null)
    {
        RelationForm relForm = new RelationForm();
        model.addAttribute("relationForm", relForm);
    }

    return "your/view/jsp/file";
} 
```

希望你明白我的意思。如果您遇到任何进一步的问题，请在评论中回复。

# vb.net - 如何从远程线程触发 WinForms 按钮单击

> ID：16172759
> 
> 赞同：0
> 
> 时间：2013-04-23T15:02:28.957
> 
> 标签：vb.net, multithreading, winforms

我有一个我在 VB 2010 中开发的应用程序。它由一系列 Windows 窗体和一个侦听器进程组成，该进程侦听来自 MIDI 设备（键盘等）的输入。此侦听器进程在单独的线程中运行。

使用回调函数和调用方法，我可以使用在 MIDI 设备上播放的音符的值更新其中一个表单上的文本框的值（下面的代码）。

我似乎无法做的是触发一个按钮按下一个按钮，以便一段代码使用另一个回调函数在同一个表单上运行并调用。

我已经用谷歌搜索了，找不到任何工作示例，所以我不确定这是否可能——我希望这是因为这是我项目的最后 1%！

这是更新表单上的文本框的方法，我需要修改什么才能单击同一表单上名为 btn_NextSection 的按钮？

```
' Because the MIDI listener process runs in a different thread
' it can read the states of controls on the parent form but it
' cannot modify them so we need to identify the parent process
' and update the text box as that one instead

' Set up the callback
Private Delegate Sub SetNextSectionTextCallback(ByVal [text] As String)

' Updates NextSection
Private Sub SetNextSectionText(ByVal [text] As String)
    ' Function to see if the thread that tries to update the
    ' text box is the same as the one that started it.  If it
    ' isn't then locate parent process and update as that one
    If callerInstance.txt_NextSection.InvokeRequired Then
        Dim d As New SetNextSectionTextCallback(AddressOf SetNextSectionText)
        callerInstance.Invoke(d, New Object() {[text]})
    Else
        callerInstance.txt_NextSection.Text = [text]
    End If
End Sub 
```

提前致谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:30:14.717

假设您要运行代码，而不是模拟按钮单击，请尝试这样的事情。Invoke 需要一个函数，因此您可能需要创建一个虚拟返回对象。

```
Private Sub btn_NextSection_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles btn_NextSection.Click
    NextSection()
End Sub

Private Function NextSection() As Object
    'do something on the UI thread
    Return Nothing ' to satisfy the requirements of Invoke
End Function

Private Sub AnotherThreadHere()
    'call NextSection on the UI thread
    Application.Current.Dispatcher.Invoke(Windows.Threading.DispatcherPriority.Background, New Action(Function() NextSection()))
End Sub 
```

# mysql - 在两个 EC2 实例上使用 MySQL 数据库不能在一个实例上运行

> ID：16172766
> 
> 赞同：0
> 
> 时间：2013-04-23T15:02:38.473
> 
> 标签：mysql, ruby-on-rails, ruby-on-rails-3, amazon-ec2, amazon

我正在尝试设置两个 Rails 应用程序。我希望他们两个都使用一个 MySQL 数据库。我的设置是这样的：

使用 Elastic Beanstalk，我设置了两个具有两个不同环境的 Rails 应用程序。我使用 MySQL 数据库设置的应用程序之一。所以现在我有两个 EC2 实例 - 每个 Rails 应用一个和一个 RDS MySQL 实例。

我在两个 EC2 实例中设置了安全组，以便能够通过`port 3306`.

我已经设置了数据库安全组来授权两个 EC2 实例，并且我使用第二个 EC2 实例的私有 IP 设置了 CIDR/IP（在配置 Beanstallk 应用程序时没有设置 MySQL 数据库的那个）

在两个 Rails 应用程序中，我都设置了 database.yml，如下所示：

```
production:
  adapter: mysql2
  encoding: utf8
  database: <%= ENV['RDS_DB_NAME'] %>
  username: <%= ENV['RDS_USERNAME'] %>
  password: <%= ENV['RDS_PASSWORD'] %>
  host: <%= ENV['RDS_HOSTNAME'] %>
  port: <%= ENV['RDS_PORT'] %> 
```

我使用来自第一个 EC2 实例的 ENV 值为第二个实例（没有 MySQL 数据库的那个）上的生产分配了 ENV 值。

我在这里想念什么？

我还将我的计算机 IP 地址添加到 DB 安全组，并且我能够使用我用作 ENV 变量的凭据连接到 MySQL 数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:30:47.440

你可能会错过这个：

```
socket: /var/lib/mysql/mysql.sock 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T22:07:55.683

问题已解决 - 我在 database.yml 文件中设置了数据库凭据，而不是 ENV 变量。每次使用`git aws.push`弹性豆茎时，环境变量都会被覆盖。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-09T14:44:25.397

就我而言，这是因为我使用了错误的 ENV 变量名。`eb ssh`您可以通过使用, 然后连接到您的实例来仔细检查您是否已正确设置所有内容`printenv | grep RDS`，这应该会给您如下信息：

```
RDS_HOSTNAME=yourhostname.amazonaws.com
RDS_DB_NAME=ebdb
RDS_PASSWORD=yourpassword
RDS_USERNAME=yourusername
RDS_PORT=3306 
```

确保这些反映在您的 config/database.yml 文件中 - 通过使用`<%= ENV['varname'] %>`或硬编码它们。显然，前一种选择更可取。:)

# jquery - 选择具有类名 a 的元素也有另一个类名 b

> ID：16172771
> 
> 赞同：0
> 
> 时间：2013-04-23T15:02:49.017
> 
> 标签：jquery

我有两个 div 都有相同的类名`type`，我想选择 div`type`也有类名`a`，

现在我正在使用`filter`它，但我想知道为什么我不能使用`hasClass`？
我得到 console.log TypeError: 'undefined' is not a function（评估 '$('.type').hasClass('.a').show()'）。我编码错了吗？

```
$('.a').click(function(){
    $('.type').hasClass('a').show();
});

<div class="a"></div>
<div class="a type"></div>

<div class="b"></div>
<div class="b type"></div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:04:29.460

当您可以一次简单地选择多个类时，为什么要尝试更复杂的方法：

`$('.type.a').show();`

[**jsFiddle 示例在这里。**](http://jsfiddle.net/3guXc/1/)

* * *

示例代码：

**HTML：**

```
<div class="a">a</div>
<div class="a type">a type</div>

<div class="b">b </div>
<div class="b type">b type</div> 
```

**CSS：**

```
.type {
    display:none;
} 
```

**jQuery：**

```
$('.a').click(function(){
    $('.a.type').show();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:05:04.827

您可以立即选择它们：

```
$('.classOne.classTwo') 
```

# django - django：两种形式，但只有一种形式正在保存

> ID：16172775
> 
> 赞同：1
> 
> 时间：2013-04-23T15:02:59.303
> 
> 标签：django, django-forms, django-views

谁能帮我这个。这段代码有什么问题，因为只保存了一个表单，即form，但没有保存bform。我哪里做错了？？

视图.py

```
def customerView(request, **kwargs):
    this_customer = customer.objects.get(id=kwargs['pk'])
    if request.method == 'POST':
        form = customerForm(request.POST, instance=this_customer)
        bform = buildingForm(request.POST)
        if form.is_valid() and bform.is_valid():
            form.save()
            bform.save()
    else:
        form = customerForm(instance=this_customer)
        bform = buildingForm()
    return render_to_response('customer.html',{'form':form, 'bform':bform,},
                                context_instance = RequestContext(request)) 
```

表格.py

```
class customerForm(ModelForm):
    F_NAME = forms.CharField(widget=forms.TextInput(attrs={'size':'34'}))
    L_NAME = forms.CharField(widget=forms.TextInput(attrs={'size':'34'}))  
    EMAIL  = forms.CharField(widget=forms.TextInput(attrs={'size':'19'}))  
    ADD    = forms.CharField(widget=forms.TextInput(attrs={'size':'34'}))
    class Meta:
        model = customer

class buildingForm(ModelForm):
    CUSTOMER     = forms.CharField(widget=forms.TextInput(attrs={'size':'20'}))
    B_FLOORSPACE = forms.CharField(widget=forms.TextInput(attrs={'size':'4'}))
    B_YEAR       = forms.CharField(widget=forms.TextInput(attrs={'size':'4'})) 
    class Meta:
        model = building
        widgets = {'B_USE'       : RadioSelectNotNull(),
                   'B_TYPE'      : RadioSelectNotNull(),
                  } 
```

编辑添加 template-customer.html

```
<form action="" method="post">
<button type="submit" name="customer">Save</button>  
  {% csrf_token %}
    {{ form.id }} 

 ...more code...
<table> 
  <tr><td><div>First Name</div>{{ form.F_NAME }}</td></tr>     
  <tr><td><div>Last Name</div>{{ form.L_NAME }}</td></tr>
</table>

   ...more code....
<table> 
  <tr><td><div>Build Use</div></td><td>{{ bform.B_USE }}</td>
      <td><div>Build Space</div></td><td>{{ bform.B_FLOORSPACE }}</td>
      </tr>

 ...more code... 
</form> 
```

没有错误说编码有错误。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-23T15:12:09.907

我假设您在模板中以单独的表单元素显示这两个表单。这种方法的问题是您实际上一次只能提交一个表单。幸运的是，Django 提供了 Formsets 作为解决方案。

适当的文档：[https ://docs.djangoproject.com/en/dev/topics/forms/formsets/](https://docs.djangoproject.com/en/dev/topics/forms/formsets/)

# java - 如何将页码添加到表头？

> ID：16172776
> 
> 赞同：0
> 
> 时间：2013-04-23T15:03:00.190
> 
> 标签：java, itext

我创建了一个 PdfPTable（带有标题），它被分成几页。我在模拟模式下使用 ColumnText 添加表格并计算表格显示的页数。现在我正在寻找为每个标题添加 ax/n 计数器的最佳方法。

示例：我的标题行是“关于东西的表格”。我计算，该表分为 3 页。生成的标题应如下所示：第一页的“关于东西 1/3 的表格”，第二页的“关于东西 2/3 的表格”，第三页的“关于东西 3/3 的表格”。

最好的方法是什么？甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:36:08.297

最好的方法是使用单元格事件。

我没有现成的示例，但是您可以通过结合以下示例自己编写一个示例：

在[MovieCountries1](http://itextpdf.com/examples/iia.php?id=104)示例中，我解决了“Y 页的 X”问题。你总是知道 X 的值，但只要你还在创建文档，你就不知道 Y 的值（即总页数）。在你的情况下，你有一个类似的问题。您想添加“Y 的 X 部分”。

您可以通过添加一个您为其创建自定义的空单元格来实现此目的`PdfPCellEvent`。您可以通过在 iText 官方网站上查找关键字[PdfPCell > events](http://itextpdf.com/themes/keyword.php?id=201)找到几个有关单元格事件的示例。

让我们看一下使用自定义命名的[RunLengthEvent](http://itextpdf.com/examples/iia.php?id=94)示例：`PdfPCellEvent``PressPreview`

```
class PressPreview implements PdfPCellEvent {

    public BaseFont bf;

    public PressPreview() throws DocumentException, IOException {
        bf = BaseFont.createFont();
    }

    public void cellLayout(PdfPCell cell, Rectangle rect,
            PdfContentByte[] canvas) {
        PdfContentByte cb = canvas[PdfPTable.TEXTCANVAS];
        cb.beginText();
        cb.setFontAndSize(bf, 12);
        cb.showTextAligned(Element.ALIGN_RIGHT, "PRESS PREVIEW",
            rect.getRight() - 3, rect.getBottom() + 4.5f, 0);
        cb.endText();
    }
} 
```

在此示例中，文本“PRESS PREVIEW”被添加到您添加此事件的所有单元格中，如下所示：

```
PdfPCellEvent press = new PressPreview();
PdfPCell cell = new PdfPCell();
cell.setCellEvent(press); 
```

在您的情况下，您将向自定义事件添加两个成员变量。您将在其中`PdfTemplate`写入 Y 的值。一个`int`用于跟踪事件被触发的次数。那是X。当完整的表格被添加到文档中时，你的Y将等于X，你可以在 上填写这个值`PdfTemplate`。

总结：你想要的不是不可能，但也不是微不足道的。

# lotus-notes - 处理 12000，Lotus Notes 下拉列表中的机构代码

> ID：16172781
> 
> 赞同：1
> 
> 时间：2013-04-23T15:03:15.427
> 
> 标签：lotus-notes, lotus-domino, lotus, lotus-formula

我有一个字段，我想在其中显示一个包含近 12,000 个代理代码的下拉列表，我不太担心 Lotus Client 的性能，我想创建一个配置视图，然后使用 dbcolumn 我可以将值带入归档（非常传统），但我不确定这是否可以处理数据量（12,000），它不会减慢进程。

任何人都可以提出一些更好的解决方案，以便性能可能不是任何问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T17:45:23.723

我认为您可能需要考虑使用调用 @PickList 的按钮。请参阅[此处](http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=/com.ibm.designer.domino.main.doc/H_PICKLIST.html)了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T03:43:05.110

创建一个字段并选择类型作为对话框列表。并选择`Use view dialog for choices`

注意：- 如果返回值超过 32k，DbColumn 将抛出错误。

您也可以使用@PickList。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T16:46:07.183

我想如果在显示值列表时需要刷新视图索引，则会出现最大的瓶颈。我想测试会很快揭示这一点，而且我想无论您使用显示视图的选择列表还是使用您提到的@DBColumn 方法都没有关系。

我不确定会发生什么，性能可能不会那么糟糕。但是，如果性能是一个问题，您可以使用计划代理从视图中读取所有值并将它们存储在配置文件中。在给定 32KB 限制的情况下，您可能需要使用多个字段来存储所有值，但是您的对话列表公式应该只是从配置文件文档中读取几个字段，这应该非常快。

# actionscript-3 - 是否有适用于 ActionScript/Flex 的聪明的空指针检查器实用程序类？

> ID：16172786
> 
> 赞同：2
> 
> 时间：2013-04-23T15:03:30.677
> 
> 标签：actionscript-3, apache-flex, flex4

问题涉及在调用其中的方法或变量之前检查变量是否为空：

```
if(order && order.reference && order.reference.quote)
{
   var length:int = order.reference.quote.findLength();
} 
```

如果有一个函数可以与任何对象一起检查到最后一个对象变量的空指针，那不是很好吗：

IE

```
 // This would check first if order, then order.reference, then order.reference.quote      
    //was null
    if(NullUtil.notNull(order.reference.quote))
    {
        .....
    } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T16:23:45.097

其他一些语言使用存在访问器运算符，例如`?.`（请参阅[CoffeeScript](http://coffeescript.org/)）

如果您不太担心性能，可以执行以下操作：

```
function notNull(object:*, properties:String):Boolean
{
    if (object == null) return false;
    var props:Array = properties.split(".")
    for(var i:uint = 0; i < props.length; i++)
    {
        if(object[props[i]] == null) return false;
        object = object[props[i]]
    }

    return true;
} 
```

然后将其用于：`notNull(order, "reference.quote");`

但这不是很漂亮，但你可以用一些魔法把它清理一下*。*`Proxy`

例如，考虑以下代码：

```
import flash.utils.Proxy;
import flash.utils.flash_proxy;

dynamic class Existential extends Proxy {

    private var _object:*;

    public function Existential(object:*) {
        _object = object;
    }

    flash_proxy override function getProperty(name:*):* {
        var object:* = _object;

        if (object == null) return null;

        var props:Array = name.toString().split("$");

        for(var i:uint = 0; i < props.length; i++)
        {
            if(object[props[i]] == null) return null;
            object = object[props[i]]
        }

        return object;
    }
} 
```

然后，您可以使用它来包装其他对象并使用`$`而不是`.`作为临时存在的 getter 来访问它们。

```
 obj = {};
    eObj = new Existential(obj);
    eObj.what$is$this // null

    obj = { what: { "is":  { "this": 1 } } } ;
    eObj = new Existential(obj);
    eObj.what$is$this  // 1 
```

但我想性能会很糟糕，我不想将它用于任何性能关键的生产代码。但它可能会给你一些想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T17:07:47.723

我会用`try..catch`.

```
try
{
   length = order.reference.quote.findLength();
}
catch(e:ReferenceError){} 
```

优点：

*   避免代码中的条件。
*   相同的代码适用于任何对象和任何深度。

缺点：

*   与您的代码不*完全相同。*例如，如果其中一个属性是引发 ReferenceError 的 getter，则您的代码将引发错误，但此代码不会。
*   使用`try..catch`引入了一些开销。
*   调试起来有点困难。

# jquery - jQuery addClass 在那里保持类

> ID：16172788
> 
> 赞同：3
> 
> 时间：2013-04-23T15:03:36.663
> 
> 标签：jquery

所以我有一些 jQuery 可以向下滑动菜单，当我将鼠标悬停在向下滑动的 DIV 上时，我必须添加悬停类我需要悬停效果才能在菜单项上保持活动状态。

问题是，即使 DIV 消失了，它也只会留在那里——我曾尝试使用 removeClass，但是一旦我滚动到菜单选项 DIV，它就会将其删除。

我在[http://jsfiddle.net/pCTXq/3/有 JsFiddle](http://jsfiddle.net/pCTXq/3/)

jQuery在下面

```
$(document).ready(function() {
    $(".menu_item, .menu_options").hover(function() {
    $(this).addClass('hover');
        $(".menu_options").stop(true, true).slideDown(400);
    }, function() {
        $(".menu_options").stop(true, true).delay(10).slideUp(400);
    });

}); 
```

我查看了 post [jquery hover().addClass() 问题](https://stackoverflow.com/questions/4358964/jquery-hover-addclass-problem)，但这似乎没有多大帮助

在此先感谢您的帮助。

编辑。刚刚还注意到，在 JSfiddle 上似乎也将悬停类添加到 menu_options - 当我在浏览器中测试实际脚本时，情况并非如此

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:07:46.557

# 编辑：

[请参阅此小提琴以获取更新的答案](http://jsfiddle.net/pCTXq/11/)

* * *

如果我正确理解了您的问题，您需要删除悬停类：

```
$(document).ready(function() {
    $(".menu_item, .menu_options").hover(function() {
    $(this).addClass('hover');
        $(".menu_options").stop(true, true).slideDown(400);
    }, function() {
        $(this).removeClass('hover');
        $(".menu_options").stop(true, true).delay(10).slideUp(400);
    });

}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:14:11.927

利用第二个参数来`slideUp`。完成后，然后删除该类。像这样的东西：

```
$(document).ready(function() {
    $(".menu_item, .menu_options").hover(function() {
        $(this).addClass('hover');
        $(".menu_options").stop(true, true).slideDown(400);
    }, function() {
        $(".menu_options").stop(true, true).delay(10).slideUp(400, function( {
            $(".menu_item, .menu_options").removeClass('hover')
        });
    });
} 
```

保存在您的小提琴中[http://jsfiddle.net/pCTXq/9/](http://jsfiddle.net/pCTXq/9/)

所以，基本上，在悬停时添加悬停类（或者 mouseenter 实际上更合适），并且在完成向上滚动之前不要删除它。您可能需要调整添加的内容（从外观上看，`$(".menu_item")`可以这样做），但这是一般的想法。

# html - 用可变计数替换图像编号的 bash 脚本

> ID：16172789
> 
> 赞同：2
> 
> 时间：2013-04-23T15:03:38.333
> 
> 标签：html, bash, shell, sed

我有一个包含 200 张图片的 html 文档。html 页面现在只包含名为 g001.jpg 的所有图像。图像目录中的图像名称为 g001.jpg 到 g200.jpg。我需要用 g002.jpg、g002.jpg、g004.jpg 等替换名称 g001.jpg。我一直在尝试用 bash 来做到这一点。这是我所拥有的：

```
#!/bin/bash
for i in {001..200}

do
sed "s/g001.jpg/g$i.jpg/g" gallery2.html > gallery3.html

done 
```

**为了清楚起见，我正在尝试重命名 html 文档中对图像文件名的引用。不需要重命名 html 文档。

当然，这会将它们重命名为 g1.jpg 几次，然后用 g2.jpg 重新启动几次，然后用 g3.jpg 重新开始，依此类推，直到我得到 g200.jpg 很多次。我错过了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:41:19.787

这里有不少问题。如果您像这样使用 sed ，它将替换每次出现的 &`g001.jpg`而不是第一个实例。你也想替换`g001.jpg with g002.jpg, g002.jpg, g004.jpg`，所以你需要用数字 2 开始循环。下面的代码应该适合你：

```
for l in {2..200}
do
   i=$(printf "%03d" $l)
   sed -i.bak "1,/g001\.jpg/{s/g001\.jpg/g${i}.jpg/g;}" gallery2.html
done 
```

请注意，由于`-i`上面的标志 sed 将进行内联编辑并将替换的文件保存在同一文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:11:35.637

只需将循环变量合并到输出文件名中。注意 gallery$i_new.html 是我的命名...

```
for i in {001..200}
do
   sed "s/g001.jpg/g$i.jpg/g" gallery$i.html > gallery$i_new.html
done 
```

# bing-maps - 在 Bing 地图中将光标设置为张开的手

> ID：16172790
> 
> 赞同：2
> 
> 时间：2013-04-23T15:03:44.130
> 
> 标签：bing-maps

我正在使用 Bing Maps AJAX V7 地图 API 进行开发，并且尝试将光标设置为不同的事物，同时将鼠标悬停在不同的地图元素上。例如，当鼠标在图钉上滚动时，这就是我正在做的事情：

```
Microsoft.Maps.Events.addHandler(g_map, "mousemove", function (event) {
    if (event.targetType === "pushpin") {
        g_map.getRootElement().style.cursor = "pointer";
    }
}); 
```

我想不通的是如何在用户将鼠标移出图钉后恢复正常功能。我在想也许将光标设置为 mouseenter 上的指针并返回到 mouseleave 上的非指针或其他东西，但我不确定这是否是最好的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T22:59:39.100

您正在使用底图上的事件，因此我建议将事件绑定到图钉本身，以避免不必要地调用此特定事件。

但是，如果您想更新您的代码，这里有一个真正有效的完整示例，因为当鼠标悬停在基本地图上时，“手”是 Bing 地图中的默认元素，请参见代码：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Bing Maps Cursor</title>
    <script type="text/javascript" charset="UTF-8" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
    <script type="text/javascript">
        var map = null;

        function getMap() {

            // Initialize the map
            map = new Microsoft.Maps.Map(document.getElementById('map'), {
                credentials: "YOURKEY",
                center: new Microsoft.Maps.Location(47.5, 2.75),
                zoom: 4,
                mapTypeId: Microsoft.Maps.MapTypeId.road
            });

            var pin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(47.5, 2.75));
            map.entities.push(pin);    

            Microsoft.Maps.Events.addHandler(map, 'mousemove', function(event) {
                if(event.targetType === 'pushpin') {
                    map.getRootElement().style.cursor = 'pointer';
                } else {
                    map.getRootElement().style.cursor = 'url("' + Microsoft.Maps.Globals.cursorPath + 'grab.cur"), move';
                }
            });
        }
    </script>
</head>
<body onload="getMap();">
    <div id="map" style="position: relative; width: 800px; height: 600px;">
    </div>
</body>
</html> 
```

如果您想要基于图钉事件的推荐方法：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Bing Maps Cursor</title>
    <script type="text/javascript" charset="UTF-8" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
    <script type="text/javascript">
        var map = null;
        var cursorStyle = null;

        function getMap() {

            // Initialize the map
            map = new Microsoft.Maps.Map(document.getElementById('map'), {
                credentials: "YOURKEY",
                center: new Microsoft.Maps.Location(47.5, 2.75),
                zoom: 4,
                mapTypeId: Microsoft.Maps.MapTypeId.road
            });

            var pin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(47.5, 2.75));
            map.entities.push(pin);    

            Microsoft.Maps.Events.addHandler(pin, 'mouseover', changeCursor);
            Microsoft.Maps.Events.addHandler(pin, 'mouseout', revertCursor);    
        }

        function changeCursor(e) { 
            map.getRootElement().style.cursor = 'pointer';
        }
        function revertCursor(e) { 
            map.getRootElement().style.cursor = 'url("' + Microsoft.Maps.Globals.cursorPath + 'grab.cur"), move';
        }
    </script>
</head>
<body onload="getMap();">
    <div id="map" style="position: relative; width: 800px; height: 600px;">
    </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-01T11:04:49.863

我试图完成类似的任务 - 将光标悬停在图钉上时将光标更改为指针。我已经尝试了几种使用事件处理程序的解决方案 - 地图和每个引脚的“mouseout”、“mouseover”事件的不同组合。我在使用这些方法时遇到了一些问题：有时事件处理程序没有按预期调用，并且我的光标在悬停在图钉上后粘在指针上，将光标恢复为拖放需要我引用 bing 的自定义光标（[https://ecn.dev.virtualearth.net/mapcontrol/v7.0/7.0.20140318165546.99/cursors/grab.cur](https://ecn.dev.virtualearth.net/mapcontrol/v7.0/7.0.20140318165546.99/cursors/grab.cur)），这是不可靠的，因为这个链接可以随时更改。

因此，在我看来，更改图钉光标的更好的解决方案是：

```
<style>
    .MapPushpinBase { cursor: pointer !important; }
</style> 
```

在我的情况下，它会在需要时恢复到适当的光标，并且不需要我引用 bing 的资源。

但是，我不确定这是否可以应用于其他实体类型，例如折线。此外，此解决方案将为页面上的每个图钉应用光标样式，因此您可能需要稍微修改图钉样式。

升级版：

如果您不想弄乱 bing 的基本样式，您可以将自定义 CSS 类应用于图钉，您希望有指针光标，如下所示：

```
.my-pin {
    cursor: pointer !important;
} 
```

在 Javascript 中：

```
new Microsoft.Maps.Pushpin(location, {typeName: 'my-pin'}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T16:47:13.993

我需要做类似的事情（根据鼠标当前悬停的内容更改鼠标光标），并且我使用该`mouseout`事件将光标设置回`default`：

```
Microsoft.Maps.Events.addHandler(g_map, "mouseout", function (event) {
    if (event.targetType === "pushpin") {
        g_map.getRootElement().style.cursor = "default";
    }
}); 
```

请记住，当您通过鼠标与地图交互时，Bing 地图 ajax 控件始终会自行更改鼠标光标，因此如果您自己更改鼠标指针，有时您会进入奇怪的视觉状态。没什么大不了的，你只需要意识到它。

# r - 在固定宽度文件中读取多个相同列

> ID：16172793
> 
> 赞同：4
> 
> 时间：2013-04-23T15:03:51.303
> 
> 标签：r, stata

考虑以下来自[Stata .dct 文件](ftp://ftp.cdc.gov/pub/Health_Statistics/NCHS/dataset_documentation/nhamcs/stata/ed02.dct)的几行，该文件为 Stata 定义了如何读取[这个固定宽度的 ASCII 文件](ftp://ftp.cdc.gov/pub/Health_Statistics/NCHS/Datasets/NHAMCS/ED2002.EXE)（可以使用任何平台上的任何 ZIP 软件解压缩）：

```
start             type                            varname width  description
_column(24)       long                               rfv1   %5f  Patient's Reason for Visit #1            
_column(29)       long                               rfv2   %5f  Patient's Reason for Visit #2             
_column(34)       long                               rfv3   %5f  Patient's Reason for Visit #3             
_column(24)       long                             rfv13d   %4f  Patient's Reason for Visit #1 - broad     
_column(29)       long                             rfv23d   %4f  Patient's Reason for Visit #2 - broad     
_column(34)       long                             rfv33d   %4f  Patient's Reason for Visit #3 - broad 
```

基本上，这个 ASCII 文件每一行中的第 24 到第 39 个字符如下所示：

```
AAAAaBBBBbCCCCc 
```

第一个广义代码在哪里`AAAA`，出于同样原因的较窄代码是`AAAAa`，等等。

换句话说，由于代码本身具有层次结构，因此每行中的相同字符被读取两次以创建两个不同的变量。

`read.fwf`相比之下，它只接受一个`widths`参数，从而排除了这种类型的双重阅读。

`scan`有没有一种标准的方法来处理这个问题，而不是通过在整个文件中重新创建轮子并手动解析它？

`(start, width)`这里的背景是我正在编写一个函数来解析这些 .DCT 文件，采用 SAScii 的风格，如果我可以为每个变量指定对，而不仅仅是.DCT 文件，我的工作会简单得多`widths`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T16:28:09.043

我已经开始研究 .DCT 解析器，但失去了动力。我的预期使用场景实际上是简单地解析文件并创建一个[csvkit](https://csvkit.readthedocs.org/en/latest/) [模式文件](https://csvkit.readthedocs.org/en/latest/scripts/in2csv.html)，以允许我使用 csvkit 将文件从固定宽度转换为 csv。为此，该软件包是成功的，但它非常未完善，并且仅经过了很少的测试。

需要注意的几个问题包括 (1) 并非所有 DCT 文件都有相同的列；(2) 一些 DCT 文件有*隐含*小数位的说明，我从来没有想出处理这些类型文件的方法。

[您可以在此处](https://github.com/mrdwab/StataDCTutils)找到有关该包的初始工作。

主要功能有：

*   `dct.parser`-- 做你所期望的。在前几行中有一个“预览”参数，可让您确定 DCT 文件是否包含您期望的所有列。
*   `csvkit.schema`-- 使用从 中提取的信息，创建一个 csv 文件，其中包含 csvkit`dct.parser`所需的相关列。`in2csv`
*   `csvkit.fwf2csv`-- 基本上是`system`对 csvkit 的调用。也可以在 R 之外完成。

对于您的特定示例，我使用以下方法成功阅读了它：

```
## The extracted data file and the DCT file are in my downloads directory
setwd("~/Downloads/") 
dct.parser("ed02.dct", preview=TRUE) ## It seems that everything is there
temp <- dct.parser("ed02.dct")       ## Can be used as a lookup table later

## The next line automatically creates a csv schema file in your 
##   working directory named, by default, "your-dct-filename.csv"
csvkit.schema(temp) 
csvkit.fwf2csv(datafile = "ED02", schema="ed02.dct.csv", output="ED02.csv")

## I haven't set up any mechanism to check on progress...
## Just check the directory and see when the file stops growing :)
ED02 <- read.csv("ED02.csv") 
```

我打算研究（但从未做过）的另一个替代方法是使用`paste`构建`substr`命令，这些命令可用于`sqldf`读取列包含重叠数据的数据。请参阅[此博客文章](https://sites.google.com/site/timriffepersonal/DemogBlog/newformetrickforworkingwithbigishdatainr)以获取入门示例。

* * *

### 更新：一个`sqldf`例子

如上所述，`sqldf`可以很好地利用`dct.parser`数据的输出和读入`substr`。以下是您将如何执行此操作的示例：

```
## The extracted data file and the DCT file are in my downloads directory
setwd("~/Downloads/") 
temp <- dct.parser("ed02.dct")       ## Can be used as a lookup table later

## Construct your "substr" command
GetMe <- paste("select", 
               paste("substr(V1, ", temp$StartPos, ", ",
                     temp$ColWidth, ") `", temp$ColName, "`", 
                     sep = "", collapse = ", "), 
               "from fixed", sep = " ")

## Load "sqldf"
library(sqldf)

fixed <- file("ED02")
ED02 <- sqldf(GetMe, file.format = list(sep = "_"))
dim(ED02)
# [1] 37337   260 
```

可以看出，该`sqldf`行需要进行一些修改。特别是，由于`sqldf`uses `read.csv.sql`，它会将数据中的任何逗号字符视为分隔符。您可以将其更改为您在数据中不期望的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-22T08:02:37.030

这只是刚刚用 Stata 标记（感谢@Metrics），所以可能很多 Stata 爱好者都没有注意到。

从纯Stata的角度来看，读取每个5位变量似乎很简单`long`，然后通过例如提取前4位数字

```
. gen rvf13d = floor(rvf13/10) 
```

或将这些代码作为字符串读入，然后

```
. gen rvf13d = substr(rvf13, 1, 4) 
```

因此，您永远不需要两次读取相同的数据。

就是说，这似乎与问题无关，其中给出了字典文件，而您不想手动编辑几个文件中的每一个。

# powershell - PowerShell - Get-QADUser = 'System.OutOfMemoryException'

> ID：16172794
> 
> 赞同：0
> 
> 时间：2013-04-23T15:04:00.440
> 
> 标签：powershell, quest

我正在运行 MySQL Query 来更新 MS AD 并将错误输出到 txt 文件。代码工作正常，但几分钟后我收到错误“System.OutOfMemoryException”。

下面是一小段代码。

```
Function Addmembers {

$query = "SELECT * FROM allstudents_groups"
$dtResult = New-Object "System.Data.DataTable"

$hashOptions = @{ } 
$hashOptions["strServer"] = "servername"
$hashOptions["strDatabase"] = "DB"  
$hashOptions["strUser"] = "user"
$hashOptions["strPassword"] = "pass"
$hashOptions["strQuery"] = $query
$dtResult = executeMYSQLQuery($hashOptions) 
$OU = "OU=Class Group,DC=company,DC=internal"

ForEach ($row in $dtResult){
    $result = $row.GroupName
    $resmember = $row.Members
    $out_file = "C:\Scripts\Users.txt"
    $studentOU = "OU=Users,OU=CHS,OU=Est,DC=Company,DC=internal"
    $resmember | %{$_.Split(',')} | %{
        If(Get-QADUser -PageSize 1000 -DontUseDefaultIncludedProperties -SizeLimit 0 -SearchRoot "$studentOU" -LdapFilter "(name=$_)")
        {Add-ADGroupMember -Identity $result -Members "$($_)"
        [System.GC]::Collect()
    }

Else
    {"$_" | out-file "$out_file" -append}
}}
[System.GC]::Collect()
}
$dtResult = $Null
}
Addmembers 
```

我相信这是由于代码获取了所有数据库内容并试图将其保存在内存中。我认为 ForEach-Object 会阻止内存填满，但这似乎不支持逻辑。我也尝试在 IF 语句中添加一个 [System.GC]::Collect() 但这并不能阻止 RAM 爬升

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T07:44:01.760

谢谢回复。

放置回车和输出行似乎可以更好地处理这项工作并完成整个数据库表。

```
 If(Get-QADUser -PageSize 1000 -DontUseDefaultIncludedProperties -SizeLimit 0 -SearchRoot "$CLVOU" -LdapFilter "(name=$resteach)")
        {
        Write-Output "$resteach is being added to $result"
        Add-ADGroupMember -Identity $result -Members "$resteach"
        [System.GC]::Collect()
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-27T00:27:06.217

看起来您将整个结果集存储在此变量中：`$dtResult`

因此，假设它是一个大型记录集，它很容易消耗您的所有内存。您可以尝试以下类似的方法。Foreach-Object 将在每个对象进入时将其发送到管道中，而不是尝试将其全部保存在内存中然后对其进行迭代。

```
executeMYSQLQuery($hashOptions) | Foreach-Object {
   $result = $_.GroupName
   $resmember = $_.Members

   #etc...

} 
```

# c# - 实体框架正在执行太多查询

> ID：16172796
> 
> 赞同：7
> 
> 时间：2013-04-23T15:04:12.903
> 
> 标签：c#, sql-server, asp.net-mvc, performance, entity-framework

我需要找到特定用户的不同活动。用户拥有 CodeRights，CodeRights 包含 Codes，Codes 包含 Campaign。这是 CodeRight 类

```
public class SmartCodeRight
{
        [Key, Column(Order = 1)]
        public long UserId { get; set; }
        public virtual User User { get; set; }

        [Key, Column(Order = 2)]
        public long CodeId { get; set; }
        public virtual SmartCode Code { get; set; }

        public CodeRight CodeRight { get; set; }
} 
```

我会为此编写以下 SQL：

```
SELECT * 
FROM campaigns 
WHERE campaignid IN (SELECT DISTINCT campaignid  
                     FROM smartcodes t1 
                     INNER JOIN smartcoderights t2 ON t1.codeId = t2.codeId
                     WHERE t2.userid = @userId) 
```

使用 EF 我正在编写以下代码：

```
var v = user.CodeRights.Select(r => r.Code.Campaign).Distinct().ToList(); 
```

现在在分析时，我看到 EF 正在为每个存在的 CodeRight 执行 2 个 SQL 查询。

我还计算了整个执行的时间，**EF 在使用 ADO.Net 时需要 ~400 毫秒，它只有 ~8**。

现在我的问题是，如果 EF 真的这么慢还是我做错了什么？

**编辑**

正在为每个 CodeRight 执行以下两个块

```
exec sp_executesql N'SELECT 
[Extent1].[CodeId] AS [CodeId], 
[Extent1].[CodeTitle] AS [CodeTitle], 
[Extent1].[CodeContent] AS [CodeContent], 
[Extent1].[CreatedOn] AS [CreatedOn], 
[Extent1].[IsActive] AS [IsActive], 
[Extent1].[Deleted] AS [Deleted], 
[Extent1].[OwnerId] AS [OwnerId], 
[Extent1].[Tags] AS [Tags], 
[Extent1].[CampaignId] AS [CampaignId]
FROM [dbo].[SmartCodes] AS [Extent1]
WHERE [Extent1].[CodeId] = @EntityKeyValue1',N'@EntityKeyValue1 bigint',@EntityKeyValue1=24
go 
```

和

```
exec sp_executesql N'SELECT 
[Extent1].[CampaignId] AS [CampaignId], 
[Extent1].[Name] AS [Name], 
[Extent1].[Description] AS [Description], 
[Extent1].[AdminId] AS [AdminId]
FROM [dbo].[Campaigns] AS [Extent1]
WHERE [Extent1].[CampaignId] = @EntityKeyValue1',N'@EntityKeyValue1 int',@EntityKeyValue1=12
go 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-23T15:42:46.433

您应该花时间查看[Fetch Plans for Entity Framework](http://dotnetslackers.com/articles/ado_net/A-Feature-driven-Comparison-of-Entity-Framework-and-NHibernate-Fetch-Plans.aspx)。为了让 EF 执行连接，您必须使用`Include`关键字。

当您获取`user`对象时，它必须是您初始查询的一部分：

```
var user = context.Users
    .Include("CodeRights.Code")
    .Include("CodeRights.Campaign")
    .FirstOrD‌​efault(u => u.Id == id); 
```

# java - 如何使用java和jsp在浏览器页面中绘制一个矩形？

> ID：16172800
> 
> 赞同：0
> 
> 时间：2013-04-23T15:04:18.893
> 
> 标签：java, jsp, webpage

在实践中，我对 jsp-java 很陌生。我正在尝试编写一个脚本，允许用户通过用鼠标单击和拖动来绘制一个矩形。但是，我真正不明白的是：是否可以在不建立像窗口 Jpanel 或 JFrame 这样的支持的情况下绘制一个矩形，因为我希望在网页上显示而不是在新打开的窗口上显示。这个矩形将如何在浏览器的页面上输出？如何从 Java 桌面应用程序窗口切换到网页窗口？我不希望用户必须打开一个新的窗口应用程序，用户可以在网页中使用鼠标直接绘制矩形会很酷。抱歉有些重复，我只是想尽可能清楚，因为我刚开始所有这些东西！提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:31:16.143

看来您正在混合技术。你的问题的答案是“不”。你不能用 JSP 做到这一点。

但是您可以与其他人一起，就像评论中提到的那样，使用画布的 html5 可以让您跟随鼠标位置进行绘制。

如果您真的希望使用 Java，您可以使用嵌入在网页中的 Applet。

# ruby-on-rails - 删除 has_and_belongs_to_many 表中的记录 - Rails

> ID：16172805
> 
> 赞同：0
> 
> 时间：2013-04-23T15:04:37.770
> 
> 标签：ruby-on-rails, has-and-belongs-to-many

我一直在寻找，但找不到关于如何删除 HABTM 表中记录的好答案。我想很多人都有同样的要求。

简单地说，我有学生、班级和班级_学生

我希望学生能够放弃课程，或删除已为该学生注册该课程的 HABTM 记录。

对此必须有一个简单的答案。有谁知道它是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-23T00:18:14.783

.destroy 或 .delete 在这种情况下不起作用的原因是由于中间表中缺少主键。然而，我们的父对象有一个非常酷的方法，叫做 {other_obj}_ids。它是左表对象、右表对象的 id 集合。这些信息当然是从我们的中间表中填充的。

因此，考虑到这一点，我们有 2 个对象类（学生和类）。如果您不做任何花哨的事情，活动记录魔法通常可以找出中间表，但建议使用 has_many :through。

```
class Student < ActiveRecord::Base
    has_and_belongs_to_many :classes
end

class Classes < ActiveRecord::Base
    has_and_belongs_to_many :students
end 
```

我们现在可以用这个设置在中间表方面做什么......

```
student = Student.find_by(1)
student.classes # List of class objects this student currently has. 
student.class_ids # array of class object ids this student currently has

# how to remove a course from the middle table pragmatically
course = Course.find_by({:name => 'Math 101'})

# if this is actually a real course...
unless course.nil? 
   # check to see if the student actually has the course...
   if student.class_ids.include?(course.id)
       # update the list of ids in the array. This triggers a database update
       student.class_ids = student.class_ids - [course.id]
   end
end 
```

我知道回答这个问题有点晚了，但我今晚刚刚经历了这个确切的情况，想在这里分享解决方案。

现在，如果您希望它被表单删除，因为您现在可以看到它是如何实际处理的，只需确保表单输入是嵌套的，这样它就具有以下效果：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:06:38.803

你遇到什么麻烦了？你的关系有适当的 :dependent=>:destroy 和 :inverse_of=>[foo] 吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:59:14.580

假设一个课程有一个课程名称。你可以做：

```
student.classes.find_by_course_title("Science").delete 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-23T03:12:38.143

所以这里的正确答案是在你看来做这样的事情：

```
<%= link_to 'Remove', cycle_cycles_group_path(@cycle, cycle), method: :delete %><br /> 
```

`cycle`来自上面代码所在的块。

`@cycle`是来自连接模型控制器的实例变量。

`cycle_cycles_group_path`是文件中模型“Cycle”下的嵌套连接表“cycles_groups” `routes.rb`：

```
resources :cycles do 
  resources :cycles_groups do
  end
end 
```

连接模型控制器如下所示：

```
def destroy
    @cycles_group = CyclesGroup.find(params[:id])
    @cycle = @cycles_group.cycle
    @cycles_group.destroy

    puts "cycle: #{@cycle}"

    respond_to do |format|
        format.html {redirect_to cycle_path(@cycle), notice: 'Training Week was successfully removed!'}
    end
end 
```

# php - 仅在某些屏幕分辨率下包含 php 文件

> ID：16172806
> 
> 赞同：2
> 
> 时间：2013-04-23T15:04:43.260
> 
> 标签：php, javascript, jquery

我在响应式设计方面遇到了 AdSense 问题。我发现的一种解决方案是，如果窗口大小不够大，则根本不加载它们。所以我想我会用广告代码、容器等创建一个单独的 php 文件，然后将其包含在页面上。但是，如果窗口宽度为 720 像素或以上，我不知道如何仅包含此文件，否则不包含此文件。也许，可以以某种方式使用 javascript，但不确定它如何与所有 dom 和 php 包含一起工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:09:58.940

您可以尝试以下方法：

```
<script language=javascript>
    if (screen.width >= 720 ) 
         $('#place_holder_div').load('file_from_server.php');
</script> 
```

这`#place_holder_div`是您的 html 文件中的一个 div。语法是`Jquery`，但如果您愿意，当然可以使用纯 javascript。代码查看屏幕宽度，如果大于 720 像素，则将 php 文件`file_from_server.php`（将包含您的广告）加载到占位符 div 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:13:01.833

了解客户端的窗口或屏幕大小的唯一方法是使用 JavaScript。

```
window.innerHeight; // Available height of the browser for the document
window.innerWidth; // Available width of the browser for the document
window.outerHeight; // Browser height
window.outerWidth; // Browser width
window.screen.height; // Screen height
window.screen.width; // Screen width 
```

在检查完这些之后，您可以对相关文件进行 HTTP 请求。然而，这可能不是最好的解决方案，因为用户实际上可以在任何给定时间更改上述任何大小。

# jquery - 将 Web 方法添加到自定义服务器控件

> ID：16172807
> 
> 赞同：1
> 
> 时间：2013-04-23T15:04:45.403
> 
> 标签：jquery, asp.net, asmx, custom-server-controls, asp.net-webcontrol

我创建了一个服务器用户控件，我希望它能够使用 WebMethod。如果 web 方法在我的主应用程序中（作为 ASMX 文件），它可以正常工作。问题是我想将此方法包含在与用户控件相同的项目库中，以便我可以将 DLL 作为独立项目分发。因为该项目是一个类库，所以我不得不将 Web 服务设为 VB 文件，而不是 .ASMX。当我尝试在我的 .VB 文件中调用 web 方法时，似乎什么都没有发生（没有错误，但我的 webmthod 上的断点从未达到） 这可以完成吗？以下是我如何创建控件的示例：

Web 方法，在 myClass.VB 中：

```
 <System.Web.Script.Services.ScriptService()> _
 <WebService(Namespace:="http://tempuri.org/")> _
 <WebServiceBinding(ConformsTo:=WsiProfiles.BasicProfile1_1)> _     
 Public Class myClass
     Inherits System.Web.Services.WebService
<WebMethod()> _
Public Function TestMethod(ByVal prefixText As String) As String
    return "Hello World"
end Function 
```

我的服务器控件是这样设置的，在 miniActiveDirectorySearch.VB 中：

```
Public Class miniActiveDirectorySearch
 Inherits WebControl
   Private Sub attachWebResources()  
     ScriptManager.RegisterClientScriptResource(Me, Me.GetType, "myScripts.js")
     ScriptManager.RegisterClientScriptResource(Me, Me.GetType, "jquery-1.4.1.min.js")
   End Sub
    Protected Overrides Sub CreateChildControls()
        createDynamicControls()
        MyBase.CreateChildControls()
    End Sub
    Protected Overrides Sub OnInit(ByVal e As System.EventArgs)
        attachWebResources()
        MyBase.OnInit(e)
    End Sub
    Private Sub createDynamicControls()
        Controls.Clear()

        Try
            tblMainLayout = buildMaintable() 'builds out the control
            'to save space, I removed how this works.  But, it creates a textbox that
            'has a onKeyPress Event.  When the user hits return, it calls the jQuery
            'function serviceCall
            Controls.Add(tblMainLayout)
        Catch ex As Exception
            Throw New ApplicationException("Exception Occurred", ex.InnerException)
        End Try
    End Sub
 end Class 
```

和我的 JQuery 方法，在 myScripts.js 中找到：

```
function serviceCall(getText, tbId, divId, bgColor) {
   $.ajax({
    type: "POST",
    url: 'myClass.asmx/TestMethod',
    data: '{"prefixText":"'some test'"}',
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (msg) {
       alert('Success')           
    },
    error: function (e) {
         alert('Error')   
    }
}); 
```

我创建了服务类并将其包含在与我的用户控件相同的项目中，但从未调用该服务。另一方面，如果我将服务放在我的 Web 项目中的 ASMX 文件中，它将很好地到达 Web 方法。

任何帮助都会很棒

谢谢杰森

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:29:43.560

抱歉，如果您使用旧的 ASMX 技术，那么您将无法使用 ASMX 文件。另一方面，您可以使用 WCF 执行此操作。

# box2d - box2d 中的奇怪方法 applyForceToCenter

> ID：16172809
> 
> 赞同：0
> 
> 时间：2013-04-23T15:04:53.593
> 
> 标签：box2d

我刚学会使用box2d。这是我的问题。

系统启动时，如果我用方法`ApplyForceToCenter`来控制盒子的速度，身体只是飞走了，但下次我`ApplyForceToCenter`用方法时，它又恢复正常，盒子不飞，它的速度是对的。

我的意思是方法`ApplyForceToCenter`，第一次是错误的，下一次和其他次都是正确的。

有人可以帮我吗？对此，我真的非常感激。

顺便说一句，我没有在 world's 中使用它`Step()`，我只是将它包含在我的类方法中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T05:02:04.963

结果是 My Schedule 运行有点慢，这使得 World's Step 接受的 timeStep 比预期的大。然后使用 F* t(bigger) = m * vt - m * v0 vt 非常大。结果是盒子飞走了。

# python - 子类属性不同的名称

> ID：16172810
> 
> 赞同：0
> 
> 时间：2013-04-23T15:04:53.743
> 
> 标签：python

我希望子类的属性与其父类的相同属性具有不同的名称，即使它的含义相同。例如，父类是具有“height”属性的 Shape 和具有相似艺术属性“Diameter”的子类 Circle。下面是我目前拥有的简化，但我希望 Circle 类使用“直径”而不是“高度”。处理这个问题的最佳方法是什么？

注意：我将在另一个类中从 Circle 继承，该类也需要使用“直径”而不是“高度”。谢谢！

```
class Shape():
    def __init__(self, shape, bar_args, height):
        self.shape = shape
        self.height = height
        etc.

class Circle(Shape):
    def __init__(self, height, foo_args, shape='circle'):
    Shape.__init__(self, shape, height)
        self.height = height
        etc. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:18:36.770

您可以定义一个在读写访问时访问原始属性的属性[：](http://docs.python.org/2/library/functions.html#property)

```
class Circle(Shape):
    def __init__(self, height, foo_args, shape='circle'):
        Shape.__init__(self, shape, height) # assigns the attributes there
        # other assignments
    @property
    def diameter(self):
        """The diameter property maps everything to the height attribute."""
        return self.height
    @diameter.setter
    def diameter(self, new_value):
        self.height = new_value
    # deleter is not needed, as we don't want to delete this. 
```

如果您经常想要这种行为并且您发现使用 setter 和 getter 处理属性太不方便，您可以更进一步并[构建](http://users.rcn.com/python/download/Descriptor.htm)自己的[描述符类](http://docs.python.org/2/reference/datamodel.html#implementing-descriptors)：

```
class AttrMap(object):
    def __init__(self, name):
        self.name = name
    def __get__(self, obj, typ):
        # Read access to obj's attribute.
        if obj is None:
            # access to class -> return descriptor object.
            return self
        return getattr(obj, self.name)
    def __set__(self, obj, value):
        return setattr(obj, self.name, value)
    def __delete__(self, obj):
        return delattr(obj, self.name) 
```

有了这个，你就可以做到

```
class Circle(Shape):
    diameter = AttrMap('height')
    def __init__(self, height, foo_args, shape='circle'):
        Shape.__init__(self, shape, height) # assigns the attributes there
        # other assignments 
```

并且`diameter`描述符会将对其的所有访问重定向到命名属性（此处为：）`height`。

# node.js - 如何解决这个 node.js 路径问题？

> ID：16172811
> 
> 赞同：0
> 
> 时间：2013-04-23T15:04:54.307
> 
> 标签：node.js, express

我正在重构我的 server.js 文件并尝试合并 MVC 模式。我在尝试从我的 routes.js 访问我的控制器时遇到了问题。我已经尝试了几乎所有我能想到的绝对和相对路径的变体，但我必须遗漏一些东西。这是我的目录结构： ![在此处输入图像描述](https://i.stack.imgur.com/iSbcz.png)

从我的 routes.js 中，这是我的代码：

```
module.exports = function ( app, passport, auth ) {
    var Clients = require('controllers/clients');
    app.get('/clients', Clients.list);
} 
```

我认为这无关紧要，但这是我的客户控制器：

```
var mongoose = require('mongoose')
    , Client  = mongoose.model('Client');

exports.list = function( req, res ) {
    Client.find( function( err, clients ) {
        res.renderPjax('clients/list', { clients: clients, user: req.user });
    });
} 
```

这是我尝试从路由访问我的控制器时遇到的错误：

```
module.js:340
    throw err;
          ^
Error: Cannot find module 'controllers/clients'
    at Function.Module._resolveFilename (module.js:338:15)
    at Function.Module._load (module.js:280:25)
    at Module.require (module.js:364:17)
    at require (module.js:380:17)
    at module.exports (/Users/sm/Desktop/express3-mongoose-rememberme/app/routes.js:5:16)
    at Object.<anonymous> (/Users/sm/Desktop/express3-mongoose-rememberme/server.js:334:24)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12) 
```

我敢肯定，我看得太简单了。如何从我的路由访问我的控制器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:06:37.987

要要求不是单独的包（不在 中`node_modules`）的东西，您需要使用明确的相对路径：

```
require('./controllers/clients') 
```

有关详细信息，请参阅[文档](http://nodejs.org/api/modules.html#modules_file_modules)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:08:07.053

# 本地模块

`require(...)`采用本地模块的相对路径

```
require('./controllers/clients') 
```

# 已安装的模块

对于通过 安装的模块`npm install -S foo`，使用语法

```
require('foo') 
```

# javascript - 动态 div 中的响应式图像

> ID：16172812
> 
> 赞同：0
> 
> 时间：2013-04-23T15:04:57.607
> 
> 标签：javascript, image, html, dynamic

首先，我想向您展示我想要创建的内容。 [例子！](http://ks-weddings.de/)！在这里，您必须继续“Galerien”，现在调整浏览器的高度或宽度。您会看到图像/div 自动适合容器。

只关注宽度是没有问题的，但是你必须结合宽度和高度，没有图像溢出容器。我使用 javascript，我想创建 if 条件来防止溢出。

很难解释，但我希望这个例子能说明我的问题。

非常感谢。

# jquery - jQuery UI 工具提示生成 -27000px 的定位

> ID：16172820
> 
> 赞同：1
> 
> 时间：2013-04-23T15:05:09.320
> 
> 标签：jquery, jquery-ui, tooltip

我在带有重力形式的动态 WordPress 网站上使用 jQuery UI 工具提示来为复选框创建工具提示。我已经设法使用标准 jQuery 提取所有动态信息，并且一切正常，包括工具提示。现在唯一的问题是工具提示定位（x 和 y）类似于 -27000px。是否有任何定位警告可能导致这种情况或其他原因？

你可以看看这里：[http ://dev2.roimedia.co.za/roimedia/contact-us/request-a-quote/](http://dev2.roimedia.co.za/roimedia/contact-us/request-a-quote/)

联合国：客户密码：演示

我在 Stack Overflow - [jquery tooltipnegative position](https://stackoverflow.com/questions/15926561/jquery-tooltip-negative-position)上发现了这个类似的问题，但我没有运行另一个工具提示库。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T10:51:29.610

嗯.. 我看到我的 jQuery 文件是空的，这很奇怪。

另外，我看到 qTip 被称为类似问题。这是由我之前的其他开发人员完成的。谢谢。关闭。

# vbscript - VBscript RecordCount 属性

> ID：16172829
> 
> 赞同：1
> 
> 时间：2013-04-23T15:05:31.060
> 
> 标签：vbscript, ado, recordset

我是 VBScript 的新手，我遇到了以下问题。我想从 sql server db 获取数据并允许 RecordCount 属性。下一个代码获取数据，但 RecordCount 被禁用。如何启用此属性

```
Const DB_CONNECT_STRING = "Provider=SQLOLEDB.1;Data Source=BUG\SQLSERVER2005;Initial Catalog=test;user id ='sa';password='111111'"
Set myConn = CreateObject("ADODB.Connection")
Set myCommand = CreateObject("ADODB.Command" )
myConn.Open DB_CONNECT_STRING
Set myCommand.ActiveConnection = myConn
myCommand.CommandText = ("select * from klienci k where k.indeks = " & oferty(16))
Set klienci = myCommand.Execute 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T21:17:23.637

AFAIK 使用对象的`Execute`方法时`Command`无法更改游标类型，检索记录集后也无法更改游标类型。不过，这样的事情可能会奏效：

```
Const DB_CONNECT_STRING = "Provider=SQLOLEDB.1;Data Source=BUG\SQLSERVER2005;Initial Catalog=test;user id ='sa';password='111111'"

Set myConn = CreateObject("ADODB.Connection")
myConn.Open DB_CONNECT_STRING

query = "select * from klienci k where k.indeks = " & oferty(16)

Set klienci = CreateObject("ADODB.Recordset")
klienci.CursorLocation = 3 'adUseClient
klienci.CursorType     = 3 'adOpenStatic
klienci.LockType       = 1 'adLockReadOnly

klienci.Open query, myConn 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:20:19.250

I don't think this is a VBScript issue- I think it is an ADO issue.

I think you are using a default forward-only cursor which won't work with recordcount.

I think you should stick a cursortype=adOpenStatic in there but I'm having a little trouble determining if you are specifying a recordset object - klienci?

If so try klienci.cursortype=adOpenStatic

# android - 添加新项目时如何在 ListView 中禁用自动滚动？

> ID：16172830
> 
> 赞同：1
> 
> 时间：2013-04-23T15:05:31.100
> 
> 标签：android, android-listview

我有 ListView 的应用程序。当我添加新项目时，此 ListView 滚动。但我不需要那个。如何阻止这种情况？只有用户可以滚动它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:29:41.670

如果您需要停止 ListView，请重写 dispatchTouchEvent() 方法，仅拦截您想要获取的操作。

此处也对此进行了解释： [禁用列表视图中的滚动](https://stackoverflow.com/questions/7611085/disable-scrolling-in-listview)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-10T10:05:43.500

在 CustomListView 中重写此方法并返回 false。

```
@Override 
public boolean requestChildRectangleOnScreen(View child, Rect rect, boolean immediate) {
   return false;
} 
```

# ruby-on-rails - 如何在本地化的设计错误消息中大写模型名称？

> ID：16172831
> 
> 赞同：2
> 
> 时间：2013-04-23T15:05:31.230
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise, ruby-on-rails-3.2

我在我的 Rails 应用程序中使用 Devise，我想知道为什么它在错误消息中将我所有的模型名称都小写：*Github*[上的源代码](https://github.com/plataformatec/devise/blob/master/app/helpers/devise_helper.rb)

有没有办法覆盖这个？

例如，在德语中，名词以大写字母开头，例如“Benutzer”是正确的，但“benutzer”是错误的。

我有这个`devise.de.yml`：

```
de:

  activerecord:
    models:
      user: "Benutzer" 
```

但是，Devise 仍然`Benutzer`以小写字母呈现：

```
Konnte benutzer nicht speichern 
```

这是错误的！

我怎样才能解决这个问题？

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:26:38.057

## 快速解决

添加`app/helpers/devise_helper.rb`具有以下内容的文件：

```
module DeviseHelper
  def devise_error_messages!
    return "" if resource.errors.empty?

    messages = resource.errors.full_messages.map { |msg| content_tag(:li, msg) }.join
    sentence = I18n.t("errors.messages.not_saved",
                      :count => resource.errors.count,
                      :resource => resource.class.model_name.human)

    html = <<-HTML
    <div id="error_explanation">
      <h2>#{sentence}</h2>
      <ul>#{messages}</ul>
    </div>
    HTML

    html.html_safe
  end
end 
```

`:resource`在我编辑之前被迫小写：

```
resource.class.model_name.human.downcase 
```

来源改编自[https://github.com/plataformatec/devise/blob/master/app/helpers/devise_helper.rb](https://github.com/plataformatec/devise/blob/master/app/helpers/devise_helper.rb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:31:38.300

我认为您必须在`devise_error_messages!`帮助程序中覆盖设计的方法并将您的逻辑放在那里（如果您想要德语语言环境以外的小写字母，请删除小写字母或为每个语言环境创建案例）。

# jquery - 如何向 ths 函数添加回调？

> ID：16172832
> 
> 赞同：0
> 
> 时间：2013-04-23T15:05:32.310
> 
> 标签：jquery, jquery-plugins, callback

嗨，我发现了这个模拟打字机效果的[片段：](https://stackoverflow.com/questions/4074399/what-to-choose-for-typewriter-effect-in-javascript)

```
$.fn.teletype = function(opts){
    var $this = this,
        defaults = {
            animDelay: 50
        },
        settings = $.extend(defaults, opts);

    $.each(settings.text.split(''), function(i, letter){
        setTimeout(function(){
            $this.html($this.html() + letter);
        }, settings.animDelay * i);
    });
}; 
```

Wich 似乎工作得很好，但我需要知道函数何时完成，我尝试添加另一个参数并在其末尾运行它：

```
$.fn.teletype = function(opts,callback){
    var $this = this,
        defaults = {
            animDelay: 50
        },
        settings = $.extend(defaults, opts);

    $.each(settings.text.split(''), function(i, letter){
        setTimeout(function(){
            $this.html($this.html() + letter);
        }, settings.animDelay * i
        callback();
    });
}; 
```

但它在进程完成之前执行

我怎么知道在哪里放置这个回调函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:07:05.337

为 中的最后一个元素调用它`each`，这将在动画应用于每个字母后调用回调

```
$.fn.teletype = function(opts,callback){
    var $this = this,
        defaults = {
            animDelay: 50
        },
        settings = $.extend(defaults, opts);

    $.each(settings.text.split(''), function(i, letter){
        setTimeout(function(){
            $this.html($this.html() + letter);
            if(i === (settings.text.length -1)) {
                callback();
            }
        }, settings.animDelay * i
    });

}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:11:21.407

`setTimeout`检查回调内部的条件：

```
$.each(settings.text.split(''), function(i, letter){
    setTimeout(function(i){
        $this.html($this.html() + letter);
        if(i == (settings.text.length -1)){

          callback()

        }
    }, settings.animDelay * i

}); 
```

# extjs - 从 JSON 数据加载单选按钮/组合框数据

> ID：16172834
> 
> 赞同：1
> 
> 时间：2013-04-23T15:05:33.920
> 
> 标签：extjs, extjs4

我正在尝试使用 JSON 数据自动选择表单的单选按钮和组合框值。但是，其他所有内容（文本框/复选框/数据字段）都在填充。我没有成功自动选择单选组或组合框的值。

**正如 Satya 所建议的，这里是 jsfiddle 的链接。单击“电影数据库”上的一行，会填充“电影信息表单”中的数据。**

> [http://jsfiddle.net/9PVCN/5/](http://jsfiddle.net/9PVCN/5/)

非常感谢您的帮助。

这是我的表格的一部分 -

```
 { 
                xtype:'radiogroup',
                columns:1,
                fieldLabel:'Filmed In',
                name: 'filmed_in',
                items:[{
                    name:'filmed_in',
                    boxLabel: 'Color',
                    inputValue: 'color'
                },{
                    name:'filmed_in',
                    boxLabel: 'B&W',
                    inputValue: 'B&W'
                }                   
                ]

            },{             
                    xtype: 'checkbox',
                    fieldLabel: 'Bad Movie',
                    name: 'bad_movie',
                    checked: true
              },{
                    xtype: 'combo',
                    hiddenName: 'genre',
                    fieldLabel: 'Genre',
                    mode: 'local',
                    store: genres,
                    displayField:'url',
                    valueField:'name',
                    width: 250,
                    editable: false,
                    listeners: {select: comboSelect}
              }, 
```

这就是**流派**商店的编码方式 -

```
var genres = new Ext.data.JsonStore({
        // store configs
        storeId: 'genres',
        autoLoad: true,
        proxy: {
            type: 'ajax',
            url: 'genres.data',
            reader: {
                type: 'json',
                idProperty: 'name'
            }
        },
        fields: ['name', 'url']
    }); 
```

urlgenres.data**返回**这个 -

```
[{"name":"1","url":"Comedy"},{"name":"2","url":"Drama"},{"name":"3","url":"Action"}] 
```

这是我试图加载到表单中的数据 -

```
{
  "id":"1",
  "title":"Office Space",
  "director":"Mike Judge",
  "released":"02/27/1999",
  "genre":"1",
  "bad_movie": "1",
  "filmed_in": "color",
  "description": "Loved watching this ....." 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:40:01.913

对于单选按钮，预期值与您的传递不同。

而不是`filmed_in: 'color'`你需要通过`filmed_in: { filmed_in: 'color' }`.

您可以覆盖提到的`setValue`as [sra](https://stackoverflow.com/a/9953313/139300)，以便它可以使用`filmed_in: 'color'`：

```
setValue: function (value) {
    if (!Ext.isObject(value)) {
        var obj = new Object();
        obj[this.name] = value;
        value = obj;
    }
    Ext.form.RadioGroup.prototype.setValue.call(this, value);
} 
```

对于组合框，只需添加 `name: 'genre'`.

[http://jsfiddle.net/9PVCN/9/](http://jsfiddle.net/9PVCN/9/)

# python - 并不总是遵循 Scrapy Request 对象

> ID：16172837
> 
> 赞同：0
> 
> 时间：2013-04-23T15:05:41.550
> 
> 标签：python, object, request, scrapy, web-crawler

我正在用刮刀创建一个爬虫。
我的蜘蛛必须转到包含链接列表和下一页链接的起始页。
然后，它必须跟随每个链接，转到此链接，获取信息并返回主页。
最后，当蜘蛛跟随页面的每个链接时，它会转到下一页并重新开始。

```
 class jiwire(CrawlSpider):
        name = "example"
        allowed_domains = ["example.ndd"]
            start_urls = ["page.example.ndd"]   

            rules = (Rule (SgmlLinkExtractor(allow=("next-page\.htm", ),restrict_xpaths=('//div[@class="paging"]',)), callback="parse_items", follow= True),)

        def parse_items(self, response):
                hxs = HtmlXPathSelector(response)
                links = hxs.select('//td[@class="desc"]')
                for link in links :
                    link = title.select("h3/a/@href").extract()
                    request = Request("http://v4.jiwire.com/" + str(name), callback=self.parse_sub)
                    return(request)

        def parse_sub(self, response):
            hxs = HtmlXPathSelector(response)
            name = hxs.select('//div[@id="content"]/div[@class="header"]/h2/text()').extract()
            print name 
```

我解释我的代码：我定义了一个遵循下一页的规则。
为了跟踪当前页面的每个链接，我创建了一个获取链接的请求对象并返回该对象。
通常，对于每个请求返回，我必须在 parse_sub 函数中看到“打印名称”。
但是只有一个链接被关注（不是全部），我不明白为什么。
它很好地抓取了链接，请求对象被很好地创建，但它每页只输入一次 parse_sub。

你能帮助我吗 ？
多谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T16:48:32.020

我回来了 ！我的问题来自我的退货声明。

解决方案：

```
 for link in links :
        link = title.select("h3/a/@href").extract()
        request = Request(link, callback=self.parse_hotspot)
        yield request 
```

# python - 持续运行 python 脚本

> ID：16172839
> 
> 赞同：0
> 
> 时间：2013-04-23T15:05:52.860
> 
> 标签：python, linux, bash, service

我的机器上有一个脚本，我想在机器启动时开始运行，如果它崩溃或失败，我会再次尝试运行。

这是否意味着将其转变为服务？我意识到我可以使用 crontab 并使用 @reboot，但这并不能解决脚本崩溃的问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:13:57.093

我将使用 init 启动它，并使用 crontab 监视它创建的 PID 文件，并使用单独的脚本进行监视。

或者，如果您可以使用 crontab 脚本（使用 ps）找到 PID ID，如果脚本不存在则重新初始化该脚本。

我的 2 美分..

# java - junit 测试中的 spring-data-jpa bean 验证

> ID：16172843
> 
> 赞同：9
> 
> 时间：2013-04-23T15:06:06.870
> 
> 标签：java, hibernate, bean-validation, spring-data-jpa, spring-test

在我最近的工作中，我使用 spring-data-jpa 来利用提供的存储库。当涉及到集成测试时，我无法配置（我假设）spring 上下文进行测试，结果 bean 验证在我的测试中不起作用。

我知道我可以注入验证器，并对我的注释进行单元测试，但事实并非如此。我正在编写集成测试，并想测试支持数据库的存储库。

我准备了简单的项目来显示所有必要的项目文件。

当我运行测试时，有 2 个失败，我不知道为什么，休眠验证器出现在类路径上。

```
Failed tests:   insertWrongEmail(com.example.core.data.jpa.UserRepositoryTest): Expected ConstraintViolationException wasn't thrown.
insertToShortPassword(com.example.core.data.jpa.UserRepositoryTest): Expected ConstraintViolationException wasn't thrown. 
```

[..]

```
Apr 23, 2013 5:00:08 PM org.hibernate.validator.internal.util.Version <clinit>
INFO: HV000001: Hibernate Validator 4.3.1.Final 
```

下面的源代码和*mvn 测试*输出。

预先感谢您的帮助。

Java 类（我去掉了注释、geters、seters、equals、hashCode、toString 等）：

基础实体

```
package com.example.core.data.jpa;

import javax.persistence.*;

@MappedSuperclass
public abstract class BaseEntity {
    public static final String SEQUENCE = "global_seq";

    @Id
    @SequenceGenerator(name = SEQUENCE, sequenceName = SEQUENCE)
    @GeneratedValue(strategy = GenerationType.SEQUENCE, generator = SEQUENCE)
    @Column(name = "id")
    private Long id;

    public Long getId() {
        return id;
    }
} 
```

用户

```
package com.example.core.data.jpa;

import javax.persistence.*;
import javax.validation.constraints.Pattern;
import java.io.Serializable;
import java.util.List;

@Entity
@Table(name = "users")
@NamedQuery(name = "User.findByEmail", query = "select u from User u where upper(u.email) = :email")
public class User extends BaseEntity implements Serializable {
    private static final long serialVersionUID = 333700989750828624L;

    private static final int MAX_NAME_LENGTH = 128;
    private static final int MAX_EMAIL_LENGTH = 128;
    private static final int MAX_PASSWORD_LENGTH = 256;
    private static final int MIN_NAME_LENGTH = 6;

    private static final int EQUALS_MAGIC = 71;

    @Size(min = MIN_NAME_LENGTH)    
    @Column(name = "name", nullable = false, length = MAX_NAME_LENGTH)
    private String name;

    @Pattern(regexp = "^([0-9a-zA-Z]([-.\\w]*[0-9a-zA-Z])*@([0-9a-zA-Z][-\\w]*[0-9a-zA-Z]\\.)+[a-zA-Z]{2,9})$")
    @Column(name = "email", nullable = false, unique = true, length = MAX_EMAIL_LENGTH)
    private String email;

    @Column(name = "password", nullable = false, length = MAX_PASSWORD_LENGTH)
    private String password;

    @OneToMany(mappedBy="user", cascade={CascadeType.ALL}, fetch = FetchType.EAGER)
    private List<Role> roles;
//geters, seters, equals, hashCode
} 
```

角色

```
package com.example.core.data.jpa;

import javax.persistence.*;
import java.io.Serializable;

@Entity
@Table(name = "roles")
public class Role extends BaseEntity implements Serializable {
    private static final long serialVersionUID = -2575871700366265974L;

    private static final int MAX_NAME_LENGTH = 128;

    @Column(name = "name", nullable = false, unique = true, length = MAX_NAME_LENGTH)
    private String name;

    @ManyToOne(cascade={CascadeType.ALL})
    private User user;
//geters, seters, equals, hashCode
} 
```

用户存储库测试

```
package com.example.core.data.jpa;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.springframework.transaction.annotation.Transactional;
import com.example.core.data.repository.UserRepository;

import javax.inject.Inject;
import javax.validation.ConstraintViolation;
import javax.validation.ConstraintViolationException;
import javax.validation.constraints.Pattern;
import javax.validation.constraints.Size;

import static org.junit.Assert.*;

@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = "classpath:test-context.xml")
@Transactional
public class UserRepositoryTest {
    @Inject
    private UserRepository userRepository;

    private User user;

    private static final String NAME = "User Name";
    private static final String EMAIL = "user_name@example.com";
    private static final String PASSWORD = "PASSWORD";

    @Before
    public void setUp() {
        user = new User(NAME, EMAIL, PASSWORD);
    }

    @Test
    public void insert() {
        //given

        //when
        User inserted = userRepository.save(user);

        //then
        assertEquals(NAME, inserted.getName());
        assertEquals(EMAIL, inserted.getEmail());
        assertEquals(PASSWORD, inserted.getPassword());
        assertNotNull(inserted.getId());
    }

    @Test
    public void insertWrongEmail() {
        //given
        user.setEmail("NOT_AN_EMAIL_ADDRESS");

        //when
        try {
            userRepository.save(user);

            fail("Expected ConstraintViolationException wasn't thrown.");

        } catch (ConstraintViolationException e) {
            //then

            assertEquals(1, e.getConstraintViolations().size());
            ConstraintViolation<?> violation =
                    e.getConstraintViolations().iterator().next();

            assertEquals("email", violation.getPropertyPath().toString());
            assertEquals(Pattern.class,
                    violation.getConstraintDescriptor()
                            .getAnnotation().annotationType());
        }
    }

    @Test
    public void insertToShortName() {
        //given
        user.setName("SHORT");

        //when
        try {
            userRepository.save(user);

            fail("Expected ConstraintViolationException wasn't thrown.");

        } catch (ConstraintViolationException e) {
        //then

            assertEquals(1, e.getConstraintViolations().size());
            ConstraintViolation<?> violation =
                    e.getConstraintViolations().iterator().next();

            assertEquals("name", violation.getPropertyPath().toString());
            assertEquals(Size.class,
                    violation.getConstraintDescriptor()
                            .getAnnotation().annotationType());
        }
    }
} 
```

用户存储库

```
package com.example.core.data.repository;

import org.springframework.data.repository.PagingAndSortingRepository;
import com.example.core.data.jpa.User;

public interface UserRepository extends PagingAndSortingRepository<User, Long> {
} 
```

pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.example</groupId>
    <artifactId>data-jpa</artifactId>
    <version>1.0-SNAPSHOT</version>
    <packaging>jar</packaging>
    <name>Exampl core jpa package</name>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.hibernate.javax.persistence</groupId>
            <artifactId>hibernate-jpa-2.0-api</artifactId>
            <version>1.0.1.Final</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate.java-persistence</groupId>
            <artifactId>jpa-api</artifactId>
            <version>2.0-cr-1</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>4.2.0.Final</version>
        </dependency>
        <dependency>
            <groupId>javax.validation</groupId>
            <artifactId>validation-api</artifactId>
            <version>1.0.0.GA</version>
            <scope>compile</scope>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-validator</artifactId>
            <version>4.3.1.Final</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-jdk14</artifactId>
            <version>1.6.0</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>org.codehaus.jackson</groupId>
            <artifactId>jackson-mapper-asl</artifactId>
            <version>1.9.12</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.inject</groupId>
            <artifactId>javax.inject</artifactId>
            <version>1</version>
        </dependency>
        <dependency>
            <groupId>org.springframework.data</groupId>
            <artifactId>spring-data-jpa</artifactId>
            <version>1.2.0.RELEASE</version>
        </dependency>
        <dependency>
            <groupId>cglib</groupId>
            <artifactId>cglib</artifactId>
            <version>2.2.2</version>
        </dependency>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-test</artifactId>
            <version>3.2.2.RELEASE</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.hsqldb</groupId>
            <artifactId>hsqldb</artifactId>
            <version>2.2.9</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.11</version>
            <scope>test</scope>
        </dependency>
    </dependencies>
</project> 
```

测试上下文.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:jpa="http://www.springframework.org/schema/data/jpa"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="
        http://www.springframework.org/schema/beans
            http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/data/jpa
            http://www.springframework.org/schema/data/jpa/spring-jpa.xsd
        http://www.springframework.org/schema/jdbc
            http://www.springframework.org/schema/jdbc/spring-jdbc-3.0.xsd
        http://www.springframework.org/schema/context
            http://www.springframework.org/schema/context/spring-context.xsd
        http://www.springframework.org/schema/tx
            http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">

    <context:annotation-config/>
    <jpa:repositories base-package="com.example.core.data.repository" />
    <tx:annotation-driven transaction-manager="transactionManager" />

    <jdbc:embedded-database id="dataSource" type="HSQL"/>

    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager"
            p:entityManagerFactory-ref="entityManagerFactory" />

    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"
          p:dataSource-ref="dataSource" p:jpaVendorAdapter-ref="jpaAdapter" >
        <property name="loadTimeWeaver">
            <bean class="org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver" />
        </property>
        <property name="packagesToScan">
            <list>
                <value>com.example.core.data.jpa</value>
            </list>
        </property>
    </bean>

    <bean id="jpaAdapter" class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"
          p:generateDdl="true" p:database="HSQL" />

    <bean id="validator" class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"
            p:messageInterpolator-ref="messageInterpolator" p:validationMessageSource-ref="messageSource" />

    <bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource"
          p:basename="classpath:I18N/messages,classpath:ValidationMessages*.properties" />

    <bean id="messageInterpolator"
          class="org.hibernate.validator.messageinterpolation.ResourceBundleMessageInterpolator" />
</beans> 
```

*mvn 测试*输出

```
[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Example core jpa package 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-resources-plugin:2.5:resources (default-resources) @ data-jpa ---
[debug] execute contextualize
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO] 
[INFO] --- maven-compiler-plugin:2.3.2:compile (default-compile) @ data-jpa ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:2.5:testResources (default-testResources) @ data-jpa ---
[debug] execute contextualize
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO] 
[INFO] --- maven-compiler-plugin:2.3.2:testCompile (default-testCompile) @ data-jpa ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:2.10:test (default-test) @ data-jpa ---
[INFO] Surefire report directory: /home/[..]/data-jpa/target/surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running com.example.core.data.jpa.UserRepositoryTest
Apr 23, 2013 4:39:34 PM org.springframework.beans.factory.xml.XmlBeanDefinitionReader loadBeanDefinitions
INFO: Loading XML bean definitions from class path resource [test-context.xml]
Apr 23, 2013 4:39:35 PM org.springframework.context.support.AbstractApplicationContext prepareRefresh
INFO: Refreshing org.springframework.context.support.GenericApplicationContext@3cd6ad74: startup date [Tue Apr 23 16:39:35 CEST 2013]; root of context hierarchy
Apr 23, 2013 4:39:35 PM org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor <init>
INFO: JSR-330 'javax.inject.Inject' annotation found and supported for autowiring
Apr 23, 2013 4:39:35 PM org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker postProcessAfterInitialization
INFO: Bean 'org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver#423dc560' of type [class org.springframework.instrument.classloading.InstrumentationLoadTimeWeaver] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
Apr 23, 2013 4:39:35 PM org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactory initDatabase
INFO: Creating embedded database 'dataSource'
Apr 23, 2013 4:39:35 PM org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker postProcessAfterInitialization
INFO: Bean 'dataSource' of type [class org.springframework.jdbc.datasource.embedded.EmbeddedDatabaseFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
Apr 23, 2013 4:39:35 PM org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker postProcessAfterInitialization
INFO: Bean 'dataSource' of type [class org.springframework.jdbc.datasource.SimpleDriverDataSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
Apr 23, 2013 4:39:35 PM org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker postProcessAfterInitialization
INFO: Bean 'jpaAdapter' of type [class org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
Apr 23, 2013 4:39:35 PM org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean createNativeEntityManagerFactory
INFO: Building JPA container EntityManagerFactory for persistence unit 'default'
Apr 23, 2013 4:39:35 PM org.hibernate.annotations.common.Version <clinit>
INFO: HCANN000001: Hibernate Commons Annotations {4.0.1.Final}
Apr 23, 2013 4:39:35 PM org.hibernate.Version logVersion
INFO: HHH000412: Hibernate Core {4.2.0.Final}
Apr 23, 2013 4:39:35 PM org.hibernate.cfg.Environment <clinit>
INFO: HHH000206: hibernate.properties not found
Apr 23, 2013 4:39:35 PM org.hibernate.cfg.Environment buildBytecodeProvider
INFO: HHH000021: Bytecode provider name : javassist
Apr 23, 2013 4:39:35 PM org.hibernate.ejb.Ejb3Configuration configure
INFO: HHH000204: Processing PersistenceUnitInfo [
    name: default
    ...]
Apr 23, 2013 4:39:36 PM org.hibernate.service.jdbc.connections.internal.ConnectionProviderInitiator instantiateExplicitConnectionProvider
INFO: HHH000130: Instantiating explicit connection provider: org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider
Apr 23, 2013 4:39:36 PM org.hibernate.dialect.Dialect <init>
INFO: HHH000400: Using dialect: org.hibernate.dialect.HSQLDialect
Apr 23, 2013 4:39:36 PM org.hibernate.engine.transaction.internal.TransactionFactoryInitiator initiateService
INFO: HHH000268: Transaction strategy: org.hibernate.engine.transaction.internal.jdbc.JdbcTransactionFactory
Apr 23, 2013 4:39:36 PM org.hibernate.hql.internal.ast.ASTQueryTranslatorFactory <init>
INFO: HHH000397: Using ASTQueryTranslatorFactory
Apr 23, 2013 4:39:36 PM org.hibernate.validator.internal.util.Version <clinit>
INFO: HV000001: Hibernate Validator 4.3.1.Final
Apr 23, 2013 4:39:37 PM org.hibernate.tool.hbm2ddl.SchemaUpdate execute
INFO: HHH000228: Running hbm2ddl schema update
Apr 23, 2013 4:39:37 PM org.hibernate.tool.hbm2ddl.SchemaUpdate execute
INFO: HHH000102: Fetching database metadata
Apr 23, 2013 4:39:37 PM org.hibernate.tool.hbm2ddl.SchemaUpdate execute
INFO: HHH000396: Updating schema
Apr 23, 2013 4:39:37 PM org.hibernate.tool.hbm2ddl.DatabaseMetadata getTableMetadata
INFO: HHH000262: Table not found: roles
Apr 23, 2013 4:39:37 PM org.hibernate.tool.hbm2ddl.DatabaseMetadata getTableMetadata
INFO: HHH000262: Table not found: users
Apr 23, 2013 4:39:37 PM org.hibernate.tool.hbm2ddl.DatabaseMetadata getTableMetadata
INFO: HHH000262: Table not found: roles
Apr 23, 2013 4:39:37 PM org.hibernate.tool.hbm2ddl.DatabaseMetadata getTableMetadata
INFO: HHH000262: Table not found: users
Apr 23, 2013 4:39:37 PM org.hibernate.tool.hbm2ddl.DatabaseMetadata getTableMetadata
INFO: HHH000262: Table not found: global_seq
Apr 23, 2013 4:39:37 PM org.hibernate.tool.hbm2ddl.SchemaUpdate execute
INFO: HHH000232: Schema update complete
Apr 23, 2013 4:39:37 PM org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker postProcessAfterInitialization
INFO: Bean 'entityManagerFactory' of type [class org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
Apr 23, 2013 4:39:37 PM org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker postProcessAfterInitialization
INFO: Bean 'org.springframework.transaction.annotation.AnnotationTransactionAttributeSource#0' of type [class org.springframework.transaction.annotation.AnnotationTransactionAttributeSource] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
Apr 23, 2013 4:39:37 PM org.springframework.context.support.AbstractApplicationContext$BeanPostProcessorChecker postProcessAfterInitialization
INFO: Bean 'org.springframework.transaction.config.internalTransactionAdvisor' of type [class org.springframework.transaction.interceptor.BeanFactoryTransactionAttributeSourceAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
Apr 23, 2013 4:39:37 PM org.springframework.beans.factory.support.DefaultListableBeanFactory preInstantiateSingletons
INFO: Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@69950b4: defining beans [org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,userRepository,org.springframework.data.repository.core.support.RepositoryInterfaceAwareBeanPostProcessor#0,org.springframework.dao.annotation.PersistenceExceptionTranslationPostProcessor#0,org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor#0,org.springframework.aop.config.internalAutoProxyCreator,org.springframework.transaction.annotation.AnnotationTransactionAttributeSource#0,org.springframework.transaction.interceptor.TransactionInterceptor#0,org.springframework.transaction.config.internalTransactionAdvisor,dataSource,transactionManager,entityManagerFactory,jpaAdapter,validator,messageSource,messageInterpolator,org.springframework.context.annotation.ConfigurationClassPostProcessor$ImportAwareBeanPostProcessor#0]; root of factory hierarchy
Apr 23, 2013 4:39:38 PM org.springframework.test.context.transaction.TransactionalTestExecutionListener startNewTransaction
INFO: Began transaction (1): transaction manager [org.springframework.orm.jpa.JpaTransactionManager@58eac93b]; rollback [true]
Apr 23, 2013 4:39:38 PM org.springframework.test.context.transaction.TransactionalTestExecutionListener endTransaction
INFO: Rolled back transaction after test execution for test context [TestContext@2b98919b testClass = UserRepositoryTest, testInstance = com.example.core.data.jpa.UserRepositoryTest@2d7f6d79, testMethod = insert@UserRepositoryTest, testException = [null], mergedContextConfiguration = [MergedContextConfiguration@8ec3a45 testClass = UserRepositoryTest, locations = '{classpath:test-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]
Apr 23, 2013 4:39:38 PM org.springframework.test.context.transaction.TransactionalTestExecutionListener startNewTransaction
INFO: Began transaction (2): transaction manager [org.springframework.orm.jpa.JpaTransactionManager@58eac93b]; rollback [true]
Apr 23, 2013 4:39:38 PM org.springframework.test.context.transaction.TransactionalTestExecutionListener endTransaction
INFO: Rolled back transaction after test execution for test context [TestContext@2b98919b testClass = UserRepositoryTest, testInstance = com.example.core.data.jpa.UserRepositoryTest@1fcf7061, testMethod = insertWrongEmail@UserRepositoryTest, testException = java.lang.AssertionError: Expected ConstraintViolationException wasn't thrown., mergedContextConfiguration = [MergedContextConfiguration@8ec3a45 testClass = UserRepositoryTest, locations = '{classpath:test-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]
Apr 23, 2013 4:39:38 PM org.springframework.test.context.transaction.TransactionalTestExecutionListener startNewTransaction
INFO: Began transaction (3): transaction manager [org.springframework.orm.jpa.JpaTransactionManager@58eac93b]; rollback [true]
Apr 23, 2013 4:39:38 PM org.springframework.test.context.transaction.TransactionalTestExecutionListener endTransaction
INFO: Rolled back transaction after test execution for test context [TestContext@2b98919b testClass = UserRepositoryTest, testInstance = com.example.core.data.jpa.UserRepositoryTest@168ee2a9, testMethod = insertToShortPassword@UserRepositoryTest, testException = java.lang.AssertionError: Expected ConstraintViolationException wasn't thrown., mergedContextConfiguration = [MergedContextConfiguration@8ec3a45 testClass = UserRepositoryTest, locations = '{classpath:test-context.xml}', classes = '{}', contextInitializerClasses = '[]', activeProfiles = '{}', contextLoader = 'org.springframework.test.context.support.DelegatingSmartContextLoader', parent = [null]]]
Tests run: 3, Failures: 2, Errors: 0, Skipped: 0, Time elapsed: 3.712 sec <<< FAILURE!

Results :

Failed tests:   insertWrongEmail(com.example.core.data.jpa.UserRepositoryTest): Expected ConstraintViolationException wasn't thrown.
  insertToShortPassword(com.example.core.data.jpa.UserRepositoryTest): Expected ConstraintViolationException wasn't thrown.

Tests run: 3, Failures: 2, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 6.216s
[INFO] Finished at: Tue Apr 23 16:39:38 CEST 2013
[INFO] Final Memory: 7M/245M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.10:test (default-test) on project data-jpa: There are test failures.
[ERROR] 
[ERROR] Please refer to /home/[..]/data-jpa/target/surefire-reports for the individual test results.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException

Process finished with exit code 1 
```

**解决了**

在@gunnar 回答之后，我更改了测试以在 repository.save 之后刷新持久性上下文，并且它按预期工作。

对用户存储库的更改

```
//inject entity manager
@PersistenceContext
private EntityManager entityManager;

//add flush after save in test method
@Test
public void insertWrongEmail() {
    //given
    user.setEmail("NOT_AN_EMAIL_ADDRESS");

    //when
    try {
        userRepository.save(user);
        entityManager.flush();

        fail("Expected ConstraintViolationException wasn't thrown."); 
```

**解决方案 2**

在@andyb 的推荐下，我已经切换到 eclipselink 并且测试工作没有刷新。这就是我将采用的解决方案，我认为切换实现比使用解决方法更好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T10:16:41.310

我设法在本地重现了问题中准确描述的问题，尽管在添加了缺少的 get/set 函数和`UserRepository`类之后:-)

经过一番挖掘，我发现了两个现有问题[JPA ConstraintViolation vs Rollback](https://stackoverflow.com/questions/14354849/jpa-constraintviolation-vs-rollback)和[Hibernate 在与 Bean Validation API 结合时不遵循 JPA 规范？](https://stackoverflow.com/questions/14978291/hibernate-not-following-jpa-specifications-when-combined-with-bean-validation-ap)

**两者似乎都得出结论认为 Hibernate 没有正确抛出`ConstraintValidationException`错误。**

第二个问题的结果是缺陷[HHH-8028 - entityManager.persist not throwing ConstraintValidationException](https://hibernate.atlassian.net/browse/HHH-8028)针对 Hibernate 引发。

为了确认这是同一个问题，我切换到简单`@GeneratedValue`并`insertWrongEmail`通过了。`insertToShortPassword`仍然失败，但我把它归结为`@Size(min = 6)`密码字段丢失。添加之后，所有测试都通过了。

恢复到您的配置`@GeneratedValue`，然后我将 Hibernate 换成了 EclipseLink 持久性框架。两项测试都通过了，这似乎证实了前面问题的发现。我所做的更改是：

**pom.xml**更改添加 jpa 工件，如[EclipseLink](http://wiki.eclipse.org/EclipseLink/Maven)站点上所述

```
<dependency>
   <groupId>org.eclipse.persistence</groupId>
   <artifactId>org.eclipse.persistence.jpa</artifactId>
   <version>2.4.0</version>
   <scope>compile</scope>
</dependency> 
```

**test-context.xml**更改

切换到`EclipseLinkJpaVendorAdapter`

```
<bean id="jpaAdapter" class="org.springframework.orm.jpa.vendor.EclipseLinkJpaVendorAdapter"
    p:generateDdl="true" p:database="HSQL" /> 
```

添加`eclipselink.weaving`属性，详见[EclipseLinkJpaVendorAdapter 而不是 HibernateJpaVendorAdapter 问题](https://stackoverflow.com/questions/10769051/eclipselinkjpavendoradapter-instead-of-hibernatejpavendoradapter-issue)

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"
    p:dataSource-ref="dataSource" p:jpaVendorAdapter-ref="jpaAdapter" >
    <!-- existing configuration is identical -->
    <property name="jpaPropertyMap">
      <map>
        <entry key="eclipselink.weaving" value="false"/>
      </map>
    </property>
</bean> 
```

**User.java**更改

我需要添加一个默认的无参数构造函数。你可能已经有一个完整的`User.java`班级。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T09:50:41.857

在执行存储库操作后刷新持久性上下文可能会起到作用。JPA 仅在与数据库同步时调用 Bean Validation，即在提交或刷新期间。

# c++ - 从 VB.NET 调用 C++ 函数时导致的 PInvokeStackImbalance

> ID：16172850
> 
> 赞同：0
> 
> 时间：2013-04-23T15:06:27.140
> 
> 标签：c++, vb.net, dllimport

我试图在[VB.NET](http://en.wikipedia.org/wiki/Visual_Basic_.NET)中调用 C++ 函数，它会引发 PInvokeStackImbalance。这是 C++ 函数签名：

```
int e1v151(char *NoUsager, char *SequentielSDU, char *code_sys, int code_for, char *IndGest2) 
```

在这里，在 VB.NET 中：

```
DllImport("E1fnbase.dll", EntryPoint:="e1v151", CallingConvention:=CallingConvention.Cdecl, CharSet:=CharSet.Ansi)>
Public Function e1v151(ByVal NoUsager As String, ByVal SeqSDU As String, ByVal Codesys As String, ByVal CodeFor As Integer, ByVal IndGest2 As String) As Integer
End Function 
```

我已经尝试了一些事情（使用`StringBuilder`而不是`String`, `<MarshalAs(LPStr)­>`）但没有任何成功。有什么我看不到的吗？

# genetic-programming - TinyGP 的最大输入长度/可变输入长度

> ID：16172858
> 
> 赞同：1
> 
> 时间：2013-04-23T15:06:45.193
> 
> 标签：genetic-programming

我计划使用 tinyGP 作为将一组输入变量（大约 400 左右）训练为之前设置的值的一种方式。输入变量是否有最大大小？我是否需要每次指定相同数量的变量？

我有很多计算能力（一个周末有 500 个核心集群），所以对于这样一个大问题使用什么参数有什么想法吗？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T18:14:45.617

在 TinyGP 中，常量池和变量池共享相同的空间。这两个空格的总和不能超过 FSET_START，它本质上是你的第一个操作符的操作码。默认情况下是 110。所以你的 400 已经超过了这个。这应该只是增加第一条指令的操作码以腾出足够空间的问题。您还需要确保您仍有足够大的“常量池”。

您可以在 TinyGP 中使用以下行检查这一点：

```
if (varnumber + randomnumber >= FSET_START ) 
   System.out.println("too many variables and constants"); 
```

# .htaccess - .htaccess 重定向如果 CakePHP 的 url 中的文件夹名称

> ID：16172859
> 
> 赞同：0
> 
> 时间：2013-04-23T15:06:46.613
> 
> 标签：soundmanager2, soundmanager2, .htaccess, cakephp, mod-rewrite, cakephp-1.2

基于这个问题：[.htaccess redirect if folder name in url](https://stackoverflow.com/questions/15328487/htaccess-redirect-if-folder-name-in-url)我想知道如何在 CakePHP 应用程序的 webroot 的 .htaccess 中应用那里的 .htaccess 规则。*不会产生服务器错误或丢失 CakePHP 重写功能。*

**我的 CakePHP 版本是 1.2.10**，webroot 的 .htaccess 如下：

```
#app/webroot/.htaccess
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]
</IfModule>
AddType audio/mpeg mp3 
```

我需要这个，因为应用程序有一个音频文件夹，其中包含带有 mp3s 文件的子文件夹，应用程序使用[soundmanager2](/questions/tagged/soundmanager2 "显示标记为“soundmanager2”的问题")播放它们。我希望有人尝试直接或从外部网站访问 mp3 文件时重定向到另一个页面，但保持[soundmanager2](/questions/tagged/soundmanager2 "显示标记为“soundmanager2”的问题")能够从我的网站页面播放文件。所以假设如下：

[http://mycake.com/audio/folderX/fileY.mp3我希望对](http://mycake.com/audio/folderX/fileY.mp3)[http://mycake.com/audio/](http://mycake.com/audio/) * 的 任何访问都被重定向到[http://mycake.com/mistakeSound.mp3](http://mycake.com/mistakeSound.mp3)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:30:34.817

在[htaccess](http://httpd.apache.org/docs/current/howto/htaccess.html)文件中，如果规则和条件适用于相同的请求，则规则的顺序很重要。如果请求 URL 由不同的规则处理，您可以按任意顺序排列规则。

[在您的情况下，您在另一个问题中](https://stackoverflow.com/q/15328487/1741542)有真实文件，在这个问题中有不存在的文件和目录

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f 
```

这意味着，您可以在 CakePHP 规则之前或之后插入其他规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T12:52:02.107

我找到了依赖于将 .htaccess 文件放在相关*音频*文件夹中的解决方案。该 .htaccess 的语法应如下所示：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} !^http://(www\.)?mycake\.com [NC] 
RewriteCond %{HTTP_REFERER} !^http://(www\.)?mycake\.com.*$ [NC] 
RewriteRule \.(gif|jpg|mp3)$ - [R=401]
ErrorDocument 401 /e401.html 
```

例如，当有人尝试通过[http://mycake.com/audio/folderX/fileY.mp3](http://mycake.com/audio/folderX/fileY.mp3)访问任何 mp3 文件时。将产生 401 错误。

**但是，我注意到[FDM](http://www.freedownloadmanager.org/)能够访问和下载此文件。重定向仅适用于 Web 浏览器。**

# httpserver - 网站在过去 5 分钟内收到的访问量

> ID：16172861
> 
> 赞同：-2
> 
> 时间：2013-04-23T15:06:47.770
> 
> 标签：httpserver

这是我最近收到的一个面试问题。这可能与一些我没有太多经验的前端Web开发有关。

问题是“您如何计算网站在过去 5 分钟内收到的访问次数”？

/* 好吧，根据评论和反对票，我决定写更多我/我朋友的想法。我目前的解决方案是构建一个存储访问时间戳的队列。给定一次新访问，我会在 5 分钟前删除所有访问，然后添加此新访问。但这似乎效率不高1）删除队列前面的元素效率不高，2）队列的长度与访问次数一样长。*/

面试官要代码，我不知道。

任何建议/意见表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T18:55:55.320

免责声明：由于您有兴趣了解问题和可能的解决方案，因此我不会添加任何代码，只是一些想法，您可以（并且应该）考虑它并在之后编写自己的代码。

一个细节可能会对您存储数据的方式产生影响：您的“分钟”粒度是多少？只是一分钟，是 60 秒还是 60,000 毫秒？例如，假设您当前的时间戳是 03:44:30,820。03:39:31,820 收到的请求是否发生在“最后 5 分钟”内？如果您的“分钟”粒度是一分钟，则不是（仅在 03:44、03:43、03:42、03:41 和 03:40 请求）。如果您的“分钟”粒度为 60 秒，则它确实发生在最后 5 分钟内。

因此，假设您的“分钟”粒度为 1 分钟（为简单起见）。这样，您的“队列”只有 5 个位置长。每个位置都可以包含在那一分钟内发生的请求计数。你的问题 #2 结束了。此外，如果你有一个链表而不是队列，你可以维护一个`head`和一个`tail`指针，也摆脱了你的问题 #1。

一个可能的优化（如果几分钟没有任何请求，可能会使代码复杂一点，但无论如何值得探索）是：由于您的列表具有固定大小（在本例中为 5），您也可以使用循环缓冲区，摆脱你的一对指针，只保留一个`last`指针。

这些只是一些想法，但面试官的意图可能是让你思考问题，提出一些问题，抛出一些想法，然后从中得出一些代码。

# wordpress - wordpress htaccess 不会更改 url，只是转到 404

> ID：16172865
> 
> 赞同：1
> 
> 时间：2013-04-23T15:07:00.073
> 
> 标签：wordpress, .htaccess, mod-rewrite

代码行：

```
RewriteRule ^/test/(.*)/?$ http://test.com/test/index.php?route=$1 [L,QSA] 
```

对我正在使用的 htaccess 文件没有影响：

```
 # BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
RewriteRule ^/test/(.*)/?$ http://test.com/test/index.php?route=$1 [L,QSA]

</IfModule>

# END WordPress 
```

当我访问我的 domain.com/test/123 时，Wordpress 重定向到 404 页面而不是新链接。我曾尝试移动 htaccess 文件中的项目以防它们被覆盖，但不是运气。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:14:52.893

*   问题 1：RewriteRule 与前导斜杠不匹配。

*   问题 2：重写规则的顺序错误。

这是固定版本：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

RewriteRule ^test/(.*)/?$ http://test.com/test/index.php?route=$1 [L,QSA,NC]

RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

# python - Matplotlib ColorbarBase：删除颜色分隔符

> ID：16172869
> 
> 赞同：5
> 
> 时间：2013-04-23T15:07:06.070
> 
> 标签：python, matplotlib, colorbar

我想使用 ColorbarBase 删除绘制的颜色图中的后行分隔符（分隔符？）：

```
cm    = get_cmap('RdBu')
Ncol  = 501
cccol = cm(1.*arange(Ncol)/Ncol)
cax     = fig.add_axes([0.15,0.15,0.05,0.4])
fig.add_axes([0.5,0.15,0.3,0.03])
norm    = mpl.colors.Normalize(vmin=valmin, vmax=valmax)
cb1     = mpl.colorbar.ColorbarBase(cax, cmap=cm, norm=norm, orientation='vertical') 
```

它总是给我太多的黑线。有没有办法消除它们？我已经尝试过类似的东西：

```
del cb1.lines
del cb1.dividers 
```

或者

```
cb1.lines.remove()
cb1.lines = [] 
```

如[http://fossies.org/dox/matplotlib-1.2.0/matplotlib_2colorbar_8py_source.html#l00281](http://fossies.org/dox/matplotlib-1.2.0/matplotlib_2colorbar_8py_source.html#l00281)中的 ColorbarBase 方法所示。

![带有太多黑线的彩条](https://i.stack.imgur.com/yYvks.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T17:06:56.587

这对我有用，没有任何线条。我看到两个明显的可能性：

1）你有一个错误的版本。如果我`matplotlib.__version__`在 python 提示符下执行，我会看到`1.2.0`. 我正在使用 OS X 10.6.8 和 python 2.7.3，以及从 macports 安装的所有内容。你呢？

2）这是您没有向我们展示的代码中的内容。对于这样的问题，您应该始终展示一个最小的工作示例。（这有时可以帮助您在问问题之前找出问题。）例如，我可以 start `ipython --pylab`，以下工作：

```
fig    = figure()
valmin =-1.0
valmax =1.0
cm     = get_cmap('RdBu')
Ncol   = 501
cccol  = cm(1.*arange(Ncol)/Ncol)
cax    = fig.add_axes([0.15,0.15,0.05,0.4])
norm   = mpl.colors.Normalize(vmin=valmin, vmax=valmax)
cb1    = mpl.colorbar.ColorbarBase(cax, cmap=cm, norm=norm, orientation='vertical')
draw()
savefig('/tmp/bla.png') 
```

弹出的 GUI 和保存的 PNG 都显示以下内容：

![彩条](https://i.stack.imgur.com/Amw8m.png)

那对你有用吗？您是否在其余代码中做了一些明显不同的事情？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T14:38:54.990

我发现它确实是 matplotlib 后端！

```
mpl.use('WXAgg') 
```

解决了！

# jquery - 选中单选按钮时如何将图像放在图像上？

> ID：16172870
> 
> 赞同：0
> 
> 时间：2013-04-23T15:07:06.347
> 
> 标签：jquery, html, css

我有 4-5 个单选按钮，每个按钮下方都有一个图像。当按钮被选中时，我想将图像更改为另一个图像。如果要检查选择的内容，然后将图像放在该图像上，我可以按 4 完成，但我想用几行作为所有单选按钮的相同图像。我开始了这个：

**CSS**

```
#selectedRadio {
        display:none;
        width:74px;
        height:69px;
        position:absolute;
        margin-top:20px;
} 
```

**jQuery**

```
<script>
jQuery(function(){
        jQuery("input[name=choose]").change(function(){          
            if ($(this).is(":checked")) {
                jQuery("#selectedRadio").slideDown()
            }                                                       
       });
});
</script> 
```

**HTML**

```
<div id="selectedRadio"><img src="selected.png" /></div>
<input name="choose"  value="black"> <br><img src ="black.jpg" />
<input name="choose"  value="white"> <br><img src ="white.jpg" />
<input name="choose"  value="red"> <br><img src ="red.jpg" />
<input name="choose"  value="blue"> <br><img src ="blue.jpg" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:45:03.140

我创建[了一个小提琴，展示了这样做的一种方式](http://jsfiddle.net/TA38u/1/)。

这是HTML：

```
<div class="container">
    <label>
        <input type="radio" name="choose" value="black"/>
        <img src="black.jpg" alt="black image" data-color="black" />
    </label>
    <label>
        <input type="radio" name="choose" value="white"/>
        <img src="white.jpg" alt="white image" data-color="white" />
    </label>
    <label>
        <input type="radio" name="choose" value="red"/>
        <img src="red.jpg" alt="red image" data-color="red" />
    </label>
    <label>
        <input type="radio" name="choose" value="blue"/>
        <img src="blue.jpg" alt="blue image" data-color="blue" />
    </label>
</div> 
```

这是JS：

```
$(function () {
    $('label').click(function () {
        var that = this,
            images = $(this).closest('div.container').find('img');
        images.each(function () {
            var t = $(this);
            if (t.data('color') === $(that).find('input').val()) {
                t.attr({
                    src: 'selected.png',
                    alt: 'selected image'
                });
            } else {
                t.attr({
                    src: t.data('color') + '.jpg',
                    alt: t.data('color') + ' image'
                });
            }
        });
    });
}); 
```

还有一些基本的样式：

```
label {
    display: inline-block;
    width:150px;
}
input,
img {
    display: block;
} 
```

同样，这只是实现概念的一种可能方式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-23T15:10:43.893

也许使用 hide() / show() 方法？ [http://www.w3schools.com/jquery/jquery_hide_show.asp](http://www.w3schools.com/jquery/jquery_hide_show.asp)

# date - GWT DateTimeFormat 返回错误的日期

> ID：16172872
> 
> 赞同：1
> 
> 时间：2013-04-23T15:07:09.087
> 
> 标签：date, gwt, datetime

我有以下代码

```
 String test = "21/04/2013";
        fmt = DateTimeFormat.getFormat("MM/dd/yyyy");
        Date dateTest = fmt.parse(test);
        Window.alert(fmt.format(dateTest)); 
```

警报框显示日期

```
 09/04/2014 
```

代替

```
 21/04/2013 
```

为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T16:24:25.017

正如其他人已经说过的，这是因为你的模式。他们没有说的是**为什么**它会这样。

解析`21/04/2013`为时`MM/dd/yyyy`，`DateTimeFormat`会将日期分解为：

```
月 日 年
  21 4 2013

```

然后它会调整事情以使日期有效。为此，**Month**部分被截断`12`（因此临时日期为**Dec 4th, 2013**），然后添加剩余部分（*21 - 12 = 9*），导致**Sept. 4th 2014**，根据您的格式显示为`09/04/2014`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T15:13:44.517

你正在颠倒日期和月份。

```
String test = "21/04/2013";
fmt = DateTimeFormat.getFormat("dd/MM/yyyy");
Date dateTest = fmt.parse(test);
Window.alert(fmt.format(dateTest)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T15:11:06.703

您想显示`21/04/2013`，但格式是`MM/dd/yyyy`. 它应该是`dd/MM/yyyy`

所以像这样改变它：

```
String test = "21/04/2013";
fmt = DateTimeFormat.getFormat("dd/MM/yyyy");
Date dateTest = fmt.parse(test);
Window.alert(fmt.format(dateTest)); 
```

# java - 如何在 Java 中为 XML 文档编码 UTF-8

> ID：16172875
> 
> 赞同：0
> 
> 时间：2013-04-23T15:07:14.770
> 
> 标签：java, excel, utf-8

我有一个 Java 程序，可以从 Excel 表中读取一些内容并创建 XML。

长话短说，我需要 XML 中包含的字符串仅包含有效的 XML 字符并正确编码和需要编码的字符。

**问题：在写入文件之前，如何在 java 中对这些字符进行编码？**

谢谢！

注意：这些是字符，例如：“`(&#x201C;)`和”`(&#x201D;)`以及其他类似字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:21:40.770

据我了解您想以 UTF-8 格式编写 XML 的问题，以 UTF-8 编写文件是 Java 中使用的一种标准方式`OutputStreamWriter`：

```
File f = new File("test.xml");
BufferedWriter wr = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(f), "UTF-8"));
wr.write("xml text here"); 
```

UTF-8 是一种可变宽度编码，可以表示每个字符 Unicode 字符集，参见[http://en.wikipedia.org/wiki/UTF-8#Description](http://en.wikipedia.org/wiki/UTF-8#Description)和[http://en.wikipedia.org/wiki/Quotation_mark#智能报价](http://en.wikipedia.org/wiki/Quotation_mark#Smart_quotes)。

此外，在您的情况下，您似乎想将“转换为”，并希望在 UTF-8 转换期间可以处理此问题（我可能错了，但这是我从您的回复中看到的）。您是说在 XSL 中具有“字符但 XML 有“? 如果是这样，那么它是一个不同的问题，那么正在讨论什么。

编辑：澄清一下，如果 XSL 具有“并且写入的 XML 也具有相同的字符，就 UTF-8 编码而言，我认为没有任何问题。

以下 XML 是包含 Unicode 字符的有效 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
<summary>This is a summary, text may contain &#x201C;Unicode&#x201D; characters</summary>
</root> 
```

在任何浏览器中打开，如果支持字符集，则 XML 将正确呈现，否则如果出现非 XML 投诉字符，则会引发以下错误（至少在 Chrome 中，可能取决于浏览器）：

> CharRef：无效的十进制值

有关 XML 中有效字符集的范围，您可以参考：[http ://www.w3.org/TR/REC-xml/#charsets](http://www.w3.org/TR/REC-xml/#charsets)

> 字符 ::= #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF]
> /* 任何 Unicode 字符，不包括代理块、FFFE 和 FFFF。*/

对于不兼容的 XML 字符集，请参阅：[http ://www.w3.org/TR/unicode-xml/#Charlist](http://www.w3.org/TR/unicode-xml/#Charlist)

类似于在 XML 中编写 <,>," 因为这些字符需要编写为 <,>,"，`Unicode`字符需要以下列方式编写：&#xNNNN; 其中 NNNN 是 Unicode 十六进制数。请参阅上面的示例 XML。

因此，在以编程方式编写 XML 时，您需要显式处理此类字符，因为当您遇到此类字符时将其转换为 &#x 形式。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-23T15:22:14.750

每当读取文件或写入文件时，请务必定义编码并使用 UTF-8。请注意，因为所有这些方法也确实存在而没有编码字符串，在这种情况下，使用操作系统默认编码。

例如。利用

`InputStreamReader myReader=InputStreamReader(inputStream,"UTF-8");`

而不是没有carset名称的构造函数。

# google-maps - 在谷歌地图上更新形状

> ID：16172877
> 
> 赞同：0
> 
> 时间：2013-04-23T15:07:17.817
> 
> 标签：google-maps, google-maps-api-3, geometry

我在谷歌地图上有一个圆圈，我有一个增加半径的功能。如何更新地图上的圆圈？

```
 this.markerBoundary.radius = rd; //New radius assigned

    //I need to update the shape here but setMap does not work
    this.markerBoundary.setMap(this.gmap);

    this.bounds = this.markerBoundary.getBounds(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:15:58.197

使用`setRadius`- 方法来设置半径属性：

```
this.markerBoundary.setRadius(rd); 
```

# java - 将侦听器添加到 JButton 数组；

> ID：16172878
> 
> 赞同：2
> 
> 时间：2013-04-23T15:07:21.520
> 
> 标签：java, swing, jbutton, actionlistener, actionevent

我有以下代码在按钮单击时创建一个 JButton 数组。`Ope[]`在课堂上公开声明。我有空指针的问题。那就是它不会在循环中打印第二个，即。不进行内部迭代。请告诉我如何处理数组的侦听器。提前致谢。

```
for( int i=0,y=30; i<counter;i++,y+=15 )
{

        open[i]=new JButton( "Open" );
        open[i].setBounds( 380, y, 70, 15 );
        open[i].addActionListener( this );
        panelDisplay.add (open[i] );

        System.out.println(""+i);
} 
```

actionPerformed 函数中的事件处理如下：

```
for( int j=0; j<open.length; j++ )
{
    System.out.println("1st in a loop"+j);

    if( ae.getSource() != null )
    {
        if( ae.getSource() == open[j] )
        {
            System.out.println("2nd in a loop" +j);
            int id;
            String stringid;
            System.out.println("open of"+j+"is clicked");

            stringid = ""+table.getValueAt(j, 0);
            id = Integer.parseInt(stringid);
            fetchData(id);
            //ae.getSource().equals(null);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:20:42.573

JButton inherits "setName" Method from Component. So if you set a name on the Button at initialization

```
 open[i]=new JButton( "Open" );
        open[i].setBounds( 380, y, 70, 15 );
        open[i].setName("Button"+i);
        open[i].addActionListener( this );
        panelDisplay.add (open[i] );

        System.out.println(""+i); 
```

you can find wich button was pressed in the eventhandling

```
 int buttonNumber = Integer.parseInt(ae.getSource().getName().replace("Button",""))
    //... do eventhandling for Button["buttonNumber"] 
```

# ios - iOS：点击并按住单元格后禁用 UITableView 选择

> ID：16172888
> 
> 赞同：1
> 
> 时间：2013-04-23T15:07:45.053
> 
> 标签：ios, uitableview, selection

我在模态视图控制器中显示了一个`UITableView`with custom 。`UITableViewCell`当单元格被选中时，我将一个新`UIViewController`的推入导航堆栈。所有标准，但我发现了一个奇怪的错误：

假设我在表格视图中显示了 10 个单元格。如果我点击并按住一个单元格并用另一根手指随机点击其他单元格，在我松开手指后，会有多个`UIViewControllers`相互推压。我想这是有道理的，因为我`didSelectRowAtIndexPath`多次打电话。但是，我不知道如何解决它？

我收到错误：“ `nested push animation can result in corrupted navigation bar`”和：“ `Finishing up a navigation transition in an unexpected state. Navigation Bar subview tree might get corrupted.`”

我设置`exclusivieTouch`为`YES`在单元格上以及`delaysContentTouches`在`NO`tableView 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:17:18.950

Try to disable multiple selection of the table view(by setting `tableView.allowsMultipleSelection = NO;`, this is by default. So maybe you just need to remove your setting it to YES code). It doesn't make sense to allow user's multiple selection if it's to present a view controller. Because only one can be presented.

# bottle - 在 Mako 中使用与继承的块名称相同的变量名称？

> ID：16172900
> 
> 赞同：0
> 
> 时间：2013-04-23T15:08:14.777
> 
> 标签：bottle, mako

我偶然发现了 Mako 的继承问题。我将尝试使用两个模板文件来说明下面的问题......

**base.tpl** - 有一个命名的块*标题*：

```
<title><%block name="title"></%block></title> 
```

**foo.tpl** - 从 base.tpl 继承并设置标题：

```
<%inherit file="base.tpl" />
<%block name="title">${title}</%block> 
```

模板通过以下方式渲染（使用 Bottle）：

```
...
return mako_template('foo', title="My title") 
```

现在我希望输出是

```
<title>My title</title> 
```

但它变成了：

```
<title><function render_title.<locals>.title at 0x0346A1E0></title> 
```

**有什么线索吗？**使用与块不同的变量名可以工作..但如果可能的话，我想使用相同的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T06:57:18.697

使用这个代替工作：

```
<%block name="title">${context["title"]}</%block> 
```

有谁知道为什么？

# xml - 观看发送给 jasper 的 xml 报告

> ID：16172902
> 
> 赞同：0
> 
> 时间：2013-04-23T15:08:27.137
> 
> 标签：xml, jasper-reports, report, ireport

我正在使用*JasperReports*和*iReport*来构建一些报告。

我正在尝试查看发送了哪些参数，以便我可以使用它们来使报告更加动态。

例如，如果将报告生成到 Excel（并且我确定*xml*中有一个参数），我将创建一个不显示页码的打印表达式，如果生成到*pdf*，它将打印页码。

有什么帮助吗？提前致谢

PS：我尝试调试以查看生成的*xml*，但它是在我看不到的 Web 服务上生成的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T20:58:44.660

我会说生成的 XML 文件中没有任何关于您要导出到的格式的内容。不同之处在于，当您导出为一种或另一种格式时，您使用不同的类/方法。

无论如何，如果您想根据输出格式显示内容，为什么不创建自己的参数来告诉报告您将使用哪种输出格式？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T09:06:31.063

我不认为您可以在完成报告填充并制作 jasperprint 对象后更改报告选项。在填写报告之前设置参数。

> 例如，如果将报告生成到 Excel（并且我确信 xml 中有一个参数），我将创建一个不显示页码的打印表达式，如果生成为 pdf，它将打印页码。

如果您在页码文本字段上添加另一个文本/静态字段。也就是说，如果它们重叠。那么当您导出到 xls 或任何基于网格的导出时，页码将不会出现。但它会出现在 pdf 或任何非基于网格的导出中。

# c - GCC Win32 API 与 ComCtl32 的链接问题

> ID：16172910
> 
> 赞同：5
> 
> 时间：2013-04-23T15:08:42.957
> 
> 标签：c, winapi, gcc, comctl32

我无法使用 GCC (MinGW) 让 Comctl32.lib 与我的程序链接。

海合会输入：

```
gcc -o program.exe main.c images.o -lgdi32 -lcomctl32 -mwindows 
```

GCC 输出

```
main.c: In function 'WinMain':
main.c:120:2: error: unknown type name 'INITCOMMONCONTROLSEX'
main.c:124:9: error: request for member 'dwICC' in something not a structure or union 
```

main.c 中的相关代码

```
#define _WIN32_WINNT _WIN32_WINNT_WIN7
#include <windows.h>
#include <commctrl.h>
int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmd)
{
   Line 120: INITCOMMONCONTROLSEX icex;
   Line 124: icex.dwICC = ICC_LISTVIEW_CLASSES;
   InitCommonControlsEx(&icex);
} 
```

感谢您提供的任何帮助或信息。我已经在这太久了，只是无法想出一个答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:29:12.573

感谢 David H，我已经解决了这个问题。我必须定义

```
#define _WIN32_IE 0x0900 
```

我的印象是 commctrl.h 默认定义了 0x0500（我的函数需要 0x0300），但似乎不是。

> 如果您的项目中没有定义 _WIN32_IE 宏，它会自动定义为 0x0500。- [MSDN 来源](http://msdn.microsoft.com/en-us/library/windows/desktop/hh298349(v=vs.85).aspx)

# javascript - 谁能解释为什么这个 JavaScript 不能运行

> ID：16172913
> 
> 赞同：1
> 
> 时间：2013-04-23T15:09:01.810
> 
> 标签：javascript, jquery, jquery-ui, web-applications

我对 JS 不太了解，我只是不明白为什么这行不通！该代码使用 jquery 将脉动效果应用于我的一个 div 并永远运行，除非我用另一个函数停止它，但我无法弄清楚为什么我的第一段代码不会运行！

```
function animate(var x){
    // Do pulsate animation
    $(x).effect("pulsate", { times:4 }, 5000);
    // set timeout and recall after 10secs
    setTimeout(animate, 10000);
}
  $(document).ready(animate("#mydiv")); 
```

让它工作的唯一方法就是让我这样做

```
function animate(){
    // Do pulsate animation
    $("#mydiv").effect("pulsate", { times:4 }, 5000);
    // set timeout and recall after 10secs
    setTimeout(animate, 10000);
}
  $(document).ready(animate); 
```

*请注意，在第一个片段中，代码使用变量更有用，而第二个片段的选择器名称是硬编码的*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-23T15:10:34.237

不要`var`在你的函数声明中使用。只需使用：

```
function animate(x){ 
```

此外，对于第一个示例，您可能想要这样的东西：

```
function animate(x){
    return function () {
        function animateInner() {
            $(x).effect("pulsate", { times:4 }, 5000);
            setTimeout(animateInner, 10000);
        }
        animateInner();
    };
}
$(document).ready(animate("#mydiv")); 
```

**演示：http:** [//jsfiddle.net/XHKbC/](http://jsfiddle.net/XHKbC/)

否则，原始`animate("#mydiv")`调用会立即执行（并且`$(x)`可能找不到任何东西，因为 DOM 还没有准备好）。`$(document).ready()`期望对函数的引用。你调用了一个函数。但这有点矫枉过正。只需使用：

```
$(document).ready(function () {
    animate("#mydiv");
}); 
```

但您必须更改您的函数，以便同时`setTimeout`传递以下值`x`：

```
function animate(x){
    // Do pulsate animation
    $(x).effect("pulsate", { times:4 }, 5000);
    // set timeout and recall after 10secs
    setTimeout(function () {
        animate(x);
    }, 10000);
} 
```

**演示：http:** [//jsfiddle.net/XHKbC/2/](http://jsfiddle.net/XHKbC/2/)

虽然它的代码/复杂一点，但我的第一个示例通过使用闭包`x`在第二个示例中没有遇到问题（必须传入）。`setTimeout`

**更新：**

在向您展示如何使用此代码时，我将其设置如下：

```
function Animater(target) {
    var self = this;
    var animateTO;
    var animateElement = target;

    function animate() {
        animateElement.effect("pulsate", { times:4 }, 5000);
        animateTO = setTimeout(animate, 10000);
    }

    self.start = function () {
        animate();
    };

    self.stop = function () {
        animateElement.finish();
        clearTimeout(animateTO);
    };
} 
```

并创建一个新的，例如：

```
var mydivAnimater = new Animater($("#mydiv")); 
```

然后，您可以调用它，`.start()`并根据需要在不同的元素上`.stop()`创建任意数量的这些`Animater`对象。

**演示：http:** [//jsfiddle.net/K7bQC/3/](http://jsfiddle.net/K7bQC/3/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T15:13:28.577

您的代码有两个问题：

省略变量：

```
function animate(x){ 
```

修改您的事件处理程序：

```
$(document).ready(function(){
   animate("#mydiv");
}); 
```

您需要交出一个函数引用（`animate`或者`function(){}`），而不是立即运行您正在执行的代码，如果您通过`animate()`.

现在为了不丢失对您的引用，您`x`还必须在超时中修改动画调用：

```
setTimeout(function () {
        animate(x);
    }, 10000); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:10:30.973

指定函数参数时不需要键入**var 。**

# android - 使用 sqlite 进行 Android 开发：查询结果不能为空

> ID：16172915
> 
> 赞同：0
> 
> 时间：2013-04-23T15:09:13.990
> 
> 标签：android, sqlite, android-cursor

我有一个相当大的查询，它在 android 外部执行时返回数据，而在 android 内部执行时不返回任何内容。

*   我将查询分成几部分，并确定联合没问题。
*   我尝试了一组具有相同行为的较小数据。
*   我已经使用不同的硬件和 API 版本进行了测试。
*   我正在使用具有常量值的 rawQuery 方法。 [http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#rawQuery(java.lang.String, java.lang.String[])](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#rawQuery%28java.lang.String,%20java.lang.String%5B%5D%29)

此查询旨在替换当前不支持的 FULL OUTER JOIN。

```
SELECT IFNULL(stype, gtype) AS type, IFNULL(sdate, gdate) AS date, IFNULL(sroute, groute) AS route FROM (

SELECT sp.type AS stype, sp.date AS sdate, -1 AS gtype, gp.date AS gdate, sp.route AS sroute, gp.route AS groute
FROM Sensor_Point AS sp LEFT JOIN GPS_Point AS gp ON gp._id IS NULL AND sp.sent=0 AND sp.route=gp.route AND sp.route=1
UNION ALL
SELECT sp.type AS stype, sp.date AS sdate, -1 AS gtype, gp.date AS gdate, sp.route AS sroute, gp.route AS groute
FROM GPS_Point AS gp LEFT JOIN Sensor_Point AS sp ON sp._id IS NULL AND gp.sent=0 AND sp.route=gp.route AND gp.route=1

) WHERE route=1 ORDER BY date ASC LIMIT 255 
```

任何提示将不胜感激。

**更新：**

看起来问题最终出在查询参数上，如果我这样设置：

```
String[] args = new String[3];
args[0] = args[1] = args[2] = "1"; 
Cursor data dataBase.rawQuery(SELECT_POINTS, args); 
```

它不起作用，而当直接在查询中硬编码值时它起作用。

```
Cursor data = dataBase.rawQuery(SELECT_POINTS, null); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T17:09:06.713

在 Android 数据库 API 中，所有查询参数都是字符串。（这是一个可怕的设计错误。）

您的查询对应于：

```
... AND sp.route='1' 
```

尝试将参数字符串转换回这样的数字：

```
... AND sp.route = CAST(? AS INT) 
```

或者只是将数字直接放入查询字符串中。

# grails - 测试用户是否登录

> ID：16172920
> 
> 赞同：0
> 
> 时间：2013-04-23T15:09:20.497
> 
> 标签：grails, spring-security

如何使用 grails 中的 spring security core 插件测试用户是否登录？

我想知道我数据库中的每个用户是否在线，我不知道如何使用 spring 安全插件来做到这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T16:28:42.183

我采取的步骤是：

定义bean：

```
import org.springframework.security.web.authentication.session.ConcurrentSessionControlStrategy 
import org.springframework.security.web.session.ConcurrentSessionFilter 
import org.springframework.security.core.session.SessionRegistryImpl 
import org.springframework.security.web.authentication.session.SessionAuthenticationStrategy

beans = { 

        sessionRegistry(SessionRegistryImpl) 

        sessionAuthenticationStrategy(ConcurrentSessionControlStrategy, sessionRegistry) { 
                maximumSessions = -1 
        } 

        concurrentSessionFilter(ConcurrentSessionFilter){ 
                sessionRegistry = sessionRegistry 
                expiredUrl = '/login/concurrentSession' 
        } 
} 
```

从 grails 安装模板 (grails install-templates)

向 web.xml 添加监听器：

```
<listener>
    <listener-class>org.springframework.security.web.session.HttpSessionEventPublisher</listener-class>
</listener> 
```

在我的服务中注入 sessionRegistry：

```
def sessionRegistry 
```

...

```
def getSessionInformations(User user){
        def userDetails =   userDetailsService.loadUserByUsername(user.username)
        def sessionInfo = sessionRegistry.getAllSessions(userDetails, true)
        return sessionInfo
    } 
```

.

```
def isOnline(User user) {
if (getSessionInformations(user)){return true } else { return false }
} 
```

# node.js - 使用 node.js 解压缩并流式传输加密的 zip 文件

> ID：16172923
> 
> 赞同：4
> 
> 时间：2013-04-23T15:09:30.867
> 
> 标签：node.js, zip, unzip

我在 AWS S3 上有一个加密的 zip 文件，里面有一个 xml 文件。我将它流式传输到我的 node.js heroku 应用程序，我需要解压缩（使用密码）并通过我的 SAX 解析器流式传输 xml 文件。我已经用我的 SAX 解析器搞定了一切。问题是使用密码从 ZIP 文件中获取 XML 文件。

似乎有很多不错的节点库可以让您解压缩文件。但是，它们都不支持解压缩 AES 加密或加密周期的 zip 文件。至少，不是我发现的，我花了几个小时研究这个。

为了速度，我更喜欢流式传输 zipfile 和内容。现在看起来我能找到的唯一选择是通过 node.js 的命令行执行解压缩文件。我不喜欢这样做，主要是因为我找不到通过命令行流式传输文件的方法。

# android - 如何在 Android 列表中显示来自 Web 服务的 JSON

> ID：16172925
> 
> 赞同：0
> 
> 时间：2013-04-23T15:09:33.443
> 
> 标签：android, json

从昨天开始，我一直在尝试让我的应用程序获取一些由 PHP 文件生成的 JSON 数据，然后在列表视图中显示这些数据。

**PHP 文件**使用 encode 方法对数据进行编码：

```
echo json_encode($results); 
```

从**浏览器视图源查看**file.php 生成的 JSON 如下所示：

```
["","CSD1939","CSD1939"] 
```

[JSONLint](http://jsonlint.com/) （一个很棒的工具）将其验证为正确的 JSON 格式。

当我尝试使用我的应用程序从 web 服务获取此 JSON 时，我首先将其作为字符串获取，但我无法将其传递给适配器并使其正确显示。

直到现在我才设法创建一个显示字符串数组的列表视图。

获取此 JSON 数据并将其显示在列表中的最佳方法是什么。

```
 package com.example.ams;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.StatusLine;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Context;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class ViewClasses extends Activity {

    @SuppressLint("NewApi")
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.view_classes);

        new GetInfo().execute();

        // ==============Functionality Start====================
        // final ListView listview = (ListView) findViewById(R.id.listview);
    }

    private class GetInfo extends AsyncTask<Void, Void, String> {

        protected String doInBackground(Void... params) {
            // Fetch the JSON from the web and we pass it as a string to
            // the ON POST EXECUTE method
            StringBuilder builder = new StringBuilder();
            HttpClient client = new DefaultHttpClient();
            HttpGet httpGet = new HttpGet(
                    "file.php?get=XXX");
            try {
                HttpResponse response = client.execute(httpGet);
                StatusLine statusLine = response.getStatusLine();
                int statusCode = statusLine.getStatusCode();
                if (statusCode == 200) {
                    HttpEntity entity = response.getEntity();
                    InputStream content = entity.getContent();
                    BufferedReader reader = new BufferedReader(
                            new InputStreamReader(content));
                    String line;
                    while ((line = reader.readLine()) != null) {
                        builder.append(line);
                    }
                } else {
                    Log.e(this.toString(), "Failed to download file");
                }
            } catch (ClientProtocolException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
            return builder.toString();
        }

        protected void onPostExecute(String result) {
            // Here it should turn it into a JSON and then display it in a list.
            // Gets the list view
            final ListView listview = (ListView) findViewById(R.id.listview);

            // Converts the String to a JSON array
            System.out.println(result);
            JSONArray jsonArray;
            try {
                System.out.println(result);
                jsonArray = new JSONArray(result);

                Log.i(ViewClasses.class.getName(), "Number of entries "
                        + jsonArray.length());
                for (int i = 0; i < jsonArray.length(); i++) {
                    JSONObject jsonObject = jsonArray.getJSONObject(i);
                    Log.i(ViewClasses.class.getName(),
                            jsonObject.getString("text"));

                    // Converts JSON array to Java Array
                    final ArrayList<String> list = new ArrayList<String>();
                    // values instead of jsonArray
                    if (jsonArray != null) {
                        int len = jsonArray.length();
                        for (int i1 = 0; i1 < len; i1++) {
                            list.add(jsonArray.get(i).toString());
                        }
                    }
                    final StableArrayAdapter adapter = new StableArrayAdapter(
                            getApplicationContext(),
                            android.R.layout.simple_list_item_1, list);
                    listview.setAdapter(adapter);
                }
            } catch (JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }

    private class StableArrayAdapter extends ArrayAdapter<String> {

        HashMap<String, Integer> mIdMap = new HashMap<String, Integer>();

        public StableArrayAdapter(Context context, int textViewResourceId,
                List<String> objects) {
            super(context, textViewResourceId, objects);
            for (int i = 0; i < objects.size(); ++i) {
                mIdMap.put(objects.get(i), i);
            }
        }

        @Override
        public long getItemId(int position) {
            String item = getItem(position);
            return mIdMap.get(item);
        }

        @Override
        public boolean hasStableIds() {
            return true;
        }

    }
} 
```

我的**布局 XML 文件**如下所示

```
<ListView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/listview"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" /> 
```

运行此代码，我得到一个空白屏幕。

任何帮助，指针，提示将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:14:20.593

它只是返回`JSONArray`，`Strings`所以你不应该`JSONObject`从中创建。

```
 JSONObject jsonObject = jsonArray.getJSONObject(i); 
```

这将导致`Exception`as`JSONArray`不包含`JSONObjects`.

所以像这样解析

```
ArrayList<String> list = new ArrayList<String>();
for (int i = 0; i < jsonArray.length(); i++) {
  list.add(jsonArray.get(i).toString());
} 
```

# cygwin - Win7/cygwin下的codesourcery工具链找不到一些文件

> ID：16172931
> 
> 赞同：0
> 
> 时间：2013-04-23T15:10:01.650
> 
> 标签：cygwin, codesourcery

我已经对此进行了搜索，但我发现的问题是关于让工具链工作的问题，我的问题是它适用于除少数几个目录之外的所有目录。我也不是在构建 Linux。

我正在尝试将项目从 Linux 机器转移到 Windows 以使人们开心。相同的项目在 Linux (Ubuntu 12.04) 下使用相同工具链的 Linux 二进制文件构建良好（我最近从 Mentor 的同一目录重新加载了两个工具链，以确保，请参阅下面的详细信息）。

我安装了 Cygwin，获取了包，设置了路径等。一般来说，该构建适用于 90% 的项目，但由于 make 遍历目录，它会找到除两个文件之外的所有文件（澄清一下，这两个是他们的第一个文件相应的目录，所以我认为问题将适用于整个目录）。下面的日志显示了第一次失败：

*   如果我将 lwip 从构建中取出，那么它会在下一个构建中爆炸
*   如果我从构建中取出下一个，那么其他所有内容（相当多）都会编译；然后链接器按预期在两个丢失的项目上失败。

更准确地说，例如

它找到 /home/Nadi/project/version-2.9/external/freertos/Source/portable/GCC/ARM_CM3_MPU/port.c

但不是 /home/Nadi/project/version-2.9/external/lwip/src/api/api_lib.c

从我正在运行 make 的目录中，“ls”找到编译器无法找到的文件。

## 日志：

```
$ make
external/freertos 
external/lwip  
 [cc] Debug/api_lib.o 
arm-none-eabi-gcc.exe: error: /home/Nadi/project/version-2.9/external/lwip/src/api/api_lib.c: No such file or directory 
arm-none-eabi-gcc.exe: fatal error: no input files compilation terminated. 
Makefile:189: recipe for target `Debug/api_lib.o' failed 
make[2]: *** [Debug/api_lib.o] Error 1 
Makefile:37: recipe for target `lwip_world' failed 
make[1]: *** [lwip_world] Error 2 
Makefile:160: recipe for target `extern' failed 
make: *** [extern] Error 2 
```

## 细节：

*   GCC 链：arm-none-eabi-gcc；gcc 版本 4.7.2 (Sourcery CodeBench Lite 2012.09-63)
*   赛格温：CYGWIN_NT-6.1-WOW64

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-26T16:37:05.513

尽管在这种特殊情况下可能无济于事，但我遇到了类似的问题，CodeSourcery 的 gcc 根本无法识别 Cygwin 的路径`/cygdrive/d/foo.c`——安装 cygpath 包和设置环境变量`export CYGPATH=c:/cygwin32/bin/cygpath`（或`set CYGPATH=c:/cygwin32/bin/cygpath`在 Windows 控制台中）解决了所有问题。

确保以与上述完全相同的方式定义 cygpath 可执行文件的路径，无论使用的是 Cygwin 还是 Windows 控制台。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T22:13:45.380

我之前评论的详细信息是，将 windows/cygwin 组合与基于*Sourcery*的交叉编译器一起使用会遇到很多麻烦。[您可以在SamyGo](http://wiki.samygo.tv/index.php5/Cross-compiling_%28ES_series%29#REQUIREMENTS.21.21)阅读更多相关信息。使用 Windows 的一些问题，在那里以所有血淋淋的细节呈现，是：

> *   使用 ACL 设置文件权限和所有权（不兼容 Linux。）
> *   有自己的创建符号链接的方式（不兼容 Linux。）
> *   对其固定的 NTFS 驱动器使用不区分大小写的默认值。（经常默默地破坏最初在 Linux 下压缩的档案。）
> *   对文件路径使用 Win32（非 POSIX）标准（不兼容 Linux。）
> *   使用 2 个字符回车符和换行符（“\r”和“\n”）表示行尾 (EOL) 表示，与仅使用 NL 的 POSIX 相反。

因此，为了不浪费时间进行第 3 方调试，您最好从头开始构建自己的交叉编译器，如另一篇文章中的 XDA 链接所示。自从Android的问世以来，这已不再困难。

# asp.net-mvc - 实体框架生成列表 来自模型的唯一值

> ID：16172932
> 
> 赞同：1
> 
> 时间：2013-04-23T15:10:06.453
> 
> 标签：asp.net-mvc, entity-framework

我有一个模型叫`Roles`：

```
public string CodeRole { get; set; }
public string Organisation { get; set; }
public string LabelRole { get; set; } 
```

`CodeRole`并`LabelRole`包含唯一值，但该`Organisation`列包含大约 12 个类别。我想生成一个允许用户过滤的下拉列表`Organisation`。

因此，我想使用实体框架构造一个查询，该查询返回某种形式的列表/数组/集合，我可以轻松地将`List<SelectListItem>`两者转换为一个，`text`并且`value`等于不同的`Organisation`值。

我假设查询看起来像这样：

```
_context.Roles.GroupBy(r=> r.Organisation) 
```

这会返回一个`IGrouping<string,Roles>`对象，但我不知道如何使用`IGrouping`.

这将允许我将`List<SelectListItem>`via a传递`ViewBag`给视图中的下拉列表。

**编辑：**基于 Alexander Manekovskiy 响应的最终解决方案

```
List<Roles> orgs = (List<DimRoles>)_context.Roles.GroupBy(f => f.Organisation).Select(r => r.FirstOrDefault()).ToList();
List<SelectListItem> items = new List<SelectListItem>();

foreach (DimRoles r in orgs) 
    items.Add(new SelectListItem { Text = r.Organisation, Value = r.Organisation }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:24:26.103

是的，关于 GroupBy，您是对的，但是您只需要从组中选择第一个值：

```
_context.Roles.GroupBy(r=> r.Organisation).Select(r = r.First()) 
```

另一种可能的解决方案是使用[Distinct](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.distinct.aspx)扩展方法：

```
_context.Roles.Select(r=> r.Organisation).Distinct() 
```

然后让`List<SelectListItem>`你可以使用选择：

```
_context.Roles.GroupBy(r=> r.Organisation).Select(r => 
{ 
    var organization = r.First();
    return new SelectListItem() { Name = organization , Value = organization }
}).ToList(); 
```

但就个人而言，我更希望有另一种扩展方法来转换`IEnumerable<T>`为`List<SelectListItem>`. 这可能是这样的：

```
public static IEnumerable<SelectListItem> GetList<TEntity>(this IEnumerable<TEntity> collection, Expression<Func<TEntity, object>> keyExpression,
    Expression<Func<TEntity, object>> valueExpression, object selectedValue = null)
{
    var keyField = keyExpression.PropertyName();
    var valueField = valueExpression.PropertyName();

    return new SelectList(collection, keyField, valueField, selectedValue).ToList();
} 
```

然后你可以像这样使用它：

```
_context.Roles.Distinct(new OrganizationEqualityComparer()).GetList(o => o.Organization, o => o.Organization); 
```

但在这种情况下，您将需要实现`IEqualityComparer<Role>`非常简单：

```
class RoleOrganizationComparer : IEqualityComparer<Role>
{
    public bool Equals(Role x, Role y)
    {
        if (Object.ReferenceEquals(x, y)) return true;
        if (Object.ReferenceEquals(x, null) || Object.ReferenceEquals(y, null))
            return false;

        return x.Organization == y.Organization;
    }

    public int GetHashCode(Role role)
    {
        //Check whether the object is null 
        if (Object.ReferenceEquals(role, null)) return 0;

        //Get hash code for the Name field if it is not null. 
        return role.Organization == null ? 0 : role.Organization.GetHashCode();
    }
} 
```

# jquery - jQuery - 不使用图像滑动背景颜色

> ID：16172934
> 
> 赞同：2
> 
> 时间：2013-04-23T15:10:16.283
> 
> 标签：jquery, css, hover, slide

所以，是的，正如标题所说 - 有没有办法使用滑动动画更改导航菜单项的背景颜色（悬停时）？并且**不使用图像**？

使用 jQuery 或 CSS3 制作渐变动画很容易，但是有没有办法让悬停颜色**从左向右**滑动？

*我知道这方面有很多线程，但它们都包括使用图像。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-23T15:41:00.310

你可以这样做：

**HTML：**

```
<a href="#"><span>aosgibmoa bnocibnas</span></a> 
```

**CSS：**

```
a{
    display:inline-block;
    background:green;
    position:relative;
    padding:2px 5px;
}
a>span{
    position:relative;
}

a::before{
    content:'';
    background:red;
    position:absolute;
    left:0;
    top:0;
    height:100%;
    width:0%;
    -webkit-transition:width .3s ease-out;
}
a:hover::before{
    width:100%;
} 
```

**演示：http:**
[//jsfiddle.net/nsfxE/](http://jsfiddle.net/nsfxE/)

* * *

使用渐变的替代方法：（感谢 Bojangles）

**CSS：**

```
a{
    display:inline-block;
    background:green;
    position:relative;
    padding:2px 5px;
    background: -webkit-gradient(linear, left top, right top, color-stop(50%,red), color-stop(50.001%,green));
    background-size:200% 100%;
    background-position:0 0;
    -webkit-transition:background-position .3s ease-out;
}

a:hover{
    background-position:-100% 0;
} 
```

**演示：http:**
[//jsfiddle.net/nsfxE/1/](http://jsfiddle.net/nsfxE/1/)

# php - 使用 PHP 在自定义 Drupal 模块中设置 AZ Bar

> ID：16172935
> 
> 赞同：1
> 
> 时间：2013-04-23T15:10:16.847
> 
> 标签：php, drupal, drupal-views, drupal-exposed-filter

我正在尝试使用打印 AZ 栏来根据字母点击过滤条目。（即点击“A”只显示“A”列表，点击“B”只显示“B”列表，如果没有“C”列表比“C”不显示“ABDE”）

这是在 PHP 中，是自定义 DRUPAL 模块的一部分。内容已经按字母顺序排列。

我知道下面有很多代码，我只是不知道在哪里或应用什么来解决这个问题。

预先感谢您的所有帮助。

艾伦

我试图将 RED OUTLINED 框放入 RED FILLED-IN 框中。

![在此处输入图像描述](https://i.stack.imgur.com/ZkB9x.png)

抱歉花了这么长时间才上图。谢谢你的帮助！

```
<?php

// NITAAC Calendar Synchronization Module
// Based off of Assyst's origonal solution
// Re-written to only pull updates where needed

// TODO: write a proper help section
function cloud_computing_data_help($path, $arg){
  switch ($path){
  case "admin/help#cloud_computing_data":
    $text = '<p>' . t("TODO - WRITE A HELP FILE.") . '</p>';
    return $text;
    break;
  }
}

/** 
 * Menu functions
 */
function cloud_computing_data_menu()
{
    $items = array();

  $items['cloud-computing/cio-sp3'] = array(
    'title' => 'Cloud Computing',
    'description' => '',
    'page callback' => 'cloud_computing_data_grid_display',
    'access callback' => TRUE,
  );

  $items['cloud-computing/update-from-node/%'] = array(
    'title' => 'Cloud Computing data update',
    'description' => 'Utility to update the CIO-SP3/SB Cloud Computing data in the database based on a sheetnode',
    'page callback' => 'cloud_computing_data_populate_from_node',
    'page arguments' => array(2),
    'access arguments' => array('access administration pages'),
  );

    return $items;
}

/**
 * Block Definitions
 */
function cloud_computing_data_block_info(){
  $blocks['cloud_computing_filters'] = array(
    'info' => t('NITAAC Cloud Computing Filters'),
    'status' => 1,
    'region' => 'subfeature_top',
    'visibility' => BLOCK_VISIBILITY_LISTED,
    'weight' => '999',
    'pages' => 'cloud-computing/cio-sp3',
    'cahce' => DRUPAL_CACHE_PER_ROLE,
  );
  return $blocks;
}

function cloud_computing_data_theme(){
  $module_path = drupal_get_path('module', 'cloud_computing_data');

  $base = array(
    'file' => 'theme.inc',
    'path' => "$module_path/theme",
  );

  return array(
    'cloud_computing_page' => $base + array(
      'template' => 'cloud-computing-page',
      'variables' => array('companies' => array()),
    ),
    'cloud_computing_item' => $base + array(
      'template' => 'cloud-computing-item',
      'variables' => array('company' => array()),
    ),
    'cloud_computing_item_details' => $base + array(
      'template' => 'cloud-computing-item-details',
      'variables' => array('company' => array()),
    ),
  );
}

/// Page Definition Functions //////////////////////////////////////////////////

function cloud_computing_data_grid_display_filters(){

  // form definition
  $filters = array(
    '#method' => 'get',
    '#tree' => true,
    '#theme_wrappers' => array('form'),
    '#no_redirect' => true,
    '#always_process' => true,
    '#type' => 'form',
    '#token' => false,
    '#after_build' => array('cloud_computing_data_grid_display_filters_unset_id'),
    '#attributes' => array(
      'class' => array('cc-filters'),
    ),
  );

  // get service provider listing
  $qry = db_select('cloud_computing_capability_data', 'cd');
  $qry -> fields('cd', array(
    'service_provider',
    ))
    -> orderBy('service_provider', 'ASC')
    -> groupBy('service_provider');

  $result = $qry -> execute();
  $providers = array();
  foreach($result as $provider_serialized){
    $provider_parts = explode(';',$provider_serialized->service_provider);
    foreach($provider_parts as $part){
      $part = trim($part);
      if (!empty($part)){
        $providers[$part] = $part;
      }
    }
  }

  $qry = db_select('cloud_computing_capability_data', 'cd');
  $qry -> fields('cd', array(
    'contract',
  ))
  -> orderBy('contract', 'ASC')
  -> groupBy('contract');

  $result = $qry -> execute();
  $contracts = array();
  foreach($result as $row){
    $contracts[$row->contract] = $row->contract;
  }

  // contract dropdown
  $filters['contract'] = array(
    '#type' => 'select',
    '#title' => t('Contract'),
    '#default_value' => 'Any',
    '#options' => array(
      'any' => 'Any'
    ),
    '#multiple' => false,
    '#name' => 'contract',
  );

  foreach($contracts as $contract){
    $contract_plain = check_url($contract);
    $contract_plain = preg_replace('/\s/','-',strtolower($contract_plain));
    $filters['contract']['#options'][$contract_plain] = $contract;
  }

  // providers dropdown
  $filters['service_provider'] = array(
    '#type' => 'select',
    '#title' => t('Service Provider'),
    '#default_value' => 'Any',
    '#options' => array(
      'any' => 'Any'
    ),
    '#multiple' => false,
    '#name' => 'provider',
  );

  foreach($providers as $provider){
    $provider_plain = check_url($provider);
    $provider_plain = preg_replace('/\s/','-',strtolower($provider_plain));
    $filters['service_provider']['#options'][$provider_plain] = $provider;
  }

  // services checkboxes
  $filters['services'] = array(
    '#attributes' => array(
      'class' => array('checkbox-list'),
      ),
    '#type' => 'container',
  );

  $filters['services']['iaas'] = array(
    '#type' => 'checkbox',
    '#title' => t('IaaS'),
    '#value' => false,
    '#name' => 'iaas',
  );

  $filters['services']['paas'] = array(
    '#type' => 'checkbox',
    '#title' => t('PaaS'),
    '#value' => false,
    '#name' => 'paas',
  );

  $filters['services']['saas'] = array(
    '#type' => 'checkbox',
    '#title' => t('SaaS'),
    '#value' => false,
    '#name' => 'saas',
  );

  $filters['services']['eaas'] = array(
    '#type' => 'checkbox',
    '#title' => t('EaaS'),
    '#value' => false,
    '#name' => 'eaas',
  );

  // if the form was submitted previously...
  if (!empty($_GET)){

    // handle previous submissions manually for service provider
    if (isset($_GET['provider'])){
      $provider_plain = check_url($_GET['provider']);
      $provider_plain = preg_replace('/\s/','-',strtolower($provider_plain));
      if (isset($filters['service_provider']['#options'][$provider_plain])){
        $filters['service_provider']['#value'] = $provider_plain;
      }
      $filters['us_hosting']['#value'] = check_plain($_GET['hosted']);
    }

    // handle previous submissions manually for contract
    if (isset($_GET['contract'])){
      $contract_plain = check_url($_GET['contract']);
      $contract_plain = preg_replace('/\s/','-',strtolower($contract_plain));
      if (isset($filters['contract']['#options'][$contract_plain])){
        $filters['contract']['#value'] = $contract_plain;
      }
    }

    // handle previous submissions manually for services
    foreach($filters['services'] as $k => &$service){
      if (isset($_GET[$service['#name']])){
        $service['#value'] = $_GET[$service['#name']] ? true : false;
      }
    }
  }

  // add service description label
    $filters['services']['description'] = array(
    '#type' => 'markup',
    '#name' => 'Services Offerings',
    '#markup' => '<div class="checkbox-label">Service Offerings</div>',
    '#weight' => -1,
  );

  // services checkboxes
  $filters['filter'] = array(
    '#attributes' => array(
      'class' => array('submission-buttons'),
      ),
    '#type' => 'container',
  );

  // add service description label
    $filters['filter']['description'] = array(
    '#type' => 'markup',
    '#name' => 'Filter Results',
    '#markup' => '<div class="submission-buttons-label">Filter Results</div>',
    '#weight' => -1,
  );

  // add submit button
  $filters['filter']['submit'] = array(
    '#type' => 'submit',
    '#value' => t('Filter'),
    '#submit' => array('cloud_computing_data_grid_display_filters_submit'),
    '#name' => '',
    '#processed' => true,
  );

  $path = base_path() . 'cloud-computing/cio-sp3';

  $filters['filter']['reset'] = array(
    '#type' => 'markup',
    '#name' => 'reset',
    '#markup' => '<a class="reset-button" href="' . $path . '">Reset</a>'
  );

  return $filters;
}

function cloud_computing_data_grid_display_filters_unset_id($form){
  unset($form['#build_id'], $form['form_build_id'], $form['form_id']);
  return $form;
}

function cloud_computing_data_grid_display_filters_submit(){
  return;
}

function cloud_computing_data_block_view($delta = ''){
  switch($delta){
    case 'cloud_computing_filters':
      $block['subject'] = t('Cloud Computing Filters');

      $form_state = array();
      $filters = drupal_build_form('cloud_computing_data_grid_display_filters', $form_state);
      $filters['#action'] = base_path() . 'cloud-computing/cio-sp3';
      $block['content'] = drupal_render($filters);

      return $block;
  }
  return null;
}

/**
 *  Class to help make managing company data easier.
 */
class cloud_computing_data_company{

  // instance variables
  public $name              = '';
  public $contract          = '';
  public $roles             = array();   
  public $service_providers = array();
  public $cloud_types       = array();
  public $us_hosted         = array();
  public $iaas              = false;
  public $paas              = false;
  public $saas              = false;
  public $eaas              = false;
  public $fedramp           = false;
  public $other             = false;

  // function to build object from DB row
  public static function build($row){
    $instance = new cloud_computing_data_company();

    $instance -> ccid              = $row -> ccid;
    $instance -> delta             = $row -> delta;
    $instance -> name              = $row -> company;
    $instance -> contract          = $row -> contract;
    $instance -> roles             = explode(';',$row -> role);
    $instance -> service_providers = explode(';',$row -> service_provider);
    $instance -> cloud_types       = explode(';',$row -> cloud_type);
    $instance -> us_hosted         = explode(';',$row -> us_hosted);
    $instance -> iaas              = $row -> iaas;
    $instance -> paas              = $row -> paas;
    $instance -> saas              = $row -> saas;
    $instance -> eaas              = $row -> eaas;
    $instance -> fedramp           = $row -> fedramp;
    $instance -> other             = $row -> other;

    return $instance;
  }

  // function to un-foobar an array of terribly formatted spreadsheet data
  public static function un_foobar_array($foobar_array){

    $assoc_parts = array();
    foreach($foobar_array as $foobar_item){
      $foobar_item = preg_replace('/\?/','',$foobar_item);
      $foobar_item = preg_replace('/(,|;|(<br\/>)|([0-9]\.))/',',',$foobar_item);
      $foobar_parts = explode(',', $foobar_item); // BOOM!    <-- FUUUUNNY
      foreach($foobar_parts as $part){
        $part = trim($part);
        if (!empty($part)){
          $assoc_parts[$part] = $part;
        }
      }
    }

    $fixed_array = array();
    foreach($assoc_parts as $k => $v){
      $fixed_array[] = $v;
    }
    sort($fixed_array);
    return $fixed_array;
  }

  // function to merge multiple companies into one 
  // I wish it were as effecient as the one AT&T uses to combat anti-monopoly measures   <--- FUNNY AGAIN
  public static function merge($companies){
    $merged_company = new cloud_computing_data_company();

    // uncommented string processing code ahead

    foreach($companies as $company){
      if (!empty($company -> name)){
        $merged_company -> name = trim($company -> name);
      }

      $company -> contract = trim($company -> contract);
      if (!empty($company -> contract)){
        $merged_company -> contract = trim($company -> contract);
      }

      $merged_company -> roles = array_merge($merged_company->roles, $company->roles);
      $merged_company -> service_providers = array_merge($merged_company->service_providers, $company->service_providers);
      $merged_company -> cloud_types = array_merge($merged_company->cloud_types, $company->cloud_types);
      $merged_company -> us_hosted = array_merge($merged_company->us_hosted, $company->us_hosted);

      if (($company->iaas) && (strtolower($company->iaas) != 'no')){
        $merged_company -> iaas = true;
      }
      if (($company->paas) && (strtolower($company->paas) != 'no')){
        $merged_company -> paas = true;
      }
      if (($company->saas) && (strtolower($company->saas) != 'no')){
        $merged_company -> saas = true;
      }
      if (($company->eaas) && (strtolower($company->eaas) != 'no')){
        $merged_company -> eaas = true;
      }

      $company -> fedramp = trim($company -> fedramp);
      if (!empty($company -> fedramp)){
        $merged_company -> fedramp = trim($company -> fedramp);
      }
      $company -> other = trim($company -> other);
      if (!empty($company -> other)){
        $merged_company -> other = trim($company -> other);
      }
    }

    // fix all of the corrupt arrays
    $merged_company -> roles = cloud_computing_data_company::un_foobar_array($merged_company -> roles);
    $merged_company -> service_providers = cloud_computing_data_company::un_foobar_array($merged_company -> service_providers);
    $merged_company -> cloud_types = cloud_computing_data_company::un_foobar_array($merged_company -> cloud_types);
    $merged_company -> us_hosted = cloud_computing_data_company::un_foobar_array($merged_company -> us_hosted);

    return $merged_company;
  }

  // function to get DB fields
  public static function db_fields(){
    return array(
      'ccid',
      'delta',
      'company',
      'contract',
      'role',
      'service_provider',
      'cloud_type',
      'us_hosted',
      'iaas',
      'paas',
      'saas',
      'eaas',
      'fedramp',
      'other',
    );
  }

  // function to convert to array for DB insertion
  public function db_values(){
    return array(
      'ccid'             => $this->ccid,
      'delta'            => $this->delta,
      'company'          => $this->name,
      'contract'         => $this->contract,
      'role'             => implode(';',$this->roles),
      'service_provider' => implode(';',$this->service_providers),
      'cloud_type'       => implode(';',$this->cloud_types),
      'us_hosted'        => implode(';',$this->us_hosted),
      'iaas'             => $this->iaas,
      'paas'             => $this->paas,
      'saas'             => $this->saas,
      'eaas'             => $this->eaas,
      'fedramp'          => $this->fedramp,
      'other'            => $this->other,
    );
  }

  // function to convert to array for theming
  public function to_array(){
    return array(
      'ccid'              => $this->ccid,
      'delta'             => $this->delta,
      'company'           => $this->name,
      'name'              => $this->name,
      'contract'          => $this->contract,
      'roles'             => $this->roles,
      'service_providers' => $this->service_providers,
      'cloud_types'       => $this->cloud_types,
      'us_hosted'         => $this->us_hosted,
      'iaas'              => $this->iaas,
      'paas'              => $this->paas,
      'saas'              => $this->saas,
      'eaas'              => $this->eaas,
      'fedramp'           => $this->fedramp,
      'other'             => $this->other,
    );
  }

}

/**
 * This function displays a grid of cloud computing companies
 */
function cloud_computing_data_grid_display($arg){

  // Definitely should have just used views here. Opted to do it live, because
  // I didn't want to create more useless nodes to store cloud 
  // computing details. Really should have just made a "cloud computing dossier"
  // content type or something. At least this executes (comparitively) fast...

  $form_state = array('method' => 'get');
  $filters = drupal_build_form('cloud_computing_data_grid_display_filters', $form_state);

  // get companies   ------------use this to filter company names and apply A-Z Filter----------
  $companies = array();    // array of company names for filtering

  $qry = db_select('cloud_computing_capability_data', 'cd');
  $qry -> fields('cd', cloud_computing_data_company::db_fields());

  // add service provider filter
  if (!empty($form_state['values']['service_provider'])){
    if (strtolower($form_state['values']['service_provider']) != 'any'){
      $provider_plain = check_plain($form_state['values']['service_provider']);
      $provider_wildcards = preg_replace('/-/','%',strtolower($provider_plain));
      $provider_wildcards = '%' . $provider_wildcards . '%';

      $qry -> condition('cd.service_provider', $provider_wildcards, 'LIKE');
    }
  }

    // add service provider filter
  if (!empty($form_state['values']['contract'])){
    if (strtolower($form_state['values']['contract']) != 'any'){
      $contract_plain = check_plain($form_state['values']['contract']);
      $contract_wildcards = preg_replace('/-/','%',strtolower($contract_plain));
      $contract_wildcards = '%' . $contract_wildcards . '%';

      $qry -> condition('cd.contract', $contract_wildcards, 'LIKE');
    }
  }

  // filter by services offered
  $iaas_required = $form_state['values']['services']['iaas'];
  $paas_required = $form_state['values']['services']['paas'];
  $saas_required = $form_state['values']['services']['saas'];
  $eaas_required = $form_state['values']['services']['eaas'];

  if ($iaas_required){ $qry -> condition('cd.iaas', true); }
  if ($paas_required){ $qry -> condition('cd.paas', true); }
  if ($saas_required){ $qry -> condition('cd.saas', true); }
  if ($eaas_required){ $qry -> condition('cd.eaas', true); }

  $qry -> orderBy('cd.company', 'ASC');
  $company_rows = $qry -> execute();

  foreach ($company_rows as $row){
    $company = cloud_computing_data_company::build($row);
    $companies[$company -> name] = $company->to_array();
  }

  $companies_themed = array();
  foreach($companies as $name => $company){
    $company['services_display'] = array();
    $company['services_display']['IaaS'] = cloud_computing_data_wrap_service($company['iaas'], 'IaaS');
    $company['services_display']['PaaS'] = cloud_computing_data_wrap_service($company['paas'], 'PaaS');
    $company['services_display']['SaaS'] = cloud_computing_data_wrap_service($company['saas'], 'SaaS');
    $company['services_display']['EaaS'] = cloud_computing_data_wrap_service($company['eaas'], 'EaaS');
    $companies_themed[] = theme('cloud_computing_item', array('company' => $company));
  }

  $res_path = drupal_get_path('module', 'cloud_computing_data');

  drupal_add_css($res_path . '/theme/cloud-computing.css');
  drupal_add_js($res_path . '/theme/cloud-computing-grid.js');

  return theme('cloud_computing_page', array('companies' => $companies_themed));
}

// filter by company name

/**
 * This function wraps a service name in a span and adds an icon in order
 * to indicate whether a given company provides said service.
 */
function cloud_computing_data_wrap_service($value, $name){
  global $base_url;
  $module_path = $base_url . '/' . drupal_get_path('module', 'cloud_computing_data');
  $returnVal = "";
  if ($value){
    $returnVal .= "<span class='cloud-service-offering offered' title='This contract holder provides $name.'>$name";
    $returnVal .= "<img class='icon' src='{$module_path}/theme/service-provided.png' alt='This contract holder provides $name.'/>";
    $returnVal .= "</span>";
  } else {
    $returnVal .= "<span class='cloud-service-offering not-offered' title='This contract holder does not provide $name.'>$name";
    $returnVal .= "<img class='icon' src='{$module_path}/theme/service-not-provided.png' alt='This contract holder does not provide $name.'/>";
    $returnVal .= "</span>";
  }
  return $returnVal;
}

/**
 * The function that went here has been deleted.
 */ 

/// Database Population Functions //////////////////////////////////////////////

/**
 * This function accepts the nid of a sheetnode, and updates the cloud computing
 * database using the data from said node. It is indended to be triggered via
 * a url redirect (implemented by Rules) after saving the node in question.
 */
function cloud_computing_data_populate_from_node($nid){

  // ensure we have a viable node to work with
  $node = node_load($nid);
  if (!$node){
    drupal_set_message('The specified node was not found.', error);
    return array();
  }
  if ($node -> type != 'sheetnode'){
    drupal_set_message('The specified node is not of the correct type (not a sheetnode).', error);
    return array();
  }

  // include socialcalc api functionality from sheetnode
  require_once(drupal_get_path('module', 'sheetnode') . '/socialcalc.inc');

  // standard column mapping for cloud computing sheet
  $col_mapping = array(
    'A' => 'company',
    'B' => 'contract',
    'C' => 'role',
    'D' => 'service_provider',
    'E' => 'cloud_type',
    'F' => 'us_hosted',
    'G' => 'iaas',
    'H' => 'paas',
    'I' => 'saas',
    'J' => 'eaas',
    'K' => 'fedramp',
    'L' => 'other',
  );

  $sheetnodes = db_query("SELECT * FROM {sheetnode} WHERE nid in (:nid) GROUP BY nid", array(':nid' => $nid));
  if (empty($sheetnodes)){
    throw new Exception('Unable to find a sheetnode with matching id in database.');
  }
  foreach($sheetnodes as $sheetnode){
    $sheet = socialcalc_parse_sheet((string) $sheetnode->value);
  }

  // transpose values into an easy-to-reference 2d array
  $rows = array();
  foreach($sheet['cells'] as $loc => $cell){
    $row = preg_replace('/[^0-9]/', '',$loc);
    $col = preg_replace('/[0-9]/', '',$loc);
    $rows[$row][$col] = $cell['datavalue'];
  }

  $unmerged_companies = array();
  $last_company_name = '';
  foreach($rows as $k => $row){

    $mapped_row = array();
    foreach($row as $row_key => $row_val){
      $mapped_row[$col_mapping[$row_key]] = $row_val;
    }

    $company = cloud_computing_data_company::build((object)$mapped_row);

    if (!(empty($company->name))){
      $last_company_name = $company -> name;
    } else {
      $company -> name = $last_company_name;
    }

    if (!isset($unmerged_companies[$company -> name])){
      $unmerged_companies[$company -> name] = array();
    }

    $unmerged_companies[$company -> name][] = $company;
  }

  $companies = array();
  foreach($unmerged_companies as $name => $company_group){
    $company = cloud_computing_data_company::merge($company_group);
    if (strtolower($company -> name) != 'company'){
      $companies[$company -> name] = $company;
    }
  }

  // clear existing data
  $query = db_delete('cloud_computing_capability_data') -> where(1);
  $query -> execute();

  // insert new values into database.
  $query = db_insert('cloud_computing_capability_data');
  $query -> fields(cloud_computing_data_company::db_fields());

  $ccid = 0;
  foreach($companies as $name => $row){

    $delta = 0;
    $row->ccid = $ccid;
    $row->delta = $delta;

    $query->values($row->db_values());
    $ccid++;
  }

  $query->execute();
  drupal_set_message('The CIO-SP3 / SB Cloud Computing database has been updated!');
  drupal_set_message("Debug info: $ccid companies recognized and added to database.");
  drupal_goto("node/$nid");
  return array();

 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-07T15:32:12.310

尝试词汇表视图模式。看到这个[http://www.youtube.com/watch?v=18Ajtmstxsg](http://www.youtube.com/watch?v=18Ajtmstxsg)

# django - 在 django 模板中迭代用户

> ID：16172937
> 
> 赞同：2
> 
> 时间：2013-04-23T15:10:18.320
> 
> 标签：django

我想在我的个人资料模板中打印所有用户值。手动打印它可以工作：`

```
<table class="table table-striped table-bordered"> 
    <tr><th>{{ user.username }}</th></tr>
    <tr><th>{{ user.first_name }}</th></tr>
    <tr><th>{{ user.last_name }}</th></tr>
    <tr><th>{{ user.email }}</th></tr>
</table>` 
```

但这种方法不起作用：`

```
<table class="table table-striped table-bordered">
    {% for field in user.fields %}
        <tr>
            <td>{{ field.name }}</td>
            <td>{{ field.value }}</td>
        </tr>
    {% endfor %}
</table> 
```

我试图使用这种方法[迭代模板中的模型实例字段名称和值](https://stackoverflow.com/questions/2170228/django-iterate-over-model-instance-field-names-and-values-in-template)

有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T16:42:51.000

模型实例上没有可用的称为字段的属性。

如果你真的想要这样的东西：

视图.py：

```
d = {}

for each in u._meta.fields:
    d[each.name] = getattr(u, each.name) 
```

模板：

```
{% for k,v in d.items %}
    {{k}}
    {{v}}
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:22:47.970

您必须确保通过您的 views.py 文件（而不是 user.username 或 user.first_name 等）发送“用户”对象本身。这样您就可以在模板中编写：

```
<table class="table table-striped table-bordered">
        {% for field in user %}
            <tr>
                <td>{{ field.name }}</td>
                <td>{{ field.value }}</td>
            </tr>
        {% empty %}
            <tr>
                <td>No "user" field</td>
            </tr>
        {% endfor %} 
</table> 
```

注意第二行的变化（“for field in user”）。

# android - 如何强制 TableRow 包装内容？

> ID：16172941
> 
> 赞同：1
> 
> 时间：2013-04-23T15:10:21.603
> 
> 标签：android, android-layout, android-tablelayout

我正在尝试构建一个非常简单的 TableLayout，它有 2 列和不确定的行数。在第一列中，我放置了一个 TextView，它必须写在 2 行上：

```
 <string name="param_period_data_rec_text">Période d\'acquisition des données\n(secondes)</string> 
```

在第二列中，我放置了一个 EditText。

我的问题是：EditText 的高度约为 1 行半文本，而 TableRows 环绕它，隐藏了 TextView 第二行的一半。

当然，我希望 TextView 能够完全显示。我应该怎么做？

```
<TableLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_margin="30dp"
    android:background="@color/blanc"
    android:orientation="horizontal"
    android:padding="20dp" >

    <TableRow
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/param_frequence_data_rec_text"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/param_period_data_rec_text"
            android:textColor="@android:color/black"
            android:textSize="20sp" />

        <EditText
            android:id="@+id/param_frequence_data_rec_input"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/param_period_data_rec_input"
            android:textColor="@android:color/black"
            android:textSize="20sp" />
    </TableRow>

</TableLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:20:14.123

```
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="horizontal">

<TableRow
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/param_frequence_data_rec_text"
        android:layout_width="0dp"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:text="@string/param_period_data_rec_text"
        android:textColor="@android:color/black"
        android:textSize="20sp" />

    <EditText
        android:id="@+id/param_frequence_data_rec_input"
        android:layout_width="0dp"
        android:layout_height="fill_parent"
        android:layout_weight="1"
        android:text="editText"
        android:textColor="@android:color/black"
        android:textSize="20sp" />
</TableRow> 
```

update: textVeiw and editText width = 0dp, so that layout_weight="1" property can work

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:18:07.890

尝试`android:layout_height="wrap_content"`在`fill_parent`您的`TextView`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-23T15:18:56.173

尝试添加

```
android:minLines="2" 
```

到描述需要至少有两行的小部件的标签。wrap_content （您已经拥有）应该负责其余的工作。

# quickbooks - QuickBook SDK QBFC 不允许在未在 quickbook 中打开文件的情况下访问文件

> ID：16172942
> 
> 赞同：1
> 
> 时间：2013-04-23T15:10:27.583
> 
> 标签：quickbooks, qbfc

QuickBook SDK QBFC 不允许在未在 quickbook 中打开文件的情况下访问该文件。请任何机构让我需要配置什么来访问文件而不打开。

得到错误。

QuickBooks 公司数据文件已打开，并且与请求的不同，或者打开了多个公司文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-30T12:55:32.750

打开公司文件时，您可以指定路径，也可以省略路径。省略路径，使用 Quickbooks（在那台电脑上）中打开的当前公司。指定路径，允许您打开特定的公司，无论天气如何，它是否已经打开。

还值得注意的是，指定您的“模式”，单或多访问/用户。

值得注意的是，首次连接时，您需要打开公司，因为它需要弹出一个允许您“授权”sdk / 应用程序连接的权限对话框。

# mysql - 用于选择不同数据的高级 SQL 查询

> ID：16172943
> 
> 赞同：0
> 
> 时间：2013-04-23T15:10:27.907
> 
> 标签：mysql, sql, select

我有两个表需要从中提取数据。表1（t1）和样本值：

```
| rq_id | user_id | is_good |  
|----- 1     |---- 223     |--------      0  ----   |  
|----- 3     |---- 223     |--------      1   ----  |  
|----- 4     |---- 239     |--------      0   ----  |  
|----- 5     |---- 223     |--------      0   ----  | 
```

表2（t2）和样本值：

```
| rq_id | version | random_content |  
|---1---|---3------|------A------|    
|---1---|---2------|------B------|    
|---1---|---1------|------C------|  
|---3---|---2------|------D------|  
|---3---|---1------|------F------|  
|---5---|---2------|------X------|  
|---5---|---1------|------W------| 
```

在 Table1 中 rq_id 是唯一的，在 table2 中有多个具有相同 rq_id 的行。
我需要从 Table2 中为每个 rq_id 获取 1 行（只有最高版本的行）。从 Table2 中选择 request_ids 的标准来自 Table1，其中 user_id=223 和 is_good="0"。
所以在这种情况下，我希望它返回：
`|---1---|---3------|------A------|`和
`|---5---|---2------|------X------|`.

这可以在一个带有一些关节和不同选择/内部选择或其他任何东西的快速 SQL 查询中完成吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:14:30.470

```
SELECT  b.*
FROM    Table1 a
        INNER JOIN Table2 b
            ON a.rq_ID = b.rq_ID
        INNER JOIN
        (
            SELECT  rq_id, MAX(version) max_ver
            FROM    table2
            GROUP   BY rq_id
        ) c ON  b.rq_ID = c.rq_ID AND
                b.version = c.max_ver
WHERE   a.user_ID = 223 AND a.is_good = 0 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/954d2/2)

# scala - 两种不相关类型的类型绑定

> ID：16172945
> 
> 赞同：1
> 
> 时间：2013-04-23T15:10:32.107
> 
> 标签：scala

Scala 中是否可以对两种不相关的类型进行限制？例如，

```
trait A
trait B
def m(T <: A or B) ???? 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:29:04.350

如果您的`A`and`B`完全不相关（例如，没有您需要的常用方法，否则您可以只使用结构类型），这意味着当您将其用作方法参数时，您仍然需要它实际上是什么类型才能使用它们.

在这种情况下，[Either[A, B]](http://www.scala-lang.org/api/current/index.html#scala.util.Either)正是您所需要的。它表示一个对象必须是 A 或 B 之一，您可以在 Either 类中使用模式匹配或其他方法来检查它们。

例如：

```
class MyClassA { 
  def methodA() = println("I'm A")
}

class MyClassB {
  def methodB() = println("I'm B")
}

def m(a: Either[MyClassA, MyClassB]) {
   a match {
     case Left(a) => a.methodA()
     case Right(b) => b.methodB()
   }
}

m(Left(new MyClassA))  // OK
m(Right(new MyClassB)) // OK
m(Left(new MyClassB))  // Failed, a Left must be a MyClassB instance 
```

您可能对这篇[文章](http://danielwestheide.com/blog/2013/01/02/the-neophytes-guide-to-scala-part-7-the-either-type.html)感兴趣，它非常清楚地解释了 Either 是什么。

# html - CSS将文本垂直对齐到div的中间

> ID：16172954
> 
> 赞同：13
> 
> 时间：2013-04-23T15:10:53.983
> 
> 标签：html, css

强制div中的文本垂直对齐到中间的正确方法是什么？我发现了一些“技巧”，但我需要一些适用于单行和多行的东西。希望我错过了一些愚蠢的简单事情：

[http://jsfiddle.net/rogerguess/DawFy/](http://jsfiddle.net/rogerguess/DawFy/)

```
.header {
    display: inline-block;    
    text-align: center;
    width: 123px;
    background: green;
    border-radius: 4px 4px 4px 4px;
    height: 80px;
    vertical-align: middle;
}

<div >
    <div class="header">test1 </div>
    <div class="header">some text that will wrap</div>
    <div class="header">test3</div>
</div> 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-23T15:17:28.187

更改`display: inline-block;`为`display: table-cell;`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-23T15:19:51.507

如果您的多行元素出于响应原因需要换行，那么最好的选择是使用 Flexbox。由于 Firefox 2009 Flexbox 实现的脆弱性，它的处理方式必须与现代 Flexbox 实现稍有不同。

[http://codepen.io/cimmanon/pen/mxuFa](http://codepen.io/cimmanon/pen/mxuFa)

```
<ul>
  <li>One lorem ipsum dolor sit amet</li><!--
  --><li>Two</li><!--
  --><li>Three</li><!--
  --><li>Four</li><!--
  --><li>Five</li>
</ul>

li {
  text-align: center;
  vertical-align: middle;
  /* fallback for non-Flexbox browsers */
  display: inline-block;
  /* Flexbox browsers */
  display: -webkit-inline-box;
  display: -moz-inline-box;
  display: -ms-inline-flexbox;
  display: -webkit-inline-flex;
  display: inline-flex;
  /* vertical centering for legacy, horizontal centering for modern */
  -webkit-box-pack: center;
  -moz-box-pack: center;
  -ms-flex-pack: center;
  -webkit-justify-content: center;
  justify-content: center;
  /* modern Flexbox only */
  -ms-flex-align: center;
  -webkit-align-items: center;
  align-items: center;
  /* legacy Flexbox only */
  -webkit-box-orient: vertical;
  -moz-box-orient: vertical;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-11T11:24:47.487

我为你做了一个简单的例子，在父 div 上使用 display: table-cell 属性。

```
CSS:
    .outer {
    width: 500px;
    height: 500px;
    display: table-cell;
    background-color: red;
    vertical-align: middle;
}

.inner {
    display: block;
    width: 300px;
    height: 200px;
    margin: 0px auto;
    background-color: yellow;
} 
```

HTML： `<div class="outer"> <div class="inner"> </div> </div>`

[http://jsfiddle.net/aKT42/](http://jsfiddle.net/aKT42/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-04-18T07:29:16.027

试试这个，它会工作的。

```
 <div class="greenBorder" id="outer">
         <div id="middle">
             <div class="greenBorder" id="inner">
             Your Text Here
             </div>
         </div>
    </div> 
```

CSS类

```
 #outer {
        height: 100%;
        overflow: hidden;
        position: relative;
        width: 100%;
        display: table;
        position: static;
    }

    div.greenBorder {
        background-color: #39B9FF;
        text-align: center;
        color: white;
    }

    #middle[id] {
        display: table-cell;
        position: static;
        vertical-align: middle;
        width: 100%;
    }

    #middle {
        position: absolute;
        top: 50%;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-23T15:22:11.883

[http://jsfiddle.net/DawFy/16/](http://jsfiddle.net/DawFy/16/)

```
.header {

display: block;    
text-align: center;
    width: 123px;
background: green;
border-radius: 4px 4px 4px 4px;
height: 80px;
margin:0px auto;

}
li
 {
list-style-type:none;

 }

<div >
<li>
<div class="header">test1 </div>
<li>
    <div class="header">some text that will wrap</div>
<li>
    <div class="header">test3</div> 
```

*   试试这个不知道它是否“正确”但有效

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-06T23:04:41.150

这些解决方案中的大多数对我都不起作用，因为要么手动指定高度（我不能这样做），要么像 inline-block 和 float 这样的东西会消除内部 div 继承父 div 高度的能力。我最终创建了一个包含两列的表格，每列都包含我的 div，然后我没有问题垂直居中文本。

# c++ - Opencv C++到C接口函数转换

> ID：16172955
> 
> 赞同：1
> 
> 时间：2013-04-23T15:10:58.557
> 
> 标签：c++, c, function, opencv

```
void doCorrectIntensityVariation(Mat& image)
{   
    Mat kernel = getStructuringElement(MORPH_ELLIPSE, Size(19,19));
    Mat closed;
    morphologyEx(image, closed, MORPH_CLOSE, kernel);
    image.convertTo(image, CV_32F); // divide requires floating-point
    divide(image, closed, image, 1, CV_32F);
    normalize(image, image, 0, 255, NORM_MINMAX);
    image.convertTo(image, CV_8UC1); // convert back to unsigned int

}

inline void correctIntensityVariation(IplImage *img)
{
//Mat imgMat(img); copy the img
Mat imgMat;
imgMat = img; //no copy is done, imgMat is a header of img
doCorrectIntensityVariation(imgMat);
imshow("gamma corrected",imgMat); cvWaitKey(0);
} 
```

当我打电话

```
cvShowImage ("normal", n_im); cvWaitKey (0);
correctIntensityVariation(n_im);//here n_im is IplImage*
cvShowImage ("After processed", n_im); cvWaitKey (0);
// here I require n_im for further processing 
```

我希望“处理后”与“伽马校正”相同，但我发现“处理后”与“伽马校正”不同，但与“正常”相同。为什么？？出了什么问题？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T15:50:11.123

一个非常简单的包装器应该可以完成这项工作

[openCV 的小抄](http://opencv.willowgarage.com/documentation/cpp/c++_cheatsheet.html)

我很少使用旧的 api，因为 Mat 更容易处理，并且与旧的 c api 相比，它们没有性能损失。就像 openCV 教程页面说**的 C++ 接口的主要缺点是很多嵌入式开发目前的系统仅支持 C。因此，除非您的目标是嵌入式平台，否则使用旧方法是没有意义的（除非您是受虐狂程序员并且您正在自找麻烦）。**

[openCV 教程](http://docs.opencv.org/doc/tutorials/core/mat_the_basic_image_container/mat_the_basic_image_container.html#matthebasicimagecontainer)

cv::Mat 到 Ipl

Ipl 到 cv::Mat 和 Mat 到 Ipl

```
IplImage* pImg = cvLoadImage(“lena.jpg”);
cv::Mat img(pImg,0); //transform Ipl to Mat, 0 means do not copy 
IplImage qImg; //not pointer, it is impossible to overload the operator of raw pointer
qImg = IplImage(img); //transform Mat to Ipl 
```

编辑：我之前犯了一个错误，如果要在函数中重新分配 Mat，您需要从 Mat 复制或尝试窃取资源（我还不知道该怎么做）。

复制数据

```
void doCorrectIntensityVariation(cv::Mat& image)
{
    cv::Mat kernel = cv::getStructuringElement(cv::MORPH_ELLIPSE, cv::Size(19,19));
    cv::Mat closed;
    cv::morphologyEx(image, closed, cv::MORPH_CLOSE, kernel);
    image.convertTo(image, CV_32F); // divide requires floating-point
    cv::divide(image, closed, image, 1, CV_32F);
    cv::normalize(image, image, 0, 255, cv::NORM_MINMAX);
    image.convertTo(image, CV_8UC1); // convert back to unsigned int

}

//don't need to change the name of the function, the compiler treat
//these as different function in c++
void doCorrectIntensityVariation(IplImage **img)
{
    cv::Mat imgMat;
    imgMat = *img; //no copy is done, imgMat is a header of img
    doCorrectIntensityVariation(imgMat);

    IplImage* old = *img;
    IplImage src = imgMat;
    *img = cvCloneImage(&src);
    cvReleaseImage(&old);
}

int main()
{

    std::string const name = "onebit_31.png";
    cv::Mat mat = cv::imread(name);
    if(mat.data){
        doCorrectIntensityVariation(mat);

        cv::imshow("gamma corrected mat",mat);
        cv::waitKey();
    }

    IplImage* templat = cvLoadImage(name.c_str(), 1);
    if(templat){
        doCorrectIntensityVariation(&templat);
        cvShowImage("mainWin", templat);

        // wait for a key
        cvWaitKey(0);
        cvReleaseImage(&templat);
    }

    return 0;
} 
```

你可以写一个小函数来减轻杂务

```
void copy_mat_Ipl(cv::Mat const &src, IplImage **dst)
{
         IplImage* old = *dst;
        IplImage temp_src = src;
        *dst = cvCloneImage(&temp_src);
        cvReleaseImage(&old);
} 
```

并在函数中调用它

```
void doCorrectIntensityVariation(IplImage **img)
{
    cv::Mat imgMat;
    imgMat = *img; //no copy is done, imgMat is a header of img
    doCorrectIntensityVariation(imgMat);    
    copy_mat_to_Ipl(imgMat, img);
} 
```

在找到可靠的解决方案后，我将发布如何从 Mat 中“窃取”资源而不是复制资源。有人知道该怎么做吗？

# javascript - PhoneGap GeoLocation 变量类型

> ID：16172959
> 
> 赞同：0
> 
> 时间：2013-04-23T15:11:08.333
> 
> 标签：javascript, android, html, cordova, geolocation

```
//   This method accepts a `Position` object, which contains
//   the current GPS coordinates
function onSuccess(position) {
    var element = document.getElementById('geolocation');
    element.innerHTML = 'Latitude: '               + position.coords.latitude                                 + '<br />' +
                            'Longitude: '          + position.coords.longitude             + '<br />' +
                            'Altitude: '           + position.coords.altitude              + '<br />' +
                            'Accuracy: '           + position.coords.accuracy              + '<br />' +
                            'Altitude Accuracy: '  + position.coords.altitudeAccuracy      + '<br />' +
                            'Heading: '            + position.coords.heading               + '<br />' +
                            'Speed: '              + position.coords.speed                 + '<br />' +
                            'Timestamp: '          +                                         position.timestamp             + '<br />';
} 
```

这是从phonegap自己的网站关于geoLocation的例子但是有一些我不能安静地理解的问题，我们使用位置变量对象来达到坐标的成员，如纬度，经度但是我们如何在js中创建位置对象，即使没有变量类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T15:14:44.253

“位置” var 由 Phonegap 创建，并在您执行以下操作时传递给回调成功函数：

```
navigator.geolocation.getCurrentPosition(onSuccess, onError); 
```

onSuccess 函数：

```
function onSuccess(position) {
    //Process the position here
} 
```

Phonegap api 文档中的完整示例：

```
<!DOCTYPE html>
<html>
  <head>
    <title>Exemple Geolocation</title>

    <script type="text/javascript" charset="utf-8" src="phonegap-1.3.0.js"></script>
    <script type="text/javascript" charset="utf-8">

    // Attendre que PhoneGap soit prêt
    //
    document.addEventListener("deviceready", onDeviceReady, false);

    // PhoneGap est prêt
    //
    function onDeviceReady() {
        navigator.geolocation.getCurrentPosition(onSuccess, onError);
    }

    // Fonction de callback onSuccess, reçoit un objet Position
    //
    function onSuccess(position) {
        var element = document.getElementById('geolocation');
        element.innerHTML = 'Latitude : '                + position.coords.latitude          + '<br/>' +
                            'Longitude : '               + position.coords.longitude         + '<br/>' +
                            'Altitude : '                + position.coords.altitude          + '<br/>' +
                            'Précision : '               + position.coords.accuracy          + '<br/>' +
                            'Précision de l'altitude : ' + position.coords.altitudeAccuracy  + '<br/>' +
                            'Direction : '               + position.coords.heading           + '<br/>' +
                            'Vitesse : '                 + position.coords.speed             + '<br/>';
    }

    // Fonction de callback onError, reçoit un objet PositionError
    //
    function onError(error) {
        alert('code : '    + error.code    + '\n' +
              'message : ' + error.message + '\n');
    }

    </script>
  </head>
  <body>
    <p id="geolocation">Recherche de géolocalisation...</p>
  </body>
</html> 
```

希望这可以帮助 ！再见 ！

# sql - 在 SQL 中计算不同值

> ID：16172966
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:11:36.813
> 
> 标签：sql, sql-server

我有一个如下所示的数据库：

```
Source   quoted    sold
google     1         0
google     0         0
google     1         1
google     1         0
google     1         1
direct     1         0
direct     0         0
direct     1         1
google     1         0 
```

我想计算来自 google 的引用人数，以及同一行中来自 google 的购买人数，以及其他来源。所以上面的结果看起来像

```
Source  quotes   solds
google    5        2
direct    2        1
another   23       5   (not noted above, but there are countless more) 
```

如何在 SQL 中获取这些信息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-23T15:13:18.187

它看起来像一个简单`SUM`的`GROUP BY`工作：

```
SELECT Source, SUM(quoted), SUM(Sold)
FROM MyTable
GROUP BY Source 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T15:23:42.803

如果这些列是列，我将提供不同的视角，而不是无数重复`BIT`。如果是，则当前查询将产生：

> 消息 8117，级别 16，状态 1，第 14 行
> 操作数数据类型位对于求和运算符无效。

要解决此问题，您可以使用以下结构之一：

```
DECLARE @t TABLE(Source VARCHAR(32), quoted BIT, sold BIT);

INSERT @t VALUES
('google',1,0),
('google',0,0),
('google',1,1),
('google',1,0),
('google',1,1),
('direct',1,0),
('direct',0,0),
('direct',1,1),
('google',1,0);

SELECT Source, 
    COUNT(NULLIF(quoted,0)), 
    COUNT(NULLIF(sold,  0))
 FROM @t
 GROUP BY Source;

SELECT Source, 
    SUM(CASE WHEN quoted = 1 THEN 1 ELSE 0 END),
    SUM(CASE WHEN sold   = 1 THEN 1 ELSE 0 END)
 FROM @t
 GROUP BY Source;

SELECT Source, 
    SUM(CONVERT(INT, quoted)),
    SUM(CONVERT(INT, sold))
 FROM @t
 GROUP BY Source; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-23T15:14:17.120

我想这就是你要找的...

```
SELECT source, SUM(quoted), SUM(sold)
FROM your_table
GROUP BY source. 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-23T15:15:17.740

这需要基本`GROUP BY`语法，并且您的数据库已为此完美设置：

```
select source, sum(quoted) quoted, sum(sold) sold
from your_table
group by source; 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-04-23T15:13:58.003

```
SELECT source, SUM(quoted = 1) AS quotes, SUM(solds = 1) AS solds
FROM yourtable
GROUP BY Source 
```

# spring-mvc - Spring security：认证成功后根据登录表单中的下拉值重定向

> ID：16172968
> 
> 赞同：0
> 
> 时间：2013-04-23T15:11:43.957
> 
> 标签：spring-mvc, spring-security, spring-webflow

当我使用'commandName'属性和spring security时，我没有从前端获得选定的下拉值，因为当我在控制器中获取它时，LoginModel字段（strLogintype，strUserType）变为'null'。

但是当我不使用spring security时，相同的代码可以正常工作。我确实尝试了[link1](https://stackoverflow.com/questions/15143912/spring-mvc-form-not-returning-value-from-dropdown-list)和[link2](https://stackoverflow.com/questions/5968046/how-do-make-spring-access-dropdown-box-values)中提到的解决方案，但它在我的情况下不起作用。

我的登录 JSP 代码是这样的：

```
 <script>
        $(document).ready(function() {
        $type = $("select[id='userType']");
        $page = $("select[id='signInPage']");
        $("<option>Account Summary</option>").appendTo($page);
        $("<option>Basket Order</option>").appendTo($page);
        $("<option>Portfolio</option>").appendTo($page);
        $type.change(function() {
                    ...
        });
        });
        </script>                              
    <c:set var = "url" value = "/j_spring_security_check" />
    <form:form method="post" commandName="portalLogin" action="${pageContext.servletContext.contextPath}${url}" name="f">
    <form:select path ="strUserType" style="font-family: tahoma;font-style: normal;font-size: 11px;" id="userType">
                  <form:option value="retail" selected="selected">Retail</form:option>
                  <form:option value="admin">Admin</form:option>
    </form:select>
    <div class="left"><spring:message code="label.startIn" /></div>
    <form:select path="strLogintype" style="font-family: tahoma;font-style: normal;font-size: 11px;" id="signInPage" > </form:select> 
```

我的控制器代码是这样的：

```
 @RequestMapping("/signIn")
    public ModelAndView onClickLogin(
    @ModelAttribute("portalLogin") LoginModel loginModel, Model model,HttpServletRequest request) {

    strLoginPg = loginModel.getStrLogintype();
    if (strLoginPg != null && strLoginPg.equals("Basket Order")) {
        return new ModelAndView("redirect:BasketOrders.html");
    } else if (strLoginPg != null && strLoginPg.equals("Portfolio")) {
        return new ModelAndView("redirect:portfolio.html");
    } else if (strLoginPg != null && strLoginPg.equals("Account Summary")) {
        return new ModelAndView("redirect:accountSummary.html");
    } else if (strLoginPg != null && strLoginPg.equals("General Settings")) {
        return new ModelAndView("redirect:settings.html");
    } else{
                    return new ModelAndView("redirect:adminConfig.html");
            }} 
```

[更新]：我尝试了两种方法：

我创建了自定义 authenticationsuccesshandler.LoginController 与它相同。当我运行应用程序时，我看到 CustomSimpleURLAuthenticationSuccessHandler 被触发，但在这里我再次没有从控制器的前端获取选定的下拉值，而是它为 null。因为这个我登陆不同的页面（adminConfig）。

第二种方式：

我恢复到我之前的代码。我只是将@RequestParam 属性用于 LoginController 的“onClickLogin”方法。

```
 @RequestMapping("/signIn")
public ModelAndView onClickLogin(
        @ModelAttribute("portalLogin") LoginModel loginModel, @RequestParam("strLogintype") String strtype, Model model,HttpServletRequest request) { 
```

jsp页面：

```
 <form:select path="strLogintype" name="strLogintype" style="font-family: tahoma;font-style: normal;font-size: 11px;" id="strLogintype" > 
```

但我收到以下错误“HTTP 状态 400 - 所需的字符串参数 'strLogintype' 不存在”。它还说“客户端发送的请求在语法上不正确”。这里出了什么问题？此外，@RequestParam 是否用于在 jsp 页面中获取“选定”下拉值。

一旦控制进入 Spring Security 并且当它调用控制器时，我如何保留选定的下拉值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T16:07:30.080

添加以下内容后，我得到了它的工作：

1.  web.xml 中的 RequestContextListener

    ```
     <listener>
           <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
           </listener> 
    ```

2.  CustomUsernamePasswordAuthenticationFilter 类

    ```
     public class CustomUsernamePasswordAuthenticationFilter extends
    UsernamePasswordAuthenticationFilter {
        @Override
    public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException {
        final String strLogintype = request.getParameter("strLogintype");
        request.getSession().setAttribute("strLogintype", strLogintype);
        return super.attemptAuthentication(request, response); 
    } 
    } 
    ```

3.  CustomSimpleURLAuthenticationSuccessHandler 类

    ```
     public class CustomSimpleURLAuthenticationSuccessHandler extends
    SimpleUrlAuthenticationSuccessHandler {
            public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response,
        Authentication authentication) throws IOException, ServletException {

        final String strLogintype = request.getParameter("strLogintype");
        String session= (String)request.getSession().getAttribute("strLogintype");
        setDefaultTargetUrl("/signIn.html?strLoginPg=" + request.getParameter("strLogintype"));
        super.onAuthenticationSuccess(request, response, authentication);
    }
    } 
    ```

我注意到 CustomUsernamePasswordAuthenticationFilter 类本身完成了在会话中存储附加参数的工作。我使用 CustomSimpleURLAuthenticationSuccessHandler 将附加参数 (strLoginPg) 与 DefaultTargetUrl (/signIn.html) 一起附加，我认为这是无法使用上下文 xml 中的任何其他属性完成的。谢谢。

# c# - 显示椭圆的半径 - WPF

> ID：16172971
> 
> 赞同：1
> 
> 时间：2013-04-23T15:11:51.507
> 
> 标签：c#, wpf, ellipse, pathgeometry

我有一个椭圆几何。我想用 C# 从圆心到圆的边缘画一条线来显示椭圆的半径。我怎样才能做到这一点？

注意：椭圆的中心和半径不是固定的，由用户定义。

![在此处输入图像描述](https://i.stack.imgur.com/POawf.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T17:48:06.277

假设你有一个已知中心和半径的椭圆：

```
 Path path = new Path();
        EllipseGeometry eg = new EllipseGeometry();
        eg.Center = new Point(left + side / 2, top + side / 2);
        eg.RadiusX = side / 2;
        eg.RadiusY = side / 2;
        path.Data = eg;
        paths.Add(path);
        canvas1.Children.Add(paths[paths.Count - 1]);
        .
        .
        path = new Path();
        borderColor.Color = Colors.Red;
        path.Stroke = borderColor;
        path.StrokeThickness = 2;
        LineGeometry r = new LineGeometry();
        r.StartPoint = eg.Center;
        r.EndPoint = new Point(eg.Center.X + eg.RadiusX, eg.Center.Y);
        path.Data = r;
        paths.Add(path);
        canvas1.Children.Add(paths[paths.Count - 1]); 
```

![在此处输入图像描述](https://i.stack.imgur.com/LAxpf.jpg)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T18:03:48.793

有很多不同的方法可以做到这一点。这是一个，可能会也可能不会满足您的需求。它只是一个用户控件。圆的半径取决于用户控件的大小，它会强制控件大小一致。定位用户控件将由您决定。内线的角度是可绑定的。

用户控件 xaml

```
<UserControl x:Class="TestWPF.CircleTest"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Foreground="Blue" Background="White"
             x:Name="CT" SnapsToDevicePixels="True">
    <Grid>
        <Ellipse Stroke="{Binding Foreground, ElementName=CT}" Fill="{Binding Background, ElementName=CT}" />
        <Line X1="{Binding Center.X, ElementName=CT}" X2="{Binding EndPoint.X, ElementName=CT}" Y1="{Binding Center.Y, ElementName=CT}" Y2="{Binding EndPoint.Y, ElementName=CT}" 
              Stroke="{Binding Foreground, ElementName=CT}">
            <Line.RenderTransform>
                <RotateTransform Angle="{Binding Angle, ElementName=CT}" CenterX="{Binding Center.X, ElementName=CT}" CenterY="{Binding Center.Y, ElementName=CT}" /> 
            </Line.RenderTransform>  
        </Line>
        <TextBlock Text="{Binding Angle, ElementName=CT, StringFormat='N2'}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="3" />
    </Grid>
</UserControl> 
```

后面的用户控制代码

```
using System;
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;

namespace TestWPF
{
    public partial class CircleTest : UserControl, INotifyPropertyChanged
    {
        public CircleTest()
        {
            InitializeComponent();

            this.SizeChanged += CircleTest_SizeChanged;
        }

        void CircleTest_SizeChanged(object sender, System.Windows.SizeChangedEventArgs e)
        {
            double radius;
            if (ActualHeight < ActualWidth)
            {
                Width = ActualHeight;
                _center = new Point(Width / 2, ActualHeight / 2);
                radius = ActualHeight / 2;
            }
            else
            {
                Height = ActualWidth;
                _center = new Point(ActualWidth / 2, Height / 2);
                radius = ActualWidth / 2;
            }

            _endPoint = new Point(Center.X, Center.Y - radius);

            NotifyOfPropertyChange("Center");
            NotifyOfPropertyChange("EndPoint");
        }

        public double Angle
        {
            get { return (double)GetValue(AngleProperty); }
            set { SetValue(AngleProperty, value); }
        }
        public static readonly DependencyProperty AngleProperty = DependencyProperty.Register("Angle", typeof(double), typeof(CircleTest), new PropertyMetadata(45.0));

        private Point _center;
        public Point Center
        {
            get { return _center; }
        }

        private Point _endPoint;
        public Point EndPoint
        {
            get { return _endPoint; }
        }

        public event PropertyChangedEventHandler PropertyChanged;
        private void NotifyOfPropertyChange(string propertyName)
        {
            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

你会这样使用它：

```
<Window x:Class="TestWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:test="clr-namespace:TestWPF"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <test:CircleTest Width="200" Height="200" Foreground="Purple" Angle="{Binding Value, ElementName=SL}" />
        <Slider x:Name="SL" Minimum="0" Maximum="360" VerticalAlignment="Bottom" Margin="20" />
    </Grid>
</Window> 
```

# file - qt从文件中读取所有数据时都被删除

> ID：16172974
> 
> 赞同：-1
> 
> 时间：2013-04-23T15:12:04.070
> 
> 标签：file, qt

```
 void visualICDAR::open()
{QString fileName = QFileDialog::getOpenFileName( this, tr( "Open Image" ), 
        QDir::homePath(), tr("Images ( *.tif )") );

    if( !fileName.isEmpty() )
    {
        QApplication::setOverrideCursor( QCursor( Qt::WaitCursor ) );

        pixmapWidget->setPixmap( fileName );

        QString dataFileName = fileName.replace( fileName.length() - 3, 3, "csv" );

        QFile data( dataFileName );
        if( !data.open(QIODevice::ReadOnly|QIODevice::Text) )
        {
            QMessageBox::warning( this, "NoCSV file founs!",
                QString( "No %1 file was found!" ).arg( dataFileName ) );
        }

        QTextStream text( &data );
        text.setCodec( "UTF-8" );

        QString dataString = text.readAll();

        ( (QStandardItemModel*)fileWidget->model() )->clear();
        fileWidget->AddRowsFromString( dataString );
        fileWidget->setOutputFile( dataFileName );

        data.close();

        QApplication::restoreOverrideCursor();
    }
}

    class CFileWidget : public QTableView
{
    Q_OBJECT

public:
    CFileWidget(QWidget *parent);
    ~CFileWidget();

    void setOutputFile( const QString fileName ) 
        { outputFile.setFileName(fileName); 
    outputFile.open(QIODevice::WriteOnly|QIODevice::Text); }

public slots:
    void AddRowsFromString( const QString& text );
    void DeleteSelectedRows();
    void AddRow();
    void SaveToFile();

signals:
    void SelectRects( const QList<QRect>& rects, const QList<QRect>& parenRects );

protected slots:
    void selectionChanged ( const QItemSelection & selected, const QItemSelection & deselected );

private:
    int addonId;
    QFile outputFile;
};

    void CFileWidget::SaveToFile()
{
    QTextStream textStream( &outputFile );
    textStream.setCodec( "UTF-8" );

    for( int row = 0; row < ( (QStandardItemModel*)model() )->rowCount(); ++row )
    {
        int column = 0;

        while( ( (QStandardItemModel*)model() )->item( row, column ) )
        {
            textStream<<( (QStandardItemModel*)model() )->item( row, column )->data( Qt::DisplayRole ).toString();
            textStream<<"\t";
            column++;
        }

        textStream<<"\n";
    }
} 
```

我正在尝试从文件中读取一些数据，但是当我读取它时，文件变空了。为什么会这样？如果程序中出现一些错误，它不会保存任何数据，我们会丢失吗？那么如何打开文件，从中读取并将所有数据保存在其中？据我了解，如果我以只写模式再次打开它，我将重写所有数据而不是附加？

关于代码第一个功能是打开文件第二个代码是存储QFile的类，第三个是保存到文件功能

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:48:21.047

Oki，发生的事情是您的程序完全按照您的要求运行。然后您使用 QIODevice::ReadOnly 打开文件进行读取，您获得数据并且没有任何错误发生。

然后你打开它来写你应该决定（从应用程序逻辑的角度）你想做什么。如果你想覆盖文件内容，你应该使用 WriteOnly 模式，它的工作方式与 fopen() 调用中的“w”模式完全相同，所以它会在打开文件时截断文件内容，所以一旦文件打开，内容就会丢失。

如果您打算保留内容并添加内容，请考虑使用附加模式，这样您就可以添加数据文件而不会丢失内容。

看看这个：[http ://harmattan-dev.nokia.com/docs/library/html/qt4/qiodevice.html#OpenModeFlag-enum](http://harmattan-dev.nokia.com/docs/library/html/qt4/qiodevice.html#OpenModeFlag-enum)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-23T15:42:51.427

Qt 只是一个带有自己封装库的 IDE，与普通的文件操作应该没有太大区别。你确定文件是空的还是看起来像空的？我不完全记得它叫什么，但是数据首先被缓冲，并且需要被推送到一个文件中，在这两个过程之间它看起来像空的。如果你打开一个文件而不打开“附加”，程序开始运行并退出，文件将为空。一旦您打开带有附加功能的文件，指针将指向结尾。

# mercurial - Mercurial：在拉取请求后查看拉入的内容或文件名

> ID：16172975
> 
> 赞同：1
> 
> 时间：2013-04-23T15:12:08.833
> 
> 标签：mercurial

我搜索了 mercurial 文档，但找不到与我想做的类似的事情：

执行后`hg pull`给出总结，例如：

```
adding changesets
adding manifests
adding file changes
added 5 changesets with 4 changes to 2 files 
```

我怎样才能减少更改的文件的名称？然后为每个文件更改？我也尝试了 hg log 但这并没有真正给我我正在寻找的细节。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:16:57.400

You can use a combination of

```
hg incoming 
```

(which displays the incoming changesets)

and

```
hg diff -c REVISION FILE 
```

to get the changes for a file.

To see what exactly was changed in a file you can use

```
hg annotate -r REVISION -d -u FILE 
```

which shows you exactly what was changed in a file by who.

# css - 悬停在CSS中时如何更改图像的div以更改颜色

> ID：16172977
> 
> 赞同：0
> 
> 时间：2013-04-23T15:12:12.120
> 
> 标签：css

这是我的 css 我想添加另一个 png 图片，它在悬停时具有反转颜色。我该怎么做 ？

```
div#artlog{
width:910px;
height: 58px;
margin-top: 20px;
background-image: url("../obr/artisthead.jpg"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:14:46.350

试试下面的，我想它会解决你的问题：

```
div#artlog:hover{
width:910px;
height: 58px;
margin-top: 20px;
background-image: url("../obr/inverted_color_artisthead.jpg"); 
```

不要忘记放置`inverted_color_artisthead.jpg`在与其他图像相同的文件夹中。有关更多详细信息，您可以阅读[w3.org 文档](http://www.w3.org/TR/CSS2/selector.html#dynamic-pseudo-classes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T15:13:55.647

只需添加一个悬停类

```
div#artlog:hover{
       background-image: url("../obr/artisthead-inverted.jpg");
} 
```

# cassandra - 如何更改 Helenos-GUI 的 CassandraHost？

> ID：16172980
> 
> 赞同：0
> 
> 时间：2013-04-23T15:12:14.650
> 
> 标签：cassandra, helenus

Helenos 默认尝试连接到 localhost:9160。

由于某些原因，localhost 对我不起作用。

所以我在 catalina.out 中收到此错误消息：

错误 HConnectionManager - 无法启动主机 localhost(127.0.0.1) 的连接池：9160

可以更改主机和/或端口吗？

我还没有找到任何配置选项。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T21:51:32.547

这是解决此问题的一些解决方法。您可能会在您的主目录（helenos.h2.db 文件）中找到一个 H2 数据库。连接并运行以下查询...

```
DELETE FROM CLUSTERCONFIG;
INSERT INTO CLUSTERCONFIG VALUES('default', 'yourhostname:9160', 'clustername', true); 
```

并重新启动。

# php - 本地主机 PHP require_once 出现问题

> ID：16172982
> 
> 赞同：0
> 
> 时间：2013-04-23T15:12:27.220
> 
> 标签：php, localhost, mamp

我正在使用**MAMP**在本地托管一个站点。我正确设置了虚拟主机，并且当我引用本地 URL 时 index.php 文件确实被拉起：my.example.local

问题是 PHP 文件包含不起作用。这是代码示例：

```
<?php
session_start();
$_SESSION['message'] = '';
require_once "includes/config.php";
require_once "includes/classes/facilities.class.php";
require_once "includes/classes/states.class.php";
$title = "Home";
$sub_title = $title;
$reset = false;
require_once "includes/header.php";
?> 
```

这是我在访问 index.php 时收到的错误消息：

```
Warning: require_once(includes/classes/facilities.class.php): failed to open stream: No such file or directory in /Users/userName/IOD/portal/index.php on line 9    
Fatal error: require_once(): Failed opening required 'includes/classes/facilities.class.php' (include_path='.:/Applications/MAMP/bin/php/php5.4.10/lib/php') in /Users/userName/IOD/portal/index.php on line 9 
```

作为记录，我尝试了多种不同的方式来引用文件路径、相对、绝对、使用主机名等。

我愿意尝试任何事情，但到目前为止还没有任何运气。哦，在你问之前，是的，文件在引用的位置，但由于某种原因，（本地）服务器似乎并不认为它们是。

注意：这在 Web 服务器上运行良好，我试图在本地托管它以实现版本控制，以便我可以在本地开发并将更改推送到服务器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T15:17:22.923

If you put your include/ folder into this folder;

`/Users/jfloyd/IOD/includes/<all in here>`

Then alter this line in your PHP ini from:

`include_path='.:/Applications/MAMP/bin/php/php5.4.10/lib/php'`

TO

`include_path='.:/Applications/MAMP/bin/php/php5.4.10/lib/php:/Users/jfloyd/IOD/'`

Then save the file and restart your server, then the include files should be found.

This ini directive can be set in any number of places, in each file, in each folder using .htaccess or in httpd.conf or in the ini file, as I just described.

# jquery - 使用 jQuery 删除 CSS3 背景大小

> ID：16172989
> 
> 赞同：0
> 
> 时间：2013-04-23T15:13:00.513
> 
> 标签：jquery, css

我正在使用 jQuery 设置背景图像以使用`$("#container").css("background-size", "100% 100%")`.

它工作得很好，但是单击一个按钮，我想删除该属性并将背景大小重置为其默认状态，所以我正在使用`$("#container").removeAttr("background-size");`它，但它不起作用......没有任何变化。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T15:15:14.743

尝试这个。`removeAttr`删除不属于 的元素的属性`css`。

```
 $("#container").css('background-size', '') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-23T15:25:38.753

`.removeAttr( attributeName )`只是从匹配元素集中的每个元素中删除一个属性。所以你应该重置你的CSS`.css('background-size', '')`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:19:32.260

You can make a class instead of an inline style:

```
.background-size { background-size:'100% 100%' } 
```

In then this:

```
$("#container").addClass("background-size"); 
```

And then when you want to remove it:

```
$("#container").removeClass("background-size"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-23T15:17:39.030

`removeAttr()`用于删除 HTML 属性，而不是 CSS 样式。

您可以使用与将背景大小设置为自动相同的 jQuery 脚本。

`$("#container").css("background-size", "auto")`

# javascript - 在 Javascript 控制台中控制 Chrome Web Inspector？

> ID：16172994
> 
> 赞同：1
> 
> 时间：2013-04-23T15:13:15.893
> 
> 标签：javascript, google-chrome, console, google-chrome-devtools, web-inspector

无论如何可以在 JavaScript 控制台中控制 Chrome Web Inspector 吗？

例如，假设我想在“元素”面板中选择一个元素 (#test_element)。通常我右键单击元素并选择“检查元素”。

我想在 JavaScript 控制台中执行此操作，使用类似：

```
webInspector.inspectElement("#test_element"); 
```

我希望能够以这种方式访问​​网络检查器的整个 UI。我也愿意为此使用扩展。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T15:52:31.530

用于[`inspect`](https://developers.google.com/chrome-developer-tools/docs/commandline-api#inspectobject)此目的。由于您想使用选择器，请将其与控制台的^(别名)结合使用。如果页面覆盖了，因为它使用 jQuery，使用来获取对 DOM 元素的引用（任何事情都可以，只要它是对 DOM 节点的引用）。[`$`](https://developers.google.com/chrome-developer-tools/docs/commandline-api#selector) ^(`document.querySelector`)`$``$$(selector)[0]`

![](https://i.stack.imgur.com/tpBRZ.gif)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T15:44:49.230

来自[命令行 Api 参考](https://developers.google.com/chrome-developer-tools/docs/commandline-api)

> **`inspect(object)`**
> 
> 在适当的面板中打开并选择指定的元素或对象：DOM 元素的 Elements 面板和 JavaScript 堆对象的 Profiles 面板。
> 
> 以下示例在 Elements 面板中打开 document.body 的第一个子元素：
> 
> ```
> inspect(document.body.firstChild); 
> ```

# r - 在 R 中使用 randomForest 类型不匹配错误

> ID：16172998
> 
> 赞同：0
> 
> 时间：2013-04-23T15:13:23.560
> 
> 标签：r, error-handling, random-forest, kaggle

我正在尝试在 R 中使用随机森林对一些 kaggle 数据进行分类，但是每当我尝试使用我创建的模型时，我都会收到以下错误。

```
Error in predict.randomForest(fit, newdata = test, type = "class") : 
  Type of predictors in new data do not match that of the training data 
```

我完全不知道这个错误的原因，谷歌并没有提供太多帮助。任何帮助或见解将不胜感激。下面给出了简单的代码片段，它是对 kaggle 问题之一的响应。

```
fit = randomForest(as.factor(IsBadBuy) ~ VehicleAge + WheelTypeID + Transmission + WarrantyCost + VehOdo + Auction, 
                   data=training, importance=TRUE, do.trace=100, keep.forest=TRUE)

prediction = predict(fit, newdata=test, type='class')

t = table(observed=test[, 'IsBadBuy'], predict=prediction) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-30T22:06:35.543

对于像我这样的 R 新手......当他们说“错误消息的含义与它所说的完全一样：您的训练数据中至少有一个变量的类型与您的测试数据中的等效变量不匹配”时，他们是对的。

请运行以下命令以确认没有明显不同：
`str(training)`和`str(NewData)`

这将列出训练和新数据的特征和类型。像我一样，您可能仍然感到困惑的原因是数据类型可能看起来匹配但错误。这可能是虽然两个集合中的一个特征/列被列为一个因素，但水平并不相同。我的新数据要小得多，没有训练数据的所有级别。这会让你因为这个错误而大吃一惊。解决方法是：当您处理新数据并对其进行分解时，请传入所有可能的级别。这会让你匹配，事情会奏效。

```
dataframe$ColToFactor <- factor(dataframe$ColToFactor, levels=c("PossibleLvl1", "PossibleLvl2", "PossibleLvl3", account for all possible)) 
```

那是我的交易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-31T10:21:24.280

这个错误主要是由于分类预测变量，假设一个特定类别的分类预测变量在训练模型时出现在训练集中，但在预测这个错误时没有出现在测试集中

（例如）考虑一个名为“salary level”的分类预测器，其中包含三个级别的低、中、高所有这些类在训练集中至少出现一次，但在测试集中，其中一个类说“中等”根本没有出现然后变量“salary_level”在预测函数的测试测试中被视为具有两个类别的新变量或不同变量。因此错误数据不匹配。

您可以通过使用函数 table(data_name$variable_name) 或 table(data_name[,columnposition]) 分析分类变量的类来克服这个问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:53:35.983

看看这个页面，可能会有所帮助：

[http://gettinggeneticsdone.blogspot.be/2011/02/split-data-frame-into-testing-and.html](http://gettinggeneticsdone.blogspot.be/2011/02/split-data-frame-into-testing-and.html)

它解释了如何使用优雅的函数将数据框拆分为 R 中的测试和训练集，以及如何在随机森林的情况下使用它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-14T12:46:33.180

这是一篇旧帖子，但我看到了几个月前的活动。我自己遇到了这个问题，但在网上找不到解决方案。我用粗略的解决方案解决了我的问题。

其他答案中描述了我们收到此类错误的原因。简而言之，如果训练和测试数据集中变量的因子水平数量不相等，则会出现这样的错误。尽管如果您在训练数据中具有所有级别，但在测试数据中没有所有级别，那么您会遇到这样的问题（至少我遇到了）。

如果您有一个数据集，并且想要将其拆分以进行训练和测试，最好将它们拆分，以便在训练和测试数据集中很好地表示所有级别。但是，如果您想创建一个适用于未见数据的预测器，最好找到一个解决方案。

例如，如果您在“b”列中有一个具有 3 个级别的数据框。

```
a<-c(1,2,3,1,3,2,4,5)
b<-as.factor(c(1,2,3,2,3,1,1,2))
d<-c(3,2,5,2,4,2,4,4)
dat<-cbind(a,b,d) 
```

如果您的“b”列中只有两个级别的测试数据。

```
a<-c(1,2,2,1,3)
b<-as.factor(c(1,2,1,1,2))
d<-c(3,2,5,2,4)
testData<-cbind(a,b,d) 
```

然后，您会收到错误消息。在我的肮脏解决方案中，我在测试数据中添加了三行包含因子级别，然后在添加因子级别后将其删除。

```
testData[,2]<-as.character(testData[,2]) # First changing the factor to character
addition<-testDat[1:3,] ## this will be added to testData
addition[,2]<-c(1,2,3)  ## Changing the content to get the known factor levels
testData<-rbind(addition,testData) ## add the new rows to the testData
testData[,2]<-as.factor(testData) ## And now converting back to factor

## And finally removing the added rows
testData<-testData[4:nrow(testData),] 
```

我的脚本不整洁，修复也不整洁。但是，我一步一步地这样做，以便稍后回来时可以理解。可能有人可以在几行中编写相同的代码。