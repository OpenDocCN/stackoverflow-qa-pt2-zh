# StackOverflow 问答 15304000-15304999

# php - 订单对象持有客户对象或客户 ID 或两者兼而有之？

> ID：15304001
> 
> 赞同：0
> 
> 时间：2013-03-08T21:54:52.520
> 
> 标签：php, oop

如果我有一个`Order`对象，并且每个对象`Order`都有一个对象`Customer`应该`Order`持有什么，一个`Customer`对象或客户 ID 或两者兼而有之？

它是否取决于上下文，或者因为我们正在处理 OOP 中的对象，所以`Order`理想情况下应该保存一个`Customer`对象，而不仅仅是它的 ID，如数据库列？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T21:59:25.770

不要将 db 思维与 PHP 代码设计混为一谈。通常应将属性设置为对象本身，而不是其 id。像这样：

```
class Order {

    /**
     * @var Contact
     */
    protected $contact;

    public function __construct(Contact $contact) {
        $this->contact = $contact;
    }

} 
```

但是有一些原因可能只需要知道联系人的身份。最好的例子是必须从数据库中获取联系人，但您通常不需要其信息，除非有特殊情况。然后，仅将 id 作为类属性并在需要时获取联系人可能很有用。（称为“延迟加载”）。请注意，“延迟加载”可能会被框架隐藏在幕后。

# java - 这如何解析为 Java 对象 (JSON)

> ID：15304005
> 
> 赞同：1
> 
> 时间：2013-03-08T21:55:04.050
> 
> 标签：java, android, json, parsing, gson

从服务器 API 我得到以下输出：

```
{
"1": {
"link": "http://www.hfk-bremen.de/t/meisterkurse/n/4-historic-brass-studio",
"title": "4\. Historic Brass Studio",
"content": "Vom 13\. bis 16\. März 2013 findet das 4\. Historic Brass Studio Bremen an der Hochschule für Künste Bremen statt. Angeboten an den vier Tage authentische historische Spielpraxis für Trompete, Posaune, Zink und Horn:",
"img": "http:
//www.hfk-bremen.de/sites/default/files/imagecache/event_block_thumb_300w/media/historicbrassstudio_1.jpg",
"type": "concerts"
},
"2": {
"link": "http://www.hfk-bremen.de/t/konzerte/n/orgelkonzert-3",
"title": "Orgelkonzert",
"content": "Studierende der Orgeklassen von KMD Prof. Tilmann Benfer spielen die Choralbearbeitungen von Brahms und Kluge am 14.03.2013 im St. Petri Dom Bremen.",
"img": "http://www.hfk-bremen.de/sites/default/files/imagecache/content_start/imagegeneration/Orgelkonzert.png",
"type": "concerts"
},
"3": {
"link": "http://www.hfk-bremen.de/t/konzerte/n/musik-im-museum-6",
"title": "Musik im Museum",
"content": "Konzert mit Clovis Michon (Violoncello) aus der Klasse von Prof. Alexander Baillie am 14.03.2012 um 19.30 Uhr. Auf dem Programm stehen die Solo-Suiten von J.S. Bach No. 1-3, BWV 1007-1009",
"img": "http://www.hfk-bremen.de/sites/default/files/imagecache/event_block_thumb_300w/media/musikimmuseum_8.jpg",
"type": "concerts"
},
"4": { etc... 
```

（如果您的浏览器中有 JSON 解析器插件，您可以访问此 API 链接进行实时预览：http: [//hfkio.thisisasite.de/api/aktuelles](http://hfkio.thisisasite.de/api/aktuelles)）

我正在使用 GSON 库，它需要将对象用作解析 json 的示例。但我不明白这个 json 的结构，它在我看来就像一个包含各种子对象的大对象，称为“1,2,3 ...”，每个子对象又包含 5 个字符串。我对 JSON 解析很陌生，还在学习，我不完全明白我应该如何解析它。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:03:52.413

在 JSON 中，`{ }`括号表示一个对象。JSONObject 由键值对组成，以逗号分隔。在您的情况下，初始`{`表示对象的开始。该对象由一些键值对组成，其中键是数字（您看到的“1、2、3 ...”），值是嵌套的 JSONObject。您所看到的正是您所说的，一个带有编号子对象的单个对象，因为它实际上是一个包含许多其他 JSONObjects 的 JSONObject。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:08:28.977

您可以将其解析为`Map`：

```
String json =
        "{\n" +
        "    \"1\": {\n" +
        "        \"link\": \"http://www.hfk-bremen.de/t/meisterkurse/n/4-historic-brass-studio\",\n" +
        "        \"title\": \"4\. Historic Brass Studio\",\n" +
        "        \"content\": \"Vom 13\. bis 16\. März 2013 findet das 4\. Historic Brass Studio Bremen an der Hochschule für Künste Bremen statt. Angeboten an den vier Tage authentische historische Spielpraxis für Trompete, Posaune, Zink und Horn:\",\n" +
        "        \"img\": \"http:\n" +
        "        //www.hfk-bremen.de/sites/default/files/imagecache/event_block_thumb_300w/media/historicbrassstudio_1.jpg\",\n" +
        "        \"type\": \"concerts\"\n" +
        "    },\n" +
        "    \"2\": {\n" +
        "        \"link\": \"http://www.hfk-bremen.de/t/konzerte/n/orgelkonzert-3\",\n" +
        "        \"title\": \"Orgelkonzert\",\n" +
        "        \"content\": \"Studierende der Orgeklassen von KMD Prof. Tilmann Benfer spielen die Choralbearbeitungen von Brahms und Kluge am 14.03.2013 im St. Petri Dom Bremen.\",\n" +
        "        \"img\": \"http://www.hfk-bremen.de/sites/default/files/imagecache/content_start/imagegeneration/Orgelkonzert.png\",\n" +
        "        \"type\": \"concerts\"\n" +
        "    },\n" +
        "    \"3\": {\n" +
        "        \"link\": \"http://www.hfk-bremen.de/t/konzerte/n/musik-im-museum-6\",\n" +
        "        \"title\": \"Musik im Museum\",\n" +
        "        \"content\": \"Konzert mit Clovis Michon (Violoncello) aus der Klasse von Prof. Alexander Baillie am 14.03.2012 um 19.30 Uhr. Auf dem Programm stehen die Solo-Suiten von J.S. Bach No. 1-3, BWV 1007-1009\",\n" +
        "        \"img\": \"http://www.hfk-bremen.de/sites/default/files/imagecache/event_block_thumb_300w/media/musikimmuseum_8.jpg\",\n" +
        "        \"type\": \"concerts\"\n" +
        "    }\n" +
        "}";

Gson gson = new Gson();

Map map = gson.fromJson(json, Map.class);

System.out.println(((Map)map.get("2")).get("title")); 
```

这将打印：

```
Orgelkonzert 
```

# javascript - NodeJS中的Javascript URL正则表达式问题

> ID：15304008
> 
> 赞同：0
> 
> 时间：2013-03-08T21:55:12.473
> 
> 标签：javascript, regex, node.js

所以我需要抓取一个字符串中的所有 url 并将它们返回到一个数组中。

这是我到目前为止所拥有的：

```
 var comment = 'Check out www.google.com and http://bing.com';
        var regexp = new RegExp('((ftp|http|https):\/\/)?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?', 'gi');
        var urls = comment.match(regexp); 
```

现在它没有返回任何东西，而我需要它返回两个 url。我搜索了谷歌和堆栈以及很多示例，但没有一个适合我的需要。

非常感谢所有帮助。

谢谢！

吉姆

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T21:59:42.540

您的`\`字符被解析为字符串转义，并且不会出现在正则表达式中。

相反，您应该使用正则表达式文字：

```
/((ftp|http|https):\/\/)?(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi 
```

# php - 在 php mysql 中使用来自多维数组的嵌套 foreach 循环

> ID：15304009
> 
> 赞同：0
> 
> 时间：2013-03-08T21:55:23.590
> 
> 标签：php, mysql, loops, foreach, nested

如果有人能帮我解决这个问题，那就太棒了，我真的不知道如何解决它，而且我一直在绞尽脑汁（以及书籍和互联网）一段时间，却没有真正了解我需要做什么。我无论如何都不是程序员，纯粹是自学的，所以如果看起来很容易，请接受我的道歉。我已经为一个梦幻联赛足球网站创建了一个数据库，并获得了对结果和表格的正确查询，我只想添加一个查询，显示经理每周的结果，以及从中哪些球员为这些经理得分（没有经理的球队拥有相同的球员），例如：

（表头：周 > 经理 > 支持 > 反对 > 得分手） 2 Manager1 3-0（球员 a 1，球员 b 2） 2 Manager2 1-2（球员 f 1） 2 Manager3 4-1（球员 g 2，球员 x 2)

我正在使用大量的连接来获得我的结果，并且一直在尝试使用嵌套的 foreach 循环，我认为我需要做一个单独的 foreach 循环来遍历每个得分球队的任何球员（即从球员名单中拉出目标大于 0），但结果好坏参半 - 我不需要！

这是我的代码，从索引控制器到显示 foreach 循环的 html。如果有人可以提供帮助或有任何想法，我将不胜感激。

```
 if (isset($_GET['action']) and $_GET['action'] == 'scorers')
    {
    include $_SERVER['DOCUMENT_ROOT'] . '/includes/db.inc.php';

    $sql = "SELECT Wk.week as ptsweeks, managers.managerid as ID, managers.manager as Manager, CASE when sum(Wk.goals)>GA.goals then '3' when sum(Wk.goals)=GA.goals then '1' when sum(Wk.goals)<GA.goals then '0' END as PTS, sum(Wk.goals) as F, GA.goals as A, case when Wk.goals>'0' then concat(Wk.name,' ',Wk.goals) end as goalscs 
from weeks2012 as Wk 
    inner join goalsAgainst2012 as GA 
    inner join strikers2012 as ST 
    inner join defences2012 as DEF 
    inner join managers
    on 
    Wk.week = GA.week and
    DEF.managerid = ST.managerid and
    ST.playerid = Wk.playerid and
    DEF.defenceid = GA.defenceid and
    managers.managerid = ST.managerid
    where Wk.week = '$weekWK'
    group by managers.managerid";
    $result = mysqli_query($link, $sql);
    if (!$result)
    {
    $error = 'Error updating submitted article.';
        include $_SERVER['DOCUMENT_ROOT'] . '/includes/error.html.php';
        exit();
    }

    while ($row = mysqli_fetch_array($result))
    {
    $weeks[] = array(
    'table' => array('ptsweeks' => $row['ptsweeks'], 'ID' => $row['ID'], 'Manager' => $row    ['Manager'], 'F' => $row['F'], 'A' => $row['A'], 'PTS' => $row['PTS']), 
'gs' => array('goalscs' => $row['goalscs'])
    );

    }

    include 'scorers_html.php';

}

** from scorers_html.php : 
    <table>
    <?php foreach($weeks as $key => $gls): ?>
    <tr> 
      <td> <?php echo $gls['table']['ptsweeks']; ?> </td>
      <td> <?php echo $gls['table']['Manager']; ?> </td>
      <td> <?php echo $gls['table']['F']; ?> </td>
      <td> <?php echo $gls['table']['A']; ?> </td>
      <td> <?php echo $gls['table']['PTS']; ?> </td>
   </tr>

      <?php foreach($weeks as $key => $gls): ?>
     <tr>
      <td> <?php echo $gls['gs']['goalscs']; ?> </td>
       </tr>
      <?php endforeach; ?>     
     <?php endforeach; ?>

     </table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:16:32.830

首先，您有一个语法错误，可以通过查看 Stackoverflow 的语法突出显示来查看。你的第三行需要是

```
include $_SERVER['DOCUMENT_ROOT'] . '/includes/db.inc.php'; 
```

经过进一步审查，以下行也是不正确的：

```
include $_SERVER['DOCUMENT_ROOT'] . /includes/error.html.php'; 
```

它应该是

```
include $_SERVER['DOCUMENT_ROOT'] . '/includes/error.html.php'; 
```

您需要将所有字符串封装在引号或撇号中。

我建议使用包含语法高亮的代码编辑器，例如 KomodoEdit 或 Netbeans；你会省去很多麻烦。

如果这没有帮助，请发布您遇到的具体错误/问题。

# matlab - LU分解与部分旋转Matlab

> ID：15304012
> 
> 赞同：5
> 
> 时间：2013-03-08T21:55:32.393
> 
> 标签：matlab, matrix, decomposition

我正在尝试通过部分旋转来实现我自己的 LU 分解。`[L, U, P] = lu(A)`我的代码在下面，显然工作正常，但是对于某些矩阵，与matlab中的内置函数相比，它会给出不同的结果

谁能发现哪里错了？

```
function [L, U, P] = lu_decomposition_pivot(A)
    n = size(A,1);
    Ak = A;
    L = zeros(n);
    U = zeros(n);
    P = eye(n);
    for k = 1:n-1
        for i = k+1:n
            [~,r] = max(abs(Ak(:,k)));

            Ak([k r],:) = Ak([r k],:);
            P([k r],:) = P([r k],:);

            L(i,k) = Ak(i,k) / Ak(k,k);
            for j = k+1:n
                U(k,j-1) = Ak(k,j-1);
                Ak(i,j) = Ak(i,j) - L(i,k)*Ak(k,j);
            end
        end
    end
    L(1:n+1:end) = 1;
    U(:,end) = Ak(:,end);
return 
```

这是我测试过的两个矩阵。第一个是正确的，而第二个有一些元素倒置。

```
A = [1 2 0; 2 4 8; 3 -1 2];

A = [0.8443 0.1707 0.3111;
     0.1948 0.2277 0.9234;
     0.2259 0.4357 0.4302]; 
```

**更新**

我检查了我的代码并纠正了一些错误，但部分旋转仍然缺少一些东西。在第一列中，最后两行总是反转（与matlab中 lu() 的结果相比）

```
function [L, U, P] = lu_decomposition_pivot(A)
    n = size(A,1);
    Ak = A;
    L = eye(n);
    U = zeros(n);
    P = eye(n);
    for k = 1:n-1
        [~,r] = max(abs(Ak(k:end,k)));
        r = n-(n-k+1)+r;
        Ak([k r],:) = Ak([r k],:);
        P([k r],:) = P([r k],:);
        for i = k+1:n
            L(i,k) = Ak(i,k) / Ak(k,k);
            for j = 1:n
                U(k,j) = Ak(k,j);
                Ak(i,j) = Ak(i,j) - L(i,k)*Ak(k,j);
            end
        end
    end
    U(:,end) = Ak(:,end);
return 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-06T16:41:30.427

这两个函数都不正确。这是正确的。

```
function [L, U, P] = LU_pivot(A)
    [m, n] = size(A); L=eye(n); P=eye(n); U=A;
    for k=1:m-1
        pivot=max(abs(U(k:m,k)))
        for j=k:m
            if(abs(U(j,k))==pivot)
                ind=j
                break;
            end
        end
        U([k,ind],k:m)=U([ind,k],k:m)
        L([k,ind],1:k-1)=L([ind,k],1:k-1)
        P([k,ind],:)=P([ind,k],:)
        for j=k+1:m
            L(j,k)=U(j,k)/U(k,k)
            U(j,k:m)=U(j,k:m)-L(j,k)*U(k,k:m)
        end
        pause;
    end
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T10:34:45.190

我忘记了，如果矩阵 PI 中有交换，则矩阵 L 也必须交换。所以只需在交换 P 后添加下一行，一切都会很好。

```
L([k r],:) = L([r k],:); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-04T20:55:05.157

我的答案在这里：

```
function [L, U, P] = LU_pivot(A)
[n, n1] = size(A); L=eye(n); P=eye(n); U=A;
for j = 1:n
  [pivot m] = max(abs(U(j:n, j)));     
  m = m+j-1;
  if m ~= j
    U([m,j],:) =  U([j,m], :);   % interchange rows m and j in U
    P([m,j],:) =  P([j,m], :);   % interchange rows m and j in P
    if j >= 2;    % very_important_point
      L([m,j],1:j-1) =  L([j,m], 1:j-1);   % interchange rows m and j in columns 1:j-1 of L
    end;
  end
  for i = j+1:n      
    L(i, j) = U(i, j) / U(j, j);
    U(i, :) =  U(i, :) - L(i, j)*U(j, :);
  end
end 
```

# javascript - 如何在 jquery-ui 1.9 中以编程方式更改选项卡？

> ID：15304027
> 
> 赞同：25
> 
> 时间：2013-03-08T21:57:00.510
> 
> 标签：javascript, jquery, jquery-ui, tabs

如何使用 jquery-ui 1.9 以编程方式更改选项卡？

**注意：**发布答案是因为我花了超过 4 次搜索才能在 stackoverflow 上找到正确答案。在 1.9 中似乎 API 发生了变化，在早期版本中，您将使用`$("#tabs").tabs("select", 2)`.

```
<script>
    $(document).ready(function() {
      $("#tabs").tabs();

      // assume you want to change to the 3rd tab after 3 seconds
      setTimeout(function() {
         // ???
      }, 3000);
    });
</script>

<div id="tabs">
    <ul>
        <li><a href="#tabs-1">Tab 1</a></li>
        <li><a href="#tabs-2">Tab 2</a></li>
        <li><a href="#tabs-3">Tab 3</a></li>
    </ul>

    <div id="tabs-1"><p>Container 1</p></div>
    <div id="tabs-2"><p>Container 2</p></div>
    <div id="tabs-3"><p>Container 3</p></div>
</div> 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-03-08T21:57:00.510

该`select`方法[自 1.9 起已弃用](http://jqueryui.com/upgrade-guide/1.10/#removed-select-method-use-active-option)，并[在 1.10 中删除](http://jqueryui.com/upgrade-guide/1.10/#removed-select-method-use-active-option)。请改用该`active`选项。

示例（还提供了[jsfiddle](http://jsfiddle.net/V8S5G/2/)）：

```
<script>
    $(document).ready(function() {
      $("#tabs").tabs();

      // assume you want to change to the 3rd tab after 3 seconds
      setTimeout(function() {
          $("#tabs").tabs("option", "active", 2);
      }, 3000);
    });
</script>

<div id="tabs">
    <ul>
        <li><a href="#tabs-1">Tab 1</a></li>
        <li><a href="#tabs-2">Tab 2</a></li>
        <li><a href="#tabs-3">Tab 3</a></li>
    </ul>

    <div id="tabs-1"><p>Container 1</p></div>
    <div id="tabs-2"><p>Container 2</p></div>
    <div id="tabs-3"><p>Container 3</p></div>
</div> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-11-18T21:06:43.163

[正如上面指定的Sonjz](https://stackoverflow.com/a/15304028/1334561)一样，根据 id 进行选择非常简单......但根据 tabId 进行选择更棘手..我只是想分享它以防万一有人需要

```
var index = $('#tabs a[href="#tab_id"]').parent().index();
$("#tabs").tabs("option", "active", index); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-28T08:02:03.953

试试这个

```
$('#tabs a[href="#tabs-2"]').tab('show') 
```

这里`#tabs-2`的意思是你要切换的标签。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-26T12:10:56.463

如果给标签列表元素添加 id，则可以使用 jQuery click() 方法模拟点击。

例如，当单击选项卡外的按钮时，以下内容将激活 tab2：

```
<div id="tabs">
  <ul>
    <li><a href="#tabs-1" id="th1">Tab 1</a></li>
    <li><a href="#tabs-2" id="th2">Tab 2</a></li>
    <li><a href="#tabs-3" id="th3">Tab 3</a></li>
  </ul>

  <div id="tabs-1"><p>Container 1</p></div>
  <div id="tabs-2"><p>Container 2</p></div>
  <div id="tabs-3"><p>Container 3</p></div>
</div>
<button id="btn">Click to activate Tab 2</button>
<script>
$("#tabs").tabs();
$('#btn').click(function() {$('#th2').click()});
</script> 
```

# string - 可以将字符串读入C中的共享内存吗？

> ID：15304036
> 
> 赞同：1
> 
> 时间：2013-03-08T21:57:44.997
> 
> 标签：string, memory, shared

我正在尝试读取文件并将每一行放入共享内存（是的，我知道这不是最实用的方法，但可以说我必须使用共享内存）。是否可以将这些行读入共享内存，以便我可以快速跳转到共享内存中的某一行？

例如，如果我的文件是：

```
ABCD 
EFGH 
IJKL 
```

我可以直接跳到共享内存中的第 3 行以便得到“IJKL”吗？

我目前正在像这样将它读入内存：

```
 key_t key; /* key to be passed to shmget() */ 
    int shmflg; /* shmflg to be passed to shmget() */ 
    int shmid; /* return value from shmget() */ 
    int size; /* size to be passed to shmget() */ 
    char *shm, *s;

// we'll name our shared memory segment: 1234
    key = 1234;
     if((shmid = shmget(key,size, S_IRUSR | S_IWUSR)) < 0){
        perror("shmget failed");
        exit(1);
    }

    // attach the segment to our data space
    if((shm = shmat(shmid, NULL, 0)) == (char*) -1){              
        perror("shmat failed");
        exit(1);
        }
    s = shm;

    // note: line is a character array that's large enough to include the whole file
    while(fgets(line, 128, fp) != NULL){            
    // try putting the line into our shared memory:
    sprintf(s, line);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:31:50.633

有几种方法可以做到这一点。您可以使用队列或字符串数​​组。我将向您展示如何使用字符串数组来做到这一点，因为它可能是一个更简单的概念。

首先，您需要文件的大小和文件中的行数。我会留给你弄清楚如何做到这一点。

完成排序后`file_size`，`line_count`您将分配一个大小为大小的共享内存空间，`file_size + line_count + (line_count + 1) * sizeof(char *)`以存储我们需要共享的所有信息。

声明一个变量`char **index`并将其设置为`index = (char **)shm`定义共享内存块的开头是我们的行索引所在的位置，并设置`index[line_count] = NULL`以便您稍后知道何时`index[n]`返回 NULL ，因为您已到达其末尾。

声明一个变量`char *buffer`并将其设置为`buffer = (char *)(&index[line_count+1])`所以现在我们已经`buffer`指向你的内存块中的点，就在`index`结束的地方。它是你要存储行的地方。

现在阅读这样的行：

```
int i = 0;
while(!feof(fp)) {
    index[i++] = buffer;
    fgets(buffer, file_size, fp);
    buffer += strlen(buffer) +1;
} 
```

一旦完成读取文件，您就可以将其全部组织在`index`. 第一行是`index[0]`，第二行是 ，`index[1]`依此类推。所有行都是分开的并以空值结尾。

# android - 使用图像在 Android 上使用 Listview 制作食谱应用程序

> ID：15304038
> 
> 赞同：0
> 
> 时间：2013-03-08T21:57:59.567
> 
> 标签：android, listview, imageview, recipe

[https://itunes.apple.com/us/app/party-cupcake-recipes-300+/id572480130?mt=8](https://itunes.apple.com/us/app/party-cupcake-recipes-300+/id572480130?mt=8)

我想制作一个类似于我上面提供的示例的应用程序。我在 Android 和 Java 上做这件事。我正在使用主菜单的列表视图，它有汤、主菜等。我为菜单上的每个项目构建了一个活动，并在用户点击时打开这个新活动。

例如，soup 活动中有另一个列表视图，它将包含我制作的汤列表，食谱将是我用 Photoshop 构建的图像视图，不会有文本或其他内容。

现在我的问题是我可能会有 50 到 60 个食谱，并且为每个食谱开设一个课程听起来不合逻辑。使用 OOP 逻辑，我应该有一个类，例如配方，并使用配方名称和它的图像视图生成对象。因此，如果需要，我可以生产数百个，这听起来很合乎逻辑。我正在考虑将所有图片存储在资源文件夹中。当我这样做时，我可以只提供图片链接而不将其添加到 xml 文件中。我的意思是我可以使用由配方对象组成的 Arraylist 做一个列表视图，当单击它们时，它会打开它拥有的图像。没有所有这些的 xml 文件，或者根本不可能？所有的帮助将不胜感激......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:34:36.510

我不知道“所有这些文件的 xml 文件”是什么意思，但您可以通过 BitmapFactory.decodeResource(getResources(), R.drawable.pictureId) 获取图片并在 ImageView 中显示该位图。

```
public class MySimpleArrayAdapter extends ArrayAdapter<MyImage> {
  private final Context context;
  private final ArrayList<MyImage> values;

  public MySimpleArrayAdapter(Context context, ArrayList<MyImage> values) {
    super(context, R.layout.rowlayout, values);
    this.context = context;
    this.values = values;
  }

  @Override
  public View getView(int position, View convertView, ViewGroup parent) {
    LayoutInflater inflater = (LayoutInflater) context
        .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    View rowView = inflater.inflate(R.layout.rowlayout, parent, false);
    TextView textView = (TextView) rowView.findViewById(R.id.label);
    ImageView imageView = (ImageView) rowView.findViewById(R.id.icon);
    textView.setText(values.get(i).getDesc());
    imageView.setImageResource(values.get(position).getImageId());

    return rowView;
  }
} 

public class MyImage{
   String desc;
   int imageId;
}

<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <ImageView
        android:id="@+id/icon"
        android:layout_width="22px"
        android:layout_height="22px"
        android:layout_marginLeft="4px"
        android:layout_marginRight="10px"
        android:layout_marginTop="4px" >
    </ImageView>

    <TextView
        android:id="@+id/label"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textSize="20px" >
    </TextView>

</LinearLayout> 
```

# javascript - 使用带有锚标签的窗帘.js 进行站点导航

> ID：15304041
> 
> 赞同：0
> 
> 时间：2013-03-08T21:58:19.820
> 
> 标签：javascript, jquery, html, css

我目前正在制作一个网站，可以在 www.TheOneCraft.co.uk 上看到。

它使用窗帘.js jquery 插件在用户向下滚动时为幻灯片/页面设置动画，但我一直在尝试“并且失败”来使导航栏做到这一点。

我想知道是否有人知道一种方法可以使单击链接向下滚动页面到正确的点。

任何和所有的帮助表示赞赏，

提前致谢

乔治

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T09:18:34.927

[在项目](https://github.com/Victa/curtain.js/#features)的 github 页面上有对此的描述

# row - 未定义的偏移量：$row[] php 中的错误

> ID：15304045
> 
> 赞同：0
> 
> 时间：2013-03-08T21:58:34.427
> 
> 标签：row, undefined, offset, php

当我执行以下 transportreg_edit_n.php 时，出现“未定义偏移量：1”、“未定义偏移量：2”...等错误

错误指向的地方突出显示...

“我之前得到未定义的变量行”错误然后我将其初始化为 $row="" ；然后我得到了这个..我应该怎么做才能摆脱这个？

我不确定我是否正确使用了 isset(.....) 属性，因为我还没有对这一点进行错误检查:) 如果是这样，请忍受我的新手错误:) tnx 提前很多.

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Edit Page</title>

<style type="text/css">
body,td,th {
    font-family: Arial, Helvetica, sans-serif;
    font-size: 16px;
    text-align: left;
}
body {
        background: url(Image/bg.jpg) no-repeat center center fixed; 
        -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;
}

</style>
<link href="CSS/transportreg_editStyleSheet.css" rel="stylesheet" type="text/css" />
</head>

<?php

        $dbhost="localhost";
        $dbuser="root";
        $dbpass="rootout";
        $dbdb="test";

        $connect = mysql_connect($dbhost,$dbuser,$dbpass);
        if (!$connect)
        {
            echo "Failed To Connect To MySql".mysql_error();
            echo "<br /><br /><a href='transportreg.php'>Go Back </a>";
        }

        $db = mysql_select_db($dbdb,$connect);
        if (!$db)
        {
            echo "Failed To Connect To The Database".mysql_error();
            echo "<br /><br /><a href='transportreg.php'>Go Back </a>";
        }

        $row = ""; //added this because of undefined variable row error

        if(isset($_GET['edit']))
        {
            $id = $_GET['edit'];
            $sql = "SELECT * FROM transportpublic WHERE transportpublicid='$id' ";
            $res = mysql_query($sql)or die($sql."<br/><br/>".mysql_error());
            $row = mysql_fetch_array($res,MYSQL_BOTH);
        }

        if(isset($_POST['edittxttravelType_public'],$_POST['edittxtCostPerKm_public'],$_POST['edittxtAddress_public'],$_POST['edittxtPhoneNumber1_public'],$_POST['edittxtweblink_public'],$_POST['edittxtDescription_public']))
        {
            $id = $_POST['edittxtid_public'];
            $new_txttravelType_public = $_POST['edittxttravelType_public'];
            $new_txtCostPerKm_public = $_POST['edittxtCostPerKm_public'];
            $new_txtAddress_public = $_POST['edittxtAddress_public'];
            $new_txtPhoneNumber1_public = $_POST['edittxtPhoneNumber1_public'];
            $new_txtweblink_public = $_POST['edittxtweblink_public'];
            $new_txtDescription_public = $_POST['edittxtDescription_public'];

            $sql = "UPDATE transportpublic SET transportType='$new_txttravelType_public'  AND costPerKm='$new_txtCostPerKm_public'  AND address='$new_txtAddress_public'  AND teleNo='$new_txtPhoneNumber1_public'  AND webLink='$new_txtweblink_public'  AND description='$new_txtDescription_public'  WHERE transportpublicid ='$id' ";

            $res = mysql_query($sql) or die("Error Occured Update Unseccessful! ".mysql_error());

            echo "<br /><a href='transportreg_showdata.php'>View Current Data</a>";

        }

?>

<body>
<form id="form1" name="form1" method="post" action="transportreg_edit_n.php">
  <table width="597" border="0" align="center" cellpadding="0">
    <tr>
      <th colspan="2" bgcolor="#000000" class="mainTitle" scope="row">Edit Form</th>
    </tr>
    <tr bgcolor="#c1e9ea">
      <td width="324" scope="row"><blockquote>
        <p><span class="classlabels">Transportation Type/Name :</span></p>
      </blockquote></td>
      <td width="270">
      <label for="edittxttravelType_public"></label>

      //here $row[1] causes the error "Undefined offset: 1"

     <input name="edittxttravelType_public" type="text" value="<?php echo $row[1]; ?>" id="edittxttravelType_public2" size="45" maxlength="60" />

      //here $row[0] causes an error "Undefined offset: 0"

     <input name="edittxtid_public" type="hidden" value="<?php echo **$row[0]**; ?>" id="edittxttravelType_public" size="45" maxlength="60" />
     </td>
    </tr>
    <tr bgcolor="#dbf4f6">
      <td scope="row"><blockquote>
        <p>Cost per kilometer :</p>
      </blockquote></td>
      <td>
      <label for="edittxtCostPerKm_public"></label>

       //here $row[2] causes an error "Undefined offset: 2"

      <input name="edittxtCostPerKm_public" value="<?php echo $row[2]; ?>" type="text" id="edittxtCostPerKm_public" size="45" maxlength="60" /></td>
    </tr>
    <tr>
      <td bgcolor="#c1e9ea" scope="row"><blockquote>Address :</blockquote></td>
      <td bgcolor="#c1e9ea">
      <label for="edittxtAddress_public"></label>

     //here $row[3] causes an error "Undefined offset: 3"

    <textarea name="edittxtAddress_public" id="edittxtAddress_public" cols="32" rows="3"><?php echo $row[3]; ?> </textarea></td>
    </tr>
    <tr bgcolor="#dbf4f6">
      <td bgcolor="#dbf4f6" scope="row"><blockquote>Telephone Number :</blockquote></td>
      <td>
      <label for="edittxtPhoneNumber1_public"></label>

    //here $row[4] causes an error "Undefined offset: 4"

    <input name="edittxtPhoneNumber1_public" type="text"  value="<?php echo $row[4]; ?>" id="edittxtPhoneNumber1_public" size="45" maxlength="15" /></td>
    </tr>
    <tr bgcolor="#c1e9ea">
      <td bgcolor="#c1e9ea" scope="row"><blockquote>Official WebSite Link :</blockquote></td>
      <td>
      <label for="edittxtweblink_public"></label>

   //here $row[5] causes an error "Undefined offset: 5"

    <input name="edittxtweblink_public" type="text" value="<?php echo $row[5]; ?>" id="edittxtweblink_public" size="45" maxlength="300" />

     </td>
    </tr>
    <tr bgcolor="#dbf4f6">
      <td scope="row"><blockquote>Brief  Description :</blockquote></td>
      <td><label for="edittxtDescription_public"></label>

    //here $row[6] causes an error "Undefined offset: 6"

    <textarea name="edittxtDescription_public" id="edittxtDescription_public" cols="32" rows="10"><?php echo $row[6]; ?></textarea></td>
    </tr>
    <tr bgcolor="#dbf4f6">
      <td colspan="2" bgcolor="#c1e9ea" scope="row"><blockquote>
        <blockquote>
          <blockquote>
            <blockquote>
              <blockquote>
                <blockquote>
                  <p>
                    <input name="btnupdatet_public" type="submit" class="submit" id="btnupdatet_public" value="Update" />
                  </p>
                </blockquote>
              </blockquote>
            </blockquote>
          </blockquote>
        </blockquote>
      </blockquote></td>
    </tr>
    <tr bgcolor="#dbf4f6">
      <td colspan="2" bgcolor="#c1e9ea" scope="row"><table width="601" border='0' bordercolor='#000000' class="tb">
                  <tr> 
                      <td width="340" height="20"><a href='transportreg_showdata.php'>View Updated Public Transportation Data</a>
                      </td>
                      <td width="272"><a href='transportreg.php'>Go Back To Registration Page</a>
                      </td>
      </table></td>
    </tr>
  </table>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
</form>
<?php
        mysql_close($connect);
?>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:03:22.990

如果`$_GET['edit']`未设置，`$row`则不是数组而是空字符串，这会导致该错误。

为了解决这个问题，在任何你想使用它的地方，你都需要一个像这样的结构：

```
if (isset($row[1]))
{
  echo $row[1];
}
// etc. 
```

Or you define `$row` as an array with lots of empty strings for all your table fields instead of an empty string...

# html - 为输入编码 HTML

> ID：15304046
> 
> 赞同：1
> 
> 时间：2013-03-08T21:58:36.627
> 
> 标签：html, forms, razor, webmatrix

我创建了一个表格供客户从网站请求信息。然后表单使用 Webmail.Send 向我发送一封电子邮件。如果用户尝试输入部分或全部 html 开始标记，即“<h1”或“<h1>”，站点将抛出错误。我使用 WebMatrix 开发了该站点，并尝试使用 Html.Encode() 解决此问题。如果我在 Html.Encode("<h1>") 中硬编码，一切都很好，电子邮件已发送并且 html 标记在电子邮件中看起来很棒。如果我尝试使用变量 Html.Encode(firstName)，如果用户输入部分或全部 html 开始标记，则站点会崩溃。如果用户输入的内容看起来不像 html，那么一切都很好，即“Steve”。以下是我遇到问题的代码。

```
 var customerEmail = Request["customerEmail"];
    var firstName = Request["firstName"];
    var lastName = Request["lastName"];
    var phoneNumber = Request["phoneNumber"];
    var customerRequest = Request["customerRequest"];
    var rAddress = Request["rAddress"];
    var rCity = Request["rCity"];
    var rState = Request["rState"];
    var rZip = Request["rZip"];

    try
        {
            WebMail.Send(to:"request@yourdomain.com", subject: "Request from " + customerEmail, body: 
            "Request:<br>_____________________________________<br><br>" +
            customerRequest + "<br><br>Contact Info:<br>_____________________________________<br><br>" + Html.Encode(firstName)  + " " + lastName + "<br>" + rAddress + 
            "<br>" + rCity + " " + rState + " " + rZip + "<br>" + phoneNumber + "<br>" + customerEmail, replyTo: customerEmail);
        }
    catch (Exception ex )
        {
            <text>@ex</text>
        } 
```

我知道所有输入都可能出现问题，但是一旦我弄清楚第一个输入，这将很容易解决。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T07:54:27.667

如果您允许用户将 HTML 作为其表单提交的一部分发布，您必须使用`Request.Unvalidated()`来引用表单字段值以防止 ASP.NET 请求验证启动（这会导致您报告的错误消息）：

```
var firstName = Request.Unvalidated("firstName");
var lastName = Request.Unvalidated("lastName"); 
```

# php - 通过文本框值设置单选按钮为真？

> ID：15304047
> 
> 赞同：1
> 
> 时间：2013-03-08T21:58:37.213
> 
> 标签：php, javascript

当我更改文本框中的值时，我需要检查单选按钮

```
radio button value 100.00rs                     input hidden array 10 clients     
radio button value 200.00 - 250.00rs            input hidden array 30 clients    
radio button value 250.00 - 300.00rs            input hidden array 50 clients    
radio button value 300.00 - 350.00rs            input hidden array 75 clients    
radio button value 350.00 - 400.00rs            input hidden array 100 clients 
```

当我使用 javascript onchange 函数更改文本框的值时，这些值由 mysql-php foreach 循环获取，应根据该值选择单选按钮。例如，如果我在文本框中输入 10，则应选择第一个单选按钮，否则，如果我输入 200-250 之间的值，则应选择第二个单选按钮

```
function onChangeTest() {
var radio = document.getElementsByName("amt[1]") 
var qty2 = document.getElementsByName("max[]") 
var input = document.getElementById('ts').value;
    for(var i=0;i<radio.length;i++){
        if(input < qty2[i].value ){  // if input is < or between radio button value
        //document.getElementByName('amt[2]').checked = true;
        alert(radio[i].value + '\n' + qty2[i].value + '\n' +  input + '\n' + i) ; 
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T01:24:28.027

如果我正确理解您的问题，那么您是在询问如何通过文本字段检查单选按钮。

基本上：

```
pseudocode
if text value == "true", then
    set radio button to true 
```

这可以通过以下方式完成

```
HTML
<input type="text" id="txt">
<input type="radio" id="rad">

JAVASCRIPT
txt.onkeyup = function(){
    if(txt.value == 'true'){
        rad.checked = true;
    }else{
        rad.checked = false;
    }
} 
```

[查看示例](http://jsfiddle.net/B1KMusic/G32NC/)

# java - 尝试添加设置菜单，但应用程序不断崩溃

> ID：15304050
> 
> 赞同：2
> 
> 时间：2013-03-08T21:58:54.320
> 
> 标签：java, android, eclipse, adt

我正在尝试添加设置菜单（根据教程），但应用程序不断崩溃，我不知道为什么。我相信我正确地遵循了说明，但它一直失败，所以我很确定我忽略或不理解一些简单的东西。

```
package com.example.linkingmanager;

import android.app.Activity;
import android.os.Bundle;
import android.widget.Button;
import android.content.Intent;
import android.view.View; 
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.Toast;
import android.view.View.OnClickListener;

public class App2Activity extends Activity {

Button button;

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.main2);
}

 public void imageClick(View view) {  
  //Implement image click function
     Intent intent = new Intent(App2Activity.this, AppActivity.class);
     App2Activity.this.startActivity(intent);
 }  
 @Override
    public boolean onCreateOptionsMenu(Menu menu)
    {
        MenuInflater menuInflater = getMenuInflater();
        menuInflater.inflate(R.layout.menu, menu);
        return true;
    }

    /**
     * Event Handling for Individual menu item selected
     * Identify single menu item by it's id
     * */
    @Override
    public boolean onOptionsItemSelected(MenuItem item)
    {

        switch (item.getItemId())
        {
        case R.id.menu_bookmark:
            // Single menu item is selected do something
            // Ex: launching new activity/screen or show alert message
            Toast.makeText(AndroidMenusActivity.this, "Bookmark is Selected", Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menu_save:
            Toast.makeText(AndroidMenusActivity.this, "Save is Selected", Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menu_search:
            Toast.makeText(AndroidMenusActivity.this, "Search is Selected", Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menu_share:
            Toast.makeText(AndroidMenusActivity.this, "Share is Selected", Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menu_delete:
            Toast.makeText(AndroidMenusActivity.this, "Delete is Selected", Toast.LENGTH_SHORT).show();
            return true;

        case R.id.menu_preferences:
            Toast.makeText(AndroidMenusActivity.this, "Preferences is Selected",     Toast.LENGTH_SHORT).show();
            return true;

        default:
            return super.onOptionsItemSelected(item);
        }
    }    

}

}
; 
```

* * *

## LOGCAT

```
03-08 21:54:51.327: E/Trace(1962): error opening trace file: No such file or directory (2)
03-08 21:54:52.015: D/dalvikvm(1962): GC_FOR_ALLOC freed 40K, 7% free 2456K/2640K, paused 52ms, total 56ms
03-08 21:54:52.075: I/dalvikvm-heap(1962): Grow heap (frag case) to 5.831MB for 3456016-byte allocation
03-08 21:54:52.195: D/dalvikvm(1962): GC_FOR_ALLOC freed 2K, 4% free 5828K/6016K, paused 118ms, total 119ms
03-08 21:54:52.285: D/dalvikvm(1962): GC_CONCURRENT freed <1K, 4% free 5828K/6016K, paused 10ms+5ms, total 90ms
03-08 21:54:52.955: D/libEGL(1962): loaded /system/lib/egl/libEGL_emulation.so
03-08 21:54:53.102: D/(1962): HostConnection::get() New Host Connection established 0x2a1546b0, tid 1962
03-08 21:54:53.177: D/libEGL(1962): loaded /system/lib/egl/libGLESv1_CM_emulation.so
03-08 21:54:53.185: D/libEGL(1962): loaded /system/lib/egl/libGLESv2_emulation.so
03-08 21:54:53.255: W/EGL_emulation(1962): eglSurfaceAttrib not implemented
03-08 21:54:53.275: D/OpenGLRenderer(1962): Enabling debug mode 0
03-08 21:54:56.455: W/EGL_emulation(1962): eglSurfaceAttrib not implemented
03-08 21:54:56.525: D/AndroidRuntime(1962): Shutting down VM
03-08 21:54:56.525: W/dalvikvm(1962): threadid=1: thread exiting with uncaught exception (group=0x40a71930)
03-08 21:54:56.595: E/AndroidRuntime(1962): FATAL EXCEPTION: main
03-08 21:54:56.595: E/AndroidRuntime(1962): java.lang.Error: Unresolved compilation problem: 
03-08 21:54:56.595: E/AndroidRuntime(1962):     menu cannot be resolved or is not a field
03-08 21:54:56.595: E/AndroidRuntime(1962):     at com.example.linkingmanager.App2Activity.onCreateOptionsMenu(App2Activity.java:33)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at android.app.Activity.onCreatePanelMenu(Activity.java:2490)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at com.android.internal.policy.impl.PhoneWindow.preparePanel(PhoneWindow.java:407)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at com.android.internal.policy.impl.PhoneWindow.doInvalidatePanelMenu(PhoneWindow.java:769)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at com.android.internal.policy.impl.PhoneWindow$1.run(PhoneWindow.java:201)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at android.view.Choreographer$CallbackRecord.run(Choreographer.java:749)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at android.view.Choreographer.doCallbacks(Choreographer.java:562)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at android.view.Choreographer.doFrame(Choreographer.java:531)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:735)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at android.os.Handler.handleCallback(Handler.java:725)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at android.os.Handler.dispatchMessage(Handler.java:92)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at android.os.Looper.loop(Looper.java:137)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at android.app.ActivityThread.main(ActivityThread.java:5041)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at java.lang.reflect.Method.invokeNative(Native Method)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at java.lang.reflect.Method.invoke(Method.java:511)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-08 21:54:56.595: E/AndroidRuntime(1962):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:06:47.927

您正在尝试在此处膨胀布局而不是菜单：`menuInflater.inflate(R.layout.menu, menu);`

您必须提供描述菜单元素的[Menu XML 资源](https://developer.android.com/guide/topics/resources/menu-resource.html)

# c# - 获取索引查询的节点关系返回零结果（Cypher）

> ID：15304051
> 
> 赞同：0
> 
> 时间：2013-03-08T21:58:54.723
> 
> 标签：c#, neo4jclient

使用最新的[Neo4jClient](http://hg.readify.net/neo4jclient)访问 Neo4j 数据库我无法成功运行以下 Cypher 查询：

```
 var connections = _graphClient.Cypher
                                .StartWithNodeIndexLookup("n", "indexName", "'id:*'")
                                .Match("c=(n)-[:RELATIONSHIP_TYPE]-()")
                                .Return<MyRelationship>("c")
                                .Skip(5)
                                .Limit(10)
                                .Results; 
```

这将返回零结果。但是它会生成以下查询：

```
START n=node:indexName('id:*') MATCH c=(n)-[:RELATIONSHIP_TYPE]-() RETURN c SKIP 5 LIMIT 10 
```

当我直接通过 Neo4j 的管理板运行它时，我得到了正确的结果集。

我错过了什么？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T11:47:52.050

我认为这是因为您的索引中有单引号

```
var connections = _graphClient.Cypher
     .StartWithNodeIndexLookup("n", "indexName", "id:*") //<-- remove the single quotes
     .Match("c=(n)-[:RELATIONSHIP_TYPE]-()")
     .Return<MyRelationship>("c")
     .Skip(5)
     .Limit(10)
     .Results; 
```

如果您再次遇到此类问题，最简单的方法是`StartWithNodeIndexLookup`使用 just 切换调用`Start`并使用已知节点引用来检查可能发生错误的位置。

# spring - java.lang.VerifyError: org/springframework/beans/factory/xml/XmlBeanDefinitionReader.setEntityResolver(Lorg/xml/sax/EntityResolver;)V

> ID：15304052
> 
> 赞同：0
> 
> 时间：2013-03-08T21:58:59.460
> 
> 标签：spring, spring-security, spring-saml

我正在尝试将 spring saml 扩展与我们的 JSF 2.0 Web 应用程序集成。我收到这个奇怪的错误。

我能够部署位于 [https://github.com/SpringSource/spring-security-saml](https://github.com/SpringSource/spring-security-saml)的示例应用程序，它是 Spring mvc 应用程序“java.lang.VerifyError”

现在我正在尝试将更改插入到我的 JSF 应用程序中，我只能在应用程序启动期间看到。

```
 java.lang.VerifyError: org/springframework/beans/factory/xml/XmlBeanDefinitionReader.setEntityResolver(Lorg/xml/sax/EntityResolver;)V
at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:88)
at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:130)
at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:467)
at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:397)
at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:282)
at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:204)
at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:47)
at com.ibm.ws.webcontainer.webapp.WebApp.notifyServletContextCreated(WebApp.java:1667) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:09:57.533

`java.lang.VerifyError`当您针对与运行时使用的库不同的库进行编译时，可能会出现结果。

通常编译器会标记方法签名不匹配的问题。JVM 将在加载类时再次验证字节码，并`VerifyError`在字节码尝试执行不应允许的操作时抛出异常——例如调用返回的方法，`String`然后将该返回值存储在包含`List`.

# python - 为什么使用 pandas.read_csv 后列名错误

> ID：15304063
> 
> 赞同：2
> 
> 时间：2013-03-08T21:59:57.157
> 
> 标签：python, pandas

基于本教程[http://www.youtube.com/watch?v=aKs1Vgtb1do](http://www.youtube.com/watch?v=aKs1Vgtb1do)：

```
import pandas as pd
names1880 = pd.read_csv('yob1880.txt', names={'name', 'sex', 'births'})
names1880.head(10)

Out[34]:

      births name   sex
0       Mary    F  7065
1       Anna    F  2604
2       Emma    F  2003
3  Elizabeth    F  1939
4     Minnie    F  1746
5   Margaret    F  1578
6        Ida    F  1472
7      Alice    F  1414
8     Bertha    F  1320
9      Sarah    F  1288

ubuntu@ubuntu-VirtualBox:~/P4DA$ head yob1880.txt 
Mary,F,7065
Anna,F,2604
Emma,F,2003
Elizabeth,F,1939
Minnie,F,1746
Margaret,F,1578
Ida,F,1472
Alice,F,1414
Bertha,F,1320
Sarah,F,1288 
```

Question> 为什么列名顺序`names1880.head(10)`不正确？

代码打印：

```
Out[34]:

      births name   sex 
```

我预计：

```
Out[34]:

      name sex births 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-08T22:05:11.513

在这一行：

```
names1880 = pd.read_csv('yob1880.txt', names={'name', 'sex', 'births'}) 
```

`{'a','b','c'}`语法使 a`set`和集合是无序的。

```
>>> {'name', 'sex', 'births'}
set(['births', 'name', 'sex']) 
```

使用 a`list`或 a`tuple`代替：

```
>>> ['name', 'sex', 'births']
['name', 'sex', 'births']
>>> ('name', 'sex', 'births')
('name', 'sex', 'births') 
```

# ruby-on-rails - Rails：如何为 redirect_to 设置 json 格式

> ID：15304073
> 
> 赞同：11
> 
> 时间：2013-03-08T22:00:38.683
> 
> 标签：ruby-on-rails, ruby, json, redirect, routing

我如何不重定向到 html 格式，而是重定向到 json？

我想要这样的东西：

```
redirect_to user_path(@user), format: :json 
```

但这不起作用，我仍然重定向到 html 路径。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-08T22:10:37.560

我又读了一些 apidock ......这很简单。我应该像这样在路径助手中指定格式：

```
redirect_to user_path(@user, format: :json) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-01-11T23:47:19.737

在 Rails 5.2 API 应用程序中，接受的答案（`format: :json`在`redirect_to`选项中指定）对我不起作用；带有`Accept: application/json`标头的请求。

使用`redirect_to "/foo", format: :json`导致这样的响应（为简洁而编辑）：

```
HTTP/1.1 302 Found
Content-Type: text/html; charset=utf-8
Location: /foo

<html><body>You are being <a href="/foo">redirected</a>.</body></html> 
```

这不适用于 API，所以`redirect_to`我完全没有使用，而是改用[head](http://api.rubyonrails.org/classes/ActionController/Head.html#method-i-head)：

```
head :found, location: "/foo" 
```

这会导致以下响应（再次为简洁起见进行了编辑）而没有正文，这正是我所寻找的：

```
HTTP/1.1 302 Found
Content-Type: application/json
Location: /foo 
```

在我的情况下，我没有重定向到我的 Rails 应用程序中的页面，所以我没有使用 URL 帮助程序，但如果你这样做（例如`user_path`或`redirect_to @user`），你可以像这样为你的 URL 帮助程序提供相关选项：

```
head :found, location: user_path(user, format: :json)
# or
head :found, location: url_for(@user, format: :json) 
```

# python - 在python中使用管道数据

> ID：15304076
> 
> 赞同：0
> 
> 时间：2013-03-08T22:01:01.990
> 
> 标签：python, stdin, piping

我正在开发一个与 bash 的“wc”（字数统计）命令完全相同的 python 3 项目。输入格式如下所示：

```
$ python3 myWC.py < fileName.txt 
```

我想使用给定的文件来计算文件中的字节、单词和行并打印它们。我尝试过使用标准输入，但即使是简单的 print() 语句似乎也在打印标准输入的对象，而不是给出的实际字符串。有人可以给我一些关于 Python 3 中基本标准输入可用性的指导吗？谢谢！

正如下面所指出的，我使用的是“>”而不是“<”。但是现在当我运行这段代码时：

```
import sys

def main():
        word = sys.stdin.readline()
        print(word)

main() 
```

我只是在终端中得到一个空行作为输出

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:08:33.057

扩展我上面的评论，我想说下面的代码可以解决问题（注意：这不是 Python 3，而是 Python 2.7。一些快速的谷歌搜索告诉我它们在这方面是相似的）。

在 echo.py 中：

```
import sys
print sys.stdin.read() 
```

然后在你的终端中这样调用它：

```
python echo.py < test.txt 
```

这应该会在您的终端上回显 test.txt 的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:19:17.943

与重定向不同的方法：使用`fileinput`：

```
# myWC.py
def main():
    for line in fileinput.input():
        # Do something with the line

main() 
```

如何调用：

```
python myWC.py filename.txt # One file
python myWC.py file1.txt file2.txt file3.txt # multiple files 
```

### 讨论

*   `fileinput`处理打开文件的所有细节，为您逐行阅读
*   您可以从命令行指定多个输入文件
*   有关更多信息，请参阅[文档](http://docs.python.org/3.3/library/fileinput.html)，尤其是关于`fileinput.filename()`, `fileinput.lineno()`, ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T22:06:36.193

[How do you read from stdin in Python?](https://stackoverflow.com/questions/1450393/how-do-you-read-from-stdin-in-python)中介绍了如何处理 python 中的输入。

您输入的第一行可能是空白的，而您只阅读了一行，请尝试：

```
import sys
for line in sys.stdio:
    print line 
```

我还应该提到 *nix 风格的实用程序模块 fileinput 值得一看。

# javascript - 将多个 gridview 行突出显示为一个

> ID：15304079
> 
> 赞同：-1
> 
> 时间：2013-03-08T22:01:13.067
> 
> 标签：javascript, jquery, asp.net, gridview, highlight

一个gridview显示如下：

```
 FAMILY       GROUP              COLOR
===============================================
      |        |   Poodle           |  Blue
ROW1  | DOG    |   German Shepherd  |  Red
      |        |   Pitbull          |  Orange
===============================================
      |        |   Evil             |  green
ROW2  | CAT    |   tabby            |  purple 
```

在鼠标悬停时，我希望每一行都突出显示。请记住，“组”和“颜色”列中的每个列表都是单独的行。这意味着“贵宾犬”和“蓝色”是一行，下一行是“德国牧羊犬”和“红色”，依此类推。

我想让所有这些行都像单行一样做出反应。基本上每一行都将基于“家庭”列。在鼠标悬停时，我想突出显示 row1（狗），并且与 DOG 关联的“组”和“颜色”列中的所有行也被突出显示。

到目前为止，我已经让每一行在鼠标悬停时突出显示，作为单行，但我无法弄清楚如何使相似的行在鼠标悬停时充当单个实体。

渲染的 HTML：

```
<table class="gridview" cellspacing="0" rules="all" border="1" id="MainContent_gvAnimalInfo" style="width:90%;border-collapse:collapse;">
    <tr>
       <th scope="col">
                  <a>FAMILY</a>
               </th>
               <th scope="col">GROUP</th>
               <th scope="col">COLOR</th>
    </tr>
            <tr>
        <td rowspan="3">DOG</td>
                <td>Poodle</td>
                <td>Blue</td>
    </tr>
            <tr>
         <td>German Shepherd</td>
                <td>Red</td>
    </tr>
            <tr>
         <td>Pitbull</td>
                <td>Orange</td>
    </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:41:26.723

给你所有的表格行一个狗类。为包含 DOG 标签的 TD 指定 ID“dogLabel”。这应该照顾它：

```
 $(document).ready(function () {
        $(".dog").hover(
            function () {
                $(this).css("background", "yellow");
                $("#dogLabel").css("background", "yellow");
        },
            function () {
                $(this).css("background", "");
                $("#dogLabel").css("background", "");
            }
        );
}); 
```

还有一个小提琴：http: [//jsfiddle.net/qDYAP/1/](http://jsfiddle.net/qDYAP/1/)

# c# - ServiceStack 拦截请求/响应以进行验证

> ID：15304082
> 
> 赞同：1
> 
> 时间：2013-03-08T22:01:44.653
> 
> 标签：c#, servicestack

我试图拦截 ServiceRunner 中的请求和响应以对它们运行验证。

1\. 如果 (!result.IsValid) 或者这是否是正确的方法，我不确定如何中止请求。

2\. 尤其是响应，对象响应在动态运行之前是未知的，这让我很难为它创建 IValidator，它需要在编译时知道类型。

请看代码中的注释：

```
public class CustomServiceRunner<T> : ServiceRunner<T> {

    public CustomServiceRunner(IAppHost appHost, ActionContext actionContext) 
        : base(appHost, actionContext) { }

    public override void BeforeEachRequest(IRequestContext requestContext, T request) {
        var validator = AppHost.TryResolve<IValidator<T>>();
        var result = validator.Validate(request);
        //----------------------
        //if (!result.IsValid) 
        //  How to return result.ToResponseDto() and abort the request?
        //----------------------
        base.BeforeEachRequest(requestContext, request);
    }
    public override object AfterEachRequest(IRequestContext requestContext, T request, object response) {
        //-----------------------
        //Validating against response presents a more challenging issue
        //I may have multiple response classes and returned response is 
        //a type object, response class is to be decided dynamically at
        //runtime. I am not sure how to fit this to IValidator<T>
        //-----------------------
        return base.AfterEachRequest(requestContext, request, response);
    }
} 
```

在交互方法中进行验证将使我的服务类代码更干净。我也考虑过请求/响应过滤器，但是我需要到处写过滤器标签。ServiceRunner 更好，因为它使整个验证过程（或一般的 AOP）对服务的其余部分透明。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T15:48:11.147

我没有理解为什么使用 RequestFilter 是不够的。如[https://github.com/ServiceStack/ServiceStack/wiki/Validation](https://github.com/ServiceStack/ServiceStack/wiki/Validation)中所述，在 AppHost.Configure() 中执行此操作：

```
// Enable the validation feature
Plugins.Add(new ValidationFeature());

// This method scans the assembly for validators
container.RegisterValidators(Assemblies); 
```

这将为验证设置一个 RequestFilter 并将注册在指定程序集中定义的所有验证器。如果发现任何验证错误，RequestFilter 将导致抛出异常而不是调用您的服务。

与 ServiceStack 可以为您做的相比，您所做的所有布线在我看来都是多余的（而且很脆弱）。

现在，也就是说，如果我遵循请求后验证，我不会这样做。我猜你试图保证服务不能返回无效结果，而不是保证如果请求无效则不能执行。对我来说，这似乎是一个极端案例，您不信任您的数据存储库，您希望完全失败，甚至无法看到坏数据（这可能使消费者难以修复）。

我还没有使用响应过滤器，所以我不确定它们有什么限制。但是看看[https://github.com/ServiceStack/ServiceStack/wiki/Request-and-response-filters](https://github.com/ServiceStack/ServiceStack/wiki/Request-and-response-filters)，它似乎表明你可以做同样的事情......所以听起来你可以写一个不同的响应做响应流然后关闭它。我认为这意味着响应过滤器在服务之后执行，但在响应流的序列化发生之前。因此，您应该能够写出不同的响应，并且服务的响应将被忽略。[我在如何从 ServiceStack RequestFilter 中查找服务中](https://stackoverflow.com/questions/15317540/how-to-find-service-from-servicestack-requestfilter/15319620#15319620)发布的代码片段可能会有所帮助。

如果你有一个错误要从验证中返回，那么就像你正在做的那样，你可以抛出一个异常，或者直接编写一个错误响应。不过看一下 ServiceStack 提供的代码：下载项目并借用/修改 ValidationFilter.cs 中的 RequestFilter 代码。这是当前的实现，以防万一：

```
public void RequestFilter(IHttpRequest req, IHttpResponse res, object requestDto)
{
  IValidator validator = ValidatorCache.GetValidator(req, requestDto.GetType());
  if (validator == null)
    return;
  IRequiresHttpRequest requiresHttpRequest = validator as IRequiresHttpRequest;
  if (requiresHttpRequest != null)
    requiresHttpRequest.HttpRequest = req;
  string httpMethod = req.HttpMethod;
  ValidationResult result = validator.Validate(new ValidationContext(requestDto, (PropertyChain) null, (IValidatorSelector) new MultiRuleSetValidatorSelector(new string[1]
  {
    httpMethod
  })));
  if (result.IsValid)
    return;
  object errorResponse = DtoUtils.CreateErrorResponse(requestDto, ValidationResultExtensions.ToErrorResult(result));
  ServiceStack.WebHost.Endpoints.Extensions.HttpResponseExtensions.WriteToResponse(res, req, errorResponse);
} 
```

响应过滤器应该类似于请求过滤器，但您必须安装自己的。为此，您需要实现自己的 IPlugin。一种简单的方法是从[https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Validation/ValidationFeature.cs](https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack.ServiceInterface/Validation/ValidationFeature.cs)复制/粘贴/编辑现有的 ValidationFeature.cs 。（这个类有一些私有元素，这使得它对于子类化不是最理想的，否则我会建议这样做。）

您需要进行的关键更改是注册您自己的过滤器：

```
 /// <summary>
    /// Activate the validation mechanism, so every request DTO with an existing validator
    /// will be validated.
    /// </summary>
    /// <param name="appHost">The app host</param>
    public void Register(IAppHost appHost)
    {
        if (Enabled) return;
        Enabled = true;
        // use my class instead of ServiceStack.ServiceInterface.Validation.ValidationFilters
        var filter = new MyValidationFilters();
        appHost.RequestFilters.Add(filter.RequestFilter);
        appHost.ResponseFilters.Add(filter.RequestFilter);
    } 
```

然后您可以创建自己的 MyValidationFilters 类。在这里，如果有意义，您可以从 ServiceStack.ServiceInterface.Validation.ValidationFilters 派生，如果对您有用，只需使用他们的 RequestFilter。但是您的 ResponseFilter 可能需要与 RequestFilter 略有不同，因为它通过的是 Response DTO 而不是 Request DTO。请注意 RequestFilter 中的这段代码：

```
 object errorResponse = DtoUtils.CreateErrorResponse(requestDto, ValidationResultExtensions.ToErrorResult(result)); 
```

此代码将无法正常工作，因为 ServiceStack 将尝试获取 requestDto，构造适当的 Response DTO，并填充它，正如您在 DtoUtils 代码中所见：

```
public static object CreateErrorResponse(object request, ValidationErrorResult validationError)
{
  ResponseStatus responseStatus = DtoUtils.ToResponseStatus(validationError);
  return DtoUtils.CreateErrorResponse(request, (Exception) new ValidationError(validationError), responseStatus);
}

public static object CreateErrorResponse(object request, Exception ex, ResponseStatus responseStatus)
{
  object responseDto = DtoUtils.CreateResponseDto(request, responseStatus);
  IHttpError httpError = ex as IHttpError;
  if (httpError != null)
  {
    if (responseDto != null)
      httpError.Response = responseDto;
    return (object) httpError;
  }
  else
  {
    string errorCode = ex.GetType().Name;
    string errorMessage = ex.Message;
    if (responseStatus != null)
    {
      errorCode = responseStatus.ErrorCode ?? errorCode;
      errorMessage = responseStatus.Message ?? errorMessage;
    }
    return (object) new HttpError(responseDto, HttpRequestExtensions.ToStatusCode(ex), errorCode, errorMessage);
  }
} 
```

相反，您需要绕过 CreateResponseDto 部分（因为您已经在 ResponseFilter 中拥有了 Response DTO）并完成其余的工作。

请注意，通过更改 ServiceStack 可以避免上述所有复制/粘贴。您可以自己重构 ServiceStack 代码以避免重复，然后向 github 提交拉取请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-02T16:36:29.870

（只是对 100 多个 if 语句的修复，由于代码标签，不想放在评论中）

在您的 AfterEachRequest 中，使用动态调用：

```
dynamic dynamicResponse = response;
IValidator validator = TryResolveValidator(response); // magic happens here

// ... your error handling code ...

public IValidator<T> TryResolveValidator<T>(T response)
{
    return AppHost.TryResolve<IValidator<T>>();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T11:19:55.680

我得到这个以一种**丑陋的方式**工作。我的*else if*`AfterEachRequest()`语句**不好**：

```
public class CustomServiceRunner<T> : ServiceRunner<T> {
    public CustomServiceRunner(IAppHost appHost, ActionContext actionContext) : base(appHost, actionContext) { }
    //1.
    public override void BeforeEachRequest(IRequestContext requestContext, T request) {
        var validator = AppHost.TryResolve<IValidator<T>>();
        if (validator != null) {
            var result = validator.Validate(request);
            if (!result.IsValid) throw result.ToException();
        }
        base.BeforeEachRequest(requestContext, request);
    }
    //2.
    public override object AfterEachRequest(IRequestContext requestContext, T request, object response) {
        IValidator validator = null;
        if(response.GetType()==typeof(CustomersResponse)) validator= AppHost.TryResolve<IValidator<CustomersResponse>>();
        else if(response.GetType()==typeof(OrdersResponse)) validator= AppHost.TryResolve<IValidator<OrdersResponse>>();
        else if(response.GetType()==typeof(LoginResponse)) validator= AppHost.TryResolve<IValidator<LoginResponse>>();
        //......
        // and 100+ more 'ELSE IF' statements o_O ??
        //......
        if (validator != null) {
            var result = validator.Validate(response);
            if (!result.IsValid) throw result.ToException();
        }
        return base.AfterEachRequest(requestContext, request, response);
    }

} 
```

:P ~ 仍然希望 Mythz 或有经验的人可以帮助我改进解决方案。

# java - Drools 5.1.1 意外的 Accumulate 和 Collect 行为

> ID：15304083
> 
> 赞同：1
> 
> 时间：2013-03-08T22:01:45.253
> 
> 标签：java, jboss, rabbitmq, drools, spring-amqp

我正在使用 Spring AMQP 从 RabbitMQ 读取消息。读取消息后，将其反序列化为一个标头（父）对象和多个详细信息（子）对象。然后将这些事实插入 Drools 无状态规则会话。最后，更新的事实被插入到数据库中。

我有几个规则将使用收集或累积函数聚合详细事实。这是一个例子。

```
rule "Header.TotalDuration" 
when 
    h : BresHeader() 
    n : Number() 
            from accumulate( d : BresDetail(willSendToInvoice==true, 
                                            uniqueConfID ==   h.uniqueConfID),
                             sum(d.Duration) ) 
then 
    h.TotalDuration = new Integer(n.longValue()); 
    System.out.println("[TotalDuration] rule ran"); 
end 
```

如果我在 jUnit 中运行一次（读取一条消息），则 TotalDuration 计算正确。如果我在 tomcat 中运行它（连续读取消息）， TotalDuration 的值不正确，并且在每次传递后都会增加（消息被抓取，规则运行，事实持续存在，重复），我不知道为什么。

任何人都可以阐明这种行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T04:06:58.487

也许您有一个`static`变量，它继续将事实从以前的消息传递到新消息。

# java - 使用一定百分比的组件随机化数组

> ID：15304090
> 
> 赞同：-1
> 
> 时间：2013-03-08T22:02:19.647
> 
> 标签：java, arrays, random, percentage, shuffle

我正在尝试创建一个包含 30 个元素的数组，并设置每个元素应该有多少的百分比。（即 40% 应该是“a”，20% 应该是“b”，20% 应该是“c”等等）最终结果应该是这些组件的随机数组。

我们可能不允许使用 Collection.shuffle()，因为我们还没有在课堂上讨论过它。

帮助如何解决这个问题？在使用循环按顺序插入元素后，是否有另一种方法来打乱数组？或者有没有办法随机选择要插入的组件？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:05:48.320

简单的方法（不提供作业解决方案）

1.  按所需比例按顺序将项目填充到集合中。
2.  随机播放集合（使用任何适当的随机播放算法）

# ruby - 如果值相同，则合并哈希键

> ID：15304091
> 
> 赞同：0
> 
> 时间：2013-03-08T22:02:20.430
> 
> 标签：ruby, hash, inject

我需要这样的哈希：

```
{"10am - 2pm"=>"Sun - Sat", "5pm - 7pm"=>"Sun - Sat"} 
```

并像这样创建一个新的哈希：

```
{"10am - 2pm, 5pm - 7pm"=>"Sun - Sat"} 
```

如果散列中成员之间的任何值相同，我需要组合键并删除重复项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T01:35:35.623

```
h.inject({}) {|r,(k,v)| r[h.select {|_,_v| _v == v}.keys.join(', ')] = v; r} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T22:29:29.950

可能有一些更简单的东西，也许其中一个真正聪明的人会带着一些很酷和禅宗的东西徘徊，但现在这行得通：

```
hash = {"10am - 2pm"=>"Sun - Sat", "5pm - 7pm"=>"Sun - Sat"}
hash.group_by{ |k,v| v }.each_with_object({}) { |(k,v), h| h[v.map(&:first).join(', ')] = k } 
```

生成：

```
{
    “上午 10 点 - 下午 2 点，下午 5 点 - 晚上 7 点” => “周日 - 周六”
}

```

@muistooshort 提出了一个很好的观点：

> 当您可以将数组用作 Ruby 哈希中的键时，为什么要将它们组合成一个字符串？

```
hash.group_by{ |k,v| v }.each_with_object({}) { |(k,v), h| h[v.map(&:first)] = k }
{
    [“上午 10 点 - 下午 2 点”，“下午 5 点 - 晚上 7 点”] => “周日 - 周六”
}

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T00:11:12.010

```
{"10am - 2pm"=>"Sun - Sat", "5pm - 7pm"=>"Sun - Sat"}
.inject({}){|h, (k, v)|
   _k = h.key(v)
   h.delete(_k)
   h[[*_k, k].join(", ")] = v
   h
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T22:04:40.843

我不知道 ruby​​ 语法，但我会创建一个新的散列，其中键是值，值是键，然后将新散列再次分组到数组中，现在值是键，键是值：P

编辑：

对于那些downvotes，是的，我不知道ruby，但是试图给出解决问题的想法有什么问题？OP不必接受我的答案。

这是代码：

```
HashMap<String, String> hash = new HashMap<String, String>();
        HashMap<String, ArrayList> nhash = new HashMap<String, ArrayList>();
        HashMap<String, String> fhash = new HashMap<String, String>();

        hash.put("10am - 2pm", "Sun - Sat");
        hash.put("5pm - 7pm", "Sun - Sat");

        Iterator it = hash.keySet().iterator();
        while(it.hasNext()){
            String k =it.next().toString();
            String v=hash.get(k);
            if(nhash.get(v)==null){
                ArrayList a = new ArrayList();
                nhash.put(v, a);
                nhash.get(v).add(k);
            }else{
                nhash.get(v).add(k);
            }
        }

        Iterator nit = nhash.keySet().iterator();
        while(nit.hasNext()){
            String k =nit.next().toString();
            ArrayList v=nhash.get(k);
                fhash.put(v.toString(), k);

        }

        System.out.println(fhash); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-09T00:23:49.037

我不会对我自己的解决方案进行投票，因为我更改了要求（实际上后来在我的代码中帮助了我），但这是我最终做的：

```
h = {"10am - 2pm"=>"Sun - Sat", "5pm - 7pm"=>"Sun - Sat"}
h.reduce({}) { |h, (k,v)| (h[v] ||= []) << k; h}.reduce({}) {|h, (k,v)| h[k] = v.join(', '); h}
# {"Sun - Sat"=>"10am - 2pm, 5pm - 7pm"} 
```

我不能只调用反转，因为重复的值会被压缩到新哈希中的一个成员中。所以我在保留每个组件（在数组中）的同时进行反转，然后加入该数组以生成我正在寻找的字符串。

# eclipse - Eclipse 中的自动更新在未安装的插件/功能上出现错误

> ID：15304100
> 
> 赞同：2
> 
> 时间：2013-03-08T15:15:12.240
> 
> 标签：eclipse

在 Eclipse Juno 中尝试“检查更新”时发现更新，但错误阻止继续安装：*无法完成操作。查看详细信息。*这些细节是：

```
Cannot complete the install because of a conflicting dependency.
  Software being installed: Eclipse IDE for Java EE Developers 1.5.2.20130211-1820 (epp.package.jee 1.5.2.20130211-1820)
  Software currently installed: Oracle WebLogic Server Tools 2.2.0.201211211917 (oracle.eclipse.tools.juno.weblogic.feature.group 2.2.0.201211211917)
  Only one of the following can be installed at once: 
    Eclipse Workbench 3.104.0.v20121219-151754 (org.eclipse.ui.workbench 3.104.0.v20121219-151754)
    Eclipse Workbench 3.104.0.v20121114-140926 (org.eclipse.ui.workbench 3.104.0.v20121114-140926)
    Eclipse Workbench 3.103.0.v20120530-1824 (org.eclipse.ui.workbench 3.103.0.v20120530-1824)
    Eclipse Workbench 3.103.1.v20120906-120042 (org.eclipse.ui.workbench 3.103.1.v20120906-120042)
    Eclipse Workbench 3.104.0.v20130204-164612 (org.eclipse.ui.workbench 3.104.0.v20130204-164612)
  Cannot satisfy dependency:
    From: Eclipse IDE for Java EE Developers 1.5.2.20130211-1820 (epp.package.jee 1.5.2.20130211-1820)
    To: org.eclipse.epp.package.jee.feature.feature.group [1.5.2.20130211-1820]
  Cannot satisfy dependency:
    From: Oracle Common Tools 5.2.0.201211211917 (oracle.eclipse.tools.common 5.2.0.201211211917)
    To: bundle org.eclipse.ui.workbench [3.8.0,3.104.0)
  Cannot satisfy dependency:
    From: Oracle WebLogic Server Tools 2.2.0.201211211917 (oracle.eclipse.tools.juno.weblogic.feature.group 2.2.0.201211211917)
    To: oracle.eclipse.tools.weblogic [5.2.0.201211211917]
  Cannot satisfy dependency:
    From: Oracle WebLogic Server Tools 5.2.0.201211211917 (oracle.eclipse.tools.weblogic 5.2.0.201211211917)
    To: bundle oracle.eclipse.tools.common [5.2.0,5.3.0)
  Cannot satisfy dependency:
    From: Java EE IDE Feature 1.5.2.20130211-1820 (org.eclipse.epp.package.jee.feature.feature.group 1.5.2.20130211-1820)
    To: org.eclipse.platform.feature.group [4.2.1.v20130118-173121-9MF7GHYdG0B5kx4E_SkfZV-1mNjVATf67ZAb7]
  Cannot satisfy dependency:
    From: Eclipse Platform 4.2.1.v20130118-173121-9MF7GHYdG0B5kx4E_SkfZV-1mNjVATf67ZAb7 (org.eclipse.platform.feature.group 4.2.1.v20130118-173121-9MF7GHYdG0B5kx4E_SkfZV-1mNjVATf67ZAb7)
    To: org.eclipse.rcp.feature.group [4.2.2.v20130129-152330-7IARAABrMQkGSvMgQnUlz-DQz00h]
  Cannot satisfy dependency:
    From: Eclipse RCP 4.2.2.v20130129-152330-7IARAABrMQkGSvMgQnUlz-DQz00h (org.eclipse.rcp.feature.group 4.2.2.v20130129-152330-7IARAABrMQkGSvMgQnUlz-DQz00h)
    To: org.eclipse.ui.workbench [3.104.0.v20130204-164612] 
```

*安装历史*显示当前安装中未安装 Oracle 软件，但之前的配置包括 Oracle WebLogic Server Tools 和/或 Oracle WebLogic Sc​​ripting Tools。

有什么建议可以让 Eclipse 再次自我更新吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T21:06:19.233

当前版本的 Eclipse Juno 和 WebLogic Server Tools 目前不兼容。有关详细信息，请参阅我在 Oracle 论坛上得到的[答案。](https://forums.oracle.com/forums/message.jspa?messageID=10901235#10901235)

更新：WebLogic Server Tools 已经更新，现在可以安装在当前的 Eclipse Juno 版本上。

# php - setcookie() 不工作，数组总是空的

> ID：15304101
> 
> 赞同：0
> 
> 时间：2013-03-08T22:03:32.907
> 
> 标签：php, cookies, setcookie

不知道我做错了什么......

这是用于设置 cookie 的页面： [https ://www.ni-dieu-ni-maitre.com/test.php](https://www.ni-dieu-ni-maitre.com/test.php)

```
 $domain = "ni-dieu-ni-maitre.com";
$articleid = "test";

$lastviewedarticles = array();

if (isset($_COOKIE["viewed_articles"]) ) {
  $lastviewedarticles = unserialize($_COOKIE["viewed_articles"]);
}

if (!in_array($articleid, $lastviewedarticles)){
    $count = count($lastviewedarticles);
    if($count>=29)
        array_shift($lastviewedarticles);
    $lastviewedarticles[] = $articleid;
}
setcookie('viewed_articles', serialize($lastviewedarticles), time()+60*60*24*30, '/', '.' . $domain); 
```

然后这个页面读取cookie并输出内容： [https ://ni-dieu-ni-maitre.com/test2.php](https://ni-dieu-ni-maitre.com/test2.php)

```
if ( isset($_COOKIE["viewed_articles"]) ) {
  $lastviewedarticles = unserialize($_COOKIE["viewed_articles"]);
}
echo "cookie is currently:<br>";
print_r($lastviewedarticles); 
```

正如您在测试页面上看到的，没有 WWW 时 cookie 总是空的。cookie中有一个数组，但总是为空

# spring - Spring中的下拉框

> ID：15304102
> 
> 赞同：0
> 
> 时间：2013-03-08T22:03:42.130
> 
> 标签：spring, jsp, jstl, el

我在 Spring 中有一个类似于以下内容的选择框。

```
<form:select path="cmbZone" multiple="false" class="validate[required] text-input tooltip" title="Mandatory select field.">
    <form:option value="">Select</form:option>

    <c:forEach items="${zoneList}" var="row">
        <form:option value="${row[0]}">${fn:escapeXml(row[1])}</form:option>
    </c:forEach>
</form:select> 
```

这使用 JSTL`forEach`循环来迭代项目列表。是一个列表，其中包含使用 HQL 从数据库中检索到的s`zoneList`数组，如下所示。`Object``List<Object[]>`

```
List<Object[]>zoneList=sessionFactory.getCurrentSession().createQuery("select z.zoneId, z.zone from Zone z order by z.zoneId").list(); 
```

我想使用`<form:options>`. 我如何指定`itemLabel`和 的`itemValue`属性`<form:options>`？

```
<form:select path="cmbZone" multiple="false" class="validate[required] text-input tooltip" title="Mandatory select field.">
    <form:option value="">Select</form:option>
    <form:options items="${zoneList}"/>
</form:select> 
```

这会是`itemLabel`什么`itemValue`？

```
<form:options items="${zoneList}" itemLabel="" itemValue=""/> 
```

我正在使用 Spring 3.2.0。我指的是[这个](http://www.mkyong.com/spring-mvc/spring-mvc-dropdown-box-example/)博客，但找不到路。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:57:30.503

将您的休眠查询更改为

```
List<Zone> zoneList = sessionFactory.getCurrentSession().createQuery(
    "select z from Zone z order by z.zoneId").list(); 
```

现在您有了具有属性的对象，您可以使用

```
<form:options items="${zoneList}" itemLabel="zone" itemValue="zoneId"/> 
```

# c++ - C++ 分段错误：11，试图重载运算符 <<

> ID：15304103
> 
> 赞同：2
> 
> 时间：2013-03-08T22:03:47.073
> 
> 标签：c++, segmentation-fault, runtime-error

我正在尝试重载此类中的 << 运算符，但这是输出：

```
Hello, 
Segmentation fault: 11 
```

这是我的代码：

测试.cc：

```
#include <iostream>
#include "class.h"
#include <string>

using namespace std;

int main() {
    MYString s("Hello");

    MYString s2;

    string hello = "Hello";

    cout << s.text << ", " << s2.text << endl;

    cout << "S: " << s << endl;

    hello[0] = 'M';
    cout << hello << endl;

    return 0;
} 
```

这是class.h：

```
#ifndef CLASS_H
#define CLASS_H

#include <string>

using namespace std;

class MYString {
public:
    string text;

    MYString(string data="") {
        text = data;
    }

    friend ostream& operator << (ostream& os, const MYString& data) {
        os << data;
        return(os);
    }
 };

#endif 
```

它编译得很好，但我不知道为什么它说“分段错误：11”。我也不知道那是什么意思。有人可以告诉我如何解决这个问题吗？而且我对 C++ 也很陌生

（而且我知道这段代码真的毫无意义，但我只是想学习一些东西并习惯 C++）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T22:07:58.647

你有一个[堆栈溢出](http://stackoverflow.com)。您的`operator<<`电话`operator<<`（具有相同数据的相同功能）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-08T22:07:47.697

```
friend ostream& operator << (ostream& os, const MYString& data) {
    os << data; // calls 'ostream& operator<<(ostream&,const MYstring&)' -- oops
    return(os);
} 
```

无限递归。改用`os << data.text`：

```
friend ostream& operator << (ostream& os, const MYString& data) {
    os << data.text;
    return(os);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T22:09:03.347

我想你可能想要：

```
os << data.text; 
```

在您的重载运算符中，以免陷入无限递归。你目前拥有的只会不断地调用自己，直到你的堆栈爆炸。

* * *

顺便说一句，我不是 . 的忠实粉丝`return(os)`，它让它看起来像一个函数调用，但它绝对不是。你可以简单地做`return os`，即使是非常复杂的表达式。

在某些时候，您最终会顿悟数据成员几乎应该始终是私有的，这就是封装的全部意义所在。没有它，C++ 将只是一个更难学习的 C :-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T22:08:04.230

你想输出包含在你的`MyString`对象中的字符串，所以你应该替换

```
os << data; 
```

和

```
os << data.text; 
```

这就是拥有`friend`功能的全部意义所在。

实际上，您进行了无限递归，因为`os << data;`将自己称为`<<`函数的运算符（`data`属于 type `MyString`）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T22:10:09.583

您应该将 os << data 更改为 os << data.text

# jquery - Flexigrid 中的嵌套 json 对象

> ID：15304104
> 
> 赞同：1
> 
> 时间：2013-03-08T22:03:49.673
> 
> 标签：jquery, arrays, json, object, flexigrid

首先让我说这不是我做的。我不会像这样构建数据库。不幸的是，无法对数据库进行更改。照这样说：

我通过 url 将 json 返回到 Flexigrid。该 url 正在从 mysql 查询返回结果。其中一个结果是 json 数据集。

```
colModel : [
    {display: 'Contact Name', name : 'closing_data', width : 120, sortable : true, align: 'left'},
    ], 
```

'closure_data' 是在 mysql 表中保存为 json 的 json。我需要访问这些元素之一进行显示。就像是：

```
colModel : [
    {display: 'Contact Name', name : 'closing_data->Seller_name', width : 120, sortable : true, align: 'left'},
    ], 
```

如何做到这一点，以便它可以显示给定 json 的特定元素？谢谢您的帮助！

# php - PHP - 数组到对象 - 通过索引获取对象变量时的问题

> ID：15304107
> 
> 赞同：4
> 
> 时间：2013-03-08T22:03:53.657
> 
> 标签：php

我只是想了解为什么`print_r()`下面的最后两个调用不起作用并引发以下错误`Undefined property: stdClass::$0`。根据 PHP 文档，我应该能够使用以下运算符访问对象数字属性`$object->{'x'}`（ x 是我要访问的数字索引）。

谢谢。

```
$array = (object)array( 
    0 => 'test1',
    1 => 'test2',
    2 => 'test3',
    'test' => (object)array(
        0 => 'hi1',
        1 => 'hi2',
        2 => 'hi3'
    )
);

print_r( $array );

print_r( $array->test );

print_r( $array->test->{'0'} );

print_r( $array->{'0'} );

die(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:21:39.020

这就是[PHP 的崩溃](https://stackoverflow.com/a/10333200/1002469)。对象属性访问的花括号语法*不适用于全数字键*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:29:23.443

将数组类型转换为对象时，所有数字键都转换为整数属性；和整数属性无法访问。

```
$array = array(0 => 'a', 1.5 => 'b', '2' => 'c');

var_dump((object) $array);

// object(stdClass)#1 (3) { [0]=> string(1) "a" [1]=> string(1) "b" [2]=> string(1) "c" } 
```

但是，当使用花括号表示法设置全数字属性时，它们将存储为字符串；可以*访问*。

```
$array = (object) array();

$array->{0}   = 'a';

$array->{1.5} = 'b';

$array->{'2'} = 'c';

var_dump($array);

// object(stdClass)#1 (3) { ["0"]=> string(1) "a" ["1.5"]=> string(1) "b" ["2"]=> string(1) "c" } 
```

因此，您遇到的问题。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-08T22:06:57.323

这是工作：

```
 $array = (object)array( 
    a => 'test1',
    b => 'test2',
    c => 'test3',
    'test' => (object)array(
        a => 'hi1',
        b => 'hi2',
        c => 'hi3'
    )
);

print_r( $array );

print_r( $array->test );

print_r( $array->test->a);

print_r( $array->b );

die(); 
```

# iphone - 在 iOS 中播放系统声音

> ID：15304111
> 
> 赞同：6
> 
> 时间：2013-03-08T22:04:06.850
> 
> 标签：iphone, ios, objective-c, xcode, ipad

我试图了解如何在 iOS 中播放这些声音。我确实找到了一些代码片段，但是当我使用它时它们不会播放任何东西。我究竟做错了什么？

[http://iphonedevwiki.net/index.php/AudioServices](http://iphonedevwiki.net/index.php/AudioServices)

```
- (IBAction) playSystemSound: (id) sender {

    AudioServicesPlaySystemSound (1100);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T22:06:56.277

如果您使用有效的 soundID 并在设备上播放声音，那么您提供的代码应该可以工作。

或者，如果对您有帮助，您可以使用以下代码播放自定义声音或音频文件

```
- (IBAction) playSystemSound: (id) sender {
    NSString *soundPath = [[NSBundle mainBundle] pathForResource:@"audio" ofType:@"mp3"];
    SystemSoundID soundID;
    AudioServicesCreateSystemSoundID((CFURLRef)[NSURL fileURLWithPath: soundPath], &soundID);
    AudioServicesPlaySystemSound (soundID);
} 
```

[Apple 提供](https://developer.apple.com/library/ios/#samplecode/SysSound/Listings/Classes_SysSoundViewController_m.html#//apple_ref/doc/uid/DTS40008018-Classes_SysSoundViewController_m-DontLinkElementID_6)了播放声音的示例代码，您也可以查看一下。

# xcode - Xcode LLDB：如何根据 this 指针设置条件断点？

> ID：15304113
> 
> 赞同：2
> 
> 时间：2013-03-08T22:04:26.713
> 
> 标签：xcode, debugging, breakpoints, lldb, conditional-breakpoint

我有一个 c++ 应用程序，并试图在 Xcode 下使用 LLDB 对其进行调试。我想在成员函数内停止，但仅当 this 指针与特定实例匹配时。

我尝试使用以下表达式在断点中设置条件：

```
this == 0x12345 
```

但我反复收到以下错误：

```
error: invalid use of 'this' outside of a nonstatic member function
error: 1 errors parsing expression 
```

在该断点处暂停时，我也无法在调试器控制台中输入上述表达式。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-06-19T11:19:23.317

问题很可能与`this`. 在 Objective-C 中，等价于`self`.

因此，可以通过以下方式轻松设置条件：

```
self == 0x12345 
```

这是调试器成功停止的示例：

![在此处输入图像描述](../Images/de91abd765ed8632fb3e3e3e44629f06.png)

# windows - Windows CreateThreadpool 限制 C++ 中的线程数

> ID：15304114
> 
> 赞同：1
> 
> 时间：2013-03-08T22:04:29.357
> 
> 标签：windows, threadpool

我在我的服务器中使用 C++ 中的新线程池 Windows API (StartThreadpoolIo/StartThreadpoolIo) 来管理 IO 线程池（客户端通过套接字连接）。我已经详细探索了 MSDN，但没有找到 - 我如何限制工作线程数？

我可以限制通过 CreateThreadpool（SetThreadpoolThreadMaximum 和 SetThreadpoolThreadMinimum）创建的线程池的工作线程，但不能限制 CreateThreadpoolIo。是否有限制 IO 线程池线程数的功能？是否有手动实施的最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-06T10:02:28.243

`CreateThreadpool`，然后`SetThreadpoolThreadMaximum`，然后`InitializeThreadpoolEnvironment`使用该池并`CreateThreadpoolIo`使用该环境调用。因此`IO-callback`将使用您的有限池而不是默认池。

# c# - 使用 EF Code First，如何自动填充 HashedPassword 列？

> ID：15304115
> 
> 赞同：2
> 
> 时间：2013-03-08T22:04:39.247
> 
> 标签：c#, asp.net, entity-framework, ef-code-first

我有这个实体：

```
namespace FP.Domain.Entities
{
    public class Admins
    {
        public int ID { get; set; }
        public string Username { get; set; }
        public string Password { get; set; }
        public string HashedPassword { get; set; }
    }
} 
```

我已经`Password`使用 Fluent API 忽略了实体配置中的属性，因此它不会被映射。

但我想`HashedPassword`在创建新记录或更新它时自动填充。

该`HashedPassword`值取自`Password`属性的散列。

`HashedPassword`每次我创建新记录或更新`Password`现有记录时，我真的无法绕开它自动填充。所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:07:27.013

将代码放入密码设置器中。

例如

```
public class Admins
{
    public int ID { get; set; }
    public string Username { get; set; }
    public string HashedPassword { get; set; }

    private string _password;
    public string Password
    {
        get { return _password; }
        set
        {
            _password = value;
            HashedPassword = HashingMethod(_password);
        }
    }
} 
```

你甚至可能不需要吸气剂。

# algorithm - 如何检测请求/秒速率的增加？

> ID：15304117
> 
> 赞同：1
> 
> 时间：2013-03-08T22:04:45.623
> 
> 标签：algorithm, bigdata

我正在尝试实时处理不同链接的点击流。每次点击都会记录到数据库中。对于大多数链接，点击次数/分钟或多或少是恒定的（例如 < 50）。然而，他们中的少数获得 1000-2000/分钟，但只是在很短的时间内。

我想检测何时开始看到如此高流量的点击流，因为我想推迟和批处理这些流的数据库更新，而不是实时执行它们。

我一直在玩一些方法，但没有好的结果。对我来说，这看起来像是一个标准的数学问题或队列管理问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:18:37.753

At the time you insert each click, also calculate the number of clicks over the past minute and insert that. Then you can just query for events where the rate is high enough.

For example (pseudocode):

```
proc record_click
    insert into click_log (current_time, event_info)
    insert into click_rates (current_time, 
        (select count(*) from click_log where time > current_time - 1 minute)) 
```

If you don't want to do it at the time of inserting the click, you can calculate that value later, but that will be a potentially huge data set to chew through, rather than just your ~50 records at each click time.

```
create view click_rates as
    select event_time, count(*) as rate
    from click_events e1, click_events e2
    where e2.event_time between e1.event_time - interval '1 minute' and e1.event_time
    group by e1.event_time 
```

# javascript - .click() 仅在 iPad 中不工作，在backbone.js 应用程序内

> ID：15304119
> 
> 赞同：1
> 
> 时间：2013-03-08T22:04:51.250
> 
> 标签：javascript, jquery, backbone.js, backbone-views

我遇到了一个非常奇怪和令人沮丧的问题——我在我的主干.js 应用程序的视图中编写了一个 .click() 事件（第一次编写一个），它成功地在每个桌面浏览器中触发，但它不会在 iPad 上工作。

代码是这样的：

```
if (something) {
 $('a.link').click();
} else {
  // do something else
} 
```

我不知道为什么会这样。我正在使用backbone.js，如果这意味着什么的话，还有backbone.touch.js。为此，我已经把头撞在墙上好几个小时了。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:15:02.680

尝试使用自定义事件而不是模拟点击：

要在主干对象中触发自定义事件，只需触发它。例如，在您的模型中：

```
this.trigger('click:navitem'); 
```

然后，您在哪里监听这些事件，例如在附加到该模型的视图中：

```
this.listenTo(this.model, 'click:navitem', doFunc); 
```

其中 doFunc 是您的处理程序的名称。

这是一个[jsfiddle](http://jsfiddle.net/VYpvx/5/)演示。该示例是人为设计的，因此它可能与您的应用程序的结构不匹配，但重点是演示触发和侦听自定义事件。在这个示例中，我只是在同一个视图中完成了所有操作，但事件触发的来源可以是模型或集合，只要您正在侦听这些事件的位置可以引用事件的发起者。它本质上是骨干网对 pub/sub 的实现，当然，它可以在骨干网之外使用 jquery、pubsub 或各种其他库实现，但是您可以从骨干网免费获得它。

# django - 如何自定义 Django 对 IntegerFields 的管理员验证？

> ID：15304126
> 
> 赞同：1
> 
> 时间：2013-03-08T22:05:09.383
> 
> 标签：django, django-admin

我在 Django 管理模型中有一个 IntegerField，有时人们输入“2,100”而不是“2100”，Django 抱怨“输入一个整数”。是否可以重写一些允许我去掉逗号、美元符号等的方法，以便可以将数字正确解析为整数，同时对用户来说是直观的？我尝试过 clean() 和 clean_fields()，但它们似乎不是我想要的，除非我使用不正确。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:25:31.997

如果 django 内置版本，如何编写自己的自定义整数字段并使用它。有关更多信息，请参阅[文档](http://docs.djangoproject.com/en/dev/howto/custom-model-fields/)。您可能想要覆盖内置的`IntegerField`，然后可能[编写自己的 FormField](https://docs.djangoproject.com/en/dev/howto/custom-model-fields/#specifying-the-form-field-for-a-model-field)。

我怀疑这是在您覆盖和模型`ModelForm`时失败的验证 - 表单验证将在模型验证之前启动。`clean()``clean_fields()`

尝试这样的事情：

```
from django.db import models
from django.forms import fields

class IntegerPriceFormField(fields.IntegerField):
    def to_python(self, value):
        if isinstance(value, basestring):
            value = value.replace(",", "").replace("$", "")
        return super(IntegerPriceFormField, self).to_python(value)

class IntegerPriceField(models.IntegerField):
    def formfield(self, **kwargs):
        defaults = {'form_class': IntegerPriceFormField}
        defaults.update(kwargs)
        return super(IntegerPriceField, self).formfield(**defaults) 
```

然后，您可以在模型定义中使用 IntegerPriceField 而不是 IntegerField。

# c# - 将窗体控件发送到窗体的前后

> ID：15304130
> 
> 赞同：0
> 
> 时间：2013-03-08T22:05:24.890
> 
> 标签：c#, wpf, visual-studio-2010, wpf-controls

在vs2010 c#中是否可以在同一个表单上也有一些按钮的表单上创建一个图片框和一个文本框

然后通过代码将图片和文本框作为最前面的元素，然后通过代码将它们作为最后面的背景视觉元素，以便能够在前后元素之间切换？

在设计期间可以做到这一点，但我没有看到可以更改的属性或者我只是忽略了它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:10:54.017

这就是 Z-Index 为您提供 Z 轴的地方。读这个：

[http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.zindex(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.zindex(v=vs.95).aspx)

取一个`Canvas`并放入您想要的任何内容，然后根据需要更改 Z-Index。这是一个例子：

```
<Canvas>
    <Ellipse Canvas.ZIndex="3" Canvas.Left="5" Canvas.Top="5" Fill="Silver" Width="10" Height="10" />
</Canvas> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:14:46.650

是的，这可以做到，但这取决于内部`Layout`的控制`Controls`

例如在`Grid`等上，您可以使用`Panel.ZIndex`

```
 <Grid>
        <Button Panel.ZIndex="1" />
        <Button Panel.ZIndex="0" />
    </Grid> 
```

这些是`AttachedProperties`从父容器继承的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T14:43:34.523

```
 Textbox.sendtoback();
     Textbox.bringtofront(); 
```

# php - PHP 使用复选框显示最终价格

> ID：15304131
> 
> 赞同：0
> 
> 时间：2013-03-08T22:05:27.400
> 
> 标签：php, ajax, post, cart

我目前正在为我的公司开发一个搜索引擎。它使用 AJAX 和 PHP，搜索引擎已经完成，但现在我面临另一个问题。

有没有办法只发布被打勾的文章的价格？这是到目前为止的代码：

```
<thead>
    <th class="col1">Codigo</th>
    <th class="col2">C&oacute;digo Cat&aacute;logo</th>
    <th class="col3">Descripci&oacute;n</th>
    <th class="col4">Precio </th>
    <th class="col5">Carrito</th>
    <th class="col6">Cantidad</th>  
</thead>
<td><?php echo $row['codigo']; ?></td>
    <td><?php echo $row['codigo_cat']; ?></td>
    <td><?php echo $row['descripcion']; ?></td>
    <td><?php echo $row['precio']; ?></td>
    <td><form action="cart.php" method="post"><input type='checkbox' name='buy[]' value='1' /></td>
    <td><input type="number" id="num"/><input type="submit" value="Calc"/>    </form></td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:10:37.767

我不建议这样做，如果有多个相同价格的文章，您怎么知道检查了哪篇文章？

我会添加产品的 ID，以便您知道它是哪一个：

```
<input type='checkbox' name='buy[<?php echo $row['id']; ?>]' value='1' /> 
```

并且您跨越多列的单个`form`标签将不起作用（无效的 html 并且每个框都采用另一种形式）。您应该只有一个跨表格的表格。

# javascript - 使用 JavaScript 和 HTML5 制作棋盘游戏在线 GUI 的技巧

> ID：15304135
> 
> 赞同：5
> 
> 时间：2013-03-08T22:05:54.967
> 
> 标签：javascript, html, css, game-engine

我对将[棋（日本象棋）](http://en.wikipedia.org/wiki/Shogi)很感兴趣，我的朋友也终于对它感兴趣了。但是我的朋友没有能力购买软件或真正的板，所以我告诉他我会制作一个在线 GUI，以便我们可以一起玩。

现在的计划是，我基本上会给用户提供与使用真正电路板相同的自由。他可以在任何地方放置任何棋子，而且他基本上没有任何规则。唯一可以实现的机制是捕获碎片并丢弃它们。

不会有AI，它不会识别你什么时候违反规则，它不会识别check mate，或者什么时候游戏结束等等。当然这意味着它甚至不知道棋子是如何移动的。除了自动捕获的棋子之外，一切都将由玩家完成。

当然棋子的数量还是要考虑的，你只能有你在游戏开始时应该拥有的棋子数量，没有额外的东西等。

解决此问题的最佳方法是什么？我只想使用 HTML5 和 JavaScript（jQuery、AJAX 等），我不想使用 Java、Flash 或类似的东西。只有 HTML5 和 JavaScript，可能还有一些 CSS 功能（也许）。

最好的方法是什么？最难的部分应该是用户界面，它应该能够识别 9x9 板上的每个位置，它应该能够识别每个被调用的部分，并且应该能够说“你不能那样做，你的部分”重新尝试移动不存在”。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-09T00:09:29.723

There seem to be plenty of examples on github of [HTML5 chess games](https://github.com/benjaminfisher/Web-Chess).

If you want to create your game from scratch with Javascript I'd recommend [Crafty](http://craftyjs.com) an excellent open-source Javascript Game Engine. They have all the stuff in there to get you going, like a tile-based grid, even an isometric grid if you wanted the game to be 2.5d.

Answering this makes me want to do some game-programming now :) mjam

Oh and here's a [great introduction to Crafty](http://buildnewgames.com/introduction-to-crafty/?utm_source=javascriptweekly&utm_medium=email)

# c# - Server.MapPath 与 ~

> ID：15304142
> 
> 赞同：-2
> 
> 时间：2013-03-08T22:06:34.910
> 
> 标签：c#, asp.net

我正在努力寻找路径。不确定是否应该是：

```
 string driveLetter =  Server.MapPath("~/Docs/"); 
```

或者

```
 string driveLetter =  Server.MapPath("~/Docs"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:13:00.653

如果您想要 Docs 文件夹的物理文件路径，那么只需使用

```
string driveLetter =  Server.MapPath("~/Docs"); 
```

# windows-phone-7 - 如何在 Windows Phone 设备上获取屏幕分辨率

> ID：15304145
> 
> 赞同：2
> 
> 时间：2013-03-08T22:06:44.523
> 
> 标签：windows-phone-7, windows-phone

我遇到了问题，希望能在这里得到专家的帮助。我正在尝试获取屏幕分辨率，以便可以根据手机类型使用适当的布局/图像。

我的项目类型是 WP7。每当我在不同的 WP7 和 WP8 设备上运行代码时，我每次都得到相同的分辨率（800 X 480）。预期的行为是我根据设备类型获得不同的分辨率，例如 WVGA = 800 x 480、WXGA = 1280 x 768、720p = 1280 x 720。

下面的所有 3 个代码片段都给了我相同的 800 X 480 分辨率，这不是预期的行为。

```
Application.Current.RootVisual.RenderSize.Height + " x " + Application.Current.RootVisual.RenderSize.Width;

(App.Current.RootVisual as FrameworkElement).ActualHeight + " x " + (App.Current.RootVisual as FrameworkElement).ActualWidth;

App.Current.Host.Content.ActualHeight + " x " + App.Current.Host.Content.ActualWidth; 
```

[MSDN](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj206974%28v=vs.105%29.aspx)文章讨论了如何在WP8 中执行此操作，但请注意我希望代码也可以在 WP7 设备上运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T23:14:43.617

我最终根据上面的 Anton Sizikov 推荐编写了以下代码。它使用反射来读取 ScaleFactor 属性。如果 7.1 应用程序在 WP8 设备上运行，反射将返回 ScaleFactor 属性的值，并基于该设备分辨率可以确定。

```
public enum Resolutions { WVGA, WXGA, HD720p };

public static class ResolutionHelper
{
    static int? ScaleFactor;

    static ResolutionHelper()
    {
        object scaleFactorValue = GetPropertyValue(App.Current.Host.Content, "ScaleFactor");
        if (scaleFactorValue != null)
        {
            ScaleFactor = Convert.ToInt32(scaleFactorValue);
        }
    }

    private static bool IsWvga
    {
        get
        {
            return ScaleFactor.HasValue && ScaleFactor.Value == 100;
        }
    }

    private static bool IsWxga
    {
        get
        {
            return ScaleFactor.HasValue && ScaleFactor.Value == 160;
        }
    }

    private static bool Is720p
    {
        get
        {
            return ScaleFactor.HasValue && ScaleFactor.Value == 150;
        }
    }

    public static Resolutions CurrentResolution
    {
        get
        {
            if (IsWxga) return Resolutions.WXGA;
            else if (Is720p) return Resolutions.HD720p;
            return Resolutions.WVGA;
        }
    }

    private static object GetPropertyValue(object instance, string name)
    {
        try
        {
            return instance.GetType().GetProperty(name).GetValue(instance, null);
        }
        catch
        {
            // Exception will occur when app is running on WP7 devices as "ScaleFactor" property doesn't exist. Return null in that case. 
            return null;
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T23:50:15.137

如您链接到的 MSDN 文章中所述：[MSDN](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj206974%28v=vs.105%29.aspx)

Windows Phone 7 仅支持单一分辨率 800 x 480。由于您的项目以 WP7 为目标，这将是预期的行为。如果您正在开发 Windows Phone 8 项目，那么您应该看到 App.Current.Host.Content.ScaleFactor 应该返回不同的结果。

您可能需要创建一个 WP8 项目来自定义 WP8 中的各种分辨率。如果您仍想支持 WP7 设备，则需要创建一个单独的 WP7 项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-09T17:10:02.900

您可以尝试`App.Current.Host.Content.ScaleFactor`使用反射加载。

我现在没有我的 wp8 环境，但是你可以在[这里](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj720574%28v=vs.105%29.aspx)看到类似的解决方案。他们用它在 wp7.8 上创建王尔德瓷砖

# android - 使用 libpng 从 char 缓冲区和大小数据创建 PNG

> ID：15304152
> 
> 赞同：1
> 
> 时间：2013-03-08T22:07:05.900
> 
> 标签：android, c, graphics, libpng

我目前正在修改 Android 屏幕截图库以接受外部连接。当它连接到 Java 时，我知道我可以获取原始数据并通过 createBitmapFromBuffer(data) 将其传递到 Java 的位图中。这里的最终目标是使用 C，但我无法弄清楚如何将像素数据流行到 libpng 以使其正确写入。

几点：C服务器发送高度、宽度和bpp。然后，它通过套接字发送从 Android 上的帧缓冲区转换而来的缓冲区数据。

客户端可以成功获取所有数据，并且我知道如何从我拥有的数据中生成标头。问题是采用 char[] 并将其转换为 png_set_rows 和 png_write_png 将接受的内容，或者如何单独附加它并保存没有任何行数据的标题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:37:12.697

让我们看一下原型和描述`png_set_rows`

```
void png_set_rows(png_structp png_ptr, 
                  png_infop info_ptr, 
                  png_bytepp row_pointers); 
```

> png_set_rows() 将图像数据行放入 info_ptr 结构中，其中 row_pointers 是指向每行像素数据的指针数组。

我将假设您已经初始化 a`png_stuctp`作为第一个参数传递，并且您有一个空`png_infop`的作为第二个参数传递。

所以你的问题是作为第三个参数传入什么。

好吧，让我们看一下 png_byte 的定义：

`typedef unsigned char png_byte;`

太好了， png_byte 是一个无符号字符。

现在让我们看一下 png_bytepp 的定义：

`typedef png_byte FAR * FAR * png_bytepp;`

它是无符号字符的二维数组。

因此，您所要做的就是创建一个 2D 无符号字符数组并将其转换为 png_bytepp：

```
unsigned int IMAGE_HEIGHT = 720, IMAGE_WIDTH = 1280;

unsigned char row_pointers[IMAGE_HEIGHT][IMAGE_WIDTH];

/* test image initialization */
unsigned int i, j;
for (i = 0; i < IMAGE_HEIGHT; i++) {
    for (j = 0; j < IMAGE_WIDTH; j++) {
        row_pointers[i][j] = i * j;
    }   
}

png_set_rows(png_ptr, info_ptr, (png_bytepp)row_pointers); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:38:23.977

Take a look at [lodepng](http://lodev.org/lodepng/). It's an easy-to-use wrapper around libpng, with high-level functions (like `encode()`).

# java - 计算变量值被添加的次数

> ID：15304158
> 
> 赞同：0
> 
> 时间：2013-03-08T22:07:30.837
> 
> 标签：java

所以问题要求我执行以下操作：

```
public boolean addRating(int rating) 
```

> 为视频添加评分。如果评分介于 1-5 之间，则更新此视频的评分，跟踪已收到多少评分，并返回 true。否则，打印出错误消息并返回 false。

这就是我设法做到的：

```
 public class Video {

    private int rating;

    public boolean addRating(int rating){
        this.rating = rating;
        boolean result;
        int newRating = rating;
        if(newRating>=1 && newRating <=5){
            rating = newRating;
            result = true;
        }
        else{
            System.out.println("ERROR!");
            result = false;
        }
        return result;
    } 
```

所以我的问题是如何准确计算视频的评分次数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:11:23.503

该问题似乎表明您需要记住一个视频的多个评级。请注意，方法名称`addRating`不是`setRating`. 您最好使用评级列表对此进行建模：

```
List<Integer> ratings; 
```

然后跟踪评分的数量就像计算列表的大小一样简单。您的电话可能如下所示：

```
public class Video {
    private List<Integer> ratings = new LinkedList<Integer>();

    public boolean addRating(int rating){

        // Some other code you will have to write...

        ratings.add(rating);

        // Some other code you will have to write...

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:27:53.083

我就是这样做的。

```
public class Video {

  private int rating = 0;  // sum of all ratings
  private int count = 0;  // count the number of ratings

  public boolean addRating(int newRating){

      boolean result;
      if(newRating>=1 && newRating <=5){
          count++;
          this.rating = this.rating + newRating;
          result = true;
      }
      else{
          System.out.println("ERROR!");
          result = false;
      }
      return result;
  }

  // returns the avg of the ratings added
  public int getRating(){

      return Math.Round(((double) rating) / ((double) count));  
  }
} 
```

# c# - 在 C# 中从本机指针调用 COM 对象方法

> ID：15304160
> 
> 赞同：1
> 
> 时间：2013-03-08T22:07:35.493
> 
> 标签：c#, com, interop

在 C# 中，是否有一种简单的方法可以从本机指针调用 COM 对象方法？

```
 [DllImport("d3d11.dll", CallingConvention = CallingConvention.StdCall)]
    private unsafe static extern int D3D11CreateDevice(
        void* arg0, int arg1, void* arg2, int   arg3, void* arg4,
        int   arg5, int arg6, void* arg7, void* arg8, void* arg9);

    public static void CreateDevice()
    {
        unsafe
        {
            IntPtr deviceOut;
            IntPtr immediateContextOut;
            int featureLevelRef;

            D3D11CreateDevice(
                (void*)IntPtr.Zero,
                1,
                (void*)IntPtr.Zero,
                32,
                (void*)IntPtr.Zero,
                0,
                7,
                &deviceOut,
                &featureLevelRef,
                &immediateContextOut);
        }
    } 
```

在上面的代码中，我得到了`deviceOut`谁的类型是`ID3D11Device*`. 该`ID3D11Device`接口有一堆方法，例如`CreateBuffer()`.

`deviceOut`我可以使用指针调用其中一些方法吗？先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:10:37.270

如果你有一个指向 COM 对象的指针，你可以通过`GetObjectForIUnknown`.

```
IntPtr ptr = ...;
object unk = Marshal.GetObjectForIUnknown(ptr);
ID3D11Device dev = (ID3D11Device)unk; 
```

从那里您将能够调用 the`CreateBuffer`和其他方法

# algorithm - Median-of-medians：如果元素的数量不是 5 的倍数会怎样？

> ID：15304162
> 
> 赞同：1
> 
> 时间：2013-03-08T22:07:53.577
> 
> 标签：algorithm, selection, median-of-medians

我目前正在研究中位数 alg 的中位数。

从wiki学习后，我有一个问题：如果输入大小不能被5整除怎么办？如何使用中位数算法找到中位数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-28T18:18:02.970

即使输入的长度不是 5 的倍数，您也可以继续使用中位数算法。一种选择是让最后一个块只包含剩余元素并取其中值并像以前一样继续。另一种选择是在将元素分成五个块并取它们的中值时完全忽略元素，因为通过忽略少于五个元素找到的枢轴不会显着降低以这种方式找到的枢轴的质量（也就是说，你会忽略最多四个缺失的元素，得到大约 70 / 30 的分割，并且添加这些元素不会过多地混淆分数）。

希望这可以帮助！

# xpages - 将可编辑区域和自定义控件放在同一个方面？

> ID：15304166
> 
> 赞同：1
> 
> 时间：2013-03-08T22:08:06.467
> 
> 标签：xpages

我正在尝试为我们部门设置一些标准的自定义控件，但也想让它们变得灵活。

其中一些标准资源和控件将放置在模板中。控件将被复制到我们的应用程序中，但从中央模板继承设计，因此我想通过构面在应用程序级别进行任何自定义。

我的自定义控件基于扩展库中的应用程序控件。它的左列有一个方面。我想要做的是在左列中放置一个可编辑区域，同时还有另一个固定的标准自定义控件。

所以用户程序员会在他们的页面上放置一个“StandardApp”控件。他们会看到左列有一个方面，他们可以在其中放置自己的控件，并在其下方看到左列中的标准控件。

有什么办法可以做到这一点？

我似乎无法将可编辑区域和自定义控件放到同一个方面。甚至将两个可编辑区域放入同一个方面。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T05:26:42.657

一个方面只能包含一个控件，但它可以是任何控件……包括容器。因此，如果您的构面内容是 div（或面板、表格、部分等），那么该 div 可以同时包含标准化内容和可编辑区域。这使您可以尽可能多地链接您的构面，这是我一直使用的一种技术，基本上可以完成您所描述的事情：出现在每个页面上的标准左侧导航内容，每个页面都有一个占位符包括额外的自定义内容。

唯一需要注意的是，只有命名空间（xp、xc、xe 等）控件可以直接对构面做出贡献，而不是通路。例如，它不能是`<div xp:key="facetLeft" />`，但`<xp:div xp:key="facetLeft" />`会是有效的。但是那个 xp:div 可以包含你想要的任何东西，包括 passthru。

# jpa - JPA 标准 API 中的根在查询之间是否可以互换？

> ID：15304167
> 
> 赞同：1
> 
> 时间：2013-03-08T22:08:14.217
> 
> 标签：jpa, jpa-2.0

在 JPA 标准 API 中，`Root`s 可以互换吗？

也就是说，如果我正在准备两个`CriteriaQuery`实例，并且如果我在其中一个上执行此操作：

```
final Root<X> root = query.from(X.class); 
```

...然后我可以`Root`在与第二个查询交互时使用该实例吗？

我想以`WHERE`这种方式以编程方式构建一个子句，然后在两个查询中使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T19:34:24.607

`Root`s 是不可互换的，尽管 JPA 规范没有明确指出这一点。

# extjs4.1 - 手动/动态地将数据加载到树形面板中？

> ID：15304170
> 
> 赞同：1
> 
> 时间：2013-03-08T22:08:31.480
> 
> 标签：extjs4.1, treepanel

在 ExtJs3 中，我的团队执行以下操作将数据加载到树存储中。在 ExtJS4 中执行此操作的等效方法是什么？当我使用 NodeInterface 执行类似代码时，我收到“无法读取 null 的属性 '0'”错误。

```
Ext.Ajax.request({
            url: servlet,
            success: function(response, opts)
            {
                var jsonData = Ext.decode(response.responseText);

                var root = new Ext.tree.AsyncTreeNode({
                    text: 'Root test',
                    draggable: false,
                    id: 'root',
                    children: jsonData.tree.data
                });
                tree.setRootNode(root);
//... 
```

更新：我真的不在乎如何完成这项工作。我只有两个要求：（1）使用单个服务器请求来获取*不相关*的数据。(2) 针对不同的数据重用树形面板和网格面板

我已经能够将数据加载到动态创建的树形面板中。但是，使用 setRootNode() 不适用于现有的树面板。

```
//this works
var tree = Ext.create('Ext.tree.Panel', {
          root: {
                text:'Application',
                expanded:true,
                children: jsonResponse.categoryTree.data
          }
        });

//this doesn't work
existingTree.setRootNode(root); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T15:11:27.167

到目前为止，“足够好”的解决方案是

1.  将树面板变成一个类

每次数据变化：

1.  删除树面板的前一个实例（如果有）
2.  实例化一个新的树面板

不是“Ext JS 4”的方式，但它完成了工作。除非有人能用正确的做事方式启发我，否则我将其标记为答案。

```
 var panel = Ext.ComponentQuery.query('panel#categorysearch')[0];

                //destroy the tree panel
                panel.remove('categorysearchtree', true);

                //create a new one
                var tree = Ext.create('MyApp.view.CategorySearchTreePanel', {
                    root: {
                        text:'Services', 
                        expanded:true,
                        children: jsonResponse.categoryTree.data
                    }
                });

                panel.add(tree); 
```

# ruby-on-rails - 在 Hartls rails tutorial ch 上获取 Rspec 测试失败。6

> ID：15304171
> 
> 赞同：1
> 
> 时间：2013-03-08T22:08:31.697
> 
> 标签：ruby-on-rails, rspec, railstutorial.org

我遇到了这些失败，我不知道在哪里寻找解决问题的方法。我搜索了这个网站，找不到其他有我的问题的人。根据 Hartl 教程，所有测试都应该通过。

失败：

```
 C:\Sites\rails_projects\sample_app>bundle exec rspec spec
Rack::File headers parameter replaces cache_control after Rack 1.5.
←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m
←[32m.←[0m←[32m.←[0m←[32m.←[0m←[31mF←[0m←[31mF←[0m←[31mF←[0m←[31mF←[0m←[31mF←[0m
←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m←[32m.←[0m
←[32m.←[0m←[31mF←[0m←[31mF←[0m←[31mF←[0m←[32m.←[0m←[32m.←[0m

Failures:

  1) when email address is already taken
     ←[31mFailure/Error:←[0m ←[31muser_with_same_email = @user.dup←[0m
     ←[31mTypeError:←[0m
       ←[31mcan't dup NilClass←[0m
←[36m     # ./spec/models/user_spec.rb:104:in `dup'←[0m
←[36m     # ./spec/models/user_spec.rb:104:in `block (2 levels) in <top (require
d)>'←[0m

  2) when name is too long
     ←[31mFailure/Error:←[0m ←[31mbefore { @user.name = "a" * 51 }←[0m
     ←[31mNoMethodError:←[0m
       ←[31mundefined method `name=' for nil:NilClass←[0m
←[36m     # ./spec/models/user_spec.rb:76:in `block (2 levels) in <top (required
)>'←[0m

  3) when password is not present
     ←[31mFailure/Error:←[0m ←[31mbefore { @user.password = @user.password_confi
rmation = " " }←[0m
     ←[31mNoMethodError:←[0m
       ←[31mundefined method `password_confirmation=' for nil:NilClass←[0m
←[36m     # ./spec/models/user_spec.rb:55:in `block (2 levels) in <top (required
)>'←[0m

  4) when password confirmation is nil
     ←[31mFailure/Error:←[0m ←[31mbefore { @user.password_confirmation = nil }←[
0m
     ←[31mNoMethodError:←[0m
       ←[31mundefined method `password_confirmation=' for nil:NilClass←[0m
←[36m     # ./spec/models/user_spec.rb:65:in `block (2 levels) in <top (required
)>'←[0m

  5) when email format is valid should be valid
     ←[31mFailure/Error:←[0m ←[31m@user.email = valid_address←[0m
     ←[31mNoMethodError:←[0m
       ←[31mundefined method `email=' for nil:NilClass←[0m
←[36m     # ./spec/models/user_spec.rb:97:in `block (3 levels) in <top (required
)>'←[0m
←[36m     # ./spec/models/user_spec.rb:96:in `each'←[0m
←[36m     # ./spec/models/user_spec.rb:96:in `block (2 levels) in <top (required
)>'←[0m

  6) when password doesn't match confirmation
     ←[31mFailure/Error:←[0m ←[31mbefore {@user.password_confirmation = "mismatc
h" }←[0m
     ←[31mNoMethodError:←[0m
       ←[31mundefined method `password_confirmation=' for nil:NilClass←[0m
←[36m     # ./spec/models/user_spec.rb:60:in `block (2 levels) in <top (required
)>'←[0m

  7) when name is not present
     ←[31mFailure/Error:←[0m ←[31mbefore { @user.name = " " }←[0m
     ←[31mNoMethodError:←[0m
       ←[31mundefined method `name=' for nil:NilClass←[0m
←[36m     # ./spec/models/user_spec.rb:71:in `block (2 levels) in <top (required
)>'←[0m

  8) when email format is invalid should be invalid
     ←[31mFailure/Error:←[0m ←[31m@user.email = invalid_address←[0m
     ←[31mNoMethodError:←[0m
       ←[31mundefined method `email=' for nil:NilClass←[0m
←[36m     # ./spec/models/user_spec.rb:87:in `block (3 levels) in <top (required
)>'←[0m
←[36m     # ./spec/models/user_spec.rb:86:in `each'←[0m
←[36m     # ./spec/models/user_spec.rb:86:in `block (2 levels) in <top (required
)>'←[0m

Finished in 2.42 seconds
←[31m30 examples, 8 failures←[0m

Failed examples:

←[31mrspec ./spec/models/user_spec.rb:109←[0m ←[36m# when email address is alrea
dy taken ←[0m
←[31mrspec ./spec/models/user_spec.rb:77←[0m ←[36m# when name is too long ←[0m
←[31mrspec ./spec/models/user_spec.rb:56←[0m ←[36m# when password is not present
 ←[0m
←[31mrspec ./spec/models/user_spec.rb:66←[0m ←[36m# when password confirmation i
s nil ←[0m
←[31mrspec ./spec/models/user_spec.rb:94←[0m ←[36m# when email format is valid s
hould be valid←[0m
←[31mrspec ./spec/models/user_spec.rb:61←[0m ←[36m# when password doesn't match
confirmation ←[0m
←[31mrspec ./spec/models/user_spec.rb:72←[0m ←[36m# when name is not present ←[0
m
←[31mrspec ./spec/models/user_spec.rb:82←[0m ←[36m# when email format is invalid
 should be invalid←[0m 
```

我的 user_spec.rb 文件：

```
 require 'spec_helper'

describe User do

  before do
    @user = User.new(name: "Example User", email: "user@example.com",
      password: "foobar", password_confirmation: "foobar")
  end

  subject { @user }

  it { should respond_to(:name) }
  it { should respond_to(:email) }
  it { should respond_to(:password_digest) }
  it { should respond_to(:password) }
  it { should respond_to(:password_confirmation) }
  it { should respond_to(:authenticate) }

  it { should be_valid }

  describe "with a password that's too short" do
    before { @user.password = @user.password_confirmation = "a" * 5 }
    it { should be_invalid }
  end

  describe "return value of authenticate method" do
    before { @user.save }
    let(:found_user) { User.find_by_email(@user.email) }

  describe "with valid password" do
      it { should == found_user.authenticate(@user.password) }
    end

  describe "with invalid password" do
      let(:user_for_invalid_password) { found_user.authenticate("invalid") }

      it { should_not == user_for_invalid_password }
      specify { user_for_invalid_password.should be_false }
    end
  end
end

  describe "when password is not present" do
    before { @user.password = @user.password_confirmation = " " }
    it {should_not be_valid}
  end

  describe "when password doesn't match confirmation" do
    before {@user.password_confirmation = "mismatch" }
    it { should_not be_valid }
  end

  describe "when password confirmation is nil" do
    before { @user.password_confirmation = nil }
    it { should_not be_valid }
  end

  describe "when name is not present" do
    before { @user.name = " " }
    it { should_not be_valid } 
   end

  describe "when name is too long" do
    before { @user.name = "a" * 51 }
    it { should_not be_valid }
  end

    describe "when email format is invalid" do

    it "should be invalid" do

      addresses = %w[user@foo,com user_at_foo.org example.user@foo.
                     foo@bar_baz.com foo@bar+baz.com]
      addresses.each do |invalid_address|
        @user.email = invalid_address
        @user.should_not be_valid
      end      
    end
  end

  describe "when email format is valid" do
    it "should be valid" do
      addresses = %w[user@foo.COM A_US-ER@f.b.org frst.lst@foo.jp a+b@baz.cn]
      addresses.each do |valid_address|
        @user.email = valid_address
        @user.should be_valid
      end      
    end
  end
  describe "when email address is already taken" do
    before do
      user_with_same_email = @user.dup
      user_with_same_email.email = @user.email.upcase
      user_with_same_email.save
    end

        it { should_not be_valid}
    end
  end 
```

用户.rb 文件：

```
class User < ActiveRecord::Base
  attr_accessible :name, :email, :password, :password_confirmation
  has_secure_password

  before_save { |user| user.email = email.downcase }

  validates :name, presence: true, length: { maximum: 50 }
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence:   true,
                    format:     { with: VALID_EMAIL_REGEX },
                    uniqueness: { case_sensitive: false }
  validates :password, presence: true, length: { minimum: 6 }
  validates :password_confirmation, presence: true
end 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T14:48:24.493

可能是您似乎在使用两个额外的 s`describe User`后意外关闭了您的块。`describe "with invalid password"``end`

目前：

```
describe User do

  # ...
  describe "with invalid password" do
      let(:user_for_invalid_password) { found_user.authenticate("invalid") }

      it { should_not == user_for_invalid_password }
      specify { user_for_invalid_password.should be_false }
    end
  end
end

# ...

end 
```

应该：

```
describe User do

  # ...
  describe "with invalid password" do
    let(:user_for_invalid_password) { found_user.authenticate("invalid") }

    it { should_not == user_for_invalid_password }
    specify { user_for_invalid_password.should be_false }    
  end

  # ...
end 
```

`end`此外，请检查文件末尾的缩进和 s 数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:36:36.430

错误消息告诉我们@user 永远不会被实例化

看起来你错过了`:each`之后`before`

```
before do
    @user = User.new(name: "Example User", email: "user@example.com",
      password: "foobar", password_confirmation: "foobar")
end 
```

应该：

```
before (:each) do
    @user = User.new(name: "Example User", email: "user@example.com",
      password: "foobar", password_confirmation: "foobar")
end 
```

现在应该创建@user 对象并且测试变为绿色:)

# javascript - 使用 URL 更改链接（URL 链接中的 html 标记）

> ID：15304173
> 
> 赞同：0
> 
> 时间：2013-03-08T22:08:38.587
> 
> 标签：javascript, jquery, url

我正在尝试编写一个脚本，情况如下： 1\. 有人点击电子邮件中的链接，例如：[http](http://www.domain.com/page/?e=email@usersemail.com) ://www.domain.com/page/?e=email@usersemail.com 2\. 当他们登陆页面，它检测到 URL 有一个与之关联的电子邮件地址，并删除现有的 href 并使用带有新链接的 onclick 功能。（我尝试替换 href 属性，但没有奏效）

这是我的代码：

```
$(function(){
    var channel = 'default';
    var url = window.location.href;

    if(url.match(/e=(.*)/)) {
        channel = url.match(/e=(.*)/)[1];
        changeLinks(channel);
    }
});

function changeLinks(channel) {
    var beforeURL = 'http://www.differentdomain.com/emailcheck.aspx?FormName=1881&e=<spanclass=emailclass>';

    var afterURL = '</span>&url=https://www.domain.com/order-page#us&page=us';

    $('a.LinkClicked').removeAttr('href');
    $("a.LinkClicked").click(function() {
        window.open(beforeURL + channel + afterURL);
    }); 
```

HTML 很简单：

```
<a class="LinkClicked" href="/order-page/">Link</a> 
```

现在的问题是，一旦单击，标签就不会加载到 URL 中。另外，这个页面是一个aspx页面，有区别吗？

最终结果应该是使用链接打开一个新页面，基于用户的电子邮件地址（因此电子邮件每次都会有所不同，具体取决于用户）：

```
http://www.differentdomain.com/emailcheck.aspx?FormName=1881&e=<spanclass=emailclass>email@usersemail.com</span>&url=https://www.domain.com/order-page#us&page=us 
```

# c++ - C++ 动态转换

> ID：15304179
> 
> 赞同：2
> 
> 时间：2013-03-08T22:09:07.640
> 
> 标签：c++, inheritance, dynamic, polymorphism

我有一个提供给我的主要抽象类，并且必须基于该类创建子类（不能修改）：

```
class Spaceship
{
  protected:
    string m_name;      // the name of the ship
    int m_hull;         // the hull strenght
  public:

    // Purpose: Default Constructor
    // Postconditions: name and hull strength set to parameters
    // -- INLINE
    Spaceship(string n, int h)
    {
      m_name = n;
      m_hull = h;
    }

    // Purpose: Tells if a ship is alive.
    // Postconditions: 'true' if a ship's hull strength is above zero,
    //                 'false' otherwize.
    // -- INLINE
    bool isAlive()
    {
      return (m_hull > 0);
    }

    // Purpose: Prints the status of a ship.
    // -- VIRTUAL
    virtual void status() const = 0;

    // Purpose: Changes the status of a ship, when hit by a
    //    weapon 's' with power level 'power'
    // -- VIRTUAL
    virtual void hit(weapon s, int power) = 0;

    string getName() const
    {
      return m_name;
    }

}; //Spaceship 
```

所以是我的孩子班的一个例子：

```
class Dreadnought: public Spaceship
{
  int m_shield;
  int m_armor;
  int m_type;
  public:
    Dreadnought( string n, int h, int a, int s ): Spaceship( n, h ),m_shield( s ),m_armor(a),m_type(dreadnought){}
    virtual void status() const
    {
      // implementation not shown to save space
    }
    virtual void hit(weapon s, int power)
    {
      // implementation not shown to save space
    }

    int typeOf(){ return m_type; }
}; 
```

在我的主要代码中，我有一个不同类型的宇宙飞船的动态数组：

```
Spaceship ** ships;

cin >> numShips;

// create an array of the ships to test
ships = new Spaceship * [numShips]; 
```

然后我从用户那里得到输入来在这个数组中声明不同类型的船，比如：

```
ships[0] = new Dreadnought( name, hull, armor, shield ); 
```

我的问题是，当我去删除数组时，没有调用正确的析构函数，而是调用了 Spaceships，这是否会造成内存泄漏，因为成员变量“m_shield，m_armor”没有被删除并挂起？如果是这样，有没有比使用 var m_type 和调用更好的方法来获取类型：

```
if( ships[i]->typeOf() == 0 )
      delete dynamic_cast<Frigate*>(ships[i]);
    else if( ships[i]->typeOf() == 1 )
      delete dynamic_cast<Destroyer*>(ships[i]);
    else if( ships[i]->typeOf() == 2 )
      delete dynamic_cast<Battlecruiser*>(ships[i]);
    else if( ships[i]->typeOf() == 3 )
      delete dynamic_cast<Dreadnought*>(ships[i]);
    else
      delete dynamic_cast<Dropship*>(ships[i]); 
```

我声明的 Spaceship 类中的问题 #2：virtual int typeOf() = 0; 并将其注释掉，有没有一种方法可以在子类中实现这个函数而不在父类中声明，这样我就可以像上面显示的那样使用它？当我不声明它时，我得到编译器错误：

错误：'class Spaceship' 没有名为 'typeOf' 的成员

我认为这再次与动态套管有关。

任何帮助都会很棒，

谢谢纳特

编辑：

为了澄清我的第一个问题，如果我这样做了，我会不会有内存泄漏：

删除船舶[i]；

还是我应该这样做：

删除 dynamic_cast(ships[i]);

删除仅在派生类中的成员变量？

纳克斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T22:12:33.367

您必须向您的`Spaceship`类添加一个虚拟析构函数。然后`delete`将正确地销毁数组中的元素。

您必须`typeOf()`在`Spaceship`. 否则，编译器无法知道这是一个有效的成员函数。

`typeOf()`如果在基类中添加所需的功能作为虚拟成员函数，则可以避免。

即使您出于某种原因无法修改基类，您也可以进行`dynamic_cast`并测试，如果它产生一个空指针

```
Frigate *p = dynamic_cast<Frigate*>(ships[i]);
if (p != 0) {
    // do something with a frigate
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-08T22:13:26.733

只需`virtual`在类中声明一个析构函数`Spaceship`，您就可以`delete`通过指向基类的指针对对象进行多态化：

```
class Spaceship
{
    virtual ~Spaceship() { }
//  ^^^^^^^
//  Allows destroying instances of derived classes by deleting
//  pointers of type Spaceship*.

    ...
}; 
```

这将允许您避免使用`dynamic_cast<>`s 和`typeOf()`函数（如果这是您需要的）：

```
delete ships[i]; 
```

更好的是，您应该考虑使用智能指针（例如`std::shared_ptr<>`）并`std::vector<>`完全**避免手动内存管理**：

```
#include <memory>
#include <vector>

std::vector<std::shared_ptr<Spaceship>> ships;
ships.push_back(std::make_shared<Dreadnough>(name, hull, armor, shield));
std::string s = ships[0]->getName();

// ...
// And you don't need to delete anything
// ... 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-08T22:14:11.083

1.  您应该简单地提供一个虚拟析构函数：

    ```
    virtual ~Spaceship() { } 
    ```

    然后在通过`Spaceship*`.

2.  如果您想`typeOf`通过 a 被调用，`Spaceship*`那么它必须是该类的虚拟成员。

关于这两个问题，重要的是要了解`virtual`编译器的确切信息。当您`Spaceship*`指向一个`Dreadnought`对象时，`Spaceship`是通过该指针访问时对象的*静态类型*`Dreadnought`，并且是*动态类型*。当您通过 a 调用成员函数`Spaceship*`并且编译器发现它是`virtual`时，它就会知道查找对象的*动态类型*以找出它应该真正调用哪个函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-08T22:42:45.917

首先，请注意“（无法修改）”是一个不好的信号。这意味着这个答案将是一个黑客。

您需要做的是构建自己的手动类型系统。构建从`typeid`（好吧，我会使用`typeid().hash()`）到调用相关子类的析构函数的销毁函数的映射。

这不适合胆小的人，而且是一个非常糟糕的主意。正确的答案是“使用虚拟析构函数”。

类似的技术可用于创建假虚拟函数，您可以在其中维护自己的外部和手动“假虚拟函数表”，将实例的 typeid 映射到表中的条目。您甚至可以通过明智地使用 CRTP 来实现这些假虚拟函数的假继承（您可以在其中手动构建基于 off 的继承树`typeid().hash()`，然后手动搜索假虚拟函数映射以按照您想要的任何顺序检查父级）。

在这一点上，你基本上在做的是实现你自己的对象系统。除非您知道自己在做什么，否则这不是您应该做的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-08T22:11:42.777

问题1：实际上你不应该有内存泄漏。

这就是为什么你总是将析构函数声明为虚拟的。

即使你删除了一个指向 dreadnought 的飞船指针，dreadnoughts 的析构函数也会被调用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-08T22:13:50.387

这是继承层次结构中的一个典型陷阱，当您从基类派生并打算使用多态性进行删除时，您绝对需要一个[虚拟析构函数。](https://stackoverflow.com/questions/461203/when-to-use-virtual-destructors)

我还建议您转向[智能指针](http://www.boost.org/libs/smart_ptr/shared_ptr.htm)，而不是自己处理分配和释放。它基本上以简洁安全的方式为您完成所有这些工作。

就问题2而言，不，你不能。如果您希望能够调用基类上的函数，则基类必须公开它。这就是多态性的全部意义：您不关心在您处理的任何派生类中该操作是如何实际实现的，但您希望所有类都具有相同的接口。因此，您必须定义该接口以使其对外部世界可用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-09T01:22:44.777

问题 1：如果任何派生类或其成员具有非平凡（已定义）析构函数，您可能会发生内存泄漏。基本上，如果派生类及其成员在销毁时什么都不做，那么您就不会发生内存泄漏。但是，如果为 Spaceship 类重载了 delete 运算符，您可能会得到未定义的行为。

问题 2：不，您不能在没有方法的类上调用方法（宇宙飞船上的 typeOf）。

如果派生类或其成员具有重要的析构函数，则应定义一个公开派生自 Spaceship 并具有虚拟析构函数的新类。从新类派生的类被正确销毁。

或者，您可以为每种类型的宇宙飞船保留一个数组。这也将避免对任何虚拟方法的需要。

# php - 在 PHP/Codeigniter 中使用 node.js 和 socket.io 的实时评论系统

> ID：15304180
> 
> 赞同：1
> 
> 时间：2013-03-08T22:09:16.573
> 
> 标签：php, node.js, codeigniter, websocket, socket.io

我想澄清一个我的疑问。目前我正在开发一个 php-codeigniter 项目，我需要为经过身份验证的用户显示提要/评论。所以这是我的架构：

1.  第一次当主页加载时，所有与特定用户相关的提要/评论都是使用 PHP/codeigniter 应用程序服务器从数据库中获取的。
2.  之后，前端与 PHP/Codeigniter 应用服务器通信以使用 AJAX 在自动加载时获取更多消息，即当用户向下滚动页面时，会从服务器获取更多消息。
3.  **最后，使用socket.io使用****node.js**服务器实时访问新添加的消息。

 **所以我只是想澄清一下在你的主页上显示提要/评论是否是一个很好的架构，或者可以进行任何更改以使其更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:23:45.273

根据您的网站可能获得的流量，您可能希望使用像 MongoDB 这样的 NoSQL 数据库，您可以从 PHP 和 Node.js 访问它。

对于简单的文本数据（如评论），您可能不一定需要像 MySQL 这样的关系数据库。

您可能必须围绕 PHP 的 MongoDB 驱动程序/功能编写自己的库包装器，但这是可行的。

只要您有一个用于持久化提要/评论数据的数据库，就不会有任何不一致的问题。

听起来像一个有趣的项目！**

# android - 如何访问 doInBackground AsyncTask 中的 SharedPreferences？

> ID：15304186
> 
> 赞同：1
> 
> 时间：2013-03-08T22:10:00.247
> 
> 标签：android, android-asynctask

当我想访问里面的**SharedPreferences**`doInBackground`时遇到问题。我怎样才能做到这一点？

真的谢谢！

```
private class postData extends AsyncTask<String, Void, String> {
  @Override
  protected String doInBackground(String... params) {

    // I need to access here to my SharedPreferences //

  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:22:07.497

解决方案比我想象的要容易。

```
private class postData extends AsyncTask<String, Void, String> {
  @Override
  protected String doInBackground(String... params) {
    SharedPreferences sharedPrefs = PreferenceManager.getDefaultSharedPreferences(getApplicationContext() );    
    String userName = sharedPrefs.getString("auth_username", "");
    String userPass = sharedPrefs.getString("auth_password", "");
  }
} 
```

# objective-c - 无法引用数组内部的 int

> ID：15304188
> 
> 赞同：1
> 
> 时间：2013-03-08T22:10:11.767
> 
> 标签：objective-c, cocos2d-iphone

我正在尝试将一个 int 插入到数组编号中，但它不起作用。

```
int middlePointx[3] = {
    350, 400, 460
};
int imHere = 0;
 imHere = 0;
joystick1.position = ccp(middlePointx[imHere].x,startingPoint1.y); 
```

我得到一个成员引用基类型 int 不是结构或联合

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:14:57.777

相反，您的问题是您*正在*引用一个 int，但您的代码试图将其视为一个点。

表达式`middlePointx[0]`给出了值`350`——这是数组的第一个元素`middlePointx`。所以表达式`middlePointx[imHere].x`等价于`350.x`。你知道这是哪里出了问题吗？整数 350 不是 CGPoint——它没有`x`成员。

我想你只是想要`middlePointx[imHere]`，根本没有会员访问权限。

# android - 为 Android 移动应用程序自签名证书是否会导致发布者显示为 UNKNOWN？

> ID：15304189
> 
> 赞同：2
> 
> 时间：2013-03-08T22:10:15.950
> 
> 标签：android, code-signing, digital-certificate, certificate-authority

Android 要求移动应用程序使用证书进行数字签名，有两种方式 - (1) 自签名证书和 (2) 由第 3 方证书颁发机构获取签名证书。[此链接](http://www.adobe.com/devnet/air/articles/packaging-air-apps-android.html)显示，“使用自签名证书时，应用程序发布者将显示为 UNKNOWN。” 这是真的吗？如果是，“未知”发布者会出现在应用程序或其他任何地方的什么位置？如果应用程序是自签名的，用户是否必须确认任何其他确认弹出窗口？

谢谢，苏曼思。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T03:31:50.240

自签名证书没有警告或弹出对话框。据我所知，未知不会出现在任何地方。我只是想知道为什么那个景象会这么说。根据谷歌的说法，它什么也没做。

引用自：http: [//developer.android.com/tools/publishing/app-signing.html](http://developer.android.com/tools/publishing/app-signing.html)

# entity-framework - 实体框架代码优先和显式接口

> ID：15304192
> 
> 赞同：3
> 
> 时间：2013-03-08T22:10:28.550
> 
> 标签：entity-framework, ef-code-first

这是我要完成的工作：

有些实体应该被“软删除”，所以我想添加一个名为“IsDeleted”的字段（和相应的列）。我希望这个属性只能由 DAL 访问（这可以通过朋友程序集来完成）。如果 DAL 可以通过接口 (IDeletable) 以相同的方式对待所有这些实体，我也很高兴。

为了实现这两个目标，我可以让 IDeletable 成为一个内部接口，并且在实现这个接口的类中我可以使用显式接口：

```
bool IDeletable.IsDeleted { get; set; } 
```

DAL 代码可能看起来像这样：

```
public void Delete<T>(T entity)
{
    var d = entity as IDeletable;
    if(d != null)
       //soft delete
       d.IsDeleted = true;
    else
       //hard delete

    //....
 } 
```

问题是，据我所知，EF Code First 无法生成列。我尝试过使用表达式，但是当我尝试转换为 IDeletable 时它会抱怨。

有没有办法强制 EF Code First 创建列而不使用表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-28T14:00:05.950

首先，我将实现该属性并添加一个内部属性以供 EF 了解：

```
public class A : IDeletable
{
  bool IDeletable.IsDeleted
  {
    get { return this.IsDeleted; }
    set { this.IsDeleted = value; }
  }

  internal bool IsDeleted { get; set; }
}
```

其次，我会扩展**`DbSet<TEntity>`**：

```
public class SmartDbSet<TEntity> : DbSet<TEntity>
{
  public override TEntity Remove(TEntity entity)
  {
    if (entity == null)
      throw //[your favorite exception]

    if (entity is IDeletable)
      (entity as IDeletable).IsDeleted = true;
    else
      base.Remove(entity);

    return entity;
  }
}
```

最后你的 DbContext 看起来像这样：

```
public class MyDbContext : DbContext
{
  public SmartDbSet<A> As { get; set; }

  protected override void OnModelCreating(DbModelBuilder builder)
  {
    //this is your internal property, NOT the explicit one
    builder.Entity<A>().Property(t => t.IsDeleted);
  }
} 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-08T22:39:18.000

我不太确定你的意思是什么 EF 不会创建没有表达式的列，但是这里有一个你想要实现的工作示例。

```
class Program
    {
        static void Main(string[] args)
        {
            using (var ctx = new MyContext())
            {
                var a = new A { IsDeleted = false };
                var b = new B { };
                ctx.As.Add(a);
                ctx.Bs.Add(b);
                ctx.SaveChanges();

                ctx.Delete(a);
                ctx.Delete(b);
            }
            // At this point A is soft deleted and B is permanantly deleted
            Console.ReadLine();
        }
    }

    public class MyContext : DbContext
    {
        public DbSet<A> As { get; set; }
        public DbSet<B> Bs { get; set; }

        public void Delete<T>(T entity) where T:class
        {
            var d = entity as IDeletable;
            if (d != null)
            {
                //soft delete
                d.IsDeleted = true;
            }
            else
            {
                //Use ugly delete as we dont know the dbset this applies to
                this.Entry(entity).State = System.Data.EntityState.Deleted;
            }
            this.SaveChanges();
        }
    }

    public interface IDeletable
    {
        bool IsDeleted { get; set; }
    }

    public class A : IDeletable
    {
        public int Id { get; set; }
        //Implementing this interface adds a column to this entity (no issues here?)
        public bool IsDeleted { get; set; }
    }

    public class B
    {
        public int Id { get; set; }
    } 
```

# zend-framework2 - zend2 路由分页器和模块

> ID：15304193
> 
> 赞同：0
> 
> 时间：2013-03-08T22:10:30.983
> 
> 标签：zend-framework2, zend-paginator, zend-controller-router

我遇到了 Zend Framework 2 Router 对象的问题。我正在尝试实现`Zend\Paginator`快速入门路由机制示例但没有成功。让我解释：

遵循快速入门后，我以这样的方式结束：

```
'album' => array(
    'type'    => 'Segment',
    'options' => array(
        'route' => '/album[/:action][/:id]',
        'constraints' => array(
            'action' => '[a-z][a-z0-9\-]*',
            'id' => '[0-9]+'
        ),
        'defaults' => array(
            'controller' => 'Album',
            'action' => 'index'
        )
    )
) 
```

当我尝试为我的浏览/索引页面实现分页器时，问题就出现了。假设我需要一个这样的路由器是`/album[/:action][/:id][/:page]`行不通的，因为路由器将`:page`var 分配给`:id`. 我删除了`:id`以类似内容结尾的部分，`/album[/:action][/:page]`并在我的添加/编辑操作中调用

```
$matches = $this->getEvent()->getRouteMatch();
$id = $matches->getParam('page'); 
```

工作没有问题，但我喜欢事情保持记忆。所以我的问题是：是否有可能在不创建重复路由器的情况下仅让分页器看起来像我喜欢的那样来实现这一点？我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:55:13.750

它不够独特，以路线为例：

```
/album[/:action][/:id][/:page] 
```

id 和 page 是可选的，都可以是整数

如果我们尝试匹配这条路线：

/专辑/索引/99

99 可以匹配 id，页面不存在，也可以匹配页面，id 不存在。没有办法知道哪个是哪个，所以这行不通。

您可以添加一个标识符，如下所示：

```
/album[/:action][/id/:id][/:page] 
```

所以你会在那里有一个文字来确保你知道它是一个id：

```
/album/index/id/99 # :id = 99 
```

或 /album/index/99 # :page = 99

# mysql - 从纬度/经度获取邮政编码

> ID：15304198
> 
> 赞同：2
> 
> 时间：2013-03-08T22:10:39.250
> 
> 标签：mysql, location

我有一个控件，允许用户输入邮政编码或在 iframe 中打开谷歌地图，然后单击地图以选择位置。我目前所有这些都正常工作，iframe 会将点击事件中的纬度/经度发送回父级。

我还设置了一个数据库表，其中经纬度字段映射到邮政编码。

但是，纬度/经度组合很可能永远不会完全匹配我在数据库中的条目。所以，我正在寻找匹配最近邮政编码的最佳方式。

因为用户有能力手动输入邮政编码，我并不完全担心精度（即如果用户点击邮政编码之间的边界），但我希望它尽可能接近。我现在只需要担心美国的位置。

我目前对解决方案的想法是提出一些容差（.2？）并在数据库中查询纬度/经度 +- 容差。然后从结果集中选择最接近的匹配项。

我很想听听以前做过这个或有比我提议的解决方案更好的解决方案的人的来信。我对使用服务不感兴趣，因为我拥有所需的所有数据。

我对我提出的解决方案的一个担忧是弄清楚什么是好的容忍度。这个项目是针对农村地区的，我不确定这些地区的纬度/经度条目有多分散。

编辑：这是我的表结构： zip5 | 城市| 状态 | 纬度 | 隆 | 县

zip5 是主键

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:38:25.787

一分钟的纬度（即 1/60 度）= 1 海里，或约 6,000 英尺。因此 5 分钟。纬度 = 约 30,000 英尺 = 约 6 英里。

经度向两极变窄，但如果我们将美国大陆视为北纬 36 度，请给予或接受（我同意，但对于此应用来说，近似值应该足够了），然后一分钟经度 ~ 1 海里 *因为 36 ~ 6,000 * 0.81 = 4,850 英尺。

由于邮政编码（或至少前 5 位数字）代表邮局，在农村地区，邮局可能相距 20-30 英里，因此您可能比使用大约 1/2 的经纬度网格做得更糟，或者说10分钟。纬度 x 12 分钟。经度。方便的分别是 1/6 度和 1/5 度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:43:10.170

您可能想放弃自己的数据库查找并使用已经执行此操作的 Web 服务，例如[GeoNames](http://www.geonames.org/export/ws-overview.html)。请参阅 SO 问题[Get zip code from latitude, longitude?](https://stackoverflow.com/questions/3564852/get-zip-code-from-latitude-longitude/3565614#3565614) 了解更多信息。看起来它已经做了你想做的事情，但没有所有的计算和公差。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T23:23:35.383

这个问题的典型解决方案使用 R-trees。

# php - PHP 变量 int 和 string，正确使用什么

> ID：15304201
> 
> 赞同：-1
> 
> 时间：2013-03-08T22:10:41.917
> 
> 标签：php, operators, int

有人可以解释一下，为什么：（如果我将 DB 字段设置为 int，如“1” - 此语句有效，但如果我将其设置为字符串 - 它不起作用。

作品：

```
if ( $results['page']->pageStatus != 1 ) {
header('Location: 404.html');} 
```

不起作用：

```
if ( $results['page']->pageStatus !== "active" ) {
header('Location: 404.html');} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:16:27.087

根据[文档](http://php.net/manual/en/language.operators.comparison.php)：

> 如果将数字与字符串进行比较或比较涉及数字字符串，则每个字符串都将转换为数字并以数字方式执行比较。这些规则也适用于 switch 语句。当比较是 === 或 !== 时不会发生类型转换，因为这涉及比较类型和值。

所以当你这样做时（我强烈怀疑它`$results['page']->pageStatus`是 type `string`）：

```
if ( $results['page']->pageStatus != 1 ) 
```

`$results['page']->pageStatus`转换为数字。在这种情况下，它转换为`0`. 并`0 != 1`评估为`true`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:22:09.700

您需要将表达式评估为真或假。将其更改为

`if ( !($results['page']->pageStatus == "active") ) { header('Location: 404.html');}`

# java - JavaFX 初始化方法中的 NullPointerException

> ID：15304203
> 
> 赞同：5
> 
> 时间：2013-03-08T22:10:47.257
> 
> 标签：java, nullpointerexception, javafx

我有控制器，我尝试从电子邮件服务器获取 INBOX 文件夹。下载一切正常。我可以将这些数据（电子邮件主题、发件人、日期）放入 TableView 但......只有当我等待负责在 TableView 中设置这些数据的线程时。代码：

```
// The table and columns
@FXML
TableView<MainModel.Item> itemTbl;
@FXML
TableColumn itemNameCol;
@FXML
TableColumn itemQtyCol;
@FXML
TableColumn itemTitleCol;
// The table's data
static ObservableList<MainModel.Item> data;

public void dataSet(){
    // Set up the table data
    itemNameCol.setCellValueFactory(
        new PropertyValueFactory<MainModel.Item,String>("name")
    );
    itemQtyCol.setCellValueFactory(
        new PropertyValueFactory<MainModel.Item,String>("qty")
    );
    itemTitleCol.setCellValueFactory(
        new PropertyValueFactory<MainModel.Item,String>("title")
    );

    data = FXCollections.observableArrayList();
    itemTbl.setItems(data);
}

public void setEnemyEvent() {
    itemTbl.addEventFilter(MouseEvent.MOUSE_CLICKED, new EventHandler<MouseEvent>() {
        @Override
        public void handle(MouseEvent event) {
            if (event.getClickCount() == 2) {
                if(itemTbl.getSelectionModel().getSelectedItem()!=null){
                    System.out.println(itemTbl.getSelectionModel().getSelectedItem().name);
                }
            }
        }
    });
}

@Override
public void initialize(URL url, ResourceBundle rb) { 
    setEnemyEvent();
    dataSet();
    Thread t = new Thread(new MessageLoop());
    //HERE:
    t.start();
    //of course normally here is try and catch
    t.join();
}

//staric nested class "for loop"
private static class MessageLoop implements Runnable {
    public void run() {
        try {
            EmailConnetion con = new EmailConnetion();
            MainModel MainModel = new MainModel();
            for(int i=0;i<con.message.length;i++){
                try{
                    MainModel.Item item = MainModel.new Item();
                    item.name.setValue(i+""+con.message[i].getFrom()[0].toString());
                    item.qty.setValue(con.message[i].getSentDate().toString());
                    item.title.setValue(con.message[i].getSubject().toString());
                    //Here is a problem.
                    data.add(item);//This indicate my IDE  
                    //*****************
                } catch(AddressException e) {
                    System.out.println("Error : " + "AddressException:"+i);
                }
            }
        } catch (NoSuchProviderException ex) {
            Logger.getLogger(SimpleController.class.getName()).log(Level.SEVERE, null, ex);
        } catch (MessagingException ex) {
            Logger.getLogger(SimpleController.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
} 
```

当我删除 t.join() 时，它会抛出这个 NullPointerException。

```
Exception in thread "Thread-3" java.lang.NullPointerException
    at com.sun.javafx.collections.ListListenerHelper$Generic.fireValueChangedEvent(ListListenerHelper.java:291)
    at com.sun.javafx.collections.ListListenerHelper.fireValueChangedEvent(ListListenerHelper.java:48)
    at com.sun.javafx.scene.control.ReadOnlyUnbackedObservableList.callObservers(ReadOnlyUnbackedObservableList.java:74)
    at javafx.scene.control.TableView$TableViewArrayListSelectionModel$3.onChanged(TableView.java:1725)
    at com.sun.javafx.collections.ListListenerHelper$SingleChange.fireValueChangedEvent(ListListenerHelper.java:134)
    at com.sun.javafx.collections.ListListenerHelper.fireValueChangedEvent(ListListenerHelper.java:48)
    at com.sun.javafx.collections.ObservableListWrapper.callObservers(ObservableListWrapper.java:97)
    at com.sun.javafx.collections.ObservableListWrapper.clear(ObservableListWrapper.java:184)
    at javafx.scene.control.TableView$TableViewArrayListSelectionModel.quietClearSelection(TableView.java:2154)
    at javafx.scene.control.TableView$TableViewArrayListSelectionModel.updateSelection(TableView.java:1902)
    at javafx.scene.control.TableView$TableViewArrayListSelectionModel.access$2600(TableView.java:1681)
    at javafx.scene.control.TableView$TableViewArrayListSelectionModel$8.onChanged(TableView.java:1802)
    at com.sun.javafx.scene.control.WeakListChangeListener.onChanged(WeakListChangeListener.java:71)
    at com.sun.javafx.collections.ListListenerHelper$Generic.fireValueChangedEvent(ListListenerHelper.java:291)
    at com.sun.javafx.collections.ListListenerHelper.fireValueChangedEvent(ListListenerHelper.java:48)
    at com.sun.javafx.collections.ObservableListWrapper.callObservers(ObservableListWrapper.java:97)
    at com.sun.javafx.collections.ObservableListWrapper.add(ObservableListWrapper.java:154)
    at com.sun.javafx.collections.ObservableListWrapper.add(ObservableListWrapper.java:144)
    at javasplitpane.SimpleController$MessageLoop.run(SimpleController.java:95)
    at java.lang.Thread.run(Thread.java:722) 
```

这出现在不同的位置，在十四封电子邮件，三十封电子邮件中。你有什么想法吗？

ps 我等不及下载了，因为它需要 20 秒。有 50 封电子邮件 - 我必须在初始化期间执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-09T01:56:03.797

**你的错误**

不要修改从除 JavaFX 应用程序线程之外的任何其他线程连接到活动场景图的任何内容。

**背景资料**

有关此规则的说明，请参阅[JavaFX 并发教程](http://docs.oracle.com/javafx/2/threads/jfxpub-threads.htm)以及[JavaFX Platform.runLater 的用法和从不同线程访问 UI 。](https://stackoverflow.com/questions/15160410/usage-of-javafx-platform-runlater-and-access-to-ui-from-a-different-thread/15160824#15160824)

由于您的数据列表是支持活动场景图中显示的[TableView的](http://docs.oracle.com/javafx/2/api/javafx/scene/control/TableView.html)[ObservableList](http://docs.oracle.com/javafx/2/api/javafx/collections/ObservableList.html)，因此当您修改 ObservableList 时，它会向 TableView 触发更改事件，从您的用户线程而不是 JavaFX 应用程序线程修改它 - 这会导致竞争条件和程序不一致失败。

**如何修复它**

要解决您的问题，请包装调用以更新[Platform.runLater](http://docs.oracle.com/javafx/2/api/javafx/application/Platform.html#runLater%28java.lang.Runnable%29)中的数据项：

```
Platform.runLater(new Runnable() {
  @Override public void run() {
    data.add(item);
  }
}); 
```

`run`提交到的方法的内容`Platform.runLater`在 JavaFX 应用程序线程上执行。

# visual-studio-2010 - 附加到进程 - Visual Studio 2010 - Windows 2008

> ID：15304206
> 
> 赞同：0
> 
> 时间：2013-03-08T22:10:55.223
> 
> 标签：visual-studio-2010, debugging, attach-to-process

我有一个在 localhost 上运行的网页，我想用它在 Visual Studio 2010 中的代码中进行断点。该网页在 Internet Explorer 中运行。操作系统是Windows 2008。当我在Visual Studio的调试菜单下附加到进程时，没有列出进程w3wp.exe。该网页托管在我用来开发的同一台机器上。网页运行时，Windows 2008 的进程中不应该列出 w3wp.exe 吗？附加到 Internet Explorer 进程不起作用。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:17:35.123

您是否以管理员身份运行 Visual Studio？w3wp.exe 进程可能使用与您的用户帐户不同的凭据运行。如果是这种情况，那么您将无法附加到该进程，并且必须以管理员身份运行 Visual Studio 才能进行调试

# c# - 获取和设置属性不会永久更改 c#，VS

> ID：15304210
> 
> 赞同：0
> 
> 时间：2013-03-08T22:11:19.587
> 
> 标签：c#, inheritance, properties, get, set

我正在 Visual Studio 中开发我的 c# pac-man 游戏。

我有一个主精灵类和一个名为 User 的子类。用户应在计算时设置 x 位置和 y 位置。

我的计时器做什么：

```
 pictureBox1.Focus();
 paper.Clear(Color.Transparent);
 user.moveUser(keyValue);//Code1 shown below
 sprite.DrawSprites(paper);//Code shown below
 pictureBox1.Image = bmp; 
```

这些方法背后的代码：

代码1：

```
public void moveUser(int mKeyValue)
    {

        switch (previousImage)
        {
            case false:

                switch (mKeyValue)
                {
                    case 39:
                        sprite.Image = imageArray[0];//left
                        sprite.XPos += stepsAmount;

                        break;
                    case 37:
                        sprite.Image = imageArray[1];//right
                        sprite.XPos -= stepsAmount;

                        break;
                    case 38:
                        sprite.Image = imageArray[2];//up
                        sprite.YPos -= stepsAmount;

                        break;
                    case 40:
                        sprite.Image = imageArray[3];//down
                        sprite.YPos += stepsAmount;

                        break;
                }
                previousImage = true;
                break;
            case true:
                switch (mKeyValue)
                {
                    case 39:
                        sprite.Image = imageArray[4];
                        break;
                    case 37:
                        sprite.Image = imageArray[5];
                        break;
                    case 38:
                        sprite.Image = imageArray[6];
                        break;
                    case 40:
                        sprite.Image = imageArray[7];
                        break;
                }
                previousImage = false;
                break;

        }
    } 
```

代码2：

```
 protected int xPos = 0, yPos = 0, size = 28;

    public Image Image
    {
        get { return image; }
        set { image = value; }
    }

    public int YPos
    {
        get { return yPos; }
        set { yPos = value; }
    }

    public int XPos
    {
        get { return xPos; }
        set { xPos = value; }
    }

 public void DrawSprites(Graphics drawArea)
    {
        drawArea.DrawImage(Image, xPos, yPos, size, size);
    } 
```

当我调试时，控制台运行 moveUser 方法，设置属性 Xpos、YPos 和 Image 被更改。但是当 drawSprites 方法运行时，这些变量返回 0 或原始分配的值。我需要永久更改它们，这样我才能移动我的小黄朋友。

注意：并非所有代码都已粘贴，只有需要的一个，如果您需要更多代码，请询问。

注 2：User 是 Sprite 的子类

谢谢你的时间

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:16:37.090

It does not magically goes back to 0.

You're most likely creating a new object instead of keeping the same one all the way. So the issue is not located in the code you posted, but in where you use / create / modify objects.

# android - 新版SDK使用支持库中的API时遇到困难

> ID：15304216
> 
> 赞同：0
> 
> 时间：2013-03-08T22:11:33.487
> 
> 标签：android, android-actionbar

当我将 minSDK 级别设置为 4 时，我正在阅读的内容以及发生的错误让我有点转身。您会认为，当生成平台的新版本时，它将与早期版本向后兼容; 因此，如果我在 SDK 17 中创建软件，则使用其功能将适用于使用早期版本（例如 4 或其他版本）的设备。但情况似乎并非如此。因为我买了一部运行 2.3.6 版的手机……我想确保我正在开发的软件可以在这个和其他旧设备上运行，以及新的操作系统。但似乎不能保证向后兼容性。那么，是否只是为更新的设备开发，或者有没有办法确保我在新环境中编写的内容可以在设备上运行而不必跳过一堆箍？我正在尝试使用支持库，但它似乎没有新版本的所有 api。可以以某种方式将所需的 API 导入支持库吗？如果是这样，你能给我指出一篇关于这样做的文章吗？

我正在尝试创建一个在操作栏中具有选项卡的应用程序，同时使用活动和片段，但我不断收到版本不匹配错误，说明“最低 SDK 级别为 4。它应该是 13”。

我很确定我可以让该应用程序适用于较新的设备，但我确信所有潜在用户都不会拥有新手机。因此，我正在寻求您对解决我认为是一个持续存在的问题的见解。

感谢您的见解。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:46:33.110

> 你会认为，当新版本的平台生成时，它会向后兼容早期版本；因此，如果我在 SDK 17 中创建软件，则使用其功能将在使用早期版本（例如 4 或其他任何版本）的设备上运行

API 级别 4 中存在的功能通常*存在*于 API 级别 17 中，支持这些功能的代码通常是向后兼容的。

但是，较新版本的 Android 具有*附加功能*。这些不一定是向后兼容的，因为根据定义，它们是更新的和附加的。

> 那么，一个人只是为更新的设备开发，还是有一种方法可以确保我在新环境中编写的内容可以在设备上运行，而不必跳过一堆麻烦？

可以肯定地开发适用于旧设备和新设备的应用程序。旧设备和新设备上存在的 API，您只需使用，通常没有问题。仅存在于较新设备上的 API，您必须注意不要尝试在旧设备上使用这些功能。有多种技术可以做到这一点，例如通过检查`Build.VERSION.SDK_INT`和跳过旧设备上的新 API 内容。

由于没有“跳过一堆箍”的规范定义，因此您需要自己决定。它确实要求您能够阅读文档，因为其中有很多关于如何构建向后兼容的应用程序的内容，例如[关于开发向后兼容 UI 的讨论](http://developer.android.com/training/backward-compatible-ui/index.html)。还有很多博客文章等涵盖向后兼容开发的特定方面，可通过您最喜欢的搜索引擎获得。

> 我正在尝试使用支持库，但它似乎没有新版本的所有 api

它不应该，也没有被宣传为有。它有一些东西的反向移植，但不是所有的东西。在某种程度上，这只是工程时间的问题。部分原因是有些东西不能向后移植，因为它们是对操作系统的核心更改，而不仅仅是框架类。

> 我正在尝试创建一个在操作栏中具有选项卡的应用程序，同时使用活动和片段，但我不断收到版本不匹配错误，说明“最低 SDK 级别为 4。它应该是 13”。

正如 abbath 所指出的，操作栏不是 Android 支持包的一部分，尽管[ActionBarSherlock](http://actionbarsherlock.com/)填补了这个角色。类似的反向移植可用于 Android 支持包中未找到的其他内容，并且可以在[AndroidViews.net](http://www.androidviews.net/)等网站上找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:25:50.730

ActionBar 是不久前推出的，这就是为什么您需要 API 级别 13 才能使用它。

如果你想使用带有标签的 ActionBar，但又想为更低的 sdk 版本开发，请尝试使用兼容库，例如[ActionBarSherlock](http://actionbarsherlock.com/)

# ms-access - Access 2013 是否还有 ACE 数据库或同等数据库？

> ID：15304220
> 
> 赞同：0
> 
> 时间：2013-03-08T22:12:08.213
> 
> 标签：ms-access, ms-office, ms-jet-ace, office-2013

Access 2013 是否需要使用单独的数据库（例如 SQL Server），或者它是否包含捆绑在文件中的 ACE 数据库或等效数据库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T08:53:39.520

包括现在称为 ACE 的 JET 的继任者。此版本的数据引擎继续支持和读取 mdb 或 accDB 文件。

它是基于文件的，我已经毫无问题地转换了 Access 2000 数据库。

ACE 数据库默认包含 DAO 引用。

所以没有变化，甚至 Access 97 应用程序在 2013 年也应该可以正常运行。

请注意，包含的 ACE 数据引擎现在具有表触发器和存储过程。它现在还可以将表链接到 SQL Server 的 SQL Azure（云）版本。

然而，在过去的 20 年里确实没有任何变化——它仍然像 JET 一样运行、感觉和看起来，并且不需要任何类型的服务器。

因此，您基本上仍在使用 DAO 对象模型，并且在使用 Access 时它仍然是首选。

所以不需要服务器，它的工作方式与过去 20 年一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:23:19.563

根据[维基百科](http://en.wikipedia.org/wiki/Microsoft_Access#Versions)，它仍然包括一个 Jet 数据库（Jet 版本 15）。

# jquery - Jquery 不会显示错误也不会验证

> ID：15304221
> 
> 赞同：-1
> 
> 时间：2013-03-08T22:12:10.030
> 
> 标签：jquery, validation

我一直试图让我的表单进行验证（没有 jquery 验证）。出于某种原因，代码没有剪切它，它实际上在我的本地环境中导致了一些 css 问题。

我实际上只是想验证四个字段并显示错误。

```
 required = ["id_first_name", "id_last_name", "id_firmbox", "id_job_title"];

        errornotice = $("#error");
        emptyerror = "Please fill out this field.";
        $("#startform").submit(function(){
            //Validate required fields
            for (i=0;i<required.length;i++) {
                var input = $('#'+required[i]);
                if ((input.val() == "") || (input.val() == emptyerror)) {
                    input.addClass("tobefixed");
                    input.val(emptyerror);
                    errornotice.fadeIn(750);
                } else {
                    input.removeClass("tobefixed");
                }
            }

            //if any inputs on the page have the class 'tobefixed' the form will not submit
            if ($(":input").hasClass("tobefixed")) {
                return false;
            } else {
                errornotice.hide();
                requiredeturn true;
            }
        });
        $(":input").focus(function(){
            if ($(this).hasClass("tobefixed") ) {
                $(this).val("");
                $(this).removeClass("tobefixed");
            }
        }); 
```

我在[这里做了一个小提琴](http://jsfiddle.net/8YgNT/11/)。也许其他人可以发现我做错了什么。（我为格式问题道歉。我使用的是 Ubuntu，一切都出了问题）。

非常感谢您的帮助，谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:14:46.773

您的代码中存在语法错误。

改变：

```
 if ($(":input").hasClass("tobefixed")) {
            return false;
        } else {
            errornotice.hide();
            requiredeturn true;
        } 
```

至：

```
 if ($(":input").hasClass("tobefixed")) {
        return false;
    } else {
        errornotice.hide();
        return true;
    } 
```

工作示例：http: [//jsfiddle.net/8YgNT/12/](http://jsfiddle.net/8YgNT/12/)

我还建议购买一个好的客户端调试器，例如 Firebug。此错误在其控制台中非常明显。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:15:16.393

如果你在 JavaScript 的控制台上看到，你会看到错误是由这个引起的：`requiredeturn true;`在这里：

```
 } else {
      errornotice.hide();
      requiredeturn true;
  } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T22:18:18.923

Very quickly, I can see the line `requiredeturn true;`

changing it in the jsFiddle makes it work.

[http://jsfiddle.net/mWYMf/](http://jsfiddle.net/mWYMf/)

# eclipse - 如何在 Eclipse 中关闭自动工作区构建？

> ID：15304224
> 
> 赞同：3
> 
> 时间：2013-03-08T22:12:44.023
> 
> 标签：eclipse, maven, workspace

我在 Mac 10.7.5 (Java 6) 上使用 Eclipse Juno。我有几个 Maven 项目导入到我的工作区中，尽管我的机器上有 10 GB 的内存，但我的 Eclipse 会话有时会在其“构建工作区”时停止。如何关闭自动工作区构建？如有必要，我会自己做，但就目前而言，它完全减慢了我惊人的编程速度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:16:59.310

On windows its untick "Project -> Build Automatically" if I understand you correctly. probably the same on Mac.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:16:32.440

`Project`->`Build Automatically`检查它是否禁用了菜单行旁边的勾号。

# python - 将 Python ElementTree 转换为字符串

> ID：15304229
> 
> 赞同：99
> 
> 时间：2013-03-08T22:13:28.137
> 
> 标签：python, xml, marshalling, elementtree

每当我打电话`ElementTree.tostring(e)`时，我都会收到以下错误消息：

```
AttributeError: 'Element' object has no attribute 'getroot' 
```

有没有其他方法可以将 ElementTree 对象转换为 XML 字符串？

追溯：

```
Traceback (most recent call last):
  File "Development/Python/REObjectSort/REObjectResolver.py", line 145, in <module>
    cm = integrateDataWithCsv(cm, csvm)
  File "Development/Python/REObjectSort/REObjectResolver.py", line 137, in integrateDataWithCsv
    xmlstr = ElementTree.tostring(et.getroot(),encoding='utf8',method='xml')
AttributeError: 'Element' object has no attribute 'getroot' 
```

* * *

## 回答 #1

> 赞同：137
> 
> 时间：2013-03-08T22:22:40.203

`Element`对象没有`.getroot()`方法。挂断那个电话，[`.tostring()`](https://docs.python.org/library/xml.etree.elementtree.html#xml.etree.ElementTree.tostring)电话就可以了：

```
xmlstr = ElementTree.tostring(et, encoding='utf8', method='xml') 
```

`.getroot()`仅当您有[`ElementTree`实例](https://docs.python.org/3/library/xml.etree.elementtree.html#xml.etree.ElementTree.ElementTree)时才需要使用。

其他注意事项：

*   这会产生一个*bytestring*，它在 Python 3 中就是`bytes`类型。
    如果你必须有一个`str`对象，你有两个选择：

    1.  从 UTF-8 解码得到的字节值：`xmlstr.decode("utf8")`

    2.  使用`encoding='unicode'`；这避免了编码/解码周期：

        ```
        xmlstr = ElementTree.tostring(et, encoding='unicode', method='xml') 
        ```

*   如果您想要 UTF-8 编码的字节字符串值或使用 Python 2，请考虑到 ElementTree 没有正确检测`utf8`为标准 XML 编码，因此它将添加一个`<?xml version='1.0' encoding='utf8'?>`声明。如果您想防止这种情况，请使用`utf-8`或（带破折号）。`UTF-8`不使用时`encoding="unicode"`添加声明头。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2018-02-07T19:07:25.303

### 如何转换`ElementTree.Element`为字符串？

对于 Python 3：

```
xml_str = ElementTree.tostring(xml, encoding='unicode') 
```

对于 Python 2：

```
xml_str = ElementTree.tostring(xml, encoding='utf-8') 
```

以下与 Python 2 和 3 兼容，但[仅适用于拉丁字符](https://stackoverflow.com/a/63943641/3357935)：

```
xml_str = ElementTree.tostring(xml).decode() 
```

* * *

### 示例用法

```
from xml.etree import ElementTree

xml = ElementTree.Element("Person", Name="John")
xml_str = ElementTree.tostring(xml).decode()
print(xml_str) 
```

输出：

```
<Person Name="John" /> 
```

* * *

### 解释

尽管顾名思义，[`ElementTree.tostring()`](https://docs.python.org/3/library/xml.etree.elementtree.html#xml.etree.ElementTree.tostring)在 Python 2 和 3 中默认返回一个字节串。这是 Python 3 中的一个问题，它[使用 Unicode 作为字符串](https://medium.com/better-programming/strings-unicode-and-bytes-in-python-3-everything-you-always-wanted-to-know-27dc02ff2686)。

> **在 Python 2 中，您可以将`str`类型用于文本和二进制数据**。不幸的是，两种不同概念的这种融合可能导致脆弱的代码，有时对任何一种数据都有效，有时则不然。[...]
> 
> 为了使文本和二进制数据之间的区别更加清晰和明显，**[Python 3] 使文本和二进制数据成为不能盲目混合在一起的不同类型**。

^(资料来源：[*将 Python 2 代码移植到 Python 3*](https://docs.python.org/3/howto/pyporting.html#text-versus-binary-data))

如果我们知道正在使用哪个版本的 Python，我们可以将编码指定为`unicode`或`utf-8`。否则，如果我们需要同时兼容 Python 2 和 3，我们可以使用[`decode()`](https://docs.python.org/3/library/stdtypes.html#bytes.decode)转换为正确的类型。

作为参考，我包含了`.tostring()`Python 2 和 Python 3 之间的结果比较。

```
ElementTree.tostring(xml)
# Python 3: b'<Person Name="John" />'
# Python 2: <Person Name="John" />

ElementTree.tostring(xml, encoding='unicode')
# Python 3: <Person Name="John" />
# Python 2: LookupError: unknown encoding: unicode

ElementTree.tostring(xml, encoding='utf-8')
# Python 3: b'<Person Name="John" />'
# Python 2: <Person Name="John" />

ElementTree.tostring(xml).decode()
# Python 3: <Person Name="John" />
# Python 2: <Person Name="John" /> 
```

感谢[Martijn Peters](https://stackoverflow.com/questions/15304229/convert-python-elementtree-to-string/48671499?noredirect=1#comment84342152_48671499)指出`str`Python 2 和 3 之间的数据类型发生了变化。

* * *

### 为什么不使用 str()？

在大多数情况下，使用[`str()`](https://docs.python.org/3/library/stdtypes.html#str)将是将对象转换为字符串的“[规范”方式。](https://stackoverflow.com/a/3205525/3357935)不幸的是，使用 this with`Element`将对象在内存中的位置返回为十六进制字符串，而不是对象数据的字符串表示形式。

```
from xml.etree import ElementTree

xml = ElementTree.Element("Person", Name="John")
print(str(xml))  # <Element 'Person' at 0x00497A80> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-09-17T17:50:42.003

# 非拉丁答案扩展

扩展[@Stevoisiak 的答案](https://stackoverflow.com/a/48671499/2333021)并处理非拉丁字符。只有一种方式会向您显示非拉丁字符。一种方法在 Python 3 和 Python 2 上都不同。

**输入**

```
xml = ElementTree.fromstring('<Person Name="크리스&quot; />')
xml = ElementTree.Element("Person", Name="크리스&quot;)  # Read Note about Python 2 
```

> 注意：在 Python 2 中，调用`toString(...)`代码时，分配`xml`with`ElementTree.Element("Person", Name="크리스&quot;)`将引发错误...
> 
> `UnicodeDecodeError: 'ascii' codec can't decode byte 0xed in position 0: ordinal not in range(128)`

**输出**

```
ElementTree.tostring(xml)
# Python 3 (크리스): b'<Person Name="&#53356;&#47532;&#49828;" />'
# Python 3 (John): b'<Person Name="John" />'

# Python 2 (크리스): <Person Name="&#53356;&#47532;&#49828;" />
# Python 2 (John): <Person Name="John" />

ElementTree.tostring(xml, encoding='unicode')
# Python 3 (크리스): <Person Name="크리스&quot; />             <-------- Python 3
# Python 3 (John): <Person Name="John" />

# Python 2 (크리스): LookupError: unknown encoding: unicode
# Python 2 (John): LookupError: unknown encoding: unicode

ElementTree.tostring(xml, encoding='utf-8')
# Python 3 (크리스): b'<Person Name="\xed\x81\xac\xeb\xa6\xac\xec\x8a\xa4" />'
# Python 3 (John): b'<Person Name="John" />'

# Python 2 (크리스): <Person Name="크리스&quot; />             <-------- Python 2
# Python 2 (John): <Person Name="John" />

ElementTree.tostring(xml).decode()
# Python 3 (크리스): <Person Name="&#53356;&#47532;&#49828;" />
# Python 3 (John): <Person Name="John" />

# Python 2 (크리스): <Person Name="&#53356;&#47532;&#49828;" />
# Python 2 (John): <Person Name="John" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-28T05:05:48.700

如果您只需要它来调试以查看 XML 的外观，那么`print(xml.etree.ElementTree.tostring(e))`您可以使用`dump`以下代码：

```
xml.etree.ElementTree.dump(e) 
```

这适用于`Element`和`ElementTree`对象 as `e`，因此不需要`getroot`.

的[文档`dump`](https://docs.python.org/3/library/xml.etree.elementtree.html#xml.etree.ElementTree.dump)说：

> `xml.etree.ElementTree.dump(elem)`
> 
> 将元素树或元素结构写入`sys.stdout`. 此功能应仅用于调试。
> 
> 确切的输出格式取决于实现。在这个版本中，它被编写为一个普通的 XML 文件。
> 
> `elem`是元素树或单个元素。
> 
> *在 3.8 版更改*：该`dump()`函数现在保留用户指定的属性顺序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-04T16:01:50.790

我在 Python 3.8 中遇到了同样的问题，之前的答案都没有解决它。问题是 ElementTree 既是模块的名称，也是其中的类的名称。使用别名可以清楚地表明：

```
from xml.etree.ElementTree import ElementTree
import xml.etree.ElementTree as XET
...
ElementTree.tostring(...)  # Attribute-error
XET.tostring(...)          # Works 
```

# asp.net-mvc - Lambda Query filter by Enum

> ID：15304231
> 
> 赞同：0
> 
> 时间：2013-03-08T22:13:38.887
> 
> 标签：asp.net-mvc, linq, lambda

I have the following lamba query that seems to always return all records even when the int? status pamameter is not null and valid. Anyone know why is the Enum filter not being honored? Thanks for reading!

```
public ActionResult GetArrivals(int facilityId, int? status)
{
    var registrationList = db.Registrations
            .Where(f => f.Facility.Id == facilityId)
            .Where(a => a.ArrivalDateTime >= DateTime.Today)
            .OrderBy(ln => ln.User.LastName)
            .OrderBy(fn => fn.User.FirstName);

    if (status.HasValue)
    {
        UrgentCareWaitWeb.Models.RegistrationStatus statusValue;

        if (Enum.TryParse(status.Value.ToString(), out statusValue) == true)
        {
            registrationList
                .Where(s => s.Status == statusValue);
        } 
    }

    // Project query to view
    var pview = registrationList.Select(r => new PatientRegistrationsView()
            {
                ArrivalId = r.Id,
                UserId = r.User.UserId,
                UserName = r.User.UserName,
                FirstName = r.User.FirstName,
                LastName = r.User.LastName,
                PrimaryPhone = r.User.PrimaryPhone,
                SecondaryPhone = r.User.SecondaryPhone,
                ArrivalDateTime = r.ArrivalDateTime,
                PatientDataformId = r.PatientDataformId,
                RegistrationStatus = r.Status,

            });

    //if (Request.IsAjaxRequest())
    //  return PartialView("_PatientRegistrations", model);

    return View(pview);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T22:15:46.087

You need to point the result of the `Where` method back to the original object - it returns a new `IEnumerable` instead of doing an in-place change.:

```
registrationList = registrationList.Where(s => s.Status == statusValue); 
```

In response to the update: you'll need to swap out where your order clause goes. Try:

```
var registrationList = db.Registrations
        .Where(f => f.Facility.Id == facilityId)
        .Where(a => a.ArrivalDateTime >= DateTime.Today);

if (status.HasValue)
{
    UrgentCareWaitWeb.Models.RegistrationStatus statusValue;

    if (Enum.TryParse(status.Value.ToString(), out statusValue) == true)
    {
        registrationList = registrationList
            .Where(s => s.Status == statusValue);
    } 
}

 var pview = registrationList
            .OrderBy(ln => ln.User.LastName)
            .ThenBy(fn => fn.User.FirstName)
            .Select(r => new PatientRegistrationsView()
        {
            ArrivalId = r.Id,
            UserId = r.User.UserId,
            UserName = r.User.UserName,
            FirstName = r.User.FirstName,
            LastName = r.User.LastName,
            PrimaryPhone = r.User.PrimaryPhone,
            SecondaryPhone = r.User.SecondaryPhone,
            ArrivalDateTime = r.ArrivalDateTime,
            PatientDataformId = r.PatientDataformId,
            RegistrationStatus = r.Status,

        }); 
```

Note the additional use of `ThenBy` - this will order by `LastName` *then* `FirstName`; the original would order by `LastName`, but then replace that ordering with `FirstName`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:20:53.520

All LINQ queries return an `IEnumerable<T>` objects, but they do not change the original sequence.

do this:

```
registrationList = registrationList.Where(s => s.Status == statusValue); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T20:03:37.453

I think this might be also linked to closure of variables within lambda expressions...

use a variable internally like **_internalfacilityID** and assign the incoming parameter value to it first.

can you please check if this also helps to solve your problem even if you solved it using other ways.

```
public ActionResult GetArrivals(int facilityId, int? status)
{
    int _internalfacilityID = facilityId;
    var registrationList = db.Registrations
        .Where(f => f.Facility.Id == **_internalfacilityID**)
        .Where(a => a.ArrivalDateTime >= DateTime.Today)
        .OrderBy(ln => ln.User.LastName)
        .OrderBy(fn => fn.User.FirstName); 
```

# ruby-on-rails - Rails before_filter 检查受保护页面

> ID：15304233
> 
> 赞同：0
> 
> 时间：2013-03-08T22:13:43.190
> 
> 标签：ruby-on-rails, ruby

我是Rails的新手。我想检查一个页面是否受到保护，如果它受到保护，然后将用户重定向到登录页面。由于某种原因它不起作用。

我将此添加到控制器的顶部：

```
before_filter :check_access, :only => [:show] 
```

我将此代码添加到 Posts 控制器：

```
def check_access
  @post = Post.find(params[:id])
  redirect_to login_url unless @post.published != '2'
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:03:52.100

更多信息将有助于诊断问题。我假设@post.published 是一个标志，表明该帖子已发布。您可以确保从控制台正确设置了 *login_url* 路径。

```
rake routes | grep "login_url" 
```

# git - Git 和符号链接

> ID：15304236
> 
> 赞同：1
> 
> 时间：2013-03-08T22:14:09.277
> 
> 标签：git

我有两个问题：

1.  我希望 git 忽略符号链接
2.  我最近注意到它正在提交符号链接。我怎样才能删除这些提交的符号链接。他们已经被推送到远程。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-09T16:01:35.020

添加所有符号链接`.gitignore`

```
find . -type l >> .gitignore 
```

从存储库中删除所有符号链接

```
find . -type l -exec git rm --cached {} \; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:27:17.300

1）然后不要`git add`任何符号链接。这包括诸如`git add -A`自动添加当前未跟踪的事物之类的事物。

2) `git rm <symlink>`; 对每个符号链接重复，然后`git commit`. 当然，您需要在每个分支上执行此操作。此外，如果您想删除整个项目历史记录中的所有符号链接，则需要在每次提交时都执行相同操作，这可以使用`git filter-branch`.

# php - 使用 php 关联数组检查布尔值

> ID：15304237
> 
> 赞同：0
> 
> 时间：2013-03-08T22:14:10.320
> 
> 标签：php, arrays

我有一个表单，它有两个值，用户和提交时传递。

```
$_POST['submit'] = the name of the submit button is "submit" 
```

当用户提交时，我在 php 中有以下脚本来验证：

```
$logins = array(
    'user1' => 'pass1',
    'user2' => 'pass2',
    'user3' => 'pass3'
);

foreach($_POST as $key => $value) {  
    $_POST[$key] = stripslashes($_POST[$key]); 

    $_POST[$key] = htmlspecialchars(strip_tags($_POST[$key])); 
}

/******************************************************************************/
   if (isset($_POST['submit'])){

      $user = isset($_POST['user']) ? strtolower($_POST['user']) : '';
      $pass = isset($_POST['pass']) ? $_POST['pass'] : '';
      $report = $_POST['typereport'];

      if ($logins[$user] != $pass) {
         showForm("Wrong Username/Password");
         exit();     
      }
      else {
    if ($report == "Clinical") {
        $file = $filename;
        $contents = file($file); 
        $string = implode("<br>", $contents);
        echo "<head><title>ScoreViewer: Clinical</title></head>";
        echo "Logged in as: " . strtoupper($user) . "<br>";
        echo "<a href='log2.php'>Sign Out</a>";
        echo "<br><br>";
        echo "<pre>" . $string . "</pre>";
        echo "<br><br>";
    }
    elseif ($report == "Non-Clinical") {
        $file = $filename2;
        $contents = file($file); 
        $string = implode("<br>", $contents);
        echo "<head><title>ScoreViewer: Non-Clinical</title></head>";
        echo "Logged in as: " . strtoupper($user) . "<br>";
        echo "<a href='log2.php'>Sign Out</a>";
        echo "<br><br>";
        echo "<pre>" . $string . "</pre>";
        echo "<br><br>";
    }
      }
   } else {
      showForm();
      exit();
   } 
```

现在会发生什么，脚本将比较输入的用户名和密码以找到匹配项。如果找到匹配项并基于它是什么类型的报告，它将显示。但是由于某种原因，只要按下提交按钮，它就会直接进入 IF 语句的临床部分。

如果我只使用没有数组的单个用户名/密码，它工作正常。如下所示：

```
$username = "user";
$password = "pass";

foreach($_POST as $key => $value) {  
    $_POST[$key] = stripslashes($_POST[$key]); 

    $_POST[$key] = htmlspecialchars(strip_tags($_POST[$key])); 
}

/******************************************************************************/
   if (isset($_POST['submit'])){

      $user = isset($_POST['user']) ? strtolower($_POST['user']) : '';
      $pass = isset($_POST['pass']) ? $_POST['pass'] : '';
      $report = $_POST['typereport'];

      if ($user != $username && $pass != $password) { #$logins[$user] != $pass) {
         showForm("Wrong Username/Password");
         exit();     
      }
      else {
// decide what to do here if the user and pass is correct, deleted to save space
      }
   } else {
      showForm();
      exit();
   } 
```

我如何实现我想要完成的目标？

完整的 HTML 代码：[Pastbin](http://pastebin.com/PnNwRqAU)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:42:44.467

```
 if ($logins[$user] != $pass) {// there lies error one... 
```

$user 可能不是 $logins 数组中的键，请先检查**array_key_exists**。

然后代码显示滥用“else”...

```
 showForm("Wrong Username/Password");
     exit();                    // That condition exits  
  }
      else {                    // So you do not need this else and the block. 
```

所以重新写它：

```
$logins = array(
    'user1' => 'pass1',
    'user2' => 'pass2',
    'user3' => 'pass3'
);

foreach($_POST as $key => $value) {  
    $_POST[$key] = stripslashes($_POST[$key]); 
    $_POST[$key] = htmlspecialchars(strip_tags($_POST[$key])); 
}
/******************************************************************************/
if (isset($_POST['submit'])){
    $user = isset($_POST['user']) ? strtolower($_POST['user']) : '';
    $pass = isset($_POST['pass']) ? $_POST['pass'] : '';
    $report = $_POST['typereport'];
    if ((!array_key_exists($user, $logins))||($logins[$user] != $pass)) {
        showForm("Wrong Username/Password");
        exit();     
    }
    if($report == "Clinical") {
         $file = $filename;
         $contents = file($file); 
         $string = implode("<br>", $contents);
         echo "<head><title>ScoreViewer: Clinical</title></head>";
         echo "Logged in as: " . strtoupper($user) . "<br>";
         echo "<a href='log2.php'>Sign Out</a>";
         echo "<br><br>";
         echo "<pre>" . $string . "</pre>";
         echo "<br><br>";
    } 
             // No need if you only have only clinic and non clinic reports...
             // elseif ($report == "Non-Clinical") {
    else {   // now non clinic
         $file = $filename2;
         $contents = file($file); 
         $string = implode("<br>", $contents);
         echo "<head><title>ScoreViewer: Non-Clinical</title></head>";
         echo "Logged in as: " . strtoupper($user) . "<br>";
         echo "<a href='log2.php'>Sign Out</a>";
         echo "<br><br>";
         echo "<pre>" . $string . "</pre>";
         echo "<br><br>";
    }    // this block ends non clinic - clinic choices...
}        // this ends the if (isset($_POST['submit']))
else {   // and this does if !isset($_POST['submit'])
    showForm();
    exit();
} 
```

希望这可以帮助

# cordova - InAppBrowser 标头/cookies

> ID：15304239
> 
> 赞同：4
> 
> 时间：2013-03-08T22:14:18.453
> 
> 标签：cordova, childbrowser, inappbrowser

在 InAppBrowser 中打开 url 时如何发送标头？或者是否可以从父浏览器在 InAppBrowser 中设置 cookie 值？

您会推荐哪个 - InAppBrowser 或 childBrowser 插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T09:49:56.013

InAppbrowser 就像使用 window.open 打开一个窗口一样。曾经，将其称为不同的窗口。所以你不能在 window.open 中做的任何事情都不能在 InAppBrowser 中完成。推荐使用 InAppBroswer，因为它与 PhoneGap 一起开箱即用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-10T23:33:56.137

虽然我无法直接影响 InAppBrowser 标头或 cookie，但我能够通过注入来解决丢失的 Tomcat JSESSIONID cookie

> ;JSESSIONID=sessionid.jvmroute?

进入网址。请注意，这种解决方法会暴露会话 id，否则会受到 SSL/TLS 的保护。

# mysql - 如果MYSQL中的值被更新，其他值改变

> ID：15304241
> 
> 赞同：1
> 
> 时间：2013-03-08T22:14:36.717
> 
> 标签：mysql, sql, arrays, wordpress

我试图使当一个MYSQL属性的值改变时，其他属性的其他值也不同。

例如：

我有值为“RED”的 color_scheme 属性。如果 color_scheme 值更改为“BLUE”，则值：

```
menu_color changes to #30618F
font_color changes to #FFFFFF
footer_color changes to #1A92CA 
```

可能吗？

它必须只更新一次值，因为用户必须能够单独更改特定属性（如 menu_color、font_color、footer_color）。

像这样：

![根据其他更新值](../Images/9d44ff91de9a63f1bc30a6244cfba537.png)

![在此处输入图像描述](../Images/da72ad97fb6e06be569b7a1f1e9f6192.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:59:51.950

尝试这个：

```
CREATE TABLE color_scheme (
  id_color_sheme INT AUTO_INCREMENT PRIMARY KEY,
  color_esquema VARCHAR(30),
  color_front_banners VARCHAR(7),
  color_front_banners_bottom VARCHAR(7),
  color_front_botoes VARCHAR(7),
  color_front_links VARCHAR(7),
  color_front_menu VARCHAR(7),
  color_front_rodape VARCHAR(7),
  index(color_esquema) 
  );

CREATE TABLE user_interface (
  id INT AUTO_INCREMENT PRIMARY KEY,
  color_front_banners VARCHAR(7),
  color_front_banners_bottom VARCHAR(7),
  color_front_botoes VARCHAR(7),
  color_front_links VARCHAR(7),
  color_front_menu VARCHAR(7),
  color_front_rodape VARCHAR(7)

  );

-- SAMPLE DATA
INSERT INTO user_interface (
                          color_front_banners,
                          color_front_banners_bottom,
                         color_front_botoes,
                         color_front_links,
                         color_front_menu,
                         color_front_rodape)
VALUES ('#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF'),
('#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE') ; 

INSERT INTO color_scheme (color_esquema,
                          color_front_banners,
                          color_front_banners_bottom,
                         color_front_botoes,
                         color_front_links,
                         color_front_menu,
                         color_front_rodape)
VALUES ('black','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF'),
('grey','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE') ;

-- UPDATE based on color_esquema
SET @color_name := 'black'; 
UPDATE user_interface 
SET 
  color_front_banners = (
SELECT color_front_banners FROM color_scheme
WHERE color_esquema = @color_name ),

  color_front_banners_bottom = (
SELECT color_front_banners_bottom FROM color_scheme
WHERE color_esquema = @color_name ),

  color_front_botoes = (
SELECT color_front_botoes FROM color_scheme
WHERE color_esquema = @color_name ),

  color_front_links = (
SELECT color_front_links FROM color_scheme
WHERE color_esquema = @color_name ),

  color_front_menu = (
SELECT color_front_menu FROM color_scheme
WHERE color_esquema = @color_name ),

  color_front_rodape = (
SELECT color_front_rodape FROM color_scheme
WHERE color_esquema = @color_name )

WHERE id = 2;

-- If you want to change just one color, you can use this query.
UPDATE user_interface 
SET 
  color_front_botoes = '#DDDDDD'
WHERE id = 1; 
```

这是如何运作的？首先，您创建一个带有颜色的表（例如“color_scheme”）。然后，您从插入到您的“user_interface”表中的该表中获取值（例如“蓝色”、“#....”、...）。顺便说一句，我假设您会将其用于用户界面。无论如何，您可以根据需要采用它。需要注意的重要一点是，您只能更新首次插入数据库的数据。因此，您应该在添加用户时使用默认颜色。我什至建议您使用颜色创建一个单独的表，与用户表分开。

接下来，您要根据选定的配色方案更新默认颜色。假设您想使用“蓝色”。然后您应该使用更新查询来更新 user_interface 表（或颜色表）中的值。最基本的方法是像我一样做子查询，然后说 WHERE color_esquema = 'blue'。我添加了 set color_name 变量来简化条目。使用此语句，您开始声明一个名为 color_name 的变量，并且您只需要在整个查询过程中使用它就声明它。如果您想恢复，您可以插入您的 color_esquema 名称。

[SQL 小提琴演示](http://www.sqlfiddle.com/#!2/af117/1)

我首先在 user_interface 的最后一行添加灰色。然后我使用更新查询将值更改为黑色的新颜色模式。将其分解为步骤。

```
CREATE TABLE color_scheme (
  id_color_sheme INT AUTO_INCREMENT PRIMARY KEY,
  color_esquema VARCHAR(30),
  color_front_banners VARCHAR(7),
  color_front_banners_bottom VARCHAR(7),
  color_front_botoes VARCHAR(7),
  color_front_links VARCHAR(7),
  color_front_menu VARCHAR(7),
  color_front_rodape VARCHAR(7),
  index(color_esquema) 
  );

CREATE TABLE user_interface (
  id INT AUTO_INCREMENT PRIMARY KEY,
  color_front_banners VARCHAR(7),
  color_front_banners_bottom VARCHAR(7),
  color_front_botoes VARCHAR(7),
  color_front_links VARCHAR(7),
  color_front_menu VARCHAR(7),
  color_front_rodape VARCHAR(7)

  );

-- SAMPLE DATA
INSERT INTO user_interface (
                          color_front_banners,
                          color_front_banners_bottom,
                         color_front_botoes,
                         color_front_links,
                         color_front_menu,
                         color_front_rodape)
VALUES ('#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF'),
('#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE') ; 

INSERT INTO color_scheme (color_esquema,
                          color_front_banners,
                          color_front_banners_bottom,
                         color_front_botoes,
                         color_front_links,
                         color_front_menu,
                         color_front_rodape)
VALUES ('black','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF','#FFFFFF'),
('grey','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE','#EEEEEE') ; 
```

[第一步](http://www.sqlfiddle.com/#!2/d912e/1)

然后与更新相同的数据。顺便说一句，小提琴不允许我在右侧面板中执行此操作。见顶部的决赛。

[第二步](http://www.sqlfiddle.com/#!2/af117/1)

**PHP**

用于更改配色方案的 PHP 脚本。

```
 <?php

    $color_name = 'black';

    $host = 'host';
    $user = 'user';
    $password = 'password';
    $database = 'database';

    $link = mysqli_connect($host, $user, $password, $database);
    IF (!$link) {
        echo ('Unable to connect to database');
    }
    ELSE{
        $query = "
            SET @color_name := '".$color_name."'; 
    UPDATE user_interface 
    SET 
      color_front_banners = (
    SELECT color_front_banners FROM color_scheme
    WHERE color_esquema = @color_name ),

      color_front_banners_bottom = (
    SELECT color_front_banners_bottom FROM color_scheme
    WHERE color_esquema = @color_name ),

      color_front_botoes = (
    SELECT color_front_botoes FROM color_scheme
    WHERE color_esquema = @color_name ),

      color_front_links = (
    SELECT color_front_links FROM color_scheme
    WHERE color_esquema = @color_name ),

      color_front_menu = (
    SELECT color_front_menu FROM color_scheme
    WHERE color_esquema = @color_name ),

      color_front_rodape = (
    SELECT color_front_rodape FROM color_scheme
    WHERE color_esquema = @color_name )

    WHERE id = 2;
            ";
        mysqli_query($link, $query);
    }
    mysqli_close($link);
    ?>

**Edit Wordpress udpate ** 
```

这只会加载配色方案名称：

```
 <?php
// insert database connection to get the colors from the color scheme 
   function retrieve_color_scheme() {
       $host = 'host';
       $user = 'user';
       $password = 'password';
       $database = 'database';

       $link = mysqli_connect($host, $user, $password, $database);
       IF (!$link) {
           echo ('Unable to connect to database');
       } ELSE {
           $query = "SELECT color_esquema FROM color_scheme";
           $result = mysqli_query($link, $query);
           $choices = mysql_fetch_array($result);
           return $choices;
       }
       mysqli_close($link);
   }

                    $this->add_control( 'color_esquema', array(
                            'label'   => 'Esquema de cores:',
                            'section' => 'custom_colors',
                            'type'    => 'select',
                            'priority'=> 9,
                            'choices'    => retrieve_color_scheme()
                    ) );                

                    $this->add_setting( 'color_menu', array(
                            'default'        => '#65696E',
                            'type'           => 'option',
                            'capability'     => 'edit_theme_options',
                            'transport'      => 'postMessage',
                            'priority'       => 10
                    ) );

                    $this->add_control( new WP_Customize_Color_Control( $this, 'color_menu', array(
                            'label'   => __( 'Fundo do Menu'),
                            'section' => 'custom_colors',
                            'settings'   => 'color_menu',
                            'priority'       => 10
                    ) ) );

                    $this->add_setting( 'color_titulo_menu', array(
                            'default'        => '#FFFFFF',
                            'type'           => 'option',
                            'capability'     => 'edit_theme_options',
                            'transport'      => 'postMessage',
                            'priority'       => 15
                    ) );

                    $this->add_control( new WP_Customize_Color_Control( $this, 'color_titulo_menu', array(
                            'label'   => __( 'T&iacute;tulo'),
                            'section' => 'custom_colors',
                            'settings'   => 'color_titulo_menu',
                            'priority'       => 15
                    ) ) );                
?>                   
    <!-- Page -->
    <?php $color_menu = get_option('color_menu');  ?>
    <?php $color_titulo_menu = get_option('color_titulo_menu');?>

        #container{border-top:82px solid <?php if(empty($color_menu)){echo "#65696E";} else { echo "$color_menu";}; ?>}
        #logo a span{color:<?php if(empty($color_titulo_menu)){echo "#FFFFFF";} else { echo "$color_titulo_menu";}; ?>}

    <!-- My try - In Page --> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:17:33.257

You can use a CASE statement for this. This is a pretty simplified version, but this should get you on the right track.

```
UPDATE mytable
SET menu_color = CASE WHEN color_scheme = 'Red' THEN '#30618F' WHEN color_scheme = 'Blue' THEN  '#FFFFFF' ELSE '' END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T22:17:40.930

You should make a `color_schemes` table and store the details for each color scheme there.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T13:17:50.097

激进的，

我是阿图尔的朋友，昨天我尝试了不同的方法来解决同样的问题，我不知道它是否更容易还是什么......[请看看我的另一个问题](https://wordpress.stackexchange.com/questions/90070/using-color-schemes-with-color-picker)

我们使用的是 Wordpress，我们不太擅长编写 PHP，我们可以调整脚本和东西，但我们不太擅长创建自己的。

感谢您的努力，我们就快到了！

# actionscript-3 - 一个对象要给另一个对象，而不仅仅是对它的引用

> ID：15304242
> 
> 赞同：0
> 
> 时间：2013-03-08T22:14:40.663
> 
> 标签：actionscript-3, object, reference

对不起，我确信在 Internet 上有很多我的问题的答案，但我不知道足够多的编程来具体搜索。

好的，这是我的问题。让我们看一下这个例子，它非常简单：

```
var obj:Object = new Object;
var bit:Bitmap = new Bitmap;
    obj["key"] = bit;
    obj["key"].x = 30;
    trace(obj["key"].x); //30.

var bit2:Bitmap;
    bit2 = obj["key"];
    trace (bit2.x); //30.
    bit2.x = 60;
    trace(bit2.x) //60.
    trace(obj["key"].x); //60 ??? 
```

我要做的就是在一个对象中存储一个位图。这部分很好

```
trace(obj["key"]); // [Object Bitmap] 
```

但是，如果我试图把它交给另一个对象，它发生的方式对我来说没有意义。就像我的对象在内存中为位图提供了引用，而不是位图本身。所以看起来我有两个对我的位图的引用。我所有的应用程序都基于这些对象，我真的需要一种方法来获取我的位图副本，而不仅仅是对它的引用。所以我想更改这些属性而不必在我的对象中更改它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:21:20.423

试试这个：

```
private function bmpCopy(srcBmp:Bitmap):Bitmap{
  return new Bitmap(srcBmp.bitmapData.clone());
}

//in your code somewhere...
bit2 = bmpCopy(bit1); 
```

您只需要记住在使用完这两个位图后释放它们。

# javascript - HTML5 JavaScript 没有调用函数？

> ID：15304249
> 
> 赞同：0
> 
> 时间：2013-03-08T22:14:54.397
> 
> 标签：javascript, html

我一直在关注这里的 Breakout 游戏教程 ( [http://billmill.org/static/canvastutorial/index.html](http://billmill.org/static/canvastutorial/index.html) )。我完成得很好，并且正在添加我自己的功能。但是，“restartGame()”函数不会运行。我只是告诉它现在将分数加 2 以查看它是否正在运行，但事实并非如此。我知道诸如“Clear()”之类的其他功能是。

这是我的代码，对不起，如果我在做一些愚蠢的事情>。<

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="game.aspx.cs" Inherits="Game"     Title="SetoChaos - Game" ValidateRequest="false" %>

<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
<title></title>
<link href="css/Styles.css" rel="stylesheet" type="text/css" media="screen" />
</head>
<body>
<a href="Default.aspx">Back to site.</a>
</body>
</html>

<canvas id="canvas" width="1200" height="700"></canvas>

<!-- Jquery -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>
//BEGIN LIBRARY CODE
var x = 150;
var y = 150;
var dx = 2;
var dy = 4;
var WIDTH;
var HEIGHT;
var ctx;

function init() {
    ctx = $('#canvas')[0].getContext("2d");
    WIDTH = $("#canvas").width();
    HEIGHT = $("#canvas").height();
    return setInterval(draw, 10);
}

function circle(x, y, r) {
    //ctx.fillStyle = "#00FFFF";
    ctx.beginPath();
    ctx.arc(x, y, r, 0, Math.PI * 2, true);
    ctx.closePath();
    ctx.fill();
}

function rect(x, y, w, h) {
    ctx.beginPath();
    ctx.rect(x, y, w, h);
    ctx.closePath();
    ctx.fill();
}

function clear() {
    ctx.clearRect(0, 0, WIDTH, HEIGHT);
}

var paddlex;
var paddleh;
var paddlew;

function init_paddle() {
    paddlex = WIDTH / 2;
    paddleh = 10;
    paddlew = 75;
}

rightDown = false;
leftDown = false;

//set rightDown or leftDown if the right or left keys are down
function onKeyDown(evt) {
    if (evt.keyCode == 39) rightDown = true;
    else if (evt.keyCode == 37) leftDown = true;
}

//and unset them when the right or left key is released
function onKeyUp(evt) {
    if (evt.keyCode == 39) rightDown = false;
    else if (evt.keyCode == 37) leftDown = false;
}

$(document).keydown(onKeyDown);
$(document).keyup(onKeyUp);

var canvasMinX;
var canvasMaxX;

function init_mouse() {
    canvasMinX = $("#canvas").offset().left;
    canvasMaxX = canvasMinX + WIDTH;
}

function onMouseMove(evt) {
    if (evt.pageX > canvasMinX && evt.pageX < canvasMaxX) {
        paddlex = evt.pageX - canvasMinX - (paddlew/2);
    }
}

$(document).mousemove(onMouseMove);

var bricks;
var NROWS;
var NCOLS;
var BRICKWIDTH;
var BRICKHEIGHT;
var PADDING;

var rowcolors; // = ['#' + Math.floor(Math.random() * 16777215).toString(16), '#' + Math.floor(Math.random() * 16777215).toString(16), '#' + Math.floor(Math.random() * 16777215).toString(16), "#00FFFF", '#' + Math.floor(Math.random() * 16777215).toString(16), ];

function initbricks() {
    NROWS = 10;
    NCOLS = 10;
    BRICKWIDTH = (WIDTH / NCOLS) - 1;
    BRICKHEIGHT = 10;
    PADDING = 1;

    bricks = new Array(NROWS);
    for (i = 0; i < NROWS; i++) {
        bricks[i] = new Array(NCOLS);
        for (j = 0; j < NCOLS; j++) {
            bricks[i][j] = 1;
        }
    }

    rowcolors = new Array(NROWS);
    for (i = 0; i <= NROWS; i++) {
        rowcolors[i] = new Array(NCOLS);
        for (j = 0; j <= NCOLS; j++) {
            rowcolors[i][j] = '#' + Math.floor(Math.random() * 16777215).toString(16); //Random Hex Colour Value
        }
    }
}

var ballr = 10;

var paddlecolor = "#FF0000";
var ballcolor = "#00FF00";
var backcolor = "#000000";

var restartGame = false;
var hit = new Audio("sound/hit.wav");
var shipHit = new Audio("sound/shipHit.wav");
var sideHit = new Audio("sound/sideHit.wav");
var dead = new Audio("sound/dead.wav");

var score = 0;
function restartGame() {
    score += 2;
}

//END LIBRARY CODE

function draw() {
    ctx.fillStyle = backcolor;
    clear();
    ctx.fillStyle = ballcolor;
    circle(x, y, ballr);

    ctx.font = '40pt Calibri';
    ctx.fillText("Score: " + score, WIDTH-WIDTH, HEIGHT-30);

    //move the paddle if left or right is currently pressed
    if (rightDown) paddlex += 5;
    else if (leftDown) paddlex -= 5;
    ctx.fillStyle = paddlecolor;
    rect(paddlex, HEIGHT - paddleh, paddlew, paddleh);

    //draw bricks
    for (i = 0; i < NROWS; i++) {
        for (j = 0; j < NCOLS; j++) {
            if (bricks[i][j] == 1) {
                rect((j * (BRICKWIDTH + PADDING)) + PADDING,
                     (i * (BRICKHEIGHT + PADDING)) + PADDING,
                     BRICKWIDTH, BRICKHEIGHT);
                ctx.fillStyle = rowcolors[i][j];
            }

            //Doing this for a second time with or without the fillstyle seems allow the colours to properly wrap around rows
            if (bricks[i][j] == 1) {
                rect((j * (BRICKWIDTH + PADDING)) + PADDING,
                     (i * (BRICKHEIGHT + PADDING)) + PADDING,
                     BRICKWIDTH, BRICKHEIGHT);
            }
        }
    }

    //Tutorial says to look at this page for collision
    // http://www.harveycartel.org/metanet/tutorials/tutorialA.html

    //have we hit a brick?
    rowheight = BRICKHEIGHT + PADDING;
    colwidth = BRICKWIDTH + PADDING;
    row = Math.floor(y / rowheight);
    col = Math.floor(x / colwidth);
    //if so, reverse the ball and mark the brick as broken
    if (y < NROWS * rowheight && row >= 0 && col >= 0 && bricks[row][col] == 1) {
        dy = -dy;
        bricks[row][col] = 0;
        hit.play();
        score += 1;
    }

    if (x + dx > WIDTH || x + dx < 0) {
        dx = -dx;
        sideHit.play();
    }

    if (y + dy < 0)
        dy = -dy;
    else if (y + dy > HEIGHT) {
        if (x > paddlex && x < paddlex + paddlew) {
            dy = -dy;
            shipHit.play();
        }
        else {
            //game over, so stop the animation
            //dead.play();
            //clearInterval(intervalId);
            ctx.fillText("DEAD.", WIDTH - WIDTH, HEIGHT - 130);
            restartGame();
        }
    }
    x += dx;
    y += dy;

}

init();
init_paddle();
init_mouse();
initbricks();
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:16:03.423

您用布尔文字覆盖函数：`var restartGame = false;`

（函数声明被提升，所以你不需要订购你的源代码，所以它们在你使用它们之前就出现了，所以赋值发生在函数创建之后）。

# ios - Urban Airship – iOS 生产推动与 Ad Hoc 合作，而不是发布版本

> ID：15304253
> 
> 赞同：1
> 
> 时间：2013-03-08T22:15:07.293
> 
> 标签：ios, push, release, adhoc

首先让我说，我知道混淆开发和生产 API 密钥是此类错误的最常见原因，但我很确定这里不是这种情况。

我有我的 iOS 应用程序设置来使用我应该使用的生产服务器密钥。当我使用生产服务器测试我的 Ad Hoc 构建时，一切似乎都很好。但是在通过 iTunes 购买的任何应用程序上，我的设备令牌总是返回为“非活动”。

Ad Hoc 构建和 App Store 构建完全相同，使用相同的 API 密钥。我很确定我没有混淆我的开发和生产密钥。

我从这里去哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:21:50.437

您应该检查您的 UA 帐户中的密钥...如有必要，请重新上传它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:33:10.570

查看

1.  APP_STORE_OR_AD_HOC_BUILD 在 airshipConfig.plist 中设置为 YES？
2.  检查帐户设置。生产已在 UA 中启动并运行
3.  将此日志作为警报并尝试查看错误发生的原因

    -(void)application:(UIApplication *)app didFailToRegisterForRemoteNotificationsWithError:(NSError *)err
    {
    UALOG(@"%@",[NSString stringWithFormat:@"Error: %@", err]);

    }

# c# - 序列化或反序列化 JSON 期间的 ASP.NET MVC4 错误 - 大数据

> ID：15304258
> 
> 赞同：3
> 
> 时间：2013-03-08T22:15:18.910
> 
> 标签：c#, json, asp.net-mvc-4, jsonserializer, large-data

我在给您写信时出现网站错误：使用 JSON JavaScriptSerializer 进行序列化或反序列化期间出错。字符串的长度超过了 maxJsonLength 属性上设置的值。

使用的技术：C#，。NET FW 4.5、ASP.NET MVC4 和 Lint to SQL、Kendo UI（显示结果的网格）。

我想返回（就 Json 而言）一大组数据 - 实际上我有 50,000 条记录（不会出现超过 250,000 条记录）

我尝试放大 maxJsonLength 并在 web.config 中启用压缩 - 出现同样的错误：

```
 <system.web.extensions>
    <scripting>
      <webServices>
        <jsonSerialization maxJsonLength="10485760"/>
      </webServices>
      <scriptResourceHandler enableCompression="true" enableCaching="true"/>
    </scripting>
  </system.web.extensions> 
```

接下来我尝试在 C# 类中重写返回方法 - 相同的错误：a）默认

```
public JsonResult GetResult()
{
  // execute query for get result
  var myBigData = from ......
      select new
      {
          .......
      };

  // return result
  return this.Json(myBigData, JsonRequestBehavior.AllowGet);
} 
```

b）重写（仍然错误）

```
public JsonResult GetResult()
{
  // execute query for get result
  var myBigData = from ......
      select new
      {
          .......
      };

  // return result
  var jsonResult = Json(myBigData, JsonRequestBehavior.AllowGet);
  jsonResult.MaxJsonLength = int.MaxValue;
  return jsonResult;
} 
```

为了消除错误，我尝试了少量数据 - 一切正常：测试正确：6999 个项目中的 1 - 10 个

最好的问候，彼得

注意：不幸的是，我经历了很多讨论（这里），但没有成功，所以对于任何重复的话题，我深表歉意。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T23:02:15.667

似乎值 from[被](http://social.msdn.microsoft.com/Forums/en-US/sharepointdevelopment/thread/255bb9a4-ad57-4f4e-8d4a-f684cd1ecf18)`web.config`忽略了，根据[文档](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.maxjsonlength.aspx)，您必须显式创建一个实例`JavascriptSerializer`

```
public ContentResult GetResult() 
{
    var serializer = new JavaScriptSerializer();
    serializer.MaxJsonLength = Int32.MaxValue;
    var result = new ContentResult();
    result.Content = serializer.Serialize(data);
    result.ContentType = "text/json";
    return result;
} 
```

至少它对我有用:)

# performance - MSAccess 移至 sql server 作为后端

> ID：15304272
> 
> 赞同：0
> 
> 时间：2013-03-08T22:16:30.050
> 
> 标签：performance, ms-access, sql-server-2008r2-express

我们正在将后端从 MSAccess 迁移到 Sql server 2008 R2 Express。我们已将 MSAccess 查询更改为存储过程。数据约为 250,000+ 条记录。

我们在 MSAccess 的后端有两个可以变得非常大的表……PartsInventory_BE 和 Service_BE。

话虽如此，当我们从一个访问前端与我们的访问后端交谈时测试大约 9,000 条记录时。加载一个显示所有 9,000 条记录的表单需要 20-30 秒。有了这种性能，我们做了一个变通，以便前端现在包含一个名为 PartsInventory 的相同表，该表持续同步 PartsInventory 和 PartsInventory_BE。

**我们是否需要将这种样式用于 sql server 作为后端以保持/提高性能，如果是，那么如何？如果否，那么您还可以列出一些参考。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T11:35:45.020

请记住，Access 允许您编写[Pass-Through 查询](http://support.microsoft.com/kb/303968)，这会将 SQL 命令发送到您的新后端，并简单地返回结果。您可以像使用 Access 中的任何其他表或查询一样使用它。

如果您发现您的数据需要很长时间才能提取，您可能需要考虑一下您的索引方案。要获取有关列和索引的信息：

[SQL Server DB 中所有索引和索引列的列表](https://stackoverflow.com/questions/765867/list-of-all-index-index-columns-in-sql-server-db)

# c - 如何读取程序参数

> ID：15304279
> 
> 赞同：1
> 
> 时间：2013-03-08T22:16:54.143
> 
> 标签：c

我想读取客户端请求的线程数。因此，如果有人像这样运行我的程序：

```
./test 2 
```

我必须读取等于 2 的线程数。我尝试`getchar()`但它不起作用。任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:24:30.280

这是一个包含完整、正确的错误检查和诊断消息的最小示例。请注意，设置`errno`为 0 是区分范围错误和有效`strtoul()`输出所必需的，这是该函数的一个烦人的怪癖。

```
#include <stdlib.h>
#include <stdio.h>
#include <errno.h>
int main(int argc, char *argv[])
{
    if (argc != 2) {
        fputs("usage: test NTHREAD\n", stderr);
        exit(1);
    }
    char *e;
    errno = 0;
    unsigned long nthread = strtoul(argv[1], &e, 0);
    if (!*argv[1] || *e) {
        fputs("error: invalid NTHREAD\n", stderr);
        exit(1);
    }
    if (nthread == (unsigned long) -1 && errno == ERANGE) {
        fputs("error: NTHREAD out of range\n", stderr);
        exit(1);
    }
    // Your code goes here
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T22:26:07.153

这与线程本身无关。

如果给定程序的第一个参数，它将以`argv[1]`字符串形式出现，因此您需要将其转换为整数，例如`atoi`or `strtol`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T22:24:55.467

`int main(int argc, int **argv)`

使用参数`main`，你应该知道第一个参数`argv[0]`是当前正在执行的文件的名称，后面的参数是发送给你的程序的参数。

在您的情况下，您必须阅读`argv[1]`.

始终检查`argc`以计算输入的参数。

# performance - 主动记录预加载导致后效性能下降

> ID：15304282
> 
> 赞同：5
> 
> 时间：2013-03-08T22:17:15.120
> 
> 标签：performance, activerecord, preloader

使用大量外围对象进行大型活动记录查询。

添加“.includes”（预加载）通过压缩所有 N+1 来显着加快速度。

然后页面快速呈现并将其吐出到日志中：

```
Completed 200 OK in 504ms (Views: 104.2ms | ActiveRecord: 86.0ms) 
```

然而，直到页面实际发送到浏览器（或 curl；我们已经对两者都进行了测试）之前*** 90 秒 * 。**

在此期间，ruby 进程将 CPU 固定在 100%。

如果我们删除“.includes”（预加载），它会恢复正常的糟糕性能，而不会在页面渲染和浏览器交付之间出现一分钟半的虚无鸿沟。

WTF 预加载会导致后效！？

一位同事假设存在垃圾收集问题；我该如何检验这个理论？

导轨 3.2.12

Ruby 1.9.3（p286 和 p327 测试）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T20:59:59.740

发现问题；它是 Bullet gem ( [https://github.com/flyerhzm/bullet](https://github.com/flyerhzm/bullet) )。

这个 gem 巧妙地发现并报告了 N+1 个查询和过分的包含，但是在非常大的结果集的情况下，它会大大降低应用程序的性能。

# web-applications - Web 应用程序框架 vs CMS vs 自定义站点

> ID：15304286
> 
> 赞同：1
> 
> 时间：2013-03-08T22:17:40.150
> 
> 标签：web-applications

我想我对每个是什么（就 waf 与 cms 而言）有一个相当好的想法，但我不知道应该使用哪个以及何时使用。我所做的所有 Web 开发都是完全从头开始的，我编写了所有内容，显然并不太复杂。是否有许多网站是从头开始构建的——这是否仅用于非常复杂的应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:21:35.187

**内容管理系统：**

通常在您要让多人编辑对 HTML 一无所知的内容并且需要 WYSIWYG 来完成工作时使用。话虽如此，为了便于组织而需要/需要由数据库驱动的某些类型的站点通常在某种 CMS 上运行。

**框架：**

通常用于 Web 应用程序，因为它们通常有一个 ORM，可以非常容易地管理数据库中的数据。在许多其他原因中......（内置安全性、用户管理等）

**自定义站点：**

如果我不会从数据库中获取任何或很少的数据并且它不是传统的 Web 应用程序，我通常会做自定义站点。我这样做是因为它通常更快。

话虽如此，您可以将它们中的任何一个用于任何目的。正是内置功能使它们更适合不同的事物。您对从头开始构建的问题提出质疑。我会说越复杂，对框架的需求就越大。网站越简单，从头开始编写就越容易。

# mysql - 使用 LIKE 列值匹配行

> ID：15304292
> 
> 赞同：1
> 
> 时间：2013-03-08T22:18:07.997
> 
> 标签：mysql, sql

我正在尝试使用 LIKE 而不是使用 JOINS 在不同表之间匹配 id，这是必要的，因为以下情况

我有 2 个表，第一个称为 order，第二个称为 order_items。

对于每个订单，可以有多个订单项目，因此例如典型的表值可能如下所示...

```
Table orders

id      sell_price       buy_price
0001    50               20

Table order_items 

id      sell_price       buy_price
0001-1  30               15
0001-2  20               5 
```

我尝试创建一个查询，该查询将能够`0001`使用 LIKE 返回订单项目`0001-1`和`0001-2`.

```
SELECT 
o.id AS order_id, 
oi.id AS order_item_id,
oi.sell_price AS order_item_sell_price, 
oi.buy_price AS order_item_buy_price  
FROM orders o, order_items oi 
WHERE oi.id LIKE o.id + '%' 
ORDER BY o.purchase_date DESC 
```

**不返回任何结果！**

问题似乎与 LIKE 语句有关，我认为这是声明它的正确方法，但我想不是，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:21:15.230

尝试使用`CONCAT`：

```
SELECT 
o.id AS order_id, 
oi.id AS order_item_id,
oi.sell_price AS order_item_sell_price, 
oi.buy_price AS order_item_buy_price  
FROM orders o, order_items oi 
WHERE oi.id LIKE CONCAT(o.id, '%')
ORDER BY o.purchase_date DESC 
```

`JOIN`如果你愿意，你仍然可以使用：

```
SELECT 
o.id AS order_id, 
oi.id AS order_item_id,
oi.sell_price AS order_item_sell_price, 
oi.buy_price AS order_item_buy_price  
FROM orders o
JOIN order_items oi on oi.id LIKE CONCAT(o.id, '%')
ORDER BY o.purchase_date DESC 
```

一个简化的 sqlfiddle：[http ://sqlfiddle.com/#!2/e6b12/6](http://sqlfiddle.com/#!2/e6b12/6)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T15:54:00.137

最好将 ORDER 的 ID 从 ORDER_ITEMS 的 ID 移出到 ORDER_ITEMS 中的另一列 ORDER_ID。原因是您可以索引 ORDER_ID 列，这使您的 SQL 查询运行得更快。

# mysql - MySQL 和连接

> ID：15304298
> 
> 赞同：1
> 
> 时间：2013-03-08T22:18:47.467
> 
> 标签：mysql, join

我现在正在为 MySQL 苦苦挣扎。基本上，我有三个表：

*   评论（id，thread_id，...）
*   线程（id，forum_id，...）
*   论坛（ID，...）

这就是我想出的从特定论坛中选择所有线程的方法：

```
SELECT * FROM threads WHERE forum_id IN (
    SELECT *
    FROM threads
    WHERE id = 4
) 
```

现在，我不明白如何从特定论坛中选择所有评论。

不能这么难吗？！！

鲍勃

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:22:17.593

试试这个

```
 select * from threads 
 inner join forums
 on forums.id = threads.forum_id
 inner join comments
 on comments.thread_id = threads.id
 where threads.id = 4 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T02:05:13.313

试试这个：

```
 select comments.* 
 from forums
 left join threads
 on threads.forum_id = forums.id and forums.id = 4
 left join comments 
 on threads.id = comments.thread_id
 ; 
```

在阅读了这个问题后，我认为 Bob 想要来自 id 4 的论坛的所有评论。不确定我是否正确。

# php - 使用 SQL SELECT Query 使用 PHP 和 Form 进行多重排序

> ID：15304300
> 
> 赞同：5
> 
> 时间：2013-03-08T22:18:57.117
> 
> 标签：php, sql

我使用具有 6 个标准的 html 表单，`$_POST`在变量中使用 lat 的转换标准，如下所示：

案例 1 - 所有条件都是默认
`$core = null; $mhz = null; $ram = null; $cam = null; $mAh = null $screen = null`
的正确的 sql 查询是这样的：
`$sql = "SELECT * FROM $tbl_name ORDER BY performanta_cpu_core DESC, performanta_cpu DESC, performanta_rami DESC LIMIT $start, $limit";`

案例 2 - 仅设置一个条件
`$core = null; $mhz = "performanta_cpu=1400"; $ram = null; $cam = null; $mAh = null $screen = null`
正确查询是这样的：
`$sql = "SELECT * FROM $tbl_name WHERE $mhzz ORDER BY performanta_cpu_core DESC, performanta_cpu DESC, performanta_rami DESC LIMIT $start, $limit";`

案例 3 - 这是设置的所有或多个标准的问题：
`$core = 2; $mhz = "performanta_cpu=1400"; $ram = "performanta_rami=1024"; $cam = "camera_spate=3.2"; $mAh = "baterie_mAh=2250"; $screen = "densitate=441";`

我知道我需要在`WHERE`设置任何变量时使“”成为动态和可见的，并且我还需要一个“ `AND`”也动态地像：

`$sql = "SELECT * FROM $tbl_name WHERE $core AND $mhzz ORDER BY performanta_cpu_core DESC, performanta_cpu DESC, performanta_rami DESC LIMIT $start, $limit";`
我为此压力了一个星期，没有帮助我无法前进......

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:32:41.210

免责声明：这是一个糟糕的代码，有上百万种更好的方法可以做到这一点，但是，这是最简单的解释。

```
$parameters = array();
if(!empty($core)){
$parameters['core'] = $core;
}
if(!empty($mhz)){
$parameters['mhz'] = $mhz;
}
if(!empty($ram)){
$parameters['ram'] = $ram;
}
if(!empty($cam)){
$parameters['cam'] = $cam;
}
if(!empty($mAh)){
$parameters['mAh'] = $mAh;
}
if(!empty($screen)){
$parameters['screen'] = $screen;
}

$sql = "SELECT * FROM $tbl_name WHERE 1=1 ";
foreach($parameters as $k=>$v){
 $sql .= " AND ".$k."='".$v."'";
}
$sql .=  " ORDER BY performanta_cpu_core DESC, performanta_cpu DESC, performanta_rami DESC LIMIT $start, $limit";

// All of those parameters should be sanitized to prevent SQL injection.
// mysql_* is deprecated, use mysqli_* or PDO. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:33:31.080

格式精美的问题..做得好。

我很可能误解了这个问题，但是我认为您是在问如何动态构建查询。也许你不知道你连接字符串？

例如。

```
if ($core != null) {$query.= 'AND core ='.$core;} 
```

我希望这能让你朝着正确的方向前进。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T22:41:10.430

从查询的开头开始，为了使命令更容易构建，请添加“始终为真”的 WHERE 条件：

```
$sql = "SELECT * FROM $tbl_name WHERE 1=1"; 
```

然后检查您的变量并根据需要添加到 WHERE 条件（AND 之前的空格非常重要）：

```
if ($core) $sql .= " AND performanta_cpu_core = '$core'";
if ($mhz) $sql .= " AND whatever = '$mhz'";
... and so on for the other four variables 
```

然后附加您的 ORDER BY 和 LIMIT 就完成了（ORDER BY 之前的空格非常重要）：

```
$sql .= " ORDER BY performanta_cpu_core DESC, performanta_cpu DESC, performanta_rami DESC LIMIT $start, $limit"; 
```

此外，正如 Mahmut 指出的那样，你不能拥有`WHERE $mhz`，你必须拥有`WHERE your-column-name = $mhz`。

确保首先从 MySQL 命令行或 WorkBench 尝试查询。这将帮助您处理语法，包括哪些列需要单引号，哪些不需要。

这不是组装查询的理想方式，但它会起作用，而且看起来您刚刚开始使用 PHP/MySQL，因此无需一次性投入太多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-08T22:42:34.467

```
$parameters = array();
if(!empty($core)){
    $parameters[] = "core = '$core'";
}
if(!empty($mhz)){
    $parameters[] = "mhz = '$mhz'";
}
if(!empty($ram)){
    $parameters[] = "ran = '$ram'";
}
if(!empty($cam)){
    $parameters[] = "cam = '$cam'";
}
if(!empty($mAh)){
    $parameters[] = "mAh = '$mAh'";
}
if(!empty($screen)){
    $parameters[] = "screen = $screen";
}

if (empty($parameters)) {
   $whereclause = "";
} else {
   $whereclause = "WHERE " . join(' AND ', $parameters);
}

$sql = "SELECT * FROM $tbl_name $whereclause ORDER BY performanta_cpu_core DESC, performanta_cpu DESC, performanta_rami DESC LIMIT $start, $limit"; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-08T22:47:19.903

您可以使用[`array_filter`](http://www.php.net/manual/en/function.array-filter.php)and[`implode`](http://www.php.net/manual/en/function.implode.php)来构建您的`where`子句

```
$conditions = array_filter(array($core, $mhz, $ram, $cam, $mAh, $screen));
$clause = implode(' and ', $conditions); 
```

这将所有非空元素保留为`$conditions`，然后将它们与`and`. 然后，您可以将其用作

```
'... where ' . $clause . '...' 
```

# asp.net - how do I send emails in asp.net via code

> ID：15304301
> 
> 赞同：1
> 
> 时间：2013-03-08T22:19:02.997
> 
> 标签：asp.net, email, outlook

I'm having great difficulty figuring out how to send emails through my asp.net website, through a registered/online domain on a UKFasts Cloud Shared VPS.

My website and domain names are hosted with UKFast on one of their Cloud/VPS servers (eg. www.mysite.co.uk). My web app is hosted on a dedicated server (eg. www.mysite-ssl.co.uk). I want to send emails via the domain registered on my VPS, from the dedicated server.

I can connect via Outlook, and send receive emails without any issue: ![Outlook Setup](../Images/9dcc8376ed507915005a4c8b06309536.png)

However, because I'm on a VPS/Cloud server, UKFast advise I have to use "localhost" or "127.0.0.1" if I'm sending from code. But I'm failing to see what is different to Outlook connecting and sending emails, to what my code is trying to do from the dedicated server, via the VPS domain/mail:

```
Imports System.Net.Mail

Public Shared Function SendMail(ByVal email As String, ByVal name As String, ByVal hear As String, ByVal mess As String) As String

    Dim mail As New MailMessage()

    mail.From = New MailAddress(email)
    mail.To.Add("******@gmail.com")

    mail.Subject = "Contact Email from My Website"
    mail.IsBodyHtml = True
    Dim str As String = "<table border=""1"" cellpadding=""4"" cellspacing=""0""><tr><td>Name:</td><td>" & name & "</td></tr><tr><td>" & "Email:</td><td>" & email & "</td></tr><tr><td>Hear:</td><td>" & hear & "</td></tr><tr><td valign=""top"">Message:</td><td>" & mess.Replace(Chr(10), "<br />") & "</td></tr></table>"

    mail.Body = str

    Dim smtp As New SmtpClient("mail.-same as outgoing mail server in Outlook-.co.uk")
    smtp.Port = 25
    smtp.Credentials = New System.Net.NetworkCredential("UserNameFromOutlook","PasswordFromOutlook")
    Try
        smtp.Send(mail)
    Catch ex As Exception
        Return ex.ToString

        Return ("error")
    End Try

    Return ("ok")
End Function 
```

However, when sending this from the asp.net page, I get the error:

> System.Net.Mail.SmtpException: Failure sending mail. ---> System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it (myipaddress):25 at System.Net.Sockets.Socket.

I can't see why Outlook can connect with no issues, but my SendMail code can't do the same, with the same credentials.

My web.config has:

```
<configuration>
<system.net>
    <mailSettings>
        <smtp from="info@busybeesdingwall.co.uk">
            <network host="mail.-same as outgoing mail server in Outlook-" port="25" userName="UserNameFromOutlook" password="PasswordFromOutlook" />
        </smtp>
    </mailSettings>
</system.net>
</configuration> 
```

Is there something wrong with my code, that I can change to allow me to send emails?

Thanks for any help,

Mark

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:33:50.070

```
 protected void Btn_SendMail_Click(object sender, EventArgs e)
    {
        MailMessage mailObj = new MailMessage(
        "noreplay@myDomain.com", toTextBox.Text, subTextBox.Text, msgTextBox.Text);

        SmtpClient SMTPServer = new SmtpClient("yourSMTPServer", 25);

        try
        {
            SMTPServer.Send(mailObj);
        }
        catch (Exception ex)
        {
            Label1.Text = ex.ToString();
        }

        Label1.Text = "Msg sent";
    } 
```

* * *

您只需要添加控件

`toTextBox, subTextBox, msgTextBox`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:34:42.090

您没有与您的主机连接。要检查的第一个区域是您的 web.config 文件。听起来您已经设置好了：

```
<mailSettings>
<smtp>
<network host="localhost" 
```

确认已设置好后，您可能需要在服务提供商中设置一些内容。通常，他们需要在工具中进行设置。

# soap - SecureNet Request Examples

> ID：15304303
> 
> 赞同：2
> 
> 时间：2013-03-08T22:19:05.690
> 
> 标签：soap, payment-gateway, gateway

I am currently trying to integrate with SecureNet. I read through the latest pdf (4.1.5) but it is still not clear to me how the request should be structured.

I keep getting:

`Endpoint not found.`

Can anyone provide production request examples with confidential fields XXX'd out?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T00:00:26.640

啊，API 团队终于回复我了。这里是。希望有一天它可以帮助某人。

要求

```
POST https://certify.securenet.com/API/gateway.svc/webHttp/ProcessTransaction HTTP/1.1
User-Agent: Fiddler
Content-Type: application/xml; charset=utf-8
Host: certify.securenet.com
Content-Length: 1839

<?xml version="1.0" encoding="utf-8"?><TRANSACTION xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://gateway.securenet.com/API/Contracts">
<AMOUNT>11</AMOUNT>
<AUTHCODE></AUTHCODE>
<AUTO i:nil="true" />
<CARD>
<CARDCODE>996</CARDCODE>
<CARDNUMBER>4012000033330026</CARDNUMBER>
<EXPDATE>0414</EXPDATE>
<KSN i:nil="true" />
<PINBLOCK>PIN Block</PINBLOCK>
<TRACKDATA i:nil="true" /></CARD>
<CASHBACK_AMOUNT>0</CASHBACK_AMOUNT>
<CHECK i:nil="true" />
<CODE>0000</CODE>
<CUSTOMERID i:nil="true"/>
<CUSTOMERIP></CUSTOMERIP>
<CUSTOMER_BILL>
<ADDRESS></ADDRESS>
<CITY></CITY>
<COMPANY></COMPANY>
<COUNTRY></COUNTRY>
<EMAIL></EMAIL>
<EMAILRECEIPT>FALSE</EMAILRECEIPT>
<FIRSTNAME></FIRSTNAME>
<LASTNAME></LASTNAME>
<PHONE></PHONE>
<STATE></STATE>
<ZIP></ZIP>
</CUSTOMER_BILL>
<CUSTOMER_SHIP i:nil="true" />
<DCI>0</DCI>
<DEVICECODE></DEVICECODE>
<ENCRYPTION i:nil="true" />
<ENTRYSOURCE></ENTRYSOURCE>
<HOTEL i:nil="true" />
<INDUSTRYSPECIFICDATA>0</INDUSTRYSPECIFICDATA>
<INSTALLMENT_SEQUENCENUM>0</INSTALLMENT_SEQUENCENUM>
<INVOICEDESC></INVOICEDESC>
<INVOICENUM i:nil="true" />
<LEVEL2 i:nil="true" />
<LEVEL3 i:nil="true" />
<MARKETSPECIFICDATA i:nil="true"/>
<MERCHANT_KEY>
<GROUPID>0</GROUPID>
<SECUREKEY>lbGXSJZsV9Oy</SECUREKEY>
<SECURENETID>7000000</SECURENETID>
</MERCHANT_KEY>
<METHOD>CC</METHOD>
<MPI i:nil="true" />
<NOTE></NOTE>
<ORDERID>12311601</ORDERID>
<OVERRIDE_FROM>0</OVERRIDE_FROM>
<PAYMENTID i:nil="true" />
<PETROLEUM i:nil="true" />
<PRODUCTS i:nil="true" />
<REF_TRANSID>0</REF_TRANSID>
<RETAIL_LANENUM>0</RETAIL_LANENUM>
<SECONDARY_MERCHANT_KEY i:nil="true" />
<SERVICE i:nil="true" />
<TEST>FALSE</TEST>
<TOTAL_INSTALLMENTCOUNT>0</TOTAL_INSTALLMENTCOUNT>
<TRANSACTION_SERVICE>0</TRANSACTION_SERVICE>
<USERDEFINED i:nil="true" />
</TRANSACTION> 
```

回复

```
HTTP/1.1 200 OK
Date: Fri, 08 Mar 2013 23:48:37 GMT
X-Powered-By: ASP.NET
X-AspNet-Version: 2.0.50727
Cache-Control: private
Content-Type: application/xml; charset=utf-8
Content-Length: 1763
Set-Cookie: TS6d10c9=d81f0c76c1ab996b6024b4b7340467c76c45ae1650897225513a7909; Path=/
Set-Cookie: TS6d10c9_28=ab9f901af259d97913f9b001c3f710f66c45ae1650897225000000000000000000513a7908522b1347a8bb858f; Path=/

<GATEWAYRESPONSE xmlns="http://gateway.securenet.com/API/Contracts" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><ABRESPONSE i:nil="true"/><TRANSACTIONRESPONSE><RESPONSE_CODE>1</RESPONSE_CODE><RESPONSE_REASON_CODE>0000</RESPONSE_REASON_CODE><RESPONSE_REASON_TEXT>Approved</RESPONSE_REASON_TEXT><RESPONSE_SUBCODE/><ADDITIONALAMOUNT>0</ADDITIONALAMOUNT><ADDITIONALDATA1/><ADDITIONALDATA2/><ADDITIONALDATA3/><ADDITIONALDATA4/><ADDITIONALDATA5/><AUTHCODE>CRO3B4</AUTHCODE><AUTHORIZEDAMOUNT>11.00</AUTHORIZEDAMOUNT><AVS_RESULT_CODE>Y</AVS_RESULT_CODE><BANK_ACCOUNTNAME/><BANK_ACCOUNTTYPE/><BATCHID>0</BATCHID><CARDHOLDER_FIRSTNAME/><CARDHOLDER_LASTNAME/><CARDLEVEL_RESULTS/><CARDTYPE>VI</CARDTYPE><CARD_CODE_RESPONSE_CODE>M</CARD_CODE_RESPONSE_CODE><CASHBACK_AMOUNT>0</CASHBACK_AMOUNT><CAVV_RESPONSE_CODE/><CHECKNUM i:nil="true"/><CODE>0000</CODE><CUSTOMERID/><CUSTOMER_BILL><ADDRESS/><CITY/><COMPANY/><COUNTRY/><EMAIL/><EMAILRECEIPT>FALSE</EMAILRECEIPT><FIRSTNAME/><LASTNAME/><PHONE/><STATE/><ZIP/></CUSTOMER_BILL><EXPIRYDATE>0414</EXPIRYDATE><GRATUITY>0</GRATUITY><INDUSTRYSPECIFICDATA>P</INDUSTRYSPECIFICDATA><LAST4DIGITS>0026</LAST4DIGITS><LEVEL2_VALID>FALSE</LEVEL2_VALID><LEVEL3_VALID>FALSE</LEVEL3_VALID><MARKETSPECIFICDATA/><METHOD>CC</METHOD><NETWORKCODE/><NETWORKID/><ORDERID>12311601</ORDERID><PAYMENTID/><RETREFERENCENUM/><SECURENETID>7000000</SECURENETID><SETTLEMENTAMOUNT>11.00</SETTLEMENTAMOUNT><SETTLEMENTDATETIME>03082013184837</SETTLEMENTDATETIME><SYSTEM_TRACENUM/><TRACKTYPE>0</TRACKTYPE><TRANSACTIONAMOUNT>11.00</TRANSACTIONAMOUNT><TRANSACTIONDATETIME>03082013184837</TRANSACTIONDATETIME><TRANSACTIONID>111177310</TRANSACTIONID></TRANSACTIONRESPONSE><VAULTACCOUNTRESPONSE i:nil="true"/><VAULTCUSTOMERRESPONSE i:nil="true"/></GATEWAYRESPONSE> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-25T05:14:10.600

这篇文章对我很有帮助，因为它向我展示了一些最初不可见的字段。如果您不想使用 SecureNet 的 CodeIgniter 类，我整理了一个简单的基于 PHP/SOAP 的示例来执行退款/捕获/无效。将其适应其他任何东西应该不会太困难。

```
//Certifying?
$certify = 1;

//Build Array
$arg = array(
    "MERCHANT_KEY" => array(
        "GROUPID" => 0,
        "SECUREKEY" => "XXXXXXXXX",
        "SECURENETID" => "XXXXXXXXX",
    ),
    "CARD" => array(
        "CARDNUMBER" => $card_number,
    ),
    "REF_TRANSID" => $processor_transaction_id,
    "AMOUNT" => $amount,
    "METHOD" => "CC",
    "DCI" => 0,
    "INSTALLMENT_SEQUENCENUM" => 0,
    "GROUPID" => 0,
    "OVERRIDE_FROM" => 0,
    "RETAIL_LANENUM" => 0,
    "TOTAL_INSTALLMENTCOUNT" => 0,
    "TRANSACTION_SERVICE" => 0,
    "TEST" => $testing ? "FALSE" : "TRUE",
);

//Refund
if ($action == "refund") {
    $arg['CODE'] = "0500";

//Capture
} elseif ($action == "capture") {
    $arg['CODE'] = "0200";

//Partial Void
} elseif ($action == "void") {
    $arg['CODE'] = "0401";
}

//Certify or Production URL's
$base_url = "http://gateway.securenet.com/api/gateway.svc?wsdl"; //not for sure on these urls
$soap_url = "https://gateway.securenet.com/api/gateway.svc/soap"; //not for sure on these urls
if ($certify) {
    $base_url = "http://certify.securenet.com/api/gateway.svc?wsdl";
    $soap_url = "https://certify.securenet.com/api/gateway.svc/soap";
}

//Connect
$client = new \SoapClient($base_url, array('trace' => 1, 'exceptions' => true));
$client->__setLocation($soap_url);

//Successful!
try {
    $result = $client->ProcessTransaction(array("TRANSACTION" => $arg));

    if ($certify) {
        echo 'REQUEST: ' . htmlentities($client->__getLastRequest()) . "<br><br>";
        echo 'RESPONSE: ' . htmlentities($client->__getLastResponse());
    }

    //1 = approve, 2 = declined, 3 = error
    $response_code = $result->ProcessTransactionResult->TRANSACTIONRESPONSE->RESPONSE_CODE;
    $response_text = $result->ProcessTransactionResult->TRANSACTIONRESPONSE->RESPONSE_REASON_TEXT;

//There Was An Error
} catch (\Exception $e) {

    if ($certify) {
        echo 'REQUEST: ' . htmlentities($client->__getLastRequest()) . "<br><br>";
        echo 'RESPONSE: ' . htmlentities($client->__getLastResponse());
    }

    echo "ERROR: " . $e->getMessage() . "<br><br>";
    die;

} 
```

其他有用的是这些文档，这些文档在 SecureNet 上似乎不再可用。[http://www.scribd.com/doc/202100111/SecureNet-Docs](http://www.scribd.com/doc/202100111/SecureNet-Docs)

# python - simple regex issue

> ID：15304304
> 
> 赞同：0
> 
> 时间：2013-03-08T22:19:08.300
> 
> 标签：python, regex, python-2.7

I have two almost idential expressions and I'm getting one good and another way wrong output.

```
data/holidays/photos-2012-2013/word-another-more-more-5443/"><span class="bold">word another</span> - word</a>    

regex = 'data/holidays/photos-2012-2013/.+?(\d{4})/"><span class="bold">(.+?)</span>(.+?)</a>' 
```

`word-another-more-more`, `word another` and `word`, this all in the above changes. The above prints out correctly, a list of tuples like this: `('6642', 'word another', ' - word')`

```
data/holidays/photos-2012-2013/word-another-more-more-5443/">word- another - <span class="bold">word another</span></a>

regex1 = 'data/holidays/photos-2012-2013/.+?(\d{4})/">(.+?)<span class="bold">(.+?)</span></a>' 
```

This above prints out some trash code, despite the syntax used is idential. Output is a list containing tuples too, but is full of unwanted code.

Can you see what's wrong about the second regex?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:22:10.320

为我工作：

```
>>> import re
>>> text = 'data/holidays/photos-2012-2013/word-another-more-more-5443/">word- another - <span class="bold">word another</span></a>'
>>> re.findall(r'data/holidays/photos-2012-2013/.+?(\d{4})/">(.+?)<span class="bold">(.+?)</span></a>', text)
[('5443', 'word- another - ', 'word another')] 
```

注意：*请*不要使用正则表达式解析 HTML。[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)就是因为这个原因而存在的。

# objective-c - Is it good practice to make an NSSplitView the root view for a view controller?

> ID：15304306
> 
> 赞同：2
> 
> 时间：2013-03-08T22:19:19.457
> 
> 标签：objective-c, xcode, macos, interface-builder, nsviewcontroller

Is it good practice to use an NSSplitView as the root view for a view controller? I am relatively new to Objective-C OSX development and can not seem to find an answer regarding this topic. I noticed that NSViews were created by default as the root view in IB but I normally remove it and assign a new NSSplitView as the root view for a view controller that needs a multi-pane layout. Any OSX veterans out there know if this is ok? I am trying to keep nested views to a minimum.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:45:38.620

> 使用 NSSplitView 作为视图控制器的根视图是一种好习惯吗？

我想说尝试使您的 Window 的根视图成为 NSSplitView 不一定是好或坏的做法（特别是因为 NSWindow 的设计者声明它的`rootView`属性是完全独立于类型的（`id`））。可以提出一个论点，即更扁平的视图层次结构总是一件好事。但是，话又说回来，也可以提出这样的论点，即 NSWindow 的设计者希望它`rootView`尽可能接近 NSView。无论哪种方式，请确保您的代码反映此更改并`rootView`在适当的情况下转换值。

# python - wxpython textentrydialog won't appear

> ID：15304308
> 
> 赞同：0
> 
> 时间：2013-03-08T22:19:26.503
> 
> 标签：python, textbox, dialog, wxpython

I am following a tutorial to try to learn to use Wxpython, so I do not fully understand what is going on yet, but when I run the following code it seems like a text dialog box should appear and ask me for my name, however the dialog box does not appear and thus the nameA variable is not assigned a value so I get the error below. What am I doing wrong?

Python Program:

```
import wx

class main(wx.Frame):
    def __init__(self, parent, id):
        wx.Frame.__init__(self, parent, id, "Test Window", size = (300, 200))
        panel = wx.Panel(self)

        text= wx.TextEntryDialog(None, "What is your name?", "Title", " ")
        if text.ShowModal == wx.ID_OK:
            nameA = text.GetValue()

        wx.StaticText(panel, -1, nameA, (10, 10))

if __name__ == "__main__":
    app = wx.PySimpleApp()
    frame = main(parent=None, id= -1)
    frame.Show()
    app.MainLoop() 
```

The error I recieve:

```
Traceback (most recent call last):
  File "C:\Users\Taylor Lunt\Desktop\deleteme.py", line 17, in <module>
    frame = main(parent=None, id= -1)
  File "C:\Users\Taylor Lunt\Desktop\deleteme.py", line 12, in __init__
    wx.StaticText(panel, -1, nameA, (10, 10))
UnboundLocalError: local variable 'nameA' referenced before assignment 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:35:26.557

如果您不回答 OK 则`nameA`不会设置。
例如，使用一个`else`子句给它一个替代值：

```
text= wx.TextEntryDialog(None, "What is your name?", "Title", " ")
if text.ShowModal == wx.ID_OK:         # this is not correct. see edit
    nameA = text.GetValue()
else:
    nameA = 'Nothing' 
```

或者在子句`nameA`之前给出一个默认值。`if`

编辑：
如前所述，您的代码中还有一些问题：

1.  你需要调用`ShowModal()`它才能工作。
2.  可能您想在阅读答案后关闭对话框。
3.  也许您想为变量提供更充分/常规的名称

然后你将拥有：

```
dlg = wx.TextEntryDialog(None, "What is your name?", "Title", " ")

answer = dlg.ShowModal()

if answer == wx.ID_OK:
    nameA = dlg.GetValue()
else:
    nameA = 'Nothing'

dlg.Destroy() 
```

# html - How to install a syntax file for VIM on OS X

> ID：15304311
> 
> 赞同：2
> 
> 时间：2013-03-08T22:19:47.807
> 
> 标签：html, vim

I followed the instructions of a tutorial I read and downloaded the following file into *~/.vim/syntax*: [html5.vim](https://gist.github.com/rcmachado/256840/raw/6a1ce1c894236adc5859d4710fda3df9ea750ac6/html5.vim).

However, when I opened up vim I didn't see any of my HTML5 keywords highlighted. I had to type `:source ~/.vim/syntax/html5.vim` to see the changes take effect. (For what it's worth, I had to create this directory myself - it didn't exist beforehand.)

Why didn't vim automatically detect this file? Do I have to add `source /path/to/syntax.vim` to *.vimrc* every time I want to include a new syntax file?

**Edit:**

Figured out the answer. I moved html5.vim into *~/.vim/after/syntax/html/html5.vim*. It now knows to add these changes for html filetypes.

# mysql - 如何检索前 10 个条目？

> ID：15304312
> 
> 赞同：0
> 
> 时间：2013-03-08T22:20:02.757
> 
> 标签：mysql, sql

我有一个看起来像这样的 MySQL 表 - ![描述](../Images/11c5a23d9cce7e7e5de4a85eb6a327e4.png)

我现在想`athleteName`根据`time`. 我知道我可以使用`top`子句，但它会返回基于前 10 个 ID 的条目。如何检索基于`time`. 我想让运动员获得前 10 名的记录时间。

什么是正确的 SQL 语句？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:21:49.567

```
select atheletename from table order by time limit 0,10 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:21:55.290

```
select * from scores order by time desc limit 0,10 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T22:22:06.060

```
select *
from yourtable
order by time desc
limit 10 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T22:24:59.197

试试这个

```
 select max(`time`) ,atheletename from table order by atheletename limit 10 DESC 
```

# bash - text substitution

> ID：15304313
> 
> 赞同：0
> 
> 时间：2013-03-08T22:20:22.453
> 
> 标签：bash

I have a list of files that are in the form `foo001.h21.tif` that I need to rename. I know how to substitute strip off the end of the filename, but not the beginning. I basically need to strip it so it can be saved as `001.h21.tif`. Normally I would use:

```
for i in *.tif; do mv $i ${i%%.tif}; done 
```

to capture everything preceding `.tif`. Can someone help me with figuring out how to go the opposite way?

THanks!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:23:31.317

`%`and `%%`are 是 what 的后缀`#`，`##`are 是前缀。在你的情况下，你可以写：

```
for filename in foo*.tif; do mv "$filename" "${filename#foo}"; done 
```

请参阅[*Bash 参考手册*](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)[中的第 3.5.3 节“Shell 参数扩展”](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion)*。*

# jquery - 删除 "$" + sum.toFixed(2)

> ID：15304314
> 
> 赞同：2
> 
> 时间：2013-03-08T22:20:23.147
> 
> 标签：jquery, calculator

我正在使用 Pengoworks jquery 计算器并且不希望我的总和被四舍五入。即：如果总和为 19.99，则四舍五入为 19。

我“认为”它在这里：“$”+ sum.toFixed(2)

完整代码在这里：[http ://www.pengoworks.com/workshop/jquery/calculation/calculation.plugin.htm](http://www.pengoworks.com/workshop/jquery/calculation/calculation.plugin.htm)

完整代码

```
<script type="text/javascript">
    var bIsFirebugReady = (!!window.console && !!window.console.log);

    $(document).ready(
        function (){
            // update the plug-in version
            $("#idPluginVersion").text($.Calculation.version);

/*
// test precision
$("body").prepend("<div id='nn'></div>");
$("#nn").calc(
    // the equation to use for the calculation
    "qty * price",
    // define the variables used in the equation, these can be a jQuery object
    {
        qty: 23,
        price: 1.4
    }   
);
*/

/*          
            $.Calculation.setDefaults({
                onParseError: function(){
                    this.css("backgroundColor", "#cc0000")
                }
                , onParseClear: function (){
                    this.css("backgroundColor", "");
                }
            });
*/

            /*$("#qty_1082").keyup(function(){
                var dInput = $(this).val();
        alert(dInput);
            });*/

            /* ADDITION FOR VARIABLE DISCOUNTS - START */

            //bind check_discount on key up - MUST BE BEFORE recalc Function
            $("input[name^=qty_item_]").bind("keyup", check_discount);
            check_discount();
        /*  $( "input[name^=qty_item_]" ).each(function() {
                alert(this.name);
            });*/

            function check_discount(){
                $( "input[name^=qty_item_]" ).each(function() {
                    var input_value = $(this).val(); //get the value (amount of books) for the current input field being modified
                    var current_input_id = this.name; //get the name field for the current input field being modified   
                    var current_price=current_input_id.replace("qty","price"); //swap text to make it match the mathing price field

                    //Series of staments to determine the appropriate action
                    if(input_value < 10){
                        //alert("There is a minimum order of 10 books per title");
                        $("#"+current_price).text("$0.00"); //If between 50 and 99 adjust rate

                    } else if (input_value >= 10 && input_value <=49){
                        //alert("Between 10 - 49");
                        $("#"+current_price).text("$7.46"); //If between 50 and 99 adjust rate

                    } else if (input_value >= 50 && input_value <=99){
                        //alert("Between 50 - 99");
                        $("#"+current_price).text("$5.97"); //If between 50 and 99 adjust rate

                    } else if (input_value >= 100 ){
                        //alert("Over 100");
                        $("#"+current_price).text("$5.47"); //If over 100 adjust rate
                    } else{

                    }

                });

            }

            /* ADDITION FOR VARIABLE DISCOUNTS - END */

            // bind the recalc function to the quantity fields
            $("input[name^=qty_item_]").bind("keyup", recalc);
            // run the calculation function now
            recalc();

            // automatically update the "#totalSum" field every time
            // the values are changes via the keyup event
            $("input[name^=sum]").sum("keyup", "#totalSum");

            // automatically update the "#totalAvg" field every time
            // the values are changes via the keyup event
            $("input[name^=avg]").avg({
                bind:"keyup"
                , selector: "#totalAvg"
                // if an invalid character is found, change the background color
                , onParseError: function(){
                    this.css("backgroundColor", "#cc0000")
                }
                // if the error has been cleared, reset the bgcolor
                , onParseClear: function (){
                    this.css("backgroundColor", "");
                }
            });

            // automatically update the "#minNumber" field every time
            // the values are changes via the keyup event
            $("input[name^=min]").min("keyup", "#numberMin");

            // automatically update the "#minNumber" field every time
            // the values are changes via the keyup event
            $("input[name^=max]").max("keyup", {
                selector: "#numberMax"
                , oncalc: function (value, options){
                    // you can use this to format the value
                    $(options.selector).val(value);
                }
            });

            // this calculates the sum for some text nodes
            $("#idTotalTextSum").click(
                function (){
                    // get the sum of the elements
                    var sum = $(".textSum").sum();

                    // update the total
                    $("#totalTextSum").text("$" + sum.toString());
                }
            );

            // this calculates the average for some text nodes
            $("#idTotalTextAvg").click(
                function (){
                    // get the average of the elements
                    var avg = $(".textAvg").avg();

                    // update the total
                    $("#totalTextAvg").text(avg.toString());
                }
            );
        }
    );

    function recalc(){
        $("[id^=total_item]").calc(
            // the equation to use for the calculation
            "qty * price",
            // define the variables used in the equation, these can be a jQuery object
            {
                qty: $("input[name^=qty_item_]"),
                price: $("[id^=price_item_]")
            },
            // define the formatting callback, the results of the calculation are passed to this function
            function (s){
                // return the number as a dollar amount
                return "$" + s.toFixed(2);
            },
            // define the finish callback, this runs after the calculation has been complete
            function ($this){
                // sum the total of the $("[id^=total_item]") selector
                var sum = $this.sum();

                $("#grandTotal").text(
                //$("#grandTotal").text(
                //$("input[name^=grandTotal]").text(

                    // round the results to 2 digits
                    "$" + sum.toFixed(2)

                );
            }

        );

    }

    function test()
    {
        //Stores the grandtotal to var g_total
        var g_total = $("#grandTotal").text();    

        //Reforats..   $496.00  -->  496
        // Makes it workable
        var myArray = g_total.split('$');
        var myNewArray = myArray[1].split('.');

        //Submits the value to the #this works on line 391
        $('#thisworks').val(myNewArray[0]);

    }

    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:31:34.903

`var myNewArray = myArray[1].split('.');`将创建一个这样的数组：

```
myArray = ["19", "99"]; 
```

如果您希望它返回 19.99，您可以更改：

```
$('#thisworks').val(myNewArray[0]); 
```

至：

```
$('#thisworks').val(myNewArray.join('.')); 
```

或者您可以在拆分之前使用该值：

```
$('#thisworks').val(myArray[1]); 
```

我不确定这些是否是最好的解决方案，但它应该可以工作。

# haskell - 解释和编译的Haskell之间ncurses的区别？

> ID：15304317
> 
> 赞同：10
> 
> 时间：2013-03-08T22:20:43.467
> 
> 标签：haskell, ghc, ncurses, ghci, runhaskell

`timeout`我对函数和`getch`Haskell 中使用的 ncurses 库有一个奇怪的问题。当我从 GHCi 或 runhaskell 使用它们时，它们按预期工作——`getch`等待给定的毫秒数，`timeout`然后返回，即使没有给出输入。但是当我使用 GHC*编译*同一个文件时，`getch`立即返回。

我为 Haskell 尝试了两个 ncurses 绑定；`hscurses`：

```
import UI.HSCurses.Curses

main = do
  initCurses
  timeout 1000
  c <- getch
  endWin
  print c 
```

和`ncurses`：

```
import UI.NCurses

main = do
  e <- runCurses $ do
    win <- defaultWindow
    getEvent win $ Just 1000
  print e 
```

两者的行为方式与之前描述的相同。

我还尝试了 C 中的等效程序：

```
#include <ncurses.h>

int main()
{
  initscr();
  wtimeout(stdscr,1000);
  int c = getch();
  endwin();
  printf("%d\n", c);
  return 0;
} 
```

这个按预期工作。

所以我的问题是：在解释和编译的 Haskell 中使用终端时会有什么不同？runhaskell 和 ghci 会修改一些微妙的终端设置吗？还是编译后的代码以不同的方式加载库？

**添加：**

我尝试使用 FFI 从已编译的 Haskell 中调用 C 程序，它立即返回（这是不正确的）。我认为这意味着问题不在于库，而在于 GHC 运行时的某个地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T16:00:57.443

我使用 runhaskell 和 ghc 使用以下命令尝试了您的代码 - 稍微修改了更大的超时值：

```
$ runhaskell so_15305317.hs

$ ghc -packages hscurses -lncurses so_15305317.hs
$ ./a.out 
```

在这两种情况下，我都得到了预期的行为。您的 ghc 安装必须被破坏，或者用于编译的命令包括破坏库行为的参数。

ghc 版本是 6.12.1，hcurses 是 1.13.0.2，在 debian 6.0.5 系统上。

# javascript - javascript继承为什么使用Object.create？

> ID：15304318
> 
> 赞同：2
> 
> 时间：2013-03-08T22:20:49.580
> 
> 标签：javascript, jquery, backbone.js

我在 StackOverflow 中看到了这一点： [https ://stackoverflow.com/a/7786090/289246](https://stackoverflow.com/a/7786090/289246)

答案告诉你要做：

```
DynamicBody.prototype = Object.create( PhysicsBody.prototype ); 
```

使用 Object.create 的原因是什么？
为什么我们不能只使用：

```
DynamicBody.prototype = PhysicsBody.prototype; 
```

?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-08T22:23:18.673

您可以（技术上），但是您所做的任何更改`DynamicBody.prototype`也将在 上进行`PhysicsBody.prototype`，即它将影响所有`PhysicsBody`实例，而这通常不是您想要的。

例子：

```
function Foo() {};
Foo.prototype.say = function() {
   alert('Foo');
};
var foo = new Foo();

function Bar() {};
Bar.prototype = Foo.prototype;
Bar.prototype.say = function() {
    alert('Bar');
};

foo.say(); // alerts 'Bar' 
```

`Object.create`增加一层间接性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:32:12.003

Javascript 具有基于原型的继承。这意味着，继承直接从对象发生，与从类继承的经典继承不同。

当你这样做时：

`Foo.protoype = Bar.prototype`- 您正在从`Bar`对象继承所有变量和方法。但是对 ' 原型的任何更改`Foo`都将导致`Bar`' 原型被更改（由于上述声明，`Foo.prototype`引用`Bar.prototype`）。

`Object.create()`用于将经典继承（如属性）添加到`Foo`. 因此，您不是直接从对象继承，而是从`Object`指定的原型继承。`Foo`并且声明之后的任何更改`Foo.prototype = Object.create(Bar.prototype)`都不会改变`Bar`。

看到[这里](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)了解更多信息！

# java - 我可以将 MouseMotionListener 添加到 Java 中的另一个线程吗？

> ID：15304319
> 
> 赞同：1
> 
> 时间：2013-03-08T22:20:52.600
> 
> 标签：java, multithreading, swing, mouseevent

我有一个非常繁忙的线程试图做所有事情，它开始减慢我的 MouseMotionListener。我想我会把监听器放在另一个线程中，以确保它总是尽可能快地运行，但是一旦我做到了：

```
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionListener;

public class MouseListenerThread extends Thread implements MouseMotionListener {

    public void run(){
        //Concurrency happens here  
    }

    public void mouseDragged(MouseEvent e) {
        // Do something 
    }

    public void mouseMoved(MouseEvent e) {
        // Do something else
    }
} 
```

我意识到虽然我可以将这个其他对象功能用作鼠标侦听器，但我不能同时执行此操作。有什么办法可以使用run函数来实现监听吗？我也会接受任何其他加快听众速度的解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:33:23.393

接收`mouseDragged`etc 的实际侦听器必须在事件调度线程 (EDT) 上。在这些事件处理方法中完成的任何“非 GUI”工作都可以使用`SwingWorker`或任何其他线程方法转移到其他线程。

所有的 GUI 工作都必须在事件调度线程中，所以如果事件处理程序因为 GUI 的东西而变慢，你可能会遇到麻烦，但你可以使用`SwingUtilities.InvokeLater`触发任何线程来为 EDT 线程安排一些工作。您也可以使用`InvokeAndWait`，但这开始将您的 GUI 与支持的图形紧密结合...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:34:12.843

所有事件都由事件调度线程调度。将鼠标侦听器放在另一个线程中绝对没有区别，因为事件方法将在 EDT 的上下文中得到通知

Swing 是一个单线程框架。这意味着与 UI 的所有交互都必须在 EDT 上下文中执行。因此，即使您可以将工作卸载到另一个线程，您也需要使用 EDT 重新同步对 UI 的任何更改/更新。

您可能想通读[Swing 中的并发以](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)了解详细信息。

如果您在 EDT 中执行长时间运行/阻塞的任务，您可能希望考虑使用`SwingWorker`，这将允许您在单独的线程中运行任务，但提供了简化更新 UI 过程的方法

# slickedit - 如何在 SlickEdit 中保存和恢复窗口布局？

> ID：15304321
> 
> 赞同：0
> 
> 时间：2013-03-08T22:21:00.087
> 
> 标签：slickedit

使用[SlickEdit](http://www.slickedit.com/) IDE 时，有没有办法保存和恢复窗口布局？

关闭和重新打开工作区时会保存窗口布局。多个工作区将允许多个窗口布局，即使在查看相同的项目时也是如此。但是，多个工作区会创建多个标记文件，对于大型项目，这需要很长时间才能重新构建。

有没有办法在一个工作区中保存和恢复窗口布局，或者在多个工作区之间共享工作区标记文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T08:40:55.410

窗口布局（和其他信息）保存在`*.vpwhist`文件中。
如果您`*.vpwhist`为您的布局需要创建了几个不同的文件，并将您希望使用的相应文件重命名为`<project>.vpwhist`，您可能会拥有您需要的文件。
不过我没试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-27T09:53:39.500

保存/恢复会话将 vrestore.slk 中包含的信息的子集保存到您选择的任何文件中。我没有保存内容的完整列表，但它包括打开的缓冲区、窗口（包括新的麻烦的浮动窗口:)）和书签。

见[xsave_session](http://community.slickedit.com/index.php?topic=9389.0)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-29T17:53:56.233

为每个布局创建额外的工作区。

1.  为项目和工作区使用不同的文件名。例如`a-project.vpj`和`workspace1.vpw`。
    （重要的是，工作区和项目标记文件永远不会发生名称冲突，SlickEdit 通过创建替代项目标记文件名来解决这个问题。）
2.  配置项目以使用项目特定的标记文件。
    （这样可以避免重复标签数据。）
    1.  菜单：项目：项目属性：文件：**带有项目特定标记文件的标记文件**
3.  复制工作区文件`example.vpw`，例如`example2.vpw`.
4.  使用项目：打开工作区，然后打开新工作区。
5.  然后将项目列为最近的项目，便于再次切换。

对于每个额外的工作区，将保存窗口布局。

```
workspace1.vpw
     |
     +--> workspace1.vpwhistu (window layout information)
     +--> workspace1.vtg      (tiny tag file)
     `-------------------------.
                               |
workspace2.vpw                 |
     |                         |
     +--> workspace2.vpwhistu  |
     +--> workspace2.vtg       |
     `-------------------------.
                               |
workspace2.vpw                 |
     |                         |
     +--> workspace2.vpwhistu  |
     +--> workspace2.vtg       |
     `-------------------------`--> a-project.vpj
                                         |
                                         `--> a-project.vtg
                                              (large project tag file) 
```

不是一个理想的解决方案，因为：

1.  文件必须在 SlickEdit 之外复制，然后添加工作区。
2.  切换工作区会导致 SlickEdit 重新考虑所有文件以更新标记文件。

# windows - 构建 OpenSSL VC++ 静态 64 位库

> ID：15304327
> 
> 赞同：1
> 
> 时间：2013-03-08T22:21:20.670
> 
> 标签：windows, openssl, 64-bit, static-libraries

我正在尝试使用 VC++ 2010 构建 OpenSSL 1.0.1e 静态 64 位库。（我像这样成功构建的最后一个是 1.0.1c，如果这可能是一个因素。目前我也能够成功构建1.0.1e 的 32 位版本没有问题。）

我相信我正在使用 ActiveState Perl、nasm 和所有正确的工具来进行此构建。INSTALL.W64 文件仅包含构建 DLL 的说明，遗憾的是我无法使用。

我正在调用正确的“%VS100COMNTOOLS%....\vc\bin\x86_amd64\vcvarsx86_amd64.bat”来设置环境，并且我确保 ActivePerl 位于我的路径的开头。

在尝试构建之前，我将删除所有旧的 inc*（当然“include”除外）、tmp* 和 out* 文件夹。我像过去一样调用“perl Configure no-shared VC-WIN64A”；虽然，我注意到 no-shared 似乎是这个版本的默认设置。我正在编辑 ms\do_win64a.bat 并将 no-asm 更改为 nasm，就像我在以前的版本中所做的那样。

然后我运行 ms\do_win64a.bat，并编辑生成的 ms\nt.mak 文件以将“32”更改为“64”，以防止我的 64 位构建破坏我的 32 位构建。我还将 /MD 更改为 /MT（就像我过去一直所做的那样），再次，以满足我特定的构建环境要求。

然后我运行 ms\nt.mak。这似乎只用几条警告消息构建了所有源，但是当 makefile 尝试编译 libeay32.lib 时，我得到一个“函数 BN_GF2m_mod_mul_arr 中引用的未解析的外部符号 bn_GF2m_mul_2x2”。（这在 crypto\bn\bn_gf2m.c 源代码中。）

所以我知道这是因为 OPENSSL_BN_ASM_GF2m 是在我的 nt.mak 的 CFLAG 中定义的，如果我对 Perl 编程有更好的理解，我可能会找到我没有看到的配置选项，但现在我想不通出去。

同样，按照非常相似的构建说明，32 位似乎也可以正常工作。我想知道可敬的 Eric Young 和 Tim Hudson 是否可能没有时间测试这个特定的构建配置，或者我忽略了它完全愚蠢的事情。

非常感谢任何能够帮助调试此问题的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:46:09.947

好的，所以这个问题的答案似乎是两者兼而有之。是的，对于 64 位版本的 OpenSSL 1.0.1e 的汇编器版本，似乎确实还有一些工作要做。而且，是的，暂时有一种解决方法应该是显而易见的。

在上面的 perl 配置步骤中使用 no-shared 的地方使用 no-asm 指令。

当然，这告诉 OpenSSL 我们没有构建汇编程序库，因此它将改为在 C 代码中编译。问题解决了！

感谢 Eric 和 Tim，感谢您免费提供给我们其他人的这个非常有价值的软件库！

# ruby - 获取yield返回的块

> ID：15304330
> 
> 赞同：0
> 
> 时间：2013-03-08T22:21:34.437
> 
> 标签：ruby, sequel

假设你有这样的方法：

```
def log_yield(sql, args=nil)
  sql = "#{sql}; #{args.inspect}" if args
  t0 = Time.now
  begin
    yield
  rescue => e
    log_exception(e, sql)
    raise
  ensure
    t1 = Time.now
    log_duration(Integer((t1-t0)*1000), sql) unless e
  end
end 
```

我需要重写此方法并以类似的方式实现它，但我需要获取由`yield`.

（具体来说，我需要确定在 Sequel::Database 中生成特定 sql 的块是什么）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:41:39.893

块只是美化的参数。在 ruby​​ 实现为您添加的方法中，但通常您可以将方法定义为：

```
def log_yield(sql, args=nil, &block)
    # do whatever you want with the block here
end 
```

当然，您可以在继承的类中随意覆盖它。如果此处未提供该块，您也可以使用`block_given?`.

# python - 在python中另一个列表中的某个位置之后获取列表中每个元素的位置

> ID：15304349
> 
> 赞同：0
> 
> 时间：2013-03-08T22:22:26.430
> 
> 标签：python, list, indexing

我有一个项目的位置列表`list=[1,4,5,8]`。

我想使用这些位置来查找这些位置之后原始列表中另一个项目的出现。

我想知道是否有一个班轮在某个位置之后使用枚举并将其放入 for 循环中以使某个位置不断变化。

这是一个例子：

```
list1=['a','b','a','c','d','b','b','a','e','b','f'] 
list2#positions of 'a'=[0,2,5] 
```

`b`我想要after`a`但不是 before的所有第一次出现`a`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:37:50.860

如果您需要先找到标记，然后再找到它们之后的目标的第一个实例：

```
def find_after(lst, target, mark):
    marks = []
    while True:
        try:
            marks.append(lst.index(mark,marks[-1] if marks else 0))
        except ValueError:
            # no more 'a's were found
            break
    targets = []
    for m in marks:
        try:
            targets.append(lst.index(target, m))
        except ValueError:
            continue
    return targets 
```

其工作方式为：

```
find_after(['a','b','a','c','d','b','b','a','e','b','f'], 'b', 'a')
#[1,5,9] # the locations of the 'b's (target) after the 'a's (mark) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:41:17.147

这是找到它们的简单方法。对于此版本，如果未找到该值，将引发异常。

```
>>> s = 'abacdaebfxxxxxxxxxxxxxxxxxxxxxabc'
>>> finder = lambda lst, inds, x: [lst.index(x, i) for i in inds]
>>> finder(s, [0, 2, 3, 10], 'a')
[0, 2, 5, 30] 
```

如果`s`是字符串或列表，这将起作用。

# sql-server-2008 - 在 SQL Server 2008 中查找对表列的所有引用

> ID：15304350
> 
> 赞同：6
> 
> 时间：2013-03-08T22:22:31.023
> 
> 标签：sql-server-2008

有没有办法在 SQL Server 2008 数据库中查找对表列的所有引用？我需要知道该列是从哪些其他表或存储过程或视图中引用的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:24:43.077

如果您需要按名称查找数据库对象（例如表、列、触发器） - 请查看名为[SQL Search的](http://www.red-gate.com/products/sql-development/sql-search/)**免费**Red-Gate 工具，它会在您的整个数据库中搜索任何类型的字符串。

![在此处输入图像描述](../Images/06aa8195296565da03113074a84f9fa1.png)

![在此处输入图像描述](../Images/2b38d4018a9fbf766a665542ad2c611d.png)

对于任何 DBA 或数据库开发人员来说，它都是一个很棒的必备工具——我是否已经提到它完全**免费**用于任何用途？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-20T07:23:13.660

当我需要分析由于表架构更改造成的影响时，我使用以下步骤进行分析。这可能不完整但很有帮助！

1.  Sp_help [TableName] ：这有助于我找到所有 FOREIGN KEY 约束参考。我还可以找到将此表作为 FOREIGN Key 引用的任何其他表。
2.  Sp_depends [TableName]：这有助于使用该表查找过程、函数和视图。
3.  蛮力方法：我使用不同的系统表和函数来检查 SQL 作业、模块等中的特定关键字

仅供参考：Sp_help [TableName] Sp_depends [TableName]

```
select top 10 * from msdb.dbo.sysjobsteps where command like '%%'

SELECT top 10 Name, OBJECT_DEFINITION(OBJECT_ID)
FROM sys.procedures
WHERE OBJECT_DEFINITION(OBJECT_ID) LIKE '%%' 

SELECT top 10 OBJECT_NAME(object_id), *
FROM sys.sql_modules
WHERE definition LIKE '%%' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-18T17:07:02.443

您可以尝试使用[ApexSQL Search](http://www.apexsql.com/sql_tools_search.aspx)等工具。它搜索对象名称，但它也搜索依赖对象的列表，即使依赖表/视图中的列名称不同。

其他解决方案是使用系统视图和/或系统功能来获取您需要的数据。建议是用来`sys.foreign_keys, sys.objects, sys.all_columns`获取你需要的数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-16T17:07:15.727

我花了很多时间试图找到一种快速识别列级别依赖项的方法，而无需搜索文本或使用第三方应用程序。另一个挑战是跨多个数据库查找表名可能重复的依赖关系，这会在搜索 SP 文本时导致误报。

从 SQL 2008 开始，有一个函数可以在字段级别返回跨数据库的依赖关系。

下面的代码有一些例外情况：

*   如果在已删除的表/字段上存在具有无效引用的存储过程，它将失败（顺便说一下，我发现这对于查找被表修改意外破坏的 SP 很有用）。
*   在 SP 以不寻常的方式使用临时表的情况下，它不会找到所有依赖项。
*   在某些情况下，我发现它为复杂的存储过程返回了误报。

[MSDN 文档](http://technet.microsoft.com/en-us/library/bb630351%28v=sql.100%29.aspx)

此代码应从 SP 所在的数据库中运行，以便能够跨越其他数据库依赖项。

```
SELECT      
--SP, View, or Function
ReferencingName = o.name,
ReferencingType = o.type_desc,

--Referenced Field
ref.referenced_database_name, --will be null if the DB is not explicitly called out
ref.referenced_schema_name, --will be null or blank if the DB is not explicitly called out
ref.referenced_entity_name,
ref.referenced_minor_name,

--this will tell you the reference type
ref.is_selected,
ref.is_updated

FROM sys.objects AS o 
cross apply sys.dm_sql_referenced_entities('dbo.' + o.name, 'Object') ref
where o.type in ('FN','IF','V','P','TF') 
```

# javascript - JS变量范围问题

> ID：15304352
> 
> 赞同：0
> 
> 时间：2013-03-08T22:22:43.283
> 
> 标签：javascript, scope

我有以下功能：

```
function initPaymentBlock(bIdx) {  

    var paymentType = 'default';
    if( $('#gc-apply-btn-'+bIdx).length ) {
        $('#gc-apply-btn-'+bIdx).click( function() { 
            poApplyGiftCard(bIdx); 
            console.log("about to change payment type");
            paymentType = 'credit card';
            console.log("paymentType inside function: " + paymentType);
        });
    }

    console.log("payment type: " + paymentType);
    poGetPaymentOption(paymentType, 0, bIdx);

} 
```

该`paymentType`变量在初始语句中设置为“默认”。在内部点击功能中，它已更改为“信用卡”。当我`console.log`在内部函数中运行语句时，它返回`credit card`. `console.log`外部内部函数（就在调用之前`poGetPaymentOption`）返回“默认”。

我知道问题是变量的范围，但不知道如何或在哪里设置它，以便`poGetPaymentOption`函数调用获得正确的值（如果在运行之前未单击按钮，则为“默认”；“信用卡'，如果单击按钮。）有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:25:33.487

它很明显。单击会更改值，但仅在单击后更改。您的第二个控制台日志在单击事件触发之前运行。这有什么问题？

```
function initPaymentBlock(bIdx) {  

    var paymentType = 'default';
    if( $('#gc-apply-btn-'+bIdx).length ) {
        $('#gc-apply-btn-'+bIdx).click( function() { 
            poApplyGiftCard(bIdx); 
            console.log("about to change payment type");
            paymentType = 'credit card';
            console.log("paymentType inside function: " + paymentType);
            poGetPaymentOption(paymentType, 0, bIdx);
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:25:56.257

范围没有问题。这都是关于执行顺序的。

以下是代码的执行方式：

*   当您进入 initPaymentBlock 函数时，您将其设置为“默认”。
*   然后您创建一个单击处理程序，将其值更改为“信用卡”，但仅在有人单击按钮之后。
*   然后底部的控制台输出会输出当前值，该值仍然是“默认值”。
*   现在，如果用户单击按钮，单击处理程序将执行并输出“信用卡”

这是您运行时的预期控制台输出`initPaymentBlock()`：

*   付款方式：默认

而已。现在，当您单击按钮时，将显示以下输出：

*   即将更改付款方式
*   函数内部的paymentType：信用卡

# javascript - Sencha Touch 2：如何从面板内显示的 HTML 输入字段中获取值？

> ID：15304353
> 
> 赞同：1
> 
> 时间：2013-03-08T22:23:02.877
> 
> 标签：javascript, html, extjs, sencha-touch, sencha-touch-2

我正在使用 setHtml 方法在 Ext.Panel 中显示 html。HTML如下。

```
<html>
First name: <input type="text" name="firstname"><br>
Last name: <input type="text" name="lastname">
</html> 
```

我的面板是

```
Ext.define('WU.view.Template', {
  extend: 'Ext.Panel',
  alias: 'widget.templateview',
  config: {
    items: [{
      xtype: 'panel',
      id: 'dummyPanel',
    }]
  }
}); 
```

我正在设置控制器内部的值，如下所示。

```
Ext.getCmp('dummyPanel').setHtml(html file); 
```

如果我想从输入字段 'firstname' 获取值，那么如何获取这些值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:42:07.250

只需查询面板元素内的输入。

[这是一个例子](http://www.senchafiddle.com/#u7cHV)

希望这可以帮助

# c# - 使用 LINQ 按列表分组 价值观

> ID：15304363
> 
> 赞同：1
> 
> 时间：2013-03-08T22:23:28.583
> 
> 标签：c#, .net, linq

我有以下排序字典：

```
SortedDictionary<string, List<string>> dict 
            = (SortedDictionary<string,List<string>>) MyObj.GetDict(); 
```

dict中有许多具有相同值的列表，我想使用LINQ将所有这些具有相似列表的行折叠成一行。但是，每个列表都是一个对象，因此 LINQ 将它们都视为不同的实体。

我的问题是：如何设置我的代码，以便 GroupBy(grp => grp.Value) 实际上按列表的内容而不是列表对象本身对字典进行分组？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:47:58.867

创建一个自定义`IEqualityComparer<IList<string>>`，您可以将其用于大多数 linq 方法，例如`GroupBy`or `Distinct`。请注意，它也适用于`string[]`which implements `IList<string>`：

```
public class IgnoreOrderComparer : IEqualityComparer<IList<string>>
{
    public IgnoreOrderComparer(StringComparer comparer)
    {
        this.Comparer = comparer;
    }

    public StringComparer Comparer { get; set; }

    public bool Equals(IList<string> x, IList<string> y)
    {
        if (x == null || y == null) return false;
        // remove the Distincts if there are never duplicates as mentioned
        return !x.Distinct(Comparer).Except(y.Distinct(Comparer), Comparer).Any();
        // btw, this should work if the order matters:
        // return x.SequenceEqual(y, Comparer);
    }

    public int GetHashCode(IList<string> arr)
    {
        if (arr == null) return int.MinValue;
        int hash = 19;
        foreach (string s in arr.Distinct(Comparer))
        {
            hash = hash + s.GetHashCode();
        }
        return hash;
    }
} 
```

然后，您可以使用以下查询来创建 dictinct `SortedDictionary<string, List<string>>`。

样本数据：

```
SortedDictionary<string, List<string>> dict = new SortedDictionary<string, List<string>>();
dict.Add("A", new List<string>() { "A", "B" });
dict.Add("B", new List<string>() { "B", "B" });
dict.Add("C", new List<string>() { "A", "B" });
dict.Add("D", new List<string>() { "C", "E" });
dict.Add("E", new List<string>() { "E", "C" }); 
```

首先在列表上使用`Distinct`，然后将它们与原始字典连接起来，最后创建一个新字典：

```
var comparer = new IgnoreOrderComparer(StringComparer.OrdinalIgnoreCase);
var uniqueLists = dict.Values.Distinct(comparer);
var uniqueDict = from list in uniqueLists
                 join kvp in dict 
                 on list equals kvp.Value
                 select kvp;
dict = new SortedDictionary<string,List<string>>(uniqueDict.ToDictionary(kv => kv.Key, kv => kv.Value)); 
```

即使列表中字符串的顺序很重要，它也可能会有所帮助。

# c# - SQL Server - 以编程方式发现存储过程的返回值

> ID：15304365
> 
> 赞同：3
> 
> 时间：2013-03-08T22:23:45.223
> 
> 标签：c#, sql-server, tsql, information-schema

这是一个元问题。使用`INFORMATION_SCHEMA`每个数据库提供的，如何发现存储过程的返回值？对于函数，返回值被显式声明并显示在`INFORMATION_SCHEMA`下面`ROUTINES`。

然而，存储过程似乎是一个奇怪的灰色区域（就像 SP 和函数之间的区别一样）。它们似乎正式没有“返回值”，但最后您可以运行 SELECT 语句，例如：

```
SELECT RowID = @RowID; 
```

例如; 在 C# 中，您从“RowID”列中读取返回值。这清楚地表明存储过程实际上能够返回值，尽管不像函数那样在 T-SQL 代码的上下文中。

如何在不必解析定义本身的情况下发现这些值及其类型？

**编辑**

如果你正在搜索这个，存储过程的返回值隐式是整数，但也可以返回称为*结果集*的数据。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T22:28:03.743

存储过程返回整数。

如果您想要它们返回的结果集，您可以要求 SQL Server 解析存储过程以提供此信息。

SQL Server 2012 引入了[`sys.dm_exec_describe_first_result_set_for_object`](http://msdn.microsoft.com/en-us/library/ff878236.aspx)哪些替换`SET FMTONLY`.

```
CREATE PROC TestProc2
AS
SELECT object_id, name FROM sys.objects ;
SELECT name, schema_id, create_date FROM sys.objects ;
GO

SELECT * FROM sys.dm_exec_describe_first_result_set_for_object(OBJECT_ID('TestProc2'), 0) ;
SELECT * FROM sys.dm_exec_describe_first_result_set_for_object(OBJECT_ID('TestProc2'), 1) ;
GO 
```

您还可以调查存储过程的参数，以查看是否有任何参数被标记`OUT`。[`INFORMATION_SCHEMA.PARAMETERS`](http://msdn.microsoft.com/en-us/library/aa933216%28v=sql.80%29.aspx)为您提供每个参数的模式。

综合考虑这三者应该会给你很多你想要的东西。

# python - 如何验证 django 表单中的多个文件和附加的自定义清理功能？

> ID：15304367
> 
> 赞同：0
> 
> 时间：2013-03-08T22:24:20.327
> 
> 标签：python, django

验证单个字段是没有问题的。self.cleaned_data 显示值！

但是当我想在**clean 方法**中打印 self.cleaned_data 时，所有值的结果都是 None ！这将如何发生？我还尝试使用 Super() 获取数据……但没有运气……有什么想法吗？

```
def validator_number_or_one_letter(fieldvalue):
    if not re.match("^[A-Za-z0-9]*$", fieldvalue) or len(fieldvalue)>1:

        raise forms.ValidationError("Error, Error!")

class CodeForm(forms.Form):

    letter_one = forms.CharField(widget=forms.TextInput(attrs={'placeholder': '#','requiried':'required','required': 'true','size':'1','class':'first-field' }))
    letter_two =forms.CharField(widget=forms.TextInput(attrs={'placeholder': '#','requiried':'required','required': 'true','size':'1' }))
    letter_three = forms.CharField(widget=forms.TextInput(attrs={'placeholder': '#', 'requiried':'required','required': 'true','size':'1' }))
    letter_four = forms.CharField(widget=forms.TextInput(attrs={'placeholder': '#','requiried':'required','required': 'true','size':'1' }))
    letter_five = forms.CharField(widget=forms.TextInput(attrs={'placeholder': '#','requiried':'required','required': 'true','size':'1' }))

    def clean(self):
        #cleaned_data = super(CodeForm, self).clean()  ###this does not work either
        #print cleaned_data ###this does not work either
        print self.cleaned_data['letter_one']

    def clean_letter_one(self):
        validator_number_or_one_letter(self.cleaned_data['letter_one'])

    def clean_letter_two(self):
        validator_number_or_one_letter(self.cleaned_data['letter_two'])

    def clean_letter_three(self):
        validator_number_or_one_letter(self.cleaned_data['letter_three'])

    def clean_letter_four(self):
        validator_number_or_one_letter(self.cleaned_data['letter_four'])

    def clean_letter_five(self):
        validator_number_or_one_letter(self.cleaned_data['letter_five']) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:23:34.903

不确定这是否是唯一的问题，但您的 clean_() 方法必须返回清理后的值。

# javascript - jquery - 当我放下它时防止可拖动的链接打开

> ID：15304368
> 
> 赞同：0
> 
> 时间：2013-03-08T22:24:20.990
> 
> 标签：javascript, jquery, draggable, droppable

我有一个 5 x 5 的可放置方块的网格，然后还有几个可拖动的方块，它们是 . 在网格上的方块之间移动它们时没有问题，但我也有一个“垃圾”可放置方块，如果用户在其上放置可拖动的方块，则将其删除。

我的带有可拖动示例的正方形网格如下所示 -

```
<div id="-2:-2" class="droppable"></div>
<div id="-2:-1" class="droppable occupied">
    <a href="http://stackexchange.com" id ="20" class="bookmark draggable black" title="black" target="_blank"></a>
</div>
<div id="-2:0" class="droppable"></div>
<div id="-2:1" class="droppable"></div> 
```

在页面的其他地方我有垃圾桶项目 -

```
<div>Delete me<div id="trash"></div></div> 
```

然后我有javascript -

```
$('.draggable').draggable({ start: function() {$('#dropdownAddTile').slideDown();},  stop: function() {$('#dropdownAddTile').slideUp();}, containment: '#container', snap:'.droppable, #trash', snapMode:'inner', revert:'invalid',snapTolerance: 32});
$('.droppable').droppable({drop: handleDropEvent, accept: function(e){if(e.hasClass('draggable')) { if (!$(this).hasClass('occupied')) {return true; }}}});
$('#trash').droppable({drop: removelink, accept: '.draggable'});
function removelink(event, ui) {
    var draggableId = ui.draggable.attr("id");
    $(ui.draggable).remove();   
    $.post("tiles/delete", { draggableId:draggableId }).done(function(data) {
        //alert(data);
    })
    $('#dropdownAddTile').slideUp();
} 
```

所有的正方形，无论是 .draggable .droppable 还是 #trash 在 css 中都是相同的大小等。但是，当我在垃圾桶上拖放时，底层链接有时会弹出。这不会发生在其他droppables上，只是垃圾桶一个。

我知道启动和停止功能，但我认为它们对我没有影响。关于如何阻止链接触发的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-23T15:46:42.860

它有助于现代浏览器：

```
.ui-draggable-dragging {
  pointer-events: none;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:58:10.333

试试这个我猜

```
 $('.droppable').droppable({drop: function () {
 handleDropEvent();
 removelink($(this).find('a'))
 }, accept: function(e){if(e.hasClass('draggable')) { if (!$(this).hasClass('occupied'))      {return true; }}}

function removelink(obj) {
 obj.removeAttr('href');
} 
```

意思是当它被丢弃时只调用一个额外的函数

# ruby-on-rails - 在 Rails 的单个视图中为模型创建多个记录

> ID：15304370
> 
> 赞同：2
> 
> 时间：2013-03-08T22:24:28.860
> 
> 标签：ruby-on-rails, simple-form

我有一个名为 的模型`Book`，我想调整标准`Book#new`以显示 10 本书的字段，这样就可以一次创建 10 本书，而不仅仅是一本。

我查看了[这个问题](https://stackoverflow.com/questions/13658248/rails-3-create-view-to-insert-multiple-records)，发现如果我添加`10.times`到我的表单中，我可以重复该表单。但是，我没有正确执行此操作，因为保存了一条新记录，但所有字段均为空。

我想做的是：

1.  允许用户一次输入最多 10 本书然后保存
2.  如果用户只填充了三个书籍记录，则只创建三个（并忽略其他具有空值的表单中的七个记录）

我的观点：

```
<%= simple_form_for(@book) do |f| %>
  <%= f.error_notification %>
  <% 10.times do |index|%>
    <%= f.input :title %>
    <%= f.association :book_category %>   
  <% end %>

  <%= f.submit %>
<% end %> 
```

我的控制器与脚手架代码没有变化：

```
def new
  @book = Book.new
end

def create
  @book = Book.new(params[:book])
end 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-09T00:54:42.957

您不能使用与帖子中其他[问题](https://stackoverflow.com/questions/13658248/rails-3-create-view-to-insert-multiple-records)相同的方法的原因是 bc @book 不是用户的嵌套属性。您只是为一本新书创建一个表单，因此控制器中没有任何特殊内容，rails 只会保存一本书。一种选择是使书籍成为用户的嵌套属性，以便您可以一次创建多本书。以下是您需要如何设置模型和表单来处理嵌套属性。

```
Class User < ActiveRecord::Base
  has_many :books
  accepts_nested_attributes_for :books, :reject_if => lambda { |b| b[:title].blank? }
  attr_accessible :books_attributes
end 

Class Book < ActiveRecord::Base
  belongs_to :user
end 
```

将`reject_if`忽略任何提交给控制器但没有标题的记录。您会想要这个，因为您假设许多用户不会使用所有 10 个字段。下面是你的表格。

```
<%= form_for @user do |f| %>
  <%= f.fields_for :books, [Book.new]*10 do |book| %>
    <%= book.text_field :title %>
    <%= book.association :book_category %>
  <% end %>
  <%= f.submit %>
<% end %> 
```

重要的是要注意这个表单将被提交给用户控制器，因为它是一个用户表单。用户控制器将像处理用户的任何其他属性一样处理创建/更新所有书籍，因为书籍现在被接受为嵌套属性。有关更多示例，请查看有关嵌套属性的[Railscast 。](http://railscasts.com/episodes/196-nested-model-form-revised)

正如我上面提到的，这只是一种选择。如果您不想让 book 成为用户的嵌套属性，那么另一种选择是生成 10 组 book 输入字段，就像您已经在做的那样，然后在 Books 控制器的 create 操作中分解 params 哈希。通过这样做，您可以遍历散列并为每组输入创建一本书。这比使用更“hacky”，`accepts_nested_attributes_for`但它是另一种选择，所以我想我会提到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:53:05.683

您引用的示例文章正在讨论嵌套模型表单。Railscasts 在这里也有一个视频：[http ://railscasts.com/episodes/196-nested-model-form-part-1](http://railscasts.com/episodes/196-nested-model-form-part-1)

两者都指与其他模型有关系的模型的单个实例。

您想要做的是同一模型的多个实例，而不是嵌套关系。

我的问题是，为什么？他们真的节省了从一个字段集到另一个字段集的时间，而不是按 Enter 提交单个记录吗？

如果您想节省数据输入的时间，为什么不将`create`操作重定向回新的，以便他们可以立即输入下一条记录？还是在每条记录提交后使用 AJAX 向页面添加一个新的字段集？

我认为这些方法将使您的视图和控制器保持良好和 RESTful。

# python - Netsuite Webservices (Python) 故障

> ID：15304374
> 
> 赞同：0
> 
> 时间：2013-03-08T22:24:52.833
> 
> 标签：python, suds, netsuite

这是我关于 SO 的第一个问题。

我是 Netsuite 的初学者。我看到只支持 PHP 和 Java。我个人不喜欢两者。我想使用 Python。我在其他工作中使用了几次 SUDS，并认为它还可以，但不是很好。在我第一次尝试 netsuite 时，我使用了 SUDS 并尝试使用标准客户端 = Client(wsdl)。我在这里使用 2012 WSDL。 [https://webservices.netsuite.com/wsdl/v2012_1_0/netsuite.wsdl](https://webservices.netsuite.com/wsdl/v2012_1_0/netsuite.wsdl)

由于文件存在问题，我什至无法导入文件。在这里看到帖子

[有没有人能够让 suds soap 库与 NetSuite WSDL 一起使用？](https://stackoverflow.com/questions/4400216/has-anyone-been-able-to-get-the-the-suds-soap-library-to-work-with-the-netsuite).

但是，实际使用的文件是 2010 年的。我什至没有在没有修改的情况下收到该版本的错误。我希望使用 2012.1 版本。我已经尝试了所有可用的解决方案，但没有一个有效。如果有人能提出一个好的解决方案，我什至会使用 SUDS 以外的东西。

我开箱即用的错误是

```
"fault '%s' not defined in portType '%s'" % (fault.name, self.type.name) 
```

异常：端口类型“NetSuitePortType”中未定义故障“ExceededRecordCountFault”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-01T22:50:01.680

我意识到这是旧的（呃），但几个月前我也处于同样的状态。我尝试使用 Suds 连接到 SuiteTalk，但（可能是因为我缺乏 SOAP 经验）却毫无进展。我确实设法在某个时候进行了连接（我相信我使用的是与 Suds 不同的库），但试图确定要使用哪个 WSDL 是一场噩梦。

任何状况之下。我放弃了 SuiteTalk 方法，开始编写一些 restlet 脚本。Python 对 http 请求有很好的支持（我个人使用的是优秀的 'requests' 模块）：

[http://docs.python-requests.org/en/latest/#](http://docs.python-requests.org/en/latest/#)

我知道使用 SOAP 协议可能有一个很好的理由（我想它更像是“企业”），但是为了我们的目的，为我想做的所有事情编写一个相应的 restlet 效果很好。我们正在以这种方式完成重要的日常自动化任务。我最近重写了我的请求代码以使用线程，Netsuite 允许您同时执行多达 40 个请求，这在您处理数千条记录时会产生巨大的差异

如果您仍然坚持尝试将 Python 与 SOAP 结合使用，我建议您尝试使用 restlets。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T20:25:50.207

在我将 suds 版本回滚到 0.3.8 之前，我遇到了类似的错误，0.3.9 在没有任何有用信息的情况下失败了。使用 easy_install 运行`easy_install suds=="0.3.8"`，然后重试您的代码。

# django - Django 错误 对象没有属性“更新”

> ID：15304378
> 
> 赞同：32
> 
> 时间：2013-03-08T22:25:20.253
> 
> 标签：django, python-2.7, attributes

**更新**

我正在对服务器进行一些维护并重新启动......一旦它回来，代码就可以正常工作......这实际上让我担心同样......

我认为这是 mod_wsgi 上的一个错误。

不管怎么说，还是要谢谢你！

我对 django 真的很陌生（昨天开始）。我设法使用 xlrd 制作了一个 excel 解析器，数据一切正常（它加载非常快），我需要更新数据库中的文件信息，这样我才能知道负载是如何进行的，这就是我拥有的地方问题，save() 方法不起作用，我已经使用了 update 以及 get 和 filter，但总是同样的问题。

我希望你能指出我的错误在哪里

**模型.py**

```
class archivo(models.Model):
    archivo_id = models.AutoField(primary_key=True)
    fk_cliente = models.IntegerField()
    fk_usuario = models.IntegerField()
    archivo_nombre = models.CharField(max_length = 30)
    archivo_original = models.CharField(max_length = 255)
    archivo_extension = models.CharField(max_length = 5)
    archivo_tamano = models.FloatField()
    archivo_registros = models.IntegerField()
    archivo_registros_buenos = models.IntegerField()
    archivo_registros_malos = models.IntegerField()
    archivo_registros_cargados = models.IntegerField()
    archivo_fecha_carga = models.DateTimeField()
    archivo_fecha_envio = models.DateTimeField()
    def __unicode__(self):
        return self.archivo_id 
```

**视图.py**

```
from procesa.models import *
from django.conf import settings
from django.shortcuts import render_to_response  
import xlrd
from time import strftime
from symbol import except_clause
def procesa(request, procesar = 0):
    datos = None
    infoarchivo = None
    if(procesar > 0):
        try:
            infoarchivo = archivo.objects.get(archivo_id=int(procesar))
        except:
            return render_to_response('error.html')

    if (infoarchivo is not None):
        excel_path = settings.FILES_URL+infoarchivo.archivo_original
        wb = xlrd.open_workbook(str(excel_path))
        sh = wb.sheet_by_index(0)
        ##START UPDATE##
        infoarchivo2 = archivo.objects.filter(archivo_id = procesar)
        infoarchivo2.archivo_registros = sh.nrows
        infoarchivo2.save()
        ##END UPDATE##            
        for rownum in range(sh.nrows):
            destino = str(sh.cell(rownum,0).value)
            destino = destino.replace(".0","")
            if (int(destino) > 0):
                mensaje = str(sh.cell(rownum,1).value)
                ahora = strftime("%Y-%m-%d %H:%M:%S")
                reg = registro.objects.filter(registro_destino__exact=destino,fk_archivo__exact=procesar)
                #reg = registro.objects.raw(str(el_query))

                if (reg.exists()):
                    exists = True
                else:
                    r = registro(fk_cliente=1,fk_usuario=1,fk_archivo=int(procesar),registro_destino=destino,registro_mensaje=mensaje,registro_estado='Cargado',registro_fecha_carga=ahora)
                    r.save()

        datos = {'ID':procesar,'PATH': settings.FILES_URL, 'INFO':infoarchivo, 'el_excel':infoarchivo.archivo_original, 'registros':sh.nrows }
        return render_to_response('carga.html', {'datos': datos}) 
```

在我已经尝试过的##START UPDATE## 块中

```
infoarchivo.archivo_registros = sh.nrows
infoarchivo.save() 
```

和

```
archivo.objects.filter(archivo_id = procesar).update(archivo_registros=sh.nrows) 
```

和

```
archivo.objects.get(archivo_id = procesar).update(archivo_registros=sh.nrows) 
```

我找不到对此错误的任何引用或要在模型文件中添加的其他内容，我很确定这很容易修复，但我就是找不到。

我得到的错误（对于所有不同的代码）是

**异常类型：/procesa/4 处的 AttributeError**

**异常值：“存档”对象没有属性“更新”**

文件的记录被解析并插入没有问题。

我在 Apache 2.2 中使用 Django 1.5 和 python 2.7，在 Amazon 的 EC2 中安装了 mod_wsgi 和 mysql 后端

**更新** 我正在对服务器进行一些维护并重新启动......一旦它回来，代码工作得很好......这实际上让我担心同样......

我认为这是 mod_wsgi 上的一个错误。

不管怎么说，还是要谢谢你！

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2016-10-08T15:39:32.460

此错误的原因是它`.get()`返回一个单独的对象并且`.update()`仅适用于查询集，例如将返回的内容`.filter()`而不是`.get()`.

如果您正在使用`.get()`，`.update()`则将无法正常工作。您需要手动将信息保存到对象：

```
archivo = archivo.objects.get(archivo_id=procesar)
archivo.archivo_registros = sh.nrows
archivo.save() 
```

如果您只想保存此特定数据，也可以使用[update_fields ：](https://docs.djangoproject.com/en/1.8/ref/models/instances/#specifying-which-fields-to-save)

```
archivo = archivo.objects.get(archivo_id=procesar)
archivo.archivo_registros = sh.nrows
archivo.save(update_fields=['archivo_registros']) 
```

这可以防止触发您可能不想调用的任何信号。

您的另一个选择是简单地使用`.filter()`.

```
archivo = archivo.objects.filter(archivo_id=procesar).update(archivo_registros=sh.nrows) 
```

请注意，这将更新多个对象（如果存在）。如果您想确保不会发生这种情况，您应该在过滤器中包含主键，或者使用较早的方法之一来确保您只修改单个对象。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-04-06T09:40:24.327

遇到此行为并使用“过滤器”然后更新按预期工作。例如：

```
 Students.objects.select_for_update().filter(id=3).update(score = 10) 
```

仅供参考：除非您正在处理事务，否则单独修改每个字段`save()`可能会在多线程环境中产生数据不一致。当 threadA 调用`save()`模型时，另一个 threadB 可能已经更改了模型字段并保存了。在这种情况下，threadA 必须读取更新的模型并进行更改。

这是在 Django 1.6.2 上

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-30T10:19:16.083

我有过类似的情况，但是在使用以下构造时它起作用了：

```
this_spot = Spot.objects.filter(pk=obj.spot.pk)
this_spot.update(friendly_rate=rating_to_be_persisted) 
```

但在我想直接访问单个实例的情况下不起作用，例如从外键端类。归来`'Spot' object has no attribute 'update'`。

原因仅仅是[django 文档](https://docs.djangoproject.com/en/dev/topics/db/queries/#updating-multiple-objects-at-once)`update()`中描述的工作方式：

解决方法是 django 网站上显示的方法：

```
>>> b = Blog.objects.get(pk=1)

# Update all the headlines belonging to this Blog.
>>> Entry.objects.select_related().filter(blog=b).update(headline='Everything is the same') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T22:45:04.357

我没有浏览你所有的代码，但是这一行：

```
 infoarchivo2 = archivo.objects.filter(archivo_id = procesar) 
```

不从数据库返回实例或对象，它返回一个查询集，即使查询集只有一个元素。您将不得不迭代 Queryset oy 或者更改 get 的方法过滤器。

只要方法更新，我认为它没有实现。

# c++ - 为 Arduino 编写库

> ID：15304383
> 
> 赞同：2
> 
> 时间：2013-03-08T22:25:38.927
> 
> 标签：c++, c, header, arduino, libraries

我正在尝试为 Arduino 编写一个简单的库来解析和解释串行命令。我对示例库的目标是读取预期的命令并打开一些 LED。我已经通过 arduino 进行串行通信，我希望它由库处理。例如...我的arduino上有以下代码

Arduino代码：

```
#include <serialComms.h>
serialComms testing = serialComms();
void setup()
{
 Serial.begin(9600); 
}

void loop() // not terribly concerned with the main loop, only the serialEvent, which I        have tested and works
{

}

void serialEvent()
{
   testing.readNewBytes();
   testing.assignBytes();
} 
```

serialComms.cpp

```
#include <Arduino.h>
#include <serialComms.h>

void serialComms::init()
{
  // This is where the constructor would be...right now we are too stupid to have one
}

void serialComms::readNewBytes()  // Target Pin,Values
{
        digitalWrite(11,HIGH);
        delay(250);
        digitalWrite(11,LOW);
        assignBytes();

}

void serialComms::assignBytes()
{
    for(int t  = 0;t<5;t++)
    {
        digitalWrite(10,HIGH);
        delay(250);
        digitalWrite(10,LOW);
    }   
   } 
```

serialComms.h

```
#ifndef serialComms_h
#define serialComms_h

/* serialComms Class */
class serialComms
{
  public:
    serialComms() {};
    void init();
    void readNewBytes(); // Will be used to create the array --> two variables for now...
    void assignBytes();
    };

#endif 
```

我的问题如下...

1.) 我的库结构是否正确？当我发送消息并触发 serialEvent 时，我只想让 LED 闪烁，当我在 arduino 中运行代码时，会出现以下错误。

```
testingLibraries:2: error: 'serialComms' does not name a type
testingLibraries.ino: In function 'void serialEvent()':
testingLibraries:16: error: 'testing' was not declared in this scope 
```

我在库文件夹中名为 serialComms 的文件夹中有 .cpp 和 .h 文件。我真的不确定从这里去哪里，有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:57:40.367

首先改变你的

```
#ifndef serialComms
#define serialComms 
```

到

```
#ifndef serialComms_h
#define serialComms_h 
```

您不能拥有与实例同名的宏。

然后检查你的大小写，例如 readBytes vs testing.readbytes(); 注意 B

* * *

第一次在其中创建新的库目录和初始文件时，请确保关闭所有 Arduino IDE。IDE 在启动时缓存文件列表。他们可以随后改变那里的内部。但是直到下一次开始才会知道新文件。

* * *

以下对我来说编译得很好。一旦我纠正了所有错字：

定义测试.ino

```
#include <serialComms.h>
serialComms testing;

void setup() {
  Serial.begin(9600);
}

void loop() {
}

void serialEvent()
{
  testing.readBytes();
  testing.assignBytes();
} 
```

serialComms.cpp

```
#ifndef serialComms_h
#define serialComms_h

/* serialComms Class */
class serialComms
{
  public:
//       serialComms() {};
void init();
void readBytes(); // Will be used to create the array --> two variables for now...
void assignBytes();
    };

#endif 
```

serialComms.h

```
#include <Arduino.h>
#include <serialComms.h>

void serialComms::init()
{
  // This is where the constructor would be...right now we are too stupid to have one
}

void serialComms::readBytes()  // Target Pin,Values
{
  digitalWrite(11,HIGH);
  delay(250);
  digitalWrite(11,LOW);
  assignBytes();
}

void serialComms::assignBytes()
{
  for(int t  = 0;t<5;t++)
  {
    digitalWrite(10,HIGH);
    delay(250);
    digitalWrite(10,LOW);
  }   
} 
```

# html - 使登录链接与其他链接对齐

> ID：15304385
> 
> 赞同：0
> 
> 时间：2013-03-08T22:25:40.140
> 
> 标签：html, css, css-float

如何让登录按钮链接与其他链接位于同一行？我已经尝试调整锚标签的边距和填充，但它不起作用。

HTML 代码：

```
<a data-toggle="modal" role="button" href="#myModal">
  <img border="0" src="/images/login.jpg">
</a> 
```

代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:33:10.867

将此添加到`img`css 中：

```
a[data-toggle="modal"] > img {margin: 13px 0;} 
```

# html - 媒体查询中使用的媒体特征表达式的顺序有多重要，如果有的话，应该优先考虑什么？

> ID：15304386
> 
> 赞同：1
> 
> 时间：2013-03-08T22:25:44.270
> 
> 标签：html, css, media-queries

例如，如果我想定位一个最小宽度为 500 像素的纵向屏幕，那么在查询中指定的顺序是否重要？

```
@media screen and (orientation: portrait) and (min-width: 500px) { ... } 
```

我还没有通读 CSS 规范的用户代理部分，但我假设 CSS 是从左到右阅读的，所以对于上面的内容，它会首先检查方向，如果它评估为 true，它将继续最小宽度。正确的？那么如果我反过来呢：

```
@media screen and (min-width: 500px) and (orientation: portrait) { ... } 
```

大概这会在定向*之前检查最小宽度。*如果确实如此，我应该在这里优先考虑什么，方向还是宽度？或者这是否会更具体到正在使用的其他媒体查询？（宽度使用与方向使用。）

在几乎没有媒体功能的媒体查询中，我想这是微不足道的，但更具体的事情呢：

```
@media
    print
        and (min-resolution: 300dpi),
    projection
        and (color),
    screen
        and (orientation: landscape)
        and (min-width: 50px) { ... } 
```

`screen` *在这种情况下，* `print`如果我的内容不太可能被打印出来，我是否会更好（即使只是略微添加） ？

# qt - QObject objectName 未显示在自动完成中

> ID：15304389
> 
> 赞同：0
> 
> 时间：2013-03-08T22:25:49.177
> 
> 标签：qt, ide, qt-creator

我正在使用 QtCreator 2.4.1 开发一个程序。问题是，当我在 QtDesigner 中添加一个名为 Widget1 的小部件，然后尝试使用 ui::Widget1 调用小部件时，自动完成似乎不起作用。

它显示了所有蓝色选项，例如 aboutAction、aboutMenu、cameraResolutionLabel，但不显示小部件的名称，这真的很烦人，因为如果我忘记了小部件的名称，我必须返回 QtDesigner 界面来检查它。

说明：

```
MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
 {
    ui->setupUi(this);
    ui-> "HERE IS WHERE THE NAMES DONT SHOW UP"
 } 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:11:42.543

有时您必须重新运行 qmake 并重建您的项目，以便新的小部件显示在自动完成中。这通常会强制 Qt Creator 的智能感知等效项重新解析所有文件。

另一种可能性是代码中其他地方的错误导致编译器无法将您的新类识别为类。确保您已`include`准备好所需的一切。

# php - 使用 Android 管理 MySQL 数据库

> ID：15304392
> 
> 赞同：0
> 
> 时间：2013-03-08T22:25:59.917
> 
> 标签：php, android, mysql, android-intent

我创建了一个使用服务器上的 PHP 文件与 MySQL 数据库交互的 Android 应用程序。我创建了一个`final string EXTRA_SOLDE`意图发送到其他活动以显示结果。

一切都很好，但在另一个活动中，它`TextView`是空白的，好像什么都没发送一样。请帮忙。

这是我的 PHP 文件：

```
<?php
unset($_GET);

if( isset($_POST['username'])) {

    echo '<?xml version="1.0"?>'."\n";
    echo "<login>\n";

    // host doit être remplacé par le serveur de la base de données.
    // user représente le nom d'utilisateur de la base de données.
    // pass est le mot de passe pour accéder à cette base de données avec cette 
// utilisateur.
    $con = mysql_connect("mysql6.000webhost.com","","");
    if (!$con)
    {
        die('Could not connect: ' . mysql_error());
    }

    mysql_select_db("a1287023_auth",$con);

    if(get_magic_quotes_gpc()) {
        $login = stripslashes($_POST['username']);
    } else {
        $login = $_POST['username'];
    }

    unset($_POST);

    $kid = login($login);
    if($kid == -1) { 
        error(3); 
    } else {
        printf('    <user id="%d"/>'."\n",$kid);
    }

    echo "</login>";
}

function error($ec) {
    printf('    <error value="%d"/>'."\n".'</login>',$ec);
    die();
}

function login($login) {
   $select = "
        SELECT epargne
        FROM auth_table
        WHERE user_id = '$login' 
        ";
    $fixedlogin = mysql_real_escape_string($login);
    $query = sprintf($select, $fixedlogin);
    $result = mysql_query($query);
    if(mysql_num_rows($result) != 1) { return -1; }    
    $row = mysql_fetch_row($result);
    return $row[0];
    return $row[1];
}

?> 
```

这是我调用服务器上设置的 PHP 文件的活动。

```
public void onClick(View v){ 
    Intent intent = getIntent();

    if (intent != null) {
        String valeur=intent.getStringExtra(EXTRA_USER);
        doLogin(valeur);
    }
    }
});}       

private void doLogin(final String login) {
    // Création d'un thread
    Thread t = new Thread()
    {
        public void run()
        {
            Looper.prepare();
            // On se connecte au serveur afin de communiquer avec le PHP
            DefaultHttpClient client = new DefaultHttpClient();
            HttpConnectionParams.setConnectionTimeout(client.getParams(), 15000);

            HttpResponse response;
            HttpEntity entity;

            try
            {
                // On établit un lien avec le script PHP
                HttpPost post = new HttpPost(UPDATE_URL);

                List<NameValuePair> nvps = new ArrayList<NameValuePair>();

                nvps.add(new BasicNameValuePair("username", login));

                post.setHeader("Content-Type", "application/x-www-form-urlencoded");
                // On passe les paramètres login et password qui vont être récupérés
                // par le script PHP en post
                post.setEntity(new UrlEncodedFormEntity(nvps, HTTP.UTF_8));
                // On récupère le résultat du script
                response = client.execute(post);

                entity = response.getEntity();

                InputStream is = entity.getContent();
                // On appelle une fonction définie plus bas pour traduire la réponse
                read(is);
                is.close();

                if (entity != null)
                    entity.consumeContent();
            }
            catch (Exception e)
            {
                progressDialog.dismiss();
                createDialog("Error", "Connexion Impossible");
            }
            Looper.loop();
        }
    };
    t.start();
}

private void read(InputStream in)
{
    // On traduit le résultat d'un flux
    SAXParserFactory spf = SAXParserFactory.newInstance();

    SAXParser sp;

    try
    {
        sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();
        // Cette classe est définie plus bas
        LoginContentHandler uch = new LoginContentHandler();

        xr.setContentHandler(uch);

        xr.parse(new InputSource(in));

    }
    catch (ParserConfigurationException e)
    {

    }
    catch (SAXException e)
    {

    }
    catch (IOException e)
    {
    }

}

class LoginContentHandler extends DefaultHandler
{
    // Classe traitant le message de retour du script PHP
    private boolean in_loginTag = false;
    private int userID;
    private String money ; 
    private boolean error_occured   = false;

    public void startElement(String n, String l, String q, Attributes a)

    throws SAXException
    {
        if (l == "login")
            in_loginTag = true;
        if (l == "error")
        {
            progressDialog.dismiss();
            switch (Integer.parseInt(a.getValue("value")))
            {
                case 1:
                    createDialog("Error", "Couldn't connect to Database");
                    break;
                case 2:
                    createDialog("Error", "Error in Database: Table missing");
                    break;
                case 3:
                    createDialog("Error", "Invalid username and/or password");
                    break;
            }
            error_occured = true;
        }

        if (l == "user" && in_loginTag && a.getValue("id") != "")
            // Dans le cas où tout se passe bien on récupère l'ID de l'utilisateur
            userID = Integer.parseInt(a.getValue("id"));
        money = String.valueOf(userID) ;

    }

    public void endElement(String n, String l, String q) throws SAXException
    { 
        // on renvoie l'id si tout est ok
        if (l == "login")
        {
            in_loginTag = false;

            if (!error_occured)
            {
                progressDialog.dismiss();
                Intent i = new Intent(Budget.this,Epargne.class);
                i.putExtra(EXTRA_SOLDE,money);

                startActivity(i);

            }
        }
    }

    public void characters(char ch[], int start, int length)
    {
    }

    public void startDocument() throws SAXException
    {
    }

    public void endDocument() throws SAXException
    {
    }

}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T23:49:17.057

对于初学者来说，使用用户作为 Root 并且没有密码很简单！在你的 PHP 文件中不要使用密码！并将您的 PhpmyAdmin 设置设置为 root！

***PHP 文件*** *`define('DB_SERVER', "localhost"); // db server define('DB_USER', "root"); // db user define('DB_PASSWORD', ""); // db password (mention your db password here) define('DB_DATABASE', "diplom"); // database name*`

# java - 如何让媒体控制器工作

> ID：15304398
> 
> 赞同：0
> 
> 时间：2013-03-08T22:26:50.840
> 
> 标签：java, android

我的应用程序中有一首歌曲，我希望能够通过媒体控制器进行控制，我有我认为可以准确表示如何执行此操作的代码，但是我的代码中有 2 个错误，我会给出详情如下，谁能帮帮我。

错误一：MediaController类型中的setMediaPlayer(MediaController.MediaPlayerControl)方法不适用于参数(MediaPlayer)

错误 2：未为类型 MediaPlayer 定义方法 setMediaController(MediaController)

我到目前为止的代码：

```
MediaPlayer Song;

@Override
protected void onCreate(Bundle savedInstanceState) {
// TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
         getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,WindowManager.LayoutParams.FLAG_FULLSCREEN );
        setContentView(R.layout.billy);

        Song = MediaPlayer.create(BillyConnoly.this, R.raw.clip_1);

        MediaController mc = new MediaController(this);
        mc.setMediaPlayer(Song);
        Song.setMediaController(mc);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:32:50.953

托马斯，我将尝试在此处解释[链接](https://stackoverflow.com/questions/3747139/how-can-i-show-a-mediacontroller-while-playing-audio-in-android/5265629#5265629)。

首先，您需要定义播放器、控制器和处理程序字段：

```
 private MediaPlayer mediaPlayer;
  private MediaController mediaController;

  private Handler handler = new Handler(); 
```

接下来，您需要实例化所有适当的对象（正如您所做的那样），并注册一个 OnPreparedListener：

```
mediaPlayer = new MediaPlayer();
mediaPlayer.setOnPreparedListener(this);

mediaController = new MediaController(this); 
```

然后，准备并启动 mediaPlayer：

```
try {
  mediaPlayer.setDataSource(audioFile);
  mediaPlayer.prepare();
  mediaPlayer.start();
} catch (IOException e) {
  Log.e(TAG, "Could not open file " + audioFile + " for playback.", e);
} 
```

准备好 mediaPlayer 后，将设置控制器：

```
 public void onPrepared(MediaPlayer mediaPlayer) {
    Log.d(TAG, "onPrepared");
    mediaController.setMediaPlayer(this);

    handler.post(new Runnable() {
      public void run() {
        mediaController.setEnabled(true);
        mediaController.show();
      }
    });
  } 
```

现在更有意义了吗？

编辑：这是从 res/raw 文件夹中播放文件的方式：

```
int resID=getResources().getIdentifier("filename", "raw", getPackageName());
MediaPlayer mediaPlayer=MediaPlayer.create(this,resID); 
```

# java - 带有 Android 客户端和 PC 服务器的套接字

> ID：15304401
> 
> 赞同：0
> 
> 时间：2013-03-08T22:26:57.733
> 
> 标签：java, android, sockets, client

我已经看到了其中一些问题，但似乎没有一个答案可以解决我的问题。我想从我的客户端（Android 手机，我实际上有一个物理**设备**）在我的服务器（PC）上显示一条消息。我有一个非常简单的 PC 服务器：

```
public void run(int port) throws Exception
{
    ServerSocket ss = new ServerSocket(port);
    Socket sock = ss.accept();

    BufferedReader reader = new BufferedReader(new InputStreamReader(sock.getInputStream()));

    System.out.println(reader.readLine());
} 
```

（在我的主要空白中）：

```
Server s = new Server();
s.run(4444); 
```

还有一个极其简单的 Android 客户端：

```
package com.j03.client;

import android.app.*;
import android.os.*;
import android.view.*;
import android.widget.*;
import java.io.*;
import java.net.*;

public class MainActivity extends Activity
{
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        try
        {
            runClient("10.0.2.2", 4444, "hey");
        }
        catch (Exception e)
        {
            TextView t = new TextView(this);
            t.setText(e.getMessage());
            setContentView(t);
        }
    }

    public static void runClient(String ip, int port, String message) throws Exception
    {
        Socket sock = new Socket(ip, port);
        PrintStream ps = new PrintStream(sock.getOutputStream());
        ps.println(message);
    }
} 
```

我的清单文件中也有适当的互联网权限：

```
<uses-permission android:name="android.permission.INTERNET"/> 
```

并且客户端代码可以作为 PC 客户端正常工作。（PC 客户端到 PC 服务器工作正常）。

但我无法让它在 Android 上运行！

PC 服务器根本不显示任何内容。:(

有谁知道我可能做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:36:55.250

您也可能在 UI 线程上执行所有这些操作。我认为如果你这样做并显示应用程序没有响应对话框，android 有时会杀死你的应用程序。

另一张海报关于您的 Activity 在发生异常之前为空也是正确的。我会解决这个问题并尝试使用你的 runClient 启动一个单独的线程

# google-app-engine - 已删除的实体使用数据存储区管理员不断返回

> ID：15304418
> 
> 赞同：2
> 
> 时间：2013-03-08T22:28:29.403
> 
> 标签：google-app-engine, google-cloud-datastore, datastore-admin

我正在尝试将数据存储从一个应用程序复制到另一个应用程序（实时到开发服务器）。我首先需要删除开发服务器上的所有实体（我正在使用的实际开发应用程序，不要与本地开发服务器混淆）。我在数据存储管理控制台中执行此操作，但是在该过程完成后，我仍然拥有`_GAE_MR_MapreduceState`和`_GAE_MR_ShardState`实体。据我了解，这些在删除过程中应该是临时的。除此之外，偶尔当我访问数据存储管理控制台时（大约一半时间），我还会看到一些已删除的实体也再次出现。我又删除了几次。

我在数据存储查看器中看不到它们，但我不知道是否总是如此。我还没有看到他们再次出现在这个视图中。在数据存储查看器中，只有 、 和 类型`_AE_Backup_Information`的实体。我在这个视图中看不到和实体。`_AE_Backup_Information_Kind_Files``_AE_Backup_Information_Kind_Type_Info``_AE_DatastoreAdmin_Operation``_GAE_MR_MapreduceState``_GAE_MR_ShardState`

**更新：**我刚刚能够在数据存储查看器中捕获我已删除的实体之一。尽管这里只有一种已删除的实体类型和一种可见的实体（在我看到 3 或 4 种实体类型和数千个实体之前）。在我在数据存储查看器中捕捉到它之后，我立即前往数据存储管理控制台，发现这里可以看到相同的实体类型，尽管在这种情况下有两个。这次我也没有在数据存储区管理员中找到and `_GAE_MR_MapreduceState`nor `_GAE_MR_ShardState`,`_AE_Backup_Information`和`_AE_Backup_Information_Kind_Files`实体。**结束更新**`_AE_Backup_Information_Kind_Type_Info``_AE_DatastoreAdmin_Operation`

 **我没有尝试在数据存储管理控制台中删除`_GAE_MR_MapreduceState`和`_GAE_MR_ShardState`实体。这似乎有点不安全，因为这些实体是在删除操作期间创建的，我不知道它会做什么。我会尝试在 datstore 查看器中删除它们，但它们没有出现在那里。

我删除的实体出现在数据存储管理控制台中的那些时间`_AE_Backup_Information`，`_AE_Backup_Information_Kind_Files`以及`_AE_Backup_Information_Kind_Type_Info`实体`_AE_DatastoreAdmin_Operation`也在那里可见。所以这也很奇怪。

任务队列中没有任务，也没有作业正在运行。

这是某种同步问题吗？缓存没有在某处更新吗？有什么方法可以重置一些东西来清除这些实体吗？

**更新 2：**我尝试刷新 Memcache，但这并没有什么不同。实体继续显示在数据存储管理控制台中，几乎 100% 的时间。我没有看到任何已删除的实体出现在数据存储查看器中，但是因为我删除了我之前发现的那个。

**更新 3：**我只是尝试在另一个应用程序中执行相同类型的数据存储删除操作，结果我得到了相同的损坏。我首先创建了一个备份，然后选择并删除了所有实体，这两项操作都是从数据存储管理控制台进行的。

删除操作作业已完成。它们显示在已完成的操作下。任务队列中不再有作业。但是所有实体在数据存储管理控制台中再次可见！我删除了 10 种实体类型，大多数有几十个实体，一个有几千个。在数据存储管理控制台中，每一种实体类型都会以相同数量的实体再次列出。

在数据存储查看器中，仍然保留了两种实体类型，与删除操作之前相比，实体数量更少（但仍然很重要）。删除前从 6,855 中的 2,172 之一。另一个从 44 中删除 17。

我再次刷新了 Memcache。它没有任何区别。

我看到数据存储管理员是[实验性](https://developers.google.com/appengine/docs/adminconsole/datastoreadmin)的，但我不希望它通过执行简单的删除操作来完全破坏我的数据存储，之后无法重置数据存储。我现在有两个应用程序，它们都启用了计费功能，但都需要花费我的客户资金，但它们无法使用，因为它们的数据存储已损坏。我在这里有什么选择？我可以从 Google 的某个人那里得到回复吗？这是Google App Engine 支持的[推荐论坛。](https://developers.google.com/appengine/community)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-03-26T00:34:24.213

看起来您在开发应用程序中设置了旧式导出。您可能应该检查您的 cron.yaml 并禁用这些导出。[理想情况下，您将使用托管导入/导出服务](https://cloud.google.com/datastore/docs/export-import-entities)切换到更新（且更便宜）的导出。对于批量删除，当前的建议是将 Cloud Dataflow 与[批量删除模板](https://cloud.google.com/datastore/docs/bulk-delete)一起使用。托管导入/导出和基于 Cloud Dataflow 的删除都不会在您的项目中使用 Cloud Datastore 数据库，而旧样式的导出和删除都将使用您的 Cloud Datastore 数据库。**

# assembly - 在现有标签后两行设置 gdb 断点

> ID：15304419
> 
> 赞同：4
> 
> 时间：2013-03-08T22:28:34.350
> 
> 标签：assembly, gdb

我有一个汇编程序，在不同的行上有几个标签。我需要`gdb`在带有标签的行之后的两行设置断点。如何在`gdb`不向程序添加额外标签的情况下做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-17T01:38:29.710

`gdb`支持在标签后添加断点 X 字节，由于每条指令是 4 字节，我只需要执行以下操作：

```
*&labelname + 8 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:29:39.637

`b foo`，其中`foo`是源中的行号。

# php - PHP 检查过去的日期

> ID：15304421
> 
> 赞同：0
> 
> 时间：2013-03-08T22:28:37.813
> 
> 标签：php

我正在使用 RFC822 日期格式并试图让我的 if 语句工作，但它不会，我无法弄清楚为什么，这就是数据回显的内容：

```
$currentdate = Fri, 01 Mar 13 22:24:02 +0000
$post['created_on'] = Sat, 17 Nov 2012 19:26:46 +0100 
```

这是我的声明：

```
$currentdate = date(DATE_RFC822, strtotime("-7 days"));
if ($post['created_on'] < $currentdate) 
{
  echo "test";
}
else
{

} 
```

我正在尝试检查创建的数组是否在过去 7 天内，我认为它与语句中的“<”或日期的格式有关？

谢谢，西蒙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:31:47.153

您想比较时间戳：

```
<?php
if (strtotime($post['created_on']) >= strtotime('-7 days'))
{
    // Created in the last seven days
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:31:12.453

当您进行字母数字比较时，您的代码无法工作。RFC822 不是为此而设计的。

请注意，`Fri ...`它低于字母表中`Sat ...`的比较。`F``S`

使用[`DateTime`](http://www.php.net/manual/en/class.datetime.php)类：

```
$currentdate = new DateTime('-7days +0100'); // ! use the same tz offset as the post !
$postdate = new DateTime('Sat, 17 Nov 2012 19:26:46 +0100');

if($postdate < $currentdate) {
  // ... do stufff
} 
```

# ibm-mq - crtmqm：找不到命令

> ID：15304425
> 
> 赞同：2
> 
> 时间：2013-03-08T22:29:24.850
> 
> 标签：ibm-mq

我已经安装了 MQ 的试用版，现在我正在尝试创建一个队列管理器。运行命令 crtmqm 给出

```
crtmqm -q QManager
bash: crtmqm: command not found 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:31:47.620

很可能是您的路径设置不正确。

找出 的`crtmqm`位置（例如使用`find / -name crtmqm`）并将该目录添加到您的路径中（在您最喜欢的启动文件中，例如`.profile`或`.bash_profile`）。

然后，您*可能*还需要打开一个新会话（甚至重新登录），具体取决于更改了哪个启动文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-10T09:56:34.170

我在使用 IBM MQ V7.5 时遇到了同样的问题。我可以通过设置目录的路径来摆脱这个[问题](http://techfeast-hiranya.blogspot.com/2009/09/enterprise-messaging-with-synapse-wso2.html)

为了设置补丁，我将该行添加`export PATH=$PATH:/home/wso2/mqm/bin`到用户的`.bashrc`文件中并执行了`source .bashrc`命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T22:39:11.883

最可能的原因是您没有运行[`setmqinst`](http://pic.dhe.ibm.com/infocenter/wmqv7/v7r5/topic/com.ibm.mq.doc/fa15635_.htm)。

当 WebSphere MQ 获得多重安装功能时，有必要明确告诉 WMQ 您要使用哪个安装作为默认安装。当多次安装具有不同版本并且 API 可能已更改或类重新打包时，这一点尤其重要。运行`setmqinst`正确的库、类等的源代码。完整的详细信息在上面链接的信息中心页面上。

不幸的是，`PATH`按照其他受访者的建议设置仅适用于仅安装一次 WMQ 且位于默认位置的狭窄情况。

# regex - “abcd”的vim正则表达式，其中“bc”是可选的？

> ID：15304430
> 
> 赞同：25
> 
> 时间：2013-03-08T22:29:52.387
> 
> 标签：regex, vim

我想搜索它的出现`ad`和`abcd`在哪里`bc`是可选的。我怎样才能做到这一点？IE，

```
+-------+----------+
| ad    | MATCH    |
| abcd  | MATCH    |
| abd   | NO match |
| abbd  | NO match |
| abced | NO match |
| abcbcd| NO match |
+-------+----------+ 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-03-08T22:29:52.387

解决方案：
选项 1：`ad\|abcd`
选项 2：`a\(bc\)\=d`
选项 3：`a\(bc\)\?d`

关闭但不完全：
选项 4：（`a\(bc\)\{-\}d`零个或**多个**；匹配不需要的**abcbcd**）

说明：

```
+--------+--------------------------+
| \|     | logical OR (alternation) |
| \(bc\) | treat `bc` as a group    |
| \=     | zero or one occurrences  |
| \?     | zero or one occurrences  |
| \{-\}  | zero or more occurrences |
+--------+--------------------------+ 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-08T23:21:44.490

好吧，我可能很愚蠢，但如果要求是

> 搜索出现的 ad 和 abcd，其中 bc 是可选的。

为什么不简单明了`/ad\|abcd`？

# java - 使用基于表单的 Spring Security 对 Java 应用程序进行身份验证后，如何使用 Apache HttpClient 持久化 cookie

> ID：15304433
> 
> 赞同：3
> 
> 时间：2013-03-08T22:29:59.760
> 
> 标签：java, spring, security, authentication, cookies

我有一个用 Spring（MVC、安全、事务等）构建的 Java 应用程序（码头服务器），并将 REST 用于 Web 服务。我有另一个 Java 客户端，它使用 Apache HTTPClient (HttpComponents) 对服务器进行 REST 调用。服务器应用程序使用基于表单的身份验证，Web 客户端使用 j_spring_security_check 表单登录应用程序。因此，从 Java 客户端我使用 [https://host:port/myapp/j_spring_security_check?j_username=myuser&j_password=mypass] 使用 POST 进行登录。身份验证工作正常（它到达 UserDetailService 的子类并成功进行身份验证），但随后的 REST 调用失败，表明用户没有经过身份验证（调用甚至没有到达给定休息调用的控制器方法）。我取回了应用程序的 html 页面之一（这是 jsp 页面之一）。

我正在为每个请求（包括登录）打印 Cookie，它为每个请求打印不同的 jsessionid（请求是对服务器的其余调用）。这是cookie，每个请求一个，第一个请求是登录请求（请参阅每个请求的jsessionid不同）：

```
cookies: [[version: 0][name: JSESSIONID][value: 1x5i3b0lbf5o7xv52kjh0vu89][domain: 127.0.0.1][path: /webui][expiry: null]]
cookies: [[version: 0][name: JSESSIONID][value: t05vbrffqv6t1xcygps9l6jaz][domain: 127.0.0.1][path: /webui][expiry: null]]
cookies: [[version: 0][name: JSESSIONID][value: 8v5i5ofbgr201kh2txxale674][domain: 127.0.0.1][path: /webui][expiry: null]] 
```

每个请求的不同 jsessionid 是问题/原因吗？我该如何解决这个问题？这是使用 HttpClient 的代码：

```
 request = new HttpPost(url);
    httpClient = new DefaultHttpClient();        

    httpClient.getConnectionManager().getSchemeRegistry().register(new Scheme("https", 443, socketFactory));

    HttpResponse response = httpClient.execute(request);
    System.out.println("cookies: " + httpClient.getCookieStore().getCookies());
    HttpEntity resp_ent = response.getEntity();
    this.status_code = response.getStatusLine().getStatusCode(); 
```

我们需要做一些特别的事情来存储cookie吗？很感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:40:08.727

从您显示的代码片段中看不出来，所以我不确定这是否是问题所在，但请确保您不要`new DefaultHttpClient()`为每个请求创建一个，否则新客户端将有一个新的`CookieStore`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T19:54:56.913

首先，我想澄清一下流程。成功验证后，（Java）服务器将 JSESSIONID cookie 添加到响应中。客户端（浏览器或其他客户端；在我们的例子中是 Apache HTTP 客户端）从响应中获取 cookie 并将其与新请求一起发送。然后，当请求使用 cookie 访问服务器时——它可以检查请求是否经过身份验证，并且不需要身份验证。否则（没有 cookie 的请求）服务器需要身份验证。

在您的情况下，当您使用没有 cookie 的 Apache HTTP 客户端时，会存储没有 cookie 发送的每个请求。要修复它，您需要分配 cookie 存储。你应该只做一次（在 PostConstructor 中）：

```
 httpClient = new DefaultHttpClient();
        // Create a local instance of cookie store
        cookieStore = new BasicCookieStore();
        // Set the store
        httpClient.setCookieStore(cookieStore); 
```

然后，您使用相同的客户端实例执行调用。客户端将从响应中获取 cookie，将其存储在 cookieStore 中，并与下一个请求一起发送。

如果您需要任何其他说明，请告诉我。

最好的祝福，

迈克尔

# c++ - 指向对象 c2228 错误的指针的 C++ 队列

> ID：15304434
> 
> 赞同：0
> 
> 时间：2013-03-08T22:30:00.777
> 
> 标签：c++, pointers, queue

我正在尝试创建一个对象队列并稍后修改它们。由于创建队列只是在修改队列中的它们并删除它们后创建一个副本，因此它们消失了。所以我需要一个指向我的对象的指针队列来解决这个问题（或者我理解）。

我的课：

```
class process { 
    int waittime;
    queue<int> cpuburst, iotime;
   } 
```

然后我像这样创建我的队列：

```
process *P1;
process *P2;

P1 = new process(//info to fill my P1 with data);
P2 = new process(//info to fill my P2 with data);

queue<process *> readyque;
queue<process *> onCPU;

readyque.push(P1);
readyque.push(P2); 
```

编译得很好，但是当我尝试使用 .front() 或 .push() 对队列做任何事情时，我得到了错误`C2228: left of '.cpuburst' must have class/struct/union` ，并且我得到`IntelliSense: expression must have class type`了“onCPU”的错误

在这条线上：

```
x = onCPU.front().cpuburst.front() + y; 
```

我只是想让 x 等于我班级队列顶部的值，这也是我的 onCPU 队列的顶部

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:31:55.047

由于`onCPU`包含指针，当你这样做时，`front()`你会得到一个指针。要通过指针访问对象的成员，请使用`->`：

```
x = onCPU.front()->cpuburst.front() + y; 
```

由于您不确定拥有 a `queue`of 指针是否是一个好主意，请问问自己：`process`对象是否应该是拥有它们唯一所有权的对象的*一部分？*`queue`还是应该`queue`简单地引用在其他地方创建的对象？

如果您可以避免动态分配对象，那总是一件好事。也许 a`std::queue<std::reference_wrapper<process>>`会有用。

如果您想继续动态分配它们，请考虑使用智能指针（例如`std::unique_ptr`or `std::shared_ptr`）。

如果您坚持使用指向动态分配对象的原始指针，请不要忘记`delete`它们。

# bash - 在 bash 脚本中连接不同压缩类型的文件的最有效方法是什么？

> ID：15304435
> 
> 赞同：1
> 
> 时间：2013-03-08T22:30:01.087
> 
> 标签：bash, cat, built-in

我现在已经多次遇到这种需求，我很惊讶我很难找到一种“最佳”方法来连接不同压缩类型的文件。

例如，我有一个目录，其中包含文件`content1`、`content2.bz2`和`content3.gz`. 如果我想对所有文件执行相同的操作，我必须首先检查它们是什么压缩才能正确解压缩，解压缩，然后执行我的操作。

从那以后，我编写了一个脚本来以“智能”方式处理连接。

```
#! /bin/bash
# Smart Cat
# usage smcat <file|file*>

for file in $@; do
    end=${file##*.}
    if [[ $end == 'bz2' ]] ; then
        bzcat $file
    elif [[ $end == 'gz' ]] ; then
        gzcat $file
    else
        cat $file
    fi
done 
```

似乎很愚蠢，没有内置的方法来处理所有不同的压缩类型。还是在那里，我还没有找到？感谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:41:43.360

可能没有单一的内置方式来处理不同的压缩类型。如果您不想依赖文件扩展名来确定压缩类型，则可以使用`file`命令，例如

```
file test.bz2   
test.bz2: bzip2 compressed data, block size = 900k 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:51:24.767

## 使用 GNU Tar 的自动压缩标志

如果您主要处理 tarball，则可以使用 GNU tar 的自动压缩标志解决部分问题，该标志表示：

```
 -a, --auto-compress
       use archive suffix to determine the compression program 
```

这可以处理 bz2 和 gz 扩展，但可能会让你因为更奇特的事情而失败。例如：

```
tar xvfz "$filename" 
```

将在*somefile.tar.gz*和*somefile.tar.bz2*上以相同的设施工作。

## 用于`/usr/bin/file`识别

文件实用程序通常会在 grep 或 glob 模式的帮助下为您提供正确的文件类型。例如：

```
$ file foo*
foo:     ASCII text
foo.bz2: bzip2 compressed data, block size = 900k
foo.gz:  gzip compressed data, was "bar", from Unix, last modified: Fri Mar  8 17:33:48 2013 
```

您可以使用 case 语句来简化这些文件的工作，或者迭代文件 glob 或使用`"$@"`. 无论哪种方式，这个例子都应该有帮助：

```
for file in foo*; do
    case `file "$file"` in
        *ASCII*) cat   "$file" ;;
         *gzip*) zcat  "$file" ;;
          *bz2*) bzcat "$file" ;;
    esac
done 
```

# matlab - 八度错误：下标索引必须是正整数或逻辑数

> ID：15304436
> 
> 赞同：3
> 
> 时间：2013-03-08T22:30:04.287
> 
> 标签：matlab, sum, sequence, octave, indices

我正在尝试对索引向量和索引矩阵的乘积求和，如下所示：

```
k=[0:1:N-1]  
n=[0:1:N-1]  
x_n = sin(pi*n)  
N = size(x_n,2)  
_seqgen(x_n(n)*exp(k*n/N), n, 0..N-1) 
```

但我得到了错误：

```
error: subscript indices must be either positive integers or logicals 
```

我在这里想念什么？

编辑：我刚刚意识到我错过了 _plus 函数来总结生成的序列。它应该如下所示：

```
k=[0:1:N-1]  
n=[0:1:N-1]  
x_n = sin(pi*n)  
N = size(x_n,2)  
_plus(_seqgen(x_n(n)*exp(k*n/N), n, 0..N-1)) 
```

我仍然得到同样的错误虽然......

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-08T23:23:16.083

错误消息解释了问题所在：您尝试使用不是正整数或逻辑的数字来索引数组。代码中唯一的数组索引是`x_n(n)`. 果然，这条线`n=[0:1:N-1]`表明指数`n`不是正数，因为`0`不是正数。课程：**MATLAB/Octave 总是从 1 开始索引。** 我确实建议你学习一些真正的教程，因为这是你需要知道的基础知识。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T04:18:51.307

请允许我对你的代码提出一些批评——因为你承认你是这方面的新手。首先你创建向量

```
n = [0:1:N-1]; 
```

顺便说一句，它不需要方括号，可以写成

```
n = 0:N-1; 
```

然后，您生成一个向量`x_n`，对于给定的值，该向量将全为零（`sin(pi*n)`对于 的整数值 ==0 `n`）。

接下来，你做了一些奇怪的事情——你似乎正在生成一个符号序列，循环一个`n`看起来很像`n`你之前定义的数组的变量。不知道该怎么做——这似乎不是一个好主意。请注意，即使@jazzbassrob 也对此感到困惑-您收到“无法使用零索引”错误的事实不是因为您的 vector 的值`n`，而是因为您`0..N-1`在 _seqgen 命令中循环（不一样事情，尽管它恰好是相同的值）。

在那个 _seqgen 表达式中，我看到`exp(k*n/N)`了哪个有效，因为在这种情况下`n`是被单步执行的变量`0..N-1`- 如果 Matlab 正在查看 的早期定义`n`，它会由于维度不匹配而引发另一个错误（因为`*`是矩阵乘法运算符并且期望第一个元素的第二个维度 = 第二个元素的第一个维度）。

做你想做的事情的更标准的方法是

```
mySum = sum(x_n.*exp(k.*n/N)); 
```

这对 x_n 中的项和 的逐`exp`元素乘积除以 进行逐元素乘法。`k``n``N`

注意 - 这是否真的“更好”取决于你想对结果做什么（上面评估它）。

# javascript - 有人可以从howtonode解释一个包装成语的函数吗？

> ID：15304437
> 
> 赞同：2
> 
> 时间：2013-03-08T22:30:12.210
> 
> 标签：javascript, node.js, closures, connect

我最近开始使用 node.js、express 和 mongodb。由于 express 使用 connect 来提供中间件支持，我开始阅读中间件和连接。

[我在howtonode.org](http://howtonode.org/connect-it)上遇到了以下示例：

```
return function logItHandle(req, res, next) {
 var writeHead = res.writeHead; // Store the original function

 counter++;

 // Log the incoming request
 console.log("Request " + counter + " " + req.method + " " + req.url);

 // Wrap writeHead to hook into the exit path through the layers.
 res.writeHead = function (code, headers) {
   res.writeHead = writeHead; // Put the original back

   // Log the outgoing response
   console.log("Response " + counter + " " + code + " " + JSON.stringify(headers));

   res.writeHead(code, headers); // Call the original
 };

 // Pass through to the next layer
 next(); 
}; 
```

有人可以向我解释这次关闭中发生了什么吗？作者称之为

> *包装成语以挂钩到对 writeHead 的调用*

这意味着什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:33:18.430

它拦截对 的调用`res.writeHead`，添加一些日志记录，然后将调用委托给原始`res.writeHead`.

这就像一个超级简单的 AOP 方法拦截。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T09:46:12.910

让我们分解这里发生的事情

```
wrapping idiom to hook into the call to writeHead 
```

在标准*快递*流程中，接收请求 ( **req** ) 并准备响应 ( **res** )。( **req** , **res** ) 对可以通过一系列过滤器级联，这些过滤器可以修改**req**并准备**res**。

在流程中的某一时刻，**资源**将被视为已准备好，可以将响应的标头发送到客户端。将为此目的调用函数*res.writeHead *。*

这个函数的原型是*function (code, headers)*，为了记录将要发送的 headers，你需要在这个时候挂钩代码并做一个

```
console.log("Response " + code + " " + JSON.stringify(headers)); 
```

在某种程度上，如果代码中的原始函数是

```
res.writeHead = function(code, headers) {
    // original code
} 
```

您想将此代码替换为

```
res.writeHead = function(code, headers) {
    console.log("Response " + code + " " + JSON.stringify(headers));
    // original code
} 
```

在某种程度上，您希望在 writeHead 函数的开头“插入”一段代码。

但是您不应该尝试修改原始 writeHead 代码，因为您可能甚至不知道这段代码是在哪里编写的，并且您不想开始查找。所以你想劫持这个函数：当一段代码调用 res.writeHead 时，你希望你的函数被调用。

解决这个问题的方法很简单

```
return function logItHandle(req, res, next) {
   res.writeHead = function (code, headers) {
       console.log("Response " + code + " " + JSON.stringify(headers));
   }
   next(); 
} 
```

但是如果你只这样做，你会遇到一些麻烦，因为原始的 writeHead 代码会丢失并且不会被调用。因此，标头将被记录但不会发送给客户端！

您需要一种方法来“记住”原始代码并在 writeHead 变体的末尾调用它：

```
return function logItHandle(req, res, next) {

   // save the original writeHead function so that it can be referenced in the closure
   var originalWriteHead = res.writeHead; 

   res.writeHead = function (code, headers) {

       // log the response headers
       console.log("Response " + code + " " + JSON.stringify(headers));

       // make as if our hook never existed in the flow
       res.writeHead = originalWriteHead ;

       // call the original writeHead because otherwise the external code
       // called our implementation of writeHead instead of the original code
       res.writeHead(code, headers);

   }
   next(); 
} 
```

# php - php dynamodb - 如何执行“（key1，key2，key3）中的哈希键”查询？

> ID：15304439
> 
> 赞同：0
> 
> 时间：2013-03-08T22:30:20.607
> 
> 标签：php, amazon-web-services, amazon-dynamodb

我一直将 dynamodb 视为目前唯一托管的完全可扩展的 nosql 系统，我发现它可以消除数据库管理的麻烦。

我目前有一个 RSS 提要索引系统，其中提要数据被插入到 mongodb 中，然后 sphinxsearch 循环遍历整个数据库并索引各个字段（我使用 main+delta 索引，但这里不需要解释）。

使用 sphinx，我可以进行复杂的查询和排序，它给了我一个有序的文章 ID 数组，一旦我用这些 id 查询 mongo，然后我重新排序 mongo 数组以匹配 sphinx 给我的顺序。

```
function prepare_for_mongo($keys){
    $results_keys_mongo = array();
    if(sizeof($keys)>0){
        foreach($keys as $key=>$value){
            $results_keys_mongo[$key] = new MongoID($value);
        }
    }
    return $results_keys_mongo;
}

function sort_mongo_results($documents,$keys){
    $documents_sorted = array();
    foreach($keys as $key){
        $documents_sorted[$key] = $documents[$key];
    }
    return $documents_sorted;    
}

function retrieve_records($keys) {
    $m_keys = $this->prepare_for_mongo($keys);
    if(!empty($m_keys)) {
        $records = iterator_to_array($this->mongodb->find(array(
            '_id' => array('$in' => $m_keys)
        )));
        $records = $this->sort_mongo_results($records,$keys);
    } else {
        return array();
    }
} 
```

现在，在我迁移到 dynamodb 的过程中，如何使用 php 的 dynamodb 实现类似的查询，我可以在其中传递哈希键列表（表示文章记录的唯一哈希），然后 dynamo 为我提供包含这些哈希键的所有记录的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:45:08.510

我不确定是否存在解决方案。SphinxSearch 似乎是为了在指向 SQL 数据库时完成此任务而构建的。使用 DynamoDB (NoSQL)，您可能必须自己编写等效的 SphinxSearch 来索引和搜索数据，同时将支持索引存储在 DynamoDB 中。在这种情况下，“答案”至少是一个中等规模的开发项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T09:33:44.660

我确实找到了解决方案，将 aws sdk 函数作为`batch_get_item`，然后我可以传递一个 haskey 数组。

# php - Kohana 3.3 ORM::factory('foo', $id) 不加载模型，缺少什么？

> ID：15304441
> 
> 赞同：0
> 
> 时间：2013-03-08T22:30:46.997
> 
> 标签：php, kohana, kohana-orm

我有以下模型：

```
class Model_Job extends ORM
{
    public $ID;

    public $user_ID;
    public $title;
    //some more variables
} 
```

在我的控制器中，我有一个功能`action_view()`；查看工作详情单个工作，实现方式与[http://kohanaframework.org/3.3/guide/orm/using#finding-an-object完全相同](http://kohanaframework.org/3.3/guide/orm/using#finding-an-object)

```
public function action_view()
{
    $this->render('Shit');
    $this->template->content = View::factory('jobs/job')
                                    ->bind('job', $job);

    $job = ORM::factory('job', $this->request->param('id'));                    
} 
```

我有另一个函数`action_all()`，它简单地获取所有使用的作业`find_all`并将它们放在页面上，这很好用（意味着`echo $job->ID`它应该做的事情；回显 ID。但是`action_view()`没有。我将放置一些输出`echo Debug::vars($job)`

```
object Model_Job(39) {
    public ID => NULL //Note they are NULL
    public user_ID => NULL 
    public title => NULL
    ......................
    protected _object => array(5) (
        "ID" => string(1) "1"
        "user_ID" => string(1) "1"
        "title" => string(14) "Testbaantjeeee"
        ................
    )
    .....................
 } 
```

`echo Debug::vars($job)`而from的示例`action_all()`如下所示：

```
object Model_Job(39) {
    public ID => 1 //Note they are NOT NULL
    public user_ID => 1
    public title => "Testbaantjeeee"
    ......................
    protected _object => array(5) (
        "ID" => string(1) NULL       //now these are NULL
        "user_ID" => string(1) NULL
        "title" => string(14) NULL
        .....................
    )
    .....................
 } 
```

我查看了 kohena 的关于`factory`,等的文档`find`，`find_all`但无法弄清楚正在做什么`factory`或`find`没有做什么`find_all`。我错过了什么吗？我让它工作使用：

```
$job = ORM::factory('job')
           ->where('ID', '=', $this->request->param('id'))
           ->find_all()[0]; 
```

但这样做对我来说完全没有意义。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T08:40:17.510

好吧，我继续并解决了它。

我创建了一个类`Model_Base`

```
class Model_Base extends ORM
{
    public function Load()
    {
        foreach($this->object() as $key => $value)
            if(!is_object($value))
                if(property_exists(get_class($this), $key))
                    $this->$key = $value;
    }
} 
```

现在我从这里扩展我的所有模型

```
class Model_Job extends Model_Base
{
    ..................
} 
```

现在我的控制器使用这个：

```
public function action_view()
{
    $this->render('Shit');
    $this->template->content = View::factory('jobs/job')
                                    ->bind('job', $job);

    $job = ORM::factory('job', $this->request->param('id'));
    $job->Load();
} 
```

它转储：

```
object Model_Job(39) {
    protected _primary_key => string(2) "ID"
    public ID => string(1) "1"
    public user_ID => string(1) "1"
    public title => string(14) "Testbaantjeeee"
    ......................
} 
```

我仍然认为这没有意义。但是无所谓。如果有人知道他们为什么制造`find()/factory('foo', $id)`并且`find_all()`根本不同以至于前者没用，请告诉我:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T11:25:38.030

您正在为您的 id 使用不同的密钥，它是大写的 ID。确保在您的模型中设置

```
protected $_primary_key = 'ID'; 
```

因为按照您的示例，两种方法都应该完全相同。

# ruby-on-rails - 无法批量分配受保护的属性：用户

> ID：15304442
> 
> 赞同：2
> 
> 时间：2013-03-08T22:30:48.933
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, nested-forms

我有一个使用嵌套模型的注册表单。客户端可以有多个用户，一个`User`属于一个`Client`。在注册表单上，我希望能够同时注册客户和用户。但是，我不断收到用户的“无法批量分配”，因为我有`accepts_nested_attributes_for :users`.

```
<h1>Sign Up</h1>
<%= form_for @client do |client_form| %>
  <% if @client.errors.any? %>
    <div class="error_messages">
      <h2>Form is invalid</h2>
      <ul>
        <% for message in @client.errors.full_messages %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <div class="field">
    <%= client_form.label :business_name %>
    <%= client_form.text_field :business_name %>
  </div>

    <%= client_form.fields_for :user do |user_form| %>  
      <div class="field">
        <%= user_form.label :first_name %>
        <%= user_form.text_field :first_name %>
      </div>
      </div>
        <div class="field">
        <%= user_form.label :last_name %>
        <%= user_form.text_field :last_name %>
      </div>  
      <div class="field">
        <%= user_form.label :username %>
        <%= user_form.text_field :username %>
      </div>
      <div class="field">
        <%= user_form.label :password %>
        <%= user_form.password_field :password %>
      </div>
      <div class="field">
        <%= user_form.label :password_confirmation %>
        <%= user_form.password_field :password_confirmation %>
      </div>
    <% end %> 

  <div class="actions"><%= client_form.submit %></div>
<% end %>

  class Client < ActiveRecord::Base

  attr_accessible :business_name
  attr_accessible :users_attributes

  has_many :users
  has_many :items

  accepts_nested_attributes_for :users, allow_destroy: true

  ...
  end

  class User < ActiveRecord::Base
  attr_accessible :client_id, :first_name, :last_name, :username, :password, :password_confirmation
  belongs_to :client

  has_secure_password
  ....
  end 
```

**错误**

```
ActiveModel::MassAssignmentSecurity::Error - Can't mass-assign protected attributes: user:
  (gem) activemodel-3.2.11/lib/active_model/mass_assignment_security/sanitizer.rb:48:in `process_removed_attributes'
  (gem) activemodel-3.2.11/lib/active_model/mass_assignment_security/sanitizer.rb:20:in `debug_protected_attribute_removal'
  (gem) activemodel-3.2.11/lib/active_model/mass_assignment_security/sanitizer.rb:12:in `sanitize'
  (gem) activemodel-3.2.11/lib/active_model/mass_assignment_security.rb:230:in `sanitize_for_mass_assignment'
  (gem) activerecord-3.2.11/lib/active_record/attribute_assignment.rb:75:in `assign_attributes'
  (gem) activerecord-3.2.11/lib/active_record/base.rb:497:in `initialize'
  app/controllers/clients_controller.rb:45:in `new'
  app/controllers/clients_controller.rb:45:in `create'
  (gem) actionpack-3.2.11/lib/action_controller/metal/implicit_render.rb:4:in `send_action'
  (gem) actionpack-3.2.11/lib/abstract_controller/base.rb:167:in `process_action'
  (gem) actionpack-3.2.11/lib/action_controller/metal/rendering.rb:10:in `process_action'
  (gem) actionpack-3.2.11/lib/abstract_controller/callbacks.rb:18:in `block in process_action'
  (gem) activesupport-3.2.11/lib/active_support/callbacks.rb:414:in `_run__330478543754893527__process_action__2034132490286778675
__callbacks' 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:08:20.617

改变

`<%= client_form.fields_for :user do |user_form| %>`

至

`<%= client_form.fields_for :users do |user_form| %>`

因为 client_form 引用了您的客户端模型和模型`has_many :users`，所以您需要确保在使用嵌套表单字段时，您将`:users`其作为符号。另外，请确保`attr_accessible :users_attributes`您的客户端模型中有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T10:12:07.463

在您的客户端模型中尝试添加此方法：
def initialize(*args)
self.users.build
end

或者

在您的控制器中添加新操作：
@user = @client.users.build

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-08T22:59:33.647

只是一个猜测，但它有助于改变其中一条或两条线吗？

```
attr_accessible :users_attributes
accepts_nested_attributes_for :users, allow_destroy: true 
```

至

```
attr_accessible :user_attributes
accepts_nested_attributes_for :user, allow_destroy: true 
```

# javascript - 是否可以轻松地将 jquery/javascript 鼠标悬停延迟添加到仅 CSS 下拉菜单？

> ID：15304445
> 
> 赞同：0
> 
> 时间：2013-03-08T22:31:28.510
> 
> 标签：javascript, jquery

是否可以使用 jquery 或 javascript 例程向纯 css 下拉菜单添加鼠标悬停延迟（以免在将鼠标移动到页面上的另一个链接位置时惹恼用户）？

我在这个网站和谷歌上搜索过的大部分材料，建议转到 jquery 或 javascript 类型的菜单。如果可能的话，我想保留一个纯 CSS 菜单，主要用于搜索引擎 SEO 目的。

我尝试在我的“div”和顶级“ul”中添加一些 jquery 超时例程，但无济于事。

代码链接：http: [//jsfiddle.net/2fc3W/1/](http://jsfiddle.net/2fc3W/1/)

我的 CSS 是：

```
<style type="text/css">
.pipe {margin-top:4px;}
.li_hover {color: #002398;}
.bottom_li {margin-bottom:6px;margin-top:2px;}
ul#nav li .bottom_li:hover > a{background:#E0E0E0;}
ul#nav, ul#nav ul {width:300px;list-style:none;margin:0;padding:0;position:absolute;z-index:9;border:1px solid #297BCE;}
ul#nav li li:hover > a{border:none;}
ul#nav li {position:relative;float:left;zoom:1; /*Needed for IE*/}
ul#nav li:hover > a{background:#E0E0E0;color:#297BCE;border-left:1px solid #297BCE;border-right:1px solid #297BCE;border-top:1px solid #E0E0E0;border-bottom:1px solid #E0E0E0;text-decoration:underline;}
ul#nav li:hover > ul{display:block;}
ul#nav li a{border:1px solid #FFFFFF;display:block;padding:4px 6px 4px 6px;color:#297BCE;font-weight:bold;font-family:Arial, Times New Roman, Tahoma;font-size:13px;text-decoration:none;}
ul#nav ul {padding-left:8px;padding-top:2px;display:none;position:absolute;width:150px;border:1px solid #297BCE;background:#E0E0E0;left:0;border-top:none;}
ul#nav ul li{background:#E0E0E0;color:#000;border:none;float:none;}
ul#nav ul li a{border:none;width:100%;padding:0;display:block;color:#000000;line-height:145%;font-size:12px;font-weight:normal;} 
ul#nav ul li a:hover{border:none;width:150px;color:#297BCE;>}
ul#nav ul ul{position: absolute;top: 0;left: 100%;margin-left:-3px;display: none;}
ul#nav ul ul{padding-left:8px;position:absolute;width:150px;border:1px solid #297BCE;background:#E0E0E0;}
ul#nav ul li:hover ul{display: block;}
</style> 
```

我的 HTML 是：

```
<div id="menubar">
<ul id="nav">
 <li><a href="/ueber_uns.htm">About Us</a>
  <ul>
    <li><a href="#">Who We Are</a></li>
    <li><a href="#">Our Goals</a></li>
    <li><a href="#">Our Team</a></li>
    <li><a href="#">Press</a>
     <ul>
      <li><a href="#">2006</a></li>
      <li><a href="#">2007</a></li>
      <li><a href="#">2008</a></li>
     </ul>
    </li>
   <li><a href="#">Impressum</a></li>
   <li class="bottom_li"><a href="#"><span class="li_hover">See all</span></a></li>
  </ul>
 </li>
<li class="pipe">|</li>
 <li><a href="/ueber_uns.htm">About Us</a>
  <ul>
    <li><a href="#">Who We Are</a></li>
    <li><a href="#">Our Goals</a></li>
    <li><a href="#">Our Team</a></li>
    <li><a href="#">Press</a>
     <ul>
      <li><a href="#">2006</a></li>
      <li><a href="#">2007</a></li>
      <li><a href="#">2008</a></li>
     </ul>
    </li>
   <li><a href="#">Impressum</a></li>
   <li class="bottom_li"><a href="#"><span class="li_hover">See all</span></a></li>
  </ul>
 </li>
<li class="pipe">|</li>
 <li><a href="/ueber_uns.htm">About Us</a>
  <ul>
    <li><a href="#">Who We Are</a></li>
    <li><a href="#">Our Goals</a></li>
    <li><a href="#">Our Team</a></li>
    <li><a href="#">Press</a>
     <ul>
      <li><a href="#">2006</a></li>
      <li><a href="#">2007</a></li>
      <li><a href="#">2008</a></li>
     </ul>
    </li>
   <li><a href="#">Impressum</a></li>
   <li class="bottom_li"><a href="#"><span class="li_hover">See all</span></a></li>
  </ul>
 </li>
</ul>
</div> 
```

感谢您提供指导我正确方向的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:55:15.133

这是 JavaScript/jQuery 版本：http: [//jsfiddle.net/tjfogarty/2fc3W/3/](http://jsfiddle.net/tjfogarty/2fc3W/3/)

和 CSS 版本：http: [//jsfiddle.net/tjfogarty/2fc3W/4/](http://jsfiddle.net/tjfogarty/2fc3W/4/)

请注意，我只是为动画使用了 -webkit- 供应商前缀。同样，您必须注意 CSS 动画的浏览器兼容性。

```
-webkit-animation: showNav 0.4s forwards;
-webkit-animation-delay: 0.5s; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:57:13.013

可以不使用 jQuery 或 Javascript，但您必须使用 CSS3（或特定于浏览器的类似 css3 的规则，例如 -webkit、-ms 等）。有一个网站可以从 gui 构建您自己的此类菜单。我还没有使用它（甚至还没有下载它），但他们的演示不久前让我大吃一惊：

[http://css3menu.com](http://css3menu.com)

其实现在很多网站：

[https://www.google.com/search?q=css3+menu](https://www.google.com/search?q=css3+menu)

# javascript - 声明对象时访问属性？

> ID：15304446
> 
> 赞同：1
> 
> 时间：2013-03-08T22:31:30.543
> 
> 标签：javascript, object

我正在尝试从当前值的父级访问一个值，但没有成功。我有这 2 个示例 javascript 代码来演示我的问题：

* * *

**1)**

```
var x = {
    y : {
        a : "a",
        ab : this.a + "b"
    }
}; 
```

控制台.log(xy);

```
> Object {
    a : a,
    ab : undefinedb
} 
```

* * *

**2)**

```
var x = {
    y : {
        a : "a",
        ab : x.y.a + "b"
    }
};

console.log(x.y); // Uncaught TypeError: Cannot read property 'y' of undefined 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:36:36.240

使用文字时，您不能在定义这些变量的语句执行之前。

一种好方法是：

```
var x = {};

x.a = 'hey';

x.b = x.a + ' how you doing?';

alert(x.b); 
```

或者更简洁：

```
var x = {
    a: 'hey'
};

x.b = x.a + ' how you doing?';

alert(x.b); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:38:02.373

`x.y`并且`this`在这一点上是未定义的`undefined`。我的意思是，当您创建一个匿名对象时，它直到关闭才真正存在`}`。

因此，实现您想要的另一种方法是：

```
var x = {
     y : {a : "a"}
}

x.y.ab = x.y.a + "b" 
```

这样，`ab`变量是在之后设置的，`x`并且`y`都已初始化，因此`x.y.a`现在已设置。

如果您真的想在初始化期间设置 xyab，那么您需要使用函数和闭包更正式地进行设置。类似于以下内容。

```
var x = function(){
  this.a = 'foo';
  this.b = this.a + ' bar';
}() // Immediate function call so I don't have to create it.

console.log(x.b); // logs 'foo bar' 
```

# bash - 在 aws ec2 上播放框架 - HTTP 端口设置

> ID：15304448
> 
> 赞同：0
> 
> 时间：2013-03-08T22:31:43.150
> 
> 标签：bash, amazon-web-services, amazon-ec2, playframework-2.0

几天来，我一直在尝试在 aws ec2 上启动一个文档记录不佳的游戏应用程序（帮助朋友），作为一个完整的游戏和 bash-rookie，最终设法启动它；但不像在声明的 playShop.sh 文件中那样监听端口 8080，而是在随机端口 (8081) 上监听，因为 8080 引发了“已在使用”-异常。

playShop.sh（更改了端口）：

> sudo nohup ./start -Dconfig.file=/home/ec2-user/prod.conf -Dhttp.port=8081 -Dhttp.address=127.0.0.1 &

开始

> # !/usr/bin/env sh
> 
> 执行 java $* -cp " `dirname $0`/lib/*" play.core.server.NettyServer`dirname $0`

到目前为止，一切都很好！但是我现在如何通过网络浏览器访问它？当我调用公共 DNS 时，我会进入一个标准的欢迎页面。我尝试在该端口上设置安全组设置（quicklaunch1-->inbound）并使用负载均衡器-->侦听器，但没有任何帮助。

这似乎是漫长旅程的最后一步，欢迎任何帮助！谢谢。

编辑：这是 nohup.out 在这两个端口上登录的内容：

```
 Play server process ID is 1593
[[37minfo[0m] play - Application started (Prod)
Oops, cannot start the server.
org.jboss.netty.channel.ChannelException: Failed to bind to: /127.0.0.1:8080
    at org.jboss.netty.bootstrap.ServerBootstrap.bind(ServerBootstrap.java:298)
    at play.core.server.NettyServer.<init>(NettyServer.scala:63)
    at play.core.server.NettyServer$.createServer(NettyServer.scala:132)
    at play.core.server.NettyServer$$anonfun$main$5.apply(NettyServer.scala:162)
    at play.core.server.NettyServer$$anonfun$main$5.apply(NettyServer.scala:161)
    at scala.Option.map(Option.scala:133)
    at play.core.server.NettyServer$.main(NettyServer.scala:161)
    at play.core.server.NettyServer.main(NettyServer.scala)
Caused by: java.net.BindException: Address already in use
    at sun.nio.ch.Net.bind(Native Method)
    at sun.nio.ch.ServerSocketChannelImpl.bind(ServerSocketChannelImpl.java:137)
    at sun.nio.ch.ServerSocketAdaptor.bind(ServerSocketAdaptor.java:77)
    at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.bind(NioServerSocketPipelineSink.java:138)
    at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.handleServerSocket(NioServerSocketPipelineSink.java:90)
    at org.jboss.netty.channel.socket.nio.NioServerSocketPipelineSink.eventSunk(NioServerSocketPipelineSink.java:64)
    at org.jboss.netty.channel.Channels.bind(Channels.java:569)
    at org.jboss.netty.channel.AbstractChannel.bind(AbstractChannel.java:187)
    at org.jboss.netty.bootstrap.ServerBootstrap$Binder.channelOpen(ServerBootstrap.java:343)
    at org.jboss.netty.channel.Channels.fireChannelOpen(Channels.java:170)
    at org.jboss.netty.channel.socket.nio.NioServerSocketChannel.<init>(NioServerSocketChannel.java:80)
    at org.jboss.netty.channel.socket.nio.NioServerSocketChannelFactory.newChannel(NioServerSocketChannelFactory.java:158)
    at org.jboss.netty.channel.socket.nio.NioServerSocketChannelFactory.newChannel(NioServerSocketChannelFactory.java:86)
    at org.jboss.netty.bootstrap.ServerBootstrap.bind(ServerBootstrap.java:277)
    ... 7 more
Play server process ID is 1650
[[37minfo[0m] play - Application started (Prod)
[[37minfo[0m] play - Listening for HTTP on port 8081.. 
```

.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:25:15.533

> 到目前为止，一切都很好！但是我现在如何通过网络浏览器访问它？当我调用公共 DNS 时，我会进入一个标准的欢迎页面。我尝试在该端口上设置安全组设置（quicklaunch1-->inbound）并使用负载均衡器-->侦听器，但没有任何帮助。

当您使用 Web 浏览器访问域名时，默认情况下它会尝试连接到端口 80。要解决此问题，您必须像这样访问它：

```
http://myserver.com:8081/ 
```

这对用户来说很难。为了解决这个问题，推荐的方法是使用代理服务器来处理来自客户端的标准请求，该客户端侦听端口 80 并根据需要将请求转发到应用程序服务器（播放服务器）。我通常为此推荐 nginx，play 框架主页有一个[基本的设置指南](http://www.playframework.com/documentation/2.1.0/HTTPServer)。在您的情况下，它将类似于：

```
http {

  proxy_buffering    off;
  proxy_set_header   X-Real-IP $remote_addr;
  proxy_set_header   X-Scheme $scheme;
  proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header   Host $http_host;

  upstream my-backend {
    server 127.0.0.1:8081;
  }

  server {
    server_name www.mysite.com mysite.com;
    rewrite ^(.*) https://www.mysite.com$1 permanent;
  }

  server {
    listen               443;
    ssl                  on;
    ssl_certificate      /etc/ssl/certs/my_ssl.crt;
    ssl_certificate_key  /etc/ssl/private/my_ssl.key;
    keepalive_timeout    70;
    server_name www.mysite.com;
    location / {
      proxy_pass  http://my-backend;
    }
  }
} 
```

# jquery - getscript 可以在 jquery noconflict 中运行导入的脚本吗？

> ID：15304450
> 
> 赞同：4
> 
> 时间：2013-03-08T22:31:45.000
> 
> 标签：jquery, jquery-plugins, getscript

假设我正在运行一个没有冲突的 jQuery 版本，如下所示：

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script type="text/javascript">var jQuery191 = $.noConflict(true);</script> 
```

我有一个外部 .js 文件，它应该使用无冲突版本运行，并在脚本底部`jQuery191`包含 jQuery 对象。`(jQuery)`

如果我包含 .js 文件`getScript()`并使用无冲突的 jQuery 对象运行它：

```
(function (jQuery) {
    $.getScript("js.js");
})(window.jQuery191) 
```

脚本将与原始脚本一起运行`jQuery191`还是与原始脚本一起运行`jQuery`？或者这个逻辑只是愚蠢的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:36:22.537

`getScript`只会加载脚本并将其添加到页面中，它根本不会影响脚本的行为。如果脚本通过它的全局名称访问 jQuery，那么它将找不到它（由于`noConflict`被调用），并且将无法正确运行。

如果可以的话，我建议在调用**之前**`noConflict`包含脚本，否则你将不得不修改脚本以在你放置它的地方寻找 jQuery ( `jQuery191`)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:35:46.263

在您的包装器 ( `(function() { ... })()`) 中，您将变量定义为全局范围内`jQuery`的变量副本。`jQuery191`

这意味着`$.getScript`不使用该变量，但调用`jQuery.getScript`有效。因为它是一个匿名函数，`$`所以包装器内部现在引用外部`$`变量（在这种情况下，`$`是全局对象中的）。您可以通过将包装器的第一个参数重命名为`$`：

```
(function ($) {
    $.getScript('foo.js');
})(window.jQuery191); 
```

或者通过在你的包装器中添加这个：

```
var $ = jQuery 
```

现在，两者都`$`包含全局范围`jQuery`的变量的副本。`jQuery191`

# backbone.js - Backbone.js - 路由器、视图渲染和一般概念化

> ID：15304458
> 
> 赞同：5
> 
> 时间：2013-03-08T22:32:17.873
> 
> 标签：backbone.js

我已经阅读了相当多的介绍性教程阅读（包括绝对初学者、[完全学习](http://javascriptissexy.com/learn-backbone-js-completely/)，以及 2 个 Code School Backbone 课程的大部分内容），我完全可以看到 Backbone 提供的潜力。但是理解的灯泡还没有完全打开......我认为绝大多数简单的待办事项应用程序的例子使它看起来比在处理更复杂的项目时更微不足道。

我的实验已经达到一定程度——但我认为现在获得关于以下一系列零散问题的答案或反馈可能会为我节省很多挫折感，并使我在学习曲线上向我想要的方向前进。我已尝试为具有详细性质的示例包含相关片段。

1）**路由器很棒，但是/不是任何繁重的地方吗？**

以下路由器用于将用户从初始页面加载移动到特定路由（搜索），该路由在最后一个加载的 js 中实例化其 SearchBoxView，类似于 TodoMVC 示例中的 app.js。但是，尝试在路由器中设置视图，如 SummaryResultsView 所示会生成“不是构造函数”错误。

```
var Workspace = Backbone.Router.extend({
    routes: {
        '': 'default',
        'search': 'searchBox',
        'summary': 'summary',
        'detail': 'detail',
    },

    default: function() {
        console.log("Router: Default");
        track.Router.navigate("#search", { 
            trigger: true,
            replace: true
        });
    },

    searchBox: function () {
        console.log("Router: Search");
    },

    summary: function () {
        console.log("Router: Summary");
        new track.SummaryResultsView({ el: $("#summary #results")});
    }, 
```

我*刚刚*发现[https://github.com/thomasdavis/backbonetutorials/blob/gh-pages/examples/modular-backbone/js/router.js](https://github.com/thomasdavis/backbonetutorials/blob/gh-pages/examples/modular-backbone/js/router.js)这似乎让路由器初始化的行为与我期望的类似. 接下来会尝试这种方法。

2)**您是否需要在渲染中构建大量状态逻辑的主页视图？**

我对上述路由器的目标是，每条路由都会有许多视图，这些视图会根据集合中的结果显示/隐藏或更改它们的呈现方式。设置在状态变化时呈现哪些视图似乎是个好地方。TodoMVC 示例的 app.js 视图渲染函数执行了很多等效逻辑。

3)**没有 require.js 的外部文件中的下划线模板**

我很确定我最终会包含 require.js - 但为了简化学习曲线的一部分，我想在没有它的情况下开始。同样 b/c 模板将从单独的 CMS 中提取字段标题，并且（还）不确定它与 AMD 的配合会有多好。

4）**它可以帮助减少插件依赖，如颜色框和数据表吗？**

我正在使用 Backbone 进行的概念验证项目之一是一个中等大小的应用程序，它有相当多的显式编写的演示代码以与这些 jQuery 插件一起使用。这不是坏话，但似乎在骨干结构中编写类似的功能会更易于维护或至少易于理解它在做什么。请注意，我在旅行中发现了主干表排序器（帖子链接外），并且（还）无法判断它是否会导致或多或少紧密耦合的代码 wrt 插件。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T22:59:11.500

### 路由器

当然它们可以用于繁重的工作——我相信你以前听说过，但是 Backbone 只是提供了你选择的基础架构。

我会将 设置为路由器`SummaryResultsView`上的变量。`Workspace`否则，无论何时打电话`Workspace.summary()`，您都会看到鬼影。

我不确定您在做什么，`track.Router.navigate`因为它看起来与`#search`您的路由器中定义的路由共享相同的路由`Workspace`，这将导致两个路由都被调用。

您总是可以创建多个路由器来帮助您在应用程序的不同部分之间划分代码。从主路由器开始并拥有子路由器通常是我尝试和瞄准的目标。

### 主页浏览量

同样，有些人喜欢这样做，而另一些人喜欢从路由器开始。如果你发现你有一个巨大的主视图，试着把它分成更小的视图，这样你就不会重复自己。

缓存视图可能很有用 - 所以在一个只创建一次的主视图上（在你的应用程序启动时）你可以这样做：

```
var MyView = Backbone.View.extend({
    childView: null,

    toggleChildView: function() {
        if (this.childView) {
          this.childView.toggle(); //Toggle show/hide
        } else {
          this.childView = new ChildView({model: someModel});
        }
    }
}); 
```

### 下划线模板

我实际上发现使用 require.js 帮助我学习。当应用程序开始变大时，它肯定会有所帮助——TodoMVC 应用程序有一个 require.js 实现——如果你还不知道的话。

如果没有 require.js（文本插件），您将无法使用外部模板，因为它使用 AJAX 调用来获取模板文件。当然，除非您设计自己的 AJAX 调用来拉入模板文件，但这似乎是一种相当冗长的方法。

模板文件是静态的 - 我不完全理解您的意思是从单独的 CMS 中提取？

只是附带说明 - 如果您使用[require.js 优化](http://requirejs.org/docs/optimization.html)，它实际上内联您的模板，因此它们包含在一个胖 JS 文件中。

### 移植代码

如果你找到了一个非常通用的 Backbone 模型，它可以与 jQuery 插件一起使用（我有一个用于 jQuery UI 日期选择器的模型），你可以很容易地在应用程序之间移植它，而不必大惊小怪。如果使用 require.js 作为它已经在一个单独的文件中（复制和粘贴 FTW），这会加快速度。

希望这可以帮助！

# php - 使用 php 为 SQL 表生成格式正确的日期

> ID：15304461
> 
> 赞同：0
> 
> 时间：2013-03-08T22:32:32.300
> 
> 标签：php, sql, date, format

我正在尝试使用 php 脚本将日期插入 SQL 表中。我正在使用以下代码在 php 中生成日期：

```
Date("l F d, Y"); 
```

如果我在我的 SQL 表中将“dat”列格式的格式设置为字符串，则正确输入日期但是如果我将列格式设置为日期，则日期显示为

```
0000-00-00 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:40:00.553

DATE 和与日期相关的数据类型将日期值存储在内部结构中。您输入的日期值的格式不会保留。保存为字符串数据类型时，它只是一个字符串。没有保存日期知识。

当您从 DATE 列中选择数据时，显示的默认格式是`0000-00-00`. 您可以在选择数据时格式化值（技术取决于 DBMS）。

# ruby-on-rails - 以 JSON 格式的 Rails 验证消息，用于 accept_nested_attributes_for 模型

> ID：15304462
> 
> 赞同：1
> 
> 时间：2013-03-08T22:32:35.047
> 
> 标签：ruby-on-rails, json, validation, activemodel

我有一个 Mongoid 模型，它有几个嵌套的子模型和集合。`accepts_nested_attributes_for`我使用 Rails功能从我的控制器为这些模型设置属性。

当父模型验证失败时，`#errors`仅包含来自父模型的错误消息，不包含任何子模型。

这通常不是问题，因为当使用常规 Rails 表单助手重新呈现表单时，通常会读取每个嵌套模型的错误消息。但是，我希望一个`JSON`对象中的所有错误都由 Backbone 应用程序使用。

目前，我正在遍历所有嵌套模型并手动将所有错误集合组合在一起，这很乏味，但很有效。

我错过了什么吗？有没有更简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-18T13:11:40.547

我在使用带有rails的Angular.js时遇到了同样的问题......我认为没有更好的方法来解决这个问题而不迭代嵌套模型中的所有错误。这个猴子补丁是我目前的解决方案，只适用于一对一的关系：

```
module ActionController
  class Responder
    def json_resource_errors
      def get_error_recursively_from(res)
        Hash[res.errors.map do |key, value|
          if res.send(key).is_a? Mongoid::Relations
            result = get_error_recursively(res.send(key))
          else
            result = value
          end
          [key, result]
        end]
      end

      { :errors => get_error_recursively_from(resource) }
    end
  end
end 
```

# php - 可以在 PHP 中执行条件 301 吗？

> ID：15304467
> 
> 赞同：1
> 
> 时间：2013-03-08T22:33:05.247
> 
> 标签：php, redirect, conditional-statements

我实际上不确定从哪里开始。

基本上我有一个搜索引擎优化的伙伴，他的一个客户网站已被某个网络托管服务复制，尽管将其关闭，但该副本并未被删除。有问题的预览站点的 PR 比实际的客户端站点更高，因此 SEO 被完全破坏。

我们设法克服这种情况的唯一控制是文件（但不是 .htaccess）正在从客户端的服务器传播。基本上，这是一场可怕的噩梦。

我打算做的是在 PHP 头文件中设置条件重定向，这样如果浏览器/引擎点击预览站点，它将 301 到客户端站点。然而，如果浏览器/引擎访问了正确的站点，我们什么都不用做。

虽然我可能可以通过反复试验找出语法，但这有点时间敏感，因为有问题的客户有一个直接进入 Hades 的 SEO 活动。

我希望这里有人知道如何格式化条件重定向。

让我们称这两个域：

previewdomain.com domain.com

这么客气的说...

```
if current url == previewdomain.com then 301 redirect to domain.com
else do nothing 
```

感谢您的协助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:35:10.350

这会做：

```
if( stripos($_SERVER['HTTP_HOST'],"previewdomain.com") !== false) {
    header("Location: http://domain.com".$_SERVER['REQUEST_URI'],true,301);
    exit;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:36:17.597

```
<?php
if(strpos($_SERVER['HTTP_HOST'], 'previewdomain.com') !== FALSE) {
    header("HTTP/1.1 301 Moved Permanently");
    header("Location: http://www.domain.com"); 
} 
```

# java - 我需要比较纬度和经度坐标，这将告诉 GPS 用户哪个 Hooters 餐厅离他当前的位置最近

> ID：15304468
> 
> 赞同：6
> 
> 时间：2013-03-08T22:33:08.460
> 
> 标签：java, android

我已经完成了为威斯康星州的所有 6 家 Hooters 餐厅位置找到准确的纬度/经度（以十进制数字表示）坐标的准备工作。我打算将这些坐标值存储在一个单独类的数组中。我的代码中也已经有一个位置监听器来获取用户当前的 GPS 位置。请参阅下面的代码：

```
package sam.finalmap.hooters;

// Camera is the view of the map.

import com.google.android.gms.maps.CameraUpdateFactory;
// the google map
import com.google.android.gms.maps.GoogleMap;

import android.app.Activity;
import android.content.Context;

import android.graphics.Color; // for drawing a line.

import android.location.Location; // for detecting location changes with the GPS.
import android.location.LocationListener; // to listen for location changes
import android.location.LocationManager;
import android.os.Bundle;

import android.util.Log;
import android.widget.TextView;
import android.widget.Toast;

import com.google.android.gms.maps.MapFragment;  // the Map class.
import com.google.android.gms.maps.model.LatLng; // for creating lattitudes and longitutes in memory.
import com.google.android.gms.maps.model.Polyline; // used to draw from one location to the other
import com.google.android.gms.maps.model.PolylineOptions;

/**
 * Draws a map, uses GPS to get the current location, the draws a line from Eau CLaire (see constants)
 * to the new position, which will be the closest Hooters restaurant to the user's current location. 
 * This is the AdapterView.
 * 
 * @author daviddalsveen
 *
 */
public class GMapsLocationPath extends Activity implements LocationListener {
    /** Called when the activity is first created. */

    private GoogleMap mMap;

    // constants to hard code all 6 of Wisconsin's Hooters restaurant points on the map:

    private static final float Appleton_LAT = 44.2655012f;

    private static final float Appleton_LNG = -88.4768057f;

    private static final float Brookfield_LAT = 43.03645f;

    private static final float Brookfield_LNG = -88.124937f;

    private static final float EastMadison_LAT = 43.132432f;

    private static final float EastMadison_LNG = -89.3016256f;

    private static final float GreenBay_LAT = 44.477903f;

    private static final float GreenBay_LNG = -88.067014f;

    private static final float Janesville_LAT = 42.7215666f;

    private static final float Janesville_LNG = -88.9889661f;

    private static final float LaCrosse_LAT = 43.8109318f;

    private static final float LaCrosse_LNG = -91.2536215f;

    private LocationManager locationManager;

    private TextView tv;   // a Textview for displaying lattitude and longitude.

    private float curLat = 44.88f; // current position -- assigned constants for
                                    // testing...
    private float curLng = -91.47f;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // called when the activity is first started.

        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        // recommended method by google to make the map object.
        setUpMapIfNeeded();

        // Sets the map type to be "normal"
        mMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);

        tv = (TextView) findViewById(R.id.label1);

        locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER,
                500, 1, this);
        Location location = locationManager
                .getLastKnownLocation(LocationManager.GPS_PROVIDER);
        // 500 is the minimum time interval to update, in milliseconds
        // 1 is the distance in meters in which to sense an update.
        // 'this' is the pending intent.

        // center latitude and longitude for EC
        float lat = Appleton_LAT;
        float lng = Appleton_LNG;

        // debug example...
        Toast.makeText(this, "" + (int) (lat * 1E6), Toast.LENGTH_LONG).show();

        if (location == null) { // no last known location
            locationManager.requestSingleUpdate(LocationManager.GPS_PROVIDER,
                    this, null);
            // Create a new Lattitude Longitude Object, passing it the
            // coordinates.
            LatLng latLng = new LatLng(lat, lng);

            mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(latLng, 10.0f));
            // re-draw

        } else {
            // explicitly call and update view with last known location or the
            // one set above.
            onLocationChanged(location);
        }

    }

    /**
     * Checks to see that the map exists, if not, creates one.
     */
    private void setUpMapIfNeeded() {
        // Do a null check to confirm that we have not already instantiated the
        // map.
        if (mMap == null) {
            mMap = ((MapFragment) getFragmentManager().findFragmentById(
                    R.id.map)).getMap();
            // Check if we were successful in obtaining the map.
            if (mMap != null) {
                // The Map is verified. It is now safe to manipulate the map.

            }// else?
        }
    }

    // Java Interface RULE NOTE: that we must implement every method of
    // interface LocationListener,
    // whether we use the method or not.
    /**
     * Use the GPS to get the current location of the user
     * 
     */
    public void onLocationChanged(final Location loc) {

        String lat = String.valueOf(loc.getLatitude());
        String lon = String.valueOf(loc.getLongitude());
        Log.e("GPS", "location changed: lat=" + lat + ", lon=" + lon);
        tv.setText("lat=" + lat + ", lon=" + lon);

        curLat = Float.parseFloat(lat); // update the current lattitude and longitude.
        curLng = Float.parseFloat(lon);

        // Create a new Lattitude Longitude Object, passing it the coordinates.
        LatLng latLng = new LatLng(curLat, curLng);

        mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(latLng, 10.0f));
        // re-draw
        draw();

    }

    public void onProviderDisabled(String loc) {
        Log.e("GPS", "provider disabled " + loc);
    }

    public void onProviderEnabled(String loc) {
        Log.e("GPS", "provider enabled " + loc);
    }

    /**
     * loc: name of location provider status: status of location provider
     * (temporarily unavailable, etc) extras: optional bundle with additional
     * status information
     */
    public void onStatusChanged(String loc, int status, Bundle extras) {
        Log.e("GPS", "status changed to " + loc + " [" + status + "]");
    }

    /**
     * Draw a line from 
     */
    public void draw() {

        float lat = 44.88f;
        float lng = -91.48f;

        // Instantiates a new Polyline object and adds points to define a
        // endpoints of a line
        PolylineOptions rectOptions = new PolylineOptions().add(
                new LatLng(curLat, curLng))

                .add(new LatLng(lat, lng)); // Closes the polyline.

        // Set the rectangle's color to red
        rectOptions.color(Color.RED);

        // Get back the mutable Polyline
        Polyline polyline = mMap.addPolyline(rectOptions);      

    }   

} 
```

我在这里需要帮助的是找到一种方法来解析数组，并将用户位置的差异与 6 个餐厅位置中的每一个进行比较，并且哪个差异最小（离用户最近的餐厅位置）就是餐厅将被选中并显示谁的信息。

也就是说，在它完成对数组的解析并获得所有 6 个纬度/经度差异后，我如何告诉它使用最小的差异？

```
/**
     * My teacher suggested subtracting the current latitudes and longitudes from the restaurant latitudes and 
     * longitudes to see if they fall within a certain range (lets just say less than 10). Then, using the resulting 
     * differences as absolute values in an if statement (if absolute value < 10 for both are true), that restaurant
     * would be the one selected:  
     */

    //float[] H_Latitude = {44.2655012f, 43.03645f, 43.132432f, 44.477903f, 42.7215666f, 43.8109318f};  

    //float[] H_Longitude = {-88.4768057f, -88.124937f, -89.3016256f, -88.067014f, -88.9889661f, -91.2536215f};

    float LATdifference = curLat - H_Latitude; 

    float LNGdifference = curLng - H_Longitude;//I'm pretty sure I can't use "H_Longitude and H_Latitude", because
    //they're merely the name of the array. So how do I access the elements inside of them? How do I successfully
    //address them with a reference variable that I can use to dynamically subtract from curLat and curLng and get
    //what I need to replace the "i" in the for loops:
                                            for (float LATdifference = 0; i < 4; i++) {
                                                System.out.println (count[i]);
                                                  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:36:44.057

试试 Location.distanceBetween():[参考](http://developer.android.com/reference/android/location/Location.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:39:33.347

您可以将 GPS 坐标输入 Google Directions API 并使用行驶距离来确定最近的商店。

Android Location 类有一个 distanceTo 或 distanceBetween 方法，可用于获取 2 个 GPS 点之间的直线距离。您可以使用它来将其缩小到 2-3 个候选人，然后使用方向 api 来获得最终答案。

# iphone - 当手机设置为静音时会播放 NSLocalNotification 声音吗？

> ID：15304472
> 
> 赞同：0
> 
> 时间：2013-03-08T22:33:18.600
> 
> 标签：iphone, objective-c, audio, nsnotifications, silent

当铃声开关设置为 时，是否可以`NSLocalNotification`播放音频文件`OFF`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T03:54:14.173

不 `NSLocalNotification`，必须遵守设备的真实世界设置。

# android - 为片段设置背景？

> ID：15304481
> 
> 赞同：0
> 
> 时间：2013-03-08T22:33:54.517
> 
> 标签：android, android-layout, android-fragments

我在我的应用程序中使用片段，我必须更改 FragmnetTabs 中片段之一的背景。出于这个原因，我正在设置该`background`片段的布局，我可以看到`Graphical Layout`它`Eclipse`工作正常。但是当我运行我的应用程序时，它会显示黑色背景的片段内容，而不是我设置的图像。我是这样设置的...

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="fill_parent"
     android:layout_height="fill_parent"
     android:background="@drawable/bg" >
<RelativeLayout/> 
```

但是这个 drwaable 并没有出现在应用程序中。可能是什么问题呢？任何帮助表示赞赏。谢谢！

**编辑：**

如果我尝试按以下方式设置背景，它工作正常。

```
 android:background="@drawable:color/anycolor" 
```

为什么自定义图像没有显示但android颜色显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-20T09:22:17.860

您可以尝试在代码中执行此操作。打电话给你`RelativeLayout`

`yourRelativeLayout.setBackground(getActivity().getResources().getDrawable(R.drawable.YourImage));`

# ruby - 为什么 instance_eval 在 Proc 上成功但在 Lambda 上不成功？

> ID：15304485
> 
> 赞同：11
> 
> 时间：2013-03-08T22:34:21.627
> 
> 标签：ruby

我有以下课程：

```
class User
  code1 = Proc.new { }
  code2 = lambda { }

  define_method :test do
    self.class.instance_eval &code1
    self.class.instance_eval &code2
  end
end

User.new.test 
```

为什么第二个`instance_eval`失败并出现`wrong number of arguments (1 for 0)`错误？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-08T22:51:59.553

`instance_eval``self`将( )屈服于`User`lambda。Lambda 对它们的参数很特别 - 与方法相同 -`ArgumentError`如果参数太少/太多，则会引发 an 。

```
class User
  code1 = Proc.new { |x| x == User } # true
  code2 = lambda { |x| x == User }   # true

  define_method :test do
    self.class.instance_eval &code1
    self.class.instance_eval &code2
  end
end 
```

相关：[Ruby 中的 proc 和 lambda 有什么区别？](https://stackoverflow.com/a/1740083/382982)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-03-31T13:31:30.887

如果您仍想使用 lambda，此代码将起作用：

```
block = lambda { "Hello" } # or -> { "Hello" }
some_obj.instance_exec(&block) 
```

`instance_exec`相反，`instance_eval`不会`self`作为给定块的参数提供，因此`wrong number of arguments (1 for 0)`不会被抛出。

[在这里](https://stackoverflow.com/a/12648344/120992)查看更多信息。

# jquery - Fancybox 2 箭头未显示

> ID：15304488
> 
> 赞同：1
> 
> 时间：2013-03-08T22:34:40.473
> 
> 标签：jquery, fancybox-2

我正在使用 fancyBox 2 来显示 iframe 内容组。我可以使用键盘上的箭头并单击内容的右侧或左侧来浏览内容，但我无法显示箭头。我什至将箭头设置为始终可见，而不仅仅是悬停，仍然没有运气。我将在某些 iframe 中包含可点击的内容，因此我需要能够关闭点击内容中任意位置进行导航的功能。该选项也会干扰滚动条。

这是我的代码

```
<!-- Add jQuery library -->
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>

<!-- Add fancyBox -->
<link rel="stylesheet" href="../../../scripts/fancybox/source/jquery.fancybox.css?v=2.1.4" type="text/css" media="screen" />
<script type="text/javascript" src="../../../scripts/fancybox/source/jquery.fancybox.pack.js?v=2.1.4"></script>

<link rel="stylesheet" href="../../../scripts/fancybox/source/helpers/jquery.fancybox-thumbs.css?v=1.0.7" type="text/css" media="screen" />
<script type="text/javascript" src="../../../scripts/fancybox/source/helpers/jquery.fancybox-thumbs.js?v=1.0.7"></script>

<script type="text/javascript">
    $(document).ready(function() {
    $(".fancybox").fancybox({
        fitToView   : false,
        autoSize    : false,
        closeClick  : false,
        openEffect  : 'none',
        closeEffect : 'none',
        showArrows  : true,
        arrows      : true,
        type        : 'iframe',
    });
});
</script> 
```

和 HTML

```
<a class="fancybox" rel="andyAdams" href="andyadams/one.html"><img src="thumbnailImages/adams1.jpg" height="150" width="150" alt="Andy Adams" /></a>

<a class="fancybox" rel="andyAdams" href="andyadams/two.html"><img src="thumbnailImages/adams2.jpg" height="150" width="150" alt="Andy Adams" /></a>

<a class="fancybox" rel="andyAdams" href="andyadams/three.html"><img src="thumbnailImages/adams3.png" height="150" width="150" alt="Andy Adams" /></a>

<a class="fancybox" rel="andyAdams" href="andyadams/four.html"><img src="thumbnailImages/adams4.jpg" height="150" width="150" alt="Andy Adams" /></a> 
```

任何帮助表示赞赏！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:02:56.643

关闭图标是否显示？箭头和关闭按钮都在`fancybox_sprite.png`. 图像精灵的文件位置（在 CSS 中用于`background-image`on和其他）很可能是不正确的。`.fancybox-close`尝试使用绝对 URL 而不是相对 URL。（`http://example.com/fancybox_sprite.png`而不是`../fancybox_sprite.png`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-05T14:55:05.893

> 我有同样的问题。我最初厌倦了将图像放在不同的文件夹（不是 css 文件夹）并使用 css url 链接它们......它没有工作......但是当我把图像放在同一个 css 文件夹中......它工作了……你应该试试……

# .htaccess - 301 重定向，来自 index.php

> ID：15304491
> 
> 赞同：0
> 
> 时间：2013-03-08T22:34:52.497
> 
> 标签：.htaccess, redirect, web

如何通过 301 重定向，从[http://mydomain.com/index.php](http://mydomain.com/index.php)到[http://mydomain.com](http://mydomain.com)或[http://mydomain.com/variable](http://mydomain.com/variable)到[http://mydomain.com](http://mydomain.com)？我试过这个，但不起作用：

```
Options +FollowSymlinks
RewriteEngine on
rewritecond %{http_host} ^http://mydomain.com/variable [nc]
rewriterule ^(.*)$ http://mydomain.com/$1 [r=301,nc] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:55:00.023

尝试：

```
RedirectMatch 301 ^/index.php$ /
RedirectMatch 301 ^/variable$ / 
```

# php - 如何使用 PHP 对二维数组进行排序？

> ID：15304492
> 
> 赞同：0
> 
> 时间：2013-03-08T22:34:52.610
> 
> 标签：php, sorting

我想按“名称”对下面的数组进行排序。我已经尝试了几件事，但我无法弄清楚。有什么建议么？

```
$data = array();
$data[] = array('name'=>'Bill','phone'=>'555-5555');
$data[] = array('name'=>'Joe','phone'=>'555-5554');
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:37:47.257

您可以使用`usort()`自定义标准对数组进行排序。

例如：

```
function my_sort_by_name($a, $b) {
    return strcmp($a['name'], $b['name']);
}

$data = array();
$data[] = array('name'=>'Bill','phone'=>'555-5555');
$data[] = array('name'=>'Joe','phone'=>'555-5554');
usort($data, 'my_sort_by_name'); 
```

# c# - FindAll 具有不同相关性的条件

> ID：15304494
> 
> 赞同：3
> 
> 时间：2013-03-08T22:35:03.487
> 
> 标签：c#

关于作业：有施法者（女巫（0）/仙女（1）），他们有法术（智力）。我将它们存储在一个列表中。

我要找到两种类型中最好的。（可以有多个具有相同法术强度的施法者）我想出了这个代码，但是有一个问题。如果法术强度最高的施法者是 1，那么第一个 FindAll 将不会返回任何内容，因为它试图找到类型为 0 且法术强度最高的施法者。如果总法术强度最高的施法者是类型 1，我如何获得包含法术强度最高的类型 0 施法者的列表？

```
private List<Caster> BestCasters()
    {
        List<Caster> temp = new List<Caster>();
        temp = casters.FindAll(x => x.SpellPower == casters.Max(y => y.SpellPower) && (x.TypeOfCaster == 0));
        temp.AddRange(casters.FindAll(x => x.SpellPower == casters.Max(y => y.SpellPower) && (x.TypeOfCaster == 1))); 
        temp.OrderBy(x => x.TypeOfCaster).ThenBy(y => y.CasterName);
        return temp;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:54:47.697

LINQ`GroupBy`行为非常适合：

```
var strongest_casters = casters.GroupBy(c => c.TypeOfCaster)
                               .Select(grp => grp.OrderByDescending(x => x.SpellPower)
                                                 .First()
                                      ); 
```

或者返回一个以上的每种类型：

```
var strongest_casters = casters.GroupBy(c => c.TypeOfCaster)
                               .SelectMany(grp => grp.Where(y.SpellPower == grp.Max(x => x.SpellPower))
                                          ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:43:19.083

```
private List<Caster> BestCasters()
{
    var witches = casters.Where(x => x.TypeOfCaster == 0).ToList();
    var fairies = casters.Where(x => x.TypeOfCaster == 1).ToList();

    int witchesMax = witches.Max(x => x.SpellPower);
    int fairiesMax = fairies.Max(x => x.SpellPower);

    var temp = witches.Where(x => x.SpellPower == witchesMax).ToList();
    temp.AddRange(fairies.Where(x => x.SpellPower == fairiesMax)); 

    return temp.OrderBy(x => x.TypeOfCaster).ThenBy(y => y.CasterName).ToList();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T22:47:19.740

如果您必须像这样使用 FindAll，您应该在仅包含正确类型的脚轮的子集上调用 Max。当然，首先拆分初始列表，然后获取每种最强的施法者会更有意义。既然你没有告诉你到底要做什么，我只能希望你被允许分裂:-)

# ruby-on-rails - 通过 LAN 上的 Rails 访问设备

> ID：15304496
> 
> 赞同：0
> 
> 时间：2013-03-08T22:35:15.027
> 
> 标签：ruby-on-rails, ruby, ip, lan, plc

我试图访问的设备是带有内置 Web 服务器的 PLC。我正在尝试通过 PLC 的唯一 IP 地址提取数据。我有一台运行 Rails 应用程序的计算机，它位于与 PLC 相同的局域网内。如果计算机仍在网络内，我可以通过 Rails 应用程序访问设备 IP 吗？我不确定请求是如何工作的。Rails 会直接移动到 ISP 并以这种方式搜索，还是会先扫描本地网络？

# php - 将数据传递到 Highcharts 时遇到问题

> ID：15304497
> 
> 赞同：0
> 
> 时间：2013-03-08T22:35:22.233
> 
> 标签：php, highcharts, highstock

我正在尝试从 CSV 中提取多家公司的金融股票数据，并将数据显示为 Highcharts/Highstocks 折线图中的单独系列。我已经设置了源，并且能够提取数据 + 转换为 JSON，但是我无法将数据传递给 Highcharts。我相信我没有使用最有效的方法来准备 Highcharts 使用的数据，我希望有人可以指导我做错了什么。请查看我的代码，让我了解您看到的任何低效率或明显错误。

PHP代码：

```
date_default_timezone_set('America/Los_Angeles');

$stocks = array('MSFT' => 'http://ichart.finance.yahoo.com/table.csv?s=MSFT', 'AAPL' => 'http://ichart.finance.yahoo.com/table.csv?s=AAPL', 'FB' => 'http://ichart.finance.yahoo.com/table.csv?s=FB');
$stocks_data = array();

foreach ($stocks as $key=>$stock) {
    $fh = fopen($stock, 'r');
    $header = fgetcsv($fh);

    $varname = $key . '_data';

    $$varname  = array();
    while ($line = fgetcsv($fh)) {
        ${$varname}[count($$varname)] = array_combine($header, $line);
    }

    fclose($fh);
}

foreach($MSFT_data as $val){
    $MSFT[]   = strtotime($val['Date']) * 1000 . ', ' . (float)$val['Close']; //sets the date as a javascript timestamp
}
$MSFT = json_encode($MSFT);

foreach($AAPL_data as $val){
    $AAPL[]   = strtotime($val['Date']) * 1000 . ', ' . (float)$val['Close']; //sets the date as a javascript timestamp
}
$AAPL = json_encode($AAPL);

foreach($FB_data as $val){
    $FB[]   = strtotime($val['Date']) * 1000 . ', ' . (float)$val['Close']; //sets the date as a javascript timestamp
}
$FB = json_encode($FB); 
```

JS代码：

```
$(function () {
    var seriesOptions = [],
        yAxisOptions = [],
        colors = Highcharts.getOptions().colors;

    seriesOptions[0] = {
        name: 'MSFT',
        data: <? php echo $MSFT; ?>
    };

    seriesOptions[1] = {
        name: 'AAPL',
        data: <? php echo $AAPL; ?>
    };

    seriesOptions[2] = {
        name: 'FB',
        data: <? php echo $FB; ?>
    };

    function createChart() {

        chart = new Highcharts.StockChart({
            chart: {
                renderTo: 'container'
            },

            rangeSelector: {
                selected: 4
            },

            yAxis: {
                labels: {
                    formatter: function () {
                        return (this.value > 0 ? '+' : '') + this.value + '%';
                    }
                },
                plotLines: [{
                    value: 0,
                    width: 2,
                    color: 'silver'
                }]
            },
            plotOptions: {
                series: {
                    compare: 'percent'
                }
            },
            tooltip: {
                pointFormat: '<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b> ({point.change}%)<br/>',
                valueDecimals: 2
            },
            series: seriesOptions
        });
    }
}); 
```

如果您有任何问题或需要更多信息，请在评论中告诉我。

谢谢

顺便说一句：我拥有 Highcharts 工作所需的所有资产；当我用 Highcharts 网站上的示例代码替换我的 JS + PHP 时，它运行良好。所以问题显然出在我的 JS + PHP 代码上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:14:01.980

好吧，我相信我找到了问题所在，它在于您将每个单独的点存储在数组中的方式。

而不是这个（它传递一个用逗号分隔的字符串 x,y）：

```
strtotime($val['Date']) * 1000 . ', ' . (float)$val['Close']; 
```

你会想要使用这样的东西（[Highcharts 接受数组或关联数组](http://api.highcharts.com/highcharts#series.data)）：

```
array((strtotime($val['Date']) * 1000), ((float)$val['Close'])); 
```

这会将 X 和 Y 变量存储为数组而不是逗号分隔的字符串，以便 javascript 作为数据传递。

# sql-server - 如何使收件人地址动态化，这样我就可以避免在 SSIS 包中进行更改？

> ID：15304499
> 
> 赞同：1
> 
> 时间：2013-03-08T22:35:36.603
> 
> 标签：sql-server, ssis, config

我的 SSIS 包中有发送数据库电子邮件的 SQL 任务。

```
EXEC sp_send_dbmail @profile_name='default',
@recipients='dev@null.com',
@subject=@SUB,
@body=@BODY,
@query= 'SELECT DISTINCT FileLoadName
FROM [dbo].[Table1] WHERE RowCDate >=@PackageStartTime',
@attach_query_result_as_file=1 
```

但是@recipients 的值在这里是硬编码的。所以我有一个快速的想法。每次更改收件人姓名时，我都必须转到 SSIS 包并在那里应用更改。有没有其他方法可以做到这一点，比如将其作为变量并将其放入配置文件中；因此，如果值随时间变化，有人可以继续在配置文件中进行更改。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T01:41:25.787

将其作为参数传递。一个这样的例子：[https ://www.simple-talk.com/sql/ssis/passing-variables-to-and-from-an-ssis-task/](https://www.simple-talk.com/sql/ssis/passing-variables-to-and-from-an-ssis-task/)

**注意**：我更喜欢在代码开头接收传递的变量。这样，即使我的代码结构发生变化，传递的参数顺序也不需要改变。

我没有触及您为查询设置的值，因为我不明白为什么您的参数 @PackageStartTime 在引号内。您也可以将附加标志作为参数传递。

一旦查询被参数化，相应的变量就可以放入配置中。

```
DECLARE 
    @p_profile_name AS VARCHAR(100) = ?,
    @p_receipients AS VARCHAR(MAX) = ?,
    @p_subject as VARCHAR(100) = ?,
    @p_body AS VARCHAR(MAX) = ?;

    EXEC sp_send_dbmail @profile_name= ?, --'default',
    @recipients= ?,                       --'dev@null.com',
    @subject= ?                           -- @SUB,
    @body= ?                              -- @BODY,
    @query= 'SELECT DISTINCT FileLoadName
            FROM [dbo].[Table1] WHERE RowCDate >=@PackageStartTime',
            @attach_query_result_as_file=1 
```

请让我们（**SSIS 开发人员的精力充沛的团队**）知道它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T03:24:56.290

您还可以从这样的表格中获取收件人列表。假设您有一个名为 EmployeeList 的表，其中包含一个 EmailAddress 字段。

```
DECLARE @emails VARCHAR(500)
SET @emails = '' 
SELECT @emails = @emails + EmailAddress + ';' FROM EmployeeList 

DECLARE @recipList VARCHAR(500)
SET @recipList =  (select SUBSTRING(@emails, 0, LEN(@emails))) 
```

然后你可以像这样设置你的收件人列表

```
EXEC sp_send_dbmail @profile_name='default',
@recipients= @recipList,
@subject=@SUB,
etc.... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-16T11:50:48.227

Maina，我查看了您在与 questions/15351282 相关的页面上给出的代码。

1.  一般性评论：考虑组件以及您希望分配给它们的责任。这是编写干净、可管理和高效的代码的一个非常重要的概念/实践。

2.  现在有一些细节：在代码中，您正在执行一个 if 语句，然后决定是否应该发送电子邮件。把它分成两部分。在控制面上有第一个 Execute sql 任务。将结果存储在变量中。仅测试这一部分，并确保将正确数量的行存储在您的包变量中。对不起，如果我太细化了。

3.  使用条件任务来决定是否应该执行此 sendEmail 任务。

4.  先用一个简单的查询；删除 @attach_query_result_as_file 参数。

5.  在此任务中添加另一个变量： DECLARE @p_PackageStartTime as varchar(40); @query = 'SELECT DISTINCT FileLoadName FROM [dbo].[Table1] WHERE RowCDate >= ' + @PackageStartTime
6.  确保您以正确的顺序传递参数。如果仍然失败，请添加参数映射的屏幕截图。

# slickedit - 在 SlickEdit 窗口中运行终端/shell？

> ID：15304501
> 
> 赞同：1
> 
> 时间：2013-03-08T22:35:39.507
> 
> 标签：slickedit

我想在 Slick Edit 的“普通”文档窗口中运行 bash shell。

至少我会满足于运行命令并将所有输出捕获到文档窗口中。更好的是能够在该窗口中与 shell 交互工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T13:53:24.333

这有点粗糙，但它是我用来启动外部程序（包括 bash 脚本）的。当我以前在 Win+Cygwin 中工作时，我也有一个 bash 脚本的包装器，但我忘记了为什么需要它。

但请记住，您始终可以将特定操作绑定到您的项目（构建、编译等），您也可以随时添加自己的项目->属性->工具->新建。所有这些命令都可以在进程窗口中执行

```
#include "slick.sh"

static _str mytmp='/tmp/myvstmp.txt'

_command git_annotate(_str filename='') name_info(',' VSARG2_MACRO )
{
   if (filename=='') {
      filename=p_buf_name;
   }
   curr_line=p_line;

   delete_file(mytmp); // make sure we dont get old file
   if( file_match(mytmp,'1')==mytmp ) {
      message('Tmp file delete failed! ('mytmp') change permissions and if still failing - restart vs');
      return 1
   }

   shell('/usr/bin/git blame -s 'filename' | sed "s@^\(.\{8\}\) [^)]*) @\1 @" >'mytmp, 'p');

   if( file_match(mytmp,'1')!=mytmp ) {
      message('Annotate failed');
      return 1
   }

   status=edit('-w 'mytmp);
   if (status) {
      message('Error opening output file for display.');
      return 1
   }

   goto_line(curr_line+1);

   // keep disk clean
   p_buf_flags |= VSBUFFLAG_THROW_AWAY_CHANGES;
   name("* annotate output *" filename, false);
   delete_file(mytmp);
} 
```

# javascript - Meteor 服务器实例化

> ID：15304504
> 
> 赞同：1
> 
> 时间：2013-03-08T22:35:59.103
> 
> 标签：javascript, meteor

我对流星实例服务器代码的方式有点困惑。

我认为它的工作方式是，当客户端连接到服务器时，会为该会话生成服务器代码（因此服务器代码中的变量会在用户之间发生变化）。

但是，在测试中，服务器端代码似乎是所有客户端中的一个。这是真的？如果是这样，我如何存储特定于该客户端的变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T19:57:02.543

这个简单问题的答案：**是的，在任何给定时间都有 1 个服务器代码实例，因此您应该使用 Session。对于您的客户端变量**。

# arrays - 将 Int 附加到数组 Matlab

> ID：15304506
> 
> 赞同：0
> 
> 时间：2013-03-08T22:36:12.200
> 
> 标签：arrays, api, matlab

我正在使用 API 来获取火车的真实数据时间，并试图获得与用户输入时间最接近的火车时间，然后显示该火车时间，接下来的 4 个火车正在运行。我正在阅读信息，代码完成了它应该做的事情，但是当我查看数组时，它是 7 个单元格中的一堆 [] 括号，而不是计算出来的数字。有什么建议么？代码如下与 API

测试值：requestStationSelected = 'University%20City' 和 requestEndStation = 'Roslyn'

```
%this is the API link for the live data from Septa this will get 30
%results and see which time is closer to the user entered time
requestInfoSeptaLive = ['http://www3.septa.org/hackathon/NextToArrive/' requestStationSelected '/' requestEndStation '/30'];

%Again tries to get the information and if there is a failure it will give
%a probable cause and terminate the program
try
    getInfoSeptaLive = urlread(requestInfoSeptaLive);
catch
    if getInfoSeptaLive ~= '[]'
        disp...
            ('Either the arrival/depart stations dont quite match up or theres a server error. Try again.');
        return;
    else
        disp('Unable to fetch the information from Septa, please try again')
        return;
    end
end
%parses the information returned from the Live API
dataReturnedFromLiveAPI = parse_json(getInfoSeptaLive);
dataReturnedFromLiveAPI = dataReturnedFromLiveAPI{1};

%gets the size of the API in case there are no trains running
sizeOfDataNoTrains = size(dataReturnedFromLiveAPI, 1);
sizeOfData = size(dataReturnedFromLiveAPI, 2);

counter = 0;

for i = 1:sizeOfData
    scanForClosestTime = dataReturnedFromLiveAPI{1,i}.orig_departure_time;

    trainTimeGivenH = sscanf(scanForClosestTime, '%i');
    findColonTrain = strfind(scanForClosestTime, ':');
    trainTimeGivenMStr = scanForClosestTime(findColonTrain+1:4);
    trainTimeGivenM = int32(str2num(trainTimeGivenMStr));
    trainDepartTimeM = (trainTimeGivenH(1,1) * 60) + (trainTimeGivenM);

    differenceBetweenTimes = trainDepartTimeM - userEnteredMins;
    if trainDepartTimeM < userEnteredMins
        differenceBetweenTimes = userEnteredMins - trainDepartTimeM;
    end

    stopAtEndOfData = sizeOfData;
    goodTimeFrame = 60;
    closestTime = cell(1, stopAtEndOfData);
    storeTheDifference = cell(1, stopAtEndOfData);

    if(differenceBetweenTimes < 60)
        if (counter < 5)
            closestTime{i} = scanForClosestTime;
            storeTheDifference{i} = differenceBetweenTimes;
            counter = counter + 1;
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T03:55:11.487

您在`for`循环内分配单元格数组：

```
for i = 1:sizeOfData
    ...
        closestTime = cell(1, stopAtEndOfData);
        storeTheDifference = cell(1, stopAtEndOfData);
    ...
end 
```

这意味着您`{[],[],[],[],[]...}`在循环的每次迭代中都将它们都变成一个数组 - 所以除非最后一次迭代中有一个有效的“最近时间”，否则您的单元格数组将都是空数组 - 如果是这样，除了最后一个元素仍然是 []。

要解决此问题，请将这两行移到循环开始*之前。*`for`

第二个问题似乎是存储结果的数组的索引。如果您只想要五个结果，我假设您想将它们存储在数组的元素 1 - 5 中，而不是“任意”位置。我会将代码更改为

```
 if (counter < 5)
        counter = counter + 1;
        closestTime{counter} = scanForClosestTime;
        storeTheDifference{counter} = differenceBetweenTimes;
    end 
```

但也许我误解了你想如何处理它？

与您的问题无关，您可能想看看该行

```
trainTimeGivenMStr = scanForClosestTime(findColonTrain+1:4); 
```

这很可能不是您打算做的 - 查看响应示例，我找到了 string `"orig_departure_time":"11:57PM"`。我希望这样`findColonTrain == 3`，所以上面的行变成

```
trainTimeGivenMStr = scanForClosestTime(4:4); 
```

*   只是一个字符。也许你的意思是

    trainTimeGivenMStr = scanForClosestTime(findColonTrain+(1:4));

这将变成

```
trainTimeGivenMStr = scanForClosestTime(4:7); 
```

以便

```
trainTimeGivenMStr = '57PM'; 
```

我希望这三件事可以帮助您完成所有工作！

编辑：今天早上有机会运行您的代码 - 发现了许多其他问题。我在下面包含一个带注释的“工作”代码：最大的问题很可能是您没有在代码中处理 AM/PM。请注意，我使用了不同的 json 解析器——这改变了几行。我相信您可以将其重新组合在一起以按照您想要的方式工作。这在所有单元格中返回了有效数据。

```
dataReturnedFromLiveAPI = loadjson(getInfoSeptaLive);
% next line not needed - loadjson returns struct array, not cell array
%dataReturnedFromLiveAPI = dataReturnedFromLiveAPI{1};

%gets the size of the API in case there are no trains running
sizeOfDataNoTrains = size(dataReturnedFromLiveAPI, 1);
sizeOfData = size(dataReturnedFromLiveAPI, 2);

counter = 0;
stopAtEndOfData = sizeOfData;
closestTime = cell(1, stopAtEndOfData);
storeTheDifference = cell(1, stopAtEndOfData);
userEnteredMins = 12*60+30; % looking for a train around 12:30 pm

for ii = 1:sizeOfData
    scanForClosestTime = dataReturnedFromLiveAPI(ii).orig_departure_time;

    trainTimeGivenH = sscanf(scanForClosestTime, '%i');
    % since we'll be considering AM/PM, have to set 12 = 0:
    if (trainTimeGivenH == 12), trainTimeGivenH = 0; end
    findColonTrain = strfind(scanForClosestTime, ':');
    % change next line to get minutes plus AM/PM:
    trainTimeGivenMStr = scanForClosestTime(findColonTrain+(1:4));
    % look at just minutes:
    trainTimeGivenM = int32(str2num(trainTimeGivenMStr(1:2)));
    % adjust for AM/PM:
    if(trainTimeGivenMStr(3:4)=='PM'), trainTimeGivenH = trainTimeGivenH+12; end;
    % compute time in minutes:
    trainDepartTimeM = (trainTimeGivenH * 60) + (trainTimeGivenM);

    differenceBetweenTimes = trainDepartTimeM - userEnteredMins;
    if trainDepartTimeM < userEnteredMins
        differenceBetweenTimes = userEnteredMins - trainDepartTimeM;
    end
    % added a couple of lines to see what is happening:
    fprintf(1, 'train %d: depart %s - in minutes this is %d vs user entered %d\n', ...
        ii, scanForClosestTime, trainDepartTimeM, userEnteredMins);

    goodTimeFrame = 60;

    if(differenceBetweenTimes < 600)
        if (counter < 10)
            counter = counter + 1;
            closestTime{counter} = scanForClosestTime;
            storeTheDifference{counter} = differenceBetweenTimes;
        end
    end
end 
```

# excel - Excel VBA：无法从列表框中取消选择列表框项目

> ID：15304509
> 
> 赞同：1
> 
> 时间：2013-03-08T22:36:24.233
> 
> 标签：excel, vba

我有一个命令按钮，用于处理 ListBox (ListBox4) 中的选定项目。虽然我可以取消选择该命令的 Click() 过程中的所有项目，但如果用户在 ListBox 中单击，我想在再次选择之前取消选择 ListBox 中的所有项目。

我有如下代码，但它似乎从未被调用：

```
Private Sub ListBox4_Click()
If Apply_Format_Occurred Then
For i = 0 To ListBox4.ListCount - 1
         ListBox4.Selected(i) = False
Next i
End Sub 
```

我需要外部命令等来执行此操作吗？我希望能够像我描述的那样做。

任何帮助是极大的赞赏！

谢谢，

拉斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:42:45.023

您可以使用 ListBox 的 GotFocus 事件，以便在 ListBox 从用户接收焦点时运行代码。
这是一个显示按钮和列表框编码的示例：

```
Dim Apply_Format_Occurred As Boolean

Private Sub CommandButton1_Click()
    '<other processes>
    Apply_Format_Occurred = True
End Sub

Private Sub ListBox4_Change()
    If Apply_Format_Occurred Then
        For i = 0 To ListBox4.ListCount - 1
             ListBox4.Selected(i) = False
        Next i
        Apply_Format_Occurred = False
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-23T17:42:54.230

我看到这个线程很旧，也许有一种简单或更优雅的方式来取消选择列表框项。但是，我想出了一种满足我需求的方法。在我的情况下，我希望列表框仅在单击相同项目时取消选择。如果单击了一个新项目，它将被正常选择。我不得不使用两个静态变量（一个布尔值和“旧选择”占位符）。

可能有一个更简单的方法。但是，我是新手，找不到它。希望这可以帮助。将 selectedindex 设置为 -1 会取消选择所有内容。或者同样有效的是*listboxName* .ClearSelected()

```
 Private Sub lstPendingQuotes_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles lstPendingQuotes.Click

    Static blnSelectable As Boolean = True 'use static boolean to retain value between calls
    Static objOldSelected As Object = lstPendingQuotes.SelectedIndex 'use old selected in case a different index is selected

    'if nothing is already selected (as in first form open) allow the selection but change boolean to false and set the OldSelected variable to the current selection
    If blnSelectable Then
        blnSelectable = False
        objOldSelected = lstPendingQuotes.SelectedIndex
    ElseIf lstPendingQuotes.SelectedIndex = objOldSelected Then 'if an item is selected and the same item is clicked un-select all and reset boolean to true for a new possible selection
        lstPendingQuotes.SelectedIndex = -1 'can substitute lstPendingQuotes.ClearSelected()
        blnSelectable = True
    Else 'If a different index is chosen allow the new selection and change boolean to false so if the same item is clicked it will un-select
        objOldSelected = lstPendingQuotes.SelectedIndex
        blnSelectable = False
    End If

End Sub 
```

# r - 用于对多个变量进行回归并输出子集的 for 循环

> ID：15304514
> 
> 赞同：1
> 
> 时间：2013-03-08T22:36:46.537
> 
> 标签：r, for-loop, matrix, regression, output

我试图将这个 QA：[“R 中的有效循环逻辑回归”](https://stackoverflow.com/questions/13418148/efficient-looping-logistic-regression-in-r)应用于我自己的问题，但我不能让它完全发挥作用。我没有尝试使用 apply，但有几个人告诉我，这里最好使用 for 循环（如果有人不相信，请随时解释！）论坛。

这就是我想要实现的目标：我有一个数据集，其中包含 3 个预测变量（性别、年龄、种族）和一个因变量（比例），用于几个人的 86 个遗传位置。我想为每个位置运行双变量线性回归（因此 3 个预测变量有 86 个线性回归）。然后我想以某种易于阅读的格式输出结果；我的想法是一个矩阵，其中行=性别、年龄和种族，列=86 个位置。每个行*列组合都会有一个 ap 值。然后我可以调用 p 值<0.1（或我想要的任何阈值）来轻松查看哪些预测变量与每个位置的比例显着相关。

这是我到目前为止的代码。

```
BB <- seq.csv[,6:91]   #the data frame containing the 86 positions
AA <- seq.csv[,2:4]    #the data frame containing the 3 predictor variables

linreg <- matrix(NA,3,86)  #make a results vector and fill it with NA
    for (i in 1:86)     #loop over each position variable
    {
              for (j in 1:3)  #for each position variable, loop over each predictor
    {
              linreg[i,j] <- lm(BB[,i]~AA[,j])  #bivariate linear regression
}} 
```

无论我如何更改它（例如，将其简化为仅循环一个预测变量的位置），我仍然会收到一个错误，即我的矩阵长度不同（要替换的项目数不是替换长度的倍数） . 实际上，length(linreg)=286 (3*86) and length(BB)=86 and length(AA)=3。我知道后两个是数据帧，而不是矩阵......但是如果我将它们转换为矩阵，我会得到一个无效的类型错误（变量'BB [，i]'的无效类型（列表））。我不知道如何解决这个错误，因为我对 R 的理解不够好......我已经查阅了*Applied Statistical Genetics with R*和*Art of R Programming*的书籍，但无济于事，我一直在谷歌搜索所有天。而且我什至还没有编写输出结果的编码......

我将不胜感激任何调试技巧或一些关于更好编码方式的建议！谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:30:10.300

*在事先不知道*数据结构的情况下很难给出明确的答案，但这*可能会*奏效。我假设您的两个数据框具有相同的行数（观察值）：

```
df <- cbind( AA[ , 2:4 ] , BB[ , 6:91 ] )
mods <- apply( as.data.frame( df[ , 4:89 ] ) , 2 , FUN = function(x){ lm( x ~ df[,1] + df[,2] + df[,3] } )

# The rows of this matrix will correspond to the intercept, gender, age, race, and the columns are the results for each of your 86 genetic postions
pvals <- sapply( mods , function(x){ summary(x)$coefficients[,4] ) 
```

至于这是否*正确*，我相信您作为遗传流行病学家的判断！

# javascript - Javascript onclick 函数适用于除 FF 和 IE 之外的所有应用

> ID：15304518
> 
> 赞同：0
> 
> 时间：2013-03-08T22:37:00.770
> 
> 标签：javascript, internet-explorer, firefox

我用 javascript 编写了一个简单的测验，它在我选择的浏览器中运行良好，但是当我在 IE 和 FF 中测试它时，按钮不起作用。我收到“ReferenceError：未定义 Option1button()”

即使在这一点代码中，我也会遇到同样的错误：

```
<!DOCTYPE HTML >
<html><head><title></title></head>
    <body onload="loadPlayer();">
        <script type="text/javascript">
            function Option1button(){
                document.getElementById("op1").style.display = 'none';
            }
            function loadPlayer() {
                document.write("<div id=\"op1\"><button onclick='Option1button()'>choose</button> OPTIONS <br></div>");
            }
        </script>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T22:39:10.003

`document.write`除了立即运行的代码之外，您不能在任何地方使用。

如果您试图推迟它，以便在定义函数之前按钮不会出现，只需执行以下操作：

```
<body>
<script>function Option1Button() {...}</script>
<div id="op1">...</div> 
```

由于脚本会阻止页面加载，因此在准备好调用该函数之前，该按钮不会出现。

# python - 使用 cmd python 模块时，如何使我的程序正确崩溃？

> ID：15304522
> 
> 赞同：5
> 
> 时间：2013-03-08T22:37:20.223
> 
> 标签：python, cmd

发生的情况是，如果您的代码引发运行时异常并且您的完成不起作用，您不知道为什么，因为没有打印回溯。试试这个非常短的代码，看看我的意思：程序应该在 c = 2+"ddda" 行崩溃，显然你正在添加一个字符串和一个 int，这根本行不通。但是不是崩溃，而是捕获了异常，您不知道发生了什么。程序继续运行，就好像什么都没发生一样。

```
import cmd

class App(cmd.Cmd):
    def complete_foo(self,*arg):
        # Uncommenting this line will silently crash the progrm
        # making it hard to debug.
        # Is there a way to force the program to crash ?
        c = 2 + "ddda"
        return "d dzpo idz dza dpaoi".split(" ")

    def do_foo(self,*args):
        print "foo"
App().cmdloop() 
```

我的问题是：出现错误时如何显示错误？（使用 cmd 模块时）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T22:57:04.277

不幸的是，完成者中的异常被捕获在`readline`. 你可以尝试这样的事情：

```
import cmd
import traceback

def log_exceptions(fun):
    def wrapped(*a, **kw):
        try:
            return fun(*a, **kw)
        except Exception:
            print traceback.format_exc()
            raise

    return wrapped

class App(cmd.Cmd):
    @log_exceptions
    def complete_foo(self,*arg):
        # Uncommenting this line will silently crash the progrm
        # making it hard to debug.
        # Is there a way to force the program to crash ?
        c = 2 + "ddda"
        return "d dzpo idz dza dpaoi".split(" ") 
```

```
$ python c.py
(Cmd) foo Traceback (most recent call last):
  File "c.py", line 7, in wrapped
    return fun(*a, **kw)
  File "c.py", line 20, in complete_foo
    c = 2 + "ddda"
TypeError: unsupported operand type(s) for +: 'int' and 'str' 
```

调试完成后删除装饰器，因为从 readline 内部打印回溯可能会弄乱您的终端。

不，您不能轻易使 readline 崩溃。

# scala - 为什么 Scala 在分配给 val 时需要部分应用柯里化函数？

> ID：15304523
> 
> 赞同：12
> 
> 时间：2013-03-08T22:37:27.550
> 
> 标签：scala, currying

在 Scala 中，为什么一个 curried 函数可以很容易地直接传递给其他函数，但是在将它分配给一个函数时，`val`还需要部分应用它`_`？例如，给定两个函数：

```
def curried(a: Int)(b: Int) = a + b
def test(a: Int, f: Int => Int) = f(a) 
```

我可以很容易地传递`curried`给`test`：

```
test(5, curried(5)) 
```

一切都很幸福。但是，如果我只是打电话`curried(5)`，我会收到一个错误：

```
scala> curried(5)
<console>:9: error: missing arguments for method curried;
follow this method with `_' if you want to treat it as a partially applied function
              curried(5) 
```

但是，如果我将调用更改为包含类型信息，它将起作用：

```
val 'curried: Int => Int = curried(5) 
```

谁能解释不一致背后的原因，Scala编译器肯定可以推断出该函数是`Int => Int`在原始方法上给出了类型定义的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T22:44:13.157

问题不在于推断类型，问题在于推断您的意图。是你犯了错误，还是你故意对函数进行了柯里化？

唉，结尾的下划线语法是正式语法，省略它是语法糖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-29T22:24:23.210

并不总是需要下划线。来自[http://docs.scala-lang.org/cheatsheets/](http://docs.scala-lang.org/cheatsheets/)

```
val zscore = (mean:R, sd:R) => (x:R) => (x-mean)/sd 
```

柯里化，明显的语法。

```
def zscore(mean:R, sd:R) = (x:R) => (x-mean)/sd 
```

柯里化，明显的语法

```
def zscore(mean:R, sd:R)(x:R) = (x-mean)/sd 
```

柯里化，糖的语法。但是之后：

```
val normer = zscore(7, 0.4) _ 
```

**需要尾随下划线来获取部分，仅适用于糖版本。**

# django - 使用管理员创建用户时向 django 添加所需的电子邮件字段

> ID：15304525
> 
> 赞同：4
> 
> 时间：2013-03-08T22:37:29.767
> 
> 标签：django, django-admin

使用 Django 管理员创建/添加用户时；如何定制？

例如，目前提示输入用户名和密码。但是，我想自定义它以具有其他必填字段，例如“电子邮件”？

Django 教程对管理员用户身份验证自定义不清楚？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2016-06-28T03:33:34.700

1.  把它放在你的`models.py`.

    ```
    from django.contrib.auth.models import User
    User._meta.get_field('email').blank = False 
    ```

2.  运行`makemigrations`。

3.  运行`migrate`。

[请参阅文档](https://docs.djangoproject.com/en/2.2/ref/models/meta/#field-access-api)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-11T22:36:28.063

创建用户时向表单添加电子邮件的示例。在项目`admin.py`中添加了以下内容：

```
from django.contrib.auth.admin import UserAdmin
from django.contrib.auth.forms import UserCreationForm, UserChangeForm
from django.contrib.auth.models import User
from django.utils.translation import ugettext_lazy as _

class UserAdmin(UserAdmin):
    fieldsets = (
        (None, {'fields': ('username', 'password','email')}),
        (_('Personal info'), {'fields': ('first_name', 'last_name')}),
        (_('Permissions'), {'fields': ('is_active', 'is_staff', 'is_superuser',
                                       'groups', 'user_permissions')}),
        (_('Important dates'), {'fields': ('last_login', 'date_joined')}),
    )
    add_fieldsets = (
        (None, {
            'classes': ('wide',),
            'fields': ('username', 'password1', 'password2', 'email')}
        ),
    )
    form = UserChangeForm
    add_form = UserCreationForm

try:
    admin.site.unregister(User)
except NotRegistered:
    pass

admin.site.register(User, UserAdmin) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T22:59:16.563

这是您可以自定义用户管理员的方式：

```
from django.contrib import admin
from django.contrib.auth import admin as upstream

# custom admin class for the User model, subclassing Django's one
class UserAdmin(upstream.UserAdmin):
    add_form_template = ...
    add_form = ...
    add_fieldsets = ...

# unregister any existing admin for the User model and register mine
try:
    admin.site.unregister(User)
except NotRegistered:
    pass
admin.site.register(User, UserAdmin) 
```

我留下的部分`...`是您需要进行的自定义，以更改管理员提示创建用户的方式。

在里面寻找原始代码`django/contrib/auth/admin.py`并修改以适应口味。

# android - Nexus 4 无法从公共地址接收多播

> ID：15304526
> 
> 赞同：2
> 
> 时间：2013-03-08T22:37:32.550
> 
> 标签：android, android-wifi, android-networking, nexus-4

我们正在将目前运行在 IOS 上的产品移植到 Android 平台上，它基本上是接收多播音频数据包并播放它们。到目前为止，我们测试过的每台 Android 设备都可以正常工作（HTC 设备、三星等）。但是，我们永远不会在 Nexus 4 上收到网络流量！

我们的应用程序在 20118 端口打开了一个 UDP 端口，并在 239.192.0.11 加入了多播组。流量永远不会到达 Nexus 4。

只是为了好玩，我编写了应用程序来监听 mDNS 多播地址和端口，即端口 5353 和多播组 224.0.0.251。网络总是围绕 mDNS 流量进行压缩，所以我想我会拿起一个数据包。

有效！

所以我的应用完全能够在 Nexus 4 上接收多播流量，只要它是 mDNS 流量。它不会在 239.192.0.11 和端口 20118 接收任何多播流量（保证它存在，因为其他设备同时接收它就好了）。

Nexus 4 中是否有某种防火墙？或者是否有一块地址被禁用？

有人有这个设备的其他多播地址问题吗？

只是为了比较，它确实适用于运行 4.2.2 的 Nexus 7 平板电脑。只是不是 Nexus 4，还有 4.2.2（也没有早期版本的 Jelly Bean）。

谢谢你的帮助，

查克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T13:50:09.093

看起来多播在 Nexus 4 上被禁用：

[http://code.google.com/p/android/issues/detail?id=51195](http://code.google.com/p/android/issues/detail?id=51195)

不过，这并不能解释为什么 mDNS 可以工作。也许他们被内核特别对待？

# java - “var &= expr”的行为不像“var = var && expr”

> ID：15304527
> 
> 赞同：4
> 
> 时间：2013-03-08T22:37:44.230
> 
> 标签：java, compilation

我只是好奇。我想知道表达式是否有特定原因

```
var &= expr 
```

行为方式与

```
var = var && expr. 
```

看起来第一个表达式中的表达式正在执行，而不管 var 上的错误值如何。

我正在使用 Java 6，仅供参考。这段代码：

```
public class Test
{
    protected static String getString()
    {
        return null;
    }

    public static void main(String... args)
    {
        String string = getString();
        boolean test = (string != null);
        test = test && (string.length() > 0);
        System.out.println("First test passed");
        test &= (string.length() > 0);
        System.out.println("Second test passed");
    }
} 
```

给我：

```
First test passed
Exception in thread "main" java.lang.NullPointerException
    at Test.main(Test.java:14)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-08T22:39:36.907

`&`不像`&&`^(1,2)

`&`是一个*急切*的按位/布尔值与。

`&&`是[*短路*](http://en.wikipedia.org/wiki/Short-circuit_evaluation)逻辑与。

* * *

¹带有 的行`&=`等同于`test = test & (string.length() > 0)`，它也会失败。

²看看[为什么我们通常使用`||`而不是`|`，有什么区别？](https://stackoverflow.com/questions/7101992/why-do-we-usually-use-not-what-is-the-difference)- 答案还包括 和 的`&&`使用`&`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T22:39:41.653

> 看起来第一个表达式中的表达式正在执行，而不管 var 上的错误值如何。

这是因为第二个表达式使用短路评估，而第一个表达式没有。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T22:39:21.323

它们不一样，因为`&`是位运算符并且`&&`是布尔值的逻辑运算符。

`var &= expr`等于`var = var & expr`，不是`var = var && expr`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T22:45:17.460

在你的情况下

```
test = test && (string.length() > 0); // test = false that why strings.length not evaluated

test &= (string.length() > 0); //calling length on null object that why NPE 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-08T22:40:56.530

`&`是按位与

`&&`是逻辑与。

`true && true = true`..

`&`适用于数字，`&&`适用于布尔表达式。

`0xFE & 0xFF`结果`0xFE`。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-08T22:41:16.803

```
var &= expr 
```

相当于

```
var = var & expr 
```

换句话说，它*按位*或

```
var = var && expr 
```

对 var 和 expr 进行逻辑或

# c# - 按日期范围统计用户

> ID：15304533
> 
> 赞同：1
> 
> 时间：2013-03-08T22:38:15.977
> 
> 标签：c#, entity-framework, datetime, count, linq-to-entities

我有以下用户实体：

```
public class User
{
  public DateTime Birthday { get; set; }
} 
```

如何按年龄范围统计用户数？就像是：

```
0 to 5
5 to 15
... 
```

我尝试了以下方法：

```
var usersByAge = context.Users.GroupBy(x => x.Info.Birthday).Count(); 
```

但这会按用户的生日对用户进行分组，并按天计算。它按天计算，因为时间总是空的......

但我需要按年龄范围分组。例如，获取从生日到 DateTime.Now 的年跨度。然后按“0-5”，“5-15”，...分组，然后计数。

我怎样才能做到这一点？请让我知道是否清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:51:27.193

您可以像这样选择过滤它们：

```
var year = DateTime.Now.Year;
var users = yourUserCollection.Count(x =>
    x.BirthDay.Year - year >= 5 && 
    x.BirthDay.Year - year <= 11); 
```

# winforms - 用户控件尝试访问文件时VS2012崩溃

> ID：15304538
> 
> 赞同：1
> 
> 时间：2013-03-08T22:38:45.943
> 
> 标签：winforms, file-io, user-controls, visual-studio-2012

我正在构建一个 Windows 窗体应用程序 (C#)。我创建了一个相当复杂的自定义用户控件，效果很好。问题是，当我将此控件添加到我的主窗体时，它会在一段时间后崩溃 VS。

环顾四周后，我发现我使用两个 VS 实例的建议，一个用于调试另一个 - 这很快缩小了问题的范围：

自定义用户控件包含一个 30 秒的计时器，它在完成时将一些数据保存到 XML 文件中。由于程序实际上并没有运行，它试图将文件保存到*C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE*，它没有权限（因此崩溃）。

这是一个不常见的问题，当应用程序正常运行时不会出现问题（文件设置为与可执行文件保存在同一目录中）。有没有办法阻止控件在设计模式下运行？

# sql - 在我的查询中加入问题，如何将空值填充为零

> ID：15304545
> 
> 赞同：0
> 
> 时间：2013-03-08T22:39:19.887
> 
> 标签：sql

我的查询是获取过去 5 周的数据。

```
select z.week,
sum(case when i.severity=1 then 1 else 0 end) as 1
sum(case when i.severity=2 then 1 else 0 end) as 2
sum(case when i.severity=3 then 1 else 0 end) as 3
sum(case when i.severity=4 then 1 else 0 end) as 4
from instance as i
and left outer join year as z on convert(varchar(10),z.date,101)=convert(varchar(10),i.created,101)
and left outer join year as z on convert(varchar(10),z.date,101)=convert(varchar(10),i.closed,101)
where i.group in '%Teams%'
and z.year=2013
and z.week<=6 and z.week>1 
```

我的实例表中有几个星期，甚至没有一行。所以这里我没有得到空值或零......相反，整行根本没有提示。

我现在的输出。

```
week | 1 | 2 | 3 | 4 
---------------------
2  | 0 | 1 | 8 | 5
3  | 2 | 3 | 4 | 9
5  | 1 | 0 | 0 | 0 
```

但我需要像下面这样的输出......

```
week | 1 | 2 | 3 | 4 
---------------------
2  | 0 | 1 | 8 | 5
3  | 2 | 3 | 4 | 9
4  | 0 | 0 | 0 | 0
5  | 1 | 0 | 0 | 0
6  | 0 | 0 | 0 | 0 
```

如何获得所需的输出in sql

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:50:40.027

尝试这个

```
select z.week,
sum(case when i.severity=1 then 1 else 0 end) as 1
sum(case when i.severity=2 then 1 else 0 end) as 2
sum(case when i.severity=3 then 1 else 0 end) as 3
sum(case when i.severity=4 then 1 else 0 end) as 4
from year as z 
left outer join instance as i  on   
convert(varchar(10),z.date,101)=convert(varchar(10),i.created,101)
and convert(varchar(10),z.date,101)=convert(varchar(10),i.closed,101)
where (i.group is null or i.group in '%Teams%')
and z.year=2013
and z.week<=6 and z.week>1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:51:23.340

我不确定查询是如何工作的，您将`year`两次别名为`z`. 但是，假设这不是问题，您可以`LEFT OUTER JOIN`将`RIGHT OUTER JOIN`. 或者，如果您不喜欢`RIGHT OUTER JOIN`，请重新编写 SELECT 以便该`FROM`子句引用该`year`表。

# javascript - 如何让这两个 jQuery 脚本一起工作？

> ID：15304553
> 
> 赞同：0
> 
> 时间：2013-03-08T22:39:41.843
> 
> 标签：javascript, jquery, audio, lightbox

一个是用于 Mp3 的音频播放器，另一个是我试图在其中显示 YouTube 视频的 Lightbox。

这是头部：

```
<script type="text/javascript" src="videobox/js/mootools.js"></script>
<script type="text/javascript" src="videobox/js/swfobject.js"></script>
<script type="text/javascript" src="videobox/js/videobox.js"></script>
<link rel="stylesheet" href="videobox/css/videobox.css" type="text/css" media="screen" />

<link rel="stylesheet" href="libs/css/styles.css" />
<script src="libs/jquery/jquery.js"></script>
<script src="src/jquery.ubaplayer.js"></script>
<script>
   $(function(){
            $("#ubaPlayer").ubaPlayer({
            codecs: [{name:"MP3", codec: 'audio/mpeg;'}]
            });
        });
</script> 
```

我注意到当我删除“libs/jquery/jquery.js”时灯箱工作，但我的音频播放器停止工作。

我对 Javascript/JQuery 不是很熟练，所以答案可能很明显。

**更新：**

这解决了问题！

```
<script type="text/javascript" src="videobox/js/mootools.js"></script>
<script type="text/javascript" src="videobox/js/swfobject.js"></script>
<script type="text/javascript" src="videobox/js/videobox.js"></script>
<link rel="stylesheet" href="videobox/css/videobox.css" type="text/css" media="screen" />

<link rel="stylesheet" href="libs/css/styles.css" />
<script src="libs/jquery/jquery.js"></script>
<script src="src/jquery.ubaplayer.js"></script>
<script>
   jQuery.noConflict();
   jQuery(function(){
            jQuery("#ubaPlayer").ubaPlayer({
            codecs: [{name:"MP3", codec: 'audio/mpeg;'}]
            });
        });
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T22:42:06.433

MooTools 和 jQuery 都使用该`$`变量，这意味着您不能同时使用它们。2个解决方案：

1.  搜索这两个特性的 jQuery/MooTools 实现，我相信你会找到的。
2.  用于[`jQuery.noConflict`](http://api.jquery.com/jQuery.noConflict)让 MooTools 使用该`$`变量。
3.  在jQuery**之后**使用`jQuery`变量代替`$`并包含 MooTools 。如果您想使用 jQuery 的快捷方式，请将您的 jQuery 代码包装在一个带有回调的 as 参数的 domready 事件中：**`$``$`**

     **```
    jQuery(function($) {
        // ... jQuery code ($ has a copy of `jQuery` now)
    });
    // ... MooTools code ($ has a reference to the `MooTools.id` method now) 
    ```** 

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:47:09.253

您可以将 jQuery 代码隔离在将 jQuery 对象作为参数传递的自动执行函数中。所以 $ 意味着在 jQuery 范围内，但在它之外可以是别的东西。

```
(function ($) {

    // your jQuery code here

}(jQuery)); 
```

传递对象窗口以避免解析全局范围并接收窗口和未定义是很常见的。由于您只传递了 2 个参数，因此第 3 个参数必须是未定义的，这样可以提高代码的可压缩性并使其更加稳定（不幸的是，未定义可以重新定义）

```
(function ($, window, undefined) {

    // your jQuery code here

}(jQuery, window)); 
```**

# c++ - 在递归中使用一维数组

> ID：15304557
> 
> 赞同：0
> 
> 时间：2013-03-08T22:40:02.830
> 
> 标签：c++, algorithm, recursion, partitioning

最近我一直在研究分区问题。我做了一项研究，发现可以使用 wiki 页面上的算法来解决。这是伪算法：

```
 INPUT:  A list of integers S
   OUTPUT: True if S can be partitioned into two subsets that have equal sum
1 function find_partition( S ):
2     N ← sum(S)
3     P ← empty boolean table of size (\lfloor N/2 \rfloor  +  1) by (n + 1)
4     initialize top row (P(0,x)) of P to True
5     initialize leftmost column (P(x, 0)) of P, except for P(0, 0) to False
6     for i from 1 to \lfloor N/2 \rfloor 
7          for j from 1 to n
8          P(i, j) ← P(i, j-1) or P(i-S[j-1], j-1)
9     return P(\lfloor N/2 \rfloor , n) 
```

使用递归，您可以计算是否可以达到数组中整数的某个总和，如果可以达到，则返回 true。我从0开始，`sumOfTheIntegers/2`然后回到0，直到找到解决方案。当我找到小于或等于平均值​​的最大可能整数和时，我计算两组整数之间的差`(average-lowestSumLowerorEqualtoAverage)*2`。

但是后来我遇到了问题，如何在递归中包含一维数组？

这是代码，它应该可以工作，但由于问题，我还没有测试过。所以也许代码包含小错误。但这不是问题，我稍后会解决它。

```
#include <iostream>
#include <cmath>
using namespace std;
bool matrix (int a, int b)
{
    if(b == -1)  return true;
    else if (a == -1) return false;
    else if(matrix(a-1, b) == true) return true;
    else if(matrix(a-1,b-numbers[a-1]) == true) return true;
    else return false;
}
int main()
{
    int number, sum = 0;
    cin >> number;
    int numbers[number];
    for(int i = 0; i<number; i++)
    {
        cin >> numbers[i];
        sum += numbers[i];
    }
    double average = sum/2.0;
    for(int i = floor(sum/2); i!= 0; i--)
    {
        if(matrix(number+1, i) == true)
        {
            cout << abs(average-i)*2;
            break;
        }
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:49:57.437

最简单（但肯定不是最好）的方法是引入一个全局变量：

```
#include <vector>
std::vector<int> numbers;

/* ... */

int main(){
    int number;
    cin >> number;
    numbers.resize(number);
    /* ... */
} 
```

另一种可能性是使用附加参数：

```
bool matrix (int a, int b, const std::vector<int>& numbers)
{
    if(b == -1)  return true;
    else if (a == -1) return false;
    else if(matrix(a-1, b,numbers) == true) return true;
    else if(matrix(a-1,b-numbers[a-1],numbers) == true) return true;
    else return false;
} 
```

请注意，`int numbers[number]`它实际上使用了特定于编译器的扩展 (VLA)，并且不是 C++ 标准的一部分（请参阅[Does C++ support Variable Length Arrays?](https://stackoverflow.com/questions/8593643/does-c-support-variable-length-arrays)和[Why are not variable-length arrays part of the C++ standard?](https://stackoverflow.com/questions/1887097/variable-length-arrays-in-c)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:47:49.383

将其作为参数传递给函数

```
bool matrix (int a, int b, int num_arr[])
{
  ...
  matrix(a-1,b,num_arr);
  ... 
} 
```

# ruby - 通过include添加类方法

> ID：15304559
> 
> 赞同：3
> 
> 时间：2013-03-08T22:40:12.223
> 
> 标签：ruby, mixins, eigenclass, singleton-methods

我有 Ruby 类，我想在其中包含类和实例方法。按照[此处](http://www.dan-manges.com/blog/27)描述的模式，我目前正在使用以下内容：

```
class SomeObject

  include SomeObject::Ability

  def self.some_builder_method(params)
    # use some_class_method ...
  end

end

module SomeObject::Ability

  module ClassMethods

    def some_class_method(param)
      # ...
    end

  end

  def self.included(klass)
    klass.extend(ClassMethods)
  end

  def some_instance_method
    # ...
  end

end 
```

我宁愿不制作两个单独的模块（一个被包含，另一个被扩展），因为我模块中的所有方法在逻辑上都适合在一起。另一方面，这种模式 a) 要求我定义一个附加`ClassMethods`模块，b) 要求我为每个模块编写一个样板`self.included`方法。

有一个更好的方法吗？

**编辑1**：我找到了另一种方法，但我不确定这是否比第一种更好。

```
module Concern

  def included(base)

    # Define instance methods.
    instance_methods.each do |m|
      defn = instance_method(m)
      base.class_eval { define_method(m, defn) }
    end

    # Define class methods.
    (self.methods - Module.methods).each do |m|
      unless m == __method__
        base.define_singleton_method(m, &method(m))
      end
    end

  end

end

module SomeModule

  extend Concern

  def self.class_m
    puts "Class"
  end

  def instance_m
    puts "Instance"
  end

end

class Allo

  include SomeModule

end

Allo.class_m          # => "Class"
Allo.new.instance_m   # => "Instance" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T23:53:36.537

如果我理解正确，您真的只想使用`ActiveSupport::Concern`：

```
module PetWorthy
  extend ActiveSupport::Concern

  included do
    validates :was_pet, inclusion: [true, 'yes']
  end

  def pet #instance method
  end

  module ClassMethods
    def find_petworthy_animal
      # ...
    end
  end
end

class Kitty
  include PetWorthy
end

Kitty.find_petworthy_animal.pet 
```

`included`如果您没有任何行为可以触发包含，您（希望很明显）不需要使用该方法，但我将其放入只是为了演示。

# search - 如何延迟 AngularJS 即时搜索？

> ID：15304562
> 
> 赞同：148
> 
> 时间：2013-03-08T22:40:39.510
> 
> 标签：search, filter, angularjs, timeout, delay

我有一个似乎无法解决的性能问题。我有一个即时搜索，但它有点滞后，因为它开始搜索每个`keyup()`.

JS：

```
var App = angular.module('App', []);

App.controller('DisplayController', function($scope, $http) {
$http.get('data.json').then(function(result){
    $scope.entries = result.data;
});
}); 
```

HTML：

```
<input id="searchText" type="search" placeholder="live search..." ng-model="searchText" />
<div class="entry" ng-repeat="entry in entries | filter:searchText">
<span>{{entry.content}}</span>
</div> 
```

JSON数据甚至没有那么大，只有300KB，我认为我需要完成的是在搜索上延迟约1秒以等待用户完成输入，而不是在每次击键时执行操作。AngularJS 在内部执行此操作，在阅读了此处的文档和其他主题后，我找不到具体的答案。

我将不胜感激有关如何延迟即时搜索的任何指示。

* * *

## 回答 #1

> 赞同：301
> 
> 时间：2013-08-28T17:34:14.630

**更新**

现在比以往任何时候都容易（Angular 1.3），只需在模型上添加一个去抖动选项。

`<input type="text" ng-model="searchStr" ng-model-options="{debounce: 1000}">`

更新的 plunker：
[http ://plnkr.co/edit/4V13gK](http://plnkr.co/edit/4V13gK)

关于 ngModelOptions 的文档：
[https ://docs.angularjs.org/api/ng/directive/ngModelOptions](https://docs.angularjs.org/api/ng/directive/ngModelOptions)

**老方法：**

这是另一种不依赖于角度本身的方法。

您需要设置超时并将当前字符串与过去的版本进行比较，如果两者相同，则执行搜索。

```
$scope.$watch('searchStr', function (tmpStr)
{
  if (!tmpStr || tmpStr.length == 0)
    return 0;
   $timeout(function() {

    // if searchStr is still the same..
    // go ahead and retrieve the data
    if (tmpStr === $scope.searchStr)
    {
      $http.get('//echo.jsontest.com/res/'+ tmpStr).success(function(data) {
        // update the textarea
        $scope.responseData = data.res; 
      });
    }
  }, 1000);
}); 
```

这进入你的视野：

```
<input type="text" data-ng-model="searchStr">

<textarea> {{responseData}} </textarea> 
```

强制性 plunker： [http ://plnkr.co/dAPmwf](http://plnkr.co/dAPmwf)

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2013-03-08T23:18:49.727

（有关 Angular 1.3 解决方案，请参阅下面的答案。）

这里的问题是每次模型更改时都会执行搜索，这是对输入的每个键操作。

会有更简洁的方法来做到这一点，但可能最简单的方法是切换绑定，以便您在控制器中定义一个 $scope 属性，您的过滤器在该属性上运行。这样您就可以控制 $scope 变量的更新频率。像这样的东西：

JS：

```
var App = angular.module('App', []);

App.controller('DisplayController', function($scope, $http, $timeout) {
    $http.get('data.json').then(function(result){
        $scope.entries = result.data;
    });

    // This is what you will bind the filter to
    $scope.filterText = '';

    // Instantiate these variables outside the watch
    var tempFilterText = '',
        filterTextTimeout;
    $scope.$watch('searchText', function (val) {
        if (filterTextTimeout) $timeout.cancel(filterTextTimeout);

        tempFilterText = val;
        filterTextTimeout = $timeout(function() {
            $scope.filterText = tempFilterText;
        }, 250); // delay 250 ms
    })
}); 
```

HTML：

```
<input id="searchText" type="search" placeholder="live search..." ng-model="searchText" />
<div class="entry" ng-repeat="entry in entries | filter:filterText">
    <span>{{entry.content}}</span>
</div> 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2015-03-20T20:15:59.610

In Angular 1.3 I would do this:

HTML:

```
<input ng-model="msg" ng-model-options="{debounce: 1000}"> 
```

Controller:

```
$scope.$watch('variableName', function(nVal, oVal) {
    if (nVal !== oVal) {
        myDebouncedFunction();
    }
}); 
```

Basically you're telling angular to run `myDebouncedFunction()`, when the the `msg` scope variable changes. The attribute `ng-model-options="{debounce: 1000}"` makes sure that `msg` can only update once a second.

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-08-14T14:50:32.997

```
 <input type="text"
    ng-model ="criteria.searchtext""  
    ng-model-options="{debounce: {'default': 1000, 'blur': 0}}"
    class="form-control" 
    placeholder="Search" > 
```

现在我们可以设置 ng-model-options 随时间去抖动，当模糊时，需要立即更改模型，否则在保存时如果延迟未完成，它将具有较旧的值。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-05-16T07:20:02.367

对于那些在 HTML 标记中使用 keyup/keydown 的人。这不使用手表。

**JS**

```
app.controller('SearchCtrl', function ($scope, $http, $timeout) {
  var promise = '';
  $scope.search = function() {
    if(promise){
      $timeout.cancel(promise);
    }
    promise = $timeout(function() {
    //ajax call goes here..
    },2000);
  };
}); 
```

**HTML**

```
<input type="search" autocomplete="off" ng-model="keywords" ng-keyup="search()" placeholder="Search..."> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-08-15T13:14:43.613

angularjs 的去抖动/节流模型更新：http: [//jsfiddle.net/lgersman/vPsGb/3/](http://jsfiddle.net/lgersman/vPsGb/3/)

在您的情况下，除了在 jsfiddle 代码中使用指令之外，别无他法，如下所示：

```
<input 
    id="searchText" 
    type="search" 
    placeholder="live search..." 
    ng-model="searchText" 
    ng-ampere-debounce
/> 
```

它基本上是一小段代码，由一个名为“ng-ampere-debounce”的单个角度指令组成，该指令利用[http://benalman.com/projects/jquery-throttle-debounce-plugin/](http://benalman.com/projects/jquery-throttle-debounce-plugin/)可以附加到任何 dom 元素。该指令重新排序附加的事件处理程序，以便它可以控制何时限制事件。

您可以将它用于节流/去抖动 * 模型角度更新 * 角度事件处理程序 ng-[event] * jquery 事件处理程序

看看：http: [//jsfiddle.net/lgersman/vPsGb/3/](http://jsfiddle.net/lgersman/vPsGb/3/)

该指令将成为 Orangevolt Ampere 框架 ( [https://github.com/lgersman/jquery.orangevolt-ampere](https://github.com/lgersman/jquery.orangevolt-ampere) ) 的一部分。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-05-22T05:08:07.413

### 仅适用于此处重定向的用户：

如中所述，`Angular 1.3`您可以使用[ng-model-options](https://docs.angularjs.org/api/ng/directive/ngModelOptions)属性：

```
<input 
       id="searchText" 
       type="search" 
       placeholder="live search..." 
       ng-model="searchText"
       ng-model-options="{ debounce: 250 }"
/> 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-10-18T13:19:51.877

我相信解决这个问题的最好方法是使用 Ben Alman 的插件[jQuery throttle / debounce](http://benalman.com/projects/jquery-throttle-debounce-plugin/)。在我看来，没有必要延迟表单中每个字段的事件。

只需将您的 $scope.$watch 处理函数包装在 $.debounce 中，如下所示：

```
$scope.$watch("searchText", $.debounce(1000, function() {
    console.log($scope.searchText);
}), true); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-01-13T12:01:17.113

另一种解决方案是为模型更新添加延迟功能。简单的指令似乎起到了作用：

```
app.directive('delayedModel', function() {
    return {
        scope: {
            model: '=delayedModel'
        },
        link: function(scope, element, attrs) {

            element.val(scope.model);

            scope.$watch('model', function(newVal, oldVal) {
                if (newVal !== oldVal) {
                    element.val(scope.model);        
                }
            });

            var timeout;
            element.on('keyup paste search', function() {
                clearTimeout(timeout);
                timeout = setTimeout(function() {
                    scope.model = element[0].value;
                    element.val(scope.model);
                    scope.$apply();
                }, attrs.delay || 500);
            });
        }
    };
}); 
```

用法：

```
<input delayed-model="searchText" data-delay="500" id="searchText" type="search" placeholder="live search..." /> 
```

因此，您只需使用`delayed-model`并`ng-model`定义所需的`data-delay`.

### 演示：[http ://plnkr.co/edit/OmB4C3jtUD2Wjq5kzTSU?p=preview](http://plnkr.co/edit/OmB4C3jtUD2Wjq5kzTSU?p=preview)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-09-25T15:45:10.410

Angular 1.3 将有 ng-model-options debounce，但在那之前，你必须使用 Josue Ibarra 所说的计时器。然而，在他的代码中，他在每次按键时都会启动一个计时器。此外，他正在使用 setTimeout，而在 Angular 中，必须使用 $timeout 或在 setTimeout 结束时使用 $apply。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-03-19T20:47:44.270

我用一个指令解决了这个问题，基本上它的作用是将真正的 ng-model 绑定到我在指令中观察的特殊属性上，然后使用去抖动服务更新我的指令属性，因此用户观察变量他绑定到 debounce-model 而不是 ng-model。

```
.directive('debounceDelay', function ($compile, $debounce) {
return {
  replace: false,
  scope: {
    debounceModel: '='
  },
  link: function (scope, element, attr) {
    var delay= attr.debounceDelay;
    var applyFunc = function () {
      scope.debounceModel = scope.model;
    }
    scope.model = scope.debounceModel;
    scope.$watch('model', function(){
      $debounce(applyFunc, delay);
    });
    attr.$set('ngModel', 'model');
    element.removeAttr('debounce-delay'); // so the next $compile won't run it again!

   $compile(element)(scope);
  }
};
}); 
```

用法：

```
<input type="text" debounce-delay="1000" debounce-model="search"></input> 
```

在控制器中：

```
 $scope.search = "";
    $scope.$watch('search', function (newVal, oldVal) {
      if(newVal === oldVal){
        return;
      }else{ //do something meaningful } 
```

**jsfiddle 中的演示：http: [//jsfiddle.net/6K7Kd/37/](http://jsfiddle.net/6K7Kd/37/)**

$debounce 服务可以在这里找到：http: [//jsfiddle.net/Warspawn/6K7Kd/](http://jsfiddle.net/Warspawn/6K7Kd/)

**灵感来自 finallyBind 指令** [http://jsfiddle.net/fctZH/12/](http://jsfiddle.net/fctZH/12/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-04-03T07:04:05.587

为什么大家都想用手表？您还可以使用一个函数：

```
var tempArticleSearchTerm;
$scope.lookupArticle = function (val) {
    tempArticleSearchTerm = val;

    $timeout(function () {
        if (val == tempArticleSearchTerm) {
            //function you want to execute after 250ms, if the value as changed

        }
    }, 250);
}; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-03-15T09:13:36.067

我认为这里最简单的方法是预加载 json 或加载一次`$dirty`，然后过滤器搜索将处理其余部分。这将为您节省额外的 http 调用，并且使用预加载的数据更快。记忆会受伤，但这是值得的。

# sql - 如何在 Excel 中使用 SQL 连接

> ID：15304563
> 
> 赞同：2
> 
> 时间：2013-03-08T22:40:53.020
> 
> 标签：sql, excel, join

我看到一个大约一年前更新的问题，让我在找到我需要的解决方案方面走了很长一段路，但导致的问题多于答案。

首先让我说我不是 SQL（DB2、SQLServer、Oracle）的“新手”，但我是在 Excel 中使用 SQL 的相对“新手”。此外，我在 2010 年工作，但必须保持与 2003 年的兼容性。

我要做的是将一张表中的数据与另一张表匹配并报告异常。我想从“Open Lines”中挑选 6 列，并将它们与“Back Orders”中的 3 列相匹配，并且只显示例外情况。'Open Lines' 可以是 1..n，而 'Back Orders' 可以是 0..n。我只想抓住存在“延期交货”的行。

要编写普通的 SQL，我会这样做：

```
SELECT 
O.[Part Number], O.[Part Desc], O.[Source Domain], O.[Ship Qty], O.[Date Created],
B.[Dest Domain], B.[Quantity], B.[Date Created] 
FROM [OPEN LINES] O
JOIN [Back Orders] B ON O.[Part Number] = B.[Part Number]
WHERE B.[Part Number] IS NOT NULL
ORDER BY O.[Part Number] 
```

问题是我无法在没有错误的情况下通过连接。这就是我到目前为止所拥有的。

```
rs.Open "SELECT [OPEN LINES$].[Part Number], [OPEN LINES$].[Part Desc], " $ _
"[OPEN LINES$]. [Source Domain], " & _
"[OPEN LINES$].[Ship Qty], [OPEN LINES$].[Date Created] " & _
"FROM [OPEN LINES$] " & _
"JOIN [Back Orders$] ON [OPEN LINES$].[Part Number] = [Back Orders$].[Part Number] " & _
"ORDER BY [OPEN LINES$].[Part Number] ;", cn 
```

如果您能提供任何帮助，我将不胜感激。

戈德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:48:48.087

尝试这个：

```
rs.Open "SELECT [OPEN LINES$].[Part Number], [OPEN LINES$].[Part Desc], " $ _
    " [OPEN LINES$]. [Source Domain], " & _
    " [OPEN LINES$].[Ship Qty], [OPEN LINES$].[Date Created] " & _
    " FROM [OPEN LINES$], [Back Orders$] " & _
    " WHERE [OPEN LINES$].[Part Number] = [Back Orders$].[Part Number] " & _
    " ORDER BY [OPEN LINES$].[Part Number]", cn 
```

您不需要结束分号。

这是一个更简单的示例（在 XL2010 中测试）

```
Sub SqlJoin()

    Dim oConn As New ADODB.Connection
    Dim oRS As New ADODB.Recordset
    Dim sPath
    Dim sSQL As String

    sSQL = "select a.blah from <t1> a, <t2> b where a.blah = b.blah"

    sSQL = Replace(sSQL, "<t1>", Rangename(Sheet1.Range("A1:A5")))
    sSQL = Replace(sSQL, "<t2>", Rangename(Sheet1.Range("C1:C3")))

    If ActiveWorkbook.Path <> "" Then
      sPath = ActiveWorkbook.FullName
    Else
      MsgBox "Workbook being queried must be saved first..."
      Exit Sub
    End If

    oConn.Open "Provider=Microsoft.ACE.OLEDB.12.0;Data Source='" & sPath & "';" & _
                 "Extended Properties='Excel 12.0;HDR=Yes;IMEX=1';"

    oRS.Open sSQL, oConn

    If Not oRS.EOF Then
        Sheet1.Range("E1").CopyFromRecordset oRS
    Else
        MsgBox "No records found"
    End If

    oRS.Close
    oConn.Close

End Sub

Function Rangename(r As Range) As String
    Rangename = "[" & r.Parent.Name & "$" & _
                r.Address(False, False) & "]"
End Function 
```

# ipad - 惯性滚动时如何同步两个元素的滚动偏移量

> ID：15304568
> 
> 赞同：7
> 
> 时间：2013-03-08T22:41:10.400
> 
> 标签：ipad, scroll, mobile-safari, touchmove

我需要使一个元素的滚动偏移量与另一个元素（实际上是窗口）保持同步，而在移动 Safari（iPad）上滚动的惯性“滚降”阶段，我无法做到这一点。

我有几个 div，`position:fixed; overflow:hidden`我需要保持它们的滚动偏移与窗口的同步（意味着整个身体滚动。）通常我会这样编码（jQuery）：

```
var $win = $(window),
    $div1 = $(...)

$win.scroll(function() { 
    $div1.scrollTop($win.scrollTop())
}) 
```

但是在 iPad 上测试界面时，我注意到 div 在触摸阶段（用手指拖动虚拟页面时）都没有更新，也没有在惯性阶段（当您放手并且页面减速到一站。

我通过注册事件的处理程序以及`touchmove`事件处理程序来解决拖动阶段的问题`scroll`。

但是我找不到解决惯性阶段问题的方法。div 保持静止（并慢慢与页面的其余部分不同步），直到惯性运动完全停止，此时滚动事件最终被触发并跳入位置。

[**这是一个工作演示。**](http://www.gruppo4.com/scrolling_demo/demo.html)

尝试在 iPad 上滚动它以查看“惯性滑行”问题。不幸的是，由于 iPad 在 iframe 滚动方面的奇怪行为，我无法让它在 jsFiddle 上运行。

如果我可以在那个阶段运行轮询，我可以在两个元素之间保持同步。我已经尝试过`setTimeout`,`setInterval`和`requestAnimationFrame`，但在惯性滚动阶段它们都不会触发。似乎所有 Javascript 在那个阶段都停止了。

问题：

*   在惯性滚动阶段是否触发了任何触摸或滚动事件？
*   有**没有**办法在那个阶段运行 Javascript 回调？
*   有没有办法使用 CSS 或 JS 以外的其他技术同步两个元素（X 或 Y，不是两者）的滚动偏移量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-18T18:42:45.993

iOS 实际上在惯性滚动发生时冻结了 DOM 操作*和Javascript。*这是我制作的一个简单演示，用于说明在普通桌面环境中滚动与 iPad 之间的区别：http: [//jsfiddle.net/notjoelshapiro/LUcR6/](http://jsfiddle.net/notjoelshapiro/LUcR6/)。这段代码中只有这个 JS：

```
var num = 0;
function updateNum(){
    num++;
    $('#awesomeDiv').text(num);
}
$(window).scroll(updateNum); 
```

在滚动时，它会增加一个数字并将其显示在页面底部。您会看到屏幕底部的滚动编号仅在惯性滚动停止时才增加。如果 Javascript 在后台运行，它不会刷新，直到滚动结束，但数字应该增加得更高。

因此，具体回答您的问题：

> 在惯性滚动阶段是否触发了任何触摸或滚动事件？

负面的，幽灵骑士。

> 有没有办法在那个阶段运行 Javascript 回调？

往上看。

> 有没有办法使用 CSS 或 JS 以外的其他技术同步两个元素（X 或 Y，不是两者）的滚动偏移量？

不太清楚你在这里的意思，JS 可以做你需要的所有数学运算，但它必须在惯性滚动完成时完成。不过老实说，这可能是 tl;dr 的症状，因为我现在正在工作。

你看过[iScroll](http://cubiq.org/iscroll)库吗？它模拟触摸和非触摸环境的惯性（或非惯性）滚动，并在“滚动”和“惯性滚动”期间/之后为您提供 JS 回调，并提供大量信息可用于计算您在页。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-18T20:35:04.510

OldDrunkenSailor 击败我建议[iScroll](http://cubiq.org/iscroll-4)。

不幸的是，开箱即用的 iScroll 只是复制了与原生惯性滚动相同的问题——在惯性阶段没有事件处理。

这是带有猴子补丁的 iScroll 的演示版本，用于添加即使在惯性阶段也会触发的自定义事件：[https ://dl.dropbox.com/u/15943645/scrollingdemo.html](https://dl.dropbox.com/u/15943645/scrollingdemo.html)

在我的第二代 iPad 上运行良好。

JS：

```
// Disable touch events
document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);

// Patch iScroll for position change custom event
iScroll.prototype._oldPos = iScroll.prototype._pos;
iScroll.prototype._pos = function(x, y) {
    this._oldPos(x, y);
    if (this.options.onPositionChange) this.options.onPositionChange.call(this);
}

$(function() {
    var $win = $(window),
        $div_cols = $('#cols'),
        $div_rows = $('#rows'),
        $div_body = $('#body')

    // attach scrolling sync handler and execute it once
    function sync_scroll(e) {
        $div_cols.scrollLeft(0 - $div_body.position().left);
        $div_rows.scrollTop(0 - $div_body.position().top);

    }           

    // initialize iScroll on wrapper div, with position change handler
    var myScroll = new iScroll('iscroll_wrapper', {
        bounce: false,
        onPositionChange: sync_scroll
    });
}) 
```

CSS：

```
#iscroll_wrapper {
    position:absolute;
    z-index: 1;
    left: 168px; 
    top:77px; 
    bottom:0px; 
    right:0;
    overflow:auto;
}

#body {
    position:absolute;
    z-index: 1;
    width: 2046px; 
    height: 3376px;

} 
```

请注意，仅主体响应触摸事件，但您可以将该技术扩展到行和列 div 以实现反向关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T11:05:09.607

> 滚动开始时触发。请注意，iOS 设备在滚动期间冻结 DOM 操作，将它们排队以在滚动完成时应用。我们目前正在研究允许在滚动开始之前应用 DOM 操作的方法。

[http://jquerymobile.com/demos/1.0rc1/docs/api/events.html#/demos/1.0rc1/docs/api/events.html](http://jquerymobile.com/demos/1.0rc1/docs/api/events.html#/demos/1.0rc1/docs/api/events.html)

这就是他们在滚动开始部分所说的

# php - Opencart 选项 - 图像调整大小

> ID：15304574
> 
> 赞同：0
> 
> 时间：2013-03-08T22:41:34.983
> 
> 标签：php, image, resize, opencart, options

经过几个大的驼峰，我终于开始整理我的网站。我在调整图像大小时遇到​​问题。

控制图像大小的代码如下：

```
'image' => $this->model_tool_image->resize($option_value['image'], 285, 85), 
```

这使得所有图像都是 285 x 85。

我的问题是在自定义页面上我有 6x1 选项，3x 另一个等等。因此，我需要图像具有不同的大小，最好在重新加载后保持它们的比例（尽管图像实际上更大 - 即 855x255）。

我试过 $auto, max_width=100% （代替 285/85）等等，但没有效果。

我猜选项大小的控制将来自样式表，但是对于我的一生，经过 4 个小时的搜索，我找不到摆脱这段代码并让它按我希望的方式工作的方法。

除了样式表之外，我想不出另一种修改图像大小的方法，到目前为止，与“自动”（大小）的任何关系都是多余的！

在建议之前，资金绝对是 0。因此，我无法购买扩展程序/模组等。我提前道歉

进一步补充：此代码：

```
'image' => $this->model_tool_image->resize($option_value['image'], $width == $auto, $height == $auto), 
```

将图像恢复到原始大小，但出现错误：

“注意：未定义的变量：C:\xampp\htdocs\OC\vqmod\vqcache\vq2-catalog_controller_product_product.php 中的宽度在第 373 行”

这是上面的代码行（带有$auto）。

那么，我可以添加到我的图像控制器或其他东西，以允许对许多不同大小的图像进行多次调整，以提供一半大小的图像？

这是我正在尝试做的事情（以图像形式）

[http://imageshack.us/photo/my-images/152/optionsimages.png/](http://imageshack.us/photo/my-images/152/optionsimages.png/)

第二次编辑：

我已经玩了 3 天，并搜索了所有已知资源。为了帮助起见，这是代码：system/library/image.php

```
/**
*
*   @param width 
*   @param height
*   @param default char [default, w, h]
*                  default = scale with white space, 
*                  w = fill according to width, 
*                  h = fill according to height
*   
*/
public function resize($width = 0, $height = 0, $default = '') {
    if (!$this->info['width'] || !$this->info['height']) {
        return;
    }

    $xpos = 0;
    $ypos = 0;
    $scale = 1;

    $scale_w = $width / $this->info['width'];
    $scale_h = $height / $this->info['height'];

    if ($default == 'w') {
        $scale = $scale_w;
    } elseif ($default == 'h'){
        $scale = $scale_h;
    } else {
        $scale = min($scale_w, $scale_h);
    }

    if ($scale == 1 && $scale_h == $scale_w && $this->info['mime'] != 'image/png') {
        return;
    }

    $new_width = (int)($this->info['width'] * $scale);
    $new_height = (int)($this->info['height'] * $scale);            
    $xpos = (int)(($width - $new_width) / 2);
    $ypos = (int)(($height - $new_height) / 2);

    $image_old = $this->image;
    $this->image = imagecreatetruecolor($width, $height);

    if (isset($this->info['mime']) && $this->info['mime'] == 'image/png') {     
        imagealphablending($this->image, false);
        imagesavealpha($this->image, true);
        $background = imagecolorallocatealpha($this->image, 255, 255, 255, 127);
        imagecolortransparent($this->image, $background);
    } else {
        $background = imagecolorallocate($this->image, 255, 255, 255);
    }

    imagefilledrectangle($this->image, 0, 0, $width, $height, $background);

    imagecopyresampled($this->image, $image_old, $xpos, $ypos, 0, 0, $new_width,     $new_height, $this->info['width'], $this->info['height']);
    imagedestroy($image_old);

    $this->info['width']  = $width;
    $this->info['height'] = $height;
} 
```

由于某种原因，@param 中提到的“默认”根本无法访问！

帮助我 Stackoverflow，你是我唯一的希望

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T22:24:28.760

这个问题已经解决了：

[删除 OpenCart 中的图像调整比例](https://stackoverflow.com/questions/7081860/remove-the-image-resize-ratio-in-opencart)

我简单地将“max”元素设置为 1000，并通过 CSS 控制包含选项的元素，即 max-width 330px，并根据需要调整所有图像的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:24:34.667

OpenCart 使用缓存来存储所有不同大小的图像，不使用样式表，因此在您的自定义页面中，只需使用该功能创建新图像，该功能也保持比例。

```
$new_image = $this->model_tool_image->resize($option_value['image'], 855, 255); 
```

查看 ModelToolImage (front>>tool) 和 Image (library) 类，了解这些函数的作用。

更新：

看到你的更新，你不能这样做。

`'image' => $this->model_tool_image->resize($option_value['image'], $width == $auto, $height == $auto),`

您必须定义尺寸。举个小例子：

```
$sizes = array(
    '1' => array('w' => 255, 'h' => 85),
    '2' => array('w' => 200, 'h' => 200),
    '3' => array('w' => 350, 'h' => 150),
)

$images = array();

foreach ($sizes as $key => $size)
{
    $images[$key] = $this->model_tool_image->resize($option_value['image'], $size['w'], $size['h']);
} 
```

从这里你有一个数组 ($images) 填充了所有调整大小的图像，你可以使用它来填充模板 (.tpl)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T17:11:34.323

我试图添加这个问题 opencart master 分支，但没有被接受。这个（[https://gist.github.com/hkulekci/4503178](https://gist.github.com/hkulekci/4503178)）补丁是根据宽度或高度对图像进行比率。

在这个补丁中，有管理员设置、目录调整大小功能更新和所有图像调整大小功能更新。如果你不明白，你可以问任何东西。

编辑 ：

这个补丁有两个部分。第一个是管理员，第二个是目录。你不需要做管理部分。您应该只更改目录部分。在目录部分，首先，您应该更改`/upload/catalog/model/tool/image.php`和`/upload/system/library/image.php`文件如下（[https://gist.github.com/hkulekci/4503178#file-my4-patch-L14）（https://gist.github.com/hkulekci/4503178 #file-my4-patch-L50)](https://gist.github.com/hkulekci/4503178#file-my4-patch-L14)(https://gist.github.com/hkulekci/4503178#file-my4-patch-L50))

```
// '/upload/catalog/model/tool/image.php' file changes

// Find this line 
public function resize($filename, $width, $height) {

// Change it this
public function resize($filename, $width, $height, $type = "") {

// Find this
$new_image = 'cache/' . utf8_substr($filename, 0, utf8_strrpos($filename, '.')) . '-' . $width . 'x' . $height . '.' . $extension;

// Change this 
$new_image = 'cache/' . utf8_substr($filename, 0, utf8_strrpos($filename, '.')) . '-' . $width . 'x' . $height . $type .'.' . $extension;

// Find this 
$image->resize($width, $height);

// Change this 
$image->resize($width, $height, $type);

// '/upload/system/library/image.php' file changes

// Find this 
public function resize($width = 0, $height = 0) {

// Change this 
public function resize($width = 0, $height = 0, $type = "") {

// Find these lines 
$scale = min($scale_w, $scale_h);
if ($scale == 1 && $scale_h == $scale_w && $this->info['mime'] != 'image/png') {

// CHange these lines 
$scale = 1;
if ($type == "w"){
    $scale = $scale_w;
}else if ($type == "h"){
    $scale = $scale_h;
}else{
    $scale = min($scale_w, $scale_h);
}
if ( $scale == 1 && $scale_h == $scale_w && $this->info['mime'] != 'image/png' ) {
    return;
} 
```

示例用法：（[https://gist.github.com/hkulekci/4503178#file-my1-patch-L347](https://gist.github.com/hkulekci/4503178#file-my1-patch-L347)）

```
// At the end : 
// Comment for resize function 
/**
*
* @param width
* @param height
* @param type char [default, w, h]
* default = scale with white space,
* w = fill according to width,
* h = fill according to height
*
*/
$image = $this->model_tool_image->resize($product_info['image'], $this->config->get('config_image_wishlist_width'), $this->config->get('config_image_wishlist_height'), "w"); 
```

# jquery - 循环添加到 i ？

> ID：15304576
> 
> 赞同：0
> 
> 时间：2013-03-08T22:41:49.773
> 
> 标签：jquery

我有一个循环：

```
for (var i in $quizData['answers']) {

    $(".question"+(parseInt(i)+1)+" a").text($quizData['answers'][i]['answer']);

}; 
```

在循环中我需要向 i 添加一个 1，我已经通过 parseInt 实现了这一点，有没有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T22:50:13.223

你的代码完全没问题。没有“更好”的方法来做同样的事情。

javascript 中的对象键始终是一个字符串，无论您如何定义它。

例如：

```
var obj = { 1:"a", 2:"b"} 
```

最终会变成

```
{ "1":"a", "2":"b"} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:44:32.183

只需使用一个循环，然后`i + 1`如果第一个`i`以 0 开头：

```
for (var i = 0; i < $quizData.length; i++) {
    $(".question" + (i + 1) + " a").text($quizData['answers'][i]['answer']);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T22:53:29.117

如果 $quizData['answers'] 是一个数组，你可以这样做

```
$quizData['answers'].forEach(function(element,i){
    $(".question"+(i+1)+" a").text(element['answer']);
}); 
```

函数的第一个参数是元素，第二个是数组的索引

# java - java JFrame更新修改另一个JFrame

> ID：15304579
> 
> 赞同：0
> 
> 时间：2013-03-08T22:41:58.067
> 
> 标签：java, swing, jframe, actionlistener, repaint

我有一个屏幕 ( `JFrame`)，它从文件中获取一些初始人口。但是，如果文件由于某种原因不存在或未正确填充，则许多字段被阻止为不可编辑，并且用户被迫单击设置按钮，这会生成另一个`JFrame`屏幕。如果用户然后正确更新文件我希望原始屏幕重新填充新的文件数据，可以这样做吗？

所以我有一个设置按钮的动作监听器，它调用Java类“设置”。“设置”有一个“完成”按钮，它将激活数据库/文件更新，成功更新/将解锁原始框架

```
 btnSettings.setText("Settings");
    btnSettings.setFont(font4);
    btnSettings.setBounds(new Rectangle(15, 515, 140, 40));
    btnSettings.setToolTipText("Default Settings");
    btnSettings.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent evt) {
            settingsPerformed();
        }
    }) ;

private void settingsPerformed() {

    JFrame settings = new Settings();
    settings.setVisible(true);
} 
```

然后是一个新的设置类

公共类设置扩展 JFrame 实现 ActionListener {

```
private.....         
public Settings() {

    this.getContentPane().setLayout(null);
    this.setSize(new Dimension(450, 340));
    this.setTitle("Default Settings");

    this.setBackground(new Color(255, 247, 214));
    this.setResizable(true);
    this.setFont(font1);

    pnlSettingsData.setBounds(new Rectangle(10, 10, 405, 285));
    pnlSettingsData.setBorder(BorderFactory.createLineBorder(Color.blue, 1));
    pnlSettingsData.setName("Settings");
    pnlSettingsData.setLayout(null);  

    btnDone.setText("Done");
    btnDone.setFont(font3);
    btnDone.setBounds(new Rectangle(100, 250, 73, 20));
    btnDone.setToolTipText("Click when ready for updating");
    btnDone.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent evt) {
                    doneActionPerformed(evt);
                    setVisible(false) ;
            }
    });

    this.getContentPane().add(pnlSettingsData, null);            
    setDefaultCloseOperation(HIDE_ON_CLOSE);
    setLocation(150,200);
    //pack();
    setVisible(true);
}

private void doneActionPerformed(ActionEvent evt) { 

    // include here the data base updates      
}   

public void actionPerformed(ActionEvent e) {
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:46:46.647

你可以 ...

1.  使用模态 JDialog 从用户那里收集信息，当它关闭时，您可以从当前帧重新加载文件。
2.  允许第一帧注册一个动作监听第二帧，当调用时（大概是当用户单击接受按钮时），然后您将重新加载文件并更新 UI

# entity-framework - 计算多对多关系中的实体

> ID：15304583
> 
> 赞同：0
> 
> 时间：2013-03-08T22:42:20.537
> 
> 标签：entity-framework

我有一个用户实体如下：

```
public class User {
  public virtual ICollection<Role> Roles { get; set; }
} 
```

每个用户可以有一个或多个角色。我需要计算每个角色的用户数。

如果用户具有角色 Editor 和 Member，那么它将记为 Editor 1，Member 记为 1。

我怎样才能做到这一点？

谢谢你米格尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:01:08.167

我想我明白了......我试图通过用户来做到这一点，但我这样做了：

字典计数 = context.Roles.Select(x => new { x.Id, x.Users.Count }).ToDictionary(x => x.Id, x => x.Count)

你怎么看？有什么改进的建议吗？

谢谢你，米格尔

# python - CSRF 验证失败 - Django

> ID：15304593
> 
> 赞同：0
> 
> 时间：2013-03-08T22:42:56.870
> 
> 标签：python, django, web

我不知道如何解决这个 CSRF 失败。我已经包含了我一直在阅读的 {% csrf_token %} ，但它仍然给我这个错误。这是代码：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Log in</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <style>
        body{
        font-family:Arial,Helvetica,sans-serif;
            font-size: 12px;
        }
    </style>
    </head>
    <body>
        {{ state }}
        <form action="/login/" method="post">{% csrf_token %}
            {% if next %}
            <input type="hidden" name="next" value="{{ next }}" />
            {% endif %}
            username:
            <input type="text" name="username" value="{{ username}}" /><br />
            password:
            <input type="password" name="password" value="" /><br />

            <input type="submit" value="Log In" />
        </form>
    </body>
</html> 
```

我已经为此包含了所有适当的功能，但是如果您需要查看更多代码，请告诉我...我认为这就是所有适用的功能...

编辑：views.py

```
from django.shortcuts import render_to_response
from django.contrib.auth import *

def login_user(request):
  state = "Please log in below..."
  username = password = ''
  if request.POST:
      username = request.POST.get('username')
      password = request.POST.get('password')

      user = authenticate(username=username, password=password)
      if user is not None:
          if user.is_active:
              login(request, user)
              state = "You're successfully logged in!"
          else:
              state = "Your account is not active, please contact the site admin."
      else:
          state = "Your username and/or password were incorrect."

  return render_to_response('auth.html',{'state':state, 'username': username}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T01:08:48.513

您需要将令牌添加到模板上下文中，尝试类似的操作，并阅读问题评论中链接到的文档/教程。

```
from django.core.context_processors import csrf

def login_user(request):
    ...your code...
    ctx = {'state':state, 'username': username}
    ctx.update(csrf(request))
    return render_to_response('auth.html',ctx) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T05:01:43.997

在您看来，将 a 返回`context_instance`到模板如下

```
from django.template import RequestContext
def login_user(request):
    ...
    return render_to_response('auth.html',{'state':state, 'username':
     username},context_instance=RequestContext(request)) 
```

# sql-server - AppFabric 安装的 SQL Server 最低权限是什么？

> ID：15304596
> 
> 赞同：1
> 
> 时间：2013-03-08T22:43:04.913
> 
> 标签：sql-server, permissions, appfabric

我们正在尝试使用**SQL Server 2012 标准版**实例开发可重复的安装**AppFabric的过程。**

 **我授予用于安装 AppFabric`db_creator`服务器角色的 SQL Server 登录（使用 Windows 身份验证），因为 AppFabric 显然需要创建数据库。在安装 AppFabric 期间，他们收到错误：

> “对象‘sp_add_category’、数据库‘msdb’、模式‘dbo’的执行权限被拒绝。找不到存储过程‘ASInternal_ThrowError’。

当我将服务器角色授予登录时，我不能很好地授予`EXECUTE`数据库中不存在的存储过程。我一直无法找到有关 AppFabric 安装所需的最低 SQL Server 权限的任何文档。

我想我可以将 sysadmin 服务器角色授予该用户帐户，但我宁愿不这样做。**

# c# - 为登录服务器加密 TcpStream - 有必要吗？

> ID：15304597
> 
> 赞同：1
> 
> 时间：2013-03-08T22:43:05.043
> 
> 标签：c#, encryption, login, client-server

我正在编写一个需要安全登录的 C# .NET 应用程序。我已经拥有了在数据库中使用哈希和盐安全存储密码的必要功能，但是，我现在正从测试阶段开始。在开发之前（登录没有优先级），我只是直接连接到我的数据库。我知道这对于生产应用程序来说是不安全的，因为您公然将数据库凭据存储在代码中。相反，我选择创建一个简单的异步 TCP 套接字服务器，它侦听用户名，从数据库发送回 salt，然后客户端对输入的密码进行哈希处理（salt 临时存储在本地）并将其发送回服务器。然后服务器检查它们是否匹配；如果用户签出，则返回 true/false。

我已经进行了一些研究并研究了加密 TCP 连接，但是，这*真的有必要*吗，因为密码已经被散列了？还是有更好的整体做事方式？我愿意接受有关客户端/服务器架构应该如何工作的建议。登录在整个应用程序中并没有扮演*那么*重要的角色，但它将是生产级的，我不想把设计不佳的应用程序放在那里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:59:21.260

> 然后客户端对输入的密码进行哈希处理（盐暂时存储在本地）并将其发送回服务器。然后服务器**检查它们是否匹配**；如果用户签出，则返回 true/false。
> 
> 我已经做了一些研究并研究了加密 TCP 连接，但是，这真的有必要吗，因为密码已经被散列了？

所谓的“密码”并不重要，唯一重要的是**服务器**将接受什么作为有效凭据。如果您输入密码并且服务器在那里对其进行哈希处理（正如@Christian Stewart 在评论中建议的那样），那么您的密码就是您的凭据。如果您自己对密码进行加盐和哈希处理，并将结果发送到服务器，那么**此结果**将成为您的凭据。拦截它就像拦截原始密码+盐一样。

所以，是的，在通过它发送凭据之前，您还必须加密您的连接。[`SslStream`Class](http://msdn.microsoft.com/en-us/library/system.net.security.sslstream.aspx)似乎是最简单的方法（检查底部的示例代码，用于服务器和客户端），它同时支持服务器身份验证和可选的客户端身份验证（如果您还想限制哪些机器将有权访问登录服务器）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T00:14:13.897

1) 如果您要发送敏感数据，保护它的最简单方法是使用 SSL。如果这是一个内部项目，您可以生成自己的证书。此外，与您的 IT 人员讨论这是否是一个潜在问题。如果将其部署在正确配置的有线 Intranet 情况下，用户将无法看到彼此的流量。

2）您对盐和哈希的使用搞砸了，它不再解决它本来应该解决的问题。散列和加盐旨在使数据库的内容对攻击者没有帮助。这不是这里的情况，因为存储在数据库中的是服务器接受的作为身份验证令牌的内容。必须在服务器上进行散列，以便服务器通过网络接受的值不可逆（散列）和唯一（盐）转换为出现在用户存储中的值。现在确实，被攻击者无法反转它以获取用户的密码（即他们输入到您的客户端的密码）——这很好——但如果攻击者知道数据库中的值，他们就不需要密码。

3) 戴上攻击者的帽子。如果您看到您的身份验证交换发生，您是否能够在不知道秘密的情况下登录？是的，您只需发送客户端发送的最后一件事。所以这个频道应该是加密的。

4）如果可以避免，请不要编写自己的加密货币。如果可以避免，甚至不要管理用户。人们不想在他们使用的每个应用程序中管理用户和组——我说这是以前犯过这个错误的人。您可以使用 LDAP 或域身份验证之类的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T23:07:29.607

使用诸如魔兽世界使用的免费[SRP](http://en.wikipedia.org/wiki/Secure_remote_password_protocol)之类的协议，有一些方法可以在不传输密码的情况下通过服务器对用户进行身份验证。

SRP 将根据各方对密码的了解执行一系列挑战来验证用户身份，而不会将有关密码的敏感信息泄露给网络。

仍然使用 WoW 作为参考，有一些开源模拟器，例如[TrinityCore](https://github.com/TrinityCore/TrinityCore/)，它为您提供了 SRP 的可靠示例。

# android - 未调用 AsyncTask 例程

> ID：15304601
> 
> 赞同：0
> 
> 时间：2013-03-08T22:43:10.233
> 
> 标签：android, asynchronous, locationmanager

在从 Android MainActivity 中的地图例程获取 gps 坐标后，我正在尝试运行异步任务。异步任务是根据 gps 坐标执行 httpurlconnection 从我的服务器获取数据。但是，在我的调试过程中观察时，异步任务 GetRestaurant() 永远不会被调用。我应该提到，在调试器中，循环器例程被一遍又一遍地调用。在调试中，我注意到程序执行了 GetRestaurant 指令，但之后没有任何反应。班级永远达不到。地图确实会显示出来，仅此而已。谁能从下面的代码中看出为什么我的异步任务类 GetRestaurant 永远不会被执行？

```
locationManager.requestLocationUpdates(provider, 3600, 1000, new LocationListener() {

        public void onProviderDisabled(String provider) {}
        public void onProviderEnabled(String provider) {}
        public void onStatusChanged(String provider, int status, Bundle extras) {}

        public void onLocationChanged(Location loc) {
            if(loc != null) {
                lat = (float) (loc.getLatitude());
                lng = (float) (loc.getLongitude());

                String latLongString = "Lat:" + lat + "\nLong:" + lng;
                myLocationText.setText("Your current position is:\n" + latLongString);
                int latit = (int) (loc.getLatitude() * 1E6);
                int longit = (int) (loc.getLongitude() * 1E6);
                point = new GeoPoint(latit, longit);
                mapController.animateTo(point);
                mapController.setCenter(point);
                mapController.setZoom(15);
                String addr=getAddress(point);
                TextView addressView = (TextView) findViewById(R.id.address_view);
                addressView.setText(addr);
                MyOverlay mapOverlay = new MyOverlay();
                List<Overlay> overlayList=mapView.getOverlays();
                overlayList.clear();
                overlayList.add(mapOverlay);

                new GetRestaurant().execute();

            }

        }
    });

}

 class GetRestaurant extends AsyncTask<Void, Void, String[]> {
 @Override
    protected String[] doInBackground(Void...parameters ) {
        // TODO Auto-generated method stub

        String thislat = ((String.valueOf(lat)));
        String thislng = ((String.valueOf(lng)));
        String[] result = null;
        URL url;

         try {

            String query = "lat=" + thislat + "&lng=" + thislng + "&uid=&vegkey=1";
            url = new URL("http://10.0.2.2:8000/xxxxxxx/webservice/frontpage1.php?" + query);
            HttpURLConnection httpConnection = (HttpURLConnection) url.openConnection();
            int responseCode = httpConnection.getResponseCode();
            if(responseCode == HttpURLConnection.HTTP_OK) {
                InputStream in = httpConnection.getInputStream();
                BufferedReader br = new BufferedReader(
                    new InputStreamReader(in));

                StringBuilder sb = new StringBuilder();

                String line;
                int x=0;
                while ((line = br.readLine()) != null) {
                  //     sb.(line);
                    result[x] = line;
                    x++;
                } 

            }

        }

        catch (Exception e) {
            Toast.makeText(getApplicationContext(), e.toString(), Toast.LENGTH_SHORT).show();
            System.out.println(e.toString());
        }

    return result;
    }

    protected void onProgressUpdate(Integer... progress) {

    }
    @Override
    protected void onPostExecute(String[] result) {

        restaurants = result;
        final ArrayAdapter<String> arrayAdpt = new ArrayAdapter<String>(null, android.R.layout.simple_list_item_1, restaurants);
        restaurant_list.setAdapter(arrayAdpt);
        mapView.postInvalidate();

    }

  } 
```

这是我的错误日志：我注意到此错误：“无法在未调用 Looper.prepare() 的线程内创建处理程序。” 这听起来很可疑。

```
 03-08 23:53:27.846: E/AndroidRuntime(570): FATAL EXCEPTION: AsyncTask #1
 03-08 23:53:27.846: E/AndroidRuntime(570): java.lang.RuntimeException: An error occured while executing doInBackground()
 03-08 23:53:27.846: E/AndroidRuntime(570):     at android.os.AsyncTask$3.done(AsyncTask.java:299)
 03-08 23:53:27.846: E/AndroidRuntime(570):     at java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:352)
 03-08 23:53:27.846: E/AndroidRuntime(570):     at java.util.concurrent.FutureTask.setException(FutureTask.java:219)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at java.util.concurrent.FutureTask.run(FutureTask.java:239)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at java.lang.Thread.run(Thread.java:856)
  03-08 23:53:27.846: E/AndroidRuntime(570): Caused by: java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
  03-08 23:53:27.846: E/AndroidRuntime(570):    at android.os.Handler.<init>(Handler.java:197)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at android.os.Handler.<init>(Handler.java:111)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at android.widget.Toast$TN.<init>(Toast.java:324)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at android.widget.Toast.<init>(Toast.java:91)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at android.widget.Toast.makeText(Toast.java:238)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at com.example.herb4.MainActivity$GetRestaurant.doInBackground(MainActivity.java:159)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at com.example.herb4.MainActivity$GetRestaurant.doInBackground(MainActivity.java:1)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
  03-08 23:53:27.846: E/AndroidRuntime(570):    at java.util.concurrent.FutureTask.run(FutureTask.java:234)
  03-08 23:53:27.846: E/AndroidRuntime(570):    ... 4 more 
```

好的。我将代码更改为在 doInBackground 末尾读取 'return (String[]) result.toArray()。现在我收到以下错误：'03-09 03:24:18.796: E/AndroidRuntime(4726): Caused by: java.lang.ClassCastException: java.lang.Object[] cannot be cast to java.lang.String[ ]'。我认为错误发生在 onPostExecute 具有以下代码“

```
 @Override
    protected void onPostExecute(String[] result) {

    //  restaurants = result;
        final ArrayAdapter<String> arrayAdpt = new ArrayAdapter<String>(getApplicationContext(), android.R.layout.simple_list_item_1, result);
        restaurant_list.setAdapter(arrayAdpt);
        mapView.postInvalidate();

    } 
```

如果我可以在调试器中跟踪程序，这会容易得多，但在我到达问题区域之前它就退出了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:20:05.257

看看[这个答案](https://stackoverflow.com/questions/3875184/cant-create-handler-inside-thread-that-has-not-called-looper-prepare)。它解释了出现在您的 logcat 中的错误。如果您想清楚地了解自己的错误，请摆脱 Toast；您的 System.out 输出将显示在 logcat 中。

* * *

问题：在 doInBackground 你有

```
 String[] result = null; 
```

您在循环中使用它，无需初始化。我猜你的实际错误是你的空变量异常

```
result[x]=line; 
```

线。

扩展解决方案。我希望您能发现需要更改的地方：

```
 String line;
 List<String> result = new ArrayList<String>();
 int x=0;
 while ((line = br.readLine()) != null) {
 //     sb.(line);
     result.add(line);

 } 
 return (String[])(result.toArray()); 
```

# c# - 原始打印机驱动程序检索数据

> ID：15304602
> 
> 赞同：1
> 
> 时间：2013-03-08T22:43:11.660
> 
> 标签：c#, printing

我正在使用[http://support.microsoft.com/kb/322091](http://support.microsoft.com/kb/322091)上的代码将原始数据发送到 USB 打印机。该文档仅说明了如何发送数据，但某些打印机也会报告数据。

我想知道是否可以扩展该代码，因此它还会在从打印机接收到的数据上引发一个事件。我不知道这是否可能基于该代码的扩展。

```
 //something like
    [DllImport("winspool.Drv", EntryPoint = "ReadPrinter", SetLastError = true, ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
    public static extern bool ReadPrinter(IntPtr hPrinter, IntPtr pBytes, Int32 dwCount, out Int32 dwRead); 
```

# java - 琐事游戏的得分在第二场比赛后变得不准确

> ID：15304604
> 
> 赞同：1
> 
> 时间：2013-03-08T22:43:23.900
> 
> 标签：java, android, algorithm

我有一个有 10 个限时问题的问答游戏。一个错误的答案应该输出 0 分。正确的答案应该是输出 20,000 毫秒的剩余时间，转换为 100 分制。

目前该游戏适用于第一款游戏。然后，如果用户继续玩第二次，每个问题的分数就会变得不正确。例如，错误的答案开始有从 1 到 100 的各种分数，并且正确的答案有时有 0 分，有时也有错误的总分。所以我猜一些变量可能不会在第二场比赛中重置，所以它导致积分有点偏离。

我发布了所有处理算法的代码。我的问题是，无论用户在关闭应用程序之前玩了多少次，我如何才能让这段代码输出正确的答案。

QuestionView.java

```
public class QuestionView extends Activity  {

    int correctAnswers = 0;
    int wrongAnswers = 0;
    int answer = 0;
    int i = 0;

    long score = 0;

    long startTime = 20000;
    long interval = 1000;
    long points;

    boolean timerHasStarted = false;

    String category;

    Button answer1, answer2, answer3, answer4;
    TextView question, pointCounter, questionNumber, timeCounter, timeremaining;
    AdView adView;

    ArrayList<Question> queries;
    public static ArrayList<Long> pointsPerQuestion = new ArrayList<Long>(10);
    Timer cdTimer;

    ProgressBar bar;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.questionview);

        answer1 = (Button)findViewById(R.id.answer1);
        answer2 = (Button)findViewById(R.id.answer2);
        answer3 = (Button)findViewById(R.id.answer3);
        answer4 = (Button)findViewById(R.id.answer4);

        question = (TextView)findViewById(R.id.question);

        category = getIntent().getStringExtra("category");
        queries = getIntent().getParcelableArrayListExtra("queries");

        questionNumber = (TextView)findViewById(R.id.questionnumber);
        timeremaining = (TextView)findViewById(R.id.timeremaining);

        cdTimer = new Timer(startTime, interval);

        bar = (ProgressBar)findViewById(R.id.progressbar);
        bar.setIndeterminate(false);
        bar.setMax(20000);

        tracker.sendView("/QuestionView - Started Quiz");

        loadQuestion();
    }

    public void loadQuestion() {

        if(i == 10) {

            cdTimer.cancel();
            endQuiz();

        } else {

            if(!timerHasStarted) {
                cdTimer.start();
                timerHasStarted = true;
            } else {
                cdTimer.start();
                timerHasStarted = false;
            }

            answer = queries.get(i).getCorrectAnswer();

            question.setText(queries.get(i).getQuery());

            answer1.setText(queries.get(i).getA1());
            answer2.setText(queries.get(i).getA2());
            answer3.setText(queries.get(i).getA3());
            answer4.setText(queries.get(i).getA4());

            answer1.setOnClickListener(new OnClickListener() {
                public void onClick(View arg0) {
                    queries.get(i).setSelectedAnswer(0);
                    if(answer == 0) {
                        correctAnswers++;
                        correct();
                    } else {
                        wrongAnswers++;
                        incorrect();
                    }
                }
            });

            answer2.setOnClickListener(new OnClickListener() {
                public void onClick(View arg0) {
                    queries.get(i).setSelectedAnswer(1);
                    if(answer == 1) {
                        correctAnswers++;
                        correct();
                    } else {
                        wrongAnswers++;
                        incorrect();
                    }
                }
            });

            answer3.setOnClickListener(new OnClickListener() {
                public void onClick(View arg0) {
                    queries.get(i).setSelectedAnswer(2);
                    if(answer == 2) {
                        correctAnswers++;
                        correct();
                    } else {
                        wrongAnswers++;
                        incorrect();
                    }
                }
            });

            answer4.setOnClickListener(new OnClickListener() {
                public void onClick(View arg0) {
                    queries.get(i).setSelectedAnswer(3);
                    if(answer == 3) {
                        correctAnswers++;
                        correct();
                    } else {
                        wrongAnswers++;
                        incorrect();
                    }
                }
            });
        } 
    }

    public ArrayList<Question> getQueries() {
        return queries;
    }

    public static ArrayList<Long> getPointsPerQuestion() {
        return pointsPerQuestion;
    }

    public void correct() {
        pointsPerQuestion.add(points); 
        score = score + points;
        i++;
        loadQuestion();
    }

    public void incorrect() {
        long zero = 0;
        pointsPerQuestion.add(zero);
        i++;
        loadQuestion();
    }

    public class Timer extends CountDownTimer {

        public Timer(long startTime, long interval) {
            super(startTime, interval);
        }

        @Override
        public void onFinish() {
            points = 0;
            if(i >= 9) {
                cdTimer.cancel();
                pointsPerQuestion.add(points);
                endQuiz();
            } else {
                wrongAnswers++;
                incorrect();
            }
        }

        @Override
        public void onTick(long millisUntilFinished) {
            bar.setProgress((int) millisUntilFinished);
            points = millisUntilFinished / 200;
            timeremaining.setText("Score remaining: " + points);
            if(i < 10) {
                questionNumber.setText("Question " + (i + 1) + " of 10");
            }
        }
    }

    public void endQuiz() {
        Intent intent = new Intent(QuestionView.this, Results.class);
        intent.putExtra("correctAnswers", correctAnswers);
        intent.putExtra("wrongAnswers", wrongAnswers);
        intent.putExtra("score", score);
        intent.putExtra("pointsPerQuestion", pointsPerQuestion);
        intent.putParcelableArrayListExtra("queries", queries);
        intent.putExtra("category", category);
        startActivity(intent);
    }
} 
```

这是一个`Question`对象：

```
exodus.add(new Question("6th", "3rd", "5th", "4th", 2, "Name that plague:  All livestock dies", -1, "Exodus 9:6")); 
```

在我的`Results`班级中，显示每个问题的分数，这是显示分数的行：

```
scoreTV.setText("You received " + QuestionView.getPointsPerQuestion().get(x) + " out of a possible 100 points."); 
```

其他一切都在我`QuestionView`上面。如果您还需要其他东西，请告诉我。

前 3 个字符串是答案 A（索引 0）、B（索引 1）、C（索引 2）和 D（索引 3）。第一个 int 是正确答案。第 5 个字符串是问题。第二个整数设置为用户在测验期间选择的答案。最后的字符串是找到答案的圣经经文。

# android - Facebook 插件在 Phonegap Cordova 2.3.0 上失败

> ID：15304611
> 
> 赞同：0
> 
> 时间：2013-03-08T22:44:31.923
> 
> 标签：android, cordova, phonegap-plugins, cordova-2.0.0

尝试在 Android 上使用 Phonegap Cordova 2.3.0 的 Facebook 插件让我非常头疼

我已经安装了最后一个 Facebook Android SDK (3.0)，它运行良好，因为我能够启动示例并且它们工作。

但是我对Phonegap并不那么幸运，因为这些示例都不起作用，问题是在调用它时：

```
FB.login(
 function(response) {
     //NEVER FIRED !!
     alert(JSON.stringify(response));
     if (response.session) {
         alert('logged in');
     } else {
         alert('not logged in');
     }
  },
  { scope: "email" }
); 
```

当我单击登录按钮时，我调用 FB.login 并显示一个对话框，询问是否允许读取用户个人数据。当我单击“确定”时，对话框消失，没有其他任何反应。

我尝试调试插件（ConnectPlugin.java），我看到它正确调用了该方法：

```
public PluginResult execute(String action, JSONArray args, final String callbackId) 
```

并且所有参数似乎都有正确的值。当插件进行调用时，我得到了这个 JSON：

```
{Session state:CLOSED_LOGIN_FAILED, token:{AccessToken token:ACCESS_TOKEN_REMOVED permissions:[]}, appId:xxxxxxxx} 
```

在以下方法中：

```
onSessionStateChange(SessionState state, Exception exception) 
```

我不明白问题出在哪里......这段代码是 CLOSED_LOGIN_FAILED 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:18:16.293

嗯，解决方法太琐碎了，我惭愧……我没有在Facebook App配置上设置Android部分！

# jquery - Internet Explorer 9 中的 qTip 问题

> ID：15304614
> 
> 赞同：0
> 
> 时间：2013-03-08T22:44:38.707
> 
> 标签：jquery, internet-explorer-9, qtip2

我正在使用 qTip2 插件，但在使用 Internet Explorer 9 时遇到了一些问题。在 Chrome 中运行良好。

这是一个[小提琴](http://jsfiddle.net/jeljeljel/KPusE/)。

有人可以向我解释为什么它不能在 IE 中加载吗？

**HTML**

```
<div id="tooltip">Here is a tooltip</div> 
```

**JS**

```
$('#tooltip').qtip({
    content: 'little big town',
    hide: {
        fixed: true,
        delay: 200
    }
}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T22:48:01.477

不要直接包含来自 github 的资源。

> SEC7112：来自[https://raw.github.com/Craga89/qTip2/master/dist/jquery.qtip.js](https://raw.github.com/Craga89/qTip2/master/dist/jquery.qtip.js)的脚本由于 mime 类型不匹配而被阻止

将其直接添加到 JavaScript 窗格即可。

# c# - 网络API。在继承的情况下使用 Ninject 进行依赖注入

> ID：15304616
> 
> 赞同：0
> 
> 时间：2013-03-08T22:44:51.970
> 
> 标签：c#, dependency-injection, asp.net-web-api, ninject

我对**ASP.NET WebApi**项目还很陌生，但希望我能把一切都说清楚。在创建了几个 CRUD 控制器之后，我想到了一个绝妙的主意 - 为所有这些控制器编写通用的基本 CRUD-web-API 控制器，并且不要混淆重写相同的代码。
在成功实现此类后，我遇到了依赖解析的问题，这对于非泛型/继承的控制器仍然可以正常工作。
简单请求（GET、POST 等）给出：
**`Type 'UsersController' does not have a default constructor","ExceptionType":"System.ArgumentException"`**

没有注入的默认构造函数工作正常。显然我对 Ninject 配置有疑问。

```
public abstract class BaseCRUDController<T> : ApiController where T : class, IClientEntity 
   {
      private readonly Repository<T> _repo;
      private readonly IDbContextDataProvider _context;

      // With this ctor everything works well
      public BaseCRUDController()
      {
         this._context = new ModelContext();
         this._repo = new Repository<T>(this._context);
      }

      // Injection is not working ((
      public BaseCRUDController(IDbContextDataProvider context)
      {
         this._context = context;
         this._repo = new Repository<T>(context);
      } 
```

具体`Controller`的`User`实体：

```
public class UsersController : BaseCRUDController<User>
{      
  UsersController(IDbContextDataProvider context) : base(context) { }

  UsersController() : base() { }
} 
```

和 Ninject 配置本身：

```
public class DataProviderModule : NinjectModule
{
  public override void Load()
  {
     this.Bind<IDbContextDataProvider>().To<ModelContext>().InSingletonScope();
  }
}
public class NinjectResolver
{
  // Instantinate Ninject dependencies resolver
  public static System.Web.Http.Dependencies.IDependencyResolver GetConfiguredDependencyResolver()
  {
     IKernel kernel = new StandardKernel(new DataProviderModule());
     System.Web.Http.Dependencies.IDependencyResolver njResolver = new NinjectResolver(kernel);
     return njResolver;
  }
} 
```

和`Application_Start`

```
protected void Application_Start()
{
    AreaRegistration.RegisterAllAreas();

    var config = GlobalConfiguration.Configuration;
    config.DependencyResolver = NinjectResolver.GetConfiguredDependencyResolver();

    WebApiConfig.Register(config); 
```

我在这里做错了什么？

* * *

注意：如果我有，这种方法效果很好：

```
public class UsersController : ApiController
{      
  UsersController(IDbContextDataProvider context)
  {
     .... 
  }    

... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T21:39:59.967

哦..我花了几个小时尝试不同的方法。那是疯狂。这里有趣的部分`Ninject`是运行良好，代码是正确的，除了一个可访问性修饰符。向ctor添加`public`修饰符解决了这个问题。`UsersController`

```
public class UsersController : BaseCRUDController<User>
{      
  public UsersController(IDbContextDataProvider context) : base(context) { }

... 
```

*PS。仔细写你的代码...*

# python - 使用容器添加列表

> ID：15304624
> 
> 赞同：-1
> 
> 时间：2013-03-08T22:45:43.760
> 
> 标签：python

我怎样才能在 Python 中做到这一点？ [组合词频数据列表](https://stackoverflow.com/questions/7875995/combining-lists-of-word-frequency-data)

假设我有两个列表 A 和 B 并且都包含按频率降序排列的文件的单词和频率，我该怎么做 Python 中的问题？

```
from FrequentWords import *
from WordFrequencies import * # makes the list with words&frequencies 
L = WordFrequencies('file.txt')
words1 = L[0]
freqs1 = L[1]
L1 = computeWordFrequencies('file1.txt')
words2 = L1[0]
freqs2 = L1[1]
words = zip(*sorted(zip(L,L1)))
both1 = sorted(freqs1+freqs2,reverse=True)
common_words = set(words1) & set(words2)
frequency_common_words = both1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:51:11.147

我会使用`collections.Counter`：

```
>>> from collections import Counter
>>> c = Counter()
>>> a = {'a': 2, 'b': 3}
>>> b = {'b': 3, 'c': 4}
>>> c.update(a)
>>> c.update(b)
>>> c
    Counter({'b': 6, 'c': 4, 'a': 2}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:50:53.100

如果您的起始数据在字典中，则可行：

```
output_dict = {}
for k, v in first_dict:
    if k in second_dict:
        v = v + second_dict[k]
    output_dict[k] = v

for k, v in second_dict:
    if k not in first_dict:
        output_dict[k] = v 
```

# c - “版本化符号没有符号版本部分”

> ID：15304627
> 
> 赞同：2
> 
> 时间：2013-03-08T22:46:25.823
> 
> 标签：c, linux, gcc, curl, cross-compiling

我正在尝试将我自己的共享库 (libmystuff.so) 与另一个使用 libcurl 共享库的共享库 (libtheirstuff.so) 交叉编译，但出现以下错误：

```
libmystuff.so: No symbol version section for versioned symbol 
'curl_global_init@@CURL_OPENSSL_3' 
```

然后是：

```
final link failed: Nonrepresentable section on output. 
```

通过创建 libtheirstuff 的代码，我可以看到 curl_global_init 是对 curl 的第一个引用。

在目标平台（ arm5 `ldd libtheirstuff.so`）上做表明它可以找到所有的引用。

这里发生了什么？

编辑：这是对 gcc 的调用

```
arm-none-linux-gnueabi-gcc -fPIC -c mystuff_impl.c -o mystuff_impl.o -I/home/me/arm/include
arm-none-linux-gnueabi-gcc -shared -Wl,soname=libmystuff.so -o libmystuff.so.0.1 mystuff_impl.o -L/home/me/arm/lib -ltheirstuff 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T04:19:57.313

链接器抓取了错误的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-14T16:26:50.223

`No symbol version section for versioned symbol 'curl_global_init@@CURL_OPENSSL_3'`当您尝试编译可在多个 Linux 发行版上运行的二进制文件时，也会出现此问题 ( )。您可以像这样检查问题：

```
$ objdump -x mybinary | grep curl_global_init
0... F *UND*  0... curl_global_init@@CURL_OPENSSL_3 
```

这种情况下的解决方案是在 libcurl 已经编译过的机器上构建`./configure --disable-versioned-symbols`。以这种方式编译的二进制文件将在其他地方工作（包括在使用版本符号的系统上）。一个可移植的二进制文件应该产生这样的输出（没有任何`@`符号）：

```
$ objdump -x mybinary | grep curl_global_init
0... F *UND*  0... curl_global_init 
```

# iphone - 如何复制 UINavigationBar 的渐变色？

> ID：15304629
> 
> 赞同：5
> 
> 时间：2013-03-08T22:46:38.727
> 
> 标签：iphone, ios, cocoa

我一直在尝试复制渐变，`UINavigationBar`以用作`UIButton`同一视图上自定义子类对象的渐变。

但是，我无法弄清楚颜色是如何派生的？也就是说，您只指定一种颜色来设置 a`UINavigationBar`的背景颜色`tintColor`- 但它创建了一个漂亮的渐变，看起来至少有 4 种颜色？

不过，我真的只是对“内部”顶部和底部颜色感兴趣——就在条形周围的 1px 边框内……虽然外部“边框”颜色确实看起来不同。

**编辑 - 1**

经过进一步研究，似乎 HSB（而不是最初认为的 RBG）值被操纵以获得这些不同的颜色。

还有一种方便的方法`UIColor`可以获取 HSB 值，这应该会有所帮助：

```
getHue:saturation:brightness:alpha: 
```

**迄今为止发现的有用参考资料**

[HSL 和 HSV 维基](http://en.wikipedia.org/wiki/HSL_and_HSV#Color-making_attributes)

[UIColor 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIColor_Class/Reference/Reference.html)

[以编程方式淡化颜色](https://stackoverflow.com/questions/141855/programmatically-lighten-a-color)

[摘自《*交互式计算机图形学基础》一书*](http://marcocorvi.altervista.org/games/imgpr/rgb-hsl.htm)

**编辑 - 2**

如果您不知道可以以`UIButton`编程方式为背景设置渐变，这里有一些关于如何执行此操作的参考：

[有趣的 UI 按钮和核心动画层](http://www.cimgf.com/2010/01/28/fun-with-uibuttons-and-core-animation-layers/)

[创建时尚 UIButtons 的五个技巧](http://mobile.tutsplus.com/tutorials/iphone/custom-uibutton_iphone/)（感谢 @cdo 提供此链接）

**编辑 - 3**

我整理了一个电子表格，显示了 HSB 值中的原始和“内部”渐变颜色（不考虑最外面的颜色）`UINavigationBar`及其相应的“后退”按钮（标题无关紧要，始终显示为白色）。

这是 Google 文档的链接，其中包含我为一些示例颜色收集的信息：

[https://docs.google.com/spreadsheet/ccc?key=0AnKVtzkNS9scdGVRN01pa1NQcC1hdThNbEVzQU8wRlE&usp=sharing](https://docs.google.com/spreadsheet/ccc?key=0AnKVtzkNS9scdGVRN01pa1NQcC1hdThNbEVzQU8wRlE&usp=sharing)

注意：这些值是通过使用针对 iOS 6.1 的 3.5 英寸 iPhone 模拟器（Xcode 版本 4.6）保存屏幕截图并使用 PhotoShop 观察 HSB 值而找到的。

**赏金标准**

我已经在这个问题上开了一个赏金，以带来更多的曝光率，并希望得到一个好的答案。我正在寻找的答案：

提供一种计算/近似（在大多数情况下）设置 a `tintColor`on后创建的“内顶部”和“内底部”渐变颜色（参见电子表格）的 RGB 或 HSB 值的方法`UINavigationBar`。

如果您还提供了一种计算“后退”按钮（类似于导航栏，但我发现了这些颜色通常看起来稍微“更暗”）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-11T20:16:54.437

简短答案：它不是渐变

长答案：应用着色颜色后，会在其顶部呈现透明的叠加图像。

它被称为：UITintedTopBarHighlight@2x.png 它在 UIKit 艺术品中。（在这里上传：http: [//cl.ly/image/2c2V3t1D1T3L](http://cl.ly/image/2c2V3t1D1T3L)）

它是 2x88 像素的图像，必须在有色背景上水平重复。

对于后退按钮，它非常相似，但也有一个遮罩来赋予它的形状。UItintedBackButtonHighlight 和 UItintedBackButtonMask。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T10:24:32.887

很难复制确切的行为，因为 Apple 似乎在为不同的颜色组计算不同的值。例如。浅色略微变暗，而深色则亮起。

栏按钮项也是如此。对于某些颜色，普通“带边框”按钮和“完成”样式按钮的区别是完全不同的。有时不像绿松石那样引人注目，但对于橙色来说绝对是可见的。

为了创建这个示例代码，我使用了[PaintCode](http://www.paintcodeapp.com/)一个很好的原型设计工具。
将这个代码复制到`UIView`子类或其他东西中。或者只是获取您需要的代码。

```
- (void)drawRect:(CGRect)rect
{
    //// General Declarations
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    CGContextRef context = UIGraphicsGetCurrentContext();

    //// Color Declarations
    UIColor* tint = [UIColor colorWithRed: 1 green: 0.66 blue: 0.329 alpha: 1];
    CGFloat tintRGBA[4];
    [tint getRed: &tintRGBA[0] green: &tintRGBA[1] blue: &tintRGBA[2] alpha: &tintRGBA[3]];

    UIColor* lighter = [UIColor colorWithRed: (tintRGBA[0] * 0.58 + 0.42) green: (tintRGBA[1] * 0.58 + 0.42) blue: (tintRGBA[2] * 0.58 + 0.42) alpha: (tintRGBA[3] * 0.58 + 0.42)];
    CGFloat lighterRGBA[4];
    [lighter getRed: &lighterRGBA[0] green: &lighterRGBA[1] blue: &lighterRGBA[2] alpha: &lighterRGBA[3]];

    UIColor* lightest = [UIColor colorWithRed: (lighterRGBA[0] * 0.55 + 0.45) green: (lighterRGBA[1] * 0.55 + 0.45) blue: (lighterRGBA[2] * 0.55 + 0.45) alpha: (lighterRGBA[3] * 0.55 + 0.45)];
    UIColor* darker = [UIColor colorWithRed: (tintRGBA[0] * 0.92) green: (tintRGBA[1] * 0.92) blue: (tintRGBA[2] * 0.92) alpha: (tintRGBA[3] * 0.92 + 0.08)];
    CGFloat darkerRGBA[4];
    [darker getRed: &darkerRGBA[0] green: &darkerRGBA[1] blue: &darkerRGBA[2] alpha: &darkerRGBA[3]];

    UIColor* darkest = [UIColor colorWithRed: (darkerRGBA[0] * 0.65) green: (darkerRGBA[1] * 0.65) blue: (darkerRGBA[2] * 0.65) alpha: (darkerRGBA[3] * 0.65 + 0.35)];

    //// Gradient Declarations
    NSArray* gradientColors = [NSArray arrayWithObjects:
                               (id)lighter.CGColor,
                               (id)darker.CGColor, nil];
    CGFloat gradientLocations[] = {0, 1};
    CGGradientRef gradient = CGGradientCreateWithColors(colorSpace, (__bridge CFArrayRef)gradientColors, gradientLocations);

    //// top Drawing
    UIBezierPath* topPath = [UIBezierPath bezierPathWithRect: CGRectMake(0, 0, rect.size.width, 1)];
    [lightest setFill];
    [topPath fill];

    //// theGradient Drawing
    UIBezierPath* theGradientPath = [UIBezierPath bezierPathWithRect: CGRectMake(0, 1, rect.size.width, rect.size.height - 1.0f)];
    CGContextSaveGState(context);
    [theGradientPath addClip];
    CGContextDrawLinearGradient(context, gradient, CGPointMake(50, 1), CGPointMake(50, rect.size.height-1.0f), 0);
    CGContextRestoreGState(context);

    //// bottom Drawing
    UIBezierPath* bottomPath = [UIBezierPath bezierPathWithRect: CGRectMake(0, rect.size.height-1.0f, rect.size.width, 1)];
    [darkest setFill];
    [bottomPath fill];

    //// Cleanup
    CGGradientRelease(gradient);
    CGColorSpaceRelease(colorSpace);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T02:46:02.923

感谢您提出的好问题和慷慨的赏金。我去解决这个问题，却忽略了检查它是否已经得到了可以接受的回答。尽管如此，构建和测试以下导航栏类别还是很有趣的，它揭示了它的颜色......

```
//
//  UINavigationBar+colors.h

#import <UIKit/UIKit.h>

@interface UINavigationBar (Colors)

// Answer an array of colors representing the color of the reciever, starting at fromY, up to toY
- (NSArray *)colorsFromY:(NSUInteger)fromY to:(NSUInteger)toY;

@end 
```

与 QuartzCore.framework 链接。

```
//
//  UINavigationBar+colors.m

#import "UINavigationBar+colors.h"
#import <QuartzCore/QuartzCore.h>

#define UIIMAGE_BYTES_PER_PIXEL 4u

@implementation UINavigationBar (Colors)

+ (NSData *)dataFromImage:(UIImage *)image {

    CGImageRef imageRef = [image CGImage];
    NSUInteger width = CGImageGetWidth(imageRef);
    NSUInteger height = CGImageGetHeight(imageRef);
    CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB();
    NSUInteger dataSize = height * width * UIIMAGE_BYTES_PER_PIXEL;
    unsigned char *rawData = malloc(dataSize);
    NSUInteger bytesPerRow = width * UIIMAGE_BYTES_PER_PIXEL;
    NSUInteger bitsPerComponent = 8;
    CGContextRef context = CGBitmapContextCreate(rawData, width, height,
                                                 bitsPerComponent, bytesPerRow, colorSpace,
                                                 kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big);
    CGColorSpaceRelease(colorSpace);

    CGContextDrawImage(context, CGRectMake(0, 0, width, height), imageRef);
    CGContextRelease(context);

    NSData *rtn = [NSData dataWithBytes:rawData length:dataSize];
    free(rawData);
    return rtn;
}

+ (UIColor *)colorOfImage:(UIImage *)image atX:(NSUInteger)px atY:(NSUInteger)py  {

    NSData *imgData = [self dataFromImage:image];
    if (!imgData) return nil;

    NSUInteger byteIndex = UIIMAGE_BYTES_PER_PIXEL * (image.size.width * py + px);

    unsigned char rgbaData[4];
    NSRange range = { byteIndex, 4u };
    [imgData getBytes:rgbaData range:range];
    CGFloat red   = rgbaData[0] / 255.0;
    CGFloat green = rgbaData[1] / 255.0;
    CGFloat blue  = rgbaData[2] / 255.0;
    CGFloat alpha = rgbaData[3] / 255.0;

    return [UIColor colorWithRed:red green:green blue:blue alpha:alpha];
}

- (UIImage *)asImage {

    UIGraphicsBeginImageContextWithOptions(self.bounds.size, self.opaque, 0.0);
    [self.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage * img = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    return img;
}

- (NSArray *)colorsFromY:(NSUInteger)fromY to:(NSUInteger)toY {

    NSMutableArray *answer = [NSMutableArray array];
    UIImage *image = [self asImage];

    for (NSUInteger y = MAX(0, fromY); y < MIN(self.bounds.size.height, toY); y++) {
        [answer addObject:[self.class colorOfImage:image atX:1 atY:y]];
    }
    return [NSArray arrayWithArray:answer];
}

@end 
```

像这样称呼它：

```
// from a view controller contained by a navigation controller...
UINavigationBar *bar = self.navigationController.navigationBar;

NSArray *colors = [bar colorsFromY:0 to:bar.bounds.size.height];
for (UIColor *color in colors) {
    NSLog(@"%@", color);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-09T02:14:14.623

UIButton 采用单个`tintColor`属性，但这并不意味着它不计算在幕后渐变中使用的其他颜色。[试试这个教程](http://mobile.tutsplus.com/tutorials/iphone/custom-uibutton_iphone/)。

# linux - 如何知道 crontab 中的任务是否实际执行

> ID：15304630
> 
> 赞同：-1
> 
> 时间：2013-03-08T22:46:45.370
> 
> 标签：linux, crontab

我有一个应该由 crontab 执行的脚本。如果任务被编程为在几个小时前执行，我现在如何验证这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:51:50.647

您应该通过在您的 cron 之前添加一个来修改您的 crontab 文件，`MAILTO=<your email here>`以便您将通过电子邮件收到执行结果。这不会解决您知道脚本是否在过去执行过的问题，但它可以帮助您在将来避免这个问题。为确保您收到电子邮件，只需`echo "Running script!"`在脚本顶部添加一行。

# paypal-sandbox - 无法登录新的沙盒帐户

> ID：15304632
> 
> 赞同：1
> 
> 时间：2013-03-08T22:46:49.253
> 
> 标签：paypal-sandbox

我刚刚创建了一个新的 Paypal 开发者帐户并将一个新的沙盒买家帐户关联到它。一个辅导员帐户被自动创建。

但是，我无法使用沙盒买家的凭据登录沙盒。我已经尝试更改密码并清除我的 cookie 和缓存，但仍然没有运气。

促进者帐户的凭据在沙盒中也不起作用。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:07:34.890

如果您使用的是“旧”版本的沙盒，则需要先清除缓存和 cookie，然后才能登录。

如果不这样做，您将收到以下错误消息。

“此沙盒电子邮件地址不可用。请输入另一个电子邮件地址。”

如果您继续收到密码错误，请尝试按照以下步骤重置帐户的密码：

```
Log into https://developer.paypal.com
Click Applications
Click Sandbox accounts
Expand the account in question
Click "Profile"
Click "Change Password" 
```

# c# - 使用 WCF 服务打印信息

> ID：15304646
> 
> 赞同：0
> 
> 时间：2013-03-08T22:48:40.407
> 
> 标签：c#, winforms, wcf, printing

我是 web 服务的新手，特别是 WCF 服务，但我处理得很好。我的情况如下：我有一个调用 WCF 服务的客户端应用程序，显然是 WCF 服务。一切正常，但我现在需要打印，这就是我卡住的地方。我想要的是调用 WCF 服务来打印发票的客户端应用程序。我想为他们使用 .rdlc 报告。但我不知道如何将它们传递给客户端应用程序。正如我所说，我需要的是传递所有准备打印的信息，因此客户端应用程序无法更改任何内容。只是打印。

我需要一些关于如何实现这一目标的帮助或建议。如果没有其他办法，我可能会在客户端应用程序中创建 rdlc，但我真的想避免这种情况。

以防万一，我的客户端应用程序是一个 Winform 应用程序，我使用的是 C#、Entity framework 4 和 .NET 4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T22:27:23.667

您可以让您的服务将 RDLC 转换为 PDF 并将 PDF 作为字节数组发送到您的 WCF 客户端。然后，客户端可以将字节数组保存为临时文件目录中的 .pdf 文件，然后要求操作系统启动注册用于处理 PDF 的默认应用程序（acrobat，...）。

例如，这是我在我的 MVVM 视图模型中为 WPF 客户端下载、保存和启动 PDF 报告的方法。服务器发送一个 ReportDTO，其中 Report 为字节数组，以及 FileName（扩展名为“.pdf”的报告名称）：

```
[DataContract(Name="ReportDTO", Namespace="http://chasmx/2013/2")]
public sealed class ReportDTO
{
    /// <summary>
    /// Filename to save the report attached in <see cref="@Report"/> under.
    /// </summary>
    [DataMember]
    public String FileName { get; set; }

    /// <summary>
    /// Report as a byte array.
    /// </summary>
    [DataMember]
    public byte[] @Report { get; set; }

    /// <summary>
    /// Mimetype of the report attached in <see cref="@Report"/>. This can be used to launch the application registered for this mime type to view the saved report.
    /// </summary>
    [DataMember]
    public String MimeType { get; set; }
}

public void ViewReport()
{
    ServiceContracts.DataContract.ReportDTO report;
    String filename;

    this.Cursor = Cursors.Wait;
    try
    {
        // Download the report.
        report = _reportService.GetReport(this.SelectedReport.ID);

        // Save the report in the temporary directory
        filename = Path.Combine(Path.GetTempPath(), report.FileName);
        try
        {
            File.WriteAllBytes(filename, report.Report);
        }
        catch (Exception e)
        {
            string detailMessage = "There was a problem saving the report as '" + filename + "': " + e.Message;
            _userInteractionService.AskUser(String.Format("Saving report to local disk failed."), detailMessage, MessageBoxButtons.OK, MessageBoxImage.Error);
            return;
        }
    }
    finally
    {
        this.Cursor = null;
    }

    System.Diagnostics.Process.Start(filename); // The OS will figure out which app to open the file with.
} 
```

这使您可以将所有报告定义保留在服务器上，并将 WCF 接口简化为客户端，以提供 PDF 字节数组。

# c++ - C ++排序向量字符串不起作用

> ID：15304647
> 
> 赞同：2
> 
> 时间：2013-03-08T22:49:00.380
> 
> 标签：c++, string, vector, compare

出于某种原因，我无法正确获得这种名称。谁能告诉我它有什么问题？据我所知，问题是没有正确比较字符串。我之前尝试过字符串比较，我知道这种代码应该可以工作。这真的让我难过。

```
#include <iostream>
#include <fstream>
#include <string>
#include <vector>

using namespace std;

void sortNames(vector<string> &);

void main()
{
    vector<string> namesList;
    ifstream namesFile;
    namesFile.open("Names.txt");

    // Make sure the file exists.
    if (namesFile)
    {
        // Get the names from the file.
        string name;
        while (getline(namesFile, name))
            namesList.push_back(name);

        // Sort the imported names.
        sortNames(namesList);

        for (int i = 0; i < namesList.size(); i++)
            cout << namesList[i] << endl;
    }
    else
    {
        cout << "Data files are missing";
    }

    namesFile.close();
}

void sortNames(vector<string> &list)
{
    for (int i = 0; i < list.size(); i++)
    {
        // Find the lowest value after i.
        int lowIndex = i;
        for (int j = i + 1; j < list.size(); j++)
        {
            string name = list[i];
            string name2 = list[j];

            if (name > name2)
                lowIndex = j;
        }

        // Flip the elements if there was a value lower than i.
        if (i != lowIndex)
        {
            string temp = list[i];
            list[i] = list[lowIndex];
            list[lowIndex] = temp;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T22:53:03.547

这是问题所在：这条线

```
string name = list[i]; 
```

应该

```
string name = list[lowIndex]; 
```

您当前的实现`j`不是将 at 的元素与您迄今为止找到的最小字符串进行比较，而是将其与 index 的字符串进行比较`i`。这是不正确的，因为它没有找到最小的剩余字符串：相反，它会`vector`在 index 中找到小于当前元素的最后一个字符串`i`，这不是您想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:54:02.453

而不是`string name = list[i];`，你想要`string name = list[lowIndex];`

# sql - Oracle SQL Developer 3.1.07 使用 listagg 的字符之间的额外空格

> ID：15304648
> 
> 赞同：13
> 
> 时间：2013-03-08T22:49:03.030
> 
> 标签：sql, oracle, oracle11g

我在 11g 数据库上使用 SQL Developer 3.1.07 当我使用 listagg 从字段中提取多个值时，我在 listagg 列的结果中的每个字符之间得到一个空格。该查询返回我希望看到的所有值，只是多余的空格让我抓狂。有什么想法吗？

这是我使用过的一个查询，但每次我在查询中使用 listagg 时都会发生这种情况：

```
select a.personnum Emp_ID
      , a.personfullname Name
      , a.companyhiredtm Hire_Date
      , a.employmentstatus Status
      , a.employmentstatusdt Status_Date
      , h.Supervisor, h.Agency 
from vp_employeev42 a
  left outer join (select f.personid
                           , listagg (g.personcstmdatatxt, ',') within group  
                              (order by g.customdatadefid) Supervisor 
                    from vp_employeev42 f
                    left outer join personcstmdata g 
                        on f.personid = g.personid
                     where f.personnum like 'T%' 
                     and f.homelaborlevelnm3 = '1872'
                     and (g.customdatadefid = '1' 
                             or g.personcstmdatatxt is null)
                     group by f.personid) h
          on a.personid = h.personid
  left outer join (select f.personid
                      , listagg (g.personcstmdatatxt, ',') 
                              within group (order by g.customdatadefid) Agency
                   from vp_employeev42 f
                     left outer join personcstmdata g 
                           on f.personid = g.personid
                    where f.personnum like 'T%' 
                    and homelaborlevelnm3 = '1872' 
                    and (g.customdatadefid = '3' 
                              or g.personcstmdatatxt is null)
                      group by f.personid) h 
      on a.personid = h.personid   
where personnum like 'T%' 
and homelaborlevelnm3 = '1872' 
order by personnum; 
```

这是我得到的结果：

```
EMP_ID,NAME,HIRE_DATE,STATUS,STATUS_DATE,SUPERVISOR,AGENCY
T98999,Lxxxxm, Lxxxn,20-SEP-12,Active,20-SEP-12,, S t a f f m a r k

T98989,Fxxxxn, Dxxxxa,10-DEC-12,Active,10-DEC-12,, S t a f f m a r k

T99989,Hxxxs, Cxxxxxa,02-OCT-12,Active,02-OCT-12,, S t a f f m a r k
T99999,Hxxxs, Dxxxn,30-JAN-12,Terminated,21-MAY-12, C x x x x x x x x x r   T x x x x r, P R O L O G I S T I X 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-08T23:07:54.003

您是否有机会使用`UTF-16`+ `NVARCHAR2`？例如这个：

```
SQL> select * from nls_database_parameters where parameter='NLS_NCHAR_CHARACTERSET';

PARAMETER                      VALUE
------------------------------ ----------------------------------------
NLS_NCHAR_CHARACTERSET         AL16UTF16

SQL> drop table test;

Table dropped.

SQL> create table test(a nvarchar2(10));

Table created.

SQL> insert into test values ('test');

1 row created.

SQL> insert into test values ('test 2');

1 row created.

SQL> select listagg(a, ',') within group (order by 1) from test group by 1;

LISTAGG(A,',')WITHINGROUP(ORDERBY1)
--------------------------------------------------------------------------------
 t e s t, t e s t   2 
```

你可以转换成一个字符来解决这个问题。如果这是不可接受的，您需要向 Oracle 支持提出请求。

```
SQL> select listagg(to_char(a),',') within group (order by 1) from test group by 1;

LISTAGG(TO_CHAR(A),',')WITHINGROUP(ORDERBY1)
--------------------------------------------------------------------------------
test,test 2

SQL> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-12T17:16:58.683

这是目前没有修复的已知错误：

错误 13501087 11.2.0.3 RDBMS 11.2.0.3 SQL 执行 PRODID-5 PORTID-226

摘要： LISTAGG 返回奇怪的数据

```
*** 12/14/11 05:12 am *** (ADD: Impact/Symptom->WRONG RESULTS )

  SubComponent: SQL Analytics
  ===========================
  DETAILED PROBLEM DESCRIPTION
  ============================
  When using LISTAGG function  with NVARCHAR , data is returned with spaces
  between characters 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-07T18:47:11.647

在 Oracle 12c 上，我遇到了`LISTAGG`功能问题。我曾经 `ASCIISTR()`绕过它：

```
SELECT LISTAGG(TRIM(ASCIISTR(NVL(Name,''))), ';') 
WITHIN GROUP (ORDER BY NAME) AS Names 
```

在这里工作正常。

# c# - 使用数据库查看模型

> ID：15304649
> 
> 赞同：0
> 
> 时间：2013-03-08T22:49:14.967
> 
> 标签：c#, database, asp.net-mvc-3, viewmodel

我无法理解和实现视图模型。例如，假设我有一个 Blog 对象，其中每个 Blog 对象代表一篇博客文章。我有一个包含每个博客列表（标题、文本、发布日期等）的视图。目前我将博客对象列表传递给视图，但我宁愿将 BlogViewModel 对象列表传递给视图。我该怎么做？有没有人有任何好的资源可以帮助我理解视图模型？

*编辑* 我要传递的 BlogViewModel 将包含博客标题和文本的缩写字段。例如，我只想显示标题的前 10 个字符和文本的前 25 个字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:21:34.687

假设您当前正在执行以下操作：

```
public ActionResult GetBlogs()
{
    var someService = new FooService();
    var blogs = someService.GetMeMyBlogs();
    return View("bloglist", blogs); 
} 
```

要使用视图模型，您需要从服务中返回它们，或者在将它们发送到视图之前转换控制器中的对象。

一种选择是为`Blog`对象创建扩展方法。

假设我们有一些属性，例如：

```
public class BlogVM
{
    public string Title {get;set;}
    public string Body {get;set;}
    public string AuthorName {get;set;}
    public int Id {get;set;}
} 
```

我们可以写一个扩展方法：

```
public static BlogVM ToBlogVM(this Blog source)
{
    return new BlogVM 
    {
         Title = source.Title.SubString(0, 10),
         Body = source.Body.SubString(0, 25),
         AuthorName = source.Author.Name,//assuming you have some kind of Author table, I'm sure you get the idea..
         Id = source.Id
    };
} 
```

现在在您的控制器中，您可以执行类似的操作

```
public ActionResult GetBlogs()
{
    var someService = new FooService();
    var blogs = someService.GetMeMyBlogs();
    return View("bloglist", blogs.Select(x => x.ToBlogVM())); 
} 
```

它将对象列表传递`BlogVM`给您的视图。

*编辑：可能值得添加关于为什么*ViewModels的几句话。

*   如果不需要，为什么要发送视图所有内容？在您的示例中，您的正文可能是一大块文本。如果您只想显示 25 个字符，则只发送 25 个字符

*   对象中的某些信息可能很敏感。您可能想发送`Author`的姓名，但肯定不会发送您可能持有的其他信息，例如他的姓名、电子邮件，甚至密码或地址。

*   同样，在 POST 场景中，您可以控制哪些信息可能被发送回给您。如果您允许用户 POST 回一个完整的对象，他们可能会向您发送您可能不期望的更新字段。如果您使用虚拟机，您可以控制您将接受哪些信息。

*   我发现构建视图更容易/更快

# cuda - 有人可以向我解释 nVidia GPU 架构吗？

> ID：15304651
> 
> 赞同：0
> 
> 时间：2013-03-08T22:49:31.597
> 
> 标签：cuda, gpu

我刚刚开始为我的一些模拟工作进行 GPU 编程，并且我一直在关注本教程：

[http://www.drdobbs.com/parallel/cuda-supercomputing-for-the-masses-part/208401741](http://www.drdobbs.com/parallel/cuda-supercomputing-for-the-masses-part/208401741)

但是，我对术语感到困惑，访问 nVidia 的文档让我更加困惑。

这些术语：流式多处理器、线程、扭曲、块、网格、占用、着色器

有点压倒我。

这是我非常粗略的理解：

一个 GPU 被分成多处理器（可能像其中的 2 个）。每个多处理器被分割成warp，它们被分割成块，块被分割成线程。我不知道...我希望我有一个图表。有人可以帮我吗？

**编辑**：让我解释一下我为什么要问这个。假设我想弄清楚什么是“扭曲”。我谷歌“CUDA 扭曲”。首先出现的是[http://developer.download.nvidia.com/CUDA/training/cuda_webinars_WarpsAndOccupancy.pdf](http://developer.download.nvidia.com/CUDA/training/cuda_webinars_WarpsAndOccupancy.pdf)。所以我向下滚动它说：

> 网格由完全独立的块组成

好的，我明白了。

> 块由可以在自己的块内通信的线程组成

好的...

> 32 根线形成一条经线

现在我迷路了。32根线组成一个经线？所有线程都必须在同一个块中吗？为什么我们任意将 32 个线程标记为“经线”？我可以将 12 个线程称为“挎包”吗？所以如果一个块可以容纳 20 个线程，这是否意味着我需要 2 个块来包含一个扭曲？你可以看到我的困惑来自哪里。我查找的所有内容都取决于对其他术语的了解，所以这有点像通过阅读字典来学习一门语言——这都是循环的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T23:23:01.530

以 SO 单一问题/答案格式解释诸如 CUDA 或 GPU 架构之类的东西实际上并不可行。需要长时间讨论的问题经常被关闭。

你面临的挑战是可以理解的。有时，您需要对某个主题进行更有序的介绍，而不是仅通过谷歌搜索获得的内容。

NVIDIA 有各种可用资源：

*   [参考文档](http://docs.nvidia.com/cuda/index.html)
*   [网络研讨会培训](https://developer.nvidia.com/gpu-computing-webinars)
*   [开发者支持](https://developer.nvidia.com/user/register)
*   [GTC 点播](http://www.gputechconf.com/gtcnew/on-demand-gtc.php)

仅举几例。让我建议您从参加介绍性和高级网络研讨会开始。如果你打算做大量的 GPU 编码，这将花费大约 2 个小时：

GPU Computing using CUDA C – An Introduction (2010) 介绍使用 CUDA C 进行 GPU 计算的基础知识。将通过代码示例的演练来说明概念。无需先前的 GPU 计算经验

GPU Computing using CUDA C – Advanced 1 (2010) 一级优化技术，例如全局内存优化和处理器利用率。将使用真实的代码示例来说明概念

这些都是 3 岁的事实对于您的问题并不重要。您当然欢迎浏览网络研讨会以获取更新版本 - 有很多。

# php - 使用 PDO 更新数组

> ID：15304656
> 
> 赞同：8
> 
> 时间：2013-03-08T22:49:59.247
> 
> 标签：php, pdo

我正在为我的用户创建一个多步骤表单。他们将被允许更新任何或所有字段。所以，我需要发送值，检查它们是否已设置，如果是，则运行`UPDATE`. 这是我到目前为止所拥有的：

```
public function updateUser($firstName, $lastName, $streetAddress, $city, $state, $zip, $emailAddress, $industry, $password, $public = 1, 
    $phone1, $phone2, $website,){

    $updates = array(
        'firstName'             => $firstName,
        'lastName'              => $lastName,
        'streetAddress'         => $streetAddress,
        'city'                  => $city,
        'state'                 => $state,
        'zip'                   => $zip,
        'emailAddress'          => $emailAddress,
        'industry'              => $industry,
        'password'              => $password,
        'public'                => $public,
        'phone1'                => $phone1,
        'phone2'                => $phone2,
        'website'               => $website,

); 
```

这是我的 PDO（嗯，开始尝试）

```
 $sth = $this->dbh->prepare("UPDATE user SET firstName = "); //<---Stuck here
    $sth->execute();
    $result = $sth->fetchAll(PDO::FETCH_ASSOC);
    return $result; 
```

基本上，我怎样才能创建`UPDATE`语句，以便它只更新数组中不是的项目`NULL`？

我想过`foreach`像这样运行一个循环：

```
 foreach($updates as $key => $value) {
        if($value == NULL) {
            unset($updates[$key]);
        }
    } 
```

`prepare`但是如果我不确定这些值，我将如何编写声明？

如果我完全错了，请指出我正确的方向。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T22:56:55.350

首先，[`array_filter`](http://php.net/filter)用于删除所有 NULL 值：

```
$updates = array_filter($updates, function ($value) {
    return null !== $value;
}); 
```

其次，绑定参数，这让你的生活更轻松：

```
$query = 'UPDATE table SET';
$values = array();

foreach ($updates as $name => $value) {
    $query .= ' '.$name.' = :'.$name.','; // the :$name part is the placeholder, e.g. :zip
    $values[':'.$name] = $value; // save the placeholder
}

$query = substr($query, 0, -1).';'; // remove last , and add a ;

$sth = $this->dbh->prepare($query);

$sth->execute($values); // bind placeholder array to the query and execute everything

// ... do something nice :) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:57:22.263

下面可以优化：

```
$i = 0; $query = array();
foreach($updates as $key => $value) {
   if ($value != NULL) {
      $query[] = "{$key} = :param_{$i}";
      $i++;
   }
}

if (! empty($query)) {
  $finalQuery = implode(",", $query);
  $sth = $this->dbh->prepare('UPDATE user SET ' . $finalQuery);

  $i = 0; 
  foreach($updates as $key => $value) {
   if ($value != NULL) {
      $sth->bindParam(':param_'.$i, $value, PDO::PARAM_STR);
      $i++;
    }
  }
} 
```

# html - HTML中的一键式文件对话框

> ID：15304658
> 
> 赞同：0
> 
> 时间：2013-03-08T22:50:08.463
> 
> 标签：html, dialog

我正在寻找一种一键式解决方案，它将调用一个文件打开对话框，并从该对话框中将文件名发送到下一页。我偷了这段代码，但需要点击 2 次才能进入下一页：

```
<form enctype="multipart/form-data" action="ImportTOA.php" method="POST" accept="text/csv">
    <!-- MAX_FILE_SIZE must precede the file input field -->
    <input type="hidden" name="MAX_FILE_SIZE" value="30000" />
    <!-- Name of input element determines name in $_FILES array -->
    Upload Daily TOA Logs: <br /><input name="userfile" type="file" />
    <input type="submit" value="Send File" />
</form> 
```

我不需要上传文件，我只需要传递用户选择的文件名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:10:28.640

好的。通过足够窄的谷歌查询，我找到了答案。如果有人来阅读此线程，这是我借用的有效代码：

```
<form enctype="multipart/form-data" action="ImportTOA.php" method="POST" accept="text/csv">
    <!-- MAX_FILE_SIZE must precede the file input field -->
    <input type="hidden" name="MAX_FILE_SIZE" value="30000" />
    <!-- Name of input element determines name in $_FILES array -->
    Upload Daily TOA Logs: <br /><input name="userfile" type="file" onChange = "this.form.submit()" />
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:52:20.270

如果您不需要上传文件，只需删除 enctype。文件名应该在没有上传的情况下通过。然后您可以在文件上提交有关`change`事件的表单。我需要仔细检查文档，但我认为`change`文件输入会触发。

看起来 IE 可能有点不同：[Jquery: change event to input file on IE](https://stackoverflow.com/questions/2389341/jquery-change-event-to-input-file-on-ie)

您甚至不需要“提交”表单，只需通过 javascript 获取文件名并执行您需要执行的任何操作。

# amazon-web-services - 为什么 AWS Dynamo SDK 不提供存储大于 64kb 的对象的方法？

> ID：15304667
> 
> 赞同：3
> 
> 时间：2013-03-08T22:51:08.370
> 
> 标签：amazon-web-services, amazon-dynamodb

我有一个用例，我想在 Dynamo DB 中存储大于 64kb 的对象。如果您实现一种“分页”功能，将对象划分为更小的块并将它们存储为键的多个值，那么看起来这相对容易实现。

然而，这让我思考。为什么亚马逊没有在他们的 SDK 中实现这一点？存储大于 64kb 的对象是否是个坏主意？如果是这样，要使用的“正确”基础设施是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-09T00:18:10.560

在我看来，这是 DynamoDB 做出的可以理解的权衡。为了实现高可用性和冗余，他们需要复制数据。为了获得超低延迟，他们允许不一致的读取。我不确定他们的内部实现，但我猜想这个 64KB 上限越高，不一致的读取可能与项目的实际当前状态过时的时间越长。在超低延迟系统中，毫秒可能很重要。

这将不一致的查询返回块 1 和 2（但还不是 3）的问题推到客户端。

根据问题评论，如果您想存储更大的数据，我建议存储在 S3 中并从 DynamoDB 中项目的属性中引用 S3 位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-30T23:19:04.037

作为记录，DynamoDB 中的最大项目大小现在是 400K，而不是提出问题时的 64K。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T07:36:22.797

从设计的角度来看，我认为很多可以使用 >64KB 块对问题建模的情况也可以转换为可以将这些块拆分为 <64KB 块的模型。这样做通常是更好的设计选择。

例如，如果您存储一个复杂的对象，您可能会将其拆分为多个集合，每个集合都对对象的各个方面之一进行编码。

通过这种方式，您可能会为大型数据集获得更好、更可预测的性能，因为查询任何大小的对象都将涉及定义数量的 API 调用，且延迟的上限较低且可预测。

很多时候，服务运营人员很难从系统中获得这种可预测性，以保证在 90/95/99% 的流量中具有给定的延迟。AWS 只是选择将此约束构建到 API 中，就像他们可能已经为自己的网站和内部开发所做的那样。

此外，当然从 (AWS) 实施和调优的角度来看，假设 64KB 的上限是很舒服的，因为它允许可预测的内存分页进/出、网络往返的上限等。

# android - Google Play 如何实现自动更新？

> ID：15304675
> 
> 赞同：0
> 
> 时间：2013-03-08T22:51:32.847
> 
> 标签：android, google-play

我已经看到**Google Play**实现了一个很棒的工具来自动更新应用程序，他们是怎么做到的？

如果它是广播接收器，如何让它监听网络服务？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:54:31.753

**工作原理**
Google Play 服务客户端库

自动更新

运行 Android 2.2 及更高版本且具有 Google Play 商店应用程序的设备会自动接收 Google Play 服务的更新。使用最新版本的 Google Play 服务增强您的应用，无需担心用户的 Android 版本。

[http://developer.android.com/google/play-services/index.html](http://developer.android.com/google/play-services/index.html)

背后的基本思想是检查软件的版本，因为它包含一个唯一密钥和一个版本号，如果谷歌发现客户端和服务器版本之间具有相同密钥的版本的差异，它允许应用程序更新

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T23:03:48.450

他们使用 Google Cloud Messaging，它是一种推送通知服务。

[http://developer.android.com/google/gcm/index.html](http://developer.android.com/google/gcm/index.html)

# magento - Magento 捆绑产品 - 具有相同产品的多个选项。如何阻止 Magento 隐藏重复产品？

> ID：15304680
> 
> 赞同：0
> 
> 时间：2013-03-08T22:51:51.210
> 
> 标签：magento, product

我正在尝试在 Magento 中设置捆绑产品。该产品应允许客户选择 4 个免费产品以包含在捆绑包中。这些产品可以是完全不同的，也可以是同一产品的 4 个。

例如

免费产品 1 免费产品 2 免费产品 3

客户可以选择免费产品 1 中的四个，或免费产品 1 和 2 中的一个，以及免费产品 3 中的两个。

我正在使用 4 种下拉输入类型，每种都有所有三种免费产品作为选项。因此，客户可以为每个免费礼品行项目选择三种产品中的任何一种。

Magento 只显示一个下拉选择列表，我相信由于每个下拉列表都包含相同的产品列表。

我需要在哪里查看以阻止 Magento 检查产品选项是否已在先前的选择中列出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T05:05:57.313

除非您以编程方式执行此操作（即编写代码），否则无法执行此操作。

当 Magento 添加产品时，它首先查看报价/购物车以查看是否已经存在。如果有，它会拉出那个并增加数量。没有办法关闭它。

以编程方式，您非常手动地将商品添加到购物车。这是如何...

```
$cart = Mage::getSingleton("checkout/cart");

foreach ($products_to_add as $product_id => $custom_options) {
  $product = Mage::getModel("catalog/product")->load($product_id);
  $options = new Varien_Object(array("options" => $custom_options,
                                     "qty" => 1));

  // some products may result in multiple products getting added to cart
  // I beleive this pulls them all and sets the custom options accordingly
  $add_all = $product->getTypeInstance(true)
      ->prepareForCartAdvanced($options, $product, Mage_Catalog_Model_Product_Type_Abstract::PROCESS_MODE_FULL);

  foreach ($add_all as $add_me) {
    $item = Mage::getModel('sales/quote_item');
    $item->setStoreId(Mage::app()->getStore()->getId());
    $item->setOptions($add_me->getCustomOptions())
      ->setProduct($add_me);

    $item->setQty(1);
    $cart->getQuote()->addItem($item);
  }
}

// when done adding all the items, finally call save on the cart
$cart->save(); 
```

# c++ - 调试器的监视窗口将变量值显示为零，但它们不是

> ID：15304683
> 
> 赞同：0
> 
> 时间：2013-03-08T22:52:02.097
> 
> 标签：c++, visual-studio-2010, visual-studio, mfc

我有静态分配的结构。它有几个数组。当我看到这些数组的值时，它们会显示出来，但所有值都为零 (0)。当我将此数组写入文件时，这些值是正确的，但是如果我在调试器中同时观察这些值，则这些值显示为零。我使用 TRACE 在输出窗口上打印值，这也是正确的。

所以程序正确地进行了所有计算，但调试器显示变量的值全为零。我正在使用 VS2010 和 C++。有没有办法解决它？

ps 我已经尝试过其他列出的解决方案，比如在调试器中输入 array_name,number ，但这对我也不起作用。

# c++ - 具有不同 ROI 的扩张梯度（blob 优化）OPENCV

> ID：15304686
> 
> 赞同：1
> 
> 时间：2013-03-08T22:52:17.883
> 
> 标签：c++, opencv, blob, gradient, roi

我正在使用 opencv 处理 c++ 中的膨胀问题。我已经捕获了停车场的视频帧，为了获得最好的 blob，我想出了这个。

1.  侵蚀（5x5 内核矩形），3 次迭代
2.  Dilation GRADIENT（将其视为沿 y 轴的颜色渐变）

那么我做了什么来让它工作呢？首先，我需要知道 2 个点 (x,y) 和在这些点上 2 个良好的扩张核大小。有了这些信息，人们就可以在整个图像上对这些值进行插值和外推。所以我根据这些参数计算了投资回报率（大小和扩张内核大小）。所以每个 ROI 都有自己预定义的 kernelsize 用于扩张。请注意，两个连续的 ROI（opencv 矩形）之间没有任何空格。一切正常，但**有两个副作用**：

1.  斑点两侧的凸起。黑线是 ROI 的边界！ [凸出图片](http://img832.imageshack.us/img832/8096/buldges.png)
2.  从主 blob 中“切断”的 blob。这些实际上并没有被切断，但是上面一个blob下的ROI扩张（我认为从上面的ROI获取像素信息）成分开的blob。它应该是一个巨大的斑点。[不应该在那里的 blob 图片](http://img571.imageshack.us/img571/6261/blobleft.png)

我已经尝试了所有改变 ROI 大小的方法，并在它们之间留下了一些空间，但缺点是 2 个单独的 ROI 之间的斑点没有扩大。

所以我的问题是：

1.  究竟是什么导致了这些副作用？
2.  我该怎么做才能让它们消失？

编辑

所以我找到了我的解决方案：当您调用 opencv dilate 函数时，需要确定是否可以将相同的 cv::Mat 用作目标图像。如果不是，您将使用原始图像和新图像的一部分。所以我所要做的就是包括一个目的地 cv::Mat。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:13:45.993

这并不能回答您的第一个问题（肯定会导致这些副作用的原因），但是要使它们消失，您可以执行以下一些变体，假设 ROI 参数是离散的而不是连续的（似乎是这种情况）。

您可以使用每个可能的内核大小来计算整个图像的膨胀。然后，在计算完所有这些二进制图像之后，您可以将它们组合在一起，从正确的图像中提取正确的样本以获得所需的输出图像。这绝对会浪费大量时间，但它应该在没有工件的情况下工作。

一旦你确认你已经得到了上面的结果（几乎可以保证质量尽可能好），你就可以开始尝试优化了。我要尝试的一件事是扩展每个 ROI 大小，以便按内核大小的大小计算膨胀。这可能会绕过可能由奇怪的边界条件引起的伪影。

这导致我首先猜测导致伪影的原因：每当您拍摄有限图像并运行卷积（或形态算子）时，您都需要选择对边缘像素做什么。通常，访问 (-4, -1) 处的像素是没有意义的，但是如果你的内核与它重叠，你就必须执行操作符。如果 OpenCV 正在为您的子区域进行边缘填充，它很容易为您提供您所看到的工件。

希望这可以帮助！

# c++ - C++ fstream，从文本中读取数据并执行数学运算？

> ID：15304690
> 
> 赞同：0
> 
> 时间：2013-03-08T22:52:25.633
> 
> 标签：c++, io, fstream, ifstream, file-io

我在这里束手无策。我正在用 C++ 编写一个程序，它将读取一个包含以下内容的文本文件作为一个简短的示例：

```
+ 23 34
- 9 8
+ 100 1
* 8 7
^ 2 5
/ 45 8 
```

阅读器将第一个操作数存储在 char 类型中，并根据它检索到的 char 调用一个函数来执行对这两个数字的操作，这里有一个示例函数可以执行此操作。

```
void doDivision(ifstream &inFile) {
    char ch;
    int num1, num2;

    inFile >> ch >> num1 >> num2;
    cout << "Division     " << num1 << "    " << num2 << "    " << "Quotient " << "    " << num1/num2 << " Remain " << num1%num2  << endl; 
} 
```

有一件事是我不确定为什么参数是 &inFile 这个函数原型不是我制作的，但它来自一本书，也许这就是为什么我不能让它工作的原因。

这是我的主要功能：

```
int main()
{

ifstream inFile;
char ch;
int num1, num2;

inFile.open("math.txt");
if (inFile.fail())
{
cout << ch;
      cout << "The math.txt input file failed to open";
        return -1;
}

 while(inFile)
{
    switch (ch) {

    case '+':
        doAddition(inFile);
        break;
    case '-':
        doSubtraction(inFile);
        break;
    case '*':
        doMultiplication(inFile);
        cout << "debug " << ch;
        break;
    case '/':
        doDivision(inFile);
        break;
    case '!':
        doFactorial(inFile);
        break;
    default:
        cout << "Invalid Operation" << endl;

    }

    inFile >> ch;
}

inFile.close();
return 0;
} 
```

所有这些一起产生了以下意想不到的结果

```
Invalid Operation 
Addition 3 34 sum 37 (wrong data in text file is 23 and 34)
subtraction 0 8 difference 8 (data in textfile is 9 and 8 respectively) 
```

我将如何实现这一点，我不知所措，因为我以前从未使用过文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:57:07.440

一个简单的错误是在您的 while() 循环中，`inFile >> ch`直到第一次通过循环之后才调用。尝试修复它，看看它是否有帮助。

此外，[Aniket 在他们的回答中所说的](https://stackoverflow.com/a/15304743/327263)是您需要注意的另一个问题。

简而言之，您的循环应该大致如下所示：

```
inFile >> ch;
while(inFile) {
    switch(ch) {
    case '+':
        ...
    }
    inFile >> ch;
} 
```

您的功能应该与此类似：

```
void doDivision(ifstream &inFile) {
    int num1, num2;

    inFile >> num1 >> num2;

    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T22:57:23.337

由于您已经在这样做`inFile >> ch`，`main()`因此（逻辑上）再次阅读它`doAddition()`和其他方法将是错误的。

既然你已经发布`doDivision()`了你在角色中阅读的方法`ch`，我假设你也在做同样的事情`doAddition()`。

还有你的输出：

> 加法 3 34 和 37（文本文件中的错误数据是 23 和 34）

告诉我们一切——你已经读了 1 个字符（找到`+`）然后在方法中读了另一个字符`doAddition()`，——读`2`入`ch`的`doAddition()`然后读`3`和`34`..

这实际上是错误所在。

解决方案：将您`doAddition()`和所有其他功能更改为如下所示。

```
void doAddition(ifstream &inFile) {
    char ch;
    int num1, num2;

    inFile >> num1 >> num2;
    cout << "Addition of " << num1 << " and " << num2 << " = "<< (num1+num2) << '\n';
} 
```

此外，在`main()`函数中：

while 循环应如下所示：

```
while(inFile)
{
    inFile >> ch;
    switch (ch) {

    case '+':
        doAddition(inFile);
        break;
    case '-':
        doSubtraction(inFile);
        break;
    case '*':
        doMultiplication(inFile);
        cout << "debug " << ch;
        break;
    case '/':
        doDivision(inFile);
        break;
    case '!':
        doFactorial(inFile);
        break;
    default:
        cout << "Invalid Operation" << endl;

    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T22:57:46.893

您没有阅读`ch`第一次迭代。事实上，当您检查您的文件是否打开时没有问题，`cout << ch;`尽管事实上`ch`未初始化，您还是会这样做。您可以简单地将 移动到循环`inFile >> ch;`的顶部。`while`

下一个问题是，在您的每个`doSomething`函数内部，您都在`inFile >> ch`再次执行操作，这将尝试再次读取操作字符。不过，您的`doSomething`函数不需要知道`ch`，因为函数本身是根据 的值选择的`ch`。

这是我将如何写这个：

```
ifstream inFile("math.txt"); // You can specify the file name here
char op;
int left_operand, right_operand;

// Use extraction has while condition
while (inFile >> op >> left_operand >> right_operand) {
  switch (op) {
    // Pass operands to the relevant function
    case '+': doAddition(left_operand, right_operand); break;
    // ...
  }
}

// You do not need to close inFile, it will be closed when it goes out of scope
return 0; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T23:34:26.460

理想情况下，有**更好**的方法来执行您的建议，但是如果您*必须*使您的代码看起来和执行起来像这样，那么适当的解决方案应该是这样的：

```
#include <vector>
#include <fstream>
#include <iostream>
#include <string>
#include <cstdlib>

using namespace std;

void doAddition(ifstream &inFile) {
    int num1, num2;

    inFile >> num1 >> num2;
    cout << "Addition of " << num1 << " and " << num2 << " = "<< (num1+num2) << '\n';   
}

void doSubtraction(ifstream &inFile) {
    int num1, num2;

    inFile >> num1 >> num2;
    cout << "Subtraction of " << num1 << " and " << num2 << " = "<< (num1-num2) << '\n';
}

void doMultiplication(ifstream &inFile) {
    int num1, num2;

    inFile >> num1 >> num2;
    cout << "Multiplication of " << num1 << " and " << num2 << " = "<< (num1*num2) << '\n';
}

void doDivision(ifstream &inFile) {
    float num1, num2;

    inFile >> num1 >> num2;
    cout << "Division of " << num1 << " and " << num2 << " = "<< (num1/num2) << '\n';
}

void doFactorial(ifstream &inFile) {
    int t1, t2;

    inFile >> t1 >> t2;

    //perform factorial here
}

void readToNextLine(ifstream& inFile) {
    string t1, t2;

    inFile >> t1 >> t2;
}

int main()
{
    ifstream inFile;
    char ch;
    int num1, num2;

    inFile.open("math.txt");

    if (inFile.is_open()){

        inFile >> ch;
        while (!inFile.eof())
        {
            switch (ch) 
            {

                case '+':
                    doAddition(inFile);
                    break;
                case '-':
                    doSubtraction(inFile);
                    break;
                case '*':
                    doMultiplication(inFile);
                    break;
                case '/':
                    doDivision(inFile);
                    break;
                case '!':
                    doFactorial(inFile);
                    break;
                default:
                    readToNextLine(inFile);
                    cout << "Invalid Operation" << endl;
            }
            inFile >> ch;
        }
            inFile.close();
    }
    else
    {
        cout << "The math.txt input file failed to open";
        return -1;
    }

    inFile.close();
    return 0;
} 
```

这里有几点需要注意：

**其他人建议的一些解决方案不考虑默认情况**- 它只是放弃读取该行的其余部分，**导致逻辑错误**- 这是没有人想要的。

现在，至于“更好”、更通用的解决方案，最好先将所有内容存储为字符串，然后进行标记化，并尝试将适当的标记转换为所需的类型输出。

但是，正如我之前提到的，如果您希望符合以前的代码，那么这是合适的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T23:03:18.427

除非您感到自虐，否则几乎可以肯定的是同时读取运算符和两个操作数，然后执行操作：

```
char operation;
int operand1, operand2;

while (infile >> op >> operand1 >> operand2) 
   switch(operation) {
       case '+': add(operand1, operand2); break;
       case '-': sub(operand1, operand2); break;
       case '*': mul(operand1, operand2); break;
       case '/': div(operand1, operand2); break;
   } 
```

对于只有四个操作员，这按原样工作得很好。如果您要拥有更多，则最好使用指向函数的指针表来代替：

```
typedef int (*op)(int, int);

op operators[UCHAR_MAX];

for (int i=0; i<UCHAR_MAX; i++)
    operators[i] = report_bad_operator;

operators['+'] = add;
operators['-'] = sub;
operators['/'] = div;
operators['*'] = mul;
// more operators here

while (infile >> operation >> operand1 >> operand2)
    operators[operation](operand1, operand2); 
```

这样做的明显原因/时间是处理非二元运算符（即，不一定采用两个操作数的运算符）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T23:06:44.443

首先，在为它赋值之前，您正在阅读 chr。

像这样改变你的while循环：

```
while(inFile)
{
    inFile >> ch; // assign before reading
    switch (ch) {

    case '+':
        doAddition(inFile);
        break;
    case '-':
        doSubtraction(inFile);
        break;
    case '*':
        doMultiplication(inFile);
        cout << "debug " << ch;
        break;
    case '/':
        doDivision(inFile);
        break;
    case '!':
        doFactorial(inFile);
        break;
    default:
        cout << "Invalid Operation" << endl;
    }
} 
```

并像这样更改您的 doDivision 函数：

```
void doDivision(ifstream &inFile)
{ 
    int num1, num2;

    inFile >> num1 >> num2; // your already read the arithmetic operator
    cout << "Division     " << num1 << "    " << num2 << "    " << "Quotient " << " 
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-09T01:09:01.477

首先，初始传递，您的`ch`变量未初始化。它在循环的底部 *被初始化。*

尝试添加：

```
 inFile >> ch; 
```

在while循环之前。

# ios - 在“init”中初始化的对象无法在“viewDidLoad”中访问

> ID：15304694
> 
> 赞同：1
> 
> 时间：2013-03-08T22:53:20.207
> 
> 标签：ios, objective-c, cocoa-touch, initialization

我有一个奇怪的问题：我在“init”方法中加载对象数据。当我尝试在“viewDidLoad”中访问它时，我的应用程序崩溃了。这是代码：

```
@interface UploadCenterViewController () {
    NSMutableArray *videos;
}

@end

@implementation UploadCenterViewController 

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];  
    if (self) {
        if (![self loadVideos]) {
            [self saveVideos];
        }
    }

    return self;
}

-(void)saveVideos {
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSData *encodedData = [NSKeyedArchiver archivedDataWithRootObject:videos];
    [defaults setObject:encodedData forKey:@"VIDEOS"];
    [defaults synchronize];
}

-(bool)loadVideos {
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSData *encodedData = [defaults objectForKey:@"VIDEOS"];
    if (encodedData) {
        videos = (NSMutableArray *)[NSKeyedUnarchiver unarchiveObjectWithData:encodedData];

        NSLog(@"array size: %d", [videos count]);

        return true;
    } else {
        videos = [[NSMutableArray alloc] init];
        return false;
    }
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    NSLog(@"%d", [videos count]);
} 
```

加载数据时，“videos”数组包含一个对象。在“viewDidLoad”中访问它时，整个应用程序崩溃。

有人有想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:56:42.297

您可能希望保留`[NSKeyedUnarchiver unarchiveObjectWithData:encodedData]`.

阅读[内存管理规则](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T22:58:16.730

声明`videos`为 an`@property`并在`self.videos`任何地方使用它。崩溃是因为`videos`一旦你给它赋值就会被释放。的范围`videos`仅在该方法内，因此可能会崩溃。由于您想在该方法之外使用它，因此您需要保留它，并且您可以使用@property，如下所述。

例如：-

```
@interface UploadCenterViewController () {}

@property(nonatomic, strong) NSMutableArray *videos;

@end

-(void)saveVideos {
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSData *encodedData = [NSKeyedArchiver archivedDataWithRootObject:self.videos];
    [defaults setObject:encodedData forKey:@"VIDEOS"];
    [defaults synchronize];
}

-(bool)loadVideos {
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSData *encodedData = [defaults objectForKey:@"VIDEOS"];
    if (encodedData) {
        self.videos = (NSMutableArray *)[NSKeyedUnarchiver unarchiveObjectWithData:encodedData];
        NSLog(@"array size: %d", [self.videos count]);
        return true;
    } else {
        self.videos = [[NSMutableArray alloc] init];
        return false;
    }
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    NSLog(@"%d", [self.videos count]);
} 
```

# xml - Spring XML 配置中的十六进制文字

> ID：15304701
> 
> 赞同：0
> 
> 时间：2013-03-08T22:53:41.330
> 
> 标签：xml, spring, hex

如何在 Spring XML 配置文件中使用十六进制文字？

```
<value>#{T(java.lang.Integer).decode("0xFF")}</value> 
```

有效，但我懒得为我需要的每个十六进制文字编写这样的表达式。是否有任何快捷方式或语法糖？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:32:32.560

经过几次尝试，我得到了它。可能对某人有帮助：

问题是实际上我试图在 XML 中配置 ARGB 颜色值。`0xFFFF0000`是正确的值，表示`255`alpha 和红色、`0`绿色和蓝色。但它不是有效的[整数字面](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/expression/spel/ast/IntLiteral.html)量（对我来说有点神奇：`0xFFFF0000`实际上是`-65536`在 Java 中转换为 int 时，但`Integer.parseInt()`无法解析此字符串）

所以解决方案是创建 long 并强制转换为 int：

```
<value>#{0xFFFF0000L.intValue()}</value> 
```

# java - JPA 2.0：外来ID的注解

> ID：15304704
> 
> 赞同：1
> 
> 时间：2013-03-08T22:53:53.907
> 
> 标签：java, hibernate, jpa

使用休眠和 JPA 2.0。我有一个 Mail 类和一个 MailAccount 类。两个类都不需要直接引用另一个类，Mail 类目前只有一个 accountId long 指向它所属帐户的 ID。这用于构建查询，例如“获取属于帐户 X 的所有邮件”。据我所知，出于多种原因，让他们直接引用彼此是不好的（可能有数十万封邮件与一个帐户相关联）。

但是，在执行此操作时，我不会使用任何 JPA 注释来注释 accountId 字段。我想让数据库知道这种关系，主要是 accountId 引用了邮件帐户表中条目的 ID（用于级联更改等）。使用 JPA，我该如何做到这一点？

简而言之：

*在 Mail.java 中*

```
private long accountId; 
```

*在 MailAccount.java 中*

```
private long id; 
```

我如何通过 JPA 告诉 Hibernate/JPA accountId 指的是 MailAccount.id ？

# mysql - 从 ibdata1 恢复 mysql 数据库

> ID：15304708
> 
> 赞同：7
> 
> 时间：2013-03-08T22:54:19.257
> 
> 标签：mysql, innodb, corruption

我有一个客户似乎已经从他们的本地机器上丢失了他们所有的 mysql 数据库。他们在 Mac 上，我对它有点陌生，我在 Ubuntu 上。数据库文件夹中没有 .MYD 或 .MYI 文件，只有 .frm 文件。我让他们压缩了 mysql 和Sight 文件夹（sight 是我们需要的数据库），以及 ibdata1、ib_logfile0 和 ib_logfile1 文件。我为 mysql 创建了第二个文件夹 /var/lib/mysql2，并将文件和文件夹移到那里。我将新文件夹和文件改成 mysql:mysql，编辑 /etc/mysql/my.cnf 以指向新文件夹，编辑 /etc/apparmor.d/usr.sbin.mysqld，然后重新启动 apparmor 和 mysql。但是，我在 mysql 错误日志中收到以下错误：

```
130308 17:38:16 [Note] Plugin 'FEDERATED' is disabled.
130308 17:38:16  InnoDB: Initializing buffer pool, size = 8.0M
130308 17:38:16  InnoDB: Completed initialization of buffer pool
InnoDB: The log sequence number in ibdata files does not match
InnoDB: the log sequence number in the ib_logfiles!
130308 17:38:16  InnoDB: Database was not shut down normally!
InnoDB: Starting crash recovery.
InnoDB: Reading tablespace information from the .ibd files...
InnoDB: Restoring possible half-written data pages from the doublewrite
InnoDB: buffer...
130308 17:38:16  InnoDB: Error: space id and page n:o stored in the page
InnoDB: read in are 0:589824, should be 0:7!
130308 17:38:16  InnoDB: Error: page 589824 log sequence number 786432 0
InnoDB: is in the future! Current system log sequence number 0 63932940.
InnoDB: Your database may be corrupt or you may have copied the InnoDB
InnoDB: tablespace but not the InnoDB log files. See
InnoDB: http://dev.mysql.com/doc/refman/5.1/en/forcing-innodb-recovery.html
InnoDB: for more information.
InnoDB: Database page corruption on disk or a failed
InnoDB: file read of page 7.
InnoDB: You may have to recover from a backup.
130308 17:38:16  InnoDB: Page dump in ascii and hex (16384 bytes):
 len 16384; hex 0008000000090000000a0000000b0000000c00000000000000000000000202720000 (snipped because this goes on for a while)
                                                                                 Tg 9  <o q                      E                i F     /     D                ;InnoDB: End of page dump
130308 17:38:16  InnoDB: Page checksum 4146777650, prior-to-4.0.14-form checksum 1800374066
InnoDB: stored checksum 524288, prior-to-4.0.14-form stored checksum 0
InnoDB: Page lsn 786432 0, low 4 bytes of lsn at page end 0
InnoDB: Page number (if stored to page already) 589824,
InnoDB: space id (if created with >= MySQL-4.1.1 and stored already) 0
InnoDB: Page may be a freshly allocated page
InnoDB: Database page corruption on disk or a failed
InnoDB: file read of page 7.
InnoDB: You may have to recover from a backup.
InnoDB: It is also possible that your operating
InnoDB: system has corrupted its own file cache
InnoDB: and rebooting your computer removes the
InnoDB: error.
InnoDB: If the corrupt page is an index page
InnoDB: you can also try to fix the corruption
InnoDB: by dumping, dropping, and reimporting
InnoDB: the corrupt table. You can use CHECK
InnoDB: TABLE to scan your table for corruption.
InnoDB: See also http://dev.mysql.com/doc/refman/5.1/en/forcing-innodb-recovery.html
InnoDB: about forcing recovery.
InnoDB: Ending processing because of a corrupt database page. 
```

我尝试将 innodb_force_recovery = 4 添加到 my.cnf 文件中，这会产生大量不同的错误：

```
130308 17:48:30 [Note] Plugin 'FEDERATED' is disabled.
130308 17:48:30  InnoDB: Initializing buffer pool, size = 8.0M
130308 17:48:30  InnoDB: Completed initialization of buffer pool
InnoDB: The log sequence number in ibdata files does not match
InnoDB: the log sequence number in the ib_logfiles!
130308 17:48:30  InnoDB: Database was not shut down normally!
InnoDB: Starting crash recovery.
InnoDB: Reading tablespace information from the .ibd files...
InnoDB: Restoring possible half-written data pages from the doublewrite
InnoDB: buffer...
130308 17:48:30  InnoDB: Error: space id and page n:o stored in the page
InnoDB: read in are 0:589824, should be 0:7!
130308 17:48:30  InnoDB: Error: page 589824 log sequence number 786432 0
InnoDB: is in the future! Current system log sequence number 0 63932940.
InnoDB: Your database may be corrupt or you may have copied the InnoDB
InnoDB: tablespace but not the InnoDB log files. See
InnoDB: http://dev.mysql.com/doc/refman/5.1/en/forcing-innodb-recovery.html
InnoDB: for more information.
InnoDB: Database page corruption on disk or a failed
InnoDB: file read of page 7.
InnoDB: You may have to recover from a backup. 
```

还有一大堆，如果有帮助，我可以提供。任何关于从这里尝试什么的建议将不胜感激，谢谢。

* * *

编辑：我尝试按照此处的步骤操作，但在使用他使用的命令行序列运行 mysql 时遇到问题：

[http://blog.shiraj.com/2012/10/extract-data-from-mysql-ibdata1-data-file/](http://blog.shiraj.com/2012/10/extract-data-from-mysql-ibdata1-data-file/)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-07-15T21:20:29.743

以下对我有用：

*   在你的 my.cnf 中设置 innodb_force_recovery = 1

*   尝试让您的 mysqld 重新启动。如果没有，重复步骤 #1 并递增 innodb_force_recovery 直到成功。使用该指南来帮助您了解每次递增时发生的情况：http: [//dev.mysql.com/doc/refman/5.0/en/forcing-innodb-recovery.html](http://dev.mysql.com/doc/refman/5.0/en/forcing-innodb-recovery.html)

*   mysqld 运行后，尝试转储所有数据库

> ```
> mysqldump -u root -p --all-databases > /tmp/mysqldump-all.sql 
> ```

*   如果这不成功，您必须先在数据库级别尝试

> ```
> mysqldump -u root -p --databases db_name > mysqldump-db_name.sql 
> ```

*   如果这不成功，您将不得不在桌面级别尝试

> SELECT * FROM table_name INTO OUTFILE '/tmp/table_name.sql'

*   一旦其中一个成功并且您的所有数据库或所有表都已导出，请停止 mysqld

*   移动您的 ib_logfile* > ib_logfile*.bak。这些通常在您的 mysql 数据目录中。

*   如果在第一步中您增加了 innodb_force_recovery => 4，则需要将其设置为低于 4。从 5.6.15 开始，innodb_force_recovery 设置为 4 或更高会将 InnoDB 置于只读模式。

*   启动 mysqld 服务器

*   导入导出的数据库或表

> mysql -u root -p < /tmp/mysqldump-all.sql

*   增加你的 innodb_force_recovery => 1

*   重启mysqld服务器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-26T07:51:28.897

这对我有用：

1.  innodb_force_recovery => 2
2.  使用 HeidiSQL 登录 MySQL 服务器并转储所有数据库
3.  重新安装 MySQL 服务器并从转储文件中导入所有数据库。

# java - 如何使用多标题测试任务性能？

> ID：15304709
> 
> 赞同：1
> 
> 时间：2013-03-08T22:54:22.720
> 
> 标签：java, multithreading, performance, concurrency, java.util.concurrent

我有一些练习，其中一个是关于并发的。这个主题对我来说是新的，但是我花了 6 个小时终于解决了我的问题。但是我对相应API的了解很差，所以我需要建议：我的解决方案是正确的还是可能有更合适的方法。

所以，我必须实现下一个接口：

```
public interface PerformanceTester {    
    /**
     * Runs a performance test of the given task.
     * @param task which task to do performance tests on
     * @param executionCount how many times the task should be executed in total
     * @param threadPoolSize how many threads to use
     */
    public PerformanceTestResult runPerformanceTest(
            Runnable task,
            int executionCount, 
            int threadPoolSize) throws InterruptedException;
} 
```

其中**PerformanceTestResult**包含总时间（整个性能测试总共花费了多长时间）、最短时间（最短的单次执行花费了多长时间）和最长时间（最长的单次执行花费了多长时间）。

所以，我今天学到了很多新东西——关于线程池、类型`Executors`、、等等。`ExecutorService``Future``CompletionService`

如果我有 `Callable task`，我可以做下一个：

1.  在程序结束时返回当前时间`call()`。
2.  创建一些数据结构（可能是一些 Map）来存储开始时间和`Future`对象，由`fixedThreadPool.submit(task)`（执行此`executionCount`时间，循环）重新调整；
3.  执行后，我可以从结束时间中减去开始时间`Future`。

**（在Callable 任务**的情况下这是正确的方法吗？）

但！我只有`Runnable task`，所以我继续寻找。我什至创建`FutureListener implements Callable<Long>`，必须返回时间，何时`Future.isDone()`，但对我来说接缝有点疯狂（我必须加倍线程数）。

因此，最终我注意到`CompletionService`type 带有有趣的方法`take()`，它*检索并删除代表下一个已完成任务的 Future，如果还没有则等待。*，以及使用[ExecutorCompletionService](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorCompletionService.html)的非常好的示例。还有我的解决方案。

```
public class PerformanceTesterImpl implements PerformanceTester {

@Override
public PerformanceTestResult runPerformanceTest(Runnable task,
        int executionCount, int threadPoolSize) throws InterruptedException {
    long totalTime = 0;
    long[] times = new long[executionCount];

    ExecutorService pool = Executors.newFixedThreadPool(threadPoolSize);

    //create list of executionCount tasks 
    ArrayList<Runnable> solvers = new ArrayList<Runnable>();
    for (int i = 0; i < executionCount; i++) {
        solvers.add(task);
    }

    CompletionService<Long> ecs = new ExecutorCompletionService<Long>(pool);

    //submit tasks and save time of execution start
    for (Runnable s : solvers)
        ecs.submit(s, System.currentTimeMillis());

    //take Futures one by one in order of completing
    for (int i = 0; i < executionCount; ++i) {
        long r = 0;
        try {
            //this is saved time of execution start
            r = ecs.take().get();
        } catch (ExecutionException e) {
            e.printStackTrace();
            return null;
        }
        //put into array difference between current time and start time
        times[i] = System.currentTimeMillis() - r;
        //calculate sum in array
        totalTime += times[i];
    }

    pool.shutdown();
    //sort array to define min and max
    Arrays.sort(times);        

    PerformanceTestResult performanceTestResult = new PerformanceTestResult(
            totalTime, times[0], times[executionCount - 1]);
    return performanceTestResult;
}
} 
```

那么，你能说什么呢？感谢您的回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:57:56.440

我会使用 System.nanoTime() 获得更高分辨率的时间。您可能希望忽略前 10,000 个测试，以确保 JVM 已预热。

我不会费心创建一个可运行列表并将其添加到执行器。相反，我只想将它们添加到执行者中。

使用 Runnable 不是问题，因为您得到了`Future<?>`回报。

注意：确定任务在队列中花费的时间可能会对时间产生很大影响。而不是从创建任务时开始花费时间，您可以拥有任务时间本身并以纳秒为单位返回 Long 时间。时间安排的完成方式应反映您所考虑的用例。

* * *

一种将 Runnable 任务转换为自身计时的简单方法。

```
finla Runnable run = ...
ecs.submit(new Callable<Long>() {
    public Long call() {
         long start = System.nanoTime();
         run.run();
         return System.nanoTime() - start;
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:59:11.097

在 JVM 中编写性能测试时有很多错综复杂的地方。您可能并不担心它们，因为这是一个练习，但如果您是这个问题，可能会有更多信息： [如何在 Java 中编写正确的微基准测试？](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java)

也就是说，您的代码中似乎没有任何明显的错误。如果您想全面审查您的代码，您可能想在流量较低的代码审查网站上询问：http: [//codereview.stackexchange.com](http://codereview.stackexchange.com)

# c - 在没有非标准库的嵌入式系统上进行对象检测的建议

> ID：15304717
> 
> 赞同：0
> 
> 时间：2013-03-08T22:55:01.733
> 
> 标签：c, object, detection, vision

我正在寻找一些关于检测图像中方形或圆形对象的好方法的建议。我目前有一个在原始灰度上运行的精明边缘算法，我可以产生这个输出：

[http://imgur.com/FAwowr1](http://imgur.com/FAwowr1)

现在我可以看到这张图片中有一个立方体卫星，但是程序也可以看到它的一种计算效率高的好方法是什么？我看过霍夫斯变换，但这似乎计算量很大。我也看过哈里斯角检测，但我觉得我会得到很多误报，因为我本质上是在寻找包含所述立方体卫星的图片。

有人对一些好的算法有什么想法吗？我的空间非常有限，所以我不能使用任何大型外部库，如 opencv。（这都是在 C 顺便说一句）

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:06:27.180

我会进入所谓的[数学形态学](http://en.wikipedia.org/wiki/Mathematical_morphology)

基本上你对二值图像进行操作，所以你必须首先找到一种巧妙的方法来对它们进行阈值化，然后使用一些精心挑选的结构元素进行腐蚀和膨胀等操作，以提取图像中感兴趣的区域。

# java - 春季安全。自定义身份验证管理器

> ID：15304718
> 
> 赞同：1
> 
> 时间：2013-03-08T22:55:04.730
> 
> 标签：java, spring, authentication, spring-security

我有弹簧 mvc 应用程序。我已经用 CustomAuthenticationManager 添加了 Spring Security。这是包含在 appContex.xml 中的 application-security.xml。在 login.jsp 中，我使用带有 2 个输入的标准登录页面：name='j_username' & name='j_password' 而在 CustomAuthenticationManager.authenticate(Authentication authentication) 中的方法中，我只收到密码，但没有收到密码的主体名称。我做错了什么？

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
    xmlns:p="http://www.springframework.org/schema/p" xmlns:security="http://www.springframework.org/schema/security"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                        http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.1.xsd
                        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd">

<bean id="loginPassAuthenticationFilter"
    class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
    <property name="authenticationManager" ref="customAuthenticationManager" />
    <property name="allowSessionCreation" value="true" />
    <property name="filterProcessesUrl" value="/j_spring_security_check" />
    <property name="authenticationFailureHandler" ref="customAuthenticationFailureHandler" />
    <property name="authenticationSuccessHandler" ref="customAuthenticationSuccessHandler" />
</bean>

<bean id="customAuthenticationManager"
    class="com.whatever.security.CustomAuthenticationManager" />
<bean id="authenticationFilter"
    class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter"
    p:authenticationManager-ref="customAuthenticationManager"
    p:authenticationFailureHandler-ref="customAuthenticationFailureHandler"
    p:authenticationSuccessHandler-ref="customAuthenticationSuccessHandler" />

<bean id="customAuthenticationFailureHandler"
    class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler"
    p:defaultFailureUrl="/?error=true" />

<bean id="customAuthenticationSuccessHandler"
    class="org.springframework.security.web.authentication.SimpleUrlAuthenticationSuccessHandler"
    p:defaultTargetUrl="/" />

<bean id="authenticationEntryPoint"
    class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint"
    p:loginFormUrl="/" />
<security:authentication-manager />
<bean id="passwordEncoder"
    class="org.springframework.security.authentication.encoding.ShaPasswordEncoder">
    <constructor-arg value="512" />
</bean> 
```

```
<form name='f' action="<c:url value='j_spring_security_check' />"
    method='POST'>
    <table>
        <tr>
            <td>User:</td>
            <td><input type='text' name='j_username' value=''></td>
        </tr>
        <tr>
            <td>Password:</td>
            <td><input type='password' name='j_password' /></td>
        </tr>
        <tr>
            <td colspan='2'><input name="submit" type="submit"
                value="submit" /></td>
        </tr>
        <tr>
            <td colspan='2'><input name="reset" type="reset" /></td>
        </tr>
    </table>
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T16:40:30.743

我建议使用安全命名空间（链接到最小配置的示例）：
[http ://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#ns-minimal](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#ns-minimal)

这里是如何定义自己的身份验证提供程序的链接：http: [//static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#ns-auth-manager](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#ns-auth-manager)

创建您自己的身份验证提供程序可以解决大多数用例。如果您需要任何其他说明，请告诉我。

最好的祝福，

迈克尔

# ruby - 以编程方式处理图像请求并在 Sinatra 中返回流

> ID：15304721
> 
> 赞同：3
> 
> 时间：2013-03-08T22:55:34.123
> 
> 标签：ruby, image, http, sinatra

这个想法目前只是在绘图板上，我首先想知道它是否可能，然后是如何实现的。

假设 Sinatra 中的一个应用程序具有以下应用程序文件：

```
#!/usr/bin/env ruby
# encoding: UTF-8

require 'sinatra'

get '/hi' do 
  "Hello World"
end

get '/' do 
  erb :index
end

get '/url_to_img.jpg'
  #parse url
  #process an image
  #stream the image back to the client as nothing have happened
end 
```

图像请求是否会被截获，以及如何将图像文件包装在 HTTP 响应中返回。

对不起，对于非常粗鲁的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:17:01.547

你所描述的是可能的。您需要做的就是在您的 Sinatra 路由中返回二进制数据，确保您拥有正确的文件 MIME 类型。

下面是一个检测图像 MIME、创建缩略图并将缩略图返回给浏览器的示例：

```
get '/:filename' do |filename|
  redirect 404 unless File.readable?(filename)
  content_type detect_mime_type(filename)
  create_thumbnail filename
end 
```

我正在使用以下助手：

```
require 'filemagic'
require 'rmagick'

def detect_mime_type(path)
  FileMagic.new(FileMagic::MAGIC_MIME)
  .file(path).gsub(/\n/,"").split(";").first
end

def create_thumbnail(path)
  Magick::Image.read(filename)
  .first.resize_to_fill(680, 500)
end 
```

当然，您不应该从您的主网站目录提供文件；这仅用于说明目的。

# php - Eloquent Laravel 4 封装数据库配置格式

> ID：15304722
> 
> 赞同：1
> 
> 时间：2013-03-08T22:55:37.103
> 
> 标签：php, connection, package, laravel-4, eloquent

当创建一个打算在 Laravel 4 框架中运行的 composer 包时，我想创建一个看起来像这样的默认数据库连接集：

```
// File Location: LARAVEL4_ROOT/vendor/my/package/src/config/database.php
return array(

'connections' => array(

    'reporting' => array(
        'driver'    => 'mysql',
        'host'      => getenv('REPORTING_HOST'),
        'database'  => getenv('REPORTING_DBNAME'),
        'username'  => getenv('REPORTING_USER'),
        'password'  => getenv('REPORTING_PASS'),
        'charset'   => 'utf8',
        'collation' => 'utf8_unicode_ci',
        'prefix'    => '',
    ),

),
); 
```

根据我可以在网上找到的所有文档，一旦我使用服务提供者模式注册了我的项目并调用`$this->package('my/package')`；Laravel 4 应该神奇地加载这个文件并让我在配置中访问它。

我已经确认我可以打电话

```
 Config::get('package::database.connections.reporting') 
```

它返回上面的数组。

但是，当我构建我的 Eloquent 模型文件并尝试使用

```
protected $connection = 'package::database.connections.reporting'; 
```

它不起作用。我得到一个例外说：

```
InvalidArgumentException: Database [package::database.connections.reporting] not configured. 
```

我需要使用一些魔术字符串格式来让连接解析器使用我的包中的默认配置连接到我的数据库吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T05:17:12.780

好的，我找到了解决方案：

在撰写本文时，Laravel 4 中的连接处理似乎与 Config 门面使用的语法不一致。因此使用：

```
protected $connection = 'package::database.connections.reporting'; 
```

...将不起作用，因为 DatabaseManager 类仅搜索从 laravelroot/app/config/database.php 加载的配置

因此，在撰写本文时，建立在我的包配置中定义的连接的唯一方法是修改我的包服务提供程序中先前加载的配置数组，如下所示：

```
public function boot()
{
    $this->package('vendor/package');
    include __DIR__."/routes.php";

    // Add my database configurations to the default set of configurations                        
    $this->app['config']['database.connections'] = array_merge(
        $this->app['config']['database.connections']
       ,Config::get('reporting::database.connections')
    );
} 
```

这可以很容易地由框架通过修改 DatabaseManager 类来查看提供的连接名称并以与 Config 门面相同的方式解析配置细节来处理。但这在撰写本文时尚未实施。

我已经分叉了框架并提交了一个带有潜在修复的拉取请求。我们会看看情况如何。现在，您可以在您的包服务提供商中使用上述解决方法，然后在您的模型中设置连接的名称，如下所示：

```
protected $connection = 'reporting'; 
```

由于我的包配置中定义的连接数组已经与 laravelroot/app/config/database.php 中定义的默认连接合并，就好像连接实际上是在应用配置中创建的，所以不需要包模型内连接名称的分辨率。

希望这将在未来的 laravel 4 版本中实现自动化，或者实现在包服务提供者中加载包数据库配置文件的更直观的方式。

# php - PHP：对多维数组的不同值求和

> ID：15304723
> 
> 赞同：2
> 
> 时间：2013-03-08T22:55:43.860
> 
> 标签：php, arrays, multidimensional-array, foreach, sum

我需要对 'in' 和 'ou'、[a] 到 [t] 的数组求和。

```
Array
(
[1] => Array
    (
        [in] => Array
            (
                [a] => 3
                [b] => 0
                [c] => 0
                [d] => 0
                [e] => 0
                [f] => 0
                [o] => 0
                [t] => 3
            )

        [ou] => Array
            (
                [a] => 0
                [b] => 0
                [c] => 1
                [d] => 0
                [e] => 0
                [f] => 0
                [o] => 0
                [t] => 1
            )
    )
[2] => Array
    (
        [in] => Array
            (
                [a] => 0
                [b] => 0
                [c] => 0
                [d] => 0
                [e] => 0
                [f] => 0
                [o] => 0
                [t] => 0
            )

        [ou] => Array
            (
                [a] => 0
                [b] => 0
                [c] => 0
                [d] => 1
                [e] => 2
                [f] => 0
                [o] => 0
                [t] => 3
            )
    )
) 
```

以下是我如何计算总计'in'+'ou'。但是，当谈到 'in' a,b,c,d,e,f,t 和 'ou' a,b,c,d,e,f,吨。

```
//get day total
foreach($arr as $array){
    foreach($array as $inou){
        foreach(array_keys($inou) as $value){
            if(isset($total[$value])){
                $total[$value] += $inou[$value];
            }else{
                $total[$value] = $inou[$value];
            }
        }
    }
} 
```

输出应该看起来像

```
in(
[a] => 3
[b] => 0
[c] => 0
...
[t] => 3
)
ou(
[a] => 0
[b] => 0
[c] => 1
[d] => 1
[e] => 2
[f] => 0
[t] => 4
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:02:16.160

这应该让你开始：

```
 $sumIN = 0; 
        $sumOU = 0;
        foreach($arr as $innerArr)
        {
            $sumIN += array_sum($innerArr['in']);
            $sumOU += array_sum($innerArr['ou']);
        } 
```

# java - 如果文件存在，如何更改代码以正确保存文件？

> ID：15304725
> 
> 赞同：0
> 
> 时间：2013-03-08T22:56:01.770
> 
> 标签：java, android, save

目前我可以将文本文件加载到 EditText 中。如果文本被更改并且用户尝试打开一个新文件“先保存？” 显示对话框。我遇到的问题不是保存工作文件（currentFile）而是保存在要打开的文件上。

我哪里错了？

```
 File currentFile;
public boolean changed;
public boolean exists;
    ...

                private void openFile(final File aFile){
                    String nullChk = et.getText().toString();
                    exists = true;

                if(!changed || nullChk.matches("")){
                     try {
                            et.setText(new Scanner(aFile).useDelimiter("\\Z").next());
                            changed=false;
                            } catch (FileNotFoundException e) {
                // TODO Auto-generated catch block
                            e.printStackTrace();
                            }   
                     }else{
                        AlertDialog.Builder alert = new AlertDialog.Builder(this);

                        alert.setTitle("Save first?");
                        alert.setMessage("(Will be saved in the current working directory)");

                        alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int whichButton) {
                         String temptxt = et.getText().toString();

                        if(exists){
                            saveFile(aFile.getPath(), temptxt);
                        }else{
                            saveAs();
                        }
                          }
                        });
                        final File tempFile = aFile;
                        alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                          public void onClick(DialogInterface dialog, int whichButton) {
                              try {
                                    et.setText(new Scanner(tempFile).useDelimiter("\\Z").next());
                                } catch (FileNotFoundException e) {
                                    // TODO Auto-generated catch block
                                    e.printStackTrace();
                                }
                            changed=false;
                          }
                        });

                        alert.show();
                        //currentFile = aFile;
                     }
                }

                private void saveFile(String sFileName, String sBody){
                    //Toast.makeText(this, exists +"", Toast.LENGTH_SHORT).show();
                    if (exists) {
                        try {
                            File tempfile = new File(sFileName);
                            FileWriter writer = new FileWriter(tempfile);
                            writer.write(sBody);
                            writer.flush();
                            writer.close();
                            changed=false;
                            Toast.makeText(this, "Saved", Toast.LENGTH_SHORT).show();
                            return;
                        } catch (IOException e) {
                            e.printStackTrace();
                        }
                    }else{
                        Toast.makeText(this, "Save as", Toast.LENGTH_SHORT).show();
                        saveAs();
                    }

                }

                private void saveAs(){
                    AlertDialog.Builder alert = new AlertDialog.Builder(this);

                    alert.setTitle("Save as");
                    alert.setMessage("(Will be saved in the current working directory)");

                    // Set an EditText view to get user input 
                    final EditText input = new EditText(this);
                    alert.setView(input);

                    alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                      String value = input.getText().toString();
                      String tmpText = et.getText().toString();

                      try {
                        File tempfile = new File(currentDirectory, value);
                        FileWriter writer = new FileWriter(tempfile);
                          writer.write(tmpText);
                          writer.flush();
                          writer.close();
                          changed=false; 
                          fill(currentDirectory.listFiles());
                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                    e.printStackTrace();
                    }
                      }
                    });

                    alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                      public void onClick(DialogInterface dialog, int whichButton) {
                          startActivityForResult(new Intent(MainActivity.this, NewFile.class),1);
                          dialog.dismiss();
                  }
                    });
                    alert.show();
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T01:10:49.373

我认为您使用相同的文件来打开和保存文件。

当您打开文件时，您使用 aFile 作为参数`openFile(final File aFile)`并在

```
et.setText(new Scanner(aFile).useDelimiter("\\Z").next()); 
```

和

`saveFile(aFile.getPath(), temptxt);`.

# c# - 将外键表示为 WPF StackPanel GridViewColumn 中的其他值

> ID：15304726
> 
> 赞同：2
> 
> 时间：2013-03-08T22:56:29.067
> 
> 标签：c#, wpf, entity-framework, mvvm

我有一个 StackPanel，它使用实体的属性/表列设置它的 GridColumns。许多列是来自其他表的外键。下面的一个简短示例显示了一次这样的外键 - CustomerID。

```
<StackPanel Orientation="Vertical" Margin="5">
    <Label Content="Tests to Run" FontWeight="Bold" x:Name="TestsToRunLabel"/>
    <ListView ItemsSource="{Binding SelectedTechnician.Tests}"
        SelectedItem="{Binding SelectedTest}" x:Name="AvailableTestsListView" Height="140">
        <ListView.View>
            <GridView>
                <GridViewColumn Header="Id" Width="auto" DisplayMemberBinding="{Binding Id}"/>
                <GridViewColumn Header="Test" Width="auto" DisplayMemberBinding="{Binding CustomerId}"/>
            </GridView>
        </ListView.View>
    </ListView>
</StackPanel> 
```

正如预期的那样，这只是显示与键关联的整数值，而不是一些“用户可读”的值，例如客户名称或其他有用的值。

如果可能的话，我如何“转换”或表示像 CustomerId 这样的外键以在 Customer 表中显示其他值？

这基本上会像现在一样获得密钥并到达 Customer 表并在我的 StackPanel 中获取像 Customer.Name 这样的代表属性。

**注意事项：**

测试和客户是代码优先实体。我也在使用 MVVM，所以如果这是我需要在 ViewModel 而不是 XAML 中操作的东西，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:17:22.253

为了解决我自己的问题，我在我的业务模型对象上创建了一组“仅显示”属性，它们只是执行 LINQ 查询以返回更有意义的属性/属性/列：

```
public string CustomerName
{
    get
    {
        var db = new Context();

        var customer = db.Customers.Find(CustomerId);
        _customerName = customer.Name;

        return _customerName;
    }
} 
```

# jsf - 在扩展表富面建议中实施就地选择以获得更好的解决方案和性能问题

> ID：15304729
> 
> 赞同：1
> 
> 时间：2013-03-08T22:56:52.777
> 
> 标签：jsf, richfaces

嗨，我想实现一个带有水平和垂直滚动条的可编辑表，所以我选择了富面的扩展表，并想编辑这个表中的数据，所以我选择了就地输入和就地选择，如果我工作得很好少于 30 行，如果我有更多的行说 600 行.....渲染页面太慢了

没有就地选择，我只是尝试显示它工作得很好，所以我认为原因如下，因为每行有 6 个就地选择，所以它太慢了，因为它需要加载 600*6 =3600 选择下拉并且对于每个下拉菜单，它将进入模态类以获取每个下拉菜单的选择列表。

在这 600 行的每一行中重复这 6 个下拉菜单......那么有什么方法可以提高性能并使用这个解决方案，或者有什么好的解决方案吗？

有没有办法将下拉选项存储在富面孔客户端的一个变量中并在同一页面上重新使用？

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
     <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:t="http://myfaces.apache.org/tomahawk"
    xmlns:rich="http://richfaces.org/rich"
     xmlns:p="http://primefaces.prime.com.tr/ui"
      xmlns:a4j="http://richfaces.org/a4j"

    >

<ui:composition template="/WEB-INF/layout/baseLayoutJs.xhtml">

<rich:messages layout="list" showDetail="true" showSummary="true"
        style="color:darkred">
        <f:facet name="errorMarker">
            <h:graphicImage value="/images/error.gif" />
        </f:facet>
        <f:facet name="infoMarker">
            <h:graphicImage value="/images/passed.gif" />
        </f:facet>
    </rich:messages>
    <ui:define name="content">
                <h:form>
                    <rich:panel style="width:800px">
                <f:facet name="header">
                    <h:panelGrid id="grid0" columns="4" style="width:800px;">
                        <h:outputLabel for="s1212" styleClass="formLabelswidth25"
                            value="Scheme Editor Home" />

                    </h:panelGrid>
                </f:facet>
                <rich:messages layout="list" rendered="true" showDetail="true"
                    showSummary="true" passedLabel="Trying to Save." style="color:red">
                    <f:facet name="errorMarker">
                        <h:graphicImage value="/images/error.gif" />
                    </f:facet>
                    <f:facet name="passedMarker">
                        <h:graphicImage value="/images/passed.gif" />
                    </f:facet>
                </rich:messages>

                <h:panelGrid columns="8" bgcolor="#BED6F8" style="height:30px;" width="780">
                    <h:commandButton action="#{schemeWebEditorHomeHandler.saveScheme}" value="Save" style="height:20px;width:60px;"/>
                        <h:commandButton action="#{schemeWebEditorHomeHandler.addNewSchemeRow}" value="New Row" style="height:20px;width:10x;"/>
                <h:commandButton action="#" value="Clear Row" style="height:20px;width:100px;"/>
                                    <h:commandButton action="#" value="Delete Row" style="height:20px;width:100px;"/>
                    <h:commandButton action="#" value="Update Trays" style="height:20px;width:100px;"/>
                        <h:commandButton action="#" value="Search" style="height:20px;width:100px;"/>
                            <h:commandButton action="#" value="Copy" style="height:20px;width:100px;"/>
                            <h:commandButton action="#" value="Help" style="height:20px;width:100px;"/>
                </h:panelGrid>
                    <t:div style=" height : 10px;"></t:div>
                <h:panelGrid id="searchData" style="width=780px;">

                    <rich:extendedDataTable id="data" var="list"
                    preserveDataModel="false"   preserveSort="true"  bgcolor="#BED6F8"  style="height:300px; width:780px;"
                    frozenColumns="3" 
                    selection="#{schemeWebEditorHomeHandler.selection}" selectionMode="multiple"
                    value="#{schemeWebEditorHomeHandler.sortSchemeRowList}" width="780"   rowKeyVar="row">

                  <rich:column align="left" width="130px" >
                    <f:facet name="header">
                      <h:panelGroup width="130px" layout="block">

                         <script type="text/javascript">
                        //<![CDATA[
                            function checkAllCheckboxesInTable( inputId, state ){

                              var commonIdPart = inputId.substr(0, inputId.lastIndexOf(':'));

                              var tableId = commonIdPart ;

                              var tableElement = document.getElementById( tableId );

                              var inputs = tableElement.getElementsByTagName('input');

                              for (var i = 0; i <= inputs.length; i++){
                                  var input = inputs[i];
                                  if( input.getAttribute('type') == 'checkbox' && state){
                                    input.setAttribute('checked', state);
                                  }else{
                                    input.removeAttribute('checked');
                                  }
                              }
                            }
                            //]]>
                          </script>
                        <h:selectBooleanCheckbox id="checkAll" title="#{bundle.CHECK_ALL}" onclick="checkAllCheckboxesInTable( this.id, this.checked );">
                          <a4j:ajax event="change" reRender="data"/>
                        </h:selectBooleanCheckbox>
                        <h:outputText  value=" SELECT ALL"  styleClass="formLabelswidth29"   />

                      </h:panelGroup>
                    </f:facet>
                    <h:selectBooleanCheckbox align="left" id="checkEntry" value="#{list.selected}" disabled="false"/>
                  </rich:column>

                <rich:column>
                <f:facet name="header">
                        <h:outputText value="Start Bin"  styleClass="formLabelswidth29" />
                    </f:facet>
                    <rich:inplaceInput layout="block" value="#{list.startBin}"
                        converterMessage="Start Bin value should be integer. Start Bin at row #{row+1} can't be changed."
                        id="inplace" required="true"
                        requiredMessage="Start Bin at row #{row+1} wasn't filled. Value can't be changed."
                        changedHoverClass="hover" viewHoverClass="hover"
                        viewClass="inplace" changedClass="inplace" style="border-style:none;"
                        selectOnEdit="true" >

                    </rich:inplaceInput>
                    </rich:column>

                        <rich:column>
                <f:facet name="header">
                        <h:outputText value="End Bin" styleClass="formLabelswidth29"/>
                    </f:facet>
                    <rich:inplaceInput layout="block" value="#{list.endBin}"
                        converterMessage="End Bin value should be integer. End Bin  at row #{row+1} can't be changed."
                        id="inplace2" required="true"
                        requiredMessage=" End Bin at row #{row+1} wasn't filled. Value can't be changed."
                        changedHoverClass="hover" viewHoverClass="hover"
                        viewClass="inplace" changedClass="inplace" style="border-style:none;"
                        selectOnEdit="true" >

                    </rich:inplaceInput>
                    </rich:column>

                <rich:column>
                    <f:facet name="header">
                        <h:outputText value="Bin Switch" styleClass="formLabelswidth29"/>
                     </f:facet>

                     <rich:inplaceSelect   value="#{list.binSwitch}"   style="border-style:none;" selectItemClass="SelectItem" >
                       <f:selectItems value="#{schemeWebEditorHomeHandler.binSwitchTypeList}" />
                    </rich:inplaceSelect>

                </rich:column>

               <rich:column>
                    <f:facet name="header">
                        <h:outputText value="Bin Type" styleClass="formLabelswidth29" />
                     </f:facet>

                     <rich:inplaceSelect   value="#{list.binTypeId}"   style="border-style:none;" selectItemClass="SelectItem" >
                       <f:selectItems value="#{schemeWebEditorHomeHandler.binTypeList}" />
                    </rich:inplaceSelect>

                </rich:column>    

               <rich:column>
                    <f:facet name="header">
                        <h:outputText value="Qual Level" styleClass="formLabelswidth29" />
                     </f:facet>

                     <rich:inplaceSelect   value="#{list.quailificationLevelId}"   style="border-style:none;" selectItemClass="SelectItem" >
                       <f:selectItems value="#{schemeWebEditorHomeHandler.sortLevelTypeList}" />
                    </rich:inplaceSelect>

                </rich:column>    

               <rich:column>
                    <f:facet name="header">
                        <h:outputText value="Auto/Mach" styleClass="formLabelswidth29" />
                     </f:facet>

                     <rich:inplaceSelect   value="#{list.autoMachinableId}"   style="border-style:none;" selectItemClass="SelectItem" >
                       <f:selectItems value="#{schemeWebEditorHomeHandler.autoMachTypeList}" />
                    </rich:inplaceSelect>

                </rich:column>                      

                        <rich:column>
                <f:facet name="header">
                        <h:outputText value="Zip Range" styleClass="formLabelswidth29" />
                    </f:facet>
                    <rich:inplaceInput  value="#{list.rangeValue}"
                        converterMessage="Zip Range value should be integer. Zip Range at row #{row+1} can't be changed."
                        id="inplace3" required="false"
                        requiredMessage="Zip Range at row #{row+1} wasn't filled. Value can't be changed."

                        selectOnEdit="true" style="p {display:block};border-style:none;"  >

                    </rich:inplaceInput>
                    </rich:column>

                        <rich:column>
                <f:facet name="header">
                        <h:outputText value="Bin Line 1" styleClass="formLabelswidth29" />
                    </f:facet>
                    <rich:inplaceInput layout="block" value="#{list.binLine1}"
                        converterMessage="Bin Line 1 value should be integer. Bin Line 1 at row #{row+1} can't be changed."
                        id="inplace4" 
                        requiredMessage="Bin Line 1 at row #{row+1} wasn't filled. Value can't be changed."
                        changedHoverClass="hover" viewHoverClass="hover"
                        viewClass="inplace" changedClass="inplace" style="border-style:none;"
                        selectOnEdit="true" minInputWidth="180px" >
                        <f:validateLength minimum="0" maximum="5" />

                    </rich:inplaceInput>

                    </rich:column>

                                            <rich:column>
                <f:facet name="header">
                        <h:outputText value="Bin Line 2" styleClass="formLabelswidth29" />
                    </f:facet>
                    <rich:inplaceInput layout="block" value="#{list.binLine2}"
                        converterMessage="Bin Line 2 value should be integer. Bin Line 2 at row  #{row+1}        can't be changed."
                        id="inplace5"
                        requiredMessage="Bin Line 2 at row #{row+1} wasn't filled. Value can't be changed."
                        changedHoverClass="hover" viewHoverClass="hover"
                        viewClass="inplace" changedClass="inplace" style="border-style:none;"
                        selectOnEdit="true" >

                    </rich:inplaceInput>
                    </rich:column>

                    </rich:extendedDataTable>

            </h:panelGrid>

                </rich:panel>
                    <t:saveState value="#{schemeWebEditorHomeHandler.selectedSchemeId}"></t:saveState>

        <t:saveState value="#{schemeWebEditorHomeHandler.sortSchemeRowList}"></t:saveState>
                    <t:saveState value="#{schemeWebEditorHomeHandler.fromAddNewRow}"></t:saveState>
                </h:form>

    </ui:define>
</ui:composition>
</html> 
```

这是我的豆子

新代码

```
 @ManagedBean
    @ViewScoped
   public class SchemeWebEditorHomeHandler extends BaseHandler implements
        Serializable {

    private static final long serialVersionUID = -1172151714140365016L;
    private static final Log log = LogFactory.getLog(SchemeWebEditorHomeHandler.class);

    private List<SortSchemeRow> sortSchemeRowList;
    List<SelectItem> binSwitchTypeList;
    boolean fromAddNewRow = false;
    List<SelectItem> binTypeList;
    List<SelectItem> autoMachTypeList;
    List<SelectItem> sortLevelTypeList;
    List<SelectItem> planetCodeTypeList;
    List<SelectItem> subMailTypeList;
    List<SelectItem> trayLabelTypeList;
    List<SelectItem> msMailTypeList;
    List<SelectItem> trayBandingTypeList;
    private Collection<Object> selection;
    private int selectedSchemeId;

    public SchemeWebEditorHomeHandler() throws BaajaException {

        binSwitchTypeList = new ArrayList<SelectItem>();
        binSwitchTypeList.add(new SelectItem(1, "ON"));
        binSwitchTypeList.add(new SelectItem(2, "OF"));

        SchemeExpertService schemeExpert = (SchemeExpertService) ServiceLocator
                .getServiceWithName(SchemeExpertService.class.getName());

        // binTypeList fetch
        if (this.binTypeList == null || this.binTypeList.size() <= 0) {
            Collection machBinTypeList = schemeExpert.getMachBinTypes();
            this.binTypeList = new ArrayList<SelectItem>();
            for (Iterator iterator = machBinTypeList.iterator(); iterator
                    .hasNext();) {
                MachSchemeBinType machSchemeBinType = (MachSchemeBinType) iterator
                        .next();
                this.binTypeList.add(new SelectItem(machSchemeBinType
                        .getSchemeBinTypeId(), machSchemeBinType
                        .getDisplayDescription()));
            }
        }

        if (this.autoMachTypeList == null || this.autoMachTypeList.size() <= 0) {
            Collection dbAutoMAchTypeList = schemeExpert
                    .getAutoMachinableTypes();
            this.autoMachTypeList = new ArrayList<SelectItem>();

            for (Iterator iterator = dbAutoMAchTypeList.iterator(); iterator
                    .hasNext();) {
                CoreAutoMachLite coreAutoMachLite = (CoreAutoMachLite) iterator
                        .next();
                this.autoMachTypeList.add(new SelectItem(coreAutoMachLite
                        .getAutoMachId(), coreAutoMachLite.getDescription()));

            }
        }

        if (this.sortLevelTypeList == null
                || this.sortLevelTypeList.size() <= 0) {
            Collection dbSortLevelTypeList = schemeExpert
                    .getQualificationLevels();
            this.sortLevelTypeList = new ArrayList<SelectItem>();
            for (Iterator iterator = dbSortLevelTypeList.iterator(); iterator
                    .hasNext();) {
                CoreSortLevelLite coreSortLevelLite = (CoreSortLevelLite) iterator
                        .next();

                this.sortLevelTypeList.add(new SelectItem(coreSortLevelLite
                        .getSortLevelId(), coreSortLevelLite.getDescription()));

            }
        }

        planetCodeTypeList = new ArrayList<SelectItem>();
        planetCodeTypeList.add(new SelectItem(true, "ON"));
        planetCodeTypeList.add(new SelectItem(false, "OF"));

        if (this.subMailTypeList == null || this.subMailTypeList.size() <= 0) {
            Collection dbSubMailTypeList = schemeExpert.getSubMailingTypes();
            this.subMailTypeList = new ArrayList<SelectItem>();
            for (Iterator iterator = dbSubMailTypeList.iterator(); iterator
                    .hasNext();) {
                MachSubmailTypeLite machSubmailTypeLite = (MachSubmailTypeLite) iterator
                        .next();

                this.subMailTypeList.add(new SelectItem(machSubmailTypeLite
                        .getSubmailTypeId(), machSubmailTypeLite
                        .getDescription()));

            }
        }

        if (this.msMailTypeList == null || this.msMailTypeList.size() <= 0) {
            Collection dbmsMailTypeList = schemeExpert.getMsMailingTypes();
            this.msMailTypeList = new ArrayList<SelectItem>();
            for (Iterator iterator = dbmsMailTypeList.iterator(); iterator
                    .hasNext();) {
                MsMailTypeLite msMailTypeLite = (MsMailTypeLite) iterator
                        .next();

                this.msMailTypeList.add(new SelectItem(msMailTypeLite
                        .getMsMailTypeId(), msMailTypeLite.getDescription()));

            }
        }

        trayBandingTypeList = new ArrayList<SelectItem>();
        trayBandingTypeList.add(new SelectItem(true, "ON"));
        trayBandingTypeList.add(new SelectItem(false, "OF"));

        if (this.trayLabelTypeList == null
                || this.trayLabelTypeList.size() <= 0) {
            Collection dbtrayLabelTypeList = schemeExpert
                    .getTraySubMailingTypes();
            this.trayLabelTypeList = new ArrayList<SelectItem>();
            for (Iterator iterator = dbtrayLabelTypeList.iterator(); iterator
                    .hasNext();) {
                LogTrayTagTypeLite logTrayTagTypeLite = (LogTrayTagTypeLite) iterator
                        .next();

                this.trayLabelTypeList.add(new SelectItem(logTrayTagTypeLite
                        .getTrayTagTypeId(), logTrayTagTypeLite
                        .getDescription()));

            }
        }

        log.info("Constrctor ...........");

    }

    public String viewScheme() throws BaajaException {
        SchemeExpertService schemeExpert = (SchemeExpertService) ServiceLocator
                .getServiceWithName(SchemeExpertService.class.getName());
        HttpServletRequest req = getServletRequest();
        int sorterSchemeId = this.selectedSchemeId;
        if (req.getParameter("sorterSchemeId") != null
                && req.getParameter("sorterSchemeId").trim().length() > 0) {
            sorterSchemeId = Integer.parseInt(req
                    .getParameter("sorterSchemeId"));

        }
        log.info("Parameter scheme Id :" + sorterSchemeId);
        MachSorterSchemeLite sortScheme = schemeExpert
                .getScheme(sorterSchemeId);
        this.sortSchemeRowList = (List) SortSchemeUtility
                .getSortSchemeRow(sortScheme.getMachSortSchemeGroups());
        if (sortSchemeRowList.size() > 0) {

        } else {
            addErrorMessage("No matching records found for selected criteria");
        }
        return "view_SchemeWebHome_Screen";
    }

    public String saveScheme() throws BaajaException {
        System.out.println("Hello inside save scheme");
        // log.info("listSize5"+this.sortSchemeRowList.size());
        // sortSchemeRowList= getSortSchemeRowList();

        SchemeExpertService schemeExpert = (SchemeExpertService) ServiceLocator
                .getServiceWithName(SchemeExpertService.class.getName());

        MachSorterSchemeLite sortScheme = schemeExpert
                .getScheme(this.selectedSchemeId);

        schemeExpert.updateSchemeWithSorterSchemeGroup(sortScheme,
                SortSchemeUtility.getSortSchemeGroups(
                        (Collection) this.sortSchemeRowList, sortScheme));

        return viewScheme();
    }

    public String addNewSchemeRow() throws BaajaException {
        log.info("listSize" + this.sortSchemeRowList.size());
        SortSchemeRow sr = new SortSchemeRow();
        sr.setSubMailingTypeId(1);
        sr.setGroupSeparator("");
        sr.setBinSwitch(1);
        sr.setAutoMachinableId(1);
        sr.setBinTypeId(1);
        sr.setQuailificationLevelId(1);

        this.sortSchemeRowList.add(sr);
        // log.info(getSortSchemeRowList().size()+"listSize2"+this.sortSchemeRowList.size());
        setFromAddNewRow(true);
        return "view_SchemeWebHome_Screen";
    }

    public List<SortSchemeRow> getSortSchemeRowList() throws BaajaException {
        SchemeExpertService schemeExpert = (SchemeExpertService) ServiceLocator
        .getServiceWithName(SchemeExpertService.class.getName());

        if (this.sortSchemeRowList == null || sortSchemeRowList.size() <= 0) {
            if (!this.fromAddNewRow) {
                HttpServletRequest req = getServletRequest();
                if (req.getParameter("sorterSchemeId") != null) {
                    this.selectedSchemeId = Integer.parseInt(req
                            .getParameter("sorterSchemeId"));
                }
                log.info("Parameter scheme Id :" + this.selectedSchemeId);
                MachSorterSchemeLite sortScheme = schemeExpert
                        .getScheme(this.selectedSchemeId);
                sortSchemeRowList = (List) SortSchemeUtility
                        .getSortSchemeRow(sortScheme.getMachSortSchemeGroups());
            }
        }
        if (sortSchemeRowList.size() > 0) {
            return sortSchemeRowList;
        } else {
            addErrorMessage("No matching records found for selected criteria");
        }
        return sortSchemeRowList;
    }

    public void setSortSchemeRowList(List<SortSchemeRow> sortSchemeRowList) {
        this.sortSchemeRowList = sortSchemeRowList;
    }

    public List<SelectItem> getBinSwitchTypeList() {
        return binSwitchTypeList;
    }
    public boolean isFromAddNewRow() {
        return fromAddNewRow;
    }
    public void setFromAddNewRow(boolean fromAddNewRow) {
        this.fromAddNewRow = fromAddNewRow;
    }
    public List<SelectItem> getBinTypeList() throws BaajaException {
        return binTypeList;
    }
    public List<SelectItem> getAutoMachTypeList() throws BaajaException {
        log.info("autoMachTypeList ...........");
        return autoMachTypeList;
    }
    public List<SelectItem> getSortLevelTypeList() throws BaajaException {
        return sortLevelTypeList;
    }
    public List<SelectItem> getPlanetCodeTypeList() {
        return planetCodeTypeList;
    }
    public List<SelectItem> getSubMailTypeList() throws BaajaException {
        return subMailTypeList;
    }
    public List<SelectItem> getTrayLabelTypeList() throws BaajaException {
        return trayLabelTypeList;
    }
    public List<SelectItem> getMsMailTypeList() throws BaajaException {
        return msMailTypeList;
    }
    public List<SelectItem> getTrayBandingTypeList() {
        return trayBandingTypeList;
    }
    public Collection<Object> getSelection() {
        return selection;
    }
    public void setSelection(Collection<Object> selection) {
        this.selection = selection;
    }
    public int getSelectedSchemeId() {
        return selectedSchemeId;
    }
    public void setSelectedSchemeId(int selectedSchemeId) {
        this.selectedSchemeId = selectedSchemeId;
    }

} 
```

# jax-rs - 如何实现一个 Restlet JAX-RS 处理程序，它是一个 RESTful API 的瘦代理，可能在同一个 java 进程中实现？

> ID：15304733
> 
> 赞同：0
> 
> 时间：2013-03-08T22:56:57.493
> 
> 标签：jax-rs, restlet

我们有两个 RESTful API——一个是内部的，另一个是公共的，这两个由不同的 jar 实现。公共 API 封装了内部 API，执行以下步骤：

1.  做一些工作
2.  调用内部API
3.  做一些工作
4.  将响应返回给用户

可能会发生（尽管不一定）这两个 jar 在同一个 Java 进程中运行。

我们使用带有 JAX-RS 扩展的 Restlet。

这是一个简单的公共 API 实现示例，它只是转发到内部 API：

```
@PUT
@Path("abc")
public MyResult method1(@Context UriInfo uriInfo, InputStream body) throws Exception {
  String url = uriInfo.getAbsolutePath().toString().replace("/api/", "/internalapi/");
  RestletClientResponse<MyResult> reply = WebClient.put(url, body, MyResult.class);
  RestletUtils.addResponseHeaders(reply.responseHeaders);
  return reply.returnObject;
} 
```

在哪里`WebClient.put`：

```
public class WebClient {
  public static <T> RestletClientResponse<T> put(String url, Object body, Class<T> returnType) throws Exception {
    Response restletResponse = Response.getCurrent();
    ClientResource resource = new ClientResource(url);
    Representation reply = null;
    try {
      Client timeoutClient = new Client(Protocol.HTTP);
      timeoutClient.setConnectTimeout(30000);
      resource.setNext(timeoutClient);

      reply = resource.put(body, MediaType.APPLICATION_JSON);
      T result = new JacksonConverter().toObject(new JacksonRepresentation<T>(reply, returnType), returnType, resource);

      Status status = resource.getStatus();
      return new RestletClientResponse<T>(result, (Form)resource.getResponseAttributes().get(HeaderConstants.ATTRIBUTE_HEADERS), status);
    } finally {
      if (reply != null) {
        reply.release();
      }
      resource.release();
      Response.setCurrent(restletResponse);
    }
  }
} 
```

并且`RestletClientResponse<T>`是：

```
public class RestletClientResponse<T> {
  public T returnObject = null;
  public Form responseHeaders = null;
  public Status status = null;

  public RestletClientResponse(T returnObject, Form responseHeaders, Status status) {
    this.returnObject = returnObject;
    this.responseHeaders = responseHeaders;
    this.status = status;
  }
} 
```

并且`RestletUtils.addResponseHeaders`是：

```
public class RestletUtils {
  public static void addResponseHeader(String key, Object value) {
    Form responseHeaders = (Form)org.restlet.Response.getCurrent().getAttributes().get(HeaderConstants.ATTRIBUTE_HEADERS);
    if (responseHeaders == null) {
      responseHeaders = new Form();
      org.restlet.Response.getCurrent().getAttributes().put(HeaderConstants.ATTRIBUTE_HEADERS, responseHeaders);
    }
    responseHeaders.add(key, value.toString());
  }

  public static void addResponseHeaders(Form responseHeaders) {
    for (String headerKey : responseHeaders.getNames()) {
      RestletUtils.addResponseHeader(headerKey, responseHeaders.getValues(headerKey));
    }
  }
} 
```

问题是如果两个 jars 在同一个 Java 进程中运行，那么从内部 API 抛出的异常不会路由到内部 API 的 JAX-RS 异常映射器 - 异常向上传播到公共 API 并被转换为内部服务器错误 (500)。

这意味着我做错了。所以，我的问题是如何从公共 API 实现中调用内部 RESTful API，因为客户端和服务器都可以在同一个 Java 进程中运行。

当然，还有其他问题，但我有一种感觉，修复我刚才描述的问题也会解决其他问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T08:09:33.387

这个问题与内部和公共 JAR 都在同一个 JVM 中这一事实无关。它们完全由`WebResource.put()`方法分开，这会创建一个新的 HTTP 会话。因此，内部 API 中的异常不会传播到公共 API。

公共 API 中的内部服务器错误是由后处理机制引起的，该机制解释了内部 API 的输出并由于某种原因而崩溃。不要责怪内部 API，它是完全隔离的，不会造成任何麻烦（即使它在同一个 JVM 中）。

# c - OpenCV 错误 (cvCreateFileCapture())

> ID：15304737
> 
> 赞同：0
> 
> 时间：2013-03-08T22:57:08.243
> 
> 标签：c, video, opencv, avi

我正在使用 C 语言中的 OpenCV。我打算在窗口上运行视频（并在使用我制作的算法显示它们之前对帧进行一点图像处理）。但是以下行：

```
 CvCapture* capture = cvCreateFileCapture("eve.avi"); 
```

给我错误：

```
OpenCV Error: Bad flag (parameter or structure field) (Unrecognized or unsupported
array type) in cvGetMat, file /build/buildd/opencv-2.3.1/modules/core/src/array.cpp, 
line 2482 terminate called after throwing an instance of 'cv::Exception'
what():  /build/buildd/opencv-2.3.1/modules/core/src/array.cpp:2482: error: (-206) 
Unrecognized or unsupported array type in function cvGetMat 
```

我已经尝试了各种我发现的 .avi 文件，并且都产生了这个。使用 Ubuntu 12.10。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:08:28.000

尝试安装 ffmpeg 库：

```
sudo apt-get install libavformat-dev libswscale-dev 
```

如果它仍然损坏，请尝试使用已知有效的示例视频，（我会尝试在此期间找到一个并在我这样做时编辑这篇文章）。

编辑：试试这个。

[http://www.technical-recipes.com/2011/displaying-avi-video-using-opencv/](http://www.technical-recipes.com/2011/displaying-avi-video-using-opencv/)

# c# - 想要开发一个 Windows 服务作为其他应用程序的记录器

> ID：15304738
> 
> 赞同：0
> 
> 时间：2013-03-08T22:57:08.223
> 
> 标签：c#, .net, wcf, enterprise-library-5

我们的服务器上运行着许多应用程序，它们使用企业库进行日志记录。我们希望开发一个日志服务，它可以作为所有这些应用程序都可以调用的通用日志服务，这样它们都将记录到单个日志文件中，并且中央记录器将控制所有配置。我一直在为这项服务的外观寻找一些设计解决方案。它应该是带有 .net 远程处理或 WCF 接口的 Windows 服务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:00:17.050

我建议使用带有 IPC 通道的 .NET Remoting。

这是一个教程/示例： http: [//www.codeguru.com/csharp/csharp/cs_syntax/remoting/article.php/c9251/NET-Remoting-Using-a-New-IPC-Channel.htm](http://www.codeguru.com/csharp/csharp/cs_syntax/remoting/article.php/c9251/NET-Remoting-Using-a-New-IPC-Channel.htm)

我已经多次使用这种方法在多个应用程序/服务之间进行进程间通信。

另外，您是否考虑过使用类似 log4net 的东西？它非常强大。

[http://logging.apache.org/log4net/](http://logging.apache.org/log4net/)

我对 EntLib 的日志记录代码不太熟悉，但是 log4net 很棒。

另一种选择是仅构建所有应用程序都使用的单个共享程序集/项目 - 这样您就不需要在后台运行服务，但所有应用程序的代码都是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-18T03:27:35.393

Enterprise Library 有一个您可以使用的远程日志记录服务：http: [//nuget.org/packages/EnterpriseLibrary.Logging.Service/](http://nuget.org/packages/EnterpriseLibrary.Logging.Service/)。

它最初与 Silverlight 集成包一起发布，但只是一个 WCF 服务。

# winapi - 如何获取 HWND 并单击 Menu/SubMenu/SubMenuItem？

> ID：15304745
> 
> 赞同：1
> 
> 时间：2013-03-08T22:57:44.117
> 
> 标签：winapi, user-interface

我正在开发一个应用程序，它还有一个子菜单/一个子菜单，比如编辑 --> 插入 --> 日期和其他几个选项。我想单击（发送消息）到日期菜单项。是否有任何 PinvokeMethod 来处理多级菜单项？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:06:02.833

要模拟菜单的单击，您无需向菜单本身发送任何消息，您只需发送与单击菜单时相同的消息。即发送`WM_COMMAND`到菜单的所有者窗口，用旧的好`SendMessage`。

从菜单中选择选项时，参数为：

*   `wParam`：要发送的命令的标识符（低 16 位）。
*   `lParam`: `0`.

如果您不知道标识符的值，您可以使用监视器程序（例如`Spy++`（包含在大多数 VS 版本中）来列出您的程序发送/接收的消息。

# spotify - Spotify 开发者搜索

> ID：15304753
> 
> 赞同：0
> 
> 时间：2013-03-08T22:58:34.797
> 
> 标签：spotify

我对搜索功能在 Spotify API 中的工作方式感到困惑。他们的例子是这样的：

```
 var sp = getSpotifyApi();
    var models = sp.require('$api/models');

    var search = new models.Search('Rihanna');
    search.localResults = models.LOCALSEARCHRESULTS.APPEND;

    var searchHTML = document.getElementById('results');

    search.observe(models.EVENT.CHANGE, function() {
        var results = search.tracks;
        var fragment = document.createDocumentFragment();
        for (var i=0; i<results.length; i++){
            var link = document.createElement('li');
            var a = document.createElement('a');
            a.href = results[i].uri;
            link.appendChild(a);
            a.innerHTML = results[i].name;
            fragment.appendChild(link);
        }

        searchHTML.appendChild(fragment);
    });

    search.appendNext(); 
```

所以，我猜调用 appendNext() 会启动搜索，当有结果时调用内部函数？但结果仅限于总数的一定数量（默认为 50）。你怎么得到剩下的？您是否从回调内部再次递归调用 appendNext() ？另外，这是否意味着在您这样做之后，您的列表包括原始结果，或者原始结果被替换？有人知道搜索*所有*可用结果的示例吗？

他们还提到，如果搜索正在运行，则 appendNext() 什么也不做。那么如何优雅地等待当前搜索完成后再获取下一个“页面”？

他们的文档很糟糕，恕我直言。假设您总共有 1000 个来自服务器的搜索结果。并说我想看到结果 900-1000。我必须一遍又一遍地调用 AppendNext 直到达到 900 吗？

谢谢鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T08:24:14.093

使用 Spotify Apps API 中内置的搜索功能时没有分页。您可以增加结果的数量，使其返回 50 多个结果（请参阅[文档中的搜索页面](https://developer.spotify.com/technologies/apps/docs/833e3a06d6.html)），尽管数量有限（目前似乎是 200 个曲目）。

还有一种替代方法，它改为执行对[Web API](https://developer.spotify.com/technologies/web-api/search/)的请求。

# javascript - 针对网站的不同安全措施（HTTP 标头等）

> ID：15304759
> 
> 赞同：4
> 
> 时间：2013-03-08T22:59:12.663
> 
> 标签：javascript, security, http-headers, webpage

这是一个开放式问题，对此我深表歉意。但我认为它很有用，我希望它不会被关闭。

我正在处理一个处理高度敏感内容的网站，我希望尽可能地确保它的安全。

刚才我遇到了`X-Frame-Options`HTTP-Header，我可以用它[禁止页面显示在框架内](https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options)，从而防止对我的页面进行[“点击劫持”](http://en.wikipedia.org/wiki/Clickjacking)攻击。

您可能会建议一些参考资料，其中提供了我应该了解的所有安全措施的完整列表（例如 SSL（当然）、HTTP 标头（如`Strict-Transport-Security`和`X-Content-Security-Policy`）、客户端 AES 加密......）？

是否有其他（可能鲜为人知的）安全功能您认为与我相关（例如，是否可以阻止插件、阻止书签、禁止 Opera Mini 等代理浏览器......）？

我希望这个问题的答案将共同产生一个有用的清单，以确保我（和其他人）不会错过任何保护内容的主要安全功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:23:38.967

从[Open Web Application Security Project Top 10 漏洞文档](http://owasptop10.googlecode.com/files/OWASP%20Top%2010%20-%202013%20-%20RC1.pdf)开始。如果您可以采取适当的措施来避免其中描述的漏洞，那么您将比那里的绝大多数网站更安全。在那之后，可能是时候从安全专家那里获得帮助，进行一些渗透测试，寻求解决更隐蔽的漏洞等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T15:42:06.140

对于问题的 HTTP 标头方面，请查看[Secure HTTP Headers](http://www.slideshare.net/akashm/secure-http-headers-c0c0n-2011-akash-mahajan)幻灯片演示文稿和 Mozilla Developer Network[保护您的站点](https://developer.mozilla.org/en-US/docs/Security/Securing_your_site)文档。

以下是一些特定的 HTTP 响应标头

*   Set-Cookie（[安全和 HttpOnly 属性](http://en.wikipedia.org/wiki/HTTP_cookie#Secure_and_HttpOnly)）
*   [X 框架选项](https://developer.mozilla.org/en-US/docs/HTTP/X-Frame-Options)
*   [X-XSS-保护](http://blogs.msdn.com/b/ieinternals/archive/2011/01/31/controlling-the-internet-explorer-xss-filter-with-the-x-xss-protection-http-header.aspx)
*   [X-Content-Type-Options](http://blogs.msdn.com/b/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)
*   [X-Content-Security-Policy](https://developer.mozilla.org/en-US/docs/Security/CSP/Introducing_Content_Security_Policy)或[Content-Security-Policy](http://www.html5rocks.com/en/tutorials/security/content-security-policy/)
*   [严格的运输安全](https://developer.mozilla.org/en-US/docs/Security/HTTP_Strict_Transport_Security)

请注意，不同的浏览器及其版本具有不同的支持级别，因此除了安全和 httponly cookie 之外，您的 IE7 用户可能看不到任何好处。

# openmp - 在 OpenMP 中，firstprivate 和 lastprivate 与 private 子句有何不同？

> ID：15304760
> 
> 赞同：87
> 
> 时间：2013-03-08T22:59:13.353
> 
> 标签：openmp

我看过官方定义，但我仍然很困惑。

> `firstprivate`: 指定每个线程应该有自己的变量实例，并且该变量应该用变量的值初始化，因为它存在于并行构造之前。

对我来说，这听起来很像私人的。我找了一些例子，但我似乎不明白它有什么特别之处或如何使用它。

> `lastprivate`：指定封闭上下文的变量版本设置为等于执行最终迭代（for-loop 构造）或最后部分（#pragma 部分）的线程的私有版本。

由于以下示例，我觉得我对这一点的理解更好：

```
#pragma omp parallel
{
   #pragma omp for lastprivate(i)
      for (i=0; i<n-1; i++)
         a[i] = b[i] + b[i+1];
}
a[i]=b[i]; 
```

所以，在这个例子中，我理解`lastprivate`允许`i`在循环之外返回它的最后一个值。

我今天刚开始学习 OpenMP。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2013-03-09T10:13:22.197

`private`变量没有初始化，即它们像任何其他本地自动变量一样以随机值开始（并且它们通常使用每个线程堆栈上的自动变量来实现）。以这个简单的程序为例：

```
#include <stdio.h>
#include <omp.h>

int main (void)
{
    int i = 10;

    #pragma omp parallel private(i)
    {
        printf("thread %d: i = %d\n", omp_get_thread_num(), i);
        i = 1000 + omp_get_thread_num();
    }

    printf("i = %d\n", i);

    return 0;
} 
```

使用四个线程，它输出如下内容：

```
thread 0: i = 0
thread 3: i = 32717
thread 1: i = 32717
thread 2: i = 1
i = 10

(another run of the same program)

thread 2: i = 1
thread 1: i = 1
thread 0: i = 0
thread 3: i = 32657
i = 10 
```

这清楚地表明 的值`i`在并行区域内是随机的（未初始化），并且在并行区域之后对其进行的任何修改都不可见（即变量在进入该区域之前保持其值）。

如果`i`是 made `firstprivate`，则使用它在并行区域之前的值进行初始化：

```
thread 2: i = 10
thread 0: i = 10
thread 3: i = 10
thread 1: i = 10
i = 10 
```

`i`在它之后仍然看不到并行区域内的值的修改。

您已经知道`lastprivate`（它不适用于简单的演示程序，因为它缺少工作共享结构）。

所以是的，`firstprivate`而且`lastprivate`只是`private`. 第一个导致将来自外部上下文的值引入并行区域，而第二个将值从并行区域传输到外部上下文。这些数据共享类背后的基本原理是，在并行区域内，所有私有变量都会遮蔽外部上下文中的私有变量，即不可能使用赋值操作来修改`i`并行区域内部的外部值。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-01-20T10:10:27.233

`firstprivate`并且`lastprivate`只是 的特例`private`。

第一个导致将来自外部上下文的值引入并行区域，而第二个导致将值从并行区域传输到外部上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-07T12:27:32.247

在初始化之前不能使用局部变量`i`，程序会报错，因为 C++ 14 标准。

# sql - 在 SELECT 语句上使用 NOLOCK 的目的是什么？

> ID：15304764
> 
> 赞同：2
> 
> 时间：2013-03-08T22:59:27.233
> 
> 标签：sql, select, nolock

任何人都可以提出在 SELECT 语句上发出 NOLOCK 的充分理由吗？

我正在重构一些随处可见的存储过程，据我了解，SELECT 语句上的 NOLOCK 几乎毫无用处。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T23:34:47.630

我已经看到一些不好的信息飞来飞去。选择上的 WITH(NOLOCK) 不是在需要速度的地方使用的性能工具。阅读这篇[文章](http://blogs.msdn.com/b/davidlean/archive/2009/04/06/sql-server-nolock-hint-other-poor-ideas.aspx)，它转储了 eSamuel 提供的答案，因为这*是*大多数人的想法，正如您从投票中看到的那样。不知道但会反省他们所听到的内容的人应该如何做。首先学习优化您的数据和查询。NOLOCK 提示只应在您始终处理记录被死锁或 NOLOCK 提供解决方案的其他问题的系统中使用。

我在一家金融机构工作，开发[OLTP](http://en.wikipedia.org/wiki/Online_transaction_processing)系统，该系统每分钟处理大量交易并为客户和客户提供实时报告功能。这些人整天都在读取我们的新数据，如果我们不使用 NOLOCK 进行报告查询，那么死锁发生只是时间问题。

在将 NOLOCK 视为 SQL 查询速度的圣杯之前，请尽职调查并阅读信誉良好的专业资源，因为它还有更多功能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-08T23:03:51.130

所以`SELECT`不会被并发数据修改查询阻塞。

有些人认为这是一个神奇的更快的按钮并自由地应用它。它可能比无用更糟糕，除非您的用例接受读取脏（未提交）数据的可能性，这些数据可能在您读取后回滚（因此从逻辑上不存在）以及某些类型异常的可能性更大。

与读取提交隔离级别相比`nolock`，您的扫描丢失数据、读取两次或因数据移动错误而完全失败的可能性更大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T23:04:13.293

NOLOCK 相当于事务上的 READ-UNCOMMITTED。

简而言之，使用 NOLOCK 可确保您的 SELECT 语句快速，因为它不必等待现有锁或事务完成即可返回查询结果。不利的一面是，您最终可能会拉回“脏”数据——这些数据可能在提交之前但在运行 SELECT 语句之后已经回滚。

可以[在 SQL Server 中使用 NOLOCK 和 READPAST 表提示中](http://www.techrepublic.com/article/using-nolock-and-readpast-table-hints-in-sql-server/6185492)找到其他信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T23:16:09.183

* * *

如果您从内容很少更改的查找表中读取，NoLocks 尤其有用。

当然，nolock 的问题在于，如果正在更新表，您可能会得到错误的数据。对于不断更新的表，在某些情况下可以正确使用 nolock。例如，您有一张桌子：

UserConfig { id int PRIMARY KEY，is_active_flag 位，allow_x_feature 位，allow_y_feature 位}

如果您正在运行选择查询并按 id 过滤，那么即使此表经常更新，您也希望使用 nolock。

# ios - 如何在一个应用中授权多个 Dropbox 帐户？

> ID：15304767
> 
> 赞同：2
> 
> 时间：2013-03-08T22:59:33.690
> 
> 标签：ios, cocoa-touch, ios6, dropbox-api

我正在寻找更新我的一个应用程序（它是一个 Dropbox 客户端）以支持多个帐户，但我似乎无法找到一种方法来做到这一点。

SDK我分析过很多次，看多少次，好像一个使用官方SDK的账号一次只能支持一个账号。尽管我确信它可以支持更多，因为我知道许多允许您链接多个应用程序的应用程序。

任何有关这样做的指示都将受到高度赞赏。我什至找不到获取令牌以稍后单独存储它们的方法。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-09T00:06:08.310

我发现这是一个挑战，但经过大量实验后终于成功了。以下是一些应该有所帮助的信息：

一旦用户获得授权，每个 Dropbox (DB) 帐户都有一个与之关联的用户 ID (uid)。在您自己的帐户模型中，您需要跟踪 uid。最初，在用户链接他们的数据库帐户之前，此 uid 将是`nil`.

当用户想要访问他们的数据库帐户时，您将获得该帐户的关联 uid。如果 uid 不是 nil 你设置`DBRestClient`如下：

```
_client = [[DBRestClient alloc] initWithSession:[DBSession sharedSession] userId:uid]; 
```

如果尚未设置 uid，则需要显示登录屏幕。

```
[[DBSession sharedSession] linkFromController:someController]; 
```

当然，这会启动 DB 应用程序以显示登录信息（如果未安装 DB 应用程序，则显示 Web 界面）。无论哪种方式，当用户完成授权过程时，DB 将再次启动您的应用程序。

在您的应用程序委托的`application:openURL:sourceApplication:annotation:`方法中，您可以执行以下操作：

```
if ([[DBSession sharedSession] handleOpenURL:url]) {
    NSString *query = url.query;
    if ([[url absoluteString] rangeOfString:@"cancel"].location == NSNotFound) {
        NSDictionary *urlData = [DBSession parseURLParams:query];
        NSString *uid = [urlData objectForKey:@"uid"];
        if ([[[DBSession sharedSession] userIds] containsObject:uid]) {
            // At this point we know the login succeeded and we have the newly linked userid
            // make a call to process the uid
        }
    } else {
        // user cancelled the login
    }
} 
```

在处理新链接的 uid 的代码中，您可以将 uid 存储在您自己的帐户数据模型中。然后你使用 uid 来创建`DBRestClient`我之前展示的那样。

如果您有 uid，您可以通过简单的检查来确定该 uid 是否正确链接：

```
if ([[[DBSession sharedSession] userIds] containsObject:uid]) {
    // the uid is linked
} 
```

要根据用户的 uid 取消链接用户，您可以执行以下操作：

```
[[DBSession sharedSession] unlinkUserId:uid]; 
```

那时我还会从您自己的帐户模型中清除保存的 uid。

希望这足以构成拼图。祝你好运。

# c++ - 创建自定义语音命令 (GNU/Linux)

> ID：15304768
> 
> 赞同：2
> 
> 时间：2013-03-08T22:59:40.840
> 
> 标签：c++, c, linux, speech-recognition, audio-fingerprinting

我正在为个人项目寻求建议。

我正在尝试创建一个用于创建自定义语音命令的软件。目标是允许用户/我记录一些音频数据（2/3 秒）以定义命令/宏。然后，当用户说话（录制相同的音频数据）时，将执行命令/宏。该软件必须能够在低成本计算机（例如 RaspberryPi）中在不到 1 秒的处理时间内检测到命令。

我已经通过两种方式进行了搜索： - 语音识别（CMU-Sphinx，Julius，simon）：有很好的开源解决方案，但它们通常需要大型数据库文件，而语音识别并不是我真正想要做的。对于一个小功能，语音识别可能会消耗过多的电量。- 音频指纹（Chromaprint -> [http://acoustid.org/chromaprint](http://acoustid.org/chromaprint)）：这似乎是我要找的。原理是从原始音频数据创建指纹，然后比较指纹以确定它们是否相同。但是，这种软件/库似乎是为歌曲识别而设计的（如智能手机上的著名软件）：我正在尝试配置一个好的“比较器”，但我认为我的做法很糟糕。

你知道一些专门的软件或代码包做类似的事情吗？

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-18T10:54:13.563

我有一个或多或少类似的项目，我打算向机器人发送语音命令。语音识别软件对于这样的任务来说太复杂了。我使用 C++ 中的 FFT 实现来提取采样语音的傅立叶分量，然后创建主频率（目标语音命令具有最高幅度的频率）的直方图。我尝试了两种方法：

1.  比较给定语音命令的直方图与保存在内存中的直方图之间的相似性，以确定最可能的命令。

2.  使用支持向量机 (SVM) 训练分类器以区分语音命令。我使用[了 LibSVM](http://www.csie.ntu.edu.tw/~cjlin/libsvm/)，结果比第一种方法好得多。但是，SVM 方法的一个问题是您需要一个相当大的数据集进行训练。另一个问题是，当给出一个未知的声音时，分类器无论如何都会输出一个命令（这显然是一个错误的命令检测）。这可以通过我有相似性度量阈值的第一种方法来避免。

我希望这可以帮助您实现自己的语音激活软件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T09:09:51.037

歌曲指纹对于该任务来说不是一个好主意，因为命令时间可能会有所不同，并且指纹需要精确的时间匹配。然而，它很容易实现与 DTW 算法的时间序列匹配和使用 CMUSphinx 库 Sphinxbase 提取的特征。有关详细信息，请参阅有关 DTW 的 Wikipedia 条目。

[http://en.wikipedia.org/wiki/Dynamic_time_warping](http://en.wikipedia.org/wiki/Dynamic_time_warping)

[http://cmusphinx.sourceforge.net/wiki/download](http://cmusphinx.sourceforge.net/wiki/download)

# c# - 为什么不鼓励 Debug.Print？

> ID：15304769
> 
> 赞同：2
> 
> 时间：2013-03-08T22:59:49.843
> 
> 标签：c#, visual-studio, debugging

我在 SO 上看到了一些不同的答案，它们不鼓励在调试应用程序时使用 Debug.Print .. 但没有人确切地知道它为什么不好。当然，我用谷歌搜索了它，但结果没有找到任何可用的东西。

谁能澄清为什么 Debug.Print 如此糟糕？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:03:25.470

它很吵——所有的调试语句最终都混在一起了。

它很容易被遗漏——该流中还有大量其他输出，很容易遗漏。

它没有提供足够的上下文 - 没有堆栈跟踪，如果您忘记包含它们，则没有当前变量值，等等......

它只去一个地方（调试输出），所以很难发送到磁盘文件、数据库等。

基本上，它对日志记录没有好处，因为你无法控制它的去向，而且它对调试也没有好处，因为调试器做得更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T23:13:13.577

它真的没有什么问题，只有更好的选择。

如果你要输出数据，你也可以记录它。如果你这样做，你实际上会从投资中得到一些回报。

此外，打印出变量信息不如设置断点并在调试器中检查这些值有效。特别是在这些工具非常出色的 VS 中。

# java - 在java中使用postagger后从单词中删除标签

> ID：15304774
> 
> 赞同：2
> 
> 时间：2013-03-08T23:00:12.713
> 
> 标签：java, string, nlp

我使用斯坦福的 NLP postagger 标记程序中的名词、形容词。

```
 interest_NN 
    bui_NNS 
    ground_VBP
     avail_NN 
    respond_NN
     detail_NN 
    like_IN 
    quickli_NNS
    current_JJ 
```

现在我必须只选择那些带有标签 _NN,_NNS,_JJ 的单词，并从单词中删除这些标签。

```
 quickli
    current
    avail 
```

我尝试这样从单词中删除 -NN 标记。但是它删除了前 2words 标签并从中获得了异常

```
 while(tagread.hasNext())
           {
        String s=tagread.next();

        int flag=1;
        jTextArea2.append("\n" +s.toLowerCase());

        String ofInterest2 = s.substring(0, s.indexOf("_NN"));

         for(int i=0;i<s.length();i++){
             if(s.equals(ofInterest2))
                 {
                 flag=0;
                 }
         }
         if(flag!=0)
         {
             System.out.println(ofInterest2);

         }
    } 
```

例外：

```
 java.lang.StringIndexOutOfBoundsException: String index out of range: -1
at java.lang.String.substring(Unknown Source) 
```

那么我的方法有什么问题？或如何进一步进行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:02:05.863

不要使用字符串方法来删除标记文本；使用 NLP 的 API 提取词性进行比较。

生成一个对象`List`，`TaggedWord`然后使用[TaggedWord API](http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/ling/TaggedWord.html)直接提取词性：

```
// Call the API to parse your sentence.
List<TaggedWord> words = tagger.tagSentence( ... );

// For each word tagged in the sentence...
for( TaggedWord word : words ) {
  String tag = word.tag();

  // Check the part-of-speech directly, without having to parse the string.
  if( "NN".equalsIgnoreCase( tag ) ) {
    System.out.printf( "%s is a noun\n", word.word() );
  }
} 
```

另请参阅斯坦福的 NLP API：

*   [http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/ling/Word.html](http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/ling/Word.html)
*   [http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/ling/TaggedWord.html](http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/ling/TaggedWord.html)
*   [http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/tagger/maxent/MaxentTagger.html](http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/tagger/maxent/MaxentTagger.html)

要检查名词，您应该避免以下情况：

```
if( "NN".equalsIgnoreCase( tag ) ) {
  System.out.printf( "%s is a noun\n", word.word() );
} 
```

这是因为词性可以以多种方式标记（例如，NN、NNS）。您可以使用正则表达式或[`startsWith`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#startsWith%28java.lang.String%29).

您应该要求作者`TaggedWord`提供一个`isNoun`. `isVerb`，`isNounPlural`以及其他类似的方法。也就是说，是的，您可以使用正则表达式来匹配字符串。我还在`startsWith`我的代码中使用来检查名词，因为它比正则表达式更快。例如：

```
if( tag != null && tag.toUpperCase().startsWith( "NN" ) ) {
  System.out.printf( "%s is a noun\n", word.word() );
} 
```

要真正实现 OO，请注入 TaggedWord 的子类以供标注器使用。然后子类将公开该`isNoun`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:03:50.003

`indexOf`当您提供的参数在字符串中找不到时返回 -1。在这条线上：

```
String ofInterest2 = s.substring(0, s.indexOf("_NN")); 
```

`s.indexOf`可能在字符串中找不到“_NN” `s`。然后，当您请求从`0`to `-1`of s 的子字符串时，这是没有意义的，因此您会得到一个异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T23:04:09.197

您正在尝试获取整个文本“ground_VBP”的子字符串，但您传入了`s.indexOf("_NN")`. 未找到子字符串，因此返回`-1`. 但是`-1`不是`substring`函数的有效索引，所以`substring`扔了`StringIndexOutOfBoundsException`你报告的。

`indexOf`如果方法返回 0 或更大的值（即找到），您应该只使用子字符串。

# python - 如何为没有 .py 文件扩展名的 Python 代码配置 .vimrc？

> ID：15304776
> 
> 赞同：1
> 
> 时间：2013-03-08T23:00:24.223
> 
> 标签：python, vi

所以，我对 Python 的 .vimrc 配置非常满意——除了我开始为脚本去掉 .py 后缀，现在 vim 不知道我正在编辑的文件是 Python 文件。

澄清：我已经确认 vim 知道我正在使用 :echo &filetype 编辑一个 python 文件，它报告回 'python'。

所以，真正的问题是当我目前为此目的使用文件扩展名时如何分配特定于 python 的行为（见下文）。可以用文件类型驱动吗？两者都需要吗？

关于缺少后缀 - 我的代码仅适用于 unix 主机，这是司空见惯的，我喜欢隐藏实现细节，以便以后可以假设更改实现。

这是我的 .vimrc 的一小部分：

```
au BufRead,BufNewFile *py,*pyw   set tabstop=4
au BufRead,BufNewFile *.py,*pyw  set shiftwidth=4
au BufRead,BufNewFile *.py,*.pyw set expandtab
au BufRead,BufNewFile *.py,*pyw  set softtabstop=4
au BufRead,BufNewFile *.py,*.pyw set textwidth=79 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:05:56.537

为没有任何扩展名的文件启用 python 特定设置的关键是启用[文件类型插件](http://vimdoc.sourceforge.net/htmldoc/filetype.html)，并且可以选择教 Vim Python 文件的外观。

修改这些文件：

**$HOME/.vimrc**

在 Vim 中启用文件类型插件。这允许将特定于语言的设置放入`$HOME/.vim/ftplugin/`目录中。这些设置基于文件类型，而不是文件扩展名。

```
filetype plugin on
syntax on 
```

**$HOME/.vim/scripts.vim**

教 Vim Python 文件长什么样。`python`在这个例子中，如果文件在第一行的某处包含字符串，Vim 将文件视为 python 脚本。您可以在此处轻松调整正则表达式以包含更高级的检查。

请注意，`did_filetype()`确保`python`在第一行没有 .py 扩展名的文件仍被视为 python 脚本。

```
if did_filetype()
    finish
endif
if getline(1) =~ '.*python.*'
    setfiletype python
endif 
```

**$HOME/.vim/ftplugin/python.vim**

最后，将所有特定于 python 的设置放在这里：

```
setlocal tabstop=4
setlocal shiftwidth=4
setlocal expandtab
setlocal softtabstop=4
setlocal textwidth=79 
```

* * *

**更多信息：**

`scripts.vim`如果文件有一些标准的 python 头文件，例如，`#!/usr/bin/python`或者`#!/usr/bin/env python`.

正在执行此启发式`/usr/share/vim/vim73/scripts.vim`（您的路径可能不同，具体取决于 Vim 版本和安装位置）。

# c# - EF 5 在 .net 4 中异步加载数据

> ID：15304777
> 
> 赞同：1
> 
> 时间：2013-03-08T23:00:25.803
> 
> 标签：c#, telerik, task-parallel-library, entity-framework-5

我需要从数据库中加载一些数据，但是因为我需要加载所有这些数据，所以我的 Windows 屏幕（Windows 窗体）冻结了，所以我尝试使用以下代码：

```
var data = Task.Factory.StartNew(() =>
            {
                repository = ObjectFactory.GetInstance<ILibriRepository>();
                librat = repository.GetAll().ToList();//

            });
data.ContinueWith((a) =>
{
    librat.ForEach(c => lvLista.Items.Add(new LibraListViewItem(c)));
}, CancellationToken.None, TaskContinuationOptions.None, uiScheduler); 
```

但即使这样，当数据加载并需要在 ListView 中呈现时，屏幕也会冻结。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:27:32.540

20 秒的延迟可能不会在查询运行时发生，而是由于将所有项目添加到列表视图（这必须在 UI 线程上发生）。

这里有一些可能会有所帮助的东西：

在您的 ContinueWith 中，`ListView.BeginUpdate()`在开始循环之前调用，并`ListView.EndUpdate()`在完成时调用。

这将防止列表尝试为您添加到其中的每个项目重新绘制自身。

# python - 是否可以使用 python 更改 ms 访问表名称

> ID：15304779
> 
> 赞同：1
> 
> 时间：2013-03-08T23:00:41.637
> 
> 标签：python, ms-access

我有几个 ms 访问数据库，每个数据库都有一个名为`PlotStatus-name-3/13/12`.

我需要将这些表中的每一个导入到一个`.csv`表中。如果我手动将表的名称更改为`PlotStatus_name_3_13_12`，则此代码有效。**有谁知道如何使用 python 更改表名？**

```
#connect to access database
for filename in os.listdir(prog_rep_local):
if filename[-6:] == ".accdb":
    DBtable = os.path.join(prog_rep_local, filename)
    conn = pyodbc.connect(r'DRIVER={Microsoft Access Driver (*.mdb, *.accdb)};DBQ=' + DBtable)
    cursor = conn.cursor()
    ct = cursor.tables
    for row in ct():
        rtn = row.table_name
        if rtn[:10] == "PlotStatus":

            #this does not work:
            #Oldpath = os.path.join(prog_rep_local, filename, rtn)
            #print Oldpath
            #fpr = Oldpath.replace('-', '_')#.replace("/","_")
            #print fpr
            #newname = os.rename(Oldpath, fpr)  this does not work
            #print newname
            #spqaccdb = "SELECT * FROM " + newname

            #this workds if I manually change the table names in advance
            sqlaccdb = "SELECT * FROM " + rtn
            print sqlaccdb

            cursor.execute(sqlaccdb)
            rows = cursor.fetchall() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:04:24.377

一个更简单的解决方案是在表名周围添加方括号，这样 /s 就不会抛出 SQL 命令解释器。

```
sqlaccdb = "SELECT * FROM [" + rtn + "]" 
```

# sql - SQL语句格式化表数据

> ID：15304784
> 
> 赞同：0
> 
> 时间：2013-03-08T23:01:08.220
> 
> 标签：sql, oracle, oracle11g

我有一个下表，需要使用普通 sql 获取输出，如下所示 2。如果对于 的*任何*相同值`columnC`确实有“Y” ，则成功计数应为 +1，否则应将其添加到失败计数列输出。我们可以编写一个 SQL（在 Oracle 中）来获得如下所述的输出吗？暂时可以忽略。*`ColumnA``ColumnD`*

 *# 1\. 表

```
ColumnA   ColumnB    ColumnC    ColumnD     File_type
--------  ---------  --------   ----------  ------------
11111     A          N          NULL        typeA
11111     B          N          NULL        typeA
11111     C          Y          SPILL       null
11111     D          N          NULL        typeA
22222     A          N          SPILL       typeA
22222     B          Y          SPILL       typeA
22222     C          N          NULL        null
22222     D          N          NULL        typeA
33333     A          N          NULL        typeA
33333     B          N          NULL        null
33333     C          N          NULL        typeA
33333     D          N          NULL        typeA
111110    A          N          NULL        typeB
111110    B          N          NULL        typeB
111110    C          Y          SPILL       null
111110    D          N          NULL        typeB
222220    A          N          SPILL       typeB
222220    B          Y          SPILL       typeB
222220    C          N          NULL        null
222220    D          N          NULL        typeB
333330    A          N          NULL        typeB
333330    B          N          NULL        null
333330    C          Y          SPILL       typeB
333330    D          N          NULL        typeB 
```

**2\. 所需输出**

```
File_type        ColumnD  Success_cnt    Fail_cnt
----------       -------- -----------    -----------
typeA             SPILL         2          1
typeB             SPILL         3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T01:29:03.873

这是我试图理解你的任务：

```
SELECT r.File_type, SUM(CASE WHEN r.cnt > 0 THEN 1 ELSE 0 END) success, 
                    SUM(CASE WHEN r.cnt = 0 THEN 1 ELSE 0 END) fail
FROM
(SELECT t.File_type,  SUM(CASE WHEN t.ColumnC = 'Y' THEN 1 ELSE 0 END) cnt
FROM Table1 t
WHERE t.File_type IS NOT NULL
GROUP BY t.file_type, t.ColumnA) r
GROUP BY r.File_type; 
```

我根本没有使用`ColumnB`和`ColumnC`。

这是此任务的[SQL Fiddle](http://sqlfiddle.com/#!4/60b35/1)。我使用了简化的数据样本。您可能想尝试使用不同的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:04:48.373

尝试这个

```
with CTE as
(
    select A.columnA, columnc,
    row_number() over (partition by columnA order by columnc desc) rnk
    from T  A  
), cte2 as
(
    SELECT distinct columna, file_type from t where file_type is not null
), cte3 as
(
     select distinct columnd, file_type from t 
     where file_type is not null and columnd is not null
)
select a.file_type, a.columnd, 
count(case when columnc = 'Y' then 1 end) Success_cnt,
count(case when columnc = 'N' then 1 end) fail_cnt
from cte3 a 
inner join cte2 b on a.file_type = b.file_type
inner join
(select * from cte where rnk = 1) c on b.columnA = c.columnA
group by a.file_type, a.columnd 
```

[SQL 演示](http://sqlfiddle.com/#!4/1ed45/28)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T04:55:42.273

一种方法是使用光标。您可以遍历记录并根据需要增加变量。你已经试过了吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T23:10:01.063

您可以忽略 columnA 输出，或者在外部选择中将其作为派生表运行...

```
SELECT
   ColumnA,
   File_type,
   CountIf(Max(ColumnC),'Y') as "Success_cnt",
   CountIf(Max(ColumnC),'N') as "Fail_cnt"
FROM
   table
Group By
   ColumnA,
   File_type 
```*

# python - 在自制软件中，如何将 python3 符号链接更改为仅“python”

> ID：15304785
> 
> 赞同：13
> 
> 时间：2013-03-08T23:01:11.130
> 
> 标签：python, symlink, homebrew

我想使用自制软件安装 python，我注意到它有 2 个不同的公式，一个用于 python 2.x，另一个用于 3.x。第一个符号链接“python”，另一个使用“python3”。所以我跑了`brew install python3`。

我真的只关心使用 python 3，所以我希望默认命令是“python”，而不是每次都输入“python3”。有没有办法做到这一点？我试过`brew switch python 3.3`了，但出现“地窖中找不到 python”错误。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T23:07:43.640

你绝对*不想*这样做！您可能只关心 Python 3，但许多人编写的代码希望`python`符号链接到 Python 2。更改此设置会严重破坏您的系统。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-08-05T17:06:05.500

如果您这样做是为了个人使用，请不要更改`python`. 您的许多系统程序都依赖于`python`指向 Python 2.6，如果您更改符号链接，您将破坏它们。

取而代之的是，选择一个较短的名称，`py`并在 中为其写一个别名`~/.bashrc`，例如`alias py=python3`。

例如，通过测试：

```
$ echo "alias py=python3" >> ~/.bashrc
$ bash
$ py
>>> 3+3
6 
```

这将为您提供便利，而不会影响系统或其他用户。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-19T10:22:58.410

如果您绝对确定您永远不想安装/使用 Python 2，我认为您可以在 /usr/local/bin 中创建额外的符号链接。检查链接到某物的所有内容

```
../Cellar/python3/3.3.0/ 
```

并创建一个末尾没有 3 的链接，例如

```
python -> ../Cellar/python3/3.3.0/bin/python3 
```

不过三思而后行，为什么要放弃两个 Python 并排的优势呢？也许只是按预期使用自制 Python，并使用 virtualenv 创建您的 Python 3 环境。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-23T13:42:54.497

是的，对于 python 3使用 [虚拟环境] ( [https://docs.python.org/3/library/venv.html ) 比使用系统默认值要好得多](https://docs.python.org/3/library/venv.html)

```
pyvenv /path/to/new/virtual/environment 
```

这会将 python 3 设置为默认设置，并将安装`python`隔离`pip`到该环境，这是您想要在任何项目上执行的操作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-03-12T04:55:15.433

如前所述，这不是最好的主意。但是，必要时最简单的做法是在终端中运行 python3。如果你需要为 python3 运行一些东西，那么运行 python3

# c# - DataGridView CellContentChanged 事件 - StackOverflow 异常 - 奇怪的情况

> ID：15304786
> 
> 赞同：0
> 
> 时间：2013-03-08T23:01:11.543
> 
> 标签：c#, datagrid

我正在尝试从 datagridviewcell 中获取值并计算和更改另一个单元格的值。

由于某种原因，我遇到了堆栈溢出异常，代码：

```
private void grdWarehouseCounts_CellContentChanged(object sender, DataGridViewCellEventArgs e)
{
  // calculate variance
  DataGridView sendergrid = (DataGridView)sender;
  if (sendergrid.SelectedCells[0].ColumnIndex == 3)
  {
    decimal Qty = Convert.ToDecimal(sendergrid.Rows[sendergrid.SelectedCells[0].RowIndex].Cells[3].Value);
    decimal Count = Convert.ToDecimal(sendergrid.Rows[sendergrid.SelectedCells[0].RowIndex].Cells[4].Value);
                sendergrid.Rows[sendergrid.SelectedCells[0].RowIndex].Cells[4].Value = Qty - Count;
  }
} 
```

这是网格：

![在此处输入图像描述](../Images/111eee6c90f7b2d4867c2a23fdacfa6a.png)

我花了很多时间试图弄清楚这一点，这让我发疯。

其他人可以看到我做错了什么，因为我对此很陌生吗？

有什么常见的陷阱吗？

克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:23:26.627

试试这个（而不是使用`SelectedCells[0]`，使用`e.ColumnIndex`和`e.RowIndex`）：

```
private void grdWarehouseCounts_CellContentChanged(object sender, DataGridViewCellEventArgs e)
{
  // calculate variance
  DataGridView sendergrid = (DataGridView)sender;

  //if (sendergrid.SelectedCells[0].ColumnIndex == 3)
  if (e.ColumnIndex == 3)
  {
    decimal Qty = Convert.ToDecimal(sendergrid.Rows[e.RowIndex].Cells[3].Value);
    decimal Count = Convert.ToDecimal(sendergrid.Rows[e.RowIndex].Cells[4].Value);
    sendergrid.Rows[e.RowIndex].Cells[4].Value = Qty - Count;
  }
} 
```

# c - 我的语法中的函数定义问题

> ID：15304788
> 
> 赞同：3
> 
> 时间：2013-03-08T23:01:23.477
> 
> 标签：c, function, antlr, grammar, multiplication

我的 C 语法中的函数定义有问题，可以在这里找到[http://www.archive-host.com/files/1959635/24fe084677d7655eb57ba66e1864081450017dd9/cAST.txt](http://www.archive-host.com/files/1959635/24fe084677d7655eb57ba66e1864081450017dd9/cAST.txt)，它没有正确定义，我不能乘它通过一些东西。我想输入的代码是这个：

```
int factorielle(int n)
  { int x;
   if ( n == 0)
  return 1;
   else return n*factorielle(n-1);
  } 
```

函数定义是这样的：

```
function_definition
    : declaration_specifiers declarator compound_statement
    | declarator compound_statement
    ; 
```

declaration_specifiers 应该链接到 int 和 declarator 到 factorielle(int n)，为此我替换了这个：

```
direct_declarator
: ID ((direct_declarator '[' ']') | (direct_declarator '(' parameter_type_list ')') | (direct_declarator '(' identifier_list ')') | (direct_declarator '(' ')') )* 
```

和

```
direct_declarator
: ID ((direct_declarator '[' ']') | (direct_declarator '(' parameter_type_list ')') | (direct_declarator '(' identifier_list ')') | (direct_declarator '(' ')')  | '(' parameter_type_list ')' )* 
```

但这并没有太大帮助。

至于乘法，我不知道该怎么做才不会带来冲突。请问有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T08:59:01.557

You're likely to have an difficult time parsing real C code using a pure grammar with pure ANTLR.

The reason is that [certain declarations look like legitimate executable statements](https://stackoverflow.com/a/1004737/120163). (While the referenced answer seems to be about LR(1) parsers, it is really about parsers that cannot handle ambiguity; ANTLR cannot).

The only way to tell them apart is to use context information available from earlier symbol declarations. So you will have to collect symbol types as you parse, and inspect that information in the grammar rule reductions to decide whether such instances are statements or declarations. (I don't know how one implements this in ANTLR, although I believe it to be possible).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T07:11:35.863

我可能通过替换找到了问题第一部分的解决方案

```
compound_statement
  : '{' '}'
  | '{' statement_list '}'
  ; 
```

和

```
compound_statement
  : '{' '}'
  | '{' statement_list '}'
  | '{' external_declaration+ '}'
  ; 
```

并将其添加到 direct_declarator：

```
| ID '(' parameter_type_list ')' 
```

但不知道会不会带来一些冲突。

# c# - 表单验证只允许英文字母字符

> ID：15304790
> 
> 赞同：13
> 
> 时间：2013-03-08T23:01:26.387
> 
> 标签：c#, asp.net, regex, asp.net-mvc-3

我想限制我的表单输入输入非英文字符。例如，所有中文、日文、西里尔文，也包括单个字符，如：à、â、ù、û、ü、ô、î、ê。这可能吗？我是否必须在我的 MVC 应用程序上设置语言环境，或者只是进行正则表达式文本框验证？顺便说一句，我希望能够输入数字和其他字符。我只希望这排除字母。

请指教，谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-13T07:41:18.553

为此，您必须使用 Unicode 字符属性和块。每个 Unicode 代码点都分配了一些属性，例如这个点是一个字母。块是代码点范围。

有关更多详细信息，请参阅：

*   [regular-expressions.info 获取有关 Unicode 代码点、字符属性、脚本和块的一般信息](http://www.regular-expressions.info/unicode.html)

*   [.net 中支持的属性和块的 MSDN](http://msdn.microsoft.com/en-US/library/20bw873z%28v=vs.100%29.aspx)

这些 Unicode 属性和块被写入`\p{Name}`，其中“名称”是属性或块的名称。

当它是这样的大写“P”时`\P{Name}`，它是属性/块的否定，即它匹配其他任何东西。

有例如一些属性（只有一小段摘录）：

*   L ==> 所有字母字符。
*   Lu ==> 字母，大写
*   Ll ==> 字母，小写
*   N ==> 所有数字。这包括 Nd、Nl 和 No 类别。
*   Pc ==> 标点符号，连接器
*   P ==> 所有标点符号。这包括 Pc、Pd、Ps、Pe、Pi、Pf 和 Po 类别。
*   Sm ==> 符号，数学

有例如一些块（只有一小段摘录）：

*   0000 - 007F ==> IsBasicLatin
*   0400 - 04FF ==> 西里尔文
*   1000 - 109F ==> 缅甸

**我在解决方案中使用的内容：**

`\P{L}`是匹配任何非字母字符的字符属性（“L”表示字母）

`\p{IsBasicLatin}`是一个匹配代码点 0000 - 007F 的 Unicode 块

所以你的正则表达式是：

```
^[\P{L}\p{IsBasicLatin}]+$ 
```

**简单来说：**

这匹配从开始到结束的字符串（`^`和`$`），当 ASCII 表中只有（至少一个）非字母或字符时（文档点 0000 - 007F）

**一个简短的 c# 测试方法：**

```
string[] myStrings = { "Foobar",
    "Foo@bar!\"§$%&/()",
    "Föobar",
    "fóÓè"
};

Regex reg = new Regex(@"^[\P{L}\p{IsBasicLatin}]+$");

foreach (string str in myStrings) {
    Match result = reg.Match(str);
    if (result.Success)
        Console.Out.WriteLine("matched ==> " + str);
    else
        Console.Out.WriteLine("failed ==> " + str);
}

Console.ReadLine(); 
```

**印刷：**

> 匹配 ==> Foobar
> 匹配 ==> Foo@bar!\"§$%&/()
> 失败 ==> Föobar
> 失败 ==> fóÓè

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:07:15.730

您可以在 ViewModel 上使用正则表达式属性来限制它

```
public class MyViewModel
{
    [System.ComponentModel.DataAnnotations.RegularExpression("[a-zA-Z]+")]
    public string MyEntry
    {
       get;
       set;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T23:43:11.820

您可以使用正则表达式`[\x00-\x80]+`或`[\u0000-\u0080]+`. 尚未测试，但认为它也应该在 C# 中工作。

改编自：[正则表达式匹配非英文字符？](https://stackoverflow.com/questions/150033/regular-expression-to-match-non-english-characters)

您可以对文本框使用正则表达式验证，也可以在服务器上进行验证。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-14T12:59:25.170

可能是这个帮助你：=

```
private void Validate(TextBox textBox1)
{
 Regex rx = new Regex("[^A-Z|^a-z|^ |^\t]");
 if (rx.IsMatch(textBoxControl.Text))
  throw new Exception("Your error message");
} 
```

**有用的链接：-**

[http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/84e4f7fa-5fff-427f-8c0e-d478cb38fa12](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/84e4f7fa-5fff-427f-8c0e-d478cb38fa12)

[http://www.c-sharpcorner.com/Forums/Thread/177046/allow-only-20-alphabets-and-numbers-in-textbox-using-reg.aspx](http://www.c-sharpcorner.com/Forums/Thread/177046/allow-only-20-alphabets-and-numbers-in-textbox-using-reg.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-09T00:48:05.213

这可能会有所帮助，但不是有效的方法，而是简单的非注册验证

```
foreach (char c in inputTextField)
{
       if ((int)(c) > 127)
          {
             // expection or your logic whatever you want to return
          }

 } 
```

# javascript - 在谷歌地图中设置了意外的 LatLng

> ID：15304797
> 
> 赞同：0
> 
> 时间：2013-03-08T23:02:10.233
> 
> 标签：javascript, google-maps-api-3

我的 javascript 中有这行代码：

```
console.log(google.maps.LatLng(49.220341,17.649555)); 
```

控制台返回带有谷歌地图 Lat 和 Lng 的对象，这是我所期望的，但是：

然后我正在尝试这样做：

```
var start = "49.220341,17.649555";
console.log(google.maps.LatLng(start)); 
```

但控制台返回具有 NaN 值的空对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:10:15.680

Dave 是对的，该函数只接受两个参数，而不是一个。如果您想将它们存储在这样的字符串中，您可以随时调用

```
var start = "49.220341,17.649555";
console.log(google.maps.LatLng(start.substring(0,start.indexOf(",")),start.substring(start.indexOf(",")+1))); 
```

或者

```
var start = "49.220341,17.649555";
var startArr=start.split(",");
console.log(google.maps.LatLng(startArr[0],startArr[1])); 
```

这两个都将逗号周围的字符串分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:04:02.553

您正在传递 lat/lng 对的字符串，但`google.maps.LatLng`需要两个字符串代表该对。您将需要使用两个变量：

```
var lat = 49.220341;
var lng = 17.649555;
console.log(google.maps.LatLng( lat , lng )); 
```

或数组：

```
var start = [49.220341,17.649555];
console.log(google.maps.LatLng(start[0],start[1])); 
```

但是，我更喜欢使用对象：

```
var start = ['lat':49.220341,
             'lng':17.649555];
console.log(google.maps.LatLng(start['lat'],start['lng'])); 
```

# jquery - 如何使用此 jquery 代码减慢 Ken Burns 幻灯片中的显示和转换时间？

> ID：15304800
> 
> 赞同：0
> 
> 时间：2013-03-08T23:02:16.993
> 
> 标签：jquery, slideshow, transition

我弄乱了代码的第二个“段落”中的数值。它似乎没有什么区别，我什至不记得原来的设置。必须调整哪些数字以及为减慢图像显示时间和淡入淡出过渡效果而给出的数值？

```
(function($){

$.fn.kenburns = function(options) {

    var $canvas = $(this);
    var ctx = this[0].getContext('2d');
    var start_time = null;
    var width = $canvas.width();
    var height = $canvas.height();      

    var image_paths = options.images;       
    var display_time = options.display_time || 8000;
    var fade_time = Math.min(display_time / 8000, options.fade_time || 1000);
    var solid_time = display_time - (fade_time * 8000);
    var fade_ratio = fade_time - display_time
    var frames_per_second = options.frames_per_second || 30;        
    var frame_time = (1 / frames_per_second) * 1000;
    var zoom_level = 1 / (options.zoom || 2);
    var clear_color = options.background_color || '#000000'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:23:50.330

根据您发布的代码，它希望您传入`options.display_time`每个图像显示的时间量。您可以调整传递`kenburns`方法的参数以更快或更慢地更改幻灯片时间。

如果要更改在未传入显示时间时显示幻灯片的默认时间，您可以将`8000`代码中的每次出现更改为不同的默认时间（即以毫秒为单位的时间），但更有意义的是我只是传递所需的时间而不是编辑此代码。

# r - 生成 knitr 报告

> ID：15304803
> 
> 赞同：10
> 
> 时间：2013-03-08T23:02:27.097
> 
> 标签：r, knitr

我对 很陌生`knitr`，但我编写了一个脚本来为一个县生成报告。第一个代码块中的第一行是`display_county <- "King"`，它查询数据库以制作有关金县的各种好东西。现在我想为我所在州的每个县创建报告。脚本中唯一需要更改的行是`display_county`.

我知道这些`brew`包是为这样的东西设置的，我知道 and 之间有重叠`brew`，`knitr`但我不知道我应该使用什么。

[这个使用 Brew 和 Sweave 的答案](https://stackoverflow.com/a/8437769/903061)只需稍作修改即可使用，但有没有一种很好`knitr`的绕过方法`brew`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T21:59:05.927

如果我理解正确，您将为每个县使用相同的 Rnw 文件，因此每个县只有变量`display_county`不同。我会首先调用数据库以获取所有县的名称并将它们存储在一个向量中（比如...... `myCounties`）。之后，您的报告可以使用包含以下内容的脚本生成：

```
for(dc in myCounties)  {
  knit2pdf(input='county_report.Rnw', output=paste0(dc, '_county_report.pdf'))
} 
```

为了更有效地处理错误，您还可以将 knit2pdf 调用包装在 tryCatch 语句中：

```
for(dc in myCounties)  {
  tryCatch(knit2pdf(input='county_report.Rnw', output=paste0(dc, '_county_report.pdf')))
} 
```

# git - 查看单个文件的差异时如何在 tig 中查看完整的提交差异？

> ID：15304804
> 
> 赞同：8
> 
> 时间：2013-03-08T23:02:39.600
> 
> 标签：git, tig

在 git 的[Tig](http://jonas.nitro.dk/tig/)文本模式界面中，可以查看单个文件的责备，然后打开差异视图以查看修改该行的提交。例如

```
tig blame file.cpp
(Select a line, press enter.) 
```

但是，显示的差异仅限于单个文件，即使提交修改了多个文件。这是一个很好的默认设置，但是有没有办法将此视图扩展为跨所有文件的差异完全提交？

当前的解决方法是复制粘贴提交哈希，退出，然后使用 git 或 tig 显示它。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-12T01:52:51.557

使用切换文件操作。默认情况下，它绑定到 '%'。

# iphone - 将子视图添加到自定义类的超级视图不起作用

> ID：15304808
> 
> 赞同：0
> 
> 时间：2013-03-08T23:03:07.400
> 
> 标签：iphone, ios, objective-c, xcode, cocoa-touch

我正在尝试学习如何制作一个可以将子视图添加到它的超级视图的自定义类，并相信我下面的代码应该可以工作，但事实并非如此，而且我不明白为什么。它成功构建并通过添加子视图运行，但我从未在我的模拟器上看到它。我希望有人能指出我正确的方向。

mainviewcontroller.m 导入 #alerts.h 并尝试运行

```
Alerts* al = [[Alerts alloc] initWithFrame:[self.view bounds]];

[al throwBottomAlert:@"message" withTitle:@"Title Test"]; 
```

在我的自定义课程中......

头文件

```
#import <UIKit/UIKit.h>

@interface Alerts : UIAlertView

- (void)throwBottomAlert:(NSString*)message withTitle:(NSString*)title;

@end 
```

执行文件

```
#import "Alerts.h"

@implementation Alerts

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
    }
    return self;
}

- (void)throwBottomAlert:(NSString*)message withTitle:(NSString*)title {

    UIView* alertView = [[UIView alloc] initWithFrame:[self bounds]];
    alertView.backgroundColor = [UIColor blackColor];

    [self.superview addSubview:alertView];
    [self.superview bringSubviewToFront:alertView];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:33:06.880

这里有几个问题。我先从最差的新开始。不支持子类化`UIAlertView`，这不是一个好主意。

> ## 子类化注释
> 
> UIAlertView 类旨在按原样使用，不支持子类化。此类的视图层次结构是私有的，不得修改。

— [UIAlertView 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIAlertView_Class/UIAlertView/UIAlertView.html)

下一条坏消息，`-initWithFrame:`不是`UIAlertView`' 指定的初始化程序，不应该使用。你需要使用`-initWithTitle:message:delegate:cancelButtonTitle:otherButtonTitles:`.

最后，现有的 superview`UIAlertView`是一个`_UIAlertNormalizingOverlayWindow`. 那`_UIAlertNormalizingOverlayWindow`是一个子类型，`UIWindow`没有超级视图。这意味着您看到的警报不存在于所有应用程序查看的同一窗口中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:34:27.523

我想知道 UIAlertView 的子类化。

Developer.Apple 明确表示

> UIAlertView 类旨在按原样使用，不支持子类化。此类的视图层次结构是私有的，不得修改。

忽略子类化后，我将在下面给出答案。

在您的代码中，`self.superview`不是指`mainviewcontroller`

因为您刚刚`Alerts`在`mainviewcontroller`.

`Alerts`类将没有任何视图层次结构`mainviewcontroller`。

为此，您必须使用或传递`mainviewcontroller`to类。`Alerts``property``method parameter`

**例子：**

**主视图控制器**

```
Alerts* al = [[Alerts alloc] initWithFrame:[self.view bounds]];

[al throwBottomAlert:@"message" withTitle:@"Title Test" ParentView:self.view]; 
```

**警报**

```
- (void)throwBottomAlert:(NSString*)message withTitle:(NSString*)title ParentView:(UIView *)parentView

{
    UIView* alertView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 200, 200)];
    alertView.backgroundColor = [UIColor blackColor];
    [parentView addSubview:alertView];
    [parentView bringSubviewToFront:alertView];
} 
```

# ios - 多个 NSMutableArrays，一个按 Predicate 排序，其他的相对重新排序

> ID：15304811
> 
> 赞同：1
> 
> 时间：2013-03-08T23:03:19.590
> 
> 标签：ios, objective-c, arrays, cocoa-touch, nsarray

我有一个正在开发的音乐应用程序，在管理 TableViews 时，我将它们分类为部分。这通常是一个简单的过程，但是根据我管理数据的方式，这可能不是一项完全简单的任务。

我知道这不是最好的方法，但由于单元格具有多个属性（titleLabel、textLabel、imageView），我将所有数据存储在 3 个单独的数组中。当按标题组织歌曲时，对于部分标题，我使用谓词来设置 titleLabel，因此使用此代码。

```
NSArray *predict = [mainArrayAll filteredArrayUsingPredicate:predicate];
cell.titleLabel.text = [predict objectAtIndex:indexPath.row]; 
```

不幸的是，我还有一个 otherArrayAll 等。这些都有艺术家姓名、专辑封面等数据，因此需要与他们所使用的歌曲相关。有没有办法以与 mainArrayAll 数组相同的方式重新排序这些其他数组？那么相关数据是保存在一起的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:19:09.357

在上述情况下，我建议您创建一个模型类实现来存储所有值。遵循[MVC 架构](http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)是这里最好的方法。

例如：-

```
@interface Music : NSObject {}

@property (nonatomic, strong) NSString *title;
@property (nonatomic, strong) NSString *artistName;
@property (nonatomic, strong) NSString *albumName; 
//etc...

@end 
```

现在，如果您想创建一系列音乐，请执行以下操作：

```
Music *myMusic1 = [[Music alloc] init];
myMusic1.title = @"name";
myMusic1.artistName = @"artist";//etc.. do this in a loop based on other contents array

NSMutableArray *array = [NSMutableArray arrayWithObjects:myMusic1, myMusic2, ... nil]; 
```

现在对这个数组进行**排序：**

```
NSArray *sortedArray = [array sortedArrayUsingComparator:^NSComparisonResult(id a, id b) {
    return [a.title compare:b.title];
}]; 
```

如果要使用谓词：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%K contains %@", @"title", @"name"];
NSArray *predict = [mainArrayAll filteredArrayUsingPredicate:predicate]; 
```

如果要在表格视图中使用这些属性，可以将其用作：

```
NSString *title = [[sortedArray objectAtIndex:indexPath.row] title];
NSString *artistName = [[sortedArray objectAtIndex:indexPath.row] artistName]; 
```

# php - 将 Android 应用程序连接到 PHP、MYSQL

> ID：15304814
> 
> 赞同：0
> 
> 时间：2013-03-08T23:03:26.667
> 
> 标签：php, android, mysql

我正在尝试将 android 应用程序连接到 PHP 文件和 SQL 数据库，但该应用程序刚刚停止，根本没有响应。

这是Java代码：

```
package com.example.androidhive;

 import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.List;

 import org.apache.http.NameValuePair;
 import org.json.JSONArray;
 import org.json.JSONException;
 import org.json.JSONObject;

 import android.app.ListActivity;
 import android.app.ProgressDialog;
  import android.content.Intent;
 import android.os.AsyncTask;
 import android.os.Bundle;
 import android.util.Log;
 import android.view.View;
 import android.widget.AdapterView;
 import android.widget.AdapterView.OnItemClickListener;
 import android.widget.ListAdapter;
 import android.widget.ListView;
 import android.widget.SimpleAdapter;
 import android.widget.TextView;

 public class AllProductsActivity extends ListActivity {

// Progress Dialog
private ProgressDialog pDialog;

// Creating JSON Parser object
JSONParser jParser = new JSONParser();

ArrayList<HashMap<String, String>> productsList;

// url to get all products list
private static String url_all_products = "http://127.0.0.1/get_all_products.php";

// JSON Node names
private static final String TAG_SUCCESS = "success";
private static final String TAG_PRODUCTS = "products";
private static final String TAG_PID = "pid";
private static final String TAG_NAME = "name";

// products JSONArray
JSONArray products = null;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.all_products);

    // Hashmap for ListView
    productsList = new ArrayList<HashMap<String, String>>();

    // Loading products in Background Thread
    new LoadAllProducts().execute();

    // Get listview
    ListView lv = getListView();

    // on seleting single product
    // launching Edit Product Screen
    lv.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            // getting values from selected ListItem
            String pid = ((TextView) view.findViewById(R.id.pid)).getText()
                    .toString();

            // Starting new intent
            Intent in = new Intent(getApplicationContext(),
                    EditProductActivity.class);
            // sending pid to next activity
            in.putExtra(TAG_PID, pid);

            // starting new activity and expecting some response back
            startActivityForResult(in, 100);
        }
    });

}

// Response from Edit Product Activity
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    // if result code 100
    if (resultCode == 100) {
        // if result code 100 is received 
        // means user edited/deleted product
        // reload this screen again
        Intent intent = getIntent();
        finish();
        startActivity(intent);
    }

}

/**
 * Background Async Task to Load all product by making HTTP Request
 * */
class LoadAllProducts extends AsyncTask<String, String, String> {

    /**
     * Before starting background thread Show Progress Dialog
     * */
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        pDialog = new ProgressDialog(AllProductsActivity.this);
        pDialog.setMessage("Loading products. Please wait...");
        pDialog.setIndeterminate(false);
        pDialog.setCancelable(false);
        pDialog.show();
    }

    /**
     * getting All products from url
     * */
    protected String doInBackground(String... args) {
        // Building Parameters
        List<NameValuePair> params = new ArrayList<NameValuePair>();
        // getting JSON string from URL
        JSONObject json = jParser.makeHttpRequest(url_all_products, "GET", params);

        // Check your log cat for JSON reponse
        Log.d("All Products: ", json.toString());

        try {
            // Checking for SUCCESS TAG
            int success = json.getInt(TAG_SUCCESS);

            if (success == 1) {
                // products found
                // Getting Array of Products
                products = json.getJSONArray(TAG_PRODUCTS);

                // looping through All Products
                for (int i = 0; i < products.length(); i++) {
                    JSONObject c = products.getJSONObject(i);

                    // Storing each json item in variable
                    String id = c.getString(TAG_PID);
                    String name = c.getString(TAG_NAME);

                    // creating new HashMap
                    HashMap<String, String> map = new HashMap<String, String>();

                    // adding each child node to HashMap key => value
                    map.put(TAG_PID, id);
                    map.put(TAG_NAME, name);

                    // adding HashList to ArrayList
                    productsList.add(map);
                }
            } else {
                // no products found
                // Launch Add New product Activity
                Intent i = new Intent(getApplicationContext(),
                        NewProductActivity.class);
                // Closing all previous activities
                i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(i);
            }
        } catch (JSONException e) {
            e.printStackTrace();
        }

        return null;
    }

    /**
     * After completing background task Dismiss the progress dialog
     * **/
    protected void onPostExecute(String file_url) {
        // dismiss the dialog after getting all products
        pDialog.dismiss();
        // updating UI from Background Thread
        runOnUiThread(new Runnable() {
            public void run() {
                /**
                 * Updating parsed JSON data into ListView
                 * */
                ListAdapter adapter = new SimpleAdapter(
                        AllProductsActivity.this, productsList,
                        R.layout.list_item, new String[] { TAG_PID,
                                TAG_NAME},
                        new int[] { R.id.pid, R.id.name });
                // updating listview
                setListAdapter(adapter);
            }
        });

    }

}
} 
```

这是 JSONParser.java

```
 package com.example.androidhive;

 import java.io.BufferedReader;
 import java.io.IOException;
 import java.io.InputStream;
  import java.io.InputStreamReader;
 import java.io.UnsupportedEncodingException;
 import java.util.List;

 import org.apache.http.HttpEntity;
 import org.apache.http.HttpResponse;
 import org.apache.http.NameValuePair;
 import org.apache.http.client.ClientProtocolException;
 import org.apache.http.client.entity.UrlEncodedFormEntity;
 import org.apache.http.client.methods.HttpGet;
 import org.apache.http.client.methods.HttpPost;
 import org.apache.http.client.utils.URLEncodedUtils;
 import org.apache.http.impl.client.DefaultHttpClient;
 import org.json.JSONException;
 import org.json.JSONObject;

 import android.util.Log;

 public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

// constructor
public JSONParser() {

}

// function get json from url
// by making HTTP POST or GET method
public JSONObject makeHttpRequest(String url, String method,
        List<NameValuePair> params) {

    // Making HTTP request
    try {

        // check for request method
        if(method == "POST"){
            // request method is POST
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(url);
            httpPost.setEntity(new UrlEncodedFormEntity(params));

            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent();

        }else if(method == "GET"){
            // request method is GET
            DefaultHttpClient httpClient = new DefaultHttpClient();
            String paramString = URLEncodedUtils.format(params,     "utf-8");
            url += "?" + paramString;
            HttpGet httpGet = new HttpGet(url);

            HttpResponse httpResponse = httpClient.execute(httpGet);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent();
        }           

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        json = sb.toString();
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

}
} 
```

这是php代码

```
 <?php

/*
 * Following code will list all the products
 */

// array for JSON response
 $response = array();

 // include db connect class
 require_once __DIR__ . '/db_connect.php';

 // connecting to db
 $db = new DB_CONNECT();

// get all products from products table
$result = mysql_query("SELECT *FROM products") or die(mysql_error());

// check for empty result
if (mysql_num_rows($result) > 0) {
// looping through all results
// products node
$response["products"] = array();

while ($row = mysql_fetch_array($result)) {
    // temp user array
    $product = array();
    $product["pid"] = $row["pid"];
    $product["name"] = $row["name"];
    $product["price"] = $row["price"];
    $product["description"] = $row["description"];
    $product["created_at"] = $row["created_at"];
    $product["updated_at"] = $row["updated_at"];

    // push single product into final response array
    array_push($response["products"], $product);
}
// success
$response["success"] = 1;

// echoing JSON response
echo json_encode($response);
} else {
// no products found
$response["success"] = 0;
$response["message"] = "No products found";

// echo no users JSON
echo json_encode($response);
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T14:42:01.650

好的，谢谢大家，我只是想通了。我应该使用 //10.0.2.2/ 而不是 127.0.0.1

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:21:38.613

线

```
$result = mysql_query("SELECT *FROM products") or die(mysql_error()); 
```

* 和 FROM 之间应包含一个空格。

您的 Android 代码期望来自未出现的服务器的结果。那是您的代码挂起的地方。

查看 MySQL 的服务器日志。

# java - 验证 Java 类是否实现了 toString()

> ID：15304815
> 
> 赞同：10
> 
> 时间：2013-03-08T23:03:38.490
> 
> 标签：java, static-analysis, findbugs, checkstyle, pmd

作为我的程序的常规静态分析的一部分，我想检查类是否可能具有健全的`toString()`方法。可能不是每个类都实现它们，但也许没有可实例化`Object`的具体类使用`toString()`.

是否有一个 lint 工具包可以检查这个？我目前使用的是 FindBugs 和 CheckStyle；我还没有找到一种明显的方法来检查使用其中任何一个。我也在考虑将 PMD 添加到我的 lint 套件中，并且也会对 Sonar 中的某些内容持开放态度。所以我更愿意使用工具箱中已有的工具来完成，但如果我需要添加另一个工具，我会考虑它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T14:33:48.297

您可以使用 Checkstyle *[Regexp](http://checkstyle.sourceforge.net/config_misc.html#Regexp)*检查执行此操作：

```
<module name="Regexp">
    <property name="format" value="public\s+String\s+toString\s*()"/>
    <property name="message" value="All classes must implement toString()"/>
    <property name="ignoreComments" value="true"/>
</module> 
```

这甚至可以将注释掉的`toString()`方法识别为不存在。我使用 Checkstyle 5.6 和 eclipse-cs 进行了尝试，但它也应该适用于早期版本。

# python - 无法读取图像 web2py

> ID：15304817
> 
> 赞同：1
> 
> 时间：2013-03-08T23:03:48.653
> 
> 标签：python, web2py

您好，我在 web2py 中打开图像文件时遇到问题。我不知道我是否只是犯了一个简单的错误，还是不止于此。我认为我在查看网络和本网站上的示例时做对了。这是我在模型中的代码：

```
db.define_table('image', 
                 Field('picture', 'upload')) 
```

我认为该错误意味着数据库中有一张图片，但它无法检索该图片并打开它，或者我完全错了，如果有人能对解决方案有所了解，我将非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:27:39.377

传递给`Image.open`,的参数`db.image.picture`是一个`Field`对象，而不是填写到表单中的值。你可能想要：

```
pic = Image.open(os.path.join(request.folder,'uploads',form.vars.picture)) 
```

编辑：更新为使用图片文件的完整路径。但是，正如 Anthony 在下面的评论中所指出的，这不适`blob`用于用于将图像存储在原始问题中的字段（在它被编辑之前，如下面的评论中讨论的那样）。[此处](http://web2py.com/books/default/chapter/29/06#More-on-uploads)`retrieve`描述的使用将提供文件数据。

# html - 将 div 放在另一个 div 上并使 div 留在底部

> ID：15304827
> 
> 赞同：0
> 
> 时间：2013-03-08T23:04:39.923
> 
> 标签：html

我想将 div 故事放在图片的底部（mainMedia），但我也希望关于 div 位于照片的顶部。

当我尝试这样做时，故事 div 会排到顶部，因为 mainMedia 潜水是 position:absolute 但我必须保持它以保持 about 潜水在它之上......有什么想法吗？

能否请你帮忙？

非常感谢！

HTML

```
<html>
<head>
    <title> Beta</title>
    <!-- css links -->
    <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
    <div class="gigantic">
        <div class="main">
            <div class="twitterProfilePicture">
                <img src="https://si0.twimg.com/profile_images/2015016150/petecashmoreavatar_normal.png">
            </div>
            <div class="push">
                <div class="mainMedia">
                    <img src="http://blog.sunsafaris.com/wp-content/uploads/2013/02/dune-king-lion.jpg">
                    <div class="about">
                        <p><span>Mashable</span></br>3 Hours ago</p>
                    </div>
                </div>
            </div>  
            <div class="Story">
                <div class="heading">

                </div>
                <div class="text">

                </div>
            </div>
        </div>
    </div>
</body>
</html> 
```

CSS

```
body
{
    margin: 0;
    background-color: rgb(233,234,237);
    font-family: 'lucida grande', tahoma, verdana, arial, sans-serif;
}

p
{
    margin: 0;
}

.gigantic
{
    width: 800px;
    height: 100%;
    margin-right: auto;
    margin-left: auto;
    padding-top: 20px;
    margin-top: 40px;
    /*background-color: #fff;*/
}

.main
{
    width: 700px;
    height: 400px;
    /*background-color: #000;*/
    margin-right: auto;
    margin-left: auto;
    padding: 30px;
}

.twitterProfilePicture
{
    width: 55px;
    height: 55px;
    border-radius: 3px;
    /*background-color: #fff;*/
    position: relative;
    float: left;
}

.twitterProfilePicture img
{
    width: 55px;
    height: 55px;
    border-radius: 3px;
    /*background-color: #fff;*/
    position: relative;
    float: left;
}

.mainMedia
{
    width: 630px;
    height: auto;
    /*background-color: #fff;*/
    float: right;
    border-radius: 4px;
    position: relative;
    margin-bottom: 10px;
}

.mainMedia img
{
    width: 630px;
    height: auto;
    position: relative;
    border-top-left-radius: 3px;    
    border-top-right-radius: 3px;   
}

.about
{
    position: absolute;
    /*background-color: #000;*/
    overflow: hidden;
    height: 35px;
    position: absolute;
    top: 7px;
    left: 7px;
    font-size: 12px;
    color: rgb(94,118,171);
}

.about span
{
    color: #385874;
    font-size: 16px;
}

.story
{
    width: 630px;
    height: 300px;
    background-color: #fff;
    position: absolute;
    margin-left: 70px;
    border-bottom-left-radius: 3px;
    border-bottom-right-radius: 3px;
    position: static;
    bottom: 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:34:41.560

这是我对您要实现的目标的看法：

我在这里为你放了一把[小提琴。](http://jsfiddle.net/Lsc8U/)

您需要做的是将故事 div 粘贴到 mainMedia div 中。当它应该是“.Story”时，您的 css 也会引用“.story”。

HTML：

```
 <div class="gigantic">
        <div class="main">
            <div class="twitterProfilePicture">
                <img src="https://si0.twimg.com/profile_images/2015016150/petecashmoreavatar_normal.png">
            </div>

    <div class="push">
                <div class="mainMedia">
                        <img src="http://blog.sunsafaris.com/wp-content/uploads/2013/02/dune-king-lion.jpg"/>
                    <div class="about">
                            <p><span>Mashable</span></br>3 Hours ago</p>
                    </div>

            <div class="Story">
                        <div class="heading">Heading</div>
                        <div class="text">Text Story here</div>
                    </div>

        </div>
            </div>  

         </div>
    </div> 
```

CSS：

```
body
{
    margin: 0;
    background-color: rgb(233,234,237);
    font-family: 'lucida grande', tahoma, verdana, arial, sans-serif;
}

p
{
    margin: 0;
}

.gigantic
{
    width: 800px;
    height: 100%;
    margin-right: auto;
    margin-left: auto;
    padding-top: 20px;
    margin-top: 40px;
    /*background-color: #fff;*/
}

.main
{
    width: 700px;
    height: 400px;
    /*background-color: #000;*/
    margin-right: auto;
    margin-left: auto;
    padding: 30px;
}

.twitterProfilePicture
{
    width: 55px;
    height: 55px;
    border-radius: 3px;
    /*background-color: #fff;*/
    position: relative;
    float: left;
}

.twitterProfilePicture img
{
    width: 55px;
    height: 55px;
    border-radius: 3px;
    /*background-color: #fff;*/
    position: relative;
    float: left;
}

.mainMedia
{
    width: 630px;
    height: auto;
    /*background-color: #fff;*/
    float: right;
    border-radius: 4px;
    position: relative;
    margin-bottom: 10px;
}

.mainMedia img
{
    width: 630px;
    height: auto;
    position: relative;
    border-top-left-radius: 3px;    
    border-top-right-radius: 3px;   
}

.about
{
    position: absolute;
    /*background-color: #000;*/
    overflow: hidden;
    height: 35px;
    position: absolute;
    top: 7px;
    left: 7px;
    font-size: 12px;
    color: rgb(94,118,171);
}

.about span
{
    color: #385874;
    font-size: 16px;
}

.Story
{
    background-color: black;
    opacity:0.5;
    position: absolute;
    border-bottom-left-radius: 3px;
    border-bottom-right-radius: 3px;
    position: absolute;
    bottom: 3px;
    color:white;
    width:630px; /*I made this the same as your mainMedia*/
} 
```

我希望这会有所帮助。

# java - 如何在 ftp4j 库中使用 SSL

> ID：15304828
> 
> 赞同：2
> 
> 时间：2013-03-08T23:04:43.073
> 
> 标签：java, android, ssl, ftp

我目前陷入困境，因为我发现 ftp4j 上的文档非常简单。据此： [文件](http://www.sauronsoftware.it/projects/ftp4j/manual.php?PHPSESSID=6mianvnk9d2u0uh2ca4cfo3ep6#6)

我可以设置库以使用 SSL 证书进行连接。我遇到的问题是弄清楚图书馆如何知道接受哪个 SSL 证书，哪个不接受（如果是冒名顶替者）。有什么帮助吗？谢谢！

**编辑**：我想知道如何导入 SSL 证书并使库只连接到具有特定 SSL 证书的特定服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:08:34.883

您可以使用 Sun 的 InstallCert.java 来获取您想要接受的证书，并将其保存在单独的存储中。然后在设置 FTPClient 时使用这个单独的存储。

我在下面包含了一个版本的 InstallCert.java，因为在 Oracle 接管之后，在 Internet 上越来越难找到它了……

```
/*
 * Copyright 2006 Sun Microsystems, Inc.  All Rights Reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 *   - Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *
 *   - Redistributions in binary form must reproduce the above copyright
 *     notice, this list of conditions and the following disclaimer in the
 *     documentation and/or other materials provided with the distribution.
 *
 *   - Neither the name of Sun Microsystems nor the names of its
 *     contributors may be used to endorse or promote products derived
 *     from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
/**
 * http://blogs.sun.com/andreas/resource/InstallCert.java
 * Use:
 * java InstallCert hostname
 * Example:
 *% java InstallCert ecc.fedora.redhat.com
 */

import javax.net.ssl.*;
import java.io.*;
import java.security.KeyStore;
import java.security.MessageDigest;
import java.security.cert.CertificateException;
import java.security.cert.X509Certificate;

/**
 * Class used to add the server's certificate to the KeyStore
 * with your trusted certificates.
 */
public class InstallCert {

    public static void main(String[] args) throws Exception {
    String host;
    int port;
    char[] passphrase;
    if ((args.length == 1) || (args.length == 2)) {
        String[] c = args[0].split(":");
        host = c[0];
        port = (c.length == 1) ? 443 : Integer.parseInt(c[1]);
        String p = (args.length == 1) ? "changeit" : args[1];
        passphrase = p.toCharArray();
    } else {
        System.out.println("Usage: java InstallCert <host>[:port] [passphrase]");
        return;
    }

    File file = new File("jssecacerts");
    if (file.isFile() == false) {
        char SEP = File.separatorChar;
        File dir = new File(System.getProperty("java.home") + SEP
                + "lib" + SEP + "security");
        file = new File(dir, "jssecacerts");
        if (file.isFile() == false) {
            file = new File(dir, "cacerts");
        }
    }
    System.out.println("Loading KeyStore " + file + "...");
    InputStream in = new FileInputStream(file);
    KeyStore ks = KeyStore.getInstance(KeyStore.getDefaultType());
    ks.load(in, passphrase);
    in.close();

    SSLContext context = SSLContext.getInstance("TLS");
    TrustManagerFactory tmf =
            TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
    tmf.init(ks);
    X509TrustManager defaultTrustManager = (X509TrustManager) tmf.getTrustManagers()[0];
    SavingTrustManager tm = new SavingTrustManager(defaultTrustManager);
    context.init(null, new TrustManager[]{tm}, null);
    SSLSocketFactory factory = context.getSocketFactory();

    System.out.println("Opening connection to " + host + ":" + port + "...");
    SSLSocket socket = (SSLSocket) factory.createSocket(host, port);
    socket.setSoTimeout(10000);
    try {
        System.out.println("Starting SSL handshake...");
        socket.startHandshake();
        socket.close();
        System.out.println();
        System.out.println("No errors, certificate is already trusted");
    } catch (SSLException e) {
        System.out.println();
        e.printStackTrace(System.out);
    }

    X509Certificate[] chain = tm.chain;
    if (chain == null) {
        System.out.println("Could not obtain server certificate chain");
        return;
    }

    BufferedReader reader =
            new BufferedReader(new InputStreamReader(System.in));

    System.out.println();
    System.out.println("Server sent " + chain.length + " certificate(s):");
    System.out.println();
    MessageDigest sha1 = MessageDigest.getInstance("SHA1");
    MessageDigest md5 = MessageDigest.getInstance("MD5");
    for (int i = 0; i < chain.length; i++) {
        X509Certificate cert = chain[i];
        System.out.println
                (" " + (i + 1) + " Subject " + cert.getSubjectDN());
        System.out.println("   Issuer  " + cert.getIssuerDN());
        sha1.update(cert.getEncoded());
        System.out.println("   sha1    " + toHexString(sha1.digest()));
        md5.update(cert.getEncoded());
        System.out.println("   md5     " + toHexString(md5.digest()));
        System.out.println();
    }

    System.out.println("Enter certificate to add to trusted keystore or 'q' to quit: [1]");
    String line = reader.readLine().trim();
    int k;
    try {
        k = (line.length() == 0) ? 0 : Integer.parseInt(line) - 1;
    } catch (NumberFormatException e) {
        System.out.println("KeyStore not changed");
        return;
    }

    X509Certificate cert = chain[k];
    String alias = host + "-" + (k + 1);
    ks.setCertificateEntry(alias, cert);

    OutputStream out = new FileOutputStream("jssecacerts");
    ks.store(out, passphrase);
    out.close();

    System.out.println();
    System.out.println(cert);
    System.out.println();
        System.out.println
                ("Added certificate to keystore 'jssecacerts' using alias '"
                        + alias + "'");
    }

    private static final char[] HEXDIGITS = "0123456789abcdef".toCharArray();

    private static String toHexString(byte[] bytes) {
        StringBuilder sb = new StringBuilder(bytes.length * 3);
        for (int b : bytes) {
            b &= 0xff;
            sb.append(HEXDIGITS[b >> 4]);
            sb.append(HEXDIGITS[b & 15]);
            sb.append(' ');
        }
        return sb.toString();
    }

private static class SavingTrustManager implements X509TrustManager {

        private final X509TrustManager tm;
        private X509Certificate[] chain;

        SavingTrustManager(X509TrustManager tm) {
            this.tm = tm;
        }

        public X509Certificate[] getAcceptedIssuers() {
            throw new UnsupportedOperationException();
        }

        public void checkClientTrusted(X509Certificate[] chain, String authType)
                throws CertificateException {
            throw new UnsupportedOperationException();
        }

        public void checkServerTrusted(X509Certificate[] chain, String authType)
                throws CertificateException {
            this.chain = chain;
            tm.checkServerTrusted(chain, authType);
        }
    }
} 
```

在添加您提供的新证书之前，该代码会复制 JRE 提供的证书。如果您不希望这样，而只存储您的证书，则需要删除此部分：

```
if (file.isFile() == false) {
        char SEP = File.separatorChar;
        File dir = new File(System.getProperty("java.home") + SEP
                + "lib" + SEP + "security");
        file = new File(dir, "jssecacerts");
        if (file.isFile() == false) {
            file = new File(dir, "cacerts");
        }
    } 
```

现在，当您有一个包含您的证书的文件时，您可以使用它来创建您提供给 FTPClient 的 SSLSocketFactory。

您可以像这样创建某种证书管理器：

```
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import java.security.KeyStore;
import java.security.cert.CertificateException;
import java.security.cert.X509Certificate;

import javax.net.ssl.SSLContext;
import javax.net.ssl.SSLSocketFactory;
import javax.net.ssl.TrustManager;
import javax.net.ssl.TrustManagerFactory;
import javax.net.ssl.X509TrustManager;

public class CertManager {

private static final char[] passphrase = "changeit".toCharArray();
private String rootPath;
private SSLSocketFactory factory;
private SavingTrustManager trustManager;
private KeyStore keyStore;

/**
 * Creates a CertManager.
 * @param rootPath Path to directory where the file 'jssecacerts' is located.
 */
public CertManager(String rootPath){
    this.rootPath = rootPath;       
}

/**
 * Gets a SSLSocketFactory with the trusted certs.
 * @return
 * @throws Exception
 */
public SSLSocketFactory getSSLSocketFactory() throws Exception {
    //Load trusted certs
    File file = new File(rootPath+"jssecacerts");

    System.out.println("Loading KeyStore " + file + "...");
    InputStream in = new FileInputStream(file);
    keyStore = KeyStore.getInstance(KeyStore.getDefaultType());
    keyStore.load(in, passphrase);
    in.close();

    //Use these certs 
    SSLContext context = SSLContext.getInstance("TLS");
    TrustManagerFactory tmf =
        TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
    tmf.init(keyStore);
    X509TrustManager defaultTrustManager = (X509TrustManager)tmf.getTrustManagers()[0];
    trustManager = new SavingTrustManager(defaultTrustManager);
    context.init(null, new TrustManager[] {trustManager}, null);
    factory = context.getSocketFactory();
    return factory;
}

private static class SavingTrustManager implements X509TrustManager {

    private final X509TrustManager tm;
    private X509Certificate[] chain;

    SavingTrustManager(X509TrustManager tm) {
        this.tm = tm;
    }

    public X509Certificate[] getAcceptedIssuers() {         
        return tm.getAcceptedIssuers();
    }

    public void checkClientTrusted(X509Certificate[] chain, String authType)
    throws CertificateException {
        this.chain = chain;
        tm.checkClientTrusted(chain, authType);
    }

    public void checkServerTrusted(X509Certificate[] chain, String authType)
    throws CertificateException {
        this.chain = chain;
        tm.checkServerTrusted(chain, authType);
    }
}
} 
```

使用您的证书管理器获取您提供给 FTPClient 的 SSLSocketFactory：

```
...
FTPClient client = new FTPClient();
CertManager certMan = new CertManager("");
SSLSocketFactory sslSocketFactory = null;
try{
    sslSocketFactory = certMan.getSSLSocketFactory();
} catch (Exception e) {
    e.printStackTrace();
}
client.setSSLSocketFactory(sslSocketFactory);
client.setSecurity(FTPClient.SECURITY_FTPS); // or client.setSecurity(FTPClient.SECURITY_FTPES);
... 
```

# assembly - 如何在汇编中返回 errno？

> ID：15304829
> 
> 赞同：2
> 
> 时间：2013-03-08T23:04:43.520
> 
> 标签：assembly, x86, errno

我在汇编中返回 errno 时遇到问题。我知道如何找到它，但我无法返回 errno 和返回值。如果我的函数失败，我将返回 errno（由系统调用设置）和 -1。我必须为学校科目做这个。我必须在汇编中创建一个小库，最后一个函数是“写”。我使用调用系统写，但我还必须管理errno。

如果我没记错的话，errno 是一个全局变量。所以我想在汇编中恢复它，并改变它的值，但我还没有成功地在我的函数中恢复它......

我是正确的还是完全错误的？

我使用了 Assembly Intel x86 并使用 NASM 进行编译。

抱歉语言错误，我不是英语。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T23:08:56.883

`errno`并不总是全局变量。它只需要是一个左值，并且可能是一个隐藏函数调用的宏。从[规范](http://pubs.opengroup.org/onlinepubs/009695399/functions/errno.html)：

> 未指定 errno 是宏还是使用外部链接声明的标识符。

事实上，它通常*不是*全局变量，因为它通常被实现为线程局部的（因此需要函数调用来检索指向 TLS 块的指针）。

你最好有一个调用汇编函数和集合的 C 包装器`errno`。

* * *

编辑：由于您不能使用 C 函数（IMO 是没有意义的，因为`errno`它确实是 C/POSIX 概念），因此您必须自己实现`errno`收集。找到`errno`in的定义`errno.h`，并实现汇编中的任何内容。例如，我的`errno.h`定义`errno`为

```
extern int * __error(void);
#define errno (*__error()) 
```

因此，我会调用`__error`函数（返回一个`int *`），然后存储到返回的地址。例如，这是我的系统为设置生成的程序集`errno`：

```
$ gcc -xc - -o- -S <<EOF
#include <errno.h>
main() { errno = 3; return 0; }
EOF
    .section    __TEXT,__text,regular,pure_instructions
    .globl  _main
    .align  4, 0x90
_main:
Leh_func_begin1:
    pushq   %rbp
Ltmp0:
    movq    %rsp, %rbp
Ltmp1:
    subq    $16, %rsp
Ltmp2:
    callq   ___error
    movl    $3, (%rax)
        ... 
```

您的系统可能会有不同的`errno`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:54:31.433

如果你只是在汇编中编写，你为什么需要`errno`呢？ `errno`是 C 库函数使用的 C 语言概念，这些函数进行系统调用以将这些系统调用的错误返回传达回 C 代码。如果你真的需要它，最简单的方法是按照 nneonneo 描述并编写一个 C 函数来获取地址`errno`并从你的汇编代码中调用它。

但是，如果您正在编写*纯*汇编代码，则不需要它。系统调用自己在正常返回位置（x86 上的 eax）返回错误代码，并通过一种方式将其与非错误返回区分开来。在 Linux 中，错误总是在 -4095..-1 范围内。该范围内的任何返回值都是错误，超出该范围的任何返回值都是非错误返回。在其他 UNIX 风格（例如 *BSD）中，错误会设置 CARRY 标志。

# ios - 将目标 C 文件扩展名从 .m 更改为 .mm 会导致错误

> ID：15304831
> 
> 赞同：1
> 
> 时间：2013-03-08T23:04:44.923
> 
> 标签：ios, objective-c, cocoa-touch, protocols

最初我在 LoginViewController.m 中有包含以下警告的文件，我忽略了它。并且代码工作正常。

```
warning: sending 'LoginViewController *' to parameter of incompatible type 'id<NSStreamDelegate>' 
```

但现在我将文件扩展名更改为 .mm (LoginViewController.mm)。由于此错误，现在我无法再构建项目。

```
Cannot initialize a parameter of type 'id<NSStreamDelegate>' with an lvalue of type 'LoginViewController *' 
```

怎么了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T23:36:04.743

```
warning: sending 'LoginViewController *' to parameter of incompatible type 'id<NSStreamDelegate>' 
```

此警告是由于`NSStreamDelegate`您在定义类时不符合协议`LoginViewController`。理想情况下，您的类应该符合该协议，以便当您将其设置为委托时，它可以理解您正在实现它期望的任何委托方法。

例如：-

```
@interface LoginViewController : UIViewController<NSStreamDelegate> {} 
```

一旦你解决了这个问题，当你更改为 .mm 类时，你不应该得到另一个错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T23:05:57.903

C++ 的类型规则比 C 更严格。 LoginViewController 没有声明符合该协议，因此指针类型不兼容，这是 C++ 中的硬错误。声明一致性应该解决它。（您可能仍然会遇到比以前更多的类型错误，因为 C 中的静默转换需要 C++ 中的强制转换。）

# ruby - 如何使用 File#flock 对独占锁发出非阻塞请求？

> ID：15304833
> 
> 赞同：11
> 
> 时间：2013-03-08T23:04:54.260
> 
> 标签：ruby, locking, flock, fcntl

## 我应该如何申请非阻塞锁？

当单独尝试锁定文件时，为什么 Ruby 的[File#flock不能按预期工作？](http://www.ruby-doc.org/core-2.0/File.html#method-i-flock)将文件锁定在块中并不是解决此问题的正确解决方案，因为重点是显示锁定*持久*锁的行为。在块内使用 File#flock 会在块退出时释放锁，因此它不能正确演示问题。

File#flock 以多种方式失败，尤其是在请求非阻塞锁时。下面是一些例子。

## File#flock 的失败示例

*   使用多个独占锁时无限等待，因为#flock 不提供超时锁请求的方法。

    ```
    # First lock succeeds.
    f1 = File.open('foo', File::RDWR|File::CREAT, 0644)
    f1.flock(File::LOCK_EX)
    # => 0

    # This never returns.
    f2 = File.open('foo', File::RDWR|File::CREAT, 0644)
    f2.flock(File::LOCK_EX) 
    ```

*   在文件被独占锁定时请求非阻塞锁定会导致无效参数异常。

    ```
    f1 = File.open('foo', File::RDWR|File::CREAT, 0644)
    f1.flock(File::LOCK_EX)
    # => 0

    f2 = File.open('foo', File::RDWR|File::CREAT, 0644)
    f2.flock(File::LOCK_NB)
    # => Errno::EINVAL: Invalid argument - foo 
    ```

*   文档说#flock“根据locking_constant（下表中的逻辑或值）锁定或解锁文件。” 但是，逻辑或会引发`Errno::EINVAL`或`Errno::EBADF`取决于平台。

    ```
    f1 = File.open('foo', File::RDWR|File::CREAT, 0644)
    f1.flock(File::LOCK_EX)
    # => 0

    f2 = File.open('foo', File::RDWR|File::CREAT, 0644)
    f2.flock(File::LOCK_NB || File::LOCK_EX)
    # => Errno::EINVAL: Invalid argument - foo 
    ```

## Native File#flock 解决方案首选

虽然在无法获得独占锁时可能会使用[Timeout 模块](http://www.ruby-doc.org/stdlib-2.0/libdoc/timeout/rdoc/Timeout.html)来引发`Timeout::Error`，但似乎 File#flock 应该能够本机解决这个问题。那么，实际上应该如何在不阻塞的情况下请求独占锁呢？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-08T23:04:54.260

## 使用带有排他锁的超时模块

您可以使用[Timeout 模块](http://www.ruby-doc.org/stdlib-2.0/libdoc/timeout/rdoc/Timeout.html)设置#flock 获取排他锁的持续时间。下面的示例将 raise `Timeout::Error: execution expired`，然后可以以任何适合应用程序的方式来拯救它。计时器到期时返回*nil*允许测试 #flock 表达式的真实性。

```
require 'timeout'

f1 = File.open('foo', File::RDWR|File::CREAT, 0644)
f1.flock(File::LOCK_EX)
# => 0

f2 = File.open('foo', File::RDWR|File::CREAT, 0644)
Timeout::timeout(0.001) { f2.flock(File::LOCK_EX) } rescue nil
# => nil 
```

## 对非阻塞锁尝试使用按位或

[File#flock](http://www.ruby-doc.org/core-2.0/File.html#method-i-flock)的文档说：

> 根据locking_constant（下表中的逻辑或值）锁定或解锁文件。如果指定了 File::LOCK_NB，则返回 false，否则操作将被阻止。

但是，该方法实际上需要[按位 OR](http://ruby-doc.org/core-2.0/Fixnum.html#method-i-7C)运算符，而不是parse.y 中由 tOROP 解析器令牌[定义的逻辑 OR 关键字。](https://github.com/ruby/ruby/blob/c07d78eb0e8e9d3a8f9e8c860b362964157ff43a/parse.y)因此，`false`当排他锁失败时，允许 #flock 返回的正确参数实际上是`File::LOCK_NB|File::LOCK_EX`. 例如：

```
f1 = File.open('foo', File::RDWR|File::CREAT, 0644)
f1.flock(File::LOCK_EX|File::LOCK_NB)
# => 0

f2 = File.open('foo', File::RDWR|File::CREAT, 0644)
f2.flock(File::LOCK_NB|File::LOCK_EX)
# => false

f1.close; f2.close
# => nil 
```

这将在可用时始终生成排他锁；否则，它会立即返回一个虚假值，而无需引发或挽救异常的开销。这显然是该模块的使用方式，但文档可以使用一些说明和附加示例使其更易于理解。

# apache-camel - Apache camel：SFTP：文件下载多次

> ID：15304840
> 
> 赞同：2
> 
> 时间：2013-03-08T23:05:47.640
> 
> 标签：apache-camel

我已经定义了以下骆驼路线：

```
 RouteBuilder rb = new RouteBuilder() {
        @Override
        public void configure() throws Exception {
            from("sftp://myhost//path/to/files/")
            .to("log:loggingCategory?level=INFO")
            .to("file:///tmp/");
        }
    }; 
```

当我使用这条路线启动上下文时，骆驼确实会连接并下载文件。我的问题是骆驼重复下载相同的文件，直到上下文被关闭。为什么 FTP2 组件会这样做，我该如何阻止它？

我通过 maven 包含了 2.10.4 版的 camel-core 和 camel-ftp。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T08:36:25.757

[Indempotent Consumer](http://camel.apache.org/idempotent-consumer.html)做到了这一点。FTP2 组件的文档将[File2 组件](http://camel.apache.org/ftp2.html)[称为](http://camel.apache.org/file2.html)“因为那里的所有选项也适用于该组件”。有一个参数“ **indempotent=true** ”可以激活 LRUCache 的使用：

> 选择使用幂等消费者 EIP 模式让 Camel 跳过已处理的文件。默认情况下，将使用一个基于内存的 LRUCache，它包含 1000 个条目。如果 noop=true 则也将启用幂等性以避免一遍又一遍地使用相同的文件。

我的完整源定义现在如下所示：

```
from("sftp://myhost//path/to/files/?username=user&password=secret&idempotent=true") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T03:44:46.260

来自骆驼 ftp2 文档：

> 默认情况下，FTP 使用者将在远程 FTP 服务器上保留已使用的文件不变。如果您希望它删除文件或将它们移动到另一个位置，则必须明确配置它。例如，您可以使用 delete=true 删除文件，或使用 move=.done 将文件移动到隐藏的 done 子目录中。

要删除文件，请将路由更改为

```
from("sftp://myhost//path/to/files?delete=true") 
```

确保连接的用户具有所需的权限。

# eclipse - 收到错误“无法从资源 net/sf/antcontrib/antcontrib.properties 加载定义。找不到。”

> ID：15304845
> 
> 赞同：21
> 
> 时间：2013-03-08T23:06:01.627
> 
> 标签：eclipse, ant, ant-contrib

`Could not load definitions from resource net/sf/antcontrib/antcontrib.properties. It could not be found.`当我尝试在 Eclipse 上构建 ant 时出现错误。所以我下载了 ant-contrib-0.6.jar 并将它保存在我`/lib`的 apache ant 位置，但它仍然不能解决我的问题。我也尝试过在我的系统变量中指定`/lib`位置。`CLASSPATH`我怎样才能绕过这个错误？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-11T09:20:15.340

您可以使用“classpath”元素显式提供 ant-contrib JAR 的完整路径：

```
<taskdef resource="net/sf/antcontrib/antlib.xml">
  <classpath>
    <pathelement location="${path-to-ant-contrib}/ant-contrib-1.0b3.jar"/>
  </classpath>
</taskdef> 
```

编辑：链接贡献者`Djacomo`：

*   [http://ant-contrib.sourceforge.net/](http://ant-contrib.sourceforge.net/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-01-25T15:54:35.653

这个 StackOverflow 页面缺少的一件重要的事情是，设置正确的 ANT_HOME env var 是绝对重要和重要的，如果没有这个设置，ant 会一直报同样的错误，不管你在文件系统上复制 ant-contrib-1.0b3.jar 的位置. 这个丢失的东西花了我几个小时。=)

但是，在纯蚂蚁中，我在没有 Eclipse 的情况下收到此错误。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-01-11T15:03:55.867

I fixed that this way:

Add the JAR to the Ant runtime classpath entries.

`Window>Preferences>Ant>Runtime>Classpath`

Add the JAR to either Ant Home Entries or Global Entries.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-09T07:32:51.213

看来您还没有将 ant contrib jar 安装到正确的 lib 目录中。如果您安装了多个 ANT，这可能很难做到。

我的建议是将您的 ANT 插件安装到“$HOME/.ant/lib”目录中。您可以更进一步，将流程自动化，如下所示：

```
<project name="ant-contrib-tasks" default="all">

    <taskdef resource="net/sf/antcontrib/antlib.xml"/>

    <target name="bootstrap">
        <mkdir dir="${user.home}/.ant/lib"/>
        <get dest="${user.home}/.ant/lib/ant-contrib.jar" src="http://search.maven.org/remotecontent?filepath=ant-contrib/ant-contrib/1.0b3/ant-contrib-1.0b3.jar"/>
    </target>

    <target name="all">
        <for param="file">
            <fileset dir="." includes="*.txt"/>
            <sequential>
                <echo message="Found file @{file}"/>
            </sequential>
        </for>
    </target>

</project> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-16T10:34:12.593

在构建 xml 中使用下面提到的代码：

```
<path id="ant.classpath">
<pathelement location="${ant.jarPath}/ant.jar" />
<pathelement location="${ant.jarPath}/ant-contrib-0.3.jar" />
</path>
<taskdef resource="net/sf/antcontrib/antcontrib.properties">
 <classpath refid="ant.classpath" />
</taskdef> 
```

在您的构建属性文件中：

ant.jarPath=D:/antjars

并将 ant.jar 和 ant-contrib-0.3.jar 放在目录：D:/antjars

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-01-30T16:49:32.847

检查您是否具有对 ant-contrib jar 文件的读取权限。

In our case after copying the file with another user it did not, giving the same error message.

# css - 根据浏览器类型渲染 div

> ID：15304848
> 
> 赞同：0
> 
> 时间：2013-03-08T23:06:17.597
> 
> 标签：css, html

我有一个 div 标签，如下所示：

```
<div id="loadingDiv" class="loadingDiv"; style="position:absolute; left:400px; top:292px;">
    <strong>Retrieving Data - One Moment Please...</strong>
</div> 
```

似乎 Chrome 和 IE 的呈现方式不同。在 IE 中，文本比 Chrome 更靠左。我不知道这是为什么。那么，有没有一种方法可以创建依赖于浏览器类型的样式？例如，如果浏览器是 IE，我希望左边的值可能是 300px，如果 Chrome 是 400px。或者，有没有更好的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:29:05.753

即使我不建议使用特定于浏览器的 CSS，优化您的 CSS 以使其在所有浏览器中看起来至少相似总是要好得多，您可以通过结合使用一些 javascript 和 CSS 来做您想做的事情。

**这是代码：**

```
<html>
<head>

<title>browser specific css</title>

<style>

    .loadingDiv {

        position: absolute;
        display: none;
        font-weight: bold;

    }

    .loadingDiv.ie {

        display: block;
        left: 300px; 
        top: 292px;
        background: #00CCFF;
        color: #454545;

    }

    .loadingDiv.chrome {

        display: block;
        left: 400px; 
        top: 292px;
        background: #FCD209;
        color: #E53731;

    }

    .loadingDiv.firefox {

        display: block;
        left: 400px; 
        top: 292px;
        background: #D04F16;
        color: #FFFFFF;

    }

    .loadingDiv.default {

        display: block;
        left: 400px; 
        top: 292px;

    }

</style>

<script>

    window.onload = function() {

        var check_for_ie = detect_browser("MSIE");
        var check_for_chrome = detect_browser("Chrome");
        var check_for_firefox = detect_browser("Firefox");

        var browser_name = "";

        var loading_div = document.getElementById("loadingDiv");
        var loading_div_html = loading_div.innerHTML;

        if (check_for_ie == true) {
            browser_name = "Internet Explorer";
            loading_div.className = "loadingDiv ie";
        }
        else if (check_for_chrome == true) {
            browser_name = "Google Chrome";
            loading_div.setAttribute("class","loadingDiv chrome");
        }
        else if (check_for_firefox == true) {
            browser_name = "Firefox";
            loading_div.setAttribute("class","loadingDiv firefox");
        }
        else {
            browser_name = "Unchecked browser";
            loading_div.setAttribute("class","loadingDiv default");
        }

        loading_div.innerHTML = loading_div_html + "(you are browsing with "+browser_name+")";

    }

    function detect_browser(look_for) {

        var user_agent_string = navigator.userAgent;
        var search_for_string = user_agent_string.search(look_for);

        if (search_for_string > -1) {
            return true;
        }
        else {
            return false;
        }

    }

</script>

</head>
<body>

    <div id="loadingDiv" class="loadingDiv" >
        Retrieving Data - One Moment Please...
    </div>

</body>
</html> 
```

**这是工作示例：**
[http ://simplestudio.rs/yard/browser_specific_css/browser_specific_css.html](http://simplestudio.rs/yard/browser_specific_css/browser_specific_css.html)

**编辑：**

如果您需要检查其他浏览器，请查看该特定浏览器的用户代理字符串，并找到其中独特的内容，并在该浏览器和其他浏览器之间产生差异，并像这样使用它：

```
var check_for_opera = detect_browser("Opera"); 
```

通过用户代理检测浏览器可能很棘手，所以要小心，如果需要，甚至升级我的功能......

*   注意，这只是一个简单的例子......

# tsql - 带内循环的循环和拆分

> ID：15304849
> 
> 赞同：0
> 
> 时间：2013-03-08T23:06:19.123
> 
> 标签：tsql

我在一个名为“Entry”的表中有这样的记录：

```
TABLE: Entry

ID      Tags
---     ------------------------------------------------------ 
1       Coffee, Tea, Cake, BBQ
2       Soda, Lemonade 
```

...ETC。

表：标签

```
ID      TagName
----    -----------
1       Coffee
2       Tea
3       Soda
...

TABLE: TagEntry

ID    TAGID    ENTRYID
---   -----    -------
1     1        1
2     2        1
3     3        2
.... 
```

我需要遍历整个表中的每条记录以获取条目，然后为每一行循环逗号分隔的标签，因为我需要拆分每个标签，然后根据标签名称进行标签查找以获取 TagID，然后最终插入 TagID，每个逗号分隔标记的桥接表中的 EntryID，称为 TagEntry

不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:17:11.773

尝试这个

```
;with entry as
(
    select 1 id, 'Coffee, Tea, Cake, BBQ' tags
    Union all
    select 2, 'Soda, Lemonade'
), tags as
(
    select 1 id,'Coffee' TagName union all
    select 2,'Tea' union all
    select 3,'Soda'
), entryxml as
(
    SELECT id, ltrim(rtrim(r.value('.','VARCHAR(MAX)'))) as Item from (
    select id, CONVERT(XML, N'<root><r>' + REPLACE(tags,',','</r><r>') + '</r></root>') as XmlString
    from entry ) x
    CROSS APPLY x.XmlString.nodes('//root/r') AS RECORDS(r)
)
select e.id EntryId, t.id TagId from entryxml e
inner join tags t on e.Item = t.TagName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:00:27.243

此 SQL 将拆分您的条目表，以加入其他表：

```
with raw as (
  select * from ( values 
    (1, 'Coffee, Tea, Cake, BBQ'),
    (2, 'Soda, Lemonade')
  ) Entry(ID,Tags)
)
, data as (
    select ID, Tag = convert(varchar(255),' '), Tags, [Length] = len(Tags) from raw
  union all
    select 
      ID   = ID,
      Tag  = case when charindex(',',Tags) = 0 then Tags else convert(varchar(255), substring(Tags, 1, charindex(',',Tags)-1) ) end,
      Tags = substring(Tags, charindex(',',Tags)+1, 255),
      [Length] = [Length] - case when charindex(',',Tags) = 0 then len(Tags) else charindex(',',Tags) end
    from data
    where [Length] > 0
) 
select ID, Tag = ltrim(Tag)
from data
where Tag <> '' 
```

并为给定的输入返回这个：

```
ID          Tag
----------- ------------
2           Soda
2           Lemonade
1           Coffee
1           Tea
1           Cake
1           BBQ 
```

# c - 在文件中查找给定的句子

> ID：15304850
> 
> 赞同：2
> 
> 时间：2013-03-08T23:06:20.367
> 
> 标签：c, function

我正在用 c 训练自己，我的目标是读取文件并检查其中是否有给定的句子。如果给定的句子是否存在于文件中，该函数必须分别返回“找到”或“未找到”。句子由`/`符号分隔。

```
Example of file:
1,2,3,4/
car, house, hotel/
2,age,12/
1,2/
1,2,3,5/
house, car/

Example of word to look for:
1,2/ 
```

我的想法是每次从文件中取出一个句子并将其放入一个数组（称为ary）中，检查数组（ary）是否等于包含我正在寻找的给定句子的数组（称为句子） ，并将该数组（ary）重用于文件中的下一个句子。

我写了这段代码：

```
#include <stdio.h>

void main()
{
    char *sentence;
    FILE *my_file;
    char *ary;
    int size = 500;
    int got;
    int ind=0;
    int rest;
    int found=0;

    sentence="1,2";

    my_file=fopen("File.txt", "r");

    if(my_file==NULL)
    {
        printf("I couldn't open the file\n");
    }
    else
    {
        ary = (char*)malloc(500*sizeof(char));
        while((got=fgetc(my_file))!=EOF)
        {
            if(got!='/')
            {
                ary[ind++]=(char)got;
            }
            else
            {
                ary[ind++]='\0';
                rest = compare(sentence,ary);
                if(rest==0)
                {
                    found =1;
                    printf("found\n");
                    return;
                }
                ind=0;
                free(ary);
                ary = (char*)calloc(500, sizeof(char));
            }
        }
        if(found==0) 
        {
            printf("not found\n");
        }
        fclose(my_file);
    }
}

int compare(char str1[], char str2[])
{
    int i = 0;
    int risp;
    if(str1>str2 || str1<str2) 
    {
        risp=-1;
    }
    if(str1==str2)
    {
        while(str1[i++]!='\0')
        {
            if(str1[i]!=str2[i]) risp=1;
        }
    }

    return risp;
} 
```

它编译，但不能正常工作，我不知道为什么。有人可以指出我的错误或让我知道更好的解决方案吗？

编辑：当我打印与句子相关的两个 str 时，可以，但第一次打印后的另一个 str 继续打印，单词前面有一个中断。如下所示：

```
Str1:1,2
Str2:1,2,3,4
Str1:1,2
Str2:
car, house, hotel
Str1:1,2
Str2:
2,age,12
Str1:1,2
Str2:
1,2
Str1:1,2
Str2:
1,2,3,5
Str1:1,2
Str2:
house, car 
```

这可能是我的问题之一吗？我试图解决它...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:12:30.330

str1 和 str2 实际上是指针（它们指的是存储字符串第一个元素的内存位置）。因此，使用 > 和 == 比较 str1 和 str2 只会比较它们的内存位置。如果它们位于不同的位置（它们将），str1 和 str2 将永远不会相等。

您要做的是逐步遍历 str1 和 str2 并比较值。我把它作为海报的练习。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T16:18:29.640

在 C 中移动字符串片段绝对是可行的，但它很麻烦，因为你真的必须了解指针和分配是如何在幕后工作的。那么我可以建议另一种不涉及移动字符串的方法吗？

首先 - 让我们在伪代码中写下如何在文件中查找字符串的定义：

```
def file_contains_string(file, string):
   if (file is empty):
       return "not found"
   else if (initial_part_of_file_equals(file, string)):
       return "found it!!!"
   else
       return file_contains_string(drop_first_character(file), string) 
```

即“如果文件的第一部分等于字符串，或者文件的某些后面的部分等于字符串，则文件包含字符串。”

这是C语言的翻译：

```
int file_contains_string(FILE *file, char *str)
{
    if (feof(file)) return 0;
    if (initial_part_of_file_equals(file, str)) return 1;
    fgetc(file);  /* discard leading character from the file */
    return file_contains_string(file, str);
} 
```

现在我们如何实施`initial_part_of_file_equals`？好吧，如果第一个字符相等，则文件的初始部分匹配，然后字符串的其余部分匹配文件的第一个字符之后的初始部分：

```
def initial_part_of_file_equals(file, string):
   if is_empty(string):
      return True
   else if first_character(string) == first_character(file):
      return initial_part_of_file_equals(drop_first_character(file),
                                         drop_first_character(string))
   else return False 
```

我们如何翻译它？在 C 中，“字符串”只是指向字符数组的指针，因此您只需通过推进指针即可“删除字符串的第一个字符”。您只需通过取消引用指针来比较字符串的第一个字符。

```
int initial_part_of_file_equals(FILE * file, char * str)
{
    if !(str*)      return 1;  /* Test for empty string */
    if (feof(file)) return 0;  /* Test for empty file */

    char c = fgetc(file);      /* get first character from file */

    int result = (c == *str)
                 && initial_part_of_file_equals(file, str++);

    ungetc(c, file);

    return result;
} 
```

`ungetc`里面很重要——如果只有第一部分匹配，我们要确保我们实际上不消耗输入流的相应部分*。*`str`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T17:30:59.440

慢慢地，我自己也找到了解决方案。我知道这并不优雅，但这对我来说是一个小小的胜利。

```
char c;
char str[]="1,2/";
FILE * f;
int i=0; 

f=fopen("File.txt", "r");
if (f==NULL) perror ("Error opening file");
else
{
   while ((c=(char)fgetc(f)) != EOF) {
      if((c==str[i]))  {
          if (c=='/')
            {
              printf("FOUND\n");
              return;
            }
          i++;
      }
      else i=0;
      if(c=='/')
          i=0;
    }
    printf("NOT FOUND\n");
    fclose (f);
  } 
```

# c# - 撞击点：圆形碰撞

> ID：15304858
> 
> 赞同：1
> 
> 时间：2013-03-08T23:06:49.310
> 
> 标签：c#, geometry, point

我正在做一个关于机器人杯的学校项目，机器人与人工智能一起踢足球。由于一切正常，我仍然陷入困境。

机器人是从顶视图绘制的简单球体。不应允许两名球员互相撞到对方，并应在撞击点获得新的更新位置。

由于碰撞处理程序只是检查它们是否碰撞。我希望是否有办法检测圆圈碰撞的位置。所以我可以将碰撞球体的位置更新到最后一个已知的非碰撞位置，这样它们就不能互相穿过，也可能会反弹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:15:22.230

圆圆周上的所有点与圆心的距离（半径）相同。对于比赛场上的每个圈子都是如此。

因此：当两个圆的中心之间的距离<=它们各自的半径之和时，两个圆完全碰撞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:56:41.073

好吧，你已经标记了一个答案，但我去整理了一段功能齐全的代码，所以也许你仍然可以使用它。:) 根据我的评论：

> 由于它们只是圆圈，因此只需计算圆圈中心点之间的中点即可。如果圆具有不同的半径，则选择一个圆并计算沿线距其中心一半径的点。

这可能是一个简单的实现。我为它创建了一些*非常微薄的*辅助类；我完全鼓励扩展它们，使结构真正不可变，以及所有那些好的爵士乐，但现在可以用于演示目的。

所以对于助手类：

```
public struct Point
{
    public double X;
    public double Y;

    public double Distance(Point otherPoint)
    {
        double deltaX = this.X - otherPoint.X;
        double deltaY = this.Y - otherPoint.Y;
        return System.Math.Sqrt(deltaX * deltaX + deltaY * deltaY);
    }

    public override string ToString()
    {
        return String.Format("({0}, {1})", X, Y);
    }
}

public struct Polar
{
    public double Radius;
    public double Angle;

    public double X { get { return Radius * System.Math.Cos(Angle); } }
    public double Y { get { return Radius * System.Math.Sin(Angle); } }

    public Point ToCartesian()
    {
        return new Point() { X = X, Y = Y };
    }
}

public class Circle
{
    public double Radius { get; set; }
    public Point Position { get; set; }
} 
```

我们的肉和土豆类/方法是这样的：

```
public class CollisionResult
{
    public Circle Circle1 { get; private set; }
    public Circle Circle2 { get; private set; }

    public Point Circle1SafeLocation { get; private set; }
    public Point Circle2SafeLocation { get; private set; }

    public Point CollisionLocation { get; private set; }

    public CollisionResult(Circle circle1, Circle circle2)
    {
        this.Circle1 = circle1;
        this.Circle2 = circle2;
    }

    public bool CalculateCollision()
    {
        double distanceFromCentres = Circle1.Position.Distance(Circle2.Position);
        if (distanceFromCentres >= Circle1.Radius + Circle2.Radius)
            return false;

        double angleBetweenCircles = System.Math.Atan2(Circle2.Position.Y - Circle1.Position.Y, Circle2.Position.X - Circle1.Position.X);

        Point midpointBetweenCircles = new Point(){X = (Circle1.Position.X + Circle2.Position.X)/2, Y = (Circle1.Position.Y + Circle2.Position.Y)/2};

        Point circle1Offset = (new Polar() { Radius = Circle1.Radius, Angle = System.Math.PI + angleBetweenCircles }).ToCartesian();
        Point circle2Offset = (new Polar() { Radius = Circle2.Radius, Angle = angleBetweenCircles }).ToCartesian();

        CollisionLocation = midpointBetweenCircles;
        Circle1SafeLocation = new Point(){X = midpointBetweenCircles.X + circle1Offset.X, Y = midpointBetweenCircles.Y + circle1Offset.Y };
        Circle2SafeLocation = new Point(){X = midpointBetweenCircles.X + circle2Offset.X, Y = midpointBetweenCircles.Y + circle2Offset.Y };

        return true;
    }
} 
```

用法可能如下所示：

```
private void CheckCollision(Circle circle1, Circle circle2)
{
    CollisionResult result = new CollisionResult(circle1, circle2);
    if (result.CalculateCollision())
    {
        Console.WriteLine(String.Format("Collision detected at {0}! Safe location for circle 1: {1}, circle 2: {2}", result.CollisionLocation, result.Circle1SafeLocation, result.Circle2SafeLocation));
    }
    else
    {
        Console.WriteLine("Did not collide.");
    }
}

var circle1 = new Circle() {Radius = 5, Position = new Point(){X = 0, Y = 0} };
var circle2 = new Circle() {Radius = 5, Position = new Point(){X = 10, Y = 0} };
var circle3 = new Circle() {Radius = 3, Position = new Point(){X = 0, Y = 1} };
var circle4 = new Circle() {Radius = 5, Position = new Point(){X = 3, Y = 7} };

CheckCollision(circle1, circle2);
CheckCollision(circle3, circle4); 
```

输出：

```
Did not collide.
Collision detected at (1.5, 4)! Safe location for circle 1: (0.158359213500125, 1.31671842700025), circle 2: (3.73606797749979, 8.47213595499958) 
```

我不知道在您的情况下是否有必要处理计算两个圆的真实交点（它们将在两个点相交）等的复杂性。可能这些方面的东西对你来说就足够了。我绝对鼓励健康的单元测试，并使课程*超出*我所拥有的范围。:)

编辑：在这种情况下，重要的是，这取决于你想为你的应用程序做什么，当圆圈重叠时，它只是计算它们之间的中点，*然后*将每个圆圈从该中点*移开*它们各自的半径。因此，根据圆圈的速度和大小，或者它们的移动方式，它可能会产生奇怪的结果。例如，如果你有一个半径为 10 的大圆静止不动，那么你在距离大圆中心仅 0.5 距离的地方投入一个半径为 1 的圆，那个大圆将移动大约 9.75 个单位！如果您没有遇到大的重叠条件，那么也许这不是什么大问题。我认为至少这会给你一些*关于*碰撞的信息，然后*如何*您是否希望您的圈子做出反应，结果将取决于您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T23:15:47.377

您需要做的是找到两个圆之间的交点，可以是两个点、一个点或没有。这基本上是通过一起求解两个圆的方程来完成的。这是数学：

[http://www.analyzemath.com/CircleEq/circle_intersection.html](http://www.analyzemath.com/CircleEq/circle_intersection.html)

因为这是给学校的，所以我会把编码留给你:)

# php - 如何在 .js.php 文件中获取 $_GET 变量？

> ID：15304861
> 
> 赞同：0
> 
> 时间：2013-03-08T23:07:22.260
> 
> 标签：php

所以在我的主页上我有

```
<?php
require_once('config.inc.php');
require_once($rootdir . $dirsubfolder . 'navbar.php');
?>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?libraries=geometry&sensor=true"></script>

<script src="php/findme.php"></script>

<div class="hero hero-unit" style="padding: 0; padding-top: 3%;">
    <div id="search" class='input-append'><input id="setNewDistance" class="span3" type="text" placeholder="Set Distance In Meters">
        <button class='btn btn-info' id="changeDistance" type="submit">Search
        </button></div>
        <p class='alert-info' id="stopsfoundtext"></p>

    <div id="gmaps"></div>
</div>

<?php
require_once($rootdir . $dirsubfolder . 'footer.php');
?> 
```

然后在 Findme.php 我有

```
<?php

/* Include neccesary files */
require_once('config.inc.php');
$gPlantSite = $_GET['plantsite'];
/* Connect to Database */

$mysqli = new mysqli(DB_HOST, DB_USER, DB_PASS, DB_BASE);

/* Prepare Database statement */

if ($stmt = $mysqli -> prepare("SELECT route_id, Latitude, Longitude, Title, Weekday_Day, Weekend_Day, ADO_Day, Weekday_Night,
    Weekend_Night, ADO_Night, Direction_Of_Bus, 
    What_Shift FROM Routes WHERE Plant_Site = ?")) {
/* Bind param to search for */

 $stmt -> bind_param('s', $gPlantSite);

/* Execute and hope it works */

$stmt -> execute();

/* Bind the results to variables */

$stmt -> bind_result($gRoute_Id, $gLatitude, $gLongitude, $gTitle, $gWeekdayDay, $gWeekendDay, $ADODay,
$WeekdayNight, $WeekendNight, $ADONight, $gDirectionOfBus, $gwhatShift);

/* Leave connection open so that it may be queryd on the client side */

include "../js/findme.js.php";

}

?> 
```

但它似乎仍然没有从 php 文件中获取 $_GET，任何人都知道我在这里没有想法

我只需要它来获得我尝试使用发布的想法作为答案的 $_GET ，但这似乎对我不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:12:08.223

你可以在这个文件中包含你的 js.php 文件。

如果你这样做：

```
// .. other code ..
$stmt->bind_param('s', $gPlantSite); // at the bottom..

include "js.php"; // at the end of the file 
```

那么您也将可以访问此文件中的 $_GET 。

**编辑**

目前它不会像你想要的那样工作：

```
<script src="php/findme.php"></script> 
```

这意味着您将执行 findme.php 脚本，但您没有在此处提供任何查询字符串，因此 $_GET 将始终为空。

要通过 $_GET 提供任何内容，您需要像这样向脚本标签提供：

```
<script src="php/findme.php?plantsite=something"></script> 
```

然后 $_GET['plantsite'] 将在 Findme.php 中填充值 'something'。

当您在 Findme.php 中包含 findme.js.php 文件时，该脚本也将填充 $_GET。希望这可以帮助 ：）

# timer - 如何将参数传递给 Arduino 上的定时器中断的回调函数？

> ID：15304875
> 
> 赞同：0
> 
> 时间：2013-03-08T23:08:29.537
> 
> 标签：timer, callback, arduino, interrupt

我想要一个定时器中断来调用一个在 Arduino 上带有一组参数的函数。我查看了 Timer1 库，但它似乎无法用于将参数传递给回调函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-01T12:14:12.533

您可以将回调包装到无参数函数中。这个包装函数可以将你想要的任何参数传递给你的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:10:59.737

你不能。您必须使用某种全局结构来保存当前状态。使用回调时，从该结构中获取您需要的数据。

# ios - 移动到空白部分时，UICollectionView 没有给出正确的索引路径

> ID：15304877
> 
> 赞同：2
> 
> 时间：2013-03-08T23:08:37.667
> 
> 标签：ios, xcode, uicollectionview

我一直在使用大量代码 LXReorderableCollectionViewFlowLayout（由 Stan Chang Khin Boon 编写）。它允许在 UICollectionView 中移动项目

我有一个包含多个部分的集合视图。这些部分使用带有多个控件的标题。我允许用户创建空部分并将项目拖到这些部分中

我使用集合视图来显示多个照片相册。每个部分都与不同的专辑相关。当每个相册中已有项目时，将照片从“相册 1”拖动到“相册 2”可以正常工作。

但是，如果相册（部分）为空，我无法将对象移动到该空白部分。

我认为问题在于“indexPathForItemAtPoint”。如果该部分中有项目，则此方法提供正确的 NSIndexPath。但如果它是空的，它总是返回 section = 0, row = 0。

当我从“0”部分越过边界进入“1”部分时，NSIndexPath theIndexPathOfSelectedItem 变为 0,0（部分，行）。我本来预计它会达到 1,0。

问题似乎与“indexPathForItemAtPoint”有关。它没有考虑到该部分可能是空的，并且当我越过边界进入另一个（和空的）部分时，默认为 0, 0 。

就像我之前说的，如果“1”部分已经有项目，那么 indexPath 设置正确。

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-08T22:06:54.483

我最终在空白部分放置了一个虚拟（但不可见）项目。当我创建一个新部分时，我在该部分中放置了一个虚拟值。我让它不可见，这样它就不会显示出来。每当我添加新项目或从我测试的部分中删除项目以确保虚拟项目存在时。

重要提示：如果该部分中至少有 1 个真实项目，我会删除虚拟值。否则，集合列表会尝试绘制它。

我确信有更好的方法来做到这一点。如果您知道如何，请发布新答案。

希望这可以帮助。

# telerik - Telerik.Web.UI 参考版本错误

> ID：15304879
> 
> 赞同：1
> 
> 时间：2013-03-08T23:09:06.220
> 
> 标签：telerik

当我们尝试部署 Web 应用程序时出现错误，无法加载文件或程序集“Telerik.Web.UI，版本=2012.2.815.40，文化=中性，PublicKeyToken=XXXXXXXXXXXXXXX”。（X 是我们的标志）

从我在其他一些地方读到的内容来看，web.config 中应该有一些我们改变的东西。但是在我们的 web.config 中，我们没有看到 Telerik.Web.UI 中说明版本号的任何内容？

我们只是在我们的 httpHandlers 中有这些

`

```
 <add path="Telerik.Web.UI.SpellCheckHandler.axd" type="Telerik.Web.UI.SpellCheckHandler" verb="*" validate="false"/>
  <add path="Telerik.Web.UI.DialogHandler.aspx" type="Telerik.Web.UI.DialogHandler" verb="*" validate="false"/>
  <add path="Telerik.RadUploadProgressHandler.ashx" type="Telerik.Web.UI.RadUploadProgressHandler" verb="*" validate="false"/>

  <add path="Telerik.Web.UI.WebResource.axd" type="Telerik.Web.UI.WebResource" verb="*" validate="false"/>` 
```

这在我们的 `<controls> <add tagPrefix="telerik" namespace="Telerik.Web.UI" assembly="Telerik.Web.UI"/>` 其他地方会说明版本号。我们使用 Visual Studio 2012 发布和部署了我们的 Web 应用程序。我们的 Web 应用程序的另一个版本可以正常工作，并且在 bin 中有 2012.2.815.40.dll 版本。但是我们推出的版本我们使用的是 2011.1.519.40。

因此，我们似乎需要将更新版本的 DLL 添加到我们最近推送的项目中。但是当我们将 2012.2.815.40.dll 放回 /bin 文件夹时，我们会得到一个不同的错误，说我们需要引用 2011.1.519.40。

我们的问题是什么？除了 web.config 之外，我们的 Telerik 引用的版本号还会在哪里？？？？？？？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T23:09:12.033

我们对此的回答是我们推送了不同的版本。我们的版本比生成的程序集旧。我们更新了 Telerik 版本，清理并重建了我们的项目，这些项目大概重新引用了 Telerik 控件并进行了干净的推送。起初这很令人困惑，但问题是因为有 2 个不同的版本。我们有一个旧版本，而服务器有一个新版本。
有疑问时。更新、重建、测试和推送。并再次测试

# c# - 如何获取正在运行的类库的物理文件名

> ID：15304880
> 
> 赞同：0
> 
> 时间：2013-03-08T23:09:06.450
> 
> 标签：c#, file, system.diagnostics

我正在尝试创建一个类库，它将根据其物理文件名加载不同的文件。

即，如果物理文件名为“test.dll”，它将从“test.config”加载其设置，如果该文件被复制并重命名为“copy.dll”，那么它将从“copy.config”加载其设置。 ...

```
System.Diagnostics.Process.GetCurrentProcess(); 
//doesn't work as I'm loading the dll's dynamically into a console application and calling their methods. 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:28:02.997

```
string filePath = typeof(SomeAssemblyMemberType).Assembly.CodeBase; 
```

[`CodeBase`](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.codebase.aspx)属性返回加载的包含清单的文件的绝对路径，或者如果程序集是使用`Load`方法加载的，则返回加载器方法所在的程序集的路径。

例如，如果您的 DLL 中的类对象中有以下代码：

```
public class Grace
{
    public Grace() {}

    public string AbsoluteFileName
    {
        get {
            return this.GetType().Assembly.CodeBase;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:15:16.320

使用组装：

```
 string filePath = System.Reflection.Assembly.GetCallingAssembly().Location; 
```

# sockets - 如何终止侦听客户端创建套接字请求的java程序？

> ID：15304883
> 
> 赞同：1
> 
> 时间：2013-03-08T23:09:21.147
> 
> 标签：sockets, terminate

当我在 Ubuntu 中使用 Java JDK 在终端中运行该程序时，如何使该程序退出？

我想在这个程序运行时输入“结束”，但我无法让它工作。它监听客户端并调用一个线程来为新客户端创建一个套接字。我不知道如何使这个程序结束。我什么都试过了。

我昨天开始学习java。请帮我....

```
import java.net.*;          //jave lib
import java.io.*;           //io lib

public class MultiServerConnections {       //initiate class
public static void main(String[] args) throws IOException {

    int portNum = 5342;                 //set server port number
    boolean listen = true;

    System.out.println("Listening for Connections");    //print message

    ServerSocket server_Socket = null;          //set server_Socket to null
    try {

        server_Socket = new ServerSocket(portNum);      //set server port
    } catch (IOException e) {
        System.err.println("Port " + portNum + " is unavailable"); //port is taken error
        System.exit(1);
    }

BufferedReader stdIn = new BufferedReader(new InputStreamReader(System.in)); //set reader
String input;

    //while (TCPglobals.checkRequests){
    while (listen == true){
    new MultiServer(server_Socket.accept()).start();

    input = stdIn.readLine();
    //if(TCPglobals.checkRequests == false) //|| (input = stdIn.readLine()) == "end")
    if(input == "end") {
        System.out.println("end connection?");
        System.exit(1);
    }

}//while

    server_Socket.close(); //close server socket

} 
```

}

# apache-pig - 使用 Pig 时如何避免超出计数器限制？

> ID：15304885
> 
> 赞同：1
> 
> 时间：2013-03-08T23:09:32.593
> 
> 标签：apache-pig

我从 Pig 脚本中收到以下错误：

“错误：计数器数量超出限制 - 计数器 = 120 限制 = 120”

我有一行“SET pig.disable.counter true;” 在我的脚本中，我认为这可以解决问题，但事实并非如此。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T07:33:23.320

从 Pig 0.9.1 开始支持 pig.disable.counter

Pig 将在旧版本（例如 0.8.1）中忽略此属性

# java - 如何在 onResume 上绘制到画布

> ID：15304886
> 
> 赞同：0
> 
> 时间：2013-03-08T23:09:49.497
> 
> 标签：java, android, oncreate, onresume

我有一个绘制到画布上的 android 应用程序。到目前为止，我每次使用 onCreate 创建应用程序时都在绘制：

```
package com.example.drawdemo;
import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;

public class DrawDemo extends Activity {
    DrawView drawView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        drawView = new DrawView(this);
        drawView.setBackgroundColor(Color.WHITE);
        setContentView(drawView);
    }
} 
```

但是我想将绘图迁移到 onResume。理想情况下，我不会在某人第一次启动程序时绘制，只有在他们恢复程序时才绘制。为什么以下两个代码片段不起作用：？

```
package com.example.drawdemo;
import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;

public class DrawDemo extends Activity {
    DrawView drawView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        drawView = new DrawView(this);
        drawView.setBackgroundColor(Color.WHITE);
        setContentView(drawView);
    }

    @Override
    public void onResume(){
        drawView = new DrawView(this);
        drawView.setBackgroundColor(Color.WHITE);
        setContentView(drawView);
    }
} 
```

和

```
package com.example.drawdemo;
import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;

public class DrawDemo extends Activity {
    DrawView drawView;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

    }

    @Override
    public void onResume(){
        drawView = new DrawView(this);
        drawView.setBackgroundColor(Color.WHITE);
        setContentView(drawView);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:22:55.523

确保您致电`super.onResume()`- 如果没有它，您的活动将无法正常运行。

# android - DraggableGridView 不能包含在项目中

> ID：15304894
> 
> 赞同：1
> 
> 时间：2013-03-08T23:10:47.413
> 
> 标签：android, gridview

我正在尝试将[thquinn`DraggableGridView`](https://github.com/thquinn/DraggableGridView)包含在我的项目中。我按照那里给出的所有说明开始，包括[将 jar 添加到我的项目的这些步骤](http://www.wikihow.com/Add-JARs-to-Project-Build-Paths-in-Eclipse-%28Java%29)。（`DraggableGridView.jar`显示为引用的库。）

它编译正确，但是在运行我的项目时，我在 Logcat 中收到以下错误：

```
I/dalvikvm(798)：找不到方法 com.animoto.android.views.DraggableGridView.addView，引用自方法 com.example.GuessWhat.GuessWhat.loadImages
W/dalvikvm(798): VFY: 无法解析虚拟方法 11: Lcom/animoto/android/views/DraggableGridView;.addView (Landroid/view/View;)V
D/dalvikvm(798): VFY: 在 0x003a 处替换操作码 0x6e
E/dalvikvm(798)：找不到类 'com.animoto.android.views.DraggableGridView'，引用自方法 com.example.GuessWhat.GuessWhat.onCreate
W/dalvikvm(798): VFY: 无法解析 Lcom/example/GuessWhat/GuessWhat 中的 check-cast 15 (Lcom/animoto/android/views/DraggableGridView;)；
D/dalvikvm(798): VFY: 在 0x0023 处替换操作码 0x1f
D/AndroidRuntime(798)：关闭虚拟机
W/dalvikvm(798): threadid=1: 线程以未捕获的异常退出 (group=0x40a71930)
E/AndroidRuntime(798)：致命异常：主要
E/AndroidRuntime(798)：java.lang.RuntimeException：无法启动活动 ComponentInfo{com.example.GuessWhat/com.example.GuessWhat.GuessWhat}：android.view.InflateException：二进制 XML 文件第 3 行：膨胀类错误com.animoto.android.views.DraggableGridView
E/AndroidRuntime(798)：在 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
E/AndroidRuntime(798)：在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
E/AndroidRuntime(798)：在 android.app.ActivityThread.access$600(ActivityThread.java:141)
E/AndroidRuntime(798)：在 android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
E/AndroidRuntime(798)：在 android.os.Handler.dispatchMessage(Handler.java:99)
E/AndroidRuntime(798)：在 android.os.Looper.loop(Looper.java:137)
E/AndroidRuntime(798)：在 android.app.ActivityThread.main(ActivityThread.java:5041)
E/AndroidRuntime(798)：在 java.lang.reflect.Method.invokeNative(Native Method)
E/AndroidRuntime(798)：在 java.lang.reflect.Method.invoke(Method.java:511)
E/AndroidRuntime(798)：在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)

```

这是我的导入：

```
import com.animoto.android.*; 
```

在我的活动中，我有：

```
DraggableGridView dgv = ((DraggableGridView) findViewById(R.id.dgv));
ImageView iv = new ImageView(getApplicationContext());
iv.setImageDrawable(new BitmapDrawable(Images[index]));
dgv.addView(iv); 
```

最后一行是构建错误所在的位置。我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T16:52:08.607

首先，由于 Eclipse 可以解决您的依赖关系，但 Dalvik 不能，因此该库似乎没有与您的应用程序捆绑在一起。造成这种情况的典型原因是将您的库作为普通 Java 依赖项添加`/lib`到`/libs`. [另请参阅此问题。](https://stackoverflow.com/questions/10132443/library-import-issues)

其次，[查看 source](https://github.com/thquinn/DraggableGridView/blob/master/src/com/animoto/android/views/DraggableGridView.java)，您的导入似乎没有正确指定。DraggableGridView 的限定名称是`com.animoto.android.views.DraggableGridView`.

您的活动应将导入声明为：

```
import com.animoto.android.views.DraggableGridView; 
```

# django - Django 是否支持可访问的表单错误？

> ID：15304896
> 
> 赞同：0
> 
> 时间：2013-03-08T23:11:00.863
> 
> 标签：django, forms, accessibility

我正在开发一个 Django 应用程序，并试图使其尽可能易于访问。

根据我团队的一位可访问性专家的说法，当显示表单错误时，最好将其聚焦，因此屏幕阅读器软件（即 JAWS）将从该点开始读取页面，而不是从顶部读取整个页面。

Django 是否提供了一种方法来做到这一点？“errorlist” 类以粗体红色字体呈现错误，但我可以看到它并没有做太多其他事情。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:47:22.750

最终，Django 可以做任何 HTML 可以做的事情——它总是可以用任何你想要的标记来呈现你的页面。

也就是说，正如您所提到的，错误的默认输出不会自动获取焦点。

# delphi - 让 cxGrid 展开当前日期

> ID：15304898
> 
> 赞同：1
> 
> 时间：2013-03-08T23:11:20.657
> 
> 标签：delphi, devexpress, delphi-xe2, delphi-xe

我按日期对网格进行了分组（抓住列名并将其拖到“按该列分组”的位置）。但是，当显示网格时，所有日期都“关闭”，所以我必须展开它们以查看数据。没关系，但我想知道是否有可能已经展开当前日期（所有其他日期都应该保持关闭！）所以我不必单击展开十字？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:37:18.657

试试这个，您可以将代码放在其他事件处理程序中，例如 TButton

```
procedure TForm1.FormCreate(Sender: TObject);
begin
    //aDBTableView1.ViewData.Expand(true);            // this is how to expand all records 
    aDBTableView1.ViewData.Records[YourRecordNumber].Expand(true);   // this is how to expand by a given record
end; 
```

好的尝试以下

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  with cxGrid1DBTableView1 do
  begin
    DataController.DataSource.DataSet.Locate('YourDateFieldName',DateTimeToStr(Date),
    [loPartialKey]);
    ViewData.Records[DataController.FocusedRowIndex].Expand(True);
  end;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T07:22:35.077

```
procedure TForm1.Button1Click(Sender: TObject);
var
  intLoop,
  vValue: Variant;
begin
  for intLoop := 0 to self.cxGrid1DBTableView1.DataController.RowCount - 1 do
  begin
    if self.cxGrid1DBTableView1.ViewData.Rows[IntLoop] is TcxGridGroupRow then
    begin
      if TcxGridGroupRow(cxGrid1DBTableView1.ViewData.Rows[IntLoop]).Level = cxGrid1DBTableView1MyDate.GroupIndex  then
      begin
        vValue:=TcxGridGroupRow(cxGrid1DBTableView1.ViewData.Rows[IntLoop]).Value ;
        if vValue = Date() then
        begin
          TcxGridGroupRow(cxGrid1DBTableView1.ViewData.Rows[intLoop]).Expand(False);
        end;
      end;
    end;
  end;
end; 
```

# nosql - Hector CassandraHostConfigurator - 何时启用 useThriftFramedTransport 标志？

> ID：15304900
> 
> 赞同：-1
> 
> 时间：2013-03-08T23:11:40.550
> 
> 标签：nosql, cassandra, hector

什么时候应该启用 useThriftFramedTransport 设置？使用 ThriftFramedTransport 有什么好处？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:59:03.487

您应该始终使用框架传输 - Cassandra 现在仅支持框架传输。进行了切换，以便格式错误的请求不会导致服务器分配过多的内存并退出。

# opencart - 用另一个表中的列的相乘值更新一个表中的列

> ID：15304902
> 
> 赞同：0
> 
> 时间：2013-03-08T23:11:45.183
> 
> 标签：opencart

我有 2 个表，第`product`一个是 column `price`，第二个`product_reward`是 column `points`。我想用列*0.1`points`中的值更新该列。`price`所以积分=价格*01。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T17:04:38.623

您可以使用以下 sql 查询来更新产品的当前奖励积分。

```
UPDATE `oc_product_reward` rp SET rp.`points`=(SELECT p.price FROM `oc_product` p WHERE rp.`product_id` = p.`product_id`)*0.1 
```

之后，您必须更新管理部分的产品模型。插入和更新部分`upload/admin/model/catalog/product.php`

```
 if (isset($data['product_reward'])) {
        foreach ($data['product_reward'] as $customer_group_id => $product_reward) {
            $this->db->query("INSERT INTO " . DB_PREFIX . "product_reward SET product_id = '" . (int)$product_id . "', customer_group_id = '" . (int)$customer_group_id . "', points = '" . (int)((float)$data['price'] * 0.1) . "'");
        }
    } 
```

# java - 将 Java 嵌套类转换为 Xamarin.Android

> ID：15304904
> 
> 赞同：1
> 
> 时间：2013-03-08T23:11:58.790
> 
> 标签：java, android, xamarin.android

Android/Java 开发中的一个典型模式是拥有一个从父类访问方法的嵌套类：

```
public class MainActivity extends FragmentActivity {

  // implementation

  public class SectionsPagerAdapter extends FragmentPagerAdapter {
    String someString = getString(R.string.thestring);
  }
} 
```

所以在这种情况下，`Context.getString()`将访问`MainActivity`上下文。
这将如何转换为`Xamarin.Android`（Android 的 Mono）？
当尝试完全相同的模式时，我得到：

> 错误 CS0038：无法访问外部类型 `Test.MainActivity' via nested type` Test.MainActivity.SectionsPagerAdapter' (CS0038)的非静态成员

我当然可以传递一个 Context 对象，但这似乎很乏味。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:19:17.810

根据 Xamarin.Android 的[API 设计](http://docs.xamarin.com/guides/android/advanced_topics/api_design)文档：

> 非静态嵌套类，也称为内部类，有很大不同。它们包含对其封闭类型实例的隐式引用，并且不能包含静态成员（以及本概述范围之外的其他差异）。

`MainActivity`因此，您应该传递to的引用`SectionsPagerAdapter`。然后，您可以访问`MainActivity`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-21T11:25:32.453

这里举个例子。我希望它有所帮助。

```
public class YourParentClassActivity : Activity
{
//your stuff 
//...

//The Nested Class (that can implement any interface or base class)
    class YourNextedExampleClass : WebViewClient
    {
        //Parent Class Reference
        private YourParentClassActivity _pc;
        public YourNextedExampleClass(YourParentClassActivity pc)
        {
            _pc = pc;
        }

        public override void OnReceivedSslError(WebView view, SslErrorHandler handler, SslError SSLError)
        {
            Intent i = new Intent(Intent.ActionView, Android.Net.Uri.Parse("xxx");
            _pc.StartActivity(i);
            _pc.Finish();
            handler.Proceed(); // Ignore SSL certificate errors
        }
    }

} 
```

# python - 动态属性分配

> ID：15304907
> 
> 赞同：1
> 
> 时间：2013-03-08T23:12:15.670
> 
> 标签：python, dynamic, attributes, variable-assignment

我正在尝试动态属性分配以进行测试，并发现了以下行为：

```
>>> class Foo(object): pass
... 
>>> bar = Spam()
>>> bar.a = 1
>>> spam = object()
>>> spam.a = 2 
```

```
Traceback (most recent call last):
  File "<input>", line 1, in <module>
AttributeError: 'object' object has no attribute 'a' 
```

为什么带有派生类的第一个版本是合法的，但第二个直接使用`object`不是？这对我来说似乎有点奇怪，因为派生并没有改变任何与变量赋值的处理方式明显有关的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:18:13.053

这是因为`object`它是原生类型，这意味着它是在 C 代码中实现的，并且出于性能原因不支持动态属性分配。对于大多数 Python 原生类，例如`str`或`int`.

但是 Python 允许您对任何本机类型进行子类化，并且您的子类确实支持动态分配。

您也可以出于性能原因在类上禁用它，使用`__slots__`特殊属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:17:37.827

`object`实例没有`__dict__`.

```
>>> hasattr(object(), '__dict__')
False 
```

因此不能向它们添加任何属性。

# python - 在python中的打印语句之前摆脱'NONE'

> ID：15304908
> 
> 赞同：1
> 
> 时间：2013-03-08T23:12:19.753
> 
> 标签：python, printing, output

嗨，我是 python 和编程的新手，我已经为文字游戏编写了一些代码，当它运行时，在某些输出之前会打印出“无”。有没有办法删除它们，我知道这与循环不返回任何内容有关，但如果可能的话，我宁愿不必大量更改代码（第一次花了我足够长的时间:)）提前致谢。

```
def compPlayHand(hand, wordList, n):

    #  Keep track of the total score
    totalScore = 0
    # As long as there are still usable letters left in the hand:
    while compChooseWord(hand,wordList,n) is not None:

        # Display the hand

        print "Current Hand: ",
        print  displayHand(hand),

        word = compChooseWord(hand,wordList,n)  # comp chooses word
        hand = updateHand(hand,word)
        # Tell the user how many points the word earned, and the updated total score, in one line followed by a blank line
        getWordScore(word,n)
        totalScore += getWordScore(word,n)
        # Update the hand
        c = calculateHandlen(hand)

        print   '"'+str(word)+'"' + " earned " + str(getWordScore(word,n)) +' points.' " Total:  " + str(totalScore) + " points."     # Otherwise (the word is valid):
        print

        if compChooseWord(hand,wordList,n) is None:  # End the game (break out of the loop)

            print  "Current Hand: ", \
                displayHand(hand),
            print "Total score: " + str(totalScore) + " points." 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:16:10.993

我们已经解决了这个问题，不要`print displayHand`，只是自己调用它。

```
def compPlayHand(hand, wordList, n):
    #  Keep track of the total score
    totalScore = 0
    # As long as there are still usable letters left in the hand:
    while compChooseWord(hand,wordList,n) is not None:

        # Display the hand

        print "Current Hand: ",
        displayHand(hand)

        word = compChooseWord(hand,wordList,n)  # comp chooses word
        hand = updateHand(hand,word)
        # Tell the user how many points the word earned, and the updated total score, in one line followed by a blank line
        getWordScore(word,n)
        totalScore += getWordScore(word,n)
        # Update the hand
        c = calculateHandlen(hand)

        print   '"'+str(word)+'"' + " earned " + str(getWordScore(word,n)) +' points.' " Total:  " + str(totalScore) + " points."     # Otherwise (the word is valid):
        print

        if compChooseWord(hand,wordList,n) is None:  # End the game (break out of the loop)

            print  "Current Hand: ",
            displayHand(hand)

            print "Total score: " + str(totalScore) + " points." 
```

# ruby-on-rails - Rails 4 beta1 安装错误

> ID：15304910
> 
> 赞同：0
> 
> 时间：2013-03-08T23:12:48.780
> 
> 标签：ruby-on-rails

我无法安装 Rails 4 beta。我使用 RVM 安装了 Ruby 2.0.0，这似乎成功了。这是我在尝试安装 Rails gem 时遇到的错误；

```
$ gem install rails --version 4.0.0.beta1 --no-ri --no-rdoc
ERROR:  Loading command: install (LoadError)
cannot load such file -- openssl
ERROR:  While executing gem ... (NoMethodError)
undefined method `invoke_with_build_args' for nil:NilClass 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:40:32.393

用最新版本重新安装你的 RVM rubies 应该能让你加载安装 Rails 所需的所有依赖项：

```
rvm get head --autolibs=3
rvm pkg remove
rvm reinstall all --force 
```

# passwords - 生成密码列表文件

> ID：15304911
> 
> 赞同：0
> 
> 时间：2013-03-08T23:12:53.307
> 
> 标签：passwords, generator, combinations

好遇见！

不幸的是，我不是程序员，但我需要一些帮助来解决我的一个很大的谜团。我想生成关于字母表、数字 0-9 和所有字母大小的 8 个字符长字符串的所有组合。显而易见的事实是，我想访问一个我忘记密码的旧加密卷。但是，我知道它有 8 个字符长（是的，不安全），而且我知道我使用了各种大小的数字和字母的组合。

任何指向正确方向的指针都会非常有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T19:03:42.500

如果您的密码长度为 8 个字符，并且可以包含 26 个全小写或全大写字母加上 10 个数字，那么您将看到 (26 + 10) ^ 8 = 2,821,109,907,456 个组合。只要您可以以每秒 5 亿次尝试的方式以编程方式访问它，您就可以破解它。这不会超过 2,821,109,907,456 / 500,000,000 = 5,643 秒 - 不到一个半小时。但是，如果您的意思是大写和小写字母，那么组合的数量将升级为 (26 + 26 + 10) ^ 8 = 360,040,606,269,696 组合，大约需要 128 倍或 5,643 * 128 = 722,304 秒。由于一天有 86,400 秒，因此将 722,304 除以 86,400 得出 8.36 天。那是假设您可以快速输入包含密码的字符串。

您可以尝试记住部分密码的任何操作都会有所帮助。如果必须手动输入密码，则无法解决。如果您有一台旧计算机或旧硬盘驱动器，请尝试四处寻找密码或密码提示，以便您重建它。您是否曾经通过电子邮件或电子邮件附件将密码发送给某人？如果是这样，您也许可以通过这种方式进行检索。你能不能把它写在某个地方？如果你有，那会在哪里？您选择的密码是否具有特殊含义，如果您记住一位或两位数字，您可以从中找出密码的其余部分？

# java - 我应该为我的主程序变量使用静态变量吗？

> ID：15304914
> 
> 赞同：3
> 
> 时间：2013-03-08T23:13:03.497
> 
> 标签：java, static

我已经阅读了这方面的帖子，所以我知道应该如何避免静态变量，它们不是面向对象的，它们就像全局变量等。

但这是我的问题，希望它不会重复：我有一些私有类变量，许多方法使用这些变量并且传递会很乏味。我正在谈论的类是我的主程序，所以它的唯一实例将是 JVM 创建的实例。

在这种情况下，如果这些变量是静态的，有什么区别吗？（也许如果用户多次打开我的应用程序并且我将变量设为静态，他们会共享变量并相互混合？）

我想使用静态，因为想从枚举内部访问这些变量。谢谢

这是枚举部分的代码：

```
enum Buttons {

    OPEN_BUTTON("Open file...",false),
    CHANGE_FONT_BUTTON("Change font",false),
    DECOR_BUTTON("Decor font",true),
    EDITOR_BUTTON("Open editor",false),
    ALPHABET_BUTTON("Open alphabet browser",false),
    CTEST_BUTTON("Start consonant test",false),
    TESTTYPE_BUTTON("Select test type...",false),
    TEST_BUTTON("Start word test",false),
    QUIT_BUTTON("Quit", false);

    private ButtonBase button;

    Buttons(String title, boolean toggle) {
        if (toggle) button = ToggleButtonBuilder.create().prefWidth(200).prefHeight(35).text(title).build();
        else button = ButtonBuilder.create().prefWidth(200).prefHeight(35).text(title).build();}

    void onClick(EventHandler<MouseEvent> eh) {button.setOnMouseClicked(eh);}
    ButtonBase getBase() {return button;}
    boolean toggled() { return ((ToggleButton)button).isSelected();  }
    void setToggle(boolean on) {((ToggleButton) button).setSelected(on); }
    void enable() {button.setDisable(false);}
    void disable() {button.setDisable(true);}
    void setText(String text) { button.setText(text);}
    void clicked() { 
```

// 这是我想要事件处理程序的地方...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T23:20:35.290

你说：

> 我正在使用 JavaFx，并且正在将我的 Buttons 制作成一个枚举，并且我想在枚举中添加 ActionEvent (click) 处理程序，所以它们都整齐地放在一个地方。处理程序需要访问类变量。

这不是一个好的设计，不是静态变量的原因，也是枚举的误用。你用这种设计抛弃了 OOP 的所有好处，所以我敦促你不要这样做。请注意，如果/当您更新或修改代码时，您通常会更改您的 GUI 组件，并且枚举应该（几乎）永远不会改变。它们应该代表你逻辑的不变基石。它们不应该用于状态像您的按钮当前所做的那样*变化的对象。*

我还建议不要在这里使用单例模式，因为不需要将其用于 GUI 组件（实际上单例与枚举非常相似）。为什么不简单地创建一个 View 类？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T23:16:04.727

如果您发现您经常传递相同的数据，那么在我看来，这些数据可能具有一定的相关性——也许通过将该数据封装到某种值对象中，您就不需要有效地使用全局数据？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-08T23:20:12.827

在单个类加载器中，静态字段始终是共享的。要将数据显式限定为线程，您需要使用 ThreadLocal 之类的工具。

[关联](https://stackoverflow.com/a/4934933/982229)

因此，如果您将静态与 ThreadLocal 一起使用，您的应用程序的多个实例不会有问题。

# arduino - Arduino - 一次管理两个 SPI 设备

> ID：15304919
> 
> 赞同：0
> 
> 时间：2013-03-08T23:13:21.463
> 
> 标签：arduino, microcontroller, spi

我正在尝试使用相同的 MISO、MOSI 和 CLOCK 引脚同时控制两个[SPI设备，但使用不同的 SS 引脚。](http://en.wikipedia.org/wiki/Serial_Peripheral_Interface_Bus)

一个是[SparkFun的](http://en.wikipedia.org/wiki/SparkFun_Electronics)[Wifly](https://www.sparkfun.com/products/9954) [shield](http://www.arduino.cc/en/Main/ArduinoShields)，它使用 SPI-to-UART 芯片，另一个是[MAX31855](http://www.maximintegrated.com/datasheet/index.mvp/id/7273)。

他们独立工作，但不能一起工作。

下面列出了我正在使用的 SPI 到 UART 代码。我所做的唯一更改是在头文件中；我设置`select()`并`deselect()`公开。

```
#include "SpiUart.h"

// See section 8.10 of the datasheet for definitions
// of bits in the Enhanced Features Register (EFR)
#define EFR_ENABLE_CTS 1 << 7
#define EFR_ENABLE_RTS 1 << 6
#define EFR_ENABLE_ENHANCED_FUNCTIONS 1 << 4

// See section 8.4 of the datasheet for definitions
// of bits in the Line Control Register (LCR)
#define LCR_ENABLE_DIVISOR_LATCH 1 << 7

// The original crystal frequency used on the board (~12 MHz) didn't
// give a good range of baud rates so around July 2010 the crystal
// was replaced with a better frequency (~14 MHz).
#ifndef USE_14_MHZ_CRYSTAL
#define USE_14_MHZ_CRYSTAL true // true (14 MHz) , false (12 MHz)
#endif

#if USE_14_MHZ_CRYSTAL
#define XTAL_FREQUENCY 14745600UL // On-board crystal (New mid-2010 Version)
#else
#define XTAL_FREQUENCY 12288000UL // On-board crystal (Original Version)
#endif

// See datasheet section 7.8 for configuring the
// "Programmable baud rate generator"
#define PRESCALER 1 // Default prescaler after reset
#define BAUD_RATE_DIVISOR(baud) ((XTAL_FREQUENCY/PRESCALER)/(baud*16UL))

// TODO: Handle configuration better
// SC16IS750 register values
struct SPI_UART_cfg {
    char DataFormat;
    char Flow;
};

struct SPI_UART_cfg SPI_Uart_config = {
    0x03,
    // We need to enable flow control or we overflow buffers and
    // lose data when used with the WiFly. Note that flow control
    // needs to be enabled on the WiFly for this to work but it's
    // possible to do that with flow control enabled here but not there.
    // TODO: Make this able to be configured externally?
    EFR_ENABLE_CTS | EFR_ENABLE_RTS | EFR_ENABLE_ENHANCED_FUNCTIONS
};

void SpiUartDevice::begin(unsigned long baudrate) {
    /*
     * Initialize SPI and UART communications
     *
     * Uses BAUD_RATE_DEFAULT as baudrate if none is given
     */

    SPI.begin();
    initUart(baudrate);
}

void SpiUartDevice::deselect() {
    /*
     * Deslects the SPI device
     */

    digitalWrite(SS, HIGH);
}

void SpiUartDevice::select() {
    /*
     * Selects the SPI device
     */

    digitalWrite(SS, LOW);
}

void SpiUartDevice::initUart(unsigned long baudrate) {
    /*
     * Initialise the UART.
     *
     * If initialisation fails this method does not return.
     */

    // Initialise and test SC16IS750
    configureUart(baudrate);

    if(!uartConnected()){
        while(1) {
          // Lock up if we fail to initialise SPI UART bridge.
        };
    }

  // The SPI UART bridge is now successfully initialised.
}

void SpiUartDevice::setBaudRate(unsigned long baudrate) {
    unsigned long divisor = BAUD_RATE_DIVISOR(baudrate);

    writeRegister(LCR, LCR_ENABLE_DIVISOR_LATCH); // "Program baudrate"
    writeRegister(DLL, lowByte(divisor));
    writeRegister(DLM, highByte(divisor));
}

void SpiUartDevice::configureUart(unsigned long baudrate) {
    /*
     * Configure the settings of the UART.
     */

    // TODO: Improve with use of constants and calculations.
    setBaudRate(baudrate);

    writeRegister(LCR, 0xBF); // Access EFR register
    writeRegister(EFR, SPI_Uart_config.Flow); // Enable enhanced registers
    writeRegister(LCR, SPI_Uart_config.DataFormat); // 8 data bit, 1 stop bit, no parity
    writeRegister(FCR, 0x06); // Reset TXFIFO, reset RXFIFO, non FIFO mode
    writeRegister(FCR, 0x01); // Enable FIFO mode
}

boolean SpiUartDevice::uartConnected() {
    /*
     * Check that UART is connected and operational.
     */

    // Perform read/write test to check if the UART is working
    const char TEST_CHARACTER = 'H';

    writeRegister(SPR, TEST_CHARACTER);

    return (readRegister(SPR) == TEST_CHARACTER);
}

void SpiUartDevice::writeRegister(byte registerAddress, byte data) {
    /*
     * Write <data> byte to the SC16IS750 register <registerAddress>
     */

    select();
    SPI.transfer(registerAddress);
    SPI.transfer(data);
    deselect();
}

byte SpiUartDevice::readRegister(byte registerAddress) {
    /*
     * Read byte from SC16IS750 register at <registerAddress>.
     */

    // Used in SPI read operations to flush slave's shift register
    const byte SPI_DUMMY_BYTE = 0xFF;

    char result;

    select();
    SPI.transfer(SPI_READ_MODE_FLAG | registerAddress);
    result = SPI.transfer(SPI_DUMMY_BYTE);
    deselect();
    return result;
}

int SpiUartDevice::available() {
    /*
     * Get the number of bytes (characters) available for reading.
     *
     * This is data that's already arrived and stored in the receive
     * buffer (which holds 64 bytes).
     */

    // This alternative just checks if there's data but doesn't
    // return how many characters are in the buffer:
    //    readRegister(LSR) & 0x01
    return readRegister(RXLVL);
}

int SpiUartDevice::read() {
    /*
     * Read byte from UART.
     *
     * Returns byte read or or -1 if no data available.
     *
     * Acts in the same manner as 'Serial.read()'.
     */

    if (!available()) {
        return -1;
    }

    return readRegister(RHR);
}

size_t SpiUartDevice::write(byte value) {
    /*
     * Write byte to UART.
     */

    while (readRegister(TXLVL) == 0) {
        // Wait for space in TX buffer
    };
    writeRegister(THR, value);
}

size_t SpiUartDevice::write(const char *str, size_t size) {
    /*
     * Write string to UART.
     */

    while (size--)
        write(*str++);

    while (readRegister(TXLVL) < 64) {
        // Wait for empty TX buffer (slow).
        // (But apparently still not slow enough to ensure delivery.)
    };
}

void SpiUartDevice::flush() {
    /*
     * Flush characters from SC16IS750 receive buffer.
     */

    // Note: This may not be the most appropriate flush approach.
    //       It might be better to just flush the UART's buffer
    //       rather than the buffer of the connected device
    //       which is essentially what this does.
    while(available() > 0) {
        read();
    }
}

void SpiUartDevice::ioSetDirection(unsigned char bits) {
    writeRegister(IODIR, bits);
}

void SpiUartDevice::ioSetState(unsigned char bits) {
    writeRegister(IOSTATE, bits);
} 
```

我试图这样使用它：

```
SpiSerial.deselect(); //Deselect Wi-Fi
delay(100);           //Wait, just for the heck of it.
currentTemp = thermocouple.readFarenheit(); //Read from max31855... readFarenheit selects and unselects its own SS pin.
SpiSerial.select();   //Reselect Wi-Fi 
```

但它仍然无法运行。为了让它发挥作用，我应该尝试什么进一步的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-09T01:42:00.997

两个问题：

*   您没有提及 MAX31855 库或它的使用方式。看起来您正在使用 Adafruit_MAX31855。您是否将构造函数实例的第二个参数设置为“SS”或与 MAX31855 相关的片选引脚的值？它们各自的片选不能共用同一个管脚。

*   Adafruit_MAX31855[位](http://en.wikipedia.org/wiki/Bit_banging)通过 GPIO 模拟 SPI。这与 Wi-Fi 真正的硬 SPI 不同。从那时`spi.begin();`起`SpiUartDevice::begin()`，与硬 SPI 共享的 GPIO 引脚不再可用作 GPIO。结果，Adafruit_MAX31855 位刘海什么也不做。后一个问题有几种选择。

    *   使用不同的 MAX31855 库，它不会对它产生影响。但我不会很快看到一个。
    *   将 Adafruit_MAX31855 修复到硬 SPI。
    *   MAX31855 使用不同的引脚，而不是硬 SPI 引脚。
    *   使用该`SPI.end()`函数关闭 SPI 并使 GPIO 恢复正常 IO 使用，然后`SPI.begin()`在位敲出 Adafruit_MAX31855 函数调用后重新启动。

如下所示：

```
SpiSerial.deselect(); //Deselect Wi-Fi
SPI.end();            //Restore GPIO mode of pins
delay(100);           //Wait, just for the heck of it
currentTemp = thermocouple.readFarenheit();
SPI.begin();          //Restore SPI mode of pins
SpiSerial.select();   //Reselect Wi-Fi 
```

# tomcat - 以编程方式启用 GZIP Tomcat 7（嵌入式）

> ID：15304921
> 
> 赞同：1
> 
> 时间：2013-03-08T23:13:25.777
> 
> 标签：tomcat, tomcat7, embedded-tomcat-7

我正在使用 Tomcat7（嵌入式）

像这样的东西...

```
String APP_DIR = "ROOT";
Tomcat current = new Tomcat();
File file = new File(APP_DIR);
if (file.isDirectory() && file.canRead()) {
    ctx = current.addWebapp(null, "", file.getAbsolutePath());
    ctx.setSessionCookiePathUsesTrailingSlash(false);
}
current.start();
ctx.addServletMapping("*.pdf", "jsp", true); 
```

我已经启用了到 jsp servlet 的 *.pdf 映射（我在 IE 上遇到的一些问题）有没有办法使用这个配置启用 GZIP（我没有 web.xml，但如果需要我可以添加以使其工作）到目前为止我只发现我需要将它添加到我的 web.xml （我没有！）

```
<Connector port=”8080″ maxHttpHeaderSize=”8192″
maxThreads=”150″ minSpareThreads=”25″ maxSpareThreads=”75″
enableLookups=”false” redirectPort=”8443″ acceptCount=”100″
connectionTimeout=”20000″ disableUploadTimeout=”true”
compression=”on”
compressionMinSize=”2048″
noCompressionUserAgents=”gozilla, traviata”
compressableMimeType=”text/html,text/xml”/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T00:06:51.060

编辑：`compressableMimeType`根据`compressibleMimeType`评论更新属性`pieroxy`

我发现您可以像这样设置属性：

```
Tomcat current = new Tomcat();
Connector c = this.current.getConnector();
c.setProperty("compression", "on");
c.setProperty("compressionMinSize", "1024");
c.setProperty("noCompressionUserAgents", "gozilla, traviata");
c.setProperty("compressibleMimeType", "text/html,text/xml, text/css, application/json, application/javascript"); 
```

我想这也适用于您需要设置的其他连接器属性。

# javascript - jQuery 在 JS 文件中不可用

> ID：15304924
> 
> 赞同：0
> 
> 时间：2013-03-08T23:13:59.250
> 
> 标签：javascript, jquery, html, css

下面是我的 HTML、css 和 JavaScript。谁能看到我哪里出错了？注意：我在单独的文件中创建 JavaScript，而不是在与 HTML 相同的文件中。

我是否必须在 jQuery 文件上添加任何其他链接或代码以使其执行该功能？

HTML 代码：

```
<!DOCTYPE html>

<html>
<head>
    <link rel="stylesheet" type="text/css" href="stylesheet.css">
    <script type="text/javascript" src="script.js"></script>
<title>CodePlay</title>
</head>
<body>

    <div></div>
</body>
</html> 
```

CSS：

```
div {
    height: 100px;
    width: 100px;
    border-radius: 5px;
    background-color: red;
    opacity: 0.25;
} 
```

JavaScript：

```
$(document).ready(function(){
    $("div").mouseenter(function(){
        $("div").fadeTo("fast", 1);
    });
    $("div").mouseleave(function(){
        $("div").fadeTo("fast", 0.25);
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:28:13.430

您在 html 代码的 head 部分中缺少 jQuery 脚本，请将此行添加到：

```
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script> 
```

该行适用于您正在使用的 HTML5，所以您没问题。如果您使用的是 HTML 4 或 XHTML，则需要这样引用它：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script> 
```

祝你编码好运。

# php - 如何在自定义 .php 文件中包含 WordPress 函数？

> ID：15304926
> 
> 赞同：76
> 
> 时间：2013-03-08T23:14:20.503
> 
> 标签：php, wordpress, include

**如何在自定义 .php 文件中包含 WordPress 函数？**

详细说明：我的主题（构造函数）下有一个名为报告的目录。这些包含 .php 文件，这些文件使用 DOMPDF 从站点的数据生成报告以供下载。对于这些，我想使用 WordPress 引擎提供的功能，例如`get_the_author_meta( 'user_firstname', $user_id )`. 如果我使用这些，我（自然）会得到以下错误：

> 致命错误：在第 15 行的 ROOT/public_html/wp-content/themes/constructor/reports/testreport.php 中调用未定义函数 get_the_author_meta()

我被引导相信我需要包含 wp-blog-header.php 。我用`require_once("../../../../wp-blog-header.php");`. 有了这个我得到以下404错误：

> 没有找到该网址的网页：ROOT/wp-content/themes/constructor/reports/testreport.php

（需要指向正确的路径。如果我摆弄它，我会收到警告：require_once(../../../wp-blog-header.php): failed to open stream... 所以路径必须是正确的。）

有什么我忽略的吗？为什么我不能包含这个 wp 文件？包含 wp 函数的正确方法是什么？

感谢您的帮助，西罗

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2013-03-09T03:00:01.880

你在正确的轨道上。试试这个：

```
require_once("../../../../wp-load.php"); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2016-05-23T06:20:12.877

要在自定义 .php 文件中使用 wp 函数，您必须将其包含`wp-load.php`在您的文件中。您可以通过添加以下行来做到这一点：

```
require_once(PATH_TO.'/wp-load.php'); 
```

如果 WordPress 在文档根目录中，请改为添加：

```
require_once($_SERVER['DOCUMENT_ROOT'].'/wp-load.php'); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-08-22T09:10:24.493

好吧，如果有人安装了较新的 PHP 版本（ver >= 5.5.x），那么他们也可以在 WordPress 网站目录本身的根脚本中尝试以下代码：

```
<?php
define("WP_ROOT", __DIR__);
define("DS", DIRECTORY_SEPARATOR);
require_once WP_ROOT . DS . "wp-load.php"; 
```

或者

```
<?php
define("WP_ROOT", __DIR__);
define("DS", DIRECTORY_SEPARATOR);
require_once WP_ROOT . DS . "wp-blog-header.php"; 
```

我想这是一种更直接和更干净的方法，不涉及手动添加斜杠和更改目录`..`。

希望这可以帮助某人。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-02-05T09:13:14.063

```
require_once(dirname(__FILE__) . '/options.php'); 
```

这是在 WordPress 中包含文件的更好方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-11-13T16:29:13.283

外部文件可以轻松访问 WordPress 功能。您只需要将文件包含`wp-load.php`在您的外部文件中。该`wp-load.php`文件位于 WordPress 安装的根目录中。示例：假设您的文件`test.php`位于 WordPress 安装的根目录。

```
<?php
require_once('wp-load.php');
// Your custom code
?> 
```

来源：[如何在外部文件中访问 WordPress 函数](https://webolute.com/blog/wordpress/how-to-access-wordpress-functions-in-external-file)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-14T04:54:54.297

我使用这种方法在 WordPress 之外加载 WordPress 环境。

```
 if (file_exists($_SERVER['DOCUMENT_ROOT'] . '/wp-load.php')) {

      /** Loads the WordPress Environment and Template */
      require_once($_SERVER['DOCUMENT_ROOT'] . '/wp-load.php');

  } 
```

# javascript - 页面重新加载后，从本地存储中检索复选框集合的保存状态

> ID：15304927
> 
> 赞同：5
> 
> 时间：2013-03-08T23:14:26.907
> 
> 标签：javascript, jquery, checkbox, storage, local

我在这里收集了 20 个这样的复选框：

```
<div class="cbcell">
<input type="checkbox" class="checkbox" id="home_swimming_pool" name="Basen" value="35"> Basen 
</div>
<div class="cbcell">
<input type="checkbox" class="checkbox" id="home_sauna" name="Sauna" value="45"> Sauna 
</div> 
```

使用以下代码，我正在保存和删除本地存储中的复选框状态，它工作得很好，dataTables 的过滤器功能也工作得很好。

```
<script type="text/javascript" > 
$(':checkbox').click(function(){
        var name = $(this).attr('name');
        var value = $(this).val();

          if($(this).is(':checked')){

          console.log( name, value ); // <- debug  
          oTable.fnFilter(name, value,false,true,false,true);
             localStorage.setItem(this.name,'checked');

          } else {
          console.log( name, value ); // <- debug 
             oTable.fnFilter('',value,false,true,false,true);
             localStorage.removeItem(this.name);
          }
        //})
        });
</script> 
```

请告诉我如何在页面重新加载后检索每个复选框的状态。我已经尝试了几个功能，我最后的立场是：

```
$(document).ready(function() {

                      if (localStorage.getItem(this.value) == 'checked'){
                          $(this).attr("checked",true)
                      }

                    }) 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T23:20:57.350

尝试这个

```
$(':checkbox').each(function() {
    $(this).prop('checked',localStorage.getItem(this.name) == 'checked');
}); 
```

在**$(document).ready()**函数中，`this`指的是文档，而不是复选框，就像在**$(':checkbox').click()**中一样。另外，如果您考虑一下，您确实需要一种方法来遍历您的复选框。这就是**.each()**的用武之地。在**$(':checkbox').each()**函数内部，`this`将引用特定的复选框

此外，最好检查一下运行代码的浏览器是否确实支持 localStorage，否则会出错。

一个简单的方法是将所有内容包装在一个`if (window.localStorage) { /* code here */}`

* * *

**改良版**

```
if (window.localStorage) {
    $('.cbcell').on('click',':checkbox',function(){
        var name = this.name;
        var value = this.value;

          if($(this).is(':checked')){
             oTable.fnFilter(name, value,false,true,false,true);
             //shorthand to check that localStorage exists
             localStorage && localStorage.setItem(this.name,'checked');

          } else {
             oTable.fnFilter('',value,false,true,false,true);
             //shorthand to check that localStorage exists
             localStorage && localStorage.removeItem(this.name);
          }
    });

    $(document).ready(function () {
        $(':checkbox').each(function() {
            $(this).prop('checked',localStorage.getItem(this.name) == 'checked');
        });
    });
} 
```

* * *

最后，我建议您花一些时间在[http://try.jquery.com/上阅读](http://try.jquery.com/)**出色的** [Try jQuery](http://try.jquery.com/)教程

# php - 会话变量在特定机器上消失

> ID：15304929
> 
> 赞同：1
> 
> 时间：2013-03-08T23:14:36.900
> 
> 标签：php, session

我正在使用 PHP 会话变量在结帐前跟踪购物车数据。我已经测试了多台计算机和每台计算机上的每个浏览器，并且会话变量在购物车和结帐屏幕之间维护。但是，在客户端的计算机上，数据有时会消失，并且会在新页面上启动新会话。我们永远无法复制这个问题。

在这两个页面之间，我们移动到不同的目录并从 http: 移动到 https:，但在测试中，即使在此站点上执行此操作，我们也能够保留会话变量。客户端还启用了第三方 cookie。我已经查看了类似问题的解决方案，但它们没有帮助。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:36:31.153

我从事过类似的项目，但我们正在跳过域（example.com -> secure.example.com）进行结帐。我们使用的解决方案是将数据推送到缓存中，并将缓存键添加到 url。这样当用户登陆 secure.example.com 时，我们可以从查询字符串中获取缓存键，在缓存中查找数据，并加载必要的数据。使用此解决方案，您无需担心会话对齐。

# c - 将数据从一个指针复制到另一个段故障

> ID：15304930
> 
> 赞同：1
> 
> 时间：2013-03-08T23:14:40.343
> 
> 标签：c, pointers, segmentation-fault

我对我的 C 技能有点生疏了，前几天我正在做一项作业，遇到了一些指示。我不知道为什么，但这完全把我难住了。因此，如果解决方案微不足道，请原谅我。

我编写了以下代码以将一个指针中的数据复制到另一个指针。我不想使用 memcpy、strcpy 或任何其他函数。

```
char *word = "hello world!";
char *ptra = NULL;

ptra = malloc(strlen(word) + 1);

for (; word != '\0'; word++, ptra++) {
    *ptra = *word;
}

*ptra = '\0'; 
```

现在，当我编译它时，我得到一个分段错误。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T23:16:15.800

您缺少一个取消引用：它应该`*word != '\0'`处于循环条件中：

```
for (; *word != '\0'; word++, ptra++) {
    // ^ Here
    *ptra = *word;
} 
```

因为`word`是一个指针，它永远不会等于`\0`，所以你的循环将超过两个字符串的末尾。

# xcode - tuneup.js 报告 test() 方法的“找不到变量”

> ID：15304933
> 
> 赞同：0
> 
> 时间：2013-03-08T23:14:59.470
> 
> 标签：xcode, instruments, ios-ui-automation

`enter code here`因为我无法使用 4.6 版本的 Instruments 使通过/失败日志记录正常工作，所以我正在尝试使用[tuneup.js](https://github.com/alexvollmer/tuneup_js)库，但每当我尝试运行测试时，我都会收到以下错误：

```
Can't find variable: test 
```

这是代码：

```
//We want to use the tuneup library to add extra capabilities
#import <tuneup_js/tuneup.js>
#import <tuneup_js/test.js>

var target = UIATarget.localTarget();

var target = UIATarget.localTarget();
var app = UIATarget.localTarget().frontMostApp();

test("Test1", function(target, app) {

//Do UI automation stuff

var titleDisplayed = tableView.cells()[0].name();
var StoryName = "My Dogs!";

UIALogger.logMessage("My Story Title: " + titleDisplayed);
UIALogger.logMessage("Innocuous Message-1.");

assertEquals(titleDisplayed, StoryName); 

}); // <------Error points to this line!

//End test 
```

知道我做错了什么吗？tuneup.js 库位于名为 tuneup_js 的文件夹中，该文件夹位于包含我的测试脚本（仪器跟踪文件）的目录的根目录中，并且在启动时我没有收到任何导入错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T07:28:05.447

问题是 Instruments 找不到 *tuneup_js* 库，所以它找不到*测试*函数。您需要在引号中添加导入，并且不需要添加`tuneup_js/test.js`，因为`tuneup_js/tuneup.js`包含所有需要的类

```
//We want to use the tuneup library to add extra capabilities
#import "tuneup_js/tuneup.js"

var target = UIATarget.localTarget();

var target = UIATarget.localTarget();
var app = UIATarget.localTarget().frontMostApp();

test("Test1", function(target, app) {

//Do UI automation stuff

var titleDisplayed = tableView.cells()[0].name();
var StoryName = "My Dogs!";

UIALogger.logMessage("My Story Title: " + titleDisplayed);
UIALogger.logMessage("Innocuous Message-1.");

assertEquals(titleDisplayed, StoryName); 

}); 
```

# python - 如何获取python中异常类型的错误号列表（Errno）？

> ID：15304934
> 
> 赞同：11
> 
> 时间：2013-03-08T23:15:02.527
> 
> 标签：python, exception

对于特定的异常类型（比如说 IOError），我如何提取 Errno 的完整列表和如下描述：

Errno 2：没有这样的文件或目录

Errno 122：超出磁盘配额

...

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-08T23:32:19.577

由于[错误代码](http://www.ioplex.com/%7Emiallen/errcmpp.html)因平台而异，并且用户的语言可能不同，因此通常最好以正常方式打印异常。

但是，如果你真的想要这个列表：

```
import os
import errno

print {i:os.strerror(i) for i in sorted(errno.errorcode)} 
```

打印（在 OS X 上）：

```
{1: 'Operation not permitted', 2: 'No such file or directory',
 3: 'No such process', 4: 'Interrupted system call',
 5: 'Input/output error', 6: 'Device not configured',
 7: 'Argument list too long', 8: 'Exec format error',
 9: 'Bad file descriptor', 10: 'No child processes',
 11: 'Resource deadlock avoided', 12: 'Cannot allocate memory',
 13: 'Permission denied', 14: 'Bad address', 15: 'Block device required',
 16: 'Resource busy', 17: 'File exists', 18: 'Cross-device link',
 19: 'Operation not supported by device', 20: 'Not a directory',
 21: 'Is a directory', 22: 'Invalid argument',
 23: 'Too many open files in system', 24: 'Too many open files',
 25: 'Inappropriate ioctl for device', 26: 'Text file busy',
 27: 'File too large', 28: 'No space left on device', 29: 'Illegal seek',
 30: 'Read-only file system', 31: 'Too many links', 32: 'Broken pipe',
 33: 'Numerical argument out of domain', 34: 'Result too large',
 35: 'Resource temporarily unavailable', 36: 'Operation now in progress',
 37: 'Operation already in progress', 38: 'Socket operation on non-socket',
 39: 'Destination address required', 40: 'Message too long',
 41: 'Protocol wrong type for socket', 42: 'Protocol not available',
 43: 'Protocol not supported', 44: 'Socket type not supported',
 46: 'Protocol family not supported',
 47: 'Address family not supported by protocol family',
 48: 'Address already in use', 49: "Can't assign requested address",
 50: 'Network is down', 51: 'Network is unreachable',
 52: 'Network dropped connection on reset',
 53: 'Software caused connection abort', 54: 'Connection reset by peer',
 55: 'No buffer space available', 56: 'Socket is already connected',
 57: 'Socket is not connected', 58: "Can't send after socket shutdown",
 59: "Too many references: can't splice", 60: 'Operation timed out',
 61: 'Connection refused', 62: 'Too many levels of symbolic links',
 63: 'File name too long', 64: 'Host is down', 65: 'No route to host',
 66: 'Directory not empty', 68: 'Too many users',
 69: 'Disc quota exceeded', 70: 'Stale NFS file handle',
 71: 'Too many levels of remote in path', 77: 'No locks available',
 78: 'Function not implemented',
 84: 'Value too large to be stored in data type', 90: 'Identifier removed',
 91: 'No message of desired type', 92: 'Illegal byte sequence',
 94: 'Bad message', 95: 'EMULTIHOP (Reserved)',
 96: 'No message available on STREAM', 97: 'ENOLINK (Reserved)',
 98: 'No STREAM resources', 99: 'Not a STREAM', 100: 'Protocol error',
 101: 'STREAM ioctl timeout', 102: 'Operation not supported on socket'} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-08T23:24:41.093

正如其他人所说，您应该检查`<errno.h>`您的系统。

如果你想在 python 中做到这一点：

```
import errno
print errno.errorcode 
```

输出将是

```
{1: 'EPERM', 2: 'ENOENT', 3: 'ESRCH', 4: 'EINTR', 5: 'EIO', 6: 'ENXIO', 7: 'E2BIG', 8: 'ENOEXEC', 9: 'EBADF', 10: 'ECHILD', 11: 'EDEADLK', 12: 'ENOMEM', 13: 'EACCES', 14: 'EFAULT', 15: 'ENOTBLK', 16: 'EBUSY', 17: 'EEXIST', 18: 'EXDEV', 19: 'ENODEV', 20: 'ENOTDIR', 21: 'EISDIR', 22: 'EINVAL', 23: 'ENFILE', 24: 'EMFILE', 25: 'ENOTTY', 26: 'ETXTBSY', 27: 'EFBIG', 28: 'ENOSPC', 29: 'ESPIPE', 30: 'EROFS', 31: 'EMLINK', 32: 'EPIPE', 33: 'EDOM', 34: 'ERANGE', 35: 'EAGAIN', 36: 'EINPROGRESS', 37: 'EALREADY', 38: 'ENOTSOCK', 39: 'EDESTADDRREQ', 40: 'EMSGSIZE', 41: 'EPROTOTYPE', 42: 'ENOPROTOOPT', 43: 'EPROTONOSUPPORT', 44: 'ESOCKTNOSUPPORT', 46: 'EPFNOSUPPORT', 47: 'EAFNOSUPPORT', 48: 'EADDRINUSE', 49: 'EADDRNOTAVAIL', 50: 'ENETDOWN', 51: 'ENETUNREACH', 52: 'ENETRESET', 53: 'ECONNABORTED', 54: 'ECONNRESET', 55: 'ENOBUFS', 56: 'EISCONN', 57: 'ENOTCONN', 58: 'ESHUTDOWN', 59: 'ETOOMANYREFS', 60: 'ETIMEDOUT', 61: 'ECONNREFUSED', 62: 'ELOOP', 63: 'ENAMETOOLONG', 64: 'EHOSTDOWN', 65: 'EHOSTUNREACH', 66: 'ENOTEMPTY', 68: 'EUSERS', 69: 'EDQUOT', 70: 'ESTALE', 71: 'EREMOTE', 77: 'ENOLCK', 78: 'ENOSYS', 84: 'EOVERFLOW', 90: 'EIDRM', 91: 'ENOMSG', 92: 'EILSEQ', 94: 'EBADMSG', 95: 'EMULTIHOP', 96: 'ENODATA', 97: 'ENOLINK', 98: 'ENOSR', 99: 'ENOSTR', 100: 'EPROTO', 101: 'ETIME', 102: 'EOPNOTSUPP'} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-08T23:20:31.363

我担心那些直接来自标准 C 库，所以你必须在你的系统文档中查找它。（GLibC、微软、UNIX……）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-08T23:21:33.727

在您的系统上查找 errno.h。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-23T17:14:35.057

谢谢@the-wolf：我不记得常量是从哪里来的（os.strerror），所以决定把它放在这里以备将来参考。

```
def error_codes():
    from os import strerror as SE
    from errno import errorcode as EC
    for k in EC.keys():
        print("error: [Errno %i] %s [%s]"%(k,SE(k),EC[k]))
        #print("{%3i: %s}"%(k,EC[k]))
    del SE, EC
    try: del k
    except: pass

# Just print it
error_codes() 
```

# facebook-likebox - 当小于高度 < 425px 时，像框底部边框被截断

> ID：15304935
> 
> 赞同：0
> 
> 时间：2013-03-08T23:15:06.040
> 
> 标签：facebook-likebox, truncated

这个问题是去年提出并关闭的，但我仍然发现它正在发生。如果您指定的高度小于 424 像素，则likebox 的底部会被截断，因此您看不到底部边框。如果它远小于 400 像素，您也看不到滚动条的底部箭头。无论哪种方式，它都会提供不太理想的用户体验。

您可以在代码生成器页面上轻松重现它：http: [//developers.facebook.com/docs/reference/plugins/like-box/](http://developers.facebook.com/docs/reference/plugins/like-box/)通过指定小于 424px 的高度并生成代码。然后关闭代码框，看demo。

我会发布这个图片，但我没有足够的声望点，所以你只需要自己尝试一下。

这发生在 IE8、FF 和 Chrome 上。确切的高度会有所不同，但由于高度不足，它会在所有三个上截断。

# bash - 使用 sed 替换以字符串开头的整行的第一个实例

> ID：15304949
> 
> 赞同：1
> 
> 时间：2013-03-08T23:16:18.687
> 
> 标签：bash, sed

我正在尝试编写一个 bash 脚本，该脚本将使用 sed 替换以给定字符串开头的文本文件中的整行，并且我只希望它对第一个匹配项执行此替换。

例如，在我的文本文件中，我可能有：

```
hair=brown
age=25
eyes=blue
age=35
weight=177 
```

我可能想简单地将第一次出现的以“age”开头的行替换为不同的数字，而不影响第二个年龄实例：

```
hair=brown
age=55
eyes=blue
age=35
weight=177 
```

到目前为止，我想出了

```
sed -i "0,/^PATTERN/s/^PATTERN/PATTERN=XY/" test.txt 
```

但这只会替换字符串“age”本身而不是整行。我一直试图在某处扔一个“\ c”来改变整条线，但到目前为止没有任何效果。有没有人对如何解决这个问题有任何想法？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T23:32:01.923

就像@ruakh 建议的那样，您可以使用

```
sed -i "0,/^PATTERN/ s/^PATTERN=.*$/PATTERN=XY/" test.txt 
```

一种更短且重复性更低的方法是

```
sed -i '0,/^\(PATTERN=\).*/s//\1XY/' test.txt 
```

它利用了反向引用以及不在 s 表达式中指定模式将使用先前匹配的模式这一事实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T12:08:57.017

`0,...`-ranges 仅适用于`GNU sed`. 另一种方法可能是使用 shell 重定向`sed`：

```
{ sed '/^\(PATTERN\).*/!n; s//\1VAL;q'; cat ;} < file 
```

或使用`awk`：

```
awk '$1=="LABEL" && !n++ {$2="VALUE"}1' FS=\\= OFS=\\= file 
```

# ajax - 前端 ajax POST 调用无法登录 Django

> ID：15304950
> 
> 赞同：1
> 
> 时间：2013-03-08T23:16:22.997
> 
> 标签：ajax, django, login, registration, tastypie

我已经花了几天无济于事，想知道是否有人可以帮助我？我试图将 Django 用作后端，最终目标是移植到移动应用程序。我在前端有一个表单和 ajax 调用到 Django 中的 url/view（REST API 以及如果相关），但由于某种原因，我不明白该调用不会让我登录.

相关应用：

*   Django-Userena
*   好吃的

谁能建议我正确的方向？下面是代码，谢谢！

索引.html

`<script>`

`$(document).ready(function(){`

```
`//login test`

`$('#login').submit(function(){`

    $.ajax({
        url: 'http://127.0.0.1:8000/accounts/signin/',
        type: 'POST',
        //data: loginString,
        data: $('#login').serialize(),
        success: function() {
            alert('Test');
            $('#datadisplay').append("<h2>It worked</h2>");
        },  
        error: function(errorThrown){
            alert('Error');
            alert(errorThrown);
        }
    });
});

});

</script>

</head>

<body>

<div id="datadisplay"></div>
<input type="submit" id="getdata" value="Submit">

<div id="loginform">
 <form name="login" id="login" action="">
     <fieldset>
        <label for="id_identification">Username</label>
        <input type="text" name="identification" id="id_identification" size="30" value="" />
        <br/>

        <label for="id_password">Password</label>
        <input type="password" name="password" id="id_password" size="30" value="" />
        <br/>

        <input type="submit" name="submit" class="loginbutton" value="Login" />
    </fieldset>
</form>
</div> 
```

api.py

`class UserResource(ModelResource):`

```
 class Meta:
       queryset = User.objects.all()
       resource_name = 'user'
       include_resource_uri = False
       allowed_methods = ['get', 'post']

def override_urls(self):
    return [url(r"^(?P<resource_name>%s)/signin%s$" %
    (self._meta.resource_name, trailing_slash()),
    self.wrap_view('signin'), name="api_signin"),
    ]

def signin(self, request, **kwargs):
    self.method_check(request, allowed=['post'])

    data = self.deserialize(request, request.raw_post_data, format=request.META.get('CONTENT_TYPE', 'application/json'))

    username = data.get('username', '')
    password = data.get('password', '')

    user = authenticate(username=username, password=password)

    if user:
        if user.is_active:
            login(request, user)
            return self.create_response(request, {
            'success': True
            })
        else:
            return self.create_response(request, {
            'success': False,
            'reason': 'disabled',
            }, HttpForbidden )
    else:
        return self.create_response(request, {
        'success': False,
        'reason': 'incorrect',
        }, HttpUnauthorized ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T00:25:08.950

```
$.ajax({
    url: '/accounts/signin/',
    type: 'POST',
    data: {
        csrfmiddlewaretoken: '{{csrf_token}}',
        //other variables
    },
    success: function() {
        alert('Test');
        $('#datadisplay').append("<h2>It worked</h2>");
    },  
    error: function(errorThrown){
        alert('Error');
        alert(errorThrown);
    }
}); 
```

# c++ - 遍历 MultiMap 以查找从给定值到给定键的路径

> ID：15304951
> 
> 赞同：0
> 
> 时间：2013-03-08T23:16:34.020
> 
> 标签：c++, multimap, adjacency-list

**细节：**

我有一个表示图子集的邻接列表的多图实现。

我需要通过图的这个子集找到一条路径，它实际上是从开始节点`F`到结束节点的所有可能路径`G`，通过在全图上运行广度优先搜索获得。

**实施思路：**

BFS 退出一次`G`被发现，所以你最终`G`只在多图的值中。我的想法是，如果你从 value 开始`G`，得到`G`的“key”（我们称之为`H`），如果`H == F`我们有我们的路径。否则，您继续并寻找`H`与另一个键关联的值（称为它`D`），如果`D == F`我们有我们的路径......此时我们的路径开始`F`看起来像`F -> H -> G`

**问题：**

这会扩展吗？由于地图只包含从`F`到的可能路径的子集`G`，在 G 处停止，因此它不应该意外地生成循环路径或生成重复的键。如果子集的基数为 n，那么 n 将是任何给定键的最多值，因此您连接的边数永远不会超过 n。

**你将如何编码？**

我可以思考所涉及的逻辑和数学，但我对地图库的理解还不够好，无法自己写出来。~~在阅读了 c++ 参考之后，我知道我可以使用 map 方法`upper/lowerbound`，但我找不到支持它的示例。~~

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T13:05:58.560

结果是相对微不足道的：

```
typedef multimap<int, int> MapType;
typedef MapType::const_iterator MapItr;
vector<int> path;

path.push_back(G);

int end = G;                                    // we know G, so mark it
    while ( end != F ) {                        // as long as mark is not F

        // now loop through map searching for value that matches G
        for (MapItr iter = pathMap.begin(); iter != pathMap.end(); iter++)
        {
            if (iter->second == end) {          // once we find our marked value/vertex

                path.push_back(iter->first);    // push it's key onto the vector
                end = iter->first;              // and mark it's key for next iteration
                                                // continue this until end reaches F
            }                                   // at which point will have our path
                                                // from G to F
        }
    }
    // avoid this step by using a container with a push_front method
    reverse(path.begin(), path.end());          // reverse path 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:27:02.857

您可以遍历整个地图

C++11

```
for(const auto& key_val: the_map)
{
  std::cout<<key_val.first<<":"<<key_val.second<<std::endl;
} 
```

非 C++11

```
for(the_map_type::const_iterator itr = the_map.begin(); itr != the_map.end();++itr)
{
  std::cout<<itr->first<<":"<<itr->second<<std::endl;
} 
```

`the_map.lower_bound(key)`将为您提供一个迭代器，指向具有键的第一个元素`key`

`the_map.upper_bound(key)`将为您提供一个迭代器，该迭代器经过任何带有键的元素`key`

# php - 如何将变量添加到我的活动会话数组？

> ID：15304953
> 
> 赞同：1
> 
> 时间：2013-03-08T23:17:01.147
> 
> 标签：php, arrays, session-variables

我可能会以错误的方式解决这个问题，但我只能通过提问来学习。

我有一个收集姓名、地址等的表单。该表单最初设计为只有一个名为 的字段`bill_name`。我已将其更改为两个字段`bill_fname`和`bill_lname`. 然后将会话数据用于下一页上的视觉验证，然后提交以进行后续处理。

在发送它们进行处理之前，如何组合变量`$_SESSION['donate']['bill_fname']`并将`$_SESSION['donate']['bill_lname']`它们添加到验证页面上的数组中？`$_SESSION['donate']['bill_name']`

在数组中包含所有 3 个变量的原因是处理代码的一个很好的部分使用`$_SESSION['donate']['bill_name']`并且我添加的新代码需要单独的值`$_SESSION['donate']['bill_fname']`and`$_SESSION['donate']['bill_lname']`

我希望这是有道理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:19:32.307

这很简单，只需连接字符串（我在这里也使用空格）并将它们分配给`bill_name`键；

```
 $_SESSION['donate']['bill_name'] = $_SESSION['donate']['bill_fname'] . " " . $_SESSION['donate']['bill_lname'] 
```

另外，我认为这种方法本身没有任何问题。但是，我不是一个 php 开发人员，所以我不了解最佳实践。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:19:11.230

尝试：

```
$_SESSION['donate']['bill_name'] = $_SESSION['donate']['bill_fname']." ".$_SESSION['donate']['bill_lname'];
echo $_SESSION['donate']['bill_name']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T23:20:59.343

或者，如果您想要完整的名称的单独部分：

```
$_SESSION['donate']['bill_name'] = array(
    'bill_fname' => $_SESSION['donate']['bill_fname'],
    'bill_lname' => $_SESSION['donate']['bill_lname'],
    'full_name' => $_SESSION['donate']['bill_fname'] . ' ' . $_SESSION['donate']['bill_lname']
); 
```

# pointers - Fortran 过程指针指向一个不执行任何操作的子例程

> ID：15304959
> 
> 赞同：0
> 
> 时间：2013-03-08T23:17:18.450
> 
> 标签：pointers, fortran, procedure

我有这样的代码

```
:
procedure(),pointer :: p
if ()
  p => job1
else
  p => job2
endif

do i=1,a_big_number
  call x(...)
  call p(i,j,k)
enddo 
```

子程序“job1”做了一些工作，但子程序“job2”什么也不做。换句话说，在某些情况下，我需要完成'x'和'job1'。在其他情况下，我只需要做'x'。我的问题是我应该如何定义job2。似乎简单地使用 null() 是行不通的。我现在正在做的事情是这样的：

```
subroutine job2(i,j,k)
integer,intent(in) :: i,j,k
end subroutine 
```

然而，这看起来很傻，而且我在编译代码时收到了很多编译警告，因为没有使用这些参数。有没有更聪明的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T00:22:50.940

您可以在没有什么有用的情况下使过程指针无效，然后在通过指针调用过程之前测试关联状态。

```
PROCEDURE(interface_that_matches_job1), POINTER :: p
IF (...) THEN
  p => job1
ELSE
  NULLIFY(p)   ! Or p => NULL()
END IF

DO i = 1, a_big_number
  CALL x(...)
  IF (ASSOCIATED(p)) CALL p(i,j,k)
END DO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T07:29:16.283

如果您真的关心循环中的`if`语句，您可以将`if`语句放在循环之外：

```
if (condition) then
  do ii = 1, big_number
    call x(...)
    call p(i,j,k)
  end do
else
  do ii = 1, big_number
    call x(...)
  end do
end if 
```

然后在这个版本上做一些计时，然后在一个带有`if`内部循环的版本上：

```
do ii = 1, big_number
  call x(...)
  if (condition) then
    call p(i,j,k)
  end if
end do 
```

`if`我宁愿猜测您不会看到它们之间有任何显着差异，因为循环中的子例程调用可能已经给您带来了比语句引起的开销大得多的开销。

# collections - 我怎样才能创建一个真正复杂的集合？

> ID：15304960
> 
> 赞同：1
> 
> 时间：2013-03-08T23:17:27.897
> 
> 标签：collections, dictionary

看起来我永远不会遇到问题。现在我想像这样初始化一个字典（正是这个）：

```
Dictionary<string, Dictionary<int, int>> origRes = new Dictionary<string, Dictionary<int, int>> 
```

否则我需要一个集合，它可以包含一个字符串和两个整数值。是否有足够的简单`for`或`foreach`循环来收集所有这些数据（字符串可以是键值）？

**更新**

```
public static Dictionary<int, int> resRequest(string requestedForm)
        {
            Dictionary<int, int> kp = new Dictionary<int, int>();
            Dictionary<string, KeyValuePair<int, int>> origRes = new Dictionary<string, KeyValuePair<int, int>>();
            origRes.Add("Polübiosz", new KeyValuePair<int, int>(560,310));
            origRes.Add("Morze", new KeyValuePair<int, int>(690, 510));
            origRes.Add("Caesar", new KeyValuePair<int, int>(700, 500));
            origRes.Add("OwnCrypt", new KeyValuePair<int, int>(830, 570));
            origRes.Add("Hamming", new KeyValuePair<int, int>(850, 500));
            origRes.Add("Kezdőkép", new KeyValuePair<int, int>(1280, 1024));

            foreach(KeyValuePair<string,KeyValuePair<int, int>> pair in origRes)
            {
                if(pair.Key==requestedForm)
                {
                    kp.Add(pair.Value.Key,pair.Value.Value);
                }
            }
            return kp;
        } 
```

这是我的完整方法我想从 中获取键和值`KeyValuePair`，但是返回的 Dictionary 不包含它或者我不知道，但是在调用方没有键或值属性只有键和值.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T23:22:41.500

为什么不创建一个包含字符串、int、int 的类并用它填充一个更简单的字典呢？

所以而不是

```
Dictionary<string, Dictionary<int, int>> 
```

做：

```
Dictionary<string, MyType> 
```

MyType 类似于：

```
class MyType {
    public string KeyVal { get; set; } // optional - to match your dict key
    public int Int1Val{ get; set; }
    public int Int2Val{ get; set; }
} 
```

# java - 让 Jboss 7 使用您选择的自定义自上而下 WSDL 定义，而无需 CXF 生成 wsdl

> ID：15304969
> 
> 赞同：0
> 
> 时间：2013-03-08T23:18:15.110
> 
> 标签：java, jboss, wsdl, cxf

我们正在将一个自上而下（首先是 wsdl）ws 从 jboss4 移动到 jboss7，并且在使用 CXF 时遇到了一些困难。我注意到位于standalone\data\wsdl\x.ear\x.war\x.wsdl 中的大wsdl 文件不是从提供的xsd 集生成的，它似乎是从类中生成的。例如，我们从 JBoss4 中的定义读取（混淆）

```
<element name="x">
<complexType>
<sequence>
<element minOccurs="0" name="x" type="x"/>
<choice>
<element name="x" type="x"/>
<element name="x" type="x"/>
<element name="x" type="x"/>
<element name="x" type="x"/>
<element name="x" type="x"/>
</choice>
</sequence>
</complexType>
</element> 
```

而CXF生成的那个把coice元素全部替换为minoccurs = 0，完全不适合我们实际使用。

```
<xs:element name="x">
<xs:complexType>
<xs:sequence>
<xs:element minOccurs="0" name="x" type="xs:string"/>
<xs:element minOccurs="0" name="x" type="ns1:x"/>
<xs:element minOccurs="0" name="x" type="ns1:x"/>
<xs:element minOccurs="0" name="x" type="ns1:x"/>
<xs:element minOccurs="0" name="x" type="ns1:x"/>
<xs:element minOccurs="0" name="x" type="ns1:x"/>
</xs:sequence>
</xs:complexType>
</xs:element> 
```

这是因为 wsconsume 构建了我们的 java 类，并且对它们进行了很好的注释，可以被 cxf 解析，但还不足以真正呈现 complexTypes 的初始意图，所以看了很多之后，如何让 Jboss 7 使用 WSDL 定义您的选择，无需 CXF 生成 wsdl？我们不会使用 Spring 来实现这一点，所以……讨论！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T21:31:04.890

因此在@webservice 注释中设置 wsdlLocation 会导致此处描述的错误

[http://mail-archives.apache.org/mod_mbox/cxf-users/200806.mbox/%3C1932ACF3-DCD2-4073-83DD-981FC0F68F53@apache.org%3E](http://mail-archives.apache.org/mod_mbox/cxf-users/200806.mbox/%3C1932ACF3-DCD2-4073-83DD-981FC0F68F53@apache.org%3E)

所以阅读后变得简单多了

那里的方向列出了两个选项：

1) 更新 FooDocumentImpl 类上的 @WebService 注释，使其具有与 wsdl 中的值匹配的 serviceName/portName 属性。

2) 更新配置中的元素以添加服务名称和端口名称的 qnames。

第一个是如果你不使用 Spring，那么在显式地将 @WebService 注释带到：

```
@WebService(endpointInterface = "main.package.InterfaceWS", serviceName = "InterfaceWSService", name = "InterfaceWS", targetNamespace = "http://Interface.namespace.main", wsdlLocation = "WEB-INF/wsdl/InterfaceWS.wsdl" ,portName="InterfaceWSPort") 
```

匹配 InterfaceWS.wsdl 中的服务描述：

```
<service name="InterfaceWSService">
                    <port binding="tns:InterfaceWSSOAPBinding" name="InterfaceWSPort">
                              <soap:address location="http://localhost:8080/publishedLocationOfInterface />
                    </port>
</service> 
```

它就像一个魅力

# php - PHP + MySQL + Cookies，为什么加载不正确？

> ID：15304970
> 
> 赞同：0
> 
> 时间：2013-03-08T23:18:15.870
> 
> 标签：php, mysql, cookies, postback

我有一个 PHP 页面，代码的各个部分包含 2 个 MySQL 语句。我正在使用生成的结果集来设置 cookie 值，然后再调用它。然而，当我调用 cookie 数据时，它不会更新 cookie 值的显示，直到第二次刷新之后。为了更好地理解，这是代码的 3 部分：

```
<?php
include 'functions.php';
if($_SERVER['REQUEST_METHOD'] == 'POST')
{
    $SqlStatement = "SELECT Deceased.PK_Deceased, Deceased.Date_Death, Personal_Info.First_Name, Personal_Info.Last_Name FROM Deceased INNER JOIN Personal_Info ON Personal_Info.PK_Personal_Info = Deceased.FK_Personal_Info WHERE Deceased.FK_Personal_Info = '".$_POST['cboDeceased']."'";

    $result = ExecuteSql($SqlStatement);
    if(mysqli_num_rows($result) == 1)
    {
        $row = mysqli_fetch_array($result);
        setcookie('deceasedID', $row['PK_Deceased'], time()+360000, '/');
        setcookie('deceasedName', ($row['First_Name']." ".$row['Last_Name']), time()+360000, '/');
        setcookie('deceasedDoD', $row['Date_Death'], time()+360000, '/');
    }
}
?> 
```

这是从回发中提取数据的代码。我认为这是不正确的部分，但我不确定。

```
<tr>
<td width="25%" rowspan="2" align="center">Current User: <?php echo $_COOKIE['username']; ?> </td>
<td width="25%" rowspan="2" align="center">Current Deceased: <?php if(isset($_COOKIE['deceasedName']))echo $_COOKIE['deceasedName']; ?></td>
<td width="50%" rowspan="2" align="center">Deceased Date of Death: <?php if(isset($_COOKIE['deceasedDoD']))echo $_COOKIE['deceasedDoD']; ?></td> 
```

这是将 cookie 数据加载到字段中的代码，以及需要第二次刷新才能正确显示的部分。

```
<form action="<?php $_SERVER['PHP_SELF'];?>" method="post">
<table align="center" width="500" border="0.5">
<tr>
<td width="176" align="right" style="font-weight:bold;">Please select deceased:</td>
<td width="214">
  <select name="cboDeceased" id="cboDeceased">
    <option>Select...</option>
    <?php
    $SqlStatement = "SELECT Deceased.PK_Deceased , Personal_Info.First_Name, Personal_Info.Last_Name FROM Deceased INNER JOIN Personal_Info ON Personal_Info.PK_Personal_Info = Deceased.FK_Personal_Info";

    $res = ExecuteSQL($SqlStatement);

    while($row = mysqli_fetch_array($res))
    {
        echo "<option value='".$row['PK_Deceased']."'>".$row['First_Name']." ".$row['Last_Name']."</option>";
    }
?> 
```

这是将基于 ID 的变量传递给第一个代码块的代码。这部分工作正常。

```
function ExecuteSQL($SQL)
{
$con = mysqli_connect("localhost", "root", "", "exec_support_db");
$res = mysqli_query($con, $SQL);
mysqli_close($con);
return $res;
} 
```

这是 ExecuteSQL 函数的代码。我知道这不是问题。

我认为问题出在第一个代码块的上方，但我不确定。我已经尽我所能，现在没有想法。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:25:30.720

除了 DaveRandom 上面提到的 SQL 注入之外，请查看有关 setcookie 工作原理的 php 手册：

[http://php.net/manual/en/function.setcookie.php](http://php.net/manual/en/function.setcookie.php)

它特别提到信息被注入到标题中，因此在您的下一页加载之前不可用。你可能想做类似的事情

```
if(isset($_COOKIE['deceasedID']))
{
    $deceasedID = $_COOKIE['deceasedID'];
}
else
{
    setcookie('deceasedID', $row['PK_Deceased'], time()+360000, '/');
    $deceasedId = $row['PK_Deceased'];
} 
```

# symfony - 使用 FOSCommentBundle 时是否可以使用自定义用户提供程序来签署评论？

> ID：15304973
> 
> 赞同：0
> 
> 时间：2013-03-08T23:18:23.160
> 
> 标签：symfony, symfony-2.1, foscommentbundle

我在 Symfony2.1 应用程序中使用自定义 UserProvider 进行身份验证。我想使用 FOSCommentBundle 来实现评论。但是当涉及到评论作者的评论时，我被卡住了。

基本上，我有两个数据库。我可以从中检索用户的凭据（用户名、盐、密码……）但我不能进行任何修改，另一个我可以用来存储用户信息（如她/他的评论） ) 在用户实体中。

当我将 Comment 实体与此 User 实体映射时，会出现问题，因为 FOSCommentBundle 检索的是实现 UserInterface 的实体（在我的安全包中）而不是此 User 实体。

基本上，有没有办法告诉 FOSCommentBundle 检索另一个用户实体而不是用于身份验证的实体？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-28T09:35:30.050

您是否尝试[过 FOSUserBundle 与 FOSCommentsBundle 的集成](https://github.com/FriendsOfSymfony/FOSCommentBundle/blob/master/Resources/doc/6-integration_with_fosuserbundle.md)？

您需要像这样实现 SignedCommentInterface 。

```
<?php
// src/MyProject/MyBundle/Entity/Comment.php

namespace MyProject\MyBundle\Entity;

use Doctrine\ORM\Mapping as ORM;
use FOS\CommentBundle\Entity\Comment as BaseComment;
use FOS\CommentBundle\Model\SignedCommentInterface;
use Symfony\Component\Security\Core\User\UserInterface;

/**
 * @ORM\Entity
 */
class Comment extends BaseComment implements SignedCommentInterface
{
    // .. fields

    /**
     * Author of the comment
     *
     * @ORM\ManyToOne(targetEntity="MyProject\MyBundle\Entity\User")
     * @var User
     */
    protected $author;

    public function setAuthor(UserInterface $author)
    {
        $this->author = $author;
    }

    public function getAuthor()
    {
        return $this->author;
    }

    public function getAuthorName()
    {
        if (null === $this->getAuthor()) {
            return 'Anonymous';
        }

        return $this->getAuthor()->getUsername();
    }
} 
```

# css - 如何在引导程序中编写只能在桌面上可见的css

> ID：15304974
> 
> 赞同：3
> 
> 时间：2013-03-08T23:18:23.283
> 
> 标签：css, twitter-bootstrap, responsive-design

我重写了一份声明

```
 .navbar .nav {
    top:30px;
} 
```

在我的css文件上，但我只希望这个声明可以在桌面视图上响应，而不是在手机视图中。如何正确书写？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T23:22:43.100

这里：媒体查询的力量：

```
@media only screen and (min-width: 960px) and (max-width: 1079px) {

}

@media only screen and (min-width: 768px) and (max-width: 959px) {

}

@media only screen and (max-width: 767px) {

}

@media only screen and (min-width: 480px) and (max-width: 767px) {

} 
```

# ruby-on-rails - 具有取决于数据库的条件范围的 Rails 模型

> ID：15304979
> 
> 赞同：3
> 
> 时间：2013-03-08T23:19:04.450
> 
> 标签：ruby-on-rails, ruby, oracle, scopes

我正在基于[此 railscast](http://railscasts.com/episodes/189-embedded-association)实现模型的范围。范围内的条件使用二元 AND 运算符`&`，如下所示：

```
scope :with_role, lambda { |role| 
  {:conditions => "roles_mask & #{2**ROLES.index(role.to_s)} > 0"} 
} 
```

由于我当前针对的数据库是 Oracle，它使用`BITAND`函数而不是`&`运算符，因此我将条件重写如下：

```
{:conditions => "BITAND(roles_mask, #{2**ROLES.index(role.to_s)}) > 0"} 
```

我的问题是，我希望我的代码尽可能与数据库无关，因为将来我们计划针对其他数据库。我目前的解决方案是检查我是否使用 Oracle 并相应地定义范围，如下所示（`using_oracle`是我在其他地方计算的布尔值）：

```
if using_oracle 
  scope :with_role, lambda { |role| 
    {:conditions => "BITAND(roles_mask, #{2**ROLES.index(role.to_s)}) > 0"}
  }
else
  scope :with_role, lambda { |role| 
    {:conditions => "roles_mask & #{2**ROLES.index(role.to_s)} > 0"}
  }
end 
```

这行得通，但并没有让我觉得特别优雅或像 ruby​​/rails 一样。任何人都可以提出更好的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T17:57:50.390

我认为应该有更好的方法来扩展 Arel：我努力达到这个结果。

反正; 此解决方案使用[Model#extending](http://api.rubyonrails.org/classes/ActiveRecord/QueryMethods.html#method-i-extending)：

```
module BitOperations
  def bitwise_and_sql
    @bitwise_and_sql ||=
      case connection.adapter_name
      when 'Oracle' # probably wrong!
        "BITAND(%s, %s)"
      else
        "%s & %s"
      end
  end
  def bitwise_and(i, j)
    where(bitwise_and_sql % [i, j])
  end
  def bitmask(i, j)
    where('%s > 0' % scoped.bitwise_and(i, j).wheres.to_a.last.to_sql)
  end
end

p User.scoped.extending(BitOperations).bitwise_and(1, 2).bitmask(3, 4).to_sql
#=> "SELECT \"users\".* FROM \"users\"  WHERE (1 & 2) AND ((3 & 4) > 0)" 
```

`.wheres`包含 Arel 关系；它包括`Enumerable`，因此我们可以检索最后一个将其转换为数组并获取最后一个元素的关系。我使用它是为了获取 sql`bitwise_and(i, j)`以便在`bitmask(i, j)`. 我想知道是否有更好的方法从哪里获取 sql...

`.wheres`提出关于`wheres`弃用的警告，目前可以忽略（它也适用于 Rails 4 beta）。

您可以定义类方法`User`：

```
class User
  def self.scope_with_bit_operations
    @scope_with_bit_operations ||= scoped.extending(BitOperations)    
  end
  def self.bitwise_and(i, j)
    scope_with_bit_operations.bitwise_and(i, j)
  end
  def self.bitmask(i, j)
    scope_with_bit_operations.bitmask(i, j)
  end
end

p User.bitwise_and(1, 2).bitmask(3, 4).to_sql
#=> "SELECT \"users\".* FROM \"users\"  WHERE (1 & 2) AND ((3 & 4) > 0)" 
```

或所有型号：

```
class ActiveRecord::Base
  def self.scope_with_bit_operations
    @scope_with_bit_operations ||= scoped.extending(BitOperations)    
  end
  def self.bitwise_and(i, j)
    scope_with_bit_operations.bitwise_and(i, j)
  end
  def self.bitmask(i, j)
    scope_with_bit_operations.bitmask(i, j)
  end
end

p Post.bitwise_and(1, 2).bitmask(3, 4).to_sql
#=> "SELECT \"posts\".* FROM \"posts\"  WHERE (1 & 2) AND ((3 & 4) > 0)" 
```

最后你可以实现一个更优雅的`with_role`范围：

```
class User < ActiveRecord::Base
  ROLES = %w[admin moderator author]

  scope :with_role, ->(role) do
    # I'm a fan of quoting everything :-P
    bitmask connection.quote_column_name(:roles_mask),
            connection.quote(2**ROLES.index(role.to_s))
  end
end

p User.with_role('admin').to_sql
#=> "SELECT \"users\".* FROM \"users\"  WHERE ((\"roles_mask\" & 1) > 0)" 
```

* * *

我必须说，IMO 这更像是一个概念验证：如果您不打算重用`bitwise_and`并且`bitmask`在其他模型中您不需要抽象它们，那么您可能最好使用类似于您的`scope`,像这样的东西：

```
class User < ActiveRecord::Base
  ROLES = %w[admin moderator author]

  BITMASK_SQL =
    case connection.adapter_name
    when 'Oracle' # probably wrong!
      "BITAND(%s, %s) > 0"
    else
      "%s & %s > 0"
    end

  scope :with_role, ->(role) do
    where BITMASK_SQL % [ connection.quote_column_name(:roles_mask), 
                          connection.quote(2**ROLES.index(role.to_s)) ]
  end
end

p User.with_role('admin').to_sql
#=> "SELECT \"users\".* FROM \"users\"  WHERE (\"roles_mask\" & 1 > 0)" 
```

我认为规则是*在需要时添加抽象，在不需要时不要添加*（我不知道这句话的英文是否正确:-)）

我想说另一件事：由于您是 Ruby/Rails 新手，我建议您阅读大量 Rails & c。代码; IMO 这是了解 Rails 如何工作的最佳方式（这就是我花时间回答您的问题的原因：因为我对 Rails 对 Arel 关系的管理感到好奇 :-)）。

# visual-studio - 在 Visual Studio 2012 中构建之前保存所有文件？

> ID：15304989
> 
> 赞同：18
> 
> 时间：2013-03-08T23:19:50.663
> 
> 标签：visual-studio, visual-studio-2012, ide

在 Visual Studio 2010 中，工具 --> 选项 --> 项目和解决方案 --> 构建并运行 --> 构建之前（保存所有更改）下有一个设置。在 VS 2012 中，这个设置似乎消失了，我的解决方案在构建之前没有保存。请注意，我正在构建的项目是带有用于编译器的 Clang/LLVM 的 MakeFile 项目，如果这是相关信息的话。

有没有我想念的地方？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-26T17:21:59.030

根据 Vicky Song（微软）提供的答案，该功能不再可用。如果您想提交功能请求，他们会考虑的。

参考： [http ://social.msdn.microsoft.com/forums/vstudio/en-US/be441ff6-682f-4534-b653-99632a7975a4/before-building-settings](http://social.msdn.microsoft.com/forums/vstudio/en-US/be441ff6-682f-4534-b653-99632a7975a4/before-building-settings)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-28T16:46:56.917

此功能非常有用，主要是考虑到许多用户让 Visual Studio 随机崩溃（我自己也是如此）。因此，当我想运行编译-构建-测试时，我想保存所有打开的内容（包括在那些讨厌的事件中丢失的环境）......

# c++ - strncpy 到已经创建的 char []

> ID：15304993
> 
> 赞同：0
> 
> 时间：2013-03-08T23:20:25.113
> 
> 标签：c++, class, char, strncpy

有课

```
class Cow{
    char name[20];
    char* hobby;
    double weight;
public:
    [..]
    Cow & operator=(const Cow &c);
    [..]
}; 
```

我想知道如何编写`operator=`方法的定义。我写的定义等于 -

```
Cow & Cow::operator=(const Cow &c){
    if(this==&c)
        return *this;
    delete [] hobby;
    hobby=new char [strlen(c.hobby)+1];
    weight=c.weight;
    strncpy(name,c.name,20);
    return *this;
} 
```

但是，如果已经创建了名称[20]，例如“Philip Maciejowsky”并且我对它“Adam”进行了 strncpy，该怎么办。在 operator=(...) 之后将名称等于“adamlip Maciejowsky”吗？如果它像那样覆盖如何修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:23:27.287

在使用 . 之后使用`strcpy()`或添加空终止符`strncpy()`。`strncpy()`不添加空终止符 ( `\0`)，其中一样`strcpy()`。

我的建议：使用`std::string`而不是以`c-styled`空字符结尾的字符串。

> 在罗马时，做罗马人！

* * *

来自[http://cplusplus.com](http://cplusplus.com)

> 如果 source 长于 >num，则不会在目标末尾隐式附加空字符（因此，在这种情况下，目标可能不是以空字符结尾的 C 字符串）。

由于`Adam`长度小于`Philip Maciejowsky`-`strncpy()`将不会用 . 填充剩余的目的地（即`Philip Maciejowsky`）`\0`。因此输出看起来像：

`Adamip Maciejowsky`-`strcpy()`或者做`memset(destination, 0, lengthOfDestination)`然后调用`strncpy()`也会导致你的输出`Adam`。多种方式来做你想做的事。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T23:24:04.667

首先，如果您使用的是 C++，则不应使用 C 风格的字符串，而应使用 std::string 类，这在各方面都使一切变得更容易。

假设您需要使用 char* 字符串，strncpy 会处理这个问题。C 风格的字符串以空值结尾，这意味着诸如此类的字符串`"test"`占用五个字节。字节按顺序是`{'t', 'e', 's', t', 0}`. 零（或空）字节用作已到达字符串末尾的标记。

从我系统上 strncpy 的联机帮助页：

以下将 chararray 设置为`abc\0\0\0`：

```
 char chararray[6];

       (void)strncpy(chararray, "abc", sizeof(chararray)); 
```

所以这意味着字符串将包含代表空字节的`"adam\0\0\0\0\0\0\0[etc.]"`位置。`\0`字符串函数在读取第一个 null 时将停止处理（因为，请记住，对于 C 风格的字符串，如果不扫描字符串，就无法知道字符串的长度`\0`）。

# android - 获取内容列表到 FragmentAdapter (viewpager)

> ID：15304994
> 
> 赞同：1
> 
> 时间：2013-03-08T23:20:26.170
> 
> 标签：android, android-fragments, android-viewpager

我的数据库中有问题列表。问题一一出现在我的页面上，带有上一个/下一个按钮。我想添加 viewpager 以在问题之间滑动。但是将内容发送到 FragmentAdapter 让我很困惑。

片段适配器：

```
class TestFragmentAdapter extends FragmentPagerAdapter {
    protected static final String[] CONTENT = new String[] { "1", "2", "3", };

    public TestFragmentAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int position) {
        return TestFragment.newInstance(CONTENT[position]);
    }

    @Override
    public int getCount() {
        return CONTENT.length;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T11:33:59.663

当您从数据库中获取内容时，您不需要使用字符串内容；

您需要使用片段。使用 textview 创建片段，然后为每个下一个位置填充它。然后更新您的内容`position`

```
public class TestFragment extends Fragment {  

public static TestFragment newInstance(int index ) {

         TestFragment TestFragment = new TestFragment();
         Bundle bundle = new Bundle();         
         bundle.putInt("index", index);
         TestFragment.setArguments(bundle);
         return TestFragment;
     }

 @Override  
     public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {              
         View view = inflater.inflate(R.layout.yourlayout, container, false);  
          text = (TextView) view.findViewById(R.id.yourtext);  
text.setText("your position: " + getArguments().getInt("index")) // where you get index from your newinstance
}
} 
```

# java - 使用 Java 桌面应用程序管理数据库

> ID：15304999
> 
> 赞同：0
> 
> 时间：2013-03-08T23:20:41.230
> 
> 标签：java, mysql

很抱歉这里的解释很长，但这里是：

作为一个个人项目，我玩弄了一个用于游戏服务器主机的服务器管理工​​具。所有服务器主机都使用 MySQL 服务器，它们都是独立的服务器。

那么：是否有 java IDE 或 java 库可用于创建可以与 MySQL 数据库通信的 java 桌面应用程序？

更具体地说：我需要让客户端使用登录表单来指定 IP 地址、端口、用户名和密码。当他们点击连接时，java应用程序将登录信息发送到指定的服务器，进行身份验证并连接。然后用户只需单击表单上的按钮即可执行 T-SQL。

我正在寻找类似于我最近在 C# 中使用 .NET 的 MySQL 连接器实现的东西。但是我在这样的地方找不到任何东西，这是不可能的还是我是个白痴？哈哈。干杯，伙计们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:44:35.093

To achieve login functionality providing you are going to use swing, use [JXloginPane](http://javadoc.geotoolkit.org/external/swingx/org/jdesktop/swingx/JXLoginPane.html) it contains all what you described out of the box. Regarding db, you can use [JdbcTemplate](http://static.springsource.org/spring/docs/2.5.x/api/org/springframework/jdbc/core/JdbcTemplate.html)