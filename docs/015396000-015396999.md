# StackOverflow 问答 15396000-15396999

# clojure - 在 seq 中的每个项目之间打印逗号

> ID：15396001
> 
> 赞同：2
> 
> 时间：2013-03-13T20:39:43.670
> 
> 标签：clojure

我正在寻找一种惯用的方式来打印以逗号分隔的序列的每个项目，而不打印尾随逗号。我想避免使用`clojure.string/join`，因为我不想创建中间字符串（这就是我之前所做的，而且代码更难遵循）。我宁愿只打印元素。

这就是我现在所拥有的：

```
(doseq [element a-map]
  (printf "%s = %s" (key element) (val element))
  (print ", ")) 
```

我可以想到几种方法来做到这一点：

1.  打印 . 之外的第一项`doseq`，然后打印每个带有前置逗号的项。

    ```
    (printf "%s = %s" (key (first a-map)) (val (first a-map)))
    (doseq [element (rest a-map)]
      (print ", ")
      (printf "%s = %s" (key element) (val element))) 
    ```

2.  打印除最后一项外的所有项目，后跟逗号，然后打印`doseq`. 该代码将类似于第一个选项，但对于不可随机访问的 seq 效率低下。

3.  使用`interpose`并检查是否`element`为字符串。

    ```
    (doseq [element (interpose ", " a-map)]
      (if (str? element)
        (print element)
        (printf "%s = %s" (key element) (val element)))) 
    ```

由于重复，我不喜欢 1 或 2。由于 if 条件，我不喜欢 3。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:40:04.173

好的，这是一个新的尝试：

```
(defn str-commas [a-map]
  (doseq [[[k v] sep] (partition-all 2 (interpose ", " a-map))]
    (printf "%s = %s%s" k v (or sep "")))) 
```

`partition`返回大小为 N 的列表，但由于插入逗号不会创建偶数个元素，因此删除了最后一个键值对。`partition-all`可能包含元素较少的分区（最后一个元素仅包含键值对）。

诀窍是使用，`(or sep "")`因为我们知道最后一个元素将缺少分隔符，因此它将为空。

# android - WebView 打开手机浏览器

> ID：15396004
> 
> 赞同：0
> 
> 时间：2013-03-13T20:39:58.793
> 
> 标签：android, android-webview

地狱有一个非常简单的应用程序，

```
import android.app.Activity;
import android.os.Bundle;
import android.webkit.WebView;

public class main extends Activity {

    WebView mWebView;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mWebView = (WebView) findViewById(R.id.webView1);
        mWebView.getSettings().setJavaScriptEnabled(false);
        mWebView.loadUrl("http://www.purelymean.com/app_pics");
    }
} 
```

但是由于某种原因，当我运行它时，它会打开应用程序，然后也会打开手机的网络浏览器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T20:51:49.150

您应该将 WebViewClient 添加到您的 WebView。默认打开浏览器，这就是您所遇到的。

# android - 微调器默认实现什么布局？

> ID：15396005
> 
> 赞同：3
> 
> 时间：2013-03-13T20:40:04.630
> 
> 标签：android, android-layout

我有一个带有多个微调器的布局。有些有适配器，而另一些则从字符串数组中获取内容。带有适配器的那些实现了 simple_list_item_1 布局，但这会导致与其他微调器不同的外观，并导致页面上的格式问题。如何找到，或者有人知道微调器默认使用什么布局？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:10:31.207

微调器的布局取决于传递给它的适配器的布局。

看起来 simple_list_item_1 是一个带有填充的简单 TextView：

这是源 xml 布局：[https ://github.com/android/platform_frameworks_base/blob/master/core/res/res/layout/simple_list_item_1.xml](https://github.com/android/platform_frameworks_base/blob/master/core/res/res/layout/simple_list_item_1.xml)

# javascript - D3 JS 布局树连接到 CrossFilter

> ID：15396006
> 
> 赞同：3
> 
> 时间：2013-03-13T20:40:07.853
> 
> 标签：javascript, d3.js, nvd3.js, crossfilter, dc.js

如何将 D3.JS[树布局](https://github.com/mbostock/d3/wiki/Tree-Layout)与[CrossFilter](http://square.github.com/crossfilter/)连接起来？

假设我有[这个示例树](http://mbostock.github.com/d3/talk/20111018/tree.html)。然后我提取一个树节点列表，作为 CrossFilter 的输入数据集。

```
// Compute the new tree layout.
var nodes = tree.nodes(root);
var data = crossfilter(nodes);
var bySize = data.dimension(function(d) { return d.size; }); 
```

然后我想根据大小进行过滤，并根据此过滤动态更新树。关于我应该如何更新树数据源的任何想法？

我是否需要编写函数以返回原始输入树数据结构，例如：

`treeJson = graph2tree(filteredNodes, filteredEdges)`

还是有更好的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-19T23:01:15.523

由于它是一棵树，因此您可以使用每个元素的整个路径作为维度键。那么任何分支都是维度的连续范围。

例如，这会自动分类为分支： A.1 A.2 A.3 B.1

然后将另一个维度键入大小，并使用 treeDim.top(Infinity) 或 .group() 获取您的项目。它们不是树形结构，但至少它们是有序的，您可以使用 d3.nest 将它们制作成一棵树。

...如果你还想过滤分支，你已经设置好了，只需将范围设置为 [A,B)

# javascript - 通过本地存储更改用户偏好样式表

> ID：15396021
> 
> 赞同：0
> 
> 时间：2013-03-13T20:40:45.113
> 
> 标签：javascript, css, html

**我的设置页面的负责人**

```
<script type="text/javascript">
  function changeStyle(title) {
    var lnks = document.getElementsByTagName('link');
    localstorage.css="lnks";
    for (var i = lnks.length - 1; i >= 0; i--) {
      if (lnks[i].getAttribute('rel').indexOf('style') > -1 
          && lnks[i].getAttribute('title')) {
        lnks[i].disabled = true;
        if (lnks[i].getAttribute('title') == title) lnks[i].disabled = false;
      } /* if */
    } /* for */
  } /* function */ 
</script> 
```

**在同一页面上传递给函数的参数**

```
<button onclick="changeStyle('girly')">Girly</button>
<button onclick="changeStyle('default')">Default</button>
<button onclick="changeStyle('neutral')">Neutral</button> 
```

在我的索引页面上，我试图调用通过本地存储选择的样式表，但我无法使其工作，有人能指出原因吗？

**索引页面代码（放在头部）**

```
<script>
  {
  document.onload = localstorage.getitem('css');
  }
</script> 
```

# asp.net-mvc - MVC3 razor 的网格 - 从过程中分页

> ID：15396022
> 
> 赞同：1
> 
> 时间：2013-03-13T20:40:50.823
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor

网格工作正常。不幸的是，如果我单击第 2 页，我不知道如何将此信息发送到控制器（JSON？ - 并使用过程中的数据重建网格）？因为我想使用程序准备分页。

```
@{
    var grid = new WebGrid(canPage: true, rowsPerPage: 10, canSort: true, ajaxUpdateContainerId: "grid");
    grid.Bind(Model.DodajTematProceduraZwyklyUzytkownik, rowCount: Convert.ToInt32(Model.DodajTematProceduraZwyklyUzytkownik[0].zmienna), autoSortAndPage: false);
    grid.Pager(WebGridPagerModes.All);
    @grid.GetHtml(htmlAttributes: new { id="grid" },
        columns: grid.Columns(
            grid.Column("Temat")
        ));
} 
```

我得到：

![在此处输入图像描述](../Images/95fce05e8c0dd39e84b057d86f8f9018.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-16T23:26:25.753

我将使用 JTable.org 项目来解决这个问题。

# android - 在父级之间均匀分布android垂直SeekBars

> ID：15396023
> 
> 赞同：0
> 
> 时间：2013-03-13T20:40:55.173
> 
> 标签：android, seekbar

我用下面的代码创建了一个“标准”垂直 SeekBar（在 SO 上多次发布）。

```
package com.plainfieldworks.nofiseq;

import android.content.Context;
import android.graphics.Canvas;
import android.util.AttributeSet;
import android.view.MotionEvent;
import android.widget.SeekBar;

public class VerticalSeekBar extends SeekBar{

    public VerticalSeekBar(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        // TODO Auto-generated constructor stub
    }

    public VerticalSeekBar(Context context, AttributeSet attrs) {
        super(context, attrs);
        // TODO Auto-generated constructor stub
    }   

    public VerticalSeekBar(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
    }

    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(h, w, oldh, oldw);
    }

    @Override
    protected synchronized void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(heightMeasureSpec, widthMeasureSpec);
        setMeasuredDimension(getMeasuredHeight(), getMeasuredWidth());
    }

    protected void onDraw(Canvas c) {
        c.rotate(-90);
        c.translate(-getHeight(), 0);

        super.onDraw(c);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        if (!isEnabled()) {
            return false;
        }

        switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN:
            case MotionEvent.ACTION_MOVE:
            case MotionEvent.ACTION_UP:
                setProgress(getMax() - (int) (getMax() * event.getY() / getHeight()));
                onSizeChanged(getWidth(), getHeight(), 0, 0);
                break;

            case MotionEvent.ACTION_CANCEL:
                break;
        }
        return true;
    }   

} 
```

现在我想在我看来使用其中的 6 个。如果我只是使用 RelativeLayout 将它们彼此相邻放置，一切都很好（不能发布图像，缺乏声誉......）。

但是我希望它们水平地均匀分布在视图中，如果我在布局 XML 中将它们添加为 LinearLayout 的子级并为每个设置权重为 1，progressDrawable（我认为它是 - “条形图”）将填充整个视图宽度只有一点填充，拇指将放在左侧。

现在我明白为什么会发生这种情况，但我不知道如何解决它。即我怎样才能保持默认比例并仍然在视图中均匀分布 SeekBars，以每个视图中的 progressDrawable 和 thumb 为中心？

一般来说，我是 android 和 Java 开发的新手，所以请耐心等待。我希望我设法解释了这个问题。

给我胖乎乎的 SeekBars 的 XML 布局如下：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:background="@color/cream"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal"
    tools:context=".EditInst"
    android:padding="2dp">

    <LinearLayout android:id="@+id/header"
        android:background="#ffffbc40"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:padding="2dp">

        <TextView android:id="@+id/instTxt"
            android:textIsSelectable="false"
            android:textColor="#ff000000"
            android:textSize="18sp"
            android:textStyle="bold"
            android:layout_height="wrap_content"
            android:layout_width="fill_parent"/>         

    </LinearLayout>
    <LinearLayout android:id="@+id/SeekBars"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_below="@+id/header">  

        <com.plainfieldworks.nofiseq.VerticalSeekBar android:id="@+id/f0SeekBar" android:padding="10dp" android:layout_width="0dp" android:layout_weight="1" android:layout_height="fill_parent"/>
        <com.plainfieldworks.nofiseq.VerticalSeekBar android:id="@+id/f1SeekBar" android:padding="10dp" android:layout_width="0dp" android:layout_weight="1" android:layout_height="fill_parent"/>
        <com.plainfieldworks.nofiseq.VerticalSeekBar android:id="@+id/f2SeekBar" android:padding="10dp" android:layout_width="0dp" android:layout_weight="1" android:layout_height="fill_parent"/>
        <com.plainfieldworks.nofiseq.VerticalSeekBar android:id="@+id/cSeekBar" android:padding="10dp" android:layout_width="0dp" android:layout_weight="1" android:layout_height="fill_parent"/>
        <com.plainfieldworks.nofiseq.VerticalSeekBar android:id="@+id/sSeekBar" android:padding="10dp" android:layout_width="0dp" android:layout_weight="1" android:layout_height="fill_parent"/>
        <com.plainfieldworks.nofiseq.VerticalSeekBar android:id="@+id/dSeekBar" android:padding="10dp" android:layout_width="0dp" android:layout_weight="1" android:layout_height="fill_parent"/>

    </LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T20:59:05.637

最直接的方法可能是在两者之间简单地添加另一层。您可以`FrameLayout`在当前 SeekBar 所在的位置使用类似 a 的东西，这样您就有了“chubby `FrameLayout`s”，然后在每个这些`FrameLayout`s 中放置一个 SeekBar。

# objective-c - RestKit 模型对象引发 -valueForUndefinedKey: 用于合成属性

> ID：15396024
> 
> 赞同：3
> 
> 时间：2013-03-13T20:40:55.877
> 
> 标签：objective-c, cocoa-touch, cocoa, restkit

我正在尝试映射到一个对象但不断得到

`[<ItemObject 0x100353710> valueForUndefinedKey:]: this class is not key value coding-compliant for the key uid.`

**项目对象.h**

```
@interface ItemObject : NSObject

@property (nonatomic, retain) NSNumber * uid;
@property (nonatomic, retain) NSString * title;
@property (nonatomic, retain) NSString * itemType;

@end 
```

**项目对象.m**

```
@implementation ItemObject

@dynamic uid;
@dynamic title;
@dynamic itemType;

@end 
```

**方法**

```
+ (void)searchFeatureById:(NSString *)searchId
{
    NSLog(@"Search Feature By ID: %@", searchId);
    RKObjectMapping *itemMapping = [RKObjectMapping mappingForClass:[ItemObject class]];

    [itemMapping addAttributeMappingsFromDictionary:@{
     @"id": @"uid",
        @"name": @"title",
        @"item_type": @"itemType"
     }];

    RKResponseDescriptor *responseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:itemMapping pathPattern:nil keyPath:@"data" statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

    RKObjectMapping *errorMapping = [RKObjectMapping mappingForClass:[RKErrorMessage class]];
    // The entire value at the source key path containing the errors maps to the message
    [errorMapping addPropertyMapping:[RKAttributeMapping attributeMappingFromKeyPath:nil toKeyPath:@"errorMessage"]];
    NSIndexSet *statusCodes = RKStatusCodeIndexSetForClass(RKStatusCodeClassClientError);
    // Any response in the 4xx status code range with an "errors" key path uses this mapping
    RKResponseDescriptor *errorDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:errorMapping pathPattern:nil keyPath:@"error_description" statusCodes:statusCodes];
    RKObjectManager *manager = [RKObjectManager sharedManager];
    NSLog(@"HTTP Client: %@", manager.HTTPClient);

    [manager addResponseDescriptorsFromArray:@[ responseDescriptor, errorDescriptor ]];
//    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                            @"false", @"with_lock"
                            , nil];
    NSString *path = [NSString stringWithFormat:@"/api/v1/features/%@", searchId];
    NSLog(@"Manager: %@", manager);
    [manager getObjectsAtPath:path parameters:params success:^(RKObjectRequestOperation *operation, RKMappingResult *result) {
        NSLog(@"Results: %@", result);
        // Handled with articleDescriptor
    } failure:^(RKObjectRequestOperation *operation, NSError *error) {
        // Transport error or server error handled by errorDescriptor
        NSLog(@"Error: %@", [error localizedDescription]);
        NSAlert *alert = [NSAlert alertWithMessageText:@"Error" defaultButton:@"OK" alternateButton:nil otherButton:nil informativeTextWithFormat:@"%@", [error localizedDescription]];
        [alert runModal];

    }];
} 
```

**JSON响应**

```
{
    "data": {
        "id": 1961,
        "item_type": "features",
        "assigned_to": {
        "id": 106
    },
    "parent": {
        "id": 0
    },
        "priority": {
        "id": 3
    },
        "project": {
        "id": 62
    },
        "release": {
        "id": 180
    },
        "reported_by": {
        "id": 106
    },
        "reported_by_customer_contact": {
        "id": 0
    },
        "status": {
        "id": 6
    },
        "workflow_step": {
        "id": 10
    },
        "actual_duration": {
        "duration": 0,
        "time_unit": {
            "id": 2
        }
    },
        "estimated_duration": {
        "duration": 8,
        "time_unit": {
            "id": 2
        }
    },
        "remaining_duration": {
        "duration": 0,
        "time_unit": {
            "id": 2
        }
    },
        "percent_complete": 0,
        "archived": false,
        "publicly_viewable": false,
        "completion_date": "1899-01-01T07:00:00Z",
        "due_date": "1899-01-01T07:00:00Z",
        "start_date": "2013-03-11T07:00:00Z",
        "description": "Create Login GUI",
        "name": "Login View",
        "notes": "",
        "number": "1961",
        "build_number": "",
        "custom_fields": {
            "custom_157": true,
            "custom_180": "",
            "custom_174": "",
            "custom_181": false,
            "custom_179": "",
            "custom_182": "",
            "custom_186": false,
            "custom_156": 0,
            "custom_161": "",
            "custom_163": "",
            "custom_164": "",
            "custom_165": "",
            "custom_167": "",
            "custom_185": []
        }
    }
} 
```

**碰撞**

```
(
    0   CoreFoundation                      0x00007fff8d39bf56 __exceptionPreprocess + 198
    1   libobjc.A.dylib                     0x00007fff8a7b2d5e objc_exception_throw + 43
    2   CoreFoundation                      0x00007fff8d4261b9 -[NSException raise] + 9
    3   Foundation                          0x00007fff9716c703 -[NSObject(NSKeyValueCoding) valueForUndefinedKey:] + 240
    4   Foundation                          0x00007fff970a338e _NSGetUsingKeyValueGetter + 108
    5   Foundation                          0x00007fff970a3315 -[NSObject(NSKeyValueCoding) valueForKey:] + 392
    6   Foundation                          0x00007fff970c2da2 -[NSObject(NSKeyValueCoding) valueForKeyPath:] + 348
    7   RestKit                             0x0000000100079675 -[RKMappingOperation shouldSetValue:atKeyPath:] + 85
    8   RestKit                             0x000000010007ad9f -[RKMappingOperation applyAttributeMapping:withValue:] + 2079
    9   RestKit                             0x000000010007c028 -[RKMappingOperation applyAttributeMappings:] + 1752
    10  RestKit                             0x00000001000832e0 -[RKMappingOperation main] + 3200
    11  Foundation                          0x00007fff970c56b4 -[__NSOperationInternal start] + 705
    12  RestKit                             0x000000010006c84e -[RKMapperOperation mapRepresentation:toObject:atKeyPath:usingMapping:metadata:] + 1870
    13  RestKit                             0x000000010006afbb -[RKMapperOperation mapRepresentation:atKeyPath:usingMapping:] + 1883
    14  RestKit                             0x000000010006da20 -[RKMapperOperation mapRepresentationOrRepresentations:atKeyPath:usingMapping:] + 832
    15  RestKit                             0x000000010006e26e -[RKMapperOperation mapSourceRepresentationWithMappingsDictionary:] + 1966
    16  RestKit                             0x000000010006ebbf -[RKMapperOperation main] + 1375
    17  Foundation                          0x00007fff970c56b4 -[__NSOperationInternal start] + 705
    18  RestKit                             0x00000001000e8f1c -[RKObjectResponseMapperOperation performMappingWithObject:error:] + 1116
    19  RestKit                             0x00000001000e7347 -[RKResponseMapperOperation main] + 2055
    20  Foundation                          0x00007fff970c56b4 -[__NSOperationInternal start] + 705
    21  Foundation                          0x00007fff970d8912 ____NSOQSchedule_block_invoke_2 + 124
    22  libdispatch.dylib                   0x00007fff8abe1a82 _dispatch_call_block_and_release + 18
    23  libdispatch.dylib                   0x00007fff8abe2961 _dispatch_worker_thread2 + 255
    24  libsystem_c.dylib                   0x00007fff9054c3da _pthread_wqthread + 316
    25  libsystem_c.dylib                   0x00007fff9054db85 start_wqthread + 13 
```

使用 RestKit 0.20.0-rc1 进行 Mac OS X 开发

我究竟做错了什么？如果我添加/删除对象属性，它会为新参数引发相同的键/值错误。这让我相信这不是我的对象的东西，而是关键路径？

**更新**

它跳转到`RKMappingOperation.m`文件第 356 行。

```
- (BOOL)shouldSetValue:(id *)value atKeyPath:(NSString *)keyPath
{
    id currentValue = [self.destinationObject valueForKeyPath:keyPath]; //<-- this line here
    if (currentValue == [NSNull null]) {
        currentValue = nil;
    } 
```

**每个@noa 更新 2**

```
2013-03-14 10:11:51.012 Project[55798:6a03] Destination Class: ItemObject
2013-03-14 10:11:51.012 Project[55798:6a03] Destination Class Super: NSObject 
```

添加

```
[self.destinationObject objectForKey:@"uid"]; 
```

日志

```
2013-03-14 10:16:08.030 Project[55836:2203] -[ItemObject objectForKey:]: unrecognized selector sent to instance 0x103437e80 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T17:29:18.257

`@dynamic`您在实现中使用的指令告诉编译器*不要*为该属性生成方法。由于这些方法不存在，因此您的类与这些键的键值不兼容。（即 RestKit 正在尝试调用该`uid`方法，但它不存在。）

您应该：

*   删除 @dynamic 声明（以便编译器合成所需的方法）或
*   添加您自己的实现`uid`和`setUid:`

# iphone - 加载视图时加载 imageView

> ID：15396025
> 
> 赞同：-3
> 
> 时间：2013-03-13T20:40:59.240
> 
> 标签：iphone, ios, objective-c, cocoa-touch, sdk

我有一个子类，`UIView`我想将图像加载到`imageView`视图时将图像加载到该子视图上。

和上面的`viewDidLoad`方法一模一样`viewController`。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:47:16.870

调用方法`- (id)initWithFrame:(CGRect)aRect`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:04:53.053

这应该可以满足您的需求。如果您通过故事板实例化您的子视图，您应该将此代码放在`initWithCoder:`方法中。`UIImageView`只要您初始化子视图，它就会创建一个并将其添加到视图中。

```
- (id)initWithFrame:(CGRect)rect {
    if (self = [super initWithFrame:rect]) {
        UIImage *image = [UIImage imageNamed:@"anImage"];
        UIImageView *imageView = [[UIImageView alloc] initWithImage:image];
        [self addSubview:imageView];
    }
    return self;
} 
```

# ruby-on-rails - ruby - 将 take_while 与地图迭代器一起使用

> ID：15396029
> 
> 赞同：0
> 
> 时间：2013-03-13T20:41:06.780
> 
> 标签：ruby-on-rails, ruby

我在一些看似基本的事情上遇到了麻烦。基本上我想做这样的事情：

```
result = reports.map do |rep|
  rep.calculate_distance
  break if rep.msg_code == 5
end 
```

但不是返回这样的东西：

```
 => [#<BigDecimal:7fc7036c63b8,'0.3962736920 816792E7',18(45)>, #<BigDecimal:7fc7066061c8,'0.1603401548 194003E4',27(45)>, #<BigDecimal:7fc70601fb60,'0.1707572852 613187E3',27(45)>, #<BigDecimal:7fc706176220,'0.4645528504 455211E3',27(45)>, #<BigDecimal:7fc70667e448,'0.1058402703 80584E4',27(45)>] 
```

它返回这个：

```
 => [nil, nil, nil, nil, nil] 
```

那么我试试这个：

```
reports.take_while {|rep| rep.msg_code == 5 }.map(&:calculate_distance) 
```

但它给了我这个：

```
 => [] 
```

而且我知道事实上没有一个味精代码等于 5，所以它应该返回数组中的大小数，但事实并非如此。

那么如何让 take_while 使用 map 以获得所需的结果呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T20:46:00.637

> I want to continue doing it until the msg_code method of the rails object is equal to 5

```
reports.take_while{ |rep| rep.msg_code != 5 }.map(&:calculate_distance) 
```

Basically `!= 5` instead of `== 5` in your `take_while` predicate.

# php - Ajax 发送 Post 和发送 Canvas

> ID：15396030
> 
> 赞同：0
> 
> 时间：2013-03-13T20:41:14.963
> 
> 标签：php, javascript, jquery, ajax

JavaScript：

```
var username = 'sami';
var myImage = canvas.toDataURL("image/png");
var ajax = new XMLHttpRequest();
ajax.open("POST", "Pic.php", false);
ajax.setRequestHeader('Content-Type', 'application/upload');
ajax.send(myImage);
ajax.send("q=" + encodeURIComponent(username)); 
```

PHP：

```
<? php
if (isset($GLOBALS["HTTP_RAW_POST_DATA"])) {
    $user = $_POST['q'];
    $comp = $user.".png";
    $imageData = $GLOBALS['HTTP_RAW_POST_DATA'];
    $filteredData = substr($imageData, strpos($imageData, ",") + 1);
    $unencodedData = base64_decode($filteredData);
    $fp = fopen($comp, 'wb');
    fwrite($fp, $unencodedData);
    fclose($fp);
} ?> 
```

这是代码，问题是我无法让用户发布，当图像仅保存其“.png”时......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:17:13.880

就像 apelsinapa 所说，您必须将它们打包在一起：

```
ajax.send("img=" + myImage + "&user=" + user); 
```

当然，这意味着您使“应用程序/上传”无效，因为现在您又回到了表单编码。

同样，就像之前提到的那样，如果您允许使用查询字符串 ( `$_GET`) 参数来表示用户或首选文件名，或者其他任何内容，您可以保持应用程序上传，并且还可以拥有文件名。

```
ajax.open("POST", "Pic.php?user=" + user + "&fname=" + filename, true);
// leave headers as you have set them
// event-handlers here
ajax.send(myImage); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T20:54:43.213

仅发送一次请求，并将两个变量打包在同一个发送中。用不同的变量发送两次是没有意义的......

您还应该检查变量是否存在，服务器端，isset($_POST['q'])。

另一种解决方案可能是将用户作为 GET 变量添加到 url，例如："Pic.php?q="+username 并为用户名处理 GET 变量

# angularjs - 从列表视图转到详细视图

> ID：15396034
> 
> 赞同：0
> 
> 时间：2013-03-13T20:41:23.660
> 
> 标签：angularjs

我正在使用 AngularJS 制作一个简单的聊天应用程序。

我制作了两个部分视图，一个是聊天室列表，另一个是详细视图，现在应该只显示聊天室的 ID 和名称。

列表中的每个房间都有这个链接：`<a href="#/rooms/{{room.id}}">{{room.name}}</a>`当我点击链接时，我`index.html#/rooms/0`可以在房间详细信息视图中看到硬编码的文本。

我只是不知道如何获取链接指向的 id = 0 房间的信息。

这是我的 RoomDetailController：

```
app.controller("RoomController", ["$scope", "$routeParams", 
    function($scope, $routeParams) {
        var roomId = $routeParams.roomId;
}]); 
```

这是我的 room-detail.html 部分视图：

```
<h2>{{room.name}}</h2>

<p>You are in chat room <b>{{room.name}}</b> with the id: <b>{{room.id}}</b>. Have fun!</p> 
```

房间名称和 ID 不会显示在详细信息视图中。我应该如何处理 roomId 变量以显示信息？

# css - 在移动设备上测试我的网络基础应用程序时，CSS 固定顶部栏不断下降

> ID：15396036
> 
> 赞同：0
> 
> 时间：2013-03-13T20:41:35.347
> 
> 标签：css, mobile, position

我正在为我的学校开发一个网络基础应用程序，并使用媒体查询来定位不同的屏幕尺寸。手持和桌子的版本看起来很棒。但是，在使用移动设备时，每次我单击应用程序中的按钮时，顶部栏都会立即下降。

位置：固定“工作”，如果我在移动设备上向下滚动，顶部栏保持可见。问题在于当我按下应用程序中的按钮时，此栏会随机下降（屏幕中心）。这个问题在 iO6 和 android4 上仍然存在。

这是按下登录按钮后栏立即下降时应用程序的屏幕截图： ![在此处输入图像描述](../Images/40447b886571dbf4b5eb329d1e619617.png)

这是我为酒吧准备的 CSS：

桌面 CSS：

```
#user_session_box{
    color: #444444;
    font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
    font-size: 10pt;
    min-height: 33px;
    text-align: right;
    margin: 0 -15px 0 -5px;
    box-shadow: 1px 3px 19px rgba(0, 0, 0, 0.2) inset;
    -moz-box-shadow: 1px 3px 19px rgba(0, 0, 0, 0.2) inset;
    -webkit-box-shadow: 1px 3px 19px rgba(0, 0, 0, 0.2) inset;
    } 
```

手持/平板电脑CSS：

```
#user_session_box {
    width: 100%;
    min-height: 45px;/*Must be px to display bg image properly */
    text-align: center;
    padding-right: 30%;/*Android will murder logout button if padding less than 30%*/
    color: #FFF;
    font-size:16pt;
    font-weight: bolder;
    background-image:url(../../images/bluebar7.png);
    position: fixed;
    top: 0px;
    left: 0px;
    margin: 0px;/*Overwrites desktop margins*/
    box-shadow: none;/*overwrites shadows on desktop version*/
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T18:10:05.740

大多数移动浏览器不支持 position:fixed。然而，像 iOS6 和 android4 这样的现代操作系统确实支持它。-> 如果浏览器不支持固定，则捕获滚动事件并重新定位元素（使用 Modernizr 进行检查）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T22:48:43.523

该站点包含对移动设备固定定位问题的广泛研究以及解决该问题的解决方案[http://bradfrostweb.com/blog/mobile/fixed-position/](http://bradfrostweb.com/blog/mobile/fixed-position/)

# haskell - 反应香蕉中的动态事件切换导致严重泄漏

> ID：15396038
> 
> 赞同：3
> 
> 时间：2013-03-13T20:41:41.220
> 
> 标签：haskell, frp, reactive-banana

我不确定这种行为是预期的（即我误用了 Reactive.Banana.Switch）还是一个错误。

假设我有两个类似类型的输入行为，我想根据一个事件在它们之间切换。我写了这个函数：

```
switchBehaviors :: 
      Behavior t a -- | Behavior to yield initially and after "True" events
   -> Behavior t a -- | Behavior to yield after "False" events
   -> Event t Bool -- | Select between behaviors
   -> Moment t (Behavior t a)
switchBehaviors t f es = do
    t' <- trimB t
    f' <- trimB f
    return $ switchB t $ (\e -> if e then t' else f') <$> es 
```

这段代码似乎无关紧要；当嵌入到简单的 GUI 模型中时，它会进行类型检查、编译并给出所需的结果。（行为的两个文本输入字段，一个发出交替 True 和 False 事件的按钮，以及一个使用 绑定到组合行为的标签`sink`。）

然而，在多次触发事件后，很明显某处发生了灾难性的泄漏。应用程序开始花费越来越长的时间来对输入行为的变化和新事件做出反应。它也开始吞噬记忆。

这是带有 -hC 的堆配置文件：![泄漏内存](../Images/3c835ed7729b041fc853bdb4dbc41ae5.png) 我反复切换事件；两个最大的峰值可能是事件的第 20 次和第 21 次触发。

使用 trimB 感觉有点像挥手让类型相加；我不知道我是否正确使用它或以某种方式滥用它。

我的子问题是：

1) 我是在滥用 Reactive.Banana.Switch API，还是这是一个错误？如果我滥用 API，我做错了什么？

2）我应该在不使用动态事件切换的情况下这样做吗？Using`apply`不会给出正确的行为，因为当底层行为发生变化时，结果事件不会触发。如果我打开事件的所有三个输入，我想我可以设置一个折叠，手动累积每个输入事件的最新值。这是正确的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-16T19:17:50.290

如果您使用 a`Behavior`作为选择输入并调用它`Behavior`是`Applicative`. 当我问这个问题时，我并没有真正内化这个`f <$> x <*> y <*> z ...`成语，所以这里有一个明确的锻炼方法，适合像我这样的其他人：

```
switchBehaviors 
    :: Behavior t a    -- | Behavior to yield when it's "True"
    -> Behavior t a    -- | Behavior to yield when it's "False"
    -> Behavior t Bool -- | Select between behaviors
    -> Behavior t a
switchBehaviors t f es = 
    (\e x y -> if e then x else y) <$> es <*> t <*> f 
```

（Heinrich Apfelmus 在评论中回答了第一个问题。正如他所指出的，`Reactive.Banana.Switch`它仍处于试验阶段，其性能特征正在改进。）

# java - Spring MVC Controller 预处理请求体

> ID：15396039
> 
> 赞同：1
> 
> 时间：2013-03-13T20:41:43.033
> 
> 标签：java, spring, spring-mvc, request

我正在研究 Spring REST API。在需求中，有 2 个具有相同 URL 但请求正文不同的 POST 请求。由于 Spring MVC 必须具有跨控制器的唯一映射，因此我必须预处理请求主体以映射到特定的 POJO。

根据请求正文中的 session_type，我必须将请求映射到特定的 POJO（JSON -> JAVA POJO）。

例如，如果请求正文中的“session_type”是“typeX”，那么请求应该映射到 ClassX POJO。如果请求正文中的“session_type”是“typeY”，则请求应映射到 ClassY POJO。

如果有办法使用某种 requestbody 注释来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T21:07:39.690

如果你想绑定`typeX`and `typeY`，那么你肯定需要 2 个处理程序。但是，我们为什么不使用以下`param`选项`@RequestMapping`：

```
@RequestMapping(method = RequestMethod.POST, 
        value = "/url", params = "session_type=typeX")
public String handleTypeX(@RequestBody @ModelAttribute TypeX typeX){
    //TODO implement
}

@RequestMapping(method = RequestMethod.POST,
        value = "/url", params = "session_type=typeY")
public String handleTypeY(@RequestBody @ModelAttribute TypeY typeY){
    //TODO implement
} 
```

如果您需要一些准备工作（fe 规范化参数或手动执行模型绑定），那么您可以将上述方法与 结合使用`@InitBinder`，但请注意，这`@InitBinder`需要精确的 ULR 规则以及`@ModelAttribute`处理程序中的参数。

**编辑**：在 Spring MVC 中，不可能对*确切的 URL*使用 2 个处理程序，即当 method/URL/params/consumes 类型相同时。

因此我建议使用统一处理程序，您可以在其中检查必要的参数，然后手动转换为相应的类。[为了找到必要的课程，我认为使用策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)会更好：

```
//class resolver according "session_type" parameter
//note, that you can use Spring autowiring capabilities
private final Map<String, Class> TYPES_CONTEXT = new HashMap<String, Class>(){
    {
        this.put("x", TypeX.class);
        this.put("y", TypeY.class);
        //TODO probably other classes
    }
}

@RequestMapping(method = RequestMethod.POST,
        value = "/url")
public @ResponseBody String handleAnyType(@RequestBody Map<String, String> body){
    String sessionType = body.get("session_type");

    //TODO handle case if sessionType is NULL

    Class convertedClass = TYPES_CONTEXT.get(sessionType);

    //TODO handle case if class is not found

    Object actualObject = objectMapper.convertValue(body, convertedClass);

    //now we use reflection for actual handlers, but you may refactor this in the way you want, f.e. again with Strategy pattern
    //note that current approach there should be contract for methods names
    Method actualHandler = this.getClass().getMethod("handle" + actualObject.getClass().getSimpleName());

    return (String)actualHandler.invoke(this, actualObject);
}

public String handleTypeX(TypeX typeX){
    //TODO implement
}

public String handleTypeY(TypeY typeY){
    //TODO implement
}

//TODO probably other methods 
```

这种方法不处理验证，有些东西被省略了，但我相信这可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T20:58:47.013

我认为您应该为两种类型创建一种方法，并根据`typeX`or调用所需的组件\方法`typeY`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-23T15:51:52.080

> 有 2 个具有相同 URL 但请求正文不同的 POST 请求

对于 RESTful 接口，相同的 URL 应始终指示相同的*资源*。请求的主体可能包含该资源的不同*表示*。`HttpMessageContverter`您可以为两种不同的表示创建不同的类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T21:37:28.713

GET 不应该有请求主体，或者至少如果有，[服务器端不需要对它们做任何事情](http://tech.groups.yahoo.com/group/rest-discuss/message/9962)。正如您所描述的，此 API 不是 RESTful。

假设您不关心这一点，请尝试创建一个控制器方法，该方法采用 TypeX 和 TypeY 的父类，或者 TypeX 和 TypeY 都实现的接口，使用 @SomethingMeaningfulToYou 对其进行注释，然后使用[Web 参数方法解析器](http://sergialmar.wordpress.com/2011/03/29/extending-handler-method-argument-resolution-in-spring-mvc/)来实例化子类你想要的课。

不过，这是对损坏的 API 的一种破解。

# svn - Subversion - 命令行更新

> ID：15396042
> 
> 赞同：0
> 
> 时间：2013-03-13T20:41:59.717
> 
> 标签：svn

更新到存储库中代码的最新版本的 subversion 命令行语句是什么？

我已经签出了代码，但我需要更新到最新的代码，因为一些文件已经更新。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T20:43:23.897

命令是

```
svn update 
```

或者

```
svn up 
```

简而言之。

请参阅[SVNBook](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.update.html)。

# c++ - 平铺映射 OpenGL C++

> ID：15396043
> 
> 赞同：2
> 
> 时间：2013-03-13T20:41:59.763
> 
> 标签：c++, opengl

我正在尝试`tile mapping`使用 openGL 和 C++ 来实现。

我发现[这个](http://www.swiftless.com/tutorials/opengl/tiling.html) 教程/解释我认为非常好。

当我编译并运行其中的代码时，`visual studio 2010`它只会打开一个窗口并显示一个白色方块。

也许我的文件没有正确加载。我已经尝试过`.raw`网站使用的文件以及我自己的`.png`文件。

```
 #include <GL/gl.h>
#include <GL/glut.h>
#include <windows.h>
#include <stdio.h>

GLuint texture; //the array for our texture
GLuint texture2; //the array for our second texture

int cMap[10][10] = { //our map
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
    {1, 0, 1, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 1, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 1, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 1, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 1, 1, 1, 1, 1, 1, 1, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    {1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
};

//function to load the RAW file

GLuint LoadTexture( const char * filename, int width, int height )
{
    GLuint texture;
    unsigned char * data;
    FILE * file;

    //The following code will read in our RAW file
    file = fopen( filename, “rb” );
    if ( file == NULL ) return 0;
    data = (unsigned char *)malloc( width * height * 3 );
    fread( data, width * height * 3, 1, file );
    fclose( file );

    glGenTextures( 1, &texture )
    glBindTexture( GL_TEXTURE_2D, texture );
    glTexEnvf( GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, 
GL_MODULATE ); //set texture environment parameters

    glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, 
GL_LINEAR );
    glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER,
GL_LINEAR );

    //Here we are setting the parameter to repeat the texture 
instead of clamping the texture
    //to the edge of our shape. 
    glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, 
GL_REPEAT );
    glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, 
GL_REPEAT );

    //Generate the texture
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, width, height, 0, 
GL_RGB, GL_UNSIGNED_BYTE, data);
    free( data ); //free the texture
    return texture; //return whether it was successfull
}

void FreeTexture( GLuint texture )
{
  glDeleteTextures( 1, &texture ); 
}

void drawTiles (void) { //our function to draw the tiles
    for (int i = 0; i < 10; i++) //loop through the height of the map
    {
        for (int j = 0; j < 10; j++) //loop through the width of the map
        {
            if (cMap[i][j] == 0) //if the map at this position contains a 0
            {
                glBindTexture( GL_TEXTURE_2D, texture ); //bind our grass texture to our shape
            }
            else //otherwise
            {
                glBindTexture( GL_TEXTURE_2D, texture2 ); //bind our dirt texture to our shape
            }

            glPushMatrix(); //push the matrix so that our translations only affect
 this tile
                glTranslatef(j, -i, 0); //translate the tile to where it should belong

                glBegin (GL_QUADS); //begin drawing our quads
                    glTexCoord2d(0.0, 0.0);
                    glVertex3f(0.0, 0.0, 0.0); //with our vertices we have to assign a texcoord

                    glTexCoord2d(1.0, 0.0);
                    glVertex3f(1.0, 0.0, 0.0); //so that our texture has some points to draw to

                    glTexCoord2d(1.0, 1.0);
                    glVertex3f(1.0, 1.0, 0.0);

                    glTexCoord2d(0.0, 1.0);
                    glVertex3f(0.0, 1.0, 0.0);
                glEnd();
            glPopMatrix(); //pop the matrix
        } //end first loop
    } //end second loop
}

void display (void) {
    glClearColor (0.0,0.0,0.0,1.0);
    glClear (GL_COLOR_BUFFER_BIT);
    glLoadIdentity(); 
    glEnable( GL_TEXTURE_2D );
    glTranslatef(-5, 4, -20); //translate back a bit to view the map correctly

    drawTiles(); //draw our tiles
    glutSwapBuffers();
}
void reshape (int w, int h) {
    glViewport (0, 0, (GLsizei)w, (GLsizei)h);
    glMatrixMode (GL_PROJECTION);
    glLoadIdentity ();
    gluPerspective (60, (GLfloat)w / (GLfloat)h, 1.0, 100.0);
    glMatrixMode (GL_MODELVIEW);
}

int main (int argc, char **argv) {
    glutInit (&argc, argv);
    glutInitDisplayMode (GLUT_DOUBLE);
    glutInitWindowSize (500, 500);
    glutInitWindowPosition (100, 100);
    glutCreateWindow (“A basic OpenGL Window“);
    glutDisplayFunc (display);
    glutIdleFunc (display);
    glutReshapeFunc (reshape);

    //Load our texture
    texture = LoadTexture(“texture.raw”, 256, 256);
    texture2 = LoadTexture(“texture2.raw”, 256, 256);

    glutMainLoop ();

    //Free our texture
    FreeTexture(texture);
    FreeTexture(texture2);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T20:54:21.540

确保您的[工作目录](http://en.wikipedia.org/wiki/Working_directory)是您所假设的。

或者使用绝对文件名。

否则`fopen()`会因为找不到文件而失败。

# c++ - 如何为链表插入元素

> ID：15396044
> 
> 赞同：-3
> 
> 时间：2013-03-13T20:42:03.273
> 
> 标签：c++, algorithm, linked-list

//我不知道如何插入元素，并输出整个列表。

```
#include <iostream>
using namespace std;
class IntElement 
{
public:
    class IntElement *next;
    int data;
bool insertInFront( IntElement** head, int data )
{
IntElement *newElem = new IntElement;
if( !newElem ) return false;
newElem->data = data;
*head = newElem;
return true;
}
bool insertElement(IntElement **head, int d)
{
    IntElement *newElem = new IntElement;
    newElem->data=d;
    newElem=*head;
    *head=newElem->next;
    return true;
}
void print(IntElement **head)
{
     if(*head!=NULL)
    {
        cout<<(*head)->data<<endl;
        *head=(*head)->next;
    }
}
} ;
int main()
{

    IntElement *T=new IntElement;
    T->insertInFront( &T,7);
    T->insertInFront(&T,9);
    T->insertInFront(&T,213);
    T->insertInFront(&T,33);
    T->insertElement(&T,123);
    T->print(&T);
    system("pause");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T20:51:42.047

仔细重读：

```
IntElement *newElem = new IntElement;
newElem->data=d;
newElem=*head;
*head=newElem->next;
return true; 
```

我怀疑那`newElem = *head;`是在做你想做的事。

# java - Struts 2 显示西班牙语文本的问题

> ID：15396049
> 
> 赞同：0
> 
> 时间：2013-03-13T20:42:19.730
> 
> 标签：java, character-encoding, struts2, html-entities

我有一个 Struts 2 应用程序，它有一个由 Struts s:text 标签使用的西班牙语属性文件。但是，Web 浏览器中生成的页面中包含乱码，如下所示：

```
ContraseÃ±a: 
```

属性文件中的值为：

```
password = Contraseña 
```

我最初认为问题在于我的属性文件的编码，但 Notepad++ 和标准 Windows 记事本都报告它保存为 UTF-8。

我还能做些什么来修复我的属性文件中的字符吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:47:10.193

问题出在浏览器上，您应该`HTML entity`像 : 一样 提供这些字符`&ntilde;`，您可能希望直接以这种方式编写它们，或者使用工具将这些值转换为`HTML entities`.

同样在文件中避免与其他开发人员和编辑器出现问题 not `UTF8`，最好的方法是以`Unicode`格式存储这些字符串，您可以用您的母语（例如西班牙语）键入它们，然后运行`native2ascii`命令将它们转换为`unicode`. ..

这样做的好处是每个人都可以打开`.java`和`.jsp`文件......如果他们想使用这些短语，那么他们打开属性文件......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-03T10:12:47.487

您的问题是，默认情况下，读取属性文件时假定编码是 ASCII，这确实很糟糕。

关于同样的问题，我在这里有一个未回答的问题。

[Struts2：UTF .properties](https://stackoverflow.com/questions/22779037/struts2-utf-properties)

我知道 ResourceBundle 可以管理 UTF-8 文件（我在那个问题中说如何做到这一点并放置一个链接到已完成并使用 un JSF 的页面）但不知道如何在 struts2 中做到这一点

# mysql - 如何在mysql中将varchar转换为日期时间格式

> ID：15396058
> 
> 赞同：6
> 
> 时间：2013-03-13T20:43:03.583
> 
> 标签：mysql

我正在尝试将 varchar 转换为日期时间这就是我现在所拥有的，它对我不起作用。我总是觉得有价值

```
STR_TO_DATE(REPLACE(LEFT('5/16/2011 20:14 PM', LOCATE('M' , '5/16/2011 20:14 PM')-3), '/',','),'%m-%d-%Y %T') 
```

以下代码返回 5,16,2011 20:14

```
select REPLACE(LEFT('5/16/2011 20:14 PM', LOCATE('M' , '5/16/2011 20:14 PM')-3), '/',',') 
```

我当前的输出现在是 emply 字符串。应该是 2011-05-16 20:14:00

我怎样才能让它工作？

谢谢

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-13T20:47:00.630

如果你的 varchar 是这样的：

```
5/16/2011 20:14 PM 
```

您可以使用以下方法将其转换为日期时间：

```
SELECT STR_TO_DATE('5/16/2011 20:14 PM', '%c/%e/%Y %H:%i') 
```

或者这样来格式化它，就像你想要的那样：

```
SELECT DATE_FORMAT(STR_TO_DATE('5/16/2011 20:14 PM', '%c/%e/%Y %H:%i'), '%Y-%m-%d %H:%m:%s') 
```

# sql - TSQL 查询运行缓慢，如何加快速度？

> ID：15396059
> 
> 赞同：1
> 
> 时间：2013-03-13T20:43:04.490
> 
> 标签：sql, sql-server, join, subquery

我有一个报告的 sql 查询，它包括一些子查询。它运行得很慢。我尝试了几种方法（例如使用联接而不是子查询，添加更多索引）。但他们都没有工作。这是查询：

```
declare @time_from       datetime
declare @time_to         datetime   
set @time_from ='2012-01-01'
set @time_to = '2014-01-01'
select a.a_id, c.c_id, c.c_chat_line_id, a.a_first_name, a.a_last_name
    ,(select isnull(SUM(ac.ac_amount),0) from t_actress_credit ac join t_order o on o.o_id = ac.order_id where o.o_status = 1 and ac.actress_id = a.a_id and ac.ac_time>=@time_from and ac.ac_time<=@time_to) as  credit
    ,(select isnull(SUM(ac.ac_amount),0) from t_actress_credit ac join t_order o on o.o_id = ac.order_id where o.o_status = 1 and ac.ac_is_paid = 1 and ac.actress_id = a.a_id and ac.ac_time>=@time_from and ac.ac_time<=@time_to) as  paid_credit
    ,(select COUNT(1) from t_message pm join t_call_log l1 on pm.call_log_id = l1.c_id where pm.m_type = 2 and l1.caller_id = c.c_id and pm.m_time>=@time_from and pm.m_time<=@time_to) as pmsg_sent
    ,(select COUNT(1) from t_message pm join t_call_log l2 on pm.m_to_call_log_id = l2.c_id where pm.m_type = 2 and l2.caller_id = c.c_id and pm.m_time>=@time_from and pm.m_time<=@time_to) as pmsg_received
    ,(select COUNT(1) from t_message pm join t_call_log l3 on pm.call_log_id = l3.c_id where pm.m_type = 1 and l3.caller_id = c.c_id and pm.m_time>=@time_from and pm.m_time<=@time_to) as lcmsg_sent
    ,(select COUNT(1) from t_message pm join t_call_log l4 on pm.m_to_call_log_id = l4.c_id where pm.m_type = 1 and l4.caller_id = c.c_id and pm.m_time>=@time_from and pm.m_time<=@time_to) as lcmsg_received
    ,(select COUNT(1) from t_actress_live_minute where actress_id = a.a_id and alm_time>=@time_from and alm_time<=@time_to ) as live_calls
    ,(select isnull(SUM(alm_minutes),0) from t_actress_live_minute where actress_id = a.a_id  and alm_time>=@time_from and alm_time<=@time_to) as live_call_minutes
    ,(select isnull(count(1),0) from t_call_log l where l.caller_id = c.c_id and l.c_time_out is not null and c_time_in >=@time_from and c_time_in <= @time_to) as total_calls
    ,(select isnull(SUM(DATEDIFF(minute, l.c_time_in, l.c_time_out)),0) from t_call_log l where c_time_in >=@time_from and c_time_in <= @time_to and l.caller_id = c.c_id and l.c_time_out is not null ) as total_call_minutes
from t_actress a
join t_caller c on c.c_id = a.caller_id
group by a.a_id,c.c_id, c.c_chat_line_id, a.a_first_name, a.a_last_name 
```

任何人都可以提供一些建议吗？

非常感谢！

艾伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T23:26:57.050

您可以尝试将从同一个表或一组表中提取的子查询组合到一个子查询中。要考虑条件的变化，您可以使用条件聚合（使用 CASE 表达式）。

我可以在您的查询中看到四个，可能五个这样的组。这里重写为使用四个子查询：

```
SELECT
  a.a_id,
  c.c_id,
  c.c_chat_line_id,
  a.a_first_name,
  a.a_last_name,
  ISNULL(cr.credit            , 0) AS credit
  ISNULL(cr.paid_credit       , 0) AS paid_credit
  ISNULL(m.pmsg_sent          , 0) AS pmsg_sent,
  ISNULL(m.pmsg_received      , 0) AS pmsg_received,
  ISNULL(m.lcmsg_sent         , 0) AS lcmsg_sent,
  ISNULL(m.lcmsg_received     , 0) AS lcmsg_received,
  ISNULL(alm.live_calls       , 0) AS live_calls,
  ISNULL(alm.live_call_minutes, 0) AS live_call_minutes,
  ISNULL(l.total_calls        , 0) AS total_calls,
  ISNULL(l.total_call_minutes , 0) AS total_call_minutes,

FROM t_actress AS a

INNER JOIN t_caller AS c
  ON c.c_id = a.caller_id

LEFT JOIN (
  SELECT
    ac.actress_id,
    SUM(                               ac.ac_amount    ) AS credit,
    SUM(CASE ac.ac_is_paid WHEN 1 THEN ac.ac_amount END) AS paid_credit
  FROM t_actress_credit AS ac
  JOIN t_order o ON o.o_id = ac.order_id
  WHERE o.o_status = 1
    AND ac.ac_time BETWEEN @time_from AND @time_to
  GROUP BY ac.actress_id
) AS ac
  ON ac.actress_id = a.a_id

LEFT JOIN (
  SELECT
    l.caller_id,
    COUNT(CASE WHEN m.     call_log_id = l1.c_id AND m.m_type = 2 THEN 1 END) AS pmsg_sent,
    COUNT(CASE WHEN m.m_to_call_log_id = l2.c_id AND m.m_type = 2 THEN 1 END) AS pmsg_received,
    COUNT(CASE WHEN m.     call_log_id = l3.c_id AND m.m_type = 1 THEN 1 END) AS lcmsg_sent,
    COUNT(CASE WHEN m.m_to_call_log_id = l4.c_id AND m.m_type = 1 THEN 1 END) AS lcmsg_received
  FROM t_message AS m
  JOIN t_call_log AS l ON l.c_id IN (m.call_log_id, m.m_to_call_log_id)
  WHERE m.m_type IN (1, 2)
    AND m.m_time BETWEEN @time_from AND @time_to
  GROUP BY l.caller_id
) AS m
  ON m.caller_id = c.c_id

LEFT JOIN (
  SELECT
    actress_id,
    COUNT(*)         AS live_calls,
    SUM(alm_minutes) AS live_call_minutes
  FROM t_actress_live_minute
  WHERE alm_time BETWEEN @time_from AND @time_to
  GROUP BY actress_id
) AS alm
  ON alm.actress_id = a.a_id

LEFT JOIN (
  SELECT
    caller_id,
    COUNT(*)                                     AS total_calls,
    SUM(DATEDIFF(MINUTE, c_time_in, c_time_out)) AS total_call_minutes
  FROM t_call_log
  WHERE c_time_out IS NOT NULL
    AND c_time_in BETWEEN @time_from AND @time_to
  GROUP BY caller_id
) AS l
  ON l.actress_id = a.a_id
; 
```

如果您`m`通过单独连接将子查询分成两个，`call_log_id`则可能是五个子查询`m_to_call_log_id`（从而可能为查询计划器提供更多优化空间），即而不是

```
LEFT JOIN (
  SELECT
    l.caller_id,
    COUNT(CASE WHEN m.     call_log_id = l1.c_id AND m.m_type = 2 THEN 1 END) AS pmsg_sent,
    COUNT(CASE WHEN m.m_to_call_log_id = l2.c_id AND m.m_type = 2 THEN 1 END) AS pmsg_received,
    COUNT(CASE WHEN m.     call_log_id = l3.c_id AND m.m_type = 1 THEN 1 END) AS lcmsg_sent,
    COUNT(CASE WHEN m.m_to_call_log_id = l4.c_id AND m.m_type = 1 THEN 1 END) AS lcmsg_received
  FROM t_message AS m
  JOIN t_call_log AS l ON l.c_id IN (m.call_log_id, m.m_to_call_log_id)
  WHERE m.m_type IN (1, 2)
    AND m.m_time BETWEEN @time_from AND @time_to
  GROUP BY l.caller_id
) AS m
  ON m.caller_id = c.c_id 
```

这将是

```
LEFT JOIN (
  SELECT
    l.caller_id,
    COUNT(CASE WHEN m.call_log_id = l1.c_id AND m.m_type = 2 THEN 1 END) AS pmsg_sent,
    COUNT(CASE WHEN m.call_log_id = l3.c_id AND m.m_type = 1 THEN 1 END) AS lcmsg_sent,
  FROM t_message AS m
  JOIN t_call_log AS l ON l.c_id = m.call_log_id
  WHERE m.m_type IN (1, 2)
    AND m.m_time BETWEEN @time_from AND @time_to
  GROUP BY l.caller_id
) AS mf
  ON mf.caller_id = c.c_id

LEFT JOIN (
  SELECT
    l.caller_id,
    COUNT(CASE WHEN m.m_to_call_log_id = l2.c_id AND m.m_type = 2 THEN 1 END) AS pmsg_received,
    COUNT(CASE WHEN m.m_to_call_log_id = l4.c_id AND m.m_type = 1 THEN 1 END) AS lcmsg_received
  FROM t_message AS m
  JOIN t_call_log AS l ON l.c_id = m.m_to_call_log_id
  WHERE m.m_type IN (1, 2)
    AND m.m_time BETWEEN @time_from AND @time_to
  GROUP BY l.caller_id
) AS mt
  ON mt.caller_id = c.c_id 
```

还更改主 SELECT 子句中的相应引用。

我不确定哪种变体更好，您需要测试两者才能找出答案。

请注意，我省略了主查询的 GROUP BY 子句。在您的查询和我的查询中似乎都没有必要，因为据我所知，它包括来自两者的主键，`t_actress`并且`t_caller`这些组合无论如何都是唯一的。我假设 GROUP BY 是您之前尝试使用联接重写查询的遗留物。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T18:14:10.220

感谢您的回复。我试过你的方法，还是很慢。这就是我所做的，终于奏效了。我基本上将所有子查询放入表中，然后在最后加入表。不知道为什么，但它更快：这是代码；

```
-- total calls
declare @t_call table(
    a_id bigint,
    total_calls bigint,
    total_call_minutes bigint
);
insert into @t_call
    SELECT  a_id, COUNT(1) AS total_calls, isnull(SUM(DATEDIFF(MINUTE, c_time_in, c_time_out)),0) AS total_call_minutes
      FROM t_actress aa
            join t_call_log l on aa.caller_id = l.caller_id and c_time_in BETWEEN @time_from AND @time_to and c_time_out IS NOT NULL
      GROUP BY a_id;

-- total live minutes
declare @t_live table(
    a_id bigint,
    live_calls bigint,
    live_call_minutes bigint
);
insert into @t_live
    SELECT a_id, COUNT(*) AS live_calls, isnull(SUM(alm_minutes),0) AS live_call_minutes
      FROM t_actress a
          join t_actress_live_minute alm on alm.actress_id = a.a_id and alm_time BETWEEN @time_from AND @time_to
      GROUP BY a_id 

-- total message by caller
declare @t_cm table(
    caller_id bigint,
    pmsg_sent bigint,
    pmsg_received bigint,
    lcmsg_sent bigint,
    lcmsg_received bigint
)
insert into @t_cm
    SELECT l.caller_id,
            COUNT(CASE WHEN m.call_log_id       = l.c_id AND m.m_type = 2 THEN 1 END) AS _pmsg_sent,
            COUNT(CASE WHEN m.m_to_call_log_id  = l.c_id AND m.m_type = 2 THEN 1 END) AS _pmsg_received,
            COUNT(CASE WHEN m.call_log_id       = l.c_id AND m.m_type = 1 THEN 1 END) AS _lcmsg_sent,
            COUNT(CASE WHEN m.m_to_call_log_id  = l.c_id AND m.m_type = 1 THEN 1 END) AS _lcmsg_received
          FROM t_message m
            join t_call_log l on l.c_id in (m.call_log_id, m.m_to_call_log_id)  
          where m.m_time BETWEEN @time_from AND @time_to
      GROUP BY l.caller_id

-- total message by actress
declare @t_msg table(
    a_id bigint,
    pmsg_sent bigint,
    pmsg_received bigint,
    lcmsg_sent bigint,
    lcmsg_received bigint
)
insert into @t_msg
    select a_id, isnull(SUM(cm.pmsg_sent),0), isnull(SUM(cm.pmsg_received),0), isnull(SUM(cm.lcmsg_sent),0), isnull(SUM(cm.lcmsg_received),0)
        from t_actress a
            join @t_cm cm on a.caller_id = cm.caller_id
    group by a_id

-- total credit
declare @t_credit table(
    a_id bigint,
    credit money,
    paid_credit money
)   
insert into @t_credit
    SELECT a_id,    isnull(SUM(ac.ac_amount),0) AS credit, isnull(SUM(CASE ac.ac_is_paid WHEN 1 THEN ac.ac_amount else 0 END),0) AS paid_credit
        FROM t_actress a
            join t_actress_credit ac on ac.actress_id = a.a_id AND ac.ac_time BETWEEN @time_from AND @time_to
            JOIN t_order o ON o.o_id = ac.order_id and o_status = 1
    GROUP BY a_id   

-- the report       
select a.a_id, cl.c_id, cl.c_chat_line_id, a.a_first_name, a.a_last_name, 
        isnull(ac.credit,0) credit, isnull(ac.paid_credit,0) paid_credit, 
        isnull(m.pmsg_sent,0) pmsg_sent, isnull(m.pmsg_received,0) pmsg_received, isnull(m.lcmsg_sent,0) lcmsg_sent, isnull(m.lcmsg_received,0) lcmsg_received,
        isnull(l.live_calls,0) live_calls, isnull(l.live_call_minutes,0) live_call_minutes,
        isnull(c.total_calls,0) total_calls, isnull(c.total_call_minutes,0) total_call_minutes
from t_actress a
    join t_caller cl on cl.c_id = a.caller_id
    left outer join @t_call c on c.a_id = a.a_id
    left outer join @t_live l on l.a_id = a.a_id                
    left outer join @t_msg m on m.a_id = a.a_id
    left outer join @t_credit ac on ac.a_id = a.a_id
order by a_id 
```

# php - 使用 PHP 的 Basecamp OAuth2

> ID：15396063
> 
> 赞同：5
> 
> 时间：2013-03-13T20:43:20.480
> 
> 标签：php, oauth-2.0, basecamp

我正在尝试为 Basecamp 创建一个应用程序。我设法使用 curl 连接和提取数据（[使用 cURL 和 PHP 的 Basecamp API](https://stackoverflow.com/questions/15329476/basecamp-api-using-curl-and-php/15395769#15395769)）。但是，这需要用户登录数据。

我想在[https://github.com/37signals/api/blob/master/sections/authentication.md](https://github.com/37signals/api/blob/master/sections/authentication.md)中将 OAuth2 与 Basecamp 一起使用。不幸的是，有 0 个文档，我找不到任何示例代码。我看到有几个 OAuth2 库[http://oauth.net/code/](http://oauth.net/code/)，但我不知道如何处理它们。

有人可以向我展示一些 php 示例代码，说明我将如何在 php 中使用 OAuth2 对用户进行身份验证，而不是向 Basecamp API 发出请求？

非常感谢您提前。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-03-05T06:34:35.103

我最近不得不为我们公司实施 OAuth 2.0。我也在浏览网页以尝试查找有关该主题的信息。我遇到了这两个网站，这有很大帮助。

[OAuth 2.0 实现示例](http://bshaffer.github.io/oauth2-server-php-docs/)

[在线截屏](https://knpuniversity.com/screencast/oauth)

希望这可以帮助。

# opengl - OpenGL旋转已经从矩阵中弹出的东西

> ID：15396064
> 
> 赞同：1
> 
> 时间：2013-03-13T20:43:23.147
> 
> 标签：opengl

我有一个关于将转换应用于纹理/顶点的问题（我是 OpenGL 学习者）。我有一种情况，我正在使用 SharpGL 的 DrawText 函数。您可以指定 X 和 Y 坐标，但我想旋转文本以使其垂直定向。该功能虽然没有角度。SharpGL 写入文本的方式是它获取一个位图数组并写入屏幕。

无论我尝试什么，我的文字总是水平的。

gl.DrawText 函数执行以下操作（我深入研究了源代码）。

gl.MatrixMode(OpenGL.GL_PROJECTION); gl.PushMatrix(); gl.LoadIdentity();

```
 int[] viewport = new int[4];
        gl.GetInteger(OpenGL.GL_VIEWPORT, viewport);
        gl.Ortho(0, width, 0, height, -1, 1);

        //  Create the appropriate modelview matrix.
        gl.MatrixMode(OpenGL.GL_MODELVIEW);
        gl.PushMatrix();
        gl.LoadIdentity();
        gl.Color(r, g, b);
        gl.RasterPos(x, y);

        gl.PushAttrib(OpenGL.GL_LIST_BIT | OpenGL.GL_CURRENT_BIT |
            OpenGL.GL_ENABLE_BIT | OpenGL.GL_TRANSFORM_BIT);
        gl.Color(r, g, b);
        gl.Disable(OpenGL.GL_LIGHTING);
        gl.Disable(OpenGL.GL_TEXTURE_2D);
        gl.Disable(OpenGL.GL_DEPTH_TEST);
        gl.RasterPos(x, y);

        //  Set the list base.
        gl.ListBase(fontBitmapEntry.ListBase);

        //  Create an array of lists for the glyphs.
        var lists = text.Select(c => (byte) c).ToArray();

        //  Call the lists for the string.
        gl.CallLists(lists.Length, lists);
        gl.Flush(); 
```

有没有一种方法可以使转换调用应用于任何已经制作并弹出相关矩阵的绘图？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T20:52:42.807

如果 SharpGL`glBitmap()`在幕后使用，您必须将文本渲染为纹理 ( `glReadPixels()`/PBO/FBO)，然后使用该纹理渲染（旋转的）四边形。

# lua - lua 新手：C-Lua 如何将结构/缓冲区从 C 传递给 lua？

> ID：15396067
> 
> 赞同：3
> 
> 时间：2013-03-13T20:43:27.907
> 
> 标签：lua

我遵循了这个样板示例：[http ://www.matrix44.net/blog/?p=456](http://www.matrix44.net/blog/?p=456)

我能够将字符串从 C 发送到 Lua，但是当我传递结构时出现错误（我使用了 lua_newuserdata）。

### C 剪辑

```
//s = (ST*) malloc ( sizeof(ST) );
//    lua_pushlightuserdata(state, s);
s = lua_newuserdata(state, sizeof(ST));
s->a=11;
s->b=12;
printf ( "s = %p \n", s ); // Prints 0x80a708
result = lua_pcall(state, 0, LUA_MULTRET, 0); 
```

* * *

### Lua 剪辑

```
print(foo)  -->  Prints 0x80a708
io.write("received has:\n", foo.a); --> ERROR : Failed to run script: script.lua:1: attempt to index global 'foo' (a userdata value) 
```

* * *

如何将缓冲区转换为结构/表记录？

最终，我的 C 程序不知道结构，它只会将缓冲区传递给 Lua，而 Lua 知道结构并且需要在那里转换。

谢谢， PS：脚本和 C 程序的 printf 都匹配（0x80a708），我可以投吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T01:40:48.933

Lua 没有结构，它有表。

Userdata 是一种将不透明数据传递给 Lua 的便捷方式，但 Lua 无法看到内部数据。用户数据只有在你将它传递回 C++ 并且你有办法确定它是什么时才有用（本质上是将它转换为正确的类型）。

Lua 表最接近 C++ 中的结构。你可以这样写：

```
lua_newtable(state);
lua_pushnumber(state, s->a);
lua_setfield(state, -2, "a");
lua_pushnumber(state, s->b);
lua_setfield(state, -2, "b"); 
```

有了这个，现在就可以在lua中引用了：

```
print(foo.a); -- this will now print 11 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T21:09:50.857

用户数据内部无法从 Lua 代码访问。
使用表将结构从 C 传递到 Lua。
或者通过 metatable 为您的用户数据手动定义索引。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T18:42:47.413

已解决：我使用了 luajit 并且能够传递一个缓冲区并将其转换为 lua 端的 C 结构。

# html - IFrame Wmode 中断固定菜单

> ID：15396068
> 
> 赞同：0
> 
> 时间：2013-03-13T20:43:31.480
> 
> 标签：html, css, iframe, youtube, wmode

我有一个嵌入的 youtube 视频，但具有固定位置的菜单没有滚动它；相反，视频在滚动时会覆盖菜单。

以下代码片段显示了我目前尝试过的内容。

```
<iframe id="lesson_demo" style="position: relative; top: 115px; left:430px; " width="450" height="280" src="http://www.youtube.com/embed/ae_DKNwK_ms&amp;wmode=transparent" frameborder="0" allowfullscreen></iframe></p>

&wmode=transparent
?wmode=transparent
&wmode=opaque
?wmode=opaque 
```

这些变化都没有奏效。如果您找到了解决此问题的方法，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T22:48:13.457

将您的链接更改为此

`http://www.youtube.com/embed/ae_DKNwK_ms?wmode=transparent`

这就是你所需要的。

[工作示例](http://jsfiddle.net/buhvf/30/)

`position: relative`编辑：从中删除`<iframe>`它以使其工作。

# list - 如何从 Prolog 中的一个列表中获取对？

> ID：15396070
> 
> 赞同：0
> 
> 时间：2013-03-13T20:43:37.573
> 
> 标签：list, prolog

我是 Prolog 的新手，我不知道如何获得结果。

我想计算列表中可能的对组合。

示例：输入是一个列表 [a,b,c]，我想获得对 (a,b),(a,c),(b,c)。我希望每一对都保存为一个列表。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:59:03.193

正如丹尼尔所指出的，您应该尝试自己找到解决方案。

只需一个 findall/3 即可获得结果，使用 append/3将配对的第一个元素和其余元素*放在一起*，单个 member/2 足以选择配对的第二个元素。

当然，实际的解决方案远没有那么冗长，也更清晰。如果你尝试组装它，你会学到很多东西......

```
all_pairs(L, R) :-
    findall((A,B), (..., ...), R). 
```

产量

```
?- all_pairs([a,b,c],L).
L = [ (a, b), (a, c), (b, c)]. 
```

*编辑*您只需要修复细节：

```
...((A,B), (append(_, [A|T], L), ...), R). 
```

在上下文中生成第一个元素，并且您知道如何获取 B 。

请注意，[A,B] 它与问题中所需的 (A,B) 不同。

# c++ - 用两个旧的 char* 制作一个新的 char*

> ID：15396071
> 
> 赞同：0
> 
> 时间：2013-03-13T20:43:38.250
> 
> 标签：c++, c, char, concatenation

我愿意使用中间 C++ 代码，尽管 C 代码是首选。

我有如下代码：

```
char *fileName1 = "graph";
char *extension1 = ".eps"; 
```

我想创建一个名为“graph.eps”的新`char*`变量，由上面给出的两个变量组成。如何才能做到这一点？`fileName1WithExtension1``char*`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T20:46:32.517

```
char *new_string;

new_string = malloc(strlen(fileName1) + strlen(extension1) + 1);
sprintf(new_string, "%s%s", fileName1, extension1);

...

free(new_string) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-13T20:56:36.403

如果您使用 C++，请将它们作为[`std::string`](http://www.cplusplus.com/reference/string/string/)字符串：

```
std::string fileName1 = "graph";
std::string extension1 = ".eps"; 
```

然后简单地

```
std::string fileName1WithExtension1 = filename1 + extension1; 
```

如果您需要将其传递给需要 C 字符串的 C 库函数，请使用 char 指针`fileName1WithExtension1.c_str()`

真的没有理由在 C++ 代码中使用纯 C 字符串。它非常容易出错和乏味，应该积极避免。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-13T20:46:28.700

您可以使用该`asprintf()`功能

```
char *buffer;
asprintf (&buffer, "%s%s", fileName1, extension1); 
```

当`buffer`变量在您的代码中变得无用时，您必须释放 asprintf 为缓冲区分配的内存

```
free(buffer); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-13T20:51:02.620

```
char *joined;
joined = (char*)malloc(strlen(fileName1) + strlen(extension1) + 1);
strcpy(joined, fileName1)
strcat(joined, extension1) 
```

为了小幅提高性能，如果编译器在优化方面足够聪明，请将最后一行更改为

```
strcpy(joined+strlen(fileName1), extension1) 
```

更好的是，第一次确定 fileName1 的长度时将其存储在一个变量中，并在最终的 strcpy() 中使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-13T22:26:24.613

如果你想真正低级，使用丑陋的循环等，你可以这样做：（经过测试，它编译并给出预期和期望的结果）

```
char* filename1 = "graph";
char* extension1 = ".eps";
char* filename1WithExtension1 = combine(filename1, extension1); 
```

在哪里：

```
char* combine(char* str1, char* str2)
{
    int str1len = 0, str2len = 0;
    while(str1[str1len] != '\0') {
        str1len++;
    }
    while(str2[str2len] != '\0') {
        str2len++;
    }
    int outputlen = str1len + str2len + 1;
    char* output = new char[outputlen];
    for(int i = 0; i < str1len; i++)
    {
        output[i] = str1[i];
    }
    for(int i = str1len; i < outputlen; i++)
    {
        output[i] = str2[i - str1len];
    }
    return output;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-14T11:27:13.727

为了好玩，我做了一些 C 复习，这里有一个替代方法（C90 和 C++ 兼容代码），用于连接带有分隔符的 C 字符串数组。对于任何适当优化的编译器，它也应该非常有效：

```
#include <string.h>
#include <stdlib.h>

/* **parts are strings to join, a NULL-terminated array of char*
 * sep is separator string, use "" for no separator, must not be NULL
 * returns malloc-allocated buffer which must be freed
 * if len_out!=NULL, sets *len_out to strlen of result string */
char *astrjoin(int *len_out, const char *sep, char **parts) {

    int part_count;
    int parts_total_len = 0;

    for(part_count = 0; parts[part_count]; ++part_count) {
        parts_total_len += strlen(parts[part_count]);
    }
    if (part_count > 0) {
        int malloc_size = (part_count - 1) * strlen(sep) + parts_total_len + 1;
        char *result = (char*)malloc(malloc_size);
        char *dest = result;   
        for(;;) {
            const char *src;
            for(src=*parts; *src; ++src) *dest++ = *src;
            if (!*++parts) break;
            for(src=sep ; *src; ++src) *dest++ = *src;
        }
        *dest = 0;
        if (len_out) *len_out = malloc_size - 1;
        return result;
    } else {
        if (len_out) *len_out = 0;
        return strdup("");
    }
} 
```

示例用法：

```
int main(int argc, char *argv[]) {
    /* argv is NULL-terminated array of char pointers */
    char *commandline = astrjoin(NULL, " ", argv);
    printf("argc: %d\nargv: %s\n", argc, commandline);
    free(commandline);
    return 0;
} 
```

要在您的问题的上下文中调用它，它可能类似于：

```
char *tmparr[] = { fileName1, exteansion1, NULL };
char *fileName1WithExtension1 = astrjoin(NULL, "", tmparr); 
```

* * *

`sep`创建一个带有和/或删除的版本或支持“可变参数”的版本将是微不足道的`len_out`，其签名看起来像：

```
char *astrjoin_va(int *len_out, const char *sep, ...); 
```

在您的问题的上下文中调用哪个会更好：

```
char *fileName1WithExtension1 = astrjoin_va(NULL, "", fileName1, extension1, NULL); 
```

# c# - GetRoomLists 成功但不返回数据

> ID：15396073
> 
> 赞同：6
> 
> 时间：2013-03-13T20:43:39.217
> 
> 标签：c#, web-services, exchangewebservices

我正在使用 Exchange Web 服务调用 GetRoomLists，我们正在运行 Exchange 2010。下面的代码正在通过控制台应用程序执行。根据“No Error”的 XML 响应，调用成功，但没有返回数据。当您尝试通过 Outlook 约会添加一个房间时，我们列出了数百个房间，因此不确定为什么会发生这种情况。

我尝试使用 EWS DLL 版本 1.2 和 2.0，使用默认凭据或传入凭据。在最初发布此消息后，我注意到响应标头说我们正在使用 Exchange 2012 SP2，因此我尝试更新我的代码以使用该 ExchangeVersion 枚举值，但结果没有变化。

我已在此 Exchange 服务器上成功使用 EWS 来读取邮箱，但以前从未使用过房间。

**C＃**

```
 ExchangeService es = new ExchangeService(ExchangeVersion.Exchange2010);
        es.TraceFlags = TraceFlags.EwsResponse | TraceFlags.EwsRequest;
        es.TraceEnabled = true;
        es.UseDefaultCredentials = true;
        es.AutodiscoverUrl("autodiscover@example.com");
        //this collection is empty after processing
        EmailAddressCollection eac = es.GetRoomLists(); 
```

**来自 Web 服务请求/响应的 XML 跟踪**

```
<Trace Tag="EwsRequest" Tid="9" Time="2013-03-13 20:39:41Z" Version="14.03.0032.000">
  <?xml version="1.0" encoding="utf-8"?>
  <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages" xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
    <soap:Header>
      <t:RequestServerVersion Version="Exchange2010" />
    </soap:Header>
    <soap:Body>
      <m:GetRoomLists />
    </soap:Body>
  </soap:Envelope>
</Trace>

<Trace Tag="EwsResponse" Tid="9" Time="2013-03-13 20:39:41Z" Version="14.03.0032.000">
  <?xml version="1.0" encoding="utf-8"?>
  <s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
    <s:Header>
      <h:ServerVersionInfo MajorVersion="14" MinorVersion="2" MajorBuildNumber="328" MinorBuildNumber="9" Version="Exchange2010_SP2" xmlns:h="http://schemas.microsoft.com/exchange/services/2006/types" xmlns="http://schemas.microsoft.com/exchange/services/2006/types" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
    </s:Header>
    <s:Body xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      <GetRoomListsResponse ResponseClass="Success" xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">
        <ResponseCode>NoError</ResponseCode>
        <m:RoomLists xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages" />
      </GetRoomListsResponse>
    </s:Body>
  </s:Envelope>
</Trace> 
```

GetRoomLists 上的 MSDN 文档：http: [//msdn.microsoft.com/en-us/library/dd899416 (v=exchg.140).aspx](http://msdn.microsoft.com/en-us/library/dd899416(v=exchg.140).aspx)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-13T21:50:24.947

好吧，我找到了原因/解决方案。混淆之处在于 GetRoomLists 不返回房间列表，而是返回房间列表列表或“房间列表”集合。这是一种特殊类型的分发列表，其中包含房间列表。

如此处所述，[http://social.msdn.microsoft.com/Forums/en-US/exchangesvrdevelopment/thread/4ff04c60-48c2-4a69-ab75-2383e73bfde2](http://social.msdn.microsoft.com/Forums/en-US/exchangesvrdevelopment/thread/4ff04c60-48c2-4a69-ab75-2383e73bfde2)，您要么需要设置房间列表，要么需要查询 AD 和检查 msExchRecipientDisplayType 属性以跟踪房间。

此链接显示了如何编写 LDAP 查询以返回房间的示例： http: [//social.msdn.microsoft.com/Forums/en-US/exchangesvrdevelopment/thread/e2d10953-a8f9-459c-8a0e-f10c2e568b26](http://social.msdn.microsoft.com/Forums/en-US/exchangesvrdevelopment/thread/e2d10953-a8f9-459c-8a0e-f10c2e568b26)

我为寻找房间而编写的代码：

```
private List<string> GetConfRooms(string filter)
{
    List<string> sRooms = new List<string>();

    DirectoryEntry deDomain = System.DirectoryServices.ActiveDirectory.Domain.GetComputerDomain().GetDirectoryEntry();
    DirectorySearcher dsRooms = new DirectorySearcher(deDomain);

    dsRooms.Filter = string.Format("(&(&(&(mailNickname={0}*)(objectcategory=person)(objectclass=user)(msExchRecipientDisplayType=7))))", filter);

    dsRooms.PropertiesToLoad.Add("sn");
    dsRooms.PropertiesToLoad.Add("mail");

    foreach (SearchResult sr in dsRooms.FindAll())
    {
        sRooms.Add(sr.Properties["mail"][0].ToString());
    }

    return sRooms;
} 
```

# ios - 如何将 iOS 应用程序从其他帐户上传到 App-Store？

> ID：15396074
> 
> 赞同：1
> 
> 时间：2013-03-13T20:43:41.147
> 
> 标签：ios, app-store

我写了一些 iOS 应用程序并使用了我的私人许可证：

*   开发配置文件
*   分发配置文件...

我使用了带有设备列表的 TestFlight，到目前为止一切都很好。

我的应用程序具有捆绑 ID：`org.fess.phone`

所以现在我需要使用不同的帐户将此应用程序上传到 App-Store 假设新公司过去上传了多个应用程序并具有不同的分发配置文件和捆绑 ID `com.some.company`：。

我从 iTunes Connect 注销并使用新帐户信息（邮件 + 密码）登录，然后查看公司上传的旧应用程序列表。

上传申请的步骤是什么？

当我尝试将我的应用程序注册到新帐户时，我收到“您没有符合条件的 iOS 应用程序包 ID”。

感谢帮助，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:49:38.600

1.  您需要将捆绑 ID 更改为`com.some.company.appname`.
2.  您还需要新帐户的登录名和开发人员证书。
3.  为该应用程序创建一个新的 App Store 分发配置文件并将其和证书安装在您的计算机上。

如果这是个人帐户，您可以提交给 Apple。如果是公司帐户，则只有团队负责人可以提交。

# java - Does jna.library.path use any environment variables?

> ID：15396076
> 
> 赞同：2
> 
> 时间：2013-03-13T20:43:46.460
> 
> 标签：java, jna

On OS X 10.8.2, I'm using JNA and gstreamer-java (through the Eclipse IDE) to load gstreamer libraries. At first I installed gstreamer using the SDK provided by [gstreamer.com](http://docs.gstreamer.com/display/GstSDK/Installing+on+Mac+OS+X). However, I uninstalled this and use Macports to install it.

The SDK's libs *were* installed to: `/System/Library/Frameworks/GStreamer.framework/Versions/0.10-x64/lib`

But that directory no longer exists.

Where Macports installed the libs to:

`/opt/local/lib`

Now, say I want to set java to know of this location via some environment variable. Is this possible? It seems so, because running this line:

`System.out.println( System.getProperty("jna.library.path"));`

Shows `/System/Library/Frameworks/GStreamer.framework/Versions/0.10-x64/lib`. But I cannot for the life of me figure out where that got set. It's not set as a runtime VM argument. My $PATH and $DYLD_LIBRARY_PATH, $LD_LIBRARY_PATH do not have this directory set. They actually have the path I want, `/opt/local/lib/` set which has no effect it seems. Running `env` shows no variables with the Framework path either.

So, `jna.library.path`. Is it set externally? How can I change it--without setting it at runtime or via java command-line arguments? Zero points for telling me to symlink.

**EDIT:**

Searching through gstreamer-java's files led me to `gstreamer-java.spec`, which has this line:

`sed -i [...] -e "s,\(run.jvmargs=-Djna.library.path=\).*,\1%{_libdir}:$(pkg-config --variable=pluginsdir gstreamer-0.10),"`

Running the contained command `pkg-config --variable=pluginsdir gstreamer-0.10` gets me this:

`/opt/local/lib/gstreamer-0.10`

Which is the correct path for plugins. Further running `pkg-config --print-variables gstreamer-0.10` gives me all these:

```
typelibdir
datarootdir
exec_prefix
pluginsdir
datadir
prefix
libdir
includedir
girdir
toolsdir 
```

Which are all at or under the correct `/opt/local/` directory.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T15:27:08.147

您是否尝试过在 Eclipse 之外运行？

# c# - Cannot run event handler in .cs file from ModalPopupExtender

> ID：15396078
> 
> 赞同：1
> 
> 时间：2013-03-13T20:43:52.680
> 
> 标签：c#, ajaxcontroltoolkit, modalpopupextender

I want to create a simple Yes/No popup window. So I have added a ModalPopupExtender to the .aspx page.

The popup panel's markup is:

```
<asp:Button ID="btn_yes" runat="server" Text="Yes" onclick="btn_yes_Click" />
  <br/>
  <br/>
<asp:Button ID="btn_no" runat="server" Text="No" /> 
```

For some reason, I cannot get into the function `btn_yes_Click`, not sure why. Do I have to use Javascript?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T20:54:39.560

我怀疑您还将 ModalPopupExtenders OkControlID 属性设置为“btn_yes”。正如您在这个[相关问题](https://stackoverflow.com/a/1166869/1558010)中看到的那样，这将导致 OnClick 事件不触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-27T14:54:18.097

有可能指定了 ModalPopupExtender 标记上的 OKControlID 属性。看看这个主题：[Modal PopUp 内的 OK 按钮的事件处理程序没有执行](https://stackoverflow.com/questions/12733658/the-event-handler-of-the-ok-button-inside-a-modal-popup-is-not-executing/21383578)

# javascript - Is it possible to exclude a module from a require optimizer build config but have that module and it's dependencies be optimized separately?

> ID：15396080
> 
> 赞同：3
> 
> 时间：2013-03-13T20:43:57.250
> 
> 标签：javascript, requirejs, r.js

So the situation is the following:

I have a bunch of page specific js files which I'm optimizing using r.js.

99% of them define a a module called core.js as a dependency. Core has 5 dependencies of it's own.

I wanted to leverage caching by excluding core from the optimised versions of the page js files.

So in my build.js I tried something along the lines of:

```
modules: [
  {
     name : 'modules/core'
  },
  {
     name: 'homepage',
     exclude : ['modules/core']
  }
] 
```

When I run the optimiser it optimises both modules/core & homepage just fine.

Going to a page that uses homepage.js the issue is that: core.js & it's dependencies are being loaded in individually, leading to 7 requests instead of 2.

In the above example, what I'm trying to achieve is: have homepage.js and it's dependencies optimised into a single file and have it load in an optimised version of core.js rather then loading in the core.js and it's dependencies separately.

Is that even possible?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T18:41:26.593

在构建之后，您有两个选择：

1）修改顶级加载，以便在任何其他加载之前加载模块/核心：

```
require(['modules/core'], function () {
  //Now do normal require stuff in here
}); 
```

如果您在主页完​​成加载之前看到其模块被请求，请在主页中使用另一个嵌套的 require() 调用。

2) 插入一个 require.config 块，将 core 中的所有模块指向 core 文件。当多个模块 ID 都指向它时，requirejs 只会获取一次 core.js 文件：

```
require.config({
  paths: {
    'mod/one': 'modules/core',
    'mod/two', 'modules/core',
    ...
  }
}); 
```

或者查看这种示例项目，该项目设置加载一个公共层，然后加载一个特定于页面的层，但无需在构建后进行源代码修改即可工作（仅使用 #1 的变体，但将其设置为在源代码中工作形式）：

[https://github.com/requirejs/example-multipage](https://github.com/requirejs/example-multipage)

# c - warning: type qualifiers ignored on function return type in gcc 4.1.2

> ID：15396083
> 
> 赞同：1
> 
> 时间：2013-03-13T20:44:19.757
> 
> 标签：c, linux, gcc

I am using gcc 4.1.2 on Linux, and I encountered the following warning:

```
warning: type qualifiers ignored on function return type 
```

I tried to use "-Wno-ignored-qualifiers" to get rid of this warning but it seems not supported:

```
cc1: error: unrecognized command line option "-Wno-ignored-qualifiers" 
```

Is there a way to disable such warnings in gcc 4.1.2?

Thanks a lot.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:20:09.680

找到了解决方案。利用：

```
-Wno-return-type 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-28T15:55:07.953

如此[处所示](https://stackoverflow.com/q/12052468/6309)， a`const char *`不会触发该警告*。*

如果`const char`可能的话，避免该警告的正确方法是将返回类型从 更改`const char`为`char`。

[请参阅Junio C Hamano (](https://github.com/gitster) [)](https://github.com/gitster)为 Git 2.16（2018 年第一季度）[提交的 ee5462d](https://github.com/git/git/commit/ee5462d6e71aad04628ccb8f078784468bfa4139)（2017 年 12 月 27 日）示例。[`gitster`](https://github.com/gitster)

> ## `sequencer.c``const`:从函数返回类型中删除“ ”
> 
> 使用`-Werror=ignored-qualifiers`，声称返回 " `const char`" 的函数会出现此错误：
> 
> ```
>  CC sequencer.o
> sequencer.c:798:19: error: type qualifiers ignored on function return
> type [-Werror=ignored-qualifiers]
>  static const char command_to_char(const enum todo_command command)
>                    ^ 
> ```

# java - Getting each letter in a String only once

> ID：15396091
> 
> 赞同：0
> 
> 时间：2013-03-13T20:44:43.513
> 
> 标签：java, char

I'm writing a Java program for Horspool's algorithm, and am having a bit of trouble. I'm trying to create an array of chars that will hold each letter in a string, but I don't want duplicates of the letters. Right now this is my code:

```
public static void main(String[] args) 
{
    Scanner scanIn = new Scanner (System.in);

    int count = 0;

    int count2 = 0;

    int inc = 0;

    //The text to search for the phrase in
    String t = "";

    //The phrase/pattern to search for
    String p = "";

    System.out.println(" ");
    System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
    System.out.println("Harspool's Algorithm: ");
    System.out.println("~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~");
    System.out.println(" ");
    System.out.println("Please enter the full text: ");
    t = scanIn.nextLine();
    System.out.println("Please enter the pattern to search for: ");
    p = scanIn.nextLine();

    char[] text = new char[t.length()];
    char[] pattern = new char[p.length()];
    char[] alphabet = new char[t.length()];

    for (int i = 0; i < alphabet.length; i++)
    {
        alphabet[i] = ' ';
    }

    for (int i = 0; i < text.length; i++)
    {
        text[i] = t.charAt(i);
    }

    for (int i = 0; i < pattern.length; i++)
    {
        pattern[i] = p.charAt(i);
    }

    while (inc < text.length)
    {
        for (int j = 0; j < text.length; j++)
        {
            if (text[inc] != alphabet[j])
            {
                count++;
            }
            if (count == p.length() - 1 && count2 < text.length)
            {
                alphabet[count2] = text[inc];
                count2++;
                count = 0;
                inc++;
            }
        }
    }

    for (int i = 0; i < alphabet.length; i++)
    {
        System.out.print(alphabet[i]);
    }
} 
```

I believe the problem is in the while loop, but I can't figure out what exactly is going wrong. Right now, it will print out the entire string passed in, when it should be printing each letter only once. Could someone please help?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T20:46:36.620

不是计算每个字符的出现次数，而是使用`Set<Character>`。一个集合包含独特的元素，因此您不会有重复。

您还可以通过执行或仅将 a 转换`Set`为数组`mySet.toArray(new String[mySet.size()]);``mySet.toArray(new String[0]);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T20:49:52.227

您的代码不容易阅读。您可以考虑改用以下算法。

```
int ccount[256];
int ii;
for(ii=0;ii<256;ii++) ccount[ii]=0;
for (ii = 0; ii < text.length; ii++)
{
    ccount[t.charAt(i)%256]++;
}
for (ii = 0; ii<256; ii++) {
    if(ccount[ii]>0) System.out.printf("%c", ii);
} 
```

编辑 - 确保`ccount`已初始化，并使用运算符捕获了 0-255 范围之外的字符`%`。

# python - Python subprocess.call - adding a variable to subprocess.call

> ID：15396092
> 
> 赞同：2
> 
> 时间：2013-03-13T20:44:45.623
> 
> 标签：python, subprocess, windowserror

I'm trying to write a simple program in Python that takes all the music files from my Downloads folder and puts them in my Music folder. I'm using Windows, and I can move the files using the cmd prompt, but I get this error:

`WindowsError: [Error 2] The system cannot find the file specified`

Here's my code:

```
#! /usr/bin/python

import os 
from subprocess import call

def main():
    os.chdir("C:\\Users\Alex\Downloads") #change directory to downloads folder

    suffix =".mp3"    #variable holdinng the .mp3 tag
    fnames = os.listdir('.')  #looks at all files

    files =[]  #an empty array that will hold the names of our mp3 files

    for fname in fnames:  
        if fname.endswith(suffix):
            pname = os.path.abspath(fname)
            #pname = fname
            #print pname

            files.append(pname)  #add the mp3 files to our array
    print files

    for i in files:
        #print i 
        move(i)

def move(fileName):
    call("move /-y "+ fileName +" C:\Music")
    return

if __name__=='__main__':main() 
```

I've looked at the [subprocess](http://docs.python.org/2/library/subprocess.html#frequently-used-arguments) library and countless other articles, but I still have no clue what I'm doing wrong.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T20:50:27.060

该`subprocess.call`方法获取参数列表而不是带有空格分隔符的字符串，除非您告诉它使用外壳程序，如果字符串可以包含来自用户输入的任何内容，则不推荐使用外壳程序。

最好的方法是将命令构建为列表

例如

```
cmd = ["move", "/-y", fileName, "C:\Music"]
call(cmd) 
```

这也使得将带有空格的参数（例如路径或文件）传递给被调用程序变得更加容易。

这两种方式都在[子流程文档](http://docs.python.org/3/library/subprocess.html)中给出。

你可以传入一个分隔字符串，但你必须让 shell 处理参数

```
call("move /-y "+ fileName +" C:\Music", shell=True) 
```

同样在这种情况下，对于 move 有一个 python 命令来执行此操作。`shutil.move`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:20:56.403

我没有直接回答你的问题，但对于这样的任务，[铅](http://plumbum.readthedocs.org/en/latest/)很棒，会让你的生活更轻松。`subprocess`的api不是很直观。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T03:11:49.973

可能有几个问题：

1.  `fileName`其中可能包含一个空格，因此该`move`命令只能看到文件名的一部分。

2.  if`move`是内部命令；你可能需要`shell=True`运行它：

```
from subprocess import check_call

check_call(r"move /-y C:\Users\Alex\Downloads\*.mp3 C:\Music", shell=True) 
```

要将`.mp3`文件从“下载”文件夹移动到“音乐”而不使用`subprocess`：

```
from glob import glob
from shutil import move

for path in glob(r"C:\Users\Alex\Downloads\*.mp3"):
    move(path, r"C:\Music") 
```

# php - How to retrieve data from a database as INT in SQL/PHP?

> ID：15396096
> 
> 赞同：0
> 
> 时间：2013-03-13T20:44:58.793
> 
> 标签：php, sql

I'm trying to create an imaginary ATM for a schoolproject but I'm stuck on something.
Everything works fine but I can take more money from my account than I have.

For example:
*I have 1300 euro's in the database and I input 1400 euro's my system happily updates my balance from 1300 to -100.*

And that's exactly what I don't want to happen. My code right no looks like this:

```
if (( /* i have no clue what comes here */ -$bedrag)>0)   // This should become something like: IF "value from database" > "amount"   (bedrag=amount btw)
                {
                echo "Het pinnen is gelukt!"; 
                $pinnen= "UPDATE rekeningen SET Saldo= Saldo - '$bedrag' WHERE Rekeningnr ='$nummer'";
                mysql_query($pinnen);
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:01:31.330

假设你有一个变量，比如说，`$current_balance`在操作之前存储帐户的余额，你可以这样：

```
if ($bedrag > $current_balance) {
 echo "You don't have enough money, sir!";
}
else {
 echo "Het pinnen is gelukt!"; 
 $pinnen= "UPDATE rekeningen SET Saldo= Saldo - '$bedrag' WHERE Rekeningnr ='$nummer'";
 mysql_query($pinnen);
} 
```

此外，最好对`Saldo`表中的字段设置检查约束以避免负值。只是说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T20:48:16.727

我认为您想*添加*，而不是减去您的金额`UPDATE`：

```
UPDATE rekeningen SET Saldo= Saldo + '$bedrag' WHERE Rekeningnr ='$nummer'
                                   ^ 
```

然后，您可以使用负值进行提款。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T20:48:40.413

您应该处理这个应用程序端。查询页面加载所需的信息，并将值保存在 sessionStorage 中：

```
window.onload = function() {
    sessionStorage.saldoval = "<?php $return['Saldo'] ?>";
} 
```

然后在提交之前使用 Javascript 验证它。

```
var saldo = document.getElementById('SaldoInput');

if(saldo.value > sessionStorage.saldoval){
    // do something to tell the user they're naughty
    return false;
} 
```

您不应该依赖数据库来执行这种验证。

# javascript - 事件 - eventsApi() 的主要目的？

> ID：15396097
> 
> 赞同：2
> 
> 时间：2013-03-13T20:45:05.130
> 
> 标签：javascript, backbone.js

从概念上讲，`eventsApi()`做什么？它是[Backbone](http://backbonejs.org/backbone.js)私有的，但用于 4 个公共事件方法 - `on()`、`once()`、`off()`和`trigger()`.

在每一个中，如果它返回一个非真实值，则调用它的方法将“提前”退出。

它做的一件事是确定调用方法的第二部分是否会执行。如果`name`不是真实的或不是复杂类型（对象或空格分隔的字符串），它将返回一个 true 允许该方法的第二部分运行。

从概念上讲，该功能的主要目的是什么`eventsApi`，因为我试图描述它在功能/逻辑上的作用？

**事件API**

```
 var eventsApi = function(obj, action, name, rest) {
    if (!name) return true;
    if (typeof name === 'object') {
      for (var key in name) {
        obj[action].apply(obj, [key, name[key]].concat(rest));
      }
    } else if (eventSplitter.test(name)) {
      var names = name.split(eventSplitter);
      for (var i = 0, l = names.length; i < l; i++) {
        obj[action].apply(obj, [names[i]].concat(rest));
      }
    } else {
      return true;
    }
  }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:10:11.433

就像[源代码](http://backbonejs.org/backbone.js)中的评论所说，它实现了事件 API 的更多奇特用途。

```
// Implement fancy features of the Events API such as multiple event
// names `"change blur"` and jQuery-style event maps `{change: action}`
// in terms of the existing API. 
```

因此，当您将事件 API 与事件映射一起使用时：

```
book.on({
  "change:title": titleView.update,
  "change:author": authorPane.update,
  "destroy": bookView.remove
}); 
```

该`eventsApi`函数检测到输入是一个对象，并`on`为传入的每个属性再次调用。

它处理的另一种情况是空格分隔的事件：

```
book.on("change:title change:author", ...); 
```

在这种情况下，`eventsApi`函数会检测到这种情况，并再次为传入的每个事件调用`on`一次。

# powershell - “存档” csv 到存档文件夹

> ID：15396106
> 
> 赞同：0
> 
> 时间：2013-03-13T20:45:56.597
> 
> 标签：powershell, csv, timestamp, archive

我有一个运行 sql 查询的脚本，然后将数据输出到

```
C:\audit\results.csv 
```

如果今天运行，除了上面的位置之外，我希望文件保存如下。

```
C:\audit\archive\results_20130313_0243.csv 
```

在我当前的脚本中，我有以下内容，但它看起来很麻烦并且步骤太多。

```
$archiveName = "results $(get-date -f yyyy-MM-dd).csv"
Copy-Item "C:\audit\results.csv" "C:\audit\archive\results.csv"
Rename-item "C:\audit\archive\results.csv" $archiveName 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:10:29.010

确实。像这样的东西就足够了：

```
cp "C:\audit\results.csv" "C:\audit\archive\results_$(get-date -f yyyyMMdd_HHmm).csv" 
```

# c# - unity3d 关闭粒子系统

> ID：15396119
> 
> 赞同：4
> 
> 时间：2013-03-13T20:46:37.460
> 
> 标签：c#, unity3d, particle-system

我正在尝试打开和关闭我创建的粒子系统。
我把它连接到一个预制件上。

我正在使用的代码如下

```
public ParticleSystem waterGun;

void Update () {
    if(Input.GetKey(KeyCode.W)){
        waterGun.enableEmission = true;
    }else if(Input.GetKeyUp(KeyCode.W)){
        waterGun.enableEmission = false;
    }
} 
```

我希望粒子系统在按住某个键时在 fps 前面播放，并在按下它时停止播放。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T11:17:39.400

尝试使用：

```
waterGun.Play(); 
```

和

```
waterGun.Stop(); 
```

而且，你的逻辑是颠倒的，就像Joetjah说的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-26T11:14:10.540

你说“waterGun prefab is given to it”但你应该将场景中粒子系统的一个实例分配给 waterGun，而不是 prefab。场景中不存在预制件。

# c++ - 用大括号调用构造函数

> ID：15396124
> 
> 赞同：17
> 
> 时间：2013-03-13T20:46:56.157
> 
> 标签：c++, c++11, constructor

关于 C++11 语法的简单问题。有一个示例代码（从[源](http://probablydance.com/2012/12/16/the-importance-of-stdfunction/)代码中减少了一个）

```
struct Wanderer
{
  explicit Wanderer(std::vector<std::function<void (float)>> & update_loop)
  {
    update_loop.emplace_back([this](float dt) { update(dt); });
  }
  void update(float dt);
};

int main()
{
  std::vector<std::function<void (float)>> update_loop;
  Wanderer wanderer{update_loop}; // why {} ???
} 
```

我想知道，如何使用大括号调用构造函数，例如`Wanderer wanderer{update_loop};`它既不是初始化列表，也不是统一初始化。这是什么东西？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-13T20:48:13.847

> 它既不是初始化列表，也不是统一初始化。这是什么东西？

你的前提是错误的。它是统一初始化，用标准术语来说，是*直接大括号初始化*。

除非存在接受 an 的构造函数`std::initializer_list`，否则使用大括号构造对象等同于使用括号。

使用大括号的优点是语法不受[Most Vexing Parse](http://en.wikipedia.org/wiki/Most_vexing_parse)问题的影响：

```
struct Y { };

struct X
{
    X(Y) { }
};

// ...

X x1(Y()); // MVP: Declares a function called x1 which returns
           // a value of type X and accepts a function that
           // takes no argument and returns a value of type Y.

X x2{Y()}; // OK, constructs an object of type X called x2 and
           // provides a default-constructed temporary object 
           // of type Y in input to X's constructor. 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-13T20:48:31.900

它只是 C++11 语法。您可以使用花括号初始化对象并调用其构造函数。您只需要记住，如果该类型具有 initializer_list 构造函数，则该构造函数优先。

# visual-studio-2010 - VS2010 和 VS2012 并行运行有什么风险？

> ID：15396128
> 
> 赞同：0
> 
> 时间：2013-03-13T20:47:07.890
> 
> 标签：visual-studio-2010, visual-studio-2012

官方是支持的。我明白了。我个人在VM中完成了它。我的问题是，VS2012.x 与 VS2010 SP'd 和 hotfix'd 并行运行是否有任何隐藏的陷阱？我记得读过有关 .NET 或 CLR 版本的问题，我不记得细节了，那是去年秋天。

我和我的同事真的很想搬到 2012 年，但我们有一位首席开发人员拒绝搬家。我们需要说服他，特别是因为我们有一个从 3.5 开始的大型项目，移动到 4.0（不会转到 4.5），但我们已经听到关于上述*可能*问题的传言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:04:36.027

.NET Framework 4.5 是就地更新。这意味着，一旦您安装了它，所有应用程序（包括 VS 2010）都将针对 .NET Framework 4.5 而不是 .NET Framework 4 运行。虽然为使 .NET Framework 4.5 向后兼容已经付出了巨大的努力，但仍有一些（大部分是次要的） ) .NET Framework 4 中行为发生变化的错误。我认为您应该考虑的最重要的事情是您是否要在您的应用程序中以 .NET Framework 4 为目标。问题是，当您以 .NET Framework 4 为目标时，您的 VS2012 将只允许您使用它们在 .NET Framework 4 中的 API，**但**您的应用实际上将使用 .NET Framework 4.5 运行时运行。我已经看到修复了 .NET Framework 4.5 中的合法错误（即不再抛出不正确的异常）的情况，但是当您针对真正的 .NET Framework 4 运行应用程序时，即使它针对 .NET Framework 4，该应用程序也无法运行因为错误仍然存​​在。请注意，如果您在盒子上安装了 .NET Framework 4.5，即使使用 VS 2010，您也会遇到相同的情况。我一直在运行 SxS 并且我没有遇到任何问题（但主要使用 VS2012 - 速度更快，更稳定）。我认为这里的主要内容是

*   如果您正在使用 .NET Framework 4，请确保在真正的 .NET Framework 4 上测试您的应用程序
*   尝试在有限的机器上使用 VS2010 运行 VS2012 sxs，如果您没有发现任何问题，请继续
*   如果您不使用 VS2012 不支持的任何功能，您也可以尝试运行 VS2012（在这种情况下，最大的风险是 .NET Framework 并且仅运行 VS2010 无论如何都不会保护您）

# solr - 如何在不知道停止键的情况下停止码头

> ID：15396129
> 
> 赞同：4
> 
> 时间：2013-03-13T20:47:08.047
> 
> 标签：solr, jetty

当我运行嵌入在 apache solr 中的码头时。我所做的只是

java -jar start.jar

它运行了我通过执行 ctrl-z 和 bg 将进程放入 bg

我试图阻止它

java -DSTOP.PORT=8983 -DSTOP.KEY=stop_jetty -jar start.jar --stop

而且我不确定上面的停止键是否正确。我没有收到错误并进入新的提示。该应用程序仍在该端口上侦听。

当我这样做的时候

java -DSTOP.PORT=8983 -jar start.jar --stop 它说它也需要 -DSTOP.KEY 属性。

我不确定是否要终止该进程。任何提示/建议？在哪里寻找停止键。我一开始没有提供任何钥匙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T20:58:51.193

如果服务器在没有 STOP.KEY 的情况下启动，那么您不能请求 --stop。

现在，话虽如此，您也可以随时对进程发出终止命令。

```
$ kill -TERM {pid of jetty} 
```

# r - R转置没有列标题的数据框

> ID：15396130
> 
> 赞同：1
> 
> 时间：2013-03-13T20:47:08.060
> 
> 标签：r

我使用 count(case..) 在 sql 中对年龄进行分组，最终得到以下数据框：

```
0-10    11-16   17-20   21-30   31-40   41-50   51-60   61-70   over70  age_unknown
60        285     161     368     476     453     247     101       62          114 
```

我想转置它并添加列标题“年龄范围”和“数字”，但据我所知，重塑功能需要在开始时存在标题，所以我不知道该怎么做。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T02:29:12.010

您可能正在寻找的是`stack`. 使用 Gavin 回答中的数据：

```
> stack(df)
   values         ind
1      60        0-10
2     285       11-16
3     161       17-20
4     368       21-30
5     476       31-40
6     453       41-50
7     247       51-60
8     101       61-70
9      62      over70
10    114 age_unknown 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:01:28.800

如果这是一个像这样的 1 行数据框：

```
df <- data.frame(matrix(c(60, 285, 161, 368, 476, 453, 247, 101, 62, 114), 
                        nrow = 1))
names(df) <- c("0-10", "11-16", "17-20", "21-30", "31-40", "41-50",
               "51-60", "61-70", "over70", "age_unknown")
df

> df
  0-10 11-16 17-20 21-30 31-40 41-50 51-60 61-70 over70 age_unknown
1   60   285   161   368   476   453   247   101     62         114 
```

然后一个简单的操作将以您想要的格式创建数据框：

```
df2 <- data.frame(age_range = names(df), number = as.numeric(df[1, ]))
df2

> df2
     age_range number
1         0-10     60
2        11-16    285
3        17-20    161
4        21-30    368
5        31-40    476
6        41-50    453
7        51-60    247
8        61-70    101
9       over70     62
10 age_unknown    114 
```

一个更简单的方法可能是转置`df`使用`t()`然后修复结果：

```
df3 <- t(df)
df3 <- cbind.data.frame(rownames(df3), df3)
rownames(df3) <- NULL
names(df3) <- c("age_range","number")
df3

> df3
     age_range number
1         0-10     60
2        11-16    285
3        17-20    161
4        21-30    368
5        31-40    476
6        41-50    453
7        51-60    247
8        61-70    101
9       over70     62
10 age_unknown    114
> str(df3)
'data.frame':   10 obs. of  2 variables:
 $ age_range: Factor w/ 10 levels "0-10","11-16",..: 1 2 3 4 5 6 7 8 10 9
 $ number   : num  60 285 161 368 476 453 247 101 62 114 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:01:11.063

如果您有一些连续可变的*年龄*并且您想要的切割点是已知的：

```
age <- rnorm(100,40,10)
cutpoints <- c(0,10,20,30,40,50,60,70,max(age))

fage <- table( cut(age, breaks=cutpoints) ) 
```

*fage*本身可能就是您所需要的。但是，如果您真的想要数据框中的数据：

```
df <- data.frame(age=names(fage), frequency=as.vector(fage)) 
```

# ruby - 解析歌曲/用户 url 时出现 Soundcloud API 401 错误

> ID：15396134
> 
> 赞同：4
> 
> 时间：2013-03-13T20:47:13.567
> 
> 标签：ruby, soundcloud

每当我尝试解析 url 以获取歌曲的 id 时，它都会返回 401 错误。我的客户端适用于其他操作（GET：/me，POST：/me/followings/[id]）。这是我与 soundcloud gem 一起使用的代码：

```
client.get('/resolve', url: "http://soundcloud.com/stuart-mckeown/darius-bassiray-consortium-of") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T17:21:32.213

我花了一点时间才弄清楚，但您还需要发送客户端 ID：

`client.get('/resolve', :url => url, :client_id => ENV['SOUNDCLOUD_ID'])`

# c++ - c++ 如果网格中的每个布尔值都为真，那么

> ID：15396135
> 
> 赞同：-1
> 
> 时间：2013-03-13T20:47:13.973
> 
> 标签：c++, grid, loops

试图解决这个问题，但我的程序不断崩溃（所以我只是从头开始重新做我的循环）。

我需要做的：如果我的网格中的每个坐标都设置为真，做点什么。否则，做其他事情，直到每个坐标都为真。

伪代码：

```
Grid<bool> g(25, 25);

while (1) {
if (every coordinate is true) {break;}

//do stuff

} 
```

你们能帮帮我吗？特别是“如果（每个坐标都是真的）”公式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:53:35.950

我会做类似的事情：

```
bool every_coordinate_is_true(Grid<bool> g)
{
  bool b = true;
  foreach(x from grid) b &= x;
  //here b is true iif all elements are true
  return b;
} 
```

当然，这一切都取决于 Grid 是如何定义的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T22:20:06.633

如果您的网格支持迭代器，您可以使用[std::all_of](http://en.cppreference.com/w/cpp/algorithm/all_any_none_of)：

```
Grid<bool> g(25, 25);
// If every coordinate in my grid is set to true, do something
bool all_true = std::all_of(g.begin(), g.end(), [](const coordinate& c) -> bool
    { return c.is_true(); });
if(all_true)
    do_something();
else
    do_something_else(); 
```

现在将其包装在 all_true 上的循环中，然后就可以设置了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:03:35.217

您用 C++ 标记了您的问题，但发布的代码都不像 C++。你具体使用什么语言来解决这个问题？

# php - 具有完全相同输入的哈希密码不会输出相同的值

> ID：15396139
> 
> 赞同：0
> 
> 时间：2013-03-13T20:47:24.533
> 
> 标签：php, encryption, sha256

如果您在我的网站上注册，我正在尝试对密码进行哈希处理，但它不起作用。这是我在注册时散列密码的代码：

```
$escapedName = mysql_real_escape_string($_POST['user']); 
$escapedPW = mysql_real_escape_string($_POST['password']);

$salt = bin2hex(mcrypt_create_iv(32, MCRYPT_DEV_URANDOM));

$hashedPW = hash('sha256', $escapedPW . $salt); 
```

然后我只是将它插入数据库（散列密码和盐）。例如，当我散列时`Sas`，使用以下盐：
`abac7ad23185ad19967f0d13e962197962782f0b7ec32d9889c27a93a9e800fa`
这是散列密码：
`8ca5c5f31fafbf382533dbcbfc22b3635d776ec7770c7eac58d8ef9f1fa3613c`

但是当我尝试在登录时使用完全相同的密码和盐对密码进行哈希处理时，这将成为哈希密码：
`6eb4b16444f18cee19db32bd29a39970e3019c5b1972a982ae4cb9a59642dffc`

这是我用来登录的代码：

```
$escapedName = mysql_real_escape_string($_POST['user']);
$escapedPW = mysql_real_escape_string($_POST['password']);
$saltQuery = mysql_query("SELECT salt FROM members WHERE user='{$escapedName}'");
while($result = mysql_fetch_assoc($saltQuery)) {
    $salt = $result['salt'];
}

$hashedPW = hash('sha256', $escapedPW . $salt);

$sql = mysql_query("SELECT * FROM members WHERE user='$escapedName' AND pass='$hashedPW'; ");
while ($res = mysql_fetch_assoc($query2)) {
    $username = $res['user'];
    $PW = $res['pass'];
} 
```

我希望这不是太多的代码，我也希望你能理解我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:27:07.557

`salt`抱歉，我无法发表评论，但有消息告诉我，您的数据库中的列存在长度限制。

示例：salt 字段可能只允许 64 个字符，而生成的 salt 可能更长，因此当您保存 salt 时，它会被修剪，最终会更改散列密码。

如果是这种情况，您可能需要在保存之前修剪盐。

我建议使用[PDO](http://us.php.net/manual/en/book.pdo.php)对您的数据库进行查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:34:39.897

由于某种原因，您对哈希函数的输入必须不同。

在对两个用例（创建用户和登录）进行哈希处理之前，添加打印输入的日志输出消息。还要确保在日志中的输入周围加上引号以显示空格问题。

比较两种情况下的原始输入和散列函数的输出，会有所不同。如果没有差异，并且哈希的输出相同，那么您的查询中存在问题，即在登录案例中查找用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:19:56.813

无论您在做什么，如果您希望哈希值相同，那都是不安全的！有关正确的密码哈希，请参阅[http://php.net/crypt](http://php.net/crypt)。

一切你需要的：

```
function check_password($password) {  
    ...//get db password to compare
    if (crypt($post_password, $db_results[0]['password']) == $db_results[0]['password']) {  
        return true;  
    } else { return false; }
} 
```

# struts2 - 未找到 Struts URL

> ID：15396141
> 
> 赞同：-1
> 
> 时间：2013-03-13T20:47:27.547
> 
> 标签：struts2

我是 Javastruts 的新手，正在尝试设置我的第一个 javastruts 项目。

我已经安装了 Tomcat 并进行了配置，但是在尝试运行程序时出现以下错误，

**

*   错误

**

```
java.lang.NoClassDefFoundError: ognl/PropertyAccessor
    at com.opensymphony.xwork2.config.impl.DefaultConfiguration.createBootstrapContainer(DefaultConfiguration.java:300)
    at com.opensymphony.xwork2.config.impl.DefaultConfiguration.reloadContainer(DefaultConfiguration.java:210)
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:67)
    at org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:429)
    at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:471)
    at org.apache.struts2.dispatcher.ng.InitOperations.initDispatcher(InitOperations.java:74)
    at org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.init(StrutsPrepareAndExecuteFilter.java:51)
    at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:295)
    at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:422)
    at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:115)
    at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4072)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4726)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: java.lang.ClassNotFoundException: ognl.PropertyAccessor 
```

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>Struts2Starter</display-name>
  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>default.html</welcome-file>
    <welcome-file>default.htm</welcome-file>
    <welcome-file>default.jsp</welcome-file>
  </welcome-file-list>

<filter>
    <filter-name>struts2</filter-name>
    <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class>
</filter>

<filter-mapping>
    <filter-name>struts2</filter-name>
    <url-pattern>/*</url-pattern>   
</filter-mapping>

</web-app> 
```

struts.xml

```
<?xml version="1.0" encoding="UTF-8"?>

<struts>
    <package name="default" extends="struts-default">
        <action>name="getTutorial" class="org.prem.javabrain.action.TutorialAction"</action>
            <result name="success">/success.jsp</result>    
            <result name="failure">/error.jsp</result>
    </package>
</struts> 
```

Tutorialaction.java

```
package org.prem.javabrain.action;

public class TutorialAction {
    public String execute() {
        System.out.println("Hello from execute");
        return "success";
    }
} 
```

图书馆：

```
struts2-core-2.3.8.jar
xwork-core=2.3.8.jar
commons-fileupload-1.2.2.jar
commons-io-2.0.1.jar
commons-lang-2.4.jar
commons-lang3-3.1.jar
commons-logging-1.1.1.jar
commons-logging-api.1.1.jar
freemarker-2.3.19.jar
javassist-3.1.1.0.GA.jar

New Error:

Mar 16, 2013 1:42:22 PM com.opensymphony.xwork2.util.logging.commons.CommonsLogger error
SEVERE: Document is invalid: no grammar found. at (null:3:8)
org.xml.sax.SAXParseException; systemId: file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml; lineNumber: 3; columnNumber: 8; Document is invalid: no grammar found.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl$NSContentDriver.scanRootElementHook(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl.parse(Unknown Source)
    at com.opensymphony.xwork2.util.DomHelper.parse(DomHelper.java:113)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadConfigurationFiles(XmlConfigurationProvider.java:1007)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadDocuments(XmlConfigurationProvider.java:165)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.init(XmlConfigurationProvider.java:132)
    at com.opensymphony.xwork2.config.impl.DefaultConfiguration.reloadContainer(DefaultConfiguration.java:214)
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:67)
    at org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:429)
    at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:471)
    at org.apache.struts2.dispatcher.ng.InitOperations.initDispatcher(InitOperations.java:74)
    at org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.init(StrutsPrepareAndExecuteFilter.java:51)
    at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:295)
    at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:422)
    at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:115)
    at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4072)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4726)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)

Mar 16, 2013 1:42:22 PM com.opensymphony.xwork2.util.logging.commons.CommonsLogger error
SEVERE: Dispatcher initialization failed
Unable to load configuration. - file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml:3:8
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:70)
    at org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:429)
    at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:471)
    at org.apache.struts2.dispatcher.ng.InitOperations.initDispatcher(InitOperations.java:74)
    at org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.init(StrutsPrepareAndExecuteFilter.java:51)
    at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:295)
    at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:422)
    at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:115)
    at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4072)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4726)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: Unable to load file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml - file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml:3:8
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadConfigurationFiles(XmlConfigurationProvider.java:1012)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadDocuments(XmlConfigurationProvider.java:165)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.init(XmlConfigurationProvider.java:132)
    at com.opensymphony.xwork2.config.impl.DefaultConfiguration.reloadContainer(DefaultConfiguration.java:214)
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:67)
    ... 22 more
Caused by: Document is invalid: no grammar found. - file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml:3:8
    at com.opensymphony.xwork2.util.DomHelper.parse(DomHelper.java:115)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadConfigurationFiles(XmlConfigurationProvider.java:1007)
    ... 26 more
Caused by: org.xml.sax.SAXParseException; systemId: file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml; lineNumber: 3; columnNumber: 8; Document is invalid: no grammar found.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl$NSContentDriver.scanRootElementHook(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl.parse(Unknown Source)
    at com.opensymphony.xwork2.util.DomHelper.parse(DomHelper.java:113)
    ... 27 more

Mar 16, 2013 1:42:22 PM org.apache.catalina.core.StandardContext filterStart
SEVERE: Exception starting filter struts2
Unable to load configuration. - file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml:3:8
    at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:483)
    at org.apache.struts2.dispatcher.ng.InitOperations.initDispatcher(InitOperations.java:74)
    at org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter.init(StrutsPrepareAndExecuteFilter.java:51)
    at org.apache.catalina.core.ApplicationFilterConfig.getFilter(ApplicationFilterConfig.java:295)
    at org.apache.catalina.core.ApplicationFilterConfig.setFilterDef(ApplicationFilterConfig.java:422)
    at org.apache.catalina.core.ApplicationFilterConfig.<init>(ApplicationFilterConfig.java:115)
    at org.apache.catalina.core.StandardContext.filterStart(StandardContext.java:4072)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4726)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:840)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1057)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:463)
    at org.apache.catalina.core.StandardService.start(StandardService.java:525)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:754)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:595)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)
Caused by: Unable to load configuration. - file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml:3:8
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:70)
    at org.apache.struts2.dispatcher.Dispatcher.init_PreloadConfiguration(Dispatcher.java:429)
    at org.apache.struts2.dispatcher.Dispatcher.init(Dispatcher.java:471)
    ... 20 more
Caused by: Unable to load file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml - file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml:3:8
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadConfigurationFiles(XmlConfigurationProvider.java:1012)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadDocuments(XmlConfigurationProvider.java:165)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.init(XmlConfigurationProvider.java:132)
    at com.opensymphony.xwork2.config.impl.DefaultConfiguration.reloadContainer(DefaultConfiguration.java:214)
    at com.opensymphony.xwork2.config.ConfigurationManager.getConfiguration(ConfigurationManager.java:67)
    ... 22 more
Caused by: Document is invalid: no grammar found. - file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml:3:8
    at com.opensymphony.xwork2.util.DomHelper.parse(DomHelper.java:115)
    at com.opensymphony.xwork2.config.providers.XmlConfigurationProvider.loadConfigurationFiles(XmlConfigurationProvider.java:1007)
    ... 26 more
Caused by: org.xml.sax.SAXParseException; systemId: file:/C:/Users/premvidya/workspace/.metadata/.plugins/org.eclipse.wst.server.core/tmp0/wtpwebapps/Struts2Starter/WEB-INF/classes/struts.xml; lineNumber: 3; columnNumber: 8; Document is invalid: no grammar found.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl$NSContentDriver.scanRootElementHook(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl$PrologDriver.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(Unknown Source)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl.parse(Unknown Source)
    at com.opensymphony.xwork2.util.DomHelper.parse(DomHelper.java:113)
    ... 27 more

Mar 16, 2013 1:42:22 PM org.apache.catalina.core.StandardContext start
SEVERE: Error filterStart
Mar 16, 2013 1:42:22 PM org.apache.catalina.core.StandardContext start
SEVERE: Context [/Struts2Starter] startup failed due to previous errors
Mar 16, 2013 1:42:22 PM org.apache.coyote.http11.Http11Protocol start
INFO: Starting Coyote HTTP/1.1 on http-8080
Mar 16, 2013 1:42:22 PM org.apache.jk.common.ChannelSocket init
INFO: JK: ajp13 listening on /0.0.0.0:8009
Mar 16, 2013 1:42:22 PM org.apache.jk.server.JkMain start
INFO: Jk running ID=0 time=0/15  config=null
Mar 16, 2013 1:42:22 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 1715 ms 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T22:26:07.167

您缺少 OGNL 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:17:38.767

首先，您需要更改`struts.xml`文件。将其更改为：

```
 <action name="getTutorial" class="org.prem.javabrain.action.TutorialAction">
        <result name="success">/success.jsp</result>    
        <result name="failure">/error.jsp</result>
    </action> 
```

其次，您需要检查所有库（尤其是 jar `ognl jar`）是否在您的类路径中。可能，您可以发布您在类路径中拥有的 jar 列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-05T07:29:26.437

struts.xml 文件不正确。结果标签应该在动作标签内。

我建议您在 xml 文件中使用 DTD 定义，这将有助于检查 XML 文件的语法。在 struts.xml 文件的第一行之后添加这一行：

```
 <!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"  "http://struts.apache.org/dtds/struts-2.0.dtd"> 
```

此 DTD 将帮助 IDE 在您进行开发时向您建议正确的 XML 语法。

所以最终的 struts.xml 文件看起来有点像这样：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"  "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
    <package name="default" extends="struts-default">
        <action>name="getTutorial" class="org.prem.javabrain.action.TutorialAction">
            <result name="success">/success.jsp</result>    
            <result name="failure">/error.jsp</result>
        </action>
    </package>
</struts> 
```

希望这可以帮助 ：）

# android - 重新连接到 Android Socket 以等待服务器

> ID：15396142
> 
> 赞同：1
> 
> 时间：2013-03-13T20:47:29.067
> 
> 标签：android, sockets

所以我在 Windows 中有一个用 C++ 编程的 TCP 服务器和一个用 JAVA、Android 4.0.4 编写的客户端。

在 Android 中，我是这样连接的：

```
public boolean sendConnectRequest()
{
    while (isSocketConnected == false)
    {
        try {
            if(comSocket == null)
            comSocket = new Socket("192.168.0.1",1531);
            isSocketConnected = comSocket.isConnected();
            if (isSocketConnected) {
                out = comSocket.getOutputStream();
                in = comSocket.getInputStream(); 
            }
            else
                comSocket.close();
        } 
        catch (IOException ex)
        {
            Log.e("TCP Error", ex.getLocalizedMessage());
        }
    }
return true;
} 
```

在第一次连接到服务器时，我通常对此代码没有任何问题。

当我断开与服务器的连接时，我称之为：

```
public void closeConnection() {
    if (comSocket != null)
    {
        try {
            comSocket.close();
            isSocketConnected = false;
            if (out != null)
                out.close();
            if (in != null)
                out.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

所以这就是问题所在……我点击了智能手机上的主页按钮，这使程序暂停。我再次启动程序，它在活动中调用恢复函数，进而启动重新连接过程。尝试连接，我没有收到任何错误。但是，我的 Windows 服务器没有记录连接。在 Windows 中，我知道我仍然被阻止：

```
SOCKET connectionSocket = accept(tcpNetworkData->socket, (struct sockaddr*)&from, &fromlen); 
```

我相信这是正常的。当我在 Android 端处于调试模式时，我注意到它立即从以下行返回：comSocket = new Socket("192.168.0.1",1531); 这应该向我表明已建立连接。

如果您到目前为止一直关注我...我还应该说，如果我关闭服务器，客户端会通过关闭连接并打开一个新连接来重置。这次 comSocket = new Socket("192.168.0.1",1531) 没有按预期阻塞，继续执行。这显然是错误的。我认为这是一个资源释放问题，但为什么呢？使用 Winsock，你可以用这行代码解决这个问题：

```
int so_reuseaddr = TRUE;
setsockopt(networkData->socket, SOL_SOCKET, SO_REUSEADDR, (const char*)&so_reuseaddr,sizeof(so_reuseaddr)); 
```

你可以用 Android 做类似的事情还是必须做？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:20:07.307

根据[javadoc](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/Socket.html#Socket%28java.net.InetAddress,%20int%29)，一旦您调用构造函数，就会建立连接。

> ```
>  Socket(InetAddress address, int port)
>       Creates a stream socket and connects it to the specified port number at the specified IP address. 
> ```

当您按下主页按钮时，您的应用程序会进入后台，但不会立即被终止，因此`comSocket`当您返回应用程序时，您的应用程序可能不为空。在这种情况下，您不会再次调用构造函数，因此您不会重新连接到服务器。你应该做的是

```
if(comSocket == null){
        comSocket = new Socket("192.168.0.1",1531);
}else{
     comSocket.connect(new InetSocketAddress("192.168.0.1",1531));
} 
```

（请放置大括号:-)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:23:04.547

需要记住的是 isConnected() 方法对于检测远程端何时关闭连接不是很可靠，（[这里是一个例子）](https://stackoverflow.com/questions/151590/java-how-to-detect-a-remote-side-socket-close/8268497#8268497)。

您必须通过读取或写入相关的输入/输出流来解决这个问题。

**尝试使用 PrintWriter.checkError()，一旦客户端无法再连接到服务器**，它将返回 true 。

# python - 在 Python NLTK 中使用一致性来返回字典中找到的键的值

> ID：15396143
> 
> 赞同：-1
> 
> 时间：2013-03-13T20:47:38.567
> 
> 标签：python, dictionary, nltk

我想使用索引查找文本中单词或短语的实例，然后在字典中查找找到的单词/短语并返回相应的值。这是我到目前为止的代码。

```
from __future__ import division
import nltk, re, pprint
OutFileName = "shark_uri.txt"
OutFile = open(OutFileName, 'w')
book1 = open('shark_test.txt', 'rU').read() 
token1 = nltk.word_tokenize(book1)
text1 = nltk.Text(token1)
LineNumber = 0
for k, v in bio_dict.iteritems(): 
        text1.concordance(k)
    #if k is found then print v, else go on to next k
    if k #is found:
        OutFile.write(v)
        OutFile.write('\n')
        LineNumber += 1
    else
        LineNumber += 1
OutFile.close() 
```

这段代码应该是在 Shark_test.txt 文件中读取关于鲨鱼的一段。bio_dict 包含这样的键值对

```
'ovoviviparous':'http://dbpedia.org/resource/Ovoviviparity', 
'predator':'http://dbpedia.org/resource/Predation', 
```

键代表程序正在查找的单词或短语。该值是对应于单词/短语的 DBpedia URI。这个想法是，当在文本中找到像“predator”这样的词时，程序将返回 Predation 的 DBpedia URI。我得到了很多奇怪的结果，我认为这是因为我需要告诉程序如果找到 k 则返回 v，否则转到下一个 k。我在上面的代码块中为此放置了一个占位符。我不太清楚如何用 Python 来表达这个。如果 k == True 会是这样吗？如果没有这个条件，它似乎只是通过字典打印所有值，而不管是否找到键。有什么建议吗？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:27:24.140

您的代码现在的工作方式是遍历`bio_dict`字典中的所有键、值对，然后`concordance`用于打印存在的`text1`行`k`。这里要注意的重要一点是 using`concordance` **不返回任何内容**，而只是*打印*。因此，即使您尝试使用返回值（实际上并没有在您的代码中），您也不能。当您编写 时`if k:`，这将始终是`True`- 假设您的键是非空字符串（没有键评估为`False`）。

如果我正确理解你的问题，你真的不应该使用`concordance`。相反，请执行以下操作：

```
for word in token1:                        # Go through every word in your text
    if word in bio_dict:                   # Check if the word is in the dict
        OutFile.write(bio_dict[word]+'\n') # Output the value to your file 
```

此外，您的`LineNumber`计数器实际上并没有计算您想要的内容，因为您正在一次读取输入文件并将整个内容标记为`token1`. 但是由于您实际上并未使用`LineNumber`，因此您可以删除该变量并仍然获得所需的输出。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T01:23:33.860

我设法用这段代码得到了我需要的东西。

```
from __future__ import division
import urllib
import re, pprint, time
in_file_name = "shark_id.txt"
in_file = open(in_file_name, 'r')
out_file_name = "shark_uri.txt"
out_file = open(out_file_name, 'w')

for line in in_file:                                                    
line = line.strip()                                             
address = 'http://eol.org/api/data_objects/1.0/' + line + '.xml'    
web_content = urllib.urlopen(address)                           
results = web_content.read().lower()                                        
temp_file_name = "Temp_file.xml"                                    
temp_file = open(temp_file_name, 'w')                               
temp_file.write(results)    
temp_file.close()                                           
print line
print len(results)              
temp_file = open('Temp_file.xml')
data = temp_file.read()
temp_file.close()
for k, v in bio_dict.iteritems():                           
    if k in data:                       
        out_file.write(line + ',')                                  
        out_file.write(k + ',')                                 
        out_file.write(v)                                       
        out_file.write('\n')                                        
time.sleep(.5)
in_file.close()                                                     
out_file.close() 
```

# python - 在 Python 2.7 中访问带有空格的 unicode 键

> ID：15396147
> 
> 赞同：1
> 
> 时间：2013-03-13T20:47:47.677
> 
> 标签：python, xlrd, dictionary, python-unicode

我正在做一个项目，我试图在其中获取 Excel 文件（通过 读取`xlrd`）和地理编码地址。为此，我使用了一个目录列表，每个目录条目都是一个单独的站点。

类似的东西`addressList[0]`会导致以下结果：

```
{text:u'First name ': u'John',
 text:u'Site City': u'Indio',
 text:u'Site State': u'CA',
 text:u'Last name': u'Doe',
 text:u'Site Phone': u'760-555-1234',
 text:u'Site Zip': u'92201',
 text:u'Site Address1': u'1313 Mockingbird Lane',
 text:u'Site Name': u'Tyrell Industries',
 text:u'Hours': u'Mon-Fri 12:00-1:00',
 text:u'Affliation': u'Boys & Girls Clubs of America'} 
```

（我刚刚在电子表格中意识到，“隶属关系”拼写错误。嗯。）

现在，通过环顾四周，我知道[Python 中的键中可以有空格](https://stackoverflow.com/questions/13474957/spaces-in-python-dictionary-keys)，这应该不是问题。但是输入`addressList[0]['Site Phone']`会导致 KeyError。事实上，尝试获取“Hours”键的值会导致类似的 KeyError。

基于关于[Unicode keys 的问题](https://stackoverflow.com/questions/1254454/fastest-way-to-convert-a-dicts-keys-values-from-unicode-to-str)，我尝试了以下方法：

```
STRING_DATA = dict([(str(k), v) for k, v in addressList[0].items()]) 
```

这导致了一个包含以下条目的字典：

```
"text:u'Site Name'": u'Tyrell Industries', 
```

这是合理的，除了我现在必须通过 访问该值`STRING_DATA["text:u'Site Name'"]`，这似乎很痛苦。

有没有更快/更简单的方法来使用这些键？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T20:54:53.380

`text:u'First name ': u'John',`不是一个有效的`dict`条目。

`text:`像这样的键之前有前缀的原因`text:u'First Name'`是，因为您使用`xlrd cell`s 作为 dict 的键。

您应该使用明确地从单元格中提取值`cell.value`

就像是：

`new_keys = [k.value for k in addresslist[0]]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T10:39:07.283

获取列标题所需要做*的*就是：

```
column_names = site_sheet.row_values(rowx=0, end_colx=NUMBER_OF_COLUMNS) 
```

然而，标题似乎需要一些擦洗，例如`u'First name '`，`u'Last name'`可以通过删除前导和尾随空格并强制标题大小写来与其他标题保持一致：

```
column_names = [x.strip().title()
    for x in site_sheet.row_values(row=0, end_colx=NUMBER_OF_COLUMNS)] 
```

# sharepoint - 使用 SimplePie 或类似工具阅读 NTLM 身份验证的提要？

> ID：15396148
> 
> 赞同：0
> 
> 时间：2013-03-13T20:47:48.310
> 
> 标签：sharepoint, rss, ntlm, simplepie, rss-reader

在我们的防火墙内，我正在尝试使用 SimplePie 处理来自我公司使用的各种平台的 RSS 提要。我没有任何运气阅读带有 SimplePie 的 SharePoint RSS。我们的 SharePoint 通过 NTLM 进行了身份验证，我怀疑 SimplePie 不支持 NTLM，这可以解释我的问题。

谁能确认 SimplePie 不支持 NTLM？

如果 SimplePie 不支持 NTLM，我是否可以使用类似的工具包来阅读我们的 SharePoint RSS 源？谢谢一堆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T03:20:41.397

没错，SimplePie 不支持 NTLM 身份验证。

处理这个问题的最好方法（在我看来）是对类进行子`SimplePie_File`类化并对其进行自定义，然后通过[`$feed->set_file_class()`](http://simplepie.org/api/class-SimplePie.html#_set_file_class). 有关如何执行此操作的示例，请查看[WordPress 的自定义 HTTP 类](http://core.trac.wordpress.org/browser/trunk/wp-includes/class-feed.php#L57)，它将 SimplePie 接口映射到 WordPress 的 HTTP 类。

# html - 为什么我的代码什么都不做？

> ID：15396151
> 
> 赞同：1
> 
> 时间：2013-03-13T20:47:59.630
> 
> 标签：html, razor, asp.net-mvc-4

当我运行调试器时，我得到 0 个错误，布局加载，并且“电影”显示出来，但实际上没有别的。我对 MVC 还很陌生，我们将不胜感激。视图、模型和控制器的代码如下。该数据库包含 100 多个项目和一个链接列表，但它只是空白。

看法：

```
@model IEnumerable<MyWebPage.Models.Movie>

     <h1>Movies</h1>
     <ul>
         @foreach (var item in Model.OrderBy(x => x.Name))
         {
          <li>@Html.ActionLink(item.Name, "Movies", new { id = item.ID })</li>
         }
     </ul> 
```

控制器：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using MyWebPage.Models;

namespace MyWebPage.Controllers
{
    public class HomeController : Controller
    {
        private MoviesDbContext db = new MoviesDbContext();

        public ActionResult Index()
        {  

            return View(db.Movies.ToList());
        }

        public ViewResult Movies(int id)
        {
            Movie moviesdb = db.Movie.Find(id);
            return View(moviesdb);
        }

    }
} 
```

模型：

```
using System;
using System.Data.Entity;

namespace MyWebPage.Models
{
    public class Movie
    {
        public int ID { get; set; }
        public string Name { get; set; }
        public string Cover { get; set; }
    }

    public class MoviesDbContext : DbContext
    {
        public DbSet<Movie> Movies { get; set; }
    }

} 
```

提前致谢！

# algorithm - 有非确定性的领导人选举算法吗？

> ID：15396156
> 
> 赞同：1
> 
> 时间：2013-03-13T20:48:27.117
> 
> 标签：algorithm, leader

我想知道是否存在确保终止的非确定性领导者选举算法（在单向环中）。我想不出一个，也找不到一个不确定的。我发现的一些是：

*   选择具有最高进程 ID 的节点作为领导者（确定性）并终止。

*   随机决定一个节点是否想成为leader，如果环中有另一个节点想成为leade，则重新启动整个过程。这个不会终止，但有终止的概率。

有人可以给我一些关于如何创建分布式非确定性领导选举算法的提示吗？也许用外行的方式解释它。

感谢一切！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:17:08.720

不存在同时具有保证终止和保证正确性（只有一个领导者）的概率（匿名）领导者选举算法。如果我没记错的话，你会在 N. Lynch 关于分布式系统的书中找到一个证明。

然而，对于足够长的算法运行时间，存在对于不终止的概率限制为零的算法。此外，预期的运行时间相当短（AFIR，对于 k 个启动器，大约为 ln(k)）。

这种算法的主要思想遵循您的第二种方法。但是，不要简单地在出现多个领先者的情况下重新启动该过程，而只允许上一轮的获胜者成为下一轮的候选人。

**编辑1-3：**

如果您要求进行非匿名领导人选举，有几种概率算法可以保证终止。例如，采用正常的环算法并以一定的概率延迟消息，ID越小延迟的机会越大。这样，获胜机会低的消息会被更早地删除，从而导致整体消息更少。

如果您想为非匿名成员提供不同的结果，您可以例如使用两阶段算法：

1.  执行经典的领导人选举 => 具有最高 ID 的节点 A 获胜
2.  让 A 掷骰子来确定实际的领导者。

幸运元素也可以分布：

1.  任何节点都知道身份集（S）（如果不知道，使用泛洪算法来判断）
2.  所有节点随机选择一个 ouf S 的 ID 并将其发送给任何其他节点
3.  最常被命名的 ID 获胜。如果有多个这样的 ID，则以确定的方式选择其中一个，例如中位数。

两种算法都允许终止和非确定性结果。但是，第一个具有较低的平均消息复杂度（*n* **log** *n*与*n²*；最坏情况的复杂度相同）并且更公平（即，ID 获胜的概率是均匀分布的，而第二个则不是这样算法）。我很确定，至少最后一个缺点可以通过更复杂的算法消除，但这里的问题是这种算法的普遍存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T19:42:04.020

根据我对问题的理解，您实际上并不是在寻找一种选举算法，而只是一种分布式算法，可以公平地随机选择一个客户作为“领导者”，其中没有客户子集可以共同作弊。

这实际上很容易。将每个客户视为一副牌中的一张牌，然后使用[心理扑克](http://en.wikipedia.org/wiki/Mental_poker#Shuffling_cards_using_commutative_encryption)算法*（一种分布式算法，公平且随机地打乱一副牌）*对其进行洗牌。然后只需将第一张牌作为领导者。

# python - 将 Web 服务器添加到现有的扭曲应用程序

> ID：15396165
> 
> 赞同：1
> 
> 时间：2013-03-13T20:48:53.877
> 
> 标签：python, twisted

我有一个现有的扭曲应用程序，它负责使用简单的基于 UDP 的协议维护一个嵌入式设备池。它是使用 DatagramProtocol 实现的，并且运行良好。它构建客户端列表、维护状态、执行维护并进行日志记录。我正在寻找以网页形式添加操作员界面。理想情况下，我也想以扭曲的方式做到这一点。

是否有适用于此类应用程序的示例？理想情况下，我正在寻找一个提供网页的示例，该网页显示我的对象列表，允许一些输入。有没有做类似事情的参考项目？

# git - 从另一个 GitHub 存储库更新存储库文件的子集

> ID：15396167
> 
> 赞同：0
> 
> 时间：2013-03-13T20:49:03.143
> 
> 标签：git, github

我有一个庞大的代码库，我用它来执行水分析中的各种任务。这个基础有一个 Github 存储库。

我正在发表一篇论文，其中将包含一个单独的 Github 存储库，其中包含该代码库的一个子集作为工作示例，以及特定于该论文的一些其他代码片段。

有没有办法让论文的存储库“自动”保持从主存储库中提取的文件与主存储库保持同步？

论文的存储库必须能够被分叉。

目前，我正在更新两个存储库中的文件以保持同步。这似乎容易出错且不优雅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T23:28:11.743

如果“论文源代码”中的所有文件都在一个、两个、几个目录中，那么您可以将这些目录中的每一个都设为独立的 git 存储库。然后，您可以根据独立的 git 存储库和其他东西，从子模块构建您的“主要源代码”。您的“纸质源代码”将直接构建为单独的子模块。

# java - Spring Security oauth2，为什么我的 auth/token 对 CLIENT 进行身份验证但返回 404？

> ID：15396168
> 
> 赞同：4
> 
> 时间：2013-03-13T20:49:03.707
> 
> 标签：java, spring, spring-security, oauth-2.0

**编辑**

我已经删除了我在这里发布的不正确的配置，因为我觉得那里已经有足够多的不正确/不完整的配置了。经过几天的挣扎，它让一切都按照我想要的方式工作，所以我把它贴在这里作为答案。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T15:17:16.997

经过几天的努力，我最终得到了一个工作配置。由于互联网上缺乏好的工作示例，我将在这里分享我的

```
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:oauth="http://www.springframework.org/schema/security/oauth2"
    xmlns:jee="http://www.springframework.org/schema/jee" 
    xmlns:sec="http://www.springframework.org/schema/security"
    xsi:schemaLocation="
http://www.springframework.org/schema/security/oauth2    
http://www.springframework.org/schema/security/spring-security-oauth2-1.0.xsd
http://www.springframework.org/schema/security     
http://www.springframework.org/schema/security/spring-security-3.1.xsd
http://www.springframework.org/schema/beans         
http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
http://www.springframework.org/schema/jee 
http://www.springframework.org/schema/jee/spring-jee-3.1.xsd">

<!-- <sec:debug /> -->

<!-- Used by the token store -->
<bean id="mysqlDataSource"
    class="org.springframework.jdbc.datasource.DriverManagerDataSource">
    <property name="driverClassName" value="${jdbc.driverClassName}" />
    <property name="url" value="${jdbc.url}" />
    <property name="username" value="${jdbc.username}" />
    <property name="password" value="${jdbc.password}" />
</bean>

<!-- Server configuration -->
<oauth:authorization-server
    client-details-service-ref="clientDetailsService" token-services-ref="tokenServices"
    user-approval-handler-ref="userApprovalHandler">
    <oauth:authorization-code />
    <oauth:implicit />
    <oauth:refresh-token />
    <oauth:client-credentials />
    <oauth:password />
</oauth:authorization-server>

<bean id="loggerListener"
    class="org.springframework.security.authentication.event.LoggerListener" />

<!-- Services for clients -->
<sec:authentication-manager id="clientAuthenticationManager">
    <sec:authentication-provider
        user-service-ref="clientDetailsUserService" />
</sec:authentication-manager>

<oauth:client-details-service id="clientDetailsService">
    <oauth:client client-id="client1"
        authorized-grant-types="client_credentials,password,implicit"
        authorities="ROLE_WRITE" secret="secret" />
</oauth:client-details-service>

<bean id="clientDetailsUserService"
    class="org.springframework.security.oauth2.provider.client.ClientDetailsUserDetailsService">
    <constructor-arg ref="clientDetailsService" />
</bean>

<!-- service for resolving our users. -->
<authentication-manager alias="authenticationManager"
    xmlns="http://www.springframework.org/schema/security">
    <authentication-provider user-service-ref="userService" />
</authentication-manager>
<bean id="userService" class="our.UserServiceImpl" />

<!-- Managing Tokens -->
<bean id="tokenServices"
    class="org.springframework.security.oauth2.provider.token.DefaultTokenServices">
    <property name="tokenStore" ref="tokenStore" />
    <property name="supportRefreshToken" value="true" />
    <property name="clientDetailsService" ref="clientDetailsService" />
    <property name="accessTokenValiditySeconds" value="${security.token.validitySeconds:43200}" />
</bean>
<bean id="tokenStore"
    class="org.springframework.security.oauth2.provider.token.JdbcTokenStore">
    <constructor-arg ref="mysqlDataSource" />
</bean>

<!-- Token Approval Handler -->
<bean id="userApprovalHandler"
    class="org.springframework.security.oauth2.provider.approval.TokenServicesUserApprovalHandler">
    <property name="tokenServices" ref="tokenServices" />
</bean>

<!-- Resource server -->
<oauth:resource-server id="resourceServerFilter"
    resource-id="myRealm" token-services-ref="tokenServices" />

<http pattern="/oauth/token/**" create-session="stateless"
    authentication-manager-ref="clientAuthenticationManager"
    xmlns="http://www.springframework.org/schema/security">
    <intercept-url pattern="/oauth/token/**" access="IS_AUTHENTICATED_FULLY" />
    <anonymous enabled="false" />
    <http-basic entry-point-ref="clientAuthenticationEntryPoint" />
    <custom-filter ref="clientCredentialsTokenEndpointFilter"
        before="BASIC_AUTH_FILTER" />
    <access-denied-handler ref="oauthAccessDeniedHandler" />
</http>

<http pattern="/oauth/authorize/**" access-denied-page="/login.jsp?authorization_error=true"
    disable-url-rewriting="true" xmlns="http://www.springframework.org/schema/security">
    <intercept-url pattern="/oauth/authorize/**" access="IS_AUTHENTICATED_FULLY" />
    <form-login authentication-failure-url="/login.jsp?authentication_error=true"
        default-target-url="http://www.ourwebsite.com/" login-page="/login.jsp"
        login-processing-url="/login.do" />
    <http-basic />
    <anonymous />
</http>

<http pattern="/login**" access-denied-page="/login.jsp?authorization_error=true"
    disable-url-rewriting="true" xmlns="http://www.springframework.org/schema/security">
    <intercept-url pattern="/login**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <form-login authentication-failure-url="/login.jsp?authentication_error=true"
        default-target-url="http://www.outwebsite.com" login-page="/login.jsp"
        login-processing-url="/login.do" />
    <http-basic />
</http>

<http pattern="/**" create-session="stateless"
    entry-point-ref="clientAuthenticationEntryPoint" xmlns="http://www.springframework.org/schema/security"
    access-decision-manager-ref="accessDecisionManager">
    <intercept-url pattern="/**" access="ROLE_WRITE" />
    <custom-filter ref="resourceServerFilter" before="PRE_AUTH_FILTER" />
    <access-denied-handler ref="oauthAccessDeniedHandler" />
</http>

<bean id="clientCredentialsTokenEndpointFilter"
    class="org.springframework.security.oauth2.provider.client.ClientCredentialsTokenEndpointFilter">
    <property name="authenticationManager" ref="clientAuthenticationManager" />
</bean>

<bean id="accessDecisionManager" class="org.springframework.security.access.vote.UnanimousBased"
    xmlns="http://www.springframework.org/schema/beans">
    <constructor-arg>
        <list>
            <bean class="org.springframework.security.oauth2.provider.vote.ScopeVoter" />
            <bean class="org.springframework.security.access.vote.RoleVoter" />
            <bean class="org.springframework.security.access.vote.AuthenticatedVoter" />
        </list>
    </constructor-arg>
</bean>

<bean id="clientAuthenticationEntryPoint"
    class="org.springframework.security.oauth2.provider.error.OAuth2AuthenticationEntryPoint">
    <property name="realmName" value="myRealm" />
</bean>

<bean id="oauthAccessDeniedHandler"
    class="org.springframework.security.oauth2.provider.error.OAuth2AccessDeniedHandler" /> 
```

我的`web.xml`样子是这样的：

```
<web-app id="Recipe_REST_API" version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee 
    http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">

    <display-name>Our REST API</display-name>

    <!-- Servlets -->
    <servlet>
        <servlet-name>mvc-dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>mvc-dispatcher</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/mvc-dispatcher-servlet.xml</param-value>
    </context-param>

    <!-- filters -->
    <filter>
        <filter-name>httpMethodFilter</filter-name>
        <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>httpMethodFilter</filter-name>
        <servlet-name>mvc-dispatcher</servlet-name>
    </filter-mapping>
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>springSecurityFilterChain</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!-- listeners -->
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
</web-app> 
```

# entity-framework - 实体框架是否将分配的值与原始值进行比较以确定 IsModified 标志？

> ID：15396169
> 
> 赞同：6
> 
> 时间：2013-03-13T20:49:03.743
> 
> 标签：entity-framework, entity-framework-4, updates

如果我加载实体对象，然后将属性之一分配给与以前相同的值，框架是否会检测到更改，或者它将 IsModified 标志设置为 true ？

字段名称的生成代码如下所示：

```
OnNameChanging(value);
ReportPropertyChanging("Name");
_Name = StructuralObject.SetValidValue(value);
ReportPropertyChanged("Name");
OnNameChanged(); 
```

我不知道哪些事件为该字段和整个实体设置了 IsModified 标志。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T23:06:47.497

您的上下文只会跟踪您的数据是否被修改，而不是如果它不同。

你可以做这样的检查：

```
 private void CheckIfDifferent(DbEntityEntry entry)
    {
        if (entry.State != EntityState.Modified) 
            return;

        if (entry.OriginalValues.PropertyNames.Any(propertyName => !entry.OriginalValues[propertyName].Equals(entry.CurrentValues[propertyName])))
            return;

       (this.dbContext as IObjectContextAdapter).ObjectContext.ObjectStateManager.GetObjectStateEntry(entry.Entity).ChangeState(EntityState.Unchanged);
    } 
```

来源：[https ://stackoverflow.com/a/13515869/1339087](https://stackoverflow.com/a/13515869/1339087)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-04-27T16:45:59.127

现在看起来情况有所不同（EF6）。我正在研究这个，看看在设置属性值时是否需要使用 if 语句来查看“新值”是否不同。我使用以下内容进行了测试，并且该实体未标记为已修改：

```
var things = dbContext.Things.AsQueryable();
var thing = things.First();
string name = thing.Name;
thing.Name = name;
var entry = dbContext.Entry(thing);
var state = entry.State;
int count = dbContext.ChangeTracker.Entries().Count(e => e.State == EntityState.Modified);
var modified = entry.Property(x => x.Name).IsModified; 
```

# jms - 在 Websphere 中使用 JMeter 和服务集成总线（SI 总线）

> ID：15396172
> 
> 赞同：0
> 
> 时间：2013-03-13T20:49:12.280
> 
> 标签：jms, websphere, jmeter

我正在尝试在 JMeter 中使用 JMS 点对点将消息发送到 Websphere 中的 SI 总线队列。

我相当肯定我有以下正确的：

```
QueueConnection Factory  
JNDI name Request queue  
JNDI Properties, Initial Context Factory set to com.ibm.websphere.naming.WsnInitialContextFactory 
```

我已经猜到了网址：

```
iiop://ipaddressofWebSphereServer:2809 
```

当我运行采样器时，我在 jmeter.log 中收到以下错误：

```
2013/03/14 09:09:01 ERROR - jmeter.protocol.jms.sampler.JMSSampler: Error getting WsnNameService properties javax.naming.NamingException: Error getting WsnNameService properties [Root exception is org.omg.CORBA.TRANSIENT: initial and forwarded IOR inaccessible  vmcid: IBM  minor code: E07  completed: No]
    at com.ibm.ws.naming.util.WsnInitCtxFactory.mergeWsnNSProperties(WsnInitCtxFactory.java:1444)
    at com.ibm.ws.naming.util.WsnInitCtxFactory.getRootContextFromServer(WsnInitCtxFactory.java:951)
    at com.ibm.ws.naming.util.WsnInitCtxFactory.getRootJndiContext(WsnInitCtxFactory.java:866)
    at com.ibm.ws.naming.util.WsnInitCtxFactory.getInitialContextInternal(WsnInitCtxFactory.java:546)
    at com.ibm.ws.naming.util.WsnInitCtx.getContext(WsnInitCtx.java:123)
    at com.ibm.ws.naming.util.WsnInitCtx.getContextIfNull(WsnInitCtx.java:798)
    at com.ibm.ws.naming.util.WsnInitCtx.lookup(WsnInitCtx.java:164)
    at com.ibm.ws.naming.util.WsnInitCtx.lookup(WsnInitCtx.java:179)
    at javax.naming.InitialContext.lookup(InitialContext.java:436)
    at org.apache.jmeter.protocol.jms.sampler.JMSSampler.threadStarted(JMSSampler.java:303)
    at org.apache.jmeter.threads.JMeterThread$ThreadListenerTraverser.addNode(JMeterThread.java:597)
    at org.apache.jorphan.collections.HashTree.traverseInto(HashTree.java:1001)
    at org.apache.jorphan.collections.HashTree.traverseInto(HashTree.java:1002)
    at org.apache.jorphan.collections.HashTree.traverse(HashTree.java:986)
    at org.apache.jmeter.threads.JMeterThread.threadStarted(JMeterThread.java:566)
    at org.apache.jmeter.threads.JMeterThread.initRun(JMeterThread.java:554)
    at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:252)
    at java.lang.Thread.run(Thread.java:736)
Caused by: org.omg.CORBA.TRANSIENT: initial and forwarded IOR inaccessible  vmcid: IBM  minor code: E07  completed: No
    at com.ibm.rmi.corba.ClientDelegate.createRequest(ClientDelegate.java:1270)
    at com.ibm.CORBA.iiop.ClientDelegate.createRequest(ClientDelegate.java:1330)
    at com.ibm.rmi.corba.ClientDelegate.createRequest(ClientDelegate.java:1158)
    at com.ibm.CORBA.iiop.ClientDelegate.createRequest(ClientDelegate.java:1296)
    at com.ibm.rmi.corba.ClientDelegate.request(ClientDelegate.java:1877)
    at com.ibm.CORBA.iiop.ClientDelegate.request(ClientDelegate.java:1252)
    at org.omg.CORBA.portable.ObjectImpl._request(ObjectImpl.java:458)
    at com.ibm.WsnBootstrap._WsnNameServiceStub.getProperties(_WsnNameServiceStub.java:38)
    at com.ibm.ws.naming.util.WsnInitCtxFactory.mergeWsnNSProperties(WsnInitCtxFactory.java:1441)
    ... 17 more
Caused by: java.net.UnknownHostException: ipaddressofWebSphereServer
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:207)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:377)
    at java.net.Socket.connect(Socket.java:539)
    at java.net.Socket.connect(Socket.java:488)
    at java.net.Socket.<init>(Socket.java:385)
    at java.net.Socket.<init>(Socket.java:199)
    at com.ibm.ws.orbimpl.transport.WSTCPTransportConnection.createSocket(WSTCPTransportConnection.java:270)
    at com.ibm.CORBA.transport.TransportConnectionBase.connect(TransportConnectionBase.java:354)
    at com.ibm.ws.orbimpl.transport.WSTransport.getConnection(WSTransport.java:436)
    at com.ibm.CORBA.transport.TransportBase.getConnection(TransportBase.java:187)
    at com.ibm.rmi.iiop.TransportManager.get(TransportManager.java:89)
    at com.ibm.rmi.iiop.GIOPImpl.getConnection(GIOPImpl.java:130)
    at com.ibm.rmi.iiop.GIOPImpl.locate(GIOPImpl.java:219)
    at com.ibm.rmi.corba.ClientDelegate.locate(ClientDelegate.java:1974)
    at com.ibm.rmi.corba.ClientDelegate._createRequest(ClientDelegate.java:1999)
    at com.ibm.rmi.corba.ClientDelegate.createRequest(ClientDelegate.java:1180)
    at com.ibm.rmi.corba.ClientDelegate.createRequest(ClientDelegate.java:1266)
    ... 25 more

2013/03/14 09:09:01 WARN  - jmeter.protocol.jms.sampler.JMSSampler: Session may not be null while creating message java.lang.IllegalStateException: Session may not be null while creating message
    at org.apache.jmeter.protocol.jms.sampler.JMSSampler.createMessage(JMSSampler.java:179)
    at org.apache.jmeter.protocol.jms.sampler.JMSSampler.sample(JMSSampler.java:140)
    at org.apache.jmeter.threads.JMeterThread.process_sampler(JMeterThread.java:428)
    at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:256)
    at java.lang.Thread.run(Thread.java:736) 
```

我在 orbtrc 日志中收到此错误：

```
09:09:01.878 com.ibm.ws.orbimpl.transport.WSTCPTransportConnection connect:403 Thread Group 1-1 ORBRas[default]  java.net.UnknownHostException: <i><b> ipaddressofWebSphereServer</i></b>
at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:207)
at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:377)
at java.net.Socket.connect(Socket.java:539)
at java.net.Socket.connect(Socket.java:488)
at java.net.Socket.<init>(Socket.java:385)
at java.net.Socket.<init>(Socket.java:199)
at com.ibm.ws.orbimpl.transport.WSTCPTransportConnection.createSocket(WSTCPTransportConnection.java:270)
at com.ibm.CORBA.transport.TransportConnectionBase.connect(TransportConnectionBase.java:354)
at com.ibm.ws.orbimpl.transport.WSTransport.getConnection(WSTransport.java:436)
at com.ibm.CORBA.transport.TransportBase.getConnection(TransportBase.java:187)
at com.ibm.rmi.iiop.TransportManager.get(TransportManager.java:89)
at com.ibm.rmi.iiop.GIOPImpl.getConnection(GIOPImpl.java:130)
at com.ibm.rmi.iiop.GIOPImpl.locate(GIOPImpl.java:219)
at com.ibm.rmi.corba.ClientDelegate.locate(ClientDelegate.java:1974)
at com.ibm.rmi.corba.ClientDelegate._createRequest(ClientDelegate.java:1999)
at com.ibm.rmi.corba.ClientDelegate.createRequest(ClientDelegate.java:1180)
at com.ibm.rmi.corba.ClientDelegate.createRequest(ClientDelegate.java:1266)
at com.ibm.CORBA.iiop.ClientDelegate.createRequest(ClientDelegate.java:1330)
at com.ibm.rmi.corba.ClientDelegate.createRequest(ClientDelegate.java:1158)
at com.ibm.CORBA.iiop.ClientDelegate.createRequest(ClientDelegate.java:1296)
at com.ibm.rmi.corba.ClientDelegate.request(ClientDelegate.java:1877)
at com.ibm.CORBA.iiop.ClientDelegate.request(ClientDelegate.java:1252)
at org.omg.CORBA.portable.ObjectImpl._request(ObjectImpl.java:458)
at com.ibm.WsnBootstrap._WsnNameServiceStub.getProperties(_WsnNameServiceStub.java:38)
at com.ibm.ws.naming.util.WsnInitCtxFactory.mergeWsnNSProperties(WsnInitCtxFactory.java:1441)
at com.ibm.ws.naming.util.WsnInitCtxFactory.getRootContextFromServer(WsnInitCtxFactory.java:951)
at com.ibm.ws.naming.util.WsnInitCtxFactory.getRootJndiContext(WsnInitCtxFactory.java:866)
at com.ibm.ws.naming.util.WsnInitCtxFactory.getInitialContextInternal(WsnInitCtxFactory.java:546)
at com.ibm.ws.naming.util.WsnInitCtx.getContext(WsnInitCtx.java:123)
at com.ibm.ws.naming.util.WsnInitCtx.getContextIfNull(WsnInitCtx.java:798)
at com.ibm.ws.naming.util.WsnInitCtx.lookup(WsnInitCtx.java:164)
at com.ibm.ws.naming.util.WsnInitCtx.lookup(WsnInitCtx.java:179)
at javax.naming.InitialContext.lookup(InitialContext.java:436)
at org.apache.jmeter.protocol.jms.sampler.JMSSampler.threadStarted(JMSSampler.java:303)
at org.apache.jmeter.threads.JMeterThread$ThreadListenerTraverser.addNode(JMeterThread.java:597)
at org.apache.jorphan.collections.HashTree.traverseInto(HashTree.java:1001)
at org.apache.jorphan.collections.HashTree.traverseInto(HashTree.java:1002)
at org.apache.jorphan.collections.HashTree.traverse(HashTree.java:986)
at org.apache.jmeter.threads.JMeterThread.threadStarted(JMeterThread.java:566)
at org.apache.jmeter.threads.JMeterThread.initRun(JMeterThread.java:554)
at org.apache.jmeter.threads.JMeterThread.run(JMeterThread.java:252)
at java.lang.Thread.run(Thread.java:736) 
```

# apache-flex - Flex 3 tilelist 不使用“底部”属性集

> ID：15396174
> 
> 赞同：0
> 
> 时间：2013-03-13T20:49:13.867
> 
> 标签：apache-flex, flex3, tilelist

非常基本的问题，但它似乎很奇怪，它不起作用。我的磁贴列表垂直滚动。如果我设置一个明确的高度，一切正常。如果我将高度设置为百分比或设置底部属性，则平铺列表不会缩小到小于渲染器的高度乘以显示的行数。

我想出的解决方案是监听父级的调整大小事件，并每次都明确设置平铺列表的高度。它有效，但我很好奇这是正常的还是这里发生了其他事情。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T06:51:11.247

> 平铺列表不会缩小小于渲染器的高度乘以显示的行数。

这可能是意料之中的。由于您没有显示任何代码，我猜您将高度设置为 100% 或底部 =“0”。即使您指定的值稍微小一些，例如 90% 或 bottom="10"，它也会使列表足够大以填充指定的空间。

如果你想要滚动条，你总是可以通过指定一个`maxHeight`.

# java - 下面的代码是否使用命令模式

> ID：15396176
> 
> 赞同：-1
> 
> 时间：2013-03-13T20:49:16.570
> 
> 标签：java

我对命令模式有一个非常基本的问题。假设，我有一个像

```
public interface Task {  
    public void execute();  
} 
```

和一些实现接口任务的类

```
class SomeClass implements Task {  
public void execute() {  
 //do something  
}  

class Test {  
    public static void main(String[] args) {  
         Task task = new SomeClass();  
          task.execute();  
    }  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:53:28.613

是的，这是命令模式。在此处查看更多信息： [http ://en.wikipedia.org/wiki/Command_pattern#Java](http://en.wikipedia.org/wiki/Command_pattern#Java)

`Command`将示例中的接口替换为您的`Task`接口，您可以看到它是如何像`Command`.

# django - 为什么 Django 会在此表单验证中抛出 KeyError？

> ID：15396179
> 
> 赞同：3
> 
> 时间：2013-03-13T20:49:24.577
> 
> 标签：django, django-models, django-forms

这是代码：

```
...

class Meta:
    model = Card

def clean_video_url(self):
    video_url = self.cleaned_data['video_url']
    if video_url != '' and len(video_url) != YOUTUBE_VIDEO_URL_LENGTH:
        pos = string.find(video_url, YOUTUBE_VIDEO_URL_IDENTIFIER)
        identifier_length = len(YOUTUBE_VIDEO_URL_IDENTIFIER)
        if pos == -1:
            raise forms.ValidationError(_('youtube-url-not-valid'))
        video_url = video_url[pos+identifier_length:pos+identifier_length+YOUTUBE_VIDEO_URL_LENGTH]
    return video_url

...

def clean(self):
    video_url = self.cleaned_data['video_url']
    field1 = self.cleaned_data['field1']
    if video_url == '' and field1 == '':
        raise forms.ValidationError(_('must-fill-video-url-or-front'))
    return self.cleaned_data 
```

最令人不安的是，它几乎在所有情况下都有效（提交并保存在数据库中）。**当我在video_url 字段**中编写像“aeuchah”这样的虚拟文本时，它不起作用，而是抛出：

```
Exception Type: KeyError
Exception Value:    
'video_url' 
```

我重新阅读了我的 clean_video_url 方法，并使用 pdb.set_trace 之类的调试工具查看了哪些变量，但我找不到问题所在。

**更新**：**正如 Marius Grigaitis 和 Davide R. 所说，在完成所有单个字段方法之后调用 clean 方法。clean_video_url 引发了 ValidationError 并且没有返回任何内容，因此 clean 方法没有发现任何可使用的内容并引发了 KeyError。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T21:08:35.503

`cleaned_data`在方法中使用它之前，您应该始终检查它是否存在`clean()`。如果先前的验证未通过，则不能保证值存在于cleaned_data 数组中。

文档：[https ://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-and-validating-fields-that-depend-on-each-other](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-and-validating-fields-that-depend-on-each-other)

> 到调用表单的`clean()`方法时，所有单独的字段清理方法都将运行（前两节），因此 self.cleaned_data 将填充迄今为止存活的任何数据。因此，您还需要记住要考虑到您要验证的字段可能无法通过初始单个字段检查的事实。

# jquery - 1 个按钮上的 jQuery 多个功能

> ID：15396180
> 
> 赞同：0
> 
> 时间：2013-03-13T20:49:25.887
> 
> 标签：jquery, function, html, jquery-animate

所以我有一个按钮，我正在尝试使用多种功能。在页面加载时，上面的 div 是隐藏的，一旦单击按钮，它将使 div 可见并滚动到顶部。我可以让两者分开工作，但不能一起工作。有人可以指出我做错了什么吗？

```
$(function () {
    $("#work").hide();
    $(".button").bind("click", function () {
        $("#work").show();
    });
    $(".button").click(function () {
        $('html, body').animate({
            scrollTop: $("#work").offset().top
        }, 2000);
    });
}); 
```

更新 1：

添加了一个小提琴：http: [//jsfiddle.net/5qQJN/1/](http://jsfiddle.net/5qQJN/1/)

更新 2：

所以它设法工作，但只有在你点击一次之后。假设您单击它，跳到顶部，再次向下滚动单击，然后它将滚动动画..这是否意味着我需要加载窗口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:00:04.480

```
$(function () {
    $("#work").hide();
    $(".button").click(function () {
        $("#work").show();
        $('html, body').animate({
            scrollTop: $("#work").offset().top
        }, 2000);
    });
}); 
```

将它们组合起来应该可以工作，因为似乎没有动态加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:07:03.693

我为你做了一个小提琴：http: [//jsfiddle.net/FaC4r/](http://jsfiddle.net/FaC4r/)

看起来它在那里工作。但是，如果您提供了 HTML，它会有所帮助。

```
THE DIV IS HIDDEN UP HERE - SCROLL DOWN FOR BUTTON
<div id="work"></div>

<div id="spacer"></div>

<input type="button" class="button" value="CLICK ME TO SHOW 'WORK' AND SCROLL UP TO IT"> 
```

[根据评论更新]

我用你的新 HTML 为你编辑了小提琴：http: [//jsfiddle.net/FaC4r/2/](http://jsfiddle.net/FaC4r/2/)

似乎您的 CSS 指定了一个填充为 0 的工作 div，再加上 div 中没有任何内容的事实，这意味着它是不可见的！您可以在上面的小提琴中看到，我在填充中使用 2em 以确保我实际上看到了 div 的增长和扩展。

我想说——这对于你编程生涯中的所有事情来说都是如此——使用工作示例作为基础，并逐步添加你的特定要求。尽早并经常测试。添加一件事并测试以确保它符合您的预期。一旦你建立了一定的舒适度，你就可以扩展这个迭代周期。

希望有帮助！:)

# mysql - GROUP_CONCAT 创建 NULL 条目

> ID：15396186
> 
> 赞同：0
> 
> 时间：2013-03-13T20:49:50.323
> 
> 标签：mysql

我有一个旧的帮助台票务系统，我的任务是将数据从我们的新票务系统中导出和导入。这是我正在运行的查询：

```
DROP TABLE IF EXISTS final_table;

CREATE TABLE final_table (
    name varchar(40), 
    ticketID BIGINT, 
    ticket_id BIGINT,
    subject varchar(255), 
    priority_id varchar(10), 
    status varchar(10), 
    updated DATE, 
    created DATE,
    closed DATE,
    response LONGTEXT
);

ALTER TABLE final_table ADD PRIMARY KEY(ticket_id);

INSERT INTO final_table
SELECT      name, ticketID, ticket_id, subject, priority_id, status, updated, created, closed, response
FROM        ost_ticket;

ALTER TABLE final_table ADD response LONGTEXT;
ALTER TABLE final_table ADD impact varchar(40);
ALTER TABLE final_table ADD category varchar(20);
ALTER TABLE final_table ADD queue varchar (20);

UPDATE final_table SET impact = "1 person can't work";
UPDATE final_table SET category = "Other";
UPDATE final_table SET queue = "Help Desk";

INSERT INTO final_table( response )
SELECT      GROUP_CONCAT(ost_ticket_response.response SEPARATOR "\n\n") AS response
FROM        ost_ticket_response
GROUP BY    ost_ticket_response.ticket_id; 
```

旧的票务软件在 ost_ticket_response 表中多次列出了 PK，因此需要在最后四行调用 GROUP_CONCAT。基本上我正在尝试组合具有相同ticket_id 的条目，然后将其拉入我正在创建的临时表中。如果我现在运行查询，它只会用空结果填充响应列。有任何想法吗？

# python - python循环遍历列表中的n个连续项目

> ID：15396187
> 
> 赞同：3
> 
> 时间：2013-03-13T20:49:50.387
> 
> 标签：python

我需要遍历列表中的 n 个连续元素。例如：

```
data = [1,2,3,4,5,6,7] 
```

我需要过去：

```
1 2
2 3
3 4
4 5 
```

或者：

```
1 2 3
2 3 4
3 4 5
4 5 6 
```

有 zip 功能可以做到这一点吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T20:56:39.670

我不确定你在找什么，但试试这个：

```
data = [1, 2, 3, 4, 5, 6, 7]

n = 3

[data[i:i+n] for i in range(len(data) - n + 1)]

# [[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5, 6], [5, 6, 7]] 
```

或者：

```
f = lambda data, n: [data[i:i+n] for i in range(len(data) - n + 1)]

for x, y, z in f([1, 2, 3, 4, 5, 6, 7], 3):
    print x, y, z 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T20:59:17.417

假设您总是对列表或另一个序列执行此操作，并且不需要使用任意可迭代对象：

```
def group(seq, n):
    return (seq[i:i+n] for i in range(len(seq)-n+1)) 
```

例子：

```
>>> list(group([1,2,3,4,5,6,7], 2))
[[1, 2], [2, 3], [3, 4], [4, 5], [5, 6], [6, 7]]
>>> list(group([1,2,3,4,5,6,7], 3))
[[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5, 6], [5, 6, 7]] 
```

如果您需要对任何任意迭代（可能不支持`len()`或切片）执行此操作，您可以调整[成对配方](http://docs.python.org/2/library/itertools.html#recipes)：

```
from itertools import tee, izip

def group(iterable, n):
    "group(s, 3) -> (s0, s1, s2), (s1, s2, s3), (s2, s3, s4), ..."
    itrs = tee(iterable, n)
    for i in range(1, n):
        for itr in itrs[i:]:
            next(itr, None)
    return izip(*itrs)

>>> list(group(iter([1,2,3,4,5,6,7]), 2))
[(1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)]
>>> list(group(iter([1,2,3,4,5,6,7]), 3))
[(1, 2, 3), (2, 3, 4), (3, 4, 5), (4, 5, 6), (5, 6, 7)] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-13T21:05:38.083

具体答案：

```
>>> zip(data,data[1:])
[(1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)] 
```

一般回答：

```
>>> def consecutives(data,per_set):
...   return zip(*[data[n:] for n in range(per_set)])
...
>>> consecutives(range(1,8),2)
[(1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)]
>>> consecutives(range(1,8),3)
[(1, 2, 3), (2, 3, 4), (3, 4, 5), (4, 5, 6), (5, 6, 7)]
>>> consecutives(range(1,8),4)
[(1, 2, 3, 4), (2, 3, 4, 5), (3, 4, 5, 6), (4, 5, 6, 7)] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T20:56:58.267

可能不是最好的方法，但仍然有用：

```
>>> data = [1,2,3,4,5,6,7]
>>> map(None,data[:-1],data[1:])
[(1, 2), (2, 3), (3, 4), (4, 5), (5, 6), (6, 7)]

>>> map(None,data[:-2],data[1:-1],data[2:])
[(1, 2, 3), (2, 3, 4), (3, 4, 5), (4, 5, 6), (5, 6, 7)] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-13T20:55:42.320

根据您是要遍历子列表还是平面列表：

```
from itertools import chain
for x in chain(*[ a[i:i+n] for i in xrange(len(a)-n+1) ]):
    print x 
```

或者：

```
for x in [ a[i:i+n] for i in xrange(len(a)-n+1) ]:
    print x 
```

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2013-03-13T20:53:38.750

这是自己编程的一项相当简单的任务。我不认为有一个预先准备好的功能可以做到这一点。

```
def func(arr,n):
    i = 0
    while i+n < len(arr):
       for range(i,i+n):
          .... make stuff here....
       i = i + 1 
```

# r - 你可以使用 rbind.fill 而不用它填充 NA 吗？

> ID：15396188
> 
> 赞同：1
> 
> 时间：2013-03-13T20:49:51.293
> 
> 标签：r, na, rbind

我正在尝试将两个具有不同列数和列标题的数据框组合起来。但是，在我使用它们组合之后`rbind.fill()`，生成的文件已用`NA`.

这非常不方便，因为其中一列的数据也表示为“NA”（用于北美），因此当我将其导入 csv 时，电子表格无法区分它们。

有没有办法让我：

1.  使用该`rbind.fill`函数而不用 NA 填充空单元格

或者

1.  更改列以替换 NA 值*

*我搜索了博客，并尝试了两种最流行的解决方案：

```
df$col[is.na(df$col)] <- 0, #it does not work
df$col = ifelse(is.na(df$col), "X", df$col), #it changes all the characters to numbers, and ruins the column 
```

如果您有任何建议，请告诉我！我（不幸的是）不能分享`df`，但愿意回答任何问题！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:11:14.723

`NA`与`"NA"`to不同`R`，但您最喜欢的电子表格程序可能会这样解释。`NA`是一个特殊的值（`R`不是`NaN`数字）。如果我理解正确，您的解决方案之一是将代表北美的列中的“NA”值替换为其他值，在这种情况下，您应该能够做到......

```
df$col[ df$col == "NA" ] <- "NorthAmerica" 
```

这是假设您的“NA”值实际上是字符串。`is.na()`如果它们是字符串，则不会返回任何值，这就是为什么`df$col[ is.na(df$col) ] <- 0`不起作用。

# NA和“NA”之间的区别示例：

```
x <- c( 1, 2, 3 , "NA" , 4 , 5 , NA )

> x[ !is.na(x) ]
[1] "1"  "2"  "3"  "NA" "4"  "5"

> x[ x == "NA" & !is.na(x) ]
[1] "NA" 
```

# 解决此问题的方法

我认为您想将“NA”和任何`NA`s 保留在第一个 df 中，但`NA`将第二个 df 中的所有内容都`rbind.fill()`更改为“NotAvailable”之类的东西。你可以像这样完成这个......

```
df1 <- data.frame( col = rep( "NA" , 6 ) , x = 1:6 , z = rep( 1 , 6 ) )
df2 <- data.frame( col = rep( "SA" , 2 ) , x = 1:2 , y = 5:6 )
df <- rbind.fill( df1 , df2 )
temp <- df [ (colnames(df) %in% colnames(df2)) ]
temp[ is.na( temp ) ] <- "NotAvailable"
res <- cbind( temp , df[ !( colnames(df) %in% colnames(df2) ) ] )

#df has real NA values in column z and column y. We just want to get rid of y's
df

#     col x  z  y
#   1  NA 1  1 NA
#   2  NA 2  1 NA
#   3  NA 3  1 NA
#   4  NA 4  1 NA
#   5  NA 5  1 NA
#   6  NA 6  1 NA
#   7  SA 1 NA  5
#   8  SA 2 NA  6

#res has "NA" strings in col representing "North America" and NA values in z, whilst those in y have been removed
#More generally, any NA in df1 will be left 'as-is', whilst NA from df2 formed using rbind.fill will be converted to character string "NotAvilable"
res

#     col x            y  z
#   1  NA 1 NotAvailable  1
#   2  NA 2 NotAvailable  1
#   3  NA 3 NotAvailable  1
#   4  NA 4 NotAvailable  1
#   5  NA 5 NotAvailable  1
#   6  NA 6 NotAvailable  1
#   7  SA 1            5 NA
#   8  SA 2            6 NA 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:13:53.593

如果您有一个包含 NA 的数据框并且想要替换它们，您可以执行以下操作：

```
df[is.na(df)] <- -999 
```

这将一次性处理所有 NA

如果您只想对单个列进行操作，您可以执行类似的操作

```
df$col[which(is.na(df$col))] <- -999 
```

# bash - 逐行读取文件并在 bash 中为每个文件执行操作

> ID：15396190
> 
> 赞同：2
> 
> 时间：2013-03-13T20:49:56.333
> 
> 标签：bash, shell

我有一个文本文件，每行包含一个单词。

我需要 bash 中的一个循环来读取每一行，然后在每次读取一行时执行一个命令，使用该行的输入作为命令的一部分。

我只是不确定在 bash 中执行此操作的正确语法。如果有人可以提供帮助，那就太好了。我需要使用从测试文件中获得的行作为参数来调用另一个函数。当文本文件中没有更多行时，循环应该停止。

伪代码：

```
Read testfile.txt.
For each in testfile.txt
{
some_function linefromtestfile
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-13T20:53:57.050

怎么样：

```
while read line
do
   echo $line
   // or some_function "$line"
done < testfile.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:01:23.590

作为替代方案，使用文件描述符（在这种情况下为#4）：

```
file='testfile.txt'
exec 4<$file

while read -r -u4 t ; do
    echo "$t"
done 
```

不要使用`cat`！在循环`cat`中几乎总是错误的，即

```
cat testfile.txt | while read -r line
do
   # do something with "$line" here
done 
```

人们可能会开始向你扔[UUoCA](http://www.iki.fi/era/unix/award.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-09T23:56:26.877

```
while read line
do
   nikto -Tuning x 1 6 -h $line -Format html -o NiktoSubdomainScans.html
done < testfile.txt 
```

从 cat 方法更改后，尝试使用此方法自动对域列表进行 nikto 扫描。仍然只是阅读第一行并忽略其他所有内容。

# c++ - MSVC - 如何确定是否必须移动类型？

> ID：15396193
> 
> 赞同：2
> 
> 时间：2013-03-13T20:50:02.490
> 
> 标签：c++, visual-c++, c++11, visual-studio-2012

我似乎遇到了编译器/库错误的问题。当我尝试

```
#include <iostream>
#include <type_traits>
#include <memory>

int main() 
{
    typedef std::unique_ptr<int> T;

    std::cout << "is_copy_assignable: " 
              << std::is_copy_assignable<T>::value 
              << "\n"
              << "is_copy_constructible: " 
              << std::is_copy_constructible<T>::value << "\n";
} 
```

使用 Visual Studio 2012 Update 1 我得到

```
is_copy_assignable: 1
is_copy_constructible: 1 
```

代替

```
is_copy_assignable: 0
is_copy_constructible: 0 
```

有替代解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T20:57:21.690

这肯定是MS 实现任一类型特征或类型特征的**错误**`std::unique_ptr<>`。[这些类型特征应该可以按您的预期工作（请参阅此处](http://liveworkspace.org/code/188WMz%248)的实时示例）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T21:00:01.930

如果您查看正在发生的事情，它会检查赋值运算符和 ctor 是否**存在**，仅此而已。在 MSVC 的实现中，复制构造函数和赋值运算符`private`在`std::unique_ptr`' 的实现中。但是它不做任何访问检查。MSVC 尚未实施`= delete`等，这就是它返回的原因`true`。

在玩了一段时间之后，我想我有一些东西可以用来检测私人复制 ctor：

```
#include <type_traits>
#include <memory>

template <typename T>
struct wrap
{
   T t;
};

template<typename T, typename = int>
struct is_copyable : std::false_type { };

template<typename T>
struct is_copyable<T, 
    decltype(wrap<T>(std::declval<const wrap<T>&>()), 0)> : std::true_type
{};

class X
{
   public:
   X(const X&) {}
};

class Y
{
   Y(const Y&){}
};

int main()
{
    static_assert(is_copyable<std::unique_ptr<int>>::value, "Error!");
    static_assert(is_copyable<X>::value, "Error!");
    static_assert(is_copyable<Y>::value, "Error!");
} 
```

[LWS 上的示例](http://liveworkspace.org/code/188WMz%2450)。

**但是**，这导致了带有 MSVC 的[ICE](http://rise4fun.com/Vcpp) ......所以不起作用。

# php - 在 JSON/PHP 中返回多个变量

> ID：15396194
> 
> 赞同：0
> 
> 时间：2013-03-13T20:50:04.173
> 
> 标签：php, jquery, json

基本上，我使用来自**本地 PHP 文件**的 JSON 响应在 div 中附加数据，目前它只返回一个变量，我使用的代码如下所示：

```
 $.ajax({
        url: "functions/ajax.php",
        data: "func=auto",
        type: "GET",
        dataType: "json",
        success: function(data){
            $.each(data.search, function (i, v) {
                    $div = $('.bs-docs-example');
                    $div.append('+ v +');
            });
        },
        error: function (jqXHR, textStatus, errorThrown){
            console.log('Error ' + jqXHR);
        }
    }); 
```

返回 JSON 的代码当前是

```
while($row = mysql_fetch_assoc($res)) {
     $search[] = $row['number'];
}
echo json_encode($search); 
```

我想做的是这样的

```
while($row = mysql_fetch_assoc($res)) {
     $search[] = $row['number'];
     $search[] = $row['name'];
}
echo json_encode($search); 
```

但是，如果我要执行以下操作，我将如何访问两者`number`，并且`name`因为在`success`jQuery 上它正在使用它进行解析，`$.each(data.search, function (i, v) {`这意味着原始文件`$search[] = $row['number']`现在存储在里面`v`

我会做类似的事情`v['name']` `v['number']`还是完全错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T20:56:50.577

您需要将关联数组传递给 json_encode：

```
$search['number'] = $row['number'];
$search['name'] = $row['name'];
json_encode($search); 
```

或者，如果会有多行结果，则作为关联数组的数组：

```
while($row = mysql_fetch_assoc($res)) {
    $search[] = $row;
} 
```

然后按名称访问 JavaScript 中的值：

```
var name = v['name']; 
```

或者

```
var name = v[0]['name'] 
```

如果您使用多行结果。

# php - 是否可以使用包含在其主索引中的辅助值对数组进行排序？

> ID：15396195
> 
> 赞同：0
> 
> 时间：2013-03-13T20:50:17.577
> 
> 标签：php, arrays, sorting, alphabetical

嘿伙计们，我有一点鸡或蛋的问题。我在 ldap 数据库中查询用户列表并以形式接收二维数组

`Array[index]['username']`

ldap 数据库当前没有按字母顺序排序，或者至少没有按字母顺序检索记录，因此在返回上使用 for 循环会`[index]`返回一个未排序的查找列表。如何`Array`按“用户名”中的值按字母顺序排序？这甚至可能（很容易）吗？:O

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:01:50.703

有很多重复的......但是你去：

```
usort($array, function($a,$b){ return strcmp($a['username'], $b['username']); } ); 
```

# javascript - 如何从 JS 函数外部检索值

> ID：15396196
> 
> 赞同：1
> 
> 时间：2013-03-13T20:50:20.727
> 
> 标签：javascript, function, geolocation

我一直在努力使用 Google 的地理定位 API。我有一个功能可以带来带有城市名称的警报消息：

```
geocoder.geocode({ 'latLng': latlng }, function Test(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            if (results[1]) {
                for (var i = 0; i < results[0].address_components.length; i++) {
                    for (var b = 0; b < results[0].address_components[i].types.length; b++) {
                        if (results[0].address_components[i].types[b] == "locality") {
                            city = results[0].address_components[i];
                            break;
                        }
                    }
                }
                alert(city.short_name)
            }
        } 
    }); 
```

我想`city.short_name`稍后检索以将其用作字符串。我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:51:48.877

如果你不介意污染全局变量空间，你可以使用：

```
window.newVar = city.short_name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T20:53:23.633

您将不得不将其设置为全局变量。或者从此函数调用一个函数并将其作为参数传递。

# c - C语言中的分号(·)是什么意思？

> ID：15396199
> 
> 赞同：7
> 
> 时间：2013-03-13T20:50:39.673
> 
> 标签：c

我已经在许多流行的 C 项目中看到了这一点，例如 Go 语言，但我在任何地方都找不到有关它的信息。我认为这是一种命名空间，但我认为 C 不支持它。

## 例如

`void runtime·memhash(uintptr*, uintptr, void*);`

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-13T20:54:06.160

`·`不是“基本执行字符集”的一部分，因此不是标准的 C 运算符。

但是，C 标准似乎允许它作为实现定义的标识符字符。它没有特殊含义；这只是另一个角色。

# javascript - 如果多个页面打开并且使用 JS/JQuery 中的计时器使一个页面处于非活动状态，则用户会话超时

> ID：15396200
> 
> 赞同：0
> 
> 时间：2013-03-13T20:50:40.177
> 
> 标签：javascript, jquery, logout, session-timeout

我的页面上有一个用户活动。当用户处于非活动状态（**没有移动鼠标**）30 分钟时，它会提示用户警告会话即将到期。如果用户没有点击**OK**按钮并保持非活动状态将被自动注销（**会话销毁**）。

现在每 25 分钟检查一次，一切正常，直到用户打开同一页面的多个选项卡。如果打开了多个选项卡并且用户正在处理一个选项卡但将另一个选项卡保持打开 25 分钟，则会超时。

当多个选项卡打开并且用户在至少一个选项卡中处于活动状态时，我如何防止它超时会话，这意味着用户正在页面的至少一个选项卡中移动鼠标。

检测鼠标移动的js代码如下：

```
timer = 0;
function cIncrement() {
   if (timer == 25) {
     //25 minutes passed warn user that in 5 minutes it will expire
     //here is the code that prompts user with dialog
      if (OK clicked on dialog) {
        timer = 0;
      } else {
        //execute logout script.
      }
   }
   if (timer == 30) {
      //30 minutes passed log user out
      //script to log user out
   }
}

$(function() {
   var interval = setInterval("cIncrement()", 60000); //increment every minute

   //reset timer on mouse move
   $(document).mousemove(function(e) {
      timer = 0;
   });
}); 
```

**注意**：当打开 1 个选项卡时，上面的代码可以正常工作。

我将如何更改此设置，以便如果打开 2 个或更多选项卡并且用户在其中任何一个中处于活动状态，则应将**计时器**重置为**0**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T20:59:22.913

大概你有一个服务器端会话对象。大概您的服务器端会话对象也有某种到期时间，因此您可以在用户关闭浏览器或关闭笔记本电脑盖子并休假几周等的情况下获得会话。大概活动无论哪个选项卡/窗口具有焦点，都会重置您的服务器端活动超时。

因此，在 中`cIncrement`，发起一个 Ajax 请求，询问服务器上次活动是多久之前，并使用响应来重置`timer`。

如果您想非常积极地保持会话打开，即使只捕获了鼠标移动，请发送页面的当前计时器值，并使用它来移动会话刷新时间（如果它是该会话中的最新活动）。

# python - 使用pytest时如何组织fixture

> ID：15396202
> 
> 赞同：5
> 
> 时间：2013-03-13T20:50:44.703
> 
> 标签：python, fixtures, pytest

固定装置往往很小且可重复使用。鉴于特定的夹具可以依赖于其他夹具

```
@pytest.fixture
def Account(db, memcache):
    ... 
```

我想在模块中组织我的装置，并将它们导入一个特定的测试文件中（例如）

```
from .fixtures.models import Account 
```

不幸的是，这似乎不起作用。相反，我总是必须导入所有从属装置，例如

```
from .fixtures.models import Account, db, memcache 
```

有什么更好的方法来拥有细粒度的、可重复使用的固定装置并使其在模块级别上可访问。（conftest 适用于包/目录级别。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T11:22:41.933

通常我不推荐这个，但如果你有包含一组特定装置的模块（它们相互依赖），那么也许`from .fixtures.models import *`可行？目前我想不出另一种通用解决方案来避免了解导入测试模块中的底层夹具依赖关系。

# python - Atexit 函数在程序启动时执行

> ID：15396203
> 
> 赞同：3
> 
> 时间：2013-03-13T20:50:47.977
> 
> 标签：python, atexit

我有这个简单的程序：

```
def save_f():
    global register
    register = register_registerer()
    outFile = open('FobbySave.txt', 'wb')
    pickle.dump(register, outFile)
    outFile.close()
    print register

atexit.register(save_f()) 
```

问题是`save_f`一旦我运行我的程序就会被调用。这不是我的全部代码，只是重要的部分。如果这里没有问题，请告诉我，以便我知道该怎么做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T20:52:04.780

改变

```
atexit.register(save_f()) 
```

至

```
atexit.register(save_f) 
```

在您的原始代码中，`save_f()`调用该函数。然后将函数的返回值（即`None`）传递给`atexit.register()`。

正确的版本将函数对象本身传递给`atexit.register()`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T20:52:09.963

您正在注册函数的返回值而不是函数本身。而不是在注册之前调用它，只需传入函数引用：

```
atexit.register(save_f) 
```

# ios - UISegmentedControl 选择器不起作用

> ID：15396204
> 
> 赞同：-1
> 
> 时间：2013-03-13T20:50:48.703
> 
> 标签：ios, objective-c, uisegmentedcontrol

我有一个名为 Modal 的调用，我正在其中运行以下代码。

```
 - (void)createAccessoryView
{

    CGRect frame = CGRectMake(0.0, self.frame.size.height, self.frame.size.width, 44.0);
    fieldAccessoryView = [[UIToolbar alloc] initWithFrame:frame];
    fieldAccessoryView.barStyle = UIBarStyleBlackOpaque;
    fieldAccessoryView.tag = 200;

    [fieldAccessoryView setBarStyle:UIBarStyleBlack];

    UIBarButtonItem *spaceButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
    UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone  target:self action:@selector(done:)];

    UISegmentedControl* segmentedControl = [[UISegmentedControl alloc] initWithItems:[NSArray arrayWithObjects:NSLocalizedString(@"Previous", @""), NSLocalizedString(@"Next", @""), nil]];
    [segmentedControl addTarget:self action:@selector(segmentAction:) forControlEvents:UIControlEventValueChanged];
    segmentedControl.segmentedControlStyle = UISegmentedControlStyleBar;
    [segmentedControl setMomentary:YES];
    UIBarButtonItem *segmentButton = [[UIBarButtonItem alloc] initWithCustomView:segmentedControl];

    [fieldAccessoryView setItems:[NSArray arrayWithObjects:segmentButton, spaceButton, doneButton, nil] animated:NO];

}

-(void)segmentAction:(id)selector
{

} 
```

然后，我创建了一个扩展 Modal 并具有一些 UITextField 的类。单击文本字段会按预期显示键盘。启动键盘后，我会看到上一个/下一个和完成按钮。单击完成会引发错误，并且不会按应有的方式使用 segmentAction 方法。不太清楚为什么。

这是单击完成按钮后我得到的堆栈跟踪

```
2013-03-13 15:54:33.956 myapp[74194:c07] -[NotesModal done:]: unrecognized selector sent to instance 0x80f3fb0
2013-03-13 15:54:33.961 myapp[74194:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[NotesModal done:]: unrecognized selector sent to instance 0x80f3fb0'
*** First throw call stack:
(0x1b54012 0x1470e7e 0x1bdf4bd 0x1b43bbc 0x1b4394e 0x1484705 0x3b82c0 0x5f4a64 0x1484705 0x3b82c0 0x3b8258 0x479021 0x47957f 0x4786e8 0x3e7cef 0x3e7f02 0x3c5d4a 0x3b7698 0x1aafdf9 0x1ad7f3f 0x1ad796f 0x1afa734 0x1af9f44 0x1af9e1b 0x1aae7e3 0x1aae668 0x3b4ffc 0x1786d 0x24b5)
libc++abi.dylib: terminate called throwing an exception 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:58:38.047

这段代码

```
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone  
                                                                            target:self 
                                                                            action:@selector(done:)]; 
```

需要一个方法

```
-(void)done:(id)selector
{
    //…
} 
```

要么提供它，要么将其更改`UIBarButtonItem`为

```
UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone  
                                                                            target:self 
                                                                            action:@selector(segmentAction:)]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T20:59:07.130

错误的重要部分是：

```
[NotesModal done:]: unrecognized selector 
```

因此，它崩溃了，因为它无法识别方法`done:`。

确保您确实有一个`done:`方法，例如：

```
 -(void)done:(id)sender
 {
      // whatever it does here...
 } 
```

注意`-(void)done`和`-(void)done:(id)sender`不**一样**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T20:59:40.527

请检查您的`done`方法是否有任何参数。

它需要是这样的：

```
-(void)done:(id)selector
{
    [self dismissModalViewController];
} 
```

# objective-c - RestKit 在调用时删除路径

> ID：15396206
> 
> 赞同：2
> 
> 时间：2013-03-13T20:50:52.170
> 
> 标签：objective-c, cocoa, restkit

为什么在进行 API 调用时 RestKit 会删除我的路径？它表明它在通话之前很好。

**这就是我注册它的方式**

```
AFHTTPClient *client = [[AFHTTPClient alloc] initWithBaseURL:[NSURL URLWithString:[[NSUserDefaults standardUserDefaults] objectForKey:@"apiURL"]]];
[client setDefaultHeader:@"Accept" value:RKMIMETypeJSON];
[client setParameterEncoding:AFJSONParameterEncoding];
RKObjectManager *objectManager = [[RKObjectManager alloc] initWithHTTPClient:client];
NSLog(@"Created client: %@", objectManager.HTTPClient); 
```

**这就是我在其他课程中的称呼**

```
RKObjectManager *manager = [RKObjectManager sharedManager];
NSLog(@"HTTP Client: %@", manager.HTTPClient); 
```

即使在我调用共享 objectManager 的其他类中，它也是正确的，但是我在调​​用过程中得到了日志记录，并且响应错误，因为它`/api/v1`被取出了。

**NSLOG**

```
2013-03-13 13:24:08.960 Project[54631:403] HTTP Client: <AFHTTPClient: 0x1033d6230, baseURL: https://my.server.com/api/v1/, defaultHeaders: {
    Accept = "application/json";
    "Accept-Language" = "en, ja, fr, de, es, it, pt, pt-PT, nl, sv, nb, da, fi, ru, pl, zh-Hans, zh-Hant, ko, ar, cs, hu, tr, en-us;q=0.8";
    Authorization = "Bearer <My Access Token>";
    "User-Agent" = "Project/1.0 (Mac OS X Version 10.7.5 (Build 11G63))";
}, registeredOperationClasses: (
), operationQueue: <NSOperationQueue: 0x1033db8c0>{name = 'NSOperationQueue 0x1033db8c0'}>
2013-03-13 13:24:08.960 Project[54631:403] Manager: <RKObjectManager: 0x1033db940>
2013-03-13 13:24:08.971 Project[54631:403] I restkit.network:RKHTTPRequestOperation.m:154 GET 'https://my.server.com/features/1234?with_lock=false'
2013-03-13 13:24:09.310 Project[54631:403] I restkit.network:RKHTTPRequestOperation.m:185 GET 'https://my.server.com/features/1234?with_lock=false' (200 OK) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-31T13:26:51.390

你可以这样设置，它对我有用：

```
static NSString *BASE_URL = @"http://www.yourdomain.com/api/v2";
RKObjectManager *objectManager = [RKObjectManager managerWithBaseURL:[NSURL URLWithString:BASE_URL]];
[objectManager postObject:rating path:@"ratings" parameters:nil success:nil failure:nil]; 
```

对我来说，问题是我提供了一个绝对路径：例如@"/ratings" 而不是@"ratings"。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T15:49:35.600

您是否曾经为 RESTKIt - Instance 设置过 baseUrl？你做一个

```
[[RKObjectManager alloc] initWithHTTPClient:client] 
```

新实例。

但后来你打电话

```
[RKObjectManager sharedManager] 
```

首先尝试初始化一个共享的 RKobject，例如： [RKObjectManager objectManagerWithBaseURL:... 而不是使用共享实例来创建新的 AFHTTPClient 对象。

# django - 默认模型管理器仅获取属于已登录用户的对象

> ID：15396209
> 
> 赞同：0
> 
> 时间：2013-03-13T20:50:56.277
> 
> 标签：django, django-models, django-managers

当我得到一个对象列表时，我只想要属于登录用户的对象。

我在想，也许这可以通过覆盖默认管理器在模型管理器中完成，但我不确定如何让登录使用。这是我目前所拥有的......

```
class GroupsManager(models.Manager):
    def get_query_set(self):
        return super(GroupsManager, self).get_query_set().filter(user=???????) 
```

我在正确的轨道上吗？我怎样才能实现我的目标？还是有更好的方法来做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T20:59:04.873

您无权访问`request`模型或模型管理器中的（以及当前登录的用户）。因此，您可以编写一个通用管理器方法，该方法接受用户实例并仅返回属于该用户的对象：

```
class GroupsManager(models.Manager):
    def for_user(self, user):
        return self.get_query_set().filter(user=user) 
```

在你的模型中：

```
class Group(models.Model):
    objects = GroupsManager() 
```

在视图中：

```
def my_view(request):
    groups = Group.objects.for_user(request.user) 
```

# terminal - man.cgi 如何处理 cat 与 mdoc 手册页？

> ID：15396215
> 
> 赞同：0
> 
> 时间：2013-03-13T20:51:30.183
> 
> 标签：terminal, bsd, cat, manpage, groff

我想创建一个包含 BSD 手册页集合的站点，类似于 man.cgi，但静态 HTML，并且还包括端口树中的所有内容。

我已经尝试从最近发布的所有 OpenBSD 包中解包`man/`，我注意到虽然有些包提供了.`mdoc``man/man?/page.?``man/cat?/page.0`

我可以使用`groff -mdoc -Thtml`or`mandoc -Txhtml`中的`mdoc`文件`man/man?/`，但是如何将`cat`文件从`man/cat?/`转换为 XHTML？

FreeBSD.org 和 NetBSD.org 上的那些 man.cgi 脚本是如何做到这一点的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-17T21:46:45.730

在[MirBSD 中](https://www.mirbsd.org/man.htm)，我们将所有在线手册页作为静态 HTML 提供（实际的 Web CGI 非常小），并使用[狡猾的脚本](https://www.mirbsd.org/cvs.cgi/src/scripts/roff2htm)将输出转换`nroff -Tcol foo.1 | col -x`为 XHTML/1.1——尽管为了使其工作，我们不得不调整 nroff (1)*和*mdoc 和 man 宏包（还有 ms 和 me 等）略。不过，我们只提供来自 base 的所有联机帮助页，以及历史悠久的 BSD 文档。

此外，GNU gnroff 没有 -Tcol，但 -Tascii 可以工作——但如果你想将它与 gnroff 输出一起使用，你可能需要相应地更改正则表达式。

编辑此文件时要格外小心：它包含正常的 UTF-8 内容以及额外的控制字符和无效的字节序列；如果你不小心，你的编辑器**会**损坏它。（我自己正在使用[jupp](https://www.mirbsd.org/jupp.htm)。）

如需更多关于此的实时反馈，请随时访问 MirBSD IRC 频道。

至于你最初的目标：我建议只从二进制包中收集手册页，因为它们经常在编译过程中被改变，比如在 autoconf 中被 AC_SUBST 改变，甚至只作为包构建的一部分生成。

# oracle - Where 子句中的 if 语句

> ID：15396217
> 
> 赞同：14
> 
> 时间：2013-03-13T20:51:41.103
> 
> 标签：oracle, plsql, plsqldeveloper

我正在处理一个在“WHERE”子句中包含“IF”语句的查询。但是 PL\SQL Developer 在执行时给出了一些错误。谁能帮我正确查询？这是查询：

```
SELECT t.first_name,
       t.last_name,
       t.employid,
       t.status
  FROM employeetable t
 WHERE IF status_flag = STATUS_ACTIVE then t.status = 'A'
       IF status_flag = STATUS_INACTIVE then t.status = 'T'
       IF source_flag = SOURCE_FUNCTION then t.business_unit = 'production'
       IF source_flag = SOURCE_USER then t.business_unit = 'users'
   AND t.first_name LIKE firstname
   AND t.last_name LIKE lastname
   AND t.employid LIKE employeeid; 
```

我收到错误“ORA-00920：无效的关系运算符”。

将括号括起来`status_flag = STATUS_ACTIVE`会导致错误“ORA-00907：缺少右括号”

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-14T00:26:10.117

案例可能会帮助您：

```
SELECT t.first_name,
       t.last_name,
       t.employid,
       t.status
  FROM employeetable t
 WHERE t.status = (CASE WHEN status_flag = STATUS_ACTIVE THEN 'A'
                        WHEN status_flag = STATUS_INACTIVE THEN 'T'
                        ELSE null END)
   AND t.business_unit = (CASE WHEN source_flag = SOURCE_FUNCTION THEN 'production'
                               WHEN source_flag = SOURCE_USER THEN 'users'
                               ELSE null END)
   AND t.first_name LIKE firstname
   AND t.last_name LIKE lastname
   AND t.employid LIKE employeeid; 
```

[CASE 语句](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/case_statement.htm)评估多个条件以产生单个值。因此，在第一次使用中，我检查 status_flag 的值，根据它的值返回“A”、“T”或 null，并将其与 t.status 进行比较。我使用第二个 CASE 语句对 business_unit 列执行相同的操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-13T20:56:33.337

你不能像那样使用 IF 。你可以用 AND 和 OR 做你想做的事：

```
SELECT t.first_name,
       t.last_name,
       t.employid,
       t.status
  FROM employeetable t
 WHERE ((status_flag = STATUS_ACTIVE   AND t.status = 'A')
     OR (status_flag = STATUS_INACTIVE AND t.status = 'T')
     OR (source_flag = SOURCE_FUNCTION AND t.business_unit = 'production')
     OR (source_flag = SOURCE_USER     AND t.business_unit = 'users'))
   AND t.first_name LIKE firstname
   AND t.last_name  LIKE lastname
   AND t.employid   LIKE employeeid; 
```

# php - EBootstrapActiveForm 显示“（必需）”而不是 *

> ID：15396224
> 
> 赞同：0
> 
> 时间：2013-03-13T20:52:08.173
> 
> 标签：php, yii

当我使用

```
 <?php $form=$this->beginWidget('EBootstrapActiveForm', array(... 
```

代替

```
 <?php $form=$this->beginWidget('CActiveForm', array(..., 
```

默认必填字段标记`*`替换为“（必填）”一词。我怎样才能找回*标记？以下是我正在使用的输入字段片段：

```
 <?php echo $form->beginControlGroup($model, 'first_name'); ?>
    <?php echo $form->labelEx($model,'first_name'); ?>
    <?php echo $form->beginControls(); ?>
        <?php echo $form->textField($model,'first_name',array('size'=>60,'maxlength'=>64)); ?>
        <?php echo $form->error($model,'first_name'); ?>
    <?php echo $form->endControls(); ?>
    <?php echo $form->endControlGroup(); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T18:09:07.070

基于 EBootstrapActiveForm，不应更改默认标记！

[他们网站上的完整示例](http://visualappeal.github.com/YiiBootstrap/index.php/site/contact/index.html)显示`*`标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T08:49:49.557

扩展所需标签标记的基础[源代码](https://github.com/VisualAppeal/YiiBootstrap/blob/master/EBootstrap.php#L494)可以这样更改：

```
EBootstrap::$afterRequiredLabel = '*'; 
```

在调用`EBootstrapActiveForm`小部件之前将其放在任何地方。

# opencart - Opencart：主产品列表，多个从站点可能吗？

> ID：15396227
> 
> 赞同：0
> 
> 时间：2013-03-13T20:52:15.090
> 
> 标签：opencart

我的一位 B2B 合作伙伴今天问了我一个问题。我喜欢它在我头顶上方发出的嗖嗖声，因为我什至从未看过 OpenCart 中的一行代码。我向他建议我可以把它贴在这里，专家们住的地方。

**一探究竟：**

> 我正在将 opencart 视为我们拥有的开发项目的解决方案，我想知道是否有人知道是否可以将 OpenCart 设置为主/从配置。所有站点都将位于具有不同 IP 和不同域名的同一台服务器上，因此我将为主站点和每个从站/产品站点使用相同的核心数据库。
> 
> 我正在寻找一种通过一次登录来管理所有产品的方法，这样我们就不需要管理多个商店。有没有办法对产品进行分组，以便我可以按品牌对它们进行分组，以便它们只显示在它们的目标网站上？我只是想与社区核实一下是否有人熟悉此设置。
> 
> ![图。1。](../Images/f5b64014721e63c1c959be93fa35d813.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T13:39:56.247

此外，它支持多域、多语言和多币种。关于答案。shadyyx 已经发布了。我正在进一步讨论技术方面。

```
web server loadbalanced via dns:

opencart webserver1
php, nginx, apc, memcache
multiple stores on this server. The files and content is cloned to two other servers and they clone and sync every 1 hour. They get hits for high traffic.
opencart webserver2 - slave, cloned of webserver1
opencart webserver3 - slave, cloned of webserver1

cdn1 - rackspace cloud files - images, css, javascript
cdn2 - rackspace cloud files - xml, html, videos

database loadbalanced:

database mysql master server 1

database mysql slave server 2
database mysql slave server 3 
```

所以你可以看到。Opencart 是一个很好的解决方案。处理同一服务器和/或不同服务器上的多个商店。一起工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T11:09:04.070

我猜它从 OC 1.4.9 开始就受支持 - 它被称为*multistore*。

你有一个网店、一个管理、一个数据库、一组产品、类别等。

您在*主*管理中管理数据并设置哪些数据在*从属*存储中可见。每个*从属*存储都必须是主*主*域的别名域/子域。

结果：这是可能的，而且并不难实现。*然后，您可以对每个从属*商店进行不同的设置（本地化、主题、产品设置、订单设置……） 。

# ios - 点击状态栏时我可以禁用/编辑自动跳转到顶部滚动吗？

> ID：15396231
> 
> 赞同：7
> 
> 时间：2013-03-13T20:52:35.350
> 
> 标签：ios, objective-c, uitableview, uiscrollview, scrolltop

我正在使用带有自动向下滚动的 tableView 的应用程序，因此点击通常会跳到表格顶部的状态栏会导致问题（它开始滚动，但如果自动滚动滴答作响，它会停止并离开它在中间的某个地方）。

我要么想禁用它，要么至少在点击它时插入一些代码以暂时暂停计时器，然后在它到达顶部时恢复它。

有什么方法可以实现这些目标吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-13T21:01:12.163

`UIScrollView`（并且`UITableView`作为它的子类）具有`scrollsToTop`默认为 的属性`YES`，使其在点击状态栏时滚动到顶部。您所要做的就是将其设置为`NO`.

但是，请记住，iOS 用户可能会期待这种行为，因此从用户体验的角度来看，将其关闭可能不是最好的主意。如果您只需要在特定时间禁用它，您也可以保留它并从委托方法`YES`返回。`NO``-scrollViewShouldScrollToTop:`

实际上，通过委托处理它可能非常适合您的情况：

```
- (BOOL)scrollViewShouldScrollToTop:(UIScrollView *)scrollView
{
    // disable timer
    return YES;
}

- (void)scrollViewDidScrollToTop:(UIScrollView *)scrollView
{
    // re-enable timer
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-13T20:57:08.593

你可以试试：

```
[myView setScrollsToTop:NO]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-04-15T08:50:35.303

对于迅捷5

```
override func scrollViewShouldScrollToTop(_ scrollView: UIScrollView) -> Bool {
    return false
} 
```

# jquery - jQuery分页和下拉菜单不能一起工作

> ID：15396239
> 
> 赞同：1
> 
> 时间：2013-03-13T20:53:07.500
> 
> 标签：jquery, pagination

我正在处理一个页面，其中包含按年份划分的新闻稿列表。该页面有一个默认为当前年份的下拉菜单，但用户也可以选择前一年。我正在使用带有下拉菜单的显示/隐藏来显示所选列表。这部分正在工作。

我还添加了 easypagination 插件，因此每年只显示前四篇新闻稿，并可选择点击页面底部的“OLDER”链接或页码。问题是只有从使用分页的下拉列表中的第一年（在这个例子中，自 2013 年以来的 2012 年只有 3 个新闻稿）。2012 完美运行，但如果你转到 2011，它可以运行，但 class="current" 永远不会到达那个‹li›，并且当前的底部页码永远不会突出显示。

我的问题是如何更改我的代码，以便当用户点击下拉菜单时，函数会识别出操作重置并将 class="current" 附加到正确的第一个‹li›？

这是 JSFiddle [http://jsfiddle.net/brianjschneider/GjXJR/](http://jsfiddle.net/brianjschneider/GjXJR/)

任何帮助将不胜感激！我认为问题/解决方案在这个函数的某个地方：

```
$.fn.easyPaginate = function (options) {

    var defaults = {
        step: 4,
        delay: 0,
        numeric: true,
        nextprev: true,
        auto: false,
        loop: false,
        pause: 10000,
        clickstop: true,
        controls: 'pagination',
        current: 'current',
        randomstart: false
    };

    var options = $.extend(defaults, options);
    var step = options.step;
    var lower, upper;
    var children = $(this).children();
    var count = children.length;
    var obj, next, prev;
    var pages = Math.floor(count / step);
    var page = (options.randomstart) ? Math.floor(Math.random() * pages) + 1 : 1;
    var timeout;
    var clicked = false;

    function show() {
        clearTimeout(timeout);
        lower = ((page - 1) * step);
        upper = lower + step;
        $(children).each(function (i) {
            var child = $(this);
            child.hide();
            if (i >= lower && i < upper) {
                setTimeout(function () {
                    child.fadeIn('fast')
                }, (i - (Math.floor(i / step) * step)) * options.delay);
            }
            if (options.nextprev) {
                if (upper >= count) {
                    next.fadeOut('fast');
                } else {
                    next.fadeIn('fast');
                };
                if (lower >= 1) {
                    prev.fadeIn('fast');
                } else {
                    prev.fadeOut('fast');
                };
            };
        });
        $('li', '#' + options.controls).removeClass(options.current);
        $('li[data-index="' + page + '"]', '#' + options.controls).addClass(options.current);

        if (options.auto) {
            if (options.clickstop && clicked) {} else {
                timeout = setTimeout(auto, options.pause);
            };
        };
    }; 
```

# python - cx_Oracle 'ORA-01843: not a valid month' with unicode parameter

> ID：15396241
> 
> 赞同：6
> 
> 时间：2013-03-13T20:53:13.067
> 
> 标签：python, oracle, unicode, cx-oracle

我有以下内容：（使用 ipython）

```
In [30]: con = cx_Oracle.connect('refill_test02/******@MYDB')

In [31]: cur = con.cursor()

In [32]: cur.execute("ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS' NLS_TIMESTAMP_FORMAT = 'YYYY-MM-DD HH24:MI:SS.FF'")

In [33]: cur.execute("select to_date(:0), to_timestamp(:1) from dual", ['2013-03-12', '2013-03-12 08:22:31.332144'])
Out[33]: <__builtin__.OracleCursor on <cx_Oracle.Connection to refill_test02@MYDB>>

In [34]: cur.fetchall()
Out[34]: 
[(datetime.datetime(2013, 3, 12, 0, 0),
  datetime.datetime(2013, 3, 12, 8, 22, 31, 332144))]

In [35]: cur.execute("select to_date(:0), to_timestamp(:1) from dual", [u'2013-03-12', '2013-03-12 08:22:31.332144'])
Out[35]: <__builtin__.OracleCursor on <cx_Oracle.Connection to refill_test02@MYDB>>

In [36]: cur.fetchall()
Out[36]: 
[(datetime.datetime(2013, 3, 12, 0, 0),
  datetime.datetime(2013, 3, 12, 8, 22, 31, 332144))]

In [37]: cur.execute("select to_date(:0), to_timestamp(:1) from dual", [u'2013-03-12', u'2013-03-12 08:22:31.332144'])
---------------------------------------------------------------------------
DatabaseError                             Traceback (most recent call last)
/home/xxxxx/<ipython-input-37-8af80e5fc40c> in <module>()
----> 1 cur.execute("select to_date(:0), to_timestamp(:1) from dual", [u'2013-03-12', u'2013-03-12 08:22:31.332144'])

DatabaseError: ORA-01843: not a valid month

In [38]: cur.execute("select to_date(:0), to_timestamp(:1) from dual", [u'2013-03-12', '2013-03-12 08:22:31.332144'])
---------------------------------------------------------------------------
DatabaseError                             Traceback (most recent call last)
/home/xxxx/<ipython-input-38-bc628f006aa3> in <module>()
----> 1 cur.execute("select to_date(:0), to_timestamp(:1) from dual", [u'2013-03-12', '2013-03-12 08:22:31.332144'])

DatabaseError: ORA-01843: not a valid month

In [39]: cur.execute("ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS' NLS_TIMESTAMP_FORMAT = 'YYYY-MM-DD HH24:MI:SS.FF'")

In [40]: cur.execute("select to_date(:0), to_timestamp(:1) from dual", [u'2013-03-12', '2013-03-12 08:22:31.332144'])
Out[40]: <__builtin__.OracleCursor on <cx_Oracle.Connection to refill_test02@MYDB>>

In [41]: cur.fetchall()
Out[41]: 
[(datetime.datetime(2013, 3, 12, 0, 0),
  datetime.datetime(2013, 3, 12, 8, 22, 31, 332144))] 
```

出于某种原因，我不能将 unicode 字符串用于时间戳参数（IN[37]），更奇怪的是，在我这样做之后，我需要重置会话 NLS 格式，然后才能再次使用普通字符串。

我正在使用：Cx_Oracle 5.1.2 python 2.7.3 Oracle 10.2.0.1.0

有任何想法吗？

感谢您花时间阅读本文。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-24T07:02:58.607

这实际上是 Oracle 10.5.0.2 和 11.2.0.1 中的一个错误。

错误可以重现如下：

在会话中设置 NLS_TIMESTAMP_FORMAT。

使用 unicode 数据运行任何隐式或显式 TO_DATE 转换。

下一个带有 unicode 数据的隐式或显式 TO_TIMESTAMP 将触发时间戳格式的内部重置。

所有连续的 TO_TIMESTAMP 都将失败，并且时间戳的 TO_CHAR 将产生无效输出。

这是测试行为的代码：

```
ALTER SESSION SET NLS_TERRITORY = 'AMERICA';
ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS' NLS_TIMESTAMP_FORMAT = 'YYYY-MM-DD HH24:MI:SS.FF';

REM --- WORKS:
SELECT TO_TIMESTAMP('2013-06-24 18:15:10.312') FROM DUAL;

REM --- WORKS:
SELECT TO_DATE('2013-06-24 18:15:10') FROM DUAL;

REM --- WORKS:
SELECT TO_TIMESTAMP('2013-06-24 18:15:10.312') FROM DUAL;

REM --- WORKS:
SELECT TO_TIMESTAMP(x) FROM (SELECT CAST('2013-06-24 18:15:10.312' AS NVARCHAR2(30)) AS X FROM DUAL);

REM --- WORKS:
SELECT TO_DATE(x) FROM (SELECT CAST('2013-06-24 18:15:10' AS NVARCHAR2(30)) AS X FROM DUAL);

REM --- WORKS:
SELECT TO_TIMESTAMP('2013-06-24 18:15:10.312') FROM DUAL;

REM !!! FAILS!
SELECT TO_TIMESTAMP(x) FROM (SELECT CAST('2013-06-24 18:15:10.312' AS NVARCHAR2(30)) AS X FROM DUAL);

REM !!! FAILS!
SELECT TO_TIMESTAMP('2013-06-24 18:15:10.312') FROM DUAL;

REM --- WORKS:
SELECT TO_DATE('2013-06-24 18:15:10') FROM DUAL; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-31T11:46:36.457

根据[jtiai](https://stackoverflow.com/users/546062/jtiai)问题[描述](https://stackoverflow.com/a/17269719/565525)，我做了以下解决方法 - 在调用任何有问题的 sql-s（例如 oracle 10.5.0.2 和 11.2.0.1，cx_oracle 5.1.2）之前，再次重置 NLS_DATE_FORMAT/NLS_TIMESTAMP_FORMAT：

```
cursor.execute(
     "ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS'"
     " NLS_TIMESTAMP_FORMAT = 'YYYY-MM-DD HH24:MI:SS.FF'")

# do execute ...
cursor.execute(query, params) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-22T14:49:14.933

我无法使用 RHEL 5、Cx_Oracle 5.1 python 2.4.3 Oracle 11.2.0.3.0 重新创建错误 您是否尝试使用带有 to_date 和 to_timestamp 函数的格式字符串？

[https://gist.github.com/fclrc/5435561](https://gist.github.com/fclrc/5435561)

```
#! /bin/python
import cx_Oracle
import platform

print ("Python version: " + platform.python_version())
print ("cx_Oracle version: " + cx_Oracle.version)
print ("Oracle client: " + str(cx_Oracle.clientversion()).replace(', ','.'))

connection = cx_Oracle.connect('user/pass@tns')
cursor = connection.cursor()
#
# Option with format strings
#
cursor.execute("""select to_date(:arg1,'yyyy-mm-dd'), to_timestamp(:arg2,'yyyy-mm-dd hh24.mi.ss.ff') from dual""", arg1=u'2013-03-12', arg2=u'2013-03-12 08:22:31.332144')
#
# Option without format strings
#
#cursor.execute("ALTER SESSION SET NLS_DATE_FORMAT = 'YYYY-MM-DD HH24:MI:SS' NLS_TIMESTAMP_FORMAT = 'YYYY-MM-DD HH24:MI:SS.FF'")
#cursor.execute("select to_date(:0), to_timestamp(:1) from dual", [u'2013-03-12', u'2013-03-12 08:22:31.332144'])

mydate = cursor.fetchall()
print mydate
cursor.close()
connection.close() 
```

# json - 为不同类型的项目数组正确的 JSON Schema

> ID：15396251
> 
> 赞同：34
> 
> 时间：2013-03-13T20:53:54.913
> 
> 标签：json, validation, jsonschema

我有一个无序的 JSON 项目数组。根据规范[https://datatracker.ietf.org/doc/html/draft-zyp-json-schema-03#section-5.5](https://datatracker.ietf.org/doc/html/draft-zyp-json-schema-03#section-5.5)，下面的 json 模式将仅验证数组中的对象是否按该顺序出现。我不想指定顺序，只需验证数组中的对象，无论对象的顺序或数量如何。从规范来看，我似乎无法理解这是如何完成的。

```
"transactions" : {
    "type" : "array",
    "items" : [
        {
            "type" : "object",
            "properties" : {
                "type" : {
                    "type" : "string",
                    "enum" : ["BUILD", "REASSIGN"]
                }
            }
        },
        {
            "type" : "object",
            "properties" : {
                "type" : {
                    "type" : "string",
                    "enum" : ["BREAK"]
                }
            }
        }
    ]
} 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-03-28T02:38:29.903

我在 JSON schema google group 上问了同样的问题，很快就得到了回答。用户 fge 要求我在此处发布他的回复：

> 你好，
> 
> 当前的规范是草案 v4，而不是草案 v3。更具体地说，验证规范在这里：
> 
> [https://datatracker.ietf.org/doc/html/draft-fge-json-schema-validation-00](https://datatracker.ietf.org/doc/html/draft-fge-json-schema-validation-00)
> 
> 该网站不是最新的，我不知道为什么...我将提交一个拉取请求。
> 
> 使用草稿 v4，您可以使用：

```
{
    "type": "array",
    "items": {
        "oneOf": [
            {"first": [ "schema", "here" ] }, 
            {"other": [ "schema": "here" ] }
        ]
    }  
} 
```

> 例如，这是一个数组的模式，其中项目可以是字符串或整数（尽管它可以用更简单的方式编写）：

```
{
    "type": "array",
    "items": {
        "oneOf": [
            {"type": "string"},
            {"type": "integer"}
        ]
    }
} 
```

这是正确的答案。我更正的架构现在包括：

```
"transactions" : {
    "type" : "array",
    "items" : {
        "oneOf" : [
            {
                "type" : "object",
                "properties" : {
                    "type" : {
                        "type" : "string",
                        "enum" : ["BUILD", "REASSIGN"]
                    }
                }
            },
            {
               "type" : "object",
               "properties" : {
                 "type" : {
                   "type" : "string",
                   "enum" : ["BREAK"]
                  }
               }
            }
        ]
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-27T21:24:15.387

我也已经研究了很长时间。但一直未能找到可行的解决方案。如果您只有一个架构，例如，它可以正常工作。

```
"transactions" : {
          "type" : "array",
          "items" : 
          {
            "type" : "object",
            "properties" : {
              "type" : {
                "type" : "string",
                "enum" : ["BREAK"]
              },
          }
} 
```

然后你只需跳过数组括号，并使用一个对象。但是，如果你想做你正在做的事情，似乎没有可靠的答案。这是迄今为止我发现的唯一东西：http: [//the-long-dark-tech-time.blogspot.se/2012/12/using-json-schema-with-array-of-mixed.html](http://the-long-dark-tech-time.blogspot.se/2012/12/using-json-schema-with-array-of-mixed.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-02-18T11:09:29.370

对于任何坚持草案 3 模式的人。有一个“Type”关键字相当于草案 4 中的“anyOf”：

所以你可以使用

```
{
    "fooBar" : {
        "type" : "array",
        "items" : {
            "type" : [{
                    "type" : "object",
                    "properties" : {
                        "foo" : {                           
                            "type" : "string"
                        }
                    }
                }, {
                    "type" : "object",
                    "properties" : {
                        "bar" : {
                            "type" : "string"
                        }
                    }
                }
            ]
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-18T13:42:06.123

*作为对用户 Vdex 的回应：*这不等效，您所写的意思是数组元素在数组中以**这种特定顺序**出现。

如果您使用[此模式验证器](https://www.jsonschemavalidator.net/)，则需要正确实现。

使用此架构：

```
{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "type": "array",
  "items": [
    {
      "type": "boolean"
    },
    {
      "type": "number"
    },
    {
      "type": "string"
    }
  ]
} 
```

此 JSON 将被验证：

```
[
  true,
  5,
  "a",
  "6",
  "a",
  5.2
] 
```

但不是这个：

```
[
  5,
  true,
  "a",
  "6",
  "a",
  5.2
] 
```

因此，目标与“oneOf”等关键字完全不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-12-03T08:12:41.187

就我而言，我希望数组中的第一个元素具有特定格式，其余元素具有另一种格式。这是我的解决方案：

```
my_schema = {
    "type": "object",
    "properties": {
        "token": {"type": "string"},
        "service_id": {"type": "string"},
        "promo_code": {"type": "string"},
        "path": {
            "type": "array",
            "items": [
                {
                    "type": "object",
                    "properties": {
                        "address": {"type": "string"},
                        "lat": {"type": "number"},
                        "lng": {"type": "number"}
                    },
                    "required": ["address", "lat", "lng"]
                },
                {
                    "type": "object",
                    "properties": {
                        "address": {"type": "string"},
                        "lat": {"type": "number"},
                        "lng": {"type": "number"},
                        "district_id": {"type": "number"},
                        "ward_code": {"type": "number"},
                        "weight": {"type": "number"}
                    },
                    "required": ["address","lat", "lng","ward_code", 
                                 "district_id", "weight"]
                }
            ]
        }
    },
    "required": ["token", "service_id", "path"]
} 
```

上面的模式意味着从路径的第二个元素开始，我需要 District_id、ward_code、权重

# java - drawPolygon 保持从开始（mousePressed）位置到当前（mouseDragged）位置的绘制线

> ID：15396258
> 
> 赞同：1
> 
> 时间：2013-03-13T20:54:16.520
> 
> 标签：java, awt, polygon, graphics2d, java-2d

所以，我试图从单击鼠标开始动态绘制多边形，直到我停止拖动和释放。而不是，为了这个问题，当我点击时绘制一个方形轮廓，向下拖动，然后向右，然后向上，然后向左，这就是发生的事情：http: [//imgur.com/t8ZN3Pp](http://imgur.com/t8ZN3Pp)

有什么建议么？

笔记：

model.addPolygon() 创建一个带有起点的多边形并将其添加到一个名为“polys”的 ArrayList

model.addPolygonPoint() 将点添加到存储在“polys”中的这个创建的多边形中

我的绘画功能通过多边形迭代绘画

```
public void mousePressed(MouseEvent e) {                
    oldX = e.getX();
    oldY = e.getY();
    model.addPolygon(oldX, oldY);     
}

public void mouseDragged(MouseEvent e) {
    currentX = e.getX();
    currentY = e.getY();
    model.addPolyPoint(currentX, currentY);
    repaint();
} 
```

. . . 然后在paintComponent中：

```
 for (ListIterator<Polys> iter = 
                model.polys.listIterator(model.polys.size()); 
                iter.hasPrevious();){
            graphics2D.draw(iter.previous().poly); 
```

全漆组件：

```
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    if (image == null) {
        image = createImage(getSize().width, getSize().height);
        graphics2D = (Graphics2D) image.getGraphics();
        graphics2D.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                RenderingHints.VALUE_ANTIALIAS_ON);
    }
    g.drawImage(image, 0, 0, null);

    for (ListIterator<Polys> iter = 
            model.polys.listIterator(model.polys.size()); 
            iter.hasPrevious();){
        graphics2D.draw(iter.previous().poly);

        }   
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T22:46:55.113

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.event.MouseMotionAdapter;

public class Testing {

    private static int lastX;
    private static int lastY;

    private static int modX;
    private static int modY;

    private static final BasicStroke STROKE = new BasicStroke(2.0F);

    private static final Point[] SHAPE = new Point[]{

            new Point(10, 10),
            new Point(10, 40),
            new Point(60, 90),
            new Point(50, 50)

    };

    public static void main(final String[] args) {

        final JFrame frame = new JFrame("Polygon Movement");
        final JPanel pane = new JPanel() {
            @Override
            public void paintComponent(final Graphics g1) {
            final Graphics2D g = (Graphics2D) g1;
            g.setColor(Color.RED);
            g.translate(modX, modY);
            g.setStroke(STROKE);
            for (int i = 0; i < SHAPE.length; i++) {
                g.drawLine(SHAPE[i].x, SHAPE[i].y, SHAPE[(i + 1) % SHAPE.length].x, SHAPE[(i + 1) % SHAPE.length].y);
            }
        }
    };
    pane.addMouseMotionListener(new MouseMotionAdapter() {
        @Override
        public void mouseDragged(MouseEvent e) {
            modX += e.getX() - lastX;
            modY += e.getY() - lastY;
            lastX = e.getX();
            lastY = e.getY();
            frame.repaint();
        }
    });
    pane.addMouseListener(new MouseAdapter() {
        @Override
        public void mousePressed(MouseEvent e) {
            lastX = e.getX();
            lastY = e.getY();
        }
    });

        pane.setPreferredSize(new Dimension(200, 200));
        frame.add(pane);
        frame.pack();
        frame.setVisible(true);

    }

} 
```

如您所见，我用定义的点制作了一个基本形状。这是最有效的方法，除非您希望更改基本形状（这里是静态的）。在这种情况下，您会找到它“抓取”的鼠标点并对其进行修改。无论哪种方式，都不需要添加或删除点。我使用这些术语`lastX`而不是`oldX`仅仅出于偏好。

BasicStroke 是完全可选的，与转换为`Graphics2D`对象相同。

该行：

```
g.drawLine(SHAPE[i].x, SHAPE[i].y, SHAPE[(i + 1) % SHAPE.length].x, SHAPE[(i + 1) % SHAPE.length].y); 
```

如果您以前尝试过这个东西，应该会有些意义。它遍历所有点，绘制一条从当前 ( `SHAPE[i]`) 到下一个 ( `SHAPE[(i + 1) & SHAPE.length`) 的线。

这种逻辑背后的原因是说你有 4 分，就像我们在这里所做的那样。通过它们的最后一次迭代，您将获得`i = 3`. 由于这一点，并且该数组仅包含 4 个索引 (0-3)，我们必须将该值恢复为零。为简单起见，我使用了，`% SHAPE.length`所以不需要特殊情况。

我还选择使用适配器，因为在 7 种可能的方法中只需要 2 种方法。

如果您有任何问题，请随时问我。

～传说

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T23:09:58.647

如果您只想绘制一个多边形。您可以简单地使用`Shape`API

这将允许您向形状“添加”点并允许形状自行绘制。

在这里，我使用了一个简单的`Path2D`形状，因为它允许我随着时间的推移附加点。我保留了一个正在运行的形状列表，它允许我根据需要生成多个多边形

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Point;
import java.awt.Shape;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.geom.Line2D;
import java.awt.geom.Path2D;
import java.util.ArrayList;
import java.util.List;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class DrawPolygon {

    public static void main(String[] args) {
        new DrawPolygon();
    }

    public DrawPolygon() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new PolyPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }

        });
    }

    public static class PolyPane extends JPanel {

        private MouseHandler mouseHandler;
        private Path2D currentShape;
        private List<Path2D> lstPloys;
        private Point lastPoint;
        private Point currentPoint;

        public PolyPane() {
            lstPloys = new ArrayList<>();
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        @Override
        public void addNotify() {
            super.addNotify();
            addMouseListener(getMouseHandler());
            addMouseMotionListener(getMouseHandler());
        }

        @Override
        public void removeNotify() {
            removeMouseListener(getMouseHandler());
            removeMouseMotionListener(getMouseHandler());
            super.removeNotify();
        }

        public MouseHandler getMouseHandler() {
            if (mouseHandler == null) {
                mouseHandler = new MouseHandler();
            }
            return mouseHandler;
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            Graphics2D g2d = (Graphics2D) g.create();
            if (lastPoint != null) {
                g2d.setColor(Color.RED);
                g2d.fillOval(lastPoint.x - 2, lastPoint.y - 2, 4, 4);
            }
            if (currentShape != null) {
                g2d.setColor(Color.RED);
                g2d.draw(currentShape);
                if (lastPoint != null && currentPoint != null) {
                    System.out.println(lastPoint + " - " + currentPoint);
                    g2d.setColor(new Color(255, 0, 0, 64));
                    g2d.draw(new Line2D.Float(lastPoint, currentPoint));
                }
            }
            g2d.setColor(Color.BLACK);
            for (Shape shape : lstPloys) {
                g2d.draw(shape);
            }
            g2d.dispose();
        }

        public class MouseHandler extends MouseAdapter {

            @Override
            public void mouseClicked(MouseEvent e) {
                if (e.getButton() == MouseEvent.BUTTON1) {
                    if (e.getClickCount() == 1) {
                        Point p = e.getPoint();
                        lastPoint = p;
                        if (currentShape == null) {
                            currentShape = new Path2D.Float();
                            currentShape.moveTo(p.x, p.y);
                        } else {
                            currentShape.lineTo(p.x, p.y);
                        }
                        repaint();
                    } else if (e.getClickCount() == 2) {
                        currentShape.closePath();
                        lstPloys.add(currentShape);
                        currentShape = null;
                        lastPoint = null;
                        repaint();
                    }
                }
            }

            @Override
            public void mouseMoved(MouseEvent e) {
                if (currentShape != null) {
                    currentPoint = e.getPoint();
                    repaint();
                } else {
                    currentPoint = null;
                }
            }

        }

    }

} 
```

查看[使用几何图形](http://docs.oracle.com/javase/tutorial/2d/geometry/index.html)了解更多详细信息

# jquery - 通过父页面中的href从子页面加载特定ID

> ID：15396262
> 
> 赞同：0
> 
> 时间：2013-03-13T20:54:38.877
> 
> 标签：jquery, jquery-ui-dialog

我正在尝试做的——如果可能的话——是从子页面加载特定的 ID 并将该内容显示在父页面的对话框中。单击医疗链接时，我想加载DIV ID“医疗”。我希望将某种选择器放在可以加载正确 ID 的 href 中。

Javascript：

```
$(document).ready(function() {
        var $loading = $('<img src="img/loading.gif" alt="loading" class="loading">');
        $('#prod-dialog td a').each(function() {
            var $dialog = $('<div></div>')
                .append($loading.clone());
            var $link = $(this).one('click', function() {
                $dialog
                    .load($link.attr('href'))
                    .dialog({
                        title: $link.attr('title'),
                        width: 300,
                        height: 200,
                        buttons: [
                    {
                        text: "Ok",
                            click: function() {
                        $( this ).dialog( "close" );
                            }
                        },
                    {
                        text: "Cancel",
                            click: function() {
                        $( this ).dialog( "close" );
                            }
                        }
                    ]
                });
                $link.click(function() {
                    $dialog.dialog('open');
                    return false;
                });
                return false;
            });
        });
    }); 
```

父 HTML：

```
<table id="prod-dialog">
            <tr>
              <td><div><img src="img/medical-icon.png" width="26" height="25" />
                <p>Medical</p>
                </div></td>
              <td><a href="medical.htm"><img src="img/dialog-icon_08.png" width="24" height="23" border="0"/></a></td>
              </tr>
</table> 
```

子页面 HTML：

```
<div style="display: none;" id="medical" title="Medical">
<table id="prod-content">
      <tr>
        <td><label>Coverage Level</label></td>
        <td>
            <select name="coverlevel" id="coverlevel">
                <option value="0" selected>Employee Only</option>
                <option value="1">Employee + Spouse</option>
                <option value="2">Employee + Children</option>
                <option value="3">Employee + Family</option>
            </select>
        </td>
      </tr>
      <tr>
        <td><label>Premium</label></td>
        <td><input name="premium" type="text" size="30"/></td>
      </tr>
      </table>
    </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T19:02:27.327

答案如下：

```
$(document).ready(function() {
    var $loading = $('<img src="img/loading.gif" alt="loading" class="loading">');
    $('#prod-dialog td a').each(function() {
        var $dialog = $('<div></div>')
            .append($loading.clone());
        var $link = $(this).one('click', function() {
            var $cnt = $(this).attr('href') + " #" + $(this).attr('id')
            $dialog
                .load($cnt)
                .dialog({
                    title: $link.attr('title'),
                    width: 300,
                    height: 200,
                    buttons: [
                    {
                        text: "Ok",
                        click: function() {
                            $( this ).dialog( "close" );
                        }
                    },
                    {
                    text: "Cancel",
                        click: function() {
                    $( this ).dialog( "close" );
                        }
                    }
                    ]
                });

            $link.click(function() {
                $dialog.dialog('open');
                return false;
            });
            return false;
        });
    });
}); 
```

# java - 如何在 Java 中解析前 4 个值的分隔符逗号分隔字符串

> ID：15396266
> 
> 赞同：1
> 
> 时间：2013-03-13T20:54:44.857
> 
> 标签：java, string, parsing, delimiter, comma

我目前正在尝试解析一个字符串，其输出为`1_3_5_1,1_3_7_1,1_4_9_1`

我已经运行了一个 for 循环：

```
String[] row;
for(String value : selValues.split("\\,")){
            System.err.println("value to be deleted :: "+value);
            for(int i = 0; i <= 4; i++) {
                row = value.split("\\_");
                System.out.println("print row :: " + row[0]);
                System.out.println("print row :: " + row[1]);
                System.out.println("print row :: " + row[2]);

            } 
```

我正在尝试捕获由“_”分隔的前 4 个。我正在寻找的是 row[] 是： `row[1,3,5,1] row[1,3,7,1] row[1,4,9,1]`

由于这些是我将在查询中发送到数据库的值。

现在，我的输出只是重复 1,3,5,1。

任何帮助将不胜感激。可能有更好的方法来做到这一点。谢谢！

**解决方案**

感谢大家的意见。我已经用它们清理了它并拥有这个：

```
if(selValues != null && !selValues.trim().equals("")){
        for(String value : selValues.split(",")){
                row = value.split("_");
                try{
                //database call here
                }
                catch (Exception e) {
                    e.printStackTrace();
                }
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T21:05:21.643

你必须`\\`从正则表达式中删除。

这将满足您的需要：

```
@Test
public void split2() {
    String input = "1_3_5_1,1_3_7_1,1_4_9_1";
    String[] csv = input.split(",");
    for(String v : csv) {
        String[] usv = v.split("_");
        System.out.print("[");
        for(int i = 0; i < usv.length; i++) {
            System.out.print(usv[i]);
            if(i < usv.length-1) {
                System.out.print(", ");
            }
        }
        System.out.println("]");
    }
} 
```

输出是

```
[1, 3, 5, 1]
[1, 3, 7, 1]
[1, 4, 9, 1] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T21:05:08.827

您的内部**for 循环**是不必要的。它的控制变量`i`未使用。否则，您的代码会给出正确的输出。

对于较大的逗号分隔列表，最好使用 csv 阅读器，而不是使用字符串。

**输出：http:** [//ideone.com/dzaIsh](http://ideone.com/dzaIsh)

# c++ - 与向量关联的 NULL 指针

> ID：15396267
> 
> 赞同：0
> 
> 时间：2013-03-13T20:54:49.500
> 
> 标签：c++, segmentation-fault, bounding-volume

在我的光线追踪器中，我正在构建一个包围体层次结构。我已经用了几天试图修复这个错误，但我似乎在做一些根本错误的事情。

第一种方法是被调用的构造，下面是使用 typedef std::vector Objects 数组的构造。

```
void BVH::build(Objects* objs)
{
    // construct the bounding volume hierarchy
    int size = objs->size();

    // Calculate the bounding box for this node
    BBox bb = (*objs)[0]->boundingBox();
    for ( int p = 1; p < size; p++ )
        bb.expandToInclude( (*objs)[p]->boundingBox());
    Vector3 pivot = (bb.max + bb.min) * 0.5f;
    tree.bbox = bb;

    int split = qsplit(objs, size, pivot.x, 0);

    tree.left = subdivision(objs, split, 1);
    tree.right = subdivision(&objs[split], size - split, 1);
} 
```

下面的方法使用此方法来构造我的二叉树中的叶节点。

```
Node* BVH::makeLeaf(Objects* objs, int num)
{
    Node* node = new Node;
    if ( num == 1 ) { node->objs = &objs[0]; }
    else if ( num == 2 ) { node->objs = ((&objs)[0],(&objs)[1]); }
    node->isLeaf = true;
    return node;
} 
```

这是一种递归方法，使用对象数组来拆分和构造节点和叶节点。

```
Node* BVH::subdivision(Objects* objs, int size, int axis)
{
    if ( size == 1 ) { return makeLeaf(objs, 1); }
    if ( size == 2 ) { return makeLeaf(objs, 2); }

    Node* node = new Node;
    node->isLeaf = false;

    BBox bb = (*objs)[0]->boundingBox();
    for ( int p = 1; p < size; p++ )
        bb.expandToInclude((*objs)[p]->boundingBox());
    node->bbox = bb;
    Vector3 pivot = (bb.max + bb.min) * 0.5f;

    int split = qsplit(objs, size, pivot[axis], axis);

    node->left = subdivision(objs, split, (axis + 1) % 3);
    node->right = subdivision(&objs[split], size - split, (axis + 1) % 3);

    return node;
} 
```

运行此代码会给我细分内的分段错误。

这是来自 gdb 的空指针的帖子：

```
debug: Loading "teapot.obj"...
debug: Loaded "teapot.obj" with 576 triangles

Program received signal SIGSEGV, Segmentation fault.
0x000000000040bb9e in BVH::subdivision (this=0x61f0c0, objs=0x61f100, size=5, axis=1) at BVH.cpp:44
44      BBox bb = (*objs)[0]->boundingBox();
(gdb) bt
0  0x000000000040bb9e in BVH::subdivision (this=0x61f0c0, objs=0x61f100, size=5, axis=1) at BVH.cpp:44
1  0x000000000040bdef in BVH::subdivision (this=0x61f0c0, objs=0x61f0a0, size=9, axis=0) at BVH.cpp:56
2  0x000000000040bd62 in BVH::subdivision (this=0x61f0c0, objs=0x61f0a0, size=18, axis=2) at BVH.cpp:53
3  0x000000000040bd62 in BVH::subdivision (this=0x61f0c0, objs=0x61f0a0, size=36, axis=1) at BVH.cpp:53
4  0x000000000040bd62 in BVH::subdivision (this=0x61f0c0, objs=0x61f0a0, size=72, axis=0) at BVH.cpp:53
5  0x000000000040bd62 in BVH::subdivision (this=0x61f0c0, objs=0x61f0a0, size=144, axis=2) at BVH.cpp:53
6  0x000000000040bd62 in BVH::subdivision (this=0x61f0c0, objs=0x61f0a0, size=288, axis=1) at BVH.cpp:53
7  0x000000000040b9ca in BVH::build (this=0x61f0c0, objs=0x61f0a0) at BVH.cpp:21
8  0x00000000004121ac in Scene::preCalc (this=0x61f0a0) at Scene.cpp:42
9  0x0000000000402fde in makeTeapotScene () at assignment1.cpp:113
10 0x000000000040f973 in main (argc=1, argv=0x7fffffffe798) at main.cpp:65
(gdb) p (*objs)[0]
$1 = (Object *&) @0x0: <error reading variable> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:46:06.620

```
(&objs)[0] 
```

是相同的

```
*(&objs) 
```

这与

```
objs 
```

同样的方式，

```
(&objs)[1] 
```

是相同的

```
objs + 1 
```

这很可能*不是*有效对象的地址。

线

```
node->objs = ((&objs)[0],(&objs)[1]); 
```

因为它使用逗号运算符，所以丢弃 的值`(&objs)[0]`并设置`node->objs`为`objs + 1`，这是无效的。

目前尚不清楚您希望该作业完成什么，所以我不知道您应该用什么替换它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T01:43:04.620

在这个有趣的 typedef 上使用了很多小时后，我得到了一位朋友的帮助，我们编写了一个适配器方法来转

```
vector<Object*>* into vector<Object*>& 
```

这使每种方法都看起来更干净、更漂亮。

```
void BVH::build(Objects* objs_orig)
{
    m_objects = objs_orig;
    std::vector<Object*>* objs = objs_orig;
    return build(*objs);
}

void BVH::build(const std::vector<Object*>& objs)
{
    tree = makeTree(objs, 1);
} 
```

# python - 使用 Matplotlib 从三列数据中绘制 RGB 图

> ID：15396269
> 
> 赞同：0
> 
> 时间：2013-03-13T20:54:52.543
> 
> 标签：python, colors, matplotlib, rgb

是否可以使用 Matplotlib 绘制 RGB 值图？

我从文本文件中读取了三列数据，格式如下，其中 x 和 y 是所需的坐标，z 是要在给定坐标处绘制的所需 rgb 颜色的十六进制字符串：

```
xyz 

1 0.5 #000000 

2 0.5 #FF0000 

3 0.5 #00FF00 

1 1.5 #0000FF 

2 1.5 #FFFF00 

3 1.5 #00FFFF 

1 1.5 #FF00FF 

2 2.5 #C0C0C0 

3 2.5 #FFFFFF

```

这是我目前的代码状态。griddata() 函数抛出错误：

```
import pandas as pds
import matplotlib.pyplot as plt

# Import text file using pandas
datafile = pds.read_csv(PathToData,sep='\t')

X=datafile.x
Y=datafile.y
Z=datafile.z

# Generate mesh as 'numpy.ndarray' type for plotting
# This throws the following error:
# ValueError: could not convert string to float: #FFAA39
Z=griddata(X, Y, Z, unique(X), unique(Y)) 
```

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T12:54:16.590

`griddata`是用于将不均匀间隔的数据插入到网格 ( [griddata doc](http://docs.scipy.org/doc/scipy/reference/generated/scipy.interpolate.griddata.html) ) 上的函数。在您的情况下，看起来您*已经*在网格上有数据，您只需要重塑它。你得到的错误是因为`griddata`试图将你的颜色十六进制代码转换为插值的浮点数，你*应该*得到它，因为`#00FF00`.

```
data_dims = (3, 3) # or what ever your data really is
X = np.asarray(x).reshape(data_dims)
Y = np.asarray(y).reshape(data_dims)
C = np.asarray([mpl.colors.colorConverter.to_rgb(_hz) for _hz in z]).reshape(data_dims + (3,)) 
# the colors converted to (r, g, b) tuples 
```

这些`asarray`调用是为了确保我们有数组，而不是数据帧。

如果您只想查看我们可以`imshow`用来绘制它的数组：

```
imshow(c, interpolation='none', 
       origin='bottom', 
       extent=[np.min(X), np.max(X), np.min(Y), np.max(Y)]) 
```

[颜色转换器文档](http://matplotlib.org/api/colors_api.html#matplotlib.colors.ColorConverter)，[`imshow`](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow)文档。

您可能需要转置/翻转/旋转`C`以获得您期望的方向。

# javascript - 无法在客户端编辑 json 文件

> ID：15396271
> 
> 赞同：1
> 
> 时间：2013-03-13T20:54:57.347
> 
> 标签：javascript, jquery, json

我想使用 javascript 编辑一个 json 文件。该文件是“client.json”，位于本地系统，仅在本地系统进行修改。我正在使用表单来创建新的客户详细信息，并且我希望将这些详细信息作为对象附加到 json 文件中。

```
 {"clients":[
        {
            "name":"xxxx",
            "team":"yyy",
            "location": {
                "city":"beijing",
                "country":"china"
                        },
        "wdays":{"start":"Monday","end":"friday"},
        "whours":{"start":"9 A.M","end":"6 P.M" }
        },
        {
            "name":"xxxx",
            "team":"yyy",
            "location": {
                "city":"new york",
                "country":"usa"
                       },
        "wdays":{"start":"Monday","end":"friday"},
        "whours":{"start":"9 A.M","end":"6 P.M" }
        }
]} 
```

以下javascript代码是关于从表单中读取数据并将该数据附加为json对象............`

```
</script>
<script type="text/javascript">
    function addtojson()
    {
       var client_name=(document.getElementById("cname")).value;
       var country=document.getElementById("country").value;
       var city=document.getElementById("city").value;
       var wtimeto=document.getElementById("wtimeto").value;
       var wtimefrom=document.getElementById("wtimefrom").value;
       var wdayto=document.getElementById("wdayto").value;
       var wdayfrom=document.getElementById("wdayfrom").value;
    jQuery.getJSON('client.json')
  .done(function(data) {
  var cobj=new Object();
  cobj.name=client_name;
  cobj.team="YYY";
  cobj.location=new Object();
  cobj.location.city=city;
  cobj.location.country=country;
  cobj.wdays=new Object();
  cobj.wdays.start=wdayto;
  cobj.wdays.end=wdayfrom;
  cobj.whours=new Object();
  cobj.whours.start=wtimeto;
  cobj.whours.end=wtimefrom;
  var myString = JSON.stringify(cobj);
  alert('I am working');
  alert(myString);
   data.clients.push(cobj);
      alert(JSON.stringify(data.clients[0]));//it gives previous first array object
      alert(JSON.stringify(data.clients[1]));//it gives previous second array object
      alert(JSON.stringify(data.clients[2]));//it gives the new appended array object
      });

return true;
} 
</script>` 
```

虽然数据正在程序中本地修改，但 json 文件没有得到更新??????????

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:04:15.730

浏览器中的 JavaScript 通常不允许写入本地磁盘。无论如何，加载 JSON 文件后，您正在内存中编辑加载的文档，这对磁盘上的文件没有影响，直到您将更改写入磁盘。这是您将遇到不允许从脚本写入磁盘的问题。

您*可能*能够使用动态生成的数据进行一些操作：URI 触发下载提示以下载文件的新版本并将其保存到磁盘。有关详细信息，请参阅[http://en.wikipedia.org/wiki/Data_URI_scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)。

# excel - 有匹配时的条件高亮行

> ID：15396273
> 
> 赞同：1
> 
> 时间：2013-03-13T20:55:01.050
> 
> 标签：excel, excel-formula, excel-2010, conditional-formatting, multiple-matches

在 Excel 中，我想在给定单元格中的文本更改时按行添加渐变突出显示，并使用条件格式。我有一个大约 1k 个帐户名称的列表，其中很多是相同的，并且我将它们全部按字母顺序排序。我想设置条件格式以将每个帐户名称按整行分组。例如：单元格 A1= `McDonalds`A2= `McDonalds`A3= `Wal-Mart`A4= `Wal-Mart`。

我想要将每个帐户组合在一起的颜色，因此`McDonalds`将是蓝色和`Wal-Mart`绿色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-29T00:32:02.633

我认为您需要一个辅助列，例如 E`1`在 row1 和`=IF(A1=A2,E1,E1+1)`E2 中播种并复制下来以适应。那么下面的公式应该适合条件格式：

![SO15396273 示例](../Images/d1a6caa0be0d064ebc4d4deef74f1314.png)

# c# - 什么 C# 类型代表 C++ float*？

> ID：15396275
> 
> 赞同：5
> 
> 时间：2013-03-13T20:55:04.690
> 
> 标签：c#

我有一个从已导入 C# 项目的 C++ 库中调用的函数

我认为它要求一个指向数组的指针。但我不知道如何使它工作。

这就是它的要求`function(float*, float*);`

但如果我做类似的事情

```
float[] f = {};
float[] f1 = {};

function(f,f1); 
```

它说有无效的论点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:20:08.747

float * 是 C# 中的浮点指针类型。

如果函数需要浮点指针参数 (float *)，则必须假定函数在指针上工作，可能涉及指针算术。因此，保留该签名很重要。

要将 C# 中的浮点数组作为浮点指针 (float*) 传递，您需要在不安全的上下文中固定/修复内存中的数组以获取指向它们的指针，您可以将其传递给函数以保留其功能：

```
unsafe
{
    fixed (float* ptr_f = f) //or equivalently "... = &f[0]" address of f[0]
    fixed (float* ptr_f2 = f2) //or equivalently "... = &f2[0]" address of f2[0]
    {
        function( ptr_f, ptr_f2 );
    }
} 
```

您还需要将程序集标记为不安全（在项目属性 > 构建选项卡 > 允许不安全代码复选框中）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T21:01:44.667

如果这是通过导入的方法，`DLLImport()`您可以简单地将数组指针替换为类型化数组。

所以一个签名：

```
[DLLImport("some.dll")]
SomeMethod(int* a, float* b) 
```

变成

```
[DLLImport("some.dll")]
SomeMethod(int[] a, float[] b) 
```

请注意，这假设原始 c/c++ 方法需要一个数组。如果指针不打算引用数组，这将不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T22:22:08.910

您需要确切*知道*调用的 C++ 函数期望什么。

在 C（和 C++）中，所有这些函数签名的所有意图和目的都完全相同：

```
void foo( float *x   , float *y   ) ;
void foo( float *x   , float  y[] ) ;
void foo( float  x[] , float *y   ) ;
void foo( float  x[] , float  y[] ) ; 
```

它们都带有 2 个参数，每个参数都包含一个指向（包含地址）类型变量的指针`float`。所有这些表达式在 C/C++ 中完全相同：

```
float x[] ;
float *y  ;

float r1 = *(x+37) ; // all evaluate to the zero-relative
float r2 = x[37]   ; // 37th element of the array.
float r3 = *(y+37) ;
float r4 = y[37]   ; 
```

*   表达式`*x`说：“获取`float`位于`x`.
*   表达式`*(x+n)`，其中`n`是一个整数值，表示“获取包含在 x 中的地址，并在其中添加由表达式获得的偏移量（以字节为单位）`sizeof(float) * n`。获取`float`位于结果地址处的值。
*   数组表达式`x[n]`完全等同于指针表达式`*(x+n)`。

由于 C/C++ 中的数组没有任何关联的元数据来描述它们的大小，因此您需要确切地知道被调用函数的期望。

通常，传递一个指针（通过引用调用）以允许调用者取消引用该点并为您设置一个值 - 相当于 C#`ref`和`out`关键字：

```
float x ;
float y ;
Foo( ref x , ref y ) ; // the callee MAY, but is not REQUIRED to set a value before returning to the caller.
Bar( out x , out y ) ; // the callee MUST set a value before returning to the caller. 
```

您的函数使用的惯用语始终用于定位数组，但通常也会传递一个大小：

```
void foo( float *array , int array_length ) ; 
```

虽然这并不罕见，但如果函数期望数组是一个非零数值列表，则类似于 C 风格、以 NUL 结尾的字符串。给定函数签名，例如：

```
float compute_mean( float *Xs ) ; 
```

期望这样调用它并不罕见：

```
float Xs[] = { 3.0 , 2.5 , 9.8 , 7,5 , 0 , } ;
float mean = compute_mean( Xs ) ; 
```

和定义是这样的：

```
float compute_mean( float *Xs )
{
  float n   = 0.0 ;
  float sum = 0.0 ;
  float mean ;
  while ( *p )
  {
    ++n ;
    sum += *p++ ;
  }
  mean = n > 0 ? sum / n : 0.0 ;
  return mean ;
} 
```

所以你需要知道你正在调用的方法的语义。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T21:00:14.877

这在 C# 中根本不起作用，当在 C# 中导入 C/C++ 库时，您应该使用`IntPtr`而不是 float*，请参阅此处的一些示例：[float* from C to C#](https://stackoverflow.com/questions/5236690/float-from-c-to-c-sharp)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-13T21:00:40.793

它要求一个浮点指针，（内存中包含 IEEE 浮点值的点的机器地址。）C# 不允许托管使用指针，因此您需要构造一个 [IntPtr](http://msdn.microsoft.com/en-us/library/system.intptr%28v=vs.71%29.aspx)变量并将其传递给 C++功能。

注意：仅仅因为它被调用`IntPtr`并不意味着它只是一个指向整数的指针。Int 是因为所有指针都是整数。它可以是指向任何东西的指针。

# php - Ajax 加载内容并附加相关的 url

> ID：15396276
> 
> 赞同：0
> 
> 时间：2013-03-13T20:55:13.110
> 
> 标签：php, jquery, ajax, codeigniter

我正在尝试在项目中使用 Ajax。

想法是当我单击一个选项卡时，相关数据应根据该选项卡加载。

但它也应该在我所在的当前表单的地址栏上附加 URL。

假设我点击了 ERP 标签，那么 ERP Divs 应该在页面内加载，但相对 url 也应该显示，例如 www.mydomain.com\erp

我知道 .load 函数，但它不会更新地址栏上的 url。加上数据将来自不同的文件。

左侧菜单也将来自角色库上的数据库。

我在这个项目中使用 codeigniter

我想拥有 Url 功能，因为用户可以轻松地使用完整的 url 直接访问该页面，而且它还提供了书签优势。

为了更方便，这里是截图。 ![在此处输入图像描述](../Images/27ec66b30ab239297bde2ed03a14fc25.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T20:59:21.783

AFAIK 如果不重新加载页面，您将无法更改实际 URL。

您必须使用“jquery-address”库。查看[https://github.com/asual/jquery-address](https://github.com/asual/jquery-address)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T22:27:36.187

我会在这里做两件不同的事情：

1.  要在不加载页面的情况下动态更改 URL，请使用新的[history.pushState()](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)方法。如果您支持较旧的浏览器，[history.js](https://github.com/balupton/history.js)本质上是回退到标签方法的相同 API。请注意，这些 URL**不能从外部访问。**因此：

2.  当用户访问其中一个 URL 时，默认打开选项卡为您尝试访问的任何一个。您将必须捕获预期的路线并在其上使用一些 javascript 魔术。

# android - 在谷歌地图 v2 上绘制虚线而不是实线

> ID：15396277
> 
> 赞同：4
> 
> 时间：2013-03-13T20:55:16.187
> 
> 标签：android, google-maps, google-maps-android-api-2

我不想创建一个带有实线的多边形，而是创建一个带有虚线的多边形，这可能吗？

我知道当您覆盖覆盖的`onDraw`方法`v1`但`Overlay`该类不再存在时您可以这样做，那么我还能如何实现呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T07:33:50.290

目前不可能，但您可以在此处支持此增强功能：[http ://code.google.com/p/gmaps-api-issues/issues/detail?id=4633](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4633)

**更新**

最近，Google 在 Google Maps Android API v2 中为折线和多边形实现了此功能，并将问题 4633 标记为已修复。

[请参阅“形状指南”](https://developers.google.com/maps/documentation/android-api/shapes#stroke_pattern)中有关笔划图案的信息。请参阅折线和多边形教程中的[示例](https://developers.google.com/maps/documentation/android-api/polygon-tutorial#add_custom_styling_to_your_polygon)。

您还可以在此处阅读相应的博客文章：

[https://maps-apis.googleblog.com/2017/02/styling-and-custom-data-for-polylines.html](https://maps-apis.googleblog.com/2017/02/styling-and-custom-data-for-polylines.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-20T09:00:59.213

在地图上距离中心 LatLng 半径单位的距离处找到一个 LatLng 现在将这两个 LatLngs 转换为 screenCoordinates

使用用于构造圆的公式 x = R *sin(theta) , y = R* cos(theta)

您将圆分成 N 段，然后在圆的圆周上绘制折线（在地图上绘制），将屏幕坐标转换为 LatLngs

N的数量越多看起来像一个圆圈，我根据缩放级别使用了N = 120，我使用的是13。

```
private void addDottedCircle(double radius) {//radius is in kms

    clearDottedCircle();

    LatLng center,start,end;
    Point screenPosCenter,screenPosStart,screenPosEnd;
    Projection p = mMap.getProjection();

    center = searchCenterMarker.getPosition();
    start = new LatLng(center.latitude + radius/110.54,center.longitude);
    // radius/110.54 gives the latitudinal delta we should increase so that we have a latitude at radius distance
    // 1 degree latitude is approximately 110.54 kms , so the above equation gives you a rough estimate of latitude at a distance of radius distance 

    screenPosCenter = p.toScreenLocation(center);
    screenPosStart = p.toScreenLocation(start);

    double R = screenPosCenter.y - screenPosStart.y;
    int N = 120;//N is the number of parts we are dividing the circle
    double T = 2*Math.PI/N;
    double theta = T;

    screenPosEnd = new Point();
    screenPosEnd.x = (int)(screenPosCenter.x-R*Math.sin(theta));
    screenPosEnd.y = (int) (screenPosCenter.y-R*Math.cos(theta));
    end = p.fromScreenLocation(screenPosEnd);

    for(int i =0;i<N;i++){
        theta+=T;
        if(i%2 == 0){
            //dottedCircle is a hashmap to keep reference to all the polylines added to map
            dottedCircle.add(mMap.addPolyline(new PolylineOptions().add(start,end).width(5).color(Color.BLACK)));

            screenPosStart.x = (int) (screenPosCenter.x-R*Math.sin(theta));
            screenPosStart.y = (int) (screenPosCenter.y-R*Math.cos(theta));
            start = p.fromScreenLocation(screenPosStart);
        }
        else{
            screenPosEnd.x = (int)(screenPosCenter.x-R*Math.sin(theta));
            screenPosEnd.y = (int) (screenPosCenter.y-R*Math.cos(theta));
            end = p.fromScreenLocation(screenPosEnd);
        }

    }

} 
```

![画虚线圆后的图像](../Images/e334f34bdc119631fc4b559ac120177c.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-14T16:45:41.180

首先，看一下 API [https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/Polyline](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/Polyline)

v2 尚无法实现，但在 v3 javascript API 上已经实现，请看这里： [https ://developers.google.com/maps/documentation/javascript/overlays#PolylineSymbols](https://developers.google.com/maps/documentation/javascript/overlays#PolylineSymbols)

但似乎可以在 android 应用程序中使用这个 v3 javascript API，看这里： [https ://developers.google.com/maps/articles/android_v3](https://developers.google.com/maps/articles/android_v3)

也许，这会帮助你

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-25T06:00:10.890

如果您仍在寻找答案，请查看以下内容：

[如何使用 android google map sdk v2 绘制虚线折线？](https://stackoverflow.com/questions/13721008/how-to-draw-dashed-polyline-with-android-google-map-sdk-v2)

# asp.net-mvc - ASP.NET MVC2 应用程序在一段时间后进入错误状态

> ID：15396279
> 
> 赞同：1
> 
> 时间：2013-03-13T20:55:24.080
> 
> 标签：asp.net-mvc, asp.net-mvc-2, stack-trace

一段时间后（确切时间未定），我们的 MVC 应用程序开始出错，并显示下面的错误消息和堆栈跟踪。

我们没有注册任何自定义 ViewEngines...触摸 web.config 文件可以暂时清除此错误。

我会错过什么？

```
[InvalidOperationException: The property 'MasterLocationFormats' cannot be null or empty.]
   System.Web.Mvc.VirtualPathProviderViewEngine.GetPath(ControllerContext controllerContext, String[] locations, String[] areaLocations, String locationsPropertyName, String name, String controllerName, String cacheKeyPrefix, Boolean useCache, String[]& searchedLocations) +697
   System.Web.Mvc.VirtualPathProviderViewEngine.FindView(ControllerContext controllerContext, String viewName, String masterName, Boolean useCache) +288
   System.Web.Mvc.<>c__DisplayClass6.<FindView>b__4(IViewEngine e) +43
   System.Web.Mvc.ViewEngineCollection.Find(Func`2 cacheLocator, Func`2 locator) +96
   System.Web.Mvc.ViewResult.FindView(ControllerContext context) +144
   System.Web.Mvc.ViewResultBase.ExecuteResult(ControllerContext context) +153
   System.Web.Mvc.<>c__DisplayClass14.<InvokeActionResultWithFilters>b__11() +33
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +613
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +613
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +613
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +613
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult) +263
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +709
   System.Web.Mvc.Controller.ExecuteCore() +162
   System.Web.Mvc.<>c__DisplayClass8.<BeginProcessRequest>b__4() +58
   System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +20
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +469
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +375 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T09:24:06.757

一种想法可能是存储库实例正在被重用。确保为具有填充`MasterLocationFormats`属性的方法的存储库创建新实例。

# android - 您可以在 AdView 上绘制图层吗？(opnenGL/libgdx)

> ID：15396291
> 
> 赞同：0
> 
> 时间：2013-03-13T20:56:12.530
> 
> 标签：android, opengl-es, admob, libgdx

我正在制作一个绘图程序并使用 admob 来获得一些收入:) 所以我想要的是当用户在 AdView 上画一条线时，它呈现在它上面而不是下面。这是可能的还是完全的疯狂？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:02:33.923

这可能违反了 Admob TOS： http: [//support.google.com/admob/answer/1307237](http://support.google.com/admob/answer/1307237?hl=en) ?hl=en “。广告不应放置在用户会随机点击或将手指放在屏幕上的区域。”

...我知道作为广告客户，我不希望有任何东西覆盖我的广告

# java - Java快速访问数组项

> ID：15396293
> 
> 赞同：0
> 
> 时间：2013-03-13T20:56:30.043
> 
> 标签：java, arrays, hex

我正在做一个返回长十进制的计算，例如 4611686018427387904。我需要先将其转换为十六进制，然后根据设置的位来检查一个大小为 (16) 的数组。

所以上面的数字被转换为 0x40000000000000000L，这对应于数组中的第一个索引。如果数字是 0x0004000000000000L，它对应于数组中的第三个索引。

我的问题是：

1.  有没有快速将十进制转换为十六进制的方法？
2.  是否有一种根据值的位集（而不是使用循环）访问数组的快速方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:05:07.647

如果数字在长范围内，请使用[Long.highestOneBit()](http://docs.oracle.com/javase/7/docs/api/java/lang/Long.html#highestOneBit%28long%29)。或者，BigInteger 有一个[bitLength()](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html#bitLength%28%29)方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:05:23.927

请记住，Java 中的所有原语在内部都存储为二进制文件。当您将其传递给 System.out.println() 时它会打印一个十进制数，这一事实是对该二进制值的一种看法。因此，如果将十进制存储在基元（双精度、浮点、长整数、整数、短字节、字节）中，则将其转换为十六进制已经完成。如果您想将该值转换为十六进制字符串以进行显示，您可以使用 Integer.toHexString(int)。

Java 对数组大小有一个上限，它是一个整数，所以 2^31 个插槽。除此之外，您将不得不使用两个或多个结构并将它们组合起来。我想这就是你正在做的事情。但是，如果您这样做，可能会使用 long，并且 Long.highestOneBit() 可能是数组数组的第一个索引，其中每个慢速数组可能是 2^31 个插槽的数组。当然，这对于内存使用而言并不是一种特别有效的结构。但这会给你一个可能是 long 大小的视图。你可能没有足够的内存，但谁知道呢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:44:50.743

首先，一个猜测：您有一个 long ，您将其视为 16 个 4 位数字。您希望将每个 4 位数字用作 16 元素数组的索引。

我认为最快的方法是使用掩码和一些位移。两者都是快速操作。如果您从底部屏蔽，则不必在屏蔽后移动结果。

long 中有 16 个 4 位分组，因此：

```
 long l = 1234;
    int[] results = new int[16];
    for (int i=15; i>=0; i--)
    {
        int index = (int)l & 0xF;
        results[i] = index;
        l = l >> 4;
    } 
```

这会从您的 long 的右侧（低位）位获取 16 个索引，并且您说左侧（高位）位是第一个索引。所以这会让它们以相反的顺序排列并相应地存储它们。调整短裤或任何你需要的东西，这会很快。

警告：我没有运行此代码。我的意思是它是一种 java 伪代码。

如果您不熟悉“&”运算符：它会在其中包含 1 的位置返回 1 和 0，因此 & 与 0xF 将告诉您低 4 位是什么。

# c - 涉及多个进程的矩阵乘法中的共享内存

> ID：15396294
> 
> 赞同：0
> 
> 时间：2013-03-13T20:56:30.477
> 
> 标签：c, ipc, shared-memory, matrix-multiplication

我正在尝试通过共享内存学习 IPC。我不明白如何将共享内存分配给不同进程的各种变量。例如，在矩阵乘法中，我不想全局声明矩阵，而是通过共享内存。我们如何将内存附加到不同的矩阵：

谁能帮我解决这个问题？另外，它可以被 mmap() 和 shm_open() 替换还是只是文件？如果是，如何？我找不到恰当的例子来说明进程如何修改共享内存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:06:12.217

首先：不要将共享内存用于 IPC。很乱。

在共享内存有意义的大多数情况下，只使用线程更容易也更合适（这样*所有*内存都是共享的）。如果这不可能，您最好使用某种消息传递方案。

> 如何从该共享内存中为矩阵 A 、 B 和结果矩阵分配内存
> 并附加到它，因为我不必全局声明矩阵并且每个进程都需要 ABC 来
> 解决部分问题。

您必须想出一些方法来在共享内存段中分配内存。您不能`malloc()`为此使用，因为它的竞技场不包括共享内存。

如果您要存储的唯一数据是这三个矩阵，**并且**两个进程都知道这些矩阵的大小，则可以将它们全部堆叠到一个结构中并将其存储在段中：

```
struct shm_data {
    float A[123][123], B[123][123], C[123][123];
};

struct shm_data *mat = (struct shm_data *) shm; 
```

但是，如果矩阵的大小不固定，则必须在运行时计算它们的地址。

> 另外，它可以被 mmap() 和 shm_open() 替换还是只是文件？

是的。事实上，`mmap()`几乎普遍优于`shm_open()`，因为内存段由文件支持并遵循文件系统语义，因此可以明智地清理它。POSIX 共享内存（这是您正在使用的）更奇怪。

# c# - MS Word Interop to C# - 在书签处插入多个文件

> ID：15396301
> 
> 赞同：1
> 
> 时间：2013-03-13T20:56:41.810
> 
> 标签：c#, ms-word, office-interop

我有一个主文档，我想在其中插入许多文件。这些应该在文档中间的某个点一个接一个地插入到文件中。

所以我在此时创建了一个名为“TESTS”的书签，因为这似乎是以编程方式找到该点的最简单方法。

我可以使用以下代码插入单个文件：

```
 Microsoft.Office.Interop.Word.Application oWord = new Microsoft.Office.Interop.Word.Application();
 Microsoft.Office.Interop.Word.Document oWordDoc = oWord.Documents.Open(@"C:\master.doc");
 oWordDoc.Bookmarks.Cast<Bookmark>().First(b => b.Name == "TESTS").Range.InsertFile(@"C:\test1.doc"); 
```

但这会删除书签，从而无法在同一点插入第二个文件。我不介意丢失书签，但只有在我插入所有文件后。

这可以做到吗？我猜上面的代码用书签替换了范围，所以在之前或之后找到位置然后删除书签范围是最好的 - 但我找不到它的代码。我尝试过的一切似乎都替换了整个文档。

或者，是否有任何方法可以在没有互操作的情况下执行此操作（即通过解析文件 - 根本不接触 MS Word）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T14:16:27.743

您的文档的设置方式和书签的确切范围必须有一些特别之处，因为我能够在不丢失书签的情况下使其正常工作。根据这篇MVP文章[In Inserting text at a bookmark without delete the bookmark](http://word.mvps.org/faqs/macrosvba/InsertingTextAtBookmark.htm)，将文本添加到书签范围*应该*删除书签；也许您在使用 InsertFile 时遇到了类似的问题。

尝试他们将书签的范围存储到变量中的建议，即`MyRange`然后调用`Bookmarks.Add "mybookmark", MyRange`

```
Dim BMRange As Range 

Set BMRange = ActiveDocument.Bookmarks("MyBookmark").Range 
BMRange.Text = "Hello world" 

ActiveDocument.Bookmarks.Add "MyBookmark", BMRange 
```

# python - 将列表写入包含文本和十六进制值的文件。如何？

> ID：15396302
> 
> 赞同：0
> 
> 时间：2013-03-13T20:56:42.273
> 
> 标签：python, python-3.x

我需要将值列表写入文本文件。因为windows，当我需要写换行符时，windows做\n\r，其他系统做\n。

我突然想到，也许我应该以二进制形式写入文件。

如何创建类似于以下示例的列表并以二进制形式写入文件？

```
output = ['my first line', hex_character_for_line_feed_here, 'my_second_line'] 
```

为什么以下不起作用？

```
output = ['my first line', '\x0a', 'my second line'] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:02:39.863

不。以文本模式打开文件，让 Python 为您处理换行符。

使用该[`open()`函数](http://docs.python.org/3/library/functions.html#open)`newline`时，您可以使用关键字参数设置 Python 应如何处理换行符：

> 将输出写入流时，如果*换行符*为`None`，则写入的任何`'\n'`字符都将转换为系统默认的行分隔符，`os.linesep`。如果*换行符*是`''`或`'\n'`，则不进行翻译。如果*换行符*是任何其他合法值，`'\n'`则写入的任何字符都将转换为给定的字符串。

因此，默认方法是为您的平台编写正确的行分隔符：

```
with open(outputfilename, 'w') as outputfile:
    outputfile.write('\n'.join(output)) 
```

做*正确的事*；在 Windows 上，`\r\n`字符被保存而不是`\n`.

如果您特别想`\n` *只*编写而不让 Python 为您翻译这些，请使用`newline=''`：

```
with open(outputfilename, 'w', newline='') as outputfile:
    outputfile.write('\n'.join(output)) 
```

请注意，它与 ;`'\x0a'`是*完全相同*的字符`\n`。`\r`是`\x0d`：

```
>>> '\x0a'
'\n'
>>> '\x0d'
'\r' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:12:44.367

在与 Python 脚本相同的目录中创建一个文本文件“myTextFile”。然后写一些类似的东西：

```
# wb opens the file in "Write Binary" mode
myTextFile = open("myTextFile.txt", 'wb')

output = ['my first line', '369as3', 'my_second_line']

for member in output:
    member.encode("utf-8") # Or whatever encoding you like =)
    myTextFile.write(member + "\n") 
```

这将输出一个二进制文本文件，如下所示：

```
my first line
369as3
my_second_line 
```

***编辑：**为 Python 3 更新*

# php - 无法从 PHP 中的 SQL 查询返回正确的结果

> ID：15396303
> 
> 赞同：0
> 
> 时间：2013-03-13T20:56:42.193
> 
> 标签：php, sql, ajax, json, cordova

我创建了一个表，里面有一些数据

但是，通过使用以下链接，我总是得到 {"flag":"0","msg":"Incorrect id."} 的结果，无论 id 是否正确

我想知道问题出在哪里？谢谢

[http://mydomain.com/ajax_login_json.php?user_name=admin&password=admin](http://mydomain.com/ajax_login_json.php?user_name=admin&password=admin)

```
 <?php session_start();

 //Connect to database from here
    $link = mysql_connect('****', '****', '****'); 
    if (!$link) {
        die('Could not connect: ' . mysql_error());
    }
    //select the database | Change the name of database from here
    mysql_select_db('****'); 

//get the posted values
$user_name=htmlspecialchars($_POST['user_name'],ENT_QUOTES);
$pass=$_POST['password'];

//now validating the username and password
$sql="SELECT user_name, password FROM tbl_user WHERE user_name='".$user_name."'";
$result=mysql_query($sql);
$row=mysql_fetch_array($result);

printf("Select returned %d rows from tbl_user.\n", $result->num_rows);

//if username exists
if(mysql_num_rows($result)>0)
{
    //compare the password
    if(strcmp($row['password'],$pass)==0)
    {
        // Return success message
        $message = array("flag" => "1", "msg" => "Login successfully.");
        echo json_encode($message);
         //Regenerate session ID to prevent session fixation attacks
        //session_regenerate_id();

        //now set the session from here if needed
        //$_SESSION['u_name']=$user_name; 
        //$member=mysql_fetch_assoc($result);
        //$_SESSION['u_id']=$member['id'];
        //$name_show=$member['first_name'].' '.$member['last_name'];
        //$_SESSION['name']=$name_show;
            //Write session to disc
            //session_write_close();

        }
    else
        // Return error message
        $message = array("flag" => "0", "msg" => "Incorrect password.");
        echo json_encode($message);
}
else    //if username not exists
{       // Return error message
        $message = array("flag" => "0", "msg" => "Incorrect id.");
        echo json_encode($message);
}
mysql_close($link);     
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:01:06.557

它似乎

```
$sql="SELECT user_name, password FROM tbl_user WHERE user_name='".$user_name."'"; 
```

如果您没有收到任何数据库连接错误，则结果为 0。首先尝试打印`$user_name`以查看它是否在您的数据库表中。

# python - Eclipse PyDev PyClips 的环境...从 db 中选择视图时出错

> ID：15396305
> 
> 赞同：0
> 
> 时间：2013-03-13T20:56:47.607
> 
> 标签：python, pydev

所以我有这个环境，安装了 Python 2.5，PyDev 2.5，PyClips，我有一个 sqlite3 数据库。看起来一切都很好而且花花公子，直到我运行以下语句

```
 SQL = "select * from COMPLETE"
  cur.execute(SQL) 
```

当我这样做时，eclipse会抛出以下错误

```
cur.execute(SQL)
sqlite3.OperationalError: no such table: COMPLETE 
```

`COMPLETE`sqlite db中的视图在哪里。关于为什么看不到这种观点的任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:05:48.267

我能够找到解决方案。我改为在代码中使用 SQL 语句直接创建视图，现在似乎正在“看到”它。

# javascript - 在网站上搜索图像

> ID：15396310
> 
> 赞同：-1
> 
> 时间：2013-03-13T20:56:55.443
> 
> 标签：javascript, jquery, html, image

您好，我正在我的网站上实施 azubu.tv 直播。

由于该页面不提供 API 和嵌入代码，但我不得不即兴发挥一点 ^^

我刚刚发现一个直播的流在网站上有一个特殊的图像，即： [http ://www.azubu.tv/static/images/channels/live_check.png](http://www.azubu.tv/static/images/channels/live_check.png)

因此，例如让我们以这个流 [http://www.azubu.tv/channel/live_small.do?cn_id=2125982481001](http://www.azubu.tv/channel/live_small.do?cn_id=2125982481001)

如果这个人在直播，图像就在那里，如果他不是，图像不在页面上。我想如果我可以搜索页面上的图像，我可以找出他是否在线。

任何人都知道如何编码

编辑：我的确切问题是我不知道这样的事情是否可行。所以有了这个线程，我想知道它是否可能，以及如何。

编辑2：

我这样尝试过，但仍然无法正常工作： load(' [http://www.azubu.tv/channel/live_small.do?cn_id=2220181926001](http://www.azubu.tv/channel/live_small.do?cn_id=2220181926001) .img');

我认为这可以工作，因为它是页面上唯一没有 id afaik 的 img。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:25:22.913

回答您的问题，可以使用 jQuery 选择器检查图像是否存在。试试这个：

```
if ($( "[src|='http://www.azubu.tv/static/images/channels/live_check.png']" ).length > 0) {
    alert('Is live');
}
else {
    alert('Not live');
} 
```

这是[小提琴](http://jsfiddle.net/JAFm5/)。但是您不能信任图像来检查是否是实时的（图像的 src 可以更改）。

**编辑** 在阅读了您对我之前的回答的评论后，我认为解决该问题的一种方法是：

首先，您需要加载要检查使用的页面`jQuery load`，然后检查图像是否存在于内容加载中。

让我们假设你有一个 id 的 div `container`。你可以这样做：

```
$( "#container" ).load(
    "/echo/html/",     // using jsFiddle echo service to return the 
                       // html below (docs: 
                       // http://doc.jsfiddle.net/use/echo.html)
    {
        html: "<img src='http://www.azubu.tv/static/images/channels/live_check.png' />" +
              "<div id='div_2'>Div 2</div>" +
              "<div id='div_3'>Div 3</div>"
    },
    function( responseText, textStatus, xmlHttpRequest ){
        if ( textStatus == "success" ) {
if ($( "[src|='http://www.azubu.tv/static/images/channels/live_check.png']" ).length > 0) {
    alert('Is live');
}
else {
    alert('Not live');
}
        }
    }
); 
```

这是[小提琴](http://jsfiddle.net/2fTTV/1/)

希望能帮助到你！

笔记。由于代理限制，我无法测试您的网址。:S

# plsql - pl sql在过程中设置变量

> ID：15396311
> 
> 赞同：0
> 
> 时间：2013-03-13T20:56:56.517
> 
> 标签：plsql

我不确定如何在调用另一个存储过程的存储过程中设置变量。我想保存返回的值并稍后在另一个选择中使用它。

我想做这样的事情：

```
 PROCEDURE procName(bcur OUT IssCur)
 IS
cur2 IssCur;
extCur IssCur;
exlineno varchar2(30);

BEGIN
exlineno :=getExternlineno(exlineno,'50036648','00060');
open cur2 for SELECT concat(SUBSTR(susr2, 0, INSTR(susr2, '-')-1),'' ) from OrderDetail; 
```

要调用的存储过程

```
 PROCEDURE getExternlineno(
oRetValue OUT varchar2,
pKey IN varchar2,
poNum IN varchar2)
AS
Begin
  select externlineno into oRetValue  from podetail where pokey = pKey and polinenumber    = poNum;
end getExternlineno; 
```

一旦我弄清楚如何做到这一点，我也可以分解这样的东西（它不理解 proc 名称：

```
 SELECT concat(concat(SUBSTR(susr2, 0, INSTR(susr2, '-')-1),'' ),' - ' || getExternlineno(exlineno,'50036648','00060')) from OrderDetail; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T09:01:06.813

叶戈尔的评论是正确的。您应该声明`getExternlineno`为函数以便在 SQL 查询中使用它。

该函数`getExternlineno`将变为：

```
FUNCTION getExternlineno(
pKey IN varchar2,
poNum IN varchar2)
RETURN VARCHAR
AS
DECLARE
oRetValue VARCHAR2(2000); -- Change the precision as per program's requirements.
Begin
  select externlineno into oRetValue from podetail where pokey = pKey and polinenumber = poNum;
end getExternlineno;
    / 
```

您的`procName`程序将变为：

```
PROCEDURE procName(bcur OUT IssCur)
IS
cur2 IssCur;
extCur IssCur;
exlineno varchar2(30);

BEGIN
exlineno := getExternlineno('50036648','00060'); -- Notice the change in number of arguments here.
open cur2 for SELECT concat(SUBSTR(susr2, 0, INSTR(susr2, '-')-1),'' ) from OrderDetail;
END procName;
/ 
```

您的 SQL 查询将变为：

```
 SELECT concat(concat(SUBSTR(susr2, 0, INSTR(susr2, '-')-1),'' ),' - '
             || getExternlineno('50036648','00060'))
        FROM OrderDetail; 
```

# php - 有人可以澄清一下 MySQL 的 TIMESTAMP 是如何与 PHP 的 DateTime 类一起使用的吗？

> ID：15396313
> 
> 赞同：0
> 
> 时间：2013-03-13T20:57:00.973
> 
> 标签：php, mysql, datetime, time, timezone

我一直在研究 MySQL 的 DATETIME 和 TIMESTAMP 在使用上的差异。DATETIME 似乎很简单。我会使用以下程序：

1.  为所有日期选择默认时区，例如 UTC。
2.  让用户从下拉列表中选择日期。
3.  使用用户的时区设置（例如 EST）创建具有所选日期的新 PHP DateTime 对象。
4.  将对象转换为 UTC，并插入数据库。
5.  在另一个页面上，检索日期时间值并使用它创建一个新的 DateTime 对象，使用 UTC 时区。
6.  将对象转换为用户的本地时间 (EST)，并显示给他。

现在，似乎 mysql 的 TIMESTAMP 列类型可以帮助消除所有这些转换。

1.  如果使用 TIMESTAMP 列类型，上述步骤会是什么样子？
2.  我需要做“SET time_zone = timezone;”吗 在每个页面加载开始时将时区设置为用户的位置？
3.  每个数据库只使用一种日期列类型会更容易吗？如果不是，它可能需要两组不同的函数来生成正确的日期。
4.  TIMESTAMP 是否应该只用于不打算向公众显示的列中（以免处理格式）？就像创建行、上次编辑等时一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:15:45.980

我没有测试过任何这种方法，但它看起来很简单=）

1.  您不需要转换日期，只需在从 dB 读取/写入时设置时区即可使一切正确。
2.  是的，您必须在连接到 dB 后设置正确的时区。
3.  你的意思是只使用日期时间或时间戳？这实际上取决于您打算如何使用这些列。但没有明确*的必须做的事情*。
4.  与上面相同，从 dB 格式化数据并没有错，使用时间戳可以从 dB 返回日期样式字符串，所以不用担心

传统上，时间戳像您提到的那样与其他日期相关联，而日期时间则与其他日期相关联。

有关语言环境/时区的更多信息： [MYSQL 在 PHP 代码中设置时区](https://stackoverflow.com/questions/12296780/mysql-set-timezone-in-php-code)

# android - 如何在 Android GoogleMaps v2 中交换（删除和添加）标记，同时保持其可点击性

> ID：15396318
> 
> 赞同：0
> 
> 时间：2013-03-13T20:57:16.280
> 
> 标签：android, google-maps-markers, google-maps-android-api-2

当用户触摸标记时，我出于某种原因想要交换该标记（通过使用另一个图形）。不幸的是，当我安装以下（实验性）`onMarkerClick`处理程序时，Android GoogleMaps v2 确实出现了一种奇怪的行为：

```
@Override
public boolean onMarkerClick(final Marker marker) {
    LatLng p = marker.getPosition();
    marker.remove();
    Marker m = mMap.addMarker(new MarkerOptions().position(p).title("new"));
    m.showInfoWindow();
    return true;
} 
```

观察：

*   第一次单击（在“原始”标记上）调用事件处理程序，交换标记并正确显示信息窗口
*   第二次点击（在“新”标记上）既不触发`onMapClick`也不触发`onMarkerClick`。此外，信息窗口消失（意外行为）
*   由于对同一标记的所有后续单击都不会触发任何事件处理程序，因此信息窗口将保持隐藏状态，直到用户触摸地图上的空闲空间然后再次触摸该标记。同样，标记被交换并出现信息窗口，但所有对标记的连续点击都将被忽略，如前所述。

有人可以确认这种行为吗？我确实认为它是一个错误。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T17:18:51.653

从 gmaps-api-issues 复制的解决方法：

```
@Override
public boolean onMarkerClick(final Marker marker) {
    LatLng p = marker.getPosition();
    marker.remove();
    final Marker m = mMap.addMarker(new MarkerOptions().position(p).title("new"));
    handler.post(new Runnable() {
        @Override
        public void run() {
            m.showInfoWindow();
        }
    });
    return true;
} 
```

其中处理程序定义为：

`private Handler handler = new Handler();`

# php - PHP 和 SimpleXML - 无法输出文件内容

> ID：15396321
> 
> 赞同：1
> 
> 时间：2013-03-13T20:57:28.313
> 
> 标签：php, simplexml

在此先感谢您的帮助...

我正在尝试使用 SimpleXML 输出我的一个文件的内容。为了找到该文件，我必须扫描一个目录，将一个文件夹的内容分成两个数组，然后从其中一个数组中选择最新的文件。

```
$files = scandir($dir);
$roster = [];
$schedule = [];
foreach ($files as $file) {
    if (!(strpos($file, 'roster')===false)) {
        $roster<< $file;
    } else {
        $schedule<< $file;
    }
} 
```

现在，当我尝试使用 SimpleXML 时，我无法显示任何内容。

```
 $xml_file = $file;
 $xml = simplexml_load_file($xml_file); 
```

（此时我尝试使用 echo 输出信息，但没有运气。）

我是否需要打开和关闭文件，还是缺少另一个关键步骤？

# compiler-construction - flex中的引号“”

> ID：15396322
> 
> 赞同：1
> 
> 时间：2013-03-13T20:57:30.703
> 
> 标签：compiler-construction, flex-lexer, lexical-analysis

我正在用 flex 编写一个简单的扫描仪。我希望我的扫描仪在看到关键字“int”时打印出“看到的整数类型”。以下两种方式有什么区别吗？

第一种方式：

```
%%
int printf("integer type seen");
%% 
```

第二种方式：

```
%%
"int" printf("integer type seen");
%% 
```

`if`那么，写和写有区别`"if"`吗？此外，例如，当我们看到一个`==`运算符时，我们会打印一些东西。`==`写入或`"=="`在 flex 文件中有区别吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T22:06:54.653

在这些特定情况下没有区别——quotes( `"`) 只是告诉 lex 不要解释引用字符串中的任何特殊字符（例如，对于正则表达式），但如果不涉及特殊字符，它们无关紧要：

```
[a-z]     printf("matched a single letter\n");
"[a-z]"   printf("matched the 5-character string '[a-z]'\n");
0*        printf("matched zero or more zero characters\n");
"0*"      printf("matched a zero followed by an asterisk\n"); 
```

引号之外的特殊字符和表示不同含义的字符包括`.` `*` `+` `?` `|` `^` `$` `<` `>` `[` `]` `(` `)` `{` `}` `/`. 其中一些仅在它们出现在某些地方时才具有特殊含义，但是如果您想匹配文字字符，则无论它们出现在何处，通常都会更清楚地引用它们。

# c# - WCF 命名管道客户端状态始终打开

> ID：15396325
> 
> 赞同：2
> 
> 时间：2013-03-13T20:57:45.837
> 
> 标签：c#, .net, wcf, named-pipes

我正在尝试将一些旧的 .NET Remoting IPC 代码移植到 WCF 命名管道，我知道我可能在这里做一些愚蠢的事情......

我有一个使用 ServiceHost/NetNamedPipeBinding 端点的 Windows 服务。

我有一个使用 ChannelFactory/NetNamedPipeBinding 连接到它的 WinForms UI。

无论 Windows Server 是否正在运行，在我`CreateChannel`在客户端上运行之后，ChannelFactory 对象的状态都是 Opened。如果服务没有运行，我希望它不是“打开”。直到我尝试调用远程方法时才收到异常。检测连接是否成功的最佳方法是什么？

如果服务实际上正在运行，我的代码可以正常运行，但是当它没有运行时（或连接断开），我似乎无法使客户端状态从已打开。

这是我的服务助手代码：

```
public class WcfServerHelper
{
    public static ServiceHost RemoteServiceHost { get; set; }

    public static void Start(Type remotingType)
    {
        RemoteServiceHost = new ServiceHost(remotingType, new Uri[] {
            new Uri("net.pipe://localhost")
        });

        RemoteServiceHost.AddServiceEndpoint(typeof(ICardPrinterRemoting), new NetNamedPipeBinding(), "LifeMedPrinter");

        RemoteServiceHost.Open();
    }

    public static void Stop()
    {
        if (RemoteServiceHost != null && RemoteServiceHost.State == CommunicationState.Opened)
        {
            RemoteServiceHost.Close();
        }
    }
} 
```

视窗服务：

```
public partial class Service1 : ServiceBase
{
    public Service1()
    {
        InitializeComponent();
    }

    protected override void OnStart(string[] args)
    {
        WcfServerHelper.Start(typeof(CardPrinterRemoting));
    }

    protected override void OnStop()
    {
        WcfServerHelper.Stop();
    }
} 
```

客户端助手代码：

```
public class WcfClientHelper
{
    public static ICardPrinterRemoting RemotingObject { get; set; }
    public static ChannelFactory<ICardPrinterRemoting> PipeFactory { get; set; }

    public static void ConnectIpc()
    {
        PipeFactory = new ChannelFactory<ICardPrinterRemoting>(new NetNamedPipeBinding(), new EndpointAddress("net.pipe://localhost/LifeMedPrinter"));
        RemotingObject = PipeFactory.CreateChannel();
    }
} 
```

Windows UI（服务客户端）代码：

```
private void btnConnect_Click(object sender, EventArgs e)
{
    WcfClientHelper.ConnectIpc();
    // The event handlers never get called, even if a successfully connection is made and then the Windows Service is stopped
    WcfClientHelper.PipeFactory.Closing += PipeFactory_Closing;
    WcfClientHelper.PipeFactory.Faulted += PipeFactory_Faulted;
    WcfClientHelper.PipeFactory.Closed += PipeFactory_Closed;

    if (WcfClientHelper.PipeFactory.State == CommunicationState.Opened)
    {
        LifeMedPrinterSettings lifeMedPrinterSettings = new LifeMedPrinterSettings();
        lifeMedPrinterSettings.PrinterName = "Hello World";

        // It always falls into this IF statement, but will blow up on this method call if the service isn't actually running:    
        WcfClientHelper.RemotingObject.SaveSettings(lifeMedPrinterSettings);
    }
    else
    {
        MessageBox.Show("No can-do");
    }
} 
```

这是我在服务未运行时调用远程方法时收到的异常：

```
System.ServiceModel.EndpointNotFoundException was unhandled
  HResult=-2146233087
  Message=There was no endpoint listening at net.pipe://localhost/LifeMedPrinter that could accept the message. This is often caused by an incorrect address or SOAP action. See InnerException, if present, for more details.
  Source=mscorlib
  StackTrace:
    Server stack trace: 
       at System.ServiceModel.Channels.PipeConnectionInitiator.GetPipeName(Uri uri, IPipeTransportFactorySettings transportFactorySettings)
       at System.ServiceModel.Channels.NamedPipeConnectionPoolRegistry.NamedPipeConnectionPool.GetPoolKey(EndpointAddress address, Uri via)
       at System.ServiceModel.Channels.ConnectionPoolHelper.TakeConnection(TimeSpan timeout)
       at System.ServiceModel.Channels.ConnectionPoolHelper.EstablishConnection(TimeSpan timeout)
       at System.ServiceModel.Channels.ClientFramingDuplexSessionChannel.OnOpen(TimeSpan timeout)
       at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.OnOpen(TimeSpan timeout)
       at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.CallOnceManager.CallOnce(TimeSpan timeout, CallOnceManager cascade)
       at System.ServiceModel.Channels.ServiceChannel.EnsureOpened(TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
       at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)
    Exception rethrown at [0]: 
       at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
       at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
       at LifeMed.CardPrinter.Remoting.Interfaces.ICardPrinterRemoting.SaveSettings(LifeMedPrinterSettings printerSettings)
  InnerException: System.IO.PipeException
       HResult=-2146232800
       Message=The pipe endpoint 'net.pipe://localhost/LifeMedPrinter' could not be found on your local machine. 
       ErrorCode=-2146232800
       InnerException: 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T06:10:03.497

经过大量研究，我找到了答案，但不是我想要的。显然，查看服务是否可用的唯一方法是调用它 - 例如通过通用 Ping 方法，然后处理异常（就像我在问题中遇到的异常）。

所以我想这就是答案。

我唯一的另一个问题是：国​​有财产的目的是什么？我希望 State == Opened 表明与服务有一个开放的连接。

无论如何，我有我的解决方案。

谢谢！

# visio - Visio 2010：移动多个连接器，顺序图

> ID：15396329
> 
> 赞同：6
> 
> 时间：2013-03-13T20:57:54.437
> 
> 标签：visio, messages

我正在尝试移动多个连接对象生命线的连接器，但如果我选择多个连接器并移动它们，连接器就会脱胶。有没有一种方法可以将所有选定的步骤向下移动一个或两个连接，而不必一次手动重新连接一个？这在插入超出现有消息的新消息时非常方便。

# css - 如何将元素的内部文本垂直设置在中间？

> ID：15396332
> 
> 赞同：0
> 
> 时间：2013-03-13T20:57:59.477
> 
> 标签：css, vertical-alignment

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:03:52.673

只需更改`display: inline-block;`为`display: table-cell;`

[**jsFiddle**](http://jsfiddle.net/KZL2p/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:03:45.743

我会使用带填充的 div。我不知道这是否是最佳做法。显然，将背景放在正确大小的 div 中并使用正确的填充。

```
<a href="test.php">
    <div style="padding:10px;width:150px;border:1px #000 solid;text-align:center;">
        Hello!
    </div>
</a> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T21:00:44.080

在您的情况下，您将不得不使用像`<span/>`. 看到这个[小提琴](http://jsfiddle.net/DPDpg/)：

```
<a href="#"><span>Text</span></a> 
```

使用此 CSS 内容：

```
a
{
    display: inline-block;
    float: left;
}

span
{
    width: 233px;
    height: 122px;
    display: table-cell;
    vertical-align: middle;
    text-align: center;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T22:01:50.537

为了解决这个问题，最后我找到了以下解决方法：

```
<a href="www.mydoamin.com" class="div_a">
    <span class="wrapper">
      <span class="div_txt">Contentdas asd ad adasd asd asdad </span>
    </span>
</a>
<a href="www.mydoamin.com" class="div_a">
    <span class="wrapper">
        <span class="div_txt">Content</span>
    </span>
</a> 
```

和下面的CSS

```
a.div_a {
    display: inline-table;
    width: 200px;
    height: 100px;
    background-color: #CCC;
    background-image: url(http://jsfiddle.net/img/logo.png);
    text-align: center;
}

.wrapper {
    display: table-cell;
    vertical-align: middle;
} 
```

[演示](http://jsfiddle.net/WcCnW/2/)

# c++ - 在 C++ 中调用初始化器列表中的函数

> ID：15396333
> 
> 赞同：2
> 
> 时间：2013-03-13T20:58:09.293
> 
> 标签：c++, initialization

我想知道以下是否安全，我需要将一些配置传递给我班级成员的初始化。我声明了一个辅助静态函数，它构建了在初始化成员时要传入的配置参数。

所以，具体来说：

啊：

```
class A
{
    Something d_member;
} 
```

a.cpp

```
static Thing makeThing()
{
    Thing x;
    x.setValue(4);
    return x;
}

A::A() : d_member(makeThing()) {}; 
```

那么，使用该辅助函数来临时构建我的事物以进行构建是否安全。其次，将其设为静态是否更安全或更快？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T21:00:30.913

是的，这很好，值得鼓励。

假设静态部分不在类本身中并且似乎不在类中，那么静态部分所做的唯一事情就是给它“内部”链接。这意味着没有人可以在它所在的 .cpp 文件之外调用它......基本上（“翻译单元”是技术术语，但通常与单个 .cpp/.o 文件相同）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:00:48.537

这是安全的。

`static`仅控制链接选项并降低符号的可见性。通常，您定义为`static`在模块之外不得可见/可用的任何功能。

# web-scraping - YQL 抓取：按照链接向下一级？

> ID：15396336
> 
> 赞同：0
> 
> 时间：2013-03-13T20:58:26.483
> 
> 标签：web-scraping, yql

YQl 是否有一种抓取网页的好方法，但也可以通过该网页的链接获取更多详细信息？

一个例子就像一个博客，其中索引页面显示每个新闻条目的标题，但您需要单击该标题链接以获取新闻故事和相关图片等。我需要从每个新闻条目页面获取数据并也处理索引页面上的分页结果。

如果 YQL 能够做到这一点，任何人都可以提供任何示例吗？如果不是，任何人都可以提出一个好的选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T10:41:09.560

我们通过在 AppEngine 中托管一个服务来解决类似的问题，该服务将首先调用 YQL 来获取链接。然后迭代链接以获取 URL 的内容。

# javascript - 如何使用输入值在 HTML 上书写？

> ID：15396340
> 
> 赞同：0
> 
> 时间：2013-03-13T20:58:43.160
> 
> 标签：javascript, html, forms

我想了解 Javascript 是如何工作的，我是**Tornado (Python)**的用户，我使用了一个变量`{{variable}}`，所以我只做：

```
<h1> {{variable}} </h1> 
```

现在我尝试实时进行 HTML 编辑，`1000`例如，如果用户编写，他可以在某个地方看到格式化的值，例如`1 000`

在 javascript 中，我可以使用控制台从控制台获取值`document.getElementById("price").value`，然后如何输入 HTML 代码？

抱歉，这似乎是一个愚蠢的问题。

这是代码：

```
<input id="price" type="number" name="prix" required title="put here..." placeholder="example: 800000" min="1" step="1">
<script>var val = document.getElementById("price").value;
document.getElementById("ggg").innerHTML = val;</script>`<h1 id="ggg">test</h1>` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:03:21.910

最简单的方法是修改[`.innerHTML`](https://developer.mozilla.org/en-US/docs/DOM/element.innerHTML)目标元素的属性：

```
var val = document.getElementById("price").value;
document.getElementById("target").innerHTML = val; 
```

你也可以修改[`.textContent`](https://developer.mozilla.org/en-US/docs/DOM/Node.textContent).

要执行实时部分，您必须使用事件处理程序，只要值发生更改，就会调用该事件处理程序：

```
document.getElementById("price").onchange = function(e){
    document.getElementById("target").innerHTML = this.value;
}; 
```

请注意，`change`只有当元素失去焦点时才会触发。其他可能方便的事件是`keypress`或`keydown`，`keyup`这取决于您想要更新值的频率。

# python - 在烧瓶应用程序中放置调试标志的位置

> ID：15396352
> 
> 赞同：9
> 
> 时间：2013-03-13T20:59:18.520
> 
> 标签：python, flask

阅读烧瓶文档，我发现通常有两个地方放置调试标志：

*   在创建烧瓶对象之后

    ```
    app = Flask(__name__)
    app.debug = True 
    ```

*   或通过 run 方法

    ```
    app.run(host='0.0.0.0', debug = True) 
    ```

在我的项目中，我有 app/ **init** .py 文件：

```
 from flask import Flask
    app = Flask(__name__) 
    #app.debug = True       
    from app import views
    if app.debug == True:
       ...
       ... 
```

还有 run.py 文件：

```
from app import app
import os
port = int(os.environ.get('PORT', 5000))
app.run(host='0.0.0.0', port=port, debug = True) 
```

我在第二个选项（通过 app.run）中看到的问题是在执行 run 方法之前不会设置 True 值。因为那样，在我的**init** .py 文件中，我将拥有 app.debug (False) 的默认值。通过第一个选项，我没有这个问题。

以上是正确的还是有什么我看不到的？那么无论应用程序如何，放置调试值的最佳位置是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-14T02:18:09.487

文档说`Both methods have the exact same effect.`，但他们指的是在 Flask 应用程序实际运行之后。

[http://flask.pocoo.org/docs/quickstart/#debug-mode](http://flask.pocoo.org/docs/quickstart/#debug-mode)

在您上面描述的情况下，最好的选择是使用第一种方法，因为您在应用程序运行*之前*`app.debug`检查's 的值，但在它被定义和设置之后。*`app.debug`*

 *考虑到这一点，随着您的应用程序变得越来越大，您可能会考虑使用更健壮的结构，您可以在其中定义一个`config-$ENV.py`设置了调试标志的文件。

**应用程序/conf/config-dev.py**

```
DEBUG = True
# ... other settings (e.g., log location, project root, etc) 
```

**应用程序/conf/config-live.py**

```
DEBUG = False
# ... other settings (e.g., log location, project root, etc) 
```

**应用程序/conf/ *_* _init_ *_* .py**

```
EMPTY FILE 
```

**应用程序/ *_* _init_ *_* .py**

```
from flask import Flask

def create_app(env='dev'):
    app = Flask(__name__)
    app.config.from_object('app.conf.config-%s' % env)

    if app.debug:
        print 'running in debug mode'
    else:
        print 'NOT running in debug mode'
    return app 
```

这意味着您将能够立即检查您的应用程序是否将在调试模式下运行，并且当您运行您的应用程序时，您可以告诉它正在运行的环境，这将定义是否调试设置为真或假。

**运行.py**

```
from app import create_app
import os

port = int(os.environ.get('PORT', 5000))
app = create_app(env='dev') #Or pass 'live' to NOT be in debug mode
app.run(host='0.0.0.0', port=port) 
```*

# c# - 无法在 devart linqconnect 中加载存储过程

> ID：15396355
> 
> 赞同：0
> 
> 时间：2013-03-13T20:59:24.437
> 
> 标签：c#, asp.net, stored-procedures, devart

我创建了一个名为购物上下文的**Devart linqconnect 模型，并使用 mysql 作为数据库。我正在使用****Linqconnect 的试用版。**

我在数据库中创建了一个存储过程clothingItems，当我尝试将存储过程添加到图表时，它给了我警告：

**为了获取过程结果集的元数据，需要执行过程，这可能会导致数据库损坏。程序名称：shopping.clothing_items 是否要获取程序结果集的元数据？**

但在文件后面的代码之后，我看到它出现在智能菜单clothingItemResults 和 ClothingItem 方法中，如 ShoppingDatcontext.ClothingItem 和重复方法（我认为！），如：

```
void ClothingItem1(),       
void ClothingItem2();         
void ClothingItem3(); 
```

而且它也没有被添加到图中。

如何在不损坏数据库的情况下添加存储过程以及如何将其插入到图表中以显示它。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T12:47:56.247

在向模型添加过程时，Entity Developer 会尝试执行一个存储过程来确定与该存储过程对应的方法的返回类型。因此，您会看到有关获取过程结果集元数据的警告。如果您选择 OK，则将执行存储过程并确定返回类型。任何数据或数据库结构是否可能被损坏，完全取决于该过程的作用。如果您确定此过程是安全的，则可以允许 Entity Developer 运行它并获取元数据。否则，您可以手动配置过程结果集。

由于您已多次添加此过程，因此会生成重复的方法。每次向模型添加过程（即使是相同的）时，都会为它生成新方法。所有为存储过程生成的方法都可以在 Model Explorer->Methods 和生成的代码 (*.Designer.cs) 中使用。要查看对应的存储过程名称、参数和结果类型，请在Model Explorer->Methods中双击需要的方法或参考代码。

方法未显示在图表布局中，它们仅在 Model Explorer->Methods 和代码中可用。图表包含类、复杂类型和枚举类型以及它们的属性和它们之间的关系。

如需更多信息，请参阅[此处](http://www.devart.com/linqconnect/docs/Stored-Routines.html)。

# javascript - javascript 数组和/或 jquery $.inArray() 和 .splice()

> ID：15396358
> 
> 赞同：1
> 
> 时间：2013-03-13T20:59:34.183
> 
> 标签：javascript, jquery, arrays

我正在使用一个只能包含 12 个值的数组；1 到 12。这些值可以以任何顺序存在。我需要遍历数组并找到第一个未使用的值，然后将其设置为变量。

例如，如果数组包含值 [1, 7, 2, 5, 10]，我想将变量设置为 3，因为它是按数字顺序排列的第一个未使用的数字。我正在使用 jQuery 1.9.1 和 jQuery UI 1.10.1，但如果这可以用普通的 javascript 解决，那也很好！

下面是我的代码，我知道这是错误的，因为它总是将变量设置为 1。 注意：tCounter 是一个用于多个函数的全局数组，所以我不想在这里修改内容。这就是我创建 tArray 来拼接值的原因。谢谢你的帮助！

```
var i;
var t;
var tArray = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];

for (i = 1; i < 12; i++) {
    if (jQuery.inArray(i, tCounter)) {
        tArray.splice($.inArray(i, tArray), 1);
    }
}

if (tArray.length <= 0) {
    term = 1;
} else {
    term = tArray[0];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:41:03.897

在您当前的实现中，我可以看到两个错误。

首先，您的`for`循环索引似乎是一次性的。在当前状态下，它不会检查数字 12 的存在（由于您的条件`i<12`）。

其次，当你的`if`陈述应该为真时，它实际上评估为假。如果数组中的索引为 0，（Javascript 中 0 的计算结果为 false），则应输入语句。拿你所拥有的我会重写你的代码如下：

```
 var i;
  var t; //this isn't used, perhaps it should be 'term'?

  for (i = 1; i < 13; i++) {
     // if we find a number that isn't in tCounter, we exit the loop.
     if (jQuery.inArray(i, tCounter) === -1) {
         term = i;
         break;
     }

     //sets term to null if all numbers are present in array.
     term = null;
  } 
```

如果您的值不是数字 1-12 而是任意数字，那么您将值从数组中拼接出来的想法会很好地工作，但实际上，您根本不需要 var tArray。

**旁注：**在一个有趣的比较中，如果您正在寻找可能的最快实现，您应该使用`tCounter.indexOf(i)`而不是`jQuery.inArray(i, tCounter)`，我不确定哪个更快，但是[这个](http://jsperf.com/in-array-vs-inarray-vs-indexof)漂亮的测试证实了我的怀疑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:02:37.913

一个简单的解决方案是从 1-12 迭代并检查数组中是否存在该值。像这样：

```
var i;
for(i=1; i<12; i+=1) {
   if (tArray.indexOf(i) === -1) break;
}

term = i; 
```

# erlang - 在receive..end中找到多个匹配项以查找case..of？

> ID：15396363
> 
> 赞同：0
> 
> 时间：2013-03-13T20:59:51.957
> 
> 标签：erlang, switch-statement, syntax-error

我在编译以下代码时遇到问题，

```
2> c(match).
match.erl:13: syntax error before: '{'
match.erl:2: function receiver/0 undefined
error 
```

匹配.erl

```
-module(match).
-export([receiver/0]).

receiver() ->
    receive
        {From, A, B} ->
            case A =:= B of
                true ->
                    From ! "true";
                false ->
                    From ! "false"
            end
        {From, A, B, C}->
            case A =:= B =:= C of
                true ->
                    From ! "true";
                false ->
                    From ! "false"
            end
    end. 
```

我已经尝试在比赛前使用所有可能的分号、句号、逗号，`{From, A, B, C}->`但似乎没有任何效果。这就是 Erlangs 的语法是一场噩梦的地方！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T21:19:07.187

请使用模式匹配

```
-module(match).
-export([receiver/0]).

receiver() ->
    receive
        {From, A, A} ->
                    From ! "true";
        {From, _, _} ->
                    From ! "false";
        {From, A, A, A}->
                    From ! "true";
        {From, _, _, _}->
                    From ! "false"
    end. 
```

或警卫

```
-module(match).
-export([receiver/0]).

receiver() ->
    receive
        {From, A, B} when A =:= B ->
                    From ! "true";
        {From, _, _} ->
                    From ! "false";
        {From, A, B, C} when A =:= B andalso A =:= C ->
                    From ! "true";
        {From, _, _, _}->
                    From ! "false"
    end. 
```

或布尔运算符

```
-module(match).
-export([receiver/0]).

    receiver() ->
        receive
            {From, A, B} ->
                case A =:= B of
                    true ->
                        From ! "true";
                    false ->
                        From ! "false"
                end;
            {From, A, B, C}->
                case A =:= B andalso A =:= C of
                    true ->
                        From ! "true";
                    false ->
                        From ! "false"
                end
        end. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T21:16:31.550

我相信不可能像您尝试在“A =:= B =:= C”中那样比较三个值。仅比较其中两个使您的代码可编译。

# php - 从以逗号分隔的多个单词中搜索 mysql 数据库中的特定字符串

> ID：15396364
> 
> 赞同：-2
> 
> 时间：2013-03-13T20:59:54.870
> 
> 标签：php, mysql

我正在尝试创建一个搜索功能，我需要在其中搜索通过 ajax 调用传递的字符串。假设这个词是`Sound & Lighting`，我想在 mysql 数据库表中搜索这个，其中存储的单词数用逗号分隔，例如存储的单词，因为`bike,light,Sound & Lighting,roses`我希望`Sound & Lighting`从存储在数据库中的用逗号分隔的单词数中搜索单词表作为一个值。我厌倦了使用`item_name like '%$search%'`，但这也没有太大帮助。对此有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:08:03.927

如果我正确理解你的问题，我认为你需要这个：

```
SELECT *
FROM yourtable
WHERE CONCAT(',', col, ',') LIKE CONCAT('%,', 'Sound & Lighting', ',%') 
```

或者如果您使用的是 MySql 也是这个：

```
SELECT *
FROM yourtable
WHERE FIND_IN_SET('Sound & Lighting', col); 
```

请[在此处](http://sqlfiddle.com/#!2/66358/3)查看小提琴。

# ios - 如何使用 NSMutableArray 中的数据使用 NSUserDefaults 保存数据

> ID：15396365
> 
> 赞同：3
> 
> 时间：2013-03-13T20:59:57.620
> 
> 标签：ios, objective-c, nsuserdefaults

My`NSMutableArray`在我的 .h 文件中声明如下

```
@property (strong, nonatomic) NSMutableArray * numbers; 
```

如何使用 NSMutableArray 保存输入的数据以保存到`NSUserDefaults`

感谢所有帮助

提前致谢

.h 文件中的代码

```
@property (retain, nonatomic) IBOutlet UITableView *myTableView;
@property (strong, nonatomic) NSMutableArray * numbers; 
```

.m 中的代码

```
@synthesize myTableView, numbers;

-(void) viewDidLoad
{

    NSUserDefaults *defaults=[NSUserDefaults standardUserDefaults];
    [defaults setObject:numbers forKey:@"numberArray"];

    NSMutableArray *resultArray = [NSMutableArray arrayWithArray:[defaults objectForKey:@"numberArray"]];

    [super viewDidLoad];
    // instantiate our NSMutableArray
    numbers = [[NSMutableArray alloc]initWithObjects:@"",@"", nil];

    //Add a edit button
    self.navigationItem.leftBarButtonItem = self.editButtonItem;

    //Add the Add button
    UIBarButtonItem * addButton = [[UIBarButtonItem alloc]
                                   initWithBarButtonSystemItem:UIBarButtonSystemItemAdd target: self action: @selector(insertNewObject)];

    self.navigationItem.rightBarButtonItem = addButton;

}
-(void) didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];

}

-(void)setEditing:(BOOL)editing animated:(BOOL)animated
{

    [super setEditing:editing animated:animated];
    [myTableView setEditing:editing animated:animated];

}

-(void) insertNewObject
{

    //Display a UIAlertView
    UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"Enter HomeWork" message: @"" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"Ok", nil];

    alert.alertViewStyle = UIAlertViewStylePlainTextInput;
    [alert show];

}

#pragma mark - UITableView Datasource

-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return numbers.count;
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *cellIdentifier = @"cell";

    UITableViewCell *cell = [ tableView dequeueReusableCellWithIdentifier:cellIdentifier];

    if(cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle: UITableViewCellStyleDefault
                                      reuseIdentifier: cellIdentifier];
    }

    cell.textLabel.text = [numbers objectAtIndex:indexPath.row];

    return cell;
}

-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    return YES;

}

-(void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete)
    {
        //remove our NSMutableArray
        [numbers removeObjectAtIndex:indexPath.row];
        //remove from our tableView
        [tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }

}

#pragma mark - UITableView Delegate methods

#pragma mark - UIAlertViewDelegate Methods

-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    //Only perform the following actions if the user hits the ok button
    if (buttonIndex == 1)
    {
        NSString * tmpTextField = [alertView textFieldAtIndex:0].text;

        if(!numbers)

            numbers = [[NSMutableArray alloc]init];

    [numbers insertObject:tmpTextField atIndex:0];

        NSIndexPath * indexPath = [NSIndexPath indexPathForRow:0 inSection:0];

        [self.myTableView insertRowsAtIndexPaths:@[indexPath]withRowAnimation:UITableViewRowAnimationAutomatic];

        }

}

@end 
```

好的，在我的应用程序中，有一个 UITableView

当用户点击“加号”按钮时，会显示一个带有 UITextField 的 UIAlertView，当用户键入一个单词时，文本会转到 UITableView，但是当用户退出应用程序时，文本会从表格中消失。我想保存用户输入的文本，所以当用户退出应用程序并返回时，我希望保存文本。我想用 NSUserDefaults 保存它。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-13T21:02:24.630

```
//For saving 
NSUserDefaults *defaults=[NSUserDefaults standardUserDefaults];
[defaults setObject:self.numbers forKey:@"numberArray"];
[defaults synchronize];

//For retrieving  
NSMutableArray *resultArray = [NSMutableArray arrayWithArray:[defaults objectForKey:@"numberArray"]]; 
```

根据您在退出后运行应用程序时的场景......您应该`viewDidLoad`检查 keyExists 是否在`NSUserDefaults`然后检索数组中的结果并显示在`UITableView`. 对于保存数据，最好在用户最小化应用程序时听取通知，只需将数据保存到默认值即可。

这是您案例的工作代码

```
- (void)viewDidLoad{

   [super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.

    //Add a edit button
   self.navigationController.navigationItem.leftBarButtonItem = self.editButtonItem;

  // check here if key exists in the defaults or not, if yes the retrieve results in array
  if([[NSUserDefaults standardUserDefaults] objectForKey:@"numberArray"] != nil) {
   self.numbers = [NSMutableArray arrayWithArray:[[NSUserDefaults standardUserDefaults] objectForKey:@"numberArray"]];

}

   //Register for the notification when user go to background or minimize the app, just save the array objects in the defaults

[[NSNotificationCenter defaultCenter]   addObserver:self
                                                   selector:@selector(appWillGoToBackground:)
                                                       name:UIApplicationWillResignActiveNotification
                                                     object:[UIApplication sharedApplication]];

    //Add the Add button
UIBarButtonItem * addButton = [[UIBarButtonItem alloc]
                               initWithBarButtonSystemItem:UIBarButtonSystemItemAdd target: self action: @selector(insertNewObject)];

self.navigationController.navigationItem.rightBarButtonItem = addButton;
}

-(void)setEditing:(BOOL)editing animated:(BOOL)animated {
    [super setEditing:editing animated:animated];
    [self.myTableView setEditing:editing animated:animated];

}
-(void)appWillGoToBackground:(NSNotification *)note {
    NSLog(@"terminate");

    NSUserDefaults *defaults=[NSUserDefaults standardUserDefaults];
    [defaults setObject:self.numbers forKey:@"numberArray"];
    [defaults synchronize];

}

-(void)insertNewObject{
        //Display a UIAlertView
    UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"Enter HomeWork" message: @"" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"Ok", nil];

    alert.alertViewStyle = UIAlertViewStylePlainTextInput;
    [alert show];

}

-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
        //Only perform the following actions if the user hits the ok button
    if (buttonIndex == 1)
        {
        NSString * tmpTextField = [alertView textFieldAtIndex:0].text;

        if(!self. numbers){

            self.numbers = [[NSMutableArray alloc]init];
        }

        [self.numbers insertObject:tmpTextField atIndex:0];

        NSIndexPath * indexPath = [NSIndexPath indexPathForRow:0 inSection:0];

        [self.myTableView insertRowsAtIndexPaths:@[indexPath]withRowAnimation:UITableViewRowAnimationAutomatic];

}

-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 1;
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return self.numbers.count;
}

-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *cellIdentifier = @"cell";

    UITableViewCell *cell = [ tableView dequeueReusableCellWithIdentifier:cellIdentifier];

    if(cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle: UITableViewCellStyleDefault
                                      reuseIdentifier: cellIdentifier];
    }

    cell.textLabel.text = [self.numbers objectAtIndex:indexPath.row];

    return cell;
}

-(BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    return YES;

}

-(void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete)
        {
            //remove our NSMutableArray
        [self.numbers removeObjectAtIndex:indexPath.row];
            //remove from our tableView
        [tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationFade];
        }

} 
```

# javascript - 使用 JavaScript 显示数据在 textarea 中有效，但在 div 中无效

> ID：15396366
> 
> 赞同：0
> 
> 时间：2013-03-13T20:59:58.357
> 
> 标签：javascript, html

我无法显示从表单输入中提取到我的 div 标签的数据。数据在我使用时显示，`textarea`但只要将 ID 添加到我的 div 数据就不会显示。

这是HTML：

```
<div id="left">
<div id="input">
    <input rows="1" name="q"  id="GoogleURLtextarea"></input>
</div>
</div><!--CLOSE LEFT-->

<div id="main">
   <textarea rows="4" cols="100" id="MainURLtextarea"></textarea>
   <button onClick="ParseGoogleURL(document.getElementById('GoogleURLtextarea').value)" >     </button>
</div><!--CLOSE MAIN--> 
```

这是我的 JS：

```
function ParseGoogleURL(data)
{
    var tokenString     = data.split('/');
    var filename        = tokenString[tokenString.length - 1];
    var MainURL    = 'http://www.honeywellaidc.com/patents/pdf/' + filename + '.pdf';
    document.getElementById('MainURLtextarea').value = MainURL;
} 
```

我的问题是，如果我尝试使用 ID="MainURLtextarea" 并将其发布到 "#main" div 标签，它就不起作用。我试图用但没有工作。希望这是有道理的。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:06:25.693

在`PargeGoogleURL`您设置`value`属性时，该属性用于 <textarea>s。但是，对于 <div>，您应该使用`innerText`or `innerHTML`（视情况而定）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T16:33:01.013

我能够通过将所有内容放入 iframe 而不是嵌入它来使其工作。

HTML：

```
<div id="MainURLtextarea"></div> 
```

JS：

```
document.getElementById("MainURLtextarea").innerHTML = '<iframe src="http://www.honeywellaidc.com/patents/pdf/' + filename + '.pdf" width="100%" height="768"> 
```

# joomla - 在我的 joomla 模板中添加一个

> ID：15396370
> 
> 赞同：1
> 
> 时间：2013-03-13T21:00:14.743
> 
> 标签：joomla, joomla1.5

我是一个 Joomla 1.5 站点的管理员。我今天遇到一个问题，因为我在 Facebook 上分享一篇文章时，它被显示为没有图像。在网上搜索，我发现 Facebook 需要一个链接标签位于 html 页面的标题中，如下所示：

```
<link rel="image_src" href="..." /> 
```

虽然我的网站提供了这样的东西

```
<meta name="image" content="...." /> 
```

我的网站正在使用 K2 插件来获取文章我对 Joomla 的了解非常有限，因为我从未使用过它，但尝试搜索文件的结构并发现在 item.php 文件中引用的图像是这样的：

```
$this->item->image 
```

于是我修改了主模板的 index.php 文件，在头部添加了如下标签：

```
<link rel="image_src" href="<?php echo JURI::base() . $this->item->image; ?>" /> 
```

然而，虽然 $this->item->image; 不给出任何错误它什么也不返回。难道我做错了什么？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T23:01:31.310

$this 指的是插件的上下文，而在模板中 $this 是模板，因此是错误的。

我很长时间没有使用 1.5，但考虑到系统插件可以访问生成的标记；所以它可以插入任何操纵html文本的标签。

但是，它需要访问组件的数据才能获取图像。但是组件在插件之前运行，因此您可以在组件中设置 post var 或 global：

```
JRequest::setVar('templateheader',$this->item->image); 
```

然后在系统插件或libraries/joomla/document/html/renderer/head.php（核心hack）中检索它并打印出来。

# php - 如何在 PHP 中格式化这个 curl 命令

> ID：15396375
> 
> 赞同：0
> 
> 时间：2013-03-13T21:00:29.393
> 
> 标签：php, api

我正在尝试对我的第一个 API 和文档中显示的示例请求构建一个 PHP 调用，告诉我用 curl 发出这个请求，但我没有取得太大的成功。我试图遵循其他答案（即[CURL php 查询形式 - 如何？](https://stackoverflow.com/questions/8410868/curl-php-query-formation-how-to)）并且知道我做错了什么但似乎无法弄清楚？

任何帮助将不胜感激。

初始请求必须经过 HTTP Basic 授权。

```
 POST /api/shrink HTTP/1.1
 Host: api.site.org
 Authorization: Basic YXsdflasdkfjalsdjfojiosslkjdZdXZ3eHl6MDEyMzQ1  

curl -i --user api:api_key --data-binary @test.png http://api.site.org 
```

这应该返回一个包含图像文件 url 的 json 字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:14:53.350

应该是这样的：

```
$url = "http://api.site.org/api/shrink";

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_POST ,1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); /* obey redirects */
curl_setopt($ch, CURLOPT_HEADER, 0);  /* No HTTP headers */
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);  /* return the data */
curl_setopt($process, CURLOPT_USERPWD, 'api:api_key');

$data = array(
    'uploaded_file' => '@/path/to/test.png'
);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);

$result = curl_exec($ch);

curl_close($ch); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:15:50.673

我认为它会是这样的：

```
$c = curl_init('http://api.site.org');
curl_setopt_array($c, array(
    CURLOPT_USERPWD => 'api:api_key' // --user
    CURLOPT_POST    => 1,
    CURLOPT_POSTFIELDS => '@/full/path/to/test.png;type=image/png', // --data-binary, added mime type for good measure
    CURLOPT_HEADER => 1, // this is to the -i
    CURLOPT_RETURNTRANSFER => 1, // so you get the response back from curl_exec()
));
$response = curl_exec($c); 
```

你有`-i`标志，但我不确定你是否想要响应头，以防你也添加`CURLOPT_HEADER => 1`到混合中。此外，如果您不想在 php 进程的输出中输出响应，请使用`CURLOPT_RETURNTRANSFER => 1`，您将从 curl init 中获取响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:16:33.037

在我看来，您需要的所有信息都可以[在这里找到](http://www.php.net/manual/en/ref.curl.php)

cURL 功能`curl_setopt`允许您设置最适合您的 curl 选项。

希望这可以帮助。=)

# c# - 如果未设置 ListItem.Value 将覆盖 Text

> ID：15396385
> 
> 赞同：6
> 
> 时间：2013-03-13T21:00:50.910
> 
> 标签：c#, asp.net

如果在设置`ListItem.Value`值之前设置了一个`Text`值，则两者`Text`和`Value`都将设置为相同的值。我可以解决这个问题，但我只想知道为什么会这样？是因为某些“必须”设置到屏幕上吗？以及为什么在默认值为空字符串时覆盖。

.Net 3.5

```
ListItem li = new ListItem();
li.Value = "abc"; //Text is now = "abc"
li.Text = "def";
li.Value = "qwe"; //Text remains "def" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T21:05:17.283

这是因为[`Text`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listitem.text.aspx)属性的getter是这样实现的：

```
get
{
    if (this.text != null)
    {
        return this.text;
    }
    if (this.value != null)
    {
        return this.value;
    }
    return string.Empty;
} 
```

MSDN：

> 使用 Text 属性可以指定或确定在列表控件中显示的由 ListItem 表示的项目的文本。注意**如果 Text 属性包含 null，则 get 访问器返回 Value 属性的值**。如果 Value 属性又包含 null，则返回 String.Empty。

该[`Value`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.listitem.value%28v=vs.110%29.aspx)属性是相反的方式：

> 如果 Value 属性包含 null，则 get 访问器返回 Text 属性的值。如果 Text 属性又包含 null，则返回 String.Empty。

# drupal - Drupal 站点主页的全屏图像

> ID：15396387
> 
> 赞同：1
> 
> 时间：2013-03-13T21:00:57.857
> 
> 标签：drupal, background-image, fullscreen

我是 Drupal 的新手，我正在尝试为我正在开发的网站设置主页。这是我正在拍摄的一个示例：[https ://www.missionfed.com/](https://www.missionfed.com/)

我想要一个全屏图像作为背景和与给出的示例非常相似的框部分。我不确定我需要做什么。我应该使用面板/视图吗？更改 page.tpl.php 文件？或者是其他东西？

另外，我是 PHP 新手，所以这应该是一个有趣的学习曲线。基本上，我只需要指出正确的方向。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T04:24:40.193

您可以使用 CSS 将背景图像应用到 body 旁边的 div 中。在您的示例中，它看起来像：

```
#home #pagebg {
  background: url(/path_to_image) no-repeat center top;
  -webkit-background-size: 2560px 1440px;
  -moz-background-size: 2560px 1440px;
  background-size: 2560px 1440px;
  width: 100%;
  display: table;
} 
```

与给定站点类似的布局确实可以通过面板/视图（可能还有上下文）来完成。只需选择最接近的布局并用视图和块填充它。

另一种方法是在 .info 文件中手动定义新区域并将其输出到 page.tpl.php 中。但这需要更多的知识和时间。所以你可以坚持使用面板。

# android - Android：长按按钮上的文本

> ID：15396391
> 
> 赞同：2
> 
> 时间：2013-03-13T21:01:07.310
> 
> 标签：android, button, text, long-click

在我的 android-app 中，我试图创建一个带有两行文本的按钮。一个将显示（短）单击时按钮正在做什么，另一个应显示长按时的效果，并且该按钮可以长按。就像在安卓系统的标准键盘上一样（见图[）](http://i.stack.imgur.com/OWdzt.png)。

我试过的：

```
Bitmap canvasBitmap = Bitmap.createBitmap(64, 24, Bitmap.Config.ARGB_8888);
Canvas imageCanvas = new Canvas(canvasBitmap);
Paint imagePaint = new Paint();
imagePaint.setTextAlign(Align.CENTER);
imagePaint.setTextSize(14f);
imageCanvas.drawText(String, pxwidth/2, pxheight, imagePaint);
image = new BitmapDrawable(canvasBitmap);
((TextView) findViewById(R.id.button)).setCompoundDrawables(null,image,null,null); 
```

但我当前的 API 版本（API 9 / GINGERBREAD / Android 2.3）不支持它
你能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:05:20.627

如果您需要以 9 为目标，则不能使用该功能，您需要使用另一种技术。我能想到的一种方法是使用 ImageButton 而不是按钮，预渲染整个按钮的图像，并将其应用于 xml 中的新 ImageButton。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T12:44:39.110

我用这个`Custom View`作为解决方案（感谢 Gabe Sechan 的想法）：

```
import android.content.Context;
import android.content.res.TypedArray;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Paint.Align;
import android.util.AttributeSet;
import android.widget.Button;

class LongClickButton extends Button {
    private String mLongClickString;
    private String mOnLongClick;
    private Paint mTextPaint;
    public LongClickButton(Context context, AttributeSet attrs){
        super(context, attrs);

        mTextPaint = new Paint();
        mTextPaint.setTextSize(this.getTextSize()/2);
        mTextPaint.setColor(Color.DKGRAY);
        mTextPaint.setShadowLayer(0, 1, 1, Color.GRAY);
        mTextPaint.setTextAlign(Align.RIGHT);

        TypedArray a = context.getTheme().obtainStyledAttributes(attrs, R.styleable.LongClickButton, 0, 0);
        try{
            mLongClickString = a.getString(R.styleable.LongClickButton_longClickText);
            mOnLongClick = a.getString(R.styleable.LongClickButton_onLongClick);
        } finally {
            a.recycle();
        }
    }
    public String getLongClickString(){
        return mLongClickString;
    }
    public String getOnLongClick(){
        return mOnLongClick;
    }
    public void setLongClickString(String LongClickString){
        mLongClickString = LongClickString;
        invalidate();
        requestLayout();
    }
    public void setOnLongClick(String OnLongClick){
        mOnLongClick = OnLongClick;
        invalidate();
        requestLayout();
    }
    @Override
    public void onDraw(Canvas canvas){
        super.onDraw(canvas);
        canvas.drawText(mLongClickString, this.getWidth()-(this.getPaddingRight()/4*3), (this.getPaddingTop()/2)+mTextPaint.getTextSize(), mTextPaint);
    }
} 
```

# bash - 在 syslog 中找到特定条目时运行 bash 命令

> ID：15396395
> 
> 赞同：1
> 
> 时间：2013-03-13T21:01:17.373
> 
> 标签：bash, cron, tail, syslog

我有一个 linux 盒子，它偶尔会在 syslog 中出现错误。该错误表明系统存在严重问题。我正在努力解决问题的根源。但是，在我修好之前，我想要一个好的创可贴。我考虑过每分钟运行一个 cron 作业来检查系统日志中的错误。这可能会奏效，但它可能会使系统处于不良状态将近一分钟。这是错误：

```
 action frame to ff:ff:ff:ff:ff:ff 
```

我想知道在启动时运行脚本是否有意义。该脚本会以某种方式尾随 -F 系统日志，并在找到错误消息时运行纠正脚本。这是一个合理的想法还是有更好的解决方案。如果这是合理的，那么我如何跟踪系统日志？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-12-28T23:59:51.423

如果您正在运行一个典型的 linux 机器，并使用 rsyslog 作为系统日志记录守护进程，那么您可以使用 rsyslog 过滤器和 omprog 模块在匹配时触发一些任意命令：[http ://www.rsyslog.com/doc/ v8-stable/configuration/modules/omprog.html](http://www.rsyslog.com/doc/v8-stable/configuration/modules/omprog.html)

# javascript - 在不同的按钮中显示相同的 id。冲突

> ID：15396396
> 
> 赞同：0
> 
> 时间：2013-03-13T21:01:22.203
> 
> 标签：javascript, jquery, this, conflict

我正在从外部 html 文件加载内容。page1.html 和 page2.html。除了图片和文字，一切都一样。但与关闭按钮有冲突。它只关闭 page1.html 这是我的代码示例

```
function close_box() {
    dividid = $(this).parents('div').attr('id');
    divid = $('#' + dividid).parents('div').attr('id');
    dividofid = $('#' + divid).parents('div').attr('id');
    alert(dividofid);
    return false;
} 
```

这是html

```
<div id="page1id">
    <div id="danis">
        <div id="close_box"> <a onclick='close_box.call(this);'>page1 close</a> 
        </div>
    </div>
</div>
<div id="page2id">
    <div id="danik">
        <div id="close_box"> <a onclick='close_box.call(this);'>page2 close</a> 
        </div>
    </div>
</div>

http://jsfiddle.net/LULrE/3/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:03:56.920

您`id`在页面上的 s 必须是唯一的。如果`id`出于 CSS 原因需要在同一页面上具有相同值的页面上的多个 s，请使用该`class`属性。

出于 JS 的目的，如果您在页面上查找特定`id`内容，则只会返回第一个。在您的情况下，`$('#' + dividid);`解析为`$('#close_box');`仅返回它找到的第一个元素。

我会这样处理你的问题：

HTML：

```
<div id="page1id" class="closeable">
    <div id="danis">
        <div id="close_box"> <a onclick='close_box.call(this);'>page1 close</a> 
        </div>
    </div>
</div>
<div id="page2id" class="closeable">
    <div id="danik">
        <div id="close_box"> <a onclick='close_box.call(this);'>page2 close</a> 
        </div>
    </div>
</div> 
```

JS：

```
function close_box() {
    var page_level_div = $(this).closest('.closeable');
    page_level_div.hide()
    return false;
} 
```

编辑：

最后但同样重要的是，我建议您不要在 HTML 中使用 onclick 处理程序。特别是因为您已经在使用 jQuery，您可以像这样轻松地重写您的代码：

HTML：

```
<div id="page1id" class="closeable">
    <div id="danis">
        <div class="close_box"> <a href="">page1 close</a> 
        </div>
    </div>
</div>
<div id="page2id" class="closeable">
    <div id="danik">
        <div class="close_box"> <a href="">page2 close</a> 
        </div>
    </div>
</div> 
```

JS：

```
$(document).ready(function() {
    $(".close_box").click(function() {
        $(this).closest('.closeable').hide();
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:07:05.907

这是您更正的代码：

```
function close_box() {
    var divid = $(this).parent().parent().parent().attr('id');
    alert(divid);
    return false;
} 
```

您的代码的问题是`dividid`gets `close_box`，但是当您在选择器中使用该 id 时，它会选择第一个 id`close_box`为 的 div，即对应于 page1 的 div。

[小提琴](http://jsfiddle.net/LULrE/4/)

# ios - mapView 在 IO 中显示特定位置和注释

> ID：15396403
> 
> 赞同：3
> 
> 时间：2013-03-13T21:01:35.993
> 
> 标签：ios, annotations, location, android-mapview

我想创建一个显示确切位置的地图视图（坐标：纬度 45.733333° 和经度 9.133333°），添加带有标题和副标题的简单注释。ma 必须是静态的，不需要有当前用户位置或其他任何东西。

我将地图查看器添加到选项卡式应用程序的简单视图控制器中。我有我的 MapViewController 文件，我将它们连接（我猜）到我的 ViewController，但我似乎无法找到一个教程来做我需要的事情，其他人非常复杂，我认为他们做的比我实际做的要多得多需要，而且我是初学者，所以我遇到了一些麻烦。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:12:36.987

尝试这个：

```
 CLLocationCoordinate2D coord;
    coord.latitude = 45.733333;
    coord.longitude = 9.133333;

    MKAnnotation *ann = [[MKAnnotation alloc] initWithLocation:coord];
    [ann setTitle:@"Title"];
    [ann setSubtitle:@"Subtitle"];
    [map addAnnotation:ann]; 
```

不要忘记将变量更改为变量的名称。

**编辑**

解决方案：

创建一个类 AddressAnnotation 并粘贴此代码：

地址注解.h

```
#import <Foundation/Foundation.h>
#import <MapKit/MapKit.h>

@interface AddressAnnotation : NSObject <MKAnnotation> {
    CLLocationCoordinate2D _coordinate;
    NSString *_title;
}

@property (nonatomic, retain) NSString *title;

-(id)initWithCoordinate:(CLLocationCoordinate2D)c;

@end 
```

地址注释.m

```
#import "AddressAnnotation.h"

@implementation AddressAnnotation

- (NSString *)subtitle{
    return nil;
}

- (NSString *)title{
    return _title;
}

- (CLLocationCoordinate2D)coordinate{
    return _coordinate;
}

-(id)initWithCoordinate:(CLLocationCoordinate2D)c{
    _coordinate = c;
    return self;
}

@end 
```

现在，这是一个处理地图并创建注释的类：

MapViewController.h

```
#import <UIKit/UIKit.h>
#import <MapKit/MapKit.h>

@interface MapViewController : UIViewController

@property (nonatomic, retain) IBOutlet MKMapView *mapView;

- (IBAction)changeMapType:(UISegmentedControl *)control;

@end 
```

MapViewController.m

```
#import "MapViewController.h"
#import "AddressAnnotation.h"

@interface MapViewController ()

@end

@implementation MapViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    CLLocationCoordinate2D  location;
    location.latitude = -15.830731; // change to your coordinate latitude
    location.longitude = -47.8753; // change to your coordinate longitude

    AddressAnnotation *addAnnotation = [[AddressAnnotation alloc] initWithCoordinate:location];
    addAnnotation.title = [NSString stringWithFormat:@"Title for you annotation"];

    MKCoordinateRegion region;
    MKCoordinateSpan span;
    span.latitudeDelta = 0.002;     // 0.0 is min value u van provide for zooming
    span.longitudeDelta= 0.002;

    region.span=span;
    region.center =location;     // to locate to the center
    [_mapView addAnnotation:addAnnotation];
    [_mapView setRegion:region animated:TRUE];
    [_mapView regionThatFits:region];

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-07-02T17:15:21.413

# 2020年解决方案...

> “我想创建一个显示确切位置的地图视图（坐标：纬度 45.733333° 和经度 9.133333°）添加一个简单的注释......

所以 ...

```
@IBOutlet var map: MKMapView!

func demoMap() {
    var c = CLLocationCoordinate2D()
    c.latitude = 45.733333
    c.longitude = 9.133333

    let a = MKPointAnnotation()
    a.coordinate = c
    a.title = "Steve"
    map.addAnnotation(a)
} 
```

只需在情节提要中添加一个 MKMapView。像任何其他视图一样使用约束来定位/调整它。将 IBOutlet 链接拖到“地图”。

# c# - 根据其日期时间列值之一选择数据库实体

> ID：15396404
> 
> 赞同：0
> 
> 时间：2013-03-13T21:01:39.073
> 
> 标签：c#, asp.net, linq

我`article`在数据库中有表。该表包含`Date Expiration`可以为空的列。

如果文章没有过期，我想选择它。我有以下代码，但不幸的是，它不起作用。

```
var lstArticle = (from a in Articles.ToList()
                  where a.Block == false
                        && a.DateExpiration < DateTime.Now
                  select a).ToList(); 
```

请帮帮我

编辑：

我使用这个代码，这个工作。

```
var lstArticle = (from a in Articles.ToList()
                  where a.Block == false
                        && ((!a.DateExpiration.HasValue) || (a.DateExpiration.HasValue && a.DateExpiration.Value < DateTime.Now))
                  select a).ToList(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T21:03:40.307

如果没有日期意味着该项目尚未过期，这应该可以解决问题：

```
var lstArticle = (from a in Articles.ToList()
                  where a.Block == false
                        && (!a.DateExpiration.HasValue || a.DateExpiration < DateTime.Now)
                  select a).ToList(); 
```

~~如果没有日期意味着该项目已过期，这应该有效：~~（根据您的评论，您需要第一个示例）

```
var lstArticle = (from a in Articles.ToList()
                  where a.Block == false
                        && (a.DateExpiration.HasValue && a.DateExpiration < DateTime.Now)
                  select a).ToList(); 
```

我刚刚注意到，如果您从源中选择确切的对象，则不需要在 select 语句中使用“new”关键字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:05:22.727

假设`DateExpiration`是`DateTime?`，使用这个：

```
var lstArticle =
    (from a in Articles.ToList()
     where a.Block == false
        && a.DateExpiration.HasValue
        && a.DateExpiration.Value < DateTime.Now
     select new a).ToList(); 
```

# java - 如何在 Java 中更改 Saxon 的标准错误输出流？

> ID：15396409
> 
> 赞同：3
> 
> 时间：2013-03-13T21:02:06.637
> 
> 标签：java, stream, saxon

我正在使用 Saxon 9 在 Java 中执行 XSL 转换。如果在转换过程中出现错误，Saxon 会将输出定向到运行它的 JVM 的标准错误流。我的 Java 应用程序具有标准输出和错误的日志记录机制。如何强制 Saxon 使用我的错误输出流而不是 JVM 默认错误输出流？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T23:24:00.573

Saxon 将错误转移到[javax.xml.transform.ErrorListener](http://docs.oracle.com/javase/7/docs/api/javax/xml/transform/ErrorListener.html)对象。最初，这些对象中有一个将异常写入 stderr 的默认对象，但您可以轻松创建一个新的 ErrorListener 对象并实现其`warning`、`error`和`fatalError`方法，以将它们发送到您的自定义日志记录机制。

如何设置新的 ErrorListener 取决于[您使用的是 JAXP 接口还是 s9api 接口](http://www.saxonica.com/documentation/using-xsl/embedding.xml)。对于 JAXP 接口，您可以调用`setErrorListener`Transformer 对象。对于 s9api 接口，`setErrorListener`您可以在创建处理器时提供配置对象上的方法，或者在 XsltCompiler 对象上或 XsltTransformer 对象上提供方法。反正周围有好几个。

像这样的东西（s9api）：

```
final PrintStream logFile =
    new java.io.PrintStream("errorlog.txt"); // for example

Configuration configuration = new Configuration();
configuration.setErrorListener(new ErrorListener() {
    @Override
    public void warning(TransformerException exception) throws TransformerException {
        exception.printStackTrace(logFile); // or wherever
    }

    @Override
    public void error(TransformerException exception) throws TransformerException {
        exception.printStackTrace(logFile);
    }

    @Override
    public void fatalError(TransformerException exception) throws TransformerException {
        exception.printStackTrace(logFile);
    }
});
Processor proc = new Processor(configuration);
... 
```

如果您不想对程序中的任何内容使用 stderr，最好使用[System.setErr](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#setErr%28java.io.PrintStream%29)在程序范围内重定向它：

```
System.setErr(new java.io.PrintStream("errorlog.txt")); 
```

它需要一个[PrintStream](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html)对象，您可以将其包装在任何类型的输出/流中，因此我确信它可以适用于您的自定义日志记录机制。

# ios - 在 iOS 上使用安全框架的 SSL

> ID：15396411
> 
> 赞同：-2
> 
> 时间：2013-03-13T21:02:19.050
> 
> 标签：ios, security, ssl, frameworks, https

我知道我们可以`https://`通过 iOS 安全框架或 NSURL 发出请求。即使服务器不会为我们提供有效的证书。

此类通信的一个后果是**中间人攻击**。

有人可以解释它的使用频率以及它可能存在的其他问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:29:06.463

MITM 攻击并不常见，但这并不意味着您不应该担心它们。如果您不验证服务器的身份（即针对受信任的第三方检查证书的有效性），您的用户可能会成为受害者。

如今变得相当普遍的是人们从工作中访问服务（例如网络电子邮件），并让公司代理通过基本上执行 MITM 攻击来嗅探和记录他们的流量。

我知道这很痛苦，但是强制执行服务器的身份以提供 https 的预期安全性非常重要。如果您不能，您应该以某种方式提醒用户注意这一点，以便他们了解安全风险并在他们愿意的情况下继续操作。如果你曾经得到过“让我离开这里！” 来自 Firefox 的屏幕，这正是 FF 正在做的事情。

# ios - 简单的读/写文件方法来访问数字数据？

> ID：15396413
> 
> 赞同：0
> 
> 时间：2013-03-13T21:02:22.777
> 
> 标签：ios, iphone, sdk, plist

我正在创建一个需要主动读取和写入文件的游戏（大概我认为它将是一个`.plist`.

它将有大约 5 个值，带有一个数值。例如：

统计 1：3
统计 2：4
统计 3：1
统计 4：6
统计 5：9

我想我会为此使用`.plist`存储在 Documents 中的文件，但我想知道该怎么做，是否有一个简单的代码片段可以在整个应用程序中轻松读取和写入它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:04:49.643

结帐[NSKeyedArchiver](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSKeyedArchiver_Class/Reference/Reference.html)。这是一个用于将对象写入/归档到 plist 的轻量级类。还有相应的[NSKeyedUnarchiver](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSKeyedUnarchiver_Class/Reference/Reference.html)类用于读取/取消归档。

您拥有的另一个轻量级选项是[NSUserDefaults。](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSUserDefaults_Class/Reference/Reference.html)

这里还有一个[教程](http://keeptheseinmind.blogspot.com/2011/10/nskeyedarchiver-tutorial.html)，对两者进行了一些讨论并展示了如何使用`NSKeyedArchiver`.

更重的（但对于更大的项目或更复杂的模型对象来说更可扩展和更健壮）是[Core Data](http://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/CoreData/cdProgrammingGuide.html)。不幸的是，这也有更陡峭的学习曲线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:13:23.727

是的：

```
// read
NSMutableDictionary *data = [NSMutableDictionary dictionaryWithContentsOfFile:pathToPlist];
// get
NSLog(@"Value: %@", data[@"foo"]);
// modify
data[@"foo"] = @(1337);
// write back
[data writeToFile:pathToPlist atomically:YES]; 
```

plist 必须位于可写目录中（即无法将其添加到应用程序包中）。

# java - Java 条件检查和赋值

> ID：15396416
> 
> 赞同：0
> 
> 时间：2013-03-13T21:02:32.857
> 
> 标签：java, conditional, variable-assignment

我正在寻找一种更有效的方法来执行以下操作，其中我将方法的返回值附加到数组中。但是，如果返回为 null，我想执行另一个操作而不更改数组。

```
Object[] myVal = new Object[10];
Object temp;
temp = myFunction();
if(temp != null) {
    myVal[count++] = temp;
} else {
    System.Exit();
} 
```

我想为方法的返回分配一个变量，但如果返回的值为空，则提供“内联”检查以执行另一个操作。

就像是：

```
myVal = (myFunction() != null) ? [output of expression]: System.Exit(); 
```

有没有这样的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T21:04:34.013

```
myVal = myFunction();
if (myVal == null) System.exit(0); 
```

不需要临时变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:06:37.117

试试这个：

```
if ((myVal = myFunction()) == null) System.exit(0);
else // do your work 
```

**注意：**不推荐使用三元运算符，因为代码变得难以阅读。

# c - UNIX 停止和等待协议中的分段错误

> ID：15396422
> 
> 赞同：0
> 
> 时间：2013-03-13T21:02:46.077
> 
> 标签：c, unix, segmentation-fault

嗨，我目前正在 UNIX 中编写一个 C 程序来为学校的套接字停止和等待协议建模。当我在命令行中输入 4 个参数时，我不断收到分段错误。如果我输入多于或少于 4，那么我会抛出正确的错误。如果有人可以提供帮助，将不胜感激。提前致谢。

```
#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <netdb.h>
#include <errno.h>
#include <stdlib.h>
#include <strings.h>

#define SERVER_PORT 6500
#define MAX_LINE 256

int
main(int argc, char * argv[])
{
        FILE *fp;
        struct hostent *hp;
        struct sockaddr_in sin, client;
        char *host;
        char ack[MAX_LINE], buf[MAX_LINE], fname[MAX_LINE];
        int s, i, rnum, drop;
        int8_t current, last = -1;
        int rval, slen, NFrames, len;

        long LenFile;
        struct timeval rectime;  //The struct timeval structure represents an elapsed time
        struct timeval zone;

        if (argc==4){
                host=argv[1];
        }
        else {
            fprintf(stderr, "usage: simplex-talk host\n");
             //fprintf(stderr, "hello");
                exit(1);
        }

        if (!hp) {
                fprintf(stderr, "simplex-talk: unknown host: %s\n", host);
                exit(1);
        }

        bzero((char *)&sin, sizeof(sin));
        sin.sin_family = AF_INET;
        bcopy(hp->h_addr, (char *)&sin.sin_addr, hp->h_length);
        sin.sin_port=htons(SERVER_PORT);

        if((s=socket(PF_INET, SOCK_DGRAM,0)) < 0){
                 perror("simplex-talk; socket");
                 exit(1);
        }

        // create file request
        sprintf(buf, "%s\0", argv[3]);

        if ((rval=sendto(s,buf,sizeof(buf),0,(struct sockaddr *)&client,sizeof(client)))< 0) {
printf("sjkdfj");
perror("writing on datagram socket");
        }
        system("date");
        printf("Sent request for file %s at time = %ld %ld\n", argv[3], rectime.tv_sec, rectime.tv_usec);

        bzero(ack,sizeof(ack));
        slen = sizeof(client);

    buf[MAX_LINE-1] = '\0';
    len = strlen(buf) + 1;
         //request to send, waiting....

        while ((rval = recvfrom(s,ack,sizeof(ack),0,(struct sockaddr *)&client,&slen))<0){
                perror("receiver recvfrom");
                printf(stderr, "hhhhhhhh");
}
          //get time
        if (gettimeofday(&rectime, &zone) < 0) {
                perror("getting time");
                exit(1);
        }
        if(ack[0] == '0'){
                printf("Received file not found, time = %ld %ld, File = \"%s\"\n", rectime.tv_sec, rectime.tv_usec, fname);
        }
        if(ack[0] == '1') {
                char ch[MAX_LINE];
                int i, j;
                for(i=2, j=0; ack[i] != ' '; i++, j++){
                        ch[j] = ack[i];
                }
                ch[i++] = '\0';
                LenFile=atoi(ch);
                for(j=0; ack[i] && ack[i] != '.'; i++, j++){
                        fname[j] = ack[i];
                }
                fname[i++] = '\0';
                strcat(fname, "client.txt");
                NFrames = LenFile / MAX_LINE + (LenFile % MAX_LINE == 0 ? 0:1);
                printf("Received, ack sent, time = %ld %ld\nfname = \"%s\"\n", LenFile = "%d\n", rectime.tv_sec, rectime.tv_usec, fname, LenFile);

                //file I/O (reads)
                fp=fopen(fname, "w");
                if(fp==NULL){
                        perror("Opening File for Writing");
                        exit(1);
                }
                printf("Opening File %s for writing\n", fname);
                drop = 0;

                for(i=0; i < NFrames; ){
                        bzero(ack,sizeof(ack));
                        while ((rval = recvfrom(s,ack,sizeof(ack),0,(struct sockaddr *)&client,&slen))<0){
                                perror("receiver recvfrom");
                        }
 //get time
                        if (gettimeofday(&rectime, &zone) < 0) {
                                perror("getting time");
                                exit(1);
                        }
                        current = ack[0];
                        if(current == last) {
                                printf("Duplicate frame %d received\n", last);
                                continue;
                        }
                        printf("Recieved Frame #%d at time = %ld %ld\n\nContent:\n%s\n", current, rectime.tv_sec, rectime.tv_usec, ack+1);
                        fputs(ack+1, fp);

                        //creating ack
                        bzero(buf,sizeof(buf));
                        sprintf(buf, "%c%s\0", current, "ackp");

                        //25% chance of loss is to call random()
                        rnum = random();
                        if((rnum%4) != 0) {
                                // get time
                                if (gettimeofday(&rectime, &zone) < 0) {
                                        perror("getting time");
                                        exit(1);
                                }
                                if ((rval=sendto(s,buf,sizeof(buf),0,(struct sockaddr *)&client,sizeof(client))) < 0) {
                                perror("writing on datagram socket");
                                }else{
                                        i++;
                                        last = current;
                                        printf("Sent Received Packet ACK for Frame %d at time = %ld %ld\n", current, rectime.tv_sec, rectime.tv_usec);
                                }
                        }else{
                                drop++;
                        }
                }
                 printf("Total Number of dropped frames is %d\n", drop);
                //get time
                if (gettimeofday(&rectime, &zone) < 0) {
                        perror("getting time");
                        exit(1);
                }
                fclose(fp);
                printf("Closing file for writing at time = %ld %ld\n", rectime.tv_sec, rectime.tv_usec);
        }
        //get time
        if (gettimeofday(&rectime, &zone) < 0) {
                perror("getting time");
                exit(1);
        }
        printf("Closing Socked %d for File \"%s at time = %ld %ld\n", ntohs(client.sin_port), fname, rectime.tv_sec, rectime.tv_usec);
        close(s);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:07:13.883

需要注意的一件事：`argc`包含传递给程序的参数计数 + 一个用于程序名称。所以如果你用 4 个参数运行你的程序，`argc = 5`并且`if (argc==4)`不会被满足。如果这不能解决问题，那么段错误的堆栈是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:19:57.527

你的*第一个*问题在这里：

```
bcopy(hp->h_addr, (char *)&sin.sin_addr, hp->h_length); 
```

`hp`指向哪里？这是一个尚未初始化的指针，它指向内存中的某个随机区域。访问内存中不属于您的一些随机区域是不好的。不要这样做。

# android - ADB 看不到设备

> ID：15396423
> 
> 赞同：0
> 
> 时间：2013-03-13T21:02:52.643
> 
> 标签：android, linux, adb, ubuntu-12.10, xubuntu

-Lsusb：

```
Bus 001 Device 002: ID 8087:0020 Intel Corp. Integrated Rate Matching Hub

Bus 002 Device 002: ID 8087:0020 Intel Corp. Integrated Rate Matching Hub

Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub

Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub

Bus 001 Device 003: ID 03f0:231d Hewlett-Packard 

Bus 001 Device 004: ID 138a:0007 Validity Sensors, Inc. VFS451 Fingerprint Reader

Bus 001 Device 005: ID 5986:03b1 Acer, Inc 

Bus 002 Device 006: ID 1058:07a8 Western Digital Technologies, Inc. 

Bus 002 Device 003: ID 046d:c018 Logitech, Inc. Optical Wheel Mouse

Bus 002 Device 004: ID 2207:0010 
```

最后一个是你想要 adb connect 的那个。

/etc/udev/rules.d/51-android.rules：

```
SUBSYSTEM=="usb", ATTR{idVendor}=="2207", MODE="0666", GROUP="plugdev" 
```

该设备是 pipo s1 平板电脑，所以：xubuntu quantal。在同一台 PC 上可以毫无问题地连接我的手机。

请给我带来光明。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T22:06:21.347

尝试将 ATTR{idProduct}=="0010" 添加到该行。

看看这个链接 [http://pychildren.blogspot.se/2012/12/getting-android-adb-working-with-pipo.html](http://pychildren.blogspot.se/2012/12/getting-android-adb-working-with-pipo.html)

问候！/托马斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T10:45:34.183

尝试而不是像这样的字符串

```
SUBSYSTEM=="usb", ATTR{idVendor}=="2207", MODE=="0666", GROUP="plugindev" 
```

添加到 /etc/udev/rules.d/51-android.rules

```
SUBSYSTEMS=="usb", ATTRS{idVendor}=="2207", TEST=="/var/run/ConsoleKit/database", RUN+="udev-acl --action=$env{ACTION} --device=$env{DEVNAME}" 
```

在我的情况下，它使 adb 在 Ubuntu 12.04 上与另一台设备一起工作。

当然在 ~/.android/adb_usb.ini 添加字符串

```
0x2207 
```

# nsarray - 按字母顺序排序 NSArray

> ID：15396424
> 
> 赞同：-1
> 
> 时间：2013-03-13T21:03:01.380
> 
> 标签：nsarray

我编写了一个按姓氏字母顺序对 NSArray 进行排序的代码。我不知道如何让它一直跟随名字。有 strLName（姓氏）和 strFName（名字）。

我需要它看起来像这样（例如）：

史蒂夫杰克逊蒂姆杰克逊艾伦琼斯黛安琼斯

目前它这样做：

蒂姆·杰克逊 史蒂夫·杰克逊 黛安·杰克逊 艾伦·杰克逊

到目前为止，这是我的代码：

```
 {
    [super viewDidLoad];

NSArray *arr = [[NSArray alloc] initWithObjects:@"a", @"b", @"c", @"d", @"e", @"f", @"g", @"h", @"i", @"j", @"k", @"l", @"m", @"n", @"o", @"p", @"q", @"r", @"s", @"t", @"u", @"v", @"w", @"x", @"y", nil];

mArrSearched = [[NSMutableArray alloc] init];

for (int i=0; i<[AppDelegate sharedAppDelegate].arrGuests.count; i++) 

 {  President *pres = [[AppDelegate sharedAppDelegate].arrGuests objectAtIndex:i];

    NSString *strLName = pres.strLName;

    NSString *strAlpha = [NSString stringWithFormat:@"%c", [strLName characterAtIndex:0]];

    NSString *str = [arr objectAtIndex:self.nIdx-1];

    NSLog(@"LastName=%@, Alpha=%@, selectedStr=%@", strLName, strAlpha, str);

    if ([strAlpha isEqualToString:[str uppercaseString]] || [strAlpha isEqualToString:str]) 
    {
        NSDictionary *dict = [[NSDictionary alloc] initWithObjectsAndKeys:[NSNumber numberWithInt:i], @"Index", strLName, @"Name", nil];

        [mArrSearched addObject:dict];
    }
}
[self sortByAlpha];

[tblView reloadData];
}

- (void) sortByAlpha {

NSSortDescriptor * frequencyDescriptor = [[NSSortDescriptor alloc] initWithKey:@"Name" ascending:YES];

id obj;

if (mArrSearched.count > 0) 
{
    NSEnumerator * enumerator = [mArrSearched objectEnumerator];

    while ((obj = [enumerator nextObject])) NSLog(@"%@", obj);

    NSArray * descriptors = [NSArray arrayWithObjects:frequencyDescriptor, nil];

    NSArray * sortedArray = [mArrSearched sortedArrayUsingDescriptors:descriptors];

    NSLog(@"\nSorted ...");

    enumerator = [sortedArray objectEnumerator];

    while ((obj = [enumerator nextObject])) NSLog(@"%@", obj);

    NSLog(@"%d", [[[mArrSearched objectAtIndex:0] objectForKey:@"Name"] intValue]);

    mArrSearched = [sortedArray mutableCopy];

}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:09:51.533

> 我不知道如何让它一直跟随名字。

您几乎已经在代码中得到了正确的答案：

```
NSArray * descriptors = [NSArray arrayWithObjects:frequencyDescriptor, nil];
NSArray * sortedArray = [mArrSearched sortedArrayUsingDescriptors:descriptors]; 
```

您缺少的一点是您可以向数组添加多个排序描述符`descriptors`，并且它们将按顺序应用，直到可以确定两个项目的排序顺序。因此，如果第一个排序描述符说两个项目匹配，则使用第二个描述符，依此类推。NSArray 的文档页面说：

> 第一个描述符指定用于对接收数组的内容进行排序的主键路径。任何后续描述符都用于进一步细化具有重复值的对象的排序。有关其他信息，请参阅 NSSortDescriptor。

# ruby-on-rails - 返回哪个 http 状态码，404 还是 422？

> ID：15396425
> 
> 赞同：9
> 
> 时间：2013-03-13T21:03:07.490
> 
> 标签：ruby-on-rails, http, rest

我有一个带有下一个资源的 Rails API 应用程序：`/images`. 所有图像都有一个`owner`.

要创建新图像，我会向 /images 发出下一个请求：

```
image_info = { owner_id: '1234', name: 'img1' }

post :create, :format => "json", :image => @image_info 
```

在图像控制器中，我做：

```
owner = User.find( params[:owner_id] ) 
```

如果`owner_id`不存在或无效，后端应该返回什么错误代码，404 或 422 `owner_id: invalid`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-13T21:05:34.737

**更新** 我再次阅读，我将更改我的答案，`422`因为您无法完成对请求的处理。无法处理的实体是更好的匹配，您没有请求对象，因此“未找到”没有多大意义。最后是你的选择，只要选择你觉得更好的。

422 Unprocessable Entity (WebDAV; RFC 4918) 请求格式正确，但由于语义错误而无法遵循

来源：[http ://en.wikipedia.org/wiki/List_of_HTTP_status_codes#4xx_Client_Error](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#4xx_Client_Error)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-12-06T13:04:34.957

首先，我认为这个问题不应该只针对 Ruby，因为它适用于大多数 Web 应用程序。

根据 mozilla 的开发指南[https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/422)：

> 超文本传输​​协议 (HTTP) 422 Unprocessable Entity 响应状态码表示服务器理解请求实体的内容类型，请求实体的语法正确，但无法处理包含的指令。

我会说使用代码 422，因为请求路径是正确的，提供的数据也是正确的，但没有这样的实体。此外，它在描述中说 - 请求不应在未经修改的情况下重复 - 这适用于这种情况。当请求路径错误时，我会说 404 最合适。将它用于其他任何事情都会让发送请求的人感到困惑，因为它没有提供足够的信息。如果您在您的情况下返回 404，我会感到困惑，并认为我将请求发送到了错误的 uri。希望有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:06:37.960

> `422 (Unprocessable Entity)`状态码表示服务器理解请求实体的内容类型（因此 状态`415 (Unsupported Media Type)`码不合适），请求实体的语法正确（因此`400 (Bad Request)` 状态码不合适）但无法处理包含的指令。例如，如果 XML 请求正文包含格式正确（即语法正确）但语义错误的 XML 指令，则可能会出现这种错误情况。

（在[这里](http://www.ruby-forum.com/topic/98002)找到）

由于不是这种情况，我会选择 404。查询有效但未找到对象。

# php - 以不同用户身份从网站执行 tcl 脚本

> ID：15396431
> 
> 赞同：0
> 
> 时间：2013-03-13T21:03:39.500
> 
> 标签：php, web, tcl

我正在建立一个将在后台运行 tcl 脚本的网站。

我想从我的网站调用并执行它的 tcl 脚本很少。我在 Linux/Apache 服务器中使用 PHP 设计页面。我很少有用户会执行这些脚本，但是这些脚本应该以该用户而不是 web 用户 (_www) 的身份执行，因为 tcl 脚本最终会自动将报告发送给执行它的用户。

我认为的一个选项是更改用户（su），然后通过 执行脚本`shell_exec`，但我看到了一些安全问题。

那么有没有更好的方法呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T22:16:34.417

我会使用 执行脚本`sudo`，您可以进行配置，以便您的 WWW 用户可以在其他用户下执行 1 个单个命令（您的 tcl 脚本），而无需密码。

有关 sudo 的一些参考资料，请参阅[this （尤其是配置部分）](http://ubuntuforums.org/showthread.php?t=1132821)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T05:56:16.767

对此的一个特定于 Tcl 的解决方案可能是将您的 Tcl 脚本构建到 starpacks（单文件可执行文件）中，然后由您希望它们运行的​​用户创建拥有并设置它们。这仅适用于您希望用户成为脚本所有者的情况，而不是通过 Internet 登录的其他用户。后一种情况*更难*解决（由于涉及复杂的安全问题），以至于人们部署了整个应用程序基础设施来处理它。

你考虑过[suEXEC](http://httpd.apache.org/docs/2.2/suexec.html)吗？

# jquery - 从 URL window.location.hash 中删除哈希

> ID：15396437
> 
> 赞同：0
> 
> 时间：2013-03-13T21:03:56.427
> 
> 标签：jquery, ajax, url, hash, window.location

我需要从我的 URL 中删除 #，以便完整的 URL 是 example.com/sub-page-title 而不是 example.com/#sub-page-title。

我能够使用 substr(31) 获得一个重复的 URL，31 是 URL 的长度，包括 http://... 但我确信这不是理想的方法。

注意：我无法刷新页面。

单击时，一个外部页面被加载到一个 div 中（然后滑动到位）......一旦可见，我希望 URL 反映这一点（不带 #）。这样前进并点击“返回”会将用户带到实际页面。

代码：

```
 $(document).ready(function(){

    var hash = window.location.hash.substr(1);
    var href = $('a.load').each(function(){
        var href = $(this).attr('href');
    });

    $('a.load').click(function(){

    var toLoad = $(this).attr('href')+' #project-details';
        $('.wide-frame').animate({
            left: -985,
            duration: 'slow'
        })
    $('#project-details article').hide();   
    $('#project-details').fadeIn('normal',loadContent);

    window.location.hash = $(this).attr('href').substr(31);

    function loadContent() {
        $('#project-details').load(toLoad,showNewContent)
    }
    function showNewContent() { 
        $('#project-details').show('normal');
        $.getScript("<?php bloginfo('template_directory'); ?>/scripts/ajax-control.js");
    }
    return false;

    }); 

}); 
```

我不知道这是否相关，但我还在使用带有 jQ​​uery BBQ 的哈希历史来实现其他一些导航功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:07:19.027

一个漂亮的小[RegExp](http://www.w3schools.com/jsref/jsref_obj_regexp.asp)怎么样？

否则只需使用[replace()](http://www.w3schools.com/jsref/jsref_replace.asp)方法。

像这样 ：

```
var string = "url/#hash";
string.replace('#',''); 
```

# java - java android jnetpcap eclipse安装不工作

> ID：15396441
> 
> 赞同：0
> 
> 时间：2013-03-13T21:04:21.270
> 
> 标签：java, android, jnetpcap

我已经下载了最新版本的 jnetpcap 并将其添加到我在 eclipse 中的 android 项目中作为“添加外部 JAR”。但是当我运行程序时，应用程序立即在我的模拟器上崩溃，并且我在日志中收到以下错误：

```
java.lang.NoClassDefFoundError: org.jnetpcap.Pcap 
```

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-29T00:14:15.007

您需要首先使用 Android NDK 将 jnetpcap c 文件编译为共享库 (.so)。然后，您需要创建自己的 JNI 或使用与此[线程](http://jnetpcap.com/node/760)相关的官方网站上提供的类似[这样](http://jnetpcap.com/userguide/android)的现有 JNI 。看[这里](https://stackoverflow.com/a/15557955/1449056)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:07:01.997

你导出库了吗？在第 4 页的 eclipse 的构建路径中，确保它存在于任何可能使用它的代码之上，并确保它被选中。

# django - 找不到 django-social-auth 后端

> ID：15396448
> 
> 赞同：1
> 
> 时间：2013-03-13T21:04:51.303
> 
> 标签：django, python-2.7, django-socialauth

我正在尝试使用 Twitter、GitHub、Google 和 Facebook 添加身份验证，`django-social-auth`但我期望的后端不可用。

按照说明书安装：

```
AUTHENTICATION_BACKENDS = (
    'social_auth.backends.twitter.TwitterBackend',
    'social_auth.backends.contrib.github.GithubBackend',
    'social_auth.backends.facebook.FacebookBackend',
    'social_auth.backends.google.GoogleOAuthBackend',
    'social_auth.backends.google.GoogleOAuth2Backend',
    'social_auth.backends.google.GoogleBackend',
    # ....unnecessary backends

    'guardian.backends.ObjectPermissionBackend',
    'django.contrib.auth.backends.ModelBackend',
)

TWITTER_CONSUMER_KEY         = ''
TWITTER_CONSUMER_SECRET      = ''
FACEBOOK_APP_ID = ''
FACEBOOK_APP_SECRET = ''
GOOGLE_CONSUMER_KEY          = ''
GOOGLE_CONSUMER_SECRET       = ''
GOOGLE_OAUTH2_CLIENT_ID      = ''
GOOGLE_OAUTH2_CLIENT_SECRET  = ''

LOGIN_URL          = '/login/'
LOGIN_REDIRECT_URL = '/'
LOGIN_ERROR_URL    = '/login/'

SOCIAL_AUTH_FORCE_POST_DISCONNECT = True
SOCIAL_AUTH_FIELDS_STORED_IN_SESSION = ['next',] 
```

在 template: 中添加了 URL，`{% url socialauth_begin 'twitter' %}, {% url socialauth_begin 'github' %} etc`直到这里都很好。

但是当我点击链接时 - 它给了我错误：`Incorrect authentication service "twitter"`

根据手册，我检查了以下内容，`social_auth.backends.BACKENDS`它只有以下内容：`{'openid': <class 'social_auth.backends.OpenIdAuth'>}`

为什么我启用的后端不存在，为什么有一个我实际上没有启用的后端？

PS：python 2.7.3，django 1.4.5，django-social-auth 0.7.19

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T16:45:55.053

如果有人会像我一样愚蠢地碰到这个错误消息。您只需要来自身份验证提供商、twitter、google 等的 KEY 和 SECRET。它在错误消息中没有说明这一点，但这就是它失败的原因。

# python - 带有多个 html 文件的 NoneType AttributeError

> ID：15396451
> 
> 赞同：-1
> 
> 时间：2013-03-13T21:05:01.033
> 
> 标签：python, file, web-scraping, beautifulsoup, nonetype

我正在尝试从表中找到`tr`标签。`financialStatement`一切正常，直到我编写最后一行代码`rows = statement.findAll ( 'tr' )`，它给出：

```
AttributeError: 'NoneType' object has no attribute 'findAll' 
```

这里的 html 文件： http: [//investing.businessweek.com/research/stocks/financials/financials.asp ?ticker=TSCO:LN](http://investing.businessweek.com/research/stocks/financials/financials.asp?ticker=TSCO:LN)

```
import os
import urllib,re
from BeautifulSoup import BeautifulSoup 

path = '/Users/projectfile/'
listing = os.listdir(path)

for infile in listing:
    print "current file is: " + infile
    fileIN = open(path+infile, "r")
    line = fileIN.read()
    soup = BeautifulSoup ( line )
    statement = soup.find ( 'table' , { 'class' : "financialStatement" })
    rows = statement.findAll ( 'tr' ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:08:51.847

这意味着`statement`在无。所以可能这一行：`soup.find ( 'table' , { 'class' : "financialStatement" })`没有找到任何东西并返回None。

您可以添加一个 if 语句来测试 if 语句是否有值：

```
if statement:
   rows = statement.findAll ( 'tr' )
else:
   rows = None 
```

# mod-rewrite - 对于不存在的页面，Mod Rewrites 不会转到“404 page not found”

> ID：15396454
> 
> 赞同：-1
> 
> 时间：2013-03-13T21:05:12.030
> 
> 标签：mod-rewrite, http-status-code-404

我有以下代码，效果很好：

```
Options +FollowSymLinks
RewriteEngine on
RewriteRule ^([a-zA-Z0-9_-]+)/?$ index.php?mode=$1 [QSA]
RewriteRule ^([a-zA-Z0-9_-]+)/([a-zA-Z0-9_-]+)/?$ index.php?mode=$1&productContent=$2 [QSA] 
```

我的问题是当我转到我的网站上不存在的页面时，即。mysite.com/books 我收到以下警告错误：无法打开流：没有这样的文件或目录。有没有办法避免这个错误，而是让它转到“404 Page Not Found”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T02:44:11.370

您无法使用 Apache 的 mod_rewrite 处理它，这是一个脚本错误，必须由代码（在您的情况下为 php）处理。

# git - Git 子模块：是否可以通知其他开发人员更改？

> ID：15396464
> 
> 赞同：3
> 
> 时间：2013-03-13T21:05:43.380
> 
> 标签：git, git-submodules

假设我修复了多个项目使用的公共子模块中的错误。

有没有办法自动通知所有超级项目的开发者更新子模块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T22:15:35.147

> 有没有办法自动通知所有超级项目的开发者更新子模块

不
，子模块是上游存储库的克隆，嵌套在父存储库中。与您克隆为子模块的原始存储库相比，
它是一个*下游存储库。*

在分布式环境中，您根本不知道下游存储库。
你只知道上游仓库。
参见“ [“下游”和“上游”的定义</a>”。](https://stackoverflow.com/questions/2739376/definition-of-downstream-and-upstream/2749166#2749166)

[](https://stackoverflow.com/questions/2739376/definition-of-downstream-and-upstream/2749166#2749166)

[如“](https://stackoverflow.com/questions/2739376/definition-of-downstream-and-upstream/2749166#2749166)[更新 git 子模块](https://stackoverflow.com/a/5828396/6309)”中所述，您需要进入子模块并`git pull`直接进入其中以更新所述子模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T01:33:13.340

您可以添加一个提交后[挂钩](https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks)来发送电子邮件。

您可以使用（bash 语法）获取分支上所有提交者的电子邮件

```
git log --pretty:format="%ce" | sort | uniq 
```

或者，强制开发人员

```
git pull --recurse-submodules 
```

每次拉取时始终使用所有子模块的最新版本。如果推送了重大更改，则可能不是一个好主意，具体取决于您希望如何执行此操作。

# javascript - 在 D3 中转换百分比似乎不起作用

> ID：15396470
> 
> 赞同：1
> 
> 时间：2013-03-13T21:06:15.427
> 
> 标签：javascript, d3.js

我正在做一个可视化，我在其中堆叠矩形并使它们占容器高度的某个百分比，但是尝试运行转换似乎会在开始转换之前将每个矩形的高度重置为其他值。

我认为它占用了像素高度并意外地将其转换为百分比。假设我将高度设置为 13%，13% 表示高度为 45px。然后假设我想将其转换为 10%。当我开始过渡时，高度跳到 45% (45px->45%)，然后滚动到 10%。

我不知道在哪里查看 D3 代码。这是一个显示行为的小提琴：http: [//jsfiddle.net/8vGm7/](http://jsfiddle.net/8vGm7/)

```
function reload() {
  var newArray = [];
  var i, sum = 0, nextVal;

  for(i = 0; i < 10; i++) {
    nextVal = Math.random();
    newArray.push(nextVal);
    sum += nextVal;
  }

  var container = d3.select('#container');
  var join = container.selectAll('div.row').data(newArray);

  join.enter().append('div').style('height', '0%')
    .style('background-color', function(d,i) {
      return ['red', 'green', 'blue', 'orange', 'yellow', 'purple', '#ff0', '#0ff', '#000', '#66F'][i];
    })
    .attr('class', 'row');

  join.transition().duration(2000)
    .style('height', function(d) {
      return (100e0 * (d / sum)) + '%';
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T23:58:55.177

Try this out: [http://jsfiddle.net/8vGm7/6/](http://jsfiddle.net/8vGm7/6/)

combination of style + clear previous content from the container.

```
var colors = ['red', 'green', 'blue', 'orange', 'yellow', 'purple', '#ff0', '#0ff', '#000', '#66F'];    
function reload() {
    var i=0, 
        sum = 0, 
        newArray = [],
        nextVal,
        container,
        join;

    for(i = 0; i < 10; i++) {
        nextVal = Math.random();
        newArray.push(nextVal);
        sum += nextVal;
    }

    document.querySelector('#container').innerHTML = '';
    container = d3.select('#container');
    join = container.selectAll('div.row').data(newArray);

    join
    .enter()
    .append('div')
    .attr('style', function(d,i){
        return 'height:0%; background-color: ' + colors[i];
    })
    .attr('class', 'row');

    join
    .transition()
    .duration(2000)
    .style('height', function(d) {
        return (100e0 * (d / sum)) + '%';
    });
} 
```

# jsf - JSF outputtext 条件显示/样式。视情况而定

> ID：15396471
> 
> 赞同：7
> 
> 时间：2013-03-13T21:06:17.093
> 
> 标签：jsf, rendering, conditional

我正在使用 JSF，并且每个示例“qwerty”都有一个输出文本，如果满足某些条件，我想以不同的方式显示/格式化。因此，例如，如果：

*   cond1 为真，那么我想显示~~qwerty~~
*   cond1 为假，那么我想显示*qwerty*

等等。

有办法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-13T21:13:25.573

您可以使用[三元运算符](https://stackoverflow.com/q/4628145/1199132)来根据条件选择要应用的样式：

```
<h:outputText value="qwerty" 
    style="#{backingBean.cond1 ? 'text-decoration:line-through;':'fontstyle:italic;'}"> 
```

如果您按照内联样式的顺序使用 css 类会更好。祝你好运！

在 EL 中使用“条件”内联也是可能的，请参阅[在渲染属性中使用大于逻辑表达式](https://stackoverflow.com/questions/7145574/using-greater-than-logical-expression-in-rendered-attribute)。另请阅读[有关在 xhtml 或 javabean 中使用内联的讨论](https://softwareengineering.stackexchange.com/questions/181691/should-a-complex-el-expression-be-replaced-by-a-single-javabean-getter)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-13T21:15:41.137

整洁的方法是创建 CSS 类

```
<h:outputText value="qwerty" 
     styleClass="#{backingBean.cond1 ? 'classA' : 'classB'}" /> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-13T21:16:01.277

在类似的情况下，我使用以下

```
<h:outputText value="yourValueFromYourBeanOrWhatever" styleClass="anArbitraryName#{managedBean.condition}"/> 
```

在我的 CSS 文件中，我定义了类：

```
.anArbitraryNametrue{} 
```

和

```
.anArbitraryNamefalse{} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-12T15:02:36.080

有条件的。在审讯之前你提出条件。如果为真，则返回 t ":" 之前的内容。如果为假，则返回“:”后面的内容。

```
<h:outputText value="#{condition ? 'true' : 'false'}" /> 
```

# java - Java 如何将两个 JPanel 放到 JFrame 上

> ID：15396474
> 
> 赞同：0
> 
> 时间：2013-03-13T21:06:26.963
> 
> 标签：java, swing, graphics, layout-manager

我正在制作一个简单的扫雷游戏（顶部没有菜单和其他东西）我需要的是一个 9x9 的棋盘，当点击每个图块时，如果附近没有炸弹，它要么是空白的，要么说它附近有多少炸弹，或者说B代表炸弹。

我已经正确完成了以上所有操作，并且运行良好，我的问题是我需要放入一个从 0 开始并在我玩游戏时不断从 0 开始计数的计时器，直到我点击一个炸弹停止的地方。然后我将在我的董事会下方有一个用户可以输入他们姓名的地方，在它下方有一个名为提交的按钮，它将标出该人的姓名和时间。（注意玩家可以随时这样做）

我的问题是，每当我尝试将 JPanel 或 JLabel 或任何真正添加到我的框架中时，它都不会放在它上面，并且我的 9x9 网格会不断缩放到我的窗口大小。我应该如何添加计时器显示和提交名称部分，以便我可以在窗口上看到它！

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class MS extends JFrame implements ActionListener{

    static JFrame bframe;
    static JPanel p;
    static double[] bomb;

    public MS() {   
        p = new JPanel(new GridLayout(9,10));  

        JButton btn;
        bomb = new double[81];
        for(int i=0; i<81; i++)
            bomb[i] = Math.random();

        for (int i=0; i< 81; i++)  {
            btn = new JButton();
            btn.addActionListener(this);
            btn.setActionCommand(Integer.toString(i));
            p.add(btn);
        }
    }

    public static void main(String[] args) {
        bframe=new MS();    //CREATE me and
        bframe.add(timelabel);
        bframe.add(p);      //add the JPanel

        bframe.setLocation(32,32);              //where my upper left hand corner goes
                //bframe.setSize(64*width, 64*height);
                bframe.setSize(500,500);
        bframe.setVisible(true);                //I start out invisible
        bframe.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);  //need this for the window manager
    }

    public void actionPerformed(ActionEvent e) {

        JButton jb = (JButton) e.getSource();
        int temp = Integer.parseInt(e.getActionCommand());

        System.out.printf("%s\n", e.getActionCommand());        

        int count = 0;
        String total = "";

        if(bomb[temp] > 0.15) {
            //for top line
            if((temp!=0) && (temp!=1) && (temp!=2) && (temp!=3) && (temp!=4) &&(temp!=5) && (temp!=6) && (temp!=7) && (temp!=8)) {
                if((temp!=0) && (temp!=9) && (temp!=18) && (temp!=27) && (temp!=36) && (temp!=45) && (temp!=54) && (temp!=63) && (temp!=72))
                    if(bomb[temp-10] <= 0.15) 
                        count++;
                if(bomb[temp-9] <= 0.15)
                    count++;
                if((temp!=8) && (temp!=17) && (temp!=26) && (temp!=35) && (temp!=44) && (temp!=53) && (temp!=62) && (temp!=71) && (temp!=80))
                    if(bomb[temp-8] <= 0.15)
                        count++;
            }
            if((temp!=0) && (temp!=9) && (temp!=18) && (temp!=27) && (temp!=36) && (temp!=45) && (temp!=54) && (temp!=63) && (temp!=72))
                if(bomb[temp-1] <= 0.15)
                    count++;    
            if((temp!=8) && (temp!=17) && (temp!=26) && (temp!=35) && (temp!=44) && (temp!=53) && (temp!=62) && (temp!=71) && (temp!=80))
                if(bomb[temp+1] <= 0.15)
                    count++;

            if((temp!=72) && (temp!=73) && (temp!=74) && (temp!=75) && (temp!=76) && (temp!=77) && (temp!=78) && (temp!=79) && (temp!=80)) {

                if((temp!=0) && (temp!=9) && (temp!=18) && (temp!=27) && (temp!=36) && (temp!=45) && (temp!=54) && (temp!=63) && (temp!=72))
                    if(bomb[temp+8] <= 0.15)
                        count++;
                if(bomb[temp+9] <= 0.15)
                    count++;
                if((temp!=8) && (temp!=17) && (temp!=26) && (temp!=35) && (temp!=44) && (temp!=53) && (temp!=62) && (temp!=71) && (temp!=80))
                    if(bomb[temp+10] <= 0.15)
                        count++;
            }
            if(count==0)
                jb.setText("");

            else {
                total=Integer.toString(count);
                jb.setText(total);              
                if(count==1) 
                    jb.setForeground(Color.blue);
                if(count==2)
                    jb.setForeground(Color.green);
                if(count==3)
                    jb.setForeground(Color.red);
            }
        }
        else
            jb.setText("B");
    }
} 
```

为清楚起见：我想知道的是为什么我的 9x9 网格框会随窗口缩放，如何修复它，以及如何添加另外 1 或 2 个 jpanel 以便我可以完成项目的其他部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:45:29.210

尝试使用这个（未经测试）：

```
public Test() {
    setContentPane(new JPanel(new BorderLayout()));
    JPanel p = new JPanel(new GridLayout(9, 9));
    JButton btn;
    bomb = new double[81];
    for (int i = 0; i < 81; i++)
        bomb[i] = Math.random();
    for (int i = 0; i < 81; i++) {
        btn = new JButton();
        btn.addActionListener(this);
        btn.setActionCommand(Integer.toString(i));
        p.add(btn);
    }
    getContentPane().add(p, BorderLayout.CENTER); // add the JPanel
    JPanel timerPanel = new JPanel();
    timerPanel.add(timelabel);
    getContentPane().add(timerPanel, BorderLayout.EAST);
    setLocation(32, 32); // where my upper left hand corner goes
    // bframe.setSize(64*width, 64*height);
    setSize(500, 500);
    setVisible(true); // I start out invisible
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // need this for the window manager
}

public static void main(String[] args) {
    javax.swing.SwingUtilities.invokeLater(new Runnable() {
        @Override
        public void run() {
            new Test();
        }
    });
} 
```

所有与 Swing 相关的事件都应该放在 Event Dispatch Thread 上，这就是您应该使用该`invokeLater(Runnable)`方法的原因。您需要使用另一个父面板，以便您可以将网格放在中心和`timerPanel`左侧。`BorderLayout`可能是最好的布局管理器。它将网格面板添加到中心和`timerPanel`左侧。任何与时间相关的内容都应添加到`timerPanel`. 应该像这样添加任何其他组件：

```
getContentPane().add(yourComponent, constraint); 
```

, , ,等`constraint`之一在哪里。希望这有帮助！`BorderLayout.NORTH``BorderLayout.SOUTH``BorderLayout.WEST``BorderLayout.EAST`

# cuda - 从多个 cuda 文件访问相同的设备内存

> ID：15396475
> 
> 赞同：0
> 
> 时间：2013-03-13T21:06:32.617
> 
> 标签：cuda

我想设计一个代码，其中应该从多个 cuda 文件中的内核访问相同的设备内存。下面给出了一个简化示例，其中 main.c 调用了 3 个 .cu 文件：cuda_malloc.cu、cuda_print.cu 和 cuda_free.cu。

Main.c 文件：声明一个指针“d_array”

```
main()
{
int maxpar = 10;

float* d_array;

cuda_malloc(maxpar, d_array);

cuda_print(maxpar,d_array);

cuda_free(d_array);
} 
```

cuda_malloc.cu 文件：为 d_array 分配设备内存并将值设置为零。

```
extern "C" void cuda_malloc(int maxpar, float* d_array)
{
    CUDA_SAFE_CALL(cudaMalloc((void**)&d_array,sizeof(float)*maxpar));
    CUDA_SAFE_CALL(cudaMemset(d_array,'\0',sizeof(float)*maxpar));
} 
```

cuda_print.cu 文件：调用“kernel”从设备内存中打印“d_array”

```
extern "C"
{
__global__ void kernel(int maxpar, float* d_array)
{
    int tid = threadIdx.x;
    if (tid >= maxpar) return;
    printf("tId = %d, d_array[i] = %f \n",tid,d_array[tid]);
}

    void cuda_print(int maxpar, float* d_array)
{
    //If I un-comment the following 2 lines, the kernel function prints array values
    //otherwise, it does not
    //CUDA_SAFE_CALL(cudaMalloc((void**)&d_array,sizeof(float)*maxpar));
    //CUDA_SAFE_CALL(cudaMemset(d_array,'\0',sizeof(float)*maxpar));

    kernel <<<1, maxpar>>> (maxpar,d_array);

    cudaDeviceSynchronize();
    cudaGetLastError();
} 
```

cuda_free.cu 文件：释放设备内存

```
extern "C" void cuda_free(float* d_array)
{
    CUDA_SAFE_CALL(cudaFree(d_array));
} 
```

这段代码编译得很好。请注意，我试图在从“cuda_print.cu”文件调用的“内核”函数中打印“d_array”。但是，它不会打印它。也没有错误。如果在“cuda-print.cu”文件中，我再次分配设备内存并将其设置为零，然后内核打印它。

我的问题是：如何从多个 cuda 文件访问相同的设备内存？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:29:57.917

您的问题出在函数中`void cuda_malloc(int maxpar, float* d_array)`。你打电话时：

```
CUDA_SAFE_CALL(cudaMalloc((void**)&d_array,sizeof(float)*maxpar));
CUDA_SAFE_CALL(cudaMemset(d_array,'\0',sizeof(float)*maxpar)); 
```

`d_array`仅在“本地”更改。

而不是您的方法，您的函数应该如下所示：

```
extern "C" void cuda_malloc(int maxpar, float** d_array) {
    CUDA_SAFE_CALL(cudaMalloc((void**)d_array,sizeof(float)*maxpar));
    CUDA_SAFE_CALL(cudaMemset(*d_array,'\0',sizeof(float)*maxpar));    
} 
```

并这样称呼它：

```
cuda_malloc(maxpar, &d_array); 
```

# image-processing - 微型 MCE 图像上传端点

> ID：15396478
> 
> 赞同：1
> 
> 时间：2013-03-13T21:06:56.040
> 
> 标签：image-processing, tinymce, mcimagemanager

我想弄清楚如何在 TinyMCE 中设置自己的图像上传端点。我似乎无法在文档中找到它，我宁愿不使用 MCImageManager，因为它有太多我想要完成的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T17:05:10.857

我建议的解决方案是删除 advimage 按钮并指定您自己的上传图片按钮。如果您使用的是 jquery 插件，则很好。

```
 $('textarea.tinymce').tinymce({
        // Location of TinyMCE script
        script_url : '../../../js/vendor/tiny_mce/tiny_mce.js',

        // General options
        theme : "advanced",
        skin : "bootstrap",
        plugins : "pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",

        // Theme options
        theme_advanced_buttons1 : "uploadimageCustom, save,newdocument,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,styleselect,formatselect,fontselect,fontsizeselect",
        theme_advanced_toolbar_location : "top",
        theme_advanced_toolbar_align : "left",
        theme_advanced_statusbar_location : "bottom",
        theme_advanced_resizing : true,

        // Drop lists for link/image/media/template dialogs
        template_external_list_url : "lists/template_list.js",
        external_link_list_url : "lists/link_list.js",
        external_image_list_url : "lists/image_list.js",
        media_external_list_url : "lists/media_list.js",

        // Replace values for the template plugin
        template_replace_values : {
            username : "Some User",
            staffid : "991234"
        },

        setup: function (fn) {
            fn.addButton('uploadimageCustom', {
                title : 'Upload Image',
                onclick : function () {
                    // pop open your own upload modal.
                            $(selector).modal('show')
                                                           // modal has fine uploader or other plugin.

                            // after xhr for image uploading is done or on 'complete' event for fineuploader
                            // insert your image html to the textarea with 

                  $('#content').tinymce().execCommand('mceInsertContent',false,'<img src="<your newly uploaded image src>" />');"
                }
            });
        } 
```

# java - 获取 Facebook 通知 API 3.0

> ID：15396479
> 
> 赞同：0
> 
> 时间：2013-03-13T21:06:58.723
> 
> 标签：java, android, facebook, facebook-graph-api

我正在为 Android 开发一个应用程序，我需要能够定期获取用户有多少未读通知并将其显示在我的应用程序中。

我相信这在 3.0 API 中并不直接。

有人可以解释一下最好的方法吗？

我正在使用这段代码：

```
Request notificationsRequest = Request.newGraphPathRequest(
        Session.getActiveSession(), "/me/notifications",
        new Request.Callback() {

            @Override
            public void onCompleted(Response response) {
                GraphObject object = response.getGraphObject();
                if (object != null) {
                    notifications = object.getProperty("data")
                            .toString();
                } else {
                    notifications = "Notifications returns null";
                }
            }
        }); 
```

但它正在回归`null`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T11:26:19.913

您必须包括“include_read”和“true”。你可以这样做：

```
if (object != null) {

    try {

    JSONObject jsonObject = object.getInnerJSONObject().getJSONObject("summary");
    int notificationsUnread = jsonObject.getInt("unseen_count");

    Log.i("FB notificationsSummary", jsonObject + "");

    } catch (JSONException e) {             
        // TODO Auto-generated catch block
        e.printStackTrace();                        
    }

    Bundle notificationParams = new Bundle();
    notificationParams.putString("include_read", "true");
    yourRequest.setParameters(notificationParams);

    yourRequest.execute();
} 
```

# odata - 自定义控制器

> ID：15396483
> 
> 赞同：1
> 
> 时间：2013-03-13T21:07:07.317
> 
> 标签：odata, servicestack, breeze

因此，如果我们通过 Breeze / OData 取回一个 LINQ 表达式树，那么人们有哪些示例可以解释非标准 SQL / EF 的情况，最好是在 ServiceStack 上下文中。

试图发现正在开发中或已经存在的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T19:46:17.917

除了微风拉链中的**NoDb**示例外，我们还没有很多示例。但我们正在积极努力在下个月左右推出一些产品。

我们正在考虑添加对 ServiceStack 的支持，但现在您可能想尝试使用 Web Api ApiController 类开始。您可以应用于 ApiController 类的 [BreezeController] 属性提供了将微风客户端查询过滤器与控制器方法 IQueryable 结果组合在一起所需的所有表达式树繁重工作。

这意味着任何“webApi”ApiController 只需将其端点表示为 IQueryable，其中微风客户端具有一些关于类型 T 的元数据。该元数据可以在客户端或服务器端提供。（我现在从客户端开始，几周后我们将有一个更好的 NonEF 服务器元数据故事）。

对 SQL 或 EF 都没有要求。事实上，我们现在正在研究 Raven 和 MongoDb 示例。

希望这可以帮助。

# prolog - AI特定语言在Web应用程序中的人工智能

> ID：15396491
> 
> 赞同：3
> 
> 时间：2013-03-13T21:07:25.290
> 
> 标签：prolog, artificial-intelligence, swi-prolog

有没有办法将 prolog 或 lisp 编程与基于 Web 的应用程序集成？其实我想在我的网站上提供一些情报。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:36:41.833

SWI-Prolog[站点](http://www.swi-prolog.org/)完全*由*SWI-Prolog 运行。然后，如果您可以在您的主机上运行 SWI-Prolog，您就可以重复使用相同的技术。

当然，如果您必须“发布”一些可以受益于 Prolog 的某些特殊优势的应用程序，这当然是有道理的。

SWI-Prolog 特别关注[语义网](http://www.swi-prolog.org/web/index.html)。但这不是一个简单的主题，您可能会错过我们在当今网站（CMS、WordPress 等）上熟悉的一些“高级”用户演示。

否则，您可以使用一些传统的前端，并将您的逻辑“调用”为 Web 服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:11:00.930

有很多方法可以做到这一点。通过嵌入 c 库或我推荐的方法是查看[http://clojure.org/](http://clojure.org/)，它是一个将在 JVM 上运行的 lisp 端口。因此它可以部署到您的 servlet 容器中。还有[http://www.gnu.org/software/gnuprologjava/](http://www.gnu.org/software/gnuprologjava/)但我之前没试过。GNU java prolog 看起来差不多，只是使用了 prolog。

# sql - PL\SQL 从第 1 列中选择第一行，其中第 2 列是唯一的

> ID：15396493
> 
> 赞同：1
> 
> 时间：2013-03-13T21:07:31.970
> 
> 标签：sql

我刚开始学习SQL。我正在使用 Oracle 数据库。

表 emp，列 empno、ename、job、mgr、hiredate、sal、comm、deptno。

我想从每个 deptno 的 ename 列中获取第一条记录，并且 ename 必须按 asc 排序。

以下 SQL 有效：

```
Select ename
from (Select d.ename
From emp d
Where d.deptno = 10
Order by ename asc)
where rownum <= 1
Union
Select ename
from (Select d.ename
From emp d
Where d.deptno = 20
Order by ename asc)
where rownum <= 1
Union
Select ename
from (Select d.ename
From emp d
Where d.deptno = 30
Order by ename asc)
where rownum <= 1
Union
Select ename
from (Select d.ename
From emp d
Where d.deptno = 40
Order by ename asc)
where rownum <= 1 
```

我想优化它，所以如果我向 deptno 列添加一些记录，我不需要重写它。

我尝试过`SELECT`不同的喜欢

```
SELECT ename FROM emp WHERE (SELECT distinct deptno FROM emp) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:10:54.947

如果我了解您要正确执行的操作，则以下内容应该有效：

```
SELECT MIN(d.ename) as ename
  FROM emp d
  GROUP BY d.deptno
  ORDER BY ename asc 
```

[SQL Fiddle 在这里](http://sqlfiddle.com/#!4/fe6ca/1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:29:57.267

另一种方法

```
SELECT d.deptno, 
       (SELECT ename 
          FROM emp e 
         WHERE e.deptno = d.deptno AND ROWNUM <=1) ename
  FROM dep d 
```

**[SQLFiddle](http://sqlfiddle.com/#!4/05d6c/2)**

# database - Django 项目中的每个应用程序是否都有自己的一组数据库表？如果是，这些表可以共享吗？

> ID：15396498
> 
> 赞同：1
> 
> 时间：2013-03-13T21:07:51.563
> 
> 标签：database, django, django-models, python-2.7

每个 Django 应用程序都有自己的数据库表 是否可以在各种 Django 应用程序之间共享这些数据库表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:14:18.690

是的，每个 django 应用程序都有自己的表，这些表在您的数据库中命名为`application_tablename`.

您只需导入其模型即可访问和使用其他应用程序的表。

例如，当您这样做时：

```
from django.db import models
from django.contrib import auth

class Profile(models.Model):
    user = models.ForeignKey(auth.models.User) 
```

您正在将您的模型与另一个应用程序中的另一个模型联系起来。另一个模型有它自己的表，每次检索`Profile`模型实例（如果查询它的相关字段）或访问任何`User`实例的某些属性或方法时，您都在访问它。

# ios - 在 iOS 中使用 SlideView

> ID：15396503
> 
> 赞同：0
> 
> 时间：2013-03-13T21:08:18.417
> 
> 标签：ios, objective-c, uiviewcontroller

我想在视图控制器之间使用幻灯片视图。我找到了这些来源

[ECSliding 视图控制器](https://github.com/edgecase/ECSlidingViewController)

但在这段代码中，它与情节提要一起使用。我不想使用故事板，我想在 nib 文件上使用。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-18T02:30:19.987

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {
     UIViewController *topController = [[TopController alloc] initWithNibName:<#(NSString *)#> bundle:<#(NSBundle *)#>];           
     UINavigationController *topViewController = [[UINavigationController alloc] initWithRootViewController:topController];

     ECSlidingViewController *slidingController = [[ECSlidingViewController alloc] initWithTopViewController:topViewController];

     slidingController.underLeftViewController = [[SideMenuController alloc]   initWithNibName:<#(NSString *)#> bundle:<#(NSBundle *)#>];
     [window setRootViewController:slidingController];
     [window makeKeyAndVisible];
} 
```

如果您需要参考设置顶视图控制器和侧边菜单控制器，您可以参考示例项目——TransitionFun。顶视图和视图控制器可以是任何 UIViewController。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:10:32.007

[http://code4app.com/ios/Side-bar-demo/50c83b396803fa2d4d000001](http://code4app.com/ios/Side-bar-demo/50c83b396803fa2d4d000001) try this. But it's Chinese, you can translate it, code can be downloaded via the big button right side![enter image description here](../Images/ca105e8faf11172683087f39c7c8468b.png).

It uses the xib, very simple and useful. Hopefully it helps you.

# c# - ViewModel 成员的可见性应该是什么？

> ID：15396510
> 
> 赞同：8
> 
> 时间：2013-03-13T21:08:48.273
> 
> 标签：c#, wpf, mvvm

我遇到了一个有趣的问题，但我还没有找到任何解释......

鉴于下面非常简单的 MVVM WPF 应用程序，为什么列表仅在 ViewModel 中的可见性设置为时才绑定到组合框`public`？

`TestList`将可见性更改为`internal`在编译时不会引发错误或警告，但在运行时将组合框留空。

引用[官方文档](http://msdn.microsoft.com/en-us/library/7c5ka91b%28v=vs.110%29.aspx)：`internal`类型或成员只能在同一程序集中的文件中访问。

尽管 View 和 ViewModel 是在同一个程序集中定义的，但这个问题仍然存在。

代码如下所示：

**模型：**

```
class TestModel
{
    internal List<string> Musketeers { get; private set; }

    public TestModel()
    {
        Musketeers = new List<string> { "Athos", "Porthos", "Aramis" };
    }
} 
```

**看法：**

```
<Window x:Class="TestWpfApplication.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
        <ComboBox Width="250" Height="25" ItemsSource="{Binding TestList}" />
    </Grid>
</Window> 
```

**视图模型：**

```
class TestViewModel : INotifyPropertyChanged
{
    TestModel myModel = new TestModel();

    public List<string> TestList
    {
        get
        {
            return myModel.Musketeers;
        }
    }

    // INotifyPropertyChanged members are below ...
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T21:11:31.120

`ViewModel`with `internal`access 对 是可见的`View`，但对类不可见[`Binding`](http://msdn.microsoft.com/en-us/library/system.windows.data.binding.aspx)，这确实使绑定起作用。

`{Binding TestList}`被转换成`Binding`类实例，它不知道`internal`你的`ViewModel`类成员。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-13T21:11:58.087

这是因为数据绑定使用反射，而反射又遵循项目的可见性。由于数据绑定是在程序集之外实现的 - 在 WPF 库中 - 它不能看到非公共成员。

绑定到不存在的成员不会发出运行时错误，而是带有包含有关缺失成员详细信息的消息的调试输出。

# c# - 在单元测试中验证交互是否会破坏封装？

> ID：15396512
> 
> 赞同：2
> 
> 时间：2013-03-13T21:08:53.550
> 
> 标签：c#, .net, unit-testing

随着我对单元测试的了解越来越多，我开始意识到该领域众所周知的行为（交互）与状态验证方法。

在执行某个操作后验证某个系统**的状态对我来说似乎是合乎逻辑的。**

关于验证被测类与其他组件的交互是否可以这样说？我仍然不是 100% 相信的。

例如：

```
public void DoSomething(IDependency dependency)
{
    // some code ...

    dependency.Method();

    dependency.Method2();

    // some more code ...
} 
```

DoSomething() 的当前实现调用 Method() 和 Method2() 并且可以使用模拟测试这一事实是否具有任何实际价值？

**这两种方法的调用不是 DoSomething() 的实现细节吗？**

与基于状态的验证相比，验证交互似乎要脆弱得多，并且还会破坏封装（测试这种方法隐藏的东西）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:21:39.633

如果一个规范（有人称之为测试）要求进行某种交互，您还应该验证是否是这种情况并为此进行单元测试。例如，如果需要 SUT 保存文件，您可能应该验证该文件是否`IFileSystem.Save(...)`已被调用。如果需要 SUT 使用新文件名保护它（如果文件存在），您应该验证是否`IFileSystem.Save(...)`已使用正确的文件名调用并且`IFileSystem.Exists(...)`已被调用。这是最好的交互测试。

使用[FakeItEasy](https://github.com/FakeItEasy/FakeItEasy)它看起来像这样：

```
// arrange
var fileSystem = A.Fake<IFileSystem>();
A.CallTo(() => fileSystem.Exists("file.txt")).Returns(true);
A.CallTo(() => fileSystem.Exists("file1.txt")).Returns(false);
var sut = new SystemUnderTest(fileSystem);

// act
sut.DoSomething(); // do something that eventually saves file.txt

// assert
A.CallTo(() => fileSystem.Exists("file.txt")).MustHaveHappened();
A.CallTo(() => fileSystem.Exists("file1.txt")).MustHaveHappened();
A.CallTo(() => fileSystem.Save("file1.txt")).MustHaveHappened(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:21:29.463

嗯，好吧，如果你想验证我的行为，`DoSomething(IDependency dependency)`我会说你肯定想验证你的依赖项是否被调用。

这就是模拟通常的用途。你想确保你的依赖在你的`SuT`. 您不想被依赖项的实现细节所困扰。

所以我很好的测试会是这样的：

```
[Test]
public void DoSomething()
{
    var sut = new Whatever();
    var dependencyMock = MockRepository.GenerateMock<IDependency>();
    dependencyMock.Stub(() => mock.Method1()).Repeat = 1;
    dependencyMock.Stub(() => mock.Method2()).Repeat = 1;
    sut.DoSomething(dependencyMock);

    // verify that expected methods are being called
    dependencyMock.VerifyAllExpectations(); 

    // make some meaningful assert for sut.
    Assert. // ... etc
} 
```

请注意，我在没有打开工作室的情况下输入了这个，所以所有模错字模错误:)。只是给你一个想法。

* * *

如果您只是将功能“粘合”在一起。就像一个类在依赖对象上调用方法之后什么都不做一样，您可能值得研究是否应该重构“代码气味”。但是在你上面提供的例子中，我会说你没问题，你应该去做。

# jquery - 隐藏和显示表格列

> ID：15396513
> 
> 赞同：1
> 
> 时间：2013-03-13T21:08:54.407
> 
> 标签：jquery, jsp, spring-mvc, controller

我需要隐藏最后一列，它是基于从弹簧控制器传递的模型对象的复选框。如果模型值为“isAll”，则应该隐藏任何其他值，如果它应该是可见的，我已经尝试过，但到目前为止失败了。我不确定我是否正确地从控制器传递了值。帮助！

控制器：

```
 System.err.println("Type is: " + formbean.getType());
System.err.println("IscCode is: " + formbean.getForecastIsc());
System.err.println("ActualIscCode is: " + formbean.getActualIsc());
System.err.println("labelNbr is: " + formbean.getLabelNbr());
System.err.println("senderOp is: " + formbean.getSenderOp());       
System.err.println("senderLastName is: " + formbean.getSenderLastName());
System.err.println("receiverOp is: " + formbean.getReceiverOp());
System.err.println("receiverLastName is: " + formbean.getReceiverLastName());

    summary = summarySelectDao.getSummary(formbean);    
    if(summary == null || summary.size() == 0){         
        errorMessage = "No Parcel Analysis Cases Found!";
return new ModelAndView("redirect:/analysis/analysisSelection? hasError=true");
    }else{
    logger.info("Total " + summary.size() + " analysis cases found from DB.");
        model.addObject("summary", summary);
        model.addObject("isAll", true);  //BASED on this model if true
    }

    return model; 
```

JSP：

```
<td class="ct"<c:out value="${summary.country}" /></td>
 <td class="sc" <c:out value="${summary.source}" /></td>
 <td  class="cb" <input type="checkbox" value=""> </td> 
```

JS：

```
$(document).ready(function() {
$(".cb").hide();    
}); 
```

HTML：

```
 <div id=table1>
<table id="summaryTable" class="sortable">
    <thead>
        <tr>
            <th>&nbsp;</th>
            <th>Bar Code</th>
            <th>Origin</th>
            <th>Sender Name</th>
            <th>Recipient Name</th>
            <th>USPS Mail<br>Receipt Date</th>
            <th><br>Load Date</th>
            <th>Fore-<br>cast<br> ISC</th>
            <th>Act-<br>ual<br> ISC</th>
            <th>Country</th>
            <th>Source</th>
<th class="cb"><input type="button" id="btnSelectAllCbl" name="selectCheckBox"
            value="Update"> </th>
        </tr>
    </thead>
    <tbody> 
        <tr>

                <tr>
<td bgcolor='yellow'>P
    </td>
    <td bgcolor='yellow'><a href="AnalysisController?value=xxxxx">xxxxx
    </a>
    </td>
    <td bgcolor='yellow'>55025
                    </td>
    <td bgcolor='yellow'>xxxx
                    </td>
    <td bgcolor='yellow'>SON
    </td>
 <td  bgcolor='yellow'>
        </td>
<td bgcolor='yellow'>2013/02/11 060205
</td>
<td bgcolor='yellow'>ORD
                    </td>
<td bgcolor='yellow'>ORD
                    </td>
                    <td  bgcolor='yellow'>SINGAPORE
                    </td>
                    <td  bgcolor='yellow'>RECIPIENT
                    </td>
                    <td class="cb" bgcolor='yellow'><input
                        type="checkbox" value="">
                    </td> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T04:19:52.077

最简单的方法：用于`<c:if>`打印/不打印列：

```
<c:if test="${isAll}">
    <td  class="cb"><input type="checkbox" value=""></td>
</c:if> 
```

对列标题也执行相同的操作。

# sql - 我想在 SQL 数据库中存储许多对象类型。我应该为每种对象类型设置不同的表吗？

> ID：15396514
> 
> 赞同：5
> 
> 时间：2013-03-13T21:08:59.130
> 
> 标签：sql, schema

该数据库存储工程项目的不同对象类型：电机、电缆、泵、传感器等。

我们正在讨论是否为每种对象类型设置不同的表？（成堆的表，当我们想要添加一个新的对象类型时很痛苦——这会不时发生......）

或者，就像我们目前所做的那样，我们是否应该有一个存储对象类型（ID、名称）的表和另一个存储每个对象类型的可能属性的表，以及另一个存储每个属性类型的每个属性值的表？（一个真正的 PITA，但灵活。）

有人做过类似的事情吗？需要考虑的要点？执行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T21:19:34.563

如果您可以获得[企业应用程序架构模式](http://www.martinfowler.com/books/eaa.html)(Fowler) 的副本，请查看[Object-Relational Structural Patterns](http://martinfowler.com/eaaCatalog/)；每种方法都有利有弊，答案会根据您的特定项目的上下文而有所不同。

具体来说：

[单表继承](http://martinfowler.com/eaaCatalog/singleTableInheritance.html)

[类表继承](http://martinfowler.com/eaaCatalog/classTableInheritance.html)

[具体表继承](http://martinfowler.com/eaaCatalog/concreteTableInheritance.html)

[序列化 LOB](http://martinfowler.com/eaaCatalog/serializedLOB.html)（如果您考虑这种模式，还可以考虑使用 NoSQL 数据存储而不是 RDBMS）

您需要回答的最大问题是关系数据库是否适合您的数据。您只是在寻找存储数据的地方吗？你会使用来自不同对象的数据吗？[在序列化 LOB中使用出色的序列化框架（如](http://martinfowler.com/eaaCatalog/serializedLOB.html)[Kryo](https://code.google.com/p/kryo/)）并在标准列中存储搜索或关联关系所需的元数据可能就足够了。

# makefile - OpenEdge ABL 有生成文件吗？

> ID：15396515
> 
> 赞同：1
> 
> 时间：2013-03-13T21:09:01.663
> 
> 标签：makefile, progress-4gl, openedge

我正在拼命寻找一种方法来为 Progress OpenEdge ABL 制作一个 makefile，并让它根据源文件的更改只编译应用程序的一个子集。

有没有人设置过这样的东西？我以前在 C 应用程序中使用过 makefile，但从来没有在 Windows 下使用不是所有文件都遵循设置命名约定的环境（例如 abc/xxx 可能是程序或包含）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-14T16:24:52.307

[PCT](https://code.google.com/p/pct/wiki/InstallDocumentation)可能是答案，它是一个 JAR，您可以在 ANT 脚本中使用它并通过许多选项管理进度编译，包括多线程或仅重新编译所需的内容。

# ruby-on-rails - rake db:migrate 出错

> ID：15396516
> 
> 赞同：0
> 
> 时间：2013-03-13T21:09:19.577
> 
> 标签：ruby-on-rails, dbmigrate

我最近刚刚将我正在开发的示例 Rails 应用程序克隆到我的 macbook 上，我正在尝试运行 rake db:migrate 但我收到以下错误

```
rake aborted!
/Users/anderskitson/Sites/sample_app/db/migrate/20130207032207_add_password_digest_to_users.rb:5: syntax error, unexpected keyword_end, expecting $end 
```

这是rb文件

```
raclass AddPasswordDigestToUsers < ActiveRecord::Migration
  def change
    add_column :users, :password_digest, :string
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:10:20.093

您在第一行第一个单词 (raClass) 中有错字。它应该是：

```
 Class AddPasswordDigestToUsers < ActiveRecord::Migration
      def change
        add_column :users, :password_digest, :string
      end
    end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T22:34:28.917

尝试使用“类”而不是“类”...

# json - 如何从 json 中删除（和更新）所需字段？

> ID：15396517
> 
> 赞同：0
> 
> 时间：2013-03-13T21:09:21.590
> 
> 标签：json, field, edit, jsonassert

我正在编写一个测试代码来比较 json 值。目前，它正在使用 JSONAssert 将我的 json 值与 api 响应进行比较并且工作正常。

但我认为响应 json 可能会更改以支持更多功能。然后 JSONAssert 可能会报告失败，因为存在预期之外的额外字段。

所以我想在使用 JSONAssert 之前制定一个逻辑来删除一些添加的元素。

有什么简单的方法可以从 json 中删除所需的字段吗？

示例）当前：{“field1”：“AAAA”，“field2”：“BBBB”} 下一个：{“field1”：“AAAA”， **“field3”：“CCC”，** “field2”：“BBBB”}

我想在使用它之前从 json 中删除“field3”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:28:17.557

### 首先回答你的问题

我假设您已将 JSON 源字符串解析为 JavaScript 对象结构。因此，您可以执行以下操作：

```
// option 1
delete Next["field3"];

// option 2
delete Next.field3; 
```

在大多数情况下，第一个选项应该更好，因为它允许您动态生成属性名称。

### 另一方面

如果您现在您的 JSON 数据可能包含预期之外的其他值，那么您的测试可能会被更改，或者您需要另一个测试。在单元测试的情况下（我假设你想在这里做）你应该在一个测试中只测试一个特定的东西。对于其他任何事情，您都应该编写额外的测试。

# java - 如何使 Spring SessionAttributes 无效

> ID：15396519
> 
> 赞同：2
> 
> 时间：2013-03-13T21:09:44.210
> 
> 标签：java, spring, session

每个人。我对 Spring SessionAttributes 注释有疑问。现在，我正在使用它在涉及多个页面的工作流中传输数据。数据包含在模式属性中，然后存储在 SessionAttribute 中（在控制器前面带有注释）。所以我有这个问题，如果我使用

```
sessionStatus.setComplete(); 
```

当我离开工作流程时，会话会被清理。但是如果我没有完成就离开工作流程，数据就会卡在会话中。我试过了

```
sessionStatus.setComplete(); 
```

和

```
request.getSession.invalidate(); 
```

并重新初始化模型属性，他们都没有完成工作。当我重新启动工作流时，会话中的数据仍然存在。

知道如何清除数据吗？或者是否有任何解决方法，以便我可以使用会话以外的东西将数据存储在工作流中。

# android - Google 是否允许开发者使用 .txt 文件来存储 Android 应用数据？

> ID：15396520
> 
> 赞同：0
> 
> 时间：2013-03-13T21:09:45.103
> 
> 标签：android, database, storage

我的应用程序需要大量文本。.txt 文件大约 2 MB。Google 是否允许开发人员制作从 txt 文件中提取数据的应用程序？如果不是，那么存储大量信息的替代方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:11:28.200

谷歌允许你做任何你想做的事。是的，一些应用程序从文本文件中读取数据。只需将其放在您的资产目录中，它将捆绑到您的 apk 中。你可以把你想要的任何类型的文件放在那里。

另一种选择是具有本机支持的 ​​SQLite 数据库。

# c - C、获取 unsigned char 使用 ascii 2 表

> ID：15396523
> 
> 赞同：0
> 
> 时间：2013-03-13T21:09:53.993
> 
> 标签：c, arrays, char, ascii

所以我想要的就是让它使用无符号字符数组显示 ascii 2 表。继承人我有什么不工作：

```
unsigned char digits[100];
int i=0;
while (i<=100)
{
printf("\n%c",digits[i]+48);
i++;
} 
```

到目前为止非常简单的代码。虽然根本不工作。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:19:03.187

无需使用数组。这将起作用：

```
int i=0;
while (i<=100){
    printf("\n%c", i + '0');
    i++;
} 
```

此外，您的数组未初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:10:47.563

问题是`digits[i]`没有初始化。

如果您所做的只是显示 ASCII 表，则根本不需要该数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T22:34:28.807

```
#include <stdio.h>

int main(void){
    unsigned char digits[100] = { 1,0,2,4 };
    int i=0;

    while (i<100){
        printf("\n%c",digits[i++]+'0');
    }

    printf("\ninput number:");
    fgets(digits, 100, stdin);

    i=0;
    while(digits[i] && digits[i] != '\n')
        printf("\n%c", digits[i++]);

    return 0;
} 
```

# javascript - 向所有子项添加事件侦听器

> ID：15396525
> 
> 赞同：2
> 
> 时间：2013-03-13T21:10:04.640
> 
> 标签：javascript, html, dynamic

我有一个按钮，单击该按钮会调用一个函数，该函数创建 div 并将它们作为 childeren 添加到另一个充当容器的 div 中。

我在函数结束时尝试了这个：

```
x = document.getElementById("box_area").childNodes;
x[x.length-1].addEventListener("click",alert("test"),false) //to add a listener to the div just created. 
```

单击按钮时，该功能会在单击按钮时触发，而不是在单击 div 时触发。

知道如何为每个动态 div 添加事件侦听器，因为我的不工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:13:24.227

尝试：

```
x[x.length-1].addEventListener("click", function () {
    alert("test");
}, false); 
```

请注意，第二个参数是对匿名函数的引用。之前，您在`alert`执行此行时立即调用，而不是完成您真正想要的。

这是一个示例，基本上使用您提供的内容：http: [//jsfiddle.net/8Q63G/](http://jsfiddle.net/8Q63G/)

还有一个更好的例子，通过共享一个函数：http: [//jsfiddle.net/8Q63G/1/](http://jsfiddle.net/8Q63G/1/)

尽管要支持所有浏览器，但您应该使用以下内容：

```
window.onload = function () {
    x = document.getElementById("box_area").childNodes;
    for (var i = 0; i < x.length; i++) {
        //x[i].addEventListener("click", boxClicker, false);
        addEvent(x[i], "click", boxClicker);
    }
};

function addEvent(element, event_name, func) {
    if (element.addEventListener) {
        element.addEventListener(event_name, func, false); 
    } else if (element.attachEvent)  {
        element.attachEvent("on"+event_name, func);
    }
}

function boxClicker() {
    console.log(this.innerHTML);
} 
```

[http://jsfiddle.net/8Q63G/3/](http://jsfiddle.net/8Q63G/3/)

虽然还有更多选择。您可以将一个事件添加到“box_area”元素，然后检查`event`'s`target`和/或`srcElement`属性以查看它是否是您正在寻找的孩子。此外，您可以在将元素添加到 DOM**之前**附加事件- 这与我的解决方案相同，只是它不需要您访问`.childNodes`并获取最后一项。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-13T21:17:39.263

像这样的东西：http: [//jsfiddle.net/y8yBD/](http://jsfiddle.net/y8yBD/)

```
$('#box_area').on('click', 'div', function (e) {
    alert('test');
});

$('button').click(function () {
    $('#box_area').append('<div class="box"></div>');
}); 
```

# php - 在 Magento 中获取整个类别的库存数量

> ID：15396526
> 
> 赞同：0
> 
> 时间：2013-03-13T21:10:06.167
> 
> 标签：php, magento

我有获取特定产品库存数量的代码，但我希望获取整个类别的总库存数量（仅列出有库存的类别）。

所以而不是

```
$stock = Mage::getModel('cataloginventory/stock_item')->loadByProduct($product); 
```

我想要类似的东西

```
$stock = Mage::getModel('cataloginventory/stock_item')->loadByCategory($category_id); 
```

（这当然不是真的。）

或者任何其他方法只列出那些包含库存商品的类别？

我们在 Magento v1.7.0.2 上。

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T03:36:06.700

检查一个类别的所有产品的库存以确定是否应该显示一个类别将过于占用资源。

我的建议是设置一个 cron 脚本来计算类别计数并填充另一个表或为类别归档的新 EAV。此外，您还应该使用一些观察者来监听事件并在库存更改时更新此计数。

现在在运行时只需检查这个特定的 EAV 字段值并得出需要显示的内容。

# api - Amazon EC2：如何在 AWS 控制台中通过 API 检测重启状态

> ID：15396534
> 
> 赞同：1
> 
> 时间：2013-03-13T21:10:22.377
> 
> 标签：api, amazon-web-services, amazon-ec2, reboot

在 AWS 控制台的 EC2 面板中，当您重新启动实例（通过控制台）时，状态列从“正在运行”变为“正在重新启动”，然后在重新启动完成后又变回“正在运行”。

在 Amazon EC2 API 中，没有“重新启动”这样的状态。唯一可用的选项是“running”、“pending”、“stopped”、“stopping”、“shutting-down”和“terminate”。检查实例状态的 API 在重启时也会返回“status:ok”。

我如何使用 API 知道启动重启的实例已完成并再次正常运行？必须有一些信息可以在重新启动状态期间检查，知道重新启动已启动。

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T00:17:43.540

我认为您从评论中获得的一般要点是，仅仅因为实例已重新启动，并不意味着它以干净的状态启动，以便准备好执行工作。

因此，您确实应该在启动时进行某种健康监视器或健全性检查，以表明您的应用程序实际上正在正常运行（或准备运行）。然后，您可以查询此监视器以确定事情是否按预期运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T15:31:57.007

谢谢大家的建议。我终于“逆向工程”了 AWS 控制台 javascript 代码，他是：

```
> AWS.ioc.Configuration.getInstance("/ec2/instances/rebootInstances#controller").subscribe("changed",
> function() { var o =
> m.dataTable.getRecords(m.dataTable.getSelectedRows());
> m.dataTable.setColumn(o, "instanceState", "rebooting");
> i.rebooting.fire(o); YAHOO.lang.later(60000, m.dataTable, function(p,
> q, r) {
>                  m.dataTable.setColumn(p, q, r);
>                  i.rebooted.fire(p)
>                  }, [o, "instanceState", "running"], false) }); 
```

可以看出，它只是一个60秒（60000毫秒）的超时......

# ruby-on-rails - 在 Rails 中引用新创建的对象

> ID：15396535
> 
> 赞同：0
> 
> 时间：2013-03-13T21:10:23.623
> 
> 标签：ruby-on-rails

我想在创建对象后获取它的 id，如下所示：

```
 post = Post.create_with_data(data)
 post_id = post.id #id of the post object just created in previous line 
```

但是， post_id 是`nil`. 我如何实现我的目标？我不想使用`Post.last`，因为当多个用户同时尝试创建帖子时，它可能会产生数据冲突。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:12:04.587

在你`create_with_data`做你`save`的对象？在`id`它被保存之前它是 nil 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T21:32:48.073

Rails 函数返回最后评估的语句。如果要编写自己的`create_with_data`模型方法，则需要返回实际对象。`object.save`返回其中一个`true`or `false`，但不返回对象本身。

为了返回对象（并因此以指定的方式访问其 id），只需将对象本身表示为函数的最后一条语句，当您调用该方法时它将自动返回。

```
class Post < ActiveRecord::Base

  def self.create_with_data(data)
    photo = self.new(data)
    photo.save
    photo # returns the photo object
  end

end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T21:15:24.157

```
class Post < ActiveRecord::Base
  ...
  def data=(data)
    # ... use data here
  end
end

Post.create(data: data) 
```

它更干净，它会为你调用 save ！您的错误是因为 create_with_data 没有持久化对象（不保存，保存时验证失败等）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-13T21:14:02.817

尝试这个：

```
post = Post.create!({attribute: 'value'})
post_id = post.id 
```

我不确定该方法的`create_with_data`作用，但它似乎无法保存您的帖子。

# jquery - Ajax 通过链接加载不同的内容

> ID：15396536
> 
> 赞同：1
> 
> 时间：2013-03-13T21:10:24.163
> 
> 标签：jquery, ajax, addclass

我正在尝试做什么，当我单击一个选项卡时，地址栏 url 也应该更改为该操作，而且它还应该将类添加到锚标记。

这是 jsfiddle 中非常好的例子，我看到有人在 stackoverflow 上分享。 [http://jsfiddle.net/VcQKr/2/](http://jsfiddle.net/VcQKr/2/)

但这里的问题是它可以为 li 标签添加和删除类，但是当我从

```
$parent.addClass("selected").siblings().removeClass("selected"); 
```

至

```
$t.addClass("selected").siblings().removeClass("selected"); 
```

然后它只将类添加到锚标记，但不会从中删除类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:14:55.453

那是因为`a`元素不是标记中的兄弟姐妹，您应该选择父级的兄弟姐妹并从其`a`后代元素中删除该类。

```
$(this).addClass("selected")
       .parent()
       .siblings()
       .find('a')
       .removeClass("selected"); 
```

[http://jsfiddle.net/FvxrL/](http://jsfiddle.net/FvxrL/)

# ruby-on-rails-3 - Rails - 如何捕获传递给表单的属性？

> ID：15396540
> 
> 赞同：0
> 
> 时间：2013-03-13T21:10:31.503
> 
> 标签：ruby-on-rails-3

我正在将一个`rfid`值传递给一个表单以创建一个新`device`对象。如何使用该值来查看现有列表，`rfid`以便用户可以从中选择一个`options_from_collection_for_select`？

这是传递值的代码：

```
<%= link_to "Create New Device (non-functional)", new_device_path({:rfids[0] => @rfid_id, cabinet_id: @cabinet.id}), :class => "btn btn-primary" %> 
```

以下是我开始编写表单中的代码：

```
<th>RFID</th>
            <td><%= f.text_field :rfids, options_from_collection_for_select(Rfid.all, "id", ) %></td> 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T15:27:58.300

看起来好像您正在将一个值作为参数传递给`new_device_path`，并且您希望使用该值来构造该操作呈现的表单。

为了做到这一点，您需要向您的操作方法添加一些代码（`DevicesController#new`如果您使用的是 Rails 默认设置，则为 。否则，无论操作`new_device_path`指向什么）。它可能会使用这种通用形式：

```
def new
  @passed_value = params[:param_name]
end 
```

所有这一切都是将传递的值存储在实例变量中，但这意味着您将能够以操作呈现的形式引用它：

```
options_from_collection_for_select(Rfid.all, :id, :id, @passed_value) 
```

# java - Java，当使用 GridBagLayout 布局面板时，向面板添加按钮会改变大小，我该如何防止这种情况？

> ID：15396542
> 
> 赞同：1
> 
> 时间：2013-03-13T21:10:40.353
> 
> 标签：java, swing, layout, jpanel, gridbaglayout

好的，所以我正在搞乱 GridBagLayout 来掌握它。我想用它在 JFrame 中布局 JPanel，但这些单独的面板将使用不同的布局管理器，GridBagLayout 可能不适合。

但我有一个问题。如果我不向面板添加任何内容，则所有比例都可以完美地发挥作用，如下例所示：

```
public class RealMess extends JFrame{

private JPanel panel;

public RealMess(){
    initUI();
}

public final void initUI(){

    Dimension screensize = Toolkit.getDefaultToolkit().getScreenSize();
    int width = (int) screensize.getWidth();
    int height = (int) screensize.getHeight();

    panel = new JPanel();
    panel.setLayout(new GridBagLayout());

    JPanel left = new JPanel();
    left.setBackground(Color.GREEN);

    JPanel centre = new JPanel();
    centre.setBackground(Color.PINK);

    JPanel right = new JPanel();
    right.setBackground(Color.CYAN);

    JPanel leftBottom = new JPanel();
    leftBottom.setBackground(Color.LIGHT_GRAY);
    leftBottom.setLayout(new FlowLayout(0));

    JPanel bottom = new JPanel();
    bottom.setBackground(Color.MAGENTA);

    GridBagConstraints gbc = new GridBagConstraints();

    gbc.weightx = 0.11;
    gbc.weighty = 0.9;
    gbc.gridwidth = 1;
    gbc.gridheight = 1;
    gbc.anchor = GridBagConstraints.FIRST_LINE_START;
    gbc.gridx = 0;
    gbc.gridy = 0;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(left, gbc);

    gbc.weightx = 0.11;
    gbc.weighty = 0.1;
    gbc.anchor = GridBagConstraints.LAST_LINE_START;
    gbc.gridx = 0;
    gbc.gridy = 1;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(leftBottom, gbc);

    gbc.weightx = 0.78;
    gbc.weighty = 0.9;
    gbc.anchor = GridBagConstraints.PAGE_START;
    gbc.gridx = 1;
    gbc.gridy = 0;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(centre, gbc);

    gbc.weightx = 0.78;
    gbc.weighty = 0.1;
    gbc.anchor = GridBagConstraints.PAGE_END;
    gbc.gridx = 1;
    gbc.gridy = 1;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(bottom, gbc);

    gbc.weightx = 0.11;
    gbc.weighty = 1;
    gbc.anchor = GridBagConstraints.FIRST_LINE_END;
    gbc.gridx = 2;
    gbc.gridy = 0;
    gbc.gridheight = 2;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(right, gbc);

    add(panel);

    setTitle("Jack");
    setLocationRelativeTo(null);
    setDefaultCloseOperation(EXIT_ON_CLOSE);
    setExtendedState(MAXIMIZED_BOTH);
}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable(){
        public void run(){
            RealMess rm = new RealMess();
            rm.setVisible(true);
        }
    });

}

} 
```

我知道我不必要地重新定义了一些 GridBagConstraints，但我不想错过任何东西。

无论如何，当我向任何面板添加按钮时，我的问题就出现了。像这样：

```
public class RealMess extends JFrame{

private JPanel panel;

public RealMess(){
    initUI();
}

public final void initUI(){

    Dimension screensize = Toolkit.getDefaultToolkit().getScreenSize();
    int width = (int) screensize.getWidth();
    int height = (int) screensize.getHeight();

    panel = new JPanel();
    panel.setLayout(new GridBagLayout());

    JPanel left = new JPanel();
    left.setBackground(Color.GREEN);

    JPanel centre = new JPanel();
    centre.setBackground(Color.PINK);

    JPanel right = new JPanel();
    right.setBackground(Color.CYAN);

    JPanel leftBottom = new JPanel();
    leftBottom.setBackground(Color.LIGHT_GRAY);
    leftBottom.setLayout(new FlowLayout(0));

    JButton rewind = new JButton("1");      
    rewind.setPreferredSize(new Dimension(50, 25));

    leftBottom.add(rewind);

    JPanel bottom = new JPanel();
    bottom.setBackground(Color.MAGENTA);

    GridBagConstraints gbc = new GridBagConstraints();

    gbc.weightx = 0.11;
    gbc.weighty = 0.9;
    gbc.gridwidth = 1;
    gbc.gridheight = 1;
    gbc.anchor = GridBagConstraints.FIRST_LINE_START;
    gbc.gridx = 0;
    gbc.gridy = 0;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(left, gbc);

    gbc.weightx = 0.11;
    gbc.weighty = 0.1;
    gbc.anchor = GridBagConstraints.LAST_LINE_START;
    gbc.gridx = 0;
    gbc.gridy = 1;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(leftBottom, gbc);

    gbc.weightx = 0.78;
    gbc.weighty = 0.9;
    gbc.anchor = GridBagConstraints.PAGE_START;
    gbc.gridx = 1;
    gbc.gridy = 0;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(centre, gbc);

    gbc.weightx = 0.78;
    gbc.weighty = 0.1;
    gbc.anchor = GridBagConstraints.PAGE_END;
    gbc.gridx = 1;
    gbc.gridy = 1;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(bottom, gbc);

    gbc.weightx = 0.11;
    gbc.weighty = 1;
    gbc.anchor = GridBagConstraints.FIRST_LINE_END;
    gbc.gridx = 2;
    gbc.gridy = 0;
    gbc.gridheight = 2;
    gbc.fill = GridBagConstraints.BOTH;

    panel.add(right, gbc);

    add(panel);

    setTitle("Jack");
    setLocationRelativeTo(null);
    setDefaultCloseOperation(EXIT_ON_CLOSE);
    setExtendedState(MAXIMIZED_BOTH);
}

public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable(){
        public void run(){
            RealMess rm = new RealMess();
            rm.setVisible(true);
        }
    });

}

} 
```

bottomLeft 面板变得更大，因此与之相关的网格方块的大小也随之增大。

在第一个示例中，所有内容都占用了窗口宽度或高度的百分比，由以下内容决定：

```
gbc.weightx 
```

和

```
gbc.weighty 
```

这样做可以很容易地使所有东西都具有正确的尺寸。

是否有一种解决方法可以让我强制面板尺寸仅受权重值的影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:18:36.237

weightx 和 weighty 显示底层组件未请求的空间的比例分配。例如，如果您有一个标签和一个水平方向的文本字段，您可能希望标签根据列中最大的标签占用固定的间距，并将剩余的空间转到文本字段。将所有 weightx 分配给文本字段，这正是发生的事情。标签的 weightx 为零，但不会被压缩为零大小，因为只有多余的空间由重量决定。空面板的最小尺寸为零，因此所有空间都被认为是额外的。

如果您想强制布局按照您的描述工作，您需要扩展 JPanel 以使子面板向 GridBagLayout 谎报其内容。如果您开始制作小于最小值的东西，这可能会给您带来麻烦。

# mysql - MySQL 存在值之间的第一个空闲数

> ID：15396545
> 
> 赞同：1
> 
> 时间：2013-03-13T21:10:47.500
> 
> 标签：mysql, sql

问题：在存在值之间为服务器获取第一个空闲端口。如果没有空位，则取最高的+1。

额外：如果 server_deleted=1 那么我们可以使用空闲端口。当价值观之间存在差距时，我们也应该选择自由港。我们应该在 where 子句中包含 server_type。最小值是第一个端口，例如 9000。

现在我的查询看起来：

```
SELECT server_port + 1
  FROM pro_servers s
 WHERE s.server_port <> 0
   AND s.server_type = 'ts3'
   AND s.server_deleted = 0
   AND NOT EXISTS
        ( SELECT s1.server_port
            FROM pro_servers s1
           WHERE s1.server_port <> 0
             AND s1.server_type = 'ts3'
             AND s1.server_port = s.server_port + 1
             AND s1.server_deleted = 0
        )
 ORDER BY server_port LIMIT 1 
```

我认为有更好的方法来做到这一点。这个查询执行很慢。

例如first=minimum=lowest = 9000，接下来是9002，9003。我们需要得到9001。如果我们添加9001，则得到9004。第一个值9000存在于表中。

样本数据

```
+-----------+-------------+----------------+-------------+
| server_id | server_port | server_deleted | server_type |
+-----------+-------------+----------------+-------------+
|       151 |        9500 |              1 | teamspeak3  |
|      8459 |        9500 |              0 | teamspeak3  |
|       183 |        9501 |              1 | teamspeak3  |
|       264 |        9502 |              1 | teamspeak3  |
|      4155 |        9502 |              1 | teamspeak3  |
|      2707 |        9503 |              1 | teamspeak3  |
|      4160 |        9503 |              1 | teamspeak3  |
|       154 |        9504 |              1 | teamspeak3  |
|      4163 |        9504 |              1 | teamspeak3  |
|       285 |        9506 |              1 | teamspeak3  |
|      4167 |        9506 |              1 | teamspeak3  |
|      8454 |        9506 |              0 | teamspeak3  |
|       241 |        9507 |              1 | teamspeak3  |
|      4169 |        9507 |              1 | teamspeak3  |
|       188 |        9509 |              1 | teamspeak3  |
|      4177 |        9509 |              1 | teamspeak3  |
+-----------+-------------+----------------+-------------+ 
```

查询结果：9501。当我们使用此端口时，接下来：9502、9503、9504、9505、9507、9508、9509、9510 等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:30:45.947

```
SELECT data.sPort
FROM 
  ((SELECT (s.server_port + 1) sPort
  FROM pro_servers s
  LEFT JOIN pro_servers sp1 ON sp1.server_port = s.server_port + 1
  WHERE (sp1.server_port IS NULL)
  ORDER BY sPort)

  UNION ALL

  (SELECT s.server_port sPost
  FROM pro_servers s
   GROUP BY s.server_port
   HAVING COUNT(s.server_port) = SUM(s.server_deleted)
  ORDER BY sPort)) AS data
ORDER BY data.sPort
LIMIT 1 
```

SqlFiddle：[http ://sqlfiddle.com/#!2/12ab1/2](http://sqlfiddle.com/#!2/12ab1/2)

***这个怎么运作***

1.  Left Join `pro_servers`with `pro_servers`with `server_port = server_port + 1`join 条件并取行，`null`在下*一个*端口中存在。这些行显示每个间隙的第一个端口。端口 ID 可以作为`server_port + 1`.

2.  获取所有已删除的端口。

3.  联合 1\. 和 2.，按顺序`server_port`取第一个。

答案有一个假设 - 始终采用最低编号的端口。如果不是这样，请单独检查该端口（或将另一个添加`UNION ALL`到查询中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:45:35.007

此外，您可以尝试索引表。

CREATE INDEX indexName ON tableName(field1 [,field2...]);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:47:01.993

我会使用这个查询，它使用`NOT EXISTS`：

```
SELECT MIN(server_port)+1
FROM pro_servers p1
WHERE
  p1.server_type = 'ts3' AND
  NOT EXISTS (SELECT server_port
              FROM   pro_servers p2
              WHERE  p1.server_port=p2.server_port-1
                     AND p1.server_type=p2.server_type
                     AND p2.server_deleted=0) 
```

或者这个使用`LEFT JOIN`：

```
SELECT MIN(p1.server_port)+1
FROM
  pro_servers p1 LEFT JOIN pro_servers p2
  ON p1.server_port=p2.server_port-1
     AND p1.server_type=p2.server_type
     AND p2.server_deleted=0
WHERE
  p2.server_port IS NULL
  AND p1.server_type='ts3' 
```

请[在此处](http://sqlfiddle.com/#!2/ff9b6/1)查看小提琴。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T21:53:10.613

我不知道这是否会更快，但它肯定会帮助您避免重复相同的条件两次：

```
SELECT
  MAX(server_port) + 1 AS first_available_port
FROM (
  SELECT
    server_port,
    @row := @row + 1 AS row
  FROM
    pro_servers AS s,
    (SELECT @row := 0) AS x
  WHERE server_port <> 0
    AND server_type = 'ts3'
    AND server_deleted = 0
) AS s
GROUP BY
  server_port - row
ORDER BY
  server_port - row
LIMIT 1
; 
```

内部查询枚举匹配条件的现有端口。现在，对于属于同一组连续行的行，端口号和行号之间的差异将保持不变。外部查询按该差异分组并返回第一组的最高端口加一。

# javascript - AngularJS 中指令和静态 DOM 元素的区别

> ID：15396546
> 
> 赞同：0
> 
> 时间：2013-03-13T21:10:53.690
> 
> 标签：javascript, frameworks, angularjs

我已经阅读了 AngularJS Doc 上的[编译过程和指令匹配。](http://docs.angularjs.org/guide/directive)

但我真的不明白这些指令。

例子：

我有静态html：

```
<div class="test test2" cid="549" sid="a5e3c4f8a9">text-text-text</div> 
```

当我手动执行此操作时，我知道它只会在浏览器解析时创建和调用一次。

但是当我创建一个具有相同 dom 元素的指令时会发生什么？

```
<x my-directive>text-text-text</x> 
```

这是一样的效果吗？

我在问这样一个新手问题，因为我在我的 html 页面上使用了 200 多个元素。如果我将它们更改为单个指令：肯定会更容易管理它们。

如果它只是在浏览器的编译时很慢，但在运行时发生了什么，这没问题？

我很抱歉，如果 qustion 不够专业。我只是 Stackoverflow 的新手。

谢谢你

丹尼尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T22:05:25.333

如果我理解正确，您想知道 AngularJS 如何创建指令以及调用指令方法的次数。

当您创建一个指令（使用`module.directive('myDirective', ...)`）时，您实际上只是在创建一个定义。每次*使用*该指令（如`<div my-directive>`）时，AngularJS 都会运行指南中描述的过程：也就是说，它将编译和链接每次使用。必须这样，因为指令不是孤立存在的；它不仅存在`$scope`于它被调用的地方，而且它还可以利用元素属性和嵌入的内容。定义发生一次，但每个实例都被编译和链接。

一旦创建了指令，它在技术上就完成了；如果您不设置任何`$watch`或`$observe`或事件绑定，那么您的“指令”现在就是函数末尾 DOM 中`link`的任何内容 - 不再需要计算。换句话说，编译和链接之后会发生什么完全取决于您。

回到您的示例：如果您在页面上使用 200 个相同的指令，该指令将被定义一次，但所有 200 个将单独编译和链接。但我不确定你问的意思是什么。你的问题*背后*的问题是什么？

# json - 将具有不同模式的 json 加载到 PIG 中

> ID：15396550
> 
> 赞同：6
> 
> 时间：2013-03-13T21:11:12.507
> 
> 标签：json, schema, apache-pig

我在将一组 json 文档加载到 PIG 时遇到了问题。我所拥有的是很多 json 文档，它们所拥有的字段都各不相同，我需要的字段在大多数文档中，而在缺少的情况下，我想获得一个空值。

我刚刚下载并编译了最新的 Pig 版本（直接来自 apache git 存储库的 0.12），以确保尚未解决此问题。

我拥有的是这样的 json 文档：

```
{"foo":1,"bar":2,"baz":3} 
```

当我使用这个将它加载到 PIG 中时

```
Json1 = LOAD 'test.json' USING JsonLoader('foo:int,bar:int,baz:int');
DESCRIBE Json1;
DUMP Json1; 
```

我得到了预期的结果

```
Json1: {foo: int,bar: int,baz: int}
(1,2,3) 
```

但是，当字段在架构中的顺序不同时：

```
Json2 = LOAD 'test.json' USING JsonLoader('baz:int,bar:int,foo:int');
DESCRIBE Json2;
DUMP Json2; 
```

我得到了一个不想要的结果：

```
Json2: {baz: int,bar: int,foo: int}
(1,2,3) 
```

那应该是

```
(3,2,1) 
```

显然，模式定义中的字段名称与 json 中的字段名称无关。

我需要的是从 json 文件（带有嵌入的文档！）加载特定字段到 PIG 中。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T21:55:44.927

我认为即使是最新版本的 Pig 也是一个已知问题，因此除了使用功能更强大的 JsonLoader 之外，没有简单的方法可以解决这个问题。

使用[Elephant Bird JSONLoader](https://github.com/kevinweil/elephant-bird)代替它会按照您期望的方式运行 - 换句话说，尊重字段排序。

# r - R - 分别在 3d 中绘制两个二元法线及其轮廓

> ID：15396551
> 
> 赞同：7
> 
> 时间：2013-03-13T21:11:13.847
> 
> 标签：r, plot, normal-distribution

我一直在玩 MASS 包，可以简单地使用 image 和 par(new=TRUE) 绘制两个二元法线，例如：

```
# lets first simulate a bivariate normal sample
library(MASS)
bivn <- mvrnorm(1000, mu = c(0, 0), Sigma = matrix(c(1, .5, .5, 1), 2))
bivn2 <- mvrnorm(1000, mu = c(0, 0), Sigma = matrix(c(1.5, 1.5, 1.5, 1.5), 2))

# now we do a kernel density estimate
bivn.kde <- kde2d(bivn[,1], bivn[,2], n = 50)
bivn.kde2 <- kde2d(bivn2[,1], bivn[,2], n = 50)

# fancy perspective
persp(bivn.kde, phi = 45, theta = 30, shade = .1, border = NA)
par(new=TRUE)
persp(bivn.kde2, phi = 45, theta = 30, shade = .1, border = NA) 
```

这看起来不太好，我想我只能玩转轴之类的东西。但是，如果我尝试对等高线采用类似的方法，则图不会重叠。它们被简单地替换：

```
# fancy contour with image
image(bivn.kde); contour(bivn.kde, add = T)
par(new=TRUE)
image(bivn.kde2); contour(bivn.kde, add = T) 
```

这是实现我想要的最好的方法，还是我只是让自己难过？欢迎任何建议。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-14T02:08:08.497

也许你可以使用`rgl`图书馆。它允许您创建交互式 3d 绘图。

```
require(rgl)

col1 <- rainbow(length(bivn.kde$z))[rank(bivn.kde$z)]
col2 <- heat.colors(length(bivn.kde2$z))[rank(bivn.kde2$z)]
persp3d(x=bivn.kde, col = col1)
with(bivn.kde2, surface3d(x,y,z, color = col2)) 
```

![在此处输入图像描述](../Images/34883e447eeca0b4f7d94d0a99af48f2.png)

如果要绘制两个曲面之间的差异，则可以执行以下操作。

```
res <- list(x = bivn.kde$x, y = bivn.kde$y, z = bivn.kde$z - bivn.kde2$z)
col3 <- heat.colors(length(res$z))[rank(res$z)]
persp3d(res, col = col3) 
```

![在此处输入图像描述](../Images/898e4f482aa293d934352f989374ce57.png)

# objective-c - 从 std::string 转换为 NSString

> ID：15396557
> 
> 赞同：2
> 
> 时间：2013-03-13T21:11:50.437
> 
> 标签：objective-c, objective-c++

在这种情况下，如何从 std::string 转换为 NSString？

```
void Piles::imagePlacer(Card card, int xCoord, int yCoord) {
    string cardType = card.toString();

    UIImageView *cardImg = [[UIImageView alloc]
                 initWithImage:cardType];
    cardImg.frame = CGRectMake(xCoord, yCoord, 126, 190);
    [self.view addSubview:cardImg];
} 
```

我想使用一个字符串作为图像的名称（假设我在某处有一个 UIImages 列表，其名称对应于存储在 cardType 中的所有可能的字符串）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-14T02:56:28.810

只需通过一个 C 字符串：

`[NSString stringWithUTF8String:cardType.c_str()]`

或使用新语法：

`@(cardType.c_str())`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-13T07:01:59.940

这是一个例子：

```
string str_simple = "HELLO WORLD";

//string to NSString

NSString *stringinObjC = [NSString stringWithCString:str_simple.c_str()
                            encoding:[NSString defaultCStringEncoding]];

NSLog(stringinObjC); 
```

# validation - ValidationException on Update：在 AbstractPersistenceEventListener 上刷新实体时出现验证错误

> ID：15396560
> 
> 赞同：5
> 
> 时间：2013-03-13T21:11:59.943
> 
> 标签：validation, grails, grails-orm, failonerror

在我的环境中，我在 Config.groovy 上有 grails.gorm.failOnError = true。

```
package org.example

class Book {

    String title
    String author
    String email

    static constraints = {
        title nullable: false, blank: false
        email nullable: false, blank: false, unique: true //apparently this is the problem..
    }
} 
```

而且，在控制器上，我有：

```
package org.example

class BookController {

def update() {

        def bookInstance = Book.get(params.id)
        if (!bookInstance) {
            flash.message = message(code: 'default.not.found.message', args: [message(code: 'book.label', default: 'Book'), params.id])
            redirect(action: "list")
            return
        }

        if (params.version) {
            def version = params.version.toLong()
            if (bookInstance.version > version) {
                bookInstance.errors.rejectValue("version", "default.optimistic.locking.failure",
                          [message(code: 'book.label', default: 'Book')] as Object[],
                          "Another user has updated this Book while you were editing")
                render(view: "edit", model: [bookInstance: bookInstance])
                return
            }
        }

        bookInstance.properties = params

        bookInstance.validate()

        if(bookInstance.hasErrors()) {

            render(view: "edit", model: [bookInstance: bookInstance])

        } else {

            bookInstance.save(flush: true)
            flash.message = message(code: 'default.updated.message', args: [message(code: 'book.label', default: 'Book'), bookInstance.id])
            redirect(action: "show", id: bookInstance.id)
        }      
    }
} 
```

要保存，没关系。但是，在不设置**标题字段**的情况下更新时，我得到：

```
Message: Validation error whilst flushing entity [org.example.Book]:
- Field error in object 'org.example.Book' on field 'title': rejected value []; codes [org.example.Book.title.blank.error.org.example.Book.title,org.example.Book.title.blank.error.title,org.example.Book.title.blank.error.java.lang.String,org.example.Book.title.blank.error,book.title.blank.error.org.example.Book.title,book.title.blank.error.title,book.title.blank.error.java.lang.String,book.title.blank.error,org.example.Book.title.blank.org.example.Book.title,org.example.Book.title.blank.title,org.example.Book.title.blank.java.lang.String,org.example.Book.title.blank,book.title.blank.org.example.Book.title,book.title.blank.title,book.title.blank.java.lang.String,book.title.blank,blank.org.example.Book.title,blank.title,blank.java.lang.String,blank]; arguments [title,class org.example.Book]; default message [Property [{0}] of class [{1}] cannot be blank]

   Line | Method
->>  46 | onApplicationEvent in org.grails.datastore.mapping.engine.event.AbstractPersistenceEventListener
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|   895 | runTask            in java.util.concurrent.ThreadPoolExecutor$Worker
|   918 | run . . . . . . .  in     ''
^   680 | run                in java.lang.Thread 
```

在 q 我明白了，当刷新休眠会话时会出现问题，休眠尝试再次保存对象然后抛出异常......

当再次尝试保存对象时，再次调用 book.validate()，在数据库中进行新的查询，以确保 email 字段的唯一性。现在，抛出了验证异常。

但是，当我删除电子邮件属性的唯一验证时，更新正常执行..

我的问题是：这种行为是否正确？Hibernate 会自动调用 book.save 吗？

这是样例工程，模拟报错的步骤是：

*   来源：[https ://github.com/roalcantara/grails_app_validation_exception](https://github.com/roalcantara/grails_app_validation_exception)
*   grails 运行应用程序
*   导航到 http://localhost:8080/book/book/create
*   创建一个填充所有字段的新实例..
*   然后编辑这个实例，在：http://localhost:8080/book/book/edit/1
*   最后，删除“标题”字段并单击更新，然后抛出异常..

在我的环境中，这种行为发生在 grails 版本 2.0.3 和 2.2.1

谢谢你的帮助！对不起，我可怜的（和羞耻的）英语.. rs..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T01:44:13.063

您实际上是在验证两次，首先是：

```
bookInstance.validate() 
```

第二个是：

```
bookInstance.save(flush: true) 
```

当你调用`bookInstance.save(flush: true)`a时`boolean`返回。Grails 在生成控制器时默认利用这一点，但您似乎出于某种原因更改了默认生成的控制器 Grails。

只需替换这个：

```
 bookInstance.validate()

    if(bookInstance.hasErrors()) {

        render(view: "edit", model: [bookInstance: bookInstance])

    } else {

        bookInstance.save(flush: true)
        flash.message = message(code: 'default.updated.message', args: [message(code: 'book.label', default: 'Book'), bookInstance.id])
        redirect(action: "show", id: bookInstance.id)
    } 
```

有了这个：

```
 if( !bookInstance.save( flush: true ) ) {
        render(view: "edit", model: [bookInstance: bookInstance])
        return
    } 
```

# jquery - jquery 1.8.3 和 onclick 事件

> ID：15396561
> 
> 赞同：0
> 
> 时间：2013-03-13T21:12:02.740
> 
> 标签：jquery, onclick, checkbox

我正在使用 jquery 来检查和取消选中项目，以便将操作与它们相关联。非常常见的任务......下面的功能非常适合。使用 ajax load() 刷新列表后出现问题，在这种情况下，onclick 事件不再响应：

1）jQuery函数

```
$('#checkItemsAll').change(function() { 
        var cb = $("#filesSection").find(':checkbox');
        if(this.checked) {
            cb.attr('checked', true); 
            cb.each(function(o){
                var chkID = $(this).val();
                $("#"+chkID).addClass('alert alert-info');
              });
        }else{ 
            cb.attr('checked', false);
            cb.each(function(o){
                var chkID = $(this).val();
                $("#"+chkID).removeClass('alert alert-info');
              });
        }
    });

    $('input:checkbox').click(function(){
        if(this.checked) {
          $('#'+this.value).addClass('alert alert-info');
        }
      else {
          $('#'+this.value).removeClass('alert alert-info');
      }
    }); 
```

2）加载函数调用，已刷新列表但复选框单击事件在新列表上没有响应（顺便说一下，js中的js仍然附加到新列表）

```
$("#filesSection").load(node.data.url+'?folderId='+node.data.key); 
```

你以前遇到过吗？我现在正在研究的一个解决方案是在复选框输入上添加一个 onclick 事件，但我想有一种方法可以管理 onclick。

干杯

二

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:18:32.720

就像凯文 B 说的。例如：

```
$(document).on('click', 'input:checkbox', function(){
...
}); 
```

# javascript - 从日期选择器中恢复价值

> ID：15396564
> 
> 赞同：0
> 
> 时间：2013-03-13T21:12:05.093
> 
> 标签：javascript, jquery, date, datepicker

我试图在 onSelect 事件上使用来返回一个变量。第一部分是我正在输入一个已经在输入中的`$("#firstAvailable")`日期并进行一些日期格式化。然后，如果日期选择器中的日期发生变化，则重新应用这些日期更改。这不起作用，因为我的`console.log`ajax 上有一个，它只是显示了加载页面的原始日期。我认为返回 firstDate 会重置 var，显然不是。这是我的代码。想法？

编辑：这是我的[jsfiddle](http://jsfiddle.net/stasis/JW8bZ/)。

```
var date = $("#firstAvailable").val();
var firstDate = new Date(date);
var currYear = firstDate.getFullYear();
var currMonth = firstDate.getMonth();
currMonth++;
var currDate = firstDate.getDate();
var firstDate = currYear + '-' + currMonth + '-' + currDate;

$("#firstAvailable").datepicker({
    onSelect: function(dateText, uiInstance) {
            var date = $(this).val();
            var firstDate = new Date(date);
            var currYear = firstDate.getFullYear();
            var currMonth = firstDate.getMonth();
            currMonth++;
            var currDate = firstDate.getDate();
            var firstDate = currYear + '-' + currMonth + '-' + currDate;
            return firstDate;
        }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:55:41.963

尝试在代码中的某处定义 secondDate 变量。我不确定您希望哪个日期成为今天的日期，以及您希望哪个日期成为用户选择的日期，但您反复为 firstDate 赋值。

您还可以使用：

```
$("#firstAvailable").value = firstDate; // or secondDate 
```

为了改变输入的值。在您创建的 onSelect 函数内部，您可以简单地编写：

```
this.value = firstDate; // or secondDate 
```

# css - CSS - 具有 16:9 的图像填充主体，但保持 4:3 的比例

> ID：15396565
> 
> 赞同：0
> 
> 时间：2013-03-13T21:12:05.560
> 
> 标签：css

我希望图像填充 100% 的页面宽度和高度。

我发现了一些 CSS，不记得现在在哪里执行此任务 - 但是我的图像是 16:9，当在 4:3 显示器上查看时，图像会被压扁以适应更窄的宽度。

因此，在 16:9 上，图像将整齐地贴合，而在其他分辨率（或浏览器尺寸）下，图像将被集中并裁剪，因此会丢失边缘。

从 Fiddle 可以看出，测试图像中的白色正方形不是正方形。

小提琴：http: [//jsfiddle.net/7h6yt/](http://jsfiddle.net/7h6yt/)

还有 CSS/HTML。

```
<img src=http://i47.tinypic.com/izyqyv.jpg>

        body{
            margin: 0;
        }

        img{
            min-height: 100%;
            min-width: 1024px;
            width: 100%;
            height: auto;
            position: fixed;
            top: 0;
            left: 0;
        }

        @media screen and (max-width: 1024px){
            img{
                left: 50%;
                margin-left: -512px;
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:32:47.790

尝试使用

```
background-size: cover; 
```

属性，像这样？

[http://jsfiddle.net/7h6yt/1/](http://jsfiddle.net/7h6yt/1/)

# sml - 我得到了数据类型，但是在 sml 中定义类型有什么意义呢？

> ID：15396567
> 
> 赞同：3
> 
> 时间：2013-03-13T21:12:09.713
> 
> 标签：sml

似乎在 SML 中定义类型并没有帮助：

```
type point = int * int
val origin : point = (0, 0) 
```

但我可以很容易地只使用`int * int`打字方法，不是吗？与数据类型相比，您似乎可以用它做更多有趣的事情，例如：

```
datatype Point = PlanePoint of (int * int) | SpacePoint of (int * int * int)
val origin : Point = SpacePoint(0, 0, 0) 
```

出于好奇，在哪些情况下您真的需要`type`定义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:58:26.570

原因主要是类型安全。我将尝试用一个简单的例子来解释。

假设您有一个使用 2 种类型的模块，`real * real` 例如，您的示例中的 2d 点，以及由斜率和 ay 截距表示的线。现在，如果您正在编写一个函数，例如`lies_on_line`它需要一个点和一条线并返回一个布尔值是否该点位于该线上，您有 2 个签名选择：

```
val lies_on_line : (int * int) * (int * int) -> bool 
```

奥德

```
val lies_on_line : point * line -> bool 
```

很明显，第二个例子更难出错。

此外，虽然它对模块更有好处，但命名类型允许您更改其表示，而无需更改使用该类型的代码（间接通过模块）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-14T18:20:35.280

在问题域的上下文中为您的类型定义别名是有意义的。这样你就可以在你的设计中考虑更相关和更有意义的类型。

例如，如果您正在编写文字处理器程序，那么您的类型如下：

```
type Word = string
type Sentence = Word list 
```

这可能比字符串和字符串列表更有意义。

# java - 关于使用 JavaFX 或 CSS 实现效果的效率

> ID：15396568
> 
> 赞同：2
> 
> 时间：2013-03-13T21:12:11.190
> 
> 标签：java, css, performance, javafx-2, fxml

我正在开发一个关于 JavaFX 的个人项目（这是一个游戏），我有一个问题想采纳你的建议。如您所知，JavaFX 可以解析 .fxml 文件中的数据。因此，我的主地图（从 .jpeg 文件转换为 .svg 文件）是从 fxml 文件构建的，每个国家/地区都转换为具有相同属性的 SVGPath，`Node`因此`Shape`我必须为每个国家/地区使用 MouseListener 插入一些效果. 此外，有两种方法可以实现这些效果，它们是

*   我可以使用 FXML-CSS （就像`hover`每个国家的属性（换句话说，每个`Node`or `Shape`）
*   我可以使用 MouseListeners 在 JavaFX 中实现效果，而不是使用 CSS。

我的问题是哪一个更有效和可靠。或者如果我同时使用它们会不会有同步问题？

我希望我的问题很清楚，我会感谢每一个答案。不管怎么说，还是要谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:47:56.980

虽然使用 css 或使用等效的 java 代码 api 之间会有性能差异，但对于您概述的情况（实现鼠标侦听器与悬停 css 伪类），性能差异将无关紧要。

您确实提到了效果，但并没有真正说明您正在使用什么效果。JavaFX 2 仅通过 css（阴影和内阴影）具有有限的效果能力，因此对于该版本，无论如何您都需要在代码中应用大多数效果。无论如何，在代码中应用效果与在 css 中应用效果之间不应该有任何真正的性能差异。

您可以在效果使用方面获得的主要性能提升是通过适当地设置 JavaFX 节点[缓存](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#cacheProperty)和[cacheHint](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#cacheHintProperty)属性，以便 JavaFX 系统预先计算效果并缓存其结果，而不是在场景动画时一直重新计算它。在 JavaFX 2.2 中，`cache`和`cacheHint`属性的设置只能从代码（或在您的 fxml 标记中）完成，而不能从 css 完成。

* * *

对于一些一般背景信息，以下相关问题可能有用：

*   [在 JavaFX 中，我应该使用 CSS 还是 setter 方法来更改 UI 节点上的属性？](https://stackoverflow.com/a/14759323/1155209).
*   [JavaFX 2 绘图性能](https://stackoverflow.com/questions/10506637/javafx-2-drawing-performance)
*   [在 Java 中显示数百万张图像的最佳方式是什么？](https://stackoverflow.com/questions/14467719/what-could-be-the-best-way-to-view-millions-of-images-with-java)

# c - 奇怪的类型转换错误

> ID：15396570
> 
> 赞同：1
> 
> 时间：2013-03-13T21:12:23.170
> 
> 标签：c, serialization, casting

所以，我有这个功能，但我遇到了一些我无法弄清楚的非常奇怪的错误。

```
void serialize_helper(huff *h, bits *history, char** a)
{
  switch (h->tag) {
  case LEAF:
    char letter = h->h.leaf.c;
    int arraynum = (int)letter;
    a[arraynum] = bits_show(history);
    putchar('\n');
    return;
  case NODE:
    /* traverse left subtree */
    bits_putlast('0',history);
    serialize_helper(h->h.node.lsub,history, a);
    bits_remove_last(history);
    /* traverse right subtree */
    bits_putlast('1',history);
    serialize_helper(h->h.node.rsub,history, a);
    bits_remove_last(history);
    return;
  default:
    fprintf(stderr,"main.serialize_helper: bad tag\n");
    exit(1);
  }
} 
```

对于一个简单的变量定义（来自 char letter = ...;），我收到此错误：

“huffenc.c:18: 错误: 'char' 之前的预期表达式”

此外，编译器的行为就像我对“字母”的声明不存在：“huffenc.c:19: error: 'letter' undeclared (first use in this function)”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:22:44.437

如果你想在 a`switch`之后直接定义一个变量，`case`你需要一个块，例如

```
 case LEAF: {
    char letter = h->h.leaf.c;
    int arraynum = (int)letter;
    a[arraynum] = bits_show(history);
    putchar('\n');
    return;
  } 
```

* * *

编辑：原因很简单，标签后面只能跟一个语句，而声明或初始化不是语句，而块（即复合语句）是。

# css - 将 CSS 渲染显示保存到图像文件

> ID：15396571
> 
> 赞同：0
> 
> 时间：2013-03-13T21:12:23.510
> 
> 标签：css, image, save

长而短（我唯一的另一篇文章是关于我发现的发票/报价数据库）。任何人，基本上，我从表格中提取信息，即：发票显示它并用 CSS 抚摸它以获得客户的完整发票；我确实使用@media print 来显示实际打印输出的样子。这就是我希望能够保存为图像文件的内容。打印机会看到什么，我想保存为冗余备份之类的东西（软拷贝？）。我搜索了高低，我能找到的只有屏幕捕获程序和等等等等……我不知道是否可以完成，但我的手指交叉了。谢谢一捆。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:18:20.043

如果您可以使用可以保存为文件的 PDF，请尝试：

[http://www.htm2pdf.co.uk](http://www.htm2pdf.co.uk)

这是使用更好的渲染引擎之一，它在保留 HTML/CSS 格式方面做得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:21:40.430

您是在 Web 服务器上执行此操作吗？

无论如何，如果您要打印到 pdf 文件，请查看[PDFTK](http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)。它可以安装在任何系统上：windows、osx、linux。

# ios - 将 iOS 应用与新的 Facebook 登录集成

> ID：15396573
> 
> 赞同：0
> 
> 时间：2013-03-13T21:12:25.637
> 
> 标签：ios, objective-c, facebook, login

所以我在我的应用上启用了 Facebook 登录，它连接到我在 Facebook 的开发者门户上设置的应用。然而，我的团队决定创建一个通用的 Facebook 应用程序，我们都应该通过该应用程序登录。我在我的 iOS 应用程序上更改了 Facebook APP ID，更改了 URL 方案，但是当我运行该应用程序并尝试登录时，它让我通过我在 Facebook 上的旧应用程序登录。我一直在绞尽脑汁想弄清楚如何让它与新应用程序连接。任何建议将不胜感激。

# java - PageContext 是在 JAVA 中的 Sessions 或 Requests 之间共享的吗？

> ID：15396579
> 
> 赞同：1
> 
> 时间：2013-03-13T21:12:49.233
> 
> 标签：java, jsp, jsp-tags

在我的自定义标签库中，我使用了 pageContext：它是否在不同 HttpSession 的请求之间共享？它是否在同一个 HttpSession 的请求之间共享？它是为访问该页面的每个请求创建的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:21:26.857

不在实例`PageContext`之间共享。`HttpRequest`它的范围比请求的范围更窄，并且绑定到单个 JSP 页面执行。请求中可能有很少的页面上下文（通过包含或转发），它包含请求和会话（以及其他）对象的句柄

# java - 用Java编写unicode 0x2

> ID：15396581
> 
> 赞同：3
> 
> 时间：2013-03-13T21:12:53.873
> 
> 标签：java, unicode, character-encoding

如何`0x{2}`在 Java 中编写 unicode 字符？

我尝试`"\u0002"`但似乎不起作用。

我需要找到这个字符的原因是我需要在 XML 文件中替换它，然后才能解析它。

我在解析时遇到的错误提到：`An invalid XML character (Unicode: 0x{2}) was found in the value of attribute "{1}" and element is "4".`并且替换`\u0002`不能解决错误。

这就是我解析的方式：

```
try {
    // Fixing any invalid characters in the XML file
    fixXMLFile(xmlFile);

    // Get a factory
    SAXParserFactory spf = SAXParserFactory.newInstance();

    // Get a new instance of parser
    SAXParser sp = spf.newSAXParser();

    // Parse the file and also register this class for call backs
    sp.parse(xmlFile, this);

} catch(Exception e) {
    System.out.println(e.getLocalizedMessage());
} 
```

和修复方法：

```
private void fixXMLFile(File xmlFile) throws IOException {
    File tempFile = File.createTempFile("dont_delete", ".tmp");
    FileWriter fw = new FileWriter(tempFile);

    Reader fr = new FileReader(xmlFile);
    BufferedReader br = new BufferedReader(fr);

    int sdds = 0;
    while(br.ready()) {
        String tmp = br.readLine();
        if (tmp.contains("\u0002")) System.out.println(++sdds);
        fw.write(tmp.replaceAll("\u0002", "") + "\n");
    }

    fw.close();
    br.close();
    fr.close();

    // Finally replace the original file.
    tempFile.renameTo(xmlFile);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:59:07.573

我找到了。`0x{2}`错误消息中的内容是`"\u0004"`Java。替换它会消除错误消息。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-13T21:40:12.970

不允许该字符是 XML，请参阅 Wikipediate 以获取参考：[http ://en.wikipedia.org/wiki/Valid_characters_in_XML#XML_1.0](http://en.wikipedia.org/wiki/Valid_characters_in_XML#XML_1.0)

# android - 启动另一个应用程序后返回应用程序

> ID：15396585
> 
> 赞同：1
> 
> 时间：2013-03-13T21:13:09.800
> 
> 标签：android, android-ui

我有一种情况，我已经工作了将近一周，但无法提出可行的解决方案。

我有一个应用程序，它将启动一个终端窗口并运行一个命令，使用的终端是 Jack Palevich 的 Android-Terminal-Emulator （源代码[here](https://github.com/jackpal/Android-Terminal-Emulator)），用于启动窗口的代码是：

```
public boolean runCommand(String command) {
        Intent intent = new Intent("jackpal.androidterm.RUN_SCRIPT");
    intent.addCategory(Intent.CATEGORY_DEFAULT);
    intent.putExtra("jackpal.androidterm.iInitialCommand", command);
    if (mHandle != null) {
        // Identify the targeted window by its handle
        intent.putExtra("jackpal.androidterm.window_handle", mHandle);
    }

    startActivityForResult(intent, REQUEST_WINDOW_HANDLE);

    return true;
} 
```

现在这工作正常，但问题是在应用程序生命周期中有很多次需要将命令传递到此终端窗口，并且没有用户将与设备交互（即它需要自动化）。

当您启动终端窗口时，该窗口将成为视图中的活动，因此当我的应用程序仍在后台运行时，任何未来的调用`runCommand()`都不会发生，直到我的应用程序返回查看。

`runCommand()`所以我需要找到一种方法，让我的应用程序在调用并启动终端后再次成为视图中的应用程序。我已经尝试了许多路线，但没有真正成功，我想唯一真正的前进方式是对终端应用程序本身进行更改，我很乐意这样做（我已经下载并测试了源代码）但我只是一个几乎不知道在哪里看和改变什么。

如果您需要有关我的应用程序或其他任何信息的更多信息，请告诉我！

谢谢

# c++ - 有什么类似于 C++ 中的 typeof 的吗？

> ID：15396586
> 
> 赞同：1
> 
> 时间：2013-03-13T21:13:11.030
> 
> 标签：c++

我正在尝试创建一个构造函数来说明它存储的对象类型。有什么简单的方法可以做到这一点吗？我在看decltype。

```
template <typename T>
MyVector<T>::MyVector(int setCap)
{
    m_ptr = new T[setCap];
    m_size = 0;
    m_capacity = setCap;
    string typeSet = decltype(T);
    cout << "New MyVector of type " << typeSet << " created\n";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:26:33.700

C++ 有`typeid`：

```
#include <typeinfo>

std::cout << "The type is " << typeid(T).name(); 
```

# php - 用户访问被拒绝，仅在 public_html 之外使用密码“NO”

> ID：15396588
> 
> 赞同：0
> 
> 时间：2013-03-13T21:13:22.870
> 
> 标签：php, mysql, bluehost

我正在尝试在 public_html 之外运行一个 cron 作业。这在 public_html 中工作得很好，但是一旦我将它移到外面（为了安全起见）并让 cron 执行我的 PHP，我得到一个 PHP 警告：mysql_query() 用户'XYZ'@'localhost'的访问被拒绝（使用密码：否）

```
$db = mysql_connect('localhost', 'user_name', 'password_includes_*$?');
$db_select = mysql_select_db('database_name', $db);
mysql_query("INSERT INTO resource (column1, column2, column3) VALUES ('$_var1', '$_var2', '$_var3')"); 
```

# css - 当我在 CSS 文件中开始新注释时，如何阻止 Visual Studio 自动添加注释结尾字符

> ID：15396592
> 
> 赞同：31
> 
> 时间：2013-03-13T21:13:37.440
> 
> 标签：css, visual-studio-2012, comments

`/*`在 Visual Studio 2012 中，当我想使用和字符注释掉 CSS 文件中的一行或多行时`*/`，VS 总是`*/`在我键入起始注释字符后立即自动添加结束注释字符。因此，如果我从这段代码开始：

```
.appGrid {
    display: -ms-grid;
    -ms-grid-columns: 120px 1fr;
    -ms-grid-rows: 140px 80px 1fr;
} 
```

我想注释掉这一`-ms-grid-rows`行，我`/*`在该行的开头输入。这是我想看到的：

```
.appGrid {
    display: -ms-grid;
    -ms-grid-columns: 120px 1fr;
/*    -ms-grid-rows: 140px 80px 1fr;
} 
```

相反，VS 在`*/`我输入完字符后立即添加`/*`字符，如下所示：

```
.appGrid {
    display: -ms-grid;
    -ms-grid-columns: 120px 1fr;
/**/    -ms-grid-rows: 140px 80px 1fr;
} 
```

然后我必须手动删除自动添加`*/`的并在我真正想要的地方重新添加它......在这种情况下，在我试图注释掉的行的末尾。

如何阻止 VS 自动添加`*/`字符？我在“工具”>“选项”>“文本编辑器”>“CSS”中找不到任何禁用此行为的选项。

作为参考，我使用的是 VS2012 Premium。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-10T10:21:57.303

恐怕在 Visual Studio 中没有更改此选项的选项，至少我看不到。我有时遇到同样的问题，通常使用三种方法来解决它：

1.  选择要注释掉的行并使用键盘快捷键：CTRL+K、C
2.  剪切结束 */ 并将其粘贴到位置的末尾
3.  按 CTRL+Z 撤消关闭 */

第一种是最好的方法，但如果我已经开始输入 2 或 3 就足以通过中断流！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-03-08T15:12:28.547

Visual Studio - 工具 - 选项 - 文本编辑器 - C/C++ - 常规 - 取消选中“自动大括号完成”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-09T10:56:14.837

这在 VS 中不直接可用。
您可以通过首先选择内容（包括多行）然后在编辑器中**按快捷键 CTRL+K、CTRL+C**命令来执行此操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-16T15:11:44.007

Visual Studio 22 允许您为 C++ 内部语言选项关闭它。因为我没有使用 CSS，也没有安装它的工具，所以不确定它是否适用于 CSS。当我最终在这里寻找 c++ 解决方案时，我认为值得一提。

# scala - 使用 reactivemongo 映射以形成选择 Scala Play2

> ID：15396598
> 
> 赞同：1
> 
> 时间：2013-03-13T21:14:00.990
> 
> 标签：scala, playframework-2.0

我有一个 Play2 模板：

```
files: Option[List[(String, reactivemongo.api.gridfs.ReadFile[reactivemongo.bson.BSONValue])]] 
```

我想在下拉表单中显示文件选择，但前提是文件在那里！

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T12:36:51.660

正如 Julien Lafont 所说，您应该考虑在将此列表提供给您的模板之前对其进行转换。例如，如果您只想要一个读取文件列表（您可以在其上调用`filename`and `id`）：

```
val fileList = files.toList.flatten.map(_._2) // fileList is a List[ReadFile[BSONValue]]] 
```

如果你只想获取文件名和它们的 id（假设它们的 id 是`BSONObjectID`s），你可以这样写：

```
val fileList = files.toList.flatten.map { file =>
  val id = file._2.id match {
    case oid: BSONObjectID => oid.stringify
    case id => id.toString
  }
  id -> file._2.filename
}
// fileList is a List[(String, String)] where the first element of the tuple is a string version of the id and the second is the name of the file. 
```

# php - 数组中的php函数损坏

> ID：15396602
> 
> 赞同：0
> 
> 时间：2013-03-13T21:14:16.830
> 
> 标签：php, arrays, function

我正在尝试设置一个数组来拉取文件名和函数名以运行，但它不能完全正常工作。

代码是

```
$actionArray = array(
    'register' => array('Register.php', 'Register'),
);

if (!isset($_REQUEST['action']) || !isset($actionArray[$_REQUEST['action']])) {
    echo '<br><br>index<br><br>';
    echo '<a href="?action=register">test</a>';
    exit;
}

require_once($actionArray[$_REQUEST['action']][0]);
return $actionArray[$_REQUEST['action']][1]; 
```

Register.php 有

```
function Register()
{
    echo 'register';

}

echo '<br>sdfdfsd<br>'; 
```

但它不回显寄存器，只是 sdfdfsd。

如果我将第一批代码从

```
return $actionArray[$_REQUEST['action']][1]; 
```

到

```
return Register(); 
```

它有效，有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T21:16:19.730

将最后一行更改为：

```
return call_user_func($actionArray[$_REQUEST['action']][1]); 
```

这使用[call_user_func](http://php.net/manual/en/function.call-user-func.php)函数以获得更易读的代码和更好的可移植性。以下也应该有效（仅在 PHP 5.4+ 上测试）

```
return $actionArray[$_REQUEST['action']][1](); 
```

它与您的代码几乎相同，但我实际上是在调用函数而不是返回数组的值。如果没有函数调用语法`()`，您只是要求 PHP get 获取变量的值（在本例中为数组）并返回它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:20:06.763

你会在这里找到一些有用的东西： [如何从存储在变量中的字符串调用 PHP 函数](https://stackoverflow.com/questions/1005857/how-to-call-php-function-from-string-stored-in-a-variable)

调用存储在字符串中的函数名是你想要的......

# java - 带有 BlueJ 的 Java 中的 NullPointerException

> ID：15396603
> 
> 赞同：1
> 
> 时间：2013-03-13T21:14:18.320
> 
> 标签：java, nullpointerexception, bluej

当我尝试调用方法 BuyItem，以便 Rebel 类可以从 Item 类中购买物品时，我收到以下消息：

`java.lang.NullPointerException: null`

我觉得我一直在尝试一切，有人看到代码中有什么问题吗？

这是我的方法：

```
public boolean buyItem(Item item) {
    int totalWeight = currentWeight() + item.getWeight();
    if(totalWeight <= maxCarryingCapacity && money >= item.getPrice()){
        money -= item.getPrice();
        backpack.put(item.getName(), item);
        return true;
    } else {
        return false;
    }
} 
```

和

```
/**
 * @param item
 * @return current carrying weight
 */
private int currentWeight() {
    int tempWeight = 0;
    for(Entry<String, Item> entry: backpack.entrySet()) {
        tempWeight += entry.getValue().getWeight();
    }
    return tempWeight;
} 
```

如果你们中的任何人可以帮助我，我会非常高兴，因为我卡住了！

错误是 currentWeight 中的第二行和 buyItem 中的第一行。终端窗口显示：

```
rebel1.buyItem(item1)
Exception occurred.

java.lang.NullPointerException
at Rebel.currentWeight(Rebel.java:190)
at Rebel.buyItem(Rebel.java:56) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T22:15:33.503

这绝对看起来像背包还没有初始化。可能值得使用像这样的构造函数

```
public class Rebel{
    private final Map<String, Item> backpack;
    public Rebel(Map<String, Item> backpack, <Other parameters){
        this.backpack = backpack;
    }
    public Rebel(<Other parameters>){
        this(new HashMap<String,Item>(),<Other parameters>);
    }
} 
```

显然替换`<Other parameters>`为您当前的构造函数参数。

# perl - perl 在 c shell 中嵌入数据

> ID：15396605
> 
> 赞同：0
> 
> 时间：2013-03-13T21:14:25.517
> 
> 标签：perl, shell, command, embed

有没有办法将数据嵌入到 perl 脚本中，然后以类似于 c-shell 的方式将其作为临时文件使用/读取。

```
cat<< eof>tmp.txt
store a multiline text file
eof

run_some_function on [anotherexternalfile] with [tmp.txt]

rm tmp.txt 
```

我想在一个 perl 脚本中嵌入多组命令/数据文件来包装一组命令，以避免需要过多的外部命令文件。

**更新**

嵌入文件/数据需要作为另一个可执行函数的输入文件读取，如下所示。

```
system("executable.exe [anotherexternalfile] [tmp.txt]"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T21:19:04.420

据我了解，`perl`有`DATA`句柄，您可以在其中保存要从脚本中使用的数据。这边走：

```
#!/usr/bin/env perl

while ( <DATA> ) {
  ## Work with this data as if you were reading it from an external file.
}

__DATA__
some data
more data
and more... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T21:17:27.310

Perl 有“这里的文档” [http://perl.about.com/od/perltutorials/qt/perlheredoc.htm](http://perl.about.com/od/perltutorials/qt/perlheredoc.htm)。当然 Perl 可以像 shell 一样执行外部命令：[http ://www.perlhowto.com/executing_external_commands](http://www.perlhowto.com/executing_external_commands)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T21:36:28.160

它们被称为[here-docs](http://perldoc.perl.org/perlop.html#%3C%3CEOF)，并且受 Perl 支持。

```
print <<'__EOI__';
foo
bar
__EOI__

my $x = <<'__EOI__';
foo
bar
__EOI__

for (<<'__EOI__', <<'__EOI__')
foo
bar
__EOI__
abc
def
__EOI__
{
    print;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T22:11:54.997

根据user1937198的建议：

```
my @cmds = (
    "cmd1 arg1 arg2",
    "cmd2 arg1 > somefile",
);
for my $cmd (@cmds) {
    system($cmd);
} 
```

作为对 here-doc 的更完整答案：

```
my $cmds = <<CMDS;
cmd1 arg1 arg2
cmd2 arg1 > somefile
CMDS

for my $cmd (split("\n", $cmds)) {
    system("$cmd");
} 
```

# ios - iOS：有没有办法伪造用户的语言环境？

> ID：15396606
> 
> 赞同：5
> 
> 时间：2013-03-13T21:14:28.713
> 
> 标签：ios, localization, nsbundle

我有兴趣让我的用户选择我的应用程序显示给他们的语言/区域设置。我已经弄清楚如何加载正确的包，选择正确的字符串文件等。但是，我似乎仍然有一些系统项目无法控制。例如，切换控件。

我有什么方法可以告诉系统这个应用程序现在应该以特定语言运行，而不是用户当前的系统设置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-16T01:38:23.273

最简单的方法是 via `NSUserDefaults`：语言环境由`AppleLocale`（语言环境 ID 作为字符串）确定，语言由`AppleLanguages`（语言 ID 数组）中的第一个匹配项确定；*您的应用只能为您的应用*覆盖这些默认值。要检查它是否被您的应用程序覆盖，您可以使用类似`[defaults persistentDomainForName:[[NSBundle mainBundle] bundleIdentifier]] objectForKey:@"AppleLocale"]`. 要删除覆盖，请使用`-removeObjectForKey:`.

无论您采用哪种方式，在更改语言时都可能需要[重新启动应用程序；](https://stackoverflow.com/questions/4238979/how-programatically-restart-iphone-app)OS X 和 iOS 应用程序根本不是为了在运行时更改语言而设计的（在 OS X 上，只有新启动的应用程序才能看到语言更改；在 iOS 上，系统会终止所有应用程序以更改语言）。

我添加了此功能以使切换语言更容易进行开发/测试；我不知道这是否会通过 App Store 审核流程。

# iphone - For some reason when uploading an image to Facebook after taking a picture it rotates image by 90 degrees

> ID：15396607
> 
> 赞同：0
> 
> 时间：2013-03-13T21:14:37.657
> 
> 标签：iphone, ios, xcode, image, uiimagepickercontroller

The following code is the method that I use to take picture with and then send to Facebook using share kit. Problem is this causes images to be sent with a 90 degree rotation.The reason I know this is the code that is responsible for this is because if I upload an image from the iPhone gallery the image gets shared to Facebook normally.

```
 - (void)viewWillAppear:(BOOL)animated {
[super viewWillAppear:animated];
UIImagePickerController *imagePickerController = [[UIImagePickerController alloc] init];
if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera])
{
    [imagePickerController setSourceType:UIImagePickerControllerSourceTypeCamera];
}
// image picker needs a delegate,
[imagePickerController setDelegate:self];
// Place image picker on the screen
[self presentModalViewController:imagePickerController animated:YES];
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:21:27.283

The default orientation of a `UIImagePickerController` is landscape I believe. Therefore, you need to hack around with the image you obtain after taking the picture. There are many ways to do this - check out [this link](https://stackoverflow.com/q/538041/1415949). There are several methods discussed there to normalize the orientation.

# java - 弹簧单例线程安全

> ID：15396608
> 
> 赞同：8
> 
> 时间：2013-03-13T21:14:38.800
> 
> 标签：java, multithreading, spring

如果我有一个下面定义的 Java 类，它通过依赖注入注入到我的 Web 应用程序中：

```
public AccountDao
{
   private NamedParameterJdbcTemplate njt;
   private List<Account> accounts;

   public AccountDao(Datasource ds)
   {
       this.njt = new NamedParameterJdbcTemplate(ds);
       refreshAccounts();
   }

   /*called at creation, and then via API calls to inform service new users have 
     been added to the database by a separate program*/
   public void refreshAccounts()
   {
      this.accounts = /*call to database to get list of accounts*/
   }

   //called by every request to web service
   public boolean isActiveAccount(String accountId)
   {
       Account a = map.get(accountId);
       return a == null ? false : a.isActive();
   }
} 
```

我担心线程安全。Spring 框架是否不处理一个请求正在从列表中读取并且当前正在被另一个请求更新的情况？我之前在其他应用程序中使用过读/写锁，但我以前从未想过像上面这样的情况。

我打算将 bean 用作单例，这样我就可以减少数据库负载。

顺便说一句，这是对以下问题的跟进：

[减少数据库负载的 Java 内存存储 - 安全吗？](https://stackoverflow.com/questions/15395884/java-memory-storage-to-reduce-database-load-safe/15396508?noredirect=1#15396508)

编辑：

那么这样的代码会解决这个问题吗：

```
/*called at creation, and then via API calls to inform service new users have 
         been added to the database by a separate program*/
       public void refreshAccounts()
       {
          //java.util.concurrent.locks.Lock
          final Lock w = lock.writeLock();
          w.lock();
          try{
               this.accounts = /*call to database to get list of accounts*/
          }
          finally{
             w.unlock();
          }
       }

       //called by every request to web service
       public boolean isActiveAccount(String accountId)
       {
           final Lock r = lock.readLock();
           r.lock();

           try{
               Account a = map.get(accountId);
           }
           finally{
               r.unlock();
           }
           return a == null ? false : a.isActive();
       } 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-13T21:27:03.597

Spring 框架不会在后台对单例 bean 的多线程行为做任何事情。处理单例 bean 的并发问题和线程安全是开发人员的责任。

我建议阅读以下文章：[Spring Singleton, Request, Session Beans and Thread Safety](http://tarunsapra.wordpress.com/2011/08/21/spring-singleton-request-session-beans-and-thread-safety/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T21:31:12.940

您本可以要求澄清我[最初的回答](https://stackoverflow.com/questions/15395884/java-memory-storage-to-reduce-database-load-safe/15396319#15396319)。Spring 不会同步对 bean 的访问。如果您在默认范围（单例）中有一个 bean，则该 bean 将只有一个对象，所有并发请求都将访问该对象，要求该对象对线程安全。

大多数 Spring bean 没有可变状态，因此是线程安全的。您的 bean 具有可变状态，因此您需要确保没有线程看到其他线程当前正在组装的帐户列表。

最简单的方法是创建帐户字段`volatile`。这假设您在填写后将新列表分配给该字段（正如您似乎正在做的那样）。

```
private volatile List<Accounts> accounts; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T21:20:15.647

作为单例和非同步的，Spring 将允许任意数量的线程同时调用`isActiveAccount`和`refreshAccounts`。所以，这个类不会是线程安全的，也不会减少数据库负载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T21:45:20.303

我们有很多这样的元数据，并且有大约 11 个节点在运行。在每个应用程序节点上，我们都有此类数据的静态映射，因此只有一个实例，在每天的非高峰时间或支持人员触发它时从数据库启动一次。有一个内部简单的基于 http post 的 API，可以将更新从 1 个节点发送到其他节点，以获取我们需要实时更新的一些数据。

```
public AccountDao
{
   private static List<Account> accounts;
   private static List<String> activeAccounts;
   private NamedParameterJdbcTemplate njt;

   static {
       try{
        refreshAccounts();
       }catch(Exception e){
        //log but do not throw. any uncaught exceptions in static means your class is un-usable
       }
   }

   public AccountDao(Datasource ds)
   {
       this.njt = new NamedParameterJdbcTemplate(ds);
       //refreshAccounts();
   }

   /*called at creation, and then via API calls to inform service new users have 
     been added to the database by a separate program*/
   public void refreshAccounts()
   {
      this.accounts = /*call to database to get list of accounts*/
   }

   public void addAccount(Account acEditedOrAdded)
   {
      //add or reove from map onr row
      //can be called from this node or other node
      //meaning if you have 2 nodes, keep IP port of each or use a internal web service or the like to tell 
      //node B when a account id added or changed in node A ...
   }   

   //called by every request to web service
   public static boolean isActiveAccount(String accountId)
   {
       Account a = map.get(accountId);
       return a == null ? false : a.isActive();
   }
} 
```

# ios - XCode Instruments - 在屏幕上显示点击

> ID：15396609
> 
> 赞同：1
> 
> 时间：2013-03-13T21:14:45.913
> 
> 标签：ios, xcode, instruments

我刚刚开始使用 XCode Instruments，并且正在做一些 UI 自动化。为了让生活更轻松，我想在我正在点击的屏幕上显示某种指示。

Instruments 是否有一个 API 调用可以显示点击的当前位置？

# cron-task - Cron 作业不执行特定的 php 脚本

> ID：15396614
> 
> 赞同：0
> 
> 时间：2013-03-13T21:15:00.340
> 
> 标签：cron-task, webmin

我设置了一个 cron 作业（在基于 Webmin 的 Virtualmin 中）来执行一个简单的测试脚本，它运行良好。

使用的 cron 命令是：

/usr/bin/php -q /home/myuser/domains/mysite.com/public_html/mailtest.php

网址是：

www.mysite.com/mailtest.php

“mailtest.php”的内容是：

```
<?php
$to = "your@mail.com";
$subject = "Test mail";
$message = "Hello! This is a simple email message.";
$from = "any@any.com";
$headers = "From:" . $from;
mail($to,$subject,$message,$headers);
echo "Mail Sent.";
?> 
```

现在我尝试执行另一个脚本，我当然修改了路径和文件名，他们很简单：

/usr/bin/php -q /home/myuser/domains/mysite.com/public_html/myfolder/myscript.php

但是在这里我不知道为什么我的脚本没有执行。当我转到他的相关网址“www.mysite.com/myfolder/myscript.php”时，脚本执行得很好。

“myscript.php”的内容是：

```
<?php
require_once(dirname(__FILE__).'/includes/includes.php');

$mails = POP3Mailer::ProcessMails();
require_once($BASE_PATH.'/includes/footer.php');
?> 
```

有人知道为什么 cron 不会用“myscript.php”触发？？？

感谢您的时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:20:45.517

我不太确定。但也许你应该检查这个文件的权限。

使用[chmod](http://www.wistee.fr/serveur-ftp/modifier-droits-chmod.html)命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:27:44.220

Cron 在非常基本的环境中工作。创建新文件。使其可执行（chmod +x）并将其添加到 cron。在文件开头添加 #!/bin/bash，然后通过 /usr/local/bin/php 添加脚本。

您的文件应如下所示：

```
#!/bin/bash
/usr/local/bin/php /url/to/your/script.php 
```

# java - 散列搜索程序无限循环

> ID：15396615
> 
> 赞同：0
> 
> 时间：2013-03-13T21:15:04.273
> 
> 标签：java, while-loop, hashtable

我的代码卡在哈希搜索方法的第二个 while 循环中。似乎条件保持真实，如果密钥不在数据集中或找到密钥，它们最终应该变为错误。有人可以帮我找到错误吗？

谢谢

////// 这是全部..我一直在努力..仍然找不到错误。

```
 public void HashedSearch() 
    {
        HSAverageAccessTime       = 0;
        HSAverageCompSuc          = 0;
        HSAverageCompFailed       = 0;
        HSNumberKeysSuc           = 0;
        HSNumberKeysFailed        = 0;

        Initialize();

        int SearchKey;
        int TotalNumberOfComparisons;
        int address;
        int M;
        M = FindPrime();

        for(int i=0; i<NumberOfDataItems; i++)
        {

            address = OriginalArray[i] % M; 
            if (HashedArray[address]== -1)
                HashedArray[address]= OriginalArray[i];
            else 

            {
                address = (address+1) % M;

                while(HashedArray[address]!=-1)
                {

                    address=(address+1)%M;

                }

                HashedArray[address]=OriginalArray[i];

            }

        }

        System.out.println("after mapping" + M);
        long startTime = System.nanoTime();
        boolean found = false;

        for (int k = 0; k <NumberOfKeys; k++)
        { 

            found = false;
            SearchKey = KeysArray[k];
            TotalNumberOfComparisons = 0;

            address = KeysArray[k] % M;             
            //System.out.println("address" + address);

                //System.out.println(" inside if 1 --- address" + address);
            while ( HashedArray[address]!= SearchKey && HashedArray[address]!= -1)
            {
                if (HashedArray [address] == SearchKey)
                {
                    found = true;
                    TotalNumberOfComparisons++;
                    HSAverageCompSuc = HSAverageCompSuc + TotalNumberOfComparisons;
                    BSNumberKeysSuc ++;
                }
                else 
                {

                    System.out.println("Stuck after here");
                    HSAverageCompFailed = HSAverageCompFailed + TotalNumberOfComparisons;
                    HSNumberKeysFailed ++;

                        //address=(address+1)%M; 
                    address++;
                    }

                    System.out.println(" outside while --- found" + found);

                    //if(HashedArray[address] == SearchKey)
                        //found = true;
                    //else found = false;

                    //address=(address+1)%M;
                    //address++;
                }

            if(found)
            {
                HSAverageCompSuc = HSAverageCompSuc + TotalNumberOfComparisons;
                BSNumberKeysSuc ++;
            }
            else
            {
                HSAverageCompFailed = HSAverageCompFailed + TotalNumberOfComparisons;
                HSNumberKeysFailed ++;
            }
        }

        long estimatedTime = System.nanoTime() - startTime;

        if (NumberOfKeys != 0)
            HSAverageAccessTime = Math.round((estimatedTime/NumberOfKeys));
        else
            HSAverageAccessTime = 0;
        if(HSNumberKeysSuc != 0)
            HSAverageCompSuc        = Math.round (HSAverageCompSuc / HSNumberKeysSuc) ;
        else
            HSAverageCompSuc        = 0;
        if (HSNumberKeysFailed != 0)
            HSAverageCompFailed     = Math.round (HSAverageCompFailed / HSNumberKeysFailed) ;
        else
            HSNumberKeysFailed = 0;
        System.out.println("time after search" + estimatedTime);
        return; 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T06:27:46.250

@Bashir @KevinDiTraglia @Steinar

```
import javax.swing.*;
//File-related imports

import java.io.IOException;
import java.util.Scanner;
import java.io.File;
import java.util.Arrays;
import java.math.*;

public class ArrayOperations
{
    // File Parameters
    String DataFilePath;
    String DataFileName;

    String KeysFilePath;
    String KeysFileName;

    int NumberOfDataItems;
    int NumberOfKeys     ;
    int N                ;
    int BucketHashArraySize;
    int NoBuckets;
    //Array

    int[] OriginalArray = new int[1000000];
    int[] SortedArray = new int[1000000];
    int[] HashedArray = new int[2000000];
    int[] BucketHashedArray = new int[2000000];
    int[] KeysArray   = new int[1000000];

    long SSAverageAccessTime;
    long SSAverageCompSuc   ;
    long SSAverageCompFailed;
    long SSNumberKeysSuc    ;
    long SSNumberKeysFailed ;

    long BSAverageAccessTime;
    long BSAverageCompSuc   ;
    long BSAverageCompFailed;
    long BSNumberKeysSuc    ;
    long BSNumberKeysFailed ;

    long HSAverageAccessTime;
    long HSAverageCompSuc   ;
    long HSAverageCompFailed;
    long HSNumberKeysSuc    ;
    long HSNumberKeysFailed ;

    public ArrayOperations()
    {   
        // File Parameters
        DataFilePath = null;
        DataFileName = null;

        KeysFilePath = null;
        KeysFileName = null;

        NumberOfDataItems=0;
        NumberOfKeys     =0;
        N                =0;
        BucketHashArraySize = 0;
        NoBuckets =0;
        // Statistics

        SSAverageAccessTime       = 0;
        SSAverageCompSuc          = 0;
        SSAverageCompFailed       = 0;
        SSNumberKeysSuc           = 0;
        SSNumberKeysFailed        = 0;

        BSAverageAccessTime       = 0;
        BSAverageCompSuc          = 0;
        BSAverageCompFailed       = 0;
        BSNumberKeysSuc           = 0;
        BSNumberKeysFailed        = 0;

        HSAverageAccessTime       = 0;
        HSAverageCompSuc          = 0;
        HSAverageCompFailed       = 0;
        HSNumberKeysSuc           = 0;
        HSNumberKeysFailed        = 0;

    }   

    public void ReadDataFile() throws IOException
    {
        JFileChooser chooser = new JFileChooser();
        chooser.setDialogType(JFileChooser.OPEN_DIALOG );
        chooser.setDialogTitle("Open Data File");

        int returnVal = chooser.showOpenDialog(null);
        if( returnVal == JFileChooser.APPROVE_OPTION) 
        {
            DataFilePath = chooser.getSelectedFile().getPath();
            DataFileName = chooser.getSelectedFile().getName();
        }

        // read data file and copy it to original array
        if (DataFilePath != null)
        {
            try
            {

                int index = 0;
                Scanner integerTextFile = new Scanner(new File(DataFilePath));   
                while (integerTextFile.hasNext())
                {
                    // read the next integer
                    OriginalArray[index] = integerTextFile.nextInt();
                    index++;
                }
                //  end of file detected
                integerTextFile.close();
                NumberOfDataItems = index;
            }
            catch (IOException ioe)
            {
                System.exit(0); 
            }     

        }
        else
            NumberOfDataItems = 0;
    }
    public void ReadKeysFile() throws IOException
    {
        JFileChooser chooser = new JFileChooser();
        chooser.setDialogType(JFileChooser.OPEN_DIALOG );
        chooser.setDialogTitle("Open Keys File");

        int returnVal = chooser.showOpenDialog(null);
        if( returnVal == JFileChooser.APPROVE_OPTION) 
        {
            KeysFilePath = chooser.getSelectedFile().getPath();
            KeysFileName = chooser.getSelectedFile().getName();
        }
        // read data file and copy it to original array
        if (KeysFilePath != null)
        {
            try
            {
                int index = 0;
                Scanner integerTextFile = new Scanner(new File(KeysFilePath));   
                while (integerTextFile.hasNext())
                {
                    // read the next integer
                    KeysArray[index]= integerTextFile.nextInt();
                    index++;
                }
                //  end of file detected
                integerTextFile.close();
                NumberOfKeys = index;
            }
            catch (IOException ioe)
            {
                System.exit(0); 
            }     

        }
        else
            NumberOfKeys = 0;
    }
    public void SequentialSearch() 
    {
        SSAverageAccessTime     = 0;
        SSAverageCompSuc        = 0;
        SSAverageCompFailed     = 0;
        SSNumberKeysSuc         = 0;
        SSNumberKeysFailed      = 0;
        int SearchKey;
        int TotalNumberOfComparisons;
        long startTime = System.nanoTime();
        boolean found = false;

        for (int k=0; k<NumberOfKeys; k++)
        {
            found = false;
            SearchKey = KeysArray[k];
            TotalNumberOfComparisons = 0;
            for (int d=0; d<NumberOfDataItems; d++)
            {
                TotalNumberOfComparisons++;
                if (SearchKey == OriginalArray[d])
                {
                    found = true;
                }
                if (found)break;
            }
            if(found)
            {
                SSAverageCompSuc = SSAverageCompSuc + TotalNumberOfComparisons;
                SSNumberKeysSuc ++;
            }
            else
            {
                SSAverageCompFailed = SSAverageCompFailed + TotalNumberOfComparisons;
                SSNumberKeysFailed ++;
            }
        }
        long estimatedTime = System.nanoTime() - startTime;

        if (NumberOfKeys != 0)
            SSAverageAccessTime = Math.round((estimatedTime/NumberOfKeys));
        else
            SSAverageAccessTime = 0;
        if(SSNumberKeysSuc != 0)
            SSAverageCompSuc        = Math.round (SSAverageCompSuc / SSNumberKeysSuc) ;
        else
            SSAverageCompSuc        = 0;
        if (SSNumberKeysFailed != 0)
            SSAverageCompFailed     = Math.round (SSAverageCompFailed / SSNumberKeysFailed) ;
        else
            SSNumberKeysFailed = 0;
        return;
    }

    public void BinarySearch() 
    {
        BSAverageAccessTime     = 0 ;
        BSAverageCompSuc        = 0 ;
        BSAverageCompFailed     = 0 ;
        BSNumberKeysSuc         = 0 ;
        BSNumberKeysFailed      = 0 ;
        int SearchKey;
        int TotalNumberOfComparisons;

        boolean found = false;

        for (int i=0; i<NumberOfDataItems; i++)
        {
            SortedArray[i] = OriginalArray[i];
        }

        Arrays.sort(SortedArray);

        long startTime = System.nanoTime();

        for (int k=0; k<NumberOfKeys; k++)
        {
            found = false;
            SearchKey = KeysArray[k];
            TotalNumberOfComparisons = 0;

            //binary starts

            int start = 0;
            int end = SortedArray.length - 1;
            int middle;

            while ( end >= start )
            {
                middle = ( start + end )/ 2;                       // element in middle of array

                if ( SortedArray[middle] == SearchKey )

                {
                    TotalNumberOfComparisons++;
                    found = true; 

                }  
                else 
                    if ( SortedArray[middle] > SearchKey )
                    { TotalNumberOfComparisons++;
                    end = middle - 1;

                    }                           // search left side of array
                    else
                    {  TotalNumberOfComparisons++;
                    start = middle + 1; }                          // search right side of array

                if (found)
                    break;
                //binaryends
            }

            if(found)
            {
                BSAverageCompSuc = BSAverageCompSuc + TotalNumberOfComparisons;
                BSNumberKeysSuc ++;
            }
            else
            {
                BSAverageCompFailed = BSAverageCompFailed + TotalNumberOfComparisons;
                BSNumberKeysFailed ++;
            }
        }

        long estimatedTime = System.nanoTime() - startTime;

        if (NumberOfKeys != 0)
            BSAverageAccessTime = Math.round((estimatedTime/NumberOfKeys));
        else
            BSAverageAccessTime = 0;
        if(BSNumberKeysSuc != 0)
            BSAverageCompSuc        = Math.round (BSAverageCompSuc / BSNumberKeysSuc) ;
        else
            BSAverageCompSuc        = 0;
        if (BSNumberKeysFailed != 0)
            BSAverageCompFailed     = Math.round (BSAverageCompFailed / BSNumberKeysFailed) ;
        else
            BSNumberKeysFailed = 0;
        return;
    }

    public void HashedSearch() 
    {
        HSAverageAccessTime       = 0;
        HSAverageCompSuc          = 0;
        HSAverageCompFailed       = 0;
        HSNumberKeysSuc           = 0;
        HSNumberKeysFailed        = 0;

        Initialize();

        int SearchKey;
        int TotalNumberOfComparisons;
        int address;
        int M;
        M = FindPrime();

        for(int i=0; i<NumberOfDataItems; i++)
        {

            address = OriginalArray[i] % M; 
            if (HashedArray[address]== -1)
                HashedArray[address]= OriginalArray[i];
            else 

            {
                address = (address+1) % M;

                while(HashedArray[address]!=-1)
                {

                    address=(address+1)%M;

                }

                HashedArray[address]=OriginalArray[i];

            }

        }

        System.out.println("after mapping" + M);
        long startTime = System.nanoTime();
        boolean found = false;

        for (int k = 0; k <NumberOfKeys; k++)
        { 

            found = false;
            SearchKey = KeysArray[k];
            TotalNumberOfComparisons = 0;

            address = KeysArray[k] % M;             
            //System.out.println("address" + address);

                //System.out.println(" inside if 1 --- address" + address);
            while ( HashedArray[address]!= SearchKey && HashedArray[address]!= -1)
            {
                if (HashedArray [address] == SearchKey)
                {
                    found = true;
                    TotalNumberOfComparisons++;
                    HSAverageCompSuc = HSAverageCompSuc + TotalNumberOfComparisons;
                    BSNumberKeysSuc ++;
                }
                else 
                {

                    System.out.println("Stuck after here");
                    HSAverageCompFailed = HSAverageCompFailed + TotalNumberOfComparisons;
                    HSNumberKeysFailed ++;

                        //address=(address+1)%M; 
                    address++;
                    }

                    System.out.println(" outside while --- found" + found);

                    //if(HashedArray[address] == SearchKey)
                        //found = true;
                    //else found = false;

                    //address=(address+1)%M;
                    //address++;
                }

            if(found)
            {
                HSAverageCompSuc = HSAverageCompSuc + TotalNumberOfComparisons;
                BSNumberKeysSuc ++;
            }
            else
            {
                HSAverageCompFailed = HSAverageCompFailed + TotalNumberOfComparisons;
                HSNumberKeysFailed ++;
            }
        }

        long estimatedTime = System.nanoTime() - startTime;

        if (NumberOfKeys != 0)
            HSAverageAccessTime = Math.round((estimatedTime/NumberOfKeys));
        else
            HSAverageAccessTime = 0;
        if(HSNumberKeysSuc != 0)
            HSAverageCompSuc        = Math.round (HSAverageCompSuc / HSNumberKeysSuc) ;
        else
            HSAverageCompSuc        = 0;
        if (HSNumberKeysFailed != 0)
            HSAverageCompFailed     = Math.round (HSAverageCompFailed / HSNumberKeysFailed) ;
        else
            HSNumberKeysFailed = 0;
        System.out.println("time after search" + estimatedTime);
        return; 
    } 

    public int FindPrime()
    {
        boolean prime = true;

        for(int i=NumberOfDataItems * 2-1; i>=0; i--)
        {
            System.out.println(" i = " +i);

            prime = true;
            for(int J =2; J< Math.sqrt(i); J++)
            {
                if (i % J == 0)
                {
                    prime = false;

                }
                if (prime == false) break;
            }
            if (prime == true)
            {
                System.out.println(i);
                return i;
            }
        }
        return -1;  
    }

    public void Initialize()
    {

        for (int i=0; i<NumberOfDataItems; i++)
        {
            HashedArray[i] = -1;
        }

    }
    public void BHSearch()
    {

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T22:02:59.567

```
while ( HashedArray[address]!= SearchKey && HashedArray[address]!= -1)
{
        address=(address+1)%M; 

} 
```

如果您的**SearchKey**或**-1**不在**HashedArray**中，则您的循环永远不会终止。除非您发布完整的代码，否则我无法为您提供更多说明。

# asp.net - 使页面具有基于 DB 赋予用户的功能

> ID：15396619
> 
> 赞同：0
> 
> 时间：2013-03-13T21:15:25.263
> 
> 标签：asp.net, capability

我是 asp.net 的新手，并试图通过检查数据库来了解如何根据允许的内容向各个用户显示不同的功能。

我认为一个很好的例子就像一个论坛，管理员可以在其中打开和关闭用户可以执行的不同功能。前任。编辑旧帖子，查看旧帖子，打印帖子。

在我的数据库中，我会让用户与角色和能力相匹配。

什么是“生成”为每个用户定制的页面的最佳方式，如果他们有这种能力，他们可以看到“编辑帖子”的选项，如果没有，就看不到它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:18:17.983

您可以使用 .NET 成员资格：

ASP.NET 成员资格为您提供了一种验证和存储用户凭据的内置方式。因此，ASP.NET 成员身份可帮助您管理网站中的用户身份验证。您可以将 ASP.NET 成员资格与 ASP.NET 表单身份验证一起使用，方法是使用 ASP.NET 登录控件来创建一个完整的用户身份验证系统。

[http://msdn.microsoft.com/en-GB/library/yh26yfzy(v=vs.100).aspx](http://msdn.microsoft.com/en-GB/library/yh26yfzy(v=vs.100).aspx)

然后，您可以通过检查当前用户是否处于正确的角色来显示/隐藏诸如“编辑帖子”之类的按钮：

[http://msdn.microsoft.com/en-us/library/4z6b5d42.aspx](http://msdn.microsoft.com/en-us/library/4z6b5d42.aspx)

例如

```
ButtonEditPost.Visible = Roles.IsUserInRole("Admin"); 
```

# python - Python返回不返回变量

> ID：15396625
> 
> 赞同：0
> 
> 时间：2013-03-13T21:15:58.203
> 
> 标签：python, return-value

在这个时钟中，我最初要求用户输入时间，但它不会返回变量中的时间。我得到一个

```
Traceback (most recent call last):
  File "C:/Documents and Settings/Brett/My Documents/Programming/Python/clock.py", line 20, in <module>
    print(hour,":",mins,":",sec)
NameError: name 'hour' is not defined 
```

我知道设置时间部分不需要成为一个函数，但我想稍后使用它。

```
import time

def setTime():
    print("Set time \n--------")
    time=input("24 hour or 12 hour \nType 1 or 2: ")
    if time=="2": hour12=input("AM or PM \nType 1 or 2: ")
    else: hour12=0
    hour=input("Hour: ")
    mins=input("Minute: ")
    print("--------")
    sec=0
    return time,hour12,hour,mins,sec

def printTime24():
    print(hour,":",mins,":",sec)

#def printTime12():

setTime()
print(hour,":",mins,":",sec)
while True:
    time.sleep(1)
    sec+=1
    if sec == 60:
        sec=0
        mins+=1
    if mins == 60:
        mins=0
        hour+=1
    if time=="1": printTime24()
#    elif time=="2": printTime12() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:19:15.733

该`return`语句返回*值*，而不是变量。如果没有对返回的值做任何事情，它们就会被丢弃。

您调用`setTime()`但对它返回的值不做任何事情。

您需要以新名称存储返回的值：

```
time, hour12, hour, mins, sec = setTime() 
```

我使用了与`setTime()`函数本身相同的名称，但我也可以给它们不同的名称：

```
foo, bar, baz, spam, eggs = setTime() 
```

然后在其余代码中使用这些名称：

```
print(baz, ":", spam, ":", eggs) 
```

# xcode - Xcode：转到出口的定义

> ID：15396627
> 
> 赞同：5
> 
> 时间：2013-03-13T21:16:01.660
> 
> 标签：xcode, interface-builder

因此，我来​​自 C# WinForms/WPF 的背景，并试图了解 Xcode 如何将 Interface Builder 中的可视 UI 元素与代码中的实体联系起来。

在 WPF 中，我习惯于定义元素的 id，然后将其作为代码中的成员访问。在 JavaScript 中它是相似的，除了我必须先调用`document.getElementById`。

然而，Xcode 及其出口真的让我陷入了困境。假设我有一个界面并在窗口中创建一个视图。现在我希望能够以编程方式访问该视图，但首先我必须为该视图定义一个出口并以图形方式将视图“绑定”到出口？除了对不必要工作的抱怨之外，我的下一个问题是是否有一种快速简便的方法可以从 Interface Builder*获取该插座定义？*

在代码中，我可以命令单击标识符以转到其定义，但这似乎在此窗口中不起作用：

![在此处输入图像描述](../Images/ba553ed120bebd322763e36e99199469.png)

我只想去定义，`menu`所以我可以使用它。有没有捷径可以做到这一点，还是我必须自己找到控制器文件并搜索“菜单”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-08-07T17:46:23.887

我的做法是：
尝试为您的网点命名，然后使用“快速打开”窗口 ( `cmd + shift + o`) 找到您的网点。

不幸的是，xcode 没有像 Visual Studio 或任何其他合理的 IDE 那样跳转到出口。Apple 是 Apple，强制您单独命名您的 outlet，而不是使用 ID 引用，但不实现跳转，并且首先需要 interface builder 绑定 outlet。这都是胡说八道，所以你能做的最好的就是在命名插座时使用可预测的模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:27:14.133

使用助理编辑器！当您在 Interface Builder 中选择对象时，它会自动跟随，显示它们的头文件。

然后，要创建您的插座，而不是在 Interface Builder 中编写定义和控制拖动，您只需从 Interface Builder 视图控制拖动到助手编辑器另一半的头文件中的空白处。

# python - 使用子进程 PIPE 在 Python 脚本之间发送字符串

> ID：15396628
> 
> 赞同：3
> 
> 时间：2013-03-13T21:16:04.157
> 
> 标签：python, subprocess, stdout, stdin

我想在我的主 python 程序中使用子进程打开一个 Python 脚本。我希望这两个程序能够在它们都在运行时相互聊天，这样我就可以监视从脚本中的活动，即我需要它们在彼此之间发送字符串。

主程序将具有与此类似的功能，它将与从属脚本进行通信和监视：

**脚本 1**

```
import subprocess
import pickle
import sys
import time
import os

def communicate(clock_speed, channel_number, frequency):
    p = subprocess.Popen(['C:\\Python27\\pythonw','test.py'], stdin=subprocess.PIPE, stdout=subprocess.PIPE)
    data = pickle.dumps([clock_speed, channel_number, frequency]).replace("\n", "\\()")
    print data
    p.stdin.write("Start\n")
    print p.stdout.read()
    p.stdin.write(data + "\n")
    p.poll()
    print p.stdout.readline()
    print "return:" + p.stdout.readline()
    #p.kill()

if __name__ == '__main__':
    print "GO"
    communicate(clock_speed = 400, channel_number = 0, frequency = 5*1e6) 
```

test.py 脚本与此类似：

**脚本 2**

```
import ctypes
import pickle
import time
import sys

start = raw_input("")
sys.stdout.write("Ready For Data")
data = raw_input("")
data = pickle.loads(data.replace("\\()", "\n"))
sys.stdout.write(str(data))
###BUNCH OF OTHER STUFF### 
```

我希望这些脚本执行以下操作：

1.  脚本 1 使用 Popen 打开脚本 2
2.  脚本 1 发送字符串“Start\n”
3.  脚本 2 读取此字符串并发送字符串“Ready For Data”
4.  脚本 1 读取此字符串并将腌制数据发送到脚本 2
5.  然后随便...

主要问题是如何执行第 2-4 部分。然后应该遵循两个脚本之间的其余通信。到目前为止，我只能在脚本 2 终止后读取字符串。

任何帮助是极大的赞赏。

**更新：**

脚本 1 必须使用 32 位 Python 运行，而脚本 2 必须使用 64 位 Python 运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T01:41:15.560

管道的问题是，如果你调用了一个读操作并且没有什么要读的，你的代码就会停滞不前，直到对方写了一些东西给你读。此外，如果你写得太多，你的下一个写操作可能会阻塞，直到对方从管道中读取一些东西并释放它。

您可以进行“非阻塞调用”，在这些情况下将返回错误而不是阻塞，但您的应用程序仍需要明智地处理错误。

无论如何，您需要设置某种**协议**。想想 HTTP 或您熟悉的任何其他协议：有请求和响应，当您阅读两者中的任何一个时，协议总是会告诉您是否需要阅读其他内容。这样，您始终可以就是否等待更多数据做出明智的决定。

这是一个有效的示例。它之所以有效，是因为有以下协议：

*   p1 发送一行，以 '\n' 结尾；
*   p2 做同样的事情；
*   p1 发送另一行；
*   p2 做同样的事情；
*   两人都很高兴并退出。

为了向管道（在任一侧）写入一行并确保它进入管道，我调用`write()`然后`flush()`.

为了从管道（在任一侧）读取单行但不超过一个字节，从而阻塞我的代码，直到行准备好并且不再超过，我使用`readline()`.

您可以进行其他调用和其他协议，包括现成的，但单行协议适用于简单的事情和像这样的演示。

p1.py：

```
import subprocess

p = subprocess.Popen(['python', 'p2.py'], stdin=subprocess.PIPE, stdout=subprocess.PIPE)
p.stdin.write("Hello\n")
p.stdin.flush()
print 'got', p.stdout.readline().strip()
p.stdin.write("How are you?\n")
p.stdin.flush()
print 'got', p.stdout.readline().strip() 
```

p2.py：

```
import sys

data = sys.stdin.readline()
sys.stdout.write("Hm.\n")
sys.stdout.flush()
data = sys.stdin.readline()
sys.stdout.write("Whatever.\n")
sys.stdout.flush() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-29T17:15:24.960

我也遇到了类似的问题，没有办法在不同进程之间发送通用 Python 对象，而不会遇到知道对方何时没有发送对象或关闭的问题。还尝试使用`multiprocessing.Queue`通常意味着该进程需要由当前进程启动，这在两个进程想要协作时并不总是如此。

为了解决这个问题，我使用了该[`picklepipe`](https://pypi.python.org/pypi/picklepipe)模块，它定义了一个通用对象序列化管道接口以及一个使用[`pickle`](https://docs.python.org/3/library/pickle.html)名为 the的协议的管道`PicklePipe`（也使用[`marshal`](https://docs.python.org/3/library/marshal.html)名为 的协议`MarshalPipe`）。它不仅可以发送字符串，还可以将任何可腌制对象发送给它的对等方。

管道甚至是可选择的，这意味着当准备接收新对象时，`selectors`模块（或`selectors2`, ）可以将它们用作文件对象。`selectors34`这使得等待许多不同的管道准备好非常有效。

支持 Python 2.7+（可能还有 2.6）和所有主要平台。甚至可以在两个不同版本的 Python 之间发送对象！查看[项目文档](http://picklepipe.readthedocs.io/en/latest/)或[查看 Github 上的源代码](https://github.com/SethMichaelLarson/picklepipe)。

披露：我是`picklepipe`. 我很想听听您的反馈。:)

# security - 在 Worklight 中重用自定义安全测试

> ID：15396630
> 
> 赞同：0
> 
> 时间：2013-03-13T21:16:07.560
> 
> 标签：security, testing, ibm-mobilefirst

已经创建和部署了几个自定义安全测试。在一个 Worklight 项目中使用 customSecurityTest 没有问题。但是当其他 Worklight 项目也尝试使用相同的 customSecurityTest 时。得到 401 未经授权的错误。客户端的响应类似于 /*-secure- {"challenge.s":{"wl_antiXSRFRealm":{"WL-Instance-Id":"guhao08ggi00es5ec9r2mfshp3"}}}*/。

如果无法重用 customSecurityTest，它将破坏重用安全框架的整个目的。请帮忙解决。谢谢！

杰瑞

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T09:24:50.620

如果您有两个单独的项目，则需要复制您的 securityTests。项目之间没有共享（大体上）。

如果您有同一个项目的两个应用程序，则可以在两者中使用相同的 securityTests。

我不得不说，这种限制并没有破坏安全框架的目的......

# javascript - 比较来自 PostgreSQL 的 javascript 日期时间和时间戳

> ID：15396637
> 
> 赞同：8
> 
> 时间：2013-03-13T21:16:31.820
> 
> 标签：javascript, sql, date, datetime, timestamp

在 PostgreSQL 数据库中，我在时间戳列中保存了这个值：**2013-03-15 08:50:00**。我的目标是从数据库中获取这个日期并检查当前时间是否比数据库中的时间少约 12 小时。

为此，我想从中获取当前时间`new Date()`并将其与数据库中的日期进行比较 - 但由于时间格式不同，这不起作用。

我怎么能这样做并以相同（可比较）的格式转换这些时间？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T21:31:18.920

var ds='2013-03-15 08:50:00';

没有任何时区信息，您无法真正分辨出今天是哪一天。假设您的字符串采用 UTC，如果您将空格替换为“T”并在末尾添加“Z”，则可以使用 Date 构造函数：

```
var ds='2013-03-15 08:50:00';

var day=new Date(ds.replace(' ','T')+'Z');

day.toUTCString() 
```

**格林威治标准时间 2013 年 3 月 15 日星期五 08:50:00**

您可以编写一个日期解析函数来解析 ISO 或 sql 格式，

在某些较旧的浏览器上可能需要。

```
Date.fromISO= function(s){
    var day, tz,
    rx=/^(\d{4}\-\d\d\-\d\d([tT ][\d:\.]*)?)([zZ]|([+\-])(\d\d):(\d\d))?$/,
    p= rx.exec(s) || [];
    if(p[1]){
        day= p[1].split(/\D/);
        for(var i= 0, L= day.length;i<L;i++){
            day[i]= parseInt(day[i], 10) || 0;
        };
        day[1]-= 1;
        day= new Date(Date.UTC.apply(Date, day));
        if(!day.getDate()) return NaN;
            //adjust for time zone offset:
        if(p[5]){
            tz= (parseInt(p[5], 10)*60);
            if(p[6]) tz+= parseInt(p[6], 10);
            if(p[4]== '+') tz*= -1;
            if(tz) day.setUTCMinutes(day.getUTCMinutes()+ tz);
        }
        return day;
    }
    return NaN;
} 
```

然后调用 **Date.fromISO('2013-03-15 08:50:00')**；

# javascript - Function redirect if Div Id on my page won't work

> ID：15396641
> 
> 赞同：1
> 
> 时间：2013-03-13T21:17:07.170
> 
> 标签：javascript, function, redirect

I need to redirect page if div id found inside the page.

I have this script :

```
 <script>

 if (!document.getElementById("locationsHolder")) {
 window.location.href = "logged.html";
 }
 </script> 
```

On the same page I have this

```
 <div class="locationsHolder" id="locationsHolder"></div> 
```

Although I have everything right it loads logged.html page whatever id I put on getElementById. i.e. getElementById("notexist")

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:23:09.903

You should do `if (document.getElementById("locationsHolder"))` since you want to do something if the div is found. Also you should put the script at the end of document or use jQuery `$(document).ready()` to make sure the entire page is loaded prior to running the script.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:46:06.910

Maybe this will do what you need:

```
<!-- Put the following somewhere in the head block: -->
<script type="text/javascript">
window.onload = function(){
    if(document.getElementById("locationsHolder") == null){
        // Do something here if the ID is NOT found on the page
    }else{
        // Do something here if the ID IS found on the page
        document.location = "logged.html";
    }
};
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:24:14.437

you should ask if it is == null. try this in the developer tool.

!null --> true

!"" --> true

!document.getElementById("locationsHolder") is always true.

you should do something like

!document.getElementById("locationsHolder") == null

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T21:34:15.873

you probably tested for the existence of div id before even the page has been loaded. I would suggest you to either place the script after the div id or invoke the call only after the onload event.

```
window.onload=function(){
    // your code
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-14T07:22:43.127

It was the '!' that I remove it and script was before div id. Now it's working.

I need it this because I want home page redirected if another page contain a div id. I have another script inside index file that looks for page2 if contain div id , and it worked until I made this script from this topic that checks if that div is present on the page.

So, this script is one home page and checks if div id found on page2 and loads it on home page :

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
<script type="text/javascript">
jQuery(function($){
$('#result').load('Page2.html #intro');
});
</script>
</head>
<body>
<div id="result"></div> 
```

Code from page2:

```
<div id="result"><div id="intro">Hi, this is the Intro!</div></div> 
```

Now the script from this topic can't find div id "intro" , and actually it dosen't load as bellow script search for 'intro'(and jquery above stops working), but if I search for other div from the page is working Must be a conflict.

```
 <script>

 if (document.getElementById("intro")) {

  window.location.href = "logged.html";
 }
 </script> 
```

What is wrong? Maybe there is another more simple way to trigger redirection if page.2 contain div id "intro" ?

I tried to trigger redirect directly from page1 with this script but won't work:

```
<script type="text/javascript"   src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js">    </script>
<script type="text/javascript">
if ('page2.html #intro').length === 0){
window.location.href = "logged.html";
}
</script> 
```

# wpf - WPF 数据模板和按钮

> ID：15396645
> 
> 赞同：3
> 
> 时间：2013-03-13T21:17:25.327
> 
> 标签：wpf, datatemplate

注意：我使用的是 Visual Studio 2012

我有以下 DataTemplate（注意：有一个 TextBlock 和 Button）

```
<DataTemplate DataType="{x:Type ctlDefs:myButton}">
    <StackPanel>
        <TextBlock Text="{Binding LabelText}" Margin="10,0,10,0"/>

        <Button Content="{Binding LabelText}" Margin="0,0,10,0" 
            Width="{Binding ButtonWidth}" 
            Height="35"
            Command="{Binding ButtonCommand}" 
            Visibility="Visible"                    
            />
    </StackPanel>
</DataTemplate> 
```

我的屏幕正在将 myButton 的控件动态添加到 Items Control

```
 <ItemsControl ItemsSource="{Binding CommandButtons, Mode=OneWay}"
               FlowDirection="LeftToRight"
               DockPanel.Dock="Right"
              > 
```

第一次渲染视图时，每个按钮都会显示 Textblock，但 Button 本身不会。如果我隐藏视图然后再次显示它，按钮有时会出现（如果 CommandButtons 列表没有改变，如果它改变了，它永远不会显示）。

渲染视图后，我查看了输出窗口并且没有绑定错误。

我错过了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T08:49:49.740

我已经启动了一个快速应用程序来处理您的示例代码，并且该视图似乎没有任何问题。下面是运行时的样子。

![看起来像这样](../Images/07d29fd17dd4dd4f7bbe7cdf3151db15.png)

我在下面包含了我的代码以防万一。**注意：为简洁起见，我没有添加真正的 ICommand 对象，并且我不小心将 MyButton 类命名为大写 M 而不是像您的示例那样小 m**

ViewModelBase.cs

```
public abstract class ViewModelBase : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanged(string propertyName)
    {
        this.OnPropertyChanged(new PropertyChangedEventArgs(propertyName));
    }

    protected virtual void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        var handler = this.PropertyChanged;
        if (handler != null)
        {
            handler(this, e);
        }
    }
}

public class MainWindowViewModel : ViewModelBase
{
    public MainWindowViewModel()
    {
        this.CommandButtons = new ObservableCollection<MyButton>();
    }
    public ObservableCollection<MyButton> CommandButtons { get; private set; }
} 
```

应用程序.xaml.cs

```
public partial class App : Application
{
    protected override void OnStartup(StartupEventArgs e)
    {
        base.OnStartup(e);

        var mainvm = new MainWindowViewModel();
        var window = new MainWindow
        {
            DataContext = mainvm
        };
        window.Show();

        mainvm.CommandButtons.Add(new MyButton { ButtonWidth = 50, LabelText = "Button 1" });
        mainvm.CommandButtons.Add(new MyButton { ButtonWidth = 50, LabelText = "Button 2" });
        mainvm.CommandButtons.Add(new MyButton { ButtonWidth = 50, LabelText = "Button 3" });
    }
} 
```

主窗口.xaml

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ctlDefs="clr-namespace:WpfApplication1"
    Title="MainWindow" Height="350" Width="525">
<Window.Resources>
    <DataTemplate DataType="{x:Type ctlDefs:MyButton}">
        <StackPanel>
            <TextBlock Text="{Binding LabelText}" Margin="10,0,10,0"/>

            <Button Content="{Binding LabelText}" Margin="0,0,10,0" 
                    Width="{Binding ButtonWidth}" 
                    Height="35"
                    Command="{Binding ButtonCommand}" 
                    Visibility="Visible"                    
        />
        </StackPanel>
    </DataTemplate>
</Window.Resources>
<Grid>
    <ItemsControl ItemsSource="{Binding CommandButtons, Mode=OneWay}"
           FlowDirection="LeftToRight"
           DockPanel.Dock="Right"
          />
</Grid> 
```

我的按钮.cs

```
public class MyButton : ViewModelBase
{
    private string _labelText;

    public string LabelText
    {
        get { return this._labelText; }
        set { this._labelText = value; this.OnPropertyChanged("LabelText"); }
    }

    private double _buttonWidth;

    public double ButtonWidth
    {
        get { return _buttonWidth; }
        set { _buttonWidth = value; this.OnPropertyChanged("ButtonWidth"); }
    }

    private ICommand _buttonCommand;

    public ICommand ButtonCommand
    {
        get { return _buttonCommand; }
        set { _buttonCommand = value; this.OnPropertyChanged("ButtonCommand"); }
    }
} 
```

# algorithm - 跟踪堆内的节点

> ID：15396646
> 
> 赞同：0
> 
> 时间：2013-03-13T21:17:25.490
> 
> 标签：algorithm, data-structures, heap

我有这个问题 - 我正在保留一个包含两个不同堆的数据结构，一个最小堆和一个**不**包含相同数据的最大堆。

我的目标是为任一堆中的每个节点位置保留某种记录，并使用堆操作对其进行更新。底线 - 我试图弄清楚我怎样才能拥有一个在 lg(n) 复杂性中工作的 delete(p) 函数。p 是可以保存任何数据的指针数据对象。

谢谢，内德。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:27:30.767

如果您的堆被实现为一个项目数组（例如引用），那么您可以在 O(n) 时间内轻松地在堆中找到任意项目。一旦您知道该项目在堆中的位置，您就可以在 O(log n) 时间内将其删除。所以查找和删除是 O(n + log n)。

如果将堆与字典或哈希映射配对，则可以实现 O(log n) 的删除，正如我在[此答案](https://stackoverflow.com/a/14471068/56778)中所描述的那样。

[这里](https://stackoverflow.com/a/8706363/56778)解释了在 O(log n) 时间内删除任意项目。

字典方法的技巧是字典包含一个键（项目键）和一个值，该值是节点在堆中的位置。每当您在堆中移动一个节点时，都会在字典中更新该值。在这种情况下，插入和删除会稍微慢一些，因为它们需要进行 log(n) 字典更新。但是这些更新是 O(1)，所以它并不是*非常*昂贵。

或者，如果您的堆实现为二叉树（使用指针，而不是数组中的隐式结构），那么您可以将指向节点的指针存储在字典中，并且在插入或删除时不必更新它堆。

话虽如此，成对数据结构中添加和删除最小值（或最大堆的删除最大值）的*实际*性能将低于作为数组实现的标准堆，除非您正在执行大量任意删除. 如果您只是偶尔删除一个任意项目，特别是如果您的堆相当小，那么 O(n) 删除性能可能会更好。实现起来更简单，当 n 很小时，O(n) 和 O(log n) 之间几乎没有真正的区别。

# java - 未列出的数组比较的 O(nlgn) 复杂度？

> ID：15396647
> 
> 赞同：0
> 
> 时间：2013-03-13T21:17:25.643
> 
> 标签：java, compare

考虑两个和，X=x1+x2+...+xn，并且 Y=y1+y2+...+ym。给出一个找到索引 i 和 j 的算法，使得交换 xi 和 yj 使两个和相等，即 X-xi+yj = Y-yj+xi ，如果它们存在的话。

嗨，大家好！所以在那里你可以看到描述。所以首先我得到两个未排序的数组。然后我对它们进行排序。然后我必须将它们彼此相减才能找到它们之间的差异，然后在两个 for 循环中比较数组元素的差异。

所以这是我的代码

```
Timport java.util.ArrayList;

public class algorithm {
int j;
int i;
int key;

public algorithm() {
    super();
    // TODO Auto-generated constructor stub
}

public ArrayList<Integer> sortingFunction(ArrayList<Integer> array){
    for(j=1;j<array.size();j++){
            key = array.get(j);
            i = j - 1;          
        while (i>=0 && array.get(i)>key){
            array.set(i+1, array.get(i));
            i = i - 1;  
        }
        array.set(i+1, key);
    }
    return array;
}

public int calculationFunction(ArrayList<Integer> array){
    int sum = 0;
    for(int x = 0; x<array.size(); x++){
        sum += array.get(x);
    }
        return sum;
}

public void writingFunction(ArrayList<Integer> array){
    for(int x = 0; x<array.size(); x++){
        System.out.print(array.get(x)+"  ");
    }
    System.out.println();
}

public void twoSumsEqualAlgorithm (int x, int y, ArrayList<Integer> array1, ArrayList<Integer> array2 ){
    int x_copy = x;
    int y_copy = y;
    //System.out.println(x);
    //System.out.println(y);
    for(int i = 0; i<array2.size(); i++){
        x_copy = x + (array2.get(i) * 2);
        //System.out.print("x;"+ x_copy);
        //System.out.println("  y;"+ y);
        if(x_copy >= y){
            for(int j = 0; j<array1.size(); j++){
                y_copy = y + (array1.get(j) * 2);
                if(x_copy == y_copy){
                    System.out.print("we have found the true values; ");
                    System.out.print("'"+array1.get(j)+"'"+" from myArray1("+j+ ") and ");
                    System.out.println("'"+array2.get(i)+"'"+" from myArray2("+i+")");
                    //return;
                }
                else if(x_copy < y_copy){
                    //System.out.println("x is lower than y");
                    break;
                }
            }
        }

    }

}

private void exit(int k) {
    // TODO Auto-generated method stub

}

} 
```

这是测试部分

```
import java.util.ArrayList;

public class test {

/**
 * @param args
 */
public static void main(String[] args) {
     ArrayList<Integer> myArr1 = new ArrayList<Integer>();
     ArrayList<Integer> myArr2 = new ArrayList<Integer>();
     algorithm alg = new algorithm();

     myArr1.add(8);
     myArr1.add(4);
     myArr1.add(2);
     myArr1.add(15);
     myArr1.add(10);
     myArr1.add(16);
     myArr1.add(1);
     myArr1.add(11);

     myArr2.add(5);
     myArr2.add(3);
     myArr2.add(7);
     myArr2.add(6);
     myArr2.add(19);
     myArr2.add(2);
     myArr2.add(12);
     myArr2.add(1);
     myArr2.add(0);

     myArr1 = alg.sortingFunction(myArr1);
     myArr2 = alg.sortingFunction(myArr2);

     System.out.print("myArray1; ");
     alg.writingFunction(myArr1);
     System.out.print("myArray2; ");
     alg.writingFunction(myArr2);

     System.out.print("sum of myarray1; ");
     System.out.println(alg.calculationFunction(myArr1));
     System.out.print("sum of myarray2; ");
     System.out.println(alg.calculationFunction(myArr2));

     alg.twoSumsEqualAlgorithm(alg.calculationFunction(myArr1), alg.calculationFunction(myArr2), myArr1, myArr2);

}

} 
```

所以我认为当我计算算法的复杂度时，它是 O(n^2)。我读了一些帖子，上面说我可以用 O(nlgn) 复杂度做同样的工作。

> 比较两个数组列表的方式可以导致 a 较低的 big-O 但使用 >sorting。
> 
> 您可以使用合并排序或快速排序 O(nlg(n)) 对每个数组列表进行排序，然后在 O(n) 中比较两个 > 排序列表。结果是 O(nlgn)。
> 
> 但是另一种算法（没有排序）将遍历一个数组（n）中的每个元素。然后 >then 检查该元素是否是另一个数组 (n)（并标记它以正确处理重复项）。后一种算法是 O(n^2)。
> 
> > [比较两个排序的 int 数组](https://stackoverflow.com/questions/4758118/comparing-two-sorted-int-arrays)

所以我只是无法实施。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:22:22.853

所以你需要解决 xi-yj == (XY)/2

对 y 数组进行排序并在 x 数组上循环。对于每个 x_i，在 y 数组中对 (XY)/2-xi 进行二分搜索。如果你发现什么停止，否则继续。排序的复杂度为 O(n log n)。每次查找的复杂度为 O(log n)，您最多需要 n 次查找 --> 总复杂度为 O(n log n)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:24:50.333

你想要做的不是两个数组的比较。它的设计相似，但我会像这样解决一个完全不同的任务：

1）合并排序或快速排序两个集合。如果设计得当，这是 O(nlgn)。

2) 将集合 x 和集合 y 中的数字相加，计算 XY 为差 D.O(n)。

3) （假设 D 为负）对 x 从小到大进行扫描，对 y 从大到小进行扫描。*对于 x 扫描中的*每个元素，检查 y 扫描中的每个元素，直到交换 x 和 y 会使 D 过去为零。如果发生这种情况，推进 x 并继续检查 y 扫描中的元素（例如，不要在每次推进 x 扫描时重置 y 扫描）。

如果你让 D 准确地达到零，那么你已经找到了你的交换。这是最坏的 O(n)，因为您只读取 x 的元素一次，并且最多读取 y 的元素 x.length+y.length 次。

4）（假设 D 为正）执行与上述类似的逻辑，但从最大到最小扫描 x，从最小到最大扫描 y。

# ios - 在嵌入 UINavigationController 的视图控制器之间传回数据

> ID：15396655
> 
> 赞同：0
> 
> 时间：2013-03-13T21:17:40.363
> 
> 标签：ios, objective-c, xcode, delegates, uinavigationcontroller

我将视图控制器嵌入到具有一个属性（非原子强 NSMutableArray *myData）的导航控制器中，当我推送第二个视图时，我还使用此方法将数组数据传递给该视图：

```
 -(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {  
      if ([[segue identifier] isEqualToString:@"secondView"]) {
          SecondViewController *svc = [segue destinationViewController];
          svc.myDataInSecondView = self.myData;
     } 
```

我的问题是：为什么如果我更改 myDataInSecondView 数组中的任何值，然后我会回到第一次查看 myData 数组中的值也更改了？我一直认为我必须使用自定义协议和委托将任何数据传递回之前的视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:31:44.970

您这样做的方式是在视图控制器之间共享数据的一种非常常见的方式。第二个视图控制器具有可以由第一个视图控制器设置的属性。该属性是一个指针，与第一个视图控制器中的相同。两者都指向内存中的同一位置，因此任何一个视图控制器都可以更改相同的数据。

如果您不希望第二个视图控制器更改数据，请将属性设置为`copy`.

```
@property (nonatomic, copy) MyData *myData; 
```

# uiview - 如何在 UIImage 中放置一个按钮来确定不同的选择？

> ID：15396658
> 
> 赞同：0
> 
> 时间：2013-03-13T21:17:58.120
> 
> 标签：uiview, uiscrollview, uiimageview, uibutton, uiimage

我有一个带有 UIScrollView 的 UIView。然后，我以编程方式向 scrollView 添加了一个手势识别器，用于向左或向右滑动。

我创建了 3 个 UIImageView，每个都有不同的 UIImage，比如 1、2 和 3。

我得到了它，所以每次滑动都会将新的 UIImageView 移动到视图的中心。但是现在我需要区分被点击的图像。实际的点击将启动服务器请求并获取数据，但我必须确定被点击的 UIImageView，因为每个 UIImage 都不同，并将向用户呈现服务器响应和点击的图像。

每个 UIImageView 实际上都有一个标签集；1, 2 & 3\. 我的问题是，如何添加 UIButton/IBAction 到它？我正在考虑添加一个 UIButton 作为每个 UIImageView 的“子项”，但我不确定它是否可以完成，我不知道它是否是实现我想要的最佳方式，即能够区分哪个 UIImageView 被选中用户。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T02:38:28.697

我最终使用了一个带有背景图像的按钮，而不是具有类似按钮反应性的图像。

```
fourthButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [fourthButton addTarget:self action:@selector(buttonHandler) forControlEvents:UIControlEventTouchDownRepeat];
    [fourthButton setTitle:@"SomeCardButton" forState:UIControlStateNormal];
    [fourthButton setImage:[UIImage imageNamed:@"MyCard-Value.png"] forState:UIControlStateNormal];
    [fourthButton setFrame:CGRectMake(0.0, 0.0, 40.0, 40.0)]; 
```

# php - 在php中从数组中删除元素

> ID：15396661
> 
> 赞同：-1
> 
> 时间：2013-03-13T21:18:14.567
> 
> 标签：php, arrays, loops

我有一个看起来像这样的数组

```
 $hours_worked = array('23',0,'24',0) 
```

想要做的是遍历数组并删除包含0的元素

到目前为止，我所拥有的是：

```
for($i = 0; $i < count($hours_worked); $i++) 
{
   if($hours_worked[$i] === 0 )
   {
       unset($hours_worked[$i]);
   }    
} 
```

但是我得到的结果是`$hours_worked = array(23,24,0)`. 即它不会从数组中删除最后一个元素。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:26:08.120

这段代码的问题是你`count($hours_worked)`每次迭代都在计算；一旦你删除了一个项目，计数就会减少，这意味着对于每个删除的项目，循环将在看到数组末尾的一个项目之前终止。因此，解决它的直接方法是将计数拉出循环：

```
$count = count($hours_worked);
for($i = 0; $i < $count; $i++) {
   // ...
} 
```

That said, the code can be further improved. For one you should always use `foreach` instead of `for` -- this makes the code work on all arrays instead of just numerically indexed ones, and is also immune to counting problems:

```
foreach ($hours_worked as $key => $value) {
    if ($value === 0) unset($hours_worked[$key]);
} 
```

You might also want to use [`array_diff`](http://php.net/manual/en/function.array-diff.php) for this kind of work because it's an easy one-liner:

```
$hours_worked = array('23',0,'24',0);
$hours_worked = array_diff($hours_worked, array(0)); // removes the zeroes 
```

If you choose to do this, be aware of how `array_diff` compares items:

> Two elements are considered equal if and only if `(string) $elem1 === (string) $elem2`. In words: when the string representation is the same.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-13T21:21:49.557

尝试使用 foreach 循环

```
$new_array = array();
foreach($hours_worked as $hour) {
   if($hour != '0') {
      $new_array[] = $hour;
   }
}
// $new_array should contain array(23, 24) 
```

# c++ - 如何在 C++ 中检查对象的类型

> ID：15396665
> 
> 赞同：0
> 
> 时间：2013-03-13T21:18:22.883
> 
> 标签：c++

在java中，有一个关键字“instanceof”，可以用来判断对象的类型。在 C++ 中，到目前为止我发现的唯一解决方案是使用 dynamic_cast。这种方法不仅不好，而且非常昂贵。它不好的原因是控制流是由捕获异常驱动的。在我看来，异常应该只用于“异常”情况，而不是控制代码的主要流程。

想象一个用例，其中网络处理程序可以接收不同类型的消息。这个处理程序可以有一个很长的 try catch 块列表，每个块都尝试一个 dynamic_cast。有可能对于每条消息，都会引发许多异常，直到流最终找到正确的类型。这也会降低应用程序的性能，因为捕获异常并不便宜。

您能否建议 dynamic_cast 的替代方案，类似于 java 的 instanceof 运算符，以便我可以避免异常捕获开销？

更新：RTTI 以外的任何解决方案都会很棒，因为 RTTI 也很昂贵。也许，我可以将字符串名称放在消息中并将字符串映射到对象？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T21:21:28.793

您正在寻找[`typeid`](http://en.cppreference.com/w/cpp/language/typeid)运营商。这会返回[`type_info`](http://en.cppreference.com/w/cpp/types/type_info)对象，可以比较它们是否相等。或者，`dynamic_cast`返回 null 而不是抛出异常的指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:54:04.950

如果您通过网络对对象进行序列化，我假设您有某种工厂可以通过网络重新创建它们。

工厂有一个 switch 语句，或者一个映射或其他东西，可以让你创建正确的对象。它不使用运行时类型信息。

您创建的对象将有一些共同的基础。从那里创建您的层次结构。如果层次结构中的所有对象都没有一些共同的行为，请使用该`Visitor`模式动态添加行为：

```
struct Derived;

struct Visitor {
    virtual void visit(Derived& derived) = 0;
};

struct Base {
    virtual void accept(Visitor& visitor) = 0;
};

struct Derived : Base {
    virtual void accept(Visitor& visitor) {
        visitor.visit(*this);
    }
}; 
```

当您有一个相对稳定的层次结构并且想要一组可变的行为时，该`Visitor`模式最合适。如果你有一个不稳定的层次结构，但有一组稳定的行为，你可以做正常的事情，让`Base`类接口定义派生类要实现的行为。

# php - 将 mysql 转换为 mysqli 时出现数据库连接问题

> ID：15396670
> 
> 赞同：0
> 
> 时间：2013-03-13T21:18:30.490
> 
> 标签：php, include, mysqli

好的，所以我正在努力将我的网站更新为 mysqli，并且我在使用 DB.php 包含用于 db 连接时遇到了困难。

所以我的 db.php 看起来像这样。

```
<?php
$username="usern";
$server="server";
$password="pwd";
$database="db";

//MySQLi methods
$mysqli = new mysqli($server, $username, $password, $database)  or trigger_error ( mysqli_connect_errno().mysqli_connect_error() );
?> 
```

注意：sql 错误输出用于调试我知道输出 sql 和详细错误不是好习惯；）

无论如何，这样就可以了。

将 db.php 文件更新为 mysqli 后，我遇到了所有使用该文件的页面的问题。基本上即使包含我在第 21 行的 \display_functions.php 中得到以下错误 mysqli 致命错误：在第 21 行的 r\includes\display_functions.php 中的非对象上调用成员函数 query()

该文件的相关部分是：

```
function showConfig ($configID)
{
    date_default_timezone_set('America/Denver');
    require_once($_SERVER["DOCUMENT_ROOT"] . "/includes/DB.php");
    $tbl_name="avr";
    // Get information from DB for display    
    $configQuery="SELECT * FROM $tbl_name WHERE configID=$configID";
    $configResult=$mysqli->query($configQuery);
  <some more code>
} 
```

当这都是 mysql 时，它工作了，现在它没有，我不确定为什么。我认为 include 语句应该从记录的文件中引入所有内容，但使这个函数（以及其他类似函数）工作的唯一方法是基本上将 DB.php 的内容放入函数中。这当然是一种可怕的做法。

此外，仍然需要学习所有这一切，所以请原谅这个无知的问题，但这只是本周末时区更改的问题，我将如何设置默认时区功能，这样我就不必把它放在所有东西中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:24:16.420

函数内部的 $mysqli 具有本地范围。它不是同一个变量。您需要将 $mysqli 作为参数传递

```
function showConfig ($configID, $mysqli) 
```

或在函数内使用全局声明

```
function showConfig ($configID)
{
    global $mysqli; 
```

# excel - Excel-比较来自不同工作表的两个单元格，如果来自其他单元格的真实复制值

> ID：15396677
> 
> 赞同：2
> 
> 时间：2013-03-13T21:18:55.673
> 
> 标签：excel, excel-2007, excel-formula, excel-2010, vlookup

所以，我有一个工作表A和工作表B。

我想比较两张纸上的 A 列。

如果该值相同（true），则从工作表 B 中的 F 列复制值（该值是电子邮件地址，当然每一行都不同）。

我尝试使用 VLOOKUP，但我无法弄清楚。我的excel知识很差。

请提供任何帮助。谢谢

编辑：我想检查第一张表中的公司名称与另一张表中的所有公司名称。对于那些相同的，复制电子邮件（我只有在 sheet2 中）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:24:50.300

在您的目标字段中，您想像这样使用 VLOOKUP：

```
=VLOOKUP(Sheet1!A1:A100,Sheet2!A1:F100,6,FALSE) 
```

VLOOKUP 参数：

1.  您要查找的集合字段。
2.  您要查找值的表格范围。您定义的表的第一列应该是您想要与查找字段进行比较的列。表格范围还应包含您要显示的值（F 列）。
3.  这定义了您希望在匹配时显示的字段。
4.  FALSE 告诉 VLOOKUP 进行完全匹配。

# php - 通过 JQuery 将复选框值发布到 PHP 中

> ID：15396678
> 
> 赞同：0
> 
> 时间：2013-03-13T21:18:58.327
> 
> 标签：php, jquery, variables, checkbox

我创建了一个带有“让我登录”复选框的用户登录表单，我试图通过 JQuery 将值传递给将处理信息的 PHP 文件，但我不确定要使用的正确代码。这是我到目前为止所得到的：

```
var username=$("#username").val();
var password=$("#password").val();
var checkbox=$("#checkbox").val();

if(usernameok == true && passwordok == true)
{           
    $('.validation').html("Logging In").removeClass("error").addClass("success");
    jQuery.post("php/login.php", {
    username:username,
    password: password,
    checked: checked
    },  function(data, textStatus){
    if(data == 1){
        window.location.replace("home.php");
    }
    else{
        $('.validation').html("Wrong Password Given").removeClass("success").addClass("error");
    }
    });
} 
```

然后在 Login PHP 页面中，我使用 Request 如下：

```
$username= mysql_real_escape_string($_REQUEST["username"]);
$password= md5(mysql_real_escape_string($_REQUEST["password"]));
$checkbox= mysql_real_escape_string($_REQUEST["checkbox"]); 
```

用户名和密码值很好，但我无法通过复选框。我知道那里可能应该有一个 :checked 语句，但我不确定该放在哪里。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:31:03.110

您需要检查复选框是否被选中（真/假），而不是得到它的价值。然后在 ajax 函数中使用正确的变量来传递它：

```
var username = $("#username").val();
var password = $("#password").val();
var checkbox = $("#checkbox").is(':checked');

if(usernameok == true && passwordok == true)
{           
    $('.validation').html("Logging In").removeClass("error").addClass("success");
    jQuery.post("php/login.php", {
        username:username,
        password: password,
        checked: checkbox
    },  function(data, textStatus){
        if(data == 1){
            window.location.replace("home.php");
        }else{
            $('.validation').html("Wrong Password Given").removeClass("success").addClass("error");
        }
    });
} 
```

另一方面，如果您打算做的只是重定向，为什么要使用 ajax，您可以使用常规表单提交更容易做到这一点？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:34:48.980

```
var checkbox = ( $("#checkbox").is(":checked") ) ? "checked" : "not checked"; 
```

这是 if 语句的简写，或者如果您更喜欢常规 if 语句：

```
if( $("#checkbox").is(":checked") ){
    var checkbox = "checked";
} else {
    var checkbox = "not checked";
} 
```

# javascript - 传递按钮 ID 的 Switch 语句无法正常工作

> ID：15396687
> 
> 赞同：0
> 
> 时间：2013-03-13T21:19:17.233
> 
> 标签：javascript, jquery

我正在尝试使用 switch 语句`switch (buttionId)`，传入我选择的按钮的 id，但是，该函数没有正确触发。这是我的功能：

```
function PickDiagCode(btnNum, button) {
        var txtID;
        var strId;
        //var buttonId = $("input[id*=btnHeaderDiagPick]").attr("id");
        switch (button.value) {
            case "Clear":
                switch (button.id) {                    
                        case "btnHeaderDiagPick1":
                           //Do Work

                        case "btnHeaderDiagPick2":
                           //Do Work 
```

以下是按钮：

```
 <input class="Button-Search" id="btnHeaderDiagPick1" onclick="document.frmCrgEntry.hdnPickClrDiagCode.value='1';PickDiagCode('1',btnHeaderDiagPick1);"
                                    type="button" name="btnHeaderDiagPick1" runat="server" />
    <input class="Button-Search" id="btnHeaderDiagPick2" onclick="document.frmCrgEntry.hdnPickClrDiagCode.value='2';PickDiagCode(2,btnHeaderDiagPick2);"
                                type="button" name="btnHeaderDiagPick2" runat="server" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:20:41.523

你错过了`document.getElementById()`

```
switch (btnID.value) { 
```

改成

```
switch (document.getElementById(btnID).value) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:37:11.987

您的问题似乎是这样的：

```
document.frmCrgEntry.hdnPickClrDiagCode.value='1'; 
```

如果你删除它一切正常。[这是一个小提琴](http://jsfiddle.net/3aWYa/17/)，一个按钮有，一个没有。删除它的按钮可以正常工作（用于调用函数）

# ruby-on-rails-3 - 没有活动记录的嵌套属性

> ID：15396691
> 
> 赞同：3
> 
> 时间：2013-03-13T21:19:37.967
> 
> 标签：ruby-on-rails-3, model-view-controller, nested-attributes

我正在尝试创建一个不保留到数据库但传递到第三方系统的发票系统。因此，我的模型不是 ActiveRecord，因为没有要持久化的表。如何在我的发票模型中接受发票行项目的嵌套属性？

这是我的表单中生成的参数的示例

```
{"payportal_invoice"=>{"invoice_lines"=>{"quantity"=>["1", "2"], "units"=>["hours", "hours"], "price"=>["10", "20"], "description"=>["desc", "d"]}, "dueDate"=>"10/10/2013", "invoiceNumber"=>"3.13.13.11:47", "description"=>"notes"}, "attachment_name"=>""} 
```

我可以轻松地从此参数集创建发票模型，但不确定如何创建行项目

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-29T04:55:07.073

您是否尝试过使用无表 gem，例如[https://github.com/softace/activerecord-tableless](https://github.com/softace/activerecord-tableless)？

我过去曾将它们用于类似的情况——您可以进行所有标准验证等，但无需调用 ActiveRecord。

# java - 在 Runtime.getRuntime().exec() 完成执行之前，不会显示 Swing 消息

> ID：15396694
> 
> 赞同：0
> 
> 时间：2013-03-13T21:19:49.090
> 
> 标签：java, swing, process

我是 Swing 的新手。我正在尝试创建一个摆动包装器以允许用户浏览和选择一个文件夹，并且该文件夹路径用作控制台 .exe 程序的命令行参数。在他们选择文件夹并单击“启动程序”按钮后，我希望摆动窗口显示一条消息，告诉他们程序正在处理（并显示时钟的动画 gif），运行外部程序，然后显示另一条消息当该程序完成执行时。我遇到的问题是“处理中”消息直到外部程序完成执行后才会显示。在下面的代码中，单击“启动程序”按钮时会执行 onLaunchProgram 方法。我试过 revalidate() 和 repaint()，但没有任何变化。

```
 ...

    JTextField txtFolder = new JTextField();
    JLabel lblMessage = new JLabel();
    JLabel lblPic = new JLabel();
    JButton btnLaunchApplication = new JButton("Launch Program");  

    ...  

    btnLaunchApplication.addActionListener(new ActionListener() {  
        public void actionPerformed(ActionEvent evt) {  
            onLaunchProgram(evt);  
        }  
     });  

    ...

    if (returnVal == JFileChooser.APPROVE_OPTION){
        file = fc.getSelectedFile();
        txtFolder.setText(file.getAbsolutePath());
    }

    ...

    private void onLaunchProgram(ActionEvent evt) {
        String strExecutableFilename = "MyExecutableProgam";
        String strSourceFolder = txtFolder.getText();
        String strCommand = strExecutableFilename + " " + strSourceFolder;
        lblMessage.setText("Processing");
        ImageIcon icon = new ImageIcon("clock.gif");
        lblPic.setIcon(icon);
        try {
            Process procCommand = Runtime.getRuntime().exec(strCommand);
            try {
                procCommand.waitFor();
            } catch (InterruptedException exception) {
                exception.printStackTrace();
            } finally {
            }
            lblMessage.setText("Finished");
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T23:24:22.837

从您的示例代码中很难确定您是如何执行该`onLaunchProgram`方法的，但根据您的描述，假设您在事件调度线程的上下文中执行它是一个安全的节拍。

事件调度线程负责（除其他外）调度重绘请求。任何阻塞该线程的东西都会阻止它更新 UI。

因为`procCommand.waitFor()`是一个阻塞动作，所以这将阻止任何重绘请求（或任何与此相关的事件）被处理，直到它返回。

您应该在单独的线程中执行所有耗时或阻塞的进程。但是，您遇到的问题是 UI 桅杆的所有更新都在 EDT 的上下文中执行（也就是说，您永远不应该从除 EDT 之外的任何线程更改/更新/修改/创建任何 UI 组件）

在 Swing 中，您有很多选择，在您的情况下，我建议使用`SwingWorker`. 它将允许您在后台线程中执行该进程，但有一些易于使用的方法来重新同步 UI 更新。

```
public class ProcessWorker extends SwingWorker<Integer, String> {

    private String program;
    private String sourceFolder;

    public ProcessWorker(String program, String sourceFolder) {
        this.program = program;
        this.sourceFolder = sourceFolder;
    }

    @Override
    protected void process(List<String> chunks) {
        // Back on the EDT
        for (String value : chunks) {
            if (value.equalsIgnoreCase("PROCESSING")) {
                lblMessage.setText("Processing");
                ImageIcon icon = new ImageIcon("clock.gif");
                lblPic.setIcon(icon);
            } else if (value.equalsIgnoreCase("FINISHED")) {
                lblMessage.setText("Finished");
            } else {
                // Possible some other message...
            }
        }
    }

    @Override
    protected Integer doInBackground() throws Exception {
        int result = -1;

        String strExecutableFilename = program;
        String strSourceFolder = sourceFolder;
        String strCommand = strExecutableFilename + " " + strSourceFolder;
        publish("PROCESSING");
//        lblMessage.setText("Processing");
//        ImageIcon icon = new ImageIcon("clock.gif");
//        lblPic.setIcon(icon);
        try {
            ProcessBuilder pb = new ProcessBuilder(program);
            pb.redirectError();
            pb.directory(new File(strSourceFolder));
            Process procCommand = pb.start();
//            Process procCommand = Runtime.getRuntime().exec(strCommand);
            try {
                result = procCommand.waitFor();
            } catch (InterruptedException exception) {
                exception.printStackTrace();
            } finally {
            }
//            lblMessage.setText("Finished");
            publish("FINISHED");
        } catch (IOException e) {
            e.printStackTrace();
        }

        return result;
    }
} 
```

您还应该熟悉`ProcessBuilder`. 它有许多用于构建流程的有用方法，并克服了人们在尝试开始`Runtime.getRuntime().exec`工作时遇到的一些困难。

您应该查看[http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)了解更多详细信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:24:38.023

看来您正在一个线程中完成所有操作。

使用事件调度线程来调用你的 gui 代码。

```
private void onLaunchProgram(ActionEvent evt) {
        String strExecutableFilename = "MyExecutableProgam";
        String strSourceFolder = txtFolder.getText();
        String strCommand = strExecutableFilename + " " + strSourceFolder;
        ImageIcon icon = new ImageIcon("clock.gif");
        javax.swing.SwingUtilities.invokeLater(
            new Runnable() {
                 public void run() {
                     lblMessage.setText("Processing");
                     lblPic.setIcon(icon);
                 }
            });

        try {
            Process procCommand = Runtime.getRuntime().exec(strCommand);
            try {
                procCommand.waitFor();
            } catch (InterruptedException exception) {
                exception.printStackTrace();
            } finally {
            }

            javax.swing.SwingUtilities.invokeLater(
                new Runnable() {
                    public void run() {
                      lblMessage.setText("Finished");
                    }
                 });
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
        }
    } 
```

# android - 在 android 4.2 上禁用主页按钮

> ID：15396697
> 
> 赞同：-6
> 
> 时间：2013-03-13T21:20:05.900
> 
> 标签：android

我想禁用 android 4.2 上的主页按钮以防止用户关闭应用程序。我读到我不能直接在 4.2 上捕获主页按钮事件，所以我可能需要实现一些主屏幕应用程序？我想知道是否有任何示例代码可以简单地显示此功能（目标不允许用户关闭程序。也许可以在按键时重新运行程序）。

在此先感谢您的帮助，雷

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T22:28:33.100

让您的应用成为主屏幕。然后，按 HOME 将使用户返回到您的应用程序。您的 SDK 安装中有一个 Home SDK 示例（如果您选择下载 SDK 示例）。基本上，您需要一个`<intent-filter>`活动，例如：

```
 <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.HOME"/>
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter> 
```

# ruby - 来自 txt 的最新文件数组读取所有文件

> ID：15396702
> 
> 赞同：0
> 
> 时间：2013-03-13T21:20:13.060
> 
> 标签：ruby, regex, arrays

我有一个包含多个条目的文本文件。格式是固定的，是`name_version_versionNumber`.

```
**example.txt**
cool_name_A_001
something_else_WIP_002
something_else_001
cool_name_B_002
other_thing_010
other_thing_006 
```

退货清单应消除 WIP 条目，并提供最新（最高数量）版本。上面文本文件的输出应该是

```
cool_name_A_001
cool_name_B_002
other_thing_010
something_else_001 
```

到目前为止，我有

```
#import files
x = File.readlines("path to txt file").delete_if {|x| x.scan(/[WIP]../).include? "WIP"}.sort

#include latest copy only
#include latest copy only
def latest_version(x)
list = []
i = 0
while i<x.length
    if list.map {|x| x.scan(/\D+/)}.flatten.include? x[i].scan(/\D+/)
        zet = list.map {|x| x.scan(/\D+/)}.flatten.rindex x[i].scan(/\D+/)
        if list[zet].scan(/\d+/) > x[i].scan(/\d+/)
            i+=1
        else 
            list[zet] = x[i]
            i+=1
        end
    elsif x[i].scan(/\D+/) == x[i+1].scan(/\D+/)
        if x[i].scan(/\d+/) > x[i+1].scan(/\d+/)
            list << x[i]
            i+=1
        else
            list << x[i+1]
            i+=1
        end
    else
        list << x[i]
        i+=1
    end
  end
  list
end

puts latest_version(x) 
```

我收到以下错误

```
rb:10:in `latest_version': private method `scan' called for 114:Fixnum (NoMethodError) 
```

error 方法在 irb 中有效，无法弄清楚为什么会出错？此外，无法判断逻辑是否实现了预期的结果。请帮忙！谢谢 ：）

```
1.9.3p374 :098 > y
 => ["something_SA_R33\n", "whatever_SA_R012\n", "anything_SB_R012\n"]
1.9.3p374 :099 > y.map {|x| x.scan(/\d+/)}.flatten
 => ["33", "012", "012"] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:30:54.540

以相反的顺序对它们进行排序，然后遍历所有元素，删除所有 WIP 元素并保存每个组中的第一个（匹配 ^/(.*?)_\d{3}$/）不是更容易吗? 所有这些扫描看起来都很脆弱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:38:53.203

非常值得怀疑的是真的需要创建如此复杂的方法。Ruby 有很多方法可以让生活更轻松。

So, your one of your mistakes is to use same names for method argument `latest_version(x)` and for map iteration `list.map{|x| ... }`. It is not very good practice

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:56:19.600

I'd use something like:

```
data = %w[
  cool_name_A_001
  something_else_WIP_002
  something_else_001
  cool_name_B_002
  other_thing_010
  other_thing_006
]

data.reject{ |s| s['_WIP_'] }.group_by{ |s| s[/\A(.+)_\d+/, 1] }.map{ |k, v| v.max }.sort
[
    [0] "cool_name_A_001",
    [1] "cool_name_B_002",
    [2] "other_thing_010",
    [3] "something_else_001"
]

```

To read from a file replace `data` with `x = File.readlines("path to txt file")`.

But that's just me.

# android - 在资产中使用 SQLite 数据库而不在 Android 上复制它

> ID：15396705
> 
> 赞同：2
> 
> 时间：2013-03-13T21:20:15.907
> 
> 标签：android, sqlite

复制 .sqlite 文件需要太多时间。我可以在资产文件夹中使用它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:23:25.577

> 复制 .sqlite 文件需要太多时间。我可以在资产文件夹中使用它吗？

如果您将放置**.db**文件放在那里，那么它肯定会起作用，但这不是最好的选择，但这取决于更多的事情。有效的方法是将文件放在 SD 卡上，只提供读取。如果您的 db 文件更大，这很有用。

但所有可能的方法都有优点和缺点。例如，如果 db 文件很大，将数据库放在 sd 卡上并不是很安全，但很有效。如果您有例如 200 MB 的 db 文件，您是否想象过这种情况。将其放入资产文件夹是“病态”。

此外，它还取决于应用程序的特性、假定的数据库大小、所需的性能等。

这是您要从中读取的基本代码片段：

```
 db = SQLiteDatabase.openDatabase(db_path, null, SQLiteDatabase.NO_LOCALIZED_COLLATORS | SQLiteDatabase.CREATE_IF_NECESSARY);
        if (db != null && db.isOpen()) {
            return db;
        }
        return null; 
```

# fortran - 如何修复此堆栈缓冲区嵌套太深的错误？

> ID：15396706
> 
> 赞同：1
> 
> 时间：2013-03-13T21:20:16.687
> 
> 标签：fortran, doxygen, fortran90, documentation-generation

我正在使用 Doxygen 的便携式版本 1.8.3.1。作为 Doxygen 的新手，我在创建 Fortran 源代码文档时遇到了问题。代码在 Fortran 90 中，大约有 6200 行，我正在使用 doxywizard 创建配置文件并在必要时运行 Doxygen。

我知道 Doxygen 需要针对我计划稍后添加的评论的特定评论规则，但现在我有兴趣创建源文档，如调用树、变量索引等。

这些是 Doxygen 的日志结果：

```
Searching for files in directory E:/test
Reading and parsing tag files
Reading E:/test/test1.f90...
Parsing file E:/test/test1.f90...
Exiting...
Stack buffers nested too deeply
*** Doxygen has finished 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T17:46:22.097

在原始问题中缺少有关版本的重要信息：1.8.3

问题是“堆栈缓冲区嵌套太深”

在 doxygen 中，错误消息是由于对例程 pushBuffer 的深度嵌套调用而给出的，该例程使用大小为 10 的堆栈。当您在一行中有相当多的语句时会发生这种情况的一种情况，例如：我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；我=1；

已在 Doxygen 的 Bugzilla 中针对此问题提交了错误报告和补丁（请参阅错误 695974 - Fortran：堆栈缓冲区嵌套太深 bugzilla.gnome.org/show_bug.cgi?id=695974）

该错误已在 doxygen 版本 1.8.4 中修复。

# python - 如何创建文件系统监视器以捕获对文件所做的每一次更改

> ID：15396708
> 
> 赞同：-3
> 
> 时间：2013-03-13T21:20:22.523
> 
> 标签：python, linux, windows, file, filesystems

我想创建一个文件系统监视器，它会在文件系统上的任何文件发生更改时发出通知，尤其是写入、新文件创建或重命名。

我做了研究，发现了`FindFirstChangeNotification`函数，pyinotify 之类的东西

如何访问日志并使用它来执行上述操作？

然后软件将使用任何文件更改进行进一步计算，如何进行？

平台：Windows（优先）、Linux

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:30:39.090

你应该看看[watchdog](https://pypi.python.org/pypi/watchdog)，它是一个用于监控文件系统的 python 库，适用于 Linux 和 Windows。

从 watchdog.observers 导入时间 从 watchdog.events 导入观察者 导入 LoggingEventHandler

```
if __name__ == "__main__":
    event_handler = LoggingEventHandler()
    observer = Observer()
    # you may need to use path='c:\' for windows below
    observer.schedule(event_handler, path='/', recursive=True)
    observer.start()
    try:
        while True:
            time.sleep(1)
    except KeyboardInterrupt:
        observer.stop()
    observer.join() 
```

您可能想`LoggingEventHandler`用您自己的类替换，该类派生自[`FileSystemEventHandler`](http://pythonhosted.org/watchdog/api.html#event-handler-classes)、实现`on_created`、`on_modified`等。

最后请注意，查看整个系统上的每个文件可能会导致您遇到可伸缩性问题。您最好尝试缩小要监控的范围。

# javascript - javascript 模板 html

> ID：15396709
> 
> 赞同：0
> 
> 时间：2013-03-13T21:20:26.717
> 
> 标签：javascript, html, json, templates

我正在使用这个函数通过 javascript模板化**HTML ：**

```
 parseTemplate = function(tmpl, data) {
   var regexp;

  for (k in data) {
     regexp = new RegExp('{' + k + '}', 'g');
     tmpl = tmpl.replace(regexp, data[k]);
    }
   return tmpl;
   } 
```

像这样的`JSON`对象

```
JSONdata = { 
  prop1 : val,
  prop2 : val,
  prop3 : {
           prop1of3 : 
           prop2of3 :
           ...
           }
  ... 
  } 
```

使用花括号 in`HTML`和 righe `template`，我可以渲染所有元素，例如`prop1`or `prop2`。否则我无法渲染，例如，，`prop1of3`因为函数无法找到（？）它。您能否建议一种解决方案来呈现这种 JSON 对象中元素的属性？jQuery 很受欢迎

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:35:01.197

...您正在使用从 RegEx 中提取的字符串。

因为你正在使用一个字符串，`data["prop1.sub_prop2"]`所以如果你真的想得到`data.prop1.sub_prop2`.

所以要么你需要让你的对象变浅：

```
data = {
    prop1 : "",
    a_obj_prop_1 : "",
    a_obj_prop_2 : ""
}; 
```

...这不会让生活变得更轻松...

...或者您需要从 RegEx 中获取字符串，并检查它`.`是否存在，如果它们在那里，则将字符串拆分为一个数组，然后遍历该数组，抓住下一个对象。 .

```
var parts_arr = "obj_a.client.id".split("."),
    key,
    item = data;

while (parts_arr.length > 0) {
    key = parts_arr.shift();
    item = item[key];
} 
```

完成后，`item`应该等于 last 后面的内容`.`。

当然，如果`.`模板中没有，那么你想完全跳过这个。
您也可以递归地编写它。

有各种各样的方法可以让这个工作。

希望这个很清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T22:36:51.110

这是我个人使用的一个很好的例子。

[http://jsfiddle.net/g9e6u/](http://jsfiddle.net/g9e6u/)

诀窍是用正则表达式匹配分支的内部，然后使用闭包来决定用什么替换匹配项。在这种情况下，`_renderProperty()`决定值应该是什么。该函数获取上下文`ctx`并将匹配的字符串附加`name`到它。所以匹配`hobbies.beach`将被评估为`ctx.hobbies.beach`。`eval`进行评估并将最终值分配给名为 的变量`value`。作为奖励，您也可以在大括号内使用 javascript。

```
function Template(html) {
    this.html = html;

    this.render = function (context) {
        var self = this;
        return this.html.replace(/\{(.+?)\}/g, function (full, group) {
            return self._renderProperty(group, context);
        });
    }

    this._renderProperty = function (name, ctx) {
        var value;
        eval('value = ctx.' + name);
        return value;
    }
};

var context = {
    name:'John Doe',
    age: 200,
    hobbies: {
        beach:'I like walking there',
        flute:'Sounds like an angel',
        deep: {
            sea:'deep sea diving'
        }
    }
};

var t = new Template("My name is {name.replace(/o/, 'X')}, {age} years old. One of my hobbies is the beach because {hobbies.beach}. I also like {hobbies.deep.sea.toUpperCase()}");

var output = t.render(context);
alert(output); 
```

# mongodb - “域”文档的好 mongodb 分片键

> ID：15396718
> 
> 赞同：0
> 
> 时间：2013-03-13T21:20:56.810
> 
> 标签：mongodb, sharding

我想为这样的文档找到合适的分片键：

```
{
  "_id": "yahoo.com",
  "c": {
    "en": {
      "bdy": ",
      "cats": [],
      "mDesc": "",
      "mHEq": {},
      "mKeyw": [],
      "mNames": {}

    }
  },
  "cLgth": 566,
  "cType": "text/html",
  "dTime": 1224,
  "jobsDone": [
    "rawdataload",
    "hrefanalyze",
    "metatagsanalyze",
    "keywordanalyze",
    "categoryfinder"
  ],
  "langs": [
    "en", "de"
  ],
  "publishedOn": {
    "sims": 1362752738996
  },
  "tld": "com",
} 
```

我面向用户的查询主要是通过 _id 从 mongo 中获取域。其中一些使用域的语言后端查询运行不同类型的作业“jobsDone”。基于此信息，选择不同范围的文档。

所以我考虑只使用映射到域名的“_id”，因为它具有非常高的基数。使用域名的 MD5 散列来更均匀地分配是否有意义？

我不喜欢“查询隔离”。由于大多数用户查询只会直接读取 _id ，我认为这很好。作业后端查询可能会运行更长时间（分散/收集），因为用户没有看到它，但我想优化这一点，我将“jobsDone”字段添加为复合分片键，以便通过已经运行的作业分配它？

是否可以将数组用作分片键？

感谢所有的见解！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T21:22:18.850

分片键不能是数组，因为分片键上的索引不能是多键索引。我当然认为您会希望“_id”（域）成为您的分片键的一部分，如果您能找到另一种方法来确保查询隔离，那么这将有所帮助。

我有点不确定您为什么担心域名分布均匀，因为域名往往非常随机，如果您期望拥有大量不同的域，那么您应该处于良好状态。如果由于某种原因域名分配成为问题，您可以运行 MongoDB 2.4.1 并使用[散列分片键](http://docs.mongodb.org/manual/core/sharded-clusters/#hashed-sharding)。

# python - PIL ImageGrab 屏幕截图未显示所有可见的应用程序

> ID：15396720
> 
> 赞同：1
> 
> 时间：2013-03-13T21:21:18.807
> 
> 标签：python, image, screenshot, python-imaging-library, webpage-screenshot

```
import ImageGrab
ImageGrab.grab().save("my_screenshot.jpg", "JPEG") 
```

我有一个应用程序。这个应用程序主要是 QT，在某些状态下，它嵌入了 html 元素。当此应用程序在我的本地计算机（Windows 7）上运行并执行上述代码时，屏幕截图完美。一切都是可见的。

但是，当我在其他计算机上运行我的应用程序并执行上述代码时，它会截取屏幕截图，但这些屏幕截图并未显示我的应用程序。更奇怪的是，当应用程序处于某些状态时，截图是成功的。但在其他州，它不是（一切都是可见的，但我的应用程序除外）。有时它与 Web 元素有关，但另一方面，有时其他 Web 元素也能正常显示。不幸的是，当它成功和不成功时，我无法掌握该模式。我所知道的是 ImageGrab.grab() 不会在某些计算机（相同的操作系统）上的给定时间显示所有可见的应用程序。但是，如果我执行本机 PrtScn 命令，无论处于何种状态，我的应用程序都会正常显示。

有什么建议么？

# django - Django：返回计数值

> ID：15396725
> 
> 赞同：0
> 
> 时间：2013-03-13T21:21:28.533
> 
> 标签：django

使用以下代码，我想返回这个有效的计数......

```
def contact_count(self):
    return len(self.contacts) 
```

但是，如果 len 为 0，则返回空白，我希望它为 0。

所以我试过了

```
def contact_count(self):
    if len(self.contacts) == 0:
       return 0
    else:
      return len(self.contacts) 
```

我应该有更好的方法来处理这个问题吗？

**更新：**

因此，要按要求更新我的问题，这是如何定义联系人的...

模型.py

```
class Groups(models.Model):
    name = models.CharField(max_length=60)

    def contact_count(self):
        return len(self.contacts)

class Contacts(models.Model):
    first_name = models.CharField(max_length=60)
    last_name = models.CharField(max_length=60)
    #FK
    groups = models.ManyToManyField(Groups, related_name='contacts') 
```

如您所见，是否来自related_name

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:37:35.187

你应该使用`self.contacts.count()`.

有关更多详细信息，请参阅有关多对多关系的[Django 文档。](https://docs.djangoproject.com/en/1.4/topics/db/queries/#many-to-many-relationships)

# r - 如何使用 unix 或 R 解析斜杠分隔列并在同一文件中创建新列？

> ID：15396728
> 
> 赞同：-4
> 
> 时间：2013-03-13T21:21:36.637
> 
> 标签：r, perl, unix, awk

我的文件的第一列在大多数行中由正斜杠分隔，但不是全部。我想解析第一列，在同一个文件中创建新列。（我需要第一列中的第一个字段，所以如果有办法在同一个文件的新列中打印第一个字段，那也可以）。所有行的列数都不相同。其他列的模式更复杂。输入：

```
SAMD11/SAMD11    chr1    ALLELEA=T    taWT=1    TOP=+
SAMD11/SAMD11/NOC2L    chr1    ALLELEA=T    taPN=-1 
AGRN    chr1    ALLELEA=T 
```

期望的输出：

```
SAMD11  SAMD11    chr1    ALLELEA=T    taWT=1    TOP=+
SAMD11  SAMD11    NOC2L   chr1     ALLELEA=T     taPN=-1
AGRN    chr1      ALLELEA=T 
```

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:58:26.870

您可以使用斜线 ( `FS = "/"`) 分隔字段，并设置制表符来分隔输出 ( `OFS = "\t"`) 中的字段。`$1 = $1`就我而言，您必须执行任何类型的虚拟过程才能`awk`从一种模式转换为另一种模式。我假设第一个字段中没有其他斜线。

```
awk 'BEGIN { FS = "/"; OFS = "\t" } { $1 = $1; print }' infile 
```

它产生：

```
SAMD11  SAMD11    chr1    ALLELEA=T    taWT=1    TOP=+
SAMD11  SAMD11  NOC2L    chr1    ALLELEA=T    taPN=-1 
AGRN    chr1    ALLELEA=T 
```

* * *

**编辑**考虑到许多字段中的斜杠选项的脚本。它检查第一个字段是否有斜线并使用制表符将其删除。输出与之前相同。

```
awk '
  BEGIN { OFS = "\t" } 
  $1 ~ /\// { 
    gsub( /\//, "\t", $1 ) 
  } 
  { print }
' infile 
```

# python - reg 从括号中提取内容

> ID：15396734
> 
> 赞同：0
> 
> 时间：2013-03-13T21:22:05.063
> 
> 标签：python, regex

我有这个`string = "abc('abt')"`，我想提取价值。

我试过：`string = string.strip("abc('/)")`我正在使用python。如果结果是't'，但我想要'abt'。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:35:49.140

这是一个正则表达式，它将在括号内的单引号内找到所有内容。它搜索一个左括号和一个单引号，然后收集导致另一个单引号和右括号的所有内容：

```
>>> import re
>>> s = "abc('abt')"
>>> regex = re.compile("\('(.*)'\)")
>>> m = re.search(regex, s)
>>> m.group(1)
'abt' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:24:21.890

`.strip()`需要一*组*字符来删除。您正在删除开头和结尾的所有, , `a`, `b`,`c`和`(`字符`'`。只剩下了。`/``)``t`

`'`您可以改为拆分：

```
string.split("'")[1] 
```

或者您可以从切片的开头和结尾显式删除确切的字符：

```
string[5:-2] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:24:05.683

```
^[^=]*=\sabc\(['"]?(\w+)['"]\)$ 
```

此正则表达式将捕获您想要的内容到第一组。我不确定如何在 python 中提取它的值，让我谷歌一下 :)

```
import re
regex = re.compile(r"^[^=]*=\s\"abc\(['""]?(\w+)['""]\)\"$")
input = "string = \"abc('abt')\""
matches = regex.match(input)
your_val = matches.group(1) 
```

请注意，此正则表达式仅适用于具有“值”的字符串，例如“abc”

抱歉，我手头没有 Python，没有经过测试，但我想你已经明白了。

# jsf - 我如何呈现 在输入字段中？

> ID：15396735
> 
> 赞同：0
> 
> 时间：2013-03-13T21:22:09.900
> 
> 标签：jsf, facelets

我正在创建一个使用 jsf、html、java 和 JavaDB 的网站。我的一个页面将列出许多代表客户可以选择的菜单的图像。在页面底部有一个`selectManyCheckbox`与图像对应的选项。当客户选择了菜单组合时，“订购”按钮将引导客户到下一页。在此页面上列出了有关客户的其他信息（从数据库中检索），例如：`Customer number`、`Contact name`等。此外，所选菜单应列在表中，并且列出的行数应与选择的菜单数量。我的主要问题是我想使用从`selectManyCheckbox`作为我在所选菜单字段中的输入，其余部分是从数据库中收集的（我已经完成并且有效）。如何将值作为单独的值获取？我只能在输出文本中使用它们，而不是作为输入字段中的值。

Java代码：

```
 @Named
        @RequestScoped
        public class OrderBean implements java.io.Serializable {
        private Set<String> menus = new TreeSet<String>();

        public Set<String> getMenus() { 
           return menues;
        }

        public void setMenus(Set<String> newValue){
           menus = newValue;
        }

        public SelectItem[] getMenuesItems(){
           return menuesItems;
        }

        private static SelectItem[] menuesItems = {
           new SelectItem("Menu 1"),
           new SelectItem("Menu 2"),
           new SelectItem("Menu 3")
        };
   } 
```

JSF，HTML：

```
 <div class="clear"></div>
      <div id="frame">
        <div id="frameCheckBox"><h:commandButton value="#{mld.Order}" action="Order"/>
             <h:selectManyCheckbox value="#{orderBean.menus}">
                  <f:selectItems value="#{orderBean.menusItems}"/>
             </h:selectManyCheckbox>
        </div>
       </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T02:58:04.020

替换`Set<String>`为`List<String>`or `String[]`，以便您可以在 an 的帮助下生成所需的输入组件，`<ui:repeat>`如下所示：

```
<ui:repeat value="#{orderBean.menus}" varStatus="loop">
    <h:inputText value="#{orderBean.menus[loop.index]}" />
</ui:repeat> 
```

就像`<h:dataTable>`，它`Set`直到即将到来的 JSF 2.2 才支持。另请注意，您确实需要通过列表/数组索引而不是 via 来引用输入值，`<ui:repeat var>`原因很简单，它`String`是不可变的并且没有 setter 方法。

最后但并非最不重要的一点是，在处理表单提交期间，此构造将失败，因为您的 bean 是请求范围的，因此在将表单呈现给最终用户后直接被丢弃。将它放在更广泛的范围内，例如视图、对话或会话范围。否则 JSF 将无法在初始列表/数组中设置提交的值。

# python - 我做了一个Python“强盗语言”翻译程序，对吗？

> ID：15396739
> 
> 赞同：0
> 
> 时间：2013-03-13T21:22:36.933
> 
> 标签：python

所以我只是python中的菜鸟，我正在做这个练习：

> “编写一个函数 translate() 将文本翻译成“rövarspråket”（瑞典语为“强盗的语言”）。也就是说，将每个辅音加倍，并在其间放置一个出现的“o”。例如， translate("this is fun") 应该返回字符串 "tothohisos isos fofunon"。"

我能够做到这一点是我的代码：

```
def translate (var1):
    vaw = ['b','c','d','f','g','h','j','k','l','m','n','p','q','r','s','t','v','w','x','z']
    var1 = list(var1)
    for string  in var1:
        if string == string in vaw:
           var1[var1.index(string)] = string + 'o' + string
    print ''.join(var1) 
```

我想知道这是否正确，或者是否有另一种方法可以用更少的代码来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-13T21:25:44.673

```
def translate(s):
  consonants = 'bcdfghjklmnpqrstvwxz'
  return ''.join(l + 'o' + l if l in consonants else l for l in s)

print(translate("this is fun")) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-13T21:32:16.323

正则表达式是一个很好的解决方案

```
>>> import re
>>> print re.sub(r"([bcdfghjklmnpqrstvwxyz])",r"\1o\1","this is fun")
tothohisos isos fofunon 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T21:29:34.800

首先，您不需要这样做：

```
vaw = ['b','c','d','f','g','h','j','k','l','m','n','p','q','r','s','t','v','w','x','z'] 
```

… 得到一个字符序列。字符串已经是一个字符序列。*（*对于. `var1`_ _ *_* _**`list`**

 **此外，您的代码实际上不起作用，因为`string == string in vaw`与 相同`True in vaw`，这总是错误的。我想你的意思是`if string in vaw`。当我们在这里时，我不会调用变量`string`，因为那是内置模块的名称。

并且您可以通过在标准 Python 样式 (PEP8) 不允许的地方添加额外的空格来节省一些击键。:)

所以：

```
def translate(var1):
    vaw = 'bcdfghjklmnpqrstvwxz'
    var1 = list(var1)
    for s in var1:
        if s in vaw:
           var1[var1.index(s)] = s + 'o' + s
    print ''.join(var1) 
```

接下来，如果你想要每个元素的索引`var1`，你不想把它扔掉，然后再用`index`. 除了更多的代码和更慢的速度之外，它还会为您多次出现的任何元素给出错误的答案。所以：

```
def translate(var1):
    vaw = 'bcdfghjklmnpqrstvwxz'
    var1 = list(var1)
    for i, s in enumerate(var1):
        if s in vaw:
           var1[i] = s + 'o' + s
    print ''.join(var1) 
```

如果您想`var`就地改变列表，这大约是您可以做到的。您可以将其更改为 do `var1[i+1:i+1] = 'o' + s`，在现有元素之后插入新元素，但随后您必须迭代副本`var1`（在迭代时不能更改任何东西的形状），并且您必须跟踪你的索引是如何变化的，等等。

建立一个新结构通常比修改旧结构要简单得多。这就是列表推导、生成器表达式、`map`、`filter`等的用途。对于原始列表的每个元素`s`，你想要`s + 'o' + s`它是否在 中`vaw`，`s`否则，对吗？你可以把它翻译成 Python：

```
def translate (var1):
    vaw = 'bcdfghjklmnpqrstvwxz'
    new_var1 = (s + 'o' + s if s in vaw else s for s in var1)
    return ''.join(new_var1) 
```**

# jquery - jQuery - 有没有办法推迟从已经绑定的插件运行函数

> ID：15396740
> 
> 赞同：0
> 
> 时间：2013-03-13T21:22:44.140
> 
> 标签：jquery, select, deferred

我们编写了一个通用的 jQuery 动作，它绑定到一个选定的国家列表。绑定到国家选择；当它被改变时，调用服务器来获取状态......

```
$('#' + countryElementID).change(function () {
    var countryID = $('#' + countryElementID).val();
    $.ajax({
        type: 'POST',
        url: '/App/GetStatesByCountry',
        data: {
            id: countryID
        },
        dataType: 'json',
        success: function (result) {
            // build HTML replace via .html
        },
        failure: function (result) {
            // ...
        }
    });
}); 
```

这是触发此的代码...

```
var populateCompanyInfo = function (resultData) {

var populateList = {
    CompanyName: 'input',
    Address1: 'input',
    Address2: 'input',
    City: 'input',
    Zip: 'input',
    Email: 'input',
    Phone: 'input',
    Fax: 'input',
    CountryID: 'select',
    StateID: 'select',
    Active: 'toggle'
}

$.each(populateList, function (name, value) {
    var a = eval('resultData.' + name);
    var sectionID = 'RealtyCompany';
    if (a != null || a != '') {
        if (value == 'input') {
            // ...
        }
        if (value == 'select') {
                var a = eval('resultData.' + name);
                $('#select' + sectionID + name).val(a);
                $('#select' + sectionID + name).trigger('change');
        }
        if (value == 'toggle') {
            // ...
        }
    }
}); 
```

我遇到的问题是它在填充状态之前选择了 StateID（由 Country 下拉列表的更改触发）。

是否有一个变量可以在 Country 下拉列表的通用操作中传递，它基本上会等到变量传递？我试图想办法在 jQuery 中合并一个延迟操作，但我很难找到一种方法来做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T02:47:17.120

看了一会儿后，便士掉了——我想我已经看透了这个问题。我是否写了有效的答案还有待观察。

无论您采用哪种方式，关键是让 jqXHR 的“承诺”（通过 AJAX 获取所选国家的州而产生）可用于其他范围。`.data('fetchData')`我选择通过设置强加于国家选择元素的 jQuery 对象的属性来做到这一点。

然后，由于`.each(populateList, ...)`循环的工作方式（我没有尝试更改它），jqXHR 还需要作为循环内两个分支之间的外部成员传递。可以使用其他方法，但我想到的所有方法至少都一样混乱。

由于`.data()`不能保证对象存在，因此需要相当大的安全性来增加脚本的体积。很有可能有一种更简单的方法可以用更少的代码实现相同的目的。

这是代码：

```
$(function() {
    var countryElementID = 'selectRealtyCompanyCountryID';
    $('#' + countryElementID).change(function () {
        var $this = $(this);
        var jqXHR = $.ajax({
            type: 'POST',
            url: '/App/GetStatesByCountry',
            data: { id: $this.val() },
            dataType: 'json',
            success: function (result) {
                // Build HTML replace via .html()
            },
            failure: function (result) {
                // Generic error handler
                alert('Generic error handler');
            }
        });
        var fetchData = $this.data('fetchStates');// May of may not exist.
        if(fetchData) fetchData.jqXHR = jqXHR;//Make the jqXHR available to other scopes via the DOM.
    });

    var populateCompanyInfo = function (resultData) {
        var populateList = {
            CompanyName: 'input',
            Address1: 'input',
            Address2: 'input',
            City: 'input',
            Zip: 'input',
            Email: 'input',
            Phone: 'input',
            Fax: 'input',
            CountryID: 'select',
            StateID: 'select',
            Active: 'toggle'
        }
        var fetchPromise = null;

        $.each(populateList, function (name, value) {
            var a = resultData[name];
            var sectionID = 'RealtyCompany';
            if(a) {
                if (value == 'input') {
                    // ...
                }
                if (value == 'select' && name == 'CountryID') {
                    //Branch for the CountryID select menu
                    var $el = $('#select' + sectionID + name);
                    var fetchData = $el.data('fetchStates');
                    if(!fetchData) {
                        $el.data('fetchStates', {});
                    }
                    if(fetchData.jqXHR && fetchData.jqXHR.abort) {//safety
                        fetchData.jqXHR.abort();//Kill any outstanding ajax requests of the same type.
                    }
                    $el.val(a).trigger('change');
                    fetchPromise = data.jqXHR;//Make the new jqXHR object available to the 'StateID' branch next time round the .each loop.
                }
                if (value == 'select' && name == 'StateID') {
                    //Branch for the StateID select menu
                    if(fetchPromise && fetchPromise.done) {//May of may not be defined.
                        fetchPromise.done(function(data, textStatus, jqXHR) {
                            // At this point the States element is freshly populated with states.
                            // Here, do whatever is necessary once the States element
                            // eg. set its .val() then trigger its 'change' event.
                        }).fail(function(jqXHR, textStatus, errorThrown) {
                            // Display error message?
                            // Set the States element to a default value?
                            alert('Specific error handler');
                        });
                    }
                }
                if (value == 'toggle') {
                    //...
                }
            }
        });
    }
}); 
```

*经测试可消除语法错误 - 仅此而已*

## 编辑

是的，它可以被简化——[这里有一些更好的代码](http://jsfiddle.net/G52m5/)。由于 ajax 失败，您将看到错误消息 - 我还没有完全模拟获取状态。但是错误信息很好——它们意味着事件的顺序是正确的。

# javascript - 如何记录方法的“对象”参数

> ID：15396747
> 
> 赞同：7
> 
> 时间：2013-03-13T21:23:20.170
> 
> 标签：javascript, documentation, yuidoc

我正在尝试使用 YUIDoc 为 JavaScript 方法编写一些文档。看起来像：

```
/** 
    Returns an instance of className

    @method getInstance
    @param {string} className the of the class used to create the instance
    @param {Object} options these are options used to create the instance
**/
function getInstance(className, options) { ..... } 
```

现在，options 对象可以有多个参数，例如`options.id`,`options.single`等。

如何将此信息添加到 this 的文档中`@param`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-17T05:37:58.727

在撰写本文时的当前版本 YUIDOC 0.3.45 中，为了描述方法接收的对象，您应该首先声明对象（**options**，在下面的示例中），然后是带有点符号的属性（例如,**选项.url** )。

```
/**
 * Describe your method
 *
 * @method yourMethodName
 * @param {object} options - These are the options you may pass
 * @param {string} options.url - the url
 * @param {string} options.otherOption - description of other option
 */ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-13T21:33:31.820

来自参考：http: [//yui.github.com/yuidoc/syntax/index.html](http://yui.github.com/yuidoc/syntax/index.html)

“如示例所示，您还可以嵌套 @param 标记。这使您能够记录具有自己特定嵌套结构的对象参数。”

```
@param {Object} [options] Data 
  to be mixed into the event 
  facade of the `change` 
  event(s) for these attributes.
  @param {Boolean} [options.silent]
    If `true`, no `change` event 
    will be fired. 
```

# erlang - Erlang Parse_trans 形式翻译为 Erlang 源代码

> ID：15396749
> 
> 赞同：1
> 
> 时间：2013-03-13T21:23:27.840
> 
> 标签：erlang

通过使用 parse_trans，我得到了模块的表单。然后我对其进行了一些修改。有没有办法将表单翻译回实际的 erlang 代码？说表格如下：

```
[{attribute,1,file,
        {"/program.erl",
         1}},
{attribute,1,module,program},
{attribute,3,export,[{run,0}]},
{function,5,run,0,
       [{clause,5,[],[],
                [{match,5,
                        {var,5,'T'},
                        {cons,5,
                              {atom,40,program},
                              {cons,5,{atom,40,...},{cons,...}}}},
                 {call,5,
                       {remote,5,{atom,5,advices},{atom,5,before_advice}},
                       [{var,5,'T'}]},
                 {match,5,{var,5,'R'},{call,5,{atom,5,run_@},[]}},
                 {var,5,'R'}]}]},
{function,5,run_@,0,
       [{clause,5,[],[],
                [{call,6,
                       {remote,6,{atom,6,program2},{atom,6,calc_service}},
                       [{integer,6,1},{integer,6,0}]},
                 {call,7,
                       {remote,7,{atom,7,program2},{atom,7,calc_service}},
                       [{integer,7,2},{integer,7,2}]},
                 {call,8,
                       {remote,8,{atom,8,program2},{atom,8,process_message}},
                       [{string,8,"Add 3 to 5"}]},
                 {call,9,
                       {remote,9,{atom,9,program2},{atom,9,...}},
                       [{string,9,"Message to process"}]},
                 {call,10,{remote,10,{atom,10,...},{atom,...}},[]},
                 {atom,11,ok}]}]},
{eof,11}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T09:38:32.547

使用[erl_pp:form/1](http://www.erlang.org/doc/man/erl_pp.html#form-1)。这是一个例子：

```
parse_transform(Forms, _Options) ->
    IOList = [erl_pp:form(Form) || Form <- Forms],
    io:format(user, "~s", [IOList]),
    Forms. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T06:56:20.140

您可以使用 parse_trans 应用程序中的漂亮打印机：[https ://github.com/esl/parse_trans/blob/master/src/parse_trans_pp.erl](https://github.com/esl/parse_trans/blob/master/src/parse_trans_pp.erl)

# spring - 带有 OPENAM 的 Spring Security SAML 扩展

> ID：15396751
> 
> 赞同：0
> 
> 时间：2013-03-13T21:23:41.073
> 
> 标签：spring, security, saml, openam, spring-saml

所以这里是场景。

我有我的网络应用程序 <==> IDP 代理 <==> IDP。IDP 代理和 IDP 都是 openam 实例。我们的想法是我们可以添加额外的 IDP（来自其他客户端），因此我们需要一个代理来屏蔽复杂性。

所以这里的 IDP 代理是：http://idpproxydev.devs1.int:8080/ [openam](http://idpproxydev.devs1.int:8080/openam)

IDP 网址为： http://idpdev.devs1.int:80/ [openam](http://idpdev.devs1.int:80/openam)

我的网络应用程序是：[http ://ocr-jq0zt91.devs1.int:9081/LOS](http://ocr-jq0zt91.devs1.int:9081/LOS)

我开始使用 [http://static.springsource.org/spring-security/site/extensions/saml/index.html](http://static.springsource.org/spring-security/site/extensions/saml/index.html) 进行集成，现在我看到 SAML: request wassent from my web app 。

我现在遇到的问题是，当我使用 Fedlet（在 IDP 代理上使用 Openam 生成的客户端）测试我的设置时，请求转到代理，然后路由到 IDP，因为 Fedlet 生成的 SAML 请求具有附加信息，是 SAML 请求中的这个片段吗

```
<samlp:Scoping xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"  ProxyCount="1"   >
       <samlp:IDPList xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol">
        <samlp:IDPEntry xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol"
                        ProviderID="http://idpdev.devs1.int:80/openam"  />
    </samlp:IDPList>
</samlp:Scoping> 
```

所以我看到的唯一区别是 FEDLET 生成的 SAML 请求中的额外负载。

因此，通过在 SAML 请求中看到上述代码段，IDP 代理知道最终目的地不是它自己（[http://idpproxydev.devs1.int:8080/openam](http://idpproxydev.devs1.int:8080/openam)），而是另一个实体，在这种情况下是[http://idpdev。 devs1.int:80/openam](http://idpdev.devs1.int:80/openam)

Fedlet 具有扩展元数据的附加属性文件 (sp-extended.xml)，我们可以在其中添加这些附加内容。

```
<Attribute name="enableIDPProxy">
           <Value>true</Value>
       </Attribute>
       <Attribute name="idpProxyList">
           <Value> http://idpdev.devs1.int:80/openam</Value>  (the attribute name is little confusing as this is the IDP)
       </Attribute>
       <Attribute name="idpProxyCount">
           <Value>1</Value>
       </Attribute> 
```

但是在 spring saml 安全库中，我看不到任何可以添加这些附加属性的方式，以便 SAML 请求可以包含此信息。有没有办法可以提供上面列出的其他属性？

这样当我的网络应用程序发送请求时，spring saml 扩展程序可以读取？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T22:28:34.457

我找到了解决这个问题的方法。您需要使用 org.springframework.security.saml.websso.WebSSOProfileOptions

这是我的网络应用程序中的一个示例。将此添加到您的 security.xml

```
<beans:bean id="samlEntryPoint" class="org.springframework.security.saml.SAMLEntryPoint">
        <beans:property name="defaultProfileOptions">
            <beans:bean class="org.springframework.security.saml.websso.WebSSOProfileOptions">
                <beans:property name="binding" value="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST"/>
                <beans:property name="includeScoping" value="true"/>
                <!-- to skip proxyCount, 0 to disable proxying, >0 to allow proxying-->
                <beans:property name="proxyCount" value="1"/>
                <beans:property name="allowedIDPs">
                    <beans:set>
     <beans:value>http://idpproxydev.devs1.int:80/openam</beans:value>                  
                    </beans:set>
               </beans:property>        
  <!--  Allowed Values are in  AuthnContextComparison.java -->
            <beans:property name="authnContextComparison" value="EXACT"/>
            <beans:property name="authnContexts">
                    <beans:list>
 <beans:value>
urn:oasis:names:tc:SAML:2.0:ac:classes:PasswordProtectedTransport
</beans:value>                  
                    </beans:list>
            </beans:property>
            <beans:property name="nameID" value="urn:oasis:names:tc:SAML:2.0:nameid-  format:transient"/>
            <beans:property name="allowCreate" value="true"/>
                </beans:bean>
        </beans:property>
    </beans:bean> 
```

现在我看到来自 WEB 应用程序的 SAML 请求具有 IDP 列表。

还添加了一些额外的注释以使用 SPRING SAML 扩展将 JSF Web 应用程序与 openam 集成。

请参阅我关于与 Openam 概念相关的一般信息的文章 [http://reddymails.blogspot.com/2013/03/sso-for-java-or-net-web-based.html](http://reddymails.blogspot.com/2013/03/sso-for-java-or-net-web-based.html)

使用 Spring SAML 扩展和 Spring Security 将 JSF 2 Web 应用程序与 Openam 集成的步骤。 [http://reddymails.blogspot.com/2013/06/integrating-jsf-web-application-with.html](http://reddymails.blogspot.com/2013/06/integrating-jsf-web-applicataion-with.html)

-拉玛

# java - Java - 使用 JAMA 创建具有随机值的 3by3 矩阵

> ID：15396752
> 
> 赞同：1
> 
> 时间：2013-03-13T21:23:44.190
> 
> 标签：java, matrix, jama

这就是我到目前为止所得到的......

```
 public static void main(String[] args) {
        Random random= new Random();
        Matrix mR = new Matrix(3,3,random.nextDouble()) ;
        System.out.println("Here is a 3x3 matrix with random values " +Arrays.deepToString(mR.getArray()));

    } 
```

问题是当我打印出来时，所有的值都是一样的。我需要的是每个索引中的不同值。我知道这可以简单地通过创建一个数组，为其分配随机值，然后将其复制到矩阵中来完成。但我需要直接从矩阵 mR 中执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:31:09.883

`Random.nextDouble`返回 a `double`，因此在上面的代码中，您正在调用此构造函数：

```
Matrix(int m, int n, double s) 
```

它构造了一个 m×n 常数矩阵。

您应该只调用此静态方法：

```
public static Matrix random(int m, int n) 
```

例如，

```
Matrix mR = Matrix.random(3, 3); 
```

有关更多信息，请参阅[文档](http://math.nist.gov/javanumerics/jama/doc/)。

# git - 在 gitlab 中创建拉取请求

> ID：15396753
> 
> 赞同：37
> 
> 时间：2013-03-13T21:23:45.900
> 
> 标签：git, gitlab, pull-request

我正在运行 GitLab 安装，并且我有一个想要与朋友分享的存储库。我无法理解在 GitLab 中发送拉取请求的流程。

用户不能分叉我的存储库或访问我的项目（除非他是我的团队成员）。合并请求可以从我的存储库中的一个分支到另一个分支。

拉取请求如何在 GitLab 中工作？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2014-01-08T11:02:08.320

GitLab.com 联合创始人在这里。[在GitLab (6.x)](https://gitlab.com/gitlab-org/gitlab-ce/blob/master/CHANGELOG#L144)的最新版本中，分叉应该可以正常工作。你可以 fork 一个属于其他人的 repo，然后创建一个合并请求（GitHub 拉取请求的正确命名版本）。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-05-03T19:44:20.303

GitLab 将从 5.2 版开始分叉。交叉回购拉取请求将很快跟进。

分叉拉取请求：[https ://github.com/gitlabhq/gitlabhq/pull/3597](https://github.com/gitlabhq/gitlabhq/pull/3597)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-03-13T21:45:52.433

正如“[开发](https://github.com/gitlabhq/gitlabhq/wiki/Development)”和[这个线程中提到的](https://groups.google.com/forum/#!searchin/gitlabhq/%22pull$20request%22/gitlabhq/sk5HmK8dxCM/Di_X1k4YjBkJ)

> ~~**GitLab**中没有分叉~~ **（至少在[2013 年 5 月提到](https://stackoverflow.com/a/16366429/6309)的[GitLab 5.2](https://github.com/gitlabhq/gitlabhq/pull/3597)之前，感谢**[Angustus](https://stackoverflow.com/users/214795/angustus)**） 因为它并不意味着像 GitHub 那样具有那种功能。 如果您使用的是 GitLab，大概您将拥有 repo 或团队中的某个人，您可以在其中访问并可以创建一个分支来处理某个功能/其他内容。** 
> 
>  **If you create a branch, then you can submit a **merge request** where it can be reviewed by other people in the project (or whatever your workflow dictates), and accept the merge.**

 **Accepting merge request has been implementing in [Issue 618](https://github.com/gitlabhq/gitlabhq/pull/618):

![accept merge request](../Images/7950e4acaeafc4ce87d00d16ec326a1e.png)**

# r - 使用带有 knitr 的循环来生成多个 pdf 报告......需要一点帮助才能让我克服困难

> ID：15396755
> 
> 赞同：35
> 
> 时间：2013-03-13T21:23:57.633
> 
> 标签：r, knitr

首先，我必须承认我对 knitr 和可重现分析的概念还很陌生，但我可以看到它在改进我当前的工作流程（其中包括大量复制粘贴到 word 文档中）方面的潜力。

我经常需要按组（在本例中为医院）生成多个报告，并且在每家医院内，我可能会报告许多不同的病房结果。以前我使用循环在 R 中运行我的所有绘图和分析，然后开始复制/粘贴工作；然而，在阅读了这篇文章后（[Sweave 可以自动生成许多 pdf 文件吗？](https://stackoverflow.com/questions/8519128/can-sweave-produce-many-pdfs-automatically)），它给了我希望，我实际上可以跳过许多步骤，直接从 R 到 Rnw/knitr 报告。

但是，在尝试之后，我发现有些东西不太有效（因为 Rnw 中的 R 环境似乎无法识别我试图传递给它的循环变量？？）。

```
 ##  make my data
Hospital <- c(rep("A", 20), rep("B", 20))
Ward <- rep(c(rep("ICU", 10), rep("Medicine", 10)), 2)
Month <- rep(seq(1:10), 4)
Outcomes <- rnorm(40, 20, 5)
df <- data.frame(Hospital, Ward, Month, Outcomes)

##  Here is my current work flow-- produce all plots, but export as png and cut/paste
for(hosp in unique(df$Hospital)){
  subgroup <- df[ df$Hospital == hosp,]
  for(ward in unique(subgroup$Ward)){
    subgroup2 <- subgroup[subgroup$Ward == ward,]
    savename <- paste(hosp, ward)
    plot(subgroup2$Month, subgroup2$Outcomes, type="o", main=paste("Trend plot for", savename))
  }
}
# followed by much copy/pasting

##  Here is what I'm trying to go for using knitr 
library(knitr)
for (hosp in unique(df$Hospital)){
  knit("C:file.path\\testing_loops.Rnw", output=paste('report_', Hospital, '.tex', sep=""))
}

## With the following *Rnw file
## start *.Rnw Code
\documentclass[10pt]{article}
\usepackage[margin=1.15 in]{geometry}
<<loaddata, echo=FALSE, message=FALSE>>=
  Hospital <- c(rep("A", 20), rep("B", 20))
Ward <- rep(c(rep("ICU", 10), rep("Medicine", 10)), 2)
Month <- rep(seq(1:10), 4)
Outcomes <- rnorm(40, 20, 5)
df <- data.frame(Hospital, Ward, Month, Outcomes)
subgroup <- df[ df$Hospital == hosp,]
@

\begin{document}
<<setup, echo=FALSE >>=
  opts_chunk$set(fig.path = paste("test", hosp , sep=""))
@

Some infomative text about hospital \Sexpr{hosp}

<<plots, echo=FALSE >>=
  for(ward in unique(subgroup$Ward)){
    subgroup2 <- subgroup[subgroup$Ward == ward,]
    #     subgroup2 <- subgroup2[ order(subgroup2$Month),]
    savename <- paste(hosp, ward)
    plot(subgroup2$Month, subgroup2$Outcomes, type="o", main=paste("Trend plot for", savename))
  }
@
\end{document}

##  To be then turned into pdf with this
tools::texi2pdf("C:file.path\\report_A.tex", clean = TRUE, quiet = TRUE) 
```

尝试运行我的 knit() 代码块后，我收到此错误：

```
Error in file(con, "w") : invalid 'description' argument 
```

当我查看要创建 *.tex 文件的目录时，我可以看到医院 A 的 2 个 pdf 图已生成（B 没有），并且没有医院特定的 *.tex 文件可以编织成 pdf。提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-13T22:34:59.150

您不需要重新定义`.Rnw`文件中的数据，我认为警告来自您将输出名称与`Hospital`（医院的完整向量）而不是`hosp`（循环索引）放在一起的事实。

按照你的例子，`testingloops.Rnw`将是

```
\documentclass[10pt]{article}
\usepackage[margin=1.15 in]{geometry}
<<loaddata, echo=FALSE, message=FALSE>>=
subgroup <- df[ df$Hospital == hosp,]
@

\begin{document}
<<setup, echo=FALSE >>=
  opts_chunk$set(fig.path = paste("test", hosp , sep=""))
@

Some infomative text about hospital \Sexpr{hosp}

<<plots, echo=FALSE >>=
  for(ward in unique(subgroup$Ward)){
    subgroup2 <- subgroup[subgroup$Ward == ward,]
    #     subgroup2 <- subgroup2[ order(subgroup2$Month),]
    savename <- paste(hosp, ward)
    plot(subgroup2$Month, subgroup2$Outcomes, type="o", main=paste("Trend plot for", savename))
  }
@
\end{document} 
```

并且驱动程序 R 文件将只是

```
##  make my data
Hospital <- c(rep("A", 20), rep("B", 20))
Ward <- rep(c(rep("ICU", 10), rep("Medicine", 10)), 2)
Month <- rep(seq(1:10), 4)
Outcomes <- rnorm(40, 20, 5)
df <- data.frame(Hospital, Ward, Month, Outcomes)

## knitr loop
library("knitr")
for (hosp in unique(df$Hospital)){
  knit2pdf("testingloops.Rnw", output=paste0('report_', hosp, '.tex'))
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-13T21:59:52.067

好问题！这适用于您在问题中提供的其他位。请注意，我已将您的替换`hosp`为`x`. 我已经调用了你的`Rnw`文件`test.rnw`

```
# input data
Hospital <- c(rep("A", 20), rep("B", 20))
Ward <- rep(c(rep("ICU", 10), rep("Medicine", 10)), 2)
Month <- rep(seq(1:10), 4)
Outcomes <- rnorm(40, 20, 5)
df <- data.frame(Hospital, Ward, Month, Outcomes)

# generate the tex files, one for each hospital in df
library(knitr)
lapply(unique(df$Hospital), function(x) 
       knit("C:\\emacs\\test.rnw", 
            output=paste('report_', x, '.tex', sep="")))

# generate PDFs from the tex files, one for each hospital in df
lapply(unique(df$Hospital), function(x)
       tools::texi2pdf(paste0("C:\\emacs\\", paste0('report_', x, '.tex')), 
                       clean = TRUE, quiet = TRUE)) 
```

我已经用`lapply`匿名函数替换了你的循环，这些函数似乎通常被认为更`R`-ish。

在这里您可以看到我在文件中替换`hosp`了的位置：`x``rnw`

```
\documentclass[10pt]{article}
\usepackage[margin=1.15 in]{geometry}
<<loaddata, echo=FALSE, message=FALSE>>=
  Hospital <- c(rep("A", 20), rep("B", 20))
Ward <- rep(c(rep("ICU", 10), rep("Medicine", 10)), 2)
Month <- rep(seq(1:10), 4)
Outcomes <- rnorm(40, 20, 5)
df <- data.frame(Hospital, Ward, Month, Outcomes)
subgroup <- df[ df$Hospital == x,]
@

\begin{document}
<<setup, echo=FALSE >>=
  opts_chunk$set(fig.path = paste("test", x , sep=""))
@

Some informative text about hospital \Sexpr{x}

<<plots, echo=FALSE >>=
  for(ward in unique(subgroup$Ward)){
    subgroup2 <- subgroup[subgroup$Ward == ward,]
    #     subgroup2 <- subgroup2[ order(subgroup2$Month),]
    savename <- paste(x, ward)
    plot(subgroup2$Month, subgroup2$Outcomes, type="o", main=paste("Trend plot for", savename))
  }
@
\end{document} 
```

结果是两个 tex 文件（report_A.tex、report_B.tex）、四个 PDF 用于图形（A1、A2、B1、B2）和两个 PDF 用于报告（report_A.pdf、report_B.pdf），每个都有它们的图形在他们中。那是你所追求的吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-01-01T18:51:48.547

在这个答案中，我打算回答一个更一般的问题：“使用循环生成多个 pdf 报告”，而不是您的具体示例。这是因为这种趋势作为菜鸟很难追随。我设法让它最终工作（html版本），所以这是我谦虚的解决方案。这里可能发布了一些更好的，我只是还不能完全理解它们。

1.  使用您的设计创建 RMD 文件并将其保存在 working\input 目录中（在 Rstudio 中：file->newfile->R markdown）。该文件应包含在报告中绘制图表所需的所有函数（只需在其中一个代码块中声明它们）。将此文件视为所有未来报告的模板。不要担心在早些时候咀嚼数据后将数据传递到它的环境中——我将在 (2) 中介绍这一点。要理解的关键问题是所有计算都在管道的下游完成（在您渲染 RMD 文件的那一刻）。

2.  创建您需要在不同的控制 r 文件中使用的循环。就我而言，有一个循环遍历目录中的所有文件，并将它们放入数据框中。然后我想将这些数据帧连同其他数据变量一起传递到 RMD 中，以便绘制它们。这是它的完成方式：

    `run_on_all<-function(path_in="path:\\where\\your\\input\\and\\RMD\\is", path_out="path:\\where\\your\\output\\will\\be") setwd(path_in) ibrary(rmarkdown) library(knitr) list_of_file_names=list.files(path = getwd, pattern = "*.csv") #this gets a list of the input files names for (file_name in list_of_file_names) { data=read.csv(file_name) #read file into data frame report_name=paste(some_variable_name,".html",sep="") render("your_template.Rmd",output_file =report_name,output_dir =path_out,list(data,all other parameters you want to input into the RMD))} }`

3.  最重要的命令是**渲染**函数调用。它允许您将任何您希望的参数放入 RMD 环境中。它还允许您更改报告的名称和更改输出位置。此外，通过调用它，您还可以生成报告，因此您可以在一行中得到所有信息。（请注意，如果对 RMD 的调用是在函数内，您可能会发现您输入的变量丢失了，但报告会仍然可以正确发布）

# 概括

您需要两个文件 - RMD 文件，这将是所有附加报告的模板和一个控制文件。控制文件获取数据，咀嚼它并将咀嚼的参数传递给RMD（通过渲染函数）。RMD 获取数据，进行一些计算，绘制它并将其发布到一个新文件中（也通过渲染函数）。我希望我有所帮助。

# php - 授权后允许用户下载

> ID：15396761
> 
> 赞同：0
> 
> 时间：2013-03-13T21:24:22.893
> 
> 标签：php, html, security, authentication, web

一个快速的问题。我正在创建一个包含文件的网站，当该用户购买了该文件时，该文件将下载。

唯一的问题是，该目录受到 .htaccess 权限的保护，以阻止未经授权的文件下载。很明显，当用户单击链接下载文件时，他们会看到 .htaccess 用户名密码组合。

有没有更好的方法来管理这个？

谢谢，

詹姆士。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:28:15.693

*   将文件存储在文档根目录*之外。*
*   拥有自己的自定义登录机制
*   在您检查用户是否登录后，使用 php 提供文件，或者使用*，**或者*如果已安装，或者您可以安装它，使用更好（这减轻了 PHP 的负担）。*`readfile()`[`mod_xsendfile`](https://tn123.org/mod_xsendfile/)*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:27:30.540

不要使用 HTACCESS，将文件放在 webroot 之外并通过代码提供它们。

看：

[允许用户在 webroot 之外下载文件](https://stackoverflow.com/questions/3884677/allow-users-to-download-files-outside-webroot)*

# java - 在不同的类中将另一个框架调用到另一个上

> ID：15396762
> 
> 赞同：0
> 
> 时间：2013-03-13T21:24:24.763
> 
> 标签：java, swing, jframe, jinternalframe

当我单击一个按钮时，我需要将一个类的 JFrame 实现到另一个类中。

这是我的代码：

```
public class Test6 extends JFrame implements Runnable {
 private static final String DB_PATH = "C:/testtest";
 private static GraphDatabaseService graphDb;
 Graph graph;
 Viewer viewer;
 View view;
 public JPanel contentPane1;

public void run() {
     Transaction tx = graphDb.beginTx();
    try
    {
        contentPane1 = new JPanel();
    contentPane1.setBackground(Color.DARK_GRAY);
    contentPane1.setBorder(new EmptyBorder(5, 5, 5, 5));
    contentPane1.setLayout(new BorderLayout(0, 0));
    setContentPane(contentPane1);
    JPanel panelSettings = new JPanel();
    panelSettings.setBorder(new EmptyBorder(0, 8, 0, 8));
    panelSettings.setBackground(SystemColor.activeCaption);
    panelSettings.setLayout(new BorderLayout(0, 0));
    contentPane1.add(panelSettings, BorderLayout.WEST);
    viewer.enableAutoLayout();
    view = viewer.addDefaultView(false);
    contentPane1.add(view);
    setSize(800, 600);
    setVisible(true);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
 } 
```

另一个类代码是：

```
public class GraphTest2 extends JFrame implements ActionListener 
{
public GraphTest2()
{
    Init();

}

public void Init()
{

    contentPane = new JPanel();

    contentPane.setBackground(Color.DARK_GRAY);
    contentPane.setBorder(new EmptyBorder(0,0,0,0));
    contentPane.setLayout(new BorderLayout(8,0));
    setContentPane(contentPane);

    JPanel panelSettings = new JPanel();   
    panelSettings.setLayout(new GridLayout(20,1,0,0));

        panelSettings.add(b1);
        public void actionPerformed(ActionEvent e) {

          if(e.getSource()==b1){
        } 
```

我正在尝试使用内部框架，但我不知道如何在我的代码中实现它。感谢您的时间和帮助。

# xamarin - xamarin.ios/monotouch facebook 回调

> ID：15396768
> 
> 赞同：1
> 
> 时间：2013-03-13T21:24:45.230
> 
> 标签：xamarin, xamarin.ios

我正在尝试在 xamarin ios 应用程序中通过 facebook 实现登录，按照[monotouch-bindings](https://github.com/mono/monotouch-bindings/tree/master/facebook/samples/FacebookSample)的示例， 我正在检查用户是否使用以下方法登录 AppDelegate：

```
var sessionDelegate = new SessionDelegate (this); 
facebook = new Facebook (AppId, sessionDelegate);
if (facebook.IsSessionValid) {
    ShowLoggedIn ();
}
else
{
    ShowLoggedOut ();
} 
```

问题是当用户未登录时，我正在导航到另一个 viewController 以便他登录。当他尝试登录时，Facebook 应用程序会打开，但登录后我没有收到回调。如果我在 AppDelegate 中完成整个流程，那么回调就会起作用。我注意到在 AppDelegate 中实现了 2 个覆盖：

```
public override bool HandleOpenURL 
```

和

```
public override bool OpenUrl 
```

他们都返回`return facebook.HandleOpenURL (url);` facebook 在 AppDelegate 和登录 viewController 中声明，所以我想这是问题的一部分。我是 iOS 和 mono touch 的新手，所以我希望这是有道理的。任何想法如何解决它？或者可能是不从 AppDelegate 执行 Facebook 登录的示例？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T23:22:35.763

这周我也花了几个小时，试图让它工作，我的问题和你的一样。是的，您需要覆盖 OpenUrl，否则您将无法处理 FBsession 中的任何内容，这就是它不适合您的原因。

所以按照美味示例中的描述实现它，它应该可以工作[:)](https://github.com/mono/monotouch-bindings/blob/master/facebook/samples/Scrumptious/Scrumptious/AppDelegate.cs)

# php - 将用户转发到 Wordpress 中的自定义仪表板

> ID：15396771
> 
> 赞同：1
> 
> 时间：2013-03-13T21:24:51.897
> 
> 标签：php, wordpress, redirect, permissions, user-roles

我正在尝试赋予角色“订阅者”编辑帖子的能力。虽然这是成功的，但我似乎无法在登录时引导用户离开默认的 wordpress wp-admin 页面。

每当我尝试建议的解决方案时，登录（具有 edit_post 权限）的用户都会被重定向到 wp-admin 页面。

当他们登录时，无论我做什么，wordpress 都会将它们转发给 wp-admin，显示 wordpress 后端。（我不希望用户看到这个）

我想这样做的原因是因为我有一个自定义仪表板供他们使用，位于[http://website.com/login/customdashboard/](http://website.com/login/customdashboard/)

我希望这是一个函数。

我试过插件但没有成功：
“彼得的登录重定向”和“s2member（登录欢迎页面）”

我尝试了以下功能但没有成功：

```
function soi_login_redirect( $redirect_to, $request, $user  ) {
    return ( is_array( $user->roles ) && in_array( 'administrator', $user->roles ) ) ? admin_url() : site_url();
} // end soi_login_redirect
add_filter( 'login_redirect', 'soi_login_redirect', 10, 3 ); 
```

另一个尝试没有成功：

```
function redirect_login_page(){
$page_viewed = basename($_SERVER['REQUEST_URI']);
 $login_page  = site_url();
 if( $page_viewed == "wp-login.php" && $_SERVER['REQUEST_METHOD'] == 'GET') {
 wp_redirect($login_page);
 exit();
 }
}
add_action('init','redirect_login_page'); 
```

在这方面的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:32:39.683

如果要重定向所有`/wp-admin`地址，可以使用：

```
add_action( 'admin_init', 'redirect_so_15396771' );

function redirect_so_15396771()
{   
    if ( defined( 'DOING_AJAX' ) && DOING_AJAX )  
        return;

    // http://codex.wordpress.org/Roles_and_Capabilities
    if ( !current_user_can('delete_users') ) {
            wp_redirect( site_url( '/login/customdashboard/' ) );
            exit();
    }
} 
```

如果你需要根据当前页面过滤这个，你可以使用 global `$pagenow`，它的值`index.php`是 , `profile.php`,`tools.php`等。

# arrays - 从MATLAB中的大数组中写出具有特定值的单元格的行

> ID：15396773
> 
> 赞同：0
> 
> 时间：2013-03-13T21:25:03.537
> 
> 标签：arrays, matlab, extract

我正在从一个大数组（~50000 x 45）中读取数据。我正在尝试从中提取其 x_value（第 27 列）高于特定值（在本例中为 1.8）的行。

我能够编写数组（p1），但每个输出行都是相同的，（大数组的最后一行，x > 1.8）

谁能告诉我如何正确写出这些数据？

谢谢

```
n = length(DAT);

bin = 1.8;

x_value = DAT(:,27); 

row = sum(x_value > bin);

for s = 1:n;

    if DAT(s,27) > bin

        for r = 1:row;

        p1(r,:) = DAT(s,:);

        end
    end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:40:38.463

```
bin = 1.8;
column = 27;
rows = find(DAT(:,column) > bin);
p1 = DAT(rows,:); 
```

# c# - 使用 IMultiValueConverter 绑定 Polygon.Points？

> ID：15396774
> 
> 赞同：1
> 
> 时间：2013-03-13T21:25:12.517
> 
> 标签：c#, wpf, data-binding, polygon, imultivalueconverter

我已经使用 IValueConverter 成功绑定了多边形的点。现在我需要使用 IMultiValueConverter。

让我先概述一下我要完成的工作，如果有人看到更好的方法，请告诉我！我可以使用 .NET 4.5 仅供参考。

我有一个包含一堆对象的数据存储。这些对象没有与之关联的任何类型的 Point/PointCollection。如果我有父母高度，我可以根据数据存储中对象的属性创建点。没有高度，我无法生成点。

我目前有一个有效的实现，但我在代码中执行了所有点计算。这会导致性能问题，因为每次父母高度发生变化时我都必须重新计算所有对象。

上代码：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Converters="clr-namespace:Converters"
    x:Class="MainWindow"
    Title="MainWindow" Height="611" Width="525">
<Window.Resources>
    <Converters:PointsConverter x:Key="PointsConverter" />
</Window.Resources>
<Grid>
    <Slider x:Name="slider" HorizontalAlignment="Left" Margin="344,10,0,0" VerticalAlignment="Top" Width="114" Value="1" Minimum="0.1" Maximum="4"/>
    <ScrollViewer x:Name="TimelineScroller" ClipToBounds="True" VerticalScrollBarVisibility="Disabled" 
                               Focusable="False" HorizontalScrollBarVisibility="Visible" 
                               Visibility="Visible" Margin="50,93,35,206">

        <Grid ClipToBounds="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="30"/>
                <RowDefinition Height="1*"/>
            </Grid.RowDefinitions>

            <ItemsControl x:Name="TopItemControl" Grid.Row="1" ItemsSource="{Binding TopData}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Canvas x:Name="TopAxis" Background="#FF65656C" Grid.Row="1" RenderTransformOrigin="0.5,0.5">
                            <Canvas.RenderTransform>
                                <TransformGroup>
                                    <ScaleTransform ScaleX="{Binding Value, ElementName=slider}"/>
                                    <SkewTransform/>
                                    <RotateTransform/>
                                    <TranslateTransform/>
                                </TransformGroup>
                            </Canvas.RenderTransform>
                        </Canvas>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <ContentControl >
                            <Polygon x:Name="polygon" Stroke="Black"  RenderTransformOrigin="0.5,0.5">
                                <Polygon.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform ScaleX="{Binding Value, ElementName=slider}"/>
                                        <SkewTransform/>
                                        <RotateTransform/>
                                        <TranslateTransform/>
                                    </TransformGroup>
                                </Polygon.RenderTransform>
                                <Polygon.Points>
                                    <MultiBinding Converter="{StaticResource PointsConverter}">
                                        <Binding ElementName="TopAxis" Path="ActualHeight"/>
                                        <Binding />
                                    </MultiBinding>
                                </Polygon.Points>
                            </Polygon>
                        </ContentControl>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Grid>
    </ScrollViewer>
</Grid> 
```

还有我的哑转换器代码：

```
 public class PointsConverter : IMultiValueConverter
{
    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        //simple string for testing
        return "10,255 500,255 500,200 400,150 200,150 10,200";
    }

    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture) { throw new NotImplementedException(); }
} 
```

顺便说一句，这是我得到的错误：

```
System.Windows.Data Error: 5 : Value produced by BindingExpression is not valid for target property.; Value='10,255 500,255 500,200 400,150 200,150 10,200' MultiBindingExpression:target element is 'Polygon' (Name='polygon'); target property is 'Points' (type 'PointCollection') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:36:23.503

大声笑，好吧，我想我没有用尽调试。

我需要传回一个真正的 PointCollection，而不是像我使用常规 IValueConverter 所做的那样的字符串。

```
 public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
    {
        var pc = new PointCollection();
        pc.Add(new Point(10, 255));
        pc.Add(new Point(500, 255));
        pc.Add(new Point(500, 200));
        pc.Add(new Point(400, 150));
        pc.Add(new Point(200, 150));
        pc.Add(new Point(10, 200));
        return pc;//"10,255 500,255 500,200 400,150 200,150 10,200";
    } 
```

# php - 获取两个日期之间的星期几

> ID：15396775
> 
> 赞同：1
> 
> 时间：2013-03-13T21:25:17.857
> 
> 标签：php, date

我需要获取两个日期之间一周中每一天的天数，例如：

```
2013-01-01 to 2013-01-15

Mo:2
Tu:3
We:2
Th:2
Fr:2
Sa:2
Su:2 
```

我有这段代码不确定我以前从哪里得到它，但它似乎正在工作，但意识到它在某些日期范围内不起作用，例如 2013-03-01 到 2013-03-11 它报告星期一为 1 天而不是 2 天.

```
function daysOfWeekBetween($start_date, $end_date, $weekDay)
{
   $first_date = strtotime($start_date." -1 days");
   $first_date = strtotime(date("M d Y",$first_date)." next ".$weekDay);

   $last_date = strtotime($end_date." +1 days");
   $last_date = strtotime(date("M d Y",$last_date)." last ".$weekDay);

   return  floor(($last_date - $first_date)/(7*86400)) + 1;
}

daysOfWeekBetween($date_range['start_date'], $date_range['end_date'], 'Monday'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:28:55.747

检查[`mktime()`](http://php.net/manual/en/function.mktime.php)手册。第一个示例正是您所需要的。

尝试这个：

```
date_default_timezone_set('UTC');

function count_weekdays_between($start, $end) {
    if (preg_match('/^(\d\d\d\d)-(\d\d)-(\d\d)$/', $start, $start) && preg_match('/^(\d\d\d\d)-(\d\d)-(\d\d)$/', $end, $end)) {
        $start  = mktime(0, 0, 0, $start[2], $start[3], $start[1]);
        $end    = mktime(0, 0, 0,   $end[2],   $end[3],   $end[1]);
        $offset = date('w', $start);
        $delta  = ($end - $start) / 86400;

        $result = array_fill(0, 7, floor($delta / 7));

        for ($i = 0; $i <= ($delta % 7); ++$i) {
            $result[$offset]++;
            $offset = ($offset + 1) % 7;
        }
        return $result;
    }
    return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T23:08:19.163

想出了一个解决方案：

```
 $interval = DateInterval::createFromDateString('1 day');
    $begin = new DateTime($date_range['start_date']);
    $end = new DateTime($date_range['end_date']);
    $period = new DatePeriod($begin, $interval, $end);
    foreach($period as $dt)
    {
        $inner_data['average_days_counter'][$dt->format('D')] = isset($inner_data['average_days_counter'][$dt->format('D')]) ? $inner_data['average_days_counter'][$dt->format('D')] + 1 : 1;
    }
    // Array ( [Mon] => 2 [Tue] => 1 [Wed] => 1 [Thu] => 1 [Fri] => 2 [Sat] => 2 [Sun] => 2 ) 
```

# c# - 属性更改时列表框项目未更新

> ID：15396786
> 
> 赞同：8
> 
> 时间：2013-03-13T21:26:31.630
> 
> 标签：c#, wpf, data-binding, observablecollection

当集合的属性发生更改时，我在更新包含 ObservableCollection 的列表框时遇到问题（从列表中添加/删除项目工作正常）：

列表框已设置`ItemsSource="{Binding Path=AllPerson}"`，后面代码中的数据上下文设置如下`this.DataContext = allPersonClass;`。

`allPersonClass`包含`ObservableCollection<Person> allPerson`

类`Person`包含名称等属性。

我已经覆盖了人员`ToString`返回`Name`属性的方法，因此 listBox 显示有效数据

我试图`Person`实现`INotifyPropertyChanged`

```
public event PropertyChangedEventHandler PropertyChanged;
private void onPropertyChanged(object sender, string propertyName) {
    if (this.PropertyChanged != null) {
        PropertyChanged(sender, new PropertyChangedEventArgs(propertyName));
    }
}

public string Name {
     get { return name; }
     set {
        name = value;
        onPropertyChanged(this, "allPersonClass");
     }
} 
```

并在每个属性设置器中`onPropertyChanged(this, "propertyName");`执行但 listBox 从不更新已创建的项目

知道可能出了什么问题吗？

这是带有 listBox xaml 的窗口

```
 <Button x:Name="btnDetail" Content="Detail" HorizontalAlignment="Left" Margin="361,249,0,0" VerticalAlignment="Top" Width="75" Click="ButtonDetailClick"/>
     <ListBox x:Name="listPerson" ItemsSource="{Binding Path=AllPerson}" HorizontalAlignment="Left" Height="170" Margin="33,29,0,0" VerticalAlignment="Top" Width="155" IsSynchronizedWithCurrentItem="True"/>
     <Button x:Name="btnLoad" Content="Load" HorizontalAlignment="Left" Margin="58,249,0,0" VerticalAlignment="Top" Width="75" Click="btnLoad_Click"/>
     <Button x:Name="btnSave" Content="Save" HorizontalAlignment="Left" Margin="138,249,0,0" VerticalAlignment="Top" Width="75" Click="ButtonSaveClick"/> 
```

这是进行修改的 DetailView 窗口的一部分（绑定到 Person）

```
<TextBox Text="{Binding Path=Name}" Height="23" HorizontalAlignment="Left" Margin="118,20,0,0" Name="txtName" VerticalAlignment="Top" Width="141" /> 
```

这是 AllPersonClass 的一部分：

```
public class AllPersonClass {
  private ObservableCollection<Person> allPerson;

public AllPersonClass() {
     allPerson = new ObservableCollection<Person>();
  }

public ObservableCollection<Person> AllPerson {
     get { return allPerson; }
     set { allPerson = value; }
  }

 public void addPerson(Person newPerson) {
     allPerson.Add(newPerson);
  }

public Person getPerson(int personIndex) {
     return allPerson[personIndex];
  }
} 
```

编辑

这是在详细视图中保存更改的方法的相关部分

```
private void OnBtnSaveClick(object sender, RoutedEventArgs e) {
     person.Name = txtName.Text;
     person.SurName = txtSurName.Text;
} 
```

请注意，在“ObservableCollection allPerson”中进行了更改，只有 listBox 一直显示旧数据

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-13T22:07:00.323

如果您希望在更改 Person 属性时更新 UI，您必须通知该属性已更改，而不是类

```
public string Name 
{
     get { return name; }
     set 
     {
        name = value;
        onPropertyChanged(this, "allPersonClass");
     }
}

<TextBox Text="{Binding Path=Name}" ..... 
```

应该

```
public string Name 
{
     get { return name; }
     set 
     {
        name = value;
        onPropertyChanged(this, "Name");
     }
}

<TextBox Text="{Binding Path=Name, UpdateSourceTrigger=PropertyChanged}" ..... 
```

而且您不必覆盖模型以在您的 中正确显示`ToString()`，您可以设置以在`Person``ListBox``ListBox` `DisplayMemberPath``ListBox`

```
 <ListBox ItemsSource="{Binding Path=AllPerson}" DisplayMemberPath="Name" /> 
```

编辑：回答您的评论问题：

```
public string Name 
{
     get { return name; }
     set 
     {
        name = value;
        onPropertyChanged(this, "Name");
        onPropertyChanged(this, "Display");
     }
}

public string Surname
{
     get { return surname; }
     set 
     {
        surname= value;
        onPropertyChanged(this, "Surname");
        onPropertyChanged(this, "Display");
     }
}

public string Display
{
     get { return Name + " " + Surname; }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-13T21:55:06.077

在您的 DetailView 中，您需要定义一个 TwoWay-Binding 来更新您的`person`类的属性名称。

```
<TextBox Text="{Binding Path=Name, Mode=TwoWay}" Height="23" HorizontalAlignment="Left" Margin="118,20,0,0" Name="txtName" VerticalAlignment="Top" Width="141" /> 
```

此外，如果您想在每次写入文本时更新属性，您还需要定义`UpdateSourceTrigger`with `PropertyChanged`。否则，该属性仅在 TextBox 失去焦点时更新。

```
<TextBox Text="{Binding Path=Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Height="23" HorizontalAlignment="Left" Margin="118,20,0,0" Name="txtName" VerticalAlignment="Top" Width="141" /> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-14T09:01:41.403

您的问题是您的收藏永远不会收到有关您的 PropertyChanged 的​​通知

这应该可以帮助你

```
ObservableCollection<INotifyPropertyChanged> items = new ObservableCollection<INotifyPropertyChanged>();
    items.CollectionChanged += new System.Collections.Specialized.NotifyCollectionChangedEventHandler(items_CollectionChanged);

    static void items_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        foreach (INotifyPropertyChanged item in e.OldItems)
            item.PropertyChanged -= new PropertyChangedEventHandler(item_PropertyChanged);

        foreach (INotifyPropertyChanged item in e.NewItems)
            item.PropertyChanged += new PropertyChangedEventHandler(item_PropertyChanged);
    }

    static void item_PropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        throw new NotImplementedException();
    } 
```

**另请参阅此[链接](https://stackoverflow.com/questions/901921/observablecollection-and-item-propertychanged)**

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-13T21:40:31.880

我想你可能想回顾一下你是如何在项目级别进行绑定的。查看此链接，它将帮助您入门：

[如何确定 ObservableCollection<T> 中的一行是否实际更改](https://stackoverflow.com/questions/12710787/how-to-determine-if-a-row-in-observablecollectiont-actually-changed)

# ruby - 红宝石在线救援

> ID：15396791
> 
> 赞同：21
> 
> 时间：2013-03-13T21:26:44.803
> 
> 标签：ruby, rescue

我最近了解到，您可以`rescue`在一行代码上使用，以防该行出现问题（请参阅[http://www.rubyinside.com/21-ruby-tricks-902.html](http://www.rubyinside.com/21-ruby-tricks-902.html)提示 #21）。我有一些过去看起来像这样的代码：

```
if obj['key'] && obj['key']['key2'] && obj['key']['key2']['name']
  name = obj['key']['key2']['name']
else
  name = ''
end 
```

使用该`rescue`方法，我相信我可以将该代码更改为以下内容：

```
name = obj['key']['key2']['name'] rescue '' 
```

如果在访问哈希的任何级别引发 nil 异常，它应该被救援捕获并给我''，这就是我想要的。`nil`如果这是所需的行为，我也可以选择将名称设置为。

这样做有什么已知的危险吗？我问是因为这似乎好得令人难以置信。我有很多丑陋的代码，我很想摆脱它，看起来就像第一个代码示例。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-13T21:42:23.250

读起来不错！但它会影响你的表现。根据我的经验`rescue`，触发时速度要慢得多，不触发时速度要慢一些。在所有情况下`if`都更快。另一件需要考虑的事情是，不应期望出现异常，并且您会使用此代码。拥有如此深嵌套的哈希可能是一种很好的气味，需要重构

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-04-15T17:01:37.360

现在可以使用 Ruby 2.3 的[dig 方法](https://bugs.ruby-lang.org/issues/11643)来实现这个特定的示例。

```
name = obj.dig 'key', 'key2', 'name' 
```

这将安全地访问`obj['key']['key2']['name']`，如果任何步骤失败则返回 nil 。

（一般来说，通常建议只对真实的、未预料到的错误使用异常，尽管在这样的示例中，如果语法使其变得麻烦，这是可以理解的。）

# iphone - 通过自定义 UITableViewCell 和 UITableView 处理多个对象的触摸事件

> ID：15396798
> 
> 赞同：0
> 
> 时间：2013-03-13T21:27:11.777
> 
> 标签：iphone, ios, objective-c, ipad

我正在开发一个包含两种不同类型的自定义 UITableViewCells 的 UITableView，每个单元格都设置为 UITable 的不同部分。我希望单元格在触摸时突出显示为不同的颜色，然后在触摸结束后恢复为以前的颜色。由于这不遵循标准 UITableViewCell 的标准触摸高亮实现，因此我在自定义单元格类中添加了 TouchesBegan() 和 TouchesEnd() 方法以获得这种效果。但是，UITable 不会捕获任何触摸，因此不会执行其他标准表功能所需的 didSelectRowAtIndexPath() 或 deselectRowAtIndexPath() 方法。如果我注释掉自定义单元格的 TouchesBegan/TouchesEnd 方法，那么 UITable 将捕获触摸并调用这些方法。有没有办法让自定义单元格执行它们的触摸方法以及 UITable 在单次触摸时执行 didSelect/deselect 方法？这是我对 UITable 的第一次破解，并具有预期的自定义功能，我很挣扎。如果我的代码中除了我的问题之外的任何内容不合适，我深表歉意，并提前感谢您的建议。以下是这些部分的代码：

自定义单元格的触摸方法：

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

UITouch *touch = [[event allTouches]anyObject];

if([touch view] == self.nameLabel) {
    CGFloat isRed = 151.0/255.0;
    CGFloat isGreen = 151.0/255.0;
    CGFloat isBlue = 151.0/255.0;

    self.nameLabel.backgroundColor = [[UIColor alloc]initWithRed:isRed green:isGreen blue:isBlue alpha:1.0];

    if(!self.currentlySelected) {

        self.currentlySelected = YES;
        self.accessoryButton.hidden = NO;
    }
    else {
        self.currentlySelected = NO;
        self.accessoryButton.hidden = YES;
    }

}
}

-(void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
UITouch *touch = [[event allTouches]anyObject];

if([touch view] == self.nameLabel) {
    self.nameLabel.backgroundColor = [[UIColor alloc]initWithRed:self.isRed green:self.isGreen blue:self.isBlue alpha:1.0];
}
} 
```

对于 UITableViewController 中的 didSelect/DeselectRow 方法：

```
-(UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section {

UIView *headerView = [[UIView alloc] initWithFrame:CGRectMake(0,0, self.tableView.bounds.size.width, 30.0)];
UILabel *headerLabel = [[UILabel alloc] initWithFrame:CGRectZero];

CGFloat isRed = 84.0/255.0;
CGFloat isGreen = 84.0/255.0;
CGFloat isBlue = 84.0/255.0;

self.headerColor = [[UIColor alloc]initWithRed:isRed green:isGreen blue:isBlue alpha:0.5];

headerLabel.backgroundColor = self.headerColor;
headerLabel.opaque = NO;
headerLabel.textColor = self.textColor;
headerLabel.highlightedTextColor = [UIColor whiteColor];
headerLabel.font = [UIFont systemFontOfSize:18.0];
headerLabel.frame = CGRectMake(0.0, 0.0, self.tableView.bounds.size.width, 30.0);

if (section == 0) {
    [headerView setBackgroundColor:self.backgroundColor];
    headerLabel.text = @"Alley";
    [headerView addSubview:headerLabel];
}
else {
    [headerView setBackgroundColor:self.backgroundColor];
    headerLabel.text = @"Bowlr";
    [headerView addSubview:headerLabel];
}
return headerView;
}

-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

if(self.lastIndexPathForAlleyCells == indexPath) {
    [self.tableView beginUpdates];
    [self.tableView deselectRowAtIndexPath:self.lastIndexPathForAlleyCells animated:NO];
    [self.tableView endUpdates];
}
if(indexPath.section == 0) {

    [self.tableView beginUpdates];
    [self.tableView deselectRowAtIndexPath:self.lastIndexPathForAlleyCells animated:NO];

    AlleyTableViewCell *cell = (AlleyTableViewCell *)[self.tableView cellForRowAtIndexPath:indexPath];
    cell.accessoryButton.hidden = NO;
    self.lastIndexPathForAlleyCells = indexPath;
    [self.tableView endUpdates];
}

else if(indexPath.section == 1) {
    PlayerTableViewCell *cell = (PlayerTableViewCell *)[self.tableView cellForRowAtIndexPath:indexPath];
    [cell.accessoryButton setImage:[UIImage imageNamed:@"Checkmark.png"] forState:UIControlStateNormal];
    [cell setSelected:NO animated:NO];
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:31:31.553

使用**UIGestureRecognizer**而不是`touch delegates`.

或者

打开相应的单元格`didSelectRowAtIndexPath`并执行您需要的任何操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:33:50.817

如果您希望单元格的选择颜色不同于默认的蓝色，只需在 cellForRowAtIndexPath 方法中设置单元格的 backgroundView 属性：

```
UIView *backgroundView = [[UIView alloc] initWithFrame:cell.frame];
backgroundView.backgroundColor = [UIColor colorWithRed:0.90f green:0.90f blue:0.90f alpha:1.00f];
cell.selectedBackgroundView = backgroundView; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T17:11:28.213

这个问题的答案实际上是对一个有点普遍的问题的一个有点普遍的答案。考虑到 UITable 的单元格的定制，如何处理这个问题可能并不那么明显。

它与处理自定义单元格中的触摸事件有关，然后将触摸事件也发送到父视图，在本例中为 UITable。

这是帮助解决此问题的帖子的链接：

[处理父视图触摸](https://stackoverflow.com/questions/6408375/handling-parent-view-touches)

当您覆盖子类中的触摸方法时，写下您希望看到子类执行的功能，并在每个方法的末尾包括：

[super touchesBegan: touches withEvent: event];

对每个触摸方法执行完全相同的操作：touchesMoved、touchesEnd、touchesCancelled。

我的 UITable 现在接收触摸事件，并且 didSelectRowAtIndexPath 和 deselectRowAtIndexPath 方法现在可以工作，因为它们接收触摸事件。我希望这可以帮助别人！

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    [super touchesBegan: touches withEvent: event];
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{ 
    [super touchesMoved: touches withEvent: event];
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event { 
    [super touchesEnded: touches withEvent: event];
} 
```

# java - Java：扫描仪浮动错误

> ID：15396801
> 
> 赞同：0
> 
> 时间：2013-03-13T21:27:15.453
> 
> 标签：java, exception

我正在尝试在浮点数组中引入一组浮点数：

```
protected float[] a = new float [100];

public void setCoef(){

    System.out.println("Introduceti coeficientii: ");
    for (int i = 0; i <= this.grad; i++)
    {
        Scanner in = new Scanner(System.in);
        this.a[i] = in.nextFloat();
    }

} 
```

但是当我输入 2.3 时它会产生这个异常，例如：

```
Exception in thread "main" java.util.InputMismatchException
at java.util.Scanner.throwFor(Scanner.java:909)
at java.util.Scanner.next(Scanner.java:1530)
at java.util.Scanner.nextFloat(Scanner.java:2388)
at polinom.PolinomR.setCoef(PolinomR.java:35)
at polinom.PolinomReal.grade_coef(PolinomReal.java:14)
at polinom.Operatii.main(Operatii.java:43) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:38:47.627

[输入不匹配异常](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/InputMismatchException.html)：

> 由 Scanner 抛出以指示检索到的令牌与预期类型的​​模式不匹配，或者令牌超出预期类型的​​范围。

您收到此异常是因为您尝试插入错误的值。

确保您正在插入`2.3`，而`2,3`不是数字以外的其他内容。

如果您输入，您的程序应该可以正常运行`2.3`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:45:45.057

您应该检查输入的值是否可以解释为浮点数。`hasNextFloat()`在尝试使用之前尝试使用来验证该值。如果您遇到错误的值，我不知道您想做什么，但这将设法避免异常。

您可以使用以下内容：

```
protected float[] a = new float [100];

public void setCoef(){

    System.out.println("Introduceti coeficientii: ");
    Scanner in = new Scanner(System.in);
    for (int i = 0; i <= this.grad; i++)
    {
        while (!in.hasNextFloat())
        {
            // Do something with bad value, e.g.
            // System.out.println("Bad value");
            // in.nextLine();
        }
        this.a[i] = in.nextFloat();
    }
} 
```

另外，我不确定是什么`this.grad`，但是您应该确保它小于的大小`a`或将其添加到 for 循环中的检查中。

# list - Python 对象包含另一个对象的列表抛出 AttributeError

> ID：15396802
> 
> 赞同：0
> 
> 时间：2013-03-13T21:27:15.907
> 
> 标签：list, object, python-3.3

带有 Aptana IDE 的 Python 3.3 版

我在工作之余自学python，所以我决定重新创建一个我和朋友玩的扑克游戏。为了方便对不同函数的各种调用，我创建了两个对象。一个对象包含整个游戏的数据 GameData，第二个对象包含一个玩家 Player，我试图将其添加到 GameData。

下面的代码循环并尝试将 Player 添加到 GameData 中的列表中，但我收到一条错误消息：

AttributeError：类型对象“GameData”没有属性“玩家”

```
class Player(object):
    def __init__(self, seat):
        self.seat = seat
        self.chips = 0
        self.wins = 0
        self.card = 0
        self.isDealer = False

class GameData(object):
    def __init__(self):
        self.games = 0
        self.numPlayers = 0
        self.chips = 0
        self.players = []
        self.deck = [] 
```

下面的函数抛出错误

```
def testDealCards():
    gd = nuts.GameData #declare GameData object
    gd.deck = [7,5,5,5,3,1,5,6,1,2] #assign values to deck list
    for x in range(2): #loop to create player objects in GameData
        gd.players.append(Player)
    gd.players[0].isDealer = True
    gd.players[1].isDealer = False
    print(gd.players)
    nuts.dealCards(gd)
    assert gd.players[0].card == 5
    assert gd.players[1].card == 7
    pass 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:38:09.690

您正在访问`GameData`类类型而不是创建对象。

试试这个：

```
gd = nuts.GameData() 
```

# shipping - 让我的 Big Commerce Store 与我的 LTL Shipping 供应商合作

> ID：15396809
> 
> 赞同：-1
> 
> 时间：2013-03-13T21:27:31.927
> 
> 标签：shipping

我的 Big Commerce Store 是 www.BarChefs.com 我们的 LTL Freight Shipper 是 www.YRC.com

目前，我们的网站为我们较重的运输物品提供通用的船舶重量数据。基本上，这已经在我们的 UPS 网站上运行。当客户购买某物时，它会从 UPS 在线工具中获得真实报价并收取费用。我需要这个来处理货运，因为我们的大多数物品对于 UPS 来说都太重了。

我需要我们的网站从 YRC 网站提取实际报价并在结帐时向他们收费。

另外，我需要考虑它们是住宅还是商业。

当我打电话给 BigCommerce 推荐的设计师和开发人员时，我似乎找不到任何知道我在说什么的人。

安迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-03T14:55:52.500

我的朋友，我们在同一条船上……我们的 BC 商店有许多 LTL 商品，目前依赖于使用预购系统，该系统倾向于“获取报价”系统 atm。

选择：

Echo.com 是免费的（运费计入运费），但仅限于报价。它没有太多内容......我们正在尝试更多地测试它以发现更多策略，但它是一条路线。它的大量手动集成。

Pacejet.com 价格昂贵（每月 250 多个），但可以满足您的需求，包括托盘制造商、委托、托运、采购订单、多费率等。

FreightQuote.com 也声称可以这样做，但是像 echo 似乎并不富裕。我不知道freightquote.com 的费用。Pacejet def 通常在任何框架中为货运经理提供蛋糕。

# linux - 捕获 HTTP 请求以进行回复

> ID：15396810
> 
> 赞同：1
> 
> 时间：2013-03-13T21:27:37.583
> 
> 标签：linux, http

有没有可以在 Linux 服务器上运行的工具，它可以让我从生产环境中捕获 HTTP 请求，然后能够在我的暂存环境中重放这些请求，以确保新代码和服务器能够处理该数字的请求。

# joomla - Joomla Virtuemar 2.x

> ID：15396813
> 
> 赞同：0
> 
> 时间：2013-03-13T21:27:46.320
> 
> 标签：joomla, virtuemart

我正在处理以在产品详细信息页面中显示同一制造商的其他产品列表。我的意思是，如果你穿着阿迪达斯的鞋子，页面会显示另一个阿迪达斯产品。所以我有这个代码：

[http://codepad.org/pO8XF0OI](http://codepad.org/pO8XF0OI)（这里不知道怎么写代码）

实际工作，但仅按制造商的类别显示产品。

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T03:09:26.347

试试这个，

如果您使用的是 Vm2.x，它将为您提供一个制造商下的完整产品。您可以根据您的要求添加或删除另一个表。

```
 $db = &JFactory::getDBO();
                            $sql = "SELECT N.product_name,M.virtuemart_product_id,MN.mf_name 
                            FROM jos_virtuemart_product_manufacturers AS M 
                            LEFT JOIN jos_virtuemart_products AS P ON M.virtuemart_product_id = P.virtuemart_product_id
                            LEFT JOIN jos_virtuemart_products_en_gb  AS N ON N.virtuemart_product_id = M.virtuemart_product_id
                            LEFT JOIN jos_virtuemart_manufacturers_en_gb AS MN ON MN.virtuemart_manufacturer_id = M.virtuemart_manufacturer_id
                            WHERE M.virtuemart_manufacturer_id = '$manufature_id'";
                            $db->setQuery($sql);
                            $db->query();
                            $res = $db->loadAssocList();
                            echo "<pre/>";
                            print_r($res); 
```

希望这可能会有所帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T15:18:13.833

大功告成，代码如下：

```
<?php
    $db = &JFactory::getDBO();
    $manufacturer = $this->product->virtuemart_manufacturer_id;
    $sql = "SELECT N.product_name,I.virtuemart_media_id,M.virtuemart_product_id,MN.mf_name 
    FROM h3ls8_virtuemart_product_manufacturers AS M 
    LEFT JOIN h3ls8_virtuemart_products AS P ON M.virtuemart_product_id = P.virtuemart_product_id
    LEFT JOIN h3ls8_virtuemart_products_es_es  AS N ON N.virtuemart_product_id = M.virtuemart_product_id
    LEFT JOIN h3ls8_virtuemart_product_medias  AS I ON M.virtuemart_product_id = I.virtuemart_product_id
    LEFT JOIN h3ls8_virtuemart_manufacturers_es_es AS MN ON MN.virtuemart_manufacturer_id = M.virtuemart_manufacturer_id
    WHERE M.virtuemart_manufacturer_id = '$manufacturer'"; // h3ls8_ is your table Prefix
    $db->setQuery($sql);
    $db->query();
    /* $res = $db->loadAssocList(); //This Load the info as a List */
    $prod = $db->loadObjectList(); // This Load the info as a group of objects for loading it.

    JRequest::setVar('virtuemart_manufacturer_id',$this->product->virtuemart_manufacturer_id,'GET');
    $productModel = VmModel::getModel('product');

    if ($this->product->virtuemart_manufacturer_id !=0 ) {
        $products = $prod;
        $productModel->addImages($products);
        $this->assignRef('products', $products);
    }
    // Show Products
    if (!empty($products)) { ?>
        <div class="seven columns obras">
            <h5> Obras </h5>
            <div class="row">
                <?php
                // Start the Output
                foreach ($products as $product) {
                // Show Products
                ?>
                <div class="four columns mobile-two end producto">
                    <div class="imagen">
                        <!-- <?php //if ($product->product_special == 1) { ?>
                        <div class="oferta">
                            <br />
                        </div>
                        <?php}?> *** If you wanna add some especial icon to a Special product uncommnent this *** -->  
                        <?php 
                            echo JHTML::_('link', JRoute::_('index.php?option=com_virtuemart&view=productdetails&virtuemart_product_id='.$product->virtuemart_product_id.'&virtuemart_category_id='.$product->virtuemart_category_id),$product->images[0]->displayMediaThumb('class="catImage"',false));
                        ?>
                    </div>
                </div> <!-- end of product -->
                <?php } ?>
            </div>
        </div>
    <?php } ?> 
```

# c# - SQL插入命令仅在循环中工作一次

> ID：15396814
> 
> 赞同：3
> 
> 时间：2013-03-13T21:27:52.913
> 
> 标签：c#, sql, sql-server, database, visual-studio-2010

这是 s for 循环，它将转到时间并将时间列设置为 true。这是第一次工作，但是当时间增加 0.5 时，它仍然是错误的。当我尝试 MessageBox.Show("" + Time1 + ""); 时，for 循环正在工作 在 for 循环内。

```
for (double Time = time_began_5; Time < time_finished_5; Time = Time + 0.5)
        {
            string Time1 = Time.ToString("0.00");

            try
            {
                SqlConnection cn = new SqlConnection("Data Source=.\\SqlExpress;Initial Catalog=AllensCroft;Integrated Security=True;MultipleActiveResultSets=True;Application Name=EntityFramework;");

                cn.Open();
                SqlCommand Command = new SqlCommand("INSERT INTO Slots ([Date],[RoomID],[" + Time1 + "]) Values (@date,@room,1)", cn);
                Command.Parameters.AddWithValue("date", date);
                Command.Parameters.AddWithValue("room", rooms_combo.SelectedValue);

                Command.ExecuteNonQuery();

                try
                {
                    cn.Close();
                }
                catch (Exception e)
                {
                    Console.WriteLine(e.ToString());
                }

            }
            catch (Exception e)
            {
                Console.WriteLine(e.ToString());
            }

        } 
```

这是数据库的样子，第一个真正的字段有效，但是当它循环到另一个时间时，它仍然是错误的，我认为这可能是因为如果我有一个具有该日期的现有行（日期是主键），我无法更新该行，所以我可能需要一个如果该行存在，更新，否则创建一个新行。

![插槽数据库](../Images/482ae22521c1c8ea8707ca35fd1abadd.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:32:34.273

你正在做一个插入。在每个循环中，您插入一个新行并仅为名称等于变量当前值的列设置值 true `Time1`。

没有其他列的值，它们可能默认为 false。（我想是位列）

如果您希望每列的默认值为 true，则最好更改数据库模式，为每个时间列添加默认值，否则您需要一长串参数

编辑：如果您的逻辑要求每个日期只需要一行，并且如果您输入上述情况，则将每个时间列设置为 true，那么您可以使用存储过程在数据库中移动此逻辑：

```
CREATE PROCEDURE InsertOrUpdateSlotFromCode(@dt smalldatetime, @roomID int)
AS
BEGIN
    DECLARE @cnt INT
    SELECT  @cnt = COUNT(*) from Slots WHERE [Date] = @dt
    if @cnt = 0 
        INSERT INTO Slots ([Date],[RoomID], <here all the time fields> VALUES (@dt, @roomID, 1, ....)
    else
        UPDATE Slots SET [09.00] = 1, ..... WHERE [Date] = @dt
    End 
END 
```

然后你的代码调用 sp

```
using(SqlConnection cn = new SqlConnection(.........))
{
    cn.Open();
    SqlCommand Command = new SqlCommand("InsertOrUpdateSlotFromCode", cn);
    Command.CommandType = CommandType.StoredProcedure;
    Command.Parameters.AddWithValue("date", date);
    Command.Parameters.AddWithValue("room", rooms_combo.SelectedValue);
    Command.ExecuteNonQuery();
} 
```

当然现在你可以完全摆脱循环

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T21:44:29.863

试试这个，你不必在每个循环中打开连接，创建你的 sql 语句首先循环每个值，然后使用一个语句插入

```
private string CreateInsertStatement(double time_began_5, double time_finished_5)
{
   string sql = "INSERT INTO Slots ([Date],[RoomID],";
   string valuesql = " Values (@date,@room,";
   for (double Time = time_began_5; Time < time_finished_5; Time = Time + 0.5)
   {
    string Time1 = Time.ToString("0.00");
    sql+ = "[" + Time1 + "],";
    valuesql+ = "1,";
   }
   sql = sql.TrimEnd(',') + ") ";
   valuesql = valuesql.TrimEnd(',') + ") ";

   return sql + valuesql;
}

private string CreateUpdateStatement(double time_began_5, double time_finished_5)
{
    string sql = "UPDATE Slots SET ";
    string wheresql = " WHERE [Date] = @date AND [RoomID] = @room";
    for (double Time = time_began_5; Time < time_finished_5; Time = Time + 0.5)
    {
        string Time1 = Time.ToString("0.00");
        sql+ = "[" + Time1 + "] = 1,";        
    }
    sql = sql.TrimEnd(','); 
    return sql + wheresql;
} 
```

然后在你实际的插入代码中：

```
try
{
    SqlConnection cn = new SqlConnection("Data Source=.\\SqlExpress;Initial Catalog=AllensCroft;Integrated Security=True;MultipleActiveResultSets=True;Application Name=EntityFramework;");

    cn.Open();
    SqlCommand Command;
    //check if row exists 
    Command = new SqlCommand("select count(*) from Slots WHERE [Date] = @date AND [RoomID] = @room", cn);
    Command.Parameters.AddWithValue("date", date);
    Command.Parameters.AddWithValue("room", rooms_combo.SelectedValue);

    var cnt = Command.ExecuteScalar();
    if(cnt!=null)
    {
        string sqlstr = ""
        if(Int32.Parse(cnt.ToString()) > 0)
        {
            sqlstr = CreateUpdateStatement(time_began_5,time_finished_5);
        }
        else if(Int32.Parse(cnt.ToString()) == 0)
        {
            sqlstr = CreateInsertStatement(time_began_5,time_finished_5);
        }
        Command = new SqlCommand(sqlstr, cn);
        Command.Parameters.AddWithValue("date", date);
        Command.Parameters.AddWithValue("room", rooms_combo.SelectedValue);
        Command.ExecuteNonQuery();
    }
    try
    {
        cn.Close();
    }
    catch (Exception e)
    {
        Console.WriteLine(e.ToString());
    }
}
catch (Exception e)
{
    Console.WriteLine(e.ToString());
} 
```

# java - 从 Google App 引擎备份和恢复实体

> ID：15396815
> 
> 赞同：1
> 
> 时间：2013-03-13T21:27:58.807
> 
> 标签：java, google-app-engine, google-cloud-storage, google-cloud-datastore, database-backups

我正在寻找一种在 Google 应用程序引擎中以编程方式将数据从一个应用程序传输到另一个应用程序的方法。我知道有一种方法可以通过 database_admin 控制台实现这一点，但该过程的时间效率非常低。

我目前正在使用谷歌云存储（GCS）来实现这一点，但这涉及查询数据，将其保存到 GCS，然后从不同的应用程序中读取 GCS 并恢复它。如果有人知道以编程方式在两个应用程序之间传输数据的更简单方法，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T13:11:44.073

我自己没有尝试过，但听起来应该可以：使用 data_store 管理员将您的对象从一个应用程序备份到 GCS，然后使用您的另一个应用程序从 GCS 恢复该文件。如果您只需要一次同步，这应该是一个好方法。

如果您需要不断地将数据从一个应用程序复制到另一个应用程序，那么在一侧或两侧引入 REST 端点可能会有所帮助：

[https://code.google.com/p/appengine-rest-server/](https://code.google.com/p/appengine-rest-server/)（这是在 Python 中，我知道，但只需为 REST 端点定义您的应用程序版本）

您只需要确保您的模型定义在双方都匹配（几乎使用相同的部署代码更新双方的应用程序）并且只有需要同步数据跟踪上次同步时间并使用 REST 端点来拉取的一方在新数据中。Cron Jobs 可以做到这一点。

或者，在您的所有模型上创建一个 PostPut 回调，以便在每次将模型写入您的数据存储区到另一个应用程序上的正确 REST 端点时进行一次 POST 调用。

您可以使用一种方法批量更新，或者使用另一种方法保持不断更新的版本（以更多调用为代价）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-27T22:50:43.467

您可以使用 bulkloader 创建数据备份，然后在另一个应用程序上恢复它。

此处的详细信息： [https ://developers.google.com/appengine/docs/python/tools/uploadingdata?csw=1#Python_Downloading_and_uploading_all_data](https://developers.google.com/appengine/docs/python/tools/uploadingdata?csw=1#Python_Downloading_and_uploading_all_data)

如果您使用的是 Java，请参阅这篇文章： [下载 Google App Engine 数据库](https://stackoverflow.com/questions/3699114/downloading-google-app-engine-database/12458521#12458521)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T13:09:28.447

您是在尝试在两个 App Engine 应用程序之间移动数据，还是尝试从 App Engine 中导出所有数据以便迁移到不同的托管系统？您的问题没有足够的信息来理解您正在尝试做什么。基于模糊的要求，我会说通常这将使用您在一个公开数据的应用程序中编写的 Web 服务来处理，而其他应用程序调用该服务来使用数据。我不确定为什么 Cloud Endpoints 被否决，因为它提供了一种很好的方式来将您的数据公开为基于 JSON 的 Web 服务，而代码工作量最少。

我建议在您的问题中添加更多详细信息，例如您要完成的工作以及模拟数据示例。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-14T00:23:37.333

我不知道这是否适合您的具体场景，但[**Google Cloud Endpoints**](https://developers.google.com/appengine/docs/java/endpoints/overview)绝对是一种从 Google App Engine 以编程方式传输数据的简单方法。

这是一种 REST Web 服务的 Google 实现，因此它们允许您使用 URL 共享资源。这仍然是一项实验性技术，但只要我与他们合作过，他们就可以完美地工作。此外，它们与 GAE 和[**Google Plugin for Eclipse**](https://developers.google.com/eclipse/docs/cloud_endpoints?hl=es)很好地集成在一起。

[**您可以从JDO**](https://developers.google.com/appengine/docs/java/datastore/jdo/)持久类自动生成端点，我认为您也可以自动生成客户端库（尽管我没有尝试过）。

# wcf - WCF 服务与 Windows 身份验证一起使用，现在它需要匿名切换到使用 SSL

> ID：15396818
> 
> 赞同：0
> 
> 时间：2013-03-13T21:28:13.370
> 
> 标签：wcf, ssl, iis-7.5

我创建了一个使用 Windows 身份验证的 WCF 服务，该服务可以正常工作。现在我正在尝试添加 SSL。执行完这些步骤后，它现在似乎正在使用匿名身份验证，出现此错误：HTTP 请求被客户端身份验证方案“匿名”禁止。

任何线索将不胜感激。

我们在 Windows Server 2008 R2 和 .Net 版本 4 上使用 IIS 7.5

正常工作的配置文件具有此服务模型（服务器端）：

```
 <system.serviceModel>
    <bindings />
<client />
<services>
  <service name="WCFServiceTest.Service1" behaviorConfiguration="WCFServiceBehavior">
    <endpoint address="" binding="wsHttpBinding" contract="WCFServiceTest.WCFService1">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
    <host>
    </host>
  </service>
</services>
<behaviors>
  <serviceBehaviors>
    <behavior name="WCFServiceBehavior">

      <serviceMetadata httpGetEnabled="True" policyVersion="Policy15" />

      <serviceDebug includeExceptionDetailInFaults="True" />
    </behavior>
  </serviceBehaviors>
</behaviors> 
```

这是更改后的配置

```
 <system.serviceModel>
    <bindings>
        <wsHttpBinding>
            <binding name="TransportWsSecurity">
                <security mode="Transport">
                    <transport clientCredentialType="Windows"/>
                </security>
            </binding>
        </wsHttpBinding>
    </bindings>
    <client />
    <services>
        <service name="WCFServiceTest.Service1" behaviorConfiguration="WCFServiceBehavior">
            <endpoint address="" binding="wsHttpsBinding" 
                      bindingConfiguration="TransportWsSecurity"
                      contract="WCFServiceTest.WCFService1">
                <identity>
                    <dns value="localhost" />
                </identity>
            </endpoint>
            <endpoint address="mex" binding="mexHttpsBinding" contract="IMetadataExchange" />
            <host>
            </host>
        </service>
    </services>
    <behaviors>
        <serviceBehaviors>
            <behavior name="WCFServiceBehavior">

                <serviceMetadata httpsGetEnabled="True" policyVersion="Policy15" />

                <serviceDebug includeExceptionDetailInFaults="True" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

这是调用服务的代码。它永远不会到达只返回 true 的 IgnoreCertificateErrorHandler：

```
 ServicePointManager.ServerCertificateValidationCallback = new RemoteCertificateValidationCallback(IgnoreCertificateErrorHandler);
            WCFService1Client client = new WCFService1Client();

            client.ClientCredentials.Windows.ClientCredential.UserName = Utility1.GetConfig("RemoteLogin");
            client.ClientCredentials.Windows.ClientCredential.Password = Utility1.GetConfig("RemotePassword");

            try
            {
                result = client.SendUpdatesFromLocation(temp);
            }
            catch (FaultException<WCFProcessFault> ex)
            {
                string op = ex.Detail.Operation;
                string err = ex.Detail.Notes;

            }
            finally
            {
                client.Close();
            }
            WCFService1Client client = new WCFService1Client();

            client.ClientCredentials.Windows.ClientCredential.UserName = Utility1.GetConfig("RemoteLogin");
            client.ClientCredentials.Windows.ClientCredential.Password = Utility1.GetConfig("RemotePassword");

            try
            {
                result = client.SendUpdatesFromLocation(temp);
            }
            catch (FaultException<WCFProcessFault> ex)
            {
                string op = ex.Detail.Operation;
                string err = ex.Detail.Notes;

            }
            finally
            {
                client.Close();
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T05:14:31.793

```
<bindings>
    <wsHttpBinding>
        <binding name="TransportWsSecurity">
            <security mode="Transport">
                <transport clientCredentialType="Ntlm"/>
            </security>
        </binding>
    </wsHttpBinding>
</bindings> 
```

尝试上述更改。这将使用 Ntlm 而不是 Negotiate (Kerberos) 进行身份验证。您很可能还没有为 Kerberos 身份验证设置服务器。

# c - 权限被拒绝在 OS X (10.8.2) Mountain Lion 上执行任何 gcc 编译的 c 程序

> ID：15396823
> 
> 赞同：9
> 
> 时间：2013-03-13T21:28:33.533
> 
> 标签：c, xcode, macos, gcc, permission-denied

从终端执行我编译的任何 C 程序时`gcc`，我收到权限被拒绝错误。

首先，我已经验证并修复了我的驱动器上的权限（在此之前，发生了同样的问题）。

为了说明和隔离问题，我将向您展示这个超简单的 Hello World 程序会发生什么（其他程序也会发生同样的事情）：

```
#include <stdio.h>

main()
{
    printf("Hello World");
} 
```

现在，我将其另存为`helloworld.c`. 此时，从桌面`ls -l`返回：

```
total 8
-rw-r--r--  1 michael  staff  56 Mar 13 14:08 helloworld.c 
```

然后我编译`gcc -c helloworld.c -o helloworld`（我也尝试过不带`-o`标志的编译，结果相同）。没有警告或错误。`ls -l`现在返回：

```
total 16
-rw-r--r--  1 michael  staff   56 Mar 13 14:08 helloworld.c
-rw-r--r--  1 michael  staff  724 Mar 13 14:16 helloworld.o 
```

尝试执行 gcc 的输出，并`./helloworld.o`返回：

```
-bash: ./helloworld.o: Permission denied 
```

只是为了调试，如果我用 sudo ( `sudo ./helloworld.o`) 执行，它会返回：

```
sudo: ./helloworld.o: command not found 
```

现在，如果我尝试使用 设置可执行标志`chmod +x helloworld.o`，正如我发现的许多搜索结果所建议的那样，`ls -l`返回：

```
total 16
-rw-r--r--  1 michael  staff   56 Mar 13 14:08 helloworld.c
-rwxr-xr-x  1 michael  staff  724 Mar 13 14:16 helloworld.o 
```

但是，尝试使用`./helloworld.o`now 返回：

```
-bash: ./helloworld.o: Malformed Mach-o file 
```

现在，为了调试，`where gcc`返回：

```
/usr/bin/gcc 
```

所以，你可以看到我没有使用第三方`gcc`。

有谁知道可能是什么问题？我试过四处寻找，但找不到任何可行的解决方案。我之前遇到过同样的问题，并且从那时起重新安装了 OS X（出于不同的原因），并且在干净且有组织的开发环境中仍然存在这个问题。作为参考，我使用的是 OS X 10.8.2 并拥有 Xcode 4.6 以及最新版本的 Xcode 命令行工具（来自 Apple 的开发人员网站）。我没有从 Homebrew 或任何其他第三方来源安装 gcc；它是 Xcode 命令行工具附带的 gcc。

非常感谢您的帮助！我非常感谢您花时间阅读、诊断并提供帮助。:)

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-13T21:31:26.497

您正在尝试执行目标代码 (helloworld.o)，而不是编译和链接可执行二进制文件。不要使用该`-c`选项。改为运行：

```
$ gcc helloworld.c -o helloworld 
```

它将使用可执行权限创建。然后就可以运行了。

```
$ ./helloworld 
```

像平常一样。

* * *

原因是该`-c`选项告诉编译器只*编译*文件，而不是*链接*它。需要链接过程来创建最终的可执行文件。如果您不提供`-c`，gcc 将在幕后为您编译和链接。

# codeigniter - CodeIgniter - Smarty - 如何从 CodeIgniter 中的一个位置将模板提取到主模板中

> ID：15396836
> 
> 赞同：0
> 
> 时间：2013-03-13T21:29:33.873
> 
> 标签：codeigniter, smarty, fetch

解释我的问题有点困难，但我会尝试:)

在我使用 Smarty 的自定义项目中，我有一个 index.php 文件，其中放置了 url 处理和内容的所有基本设置。

例如：

```
// Get information for the "about us" page

if($_GET['qs']=='about_us'){
  $data['text'] = 'Lorem Ipsum...';
  $data['other_stuff'] = 'dolor sit amet';

  // Required template file
  $data['tpl_Name'] = 'about.tpl';
} 
```

在这个文件的底部，我有一些代码可以获取正确的模板，然后将其发送到 master_site 模板。

例如：

```
if (isset($data['tpl_Name'])){
  $this->smarty->assign('content', $this->smarty->fetch($data['tpl_Name'])); 
  $this->smarty->view('master_site.tpl');
} 
```

在 master_site.tpl 中，我可以使用 {$content} 访问 about.tpl 这个 {$content} 变量将为每个页面更改，因为 index.php 是通过请求页面发送所有数据的页面我的应用程序。

**问题**：CodeIgniter 中是否有一个文件在每个页面上都可用，以便我可以创建类似上面的内容？现在我必须在控制器的每个功能中使用这段代码（第二个示例），这似乎效率低下。

当然，我必须在每个函数中设置 $data['tpl_Name'] ，但这没问题。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T03:12:34.707

有几种方法可以将模板库集成到 CodeIgniter 中，其中很大程度上取决于您希望如何将模板绑定在一起。以下内容可能很适合您，或者可能只是为您指明正确的方向。它不是模板的唯一 Smarty/CI 解决方案，但它是我熟悉的解决方案。

[我编写了一些代码将 Smarty 集成到 CI](https://github.com/cryode/CodeIgniter_Smarty)中。它允许您使用加载视图的标准方式`$this->load->view('view', $data)`——但您可以在文件中使用 Smarty 的语法。

我处理“主”模板的方式是通过 Smarty 的`{extends}`（[模板继承文档](http://www.smarty.net/docs/en/advanced.features.template.inheritance.tpl)）。我加载的各个视图都扩展了一个主模板或一些其他层次结构，这些层次结构通向一个。

**main_template.php：**

```
<html>
<head>
    <meta>
    <meta>
    <title>{$title|default:"Default Title"}</title>
</head>
<body>

<header>
    <h1>My Website</h1>
</header>

<nav>
    <ul>
        <li>Page Link</li>
        <li>Page Link</li>
        <li>Page Link</li>
        <li>Page Link</li>
    </ul>
</nav>

<section class="main-content">

{block name=content}{/block}

</section>

<footer>
    &copy; 2013 Me!
</footer>

</body>
</html> 
```

**页面.php：**

```
{extends "main_template.php"}

{block "content"}

<h2>My Content Page</h2>

<p>Lorem ipsum and stuff...</p>

{/block} 
```

该`$title`变量将像往常一样添加到您的视图数据中，并且您将使用标准语法加载页面：

```
$data['title'] = 'My page';

$this->load->view('page', $data); 
```

我会让你调查 Smarty 文档以获得更深入的细节，但这是我以前做过的。:)

# c - 从另一个块中增加变量

> ID：15396839
> 
> 赞同：0
> 
> 时间：2013-03-13T21:29:38.627
> 
> 标签：c, fork, scope

我目前正在编写一个简单的 C 程序来从父进程创建指定数量的子进程，并且我试图通过每次增加变量**active**来跟踪其中有多少子进程实际上成功启动了一个孩子-进程成功。

但是，#!%€ 变量的愚蠢部分不允许我修改它。我是 C 的新手（因此程序的简单性和有问题的可用性），我在理解不同之处时遇到了一些问题变量范围以及何时以及如何修改它们以使新值保持不变...

所以，我的问题是；如何使变量“活动”增加 1？

我已经确保 newChild() 函数按应有的方式返回 1，并且该 if 语句中的其他代码有效，所以不是这样。而且，我也尝试过使用指针，但没有成功...... :(

```
# include <stdio.h>
# include <unistd.h>
# include <stdlib.h>
# include <sys/wait.h>

main()
{
    printf("Parent CREATED\nRunning code...\n");

    // INITIATE Variables
    int children = 5;
    int active = 0;
    int parentID = getpid();

    // INITIATE Random Seed
    srand(time(NULL));

    // CREATE Children
    int i, cpid, sleepTime;

    for (i = 0; i < children; i++)
    {
        // Only let the parent process create new children
        if (getpid() == parentID)
        {
            // GET Random Number
            sleepTime = rand() % 10;

            // CREATE Child
            if (newChild(sleepTime) == 1)
            {
                // Mark as an active child process
                active++;
            }
        }
    }

    // CLEAN UP
    if (getpid() == parentID)
    {
        // Let the parent process sleep for a while...
        printf("Parent is now SLEEPING for 20 seconds...\n");
        sleep(20);
        printf("Parent is now AWAKE\nActive children: %d\n", active);

        // WAIT for Children
        int cpid, i;
        int status = 0;

        for (i = 0; i < active; i++)
        {
            // WAIT for Child
            cpid = wait(&status);

            // OUTPUT Status
            printf("WAITED for Child\nID: %d, Exit Status: %d\n", cpid, status);
        }

        printf("All children are accounted for.\nEXITING program...\n");
    }
}

int newChild(int sleepTime)
{
    // INITIATE Variable
    int successful = 0;

    // CREATE Child Process
    int pid = fork();

    if (pid == -1)
    {
        // OUTPUT Error Message
        printf("The child process could not be initiated.");
    }
    else if (pid == 0)
    {
        // Mark child process as successfully initiated
        successful = 1;

        // OUTPUT Child Information
        printf("Child CREATED\nID: %d, Parent ID: %d, Group: %d\n", getpid(), getppid(), getpgrp());

        // Let the child process sleep for a while...
        printf("Child %d is now SLEEPING for %d seconds...\n", getpid(), sleepTime);
        sleep(sleepTime);
        printf("Child %d is now AWAKE\n", getpid());
    }

    return successful;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:46:32.857

调用 fork() 会产生三种结果，您的代码错误地将其压缩为两种：

1.  返回值 -1 表示分叉失败。这是一种不常见的错误情况。
2.  返回值 0 表示 fork 成功并且您现在处于子进程中。
3.  返回值 >0 表示 fork 成功并且您在父进程中。

请注意案例 2 和案例 3 是如何“成功”的。但是您的 newChild() 函数为案例 2 返回 1，为案例 3 返回 0。相反，它应该为案例 3 返回 1，而对于案例 2，它*甚至不应该 return*。如果你是情况 2，那么你就在子进程中，所以你应该只做你的子进程的东西然后退出，永远不要返回给调用者。

```
if (pid == -1)
{
    // OUTPUT Error Message
    printf("The child process could not be initiated.");
}
else if (pid == 0)
{
    // OUTPUT Child Information
    printf("Child CREATED\nID: %d, Parent ID: %d, Group: %d\n", getpid(), getppid(), getpgrp());

    // Let the child process sleep for a while...
    printf("Child %d is now SLEEPING for %d seconds...\n", getpid(), sleepTime);
    sleep(sleepTime);
    printf("Child %d is now AWAKE\n", getpid());

    // This is the child process, so we should NOT EVEN RETURN from newChild().
    exit(0);
}
else
{
    successful = 1;
} 
```

这里的关键观察是，当您调用 fork() 时，您的进程将分成两个独立的进程，*这两个*进程都从 fork() 返回的点继续执行。它们之间的区别在于，一个将获得 0 返回值，而另一个将获得 >0 返回值。前者是孩子，后者是父母。

在 fork() 之后，您现在运行了相同代码的两个副本，两个单独的 newChild() 调用正在运行，并且具有两个单独的`active`变量副本。分叉后有两个。

# c - 即使信号被禁用，多个信号怎么可能进入处理程序？

> ID：15396840
> 
> 赞同：1
> 
> 时间：2013-03-13T21:29:40.100
> 
> 标签：c, linux, signals, posix

所以我有以下代码段作为我的程序的一部分。Handler 是 SIGALRM 的处理程序。

```
 static void handler(void)
 {
     //DISABLE SIGALRM
     sigset_t oldset;
    disable_sigalrm(&oldset);
        if(queue_length(&queue) == 0)
        {
           ucontext_t context;
           getcontext(&context);
           swapcontext(&context,&uctxt_main);    
        }
        else
        {
            //...
            //enable sigalarm
        }
  } 
```

程序 disable_sigalrm 如下所示：

```
void disable_sigalrm(sigset_t* oldset)
{   
sigset_t sset;

//Empty sset
if(sigemptyset(&sset) == -1)
{
    printf("Error in emptying the signal set.\n");
}
//Add SIGALRM to sset
if(sigaddset(&sset,SIGALRM) == -1)
{
    printf("Error in adding SIGALRM to the specified signal set.\n");
}

//Block any occurence of SIGALRM
if(sigprocmask(SIG_BLOCK,&sset,oldset) == -1)
{
    printf("Error in adding the specified signal; set to the signal mask.\n ");
}
   } 
```

现在，当我在调试器中运行时，即使队列长度达到零，它也会不断返回处理程序。由于 SIGALRM 被禁用，唯一有意义的解释是是否有多个信号等待到达处理程序。是否有可能多个信号可以等待运行到处理程序？如果是这样，您将如何禁用它们运行处理程序？

# android - 按钮未水平居中

> ID：15396841
> 
> 赞同：1
> 
> 时间：2013-03-13T21:29:41.057
> 
> 标签：android, android-layout, android-button

我刚刚开始 Android 开发，但我无法弄清楚为什么我的按钮内的文本对齐方式没有水平居中。它是垂直居中的。

我试过重力、一些填充、中心和文本对齐中心，但没有运气。我正在使用 a`RelativeLayout`和`EditText`a`TextView`以上。当我从活动中取出其他视图时，也没有任何变化。

我可以让它以重力`center_vertical`和一些填充物为中心，但这种方法似乎不合适。

这是更新前的按钮视图：

![](../Images/a913b6096332e1582ee6259bdd921839.png)

**更新**：在我的 ADV 上针对 android:gravity="center_vertical|center_horizo​​ntal" 进行了测试，结果运行良好。似乎是 Eclipse 中图形布局视图的一个错误，它错误地对齐了 Button 视图的内部上下文。这是它在我的 AVD 上的工作：

![在此处输入图像描述](../Images/7bf6a83b6d62dbccc944a8f175e63f4e.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-14T05:42:28.213

将按钮的重力设置为 android:gravity = "center" 或 android:gravity = "center_vertical|center_horizo​​ntal" 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T21:38:16.373

尝试`layout_gravity="center"`或`gravity="center"`代替。我总是忘记是哪一个:P

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:41:21.817

android:gravity = "center" 将水平和垂直对齐按钮内的文本。

android:layout_gravity 与 android_gravity 不同。请参阅详细答案： [Android 上的 Gravity 和 layout_gravity](https://stackoverflow.com/questions/3482742/android-gravity-and-layout-gravity)

# ios - shouldAutorotate 没有被调用

> ID：15396844
> 
> 赞同：0
> 
> 时间：2013-03-13T21:29:42.110
> 
> 标签：ios, uiviewcontroller, uinavigationcontroller

我正在尝试根据用户在我的应用程序中的位置来定义支持的方向，我很难做到这一点。

到目前为止，我发现我应该使用现在在 iOS6 中支持的 supportedInterfaceOrientationsForWindow: 和 shouldAutorotate 方法，但是在我的 UIViewController 中定义它们的地方从来没有调用过这两种方法。

这就是我的代码的样子

```
- (BOOL)shouldAutorotate {
    return YES;
}

- (NSUInteger)supportedInterfaceOrientationsForWindow {
    return UIInterfaceOrientationMaskPortrait;
} 
```

在我的 Target Summary Supported Orientatoin 中，我取消了所有选项。我想我只会在每个 m ViewControllers 中定义支持的方向...我想知道这是否是正确的做法？

![在此处输入图像描述](../Images/18d026e436300e461fb9a36f8ee242ec.png)

现在我已经阅读了我想要做的事情取决于我的应用程序的结构，所以在这里我将概述我的应用程序。

*   主 UIViewController（3 个按钮将您带到（3 个不同的 navigationControllerViews）错误！只有一个 navigationController...抱歉，我已经很久没有查看此代码了。）
*   辅助 UIViewController（保存导航控制器）
*   其他 UIViewControllers（出现在辅助 NavigationController 中）

我希望每个 ViewController 直到 NavigationController 堆栈中的最后一个出现在 portrate 中。NavigationController 中的最后一个视图是一个特殊的视图，如果需要，它需要能够向左或向右旋转它的方向。

我想知道这是否可能，如果可能，为什么我上面的代码不能工作/被调用。

任何帮助将不胜感激。

// 更新问题 Re:

rootview加载（三个按钮，这是选择按钮以加载包含导航控制器的视图的方法）

```
- (IBAction)buttonClick: (UIButton *) sender
{   
//..

    // v ----->
    if ([sender isEqual:vUIButton]) {

        VSearchViewController *vSearchViewController = [[VSearchViewController alloc] initWithNibName:@"VSearchViewController" bundle:nil];
        [self.navigationController pushViewController:vehicalSearchViewController animated:YES];
    }
//..
} 
```

然后在 VSearchViewController 中，我将新视图加载到 UINavigation 堆栈中，如下所示

```
//..
FModelsViewController *fModelsViewController = [[FModelsViewController alloc] initWithNibName:@"FModelsViewController" bundle:nil];

            // Sets the back button for the new view that loads (this overrides the usual parentview name with "Back")
            self.navigationItem.backBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"Back" style: UIBarButtonItemStyleBordered target:nil action:nil];

            [self.navigationController pushViewController:fModelsViewController animated:YES];
//.. 
```

因此，在审查中，我已经在 appDelegate 中设置了导航控制器，并且我的应用程序中的所有视图都在 navigationStack 上......我说有 3 个 NavigationControllers 是错误的......只有一个并且每个视图都添加到堆栈中。 . 对此感到抱歉.. 自从我查看此代码以来已经一年半了..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:37:18.217

你是在 iOS6 上运行上面的代码吗？这些方法只会在 iOS6 上调用。

另外，也许您可​​以发布一些代码来更好地说明您是如何转换到这些 viewController 的，这样我们就可以更好地理解视图层次结构。

您可能想查看 UIViewController 的`addChildViewController:`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:47:54.780

我认为您的最后一个视图可以利用下面编写的代码。它会感知设备的方向，并会为横向视图显示不同的视图控制器（我假设这就是你想要做的）。这意味着您的最后一个视图将具有纵向和横向选项。

```
@implementation LastViewController

- (void)awakeFromNib
{
isShowingLandscapeView = NO;
[[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
[[NSNotificationCenter defaultCenter] addObserver:self
                        selector:@selector(orientationLastViewChanged:)
                        name:UIDeviceOrientationDidChangeNotification
                        object:nil];
}
- (void)orientationLastViewChanged:(NSNotification *)notification
{

UIDeviceOrientation deviceOrientation = [UIDevice currentDevice].orientation;
if (UIDeviceOrientationIsLandscape(deviceOrientation) &&
!isShowingLandscapeView)
{
[self performSegueWithIdentifier:@"LandscapeLastView" sender:self];
isShowingLandscapeView = YES;
}
else if (UIDeviceOrientationIsPortrait(deviceOrientation) &&
    isShowingLandscapeView)
{
[self dismissViewControllerAnimated:YES completion:nil];
isShowingLandscapeView = NO;

}

} 
```

在通向您希望锁定为纵向的视图的视图控制器上，编写以下代码：

```
- (BOOL)shouldAutorotate {
return NO;
} 
```

至于您支持的界面方向，请保留它的方式。

# git - 如何解决“无效的仓库名称”Git 错误？

> ID：15396853
> 
> 赞同：3
> 
> 时间：2013-03-13T21:30:36.973
> 
> 标签：git, gitolite, gitlab

我已经安装了 Gitolite，就像 GitLab 说明中所说的那样，直到现在一切正常，repo 已创建......但是当尝试克隆或推送时，它返回 NO repo found - 或类似的东西。

但是当我将遥控器设置为完整路径时，就像`git@server:22/~git/repositories/repo.git`它克隆一样，但是当尝试推送时，它发现了一个错误：

```
git push origin master
ERROR: invalid repo name.
fatal: The remote end hung up unexpectedly 
```

会是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:54:44.570

该错误消息来自“ [`gitolite-shell.parse_soc()`](https://github.com/sitaramc/gitolite/blob/master/src/gitolite-shell#L139-L150)”

```
sub parse_soc {
    my $soc = $ENV{SSH_ORIGINAL_COMMAND};
    $soc ||= 'info';

    my $git_commands = "git-upload-pack|git-receive-pack|git-upload-archive";
    if ( $soc =~ m(^($git_commands) '/?(.*?)(?:\.git(\d)?)?'$) ) {
        my ( $verb, $repo, $trace_level ) = ( $1, $2, $3 );
        $ENV{D} = $trace_level if $trace_level;
        _die "invalid repo name: '$repo'" if $repo !~ $REPONAME_PATT;
        trace( 2, "git command", $soc );
        return ( $verb, $repo );
    } 
```

存在[`REPONAME_PATT`](https://github.com/sitaramc/gitolite/blob/master/src/lib/Gitolite/Rc.pm#L51)：

```
$REPONAME_PATT = qr(^\@?[0-9a-zA-Z][-0-9a-zA-Z._\@/+]*$); 
```

gitolite 地址不应包含任何路径，如下所示：

```
git@server:22/repo 
```

而不是，[这里描述了](http://gitolite.com/gitolite/sts.html#ybpfail)`git@server:22/~git/repositories/repo.git`这个问题：

> 考虑`git@server:repositories/reponame.git`。
> 克隆操作将起作用——您使用的是完整的 Unix 路径（假设为默认`$REPO_BASE`设置），因此 shell 会在您所说的位置找到存储库。
> 但是，当您推送时，gitolite 的更新钩子会启动，并且无法运行，因为它所期望的某些环境变量不存在。

# asp.net - ASP.NET 友好 URL 404 错误

> ID：15396857
> 
> 赞同：0
> 
> 时间：2013-03-13T21:30:45.280
> 
> 标签：asp.net, friendly-url

当我通过在站点深处加载页面来启动 Web 应用程序时，我在使用 ASP.NET 友好 URL 时始终收到 404 错误。

我可以通过以下方式重现：

1.  通过在网站根目录中加载页面来启动 Web 应用程序
2.  导航到 /Manage/ViewEmployee/1 等页面
3.  iis重置
4.  重新加载页面 /Manage/ViewEmployee/1

第 4 步将始终导致 404 错误。我可以在我的测试环境中始终如一地重现这一点：

*   视窗 2008 R2
*   IIS 7.5
*   ASP.NET 4.5
*   Microsoft ASP.NET 友好 URL 1.0.0

但是，我无法在 Windows 7 上使用 IIS Express 重现此问题。

我可以添加任何 web.config 设置来使用 IIS 7.5 解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T23:02:20.863

您是否能够通过在浏览器中输入 URL 来加载页面？我怀疑这个问题是 URL 的问题，而不是 IISRESET 的问题。由于您使用的是最新版本的 IIS，因此处理友好 url 的设置也应该没有问题。

# java - 使用方法在 ArrayLists 中循环

> ID：15396858
> 
> 赞同：2
> 
> 时间：2013-03-13T21:30:45.230
> 
> 标签：java, methods, multidimensional-array, arraylist, anagram

在很多帮助下，我开发了一种方法，可以制作字谜，然后将它们添加到`ArrayList`.

```
public void f(String s, String anagram, ArrayList<String> array)
{
    if(s.length() == 0)
    {
        array.add(anagram);
        return;
    }
    for(int i = 0 ; i < s.length() ; i++)
    {
        char l = s.charAt(i);
        anagram = anagram + l;
        s = s.substring(0, i) + s.substring(i+l, s.length());
        f(s,anagram,array);
    }
} 
```

问题是当我尝试使用此函数在将s 从一个添加到另一个`ArrayList`的循环中生成s 时，我收到一条错误消息，提示我不能使用 void，并且该方法为 void。`String``ArrayList``f()`

```
 List<String> Lists = new ArrayList<String>(); //makes new array list
        for(String List : words)
        { //takes values from old array list
            List.trim();
            Lists.add(f(List,"",new ArrayList<String>())); //this is where it doesn't work
        } 
```

让我再次澄清一下：我想使用此功能将`ArrayList`s of anagrams 插入 another 中的每个位置`ArrayList`。字谜列表源自`String`从一个列表读取到另一个列表的 s。我尝试将方法更改为静态，但这不起作用，我还删除了`return;`方法中的一次，但这也不能解决它。

我如何让这整个事情发挥作用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T21:32:24.843

发生错误是因为该方法`f()`是`void`，意思是：它不返回任何可以添加到`ArrayList`.

调用的答案`f()`存储在`ArrayList`作为参数传递给 的 中`f`，您可能应该使用*它* `ArrayList`来将其所有元素添加到`Lists`. 像这样的东西：

```
List<String> lists = new ArrayList<String>();
for (String list : words) {
    list.trim();
    ArrayList<String> answer = new ArrayList<String>();
    f(list, "", answer);
    lists.addAll(answer);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:34:20.320

您的 F 方法标头需要如下所示：

```
public String f(String s, String anagram, ArrayList<String> array) 
```

然后您返回一个字符串值以添加到您正在使用的 ArrayList 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:36:49.410

您的函数定义`f()`显示 type 的返回值`void`。因此，查看您正在尝试执行此操作的代码：

```
Lists.add(void); 
```

这显然是非法的。

您的选择实际上是在更大的范围内声明 ArrayList。

```
private List<String> anagrams;

public void f(String s, String anagram) {
  ...
  anagrams.add(anagram);
  ...
}

....

 for(String List : words) {
   //takes values from old array list
   anagrams = new ArrayList<String>();
   List.trim();
   f(list,"");
   Lists.add(anagrams); //this is where it doesn't work
 } 
```

# avd - Galaxy Note II 模拟器

> ID：15396862
> 
> 赞同：0
> 
> 时间：2013-03-13T21:30:53.663
> 
> 标签：avd, basic4android

我正在创建一个具有 720 X 1280 像素、5.5 英寸大小的选项的模拟器。

当我在我的真实手机（Galaxy Note II）上尝试我的代码时，视图是正确的，但是当我使用模拟器时，视图只是屏幕的 2/3。我们可以说真机显示正确的视图，模拟器的问题在哪里？

当我连接到真正的 Note II 时，它的比例值为 2，但是当我将它连接到模拟器时，它显示的比例值为 1.5，也许问题就是这个。如何在 AVD 中为 Note II 手机设置正确的比例，或者我在 AVD 中做错了什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-09-11T18:13:27.450

规模非常重要。请参阅本教程：[http ://www.basic4ppc.com/android/forum/threads/17647/#content](http://www.basic4ppc.com/android/forum/threads/17647/#content)

您应该将 DPI 值设置为 320 (2 * 160)。

# asp.net-mvc - Knockout Mapping 尝试未与 JSON 响应进行映射

> ID：15396868
> 
> 赞同：1
> 
> 时间：2013-03-13T21:31:10.373
> 
> 标签：asp.net-mvc, knockout.js, knockout-mapping-plugin

我是淘汰赛的新手，似乎根本无法获得一个简单的映射。我在 MVC4 C# 中。

我的视图看起来像这样：

```
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Index";
}

<h2>Simple Mapping Example</h2>

The time on the server is: <span data-bind="text: ServerTime"></span>
and <span data-bind="text: NumberOfUsersConnected"></span> user(s) are connected.

@section Scripts
{
    <script type="text/javascript">

        function ViewModel() {
            var self = this;

            self.ServerTime = ko.observable();
            self.NumberOfUsersConnected = ko.observable();
        }

        var vm = new ViewModel();
        ko.applyBindings(vm);

        $.getJSON('/Mapping/GetServerInfo', function(data) {
            ko.mapping.fromJSON(data, {}, vm);
        });

    </script>
} 
```

从控制器调用“Mapping/GetServerInfo”返回的示例 JSON 是：

```
{"ServerTime":"2013-03-13T14:24:10.5675104-07:00","NumberOfUsersConnected":5} 
```

对于我尝试过的文本和值的数据绑定，都没有导致任何数据被绑定和显示。

我错过了一些非常明显的东西吗？

根据评论中的问题，是的，这就是我的布局中的内容。

```
<script type="text/javascript" src="~/Scripts/knockout-2.2.1.js"></script>
<script type="text/javascript" src="~/Scripts/knockout.mapping-latest.js"></script> 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T21:48:52.070

从`$.getJSON` [文档](http://api.jquery.com/jQuery.getJSON/)

> 成功回调传递返回的数据，该数据通常是**由 JSON 结构定义并使用 $.parseJSON() 方法解析的 JavaScript 对象或数组。**

所以你的`data`变量持有一个已经解析的对象，所以你需要使用该`ko.mapping.fromJS`方法：

```
$.getJSON('/Mapping/GetServerInfo', function(data) {
   ko.mapping.fromJS(data, {}, vm);
}); 
```

# ruby-on-rails - 使用 Capybara 查找禁用字段

> ID：15396872
> 
> 赞同：20
> 
> 时间：2013-03-13T21:31:17.910
> 
> 标签：ruby-on-rails, capybara

我有一个带有标签的选择框：

```
<label for="slide_orientation">Slide orientation</label>
<select disabled="" class="property" id="slide_orientation" name="slide_orientation">
  <option value="horizontal">Horizontal</option>
  <option value="vertical" selected="selected">Vertical</option>
</select> 
```

如您所见，选择框已禁用。当我尝试用 找到它时`field_labeled("Slide orientation")`，它返回一个错误：

```
Capybara::ElementNotFound: Unable to find field "Slide orientation"
from /Users/pascal/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.0.2/lib/capybara/result.rb:22:in `find!' 
```

When the select box is not disabled, `field_labeled("Slide orientation")`returns the select element just fine.

这是预期的行为吗？如果是这样，我将如何寻找禁用的元素？就我而言，我需要它来测试它是否被禁用。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-09-03T01:42:35.070

[Capybara 2.1.0 支持`disabled`filter](https://github.com/jnicklas/capybara/issues/982)。您可以使用它轻松找到禁用的字段。

```
field_labeled("Slide orientation", disabled: true) 
```

您需要明确指定它，因为`disabled`默认情况下过滤器是关闭的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-13T23:22:33.867

如果它具有禁用属性，则此选项通过。

运行`js: true`和`page.evaluate_script`。

```
it "check slider orientation", js: true do
    disabled = page.evaluate_script("$('#slide_orientation').attr('disabled');")
    disabled.should == 'disabled' 
end 
```

**更新**

或者你可以使用`have_css`

```
page.should have_css("#slide_orientation[disabled]") 
```

[（从这个出色的答案](https://stackoverflow.com/a/5153771/440032)中窃取）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-07-20T13:55:26.057

由于这个问题的答案是旧的，并且从那时起事情已经发生了一点变化，所以这里是一个**UPDATE**。

如果您只想检查某个字段是否被禁用，您现在可以执行以下操作：

```
expect(page).to have_field 'Slide orientation', disabled: true 
```

根据这个 PR： [https ://github.com/teamcapybara/capybara/issues/982](https://github.com/teamcapybara/capybara/issues/982)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-14T15:14:58.907

安德烈亚斯和[这个答案](https://stackoverflow.com/a/4515097/414376)让我走上了最终解决方案的轨道。可以通过以下方式找到具有特定标签（而不是 HTML id）的禁用字段：

```
label_field = all("label").detect { |l| (l.text =~ /#{label}/i).present? }
raise Exception.new("Couldn't find field '#{label}'") if label_field.nil?
the_actual_field = first("##{label_field[:for]}") 
```

检查该字段是否被禁用可以用一个语句来完成：

```
page.should have_css("##{label_field[:for]}[disabled]") 
```

它仍然感觉像是一种解决方法，而不是最好的类似 Capybara 的解决方案，但它确实有效！

# jquery - 如何使用 jQuery Validate 插件测试 Recaptcha

> ID：15396874
> 
> 赞同：3
> 
> 时间：2013-03-13T21:31:22.850
> 
> 标签：jquery, jquery-validate, recaptcha

我正在使用 validate jquery 插件和 recaptcha 作为联系表单，我想知道如何在表单提交之前检查验证码中的代码是否正确，如果没有发送错误消息，因为现在验证所有内容，但我插入了一个无论如何，表单都提交了错误的代码。这是我的代码 ty 提前获取任何帮助

```
<script type="text/javascript">
             var RecaptchaOptions = {
                lang : 'en',
                theme : 'custom',
                custom_theme_widget: 'recaptcha_widget'
             };
            </script>

            <form id="contact" method="post" action="#">

                <fieldset>
                    <label for="name_contact">NAME</label>
                    <input type="text" class="input-xlarge" id="name_contact" name="name_contact" value="" placeholder="" minlength="2">

                    <label for="email_contact">EMAIL</label>
                    <input type="email" class="input-xlarge" id="email_contact" name="email_contact" value="" placeholder="">

                    <label for="telephone">CONTACT NUMBER</label>
                    <input type="tel" class="input-xlarge" id="telephone" name="telephone" placeholder="" value="" >

                    <label for="message">MESSAGE</label>
                    <textarea id="message" class="input-xlarge" name="message" placeholder="" rows="5"></textarea>                  

                    <div id="recaptcha_widget" style="display:none">

                        <div id="recaptcha_image"></div>
                        <div class="recaptcha_only_if_incorrect_sol" style="color:red">Incorrect please try again</div>

                        <span class="recaptcha_only_if_image">Enter the words above:</span>
                        <span class="recaptcha_only_if_audio">Enter the numbers you hear:</span>

                        <input type="text" id="recaptcha_response_field" name="recaptcha_response_field" />

                        <div><a href="javascript:Recaptcha.reload()">Get another CAPTCHA</a></div>
                        <div class="recaptcha_only_if_image"><a href="javascript:Recaptcha.switch_type('audio')">Get an audio CAPTCHA</a></div>
                        <div class="recaptcha_only_if_audio"><a href="javascript:Recaptcha.switch_type('image')">Get an image CAPTCHA</a></div>

                        <div><a href="javascript:Recaptcha.showhelp()">Help</a></div>

                    </div>

                    <script type="text/javascript"
                        src="http://www.google.com/recaptcha/api/challenge?k=6Lf8RN4SAAAAAKnllVnDw23UpBIuAIdTRFgN1kmX">
                    </script>

                    <noscript>
                        <iframe src="http://www.google.com/recaptcha/api/noscript?k=6Lf8RN4SAAAAAKnllVnDw23UpBIuAIdTRFgN1kmX" height="300" width="500" frameborder="0"></iframe><br>
                        <textarea name="recaptcha_challenge_field" rows="3" cols="40"></textarea>
                        <input type="hidden" name="recaptcha_response_field" value="manual_challenge">
                    </noscript>             

                    <button type="submit" value="" id="" name="send" class="pull-right lightblue btn-primary">SUBMIT</button>
                    </fieldset>
</form>

<script type="text/javascript">
    $(document).ready(function () {

        $("#contact").validate({
            rules: {
                "name_contact": {
                    required: true,
                    minlength: 3
                },
                "email_contact":{
                    required: true
                },
                "message":{
                    required:true
                },
                "recaptcha_response_field":{
                    required:true
                }

            },
            messages: {
                "name_contact": {
                    required: "Please, enter a name"
                },
                "email_contact":{
                    required: "Enter a valid email"
                },
                "message":{
                    required: "Please provide a comment"
                },
                "recaptcha_response_field":{
                    required: "Captcha is required"
                }
            },
            errorPlacement: function(error, element) {
                error.insertBefore(element);
            }
        });

    });
</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-14T16:03:55.827

仅使用 JavaScript 或 jQuery 没有简单的解决方案。由于您必须使用 API 将 Re-Captcha 代码与您的*私钥*进行比较，为了获得适当的安全性，您**必须**使用一些**服务器**端代码来执行此过程。

1.  用户正确填写表格，但重新验证码除外。

2.  如果 Re-Captcha 代码为空，则`required`jQuery Validate 中的正常规则会触发“缺少 Captcha”消息。用户可以再试一次。

3.  输入的 Re-Captcha 代码（正确或错误），表单通过回调函数中的jQuery 提交到您的服务器端代码**。**`ajax``submitHandler`

4.  您的**服务器**端代码、PHP、Perl 等等，然后使用您的私有 API 密钥来验证输入的 Re-Captcha 代码与 API 预期的 Re-Captcha 代码。

5.  如果 Re-Captcha 代码正确，您的**服务器**端代码将照常继续，并向您的 jQuery`ajax` `success`回调函数返回“成功”文本响应。

6.  如果 Re-Captcha 代码*不正确*，您的**服务器**端代码*只会*向您的 jQuery 回调函数返回一个“错误”文本响应`ajax` `success`，而服务器端代码将不执行任何其他操作。

7.  在您的 jQuery`ajax` `success`回调函数中，读取从服务器端代码返回的消息文本。

8.  如果返回的消息表明成功，那么您的表单已经成功提交，您可以重定向、清除表单、做动画、打印消息、什么也不做，等等。

9.  如果返回信息失败，则通过 JavaScript 生成新的 Re-Captcha 码，显示错误信息*“输入的验证码不正确”*，用户只需重试即可。

* * *

这就是我做我的方式......你需要做一些非常类似于以下的事情。

`submitHandler`在您的`.validate()`选项中添加一个并用于`ajax`控制表单提交。这是您可以与验证码交互并控制表单提交的唯一方式。

您还需要修改服务器端函数以测试验证码是通过还是失败，执行适当的函数并返回正确的`ajax`消息，`msg`. 在不了解您的服务器端代码的情况下，不可能说出更具体的内容。

（**注意：** 任何纯 JavaScript/jQuery 的解决方案，不编辑您的服务器端代码，都是**不安全**的。验证码可以很容易地被绕过，并且您的私有 API 密钥会向公众公开。）

```
$(document).ready(function() {

    $("#contact").validate({
        // your other options and rules,
        submitHandler: function (form) {
            $.ajax({
                type: 'POST',
                data: $('form').serialize(),
                url: 'formMail.pl', // <-- whatever your server-side script, mine is a perl form mailer
                success: function (msg) {
                    if (msg.indexOf('captcha') != -1) {
                        Recaptcha.reload(); // reloads a new code
                        $('#recaptcha_response_field').before(msg); // error message
                    } else {
                        // anything else to do upon success, animations, etc.
                        // form was already submitted as per ajax
                    }
                }
            });
            return false; // blocks normal form submit
        }
    });

}); 
```

以下只是一个 PERL 示例，说明了我如何修改作为 Form Mailer 脚本的服务器端代码。您必须以类似的方式调整您的服务器端代码。

`check_captcha`脚本首次运行时调用子例程。

```
sub check_captcha {     
       my $ua = LWP::UserAgent->new();
       my $result=$ua->post(
           'http://www.google.com/recaptcha/api/verify',
           {
               privatekey => 'xxxxxxxxxxxxx',  # insert your private key here
               remoteip   => $ENV{'REMOTE_ADDR'},
               challenge  => $Form{'recaptcha_challenge_field'},
               response   => $Form{'recaptcha_response_field'}
           }
       );

       if ( $result->is_success && $result->content =~ /^true/) {
               return;  # OK - continue as normal with Form Mailer
       } else {
               # error, Form Mailer will not continue
               &error('captcha_failed'); # failed Captcha code, call error subroutine to print an error message (msg) containing the word "captcha"
       }
} 
```

请记住，此服务器端代码**必须**`ajax` `success`返回您的 jQuery 在您的 jQuery回调中拾取的消息，`msg`如上所述。在我的示例中，如果消息包含单词“captcha”，则表示代码输入错误，用户必须重新输入新的 Captcha 代码。

# meteor - 使用自动运行订阅响应式数据源

> ID：15396879
> 
> 赞同：4
> 
> 时间：2013-03-13T21:31:28.143
> 
> 标签：meteor

我正在尝试使用 Meteor 编写一个 web 应用程序，但我肯定无法理解有关订阅已发布数据集的一些事情。整个应用程序都在[github 上](https://github.com/chooban/derbyradar/tree/2309b28d91c75bd7753b60637a7df8406448c8b6)（链接到后代的最新提交），但我将尝试在下面进行总结。

我有一个名为 teams 的集合，可供客户端和服务器使用：

```
Teams = new Meteor.Collection( "teams" ); 
```

在服务器上，我想发布所有团队的列表：

```
Meteor.publish( "allteams", function() { ... 
```

有一个非常简单的光标构成了这个发布的列表：

```
var handle = Teams.find( {} ).observeChanges({
    added: function( id ) {
        console.log( "New team added" );
        if ( !initializing ) {
            console.log( "Telling subscribers it's all change" );
            self.added( "teams", id, {} );
            self.ready();
        }
    }
}); 
```

客户端订阅该源，当添加元素时，客户端会将引脚添加到地图：

```
Meteor.autorun( function() {
    Meteor.subscribe( "allteams", function() {
        console.log( "All teams has been updated" );
        // Do more stuff
    }
}; 
```

最初填充列表时，自动运行运行良好，但如果我向集合中添加另一个元素，则发布者方法会记录说“我注意到这一点”，但订阅者没有任何反应。

上述目的如下：

*   服务器上有一个团队列表，其中包含名称和长/纬度详细信息
*   当客户连接时，他们会收到该团队列表并绘制在地图上
*   如果一个团队被添加到服务器端的列表中，每个客户端都会收到通知，并且地图上会出现一个新的图钉。

就应用程序而言，我可能不需要 pin 来神奇地出现，但这是学习发布和订阅的有用方法，尤其是当我没有正确使用时！最终，“allteams”可能会比整个团队列表更细粒度，所以我想这类似于查看数据。

我错过了一些完全明显的东西吗？

*编辑*：我解决了并将答案放在下面。tl;博士我根本没有订阅反应式数据源。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-16T09:42:11.140

回答我自己的问题可能不礼貌，但我弄清楚我做错了什么，我认为其他人可能会遇到同样的事情。

简单的答案是我没有做我在问题标题中声称要做的事情，特别是没有订阅反应数据源。

```
Meteor.autorun( function() {
    Meteor.subscribe( "allteams", function() {
        console.log( "All teams has been updated" );
        // Do more stuff
    }
}; 
```

在这里，我将`subscribe`方法传递给`autorun`，但该方法本身不是反应式数据源。但是，它返回的东西是！

```
// Define a subscription
var handle = Meteor.subscribe( "foo", { onReady: function() { ... } } );

Meteor.autorun( function() {
    if ( handle.ready() ) {
        // Now do something every time the subscription is marked as ready
    }
}; 
```

订阅句柄的`ready`方法是响应式的，因此现在每次更新发布的文档集时都会执行自动运行。这让我对多个客户端订阅数据库游标并监视更改的效率提出了进一步的问题，但我将在另一个问题中讨论这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T06:51:12.920

如果自动发布仍然打开，这可能是您的问题的原因。尝试禁用自动发布并查看发布语句现在是否正常工作。

# c# - 网络参考有效，但服务参考抱怨肥皂版本

> ID：15396885
> 
> 赞同：0
> 
> 时间：2013-03-13T21:31:44.837
> 
> 标签：c#, visual-studio-2012, asmx, service-reference, web-reference

我必须连接到旧版 Web 服务。

在 Visual Studio 中，如果我执行添加服务引用，则在服务器上输入 WSDL 文件的 url。我的服务出现了，我针对它编写了代码。但是当我运行代码时，我得到了这个错误：

> System.ServiceModel.CommunicationException：传入消息的信封版本 (Soap12 ( [http://www.w3.org/2003/05/soap-envelope )) 与编码器 (Soap11 (](http://www.w3.org/2003/05/soap-envelope) [http://schemas](http://schemas.xmlsoap.org/soap/envelope/) ) 的信封版本不匹配[.xmlsoap.org/soap/envelope/](http://schemas.xmlsoap.org/soap/envelope/) ))。确保使用与预期消息相同的版本配置绑定。

我的 app.config 看起来像这样：

```
 <system.serviceModel>
        <bindings>
            <basicHttpBinding>
                <binding name="LoginServiceSoap" />
            </basicHttpBinding>
        </bindings>
        <client>
            <endpoint address="http://server/Service.asmx" binding="basicHttpBinding"
                bindingConfiguration="LoginServiceSoap" contract="Stuff.Login.LoginServiceSoap"
                name="LoginServiceSoap" />
        </client>
    </system.serviceModel> 
```

但是，如果我添加“Web 参考”，我可以与服务正常通信。但我的理解是我现在应该使用服务引用，而不是 WebReferences。我假设我的上述配置有问题。

还是因为我要连接的服务类型，我是否被迫使用 Web 参考？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-29T18:31:39.763

希莫斯，

您可以（理论上）将版本号添加到绑定定义中。

```
envelopeVersion="None/Soap11/Soap12" 
```

当然，为您的服务提供正确的价值。

所以它看起来更像：

```
<basicHttpBinding>
    <binding name="LoginServiceSoap"
             envelopeVersion="Soap12" />
</basicHttpBinding> 
```

希望这可以帮助您按照自己的方式做事。

# android - Android 通知处理建议

> ID：15396889
> 
> 赞同：0
> 
> 时间：2013-03-13T21:32:12.107
> 
> 标签：android, android-intent, notifications, push-notification, android-pendingintent

所以我有一个基本的通知应用程序。这是当前的配置详细信息：

```
GCMIntentService

NotificationActivity
:
---->ViewMessageActivity
     :
     ---->ViewUserDetailsActivity 
```

`GCMIntentService`被配置为执行以下操作：收到通知后，`PendingIntent.FLAG_ONE_SHOT`会创建一个挂起的意图，并且该意图会添加`Intent.FLAG_ACTIVITY_NEW_TASK`标志。

目前，我`NotificationActivity`在我的清单中定义为`android:launchMode="singleInstance"`. 如果我将它设置为`android:launchMode="singleTop"`，当用户单击通知时，可能会发生一些事情，具体取决于 Android 版本（或者我的两台设备显示）

1.  在 Android < 2.3 中，如果我在另一个活动中（比如说`ViewMessageActivity`）并且我从阴影中按下通知，则什么也不会发生（我没有收到任何来自`onNewIntent`）
2.  在 Android 4.2（不确定其他版本）中，如果我在另一个活动中（比如`ViewMessageActivity`）并且我从阴影中按下通知，则什么也没有发生（我没有收到来自 的任何东西`onNewIntent`）*并且*通知从阴影中消失
3.  如果我在`NotificationActivity`所有版本中都很好用

所以这导致我将其设置为`singleInstance`而不是`singleTop`. 现在，当用户按下通知并且用户处于不同的活动中（例如`ViewMessageActivity`）时，通知意图会得到适当处理但是，我`NotificationActivity`尝试为`ViewMessageActivity`在通知阴影中单击的消息创建一个新实例，但它不会创建一个新的活动。相反，显示我已经打开的实例。我尝试添加诸如`Intent.FLAG_ACTIVITY_NEW_TASK`但 my`onCreate`或`onNewIntent`方法都没有在 my 中调用的标志`ViewMessageActivity`。

理想情况下，这就是我希望发生的事情：当用户从`ViewMessageActivity`主要活动 ( `NotificationActivity`ListView 视图`onNewIntent`将创建另一个 ViewMessageActivity 实例。注意：我没有为任何其他活动设置启动模式选项。

有什么建议么？

文斯

# python - 难以理解排序中的 lambda 函数

> ID：15396893
> 
> 赞同：4
> 
> 时间：2013-03-13T21:32:23.167
> 
> 标签：python, list, lambda

假设我定义了一个列表列表`lol`：

```
lol = [['malasia', 0.02, 56.3], ['chile', 0.03, 34.9],
       ['hungria', 0.01, 45.9], ['ahumada', 0.001, 1]] 
```

然后，

```
lol.sort(lambda x, y: cmp(y[2], x[2])) 
```

`lol`按每个子列表的最后一个元素排序...

* * *

我只是想了解以下组件的组成部分`sort`：

*   `cmp(y,x)`与数字比较并返回`-1`(y 小于 x)、`0`(x 等于 y) 或`1`(y 大于 x)。

*   `lambda`是在每个列表的最后一个元素上定义一个函数吗？那么 lambda 里面的排序呢？我很困惑——有人能解释一下 lambda 函数的作用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T21:34:48.973

> 那么 lambda 里面的排序呢？我搞不清楚了！

基本上，当`sort()`需要比较两个元素时，它会调用 lambda 函数并使用其结果来确定两个元素中的哪一个应该先出现。这就是它的全部。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-13T21:38:05.893

这实际上最好使用 to 的`key`参数来完成`sort`，`cmp`有点过时了。

例如：

```
lol.sort(key=lambda x: x[2]) 
```

（您也可以使用 x[-1] 来表示列表的最后一个元素）

您正在创建 lambda 并将其传递给`sort`函数。你也可以这样写：

```
get_third_element = lambda x: x[2]
lol.sort(key=get_third_element) 
```

或者让它更容易理解：

```
def get_third_element(x):
    return x[2]

lol.sort(key=get_third_element) 
```

没有理由不能将一个函数作为参数传递给另一个函数！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-13T21:52:08.250

您示例中的 lambda 函数确定哪个项目首先出现。

在“经典”情况下，它会简单地计算`x-y`：如果结果是`negative`，则意味着`x is smaller`y 和因此来`before y`。

此外，您可以将反向参数传递给排序方法，这将`reverse=True`是顺序。

在这种情况下，您的“排序”功能是“lambda-wrapper”中的 cmp 功能。其中，您将 x 的顺序与 y 交换并使用第三个参数，这意味着它以相反的顺序排序（x/y-swap）并通过比较所有第三个参数（`x[2]`）来实现。

关于你的第二个子弹：

> ...谁能解释 lambda 函数的作用”

如果您问什么是 lambda 函数：它是一个匿名的轻量级内联函数。匿名意味着它没有标识符。（但您可以指定一个。例如：`sqr = lambda x : x**2`您现在可以像使用任何其他功能一样使用它`y = sqr(2)`：）

```
Normal function: def name(arg): vs lambda-function: lambda   arg: ret_value
                  ^    ^    ^                          ^   ^  ^       ^
                  a)   b)   c)                         a)  b) c)      d) 
```

*   a) 将以下内容标记为普通/lambda 函数的关键字
*   b) 函数名称在 lambda 函数“丢失”的情况下因此是匿名的
*   c) 函数参数：普通函数 -> 括号，lambda 函数 -> 没有
*   d) 返回值——在普通函数被省略的情况下，因为必须显式地用 return 返回。（没有显式返回它提供无） lambda 隐式返回冒号右侧的评估结果。

您使用排序函数的示例是 lambda 函数的典型用例。它们被用作“丢弃”函数，您可以内联而不创建自己的正常函数。

一个更“pythonic”的变体是这样的：

```
from operator import itemgetter

keyfunc = itemgetter(2) # takes the 3rd argument from an itterable
sorted_list = sorted(lol, key=keyfunc, reverse=True) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-13T21:40:13.980

lambda 是“函数”类型
所以你的

```
lambda x, y : cmp(y[2], x[2]) 
```

等于

```
def f(x, y):
    return cmp(y[2], x[2]) 
```

接受一个函数，当`sort`它需要比较两个元素时，它会调用那个 lambda 函数，它会返回`cmp(y[2], x[2])`

所以这种排序会以这种方式对你的列表进行排序：每当它遇到两个元素时，它会获取“三元组”中的最后一个值并比较它们以确定优先级。

# directx - 使用 DXUT 的 DirectX 示例无法创建 Direct3D 设备（仅限调试）

> ID：15396895
> 
> 赞同：3
> 
> 时间：2013-03-13T21:32:31.170
> 
> 标签：directx, directx-10

我在这里遇到了一个很奇怪的问题，我正在尝试从 DirectX 示例浏览器运行 DXUT DirectX 10/11 教程。它们构建良好，但不能在调试模式下运行，因为这会触发错误警告“无法创建 Direct3D 设备”。这很奇怪，因为我可以在发布模式下运行它们。然而，最奇怪的是它们过去常常在调试模式下运行，我发誓我在它运行的那天我什么也没做，而第二天它没有。一位朋友也有同样的问题，大约在同一时间发生。

有没有人遇到过这个问题并知道解决方案，或者可能知道为什么它会发生超出显而易见的事情，如果你没有选择的话，我有一个支持 DirectX 11 的卡。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T01:50:24.987

我实际上只是花了一整天的时间来解决这个完全相同的问题。这是解决方案，希望也能解决您的问题...

我设法找到这篇文章，解释最近的更新*（确切地说是 2013 年 2 月 26 日）*导致旧版本搞砸了：

[http://blogs.msdn.com/b/chuckw/archive/2013/02/26/directx-11-1-and-windows-7-update.aspx](http://blogs.msdn.com/b/chuckw/archive/2013/02/26/directx-11-1-and-windows-7-update.aspx)

这就解释了为什么它在几周前运行良好，现在我猜它突然停止工作了！

按照他们的建议，**我下载了 Visual Studio 2012 的试用版**，经过一个半小时的安装时间和系统重新启动，您应该拥有所需的所有新 DirectX SDK 文件。

注意：您甚至不必使用 Visual Studio 2012。新文件应该可以解决您对 Visual Studio 2010 和旧版本的问题，我认为！

（在此之前，**我还安装了所有最新的驱动程序**，但我认为这没有任何帮助，但只要有可能，就值得升级驱动程序，因为这解决了我之前遇到的类似问题）。

希望这可以帮助！！！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T01:33:18.580

在您的代码中的某个地方，您可能有类似的东西

```
#if defined(DEBUG) || defined(_DEBUG)  
    createDeviceFlags |= D3D10_CREATE_DEVICE_DEBUG;
#endif 
```

如果你看一下[msdn](http://msdn.microsoft.com/en-us/library/windows/desktop/bb204909%28v=vs.85%29.aspx)`D3D10_CREATE_DEVICE_DEBUG;`上的， 你会看到这个

> 要使用此标志，您必须安装 D3D11_1SDKLayers.dll；否则，设备创建失败。

你应该检查你`dll`的系统中是否有这个，或者你应该重新安装 DirectX SDK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T00:47:06.280

The automatic IE10 update is what caused my issue of automatic non support of directx development. Simplest solution is downloading standalone win8 sdk at...

[http://msdn.microsoft.com/en-us/windows/desktop/hh852363](http://msdn.microsoft.com/en-us/windows/desktop/hh852363)

The directx debug layer dll has to be updated.

# c# - 在 32 位应用程序中使用 64 位 DLL

> ID：15396897
> 
> 赞同：5
> 
> 时间：2013-03-13T21:32:35.433
> 
> 标签：c#, interop, 32bit-64bit

XCode 的 ARC 重构迫使我的 Cocoa 库 DLL 为 64 位，我不知道我是否仍然`DllImport`可以从 x86 C# 应用程序中获取该 DLL。这可能吗，这样做有什么后果吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-13T21:39:02.233

您不能在单个进程中混合 32 位和 64 位代码。因此，使用混合位数代码的唯一方法是拥有多个进程。您需要某种形式的 IPC 才能使其工作。你不能这样做，`DllImport`因为那是在进行中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:40:15.613

问题不是真正的 C# - 它是操作系统中的托管进程。由于一个进程只能加载具有相同“位数”的 DLL，因此该进程是 64 位的，或者您不能直接加载 DLL。无论您使用什么语言或框架。

一种解决方案是将 C# 项目定位为使用“任何”cpu 或专门将其指向 X64。

另一种解决方案是创建一个托管进程，您可以使用 IPC 或类似模型与之通信。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T21:40:28.523

必要时的解决方案是调用管道中的 EXE 或类似的。这当然假设一个 64 位窗口。如果没有，就踢吧。

# android - 让图像在屏幕上自由移动

> ID：15396900
> 
> 赞同：0
> 
> 时间：2013-03-13T21:32:42.613
> 
> 标签：android, android-canvas

我有一个关于 Android 编程的问题。我创建了一个应用程序来通过蓝牙接收数据，我想使用该输入作为一种“游戏控制器”来在屏幕上移动图像。例如，如果给出“向上”命令，图像（甚至是彩色圆圈）会向上移动几个像素。

有人可以指出我正确的方向吗？我想过使用画布并经常重绘图像，但我不知道该怎么做，我认为可能有更好/更简单的方法。我不需要任何花哨的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:52:33.147

我会做什么。捕捉 up 命令，然后有一个类，我们称之为 Circle，它将保存当前圆的位置、大小等。每当你捕捉到 up 命令或左或右或任何类型的命令时，你都会在该位置重绘图像。我还将使用自定义表面视图进行绘图，并使用 Activity 捕获所有输入并将它们传递给对象。我会查看 [http://www.javacodegeeks.com/2011/07/android-game-development-moving-images.html](http://www.javacodegeeks.com/2011/07/android-game-development-moving-images.html)

如果有时间，请通读整个系列。这是一本很好的读物。

# c# - 具有多个方法调用 Console.Write 问题的 TPL

> ID：15396904
> 
> 赞同：0
> 
> 时间：2013-03-13T21:32:48.970
> 
> 标签：c#, .net, task-parallel-library, console-application

如果我使用 TPL，我会在 Parse 中遇到问题。我确实使用 Console.Write 来构建一些 Line 但有时一种方法是快速并在其他方法行中写入。我如何锁定或有更好的方法？

```
Parallel.Invoke(
  () => insertedOne = Lib.ParseOne(list),
  () => insertedTwo = Lib.ParseTwo(list),
  () => insertedThree = Lib.ParseThree(list)); 
```

Parse 的示例.. 方法。

```
public static int ParseOne(string[] _list) {
    Console.Write("blabla");
    Console.Write("blabla");
    return 0;
}
public static int ParseTwo(string[] _list) {
    Console.Write("hahahah");
    Console.Write("hahahah");
    return 0;
}
public static int ParseThree(string[] _list) {
    Console.Write("egegege");
    Console.Write("egegege");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T22:12:32.520

为了能够将您`blabla`的 s、`hahahah`s 和`egegege`s 打印为单个实体（不可分割），您可以将方法编写为：

```
public static int ParseThree(string[] _list)
{
    lock (Console.Out)
    {
        Console.Write("egegege");
        Console.Write("egegege");
    }
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:48:14.060

为什么不在一个线程中运行所有任务，一个接一个？

```
 System.Threading.Tasks.Task.Factory.StartNew(()=>
 {
    insertedOne = Lib.ParseOne(list);
    insertedTwo = Lib.ParseTwo(list);
    insertedThree = Lib.ParseThree(list);
 }); 
```

这样你就不会有那么多的竞争条件。

# ios - UIPageViewController 上未选择 UITableView didSelectRowAtIndexPath

> ID：15396906
> 
> 赞同：2
> 
> 时间：2013-03-13T21:32:58.413
> 
> 标签：ios, objective-c, ios6

我有一个 UIViewController，其中添加了 UIPageViewController 的视图。该 UIPageViewController 有一个带有子视图的页面，该子视图将 UITableView 添加为子视图。我正在使用 iOS 6，单击单元格时没有调用方法 didSelectRowAtIndexPath。但是有一个奇怪的“错误”......如果我将页面翻到一半然后回到我所在的页面（没有完成翻页），那么我就可以选择单元格。我认为这与手势识别器有关，但我无法弄清楚。我尝试从 UIPageViewController 的实例化中删除手势识别器，但无法使其正常工作。

我像这样从 UIPageViewController 中删除了点击手势识别器，但仍然存在错误行为......

```
for (UIGestureRecognizer *recognizer in pageViewController.gestureRecognizers) {
    if ([recognizer isKindOfClass:[UITapGestureRecognizer class]]) {
        recognizer.enabled = NO;
    }
} 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T19:36:08.030

原来是一件非常简单的事情。在我的 UIViewController 上，我将 autoresizingMask 设置为 FlexibleHeight。出于某种原因将其更改为无解决了我的问题。

```
// self.contentView.autoresizingMask = UIViewAutoresizingFlexibleHeight;

// Changed to :

 self.contentView.autoresizingMask = UIViewAutoresizingNone; 
```

如果有人能阐明为什么会出现这种情况的原因，我将不胜感激。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:36:55.303

子类 `UIView`与 `UITableView`. 让我们说`myUIView`。

在`myUIView`.

添加`myUIView`为 的子视图`UIPageControl`。

UITableView 中的委托`myUIView`将触发。

# c# - 避免多余的异步计算

> ID：15396911
> 
> 赞同：3
> 
> 时间：2013-03-13T21:33:33.023
> 
> 标签：c#, .net, task, async-await

我有一些 UI 代码，其中有一个如下所示的方法：

```
 private async Task UpdateStatusAsync()
    {
        //Do stuff on UI thread...

        var result = await Task.Run(DoBunchOfStuffInBackground);

        //Update UI based on result of background processing...
    } 
```

目标是让 UI 在任何影响其状态的属性更改时更新相对复杂的计算状态。这里有几个问题：

1.  如果我只是从每个更新状态的地方直接调用此方法，最终更新的状态可能不正确。假设属性 A 发生变化，然后属性 B 发生变化。尽管 B 在 A 之后调用 UpdateStatusAsync，但有时回调代码（最终的 UI 更新）会以相反的顺序发生。所以：（A->更新）->（B->更新）->（B更新）->（A更新）。这意味着最终的 UI 显示的是陈旧状态（反映 A，但不反映 B）。
2.  如果我总是等待先前的 UpdateStatusAsync 首先完成（我目前正在做的事情），我可能会多次执行昂贵的状态计算。理想情况下，我应该只需要为一系列更新进行“最后一次”计算。

我正在寻找的是一个干净的模式，它可以完成以下任务：

1.  最终状态永远不会“陈旧”超过一小段时间（即我不希望 UI 与底层状态不同步）
2.  如果在短时间内发生多个更新调用（常见用例），我宁愿避免重复工作，而是始终计算“最新”更新。
3.  由于在某些情况下，多个更新可能非常接近（即在几毫秒内）发生，因此如果有其他更新请求进来，有一种方法可以避免在短时间内开始处理会很方便。

看起来这应该是一个相当普遍的问题，所以我想我会在这里问是否有人知道一种特别干净的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T22:38:24.817

好吧，最直接的方法是`CancellationToken`用于取消旧状态更新和`Task.Delay`延迟状态更新：

```
private CancellationTokenSource cancelCurrentUpdate;
private Task currentUpdate;
private async Task UpdateStatusAsync()
{
  //Do stuff on UI thread...

  // Cancel any running update
  if (cancelCurrentUpdate != null)
  {
    cancelCurrentUpdate.Cancel();
    try { await currentUpdate; } catch (OperationCanceledException) { }
    // or "await Task.WhenAny(currentUpdate);" to avoid the try/catch but have less clear code
  }

  try
  {
    cancelCurrentUpdate = new CancellationTokenSource();
    var token = cancelCurrentUpdate.Token;
    currentUpdate = Task.Run(async () =>
    {
      await Task.Delay(TimeSpan.FromMilliseconds(100), token);
      DoBunchOfStuffInBackground(token);
    }, token);

    var result = await currentUpdate;

    //Update UI based on result of background processing...
  }
  catch (OperationCanceledException) { }
} 
```

但是，如果您的更新速度*非常*快，这种方法会为 GC 创建（甚至）更多垃圾，*并且*这种简单的方法将始终取消较旧的状态更新，因此如果事件中没有“中断”，则 UI 可能最终落后。

这种复杂程度是`async`开始达到极限的地方。如果您需要更复杂的东西（例如处理“中断”，以便您至少每隔一段时间获得一次 UI 更新），[反应式扩展将是一个更好的选择。](http://msdn.microsoft.com/en-us/data/gg577609.aspx)Rx 特别擅长处理时序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T22:38:47.210

您应该能够在不使用计时器的情况下执行此操作。一般来说：

```
private async Task UpdateStatusAsync()
{
    //Do stuff on UI thread...

    set update pending flag

    if currently doing background processing
    {
        return
    }

    while update pending
    {
        clear update pending flag
        set background processing flag
        result = await Task.Run(DoBunchOfStuffInBackground);
        //Update UI based on result of background processing...
    }
    clear background processing flag
} 
```

我不得不考虑如何在 async/await 的上下文中准确地完成所有这些工作。`BackgroundWorker`我过去做过类似的事情，所以我知道这是可能的。

防止它丢失更新应该很容易，但它可能会不时进行不必要的后台处理。但是，当在短时间内发布 10 次更新时，它肯定会消除进行 9 次不必要的更新（可能只会进行第一次和最后一次）。

如果需要，您可以将 UI 更新移出循环。取决于您是否介意看到中间更新。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T22:22:38.930

由于看来我在正确的轨道上，我将提交我的建议。在非常基本的伪代码中，看起来这样可以解决问题：

```
int counter = 0;

if (update received && counter < MAX_ITERATIONS)
{
     store info;
     reset N_MILLISECOND timer;
}
if (timer expires)
{
    counter = 0;
    do calculation;
} 
```

这将使您可以根据需要跳过尽可能多的彼此太近的呼叫，而计数器将确保您仍然使 UI 保持最新。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-04T23:21:23.953

我最终使用了 Jim Mischel 推荐的方法，并添加了一个计时器来聚合快速传入的触发器：

```
public sealed class ThrottledTask
    {
        private readonly object _runLock = new object();
        private readonly Func<Task> _runTask;
        private Task _loopTask;
        private int _updatePending;

        public ThrottledTask(Func<Task> runTask)
        {
            _runTask = runTask;
            AggregationPeriod = TimeSpan.FromMilliseconds(10);
        }

        public TimeSpan AggregationPeriod { get; private set; }

        public Task Run()
        {
            _updatePending = 1;

            lock (_runLock)
            {
                if (_loopTask == null)
                    _loopTask = RunLoop();

                return _loopTask;
            }
        }

        private async Task RunLoop()
        {
            //Allow some time before we start processing, in case many requests pile up
            await Task.Delay(AggregationPeriod);

            //Continue to process as long as update is still pending
            //This clears flag on each cycle in a thread-safe way
            while (Interlocked.CompareExchange(ref _updatePending, 0, 1) == 1)
            {
                await _runTask();
            }

            lock (_runLock)
            {
                _loopTask = null;
            }
        }
    } 
```

一旦聚合期过去，只要仍有传入的触发器，它就会尽可能快地运行更新。关键是，如果触发器发生的速度比计算快，这不会叠加冗余更新，并且它始终确保“最后一个”触发器得到更新。

# c# - 有没有关于在 C# 中通过 Jabber.net 库使用 OpenFire 插件的示例？

> ID：15396912
> 
> 赞同：0
> 
> 时间：2013-03-13T21:33:38.033
> 
> 标签：c#, wpf, xmpp, openfire, instant-messaging

我正在研究关于 IM 的 C#-WPF 项目。经过一番谷歌搜索后，我发现执行此操作的最佳选择之一是 Jabber/XMPP 协议，因此我将 OpenFire 安装为 Jabber 服务器，并通过 Jabber.net 库在 C# 中编写了一个简单的客户端应用程序。现在我想在我的客户端应用程序中使用 Kraken IM 网关（OpenFire 的插件之一），但是如何？

# javascript - div中单选按钮效果的jQuery

> ID：15396914
> 
> 赞同：2
> 
> 时间：2013-03-13T21:33:49.707
> 
> 标签：javascript, jquery, html, css

我对 css 和 jquery 很陌生，我的项目需要帮助。

我有 3 个按钮：劣势 - 平均 - 优势，我需要让这个按钮像单选按钮一样工作，所以如果我点击劣势，这个按钮会改变背景颜色，如果点击他，其他按钮会失去颜色。和缺点按钮获得红色背景颜色。

*   如果我点击平均按钮，如果之前点击过他，这个按钮必须变成黄色和其他失去颜色

- 如果我单击平均按钮，此按钮必须获得绿色背景色，其他按钮会失去颜色。就像单选按钮

但是我尝试根据#ID 来做到这一点

```
$('#price_quality_adv').css('background-color','#C90');
            $('#reliability_adv').css('background-color','#C90'); 
```

[http://jsfiddle.net/EC44Z/5/](http://jsfiddle.net/EC44Z/5/)

请帮忙。对不起我的英语谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:44:22.520

似乎是某种范围问题，不确定它是否是 jsFiddle 环境独有的。当我进行此更改时，它是固定的（至少对于优势按钮）

```
setQuality = function(qulaity, type_rating, name) 
```

## 小提琴：http: [//jsfiddle.net/EC44Z/8/](http://jsfiddle.net/EC44Z/8/)

但是还有一些其他问题，代码有点复杂。最好做类似...

## HTML

```
<a href="#" id="button_advantage" class="button">advantage</a> 
```

## CSS

```
.button{ /* styles for all buttons */ }
.selected{ /* styles for selected button */ } 
```

## JS (jQuery)

```
$("#button_advantage").on('click',function(){
    $(this).addClass('selected')
    $(this).siblings().removeClass('selected')
}) 
```

## 概括

代码应该是分开的，所以更容易维护，在各种环境下都能很好地工作，并获得良好的搜索排名等......

HTML 用于内容，应该这样标记，使用适当的类来分组相似的项目，并为相关元素提供唯一的 id。

CSS 用于样式，所有样式都应尽可能放在一起。

JS是为了动态功能，所以在这种情况下，添加一个类，让样式发生变化。

# azure - Azure 存储中的 VHD 如何收费？

> ID：15396917
> 
> 赞同：2
> 
> 时间：2013-03-13T21:33:58.443
> 
> 标签：azure, azure-storage, azure-blob-storage, azure-virtual-machine

如果我创建了一个 200GB VHD 并将其附加到我的 Azure 虚拟机，并且只使用了 15GB 的这个驱动器，我是按全部 200GB 还是 15GB 收费的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T22:01:19.833

VHD 以页 blob 的形式保留，因此您需要为 blob 中消耗的空间付费。

由此：

[https://www.windowsazure.com/en-us/pricing/details/#storage](https://www.windowsazure.com/en-us/pricing/details/#storage)

> 对于 Windows Azure Drive 存储，您只需为页 blob 使用的存储空间和页 blob 的读/写事务付费。您无需为使用本地驱动器缓存的读取事务付费。Windows Azure 驱动器的使用费率与标准 Windows Azure 存储相同，并且包含在您的账单中的 Windows Azure 存储使用中。您的账单上没有单独的 Windows Azure Drive 项目。

# ruby-on-rails - 从 RSpec 访问控制器的父类函数

> ID：15396918
> 
> 赞同：0
> 
> 时间：2013-03-13T21:33:58.647
> 
> 标签：ruby-on-rails, rspec

我正在尝试为 API 编写 RSpec 测试。

**设置：** 为了保持一致，我们有一个格式化函数，它接受响应并生成一个漂亮的 JSON 对象，所以一切都是一致的。例如-为本示例简化：

```
def format (status, message)
  {status: status,
   message: message}
end 
```

此函数在所有 API 控制器继承的基本控制器中声明。

**我想要什么：** 当我测试 API 控制器时，我想测试控制器是否给了我预期的结果，但我不想测试 JSON 响应的实际格式。如中，我想检查传递给格式函数的参数是否符合我的预期，但我不想检查该函数实际返回的内容。（我计划在另一个测试中测试该功能。如果对 JSON 格式的更改不会影响 API 的每个测试，我会非常喜欢它。如果这不是好的做法，请随时告诉我。 )

**我的问题：** 有什么方法可以让我从当前 API 规范文件中的基本控制器访问该格式函数？或者有什么好方法让我把它存根并访问传递给它的参数，这样我就可以检查它们是否正确？

相关：[如何使用 RSpec 检查 JSON 响应？](https://stackoverflow.com/questions/5159882/how-to-check-for-a-json-response-using-rspec)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:54:17.650

听起来你正试图在你的控制器规范中做这样的事情：

```
let(:status) { function1(params_hash) }
let(:message { function2(params_hash) }
it "does something something" do
  model.should_receive(:format).with(status, message)
  get :action, params_hash
 end 
```

定义如何从 params_hash 计算状态和消息由您决定。我所做的是思考各种路径是什么，并为每个路径编写一个测试。如：

```
context "when id is missing in the params" do
 let(:status) { 404 }
 let(:message) { "Not found" }
 let(:params_hash) { {:id => nil} }

context "when id is correct" do
  let(:status) { 200 }
  let(:message) { "OK" }
  let(:params{hash) { {:id => 1 } } 
```

# jquery - 为什么这个 jQuery 悬停状态在 Safari 中是未对齐的？

> ID：15396919
> 
> 赞同：0
> 
> 时间：2013-03-13T21:34:07.437
> 
> 标签：jquery, safari, webkit, hover

我最近发布了一个网站 ( [http://www.howrad.me](http://www.howrad.me) )，一切正常，除了在 Safari 中悬停。叠加层`pgaTitle`与图像不对齐`pgaPhoto`。

这是绘图部分的代码示例（[http://howrad.me/tattoos.html#drawings](http://howrad.me/tattoos.html#drawings)）

```
 <a class="fancybox" data-fancybox-group="thumb2" title="2012 baybay" href="images/2012/1.jpg">
        <div class="pgaPhoto">
        <div class="pgaTitle" style="display: none;">
        <h2>2012</h2>
        </div>  
        <img src="images/covers/drawing2012.jpg" />
        </div></a>

        <a class="fancybox" data-fancybox-group="thumb3" title="figure study"href="images/2009/drawings/1.jpg">
         <div class="pgaPhoto">
         <div class="pgaTitle" style="display: none;">
        <h2>2010</h2>
        </div>  
        <img src="images/covers/drawing2010.jpg" />
        </div></a> 
```

html 语法对我来说似乎很好，下面的 jquery 工作正常：

```
 $(document).ready(function() {
            $(".pgaPhoto").hover(function() {
                $(this).find(".pgaTitle").stop().fadeTo(300, 1 , function() {
                });
            } , function() { //on hover out...
                $(this).find(".pgaTitle").fadeTo(300, 0);
            });
        }); 
```

我只是不明白为什么左侧图像的悬停状态会稍微偏离，尤其是当我在其他浏览器中没有真正的问题时。有什么帮助吗？？非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:45:48.073

您在块和内联元素之间混淆了。

```
<a> is an inline element
<div> is a block element 
```

块可以包含内联元素，但内联元素**不能**包含块。

每当您将块放入内联元素中时，浏览器都会找到解决差异的方法，但您会得到无效的 HTML 并遭受更多错误。

要解决您的问题，请将您的`<div>`块放在`<a>`元素之外，或者将您`<div>`的 s 替换为最接近的内联等效项：`<span>`.

# azure - 如何在 Azure 辅助角色中使用证书？

> ID：15396920
> 
> 赞同：0
> 
> 时间：2013-03-13T21:34:12.163
> 
> 标签：azure, cryptography

我想不通。我已将我的证书上传到我需要从中使用它的角色。

这在我的机器上效果很好，但它似乎不适用于工人角色，而它正在运行。

在我“安装”此证书之前，我在本地遇到问题 - 我是否必须使用 Azure 执行此操作？

有小费吗？谢谢！

```
string certThumbprint = "8B6F1E6FEC6EB1D2EA8E86F78BD0841310BFD1F8";
X509Store certificateStore = new X509Store(StoreName.My, StoreLocation.LocalMachine);
certificateStore.Open(OpenFlags.ReadOnly);
var certs = certificateStore.Certificates.Find(
                    X509FindType.FindByThumbprint,
                    certThumbprint, false);

if (certs.Count == 0)
{
    Console.WriteLine("Couldn't find the certificate with thumbprint:" + certThumbprint);
    return;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:46:35.637

一些有用的提示：

*   确保您在提升模式下运行。
*   确保证书已上传到 LocalMachine\Personal 存储，而不是 CurrentUser\Personal 存储。
*   确保您已将 .PFX 文件上传到必要的角色，而不是将 .CER 文件上传到管理证书区域。（您可以远程进入实例以确保证书在正确的位置）

# asp.net-mvc-3 - Spark View Engine 和 MVC3 中的强类型视图

> ID：15396925
> 
> 赞同：1
> 
> 时间：2013-03-13T21:34:36.087
> 
> 标签：asp.net-mvc-3, spark-view-engine

我正在玩一些可以与 ASP.net MVC 一起使用的不同视图引擎。我正在尝试 Spark，但我坚持如何让我的视图成为强类型。

我做了以下事情：

```
<viewdata message="string" model="ComparingViewsSparkEngine.Models.LogOnModel" /> 
```

在我看来，我已经改变了这样的事情：

```
@Html.LabelFor(m => m.UserName) 
```

像这样 Sparky：

```
${Html.LabelFor(m => m.UserName)} 
```

但我收到一条错误消息：

> 动态视图编译失败。c:\Users\Ciwan\Documents\Visual Studio 2012\Projects\ComparingViewsSparkEngine\ComparingViewsSparkEngine\Views\Account\LogOn.spark(19,17)：错误 CS1056：意外字符“$”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T09:18:31.597

**更新**

从代码的最后一个版本开始，您拥有：

```
${using (Html.BeginForm()) { 
```

它需要更改为：

```
#using (Html.BeginForm()) { 
```

因为您正在尝试编写一行纯 C# 代码。然后你的最后一行可以`#}`代替`#}}`

* * *

不确定这是否是问题 - 但看起来您还没有关闭第`}`11 行的验证摘要。

而且我敢肯定，当您没有 a来启动代码时，您还必须使用`#}}`而不是`}}`因为表示原始代码行来结束视图。`#``$`

为了绕过丑陋的`#}}`东西，我通常使用[Spark Bindings](http://sparkviewengine.com/documentation/bindings) - 你可以查看我的[博客文章](http://blog.robertgreyling.com/2010/08/spark-bindings-are-you-tired-of-eating.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T13:12:21.907

最后我无法使用它来工作：

```
${using (Html.BeginForm()) { 
```

因此，我只是使用了常规的 HTML 表单标签，现在它可以工作了：

```
<form> // form stuff here </form> 
```

不理想，但至少我没有收到错误，并且页面似乎正在运行。

谢谢

# node.js - 在 Mac OS X Lion 上找不到模块“连接”

> ID：15396927
> 
> 赞同：0
> 
> 时间：2013-03-13T21:34:47.263
> 
> 标签：node.js, module, find, connect

我使用运行以下命令的 NPM 安装了连接模块：

```
npm install connect 
```

它在 /Download/usr/node_modules/connect 文件夹中创建了模块。我创建了一个使用连接模块的文件

```
var connect = require('connect');
var util = require('util');

function sendjson(res,obj)
{
    res.writeHead(200,{'Content-Type':'application/json',});

    var objstr = JSON.stringify(obj);
    util.debug('SENDJSON' + objstr);
    res.end(objstr);
} 

var server = connect.createServer(
    connect.router(function(app){

        app.get('/foo', function(req,res){
            sendjson(res,{path:'foo'});
        })
        app.get('/bar', function(req,res){
            sendjson(res,{path:'bar'});
        })
    })
);

 server.listen(3000); 
```

我运行 node createServer.js 并在终端中抛出，它给了我以下错误。

> 找不到模块“连接”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T22:17:16.977

默认情况下，NPM 模块需要本地安装在包含使用它们的源文件的文件夹中。因此，如果您的源文件在 /Desktop/nodescripts 中，您应该在同一个文件夹中运行“npm install connect”。这将在该路径中创建 node_modules 文件夹，并且您的脚本将能够找到它。

# wpf - 模块化设置/配置

> ID：15396935
> 
> 赞同：0
> 
> 时间：2013-03-13T21:35:11.497
> 
> 标签：wpf, prism, app-config, settings.settings

我有一个使用 PRISM 4 创建的模块化应用程序。我的主要 WPF application.desktop 解决方案有一个 app.config，我的 sysAdmin 模块有 app.config 和一个设置文件。

谁能告诉我如何编辑 sysAdmin 模块的配置/设置文件，因为它们似乎包含在 sysAdmin.dll 中？？？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:43:51.127

嗯...希望接口是在一个常用引用的程序集中定义的？如果是这样，那么只是`UnityContainer.Resolve<T>()`合同绑定类的接口，该类公开您需要的配置/设置。

从幼稚的角度来看，我就是这样做的。一旦我们进入更复杂的因素，这会改变，但我不确定你的设置到底是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T09:22:25.833

我不知道如何使我的模块的 app.config 在部署时可见，所以我将需要在客户端计算机上可编辑的设置添加到主 WPF 应用程序的 app.config 中，然后在我的基础设施模块并在从主 app.config 加载主应用程序时填充它，以便我可以访问模块中的值。不理想，但对我有用。

# c++ - 如何在 QTabWidget 中扩展小部件边界

> ID：15396936
> 
> 赞同：0
> 
> 时间：2013-03-13T21:35:14.443
> 
> 标签：c++, qt

![在此处输入图像描述](../Images/c6fd575c6e26f1f4bc9098422f457fcf.png)

我想消除 QTabWidget 的边框，如图所示。选项卡标签的下半部分应遮挡它们相交的小部件。这可能吗？代码如下：

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

#include "QGraphicsScene"
#include "QTableWidget"
#include "QGraphicsView"
#include "QTextEdit"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);

    QGraphicsView* left = new QGraphicsView(new QGraphicsScene);
    QTextEdit* right = new QTextEdit;

    QTabWidget* tab = new QTabWidget(this);
    tab->insertTab(0, left, "Left");
    tab->insertTab(1, right, "Right");

    setCentralWidget(tab);
}

MainWindow::~MainWindow()
{
    delete ui;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T22:13:53.230

你可以使用`QWidget::layout()`和`QLayout.setContentsMargins ( int left, int top, int right, int bottom )`方法。例如：

```
ui->centralwidget->layout()->setContentsMargins(9,9,9,9);
tab->layout()->setContentsMargins(9,9,9,9); 
```

应该做出你想要的改变。但我建议在 Qt 设计器中而不是在代码中创建和修改表单。

# c# - bing地图加载不出来

> ID：15396937
> 
> 赞同：0
> 
> 时间：2013-03-13T21:35:15.743
> 
> 标签：c#, razor, asp.net-mvc-4, bing-maps

我在 C# 和 ASP.NET MVC4 中做一个 Web 应用程序。我在我的一个视图页面上加载地图时遇到问题...我的详细信息页面上有地图，您从索引页面转到详细信息页面。

这是我的一些代码：

```
<div id='myMap' style="position:relative; width:400px; height:400px;">
</div>
<div>
    <input type="button" value="createWalkingRoute" onclick="createDirections();" />
</div>
<div id='directionsItinerary'> </div>

 @section scripts{

 <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>
  <script type="text/javascript">
      var map = null;
      var directionsManager;
      var directionsErrorEventObj;
      var directionsUpdatedEventObj;

      function getMap() {
          map = new Microsoft.Maps.Map(document.getElementById('myMap'), { credentials: 'mykey' });
      }

      function createDirectionsManager() {
          var displayMessage;
          if (!directionsManager) {
              directionsManager = new Microsoft.Maps.Directions.DirectionsManager(map);
              displayMessage = 'Directions Module loaded\n';
              displayMessage += 'Directions Manager loaded';
          }
          alert(displayMessage);
          directionsManager.resetDirections();
          directionsErrorEventObj = Microsoft.Maps.Events.addHandler(directionsManager, 'directionsError', function (arg) { alert(arg.message) });
          directionsUpdatedEventObj = Microsoft.Maps.Events.addHandler(directionsManager, 'directionsUpdated', function () { alert('Directions updated') });
      }

      function createWalkingRoute() {
          if (!directionsManager) { createDirectionsManager(); }
          directionsManager.resetDirections();
          // Set Route Mode to walking 
          directionsManager.setRequestOptions({ routeMode: Microsoft.Maps.Directions.RouteMode.walking });
          var seattleWaypoint = new Microsoft.Maps.Directions.Waypoint({ address: 'Seattle, WA' });
          directionsManager.addWaypoint(seattleWaypoint);
          var redmondWaypoint = new Microsoft.Maps.Directions.Waypoint({ address: 'Redmond, WA', location: new Microsoft.Maps.Location(47.678561, -122.130993) });
          directionsManager.addWaypoint(redmondWaypoint);
          // Set the element in which the itinerary will be rendered
          directionsManager.setRenderOptions({ itineraryContainer: document.getElementById('directionsItinerary') });
          alert('Calculating directions...');
          directionsManager.calculateDirections();
      }

      function createDirections() {
          if (!directionsManager) {
              Microsoft.Maps.loadModule('Microsoft.Maps.Directions', { callback: createWalkingRoute });
          }
          else {
              createWalkingRoute();
          }
      }

getMap();

  </script>

 } 
```

当您首先进入详细信息页面时，地图不会加载。但是，如果随后刷新页面，则地图会在之后加载。所以对我来说，这是某种加载问题。但在尝试了几个小时后，我完全卡住了。任何人都可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T09:16:41.177

将`getMap()`调用放在页面加载后将被调用的某个地方，例如[body onload 事件](http://www.w3schools.com/jsref/event_body_onload.asp)。如果您使用的是 jquery，则[$(document).ready()](http://api.jquery.com/ready/)。

# c++ - 使用 exec 对发送给孩子的随机数进行排序

> ID：15396939
> 
> 赞同：0
> 
> 时间：2013-03-13T21:35:22.147
> 
> 标签：c++, c, exec

我要做的是发送由父母生成的随机数，然后发送给孩子，然后孩子执行“sort -nr”，然后将排序后的数字发回给父母。我发现这个问题已经被问到并在这里得到了非常类似于我的回答：[how to redirect output of "sort" program from child to parent](https://stackoverflow.com/questions/15318971/how-to-redirect-output-of-sort-program-from-child-to-parent)，我想我做了它所说的一切让它工作，但我不能让排序真正发生。我什至检查过它是否出错，但我什么也没得到。

两个管道发送和接收相同的数字，但它们从未排序。我错过了什么？

```
int pipe1[2], pipe2[2];
pid_t childID;

if (pipe(pipe1) < 0 || pipe(pipe2) < 0) {
    perror("pipe");
    exit(EXIT_FAILURE);
    }

childID = fork();

if (childID < 0) {      
//Child Process Failure
    perror("fork");
    exit(EXIT_FAILURE);
}
else if (childID == 0){                                 
//Child Process Instructions
    cout << "Sent Numbers: " << endl;
    //Closes Unused Pipes
    close(pipe1[WRITE_END]);
    close(pipe2[READ_END]);

    //Dups Over the Others, then closes them
    dup2(pipe1[READ_END], STDIN_FILENO);
    close(pipe1[READ_END]);
    dup2(pipe2[WRITE_END], STDOUT_FILENO);
    close(pipe2[WRITE_END]);

    int fail = execlp("sort", "sort", "-nr", (char *)NULL);
    cout << fail << endl;
    }
else {                                                  
    //Parent Process Instructions
    //Close Unused Pipes
    close(pipe1[READ_END]);
    close(pipe2[WRITE_END]);

    srand(randSeed);
    cout << "Random Numbers: " << endl;
    for (int i = 0; i < nWorkers; i++){     
    //Generate nWorker numbers, then Write
        randNumbers[i] = rand() % (sleepMax - sleepMin + 1) + sleepMin;
        write(pipe1[WRITE_END], &randNumbers[i], sizeof(randNumbers[i]));
        cout << randNumbers[i] << endl;
    }
    close(pipe1[WRITE_END]);
    wait(NULL);
    cout << "SORTED NUMBERS:" << endl;

    double sortedNumbers[nWorkers];
    int n;

    for(int k = 0; k < nWorkers; k++) {
    n = read(pipe2[READ_END], &sortedNumbers[k], sizeof(sortedNumbers[k]));
    cout << sortedNumbers[k] << ", " << n << endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T22:04:03.013

`sort(1)`期望其输入是 ASCII 字符串，而不是原始二进制数。当您使用 向它传递数据时`write(2)`，这就是将数字的原始二进制表示写出到管道中，这不是您想要的。您需要将数字转换为它们的字符串表示形式。

一种方法是在管道顶部使用[`fdopen(3)`](http://linux.die.net/man/3/fdopen). 然后，您可以使用`fprintf`写入格式化的数据：

```
FILE *childInput = fdopen(pipe1[WRITE_END], "w");
if (childInput == NULL) { /* Handle error */ }
for (...)
{
    ...
    fprintf(childInput, "%d\n", randNumbers[i]);
}
fclose(childInput); 
```

同样，在读回孩子的输出时，您需要做同样的事情：

```
FILE *childOutput = fdopen(pipe2[READ_END], "r");
if (childOutput == NULL) { /* Handle error */ }
while (fscanf(childOutput, "%d", &sortedNubers[i]) == 1)
{
    ...
}
fclose(childOutput); 
```

# opencv - opencv houghline 向量错误

> ID：15396940
> 
> 赞同：0
> 
> 时间：2013-03-13T21:35:22.680
> 
> 标签：opencv, vector

我在 VS 2010 中使用 OpenCV 2.4.3。我尝试在 VS2012 中编译 Houghline 的示例代码，它运行良好。但是使用VS2010+OpenCV 2.4.3（因为我想使用Qt），我收到错误

```
access violation reading memory location 
```

我发现是因为`vector<Vec4i> lines`调用程序调用函数时的vector `HoughlineP(... , lines , ...)`，我上网查了一下，没有找到明确的解决这个问题的办法。你能建议吗？谢谢你。

编辑：

```
vector<Vec4i> lines;
HoughLinesP(ROIcannied, lines, 1, CV_PI/180, intersect, 5, 5 ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T13:08:08.023

确保您的 ROIcannied 图像是 8 位和单通道二进制。请注意，您使用的 Canny 运算符给出的输出图像与其输入类型相同。你应该给精明的操作员一个二进制图像。

# xpages - 如何将 XPages 移动控件选项卡栏放置在屏幕底部？

> ID：15396943
> 
> 赞同：1
> 
> 时间：2013-03-13T21:35:35.920
> 
> 标签：xpages, dojo, xpages-extlib

我正在尝试在 Xpages Mobile 控件中获取底部标签栏。它通常是黑色的，带有深色图标，并且页面更改会让您按下图标。

我无法弄清楚如何使用实际的 Mobile Controls Tab bar 获得外观。这似乎适用于segmentedTabBar，而不是我猜的标准标签栏。我尝试使用下面的代码手动访问 Dojo，我得到了外观，但标签栏显示在屏幕顶部而不是底部。

我宁愿使用移动控制版本，但无论如何我很容易。我很想得到一个在 XPages 中工作的底部标签栏。

任何意见，将不胜感激。

```
<xe:singlePageApp id="singlePageApp1" selectedPageName="home">

<xe:appPage id="appPage1" pageName="home">

    <ul data-dojo-type="dojox.mobile.TabBar" fixed="bottom">
    <li data-dojo-type="dojox.mobile.TabBarButton"
        data-dojo-props='icon1:"/Add_32x32.png",
                   selected:true'>
        Featured
    </li>
    <li data-dojo-type="dojox.mobile.TabBarButton"
        data-dojo-props='icon1:"/1_48x48.png"'>
        Categories
    </li>
    <li data-dojo-type="dojox.mobile.TabBarButton"
        data-dojo-props='icon1:"1_48x48.png"'>
        Top 25
    </li>
    <li data-dojo-type="dojox.mobile.TabBarButton"
        data-dojo-props='icon1:"Add_32x32.png"'>
        Search
    </li>
    <li data-dojo-type="dojox.mobile.TabBarButton"
        data-dojo-props='icon1:"1_48x48.png"'>
        Updates
    </li>
</ul>

</xe:appPage></xe:singlePageApp></xp:view> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T07:58:33.960

查看 IBM Press 第 295 页的 Extension Library 一书。关于选项卡栏的这一章包含屏幕底部的操作栏示例：

```
<xe:tabBar id="tabBar1">
  <xe:tabBarButton id="tabBarButton1" label="Button 1"></xe:tabBarButton>
  <xe:tabBarButton id="tabBarButton2" label="Button 2"></xe:tabBarButton>
  <xe:tabBarButton id="tabBarButton3" label="Button 3"></xe:tabBarButton>
</xe:tabBar> 
```

如果您使用，它似乎只是一个分段的标签栏`barType="segmentedControl"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T22:56:50.423

我正在尝试自己完成同样的事情。我怀疑这个问题是因为 XPages 移动控件还不支持移动可滚动窗格，它允许在页眉和页脚之间定位固定大小（可滚动）的内容。css 很可能会使用标签栏的绝对定位来防止它随内容滚动。但是当这完成后，您将需要实现某种形式的可滚动窗格，以阻止主要内容在工具栏上方/下方滚动。

下面的 CSS 大部分时间都可以工作，但我发现它有时不愿意捕捉到正确的位置。

```
.rpTabBar {
  position: fixed;
  bottom: 0;
  width: 100%;
  z-index: 999;
  height: 50px;
  margin-top: -50px;
  clear: both;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T14:02:59.677

在查看了 dojo 示例后，我注意到导航栏保持固定在底部的示例使用了 scrollableView 控件。XPages appPage 控件基于标准视图控件。所有这些示例似乎都将 navBar 浮动在内容的底部。尝试了几个星期后，我明白了原因。使用此控件时，几乎不可能让导航栏粘在底部。

我们还没有找到一种在不丢弃所有 Xpages 移动控件的情况下实现 scrollableView 的方法。相反，我们在每个 appPage 中创建了一个 div，它实现了 dojo scrollablePane。使用它，我们可以为固定页眉和固定页脚提供控件 ID。navBar 现在很好地贴在每一页的底部。

# php - PHP：我应该在类中编写所有代码吗？

> ID：15396946
> 
> 赞同：0
> 
> 时间：2013-03-13T21:35:48.877
> 
> 标签：php, oop, class

我用 PHP 编码已经有一段时间了，但我主要是用函数和原始 PHP 编码。

我开始认为我应该把我的代码写得更整洁、更高效。我仍然无法完全理解课程。我应该在课堂上编写所有代码吗？

例如，我的脚本之一是“权限管理器”——它允许管理员编辑站点上各种用户组的权限。

传统上，我会把它写成一个带有函数之类的脚本。但是把它写成一个类会更好吗？如果是这样，这个类将包含什么？我是否有一个单独的权限类用于站点周围，另一个用于管理编辑区域？

该网站也有一个API。这些都应该写成一个类吗？

另外，我应该使用公共（共享）功能吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:48:10.223

当属于和/或面向同一实体或提议的一组特定函数和变量要在不同环境中使用时，在类中编写内容很有用。它给人一种组织感、任务委派的感觉，并避免了代码的重复。

但在上述错误的情况下，它完全是一次性的。为只在一个特定位置运行的东西编写一个类是没有意义的。

此外，如果您只想将一组信息组织成类似 in 等对象的样式`$user->name`，`$user->age`您可以简单地执行以下操作：

```
$user = (object)array(
    'name' => 'John',
    'age'  => 20
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T21:44:57.470

在我看来，一切都取决于你的项目有多大。我使用 Magento 已经有一段时间了，它太大了，必须按类和数据包进行分组。如果将项目拆分为类，则更容易阅读代码和分析项目的结构。此外，当您需要在一个月或一年后修改您的项目时，良好的结构有助于重新学习它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T22:44:23.350

你应该从不同的角度来处理这个问题。不要仅仅因为您认为必须使用 OOP 而使用 OOP。

问你自己：

1.  我的应用程序的某些部分是否可以在我的应用程序的其他部分中重用？然后这些可以从你的脚本中取出并放入一个函数或类中。

2.  是否存在您希望交换部分代码以更改行为而无需重写应用程序的主要部分的情况？然后类和接口适合您。

使用 OOP 原则的另一个很好的论据是提高了代码的可测试性。使用接口允许您在测试时将实际对象交换为模拟或存根。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T21:41:25.077

是的，在我看来，最好让你的代码`OOP`更整洁、更易理解、更易读，而且维护起来也更容易，请在这个堆栈中查看： [https ://stackoverflow.com /questions/4409824/what-are-the-advantages-of-object-oriented-php](https://stackoverflow.com/questions/4409824/what-are-the-advantages-of-object-oriented-php)

# ios - 连接在一起：AppDelegate、ViewController 和 XIB

> ID：15396947
> 
> 赞同：8
> 
> 时间：2013-03-13T21:35:54.840
> 
> 标签：ios, objective-c, uiview, uiviewcontroller, appdelegate

我是 iOS 编程的新手，遇到了一个问题。

做了什么：

我已经创建了 iOS 应用程序。最初它有 main.m、AppDelegate.h、AppDelegate.m 和其他一些通常创建的支持文件（不包含代码）。

然后我手动创建了带有接口（LoginView.xib）的XIB文件，并手动添加了LoginViewController.h和LoginViewController.m来控制XIB。

在 LoginViewController.h 中添加了 outlet。

毕竟我设置了文件的所有者类（LoginViewController）并在XIB和LoginViewController.h之间建立了连接。

问题描述：

我需要在应用程序启动时显示实例化登录视图控制器并立即显示登录视图。

我尝试了几次尝试并阅读了十几个论坛主题，但没有办法。除了白色窗口背景外，没有显示任何内容。我怎样才能做到正确？

参考代码：

登录视图控制器.h

```
#import <UIKit/UIKit.h>

@interface LoginViewController : UIViewController
{
    IBOutlet UIView        *_loginView;
    IBOutlet UITextField   *_tfLogin;
    IBOutlet UITextField   *_tfPassword;
    IBOutlet UIButton      *_btnLoginToSystem;
}

- (IBAction)attemptLogin:(id)sender;

@end 
```

登录视图控制器.m

```
#import "LoginViewController.h"

@interface LoginViewController ()

@end

@implementation LoginViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (IBAction)attemptLogin:(id)sender
{

}

@end 
```

AppDelegate.h

```
#import <UIKit/UIKit.h>
#import "LoginViewController.h"

@interface AppDelegate : UIResponder <UIApplicationDelegate>

@property (strong, nonatomic) UIWindow *window;
@property (strong, nonatomic) LoginViewController *loginViewController;

@end 
```

AppDelegate.m

```
#import "AppDelegate.h"

@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    self.window.backgroundColor = [UIColor whiteColor];
    self.loginViewController = [[LoginViewController alloc] initWithNibName:@"LoginView" bundle:nil];
    [self.window.rootViewController presentModalViewController:self.loginViewController animated:NO];

    [self.window makeKeyAndVisible];
    return YES;
} 
```

更新！！！伙计们，谢谢大家，我发现了另一个问题。一旦我得到您的批准，我的代码（当然是在适当的版本之后）是正确的，我启动了模拟器，发现我的应用程序崩溃了，但出现以下异常：

```
NSInternalInconsistencyException with the reason [UIViewController _loadViewFromNibNamed:bundle:] loaded the ... nib but the view outlet was not set. 
```

感谢 StackOverflow，我修复了它。 [已加载 nib 但未设置视图出口 - InterfaceBuilder 的新功能](https://stackoverflow.com/questions/4763519/loaded-nib-but-the-view-outlet-was-not-set-new-to-interfacebuilder)

从我提供链接到的主题中引用 Josh Justice 的评论：

> 1.  打开导致问题的 XIB 文件
> 2.  单击左侧栏上的文件所有者图标（顶部一个，看起来像一个黄色轮廓框）
> 3.  如果您没有看到右侧边栏，请单击工具栏中“视图”上方的第三个图标。这将显示右侧边栏
> 4.  在右侧边栏中，单击第三个选项卡——看起来有点像报纸的选项卡
> 5.  在顶部的“自定义类”下，确保 Class 是应与该视图对应的 ViewController 的名称。如果没有，请输入
> 6.  在右侧边栏中，单击最后一个选项卡 - 看起来像一个带有箭头的圆圈
> 7.  您应该在其下方看到带有“视图”的“出口”。将旁边的圆圈拖到左侧栏上的“查看”图标（底部一个，看起来像一个带有粗灰色轮廓的白色正方形
> 8.  保存xib并重新运行

可能这些信息汇总到一个点会帮助其他新人更快地通过我通过的方式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-13T21:39:32.237

将 LoginViewController 设置为应用程序中的根视图控制器：didFinishLaunchingWithOptions: 方法。

```
self.window.rootViewController = self.loginViewController; 
```

删除这一行：

```
[self.window.rootViewController presentModalViewController:self.loginViewController animated:NO]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T21:38:58.937

你必须在你的**AppDelegate.m**`rootViewController`中设置这样的

 **```
self.window.rootViewController = self.loginViewController; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T22:00:50.407

您是否曾使用故事板创建界面？（故事板是 iOS 5 的新功能）它们基本上是一种在一个文件中布置所有视图控制器并在视觉上设置它们之间的连接的方式。使用故事板，您想要做的事情真的很容易。当您在情节提要文件上设置视图控制器时，您将看到一个指向您设置的第一个情节提要的箭头。这意味着当您运行您的应用程序时，它将加载初始视图。如果您喜欢首先加载不同的视图，只需将该箭头拖到不同的视图控制器。**

# android - 在 OnClickListener 中更改整数值

> ID：15396956
> 
> 赞同：0
> 
> 时间：2013-03-13T21:36:28.920
> 
> 标签：android, integer, onclicklistener

我有一个整数变量，我想在按下按钮但代码不起作用时更改它。是说我应该将 bpm 设置为 final 但是当我这样做时我不能增加它！

Java代码：

```
super.onCreate(savedInstanceState);
int bpm;
setContentView(R.layout.activity_metronome);
final Button plus = (Button) findViewById(R.id.tempop);
final Button minus = (Button) findViewById(R.id.tempom);
final Button confirm_tempo = (Button) findViewById(R.id.confirmtempo);
final TextView curbpm = (TextView) findViewById(R.id.curbpm);
bpm=60;
curbpm.setText("" + bpm);

plus.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
        bpm++;
        curbpm.setText(""+bpm);
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T21:39:28.707

使其具有类范围这意味着将其从方法中取出。

```
int bpm;
@Override
protected void onCreate (Bundle savedInstanceState){
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_metronome);
  final Button plus = (Button) findViewById(R.id.tempop);
  final Button minus = (Button) findViewById(R.id.tempom);
  final Button confirm_tempo = (Button) findViewById(R.id.confirmtempo);
  final TextView curbpm = (TextView) findViewById(R.id.curbpm);
  bpm=60;
  curbpm.setText("" + bpm);

  plus.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
      bpm++;
      curbpm.setText(""+bpm);
    }
  });
} 
```

使用它也更清洁，`String.valueOf (bpm)`而不是`""+bpm`.

# neural-network - FANN：保存/加载经过训练的 ann 更改 MSE？

> ID：15396957
> 
> 赞同：-1
> 
> 时间：2013-03-13T21:36:35.337
> 
> 标签：neural-network, fann

这样的问题：我已经使用 MSE 停止功能训练了一些 ann，直到“期望错误”10^-5（5MB 的训练数据，15000 个输入项，训练周期长——大约一天）。我在训练期间有 0 位失败。我已将 ann 保存到文件中。

然后我从文件中加载网络，并在相同的训练数据上进行检查。有时我会失败到 5 次（不那么罕见，顺便说一句！）。

这是什么？有人遇到这种现象吗？

我怀疑，这是四舍五入的产物：成千上万的权重以文本格式保存到文件中并加载回......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T22:49:37.737

解决了。

fann_reset_MSE() 和 fann_test_data() 之后的 MSE 与 fann_train() 返回的错误无关。如果 ANN 被训练到非常低的 MSE，则 fann_get_MSE() 和 fann_get_bit_fail() 或多或少与 fann_reset_MSE() 和 fann_test_data() 函数返回的值一致。如果不是（ANN 没有很好地训练），那么这些值可能会在数量级上有所不同。

# php - 在表单上添加另一个项目/行，插入数据库

> ID：15396962
> 
> 赞同：0
> 
> 时间：2013-03-13T21:36:49.397
> 
> 标签：php, mysql

![添加另一个项目](../Images/95168a68a89a2a01e7766e188e29710e.png)

这两个字段被插入到数据库中。但是，我想让用户能够“添加另一个项目”。理想情况下，他们应该能够添加任意数量的项目。当他们提交表单时，数据将被插入到 mysql 表中。

我该怎么做呢？在我的数据库中创建 10 个额外的列来容纳添加的额外项目听起来既不现实也不理想。

谢谢您的帮助！

这是我的代码片段，我将数据插入数据库：

```
if ($stmt = $mysqli->prepare("INSERT items (number, description) VALUES (?, ?)"))
                            {
                                    $stmt->bind_param("ss", $number, $description);
                                    $stmt->execute();
                                    $stmt->close();
                            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:50:25.927

这是一个非常复杂的问题，但有一些非常简单的解决方案。首先，您需要更改用于处理可变数量项目的后端 PHP 脚本。

例如，现在，你可能有类似的东西：

```
$item_number = $_POST['item_number'];
$item_description = $_POST['item_description'];
add_item_to_db($item_number, $item_description); 
```

您需要更改代码以处理一系列项目：

```
$item_numbers = $_POST['item_number'];
$item_descriptions = $_POST['item_description'];
// validate that count($item_numbers) == count($item_descriptions)
for ($i = 0; $i < count($item_numbers); $i++) {
    add_item_to_db($item_numbers[$i], $item_descriptions[$i]);
} 
```

在上面未显示的情况下，您需要执行相当多的错误处理。如果用户输入的 item_number 数量与 item_descriptions 不同，则您必须确定如何处理。此外，任何字段都可以为空。有些情况可能是错误的，有些情况可能不是。

您必须更改 HTML：

```
<input type="text" name="item_number[]" />
<input type="text" name="item_description[]" /> 
```

注意名称中的*[]*。这为每个指定了一个值数组。

*最后，当用户按下Add another item*链接时，您需要在屏幕上动态添加一组新的*输入项。*我建议为此使用 jQuery。为此，您将执行以下操作：

 *```
jQuery('<input type="text" name="item_number[]" /><input type="text" name="item_description[]" />').appendTo('#someDiv'); 
```

确保将新的*输入*元素附加到表单元素中。显然，还有很多代码需要编写。这只是概念的一个基本示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T21:46:29.400

只需使用：

```
name="item[]" 
```

对于项目 # '

和

```
name="description[]"

<input type="text" name="item[]" /><input type="text" name="description[]" /> 
```

对于项目描述字段并在您的服务器端遍历它们。在前端只需创建一个多次复制该节点的脚本。

**编辑**

根据您显示的代码，它应该类似于以下代码：

```
if(isset($_POST['item']){
for($i = 0; $i < count($_POST['item']); $i++){
$number = $_POST['item'][$i];
$description= $_POST['description'][$i];
if ($stmt = $mysqli->prepare("INSERT items (number, description) VALUES (?, ?)"))
                            {
                                    $stmt->bind_param("ss", $number, $description);
                                    $stmt->execute();
                                    $stmt->close();
                            }
} 
```

在您的 javascript 中执行以下操作：

```
function addRow(){
  document.getELementById('container').el.innerHTML += '<input type="text" name="item[]" /><input type="text" name="description[]" />' ;
} 
```

HTML 代码：

```
<form name='myform' >

 <div id="container">
 <input type="text" name="item[]" /><input type="text" name="description[]" />     
 </div>
    <p onclick="addRow() ;" >Add another item</p>
</form> 
```

我希望这有帮助。

**更新**

试试这个：

```
if(isset($_POST['item']){

if ($stmt = $mysqli->prepare("INSERT items (number, description) VALUES (?, ?)"))
{
  for($i = 0; $i < count($_POST['item']); $i++){
  $number = $_POST['item'][$i];
  $description= $_POST['description'][$i];

                                    $stmt->bind_param("ss", $number, $description);
                                    $stmt->execute();

  }
  $stmt->close();

 } 
```*

# javascript - 循环通过单选按钮组

> ID：15396966
> 
> 赞同：0
> 
> 时间：2013-03-13T21:37:07.437
> 
> 标签：javascript, for-loop, radio-button

我有以下javascript函数。基本上，它的作用是检查一组单选按钮，如果找到一个 checkec，则将在特定文本框中设置一个值。

由于某种原因，它没有通过 for 循环。

```
function placeMarker(location) {
    document.getElementById('<%= position.ClientID%>').value = location;
    var marker = new google.maps.Marker({
        position: location,
        map: map
    });
    var i;
    var checked = false;
    var radios = document.getElementsByName("DynamicRadioButton");  
    for (i = 2; i < radios.length; i++) {
        if (radios[i].checked) {
            var text = document.getElementsByName("DynamicTextBox");
            text[i - 2].value = location;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:46:37.747

看看这个 jsfiddle，这段代码确实进入了循环。您的问题必须在其他地方：

```
function loop() {
    var radios = document.getElementsByName("DynamicRadioButton");  
    for (i = 0; i < radios.length; i++) {
        alert('looping radio ' + i);
    }
};

<input type="radio" name="DynamicRadioButton">radio1</input>
<input type="radio" name="DynamicRadioButton">radio2</input>
<input type="button" value="Loop" onclick="loop()"/> 
```

[http://jsfiddle.net/txQVv/1/](http://jsfiddle.net/txQVv/1/)

# c# - 可变数量矩形的动态数据显示图

> ID：15396972
> 
> 赞同：1
> 
> 时间：2013-03-13T21:37:20.663
> 
> 标签：c#, wpf, data-binding, graph, dynamic-data-display

我正在尝试绘制用户的输入数据，这些数据最终将成为图形中的一系列矩形（不同大小和位置，不重叠）。我读过的所有示例要么仅绘制具有可变点数的线，要么在 XAML 中的形状中硬编码。但我不知道数据需要多少个矩形。我的理想情况是遵循 MVVM 并简单地从 XAML 绑定到我可以修改的 ObservableCollection，但我看到的大多数示例似乎都使用代码隐藏，直接访问 ChartPlotter。这是我绘制了一些简单的矩形并进行了修改的结果，这些矩形有效：

可视化窗口.xaml

```
<Window x:Class="View.VisualizationWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d3="http://research.microsoft.com/DynamicDataDisplay/1.0"
        Title="VisualizationWindow" MinHeight="300" MinWidth="500" Height="300" Width="500">
    <Grid>
        <d3:ChartPlotter Name="Chart">
            <d3:RectangleHighlight Name="Rect1" Bounds="-1,-1.5,.5,2" StrokeThickness="3" Fill="Blue" ToolTip="Blue!"></d3:RectangleHighlight>
            <d3:RectangleHighlight Name="Rect2" Bounds="1,1.5,2,.5" StrokeThickness="1" Fill="Red" ToolTip="Red!"></d3:RectangleHighlight>
        </d3:ChartPlotter>
    </Grid>
</Window> 
```

可视化窗口.xaml.cs

```
public partial class VisualizationWindow : Window
{
    public VisualizationWindow(ListViewModel vm)
    {
        InitializeComponent();
        this.DataContext = vm;

        Chart.Viewport.Visible = new Rect(-1, -1, .5, .5);

        Rect1.Bounds = new Rect(0,0,.3,.3);
    }
} 
```

几乎不存在有关动态数据显示的文档。如果 D3 不能优雅地做到这一点，我很想知道其他库是否可以更轻松地做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T21:51:29.890

## 将 ItemsSource 处理添加到现有类。

似乎他们已经尽一切努力使 ChartPlotter 只接受 IPlotterElements。没有 ItemsSource 属性，因此 Children 将始终返回实际元素。RectangleHighlight 的 Bounds 属性是不可绑定的，并且类是密封的，禁止任何方法覆盖该属性。

我们可以从派生类中“注入”ItemsSource 处理。它不会像真正的交易那样工作，因为没有非骇客的方式让 Children 属性反映数据绑定。但是，我们仍然可以通过这种方式分配 ItemsSource。

我们需要一些东西。我们需要实际的 ItemsSource 属性。一种对其设置做出反应的方法。如果我们想要绑定到 dataObjects，一种处理 DataTemplates 的方法。我还没有深入研究现有的源代码。但是，我确实想出了一种无需 DataTemplateSelector 即可处理 DataTemplates 的方法。但除非您修改我的示例，否则它也不适用于 DataTemplateSelector。

这个答案假设你知道绑定是如何工作的，所以我们将直接跳到最初的课程，而不需要太多的帮助。

首先是 Xaml：

```
<local:DynamicLineChartPlotter Name="Chart" ItemsSource="{Binding DataCollection}">
    <local:DynamicLineChartPlotter .Resources>
        <DataTemplate DataType{x:Type local:RectangleHighlightDataObject}>
            <d3:RectangleHighlight 
                Bounds="{Binding Bounds}" 
                StrokeThickness="{Binding StrokeThickness}"
                Fill="{Binding Fill}"
                ToolTip="{Binding ToolTip}"
            />
        </DataTemplate>
    </local:DynamicLineChartPlotter .Resources>
</local:DynamicLineChartPlotter > 
```

课程：

```
public class RectangleHighlightDataObject
{
    public Rect Bounds { get; set; }
    public double StrokeThickness { get; set; }
    public Brush Fill { get; set; }
    public String ToolTip { get; set; }
}

public class VisualizationWindow
{
    public VisualizationWindow() 
    {
         DataCollection.Add(new RectangleHighlightDataObject()
         {
             Bounds = new Rect(-1,-1.5,.5,2),
             StrokeThickness = 3,
             Fill = Brushes.Blue,
             ToolTip = "Blue!"
         });

         DataCollection.Add(new RectangleHighlightDataObject()
         {
             Bounds = new Rect(1,1.5,2,.5),
             StrokeThickness = 1,
             Fill = Brushes.Red,
             ToolTip = "Red!"
         });
    }
    public ObservableCollection<RectangleHighlightDataObject> DataCollection = 
             new ObservableCollection<RectangleHighlightDataObject>();
} 
```

您必须使用 ChartPlotter 的派生类，而不是实现 ItemsSource。

[从有关如何实现动态 D3 类型的讨论中](http://dynamicdatadisplay.codeplex.com/discussions/78607)收集到的示例。我修改为使用 DataTemplates 而不是实际的对象元素，这是为了支持 OP 的数据绑定。

```
public class DynamicLineChartPlotter : Microsoft.Research.DynamicDataDisplay.ChartPlotter
{
    public static DependencyProperty ItemsSourceProperty =
            DependencyProperty.Register("ItemsSource",
                                        typeof(IEnumerable),
                                        typeof(DynamicLineChartPlotter),
                                        new FrameworkPropertyMetadata(null, new PropertyChangedCallback(OnItemsSourceChanged)));

    [DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden), Bindable(true)]
    public IEnumerable ItemsSource
    {
        get
        {
            return (IEnumerable)GetValue(ItemsSourceProperty);
        }
        set
        {
            if (value == null)
                ClearValue(ItemsSourceProperty);
            else
                SetValue(ItemsSourceProperty, value);
        }
    }

    private static void OnItemsSourceChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        DynamicLineChartPlotter control = (DynamicLineChartPlotter)d;
        IEnumerable oldValue = (IEnumerable)e.OldValue;
        IEnumerable newValue = (IEnumerable)e.NewValue;

        if (e.OldValue != null)
        {
            control.ClearItems();
        }
        if (e.NewValue != null)
        {
            control.BindItems((IEnumerable)e.NewValue);
        }
    }

    private void ClearItems()
    {
        Children.Clear();
    }

    private void BindItems(IEnumerable items)
    {
        foreach (var item in items)
        {
            var template = GetTemplate(item);
            if (template == null) continue;

            FrameworkElement obj = template.LoadContent() as FrameworkElement;
            obj.DataContext = item;
            Children.Add((IPlotterElement)obj);
        }
    }

    private DataTemplate GetTemplate(object item)
    {
        foreach (var key in this.Resources.Keys)
        {
            if (((DataTemplateKey)key).DataType as Type == item.GetType())
            {
                return (DataTemplate)this.Resources[key];
            }
        }
        return null;
    }
} 
```

现在这是你碰到砖墙的地方。

RectangleHighlight Bounds 属性不能是数据绑定的。你也不能从他们那里得到解决这个问题。

我们可以通过拉出数据模板并生成静态 RectangleHighlight 来解决问题，但如果数据值发生变化，我们就完蛋了。

那么，如何解决这个问题？

好吧，我们可以使用附加属性！

## 使用附加属性

我们将创建一个处理附加属性的静态类。它响应 OnPropertyChanged 手动创建和设置真实属性。现在，这只会以一种方式起作用。如果您碰巧更改了属性，它不会更新附加的属性。但是，这应该不是问题，因为我们应该只更新我们的数据对象。

添加这个类

```
public class BindableRectangleBounds : DependencyObject
{
    public static DependencyProperty BoundsProperty = DependencyProperty.RegisterAttached("Bounds", typeof(Rect), typeof(BindableRectangleBounds), new PropertyMetadata(new Rect(), OnBoundsChanged));

    public static void SetBounds(DependencyObject dp, Rect value)
    {
        dp.SetValue(BoundsProperty, value);
    }
    public static void GetBounds(DependencyObject dp)
    {
        dp.GetValue(BoundsProperty);
    }

    public static void OnBoundsChanged(DependencyObject dp, DependencyPropertyChangedEventArgs args)
    {
        var property = dp.GetType().GetProperty("Bounds");
        if (property != null)
        {
            property.SetValue(dp, args.NewValue, null);
        }
    }
} 
```

然后将 XAML 行从

```
 Bounds="{Binding Bounds}" 
```

到

```
 local:BindableRectangleBounds.Bounds="{Binding Bounds}" 
```

## 响应集合已更改。

到现在为止还挺好。但是 OP 注意到，如果他对分配给 ItemsSource 的集合进行了更改，则控件中不会发生任何变化。那是因为我们只在分配 ItemsSource 时才添加子项。现在，除非确切知道 ItemsControl 如何实现 ItemsSource。我知道我们可以通过在集合更改时注册到 ObservableCollection 的事件来解决这个问题。每当集合更改时，我都会使用一种简单的方法来重新绑定控件。这仅在 ItemsSource 由 ObservableCollection 分配时才有效。但我认为这与没有 ObservableCollection 的 ItemsControl 有同样的问题。

然而，我们仍然没有重新分配 dataContext。所以不要指望改变 Children 会正确地重新绑定。但是，如果您确实直接更改子项，而不是 ItemsControl 中的 ItemsSource，您将失去绑定。所以我很可能会走上正轨。我们失去的唯一怪癖是，当您在设置 ItemsSource 后引用 Children 时，ItemsControl 返回 ItemsSource。我还没有解决这个问题。我能想到的唯一一件事就是隐藏 children 属性，但这不是一件好事，如果您将控件称为 ChartPlotter，它将无法工作。

添加以下内容

```
 public DynamicLineChartPlotter()
    {
        _HandleCollectionChanged = new NotifyCollectionChangedEventHandler(collection_CollectionChanged);
    }

    private static void OnItemsSourceChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        DynamicLineChartPlotter control = (DynamicLineChartPlotter)d;
        IEnumerable oldValue = (IEnumerable)e.OldValue;
        IEnumerable newValue = (IEnumerable)e.NewValue;
        INotifyCollectionChanged collection = e.NewValue as INotifyCollectionChanged;
        INotifyCollectionChanged oldCollection = e.OldValue as INotifyCollectionChanged;

        if (e.OldValue != null)
        {
            control.ClearItems();
        }
        if (e.NewValue != null)
        {
            control.BindItems((IEnumerable)e.NewValue);
        }
        if (oldCollection != null)
        {
            oldCollection.CollectionChanged -= control._HandleCollectionChanged;
            control._Collection = null;
        }
        if (collection != null)
        {
            collection.CollectionChanged += control._HandleCollectionChanged;
            control._Collection = newValue;
        }
    }

    void collection_CollectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        ClearItems();
        BindItems(_Collection);
    }

    NotifyCollectionChangedEventHandler _HandleCollectionChanged;
    IEnumerable _Collection; 
```

# database-design - Redis 中最快的伪索引是什么？

> ID：15396974
> 
> 赞同：3
> 
> 时间：2013-03-13T21:37:22.033
> 
> 标签：database-design, indexing, redis

Redis 小书解释了如何通过电子邮件地址查找用户 ID，以便您可以通过用户 ID 查找用户哈希并获取完整的用户对象。它实际上是通过电子邮件地址对用户的索引。每次插入新用户时，您只需添加到查找哈希中，如下所示：

```
set users:9001 "{id: 9001, email: leto@dune.gov, ...}"
hset users:lookup:email leto@dune.gov 9001 
```

在我看来，此操作涉及 Redis 必须执行的哈希内的隐藏查找，以提取所需电子邮件字段的值。可能有数千个电子邮件字段，我们只要求其中一个。

如何在索引键中使用电子邮件，如下所示：

```
set users:9001 "{id: 9001, email: leto@dune.gov, ...}"
set users:lookup:email:leto@dune.gov 9001 
```

因为这在 Redis 小书中没有建议，所以我认为这不是最佳实践。

谁能解释为什么第一种方法更好？它们实际上是一样的吗？

谢谢，我正在学习Redis。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T22:21:47.240

在我看来，每种方法都有自己的优点和缺点：

哈希方法：

*   您可以相当快地获得所有电子邮件（键）或 ID（值）的列表（O(N)，其中 N 是地图中的条目数）
*   对于少量条目，它将非常节省内存（虽然很小，可能不适用于任何实际用例）
*   您被限制为 2^32-1 个条目（同样，可能不是问题，除非您计划让地球上的大多数人使用您的应用程序）
*   *稍微*慢一点，因为 redis 需要进行两次 O(1) 查找而不是一次...
*   对分片不友好，因为它们都将在同一个 redis 实例中。

关键方法：

*   条目数量没有限制
*   尽可能快
*   只能使用`KEY`O(n) 获取所有用户的列表（对于数据库中的每个条目 - 对于实时环境来说是一个很大的禁忌）
*   分片友好

这些都是我能想到的差异。除非出于某种原因我需要列出所有用户，否则我倾向于使用 key 方法，只是因为它更直接并且可以通过分片更好地扩展。

顺便说一句，如果可以避免，我可能不会将 JSON 数据存储为用户数据，因为将字段存储在哈希中可能会更节省内存。此外，您可以只获取和设置您真正需要的字段，而不是整个 blob。也可以在没有事务的情况下以原子方式对哈希进行增量，这很有用。但这一切都取决于您的数据......如果您有一个大型嵌套结构，那么将其序列化并将其放入其中可能是最简单的，而不是创建许多不同的本机结构并将它们链接在一起。

# c# - 在可移植类库中使用 await HttpClient.GetAsync 的异常

> ID：15396981
> 
> 赞同：3
> 
> 时间：2013-03-13T21:37:41.120
> 
> 标签：c#, portable-class-library, async-await

我有带有代码的便携式类库（net40+sl4+win8+wp71）：

```
 public static async Task<Dictionary<string, FeedItem>> GetFeeds()  
    {  
        try
        {
            string data;
            using (HttpMessageHandler handler = new HttpClientHandler())
            {
                using (HttpClient httpClient = new HttpClient(handler))
                {
                    data = await httpClient.GetStringAsync(FeedsUrl + Guid.NewGuid()).ConfigureAwait(false);
                }
            }

            if (data != null)
            {
                //...
            }
            return null;
        }
        catch
        {
            return null;
        }
    } 
```

引用了 Microsoft.Bcl、Microsoft.Bcl.Async 和 Microsoft.Net.Http。

我在 Windows 8 Metro 应用程序中使用这个库。然后我通过VS2012调试应用程序，就可以了。但是当我创建应用程序包并安装它时，应用程序在每次启动时都会崩溃并出现错误：

```
Framework Version: v4.0.30319
Description: The process was terminated due to an unhandled exception.
Exception Info: System.Runtime.InteropServices.COMException
Stack:
   at System.Runtime.CompilerServices.AsyncMethodBuilderCore.<ThrowAsync>b__1(System.Object)
   at System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(System.Object)
   at System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
   at System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object, Boolean)
   at System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem()
   at System.Threading.ThreadPoolWorkQueue.Dispatch()
   at System.Threading._ThreadPoolWaitCallback.PerformWaitCallback() 
```

编辑：如果我注释行“data = await httpClient.GetStringAsync”，它将毫无例外地工作。

在第二次启动时，它始终有效。

有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T02:49:44.190

这些包具有特定于框架的实现。您可能会遇到问题，因为您没有从 Win8 应用程序中引用特定于框架的程序集。

您可以尝试从您的应用程序中引用 Nuget 包，看看它是否能解决问题？Nuget 不会在堆栈上安装包，因此当您创建使用另一个 Nuget 包的类库时，您需要手动将该 Nuget 包添加到引用该类库的项目中。

当类库通过包依赖项打包为 nupkg 时，这会透明地发生，但是当您使用项目或二进制引用时，您需要自己做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T18:06:46.747

只是猜测，但看起来你得到了一个你没有处理的异常，可能是在一个 async void 方法中。当 await 调用恢复时，它会抛出异常，但是因为它只是从 await 恢复，所以调用堆栈不会反映代码中发生故障的位置。

我建议将您拥有的任何 async void 方法的主体包装在一个 try/catch 块中，该块将报告异常以及它在您的代码中发生的位置。这应该有助于找出问题所在。一旦出现异常，查看它的 HResult 属性也可能对此有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-15T15:07:06.233

我已经想通了。我使用 MVVM Light，所以我有 ViewModelLocator 和代码：

```
public ViewModelLocator()
{
    ServiceLocator.SetLocatorProvider(() => SimpleIoc.Default);

    SimpleIoc.Default.Register<MainViewModel>(true);
} 
```

因此，当我删除模型的立即创建时，它停止崩溃：

```
SimpleIoc.Default.Register<MainViewModel>(/*true*/); 
```

我不知道为什么，但我认为这是因为 MVVM Light 在 Microsoft.Bcl、Microsoft.Bcl.Async 或 Microsoft.Net.Http 方面存在一些问题。

希望这会对某人有所帮助，例如[这个问题](https://stackoverflow.com/questions/14960268/await-with-httpclient-getasyncurl-and-getting-error-system-nullreferenceexcept)

# php - mysqli 使用 p: connect 选项打开多个新进程

> ID：15396984
> 
> 赞同：1
> 
> 时间：2013-03-13T21:38:04.613
> 
> 标签：php, mysqli

这是我第一次在这里提问。我已经搜索了 Google、stackoverflow 等，以寻求解决我遇到的问题的帮助。我们目前使用 PHP 5.3.10 & MySQL 5.0.95 和 Apache 2.2.21 (CentOS)。

我们正在开始从旧的 mysql 库切换到新代码中的 mysqli，我正在负责。我试过了

*   确保在完成后明确关闭与数据库的连接
*   完成后释放结果集
*   将连接限制从 150 增加到 250

有包含文件（与会话检查等有关）使用旧式 mysql_pconnect() 来验证某些事情。这些几乎包含在我们所有的代码中。

类似于代码的东西：

```
$mysqli =  new mysqli('p:'.DBHOST, DBUSER, DBPASS, $_SESSION['dbname']);
if ($mysqli->connect_error) {
    throw new Exception($mysqli->connect_error,  $mysqli->connect_errno);
    exit;
}
// do my stuff here, a bunch of SQL queries like:
$sql = 'SELECT * FROM MyTable';
$result = $mysqli->query($sql);
if (!$result) {
    throw new SQLException($sql, $mysqli);
    exit;  
    // SQLException is an extension to mysqli_sql_exception that adds the 
    // query into the messaging internally
}
while ($result && $row = $result->fetch_assoc()) {
// do stuff here, like show it on screen, etc., all works normally
}
$result->free(); // free up the result
$mysqli->close(); // close the connection to the database 
```

释放结果并关闭连接是我在收到“连接太多”错误后所做的事情。在此之前，我每次运行程序时都会获得 3-4 个新的数据库连接。（通过 SHOW PROCESSLIST 在后端查看）

问题有所减轻（它增加了 0 到 3 个新连接，而不是每次增加 3 个新连接）。

我的一些阅读表明，如果当前线程中没有现有的空闲连接，这可能与 Apache 线程 + 添加的新持久连接有关。是这个吗？mysqli 不能很好地支持持久连接吗？（我应该放弃坚持吗？）

感谢您提出的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T04:20:27.067

我没有使用 mysqli 持久连接的经验，但是您的一些问题和期望对我来说看起来很奇怪。

> mysqli 使用 p: connect 选项打开多个新进程

是的，这就是永久连接的用途

> 确保在完成后明确关闭与数据库的连接

你不能确保你明确地关闭它，因为你不能这样做。再次因为永久连接的唯一点是持续打开

> 每次运行我的程序时，我都会获得 3-4 个新的数据库连接。

所以，你必须确保你只打开一个。

*   您的脚本至少有两个连接 - 一个旧样式和一些来自 mysqli？
*   实例化了多少个 mysqli 对象？
*   运行多少个 php 脚本来服务一个 HTTP 请求？你确定吗？

毕竟，如果它让你如此困扰，你为什么要使用持久连接？你有什么真正的（不是想象的）好处吗？毕竟，如果你的版本是 5.3，为什么还要从 mysql 重写呢？

# php - PHP 对象属性在实例化后为空

> ID：15396985
> 
> 赞同：1
> 
> 时间：2013-03-13T21:38:05.067
> 
> 标签：php, web-applications, session-variables

这就是让我的大脑受伤的原因。首先，我知道足够的 php 在大约 5 分钟内解释它。然而，我相当精通面向对象的编程。情况：

我正在尝试构建一个 php 应用程序以用作仅限 Intranet 的工具。我的想法是将当前用户保存在会话中。我为我的数据库用户表创建了一个 PHP 模型。在代码中，我正在对用户进行身份验证，如果用户进行了身份验证，那么我将创建一个 User 对象并将其保存在会话中。问题是创建了 User 对象，但所有属性都为空。我在这里和 php net 上研究了一些答案，并尝试了几件事，但问题仍然存在。我不认为它与 php 相关，我绝对认为这是我做错了，但就是不能指望它。这是登录脚本中的相关代码示例。要到达这里，密码必须验证，变量`$users`是从我的数据库控制器中的函数的直接返回。由于变量包含在`var_dump`返回该变量的代码中，因此可能不需要。我尝试将相关的数组元素分别传递给构造函数，我尝试传递完整的数组，我使用了`serialize`and `unserialize`。我尝试使用`$this->property = $someValue`.

```
if ($hash) {
    $current_user = new User($users);
    $_SESSION['current_user'] = serialize($current_user); 
    $current_user = unserialize($_SESSION['current_user']);
    var_dump(session_id());
    var_dump($users);
    var_dump($current_user);
    var_dump($_SESSION['current_user']);
} 
```

这是我的构造函数：

```
class User {
public $userid;
public $fname;
public $lname;
public $email;
public $username;
public $function;
public $d_joined;
public $is_internal;
public $is_active;

function __costruct() {
    $arguments = func_get_args();
    if (!empty($arguments)) {
        foreach ($arguments[0] as $key => $property) {
            if ($property_exists($this, $key)) {
                $this -> {$key} = $property;
            }
        }
    } 
} 
```

我已经尝试过*，*但一无所获。这是调用的输出`_*construct($args)*```_construct(array($args))``var_dump()``

 ````
string 'cgotecrpu7soqvepoimjo2s116' (length=26)

array (size=1)
0 => 
array (size=20)
  'userid' => string '1' (length=1)
  0 => string '1' (length=1)
  'fname' => string 'First Name' (length=4)
  1 => string 'First Name' (length=4)
  'lname' => string 'Last Name' (length=8)
  2 => string 'Last Name' (length=8)
  'email' => string 'email address' (length=21)
  3 => string 'email address' (length=21)
  'username' => string 'username' (length=9)
  4 => string 'username' (length=9)
  'password' => string 'hashed password:salt' (length=65)
  5 => string 'hashed password:salt' (length=65)
  'function' => string '4' (length=1)
  6 => string '4' (length=1)
  'd_joined' => string '2013-01-14' (length=10)
  7 => string '2013-01-14' (length=10)
  'is_internal' => string '1' (length=1)
  8 => string '1' (length=1)
  'is_active' => string '1' (length=1)
  9 => string '1' (length=1)

object(User)[2]
public 'userid' => null
public 'fname' => null
public 'lname' => null
public 'email' => null
public 'username' => null
public 'function' => null
public 'd_joined' => null
public 'is_internal' => null
public 'is_active' => null

string 'O:4:"User":9{
s:6:"userid";N;
s:5:"fname";N;
s:5:"lname";N;
s:5:"email";N;
s:8:"username";N;
s:8:"function";N;
s:8:"d_joined";N;
s:11:"is_internal";N;
s:9:"is_active";N;}' (length=162) 
```

因此，据我所知，初始数组`$users`具有正确的数据。该`User`对象是在变量中创建的`$current_user`。但是，当我尝试访问对象属性时，我收到有关从非对象访问对象属性的错误。看起来会话变量不是一个对象，但它`$current_user`是，即使它具有空属性。有人可以指出我正确的方向吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T21:53:06.817

你的构造函数看起来不对你想做的事情，我认为你应该这样做：

```
 /**
 * Constructor set each public values with the ones passed from the passed array
 * @param array $userDatas Array containing the user datas
 */
function __construct($userDatas) {
    foreach($userDatas as $key => $value) {
        if (property_exists($this, $key)) {
            $this->$key = $value;
        }

    }
} 
````

# .htaccess - 将非 www 重定向到子目录中的 www

> ID：15396988
> 
> 赞同：0
> 
> 时间：2013-03-13T21:38:06.970
> 
> 标签：.htaccess, mod-rewrite

[我在http://www.mysite.com/test/](http://www.mysite.com/test/)中有一个 .htaccess 文件，我试图用它来将访问[http://mysite.com/test/](http://mysite.com/test/)的任何人发送到[http://www.mysite.com /test/](http://www.mysite.com/test/)但它不起作用，这是我的代码：

```
# Force Caching
Header unset Pragma
FileETag None
Header unset ETag
<FilesMatch "\.(ico|jpg|jpeg|png|gif|js|css|swf|pdf|flv|mp3)$">
<IfModule mod_expires.c>
 ExpiresActive on
 ExpiresDefault "access plus 14 days"
 Header set Cache-Control "public"
</IfModule>
</FilesMatch>
<FilesMatch "\.(html|htm|xml|txt|xsl)$">
 Header set Cache-Control "max-age=7200, must-revalidate"
</FilesMatch>

# Enable gzip compression
<IfModule mod_mime.c>
 AddType application/x-javascript .js
 AddType text/css .css
</IfModule>
<IfModule mod_deflate.c>
 AddOutputFilterByType DEFLATE text/css application/x-javascript text/x-component text/html text/richtext image/svg+xml text/plain text/xsd text/xsl text/xml image/x-icon application/javascript
 <IfModule mod_setenvif.c>
  BrowserMatch ^Mozilla/4 gzip-only-text/html
  BrowserMatch ^Mozilla/4\.0[678] no-gzip
  BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
 </IfModule>
 <IfModule mod_headers.c>
  Header append Vary User-Agent env=!dont-vary
 </IfModule>
</IfModule>

# Main Rewrite rules
<IfModule mod_rewrite.c>
    Options +FollowSymlinks
    RewriteEngine On
    RewriteBase /

    # Always use www.
    RewriteCond %{HTTP_HOST} !^www [NC]
    RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [L,R]

    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.php [L]
</IfModule> 
```

有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T22:45:24.977

.htaccess 文件位于`/test`目录中。这就是在' 请求 URL 模式`/test/`中删除前缀的原因。要正确重定向请求，您必须将替换更改为`RewriteRule``.*`

```
RewriteRule ^ http://www.%{HTTP_HOST}%{REQUEST_URI} [L,R] 
```

# macos - 使用并存的旧版和现代 Mac 应用程序，无法将捆绑的文档全局关联到现代应用程序（启动服务？）

> ID：15396989
> 
> 赞同：3
> 
> 时间：2013-03-13T21:38:07.990
> 
> 标签：macos, cocoa, plist, uti, launch-services

2013 年 4 月 9 日更新 这是对我之前问题的完全转发。随着我对启动服务、UTI 和贬值的创建者代码了解得更多，我觉得我最好从头开始问这个问题。

问题描述：

我们有一个专为 Legacy Mac 9.xx 设计的应用程序，它仍然在 Snow Leopard（带有 Rosetta）上运行。该应用程序使用捆绑文件我们为 Snow Leopard 及其他应用程序开发了我们的新应用程序。问题是启动服务没有根据我们当前使用的 plist 配置正确关联新应用程序，我需要知道我做错了什么。

如果我右键单击捆绑的文档并选择 GetInfo，我可以将捆绑的文件关联到旧应用程序或新应用程序，它会按我的预期工作。我相信那是因为雪豹仍然使用 Creator Code 技术进行这种关联。如果我告诉文件将自身与旧的旧应用程序关联并按“全部更改”，则启动服务将正确关联该类型的所有文件，并且它将按预期工作。如果我告诉文件将自己关联到新应用程序并选择“全部更改”，应用程序将打开，但文件不会。据我所知，启动服务正在为应用程序分配一个动态 UTI，当单击文件时，操作系统不知道要使用哪个应用程序。

我发现一些帖子似乎暗示苹果可能在新的 UTI 方法中犯了一些设计错误。这里的一篇文章展示了如何将一组字符串文件扩展名添加到新应用 pList 的 ExportedUTI 字典中。这会使应用程序正常运行，但这并不能解决问题；如果我们允许我们的用户为他们的文件命名，我们无法在数组中预测他们的文件扩展名将是什么。我们需要启动服务以严格使用 UTI 代码正确运行，或者如何让 OSType 代码正常工作。

[关于尿路感染的帖子](http://grenzgenial.com/post/30754690551/quicklook-mac-osx-uti-hell-or-what-apple-did-omit-in%22link%22)

一旦新应用程序决定它无法打开它的相关文件，我必须打开 LanchServices.plist，删除条目并重新启动 lsregister 数据库。然后我可以再次使用新应用程序打开一个文件（通过关联它而不按“全部更改”）。

我将一些图像附加到应用 plists 、捆绑的文档 plist 和 Launch Services 条目：

![旧应用程序列表](../Images/c602860a81f0c284ce7e93f727ede5de.png)

![新应用列表](../Images/c0addaf9b955dfc1ee5c7e04dcf5a021.png)

![捆绑文档中的 plist](../Images/f0fbc2e5cc33200afb339b75e5fab515.png)

![新应用程序的启动服务条目](../Images/aed2f709349b0bca701db143b2fa61db.png)

非常感谢任何帮助和我们的指导。

麦克风

更新日期：2013 年 4 月 16 日

我提供的关于 UTI 的帖子的链接还包括一个名为 RCDefault 应用程序的开源软件应用程序的链接。此应用程序将根据您选择的 UTI、文件扩展名、OSType 代码和文件类型将您的 APP 与给定文件相关联。奇怪的是，这个应用程序能够根据我们 plist 中提供的 UTI 结构将文件与应用程序相关联。

对于这种特定情况，这是否可能只是雪豹启动服务中的一个错误，而苹果此时选择忽略它（考虑到他们不再支持雪）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:50:13.543

您缺少 CFBundleTypeExtensions。创建一个数组类型的 CFBundleTypeExtensions，第 0 项应该是您的文件扩展名。

您还缺少 CFBundleTypeName，这是文件将使用的别名类型。让它漂亮漂亮。:)

参考（CFBundleDocumentTypes）：[https ://developer.apple.com/library/mac/#documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html](https://developer.apple.com/library/mac/#documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-17T21:13:42.773

自从我最初发布此内容以来已经有一段时间了，但为了以防其他人对此感兴趣，我已经做出了一些额外的发现：

这个问题与尝试与旧版应用程序和 OSX 应用程序兼容没有太大关系。捆绑的文件包含一个创建者代码和一个 OSType 代码。只要这两个项目存在于遗留应用程序 plist 中，它就会在被要求时，全局或单独打开。

问题似乎是试图将 ostype 代码包含在较新的应用程序 plist 中，作为导出类型 UTI 下的等效类型。

唯一可行的解​​决方案是将文件扩展名数组添加为与@Derek 开头提到的等效类型。

这是解决此问题的唯一解决方案。具有讽刺意味的是，这违反了苹果的人机界面指南，该指南在某种程度上规定了用户不应被迫接受文件扩展名限制。

似乎 UTI 仅适用于非捆绑文档（文件），这也得到了一些帖子的支持，基本上说苹果真的搞砸了。如果最终您仍然需要扩展数组，那么担心 UTI 有什么意义？

# entity-framework - EF 代码优先 - 无法检查模型兼容性，因为数据库不包含模型元数据

> ID：15396992
> 
> 赞同：5
> 
> 时间：2013-03-13T21:38:14.543
> 
> 标签：entity-framework, migration

我已启用自动迁移。然后，我删除了我的整个数据库。接下来，我`Update-database`从命令控制台执行，它重新创建了我的数据库。然后，我启动我的应用程序只是为了看到这个错误：

> 无法检查模型兼容性，因为数据库不包含模型元数据。只能检查使用 Code First 或 Code First 迁移创建的数据库的模型兼容性。

那么元数据到底是什么，我如何将实体框架指向它呢？

PS。我的数据库包含名为`MigrationsHistory`.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T22:22:06.907

这是我不久前写的解决此问题的可能方法的详细描述...
（不完全是您所经历的，因此本身不是重复的，但考虑到了不同的场景）

[https://stackoverflow.com/a/10255051/417747](https://stackoverflow.com/a/10255051/417747)

总结...

> 对我有用的是使用 Update-Database -Script
> 
> 这将创建一个具有“迁移差异”的脚本，您可以将其作为 SQL 脚本手动应用到目标服务器数据库上（并且您应该插入正确的迁移表行等）。
> 
> 如果这仍然不起作用 - 你仍然可以做两件事......
> 
> a）删除迁移表（目标 - 在系统表下） - 根据 [http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-automatic-migrations-walkthrough。那里的aspx](http://blogs.msdn.com/b/adonet/archive/2012/02/09/ef-4-3-automatic-migrations-walkthrough.aspx) 评论 - 这应该会回到以前的行为，如果你确定你的 Db-s 是相同的 - 它只会“相信你”，
> 
> b）作为我使用的最后手段 - 制作完整模式的更新数据库 - 脚本（例如，通过初始化一个应该强制执行“完整脚本”的空数据库），找到 INSERT INTO [__MigrationHistory] ​​记录，只需运行这些，将它们插入数据库，并确保您的数据库 - 和代码匹配，
> 
> 这应该使事情再次同步运行。

如果有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-13T10:53:02.977

从 Visual Studio 的“服务器资源管理器”中分离您的本地数据库，例如“database1.mdf”，然后打开 SQL Server Management Studio 右键单击​​“数据库”>“附加”，然后浏览相同的“database1.mdf”文件。如果您没有访问权限然后将 mdf 和 ldf 文件复制并粘贴到 C 盘并附加。

然后在 sql server 上打开新的查询窗口，然后复制您的身份表，如下所示。

*'select * into [__MigrationHistory] ​​from Database1.dbo.__MigrationHistory '*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-25T10:12:22.623

1.  包管理器控制台 > *Enable-Migrations -EnableAutomaticMigrations*
2.  配置迁移/Configuration.cs
3.  包管理器控制台 >*更新数据库*

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-13T22:15:06.857

将此添加到您的上下文中：

```
protected override void OnModelCreating(ModelBuilder modelBuilder) 
{
    modelBuilder.Conventions.Remove<IncludeMetadataConvention>();
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-24T11:51:12.967

我使用实体框架 6、SQL 2008 R2、VS 2013。
要解决此问题，请仅使用以下过程：

1）删除现有数据库（使用EF模型{code first}创建的现有数据库）
2）再次运行APP。

例如查询代码（在布局中）：
如果我的模型更改并在用户表中搜索用户名，则此代码创建数据库。

```
<body>
    @{
        // Delete && Create ...
        Database.SetInitializer(new DropCreateDatabaseIfModelChanges<DBContext>());

        var db = new DBContext();
        var SearchingUser = db.Users.Where(c => c.UserName == "qwertyui");
        if (SearchingUser.Count() == 0) {
            var User = new Users { UserName = "qwertyui",Password = "12345678" };
            db.Users.Add(User);
            db.SaveChanges();
        }

    }

    @RenderSection("scripts", required: false)
    @RenderBody()
</body> 
```