# StackOverflow 问答 15549000-15549999

# regex - VB中需要正则表达式模式

> ID：15549000
> 
> 赞同：-5
> 
> 时间：2013-03-21T13:31:14.597
> 
> 标签：regex, vb.net, qtp

**我对此很陌生，VB 中 10:26 AM**的正则表达式模式是什么，不是最新的，需要固定时间的模式。请帮助解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T13:41:59.933

所有字符串*也是*有效的正则表达式（一旦您转义了在您使用的正则表达式方言中具有特殊含义的任何字符）。因此，如果您想使用正则表达式搜索固定字符串，只需使用该固定字符串即可。

特别是，您的固定时间输入不包含任何特殊字符，因此我们甚至不需要对其进行转义：

```
"10: 26 AM" 
```

说真的，就是这样。这是一个与您的字符串完全匹配的有效正则表达式，仅此而已。*但是*，如果您只是要匹配一个固定的字符串，则根本不需要使用正则表达式，并且使用普通的字符串搜索可能会稍微快一些（但不一定是这种情况！）。[VBScript 有这样的`InStr`功能](http://msdn.microsoft.com/en-us/library/wybb344c%28v=vs.84%29.aspx)：

```
str = "I came home at 10: 26 AM and made lunch."
position = InStr("10: 26 AM", str) 
```

也许您想忽略输入中的空格（或允许它们出现在任意位置）。在这种情况下，您可以`\s*`在相关位置插入 - 这将匹配该位置的任意数量的空格（零个或多个）。您修改后的表达式如下所示：

```
"10\s*:\s*26\s*AM" 
```

最后，也许您想确保文本不包含*任何其他内容*，而*只包含 time*。在这种情况下，您可以使用 begin ( `^`) 和 end ( `$`) 锚来确保仅在字符串周围没有其他文本时才匹配该字符串：

```
"^\s*10\s*:\s*26\s*AM\s*$" 
```

（但我们再次允许文本前后有空格。如果不允许，您可能需要删除它。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T13:34:57.827

要匹配给定的时间格式（上午 10:26），您可以使用：

```
(0?[1-9]|1[012])(: [0-5]\d) (AM|PM) 
```

仅供参考，它在冒号后有空格......

# opencv - 在opencv中使用flann进行层次聚类

> ID：15549001
> 
> 赞同：2
> 
> 时间：2013-03-21T13:31:15.467
> 
> 标签：opencv, hierarchical-clustering

我正在尝试使用 opencv 2.4.2 中的分层聚类方法。

它可以正常工作，但问题是，我不了解它接受的参数，例如。分枝...

而且我认为我的问题是我总是只有一个集群。

我的输入是一个 cv::Mat LBPH 特征（用于人脸检测），行数为 12，列数为 6272。无论分支因子的值是多少，我总是只得到一个簇，它的质心是行数的平均值来自输入矩阵 grouppeed_one_ferson_features。你能建议吗？？？

非常感谢！！！

继承人的代码：

```
cv::Mat groupped_one_person_features;  
.... // fill grouppeed_one_ferson_features with data 
int  Nclusters=50;
cv::Mat centroids (Nclusters,Features.data[0][0].cols,CV_32FC1);
int count = cv::flann::hierarchicalClustering<cvflann::L1<float>>groupped_one_person_features,centroids,cvflann::KMeansIndexParams(2000,11,cvflann::FLANN_CENTERS_KMEANSPP)); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T12:49:03.337

首先，您在最后一行遗漏了一个括号：

```
int count = cv::flann::hierarchicalClustering<cvflann::L1<float>>(groupped_one_person_features,centroids,cvflann::KMeansIndexParams(2000,11,cvflann::FLANN_CENTERS_KMEANSPP)); 
```

按顺序，参数为（根据`flann_base.hpp`）：

*   要聚类的点
*   计算出的聚类中心。矩阵应该是预先分配的，centers.rows 是请求的簇数。
*   聚类参数
*   用于聚类的距离

因此，如果你总是得到一个簇，这可能意味着你的`centroids`矩阵只有一行。你能证实这一点吗？

的参数为`KMeansIndexParams`（根据`kmeans_index.h`）：

*   分支因子：树中节点的子节点数
*   迭代次数：在一个 kmeans 聚类（kmeans 树）中执行的最大迭代次数
*   center_init：用于为 kmeans 树挑选初始聚类中心的算法
*   cb_index：簇边界索引。在搜索 kmeans 树时使用

# ssl - 为什么在同一会话中进行 SSL 握手后需要 SSL 证书？

> ID：15549003
> 
> 赞同：1
> 
> 时间：2013-03-21T13:31:18.060
> 
> 标签：ssl, https, browser, security, sslhandshakeexception

我的问题完全基于 Https 连接。
场景如下：
假设我连接到[https://www.example.com](https://www.example.com)并且在接受 SSL 证书后，我登录到同一个站点并且会话被建立。然后我从浏览器中删除证书并尝试进一步浏览同一站点，然后我的浏览器要求接受同一站点的证书。为什么这样？

据我所知，在 SSL 握手之后，当生成密钥时，该密钥用于该会话的所有加密。我认为与服务器建立会话后不需要证书。那么为什么我的浏览器在已建立的会话之间要求证书。

# javascript - 如何根据我在 extjs 中选择的文件设置窗口的标题

> ID：15549005
> 
> 赞同：3
> 
> 时间：2013-03-21T13:31:20.460
> 
> 标签：javascript, extjs4

我有一个包含文件名的滚动菜单。当我单击菜单中的文件名时，我想创建一个以文件名作为标题的窗口。

在下面的代码中，我可以创建窗口但没有标题。

问题出在一行（title: jsonobj[ii], // I got undefined here）。

```
var scrollMenu = Ext.create('Ext.menu.Menu');
var files = Ext.Ajax.request({
  url: 'php/getfiles.php',
  success: function(response, opts) {
    var jsonobj = Ext.decode(response.responseText);
    for(var ii = 0; ii < jsonobj.length; ii++){
      scrollMenu.add({
        text: jsonobj[ii], // working good
        handler: function () {
          var winfile = Ext.create('widget.window', {
            region: 'center',
            height: 500,
            width: 900,
            x: 500,
            y: 100,
            title: jsonobj[ii], // not working
            closable: true,
            plain: true,
            layout: 'fit',
            preventBodyReset: true,
          });
          winfile.show();
        }
      });
    }
  },
  failure: function(response, opts) {
    console.log('somthing went wrong with this AJAX call' + response.status);
  }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:00:22.053

问题是所有`handler`回调都定义在同一个闭包中。这意味着一旦`ii`在回调范围内发生更改`success`- 它会自动影响所有`handler`回调。因为`jsonobj[jsonobj.length] === undefined`你总是得到未定义的标题。你应该`handler`用一些其他的闭包来包装，如下所示：

```
handler: (function(){
    var title = jsonobj[ii];
    return function () {
        var winfile = Ext.create('widget.window', {
            region: 'center',
            height: 500,
            width: 900,
            x: 500,
            y: 100,
            title: title,
            closable: true,
            plain: true,
            layout: 'fit',
            preventBodyReset: true
        });
        winfile.show();
    }
}()) 
```

# grails - 从 Grails 插件获取 HTTP 响应大小

> ID：15549006
> 
> 赞同：4
> 
> 时间：2013-03-21T13:31:21.597
> 
> 标签：grails, servlet-filters

我正在尝试编写一个 Grails 插件，该插件记录安装它的应用程序发送的每个 HTTP 响应的大小。到目前为止我尝试过的方法是：

(1) 编写一个 servlet 过滤器，将`response`. 响应包装器用计算响应中字节数的`OutputStream`an来装饰。`OutputStream`这些类显示[在这里](https://stackoverflow.com/a/3221516/2648)。

(2)在插件描述符中注册servlet过滤器

```
def doWithWebDescriptor = { webXml ->

    def contextParam = webXml.'context-param'

    contextParam[contextParam.size() - 1] + {
        'filter' {
            'filter-name'('countingFilter')
            'filter-class'(CountingFilter.name)
        }
    }

    def filter = webXml.'filter'
    filter[filter.size() - 1] + {
        'filter-mapping' {
            'filter-name'('countingFilter')
            'url-pattern'('/*')
        }
    }
} 
```

(3) 在 Grails 过滤器中，尝试检索写入的字节数，如下所示：

```
afterView = {
    // countingFilter registers the response wrapper as an attribute of the request
    // named 'counter'
    request.getAttribute('counter').byteCount
} 
```

但总是返回 0 值。但是，我发现如果我将上面的代码添加到 Grails 过滤器的`after`和`afterView`闭包中

```
after = {
    // returns 0
    request.getAttribute('counter').byteCount
}

afterView = {
    // returns the correct response size
    request.getAttribute('counter').byteCount
} 
```

它现在返回正确的响应大小，但似乎站点网格布局生成的内容已经消失，只剩下 GSP 本身中的内容。

所以看来我接近解决方案了。我的猜测是我在错误的时间刷新缓冲区，和/或我的过滤器没有在过滤器链中的正确点运行。

事实证明，这比我预期的要困难得多。有没有更简单的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T14:58:05.317

Grails 内置了这个特性。它没有被记录。通过将“-DGSPResponseWriter.enableContentLength=true”选项添加到 JVM 参数，将系统属性“GSPResponseWriter.enableContentLength”设置为 true。有关详细信息，请参阅[GSPResponseWriter 的源代码。](https://github.com/grails/grails-core/blob/2.2.x/grails-web/src/main/groovy/org/codehaus/groovy/grails/web/pages/GSPResponseWriter.java#L57)

默认情况下未启用此功能的原因是计算内容长度并不简单，因为某些字符在 UTF-8 编码中是多字节的。[BoundedCharsAsEncodedBytesCounter](https://github.com/grails/grails-core/blob/2.2.x/grails-web/src/main/groovy/org/codehaus/groovy/grails/web/util/BoundedCharsAsEncodedBytesCounter.java)是进行计算的类。

# floating-point - CGImage 浮点格式需要字节交换？

> ID：15549007
> 
> 赞同：0
> 
> 时间：2013-03-21T13:31:22.350
> 
> 标签：floating-point, pixel, cgimage, endianness

我正在做一些需要浮点灰度图像数据的图像处理工作。下面的方法`-imagePlanarFData:`目前是我如何从输入中提取这些数据`CIImage`：

```
- (NSData *)byteswapPlanarFData:(NSData *)data
                    swapInPlace:(BOOL)swapInPlace;
{
    NSData * outputData = swapInPlace ? data : [data mutableCopy];
    const int32_t * image = [outputData bytes];
    size_t length = [outputData length] / sizeof(*image);
    for (int i = 0;
         i < length;
         i++) {
        int32_t * val = (int32_t *)&image[i];
        *val = OSSwapBigToHostInt32(*val);
    }
    return outputData;
}

- (NSData *)imagePlanarFData:(CIImage *)processedImage;
{
    NSSize size = [processedImage extent].size;
    if (size.width == 0) {
        return nil;
    }
    dispatch_once(&_onceToken, ^ {
        _colorSpace = CGColorSpaceCreateWithName(kCGColorSpaceGenericGray);
        _bytesPerRow = size.width * sizeof(float);
        _cgx = CGBitmapContextCreate(NULL, size.width, size.height, 32, _bytesPerRow, _colorSpace, kCGImageAlphaNone | kCGBitmapFloatComponents);
        // Work-around for CIImage drawing EXC_BAD_ACCESS when running with Guard Malloc;
        // see <http://stackoverflow.com/questions/11689233/ciimage-drawing-exc-bad-access>
        NSDictionary * options = nil;
        if (getenv("MallocStackLogging") || getenv("MallocStackLoggingNoCompact")) {
            NSLog(@"Forcing CIImageContext to use software rendering; see %@",
                  @"<http://stackoverflow.com/questions/11689233/ciimage-drawing-exc-bad-access>");
            options = @{ kCIContextUseSoftwareRenderer: @YES };
        }
        _cix = [CIContext contextWithCGContext:_cgx
                                       options:options];
        _rect = CGRectMake(0, 0, size.width, size.height);
    });
    float * data = CGBitmapContextGetData(_cgx);
    CGContextClearRect(_cgx, _rect);
    [_cix drawImage:processedImage
             inRect:_rect
           fromRect:_rect];
    NSData * pixelData = [NSData dataWithBytesNoCopy:data
                                              length:_bytesPerRow * size.height
                                        freeWhenDone:NO];
    // For whatever bizarre reason, CoreGraphics uses big-endian floats (!)
    return [self byteswapPlanarFData:pixelData swapInPlace:NO];
} 
```

正如评论中提到的，我很惊讶地看到浮点像素数据以大端顺序从 CGBitmapContext 中出来。（我只是通过反复试验确定了这一点。）因此`-byteswapPlanarFData:swapInPlace:`，引入了额外的方法，世界似乎一切都很好......有一段时间。

但*现在*我想将这些处理后的数据渲染*回*`CGImage`.

以前我的代码采用`float * data`上面提取的缓冲区并直接使用它来呈现一个新的`CGImage`，然后将其包装在一个 中`NSImage`，如下所示：

```
CGDataProviderRef provider = CGDataProviderCreateWithData(NULL, data, bytesPerRow * size.height, NULL);
CGImageRef renderedImage = CGImageCreate(size.width, size.height, 32, 32, bytesPerRow, colorSpace, kCGImageAlphaNone | kCGBitmapFloatComponents, provider, NULL, false, kCGRenderingIntentDefault);
CGDataProviderRelease(provider);
NSImage * image = [[NSImage alloc] initWithCGImage:renderedImage
                                              size:size];
CGImageRelease(renderedImage); 
```

所以*现在*我正在这样做：

```
pixelData = [mumble imagePlanarFData:processedImage];
// Swap data back to how it was before...
pixelData = [mumble byteswapPlanarFData:pixelData
                            swapInPlace:YES];
float * data = (float *)[pixelData bytes];
CGDataProviderRef provider = CGDataProviderCreateWithData(NULL, data, bytesPerRow * size.height, NULL);
CGImageRef renderedImage = CGImageCreate(size.width, size.height, 32, 32, bytesPerRow, colorSpace, kCGImageAlphaNone | kCGBitmapFloatComponents, provider, NULL, false, kCGRenderingIntentDefault);
CGDataProviderRelease(provider);
NSImage * image = [[NSImage alloc] initWithCGImage:renderedImage
                                              size:size];
CGImageRelease(renderedImage); 
```

以上*不起作用*。相反，我从 CoreGraphics 收到损坏的图像和一连串的投诉：

```
Mar 21 05:56:46 aoide.local LabCam[34235] <Error>: CMMConvLut::ConvertFloat 1 input (inf)
Mar 21 05:56:46 aoide.local LabCam[34235] <Error>: ApplySequenceToBitmap failed (-171)
Mar 21 05:56:46 aoide.local LabCam[34235] <Error>: ColorSyncTransformConvert - failed width = 160 height = 199 dstDepth = 7 dstLayout = 0 dstBytesPerRow = 1920 srcDepth = 7 srcLayout = 0 srcBytesPerRow = 640 
```

我哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:20:33.907

啊，发现问题了...原来在我添加字节交换调用之前有一个剩余的例程，`-imagePlanarFData:`它*也在*就地交换字节...

我*仍然*想听听一些解释，为什么 CoreGraphics 在我们的 little-endian 平台上期望这些值以 big-endian 字节顺序排列。

# python - Python Minidom XML解析虚线四边形/嵌套子级

> ID：15549008
> 
> 赞同：0
> 
> 时间：2013-03-21T13:31:26.703
> 
> 标签：python, xml, linux

我有一个需要解析的不同对象的巨大列表，并且有多个问题：

1.  我可以很容易地解析 XML 中的字符串值（主机名、颜色、类名等），但是本质上的任何数字（IP 地址/子网掩码等）我都做得不正确。如何让它显示正确的虚线四边形？

2.  从更深层次的孩子身上提取信息的正确方法是什么（使用 minidom）？（请参阅组对象 - 参考下需要“名称”）

3.  当字段不包含值（例如网络掩码）时，如何清理（删除）错误的 []。

XML 看起来像两个输出之一（已清理）：

a) 主机对象：

```
<network_object>
<Name>DB1</Name>
<Class_Name>host_plain</Class_Name>
<color><![CDATA[black]]></color>
<ipaddr><![CDATA[192.168.100.100]]></ipaddr> 
```

b) 组对象（包含多个成员）：

```
 <network_object>
<Name>DB_Servers</Name>
<Class_Name>network_object_group</Class_Name>
<members>
  <reference>
    <Name>DB1</Name>
    <Table>network_objects</Table>
  </reference>
  <reference>
    <Name>DB2</Name>
    <Table>network_objects</Table>
  </reference>
</members>
<color><![CDATA[black]]></color> 
```

对于主机对象，我的代码的当前输出如下所示：

```
DB1 host_plain black [<DOM Element: ipaddr at 0x2d05a50>] [] 
```

对于网络对象：

```
Net_192.168.100.0 network black [<DOM Element: ipaddr at 0x399add0>] [<DOM Element: netmask at 0x399af10>] 
```

对于组对象：

```
DB_Servers network_object_group black [] [] 
```

我的代码：

```
from xml.dom import minidom

net_xml = minidom.parse("network_objects.xml")

NetworkObjectsTag = net_xml.getElementsByTagName("network_objects")[0]

# Pull individual network objects
NetworkObjectTag = NetworkObjectsTag.getElementsByTagName("network_object")

for network_object in NetworkObjectTag:
    name = network_object.getElementsByTagName("Name")[0].firstChild.data
    class_name = network_object.getElementsByTagName("Class_Name")[0].firstChild.data
    color = network_object.getElementsByTagName("color")[0].firstChild.data
    ipaddr = network_object.getElementsByTagName("ipaddr")
    netmask = network_object.getElementsByTagName("netmask")
    print(name,class_name,color,ipaddr,netmask) 
```

编辑：我已经能够获得一些输出来解决＃1，但是似乎我已经达到了我不知道的限制。

新代码：

```
ipElement = network_object.getElementsByTagName("ipaddr")
ipaddr = ipElement.firstChild.data
maskElement = network_object.getElementsByTagName("netmask")
netmask = maskElement.firstChild.data 
```

给我我正在寻找的输出，但它似乎在 6-9 个条目后停止，并指出“builtins.IndexError：列表索引超出范围”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T12:25:56.603

除了如何正确处理 network_group_object 之外，我已经能够回答我所有的问题。我会专门为此发另一篇文章。

这是我的新代码：

```
from xml.dom import minidom

net_xml = minidom.parse("network_objects.xml")

NetworkObjectsTag = net_xml.getElementsByTagName("network_objects")[0]

# Pull individual network objects
NetworkObjectTag = NetworkObjectsTag.getElementsByTagName("network_object")

for network_object in NetworkObjectTag:
name = network_object.getElementsByTagName("Name")[0].firstChild.data
class_name = network_object.getElementsByTagName("Class_Name")[0].firstChild.data
color = network_object.getElementsByTagName("color")[0].firstChild.data
ipElement = network_object.getElementsByTagName("ipaddr")
if ipElement:    
    ipElement = network_object.getElementsByTagName("ipaddr")[0]
    ipaddr = ipElement.firstChild.data
maskElement = network_object.getElementsByTagName("netmask")
if maskElement:
    maskElement = network_object.getElementsByTagName("netmask")[0]
    netmask = maskElement.firstChild.data
#address_ranges
ipaddr_firstElement = network_object.getElementsByTagName("ipaddr_first")
if ipaddr_firstElement:
    ipaddr_firstElement = network_object.getElementsByTagName("ipaddr_first")[0]
    ipaddr_first = ipaddr_firstElement.firstChild.data
ipaddr_lastElement = network_object.getElementsByTagName("ipaddr_last")
if ipaddr_lastElement:
    ipaddr_lastElement = network_object.getElementsByTagName("ipaddr_last")[0]
    ipaddr_last = ipaddr_lastElement.firstChild.data    
if ipaddr_firstElement:
    print(name,class_name,ipaddr,netmask,ipaddr_first,ipaddr_last,color)
else:
        print(name,class_name,ipaddr,netmask,color) 
```

# c++ - 在单线程或单独线程中接收/发送？

> ID：15549010
> 
> 赞同：4
> 
> 时间：2013-03-21T13:31:29.447
> 
> 标签：c++, tcp, zeromq

我正在讨论客户端应用程序中的多线程，并被告知使用单独的线程接收数据并使用另一个线程发送数据不是要走的路。

为什么？

据我所知，TCP 是全双工的，所以这是否会提高性能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T17:17:17.967

有一个专用的发送线程和一个专用的接收线程是不好的，原因有两个。

首先，这意味着每次从接收到发送都需要进行上下文切换，除非您同时进行这两项操作。

其次，这意味着在您接收查询、制定响应然后发送该响应的典型路径中，数据将需要从一个线程传递到另一个线程，从而耗尽缓存。

也就是说，如果性能不是超级关键并且它很适合您的设计，那么它肯定会起作用。只是通常没有优势。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T13:36:43.683

我想这取决于您的应用程序的规模。如果你正在为一个班级项目做一个小应用程序，在同一个线程上发送和接收可能就足够了。然后您不必担心线程问题。

但是，我开发的应用程序必须侦听数千个传入连接，并且每个连接都可能发送大量数据。我们有一个线程，其唯一目的是侦听套接字连接并将新连接放入池中，以及可变数量的线程（取决于应用程序的繁忙程度）仅用于读取套接字，以及不同的线程池用于写作。

问题是，如果您的侦听套接字没有足够快地从线路中读取数据并且缓冲区已填满，则会返回错误，并且在数千个客户端的情况下，会导致大量重新连接和重新- 发送数据，这加剧了数据读取速度不够快的问题。

所以回到我一开始所说的——这取决于你的应用程序的规模，但为什么不现在添加能力呢？只要确保你是线程安全的，你应该没问题。

# c# - 项目参考解决方法 .net 4.5 和 .net 3.5

> ID：15549011
> 
> 赞同：3
> 
> 时间：2013-03-21T13:31:31.303
> 
> 标签：c#, .net, assemblies, clr

在此线程中继续：
[在同一解决方案/项目中混合 .NET 3.5 与 4/4.5 程序集](https://stackoverflow.com/questions/15463163/mixing-net-3-5-with-4-4-5-assemblies-in-the-same-solution-project)

我找到了一种解决方法：
[http ://social.msdn.microsoft.com/Forums/en-US/clr/thread/36b1a209-55d5-4323-91dc-0919ba2e1d03/](http://social.msdn.microsoft.com/Forums/en-US/clr/thread/36b1a209-55d5-4323-91dc-0919ba2e1d03/)

它基本上做什么，让我的解决方案编译并确定每个项目在哪个 CLR 下运行。
有没有人看到这个缺点？
它在我必须在.net 3.5 上运行的第 3 方 api 上构建项目，我明确写在其 App.config 上以使用 CLR 2.0 而不是 4.0 运行

```
 <startup>
 <supportedRuntime version="v2.0.50727"/>
 <!--<supportedRuntime version="v4.0"/>-->
 </startup> 
```

编辑：
我的主要应用程序正在使用 .net 4.5 和 C# 5 功能。我的第 3 方 API 在子进程上运行（我从主进程开始），该进程将连接到必须在 3.5 和 CLR2 上的 API。所以我明确定义在那里运行为 CLR2..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T00:48:50.057

您的配置文件将加载 .NET 2.0 运行时，并且在加载 .NET4.5 组件时会失败。您真的希望您的应用程序在 .NET4.5 运行时中运行并能够加载 3.5 组件。您应该尝试以下配置文件。

```
<configuration>
    <startup useLegacyV2RuntimeActivationPolicy="true">
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5"/>
    </startup>
</configuration> 
```

# sharepoint - 使用 [无访问权限] 查找 SharePoint 组的 Powershell 脚本

> ID：15549014
> 
> 赞同：0
> 
> 时间：2013-03-21T13:31:42.910
> 
> 标签：sharepoint, powershell, permissions

我们公司在升级后遇到问题，其中（某些）自定义 SharePoint 组附加了 [No Access]，这会在组成员尝试访问该站点时抛出拒绝访问消息。

是否有一个 Powershell 脚本可以在我们的整个 Web 应用程序中搜索附加了 [No Access] 的自定义 SharePoint 组？

非常感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:41:38.937

抱歉，我对使用 PowerShell 进行共享点管理一无所知。公司 IT 主管不会给我访问权限。但是请查看[PoshCode](http://poshcode.org/)或[ScriptCenter 之](http://gallery.technet.microsoft.com/scriptcenter)类的脚本存储库，也可以查看其他论坛，例如[PowerShell.com](http://powershell.com/cs/forums/)

记住不要以“我需要一个脚本”开始你的问题。

# spring - 将 AS7 与 Spring 和 Log4J 一起使用，为什么我无法将 spring 跟踪输出到控制台

> ID：15549017
> 
> 赞同：0
> 
> 时间：2013-03-21T13:31:54.313
> 
> 标签：spring, spring-mvc, jboss, log4j, jboss7.x

将 AS7 与 Spring 和 Log4J 一起使用，为什么我无法将 spring 跟踪输出到控制台。

这是我的 log4f.xml

```
<?xml version="1.0" encoding="UTF-8" ?>
    <!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
    <log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/">
        <appender name="console" class="org.apache.log4j.ConsoleAppender">
            <layout class="org.apache.log4j.PatternLayout">
                <param name="ConversionPattern" value="%d [%t] %-5p %c - %m%n" />
            </layout>
        </appender>

        <appender name="dailyrollinglogfile" class="org.apache.log4j.DailyRollingFileAppender">
            <param name="file" value="./inquiry.log" />
            <param name="immediateFlush" value="true" />
            <param name="append" value="true" />
            <param name="datePattern" value="'.'yyyy-MM-dd" />
            <layout class="org.apache.log4j.PatternLayout">
                <param name="ConversionPattern" value="%d [%t] %-5p %c - %m%n" />
            </layout>
        </appender>

        <root>
            <priority value="trace"/>
            <appender-ref ref="console"/>
        </root>

    </log4j:configuration> 
```

# javascript - Bootmetro 菜单模板

> ID：15549019
> 
> 赞同：3
> 
> 时间：2013-03-21T13:31:58.687
> 
> 标签：javascript, html, css, microsoft-metro

因此，我使用 firebug 来检查应用于[Bootmetro](http://aozora.github.com/bootmetro/hub.html)下拉菜单的部分 CSS 。

您可以在此处看到`a:hover:active`负责将鼠标悬停在颜色上。在这种情况下，bootmetro 将其设置为蓝色：

![在此处输入图像描述](../Images/10c1d3287ec631e37829ca5cd5a2140f.png)

Firebug 显示负责的 css 行位于 bootstrap.css 的第 2821 行：

```
.dropdown-menu li > a:hover,
.dropdown-menu li > a:focus,
.dropdown-submenu:hover > a {
  color: #ffffff;
  text-decoration: none;
  background-color: #0081c2;
    background-repeat: repeat-x;
    background-image: linear-gradient(to bottom, #0088cc, #0077b3);
} 
```

但是，当将其更改`background-color: #0081c2`为不同的东西时，它在测试时保持不变。Firebug 显示，如果我更改背景颜色，它会使用 firebug 更改，但是当我手动将其应用于 css 文件时，它并没有被应用。

我尝试更改所有设置以查看是否会应用任何内容，但似乎没有：

```
.dropdown-menu li > a:hover,
.dropdown-menu li > a:focus,
.dropdown-submenu:hover > a {
  color: #666666;
  text-decoration: none;
  background-color: #666666;
    background-repeat: repeat-x;
    background-image: linear-gradient(to bottom, #666666, #666666);
}

.dropdown-menu .active > a,
.dropdown-menu .active > a:hover {
  color: #666666;
  text-decoration: none;
  background-color: #666666;
    background-repeat: repeat-x;
    outline: 0;
    background-image: linear-gradient(to bottom, #0088cc, #0077b3);
} 
```

我不知道是否有什么东西超越了设置，想知道是否有人可以提供帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T13:46:01.057

您的浏览器可能保存了 css 文件的缓存，因此您可能想尝试清除所有缓存并重新加载。

# ruby-on-rails - 从控制器导轨中的类中获取值

> ID：15549022
> 
> 赞同：0
> 
> 时间：2013-03-21T13:32:03.583
> 
> 标签：ruby-on-rails, database, rails-activerecord

标题具有误导性，但我不知道如何措辞。我有一个方法

```
 def showlease
   @tenant = Tenant.find(params[:id])
   @lease = @tenant.lease

   respond_to do |format|
   format.html # show.html.erb
   format.xml { render :xml => @tenant }
   end
   end 
```

如您所见，我必须安排租户和租赁。有没有办法从@lease 中提取价值？我的租约表有一个名为 property_id 的值，我想从@lease.property_id 中获得一些东西。然后我想使用这个值在我的另一个名为属性的表中获取相应的记录。这基本上是我想要的伪

```
@Property = Property.where(_id = (@lease.property_id) 
```

即使我可以从我的角度去做，如果可能的话

```
 <p> Firstname: <%= @tenant.name %></p>
 <p> LeaseStart: <%= @lease.lease_start %></p>
  <p> LeaseStart: <%= @property(@lease.property_id).address %></p> 
```

编辑：

这是我的模型

```
class Lease < ActiveRecord::Base
  attr_accessible :lease_end, :lease_start, :property_id, :tenant_id
  belongs_to :tenant
  belongs_to :property
end

class Property < ActiveRecord::Base
  attr_accessible :address_line_1, :city, :county, :image, :rent
  has_one :lease
end

class Tenant < ActiveRecord::Base
  attr_accessible :email, :name, :phone
  has_one :lease
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:36:24.860

只要您在模型中定义了不需要通过 ID 查找的关联，您只需请求关联对象即可。

```
<%= @lease.property.address %> 
```

# powershell - 具有覆盖的复制项

> ID：15549026
> 
> 赞同：3
> 
> 时间：2013-03-21T13:32:16.593
> 
> 标签：powershell

在我的一个脚本中，它尝试将一个 exe 复制到 C:\Windows\Temp 文件夹。例如：

```
Copy-Item repo\filename.exe -Destination \\$machine_name\C$\Windows\Temp 
```

错误信息：

```
Copy-Item : The network path was not found.
At D:\CMPortal\Scripts\ClientRepair\RepairCCMClient.ps1:122 char:33
+                     if(Copy-Item <<<<  cmsetup.exe -Destination \\$install_cmexec\C$\Windows\Temp)
    + CategoryInfo          : NotSpecified: (:) [Copy-Item], IOException
    + FullyQualifiedErrorId : System.IO.IOException,Microsoft.PowerShell.Commands.CopyItemCommand 
```

当我手动运行相同的命令时，它可以工作。不知道怎么了。如果复制文件存在于目标中，是否有任何覆盖文件？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T20:38:08.097

您是否正确使用引号？

```
Copy-Item 'repo\filename.exe' -Destination "\\$machine_name\C`$\Windows\Temp" -Force 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T13:40:53.457

$install_cmexec 是否包含服务器名称？此外，请确保运行脚本的用户对目标路径具有适当的权限。

# javascript - Jquery从列表框中添加和删除项目

> ID：15549027
> 
> 赞同：8
> 
> 时间：2013-03-21T13:32:18.417
> 
> 标签：javascript, jquery

我已经创建了这个[fiddle](http://jsfiddle.net/j2ctG/)，它允许用户单击艺术或视频，动态填充第二个列表框，其中包含与这些选择关联的列表。有两个按钮，一个用于将选择添加到框中，另一个用于删除选择。

我想做的是阻止用户添加一些已经添加的内容。选项的值都是Guids。如果您可以修改小提琴以使用 Guid 而不是整数，则可以加分。

我试过这个：

```
$.each($("#SelectBox2 option:selected"), function (i, ob) {
    if (i == $(this).val()) {

    } else {
        inHTML += '<option value="' + $(this).val() + '">' + $(this).text() + '</option>';
    }
}); 
```

我想让用户从列表中删除选定的项目。

谢谢，

**更新**只是让你们知道我想出的解决方案是什么，我得到了奖励积分，因为我以一种非常聪明的方式向它添加了 GUID :)[小提琴](http://jsfiddle.net/Lz5YM/)，我还整理了 html 以使其看起来漂亮整洁。

**重大更新**非常感谢所有为这个问题做出贡献的人，我已经接受了每个人的评论和小提琴，并产生了这个**>>** [小提琴](http://jsfiddle.net/no1_melman/dpjQY/) **<<**

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T13:43:50.347

我想你会想做这样的事情：[检查值是否在 JQuery 的选择列表中](https://stackoverflow.com/questions/2248976/check-if-value-is-in-select-list-with-jquery)。

将您的代码修改为这样的东西应该可以工作：

```
$("#SelectBox2 option:selected").each(function () {
    var optionVal = $(this).val();
    var exists = false;
    $('#SelectedItems option').each(function(){
        if (this.value == optionVal) {
            exists = true;
        }
    });

    if(!exists) {
        inHTML += '<option value="' + $(this).val() + '">' + $(this).text() + '</option>';
    }
}); 
```

删除选定的项目如下所示：

```
$('#remove').click(function () {
    $("#SelectedItems option:selected").remove();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T13:50:17.597

尝试：

```
$(function () {
    var artItems = ["Art 1", "Art 2", "Art 3", "Art 4", "Art 5", "Art 6"];
    var vidItems = ["Video 1", "Video 2", "Video 3", "Video 4", "Video 5", "Video 6"];
    $('#SelectBox').change(function () {
        var str = "",
            inHTML = "",
            items;
        items = $(this).val() == 'art' ? artItems : vidItems;
        $.each(items, function (i, ob) {
            inHTML += '<option value="' + i + '">' + ob + '</option>';
        });
        $("#SelectBox2").empty().append(inHTML);
    });

    $('#SelectBox2').change(function () {
        $("#selectedValues").text($(this).val() + ';' + $("#SelectBox").val());
        $('#hidden1').val($(this).val());
    });

    $('#add').click(function () {
        inHTML = "";
        $("#SelectBox2 option:selected").each(function () {
            if ($("#SelectedItems option[value=" + $(this).val() + "]").length == 0) {
                inHTML += '<option value="' + $(this).val() + '">' + $(this).text() + '</option>';
            }
        });
        $("#SelectedItems").append(inHTML);
    });

    $('#remove').click(function () {
        $('#SelectedItems option:selected').remove();
    });
}); 
```

[在这里](http://jsfiddle.net/j2ctG/6/)提琴

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T22:27:13.427

如果您想无缝地动态添加和删除行，请尝试这种方式

[http://jsfiddle.net/WX4Nw/](http://jsfiddle.net/WX4Nw/)

添加指向 selecteditems 列表的指针作为根项目键的数据属性将帮助您控制，以便您可以轻松管理添加/删除。

小提琴的片段：-

```
$('#SelectBox').change(function () {
        var str = "",
            inHTML = "",
            key = $('#SelectBox').val(),
            items;
        items = $(this).val() == 'art' ? artItems : vidItems;
        $.each(items, function (i, ob) {
            if($('#SelectedItems option[value="' + i + '"][data-key="' + key + '"]').length == 0)
                inHTML += '<option value="' + i + '" data-key="' + key + '">' + ob + '</option>';
        });
        $("#SelectBox2").empty().append(inHTML);
    });

 $('#add').click(function () {
        var itemsToAdd = [];
        $("#SelectBox2 option:selected").each(function () {
            var optionVal = $(this).val();
            var key = $(this).data('key');
            if ($('#SelectedItems option[value="' + optionVal + '"][data-key="' + key + '"]').length == 0)                     {
                itemsToAdd.push($(this).removeAttr('selected'));
            }
        });
        $("#SelectedItems").append(itemsToAdd);
    }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T15:15:31.250

看看这个解决方案：- 使用 data 属性来跟踪项目父列表选择器，并在此选择器和 data 属性的帮助下避免循环。

[http://jsfiddle.net/pramodsankar007/rMpBv/](http://jsfiddle.net/pramodsankar007/rMpBv/)

```
 $('#add').click(function () {
        var itemsToAdd = [];
        $("#SelectBox2 option:selected").each(function () {
            var optionVal = $(this).val();
            var key = $(this).data('key');
           if($('#SelectedItems option[value="' + optionVal + '"][data-key="' + key +'"]').length == 0)
           {
                 itemsToAdd.push($(this).removeAttr('selected').clone(true));
           }
        });
        $("#SelectedItems").append(itemsToAdd);
    });
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-21T13:43:18.017

好的，要修复您的添加功能，只需添加以下 if 条件：：

```
if($("#SelectedItems option:contains("+$(this).text()+")").length<=0)                
   inHTML += '<option value="' + $(this).text() + '">' + $(this).text() + '</option>'; 
```

删除项目::

```
$('#remove').click(function () {
    $("#SelectedItems option:selected").each(function () {
       $(this).remove();
    });
}); 
```

这是我更新后的示例[jsfiddle](http://jsfiddle.net/Ebram/j2ctG/10/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-21T13:48:20.393

如果您想阻止用户添加已存在的选项，请尝试此操作

```
 $("#SelectBox2 option:selected").each(function () {
            if(  $("#SelectedItems option[value='"+$(this).val()+"']").length <=0)
            inHTML += '<option value="' + $(this).val() + '">' + $(this).text() + '</option>';

        }) 
```

[http://jsfiddle.net/j2ctG/8/](http://jsfiddle.net/j2ctG/8/)

也更新了删除的小提琴。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-21T13:49:41.570

获取现有选项列表，检查您要添加的选项是否已经存在，如果不存在，请添加它们：

[http://jsfiddle.net/bZXs4/](http://jsfiddle.net/bZXs4/)

```
$('#add').click(function () {
     var inHTML = "";
     var $opts = $('#SelectedItems').find('option'); 

     $("#SelectBox2 option:selected").each(function () {
         var allowItemToBeAdded = true;
         var selectedVal = $(this).val();
         $opts.each(function(index, element){
             if($(this).val() === selectedVal){
                 allowItemToBeAdded = false;
             }
         });

         if(allowItemToBeAdded){
             inHTML += '<option value="' + selectedVal + '">' + $(this).text() + '</option>';
         }
     });

     if(inHTML !== ''){
         $("#SelectedItems").append(inHTML);
     }
 }); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-21T13:43:40.057

查看[链接](http://jsfiddle.net/j2ctG/4/)

写 if 条件为

```
 if($("#SelectedItems option:contains("+$(this).val()+")").length<=0)                
   inHTML += '<option value="' + $(this).val() + '">' + $(this).text() + '</option>'; 
```

然后加

```
$('#remove').click(function(){

  $('#SelectedItems  :selected').each(function(i, selected) {
    $(this).remove();
});
}); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-10-20T07:08:13.703

真正干净和简单（效果很好，只有几行）：

```
 $("#icon_move_right").click(function(){
            $("#available_groups option:selected").each(function(){ 
                available_group = $(this).val();
                $("#assigned_groups").append("<option value='" + available_group + "'>" + available_group + "</option>");
            });
            $("#available_groups option:selected").remove()
        });

        $("#icon_move_left").click(function(){
            $("#assigned_groups option:selected").each(function(){ 
                assigned_group = $(this).val();
                $("#available_groups").append("<option value='" + assigned_group + "'>" + assigned_group + "</option>");
            });
            $("#assigned_groups option:selected").remove()
        });

        $("#icon_move_right_all").click(function(){
            $("#available_groups option").each(function(){ 
                available_group = $(this).val();
                $("#assigned_groups").append("<option value='" + available_group + "'>" + available_group + "</option>");
            });
            $("#available_groups option").remove()
        });

        $("#icon_move_left_all").click(function(){
            $("#assigned_groups option").each(function(){ 
                assigned_group = $(this).val();
                $("#available_groups").append("<option value='" + assigned_group + "'>" + assigned_group + "</option>");
            });
            $("#assigned_groups option").remove()
        }); 
```

# android - 无法将图标添加到标记，地图 V2 Android

> ID：15549031
> 
> 赞同：0
> 
> 时间：2013-03-21T13:32:25.173
> 
> 标签：android, google-maps-android-api-2

这是我向地图添加标记的方式

```
map.addMarker(new MarkerOptions()
                    .position(model.getLatLongfromService())
                    .title(model.getCoupon_name())
                    .snippet(model.getCoupon_id())
                    .icon(BitmapDescriptorFactory.fromFile(DataHolder.imageUrl
                            + model.getCoupon_image()))); 
```

*   我得到这种格式的优惠券图片： [http](http://www.xyz.com/coupon21.jpg) ://www.xyz.com/coupon21.jpg **

*   当您运行我的应用程序时，我收到此错误。

java.lang.IllegalArgumentException：文件[http://test.xyz.de/uploads/company_logo/sample-logo-110x60.jpg](http://test.xyz.de/uploads/company_logo/sample-logo-110x60.jpg)包含路径分隔符

谁能帮助我了解问题所在？

谢谢，拉克什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:55:27.603

我认为问题在于方法 BitmapDescriptorFactory.fromFile 使用参数字符串文件名，它表示要加载的文件（图像）的名称。您提供图像的 http url ( [http://test.xyz.de/uploads/company_logo/sample-logo-110x60.jpg](http://test.xyz.de/uploads/company_logo/sample-logo-110x60.jpg) ) 而不是它。

您可能需要先下载图像，然后使用 BitmapDescriptorFactory.fromBitmap;

**编辑：** 要下载图像，您可以使用像这样的一些 AsyncTask 例如：

```
 AsyncTask<String, Void, Bitmap> loadImageTask = new AsyncTask<String, Void, Bitmap>(){
        @Override
        protected Bitmap doInBackground(String... params) {
            Bitmap bmImg = null;
            try { 
                URL url = new URL(params[0]);
                HttpURLConnection conn = (HttpURLConnection) url.openConnection();   
                conn.setDoInput(true);   
                conn.connect();     
                InputStream is = conn.getInputStream();
                bmImg = BitmapFactory.decodeStream(is); 
            }
            catch (IOException e)
            {       
                e.printStackTrace(); 
                bmImg = null;
            }

            return bmImg; 
        }

        @Override
        protected void onPostExecute(Bitmap result) {
            super.onPostExecute(result);
            // TODO: do what you need with resulting bitmap - add marker to map
        }
    }; 
```

然后不要忘记使用适当的参数执行 asynctask - 包含要下载的图像 url 的字符串数组：

```
loadImageTask.execute(new String[]{yourImageUrl}); 
```

# image - 使用 PlayFramework 1.2.x 在服务器端创建和保存 Blob

> ID：15549041
> 
> 赞同：0
> 
> 时间：2013-03-21T13:33:04.247
> 
> 标签：image, jpa, playframework, blob

我有数千张图像，我希望能够使用一些 Java 代码将它们作为 Blob 插入到我的数据库中，以避免花费 2 个月的时间将它们一一添加。

问题是我的模型看起来像：

```
public class Picture extends Model {
    public Blob image;
    public Date uploadDate;
    public String title;

    public Picture(Blob image, Date uploadDate, String title) {
        // usual stuff...
    }
} 
```

如何使用构造函数或工厂创建 Blob？我还找不到类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T10:36:19.683

从上面的评论中，解决方案很简单：

```
 Blob myBlob = new Blob().set(java.io.InputStream is, java.lang.String type) 
```

# r - y~fn(type="x")+fn(type="z")类型的R公式，忽略fn的第二次出现？

> ID：15549044
> 
> 赞同：1
> 
> 时间：2013-03-21T13:33:16.170
> 
> 标签：r

我有一个模型构建函数，其中公式可以包含一些函数，我希望它能够工作，以便如果用户多次输入该函数，只有第一次使用时会发出警告。例如，`lm`如果我们两次使用相同的变量，则第二个被删除：

```
y<-1:3
x<-1:3 
lm(y~x+x)

Call:
lm(formula = y ~ x + x)

Coefficients:
(Intercept)            x  
          0            1 
```

这是有效的，因为`terms`用于`model.frame`删除具有相同名称的变量的函数。但在我的情况下，我正在使用公式内部的函数，这些函数不一定具有相同的参数列表，我希望这种行为能够扩展，以便这些函数的参数无关紧要：

```
model(y~x+fn("x"))
  (Intercept) x temp
1           1 1    1
2           1 2    1
3           1 3    1
model(y~x+fn("x")+fn("x")) #identical function calls
  (Intercept) x temp
1           1 1    1
2           1 2    1
3           1 3    1
model(y~x+fn("x")+fn("z")) #function with different argument value
Error in attr(all_terms, "variables")[[1 + ind_fn]] : 
  subscript out of bounds 
```

这是我在上面使用的示例函数（高度简化）：

```
model <- function(formula, data) {    

  #the beginning is pretty much copied from lm function    
  mf <- match.call(expand.dots = FALSE)   
  mf <- mf[c(1L,  match(c("formula", "data"), names(mf), 0L))]
  mf[[1L]] <- as.name("model.frame")
  mf$na.action <- as.name("na.pass")  

  all_terms <- if (missing(data)){ 
    terms(formula, "fn")
  } else terms(formula, "fn", data = data)

  #find the position of the function call in the formula
  ind_fn <- attr(all_terms, "specials")$fn

  #update the formula by removing the "fn" part
  if(!is.null(ind_fn)){
    fn_term <- attr(all_terms, "variables")[[1 + ind_fn]]
    formula <- update( formula, paste(". ~ .-", deparse(fn_term, 
                       width.cutoff = 500L, backtick = TRUE)))  
     mf$formula<-formula           
  } 

  # build y and X
  mf <- eval(mf, parent.frame())   
  y <- model.response(mf, "numeric")
  mt <- attr(mf, "terms")
  X <- model.matrix(mt, mf)

  #if fn was in formula do something with it
  if (!is.null(ind_fn)){

    foobar<-function(type=c("x","z")){
      if(type=="x"){
        rep(1,nrow(X))
      } else rep(0,nrow(X))
    }
    fn_term[[1]]<-as.name("foobar") 
    temp<-eval(fn_term)
    X<-cbind(X,temp)
  }  

  X
  } 
```

我可以检查特价商品（函数调用）的名称并将它们重命名为与第一次出现的相同，但我想知道是否有更聪明的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T15:22:58.923

我无法让你的代码正常工作，但假设我已经理解你的任务，也许这样的事情可以完成你所追求的。

```
f <- y ~ x + fn("x") + fn("z") + z + fn('a')
# get list of terms
vars <- as.list(attr(terms(f), 'variables'))
# get those terms that are duplicate calls
redundant <- vars[sapply(vars, is.call) & duplicated(sapply(vars, function(x) as.list(x)[[1]]))]
# remove the duplicate calls from the formula
update(f, paste(". ~ .", paste(sapply(redundant, deparse), collapse='-'), sep='-'))
# y ~ x + fn("x") + z 
```

# php - 对两个数组求和的最佳方法

> ID：15549045
> 
> 赞同：16
> 
> 时间：2013-03-21T13:33:17.750
> 
> 标签：php, arrays, sum

我有两个数组：

```
$a = array(10, 2, 5, 10, 0);
$b = array(1, 20, 11, 8, 3); 
```

我需要总结并得到结果：

```
$c = array(11, 22, 16, 18, 3); 
```

关于如何在没有“foreach”的情况下执行此操作的任何建议？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-21T13:43:24.413

一个简单的方法可能是

```
$c = array_map(function () {
    return array_sum(func_get_args());
}, $a, $b);

print_r($c); 
```

或者如果你可以使用 PHP5.6，你也可以使用像这样的可变参数函数

```
$c = array_map(function (...$arrays) {
    return array_sum($arrays);
}, $a, $b);

print_r($c); 
```

输出

```
Array
(
    [0] => 11
    [1] => 22
    [2] => 16
    [3] => 18
    [4] => 3
) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-21T13:40:50.173

试试喜欢

```
$c = array();
foreach (array_keys($a + $b) as $key) {
    $c[$key] = $a[$key] + $b[$key];
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-21T13:39:38.017

如果没有您要求的“foreach”，您将无法做到这一点，您需要在两个数组上循环以获取各自的值。

使用 foreach 的函数将是：

```
function sum_arrays($array1, $array2) {
    $array = array();
    foreach($array1 as $index => $value) {
        $array[$index] = isset($array2[$index]) ? $array2[$index] + $value : $value;
    }
    return $array;
} 
```

现在你只需要做：

```
$c = sum_arrays($a, $b); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T13:35:41.577

```
$c = array();
for($i=0;$i<count($a);$i++) {
  $c[$i] = $a[$i]+$b[$i];
} 
```

# php - PHP多维数组排序array_reverse不起作用？

> ID：15549048
> 
> 赞同：7
> 
> 时间：2013-03-21T13:33:19.097
> 
> 标签：php, multidimensional-array, sorting

我有一个**`Multidimensional`**数组，我正在狂热地尝试按日期正确排序。

到目前为止，我有：

```
usort($respArr, function($a, $b){
        $t1 = strtotime($a['PublishDate']);
        $t2 = strtotime($b['PublishDate']);
        return $t1 - $t2;
    });

array_reverse($respArr);
echo '<pre>';
print_r($respArr);
echo '</pre>';
echo '<hr />'; 
```

这是上面的一些输出：

```
Array
(
[34] => Array
    (
        [Title] => o7thwd: Partnered with Internet Services Inc., to offer complete online presence! http://t.co/1SgAF66Tbf @ISI_Cloud
        [Link] => http://twitter.com/o7thwd/statuses/306088158574022656
        [PublishDate] => 2/25/2013 12:07:58 PM
        [Image] => 
        [Description] => o7thwd: Partnered with Internet Services Inc., to offer complete online presence! http://t.co/1SgAF66Tbf @ISI_Cloud
    )

[35] => Array
    (
        [Title] => o7thwd: Hangin with Mama Bear giving her the basics of social networking
        [Link] => http://twitter.com/o7thwd/statuses/307916797066240000
        [PublishDate] => 3/2/2013 1:14:19 PM
        [Image] => 
        [Description] => o7thwd: Hangin with Mama Bear giving her the basics of social networking
    )

[36] => Array
    (
        [Title] => o7thwd: o7th Web Design Articles http://t.co/plP8OkB7So
        [Link] => http://twitter.com/o7thwd/statuses/308687737400205313
        [PublishDate] => 3/4/2013 4:17:46 PM
        [Image] => 
        [Description] => o7thwd: o7th Web Design Articles http://t.co/plP8OkB7So
    )

[37] => Array
    (
        [Title] => o7thwd: finished up my GUI for a YUI minifier: http://t.co/7DKLoCXJHw
        [Link] => http://twitter.com/o7thwd/statuses/309309871931682816
        [PublishDate] => 3/6/2013 9:29:54 AM
        [Image] => 
        [Description] => o7thwd: finished up my GUI for a YUI minifier: http://t.co/7DKLoCXJHw
    )

[38] => Array
    (
        [Title] => o7thwd: o7th Web Design Articles http://t.co/QAIUO2Qjko
        [Link] => http://twitter.com/o7thwd/statuses/314356123027243008
        [PublishDate] => 3/20/2013 8:41:54 AM
        [Image] => 
        [Description] => o7thwd: o7th Web Design Articles http://t.co/QAIUO2Qjko
    )

[39] => Array
    (
        [Title] => SkorIn2: starting new desktop app to compliment the web app
        [Link] => http://twitter.com/SkorIn2/statuses/314718985725804545
        [PublishDate] => 3/21/2013 8:43:48 AM
        [Image] => 
        [Description] => SkorIn2: starting new desktop app to compliment the web app
    )

) 
```

但是，正如您在上面所说 的那样，数组*并没有反转。***谁能帮我这个？**
它向我展示了该数组确实是按“PublishDate”排序的，但是，与我需要它的顺序相反。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-21T13:38:01.783

实际问题是您没有将结果分配`array_reverse`给任何东西

```
// change this
array_reverse($respArr);

// to this
$respArr = array_reverse($respArr); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T13:34:52.900

尝试这个 ：

```
$arr  = your array;
$sort = array();
foreach($arr as $k=>$v) {
    $sort['PublishDate'][$k] = $v['PublishDate'];
}

array_multisort($sort['PublishDate'], SORT_DESC, $arr);

echo "<pre>";
print_r($arr); 
```

但是请正确格式化您的日期，否则这可能行不通。将其格式化为`yyyy-mm-dd hh:mm:ss`

# jbpm - 是 JBPM 稳定的开源 BPM 框架

> ID：15549049
> 
> 赞同：0
> 
> 时间：2013-03-21T13:33:19.967
> 
> 标签：jbpm

我正在从事与银行领域相关的项目，其中我们正在为 BPM（工作流引擎）使用 weblogic JPD 框架。对于根据要求的新项目，我们需要使用开源 BPM 框架。我搜索了一下，发现了 JBOSS JBPM。我担心的是 JBPM 是否足够稳定，可以在大型银行应用程序中使用，不要误会我的意思，因为 JBPM 不是 weblogic JPD 那样的商业产品。是否有任何其他开源 BPM 框架选项。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T19:29:31.807

Here are my 2 cents. I should start by saying, I am a java guy who has been working with jBPM for about two months now. I have NOT plowed through the code, I rely on the (new) jBPM 5 book (which is decent), the online user guide, which is decent, and the discussion group question/answers. I am new to BPMN. I have seen a few pretty slick-looking commercial workflow products. I'm sure if you've googled, you have found Activiti, but jBPM is the extent of my domain experience.

1) No disrepect to Kris, but I wonder about how wide the adaptation of jBPM is. Note, there are frequent source commits; my feeling is based solely on the online community. For example, some projects (e.g. Apache Camel) have incredible documentation and most importantly an active user base. I feel the jBPM realm of "expertise" is pretty small. By that I mean if you look at the discussion group, most of the answers to questions come from only about a half dozen people. Thankfully most of these are neck deep in the project's development/management (like Kris), so they are knowledgeable. They know the little tricks (special casting, variables that can be used automagically, etc.) that require intimate knowledge of the code.

2) For me, the demos/examples only work in their specific limited context. For example, to install all of AS7 and the jBPM tool suite on port 8080 is a single command thanks to the included ant script. However, it took me days to stand it up on port 7070\. Many of the videos you see are far more complicated to set up/ replicate than they appear.

3) Will you be using rules? Don't think that because you can use rules/drools with jBPM, they are well (or at least intuitively) integrated. Their use, when they are triggered, how they can be used, are a constant source of confusion in all but the most rudimentary cases.

4) Drools Flow and jBPM projects integrated about a year ago. I'm not sure if that is related, but I am often confused by similarly named classes between jBPM and Drools, but in different packages. You wont find package usage information in the documentation. For example, when I learn that I have access to a ProcessInstance, typically the first thing I do is system.out the class name to see which implementation it is because the capability varies wildly whether I'm accessing it from a rule, or workitem handler, or script task, etc.

5) I find the some elements, especially relating to persistence, somewhat kludgy. For example, if you want to get list of the processes running in your session (ksession), ksession.getProcessInstances() works great....unless you're using persistence - then, while you can still call it, it returns an empty list. In that case you have to resort to setting up a logger, and finding the process id from the log table. That is all easy to do, and there is a note in the javadoc about getProcessInstance, but I still think that's pretty ugly.

You seem focused on open source. I'm not sure if you are being paid to develop or if you will be hiring someone. I'd say that like all open source, the code is free, but to make it actually do something wont be. I'm projecting here, but I suspect development of a large-scale product with jBPM will cost you significantly more than you expect. Also, google "jbpm can't scale" for an interesting (and good) discussion about scalability.

Please don't think I am jBPM bashing; I am building a project with it today, and it's an awful lot of "free" and impressive capability. Good luck. HTH

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T20:27:45.987

It is used in a lot of places in production.

And it is also a commercial product, Red Hat is selling subscriptions as part of the BRMS / BPMS platform: [http://www.redhat.com/products/jbossenterprisemiddleware/business-rules/](http://www.redhat.com/products/jbossenterprisemiddleware/business-rules/)

# parsing - Haskell/Parsec：你如何使用 Text.Parsec.Indent 中的函数？

> ID：15549050
> 
> 赞同：11
> 
> 时间：2013-03-21T13:33:19.807
> 
> 标签：parsing, haskell, indentation, parsec

我无法弄清楚如何使用Haskell 包[`Text.Parsec.Indent`](http://hackage.haskell.org/packages/archive/indents/latest/doc/html/Text-Parsec-Indent.html)提供的模块中的任何功能[`indents`](http://hackage.haskell.org/package/indents-0.3.3)，这是 Parsec 的一种附加组件。

所有这些功能的作用是什么？如何使用它们？

我可以理解 Haddock 的简短描述`withBlock`，并且我已经找到了如何使用的示例`withBlock`，以及[此处](http://spin.atomicobject.com/2012/03/16/using-text-parsec-indent-to-parse-an-indentation-sensitive-language-with-haskells-parsec-library/)、[此处](http://changaco.net/blog/parse-indented-tree/)和[此处](https://stackoverflow.com/questions/15533730/haskell-parsec-indents-please-give-an-example-for-how-to-use-each-of-the-functi)`runIndent`的`IndentParser`类型。我也能看懂这四个解析器[和朋友](http://hackage.haskell.org/packages/archive/indents/latest/doc/html/Text-Parsec-Indent.html#g:4)的文档。但是很多事情还是让我很困惑。[`indentBrackets`](http://hackage.haskell.org/packages/archive/indents/latest/doc/html/Text-Parsec-Indent.html#g:4)

尤其：

1.  `withBlock f a p`和有什么区别

    ```
    do aa <- a
       pp <- block p
       return f aa pp 
    ```

    `withBlock' a p`同样，和之间有什么区别`do {a; block p}`

2.  在功能[`indented`和朋友](http://hackage.haskell.org/packages/archive/indents/latest/doc/html/Text-Parsec-Indent.html#g:3)的家庭中，什么是“参考水平”？也就是说，什么是“参考”？

3.  再次，有了函数`indented`和朋友，它们如何使用？除了 之外`withPos`，看起来它们没有参数并且都是类型`IParser ()`（IParser 定义为[this](http://spin.atomicobject.com/2012/03/16/using-text-parsec-indent-to-parse-an-indentation-sensitive-language-with-haskells-parsec-library/)或[this](https://stackoverflow.com/questions/15533730/haskell-parsec-indents-please-give-an-example-for-how-to-use-each-of-the-functi)）所以我猜他们所能做的就是产生错误或不产生错误，并且它们应该出现在一个`do`块中，但我无法弄清楚细节。

    我至少确实在源代码中找到了一些有关使用的示例`withPos`，[所以](http://hackage.haskell.org/packages/archive/indents/latest/doc/html/src/Text-Parsec-Indent.html)如果我盯着它看足够长的时间，我可能会弄清楚。

4.  [`<+/>`](http://hackage.haskell.org/packages/archive/indents/latest/doc/html/Text-Parsec-Indent.html#v:-60--43--47--62-)附带有用的描述“<code><+/> is to indentationsensitive parser what `ap`is to monads”如果你想花几个会话试图绕开你的脑袋`ap`然后弄清楚它与解析器的相似之处，这非常有用。然后参考 定义其他[三个组合](http://hackage.haskell.org/packages/archive/indents/latest/doc/html/Text-Parsec-Indent.html#g:5)`<+/>`子，使整个组无法被新人接近。

    我需要使用这些吗？我可以忽略它们并改用它们`do`吗？

5.  Parsec的普通[`lexeme`](http://hackage.haskell.org/packages/archive/parsec/latest/doc/html/Text-Parsec-Token.html#v:lexeme)组合器和[`whiteSpace`](http://hackage.haskell.org/packages/archive/parsec/latest/doc/html/Text-Parsec-Token.html#v:whiteSpace)解析器将愉快地在多令牌构造中间使用换行符而不会抱怨。但是在缩进风格的语言中，有时您想停止解析词法结构，或者如果一行中断并且下一行的缩进少于应有的缩进量，则抛出错误。我该如何在 Parsec 中执行此操作？

6.  在我试图解析的[语言](http://www.cs.bris.ac.uk/software/next/status/lex.html)中，理想情况下，何时允许词汇结构继续到下一行的规则应该取决于第一行末尾或下一行开头出现的标记。有没有一种简单的方法可以在 Parsec 中实现这一目标？（如果这很困难，那么这不是我现在需要关心的事情。）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-24T01:09:13.327

所以，第一个提示是看看`IndentParser`

```
type IndentParser s u a = ParsecT s u (State SourcePos) a 
```

即，它是`ParsecT`一个额外的密切关注[`SourcePos`](http://hackage.haskell.org/packages/archive/parsec/3.1.2/doc/html/Text-Parsec-Pos.html#t%3aSourcePos)，一个抽象容器，可用于访问当前*列*号等。因此，它可能将当前的“缩进级别”存储在`SourcePos`. 这就是我对“参考水平”意味着什么的初步猜测。

简而言之，`indents`它为您提供了一种新的`Parsec`上下文敏感的 - 特别是对当前缩进敏感。我会不按顺序回答你的问题。

* * *

(2) “引用级别”是在当前解析器上下文状态中引用的“信念”，该缩进级别从哪里开始。为了更清楚，让我在（3）上给出一些测试用例。

(3) 为了开始试验这些功能，我们将构建一个小测试运行器。它将使用我们给它的字符串运行解析器，然后使用我们要修改`State`的 an 来解开内部部分。`initialPos`在代码中

```
import Text.Parsec
import Text.Parsec.Pos
import Text.Parsec.Indent
import Control.Monad.State

testParse :: (SourcePos -> SourcePos) 
          -> IndentParser String () a 
          -> String -> Either ParseError a
testParse f p src = fst $ flip runState (f $ initialPos "") $ runParserT p () "" src 
```

（注意，这*几乎* `runIndent`是，除了我给了一个后门来修改`initialPos`。）

现在我们可以看看`indented`。通过检查源代码，我可以看出它做了两件事。首先，`fail`如果*当前* `SourcePos`列号小于或等于`SourcePos` *存储在`State`*. 其次，它有点神秘地将`State` `SourcePos`'*行*计数器（不是列计数器）更新为最新的。

据我了解，只有第一个行为很重要。我们可以在这里看到不同之处。

```
>>> testParse id indented ""
Left (line 1, column 1): not indented

>>> testParse id (spaces >> indented) "   "
Right ()

>>> testParse id (many (char 'x') >> indented) "xxxx"
Right () 
```

因此，为了`indented`取得成功，我们需要消耗足够的空格（或其他任何东西！）以将我们的列位置推到“参考”列位置之外。否则，它会失败说“不缩进”。接下来的三个函数存在类似的行为：`same`除非当前位置和参考位置在同一行，`sameOrIndented`否则失败；如果当前列严格小于参考列，则`checkIndent`失败，除非它们在同一行；除非当前和参考位置在同一行，否则失败。参考列匹配。

`withPos`略有不同。它不仅仅是 a `IndentParser`，它还是一个`IndentParser`-combinator——它将输入`IndentParser`转换为一个认为“参考列”（`SourcePos`中的`State`）正是我们调用`withPos`.

这给了我们另一个提示，顺便说一句。它让我们知道我们有权更改参考列。

(1) 现在让我们看看如何使用我们新的、较低级别的引用列操作符`block`。是根据 实现的，所以我们将从 开始。`withBlock``withBlock``block``block`

```
-- simplified from the actual source
block p = withPos $ many1 (checkIndent >> p) 
```

因此，`block`将“参考列”重置为当前列的任何内容，然后消耗至少 1 个解析，`p`只要每个解析与这个新设置的“参考列”缩进相同。现在我们可以看看`withBlock`

```
withBlock f a p = withPos $ do
  r1 <- a
  r2 <- option [] (indented >> block p)
  return (f r1 r2) 
```

因此，它将“参考列”重置为当前列，解析单个`a`解析，尝试解析一个`indented` `block`s `p`，然后使用`f`. 您的实现*几乎*是正确的，只是您需要使用`withPos`选择正确的“参考列”。

然后，一旦你拥有`withBlock`, `withBlock' = withBlock (\_ bs -> bs)`.

(5) 所以，`indented`和朋友正是这样做的工具：如果相对于 . 选择的“参考位置”缩进不正确，它们将导致解析立即失败`withPos`。

[`Applicative`(4) 是的，在你学会如何在 base 中使用样式](http://learnyouahaskell.com/for-a-few-monads-more#useful-monadic-functions)解析之前，不要担心这些人`Parsec`。它通常是一种更清洁、更快、更简单的指定解析的方法。有时它们甚至更强大，但如果你理解`Monad`s 那么它们几乎总是完全等价的。

(6) 这就是症结所在。到目前为止提到的工具只有在您可以使用`withPos`. 很快，我认为不可能`withPos`根据其他解析的成功或失败来指定......所以你必须更深入地了解。幸运的是，使`IndentParser`s 工作的机制是显而易见的——它只是一个`State`包含`SourcePos`. 您可以使用它`lift :: MonadTrans t => m a -> t m a`来操作此内部状态并根据需要设置“参考列”。

干杯!

# javascript - jquery 图像预加载与 javascript

> ID：15549060
> 
> 赞同：0
> 
> 时间：2013-03-21T13:33:51.790
> 
> 标签：javascript, jquery, image, load

我正在尝试在我的 jquery 函数中找到为轮播预加载图像的最佳方法

```
$('<img />').attr({ 'src': imgurl }).appendTo(currentli).hide().load(function() {                   
                   console.log("preload!");
                }); 
```

寻找最好的方法，我发现了建议使用的旧 2008 问题

```
var img = new Image();
img.src = imgurl;

document.body.appendChild( img );
img.onload = function() {
console.log("preload!");
} 
```

使用 jquery 和 javascript 有什么区别？还有其他建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:44:28.093

是的，等到窗口准备好窗口加载事件，然后显示包含照片的实际 div 元素并运行该功能。就像是...

```
$(window).load(function(){ 
  displayAndRunMyCarousel();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:38:25.423

简单的 javascript 版本首先在定义 src 时将图像加载到内存中，然后将其添加到 DOM 中。

jquery 版本首先将其添加到 DOM，然后加载图像.. 这就是它们的所有差异

评论更新后：-

```
var img = new Image();
img.src = imgurl;

$('<img />').attr({ 'src': imgurl }).appendTo(currentli).hide().load(function() {                   
                   console.log("preload!");
                }); 
```

通过这样做，您可以在实际添加到 DOM 之前加载图像

# xml - 如何使用 XSLT 解析 XML？

> ID：15549061
> 
> 赞同：1
> 
> 时间：2013-03-21T13:33:52.630
> 
> 标签：xml, xslt, xml-parsing, xslt-grouping

我有一个包含如下数据的 XML

```
<Item1>
  <item2>
    <Item3>111</Item3>
  <Item2>
</Item11> 
```

**获取Item3**中的值 111

 **```
<xsl:choose>
  <xsl:value-of select="Item1/Item2/Item3"/>
</xsl:choose> 
```

在 XSLT 中。现在我需要得到以下信息：

```
<Product1>
  <Product2>
    <Product3 ValidYN="Y" ProducType="ABC">333</Product3>
    <Product3 ValidYN="Y" ProducType="DEF">444</Product3>
    <Product3 ValidYN="Y" ProducType="GHI">555</Product3>
  <Product12>
</Product1> 
```

我需要根据**ProducType**取值**333**、**444**、**555** 。如何使用 XSLT 做同样的事情

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:01:08.283

要根据与其相关的值来选择节点，可以像这样使用 XPath：

```
/Product1/Product2/Product3[@ValidYN = 'Y' and @ProductType = 'ABC']
/Product1/Product2/Product3[@ValidYN = 'Y' and @ProductType = 'DEF']
/Product1/Product2/Product3[@ValidYN = 'Y' and @ProductType = 'GHI'] 
```

[方括号] 中的部分称为“谓词”。****

# html - 从 C 代码中获取 HTML 内容

> ID：15549062
> 
> 赞同：-3
> 
> 时间：2013-03-21T13:33:54.117
> 
> 标签：html, c, get, java-native-interface

我实现了一个 Java 代码，它可以向远程网站发送请求并从中检索数据。但是我想要 C 中的相同代码，但是我在 C 库中找不到这么多的帮助。任何机构都可以给我任何提示吗？

```
public static String getHTML(String urlToRead) {
        URL url;
        HttpURLConnection conn;
        BufferedReader rd;
        String line;
        String result = "";

        try {
            url = new URL(urlToRead);
            conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("GET");
            rd = new BufferedReader(
                    new InputStreamReader(conn.getInputStream()));
            while ((line = rd.readLine()) != null) {
                result += line;
            }
            rd.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
        return result;
    }

    public static void main(String[] args) throws IOException {
        InetAddress thisIp = null;
        try {
            thisIp = InetAddress.getLocalHost();
        } catch (UnknownHostException e1) {
            e1.printStackTrace();
        }
        System.out.println(getHTML("http://api.hostip.info/get_html.php?ip="
                + thisIp.getHostAddress()));
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:37:48.707

C 没有任何功能可以像标准 Java 库那样方便地获取网站。

您可以使用[libcurl](http://curl.haxx.se/libcurl/)，这是一种相当方便的方式，也可以自己在套接字中编写所有内容，在这种情况下，我会说先熟悉 C 网络编程：[Beej's Guide to Network Programming](https://beej.us/guide/bgnet/html/single/bgnet.html)

# java - Java 将 double 转换为 long 异常

> ID：15549076
> 
> 赞同：1
> 
> 时间：2013-03-21T13:34:41.087
> 
> 标签：java, classcastexception

1- 长 xValue = someValue;

2- 长 yValue = someValue;

3- long otherTolalValue = (long)(xValue - yValue);

那行代码给了我以下异常：

`java.lang.ClassCastException: java.lang.Double cannot be cast to java.lang.Long.`

*   更新 ：

代码段：

```
StackedBarChart<String,Number> sbc = new StackedBarChart<String,Number>();

XYChart.Series<String, Number> series = new XYChart.Series<String, Long>();
series.getData.add(new XYChart.Data<String, Number>("X1",150));
series.getData.add(new XYChart.Data<String, Number>("X2",50));
sbc.getData.add(series);
long dif = getDif(sbc);

long getDif(XYChart barChart){
XYChart.Series series = (XYChart.Series).getData().get(0);
// X1 at zero position i dont have to use iIterator now.
XYChart.Data<String, Long> seriesX1Data = series.getData().get(0);
XYChart.Data<String, Long> seriesX2Data = series.getData().get(1);

long x1Value = seriesX1Data.getYValue();
long x2Value = seriesX1Data.getYValue();
// line - 3 - exception on the next line
// -4- long value = (x1Value) - (x2Value);
long value = (long)(x1Value) - (long)(x2Value);
return value;
} 
```

*   调试后我发现了。

`seriesX1Data,seriesX2Data`包含双精度值`as the passed chart has Number type`，但 getYvalue() 返回 long，这就是为什么程序在运行时崩溃并出现该异常，但是当我在线投射时，为什么投射不成功。我认为编译器看到该类型已经很长了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T13:37:36.677

```
long xValue = (long)someValue;
// or : 
long yValue = new Double(someValue).longValue();

long otherTolalValue = xValue - yValue; 
```

但请记住，您将失去精度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:02:58.723

不可能

```
long xValue = someValue;
long yValue = someValue;
long otherTolalValue = (long)(xValue - yValue); 
```

3 行都不能产生 java.lang.ClassCastException

假设 someValues 是 Double，

```
Double someValue = 0.0; 
```

它会给出编译错误：*类型不匹配：无法将 Double 转换为 long*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T14:08:41.367

我真的不明白为什么您的代码会失败，但以下也可以正常工作。

```
 public class CastingDoubleToLongTest {

      @Test
      public void testCast(){
        double xValue = 12.457;
        double yValue = 9.14;

        long diff = new Double(xValue - yValue).longValue();

        Assert.assertEquals(3, diff);
      }
   } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T14:05:27.070

大概`someValue`是一个`double`。要将其分配给`long`您需要转换它：

```
long xValue = (long) someValue; 
```

# file - 谁能告诉我是什么导致了这段代码中的分段错误？

> ID：15549080
> 
> 赞同：-1
> 
> 时间：2013-03-21T13:34:56.213
> 
> 标签：file, memory, segmentation-fault

很抱歉在这么晚的时间问这个问题，但我有一个第二天到期的作业，这只是我有七个问题中的第一个。我的导师和讲师没有回应我的呼救声，我被困住了已经有几天了。我知道分段错误通常意味着某处存在非法内存访问，但我无法弄清楚它为什么会发生。我已经分配了内存，它似乎发生在 fseek 区域，因为如果我在之后评论整个块，则没有分段错误`fseek()`。

```
#include"stdio.h"
#include"stdlib.h"
#include"string.h"
#include"sys/types.h"
#include"sys/stat.h"
#include"fcntl.h"

int file_exists( char *filename)
//int main(int argc, char **argv[])
{

    FILE *file;

    if(file=fopen(filename,"r"))
//if(file=fopen(argv[1],"r"))
    {
        fclose(file);
        return 1;
    }

    return 0;
}

int main(int argc, char *argv[] )
{
    int fp,number,size,i;
    char *buffer;
    fp = open(argv[1], "w");

    number=atoi(argv[3]);
    printf("%d",number);

    if(file_exists(argv[1])==1)
    {
        fseek(fp,0L,SEEK_END);
        size=ftell(fp);
        fseek(fp,0L,SEEK_SET);

        if(size>number)
        {
            fseek(fp,number,SEEK_SET);
            fprintf(fp,argv[2]);
        }

        if(size<number)
        {
            int spaces;
            fseek(fp,0L,SEEK_END);
            spaces=number-size;
            buffer= malloc(spaces);
            memset(buffer," ",spaces);

//for(i=0;i<spaces;i++)
//{
            fprintf(fp,buffer);
//}
            free(buffer);

            buffer=malloc(number*sizeof(number));
            fprintf(fp,argv[2]);
            free(buffer);
        }

    }

    if(file_exists(argv[1])==0)
    {
        creat(argv[1],"w");
        buffer=malloc(number);
        memset(buffer,' ',number);
//for( i=0;i<number;i++)
//{
        fprintf(fp,buffer);
//}
        free(buffer);
        buffer=malloc(number);
        fprintf(fp,argv[2]);
        free(buffer);
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:39:44.007

fprintf 需要文件句柄，而不是文件描述符。

如果您真的想使用 fprintf，请使用 fopen 从文件描述符 (fp) 中获取文件句柄。

# xml - 使用 XSLT 1.0 将 XML 转换为 CSV

> ID：15549081
> 
> 赞同：0
> 
> 时间：2013-03-21T13:34:57.840
> 
> 标签：xml, xslt, xslt-1.0

我有一个将 XML 文档转换为 CSV 文档的特殊情况。在我的 XML 中，我具有以下结构：

```
<Pictures>
    <Picture>
        <File>picture1.jpg</File>
        <Purpose>normal</Purpose>
    </Picture>
    <Picture>
        <File>pictureX.jpg</File>
        <Purpose>normal</Purpose>
    </Picture>
    <Picture>
        <File>picture999.jpg</File>
        <Purpose>normal</Purpose>
    </Picture>
    <Picture>
        <File>picture1.jpg</File>
        <Purpose>normal</Purpose>
    </Picture>
    <Picture>
        <ID>555</ID>
        <File>detailX.jpg</File>
        <Purpose>detail</Purpose>
    </Picture>
    <Picture>
        <File>detail1.jpg</File>
        <Purpose>detail</Purpose>
    </Picture>
</Pictures> 
```

我想要的是以下CSV：

```
normal1;normal2;normal3;detail1;detail2
picture1.jpg;pictureX.jpg;picture999.jpg; 
```

到目前为止，我能够正确转换它。但问题是，我的 XML 中有许多其他图片元素可以包含具有其他用途值的图片元素。

例子：

```
<Pictures>
    <Picture>
        <File>picture1.jpg</File>
        <Purpose>normal</Purpose>
    </Picture>
</Pictures>
<Pictures>
    <Picture>
        <File>picture2.jpg</File>
        <Purpose>detail</Purpose>
    </Picture>
</Pictures>
<Pictures>
    <Picture>
        <File>pictureX.jpg</File>
        <Purpose>normal</Purpose>
    </Picture>
    <Picture>
        <File>pictureY.jpg</File>
        <Purpose>detail</Purpose>
    </Picture>
</Pictures>
<Pictures>
    <Picture>
        <File>pictureA.jpg</File>
        <Purpose>normal</Purpose>
    </Picture>
    <Picture>
        <File>pictureB.jpg</File>
        <Purpose>normal</Purpose>
    </Picture>
    <Picture>
        <File>pictureD.jpg</File>
        <Purpose>detail</Purpose>
    </Picture>
</Pictures> 
```

作为 CSV：

```
normal1;normal2;detail1
picture1.jpg;;
;;picture2.jpg;
pictureX.jpg;;pictureY.jpg
pictureA.jpg;pictureB.jpg;pictureD.jpg 
```

我不知道是否可以仅通过使用 XSLT 或如何做到这一点。转换必须快速（一个 XML 可以轻松包含 38k 图片元素）。

如果有人有想法，请发布。先感谢您！

安德烈

# automapper - 在 AutoMapper 中注册自定义通用类型

> ID：15549087
> 
> 赞同：1
> 
> 时间：2013-03-21T13:35:09.440
> 
> 标签：automapper

我想注册自定义泛型类型，例如在 AutoMapper 中注册的默认泛型类型（如列表、数组）。

我在这个代码项目中有一种通用类型：

```
class PagedResult<T>
{
    public List<T> PageOfResults { get; set; }

    public int TotalItems { get; set; }
} 
```

和 Dto 类是：

```
class StudentDto
{
    public int ID { get; set; }
    public string Name { get; set; }
} 
```

和 VM 模型是：

```
class StudentVM
{
    public int ID { get; set; }
    public string Name { get; set; }
} 
```

和服务等级：

```
class MyServie
{
    public PagedResult<StudentDto> Swap()
    {
        var test2 = new PagedResult<StudentDto>();
        test2.PageOfResults = new List<StudentDto>();
        test2.PageOfResults.Add(new StudentDto() { ID = 10, Name = "Ten" });
        test2.TotalItems = 10;

        return test2;
    }
} 
```

我想使用 AutoMapper 对象管理器在 automapper 中注册 PagedResult<> 但我不能这样做

```
var allMappers = MapperRegistry.AllMappers();

MapperRegistry.AllMappers = () => new IObjectMapper[]{
     new IdentifiableMapper(),
}.Concat(allMappers);

var service = new MyServie();
PagedResult<StudentDto> pageableStudentDto = service.Swap();

Mapper.CreateMap<StudentDto, StudentVM>();;

PagedResult<StudentVM> vm = Mapper.Map<PagedResult<StudentDto>, PagedResult<StudentVM>>(pageableStudentDto); 
```

并实施

```
public class PageOfMapper : IObjectMapper
{
    public bool IsMatch(ResolutionContext context)
    {
        return typeof(PagedResult<>).IsAssignableFrom(context.SourceType.GetGenericTypeDefinition()) &&
            typeof(PagedResult<>).IsAssignableFrom(context.DestinationType.GetGenericTypeDefinition());
        //return true;
    }

    public object Map(ResolutionContext context, IMappingEngineRunner mapper)
    {
        // please help me in this code for map ******************

        return null;
    }
} 
```

# java - 如何将文件（image.gif）从我的“.jar”复制到文件夹？

> ID：15549089
> 
> 赞同：4
> 
> 时间：2013-03-21T13:35:21.537
> 
> 标签：java, image, resources

我的 .jar (program.jar/resources/img/image.gif) 中有一个图像，我想在我的 main 开头调用一个方法将它们复制到“C:\folder”。它应该检查文件“C:\folder\image.gif”是否存在，如果不存在，复制它。我已经研究过这个话题，但我找不到办法。这就是我所拥有的，它可以工作......但它会创建一个 0 字节的空文件（image.gif）。它创建**一个**文件，而不是我的 .jar**中的**文件。

### 代码：

```
//MyResources.saveResource("/resources/img/image.gif", "C:\folder", "image.gif");
public static void saveResource(String fromFile, String toFolder, String toFile){
    InputStream stream = MyResources.class.getResourceAsStream(fromFile);
    if (stream == null) {
        //send your exception or warning
    }
    OutputStream resStreamOut;
    int readBytes;
    byte[] buffer = new byte [4096];
    try {
        resStreamOut = new FileOutputStream(new File (toFolder + File.separator + toFile));
        while ((readBytes = stream.read(buffer)) != -1){ //LINE 80
            resStreamOut.write (buffer, 0, readBytes); 
        }
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
} 
```

我也收到一个错误（一个 NullPointerException 解释了为什么文件为空，但我不知道如何解决）：

```
Exception in thread "main" java.lang.NullPointerException at
com.github.CrafterPGSV.Chess.Library.MyResources.saveResource(MyResources.java:80)
at com.github.CrafterPGSV.Chess.Library.MyResources.createFolders(MyResources.java:61)
at com.github.CrafterPGSV.Chess.Chess.main(Chess.java:10) 
```

我主要调用“MyResources.createFolders();” 如果文件夹不存在，则创建该文件夹。在“createFolders”结束时，它调用“saveResources(...)”来保存图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:23:07.777

不知道为什么其他答案被删除，但你`resStreamOut.close()`写完后需要。

您需要实现这种情况时`stream == null`（大概抛出异常）。

*此外，永远不要*捕获和吞下错误：`printStackTrace()`不是错误处理，而是错误忽略。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T11:56:55.870

错误是“saveResource()”的第一行：

```
InputStream stream = this.getClass().getResourceAsStream(fromFile); 
```

在这里，“流”始终为空。这是解决这个问题的方法（使用 Eclipse）：

1.  在**src**中创建一个新**包**（我们称之为*resources*）。

****   在你的**包**中创建一个新**文件夹**（我们称之为*myPictures*）

    ****   如果需要，可以创建更多文件夹。我将在*myPictures 中*创建一个新文件夹，并将其命名为*partyPictures*

    *   选择一个文件夹并将图像（或其他）放入其中。我将在*partyPictures中有一个名为**imageName.jpg的图像*

    **   然后，转到“导航器”，找到您的 Proyect，您会看到有一个名为*bin*的文件夹。在里面，你应该看到你的包被组织在文件夹中。

    *   *在bin*中查找具有您之前创建的包名称的文件夹（我将有一个名为*resources*的文件夹）。在文件夹内，您将看到包内文件夹的树视图（您之前创建的文件夹）。

    *   查找您的文件。（我会寻找*资源/myPictures/partyPictures/imageName.jpg*）

    *   如果不存在，**InputStream stream = this.getClass().getResourceAsStream(fromFile);** 将始终为空。要解决此问题，请将图像（或任何文件）复制到文件夹中。

    *   然后使用

    ```
    String fromFile = "/resources/myPictures/partyPictures/imageName.jpg";
    InputStream stream = this.getClass().getResourceAsStream(fromFile); 
    ```

    *   将字符串**fromFile**更改为文件的路径，并始终以**/**开头。您的代码将如下所示：******* 

 ******String fromFile = **"** **/packageName/folderName/fileName.extension** **"** ;

 ****InputStream 流 = this.getClass().getResourceAsStream(fromFile);

# 应该是这样！***********

# c# - 在没有外部安全策略的本地组中搜索本地用户

> ID：15549091
> 
> 赞同：1
> 
> 时间：2013-03-21T13:35:24.463
> 
> 标签：c#, active-directory, directoryservices

基本上，我找到了一个帖子，可以解决我们在应用程序中遇到的问题，解决方案是：

```
 private static void listGroupMembers(string groupDistinguishedName, PrincipalContext ctx, List<UserPrincipal> users)
{
    DirectoryEntry group = new DirectoryEntry("LDAP://" + groupDistinguishedName);
    foreach (string dn in group.Properties["member"])
    {

        DirectoryEntry gpMemberEntry = new DirectoryEntry("LDAP://" + dn);
        System.DirectoryServices.PropertyCollection userProps = gpMemberEntry.Properties;

        object[] objCls = (userProps["objectClass"].Value) as object[];

        if (objCls.Contains("group"))
            listGroupMembers(userProps["distinguishedName"].Value as string, ctx, users);

        if (!objCls.Contains("foreignSecurityPrincipal"))
        {                    
            UserPrincipal u = UserPrincipal.FindByIdentity(ctx, IdentityType.DistinguishedName, dn);
            if(u!=null)  // u==null for any other types except users
                users.Add(u);
        }
    }                 
} 
```

但是我正在尝试搜索本地组，所以如果我将目录条目更改为：

```
DirectoryEntry groupEntry =
            new DirectoryEntry(string.Format("WinNT://{0}/{1},group", Environment.MachineName, groupName)); 
```

然后它不起作用，它说该属性不存在。除了本地组和用户，我该如何执行上述操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T14:10:30.383

基本上为了解决这个问题，我最终做了：

```
protected bool IsUserInLocalGroup(string userName, string group)
    {
        using (DirectoryEntry computerEntry = new DirectoryEntry("WinNT://{0},computer".FormatWith(Environment.MachineName)))
        using(DirectoryEntry groupEntry = computerEntry.Children.Find(group, "Group"))
        {
            foreach (object o in (IEnumerable)groupEntry.Invoke("Members"))
            {
                using (DirectoryEntry entry = new DirectoryEntry(o))
                {
                    if (entry.SchemaClassName.Equals("User", StringComparison.OrdinalIgnoreCase) && entry.Name.Equals(userName, StringComparison.OrdinalIgnoreCase))
                    {
                        return true;
                    }
                }
            }
            return false;
        }
    } 
```

# jquery - Jquery 文件上传插件：如何在添加时验证文件？

> ID：15549094
> 
> 赞同：13
> 
> 时间：2013-03-21T13:35:39.670
> 
> 标签：jquery, blueimp, jquery-file-upload

```
$('#fileupload')
    .fileupload({
        acceptFileTypes: /(\.|\/)(jpg)$/i
    })
    .on('fileuploadadd', function (e, data) {
        console.log(data.files.valid); //undefined
        setTimeout(function () {
            console.log(data.files.valid); //true or false
        }, 500);
    })
; 
```

[jsFiddle](http://jsfiddle.net/XcgfA/1/)

如何在`data.files.valid`没有超时的情况下获取属性的布尔值？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-11-28T08:16:19.093

我需要使用当前版本的插件（5.39.1）进行验证，这对我有用：

确保在初始化脚本*之后*和*之前*[`jquery.fileupload-process.js`](https://github.com/blueimp/jQuery-File-Upload/blob/master/js/jquery.fileupload-process.js)包含和。[`jquery.fileupload-validate.js`](https://github.com/blueimp/jQuery-File-Upload/blob/master/js/jquery.fileupload-validate.js) *[`jquery.fileupload.js`](https://github.com/blueimp/jQuery-File-Upload/blob/master/js/jquery.fileupload.js)*

 **在您的初始化脚本中添加验证选项并在`fileuploadprocessalways`回调中检查验证：

```
$('.fileinput').fileupload({
    // The regular expression for allowed file types, matches
    // against either file type or file name:
    acceptFileTypes: /(\.|\/)(gif|jpe?g|png)$/i,
    // The maximum allowed file size in bytes:
    maxFileSize: 10000000, // 10 MB
    // The minimum allowed file size in bytes:
    minFileSize: undefined, // No minimal file size
    // The limit of files to be uploaded:
    maxNumberOfFiles: 10
  }).on('fileuploadprocessalways', function (e, data) {
    var currentFile = data.files[data.index];
    if (data.files.error && currentFile.error) {
      // there was an error, do something about it
      console.log(currentFile.error);
    }
  }); 
```

所有验证都是可选的，只是不要留下你不需要的`undefined`。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-29T00:00:59.607

这是您想要执行的操作：

```
$('#fileupload')
    .fileupload({
        acceptFileTypes: /(\.|\/)(jpg)$/i
    })
    .bind('fileuploadadded', function (e, data) {
        console.log(data.files.valid);
    }); 
```

核心 jquery.fileupload.js 文件正在添加您的文件并触发“fileuploadadd”事件，但那是*在*文件验证之前。

文件 jquery.fileupload-ui.js 正在添加文件后进行验证，并在完成后触发另一个“fileuploadadded”事件。

更改事件，一切就绪。

## 请注意：

**该答案在 2013 年 3 月发布时有效且有效。从那时起，这个上传插件似乎发生了变化。这意味着有一个新问题，您应该发布一个新问题（或搜索以查看是否有人已经有），而不是对这个问题投反对票！**

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-19T13:59:03.403

这就是我所做的，它适用于较新的版本：我为每种类型的文件及其大小创建了一个验证。

```
$("#fileUploadArea").fileupload({
        dataType: 'json',
        url:'${upload}',
        multiple:true,
        autoSubmit:false,
        maxNumberOfFiles: Number('${quantidadeMaximaArquivosUpload}'),
        dynamicFormData: function()
        {
            var data ={ 
                    idEntidadeEmpresarial: $('#idEntidadeEmpresarial').val(),
                    idDominioFamilia: $('#idDominioFamilia').val(),
                    idSubgrupo: $('select[id^="subgrupo_').map(function(){return $(this).val();}).get(),
                    descricao: $('#descricao').val(),
                    validade: $('#validade').val()
            }
            return data;
        },
        headers: {
            Accept: "application/json"
        },
        accept: 'application/json',        
        imageMaxWidth: 800,
        imageMaxHeight: 800,
        imageCrop: true ,
        stop: function(){
            $.unblockUI();
            if($('#fechar').is(":checked")){
                window.close();
            }else{
                $('select[id^="subgrupo_').each(function(){
                    $(this).val('');
                    $(this).trigger("chosen:updated");
                })
                $('#validade').val('');
                $('#descricao').val('');
                $('#sucesso').html('');
                $('#sucesso').append('<p><spring:message code="upload.sucesso"/>');
                $('#sucesso').show();
            }
        },
        error: function(files,status,errMsg)
        {
            $('#erro').html('');
            $('#erro').append('<p>'+errMsg+'</p>');
            $('#erro').show();
        },
        acceptFileTypes : ${listaExtensaoPermitidas}
    }).on('fileuploadprocessalways', function (e, data) {
        var currentFile = data.files[data.index];

        var tamanho = currentFile.size;
        var extensao = currentFile.name.substring(currentFile.name.lastIndexOf(".") +1,currentFile.name.length);            

        if(hashExtensao.get(extensao.toUpperCase()) < tamanho){
            alert("file type max size "+hashExtensao.get(extensao.toUpperCase());
            data.abort();
        }

    }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-12T06:06:48.243

我认为可以使用 add 方法。

```
 var fileUploadInit = function() {
    $("#file-upload-form").fileupload({
        dataType: "json",
        url: url,
        add: function (e, data){
            if(validatefunction(data)){
                data.submit();
            } else {
                return false;
            }
        },
        progressall: function (e, data) {
            var progress = parseInt(data.loaded / data.total * 100, 10);
            $('#upload-progress').css('width',progress + '%');
        },
        done: function(e, data) {
            debugger
        },
        processfail: function(e, data){
            debugger
        }

    })
}
var validatefunction = function(data){
    // Do validation here. Return true if everything is correct else return                 false
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-18T13:21:43.043

这就是您想要对较新版本的插件 (9.11.2) 执行的操作：包含以下文件：
- jquery.ui.widget.js
- jquery.iframe-transport.js
- jquery.fileupload.js
- jquery.fileupload -process.js
- jquery.fileupload-validate.js

```
$('#fileupload')
.fileupload({
    acceptFileTypes: /(\.|\/)(jpg)$/i
})
.on('fileuploadadd', function (e, data) {
    console.log('validation object not available at this point. Do not do submit here');
})
.on('fileuploadprocessalways', function (e, data) {
    console.log(data.files.error);//true if error
    console.log(data.files[0].error);//error message
    if(!data.files.error) data.submit(); //do submission here
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-07T05:07:07.603

好吧，@jszbody 的答案是完美的答案。

但是，像我自己一样，如果有人来到这里寻找类似问题的解决方案，用户想知道文件是否未正确添加。

[blueimp jquery-file-upload 在添加失败时不会抛出错误](https://stackoverflow.com/questions/22240450/blueimp-jquery-file-upload-doesnt-throw-error-on-unsuccessful-add)**

# build - TFS 中的“构建”由什么组成？

> ID：15549097
> 
> 赞同：0
> 
> 时间：2013-03-21T13:35:43.157
> 
> 标签：build, tfs

我们目前使用 TFS 2010，但是，它主要 (95%) 用于简单的文件版本控制。

我们目前拥有的大多数项目都是在 Visual Studio 6 中构建和编译的。当我们构建其中一个项目时，我们会在 VS6 中创建一个 DLL，但是，为了执行“完整”构建。

我想知道我是否可以将这些组合成某种带有脚本或其他东西的 TFS“构建”。

编辑：

额外的步骤包括： - 运行另一个程序将文本文件转换为另一种类型的文件（类型无关紧要，更重要的是程序的运行。） - 将项目中的文件检查到 TFS - 滚动一些内部版本号包含在文件夹名称/其他文件中 - 创建项目的 zip 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:41:02.163

这些步骤需要完成哪些？TFS 2012 构建过程可通过模板和自己的编写代码进行自定义，因此实际上您应该能够减少步骤数。可在[此处](http://msdn.microsoft.com/en-us/library/vstudio/ms243782.aspx)找到有关可定制模板的更多信息。

# mysql - 创建连接到 MYSQL 的独立 Matlab 应用程序

> ID：15549110
> 
> 赞同：0
> 
> 时间：2013-03-21T13:36:30.847
> 
> 标签：mysql, matlab, matlab-compiler

我有很多 Matlab 脚本连接到 MYSQL 数据库以检索或更新表。我需要从我制作的 Matlab 脚本中创建一个独立的应用程序。

我想知道是否可以创建一个通过 Matlab 编译器连接到 MYSQL 的独立 MATLAB 应用程序，或者我是否必须找到另一种方法。

如果有替代方案，请您提出建议。

我正在使用带有数据库工具箱的 Matlab 8 来连接 SQL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:29:24.160

是的，您应该能够使用 MATLAB Compiler 从您的 MATLAB 应用程序中创建一个独立的可执行文件。MATLAB Compiler 支持 Database Toolbox，在您的 MATLAB 应用程序中成功运行的任何 MySQL 访问都应该在您的独立可执行文件中运行。

# android - 安卓重量总和

> ID：15549114
> 
> 赞同：0
> 
> 时间：2013-03-21T13:36:36.773
> 
> 标签：android

我已经为一个 1 tablerow 和 layout_weight 定义了 weightsum。这就是我正在做的

```
 <TableRow
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:weightSum="1" >

            <TextView
                android:id="@+id/add"
                android:layout_width="fill_parent"
                android:layout_height="45dp"
                android:layout_weight="0.2"
                android:text="@string/restaurant_add"
                android:textStyle="bold" />

            <TextView
                android:id="@+id/Restaurant_add"
                android:layout_width="fill_parent"
                android:layout_height="45dp"
                android:layout_weight="0.8"
                android:clickable="true" />
        </TableRow> 
```

我正在动态地将数据填充到 Restaurant_add.. 但是当我将数据填充到 Restauant_add 时，即使我将 layout_weight 设置为 0.8，它也会覆盖 android:text="@string/restaurant_add" 中存在的数据。

我在做什么错？

谢谢：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:44:35.823

你可以尝试设置`android:layout_width="0dp"`你的两个 TextView 吗？

此外，您的 TextView 的 id Restaurant_add 与您的字符串 @string/restaurant_add 相同。确保您修改布局而不是您的字符串！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:49:19.577

将你的 android:layout_widths 都设置为“0dp”。

# python - 从 python 应用程序访问 Google Storage

> ID：15549118
> 
> 赞同：2
> 
> 时间：2013-03-21T13:36:47.023
> 
> 标签：python, google-app-engine, google-cloud-storage

我有一个问题，我想访问存储在我的谷歌云存储中的数据，但我有一个错误，我不知道它来自哪里。

这是我的代码：

```
 DECORATOR = oauth2decorator_from_clientsecrets(
        CLIENT_SECRETS,
        scope=[
               'https://www.googleapis.com/auth/devstorage.read_only',
               ],
        message=MISSING_CLIENT_SECRETS_MESSAGE)
    http = DECORATOR.http()
    service_cloud = build("storage", "v1beta1")
    list_response = service_cloud.objects().list(bucket="directory_structure").execute(http=http)

    params = {'directory_list':list_response['items']}
    return self.render_template('directoryChoice.html', **params) 
```

我收到的错误消息是：

```
Traceback (most recent call last): 
File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.5.2/webapp2.py", line 1529, in __call__ rv = self.router.dispatch(request, response) 
File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.5.2/webapp2.py", line 1278, in default_dispatcher return route.handler_adapter(request, response) 
File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.5.2/webapp2.py", line 1102, in __call__ return handler.dispatch() 
File "/base/data/home/apps/s~jba-gae-boilerplate/dev.366111306063368728/boilerplate/lib/basehandler.py", line 162, in dispatch webapp2.RequestHandler.dispatch(self) 
File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.5.2/webapp2.py", line 572, in dispatch return self.handle_exception(e, self.app.debug) 
File "/python27_runtime/python27_lib/versions/third_party/webapp2-2.5.2/webapp2.py", line 570, in dispatch return method(*args, **kwargs) 
File "/base/data/home/apps/s~jba-gae-boilerplate/dev.366111306063368728/web/lib/oauth2client/appengine.py", line 469, in check_oauth return method(request_handler, *args, **kwargs) 
File "/base/data/home/apps/s~jba-gae-boilerplate/dev.366111306063368728/web/handlers.py", line 190, in get list_response = service_cloud.objects().list(bucket="jba_directory").execute(http=http) 
File "/base/data/home/apps/s~jba-gae-boilerplate/dev.366111306063368728/web/lib/oauth2client/util.py", line 120, in positional_wrapper return wrapped(*args, **kwargs) 
File "/base/data/home/apps/s~jba-gae-boilerplate/dev.366111306063368728/web/lib/apiclient/http.py", line 678, in execute raise HttpError(resp, content, uri=self.uri) 
HttpError: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T17:55:04.043

一件事看起来有点奇怪：

在您的代码中，您列出了`directory_structure`存储桶，但回溯引用`jba_directory`. 存在某种不匹配。也许在您在此处包含的代码段上方的包装装饰器或其他代码中？

# javascript - 是否可以触发 DOM 事件并使其在 DOM 树中下降？

> ID：15549122
> 
> 赞同：1
> 
> 时间：2013-03-21T13:36:59.760
> 
> 标签：javascript, jquery, jquery-ui

当前的 dom 事件模型将事件从叶节点（事件的源）传播到顶部根（文档）。

我的问题是：有没有办法向后触发事件？从身体，让它沿着dom到叶子？

我想禁用表单中的所有表单输入。它们都是 jquery ui 小部件。我没有保留对主表单组件中元素的引用，当我提交时，我想禁用所有这些元素。我所有的小部件都绑定到一个名为“field:disable”的自定义 dom 事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:39:36.333

事件只能从叶到根冒泡，反之则不行。

您应该确定所有小部件都具有的公共类，然后手动触发事件：

```
$('.ui-widget').trigger('field:disable'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:41:18.383

jQuery[不支持事件捕获](https://stackoverflow.com/questions/6354079/event-capturing-with-jquery)，所以我认为你被事件冒泡卡住了。

你为什么不做

```
$('#form input').trigger('field:disable') 
```

如果您不想传播事件

```
$('#form input').triggerHandler('field:disable') 
```

# java - 以双精度传递浮点值时的双精度

> ID：15549123
> 
> 赞同：3
> 
> 时间：2013-03-21T13:37:01.143
> 
> 标签：java, floating-point, double

我有关于双精度的问题。当浮点值传递给双精度时，我会得到一些不同的结果。例如

```
float f= 54.23f;
double d1 = f;
System.out.println(d1); 
```

输出为 54.22999954223633。有人可以解释这种行为背后的原因。是否像 double 默认为 14 位小数精度。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T14:52:43.280

相同的值打印不同`float`，`double`因为 Java 规范要求打印尽可能多的数字，以区分相同类型的相邻可表示值的值（根据我[在此处](https://stackoverflow.com/a/13088918/298225)的回答，请参阅[链接文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Float.html#toString%28float%29)以获取更精确的定义）。

由于`float`用于表示值的位更少，因此值也更少，因此它们之间的间距更大，并且您不需要那么多数字来区分它们。当您将值放入 a`double`并打印时，Java 规则要求打印更多的数字，以便将该值与附近的`double`值区分开来。该`println`函数不知道该值最初来自 a`float`并且不包含尽可能多的信息以适合 a `double`。

`54.23f`正好是 54.229999542236328125（十六进制，0x1.b1d70ap+5）。`float`刚好低于和高于此值的值为 54.2299957275390625 (0x1.b1d708p+5) 和 54.23000335693359375 (0x1.b1d70cp+5)。如您所见，打印“54.229999”会将值与 54.229995... 和 54.23... 区分开来。但是，`double`正下方和正上方的值`54.23f`是 54.22999954223632101957264239899814128875732421875 和 54.22999954223633523042735760100185871124267578125。要区分值，您需要“54.22999954223633”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:50:35.760

这是由于[内部代表](http://en.wikipedia.org/wiki/Floating_point_number#Internal_representation)。
浮点数通常作为符号位、指数字段和有效数（尾数）从左到右打包到计算机数据中。

这称为[准确性问题](http://en.wikipedia.org/wiki/Floating_point_number#Accuracy_problems)。
浮点数不能精确地表示所有实数，浮点运算也不能精确地表示真正的算术运算，这一事实导致了许多令人惊讶的情况。这与计算机通常表示数字的有限精度有关。

这不成问题。这就是双重的工作方式。您不必处理它并关心它。double 的精度就足够了。想一想，你的数字和预期结果之间的差异在小数点后的第 14 位。

如果您需要任意良好的精度，请使用`java.math.BigDecimal`该类。

或者，如果您仍想使用双精度。这样做：

```
double d = 5.5451521841;
NumberFormat nf = new DecimalFormat("##.###");
System.out.println(nf.format(d)); 
```

如有任何疑问，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:40:54.913

实际上这只是关于不同的视觉表示或将浮点/双精度转换为字符串。让我们看一下内部二进制表示

```
 float f = 0.23f;
    double d = f;
    System.out.println(Integer.toBinaryString(Float.floatToIntBits(f)));
    System.out.println(Long.toBinaryString(Double.doubleToLongBits(d))); 
```

输出

```
111110011010111000010100011111
11111111001101011100001010001111100000000000000000000000000000 
```

这意味着`f`转换为`d1`没有任何失真，有效数字相同

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T13:47:30.540

这是因为 float 隐藏了多余的小数，而 double 显示了它们。双精度将非常精确地表示实际数字并显示更多数字。

尝试这个：

System.out.println(f.doubleValue()); （当然首先需要使它成为一个*浮点数*）

如您所见，信息就在那里，只是四舍五入。希望这可以帮助

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-21T13:46:47.157

`double`并`float`以不同的格式表示数字。

因此，您一定会发现某些数字可以完美地以一种格式存储，但不能以另一种格式存储。您碰巧找到了一个正确地适合 a`float`但不适合`exactly``double。

当使用两种不同的格式化程序时，也会出现此问题。

# c# - 启用谷歌地图

> ID：15549126
> 
> 赞同：1
> 
> 时间：2013-03-21T13:37:03.847
> 
> 标签：c#, asp.net, google-maps, google-api, google-maps-api-2

我有一个网页，其中包含来自以下位置的地图控件：

（[http://www.codeproject.com/Articles/24468/Google-Maps-Control-for-ASP-NET-Part-1](http://www.codeproject.com/Articles/24468/Google-Maps-Control-for-ASP-NET-Part-1)）

当我从中运行它时，`http://localhost`它执行得很好。当我将它移到我的实际网站时，页面变为空白。这仅用于在本地主机上进行测试还是我还缺少其他任何东西。谁能猜出问题出在哪里？

有没有其他方法可以运行地图

我正在使用 VS2k8

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:52:10.267

对于代码`GoogleMapControl.zip`使用的 Google maps API v2，Google 在本地主机上运行时不会检查 API 密钥，但在其他地方运行时会检查。确保您拥有来自 Google 的[有效 API 密钥](https://developers.google.com/maps/signup)并将其添加到 Web.config：

```
 <appSettings>
    <add key="GoogleAPIKey" value=""/>
  </appSettings> 
```

`Page_Load()`在`SimpleMapWithNoBubble.aspx.cs`该文档的顶部有一条评论。

关于 API 的版本，在`cGoogleMap.cs`：

```
string _apiversion = "2"; 
```

我没有进一步挖掘代码是否写得足够好，您可以更改为 v3，但值得快速尝试。

正如上面的有效 API 密钥链接和下面的评论中所指出的，API 的 v2 已正式贬值，并计划在[2015 年 4 月 20 日](https://developers.google.com/maps/terms#section_4_4)之前停止使用。

# email - 具有高优先级/重要性的 NLog 电子邮件目标

> ID：15549139
> 
> 赞同：0
> 
> 时间：2013-03-21T13:37:40.680
> 
> 标签：email, nlog

我最近将电子邮件目标日志级别从错误更改为警告一级。这是为了捕获一些重要的用户操作，这些操作不是应用程序级别的错误，而是用户输入错误，我不将其归类为错误，因此将它们记录为警告。

所以在我的主题中我改变了

```
subject="NLog Error Message from PoppyService on ${machinename}" 
```

到

```
subject="NLog ${level} Message from PoppyService on ${machinename}" 
```

所以我会根据日志级别得到不同的主题，但是有没有办法让电子邮件仅对错误日志级别具有高重要性？我想，我将不得不创建第二个邮件目标，一个用于错误，一个用于警告，但我找不到如何将电子邮件的优先级更改为高。

[http://nlog-project.org/wiki/Mail_target](http://nlog-project.org/wiki/Mail_target)中没有显示方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T23:08:21.677

不幸的是，在当前版本的 NLog 中没有办法在不创建自定义目标的情况下执行此操作。

# wordpress - 是否可以在 woocomerce 插件 wordpress 的单个产品页面上添加联系表？

> ID：15549140
> 
> 赞同：2
> 
> 时间：2013-03-21T13:37:41.607
> 
> 标签：wordpress, woocommerce

我使用 woocomerce wordpress 插件。我不使用检查和购物车功能，只想使用 woocomerce 作为带有价格的目录。因此，当用户看到我想要的产品时，他可以就该产品与我们联系。是否可以在 woocomerce 插件 wordpress 的单个产品页面上添加联系表？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T16:00:24.957

是的，可以使用产品查询表单插件： [http ://www.woothemes.com/products/product-enquiry-form/](http://www.woothemes.com/products/product-enquiry-form/)

它在产品页面中添加了一个带有查询表的选项卡

# angularjs - 如何单击一个按钮并专注于angularjs中的另一个输入？

> ID：15549141
> 
> 赞同：2
> 
> 时间：2013-03-21T13:37:42.650
> 
> 标签：angularjs, focus

单击 angularjs 中的按钮时，我不知道如何专注于输入。

我创建了一个不能在这里工作的简单演示： http: [//plnkr.co/edit/NS0jJE9ttakNm8nc6QkZ ?p=preview](http://plnkr.co/edit/NS0jJE9ttakNm8nc6QkZ?p=preview)

这是主要代码：

```
app.controller('MainCtrl', function($scope, $element) {
  $scope.name = 'World';
  $scope.myfocus = function(){
    $element.find("#myinput").???? // what to do here?
  }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:49:07.697

您需要在加载 Angular**之前**加载 jquery。

请参阅此更新的 plunker，加载顺序已更改，并且对您尝试聚焦元素的方式进行了一些更改[http://plnkr.co/edit/PLi1BiI83GKdAvSGufCP](http://plnkr.co/edit/PLi1BiI83GKdAvSGufCP)

而这个先前提出的问题[错误：“选择器未实现”](https://stackoverflow.com/questions/13480796/error-selectors-not-implemented)

并且 fastreload 关于不处理控制器中的 DOM 是正确的。

[http://docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)

# c# - DataGridView 选定单元格默认颜色

> ID：15549143
> 
> 赞同：7
> 
> 时间：2013-03-21T13:37:47.110
> 
> 标签：c#, winforms, datagridview, colors, rgb

有谁知道 DataGridView 的选定单元格背景颜色的 RGB 代码。我目前正在尝试使某些单元格看起来是空白的，直到满足某个条件。处理“未选择”`ForeColor`很容易，因为它只需要`Color.White`. 但处理`SelectionForeColor`并不是最简单的。我找到的最接近的默认颜色是`Color.DodgerBlue`.

我已经引用了这个[网站](http://www.flounder.com/csharp_color_table.htm)，但在提供的颜色方面，我似乎不走运。

下面是我指的颜色。

![在此处输入图像描述](../Images/d2c019b5828d42406acd771db06e3f7b.png)

我觉得必须有一种方法可以访问此属性？但是怎么做？提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-25T14:00:24.107

我正在寻找的颜色是：`SystemColors.Highlight`。

如果你去你的对象的`Properties`部分。`DataGridView`有一个名为的属性，在该属性`DefaultCellStyle`下有一个名为`Appearance`该`SelectionBackColor`属性所在的部分。的默认值`SelectionBackColor`是`Highlight`在`System.Drawing.SystemColors`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T13:44:02.707

一个可以尝试的属性是`DataGridView.RowsDefaultCellStyle.SelectionBackColor`，尽管您可能更感兴趣`DataGridViewCell.InheritedStyle.SelectionBackColor`。

# ruby-on-rails - WickedPDF - 找不到没有 ID 的用户

> ID：15549149
> 
> 赞同：0
> 
> 时间：2013-03-21T13:37:57.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3, wicked-pdf

我有 WickedPDF 在我的应用程序中工作，并正在尝试将 PDF 添加为附件。我[从视图中看到了以下 SO 问题 Rails 3 -Render PDF 并附加到电子邮件](https://stackoverflow.com/questions/5762583/rails-3-render-pdf-from-view-and-attach-to-email/5813394#5813394)，并且正在关注 Unixmonkey 的答案。我有以下设置：

**控制器**

```
 def overtime
    @hospital_bookings = HospitalBooking.scoped
    hospital_booking = @hospital_bookings
    @user = User.find(params[:id]) 
```

我相信上述内容应该根据 SO question 起作用。但是我得到了`ActiveRecrod::RecordNotFound - Couldn't find User without an ID`。

**更新**

**路线**

```
`get "overtime" => "hospital_bookings#overtime", :as => "overtime" ` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:06:14.683

在控制器的以下行中：

```
@user = User.find(params[:id]) 
```

您似乎没有`id`在路线中传递参数。根据您的身份验证模型，您需要使用`current_user`或传递`id`给您的路由。

# c# - 键盘状态和布局

> ID：15549160
> 
> 赞同：0
> 
> 时间：2013-03-21T13:38:33.800
> 
> 标签：c#, windows, input, keyboard, interop

我在 c# 中使用互操作获取键盘状态

```
[DllImport("user32.dll")]
[return: MarshalAs(UnmanagedType.Bool)]
static extern bool GetKeyboardState(byte[] lpKeyState); 
```

我的问题是，显然当我切换键盘布局（即从 QWERTY 到 Dvorak 时`Ctrl-Shift`）该函数`GetKeyboardState`返回不同的虚拟键码。有没有办法根据实际键盘制造商使用的布局简单地获取键码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:57:15.067

您需要将虚拟键码映射到键盘扫描码。请参阅[MapVirtualKeyEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646307%28v=vs.85%29.aspx)。

# mobile - 如何在 ubuntu Touch 设备上安装应用程序

> ID：15549164
> 
> 赞同：5
> 
> 时间：2013-03-21T13:38:42.443
> 
> 标签：mobile, ubuntu, touch, ubuntu-touch

我一直在研究 Ubuntu Touch。

[所以我按照此处](https://wiki.ubuntu.com/Touch/Install)的说明在 Nexus 10 上安装了 ubuntu

[我按照此处](http://developer.ubuntu.com/get-started/gomobile/)的说明构建了示例应用程序

所以现在我有一个运行 ubuntu touch 的设备和一个应用程序，我如何将应用程序放在设备上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T04:33:49.990

您可以使用**Qt Creator**：通过 USB 连接您的 Ubuntu Touch Device 打开您的项目，然后只需按`Ctrl+F12`。

这仅在您曾经在设备上安装过 ssh-server 时才有效。

或者，您可以**手动**进行。将必要的文件（*.qml 和 *.desktop）复制到设备并通过 ssh 启动应用程序

```
qmlscene --desktop_file_hint=/usr/share/applications/qmlscene.desktop YourApp.qml 
```

[来源](https://wiki.ubuntu.com/Touch/ReleaseNotes#Ubuntu_SDK_Alpha)

请记住，这都是测试版，如果您不是开发人员，那么在这个阶段您不会对 Ubuntu Touch 有太多用处。最终，Ubuntu Touch 将拥有自己的应用程序商店，下载应用程序并将其安装在您的设备上会变得更加容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-23T16:42:53.973

如果您使用的是 Ubuntu 提供的 sdk，那么您所要做的就是：

> 构建 -> Ubuntu Touch -> 在设备上安装应用程序

这将实际安装应用程序，而不仅仅是运行它。现在您可以随身携带原型 =)

# excel - 条件数据透视表过滤（如果选择了一个，则禁用另一个）

> ID：15549165
> 
> 赞同：1
> 
> 时间：2013-03-21T13:38:45.850
> 
> 标签：excel, excel-formula, vba

正如标题所说，如果选择了另一个，我正在尝试禁用或将相反的过滤器默认为“全部”。

例如，我有一个带有两个过滤器的数据透视表 - “WEEK”和“MONTH”

如果有人在周过滤器中选择一个值，我希望月过滤器默认为“（全部）”，反之亦然。

很简单，但我不确定如何攻击这个（VBA 或公式）以及代码。

多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:40:00.393

不幸的是，没有任何事件可以跟踪可透视字段的更改。因此我的想法如下。步骤 1\. 将公共变量放在某处：

```
Public tmpM As Boolean
Public tmpW As Boolean 
```

第 2 步。 在放置数据透视表的工作表模块中，输入以下代码：

```
Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)
On Error GoTo ErrorHandler
Application.EnableEvents = False

If Target.PivotFields("week").AllItemsVisible = False And tmpW = True Then
    Target.PivotFields("month").ClearAllFilters
End If
If Target.PivotFields("month").AllItemsVisible = False And tmpM = True Then
    Target.PivotFields("week").ClearAllFilters
End If
tmpM = Target.PivotFields("month").AllItemsVisible
tmpW = Target.PivotFields("week").AllItemsVisible

Application.EnableEvents = True

Exit Sub
ErrorHandler:
Application.EnableEvents = True
End Sub 
```

它适用于我的示例数据。

**编辑：**上面代码中的错误处理。

# join - 将两个集合“加入”

> ID：15549169
> 
> 赞同：1
> 
> 时间：2013-03-21T13:39:02.093
> 
> 标签：join, collections, meteor

我想知道这种使用“观察”的方法是否仍然是实现两个集合之间连接的推荐方法。

[Meteor 和 DBRefs](https://stackoverflow.com/questions/11244286/meteor-and-dbrefs#answers-header)

谢谢，文德伯格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T16:49:20.970

在第一次流星聚会上，我问了一位核心开发人员这个问题。不幸的是，答案是肯定的。使用`observe`是目前实现连接的唯一方法，但是有人告诉我将在 1.0 之前添加一个解决方案。我希望我有更多的信息。就我个人而言，我认为缺少内置连接是流星最大的缺失功能之一，但我没有看到人们对此大肆宣传。

# ios - iOS UICollectionView 在开始时滚动滞后

> ID：15549173
> 
> 赞同：0
> 
> 时间：2013-03-21T13:39:11.237
> 
> 标签：ios, scroll, uicollectionview, smooth

在我的项目中，我在 ma iOS 中使用了一个简单的 UICollectionView。

该视图加载了大约 100 个单元格。即使让单元格为空，也会出现问题。

在 ViewDidLoad 之后出现 Collection 视图。当我开始对前三个屏幕页面进行 Scolling 时，它会滞后 - 即使是空单元格！

之后我变得光滑。我也可以到页面顶部再试一次。滚动保持流畅。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-04T21:46:34.403

# 您可能还会遇到的 2 个原因

## 1.谷歌分析

如果您设置为计算每个单元格视图。它开始很快，但随后变慢并滞后，因为当您滚动太快时，谷歌分析会写入 i/o（可能是一些缓存）。

## 2.日期时间解析

如果您为每个单元格设置 DateFormatter，则很难。如果可能，请确保您有一个单身人士。

# ruby-on-rails - 基于一个字段选择不同的记录，同时保持其他字段不变

> ID：15549174
> 
> 赞同：6
> 
> 时间：2013-03-21T13:39:11.850
> 
> 标签：ruby-on-rails, activerecord

我有一张这样的桌子：

```
 table: searches
+------------------------------+
| id  |   address   |   date   |
+------------------------------+
| 1   | 123 foo st  | 03/01/13 |
| 2   | 123 foo st  | 03/02/13 |
| 3   | 456 foo st  | 03/02/13 |
| 4   | 567 foo st  | 03/01/13 |
| 5   | 456 foo st  | 03/01/13 |
| 6   | 567 foo st  | 03/01/13 |
+------------------------------+ 
```

并想要一个这样的结果集：

```
+------------------------------+
| id  |   address   |   date   |
+------------------------------+
| 2   | 123 foo st  | 03/02/13 |
| 3   | 456 foo st  | 03/02/13 |
| 4   | 567 foo st  | 03/01/13 |
+------------------------------+ 
```

但是 ActiveRecord 似乎无法达到这个结果。这是我正在尝试的：

*   模型有一个 'most_recent' 范围：`scope :most_recent, order('date_searched DESC')`
*   `Model.most_recent.uniq`返回完整集（`SELECT DISTINCT "searches".* FROM "searches" ORDER BY date DESC`）——显然查询不会做我想要的，但也不会只选择一列。我需要*所有列*，但只需要`address`结果集中唯一的行。
*   我可以做类似的事情`Model.select('distinct(address), date, id')`，但感觉......错了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T13:51:14.510

你可以做一个

```
select max(id), address, max(date) as latest 
       from searches 
       group by address 
       order by latest desc 
```

根据[sqlfiddle](http://sqlfiddle.com/#!2/73084/1/0)，这正是我认为你想要的。

它与您的需求输出不太一样，它似乎并不关心返回哪个ID。不过，查询需要指定一些东西，这里是由“max”聚合函数完成的。

对于这种情况，我认为 ActiveRecord 的自动生成查询方法不会让您有任何运气。因此，只需使用该 SQL 将您自己的查询方法添加到您的模型类中。它是完全标准的 SQL，基本上也可以在任何其他 RDBMS 上运行。

**编辑：**查询的一大弱点是它不一定返回实际记录。如果给定地址的最高 ID 与该地址的最高日期不相关，则生成的“记录”将与实际存储在数据库中的不同。取决于可能重要或不重要的用例。对于 Mysql，只需更改`max(id)`为即可`id`解决该问题，但 IIRC Oracle 对此存在问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-08T23:52:51.113

要显示唯一地址：

```
Searches.group(:address) 
```

然后，您可以根据需要选择列：

```
Searches.group(:address).select('id,date') 
```

# codeigniter - Codeigniter ion_auth 重定向到 ?auth/login 循环

> ID：15549175
> 
> 赞同：0
> 
> 时间：2013-03-21T13:39:12.323
> 
> 标签：codeigniter, ion-auth

我是`ion_auth`第一次设置，当我从登录屏幕单击提交时，它会将 URL 重定向`baseurl/auth/login`到`baseurl/?auth/login`并陷入循环。任何想法为什么该问号附加到前面？

谢谢！

# asp.net - 为什么我的 gridview 的分页不起作用

> ID：15549183
> 
> 赞同：1
> 
> 时间：2013-03-21T13:39:44.750
> 
> 标签：asp.net, gridview, pagination

我在不同的页面上有两个gridviews，代码几乎相同，一个正在工作，但另一个没有......

这是不工作的代码：

```
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder2" runat="server">
   <asp:UpdatePanel ID="UpdatePanel1" runat="server">
   <ContentTemplate>
     <asp:ScriptManager ID="ScriptManager1" runat="server" EnableScriptGlobalization="true" EnableScriptLocalization="true" EnablePartialRendering= "true">
     </asp:ScriptManager>
        <div id="gridview">
          <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" style="font-family: Verdana, Arial, Sans-Serif;" 
           DataKeyNames="id"
           CssClass="gridview" BackColor="#CCCCCC" 
           BorderStyle="Inset" BorderWidth="2px" BorderColor="GrayText"
           CellPadding="1"
           CellSpacing="5"
           HeaderStyle-HorizontalAlign="Center"
           OnRowDataBound="GridView1_RowDataBound"
           ForeColor ="Black" RowStyle-CssClass="gridview"
           OnRowCommand="GridView1_RowCommand"
           ViewStateMode="Enabled" AllowPaging="True" 
           OnPageIndexChanging="GridView1_PageIndexChanging" PageSize="3">
           <AlternatingRowStyle BackColor="LightGray" />
             <columns>

               <asp:BoundField HeaderText="ID" DataField="id"  />
               <asp:BoundField HeaderText="PRIORIDADE" DataField="prioridade" 
                        ItemStyle-HorizontalAlign="Center" >
               <ItemStyle HorizontalAlign="Center" />
               </asp:BoundField>
               <asp:BoundField HeaderText="SITUAÇÃO"  DataField="situacao" 
                        ItemStyle-HorizontalAlign="Center" >
               <ItemStyle HorizontalAlign="Center" />
               </asp:BoundField>
               <asp:BoundField HeaderText="RESPONSAVEL" DataField="responsavel" 
                        HeaderStyle-Width="65px" ItemStyle-HorizontalAlign="Center" >
               <HeaderStyle Width="65px" />
               <ItemStyle HorizontalAlign="Center" />
               </asp:BoundField>
               <asp:BoundField HeaderText="DATA DE CADASTRO" DataField="dt_cadastro" 
                        DataFormatString="{0:dd/MM/yyyy}" HeaderStyle-Width="60px" 
                        ItemStyle-HorizontalAlign="Center" >
               <HeaderStyle Width="60px" />
               <ItemStyle HorizontalAlign="Center" />
               </asp:BoundField>
               <asp:BoundField HeaderText="PREVISÃO DE TÉRMINO" DataField="previsao_termino" 
                        DataFormatString="{0:dd/MM/yyyy}" HeaderStyle-Width="80px" 
                        ItemStyle-HorizontalAlign="Center" >
              <HeaderStyle Width="80px" />
              <ItemStyle HorizontalAlign="Center" />
              </asp:BoundField>
              <asp:BoundField HeaderText="PROJETO" DataField="projeto"  
                        ItemStyle-HorizontalAlign="Center" >          
                        <ItemStyle HorizontalAlign="Center" />
              </asp:BoundField>
              <asp:BoundField HeaderText="FUNCIONALIDADE" DataField="funcionalidade" 
                        ItemStyle-HorizontalAlign="Center" >
              <ItemStyle HorizontalAlign="Center" />
              </asp:BoundField>
              <asp:BoundField HeaderText="CLUBE" DataField="clube" 
                        ItemStyle-HorizontalAlign="Center" >

              <ItemStyle HorizontalAlign="Center" />
              </asp:BoundField>

              <asp:TemplateField HeaderStyle-Width="70px" HeaderText="VISUALIZAR" >
                 <ItemTemplate>
                     <asp:Button ID="Btn_Visualizar" runat="server" Text="VISUALIZAR" CssClass="Btn_Grid"  Font-Size="7pt" Font-Names="Verdana, Arial"
                            CommandName="visualizar" CommandArgument="<%# ((GridViewRow)Container).RowIndex %>" />                            
                  </ItemTemplate>
                   <HeaderStyle Width="70px" />
              </asp:TemplateField>
              <asp:TemplateField HeaderStyle-Width="66px" HeaderText="ALTERAR">
                   <ItemTemplate>
                       <asp:Button ID="Btn_Alterar" runat="server" Text="ALTERAR" CssClass="Btn_Grid" Font-Size="7pt" Font-Names="Verdana, Arial"
                            CommandName="editar" CommandArgument="<%# ((GridViewRow)Container).RowIndex %>" />
                   </ItemTemplate>
                   <HeaderStyle Width="66px" />
               </asp:TemplateField>
        </columns>
            <EditRowStyle ForeColor="Black" CssClass="GridViewEditRow" />
            <FooterStyle BackColor="#CCCCCC" />
            <HeaderStyle BackColor="Black" Font-Bold="True" ForeColor="White" BorderColor="White" BorderStyle="Solid" BorderWidth="1px" />
            <PagerStyle BackColor="#6600FF" ForeColor="Black" HorizontalAlign="Left" 
                    Font-Size="8pt" />
            <RowStyle BackColor="White" />
            <SelectedRowStyle BackColor="#000099" Font-Bold="True" ForeColor="White" />      
            </asp:GridView>
    </div>
    </ContentTemplate>
</asp:UpdatePanel>
</asp:Content> 
```

这是我的`codebehind`：

```
protected void Page_Load(object sender, EventArgs e)
 {
   if (Session["login"] == null)
      {
         Response.Redirect("~/Login.aspx");
      }
   else
      {
         if (!Page.IsPostBack)
            {
              GridView1.DataSource = _ch.BuscaChamadosAtivos();
              GridView1.DataBind();
            }
       }
 }

protected void GridView1_PageIndexChanging(object sender, GridViewPageEventArgs e)
        {
            GridView1.PageIndex = e.NewPageIndex;
            GridView1.DataSource = _ch.BuscaChamadosAtivos();            
            GridView1.DataBind();
        } 
```

即使`numbers of the pagging`没有出现...

Obs：其中两个字段将`ALWAYS`变为空......这可能会导致我这个问题吗？我不这么认为……但我还是说了。

# php - codeigniter 中数组的大小，原生 PHP 函数支持

> ID：15549190
> 
> 赞同：1
> 
> 时间：2013-03-21T13:40:16.343
> 
> 标签：php, codeigniter

根据文档，我尝试使用以下代码在 codeigniter 中查找数组的大小

```
 echo element('size', $get, NULL); 
```

但它最终显示以下错误

```
( ! ) Fatal error: Cannot use object of type stdClass as array in C:\wamp\www\cinifb_ci\system\helpers\array_helper.php on line 46 
```

我试图将 的内容加载`$get`到另一个数组变量中，但它继续显示上述错误。

请建议我解决这个问题的替代方法。

我尝试使用原生 PHP 解决方案，例如

```
echo size_array($get); 
```

但它最终在

```
Fatal error: Call to undefined function size_array() 
```

**这是否意味着我不应该在 CodeIgniter 中使用原生 PHP 函数**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T13:45:32.377

```
count($array); 
```

这是获取数组大小的本机函数；）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T14:23:51.567

在 CodeIgniter 中，这个表达式：

```
element('size', $get, null) 
```

只有当它`$get`是一个数组**并且**它有一个索引时才有效`'size'`；如果它是一个数组，则更有可能是您的意思：

```
count($get); 
```

但是，在您的情况下，确切地说，`$get`实际上是一个对象；`stdClass`确定该对象的大小需要另一个步骤：

```
count(get_object_vars($get)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-29T20:36:12.723

例子：

```
$completed_requests = $this->db->where('status' => SOLICITACAO_FINALIZADA)
                                       ->where('trip_occurred' => OCORREU)
                                       ->count_all_results('transport_requests'); 
```

> **->count_all_results('TABLE_NAME');**

# php - Joomla 3.0 自定义模块：在 ajax 提交表单上上传文件

> ID：15549191
> 
> 赞同：1
> 
> 时间：2013-03-21T13:40:22.837
> 
> 标签：php, file, joomla, upload

目前我正在开发一个自定义模块，其中包含一个表单并“通过”ajax 提交。

场

```
<input type="file" id="file" name="file" accept="image/*" disabled="disabled" /> 
```

ajax提交（带json）

```
$.ajax({
        type: "POST",
        url: "modules/mod_custom_form/submit_form.php",
        data: dataString,
        dataType: "JSON",
        timeout: 6000,
        success: function(response) {
            // on success
            if (response.success === 1) {                
                  $('#customForm').html("<div id='message'></div>"); 
              $('#message').html("<h2>Form sent!</h2>")
              .append("<p>More text.</p>")
              .hide()
              .fadeIn(1500, function() {
                $('#message').append("<img id='checkmark' src='modules/mod_custom_form/images/check-icon.png' />");
              }); 
            } 
            // on failure
            else {
                $('#customForm').html("<div id='message'></div>"); 
              $('#message').html("<h2>Failure.</h2>");
            }
        }
      }); 
```

submit_form.php 文件

```
// no direct access
define('_JEXEC', 1);
define( 'DS', DIRECTORY_SEPARATOR );
define( 'JPATH_BASE', $_SERVER[ 'DOCUMENT_ROOT' ] );

require_once( JPATH_BASE . DS . 'includes' . DS . 'defines.php' );
require_once( JPATH_BASE . DS . 'includes' . DS . 'framework.php' );
require_once( JPATH_BASE . DS . 'libraries' . DS . 'joomla' . DS . 'factory.php' );
$mainframe =& JFactory::getApplication('site');

// sender email
$email = 'maarten@mail.com';
$subject = 'Aanvraag';
// create the header array
$headers   = array();
$headers[] = "MIME-Version: 1.0";
$headers[] = "Content-type: text/html; charset=iso-8859-1";
$headers[] = "From: beheer <maarten@mail.com>";
$headers[] = "Bcc: beheer <maarten@mail.com>";
$headers[] = "Reply-To: Recipient Name <receiver@domain3.com>";
$headers[] = "Subject: {$subject}";
$headers[] = "X-Mailer: PHP/" . phpversion();

// get all posted data and put them in variables
$bedrijfsnaam = $_POST['bedrijfsnaam'];
$_FILES = $_POST['uploaded_file'];

// create the full message
$message = 'email';

// send mail
if (mail($to, $subject, $message, implode("\r\n", $headers))) {
    //save file function
    getInput($_FILES);
    // return message
    echo json_encode(array('success' => 1));
    // insert the email into the database
    $database =& JFactory::getDBO();
    $query = "INSERT INTO #__email_forms (mid, email, message) VALUES ('2', 'myemail@mail.com', '$message')";
    $database->setQuery($query);
    $database->query();
}
else {
    echo json_encode(array('success' => 0));
} 
```

我将如何实现上传文件并使用 ajax 保存表单的可能性？我一直在寻找几个小时，但到目前为止还没有找到任何有用的东西。

提前感谢您的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T19:44:28.833

文件的 Ajax 上传是一件棘手的事情，尤其是当您涉及会话数据以确保实际允许用户上传时。当它是公共上传时，它变得更加危险，因为您需要做更多的服务器端验证。

我通常用于 ajax 上传的是 Ajax File Uploader by valums：[https ://github.com/valums/file-uploader](https://github.com/valums/file-uploader)

运行起来非常简单，并且它有一个 jQuery 插件，使它更简单（因为你已经在使用 jQuery）。

# joomla - 在类别 joomla 2.5 中时标题不会改变

> ID：15549192
> 
> 赞同：-1
> 
> 时间：2013-03-21T13:40:22.913
> 
> 标签：joomla

我使用joomla 2.5创建了一个网站我创建了一个项目：shop我走出主页，然后点击链接类别：shop这个页面的标题，与主页的标题相同：Home if now I想要，页眉类别：商店“商店”我该怎么做

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:43:35.597

我不确定我理解你的问题是否正确。但是你可能想看看菜单项参数。在右侧有一个名为“页面显示选项”的滑块。这允许为浏览器选项卡和页面标题指定标题。在“SEO 设置”部分的“站点”选项卡中的 Joomla 全局配置中还有一个参数，名为“在页面标题中包含站点名称”。这允许指定是否应将站点名称添加到页面标题。

希望对您有所帮助，否则请说明您的问题。

# c# - 是否可以在 mvvm 模式中获取 wpf 数据网格上的动态列？

> ID：15549193
> 
> 赞同：13
> 
> 时间：2013-03-21T13:40:23.983
> 
> 标签：c#, wpf, mvvm, datagrid

我正在用 wpf 开发产品（使用 MVVM 模式）。根据用户的自定义（用户选择列），我必须将一组数据显示到数据网格中。目前我正在将一`ObservableCollection`组属性绑定到`ItemSource`数据网格的。这将我限制在固定的列大小。

注意：列出了 n 个列名称供用户选择。

如果它在后面的代码中完成，那么“datagrid.columns.add()”很容易。在这种情况下，任何人都可以帮助我。

我的xml：

```
<my:DataGrid
    AutoGenerateColumns="False"
    Margin="357,121.723,82,41"
    Name="dataGrid3"
    c:DataGridExtension.Columns="{Binding ColumnCollection}"
    /> 
```

我的命令类：

```
public static class DataGridExtension
{
    public static ObservableCollection<DataGridColumn> GetColumns(DependencyObject obj)
    {
        return (ObservableCollection<DataGridColumn>)obj.GetValue(ColumnsProperty);
    }

    public static void SetColumns(
        DependencyObject obj, ObservableCollection<DataGridColumn> value)
    {
        obj.SetValue(ColumnsProperty, value);
    }

    public static readonly DependencyProperty ColumnsProperty = 
        DependencyProperty.RegisterAttached(
            "Columns",
            typeof(ObservableCollection<DataGridColumn>),typeof(DataGridExtension),
         new UIPropertyMetadata(new ObservableCollection<DataGridColumn>(),
            OnDataGridColumnsPropertyChanged));

    private static void OnDataGridColumnsPropertyChanged(DependencyObject d,
           DependencyPropertyChangedEventArgs e)
    {
        if (d.GetType() == typeof(DataGrid))
        {
            DataGrid myGrid = d as DataGrid;

            var Columns = (ObservableCollection<DataGridColumn>)e.NewValue;

            if (Columns != null)
            {
                myGrid.Columns.Clear();

                if (Columns != null && Columns.Count > 0)
                {
                    foreach (DataGridColumn dataGridColumn in Columns)
                    {
                        myGrid.Columns.Add(dataGridColumn);
                    }
                }

                Columns.CollectionChanged +=
                    (object sender, NotifyCollectionChangedEventArgs args)
                {
                    if (args.NewItems != null)
                    {
                        //foreach (DataGridColumn column in args.NewItems.Cast<DataGridColumn>())
                        //    myGrid.Columns.Add(column);
                    }

                    if (args.OldItems != null)
                    {
                        //foreach (DataGridColumn column in args.OldItems.Cast<DataGridColumn>())
                        //    myGrid.Columns.Remove(column);
                    }
                };
            }
        }
    }
} 
```

和我在视图模型中的属性：

```
private ObservableCollection<DataGridColumn> _columnCollection =
    new ObservableCollection<DataGridColumn>();

public ObservableCollection<DataGridColumn> ColumnCollection
{
    get
    {
        return this._columnCollection;
    }
    set
    {
        _columnCollection = value;
        base.OnPropertyChanged("ColumnCollection");
        //Error
        //base.OnPropertyChanged<ObservableCollection<DataGridColumn>>(
        //   () => this.ColumnCollection);
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-22T13:47:46.263

谢谢你的努力家伙......终于我找到了解决方案......

这里它..（完整的 wpf mvvm）

在我的命令文件中：

```
public class DataGridColumnsBehavior
    {
        public static readonly DependencyProperty BindableColumnsProperty =
            DependencyProperty.RegisterAttached("BindableColumns",
                                                typeof(ObservableCollection<DataGridColumn>),
                                                typeof(DataGridColumnsBehavior),
                                                new UIPropertyMetadata(null, BindableColumnsPropertyChanged));
        private static void BindableColumnsPropertyChanged(DependencyObject source, DependencyPropertyChangedEventArgs e)
        {
            DataGrid dataGrid = source as DataGrid;
            ObservableCollection<DataGridColumn> columns = e.NewValue as ObservableCollection<DataGridColumn>;
            dataGrid.Columns.Clear();
            if (columns == null)
            {
                return;
            }
            foreach (DataGridColumn column in columns)
            {
                dataGrid.Columns.Add(column);
            }
            columns.CollectionChanged += (sender, e2) =>
            {
                NotifyCollectionChangedEventArgs ne = e2 as NotifyCollectionChangedEventArgs;
                if (ne.Action == NotifyCollectionChangedAction.Reset)
                {
                    dataGrid.Columns.Clear();
                    if (ne.NewItems != null)
                    {
                        foreach (DataGridColumn column in ne.NewItems)
                        {
                            dataGrid.Columns.Add(column);
                        }
                    }
                }
                else if (ne.Action == NotifyCollectionChangedAction.Add)
                {
                    if (ne.NewItems != null)
                    {
                        foreach (DataGridColumn column in ne.NewItems)
                        {
                            dataGrid.Columns.Add(column);
                        }
                    }
                }
                else if (ne.Action == NotifyCollectionChangedAction.Move)
                {
                    dataGrid.Columns.Move(ne.OldStartingIndex, ne.NewStartingIndex);
                }
                else if (ne.Action == NotifyCollectionChangedAction.Remove)
                {
                    if (ne.OldItems != null)
                    {
                        foreach (DataGridColumn column in ne.OldItems)
                        {
                            dataGrid.Columns.Remove(column);
                        }
                    }
                }
                else if (ne.Action == NotifyCollectionChangedAction.Replace)
                {
                    dataGrid.Columns[ne.NewStartingIndex] = ne.NewItems[0] as DataGridColumn;
                }
            };
        }
        public static void SetBindableColumns(DependencyObject element, ObservableCollection<DataGridColumn> value)
        {
            element.SetValue(BindableColumnsProperty, value);
        }
        public static ObservableCollection<DataGridColumn> GetBindableColumns(DependencyObject element)
        {
            return (ObservableCollection<DataGridColumn>)element.GetValue(BindableColumnsProperty);
        }
    } 
```

在我的xml中：

```
<my:DataGrid AutoGenerateColumns="False" Margin="357,121.723,82,41" Name="dataGrid3" ItemsSource="{Binding Path=Datatable}" c:DataGridColumnsBehavior.BindableColumns="{Binding ColumnCollection}" /> 
```

最后在我的视图模型中：

```
private ObservableCollection<DataGridColumn> _columnCollection = new ObservableCollection<DataGridColumn>();
        public ObservableCollection<DataGridColumn> ColumnCollection
        {
            get
            {
                return this._columnCollection;
            }
            set
            {
                _columnCollection = value;
                base.OnPropertyChanged("ColumnCollection");
                //Error
                //base.OnPropertyChanged<ObservableCollection<DataGridColumn>>(() => this.ColumnCollection);
            }
        }
        private DataTable _datatable = new DataTable();
        public DataTable Datatable
        {
            get
            {
                return _datatable;
            }
            set
            {
                if (_datatable != value)
                {
                    _datatable = value;
                }
                base.OnPropertyChanged("Datatable");
            }
        } 
```

在我的构造函数中：

```
public MainViewModel()
        {
Datatable.Columns.Add("Name",typeof(string));
            Datatable.Columns.Add("Color", typeof(string));
            Datatable.Columns.Add("Phone", typeof(string));
            Datatable.Rows.Add("Vinoth", "#00FF00", "456345654");
            Datatable.Rows.Add("lkjasdgl", "Blue", "45654");
            Datatable.Rows.Add("Vinoth", "#FF0000", "456456");
System.Windows.Data.Binding bindings = new System.Windows.Data.Binding("Name");
            System.Windows.Data.Binding bindings1 = new System.Windows.Data.Binding("Phone");
            System.Windows.Data.Binding bindings2 = new System.Windows.Data.Binding("Color");
            DataGridTextColumn s = new DataGridTextColumn();
            s.Header = "Name";
            s.Binding = bindings;
            DataGridTextColumn s1 = new DataGridTextColumn();
            s1.Header = "Phone";
            s1.Binding = bindings1;
            DataGridTextColumn s2 = new DataGridTextColumn();
            s2.Header = "Color";
            s2.Binding = bindings2;

            FrameworkElementFactory textblock = new FrameworkElementFactory(typeof(TextBlock));
            textblock.Name = "text";
            System.Windows.Data.Binding prodID = new System.Windows.Data.Binding("Name");
            System.Windows.Data.Binding color = new System.Windows.Data.Binding("Color");
            textblock.SetBinding(TextBlock.TextProperty, prodID);
            textblock.SetValue(TextBlock.TextWrappingProperty, TextWrapping.Wrap);
            //textblock.SetValue(TextBlock.BackgroundProperty, color);
            textblock.SetValue(TextBlock.NameProperty, "textblock");
            //FrameworkElementFactory border = new FrameworkElementFactory(typeof(Border));
            //border.SetValue(Border.NameProperty, "border");
            //border.AppendChild(textblock);
            DataTrigger t = new DataTrigger();
            t.Binding = new System.Windows.Data.Binding { Path = new PropertyPath("Name"), Converter = new EnableConverter(), ConverterParameter ="Phone" };
            t.Value = 1;
            t.Setters.Add(new Setter(TextBlock.BackgroundProperty, Brushes.LightGreen, textblock.Name));
            t.Setters.Add(new Setter(TextBlock.ToolTipProperty, bindings, textblock.Name));
            DataTrigger t1 = new DataTrigger();
            t1.Binding = new System.Windows.Data.Binding { Path = new PropertyPath("Name"), Converter = new EnableConverter(), ConverterParameter = "Phone" };
            t1.Value = 2;
            t1.Setters.Add(new Setter(TextBlock.BackgroundProperty, Brushes.LightYellow, textblock.Name));
            t1.Setters.Add(new Setter(TextBlock.ToolTipProperty, bindings, textblock.Name));

            DataTemplate d = new DataTemplate();
            d.VisualTree = textblock;
            d.Triggers.Add(t);
            d.Triggers.Add(t1);

            DataGridTemplateColumn s3 = new DataGridTemplateColumn();
            s3.Header = "Name 1";
            s3.CellTemplate = d;
            s3.Width = 140;

            ColumnCollection.Add(s); 
            ColumnCollection.Add(s1);
            ColumnCollection.Add(s2);
            ColumnCollection.Add(s3);
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-26T10:26:59.727

我想扩展前面的示例（答案）订阅和取消订阅事件 CollectionChanged 的​​能力。

**行为**（添加对 System.Windows.Interactivity 的引用）：

```
 public class ColumnsBindingBehaviour : Behavior<DataGrid>
{
    public ObservableCollection<DataGridColumn> Columns
    {
        get { return (ObservableCollection<DataGridColumn>) base.GetValue(ColumnsProperty); }
        set { base.SetValue(ColumnsProperty, value); }
    }

    public static readonly DependencyProperty ColumnsProperty = DependencyProperty.Register("Columns",
        typeof(ObservableCollection<DataGridColumn>), typeof(ColumnsBindingBehaviour),
            new PropertyMetadata(OnDataGridColumnsPropertyChanged));

    private static void OnDataGridColumnsPropertyChanged(DependencyObject source, DependencyPropertyChangedEventArgs e)
    {
        var context = source as ColumnsBindingBehaviour;

        var oldItems = e.OldValue as ObservableCollection<DataGridColumn>;

        if (oldItems != null)
        {
            foreach (var one in oldItems)
                context._datagridColumns.Remove(one);

            oldItems.CollectionChanged -= context.collectionChanged;
        }

        var newItems = e.NewValue as ObservableCollection<DataGridColumn>;

        if (newItems != null)
        {
            foreach (var one in newItems)
                context._datagridColumns.Add(one);

            newItems.CollectionChanged += context.collectionChanged;
        }
    }

    private ObservableCollection<DataGridColumn> _datagridColumns;

    protected override void OnAttached()
    {
        base.OnAttached();

        this._datagridColumns = AssociatedObject.Columns;
    }

    private void collectionChanged(object sender, NotifyCollectionChangedEventArgs e)
    {
        switch (e.Action)
        {
            case NotifyCollectionChangedAction.Add:
                if (e.NewItems != null)
                    foreach (DataGridColumn one in e.NewItems)
                        _datagridColumns.Add(one);
                break;

            case NotifyCollectionChangedAction.Remove:
                if (e.OldItems != null)
                    foreach (DataGridColumn one in e.OldItems)
                        _datagridColumns.Remove(one);
                break;

            case NotifyCollectionChangedAction.Move:
                _datagridColumns.Move(e.OldStartingIndex, e.NewStartingIndex);
                break;

            case NotifyCollectionChangedAction.Reset:
                _datagridColumns.Clear();
                if (e.NewItems != null)
                    foreach (DataGridColumn one in e.NewItems)
                        _datagridColumns.Add(one);
                break;
        }
    }
} 
```

**查看**：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"

    xmlns:loc="clr-namespace:WpfApplication1"
    xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
    Title="MainWindow" Height="350" Width="525">
<Grid>
    <DataGrid x:Name="_dataGrid">
        <DataGrid.Columns>
            <DataGridTextColumn Header="Test" />
        </DataGrid.Columns>
        <i:Interaction.Behaviors>
            <loc:ColumnsBindingBehaviour Columns="{Binding DataGridColumns}"/>        
        </i:Interaction.Behaviors>
    </DataGrid>
</Grid> 
```

**视图模型：**

```
 private ObservableCollection<DataGridColumn> _dataGridColumns;
     public ObservableCollection<DataGridColumn> DataGridColumns
     {
         get
         {
             if (_dataGridColumns == null)
                 _dataGridColumns = new ObservableCollection<DataGridColumn>()
                 {
                     new DataGridTextColumn()
                     {
                         Header = "Column1"
                     }
                 };

             return _dataGridColumns;
         }
         set
         {
             _dataGridColumns = value;
             OnPropertyChanged("DataGridColumns");
         }
     } 
```

# php - 如何保护目录不被php访问？

> ID：15549194
> 
> 赞同：2
> 
> 时间：2013-03-21T13:40:36.757
> 
> 标签：php, apache, include

我的服务器上有目录`/www/site1`和目录`/www/site2`。我想阻止文件`site1`执行以下操作：

```
include("../site2/configuration.php"); 
```

我需要目录完全独立。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:42:33.267

[以 Web 服务器用户以外的用户身份](https://serverfault.com/questions/264760/how-to-run-php-with-the-user-permission-on-apache)运行 PHP ，并设置目录和文件的权限，以便它们只能由所有者 ( `chmod 700`) 访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T13:43:10.880

您可以使用[open_basedir](http://www.php.net/manual/en/ini.core.php#ini.open-basedir) php.ini 指令。

# android - 根据之前给出的年龄计算年龄

> ID：15549197
> 
> 赞同：1
> 
> 时间：2013-03-21T13:40:41.183
> 
> 标签：android, date

我正在开发一个 Android 应用程序，其中有一个用于牛管理的模块。在这里，用户可以添加一些关于他/她的动物的数据（类型、年龄、性别等）。

这里假设用户以这种格式输入了他的动物的年龄：2 年 3 个月，那么每当用户查询该动物时，都应该更新年龄。

我找到了一些解决方案，通过从当前日期中减去出生日期来从出生日期中查找年龄。但是在这里我不能要求用户填写他们动物的生日。

那么有什么方法可以让我在填写表格时以编程方式从给定的年龄中找到动物的年龄。

任何帮助都是不言而喻的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:46:52.000

以 utc 时间存储时间戳，然后截断您不需要的准确性

# c# - 使用 ScheduledTaskAgent 更新锁定屏幕

> ID：15549198
> 
> 赞同：1
> 
> 时间：2013-03-21T13:40:47.237
> 
> 标签：c#, windows-phone-8

我希望能够使用计划任务代理更新我的锁屏图像。我确实看过[Building Windows Phone 8 Apps Development Jump Start](http://www.microsoftvirtualacademy.com/Content/ViewContent.aspx?et=2090&m=2076&ct=14365)，这是一篇不错的文章。我的问题是在这个视频中，它展示了如何使用隔离存储中的图片更改背景。使用 ：

```
 Uri imageUri = new Uri("ms-appdata:///local/shared/shellcontent/background2.png",                           UriKind.RelativeOrAbsolute); 
```

这不是我的情况（我需要从网络服务下载它）。我用一段代码构建了一个小项目，它应该下载一个图像，将其存储到我的隔离存储中，然后用它来上传我的锁定屏幕（我想这是做我想做的最好的方式。）。

为此，我使用了：

```
protected override void OnInvoke(ScheduledTask task)
{
    Deployment.Current.Dispatcher.BeginInvoke(() =>
      {
          SavePictureInIsolatedStorage(
              new Uri(
                  "http://www.petfinder.com/wp-content/uploads/2012/11/101418789-cat-panleukopenia-fact-sheet-632x475.jpg"));

         // LockHelper();
          NotifyComplete();
      });

} 
```

和 ：

```
private async void SavePictureInIsolatedStorage(Uri backgroundImageUri)
{

    BitmapImage bmp = new BitmapImage();
    await Task.Run(() =>
                       {

                           var semaphore = new ManualResetEvent(false);
                           Deployment.Current.Dispatcher.BeginInvoke(()=>  
                                   {
                                       bmp = new BitmapImage(backgroundImageUri);
                                       semaphore.Set();
                                   });
                           semaphore.WaitOne();
                       });
    bmp.CreateOptions = BitmapCreateOptions.None;
    WriteableBitmap wbmp = new WriteableBitmap(bmp);

    using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
    {
        var file = "shared/shellcontent/lockscreen.png";
        // when file exists, delete it
        if (myIsolatedStorage.FileExists(file))
        {
            myIsolatedStorage.DeleteFile(file);
        }

        using (var isoFileStream = new IsolatedStorageFileStream(file, FileMode.Create, myIsolatedStorage))
        {
            // use ToolStackPNGWriterExtensions
            ToolStackPNGWriterLib.PNGWriter.WritePNG(wbmp, isoFileStream);

        }

    }

} 
```

我的问题是我的位图图像似乎没有被下载。我也尝试使用 WebClient，因为我面临相同的结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T15:32:05.260

你不是在等待你的电话，所以`NotifyComplete()`会在任何事情有机会运行之前被调用。您可以通过将 lambda 函数声明为`async`.

```
protected override void OnInvoke(ScheduledTask task)
{
    Deployment.Current.Dispatcher.BeginInvoke(async () =>
    {
      await SavePictureInIsolatedStorage(
          new Uri(
              "http://www.petfinder.com/wp-content/uploads/2012/11/101418789-cat-panleukopenia-fact-sheet-632x475.jpg"));

      NotifyComplete();
     });
} 
```

但是请注意，您的方法运行时间不会太长，否则您的计划任务将不会再次计划（在 2 次此类失败之后）。

# php - Google 可视化 API - 多折线图

> ID：15549201
> 
> 赞同：2
> 
> 时间：2013-03-21T13:40:50.917
> 
> 标签：php, google-visualization, linechart

从数据库中提取记录后，我创建了一个数组。数组是这样的：

```
// $xyz array
Array
(
    [f30] => Array
        (
            [December 2012] => 71
            [November 2012] => 70
            [October 2012] => 66
        )    

    [f32] => Array
        (
            [December 2012] => 85
            [November 2012] => 83
            [October 2012] => 81
        )
) 
```

如果它是一个单线图，我可以毫不费力地绘制它。但是，当我尝试绘制多折线图时，我遇到了很多问题。下面是我试图绘制数据的代码：

### PHP

```
$table = array();
$table['cols'] = array(
           array('label' => 'Month', 'type' => 'string')        
         );

$rows = array();
foreach($xyz as $form=>$hhh)
{        
   $table['cols'][] = array('label'=>$form, 'type'=>'number');
   foreach($hhh as $mnth=>$pt)
   {
      $temp = array();
      $temp[] = array('v' => (string) $mnth);
      $temp[] = array('v' => (int) $pt);
      $rows[] = array('c'=>$temp);
    }
}

$table['rows'] = $rows;
$jsonTable = json_encode($table); 
```

### JS

```
<script type="text/javascript">

    google.load('visualization', '1', {'packages':['corechart']});    
    google.setOnLoadCallback(drawChart);
    function drawChart() {
      var data = new google.visualization.DataTable(<?=$jsonTable?>);
      var options = {
           title: 'Some title',
          is3D: 'true',
          width: 800,
          height: 600
        };            
      var chart = new google.visualization.LineChart(document.getElementById('divID'));
      chart.draw(data, options);
    }
    </script> 
```

我通过更改和数组的位置尝试了各种排列和组合`$temp`，但我似乎无法在单个图中绘制两条线。我可能弄乱了数组的位置。`$rows``$table['rows']`

我设法得到的最接近的是下面的：

![我得到了什么](../Images/15534db6cd28af4873d0de407d5b63a3.png)

但我的预期输出类似于 ![我在寻找什么](../Images/2d0e330be2ada75322481f8aa4c39b66.png)

`f30`and`f31`代替`Sales`and `Expenses`, `October`,代替, , , `November`_`December``2004``2005``2006``2007`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T08:35:02.370

我自己想通了。我的上帝！这是何等的解脱。我只需要有一个这种格式的数组：

```
Array
(
    [December 2012] => Array
        (
            [0] => 71
            [1] => 85
        )

    [November 2012] => Array
        (
            [0] => 70
            [1] => 83                
        )

    [October 2012] => Array
        (
            [0] => 66
            [1] => 81
        )

) 
```

其余的是`foreach`循环中的一个小修改，瞧！它完成了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:29:57.800

您还可以为每个 f[30] 和 f[31] 创建一个数据表，然后执行 [google.visualization.data.join()](https://developers.google.com/chart/interactive/docs/reference#google_visualization_data_join)

这基本上将两个图表从关键列连接起来 - 即

# android - Android ViewPager

> ID：15549202
> 
> 赞同：0
> 
> 时间：2013-03-21T13:40:51.383
> 
> 标签：android, android-viewpager

我想举办活动。当我按下按钮 3 时，我想同时移动 ViewPager1(position 0->1) 和 ViewPager2(position 0->1)。这是我的代码

主要的.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/LinearLayout2"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:orientation="vertical" >

        <android.support.v4.view.ViewPager
            android:id="@+id/viewpager_a"
            android:layout_width="match_parent"
            android:layout_height="match_parent" >
        </android.support.v4.view.ViewPager>
    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:orientation="vertical" >

        <android.support.v4.view.ViewPager
            android:id="@+id/viewpager_b"
            android:layout_width="match_parent"
            android:layout_height="match_parent" >
        </android.support.v4.view.ViewPager>
    </LinearLayout>

</LinearLayout> 
```

viewpager_a1.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:gravity="center"
        android:text="ViewPager1(Position 0)" />

    <Button
        android:id="@+id/button1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:text="Button1" />

</LinearLayout> 
```

viewpager_a2.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:gravity="center"
        android:text="ViewPager1(Position 1)" />

    <Button
        android:id="@+id/button2"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:text="Button2" />

</LinearLayout> 
```

viewpager_b1.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:gravity="center"
        android:text="ViewPager2(Position 0)" />

    <Button
        android:id="@+id/button3"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:text="Button3" />

</LinearLayout> 
```

viewpager_b2.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:gravity="center"
        android:text="ViewPager2(Position 1)" />

    <Button
        android:id="@+id/button4"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:text="Button4" />

</LinearLayout> 
```

main.java

```
public class MainActivity extends Activity {

    private ViewPager viewpagerA;
    private ViewPager viewpagerB;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        viewpagerA =(ViewPager)findViewById(R.id.viewpager_a);
        viewpagerA.setAdapter(new AdpaterA(getApplicationContext(),viewpagerA));

        viewpagerB =(ViewPager)findViewById(R.id.viewpager_b);
        viewpagerB.setAdapter(new AdpaterB(getApplicationContext(),viewpagerB));
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {

        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

} 
```

ViewPagerApdaterA.java

```
public class AdpaterA extends PagerAdapter {

    public LayoutInflater mInflater;
    public Context mContext;
    public ViewPager mViewPager;

    public AdpaterA(Context c, ViewPager pager) {

        super();
        mContext = c;
        mInflater = LayoutInflater.from(c);
        mViewPager=pager;
        mViewPager.setAdapter(this);        
    }

    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return 2;
    }

    @Override
    public boolean isViewFromObject(View pager, Object obj) {

        return pager == obj;
    }

    @Override
    public Object instantiateItem(View pager, int position) {
        View v = null;
        if (position == 0) {
            v = mInflater.inflate(R.layout.viewpager_a1, null);
            Button button1 = (Button) v.findViewById(R.id.button1);
            button1.setOnClickListener(mPagerClickListener); 
        } else if (position == 1) {
            v = mInflater.inflate(R.layout.viewpager_a2, null);
            Button button2 = (Button) v.findViewById(R.id.button2);
            button2.setOnClickListener(mPagerClickListener); 
        }
        ((ViewPager) pager).addView(v, 0);

        return v;
    }

    private View.OnClickListener mPagerClickListener = new View.OnClickListener() {

        @Override
        public void onClick(View v) {

            switch (v.getId()){
            case R.id.button1:
                changeviewpager(1);
                Toast.makeText(mContext, "Button 1", Toast.LENGTH_SHORT).show();
                break;
            case R.id.button2:
                changeviewpager(2);
                Toast.makeText(mContext, "Button 2", Toast.LENGTH_SHORT).show();
                break;
            }
        }
    };

    public void changeviewpager(int type) {

        if(type==1){
            mViewPager.setCurrentItem(1);
        }else if(type==2){
            mViewPager.setCurrentItem(0);
        }       
    }

    @Override
    public void destroyItem(View pager, int position, Object view) {
        ((ViewPager) pager).removeView((View) view);
    }

    @Override
    public void restoreState(Parcelable arg0, ClassLoader arg1) {
    }

    @Override
    public Parcelable saveState() {
        return null;
    }

    @Override
    public void startUpdate(View arg0) {
    }

    @Override
    public void finishUpdate(View arg0) {
    }
} 
```

ViewPagerAdpaterB.java

```
public class AdpaterB extends PagerAdapter {

    public LayoutInflater mInflater;
    public Context mContext;
    public ViewPager mViewPager;

    public AdpaterB(Context c, ViewPager pager) {

        super();
        mContext = c;
        mInflater = LayoutInflater.from(c);
        mViewPager=pager;
        mViewPager.setAdapter(this);    
    }

    @Override
    public int getCount() {

        return 2;
    }

    @Override
    public boolean isViewFromObject(View pager, Object obj) {

        return pager == obj;
    }

    @Override
    public Object instantiateItem(View pager, int position) {
        View v = null;
        if (position == 0) {
            v = mInflater.inflate(R.layout.viewpager_b1, null);
            Button button3 = (Button) v.findViewById(R.id.button3);
            button3.setOnClickListener(mPagerClickListener); 
        } else if (position == 1) {
            v = mInflater.inflate(R.layout.viewpager_b2, null);
            Button button4 = (Button) v.findViewById(R.id.button4);
            button4.setOnClickListener(mPagerClickListener); 
        }
        ((ViewPager) pager).addView(v, 0);

        return v;
    }

    private View.OnClickListener mPagerClickListener = new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            switch (v.getId()){
            case R.id.button3:
                changeviewpager(1);
                Toast.makeText(mContext, "Button 3", Toast.LENGTH_SHORT).show();
                break;
            case R.id.button4:
                changeviewpager(2);
                Toast.makeText(mContext, "Button 4", Toast.LENGTH_SHORT).show();
                break;
            }
        }
    };

    public void changeviewpager(int type) {

        if(type==1){
            mViewPager.setCurrentItem(1);
        }else if(type==2){
            mViewPager.setCurrentItem(0);
        }       
    }

    @Override
    public void destroyItem(View pager, int position, Object view) {
        ((ViewPager) pager).removeView((View) view);
    }

    @Override
    public void restoreState(Parcelable arg0, ClassLoader arg1) {
    }

    @Override
    public Parcelable saveState() {
        return null;
    }

    @Override
    public void startUpdate(View arg0) {
    }

    @Override
    public void finishUpdate(View arg0) {
    }
} 
```

从这里开始，没有错误。但我不知道如何添加代码....当按下按钮 3 时，viewpager2 从位置“0”移动到“1”，并且 viewpager1 从位置“0”移动到“1”。帮帮我~

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:43:37.837

您可以使用

```
//change 1 to whatever page you want
viewPager.setCurrentItem(1, true); 
```

更改为任意页面。第二个参数是smoothScroll，如果你设置它为true，分页器会平滑滚动到新的位置，如果设置为false，它只会从一个跳转到另一个。

[请参阅 ViewPager 的文档以了解更多信息。](https://developer.android.com/reference/android/support/v4/view/ViewPager.html)

# devise - 带有设计的omniauth google-oauth2 - invalid_credentials 和“检测到Csrf”

> ID：15549204
> 
> 赞同：9
> 
> 时间：2013-03-21T13:40:53.437
> 
> 标签：devise, ruby-on-rails-3.2, omniauth, google-oauth

亲爱的SO的好人：

我正在 Rails 3.2.12 上开发一个 Ruby 应用程序（我还是新手）。

我正在尝试让 Devise 与 Omniauth 合作……我尝试的第一个策略是 Google_oauth2。

在选择了我想在谷歌中使用的凭据后，我让它工作到谷歌重定向回我的 localhost:3000 实例的地步。

在此重定向回 l​​ocalhost 后，我​​看到一个快速通知：

`Could not authenticate you from GoogleOauth2 because "Csrf detected".`

服务器日志包含以下内容：

```
Started GET "/users/auth/google_oauth2" for 127.0.0.1 at 2013-03-21 08:57:01 -0400
(google_oauth2) Callback phase initiated.
(google_oauth2) Callback phase initiated.
(google_oauth2) Authentication failure! invalid_credentials: OmniAuth::Strategie
s::OAuth2::CallbackError, OmniAuth::Strategies::OAuth2::CallbackError

Started GET "/users/auth/google_oauth2/callback?state=7849a3762d07e7f89e69b4aa46
7efc7b7b2c21655193396b&code=4/v-dSBwAvQUUZL87iNV_yk_Z8s_x0.cnqsdbDX4gUYaDn_6y0ZQ
NgQ9hAaewI" for 127.0.0.1 at 2013-03-21 08:57:40 -0400
Processing by OmniauthCallbacksController#failure as HTML
  Parameters: {"state"=>"7849a3762d07e7f89e69b4aa467efc7b7b2c21655193396b", "cod
e"=>"4/v-dSBwAvQUUZL87iNV_yk_Z8s_x0.cnqsdbDX4gUYaDn_6y0ZQNgQ9hAaewI"}
Redirected to http://localhost:3000/users/sign_in
Completed 302 Found in 0ms (ActiveRecord: 0.0ms) 
```

我注意到，如果我只是将回调 URL 直接放入浏览器，而不提供任何参数，我会得到完全相同的结果。

```
http://localhost:3000/users/auth/google_oauth2/callback 
```

我可以尝试什么？我还能提供哪些其他信息？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-21T21:25:05.337

回答我自己的帖子....我已经过去了。我不完全确定为什么，但我有一些可能值得传递的线索。

还有许多其他与omniauth-facebook 策略相关的类似问题。他们似乎没有适用于谷歌，所以我没有看太深。然后我尝试配置FB策略，也遇到了同样的问题。FB 解决方案是将omniauth-facebook gem 恢复到1.4.0。

```
gem 'omniauth-facebook', '1.4.0' 
```

这也自动恢复了omniauth-oauth2 gem（我还没有把头缠在gem上）。当我再次尝试 google 链接时，它没有抛出相同的 Csrf 检测消息...嗯...恢复 FB gem 固定 google ----这里需要免责声明，其他事情可能是这里的问题，但我认为我说得对。

还有一个问题值得一提。我上面提供的日志显示了 2 条重复的日志消息....

```
(google_oauth2) Callback phase initiated.
(google_oauth2) Callback phase initiated. 
```

这揭示了另一个（可能相关的）问题。这意味着回调被执行了两次。一旦我解决了 CSRF 问题，我就开始自己解决 invalid_credentials 问题。错误的原因是重复的回调调用。显然，Oauth2 只允许单次使用凭证。第二次使用无效。

我使用 railscast #235 作为我的指南： [http ://railscasts.com/episodes/235-devise-and-omniauth-revised?autoplay=true](http://railscasts.com/episodes/235-devise-and-omniauth-revised?autoplay=true)

它让我在omniauth.rb 初始化程序中添加了“提供者”调用。和 config.omniauth 在 devise.rb 初始化程序中调用。我猜这些会导致重复的回调？！？！？

从omniauth.rb 中删除条目让我超越了那个条目。

So there you have it. My second SO question, and my second question where I'm the only responder. Not sure if its because they were dumb or hard... I hope the latter.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-25T23:05:46.197

我有同样的问题。就我而言，我已经在 devise.rb 和 omniauth.rb 中初始化了 google-oauth 凭据；因此，回调发生了两次。从 devise.rb 中删除 google-oauth 凭据后，这个 CSRF 令牌问题得到了解决。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-24T09:09:36.480

Just stumbled onto this issue, but your fix didn't work for me. I am using the following gem versions;

```
oauth2 (0.8.1)
omniauth (1.1.4)
omniauth-oauth2 (1.1.1)
omniauth-facebook (1.4.1)
omniauth-google-oauth2 (0.2.1) 
```

What *did* fix my problem was adjusting my omniauth.rb initialiser to the following;

```
OmniAuth.config.full_host = "http://localhost:3000"

Rails.application.config.middleware.use OmniAuth::Builder do
    provider :facebook, KEY, SECRET,
    provider :google_oauth2, KEY, SECRET, :scope => "userinfo.email,userinfo.profile"
end 
```

The key part was to add the 'scope' parameter for google_oauth2, without which I was getting auth failures.

I based my install of this blog: [http://sreeharikmarar.blogspot.com.au/2013/01/omniauth-devise-authentication-using.html](http://sreeharikmarar.blogspot.com.au/2013/01/omniauth-devise-authentication-using.html)

A related post: [OmniAuth using google oauth 2 strategy scope failure](https://stackoverflow.com/questions/8541088/omniauth-using-google-oauth-2-strategy-scope-failure)

# javascript - 具有来自服务器的值的下拉敲除js

> ID：15549207
> 
> 赞同：0
> 
> 时间：2013-03-21T13:41:00.313
> 
> 标签：javascript, knockout.js, knockout-mapping-plugin, knockout-2.0, knockout-mvc

我正在处理 TR 中的下拉菜单。我有 true、false 或 none 作为我从服务器收到的值，我希望它更改下拉选项，如下例所示。

第一个正在工作，但我希望第二个充当第一个

[示例在这里：http:](http://jsfiddle.net/3xLgJ/) [//jsfiddle.net/3xLgJ/](http://jsfiddle.net/3xLgJ/)

**这是我的 HTML：**

```
 <div data-bind='text: incomingValue'></div>

       <select data-bind="value: incomingValue">
             <option value="true">Yes</option>
             <option value="false">No</option>
             <option value="none">Don't Know</option>
      </select> 
```

我怎样才能像上面那样实现它，因为它在一个 tr 内并像上面一样起作用

```
 <select  data-bind='options: yesno, value: incomingValue'/> 
```

**这是我的淘汰赛**

```
 var myModelView = function () {
    self = this;
    self.yesno = ko.observableArray(['Yes', 'No', 'Don\'t know']);
    self.incomingValue = ko.observable('none');
    };

    var moView = new myModelView();

    ko.applyBindings(moView); 
```

谢谢

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:59:31.940

最好的解决方案可能是稍微重构视图模型以使用对象而不是简单的字符串：

```
// Create a "class" that represents an option
var Option = function(id, caption) {
    this.id = id;
    this.caption = caption;
}; 
```

现在你用这个函数构造的对象填充 observable 数组：

```
self.yesno = ko.observableArray([
    new Option('true', 'Yes'),
    new Option('false', 'No'),
    new Option('none', 'Don\'t know')
]); 
```

您可以使用“optionsText”绑定将这些对象正确绑定到标记：

```
<select data-bind="options: yesno,
                   optionsText: 'caption',
                   value: selectedItem"></select> 
```

如果你从服务器收到一个字符串“none”，你需要找到代表这个选项的对象：

```
var incomingValue = 'none';

// Find the first object that is a match in the observable array "yesno"
var incomingItem = ko.utils.arrayFirst(self.yesno(), function(item) {
    return item.id == incomingValue;
});

self.selectedItem = ko.observable(incomingItem); 
```

在其他地方显示选择时，您需要考虑选择由对象表示：

```
<div data-bind='text: selectedItem().caption'></div> 
```

演示：http: [//jsfiddle.net/3xLgJ/2/](http://jsfiddle.net/3xLgJ/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:00:29.397

您需要使用`optionsText`和`optionsValue`绑定。您需要创建一个可观察的值和文本数组：

```
self.yesno = ko.observableArray([
    {value:"true",text:"Yes"},
    {value:"false",text:"No"},
    {value:"none",text:"Don't Know"}]); 
```

然后，您需要在 html 中执行以下操作：

```
<select data-bind="options: yesno2, optionsText: 'text',optionsValue: 'value', value: incomingValue"></select> 
```

有关工作示例，请参见[此处](http://jsfiddle.net/3xLgJ/3/)

# objective-c - Objective c 和 cocos2d 分配对象管理

> ID：15549218
> 
> 赞同：0
> 
> 时间：2013-03-21T13:41:25.580
> 
> 标签：objective-c, cocos2d-iphone

我想知道如何以最好的方式实现场景之间的过渡。

我的应用程序有一个`ccscene1`in`class1`和`ccscene2`in `class2`。

当我从scene1 过渡到scene2 时，scene1 init 方法上有许多已分配的实例，我不想在每次现场直播时释放/分配。我想知道如何实现scene1，以便从2返回时不会再次分配所有分配的实例（其中一些是服务器tcp连接），但仅在第一次启动时，并且在所有场景转换期间仍然保持有效。

**一个解决方案：** 设置一个全局标志，并在第一次启动时从委托将其设置为 1，然后检查这是否是第一次启动 scene1 的 init 方法，然后分配对象。

在我离开场景 1 后，这些对象在我回来时仍然有效吗？（可以说我没有释放它们）？

主要目标是不每次转换都连接到服务器，并保持场景 1 的委托实例有效（对于我使用解决方案 1 的情况）

```
-(id) init
{
    if( (self=[super init]) )

    {
       socketInstance=[[SocketConnector alloc]init]; //only once !
       socketInstance.delegate=self;

     //later on i have transition :

    [[CCDirector sharedDirector] replaceScene:[CCTransitionFade transitionWithDuration:0.7f scene:[AdressBookScene scene]]]; 
```

我正在寻找“专业”的方式来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T19:46:44.983

你可以`pushScene`用来运行scene2。这将完全保留场景 1 并将其保存在内存中。然后您可以继续`replaceScene`使用其他场景到场景 2，并最终调用`popScene`返回场景 1。

# ubuntu - 无法使用 cron 运行 ec2 命令行，

> ID：15549222
> 
> 赞同：2
> 
> 时间：2013-03-21T13:41:49.133
> 
> 标签：ubuntu, amazon-web-services, amazon-ec2, crontab

我正在自动化 ec2 启动和关闭，我编写了一个 bash 脚本，当我手动运行它时它可以工作，但是当我添加 bash 以通过 crontab 运行时它没有执行。我已经为脚本分配了适当的权限。这是我的脚本

```
#! /bin/bash
/usr/local/aws/bin/ec2-start-instances --region us-east-1  i-abc12345 
```

这是我的 crontab

```
35 13 * * * /bin/bash /home/ubuntu/.script/testshutdown.sh 
```

请帮帮我！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T19:30:12.003

关于任何错误，您从*/var/log/cron得到什么输出？*此外，如果您将 #!/bin/bash 放在脚本开头，则无需告诉 cron 如何执行脚本。确保它是可执行的（*chmod +x testshutdown.sh*）。

您是在编辑 /etc/crontab、运行 crontab -e 还是其他方式？系统上不止一个 crontab，而且在某些情况下，它们的编辑方式不同，需要的值的数量也不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-28T07:19:24.350

我在这里的回答可能是您正在寻找的帮助： [https](https://stackoverflow.com/a/21397517/2083509) : //stackoverflow.com/a/21397517/2083509 片段：

```
AWS_ACCESS_KEY="blah-blah-dingle-smith" # changeme
AWS_SECRET_KEY="yankee-doodle-shit-no-stank" # changeme
JAVA_HOME="/usr/lib/jvm/java"
EC2_HOME="/opt/aws/apitools/ec2"
EC2_URL="https://us-west-2.ec2.amazonaws.com/" # changeme
PATH="$PATH:/opt/aws/bin"  # is dir contains a symlinks of tool binaries
export AWS_ACCESS_KEY AWS_SECRET_KEY JAVA_HOME EC2_HOME EC2_URL PATH 
```

将以上内容直接添加到您的`testshutdown.sh`脚本中。或者给它自己的脚本，然后在同一个 crontab 作业中加载它。例如：`* * * * * /home/ubuntu/.script/aws-env.sh; /home/ubuntu/.script/testshutdown.sh`或者我建议从链接中执行的操作（来源 *.conf） 永远不建议对特定任务使用完全访问权限的管理员密钥。;)

将您的 SHELL 设置在 cron 本身中可能是明智的。替换或添加`SHELL=/bin/bash`到您的 cron。即使你有适当的shebang，它仍然是一个不错的决定。你可能会让自己发疯，试图找出为什么你知道的命令有效，但不要。

# redis - Redis：集合内的项目可以有过期时间吗？

> ID：15549223
> 
> 赞同：0
> 
> 时间：2013-03-21T13:41:50.003
> 
> 标签：redis

就像 Redis 键可以“过期”一样，集合中的单个项目可以设置为自动过期吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T15:39:41.763

是的，这是不可能的。

解决方案是添加一个每 M 秒过期的密钥，并运行一个每隔 N 秒清理一次集合的监控服务。

# linux - 需要更好的数字组合解决方案

> ID：15549225
> 
> 赞同：1
> 
> 时间：2013-03-21T13:41:55.113
> 
> 标签：linux, perl

我有以下条目的文件：

```
1,2
2,3
4,5
1,3
1,4
5,6
... 
```

这告诉 ids：第一列与第二列匹配。现在我想找到所有只有所有组合的 id 组。即需要输出以下内容：

```
1,2,3
4,5
1,4
5,6 
```

我试图为解决方案编写一个 perl 脚本：

```
while(<STDIN>) {
    if(m/^(\d+),(\d+)/) {
        $dub{$1}{$2} = 1;
        $dub{$2}{$1} = 1;
        $hs{$1} = 1;
        $hs{$2} = 1;
    }
}

$i=0;
foreach $a (keys %dub) {
    $grp[$i]{$a} = 1;
    foreach $b (keys %{$dub{$a}}) {
        $grp[$i]{$b} = 1;
        foreach $c (keys %hs) {
            if($c == $a || $c == $b) { next; }
            $flag = 1;
            foreach $d (keys %{$grp[$i]}) {
                if(!$dub{$d}{$c}) {
                    $flag = 0;
                    last;
                }
            }
            $grp[$i]{$c} = 1 if($flag);
        }
        $i++;
    }
}

for($i=0; $i<=$#grp; $i++) {
    print join(",", (keys %{$grp[$i]}))."\n";
} 
```

但这需要大量的时间来执行。上述脚本是否有更好的解决方案、算法或性能调整？LAMP 中的任何解决方案都值得赞赏。谢谢

编辑：

这样想： (1,2) 定义为“1 和 2 相似” (2,3) 定义为“2 和 3 相似” (1,4) 定义为“1 和 4 相似” (1,3) 定义为“1和3相似”

从这些相似性中，我得出结论，组 (1,2,3) 彼此相似，但组 (1,2,3,4) 不相似。为了形成组 (1,2,3,4)，数据中应该有其他条目，如 (2,4) 和 (3,4)。

最后，我想在给定的一组坐标中找到所有组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:00:05.883

这对我有用：

```
use Data::Dump;

my @results;
my ($last_a, $last_b) = (0,0);

while(<DATA>) {
    chomp;
    my ($a, $b) = split /,/;
    if( $last_b == $a ) {
        my $last_item = $results[$#results];
        push @$last_item, $b;
    }
    else {
        push @results, [$a, $b];
    }
    ($last_a,  $last_b) = ($a, $b);
}

dd @results; # ([1, 2, 3], [4, 5], [1, 3], [1, 4], [5, 6])

__DATA__
1,2
2,3
4,5
1,3
1,4
5,6 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:46:24.330

您还没有真正描述我们应该使用的算法。我真的不明白为什么您的输入会生成“1,2,3”和“1,4”，而不仅仅是“1,2,3,4”。

但这就是你想要的吗？

```
#!/usr/bin/perl

use strict;
use warnings;
use 5.010;

my %data;
while (<DATA>) {
  chomp;
  my ($k, $v) = split /,/;
  push @{ $data{$k} }, $v;
}

foreach (sort keys %data) {
  say "$_,", join ',', @{ $data{$_ } };
}

__DATA__
1,2
2,3
4,5
1,3
1,4
5,6 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:15:28.433

据我了解，{1,2,3} 属于同一组，因为它们都指向对方（{1,2}、{2,3}、{1,3} 存在）。因此，我们可以将这个问题简化为在无向图中寻找团，即 NP-Complete 问题。因此，每个解决方案在大数据上的效率都非常低。

# ruby-on-rails - 无法让设计从 Angular.js 中注销

> ID：15549228
> 
> 赞同：5
> 
> 时间：2013-03-21T13:42:06.343
> 
> 标签：ruby-on-rails, devise, angularjs, logout

我通过 GET 进行了 Devise 身份验证以注销，但无法使用以下 Angular.js 代码注销：

```
$scope.logout = ->
  $http.get('/users/sign_out').success ->
    #If it does not redirect from 'editor' to 'login' then you haven't actually logged out
    $location.path('editor') 
```

Devise 的注销行为似乎是随机的——有时会注销，有时不会。如果我进入`/users/sign_out`浏览器的地址栏，它总是会注销。

好的，我将 Devise 身份验证的注销切换为 POST 请求以消除缓存问题并使用以下 Angular.js 代码：

```
$scope.logout = ->
  $http.post('/users/sign_out').success ->
    $location.path('editor') 
```

和往常一样，第一次注销很好，但后来我无法注销。

我决定制作自己的方法来看看会发生什么：

```
match '/logout' => 'api#logout', :via => :post

class ApiController < ApplicationController
  before_filter :authenticate_user!

  def logout
    sign_out
    if current_user
      puts 'Has not signed out!'
    else
      puts 'Has signed out!'
    end
    head :ok
  end
end 
```

并检测到`sign_out`始终`current_user`为 nil，但随后 Angular 应用程序奇迹般地设法访问了 ApiController 的其他方法，并且 current_user 不在那里！

我不明白这个。好的，让我们假设在注销请求之后（或同时）可能会跟随其他一些 HTTP 请求，通过身份验证 cookie 并设计重新登录，但**在 cookie 中传递的会话 ID 不应该立即过期调用sign_out方法后？！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-12T21:27:34.663

对不起，我之前没有回复过，希望这会有所帮助

我的会话控制器

```
$scope.signOutUser = function () {
  $http.delete('/api/users/sign_out', {
    auth_token: Session.currentUser // just a cookie storing my token from devise token authentication.
  }).success( function(result) {
    $cookieStore.remove('_pf_session');
    $cookieStore.remove('_pf_name');
    $cookieStore.remove('_pf_email');
    location.reload(true); // I need to refresh the page to update cookies
  }).error( function(result) {
    console.log(result);
  });
} 
```

我覆盖了我的设计会话控制器

```
class SessionsController < Devise::SessionsController
  before_filter :authenticate_user!, only: :destroy

  def destroy
    token = params[:auth_token]
    @user = User.find_by_authentication_token(token)
    @user.reset_authentication_token!
    sign_out(@user)
    render status: :ok, json: {message: "You have successfully logged out"}
  end
end 
```

如您所见，我没有使用 Rails cookie，因此我的回答可能不适用。如果我这样做了，我可能会在我的销毁操作中添加类似 session[:user] = nil 的行。

# javascript - 外部文件中的 JavaScript 按钮操作

> ID：15549232
> 
> 赞同：0
> 
> 时间：2013-03-21T13:42:23.383
> 
> 标签：javascript, html, function, webpage

我在一个外部脚本中有我的 Javascript，我希望在文本字段中填充文本然后按下回车按钮时发生这种情况。有人可以解释一下如何让它工作，因为当我按下回车按钮时，现在什么都没有发生。提前感谢您的帮助。

另外，如何将文本从文本框中传递给 javascript 函数。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
  <html>
  <head> 
        <title> All About Resistors </title>
        <link rel="stylesheet" type="text/css" href="resistorpagestlying.css" />

  <script type="text/javascript"
  src="Value_to_Color.js">
  </script>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  </head>

 <body>

 <p>Resistor Value: <input type="text" onClick="print_text" id="test" value="Ohms"></p>
 <button>Show Color Code</button>

  </body>
  </html> 
```

这是 javascript 文件中的文本

```
function print_text(){
document.writeln("<b>Bold Hello World via an external js file!</b>"); 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:54:44.913

我想你正在寻找这个：

```
<p>Resistor Value: <input type="text" onkeypress="print_text();" id="test" value="Ohms"></p> 
```

请注意，`print_text()`因为`()`这是您正在调用的函数。其次，如果要在回车时调用该函数，则需要将函数的主体更改为：

```
function print_text()
{
    if (event.which == 13 || event.keyCode == 13) //enter key?
       document.writeln('<b>Bold Hello World via an external js file!</b>');
} 
```

而不是监听“onclick”事件，您需要监听文本字段上的“onkeypress”事件。

JsFiddle在这里：

[http://jsfiddle.net/YpVEQ/1/](http://jsfiddle.net/YpVEQ/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:47:17.900

调用函数的语法是：

```
 function_name() 
```

您缺少括号。

因此：

```
print_text() 
```

* * *

如果您希望在按下特定键时触发该功能，那么您也不想使用**click**，因为单击元素时会触发该功能。

您需要使用该`keypress`事件，并测试这样做时按下了哪个键。

我不知道如何找出在`onkeypress`属性中按下了什么键，因为我不使用内在事件属性。所以让我们转到`addEventListener`.

```
<input type="text" id="test" value="Ohms">
<script>
    document.getElementById('test').addEventListener('keypress', function (event) {
      var charCode = (typeof event.which == "number") ? event.which : event.keyCode
      if (charCode === 13) { // 13 is Enter
         print_text(); 
      }
    });
</script> 
```

# ios - 连续滚动查看；水平和垂直

> ID：15549233
> 
> 赞同：31
> 
> 时间：2013-03-21T13:42:31.837
> 
> 标签：ios, uiscrollview, uicollectionview, infinite-scroll

我已经为这个任务苦苦挣扎了很长一段时间了。我想开发的是一个滚动视图或集合视图，它可以在垂直和水平方向上连续滚动。

这是我认为这应该是什么样子的图像。透明框是从内存中重新加载的视图/单元格。一旦视图/单元格离开屏幕，它就应该被重新用于即将到来的新单元格..就像 a 的`UITableViewController`工作方式一样。

![连续滚动](../Images/f7c983cef436d7402b860456436a1afc.png)

我知道 a`UICollectionView`只能无限滚动水平或垂直，而不是两者。但是，我不知道如何使用`UIScrollView`. 我尝试了[附加到这个问题的答案](https://stackoverflow.com/a/13700334/406677)的代码，我可以让它重新创建视图（例如％20），但这并不是我真正需要的......此外，它不是连续的。

我知道这是可能的，因为 HBO Go 应用程序可以做到这一点。我想要完全相同的功能。

我的问题：我怎样才能实现我的目标？是否有任何指南/教程可以告诉我如何操作？我找不到任何东西。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-21T17:15:33.423

`UIScrollView`通过在距离中心一定距离后使用重新居中的技术，您可以获得无限滚动。首先，您需要使`contentSize`足够大以便可以滚动一点，所以我返回 4 倍于我的部分中的项目数和 4 倍的部分数，并在`cellForItemAtIndexPath`方法中使用 mod 运算符来获取正确的索引我的阵列。`layoutSubviews`然后，您必须在 的子类中覆盖`UICollectionView`以进行重新居中（这在 WWDC 2011 视频“高级滚动视图技术”中进行了演示）。这是具有集合视图（在 IB 中设置）作为子视图的控制器类：

```
#import "ViewController.h"
#import "MultpleLineLayout.h"
#import "DataCell.h"

@interface ViewController ()
@property (weak,nonatomic) IBOutlet UICollectionView *collectionView;
@property (strong,nonatomic) NSArray *theData;
@end

@implementation ViewController

- (void)viewDidLoad {
    self.theData = @[@[@"1",@"2",@"3",@"4",@"5"], @[@"6",@"7",@"8",@"9",@"10"],@[@"11",@"12",@"13",@"14",@"15"],@[@"16",@"17",@"18",@"19",@"20"]];
    MultpleLineLayout *layout = [[MultpleLineLayout alloc] init];
    self.collectionView.collectionViewLayout = layout;
    self.collectionView.showsHorizontalScrollIndicator = NO;
    self.collectionView.showsVerticalScrollIndicator = NO;
    layout.scrollDirection = UICollectionViewScrollDirectionHorizontal;
    self.view.backgroundColor = [UIColor blackColor];
    [self.collectionView registerClass:[DataCell class] forCellWithReuseIdentifier:@"DataCell"];
    [self.collectionView reloadData];
}

- (NSInteger)collectionView:(UICollectionView *)view numberOfItemsInSection:(NSInteger)section {
    return 20;
}

- (NSInteger)numberOfSectionsInCollectionView: (UICollectionView *)collectionView {
    return 16;
}

- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView  cellForItemAtIndexPath:(NSIndexPath *)indexPath {

    DataCell *cell = [collectionView  dequeueReusableCellWithReuseIdentifier:@"DataCell" forIndexPath:indexPath];
    cell.label.text = self.theData[indexPath.section %4][indexPath.row %5];
    return cell;
}

- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath {
   // UICollectionViewCell *item = [collectionView cellForItemAtIndexPath:indexPath];
    NSLog(@"%@",indexPath);

} 
```

这是`UICollectionViewFlowLayout`子类：

```
#define space 5
#import "MultpleLineLayout.h"

@implementation MultpleLineLayout { // a subclass of UICollectionViewFlowLayout
    NSInteger itemWidth;
    NSInteger itemHeight;
}

-(id)init {
    if (self = [super init]) {
        itemWidth = 60;
        itemHeight = 60;
    }
    return self;
}

-(CGSize)collectionViewContentSize {
    NSInteger xSize = [self.collectionView numberOfItemsInSection:0] * (itemWidth + space); // "space" is for spacing between cells.
    NSInteger ySize = [self.collectionView numberOfSections] * (itemHeight + space);
    return CGSizeMake(xSize, ySize);
}

- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)path {
    UICollectionViewLayoutAttributes* attributes = [UICollectionViewLayoutAttributes layoutAttributesForCellWithIndexPath:path];
    attributes.size = CGSizeMake(itemWidth,itemHeight);
    int xValue = itemWidth/2 + path.row * (itemWidth + space);
    int yValue = itemHeight + path.section * (itemHeight + space);
    attributes.center = CGPointMake(xValue, yValue);
    return attributes;
}

-(NSArray*)layoutAttributesForElementsInRect:(CGRect)rect {
    NSInteger minRow =  (rect.origin.x > 0)?  rect.origin.x/(itemWidth + space) : 0; // need to check because bounce gives negative values  for x.
    NSInteger maxRow = rect.size.width/(itemWidth + space) + minRow;
    NSMutableArray* attributes = [NSMutableArray array];
    for(NSInteger i=0 ; i < self.collectionView.numberOfSections; i++) {
        for (NSInteger j=minRow ; j < maxRow; j++) {
            NSIndexPath* indexPath = [NSIndexPath indexPathForItem:j inSection:i];
            [attributes addObject:[self layoutAttributesForItemAtIndexPath:indexPath]];
        }
    }
    return attributes;
} 
```

最后，这是 的子类`UICollectionView`：

```
-(void)layoutSubviews {
    [super layoutSubviews];
    CGPoint currentOffset = self.contentOffset;
    CGFloat contentWidth = self.contentSize.width;
    CGFloat contentHeight = self.contentSize.height;
    CGFloat centerOffsetX = (contentWidth - self.bounds.size.width)/ 2.0;
    CGFloat centerOffsetY = (contentHeight - self.bounds.size.height)/ 2.0;
    CGFloat distanceFromCenterX = fabsf(currentOffset.x - centerOffsetX);
    CGFloat distanceFromCenterY = fabsf(currentOffset.y - centerOffsetY);

    if (distanceFromCenterX > contentWidth/4.0) { // this number of 4.0 is arbitrary
        self.contentOffset = CGPointMake(centerOffsetX, currentOffset.y);
    }
    if (distanceFromCenterY > contentHeight/4.0) {
        self.contentOffset = CGPointMake(currentOffset.x, centerOffsetY);
    }
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-02-22T04:38:30.123

@updated for swift 3 并更改了 maxRow 的计算方式，否则最后一列被截断并可能导致错误

```
import UIKit

class NodeMap : UICollectionViewController {
    var rows = 10
    var cols = 10

    override func viewDidLoad(){
        self.collectionView!.collectionViewLayout = NodeLayout(itemWidth: 400.0, itemHeight: 300.0, space: 5.0)
    }

    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
        return rows
    }

    override func numberOfSections(in collectionView: UICollectionView) -> Int {
        return cols
    }

    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -> UICollectionViewCell {
        return collectionView.dequeueReusableCell(withReuseIdentifier: "node", for: indexPath)
    }
}

class NodeLayout : UICollectionViewFlowLayout {
    var itemWidth : CGFloat
    var itemHeight : CGFloat
    var space : CGFloat
    var columns: Int{
        return self.collectionView!.numberOfItems(inSection: 0)
    }
    var rows: Int{
        return self.collectionView!.numberOfSections
    }

    init(itemWidth: CGFloat, itemHeight: CGFloat, space: CGFloat) {
        self.itemWidth = itemWidth
        self.itemHeight = itemHeight
        self.space = space
        super.init()
    }

    required init(coder aDecoder: NSCoder) {
        self.itemWidth = 50
        self.itemHeight = 50
        self.space = 3
        super.init()
    }

    override var collectionViewContentSize: CGSize{
        let w : CGFloat = CGFloat(columns) * (itemWidth + space)
        let h : CGFloat = CGFloat(rows) * (itemHeight + space)
        return CGSize(width: w, height: h)
    }

    override func layoutAttributesForItem(at indexPath: IndexPath) -> UICollectionViewLayoutAttributes? {
        let attributes = UICollectionViewLayoutAttributes(forCellWith: indexPath)
        let x : CGFloat = CGFloat(indexPath.row) * (itemWidth + space)
        let y : CGFloat = CGFloat(indexPath.section) + CGFloat(indexPath.section) * (itemHeight + space)
        attributes.frame = CGRect(x: x, y: y, width: itemWidth, height: itemHeight)
        return attributes
    }

    override func layoutAttributesForElements(in rect: CGRect) -> [UICollectionViewLayoutAttributes]? {
        let minRow : Int = (rect.origin.x > 0) ? Int(floor(rect.origin.x/(itemWidth + space))) : 0
        let maxRow : Int = min(columns - 1, Int(ceil(rect.size.width / (itemWidth + space)) + CGFloat(minRow)))
        var attributes : Array<UICollectionViewLayoutAttributes> = [UICollectionViewLayoutAttributes]()
        for i in 0 ..< rows {
            for j in minRow ... maxRow {
                attributes.append(self.layoutAttributesForItem(at: IndexPath(item: j, section: i))!)
            }
        }
        return attributes
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-04T22:13:40.927

@rdelmar 的回答就像一个魅力，但我需要迅速做到这一点。这是转换:)

```
class NodeMap : UICollectionViewController {
    @IBOutlet var activateNodeButton : UIBarButtonItem?
    var rows = 10
    var cols = 10
    override func collectionView(collectionView: UICollectionView, numberOfItemsInSection section: Int) -> Int {
        return rows
    }
    override func numberOfSectionsInCollectionView(collectionView: UICollectionView) -> Int {
        return cols
    }
    override func collectionView(collectionView: UICollectionView, cellForItemAtIndexPath indexPath: NSIndexPath) -> UICollectionViewCell {
        return collectionView.dequeueReusableCellWithReuseIdentifier("node", forIndexPath: indexPath)
    }
    override func viewDidLoad() {
        self.collectionView!.collectionViewLayout = NodeLayout(itemWidth: 100.0, itemHeight: 100.0, space: 5.0)
    }
}

class NodeLayout : UICollectionViewFlowLayout {
    var itemWidth : CGFloat
    var itemHeight : CGFloat
    var space : CGFloat
    init(itemWidth: CGFloat, itemHeight: CGFloat, space: CGFloat) {
        self.itemWidth = itemWidth
        self.itemHeight = itemHeight
        self.space = space
        super.init()
    }
    required init(coder aDecoder: NSCoder) {
        self.itemWidth = 50
        self.itemHeight = 50
        self.space = 3
        super.init()
    }
    override func collectionViewContentSize() -> CGSize {
        let w : CGFloat = CGFloat(self.collectionView!.numberOfItemsInSection(0)) * (itemWidth + space)
        let h : CGFloat = CGFloat(self.collectionView!.numberOfSections()) * (itemHeight + space)
        return CGSizeMake(w, h)
    }
    override func layoutAttributesForItemAtIndexPath(indexPath: NSIndexPath) -> UICollectionViewLayoutAttributes! {
        let attributes = UICollectionViewLayoutAttributes(forCellWithIndexPath: indexPath)
        let x : CGFloat = CGFloat(indexPath.row) * (itemWidth + space)
        let y : CGFloat = CGFloat(indexPath.section) + CGFloat(indexPath.section) * (itemHeight + space)
        attributes.frame = CGRectMake(x, y, itemWidth, itemHeight)
        return attributes
    }
    override func layoutAttributesForElementsInRect(rect: CGRect) -> [AnyObject]? {
        let minRow : Int = (rect.origin.x > 0) ? Int(floor(rect.origin.x/(itemWidth + space))) : 0
        let maxRow : Int = Int(floor(rect.size.width/(itemWidth + space)) + CGFloat(minRow))
        var attributes : Array<UICollectionViewLayoutAttributes> = [UICollectionViewLayoutAttributes]()
        for i in 0...self.collectionView!.numberOfSections()-1 {
            for j in minRow...maxRow {
                attributes.append(self.layoutAttributesForItemAtIndexPath(NSIndexPath(forItem: j, inSection: i)))
            }
        }
        return attributes
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-03-24T11:52:47.630

重置 contentOffset 可能是迄今为止找到的最佳解决方案。 [![无限滚动最终结果](../Images/3ea1e7001d9a9af48519dd48c1d2afa9.png)](https://i.stack.imgur.com/JMt1c.gif)

应该采取一些步骤来实现这一点：

1.  在原始数据集的左右两侧填充额外的项，以实现更大的可滚动区域；这类似于拥有大量重复数据集，但不同之处在于数量；
2.  开始时，collection view 的 contentOffset 被计算为只显示原始数据集（用黑色矩形绘制）；
3.  当用户向右滚动并且 contentOffset 达到触发值时，我们重置 contentOffset 以显示相同的视觉结果；但实际上不同的数据；当用户向左滚动时，使用相同的逻辑。

[![在此处输入图像描述](../Images/cd3469d873e319db52088bafb3f58bf5.png)](https://i.stack.imgur.com/uCvHv.png)

因此，繁重的工作是计算应该在左侧和右侧填充多少项目。如果您看一下插图，您会发现至少应该在左侧填充一个额外的屏幕项目，并且在右侧填充另一个额外的屏幕。填充的确切数量取决于原始数据集中有多少项目以及项目大小。

我写了一篇关于这个解决方案的帖子：

[http://www.awsomejiang.com/2018/03/24/Infinite-Scrolling-and-the-Tiling-Logic/](http://www.awsomejiang.com/2018/03/24/Infinite-Scrolling-and-the-Tiling-Logic/)

# android - 有一种方法可以在 android 3+ 的选项菜单上放置一个图标

> ID：15549236
> 
> 赞同：0
> 
> 时间：2013-03-21T13:42:37.573
> 
> 标签：android, user-interface, menu, android-optionsmenu

有一种方法可以在 android 的新选项菜单样式上放置一个图标？附言。我不想为此使用 actionBar。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:48:02.300

你应该读[这个](http://developer.android.com/design/patterns/actionbar.html)。ActionBar 的原因是提供一致的 UI 以帮助用户对应用程序感到更舒服。如果我完全理解您的要求，那么您不应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T13:58:18.780

> 有一种方法可以在 android 的新选项菜单样式上放置一个图标？

不，对不起。

# extjs - 在 sencha 架构师中添加 odata 代理

> ID：15549238
> 
> 赞同：1
> 
> 时间：2013-03-21T13:42:50.620
> 
> 标签：extjs, sencha-touch-2, odata, sencha-architect

任何人都可以帮助我如何在模型代理中的 Sencha 架构师中添加 odata 代理。在列表中我只能看到![在此处输入图像描述](../Images/560838886607afc7d08112cbce8f0987.png)。如何为 Sencha 架构师的模型添加 Odata 代理？

[SAP 演示](http://scn.sap.com/community/mobile/blog/2012/12/21/building-sap-mobile-apps-with-sencha-touch--part-2)

我无法从 Sencha 架构师那里编辑我的代理设置。

# symfony - 更新到 Symfony 2.1.8 后，Doctrine 固定装置不起作用

> ID：15549240
> 
> 赞同：2
> 
> 时间：2013-03-21T13:42:57.247
> 
> 标签：symfony, doctrine-orm, symfony-2.1, fixtures

将项目从 Symfony 2.0.22 更新到 2.1.8 后，`doctrine:fixtures:load`通过终端执行时出现此错误

> 致命错误：在第 27 行的 {symfony_install_folder}/vendor/symfony/symfony/src/Symfony/Bridge/Doctrine/DataFixtures/ContainerAwareLoader.php 中找不到类 'Doctrine\Common\DataFixtures\Loader'

夹具在 2.0.22 上工作，我检查[了官方文档](http://symfony.com/doc/2.1/bundles/DoctrineFixturesBundle/index.html)，看看我是否正确设置了所有内容

我的**composer.json**看起来像这样：

```
{
    "name": "symfony/framework-standard-edition",
    "description": "The \"Symfony Standard Edition\" distribution",
    "autoload": {
        "psr-0": { "": "src/" }
    },
    "require": {
        "php": ">=5.3.3",
        "symfony/symfony": "2.1.8",
        "doctrine/orm": ">=2.2.3,<2.5-dev",
        "doctrine/dbal": "2.3.*@dev",
        "doctrine/doctrine-bundle": "1.1.*",
        "twig/extensions": "1.0.*@dev",
        "symfony/assetic-bundle": "2.1.*",
        "symfony/swiftmailer-bundle": "2.1.*",
        "symfony/monolog-bundle": "2.1.*",
        "sensio/distribution-bundle": "2.1.*",
        "sensio/framework-extra-bundle": "2.1.*",
        "sensio/generator-bundle": "2.1.*",
        "jms/security-extra-bundle": "1.2.*",
        "jms/di-extra-bundle": "1.1.*",
        "kriswallsmith/assetic": "1.1.*@dev",
        "doctrine/common": "2.4.*@dev",
        "doctrine/data-fixtures": "2.0.*@dev",
        "doctrine/doctrine-fixtures-bundle" : "dev-master",
        "gedmo/doctrine-extensions": "2.3.*@dev",
        "stof/doctrine-extensions-bundle" : "1.1.*@dev",
        "friendsofsymfony/jsrouting-bundle": "1.1.*@dev"

    },
    "scripts": {
        "post-install-cmd": [
            "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::buildBootstrap",
            "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache",
            "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets",
            "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile"
        ],
        "post-update-cmd": [
            "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::buildBootstrap",
            "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache",
            "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets",
            "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile"
        ]
    },
    "extra": {
        "symfony-app-dir": "app",
        "symfony-web-dir": "web",
        "branch-alias": {
            "dev-master": "2.1-dev"
        }
    }
} 
```

还有我的**app/AppKernel.php**

```
<?php

use Symfony\Component\HttpKernel\Kernel;
use Symfony\Component\Config\Loader\LoaderInterface;

class AppKernel extends Kernel
{
    public function registerBundles()
    {
        $bundles = array(
            new Symfony\Bundle\FrameworkBundle\FrameworkBundle(),
            new Symfony\Bundle\SecurityBundle\SecurityBundle(),
            new Symfony\Bundle\TwigBundle\TwigBundle(),
            new Symfony\Bundle\MonologBundle\MonologBundle(),
            new Symfony\Bundle\SwiftmailerBundle\SwiftmailerBundle(),
            new Doctrine\Bundle\DoctrineBundle\DoctrineBundle(),
            new Symfony\Bundle\AsseticBundle\AsseticBundle(),
            new Sensio\Bundle\FrameworkExtraBundle\SensioFrameworkExtraBundle(),
            new JMS\SecurityExtraBundle\JMSSecurityExtraBundle(),
            new JMS\AopBundle\JMSAopBundle(),
            new JMS\DiExtraBundle\JMSDiExtraBundle($this),
            new Stof\DoctrineExtensionsBundle\StofDoctrineExtensionsBundle(),
            new FOS\JsRoutingBundle\FOSJsRoutingBundle(),

        );

        if (in_array($this->getEnvironment(), array('dev', 'test'))) {
            $bundles[] = new Symfony\Bundle\WebProfilerBundle\WebProfilerBundle();
            $bundles[] = new Sensio\Bundle\DistributionBundle\SensioDistributionBundle();
            $bundles[] = new Sensio\Bundle\GeneratorBundle\SensioGeneratorBundle();
            $bundles[] = new Doctrine\Bundle\FixturesBundle\DoctrineFixturesBundle();
        }

        return $bundles;
    }

    public function registerContainerConfiguration(LoaderInterface $loader)
    {
        $loader->load(__DIR__.'/config/config_'.$this->getEnvironment().'.yml');
    }

    public function getCharset()
    {
        return 'UTF-8';
    }
} 
```

正在加载的第一个夹具：

```
use Doctrine\Common\DataFixtures\AbstractFixture,
    Doctrine\Common\DataFixtures\OrderedFixtureInterface,
    Doctrine\Common\Persistence\ObjectManager;

use Symfony\Component\DependencyInjection\ContainerAwareInterface,
    Symfony\Component\DependencyInjection\ContainerInterface;

use Acme\CoreBundle\Entity\User;

class LoadUserData extends AbstractFixture implements OrderedFixtureInterface, ContainerAwareInterface
{
    private $container;

    public function setContainer(ContainerInterface $container = null)
    {
        $this->container    = $container;
    }

    public function load(ObjectManager $manager)
    {
        // Do stuff
    }

    public function getOrder()
    {
        return 1;
    }
} 
```

我不知道在哪里看，`composer update`运行得很好。

有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T14:53:14.790

在DoctrineFixturesBundle 的存储库中找到了[这个问题的解决方案。](https://github.com/doctrine/DoctrineFixturesBundle/issues/73#issuecomment-12268057)

重新排列依赖关系并使用另一个版本`doctrine/data-fixtures`解决了这个问题。

我在**composer.json**中替换了这些行：

```
"require": {
    "doctrine/data-fixtures": "2.0.*@dev",
    "doctrine/doctrine-fixtures-bundle" : "dev-master"
} 
```

和

```
"require": {
    "doctrine/doctrine-fixtures-bundle" : "dev-master",
    "doctrine/data-fixtures": "1.0.*@ALPHA"
} 
```

并且正在再次加载固定装置。

# matlab - Matlab 从单元格中提取数据

> ID：15549247
> 
> 赞同：-1
> 
> 时间：2013-03-21T13:43:20.913
> 
> 标签：matlab, cell

假设我有 C 单元，如下所述：

C =

```
[31, 17]      [57, 17]       [83, 17]      [109, 17]     [135, 17]
[31, 33]      [57, 33]       [83, 33]      [109, 33]     [135, 33]
[31, 49]      [57, 49]       [83, 49]      [109, 49]     [135, 49]
[31, 65]      [57, 65]       [83, 65]      [109, 65]     [135, 65]
[31, 81]      [57, 81]       [83, 81]      [109, 81]     [135, 81]
[31, 97]      [57, 97]       [83, 97]      [109, 97]     [135, 97]
[31, 113]     [57, 113]      [83, 113]     [109, 113]    [135, 113]
[31, 129]     [57, 129]      [83, 129]     [109, 129]    [135, 129]
[31, 145]     [57, 145]      [83, 145]     [109, 145]    [135, 145]
[31, 161]     [57, 161]      [83, 161]     [109, 161]    [135, 161]
[31, 177]     [57, 177]      [83, 177]     [109, 177]    [135, 177] 
```

现在我想在新的矩阵中提取所有数据，
如下所示：

```
C11 = ([31,17] [57,17]; [31,33] [57,33])          
C12 = ([57,17] [83,17]; [57,33] [83,33])                       
C13 = ([83,17] [109,17]; [83,33] [109,33])    
C14 = ([109,17] [135,17]; [109,33] [135,33])    
C21 = ([31,33] [57,33]; [31,49] [57,49])                           
C22 = ([57,33] [83,33]; [57,49] [83,49])
C23 = ([83,33] [109,33]; [83,49] [109,49]) 

....... ........ ....... ...... ..               

C104 = ([109,161] [135,161]; [109,177] [109,177]) 
```

在 Matlab 中如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:54:29.727

只需使用带圆括号的数组下标。例如 ,`C12`会这样计算：

```
>> C12(1:2, 2:3)

ans =
    { [ 57 17 ]    [ 83 17 ] }
    { [ 57 33 ]    [ 83 33 ] } 
```

您可以执行一个 for 循环来遍历您的单元格数组并逐个提取必要的单元格，并将每个单元格存储在不同的变量中。但是，所有的数据都已经存储了`C`，为什么要复制呢？我建议您将所有内容保存在一个单元格数组中，并仅在需要时提取矩阵。

# c# - WPF TabControl 选项卡更改未刷新

> ID：15549254
> 
> 赞同：0
> 
> 时间：2013-03-21T13:43:37.783
> 
> 标签：c#, wpf, button, tabcontrol, thread-sleep

我有`WPF TabControl`两个`TabItems`。我正在尝试更改`Button`单击事件后面代码上的选定选项卡并执行一些其他代码。在这个例子中：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    ConvertDataTabControl.SelectedIndex = 1;
    System.Threading.Thread.Sleep(2000);
    ...
} 
```

我希望 UI 刷新并从`Tab 0`to移动，`Tab 1`然后才执行 Sleep 方法，但 UI 仅在`Button_Click`完成执行后才会刷新。我试过打电话`InvalidateVisual`，但它不起作用。

有没有办法在执行之前强制 UI 刷新`Sleep`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:56:16.900

默认情况下，您的代码在 UI 线程上运行，因此在线程完成执行之前，无法在 UI 线程上执行任何其他操作（例如更新布局）。

有很多方法可以在代码完成执行之前释放对 UI 线程的控制，但我发现最简单的方法是使用[任务并行库](http://msdn.microsoft.com/en-us/library/dd460717.aspx)`Task`中的一个，它可用于在单独的线程上运行代码。

例如，

```
Task.Factory.StartNew(() =>
{
    Thread.Sleep(2000);

    // Other code here
}); 
```

需要注意的是，UI 对象只能在 UI 线程上修改，因此如果您的“此处的其他代码”更新了 UI 对象，您可能希望使用[Dispatcher](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)在 UI 线程上执行代码，如下所示：

```
Dispatcher.BeginInvoke(() =>
{
    // Code to update the UI
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T13:45:07.980

尝试

```
Dispatcher.BeginInvoke(()=>
{
    ConvertDataTabControl.SelectedIndex = 1;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-10T09:36:45.510

问题是你在 UI 线程上做你的工作（睡眠）。您可以使用任务/后台工作人员/等在其他线程中完成工作，然后将 ui 更改设置回 UI 线程：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    Dispatcher callback = Dispatcher.CurrentDispatcher;
    ThreadPool.QueueUserWorkItem(new WaitCallback((o) =>
    {
         //Do some work
         System.Threading.Thread.Sleep(2000);

         //callbackk to ui thread to do ui work. You can also use BeginInvoke...
         callback.Invoke(new Action(() => {ConvertDataTabControl.SelectedIndex = 1;}));

         //Do some more work
         System.Threading.Thread.Sleep(2000);
         ...
    }
} 
```

这只是一个例子。

# windows-phone-7 - 来自隔离存储 Windows 手机的路径

> ID：15549258
> 
> 赞同：1
> 
> 时间：2013-03-21T13:43:42.113
> 
> 标签：windows-phone-7, isolatedstorage

嗨，我有一个简单的问题，我如何找到已保存在隔离存储中的文件的路径

```
using (IsolatedStorageFileStream stream = new IsolatedStorageFileStream(App.filePath, FileMode.Create, store))
            {

                byte[] buffer = new byte[1024];
                while (e.Result.Read(buffer, 0, buffer.Length) > 0)
                {
                    stream.Write(buffer, 0, buffer.Length);
                }
                stream.Close();

            } 
```

现在我会读取这个文件我需要这个路径来使用它作为方法的参数

```
Epub epub =new Epub([file path]) 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T16:12:29.830

如果您是将文件放入隔离存储的人，则无需获取文件的路径。有关如何正确读取和写入文件到应用程序 isostore 的完整指南可[在此处](http://www.geekchamp.com/tips/all-about-wp7-isolated-storage--intro-to-isolated-storage)获得，这应该是您的起点。

整个阅读程序仅限于此：

```
using (IsolatedStorageFileStream fileStream = myIsolatedStorage.OpenFile("myFile.txt", FileMode.Open, FileAccess.Read))
{
    using (StreamReader reader = new StreamReader(fileStream))
    {
       Console.WriteLine("Reading contents:");
       Console.WriteLine(reader.ReadToEnd());
    }
} 
```

哪里`myIsolatedStorage`等于`IsolatedStorageFile.GetUserStoreForApplication()`（又名您的本地应用程序存储盒）。

正如您在评论中所展示的，不需要反射。可以相对于文件夹，当您尝试阅读时，`/MyFolder/myFile.txt`如果文件夹存在，类似的东西也可以工作。

您的问题是 - 将 isostore 中的相对路径推送到`Epub`类，该类可能不会直接从 isostore 读取，而是使用完整路径。Windows Phone 操作系统的本质是它不会让没有适当权限的第三方应用程序直接通过完整路径引用访问内容。所以你需要想办法将二进制内容传递给类而不是路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:33:27.217

如果文件在 IsolatedStorage 中，您要么自己放在那里，要么是系统创建的用于存储设置的文件。

如果你把它放在那里，你一定在以前的某个时候有过路径。您只需要跟踪您正在使用的文件名（和路径）。

您不应尝试直接访问设置文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T14:59:23.743

尝试这个

```
using (var AppStorage = IsolatedStorageFile.GetUserStoreForApplication())
{
string[] filenames=AppStorage.getFileNames();
//choose the filename you want or
//enumerate directories and read file names in each directory
string[] directories=AppStorage.getDirectories();
} 
```

对于每个目录，您必须将文件路径添加到该目录，就像在任何 Windows 文件浏览中一样。

希望它有帮助。发布您的进一步查询。

# file-upload - CI中的文件上传问题

> ID：15549262
> 
> 赞同：0
> 
> 时间：2013-03-21T13:44:01.767
> 
> 标签：file-upload, codeigniter-2

我正在使用 CI 并在上传文件时遇到问题。它给出了下面提到的消息。

====================================================严重性：警告

消息：escapeshellarg() 出于安全原因已被禁用

文件名：库/Upload.php

# 行号：1066

在一些答案中，我发现这是一个服务器问题，CI 与它无关。现在，有没有办法绕过escapeshellarg（）上传文件，或者有没有我可以使用的不需要escapeshellarg（）的库？

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T16:02:13.353

我不确定您使用的是哪个特定版本的 CI，但最新版本在使用之前会检查该功能。

看看[这里的代码](https://github.com/EllisLab/CodeIgniter/blob/develop/system/libraries/Upload.php#L1219)：

```
$cmd = function_exists('escapeshellarg')
    ? 'file --brief --mime '.escapeshellarg($file['tmp_name']).' 2>&1'
    : 'file --brief --mime '.$file['tmp_name'].' 2>&1'; 
```

我会说手动升级或更新代码。

# python-2.7 - Python (2.7)：如何避免导入的模块出现在我的模块中？

> ID：15549271
> 
> 赞同：0
> 
> 时间：2013-03-21T13:44:32.450
> 
> 标签：python-2.7, python-import

我编写了两个模块 m1.py 和 m2.py，每个模块都使用标准库中的各种模块。

例如

```
#m1.py
import sys
#.
#. 
```

和

```
#m2.py
import os
#.
#. 
```

让我“困扰”的是，当我在 main.py 中导入两个模块 m1.py 和 m2.py 时，我可以使用 sys 和 os 中定义的函数，如下所示：

```
#main.py
print m1.sys.version
print m2.os.listdir() 
```

这是正常的，还是在我的代码中导入模块时我应该考虑一些事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:41:47.583

通常，您无需担心命名空间中可以访问的内容。任何乱搞不属于模块文档 API 的东西的人都应该遇到任何麻烦。Python 假定它的程序员是负责任的成年人。

例外情况是当您特别希望允许其他代码使用其他不鼓励使用的`from mymodule import *`语法时。然后你想限制什么是公开的，这样你就不会用你自己的内部东西弄乱你的导入器的命名空间。

您可以这样做：

*   以下划线开头的名称（例如`_foo`）被认为是私有的，并且不会使用`from mymodule import *`. 这不是“真正的”隐私，因为任何进行正常导入的人仍然可以通过`mymodule._foo`（但他们可能不应该！）访问它们。

*   如果您想将要导入的模块设为私有，请使用一个`as`子句为它们指定一个“私有”名称，如上所述。也就是说，使用`import os as _os`.

*   `__all__`或者，您可以创建一个明确列出模块公共名称的变量，而不是使用下划线。只有列表中的名称将通过`from mymodule import *`语句导入。请注意，`__all__`如果您希望子模块可以通过`from mypackage import *`. 这是因为 Python 不能相信文件系统不会弄乱包中文件名的大小写。

# sql - 如何比较入住酒店的日期大于某个数字

> ID：15549272
> 
> 赞同：0
> 
> 时间：2013-03-21T13:44:33.287
> 
> 标签：sql, oracle, sql-date-functions

我正在尝试从我的数据库中计算所有预订，客人预订时间超过一定时间。到达日期和离开日期在预订表中。我正在使用 oracle 在 sqlplus 中工作，并且弹出错误无效标识**datediff 。**这是我的尝试。我还希望能够在打印时显示每个预订日志的日期差异。

```
SELECT b.BOOKINGID, g.FORENAME, g.SURNAME 
FROM GUEST g, BOOKING b
WHERE g.GUESTID = b.GUESTID AND
DATEDIFF(day, b.DEPARTDATE, b.ARRIVEDATE) > 2; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T13:50:19.823

试试 Oracle 等效的：

```
SELECT b.BOOKINGID, g.FORENAME, g.SURNAME 
FROM GUEST g join
      BOOKING b
      on g.GUESTID = b.GUESTID
where  (b.DEPARTDATE - b.ARRIVEDATE) > 2; 
```

我还更改了查询以使用 ANSI 连接语法。

注意：这假设日期没有时间戳。如果是这样，您可能想要：

```
where trunc(b.departdate) - trunc(b.arrivedate) > 2 
```

获得晚数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T13:50:06.997

在 ORACLE`DATEDIFF`中不存在。
但在 Oracle 中，您可以直接在两个日期之间使用**+**或**-操作数。**

所以你的请求可能是：（编辑在选择中添加差异值）

```
 SELECT b.BOOKINGID, g.FORENAME, g.SURNAME, 
 CASE WHEN (SYSDATE - b.DEPARTDATE) > 0 THEN CONCAT((SYSDATE - b.DEPARTDATE), ' days late')
 ELSE CONCAT((b.DEPARTDATE - SYSDATE),' days left')
 END AS "Booking Status"
 FROM GUEST g, BOOKING b
 WHERE g.GUESTID = b.GUESTID
 AND (SYSDATE - b.DEPARTDATE) > 2; 
```

此查询仅显示至少迟到 2 天的预订。

**编辑**

您正在寻找的查询是：（与[Gordon Linoff](https://stackoverflow.com/users/1144035/gordon-linoff)所做的几乎相同）

```
 SELECT b.BOOKINGID, g.FORENAME, g.SURNAME, (b.DEPARTDATE - b.ARRIVEDATE) as booking_duration
 FROM GUEST g, BOOKING b
 WHERE g.GUESTID = b.GUESTID
 AND (b.DEPARTDATE - b.ARRIVEDATE) > 2; 
```

# javascript - 如何在用户开始播放视频然后自动播放后开始暂停 html5 视频？

> ID：15549277
> 
> 赞同：0
> 
> 时间：2013-03-21T13:44:43.517
> 
> 标签：javascript, jquery, html, html5-video, video-player

我创建了一个 html5 视频播放列表。当页面首次加载时，我希望视频暂停，因此用户可以选择开始自动播放序列。

代码：

```
<!DOCTYPE html> 
<html> 
<head> 
<script type='text/javascript'>//<![CDATA[ 
window.onload=function(){
var videoPlayer= document.getElementById('video');

videoPlayer.addEventListener('ended', function(){
this.pause();
this.src = "http://www.mp4point.com/downloads/8feeca1a540b.mp4";
}, false);

}//]]>  

</script> 

</head> 
<body> 
  <video id="video" src="http://media.w3.org/2010/05/sintel/trailer.mp4" autoplay autobuffer controls /> 

</body> 

</html> 
```

jsfiddle：http: [//jsfiddle.net/3uRq6/7/](http://jsfiddle.net/3uRq6/7/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:10:49.620

从外观上看，您需要颠倒您的逻辑。从您的事件侦听器中删除`autoplay`属性，`<video>`您应该更改`src`然后播放视频。

[http://jsfiddle.net/3uRq6/9/](http://jsfiddle.net/3uRq6/9/)

```
<!DOCTYPE html> 
<html> 
<head> 
<script type='text/javascript'>//<![CDATA[ 
window.onload=function(){
var videoPlayer= document.getElementById('video');

videoPlayer.addEventListener('ended', function(){
    this.src = "http://www.mp4point.com/downloads/8feeca1a540b.mp4";
    this.play();
}, false);

}//]]>  

</script> 

</head> 
<body> 
  <video id="video" src="http://media.w3.org/2010/05/sintel/trailer.mp4" autobuffer controls /> 

</body> 

</html> 
```

# asp.net - XML 数据源和 Gridview

> ID：15549281
> 
> 赞同：0
> 
> 时间：2013-03-21T13:45:01.367
> 
> 标签：asp.net, xml, gridview

我在运行进程时创建了一个 XML 文件，该文件的位置存储在**GlobalClass.GlobalUrl**

我有一个网格视图，完成该过程后，将网格视图连接到一个 xml 数据源。这是有的代码

```
XmlDataSource1.DataFile = GlobalClass.GlobalUrl
XmlDataSource1.DataBind()

GridView1.DataSource = "XmlDataSource1"
GridView1.DataBind()

Item
Select  X
Select  m
Select  l
Select  D
Select  a
Select  t
Select  a
Select  S
Select  o
Select  u
Select  r
Select  c
Select  e
Select  1 
```

这就是我得到的输出。请帮忙。顺便说一下，GlobalClass.GlobalUrl 是 XML 文件的路径

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:57:40.550

我要做的是将 xml 转换为数据集 - 使用 ReadXml()。然后设置数据源并绑定。像这样的东西：

```
DataSet xmlDataSet = new DataSet();
xmlDataSet.ReadXml("D:\\xmlPath");

GridView1.DataSource = xmlData.Tables[0];
GridVIew1.DataBind(); 
```

# iphone - 如何在 iPhone 中将实时屏幕相机图标从纵向模式切换为横向模式？

> ID：15549283
> 
> 赞同：1
> 
> 时间：2013-03-21T13:45:06.230
> 
> 标签：iphone, camera, orientation, ios6.1

我为实时屏幕相机视图创建了一个**自定义相机叠加层**，并为相机、闪光灯和翻转按钮导入了我自己的自定义图标。在纵向模式下一切看起来都很好，但是当我将实时相机屏幕切换到横向模式时，相机的方向保持在纵向模式并在控制台中显示，

**“错误：CGAffineTransformInvert：奇异矩阵”**

我尝试使用**自动调整大小掩码，还尝试在****didRotateFromInterfaceOrientation**方法中为纵向和横向模式下的图标设置两个不同的框架。但这些都不起作用。

我的问题是，横向方向是否只支持默认的 iPhone 相机覆盖视图，或者它是否也支持自定义覆盖视图。

以下是显示从纵向模式切换到横向模式时图标相互重新定位的行为的屏幕截图。我想在我的自定义叠加视图中完全一样。

**编辑：**

我已经使用**UIDevice Orientation**方法更改了自定义相机叠加层的实时屏幕。但是现在，当我尝试从纵向模式切换到横向模式时，框架没有调整大小。所以，我只想让整个框架在横向模式下调整大小。此外，在这段代码中，如果我尝试更改**CAMERA_TRANSFORM_Y**的值，

```
#define CAMERA_TRANSFORM_X 1
#define CAMERA_TRANSFORM_Y 1.234

  self.picker.cameraViewTransform = CGAffineTransformScale(self.picker.cameraViewTransform, CAMERA_TRANSFORM_X, CAMERA_TRANSFORM_Y); 
```

覆盖视图的大小从顶部和底部边距都减小了。但是，从底部比从上边距减小的尺寸更多。我希望覆盖大小从顶部和底部边距均匀变化。

这是我的示例代码，

[示例项目](https://www.dropbox.com/s/eha3snfnrjamdzo/CustomCamera.zip)

![横向模式](../Images/061af4286e060d96132b85c383ddf09f.png)

![肖像模式](../Images/8ad03a49a45bfd306d6827861147e58a.png)

# c++ - 将 n 维“正方形”空间划分为立方体

> ID：15549289
> 
> 赞同：2
> 
> 时间：2013-03-21T13:45:18.443
> 
> 标签：c++, optimization, mathematical-optimization

现在我被困在解决以下“半”数学问题。

我想划分一个 n 维受限空间（准确地说是一个超立方体）

`D={(x_1, ...,x_n), x_i \in IR and -limits<=x_i<=limits \forall i<=n}` 成更小的立方体。

这意味着我想指定立方体每边的分区数`n,limits,m`在哪里-将是小立方体的长度，我会得到这样的立方体。`m``2*limits/m``m^n`

现在我想返回一个向量向量，其中包含这些小立方体的一些不同坐标。（或者也许可以将立方体表示为以指向“左”外角的向量为特征的对象？）

基本上我不知道这样的事情是否甚至可以使用 C++。为固定的 n 实现这一点不会造成问题。但我想让用户可以自由选择尺寸。

**背景：**这样的东西在优化中是无价的。将空间划分为更小的空间，并在每个子空间上使用例如遗传算法，然后比较结果。因此，可以避免巨大的初始人口，并大大改善搜索结果。我也只是好奇是否……。这样是可行的:)

**我的建议：** 使用 B+ 树？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T04:27:42.783

令 m 为超立方体 D 的每个维度（即每条*边）的分区数。*

然后有 m^n 个 D 的不同子空间 S，就像你说的那样。让子空间 S 由整数坐标 S=[y_1,y_2,...,y_n] 唯一表示，其中 y_i 是 1,...,m 范围内的整数。那么，在笛卡尔坐标中，S=(x_1,x_2,...,x_n)，其中 Delta*(y_i-1)-limits <= x_i < Delta*y_i-limits，Delta=2*limits/m。

您正在寻找的“左外角”或 S 的原点只是对应于最小 x_i 的点，即点 (Delta*(y_1-1)-limits, ..., Delta*(y_n-1)-限制）。与其在这一点上表示不同的 S，不如使用上面的整数坐标来表示它们更有意义（并且在计算机中会更快）。

# java-me - 如何在 j2me 中使用 WAP 开发聊天应用程序？

> ID：15549292
> 
> 赞同：0
> 
> 时间：2013-03-21T13:45:23.333
> 
> 标签：java-me, chat

我是 J2ME 的新手，我想使用 WAP 开发一个聊天应用程序。我想要一个类似聊天的屏幕，它同时显示发送者消息和接收者消息。j2me中聊天应用的大部分例子都使用socket连接。但是我想使用`MessageConnection`J2ME的属性进行开发。

任何人都可以建议我如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T05:27:30.177

您可以创建一个使用特定端口发送和接收消息的应用程序。但是您需要在两部手机上都安装该应用程序，并且该应用程序将仅使用常规 SMS 资费。

# asp.net - ASP.NET，默认使用什么命名空间？

> ID：15549293
> 
> 赞同：0
> 
> 时间：2013-03-21T13:45:24.470
> 
> 标签：asp.net, namespaces

当我创建一个新网站时，Default.aspx 的 @Page 指令自动设置为`Inherits="_Default"`. 代码隐藏文件有`public partial class _Default : System.Web.UI.Page`但没有`namespace`指定。这是否意味着在编译时会生成一个随机命名空间名称？

所以，我想创建一个类来处理一些数据库工作，但不确定它属于哪个命名空间。我是否为此显式创建命名空间？即，如果我的班级在 中`MyNamespace`，那么 Default.aspx 将有`Inherits="MyNamespace._Default"`并且代码隐藏也将被包装在`namespace MyNamespace{ ... }`? 感谢您的澄清。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:11:37.573

网站中没有任何命名空间 - 编译您的网站时，DLL 转到 App_Code 目录，然后在您的项目中自动引用这些类。

# caliburn.micro - 将模型传递给多个视图模型

> ID：15549294
> 
> 赞同：0
> 
> 时间：2013-03-21T13:45:28.373
> 
> 标签：caliburn.micro

我正在启动一个大型 WPF 应用程序，我将使用 Caliburn.micro 来增加它的趣味性。我有三个具有相应视图模型的视图，它们都与模型的*同一个*实例对话。

如何使用 Caliburn.micro 将模型传递给视图模型？

问题源于需要多个视图模型来访问同一个模型实例。它本质上是模型功能的不同部分，它们被分成更小的部分（VM 和 V），因为通常不需要模型的所有功能。

# android - 如何在有许多 IntentService 正在运行时停止一个 IntentService

> ID：15549296
> 
> 赞同：4
> 
> 时间：2013-03-21T13:45:35.270
> 
> 标签：android, service, download, intentservice

我有一个包含许多歌曲的列表视图。每次点击一首歌，我都会调用一个 IntentService 来按顺序下载这首歌。

但有时我想取消下载（例如：第 5 次）。这意味着我需要停止第 5 个正在运行的 IntentService。我试图通过调用 stopService() 来停止它，但它不起作用。

谁能告诉我停止 IntentService 的好方法？非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T13:50:01.597

清单中的`IntentService`每个元素只有一个 running 。`<service>`如果您调用`startService()`六次，最多`IntentService`将运行一次。`onHandleIntent()`如果在`IntentService`发送另一个命令时正在处理一个命令，则命令将排队并一次处理一个。

在您的情况下，由于您无法轻松取消未完成的命令`IntentService`，因此您可能需要创建自己的版本`IntentService`，在其中创建`Service`具有自己的工作队列的自己的子类，您可以在其中取消尚未完成的命令跑步。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-01T15:05:44.020

我在使用意图服务下载时遇到了同样的问题。在我的应用程序中，每次下载都有自己的通知，单击它时我想停止下载。

我通过覆盖 onStartCommand() 方法（在新意图到达时调用）解决了这个问题。当我想关闭一个下载时，我开始使用一个名为“stopid”的新意图：

```
Intent stopIntent = new Intent(DialogActivity.this,DownloadIntentService.class);
stopIntent.putExtra("stopid", id);
startService(stopIntent); 
```

onStartCommand() 方法如下所示：

```
@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    int id = intent.getExtras().getInt("stopid");
    if(id!=0) {
        stopList.add(id);
    }
    return super.onStartCommand(intent, flags, startId);
} 
```

对于普通的意图，只需将下载的 id 作为额外的内容放在您的意图中。在 onHandle() 方法中进行下载时，经常检查 stopList 是否包含您当前下载意图的 id。如果是，请停止下载并从 stopList 中删除 id。

# firebase - 如何将数据和设置从一个火力库迁移到另一个火力库？

> ID：15549299
> 
> 赞同：15
> 
> 时间：2013-03-21T13:45:43.097
> 
> 标签：firebase

是否有任何工具可以帮助将数据从 dev 迁移到 staging 到 prod？如果没有，是否有建造它们的计划？

我知道您可以从 Forge 导出 JSON 和导入 JSON，但这不包括授权和安全设置。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-21T15:30:16.307

我们所有的数据都可以通过 REST API 获得，因此您可以轻松编写脚本来自己执行此操作。您可以通过设置 format=export 导出数据（这包括响应中的所有优先级数据）：

```
curl https://myapp.firebaseIO.com/.json?format=export&auth=YOUR_FIREBASE_SECRET 
```

至于导出安全规则，您可以在这里访问它们：

```
curl https://myapp.firebaseIO.com/.settings/rules/.json?auth=YOUR_FIREBASE_SECRET 
```

然后，您可以使用 PUT 将它们写回新的 Firebase。

各种 Auth 设置不能轻易地自动传输（例如 Authorized Origins），但它们可能不应该如此，因为它们在 staging 和 production 之间会有所不同。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-12T03:24:06.970

安德鲁上面所说的大部分是正确的，但是对于大型火力基地来说这可能是一个痛苦。[https://github.com/firebase/firebase-import](https://github.com/firebase/firebase-import)有一个导入项目，它将通过分解 put 请求来帮助导入大型 firebase。另外需要注意的是，您需要在 curl url 周围使用引号，否则 & 将成为该过程的背景。所以安德鲁上面给出的将改为

curl -o outputfile.json " [https://myapp.firebaseIO.com/.json?format=export&auth=YOUR_FIREBASE_SECRET](https://myapp.firebaseIO.com/.json?format=export&auth=YOUR_FIREBASE_SECRET) "

然后您可以使用我与该 json 文件链接的导入模块。

祝你好运！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-05T18:22:05.450

如果你想要一个不需要 cURL 的选项，并且你已经`firebase-tools`安装了项目，你可以运行这个：

```
firebase database:get --export -o backup.json / 
```

请注意，这应该从配置为 Firebase 项目的工作目录运行。此选项的优点是它将使用您为该项目设置的身份验证，因此您无需将身份验证密钥硬编码到命令行中（出于安全意识），并且它不依赖于不推荐使用的身份验证密钥模式。

命令行 Fu：如果您想要为每个顶级键单独的文件，另一种很酷的技术是调用：

```
for i in `firebase database:get --shallow / | jq -r 'keys[]'`; do
    echo "Downloading $i..."
    firebase database:get --export -o $i.json /$i
done 
```

您需要安装“jq”工具才能使其工作。如果您以后想要恢复或仅使用部分数据，则单独导出每个集合非常有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-05T19:13:11.567

Firebase 正在开发一项新服务“S3 客户备份”，该服务将每晚将整个 Firebase 的 .gz 压缩备份复制到您提供给他们的 s3 存储桶中。我现在正在评估这项服务的测试版，但如果您需要它，我建议您寻求支持。

我们的 firebase 太大而无法完成 curl 操作，而这个新解决方案将使我们能够管理我们的开发环境。因此，如果您有一个大型火力库，请设置 S3 客户备份，然后使用 firebase-import 将数据推送到您的开发/暂存火力库中。胜利！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-10-06T19:25:04.857

我刚刚创建了[这个 ruby​​ gem](https://github.com/epool/firebase-cloning-tool)，用于从现有项目或新项目中克隆 firebase 远程配置数据。

# node.js - 无法在 linux 上安装 node-serialport

> ID：15549304
> 
> 赞同：0
> 
> 时间：2013-03-21T13:46:01.307
> 
> 标签：node.js, npm, node-serialport

我正在尝试使用以下方法安装 node-serialport 包：

```
nmp install serialport 
```

但不幸的是它不起作用，版本 os nodejs 安装在 10.0.0-1 中。以下是我收到的错误消息：

```
[user@home ~]$ npm install serialport
npm http GET https://registry.npmjs.org/serialport
npm http 304 https://registry.npmjs.org/serialport
npm http GET https://registry.npmjs.org/sf/0.1.3
npm http GET https://registry.npmjs.org/optimist
npm http GET https://registry.npmjs.org/node-gyp/0.6.2
npm http GET https://registry.npmjs.org/bindings/0.3.0
npm http GET https://registry.npmjs.org/async/0.1.18
npm http 304 https://registry.npmjs.org/async/0.1.18
npm http 304 https://registry.npmjs.org/bindings/0.3.0
npm http 304 https://registry.npmjs.org/node-gyp/0.6.2
npm http 304 https://registry.npmjs.org/sf/0.1.3
npm http 304 https://registry.npmjs.org/optimist
npm http GET https://registry.npmjs.org/wordwrap
npm http GET https://registry.npmjs.org/fstream
npm http GET https://registry.npmjs.org/mkdirp
npm http GET https://registry.npmjs.org/minimatch
npm http GET https://registry.npmjs.org/nopt
npm http GET https://registry.npmjs.org/npmlog
npm http GET https://registry.npmjs.org/osenv
npm http GET https://registry.npmjs.org/rimraf
npm http GET https://registry.npmjs.org/semver
npm http GET https://registry.npmjs.org/tar
npm http GET https://registry.npmjs.org/request
npm http GET https://registry.npmjs.org/which
npm http GET https://registry.npmjs.org/graceful-fs
npm http GET https://registry.npmjs.org/glob
npm http 304 https://registry.npmjs.org/wordwrap
npm http 304 https://registry.npmjs.org/npmlog
npm http 304 https://registry.npmjs.org/osenv
npm http 304 https://registry.npmjs.org/rimraf
npm http 304 https://registry.npmjs.org/minimatch
npm http 304 https://registry.npmjs.org/mkdirp
npm http 304 https://registry.npmjs.org/fstream
npm http 304 https://registry.npmjs.org/nopt
npm http 304 https://registry.npmjs.org/semver
npm http 304 https://registry.npmjs.org/tar
npm http 304 https://registry.npmjs.org/request
npm http 304 https://registry.npmjs.org/which
npm http 304 https://registry.npmjs.org/graceful-fs
npm http 304 https://registry.npmjs.org/glob
npm http GET https://registry.npmjs.org/ansi
npm http GET https://registry.npmjs.org/abbrev
npm http GET https://registry.npmjs.org/lru-cache
npm http GET https://registry.npmjs.org/sigmund
npm http GET https://registry.npmjs.org/inherits
npm http GET https://registry.npmjs.org/inherits
npm http GET https://registry.npmjs.org/inherits
npm http GET https://registry.npmjs.org/block-stream
npm http 304 https://registry.npmjs.org/abbrev
npm http 304 https://registry.npmjs.org/ansi
npm http 304 https://registry.npmjs.org/inherits
npm http 304 https://registry.npmjs.org/lru-cache
npm http 304 https://registry.npmjs.org/inherits
npm http 304 https://registry.npmjs.org/inherits
npm http 304 https://registry.npmjs.org/block-stream
npm http 304 https://registry.npmjs.org/sigmund

> serialport@1.0.8 install /home/user/node_modules/serialport
> node-gyp rebuild

make: Entering directory `/home/user/node_modules/serialport/build'
  CXX(target) Release/obj.target/serialport/src/serialport.o
../src/serialport.cpp: In function ‘v8::Handle<v8::Value> Open(const v8::Arguments&)’:
../src/serialport.cpp:51:64: error: invalid conversion from ‘void (*)(uv_work_t*) {aka void (*)(uv_work_s*)}’ to ‘uv_after_work_cb {aka void (*)(uv_work_s*, int)}’ [-fpermissive]
In file included from /home/user/.node-gyp/0.10.0/src/node.h:61:0,
                 from ../src/serialport.h:5,
                 from ../src/serialport.cpp:2:
/home/user/.node-gyp/0.10.0/deps/uv/include/uv.h:1397:15: error:   initializing argument 4 of ‘int uv_queue_work(uv_loop_t*, uv_work_t*, uv_work_cb, uv_after_work_cb)’ [-fpermissive]
../src/serialport.cpp: In function ‘v8::Handle<v8::Value> Write(const v8::Arguments&)’:
../src/serialport.cpp:118:82: error: invalid conversion from ‘void (*)(uv_work_t*) {aka void (*)(uv_work_s*)}’ to ‘uv_after_work_cb {aka void (*)(uv_work_s*, int)}’ [-fpermissive]
In file included from /home/user/.node-gyp/0.10.0/src/node.h:61:0,
                 from ../src/serialport.h:5,
                 from ../src/serialport.cpp:2:
/home/user/.node-gyp/0.10.0/deps/uv/include/uv.h:1397:15: error:   initializing argument 4 of ‘int uv_queue_work(uv_loop_t*, uv_work_t*, uv_work_cb, uv_after_work_cb)’ [-fpermissive]
../src/serialport.cpp: In function ‘void EIO_AfterWrite(uv_work_t*)’:
../src/serialport.cpp:146:86: error: invalid conversion from ‘void (*)(uv_work_t*) {aka void (*)(uv_work_s*)}’ to ‘uv_after_work_cb {aka void (*)(uv_work_s*, int)}’ [-fpermissive]
In file included from /home/user/.node-gyp/0.10.0/src/node.h:61:0,
                 from ../src/serialport.h:5,
                 from ../src/serialport.cpp:2:
/home/user/.node-gyp/0.10.0/deps/uv/include/uv.h:1397:15: error:   initializing argument 4 of ‘int uv_queue_work(uv_loop_t*, uv_work_t*, uv_work_cb, uv_after_work_cb)’ [-fpermissive]
../src/serialport.cpp: In function ‘v8::Handle<v8::Value> Close(const v8::Arguments&)’:
../src/serialport.cpp:178:66: error: invalid conversion from ‘void (*)(uv_work_t*) {aka void (*)(uv_work_s*)}’ to ‘uv_after_work_cb {aka void (*)(uv_work_s*, int)}’ [-fpermissive]
In file included from /home/user/.node-gyp/0.10.0/src/node.h:61:0,
                 from ../src/serialport.h:5,
                 from ../src/serialport.cpp:2:
/home/user/.node-gyp/0.10.0/deps/uv/include/uv.h:1397:15: error:   initializing argument 4 of ‘int uv_queue_work(uv_loop_t*, uv_work_t*, uv_work_cb, uv_after_work_cb)’ [-fpermissive]
../src/serialport.cpp: In function ‘v8::Handle<v8::Value> List(const v8::Arguments&)’:
../src/serialport.cpp:214:64: error: invalid conversion from ‘void (*)(uv_work_t*) {aka void (*)(uv_work_s*)}’ to ‘uv_after_work_cb {aka void (*)(uv_work_s*, int)}’ [-fpermissive]
In file included from /home/user/.node-gyp/0.10.0/src/node.h:61:0,
                 from ../src/serialport.h:5,
                 from ../src/serialport.cpp:2:
/home/user/.node-gyp/0.10.0/deps/uv/include/uv.h:1397:15: error:   initializing argument 4 of ‘int uv_queue_work(uv_loop_t*, uv_work_t*, uv_work_cb, uv_after_work_cb)’ [-fpermissive]
../src/serialport.cpp: In function ‘v8::Handle<v8::Value> Flush(const v8::Arguments&)’:
../src/serialport.cpp:271:66: error: invalid conversion from ‘void (*)(uv_work_t*) {aka void (*)(uv_work_s*)}’ to ‘uv_after_work_cb {aka void (*)(uv_work_s*, int)}’ [-fpermissive]
In file included from /home/user/.node-gyp/0.10.0/src/node.h:61:0,
                 from ../src/serialport.h:5,
                 from ../src/serialport.cpp:2:
/home/user/.node-gyp/0.10.0/deps/uv/include/uv.h:1397:15: error:   initializing argument 4 of ‘int uv_queue_work(uv_loop_t*, uv_work_t*, uv_work_cb, uv_after_work_cb)’ [-fpermissive]
make: *** [Release/obj.target/serialport/src/serialport.o] Error 1
make: Leaving directory `/home/user/node_modules/serialport/build'
gyp ERR! build error 
gyp ERR! stack Error: `make` failed with exit code: 2
gyp ERR! stack     at ChildProcess.onExit (/usr/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:256:23)
gyp ERR! stack     at ChildProcess.EventEmitter.emit (events.js:98:17)
gyp ERR! stack     at Process.ChildProcess._handle.onexit (child_process.js:754:12)
gyp ERR! System Linux 3.8.3-2-ARCH
gyp ERR! command "node" "/usr/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "rebuild"
gyp ERR! cwd /home/user/node_modules/serialport
gyp ERR! node -v v0.10.0
gyp ERR! node-gyp -v v0.8.5
gyp ERR! not ok 
npm ERR! serialport@1.0.8 install: `node-gyp rebuild`
npm ERR! `sh "-c" "node-gyp rebuild"` failed with 1
npm ERR! 
npm ERR! Failed at the serialport@1.0.8 install script.
npm ERR! This is most likely a problem with the serialport package,
npm ERR! not with npm itself.
npm ERR! Tell the author that this fails on your system:
npm ERR!     node-gyp rebuild
npm ERR! You can get their info via:
npm ERR!     npm owner ls serialport
npm ERR! There is likely additional logging output above.

npm ERR! System Linux 3.8.3-2-ARCH
npm ERR! command "/usr/bin/node" "/usr/bin/npm" "install" "serialport"
npm ERR! cwd /home/user
npm ERR! node -v v0.10.0
npm ERR! npm -v 1.2.14
npm ERR! code ELIFECYCLE
npm ERR! 
npm ERR! Additional logging details can be found in:
npm ERR!     /home/user/npm-debug.log
npm ERR! not ok code 0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:24:14.420

已报告此[错误。](https://github.com/voodootikigod/node-serialport/issues/142)它正在等待部署。请参阅页面末尾的说明。

# python - 使 web2py 应用程序在网络上可用

> ID：15549305
> 
> 赞同：0
> 
> 时间：2013-03-21T13:46:02.490
> 
> 标签：python, web2py

我创建了一个简单而小型的 web2py 应用程序，我想向全世界公开。

我是 Web 开发新手，需要一些帮助和指导。

提前致谢。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T15:35:58.223

可能最简单的入门方法是在[https://www.pythonanywhere.com/](https://www.pythonanywhere.com/)上注册（基本使用免费）。他们为 web2py 提供了预配置的设置，因此您在设置服务器时不会遇到任何问题。

运行 web2py 后，您可以使用通常的 web2py 管理界面上传打包的 web2py 应用程序。如果你以前从未听说过这个，看看这个：[http ://web2py.com/books/default/chapter/29/03#More-on-admin](http://web2py.com/books/default/chapter/29/03#More-on-admin)

# javafx-2 - .FXML 中的 fx:controller=""

> ID：15549307
> 
> 赞同：4
> 
> 时间：2013-03-21T13:46:07.713
> 
> 标签：javafx-2, javafx, fxml

是否可以`fx:controller=""`在一个 FXML 文件中添加两个控制器 ()？

我只能设法添加一个`fx:controller=""`

查看代码

```
<BorderPane id="BorderPane" maxHeight="-Infinity" maxWidth="-Infinity" minHeight="-Infinity" minWidth="-Infinity" prefHeight="596.0" prefWidth="600.0" xmlns:fx="http://javafx.com/fxml" fx:controller="demoapp.ClientArea"> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T13:05:35.893

您不能在一个 FXML 文件中使用 设置多个控制器 `(fx:controller="")`，而是考虑手动注入控制器，基本上有两种方法：

使用[setController](http://docs.oracle.com/javafx/2/api/javafx/fxml/FXMLLoader.html#setController%28java.lang.Object%29)方法而不提及 FXML 文件中的控制器：

```
FXMLLoader loader = new FXMLLoader();
URL location = getClass().getClassLoader().getResource("fxml/ClientArea.fxml");
loader.setLocation(location);   
loader.setController(new ClientArea());
// loader.setController(new Undecorator());
loader.load(); 
```

* * *

更合适的是，使用[setControllerFactory](http://docs.oracle.com/javafx/2/api/javafx/fxml/FXMLLoader.html#setControllerFactory%28javafx.util.Callback%29)方法：

首先，确保两个控制器都`ClientArea` 实现了文件中提到`Undecorator`的接口（包含事件处理程序方法） ，然后在从文件中加载视图时选择控制器：`Icontroller``FXML``(fx:controller="IController")``FXML`

```
FXMLLoader loader= new FXMLLoader();
URL location = getClass().getClassLoader().getResource("fxml/ClientArea.fxml");
loader.setLocation(location);
loader.setControllerFactory(new Callback<Class<?>, Object>() {   
    public Object call(Class<?> p) {
        return new ClientArea(); 
           // return new Undecorator();
    }
});
loader.load(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T17:56:07.797

如果适合您的代码，您`Undecorator.java`可以从`ClientArea.java`. 因此，可以从其父级使用任何方法（或 FXML 方法/控件）`ClientArea.java`：. 使用 JavaFX SceneBuilder，不会在控制器选择中显示 package.ClientArea，但在运行时它会起作用。

# delphi - 微软脚本控制 64 位？

> ID：15549308
> 
> 赞同：4
> 
> 时间：2013-03-21T13:46:19.197
> 
> 标签：delphi, 64-bit

是否有 64 位的 msscript 控件？我谷歌了一下，都说没有 64 位

我需要 64 位 msscript.ocx 的原因是我想使用 XE3 以 64 位编译 delphi 项目。

它在 XE3 中编译正常，我已经获得了 64 位 exe，但是当它执行到以下行时，

```
 script := TScriptControl.Create(nil); 
```

它给了我一个“类未注册”错误。我只在 C:\windows\SysWOW64 下找到了 msscript.ocx，但在 System32 文件夹下没有这样的文件。

我真的希望它能够工作，所以可以快速替换它吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-09-04T12:01:23.473

这是一个旧帖子。但我刚刚找到了一个非常好的替代 64 位 MSScript 控件（微软没有 64 位 msscript.ocx）

[http://www.onet.ne.jp/~gakana/tablacus/scriptcontrol_en.html](http://www.eonet.ne.jp/~gakana/tablacus/scriptcontrol_en.html)

而且我只更改了我的应用程序中的几行代码，它基于这个 ScriptControl64 在 64 位中工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T13:52:09.240

msscript 组件未移植到 64 位。这是一个遗留组件，MS 选择不努力将其迁移到 64 位。您只需要找到另一种方法来执行您对该组件所做的任何事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-30T16:01:53.857

我在将 c++ 应用程序从 32 位移植到 64 位时遇到了同样的问题。我知道这个问题是在 Delphi 上提出的，但我希望有人可以利用这些信息或将其转移到其他语言。

我们通过 CreateDispatch 启动“ScriptControl”（MSScriptControl.ScriptControl.1）。控制信息位于 Computer\HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ScriptControl 中，我们使用 32 位的这个 MS 控制执行 VBS 或 JScript：

```
COleDispatchDriver* m_dispScriptControl = new COleDispatchDriver();
if (m_dispScriptControl)
{
   if (m_dispScriptControl->CreateDispatch(_T("ScriptControl")))
   {
     ...
     .... setting language to be used and other proteries .. then execute script code:

      _variant_t varResult;
      VariantClear(&varResult);
      EXCEPINFO    excepinfo;
      VARIANT parameters;
      parameters.vt = VT_BSTR;
      parameters.bstrVal = strScriptCodeWCHAR;

      DISPPARAMS dispparams;
      dispparams.rgdispidNamedArgs = NULL;
      dispparams.cNamedArgs = 0;
      dispparams.cArgs = 1;
      dispparams.rgvarg = &parameters;
      unsigned int uArgErr = 0;

      if (S_OK != m_dispScriptControl->m_lpDispatch->Invoke(0x7d2, IID_NULL, LOCALE_SYSTEM_DEFAULT, DISPATCH_METHOD, &dispparams, &varResult, &excepinfo, &uArgErr))
...

   } 
```

> 经过一些研究，似乎不可能在 64 位应用程序中创建 ScriptControl 作为 MSDN 查询：
> 
> 问题是：我的窗体应用程序目前在 32 位应用程序上运行良好，我正在调查，因此我们可以将其安装在 64 位计算机上，但继续启动应用程序，如下所示。
> 
> 类未注册（HRESULT 异常：0x80040154 (REGDB_E_CLASSNOTREG)）
> 
> 错误位于 AxInterop.MSScriptControl.dll
> 
> Awnser 是：如果它只存在于 C:\Windows\SysWOW64 中，那么您的 .Net 应用程序无法在 64 位模式下运行。确保为 x86 而不是 Any CPU 编译它。然后您将能够在 64 位 Windows 中使用它，但它将是一个 32 位进程。
> 
> [https://social.msdn.microsoft.com/Forums/windows/en-US/1e9ddfe4-3408-4a34-ba43-a1a0931daebd/64-bit-windows-7?forum=clr](https://social.msdn.microsoft.com/Forums/windows/en-US/1e9ddfe4-3408-4a34-ba43-a1a0931daebd/64-bit-windows-7?forum=clr)
> 
> 对此我们不满意，因为我们想以 64 位进程运行

我们的解决方案是使用 Microsoft [IActiveScript 接口](https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.debugger.interop.iactivescript?f1url=%3FappId%3DDev16IDEF1%26l%3DEN-US%26k%3Dk(ACTIVSCP%252FIActiveScript);k(IActiveScript);k(DevLang-C%252B%252B);k(TargetOS-Windows)%26rd%3Dtrue&view=visualstudiosdk-2019)。并在我们的主窗口上实现了相同的功能：

```
BEGIN_INTERFACE_PART(ActiveScriptSite, IActiveScriptSite)
        STDMETHOD(GetLCID)(LCID*);
        STDMETHOD(GetItemInfo)(LPCOLESTR, DWORD, LPUNKNOWN*, LPTYPEINFO*);
        STDMETHOD(GetDocVersionString)(BSTR*);
        STDMETHOD(OnScriptTerminate)(const VARIANT*, const EXCEPINFO*);
        STDMETHOD(OnStateChange)(SCRIPTSTATE);
        STDMETHOD(OnScriptError)(IActiveScriptError*);
        STDMETHOD(OnEnterScript)();
        STDMETHOD(OnLeaveScript)();
END_INTERFACE_PART(ActiveScriptSite) 
```

现在，当我们必须执行脚本代码时，我们执行以下操作，这在我们构建的 64 位和 32 位版本中运行良好：

```
 CString strLanguage;
 if (nLanguage == 1)
 {
    strLanguage = _T("VBScript");
 }
 else
 {
   strLanguage = _T("JScript");
 }

CComPtr<IActiveScript> m_pAxsScript;
HRESULT hr = m_pAxsScript.CoCreateInstance(CT2W(strLanguage), NULL, CLSCTX_INPROC_SERVER | CLSCTX_INPROC_HANDLER); 

m_pAxsScript->SetScriptSite(&m_xActiveScriptSite); //m_xActiveScriptSite is a member of the interface

CComQIPtr<IActiveScriptParse> m_pAxsScriptParse = m_pAxsScript;

m_pAxsScriptParse->InitNew();

EXCEPINFO pException = { 0 };
hr = m_pAxsScriptParse->ParseScriptText(_bstr_t(strCode), 0, NULL, NULL, dw, 0, 0, NULL, &pException);

//execute script
m_pAxsScript->SetScriptState(SCRIPTSTATE_CONNECTED);

m_pAxsScriptParse.Release();
m_pAxsScriptParse = nullptr;

hr = m_pAxsScript->SetScriptState(SCRIPTSTATE_DISCONNECTED);
ASSERT(hr == S_OK);

m_pAxsScript->Close();
m_pAxsScript.Release(); 
```

# mysql - 在 MySql 中插入错误的数据

> ID：15549312
> 
> 赞同：0
> 
> 时间：2013-03-21T13:46:38.887
> 
> 标签：mysql, sql, phpmyadmin, sql-insert

以下是我的查询

```
insert into sms (mobile) values ("255786786072") 
```

我在表中的“mobile”字段中得到的值是 2147483647。“mobile”字段的数据类型是 varchar(15)。

任何建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T13:47:52.557

我**很确定**这不是`varchar`因为`2147483647`是 signed 的最大值`INT`。将其更改为 varchar 以根据需要工作。

# php - 回显数组的一部分？PHP

> ID：15549313
> 
> 赞同：1
> 
> 时间：2013-03-21T13:46:43.223
> 
> 标签：php, file-handling

有人可以告诉我为什么我的代码回显整个数组，而不是我在`$list`几乎不知道任何 php 中声明的两个值，所以有人可以告诉我有什么问题吗？

```
if(isset($_POST['button'])) {
    if( $_POST['filmnamn'] != "" && $_POST['betyg'] != "" && $_POST['link'] != "" && $_POST['photo'] != "" && $_POST['description'] != "") {
        $myFile = 'demo.txt';
        $titel = $_POST['filmnamn'] . ";" ;
        $betyg = $_POST['betyg'] . ";" ;
        $link = $_POST['link'] . ";" ;
        $photo = $_POST['photo'] . ";" ;
        $desc = $_POST['description'].PHP_EOL;
        $data = "$titel$betyg$link$photo$desc";
        $list = "$titel$betyg";
        $fh = fopen($myFile, 'a');
        fwrite($fh, $data);

        fclose($fh);

        $handle = fopen($myFile, 'r');
        $fileinfo = fread($handle, filesize($myFile));
        $fileinfo_array = explode(';', $fileinfo);
        foreach($fileinfo_array as $list){
            echo $list;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T13:50:45.067

您设置`$list`但随后将其覆盖在`foreach`.

```
$list = "$titel$betyg"; 
```

然后你做

```
foreach($fileinfo_array as $list){
    echo $list;
} 
```

它成为数组的每个项目的位置。您可以`echo`直接`$list`使用或使用：

```
$list = explode(";", $list);
array_pop($list); //remove last blank item
foreach($list as $item){
    echo $item;
} 
```

**编辑：**

这将逐行读取文件并构建一个数组

```
while (!feof($handle)) {
   $lines[] = fgets($handle);
}
fclose($handle); 
```

接下来，您要回显信息：

```
foreach($lines as $list){
    //use my above code
} 
```

注意：查看[file_put_contents](http://php.net/manual/en/function.file-put-contents.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T13:49:18.787

而不是给出一个变量的回声：

```
print_r($list); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T13:50:00.940

这一行：

```
fwrite($fh, $data); 
```

您将之前的所有数组元素写入文件；它应该是

```
fwrite($fh, $list); 
```

**编辑 ：**

如果它只有两个，只需直接访问元素；

```
$fileinfo_array[0];
$fileinfo_array[1]; 
```

或者你可以使用[array_slice()](http://php.net/manual/en/function.array-slice.php)；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-05T15:28:02.413

这一行：

> fwrite($fh, $data);

您将之前的所有数组元素写入文件；它应该是

> fwrite($fh, $list);

编辑 ：

如果它只有两个，只需直接访问元素；

> $fileinfo_array[0]; $fileinfo_array[1];

或者你可以使用 array_slice();

# html - 如何在服务器端获取浏览器的屏幕分辨率？

> ID：15549315
> 
> 赞同：2
> 
> 时间：2013-03-21T13:46:51.680
> 
> 标签：html, node.js, screen-resolution

如何在nodejs中获取设备的屏幕分辨率？

我已经读过使用它`<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">`我们可以获得屏幕分辨率。但我的情况不同。当用户点击 url 时，不会有任何 html 文件。那么如何获得屏幕分辨率呢？

有没有办法通过 req 对象来获取它？例如，我有

```
app.get('/', function(req, res){
   //req.getScreenResolution()
   res.redirect("/index.html");
}); 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:04:47.167

您无法从页面请求中获取服务器上客户端的屏幕分辨率。如果您尝试根据窗口大小进行重定向，那么您可以这样做。

1.  使您的登陆页面对于所有分辨率都简单，以便浏览器必须显示它。
2.  检测窗口分辨率，然后通过页面中的 JavaScript 重定向到所需的页面。看[这里](http://www.javascriptkit.com/howto/newtech3.shtml)
3.  为窗口分辨率设置cookie，以供进一步使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T13:49:45.640

您无法在服务器端获取屏幕分辨率，您必须在客户端获取它并使用 ajax 请求/套接字消息将其传递回节点。

# javascript - 如何利用按值存储来克隆对象？

> ID：15549316
> 
> 赞同：0
> 
> 时间：2013-03-21T13:46:52.547
> 
> 标签：javascript, jquery

我将 css 值存储在一个对象中以用于两种不同的场景：

```
styles = {
  on: { left:10, top:20 },
  off: { left:0, top:30 }
}; 
```

我使用它的第一种方法是简单的鼠标悬停效果：

```
$nav.hover(
  function() {
    $(this).css(styles.on);
  },
  function() {
    $(this).css(styles.off);
  }
); 
```

但是，对于我的其他用途，我正在制作动画，并且我需要额外的（非 CSS）属性，例如`ease`和`onComplete`。理想情况下，我希望能够复制`styles`对象并将我的新属性附加到它，如下所示：

```
var anim = styles;
anim.ease = Power3.easeInOut;
anim.onComplete = function() {/*stuff*/}; 
```

这将适用于第二次使用，但不幸的是，由于存储了按值引用，这也会将新属性添加到原始`styles`变量中，这反过来会导致`.css()`方法尝试将`ease`等分配为 css 值。

如何在不影响原始属性的情况下快速克隆源对象以添加新属性？

我知道围绕 Javascript 是否可以通过引用传递的论点（在 JavaScript 中是否存在按值传递之类的[传递？](https://stackoverflow.com/questions/2835070/is-there-thing-like-pass-by-value-pass-by-reference-in-javascript)[JavaScript 是按引用传递还是按值传递语言？](https://stackoverflow.com/questions/518000/is-javascript-a-pass-by-reference-or-pass-by-value-language)）但我不知道想就此展开讨论……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:49:37.757

在这种情况下，一个简单的对象文字，快速而肮脏的方式是这样的：

```
var anim = JSON.parse(JSON.stringify(styles)); 
```

如果`styles`对象总是像这样简单，那么你应该没问题。当然，如果您要在其中弄乱函数（方法）或多级循环引用，您可能需要付出更多努力。

如果`styles`是不可预测的，但您希望能够从其克隆访问它，您可以执行以下操作：

```
var anim = {on: {}, off: {}};
for (var prop in anim)
{//only loop through anim's properties, as we don't know how many "styles" might have
    if (anim.hasOwnProperty(prop))
    {
        anim[prop].left = styles[prop].left || 'default value';
        anim[prop].top = styles[prop].top || 'default value';
    }
}
anim.original = styles;//reference original object... 
```

理论上，您可以创建一个使用原始对象作为原型的构造函数，但这有点矫枉过正恕我直言

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:07:31.310

反过来做（复制`styles`到具有自定义属性的新对象）并使用[`$.extend`](http://api.jquery.com/jQuery.extend)：

```
$(this).animate($.extend({
   ease: Power3.easeInOut,
   onComplete: function() {/*stuff*/}
}, styles.off)); 
```

如果你想覆盖其中的一些，你也可以`$.extend`通过将属性复制到一个新对象来克隆：

```
$(this).animate($.extend({}, styles.off,
   left: 5,
   ease: Power3.easeInOut,
   onComplete: function() {/*stuff*/}
})); 
```

# sql - 使用存储的名称创建模式

> ID：15549317
> 
> 赞同：0
> 
> 时间：2013-03-21T13:46:54.033
> 
> 标签：sql, postgresql, select, schema

我正在尝试在我的 postgres 数据库上创建一个新模式，其名称存储在现有表中，我的查询如下所示：

```
CREATE SCHEMA (SELECT name FROM table) 
```

但我收到语法错误。我究竟做错了什么？这是创建新模式的有效方法吗？这个问题还有哪些其他解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T15:56:16.390

您可以使用动态 sql 执行此操作：

```
do
$$
  declare s_name text;
begin
  -- make sure there is exactly one row in that table!
  -- otherwise you need some where condition or an aggregat to ensure that.
  SELECT name INTO s_name FROM some_table;
  execute 'create schema '|| quote_ident(s_name);
end;
$$ 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-21T14:04:03.827

这是不可能的，创建模式语法需要有效的模式名称（即有效的模式名称字符串）。在你的情况下，它会抛出异常

```
********** Error **********

ERROR: syntax error at or near "("
SQL state: 42601
Character: 15 
```

# magento - 从所有类别中按magento中的属性获取产品

> ID：15549319
> 
> 赞同：0
> 
> 时间：2013-03-21T13:46:57.873
> 
> 标签：magento, attributes

我正在尝试从所有类别中获取产品。实际上我想在主页上显示一个下拉列表，从那里可以选择属性的值。

例如，“维生素 a”或“维生素 b”。

现在基于该选择，应获取所有包含成分“维生素 b”的产品。

我不知道该怎么做？请任何人都可以提出一些建议，我正在尝试使用一个模板文件来实现这一目标。但没有得到确切的想法。

我的属性代码是“成分”。基于此，我想从所有类别中获取所有产品。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:18:18.007

```
$products = Mage::getResourceModel('catalog/product');
/* @var $products Mage_Catalog_Model_Resource_Product_Collection */

$products->addAttributeToFilter('ingredient',{value});
$products->addAttributeToSelect('name'); // etc.

foreach ($products as $product) {
    /* @var $product Mage_Catalog_Model_Product */
    sprintf('%s<br />',$product->getName());
} 
```

# mongodb - Meteor 是否支持 DBRefs？

> ID：15549320
> 
> 赞同：11
> 
> 时间：2013-03-21T13:47:09.897
> 
> 标签：mongodb, meteor, dbref

当我尝试插入这样的文档时，我使用的是最新版本的 Meteor (0.5.9)：

```
Contacts.insert({ 
     _id : 'gBTqByxvoz9PdFxmy',
     name : 'Albert Einstein',
     infoDocument: {
        '$ref': 'documents',
        '$id': 'zigeoa8RgAukxwYoi',
        '$db': 'meteor'
     },
     owner : 'public',
     slug : 'gBTqByxvoz9PdFxmy',
     type : 'contact' 
} 
```

我在服务器控制台中收到错误“[Error: key $ref must not start with '$']”。Meteor 是否支持 DBRefs？

# c - 变量 .BSS 部分

> ID：15549321
> 
> 赞同：1
> 
> 时间：2013-03-21T13:47:10.083
> 
> 标签：c, embedded

未初始化的变量包含在 BSS 部分中。

第一个问题：他们被分配后会留在那里吗？

第二个问题/问题：我想将此部分加载到外部 SDRAM 中。变量正确地位于内存映射中，但充满了奇怪的值，我无法存储任何其他数字。你对这个问题有什么想法吗？

```
/* Memory Map                                                                 */
MEMORY{
    VECTORS (X)  : origin=0x00000000 length=0x00000020
    FLASH0  (RX) : origin=0x00000020 length=0x0017FFE0
    FLASH1  (RX) : origin=0x00180000 length=0x00180000
    STACKS  (RW) : origin=0x08000000 length=0x00001500
    RAM     (RW) : origin=0x08001500 length=0x0003EB00
    SDRAM   (RW) : origin=0x80000000 length=0x00800000
}

/*----------------------------------------------------------------------------*/
/* Section Configuration                                                      */
SECTIONS{
    .intvecs : {} > VECTORS
    .text    : {} > FLASH0 | FLASH1
    .const   : {} > FLASH0 | FLASH1
    .cinit   : {} > FLASH0 | FLASH1
    .pinit   : {} > FLASH0 | FLASH1
    .bss     : {} > SDRAM
    .data    : {} > RAM
    .sysmem  : {} > RAM
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T15:09:49.167

关于 Q2，在运行时启动代码将 .bss 段初始化为零*之前*，您必须确保您的 SDRAM 内存控制器已使用正确的时序和内存设备映射正确初始化。您还必须确保运行时启动代码在位于 SDRAM 中时显式初始化 .bss 段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T13:52:42.573

Q1：是的，他们就在那儿。他们为什么要搬家（你为什么要他们搬家？）

[http://en.wikipedia.org/wiki/.bss](http://en.wikipedia.org/wiki/.bss)

Q2：我不完全理解这个问题，但你确定你的 SDRAM 真的可以工作吗？您的平台是否有一个监视器允许您读写内存？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:13:10.920

Q2：必须如何执行此操作的详细信息取决于您使用的系统（您使用的是 Linux 吗？）

要获得所需的 .bss 部分，您必须修改链接描述文件。例如对于 Linux 内核，它是 vmlinux.lds。

同样在 Linux 中，引导加载程序（例如 Uboot）根据 elf 文件中的信息将 .bss 部分清除为全零。您的 .bss 似乎没有被清零。开始调试的一个好地方是引导加载程序。在引导加载程序清除它时，您的 SDRAM 可能没有正确映射到内存中（您可以在系统运行时进行成功的读写测试吗？）。或者您的 CPU 的内存保护可能会阻止访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T13:57:55.060

Q1：是的，变量将在`.bss`部分中。

Q2：你可以尝试移动`.sysmem`到 SDRAM 并检查你是否可以读取和写入值吗？我怀疑您没有必要的访问权限。

# javascript - 通过这两种不同的方法调用 jQuery 功能的优缺点是什么？

> ID：15549323
> 
> 赞同：1
> 
> 时间：2013-03-21T13:47:14.440
> 
> 标签：javascript, jquery

我试图了解这两种调用 JavaScript/jQuery 函数的方式之间的区别（如果有的话）。

方法1，在`document.ready()`：

```
$('body').on('click', 'a.popup', popup); 
```

然后

```
function popup() {
    $(this) // do something    
} 
```

方法2，在`document.ready()`：

```
popup(); 
```

然后

```
function popup() {
    $("a.popup").click(function (e) {
        // do something here
    });
} 
```

所有建议表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T13:54:03.363

在方法 2 中，该`popup`函数可能只被调用一次，否则您将`onclick`多次附加相同的函数，这可能不是您想要的。`popup`因此，将函数的主体写入其他地方并没有太大的好处，而不是直接在`document.ready()`.

方法 1 的优点是如果您想将相同的函数附加到各种事件和/或各种元素，例如`onclick`等`onmousemove`。这样您就不必编写函数的主体两次。

简而言之，我没有看到方法 2 的好处，而我在方法 1 中看到了一些好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:00:03.280

我不太确定，但我想你是在问调用 jQuery .on()方法和jQuery [.click()](http://api.jquery.com/on/)[方法](http://api.jquery.com/click/)有什么区别，对吧？

如：

```
$someEl.on('click', someFunc);
// or
$someEl.click(someFunc); 
```

像这样，两者几乎是等价的。但是，使用 .on() 方法，您有机会将命名空间（在第一个链接中解释）引入元素的事件。像这样：

```
$someEl.on('click.do1', someFunc1);
$someEl.on('click.do2', someFunc2); 
```

因此，如果在以后的进展中您只想删除或触发其中一个回调函数（someFunc1、someFunc2），您可以通过调用：

```
$someEl.off('click.do1');
$someEl.trigger('click.do2'); 
```

希望这可以帮助

# c++ - 可继承类的模板类的演员表

> ID：15549325
> 
> 赞同：1
> 
> 时间：2013-03-21T13:47:18.397
> 
> 标签：c++, templates, casting

我有`Base`和`Derived`类和模板类`Container`，哪个参数可以`Base`和`Derived`. 我需要强制`Container<Derived>`转换`Container<Base>`是否有可能做到这一点？我应该使用哪个演员表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:49:03.797

不，这是不可能的。`Container<Derived>`不派生自`Container<Base>`，它们只是同一类模板的两个实例。

这是有道理的：想象 a`Container<Derived>`将是 a 的有效替代品，`Container<Base>`用于期望 a 的函数`Container<Base>`，并想象有第二个类`Derived2`派生自`Base`，但与 无关`Derived`：

```
void foo(Container<Base>& cont)
{
    Derived2 obj;
    cont.push_back(obj);
}

Container<Derived> c;
foo(c); 
```

在上面的代码片段中，您将尝试将类型对象插入到元素`Derived2`容器中。`Derived`绝对不是什么好事。

此外，如果您想利用多态行为，您应该在容器中使用（智能）指针：

```
Container<std::shared_ptr<Base>> cb;
// ... fill it in...

Container<std::shared_ptr<Derived>> cd;
for (auto &pB : cb)
{
    std::shared_ptr<Derived> pD = std::dynamic_pointer_cast<Derived>(pB);
    if (pD != nullptr)
    {
        cd.push_back(pD);
    }
} 
```

这是一个（可能的）完整示例：

```
#include <memory>
#include <vector>
#include <iostream>

template<typename T>
using Container = std::vector<T>;

struct Base { virtual ~Base() { } };
struct Derived : Base { };

int main()
{
    Container<std::shared_ptr<Base>> cb;
    cb.push_back(std::make_shared<Derived>());
    cb.push_back(std::make_shared<Base>());
    cb.push_back(std::make_shared<Derived>());

    Container<std::shared_ptr<Derived>> cd;
    for (auto &pB : cb)
    {
        std::shared_ptr<Derived> pD = std::dynamic_pointer_cast<Derived>(pB);
        if (pD != nullptr)
        {
            cd.push_back(pD);
        }
    }

    std::cout << cd.size(); // Prints 2
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T13:48:38.913

不，这是不可能的。您将必须创建一个新容器并逐个元素进行转换。

仍然请注意，您可能会执行以下操作：

```
#include <iostream>
#include <vector>
using namespace std;

class A {
};

class B: public A{

};
int main() {
    vector<B> b(5);
    vector<A> a(b.begin(), b.end());
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T13:52:59.233

请注意，要进行多态操作，您需要使用指针或引用。您的容器可能会这样做，但可能不会——您还没有告诉我们。

如果有`Container<Base*>`，则可以在其中同时保存基础对象和派生对象（尽管您可能要考虑制作该对象`Container< std::unique_ptr<Base> >`或类似对象）。

如果你有一个`Container<Derived>`（或），你可以做一个指向这些元素`Container<Derived*>`的平行线，但要小心它们不同步。`Container<Base*>`

另一种选择是根据需要逐个投射元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T14:02:02.073

如果一切都派生自一个非模板抽象接口类，它包含所有需要的方法，vTable 将自动进行强制转换：-D。然后，您将需要此接口类的指针容器。我用复合图案做到了这一点，就像一个魅力！

# casting - 对于这个简单的案例，Typescript 是否需要强制转换？

> ID：15549326
> 
> 赞同：1
> 
> 时间：2013-03-21T13:47:28.933
> 
> 标签：casting, typescript

假设我有一个 test.ts 和一个 MY_MODULE.d.ts 文件：

**MY_MODULE.d.ts：**

```
module MY_MODULE 
{
    export class Config { 
        UserId : string;
    };

    export function Init( config : Config );
} 
```

**测试.ts：**

```
/// <reference path="MY_MODULE.d.ts" />

MY_MODULE.Init(<MY_MODULE.Config>{ UserId: 'Josh' }); 
```

我的问题：是否可以修复定义文件或 .ts 文件，以便后者中的强制转换是不必要的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:08:09.630

使用`export interface Config`而不是`export class Config`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:23:43.427

Typescript 将根据对象的签名推断正确的类型，因此不需要强制转换。
将代码复制到操场上，立即发现了几个编译错误。首先，Init 需要一个实现。
其次，Config 类没有构造函数。
以下代码编译干净：

```
module MY_MODULE 
{
    export class Config { 
        UserId : string;
    };

    export function Init( config : Config ) {
    }
}

var myConfig = new MY_MODULE.Config();
myConfig.UserId = 'Josh'

MY_MODULE.Init(myConfig); 
```

最好为 Config 定义一个构造函数，如下所示：

```
module MY_MODULE 
{
    export class Config {
        UserId : string; 
        constructor(userId : string) {
            this.UserId = userId;
        }
    };
    export function Init( config : Config ) {
    }
}

MY_MODULE.Init(new MY_MODULE.Config('Josh')); 
```

# php - 如果第二个表中没有相关数据，则获取过滤后的相关数据而不排除第一个表行

> ID：15549328
> 
> 赞同：0
> 
> 时间：2013-03-21T13:47:30.523
> 
> 标签：php, doctrine, doctrine-1.2

有两个相关的表，Car 和 CouponException，我想获得一系列模型中的所有汽车，并获得与每辆汽车相关的 CouponExceptions，但棘手的事情就在这里.. 我只想获得那辆车的 CouponException ID。所以我现在正在尝试的是：

```
$versions = Doctrine_Query::create()
    ->from('Car c, c.CouponException ce')
    ->whereIn('c.model', $models)
    ->addWhere('ce.coupon_id = ?', $cid)
    ->fetchArray(); 
```

但它只返回给我带有优惠券例外的汽车，我想要的是获取模型列表中的所有汽车，如果有一辆具有给定优惠券 ID 的汽车，则获取该汽车的 CouponException ......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:01:40.347

我必须使用 LEFT JOIN 来获取所有结果并使用“with”关键字过滤第二个表。

```
 $versions   = Doctrine_Query::create()
                    ->select('c.*, ce.*')
                    ->from('Car c')
                    ->leftJoin('c.CouponException ce WITH ce.coupon_id = '.$cid)
                    ->whereIn('c.model', $models)
                    ->fetchArray(); 
```

现在它可以工作了:))))

# ajax - AngularJS 和 AJAX 注入 - 手动启动应用程序？

> ID：15549330
> 
> 赞同：1
> 
> 时间：2013-03-21T13:47:38.593
> 
> 标签：ajax, angularjs, wicket

目前我的角度应用程序被动态加载到当前网页中。这意味着以及所有脚本（angular.min.js / 控制器等），并与 Wicket AJAX 请求一起加载并注入当前网页。

脚本包含在头部中，div 以某种形式注入到主体中。

此时 Angular 应该检测到 div 并启动应用程序，但没有任何反应。当我尝试使用 console.log(angular) 时，我会像使用普通应用程序一样获得角度。当我尝试加载相同的网页（没有 AJAX 注入）时，应用程序启动正常。

如何手动启动 AngularJS，或通知启动？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T13:54:16.333

> [http://docs.angularjs.org/guide/bootstrap](http://docs.angularjs.org/guide/bootstrap)
> 
> ## 手动初始化
> 
> 如果您需要对初始化过程进行更多控制，则可以改用手动引导方法。你需要这样做的例子包括使用脚本加载器或需要在 Angular 编译页面之前执行操作。

```
<!doctype html>
<html xmlns:ng="http://angularjs.org">
  <body>
    Hello {{'World'}}!
    <script src="http://code.angularjs.org/angular.js"></script>
    <script>
       angular.element(document).ready(function() {
         angular.bootstrap(document);
       });
    </script>
  </body>
</html> 
```

*简而言之：*从您的 html 中删除`ngApp`指令并手动引导

开发者指南有你最需要的，我建议大家阅读。

# android - 为android在空中加载外部图片

> ID：15549338
> 
> 赞同：2
> 
> 时间：2013-03-21T13:47:57.457
> 
> 标签：android, actionscript-3, mobile, file-upload, air

我需要从移动 android 的 sd 卡中创建的应用程序目录中的文件夹加载图像

这在PC上有效，但在移动版本中无效

一些解决方案？

```
var imagesFin:File = File.applicationStorageDirectory.resolvePath("appImages/");
var files:Array = imagesFin.getDirectoryListing();

 for (var i:uint = 0; i < files.length; i++){

  var picLoader = new Loader();
  picLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, loadPicture);
  picLoader.load(new URLRequest(files[i].nativePath));

 }
 function loadPicture(event:Event):void {

 var imgAtual = event.target.content;
 ContainerImagesList.addChild(imgAtual);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-07T16:59:00.270

这对我有用：

```
var bytes:ByteArray = new ByteArray();
var myFileStream:FileStream = new FileStream();
var myFile:File = File.documentsDirectory.resolvePath(YOUR_PATH);

myFileStream.addEventListener(Event.COMPLETE, fileCompleteHandler)
myFileStream.openAsync(myFile, FileMode.READ);

function fileCompleteHandler(event:Event):void 
{
    myFileStream.readBytes(bytes);

    var loader:Loader = new Loader();
    loader.contentLoaderInfo.addEventListener(Event.COMPLETE, imageLoaded);
    loader.loadBytes(bytes);

    function imageLoaded(e:Event):void
    {
        addChild(Bitmap(loader.content));
        myFileStream.removeEventListener(Event.COMPLETE, fileCompleteHandler);
        myFileStream.close();
    }
} 
```

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T17:57:38.093

在 iOS 中，我从不使用 resolvePath。我只是使用像“images/photo.jpg”这样的相对 URL，它可以在任何 iOS 设备上完美运行。

除了 resolvePath，您还可以使用 URL 方案。它比“app:/images/photo.jpg”或“app-storage:/settings/prefs.xml”要简单得多。

[http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118666ade46-7fe4.html](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118666ade46-7fe4.html)

这就是我在图像文件缓存中获取所有图像的方法

```
var imageFolder:File = new File("app:/img");
var getfiles:Array = imageFolder.getDirectoryListing(); 
```

# python - 检查响应标头后中止请求

> ID：15549339
> 
> 赞同：1
> 
> 时间：2013-03-21T13:47:58.780
> 
> 标签：python, python-3.x, urllib

我有一个脚本，它通过`urllib.request`'s请求一个 URL `urlopen`，然后得到它`info()`。

在获得这些标头后，我不想继续处理请求，所以我目前只是将其保持原样并忘记它，但这似乎是我让连接保持打开状态，也许服务器正在发送更多的只是被忽略。

如何正确中止请求？

```
#!/usr/bin/python3

import urllib.request

response = urllib.request.urlopen('http://google.co.uk')
headers = dict(response.info())
print(headers)
# now finished with response, abort???
# ... more stuff 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T16:12:41.820

我想你想要的是一个`HEAD`请求。就像是

```
>>> import httplib
>>> c = httplib.HTTPConnection("www.google.co.uk")
>>> c.request("HEAD", "/index.html")
>>> r = c.getresponse()
>>> r.getheaders()
[('x-xss-protection', '1; mode=block'), ('transfer-encoding', 'chunked'), ('set-cookie', 'PREF=ID=7867b0a5641d5f7b:FF=0:TM=1363882090:LM=1363882090:S=EXLl2JgBqzMKODcq; expires=Sat, 21-Mar-2015 16:08:10 GMT; path=/; domain=.google.co.uk, NID=67=qElAph6eqHyYKbh995ivP4B-21YRDRED4-uRXx0AvC3vLpv0SF1LkdsI2k6Hg1IhsatrVVqWf2slcMCaQsAZwZ89YfU0F1iPVBdt9PC2FItff31oRJ3gvhJVTQLa_RAt; expires=Fri, 20-Sep-2013 16:08:10 GMT; path=/; domain=.google.co.uk; HttpOnly'), ('expires', '-1'), ('server', 'gws'), ('cache-control', 'private, max-age=0'), ('date', 'Thu, 21 Mar 2013 16:08:10 GMT'), ('p3p', 'CP="This is not a P3P policy! See http://www.google.com/support/accounts/bin/answer.py?hl=en&answer=151657 for more info."'), ('content-type', 'text/html; charset=ISO-8859-1'), ('x-frame-options', 'SAMEORIGIN')]
>>> 
```

来自[w3.org](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)

> HEAD 方法与 GET 相同，只是服务器不能在响应中返回消息体。响应 HEAD 请求的 HTTP 标头中包含的元信息应该与响应 GET 请求发送的信息相同。此方法可用于获取有关请求所隐含的实体的元信息，而无需传输实体主体本身。这种方法通常用于测试超文本链接的有效性、可访问性和最近的修改。
> 
> 对 HEAD 请求的响应可能是可缓存的，因为响应中包含的信息可能用于从该资源更新先前缓存的实体。如果新字段值表明缓存的实体与当前实体不同（如 Content-Length、Content-MD5、ETag 或 Last-Modified 的变化所表明的那样），则缓存必须将缓存条目视为陈旧的。

# php - 代码中的php联系表格错误？

> ID：15549341
> 
> 赞同：-1
> 
> 时间：2013-03-21T13:48:02.843
> 
> 标签：php

我是 php 的初学者，我尝试编写一个简单的联系表格。我的问题是：我的代码有什么问题？我似乎找不到任何格式化或任何错误...这是我的代码：

联系方式.php：

```
 ...page content...
    <div class="contact">              
            <form action="send_mail.php" method="post">
             <fieldset>
                  <label for="name">Name:</label>
                  <input type="text" name="name" placeholder="Enter your name" />   
                  <label for="email">Email:</label>
                  <input type="email" name="email" placeholder="Enter your email address" />        
              <label for="message">Message:</label>
              <textarea name="message" placeholder="What's on your mind?"></textarea>
              <br>
              <input type="submit" name="submit" value="Send message" />

             </fieldset>
              </form>
</div>

...page content... 
```

发送邮件.php：

```
<?php
    $name = $_POST['name'];
    $email = $_POST['email'];
    $message = $_POST['message'];
    $from = 'From: My website'; 
    $to = 'someone@email.cz'; 
    $subject = 'My contact form message';

    $body = "From: $name\n E-Mail: $email\n Message:\n $message";

    if ($_POST['submit']) {              
         if (mail ($to, $subject, $body, $from)) { 
             echo '<p>Your message has been sent!</p>';
           } else {                                            
             echo '<p>Something went wrong, go back and try again!</p>'; 
           } 
    }
?> 
```

我收到“出了点问题”消息，这意味着邮件（）返回错误，但我不知道为什么。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:36:19.083

您的标题需要包含正确的[标题](http://php.net/manual/en/function.mail.php)。
使用仅`From: My website`代表去垃圾邮件。
使用电子邮件 =>`From: $email\r\n`会更好。

**试试这个，经过测试。**

```
<?php
$name = $_POST['name'];
$email = $_POST['email'];
$message = $_POST['message'];
$headers = "From: $email\r\n";
$to = 'your_email@somewhere.com'; 
$subject = 'My contact form message';
$body = "From: $name\n E-Mail: $email\n Message:\n $message";

if(empty($email)) {
die("Something went wrong, go back and try again!"); 
}
elseif (isset($_POST['email'])) {
mail($to,$email,$body,$headers);
echo "<p>Your message has been sent!</p>";
} 
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T13:55:58.143

这是在本地计算机上运行脚本的常见问题。大多数计算机没有电子邮件服务器，并且被配置为从该服务器发送电子邮件。

要使 PHP 邮件功能正常工作，您的计算机必须设置有电子邮件服务器。您可以查看带有电子邮件支持的在线托管，也可以安装测试邮件服务器进行本地测试。

最后有一些关于非 Mac OS 的内容。过去我在这方面有过一些运气。

如果您在 Windows 上，这可能会更好：[http ://www.toolheap.com/test-mail-server-tool/](http://www.toolheap.com/test-mail-server-tool/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T15:21:43.560

1\. 要使用此代码。您应该从任何域发送邮件。

```
for example: you should have a live website thru that domain email id only send mail to
others 
```

2\. 使用 PHP-MAILER 编码发送邮件。只需从网上下载并进行更改和使用

# python - 没有比较的 Python 字符串操作

> ID：15549345
> 
> 赞同：0
> 
> 时间：2013-03-21T13:48:13.310
> 
> 标签：python, string

我正在尝试解决这个问题：我有一些符号：

```
 list =["RBS-UK", "GOOG-US"] 
```

现在我必须将所有出现的“UK”区域转换为“GB”。我可以很容易地做到这一点：

```
 new_list =[]
 for symbol in list :
    temp_list=symbol.split("-")
    if temp_list[1]=="UK":
         temp_list[1]="GB"
     new_list.append("-".join(temp_list)) 
```

但是我可以在没有平等比较的情况下做到这一点吗？

我正在寻找类似的东西：

```
 some_dict={}
 new_list =[]
 for symbol in list :
    temp_list=symbol.split("-")
    temp_list[1]=some_dict(temp_list[1])  # So this dict returns GB if its UK else returns same value as it is 
    new_list.append("-".join(temp_list)) 
```

是否可以这样做，或者有其他解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:50:46.130

是的！当然

```
ls =['RBS-UK','GOOG-US']
map(lambda x: x.replace('-UK', '-GB'), ls) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T13:51:00.167

您实际上不必重新定义偏移量。您可以简单地替换字符串：

```
for symbol in list:
    symbol = symbol.replace('-UK','-GB') 
```

如果遇到该字符串，它将被替换，否则将完全不理会它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T13:54:29.813

您正在寻找一个可以使用字典的查找：

```
translations = {'UK':'GB'} # and so on
for symbol in lst:
    country_code = symbol.split('-')[1]
    translated = translations.get(country_code,country_code)
    new_list.append('{}-{}'.format(symbol.split('-')[0],translated)) 
```

关键线是：

```
translated = translations.get(country_code,country_code) 
```

字典有一个方法，如果找不到密钥`get()`，它将返回。`None`我们用它来避免加注`KeyError`。`get()`接受一个可选的第二个参数来返回一个值，`None`除非没有找到键。

在上面的代码片段中，我们将国家代码传递给`get()`，如果没有可用的翻译，则要求它返回相同的国家代码，否则返回翻译。

第二行使用字符串格式用翻译后的代码重建原始符号并将其附加到您的列表中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T13:52:42.293

您可以使用对正则表达式操作有用`sub`的模块中的函数。`re`

这是一个生成您想要的列表的单行代码：

```
import re
newlist = [re.sub('UK','GB', symbol) for symbol in list] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T13:52:55.107

如果您真的想使用 a `dict`，您可以使用该`dict.get`方法，该方法接受未找到键时使用的默认参数，因此意味着“如果存在则返回`some_dict.get(x,x)`与之关联的值，否则返回”：`x``x`

```
>>> some_dict = {"UK": "GB"}
>>> country = "UK"
>>> some_dict.get(country, country)
'GB'
>>> country = "CA"
>>> some_dict.get(country, country)
'CA' 
```

# c# - 文档光标的路径是什么？

> ID：15549353
> 
> 赞同：4
> 
> 时间：2013-03-21T13:48:26.763
> 
> 标签：c#, .net, xmlreader, xmlwriter, xmltextreader

我正在使用[System.Xml.XmlTextReader](http://msdn.microsoft.com/en-us/library/system.xml.xmltextreader.aspx)只进阅读器。调试时，我可以随时查看属性`LineNumber`并`LinePosition`查看光标的行号和列号。有什么方法可以在文档中看到光标的任何“路径”？

例如，在以下 HTML 文档中，如果光标位于 *，则路径将类似于`html/body/p`. 我会发现这样的东西真的很有帮助。

```
<html>
    <head>
    </head>
    <body>
        <p>*</p>
    </body>
</html> 
```

编辑：我也希望能够进行`XmlWriter`类似的检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:46:55.643

据我所知，你不能用普通的 XmlTextReader 做到这一点；但是，您可以通过新`Path`属性对其进行扩展以提供此功能：

```
public class XmlTextReaderWithPath : XmlTextReader
{
    private readonly Stack<string> _path = new Stack<string>();

    public string Path
    {
        get { return String.Join("/", _path.Reverse()); }
    }

    public XmlTextReaderWithPath(TextReader input)
        : base(input)
    {
    }

    // TODO: Implement the other constuctors as needed

    public override bool Read()
    {
        if (base.Read())
        {
            switch (NodeType)
            {
                case XmlNodeType.Element:
                    _path.Push(LocalName);
                    break;

                case XmlNodeType.EndElement:
                    _path.Pop();
                    break;

                default:
                    // TODO: Handle other types of nodes, if needed
                    break;
            }

            return true;
        }

        return false;
    }
} 
```

# android - 权限被拒绝：广播意图

> ID：15549354
> 
> 赞同：-3
> 
> 时间：2013-03-21T13:48:27.377
> 
> 标签：android, broadcastreceiver

请帮助我，我得到了这个异常，我不知道我做错了什么这是我的 logcat 输出

```
 Permission Denial: broadcasting Intent { act=com.notikum.notifypassive.CLUSTER_ID_284 cmp=com.locuslabs.notiphisample/com.notikum.notifypassive.receivers.LocationAlertReceiver (has extras) } from com.locuslabs.notiphisample (pid=-1, uid=10067) requires null due to receiver com.locuslabs.notiphisample/com.notikum.notifypassive.receivers.LocationAlertReceiver 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:56:33.930

您似乎正在尝试从另一个进程向未导出的广播接收器发送广播。

这只是基于错误消息的猜测——`requires null`错误`PermissionDenied`往往意味着组件未导出。

* * *

如果您花时间阅读 StackOverflow 并查看哪些问题得到了好的答案，您会看到这些问题：

*   发布相关的代码，例如接收者注册的清单和/或广播正在发送的位置

*   包括完整的堆栈跟踪，而不是挑选一行

将来，请考虑在您的问题中包含此类内容，以增加您获得好答案的几率，并降低您的问题被否决或关闭的几率。

# css - 背景图像不会出现在按钮内的范围内

> ID：15549356
> 
> 赞同：2
> 
> 时间：2013-03-21T13:48:28.453
> 
> 标签：css, button, background-image, html

我希望这对你来说应该很容易:) 我正在尝试制作三个带有重复背景图像的按钮。我使用两个`<button>`和一个链接`<a>`。它适用于链接，但不适用于按钮 - 侧面图像（圆角）不会出现。这是html：

```
<!doctype html>
<html>

<head>
    <title>Task 1</title>
    <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.9.0/build/reset/reset-min.css">
    <link rel="stylesheet" type="text/css" href="task1.css">
</head>

<body>
<button class="blue-btn"><span id="left">&nbsp;</span>OK<span id="right">&nbsp;</span></button><br/>
<button class="blue-btn"><span id="left">&nbsp;</span>Cancel<span id="right">&nbsp;</span></button><br/>
<a href="#" class="blue-btn"><span id="left">&nbsp;</span>View More Information<span id="right">&nbsp;</span></a>
</body>
</html> 
```

这是CSS：

```
.blue-btn{
    background: url('button-repeat.png') repeat-x;
    border:0;
    height:55px;
    font: 14px/44px Myriad-Pro, sans-serif;
    color:black;
    cursor:pointer;
}
a{
    display:inline-block;
    text-decoration:none;
}
#left{
    display:block;
    background: url('button-left.png') no-repeat;
    height:55px;
    width:24px;
    float:left;
    margin-left:-24px;
}
#right{
    display:block;
    background: url('button-right.png') no-repeat;
    height:55px;
    width:24px;
    float:right;
    margin-right:-24px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:49:58.553

我很确定你不能那样做。您可能不得不放弃使用`<button>`s 并为常规元素（可能是 或 ）设置样式以`<a>`使其`<span>`看起来`<div>`像一个按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:02:37.893

尝试在不使用跨度的情况下设置按钮样式，而是使用多个背景图像和多个位置。

```
.button {
background-image: url(), url();
background-position: left top, right top;
} 
```

*请注意，[不支持](http://caniuse.com/#feat=multibackgrounds)IE 8 和 IE9 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:17:14.247

有一些位置魔法是可能的。使 blue_btn 位置：相对，左右部分应为位置：绝对。也不要使用 id 来设置样式，在按钮部分添加一些有意义的类名。

```
.blue-btn{
  position: relative;
}

.btn-right {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  width: 10px;
}
.btn-left {      
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  width: 10px;
} 
```

[提琴手](http://jsfiddle.net/xinix/3kbzc/1/)

# svn - 优化SVN中的SVNAdmin验证

> ID：15549358
> 
> 赞同：6
> 
> 时间：2013-03-21T13:48:31.907
> 
> 标签：svn, optimization, visualsvn-server, verify, svnadmin

我在我工作的企业中的 SVN 服务器中有一个大型存储库。我需要每天验证此存储库的完整性，以检查 SGBD 是否存在某些不稳定性或破裂。

我正在使用提示命令行“svnadmin path_to_my_repository”来验证我的存储库的完整性。

**问题是：**我的存储库怎么这么大（大约 23GB，有 28.029 个修订版），这个操作需要很长时间才能完成。

**问题是：**我如何优化此操作以减少实际花费的时间？或者有其他方法可以用更少的时间验证我的存储库的完整性？

**一些额外的信息：**

*   安装SVN Repository的操作系统为：Windows Server 2008
*   我用来存储我的存储库的 SVN 服务器是：VisualSVN 服务器管理器 2.5.7
*   命令“svnadmin path_to_my_repository”实际上需要大约 18~24 小时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-25T11:48:38.593

“svnadmin verify”命令有几个不同的参数。其中之一是“--revision”。所以你应该为你拥有的每个存储库做些什么，找出一种方法来获取最近 N 天（如果每天运行，可能是最后 7 天）修改的修订列表，并且只验证这些。

[使用 SVN 自某个日期以来更改的文件列表](https://stackoverflow.com/questions/5891256/list-of-files-changed-since-a-certain-date-using-svn)

您仍然应该定期（每周？每月？）对整个存储库进行完整的“svnadmin verify”。全面检查的频率应该是这样，如果您遇到问题，您可以从备份集中提取损坏的修订。

或者，如果您使用“svnadmin hotcopy”并将该 hotcopy 推送到第二组主轴（或第二台服务器），您可以验证 hotcopy。这将消除主磁盘的负载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T16:57:44.170

作为我发现的最快的解决方案是编写一个脚本来并行调用 svn 命令（svnadmin path_to_my_repository）。然后对于每个线程，我为我的 SVNServer 中的不同存储库调用命令“验证”。这不是我正在寻找的解决方案，但我通过它获得了一些性能提升。如果有人知道仅使用 svnadmin 命令优化此任务的解决方案，请告诉我们。谢谢。

# ibm-mobilefirst - 未捕获的 ReferenceError：未定义 wlInitOptions

> ID：15549359
> 
> 赞同：-2
> 
> 时间：2013-03-21T13:48:35.037
> 
> 标签：ibm-mobilefirst

自从我将 worklight 开发人员版本升级到 v5.0.6 后，我收到了这个错误：

```
wlclient init started worklight.js:1118
Uncaught ReferenceError: wlInitOptions is not defined 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T09:55:52.650

查看应用程序的 js 文件夹 (yourProject\apps\yourApp\common\js)。确保它包含一个 initOptions.js 文件并且其内容如下（您也可以创建一个新应用程序并从那里复制该文件）：

```
var wlInitOptions = {

    // # Should application automatically attempt to connect to Worklight Server on application start up
    // # The default value is true, we are overriding it to false here.
    connectOnStartup : false
};

if (window.addEventListener) {
    window.addEventListener('load', function() { WL.Client.init(wlInitOptions); }, false);
} else if (window.attachEvent) {
    window.attachEvent('onload',  function() { WL.Client.init(wlInitOptions); }); 
```

此外，HTML 文件的`<body>`标记中不得包含对 WL.Client.init 的调用。它应该如下所示：

```
<body id="content" style="display: none;"> 
```

# c# - GDI+ 中再次出现一般错误

> ID：15549364
> 
> 赞同：1
> 
> 时间：2013-03-21T13:48:48.473
> 
> 标签：c#, gdi+, system.drawing

我了解此消息的含义（需要对非托管资源执行 Dispose），但真的不明白为什么会在我的情况下发生这种情况：

```
 System.Drawing.Image imgAnimaha, imgNoanimaha;
                using (System.IO.Stream file = thisExe.GetManifestResourceStream("WindowsApplication1.img.noanimaha135.gif"))
                {

                    using (System.Drawing.Image img = Image.FromStream(file))
                    {
                        imgNoanimaha = (System.Drawing.Image)img.Clone();
                    }
                }

                using (System.IO.Stream file = thisExe.GetManifestResourceStream("WindowsApplication1.img.animaha135.gif"))
                {

                    using (System.Drawing.Image img = Image.FromStream(file))
                    {
                        imgAnimaha = (System.Drawing.Image)img.Clone();
                    }
                }

            pbDiscovery.Image = imgAnimaha; 
```

在这种情况下，我得到“GDI+ 中发生一般错误” 为什么以及如何解决？PS。如果我写以下内容：

```
 pbDiscovery.Image = imgNoanimaha; 
```

它工作正常。我真的不明白在哪里以及哪些非托管资源没有被处理......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T20:08:33.083

问题是 Image.Clone()，如：

```
using (System.Drawing.Image img = Image.FromStream(file))
{
  imgAnimaha = (System.Drawing.Image)img.Clone();
} 
```

...不会创建图像的深层副本。它会创建所有标题信息的副本，但不会创建实际的像素数据（它只是指向原始像素数据）。当使用超出范围时，原始（也是唯一的）像素数据与原始 img 对象一起处理。

那么问题就变成了，在这里使用的意义何在？我建议没有。将图像读入 System.Drawing.Image 对象，只要您需要像素数据（例如，只要图像需要重绘）就保持活动状态，并且仅在不需要再次显示后将其处置。

# android - 如何在 android 中使用 managedQuery() 过滤超过 2 种文件类型？

> ID：15549370
> 
> 赞同：1
> 
> 时间：2013-03-21T13:49:05.450
> 
> 标签：android, filter, cursor

我尝试了以下链接中的解决方案，它适用于 2 种文件类型 [通过文件扩展名（或者，文件类型）为 Android 光标过滤 managedQuery](https://stackoverflow.com/questions/7932791/filter-a-managedquery-by-file-extension-or-alternatively-file-type-for-an-an?answertab=votes#tab-top)

基于 2 种文件类型的解决方案，我尝试使用以下代码

```
String selectionMimeType = Audio.Media.DATA + " like ? OR " + Audio.Media.DATA + " like ? OR " + Audio.Media.DATA + "like ? ";

Cursor cursor = mFragment.getActivity().managedQuery(uri, null, selectionMimeType,  new String[] {"%mp3","%m4a","%wma"}, null); 
```

它与日志 FATAL EXCEPTION: main android.database.sqlite.SQLiteException: near "?": syntax error (code 1): 一起崩溃，同时编译：SELECT * FROM audio WHERE (_data like ? OR _data like ? OR _datalike ?)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T13:06:01.900

就像`" like ? "`解决了我的问题之前的一个空格

# rewrite - ISAPI 重写规则 - 想要消除一些字符

> ID：15549374
> 
> 赞同：0
> 
> 时间：2013-03-21T13:49:09.787
> 
> 标签：rewrite, isapi, isapi-rewrite, isapi-redirect

我正在使用 isapi rewrite 并且我有一个网址 www.example.com/<%25=sSiteURL%25>/abc/abc/abc/abc/abc/1883.htm

我想删除这个字符串 <%25=sSiteURL%25>

我希望网址像这样 www.example.com/abc/abc/abc/abc/abc/1883.htm

谁能帮我解决这个问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:31:46.010

Try the following rules (providing you have ISAPI_Rewrite 3):

```
RewriteBase /
RewriteRule ^<.*>(.*)$ $1 [NC,R=301,L] 
```

# vim - 在“VimLeave”上重置或设置光标形状

> ID：15549375
> 
> 赞同：2
> 
> 时间：2013-03-21T13:49:10.357
> 
> 标签：vim, shapes, text-cursor

我在 OS X 10.7.5 上使用 iTerm2（Build 1.0.0.20130319）和 Vim（MacVim Snapshot 66 的 bin）作为我的 CLI 编辑团队。

在 iTerm2 中，我定义为使用不闪烁的垂直条作为光标形状。在 Vim 我定义

```
" Enter insert mode (Cursor shape: vertical bar)
let &t_SI = "\<Esc>]50;CursorShape=1\x7"

" Leave insert mode (Cursor shape: block)
let &t_EI = "\<Esc>]50;CursorShape=0\x7" 
```

能够区分插入模式和正常模式。基本上这工作正常。当我离开 Vim 并返回 CLI 时，问题就出现了。发生的情况是光标没有返回其初始形状（垂直条）。相反，它决定保持块状。

我可以将光标重置为其初始形状或强制它返回为垂直条吗？我可以想象在例如“VimLeave”上触发一个事件。但我不知道我可以通过什么作为转义序列。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-22T00:22:08.573

经过一点点深入`:help`研究后，我发现

```
autocmd VimLeave * let &t_me="\<Esc>]50;CursorShape=1\x7" 
```

会将光标形状恢复为其初始形状，或者说是定义的形状。到目前为止效果很好。

有谁知道这种方法的缺点？除此之外`VimLeave`还可以触发`VimLeavePre`or `QuitPre`。

编辑：更好的是，有一个新插件可以满足某些人的需求。

[https://github.com/jszakmeister/vim-togglecursor](https://github.com/jszakmeister/vim-togglecursor)

它也有点可配置：

```
let g:togglecursor_default = "block"
let g:togglecursor_insert = "line"
let g:togglecursor_leave = "line"
let g:togglecursor_disable_tmux = 0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:19:27.047

你试过这个吗？

```
autocmd VimLeave * let &t_SI = "\<Esc>]50;CursorShape=1\x7" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-13T17:36:07.387

我将 Iterm 与常规 vim 一起使用。这会在启动 vim 时设置光标固定，在插入模式下闪烁。并在退出 vim 时返回闪烁。

```
augroup myCmds
au!
autocmd VimEnter * silent !echo -ne "\e[2 q"
autocmd VimLeave * silent !echo -ne "\e[1 q"
augroup END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T14:50:38.553

我之前尝试过这种方法，因为我在切换到终端时习惯了 Gvim 的光标样式。但是我遇到了同样的问题，没有办法解决。

最后我一直在使用改变光标颜色的方法。一旦我习惯了这种风格，我就很高兴，完全忘记了光标的形状。

更改光标颜色方法

```
autocmd InsertEnter * set cul
autocmd InsertLeave * set nocul 
```

`Cursor`如果该主题中没有`Normal`内置方案，则为该主题设置相似但不同的颜色。

来源：http: [//vim.wikia.com/wiki/Configuring_the_cursor](http://vim.wikia.com/wiki/Configuring_the_cursor)

我在终端中识别插入模式的三种方法的总和： [如何在vim中使光标在不同模式下发生变化？](https://stackoverflow.com/questions/15217354/how-to-make-cursor-change-in-different-modes-in-vim/15334889#15334889)

# mysql - MySQL 到 PostgreSQL 查询别名 GROUP BY

> ID：15549376
> 
> 赞同：0
> 
> 时间：2013-03-21T13:49:12.880
> 
> 标签：mysql, postgresql, group-by, sql-order-by, alias

我有一张看起来像这样的桌子

```
编号 | 数字
---------------
1 56721
2 56722
3 43981
4 43982
5 43983
6 43984

```

我的 MySQL 查询如下所示：

```
SELECT CASE substr(number,1,2) WHEN '56' then 'class1' WHEN '43' then 'class2' else 'other' END as class, 
       CASE substr(number,3,2) WHEN '72' then 'subclass1', WHEN '98' then 'subclass2' ELSE 'other' END as subclass, count(id) as ct 
FROM table GROUP BY class, subclass HAVING class!='other' AND subclass!='other' 
ORDER BY class ASC, subclass DESC; 
```

对应的 PostgreSQL 查询是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:51:34.833

为了使其更清晰，将其包装在子查询中：

```
SELECT  class, subclass
FROM
    (
        SELECT  CASE substr(number,1,2) WHEN '56' then 'class1' WHEN '43' then 'class2' else 'other' END as class, 
                CASE substr(number,3,2) WHEN '72' then 'subclass1', WHEN '98' then 'subclass2' ELSE 'other' END as subclass 
        FROM    table 
    ) x
GROUP   BY class, subclass 
HAVING  class != 'other' AND subclass != other 
ORDER   BY class ASC, subclass DESC; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:00:31.837

如果`number`实际上存储为数字（这对我来说很有意义），那么您需要处理类型转换。MySQL 支持`substr()`数值，但不支持 Postgres：

```
SELECT class, subclass, count(*)
FROM (SELECT  (CASE substr(numstr,1,2) WHEN '56' then 'class1'
                                       WHEN '43' then 'class2'
                                       else 'other'
               END) as class, 
              (CASE substr(numstr,3,2) WHEN '72' then 'subclass1'
                                       WHEN '98' then 'subclass2'
                                       ELSE 'other'
               END) as subclass
        FROM (select t.*, cast(number as varchar(255)) as numstr
              from table t
             ) t
    ) t
WHERE class <> 'other' AND subclass <> 'other'
GROUP BY class, subclass 
ORDER BY class ASC, subclass DESC; 
```

我还将`having`子句中的比较更改为`subclass <> 'other'`. 没有名为 的列`other`，所以我假设您的意思是值。

# android - 在android中更改更改图像的文本

> ID：15549377
> 
> 赞同：1
> 
> 时间：2013-03-21T13:49:18.390
> 
> 标签：android, android-view

我有一个水平滚动视图，其中包含图像数组列表和滚动视图下方的文本字段，我如何在水平滚动视图中更改图像时更改文本。

```
For Example: The image will show Mountain the text will also texted with mountain 
```

**这里图像只会滚动，文本视图将保持固定，它只会用图像更改名称**

我已经使用下面的代码滚动图像，它工作正常，图像正在改变但文本视图没有改变！

任何人都可以帮助我！@提前致谢

```
 public View getView(int position, View convertView, ViewGroup parent) {

            vi=convertView;

            if(convertView==null){
                vi = LayoutInflater.from(parent.getContext()).inflate(R.layout.screen, null);

               position_pin = position;

              Holder.images=(ImageView) vi.findViewById(R.id.image);
              Holder.textview=(TextView) vi.findViewById(R.id.name);

             Holder.images.setImageResource(imageIds[position]);
           Holder.text.setText(name);

             vi.setTag(Holder);   

            }

                        return vi;
            }

If you have any better option or code then help me. 
```

![在此处输入图像描述](../Images/50b0683ba7d07270a6e85d6057609f29.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:45:10.047

您的代码建议您仅在 convertView 为空时设置文本。通常适配器视图会被重新循环，因此即使没有形成新视图，也应该进行更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:19:26.200

```
Arraylist<String> nameList = new ArrayList<String>();
// add your names the same way you add your images to your images array
...
name = nameList.get(position);
textView.setText(name); 
```

我认为这样的事情应该有效

看起来您正在使用 a`ViewHolder`所以您应该添加到您的`if`语句中

```
else
        {
            Holder = (ViewHolder) vi.getTag();
        } 
```

重复使用您的`Views`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:13:16.237

我想问题在于您获取对应名称的方式。但是您有一个选择（但这很奇怪！）：

您可以将每个图像及其描述合并到另一个图像并仅显示结果。如果您想这样做，您可以使用您的`R.layout.screen`或直接使用画布并将您的图像和所需的描述添加到其中。

# oracle11g - 立即执行

> ID：15549380
> 
> 赞同：0
> 
> 时间：2013-03-21T13:49:20.020
> 
> 标签：oracle11g

谁能帮我找出错误。

```
create or replace procedure sample
is
begin
  DECLARE AGG_COLUMNS VARCHAR2(2000);
      BEGIN
        EXECUTE IMMEDIATE 'SELECT COLUMNS FROM COLUMN_NAMES' INTO AGG_COLUMNS;
      END;
begin
    EXECUTE IMMEDIATE      
      'CREATE TABLE NEW_BW_COLUMN_ROW_CELL_JOIN AS
      (
          SELECT *
          FROM BW_COLUMN_ROW_CELL_JOIN
          PIVOT
          (
            MAX(STRING_VALUE)
            FOR COLUMN_NAME IN ('||AGG_COLUMNS||')))';
  END;
end;

Error(9,5): PL/SQL: Statement ignored

Error(17,36): PLS-00201: identifier 'AGG_COLUMNS' must be declared 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:00:29.330

直接错误是`AGG_COLUMNS`在第一个嵌套的 PL/SQL 块中声明了局部变量。这意味着一旦第一个嵌套块完成，它就超出了范围。因此，您不能在第二个嵌套的 PL/SQL 块中使用它。您可以通过在过程的声明部分声明局部变量来解决此问题。您还可以摆脱嵌套的 PL/SQL 块

```
create or replace procedure sample
is
  AGG_COLUMNS VARCHAR2(2000);
begin
  EXECUTE IMMEDIATE 'SELECT COLUMNS FROM COLUMN_NAMES' INTO AGG_COLUMNS;
  EXECUTE IMMEDIATE      
      'CREATE TABLE NEW_BW_COLUMN_ROW_CELL_JOIN AS
      (
          SELECT *
          FROM BW_COLUMN_ROW_CELL_JOIN
          PIVOT
          (
            MAX(STRING_VALUE)
            FOR COLUMN_NAME IN ('||AGG_COLUMNS||')))';
end; 
```

这应该消除立即的编译错误。不过，我不确定这是否能解决您的所有问题。

*   `COLUMN_NAMES`不是默认 Oracle 安装中的表。这必须是您创建的东西才能运行此代码。
*   如果您确实创建了`COLUMN_NAMES`表并`COLUMNS`存储了逗号分隔的字符串，则无需使用动态 SQL 来查询表。你可以做一个简单的`SELECT ... INTO`.

# javascript - 循环参考：asmx + 实体框架 + Javascript

> ID：15549381
> 
> 赞同：1
> 
> 时间：2013-03-21T13:49:25.450
> 
> 标签：javascript, web-services, entity-framework, linq-to-sql, asmx

我有一个这样设计的模型：用户 => 配置文件 => 模块 => 治疗

该模型首先由实体框架代码进行逆向工程（SQL SERVER DATABASE）

实体 - 映射 ...等，位于不同的 dll 中。

我使用 asmx 来检索我的实体，并将常用参数列表返回给我的应用程序：

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[System.Web.Script.Services.ScriptService]
[Serializable]
public class WsMaster 
{

    public WsMaster()
    {

    }
    [WebMethod(EnableSession = true)]
    public List<object> GetCommonParameters()
    {
        List<object> list = new List<object>();
        try
        {
            CultureInfo culture = (CultureInfo)Session["UserCulture"];
            User user = CDU.Bll.CduBLL.getUser((int)Session["userId"]);
            CommonParameters CommonParameters = new CommonParameters(user,culture);
            list.Add((object)new CommonLabels(culture));
            list.Add(user);
        }
        catch (Exception exp)
        {
            HandleException(exp);
        }
        return list;

    }
} 
```

在我的 aspx 页面中，我引用了这项服务：

```
 <asp:ServiceReference Path="~/Business/Administration/WsMaster.asmx" /> 
```

我直接从 Javascript 调用该服务：

```
 WsMaster.GetCommonParameters(showCDUPageSuccess, showCDUPageFailure); 
```

我收到了这个错误

```
A circular reference was detected while serializing an object of type 'CDU.Entities.Models.User'. 
```

这是因为对象用户包含一个配置文件，其中包含一个用户列表......等等

我禁用了实体框架的延迟加载：

```
 this.Configuration.LazyLoadingEnabled = false; 
```

然后想按需加载：

```
User user = new User();
        using (cduContext db = new cduContext())
        {
            user = (from u in db.Users.Include("Profile")
                    where u.Id==Id
                    select u).FirstOrDefault();

        } 
```

个人资料包括他的用户列表 ... ，我得到了同样的错误。我通过将用户的配置文件列表设置为 null 解决了这个问题：

```
user.Profile.Users = null; 
```

有什么方法可以在配置文件中禁用此“用户列表”的序列化！？请帮忙 ...

# events - FSharp 中的事件和可观察对象

> ID：15549384
> 
> 赞同：20
> 
> 时间：2013-03-21T13:49:33.053
> 
> 标签：events, f#, observable, reactive-programming

是否等效/更好地工作

*   使用[事件类型](http://msdn.microsoft.com/en-us/library/ee370608.aspx)的[事件模块](http://msdn.microsoft.com/en-us/library/ee340422.aspx)
*   [或在事件的发布](http://msdn.microsoft.com/en-us/library/ee353807.aspx)属性上使用 Observable

从功能上看，它似乎是等效的，我想区别在于“语义”：

*   我们是否在可以访问事件内部状态的边界之内？
*   或者我们是否将此[事件接口](http://msdn.microsoft.com/en-us/library/ee340439.aspx)视为向我们公开流的被动源

这是正确的想法吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-21T14:08:43.773

`Event`和之间的主要区别在于`Observable`它们如何处理状态和取消订阅。

*   **事件**函数附加到源事件并且不给您任何取消订阅的方法。如果您使用有状态组合器（如[`Event.scan`](https://fsharp.github.io/fsharp-core-docs/reference/fsharp-control-eventmodule.html#scan)），然后将多个观察者附加到结果事件，那么它们都会看到相同的状态。

*   **可观察**函数构造处理管道的“规范”。当您将处理程序附加到`IObservable`值时，您会返回一个`IDisposable`可用于删除所有处理程序的值。每个附加到的处理程序都`IObservable`将获得一个新状态（因为运行时根据“规范”创建一个新的处理链）。

在实践中，主要区别在于 statfullness——如果你想共享状态，你可以使用`Event`模块——实现相同的使用`Observable`是可能的，但更难。

如果你在里面使用事件`async`，那么你应该使用`Observable`and `AwaitObservable`（而不是内置的`AwaitEvent`），因为使用事件组合器会泄漏内存——它会附加永远不会删除的事件处理程序。

# java - 跨多个环境的 Java 日志记录

> ID：15549388
> 
> 赞同：2
> 
> 时间：2013-03-21T13:49:36.147
> 
> 标签：java, logging, log4j

我们的团队正在尝试进入 Single Build 状态；发送到 Test 的构建与升级到 Staging->etc->Production 的构建相同。现在为不同的环境设置日志记录有点棘手（目前我们使用 Maven 配置文件并在构建时过滤记录器配置）。

**我们有许多 Web 应用程序，我希望日志记录由应用程序定义并由其部署到的环境进行配置。**

我们使用 Log4j，尽管我们对可以使其工作的不同实现持开放态度。我们希望应用程序能够定义记录器，因为某些应用程序可能希望在某些包上进行特定的日志记录，但最终，我希望环境能够配置日志记录路径和级别。例如，QA 环境通常可能`INFO`在包上具有级别日志记录，`com.foo.bar`但如果他们遇到棘手的问题，他们可能希望将其提升到`DEBUG`. 我不想重新部署该应用程序，因为这在技术上会更改构建。

通过最少的探索，我发现 log4j 可以直接使用系统属性，所以这样的设置是可能的：

```
<appender name="someAppender" class="com.whatevs.SomeAppender">
    <param name="File" value="${logger.path}/some_app.log"/>
    <!-- ... -->
</appender>
<logger name="com.foo.bar">
    <level value="${logger.level.com.foo.bar}"></level>
</logger>
<root>
    <priority value="${logger.priority}"/>
    <appender-ref ref="someAppender"/>
</root> 
```

我担心的是，随着部署的应用程序数量和定义的记录器数量的增加，维护系统属性的开销可能会变得很麻烦：

```
-Dlogger.path=/var/log -Dlogger.priority=INFO -Dlogger.level.com.foo.bar=WARN ... 
```

我确信这个问题之前已经解决了。最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:52:14.187

使用 Log4j api 通过代码设置日志级别。因此，根据环境，在应用启动时，您可以设置日志配置。当然，如果需要，您甚至可以通过提供适当的 UI 来定义不同包的日志级别，使其在运行时可配置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:06:31.557

已经进行了几次尝试以使其变得更好，但到目前为止还没有人提出“标准”解决方案：

*   您可以使用[MBean](http://docs.oracle.com/javase/tutorial/jmx/mbeans/index.html)配置日志记录。

    优点：您可以在运行时轻松远程更改配置
    缺点：您不能以这种方式保存/收集配置“配置文件”（即一组有用的配置）。

*   您可以让您的日志框架从 Web 应用程序外部加载配置。

    优点：配置可以很容易地收集在一个文件中。
    您可以使用构建时脚本从模板等生成它们。

    缺点：您需要将这些文件保存在某处，备份/安装它们等。
    您最好想办法在找不到时加载默认配置

*   您可以允许应用程序在运行时切换配置。只需确保初始配置对调试启动问题有用

*   一些日志框架（如 logback）允许包含配置文件。这样可以轻松加载共享配置，然后使用单个系统属性来指定要使用覆盖加载的包含文件。

目前，我更喜欢最后一种方法，因为它允许任意数量的特殊配置。测试团队可以拥有自己的，自己管理它，把它放在他们喜欢的任何地方，在他们空闲的时候更新它。

请注意，用 slf4j/logback 替换 log4j 意味着只替换几个 JAR 文件。如果使用 Maven，则需要 2 分钟（只需添加`logback-classic`和`log4j-over-slf4j`作为依赖项并删除`log4j`）

# xcode - XCode源码控制闪烁

> ID：15549404
> 
> 赞同：0
> 
> 时间：2013-03-21T13:50:08.630
> 
> 标签：xcode, git, version-control

我看到了这个令人毛骨悚然的问题，XCode 的源代码控制指示器在两种状态之间闪烁。很难描述，所以我做了一个屏幕截图：http: [//youtu.be/j39Fn471qaE](http://youtu.be/j39Fn471qaE)

它在两个地方进行：导航树；并在文件详细信息检查器中。

状态 1 导航窗格 - 无源代码控制指示器 源代码控制窗格 - “版本：--”和“状态：无更改”

状态 2 导航窗格 - 添加源代码控制窗格的“A” - “版本：尚未提交”和“状态：已添加”

git 命令行只是将这些文件显示为“新文件”。闪烁的那些似乎与其他没有表现出这种行为的没有什么不同。

目前我只是想继续工作，不要让它分散我的注意力，并希望它不会成为数据丢失的前兆......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T00:57:51.237

好的 - 问题原来是由区分大小写问题引起的。Mac OSX 具有 HFS+ 文件系统，它保留大小写，但不区分大小写。

我最初创建了一个小写字母的目录，后来将其更改为大写。我猜 XCode 正在轮询更改，当它检查新文件时，这些文件是新文件，但是当它试图将它们标记为添加时，git 说它们已经在 repo 中。

解决方法是遵循以下程序： [git mv 并且仅更改目录的大小写](https://stackoverflow.com/questions/3011625/git-mv-and-only-change-case-of-directory)

# grails - Grails Jquery-ui 插件配置

> ID：15549405
> 
> 赞同：2
> 
> 时间：2013-03-21T13:50:12.743
> 
> 标签：grails, grails-plugin

尝试使用来自[http://grails.org/plugin/jquery-ui](http://grails.org/plugin/jquery-ui)的 Jquery-UI 插件， 但显然在讨论使用资源框架的插件时文档不正确，按照说明会导致错误：

```
Error processing GroovyPageView: Error executing tag <r:layoutResources>: No module found with name [jquery-ui] 
```

显然，同样的问题是已知的，但无法在网上找到解决方案（例如：[这里的一些讨论](http://grails.1312388.n4.nabble.com/Jquery-ui-plugin-td4631682.html)和其他一些没有解决方案或解决方案提示的讨论）。

有没有人成功地使用资源框架在 grails 中配置 jquery-ui？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T16:02:13.503

首先你需要安装插件，所以在你的 BuildConfig.groovy

```
plugins {
  ...
  compile ":jquery-ui:1.8.24"
  ...
} 
```

使用`grails compile --refresh-dependencies`并查看控制台是否输出插件的下载。如果你使用的是 STS，你可以进去`right click > grails tools > refresh dependencies`

之后，您可以`<r:require module="jquery-ui"/>`在`<r:layoutResources/>`

一个有用的提示是 jquery ui 主题的变化，你可以在你的`ApplicationResources.groovy`

```
modules = {
    overrides {
        'jquery-theme' {
            resource id:'theme', url:'/css/ui/jquery-ui-1.8.21.custom.css'
        }
    }
} 
```

在这个例子中，我有一个位于`web-app/css/ui/`.

另一个提示是，您可以强制您的模块依赖于 jquery-ui：

```
modules = {
  mymodule {
    dependsOn 'jquery-ui'
    resource url: '/js/my.js'
  }
} 
```

因此，如果您将资源添加`mymodule`到 GSP，`jquery-ui`也会加载。

# ajax - 组合框中新项目的 SelectedValue

> ID：15549406
> 
> 赞同：0
> 
> 时间：2013-03-21T13:50:13.523
> 
> 标签：ajax, combobox

我一直在使用 Ajax 组合框，并从数据库中绑定它，一切正常。后来我使用选择的值来使用Linq得到结果。但是，每当我在同一个项目（即组合框）中添加一个新项目时，我都会将所选文本作为所选值，因此在这种情况下它会创建一个异常。获取新项目的选定值的更好方法是什么，以便我可以绕过异常。

我应该给它一个临时ID吗？

怎么做？

```
Cmbx.DataSource = ScmsFeeBLObj.Mthod();
Cmbx.DataTextField = "Text";
Cmbx.DataValueField = "Id";
Cmbx.DataBind();

protected void Cmbx_SelectedIndexChanged(object sender, EventArgs e)
    {

        String Id = Cmbx.SelectedValue.ToString();
        obj = ScmsFeeBLObj.FillData(Id);
    } 
```

**返回代码（在 DAL 中）：**

```
public ELClass FillData(String Id)
    {
        Int32 ID= Convert.ToInt32(Id);
        var q = (from schedules in context.FeeSchedules
                 where schedules .ScheduleId == ID
                 select schedules );
        return q.SingleOrDefault();
    } 
```

# java - JAXB 对象不实现可序列化的后果是什么？

> ID：15549410
> 
> 赞同：5
> 
> 时间：2013-03-21T13:50:20.910
> 
> 标签：java, jaxb, serializable

我希望有人可以为我澄清这一点，以便我可以更好地理解 JAXB 对象的编组是如何工作的。

通过阅读和查看示例，我了解到必须实现 JAXB 对象才能`java.io.Serializable`正确编组和解组该对象。我有点不确定的部分是当您的 JAXB 对象之一未实现可序列化时会发生什么（阅读：后果是什么）？这在过去发生过，并导致日志文件中的错误类似于

```
ERROR [example.package.name.MyJaxbClass.data]DiskStorageFactory.call{503} | Disk Write of -309037891 failed: 
java.io.NotSerializableException: example.package.name.myJaxbClass$MyNonSerializedElement 
```

然而其余的代码似乎工作正常。对于您的 JAXB 类来说，实现可序列化有多重要，如果不实现会发生什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T13:54:06.273

不需要实现[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)`java.io.Serializable`对象即可将其转换为 XML 或从 XML 转换。对象到/从 XML 转换不会作为 Java 序列化的一部分发生。当然，如果您确实希望序列化对象以与应用程序的其他部分一起使用，那么您需要为此正确配置它们。

# sql - oracle中基于分隔符分割字符串

> ID：15549411
> 
> 赞同：0
> 
> 时间：2013-03-21T13:50:22.440
> 
> 标签：sql, oracle10g

我有一张这样的桌子

```
name Description
VM1  SP L A - WINSVRS #P19  QTY 1
VM2  SPLA - VRSTD #P29-9 9 99 QTY 2 : SPLVRENT #P3 999999 9 QTY 3
VM3  SPLA - WINSVRSTD #P39-9 999 QTY 3
VM4  SPLA - WI NS V R STD #P59- 9 9 99 QTY 2 : S P LA - W IN SV RENT #P39-9999 QTY 3 :   SPLA - WIN S VR SMB # P 3 9- 999 99 QTY 5
VM6  SPLA - WINSVRSQLSERVERaaaaaaaaaSTD #P 6 9-9 9 9 9 QTY 6 
```

我需要这样的输出

```
name Description                     ponumber
-------------------------------------------------
VM1  SP L A - WINSVRS                   P19 
VM2  SPLA - VRSTD                       P29-9 9 99                      
VM2  SPLVRENT                           P3 999999 9
VM3  SPLA - WINSVRSTD                   P39-9 999
VM4  SPLA - WI NS V R STD               P59- 9 9 99
VM4  S P LA - W IN SV RENT              P39-9999
VM4  SPL A - WIN S VR SMB               P 3 9- 999 99
VM6  SPLA - WINSVRSQLSERVERaaaaaaaaaSTD P 6 9-9 9 9 9 
```

帮助我如何使用子字符串和使用循环的 instr 字符串获取输出

感谢和问候阿南德

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:08:10.817

尝试这个

```
with CTE as
(
  select name, 
  trim(cast(v.column_value.extract('//text()') as varchar2(50))) description
  from t,
  table( xmlsequence( xmltype(
    '<descriptions><description>' 
     || replace(description, ':', '</description><description>') 
     || '</description></descriptions>'
        ).extract('//descriptions/*'))) v
 )
select 
 name,
 REGEXP_SUBSTR(description,'[^#]+') description,
 --REGEXP_SUBSTR(description,'[^#]+',1,2) phnQty,
 Trim(REGEXP_SUBSTR(REGEXP_SUBSTR(description,'[^#]+',1,2),'[^Q]+')) phn
from cte; 
```

[SQL 演示](http://sqlfiddle.com/#!4/dcd97/11)

# c++ - shared_array 的元素作为 shared_ptr？

> ID：15549413
> 
> 赞同：8
> 
> 时间：2013-03-21T13:50:25.820
> 
> 标签：c++, boost, c++11, shared-ptr

如果我有一个`boost::shared_array<T>`（或一个`boost::shared_ptr<T[]>`），有没有办法获得`boost::shared_ptr<T>`与数组共享的一个？

例如，我可能想写：

```
shared_array<int> array(new int[10]);
shared_ptr<int> element = &array[2]; 
```

我知道我不能使用`&array[2]`，因为它只有 type ，并且拥有一个采用该类型的隐式构造函数`int *`会很危险。`shared_ptr<int>`理想情况下`shared_array<int>`会有一个实例方法，例如：

```
shared_ptr<int> element = array.shared_ptr_to(2); 
```

不幸的是，我找不到这样的东西。有一个别名构造函数`shared_ptr<int>`，它将与另一个别名`shared_ptr<T>`，但它不允许别名与`shared_array<T>`; 所以我也不能写这个（它不会编译）：

```
shared_ptr<int> element(array, &array[2]);
//Can't convert 'array' from shared_array<int> to shared_ptr<int> 
```

我玩过的另一个选择是使用`std::shared_ptr<T>`(`std`而不是`boost`)。的专业化`T[]`没有标准化，所以我想自己定义。不幸的是，我认为这实际上是不可能的，它不会破坏别名构造函数的内部结构，因为它试图将 my`std::shared_ptr<T[]>`转换为它自己的特定于实现的超类型，这不再可能。（我的目前只是从 boost 继承。）这个想法的好处是我可以实现我的实例`shared_ptr_to`方法。

这是我尝试过的另一个想法，但我认为它的效率不足以作为我们可能会在整个大型项目中使用的东西。

```
template<typename T>
boost::shared_ptr<T> GetElementPtr(const boost::shared_array<T> &array, size_t index) {
    //This deleter works by holding on to the underlying array until the deleter itself is deleted.
    struct {
        boost::shared_array<T> array;
        void operator()(T *) {} //No action required here.
    } deleter = { array };
    return shared_ptr<T>(&array[index], deleter);
} 
```

接下来我要尝试升级到 Boost 1.53.0（我们目前只有 1.50.0），使用`shared_ptr<T[]>`而不是`shared_array<T>`，并且总是使用`boost`而不是`std`（即使对于非数组）。我希望这会起作用，但我还没有机会尝试它：

```
shared_ptr<int[]> array(new int[10]);
shared_ptr<int> element(array, &array[2]); 
```

当然，我仍然更喜欢实例方法语法，但我想我对那个不走运（没有修改 Boost）：

```
shared_ptr<int> element = array.shared_ptr_to(2); 
```

其他人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:06:06.833

你在做奇怪的事情。为什么需要`shared_ptr`元素？您是否希望将数组元素传递到其他地方并阻止您的数组被移除？

如果是的话，那就`std::vector<shared_ptr<T>>`更适合了。该解决方案是安全、标准的，并且在对象移除方面具有精细的粒度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T23:16:19.517

这就是我最后所做的。

我自己实现了`shared_array<T>`. 它有效地扩展`shared_ptr<vector<T>>`了，除了它实际上扩展了我自己的包装器，`vector<T>`以便用户无法获取向量。这意味着我可以保证它不会被调整大小。然后我实现了我需要的实例方法——`weak_ptr_to(size_t)`当然也包括`operator[]`。

我的实现用于`std::make_shared`制作向量。所以向量与控制块分开分配其内部数组存储，但向量本身成为控制块的成员。因此，这相当于忘记使用`std::make_shared`普通类型 - 但因为这些是数组，它们可能很大而且很少，所以它不太重要。

我还可以创建一个基于`shared_ptr<T>`但有`default_delete<T[]>`或任何需要的实现，但它必须与控制块分开分配数组（因此与向量相比没有太多节省）。我认为没有一种可移植的方式将动态大小的数组嵌入到控制块中。

或者我的实现可以基于`boost::shared_array<T>`, 并在获取元素指针时使用自定义删除器（根据问题中的示例）。在大多数情况下，这可能会更糟，因为不是一次性命中分配数组，而是每次我们使用别名指针时都会受到命中（这可能会发生在非常短暂的指针中很多）。

我认为让它更加优化的唯一合理方法是使用最新的提升（如果它有效；在我改变主意之前我没有尝试过，主要是因为我希望自己的实例成员）。当然，这意味着在`boost`任何地方都使用它们，即使对于单个对象也是如此。

*但是*，我使用的主要优点是 Visual Studio 的调试器（我被告知）擅长显示 std::shared_ptrs 和 std::vectors 的内容，并且（我们期望）不太擅长分析 boost 的内容东西或定制的东西。

所以我认为我所做的基本上是最优的。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:23:35.200

`boost::shared_ptr`似乎并不自然地支持这一点。也许您可以使用自定义删除器解决此问题。但是`std::shared_ptr` 提供了一个特殊的构造函数来支持你想要的：

```
struct foo
{
    int a;
    double b;
};

int main()
{
    auto sp1 = std::make_shared<foo>();
    std::shared_ptr<int> sp2 (sp1,&sp1->a);
} 
```

在这里，`sp1`和`sp2`共享对象的所有权`foo`只是`sp2`指向它的一个成员。如果`sp1`被销毁，该`foo`对象将仍然活着并且`sp2`仍然有效。

# javascript - 使用 javascript 浏览器检测大小获取的数据时遇到问题

> ID：15549414
> 
> 赞同：0
> 
> 时间：2013-03-21T13:50:26.840
> 
> 标签：javascript, dom

作为 javascript 的新手，我似乎遗漏了一些东西。我用过这段代码。

```
<script language="JavaScript">
    // Get Browser Viewport Width
    var adjust = "<?php echo $adjust; ?>";
    // Get Browser Viewport Height
    var height = window.innerHeight ||
    document.documentElement.clientHeight ||
    document.body.clientHeight;
    // Get Browser Viewport Height
    var height = window.getSize().y;

    window.alert( 'height = ' + (height - adjust) + 'px' );
</script> 
```

它完美地工作并给我一个提醒，表明计算工作正常。但是，我似乎无法正确传输高度变量以使 div 执行我所要求的操作。

我在正文中使用了以下代码。

```
<div id="bodyheight">

                </div>
                <script language="JavaScript">
                document.getElementById("bodyheight").style.height = height;</script> 
```

任何人都可以指出正确的方向并填补我的知识空白。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:46:28.947

在这里 - 我不知道你从哪里得到 getSize - 你有两个 var 高度，这是不正确的语法

[演示](http://jsfiddle.net/mplungjan/vuHML/)

```
window.onload=function() {
// Get Browser Viewport Width
    var adjust = "200";
    // Get Browser Viewport Height
    var height = window.innerHeight ||
    document.documentElement.clientHeight ||
    document.body.clientHeight;
    // Get Browser Viewport Height
    height = (window.getSize)? window.getSize().y:height;
    var newHeight = (height - adjust) + 'px' 
    window.alert(height+' adjusted to '+newHeight);
    document.getElementById("bodyheight").style.height = newHeight;
} 
```

# node.js - node-webkit http.Server 和页面变化

> ID：15549415
> 
> 赞同：1
> 
> 时间：2013-03-21T13:50:31.547
> 
> 标签：node.js, subprocess, node-webkit

我使用 node-webkit 编写了一个应用程序。我想使用 HTTP 在计算机之间进行网络通信，运行我的应用程序。如果服务器是从页面启动的，我可以在不重新启动服务器的情况下更改当前页面吗？

我考虑过子进程，但我想用我的应用程序关闭服务器。我不想对服务器使用特殊的网络请求来关闭它。

我可以在不重新启动服务器的情况下更改当前页面吗？我可以在页面更改时保存子进程对象吗？你知道其他方法吗？

PS对不起我的英语。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:31:38.167

我在 node-webkit 文档中找到了答案。

> 在 node-webkit 中，你基本上可以使用 来做同样的事情 `window.location`，你可以在链接的情况下安装它，`onclick`当用户点击它时 node-webkit 将导航到一个新页面。但是这样做会丢失上下文中的所有内容`window`，您可以将所有内容保存在 cookie 中，如旧网页，或者您可以将内容保存在`global`变量中，该变量位于 Node.js 的上下文中，并将通过您的应用程序存在。

# android - 如何在 Android 中下载和保存图像

> ID：15549421
> 
> 赞同：95
> 
> 时间：2013-03-21T13:50:45.363
> 
> 标签：android, android-imageview, imagedownload

如何从 Android 中的给定 url 下载和保存图像？

* * *

## 回答 #1

> 赞同：229
> 
> 时间：2013-03-21T14:00:01.787

## 从 30.12.2015 开始编辑 - 图像下载的终极指南

* * *

*最后一次重大更新：2016 年 3 月 31 日*

* * *

***TL；DR aka 别说话，给我代码！***

> 跳到这篇文章的底部，将`BasicImageDownloader`（javadoc version [here](https://github.com/vad-zuev/ImageDownloader/blob/master/app/src/main/java/com/so/example/tools/BasicImageDownloader.java)）复制到你的项目中，实现`OnImageLoaderListener`接口，你就完成了。
> 
> **注意**：虽然`BasicImageDownloader`处理可能的错误并防止您的应用程序在出现任何问题时崩溃，但它不会对下载的`Bitmaps`.

* * *

由于这篇文章受到了很多关注，我决定彻底修改它，以防止人们使用过时的技术、糟糕的编程实践或只是做一些愚蠢的事情——比如寻找“黑客”来在主线程上运行网络或接受所有 SSL 证书。

我创建了一个名为“Image Downloader”的演示项目，它演示了如何使用我自己的下载器实现、Android 的内置`DownloadManager`以及一些流行的开源库来下载（和保存）图像。[您可以在 GitHub 上](https://github.com/vad-zuev/ImageDownloader/)查看完整的源代码或下载项目。

> **注意**：我还没有调整 SDK 23+ (Marshmallow) 的权限管理，因此该项目针对的是 SDK 22 (Lollipop)。

在这篇文章结尾的***结论***中，我将分享我对我提到的每种特定图像下载方式的正确用例的*拙见。*

让我们从一个自己的实现开始（您可以在文章末尾找到代码）。首先，这是一个**基本**的 ImageDownloader，仅此而已。它所做的只是连接到给定的 url，读取数据并尝试将其解码为`Bitmap`，并在适当的时候触发`OnImageLoaderListener`接口回调。这种方法的优点 - 它很简单，您可以清楚地了解正在发生的事情。如果您只需要下载/显示和保存一些图像，而您不关心维护内存/磁盘缓存，这是一个好方法。

> 注意：如果图像很大，您可能需要[缩小它们](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)。

--

Android [DownloadManager](http://developer.android.com/reference/android/app/DownloadManager.html)是一种让系统为您处理下载的方法。它实际上能够下载任何类型的文件，而不仅仅是图像。您可以让您的下载静默进行并且对用户不可见，或者您可以让用户在通知区域中看到下载。您也可以注册一个`BroadcastReceiver`以在下载完成后收到通知。设置非常简单，请参阅链接项目以获取示例代码。

`DownloadManager`如果您还想显示图像，则使用通常不是一个好主意，因为您需要读取和解码保存的文件，而不仅仅是将下载的文件设置`Bitmap`为`ImageView`. `DownloadManager`也没有为您的应用程序提供任何 API 来跟踪下载进度。

--

现在介绍伟大的东西 - 图书馆。他们可以做的不仅仅是下载和显示图像，包括：创建和管理内存/磁盘缓存、调整图像大小、转换图像等等。

我将从[Volley](http://developer.android.com/training/volley/index.html)开始，这是一个由 Google 创建并包含在官方文档中的强大库。虽然是一个不专门处理图像的通用网络库，但 Volley 具有非常强大的 API 来管理图像。

您将需要实现一个[Singleton](https://en.wikipedia.org/wiki/Singleton_pattern)类来管理 Volley 请求，并且一切顺利。

你可能想`ImageView`用 Volley's替换你的`NetworkImageView`，所以下载基本上变成了单行：

```
((NetworkImageView) findViewById(R.id.myNIV)).setImageUrl(url, MySingleton.getInstance(this).getImageLoader()); 
```

`ImageRequest`如果您需要更多控制，这就是用 Volley创建一个的样子：

```
 ImageRequest imgRequest = new ImageRequest(url, new Response.Listener<Bitmap>() {
             @Override
             public void onResponse(Bitmap response) {
                    //do stuff
                }
            }, 0, 0, ImageView.ScaleType.CENTER_CROP, Bitmap.Config.ARGB_8888, 
             new Response.ErrorListener() {
             @Override
             public void onErrorResponse(VolleyError error) {
                   //do stuff
                }
            }); 
```

值得一提的是，Volley 提供了一个出色的错误处理机制，它提供了一个`VolleyError`类来帮助您确定错误的确切原因。如果您的应用程序进行大量网络连接并且管理图像不是其主要目的，那么 Volley 非常适合您。

--

Square 的[Picasso](http://square.github.io/picasso/)是一个著名的库，它将为您完成所有图像加载工作。仅使用 Picasso 显示图像就很简单：

```
 Picasso.with(myContext)
       .load(url)
       .into(myImageView); 
```

默认情况下，毕加索管理磁盘/内存缓存，因此您无需担心。要获得更多控制，您可以实现该`Target`接口并使用它来加载您的图像 - 这将提供类似于 Volley 示例的回调。检查演示项目以获取示例。

Picasso 还允许您对下载的图像应用转换，甚至还有[其他库](https://github.com/wasabeef/picasso-transformations)可以扩展这些 API。`RecyclerView`在/ `ListView`/中也能很好地工作`GridView`。

--

[Universal Image Loader](https://github.com/nostra13/Android-Universal-Image-Loader)是另一个非常流行的用于图像管理的库。它使用自己的`ImageLoader`that（一旦初始化）有一个全局实例，可用于在一行代码中下载图像：

```
 ImageLoader.getInstance().displayImage(url, myImageView); 
```

如果您想跟踪下载进度或访问下载的`Bitmap`：

```
 ImageLoader.getInstance().displayImage(url, myImageView, opts, 
 new ImageLoadingListener() {
     @Override
     public void onLoadingStarted(String imageUri, View view) {
                     //do stuff
                }

      @Override
      public void onLoadingFailed(String imageUri, View view, FailReason failReason) {
                   //do stuff
                }

      @Override
      public void onLoadingComplete(String imageUri, View view, Bitmap loadedImage) {
                   //do stuff
                }

      @Override
      public void onLoadingCancelled(String imageUri, View view) {
                   //do stuff
                }
            }, new ImageLoadingProgressListener() {
      @Override
      public void onProgressUpdate(String imageUri, View view, int current, int total) {
                   //do stuff
                }
            }); 
```

此示例中的`opts`参数是一个`DisplayImageOptions`对象。请参阅演示项目以了解更多信息。

与 Volley 类似，UIL 提供了一个`FailReason`类，使您能够检查下载失败时出了什么问题。默认情况下，如果您没有明确告诉它不要这样做，UIL 会维护一个内存/磁盘缓存。

**注意**：作者提到他在 2015 年 11 月 27 日不再维护该项目。但是由于贡献者很多，我们可以希望 Universal Image Loader 继续存在。

--

Facebook 的[Fresco](http://frescolib.org/)是最新和 (IMO) 最先进的库，它将图像管理提升到一个新的水平：从`Bitmaps`远离 Java 堆（在 Lollipop 之前）到支持[动画格式](http://frescolib.org/docs/animations.html)和[渐进式 JPEG 流](http://frescolib.org/docs/progressive-jpegs.html)。

要了解有关 Fresco 背后的想法和技术的更多信息，请参阅[这篇文章](https://code.facebook.com/posts/366199913563917/introducing-fresco-a-new-image-library-for-android/)。

基本用法非常简单。请注意，您 `Fresco.initialize(Context);`只需要调用一次，最好在`Application`课堂上调用。多次初始化 Fresco 可能会导致不可预知的行为和 OOM 错误。

Fresco 使用`Drawee`s 来显示图像，你可以把它们想象成`ImageView`s：

```
 <com.facebook.drawee.view.SimpleDraweeView
    android:id="@+id/drawee"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    fresco:fadeDuration="500"
    fresco:actualImageScaleType="centerCrop"
    fresco:placeholderImage="@drawable/placeholder_grey"
    fresco:failureImage="@drawable/error_orange"
    fresco:placeholderImageScaleType="fitCenter"
    fresco:failureImageScaleType="centerInside"
    fresco:retryImageScaleType="centerCrop"
    fresco:progressBarImageScaleType="centerInside"
    fresco:progressBarAutoRotateInterval="1000"
    fresco:roundAsCircle="false" /> 
```

如您所见，很多东西（包括转换选项）已经在 XML 中定义了，所以显示图像所需要做的就是单行：

```
 mDrawee.setImageURI(Uri.parse(url)); 
```

Fresco 提供了一个扩展的自定义 API，在某些情况下，它可能非常复杂，需要用户仔细阅读文档（是的，有时*您需要*RTFM）。

我在示例项目中包含了渐进式 JPEG 和动画图像的示例。

* * *

### 结论 - “我已经了解了很棒的东西，我现在应该使用什么？”

> *请注意，以下文字反映了我的个人观点，不应被视为假设。*

*   如果您只需要下载/保存/显示一些图像，不打算在 a 中使用它们`Recycler-/Grid-/ListView`并且不需要一大堆图像即可显示，**BasicImageDownloader**应该满足您的需求。
*   如果您的应用由于用户或自动操作而保存图像（或其他文件），并且您不需要经常显示图像，请使用 Android**下载**管理器。
*   如果您的应用程序进行大量联网、传输/接收`JSON`数据、处理图像，但这些不是应用程序的主要目的，请使用**Volley**。
*   您的应用以图像/媒体为中心，您想对图像应用一些转换并且不想打扰复杂的 API：使用**Picasso**（注意：不提供任何 API 来跟踪中间下载状态）或**Universal Image装载机**
*   如果您的应用程序都是关于图像的，您需要显示动画格式等高级功能，并且您已准备好阅读文档，请使用**Fresco**。

如果你错过了，演示项目的[Github 链接](https://github.com/vad-zuev/ImageDownloader)。

* * *

这是`BasicImageDownloader.java`

```
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.os.AsyncTask;
import android.support.annotation.NonNull;
import android.util.Log;
import java.io.BufferedInputStream;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.URL;
import java.net.URLConnection;
import java.util.HashSet;
import java.util.Set;

public class BasicImageDownloader {

    private OnImageLoaderListener mImageLoaderListener;
    private Set<String> mUrlsInProgress = new HashSet<>();
    private final String TAG = this.getClass().getSimpleName();

    public BasicImageDownloader(@NonNull OnImageLoaderListener listener) {
        this.mImageLoaderListener = listener;
    }

    public interface OnImageLoaderListener {
        void onError(ImageError error);      
        void onProgressChange(int percent);
        void onComplete(Bitmap result);
    }

    public void download(@NonNull final String imageUrl, final boolean displayProgress) {
        if (mUrlsInProgress.contains(imageUrl)) {
            Log.w(TAG, "a download for this url is already running, " +
                    "no further download will be started");
            return;
        }

        new AsyncTask<Void, Integer, Bitmap>() {

            private ImageError error;

            @Override
            protected void onPreExecute() {
                mUrlsInProgress.add(imageUrl);
                Log.d(TAG, "starting download");
            }

            @Override
            protected void onCancelled() {
                mUrlsInProgress.remove(imageUrl);
                mImageLoaderListener.onError(error);
            }

            @Override
            protected void onProgressUpdate(Integer... values) {
                mImageLoaderListener.onProgressChange(values[0]);
            }

        @Override
        protected Bitmap doInBackground(Void... params) {
            Bitmap bitmap = null;
            HttpURLConnection connection = null;
            InputStream is = null;
            ByteArrayOutputStream out = null;
            try {
                connection = (HttpURLConnection) new URL(imageUrl).openConnection();
                if (displayProgress) {
                    connection.connect();
                    final int length = connection.getContentLength();
                    if (length <= 0) {
                        error = new ImageError("Invalid content length. The URL is probably not pointing to a file")
                                .setErrorCode(ImageError.ERROR_INVALID_FILE);
                        this.cancel(true);
                    }
                    is = new BufferedInputStream(connection.getInputStream(), 8192);
                    out = new ByteArrayOutputStream();
                    byte bytes[] = new byte[8192];
                    int count;
                    long read = 0;
                    while ((count = is.read(bytes)) != -1) {
                        read += count;
                        out.write(bytes, 0, count);
                        publishProgress((int) ((read * 100) / length));
                    }
                    bitmap = BitmapFactory.decodeByteArray(out.toByteArray(), 0, out.size());
                } else {
                    is = connection.getInputStream();
                    bitmap = BitmapFactory.decodeStream(is);
                }
            } catch (Throwable e) {
                if (!this.isCancelled()) {
                    error = new ImageError(e).setErrorCode(ImageError.ERROR_GENERAL_EXCEPTION);
                    this.cancel(true);
                }
            } finally {
                try {
                    if (connection != null)
                        connection.disconnect();
                    if (out != null) {
                        out.flush();
                        out.close();
                    }
                    if (is != null)
                        is.close();
                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
            return bitmap;
        }

            @Override
            protected void onPostExecute(Bitmap result) {
                if (result == null) {
                    Log.e(TAG, "factory returned a null result");
                    mImageLoaderListener.onError(new ImageError("downloaded file could not be decoded as bitmap")
                            .setErrorCode(ImageError.ERROR_DECODE_FAILED));
                } else {
                    Log.d(TAG, "download complete, " + result.getByteCount() +
                            " bytes transferred");
                    mImageLoaderListener.onComplete(result);
                }
                mUrlsInProgress.remove(imageUrl);
                System.gc();
            }
        }.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);
    }

    public interface OnBitmapSaveListener {
        void onBitmapSaved();
        void onBitmapSaveError(ImageError error);
    }

    public static void writeToDisk(@NonNull final File imageFile, @NonNull final Bitmap image,
                               @NonNull final OnBitmapSaveListener listener,
                               @NonNull final Bitmap.CompressFormat format, boolean shouldOverwrite) {

    if (imageFile.isDirectory()) {
        listener.onBitmapSaveError(new ImageError("the specified path points to a directory, " +
                "should be a file").setErrorCode(ImageError.ERROR_IS_DIRECTORY));
        return;
    }

    if (imageFile.exists()) {
        if (!shouldOverwrite) {
            listener.onBitmapSaveError(new ImageError("file already exists, " +
                    "write operation cancelled").setErrorCode(ImageError.ERROR_FILE_EXISTS));
            return;
        } else if (!imageFile.delete()) {
            listener.onBitmapSaveError(new ImageError("could not delete existing file, " +
                    "most likely the write permission was denied")
                    .setErrorCode(ImageError.ERROR_PERMISSION_DENIED));
            return;
        }
    }

    File parent = imageFile.getParentFile();
    if (!parent.exists() && !parent.mkdirs()) {
        listener.onBitmapSaveError(new ImageError("could not create parent directory")
                .setErrorCode(ImageError.ERROR_PERMISSION_DENIED));
        return;
    }

    try {
        if (!imageFile.createNewFile()) {
            listener.onBitmapSaveError(new ImageError("could not create file")
                    .setErrorCode(ImageError.ERROR_PERMISSION_DENIED));
            return;
        }
    } catch (IOException e) {
        listener.onBitmapSaveError(new ImageError(e).setErrorCode(ImageError.ERROR_GENERAL_EXCEPTION));
        return;
    }

    new AsyncTask<Void, Void, Void>() {

        private ImageError error;

        @Override
        protected Void doInBackground(Void... params) {
            FileOutputStream fos = null;
            try {
                fos = new FileOutputStream(imageFile);
                image.compress(format, 100, fos);
            } catch (IOException e) {
                error = new ImageError(e).setErrorCode(ImageError.ERROR_GENERAL_EXCEPTION);
                this.cancel(true);
            } finally {
                if (fos != null) {
                    try {
                        fos.flush();
                        fos.close();
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                }
            }
            return null;
        }

        @Override
        protected void onCancelled() {
            listener.onBitmapSaveError(error);
        }

        @Override
        protected void onPostExecute(Void result) {
            listener.onBitmapSaved();
        }
    }.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR);
  }

public static Bitmap readFromDisk(@NonNull File imageFile) {
    if (!imageFile.exists() || imageFile.isDirectory()) return null;
    return BitmapFactory.decodeFile(imageFile.getAbsolutePath());
}

public interface OnImageReadListener {
    void onImageRead(Bitmap bitmap);
    void onReadFailed();
}

public static void readFromDiskAsync(@NonNull File imageFile, @NonNull final OnImageReadListener listener) {
    new AsyncTask<String, Void, Bitmap>() {
        @Override
        protected Bitmap doInBackground(String... params) {
            return BitmapFactory.decodeFile(params[0]);
        }

        @Override
        protected void onPostExecute(Bitmap bitmap) {
            if (bitmap != null)
                listener.onImageRead(bitmap);
            else
                listener.onReadFailed();
        }
    }.executeOnExecutor(AsyncTask.THREAD_POOL_EXECUTOR, imageFile.getAbsolutePath());
}

    public static final class ImageError extends Throwable {

        private int errorCode;
        public static final int ERROR_GENERAL_EXCEPTION = -1;
        public static final int ERROR_INVALID_FILE = 0;
        public static final int ERROR_DECODE_FAILED = 1;
        public static final int ERROR_FILE_EXISTS = 2;
        public static final int ERROR_PERMISSION_DENIED = 3;
        public static final int ERROR_IS_DIRECTORY = 4;

        public ImageError(@NonNull String message) {
            super(message);
        }

        public ImageError(@NonNull Throwable error) {
            super(error.getMessage(), error.getCause());
            this.setStackTrace(error.getStackTrace());
        }

        public ImageError setErrorCode(int code) {
            this.errorCode = code;
            return this;
        }

        public int getErrorCode() {
            return errorCode;
        }
      }
   } 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2014-04-24T12:50:01.000

我刚刚解决了这个问题，我想分享完整的代码，可以下载、保存到 SD 卡（并隐藏文件名）并检索图像，最后检查图像是否已经存在。url 来自数据库，因此文件名可以很容易地使用 id。

首先，创建一个用于下载图像的类。

```
private class GetImages extends AsyncTask<Object, Object, Object> {
    private String requestUrl, imagename_;
    private ImageView view;
    private Bitmap bitmap;
    private FileOutputStream fos;

    private GetImages(String requestUrl, ImageView view, String _imagename_) {
        this.requestUrl = requestUrl;
        this.view = view;
        this.imagename_ = _imagename_;
    }

    @Override
    protected Object doInBackground(Object... objects) {
        try {
            URL url = new URL(requestUrl);
            URLConnection conn = url.openConnection();
            bitmap = BitmapFactory.decodeStream(conn.getInputStream());
        } catch (Exception ex) {
        }
        return null;
    }

    @Override
    protected void onPostExecute(Object o) {
        if (!ImageStorage.checkifImageExists(imagename_)) {
            view.setImageBitmap(bitmap);
            ImageStorage.saveToSdCard(bitmap, imagename_);
        }
    }
} 
```

然后，创建一个用于保存和检索文件的类。

```
public class ImageStorage {
    public static String saveToSdCard(Bitmap bitmap, String filename) {

        String stored = null;
        File sdcard = Environment.getExternalStorageDirectory();

        File folder = new File(sdcard.getAbsoluteFile(), ".your_specific_directory");//the dot makes this directory hidden to the user
        folder.mkdir();
        File file = new File(folder.getAbsoluteFile(), filename + ".jpg");
        if (file.exists())
            return stored;

        try {
            FileOutputStream out = new FileOutputStream(file);
            bitmap.compress(Bitmap.CompressFormat.JPEG, 90, out);
            out.flush();
            out.close();
            stored = "success";
        } catch (Exception e) {
            e.printStackTrace();
        }
        return stored;
    }

    public static File getImage(String imagename) {
        File mediaImage = null;
        try {
            String root = Environment.getExternalStorageDirectory().toString();
            File myDir = new File(root);
            if (!myDir.exists())
                return null;

            mediaImage = new File(myDir.getPath() + "/.your_specific_directory/" + imagename);
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return mediaImage;
    }

    public static boolean checkifImageExists(String imagename) {
        Bitmap b = null;
        File file = ImageStorage.getImage("/" + imagename + ".jpg");
        String path = file.getAbsolutePath();

        if (path != null)
            b = BitmapFactory.decodeFile(path);

        if (b == null || b.equals("")) {
            return false;
        }
        return true;
    }
} 
```

然后，要访问图像，首先检查它是否已经存在；如果没有然后下载。

```
if(ImageStorage.checkifImageExists(imagename)) {
    File file = ImageStorage.getImage("/"+imagename+".jpg");
    String path = file.getAbsolutePath();
    if (path != null){
        b = BitmapFactory.decodeFile(path);
        imageView.setImageBitmap(b);
    }
} else {
    new GetImages(imgurl, imageView, imagename).execute() ;
} 
```

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2014-01-22T07:28:51.797

为什么你真的需要自己的代码来下载它？将您的 URI 传递给下载管理器怎么样？

```
public void downloadFile(String uRl) {
    File direct = new File(Environment.getExternalStorageDirectory()
            + "/AnhsirkDasarp");

    if (!direct.exists()) {
        direct.mkdirs();
    }

    DownloadManager mgr = (DownloadManager) getActivity().getSystemService(Context.DOWNLOAD_SERVICE);

    Uri downloadUri = Uri.parse(uRl);
    DownloadManager.Request request = new DownloadManager.Request(
            downloadUri);

    request.setAllowedNetworkTypes(
            DownloadManager.Request.NETWORK_WIFI
                    | DownloadManager.Request.NETWORK_MOBILE)
            .setAllowedOverRoaming(false).setTitle("Demo")
            .setDescription("Something useful. No, really.")
            .setDestinationInExternalPublicDir("/AnhsirkDasarp", "fileName.jpg");

    mgr.enqueue(request);

} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-03-21T14:30:46.983

此代码可能会对您有所帮助。

```
Button download_image = (Button) bigimagedialog.findViewById(R.id.btn_downloadimage);
                    download_image.setOnClickListener(new View.OnClickListener()

{
    public void onClick (View v)
    {
        boolean success = (new File("/sdcard/dirname")).mkdir();
        if (!success) {
            Log.w("directory not created", "directory not created");
        }

        try {
            URL url = new URL("YOUR_URL");
            HttpURLConnection connection = (HttpURLConnection) url.openConnection();
            connection.setDoInput(true);
            connection.connect();
            InputStream input = connection.getInputStream();
            Bitmap myBitmap = BitmapFactory.decodeStream(input);

            String data1 = String.valueOf(String.format("/sdcard/dirname/%d.jpg", System.currentTimeMillis()));

            FileOutputStream stream = new FileOutputStream(data1);

            ByteArrayOutputStream outstream = new ByteArrayOutputStream();
            myBitmap.compress(Bitmap.CompressFormat.JPEG, 85, outstream);
            byte[] byteArray = outstream.toByteArray();

            stream.write(byteArray);
            stream.close();

            Toast.makeText(getApplicationContext(), "Downloading Completed", Toast.LENGTH_SHORT).show();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-06-27T12:51:44.323

我有一个运行良好的简单解决方案。代码不是我的，我在这个[链接](http://www.codexpedia.com/android/android-download-and-save-image-internally/)上找到的。以下是要遵循的步骤：

**1.**在下载图片之前，我们先写一个方法，将位图保存到android内部存储的图片文件中。它需要一个上下文，最好通过 getApplicationContext() 在应用程序上下文中使用传递。此方法可以转储到您的 Activity 类或其他实用程序类中。

```
public void saveImage(Context context, Bitmap b, String imageName) 
{
    FileOutputStream foStream;
    try 
    {
        foStream = context.openFileOutput(imageName, Context.MODE_PRIVATE);
        b.compress(Bitmap.CompressFormat.PNG, 100, foStream);
        foStream.close();
    } 
    catch (Exception e) 
    {
        Log.d("saveImage", "Exception 2, Something went wrong!");
        e.printStackTrace();
    }
} 
```

**2.**现在我们有了在andorid中将位图保存到图片文件中的方法，我们来写一个通过url下载图片的AsyncTask。这个私有类需要作为子类放在你的 Activity 类中。图片下载完成后，在onPostExecute方法中，调用上面定义的saveImage方法保存图片。请注意，图像名称被硬编码为“my_image.png”。

```
private class DownloadImage extends AsyncTask<String, Void, Bitmap> {
    private String TAG = "DownloadImage";
    private Bitmap downloadImageBitmap(String sUrl) {
        Bitmap bitmap = null;
        try {
            InputStream inputStream = new URL(sUrl).openStream();   // Download Image from URL
            bitmap = BitmapFactory.decodeStream(inputStream);       // Decode Bitmap
            inputStream.close();
        } catch (Exception e) {
            Log.d(TAG, "Exception 1, Something went wrong!");
            e.printStackTrace();
        }
        return bitmap;
    }

    @Override
    protected Bitmap doInBackground(String... params) {
        return downloadImageBitmap(params[0]);
    }

    protected void onPostExecute(Bitmap result) {
        saveImage(getApplicationContext(), result, "my_image.png");
    }
} 
```

**3.**定义了用于下载图像的 AsyncTask，但我们需要执行它才能运行该 AsyncTask。为此，请在 Activity 类的 onCreate 方法中，或在按钮的 onClick 方法中或您认为合适的其他地方编写此行。

```
new DownloadImage().execute("http://developer.android.com/images/activity_lifecycle.png"); 
```

图像应保存在 /data/data/your.app.packagename/files/my_image.jpeg 中，查看这篇文章以从您的设备访问此目录。

**IMO这解决了这个问题！如果您想要进一步的步骤，例如加载图像，您可以按照以下额外步骤操作：**

**4.**图像下载完成后，我们需要一种方法从内部存储中加载图像位图，这样我们就可以使用它了。让我们编写加载图像位图的方法。该方法有两个参数，一个上下文和一个图像文件名，如果没有完整路径，context.openFileInput(imageName) 将在上述saveImage 方法中保存该文件名时在保存目录中查找该文件。

```
public Bitmap loadImageBitmap(Context context, String imageName) {
    Bitmap bitmap = null;
    FileInputStream fiStream;
    try {
        fiStream    = context.openFileInput(imageName);
        bitmap      = BitmapFactory.decodeStream(fiStream);
        fiStream.close();
    } catch (Exception e) {
        Log.d("saveImage", "Exception 3, Something went wrong!");
        e.printStackTrace();
    }
    return bitmap;
} 
```

**5.**现在我们拥有了设置 ImageView 或您喜欢在其上使用图像的任何其他 View 的图像所需的一切。当我们保存图像时，我们将图像名称硬编码为“my_image.jpeg”，现在我们可以将此图像名称传递给上面的 loadImageBitmap 方法来获取位图并将其设置为 ImageView。

```
someImageView.setImageBitmap(loadImageBitmap(getApplicationContext(), "my_image.jpeg")); 
```

**6.通过图片名称获取图片完整路径。**

```
File file            = getApplicationContext().getFileStreamPath("my_image.jpeg");
String imageFullPath = file.getAbsolutePath(); 
```

**7.**检查镜像文件是否存在。

文件文件 =

```
getApplicationContext().getFileStreamPath("my_image.jpeg");
if (file.exists()) Log.d("file", "my_image.jpeg exists!"); 
```

8.  删除图像文件。

    文件文件 = getApplicationContext().getFileStreamPath("my_image.jpeg"); if (file.delete()) Log.d("file", "my_image.jpeg 已删除！");

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-09-06T06:56:29.347

在 android studio 中下载图片的代码：

```
 DownloadManager downloadManager = 
         (DownloadManager)getSystemService(Context.DOWNLOAD_SERVICE);
    Uri uri = Uri.parse(url);
    DownloadManager.Request request = new DownloadManager.Request(uri);
    request.setNotificationVisibility
         (DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);
    downloadManager.enqueue(request);
    FancyToast.makeText(getApplicationContext(), "Downloaded", 
       FancyToast.LENGTH_SHORT, FancyToast.SUCCESS, false).show(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-25T13:32:11.670

这段代码在我的项目中完美运行

```
downloadImagesToSdCard(imagepath,imagepath);

private void downloadImagesToSdCard(String downloadUrl,String imageName)
        {
            try
            {
                URL url = new URL("www.xxx.com"+downloadUrl); 
                /* making a directory in sdcard */
            //  String sdCard=Environment.getExternalStorageDirectory().toString();
                ContextWrapper cw = new ContextWrapper(getActivity());
                 // path to /data/data/yourapp/app_data/imageDir
                File directory = cw.getDir("files", Context.MODE_PRIVATE);

                File myDir = new File(directory,"folder");

                /*  if specified not exist create new */
                if(!myDir.exists())
                {
                    myDir.mkdir();
                    Log.v("", "inside mkdir");
                }

                /* checks the file and if it already exist delete */
                String fname = imageName;
                File file = new File (myDir, fname);
                Log.d("file===========path", ""+file);
                if (file.exists ()) 
                    file.delete (); 

                /* Open a connection */
                URLConnection ucon = url.openConnection();
                InputStream inputStream = null;
                HttpURLConnection httpConn = (HttpURLConnection)ucon;
                httpConn.setRequestMethod("GET");
                httpConn.connect();
                inputStream = httpConn.getInputStream();
                /*if (httpConn.getResponseCode() == HttpURLConnection.HTTP_OK) 
                {
                    inputStream = httpConn.getInputStream();
                }*/

                FileOutputStream fos = new FileOutputStream(file);  
                int totalSize = httpConn.getContentLength();
                int downloadedSize = 0;   
                byte[] buffer = new byte[1024];
                int bufferLength = 0;
                while ( (bufferLength = inputStream.read(buffer)) >0 ) 
                {                 
                    fos.write(buffer, 0, bufferLength);                  
                    downloadedSize += bufferLength;                 
                    Log.i("Progress:","downloadedSize:"+downloadedSize+"totalSize:"+ totalSize) ;
                }   

                fos.close();
                Log.d("test", "Image Saved in sdcard..");  
                viewimage();
            }
            catch(IOException io)
            {                  
                io.printStackTrace();
            }
            catch(Exception e)
            {                     
                e.printStackTrace();
            }

        } 

        public void viewimage()
        {
              String path = serialnumber+".png";
               ContextWrapper cw = new ContextWrapper(getActivity());

                //path to /data/data/yourapp/app_data/dirName
                File directory = cw.getDir("files", Context.MODE_PRIVATE);

                File mypath=new File(directory,"folder/"+path);

                Bitmap b;
                try {
                    b = BitmapFactory.decodeStream(new FileInputStream(mypath));
                //  b.compress(format, quality, stream)
                    profile_image.setImageBitmap(Bitmap.createScaledBitmap(b, 120, 120, false));
                } catch (FileNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
        } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-06-14T09:39:29.810

# 试试这个

```
 try
                {
                    Bitmap bmp = null;
                    URL url = new URL("Your_URL");
                    URLConnection conn = url.openConnection();
                    bmp = BitmapFactory.decodeStream(conn.getInputStream());
                    File f = new File(Environment.getExternalStorageDirectory(),System.currentTimeMillis() + ".jpg");
                    if(f.exists())
                        f.delete();
                    f.createNewFile();
                    Bitmap bitmap = bmp;
                    ByteArrayOutputStream bos = new ByteArrayOutputStream();
                    bitmap.compress(Bitmap.CompressFormat.PNG, 0 /*ignored for PNG*/, bos);
                    byte[] bitmapdata = bos.toByteArray();
                    FileOutputStream fos = new FileOutputStream(f);
                    fos.write(bitmapdata);
                    fos.flush();
                    fos.close();
                    Log.e(TAG, "imagepath: "+f );
                }
                catch (Exception e)
                {
                    e.printStackTrace();
                } 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-28T14:28:43.667

```
public class testCrop extends AppCompatActivity {
    ImageView iv;
    String imagePath = "https://style.pk/wp-content/uploads/2015/07/omer-Shahzad-performed-umrah-600x548.jpg";
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.testcrpop);
        iv = (ImageView) findViewById(R.id.testCrop);
        imageDownload image = new imageDownload(testCrop.this, iv);
        image.execute(imagePath);
    }
    class imageDownload extends AsyncTask<String, Integer, Bitmap> {
        Context context;
        ImageView imageView;
        Bitmap bitmap;
        InputStream in = null;
        int responseCode = -1;
//constructor.
        public imageDownload(Context context, ImageView imageView) {
            this.context = context;
            this.imageView = imageView;
        }
        @Override
        protected void onPreExecute() {
        }
        @Override
        protected Bitmap doInBackground(String... params) {
            try {
                URL url = new URL(params[0]);
                HttpURLConnection httpURLConnection = (HttpURLConnection) url.openConnection();
                httpURLConnection.setDoOutput(true);
                httpURLConnection.connect();
                responseCode = httpURLConnection.getResponseCode();
                if (responseCode == HttpURLConnection.HTTP_OK) {
                    in = httpURLConnection.getInputStream();
                    bitmap = BitmapFactory.decodeStream(in);
                    in.close();
                }
            } catch (MalformedURLException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
            return bitmap;
        }
        @Override
        protected void onPostExecute(Bitmap data) {
            imageView.setImageBitmap(data);
            saveImage(data);
        }

        private void saveImage(Bitmap data) {
            File createFolder = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES),"test");
            createFolder.mkdir();
            File saveImage = new File(createFolder,"downloadimage.jpg");
            try {
                OutputStream outputStream = new FileOutputStream(saveImage);
                data.compress(Bitmap.CompressFormat.JPEG,100,outputStream);
                outputStream.flush();
                outputStream.close();
            } catch (FileNotFoundException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

**输出[![在此处输入图像描述](../Images/268ee275a0920f52c42572e7d82934f0.png)](https://i.stack.imgur.com/CWbI0.jpg)**

**确保您添加了在内存中写入数据的权限**

```
 <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-10-21T12:38:02.427

@Droidman 的帖子非常全面。Volley 适用于几 KB 的小数据。当我尝试使用“BasicImageDownloader.java”时，Android Studio 警告我 AsyncTask 类应该是静态的，否则可能存在泄漏。我在另一个测试应用程序中使用了 Volley，并且由于泄漏而一直崩溃，所以我担心使用 Volley 作为图像下载器（图像可能只有 100 kB）。

我使用了毕加索，效果很好，上面发布的内容有很小的变化（可能是毕加索的更新）。下面的代码对我有用：

```
 public static void imageDownload(Context ctx, String url){
    Picasso.get().load(yourURL)
            .into(getTarget(url));
}
private static Target getTarget(final String url){

    Target target2 = new Target() {
        @Override
        public void onBitmapLoaded(final Bitmap bitmap, Picasso.LoadedFrom from) {
            new Thread(new Runnable() {

                @Override
                public void run() {

                    File file = new File(localPath + "/"+"YourImageFile.jpg");
                    try {
                        file.createNewFile();
                        FileOutputStream ostream = new FileOutputStream(file);
                        bitmap.compress(Bitmap.CompressFormat.JPEG, 80, ostream);
                        ostream.flush();
                        ostream.close();
                    } catch (IOException e) {
                        Log.e("IOException", e.getLocalizedMessage());
                    }
                }
            }).start();
        }

        @Override
        public void onBitmapFailed(Exception e, Drawable errorDrawable) {
        }

        @Override
        public void onPrepareLoad(Drawable placeHolderDrawable) {
        }
    };
    return target;
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2015-08-07T15:51:40.443

正如谷歌所说，现在，不要忘记在清单中添加也可读的外部存储：

```
 <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" /> 
```

来源：http: [//developer.android.com/training/basics/data-storage/files.html#GetWritePermission](http://developer.android.com/training/basics/data-storage/files.html#GetWritePermission)

# ms-access - 当文本框控件源使用表中的多值字段时，Access 报表打印多页

> ID：15549424
> 
> 赞同：0
> 
> 时间：2013-03-21T13:50:57.933
> 
> 标签：ms-access

我的 Access 2010 报告有一个文本框，它使用表中的多值字段作为其控制源。我知道表中的多值字段很糟糕，但我现在必须使用它。

我遇到的问题是，即使当我物理打印它或进行打印预览时它只有两页报告，我也得到超过 2 页。因此，如果多值字段具有 (2) 个值，我将获得 (4) 个页面，其中包含基本相同的信息 (2) 个副本。

如何防止报告打印每个值的副本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:01:38.967

好的，既然我已经找到了解决方法，我将回答我自己的问题。

我找到了一种解决方法，可以让我只打印我想要的页面（即前两页或一个副本而不是几页）

在我的宏中，而不是使用仅打印报告的 RunMenuCommand PrintObject。

我创建了一个 vba 函数

```
 Function cmdPrint()
        DoCmd.PrintOut acPages, 1, 2   //acPages, start_page, end_page
    End Function 
```

并使用 RunCode cmdPrint() 从宏中使用此功能

现在我只得到一份而不是几份。就像我说的那样，它是一种解决方法，但它对我有用，我希望有一天它会帮助其他人解决同样的问题。

# python - 如何使用 Python 的 doctest-package 测试字典相等性？

> ID：15549429
> 
> 赞同：45
> 
> 时间：2013-03-21T13:51:16.767
> 
> 标签：python, dictionary, doctest

我正在为输出字典的函数编写文档测试。doctest 看起来像

```
>>> my_function()
{'this': 'is', 'a': 'dictionary'} 
```

当我运行它时，它失败了

```
Expected:
    {'this': 'is', 'a': 'dictionary'}
Got:
    {'a': 'dictionary', 'this': 'is'} 
```

关于这次失败的原因，我最好的猜测是 doctest 不是检查字典的相等性，而是`__repr__`相等性。[这篇文章](http://mail.python.org/pipermail/python-dev/2010-March/098177.html)表明有一些方法可以欺骗 doctest 检查字典是否相等。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-01-20T06:37:57.757

另一个好方法是使用`pprint`（在标准库中）。

```
>>> import pprint
>>> pprint.pprint({"second": 1, "first": 0})
{'first': 0, 'second': 1} 
```

根据其源代码，它正在为您排序字典：

[http://hg.python.org/cpython/file/2.7/Lib/pprint.py#l158](http://hg.python.org/cpython/file/2.7/Lib/pprint.py#l158)

```
items = _sorted(object.items()) 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-03-21T14:04:09.800

Doctest 本身不检查`__repr__`相等性，它只是检查输出是否完全相同。您必须确保打印的任何内容对于同一个字典都是相同的。你可以用这个单线做到这一点：

```
>>> sorted(my_function().items())
[('a', 'dictionary'), ('this', 'is')] 
```

尽管您的解决方案的这种变化可能更清晰：

```
>>> my_function() == {'this': 'is', 'a': 'dictionary'}
True 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-03-21T14:01:32.817

我最终使用了这个。哈克，但它的工作原理。

```
>>> p = my_function()
>>> {'this': 'is', 'a': 'dictionary'} == p
True 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-21T13:58:35.163

通过 dict.items() 将其转换为列表，然后对其进行排序...

```
>>> l = my_function().items()
>>> l.sort()
>>> l
[('a', 'dictionary'), ('this', 'is')] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-04T12:37:03.187

大部分已经在这里说了..无论如何 JSYK：doctest 文档中有一个专门的部分：

[https://docs.python.org/3.5/library/doctest.html#warnings](https://docs.python.org/3.5/library/doctest.html#warnings)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-10T01:46:29.083

`unittest.TestCase`您可以在 doctests中创建一个类的实例，并使用它来比较字典：

```
def my_function(x):
    """
    >>> from unittest import TestCase
    >>> t = TestCase()

    >>> t.assertDictEqual(
    ...     my_function('a'),
    ...     {'this': 'is', 'a': 'dictionary'}
    ... )

    >>> t.assertDictEqual(
    ...     my_function('b'),
    ...     {'this': 'is', 'b': 'dictionary'}
    ... )

    """
    return {'this': 'is', x: 'dictionary'} 
```

注意：这种方法比简单地检查字典是否相等要好，因为它会显示两个字典之间的差异。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-11-10T18:52:05.173

我发现在测试任意嵌套数据时在我的文档测试中使用[deepdiff](https://github.com/seperman/deepdiff)包很有用。例如：

```
def something_complicated():
    """
    >>> from deepdiff import DeepDiff
    >>> DeepDiff(something_complicated(),
    ...          {'expected': {'output': ['a', 'b', 'c']}},
    ...          ignore_order=True)
    {}
    """
    items = ['a', 'b', 'c']
    random.shuffle(items)
    return {'expected': {'output': items}} 
```

# c# - 在网格视图中计算和显示下载

> ID：15549431
> 
> 赞同：0
> 
> 时间：2013-03-21T13:51:20.940
> 
> 标签：c#, asp.net, gridview, hyperlink

我有一个带有超链接的网格视图。有没有办法计算这个超链接的点击次数？它计算一个文档被下载了多少次。

这是我目前所拥有的......

```
<Columns>
            <asp:BoundField DataField="Id" HeaderText="Id" InsertVisible="False" 
                ReadOnly="True" SortExpression="Id" />

            <asp:hyperlinkfield headertext="Download File " datatextfield="FileName" datanavigateurlfields="FileName" datanavigateurlformatstring="~/Files/{0}" />

            <asp:BoundField DataField="Username" HeaderText="Username" 
                SortExpression="Username" />
            <asp:BoundField DataField="Date" HeaderText="Date" SortExpression="Date" />
            <asp:BoundField DataField="College" HeaderText="College" 
                SortExpression="College" />
            <asp:BoundField DataField="Year" HeaderText="Year" SortExpression="Year" />
            <asp:BoundField DataField="Major" HeaderText="Major" SortExpression="Major" />
            <asp:BoundField DataField="Subject" HeaderText="Subject" 
                SortExpression="Subject" />
            <asp:BoundField DataField="Downloads" HeaderText="Downloads" 
                SortExpression="Downloads" />
        </Columns> 
```

# playorm - PlayORM 中的基本分区

> ID：15549432
> 
> 赞同：0
> 
> 时间：2013-03-21T13:51:34.230
> 
> 标签：playorm

假设我在 cassandra 中有一个具有以下模式的 CF：

*   时间戳
*   设备编号
*   设备名称
*   设备所有者

PKEY (TimeStamp, Device ID)：这意味着分区正在发生在时间戳上。

以下是我感兴趣的查询：

Select * from schema where TimeStamp='..' Select * from schema where DeviceID='..'

第一个查询返回 500K 记录，第二个查询返回 50K 记录。对于第一个查询，瓶颈都是在单个节点上获取，所以我想将数据分布在多个节点上以获得时间戳。第二次查询的瓶颈是所有记录可能分布在不同节点的磁盘上，导致多次磁盘获取。

现在假设我想创建虚拟分区，这样特定时间戳的条目也分布在集群节点上。这在 PlayORM 中可行吗？如果是，您能否提供可以这样做的代码（或这样做的示例）？

我的另一个要求是搜索特定设备 ID 的所有记录。我可以对同一个 CF 的“设备 ID”进行虚拟分区吗？如果是，您能否提供代码/链接来说明如何操作？

如果有人能提供做这样的事情的源代码，我会很高兴，因为文档不是那么容易理解，而且仅仅通过阅读当前文档来编写代码就是一场噩梦。如果没有“完整”的代码示例，评估 PlayORM 似乎是不可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T15:27:26.593

是的，您在 PlayOrm 中需要这样的东西......（如果我遗漏任何内容，请发表评论，我可以再次回复）。

[https://github.com/deanhiller/playorm/blob/master/src/test/java/com/alvazan/test/db/PartitionedTrade.java](https://github.com/deanhiller/playorm/blob/master/src/test/java/com/alvazan/test/db/PartitionedTrade.java)

还有查询 PARTITIONS t('account', :partId) SELECT t FROM TABLE as t INNER JOIN t.security as s WHERE s.securityType = :type and t.numShares = :shares"

'account' 标识分区列， :partId 是分区的 id。在您的情况下，您将有 PARTITIONS t('deviceid', {actualDeviceId}) 或 t('time', {time}) 其中第一个参数是列名，第二个是分区的实际 id 时间或设备分区的 ID。实现分区的行数不应超过 X 百万行，其中 X 可能约为 300 万行。

com.alvazan.test.db 包有大量不同的示例，com.alvazan.test 显示了它们的使用方式。我将要求某人根据您的反馈调整文档，以将链接直接链接到我们代码库中的代码......

附言。如果您从 github 下载，运行 gradlew eclipse 或 gradle eclipse（取决于操作系统），然后导入到 eclipse 中，所有测试都可以使用内存中的 noSQL 版本进行开箱即用（我们将其用于开发）。然后，如果您想针对 cassandra 运行，则在文档中它有如何更改一行并且所有测试都针对 cassandra 运行。

加速。PlayOrm 使用复合名称模式为每个分区（每个分区的索引）执行宽行。当您查询时，它以 200 个批次（或您提供的大小）读取这一行，然后使用索引中找到的键向所有机器发送请求（即此时您获得并行吞吐量）。这是因为每个分区都分布在集群中。事实上，所有节点最终都会得到几乎所有分区的切片，具体取决于您拥有多少节点和多少分区（即 100 个节点和 32 个分区，并非所有节点都具有所有分区）。

在幕后，playorm 正在做一些非常非常简单的事情。所有行都被写入，就好像它们根本没有分区一样！！！然后写入索引行（RF=3 表示到 3 个节点），索引行名称为 /TABLE/partition/column/partitionId。那是索引的行键。使用命令行工具，您甚至可以自己读取索引，只读取索引或查询分区。为此，请使用 playOrm 的命令行工具。

最后，由于 cassandra 中的宽行是有序的，因此当您使用特定索引（例如 PARTITIONS d('deviceid', 'device1') select d from TABLE as d where d.time > Integer.MIN_INT

然后结果按该索引的顺序返回（即在这种情况下为时间），或者如果您想要相反的顺序，只需调用 cursor.afterLast 然后 cursor.previous、cursor.previous 等等等。

需要明确的是，PlayOrm 在这里故意忽略了 cassandra 分区。它写入您的数据，就像根本没有分区一样。它还写入一个或两个索引。假设您分区两次，一次按时间，一次按设备 ID。在这种情况下，它使用行键（并说您的实体称为设备）写入 StringIndice 或 IntegerIndice 表（BigInteger !!!不是 Integer）。假设在您的实体中，您在“名称”列上有 @NoSqlIndexed！！！！

```
/Devices/byDevice/device1/name = the wide row
/Devices/byTime/time56/name = the wide row 
```

如果您有更多 @NoSqlIndexed 列，则索引表中有更多行。然而，所有行都分布在集群中，并且不关心分区。

这有意义吗？随意尝试一下。如果您对实现它有任何问题/疑问，只需在 stackoverflow 上发布一个新问题。

# mobile - 棘轮有什么用

> ID：15549437
> 
> 赞同：2
> 
> 时间：2013-03-21T13:51:37.140
> 
> 标签：mobile

我遇到了[http://maker.github.com/ratchet](http://maker.github.com/ratchet)

正如我所见，这是用于原型设计，而不是用于移动设备的实际生产前端。

抱歉这个愚蠢的问题，但棘轮是用于生产网站还是只是为了假装拥有移动应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T09:08:10.730

为什么它只用于原型设计？在很多情况下，您都需要一个在生产中模仿原生应用的 Web 应用程序，而从未计划构建原生版本。

对于初学者来说，当您可以使用 html/javascript 而不是 Objective C 时，生产时间要短得多，您可以在任何平台上开发，跳过 App Store 批准的麻烦，并且非时间关键型应用程序的大多数功能都可以作为 Web 应用程序使用。如果您以后决定使用“真正的应用程序”，您可以将您的网络应用程序包装在 Phonegap 中并通过应用程序商店发布。

# regex - 使用 RegEx 解析 SQL 文件名中的日期时间戳

> ID：15549439
> 
> 赞同：3
> 
> 时间：2013-03-21T13:51:47.357
> 
> 标签：regex, bash, parsing

我正在构建一个用于备份数据库的 bash 脚本。我已经设置了一个 cron 作业来每天运行这个脚本，并且我已经可以根据以下格式转储 .sql 文件：

```
YYYYMMDD_HHMMSS-databasename.sql 
```

考虑到时间戳格式的名称，我想构建另一个 bash 脚本来解析`YYMMDD`文件名部分并选择上周的所有每日文件。这个新的 bash 脚本将每周运行一次。

如何使用正则表达式将这些数字解析为日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:56:31.357

这是一个完整的解决方案，请尝试这样做：

没有*正则表达式*但*偏移量削减*（假设您的示例是所有文件的相同格式，就像脚本在运行时所做的那样`crontab`）：

```
cd /path/to/dumps
str='20130321_145907-databasename.sql'
for i in {7..14}; do
    curfile=$(date -d ${str:0:8} -d "$i days ago" '+%Y%m%d')*
    if [[ -s $curfile ]]; then
        # do something with "$curfile"
    fi
done 
```

如果你真的需要一个**正则表达式**：

```
cd /path/to/dumps
str='20130321_145907-databasename.sql'
if [[ $str =~ ^([0-9]{8})_[0-9]{6} ]]; then
    for i in {7..14}; do
        curfile=$(date -d ${BASH_REMATCH[1]} -d "$i days ago" '+%Y%m%d')*
        if [[ -s $curfile ]]; then
            # do something with "$curfile"
        fi
    done
fi 
```

## 笔记

*   注意最后`*`一行`curfile=`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:29:11.463

使用 RegEx 从文件名中选择日期部分：

```
^(20[12]\d)(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])_\d+-\w+\.sql$ 
```

在这里解释正则表达式：[http ://regex101.com/r/iU7wL5](http://regex101.com/r/iU7wL5)

***使用正确的时间验证***更新**：**

 **```
^(20[12]\d)(0[1-9]|1[012])(0[1-9]|[12]\d|3[01])_([01]\d|2[0-3])[0-5]\d[0-5]\d-\w+\.sql$ 
```

解释演示：[http ://regex101.com/r/yV1dD7](http://regex101.com/r/yV1dD7)

注意：这适用于 2010-2029 范围内的日期，并将文件名验证为您的输出格式

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T14:00:08.870

使用 bash 3+：

```
$ file=20130321_foo.log
$ [[ $file =~ ^[0-9]{8} ]]
$ echo ${BASH_REMATCH[0]}
20130321
$ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T14:09:48.263

那这个呢？

```
LAST_WEEK_BEG=$(date --date="-7 days" +%Y%m%d)
LAST_WEEK_END=$(date --date="-14 days" +%Y%m%d)

if [ $YOUR_DATE -ge "$LAST_WEEK_BEG" ] && [ $YOUR_DATE -le "$LAST_WEEK_END" ]; then
   do things
fi 
```**

# sammy.js - Sammy.js 无法在 Internet Explorer 中获取位置

> ID：15549440
> 
> 赞同：2
> 
> 时间：2013-03-21T13:51:51.107
> 
> 标签：sammy.js

执行以下操作时是否有一些解释：

```
location.hash = "#/"; 
```

它在 Firefox (19.0.2) 中运行良好，但在 IE (10.0.92) 中运行良好。

在 Firefox 中它返回到“主页”，而在 IE 中它什么也不做。也没有显示错误。

此代码来自此函数：

```
self.addStoreItem = function () {
            var data = appFsMvc.utility.serializeObject( $("#StoreItemForm") );
            $.ajax({
                url: "/api/StoreItems",
                data: JSON.stringify( data ),
                type: "POST",
                dataType: "json",
                contentType: "application/json"
            })
            .done(function () {
                toastr.success( "You have successfully created a new StoreItem!", "Success!" );
                self.StoreItems.push(data);
                location.hash = "#/";
            })
            .fail(function () {
                toastr.error( "There was an error creating your new StoreItem", "<sad face>" );
            });
        }; 
```

以及管理 sammy.js 的代码：

```
appFsMvc.App = function( StoreItemsViewModel ) {
        return $.sammy( "#content", function () {
            var self = this;

            this.use( Sammy.Cache );
            this.StoreItemViewModel = StoreItemsViewModel;

            this.renderTemplate = function ( html ) {
                self.$element().html( html );
                ko.applyBindings( self.StoreItemViewModel );
            };

            // display all StoreItems
            this.get( "#/", function() {
                this.render("/Templates/StoreItemDetail.htm", {}, function ( html ) {
                    self.renderTemplate( html );
                });
            });

            // display the create StoreItems view
            this.get( "#/create", function() {
                this.render("/Templates/StoreItemCreate.htm", {}, function ( html ) {
                    self.renderTemplate( html );
                });
            });
        });
    }; 
```

我曾尝试使用 firbuglite，但是当我尝试在我的网站上使用它时，后者最终会崩溃。IE 的开发者工具不显示任何错误。

[编辑]

找到了如何使用[getfirebug.com/firebuglite#Debug](https://code.google.com/p/fbug/issues/detail?id=4927)而不是稳定版本来启用 firebuglite：

控制台给了我这些提示：

*   单击 CreateNewItem 时

> [2013 年 3 月 21 日星期四 15:38:11 UTC+0100] #content runRoute get /#/create
> 
> GET /Templates/StoreItemCreate.htm 200 OK 5ms
> 
> POST /api/StoreItems 200 OK 7ms

而在 Firefox 中做同样的事情给了我：

> [2013 年 3 月 21 日星期四 15:40:41 GMT+0100] #content runRoute get /#/create
> 
> GET [http://myLocalHost:9501/Templates/StoreItemCreate.htm](http://myLocalHost:9501/Templates/StoreItemCreate.htm) 200 OK 1ms
> 
> POST [http://myLocalHost:9501/api/StoreItems](http://myLocalHost:9501/api/StoreItems) 200 OK 27ms
> 
> [2013 年 3 月 21 日星期四 15:40:46 GMT+0100] #content runRoute get /#/

我可以在 IE 中看到地址栏中的 url在发布我的表单后给出正确的 url [http://localhost:9501/#/create](http://localhost:9501/#/create)然后[http://localhost:9501/#/ 。](http://localhost:9501/#/)[/编辑]

# jquery - Jquery 手风琴在 IE 9 中不起作用？

> ID：15549447
> 
> 赞同：0
> 
> 时间：2013-03-21T13:52:05.250
> 
> 标签：jquery, accordion

为什么这在 IE 9 中不起作用？ [jsfiddle](http://jsfiddle.net/BPmHW/) 它拒绝点击打开，它在除IE9之外的所有浏览器上都能正常工作>我似乎无法弄清楚为什么！任何帮助都非常受欢迎。

```
/* Accordions */
$(".acc_item").click(function(){

    $(this).siblings().children(".accordion_content").not($(this).find(".accordion_content")).slideUp(600,'easeInOutExpo');
    $(this).siblings().children(".accordion").not($(this).find(".accordion")).removeClass("active_acc");

    $(this).find(".accordion").next(".accordion_content").slideToggle(600,'easeInOutExpo');

    if($(this).find(".accordion").hasClass('active_acc')){
        $(this).find(".accordion").removeClass("active_acc");
    }else{
        $(this).find(".accordion").addClass("active_acc");
    }
});

// Open First item if accordion whenever set so
setTimeout(function(){$(".acc_is_open").delay(1500).click();},600); 
/* Accordions::END */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:14:54.633

试试这个：[演示](http://jsfiddle.net/BPmHW/3/)

```
$(".acc_item").click(function () {
    $(this).siblings().children(".accordion_content").slideUp(600, 'easeInOutExpo');
    $(this).siblings().children(".accordion").removeClass("active_acc");

    $(this).find(".accordion_content").slideToggle(600, 'easeInOutExpo');

    if ($(this).find(".accordion").hasClass('active_acc')) {
        $(this).find(".accordion").removeClass("active_acc");
    } else {
        $(this).find(".accordion").addClass("active_acc");
    }
});

setTimeout(function () {
    $(".acc_is_open").delay(1500).click();
}, 600); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:08:27.907

尝试：

```
$(this).find(".accordion_content").slideToggle(600,'easeInOutExpo'); 
```

另请注意，我已经包含了缓动插件。

[在这里](http://jsfiddle.net/BPmHW/2/)提琴

# c# - ASP.Net MVC4 捆绑包，用于在调试设置为 false 时不呈现较少文件

> ID：15549455
> 
> 赞同：12
> 
> 时间：2013-03-21T13:52:22.273
> 
> 标签：c#, asp.net-mvc-4, less, bundle, minify

在一个简单的 ASP.Net MVC4 测试应用程序中，我安装了无点 NuGet 包并[按照本教程](http://www.asp.net/mvc/tutorials/mvc-4/bundling-and-minification)进行操作。

我的`.less`文件被正确解析为 CSS 并且在`debug=true`.

```
<link href="/Public/less/main.less" rel="stylesheet"/>
<link href="/Public/less/home.less" rel="stylesheet"/>
<link href="/Public/less/a.less" rel="stylesheet"/>
<link href="/Public/less/b.less" rel="stylesheet"/>
<link href="/Public/less/c.less" rel="stylesheet"/> 
```

但是，当我设置`debug=false`它以使其缩小并合并为单个样式表时，我得到了这个：

```
<link href="/Public/less?v=" rel="stylesheet"/> // NOT WORKING! 
```

这是我的捆绑配置文件；再次，直接取自教程：

```
public class BundleConfig
{
    // For more information on Bundling, visit http://go.microsoft.com/fwlink/?LinkId=254725
    public static void RegisterBundles(BundleCollection bundles)
    {

        // Compile .less files and create a bundle for them.
        var lessBundle = new Bundle("~/Public/less").Include(
                                                        "~/Public/less/main.less",
                                                        "~/Public/less/home.less",
                                                        "~/Public/less/a.less",
                                                        "~/Public/less/b.less",
                                                        "~/Public/less/c.less");
        lessBundle.Transforms.Add(new LessTransform());
        lessBundle.Transforms.Add(new CssMinify());
        bundles.Add(lessBundle);
    }
} 
```

在我的布局文件中：

```
<head>
    @Styles.Render("~/Public/less")
</head> 
```

这是我的 LessTransform 类：

```
public class LessTransform : IBundleTransform
{
    public void Process(BundleContext context, BundleResponse response)
    {
        response.Content = dotless.Core.Less.Parse(response.Content);
        response.ContentType = "text/css";
    }
} 
```

* * *

关于为什么捆绑包无法正常工作的任何想法`debug=false`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-29T12:55:50.057

默认情况下，MVC 4.0 中的捆绑和缩小在调试模式下是禁用的，因为缩小和捆绑使调试变得非常困难，甚至有时是不可能的。`LessTransform.Process`您可以通过在方法上设置断点来测试它。仅在项目使用or`LessTransform.Process`运行时调用。`debug = false``BundleTable.EnableOptimizations = true`

`<link href="/Public/less?v=" rel="stylesheet"/>`意味着捆绑的结果是空的。

请确保至少有一个 less 文件生成 CSS 内容，如果是，请检查`LessTransform`它必须是的类：

```
public class LessTransform : IBundleTransform
{
    void IBundleTransform.Process(BundleContext context, BundleResponse response)
    {
        response.Content = Less.Parse(response.Content);
        response.ContentType = "text/css";
    }
} 
```

通过放入`BundleTable.EnableOptimizations = true;`RegisterBundles 方法，您可以在调试模式下覆盖优化机制（捆绑和缩小）的默认设置，然后您可以调试并检查结果`Less.Parse(response.Content);`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-30T23:25:51.663

`.less`该问题是编译into时出现的静默错误`css`。

* * *

我使用断点检查`LessTransform`使用`dotless`库编译的类。

```
public class LessTransform : IBundleTransform
{
    public void Process(BundleContext context, BundleResponse response)
    {
        response.Content = Less.Parse(response.Content); // Breakpoint here.
        response.ContentType = "text/css";
    }
} 
```

我注意到当悬停在`response.Content`我可以看到我的`less`代码时，但在`Less.Parse`代码之后，`response.Content`会变成空的。

我`less`通过检查器运行了我的代码，并注意到我的代码中有语法错误。

修复错误后，捆绑和缩小按预期正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-25T00:31:47.920

除非我误解了你所说的没有意义。

当你有`debug = true`它看起来你的样式表没有被捆绑，因为它们被单独引用，因此没有被缩小/捆绑到一个文件中，当 debug 设置为 true 时这是预期的，这样你就可以轻松地调试你的脚本/样式而无需不得不涉足缩小和捆绑的代码。

当您拥有`debug = false`它时，会出现缩小/捆绑，因为您只获得两个网址。

看起来很奇怪的一件事是，较少的 url 没有与之关联的哈希，即。v= 是空白的，这可能需要研究。

您也可以尝试`<localaddress>/Public/less?v=`在浏览器中加载 url，如果它在缩小/捆绑时遇到问题，它通常会在文件顶部给您一个警告，看看它会返回什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T08:34:06.083

看起来你有更少的空文件。所以没有生成哈希是正常的。

只是让你知道。您不需要使用 bundle 来获取更少的文件。您可以使用 import 关键字 insinde less 来组合文件。@import "a.less";

# java - 读取多行文本文件到数据库

> ID：15549466
> 
> 赞同：0
> 
> 时间：2013-03-21T13:52:56.977
> 
> 标签：java, database, swing

我有一个如下所示的文本文件：

人 1 姓名
人 1 年龄
人 1 地址

Person2 姓名
Person2 年龄
Person2 地址

Person3 姓名
Person2 年龄
Person3 地址

我需要将信息获取到数据库。

我有数据库连接，并且知道一旦将行放入正确的变量中，如何将信息输入数据库。. . 但是我如何让java识别每一行并将信息设置为一个变量。

基本上我需要获取文本文件信息并添加到以下变量

$姓名
$年龄
$地址

我想过使用数组，但由于我混合了字符串和数字，我不能使用字符串数组。

由于我每行使用 Line，因此没有分隔符。

**更新信息**

我使用姓名、年龄和地址作为示例变量，并且得到了一些有效的答案，但我仍然无法让它完全有效，所以我应该发布整个代码。. .

我也愿意进行代码清理（我真的是 Java 新手）

给出的答案让我有点工作，除了读者用空格分隔变量并且在名称和地址这样的情况下都有空格，空格分隔符没有给我我需要的结果。

这是文本文件的内容：

> Ray Wade
> 200
> 美国艾滋病儿童基金会
> 
> 汤
> 姆哈迪 125.50
> 美国红十字会

如您所见，我调用 LoadTextFile(); 在 CreateTables() 函数中

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.text.*;
import java.sql.*;
import javax.sql.*;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableColumn;

public class Charity extends JFrame  
{

JButton btnCalc = new JButton("Donate"), btnLoad = new JButton("Load File"), btnExit = new JButton("Exit");
JLabel name, amount, intro = new JLabel("Would You Like to Donate to a Charity Today? It Only Takes a Few Moments"), message1 = new JLabel(""), message2 = new JLabel("");
JTextField textName, textAmount;

// Create String Array to list charities in the combobox
String[] charities = { "Choose a Charity or Enter a New Charity", 
"American Foundation for Children with AIDS", 
"American Red Cross", 
"Breast Cancer Research Foundation", 
"Livestrong *Formerly Lance Armstrong Foundation*", 
"Michael J. Fox Foundation for Parkinson's Research" };

JComboBox charityList = new JComboBox(charities);

String file ="Charity.txt";

// Variables used later
double dAmount;
String Charity = null;
int debug = 0; // change to 1 to turn debug mode on

// Variables initialized for Database Stuff
Object[][] databaseInfo;    
Object[] columns = {"name", "charity", "amount"};
Connection conn = null;
ResultSet rows;

String driver = "com.mysql.jdbc.Driver";
String url = "jdbc:mysql://localhost:3306/";
String DBname = "charity";
String DBusername = "root";
String DBpass = "password";

// Variables and Class for TableModel
DefaultTableModel dTableModel = new DefaultTableModel(databaseInfo, columns){
    public Class getColumnClass(int column) {
        Class returnValue;

        // Verifying that the column exists (index > 0 && index < number of columns            
        if ((column >= 0) && (column < getColumnCount())) {
          returnValue = getValueAt(0, column).getClass();
        } else {

          // Returns the class for the item in the column                   
          returnValue = Object.class;
        }
        return returnValue;
      }
    };  

/**
    Sets the title, size and layout of the JFrame.<!-- -->Also calls the methods to setup the panels.
*/
public Charity() 
{
    super("Donations to Charities"); // Title of frame
    setLayout(new FlowLayout()); // Declare layout of frame
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // Default close
    Dimension dim = Toolkit.getDefaultToolkit().getScreenSize(); // Get screen size
    this.setResizable( false ); // turn off frame resize        
    this.setSize(600, dim.height-100); // set size of frame

    CreatePanels();
    GetAction(); // Call ActionListeners
    CreateDatabase(); 
}

public void CreatePanels()
{
    SetupCharityGroup(); // Call method to setup charity list panel
    SetupDataPanel(); // Call method to setup data collection panel
    SetupDisplayTable();        
    setVisible(true); // Make frame visible
}

/**
    Method to setup the display panel containing a JTable that will show the information read from the database.
*/
private void SetupDisplayTable()
{               
    JTable table = new JTable(dTableModel); // Create a JTable using the custom DefaultTableModel
    table.setFont(new Font("Serif", Font.PLAIN, 16));  // Increase the font size for the cells in the table
    table.setRowHeight(table.getRowHeight()+5); // Increase the size of the cells to allow for bigger fonts 
    table.setAutoCreateRowSorter(true); // Allows the user to sort the data    

    // right justify amount column
    TableColumn tc = table.getColumn("amount");
    RightTableCellRenderer rightRenderer = new RightTableCellRenderer();
    tc.setCellRenderer(rightRenderer);      

    table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF); // Disable auto resizing

    // Set the width for the columns        
    TableColumn col1 = table.getColumnModel().getColumn(0);
    col1.setPreferredWidth(200);

    TableColumn col2 = table.getColumnModel().getColumn(1);
    col2.setPreferredWidth(275);

    TableColumn col3 = table.getColumnModel().getColumn(2);
    col3.setPreferredWidth(75);     

    // Put the table in a scrollpane and add scrollpane to the frame          
    JScrollPane scrollPane = new JScrollPane(table);
    scrollPane.setPreferredSize(new Dimension(552, 400));
    this.add(scrollPane, BorderLayout.CENTER);
}

/**
    Method to setup the data panel containing textFields, Labels, and buttons.
*/
private void SetupDataPanel()
{
    JPanel pan = new JPanel();
    GridLayout grid = new GridLayout(0, 1, 5, 5);
    pan.setLayout(grid);

    // Setup TextFields and Labels for name of person donating
    // and add them to the panel
    name = new JLabel("Name");
    textName = new JTextField("", 16);
    textName.setHorizontalAlignment(JTextField.RIGHT);
    pan.add(name); 
    pan.add(textName);

    // Setup TextFields and Labels for amount being donated
    // and add them to the panel
    amount = new JLabel("Donation Amount");
    textAmount = new JTextField("", 4);
    textAmount.setHorizontalAlignment(JTextField.RIGHT);
    pan.add(amount);
    pan.add(textAmount);

    // add buttons and message labels to panel
    pan.add(intro);
    pan.add(btnCalc);
    pan.add(btnLoad);
    pan.add(btnExit);
    pan.add(message1);
    pan.add(message2);
    this.add(pan);
}

/**
    Method to setup the charity panel with a border containing an editable combobox filled with a list of charities.
*/
private void SetupCharityGroup()
{
    JPanel Boxpan=new JPanel();
    Boxpan.setBorder(BorderFactory.createTitledBorder(
    BorderFactory.createEtchedBorder(), "Charities"));
    this.add(Boxpan);
    charityList.setEditable(true);
    Boxpan.add(charityList);
}

/**
    Add ActionHandlers to interactive elements.
*/
private void GetAction()
{
    ActionHandler handler = new ActionHandler();
    btnLoad.addActionListener(handler);
    btnCalc.addActionListener(handler);
    btnExit.addActionListener(handler);
    charityList.addActionListener( handler ); 
}

/**
    Method to make ActionHandlers into ActionListeners.
*/
private class ActionHandler implements ActionListener
{       
    public void actionPerformed(ActionEvent evt) 
    {
        String incmd = evt.getActionCommand();
        if (incmd.equals("Donate")) // If Donate button is pressed
            if (textName.getText().isEmpty())
            {
                message1.setText("<html><font color='red'>Invalid Donation</font>");
                message2.setText("<html><font color='red'>Error: Name of Donor missing!<font>");
            } else  
            CheckDonate();
        else if (incmd.equals("Load File")) // If Load File button is pressed
            DatabaseLoad();
        else if (incmd.equals("Exit")) // If Exit button is pressed
            System.exit(0);  
    }
}

/**
    Method to check if charity is selected in the combobox.<!-- -->If a charity is selected, call CharitySelected method, otherwise send error message to Frame.
*/
private void CheckCharity()
{
    Object selectedCharity = charityList.getSelectedItem();
    if (charityList.getSelectedIndex() == 0) // if charity is not selected
    {
        message1.setText("<html><font color='red'>Invalid Donation</font>");
        message2.setText("<html><font color='red'>Error: No Charity Selected!<font>");
    } else CharityIsSelected();
}

/**
    If charity is selected, set the selected value to "Charity" variable and call method to thank donator.
*/
private void CharityIsSelected()
{
    Object selectedCharity = charityList.getSelectedItem();
    Charity = selectedCharity.toString(); // selectedCharity Object converted to String
    ThankYou();
}

/**
    Thank the donator and call the databseAdd method.
*/
private void ThankYou()
{
    message1.setText("Thank You! "+textName.getText());
    message2.setText(" $"+textAmount.getText()+" Will be donated to "+Charity);
    DatabaseAdd();      
}

/**
    Method that will check that donation amount is a number in a range between 1 and 1000000000.
*/
private void CheckDonate()
{ try 
    {
        dAmount = Double.parseDouble(textAmount.getText());
        if(dAmount <= 0.0 || dAmount > 1000000000 ) 
        {
            message1.setText("<html><font color='red'>Invalid Donation</font>");
            message2.setText("<html><font color='red'>Amount invalid</font>");
        } else CheckCharity();
    } catch (NumberFormatException ex) {
        // Executes if the data entered is not a number
        if (debug == 1)
        {
            message1.setText("Error: "+ex.getMessage());
            message2.setText("");
        } else 
        {
            message1.setText("<html><font color='red'>Invalid Donation</font>");
            message2.setText("<html><font color='red'>Amount Not Recognized</font>");
        }
    }
}

public void DBConnection()
{ try 
    {
        // The driver allows you to query the database with Java
        // forName dynamically loads the class for you           
        Class.forName(driver);

        // DriverManager is used to handle a set of JDBC drivers
        // getConnection establishes a connection to the database
        // You must also pass the userid and password for the database            
        conn = DriverManager.getConnection (url, DBusername, DBpass);

    } catch (SQLException ex) {            
        // debug:  
        if (debug == 1)
        {
            message1.setText("Error: "+ex.getMessage());
            message2.setText("Error: "+ex.getErrorCode());
        } else
            message1.setText("Database Error: contact admin");              
            message2.setText("");
    } catch (ClassNotFoundException ex) {
        // Executes if the driver can't be found
        // debug:  
        if (debug == 1)
        {
            message1.setText("Error: "+ex.getMessage());
            message2.setText("");
        } else
            message1.setText("Driver Error: contact admin");
            message2.setText("");
    }
}

/**
    Method to add the entered information to the database.<!-- -->Once the information is added to the database, clear the form fields.
*/
private void DatabaseAdd()
{ try 
    {
        url = url+DBname;

        DBConnection();

        // Statement objects executes a SQL query
        // createStatement returns a Statement object
        Statement s = conn.createStatement();

        // Prepare the query and values to be inserted into the database 
        String str="INSERT INTO donations(name,charity,amount) VALUES (?,?,?)";

        java.sql.PreparedStatement statement = conn.prepareStatement(str); 

        statement.setString(1,textName.getText());
        statement.setString(2,Charity);
        statement.setDouble(3,dAmount);
        statement.executeUpdate();  

        // Reset form after saved to database
        textName.setText(""); 
        textAmount.setText("");
        charityList.setSelectedIndex(0);
        s.close();
        DatabaseLoad(); // Call the Database Info

    } catch (SQLException ex) {            
        // debug:  
        if (debug == 1)
        {
            message1.setText("Error: "+ex.getMessage());
            message2.setText("Error: "+ex.getErrorCode());
        } else
            message1.setText("Database Error: contact admin");
            message2.setText("");
    }
}

/**
    Method will load the database information and display it in Frame in a JTable. 
*/
private void DatabaseLoad()
{ try 
    {
        url = url+DBname;

        DBConnection();

        // Statement objects executes a SQL query
        // createStatement returns a Statement object            
        Statement s = conn.createStatement();

        // This is the query I'm sending to the database
        String selectStuff = "SELECT `name`, `charity`, `amount` FROM `"+DBname+"`.`donations` ";                   

        // A ResultSet contains a table of data representing the
        // results of the query. It can not be changed and can 
        // only be read in one direction            
        rows = s.executeQuery(selectStuff);

        // Set the table RowCount to 0
        dTableModel.setRowCount(0);

        // Temporarily holds the row results            
        Object[] tempRow;

        // next is used to iterate through the results of a query            
        while(rows.next())
        {               
            // Gets the column values based on class type expected
            tempRow = new Object[]{rows.getString(1), rows.getString(2), rows.getDouble(3) };

            dTableModel.addRow(tempRow);  // Adds the row of data to the end of the model
        }
        // Successfully loaded, message the user
        message1.setText("<html><font color='red'>Database Info Loaded</font>");
        message2.setText("");
        s.close();

    } catch (SQLException ex) {            
        // debug:  
        if (debug == 1)
        {
            message1.setText("Error: "+ex.getMessage());
            message2.setText("Error: "+ex.getErrorCode());
        } else
            message1.setText("Database Error: contact admin");
            message2.setText("");
    }        
}   

/**
    Method will create the database if it does not exist.
*/
private void CreateDatabase()
{ try
    {

        DBConnection();

        // Statement objects executes a SQL query
        // createStatement returns a Statement object            
        Statement s = conn.createStatement();

        String dbCreate = "CREATE DATABASE "+DBname;

        s.executeUpdate(dbCreate);
        s.close();

    } catch(SQLException ex){
        // debug: 
        if (debug == 1)
        {
            message1.setText("Error: "+ex.getMessage());
            message2.setText("Error: "+ex.getErrorCode());
        }
    } catch(Exception ex){
        // debug:           
        if (debug == 1)
        {
            message1.setText("Error: "+ex.getMessage());
            message2.setText("");
        }
    } 
        CreateTables();
}

/**
    Method will create the table needed in the database.
*/
private void CreateTables()
{ try
    {

        DBConnection();

        // Statement objects executes a SQL query
        // createStatement returns a Statement object            
        Statement s = conn.createStatement();

        String tableCreate = "create table "+DBname+".donations " + "(`name` varchar(200), " + "`charity` varchar(200), " + "amount double)";

        s.executeUpdate(tableCreate);

        // After creating the tables
        // Load the information from the textfile
        LoadTextFile();

        s.close();

    } catch(SQLException ex){
        // debug:  
        if (debug == 1)
        {
            message1.setText("Error: "+ex.getMessage());
            message2.setText("Error: "+ex.getErrorCode());
        }
    } catch(Exception ex){
        // debug: 
        if (debug == 1)
        {
            message1.setText("Error: "+ex.getMessage());
            message2.setText("");
        }
    }
}

public void LoadTextFile()
{

}

// To change justification to the right
class RightTableCellRenderer extends DefaultTableCellRenderer {   
      public RightTableCellRenderer() {  
        setHorizontalAlignment(JLabel.RIGHT);  
    }           
}       

// Main method calls the constructor
public static void main(String[] args) 
{
    new Charity();
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:55:31.277

使用 BufferedReader 一次读取一行，从该行中提取所需的信息并将其分配给变量。如果您想将它保存在内存中，请使用具有这 3 个属性的 POJO。

您可以使用正则表达式拆分行并获取所需的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:05:58.770

我写了一组做类似事情的函数。我像其他用户建议的那样使用 bufferedReader。

```
public ArrayList<String> readFileToMemory(String filepath)
{
    BufferedReader br = null;
    String currentLine = null;
    ArrayList<String> fileContents = new ArrayList<String>();

    try
    {
        br = new BufferedReader(new FileReader(filepath));
        while((currentLine = br.readLine()) != null)
        {
            //fileContents.add(br.readLine());
            fileContents.add(currentLine);
        }

    }
    catch(IOException e)
    {
        e.printStackTrace();
    }
    finally
    {
        try
        {
            br.close();
        }
        catch(IOException e)
        {
            e.printStackTrace();
        }
    }

    return fileContents;
} 
```

这只会将文件的每一行作为列表中的单独条目读取。只需输入条目并做您需要的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:24:13.800

以下代码片段将解决您的问题。

```
public class Test {
 public static void main( String[] args ) throws Exception
    {
        HashMap<String, Person> personMap = new HashMap<String, Person>();
        try
        {
            BufferedReader in = new BufferedReader( new FileReader( "File Path" ) );
            String str;
            Person person = new Person();
            int count = 0;
            String key = "";
            while( ( str = in.readLine() ) != null )
            {

                if ( null != str && str.trim().length() == 0 )
                {
                    personMap.put( key, person );
                    count = -1;
                    person = new Person();
                }
                else {
                    String arr[] = str.split( " " );
                    key = arr[0];
                    if (count == 0) {
                        person.setName( arr[1] );
                    }
                    else if (count == 1) {
                        person.setAge(  arr[1] );
                    }
                    else if (count == 2) {
                        person.setAddress(  arr[1] );
                    }
                }
                count ++;
            }
            personMap.put( key, person );
            in.close();
        }
        catch( IOException e )
        {
            System.out.println( "Exception" + e.getMessage() );
        }
    }
}

public class Person
{
    private String name    = null;

    private String age     = null;

    private String Address = null;

    public String getName()
    {
        return name;
    }

    public void setName( String name )
    {
        this.name = name;
    }

    public String getAge()
    {
        return age;
    }

    public void setAge( String age )
    {
        this.age = age;
    }

    public String getAddress()
    {
        return Address;
    }

    public void setAddress( String address )
    {
        Address = address;
    }

} 
```

我希望它有帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T17:49:55.667

如果您只这样做一次，只需在记事本 ++ 中进行 3 次替换

将 \r\n\r\n 替换为“|||” 将 \r\n 替换为 "," 替换 ||| 与 \r\n

那么你就有了一个常规的 .csv 文件。

# c++ - 在 cpp 中，我是否必须始终“释放”原始变量？

> ID：15549467
> 
> 赞同：3
> 
> 时间：2013-03-21T13:52:58.037
> 
> 标签：c++

如果我有一个`function`声明一个的`int`，最后`function`我需要“释放”它`int`以节省内存？

例子：

```
void doSomething() {
    int x = 0;
    // do something with x
    free(x); // needed?
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-21T13:57:07.207

这是给你的内存管理诫命

*   你只能***释放***你已经*malloc'ed*或*calloc'ed的东西*
**   你应该只***删除***你*更新的内容**   你应该只***删除[]***你有*新的[]'ed**   尽可能使用**RAII***

 ** * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T13:54:10.803

不，它是一个自动变量，这意味着它会在超出范围时被释放。

此外，您很少`free()`在 C++ 中使用，它是一个 C 函数。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-10-08T07:32:07.370

正如其他人所提到的，不，您不需要专门释放内存，因为变量在函数末尾超出范围。

然而，稍微不同的是，我在寻找一种快速、干净地释放原始变量内存的方法时遇到了这个页面，后来发现了一种令人难以置信的方法来做到这一点，我没有意识到这是 C++ 的一部分。对于其他也在寻找这个答案的人，这里就是。

实际上，您可以只使用额外的大括号集来设置 C++ 中变量的特定范围，因此在没有函数结尾的情况下释放此函数中“x”内存的一种方法就是将“x”的范围用大括号像这样：

```
void doSomething() {
    // do something in the start of the function
    {

        int x = 0;
        // do something with x

    } // x is destroyed here

    // do something that doesn't require x
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T13:54:11.780

否。`int`对象具有自动存储期限。它在其作用域结束时被销毁，即函数结束时。

无论如何，您不应该`free`在 C++ 中使用。它仅在您用于`malloc`分配内存时使用，但`malloc`在 C++ 中不常用。相反，您应该使用`new`动态分配对象。当您创建了一个具有动态存储持续时间的对象时`new`，使用`delete`来销毁它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-21T13:54:19.233

# 不

`x`是一个堆栈变量，返回时会自动删除`doSomething()`。

只有那些手动分配的对象`malloc()`必须是`free()`d （在 C++ 中非常少见）。也不要在 C++ 中使用 and - 使用`free()`and代替。`malloc()``new``delete`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-21T13:54:44.850

不，如果您使用动态分配内存，您只需要释放内存`new`。在这种情况下，此变量在堆栈中，并在函数结束时被销毁。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-21T13:55:03.463

您只需要释放已在代码中为其分配内存的变量。在您的示例`x`中是在本地声明的，并且程序在堆栈上为其分配内存。在函数结束时，变量被自动销毁。所以你不必担心它。*

# django - 如何在 Python 中使用 Json

> ID：15549473
> 
> 赞同：-1
> 
> 时间：2013-03-21T13:53:21.870
> 
> 标签：django, json, python-2.7

我如何将这段代码重做为 Json

```
def getStatusData(self):
    return eval(self.__statusdata)

def setStatusData(self, statusdata):
    self.__statusdata = str(statusdata)

statusdata = property(getStatusData, setStatusData) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:07:00.240

```
import json

_data = {'someData': [1,2,3,4,5]}

jsoneddata = json.dumps(_data)
print jsoneddata
>>'{"someData": [1, 2, 3, 4, 5]}'

json.loads(jsoneddata)
>> {u'someData': [1, 2, 3, 4, 5]} 
```

[官方 Python 文档在这里](http://docs.python.org/2/library/json.html)

但是，`getter`python`setter`中不鼓励使用函数。这么简单：

```
self.__statusdata = json.dumps(statusdata)
statusdata = json.loads(self.__statusdata) 
```

对于您的示例，`eval`这是一种非常危险的使用方式，除非您真的知道它会导致什么以及您在做什么。[更多关于 eval](http://docs.python.org/2/library/functions.html#eval)函数。[一些关于评估安全风险](http://en.wikipedia.org/wiki/Eval#Security_risks)的维基

# regex - 为 10 个字母数字数字设计正则表达式

> ID：15549474
> 
> 赞同：-4
> 
> 时间：2013-03-21T13:53:31.880
> 
> 标签：regex

我想要一个在 ASP.NET 中使用它的正则表达式。它应该是 10 个字母数字数字。前 5 个字符是字母，接下来的 4 个数字和最后一个字符是字母。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T13:55:00.740

这应该够了吧

```
^[a-zA-Z]{5}[0-9]{4}[a-zA-Z]$ 
```

# android - Android AudioRecord 读取方法：它可以读取比已记录更多的数据吗？

> ID：15549480
> 
> 赞同：1
> 
> 时间：2013-03-21T13:53:46.270
> 
> 标签：android, audiorecord

我在使用 android AudioRecord 类时遇到了很多问题。我一直对 AudioRecord 中的 read 方法如何工作感到困惑，希望有人能回答...

考虑这种情况；

1.  我创建了一个新的 AudioRecord 对象，其 sampleRateInHz 值为 44100hz
2.  然后我调用 startRecording() 方法，设备开始录制来自麦克风的输入。
3.  正好 500 毫秒（或 22050 个样本）之后，我调用 read 方法并尝试将 44100 个样本读入一个长度为 44100 的新数组。

由于 AudioRecord 对象只记录了 500 毫秒（或 22050 个样本），而我试图读取最后的 44100 个样本，会发生什么？我可能的想法是；

*   read 方法会休眠 500ms，直到有足够的数据可用，然后读取所有 44100 个记录的样本，或者
*   read 方法将读取 AudioRecord 缓冲区（在 AudioRecord 对象内）中的内容，无论已记录了多少数据。因此，在这种情况下，前 22050 个样本将包含从麦克风记录的数据，随后的 22050 个样本将包含零，因为读取函数正在访问尚未写入的缓冲区区域。

我一直在不知疲倦地尝试用我的 android 设备对此进行测试，但这确实不是一件容易测试的事情。回答需要比我更大的头脑...任何帮助表示赞赏...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-20T10:34:39.550

我也发现这不清楚，因为 Android 文档并没有真正说明。但是，关于 SO 有几个答案，人们确认您的两个选项中的**第一个**是正确的 - 该方法会阻塞，直到有足够的数据可用。 [查看此问题的第二个答案以获得相当详细的解释](https://stackoverflow.com/questions/4569421/problem-of-read-method-in-audiorecord-class)。

# php - 尝试使用 html 表单和 php 更新 mysql

> ID：15549481
> 
> 赞同：3
> 
> 时间：2013-03-21T13:53:48.550
> 
> 标签：php, html, mysql, sql-update

...这通常不会太难，但由于某种原因，我无法让它工作。我可能遗漏了某些东西或打错了字，我不知道，但无论是什么，我都找不到。

```
include('connect-db.php');

mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

$query = "SELECT * FROM articles ORDER BY orderid";
$result = mysql_query($query) or die(mysql_error());

$count = mysql_num_rows($result);
?>
<div class="content-holder">
    <form action="" method="post">
        <table border='1' cellpadding='10' id='ViewTable'>
            <tr>
            <th>Volgorde</th>
            <th>Titel</th>
            </tr>
            <?php
            while($row = mysql_fetch_array($result))
            {
                $orderid = $row['orderid'];
                $title = $row['title'];
            ?>
            <tr>
                <td><input type="textbox" class="TextAreaTitle" name="order" value="<?=$orderid?>"></td>
                <td><?=$title?></td>
            </tr>
            <?php
            }
            ?>
        </table>
        <input type="submit" name="submit" class="submitlink" Value="Verzenden">
    </form>
</div>

<?php
if(isset($_POST['submit']))
{
    mysql_query("UPDATE articles SET orderid=$orderid  WHERE title=$title");
    echo "Updated!";
}
?> 
```

我只是将整个代码粘贴到这里来确定。在网页上，您基本上会看到一个带有列 orderid 和标题的表格，以及它们各自的所有行。orderid 可以更改，因为它们是一个文本框。我想要实现的是一个（或多个）orderid 被更改，然后您单击按钮，然后我希望 orderid 在我的数据库中相应更改。

在此先感谢您的帮助。有任何问题请提出。

编辑：我完全忘了提及这一点，但是当我点击按钮时会发生什么，它会返回“更新！”的回声。但数据库实际上并没有更新。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:15:24.960

```
mysql_query("UPDATE articles SET orderid=$orderid  WHERE title=$title"); 
```

这需要引用`<input>`表单中的字段，如下所示：

```
$orderid = $_POST['order'];
$title = $_POST['title'];
mysql_query("UPDATE articles SET orderid=$orderid  WHERE title=$title"); 
```

您永远不会`title`从表单中返回值。您的表单中需要一个`<input name="title" />`，所以添加它。否则，它将始终使用您的 while 循环中的最后一个值。

如果您从 $_POST 读取，则需要添加输入验证。否则你很容易受到攻击。

编辑：我修改了一下。

```
include('connect-db.php');

mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

$query = "SELECT * FROM articles ORDER BY orderid";
$result = mysql_query($query) or die(mysql_error());

$count = mysql_num_rows($result);
?>
<div class="content-holder">
    <form action="" method="post">
        <table border='1' cellpadding='10' id='ViewTable'>
            <tr>
            <th>Volgorde</th>
            <th>Titel</th>
            </tr>
            <?php
            while($row = mysql_fetch_array($result))
            {
                $orderid = $row['orderid'];
                $title = $row['title'];
            ?>
            <tr>
                <td><input type="textbox" class="TextAreaTitle" name="order[]" value="<?=$orderid?>"><input type="hidden" name="title[]" value="<?=$title?>"></td>
                <td><?=$title?></td>
            </tr>
            <?php
            }
            ?>
        </table>
        <input type="submit" name="submit" class="submitlink" Value="Verzenden">
    </form>
</div>

<?php
if(isset($_POST['submit']))
{
    for ($i=count($_POST['title']); $i--;) {
        $orderid = $_POST['order'][$i];
        $title = $_POST['title'][$i];
        mysql_query("UPDATE articles SET orderid=$orderid  WHERE title=$title");
    }
    echo "Updated!";
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-24T07:17:53.243

如果使用`name="order[]"` 它将返回数组，并且您必须使用 foreach 将数组转换为字符串

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-21T14:02:05.160

有时它会产生这些类型的错误。它在插入数据或从数据库中检索时有不同的语法，所以应该尝试所有解决方案

mysql_query("更新文章 SET orderid='".$orderid ."' WHERE title='".$title ."'"); echo "更新了！";

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-21T14:05:33.677

我希望它可见

mysql_query("更新文章 SET orderid='".$orderid."' WHERE title='".$title."'"); echo "更新了！";

# c# - 隐藏/显示 MdiChilds

> ID：15549483
> 
> 赞同：0
> 
> 时间：2013-03-21T13:53:51.640
> 
> 标签：c#, show, mdichild

我有一个 mdi 应用程序。我在父级上有一些链接，当单击时打开一个新的子表单并隐藏已经打开的表单 如何检查孩子是否已经打开？

```
A little scenario:  
link 1 -> opens Child of type A  
link 2 -> opens Child of type B  
link 3 -> open Child of type C  

Application start:  
click on link 1-> check if a child of type A is opened 

 - yes -> hides the current opened child and shows the A-type Child
 - no: -> hides the current opened child and creates a new A-type child and shows it  

click on link 2 -> check if a child of type B is opened  

 - yes -> hides the current opened child and shows the B-type Child  
 - no: -> hides the current opened child and creates a new A-type child and shows it

etc.. 
```

你能帮我一些代码吗？
谢谢...

**更新：**
像这样的东西？

```
 foreach (Form aForm in this.MdiChildren)
            {
                aForm.Hide();
            }
        foreach (Form f in this.MdiChildren)
        {
            if (f.Name == "VizualizareArticol")
                f.Show();
            else
            {
                VizualizareArticol vv = new VizualizareArticol();
                vv.MdiParent = this;
                vv.StartPosition = FormStartPosition.Manual;
                vv.Location = new Point(0, 0);

                vv.Show();
            }
        } 
```

但不起作用...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:18:55.533

检查 Control.Visible。如果 Item 是可见的，你可以 .Hide 它，如果它不是 Visible 。否则，请查看您创建的对象。

如果您已经创建了一个表单并隐藏了它，它就会变得不可见。因此，您可以检查 .Visible 并显示表单。

```
if(null != aForm  && !aForm.Visible){
    aForm.Show() 
    aForm.BringToFront();
}else if(null == aForm){
    // create the form
}
// otherwise form is existing & visible 
```

# ms-access - 从 LotusScript 写入 MS Access 中的日期/时间数据字段的 SQL 查询语法是什么？

> ID：15549490
> 
> 赞同：2
> 
> 时间：2013-03-21T13:54:07.130
> 
> 标签：ms-access, lotus-notes, ms-access-2010, lotus-domino, lotusscript

我有一个 LotusScript (8.5.3) 例程，它使用 ODBC 将 Notes 数据从视图 (8.5.3) 写入 Microsoft Access 2010 数据库。我正在使用类似于下面的 SQL 语句来写入数据。我遇到的问题是将 Notes 日期/时间值获取到 Access 2010 日期/时间值的语法。

> strSQL=|INSERT INTO DATASHEET("DocumentNumber","RevisionNumber","RevisionDate") VALUES('| >+ docnum + |','| + docrevnum + |',{d'| + revdate.DateOnly + |'} |

当我执行此操作时，我收到以下错误：

> [Microsoft][ODBC Microsoft Access Driver] 查询 > 表达式 'd '06/23/2010'}' 中的语法错误（缺少运算符）

我确定我的语法是错误的，但我尝试了多种我在网上找到的引用的语法，但似乎没有一个有效。

真正知道语法应该是什么并且有工作的代码的人可以给我正确的语法。

更新：我尝试了以下语法：

> strSQL=|INSERT INTO DATASHEET("DocumentNumber","RevisionNumber","RevisionDate") VALUES('| >+ docnum + |','| + docrevnum + |',#| + revdate.DateOnly + |#|

当我执行此操作时，我收到以下错误：

> [Microsoft][ODBC Microsoft Access Driver] 查询表达式“#”中的日期语法错误。

谢谢，

乔丹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T16:28:18.263

HansUp 的评论就是答案。以下是语法的最终结果：

我第一次运行它时遇到的问题是它遇到了一个 NULL 日期，所以它不知道如何处理它。因此，我对以下更改感到疯狂：

> If revdate.DateOnly="" then rdate="01/01/1900" 'This is Access' 等价于 null date else rdate=revdate.DateOnly end if
> 
> strSQL=|INSERT INTO DATASHEET("DocumentNumber","RevisionNumber","RevisionDate") VALUES('| >+ docnum + |','| + rdate + |',#| + revdate.DateOnly + |#|

谢谢您的帮助。

乔丹

# asp.net-mvc - 如果参数为 kendo ui 网格创建操作的“模型”命名，则模型绑定到操作始终为空

> ID：15549495
> 
> 赞同：2
> 
> 时间：2013-03-21T13:54:15.430
> 
> 标签：asp.net-mvc, kendo-ui

我有一个动作，请求是从剑道 ui 网格的 Create 事件生成的。信息均已正确发布，并且模型绑定器在任何情况下都可以正常工作，其中操作参数名称为“模型”

如果动作是这样定义的：

```
[HttpPost]
public ActionResult Create(ModelType post)
{                                                                                                    
} 
```

一切正常。

如果相反，则操作如下所示：

```
[HttpPost]
public ActionResult Create(ModelType model) //changed parameter Name to model
{                                                                                                    
} 
```

我得到一个无效的模型状态和这条消息：

> System.Web.Mvc.ModelError
> 
> 从类型 'System.String' 到类型 'MyApp.Common.Models.ModelType' 的参数转换失败，因为没有类型转换器可以在这些类型之间进行转换。”

这似乎只影响来自 Kendo UI 网格的动作，无论动作参数的名称如何，正常的 MVC 动作帖子都能正常工作。

我能够使用小型测试模型创建一个新项目并重新创建此行为。

任何人都可以对这里发生的事情有所了解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T09:08:53.823

当前的“ModelType”很可能包含名称为“Model”的属性，并且默认 MVC ModelBinder 尝试将“Model”属性绑定到模型变量。您应该将变量名称从动作参数更改为当前模型中不包含的变量名称。

# gcc - 如果不支持内联 asm()，我缺少什么包？

> ID：15549503
> 
> 赞同：3
> 
> 时间：2013-03-21T13:54:31.880
> 
> 标签：gcc, libtool

我正在尝试编译 PHP xhprof 扩展。在一台服务器`make`上成功，在另一台服务器上失败并显示“不支持内联 asm()”。相关代码是

```
asm volatile("rdtsc" : "=a" (__a), "=d" (__d)); 
```

两台服务器都运行具有相似配置的 Debian。

**问题：**我缺少什么包或者我应该在服务器之间比较哪个包版本以启用内联 asm？

供参考 make 输出

```
/bin/sh /usr/local/src/xhprof/extension/libtool --mode=compile cc  -I. -I/usr/local/src/xhprof/extension -DPHP_ATOM_INC -I/usr/local/src/xhprof/extension/include -I/usr/local/src/xhprof/extension/main -I/usr/local/src/xhprof/extension -I/usr/include/php5 -I/usr/include/php5/main -I/usr/include/php5/TSRM -I/usr/include/php5/Zend -I/usr/include/php5/ext -I/usr/include/php5/ext/date/lib  -DHAVE_CONFIG_H  -g   -c /usr/local/src/xhprof/extension/xhprof.c -o xhprof.lo
libtool: compile:  cc -I. -I/usr/local/src/xhprof/extension -DPHP_ATOM_INC -I/usr/local/src/xhprof/extension/include -I/usr/local/src/xhprof/extension/main -I/usr/local/src/xhprof/extension -I/usr/include/php5 -I/usr/include/php5/main -I/usr/include/php5/TSRM -I/usr/include/php5/Zend -I/usr/include/php5/ext -I/usr/include/php5/ext/date/lib -DHAVE_CONFIG_H -g -c /usr/local/src/xhprof/extension/xhprof.c  -DPIC -o .libs/xhprof.o
/usr/local/src/xhprof/extension/xhprof.c:1224: inline asm() not supported
/usr/local/src/xhprof/extension/libtool: line 1111: 23098 Segmentation fault      cc -I. -I/usr/local/src/xhprof/extension -DPHP_ATOM_INC -I/usr/local/src/xhprof/extension/include -I/usr/local/src/xhprof/extension/main -I/usr/local/src/xhprof/extension -I/usr/include/php5 -I/usr/include/php5/main -I/usr/include/php5/TSRM -I/usr/include/php5/Zend -I/usr/include/php5/ext -I/usr/include/php5/ext/date/lib -DHAVE_CONFIG_H -g -c    /usr/local/src/xhprof/extension/xhprof.c -DPIC -o .libs/xhprof.o
make: *** [xhprof.lo] Error 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T16:22:19.530

显然`cc`在这台机器上不是链接到其他一些不理解 gcc 的扩展 asm 语法的`gcc`编译器（ ）。`tcc`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:07:09.913

难道是错误消息的意思是“不支持汇编代码本身”，而不是`asm()`编译器功能不支持？换句话说，您正在为一些没有`rdtsc`指令的（半古代）处理器构建？

不过，错误之后的段错误有点可怕。

# ruby - 防止或删除 textscraper 中的重复项？

> ID：15549504
> 
> 赞同：0
> 
> 时间：2013-03-21T13:54:34.873
> 
> 标签：ruby, search, duplicates, scraper

我有一个代码可以解析文件夹中的文本文件，并在某些搜索词周围保存预定义数量的词。

例如，它会查找诸如“日期”和“年份”之类的词。如果它在同一个句子中找到两者，它将保存该句子两次。此外，如果它发现一个句子中使用了几次同一个词，它也会多次保存它。

这样，刮刀可以节省大量不必要的重复文本。

我看到两种可能的解决方案：

1.  如果下一个搜索匹配在前一个单词组的填充中，则不会被保存。
2.  如果一组，比如说，搜索匹配的七个单词也是前一组的一部分，它将不会被保存/删除。

到目前为止，我尝试过的一切都完全失败了：

```
#helper
def indices text, index, word
    padding = 200
    bottom_i = index - padding < 0 ? 0 : index - padding
    top_i = index + word.length + padding > text.length ? text.length : index +         word.length + padding
    return bottom_i, top_i
end

#script
base_text = File.open("base.txt", 'w')
Dir::mkdir("summaries") unless File.exists?("summaries")
Dir.chdir("summaries")

Dir.glob("*.txt").each do |textfile|
    whole_file = File.open(textfile, 'r').read
    puts "Currently summarizing " + textfile + "..."
    curr_i = 0
    str = nil
    whole_file.scan(Regexp.union(/firstword/, /secondword/).each do |match|
      if i_match = whole_file.index(match, curr_i)
        top_bottom = indices(whole_file, i_match, match)
        base_text.puts(whole_file[top_bottom[0]..top_bottom[1]] + " : " +         File.path(textfile))
        curr_i += i_match                     
      end
    end
    puts "Done summarizing " + textfile + "."
end
base_text.close 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:13:06.550

最好是比：

```
whole_file.scan(Regexp.union(/firstword/, /secondword/).each do |match|
  if i_match = whole_file.index(match, curr_i)
    top_bottom = indices(whole_file, i_match, match)
    base_text.puts(whole_file[top_bottom[0]..top_bottom[1]] + " : " +         File.path(textfile))
    curr_i += i_match + 50                     
  end        
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:25:05.757

为什么不做一些事情来跟踪你正在寻找的东西：

```
search_words = %w( year date etc ) 
```

然后将搜索字符串小写，并启动索引。

```
def summarize(str)
  search_str = str.downcase
  ind = 0 
```

然后在 search_str 中找到您的搜索词的最小索引偏移量，并删除所有直到 (ind + offset - delta) 的内容，直到 (ind + delta) 进入匹配项，并在 while 循环中继续。就像是：

```
 matches = []
  while (offset = search_words.map{|w| search_str.index w }.min)
    ind += offset
    matches.push str[ind - delta, delta * 2]
    search_str = search_str[offset + delta, ]
  end
  matches
end 
```

# jquery - 根据单选按钮点击显示其他输入？

> ID：15549512
> 
> 赞同：0
> 
> 时间：2013-03-21T13:54:50.067
> 
> 标签：jquery, jquery-ui

我有多个单选输入，当我单击特定单选输入（具有特定 id）时，我希望显示输入按钮，当我单击任何其他单选按钮时，输入消失

```
 var radio = $("#radio7");
if($('#os_others').is(':hidden'))
{
    radio.click(function(){

        $('#os_others').slideDown();

    });

}
else
{
    $('#os_others').css("display", "none");
} 
```

我怎样才能做到这一点？

# 编辑 ：

这是演示 [http://jsfiddle.net/DgsM7/](http://jsfiddle.net/DgsM7/)

当我点击其他...输入向下滑动，但我想要的是，当我点击其他单选按钮时，输入框向上滑动

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:59:48.980

试试这个：

```
$("#os_others").hide();

$("input[type='radio']").click(function() {
    //alert($("#radio7").is(":checked"));
    if ($("#radio7").is(":checked")) {
        $("#os_others").show();
    }
    else {
        $("#os_others").hide();
    }
}); 
```

更新了你的小提琴：http: [//jsfiddle.net/DgsM7/3/](http://jsfiddle.net/DgsM7/3/)

# git - Git 撤消对文件的部分更改

> ID：15549514
> 
> 赞同：11
> 
> 时间：2013-03-21T13:54:51.733
> 
> 标签：git, merge, undo

如何撤消一段时间内应用到文件的部分更改。我有以下提交，`A`并且`B`在“file.txt”之间发生了意外更改

```
...--A--B--... 
```

我有一个文件的差异补丁，`file.txt-B-A.patch`其中恢复**了所有**更改。但是我只想撤消中的**某些更改**，`file.txt`就像在合并冲突中手动选择更改一样。有没有办法在不修改补丁文件的情况下做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-21T14:02:28.430

许多 git 命令可以`-p`选择（“patch”）或`-i`（“interactive”）部分地做某事。对于任意差异，我不认为这是受支持的，但是您可以应用补丁，然后使用 选择性地撤消未暂存的更改`git checkout -p -- <path(s)>`，例如，`git checkout -p -- .`如果您处于 repo 的顶层。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-21T15:33:59.523

还有另一种完全不需要补丁文件的方法。

问题发生在从`A`到`B`，所以首先恢复更改`B`但不要自动提交。

```
$ git revert --no-commit <commit hash of B> 
```

将要进行的更改`git revert`是分阶段进行的。取消舞台。

```
$ git reset HEAD 
```

接下来，以交互方式浏览`file.txt`并仅暂存您想要保留的更改。

```
$ git add --patch file.txt 
```

现在只暂存您选择的还原。提交他们。

```
$ git commit 
```

最后，清理`git revert`.

```
$ git reset --hard 
```

# ruby-on-rails - 无效的关联。确保 accept_nested_attributes_for 用于 :photos 关联

> ID：15549515
> 
> 赞同：2
> 
> 时间：2013-03-21T13:54:52.013
> 
> 标签：ruby-on-rails, paperclip, nested-forms

我正在为模型实现多张照片上传，所以我使用回形针和nested_form gem

A Property 有很多照片。

这是属性模型。

```
class Property < ActiveRecord::Base
  attr_accessible :photos_attributes, :type, :price, :address, :desc, :category_id, :location_id, :user_id
  TYPE = {
    rent: "rent",
    sale: "sale"
  }

  has_many :photos, dependent: :destroy
  belongs_to :category
  belongs_to :location
  belongs_to :user
  accepts_nested_attributes_for :photos, reject_if: lambda { |t| t[:photo].nil? }, allow_destroy: true
  acts_as_taggable
end 
```

这是照片模型

```
class Photo < ActiveRecord::Base
  attr_accessible :property_id
  belongs_to :property, dependent: :destroy

  has_attached_file :photo, styles: {small: "100x100>", medium: "300x300>"},
                    url: "/assets/products/:id/:style/:basename.:extension",
                    path: ":rails_root/public/assets/photos/:id/:style/:basename.:extension"

  validates_attachment_size :photo, less_than: 5.megabytes
  validates_attachment_content_type :photo, content_type: ["image/jpeg", "image/png", "image/x-png", "image/pjpeg"]
end 
```

我的看法是

```
= nested_form_for @property, html: {multipart: true} do |f|
  = f.fields_for :photos do |photos_f|
     = photos_f.label :photo
     .file-field-wrap
       .file-field
         = photos_f.file_field :photo
         = photos_f.link_to_remove "Remove"
        = photos_f.link_to_add "Add", :photos  # this line gives error 
```

错误是 `Invalid association. Make sure that accepts_nested_attributes_for is used for :photos association.`

当我`Property.new.attributes.keys`在控制台上运行时，它不会显示`:photos_attributes`为键。表明`["id", "type", "price", "address", "desc", "created_at", "updated_at", "category_id", "location_id", "user_id"]`

我被困住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T16:41:44.830

尝试更改导致以下错误的行：

```
= f.link_to_add "Add", :photos 
```

# c++ - C++11 标准中是否有全新的序列化和反射库？

> ID：15549517
> 
> 赞同：6
> 
> 时间：2013-03-21T13:55:00.017
> 
> 标签：c++, serialization, reflection, c++11

最近，对于 C++11 标准库中的东西，boost 序列化也不是不可能的。同时，我的项目需要一个序列化和反射库。我四处寻找并没有找到任何东西。

因此，我想知道是否有现有的（嗯......它必须是全新的才能兼容 C++11，而不是老化的 MFC）或任何关于制作我自己的基本、实用和明确的指导。据我所知，基本原理是使用 STANDARD 中的那些助手推断类型`<type_traits>`，这已经在没有 std 命名空间的 boost 序列化中采用。

这对你来说可能就像从鸡蛋中挑选卵石一样微不足道，但我就是不能让自己对 boost 感到满意。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-08-23T06:21:46.977

要真正回答这个问题，虽然有点晚了：现在有[谷物](http://uscilab.github.io/cereal/index.html)，这显然正是你所要求的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T05:08:05.357

好吧，如果你想要一个完整的序列化解决方案，也许你可以尝试[ROOT 反射](http://root.cern.ch/drupal/category/package-context/reflection)。但这不是一个轻量级的图书馆。另一方面，它是一个完整的解决方案。

# ajax - asp.net mvc 4控制器并行执行多个ajax调用

> ID：15549519
> 
> 赞同：11
> 
> 时间：2013-03-21T13:55:01.653
> 
> 标签：ajax, asp.net-mvc-4, controller

我有一个 asp.net MVC 4 控制器，它的方法是通过 ajax 调用的。

问题是 ajax 请求是由控制器按顺序处理的。这会导致性能问题，因为加载页面的时间是所有 ajax 请求的总和，而不是最长的 ajax 请求。

为了证明这一点，我在第一个（“ReadOverview8Week”）方法中设置了一个断点。这些方法中的每一个都需要大约 600 毫秒来执行个性化。

![](../Images/08097b3c3d40460a0777f47087bcd264.png)

如何让控制器并行响应所有三个请求？我正在使用 iis 8。

这是 ajax 请求（来自 kendo ui dataSource）

```
.DataSource(dataSource => dataSource.Ajax()
   .Read(read => read.Action("ReadAllSitesOverview", "AbuseCase").Type(HttpVerbs.Get)) 
```

谢谢。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-21T14:04:38.797

您面临的问题是由 ASP.NET 管理会话的方式引起的。这是[ASP.NET 会话状态概述](http://msdn.microsoft.com/en-us/library/ms178581.aspx)（*并发请求和会话状态*部分）中最重要的部分：

> 每个会话对 ASP.NET 会话状态的访问是独占的，这意味着如果两个不同的用户发出并发请求，则同时授予对每个单独会话的访问权限。但是，如果对同一个会话发出两个并发请求（通过使用相同的 SessionID 值），则第一个请求将获得对会话信息的独占访问权。第二个请求仅在第一个请求完成后执行。

如果您的操作不需要访问会话，则可以解决您的问题。如果是这种情况，您可以使用[SessionStateAttribute](http://msdn.microsoft.com/en-us/library/system.web.mvc.sessionstateattribute%28v=vs.98%29.aspx)属性装饰控制器：

```
[SessionState(SessionStateBehavior.Disabled)] 
```

这样控制器就不必等待会话。

如果您的操作只需要对会话的读取权限，您可以尝试使用该`SessionStateBehavior.ReadOnly`值。这不会导致独占锁，但请求仍需等待读写请求设置的锁。

# maven - maven 发布执行失败

> ID：15549524
> 
> 赞同：7
> 
> 时间：2013-03-21T13:55:11.920
> 
> 标签：maven, release, failed-installation

今天在发布我们的项目时，由于我们的关系出现间歇性问题，因此 release:perform 命令在两者之间失败。release 命令只能上传一个 pom 文件到 nexus。

现在，nexus 问题已解决，我正在尝试发布，它失败了，因为 pom 文件已经存在，它不是快照版本，我们无权访问 nexus，因此我可以删除该文件并重新开始.

有什么方法可以传递一个参数，以便 release:perform 应该继续，如果文件已经存在并忽略它，但继续上传其余部分。

我一直在寻找这种类型的选项，但没有找到任何东西。

我的最后一个资源是再次开始发布，这将增加版本号，但想了解是否有任何其他方法不需要增加版本。

我正在使用 Maven 2.2.1

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T14:31:12.433

以下是我过去的处理方式。该`release:perform`命令会从您的 SCM 提供商（例如 SVN）检查标签。这是在该`target/checkout`项目的目录中完成的 - 无论有什么都应该有已发布标签的精确副本，因此它在 pom 文件等中将具有正确的版本号。

如果你移动到那个目录（`target/checkout`在你开始发布的目录中），你可以简单地在`mvn deploy`那里做一个它应该编译和打包那个版本，然后把它上传到你的 Nexus 实例。

如果您没有该目录，您可以将作为阶段一部分创建的标签从您的 SCM 系统`target/checkout`检出到一个新目录并在那里运行。`release:prepare``mvn deploy`

由于您的 SCM 中的标签已经创建，唯一剩下的就是编译、打包和部署发布，这正是`mvn deploy`应该做的。

如果您在调用 期间为构建提供了其他参数（例如，用于激活配置文件），则在`mvn release:perform`运行时也必须提供这些参数`mvn deploy`。

使用这种方法，您的版本号不必更改，它可以保持不变，因为您只是上传已经标记为`mvn release:prepare`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:36:41.900

我的建议是让您向管理员请求删除旧的工件。您可以通过签出并简单地从标签中重新部署代码

```
mvn deploy 
```

或回滚您的版本：

```
mvn release:rollback 
```

并像往常一样重新做。

如果大小不匹配，则必须从远程存储库中删除旧工件。发布存储库不允许重新部署工件，除非这已在服务器端显式打开。

此外，@nwinkler 的回答也很好。

# php - 使用 PHP 检索多于一行的数据

> ID：15549532
> 
> 赞同：0
> 
> 时间：2013-03-21T13:55:27.287
> 
> 标签：php, mysql, arrays, row

我正在尝试创建一个运行查询的函数，该查询返回位于我的 MySQL 数据库中的所有数据。

我当前的代码只返回一行数据（有 7 行）

```
function staff_get() {
    $this->load->database();
    $sql = 'SELECT * from Staff';
    $query = $this->db->query($sql);
    $data = $query->row();
    $this->response($data, 200);
} 
```

我想这与“$data = $query->row();”行有关 但是我尝试用“array”切换“row”，但这不起作用。该文本被设计为以纯文本形式出现，以便我可以使用 jQuery 模板对其进行操作。

提前谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:04:45.637

您需要将结果包含在 while 循环中。与此类似的东西。

```
function staff_get() {
    $this->load->database();
    $sql = 'SELECT * from Staff';
    $query = $this->db->query($sql);
    while($data = $query->row()) {
        $this->response($data, 200);
    }
} 
```

# ios - distanceFromLocation 方法是如何工作的？

> ID：15549534
> 
> 赞同：2
> 
> 时间：2013-03-21T13:55:28.283
> 
> 标签：ios, core-location, cllocation

我经常使用对象的`distanceFromLocation`方法`CLLocation`来获取它们与其他位置的距离。枚举 CLLocations 数组，然后使用此方法将每个位置与我的参考位置进行比较。

我很想知道 using 的处理/内存含义`distanceFromLocation`，尤其是对于连续的大量`CLLocation`对象。这种方法是如何工作的 - 它是连接到服务器以获取数据，还是根据一些数学公式（例如[Haversine 公式](http://en.wikipedia.org/wiki/Haversine_formula)）计算距离？

有没有更有效的方法来比较 1 个参考位置和 CLLocation 对象数组之间的距离？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T01:31:17.700

他们很可能使用的是球面余弦定律而不是Haversine（[为什么？见这个问题](https://gis.stackexchange.com/q/4906/14315)）。

如果您只想将许多点与一个点进行比较以查看哪个最接近，那么您可能并不关心计算距离的准确性，而只关心性能。在那种情况下，也许使用毕达哥拉斯定理对你有用。

所有这些算法都在[这个网页上](http://www.movable-type.co.uk/scripts/latlong.html)有详细说明，其中部分内容是：

```
If performance is an issue and accuracy less important, for small
distances Pythagoras’ theorem can be used on an equirectangular
projection:* 
```

您可以使用毕达哥拉斯定理实现一个函数，然后将其与 CLLocation 中的那个以及我使用余弦球面定律的[distanceInMetersFromRadians](https://github.com/progrmr/SDK_Utilities/blob/master/Utils/UtilitiesGeo.c)实现进行基准比较，以查看性能差异有多大。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:02:53.673

从文档中：

> 距离位置：
> 
> 这种方法通过追踪它们之间的一条遵循地球曲率的线来测量两个位置之间的距离。生成的弧线是一条平滑曲线，没有考虑两个位置之间的特定高度变化。

所以是的，我认为它使用的是 Haversine 公式（或它的修改版）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-07T07:55:38.690

你用过仪器并测量过吗？在你完成之前，这是没有意义的。

你可以走捷径。假设您想要最近的点。找到一个可以为您提供大致正确结果的公式。通常有一个平方根，所以得到一个距离平方的公式——这样更快，效果也很好。用你的公式找到最近的点。现在根据您的公式说最近的点相距 178.96 米。然后，您可以使用确切的公式检查距离小于 180 米的所有点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-31T23:47:07.280

对于小距离和 iOS 9，我`distanceFromLocation`发现通过使用 WGS-84 椭球获得的值可靠地接近于文森蒂公式找到的值。根据我的经验，它们在大约 7 或 8 个有效数字内是准确的。

球面模型（例如余弦定律或 Haversine 公式）不能很好地比较小距离。

有关详细信息，请参阅[`geopy`文档](http://geopy.readthedocs.io/en/latest/#module-geopy.distance)和[比较值表](https://gist.github.com/ezheidtmann/1d60ddead76273de21ebd1455492e25d)。

# xslt - 需要帮助使用 XSLT 1.0 转换 XML

> ID：15549539
> 
> 赞同：1
> 
> 时间：2013-03-21T13:55:43.137
> 
> 标签：xslt, xslt-1.0

需要有关平面文件模式的 XSLT 转换的一些帮助。是否可以将节点的直接子`Record`节点组合成一个包含`Record`节点？Child`512`是必需的，最小和最大出现次数为 1，并标记新`Record`节点的开始。

**输入：**

```
<ns0:Root xmlns="">
    <Header>
        <node01>AA</node01>
        <node02>123</node02>
    </Header>
    <Record>
        <512>
            <node01>BB</node01>
            <node02>123</node02>
        </512>
    </Record>
    <Record>
        <513>
            <node01>CC</node01>
            <node02>123</node02>
        </513>
    </Record>
    <Record>
        <512>
            <node01>DD</node01>
            <node02>123</node02>
        </512>
    </Record>
    <Record>
        <515>
            <node01>JJ</node01>
            <node02>123</node02>
        </515>
    </Record>
    <Record>
        <512>
            <node01>EE</node01>
            <node02>123</node02>
        </512>
    </Record>
    <Record>
        <513>
            <node01>FF</node01>
            <node02>123</node02>
        </513>
    </Record>
    <Record>
        <514>
            <node01>GG</node01>
            <node02>123</node02>
        </514>
        <514>
            <node01>HH</node01>
            <node02>123</node02>
        </514>
    </Record>
    <Footer>
        <node01>II</node01>
        <node02>123</node02>
    </Footer>
</ns0:Root> 
```

**期望的输出：**

```
<ns0:Root xmlns="">
    <Header>
        <item01>AA</item01>
        <item02>123</item02>
    </Header>
    <Record>
        <512>
            <item01>BB</item01>
            <item02>123</item02>
        </512>
        <513>
            <item01>CC</item01>
            <item02>123</item02>
        </513>
    </Record>
    <Record>
        <512>
            <item01>DD</item01>
            <item02>123</item02>
        </512>
        <515>
            <item01>JJ</item01>
            <item02>123</item02>
        </515>
    </Record>
    <Record>
        <512>
            <item01>EE</item01>
            <item02>123</item02>
        </512>
        <513>
            <item01>FF</item01>
            <item02>123</item02>
        </513>
        <514>
            <item01>GG</item01>
            <item02>123</item02>
        </514>
        <514>
            <item01>HH</item01>
            <item02>123</item02>
        </514>
    </Record>
    <Footer>
        <item01>II</item01>
        <item02>123</item02>
    </Footer>
</ns0:Root> 
```

谢谢你和亲切的问候菲利普

PS：XSLT 2.0 不可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:13:02.813

这不是合法的 XML（元素名称不能以数字开头），但假设您将所有无效元素重命名为以“r”开头，您可以执行以下操作：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>
  <xsl:strip-space elements="*" />

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

  <xsl:template match="Record[r512]">
    <xsl:copy>
      <xsl:apply-templates select="." mode="iterate" />
    </xsl:copy>
  </xsl:template>
  <xsl:template match="Record" />

  <xsl:template match="Record" mode="iterate">
    <xsl:apply-templates />
    <xsl:apply-templates select="following-sibling::Record[1][not(r512)]"
                         mode="iterate"/>
  </xsl:template>
</xsl:stylesheet> 
```

在此输入上运行时：

```
<ns0:Root xmlns="" xmlns:ns0="nsss">
  <Header>
    <node01>AA</node01>
    <node02>123</node02>
  </Header>
  <Record>
    <r512>
      <node01>BB</node01>
      <node02>123</node02>
    </r512>
  </Record>
  <Record>
    <r513>
      <node01>CC</node01>
      <node02>123</node02>
    </r513>
  </Record>
  <Record>
    <r512>
      <node01>DD</node01>
      <node02>123</node02>
    </r512>
  </Record>
  <Record>
    <r515>
      <node01>JJ</node01>
      <node02>123</node02>
    </r515>
  </Record>
  <Record>
    <r512>
      <node01>EE</node01>
      <node02>123</node02>
    </r512>
  </Record>
  <Record>
    <r513>
      <node01>FF</node01>
      <node02>123</node02>
    </r513>
  </Record>
  <Record>
    <r514>
      <node01>GG</node01>
      <node02>123</node02>
    </r514>
    <r514>
      <node01>HH</node01>
      <node02>123</node02>
    </r514>
  </Record>
  <Footer>
    <node01>II</node01>
    <node02>123</node02>
  </Footer>
</ns0:Root> 
```

产生：

```
<ns0:Root xmlns:ns0="nsss">
  <Header>
    <node01>AA</node01>
    <node02>123</node02>
  </Header>
  <Record>
    <r512>
      <node01>BB</node01>
      <node02>123</node02>
    </r512>
    <r513>
      <node01>CC</node01>
      <node02>123</node02>
    </r513>
  </Record>
  <Record>
    <r512>
      <node01>DD</node01>
      <node02>123</node02>
    </r512>
    <r515>
      <node01>JJ</node01>
      <node02>123</node02>
    </r515>
  </Record>
  <Record>
    <r512>
      <node01>EE</node01>
      <node02>123</node02>
    </r512>
    <r513>
      <node01>FF</node01>
      <node02>123</node02>
    </r513>
    <r514>
      <node01>GG</node01>
      <node02>123</node02>
    </r514>
    <r514>
      <node01>HH</node01>
      <node02>123</node02>
    </r514>
  </Record>
  <Footer>
    <node01>II</node01>
    <node02>123</node02>
  </Footer>
</ns0:Root> 
```

# c# - 获取特定时期内最新的 n 个变更列表

> ID：15549541
> 
> 赞同：2
> 
> 时间：2013-03-21T13:55:55.600
> 
> 标签：c#, perforce

我希望在此期间获得最新的 20 个变更列表。如何修改选项？

这对我来说非常重要，因为我会从 perforce 提供的数据中收集一些统计数据。这是我的代码：

```
string deppath1 = "//obms/...";
P4Command cm1 = new P4Command(ps, "changes", true, String.Format("{0}", deppath1));
 Options opchanges = new Options();
opchanges.Add("2012/04/01", "now");
 P4CommandResult results1 = cm1.Run(opchanges);
if (results1 != null)
Console.WriteLine("ggh");
TaggedObjectList listfiledown1 = new TaggedObjectList();
listfiledown1 = (results1.TaggedOutput);

foreach (TaggedObject obj in listfiledown1)
 {
   foreach (String s in obj.Keys)
    {
        String value = "n/a";
        obj.TryGetValue(s, out value);
        Console.WriteLine(s+""+value);
        Console.WriteLine("********");
    }
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T15:55:43.223

```
 opchanges.Add("  -l 20  edk -s    submitted   2010/04/01", "now"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-07T09:34:41.250

```
opchanges.Add("-m n -u edk -s submitted 2010/04/01", "now"); 
```

n 您需要的更改次数。

# php - 后端应用程序中的 GET、POST 和 SESSION

> ID：15549543
> 
> 赞同：0
> 
> 时间：2013-03-21T13:55:58.190
> 
> 标签：php, security, session, post, get

您好，感谢您的宝贵时间。我正在开发一个网络应用程序，我的登录客户将能够在其中观看视频课程。现在我正在使用 GET 通过 URL 传递有关视频类型的信息。例如：

用户 1 有硕士课程 ->>>> URL = curso.php?page=master

用户 2 有基础课程 ->>>> URL = curso.php?page=basic

你看，我认为这里存在安全问题，因为如果用户 2 输入他的 URL“page=master”，他将能够观看不允许他观看的视频。

所以我正在为每个页面编写安全检查，以查看用户 ID 可以访问所需页面的 ID。

但我认为这是太多无用的工作。如果我在我的按钮上使用 POST 方法，并通过 POST 提交数据，那么假设给定用户将无法看到不适合他的内容是否完全安全？毕竟，URL 总是一样的，比如 curso.php。

还有使用 Session 的可能性，但是我可以用提交按钮或类似的东西定义一个 Session 值吗？

我知道，我知道，有很多新手问题，但这只是我的第二个后端系统，我想在这里错过很多安全实践。

将不胜感激任何帮助或提示。

非常感谢，对不起我的英语不好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T13:59:09.273

> 所以我正在为每个页面编写安全检查，以查看用户 ID 可以访问所需页面的 ID。

好的。这就是你需要做的。在向用户展示任何数据之前，请检查他们是否有权查看这些数据。

> 但我认为这是太多无用的工作。如果我在我的按钮上使用 POST 方法，并通过 POST 提交数据，那么假设给定用户将无法看到不适合他的内容是否完全安全？毕竟，URL 总是一样的，比如 curso.php。

在大多数浏览器中，只需不到六次点击即可检查用于发出请求的发布数据。POST 不会向用户隐藏任何内容，它只是避免在他们的脸上挥舞它。

> 并且有可能使用 Session，但我可以用提交按钮或类似的东西定义一个 Session 值吗？

您不能定义会话值客户端。数据必须在请求中发送到服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T14:00:34.610

POST 与 GET 一样不安全。POST 不能用于提高安全性。您必须根据当前登录的用户信息对服务器进行检查。所以使用 GET，因为这是 HTTP 的设计使用方式，并对服务器进行必要的检查。

您需要某种身份验证才能执行您想要的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T13:59:25.600

仅使用 POST 进行中继绝对不安全。例如，您可以使用 REST 工具轻松启动 POST 请求。

我不知道您是否正在使用底层框架（我建议您这样做，因为您基本上是在要求用户权限管理），但如果不是，我可能会将权限保存在 User 类或会话中并检查给定的参数。

基本上，使用 POST 或 GET 都没关系。但是 HTTP 表示，如果您想从服务器检索数据，则使用 GET；如果您想向服务器发送数据，则使用 POST。

因此，使用 GET 并为自己编写一个不错的类，其中存储了经过身份验证的用户的权限，并检查用户是否能够检索所需的内容。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-03-21T13:59:51.510

无论如何，与 相比，两者都`Session`将`POST`大大提高您的安全性`GET`，这是肯定的。但是您仍然需要在您的页面上进行检查

# php - 如何使用php输入值调用javascript函数

> ID：15549544
> 
> 赞同：-1
> 
> 时间：2013-03-21T13:55:59.107
> 
> 标签：php, javascript, input

我想调用一个带有 php 参数的 javascript 函数，如下所示：

```
<script type="text/javascript">formatCurrency(<?php echo $item['price']; ?>);</script> 
```

不幸的是，出了点问题，html 什么也不显示，有人可以建议我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:17:21.117

看来我忘了添加 document.write()，感谢缩短，看起来不错。所以

```
<script>document.write(formatCurrency('<?=$item['price']?>'));</script> 
```

# r - strsplit(filename, "\\.") 中的错误：ggplot 中的非字符参数

> ID：15549546
> 
> 赞同：0
> 
> 时间：2013-03-21T13:56:15.460
> 
> 标签：r, ggplot2

我正在尝试使用水平线制作绘图，其中 data2 和 data3 点应在 data1 范围内。这将给出不同颜色的重叠线，但我收到一条错误消息：

```
Error in strsplit(filename, "\\.") : non-character argument 
```

这是数据和代码。请给我一些建议。

```
 data1 <- data.frame(Start=c(10),End=c(19))

 data2 <- data.frame(Start=c(5),End=c(15))

 data3 <- data.frame(Start=c(6),End=c(18))

 filter_data2 <- data2[data2$Start >= (data1$Start-(data1$Start/2)) & data2$End <= (data1$End+(data1$End/2)), ]

 filter_data3 <- data3[data3$Start >= (data1$Start-(data1$Start/2)) & data3$End <= (data1$End+(data1$End/2)), ]

 data1 <- data.frame(rep(1,nrow(data1)),data1)

 colnames(data1) <- c("ID","start","end")   

 data2 <- data.frame(rep(2,nrow(filter_data2)),filter_data2)

 colnames(data2) <- c("ID","start","end")

 data3 <- data.frame(rep(3,nrow(filter_data3)),filter_data3)

 colnames(data3) <- c("ID","start","end")

 dat1 <- rbind(data1,data2,data3)

 pdf("overlap.pdf")

 p <- ggplot(dat1, aes(x=(max(start)-max(start)/2), y = ID, colour=ID)) 
 p <- p + geom_segment(aes(xend =(max(end)+max(end)/2), ystart = ID, yend = ID))
 p <- p + scale_colour_brewer(palette = "Set1")

 ggsave(p) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:12:03.640

您的代码中有两个问题。如果要使用`scale_colour_brewer()`，则应将 ID 值设置为因子

```
p <- ggplot(dat1, aes(x=(max(start)-max(start)/2), y = ID, colour=as.factor(ID))) 
```

接下来，要保存 ggplot2 图，您有两种可能性。

使用`ggsave()`函数，您应该提供文件名和格式。在这种情况下，函数`pdf()`是不必要的。

```
 ggsave(plot=p,file="plot.pdf") 
```

使用函数`pdf()`，你应该添加`print(p)`然后`dev.off()`。在这种情况下，您不需要`ggsave()`功能。

```
pdf("overlap.pdf")
print(p)
dev.off() 
```

# java - PC锁定时Java机器人不工作

> ID：15549548
> 
> 赞同：2
> 
> 时间：2013-03-21T13:56:29.453
> 
> 标签：java, awtrobot, locked

我已经有一个使用机器人类来完成一组任务的程序。一切都很好，但是，我注意到当我的计算机被锁定时，机器人无法工作。

你知道如何解决这个问题吗？或者即使您的计算机被锁定也可以使用机器人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-16T15:19:04.793

如果有人搜索此问题，因为他们在服务器（如我）上运行硒测试，并且必须解锁 PC 才能使测试正常工作。

不可以，PC 锁定时无法使用机器人。

但是，您可以使用机器人库登录，然后正常运行测试。请注意，在测试运行时您不能使用远程桌面，这会干扰机器人。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-18T11:06:00.157

这是 Robot 类的行为，当机器被锁定时将不会执行模拟。解决方法是创建一个 vbs 脚本，该脚本具有按下 F13(shift+f1) 的按键事件。如果您使用的是 testng，则使用 Runtime.getruntime.exe(String[]{wscript.exe,"path of vbs"}) 在 @beforesuite 中调用此关键字。这将帮助您的系统保持活动状态，直到您的执行完成。在@aftersuite 中终止该进程。

# asp.net - 如何将下拉列表链接到各种文本框 vb.net

> ID：15549551
> 
> 赞同：0
> 
> 时间：2013-03-21T13:56:35.537
> 
> 标签：asp.net, vb.net

我到处搜索以了解此程序，但到目前为止没有任何效果。

基本上我想要的是将我的 ddlreportid 下拉列表链接到各种文本框。

目前，下拉列表连接到一个数据源，在该数据源中它使用报告表来显示报告 ID 的列表，例如 1、2、3 等。

我想要发生的是，如果用户点击 ddlreportid 中的 1。我希望将reportname 放入txtreportname.text 文本框，将reportaddress 放入txtreportaddress 文本框，并将reportpostcode 放入txtreportpostcodec 文本框。

我从哪说起呢？如果有人能指导我，那就太好了。

我以前使用过此代码，但它不起作用。

```
Protected Sub ddlreportid_SelectedIndexChanged1(sender As Object, e As System.EventArgs) Handles ddlreportid.SelectedIndexChanged

    Dim myConn As New SqlConnection
    Dim myCmd As New SqlCommand

    myConn.ConnectionString = ConfigurationManager.ConnectionStrings("ConnectionString").ConnectionString

    myCmd = myConn.CreateCommand

    myCmd.CommandText = "SELECT ReportName, ReportAddress, ReportPostcode WHERE ReportID = @ ReportID"

    myCmd.Parameters.Add(New SqlParameter("@ReportID", (ddlreportid.Text)))

    Dim reader As SqlDataReader = myCmd.ExecuteReader()

    If (reader.Read()) Then
        txtreportname.Text = reader(0)
        txtreportaddress.Text = reader(1)
        txtreportpostcode.Text = reader(2)

    End If

    myCmd.Dispose()
    myConn.Close()
    myConn.Dispose()

End Sub 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:24:03.260

尝试，而不是...

```
myCmd.Parameters.Add(New SqlParameter("@ReportID", (ddlreportid.Text))) 
```

...这样做：

```
myCmd.Parameters.Add(New SqlParameter("@ReportID", (ddlreportid.SelectedItem.Value))) 
```

`AutoPostBack = "true"`如果您希望您的页面立即响应，请确保您的下拉列表有。

# javascript - 如何回调函数？

> ID：15549554
> 
> 赞同：1
> 
> 时间：2013-03-21T13:56:41.950
> 
> 标签：javascript, jquery

我对 jquery codeverse 有点陌生。我想知道如何在文档调整大小后回调函数 CSZ。这是我当前的设置：

```
$(document).ready(function CSZ () {|CODE|}); 
```

然后，我想用这个函数回调代码：

```
$(window).resize(CSZ); 
```

这似乎是一个非常简单的概念，对我不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T13:58:01.467

自行声明函数。然后，您可以为两个回调引用它：

```
function CSZ() {
    // Do stuff
}
$(document).ready(CSZ);
$(window).resize(CSZ); 
```

目前，`CSZ`是一个[*命名函数表达式*](http://kangax.github.com/nfe/)。标识符`CSZ`只会在它所标识的函数的范围*内。*通过更改为遵循我的示例，您可以创建`CSZ`一个函数*声明*。然后它将在它出现的范围内的任何地方（及其后代范围）可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T13:58:49.610

在您当前的代码中，该符号`CSZ`只能从函数体内部访问；它实际上是一种[语言功能](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/function#Named_function_expression)。

为了使其按预期工作，您的函数需要像这样声明，在其自身和全局范围内：

```
function CSZ () {|CODE|} 
```

然后它可以像这样使用：

```
$(document).ready(CSZ);

$(window).resize(CSZ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T13:59:26.160

您的问题是您声明的函数未声明为窗口变量。

你可以这样做：

```
$(document).ready(window.CSZ=function(){...});
$(window).resize(CSZ); 
```

或者你可以遵循这个更常见的模式：

```
$(function(){
    function CSZ(){
       ...
    };
    CSZ();
    $(window).resize(CSZ);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T13:58:58.843

```
function CSZ () {|CODE|}

$(document).ready(CSZ)

$(window).resize(CSZ); 
```

# r - R基于格式为范围（xx-xx）的因子变量对数据框进行子集

> ID：15549555
> 
> 赞同：2
> 
> 时间：2013-03-21T13:56:43.070
> 
> 标签：r, dataframe, subset, r-factor

我现在面临这个问题好几个小时了，但我知道我遗漏了一些明显的东西。

这是我的问题：

我在 .xlsx 文件中有一个数据框，可以在[此处](https://www.dropbox.com/s/uc2cnbpcl51tb7v/Evolution_Population_2004_2020.xlsx)下载。

我在 MAC 上使用 RStudio 将此数据帧加载到 R 中，并将其命名为 demoData。有 5 个变量（AgeRange、Women、Men、Total 和 Year）。

我无法使用 AgeRange 上的条件对该数据框进行子集化。该变量的格式如下：xx-xx（00-04 表示 00 到 04 岁之间的人）。当我尝试这样做时，我得到的消息是没有行满足这个条件。变量“AgeRange”的类是因子。

这是我的代码：

```
demoData[demoData$AgeRange=="00-04",] 
```

谢谢您的帮助。

**编辑：**来自阿伦。这是来自的输入`head(demoData)`：

```
 Age Feminin Masculin. Ensemble Annee
1 00-04     720       745     1465  2004 
2 05-09     745       767     1512  2004 
3 10-14     813       830     1643  2004 
4 15-19     824       820     1644  2004 
5 20-24     839       823     1662  2004 
6 25-29     752       699     1450  2004 

# str(demoData)
'data.frame':   272 obs. of  5 variables:
 $ Age      : Factor w/ 16 levels "00-04 ","05-09 ",..: 1 2 3 4 5 6 7 8 9 10 ...
 $ Feminin  : Factor w/ 216 levels "138 ","139 ",..: 112 124 164 165 174 130 106 86 78 66 ...
 $ Masculin.: Factor w/ 201 levels "120 ","122 ",..: 132 141 174 169 170 124 111 89 90 75 ...
 $ Ensemble : Factor w/ 242 levels "1041 ","1044 ",..: 53 66 115 116 119 50 38 14 9 238 ...
 $ Annee    : Factor w/ 17 levels "2004 ","2005",..: 1 1 1 1 1 1 1 1 1 1 ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:21:59.507

我在你的 xlsx 文件中读到了 xlsx 包：

```
df<-read.xlsx("C:/Users/swatson1/Downloads/Evolution_Population_2004_2020.xlsx",1) 
```

它看起来像这样：

```
> df
        Age Feminin MasculinÂ. Ensemble  Annee
1   00-04Â    720Â       745Â    1465Â  2004Â 
2   05-09Â    745Â       767Â    1512Â  2004Â 
```

你可以替换每一列，去掉多余的字符，比如：

```
df$Age<-substr(df$Age,1,5) 
```

或者，`gsub`无论条目的长度如何，都可以在任何列上使用：

```
df$Age<-gsub("Â\\s","",df$Age) 
```

然后你的代码就可以工作了：

```
df[df$Age=="00-04",] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:23:11.503

```
#coppied from the Excel file 
str1 <- "00-04 "
utf8ToInt(str1)
#[1]  48  48  45  48  52 160 
```

字符串末尾似乎有一个不间断的空格。清理您的文件。

您应该能够使用删除不间断空格

```
df$Age <- gsub(intToUtf8(160),"",df$Age) 
```

# php - SASS 和/或 LESS - 我可以动态创建动态 CSS 文件吗？

> ID：15549561
> 
> 赞同：2
> 
> 时间：2013-03-21T13:57:01.873
> 
> 标签：php, cakephp, compiler-construction, sass, less

我正在使用 CakePHP 来构建我的网站（如果重要的话）。我有大量的元素/模块，每个都有自己的文件和相当复杂的 CSS（在某些情况下）。

目前 CSS 位于一个巨大的单个 CSS 文件中，但为了理智（以及下面提到的细节），我希望能够将 CSS 保存在它自己的相应文件中 - 即`css/modules/rotator.css`. 但是对于普通的 CSS，这将调用大量的 CSS 文件。

因此，我开始根据推荐研究 SASS 或 LESS。但是 - 似乎这些应该被编译然后上传。但在我的情况下，每个页面都可以通过 CMS 进行编辑，因此一个页面可能一分钟有 10 个模块，然后在 CMS 更改后它可能有 20 或 5 个......等等。如果它不打算使用它，我不想为每个模块编译 CSS。

有没有办法让大量的 CSS 文件都可以即时编译？

旁注：我还希望允许用户为页面和/或模块编辑自己的 CSS，然后在默认 CSS 之后加载。这对 SASS 和/或 LESS 可行吗？

我不需要完整的演练（尽管那会很棒），但到目前为止，我的搜索已经返回了与 Ruby on Rails 相关的东西（从未使用过）或每种 CSS 语言的通用教程。

欢迎任何其他建议。我是一个完整的 SASS/LESS 菜鸟。

**澄清问题：**

如何使用 LESS 动态（服务器端）组合多个 CSS 文件？（即使是一个能让我走上正轨的资源链接也足够了！）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T14:13:57.490

如果你想减少 CSS 文件的数量并且你有一个包含所有组件 css 的巨大 css 文件，只需在所有页面上链接到它并确保正确设置缓存标题。

他们将加载文件一次并在任何地方使用它。一个陷阱是初始页面加载时间。如果这不是问题，请使用此解决方案。如果这是一个问题，请考虑将已编译的 CSS 文件分解为几个主要块（default.css、authoring.css、components.css 等）。

不要费心尝试为每个组件集合制作自定义 CSS，您实际上会通过强迫用户重新下载以不同方式重新组织的相同 CSS 来打自己的脚。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T14:07:31.970

查看lessphp（[http://leafo.net/lessphp/](http://leafo.net/lessphp/)）。这是一个less的php实现，可以通过比较时间戳来重新编译更改的文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T14:00:38.400

假设“on the fly”意味着“on pageload”，那可能比发送多个文件还要慢。我建议在保存模块时重新编译样式表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T19:28:57.737

只需要必要的模块的问题应该通过 CMS 来解决。它与 SASS 或 LESS 无关。

如果您的 CMS 知道当前页面有哪些模块，请不要运行 SASS/LESS 编译（除非您实现缓存，否则它会非常缓慢，这不是一项简单的任务）。相反，调整 CMS 的逻辑，使其包含每个模块的 CSS 文件。

[像Drupal](http://drupal.org/)这样的高级 CMS不仅会自动获取必要的 CSS 文件，而且还会将它们组装成一个文件并进行压缩。

如果您的 CSS 不知道当前页面有哪些模块（例如，“模块”只是保存在帖子正文中的 HTML 代码），那么您实际上什么也做不了。

UPD：正如**Sequoia mcdowell**在他的回答中所说，让用户下载一个大的 CSS 文件一次比让他们下载一些包含重复代码的较小的 CSS 文件要好。所有这些较小 CSS 文件的累积大小将大于完整 CSS 文件的大小。

# vb.net - vb.net：如何从一列中计算搜索值的行数

> ID：15549562
> 
> 赞同：0
> 
> 时间：2013-03-21T13:57:06.120
> 
> 标签：vb.net, ms-access, count

假设有两列收到日期和项目

如果我搜索有 5 行相同日期的日期

它会出现在文本框中

我请帮忙

*注意，我使用 oledb 作为数据库连接

这是我的搜索代码

```
Private Sub TxSearch_TextChanged(sender As System.Object, e As System.EventArgs) Handles TxSearch.TextChanged

    If Con.State = ConnectionState.Closed Then
        Con.Open()
    End If

    Dad = New OleDb.OleDbDataAdapter("select RecordDate, Item from inv where RecordDate LIKE '%" & TxSearch.Text & "%'", Con)
    Dim dt As New DataTable
    Dad.Fill(dt)

    Me.DataGridView1.DataSource = dt
    Con.Close()
    DataGridView1.RowsDefaultCellStyle.BackColor = Color.DeepSkyBlue
    DataGridView1.AlternatingRowsDefaultCellStyle.BackColor = Color.White
    Con.Close()

    SortDatagridviewColumn(0)
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:24:40.050

Private Sub TxSearch_TextChanged(sender As System.Object, e As System.EventArgs) 处理 TxSearch.TextChanged

```
If Con.State = ConnectionState.Closed Then
    Con.Open()
End If

Dad = New OleDb.OleDbDataAdapter("select RecordDate, Item from inv where RecordDate LIKE '%" & TxSearch.Text & "%'", Con)
Dim dt As New DataTable
Dad.Fill(dt)

Me.DataGridView1.DataSource = dt

    Dim counter As String
    counter = dt.Rows.Count.ToString
    textBoxRowCount.Text = counter

Con.Close()
DataGridView1.RowsDefaultCellStyle.BackColor = Color.DeepSkyBlue
DataGridView1.AlternatingRowsDefaultCellStyle.BackColor = Color.White
Con.Close()

SortDatagridviewColumn(0)

Private Sub textBoxRowCount_TextChanged(sender As System.Object, e As System.EventArgs) Handles textBoxRowCount.TextChanged

End Sub 
```

结束子

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:06:06.937

可能只是这样：

```
....
Dad.Fill(dt)
textBoxRowCount.Text = "Found " + dt.Rows.Count + " rows"
Me.DataGridView1.DataSource = dt
.... 
```

编辑：更改您的查询以使用参数，不要尝试连接字符串来构建 sql 命令

```
Dim sqlText = "select RecordDate, Item from inv where RecordDate LIKE @search"
Dad = New OleDb.OleDbDataAdapter(sqlText, Con)
Dad.SelectCommand.Parameters.AddWithValue("@search", "%" + TextSearch.Text + "%")
Dim dt As New DataTable
Dad.Fill(dt) 
```

但是在上面的例子中，RecordDate 被认为是一个文本字段，如果相反，RecordDate 是一个 DateTime 类型的数据库字段，那么使用 LIKE 是没有意义的。您应该使用等于 (=) 或 sql 子句`BETWEEN`

查看您的评论，然后您可以编写一个查询来计算记录，（关于 RecordDate 的注意事项仍然有效）

```
Dim sqlText = "select COUNT(*) from inv where RecordDate LIKE @search"
Dim cmd  = New OleDb.OleDbCommand(sqlText, Con)
cmd.Parameters.AddWithValue("@search", "%" + TextSearch.Text + "%")
Dim resultCount = cmd.ExecuteScalar() 
```

# c# - 将字符串拆分为不同的字符串c#

> ID：15549563
> 
> 赞同：0
> 
> 时间：2013-03-21T13:57:06.250
> 
> 标签：c#, split

如果这已在其他地方发布，请原谅我，我是新来的编码！

在 c# 中，我希望接收一个像 'Hello, 15, 20' 这样的字符串，然后将 'Hello' 放入一个字符串中，将 '15' 放入另一个字符串中，将 '20' 放入另一个字符串中，以便稍后在代码中我可以将它们用作变量。我环顾四周，似乎找不到一个有效的，（或者我没有正确使用谷歌！）。

任何帮助都非常感谢，我希望我说得通：P

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:58:38.827

利用[`String.Split`](http://msdn.microsoft.com/en-us/library/system.string.split.aspx)

```
var input = "Hello, 15, 20";
var parts = input.Split(new string[] { ", " }, StringSplitOptions.None); 
```

它将返回一个您可以像这样使用的数组：

```
Console.WriteLine(parts[0]); // "Hello";
Console.WriteLine(parts[1]); // "15";
Console.WriteLine(parts[2]); // "20"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T13:58:49.403

你一定没有正确使用谷歌。

谷歌`Split string c#`，你会遇到`String.Split()`-[这里是 msdn 文档](http://msdn.microsoft.com/en-gb/library/system.string.split.aspx)。

```
var strs = "Hello, 15, 20".Split(new string[] {", "}, StringSplitOptions.None); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T13:59:01.097

尝试使用String.Split()，你可以参考msdn [here](http://msdn.microsoft.com/en-gb/library/system.string.split.aspx)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T14:01:56.003

看这个例子：

```
string stringToSplit = "Hello, 15, 20";
string[] parts = stringToSplit.Split(", ");
foreach(string part in parts)
{
  // Do your thing
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T14:18:21.697

尝试这个：

```
 string str1;
    string str2;
    string str3;

    string InputString = "Hello, 15, 20";
    string[] parts = InputString.Split(", ");

    str1 = parts[0];
    str2 = parts[1];
    str3 = parts[2];

    Console.WriteLine(str1);
    Console.WriteLine(str2);
    Console.WriteLine(str3); 
```

使用调试，如果您使用这样的 WinForms：

```
 Debug.WriteLine(str1);
    Debug.WriteLine(str2);
    Debug.WriteLine(str3); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-21T13:59:35.820

使用[String.Split](http://msdn.microsoft.com/en-us/library/y7h14879.aspx)方法将字符串拆分为多个部分。MSDN上的文档很详尽，你应该看看它。

# ruby-on-rails - 将 http_params 转换为哈希

> ID：15549565
> 
> 赞同：3
> 
> 时间：2013-03-21T13:57:10.483
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我可以从字符串中获取一个数组

```
http_params="created_end_date=2013-02-28&created_start_date=2013-01-01&page_size=50&offset=0&order_id=0D1108211501118%0D%0A0D11108211501118%0D%0Ac%0D%0AD%0D%0ADK212071409743%0D%0AKK30109110100%0D%0AKK30111140300%0D%0AKK30111140400%0D%0AKK30115120100%0D%0AKK30115150100&page_number=1" 
```

所以我做了`myarray=http_params.split("&")`：

```
myarray=["created_end_date=2013-02-28", "created_start_date=2013-01-01", "page_size=50", "offset=0", "order_id=0D1108211501118%0D%0A0D11108211501118%0D%0Ac%0D%0AD%0D%0ADK212071409743%0D%0AKK30109110100%0D%0AKK30111140300%0D%0AKK30111140400%0D%0AKK30115120100%0D%0AKK30115150100", "page_number=1"] 
```

我需要将其转换为哈希 myhash，以便我可以对 myhash.to_json 进行 Rest Client 发布调用。基本上它应该是键值对，例如：

```
{:created_end_date=>"2013-02-28",:created_start_date=>"2013-01-01"....} 
```

我知道逆运算可以这样完成：

```
http_params = myhash.map{|k,v| "#{k}=#{v}"}.join('&') 
```

但我无法为此提供简洁的代码。

我应该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T14:03:30.830

```
require 'cgi'
hash = CGI::parse http_params 
```

或者您可以使用：

```
hash = Rack::Utils.parse_nested_query http_params 
```

它不会将值作为数组返回。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:07:15.513

使用纯 Ruby 方法，您可以将字符串转换为 Hash，如下所示：

```
"a=1&b=2".split('&').map { |h| Hash[*h.split("=")] }
=> [{"a"=>"1"}, {"b"=>"2"}] 
```

一篇关于如何操作 Ruby 集合的博文在这里：[http ://thinkingonthinking.com/map-reduce-in-ruby/](http://thinkingonthinking.com/map-reduce-in-ruby/)

要将符号作为键，需要一个小的额外步骤：

```
"a=1&b=2".split('&').map { |h| hs = h.split("="); Hash[hs[0].to_sym, hs[1]] }
=> [{:a=>"1"}, {:b=>"2"}] 
```

作为最后一步，必须完成内部 Hash 元素的合并。这可以像这样完成：

```
"a=1&b=2".split('&').map { |h| hs = h.split("="); Hash[hs[0].to_sym, hs[1]] }.inject({}) { |s, h| s.merge(h) }
=> {:a=>"1", :b=>"2"} 
```

# java - JComboBox 自行选择第一项

> ID：15549568
> 
> 赞同：-1
> 
> 时间：2013-03-21T13:57:15.460
> 
> 标签：java, swing, selection, jcombobox

我制作了一个组合框，其中填满了数据库条目。我目前面临的问题是，当我写“H”时，列表会根据需要填充以“H”开头的所有名称，但会自动选择列表中的第一个名称。如何避免这个问题？

```
String ch = text.getText();
if (ch.equals("")) {
    combo.setVisible(false);               
} else {                
    try {                  
        Class.forName("com.mysql.jdbc.Driver");
        Connection connect = DriverManager.getConnection("jdbc:mysql://localhost:3306/userlogin", "root","12345");
        Statement st = connect.createStatement();
        ResultSet rs = st.executeQuery("SELECT author_name FROM scrpd_authors WHERE author_name LIKE '"+ ch + "%'");

        while (rs.next()) {
            String name = rs.getString("author_name");
            if (name.equals("")) {
                searchitems.addItem("");
            } else {
                searchitems.addItem(rs.getString("author_name"));
                searchitems.setVisible(true);                            
            }                        
        }
        connect.close();
    } catch (Exception ex) {
    }
 } 
```

请注意，组合框正在填充基于 mysql 查询的所有我想要的条目，问题只是选择了第一个条目本身。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T16:55:21.227

这是添加到空框时不可编辑的 JComboBox 的一个怪癖：

*   using`addItem(item)`将选择该项目
*   using`insertItemAt(item, 0)`不会选择该项目

这个怪癖与填充是发生在模型上还是发生在视图上无关——

因此，如果在填充模型后取消选择（如 Rob 所建议）不是一个选项，您可以使用 insert 方法（在视图或模型上）：

```
// model 
model.addElementAt(item, model.getSizes();
// alternatively view
combo.insertItemAt(item, combo.getItemCount()); 
```

通常，建议对模型进行模型操作（相对于视图上的覆盖方法）——这样您就可以独立于视图来实现和测试模型处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T15:50:05.190

> 列表中的名字会自动被选中。如何避免这个问题？

然后使用：

```
comboBox.setSelectedIndex(-1); 
```

加载数据后。

或者，也许您可​​以使用[Combo Box Prompt](http://tips4java.wordpress.com/2008/10/18/combo-box-prompt/)。

# ios - 如何替换故事板segue

> ID：15549569
> 
> 赞同：1
> 
> 时间：2013-03-21T13:57:21.040
> 
> 标签：ios, objective-c, storyboard

我对故事板有点困惑。我的故事板是这样的：

![故事板的屏幕截图](../Images/0431fd5f51a2d7945c3c6e62b2329588.png)

现在我想更改“标签栏控制器”和“主滚动视图”之间的链接。相反，我想放置白色的“视图控制器”，并在“视图控制器”上放置一个按钮，当您单击该按钮时，它会进入“主滚动视图”。我怎样才能在故事板中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:28:57.887

删除转场。将navigationController 拖到故事板中，并使其成为替换tabBarViewController 中当前mainScrollView 的视图。当你拖入一个 nvigationController 时，它会拉一个 viewController 作为 rootView。删除那个。按住 Control 键单击并从新的导航控制器拖动到您的白色 viewController，然后选择“根视图”。将按钮放在您的白色 viewController 中。按住 Control 单击并从按钮拖动到 mainScrollViewController，然后选择“push”。

# html - 将 div 放在父 div 的底部

> ID：15549570
> 
> 赞同：0
> 
> 时间：2013-03-21T13:57:22.877
> 
> 标签：html, css

我想在他的parant div的底部不断地放置一个div元素。

这应该与

```
position:relative; 
bottom:0px; 
```

无论如何它不会，我唯一能想到的就是边缘顶部直到它适合，但我不喜欢那样。您能在我的代码中找到相对位置不起作用的原因吗？

```
@charset "utf-8";
/* CSS Document */

body {
    background-color:#999;  
}

#wrapper {
    height:40em;
    max-height:45em;
    min-height:40em;
    width:80%;
    max-width:60em;
    min-width:30em;
    margin-left:auto;
    margin-right:auto;
    background-color:#333;
    border:#000 solid;
    border-width:thin;
}

#header {
    width:100%;
    height:70px;
    background-color:#009900;
    border-bot:#000 solid;
    border-width:thin;
}

#content {
    position:relative; 
    bottom:0px;
    top:auto;
    width:100%;
    height:30em;
    background-color:#FFFFFF;
    border-top:#000 solid;
    border-width:thin;  
} 
```

Content 和 Header 都是 wrapper 的父级。所以我想把内容放在包装器的底部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T13:58:41.277

将位置#wrapper 设置为相对，然后将#content 的位置设置为绝对，底部设置为零。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:00:05.170

父元素应该有一个`position:relative`和一个粘在底部

```
position:absolute; 
bottom:0px; 
```

希望这可以帮助。

# javascript - jQuery在单击时删除克隆的元素

> ID：15549571
> 
> 赞同：3
> 
> 时间：2013-03-21T13:57:25.183
> 
> 标签：javascript, jquery, html

我有一个脚本可以在单击时删除重复的表单。但是当你点击删除时，我只想删除被克隆的表单。我相信我需要使用`$this`但不确定如何使用？

**jQuery**

```
$(".remove").click(function() {
    $('.duplicate').remove();
}); 
```

**HTML**

```
<div class="duplicate">
    <p>Form Duplicate</p>
    <a href="#" class="add">Add Guest</a> | <a href="#" class="remove">Remove </a>
</div>
<div class="duplicate">
    <p>Form Duplicate</p>
    <a href="#" class="add">Add Guest</a> | <a href="#" class="remove">Remove </a>
</div> 
```

这是现场预览：[http](http://www.waterfrontexeter.co.uk/preordernew/) ://www.waterfrontexeter.co.uk/preordernew/ 。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T13:58:50.547

只需使用[`closest()`](http://api.jquery.com/closest/)，不要忘记[`preventDefault()`](http://api.jquery.com/event.preventDefault/)：

```
$(".remove").click(function(e) {
    $(this).closest(".duplicate").remove();
    e.preventDefault();
}); 
```

# performance - 在无向图中使用有限路径优化 Neo4j Cypher 路径查找

> ID：15549573
> 
> 赞同：1
> 
> 时间：2013-03-21T13:57:27.317
> 
> 标签：performance, neo4j, cypher, graph-databases

[作为“ Neo4j Cypher path find slow in undirected graph](https://stackoverflow.com/questions/15456345/neo4j-cypher-path-finding-slow-in-undirected-graph) ”问题的后续行动。Michael Hunger 和 Wes Freeman 提供了帮助，但我未能将学到的技术应用于应该返回路径的路径查找查询。

**问题：**

下面的查询大约需要 3 秒并从数据库返回 13 行（找到的路径）。我发现它很慢，希望它执行得更快，但不知道如何优化它。（这当然是一个例子，但我发现其他类似的查询也很慢。）

```
START n=node:NodeIds('id:4000'), t=node:NodeIds('id:10778')   
MATCH path = (n)-[:ASSOCIATIVY_CONNECTION*1..3]-(t)   
RETURN nodes(path) AS Nodes 
```

与配置文件数据相同：

```
neo4j-sh (0)$ profile START n=node:NodeIds('id:4000'), t=node:NodeIds('id:10778')    MATCH path = (n)-[:ASSOCIATIVY_CONNECTION*1..3]-(t)    RETURN nodes(path) AS Nodes;
==> +-------------------------------------------------------------------------------------------+
==> | Nodes                                                                                     |
==> +-------------------------------------------------------------------------------------------+
==> | [Node[3984]{Id:4000},Node[986]{Id:1001},Node[18536]{Id:18552},Node[10763]{Id:10778}]      |
==> | [Node[3984]{Id:4000},Node[1085]{Id:1100},Node[9955]{Id:9970},Node[10763]{Id:10778}]       |
==> | [Node[3984]{Id:4000},Node[133348]{Id:133364},Node[9955]{Id:9970},Node[10763]{Id:10778}]   |
==> | [Node[3984]{Id:4000},Node[111409]{Id:111425},Node[18536]{Id:18552},Node[10763]{Id:10778}] |
==> | [Node[3984]{Id:4000},Node[64464]{Id:64480},Node[18536]{Id:18552},Node[10763]{Id:10778}]   |
==> | [Node[3984]{Id:4000},Node[64464]{Id:64480},Node[9955]{Id:9970},Node[10763]{Id:10778}]     |
==> | [Node[3984]{Id:4000},Node[64464]{Id:64480},Node[10763]{Id:10778}]                         |
==> | [Node[3984]{Id:4000},Node[64464]{Id:64480},Node[64455]{Id:64471},Node[10763]{Id:10778}]   |
==> | [Node[3984]{Id:4000},Node[79152]{Id:79168},Node[18536]{Id:18552},Node[10763]{Id:10778}]   |
==> | [Node[3984]{Id:4000},Node[69190]{Id:69206},Node[18536]{Id:18552},Node[10763]{Id:10778}]   |
==> | [Node[3984]{Id:4000},Node[25893]{Id:25909},Node[18536]{Id:18552},Node[10763]{Id:10778}]   |
==> | [Node[3984]{Id:4000},Node[31683]{Id:31699},Node[18536]{Id:18552},Node[10763]{Id:10778}]   |
==> | [Node[3984]{Id:4000},Node[6965]{Id:6980},Node[18536]{Id:18552},Node[10763]{Id:10778}]     |
==> +-------------------------------------------------------------------------------------------+
==> 13 rows
==> 2824 ms
==> 
==> ColumnFilter(symKeys=["path", "n", "t", "  UNNAMED3", "Nodes"], returnItemNames=["Nodes"], _rows=13, _db_hits=0)
==> Extract(symKeys=["n", "t", "  UNNAMED3", "path"], exprKeys=["Nodes"], _rows=13, _db_hits=0)
==>   ExtractPath(name="path", patterns=["  UNNAMED3=n-[:ASSOCIATIVY_CONNECTION*1..3]-t"], _rows=13, _db_hits=0)
==>     PatternMatch(g="(n)-['  UNNAMED3']-(t)", _rows=13, _db_hits=0)
==>       Nodes(name="t", _rows=1, _db_hits=1)
==>         Nodes(name="n", _rows=1, _db_hits=1)
==>           ParameterPipe(_rows=1, _db_hits=0) 
```

**设置：**

Neo4j 图形数据库有 165k 节点和 266k 关系，其中所有关系都是无向的（双向）并具有标签“ASSOCIATIVY_CONNECTION”。没有一个节点连接到根节点。除了节点和关系之外，每个节点只存储一个整数值（图数据库不用于存储实际数据，而仅用于结构）。

该数据库的内存配置如下：

```
wrapper.java.initmemory=1024
wrapper.java.maxmemory=1024

neostore.nodestore.db.mapped_memory=225M
neostore.relationshipstore.db.mapped_memory=250M
neostore.propertystore.db.mapped_memory=290M
neostore.propertystore.db.strings.mapped_memory=330M
neostore.propertystore.db.arrays.mapped_memory=330M 
```

该数据集是通过维基百科文章之间的相互联系生成的图表，可从[此处](http://associativy.com/Media/Default/Associativy/Wiki.zip)下载。

我从 Neo4j.bat 开始在 Windows 8 机器上运行 Neo4j 1.9.M05 社区。我不认为硬件可能是一个问题，因为查询只会导致短暂的 10% CPU 峰值。有 GB 的可用 RAM。

我将非常感谢有关如何使此查询运行得更快的指针。

**编辑：**在具有 283k 节点和 538k 关系的同一图表的略微增强版本中尝试了相同的查询。现在需要20秒！

**编辑 2，增加内存限制：** 根据 Michael 的建议，我将 wrapper.java.initmemory 和 wrapper.java.maxmemory 设置提高到 8192 (8GB)。它确实将运行 Neo4j 的 java 进程的内存占用增加到 2,25GB，并且还提高了查询的性能：现在预热查询大约需要 1 秒（第三次运行之后）。我还将 neo4j.properties 配置文件中的内存设置提高到每个 2GB，但它没有任何明显的效果。为了使所有这些工作，我需要 64b Java 运行时（您可以轻松为浏览器下载的默认版本是 32b 版本），因此我下载了它的[手动安装程序](http://www.java.com/en/download/manual.jsp)。安装后 Neo4j 将自动启动它而不是 32b 版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T18:09:45.873

当您在 Windows 上运行时，请增加堆大小，因为 MMIO 直接内存是 Windows 上 Java 堆的一部分。

# objective-c - GCD - 阻塞队列上的 dispatch_async

> ID：15549575
> 
> 赞同：1
> 
> 时间：2013-03-21T13:57:41.223
> 
> 标签：objective-c, grand-central-dispatch

如果`dispatch_async`队列上的代码块当前被它自己的`dispatch_sync`操作阻塞，会发生什么？他们会锁定还是在`dispatch_sync`操作返回后阻塞的队列会继续？

我创建了一个对象，用于管理对后备存储（在本例中为 SQLite）的访问。它使用一个`concurrent`GCD 队列，任何其他想要从存储中访问信息的对象都会向管理器传递一个请求以及一个异步执行的块。发生的事情的本质是这样的（不是实际的代码）：

```
- (void) executeRequest:(StoreRequest *)request withCompletionBlock:(void(^)(NSInteger result)block{
    dispatch_queue_t currentContext = dispatch_get_current_queue();
    dispatch_async(_storeQueue, ^{
        NSInteger result = [_store executeRequest:request];
        if (block){
            dispatch_async(currentContext, ^{
                block(result);
            }
        }
    });
} 
```

真正的代码有点复杂（我实际上排队并存储请求/块/上下文以在运行循环结束时执行）。我还`dispatch_barrier_async`用于写请求以防止并发读/写。这一切都很好，但在某些情况下，我还需要在商店上执行同步请求。现在这个请求不需要在任何排队操作之前执行，但我确实需要阻塞请求队列，直到执行操作。这很容易做到：

```
- (NSInteger) executeRequest:(StoreRequest *)request{
    __block NSInteger result = 0;
    dispatch_sync(_storeQueue, ^{
        result = [_store executeRequest:request];
    });
    return result;
} 
```

我的问题是：如果放置在同步操作之前的未决异步操作在当前被同步调度阻塞的队列上异步调度代码块，会发生什么情况。换句话说，上述操作将在`_store`队列末尾分派其请求并等待。但是很可能（甚至很可能）它前面的操作包括异步分派回等待队列（用于其他操作）。这会锁定线程吗？由于排队的块是异步调度的`_store`队列永远不会被阻塞，因此将完成，理论上允许它阻塞的队列继续......但我不确定异步分派的块会发生什么，或者是否将任何内容分派给块线程会将其锁定。我会假设被阻塞的队列将继续，完成它的请求，然后处理待处理的块，但我想确定一下。

实际上，既然我已经写了这一切，我很确定它会正常工作，但无论如何我都会发布这个问题以确保我没有遗漏任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:52:23.357

`dispatch_async`从不阻塞。就是这么简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-23T12:14:30.903

dispatch_async 本身永远不会阻塞。它将块附加到队列的末尾并立即返回。

区块会被执行吗？这取决于。在顺序队列中，如果一个块被阻塞，则在该块被解除阻塞并完成之前不会执行其他块。在后台队列上，队列可以使用多个线程，因此即使某些块被阻塞，它也会启动其他块。我没有尝试过是否对阻塞块的数量有限制，但是很有可能所有未阻塞的块最终都会执行并完成，而你只剩下被阻塞的块。

# android - 获取家庭启动器包名称并启动它的最佳方法

> ID：15549584
> 
> 赞同：0
> 
> 时间：2013-03-21T13:58:04.510
> 
> 标签：android

我遇到了有关如何获取主页启动器包名的问题。
在 android 中，有两种类型的 home 启动器：

1.  原装发射器
2.  3-third 启动器，如 go-launcher 或 OEM

所以，我们不能使用指定的包名来启动它。
最后，我想出了一个解决方案。
有没有其他更好的方法来做到这一点？

```
 //find out the package with ACTION_MAIN & CATEGORY_HOME
    Intent i = new Intent();
    i.setAction(Intent.ACTION_MAIN);
    i.addCategory(Intent.CATEGORY_HOME);
    PackageManager pm = this.getPackageManager();
    List<ResolveInfo> ris = (List<ResolveInfo>) pm.queryIntentActivities(i,
            PackageManager.MATCH_DEFAULT_ONLY);
    Log.i("", ris.size() + "");
    //seletc the first one , doc says the first one is the home launcher currently
    if (ris != null && ris.size() > 0) {
        String pkg = ris.get(0).activityInfo.packageName;
        Log.i("HOME PKG NAME ", pkg);
        //start it 
        i.setClassName(ris.get(0).activityInfo.packageName, ris.get(0).activityInfo.name);
        startActivity(i);
    } 
```

感谢[https://groups.google.com/forum/?fromgroups=#!topic/android-developers/-5aGSOdwJ-8](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/-5aGSOdwJ-8)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:26:18.033

您可以将 Intent 与 Category`CATEGORY_HOME`和 Action一起使用`ACTION_MAIN`。

```
Intent startMain = new Intent(Intent.ACTION_MAIN);
startMain.addCategory(Intent.CATEGORY_HOME);
startMain.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(startMain); 
```

# php - 从表单将项目插入 MySQL 数据库

> ID：15549587
> 
> 赞同：0
> 
> 时间：2013-03-21T13:58:24.180
> 
> 标签：php, html, mysql, forms

通过一个网站上的两个页面，我不打算离开我的家用计算机，我想使用一个表单将项目输入到我的计算机上托管的 MySQL 数据库中。我以前用几乎相同的东西做过这个，但由于某种原因，这个不起作用。我不担心这个或类似的东西的安全性，因为它不会离开我自己的电脑，我只是希望它能够真正工作。

形式：

```
<form action='addclothes.php' method='post'><table style="font-family:verdana;font-size:14px;color:#004766;"><tr><td>
Type of clothing:</td><td><select name="type">
<option value="0">---</option>
<option value="dresses">Dress</option>
<option value="tops">Top</option>
<option value="bottoms">Bottom</option>
<option value="shoes">Shoes</option>
<option value="accessories">Accessory</option></select></td></tr>
<tr><td>Name:</td><td><input type="text" name="name"></td></tr>
<tr><td>Path to full image:</td><td><input type="text" name="largeimagepath"></td></tr>
<tr><td>Path to thumbnail:</td><td><input type="text" name="smallimagepath"></td></tr>
<tr><td colspan="2"><center><input type="submit" value="Submit" name="submit"></center></td></tr>
</table></form> 
```

这发送到 addclothes.php，看起来像这样，用 html 封装以保持相同的布局：

```
<?php

$name = $_POST['name'];
$table = $_POST['type'];
$largepath = $_POST['largeimagepath'];
$thumbpath = $_POST['smallimagepath'];

    $db = mysql_connect("localhost", "root", "******") or die(mysql_error());
    mysql_select_db("Default") or die(mysql_error());

    $query = "INSERT INTO clothes."{$table}" (name, imagepath, thumbimagepath)
 VALUES("{$name}", "{$largepath}", "{$thumbpath}")";
    mysql_query($query) or die(mysql_error()); ?>

<p>Item Added!</p> 
```

它来到下一页，无论如何都只是说“添加了项目”。如果我在创建也没有显示的变量之后尝试回显查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:03:47.167

这是错误的：

```
$query = "INSERT INTO clothes."{$table}" (name, imagepath, thumbimagepath)
            VALUES("{$name}", "{$largepath}", "{$thumbpath}")"; 
```

您需要在查询中使用单引号以避免破坏它（您不引用表名；如果它可以是 mysql 中的保留字，则使用反引号）：

```
$query = "INSERT INTO clothes.`{$table}` (name, imagepath, thumbimagepath)
            VALUES('{$name}', '{$largepath}', '{$thumbpath}')"; 
```

另请注意，安全/ sql 注入不仅仅是为了保护您免受恶意人员的侵害；如果您没有正确准备数据以在 sql 查询中使用，即使是您自己输入的有效数据 - 如果名称包含`'`字符（`O'Neill`例如...），也可能会破坏查询/应用程序。

所以安全总是很重要，这就是为什么你应该切换到 PDO（或 mysqli）和准备好的语句。除此之外，这些`mysql_*`功能已被弃用。

最后一条评论：如果您向外界开放您的网站，则任何准备或转义都不会保护您查询中的表名；您需要检查允许的表名列表以避免 sql 注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T15:42:20.420

```
<?php
    $name = $_POST['name'];
    $table = $_POST['type'];
    $largepath = $_POST['largeimagepath'];
    $smallpath = $_POST['smallimagepath'];

    $name = htmlentities($name);
    $table = htmlentities($table);
    $largepath = htmlentities($largepath);
    $smallpath = htmlentities($smallpath);

    $connection = new PDO('mysql:host=localhost;dbname=Default','root','*****');
    $query = $connection->prepare('INSERT INTO :table (name,imagepath,thumbimagepath) VALUES (:name,:image,:thumb)';

    $query->bindParam(':table', $table);
    $query->bindParam(':name', $name);
    $query->bindParam(':image',$largepath);
    $query->bindParam(':thumb',$smallpath);
    $query->execute();

    if($query->rowCount()) {
        echo "Inserted correctly";
    } else {
        echo "Failure inserting";
    }
?> 
```

正如其他人所说，您真的不应该允许某人通过表单输入表名。

# c - 如何在 Linux 中使用 crypt() 方法？

> ID：15549591
> 
> 赞同：6
> 
> 时间：2013-03-21T13:58:30.310
> 
> 标签：c, linux, unix, crypt

我只是想用来`crypt()`生成一个加密的密码，我写了一个调用该`crypt()`方法的演示。这是我的代码

```
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>

int main()
{
    printf("%s\n",crypt("abc","ab"));
    exit(0);
} 
```

我使用它编译它`"gcc tem.c -lcrypt'`，当我运行它时，一切似乎都正确，但出现了“段错误”。所以请告诉我这个简单的程序有什么问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T14:07:36.903

如果你用标志编译`-Wall`你会明白为什么。

如果您阅读[手册页](http://linux.die.net/man/3/crypt)，您会看到它`#define _XOPEN_SOURCE`在包含`<unistd.h>`. 它实际上应该在包含*任何*标题之前定义。

如果您不定义`_XOPEN_SOURCE`，则该`crypt`函数将不会被原型化。然后编译器不知道实际的返回类型是什么，或者参数的类型和数量。所以它会假设函数返回一个`int`并且你`printf`期望一个字符串，所以会有一个类型不匹配导致崩溃。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T14:04:00.800

你需要这个：

```
#define _XOPEN_SOURCE 
```

在源文件的顶部，在任何`#include`.

或者使用 gcc 选项进行编译`-D_XOPEN_SOURCE`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T14:04:43.687

看起来它可能与加密库支持有关。

尝试添加：

```
#include <crypt.h>

[mstanislav@pardalislabs ~]$ gcc tem.c -lcrypt
[mstanislav@pardalislabs ~]$ ./a.out  
abFZSxKKdq5s6 
```

对我来说看起来不错！

# c# - 如何使用 XmlReader 可靠地工作

> ID：15549593
> 
> 赞同：0
> 
> 时间：2013-03-21T13:58:34.410
> 
> 标签：c#, .net, xmlreader

我正在使用[XmlReader](http://msdn.microsoft.com/en-gb/library/system.xml.xmlreader.aspx)类，即只进阅读器。我正在调用的方法将光标作为副作用移动。但是，有时该方法会引发异常，并将光标留在意料之外的地方。我该如何处理？

```
xml.ReadStartElement("root");

if (xml.IsStartElement("Results"))
{
    try
    {
        results = Results.FromXml(xml);
        // if method successful, it reads past the closing tag of the 'Results' element
    }
    catch
    {
        results = null;
        // I want to manually move the cursor past the closing tag of the 'Results' element.
    }
} 
```

示例文档

```
<root>
    <results>
        <arbitaryxml/>
    </results>*
    <signatures> 
```

如果Results.FromXml 方法成功，光标将留在*。但是，如果失败，它可能会留在结果元素内的任何位置。我希望我的 catch 块确保光标前进到 *. （注意。下一个元素并不总是称为“签名”）。

我发现这很难解释。请问是否需要澄清，我可以举更多的例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:43:21.827

看看[ReadSubtree](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.readsubtree.aspx)方法，它会做你想做的事。实际上，它定位到结束元素节点，但它完成了你想要的。通常，您会编写如下内容：

```
XmlReader resultsReader = reader.ReadSubtree();
while (resultsReader.Read())
{
    // process results node here
} 
```

返回后`ReadSubtree`，调用`reader.Read`将返回`</results>`EndElement 节点。因此，如果处理结果引发异常，您仍然在正确的位置。

如果`ReadSubtree`抛出异常，那当然是不可恢复的。这表明 XML 中存在错误，据我所知，使用`XmlReader`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T12:59:53.350

Jim 是对的，[ReadSubtree](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader.readsubtree.aspx)方法有效，尽管它有点繁琐：

```
if (xml.IsStartElement("Results"))
{
    // Be careful so that the cursor will be left after the closing tag of the 'Results' element, even if Results.FromXml throws.

    using (XmlReader resultsElement = xml.ReadSubtree())
    {
        resultsElement.Read();
        try 
        {
            results = Results.FromXml(resultsElement);
        }
        catch (Exception e)
        {
            Console.Error.WriteLine("Reading results xml went wrong {0}", e.Message);
        }
    }

    xml.ReadEndElement();
} 
```

# cassandra - 如何使用 Hector 更新多行

> ID：15549607
> 
> 赞同：0
> 
> 时间：2013-03-21T13:58:55.647
> 
> 标签：cassandra, hector

有没有一种方法可以使用列族模板更新 cassandra 数据库中的多行，例如提供键列表。目前我正在使用更新器 columnFamilyTemplate 循环遍历键列表并为每一行进行更新。我见过像 multigetSliceQuery 这样的查询，但我不知道它们在进行更新时的等价性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T11:31:49.400

ColumnFamilyTemplate 中没有实用方法允许您在一次调用中只传递带有突变列表的键列表。您可以使用 mutators 实现自己的。

这是有关如何在赫克托中执行此操作的基本代码

```
Set<String> keys = MY_KEYS;
Map<String, String> pairsOfNameValues = MY_MUTATION_BY_NAME_AND_VALUE;

Set<HColumn<String, String>> colums = new HashSet<HColumn<String,String>>();
for (Entry<String, String> pair : pairsOfNameValues.entrySet()) {
    colums.add(HFactory.createStringColumn(pair.getKey(), pair.getValue()));
}

Mutator<String> mutator = template.createMutator();
String column_family_name = template.getColumnFamily();
for (String key : keys) {
    for (HColumn<String, String> column : colums) {
        mutator.addInsertion(key, BASIC_COLUMN_FAMILY, column);
    }
}
mutator.execute(); 
```

那么它应该看起来像那样。这是插入的示例，请务必使用以下方法进行批量突变：

```
mutator.addInsertion 
mutator.addDeletion
mutator.addCounter
mutator.addCounterDeletion 
```

因为这些将立即执行而无需等待 mutator.execute()：

```
mutator.incrementCounter
mutator.deleteCounter
mutator.insert
mutator.delete 
```

最后一点：突变器允许您一次对多个列族的多行进行批量突变......这就是为什么我通常更喜欢使用它们而不是 CF 模板。对于使用 NoSQL 的“push-on-write”模式的功能，我有很多非规范化。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-21T16:55:25.150

您可以使用批量突变插入尽可能多的内容（在 thrift_max_message_length_in_mb 内）。请参阅[http://hector-client.github.com/hector//source/content/API/core/1.0-1/me/prettyprint/cassandra/model/MutatorImpl.html](http://hector-client.github.com/hector//source/content/API/core/1.0-1/me/prettyprint/cassandra/model/MutatorImpl.html)。

# php - 使用 PHP 在字符串中查找字符串并从中获取一些值

> ID：15549609
> 
> 赞同：-2
> 
> 时间：2013-03-21T13:58:58.297
> 
> 标签：php, regex, string, strpos

我有一个这样的字符串：

```
$string = 'this is some random text 
  <div class="myClass" title="myTitle">this is some random text
  again</div> and some more randome text'; 
```

现在我想从中删除此内容：

```
<div class="myClass" title="myTitle">this is some random text again</div> 
```

但同时我想存储class的值和title的值

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:22:47.567

这是您的示例具体显示的示例脚本：

```
<?php
  $string = 'this is some random text <div class="myClass" title="myTitle">
             this is some random text again</div> and some more randome text';
  preg_match('/class=\"(\w{1,})\"\stitle=\"(\w{1,})\"/i', $string, $matches);
  echo "Class: {$matches[1]}\n";
  echo "Title: {$matches[2]}\n";
?> 
```

输出：

```
marks-mac-pro:~ mstanislav$ php regex.php 
Class: myClass
Title: myTitle 
```

您可能必须针对其他用途进行调整和/或确保与 HTML 属性的命名约定兼容。

# typo3 - TYPO3：在 html 标记中更改了 lang 属性（HTML5样板样式）

> ID：15549613
> 
> 赞同：4
> 
> 时间：2013-03-21T13:59:02.913
> 
> 标签：typo3, typoscript, html5boilerplate

我使用此配置来遵循 HTML5 样板。

```
config{
    doctype = html_5

    doctype(
        <!doctype html>
        <!--[if lt IE 7 ]> <html lang="de" class="no-js ie6"> <![endif]-->
        <!--[if IE 7 ]>    <html lang="de" class="no-js ie7"> <![endif]-->
        <!--[if IE 8 ]>    <html lang="de" class="no-js ie8"> <![endif]-->
        <!--[if IE 9 ]>    <html lang="de" class="no-js ie9"> <![endif]-->
        <!--[if (gt IE 9)|!(IE)]><!-->
    )
    htmlTag_setParams = lang="de" class="no-js no-ie"><!--<![endif]--
} 
```

问题是当我有一个具有多种替代语言的站点时，该`lang`属性不会更新。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T14:11:09.543

使用常见的 TS 条件来设置`config.htmlTag_setParams`您可能用于切换语言的正确条件...

```
[globalVar = GP:L = 1]
  config.sys_language_uid = 1
  config.language = en
  config.htmlTag_setParams = lang="en" class="no-js no-ie"><!--<![endif]--
[GLOBAL] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-05T10:26:25.623

尝试：

```
config {

  htmlTag_stdWrap {
    setContentToCurrent = 1
    cObject = COA
    cObject {
        appendMeTemp = TEXT
        appendMeTemp.append = TEXT
        appendMeTemp.append.char = 10
        appendMeTemp.current = 1

        // IE7
        20 < .appendMeTemp
        20.addParams.class = ie ie7
        20.wrap = <!--[if IE 7 ]>|<![endif]-->

        // IE8
        30 < .appendMeTemp
        30.addParams.class = ie ie8
        30.wrap = <!--[if IE 8 ]>|<![endif]-->

        // IE9
        40 < .appendMeTemp
        40.addParams.class = ie ie9
        40.wrap = <!--[if IE 9 ]>|<![endif]-->

        60 < .appendMeTemp
        60.wrap = <!--[if (gte IE 9)|!(IE)]> # <![endif]-->
        60.wrap.splitChar = #
      }
   }         
} 
```

然后标准：

```
config {
    htmlTag_langKey = de
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-13T16:07:54.743

也许很久以前，但我会为谷歌人回答。除了@biesior 对条件的建议之外，您还可以为语言使用常量以避免不必要的重复代码。

设置：

```
config {
    doctype (
    <!--[if lt IE 7 ]> <html lang="{config.language}" class="no-js ie6"> <![endif]-->
    ...
    )
} 
```

常数：

```
[globalVar = GP:L = 1]
    config {
        language = en
    }
[global]
[globalVar = GP:L = 2]
    config {
        language = de
    }
[global]
... 
```

# eclipse - 在 jruby-complete 中运行 susy、compass 和 sass 的最干净的方法？

> ID：15549617
> 
> 赞同：1
> 
> 时间：2013-03-21T13:59:12.157
> 
> 标签：eclipse, ant, jruby, compass-sass, susy-compass

为什么 jruby 可以`require 'susy'`在我的指南针 config.rb 中找到，但`@import 'susy'`在 *.scss 文件中会产生问题：

```
 [java]     error Web Content/common/sass/base/foundation_de_DE.scss (Line 9: File to import not found or unreadable: susy.
        [java] Load paths:
        [java]   <removed>/Web Content/common/sass 
```

我现有的应用程序想开始在前端使用响应式设计。但是，在所有开发人员的机器、集成环境、性能环境和生产环境上安装 ruby​​ / compass 会扼杀主动​​权。

根据这个[问题](https://stackoverflow.com/q/1751479/176818)和这个[简化的教程](http://caueguerra.com/tutorial-using-sass-in-a-java-project)，我使用我们当前的 Ant build.xml 来使用 jRuby 制作一些目标。

[jar 中的 gems](http://blog.nicksieger.com/articles/2009/01/10/jruby-1-1-6-gems-in-a-jar/)技巧，这样我就不需要到处安装 ruby​​：每个[最新下载的 jruby-complete-1.6.8.jar jruby 自 2013.03.20 起有相对路径问题](https://github.com/jruby/jruby/issues/235)

```
java -jar jruby-complete-1.6.8.jar -S gem install -i ./susy susy  
jar uf jruby-complete-1.6.8.jar -C susy .  
java -jar jruby-complete-1.6.8.jar -S gem list 
```

构建过程中使用的 ant 目标：

```
 <target name="compass.compile">
     <java classname="org.jruby.Main" fork="true" failonerror="true" classpathref="jruby.classpath">  
                <arg line="${basedir}/compile.rb ${basedir} compile ${basedir}"/>   
            </java>
     </target> 
```

当用户保存 scss 文件时，基于 Eclipse 的 IDE 用于“自动编译”的 ant 目标。 [拥有 Eclipse 'auto-build' scss 文件的说明（从第 5 步开始）](http://wirelesswombat.com/2012/06/17/automatically-compling-sass-compass-in-eclipse-zend-studio/)

```
<target name="compass.dev">
        <path id="jruby.classpath">
            <fileset dir="../../../release/lib/arch/jruby">
                <include name="jruby-complete.jar"/>
            </fileset>            
        </path>
        <java classname="org.jruby.Main" fork="true" failonerror="true" classpathref="jruby.classpath">  
            <arg line="${basedir}/compile.rb ${basedir} compile ${basedir}"/>  
        </java>
    </target> 
```

最后，这是 ant 目标使用的 'compile.rb'：

```
Dir.entries(ARGV[0]).each do |lib|  
    $LOAD_PATH.unshift "#{ARGV[0]}/#{lib}/lib"  
end

require 'rubygems'
require 'compass' 
require 'susy'
require 'compass/exec'  

exit Compass::Exec::SubCommandUI.new([ARGV[1], ARGV[2], "-q"]).run! 
```

以及指南针使用的 config.rb：

```
 # Require any additional compass plugins here.  
# Set this to the root of your project when deployed:
require 'susy'

http_path = "./Web Content/"  
css_dir = "./Web Content/common/sass-output-css/"  
sass_dir = "./Web Content/common/sass/"
add_import_path  "./Web Content/sass"  
images_dir = "./Web Content/common/images/"  
javascripts_dir = "./Web Content/common/js/widgets"  
# To enable relative paths to assets via compass helper functions. Uncomment:  
#relative_assets = true 
```

最后，尝试在 scss 文件中使用 susy：

```
@import 'reset'; 
@import 'utilities';
@import 'baseColorVariables'; 
@import 'font';  
@import 'susy'; 

$total-columns: 12; 
$column-width: 4em; 
$gutter-width: 1em; 
$grid-padding: 1em;
.magic-container { @include container; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T15:03:12.647

*自 2013.03.20 起更新*，此方法有效。但这可能不是在“无红宝石”机器上获得 Susy / compass 的最干净的方法。有人有更清洁的东西吗？

找到了。compass 不在 sass 加载路径中，susy 实际上也不是在“jar 中的宝石”jruby 解决方案下运行时。谢谢 Henning Petersen，特别是[您的帖子](http://henningpetersen.com/post/7/integrating-compass-style-sass-into-tapestry)
：

> JRuby 对所有 Ruby 事物的基于文件的方式进行了相当出色的抽象，因此大多数事物在打包到 JAR 时仍然可以工作。JAR 中的文件的路径大致如下：/path/to/jar/gems.jar!file/in/jar/script.rb。JRuby 在使用 JAR 时保持相关文件和一切正常工作，但有一个很棒的 BUT：没有办法在 JAR 文件中执行目录列表这样的事情。没错，现在所有读取目录列表的东西都坏了。

我更改了 compass 的 frameworks.rb （不是粉丝），因此它的目录列表调用失败不会阻止 compass 将自身加载到 sass 加载路径中：

```
Compass::Frameworks.discover(:defaults)
Compass::Frameworks.register_directory(File.join(Compass.base_directory, 'frameworks/compass'))
Compass::Frameworks.register_directory(File.join(Compass.base_directory, 'frameworks/blueprint')) 
```

它将 *.scss 自动编译请求更改为：

```
Syntax error: File to import not found or unreadable: susy.
              Load paths:
                <removed>/Web Content/common/sass
                file:<removed>/release/lib/arch/jruby/jruby-complete.jar!/gems/compass-0.12.2/frameworks/compass/stylesheets
                file:<removed>/release/lib/arch/jruby/jruby-complete.jar!/gems/compass-0.12.2/frameworks/blueprint/stylesheets 
```

好的，现在我们需要进入加载路径。将此行添加到指南针`config.rb`不起作用，但我希望这样做：`add_import_path "../../../release/lib/arch/jruby/jruby-complete.jar!gems/susy-1.0.7/sass"`

[Henning Petersen 也发现了这一点，这又是因为使用 jruby jar](http://henningpetersen.com/post/7/integrating-compass-style-sass-into-tapestry) 更改了 compass`configuration/adapters.rb`和 Sass 的目录列表调用`importers/filesystem.rb`。更改所有这些文件比我所接受的更脏，而且关于 compass && sass 的帖子已经过时了。

因此，我将 sass 目录从 jar 中拉出，让指南针`add_import_path`按预期工作。到目前为止，我最干净的解决方案是手动附加到`gem/compass-0.12.2/lib/frameworks.rb`：

```
Compass::Frameworks.register_directory(File.join(Compass.base_directory, 'frameworks/compass'))
Compass::Frameworks.register_directory(File.join(Compass.base_directory, 'frameworks/blueprint')) 
```

然后将此行添加到 compass 项目的 config.rb （提供整个文件）：

```
 # Require any additional compass plugins here.  
# Set this to the root of your project when deployed:
require 'susy'

http_path = "./Web Content/"  
css_dir = "./Web Content/common/sass-output-css/"  
sass_dir = "./Web Content/common/sass/"
add_import_path  "./Web Content/susy-1.0.7-read-only"  
images_dir = "./Web Content/common/images/"  
javascripts_dir = "./Web Content/common/js/widgets"  
# To enable relative paths to assets via compass helper functions. Uncomment:  
#relative_assets = true 
```

这导致 RAD / eclipse builder scss auto-compile ant target 吐出：

```
compass.dev:
BUILD SUCCESSFUL
Total time: 16 seconds 
```

# joomla - Joomla 2.5 分页

> ID：15549618
> 
> 赞同：2
> 
> 时间：2013-03-21T13:59:12.677
> 
> 标签：joomla, pagination

我想为我的组件添加分页，我创建了一个带有查询的简单模型。我肯定错过了什么。我在这里还需要什么？

```
MODEL
jimport('joomla.application.component.modellist');
class PaieskaModelPradinis extends JModelList
{
    public function getListQuery() 
    {
    $db = JFactory::getDBO();
    $query = "SELECT * FROM #__content";
    $db->setQuery( $query );
    $db->query( $query );
    $result = $db->LoadObjectList();
    return $result;
    }
}

VIEW

jimport( 'joomla.application.component.view');
class PaieskaViewPradinis extends JView
{
    protected $items;
    protected $pagination;
    function display ($tpl = null)
    {
        $this->items = $this->get('ListQuery');
        $this->pagination = $this->get('Pagination');

        parent::display($tpl);
    }
}
TPL
foreach ($this->items as $item) {
    echo $item->title;
} 
```

编辑：

我编辑了一些代码，所以现在它几乎可以正常工作了。按钮显示（要显示的行数）不起作用。我想知道这部分是否可以以不同的方式完成？

```
 $limit      = JRequest::getVar('limit' , 25);
    $start      = JRequest::getVar('start' , 0);        
    $query      = "SELECT * FROM #__content LIMIT $start, $limit"; 
```

-

```
class PaieskaModelPradinis extends JModelList
{
    public function getItems() 
    {
        $db         = JFactory::getDBO();
        $limit      = JRequest::getVar('limit' , 25);
        $start      = JRequest::getVar('start' , 0);        
        $query      = "SELECT * FROM #__content LIMIT $start, $limit";
        $db->setQuery( $query );
        $db->query( $query );
        $lists = $db->LoadObjectList();

        return $lists;
    }
    function getPagination()
    {
        $main = JFactory::getApplication();
        $db         = JFactory::getDBO();
        $limit      = JRequest::getVar('limit' , 25);
        $limitstart = JRequest::getVar('limitstart', 0);

        $query      = "SELECT count(title) FROM #__content";
        $db->setQuery( $query );
        $total      = $db->loadResult();

                // include a pagination library

        jimport('joomla.html.pagination');
        $pagination = new JPagination($total, $limitstart, $limit);

        return $pagination;
    }
}

VIEW

jimport( 'joomla.application.component.view');
class PaieskaViewPradinis extends JView
{
    function display($tpl = null)
    {
        $this->items  = $this->get('items');
        $this->pagination = $this->get('pagination');

        parent::display($tpl);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T21:37:54.587

离开你的原始代码，而不是编辑后的版本。

getListQuery 方法仅构建您的数据库查询，因此您无需在此处执行查询。使用 com_weblinks 作为构建模型的示例：[https ://github.com/joomla/joomla-cms/blob/2.5.x/components/com_weblinks/models/category.php](https://github.com/joomla/joomla-cms/blob/2.5.x/components/com_weblinks/models/category.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-22T11:37:32.040

正确点击此链接[http://docs.joomla.org/J1.5:Using_JPagination_in_your_component](http://docs.joomla.org/J1.5:Using_JPagination_in_your_component)。我使用了 Joomla 分页。如果您正确遵循文档，您将能够轻松使用 Joomla 分页。顺便说一句，它非常简单。

# http - 如何获取 HTTP 响应的文件类型？

> ID：15549625
> 
> 赞同：0
> 
> 时间：2013-03-21T13:59:27.390
> 
> 标签：http, http-headers

有没有办法获取http响应的文件类型（扩展名）？解析http请求是不可行的，因为有时url中没有文件名，例如“GET www.stackoverflow.com”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T14:06:29.900

HTTP 不关心文件类型或文件扩展名，而是使用 MIME 类型来区分不同的内容类型。正如 shyam 所提到的，它由 Content-Type 标头表示，对于普通网页可能如下所示：

```
Content-Type: text/html; charset=utf-8 
```

一个例外情况是，当 HTTP 响应正在为应该存储在客户端的文件提供服务时，可能会包含 Content-Disposition 标头以指示文件名，从而指示文件扩展名：

```
Content-Disposition: attachment; filename="fname.ext" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:04:51.673

您可以尝试从`Content-Type`标题中猜测

# html - SVG图像在iPad的响应式网站上顶部和底部有巨大的差距

> ID：15549626
> 
> 赞同：1
> 
> 时间：2013-03-21T13:59:27.503
> 
> 标签：html, ios5, svg, responsive-design, image

如果浏览器支持，我想在我正在开发的网站上使用 SVG 徽标。所以我有`<img src="logo.gif" />`我的 HTML，然后如果浏览器支持 SVG，我将`src`属性交换为`logo.svg`.

这在我尝试过的所有设备上看起来都很棒，除了几年没有更新软件的第一代 iPad（它在 iOS 5.1.1 上）。基本上标志的顶部和底部有一个巨大的差距，我不知道为什么。在装有 iOS 6.0.2 的 iPhone 5 上看起来不错，所以我认为这是 iOS 5 及更低版本的问题。

## 我的 logo.svg 文件

```
<?xml version="1.0" encoding="utf-8"?>
<svg version="1.2" baseProfile="tiny" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
     x="0px" y="0px" viewBox="83.323 19.623 445 109" xml:space="preserve">
<polygon fill="#339846" points="121.805,77.839 124.066,86.185 125.199,94.741 125.481,103.087 125.128,110.724 124.42,117.372 
    123.572,122.604 122.936,126.068 122.654,127.271 126.826,121.333 127.815,125.364 129.229,117.159 129.867,109.379 
    129.937,102.097 129.512,95.308 128.806,89.297 127.887,83.992 126.826,79.608 125.905,76.215 125.836,76.285 125.623,76.496 
    125.34,76.709 124.846,76.992 124.278,77.345 123.572,77.558 122.724,77.77 121.805,77.839 "/>
<path fill="#FDCC09" d="M106.488,22.559l-0.14-0.496l1.344,0.354l1.201,0.426l1.201,0.564l1.061,0.637l0.991,0.707l0.919,0.708
    l0.85,0.707l0.777,0.707l0.141,2.052l-0.071,1.132l-0.142,0.989l-0.354,1.557l-0.069-0.071l-0.214-0.213l-0.423-0.283l-0.566-0.495
    l-0.777-0.637l-1.062-0.777l-1.272-0.92l-1.626-1.061l-0.708-2.333l-0.636-1.908L106.488,22.559z M89.121,39.501l0.638,2.191
    l0.424,0.284l0.425,0.284l0.425,0.211l0.425,0.283l0.495,0.283l0.424,0.212l0.424,0.213l0.425,0.212l-0.071-1.981l0.071-1.979
    l0.141-1.91l0.283-1.908l-0.849-0.92l-0.848-0.849l-0.778-0.778l-0.637-0.707l-0.565-0.565l-0.495-0.495l-0.283-0.283l-0.072-0.07
    l-0.563,2.97l0.069,2.758L89.121,39.501z M122.472,66.818l-0.496-2.687l-0.707-2.759l-1.131-2.546l-1.556-2.262l-0.213-0.283
    l-0.707-0.778l-0.92-1.273l-1.061-1.556l-1.062-1.837l-0.989-1.98l-0.707-2.052l-0.353-2.052l0.14-2.191l0.425-2.192l0.495-2.334
    l0.566-2.475l-1.203-0.99l-1.272-0.849l-1.272-0.849l-1.272-0.777l-1.273-0.708l-1.272-0.636l-1.272-0.566l-1.204-0.495l-1.06-0.425
    l-1.062-0.423l-0.849-0.354l-0.777-0.213l-0.708-0.211l-0.424-0.142l-0.354-0.142h-0.069l-0.777,1.697l-0.637,2.121l-0.637,2.475
    l-0.496,2.617l-0.353,2.546l-0.283,2.334l-0.142,1.98v1.344l1.273,0.565l1.273,0.495l1.201,0.495l1.202,0.424l1.202,0.496
    l1.131,0.495l1.062,0.637l0.99,0.637l1.556,1.414l1.273,1.697l1.201,1.909l0.92,1.838l0.707,1.769l0.566,1.484l0.283,0.99
    l0.141,0.353l0.707,1.981l0.989,1.98l1.274,1.839l1.413,1.838l1.557,1.696l1.697,1.557l1.696,1.414l1.768,1.273l0.072-0.99
    l0.07-1.697l-0.07-2.192L122.472,66.818z M136.039,50.604l-1.062-4.386l-1.696-4.242l-2.193-3.96l-2.545-3.749l-2.688-3.394
    l-2.757-3.04l-2.617-2.617l-2.263-2.122l-1.838-1.556l-1.273-0.989l-0.425-0.354l1.838,3.96l0.921,3.536l0.212,3.253l-0.212,2.97
    l-0.496,2.758l-0.637,2.546l-0.423,2.475l-0.142,2.334l0.354,2.051l0.777,2.051l0.918,1.98l1.133,1.838l1.062,1.556l0.919,1.272
    l0.708,0.779l0.212,0.282l1.626,2.475l1.132,2.688l0.707,2.899l0.354,2.758l0.141,2.475v2.051l-0.069,1.344l-0.072,0.496
    l4.668-4.385l3.254-4.455l1.908-4.598l0.777-4.526L136.039,50.604z M118.683,74.71l-1.485-1.204l-1.769-1.626l-1.838-1.908
    l-1.769-2.263l-1.556-2.547l-1.062-2.686l-0.069-0.354l-0.354-0.989l-0.496-1.486l-0.776-1.769l-0.921-1.909l-1.131-1.909
    l-1.344-1.768l-1.557-1.415l-0.989-0.636l-1.061-0.566l-1.061-0.496l-1.203-0.424l-1.2-0.425l-1.273-0.495l-1.273-0.495
    l-1.272-0.565l-1.272-0.708l-1.345-0.777l-1.272-0.92l-1.272-1.06l-1.274-1.273l-1.202-1.485l-1.131-1.768l-1.132-1.979v0.565
    l0.142,1.556l0.211,2.475l0.426,3.111l0.636,3.678l0.92,4.03l1.201,4.173l1.557,4.243l2.05,4.103l2.476,3.746l2.97,3.395
    l3.536,2.688l4.102,1.91l4.809,0.918l5.516-0.211l6.223-1.485l-0.352-0.283L118.683,74.71z"/>
<path fill="#339846" d="M181.058,59.69c-5.656,0-10.842,2.452-14.237,6.506h-0.189l5.47-26.307h-13.672l-9.336,46.579
    c-0.564,2.829-1.037,5.658-1.037,8.486c0,8.203,5.47,12.918,16.407,12.918c20.743,0,30.55-17.16,30.55-32.152
    C195.014,67.517,190.676,59.69,181.058,59.69z M167.292,97.595c-3.111,0-5.092-1.79-5.186-5.091
    c-0.095-1.981,0.188-3.584,0.471-5.092l0.849-3.771c1.603-8.016,6.412-13.013,11.314-13.013c4.148,0,6.034,3.489,6.034,8.015
    C180.774,86.657,175.118,97.595,167.292,97.595z M227.354,59.69c-16.406,0-27.533,13.106-27.533,29.136
    c0,11.409,7.826,19.047,19.519,19.047c16.029,0,27.533-12.353,27.533-29.23C246.872,68.177,239.705,59.69,227.354,59.69z
     M221.225,97.501c-4.714,0-7.354-3.584-7.354-8.958c-0.094-7.166,3.865-18.574,11.691-18.574c5.47,0,7.261,4.525,7.261,8.769
    C232.822,86.657,228.674,97.501,221.225,97.501z M290.997,39.89l-3.959,20.839c-1.981-0.755-4.432-1.038-6.317-1.038
    c-17.445,0-29.043,14.71-29.043,30.738c0,11.222,6.506,17.444,14.332,17.444c5.375,0,11.033-2.357,15.087-8.486h0.188l-0.66,7.449
    h12.447c0.188-5.468,1.037-12.068,2.168-17.916l9.334-49.03H290.997z M282.7,84.018c-1.791,8.768-6.601,12.917-10.466,12.917
    c-3.961,0-6.413-3.11-6.413-8.674c0-8.863,5.752-18.292,13.862-18.292c2.263,0,4.337,0.754,5.374,1.603L282.7,84.018z
     M351.155,60.729l-16.502,33.095c-6.128,12.258-11.597,20.65-17.727,26.402c-5.374,5.092-11.786,7.354-14.805,7.825l-3.016-11.598
    c2.168-0.659,5.186-1.791,7.825-3.676c3.112-2.17,5.752-4.904,7.449-8.017c0.472-0.659,0.472-1.226,0.283-2.264l-9.146-41.769
    h14.331l2.83,20.083c0.66,4.714,1.132,8.015,1.51,10.938h0.188c1.037-2.735,2.074-5.752,4.053-10.749l8.393-20.272H351.155
    L351.155,60.729z M380.384,79.68l12.823,27.156h-15.086l-8.108-19.707l-5.092,4.903l-2.829,14.804h-13.484l12.636-66.946h13.482
    l-7.542,40.073h0.188c1.414-1.791,2.829-3.583,4.149-5.28l11.787-13.955h16.688L380.384,79.68z M406.784,60.729h13.578l-8.77,46.107
    h-13.578L406.784,60.729z M423.286,47.339c0,4.809-3.679,7.638-8.015,7.638h-0.095c-3.677,0-6.506-2.546-6.506-6.6
    c0.095-4.622,3.677-7.732,7.826-7.732C420.457,40.644,423.286,43.284,423.286,47.339z M469.677,72.23
    c0,2.075-0.379,5.562-0.753,7.826l-5.093,26.779h-13.578l4.809-25.553c0.283-1.604,0.471-3.489,0.471-5.187
    c0-3.205-1.132-5.469-4.525-5.469c-4.432,0-9.618,5.562-11.504,15.747l-3.866,20.461h-13.578l5.847-31.117
    c1.131-5.845,1.886-10.937,2.452-14.99h12.068l-0.942,7.637h0.188c4.337-6.035,10.09-8.675,16.217-8.675
    C465.434,59.69,469.677,64.312,469.677,72.23z M514.748,39.89l-3.962,20.839c-1.979-0.755-4.431-1.038-6.318-1.038
    c-17.443,0-29.041,14.71-29.041,30.738c0,11.222,6.505,17.444,14.332,17.444c5.374,0,11.032-2.357,15.087-8.486h0.188l-0.659,7.449
    h12.445c0.188-5.468,1.037-12.068,2.169-17.916l9.334-49.03H514.748z M506.449,84.018c-1.792,8.768-6.601,12.917-10.466,12.917
    c-3.962,0-6.413-3.11-6.413-8.674c0-8.863,5.752-18.292,13.86-18.292c2.264,0,4.339,0.754,5.377,1.603L506.449,84.018z"/>
</svg> 
```

我的网站是响应式的，所以我没有在我的 HTML 或 SVG 中提及高度或宽度，然后我`img { max-width:100%; }`在我的 CSS 中进行了设置。有谁知道这可能是什么原因以及我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-27T17:16:57.860

我在我正在处理的一个网站上遇到了类似的问题。它与在 SVG 元素上设置宽度但没有高度有关，因此它不会使用合理的高度，而是将 SVG 的高度基于文档的主体。为了解决这个问题，您可以对 IOS 设备使用 1% hack。

```
svg{
  height: 1%;
} 
```

到目前为止，我已经在所有现代浏览器和设备上对此进行了测试，结果符合预期。

# php - JQuery Ajax 通过 URL 字符串发送

> ID：15549629
> 
> 赞同：0
> 
> 时间：2013-03-21T13:59:32.377
> 
> 标签：php, jquery, ajax

我似乎在发送 URL 字符串时遇到问题。URL 如下所示：

> [http://www.thewebsitehere.com/mf2/stuff/dirhere.asp?sid=&nm=&type=Publishing&mod=Publions::Article&mid=8F3A7027421F87F791&SiteID=B824D34CAB8727A06DEA3467&tier=4&id=8964A4D50BB59A0AD48594A](http://www.thewebsitehere.com/mf2/stuff/dirhere.asp?sid=&nm=&type=Publishing&mod=Publions::Article&mid=8F3A7027421F87F791&SiteID=B824D34CAB8727A06DEA3467&tier=4&id=8964A4D50BB59A0AD48594A)

它在 JS 中发送所有这些信息，但它只有在到达 php 页面后才看起来像这样：

> [http://www.thewebsitehere.com/mf2/stuff/dirhere.asp?sid=](http://www.thewebsitehere.com/mf2/stuff/dirhere.asp?sid=)

我的 Ajax 设置如下：

```
jQuery.ajax({
    type: "POST",
    dataType: "html",
    data: "type=add" + "&1A=" + pubName + "&1B=" + postID + "&1C=" + PostTitle + "&1D=" + timeStamp + "&1E=" + pdfLink + "&1F=" + imgLink + "&1G=" + fullArticleLink,
    url: "../wp-content/plugins/visual-editor-custom-buttons/js/wpDataSend.php",
    success: function(results) {
        if (results.indexOf("done") >= 0) {
            showNotifier(8000,'#43d32b','Title, Pub Name, Image, Date, PDF & Article link have been saved!');
        } else {
             showNotifier(8000,'#d32b2b','Could not save... Please try again!');
        }
    },
    error: function(XMLHttpRequest, textStatus, errorThrown) {
        console.log("Status: " + textStatus);
        console.log("Error: " + errorThrown);
        showNotifier(8000,'#d32b2b','Error: ' + textStatus + ' | ' + errorThrown);
    }
}); 
```

我正在从 PHP 页面收集数据，如下所示：

```
$newtype     = $_POST['type'];
$pubName     = $_POST['1A'];
$postID     = $_POST['1B'];
$PostTitle     = $_POST['1C'];
$timeStamp     = $_POST['1D'];
$pdfLink     = $_POST['1E'];
$imgLink     = $_POST['1F'];
$Fullarticle   = $_POST['1G']; 
```

我该如何纠正？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T14:02:01.000

您可以使用[正确的方式](http://api.jquery.com/jQuery.ajax/)发送帖子参数

```
jQuery.ajax({
   ...
   data: {param1 : value1, param2: value2} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:05:07.780

尝试[encodeURIComponent](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent)。这将转义 URL 中的某些字符以符合 UTF-8 标准。

```
var encodedURL = encodeURIComponent(str); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:05:29.833

将您的数据更改为：

```
data: {type: "add", 1A: "pubName"....//and so on}, 
```

您必须在值周围加上引号。

# java - HttpPost 中的 org.apache.http.client.ClientProtocolException

> ID：15549637
> 
> 赞同：1
> 
> 时间：2013-03-21T13:59:57.423
> 
> 标签：java, android, http-post

我尝试将一些字符串上传到服务器。当我尝试在服务器上上传时，在字符串中：

```
 HttpResponse response = httpclient.execute(httppost); 
```

我有错误 org.apache.http.client.ClientProtocolException。所有代码：

```
public void sendString(String stringToSend) {

    try {
        DefaultHttpClient httpclient = new DefaultHttpClient();
        httpclient.getCredentialsProvider().setCredentials(AuthScope.ANY, new UsernamePasswordCredentials(username, password));
        HttpPost httppost = new HttpPost(serverAddress);
        InputStreamEntity reqEntity = new InputStreamEntity( new ByteArrayInputStream(stringToSend.getBytes()), stringToSend.length());
        reqEntity.setContentType("application/xml");
        httppost.setEntity(reqEntity);
        HttpResponse response = httpclient.execute(httppost);
        if (response.getStatusLine().getStatusCode() != org.apache.http.HttpStatus.SC_OK) {
            Log.i("SEND", "not send "+response.getStatusLine());
        }else{
            Log.i("SEND", "send ok "+response.getStatusLine());
        }
    } catch (IOException e) {
        Log.w("IOException", e.toString() +" "+ e.getMessage());
    }        
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-07T19:38:25.807

这应该工作

```
public void sendString(String stringToSend) {

try {
    HttpParams httpParams=new BasicHttpParams();
    DefaultHttpClient httpclient = new DefaultHttpClient(httpParams);
    httpclient.getCredentialsProvider().setCredentials(AuthScope.ANY, new UsernamePasswordCredentials(username, password));
    HttpPost httppost = new HttpPost(serverAddress);
    InputStreamEntity reqEntity = new InputStreamEntity( new ByteArrayInputStream(stringToSend.getBytes()), stringToSend.length());
    reqEntity.setContentType("application/xml");
    httppost.setEntity(reqEntity);
    HttpResponse response = httpclient.execute(httppost);
    if (response.getStatusLine().getStatusCode() != org.apache.http.HttpStatus.SC_OK) {
        Log.i("SEND", "not send "+response.getStatusLine());
    }else{
        Log.i("SEND", "send ok "+response.getStatusLine());
    }
} catch (IOException e) {
    Log.w("IOException", e.toString() +" "+ e.getMessage());
} 
```

}

# java - 当我应该关闭从 Tapestry 中的 HibernateSessionManager 获取的会话时？

> ID：15549638
> 
> 赞同：0
> 
> 时间：2013-03-21T14:00:00.357
> 
> 标签：java, hibernate, session, tapestry

`HibernateSessionManager`我什么时候应该关闭从Tapestry中获取的会话？

一段代码。考虑一些处理`HibernateSessionManager`对象的方法：

```
public void foo(final HibernateSessionManager hsm) {
    Session session = hsm.getSession(); 
```

* * *

第一种情况：会话仅用于从数据库中获取数据：

```
session.createQuery("from SomeTable ... blablabla").list(); 
```

我必须手动关闭`session`( ) 吗？`session.close();`

* * *

第二种情况：会话也用于保存/更新结果：

```
session.saveOrUpdate(obj); 
```

`commit`仅对`hsm`object:就足够了`hsm.commit();`，还是我也应该这样做`session.close();`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T15:07:11.737

我已经在[这里](https://stackoverflow.com/questions/15550464/tapestry-services-implemetation-with-hibernate-usage/15551083#15551083)回答过了。

要回答另一部分，您不必担心关闭会话，因为只要您使用`HibernateSessionManager`.

```
try {
   do_stuff(hibernateSessionManager.getSession());
   hibernateSessionManager.commit();
}catch(Exception ex){
   hibernateSessionManager.abort();
} 
```

# javascript - HighStock 导出呈现不正确的标题和导航器系列

> ID：15549641
> 
> 赞同：0
> 
> 时间：2013-03-21T14:00:03.943
> 
> 标签：javascript, highcharts, highstock

我们有一个包含 4 组数据的图表，每次只显示一个。所有 4 个系列都已添加到图表中，只是 3 个不可见。要查看另一个系列，请在图例中单击它。现在该系列可以观看，但其他 3 个则不可见。

这是我们正在做的一个示例：[jsFiddle](http://jsfiddle.net/wergeld/rSdPW/1/)。请注意，它没有启用导出按钮 - 请参阅下面的第 3 项。

我们允许用户导出图表。对此进行测试，我们发现了 2 个问题（第三个刚刚在尝试为这篇文章制作 jsFiddle 时出现）：1）通过`rangeSelector`按钮更改范围后，它会正确呈现，但在导出时，“突出显示”范围选择是这是图表最初加载时的默认选择。`rangeSelector`通过从导出中删除来解决这个问题。这不是一个真正理想的解决方案，但它隐藏了错误。以下是我们的做法：

```
 exporting: {
     chartOptions: {
         rangeSelector: {
             enabled: false
         }
     },
     buttons: {
         enabled: false
     },
     filename: 'UnempRate',
     width: 590
 } 
```

2）当更改可见的系列时，我们还将导航器系列设置为它并更新图表标题（我们在图表底部有）。当用户导出数据时，主图表列出了正确的系列，但导航器会返回到原始“加载”系列，图表标题也是如此。

3）当尝试创建一个jsFiddle时，我得到错误，`events: legendItemClick`只有`chartTrend`当我将导出按钮设置为启用时才定义：

```
 navigation: {
     buttonOptions: {
         enabled: false
     }
 } 
```

所以我不知道如何让你们看到这里的问题。

基本上，我们希望导航器系列和图表标题与用户在`legendItemClick`选择导出图表时选择的内容相匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T13:49:20.597

这些问题是导出模块如何工作的结果。

基本上，它在隐藏元素中创建了一个全新的图表。这个新图表总是使用 SVG 渲染器（因此不支持 SVG 的浏览器，如旧的 IE 或 Androids 2.x 会生成无法显示的代码）。然后 Highcharts 获取生成的 SVG 代码并将其发送到 exportin 服务器。但是，这个新图表是从选项创建的，因此您在运行时更改的几乎所有内容都消失了。

如果您不必支持 Androids 2.x 或 IE<9，您可以调用 chart.getSVG 并将 POST 请求直接发送到导出服务器。这是示例请求有效负载：

```
------WebKitFormBoundaryiBhRpBiiTfKjcspB
Content-Disposition: form-data; name="filename"

UnempRate
------WebKitFormBoundaryiBhRpBiiTfKjcspB
Content-Disposition: form-data; name="type"

image/png
------WebKitFormBoundaryiBhRpBiiTfKjcspB
Content-Disposition: form-data; name="width"

590
------WebKitFormBoundaryiBhRpBiiTfKjcspB
Content-Disposition: form-data; name="scale"

2
------WebKitFormBoundaryiBhRpBiiTfKjcspB
Content-Disposition: form-data; name="svg"

<svg xmlns:xlink="http://www.w3.org/1999/xlink" ...and so on to the end of SVG code
------WebKitFormBoundaryiBhRpBiiTfKjcspB-- 
```

但是如果您必须支持尽可能多的浏览器，您应该存储导航器系列、活动范围选择器按钮等信息，并将它们作为第二个参数传递给 exportChart 方法：[http ://api.highcharts.com/highcharts# Chart.exportChart()](http://api.highcharts.com/highcharts#Chart.exportChart())

# windows - 手动删除和脚本删除的区别？！(bat 或 vbs)

> ID：15549642
> 
> 赞同：2
> 
> 时间：2013-03-21T14:00:04.987
> 
> 标签：windows, batch-file, vbscript, delete-file

我目前正在尝试在运行程序时自动删除程序文件。如果我在 Windows 中手动删除文件，程序会识别更改，但如果我使用脚本删除文件则*不会。*

但是，所有文件都会被删除。我尝试了一个 bat 和一个 vbs 脚本，手动和/或通过程序内部的调用执行脚本 - 总是得到相同的结果：识别手动删除，不识别脚本删除。我应该提到的是，我可以从 LUA 4.0 调用一个脚本/可执行文件，它会自动删除文件，这对我来说很重要。

如果我在 Windows 中删除文件到底会发生什么，它与通过脚本删除有什么不同？有没有办法 100% 模拟 Windows 删除程序？还是有一些我不知道的秘密“文件夹已更新”标志？自然文件夹属性`DateLastAccessed`并`DateLastModified`得到更新。

为了完整起见，这里是我的脚本（它们删除任何现有的适合`*Random*.level`并删除空文件夹的文件）：

蝙蝠：

```
REM delete all "Random" maps
del /S *Random*.level
REM remove empty folders
for /f "delims=" %%d in ('dir /S /B /A:D ^| sort /r') do rd "%%d" 
```

VBS：

```
' create shell
Set objShell = CreateObject("Wscript.Shell")
' get current path
strPath = objShell.CurrentDirectory
' create file system object
Set oFSO = CreateObject("Scripting.FileSystemObject")
' delete all random level files
ProcessSubFolders oFSO.GetFolder(strPath)

Sub ProcessSubFolders(oFolder)
    ' get all files in the folder
    Set cFiles = oFolder.Files
    ' for every file
    For Each oFile In cFiles
        ' check if it's a level file and has "Random" in its name
        If Right(oFile.Name, Len(".level")) = ".level" And InStr(oFile.Name, "Random") Then
            ' if true delete it
            oFile.Delete
        End If
    Next

    ' process all subfolders in the same manner
    For Each oSubFolder In oFolder.SubFolders
        ProcessSubFolders oSubFolder
    Next

    ' if folder is empty
    If oFolder.SubFolders.Count = 0 And oFolder.Files.Count = 0 Then
        ' delete it
        oFolder.Delete 
    End If
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T14:57:38.400

该`Shell.Application`对象能够执行文件系统操作，就好像它们是[手动启动](https://stackoverflow.com/a/15120431/1683264)的一样。例如，该`Folder.CopyHere`方法允许通过将文件作为[Windows 压缩文件夹](https://stackoverflow.com/a/15028897/1683264)复制到 zip 文件中来创建 zip 文件。您会看到文件复制进度条和所有内容。

因此，通过扩展，使用相同的`Shell.Application`对象执行文件删除的行为与手动文件删除的行为相同。这是我为测试我的理论而编写的一个简短的 JScript 脚本：

```
var shl = new ActiveXObject("Shell.Application");
var items = shl.NameSpace("c:\\users\\me\\desktop").Items();

for (var i=0; i<items.Count; i++) {
    if (/\.tmp$/i.test(items.Item(i).Name)) {
        WSH.Echo('deleting ' + items.Item(i).Name);
        items.Item(i).InvokeVerb('delete');
    }
} 
```

...从我的桌面上删除 *.tmp。不幸的是，对于它遇到的每个 .tmp 文件，我都会收到一个确认窗口对话框，询问“您确定要将此文件发送到回收站吗？” 经过粗略调查，[我看到的唯一解决方法](https://stackoverflow.com/a/12409765/1683264)是，不是删除文件，而是将文件移动到临时文件夹，然后删除该文件夹。我不确定这是否会满足您的条件，但我认为值得尝试。

# c++ - POD 就地初始化

> ID：15549646
> 
> 赞同：2
> 
> 时间：2013-03-21T14:00:10.193
> 
> 标签：c++, c++03

我不认为“到位”是正确的术语，但我缺少一个更好的术语。

我有一个 POD，比方说：

```
struct My {
    int a;
};
//and suppose a operator<< to stream is also defined 
```

我可以正确使用它：

```
My my = {3};
std::cout << my << std::endl; 
```

我想知道我是否可以在下面做同样的事情，但不使用辅助函数：

```
template <typename ANY>
My helper(ANY value) {
    My r = {value};
    return r;
}
std::cout << helper(3) << std::endl; 
```

我正在寻找与构造函数相同的东西，但由于我有一个 POD，所以我无法创建构造函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:18:23.543

你可以这样做：

```
struct My {
    int a;
    int b;
    int c;
    float d;
};

void somefunc() {
   cout << (My){1, 2, 3, 4.5} << endl;
} 
```

# android - 电脑上的最大安卓虚拟设备数量

> ID：15549650
> 
> 赞同：0
> 
> 时间：2013-03-21T14:00:28.497
> 
> 标签：android

一台 PC 上可以同时运行多少个 android 虚拟设备。和电脑配置有区别吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T14:50:20.713

根据[这里的android模拟器文档](http://developer.android.com/tools/help/emulator.html)

> 控制台端口号必须是介于 5554 和 5584 之间的偶数，包括 5554 和 5584。+1 也必须是免费的，并将保留给亚行。

也在另一个文档[中](http://developer.android.com/tools/devices/emulator.html)

> 一个模拟器实例占用一对相邻的端口：一个控制台端口和一个 adb 端口。端口号相差 1，adb 端口具有更高的端口号。在给定机器上运行的第一个模拟器实例的控制台使用控制台端口 5554 和 adb 端口 5555。后续实例使用端口号增加 2 — 例如，5556/5557、5558/5559 等。最多 16 个并发仿真器实例可以运行一个控制台工具。

所以我们可以说我们最多可以启动16个模拟器。

# c# - 从新创建的窗口访问主窗口数据上下文

> ID：15549654
> 
> 赞同：2
> 
> 时间：2013-03-21T14:00:31.547
> 
> 标签：c#, wpf, window, datacontext

在我的 MainWindow 中，我创建了一个包含不同设置的类的新实例。设置类的参数后，我将datacontext =设置为该类。

```
public partial class MainWindow : Window
{

 private MeasConSettings mMeasConSettings = new MeasConSettings();

  public MainWindow()
  {
    InitializeComponent();
    DataContext = mMeasConSettings;
  }

  private void MenuComm_Click(object sender, RoutedEventArgs e)
  {// See code below}

} 
```

现在我还有一个打开新窗口的功能，这个窗口包含一个文本框，其文本应该绑定到主窗口的数据上下文。

```
 private void MenuComm_Click(object sender, RoutedEventArgs e)
    {
        FrmSettings newWindow = new FrmSettings();
        newWindow.DataContext = mMeasConSettings;
        newWindow.TxtComm.Text = mMeasConSettings.CommSettings;
        newWindow.Show();
    } 
```

此代码使用正确的内容从 newWindow 填充文本框，但它没有得到绑定属性，因为在更改文本框中的文本（新创建的窗口中的 TxtComm）后 datacontext 没有得到更新。

文本框的 XAML 代码示例：

```
<TextBox Grid.Row="1" Grid.Column="3" Margin="2,0"  Name="TxtComm" DataContext="{Binding Path=CommSettings, UpdateSourceTrigger=PropertyChanged}" /> 
```

“CommSettings”是 MeasConsettings 类的成员

```
public class MeasConSettings
{
    private string mCommSettings;

    public string CommSettings
    {
        get
        {
            return mCommSettings;
        }
        set
        {
            mCommSettings = value;
        }
    }

    public MeasConSettings()
    {
        CommSettings = "Com5:19200,8,n,1";
    }
} 
```

我的问题是如何在我的newWindow（按下按钮后创建）中调整值mMeasConSettings.CommSettings（在我的MainWindow中定义），如果我更改我的newWindow中的文本框值，存储在mMeasConSettings.CommSettings中的值也应该被改变。

PS：我是WPF的新手，所以欢迎任何建议！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T14:09:20.543

正如我在评论中所写，您需要将您的`Text`属性绑定到您要更新`TextBox`的属性。`DataContext`因此，您的 XAML 应该类似于：

```
<TextBox ... Text="{Binding CommSettings, Mode=TwoWay}" /> 
```

请注意，我将 的`Text`属性绑定`TextBox`到`CommSettings`您的`DataContext`. 你`C#`的点击事件代码应该是：

```
private void MenuComm_Click(object sender, RoutedEventArgs e)
{
    FrmSettings newWindow = new FrmSettings();
    newWindow.DataContext = mMeasConSettings;
    newWindow.Show();
} 
```

我们只需要在`DataContext`这里设置。请注意，将`DataContext`传递给子元素，因此除非专门设置为其他内容，否则 将与其父元素`TextBox`相同。`DataContext`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:03:00.177

使用静态属性：

```
class Demo
{
    public static string SomeSettings {get;set;}
    private onLoad()
    {
        SomeSettings=... //Init here
    }
} 
```

在其他文件中：

```
Demo.SomeSettings=.... 
```

# asp.net - radGrid editForm userControl 内的异步回发

> ID：15549656
> 
> 赞同：2
> 
> 时间：2013-03-21T14:00:32.427
> 
> 标签：asp.net, telerik, asp.net-ajax

我的页面 (productionEntry.aspx) 有一个 radGrid，其中包含一个 radAjaxManager，其设置允许异步回发 radGrid：

```
<telerik:RadAjaxManager ID="RadAjaxManager1" runat="server">
    <AjaxSettings>
        <telerik:AjaxSetting AjaxControlID="RadGridProductionOrders">
            <UpdatedControls>
                <telerik:AjaxUpdatedControl ControlID="RadGridProductionOrders" />
            </UpdatedControls>
        </telerik:AjaxSetting>
    </AjaxSettings>
</telerik:RadAjaxManager> 
```

所以 RadGridProduictionOrders 异步回发，这很好。

然而，现在 radGrid 的 editForm 是一个弹出式用户控件，我想要完成的是异步回发一些用户控件的内容。我曾尝试将 radAjaxManagerProxy 和 radAjaxPanel 一起使用，并在用户控件中单独使用。每次页面根据 radAjaxManager 中的设置从 productionEntry.aspx 页面异步回发。

这是用户控件中 radAjaxManagerProxy 的标记。我想发回的内容在 Panel1 内：

```
<telerik:RadAjaxManagerProxy ID="RadAjaxManagerProxy1" runat="server">
<AjaxSettings>
    <telerik:AjaxSetting AjaxControlID="Panel1">
        <UpdatedControls>
            <telerik:AjaxUpdatedControl ControlID="Panel1" />
        </UpdatedControls>
    </telerik:AjaxSetting>
</AjaxSettings> 
```

我需要如何设置页面和/或用户控件来完成我的需要？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T12:58:53.360

我就这个问题联系了telerik，他们的回答是不可能：

*尽管编辑表单位于弹出窗口中，但它仍然是 RadGrid 的一部分。在服务器上，弹出控件作为 RadGrid 的一部分呈现，因此它是 RadGrid 的一个组成部分。记住这一点并知道 RadGrid 是一个复合控件，应该作为一个整体进行更新，恐怕您的要求无法通过 RadAjaxManager 实现。回发将始终由 RadGrid 进行，您需要始终更新 RadGrid，这将关闭并重置编辑表单中的值。*

希望这会帮助其他人在路上......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-22T20:55:54.820

我知道这已经有一段时间了，但这就是我构建和所做的：

我有一个网格作为数据输入面板 - 在编辑模式下有 3 个固定行。很有可能业务会回来并要求对相同数据进行“显示历史”视图，因此我想要构建一个网格（而不是固定表）以保护自己免受更改。

我没有使用 GridBoundColumn，而是使用了带有 edititemtemplate 的 GridTemplate 列，如下所示：

```
<EditItemTemplate>
    <telerik:RadTextBox runat="server" ID="Address1" Text='<%#Bind("Address1") %>' OnTextChanged="Address1_OnTextChanged" AutoPostBack="True"></telerik:RadTextBox>
    <asp:UpdatePanel runat="server"><Triggers><asp:AsyncPostBackTrigger ControlID="Address1"/></Triggers></asp:UpdatePanel>
</EditItemTemplate> 
```

这使我可以对每行、每个文本框进行简单的数据绑定回调，而不会对前端造成任何图形更改或中断用户体验。这会在页面上产生额外的开销，但应该可以忽略不计。

代码隐藏如下：

```
protected void Address1_OnTextChanged(object sender, EventArgs e)
    {
        //Find which row you're on
        var id = ((sender as RadTextBox).Parent.Parent as GridDataItem).GetDataKey("ID");
        //Do whatever you need to do with the data by using the ID to match.
        myList[id].Address1 = (sender as RadTextBox).Text;
    } 
```

编辑：我正在使用监督演示者模式，其中允许视图在不涉及其他逻辑的情况下直接与模型对话。如果您正在做不同的事情，这可能需要额外的开销。

# image-processing - opengl es 1.1 执行大于或小于操作

> ID：15549660
> 
> 赞同：1
> 
> 时间：2013-03-21T14:00:42.413
> 
> 标签：image-processing, opengl-es-1.1

我正在使用 OpenGL ES 1.1 上的图像处理应用程序，我需要找到小于某个值的像素数（比如说 < 0.4 ）并找到平均值。

我想到的方法是，将纹理加载到 GPU，如果像素值大于 0.4，则创建一个相同大小的 FBO，在 FBO 处绘制 1，将视口设置为 1 像素并渲染，该值是平均值。

我找不到做大于或小于操作的方法。有人可以让我知道这种方法是否可行，并且是一种在 OpenGL ES 1.1 中做不到操作的方法。

谢谢

# sql - SQL：为现有表中的其他列创建具有不同值和最大值/最小值的新表

> ID：15549664
> 
> 赞同：1
> 
> 时间：2013-03-21T14:01:01.663
> 
> 标签：sql, sql-server

示例：假设原始表包含以下值

```
AcctNbr StatusDate
------------------
123     01/01/2012    
123     01/01/2013
123     12/11/2011
987     01/01/2009 
```

SQL 将创建一个新表，其中包含

```
AcctNbr EarliestStatusDate LatestStatusDate
-------------------------------------------
123     12/11/2011         01/01/2013
987     01/01/2009         01/01/2009 
```

我正在寻找一种有效的方法来做到这一点。我有一个有效的方法，但它需要很长的时间。有没有人有任何优化提示。任何帮助将不胜感激。

```
SET NOCOUNT ON

DROP TABLE loopTemp
DROP TABLE reportTemp

CREATE TABLE loopTemp
(   ID int IDENTITY(1, 1) NOT NULL, 
    AcctNbr varchar(50),
)

CREATE TABLE reportTemp
(
    AcctNbr varchar(50),
    EarliestStatus Date,
    LatestStatus Date 
)

INSERT INTO loopTemp
SELECT DISTINCT AcctNbr
FROM AutoStatusHistory 

DECLARE @COUNTER AS INT
SET @COUNTER = 1

DECLARE @MAX AS INT
SET @MAX = (SELECT MAX(ID) FROM loopTemp)

WHILE @COUNTER < @MAX BEGIN 
    DECLARE @ACCOUNT_NUMBER AS varchar(50)
    SET @ACCOUNT_NUMBER = 
        (SELECT AcctNbr FROM loopTemp WHERE ID = @COUNTER)

    DECLARE @EARLIESTSTATUSDATE AS DATE
    SET @EARLIESTSTATUSDATE =   (SELECT MIN(NewStatusDate)
                                 FROM AutoStatusHistory 
                                 WHERE AcctNbr = @ACCOUNT_NUMBER)

    DECLARE @LATESTSTATUSDATE AS DATE
    SET @LATESTSTATUSDATE =     (SELECT MAX(NewStatusDate)
                                 FROM AutoStatusHistory 
                                 WHERE AcctNbr = @ACCOUNT_NUMBER)

    INSERT INTO reportTemp
    VALUES (@ACCOUNT_NUMBER, @EARLIESTSTATUSDATE, @LATESTSTATUSDATE)

    IF (@COUNTER % 1000) = 0 BEGIN
        PRINT @COUNTER 
    END -- IF

    SET @COUNTER = @COUNTER + 1
END -- WHILE 

DROP TABLE loopTemp 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:03:54.420

除非我遗漏了什么，否则这应该非常简单：

```
SELECT AcctNbr, MIN(StatusDate) AS EarliestStatusDate, 
    MAX(StatusDate) AS LatestStatusDate
FROM myTable
GROUP BY AcctNbr 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:09:48.193

您可以使用

```
SELECT *
INTO TableName
FROM (
SELECT AcctNbr, MIN([Status Date]) AS EarliestStatusDate, 
    MAX([Status Date]) AS LatestStatusDate
FROM myTable
GROUP BY AcctNbr
) RequiredData 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:06:14.043

您似乎正在使用 SQL Server。为此，您可以执行以下操作：

```
select AcctNbr, min(StatusDate) as EarliestStatusDate,
       max(StatusDate) as LatestStatusDate
into ReportTemp
from AutoStatusHistory
group by AcctNbr 
```

该`into`语句将结果保存到表中。您可能希望使用实际的临时表，语法如下：

```
into #ReportTemp 
```

# ibm-mobilefirst - 在 5.0.6 中构建所有并部署错误

> ID：15549667
> 
> 赞同：0
> 
> 时间：2013-03-21T14:01:14.203
> 
> 标签：ibm-mobilefirst

build all and deploy 5.0.6 中的错误——

创建一个空的worklight项目，构建所有并depoy......然后控制台中的错误作为打击......

提前致谢...

```
[2013-03-21 21:54:00]             Worklight Server started successfully on localhost:8080
[2013-03-21 21:54:00]             Activating Worklight project: SDMobileBank...
[2013-03-21 21:54:06]             Activation failed. Bundle didn't start:D:\Worklight_workspace\SDMobileBank\bin\SDMobileBank-customization.jar
[2013-03-21 21:54:32]             Activating Worklight project: SDMobileBank...
[2013-03-21 21:54:32]             Worklight Server stopped successfully on localhost:8080
[2013-03-21 21:54:34]             Worklight Server started successfully on localhost:8080
[2013-03-21 21:54:41] FWLSE2001I: Detected more than one IP address. Using 192.168.25.45 as the public IP address of the Worklight Server. You can set a different IP address in worklight.properties.
[2013-03-21 21:54:44] FWLSE3005I: Application raw reports are disabled.
[2013-03-21 21:54:44] FWLST0010I: ====== Started server for project SDMobileBank-project-customization; Worklight version=5.0.6.20130307-1147
[2013-03-21 21:54:44]             Activation done.
[2013-03-21 21:54:48]             Persistency data access problem
                                  com.worklight.core.exceptions.DefaultExceptionHandler.handleException(DefaultExceptionHandler.java:50)
                                  com.worklight.core.tasks.TaskThread.run(TaskThread.java:100)
[2013-03-21 21:54:51]             Starting build process: application 'SDMobileBank', all environments
[2013-03-21 21:54:51] FWLSE2001I: Detected more than one IP address. Using 192.168.25.45 as the public IP address of the Worklight Server. You can set a different IP address in the application descriptor files of your applications.
[2013-03-21 21:54:53]             Application 'SDMobileBank' with all environments build finished.
[2013-03-21 21:54:53]             Deploying application 'SDMobileBank' with all environments to Worklight Server...
[2013-03-21 21:54:53]             Persistency data access problem
                                  com.worklight.core.exceptions.DefaultExceptionHandler.handleException(DefaultExceptionHandler.java:50)
                                  com.worklight.core.tasks.TaskThread.run(TaskThread.java:100)
[2013-03-21 21:54:56]             Application 'SDMobileBank' deployed successfully with all environments
[2013-03-21 21:54:59]             Persistency data access problem
                                  com.worklight.core.exceptions.DefaultExceptionHandler.handleException(DefaultExceptionHandler.java:50)
                                  com.worklight.core.tasks.TaskThread.run(TaskThread.java:100)
[2013-03-21 21:55:04]             Persistency data access problem
                                  com.worklight.core.exceptions.DefaultExceptionHandler.handleException(DefaultExceptionHandler.java:50)
                                  com.worklight.core.tasks.TaskThread.run(TaskThread.java:100)
[2013-03-21 21:55:09]             Persistency data access problem
                                  com.worklight.core.exceptions.DefaultExceptionHandler.handleException(DefaultExceptionHandler.java:50)
                                  com.worklight.core.tasks.TaskThread.run(TaskThread.java:100)
[2013-03-21 21:55:14]             Persistency data access problem
                                  com.worklight.core.exceptions.DefaultExceptionHandler.handleException(DefaultExceptionHandler.java:50)
                                  com.worklight.core.tasks.TaskThread.run(TaskThread.java:100) 
```

* * *

有时，错误..

```
[2013-03-21 21:43:12]             user lacks privilege or object not found: 
T0.MULTILANGUAGE_MESSAGES {SELECT t0.ID, t0.ACTION, t0.CREATED_TIME, t0.DOWNLOAD_LINK, t0.ENV, t0.GADGET_NAME, t0.MESSAGE, t0.MULTILANGUAGE_MESSAGES, t0.VERSION FROM APP_VERSION_ACCESS_DATA t0 
WHERE (t0.GADGET_NAME = ? AND t0.ENV = ? AND t0.VERSION = ?)} 
[code=-5501, state=42501]; nested exception is 
<openjpa-1.2.2-r422266:898935 nonfatal general error> 
org.apache.openjpa.persistence.PersistenceException: 
user lacks privilege or object not found: T0.MULTILANGUAGE_MESSAGES {
SELECT t0.ID, t0.ACTION, t0.CREATED_TIME, t0.DOWNLOAD_LINK, t0.ENV, t0.GADGET_NAME, t0.MESSAGE, 
t0.MULTILANGUAGE_MESSAGES, t0.VERSION FROM APP_VERSION_ACCESS_DATA t0 WHERE (t0.GADGET_NAME = ? AND t0.ENV = ? AND t0.VERSION = ?)} [code=-5501, state=42501] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T15:26:55.493

数据库架构在 v5.0.6 中已更改。这应该更清楚，并将得到解决。Developer Edition 不支持数据库升级。

要解决此问题：

1.  关闭日食
2.  删除位于 Eclipse 工作区文件夹中的 WorklightServerHome 文件夹。
3.  重启 Eclipse
4.  构建您的应用程序。

该操作现在应该没有错误地通过。

# android - AIR/as3 阶段键侦听器覆盖输入文本字段

> ID：15549669
> 
> 赞同：2
> 
> 时间：2013-03-21T14:01:18.153
> 
> 标签：android, ios, actionscript-3, air, keylistener

我正在使用 Adob​​e Flash Builder 4.6 构建一个移动 AIR 应用程序（Android 和 IOS），我遇到了这个烦人的问题。

因为我想在 Android 设备上“捕捉”返回键，所以我将以下代码添加到我的主类中：

```
stage.addEventListener(KeyboardEvent.KEY_DOWN, keyDown);

private function keyDown(k:KeyboardEvent):void {    
if(k.keyCode == Keyboard.BACK) {
    backClicked(); // function handling the back-action, not important 
    k.preventDefault();
} 
```

现在在其他地方 - 嵌套在某些类中 - 我有一个文本字段：

```
TF = new TextField();
TF.type = TextFieldType.INPUT; 
```

但是当我将焦点放在文本字段上时，确实会出现软键盘，但我无法输入单个字符。当我禁用 keylistener 时：没问题。

似乎听众正在覆盖我的输入字段。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T19:08:37.740

我还为我的移动应用程序实现了后退按钮功能，但我过去只在我的特定视图被激活时注册 keydown 事件，并在视图被停用时删除注册的事件。

```
in <s:view ....... viewActivate ="enableHardwareKeyListeners(event)" viewDeactivate="destroyHardwareKeyListeners(event)">
// add listener only for android device
if (Check for android device) {
    NativeApplication.nativeApplication.addEventListener(KeyboardEvent.KEY_DOWN, handleHardwareKeysDown, false, 0);
    NativeApplication.nativeApplication.addEventListener(KeyboardEvent.KEY_UP, handleHardwareKeysUp, false, 0); 
    this.setFocus();                    
}

private function destroyHardwareKeyListeners(event:ViewNavigatorEvent):void
{
    if (NativeApplication.nativeApplication.hasEventListener(KeyboardEvent.KEY_DOWN))
        NativeApplication.nativeApplication.removeEventListener(KeyboardEvent.KEY_DOWN, handleHardwareKeysDown);
    if (NativeApplication.nativeApplication.hasEventListener(KeyboardEvent.KEY_UP))
        NativeApplication.nativeApplication.removeEventListener(KeyboardEvent.KEY_UP, handleHardwareKeysUp);
}

private function handleHardwareKeysDown(e:KeyboardEvent):void
{
    if (e.keyCode == Keyboard.BACK) {
        e.preventDefault();
        // your code
    } else {

    }
}           

private function handleHardwareKeysUp(e:KeyboardEvent):void
{
    if (e.keyCode == Keyboard.BACK)
        e.preventDefault();
} 
```

希望这可以帮助你。

# .net - 当 UI 线程正确处理的异常导致 Windows 窗体应用程序安静退出时，这意味着什么？

> ID：15549678
> 
> 赞同：0
> 
> 时间：2013-03-21T14:01:40.103
> 
> 标签：.net, winforms, exception, asynchronous, ui-thread

我的理解是，在 Windows 窗体应用程序中，如果 UI 线程抛出异常并且不由用户代码处理，则应用程序将以用户显而易见的方式崩溃。（屏幕上将出现一条消息，指示应用程序已崩溃，或窗口将冻结，或两者兼而有之）

现在考虑以下代码：

```
try
{
     PerformAsyncOperation();
     while(!async_op_complete)
     {
           Application.DoEvents();
     }
}
catch
{
    Print("exception");
} 
```

我不明白的是，因为 Windows 窗体具有同步上下文，所以在控制离开事件处理程序之前不会执行异步操作（顺便说一下，我不是在谈论 .net 4.5）。一旦发生这种情况，异步代码将在 UI 线程内运行。如果该代码要引发异常，则它不会被围绕异步方法调用的 try-catch 语句捕获，因为在引发异常时控制已经离开了该 try-catch 语句。

但在上述情况下，我们正在循环的事实意味着控制保留在 UI 线程中，而我们在循环中调用 Application.DoEvents() 的事实意味着异步操作在内部“异步”执行用户界面线程。并且由于该循环发生在 try 子句中，因此 async 方法抛出的任何异常都将被相应的 catch 子句捕获。（至少这是我观察到的行为。）

也就是说，

1.  在循环中调用 Application.DoEvents() 以保持 UI 响应，同时等待异步操作完成，然后继续在同一个 UI 线程中做更多工作，这是一个好主意吗？

2.  Even if it's not a good idea to call Application.DoEvents() inside a loop, why does the application quietly exit (no window freezes, no error messages) after the catch clause handles the exception thrown by PerformAsyncOperation()?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T15:49:27.540

> 1) Is it ever a good idea to call Application.DoEvents() inside a loop in order to keep the UI responsive while waiting for an async operation to complete before moving on to doing more work inside the same UI thread?

Absolutely Not! `DoEvents()` is evil and will cause you all sorts of problems.

> 2) Even if it's not a good idea to call Application.DoEvents() inside a loop, why does the application quietly exit (no window freezes, no error messages) after the catch clause handles the exception thrown by PerformAsyncOperation()?

Difficult to say without knowing what `PerformAsyncOperation()` does. Unless it explicitly uses a new `Thread` ( or `Task` ), it will execute synchronously before your loop.

As for the app exit - I can't explain that.

If an uncaught exception is thrown on a worker `Thread`, the app will show the "stopped working" dialog box and exit.

The only thing I know that has changed is the behaviour when an uncaught exception is thrown from inside a `Task`. Prior to .NET 4.5, this would cause a fast fail as with a `Thread`.

If you have installed .NET 4.5 ( even if the app targets 4.0 ) an uncaught exception in a `Task` is now silently swallowed.

Here's an article that explains the behaviours: [`MSDN: Task Exception Handling in .NET 4.5`](http://blogs.msdn.com/b/pfxteam/archive/2011/09/28/10217876.aspx)

# java - JFrame 不等待 JOptionPane 执行

> ID：15549679
> 
> 赞同：0
> 
> 时间：2013-03-21T14:01:40.913
> 
> 标签：java, swing, jframe, joptionpane

我正在做一个项目，我在其中创建了一个简单的乒乓球游戏。如果玩家获胜，我希望弹出一个 JOptionPane 询问用户是想玩新游戏还是停止玩。当我添加 JOptionPane 时，该方法不会等待用户选择按钮，而是继续创建 JOptionPane 直到它返回堆栈溢出错误。控制它的代码是

```
int rightMinLeft = Right_Player_Score.getNumber()-Left_Player_Score.getNumber();
boolean rightWon = Right_Player_Score.getNumber() > 20 && rightMinLeft > 1;
if(rightWon)
{
  Object[] options = {"New Game", "Finish"};
  int i = JOptionPane.showOptionDialog(null, "Right Player has won", "Game Over", JOptionPane.DEFAULT_OPTION, JOptionPane.PLAIN_MESSAGE, null, options, options[0]);
  if(i == 0)
  {
    reset();
  }
  else
  {
    GameOver = true;
  }
}
else if(Left_Player_Score.getNumber() > 20 && Left_Player_Score.getNumber()-Right_Player_Score.getNumber()>1)
{
  Object[] options = {"New Game", "Finish"};
  int i = JOptionPane.showOptionDialog(null, "Right Player has won", "Game Over", JOptionPane.DEFAULT_OPTION, JOptionPane.PLAIN_MESSAGE, null, options, options[0]);
  if(i == 0)
  {
    reset();
  }
  else
  {
    GameOver = true;
  }
} 
```

有什么建议么？

编辑：这是完整的方法：

```
public void update(Graphics window)
 {
  paint(window);
 }

 public void paint(Graphics window)
 {
   try{
   if(pause)
   {
     Right_Player_Score.draw("Right Player Score", window, 600, 20);
     Left_Player_Score.draw("Left Player Score", window,  0, 20);
     leftPaddle.draw(window);
     rightPaddle.draw(window);
     if(U.LELatch(keys[4]))
     {
       pause = false;
     }
   }
   else
   {
     ball.moveAndDraw(window);
     leftPaddle.draw(window);
     Right_Player_Score.draw("Right Player Score", window, Color.WHITE, 600, 20);
    Left_Player_Score.draw("Left Player Score", window,  Color.WHITE, 0, 20);
    int LeftPaddleBottom = leftPaddle.getY()+(leftPaddle.getHeight());
    int RightPaddleBottom = rightPaddle.getY()+(rightPaddle.getHeight());
    int LeftPaddleTop = leftPaddle.getY();
    int RightPaddleTop = rightPaddle.getY();
    boolean inRangeLeft = ball.getY() > LeftPaddleTop && ball.getY() < LeftPaddleBottom;
    boolean inRangeRight = ball.getY() > RightPaddleTop && ball.getY() < RightPaddleBottom;
    if(ball.getX()<=10)
    {
     ball.setXSpeed(-ball.getXSpeed());
     Right_Player_Score.increment();
    }
    else if(ball.getX()>=790)
    {
      ball.setXSpeed(-ball.getXSpeed());
      Left_Player_Score.increment();
    }
    else if((inRangeLeft && ball.getX()<=leftPaddle.getX()+leftPaddle.getWidth()))
    {
      ball.setXSpeed(-ball.getXSpeed());
      numTimes ++;
    }
    else if(inRangeRight && ball.getX()>=rightPaddle.getX())
    {
      ball.setXSpeed(-ball.getXSpeed());
      numTimes ++;
    }

    if(!(ball.getY()>=10 && ball.getY()<=450))
    {
     ball.setYSpeed(-ball.getYSpeed());
    }

    if(keys[0] == true)
    {
     leftPaddle.moveUpAndDraw(window);
    }
    else if(keys[1] == true)
    {
     leftPaddle.moveDownAndDraw(window);
    }
    else
    {
      leftPaddle.draw(window);
    }
    if(keys[2] == true)
    {
      rightPaddle.moveUpAndDraw(window);
    }
    else if(keys[3] == true)
    {
      rightPaddle.moveDownAndDraw(window);
    }
    else
    {
      rightPaddle.draw(window);
    }
    int rightMinLeft = Right_Player_Score.getNumber()-Left_Player_Score.getNumber();
    boolean rightWon = Right_Player_Score.getNumber() > 20 && rightMinLeft > 1;
    if(rightWon)
    {
      Object[] options = {"New Game", "Finish"};
      int i = JOptionPane.showOptionDialog(frame, "Right Player has won", "Game Over", JOptionPane.DEFAULT_OPTION, JOptionPane.PLAIN_MESSAGE, null, options, options[0]);
      //window.setColor(Color.BLACK);
      //window.drawString("Right Player has won",200,400);
      //Thread.currentThread().sleep(2000);
      //int i = 1;
      if(i == 0)
      {
        reset();
      }
      else
      {
        GameOver = true;
      }
    }
    else if(Left_Player_Score.getNumber() > 20 && Left_Player_Score.getNumber()-Right_Player_Score.getNumber()>1)
    {
      Object[] options = {"New Game", "Finish"};
      int i = JOptionPane.showOptionDialog(frame, "Left Player has won", "Game Over", JOptionPane.DEFAULT_OPTION, JOptionPane.PLAIN_MESSAGE, null, options, options[0]);
      //window.setColor(Color.BLACK);
      //window.drawString("Left Player has won",200,400);
      //Thread.currentThread().sleep(2000);
      //int i = 1;
      if(i == 0)
      {
        reset();
      }
      else
      {
        GameOver = true;
      }
    }
    Right_Player_Score.draw("Right Player Score", window, 600, 20);
    Left_Player_Score.draw("Left Player Score", window, 0, 20);
    if(numTimes == 10)
    {
      numTimes = 0;
      if(ball.getXSpeed() == Math.abs(ball.getXSpeed()))
      {
        ball.setXSpeed(ball.getXSpeed() + 1);
      }
      else
      {
        ball.setXSpeed(ball.getXSpeed() - 1);
      }
      if(ball.getXSpeed()>MAXSPEED)
      {
        ball.setXSpeed(MAXSPEED);
      }
    }
    pause = U.LELatch(keys[4]);
   }
   }
   catch(Exception e)
   {
   }
 } 
```

这用于“公共类 GUI_Controller extends Canvas implements KeyListener, Runnable”

注意：注释部分是让用户至少看到一些东西的权宜之计。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T15:01:16.203

您看到的行为是因为您正在重载该`paint(Graphics g)`方法。

来自[`paint(Graphics g)`](http://docs.oracle.com/javase/1.5.0/docs/api/java/awt/Component.html#paint%28java.awt.Graphics%29)JavaDoc

> 当应该绘制组件的内容时调用此方法；例如，当组件首次展示或损坏并需要维修时。

在您的情况下，可能发生的情况是对您`JOptionPane.showOptionDialog()`的`JDialog`显示的`Canvas`调用会触发对 的另一个调用`paint()`。这反过来又会导致另一个呼叫`JOptionPane.showOptionDialog()`触发另一个呼叫`paint()`，依此类推......这将一直持续到您得到 a `StackOverflowError`or `OutOfMemoryError`。

在实践中，`paint()`被调用非常频繁，因此它应该非常有效。通常，只有您的自定义绘图应该在该`paint()`方法中完成。

其他逻辑应该存在于不同的方法中。您应该将评分和用户交互的逻辑移到`paint()`方法之外，只保留绘图。

***编辑：*** 在没有看到更多代码的情况下，我无法为您提供与绘画不直接相关的逻辑移动位置的具体建议。[查看Java Swing 教程中的](http://docs.oracle.com/javase/tutorial/uiswing/index.html)[Performing Custom Painting](http://docs.oracle.com/javase/tutorial/uiswing/painting/index.html)部分可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:03:43.987

将`JOptionPane`当前帧作为第一个参数而不是`null`.

# c# - 如何与 Entity Framework Code First 建立一对一的关系

> ID：15549680
> 
> 赞同：5
> 
> 时间：2013-03-21T14:01:43.610
> 
> 标签：c#, .net, entity-framework, entity

我一直在阅读所有关于在其中建立一对一关系的人的 Google 和 SO 页面，`EF`但它对我不起作用。

这是我的模型：

帐户：

```
public int Id {get; set;}
public virtual AccountConfig AccountConfig {get; set;} 
```

账户地图：

```
HasKey(t => t.Id);
HasRequired(t => t.AccountConfig)
    .WithOptional(); 
```

账户配置：

```
public int Id {get; set;}
public int AccountId {get; set;}
public virtual Account Account {get; set;} 
```

账户配置图：

```
HasKey(t => t.Id);
HasRequired(t => t.Account)
    .WithOptional(t => t.AccountConfig); 
```

执行时，`AccountConfig`属性 on和属性 on`Account`是不正确的记录（巧合的是，检索到的与 相同，但我不知道这是否意味着什么）。`NULL``Account``AccountConfig``Account.Id``AccountConfig.Id`

在数据库中，`Account`表没有对`AccountConfig`记录的引用，但`AccountConfig`表有对`Account`使用`AccountId`列的记录的引用。

最终结果是我可以引用`AccountConfig`from`Account`和（如果可能的话）引用`Account`from `AccountConfig`。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T14:08:29.037

使用 EF，仅在共享主键的表上支持一对一关系。您的`AccountConfig`表有自己的主键和`Account`. EF 仅支持与此配置的一对多关系。

[这篇文章](http://blog.bennymichielsen.be/2011/06/02/entity-framework-4-1-one-to-one-mapping/)很好地解释了 EF 中的 1:1 和 1:0..1 关系。[这里的限制是EF 还不支持唯一约束](https://stackoverflow.com/a/11819804/439024)这一事实的副产品。

# java - HTTPException 和 IOException 正确用法

> ID：15549681
> 
> 赞同：0
> 
> 时间：2013-03-21T14:01:45.460
> 
> 标签：java

以下异常处理有什么问题...有人告诉我这是不正确的，现在我的异常处理不是最好的...

```
 try {

  } catch (UnsupportedEncodingException | HttpException e) {

  } catch (IOException e) {

  } 
```

有什么指导吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:06:25.720

在单独的 catch 块中处理每个异常始终是一个好习惯，以便可以采取特定于该异常的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:09:54.567

这是自 Java 7 以来可接受的语法，但由于这是（相对）新的，常见的习惯用法是每次捕获处理一种类型。我唯一可以接受这种语法的情况是，如果 catch 对 catch 中的所有类型执行完全相同的工作，即使这样......

您还必须注意异常的层次结构，我认为从左到右评估倍数，但您需要先检查一下，然后再依赖它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:14:04.867

我不认为你的处理方式`HttpException`和`IOException`.

异常处理最重要的部分是确保：

*   你可以做一些例外的事情。如果你不能做任何事情，最好的策略是重新抛出异常（也许用一个对你的应用程序的上层更有意义的异常来包装它）。

*   您了解可以引发每个异常的条件之间的区别。

例如，a`UnsupportedEncodingException`表示 Java 无法处理指定的编码。如果您正在使用某些 WS API，这意味着消息格式可能不正确（Java 处理了大多数标准编码，因此消息很可能是错误的）。`IOException`请注意，当您要`Reader`使用不受支持的编码创建一个时，这是 Java 抛出的一个子类。

`HttpException`表示您已收到 HTTP 故障响应。不是`IOException`因为“数据传输”好。指示来自服务器的错误，而不是连接中的错误。

`IOException`意味着在处理流时发生了一些不好的事情（可能流以意想不到的方式结束）。

根据每个错误的原因，代码中唯一“不好”的是 mixin`UnsupportedEncodingException`和`HttpException`. 这取决于您在异常处理程序中执行的操作，但两种异常都有不同的原因。

# c++ - 在智能指针容器中添加项目

> ID：15549690
> 
> 赞同：5
> 
> 时间：2013-03-21T14:02:03.673
> 
> 标签：c++, containers, smart-pointers, unique-ptr

在智能指针容器中添加项目的几种方法。我想知道你会走哪条路。

```
class MyContainer
{
private:
    std::vector<std::unique_ptr<Item>> mItems;

public:
    bool Add(Item* item);
    // This is Way 1
    //
    // Advantages: 
    // - Easy to add derived items, such as Add(new DerivedItem);
    // - No interface change if smart pointer type changes to such as shared_ptr;
    //
    // Disadvantages:
    // - Don't explicitly show the item to add must be allocated on heap;
    // - If failed to add, user has to delete the item.

    bool Add(std::unique_ptr<Item> item);
    // This is Way 2
    // Disadvantages and advantages are reversed from Way 1.
    // Such as to add derived item, Add(std::unique_ptr<Item>(new DerivedItem));
    //                                                    |
    //                               easy to write DerivedItem here for an error

    bool Add(std::unique_ptr<Item>& item);
    // This is Way 3
    // Similar to Way 2, but when failed to add, item still exist if it is a 
    // reference of outer unique_ptr<Item>

}; 
```

我个人选择方式 1。方式 2 和 3 的优势或方式 1 的劣势我应该选择 2 或 3 吗？

sftrabbit 给出了许多优点。在以下常见情况下。如何使用方式 2 或 3 轻松完成？用户使用对话框生成新的派生项。它被戴上`std::unique_ptr<DerivedItem> item`。当单击“确定”按钮时，它被添加到容器中。如果添加失败，请返回对话框进行编辑。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T14:11:56.237

我投票赞成：

```
bool Add(std::unique_ptr<Item> item); 
```

原因：

1.  从函数签名中可以清楚地看出，客户端需要将对象的所有权传递给`MyContainer`. 如果您选择选项 1，则仍然不清楚客户端是否应该`delete`自己使用对象，或者即使他们应该传递动态分配的对象。

2.  `std::move`如果客户已经拥有由命名管理的对象，他们将被迫显式转移所有权`std::unique_ptr`。他们不会意外失去所有权。选项 3 没有明确表示它将获得所有权。

3.  当我们有[`std::make_unique`(N3588)](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3588.htm)时，添加元素的方法将是：

    ```
    container.Add(std::make_unique<Item>()); 
    ```

    这避免`new`了在某些情况下使用并提高了异常安全性。

4.  您为派生对象给出的问题并不是真正的问题。如果你做错了，你会得到一个编译时错误。

5.  如果接口更改为使用不同类型的智能指针，客户端会*想*知道。他们不想继续传递对象，以为他们正在传递所有权，如果实际上他们正在共享它。他们会特别想知道是否会发生相反的情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:18:26.547

不幸的是，第一种方法严重损害了类型安全——你已经指出我们自己处于劣势。我认为这些担忧压倒了这种方法可能具有的任何优势。

特别是，使用派生对象时第二种方法的潜在错误在编译时被捕获，因此很烦人，但*安全*！

我同意你的评估，即这种用法会泄漏实现细节，但根据我的经验，这种泄漏是不可避免的——我同意 sfrabbit 的观点，这实际上是课程用户需要了解的细节。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-22T14:27:34.437

将此视为工具箱中的另一个工具：

```
bool Add(std::unique_ptr<Item>&& item); 
```

这结合了方式 2 和方式 3 的优点。即它只接受 rvalue `unique_ptr`s（如 2），但如果将其添加到容器中出现一些失败，它可以像 3 一样保留所有权。可以使用如下：

```
void
foo(MyContainer& c)
{
    std::unique_ptr<Item> p = get_Item();
    try
    {
        c.Add(std::move(p));
    }
    catch (...)
    {
        log_error_wtih(*p);
    }
} 
```

# ios - 推送到同一个 viewContoller - Objective C

> ID：15549712
> 
> 赞同：0
> 
> 时间：2013-03-21T14:03:11.347
> 
> 标签：ios, objective-c, xcode

我有一个 tableViewController，当我点击一个单元格时，它应该推送到同一个 ViewController（例如：sectionTableViewController -> sectionTableViewController（它将过滤一些数据并显示））。我试图推送到同一个视图控制器，但我不能。请帮帮我。这是示例代码，我在 BlipFeedViewController.m 中做了示例代码

```
BlipFeedHash *feed = [[BlipFeedHash alloc] initWithHash:hashtag];
[self.navigationController pushViewController:[BlipFeedViewController viewControllerWithFeed:feed] animated:TRUE]; 
```

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:47:27.120

安的回答是正确的。虽然您可以推送到包含过滤数据的另一个视图控制器，但这是非标准的，并且比用户仅在同一视图上过滤需要更多时间。您是否有特定的原因需要另一个视图来显示过滤后的数据？您是否考虑过用户在第二个视图控制器上进行过滤，然后是第三个，创建了一个令人困惑的视图控制器链？

我求求你，为了全人类，请尽量使用更标准的过滤界面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:04:58.583

你为什么不过滤数据然后做`[tableview reloadData]`而不是创建一个新的 ViewController。

# arrays - 多维数组操作 R

> ID：15549715
> 
> 赞同：3
> 
> 时间：2013-03-21T14:03:16.717
> 
> 标签：arrays, r

很抱歉，但我无法找到一种方法来替换 3 维数组中的每一个 0，用它们所在的列的平均值来替换它们。

谢谢。所以，例如，假设我有这个数组 j

```
j
, , 1

      [,1] [,2]
[1,]    0    6
[2,]    1    5
[3,]    2    2

, , 2

      [,1] [,2]
[1,]   11    0
[2,]   14   12
[3,]    0   14

, , 3

     [,1] [,2]
[1,]   19   22
[2,]   20   23
[3,]   21   24 
```

我想

```
j
, , 1

      [,1] [,2]
[1,]    1    6
[2,]    1    5
[3,]    2    2

, , 2

      [,1] [,2]
[1,]   11    26/3
[2,]   14   12
[3,]   25/3   14

, , 3

     [,1] [,2]
[1,]   19   22
[2,]   20   23
[3,]   21   24 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T14:34:59.353

你可以用`apply`这个。

从以下数据开始：

```
arr <- array(0:5,dim=c(4,3,2))

, , 1

     [,1] [,2] [,3]
[1,]    0    4    2
[2,]    1    5    3
[3,]    2    0    4
[4,]    3    1    5

, , 2

     [,1] [,2] [,3]
[1,]    0    4    2
[2,]    1    5    3
[3,]    2    0    4
[4,]    3    1    5 
```

你可以做 ：

```
apply(arr, c(2,3),function(v) { v[v==0] <- mean(v); v}) 
```

这使 ：

```
, , 1

     [,1] [,2] [,3]
[1,]  1.5  4.0    2
[2,]  1.0  5.0    3
[3,]  2.0  2.5    4
[4,]  3.0  1.0    5

, , 2

     [,1] [,2] [,3]
[1,]  1.5  4.0    2
[2,]  1.0  5.0    3
[3,]  2.0  2.5    4
[4,]  3.0  1.0    5 
```

# c# - C#如何通过字符串动态设置属性？

> ID：15549716
> 
> 赞同：-4
> 
> 时间：2013-03-21T14:03:24.880
> 
> 标签：c#, dynamic, reflection, properties, set

首先，我不喜欢编程，但可以根据我的需要找出基本概念。

在下面的代码中，我想按名称“Gold”设置属性，例如：

```
_cotreport.Contract = COTReportHelper.ContractType."Blabalbal"

 protected override void OnBarUpdate()
            {

                COTReport _cotreport = COTReport(Input);
                _cotreport.Contract=COTReportHelper.ContractType.Gold;
                _cotreport.OpenInterestDisplay=COTReportHelper.OpenInterestDisplayType.NetPosition;
                double index = _cotreport.Commercial[0];
                OwnSMA.Set(index);

            } 
```

我尝试了下面的代码，但系统说：“

> *你调用的对象是空的”*

请帮忙！

```
 System.Reflection.PropertyInfo PropertyInfo = _cotreport.GetType().GetProperty("ContractType");
            PropertyInfo.SetValue(_cotreport.Contract,"Gold",null);
            PropertyInfo.SetValue(_cotreport.Contract,Convert.ChangeType("Gold",PropertyInfo.PropertyType),null); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:05:42.997

您正在尝试设置获取名为`"ContractType"`on的属性`_cotreport`并将其值设置为 on `_cotreport.Contract`。这行不通有两个原因。

1.  属性名称（从我在您的代码中可以看出）`Contract`不是`ContractType`.
2.  您需要将值设置为`_cotreport`。

试试这个

```
System.Reflection.PropertyInfo property = _cotreport.GetType().GetProperty("Contract");
property.SetValue(_cotreport, COTReportHelper.ContractType.Gold, new object[0]); 
```

如果您想按名称设置枚举值，那是一个单独的问题。试试这个

```
var enumValue = Enum.Parse(typeof(COTReportHelper.ContractType), "Gold");
property.SetValue(_cotreport, enumValue, new object[0]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:05:34.590

`PropertyInfo`可能是`null`，如果您使用属性名称，可能不是：`Contract`。您应该能够`COTReportHelper.ContractType.Gold`直接指定为值。并且您将*属性*指定为要修改的实例，但`PropertyInfo`表示，您应该指定应在其上设置属性值的拥有实例。

像这样的东西：

```
System.Reflection.PropertyInfo PropertyInfo = _cotreport.GetType().GetProperty("Contract");
PropertyInfo.SetValue(_cotreport, COTReportHelper.ContractType.Gold, null); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:16:01.843

此方法设置任何对象的属性值，如果分配成功则返回 true：

```
public static Boolean TrySettingPropertyValue(Object target, String property, String value)
{
        if (target == null)
            return false;
        try
        {
            var prop = target.GetType().GetProperty(property, DefaultBindingFlags);
            if (prop == null)
                return false;
            if (value == null)
                prop.SetValue(target,null,null);
            var convertedValue = Convert.ChangeType(value, prop.PropertyType);
            prop.SetValue(target,convertedValue,null);
            return true;
        }
        catch
        {
            return false;
        }

    } 
```

# iphone - 找不到错误，EXC_BAD_ACCESS

> ID：15549717
> 
> 赞同：0
> 
> 时间：2013-03-21T14:03:27.547
> 
> 标签：iphone, objective-c, exc-bad-access

上次我在 Stackowerflow 上发帖时，我搞砸了，因为我认为我知道的比我做的更多。重命名方法以使其更容易，只是让一切变得非常混乱。所以我现在要再试一次。

无论如何，我的申请被 Apple 拒绝了几次，我找不到错误。我一直在运行模拟器以及 AD-HOC 安装，但似乎找不到错误甚至无法复制它。

我没有任何警告，并且一直在使用静态分析器，也找不到任何问题。

我是 Objective C 的新手，我认为我在使用类方法方面做错了，但我不确定。

这是最后一个，类方法“itemStatus”崩溃了。

顺便说一句，我正在使用 ARC。

任何帮助将非常感激。

```
 Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
    Exception Codes: KERN_INVALID_ADDRESS at 0x432b2b10
    Crashed Thread:  0

    Thread 0 name:  Dispatch queue: com.apple.main-thread
    Thread 0 Crashed:
    0   libobjc.A.dylib                 0x3a3c3526 objc_retain + 6
    1   Kebunno                     0x0008928a +[DynamoDBManager itemStatus] + 418
    2   Kebunno                     0x000894de +[DynamoDBManager getItem:] + 170
    3   Kebunno                     0x000908f6 __44-[KebunnoViewController itemPressed]_block_invoke + 362 
```

头等舱

```
@interface KebunnoViewController ()

// Interface declarations here

@end

@implementation KebunnoViewController

- (IBAction)itemPressed:(id)sender {
    NSString *itemID = _itemID.text;
    NSString *reference = _reference.text;

    BOOL itemCorrect = NO;
    if([ItemHelpClass validItem:itemID]){
    itemCorrect = YES;
    }

    if(!itemCorrect){
        [[ItemHelpClass showItemNotCorrect:self] show];
        return;
    }

    else if(itemCorrect){
        [self startCancelTimer];
        [self disableButtons];

        dispatch_queue_t backgroundQueue = dispatch_queue_create("background queue", NULL);
        dispatch_async(backgroundQueue, ^{
            NSString *itemStatus;
            itemStatus = [DynamoDBManager getItem:itemID]; //crash

         if([itemStatus isEqualToString:NETWORK_ERROR] || 
          [itemStatus  isEqualToString:AMAZON_ERROR]){
                dispatch_async(dispatch_get_main_queue(), ^{
                    [self enableButtons];
                    [[ItemHelpClass showSomethingWentWrong:self] show];
                });
            }

//Code continues
}

@end 
```

另一个名为 DynamoDBMangar.m 的文件

```
@implementation DynamoDBManager

+(NSString*)getItem:(NSString *)itemID {
    NetworkStatus netStatus = 
    [[Reachability reachabilityForInternetConnection]currentReachabilityStatus];

    if(netStatus == NotReachable)
    {
        return NETWORK_ERROR;
    }

    NSString *itemStatus = [self itemStatus]; //crash
    if([itemStatus isEqualToString: ITEM_BORROWED]){
        return ITEM_BORROWED;
    }
    else if([itemStatus isEqualToString:NETWORK_ERROR])
    {
        return NETWORK_ERROR;
    }

//Code continues
}

+(NSString*) itemStatus{
    NetworkStatus netStatus = [[Reachability reachabilityForInternetConnection]currentReachabilityStatus];
    if(netStatus == NotReachable)
    {
        return NETWORK_ERROR;
    }

    @try
    {

        DynamoDBGetItemRequest *request = [[DynamoDBGetItemRequest alloc] initWithTableName: TABLE_CONTENT andKey:[[DynamoDBKey alloc] initWithHashKeyElement:
                                                                   [[DynamoDBAttributeValue alloc] initWithS:[ItemHelpClass getItem]]]];

        DynamoDBGetItemResponse *response = [[AmazonClientManager ddb] getItem:request];
        if(response){
            if(((DynamoDBAttributeValue *)[response.item objectForKey:@"UID_ID"]).s){
                return ITEM_BORROWED;
            }
            else{
                return ITEM_NOT_BORROWED;
            }
        }

    }@catch (NSException *exception)
    {
        [AmazonClientManager wipeCredentialsOnAuthError:exception];
    }
    return NETWORK_ERROR;

}

@end 
```

编辑：CPU状态

```
Thread 0 crashed with ARM Thread State (32-bit):
    r0: 0x200c55c0    r1: 0x432b2b00      r2: 0x00000002      r3: 0x00000020
    r4: 0x00000001    r5: 0x200a2d10      r6: 0x1f5c67f0      r7: 0x2fd95a08
    r8: 0x200a4260    r9: 0x000fc09c     r10: 0x1f5c4c40     r11: 0x200a44e0
    ip: 0x3c33c050    sp: 0x2fd95960      lr: 0x0008928f      pc: 0x3a3c3526
  cpsr: 0x00000030 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-21T15:33:55.893

```
@catch (NSException *exception)
    {
        [AmazonClientManager wipeCredentialsOnAuthError:exception];
        return NULL;
    } 
```

# c++ - enable_shared_from_this 的双重继承

> ID：15549722
> 
> 赞同：10
> 
> 时间：2013-03-21T14:03:34.200
> 
> 标签：c++, shared-ptr, multiple-inheritance, enable-shared-from-this

我有一个从其他两个对象（A 和 B）派生的对象（Z）。

`enable_shared_from_this<>`A 和 B 都分别来自`enable_shared_from_this<A>`和`enable_shared_from_this<B>`。

当然，我会调用`shared_from_this()`Z。当然，编译器会将此报告为模棱两可的。

我的问题是：

*   继承两次是安全的`enable_shared_from_this<>`还是会创建两个单独的引用计数（不好！）
*   如果不安全，我该如何解决？

[注意：当基类和派生类都继承自 boost::enable_shared_from_this](https://stackoverflow.com/questions/12790859/bad-weak-pointer-when-base-and-derived-class-both-inherit-from-boostenable-sha)但它并没有真正回答时，我发现了另一个问题bad weak pointer。我也应该使用这个`virtual`技巧吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-21T14:27:50.260

是的，根据[当基类和派生类都从 boost::enable_shared_from_this 继承时的坏弱指针，](https://stackoverflow.com/questions/12790859/bad-weak-pointer-when-base-and-derived-class-both-inherit-from-boostenable-sha)解决方案是使用虚拟继承。这是 C++11 标准`shared_ptr`（不是 Boost）的实现：

```
#include <memory>

struct virtual_enable_shared_from_this_base:
   std::enable_shared_from_this<virtual_enable_shared_from_this_base> {
   virtual ~virtual_enable_shared_from_this_base() {}
};
template<typename T>
struct virtual_enable_shared_from_this:
virtual virtual_enable_shared_from_this_base {
   std::shared_ptr<T> shared_from_this() {
      return std::dynamic_pointer_cast<T>(
         virtual_enable_shared_from_this_base::shared_from_this());
   }
};

struct A: virtual_enable_shared_from_this<A> {};
struct B: virtual_enable_shared_from_this<B> {};
struct Z: A, B { };
int main() {
   std::shared_ptr<Z> z = std::make_shared<Z>();
   std::shared_ptr<B> b = z->B::shared_from_this();
} 
```

这不是默认实现的一部分，可能是因为虚拟继承的开销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:20:00.250

是的，你的类将派生自两个不同的类`enable_shared_from_this<A>`and `enable_shared_from_this<B>`，并且有两个不同的弱引用

由于虚拟继承，该答案的技巧允许拥有一个基类

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-15T15:31:45.217

使用`shared_ptr`别名构造函数，可以得出 ecatmur 答案的变体：

```
#include <memory>

struct virtual_enable_shared_from_this_base:
   std::enable_shared_from_this<virtual_enable_shared_from_this_base> {
   virtual ~virtual_enable_shared_from_this_base() {}
};
template<typename T>
struct virtual_enable_shared_from_this:
virtual virtual_enable_shared_from_this_base {
   std::shared_ptr<T> shared_from_this() {
      return std::shared_ptr<T>(
         virtual_enable_shared_from_this_base::shared_from_this(),
         static_cast<T*>(this));
   }
   std::shared_ptr<const T> shared_from_this() const {
      return std::shared_ptr<const T>(
         virtual_enable_shared_from_this_base::shared_from_this(),
         static_cast<const T*>(this));
   }
};

struct A: virtual_enable_shared_from_this<A> {};
struct B: virtual_enable_shared_from_this<B> {};
struct Z: A, B { };
int main() {
   std::shared_ptr<Z> z = std::make_shared<Z>();
   std::shared_ptr<B> b = z->B::shared_from_this();
} 
```

我希望这个版本在许多情况下会更快，因为它避免了昂贵的动态转换。但是，像往常一样，只有 becnhmarks 有最终决定权。另外，我添加了`const`变体。

# c++ - 随机数生成器机制

> ID：15549730
> 
> 赞同：0
> 
> 时间：2013-03-21T14:04:04.913
> 
> 标签：c++, random

我的书中有以下问题：

```
#include<iostream.h>
#include<conio.h>
#include<stdlib.h>
void main()
{
    clrscr();
    randomize();
    int Game[]={10,16},P;
    int Turn=random(2)+5;
    for(int T=0;T<20;T++)
       {
           P=random(2);
           cout<<Game[P]+Turn<<"#";
       }
getch();
} 
```

输出像 16#22#16#16#16#22#....20 次......为什么这个输出总是 16# 或 22#？为什么不是 15# 或 21#?? 我想知道这个程序的机制。谢谢。转=随机（2）+5；如果 random(2) 给出 0 则 turn 变为 turn=0+5=5 这意味着我应该得到 10+5=15 和 16+5=21 以及 16 和 22 但我没有得到它们。

我们在计算机科学理论考试中得到了上述问题，我们要选择正确的答案（即它生成 16 和 22），但我怎么知道它只会生成 16 和 22。正如我在上面解释的 15 和21也是可以的。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:05:30.490

也许这有帮助：

未设置随机数生成器的种子。

如果你调用 srand(time(NULL)) 那么你会得到更多的随机结果

[C++ rand() 在运行进程时给出相同的数字](https://stackoverflow.com/questions/9459035/c-rand-gives-same-number-when-running-process)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:06:33.493

您需要提供一个`seed`有助于获得“真正”随机的值。妈妈们

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T14:16:00.280

计算机本身无法随机化数字，它为此使用种子。

但是种子并不是完全随机的，它们只是有一个特定的顺序，比如：

```
1
2
8
5
4 
```

这些数字看起来很随机，但是当你下次运行程序时，你会得到：

```
1
2
8
5
4 
```

完全相同。

为了防止这种情况，我们使用时间作为种子，时间总是会改变，所以它总是会产生新的数字。

```
#include <time.h>
srand(time(NULL));  // srand is the function to randomize numbers from a seed, we use 'time' as seed here 
```

[这个视频](https://www.youtube.com/watch?v=naXUIEAIt4U)解释了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T14:11:17.890

因为`Turn`只随机化一次 - 在循环的开始。如果你将赋值`Turn`移到你的循环中，你应该得到`15`并且`21`：

```
#include<iostream.h>
#include<conio.h>
#include<stdlib.h>
void main()
{
    clrscr();
    randomize();
    int Game[]={10,16},P;
    int Turn;
    for(int T=0;T<20;T++)
       {
           P=random(2);
           Turn=random(2)+5;
           cout<<Game[P]+Turn<<"#";
       }
    getch();
} 
```

此外，正如其他人所说，如果您希望输出在运行之间有所不同，您将需要为您的随机数生成器播种，例如通过`srand()`调用[种子](http://en.wikipedia.org/wiki/Random_seed)。例如：

```
#include <time.h>
(...)
srand(time(NULL)); 
```

# asp.net-mvc - 带有剃刀的视图端的 MvcSiteMapProvider 获取当前节点的父节点

> ID：15549737
> 
> 赞同：0
> 
> 时间：2013-03-21T14:04:40.387
> 
> 标签：asp.net-mvc, razor, breadcrumbs, mvcsitemapprovider

我正在使用 MVC Site Map Provider 创建一些面包屑

我想做什么；使用 razor 在视图上创建面包屑

我想做一些如下所示的电话

```
<div id="navbar">
    <div>YOU ARE HERE:
        // There is no calls like this but you get the idea
        @if (SiteMap.CurrentNode.HasParentNodes == true) 
        {
            // I'd like to loop trough each parent till the RootNode
            foreach (SiteMapNode Snode in SiteMap.CurrentNode.ParentNodes)
            {
                <a href="@Snode.Url">@Snode >></a> 
            }
        } else {
            // If there is no parent just show current node
            <a href="@SiteMap.CurrentNode.Url.ToString()">@SiteMap.CurrentNode</a>
        }
    </div>
    <div>@DateTime.Now.Date.ToLongDateString()</div>
</div> 
```

那么我如何使用 Razor on View 来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-20T22:18:07.583

`@Html.MvcSiteMap().SiteMapPath()`HTML 助手已经这样做了。它是一个模板化的控件，你可以通过编辑`/Views/Shared/DisplayTemplates/SiteMapPathHelperModel.cshtml`文件来修改它，所以基本上你可以得到你想要的任何 HTML 输出。

如果您在知道之后仍然喜欢按照自己的方式进行操作，您也可以使用`MvcSiteMapProvider.SiteMaps.Current.CurrentNode.Ancestors`属性（版本 4 及更高版本）来执行此操作。

# android - Android SQLite rawQuery 遇到麻烦

> ID：15549738
> 
> 赞同：1
> 
> 时间：2013-03-21T14:04:43.453
> 
> 标签：android, database, sqlite

我创建了这个方法来了解我的 Sqlite 数据库中是否存在联系人。

```
public Cursor doesContactExist(String name) 
{
    return db.rawQuery("select * from contacts where name = ?; ", new String[] {name});
} 
```

但是每当它从另一个活动中调用时，它只会在这一点上崩溃......

```
if(db.doesContactExist(name)==null){   <== crashes here
                     try {                       
                        db.open();      
                        db.insertContact(name,cNumber);//name and number are Strings
                        listItems.add(name);           //a List View array
                        db.close();
                        adapter.notifyDataSetChanged(); //adapter for ListView

                            } 
                     catch (Exception e) {
                    //some code                                               }
                    } 
```

据我说，rawQuery 有一些麻烦，尤其是其中的 sql 字符串。

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:11:01.057

您尝试在数据库打开之前进行选择：

```
if(db.doesContactExist(name)==null){   <== it is closed here
                 try {                       
                    db.open();      <== open the db here 
```

将其更改为：

```
db.open();
if(db.doesContactExist(name)==null){
          try { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:24:19.073

我想它可能会帮助你..

```
db.open();
if(db.doesContactExist(name)==null)
{
     try
     {
          // Your Code Here..
     }
} 
```

在数据库类中

```
public Cursor doesContactExist(String name) 
{
    return db.rawQuery("SELECT * FROM contacts WHERE name=?", new String[ {name.toString()});
} 
```

在使用任何数据库函数之前使用 db.open() 方法，因为它会打开您与数据库的连接.. 最后不要忘记像 db.close() 这样关闭数据库，如果您在代码中的任何地方使用 Cursor 请关闭它还。它不会产生任何错误，但会给您警告。:)

# sql - 两个不同表上的 SQL 左连接

> ID：15549747
> 
> 赞同：1
> 
> 时间：2013-03-21T14:04:54.463
> 
> 标签：sql, sql-server-2008

我有这张表 Widget，我需要加入 WidgetHistory 表来收集关于我的小部件的历史数据。每个小部件在 Doodad 和 Thing 表中也有一条记录。我正在使用一个返回小部件每个相关版本的存储过程。

棘手的部分是 WidgetHistory 表是比较新的，而最近没有修改的旧小部件在 WidgetHistory 表中不会有相应的记录。在尝试检索小部件的每个相关版本时，我正在 WidgetHistory、Doodad 和 Thing 表之间进行左连接。对于那些没有 WidgetHistory 记录的小部件，我想离开加入 Widget、Doodad 和 Thing 表。

我已经为我非常有限的用例工作，但我对此持怀疑态度，因为我认为对于具有 WidgetHistory 记录的小部件，我会得到意想不到的结果。

这是（简化的）查询：

```
SELECT 
      w.ID,
      ISNULL(h.Title, w.Title)
      d.Version,
      t.Size
FROM dbo.Widget as w
LEFT JOIN dbo.WidgetHistory as h ON w.ID = h.ID
LEFT JOIN dbo.Doodad as d ON h.DoodadID = d.ID /*!*/ OR w.DoodadID = d.ID
LEFT JOIN dbo.Thing as t ON h.ThingID = t.ID /*!*/ OR w.ThingID = t.ID 
```

我怀疑的部分是 ! 最后两个连接。我知道我可以单独在 Widget、Doodad 和 Thing 之间进行一系列单独的左连接，但这似乎过度（但也许不是？）。

对此或更好的策略有什么想法吗？同样，我想在 WidgetHistory、Doodad 和 Thing 之间进行左连接，除非小部件不存在 WidgetHistory 记录，在这种情况下，请在 Widget、Doodad 和 Thing 之间进行连接。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:42:06.837

我尝试了 MySQL，我想我找到了解决方案。希望它也适用于 SQL Server：

```
SELECT 
  w.ID,
  ISNULL(h.Title, w.Title)
  d.Version,
  t.Size
FROM dbo.Widget as w
LEFT JOIN dbo.WidgetHistory as h ON w.ID = h.ID
LEFT JOIN dbo.Doodad as d ON d.ID = ISNULL(h.DoodadID, w.DoodadID) 
LEFT JOIN dbo.Thing as t ON t.ID = ISNULL(h.ThingID, w.ThingID) 
```

我不得不在 MySQL 上使用函数 IFNULL，而不是 ISNULL，但两者的工作方式似乎相同。

我对 MySQL 的测试：

小部件：

```
------ ----------- --------
| 编号 | doodad_id | 价值 |
 ------ ----------- --------
| 1 | 1 | 1 |
| 2 | 5 | 5 |
| 3 | 3 | 3 |
| 4 | 6 | 6 |
 ------ ----------- --------

```

小部件历史

```
------ ----------- --------
| 编号 | doodad_id | 价值 |
 ------ ----------- --------
| 2 | 2 | 2 |
| 4 | 4 | 4 |
 ------ ----------- --------

```

小饰品：

```
------ ---------
| 编号 | 版本 |
 ------ ---------
| 1 | 1 |
| 2 | 2 |
| 3 | 3 |
| 4 | 4 |
| 5 | 5 |
| 6 | 6 |
 ------ ---------

```

以及查询结果：

```
------ -------------------------------------------------------- - --------
| 编号 | IFNULL(widgetHistory.value, widget.value) | 版本 |
 ------ -------------------------------------------------------- - --------
| 1 | 1 | 1 |
| 2 | 2 | 2 |
| 3 | 3 | 3 |
| 4 | 4 | 4 |
 ------ -------------------------------------------------------- - --------

```

因为它适用于表 Doodad，它也应该适用于表 Thing。

我希望这个对你有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:14:56.067

我自己会使用联合查询。上半部分将加入 WidgetHistory，而下半部分则不会。

# android - Android DownloadManager“无法打开文件”

> ID：15549750
> 
> 赞同：6
> 
> 时间：2013-03-21T14:05:01.190
> 
> 标签：android, download, download-manager

我正在使用 DownloadManager 从 webService 下载文件。下载成功结束，但是当我尝试在“下载”文件夹中打开新文件时，出现此错误“无法打开文件”（我知道我可以打开这种类型的文件）。

另外，当我将手机插入电脑并用它打开下载文件时，文件打开成功并且没有损坏。

我没有其他错误，所以我真的迷路了！

这是我的代码：

```
 /*Data*/
    int filePosition = position - _subFolderNameList.length;
    String url = _folder.getFiles().get(filePosition).getUrl();
    String FileName = _folder.getFiles().get(filePosition).getName();
    String Description = _folder.getFiles().get(filePosition).getUrl();

    /*Prepare request*/
    DownloadManager.Request request = new DownloadManager.Request(Uri.parse(url));
    request.setDescription(Description);
    request.setTitle(FileName);

    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
        request.allowScanningByMediaScanner();
        request.setNotificationVisibility(DownloadManager.Request.VISIBILITY_VISIBLE_NOTIFY_COMPLETED);
    }
    request.setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS, FileName);

    DownloadManager manager = (DownloadManager) getSystemService(Context.DOWNLOAD_SERVICE);
    manager.enqueue(request); // Send request 
```

**编辑：**清单中的权限：

```
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.READ_PHONE_STATE" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-27T10:28:11.723

好的，我发现了问题！

我必须使用[setMimeType()](http://developer.android.com/reference/android/app/DownloadManager.Request.html#setMimeType%28java.lang.String%29)指定文件的“MIME 内容类型” 。

```
public DownloadManager.Request setMimeType (String mimeType); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-02-08T15:25:33.410

是的，您必须指定 MIME 类型。在接受的答案中添加更多细节。

```
public DownloadManager.Request setMimeType (String mimeType); 
```

要获取 MIME 类型，您可以使用以下函数。

```
private String getMimeFromFileName(String fileName) {
    MimeTypeMap map = MimeTypeMap.getSingleton();
    String ext = MimeTypeMap.getFileExtensionFromUrl(fileName);
    return map.getMimeTypeFromExtension(ext);
} 
```

以下是相同的 Xamarin.Android 实现：

```
 private static string GetMimeTypeFromFileName(string fileName)
        {
            var map = MimeTypeMap.Singleton;
            var ext = MimeTypeMap.GetFileExtensionFromUrl(fileName);
            return map.GetMimeTypeFromExtension(ext);
        } 
```

# python - ZeroMQ 收不到消息怎么办？

> ID：15549751
> 
> 赞同：2
> 
> 时间：2013-03-21T14:05:03.190
> 
> 标签：python, zeromq

我有某种分布式控制系统，我每秒都会发送一次心跳。在接收端，如果超过 2 秒没有收到消息，我需要采取措施。问题是当 zeroMQ 等待答案时，我不能做任何其他事情，比如检查自收到最后一条消息以来已经过去了多少时间。

我现在拥有的代码如下。如果超过 2 秒没有收到任何消息，有人知道我该如何采取行动吗？欢迎所有提示！

[编辑] 在 Pieter Hintjes 的提示下，我在代码中添加了轮询，但我仍然无法工作。还有其他想法吗？

```
from datetime import datetime
import zmq
context = zmq.Context()

# Set up subscriber connection to receive message from broker
subscriber = context.socket(zmq.SUB)
subscriber.connect('tcp://localhost:8888')
subscriber.setsockopt(zmq.SUBSCRIBE, 'beat')

# Initialise poll set
poller = zmq.Poller()
poller.register(subscriber, zmq.POLLIN)

while True:
    socks = dict(poller.poll(2000))
    if subscriber in socks and socks[subscriber] == zmq.POLLIN:
        message = subscriber.recv()
        print(message)

    print('do other stuff') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:09:15.053

在 ZMQ 套接字上使用 poll 而不是阻塞 recv。ZeroMQ 指南中有很多这样的例子。

# java - java上的排序算法问题比较

> ID：15549755
> 
> 赞同：3
> 
> 时间：2013-03-21T14:05:16.667
> 
> 标签：java, algorithm, sorting, comparison, comparable

我想做一个特定的排序。我正在使用 java 的可比较接口，这意味着我的比较方法的返回必须返回 -1 +1 或 0，具体取决于两个比较的相等性，然后我使用 Collections 进行排序。我的麻烦来自于我希望如何比较。

我有一个由以下任一组成的密钥

```
[keyName]  
[siteName].[keyName]  
[siteName].[pageName].[keyName] 
```

以“mysite.alampshade.color”为例

棘手的部分是必须首先对站点进行排序，然后是 keyname，然后是 pageName。但首先是键名，然后是站点名称，按照属性部分的数量顺序排列。对不起。它有点复杂，一个例子可能会有所帮助。这是它们必须的顺序：

```
alpha  
beta  
charlie  
sitea.alpha  
sitea.charlie  
sitea.pagea.beta  
sitea.pageb.beta  
sitea.pagea.charlie  
siteb.alpha  
siteb.delta  
siteb.pagef.alpha  
siteb.pageb.echo  
siteb.pageb.golf  
siteb.pagea.hotel  
siteb.pageb.hotel  
siteb.pagec.hotel 
```

我尝试了许多不同的方法，并且已经扔掉了几次代码，但仍然无法使其完美。如果不是一些java，一些伪代码会很有帮助。

编辑：添加另一个可能更容易理解的示例，以下是我需要的排序方式

```
a  
b  
c  
z  
a.b  
a.c  
a.d  
a.z  
a.b.a  
a.c.a  
a.b.b  
a.b.c  
a.c.c  
a.a.d  
b.a  
b.b  
b.z  
b.a.a  
b.b.a  
b.a.b  
c.c.f 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:15:34.077

现在应该好了。

```
public int compare(String a, String b) {
String[] partsA = a.split("\\.");
String[] partsB = b.split("\\.");

// If first term is different, we exit.
if (partsA[0].compareTo(partsB[0]) != 0) return partsA[0].compareTo(partsB[0]);

// Else, first term is identical.
else {
    // Same number of parts
    if (partsA.length == partsB.length) {
        // 2 parts, we compare the 2nd part.
        if (partsA.length == 2) {
            return partsA[1].compareTo(partsB[1]);
        // 3 parts, we compare the 3rd part first, then the 2nd part        
        } else {
            if (partsA[2].compareTo(partsB[2]) != 0) return partsA[2].compareTo(partsB[2]);
            return partsA[1].compareTo(partsB[1]);
        }

    // Different number of parts
    } else {
        // If A has only 1 part, it's first
        if (partsA.length == 1) return -1;
        // If B has only 1 part, it's first
        if (partsB.length == 1) return 1;

        // Case 2 vs 3 parts, we compare the 3rd part with the 2nd part of the other. If it's equal, the shorter is first.
        if (partsA.length == 3) {
            if (partsA[2].compareTo(partsB[1]) != 0) return partsA[2].compareTo(partsB[1]);
            else return 1;
        } else {
            if (partsA[1].compareTo(partsB[2]) != 0) return partsA[1].compareTo(partsB[2]);
            else return -1;
        }           
    }
}
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T16:44:50.197

另一种选择，使其递归，如果有更多条目，您可以避免问题。

import java.util.ArrayList; import java.util.Arrays; import java.util.Comparator; import java.util.List;

```
public class SortTest {
    public static void main(String[] args) {
        String[] test = new String[]{
            "a",
            "b",
            "b.a",
            "b.a.a",
            "a.a.a",
            "a.b.a",
            "a.a",
            "a.b",
            "b.a.b",
            "b.b.a"
        };

        Arrays.sort(test, new Comparator<String>() {

        int compareComplexList(List<String> a, List<String> b, List<int[]> positions, int order ) {

          int minimum = a.size() < b.size() ? a.size() - 1 : b.size() - 1;   

          if (a.get(positions.get(minimum)[order]).compareTo(b.get(positions.get(minimum)[order])) != 0)
                return a.get(positions.get(minimum)[order]).compareTo(b.get(positions.get(minimum)[order]));
          else if (order < minimum - 1) return compareComplexList(a,b, positions, ++order);
          else return Double.compare(a.size(),b.size());
        }

        public int compare(String a, String b) {
          List<String> partsA = Arrays.asList(a.split("\\."));
          List<String> partsB = Arrays.asList(b.split("\\."));
          List<int[]>  orders = new ArrayList<int[]>();

          orders.add(new int[] {0});
          orders.add(new int[] {0,1});
          orders.add(new int[] {0,2,1});

          return compareComplexList(partsA, partsB, orders,0);
        }
        });
        System.out.println("Sorted: "+Arrays.toString(test));
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T17:07:47.177

My other answer started getting too gnarly. Here's a better, more natural solution:

```
public class StrangeComparator {
  private static class Entry implements Comparable<Entry> {
    // What to split with.
    static final String dot = Pattern.quote(".");
    // The parts.
    final String key;
    final String page;
    final String site;

    public Entry(String s) {
      String [] parts = s.split(dot);
      switch (parts.length) {
        case 1:
          key = parts[0];
          page = "";
          site = "";
          break;

        case 2:
          key = parts[1];
          page = "";
          site = parts[0];
          break;

        case 3:
          key = parts[2];
          page = parts[1];
          site = parts[0];
          break;

        default:
          throw new IllegalArgumentException("There must be at least one part to an entry.");
      }
    }

    @Override
    public int compareTo(Entry t) {
      int diff = site.compareTo(t.site);
      if ( diff == 0 ) {
        diff = page.compareTo(t.page);
      }
      if ( diff == 0 ) {
        diff = key.compareTo(t.key);
      }
      return diff;
    }

    @Override
    public String toString () {
      return (site.length() > 0 ? site + "." : "")
              + (page.length() > 0 ? page + "." : "")
              + key;
    }
  }

  public void test() {
    String[] test = new String[]{
      "alpha",
      "beta",
      "charlie",
      "zeta", // Added to demonstrate correctness.
      "sitea.alpha",
      "sitea.charlie",
      "sitea.pagea.beta",
      "sitea.pageb.beta",
      "sitea.pagea.charlie",
      "siteb.alpha",
      "siteb.delta",
      "siteb.pagef.alpha",
      "siteb.pageb.echo",
      "siteb.pageb.golf",
      "siteb.pagea.hotel",
      "siteb.pageb.hotel",
      "siteb.pagec.hotel"
    };
    Arrays.sort(test);
    System.out.println("Normal sort: " + Separator.separate("\n", "\n", test));
    Entry[] entries = new Entry[test.length];
    for ( int i = 0; i < test.length; i++ ) {
      entries[i] = new Entry(test[i]);
    }
    Arrays.sort(entries);
    System.out.println("Special sort: " + Separator.separate("\n", "\n", entries));
  }

  public static void main(String args[]) {
    new StrangeComparator().test();
  }
} 
```

Output order is:

```
alpha
beta
charlie
zeta
sitea.alpha
sitea.charlie
sitea.pagea.beta
sitea.pagea.charlie
sitea.pageb.beta
siteb.alpha
siteb.delta
siteb.pagea.hotel
siteb.pageb.echo
siteb.pageb.golf
siteb.pageb.hotel
siteb.pagec.hotel
siteb.pagef.alpha 
```

Which kinda does what you say but doesn't match your example.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T14:39:17.597

这是另一种选择 - 如果发现一个组件包含少于 3 个零件，则在开始时添加零件以填补空缺。然后它使用排序顺序数组来定义接下来应该比较哪些列：

```
 public void test() {
    String[] test = new String[]{
      "alpha",
      "beta",
      "charlie",
      "zeta", // Added to demonstrate correctness.
      "sitea.alpha",
      "sitea.charlie",
      "sitea.pagea.beta",
      "sitea.pageb.beta",
      "sitea.pagea.charlie",
      "siteb.alpha",
      "siteb.delta",
      "siteb.pagef.alpha",
      "siteb.pageb.echo",
      "siteb.pageb.golf",
      "siteb.pagea.hotel",
      "siteb.pageb.hotel",
      "siteb.pagec.hotel"
    };
    Arrays.sort(test);
    System.out.println("Normal sort: "+Arrays.toString(test));
    Arrays.sort(test, new Comparator<String>() {
      // How many columns to pad to.
      final int padTo = 3;
      // What to pad with.
      final String padWith = "";
      // What order to compare the resultant columns in.
      final int[] order = {0, 2, 1};

      @Override
      public int compare(String s1, String s2) {
        String[] s1parts = padArray(s1.split(Pattern.quote(".")), padTo, padWith);
        String[] s2parts = padArray(s2.split(Pattern.quote(".")), padTo, padWith);
        int diff = 0;
        for ( int i = 0; diff == 0 && i < order.length; i++ ) {
          diff = s1parts[order[i]].compareTo(s2parts[order[i]]);
        }
        return diff;
      }

      String [] padArray(String[] array, int padTo, String padWith) {
        String [] padded = new String[padTo];
        for ( int i = 0; i < padded.length; i++ ) {
          padded[padded.length - i - 1] = i < array.length ? array[i]: padWith;
        }
        return padded;
      }
    });
    System.out.println("Special sort: "+Arrays.toString(test));
  } 
```

打印（或多或少）：

```
Normal sort: [alpha,
 beta,
 charlie,
 sitea.alpha,
 sitea.charlie,
 sitea.pagea.beta,
 sitea.pagea.charlie,
 sitea.pageb.beta,
 siteb.alpha,
 siteb.delta,
 siteb.pagea.hotel,
 siteb.pageb.echo,
 siteb.pageb.golf,
 siteb.pageb.hotel,
 siteb.pagec.hotel,
 siteb.pagef.alpha,
 zeta]
Special sort: [alpha,
 beta,
 charlie,
 sitea.alpha,
 sitea.charlie,
 siteb.alpha,
 siteb.delta,
 zeta,
 siteb.pagef.alpha,
 sitea.pagea.beta,
 sitea.pageb.beta,
 sitea.pagea.charlie,
 siteb.pageb.echo,
 siteb.pageb.golf,
 siteb.pagea.hotel,
 siteb.pageb.hotel,
 siteb.pagec.hotel] 
```

您的要求似乎有些模棱两可，但这段代码是结构化的，因此您可以通过微不足道的调整，非常简单地实现对比较的大多数解释。

# sql - 如何在嵌套组中聚合 SQL 中的数据

> ID：15549756
> 
> 赞同：2
> 
> 时间：2013-03-21T14:05:18.607
> 
> 标签：sql, postgresql, group-by

我正在使用 PostgreSQL 并且有一个这样的表：请参阅此处的 sql fiddle：[http ://sqlfiddle.com/#!1/253b4/1](http://sqlfiddle.com/#!1/253b4/1)

```
CREATE TABLE usage_sample
(
  id serial primary key, 
  category text NOT NULL,
  name text NOT NULL,
  sample_time timestamp with time zone NOT NULL
); 
```

我需要编写一个查询，返回每分钟内样本数的计数，并为每个类别和名称的组合提供这组计数。所以我们的输出是这样的：

```
cat1, act1, minute1, count
cat1, act1, minute2, count
cat1, act2, minute1, count
cat1, act2, minute3, count
cat2, act1, minute2, count
... 
```

我知道如何使用 group by 获取每分钟的计数，以及如何获取类别和操作的每个组合的计数，但我不知道如何将这些组合起来，以便我可以嵌套分组和计数。

sql fiddle [http://sqlfiddle.com/#!1/253b4/1](http://sqlfiddle.com/#!1/253b4/1)显示了一个示例数据集和我尝试开始的查询。谁能给我建议如何获得我需要的结果？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T14:09:45.820

这是你想要的吗？

```
select category, name, date_trunc('minute', sample_time) as minute, count(*) 
from usage_sample 
group by category, name, date_trunc('minute', sample_time)
order by category, name, minute 
```

# plone - 通过网络管理 Plone 词汇表

> ID：15549763
> 
> 赞同：3
> 
> 时间：2013-03-21T14:05:32.517
> 
> 标签：plone, zope, vocabulary

我目前正在开发一个具有多种自定义内容类型的 Plone 项目。这些内容类型有几个字段，这些字段依次从词汇表中获取它们的值。目前，我刚刚将我的值硬编码在一个`vocabularies.py`文件中，如下所示：

```
from Products.Archetypes import atapi

CITIES_LIST = atapi.DisplayList((
    ('nairobi', 'Nairobi'),
    ('kisumu', 'Kisumu'),
    ('mombasa', 'Mombasa'),
    ('eldoret', 'Eldoret'),
    ('nakuru', 'Nakuru'),
    )) 
```

这很好用，没有问题。

唯一的缺点是词汇表是刻在代码中的，需要程序员/开发人员来修改现有的词汇表。

我需要的是一种方式，让不一定是程序员的站点管理员和用户能够在未来通过 Web 界面修改词汇表，即来自另一个国家的客户能够更改可用城市列表。

我看过[Products.ATVocabularyManager](https://pypi.python.org/pypi/Products.ATVocabularyManager/)但我认为它不符合要求。也许如果有一个带有网格的界面来管理词汇表。我想我将不得不通过将它们存储为 ArcheTypes 来管理它们。

有没有办法在 Plone 4 中处理这种情况？一个人会怎么做？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T15:02:39.043

Products.ATVocabularyManager 应该适用于您的用例。我过去曾多次成功使用过它。

它提供了一个管理 UI 来管理您的词汇表。

如果管理词汇的 UI 不符合您的喜好，也许您可​​以为项目做出贡献以使其变得更好？

# linq - 为什么对 DataTable 的 LINQ 查询不起作用？

> ID：15549767
> 
> 赞同：-1
> 
> 时间：2013-03-21T14:05:37.863
> 
> 标签：linq, c#-4.0, datatable

我有一个 DataTable，dt，它包含以下内容：![在此处输入图像描述](../Images/7f88755048f234b0784cd8daafac056f.png)

如您所见，这里有两组文件：基线（第 1-3 列）和目标（第 4-6 列）。所以在这种情况下，我有 4 个基线文件，m4、m5、m1 和 m3（第 5 行中的 m1 是从第 3 行复制的）和一个目标文件 m1。问题是基线文件 m1.txt 的信息是重复的，所以我尝试使用以下 LINQ 语句将其删除：

```
var extraneousRows = dt.Rows.Cast<DataRow>().
    Where(
        row => row["BASELINE_FOLDER"] == baselineSubfolder
        && row["BASELINE_FILE"] == baselineFilename
        && row["BASELINE_CHECKSUM"] == baselineChecksum
        && row["STATUS"] == "remove"
    ).ToArray();

foreach (DataRow dr in extraneousRows)
    {
        dt.Rows.Remove(dr);
    } 
```

这应该从 DataTable 中删除第三行，但事实并非如此。如果我省略该 `&& row["STATUS"] == "remove"`行，代码可以正常工作，所以我知道它是有效的。并且baselineSubfolder、baselineFilename 和baselineChecksum 的值是正确的，所以这不是问题所在。

但是由于某种原因，当我包含关于状态列的那一行时，它没有检测到该行在 DataTable 中，即使它显然是根据 DataSet Visualizer（上图）。所以它永远不会进入 foreach 循环，也不会删除必要的文件。为什么？？？

我可能应该提到基线文件信息（前 4 行）是从数据库中检索的，而目标文件字段是根据用户输入生成的。不过，我看不出信息的来源有什么关系，因为我直接查询 DataTable ......

**更新**

好的，在遵循 idipous 和 Jamie Keeling 的建议后，我确​​定问题与从未填充过的 foreach 循环有关。因为这个查询应该只返回一行，所以我完全消除了循环。我修改后的代码如下所示：

```
var extraneousRows = dt.Rows.Cast<DataRow>().
    Where(
        row => row["BASELINE_FOLDER"] == baselineSubfolder
        && row["BASELINE_FILE"] == baselineFilename
        && row["BASELINE_CHECKSUM"] == baselineChecksum
        && row["STATUS"] == "remove"
    ).SingleOrDefault();

dt.Rows.Remove(extraneousRows); 
```

无论出于何种原因， extraneousRows 保持为空，并且最后一行正在生成运行时错误：`IndexOutOfRangeException: The given DataRow is not in the current DataRowCollection`

为什么这不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:16:31.300

实际上，问题在于我需要将列值转换为字符串。解决方案非常简单：只需在列名和中提琴后添加一个 .ToString() ！下面的代码就像一个魅力：

```
var extraneousRows = dt.Rows.Cast<DataRow>().
    Where(
        row => row["BASELINE_FOLDER"].ToString() == baselineSubfolder
        && row["BASELINE_FILE"].ToString() == baselineFilename
        && row["BASELINE_CHECKSUM"].ToString() == baselineChecksum
        && row["STATUS"].ToString() == "remove"
    ).SingleOrDefault();

dt.Rows.Remove(extraneousRows); 
```

通过遍历 DataTable 的所有行，我还找到了一种非 LINQ 方法。这不是最有效的，但它有效：

```
for (int z = 0; z < dt.Rows.Count; z++)
{
    if ((dt.Rows[z]["BASELINE_FOLDER"].ToString() == baselineSubfolder)
        && (dt.Rows[z]["BASELINE_FILE"].ToString() == baselineFilename)
        && (dt.Rows[z]["BASELINE_CHECKSUM"].ToString() == baselineChecksum)
        && (dt.Rows[z]["STATUS"].ToString() == "remove"))
    {
        dt.Rows[z].Delete();
    }
}
dt.AcceptChanges(); 
```

# python - 隐藏孩子时，主窗口的大小发生变化

> ID：15549770
> 
> 赞同：1
> 
> 时间：2013-03-21T14:05:54.593
> 
> 标签：python, pyqt

我有一个`QTabWidget`隐藏的。当我显示它时，主窗口会增长，但在`QTabWidget`再次隐藏后，主窗口没有所需的大小。位于`QTabWidget`（`QGridlayout`主窗口布局）中。我已经尝试了所有这些，一次一个，但无法让它工作：

```
def optionsView(self):
    """
    Hide or show the Tab-widget
    """
    if self.tabWidget.isVisible():
        self.tabWidget.hide()
        self.setMaximumHeight(100)
        self.gridLayout.update()
        self.update()
        self.gridLayout.setSizePolicy(QSizePolicy.Minimum, QSizePolicy.Minimum)
        self.resize(QSize(200,200))
        print self.tabWidget.geometry() 
```

# javascript - EmberJs，一个动作可以多视图吗？如何从列表项中获取列表视图？

> ID：15549774
> 
> 赞同：0
> 
> 时间：2013-03-21T14:06:03.600
> 
> 标签：javascript, ember.js, javascriptmvc

1.controller与action和view的关系是什么？

我想我混合了其中的一些东西。

2.如果我定义一个'userController'。它控制用户列表视图吗？

我应该定义一个“usersController”来显示用户列表吗？

如果推荐一些 embjs 的示例大型项目，那就更好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T15:46:37.507

已经有如此庞大的演示项目：例如[Discourse](https://github.com/discourse/discourse)或[Travis](https://github.com/travis-ci/travis-ci)

如果您想要一个较小的项目，请查看@this [example](https://github.com/dgeb/ember_data_example)

# java - 在继承的类中使用私有变量 - Java

> ID：15549775
> 
> 赞同：12
> 
> 时间：2013-03-21T14:06:06.053
> 
> 标签：java, inheritance, access-modifiers

需要对私有变量和继承有更多的了解。早些时候我的理解是，如果一个类中有字段，并且当我继承该类时，不受访问（私有变量）限制的字段将存在于继承的类中。但如果有公共 g/setter 方法，我可以在基类中使用私有变量。

我怎么能想象基类中的私有变量。？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-21T14:13:12.680

这就是 Java 教程[http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html](http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html)所说的：

*子类不继承其父类的私有成员。但是，如果超类具有访问其私有字段的公共或受保护方法，则子类也可以使用这些方法*。

尽管如此，看到这个

```
class A {
   private int i;
}

class B extends A {
}

B b = new B();
Field f = A.class.getDeclaredField("i");
f.setAccessible(true);
int i = (int)f.get(b); 
```

`i`它工作正常并从 B 实例返回字段值。也就是说，B 有`i`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-21T14:14:30.563

```
class A {
  private int a;
  public A(int a) { this.a = a; }
  public int getA() {return a;}
}

class B extends A {
  public B(int b) { super(b); }
  public int getB() {return getA();}
}

int result = new B(10).getA(); 
```

结果将是 10。A 类中的私有字段 a 有点继承给 B，但 B 不能直接访问它。仅通过使用 A 类中定义的公共/默认/受保护的访问器方法。B 是 A，因此它始终具有 A 中的所有相同字段，并且可能在 B 类中定义一些新字段。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-21T14:09:15.383

私有变量/成员不被继承。这是唯一的答案。

提供公共访问器方法是封装的工作方式。您将数据设为私有并提供获取或设置其值的方法，以便可以控制访问。

# android - 他们用什么类来绘制这样的音频频谱？

> ID：15549778
> 
> 赞同：1
> 
> 时间：2013-03-21T14:06:09.883
> 
> 标签：android, fft, android-canvas, spectrum

[https://lh4.ggpht.com/Z6q1y1F3B0pIzjbLiPx6AlO4B9aimrjcJObvBQb-Kz3ZNu-6F_Cr3BeXGmbvkgUMZA](https://lh4.ggpht.com/Z6q1y1F3B0pIzjbLiPx6AlO4B9aimrjcJObvBQb-Kz3ZNu-6F_Cr3BeXGmbvkgUMZA)

[https://lh6.ggpht.com/ZTm9aLqj-Faaa0G5bqafudhkEPHTSQ3QhzqJc7uQFPdBGPHPx7QXpxDt-BHq9sAMhus](https://lh6.ggpht.com/ZTm9aLqj-Faaa0G5bqafudhkEPHTSQ3QhzqJc7uQFPdBGPHPx7QXpxDt-BHq9sAMhus)

我认为他们在 android.graphics.Canvas 中使用类，但不确定。现在我想像图片一样绘制音频频谱？有人知道他们用什么类来绘制这样的音频频谱？？？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:09:24.543

命名空间 android.Graphics 提供基础对象来构建您自己的图形。您需要绘制背景、线条、文本并尝试获得您想要的东西。

Canva 对象有几个方法：

[http://developer.android.com/reference/android/graphics/Canvas.html](http://developer.android.com/reference/android/graphics/Canvas.html)

例如，您可以使用以下方法绘制线条：

canvas.drawLine(float startX, float startY, float stopX, float stopY, Paint paint)。

Paint 对象用于具有特定的线条颜色/宽度...

# c - 套接字只接受特定地址？

> ID：15549780
> 
> 赞同：0
> 
> 时间：2013-03-21T14:06:13.713
> 
> 标签：c, sockets

我正在根据下面列出的示例编写一个小型 tcp 服务器，来自[这里](http://linux.die.net/man/2/bind)。

```
#include <sys/socket.h>
#include <sys/un.h>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#define MY_SOCK_PATH "/somepath"
#define LISTEN_BACKLOG 50

#define handle_error(msg) \
    do { perror(msg); exit(EXIT_FAILURE); } while (0)

int
main(int argc, char *argv[])
{
    int sfd, cfd;
    struct sockaddr_un my_addr, peer_addr;
    socklen_t peer_addr_size;

   sfd = socket(AF_UNIX, SOCK_STREAM, 0);
    if (sfd == -1)
        handle_error("socket");

   memset(&my_addr, 0, sizeof(struct sockaddr_un));
                        /* Clear structure */
    my_addr.sun_family = AF_UNIX;
    strncpy(my_addr.sun_path, MY_SOCK_PATH,
            sizeof(my_addr.sun_path) - 1);

   if (bind(sfd, (struct sockaddr *) &my_addr,
            sizeof(struct sockaddr_un)) == -1)
        handle_error("bind");

   if (listen(sfd, LISTEN_BACKLOG) == -1)
        handle_error("listen");

   /* Now we can accept incoming connections one
       at a time using accept(2) */

   peer_addr_size = sizeof(struct sockaddr_un);
    cfd = accept(sfd, (struct sockaddr *) &peer_addr,
                 &peer_addr_size);
    if (cfd == -1)
        handle_error("accept");

   /* Code to deal with incoming connection(s)... */

   /* When no longer required, the socket pathname, MY_SOCK_PATH
       should be deleted using unlink(2) or remove(3) */
} 
```

用于`accept()`打开新连接时，是否可以仅接受来自列入白名单的 IP 地址的连接或以某种方式拒绝列入黑名单的 IP 地址？

到目前为止我发现的唯一技术是首先接受，检查地址，然后如果它不是批准的地址，然后关闭（）。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T15:19:32.403

使用 POSIX API 和 TCP，您必须执行 accept() 来查找客户端地址，然后您可以自由地关闭、接收、发送或忽略。

通常你会使用操作系统防火墙来完成这样的任务。

请记住，忽略某些客户端不会增加安全性，因为您仍然容易受到中间人、重放和嗅探攻击。

# javascript - jQuery 实时验证

> ID：15549782
> 
> 赞同：0
> 
> 时间：2013-03-21T14:06:14.250
> 
> 标签：javascript, jquery

我正在尝试为表单创建实时验证脚本。我有点明白了，我想无论如何......但是当字段中有文本而不是没有文本时会出现错误消息。我确定我在做一些愚蠢的错误，我很确定我的 if 值是正确的，`value == ''`如果 value 什么都不`value !== ''`是，如果 value 不是什么都不是，对吧？啊，也许这是我应该改变的开启/改变的事情？希望你能帮忙。谢谢你。

[http://jsfiddle.net/Vjwxs/3/](http://jsfiddle.net/Vjwxs/3/)

```
$(document).ready(function () {    
    $('#name').on('change', function() {
        var name = $("#name").val();
        if (!this.value == '') {
            $("#errorname").fadeIn();
            $('#errorname').css("display", "inline-block");
            $('#errorname').css("color", "#838383");
            $('#errorname').css("background-color", "#fff568");
        }
        else if (!this.value !== '' ) {
            $("#errorname").fadeOut();
            $('#errorname').css("display", "none");
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T14:09:34.880

`if`大声读出你的条件。这应该可以帮助您意识到问题出在哪里：

```
if (!this.value == '') { /* Show the error */ } 
```

“如果*不是*，则此值等于空字符串”。或者，以更易于理解的形式，“如果此值*不*等于空字符串”。您实际上想要显示错误“如果此值*等于*空字符串”。

```
if (!this.value !== '' ) { /* Hide the error */ } 
```

“如果*不是*，此值*不*等于空字符串”。再一次，更具可读性，“如果这个值*不*等于空字符串”。您实际上想隐藏“如果此值*不*等于空字符串”的错误。

如果您[从两个条件中删除第一个否定，](http://jsfiddle.net/Vjwxs/4/)您的代码将起作用。

# android - 可以将android登录应用程序与托管在ubuntu机器上的远程数据库连接起来

> ID：15549785
> 
> 赞同：-4
> 
> 时间：2013-03-21T14:06:23.760
> 
> 标签：android

我正在构建一个小型 android 应用程序来连接数据库并检查用户名和密码是否匹配，然后它应该给我消息，否则 || . 我的数据库托管在我的虚拟机 Ubuntu 上。

```
<?php
    $con= mysql_connect("localhost","root","123456") or die ("can't connect");

    mysql_select_db("androiddb",$con) or die("can't select the database");
    $username = $_POST['username'];
    $password = $_POST['password'];
    $query = mysql_query("SELECT * FROM androidlogin WHERE user=$username' AND                        pass=$password");

    $num = mysql_num_rows($query);
    if($num == 1){

        while($list = mysql_fetch_assoc($num)){

            $output[] = $list;

            echo json_decode($output);
        }
    }
    mysql_close(); 
```

我的java文件。包 com.example.logintutorial；

```
 /// solved the problem from this link
    //http://stackoverflow.com/questions/3538647/android-development-button-onclicklisteners-help
    //import android.view.View.OnClickListener;

    public class MainActivity extends Activity implements OnClickListener, android.view.View.OnClickListener {

        EditText etUser,etPass;
        Button bLogin;
        String username, password;
        // use http clinet as form of container
        HttpClient httpClient;

        HttpPost httpposts;
         //create an arry list of data to be sent
        ArrayList<NameValuePair> nameValuePairs;
        // http response http entity
        HttpResponse response;
        HttpEntity entity;

        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);

            initialise();
        }

        @Override
        public boolean onCreateOptionsMenu(Menu menu) {
            // Inflate the menu; this adds items to the action bar if it is present.
            getMenuInflater().inflate(R.menu.activity_main, menu);
            return true;
        }

        public void initialise(){
            etUser = (EditText) findViewById(R.id.etUser);
            etPass = (EditText) findViewById(R.id.etPass);
            bLogin = (Button) findViewById(R.id.etSubmit);
            bLogin.setOnClickListener(this);
        }

        @Override
        public void onClick(View v) {
            //defualt http clinet

            DefaultHttpClient httpclient = new DefaultHttpClient();

            final String KEY_121= "http://192.168.1.139:8080/android_login/newfile.php";

            //create new HTTp post with Url to php file as master
            HttpPost httppost = new HttpPost(KEY_121);

            //ssign inpyt to the strings
            username= etUser.getText().toString();
            password= etPass.getText().toString();

            try{
                        //create a new array list
                        nameValuePairs = new ArrayList<NameValuePair>();

                        //place them in array list
                        nameValuePairs.add(new BasicNameValuePair("username",username));
                        nameValuePairs.add(new BasicNameValuePair("password",password));

                         // add the array to the post
                        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

                        //assign excuted form container to response
                        response = httpclient.execute(httppost);

                        //check ing the status code
                        if(response.getStatusLine().getStatusCode()==200){
                            // assign respone to http entity
                            entity = response.getEntity();
                            //if enitty is not null
                            if(entity!=null){
                                // create an entity with reviecd data assing

                                InputStream instream = entity.getContent();
                                //Create new Json Object. assing converted data as a paramter

                                JSONObject jsonResponse = new JSONObject(convertStreamToString(instream));

                                String retUser= jsonResponse.getString("user");//mysql field
                                String retPass= jsonResponse.getString("pass");

                                if(username.equals(retUser) && password.equals(retPass)){

                                    //create a new shared perefere by getting the preference

                                    SharedPreferences sp =  getSharedPreferences("Logindetails",0);
                                    SharedPreferences.Editor spedit =  sp.edit();
                                    spedit.putString("user", username);
                                    spedit.putString("pass", password);

                                    spedit.commit();

                                    //login success message
                                    Toast.makeText(getBaseContext(),"You are logged in", Toast.LENGTH_SHORT).show();

                                } else{

                                    //display 
                                    Toast.makeText(getBaseContext(),"Invalid Login", Toast.LENGTH_SHORT).show();
                                }
                            }
                        }
                    }catch (Exception e){
                        e.printStackTrace();
                        Toast.makeText(getBaseContext(),"Connection Error", Toast.LENGTH_SHORT).show();
                    }
        }

        @Override
        public void onClick(DialogInterface dialog, int which) {

        }

        private static String convertStreamToString(InputStream is) {

            BufferedReader reader = new BufferedReader(new InputStreamReader(is));
            StringBuilder sb = new StringBuilder();

            String line = null;
            try {
                while ((line = reader.readLine()) != null) {
                    sb.append(line + "\n");
                }
            } catch (IOException e) {
                e.printStackTrace();
            } finally {
                try {
                    is.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
            return sb.toString();
        }
    } 
```

我的清单

```
 <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="16" />
        <uses-permission android:name="android.permission.INTERNET"/>
        <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
        <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.logintutorial.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

我的错误。单击登录时。我在 catch 部分收到“连接错误”。这在我的聊天记录中

```
03-21 10:03:45.479: W/IInputConnectionWrapper(635): showStatusIcon on                      inactive InputConnection
                                       03-21 10:03:57.849: D/InputEventConsistencyVerifier(635): KeyEvent:                        ACTION_UP but key was not down.
                                       03-21 10:03:57.849: D/InputEventConsistencyVerifier(635):   in android.widget.EditText@41213f98
                                       03-21 10:03:57.849: D/InputEventConsistencyVerifier(635):   0: sent at                   182837000000, KeyEvent { action=ACTION_UP, keyCode=KEYCODE_TAB, scanCode=15, metaState=0,               flags=0x8, repeatCount=0, eventTime=182837, downTime=182714, deviceId=0, source=0x101 }
                                      03-21 10:04:00.579: W/System.err(635): android.os.NetworkOnMainThreadException
                    03-21 10:04:00.589: W/System.err(635):  at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
                    03-21 10:04:00.589: W/System.err(635):  at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:84)
                    03-21 10:04:00.589: W/System.err(635):  at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
                    03-21 10:04:00.589: W/System.err(635):  at libcore.io.IoBridge.connect(IoBridge.java:112)
                    03-21 10:04:00.589: W/System.err(635):  at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
                    03-21 10:04:00.589: W/System.err(635):  at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
                    03-21 10:04:00.599: W/System.err(635):  at java.net.Socket.connect(Socket.java:842)
                    03-21 10:04:00.599: W/System.err(635):  at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:119)
                    03-21 10:04:00.599: W/System.err(635):  at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:144)
                    03-21 10:04:00.599: W/System.err(635):  at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
                    03-21 10:04:00.599: W/System.err(635):  at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
                    03-21 10:04:00.609: W/System.err(635):  at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
                    03-21 10:04:00.609: W/System.err(635):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
                    03-21 10:04:00.609: W/System.err(635):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
                    03-21 10:04:00.609: W/System.err(635):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
                    03-21 10:04:00.609: W/System.err(635):  at com.example.logintutorial.MainActivity.onClick(MainActivity.java:114)
                    03-21 10:04:00.609: W/System.err(635):  at android.view.View.performClick(View.java:4084)
                    03-21 10:04:00.620: W/System.err(635):  at android.view.View$PerformClick.run(View.java:16966)
                    03-21 10:04:00.620: W/System.err(635):  at android.os.Handler.handleCallback(Handler.java:615)
                    03-21 10:04:00.620: W/System.err(635):  at android.os.Handler.dispatchMessage(Handler.java:92)
                    03-21 10:04:00.629: W/System.err(635):  at android.os.Looper.loop(Looper.java:137)
                    03-21 10:04:00.629: W/System.err(635):  at android.app.ActivityThread.main(ActivityThread.java:4745)
                    03-21 10:04:00.629: W/System.err(635):  at java.lang.reflect.Method.invokeNative(Native Method)
                    03-21 10:04:00.629: W/System.err(635):  at java.lang.reflect.Method.invoke(Method.java:511)
                    03-21 10:04:00.629: W/System.err(635):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
                    03-21 10:04:00.639: W/System.err(635):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
                    03-21 10:04:00.639: W/System.err(635):  at dalvik.system.NativeStart.main(Native Method)
                    03-21 10:04:05.069: W/System.err(635): android.os.NetworkOnMainThreadException
                    03-21 10:04:05.069: W/System.err(635):  at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)
                    03-21 10:04:05.069: W/System.err(635):  at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:84)
                    03-21 10:04:05.079: W/System.err(635):  at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
                    03-21 10:04:05.079: W/System.err(635):  at libcore.io.IoBridge.connect(IoBridge.java:112)
                    03-21 10:04:05.079: W/System.err(635):  at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
                    03-21 10:04:05.079: W/System.err(635):  at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:459)
                    03-21 10:04:05.089: W/System.err(635):  at java.net.Socket.connect(Socket.java:842)
                    03-21 10:04:05.089: W/System.err(635):  at org.apache.http.conn.scheme.PlainSocketFactory.connectSocket(PlainSocketFactory.java:119)
                    03-21 10:04:05.099: W/System.err(635):  at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:144)
                    03-21 10:04:05.099: W/System.err(635):  at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
                    03-21 10:04:05.099: W/System.err(635):  at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
                    03-21 10:04:05.099: W/System.err(635):  at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
                    03-21 10:04:05.099: W/System.err(635):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
                    03-21 10:04:05.099: W/System.err(635):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
                    03-21 10:04:05.109: W/System.err(635):  at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
                    03-21 10:04:05.109: W/System.err(635):  at com.example.logintutorial.MainActivity.onClick(MainActivity.java:114)
                    03-21 10:04:05.109: W/System.err(635):  at android.view.View.performClick(View.java:4084)
                    03-21 10:04:05.119: W/System.err(635):  at android.view.View$PerformClick.run(View.java:16966)
                    03-21 10:04:05.119: W/System.err(635):  at android.os.Handler.handleCallback(Handler.java:615)
                    03-21 10:04:05.119: W/System.err(635):  at android.os.Handler.dispatchMessage(Handler.java:92)
                    03-21 10:04:05.119: W/System.err(635):  at android.os.Looper.loop(Looper.java:137)
                    03-21 10:04:05.129: W/System.err(635):  at android.app.ActivityThread.main(ActivityThread.java:4745)
                    03-21 10:04:05.129: W/System.err(635):  at java.lang.reflect.Method.invokeNative(Native Method)
                    03-21 10:04:05.129: W/System.err(635):  at java.lang.reflect.Method.invoke(Method.java:511)
                    03-21 10:04:05.129: W/System.err(635):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
                    03-21 10:04:05.129: W/System.err(635):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
                    03-21 10:04:05.129: W/System.err(635):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:15:57.313

您正在尝试从 UI 线程访问网络，Android 会`NetworkOnMainThreadException`为此抛出一个。

使用 AsyncTask 连接到您的远程服务器。[这个问题](https://stackoverflow.com/questions/9671546/asynctask-android-example)的答案会帮助你。

请参考：http: [//developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

# c# - 如何滑动 jquery 滑块从数据库中获取值，例如用于幻灯片的 ID 和用于显示的名称

> ID：15549787
> 
> 赞同：1
> 
> 时间：2013-03-21T14:06:27.310
> 
> 标签：c#, jquery, asp.net, jquery-ui-slider

我正在使用 jquery 滑块和静态值，例如 Nikunj 为 1，Ravi 为 2，Ravi 为 5，但我想要 1,2,3，...或者任何整数都应该来自我的表 ID，名称也来自数据库表与我的ID有关。所以，怎么能这样做。

我有简单的 jquery 代码，静态到 1 到 5，`enter code here`但我想要来自数据库的任何整数。我正在使用 snap 来增加滑块

我在 javascript 中的代码：

```
<script type="text/javascript" language="javascript">`$(function () {enter code here
            $("#slider1").slider({
                value:1,       // this value should come from database
                min: 1,        //this value should come from database
                max: 5,        //this value should come from database
                step: 1,
                slide: function (event, ui) {
                    var slideyvalue = getConnectedValueById(ui.value);
                    $("#txtlusty").text(slideyvalue );
                }
            });

        }); 

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:08:39.903

将它们发送到隐藏字段并通过 jQuery 引用它们。

如果你正在使用`MVC`你可以这样做：

```
@Html.HiddenFor(Model.SliderValue);
@Html.HiddenFor(Model.SliderMinVal);
@Html.HiddeFor(Model.SliderMaxVal); 
```

如果你正在使用`ASP.NET WebForms`你可以这样做：

```
<asp:HiddenField ID="SliderValue" runat="server" Value='1' />
<asp:HiddenField ID="SliderMinValue" runat="server" Value='50' />
<asp:HiddenField ID="SliderMaxValue" runat="server" Value='100' /> 
```

然后将其传递给滑块：

```
<script>
      var val = $("#SliderValue").val();
      var minVal = $("#SliderMinVal").val();
      var maxVal = $("#SliderMaxVal").val();

      $("#slider1").slider({
            value:val,       // this value should come from database
            min: minVal,        //this value should come from database
            max: maxVal,        //this value should come from database
            step: 1,
            slide: function (event, ui) {
                var slideyvalue = getConnectedValueById(ui.value);
                $("#txtlusty").text(slideyvalue );
            }
        });

    }); 

</script> 
```

# python - lxml 在 xml 中添加 urlencoding？

> ID：15549795
> 
> 赞同：2
> 
> 时间：2013-03-21T14:06:44.433
> 
> 标签：python, lxml

我将通过表明我在 Windows 7 上使用 Python 2.7.3 (x64) 和 lxml 2.3.6 作为开头。

我有一点奇怪的问题，希望有人能帮忙解决。我还没有在网上找到解决方案，也许我没有在寻找正确的东西。

无论如何，我有一个问题，我使用 lxml 以编程方式构建一些 XML，然后将其输出到文本文件，问题是 lxml 正在将回车转换为文本`&#13;`，几乎就像 urlencoding - 但我没有使用 HTML 我m 使用 XML。

例如，我在记事本中创建了一个简单的文本文件，如下所示：

```
This
is
my
text 
```

然后我构建一些 xml 并将此文本添加到 xml 中：

```
from lxml import etree

textstr = ""
fh = open("mytext.txt", "rb")
for line in fh:
    textstr += line

root = etree.Element("root")
a = etree.SubElement(root, "some_element")
a.text = textstr

print etree.tostring(root) 
```

这里的问题是打印的输出如下所示：

```
<root><some_element>This&#13;
is&#13;
my&#13;
text</some_element></root> 
```

出于我的目的，换行符很好，但`&#13;`元素不是。

我能够弄清楚这是因为我以二进制模式打开文本文件`"rb"`（我实际上需要这样做，因为我的应用程序正在索引一个大文本文件）。如果我不以二进制模式打开文件`"r"`，则输出不包含`&#13;`（但当然，我的索引不起作用）。

我也尝试将其更改`etree.tostring`为：

```
print etree.tostring(root, method="xml") 
```

但是输出没有区别。

现在，我可以将 xml 文本转储为字符串，然后替换`$#13;`工件，但是，我希望有一个更优雅的解决方案 - 因为我解析的文本文件不在我的控制之下，我担心其他元素在我不知情的情况下，文本文件可能会转换为 url 样式编码。

有谁知道防止这种编码发生的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:30:24.383

Windows 使用`\r\n`表示行尾，Unix 使用`\n`. `\r`如果行尾有一个，这将删除`\r`行尾`\r`的.

```
import re
textstr = ""
with open("mytext.txt", "rb") as fh:
    for line in fh:
        textstr += re.sub(r'\r$', '', line)
print(repr(textstr)) 
```

# markerclusterer - 默认情况下，单击标记簇要打开具有完全相同位置标记的蜘蛛

> ID：15549797
> 
> 赞同：3
> 
> 时间：2013-03-21T14:06:48.567
> 
> 标签：markerclusterer

我试图用重叠标记集群（OMS）实现 MarkerCluster（MS）。一切似乎都很好。

但是，我希望修改 OMS 的工作方式，以便如果我单击一个在其下有 2 个点的集群

当我单击任何具有完全相同地理位置的 2 个点的集群时，它会打开一个标记，当我单击该标记时，它会打开带有 2 个标记的蜘蛛。

当我点击集群时我想要什么，直接打开带有 2 个标记的蜘蛛，已经花了很多时间，但仍然没有任何效果。

我已经尝试了很多解决方案，比如

1.当我添加到OMS（oms.addMarker）时，我可以跟踪标记，并且可以根据谷歌地图的zoom_changed事件点击，但它不会触发spiderfy，而是触发我们添加到标记的点击事件...... .

2\. 我看到了一个事件 spiderfy，所以我尝试使用标记对象 (oms.trigger('spiderfy', marker);) 触发该事件，但没有任何效果......

在这里，我也添加了代码片段：

`mc = new MarkerClusterer(map, markers.locations, mcOptions); google.maps.event.addListener(mc, 'clusterclick', function(cluster) {` 在此处输入代码`clusterClicked = true; // HERE WE WANTS TO FIRE SPIDER FUNCTIONALITY ... });`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-26T08:55:40.587

我可以解决这个问题，首先很明显你已经在你的谷歌地图中实现并重叠 Xluster Marker Marker Cluster。

我的解决方案非常简单。

1.  我们捕获markerCluster 的点击事件。
2.  获取markerCluster的标记。
3.  检查所有 markerCluster 标记是否在同一位置。
4.  如果它们在同一位置，我们会触发点击事件，后者会获得 markerCluster 标记。

简而言之，这是代码：

```
 var markerClusterer = new MarkerClusterer(map, allMarkers, {styles: styles[0], clusterClass: 'poiCluster', maxZoom:18}); 
       google.maps.event.addListener(markerClusterer, 'click', function(cluster) {

        var markers = cluster.getMarkers();

        if(estanTodosEnLaMismaPosicion(markers)){
             //to wait for map update
            setTimeout(function(){
                google.maps.event.trigger(markers[markers.length-1], 'click');
            },1000)
        }

        return true;
    });

    function estanTodosEnLaMismaPosicion(markers){
    var cont=0;
    var latitudMaster=markers[0].getPosition().lat();
    var longitudMaster=markers[0].getPosition().lng();
    for(var i=0;i<markers.length;i++){
        if(markers[i].getPosition().lat() === latitudMaster & markers[i].getPosition().lng() === longitudMaster ){
            cont++;
        }else{
            return false;
        }
    }
    if(cont==markers.length){
        return true;
    }else if(cont<markers.length){
        return false;
    }
} 
```

# iphone - 未调用核心数据验证方法 - iPhone

> ID：15549798
> 
> 赞同：1
> 
> 时间：2013-03-21T14:06:48.960
> 
> 标签：iphone, ios, objective-c, xcode, core-data

我有一个 NSManagedObject 子类，我正在尝试使用此子类中的以下方法使数据验证工作：

```
- (BOOL)validatefirstName:(NSString *)ioValue error : (NSError **)outError {
NSLog(@"Validating First Name");
return YES;
} 
```

问题是当一个新值被保存到这个类时，这个方法没有触发。当我更改其中的属性值时是否应该自动调用此方法，还是需要先调用另一个方法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:31:58.223

您的验证方法签名无效。应该是：

```
- (BOOL)validateFirstName:(NSString *)ioValue error : (NSError **)outError 
```

有关详细信息，请参阅[验证方法命名约定](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/Validation.html#//apple_ref/doc/uid/20002173-CJBDBHCB)。

# spring - Spring的“异步”注释方法中的Grails持久性不起作用

> ID：15549808
> 
> 赞同：2
> 
> 时间：2013-03-21T14:07:15.357
> 
> 标签：spring, grails, service, asynchronous

我在 Spring Async 带注释的服务方法中持久化 Grails 域对象时遇到问题。

这是简化的代码：

```
class DocumentService {

@Async
def process(Long documentId, Organization organization) {

    ...

    def organizationCari = new OrganizationCari(organization: organization, active: true)
    organizationCari.save(flush: true, failOnError: true)

    print "Document processing..."

    ...

    print "Document processed..."

} 
```

}

我有异步运行的方法，但是我似乎无法在控制台上打印任何内容，因为线程在保存操作时结束。我没有收到任何错误，并且域对象仍然没有持久化。

删除 Async 注释可以解决问题，但我必须异步运行该方法。

我将 Grails 2.1.1 与 Spring 3.1.2 一起使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T15:17:44.907

问题是新建的异步线程中没有hibernate session，默认`AsyncTaskExecutor`是不记录异常的。

您可以通过`try/catch`在您的方法中放置一个块`@Async`并自己记录异常来自己验证这一点。

解决方案是`Domain.withNewSession`在您的服务方法中使用 GORM 代码：

```
import org.springframework.scheduling.annotation.Async

class MyService {

    @Async
    void myAsyncMethod() {
        MyDomain.withNewSession {
            MyDomain m = new MyDomain(...)
            m.save()
        }
    }
} 
```

如果您有许多异步方法，您可以考虑创建自己的方法，`AsyncTaskExecutor`如在[这个 SO answer](https://stackoverflow.com/a/9045776/459743)中。

# javascript - 在 mvc3 中动态添加 javascripts 函数

> ID：15549810
> 
> 赞同：1
> 
> 时间：2013-03-21T14:07:20.630
> 
> 标签：javascript, asp.net-mvc-3, jquery, dynamic-programming

我正在创建一个动态形式的基础设施。该基础设施将获得一个特定的 XML，其中将包括所有表单数据，从页面中的订单到验证器。

动态页面还可能包含需要某种验证的字段。验证不仅微不足道（例如“数字”\“字母数字”），而且可能更复杂。

这就是为什么我想在我的 XML 中传递验证器 javascripts。

在传统的 Web 应用程序上进行开发时，很容易将这段代码植入页眉中。但是我不知道在使用 MVC3 时该怎么做，因为它不是一个普通的客户端-服务器应用程序。

*重要的是要解释 - 在我的控制器中，我将这个动态表单类传递给 xml 文件，它完成了它应该做的一切，最后，我将结果植入 ViewBag.table 中。*

任何人都知道我怎样才能从控制器中植入 javascript 代码来查看标题？

**编辑：**
我尝试了以下操作：

```
$(document).ready(function () {
        $.ajax({
            url: '@Url.Action("SetJScript", "MyPages")',
            type: 'POST',
            success: function (result) {
        var myscript = document.createElement('script');
                    myscript.setAttribute('type', 'text/javascript');
                    myscript.innerHTML = '$( document ).ready( function ( e ){' + result + '});';
                    document.getElementsByTagName('head').item(0).appendChild(myscript);

            }
        }); 
```

并且：

```
 $(document).ready(function () {
        $.ajax({
            url: '@Url.Action("SetJScript", "MyPages")',
            type: 'POST',
            success: function (result) {
                var myscript = document.createElement('script');
                myscript.setAttribute('type', 'text/javascript');
                myscript.innerHTML = "function test() {alert('aa');}";
                document.getElementsByTagName('head').item(0).appendChild(myscript);
            }
        }); 
```

或更改：

```
myscript.innerHTML = "function test() {alert('aa');}"; 
```

至：

```
myscript.innerHTML += "function test() {alert('aa');}"; 
```

因此它将被添加到现有的“$documnet.ready”函数中。都没有奏效。我不断收到“未知错误”

谢谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T04:15:44.520

希望能帮助到你..

```
 $(document).ready(function () { 

        $.ajax(
    { url: '@Url.Action("SetJScript", "MyPages")',
     type: 'POST',
     success:   function(result) 
    { var myscript = document.createElement('script');      
       myscript.setAttribute('type','text/javascript'); 
       myscript.innerHTML = 'function test() {alert("aa");}'; 
       document.getElementsByTagName('head').item(0).appendChild(myscript); 
    } //end of success
    });
}); 
```

# loops - 迭代 Makefiles 中的列表 - 重新访问

> ID：15549811
> 
> 赞同：2
> 
> 时间：2013-03-21T14:07:23.390
> 
> 标签：loops, foreach, gnu-make

我喜欢 Dylan 对“迭代 Makefile 中的列表”、 [迭代 Makefile 中的列表的问题的回答？](https://stackoverflow.com/questions/977933/iterating-over-lists-in-makefiles)并尝试做类似的事情，但遇到了麻烦。也许儿子可以帮忙。

我的Makefile：

```
PARTITION_TMP:=Joe|red \
               Carl:Mary|white \
               Fritz|blue

partition_tmp:
    @- $(foreach partition_tmp,$(PARTITION_TMP), \
        $(eval N = $(word 1, $(subst |, ,$(partition_tmp)))) \
        $(eval C = $(word 2, $(subst |, ,$(partition_tmp)))) \
        $(call print_tmp, $N, $C) \
    )

define print_tmp
    @echo in print_tmp
    @echo set_global -name PARTITION_NAME $(1)
    @echo set_global -color PARTITION_COLOR $(2) -name PARTITION_NAME $(1)
endef 
```

当我运行 make 时，我得到以下信息：

> 在 print_tmp
> 
> set_global -name PARTITION_NAME 乔
> 
> set_global -color PARTITION_COLOR red -name PARTITION_NAME Joe @echo in print_tmp
> 
> set_global -name PARTITION_NAME 卡尔：玛丽
> 
> set_global -color PARTITION_COLOR white -name PARTITION_NAME Carl:Mary @echo in print_tmp
> 
> set_global -name PARTITION_NAME 弗里茨
> 
> set_global -color PARTITION_COLOR 蓝色 -name PARTITION_NAME Fritz

我不知道为什么我在前两次调用 print_tmp 结束时得到“@echo in print_tmp”（或者可能是最后两次调用 print_tmp 的开始？）

有人可以帮忙吗？

谢谢，马克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T17:15:46.273

这是因为您在`print_tmp`一行上将块串联在一起 - 但这些块有内部换行符。考虑：

```
partition_tmp:
    $(foreach color, red blue, \
  $(call print_tmp, $(color)) \
  )

define print_tmp
    @echo first $(1)
endef 
```

计算结果`foreach`为`@echo first red @echo first blue`，然后作为 shell 命令执行并生成：

```
first red @echo first blue 
```

现在在宏中添加另一行：

```
partition_tmp:
    $(foreach color, red blue, \
  $(call print_tmp, $(color)) \
  )

define print_tmp
    @echo first $(1)
    @echo second $(1)
endef 
```

现在`foreach`评估为

```
@echo first red 
@echo second red @echo first blue
@echo second blue 
```

产生：

```
first red 
second red @echo first blue
second blue 
```

要更正问题，只需添加一个空行：

```
define print_tmp
    @echo in print_tmp
    @echo set_global -name PARTITION_NAME $(1)
    @echo set_global -color PARTITION_COLOR $(2) -name PARTITION_NAME $(1)

endef 
```

# ruby - 无法使用 class_eval 方法添加 ActiveRecord 回调

> ID：15549814
> 
> 赞同：0
> 
> 时间：2013-03-21T14:07:30.443
> 
> 标签：ruby, ruby-on-rails-3.2

我有一个用户模型，其中包括模块人员：

```
class User < ActiveRecord::Base
  include Staff
  ...
end 
```

我想为包含此模块的所有模型添加一个 after_update 回调：

```
module Staff
  def self.included(model)
    model.class_eval do
      after_update :callback
    end
  end

  private
  def callback
    ...
  end
end 
```

我得到一个 NoMethodError：

```
undefined method `after_update' for Object:Class 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:40:53.703

解决了！问题是我有另一个类，包括我的模块 Staff，它不是 ActiveRecord 模型。

# tfs - Team Foundation 错误：用户名或密码不正确

> ID：15549817
> 
> 赞同：0
> 
> 时间：2013-03-21T14:07:32.440
> 
> 标签：tfs, visual-studio-2012

我已连接到 TFS 服务器，可以查看源代码管理资源管理器、签出/签入、创建新项目等。但是，当我尝试从团队资源管理器菜单中访问某些选项时，例如“设置 > 安全”甚至“ Web 访问”我收到一个弹出窗口，显示“用户名或密码不正确”。

请注意，我可以手动转到 servername:8080/tfs 并且一切正常。

# iphone - spotify 播放器在 iphone 中播放旧曲目一段时间

> ID：15549818
> 
> 赞同：1
> 
> 时间：2013-03-21T14:07:32.813
> 
> 标签：iphone, audio, spotify, cocoalibspotify-2.0

我`Spotify`使用`CocoaLibSpotify`库在我的应用程序中实现。我正在从我的应用程序的不同页面播放 Spotify 歌曲。问题是，在我播放了一首歌曲之后，当我尝试从另一个页面播放另一首歌曲时，它会播放旧歌曲一段时间。
这是一些代码示例。

```
self.playbackManager = [[SPPlaybackManager alloc] initWithPlaybackSession:[SPSession sharedSession]];
self.playbackManager.playbackSession.playbackDelegate = (id)self;      
[self.playbackManager playTrack:track callback:^(NSError *error)  
{
   if ((error || ([track availability] != SP_TRACK_AVAILABILITY_AVAILABLE)))
   {
   }
   else
   {

   }
}]; 
```

请帮我解决问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T17:04:38.927

听起来您正在为应用程序的每个页面创建一个新的播放管理器。不要这样做，否则它们会相互重叠。

在您的整个应用程序中只有一个播放管理器 - 这样，当您使用 播放新曲目时`playTrack:callback:`，新曲目将立即替换旧曲目。请注意，您不*直接*设置`currentTrack`属性 - 它是只读的。

# javascript - Javascript中的OADate到毫秒时间戳

> ID：15549823
> 
> 赞同：4
> 
> 时间：2013-03-21T14:07:45.277
> 
> 标签：javascript, datetime, timestamp

我尝试做与以下完全相反的事情：

[javascript 中 DateTime.ToOADate() 的等价物是什么？](https://stackoverflow.com/questions/7348805/what-is-equivalent-of-datetime-tooadate-in-javascript)

从 OADate（自 1899 年 12 月 30 日以来的天数作为双精度值）创建毫秒日期（自 1970 年 1 月 1 日以来的毫秒数）

我的猜测是我可以这样做：

```
this.unixTimeStampFromOADate = function( OADateFloat)
{
        var oaDateFor1970 = ?? ; //what's the value for 1/1/1970 in OADate format ?
        var delta = Math.floor(OADateFloat - oaDateFor1970);

        return delta*(1000*60*60*24); 
} 
```

所以如果我是对的，我需要 OADate 格式的 1/1/1970 的值。如果我错了，请您建议另一种转换方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T14:28:52.517

Javascript 日期使用的时间值是自 1970-01-01T00:00:00Z 以来的毫秒数。日期 1899-12-30 的时间值为 -2209197600000。

要获取从那时起的天数，请获取今天开始时午夜的毫秒数，从 OA 纪元中减去它，然后除以一天中的毫秒并获得绝对值。请注意，时间值都是 UTC，因此考虑了夏令时、闰年等。

```
var epoch = new Date(1899, 11, 30); // 1899-12-30T00:00:00
var now = new Date();               // 2013-03-22T<current time>
now.setHours(0,0,0,0)               // 2013-03-22T00:00:00

var oaDate  = Math.abs((epoch - now) / 8.64e7); // 41355 for 2013-03-22 
```

您可以[在此处](http://www.dotnetperls.com/fromoadate)针对某些日期对其进行测试（请注意，这些日期采用令人困惑的美国 m/d/yy 格式）。

### 编辑

不好意思，理解错了。这里有一些功能可以双向使用。

还花了一些时间来弄清楚它所说的“OLE 自动化日期被实现为浮点数，其整数部分是 1899 年 12 月 30 日午夜之前或之后的天数”实际上是指 1899 年 12 月 30 日或之后00:00:00 并且“小数部分表示当天的时间除以 24”。换句话说，虽然 1899-12-29 00:00:00 为 -1，但 `899-12-29 06:00:00 的值为 -1.25，而不是 -0.75。

无论如何，这些功能现在似乎可以工作，但请彻底测试：

```
var toOADate = (function () {
  var epoch = new Date(1899,11,30);
  var msPerDay = 8.64e7;

  return function(d) {
    var v = -1 * (epoch - d)/msPerDay;

    // Deal with dates prior to 1899-12-30 00:00:00
    var dec = v - Math.floor(v);

    if (v < 0 && dec) {
      v = Math.floor(v) - dec;
    }

    return v;
  }
}());

var fromOADate = (function() {
  var epoch = new Date(1899,11,30);
  var msPerDay = 8.64e7;

  return function(n) {
    // Deal with -ve values
    var dec = n - Math.floor(n);

    if (n < 0 && dec) {
      n = Math.floor(n) - dec;
    }

    return new Date(n*msPerDay + +epoch);
  }
}());

var now = new Date();
var oaNow = toOADate(now);
var now2 = fromOADate(oaNow);

alert('Today: ' + now + '\nOADate: ' + oaNow + '\noaNow to Date: ' + now2); 
```

[OADate](http://msdn.microsoft.com/en-us/library/system.datetime.tooadate.aspx)的规范令人困惑，尤其是处理负数的方式。

### 编辑 2019 年 2 月

更新版本的函数，使用本地日期值。

```
/* Convert a Microsoft OADate to ECMAScript Date
** Treat all values as local.
** @param {string|number} oaDate - OADate value
** @returns {Date}
*/
function dateFromOADate (oaDate) {
  // Treat integer part is whole days
  var days = parseInt(oaDate);
  // Treat decimal part as part of 24hr day, always +ve
  var ms = Math.abs((oaDate - days) * 8.64e7);
  // Add days and add ms
  return new Date(1899, 11, 30 + days, 0, 0, 0, ms);
}

/* Convert an ECMAScript Date to a Microsoft OADate
** Treat all dates as local.
** @param {Date} date - Date to convert
** @returns {Date}
*/
function dateToOADate (date) {
  var temp = new Date(date);
  // Set temp to start of day and get whole days between dates,
  var days = Math.round((temp.setHours(0,0,0,0) - new Date(1899, 11, 30)) / 8.64e7);
  // Get decimal part of day, OADate always assumes 24 hours in day
  var partDay = (Math.abs((date - temp) % 8.64e7) / 8.64e7).toFixed(10);
  return days + partDay.substr(1);
}

var now = new Date();
var x = dateToOADate(now);
console.log('Now: ' + now.toString());
console.log('As an OADate: ' + x);
console.log('Back to date: ' + dateFromOADate(x).toString());

window.onload = function(){ 
  var el = document.getElementById('in')
  el.addEventListener('change', function() {
    var oaDate = dateToOADate(new Date(new Date(el.value)));
    document.getElementById('out').value = oaDate;
    document.getElementById('out2').value = dateFromOADate(oaDate);
  });
}
```

```
input {width: 25em}
```

```
<table>
  <tr>
    <td>Input date:<br>(DD MMM YYYY HH:mm)
    <td><input id="in" value="29 Dec 1899 06:00">
  <tr>
    <td>OA Date:
    <td><input id="out" readonly>
  <tr>
    <td>Back to standard date:
    <td><input id="out2" readonly>
</table>
```

# alignment - 如何让gnuplot使用居中的多行标题，左对齐的行？

> ID：15549830
> 
> 赞同：5
> 
> 时间：2013-03-21T14:07:58.157
> 
> 标签：alignment, gnuplot, title, centering

我希望我的 (gnu)plot 有一个多行标题。我希望标题*居中*（即从最宽标题线的中心到边缘的距离应该相等），但不要让每条线都*独立*于其他线居中，这是默认行为；我想让标题行左对齐并*仅作为一个块居中*。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T14:52:27.970

这有点棘手。正如 gnuplot 文档中所说：

```
The `set title` command produces a plot title that is centered at the top of
the plot.  `set title` is a special case of `set label`. 
```

尽管该`label`命令接受一个对齐参数，例如

```
set label "mylabel" right 
```

`title`没有：很难居中。我的解决方法是`label`在标题所在的位置使用 a 。`\n`要制作多行，请在双引号内使用换行符 ( )。

```
set title "\n"
set label 1 "first line\nsecond line" at graph 0.5,1.125 left 
```

dummy`set title`命令使 gnuplot 调整两行标题的上边距。我发现该位置 (0.5,1.125) 很好地再现了默认标题位置。但是，这不会使标签居中于绘图的中间——它将与中心线左对齐或右对齐。解决方法是手动调整标签的 x 位置：

```
set title "\n"
shift = 0.05 # manually adjust
set label 1 "first line\nsecond line" at graph (0.5-shift),1.125 left 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-20T15:26:42.873

另一种方法是使用固定宽度的字体并使所有行的长度相同。

```
set term pngcairo size 800,600 font "Courier,10" enhanced crop

set title "\
Synchronic                        \n\
(. orange) signal columns         \n\
(+  green) planar signal          \n\
(.    red) paraboloid             \n\
(x  black) intersection           \n\
(|  black) detection              " 
```

# matlab - 转换数据以适应正态分布

> ID：15549836
> 
> 赞同：5
> 
> 时间：2013-03-21T14:08:21.897
> 
> 标签：matlab, data-binding, normal-distribution, data-fitting

我有一个比较容易理解的问题。

我有一组数据，我想估计这些数据与**标准正态分布**的拟合程度。为此，我从我的代码开始：

```
[f_p,m_p] = hist(data,128);
f_p = f_p/trapz(m_p,f_p);

x_th = min(data):.001:max(data);
y_th = normpdf(x_th,0,1);   

figure(1)
bar(m_p,f_p)
hold on
plot(x_th,y_th,'r','LineWidth',2.5)
grid on
hold off 
```

图 1 如下所示：

![在此处输入图像描述](../Images/179a6b501add18b85581c5ab9022f810.png)

很容易看出合身性很差，尽管可以看到钟形。因此，主要问题在于我的数据的**差异**。

为了找出我的数据箱应该拥有的正确出现次数，我这样做：

```
f_p_th = interp1(x_th,y_th,m_p,'spline','extrap');
figure(2)
bar(m_p,f_p_th)
hold on
plot(x_th,y_th,'r','LineWidth',2.5)
grid on
hold off 
```

这将导致下图。：

![在此处输入图像描述](../Images/68a74d2e7a7f952940df4fb812141b00.png)

因此，问题是：如何缩放我的数据块以匹配高斯分布，如图**2 所示**？

**警告**

我想强调一点：我**不想****找到****适合数据**的最佳分布；**问题**是**相反**的：从我的数据开始，我想以这样一种方式操纵它，最终，它的分布合理地适合高斯分布。

不幸的是，目前，我对如何执行此数据“过滤”、“转换”或“操作”并没有真正的想法。

欢迎任何支持。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T15:29:17.593

也许您感兴趣的是基于秩的逆正态变换。基本上，您首先对数据进行排名，然后将其转换为正态分布：

```
rank = tiedrank( data );
p = rank / ( length(rank) + 1 ); %# +1 to avoid Inf for the max point
newdata = norminv( p, 0, 1 ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:44:42.037

您正在尝试做的似乎与试图找出一组数据的随机性的问题相匹配。超高斯 pdf 是那些比高斯分布在零（或平均值，无论它可能是什么）附近具有更大概率的那些，因此更“尖锐” - 就像你的例子一样。这种分布的一个例子是拉普拉斯分布。亚高斯 pdf 则相反。

可以通过多种方式来衡量数据集与高斯分布的接近程度……通常这是通过使用四阶矩峰度（[http://en.wikipedia.org/wiki/Kurtosis](http://en.wikipedia.org/wiki/Kurtosis) - MATLAB 函数）来完成的kurt），或信息论度量，例如负熵（[http://en.wikipedia.org/wiki/Negentropy](http://en.wikipedia.org/wiki/Negentropy)）。如果你有很多异常值，峰度有点狡猾，因为误差会提高到 4 的幂，所以负熵更好。

如果您不理解“四阶矩”一词，请阅读统计教科书。

在许多关于独立分量分析 (ICA) 的文章中都对这些和其他几种随机性度量（高斯性）进行了比较，因为它是一个核心概念。这方面的一个很好的资源是 Hyvarinen 和 Oja 所著的《独立分量分析》一书 - [http://books.google.co.uk/books/about/Independent_Component_Analysis.html?id=96D0ypDwAkkC](http://books.google.co.uk/books/about/Independent_Component_Analysis.html?id=96D0ypDwAkkC)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T14:40:01.293

我无法真正理解这个问题或您最近的其他类似问题一直在问什么。

也许您有正态分布的数据，并且您想让它以均值 0 和标准差 1 的正态分布？

如果是这样，则从您的数据中减去`mu`并除以`sigma`，其中`mu`是数据的平均值，`sigma`是其标准差。如果您的原始数据是正态分布的，那么结果应该是正态分布的数据，均值为 0，标准差为 1。

统计工具箱中有一个功能`zscore`可以为您完成这项工作。

但也许你的意思是别的？

# java - 电子邮件附件在没有扩展名的情况下交付

> ID：15549846
> 
> 赞同：2
> 
> 时间：2013-03-21T14:08:54.200
> 
> 标签：java, jakarta-mail

我有一些代码可以将一些结果作为附件通过电子邮件发送。附件显示时没有扩展名，我无法打开它。关于如何让附件显示为工作扩展的任何建议？

```
import javax.activation.DataHandler;
import javax.activation.DataSource;
import javax.activation.FileDataSource;
import javax.mail.*;
import javax.mail.internet.*;
import java.util.*;
.....
String path=System.getProperty("user.dir")+"//"+reportFileName;
Zip.zip(System.getProperty("user.dir")+"//"+ReportUtil.result_FolderName,reportFileName);
.....
DataSource source = 
new FileDataSource(attachmentPath);
messageBodyPart.setDataHandler(
new DataHandler(source));
messageBodyPart.setFileName(attachmentName);
multipart.addBodyPart(messageBodyPart); 
```

# php - 将变量提取到具有全局范围的模板中

> ID：15549848
> 
> 赞同：3
> 
> 时间：2013-03-21T14:09:08.097
> 
> 标签：php

我想使用 extract() 函数将控制器中分配的所有变量提取到我的模板中。一个简单的例子是这样的：

```
 private function render() {
        extract($this->controller_vars);
        require_once("layout.php");
  } 
```

问题是在我的 layout.php 中，我正在调用“包含”文件但更重要的是在布局中显示正确的操作/视图的其他方法。

```
 // This method is called where I want to display the "content" page:
  public function display_action() {
        require_once("selected_action.php");
  } 
```

因此，我有效地访问了 layout.php 中提取的变量，但我的视图/操作不能访问，因为它们是通过同一控制器中的方法包含的。

是否有一种解决方法，我可以为提取的变量提供全局访问权限，或者为我的问题提供另一种解决方案？

**附加信息：**

上面的代码是我的视图类中方法的 2 个“淡化”版本

```
 class views {

        private function render() {
              extract($this->controller_vars);
              require_once("layout.php");
        }

        public function display_action() {
              require_once("selected_action.php");
        }

  } 
```

在 layout.php 文件中，我会进行如下调用：

```
 <div id="content_area">
        $this->display_action();
  </div> 
```

**更多更多更多**

我现在确实可以通过我的视图类中名为 $this->controller_vars 的数组属性访问这些变量，所以如果我分配了一个用户列表，它将存储在 $this->controller_vars['users']; 我只是在寻找一种提取它的方法，以便我可以使用简单的 $users 访问它们，就像 $this->controller_vars['users']

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:14:12.463

我知道这不是一个直接的答案，但您可能需要考虑“使用”面向对象。如果您制作 Controllers 和 Actions 对象，它们仍然可以或多或少地以相同的方式包含/需要（使用[自动加载器](http://php.net/autoload)），并且您可以通过例如构造函数将变量传递给它们。

像这样的东西：

```
Class Layout {
    public function processAction() {
        $class = 'Action' . $selected_action;
        $Controller = new $class( $this->controller_vars );
    }
} 
```

# javascript - 关闭弹出窗口后刷新父窗口

> ID：15549850
> 
> 赞同：2
> 
> 时间：2013-03-21T14:09:13.353
> 
> 标签：javascript, .net

我有一个条件，我需要在关闭子窗口后刷新父窗口。

例如：

假设 A.aspx 是我从中打开弹出窗口 (B.aspx) 的页面。当我关闭 B.aspx 页面时，它应该重新加载我的 A.aspx。

注意：我正在使用`window.open()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:18:27.467

您可以通过使用控制弹出窗口中的主窗口`window.opener`

```
window.addEventListener('beforeunload', function(eventObject) {
   window.opener.location.reload(); 
}); 
```

# cmake - 如何在 cmake 上获取库的全本机名称？

> ID：15549853
> 
> 赞同：7
> 
> 时间：2013-03-21T14:09:15.787
> 
> 标签：cmake

我需要将已构建库的本机名称（libfoo.so 或 foo.dll）传递给 add_custom_command。

如何获取目标的完整库名称？

该属性`LOCATION`具有它，但具有完整路径。属性 OUTPUT_NAME 不返回任何内容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T16:11:00.080

您可以使用生成器表达式`$<TARGET_FILE_NAME:tgt>`，其中`tgt`是目标的逻辑 CMake 名称。

例子：

```
add_library(myLib a.cpp)
add_custom_command(
  OUTPUT someOutput
  COMMAND myProcessor --input $<TARGET_FILE_NAME:myLib> --output someOutput
  # ...
) 
```

有关生成器表达式的更多信息，请参阅（针对 CMake 2.x）的[文档`add_custom_command()`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:add_custom_command)或专用[生成器表达式文档](https://cmake.org/cmake/help/latest/manual/cmake-generator-expressions.7.html)（针对 CMake 3+）。

# c# - 如何判断事件是否来自 C# 中的用户输入？

> ID：15549854
> 
> 赞同：14
> 
> 时间：2013-03-21T14:09:18.097
> 
> 标签：c#, winforms, checkbox, event-handling

我有一个小表单，上面有一些复选框，`CheckChanged`事件的每个复选框都有一个消息处理程序。由于某些复选框依赖于其他复选框，如果一个复选框的选中状态发生更改，它会更改任何依赖复选框的选中状态。我发现这会导致在其他复选框上引发事件，但我的问题是每个事件都有一个函数调用，只有当事件来自用户实际单击复选框时才应调用该函数调用。我想知道如何判断事件是否是由鼠标单击引起的（可能来自发送者或发送者`EventArgs`） 。`CheckChanged`

悬崖：

*   多个复选框接收`CheckChanged`事件
*   需要确定是否通过鼠标单击引发了事件

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T14:24:26.390

您可以使用标志来指示是否忽略事件。它可能比取消订阅事件处理程序更容易。它不是很复杂，但它应该可以完成这项工作。

我整理了一个简单的例子：

```
 bool ignoreEvents = false;
        public Form1()
        {
            InitializeComponent();
        }

        private void checkBox1_CheckedChanged(object sender, EventArgs e)
        {
            ignoreEvents = true;
            checkBox2.Checked = checkBox1.Checked ;
            checkBox3.Checked = checkBox1.Checked;
            ignoreEvents = false;
        }

        private void checkBox2_CheckedChanged(object sender, EventArgs e)
        {
            if (ignoreEvents) return;
            MessageBox.Show("Changed in 2");
        }

        private void checkBox3_CheckedChanged(object sender, EventArgs e)
        {
            if (ignoreEvents) return;
            MessageBox.Show("Changed in 3");
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-04T07:03:13.253

为了提高代码稳定性，您还可以使用类 TriggerLock 而不是 ignoreEvents 标志。

```
 private void checkBox1_CheckedChanged(object sender, EventArgs e)
    {
        using (new TriggerLock())
        {
            checkBox2.Checked = checkBox1.Checked;
            checkBox3.Checked = checkBox1.Checked;
        }
    }

    private void checkBox2_CheckedChanged(object sender, EventArgs e)
    {
        if (TriggerLock.IsOpened)
        {
            MessageBox.Show("Changed in 2");
        }
    }

    private void checkBox3_CheckedChanged(object sender, EventArgs e)
    {
        if (TriggerLock.IsOpened)
        {
            MessageBox.Show("Changed in 3");
        }
    } 
```

TriggerLock 类，它像信号量一样工作：

```
public class TriggerLock
    : IDisposable
{
    private static int _nUsing = 0;
    private bool _bDisposed;

    public TriggerLock()
    {
        _bDisposed = false;
        Interlocked.Increment(ref _nUsing);
    }
    ~TriggerLock()
    {
        Dispose(false);
    }

    public static bool IsOpened 
    {
        get { return _nUsing == 0; }
    }

    public void Dispose()
    {
        Dispose(true);
    }
    private void Dispose(bool bDisposing)
    {
        if (bDisposing && !_bDisposed)
        {
            Interlocked.Decrement(ref _nUsing);
            _bDisposed = true;
        }
    }
} 
```

# model - PetaPoco 看不到类属性

> ID：15549860
> 
> 赞同：0
> 
> 时间：2013-03-21T14:09:29.187
> 
> 标签：model, attributes, petapoco

出于某种原因，当我在 Poco 类上为表名和主键设置属性时，PetaPoco 没有看到它们并且默认为 ID autoIncrement = false

```
[TableName("MyTableName")]
[PrimaryKey("Id", autoIncrement = true)]
public class MyClass
{
    public int Id { get; set; }
    public string Description { get; set; }
} 
```

当我调用 Insert() 方法时，它失败了。如果我调用 insert 方法并显式传递表名、主键列、自动增量，那么它就可以工作。

任何想法为什么 Peta Poco 没有看到这些属性？

我正在使用针对 4.5 框架的 C# VS 2012

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T22:00:11.317

尝试像这样更改您的 Data DataAnnotations：

```
[DotNetNuke.ComponentModel.DataAnnotations.TableName("MyTableName")]
[DotNetNuke.ComponentModel.DataAnnotations.PrimaryKey("Id", AutoIncrement = true)]
public class MyClass
{
    public int Id { get; set; }
    public string Description { get; set; }
} 
```

测试一下，看看这是否适合你。我认为它没有在您可能从 NuGet 下载的 t4 模板中看到它们，将使用 PetaPoco 参考放在顶部，并且在 DNN 核心的 DataUtil.cs 中我相信它正在寻找 DNN 注释。不确定这是错误还是设计使然，但我自己看到了，想知道是否应该有仅适用于 DNN PetaPoco 的 t4 模板。

我不确定 AutoIncrement 是否设置为 false，但请注意，我将它以大写形式表示“A”。

希望这会有所帮助，我会继续关注下一个版本，我在 7.0.5 上对此进行了测试，看看他们是否更新了这个或仅为 DNN PetaPoco 发布了 t4 模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-30T18:43:07.750

尝试将 PrimaryKeyColumn 属性添加到 Id 属性，如下所示

```
[TableName("MyTableName")]
[PrimaryKey("Id", autoIncrement = true)]
public class MyClass
{
    [PrimaryKeyColumn(AutoIncrement=true)]
    public int Id { get; set; }

    public string Description { get; set; }
} 
```

# printing - 如何在 kdb+ 中格式化双精度

> ID：15549866
> 
> 赞同：3
> 
> 时间：2013-03-21T14:09:44.537
> 
> 标签：printing, kdb

kdb q 中有类似 printf 的函数吗？我正在尝试将双字段格式化为 4 位精度。等效的 printf 格式将是“%.04f”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T14:16:33.573

`.Q.f`可能是您正在寻找的：

[http://code.kx.com/q/ref/dotq/#qf-format](http://code.kx.com/q/ref/dotq/#qf-format)

```
q).Q.f[2;100]
"100.00"
q).Q.f[2;100.8888]
"100.89" 
```

# c++ - 将 head 设置为 NULL ('NULL' : 未声明的标识符)

> ID：15549873
> 
> 赞同：20
> 
> 时间：2013-03-21T14:09:49.227
> 
> 标签：c++, pointers, null

我在 C++ 中定义了一个链表。我正在尝试为变量 head 设置一个 NULL 值（在 的构造函数中`Movie_LinkedList`），但我得到了：

**movie.h(40)：错误 C2065：'NULL'：未声明的标识符**

请注意***，我不能包含任何库，除了`iostream`***

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-21T14:11:05.277

如所写，`NULL`未在您的程序中定义。通常，这是在标准头文件中定义的——特别是`<cstddef>`或`<stddef.h>`. 由于您被限制为`iostream`，如果您没有`NULL`从该标题中隐式获取，您可以使用`0`or 在 C++11 中`nullptr`，这是一个关键字，不需要标题。（不建议`NULL`自己定义。有时可能会起作用，但在技术上是非法的。）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-21T14:11:15.423

您应该包括`<stddef.h>`or `<cstddef>`。

但是，您可以使用`0`或`nullptr`也可以使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-21T14:11:34.050

使用以下包括：

```
#include <stddef.h> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-21T14:11:16.480

不需要图书馆！

在头文件的顶部，

做这个：

```
#ifndef NULL
#define NULL (0)
#endif 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-21T14:12:10.803

`NULL`实际上不是核心 C 或 C++ 语言的一部分；在 stddef.h 中定义为 0

由于您使用的是 C++，prefer`nullptr`是一个关键字，并且已键入。（假设它可用。它是 C++11 的一部分，所以从技术上讲，并非所有编译器都支持它；实际上，你很难找到不支持它的编译器）

# ruby - 如何测试 Rack::Cache 是否与 Heroku 上的 Sinatra 应用程序一起使用 memcache 运行？

> ID：15549874
> 
> 赞同：2
> 
> 时间：2013-03-21T14:09:51.120
> 
> 标签：ruby, caching, heroku, memcached, sinatra

我正在制作一个网络应用程序，许多用户将在其中查看 Google 地图，地图上的更新通过 ajax 请求拉入服务器。我希望缓存发送给用户的响应，因为它涉及从外部服务器抓取数据，并且只需要每 2-3 分钟更新一次。

因此，一旦有人请求数据，我希望所有其他用户的所有后续请求在接下来的 2-3 分钟内从缓存中提取。我遵循[了本教程](http://henrik.nyh.se/2012/07/sinatra-with-rack-cache-on-heroku/)，详细介绍了如何使用 Heroku 在 Sinatra 中设置 Rack::Cache 和 Dalli gem，当我在使用以下设置的页面上运行测试时，

```
cache_control :public, max_age: 3000 
```

我可以看到缓存标头正确通过（使用 Google Chrome 开发者工具），但是如果我点击刷新，或者如果我从另一台计算机请求页面，内容显然会重新生成（我放了 Time.now 输出）。但是，如果我转到另一个页面，然后重新键入 URL，则不会重新生成内容。我认为浏览器正在缓存结果，但不是 memcache 服务器？我对缓存的工作原理有根本的误解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-20T04:30:13.907

对于遇到这个问题的人，这里有一些线程可以帮助您解决问题（帮助我）。

在浏览器中“刷新”会导致“缓存控制：max-age=0”： [https ://groups.google.com/forum/#!topic/rack-cache/sWHyu4pYwKw](https://groups.google.com/forum/#!topic/rack-cache/sWHyu4pYwKw)

清除缓存并删除缓存目录（这对我有用）： [https ://github.com/rails/rails/issues/5245](https://github.com/rails/rails/issues/5245)

[使用 rspec / other Sinatra、Rack::Test 和 Conditional GET 请求](https://stackoverflow.com/questions/7728576/sinatra-racktest-and-conditional-get-requests)为其添加规范

# xml - 基于 XML 选择

> ID：15549878
> 
> 赞同：0
> 
> 时间：2013-03-21T14:10:09.560
> 
> 标签：xml, xslt

我有以下xml：

```
 <aa>
        <abc>
            <name>convention</name>
            <value>test1</value>
        </abc>
        <abc>
            <name>computer</name>
            <value>test2</value>
        </abc>
        <abc>
            <name>human</name>
            <value>test3</value>
        </abc>
        <abc>
            <name>airplane</name>
            <value>test4</value>
        </abc>
        <abc>
            <name>flight</name>
            <value>test5</value>
        </abc>
        <abc>
            <name>keyboard</name>
            <value>test6</value>
        </abc>
    </aa> 
```

我想根据选择选择名称的值之一。例如，如果名称是航班，那么我需要选择它的值 test5。并且不显示全部，只显示名称航班的值。我们如何做到这一点 ？

编辑：很抱歉没有提到语言。

例如，我在上述 xml 上使用 xlst 来选择并仅获取 flight 的值。

我试过这个：

```
 <xsl:variable name="test" select="/aa/abc[@name='flight']"/>
   <Test name= "{$test}"/> 
```

但这似乎并没有获得飞行的价值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:23:36.417

因为`name`是元素而不是属性，所以`@`是不正确的。请试试这个：

```
<xsl:variable name="test" select="/aa/abc[name='flight']/value"/>
<Test name="{$test}"/> 
```

# windows - 如何在 Windows 上使用“hash_map”

> ID：15549883
> 
> 赞同：0
> 
> 时间：2013-03-21T14:10:23.107
> 
> 标签：windows, hashmap

我正在尝试将**hash_map**用于我的自定义数据结构**Locations**，它实际上是一个数组。当我尝试插入一些值对时，出现错误。但我不知道为什么。

我在 Windows7 上编程，我使用 VS 2010。下面是最小工作集。

```
 #include <hash_map>
#include <iostream>
using namespace std;

#define HASH_NUM 8

struct Locations{
    unsigned int loc[HASH_NUM];
};

//1\. define the hash function
struct hash_Locations{

    size_t operator()(const Locations & Loc) const
    {
        unsigned int seed = 131; // 31 131 1313 13131 131313 etc..
        unsigned int hash = 0;
        char* str = (char*)Loc.loc;

        for (int i = 0; i < HASH_NUM * 4; i ++)
        {
            hash = hash * seed + (*str++);
        }

        return (hash & 0x7FFFFFFF);
    }
};

//2\. define less than function
struct less_than{
    bool operator()(const Locations & x, const Locations & y) const
    {
        for(int i = 0; i < HASH_NUM; i ++){
            if(x.loc[i] < y.loc[i])
                return true;
        }
        return false;
    }
};

int main(){
    hash_map<Locations, unsigned int, hash_compare<hash_Locations, less_than> >    location_map;
    Locations x, y;
    for(int i = 0; i < HASH_NUM; i ++){
        x.loc[i] = i * 3;
        y.loc[i] = i * 2;
    }

    //error
    location_map.insert(pair<Locations, unsigned int>(x, 1));
    location_map.insert(pair<Locations, unsigned int>(y, 2));

    return 0;
} 
```

编辑：这是错误报告。

```
 1>------ Build started: Project: hash_map, Configuration: Debug Win32 ------
    1>  hash_map.cpp
    1>d:\program files (x86)\microsoft visual studio 10.0\vc\include\xhash(854): error C2664: 'bool stdext::hash_compare<_Kty,_Pr>::operator ()(const _Kty &,const _Kty &) const' : cannot convert parameter 1 from 'const Locations' to 'const hash_Locations &'
    1>          with
    1>          [
    1>              _Kty=hash_Locations,
    1>              _Pr=less_than
    1>          ]
    1>          Reason: cannot convert from 'const Locations' to 'const hash_Locations'
    1>          No user-defined-conversion operator available that can perform this conversion, or the operator cannot be called
    1>          d:\program files (x86)\microsoft visual studio 10.0\vc\include\xhash(849) : while compiling class template member function 'std::pair<_Ty1,_Ty2> std::_Hash<_Traits>::_Insert(const std::pair<const _Kty,_Ty> &,std::_List_iterator<_Mylist>)'
    1>          with
    1>          [
    1>              _Ty1=std::_List_iterator<std::_List_val<std::pair<const Locations,unsigned int>,std::allocator<std::pair<const Locations,unsigned int>>>>,
    1>              _Ty2=bool,
    1>              _Traits=std::_Hmap_traits<Locations,unsigned int,stdext::hash_compare<hash_Locations,less_than>,std::allocator<std::pair<const Locations,unsigned int>>,false>,
    1>              _Kty=Locations,
    1>              _Ty=unsigned int,
    1>              _Mylist=std::_List_val<std::pair<const Locations,unsigned int>,std::allocator<std::pair<const Locations,unsigned int>>>
    1>          ]
    1>          d:\program files (x86)\microsoft visual studio 10.0\vc\include\hash_map(91) : see reference to class template instantiation 'std::_Hash<_Traits>' being compiled
    1>          with
    1>          [
    1>              _Traits=std::_Hmap_traits<Locations,unsigned int,stdext::hash_compare<hash_Locations,less_than>,std::allocator<std::pair<const Locations,unsigned int>>,false>
    1>          ]
    1>          c:\documents and settings\daihuichen\桌面\hash_map\hash_map.cpp(42) : see reference to class template instantiation 'stdext::hash_map<_Kty,_Ty,_Tr>' being compiled
    1>          with
    1>          [
    1>              _Kty=Locations,
    1>              _Ty=unsigned int,
    1>              _Tr=stdext::hash_compare<hash_Locations,less_than>
    1>          ]
    1>d:\program files (x86)\microsoft visual studio 10.0\vc\include\xhash(857): error C2664: 'bool stdext::hash_compare<_Kty,_Pr>::operator ()(const _Kty &,const _Kty &) const' : cannot convert parameter 1 from 'const Locations' to 'const hash_Locations &'
    1>          with
    1>          [
    1>              _Kty=hash_Locations,
    1>              _Pr=less_than
    1>          ]
    1>          Reason: cannot convert from 'const Locations' to 'const hash_Locations'
    1>          No user-defined-conversion operator available that can perform this conversion, or the operator cannot be called
    ========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-14T05:48:56.800

我认为错误报告非常清楚地说明了这一点。

> “无法将参数 1 从 'const Locations' 转换为 'const hash_Locations &'”

只是改变

```
bool operator()(const Locations & x, const Locations & y) 
```

进入

```
bool operator()(const Locations x, const Locations  y) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T17:59:30.647

以下可以解决您的问题，但不确定最佳解决方案。

```
struct hash_Locations{
//    struct hash_Locations:public hash_compare<Locations, less_than>{
enum
{   // parameters for hash table
    bucket_size = 4,    // 0 < bucket_size
    min_buckets = 8};   // min_buckets = 2 ^^ N, 0 < N
size_t operator()(const Locations & Loc) const
{
    unsigned int seed = 131; // 31 131 1313 13131 131313 etc..
    unsigned int hash = 0;
    char* str = (char*)Loc.loc;

    for (int i = 0; i < HASH_NUM * 4; i ++)
    {
        hash = hash * seed + (*str++);
    }

    return (hash & 0x7FFFFFFF);
}

bool operator()(const Locations & x, const Locations & y) const
{
    for(int i = 0; i < HASH_NUM; i ++){
        if(x.loc[i] < y.loc[i])
            return true;
    }
    return false;
} 
```

};

# android - Android背景音乐游戏在循环之前暂停

> ID：15549886
> 
> 赞同：0
> 
> 时间：2013-03-21T14:10:45.410
> 
> 标签：android, media-player

我正在开发 Android 游戏，并且我正在使用标准的 Android 组件。

我有媒体播放器对象，应该一遍又一遍地播放背景音乐。我已经创作了一些音乐，并进行了渲染……它完美地循环播放。

现在，当我将音乐文件添加到游戏中时……在每个循环音乐停止片刻之前……但这很烦人。为什么会这样？

我已经在 2.3.3 电话设备和 ICS 模拟器上对其进行了测试……每次都会发生同样的事情。

这是我的代码：

```
/** Play background music */
public static void playMusic() {

    if (backgroundMusic == null) {
        backgroundMusic = new MediaPlayer();
        backgroundMusic.setVolume(0.5f, 0.5f);

        try {
            backgroundMusic.setDataSource(activity.getAssets()
                    .openFd("background_music.ogg")
                    .getFileDescriptor());
            backgroundMusic.prepare();
            backgroundMusic.setAudioStreamType(AudioManager.STREAM_MUSIC);
            backgroundMusic.setLooping(true);
            backgroundMusic.start();
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

} 
```

当我在 PC 上的某个播放器中播放相同的文件时，它会循环播放并且听起来非常好...如何解决这个问题？天呐！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:20:39.080

好吧，不幸的是，它就是这样工作的。
问题是他在完成**后**重新启动播放器。

如果您使用 API 16 或更高版本，则可以使用[setNextMediaPlayer(MediaPlayer)](http://developer.android.com/reference/android/media/MediaPlayer.html#setNextMediaPlayer%28android.media.MediaPlayer%29) - 方法。然后他试图以`MediaPlayer`一种没有停顿的方式开始下一个。

如果您正在为小于 16 的 API 进行开发，我不知道您如何使用`MediaPlayer`.

您可以尝试使用 2`MediaPlayers`并在第一个停止之前开始第二个。但我不知道这有多好用，因为您必须以某种方式找出何时启动新播放器。

**编辑：**
经过更多的谷歌工作，我发现[了这个](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/98QAKhZRTLA)。
有人建议将`mp3`-File转换为`ogg`-File，这样就可以在没有暂停的情况下循环它。但我没有尝试过。
根据评论，这对一个人有效，但对另一个人无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T18:17:26.077

我想我找到了一种方法来完成这项工作......

我已将代码更改为：

```
/** Play background music */
public static void playMusic() {

    if (backgroundMusic == null) {
        backgroundMusic = new MediaPlayer();
        backgroundMusic.setVolume(0.5f, 0.5f);
        AssetFileDescriptor afd;
        try {
            afd = activity.getAssets().openFd(
                    "background_music.ogg");
            backgroundMusic.setDataSource(afd.getFileDescriptor(),
                    afd.getStartOffset(), afd.getLength());
            backgroundMusic.setLooping(true);
            backgroundMusic.prepare();
        } catch (IOException e1) {
            e1.printStackTrace();
        }

        backgroundMusic.start();
    }

} 
```

现在它循环正常......问题是我真的不明白为什么......

希望这对一些和我有同样问题的人有所帮助。

干杯!

# java - 到达 main 方法的末尾时程序不会终止

> ID：15549887
> 
> 赞同：2
> 
> 时间：2013-03-21T14:10:47.180
> 
> 标签：java, joptionpane

我有一个程序，我在启动它之前要求用户输入。

```
public static void main(String args[]) 
{
    String database = JOptionPane.showInputDialog(new JFrame(), "Enter a DB:");
    if(database!=null && database.foundInDB()) {
        SPVerification spv = new SPVerification();
        spv.setVisible(true);
    }
    //System.exit(1);  Without it the program doesn't terminate although it's the end
    //                 of the main function.                  
} 
```

如果用户输入了一个未找到的数据库，则不应执行该程序。

当我输入错误的数据库名称时，`if`语句下面的代码不会执行，所以我到达了 main 方法的末尾，但程序没有终止，但是如果我`system.exit(1)`在`if`语句之后添加，程序就会终止。为什么我需要打电话，`System.exit(1)`虽然我已经到了 main 的末尾？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T14:13:26.400

您正在显示一个 Swing 对话框，它启动了事件调度线程。这是一个非守护线程，因此会阻止程序退出。

对于一个普通的 Swing 应用程序，这正是您想要的：所有`main()`应该做的就是收集任何配置信息并创建主框架。

您的问题的一种解决方案是将对话代码包装在对[SwingUtilities.invokeAndWait()](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeAndWait%28java.lang.Runnable%29)的调用中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T14:15:52.027

您创建了一个新`JFrame`的，默认情况下不会关闭，因为没有任何东西可以触发要处理的窗口，例如`WindowEvent`. 由于这似乎是一个非基于 UI 的应用程序，您可以简单地使用：

```
JOptionPane.showInputDialog(null, "Enter a DB:"); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-21T14:22:43.087

```
JFrame jframe = new JFrame()
String answer = JOptionPane.showInputDialog(jframe, "Enter a DB:")
System.err.println(answer)
jframe.dispose() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T14:29:48.670

您可能会调用`.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);`您的 JFrame，以便 JVM 在关闭 JFrame 后终止（鉴于所有其他正在运行的线程都是守护进程）。

# groovy - 安全字符串切片

> ID：15549891
> 
> 赞同：5
> 
> 时间：2013-03-21T14:10:59.950
> 
> 标签：groovy

我有一个字符串，我想要 250 个字符或更少。我是用java的方式做的，但是有没有一个时髦的捷径：

```
def longString = "This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string.This is my really long string."
def shortString = "This is my really short string."

#ideal would be something like:
return longString[0..250]
#versus how i currently have it
#how can i simplify this one...
return shortString.size() < 250? shortString: shortString.substring(0,250) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-21T14:26:31.737

[您可以使用`take`](http://docs.groovy-lang.org/docs/latest/html/groovy-jdk/java/lang/CharSequence.html#take(int))：

```
String shortString = longString.take( 250 ) 
```

# c - 通过宏修改 printf()s 以包含文件和行号信息

> ID：15549893
> 
> 赞同：6
> 
> 时间：2013-03-21T14:11:03.997
> 
> 标签：c

我只是想知道我们是否可以使用一些宏破解来更改项目中现有的 printf() 语句。

```
/* file.c */
printf ("%s", strerror(errno));

/* After macro processing, this line would become */
printf ("%s %s %d", strerror(errno), __FILE__, __LINE__); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T14:17:58.780

根据我的评论中的警告，您可以使用[可变参数宏](http://en.wikipedia.org/wiki/Variadic_macro)来做到这一点：

```
#define PRINTF_FL(format, ...) \
    printf(format " %s %d", __VA_ARGS__, __FILE__, __LINE__) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-21T14:15:04.117

试试这个：

```
#define debug(fmt, ...) printf("%s:%d: " fmt, __FILE__, __LINE__, __VA_ARGS__); 
```

我使用 name`debug`而不是`printf`，因为我认为您不应该覆盖标准函数。你可以打破一些东西。

像这样使用：

```
debug("This is debug no %d", 5); 
```

要获得类似于以下内容的输出：

```
program.c:12: this is debug no 5 
```

（文件：`program.c`，行：12）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-21T14:18:37.660

重新定义`printf`不使用`undef`只需在头文件中定义以下`printf`宏

```
#define printf(MESSAGE,args...) { \
  const char *A[] = {MESSAGE}; \
  printf("%s %d",__FILE__,__LINE__); fflush(stdout);\
  if(sizeof(A) > 0) {\
    printf("::"); \
    printf(*A,##args); \
  } else {\
    printf("\n"); \
  }\
} 
```

您可以通过`printf`这种方式在代码中使用新宏

```
printf(); // it will print only the file name and the line number 
```

或以这种方式

```
printf("debug message any data %d\n", 5); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-21T14:51:10.213

这是我的“半便士”。

## 函数名称和调试消息：

```
// debug mode, -DEBUG
#ifdef EBUG
    #define FNAME() fprintf(stderr, "\n%s (%s, line %d)\n", __func__, __FILE__, __LINE__)
    #define DBG(...) do{fprintf(stderr, "%s (%s, line %d): ", __func__, __FILE__, __LINE__); \
                    fprintf(stderr, __VA_ARGS__);           \
                    fprintf(stderr, "\n");} while(0)
#else
    #define FNAME()  do{}while(0)
    #define DBG(...) do{}while(0)
#endif //EBUG 
```

使用宏`FNAME()`仅显示函数名称和文件/行，`DBG(text)`以显示类似 printf 的调试消息，其中包含有关函数名称和文件/行的信息。

## 还有一些可能对彩色调试和错误/警告消息有用的东西。

### 在头文件中：

```
extern int globErr;
#define ERR(...) do{globErr=errno; _WARN(__VA_ARGS__); exit(-1);}while(0)
#define WARN(...) do{globErr=errno; _WARN(__VA_ARGS__);}while(0)
#define WARNX(...) do{globErr=0; _WARN(__VA_ARGS__);}while(0)
// functions for color output in tty & no-color in pipes
EXTERN int (*red)(const char *fmt, ...);
EXTERN int (*_WARN)(const char *fmt, ...);
EXTERN int (*green)(const char *fmt, ...); 
```

### 在 C 文件中：

```
int globErr = 0; // errno for WARN/ERR
// pointers to coloured output printf
int (*red)(const char *fmt, ...);
int (*green)(const char *fmt, ...);
int (*_WARN)(const char *fmt, ...);
/*
 * format red / green messages
 * name: r_pr_, g_pr_
 * @param fmt ... - printf-like format
 * @return number of printed symbols
 */
int r_pr_(const char *fmt, ...){
    va_list ar; int i;
    printf(RED);
    va_start(ar, fmt);
    i = vprintf(fmt, ar);
    va_end(ar);
    printf(OLDCOLOR);
    return i;
}
int g_pr_(const char *fmt, ...){
    va_list ar; int i;
    printf(GREEN);
    va_start(ar, fmt);
    i = vprintf(fmt, ar);
    va_end(ar);
    printf(OLDCOLOR);
    return i;
}
/*
 * print red error/warning messages (if output is a tty)
 * @param fmt ... - printf-like format
 * @return number of printed symbols
 */
int r_WARN(const char *fmt, ...){
    va_list ar; int i = 1;
    fprintf(stderr, RED);
    va_start(ar, fmt);
    if(globErr){
        errno = globErr;
        vwarn(fmt, ar);
        errno = 0;
        globErr = 0;
    }else
        i = vfprintf(stderr, fmt, ar);
    va_end(ar);
    i++;
    fprintf(stderr, OLDCOLOR "\n");
    return i;
}

const char stars[] = "****************************************";
/*
 * notty variants of coloured printf
 * name: s_WARN, r_pr_notty
 * @param fmt ... - printf-like format
 * @return number of printed symbols
 */
int s_WARN(const char *fmt, ...){
    va_list ar; int i;
    i = fprintf(stderr, "\n%s\n", stars);
    va_start(ar, fmt);
    if(globErr){
        errno = globErr;
        vwarn(fmt, ar);
        errno = 0;
        globErr = 0;
    }else
        i = +vfprintf(stderr, fmt, ar);
    va_end(ar);
    i += fprintf(stderr, "\n%s\n", stars);
    i += fprintf(stderr, "\n");
    return i;
}
int r_pr_notty(const char *fmt, ...){
    va_list ar; int i;
    i = printf("\n%s\n", stars);
    va_start(ar, fmt);
    i += vprintf(fmt, ar);
    va_end(ar);
    i += printf("\n%s\n", stars);
    return i;
} 
```

### 在 main() 中：

```
if(isatty(STDOUT_FILENO)){ // make color output in tty
    red = r_pr_; green = g_pr_;
}else{ // no colors in case of pipe
    red = r_pr_notty; green = printf;
}
if(isatty(STDERR_FILENO)) _WARN = r_WARN;
else _WARN = s_WARN; 
```

之后，您将能够在终端中运行时使用彩色输出，在管道中使用非彩色输出。函数`red`和`green`是彩色输出的类似物`printf`。`_WARN`宏中用于显示用户消息和字符串的函数`errno`：`ERR`对于错误的情况（以 结尾`exit`），`WARN`- 类似`ERR`但没有`exit`和`WARNX`显示没有的消息`errno`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-11-08T09:01:10.800

在宏 MYPRINT 下方定义。包括文件名、行号、函数名和\n

```
 #define MYPRINT(str,args...) printf("%s:%d %s() "str"\n",__FILE__,__LINE__,__func__, ##args) 
```

# c# - 在 C# 中创建重载方法

> ID：15549895
> 
> 赞同：0
> 
> 时间：2013-03-21T14:11:04.750
> 
> 标签：c#, nunit, overloading

我正在尝试创建包含客户联系信息和地址信息的类。

我目前正在尝试重载方法，以期压缩我的代码并使其更易于阅读，同时执行与各种方法相同的操作。另外，我正在使用 NUnit，因为这些是我正在创建的集成测试，所以这就是随机生成器的来源。这是我到目前为止所拥有的：

```
 public static Address BuildAddress()
    {
        var gen = new RandomGenerator();
        return BuildAddress(gen.Phrase(10));
    }

    //build a billing address
    public static AddressInfo BuildAddress(string name)
    {
        return BuildAddress(name, "USA");
    }

    public static Address BuildAddress(string name, string country)
    {
        var gen = new RandomGenerator();

        var address = Builder<AddressInfo>.CreateNew()
            .With(x => x.Name = name)
            .And((x => x.Address1 = gen.Int() + " " + gen.Phrase(10) + " Street"))
            .And(x => x.City = gen.Phrase(15))
            .And(x => x.StateOrProvince = gen.Phrase(2))
            .And(x => x.Country = country)
            .And(x => x.PostalCode = "32561").
            Build();

        return address; 
```

我做了这个，但我也在想我需要为邮寄地址添加另一个代码块。如果有更短的方法可以做到这一点，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T14:16:49.677

如果我理解正确，您想缩短上面的代码，即您拥有的方法重载链......您可以使用默认属性，即：

```
public static Address BuildAddress(string name, int phrase = 10, string country = "USA")
{
        var gen = new RandomGenerator();

        var address = Builder<AddressInfo>.CreateNew()
            .With(x => x.Name = name)
            .And((x => x.Address1 = gen.Int() + " " + gen.Phrase(10) + " Street"))
            .And(x => x.City = gen.Phrase(15))
            .And(x => x.StateOrProvince = gen.Phrase(2))
            .And(x => x.Country = country)
            .And(x => x.PostalCode = "32561").
            Build();

        return address;
} 
```

然后你可以这样称呼它..

```
ClassName.BuilderAddress("my name"); 
```

或者..

```
ClassName.BuilderAddress("my name", 5); 
```

或者..

```
ClassName.BuilderAddress("my name", 7, "Ireland"); 
```

**对您的评论的建议答案如下：（对此不是 100% 确定）**

```
public static T BuildAddress(string name, int phrase = 10, string country = "USA")
{
        var gen = new RandomGenerator();

        var address = Builder<T>.CreateNew()
            .With(x => x.Name = name)
            .And((x => x.Address1 = gen.Int() + " " + gen.Phrase(10) + " Street"))
            .And(x => x.City = gen.Phrase(15))
            .And(x => x.StateOrProvince = gen.Phrase(2))
            .And(x => x.Country = country)
            .And(x => x.PostalCode = "32561").
            Build();

        return address;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:14:22.517

您可能需要考虑可选参数和命名参数。

[http://msdn.microsoft.com/en-us/library/dd264739.aspx](http://msdn.microsoft.com/en-us/library/dd264739.aspx)

# sublimetext2 - Sublime Text 2 自动文件路径补全

> ID：15549899
> 
> 赞同：11
> 
> 时间：2013-03-21T14:11:10.630
> 
> 标签：sublimetext2, sublimetext

我正在寻找 Sublime 2 Text 中的自动文件路径完成功能，例如 VIM 中的 ctrl + x + o

我怎么做？

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-21T19:48:48.017

认为您想要[AutoFileName 之](https://github.com/BoundInCode/AutoFileName)类的东西。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-03-24T08:30:21.540

AutoFileName 已过时且不再受支持，上次更新是 2 年前。

更好的文件路径完成插件是[FuzzyFilePath](https://packagecontrol.io/packages/FuzzyFilePath)。

除了文件路径完成之外，您还将获得不错的奖励：`alt`+`enter`打开光标下的文件。

# html - 什么语言支持像 sxml 这样的 html 的基于空格的语法？

> ID：15549900
> 
> 赞同：0
> 
> 时间：2013-03-21T14:11:12.427
> 
> 标签：html, xml, yaml, sxml

我记得我曾经看到一种允许我编写 html 的语言，如下所示：

```
html
  head
    title
     "Welcome"
  body
    div class=header
      ul
        li "menu 1"
        li "menu 2" 
```

**有人知道这是哪种语言/图书馆吗？**

它看起来很像 python 代码。缩进在前，不需要结束标签。

我知道 SXML 和 YAML，但它们并不是我的意思。

我更喜欢遵循 ​​XML 信息路径内部树模型的简单语言。而不是具有逻辑或任何东西的模板语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:24:44.213

我想我找到了： [http ://shpaml.webfactional.com/](http://shpaml.webfactional.com/)

但是我不是 100% 确定。

如果其他人找到其他图书馆，请告诉我！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T15:52:36.173

我只能想到 Jade，这是 Node.js 使用的模板引擎。但是我不确定它是否可以在没有 Node.js 的情况下使用。

# jquery - 在函数中创建动态页面

> ID：15549902
> 
> 赞同：0
> 
> 时间：2013-03-21T14:11:14.857
> 
> 标签：jquery, jquery-mobile

我有这个功能：

```
var getData = function (obj) {

    for(var i = 0, j = localStorage.length; i < j; i ++) {
        var newKey = localStorage.key(i);
        var newValue = localStorage.getItem(newKey);    
        var newObj = JSON.parse(newValue);
        var ulListView = $('#container').append('<ul data-role="listview" data-split-icon="minus" data-split-theme="c" data-inset="true" id="ulOrigin'+i+'"></ul>');
        var dynPage = $(newObj[1].value).trigger('create');     
        //var dynPage = $('<div data-role = "page" id = "'+newObj[1].value+'"><div data-role = "header"></div><div data-role = "content"></div><div data-role = "footer"></div>"</div>');       
        var insideLi = $('#ulOrigin'+i).append('<li><a href="'+dynPage+'"><img src="images/'+newObj[0].value+'.png"><h2>'+newObj[1].value+'</h2><p>'+newObj[0].value+'</p></a><a href = "#deleteObject" data-rel = "popup" data-position-to = "window" data-transition = "pop">Delete Entry</a></li>');     
        var pageNum = $('#ulOrigin'+i);
        console.log(newObj);

    }

}; 
```

我正在尝试创建一个动态页面，其名称取自`newObj[1].value`. 访问链接时，我得到的错误是`Error Loading Page`. 在控制台中我有： 也`OPTIONS file:///home/<address>/[object%20Object]`标记为错误。

我正在使用 jQuery Mobile 1.3.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T15:59:26.653

问题是 dynPage 不是字符串，在您当前的实现中，您有

```
var dynPage = $(newObj[1].value).trigger('create'); 
```

其次是

```
var insideLi = $('#ulOrigin'+i).append('<li><a href="'+dynPage+'">.... 
```

我只是假设您在单击上面的 href 时收到错误。我不知道 create 是如何工作的，但是 href 应该指向一个页面，这样你的 href 就会有一个正确的 URL。

如果您在单击代码创建的链接时确实遇到了错误，那么您可以使用最新代码更新问题，并添加该链接的生成 html，以便我们可以确切地看到发生了什么。

# java - 如何将 HTML 代码呈现或转换为从所见即所得编辑器生成的纯文本

> ID：15549909
> 
> 赞同：0
> 
> 时间：2013-03-21T14:11:20.970
> 
> 标签：java, html, parsing, html-parsing, jericho-html-parser

我在我的 Web 应用程序中使用了所见即所得的编辑器 (CKEditor) 来为用户提供基本的文字处理器。我试图将该 CKEditor 的输出保存到 pdf 文档。我现在可以生成 pdf 文档，但问题是 CKEditor 的输出是 HTML 代码，并且它正在以 pdf 的形式发布。我想发布在 CKEditor 中看到的 pdf 文档，但我不希望 pdf 中的那些 HTML 标签。Java中是否有任何库可以通过消除那些html标签但保留它们的效果来呈现或将该html代码转换为纯文本，即如果HTML代码有**This is Bold**然后pdf应该保存为**This is Bold**不像 `<b>`This is Bold`</b>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:15:52.080

您可以使用库将 HTML 从 ckeditor 转换为 PDF。有很多选项可以将 HTML 转换为 PDF。这个飞碟项目是一个很好的项目：[https](https://code.google.com/p/flying-saucer/) ://code.google.com/p/flying-saucer/ 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:16:37.930

[iText](http://sourceforge.net/projects/itext/)是一个非常流行的用于将 HTML 转换为 PDF 的库。但是，如果您选择使用他们的库，请注意与您使用的 iText 版本相关的许可。

# c# - 如何将多条记录添加到gridview

> ID：15549913
> 
> 赞同：-3
> 
> 时间：2013-03-21T14:11:30.290
> 
> 标签：c#, asp.net

我创建了一些文本框和一个按钮。当按下按钮时，我想在网格视图中显示每条新记录，但只有在工作时才添加记录，然后当您再次添加它时，旧记录消失并出现新记录。

```
var dt = new DataTable();

        DataColumn cl = new DataColumn("From");
        dt.Columns.Add(cl);
        cl = new DataColumn("To");
        dt.Columns.Add(cl);

        DataColumn cl1 = new DataColumn("Area");
        dt.Columns.Add(cl1);
        cl1 = new DataColumn("Sector");
        dt.Columns.Add(cl1);

        DataColumn cl2 = new DataColumn("CompanyName");
        dt.Columns.Add(cl2);
        cl2 = new DataColumn("Description");
        dt.Columns.Add(cl2);

        DataRow dr = dt.NewRow();
        dr[0] = TextBoxFrom.Text;
        dr[1] = TextBoxTo.Text;
        dr[2] = TextBoxArea.Text;
        dr[3] = TextBoxSector.Text;
        dr[4] = TextBoxCompanyName.Text;
        dr[5] = TextBoxDescription.Text;
        dt.Rows.Add(dr);

        GridViewAllAssigments.DataSource = dt;
        GridViewAllAssigments.DataBind(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:30:47.867

首先，我建议您不要使用`DataTable`绑定 GridView，而是创建一个类来保存您的数据。

```
public class MyData
{
    public string From { get; set; }
    public string To { get; set; }
    public string Area { get; set; }
    public string Sector { get; set; }
    public string CompanyName { get; set; }
    public string Description { get; set; }
} 
```

您必须在 Session 变量中维护数据，这样您就不会在每次回发时丢失数据：

```
public List<MyData> MyData
{
    get
    {
        if (Session["MyData"] == null)
            return new List<MyData>();

        return (List<MyData>)Session["MyData"];
    }
    set
    {
        Session["MyData"] = value;
    }
} 
```

从控件中检索值时，请使用以下命令：

```
var myData = this.MyData;
myData.Add(new MyData() { 
        Area = TextBoxArea.Text, 
        CompanyName = TextBoxCompanyName.Text, 
        Description = TextBoxDescription.Text, 
        From = TextBoxFrom.Text, 
        Sector = TextBoxSector.Text, 
        To = TextBoxTo.Text 
    });

this.MyData = myData;           

GridViewAllAssigments.DataSource = this.MyData;
GridViewAllAssigments.DataBind(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:21:30.773

您的代码不起作用，因为您每次都在创建 DataTable 的新实例，然后添加新行。

为此，您需要创建 DataTable**一次**，将该行添加到现有 DataTable 并重新绑定它。

像这样的东西：

```
DataTable dt = Session["DT"]  as DataTable;
if(dt==null)
{
   dt = new DataTable(); 
   Session["DT"]=dt;//store it for next round trip
}

//rest of your code code to add a new row...

GridViewAllAssigments.DataSource = dt;
GridViewAllAssigments.DataBind(); 
```

# c# - 从 Web Api 控制器返回 XML

> ID：15549918
> 
> 赞同：-1
> 
> 时间：2013-03-21T14:11:43.967
> 
> 标签：c#, xml, asp.net-mvc, asp.net-web-api

如何指定从 web api 控制器返回 xml？在一个浏览器中，数据以 XML 格式打开，而另一种则以 JSON 格式打开。

**编辑**

这是我的行动：

```
 [HttpGet]
    public IEnumerable<MagazineMeta> GetLastUploadPdfMeta(int count)
    {
       List<MagazineMeta> metas = _metaRepository
                 .GetAll()
                 .OrderBy(e => e.TimeAdd)
                 .Take(count)
                 .ToList();

       return metas;
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T14:24:18.730

将这两行添加到 Global.asax.cs 中 Application_Start 的末尾：

```
GlobalConfiguration.Configuration.Formatters.Clear();
GlobalConfiguration.Configuration.Formatters.Add(new System.Net.Http.Formatting.XmlMediaTypeFormatter()); 
```

**编辑：** 正如@YishaiGalatzer 指出的那样，这是实现最初提出的问题的快速而肮脏的解决方法。要获得所需的响应格式，请在请求中包含适当的 Accept 标头（在此问题的上下文中，“application/xml”）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-20T22:23:00.463

要使响应序列化，您需要多行

```
GlobalConfiguration.Configuration.Formatters.XmlFormatter.UseXmlSerializer = true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-30T11:58:53.400

而对于其他想要强制执行 json 的人，请调用：

```
GlobalConfiguration.Configuration.Formatters.Clear();
GlobalConfiguration.Configuration.Formatters.Add(new System.Net.Http.Formatting.JsonMediaTypeFormatter()); 
```

# c# - 选择 ListView 中的下一项

> ID：15549921
> 
> 赞同：4
> 
> 时间：2013-03-21T14:11:49.103
> 
> 标签：c#, winforms, listview, selectedindex

我有一种方法可以删除 ListView 中当前选定的项目

```
listView1.Items.Remove(listView1.SelectedItems[0]); 
```

删除选定的一个后如何在 ListView 中选择下一个？

我尝试了类似的东西

```
var index = listView1.SelectedItems[0].Index;
listView1.Items.Remove(listView1.SelectedItems[0]);
listView1.SelectedItems[0].Index = index; 
```

但我得到了错误

```
Property or indexer 'System.Windows.Forms.ListViewItem.Index' cannot be 
assigned to -- it is read only 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-11T20:28:33.247

我不得不在上面的上一个答案中再添加一行代码，并进行检查以验证未超过计数：

```
int selectedIndex = listview.SelectedIndices[0];
selectedIndex++;
// Prevents exception on the last element:      
if (selectedIndex < listview.Items.Count)
{
  listview.Items[selectedIndex].Selected = true;
  listview.Items[selectedIndex].Focused = true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:18:06.880

[`ListView`](http://msdn.microsoft.com/en-us/library/s2edxtd5%28v=vs.100%29.aspx)没有`SelectedIndex`财产。它有一个[`SelectedIndices`](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.selectedindices%28v=VS.100%29.aspx)属性。

> 获取控件中选定项的索引。

```
ListView.SelectedIndexCollection indexes = this.ListView1.SelectedIndices;

foreach ( int i in indexes )
{
 //
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:13:02.953

尝试使用 listView1.SelectedIndices 属性

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T14:25:26.983

如果您删除一个项目，“下一个”项目的索引与您刚刚删除的那个索引相同。所以，我会确保你有`listview1.IsSynchroniseDwithCurrentItemTrue = true`然后

```
var index = listView1.SelectedItems[0].Index;
listView1.Items.Remove(listView1.SelectedItems[0]);
CollectionViewSource.GetDefaultView(listview).MoveCurrentTo(index); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-25T10:58:01.193

我已通过以下方式完成此操作：

```
int selectedIndex = listview.SelectedIndices[0];
selectedIndex++;
listview.Items[selectedIndex].Selected = true; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-05T14:48:20.940

我实际上必须这样做：

```
 int[] indicies = new int[listViewCat.SelectedIndices.Count];
        listViewCat.SelectedIndices.CopyTo(indicies, 0);
        foreach(ListViewItem item in listViewCat.SelectedItems){
            listViewCat.Items.Remove(item);
            G.Categories.Remove(item.Text);
        }
        int k = 0;
        foreach(int i in indicies)
            listViewCat.Items[i+(k--)].Selected = true;
        listViewCat.Select(); 
```

为了让它工作，没有其他解决方案对我有用。

希望有经验的程序员能给出更好的解决方案。

# android - 如何在 Android xml 布局中排列重叠按钮？

> ID：15549923
> 
> 赞同：0
> 
> 时间：2013-03-21T14:11:58.123
> 
> 标签：android, xml-layout

在我的布局中，有三个按钮，并且想要为按钮背景设置 PNG 图像，但是按钮彼此重叠一点。我想如何在我的布局中排列按钮。在这种情况下，哪种布局对我来说会更好。您可以在下面看到我想要开发的布局图像。请在这方面帮助我；您的帮助将不胜感激。

![在此处输入图像描述](../Images/c5ba76a887ffa14bbdf1a532c120ab8c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:34:42.133

您可以将所有 3 个按钮放在一个容器中，例如`RelativeLayout`.
中心按钮（大按钮）将对齐为“centerHorizo​​ntal=true”。左右按钮将对齐为“alignParentLeft=true”，并分别对齐为“alignParentRight=true”。另外，两个按钮顶部都有一些边距。

相信可以达到你想要的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:27:36.520

至少你可以使用`AbstractLayout`，虽然它是`deprecated`。

# c++ - 需要动态数组、析构函数、深度复制帮助

> ID：15549929
> 
> 赞同：2
> 
> 时间：2013-03-21T14:12:12.223
> 
> 标签：c++, arrays, dynamic, deep-copy

好的，这是我仍然需要做的事情。我在语法上有一些严重的问题。当我尝试声明一个动态分配的数组时，我不知道为什么会出错。如果我能在这方面得到一些帮助，那就太好了。

`BabyNames`班级：

1.  应该有作为数据成员：
    *   动态分配的数据对象数组
    *   表示数组容量的 int 数据成员
    *   一个 int 数据成员，用于跟踪有多少数组位置中有 Data 对象。
2.  除了一个或多个“常规”构造函数之外，还实现 i. 执行“深度”复制的复制构造函数——使用它来制作副本。ii. 一个重载的赋值运算符 iii. 一个虚拟析构函数，用于释放由任何构造函数分配的任何内存。
3.  重载插入 ( `<<`) 和提取 ( `>>`) 运算符。

这是标题

```
 /*
 * File:   BabyNames.h
 * Author: jack
 *
 * Created on March 18, 2013, 3:35 PM
 */

#ifndef BABYNAMES_H_
#define BABYNAMES_H_
#include <string>
#include <fstream>
using namespace std;
using std::ifstream;

/**
 * gender: an enum to hold types boy and girl
 */
enum gender {boy, girl};

/**
 * PeopleStats: a data struct to hold year, name, double, and the enum type
 * gender
 */
struct PeopleStats {
    short year;
    string name;
    double percent;
    gender sex;
};

/**
 * Names: A class that reads data from a file into a PeopleStats Array
 * and is capable of sorting them by name and by popularity percentage
 */
class BabyNames {

public:
    BabyNames();
    BabyNames(const char fn[], const int numLines);
    gender parseSex(string s);
    void swap(int i);
    const int getCapacity();//getter for dataSize
    const PeopleStats& get(int i) const; //getter for objects of the data array
    void sortByName();      //Sorts the names alphabetically
    void sortByPopularity();//Sorts the names by popularity
    friend std::ostream& operator<<(std::ostream& os, const BabyNames& bn);
    //friend std::PeopleStats& operator =(const PeopleStats& rhs);

private:
    static const int MAX_DATA_SIZE = 25000;
    PeopleStats* people; 

    int capacity;
    int fillCount; // to keep track of how many array locations have data objects in them
    static const int OUT_OF_BOUNDS = -1;

};//end of class

#endif  /* BABYNAMES_H */ 
```

这里是函数

```
/**
 * PeopleSort.cpp
 * Description:
 * This class stores the information in data structure and includes methods that
 * sort the data by name and by popularity.
 * Created:
 * Feb 27, 2013
 * Modified:
 * March 1st 2013
 */

#include <iostream>
#include <string>
#include <fstream>
using namespace std;
using std::ifstream;
#include "BabyNames.h"

/**
 * BabyNames: A class that reads data from a file into a PeopleStats Array
 * and is capable of sorting them by name and by popularity percentage
 */

BabyNames::BabyNames(const char fn[], const int numLines) {
    people = new PeoplStats[MAX_DATA_SIZE]; //edit I put this in but I still get errors
    //set current capacity
    capacity = numLines;
    //Open File
    ifstream myfile;
    myfile.open(fn);
    //read in data
    int current = 0;
    while (current < capacity) {
        myfile >> people[current].year;
        myfile >> people[current].name;
        myfile >> people[current].percent;
        string sex;
        myfile >> sex;
        people[current].sex = parseSex(sex);
        current++;
    }

}

BabyNames::~BabyNames(){
    cout << "Deconstructor" << endl;
    delete[]people; //Edit: I added this
}

/*
 * sortByName - Sorts the entire array of people by name using the bubble
 * sort algorithm. Array is sorted according to name, within the structure
 * Algorithm becomes extremely slow if capacity > 3000
 */
void BabyNames::sortByName(){
    //sorted is set to true if no changes were made
    bool sorted = false;
    //change tells the loop if we made a swap or not
    bool change = false;
    while (!sorted) {
        for (int i = 0; i < capacity - 1; i++) {
            int compare = people[i].name.compare(people[i + 1].name);
            if (compare == 1) {
                swap(i);
                change = true;
            }
        }
        //if the array was not changed,
        //changed sorted to true and exit loop
        if (change == false)
            sorted = true;
        //otherwise reset change and repeat the loop
        else
            change = false;
    }
}

/**
 * sortByPopularity - sorts the entire array using the bubble sort algorithm
 * Method is almost exactly the same as sortByName, except the compare
 * variable is a double consisting of the difference of the two popularity
 * percentages.
 * Algorithm becomes extremely slow if capacity > 3000
 */
void BabyNames::sortByPopularity(){
    bool sorted = false;
    bool change = false;
    while (!sorted) {
        for (int i = 0; i < capacity - 1; i++) {
            double compare = people[i].percent - people[i + 1].percent;
            if (compare < 0) {
                swap(i);
                change = true;
                break;
            }
        }
        if (change == false)
            sorted = true;
        change = false;
    }
}

/**
 * swap - swaps the positions of people[i] and people[i + 1]
 * @param i - index of the people array that will get swapped with i + 1
 */
void BabyNames::swap(int i) {
    PeopleStats temp = people[i + 1];
    people[i + 1] = people[i];
    people[i] = temp;
}
/**
 * parseSex: extracts the gender from the input and returns the appropriate enum
 * @param s
 * @return gender object
 */
gender BabyNames::parseSex(string s) {
    if (s == "boy")
        return boy;
    else if (s == "girl")
        return girl;
    else
        throw "invalid Gender";
}

/**
 * getCapacity: returns the number of data entries stored.
 * @return size of the data
 */
const int BabyNames::getCapacity(){
    return capacity;
}
/**
 * get: returns one PeopleStat Object
 * @param i
 * @require: i < capacity
 * @return PeopleStat object
 */
const PeopleStats& BabyNames::get(int i) const {
    if (i>=0 && i < capacity)
        return people[i];
    throw OUT_OF_BOUNDS;
}
/**
 * << - overloads the outstream operator for PeopleStats object
 * @param os
 * @param d
 * @return os : output stream
 */
std::ostream & operator << (std::ostream& os, const PeopleStats& d){
    os << d.name << " " << d.year << " " << d.percent << " " << d.sex;
    return os;
}

/**
 * <<: overloads the outstream operator for the BabyNames object
 * @param os
 * @param bn
 * @return
 */
std::ostream& operator<<(std::ostream& os, const BabyNames& bn) {
    os << "  BabyNames object " << std::endl;
    for (int i=0; i < 5000; i++ )
        os << "    " << (i+1) <<":  " << bn.get( i ) << std::endl;
    return os;
}//end of operator 
```

这里是主要的

```
/*Title: CS 237 Assignment#1

 * Created:
 * Feb 27, 2013
 * Modified:
 * March 1st 2013
 ********************************/

#include <iostream>
#include "BabyNames.h"

/**
 * main: The client function that controls the server, BabyNames
 * For reasons currently unknown, the program will take forever
 * to run after the  * 3000-5000 line mark.
 * @return 0 if successful
 */
int main(void) {
    cout << "People names: " << endl;
    BabyNames names("src/people.txt", 5000 );
    cout << names;
    cout << "Sorted by popularity" << endl;
    names.sortByPopularity();
    cout << names;
//    cout << "Sorted by name" << endl;
//    names.sortByName();
//    cout << names;
    cout << "... done!" << endl;
    return 0;

//This is a suggested Main by my professor
/*    cout << "People names: " << endl;
    const char filename[] = "src/people.txt";
    cout << " 1\. Reading file: \"" << filename << "\" ... ";
    int number_of_names = checklines( filename );
    cout << " number of lines in file is: " << number_of_names;
    BabyNames* names = new BabyNames( number_of_names );

    // read the contents of a file into names and print them
    ifstream file( filename, ios::in );
    file >> *names;
    cout << " file has been read!" << endl;

    // Sort and print
    cout << " 2\. Sorted by popularity:" << endl;
    BabyNames* namesByPop = new BabyNames( *names );
    namesByPop->sortByPopularity();
    cout << *namesByPop;

    // Sort and print
    cout << " 3\. Sorted by name:" << endl;
    BabyNames* namesByName = new BabyNames( *names );
    namesByName->sortByName();
    cout << *namesByName;

    // Sort and print
    cout << " 4\. Sorted by year:" << endl;
    BabyNames* namesByYear = new BabyNames( *names );
    namesByYear->sortByYear();
    cout << *namesByYear;

    cout << " 5\. Original names:" << endl;
    cout << *names;

    delete names;
    delete namesByYear;
    delete namesByName;
    delete namesByPop;*/

    cout << "... all done!" << endl;

} 
```

此外，我正在阅读的文件有很多看起来像这样的行

```
1880 John 0.081541 boy
1880 William 0.080511 boy
1880 James 0.050057 boy
1880 Charles 0.045167 boy 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:28:14.900

我认为我没有看到您在构造函数中实际分配内存的位置。

```
BabyNames::BabyNames(const char fn[], const int numLines) {
    people = new PeopleStats[numLines];
    // check for null
    .....
} 
```

此外，释放析构函数中的内存：

```
BabyNames::~BabyNames() {
    delete [] people;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:36:31.037

我假设您在标题中的以下行遇到问题：

```
PeopleStats* people = new PeopleStats[MAX_DATA_SIZE]; 
```

您不能在标头中动态分配内存。这就是为什么它不会编译。您必须在 cpp 文件中动态分配内存。您只需要在标头中声明一个指针（正如您已经完成的那样）。然后，在类的构造函数中，在尝试访问它之前分配内存。

标题：

```
class BabyNames {
public:
    BabyNames(const char fn[], const int numLines);
    ~BabyNames();

private:
    PeopleStats* people;
}; 
```

cpp文件：

```
BabyNames::BabyNames(const char fn[], const int numLines) {
    // dynamicall allocate array
    people = new PeopleStats[numLines];

    // fill in people array here
}

~BabyNames::BabyNames {
    // don't forget to free array or you will have a memory leak
    delete [] people;
} 
```

# version-control - Squarespace 上的化石存储库

> ID：15549930
> 
> 赞同：0
> 
> 时间：2013-03-21T14:12:19.100
> 
> 标签：version-control, repository, hosting, fossil, squarespace

有谁知道如何或是否可以在 Squarespace 博客网站上托管 Fossil 存储库？我仍在努力为 Android 学习 Java，现在不需要转移注意力来成为 Fossil 或网络专家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:38:48.513

我严重怀疑。这将要求您能够在他们的 Web 服务器上运行 Fossil 可执行文件；并且考虑到插入一些 HTML 是一项“高级功能”，它们看起来不像允许您这样做的托管公司。

但是你可以问他们的[技术支持](http://help.squarespace.com)。

[如果您想托管一个或多个 Fossil 存储库，我建议您在Chisel](http://chiselapp.com)设置一个帐户，该帐户托管 Fossil 存储库；它是免费的，而且设置起来非常简单。

# maven-plugin - 为什么命令行工作时 Liquibase Maven 更新目标失败并出现错误？

> ID：15549931
> 
> 赞同：1
> 
> 时间：2013-03-21T14:12:31.880
> 
> 标签：maven-plugin, liquibase

我一直在尝试让 Liquibase 的 maven 插件与一个简单的 SQL 变更集一起工作。

这是示例的略微修改版本：[http ://www.liquibase.org/manual/formatted_sql_changelogs](http://www.liquibase.org/manual/formatted_sql_changelogs)

```
-- liquibase formatted sql

-- changeset nvoxland:1

CREATE TABLE test1 (
    id int PRIMARY KEY,
    name varchar(255)
);

CREATE TABLE test2 (
    id int PRIMARY KEY,
    name2 varchar(255)
); 
```

问题是，它失败并出现错误：

```
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'CREATE TABLE test2 
```

如果我删除第二个创建语句，它将成功。

当尝试使用 Maven 使用 liquibase-plugin 运行它时，会发生这种情况。如果我使用命令行工具运行相同的变更日志文件，它将执行而不会出错。

我的 liquibase-plugin 是 1.9.5.0 版本，而 liquibase-core 是 2.0.5。

数据库是 MySql 5.5.27，JDBC 驱动程序是 5.1.24——我在 Maven 和命令行工具中使用了相同的驱动程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T18:48:55.280

真的很旧（从 2009年`liquibase-plugin`开始）并且不会在`;`. 您应该改用`org.liquibase:liquibase-maven-plugin:2.0.5`当前版本。

# php - 通过 current_timestamp 使用 PHP 和 MySQL 生成站点地图

> ID：15549933
> 
> 赞同：0
> 
> 时间：2013-03-21T14:12:34.810
> 
> 标签：php, mysql, sql, timestamp

我有 MySQL 数据库记录：post_id int、post_title 文本、post_date 时间戳（默认值为 current_timestamp）

如何使用具有以下结构的 PHP 生成站点地图，结果中没有空日期节点（其中帖子仅来自数据库），例如：

```
2010
- 2010 Jan
-- 2010 Jan 10
--- post-1
--- post-2
-- 2010 Jan 12
--- post-3
-- 2010 Jan 17
--- post-4
- 2010 Feb
-- 2010 Frb 05
--- post-5
2011
- 2011 Dec
-- 2011 Dec 02
--- post-6
--- post-7
-- 2011 Dec 21
--- post-8 
```

等等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:35:30.120

首先，您必须选择您的数据，以便在您的结构中打印出来。应该是这样的：

```
SELECT day(post_date) as day, month(post_date) as month, year(post_date) as year,
DATE_FORMAT(post_date,"%Y-%m-%d") as created_at, post_title,
post_id FROM posts ORDER BY created_at; 
```

然后你遍历结果并构建一个以年、月和日为索引的多维索引。一个条目可能如下所示：

```
$data[2013][10][31] = array("post1", "post2"); 
```

有了它，就很容易打印出您的站点地图（只需几个 foreach 结构）。

# mysql - 存储过程计算应税金额

> ID：15549936
> 
> 赞同：2
> 
> 时间：2013-03-21T14:12:47.353
> 
> 标签：mysql, sql, database, stored-procedures

我一直在计算员工在工资率变化时的年度应税金额。

```
salary_assigned_date | salary
-------------------------------
    2011-12-06          5000
    2012-01-05          10000
    2012-02-10          15000
    2012-04-08          20000
    2012-08-01          28000 
```

现在，我 2012 年的应税金额（以月份计）应该是这样的：

我假设没有。一个月的天数为 30。

```
month   |   taxable_amount
-----------------------------------------------
  01            833.33 + 8333.33   /* Since salary has been changed 
                                      at 6th of month, 
                                      for 5 days, 
                                      taxable amount = 5000/30*5 
                                      => 833.33 
                                      and for remaining 25 days
                                      = 10000/30*25=> 8333.33
                                      and same case for remaining months.*/
  02            3000 + 10500
  03            15000
  04            4666.67 + 15333.33
  05            20000
  06            20000
  07            20000
  08            933.33 + 27066.67
  09            28000
  10            28000
  11            28000
  12            28000 
```

我试图编写一个存储过程来计算应税金额，但我无法做到这一点。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:30:06.940

您需要一个 sql 语句将表中的记录连接到表中具有下一个薪水值的记录...您还需要使用 CTE（或任何 ** [MySQL 等效项](https://stackoverflow.com/questions/1382573/how-do-you-use-the-with-clause-in-mysql)* 存在）来生成所有月份没有工资变化。* [感谢@Neville 的评论]

请原谅 SQL 服务器语法，我不会为您查找 MySQL 等价物……意图应该很清楚。我知道 MySQL 有它自己的函数，相当于 SQL 服务器的日期函数`getdate()`、、、`DateDiff()`和。`DateAdd()``Day()`

```
 With Dates(dt) As
 ( Select min(salary_assigned_date) 
   From yourTable 
   Union All
   Select DateAdd(month,1, dt)
   from dates
   where dt < getdate())  -- replace getdate() with parameter for max date to calculate

  -- If MySQL has no equivalent to CTE, you need to generate a temp table with 
  -- these dates in it and use that instead of the [Dates] construction

   Select t.dt, t.salary/30.0 * (day(t.dt)-1) +
        + n.salary/30.0 * (31 - day(t.dt))
   From Dates d 
      join yourTable t On t.salary_assigned_date = 
                    (Select Min(salary_assigned_date) 
                     From test where salary_assigned_date >= d.dt)
      join yourTable n On n.salary_assigned_date = 
                    (Select Min(salary_assigned_date) 
                      From test where salary_assigned_date > d.dt)

   Select t.salary/30.0 * (day(t.salary_assigned_date)-1) +
        + n.salary/30.0 * (31 - day(t.salary_assigned_date))
   From table t
       join table n On n.salary_assigned_date =
                    (Select Min(salary_assigned_date) From table
                     Where salary_assigned_date > t.salary_assigned_date) 
```

# database - 如何循环这段代码？

> ID：15549938
> 
> 赞同：0
> 
> 时间：2013-03-21T14:12:53.540
> 
> 标签：database, r

我和我的合作伙伴有这段代码，我们在 R 中提取推文并将其放入数据库中，我们想知道如何循环这段代码，以便它定期循环。最好每 30 分钟一次。

这是我们的代码：

```
#Load twitter package for R
library(twitteR)
#load MySQL package for R
library(RMySQL)
#Load authentication files for twitter
load(file="twitter_authentication.Rdata")
registerTwitterOAuth(cred)

#Search twitter for tweets e.g. #efteling
efteling <- searchTwitter("@efteling", n=100)

#Store the tweets into a dataframe
dataFrameEfteling <- do.call("rbind", lapply(efteling, as.data.frame))

#Setup up the connection to the database()
doConnect <- dbConnect(MySQL(), user="root", password="", dbname="portfolio", host="127.0.0.1")
dbWriteTable(doConnect, "tweetsEfteling", dataFrameEfteling)

eftelingResult <- dbSendQuery(doConnect, "select text from tweetsEfteling")
showResultEfteling <- fetch(eftelingResult, n=20) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T14:14:40.467

您可以访问 crontab 吗？如果是这样，您可以将其设置为以您喜欢的频率运行脚本。

这是关于[crontab](http://en.wikipedia.org/wiki/Cron)的一些信息。
如果您的服务器运行的是 linux，您只需输入

```
crontab -e 
```

提取您的个人 crontab 文件。之后，您安排您的命令。每 30 分钟，您将使用此命令。

```
*/30 * * * *  /path/to/script 
```

保存并退出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:23:36.500

您是否考虑过使用 Twitter 的流 API 与 REST？如果您长时间保持连接打开，这可能会完成同样的事情。另外，它会减少 API 拉取。试试这个`streamR`包。

如果您仍想在计时器上设置它—<a href="http://statistics.ats.ucla.edu/stat/r/faq/timing_code.htm" rel="nofollow">http://statistics。 ats.ucla.edu/stat/r/faq/timing_code.htm 看起来很有用。

# node.js - node-http-proxy socket.io websocket 连接

> ID：15549945
> 
> 赞同：2
> 
> 时间：2013-03-21T14:13:06.170
> 
> 标签：node.js, socket.io, node-http-proxy

我正在尝试使用 socket.io 让 node-http-proxy 工作，但它总是回退到 xhr，websockets 将无法工作，尽管我正在连接到 node-http-proxy 中描述的升级事件文档。

```
var httpProxy = require ("http-proxy");

var server = httpProxy.createServer (function (req, res, proxy) {
    var buffer = httpProxy.buffer (req);
    proxy.proxyRequest (req, res, {
        host : "localhost",
        port : 8001,
        buffer : buffer
    });
});
server.listen (80);

server.on('upgrade', function (req, socket, head) {
    server.proxy.proxyWebSocketRequest(req, socket, head, { host : "localhost", port : 8001 });
}); 
```

该应用程序显然在 localhost:8001 上运行，如果我允许所有传输方法，它会正常工作，因为它使用 xhrs。如果我强制它使用 websockets，firefox 会说

```
Firefox can't establish a connection to the server at ws://localhost/socket.io/1/websocket/cNp5J80KAWkXqjE6OZOt. @ http://localhost/socket.io/socket.io.js:2371 
```

只需使用默认方法

```
httpProxy.createServer (8001, "localhost").listen (80); 
```

导致相同的错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:03:51.923

使用 node-http-proxy 代理 websocket 似乎在 Node 0.10 上被破坏了。这是一个尝试修复它的拉取请求，但请参阅我的评论：修复也不完全有效。

[https://github.com/nodejitsu/node-http-proxy/pull/402](https://github.com/nodejitsu/node-http-proxy/pull/402)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-26T12:25:36.820

我目前正在使用（最新的？v1.0.1）node-http-proxy，我发现 Websockets 在对 Node v0.10.20 进行调整（见下文）后确实可以可靠地工作。默认情况下，node-http-proxy 似乎支持 xhr-polling，同时丢弃 websocket 连接。

在“[示例](https://github.com/nodejitsu/node-http-proxy/blob/master/examples/http/basic-proxy.js)”中，我添加了“ws”标志 true

```
var http = require('http'),
    httpProxy = require('../../lib/http-proxy');

httpProxy.createServer({
  target:'http://somehost.tld:5000',
  ws : true //added Websockets Flag TRUE
}).listen(80);//arbitrary port 
```

# php - 将 2 个表与来自不同查询的数据合并？

> ID：15549947
> 
> 赞同：0
> 
> 时间：2013-03-21T14:13:07.427
> 
> 标签：php, merge, html-table

我目前有 2 个表格，如下所示：

![在此处输入图像描述](../Images/c948fa0800506fefc5f89ca6f9d35d7c.png)

这 2 个表的代码如下所示：

```
<table width="600" border="1">  
<tr>   
   <th width="91"> <div align="center">Mail_ID  </div></th> 
   <th width="91"> <div align="center">Status  </div></th> 
   <th width="91"> <div align="center">Datum  </div></th> 
</tr>
<?php 
$j = 0;  
while($objResult2 = mysql_fetch_array($objQuery2))  
{  
$j++;  
?> 
<tr>   
   <td><div align="center"><?=$objResult2["Mail_ID"];?> </div></td> 
   <td><div align="center"><?=$objResult2["Status"];?> </div></td> 
   <td><div align="center"><?=$objResult2["Datum"];?> </div></td>  
</tr>
<?php  
}  
?>
</table>
<br/>
<table width="600" border="1">  
<tr> 
   <th width="91"> <div align="center">ID  </div></th>  
   <th width="91"> <div align="center">Titel  </div></th> 
   <th width="91"> <div align="center">Subscribe  </div></th> 
   <th width="91"> <div align="center">Unsubscribe  </div></th> 
</tr>

<?php for ($i = 0; $objResult1 = mysql_fetch_array($objQuery1); $i++) : ?>
<tr>  
    <td><div align="center"><?=$objResult1["ID"];?><input type="hidden" name="mailid[]" value="<?=$objResult1["ID"];?>"> </div></td>
    <td><div align="center"><?=$objResult1["Titel"];?> </div></td>  
    <td><div align="center"><input type="radio" name="sub[<?php echo $i; ?>]" value="10"> </div></td>  
    <td><div align="center"><input type="radio" name="sub[<?php echo $i; ?>]" value="90"> </div></td> 
</tr>
<?php endfor; ?>

</table> 
```

查询和变量如下所示：

```
$strSQL1    = "SELECT ID, Titel FROM Mail"; 
$strSQL2    = "SELECT * FROM Subscriptions,
(SELECT MAX(ID) as ids, Mail_ID FROM Subscriptions
    WHERE Klant_ID = '".$_GET["ID"]."' GROUP BY Mail_ID) table2
WHERE ID=table2.ids";  
$objQuery1  = mysql_query($strSQL1);
$objQuery2     = mysql_query($strSQL2); 
```

现在我想合并这两个表，如下所示：

![在此处输入图像描述](../Images/670cefe9b68e42b507991d845b09e180.png)

我无法让它工作，因为我尝试的所有东西都混合了所有东西，因为那里有 2 个循环。我希望你们能理解我的问题，我添加了尽可能多的信息和图片以使一切清楚^^如果您仍有问题，请提出评论。欢迎任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:18:40.320

我不确定这是否对您来说是一个完整的解决方案，但它应该是一个开始：

```
SELECT Mail.ID Mail_ID, Mail.Titel, Subscriptions.status, Subscriptions.Datum, Subscriptions.Subscribe, Subscriptions.Unsubscribe
FROM Mail left join Subscriptions on Mail.ID = Subscriptions.Mail_ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:19:27.980

使用 SQL Join 形成一个返回所有数据的 SQL 查询。然后只使用一个循环。

SQL 可能类似于：

```
SELECT ID, Titel, Subscriptions.* FROM Mail INNER JOIN Subscriptions ON Subscriptions.ID = Mail.ID ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:21:09.363

您应该像其他人已经说过的那样使用连接。通过加入两个或多个表您不需要使用多个 while 循环，这样代码会更干净

```
SELECT 
  Mail.ID Mail_ID,
  Mail.Titel,
  Subscriptions.status,
  Subscriptions.Datum,
  Subscriptions.Subscribe,
  Subscriptions.Unsubscribe 
FROM
  Mail 
LEFT JOIN Subscriptions 
ON (Subscriptions.Mail_ID = Mail.ID) 
```

其中一种联接类型应该适合您：LEFT JOIN 或 INNER JOIN。

HTML 应如下所示：

```
<table width="600" border="1">  
<tr>   
   <th width="91"> <div align="center">Mail_ID  </div></th> 
   <th width="91"> <div align="center">Status  </div></th> 
   <th width="91"> <div align="center">Datum  </div></th> 
   <th width="91"> <div align="center">Titel  </div></th> 
   <th width="91"> <div align="center">Subscribe  </div></th> 
   <th width="91"> <div align="center">Unsubscribe  </div></th> 
</tr>
<?php 
while ($objResult2 = mysql_fetch_array($objQuery2))  
{
?> 
<tr>   
   <td><div align="center"><?=$objResult2["Mail_ID"];?> </div></td> 
   <td><div align="center"><?=$objResult2["Status"];?> </div></td> 
   <td><div align="center"><?=$objResult2["Datum"];?> </div></td>  
   <td><div align="center"><?=$objResult1["Mail_ID"];?><input type="hidden" name="mailid[]" value="<?=$objResult1["Mail_ID"];?>"> </div></td>
   <td><div align="center"><?=$objResult1["Titel"];?> </div></td>  
   <td><div align="center"><input type="radio" name="sub[<?=$objResult1["Subscriptions_ID"];?>]" value="10"> </div></td>  
   <td><div align="center"><input type="radio" name="sub[<?=$objResult1["Subscriptions_ID"];?>]" value="90"> </div></td> 
</tr>
<?php
}
?>
</table> 
```

如果您使用 LEFT JOIN，则所有邮件行都将可见，但如果您使用 INNER JOIN，则只有那些与订阅行相关联的邮件行将可见

# haskell - 它如何在 Haskell 文件中使用已翻译的消息？

> ID：15549956
> 
> 赞同：3
> 
> 时间：2013-03-21T14:13:25.063
> 
> 标签：haskell, internationalization, yesod

我在 Internet、Yesod Web 电子书和其他教程（[Yesod 教程](http://tutorial-yesod-haskell.computer-mind.com/static/tutorial/yesod_tutorial.html)）中进行了搜索，但我无法澄清这个问题。我正在使用脚手架站点。

我有一个处理程序，在它内部返回一个值，如果用户已通过身份验证，则返回电子邮件，否则返回字符串。我想要的是返回本地化消息而不是字符串“（未知用户 ID）”。我的问题是使用消息文件中的值（例如 MsgHello），如果我这样做，它会返回如下错误：

> 无法匹配预期`AppMessage' with actual type`的文本类型'

我曾尝试使用**(show MsgHello)**或**(pack MsgHello)**，甚至调用**msg <- getMessageRender**但我无法做到我所期望的。如果您有任何建议，欢迎提出。

谢谢！！

PD：这是我正在处理的代码的一部分，行：

```
getUserProfileR :: Handler RepHtml
getUserProfileR = do        
    maid <- maybeAuth
    let user = case maid of
                    Nothing -> "(Unknown User ID)"
                    Just (Entity _ u) -> userEmail u
    defaultLayout $ do
        setTitleI MsgUserProfile
        $(widgetFile "nhUserProfile") 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T02:51:21.867

感谢 Tickhon Jelvis 指出这些网页，我还找到了这个：[Poly Hamlet i18n](http://www.yesodweb.com/blog/2011/05/non-poly-hamlet-i18n)，在那里我能够找到问题的解决方案。

因此，如果我想使用本地化消息，我会这样做：

```
getUserProfileR :: Handler RepHtml
getUserProfileR = do        
    maid <- maybeAuth
    msg <- getRenderMessage
    let user = case maid of
                    Nothing -> msg MsgNoUser --"(Unknown User ID)"
                    Just (Entity _ u) -> userEmail u
    defaultLayout $ do
        setTitleI MsgUserProfile
        $(widgetFile "nhUserProfile") 
```

还要记住，有一个帮助函数“setTitleI”，它直接接受一个 Msg 值并避免使用“msg MsgThisPageTitle”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T16:55:43.080

我对`I18N`模块的理解是你想把你的`AppMessage`价值用[`renderMessage`](http://hackage.haskell.org/packages/archive/shakespeare-i18n/latest/doc/html/Text-Shakespeare-I18N.html#t%3aRenderMessage)在它上面。

您需要传入一个类型，指定您的翻译类型和语言列表以及您的消息。翻译类型是使用[`mkMessage`](http://hackage.haskell.org/packages/archive/shakespeare-i18n/latest/doc/html/Text-Shakespeare-I18N.html#v%3amkMessage)函数创建的，语言列表类似于`["en-US", "en-GB", "fr"]`.

# java - 在泛型方法参数中键入 T 参数

> ID：15549958
> 
> 赞同：13
> 
> 时间：2013-03-21T14:13:27.487
> 
> 标签：java, generics

假设定义了以下类：

```
class Shape { }
class Circle extends Shape {  }
class Rectangle extends Shape { }  //  1 
```

您可以编写一个通用方法来绘制不同的形状：

```
public static <T extends Shape> void draw(T shape) { }   // 2 
```

Java 编译器将 T 替换为 Shape：

```
public static void draw(Shape shape) {  } // 3 
```

我的问题是，如果我们在类中直接定义 // 3 那么我们仍然可以传递`Shape`,`Circle`并`Rectangle`引用 //3 处的方法。那么为什么我们需要编写 // 2 泛型方法，其类型参数`<T extends Shape>`与 //3 不合时宜？

您可以使用相同的示例参考此链接：http: [//docs.oracle.com/javase/tutorial/java/generics/genMethods.html](http://docs.oracle.com/javase/tutorial/java/generics/genMethods.html)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T14:17:22.193

您可能需要也可能不需要它。如果您的方法必须处理`T`必须与类型`T extends Shape`完全匹配的其他类型的对象，则需要它，例如：

```
public static <T extends Shape> void drawWithShadow(T shape, Class<T> shapeClass) {
    // The shadow must be the same shape as what's passed in
    T shadow = shapeClass.newInstance();
    // Set the shadow's properties to from the shape...
    shadow.draw(); // First, draw the shadow
    shape.draw();  // Now draw the shape on top of it
} 
```

上面，通过`Shape`是不够的，因为我们无法制作完全相同类型的阴影。

如果没有这样的要求，一个简单的`Shape`就足够了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T14:16:37.260

在这种特殊情况下，您不需要通用方法。

但是您可以在泛型方法中做更多的事情，而不是在其参数上调用动态链接的方法。

例如，您可能有一个接受并返回 T 元素集合的泛型方法。按类型参数化它允许您在多种集合类型上使用它。

[本Java 教程](http://docs.oracle.com/javase/tutorial/extra/generics/methods.html)中提供了其他有用的泛型方法示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T14:22:55.980

在您的示例中，//3 确实与//2 相同。但在其他用例中，泛型类型可能有用：

*   您想从方法中返回与参数相同类型的值

*   您有 2 个或更多参数并希望设置它们必须为同一类型的限制

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-21T14:24:22.203

不同之处在于您使用的多态性类型。

在一般情况下，您使用的是*参数多态性* ，而在第二种情况下，您使用的*是 subtype 的多态性*。实际上，您的第一个案例使用了两种多态性。

现在，它们在某些方面可能相似，但它们并不相同。一个实际的例子：

```
List<Shape> shapes;
List<T extends Shape> specificShapes; 
```

您可以看到，在第一种情况下，没有类型参数，我无法管理 Shape 的特定子类型的列表，我只能管理一个固定的形状列表，但我无法强制使用任何特定的形状. 所以我没有任何编译时果汁禁止我将 a`Triangle`和 a添加`Rectangle`到`shapes`.

```
class ShapeDecorator {
  private Shape shape;

  ..

  Shape get() { return shape; }
}

class ShapeDecorator<T extends Shape> {
  private T shape;

  T get() { return shape; }
} 
```

这是另一个示例，在这种情况下，您可以编写一个通用装饰器，它能够在不需要任何强制转换的情况下返回类型 T。这在许多将共同祖先作为子类型还不够的情况下很有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-21T14:17:31.203

主要的兴趣是您可以在代码的不同部分将方法的使用限制为特定类型的形状。

在某些时候，您可能希望将其参数化为仅`Rectangle`在另一个地方绘制`Circle`，这将在编译时进行检查，即使在运行时，您将传递一些类型的东西`Shape`

# html - 如何将 HTML 输出字段分成 2 个单独的字段而不是一个合并的字段

> ID：15549960
> 
> 赞同：0
> 
> 时间：2013-03-21T14:13:50.740
> 
> 标签：html, input, html-table, output

目前这段代码给了我想要的数字结果，但是两个可能的输出显示为一个长数字，但我希望能够将它们分成自己的表格。

```
<form
 oninput="x.value=parseInt(a.value)*parseInt(300);y.value=parseInt(a.value)*parseInt(400);">
  <input name="a" value="" type="text">
<output name="x" for="a b"><br>
  </output><output name="y" for="a b"></output></form> 
```

我尝试将每个字段放入一个表格中，例如

```
 <form
 oninput="x.value=parseInt(a.value)*parseInt(300);y.value=parseInt(a.value)*parseInt(400);">
  <output for="a b" name="y"></output>
  <table style="text-align: left; width: 100px;" border="1"
 cellpadding="2" cellspacing="2">
    <tbody>
      <tr>
        <td><input name="a" value="" type="text"></td>
      </tr>
<tr>
<td><output name="x" for="a b"></td>
</tr>
<tr>
<td><output name="y" for="a b"></td>
</tr>
    </tbody>
  </table>
</form> 
```

但这只会将输入字段放入一个表中，一个输出和两个空白表空间......我迷路了。帮助？请？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:30:08.880

如果您删除表单下的两个杂乱无章的输出字段，应该可以正常工作，如下所示：

```
<form
    oninput="x.value=parseInt(a.value)*parseInt(300);y.value=parseInt(a.value)*parseInt(400);">
        <table style="text-align: left; width: 100px;" border="1"
        cellpadding="2" cellspacing="2">
        <tbody>
                <tr>
                    <td><input name="a" value="" type="text"></td>
                </tr>
                <tr>
                    <td><output name="x" for="a b"></td>
                </tr>
                <tr>
                    <td><output name="y" for="a b"></td>
                </tr>
            </tbody>
        </table>
    </form> 
```

在一个表单中，一个名称只能使用一次，因此删除顶部（但在表格之外）名称为“y”的杂乱无章的元素应该删除表单中重复的“y”元素，让“oninput”代码找到正确的输出字段。

# python - Google Drive SDK、Python 客户端库中未处理的错误

> ID：15549962
> 
> 赞同：1
> 
> 时间：2013-03-21T14:14:00.070
> 
> 标签：python, google-app-engine, google-drive-api

我们复制并创建系统中可用的克隆 Google 文档。总的来说它工作得很好，但在一些未知的场景中，我们面临着这种引用。

使用：Python Appengine 服务帐户 [https://code.google.com/p/google-api-python-client/](https://code.google.com/p/google-api-python-client/)

这是跟踪：

```
 doc = apiclient.copyFile("originalDocId",mimeType, description="Doc Template",defaultPermissions={ 'value': None , 'type': "anyone",  'role': "writer" })
  File "/base/data/home/apps/s~unkonown-app/ver-no-26-4/googleAPIClientV3/locusClient.py", line 142, in copyFile
    body=body).execute()
  File "/base/data/home/apps/s~unkonown-app/ver-no-26-4/oauth2client/util.py", line 120, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/base/data/home/apps/s~unkonown-app/ver-no-26-4/apiclient/http.py", line 676, in execute
    headers=self.headers)
  File "/base/data/home/apps/s~unkonown-app/ver-no-26-4/oauth2client/util.py", line 120, in positional_wrapper
    return wrapped(*args, **kwargs)
  File "/base/data/home/apps/s~unkonown-app/ver-no-26-4/oauth2client/client.py", line 420, in new_request
    redirections, connection_type)
  File "/base/data/home/apps/s~unkonown-app/ver-no-26-4/httplib2/__init__.py", line 1436, in request
    (response, content) = self._request(conn, authority, uri, request_uri, method, body, headers, redirections, cachekey)
  File "/base/data/home/apps/s~unkonown-app/ver-no-26-4/httplib2/__init__.py", line 1188, in _request
    (response, content) = self._conn_request(conn, request_uri, method, body, headers)
  File "/base/data/home/apps/s~unkonown-app/ver-no-26-4/httplib2/__init__.py", line 1171, in _conn_request
    content = response.read()
AttributeError: 'NoneType' object has no attribute 'read' 
```

我们需要调试并知道为什么会发生这种情况，但这可能需要时间。因此，如果有人遇到同样的问题并找到了解决方法，请大家帮忙。

提前致谢...

从错误堆栈添加另一条消息

```
An error occurred: <HttpError 503 when requesting https://www.googleapis.com/drive/v2/files/<dodc ID>/copy?pinned=true&alt=json returned "Backend Error"> 
```

# javascript - 如何根据 CFM 表单选择值发送电子邮件

> ID：15549964
> 
> 赞同：1
> 
> 时间：2013-03-21T14:14:06.323
> 
> 标签：javascript, coldfusion

我有一个 javascript 表单，它可以完美地链接到一个 .cfm 表单，它可以向正确的人发送电子邮件。如果选择了选项 A，我想向一个人发送电子邮件，如果选择了选项 B，我想向另一个人发送电子邮件。

我用 Javascript 做这个吗？如果是这样，我如何将其连接到 .cfm 电子邮件表单？

就像是：

> 如果（选项=='a'）
> 
> 向约翰发送电子邮件
> 
> 否则如果（选项=='b'）
> 
> 给汤姆发邮件

发送电子邮件的语法是什么？我应该用coldfusion语法来代替吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T14:32:46.147

在您的 .cfm 文件中，它很简单：

```
<cfif form.option EQ "a">
  <cfset mailto="john@example.com">
<cfelseif form.option EQ "b">
  <cfset mailto="tom@example.com">
<cfelse>
<!--- you should have a default if option could be non-selected --->
  <cfset mailto="jane@example.com">
</cfif>

<cfmail to="#mailto#" ...> 
```

或者如果用户只能从 A 或 B 中选择，那么你不需要 else-if 部分，它可以简化为：

```
<cfif form.option EQ "a">
  <cfset mailto="john@example.com">
<cfelse>
  <cfset mailto="tom@example.com">
</cfif>

<cfmail to="#mailto#" ...> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:36:44.973

另外，需要注意的一件事......如果您使用复选框或单选按钮表单元素，如果用户没有选择任何值，HTML 将不会为该表单元素提交任何值。

所以我喜欢这样写我的代码：

```
<cfset option = "default">  <!--- setup whatever default value you want here --->
<cfif isDefined( "form.option" )>
   <cfset option = form.option>
</cfif>

<cfif option EQ "a">
   <cfset mailto="john@example.com">
<cfelseif option EQ "b">
   <cfset mailto="tom@example.com">
<cfelseif option EQ "default">
   <!--- you should have a default if option could be non-selected --->
  <cfset mailto="jane@example.com">
</cfif>

<cfmail to="#mailto#" ...> 
```

# jquery - jQuery在选择选项上模拟点击事件

> ID：15549975
> 
> 赞同：11
> 
> 时间：2013-03-21T14:14:38.680
> 
> 标签：jquery, select, click, option

我有一个选择菜单，一旦单击其中一个选项，就会触发 AJAX 请求。我需要从链接中触发相关选项的点击事件。所以我有类似于下面的代码，虽然它改变了选择的值，但它并没有模拟点击：

```
$('#click').click(function(){
    var value = $(this).attr("rel");
    $('#select').val(value);
    return false;
});

<select id="select" name="select">
    <option>Select...</option>
    <option value="1">Option 1</option>
    <option value="2">Option 2</option>
</select>

<a href="#" rel="1" id="click">Click for option 1</a> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-07-09T16:15:27.437

在选项上触发点击事件将不起作用。这是一个片段：

```
 $('#click').on('click', function(){
        var value = $(this).attr('rel'); //get the value
        value++; //increment value for the nth-child selector to work

        $('#select')
          .find('option:nth-child(' + value + ')')
          .prop('selected',true)
          .trigger('change'); //trigger a change instead of click

        return false;
    }); 
```

我在[这里](https://jsfiddle.net/tg20kq5a/)设置了一个小提琴，显示相同。这应该有效。

您可以触发更改事件并实现相同的效果，而不是使用单击。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T14:16:22.230

```
$('#click').click(function(){
    var value = $(this).attr("rel");
    $('#select')
        .val(value)
        .trigger('click');
    return false;
}); 
```

仅仅设置 a 的值`<select>`不会触发该元素的点击事件；它必须直接调用。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-21T14:33:56.397

它是 WooCommerce 核心的一部分，所以我不能全部发布。但这里有一个片段，虽然我不太确定它是否会告诉你很多......

```
.on( 'change', '.variations select', function( event ) {

    $variation_form = $(this).closest('form.variations_form');
    $variation_form.find('input[name=variation_id]').val('').change();

    $variation_form
        .trigger( 'woocommerce_variation_select_change' )
        .trigger( 'check_variations', [ '', false ] );

    $(this).blur();

    if( $().uniform && $.isFunction( $.uniform.update ) ) {
        $.uniform.update();
    }

} ) 
```

# performance - SCORM 中的性能交互

> ID：15549978
> 
> 赞同：2
> 
> 时间：2013-03-21T14:14:53.423
> 
> 标签：performance, interaction, scorm, scorm2004

我了解了scorm数据模型元素**cmi.interactions.n.type**（true_false，multiple_choice，fill_in，long_fill_in，matching，performance，sequence，likert，numeric，other）指定的几乎所有类型的交互，还有待了解类型性能. 我找到了对 Ostyn 的解释，但仍然模棱两可。

> Performance 交互是 SCORM 中最灵活、最丰富的标准交互类型。它允许捕获学习者执行的许多任意步骤，以及有关每个步骤的信息。（克劳德·奥斯汀）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-24T17:09:07.330

AFAIK 正是这样做的，即存储与模棱两可的非标准交互（例如 3D 模拟）相关的任意数据。LMS 无论如何都不应该对交互数据做任何事情，至少不涉及完成和评分，因此它主要由需要更深入地了解学习者在做什么然后调整训练的教学设计人员使用，例如练习难度。

# haml - 我怎么用haml写这个

> ID：15549990
> 
> 赞同：0
> 
> 时间：2013-03-21T14:15:34.280
> 
> 标签：haml

我正在尝试使用 fonts.com webfont 加载器。但是我正在处理的页面是用 haml 创建的。我对 haml 比较陌生，所以在如何使用加载器将这个脚本标记转换为新语法时遇到了麻烦。

```
<script type="text/javascript">

    WebFont.load({

        monotype: {

            projectId: 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'///this is your Fonts.com Web Fonts projectId

        }

    });

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:20:53.633

您可以使用`:javascript`过滤器

```
:javascript
  WebFont.load({
      monotype: {
            projectId: 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx'
        }
  }); 
```

# c - 为什么这个枚举不起作用？

> ID：15549993
> 
> 赞同：-2
> 
> 时间：2013-03-21T14:15:38.073
> 
> 标签：c, enumeration

当我编译这段代码时，它给了我

“[错误] 未知类型名称‘天’”。我究竟做错了什么？

```
#include <stdio.h>

int main(void){

int k=0;
enum days {Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday};

days dayVariable;

printf("Enter number of the day: ");
scanf("%d",&k);

dayVariable=days(k);

printf("%s", dayVariable);

return 0;

 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T14:17:44.913

如果是 C，你必须写：

```
enum days dayVariable;

...

dayVariable = (enum days)k; 
```

如果您想`days`成为类型名称，请 typedef 它：

```
typedef enum {Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday} days; 
```

除此之外，您在 printf 中使用了错误的格式说明符。

*附言*

请记住，C 和 C++ 是不同的语言。从您的代码和误解中可以明显看出您来自一些 C++ 背景。试着拿起一本关于 C 编程的书。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T14:17:29.717

枚举不是字符串。Acutally Monday=0, Tuesday=1, etc. 如果你想打印字符串，你可以这样做：

```
char *days[] = {"Monday", "Tuesday", ... "Sunday"};

printf("%s", days[k]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T14:18:31.140

在 C 中，枚举与普通类型不在同一个命名空间中。如果要定义类型为该枚举的变量，可以执行以下操作：

```
enum days dayVariable; 
```

或者，您可以为枚举定义标准类型。有很多类似的方法可以做到这一点；这是一个：

```
typedef enum {
    /* ... */
} days; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T14:23:32.287

这也不会编译：

```
dayVariable=days(k); 
```

`days`不是函数，并且在 C 中，一般类型名称（您似乎期望`days`是）也不是函数。你可能的意思是：

```
dayVariable = (enum days) k; 
```

换句话说，对正确的类型名称使用简单的强制转换。

# php - 数组中的变量名。更改它们的值 PHP

> ID：15549995
> 
> 赞同：1
> 
> 时间：2013-03-21T14:15:41.360
> 
> 标签：php

我构建了一个具有以下结构的 ListNode：

```
 class MyNode {
    private  $weight;
    private  $children;
    private  $t1;
    private  $t2;
    private  $t3;
    *** 
    more variables
    ***
    function __constructr($weight, $t1, $t2, $t3, $children = array()) {
        $this->weight = $weight;
        $this->children = $children;
        $this->t1 = $t1;
        $this->t2 = $t2;
        $this->t3 = $t3;
    } 
```

现在我创建了 5 个数据相同但权重不同的节点。

```
 $n1 = new MyNode(25, 't_1', 't_2', 't_3');
    $n2 = new MyNode(30, 't_1', 't_2', 't_3');
    $n3 = new MyNode(49, 't_1', 't_2', 't_3');
    $n4 = new MyNode(16, 't_1', 't_2', 't_3');
    $n5 = new MyNode(62, 't_1', 't_2', 't_3'); 
```

请注意，t1、t2 和 t3 可以不同，但​​对于这 5 个节点，它们是相同的。我不想做上面的事情，而是想使用某种克隆功能来做以下事情

```
 $n1 = new MyNode(25, 't_1', 't_2', 't_3');
    $n2 = $n1->clone(array('weight' => 30));
    $n3 = $n2->clone(array('weight' => 49));
    $n4 = $n4->clone(array('weight' => 16));
    $n5 = $n5->clone(array('weight' => 62)); 
```

克隆函数采用键数组作为 MyNode 中我想要更改的变量名称及其值。所以**array('weight' => 30)**应该改变**$this->weight = 30;** 我坚持从数组访问变量。它应该创建一个所有值与其当前节点相同的新节点，但只修改数组中的值。

```
 function clone($changeVariables) {
      -----
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:20:35.570

试试这个：

```
$obj = clone $this;

foreach ($changeVariables as $field => $val) {
    $obj->{$field} = $val;
}
return $obj; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T14:25:27.733

观察

*   您不能实现称为`clone`保留字的方法或函数
*   那不是如何在 php 中克隆对象
*   `__constructr``construct`在 php中设置是错误且无效的方法

这是您需要的：

```
class MyNode {
    private $weight;
    private $children;
    private $t1;
    private $t2;
    private $t3;

    function __construct($weight, $t1, $t2, $t3, $children = array()) {
        $this->weight = $weight;
        $this->children = $children;
        $this->t1 = $t1;
        $this->t2 = $t2;
        $this->t3 = $t3;
    }

    public function getClone(array $arg) {
        $t = clone $this;
        foreach ( $arg as $k => $v ) {
            $t->{$k} = $v;
        }
        return $t;
    }
}

$n1 = new MyNode(25, 't_1', 't_2', 't_3');
$n2 = $n1->getClone(array(
        'weight' => 30
));

print_r($n1);
print_r($n2); 
```

输出

```
MyNode Object
(
    [weight:MyNode:private] => 25
    [children:MyNode:private] => Array
        (
        )

    [t1:MyNode:private] => t_1
    [t2:MyNode:private] => t_2
    [t3:MyNode:private] => t_3
)
MyNode Object
(
    [weight:MyNode:private] => 30
    [children:MyNode:private] => Array
        (
        )

    [t1:MyNode:private] => t_1
    [t2:MyNode:private] => t_2
    [t3:MyNode:private] => t_3
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T14:19:07.450

[可变变量](http://php.net/manual/en/language.variables.variable.php)是一种解决方案：

```
foreach ($changeVariables as $key => $value) {
    $this->{$key} = $value;
} 
```

`$this->{$key}`您可以通过在允许设置之前检查是否存在来增强它。

[http://php.net/manual/en/language.oop5.cloning.php](http://php.net/manual/en/language.oop5.cloning.php)

总体结果将类似于：

```
function clone($changeVariables) {
    $newObj = clone $this;
    foreach ($changeVariables as $key => $value) {
        $newObj->{$key} = $value;
    }
    return $newObj;
} 
```