# StackOverflow 问答 14006000-14006999

# haskell - 在 QuickCheck 中缩小记录的惯用方法

> ID：14006005
> 
> 赞同：15
> 
> 时间：2012-12-22T19:44:52.520
> 
> 标签：haskell, quickcheck

假设我有一个记录类型：

```
data Foo = Foo {x, y, z :: Integer} 
```

编写 Arbitrary 实例的一种简洁方式使用 Control.Applicative，如下所示：

```
instance Arbitrary Foo where
   arbitrary = Foo <$> arbitrary <*> arbitrary <*> arbitrary
   shrink f = Foo <$> shrink (x f) <*> shrink (y f) <*> shrink (z f) 
```

因此， Foo 的收缩列表是其成员的所有收缩的笛卡尔积。

但是，如果其中一个收缩返回 [ ] 那么整个 Foo 将不会收缩。所以这行不通。

我可以尝试通过在收缩列表中包含原始值来保存它：

```
 shrink f = Foo <$> ((x f) : shrink (x f)) <*> ... {and so on}. 
```

但是现在shrink (Foo 0 0 0) 将返回[Foo 0 0 0]，这意味着收缩永远不会终止。所以这也行不通。

看起来这里应该使用除了 <*> 以外的其他东西，但我看不到是什么。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2017-01-30T20:07:50.657

如果你想要一个可以在一个位置收缩的应用函子，你可能会喜欢我刚刚创建的这个函数，它可以精确地刮擦那个痒：

```
data ShrinkOne a = ShrinkOne a [a]

instance Functor ShrinkOne where
    fmap f (ShrinkOne o s) = ShrinkOne (f o) (map f s)

instance Applicative ShrinkOne where
    pure x = ShrinkOne x []
    ShrinkOne f fs <*> ShrinkOne x xs = ShrinkOne (f x) (map ($x) fs ++ map f xs)

shrinkOne :: Arbitrary a => a -> ShrinkOne a
shrinkOne x = ShrinkOne x (shrink x)

unShrinkOne :: ShrinkOne t -> [t]
unShrinkOne (ShrinkOne _ xs) = xs 
```

我在看起来像这样的代码中使用它，以缩小元组的左元素或元组右元素的字段之一：

```
shrink (tss,m) = unShrinkOne $
    ((,) <$> shrinkOne tss <*> traverse shrinkOne m) 
```

到目前为止效果很好！

事实上，它工作得很好，我把它作为[一个 hackage 包](http://hackage.haskell.org/package/successors/docs/Control-Applicative-Successors.html)上传了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-22T21:05:31.317

我不知道什么会被认为是惯用的，但如果你想确保每次缩小至少减少一个字段而不增加其他字段，

```
shrink f = tail $ Foo <$> shrink' (x f) <*> shrink' (y f) <*> shrink' (z f)
  where
    shrink' a = a : shrink a 
```

会这样做。列表的`Applicative`实例使得原始值是结果列表中的第一个，因此只需删除它就会使您的值列表真正缩小，因此缩小终止。

如果你希望尽可能收缩所有字段，并且只保留不可收缩的字段，这有点复杂，你需要沟通你是否已经成功收缩，如果你没有得到任何最后，返回一个空列表。从我头顶掉下来的是

```
data Fallback a
    = Fallback a
    | Many [a]

unFall :: Fallback a -> [a]
unFall (Fallback _) = []
unFall (Many xs)    = xs

fall :: a -> [a] -> Fallback a
fall u [] = Fallback u
fall _ xs = Many xs

instance Functor Fallback where
    fmap f (Fallback u) = Fallback (f u)
    fmap f (Many xs)    = Many (map f xs)

instance Applicative Fallback where
    pure u = Many [u]
    (Fallback f) <*> (Fallback u) = Fallback (f u)
    (Fallback f) <*> (Many xs)    = Many (map f xs)
    (Many fs)    <*> (Fallback u) = Many (map ($ u) fs)
    (Many fs)    <*> (Many xs)    = Many (fs <*> xs)

instance Arbitrary Foo where
    arbitrary = Foo <$> arbitrary <*> arbitrary <*> arbitrary
    shrink f = unFall $ Foo <$> shrink' (x f) <*> shrink' (y f) <*> shrink' (z f)
      where
        shrink' a = fall a $ shrink a 
```

也许有人想出了一个更好的方法来做到这一点。

# skype - Skype API (SKYPE4COMLib)。如何阅读尚未发送的聊天消息？

> ID：14006006
> 
> 赞同：0
> 
> 时间：2012-12-22T19:44:56.133
> 
> 标签：skype, skype4com

是否可以阅读**尚未发送**的聊天消息？我想在用户写消息时向他/她展示一些提示...

提前致谢！

# linux - 使用 grep -lr 输出将文件添加到 tar

> ID：14006007
> 
> 赞同：4
> 
> 时间：2012-12-22T19:45:11.127
> 
> 标签：linux, ubuntu, grep, centos, tar

在 UBUNTU 和 CENTOS 中。

我有一些文件要根据它们的内容进行 tar。

```
$ grep -rl "123.45" . 
```

以这种格式返回大约 10 个文件的列表：

```
./somefolder/someotherfolder/somefile.txt
./anotherfolder/anotherfile.txt 
```

ETC...

我想把它们全部 tar.gz。

我试过了：

```
$ grep -rl "123.45" . | tar -czf files.tar.gz 
```

不工作。这就是我在这里的原因。有任何想法吗？谢谢。

刚刚尝试过，它在 Ubuntu 中工作，但在 CentOS 中我得到“tar：02：无法统计：没有这样的文件或目录”。

```
$ tar -czf test.tar.gz `grep -rl "123.45" .` 
```

如果其他人有更好的方法，请告诉我。至少，以上一个在 Ubuntu 中效果很好。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T20:07:52.390

像这样：

```
 ... | tar -T - -czf files.tar.gz 
```

"-T -" 使 tar 从标准输入读取文件名。第二个减号代表标准输入。——</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T19:10:52.977

```
grep -rl "123.45" . | xargs tar -czf files.tar.gz 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:07:33.950

Tar 希望被告知要处理哪些文件，而不是通过标准输入给出文件的名称。

但是它确实有一个`-T`/`--files-from`选项。所以我建议使用它。将所选文件的列表输出到临时文件，然后 tar 读取该文件，如下所示：

```
T=$(mktemp)
grep -rl "123.45" . > $T
tar cfz files.tar.gz -T $T
rm -f $T 
```

如果你愿意，你也可以使用 shell 扩展来做到这一点：

```
tar cfz files.tar.gz -- $(grep -rl "123.45" .) 
```

但是，如果您有太多文件或任何文件有奇怪的名称（如空格等），这将失败。

# javascript - jQuery 兄弟姐妹不工作？

> ID：14006008
> 
> 赞同：0
> 
> 时间：2012-12-22T19:45:17.297
> 
> 标签：javascript, jquery, html, css, responsive-design

我为响应式网站创建了一个响应式子菜单，该网站在等于或小于 768 像素时处于活动状态。我将它设置为 jQuery 删除父列表项的链接并显示子菜单 onClick 的位置。

问题是，有一个没有孩子的父母，我试图只删除有孩子的父母元素的链接（href）。但是，我什至在 If 语句中应用了它，这样如果它没有子链接，它就不会删除父链接，这是行不通的。所以我尝试了兄弟姐妹，我认为这更有意义。但它仍然不是这样。

这是我的jQuery：

```
 if (jQuery(".navigation > ul > li > a").siblings("ul")){
        jQuery(".navigation > ul > li > a").removeAttr("href");
    }; 
```

您可能会在这里看到一个示例：http: [//stlredtails.com/construction/](http://stlredtails.com/construction/)

编辑：联系链接是没有“ul”子项的链接，实用术语，没有子菜单。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:18:35.117

您的 if 语句始终返回 true 并且您的以下命令会从所有匹配的元素中删除 href 属性。您将需要遍历匹配的锚点并为每个锚点处理一个 if 语句。

```
jQuery(".navigation > ul > li > a").each( function() {
    if(jQuery(this).siblings("ul").length) {
        jQuery(this).removeAttr("href");
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:13:48.770

我不确定我是否理解您的要求，但听起来您可能需要 jQuery`:empty`和/或`:parent`选择器。

尝试类似：

```
$(".navigation > ul:parent > li > a") 
```

[jQuery：空文档](http://api.jquery.com/empty-selector/)

[jQuery：父文档](http://api.jquery.com/parent-selector/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T20:32:56.997

> jQuery 兄弟姐妹不工作？

这是工作。然而，即使它不匹配任何内容，它也总是评估为 jQuery 包装器*对象，并且该值是真实的，因此您的 if 块总是执行。*检查`.length`-property 是否为 not `0`。

> 我将它设置为 jQuery 删除父列表项的链接并显示子菜单 onClick 的位置。

There is absolutely no reason to remove the `href` attribute. To prevent following the link even if you clicked ("activated") it, call [`preventDefault()` on the event object](http://api.jquery.com/event.preventDefault/) in the `click` event handler!

# node.js - 无法使用 NodeJS (ExpressJS) 解析 XML 以进入 MongoDB

> ID：14006010
> 
> 赞同：2
> 
> 时间：2012-12-22T19:45:52.103
> 
> 标签：node.js, mongodb, express

我有一个数据源，它只能以 XML 格式而不是 JSON（MongoDB 的首选数据类型）提供给我。我有一种方法允许将 JSON 发布到 MongoDB 集合，我正在尝试修改它以处理 XML 数据。

这是我修改后的方法：

```
exports.addXMLTicket = function(req, res) {
var xml2js = require('xml2js');
var xml = req.body;

var parser = new xml2js.Parser();
    parser.parseString(xml, function (err, ticket) {
        console.log('Done parsing XML');
        console.log('Adding ticket: ' + JSON.stringify(ticket));
        db.collection('tickets', function(err, collection) {
            collection.insert(ticket, {safe:true}, function(err, result) {
                if (err) {
                    res.send({'error':'An error has occurred'});
                } else {
                    console.log('Success: ' + JSON.stringify(result[0]));
                    res.send(result[0]);
                }
            });
        });
    });
} 
```

这是 XML 数据：

```
<?xml version='1.0'?>
<instance dm:form_version='1.0' dm:submit_time='2012-04-02 12:33:26 UTC' dm:submitting_user='Dusan Babich' writeTime='2011-04-26T15:23:11.506' dm:form='A First Form' dm:submitting_device='iPhone_d6e2542effafbcc8d0e6bf0ef2917b76dea4faf8' xmlns:dm='http://mobileforms.devicemagic.com/xforms' xmlns='http://www.devicemagic.com/xforms/demo/2d3698c0-650c-012e-7e8e-12313b079c72'>
  <untitled_form_1>
    <quality_of_day>{{VALUE}}</quality_of_day>
    <inbox_overflow>{{VALUE}}</inbox_overflow>
    <next_holiday>{{VALUE}}</next_holiday>
    <comments>{{VALUE}}</comments>
  </untitled_form_1>
</instance> 
```

最后是我的 CURL 请求：

```
curl -i -X POST -H "Content-Type: text/xml" -d "<?xml version='1.0'?><instance dm:form_version='1.0' dm:submit_time='2012-04-02 12:33:26 UTC' dm:submitting_user='Dusan Babich' writeTime='2011-04-26T15:23:11.506' dm:form='A First Form' dm:submitting_device='iPhone_d6e2542effafbcc8d0e6bf0ef2917b76dea4faf8' xmlns:dm='http://mobileforms.testdomain.com/xforms' xmlns='http://www.testdomain.com/xforms/demo/2d3698c0-650c-012e-7e8e-12313b079c72'><untitled_form_1><quality_of_day>test</quality_of_day><inbox_overflow>test</inbox_overflow><next_holiday>test</next_holiday><comments>test</comments></untitled_form_1>" http://127.0.0.1:3000/ticketsxml 
```

我得到的错误是“TypeError：无法读取未定义的属性'_id'”，这似乎正在发生，因为它没有从 POST 获取正文。但是，当我以 JSON 格式发布时，它工作得很好。

任何建议将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T12:49:31.670

查看 xmlParser 中间件： [https ://github.com/brandid/express-xmlBodyParser](https://github.com/brandid/express-xmlBodyParser)

# javascript - 将 eval 与 `with` 一起使用

> ID：14006016
> 
> 赞同：1
> 
> 时间：2012-12-22T19:46:39.370
> 
> 标签：javascript

我知道`eval`并且`with`通常会气馁，但暂时搁置这一点，我无法让这段代码正常工作：

```
with({ a: 'hello world' }){
    var output = eval('{ text: a }')
} 
```

我期待`output`成为**对象**：

```
{ text: "hello world" } 
```

而是`output`字符串 'hello world **'**

有人可以帮我看看我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:48:45.917

你需要在它周围加上括号：

```
 var output = eval('({ text: a })') 
```

参见例如[为什么 JavaScript 的 eval 需要括号来评估 JSON 数据？](https://stackoverflow.com/questions/964397/why-does-javascripts-eval-need-parentheses-to-eval-json-data)

# php - 更改 PHP 数组

> ID：14006017
> 
> 赞同：0
> 
> 时间：2012-12-22T19:46:45.967
> 
> 标签：php, arrays, foreach

嗨，我已经建立了一个数组，并在完成脚本的最后过程中。

我一直在构建一个网络爬虫，它扫描指定站点上的特定链接。爬虫将所有链接存储在一个页面中，然后将它们插入到另一个数组（news_stories）中，其中包含指定的链接。

现在新数组的结构方式是这样的。

```
 Array
 (
    [0] => Array
    (
        [title] =>  The Qlick 
        [description] => Qlick
        [keywords] => Search Engine, Web, Sexy, Noah Smith
        [link] => http://www.theqlick.com/qlickdates.php
    )
  ) 
```

这对我来说很难内爆并插入到 mysql 表中。现在我下面的代码使用函数来获取它找到的每个链接的标题、描述等，然后如果它们匹配则将它们插入到新数组中。

无论如何要让这个删除数组顶部的 Array() 并只拥有指定标题、描述等的数组。我希望输出看起来像：

```
 [0] => Array
    (
        [title] =>  The Qlick 
        [description] => Qlick
        [keywords] => Search Engine, Web, Sexy, Noah Smith
        [link] => http://www.theqlick.com/qlickdates.php
    ) 
```

有任何想法吗？

```
 $bbc_values = array('http://www.theqlick.com/festivalfreaks.php', 'http://www.theqlick.com/qlickdates.php');

  $news_stories = array();
  foreach ($links as $link) {
      $item = array(
        "title"       => Titles($link), 
        "description" => getMetas($link),
        "keywords" => getKeywords($link), 
        "link"        => $link                 
       );

      if (empty($item["description"])) {
          $item["description"] = getWord($link);
      }

      foreach($bbc_values as $bbc_value) {
          // note the '===' . this is important
          if(strpos($item['link'], $bbc_value) === 0) {
              $news_stories[] = $item;
          }
      }
   }

   $data = '"' . implode('" , "', $news_stories) . '"';
   $query = 
   //CNN algorithm
   print_r($news_stories); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T20:13:51.257

PHP *foreach()*是一个迭代器，旨在让您的编程对数据集合执行相同的操作。在现有设计中，*$news_stories* 数组可以包含多个单独的“子数组”，每个这样的“子数组”都是您要插入数据库的数据单元。

当您深入了解创建查询的部分时，您可以使用以下内容：

```
foreach ($news_stories as $story)
{
    /* CREATE AND RUN QUERY USING DATA IN $story */
} 
```

您可以使用 *var_dump()* 查看*$story*数组的内容。当你这样做时，它可能会立即变得有意义。PHP *foreach()*不关心你有一个元素还是一百个元素。如果您有零个元素，它将不会运行控制结构内的代码。

# ruby - 在 ruby 方法中使用问号

> ID：14006019
> 
> 赞同：5
> 
> 时间：2012-12-22T19:46:58.080
> 
> 标签：ruby, syntax, methods

假设我有课`Player`，我想要一个布尔方法来检查玩家是否受到攻击：

```
class Player
  attr_accessor :name, :health, :attacked?

  def initialize(name)
    @name = name
    @health = 100
    @attacked? = false
  end
end 
```

我收到语法错误：

```
SyntaxError: (irb):14: syntax error, unexpected '='
@attacked? = false
            ^
        from /usr/bin/irb:12:in `<main>' 
```

从解决问题中删除问号`attacked`，但我认为它会更好地遵循`attacked?`我的代码中的约定。放弃问号并不是什么大不了的事，但为什么`zero?`和`nil?`约定何时`@variables?`和`def methods?=`无效？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-22T20:37:26.690

请注意，如果您注释掉导致错误 ( `@attacked? = false`) 的行，您仍然会收到与问号相关的错误：

```
NameError: invalid attribute name `attacked?' 
```

问题是这`?`不是变量名中的有效字符。第一个错误（`SyntaxError`您所看到的）是在解析时引起的并立即被捕获。第二个错误是当 Ruby 尝试评估代码并且无法创建名称包含无效字符的实例变量时引起的。

问号*是**方法*名称末尾的有效字符（实际上可以有一个`?`名称中包含任何位置的方法，但您不能直接调用这样的方法）。

实现您想要的一种方法是这样的：

```
class Player
  attr_accessor :name, :health, :attacked
  alias :attacked? :attacked

  def initialize(name)
    @name = name
    @health = 100
    @attacked = false
  end
end 
```

这`attacked`没有问号，但`attacked?`作为别名添加。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T20:06:50.057

我以前遇到过同样的问题，希望我可以用一个尾随问号创建实例变量。这似乎是 Ruby 语法中的一个极端案例。看一下这个：

```
>> 1 ? 2 : 3
=> 2
>> 1?2:3
=> 2
>> @a = true
=> true
>> @a?1:2
=> 1
>> a = true
=> true
>> a ? 1 : 2
=> 1
>> a?1:2
SyntaxError: (irb):9: syntax error, unexpected ':', expecting $end 
```

因此，`?`符号在 Ruby 语法中被重载——它用于三元运算符，*并*作为方法名称的有效标识符的一部分。`a?`这在最后一种情况下会导致歧义，其中 Ruby 的词法分析器似乎将 t作为单个标记咬掉了，这使其无法正确解析三元运算符的其余部分。使用实例变量，这不会发生。

同样，我同意在实例变量名称中允许使用问号将非常有用，当然比使三元运算符的一些晦涩使用明确更有价值。

# xcode - 删除了分支上的文件，防止 git checkout

> ID：14006021
> 
> 赞同：0
> 
> 时间：2012-12-22T19:47:13.143
> 
> 标签：xcode, git, version-control, merge

在我的项目中，我有 3 个分支：-master-dev-sync

我已经同步完成了一堆工作，并且在此过程中的某个地方厌倦了提交 xcode 项目文件，我更改了我的 gitignore 以排除它们，停止跟踪它们并删除它们。这很好，但现在我想将同步时的更改合并回 dev。

每次我尝试结帐 dev 以合并时，我都会收到错误消息：

```
error: The following untracked working tree files would be overwritten by checkout:
ManagePlaces/ManagePlaces.xcodeproj/project.xcworkspace/xcuserdata/Aidy.xcuserdatad/UserInterfaceState.xcuserstate
ManagePlaces/ManagePlaces.xcodeproj/project.xcworkspace/xcuserdata/Aidy.xcuserdatad/xcdebugger/Expressions.xcexplist
ManagePlaces/ManagePlaces.xcodeproj/xcuserdata/Aidy.xcuserdatad/xcdebugger/Breakpoints.xcbkptlist
ManagePlaces/ManagePlaces.xcodeproj/xcuserdata/Aidy.xcuserdatad/xcschemes/ManagePlaces.xcscheme
ManagePlaces/ManagePlaces.xcodeproj/xcuserdata/Aidy.xcuserdatad/xcschemes/xcschememanagement.plist 
```

请先移动或移除它们，然后才能切换分支。

我理解为什么会发生这种情况，因为 dev 分支没有删除这些文件并且仍在跟踪它们，但我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:52:28.880

只需添加`--force`到您的结帐命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:50:09.787

我相信你可以做到这一点：

```
git checkout -- <file> 
```

这应该将它们重置为最后一次提交。

# jpa - 多对一的 Sql jpa 查询

> ID：14006022
> 
> 赞同：0
> 
> 时间：2012-12-22T19:47:15.493
> 
> 标签：jpa, nullpointerexception, ejb, isqlquery

> 对不起我的英语不好，可能是个坏问题。我有这个：

实体

```
 @Entity
                    @Table(name = "Books")
                    @NamedQueries({
                        @NamedQuery(name = "BooksEntity.findAll", query = "SELECT u FROM BooksEntity u"),      
                        @NamedQuery(name = "BooksEntity.findByBookId", query = "SELECT u FROM BooksEntity u WHERE u.book_id = :book_id"),
                        @NamedQuery(name = "BooksEntity.findByTitle", query = "SELECT u FROM BooksEntity u WHERE u.title = :title")})
                    public class BooksEntity implements Serializable {
                        private static final long serialVersionUID = 1L;
                        @Id
                        @Column(name = "book_id",unique=true, nullable=false)
                        @GeneratedValue(strategy = GenerationType.TABLE)
                        private Long book_id;

                        @ManyToOne
                        @JoinColumn(name = "author", nullable=true)
                        private AuthorsEntity author;

                        @OneToMany (mappedBy="book")
                        private List<UsersEntity> users;
                        //set and get
                    }

                @Entity
                @Table(name = "Users")
                @NamedQueries({
                    @NamedQuery(name = "UsersEntity.findAll", query = "SELECT u FROM UsersEntity u"),    
                    @NamedQuery(name = "UsersEntity.findByUserId", query = "SELECT u FROM UsersEntity u WHERE u.user_id = :user_id"),
                    @NamedQuery(name = "UsersEntity.findByUserIdAndPassword", query = "SELECT u FROM UsersEntity u WHERE u.user_id = :user_id AND u.password = :password"),
                    @NamedQuery(name = "UsersEntity.findByName", query = "SELECT u FROM UsersEntity u WHERE u.name = :name"),
                    @NamedQuery(name = "UsersEntity.findByNameAndPassword", query = "SELECT u FROM UsersEntity u WHERE u.name = :name AND u.password = :password"),
                    @NamedQuery(name = "UsersEntity.findByEmail", query = "SELECT u FROM UsersEntity u WHERE u.email = :email")})
                public class UsersEntity implements Serializable {

                    private static final long serialVersionUID = 1L;
                    @Id
                    @Column(name = "user_id", unique=true, nullable=false)
                    @GeneratedValue(strategy = GenerationType.TABLE)
                    private Long user_id;

                    @Column(name = "name", nullable = false, unique = true)
                    private String name;   

                    @ManyToOne 
                    @JoinColumn(name = "book")
                    private BooksEntity book;
                } 
```

和经理

```
 @Stateless
                public class BookManager implements BookManagerLocal {

                    @PersistenceContext
                    EntityManager em;
                    @EJB
                    UserManagerLocal um;

             @Override
                public List<BooksEntity> getAllBooks() {
                    List<BooksEntity> books = em.createNamedQuery("BooksEntity.findAll").getResultList();
                    if (!books.isEmpty()) {
                        return books;
                    } else {
                        return null;
                    }
                }

                 @Override
                    public List<BooksEntity> getAllBooksUser(String name) {
                    List<UsersEntity> users;
                        List<BooksEntity> books = this.getAllBooks();
                        if (books.isEmpty()) {
                            return null;
                        } else {
                            List<BooksEntity> userbooks = new ArrayList<BooksEntity>();

                            for (BooksEntity book : books) {
                                users = book.getUsers();
                                for (UsersEntity user : users) {
                                    if (name.equals(user.getName())) {
                                        userbooks.add(book);
                                    }
                                }
                            }

                            if (!userbooks.isEmpty()) {
                                return userbooks;
                            } else {
                                return null;
                            }
                        }
                    }
                } 
```

> 我需要一个用户的所有书籍。但我有问题。我这样做

```
 @Override
        public List<BooksEntity> getAllBooks() {
            List<BooksEntity> books = em.createNamedQuery("BooksEntity.findAll").getResultList();
            if (!books.isEmpty()) {
                return books;
            } else {
                return null;
            }
        }

    @Override
        public List<BooksEntity> getAllBooksUser(String name) {
        List<UsersEntity> users;
            List<BooksEntity> books = this.getAllBooks();
            if (books.isEmpty()) {
                return null;
            } else {
                List<BooksEntity> userbooks = new ArrayList<BooksEntity>();

                for (BooksEntity book : books) {
                    users = book.getUsers();
                    for (UsersEntity user : users) {
                        if (name.equals(user.getName())) {
                            userbooks.add(book);
                        }
                    }
                }

                if (!userbooks.isEmpty()) {
                    return userbooks;
                } else {
                    return null;
                }
            }
        } 
```

> 但它不起作用。我有 ejbexception 和 nullpointexception。

```
 WARNING: EJB5184:A system exception occurred during an invocation on EJB BookManager, method: public java.util.List book.ejb.BookManager.getAllBooksUser(java.lang.String)
    WARNING: javax.ejb.EJBException
        at com.sun.ejb.containers.BaseContainer.processSystemException(BaseContainer.java:5215)
        at com.sun.ejb.containers.BaseContainer.completeNewTx(BaseContainer.java:5113)
        at com.sun.ejb.containers.BaseContainer.postInvokeTx(BaseContainer.java:4901)
        at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:2045)
        at com.sun.ejb.containers.BaseContainer.postInvoke(BaseContainer.java:1994)
        at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:222)
        at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:89)
        at $Proxy230.getAllBooksUser(Unknown Source)
        at book.bean.BookEditBean.getUserBooks(BookEditBean.java:52)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at javax.el.BeanELResolver.getValue(BeanELResolver.java:363)
        at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176)
        at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203)
        at com.sun.el.parser.AstValue.getValue(AstValue.java:138)
        at com.sun.el.parser.AstValue.getValue(AstValue.java:183)
        at com.sun.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:224)
        at org.jboss.weld.el.WeldValueExpression.getValue(WeldValueExpression.java:50)
        at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:109)
        at com.sun.faces.facelets.component.UIRepeat.getValue(UIRepeat.java:273)
        at com.sun.faces.facelets.component.UIRepeat.getDataModel(UIRepeat.java:249)
        at com.sun.faces.facelets.component.UIRepeat.setIndex(UIRepeat.java:443)
        at com.sun.faces.facelets.component.UIRepeat.process(UIRepeat.java:482)
        at com.sun.faces.facelets.component.UIRepeat.encodeChildren(UIRepeat.java:984)
        at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1757)
        at javax.faces.render.Renderer.encodeChildren(Renderer.java:168)
        at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845)
        at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1757)
        at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760)
        at javax.faces.render.Renderer.encodeChildren(Renderer.java:168)
        at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845)
        at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1757)
        at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760)
        at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760)
        at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:402)
        at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131)
        at javax.faces.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:288)
        at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)
        at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
        at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
        at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
        at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
        at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
        at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
        at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
        at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
        at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
        at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
        at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
        at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
        at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
        at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
        at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
        at java.lang.Thread.run(Thread.java:722)
    Caused by: java.lang.NullPointerException
        at book.ejb.BookManager.getAllBooksUser(BookManager.java:87)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.glassfish.ejb.security.application.EJBSecurityManager.runMethod(EJBSecurityManager.java:1052)
        at org.glassfish.ejb.security.application.EJBSecurityManager.invoke(EJBSecurityManager.java:1124)
        at com.sun.ejb.containers.BaseContainer.invokeBeanMethod(BaseContainer.java:5388)
        at com.sun.ejb.EjbInvocation.invokeBeanMethod(EjbInvocation.java:619)
        at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
        at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
        at org.jboss.weld.ejb.SessionBeanInterceptor.aroundInvoke(SessionBeanInterceptor.java:42)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
        at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
        at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
        at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doAround(SystemInterceptorProxy.java:162)
        at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.aroundInvoke(SystemInterceptorProxy.java:144)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
        at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
        at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:370)
        at com.sun.ejb.containers.BaseContainer.__intercept(BaseContainer.java:5360)
        at com.sun.ejb.containers.BaseContainer.intercept(BaseContainer.java:5348)
        at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:214)
        ... 61 more 
```

> 你能帮助我吗？谢谢大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:19:17.893

您正在使用一种不好的做法，并且通过使用它，您会受到直接影响。返回列表（或任何类型的集合）的方法永远不应返回 null。如果没有可返回的内容，它应该返回一个空列表。通过返回 null，你强制每个调用者，包括你自己，在使用返回的列表之前总是检查 null，而你没有这样做：

```
List<BooksEntity> books = this.getAllBooks();
if (books.isEmpty()) {
    return null;
} 
```

在上面的代码中，`books`在调用`isEmpty()`. 并且由于`getAllBooks()`在没有找到书的情况下返回 null 而不是空列表，因此您会收到 NullPointerException。

以下是我将如何重写您的代码：

```
@Override
public List<BooksEntity> getAllBooks() {
    return em.createNamedQuery("BooksEntity.findAll").getResultList();
}

@Override
public List<BooksEntity> getAllBooksUser(String name) {
    List<BooksEntity> books = this.getAllBooks();
    List<BooksEntity> userbooks = new ArrayList<BooksEntity>();
    for (BooksEntity book : books) {
        users = book.getUsers();
        for (UsersEntity user : users) {
            if (name.equals(user.getName())) {
                userbooks.add(book);
            }
        }
    }
    return userBooks;
} 
```

请注意代码如何更短，以及它如何不存在引发 NullPointerException 的风险。

也就是说，您为给定用户名查找书籍的方法效率极低：您正在加载每一本书（想象用一个真实的图书馆这样做），并且对于每本书，您正在加载它的所有用户。

查找具有给定名称的所有用户（`findByName`例如，使用命名查询）并返回他们的书会更有效。或者更好的是，在单个 JPQL 查询中完成所有这些操作：

```
select book from UsersEntity user
inner join user.book book
where user.name = :name 
```

该方法将如下所示：

```
public List<BooksEntity> getAllBooksUser(String name) {
    String jpql = 
        "select book from UsersEntity user"
        + " inner join user.book book"
        + " where user.name = :name";
    return em.createTypedQuery(jpql, BooksEntity.class)
             .setParameter("name", name)
             .getResultList();
} 
```

最后，如果您将实体命名为`Book`and`User`而不是`BooksEntity`and ，您的代码将更具可读性`UsersEntity`。对单个用户或书籍使用复数形式是一个非常糟糕的主意。而且`Entity`后缀是烦人的噪音。

# java - Java同步对象，等待和通知

> ID：14006023
> 
> 赞同：1
> 
> 时间：2012-12-22T19:47:19.433
> 
> 标签：java, synchronized

我有一个掷骰子的程序，并使用一个新线程循环以更新图像并重新绘制。这是我的代码：

```
public int roll()
{
  new Thread(
    new Runnable() {
      public void run() {
        synchronized(o) {
          o.notify();
          for (int i = 0; i < 10; i++) {
            image = randomImage();
            repaint();
            try {
              Thread.sleep(100);
            }
            catch(InterruptedException ex) {
              System.out.println("InterruptedException caught");
            }
          }
        }
      }
    }
  ).start();

  synchronized(o) {
    try {
      o.wait();
    }
    catch(InterruptedException ex) {
      System.out.println("InterruptedException caught");
    }
  }
  return rolled;
} 
```

在我的另一堂课上，我有：

```
int rolled = dicePanel.roll();
label.setText("Rolled a + rolled"); 
```

问题是当前代码与同步，骰子图像不动画，但返回正确的 int 滚动。如果没有同步代码，图像将动画，但 roll 方法将返回 0 作为 int，因为它不会让其他线程完成。

有没有办法让图像代码每次循环并重新绘制，但要等到线程完成返回 int 滚动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:59:05.697

将 放在方法`o.notify();`的末尾`run()`。顺便提一句。使用`notifyAll()`应该是首选。或者您可能会发现[Future](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Future.html)对象模式很有用。这是一篇关于它的文章[http://www.vogella.com/articles/JavaConcurrency/article.html](http://www.vogella.com/articles/JavaConcurrency/article.html)

或者，如果您正在开发 Swing 应用程序，请查看[SwingWorker](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)。但是，对于这项任务，SwingWorker 可能是矫枉过正。

Wait¬ify 是相当低级的 api，Java 中有许多很好的抽象来处理并发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:02:10.677

这看起来像是一个过于复杂的解决方案。[您当然应该在EDT](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)以外的线程中执行您的掷骰子/图像更新，但您不需要将该任务拆分为两个单独的线程。

只需有一个线程来处理您的骰子图像，然后当它完成时，它可以在您的标签中设置所选的骰子值（并且可能也在您的图像中）。

# html - Webform 缺少底部

> ID：14006027
> 
> 赞同：0
> 
> 时间：2012-12-22T19:47:50.707
> 
> 标签：html, css, webforms

我试图在我的网站底部放置一个联系表格，但表格的底部被切掉了。你可以在这里看到一个小提琴：

[http://jsfiddle.net/qKnzp/](http://jsfiddle.net/qKnzp/)

网络表单的代码如下：

**CSS**

```
div.box{
margin:0 auto;
width:500px;
background:#222;
position:relative;
top:50px;
border:1px solid #262626;
}

div.box h1{ 
color:#FFF5CC;
font-size:18px;
text-transform:uppercase;
padding:5px 0 5px 5px;
border-bottom:1px solid #161712;
border-top:1px solid #161712; 
}

div.box label{
width:100%;
display: block;
background:#1C1C1C;
border-top:1px solid #262626;
border-bottom:1px solid #161712;
padding:10px 0 10px 0;
}
div.box label span{
display: block;
color:#bbb;
font-size:12px;
float:left;
width:100px;
text-align:right;
padding:5px 20px 0 0;
}

div.box .input_text{
padding:10px 10px;
width:200px;
background:#262626;
border-bottom: 1px double #171717;
border-top: 1px double #171717;
border-left:1px double #333;
border-right:1px double #333;
}

div.box .message{
padding:7px 7px;
width:350px;
background:#262626;
border-bottom: 1px double #171717;
border-top: 1px double #171717;
border-left:1px double #333;
border-right:1px double #333;
overflow:hidden;
height:150px;
}

div.box .button
{
margin:0 0 10px 0;
padding:4px 7px;
background:#CC0000;
border:0px;
position: relative;
top:10px;
left:382px;
width:100px;
border-bottom: 1px double #660000;
border-top: 1px double #660000;
border-left:1px double #FF0033;
border-right:1px double #FF0033;
}​ 
```

**HTML**

```
<form name="htmlform" method="post" action="html_form_send.php">
      <div class="box">
           <h1>Contact Form</h1>
                    <label>
                        <span>Full name *</span>
                        <input type="text" class="input_text" name="name" id="name"
                        />
                    </label>
                    <label>
                        <span>Email *</span>
                        <input type="text" class="input_text" name="email" id="email"
                        />
                    </label>
                    <label>
                        <span>Description of the product wanted *</span>
                        <input type="text" class="input_text"
                        name="subject" id="subject" />
                    </label>
                    <label>
                        <span>Estimated Quantity *</span>
                        <input type="text" class="input_text" name="quantity"
                        id="quantity" />
                        <input type="submit" class="button" value="Submit Form" />
                    </label>
                </div> 
```

表格应如下所示：

[http://aceinfowayindia.com/blog/wp-content/uploads/2009/06/how-to-create-good-looking-form-without-table.html](http://aceinfowayindia.com/blog/wp-content/uploads/2009/06/how-to-create-good-looking-form-without-table.html)

请任何人解释为什么缺少底部以及为什么表单标题的样式与应有的样式不同。

任何帮助深表感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T20:10:34.400

```
#wrapper { 
```

~~溢出：隐藏；~~

```
} 
```

一般来说，代码写得不好。学习如何编写好的 html 和 css。

# python - 良好实践：在 Django 应用程序中组织 views.py

> ID：14006028
> 
> 赞同：13
> 
> 时间：2012-12-22T19:47:52.827
> 
> 标签：python, django, views, models

我正在学习 Django。我的背景来自 PHP 和 Java，具有使用 Model View Controller 框架的经验。我的每个视图、模型和模板一直都有一个单独的文件——但 Django 教程只提到有一个 views.py 和 models.py。

如果您有一个小型应用程序，这似乎没问题——如果您想按目的组织视图和模型怎么办？例如，项目视图和里程碑视图。我希望您不必为每个视图模块创建另一个 Python 包（应用程序）：

`python manage.py startapp projects`

`python manage.py startapp milestones`

我可以假设您的视图和模型可以有一个里程碑.py 和一个项目.py，而不是通用的 views.py 和 models.py？然后模型可以在必要的地方导入视图，并将请求路由到特定视图？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-22T20:07:07.767

拥有多个包含视图和模型的文件没有问题。

事实上，你所需要的只是 module`views`和 module `models`。在 python 中，模块要么是文件结尾，`.py`要么是包含文件的文件夹`__init__.py`。

该应用程序可能类似于：

```
app_folder
    - views
    |    - __init__.py
    |    - some_view.py
    |    - some_other_view.py
    - models
    |    - __init__.py
    |    - some_model.py
    |    - some_other_model.py 
```

`models/__init__.py`应该看起来类似于下面的代码（用于 django 查找的子模块）。

```
from some_model import SomeModel
from some_other_model import SomeOtherModel 
```

与常用方法的唯一区别是`app_label`在模型中定义：

```
class SomeModel(models.Model):
    class Meta:
        app_label = 'app_folder' 
```

查看相关的[文档条目](https://docs.djangoproject.com/en/dev/ref/models/options/#app-label)。

**更新：**

开发版本文档说，从 1.7 版本开始，您不必再`app_label`在这种情况下进行定义。

**后记：**

事实上，如果您需要这样做，通常意味着您的应用程序太大，您应该将其拆分为多个应用程序。大多数来 django 的人都害怕拥有许多小应用程序。您阅读的第三方应用程序越多，您就越意识到应用程序应该解决一个且只有一个问题。在您的示例中，应用程序`milestones`似乎完全合法。

# javascript - jQuery Mobile：AJAX 内容加载后的 UI 重新设计

> ID：14006030
> 
> 赞同：1
> 
> 时间：2012-12-22T19:47:59.240
> 
> 标签：javascript, jquery, html, css, jquery-mobile

我需要将 JQM 应用于通过 AJAX 加载的一些标记。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T19:53:59.500

可以办到。每个 jQM 元素都有自己的用于重新设置样式的刷新方法。

例如：

*   Listview 有一个：

    ```
    $('#listviewID').listview('refresh'); 
    ```

她的例子：http: [//jsfiddle.net/Gajotres/AzXdT/](http://jsfiddle.net/Gajotres/AzXdT/)。这是一个从 XML 数据动态生成的列表视图。

*   按钮元素有：

    ```
    $('#buttonID').button('refresh'); 
    ```

这是一个例子：http: [//jsfiddle.net/Gajotres/K8nMX/](http://jsfiddle.net/Gajotres/K8nMX/)

*   滑块有：

    ```
    $('#sliderID').slider('refresh') 
    ```

*   选择菜单有：

    ```
    $('select').selectmenu('refresh', true); 
    ```

现在你可以在这里看到一个模式。要刷新始终使用组件名称作为带有“刷新”参数的函数。

如果您要重新设计整个页面，您应该使用此[方法](http://jquerymobiledictionary.pl/faq.html)。

m8 祝你圣诞快乐。:)

# google-analytics - 谷歌分析如何获得新访客

> ID：14006031
> 
> 赞同：-1
> 
> 时间：2012-12-22T19:48:01.220
> 
> 标签：google-analytics

我想知道我是删除我的 cookie 还是更改浏览器 google anlytics 会显示 +1 访问者，还是我也必须更改 ip？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T11:08:20.510

GA 访问者基于 cookie，而不是 IP。

# java - 需要有关 JComboBox 上 itemStateChanged 的 帮助

> ID：14006032
> 
> 赞同：0
> 
> 时间：2012-12-22T19:48:03.700
> 
> 标签：java, swing, jcombobox

我有三个 JComboBox，一个用于大洲，一个用于国家，另一个用于城市。所有数据都是从数据库加载的。

第一个 JComboBox 遍布各大洲。当我选择其中一个时，第二个 JComboBox 会加载相应的国家/地区。直到现在才有效，因为我添加了一个“itemStateChanged”。

但是，当我选择一个国家/地区时，会再次调用事件“itemStateChanged”。是什么让我的第二个组合框保持选中的第一个项目，或者（如果我执行“RemoveAllItems”）重复其内容？

有没有办法为每个 JComboBox 创建一个“itemStateChanged”？那种.NET，可以为每个组合框创建一个“SelectedIndexChanged”？

我的代码的某些部分：

```
public class MainFrame extends JFrame implements ItemListener 
{
…
private String iddistrito="VAZIO!!!";
private String idmunicipio="VAZIO!!!"; 
private boolean limpa=false;
private boolean populardistritos=false;
private boolean popularmunicipios=false;
private JComboBox cbFreguesiacliente = new JComboBox();
private JComboBox cbmunicipiocliente = new JComboBox();
private JComboBox cbdistritocliente = new JComboBox();
…
private void jbInit() throws Exception {
…
cbmunicipiocliente.addItemListener(this);
cbdistritocliente.addItemListener(this);     
…
} 
```

这部分代码是我单击按钮时的内容，以启用我的组件：

```
private void btnNovocliente_actionPerformed(ActionEvent e) {
    populardistritos = true;
    cbdistritocliente.removeAllItems();
    preenchecbdistritos();
    populardistritos = false;
} 
```

这段代码填充了第一个 JComboBox 的内容：

```
private void preenchecbdistritos(){
        query = "select Distrito from distritos;";
        try{
            Class.forName(JDBC_DRIVER);
            connection = DriverManager.getConnection(DATABASE_URL);
            statement = connection.createStatement();
            ResultSet resultset = statement.executeQuery(query);
            StringBuffer results = new StringBuffer();
            ResultSetMetaData metaData = resultset.getMetaData();
            int numberOfColumns = metaData.getColumnCount();
            cbdistritocliente.addItem("");
            while (resultset.next()) {
                for (int i =1; i<= numberOfColumns; i++) {
                    if (metaData.getColumnName(i).equals("Distrito")) {
                        cbdistritocliente.addItem(resultset.getObject(i).toString());
                    }
                }
            }
        } catch (ClassNotFoundException e) {
            JOptionPane.showMessageDialog(this,"rebentou no 1º catch " + e.toString(),"Inane error", JOptionPane.ERROR_MESSAGE);
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(this,"rebentou no 2º catch " + e.toString(),"Inane error", JOptionPane.ERROR_MESSAGE);
        }
} 
```

这是著名的事件，它想为每个 JComboBox 单独获取：

```
public void itemStateChanged(ItemEvent e) {
    if (populardistritos == false) {
        if (limpa == false) {
            if ((!cbdistritocliente.getSelectedItem().toString().equals("")) && (idmunicipio.equals("VAZIO!!!")))
            {
                query = "select id_distrito from distritos where distrito = '" + cbdistritocliente.getSelectedItem().toString() + "';";
                try{
                    Class.forName(JDBC_DRIVER);
                    connection = DriverManager.getConnection(DATABASE_URL);
                    statement = connection.createStatement();
                    ResultSet resultset = statement.executeQuery(query);
                    StringBuffer results = new StringBuffer();
                    ResultSetMetaData metaData = resultset.getMetaData();
                    int numberOfColumns = metaData.getColumnCount();
                    while (resultset.next()) {
                        for (int i =1; i<= numberOfColumns; i++) {
                            if (metaData.getColumnName(i).equals("id_distrito")) {
                                iddistrito = resultset.getObject(i).toString();
                            }
                        }
                    }
                        preenchecbmunicipios();    
                } catch (ClassNotFoundException e2) {
                } catch (SQLException e2) {
                }
            }
        }

        if (!cbmunicipiocliente.getSelectedItem().toString().equals(""))
        {
            query = "select id_municipio from municipios where municipio = '" + cbmunicipiocliente.getSelectedItem().toString() + "';";
            try{
                Class.forName(JDBC_DRIVER);
                connection = DriverManager.getConnection(DATABASE_URL);
                statement = connection.createStatement();
                ResultSet resultset = statement.executeQuery(query);
                StringBuffer results = new StringBuffer();
                ResultSetMetaData metaData = resultset.getMetaData();
                int numberOfColumns = metaData.getColumnCount();
                while (resultset.next()) {
                    for (int i =1; i<= numberOfColumns; i++) {
                        if (metaData.getColumnName(i).equals("id_municipio")) {
                            idmunicipio = resultset.getObject(i).toString();
                        }
                    }
                }
            } catch (ClassNotFoundException e2) {
            } catch (SQLException e2) {
            }
        }            
    }
} 
```

这段代码填充了第二个 JComboBox 的内容：

```
private void preenchecbmunicipios(){
    if (!iddistrito.equals("VAZIO!!!")) {
        query = "select municipio from municipios where municipios.id_distrito = " + iddistrito + ";";
        populardistritos=true;
        //cbmunicipiocliente.removeAllItems();
        try{
            Class.forName(JDBC_DRIVER);
            connection = DriverManager.getConnection(DATABASE_URL);
            statement = connection.createStatement();
            ResultSet resultset = statement.executeQuery(query);
            StringBuffer results = new StringBuffer();
            ResultSetMetaData metaData = resultset.getMetaData();
            int numberOfColumns = metaData.getColumnCount();
            cbmunicipiocliente.addItem("");
            while (resultset.next()) {
                for (int i =1; i<= numberOfColumns; i++) {
                    if (metaData.getColumnName(i).equals("municipio")) {
                        cbmunicipiocliente.addItem(resultset.getObject(i).toString());
                    }
                }
            }
            populardistritos=false;
        } catch (ClassNotFoundException e) {
            JOptionPane.showMessageDialog(this,"rebentou no 1º catch do cbmunicipio com " + e.toString(),"Inane error", JOptionPane.ERROR_MESSAGE);
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(this,"rebentou no 2º catch do cbmunicipio com " + e.toString(),"Inane error", JOptionPane.ERROR_MESSAGE);
        }            
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:10:43.397

[文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/event/ItemEvent.html)告诉您该事件包含有关发起人的信息。所以只需检查 e.getItemSelectable().equals(firstSelectBox) 等。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T22:13:20.943

您也许可以利用[此处](https://stackoverflow.com/a/3191882/230513)显示的方法，其中第一个组合中的选择替换第二个组合中的模型。在该示例中，`combo1`将包含大陆，并且`combo2`模型将设置为包含所选大陆上的国家/地区的模型。该示例使用数组，但 a`List<ComboBoxModel<String>>`可能是更灵活的选择。

# click - Jquery点击事件不起作用

> ID：14006040
> 
> 赞同：1
> 
> 时间：2012-12-22T19:49:04.137
> 
> 标签：click, jquery

当我单击 test2 的 test1 时没有结果

```
<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>

    <script type="text/javascript">
    $(".trigger").click(function(event){
        console.log("d");
    });
    </script>
</head>
<body>
    <a href="#" class="trigger">Test1</a>
    <a href="javascript:void(0)" class="trigger" >Test2</a>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T19:50:31.553

您需要将事件注册放在[**document.ready()**](http://api.jquery.com/ready/)中，以便您尝试绑定事件的元素准备好到您的脚本中。

```
$(document).ready(function(){

  $(".trigger").click(function(event){
        console.log("d");
    });

}); 
```

# node.js - 网络硬件上空闲 TCP 连接的开销是多少？

> ID：14006043
> 
> 赞同：-1
> 
> 时间：2012-12-22T19:49:28.773
> 
> 标签：node.js, networking, tcp, routing

所有新的事件服务器框架都有关于单个服务器上一次打开连接数的非常棒的基准。但是服务器和客户端之间的其他硬件呢？所有数据包是否与硬件相同（tcp、udp），或者空闲 TCP 连接是否以任何可测量的方式占用更多资源（数据包大小除外）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:24:38.923

任何进行状态数据包检查的网络设备都会为每个活动的 TCP 连接产生开销，无论是否空闲。这意味着防火墙以及执行多对一 NAT（这是您熟悉的常用 NAT）的任何东西。这就是为什么这些设备在空闲 TCP 连接上会超时，以便它们最终可以恢复与它们相关的（内存）资源。

任何其他类型的网络设备（例如路由器）不会为碰巧通过它们运行的​​空闲 TCP 连接产生开销。

# javascript - 为动态插入的 HTML 运行 javascript 函数

> ID：14006046
> 
> 赞同：0
> 
> 时间：2012-12-22T19:49:42.547
> 
> 标签：javascript, jquery, html

我有一段代码在另一个元素悬停时插入下面的这段代码。

```
<div class="star" id="1">
<div class="star" id="2">
<div class="star" id="3">
<div class="star" id="4">
<div class="star" id="5">
</div>
</div>
</div>
</div>
</div> 
```

我要做的就是通过javascript检索每个DIV的ID：

```
$(document).ready(function() {

$('.star').on(function(e){

    e.stopPropagation();
    var rating = $(this).attr('id');

    alert(rating);
});

}); 
```

我已经尝试了很多方法来实现这一点，这是我尝试过的最新方法，但我仍然没有运气！我将不胜感激任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:57:56.447

添加上述 div 时触发事件。

```
var counter = 0;
$(someelement).on("mouseenter",function(){
    counter++;
    $('<div class="star" id="' + counter + '" />').appendTo(".star:last").trigger("staradded");
})

$(document).on("staradded",".star",function(e) {
    alert(this.id);
}); 
```

或者更好的是，跳过该事件。

```
var counter = 0;
$(someelement).on("mouseenter",function(){
    counter++;
    $('<div class="star" id="' + counter + '" />').appendTo(".star:last");
    alert(counter);
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T19:53:59.653

你有`wrong`on 的语法，因为你不是`telling`你想要绑定的事件。绑定所需的事件后，例如单击，您可以使用 map 函数获取所有以逗号分隔的`elements`具有 class的 id `star`。

**[现场演示](http://jsfiddle.net/Exc7s/1/)**

```
$(document).on('click', '.star', function(e) {
    e.stopPropagation();
    ids = $('.star').map(function() {
        return this.id;
    }).get().join();
    alert(ids);
}); 
```

您需要使用 each 来遍历所有元素。

```
$('.star').each(function(){           
    var rating = $(this).attr('id');    
    alert(rating);
});

​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:12:20.770

我会使用“livequery”插件 - [https://github.com/brandonaaron/livequery](https://github.com/brandonaaron/livequery)

如果我理解正确，您需要像旧功能“live”这样的东西，因为您想观看所有新的“.star”元素。

在这种情况下，您只需使用以下代码：

```
 $('.star').livequery('click',function(e){}); 
```

你可以在那里找到简单的例子 - [http://jsfiddle.net/WEr5J/11/](http://jsfiddle.net/WEr5J/11/)

# ruby - 如何从 rspec 测试中调用方法

> ID：14006047
> 
> 赞同：2
> 
> 时间：2012-12-22T19:49:51.300
> 
> 标签：ruby, rspec, tdd

我正在同时学习 Ruby 和 TDD (rspec)。

我写了以下测试：

```
describe is_eligible do
  it "returns true if the passed in string is not part of a list" do
    result = is_eligible("abc")
    result.should eq(false)
  end
end 
```

它正在测试以下代码：

```
def is_eligible(team_name)
  array = Array.new
  array << "abc" << "def" << "ghi"
  if array.include?(team_name)
    return false
  else
    return true
  end
end 
```

我收到以下错误，但找不到原因。

*/Users/joel.dehlin/top32/lib/ineligible_teams.rb:6:in `is_eligible'：参数数量错误（0 代表 1）（ArgumentError）*

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T19:59:01.190

问题是该`describe`方法需要一个字符串或可以评估为字符串的东西。如果你说 "is_eligible" 不带引号，它实际上会尝试调用该方法并且你得到错误。

```
describe "is_eligible" do
  it "returns true if the passed in string is not part of a list" do
    result = is_eligible("abc")
    result.should eq(false)
  end
end 
```

# c - C语言中的CPU模拟

> ID：14006048
> 
> 赞同：0
> 
> 时间：2012-12-22T19:49:54.723
> 
> 标签：c, operating-system

我正在做一个班级项目。我需要设计一个 cpu、一个 lts（长期调度程序）和一个调度程序。cpu和lts是线程，它们操作同一个线程安全的链表（也就是说链表上的所有操作必须互斥）。cpu由三个组成部分。（启动：它在执行开始时只工作一次并得到就绪队列中的第一项。获取：它将从正在运行的进程的代码段中获取第[IP]条指令到IR。执行它将执行IR中的指令）。Lts 在创建时间为时将假设进程放入就绪队列。创建时间是在创建进程之前执行的总指令数。

```
DWORD WINAPI cpuFunction(){
    boot();

    while(cpu.runningProcess != NULL){
        WaitForSingleObject(readyQueue->mutex, INFINITE);
        fetch();
        exec();
        ReleaseMutex(readyQueue->mutex);

    }

    return (DWORD) 0;
}

DWORD WINAPI ltsFunction(){
    processList =createProcessList(FILE_NAME); 
    readyQueue = createList();
    while(1){
        WaitForSingleObject(readyQueue->mutex, INFINITE);
        if(processList != NULL){
            nextProcess = getFromList(processList,0);
            if(nextProcess->processCreationTime == cpu.executedInstructionCount){
                nextProcess = removeFromList(processList,0);
                addToList(readyQueue, nextProcess);
                printf("Process %d is in the ready queue.\n",nextProcess->processID);
            } else{
                nextProcess = NULL;
            }
        }
        ReleaseMutex(readyQueue->mutex);
    }
    Sleep(500);

} 
```

在我的代码中，我想做的是在每个执行步骤之后，必须解锁 cpu 函数中的互斥锁，并且 lts 应该检查它是否是下一个进程的创建时间。这就是我使用互斥锁的原因。但问题是它们不起作用。首先 lts 将第一个进程放入就绪队列（其创建时间为 0），然后 cpu 开始运行，但它不会停止，直到第一个进程终止。但是，在执行指令后，必须将第二个进程放入就绪队列中。我不知道我该如何解决，我真的需要帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:11:08.550

如果一个线程需要在没有锁定互斥锁的情况下等待另一个线程，标准方法是使用条件。如果我正确阅读了您的问题，您有两个线程需要使用受相同互斥锁保护的东西，交错。

关于条件的重要一点是，它们总是与互斥锁相关联。线程锁定互斥锁，然后在互斥锁被锁定时开始等待条件，这将释放互斥锁。然后当线程从条件等待中唤醒时，它将再次锁定互斥锁。当另一个线程想唤醒一个等待条件的线程时，它必须先锁定同一个互斥锁，然后发出条件信号唤醒等待它的线程，然后释放互斥锁（这样被唤醒的线程实际上可以获得互斥锁） .

此 MSDN 页面提供了一个示例：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms686903%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686903%28v=vs.85%29.aspx)

但是你最好至少浏览一下这个 MSDN 主题下关于同步的所有内容：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms686353%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms686353%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:27:25.653

我不是 100% 确定，但我猜会发生什么是第一个 CPU 在第二个 CPU 有机会运行之前“抢占”了 Mutex。您可以通过`sleep(20);`在 realease 之后添加 a 来尝试[这显然是一个糟糕的解决方案，但它会显示这是否真的是问题]。

即使您的系统中有多个内核/CPU，也不能保证等待时间最长的线程会赢得争夺互斥锁的竞赛。

不使用互斥锁当然是一种解决方案，但是我认为您仍然需要了解自己做错了什么，然后才说“哦，互斥锁不起作用，我会做其他事情”-因为很有可能除非您了解发生了什么，否则您迟早会在其他地方遇到相同或类似的问题。

# javascript - jQuery syntax using "not" with uniform plugin

> ID：14006053
> 
> 赞同：0
> 
> 时间：2012-12-22T19:50:18.897
> 
> 标签：javascript, jquery, syntax

I am puzzled by the reference to the word 'not' in the following code:

```
$("select, input[type=file]").not('select[multiple]').uniform(); 
```

Could someone please explain it for me?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:01:50.063

That's the [.not() method](http://api.jquery.com/not/). It removes any elements from the current matched set that match the given selector.

The initial jQuery call selects all the `<select>` and `<input type="file">` elements on the page. The `.not()` specifically excludes any `<select>` elements with the `multiple` attribute, removing them before the `.uniform()` call.

# c# - 如何从该标签中获取其中具有标签控件的类的对象引用？

> ID：14006059
> 
> 赞同：0
> 
> 时间：2012-12-22T19:50:44.673
> 
> 标签：c#, winforms

我有一个有标签字段的类。现在我想从该标签中获取该类的引用。我怎样才能做到这一点？这就是我所拥有的。

```
public class Abc
{
    Label l;
}
public partial class Form1 : Form
{
    private void btnins_Click(object sender, EventArgs e)
    {
       Abc ob=new Abc();
       ob.l=new new Label();
       l.Text="Right Click Me";
       l.ContextMenuStrip = cntxtdelmnu;
    }

    private void cntxtdelnode_Click(object sender, EventArgs e)
    {
       Label lbl= (Label)cntxtdelmnu.SourceControl;

       //Here I have to get the reference of ob using lbl.
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T19:57:23.403

你不能，基本上。可能有*多个*对象引用了该标签 - 或者根本没有。您无法获得“向后”参考。您可能会在`Tag`属性中存储引用：

```
Abc ob=new Abc();
ob.l= new Label();
ob.l.Text="Right Click Me";
ob.l.ContextMenuStrip = cntxtdelmnu;
ob.l.Tag = ob; 
```

或使用*对象初始化器*：

```
Abc ob = new Abc();
ob.l = new Label { Text = "Right Click Me", ContextMenuStrip = cntxtdelmnu, Tag = ob }; 
```

我会*尽量*避免需要它。从这个问题中不清楚你为什么想要它，但可能有更好的方法。（我也真希望那些不是你的真名……）

# c++ - LibPng 读入结构

> ID：14006066
> 
> 赞同：1
> 
> 时间：2012-12-22T19:51:48.370
> 
> 标签：c++, libpng

我似乎无法让 libpng 将其数据转储到我的结构中。我无法弄清楚我做错了什么。我正在尝试翻转字节，因为 PNG 是自上而下存储的，我需要自下而上的数据。

首先我的结构看起来像：

```
typedef union RGB
{
    uint32_t Color;
    struct
    {
        unsigned char B, G, R, A;
    } RGBA;
} *PRGB; 
```

然后我创建了一个向量：

```
png_init_io(PngPointer, hFile);
png_set_sig_bytes(PngPointer, 8);
png_read_info(PngPointer, InfoPointer);

uint32_t width, height;
int bitdepth, colortype, interlacetype, channels;

png_set_strip_16(PngPointer);
channels = png_get_channels(PngPointer, InfoPointer);
png_get_IHDR(PngPointer, InfoPointer, &width, &height, &bitdepth, &colortype, &interlacetype, nullptr, nullptr);

uint32_t RowBytes = png_get_rowbytes(PngPointer, InfoPointer);
unsigned char** RowPointers = png_get_rows(PngPointer, InfoPointer);
std::vector<RGB> Pixels(RowBytes * height);   //Amount of bytes in one row * height of image.

//Crashes in the for loop below :S

for (int I = 0; I < height; I++)
{
    for (int J = 0; J < width; J++)
    {
        Pixels[(height - 1 - I) * width + J].RGBA.B = *(RowPointers[J]++);
        Pixels[(height - 1 - I) * width + J].RGBA.G = *(RowPointers[J]++);
        Pixels[(height - 1 - I) * width + J].RGBA.R = *(RowPointers[J]++);
    }
}

std::fclose(hFile);
png_destroy_read_struct(&PngPointer, &InfoPointer, nullptr); 
```

我做错什么了？如何获取 PNG 的像素并将它们倒置存储？我对位图使用了相同的技术，但 PNG 无法正常工作：l

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:56:14.057

这不应该：

```
Pixels[(height - 1 - I) * width + J].RGBA.B = *(RowPointers[J]++); 
```

而是`RowPointers`通过索引？`I`

# servlets - 服务器在 1680 毫秒内启动：为什么我收到此错误

> ID：14006069
> 
> 赞同：0
> 
> 时间：2012-12-22T19:52:07.813
> 
> 标签：servlets

每当我要运行我的项目时，我都会经常收到此错误。请让我知道它背后的原因是什么。1680 年的服务器启动。我搜索了很多但没有得到任何解决方案。我也创建了一个新的工作区但得到同样的问题。

```
Dec 22, 2012 11:35:31 AM org.apache.catalina.core.AprLifecycleListener init
INFO: The APR based Apache Tomcat Native library which allows optimal performance in      
production environments was not found on the java.library.path: C:\Program Files\Java
\jre7\bin;C:\Windows\Sun\Java\bin;C:\Windows\system32;C:\Windows;C:/Program Files/Java
 /jre7/bin/client;C:/Program Files/Java/jre7/bin;C:/Program Files/Java/jre7/lib

 /i386;c:\program files\dell\dw wlan card;C:\Windows\system32;C:\Windows;C:\Windows   
 \system32\wbem;C:\Windows\system32\windowspowershell\v1.0\;c:\program files\java
 \jdk1.6.0_25\bin;c:\program files\ibm\gsk8\lib;C:\Program Files\Microsoft SQL 
  Server\100\Tools\Binn\;C:     \Program Files\Microsoft SQL Server\100\DTS\Binn
   \;B:\eclipse;;.

      Dec 22, 2012 11:35:31 AM org.apache.tomcat.util.digester.SetPropertiesRule begin
   WARNING: [SetPropertiesRule]{Server/Service/Engine/Host/Context} Setting property   

   'source' to 'org.eclipse.jst.jee.server:RESTfulProject' did not find a matching property.

Dec 22, 2012 11:35:31 AM org.apache.coyote.AbstractProtocolHandler init

  INFO: Initializing ProtocolHandler ["http-bio-8080"]

     Dec 22, 2012 11:35:31 AM org.apache.coyote.AbstractProtocolHandler init

    INFO: Initializing ProtocolHandler ["ajp-bio-8009"]

   Dec 22, 2012 11:35:31 AM org.apache.catalina.startup.Catalina load

   INFO: Initialization processed in 742 ms

  Dec 22, 2012 11:35:31 AM org.apache.catalina.core.StandardService startInternal

   INFO: Starting service Catalina

  Dec 22, 2012 11:35:31 AM org.apache.catalina.core.StandardEngine startInternal

  INFO: Starting Servlet Engine: Apache Tomcat/7.0.8
    Dec 22, 2012 11:35:31 AM com.sun.jersey.api.core.ClasspathResourceConfig init
   INFO: Scanning for root resource and provider classes in the paths:
     B:\XYRAD\XyRadwebservicesMoon\.metadata\.plugins\org.eclipse.wst.server.core   
      \tmp6\wtpwebapps\RESTfulProject\WEB-INF\lib

   B:\XYRAD\XyRadwebservicesMoon\.metadata\.plugins\org.eclipse.wst.server.core
   \tmp6\wtpwebapps\RESTfulProject\WEB-INF\classes

   Dec 22, 2012 11:35:32 AM com.sun.jersey.api.core.ClasspathResourceConfig init
   INFO: Root resource classes found:

   class webService.FeedService

  Dec 22, 2012 11:35:32 AM com.sun.jersey.api.core.ClasspathResourceConfig init

   INFO: Provider classes found:
   Dec 22, 2012 11:35:33 AM org.apache.coyote.AbstractProtocolHandler start
   INFO: Starting ProtocolHandler ["http-bio-8080"]
  Dec 22, 2012 11:35:33 AM org.apache.coyote.AbstractProtocolHandler start
       INFO: Starting ProtocolHandler ["ajp-bio-8009"]
   Dec 22, 2012 11:35:33 AM org.apache.catalina.startup.Catalina start
     INFO: Server startup in 1680 ms 
```

# jquery - Jquery如何使用堆叠值选项（例如font-family）从css属性中获取特定的css值

> ID：14006074
> 
> 赞同：3
> 
> 时间：2012-12-22T19:52:47.913
> 
> 标签：jquery, css, properties, fonts, selector

有没有办法从 Jquery 中的 css 属性值堆栈中获取第一个或任何其他特定值项？

```
body {
    font-family: Calibri, Arial, Helvetica, sans-serif;
    font-size: 8px;
} 
```

.

```
var firstFontOption = $('body').css('font-family') //How can I store only "Calibri" referencing the above?

var secondFontOption = $('body').css('font-family') //How can I store only "Arial" referencing the above? 
```

我只`$('body').css('font-family')`显示了所有值“Calibri、Arial、Helvetica、sans-serif”。Jquery 是否有第一个、第二个或其他 css 值选择器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T20:01:35.260

你可以做的是像这样拆分字符串：

```
 $('body').css('font-family').split(","); 
```

那应该给你一个字符串数组：

```
 ["Calibri", "Arial", "Helvetica", "sans-serif"] 
```

然后，您可以按索引访问此数组，以获取 Calibri：

```
 $('body').css('font-family').split(",")[0]; 
```

并获得无衬线字体：

```
 $('body').css('font-family').split(",")[3]; 
```

我不知道是否有更清洁的方法，但这会起作用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-11T07:01:37.240

要获取特定属性，您可以简单地指向该 div/HTML 标记并获取内联 css 属性。像这样：

$('body').css('font-size');

```
alert($('.text').css('color'));
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<div class="text" style="color:red">
  Alpha To Delta
</div>
```

');

# azure - EAI 的 Biztalk 与 EAI 场景的 ESB

> ID：14006075
> 
> 赞同：4
> 
> 时间：2012-12-22T19:52:51.183
> 
> 标签：azure, biztalk, nservicebus, esb, servicebus

我对 ESB 或 Biztalk 不太熟悉，如果您已经拥有 Biztalk，我正试图从 EAI 的角度了解什么是最有意义的。据我了解，Biztalk 是一个消息代理（集线器和辐条），而 ESB 模式是一种反代理，其中概念“总线”由以某种方式相互通信的各个分布式组件组成。消息代理本质上代表单点故障，而不是 ESB，其中一个组件发生故障并不会导致整个“总线”瘫痪。此外，我的理解是，Biztalk 是单一的，因为消息传递、编排紧密耦合并且扩展存在问题。

如果手头的情况是：

*   Biztalk 已经主要用于根据从外部各方收到的不同文件运行不同的编排。
*   一堆目前与 CRM 和工资单等系统紧密耦合的内部定制应用程序需要重构以抽象出这些依赖关系。

直接使用 Biztalk 或 Biztalk ESB 工具包来实现 ESB 功能是否有意义，或者使用适当的 ESB 实现（例如 NServiceBus 或基于 Azure 服务总线的 Windows 服务总线）是否有意义。直接使用 Biztalk 实现 EAI 与使用适当的 ESB 的优缺点是什么。每个应用程序是否会严重依赖 Biztalk，这是否可取？

由于没有正确或错误的答案，我将把它作为一个开放式讨论。

**@斯图尔特LC：** 感谢您的答复。我已经阅读了您发布的几个链接，但仍然不清楚 Biztalk 作为 ESB 解决方案与使用 NServiceBus 之类的解决方案是否有意义。两者似乎都以一种或另一种方式实现“ESB”模式。问题是哪一个具有更清洁的实现、更好的开发经验和更短的启动时间。到目前为止，我的评估（仅来自纯粹的研究）是可以使用 Biztalk，但它很痛苦并且需要非常专业的开发人员。技能。延迟和扩展存在问题，并且 Biztalk 最终将被同化到（Azure？）服务总线和 Biztalk SKU 的事实将不复存在。另一方面，像 NService 总线这样的框架具有相对较短的启动时间，可以很容易地被开发人员使用。过得很好。NET 编程技能，可以轻松与 Biztalk 交互。鉴于上述情况，即使您目前在内部拥有 Biztalk，或者为了将来证明自己使用适当的 ESB（例如 NService Bus），走 Biztalk 路线是否仍然有意义？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T12:21:25.420

我相信您的开放式问题的许多组成部分已经在 SO 中介绍过：

*   [使用 BizTalk 而不是 NServiceBus 或 MassTransit 的优点/缺点](https://stackoverflow.com/questions/3706158/pros-cons-of-using-biztalk-instead-of-nservicebus-or-masstransit)
*   [哪些 ESB 系统最适合 .Net 堆栈？](https://softwareengineering.stackexchange.com/questions/63655/what-esb-systems-work-the-best-for-net-stack)
*   [Microsoft BizTalk Server 与 Azure AppFabric 服务总线...？](https://stackoverflow.com/questions/5387914/microsoft-biztalk-server-vs-azure-appfabric-service-bus)
*   [BizTalk 2009 ESB 混淆](https://stackoverflow.com/questions/1555761/biztalk-2009-esb-confusion)
*   [BizTalk 是 ESB 吗？](https://stackoverflow.com/questions/3355082/is-biztalk-an-esb)

然而，IMO 这只是一个有缺陷/短视的实现，这将导致应用程序和端点之间的紧密耦合。松耦合很容易实现：（即使没有 ESB 工具包）：

*   通过使用[多部分消息和规范的内部模式](http://msdn.microsoft.com/en-us/magazine/cc163423.aspx)来解耦依赖关系。
*   编排和端口应该通过消息框发布来解耦

单点故障也是可以避免的：

*   在通信适配器上配置重试和备用/备份传输
*   通过服务器组和集群实现冗余
*   并使用对交付失败的补偿进行回退

IMO 使用 BizTalk 作为 ESB 时的致命弱点是缺乏保证的延迟，例如，如果 BTS 进入[节流状态](https://stackoverflow.com/questions/1880109/biztalk-server-problem)[，](https://stackoverflow.com/questions/2140152/biztalk-low-latency-response-time-issue-calling-c-sharp-to-wcf-published-orche)这种情况会加剧。

**更新**

IMO 的选择归结为您是否可以控制环境中的所有系统。

如果您正在集成一个内部企业，该企业只包含您可以直接控制的同质的、现代的（主要是 SOA 和 EDA）应用程序，`MassTransit`或者`NServiceBus`可能会超出工作的范围，并且您可以提高生产力和加速时间。

# javascript - 如何从回调函数中更新另一个范围的变量？

> ID：14006078
> 
> 赞同：-1
> 
> 时间：2012-12-22T19:53:06.357
> 
> 标签：javascript, jquery, callback, scope

我在更新与回调函数不同范围的变量时遇到问题，回调函数本身是 jQuery getJSON 调用中的参数。有人能告诉我如何从下面的回调函数中将元素推送到 chg_percent 变量上吗？谢谢！

```
$(document).ready(function() {

    chg_percent = []; // array of all percent changes

    var url = 'http://finance.yahoo.com/webservice/v1/symbols/allcurrencies/quote?format=json&view=basic&callback?';

    $.getJSON(url, null, function(data) {

        for (i = 0; i < data.list.resources.length; i++) {
        chg_percent.push(data.list.resources[i].resource.fields.chg_percent);
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-22T19:55:46.317

`chng_percent`与 .一起添加为参数`function(data) { ... }`。

它应该如下所示：

```
$.getJSON(url, null, function(data, chng_percent) { 
```

# c++ - 如何以 lambda 作为第一个参数覆盖可变参数模板？

> ID：14006079
> 
> 赞同：1
> 
> 时间：2012-12-22T19:53:12.530
> 
> 标签：c++, c++11, lambda, variadic-templates

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T20:11:51.310

lambda 的类型是一个匿名类型，它有一个`operator()`. 它不是一个`std::function<>`.

您可以检查第一个参数是否是调用 3 的函子，而不是专门化类型（演示：http: [//ideone.com/IQ4N6L](http://ideone.com/IQ4N6L)）：

```
#include <iostream>
#include <type_traits>

template<typename F, typename ...Args>
auto call(F&& f, Args&& ...args)
    -> typename std::enable_if<std::is_same<decltype(f()), void>::value>::type
{
    std::cout << "call 3\n";
}

template<typename ...Args>
void call(Args&& ...args) {
    std::cout << "call 1\n";
}

int main() {
    call(1);
    call([](){});
} 
```

# ruby - ruby 内核：方法表现为实例方法

> ID：14006087
> 
> 赞同：-1
> 
> 时间：2012-12-22T19:54:05.507
> 
> 标签：ruby, module, kernel, core

```
class C
  def aaa
     print "aaa"
  end
end

C.new.aaa
# => "aaa" 
```

现在从模块内核工作方法打印

```
Kernel.methods.grep /^print/
# => [:printf, :print] 
```

这意味着，该方法定义为类方法。

内核没有实例方法打印

```
Kernel.instance_methods.grep /^print/
# => [] 
```

所以第一个问题是：怎么会从对象接收者调用类方法？(C.新)

* * *

我也尝试用自己的模块做同样的把戏：

```
module M
  def self.print
    "111"
  end
end

class C
include M
  def aaa
     print 
  end
end

C.new.aaa
# => nil 
```

你看，又是内核模块

但层次树是：

```
C.ancestors
# => [C, M, Object, Kernel, BasicObject]

M.methods.grep /^print/
# => [:print] 
```

方法在内核中定义。我只能作为实例方法覆盖

```
module M
  def print
    "111"
  end
end

M.instance_methods.grep /^print/
# => [:print] 
```

那么内核如何做到这一点？内核如何将类方法作为实例方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T19:59:29.210

```
1.9.3-p327 :002 > Kernel.private_instance_methods.grep /^print/
=> [:printf, :print] 
```

`instance_methods`只给你一个*公共*实例方法的列表。由于`Kernel`被包含`Object`，它的私有实例方法*总是*可用的，所以没有必要将它们公开。

# android - 将 UniversalImageLoader 与 WebView 一起使用

> ID：14006091
> 
> 赞同：0
> 
> 时间：2012-12-22T19:54:43.417
> 
> 标签：android, webview, imageview, universal-image-loader

我在我的应用程序中使用[Android 通用图像加载器](https://github.com/nostra13/Android-Universal-Image-Loader "通用图像加载器”")。它适用于`ImageView`s，但我`WebView`的应用程序中也有。因此，图像被下载两次。一次由 Universal Image Loader for `ImageView`s 和一次由 WebView。是否可以使用已经下载的图像`WebView`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T09:11:29.010

我不知道它是否能回答你的问题，但看看[这里](https://stackoverflow.com/questions/6127696/android-local-image-in-webview)也许对你有帮助。

# facebook-graph-api - 图 api 字段扩展

> ID：14006092
> 
> 赞同：3
> 
> 时间：2012-12-22T19:55:22.480
> 
> 标签：facebook-graph-api, field

我想在我的图形 api 查询和获取帖子评论等时使用字段扩展...

但我想从“来自”字段中获取图片，但我也想获取类别字段，以便知道它是页面还是用户。

如果我不使用字段扩展，我会得到类别，但不会得到图像。但是使用字段扩展我得到图片而不是类别。

例如

/me/home?fields=from 返回 {id: 1, name :"x", category : "y" }

但像这样使用它：/me/home/?fields=from.fields(id, name, category, picture) 返回 null，如果我删除类别它工作正常。

那么有没有一种方法可以获取该字段的类别+图片，或者是否有另一种方法可以知道它是页面还是用户？

# xcode - ibtool 在编译故事板时失败

> ID：14006093
> 
> 赞同：7
> 
> 时间：2012-12-22T19:55:24.840
> 
> 标签：xcode, macos, storyboard, xcode4.5

我刚刚从两台不同 Macbook 上的 git 存储库下载了一个项目。首先，它运行没有问题。

在第二台 Macbook 上显示以下消息：

```
Command /Applications/Xcode.app/Contents/Developer/usr/bin/ibtool 
failed with exit code 255 
```

当试图编译文件时`MainStoryboard.storyboard`。

当我单击 XCode 上的 MainStoryboard.storyboard 时，它崩溃并且无法打开它。

在另一台计算机上，一切正常。

我尝试了以下方法来解决这个问题，但没有成功：

1) 将 XCode 从 4.5 升级到 4.5.2

2）删除项目目录并再次克隆存储库。

3）删除了我的项目内容`~/Library/Developer/Xcode/DerivedData`

4)`purge`

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-28T06:49:54.960

使用 XCode 5 发现了这个问题。

我已经解决了这个问题，但它需要硬重置。

有人说这是因为我在 App Store 之外安装了 XCode，或者因为模拟器有问题，或者因为 XCode 指向了错误的模拟器版本，或者资源缺少目标成员资格，等等。我尝试了所有这些。

我从 App Store 下载了 XCode，重新安装了模拟器，但仍然没有运气。所以我只是将我的存储库回滚到更早的日期，并且在此过程中丢失了一些工作。不过不多，因为我总是很少而且经常承诺。

自从 2011 年开始使用故事板以来，我一直很少而且经常这样做。故事板很脆弱。

编辑重新添加新组件后，问题再次浮出水面。

我注意到我在 UIViewController 中放置了一个静态表视图。我以前就是这样做的。

我在代码中使用了 UITableViewController 的子类，但情节提要场景是 UIViewController。我改为拖出一个 UITableViewController，并将表格视图单元格移到其中，它解决了这个问题。

多亏了丢失的错误消息。自 XCode 5 以来，它们都去了哪里？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T06:59:36.463

做一个

`which ibtool`

在两台 Mac 上的命令行中。很有可能它们是不同的。

在 Xcode 被捆绑在单个 .app 包中之前，它会在 /usr/local 等文件夹中安装命令行工具。

我建议您删除那些本地副本以避免干扰 Xcode 的内置版本，即它使用旧版本。如果您仍然希望能够从命令行使用 ibtool，这里有一个关于 xcrun 的解释：http: [//www.cocoanetics.com/2012/07/you-dont-need-the-xcode-command-line-tools /](http://www.cocoanetics.com/2012/07/you-dont-need-the-xcode-command-line-tools/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-01T18:02:43.960

差不多半年后，我终于成功地发现了导致这个问题的原因并修复了这个错误。

现在，有了 XCode 4.6.3，它给了我关于这个问题的另一个线索：

```
2013-06-28 18:15:32.606 Interface Builder Cocoa Touch Tool[7894:f07] CFPreferences: user home directory at file://localhost/Users/[myusername]/Library/Application%20Support/iPhone%20Simulator/User/ is unavailable. User domains will be volatile.Command /Applications/Xcode.app/Contents/Developer/usr/bin/ibtool failed with exit code 255 
```

收到这条新消息后，我在“iPhone Simulator”中搜索了这个**用户**文件夹，没有名为“用户”的文件夹。

我创建了“用户”文件夹，进行了清理，之后我能够再次构建项目！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-29T06:03:18.443

在 Xcode 6.4 中对我的修复是......重新启动我的计算机。悲伤，但真实。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-02-24T20:04:10.293

我遇到了同样的错误。事实证明，我在 tableview 单元格中错误地连接了一些插座。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-03T03:32:05.060

我不知道是否有人仍在为这个错误而苦苦挣扎，但今天轮到我面对它了。我刚刚解决了。这是上下文：

我有一个 UITableViewCell，其中一半被一个简单的 UIVIEW 覆盖。在这个 UIVIEW 里面我有很多其他的视图（UILables、UITextField 等等）

就在 UIVIEW 结束的地方（它再次覆盖了整个 UITableViewCell 的中间）我放置了一个 UIImageView。UIImageView 的一半覆盖了 UIView，另一半在 UITableView 本身。在 Hierarchy 中，UIImageView 在 UITableVIewCell 上，而不是在 UIView 内。

问题是当我应用自动布局时，我在 UIView 内部的视图和 UIVIEW 外部的 UIImageView 之间设置了一个约束。

当我运行该应用程序时，出现了错误。半小时后删除视图和东西我意识到错误是由该约束引起的。删除该约束后，错误消失了。

所以底线，检查你的约束！仅将视图与同一 superView 中的其他视图“连接”。

祝你好运！

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2012-12-26T15:07:15.300

尝试完全重新安装 Xcode。似乎 ibtool 有问题，重新安装可能能够修复。

# windows-8 - WinRT 清除剪贴板后台任务

> ID：14006101
> 
> 赞同：0
> 
> 时间：2012-12-22T19:56:39.480
> 
> 标签：windows-8, windows-runtime, windows-store-apps, windows-store

我的应用程序使用户能够在复制一些安全文本后的特定时间（以秒为单位）后清除剪贴板。问题是，如果应用程序暂停，剪贴板永远不会清除。我看过使用后台任务，但找不到适合我需要的触发器。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:40:29.717

[后台任务](http://msdn.microsoft.com/en-gb/library/windows/apps/xaml/hh977056.aspx)是您最好的选择，但您的选择有限。理想情况下，您会使用 15 分钟计时器，但您必须被添加到锁定屏幕，我怀疑没有多少用户会这样做。2 小时计时器可能是您的下一个最佳选择。

维护触发器将是一个不错的选择（因为每 15 分钟一次，并且不需要在锁定屏幕上），但它确实要求设备不使用电池供电。

# ruby - Fedora 17 上的 Heroku 工具带

> ID：14006106
> 
> 赞同：9
> 
> 时间：2012-12-22T19:57:37.267
> 
> 标签：ruby, fedora, heroku-toolbelt

我正在尝试做教程[http://ruby.railstutorial.org/](http://ruby.railstutorial.org/)的 heroku 设置部分。但是在[https://toolbelt.heroku.com/](https://toolbelt.heroku.com/)上，我注意到 Fedora 没有 .rpm，所以我尝试单独安装 Foreman 和 Heroku CLI。Foreman 和 Git 安装良好，但 Heroku CLI 出现问题。

当我尝试这样做时：

```
$yum install rubygem-heroku 
```

然后简单地做

```
$heroku 
```

我得到错误：

```
 /usr/share/rubygems/rubygems/dependency.rb:247:in `to_specs': Could not find heroku (>= 0) amongst [actionmailer-3.2.8, actionpack-3.2.8, activemodel-3.2.8, activerecord-3.2.8, activeresource-3.2.8, activesupport-3.2.8, addressable-2.3.2, arel-3.0.2, builder-3.0.4, builder-3.0.3, bundler-1.2.3, bundler-1.2.1, coffee-rails-3.2.2, coffee-script-2.2.0, coffee-script-source-1.4.0, coffee-script-source-1.3.3, erubis-2.7.0, excon-0.16.10, execjs-1.4.0, foreman-0.60.2, heroku-api-0.3.7, hike-1.2.1, i18n-0.6.1, journey-1.0.4, jquery-rails-2.1.4, jquery-rails-2.1.3, jquery-rails-2.0.2, json-1.7.5, launchy-2.1.2, libv8-3.3.10.4-x86_64-linux, mail-2.4.4, mime-types-1.19, multi_json-1.5.0, multi_json-1.3.6, netrc-0.7.7, polyglot-0.3.3, rack-1.4.1, rack-cache-1.2, rack-ssl-1.3.2, rack-test-0.6.2, rails-3.2.8, railties-3.2.8, rake-10.0.3, rake-0.9.2.2, rdoc-3.12, rest-client-1.6.7, rubygems-bundler-1.1.0, rubyzip-0.9.9, rvm-1.11.3.5, sass-3.2.3, sass-3.2.1, sass-rails-3.2.5, sprockets-2.1.3, sqlite3-1.3.6, sqlite3-1.3.5, therubyracer-0.10.2, thor-0.16.0, tilt-1.3.3, treetop-1.4.12, treetop-1.4.11, treetop-1.4.10, tzinfo-0.3.35, tzinfo-0.3.33, uglifier-1.3.0, uglifier-1.2.3, uglifier-1.0.3] (Gem::LoadError)
    from /usr/share/rubygems/rubygems/dependency.rb:256:in `to_spec'
    from /usr/share/rubygems/rubygems.rb:1231:in `gem'
    from /usr/bin/heroku:18:in `<main>' 
```

所以我 yum 删除了它并尝试改为：

```
$rvmsudo gem install heroku 
```

现在，当我运行 heroku 时，我得到：

```
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require': cannot load such file -- readline (LoadError)
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/heroku-2.33.5/lib/heroku/command/run.rb:1:in `<top (required)>'
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/heroku-2.33.5/lib/heroku/command.rb:14:in `block in load'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/heroku-2.33.5/lib/heroku/command.rb:13:in `each'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/heroku-2.33.5/lib/heroku/command.rb:13:in `load'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/heroku-2.33.5/lib/heroku/cli.rb:27:in `start'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/gems/heroku-2.33.5/bin/heroku:17:in `<top (required)>'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/heroku:19:in `load'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/heroku:19:in `<main>'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/ruby_noexec_wrapper:14:in `eval'
    from /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/ruby_noexec_wrapper:14:in `<main>' 
```

尝试`rvm info`产量

```
ruby-1.9.3-p194@rails3tutorial2ndEd:

  system:
    uname:       "Linux angelo 3.6.5-1.fc17.x86_64 #1 SMP Wed Oct 31 19:37:18 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux"
    system:      "redhat/17./x86_64"
    bash:        "/usr/bin/bash => GNU bash, version 4.2.37(1)-release (x86_64-redhat-linux-gnu)"
    zsh:         " => not installed"

  rvm:
    version:      "rvm 1.16.6 (master) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]"
    updated:      "2 months 20 days 1 hour 33 minutes 52 seconds ago"

  ruby:
    interpreter:  "ruby"
    version:      "1.9.3p194"
    date:         "2012-04-20"
    platform:     "x86_64-linux"
    patchlevel:   "2012-04-20 revision 35410"
    full_version: "ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]"

  homes:
    gem:          "/usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd"
    ruby:         "/usr/local/rvm/rubies/ruby-1.9.3-p194"

  binaries:
    ruby:         "/usr/local/rvm/rubies/ruby-1.9.3-p194/bin/ruby"
    irb:          "/usr/local/rvm/rubies/ruby-1.9.3-p194/bin/irb"
    gem:          "/usr/local/rvm/rubies/ruby-1.9.3-p194/bin/gem"
    rake:         "/usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin/rake"

  environment:
    PATH:         "/home/angelo/.rvm/bin:/usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin:/usr/local/rvm/gems/ruby-1.9.3-p194@global/bin:/usr/local/rvm/rubies/ruby-1.9.3-p194/bin:/usr/local/rvm/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/home/angelo/heroku-client/:/home/angelo/.local/bin:/home/angelo/bin"
    GEM_HOME:     "/usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd"
    GEM_PATH:     "/usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd:/usr/local/rvm/gems/ruby-1.9.3-p194@global"
    MY_RUBY_HOME: "/usr/local/rvm/rubies/ruby-1.9.3-p194"
    IRBRC:        "/usr/local/rvm/rubies/ruby-1.9.3-p194/.irbrc"
    RUBYOPT:      ""
    gemset:       "rails3tutorial2ndEd" 
```

还有我的 Rails 版本

```
$ rails -v
Rails 3.2.8 
```

宝石环境：

```
$ gem env
RubyGems Environment:
  - RUBYGEMS VERSION: 1.8.24
  - RUBY VERSION: 1.9.3 (2012-04-20 patchlevel 194) [x86_64-linux]
  - INSTALLATION DIRECTORY: /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd
  - RUBY EXECUTABLE: /usr/local/rvm/rubies/ruby-1.9.3-p194/bin/ruby
  - EXECUTABLE DIRECTORY: /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-linux
  - GEM PATHS:
     - /usr/local/rvm/gems/ruby-1.9.3-p194@rails3tutorial2ndEd
     - /usr/local/rvm/gems/ruby-1.9.3-p194@global
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - http://rubygems.org/ 
```

我对整个红宝石（以及heroku）都很陌生，所以我不确定我应该寻找什么来匹配，但一切似乎都是ruby-1.9.3，所以我很困惑为什么Heroku不想合作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-24T23:36:08.633

[现在在https://toolbelt.heroku.com/standalone](https://toolbelt.heroku.com/standalone)上还有一个独立版本的工具带。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-16T09:32:43.863

我宁愿使用 heroku 和工头 gem，也不愿在 fedora 17/18 上使用 heroku 工具。

```
gem install heroku 
gem install foreman 
```

在安装过程中它会给出一个警告说

> 该`heroku`gem 已被弃用，取而代之的是 Heroku Toolbelt。

忽略那个。toolbet 甚至给我在 windows 系统上的问题。

在 Fedora 17/18 上一切正常。

享受红宝石！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-11T16:54:40.847

我做了

```
sudo yum install rubygem-heroku 
```

如果您使用的是 RVM，请执行此操作

```
rvm use system 
```

使用heroku客户端。

很难让 heroku 命令与 rvm+jruby 一起工作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-07T18:20:36.730

您应该完全选择更稳定的独立选项。我也安装了 gem，但遇到了很多类型的错误（ssl、cert、yours...）

你可以去：

> [https://toolbelt.heroku.com/standalone](https://toolbelt.heroku.com/standalone)

并根据您的操作系统安装它。

希望这可以帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T20:18:26.787

如果您安装 ruby​​gem_heroku 包，它可能会在系统 ruby​​ 中安装 gem。

根据您的示例，您正在使用 RVM。

您应该将 heroku gem 直接安装到 RVM 环境和要在其中使用它的 gemset 中：

```
gem install heroku 
```

# objective-c - 测试符号变化的更好方法？

> ID：14006111
> 
> 赞同：2
> 
> 时间：2012-12-22T19:58:09.467
> 
> 标签：objective-c, math

在循环一个数字序列时（例如 0.1、-0.5、1.0、-0.33、...），我想要一种方法来测试当前数字是否具有与前一个不同的符号。我的代码在下面，但是 - 必须有更好的方法..

```
-(bool)signChanged:(float)prev :(float)value{

    // our value is negative
    if(value < 0.0){

        // previous value is positive or zero
        if(prev >= 0.0) return true;

    // our value is positive
    }else{

        if(prev < 0.0) return true;
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T20:07:47.877

对于如此快速的验证，请使用宏而不是方法：

```
#define SAME_SIGN(v1,v2) (v1>=0)==(v2>=0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:00:47.563

将您的值乘以先前的值。如果结果是肯定的，则符号没有改变。否则，它有。

# java - 通过 Tomcat 上传 Tapestry 文件

> ID：14006114
> 
> 赞同：0
> 
> 时间：2012-12-22T19:58:51.980
> 
> 标签：java, tomcat7, tapestry

我在 Tapestry 5.3.6 上上传文件时遇到问题。我将此用作参考[http://tapestry.apache.org/uploading-files.html](http://tapestry.apache.org/uploading-files.html) 使用 Jetty Web 服务器，一切都很好，文件被上传到项目目录中。但是，如果我在 Tomcat 上运行应用程序，文件会上传到 Tomcat 目录中。有没有办法让Tomcat将文件上传到项目目录？提前致谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T09:04:15.690

据我所知，您可以在 AppModule 的contributeApplicationDefaults 方法中使用参数进行贡献，例如

> configuration.add(UploadSymbols.REPOSITORY_LOCATION,);

试试看。

# apache - 具有 mod_rewrite 问题的虚拟主机 (Apache)

> ID：14006115
> 
> 赞同：2
> 
> 时间：2012-12-22T19:58:57.593
> 
> 标签：apache, mod-rewrite, virtualhost

我试图解决这一整天都没有成功，所以我希望有人能帮助我。我在 有一个应用程序`http://localhost/`，它使用 Pylons 作为我托管的应用程序。除此之外，我需要托管一个 PHP/MySQL 站点，所以我也必须使用 Apache。

我目前的设置是我使用 haproxy 和这个 Apache 后端的配置：

```
backend apache

mode http
timeout connect 4000
timeout server 30000
timeout queue 60000
balance roundrobin

server app02-8002 localhost:8002 maxconn 1000 
```

这是由此触发的：

```
acl image url_sub images
use_backend apache if image 
```

所以，当我打开我的 IP/图像时，它会触发它并打开 Apache，端口为 8002。

对于 Apache，我创建了虚拟主机，这是“图像”之一：

```
<VirtualHost *:8002>
 ServerAdmin my@email.com
 ServerName image
 ServerAlias image
 DocumentRoot /srv/www/image/public_html/
 ErrorLog /srv/www/image/logs/error.log
 CustomLog /srv/www/image/logs/access.log combined
</VirtualHost> 
```

所以，这一切都很好，当我输入 IP/images 时，它会打开 /srv/www/image/public_html。但随后问题来了。由于我使用的是图像上传脚本，它涉及大量重写，所以我必须启用该模块。这是位于 public_html/images 文件夹中的 .htaccess（我不知何故也不得不制作这个子文件夹，以将 URL 与 public_html 中的实际位置“匹配”。SetEnv PHP_VER 5_3

```
RewriteEngine On
# You must define your installation directory and uncomment the line :
RewriteBase /images/

RewriteRule ^([a-zA-Z]+)\.(jpg|gif|png|wbmp)$ controller/Resizer.php?m=original&a=$1&e=$2 [L]
RewriteRule ^(icon|small|medium|square)\/([a-zA-Z]+)\.(jpg|gif|png|wbmp)$ controller/Resizer.php?m=$1&a=$2&e=$3 [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule (.*) application.php?request=$1 [L,QSA] 
```

所以，基本上，这在某种程度上是行不通的。我想这个虚拟主机，子目录，重写或其他东西之间存在冲突，但我似乎无法隔离它。

有点令人困惑的是，当我打开 IP/images/xxxx.jpg 时，它会打开位于 public_html/images/upload/original 文件夹中的图像，因此重写工作正常。其他规则似乎不起作用。所有的缩略图和较小的版本都没有正确呈现（带有图标、小、中、方形），这使得该网站非常不可用。

这是开发服务器的链接：`http://localhost/images/`

提前感谢您的时间和帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:13:53.217

您应该做的第一件事是确定 mod_rewrite 是否确实是问题的一部分，方法是通过其重写的形式直接访问其中一个失败的 URL 并验证您是否获得了预期的结果。

实际上，问题可能只是用于较小分辨率的 PHP 脚本“不起作用”，而它适用于原始大小的分辨率。以下 URL 中的第一个很好地为我提供了图像；第二个应该给我相同图像的较小版本，但为我提供了 HTTP 500：

```
http://106.186.21.176/images/controller/Resizer.php?m=original&a=q&e=png  
http://106.186.21.176/images/controller/Resizer.php?m=small&a=q&e=png 
```

对于您帖子中提到的任何较小尺寸的格式名称，我得到了相同的结果（HTTP 500），这与您的问题描述相匹配。

一旦您确认脚本按预期工作，问题很可能出在 mod_rewrite 上。如果是这样，启用重写日志记录：使用[RewriteLog](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritelog)指令来激活它，并[使用 RewriteLogLevel](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewriteloglevel)来控制它的详细程度。尤其是在更高的日志级别，它可以为您提供关于它正在做什么的非常详细的信息。这应该使问题从日志中显而易见。

此外，如果可能，尽量避免在 .htaccess 文件中配置 mod_rewrite 规则——而是将它们移动到您的主服务器配置文件中。原因在[Apache mod_rewrite Technical Details](http://httpd.apache.org/docs/2.0/rewrite/rewrite_tech.html)的“API 阶段”部分中进行了解释：

> 令人难以置信的是 mod_rewrite 在每个目录上下文中提供 URL 操作，即在 .htaccess 文件中，尽管在 URL 被转换为文件名之后很长时间才能达到这些操作。必须这样，因为 .htaccess 文件存在于文件系统中，所以处理已经到了这个阶段。换句话说：根据此时的 API 阶段，任何 URL 操作都为时已晚。为了克服这个先有鸡还是先有蛋的问题，mod_rewrite 使用了一个技巧：当您在每个目录的上下文中操作 URL/文件名时，mod_rewrite 首先将文件名重写回其对应的 URL（这通常是不可能的，但请参阅下面的 RewriteBase 指令以获取技巧实现这一点），然后使用新的 URL 发起一个新的内部子请求。这将重新启动 API 阶段的处理。
> 
> mod_rewrite 再次努力使这个复杂的步骤对用户完全透明，但您应该记住：虽然在每个服务器上下文中的 URL 操作非常快速和高效，但由于这个鸡和蛋问题，每个目录的重写速度很慢而且效率低下. 但另一方面，这是 mod_rewrite 可以向普通用户提供（本地限制）URL 操作的唯一方式。

一般来说，根本不使用 .htaccess 有一个额外的优势，您可以告诉 Apache 甚至不要打扰和禁用所有功能，这使 Apache 不必扫描它为 .htaccess 文件提供服务的每个目录级别。

# facebook - Facebook SDK - 其余部分使用 JS 进行身份验证和 PHP？

> ID：14006123
> 
> 赞同：1
> 
> 时间：2012-12-22T19:59:25.693
> 
> 标签：facebook, facebook-javascript-sdk, facebook-php-sdk, facebook-oauth

我正在尝试同时使用 Facebook PHP 和 JS SDK，以创建一个可以兼作画布应用的 Web 应用。在当前设置中，当页面离开或一段时间并且系统恢复到登录屏幕时，我遇到了问题。重要的是，我没有使用动态域映射器，并且有一些可能的 URL /dev/、/dev/pool/、/dev/pool/edit/ 等，用户可能会访问和体验应用程序。

我四处阅读，发现使用 JS SDK 授权是正确的方法（我可能错了吗？），然后使用 PHP SDK 对其他所有内容进行排序就可以找到，自然地获得访问令牌。

我知道这是我的身份验证设置有问题，因为我有时会看到它重新加载，如果我在子页面上并且如果我不触摸该网站几分钟后，系统会无缘无故地尝试重新验证。

关于我做错了什么的任何想法？谢谢！

**这是我网站上设置的 JS：**

```
<div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: 'XXXXX',
      channelUrl: 'http://www.domain.com/channel.php',
      status: true,
      cookie: true,
      xfbml: true,
      oauth: true,
    });
    FB.Event.subscribe('auth.login', function(response) {
      alert('refreshing')
      window.location.reload();
    });
    FB.Event.subscribe('auth.logout', function(response) {
      window.location.reload();
    });
    FB.Canvas.setSize({ width: 810 });
    FB.Canvas.setAutoGrow();

  };

  (function(d, debug){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0]
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
     ref.parentNode.insertBefore(js, ref);
   }(document, /*debug*/ true));
</script> 
```

**这是调用 Facebook 对象的 PHP 流程**

```
$fb = new FbDoa();
if ($fb->isAuthed() === false) {
  echo $fb->getLoginButton();
}
else {
  echo $fb->getProfileInfo();
} 
```

* * *

**这是 FbDoa 对象 ( `$fb`) 的 PHP 内容：**

```
public function __construct() {
  require_once(Facebook/facebook.php');
  $this->facebook = new Facebook(array(
    'appId'  => 'XXXXX',
    'secret' => 'XXXXXXXXXX', 
    'cookie' => true,
  ));

  $this->user = $this->facebook->getUser();
  if ($this->user) {
    try {
      // Proceed knowing you have a logged in user who's authenticated.
      $this->user_profile = $this->facebook->api('/me');
    } catch (FacebookApiException $e) {
      //echo '<pre>'.htmlspecialchars(print_r($e, true)).'</pre>';
      $this->user = null;
    }
  }
}

public function isAuthed() {
  if ($this->user) {
    return true;
  }
  else {
    return false;
  }
}

public function getLoginButton() {
  $scope = 'email,user_likes,friends_likes,publish_actions,publish_stream,read_friendlists';
  return '<fb:login-button size="xlarge" perms="'.$scope.'"></fb:login-button>';
} 

public function getProfileInfo() {
  return $this->user_profile;
} 
```

* * *

* * *

更新 1： 真的好像`window.location.reload();`什么都没做，如果我一遍又一遍地点击登录按钮，什么也没有发生，但我刷新它就可以了。确实，应用程序的身份验证应该持续超过几分钟，这意味着我面前有一些问题。有任何想法吗？

更新 2：问题可能与我的服务器端代码有关？有人知道PHP+JS SDK吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T20:09:27.507

签名的请求保存在类似于 的 cookie 中`fbsr_appid`。从那你可以使用`code`来处理它。这是您的流程的外观

![验证混合流](../Images/5597556ebb129a96507f4ee58c64fa21.png)

只要您的应用设置中有一个基本网址，它就应该重定向到所有网址。

# azure - 自定义性能计数器触发安全异常。为什么？

> ID：14006129
> 
> 赞同：1
> 
> 时间：2012-12-22T20:00:08.823
> 
> 标签：azure, performancecounter

在我的应用程序中添加自定义性能计数器后，我在图像中得到了异常。我已经添加了提升的权限，我还应该尝试什么？我已经尝试了很长时间来解决这个问题，但没有结果......

谢谢你，请帮助...

```
 <Runtime executionContext="elevated" /> 
```

![在此处输入图像描述](../Images/bc2927141c19536233a1e0a0ead607d1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:20:06.287

使用 Web 角色，即使您将 executionContext 设置为“提升”，角色进程仍然无法获得操作系统的完全执行权限。因此，当您在 Web 角色中使用自定义性能计数器时，操作系统不允许这种情况发生，您会看到异常。

您可以做的是设置自定义性能计数器以在 RoleEntoryPoint 中的 Role OnStart() 方法中以完全权限执行。如果您检查您的 WebRole.cs，您可能会发现 RoleEntryPoint 如下所示来编写您的自定义性能计数器特定代码：

```
// webrole.cs
public class WebRole : RoleEntryPoint
{
    public override bool OnStart()
    {
        // Write here your customer performance counter code
        return base.OnStart();
    }
} 
```

# ruby-on-rails - 在视图中显示来自 api 的 JSON 响应

> ID：14006131
> 
> 赞同：2
> 
> 时间：2012-12-22T20:00:15.500
> 
> 标签：ruby-on-rails, ruby-on-rails-3, json, api, httparty

我正在尝试使用电影 id [http://docs.themoviedb.apiary.io/](http://docs.themoviedb.apiary.io/)使用电影数据库的默认响应从电影数据库中获取响应。以前没有这样做过，所以我敢肯定有很多错误。

所以我使用 gems httparty 和 json 并设置了一切像这样

控制器

```
require 'httparty'
require 'json'

class MainController < ApplicationController

 def index

 @response = HTTParty.get("http://api.themoviedb.org/3/movie/550?api_key="api_key")
 JSON.parse(response)
 end
 end 
```

和我的看法

```
<%= @response %> 
```

只是想看看返回了什么。

我收到错误无法将 ActionDispatch::Response 转换为 String

我想知道是否有人可以提供一些建议或一些资源来学习如何做到这一点，也许还有一些不同的方法来显示返回的信息。

我知道哈希是键/值的集合，但缺乏提取该数据的知识

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:05:01.500

我认为问题实际上是您的控制器，而不是您的视图。

```
JSON.parse(response) 
```

应该

```
JSON.parse(@response) 
```

您可能希望在您的视图中：

```
<%= @response.body %> 
```

# java - 如何将数据从一个 JList 复制到另一个 JList

> ID：14006132
> 
> 赞同：0
> 
> 时间：2012-12-22T20:00:26.253
> 
> 标签：java, jlist

所以，我有两个选项卡，它们都有 JList，它们都有一个存储数据的数组列表，现在我需要找到一种方法，可以将数据从一个选项卡中的一个 JList 复制到另一个 JList另一个标签。

坦斯克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:06:34.977

取决于您所拥有的和确切的意图，这可行，但随后他们将共享 ListModel，而不是复制：

```
list2.setModel(list1.getModel()); 
```

Else 循环遍历一个模型中的元素并添加到另一个模型中。

```
ListModel model = list1.getModel();
DefaultListModel list2Model = new DefaultListModel();
for (int i=0; i<model.getSize(); i++) {
  list2Model.addElement(model.elementAt(i);
}

list2.setModel(list2Model); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-08T05:01:35.647

好吧，首先你必须为每个 jList 设置模型

```
DefaultListModel listModel = new DefaultListModel();
DefaultListModel listModel2 = new DefaultListModel(); 
```

我认为您已将数据存储到第一个 jList 中，因此您只需将其传递到第二个 jList 中，如下所示：

```
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt)     {                                         
   int index=LV.getSelectedIndex();
   listModel2.addElement(LV.getSelectedValue());
   LV2.setModel(listModel2);
   listModel.remove(index);
} 
```

# php - 如果 HTML 文件已更新，则执行 JavaScript

> ID：14006136
> 
> 赞同：1
> 
> 时间：2012-12-22T20:01:25.553
> 
> 标签：php, javascript, jquery, refresh

我正在尝试在 JavaScript、jQuery 甚至 PHP 中找到一个插件或函数，如果有必要每 10 秒检查一次页面文件是否已更新，如果页面已更新，则向用户发出警报（）。

在此先感谢:) 对不起，如果我不够清楚。如果您有任何问题，请发表评论。

**编辑：**换句话说，使用客户端或服务器端脚本，向服务器发送 AJAX 请求并确定用户打开的当前页面是否已在服务器上被修改并显示警报。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T20:04:09.273

您可以每 10 秒向服务器发送一个 http HEAD 请求。这将使服务器只发送标头而不是内容。然后您可以检查“Last-Modified”响应标头。

jQuery 函数`$.ajax();`支持与此非常相似的功能。而是检查`Last-Modified`http 标头 jQquery 使用 http 标头向服务器发送请求`If-Modified-Since`。然后它检查服务器是否以响应代码 304 Not Modified 进行响应。

这是一个简短的 HTML + Javascript 示例，描述了 jQuery 功能：

```
<html>
  <head>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script type="text/javascript">
      var checkUrl="test.txt";
      var firstCheck = false;
      window.setInterval(checkForUpdate, 1000);

      function checkForUpdate() {
          $.ajax(checkUrl, {
              ifModified : true,
              type : 'HEAD', 

              success : function (response) {
                  if(firstCheck === false) {
                      firstCheck = true;
                      return;
                  }
                  $('#output').html('the site has been modified');
              }
          }); 
      }    
   </script> 
  </head>
  <body>
    <div id="output">Not Modified</div>
  </body>
</html> 
```

**但是**，上面的 jquery 示例对我**不起作用**- 使用 jQuery 1.8 和 firefox.(Linux) + apache2 web 服务器。尽管服务器以 304 Not Modified 响应，但仍将调用成功函数。

所以我将添加另一个**工作**示例来实现我上面的第一个建议，这里是 javascript 部分：

```
 var checkUrl="test.txt";
    window.setInterval("checkForUpdate()", 1000);
    var pageLoad = new Date().getTime();

    function checkForUpdate() {
        $.ajax(checkUrl, {
            type : 'HEAD',
            success : function (response, status, xhr) {
                if(firstCheck === false) {
                    firstCheck = true;
                    return;
                }
                // if the server omits the 'Last-Modified' header
                // the following line will return 0\. meaning that
                // has not updated. you may refine this behaviour...
                var lastModified = new Date(xhr.getResponseHeader('Last-Modified'))
                    .getTime();
                if(lastModified > pageLoad) {
                    $('#output').html('the site has been modified');
                }
            }
        }); 
    } 
```

# c++ - 功能对象无法正常工作

> ID：14006148
> 
> 赞同：0
> 
> 时间：2012-12-22T20:02:41.957
> 
> 标签：c++, cuda, gpu, gpgpu, thrust

我定义了以下函数对象：

```
struct Predicate1
{
   __device__ bool operator () 
       (const DereferencedIteratorTuple& lhs, const DereferencedIteratorTuple& rhs) 
  {
    using thrust::get;
    //if you do <=, returns last occurence of largest element. < returns first
    if (get<0>(lhs)== get<2>(lhs) && get<0>(lhs)!= 3) return get<1>(lhs) < get<1>(rhs); 
    else
    return true ;
  }
}; 
```

其中 DereferencedIteratorTuple 如下：

```
typedef thrust::tuple<int, float,int> DereferencedIteratorTuple; 
```

此外，我将其称为如下：

```
result =  thrust::max_element(iter_begin, iter_end, Predicate1()); 
```

但结果是元组 (3,.99,4)。我很困惑为什么这是结果，因为这个元组的条件`get<0>(lhs)== get<2>(lhs)`不成立。`if`因此，对于这个元组的每次比较，运算符都会返回 true。但是，`thrust::max_element`定义如下：

> “此版本使用函数对象 comp 比较对象。具体而言，此版本的 max_element 返回 [first, last) 中的第一个迭代器 i，这样，对于 [first, last) 中的每个迭代器 j，comp(*i, *j)是假的。”

因此，对于这个元组，没有办法选择它，运算符永远不会返回 false。请让我知道我做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T12:36:47.397

谓词帮助算法确定首选哪个元素。如果谓词返回`true`，则算法优先`rhs`于`lhs`. 如果它返回`false`，算法更`lhs`喜欢`rhs`. 在谓词总是返回的情况下`true`，算法将选择数组中的最后一个元素。这对于 stl 和推力算法都是如此。

我猜，你的结果从来没有像`lhs`在比较过程中那样出现，而且每次它都没有被过滤，因为 rhs 的第二个值小于 0.99。

如果你想过滤这些值，你最好重写你的谓词。

# android - Android SearchView 图标

> ID：14006150
> 
> 赞同：29
> 
> 时间：2012-12-22T20:03:07.393
> 
> 标签：android, android-actionbar, actionbarsherlock, searchview

我想禁用搜索视图组件内显示的 Mag 图标。知道如何引用它并将其删除或用另一个可绘制对象替换它吗？

![在此处输入图像描述](../Images/e6688fadc79386a799fe09b0344cea3d.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-01-12T20:39:20.503

由于问题的措辞不包含任何提及`ActionBarSherlock`（标签除外）并且已添加评论，即接受的答案不适用于标准和/或支持库操作栏，因此我发布了另一个答案。这是Java代码`onCreate`：

```
// obtain action bar
ActionBar actionBar = getSupportActionBar();

// find SearchView (im my case it's in a custom layout because of left alignment)
View v = actionBar.getCustomView();
SearchView searchView = (SearchView)v.findViewById(R.id.search_view);
ImageView icon = (ImageView)searchView.findViewById(android.support.v7.appcompat.R.id.search_mag_icon);

// method 1: does not work persistently, because the next line
// should be probably called after every manipulation with SearchView
// icon.setVisibility(View.GONE);

// method 2: working code
icon.setAdjustViewBounds(true);
icon.setMaxWidth(0);
icon.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
icon.setImageDrawable(null); 
```

[根据这篇[文章](http://wtanaka.com/node/8049)，当使用`SearchView`来自支持库（`android-support-v7-appcompat`在我的例子中）`setIconifiedByDefault(false)`的图标时，图标显示在编辑文本框（`SearchAutoComplete`）之外。否则 ( `setIconifiedByDefault(true)`) 它显示在框内。默认情况下，呈现的代码用于禁用“图标化”，并且可能需要进行一些更改才能与“图标化”搜索视图一起使用。我不知道是否同样适用于`ActionBarSherlock`.]

希望这可以帮助。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-01-26T10:45:10.660

这个图标是提示。所以你可以简单地设置新的提示文本。

```
int searchPlateId = searchView.getContext().getResources().getIdentifier("android:id/search_src_text", null, null);
    EditText searchPlate = (EditText) searchView.findViewById(searchPlateId);

    searchPlate.setHint("Search"); 
```

如果您想要图标作为提示文本，请使用带有 ImageSpan 的可扩展字符串

```
int searchPlateId = searchView.getContext().getResources().getIdentifier("android:id/search_src_text", null, null);
    EditText searchPlate = (EditText) searchView.findViewById(searchPlateId);

    searchPlate.setTextColor(getResources().getColor(R.color.search_text_color));
    SpannableString string = new SpannableString(" ");
    Drawable d = getResources().getDrawable(R.drawable.ic_search);
    d.setBounds(0, 0, d.getIntrinsicWidth(), d.getIntrinsicHeight());
    ImageSpan span = new ImageSpan(d, ImageSpan.ALIGN_BOTTOM);
    string.setSpan(span, 0, 1, Spannable.SPAN_INCLUSIVE_EXCLUSIVE);
    searchPlate.setHint(string); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-22T20:22:33.520

在您的主题中：

```
<style name="Theme" parent="Your parent theme">
<item name="android:searchViewSearchIcon">@android:drawable/ic_search</item>
</style> 
```

**编辑：**
`searchViewSearchIcon`是一个私有属性。因此，此答案不起作用（在本机 ActionBar 上）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-18T15:28:21.730

您必须在 MenuItem 中添加此行`android:iconifiedByDefault="@android:color/transparent"`

```
<item
    android:id="@+id/activity_home_action_search"
    android:icon="@drawable/ic_action_search"
    android:title="@string/activity_home_search_title"
    android:iconifiedByDefault="@android:color/transparent"
    app:actionViewClass="android.support.v7.widget.SearchView"
    app:showAsAction="always|collapseActionView" /> 
```

或者你可以以编程方式制作`searchView.setIconifiedByDefault(true);`

```
@Override
public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
    super.onCreateOptionsMenu(menu, inflater);
    getMenuInflater().inflate(R.menu.home, menu);

    MenuItem searchMenuItem = menu.findItem(R.id.activity_home_action_search);

    SearchView searchView = (SearchView) searchMenuItem.getActionView();
    searchView.setIconifiedByDefault(true);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-12T14:19:58.267

要删除提示搜索按钮：

```
mNearMeSearchBar = (SearchView) mView.findViewById(R.id.nearme_search_component_nearme_edittext);
mNearMeSearchBar.setIconifiedByDefault(false); //Removes Search Hint Icon 
```

要更改可绘制的搜索按钮：

```
int searchImgId = getResources().getIdentifier("android:id/search_mag_icon", null, null);
ImageView v = (ImageView) mNearMeSearchBar.findViewById(searchImgId);
v.setImageResource(R.drawable.ic_compass); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-05-24T16:33:57.640

您必须`SearchView`像这样自定义样式：

```
<style name="MySearchViewStyle" parent="Widget.AppCompat.SearchView">
    <!-- Search button icon -->
    <item name="searchIcon">@drawable/ic_arrow_back</item>
</style> 
```

然后将其添加到您的`AppTheme`.

```
<!-- Base application theme. -->
<style name="AppTheme" parent="Theme.AppCompat.Light.DarkActionBar">
    <!--   your other colors and styles -->
    <item name="searchViewStyle">@style/MySearchViewStyle</item>
</style> 
```

并使用标签将其应用于您的搜索视图`style`：

```
<android.support.v7.widget.SearchView
            xmlns:android="http://schemas.android.com/apk/res/android"
            xmlns:app="http://schemas.android.com/apk/res-auto"
            android:id="@+id/searchView"
            android:layout_height="wrap_content"
            android:layout_width="match_parent"
            app:queryHint="@string/search_hint"
            android:focusable="true"
            android:focusableInTouchMode="true"
            style="@style/MySearchViewStyle"
            app:iconifiedByDefault="false" /> 
```

希望能帮助到你！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-02-20T21:21:35.340

如果您使用的是 v7 应用兼容库，您可以在主题中轻松更改它。在从 AppCompat 主题扩展的主题中，只需添加如下一行：

```
<item name="searchViewSearchIcon">@drawable/ic_search</item> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-02T19:37:43.237

这些行去掉了放大镜：

```
 //remove search icon
    mSearchView.setIconifiedByDefault(false);
    ImageView icon = (ImageView) mSearchView.findViewById(android.support.v7.appcompat.R.id.search_mag_icon);
    icon.setVisibility(View.GONE); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-18T02:50:34.413

在您的主题风格中包括：

```
<style name="YourTheme.Toolbar">
    <item name="searchViewStyle">@style/YourActionBarSearch</item>
    <item name="editTextColor">@color/your_ab_text_color</item>
    <item name="android:textColorHint">@color/your_ab_hint_color</item>
</style> 
```

您现在可以使用 定义 SearchView 的样式`searchViewStyle`，`editTextColor`并将设置搜索框中文本的颜色。通过设置`android:textColorHint`，您还将设置提示的颜色，例如“搜索...”。

```
<style name="YourActionBarSearch" parent="@style/Widget.Holo.SearchView">
    <item name="searchIcon">@drawable/ic_ab_search</item>
    <item name="queryBackground">@null</item>
    <item name="submitBackground">@null</item>
    <item name="searchHintIcon">@null</item>
    <item name="defaultQueryHint">@null</item>
    <item name="closeIcon">@drawable/ic_ab_small_search_close</item>
</style> 
```

这将或多或少地为您的搜索视图设置样式。该字段`searchIcon`是操作栏中的图标。**该字段`searchHintIcon`**是您在问题中要求**的搜索字段中提示左侧的小图标；**将其设置`@null`为删除图标。该字段`closeIcon`是搜索字段右侧的关闭图标。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-10-11T18:12:53.620

在 searchView 组件的 xml 中添加下一个：

```
app:searchHintIcon="@null" 
```

# javascript - 如何从地图中删除带有绑定圆圈的标记？

> ID：14006156
> 
> 赞同：2
> 
> 时间：2012-12-22T20:04:17.187
> 
> 标签：javascript, google-maps-api-3

我确实将圆圈与标记绑定以使视图如下：

![在此处输入图像描述](../Images/4971a869c1a599bd0e89fb09bbb13e1b.png)

但是当我尝试从地图上删除标记时，圆圈仍然存在。唔，

如何删除带圆圈的标记？

**相关代码：**

```
 function removeMarker(){
    if(selectedMarker)
       selectedMarker.setMap(null);      
}

....

function createCircle()
{
                var circle = {
                strokeColor: "#006DFC",
                strokeOpacity: 0.4,
                strokeWeight: 2,
                fillColor: "#006DFC",
                fillOpacity: 0.15,
                map: mapA,
                center: selectedMarker.getPosition(),
                radius: 50 // in meters
            };
            var cityCircle = new google.maps.Circle(circle);    

            cityCircle.bindTo('center', selectedMarker, 'position');
} 
```

任何建议，将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:21:46.500

如果要在删除标记时删除圆圈，则还需要将其删除。

```
 cityCircle.setMap(null); 
```

您需要保留对圆圈的引用才能做到这一点（未经测试）：

```
function removeMarker(){
  if(selectedMarker)
    selectedMarker.setMap(null); 
    selectedMarker._mycityCircle.unbindAll();
    selectedMarker._mycityCircle.setMap(null);  
}

....

function createCircle()
{
  var circle = {
    strokeColor: "#006DFC",
    strokeOpacity: 0.4,
    strokeWeight: 2,
    fillColor: "#006DFC",
    fillOpacity: 0.15,
    map: mapA,
    center: selectedMarker.getPosition(),
    radius: 50 // in meters
  };

  cityCircle.bindTo('center', selectedMarker, 'position');
  selectedMarker._mycityCircle = cityCircle;
} 
```

# postgresql - Postgresql 9.1 依赖问题

> ID：14006157
> 
> 赞同：2
> 
> 时间：2012-12-22T20:04:26.070
> 
> 标签：postgresql, ubuntu

我使用**Ubuntu 12.04**并且刚刚运行

```
sudo apt-get upgrade 
```

...并最终收到此错误消息...

```
 dpkg: dependency problems prevent configuration of postgresql-9.1:
 postgresql-client-9.1 (9.1.7-0ubuntu12.04) breaks postgresql-9.1 (<< 9.1.7-0ubuntu12.04) and is installed.
  Version of postgresql-9.1 to be configured is 9.1.6-1~precise2.
dpkg: error processing postgresql-9.1 (--configure):
 dependency problems - leaving unconfigured
No apport report written because MaxReports is reached already
                                                              Errors were encountered while processing:
 postgresql-9.1
E: Sub-process /usr/bin/dpkg returned an error code (1) 
```

我看到这是一个依赖问题，但**我不知道如何解决它**......我运行了 sudo apt-get -f install 并没有解决任何问题......

*旁注：我从存储库 ppa:pitti/postgresql 安装了 postgres，如果这很重要的话。*

# python - 尝试将 output.write 与 UTF-8 str 一起使用并得到错误（python 3.x）

> ID：14006158
> 
> 赞同：0
> 
> 时间：2012-12-22T20:04:41.553
> 
> 标签：python, string, utf-8, output

我正在使用以下代码打印（到文件） UTF-8 str ：

```
output.write(currentWord.m_wordHeb) 
```

也试过：

```
output.write(currentWord.m_wordHeb.encode('utf-8') 
```

并补充说：

```
import sys
import codecs

sys.stdout = codecs.getwriter('utf8')(sys.stdout) 
```

不断出错......通常是这个：

```
UnicodeEncodeError: 'charmap' codec can't encode characters in position 0-2: character maps to <undefined> 
```

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T20:30:15.177

在 python 3 中，您只能对字符串进行编码。如果您当前有字节，那是因为您的方法正在返回它们。例如，如果您从文件中读取字节，则应尽快将它们解码为字符串。只有这样，您才能将它们编码为 utf-8。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T08:54:45.603

问题已解决，我为写入而打开的文件没有像 utf-8 那样打开。因此，当我将“打开命令”更改为以下内容时：

```
codecs.open("C:\\NLP\\output.txt", "w", "utf-8" ) 
```

一切似乎都解决了。

谢谢 ！

# mono - 从 Xamarin Mono for Android 项目中引用 PCL（可移植类库）

> ID：14006159
> 
> 赞同：7
> 
> 时间：2012-12-22T20:04:56.600
> 
> 标签：mono, xamarin.android, xamarin

我正在使用 Mono for Android 创建一个 Android 应用程序。

我想引用我在这个项目中编写的其他一些库（编译为可移植类库）。

每当我尝试这样做时，都会收到一条错误消息：**“当前项目不支持对便携式库项目的引用。”。**

有什么办法可以克服这个吗？

引用已编译的项目输出就可以了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T22:24:04.747

查看[Stuart Lodge](http://slodge.blogspot.com/2012/12/cross-platform-winrt-monodroid.html)的这篇关于在各种平台上使用 PCL 的文章，包括 Android 的 Mono。它经历了您需要采取的不同步骤以使其正常工作，以及您在此过程中可能遇到的许多问题。

# ruby-on-rails - 嵌套路由且无路由匹配

> ID：14006163
> 
> 赞同：1
> 
> 时间：2012-12-22T20:05:29.190
> 
> 标签：ruby-on-rails, nested-routes

我有三个资源-`users`和。我只是嵌套在下面并相应地更新了我的链接，但是我从 rspec 收到两个错误，这对我来说完全是个谜。在我嵌套路线之前一切正常。`lists``items``lists``users`

我是 Rails 的新手，非常感谢任何帮助！

```
 1) Authentication authorization for non-signed-in users in the Lists controller submitting to the destroy action 
     Failure/Error: before { delete user_list_path(user, FactoryGirl.create(:list)) }
     ActiveRecord::RecordInvalid:
       Validation failed: Email has already been taken
     # ./spec/requests/authentication_pages_spec.rb:84:in `block (6 levels) in <top (required)>'

  2) User pages profile page 
     Failure/Error: before { visit user_path(user) }
     ActionView::Template::Error:
       No route matches {:action=>"show", :controller=>"users", :id=>nil}
     # ./app/views/shared/_user_info.html.erb:1:in `_app_views_shared__user_info_html_erb__1836116684083464018_70145329446120'
     # ./app/views/users/show.html.erb:4:in `_app_views_users_show_html_erb___902249955135429148_70145329432180'
     # ./spec/requests/user_pages_spec.rb:12:in `block (3 levels) in <top (required)>' 
```

路线.rb

```
MyApp::Application.routes.draw do
  resources :users do
    resources :lists, only: [:show, :create, :destroy]
  end
  resources :items, only: [:show, :create, :destroy]
  resources :sessions, only: [:new, :create, :destroy] 
```

用户.rb

```
class User < ActiveRecord::Base
  attr_accessible :name, :email, :password, :password_confirmation
  has_secure_password
  has_many :lists, dependent: :destroy
  has_many :items, through: :lists 
```

列表.rb

```
class List < ActiveRecord::Base
  attr_accessible :name
  belongs_to :user
  has_many :items, dependent: :destroy 
```

项目.rb

```
class Item < ActiveRecord::Base
  attr_accessible :link, :list_id, :title
  belongs_to :list 
```

**更新**

user_pages_spec.rb

```
require 'spec_helper'

describe "User pages" do

  subject { page }

  describe "profile page" do
    let(:user) { FactoryGirl.create(:user) }
    let!(:l1) { FactoryGirl.create(:list, user: user, name: "Foo") }
    let!(:l2) { FactoryGirl.create(:list, user: user, name: "Bar") }

    before { visit user_path(user) }

    it { should have_selector('h1',    text: user.name) }
    it { should have_selector('title', text: user.name) }

    describe "lists" do
      it { should have_content(l1.name) }
      it { should have_content(l2.name) }
      it { should have_content(user.lists.count) }
    end
  end

  describe "lists page" do
    let(:user) { FactoryGirl.create(:user) }
    let!(:l1) { FactoryGirl.create(:list, user: user, name: "Foo") }
    let!(:i1) { FactoryGirl.create(:item, list: l1, title: "Shirt") }

    before { visit user_list_path(user, l1) }

    it { should have_content(i1.title) }
    it { should have_content(l1.items.count) }
  end
... 
```

**更新 2**

users_controller.rb

```
class UsersController < ApplicationController
  before_filter :signed_in_user, only: [:edit, :update]
  before_filter :correct_user,   only: [:edit, :update]

  def show
    @user = User.find(params[:id])
    @lists = @user.lists
    @list = current_user.lists.build if signed_in?
  end

  def new
    @user = User.new
  end

  def create
    @user = User.new(params[:user])
    if @user.save
      sign_in @user
      flash[:success] = "Welcome to Wishlistt!"
      redirect_to @user
    else
      render 'new'
    end
  end

  def edit
  end

  def update
    if @user.update_attributes(params[:user])
      flash[:success] = "Profile updated"
      sign_in @user
      redirect_to @user
    else
      render 'edit'
    end
  end

  private

    def correct_user
      @user = User.find(params[:id])
      redirect_to(root_path) unless current_user?(@user)
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:14:35.040

您的第一个错误是告诉您您正在创建的用户无效，因为已经创建了具有该电子邮件的用户。（未能通过电子邮件唯一性验证）您可以通过更改用户工厂以对电子邮件进行排序来解决此问题，以便每条记录都是唯一的，如下所示：

```
sequence(:email) { |n| "User#{n}@example.com"} 
```

由于完全相同的原因，第二次测试失败了。由于您的用户记录为零，因此您实际上是在尝试从数据库中获取不存在的记录。它告诉你这一行：

```
No route matches {:action=>"show", :controller=>"users", :id=>nil} 
```

通过让 user = nil，您的 show 操作中会发生以下情况：

```
your implementation will look something like this:
#####
@user = User.find(params[:id])
##### 
```

因为 params[:id] = nil，你得到

```
User.find(nil) 
```

这将失败，因为没有 id 为 nil 的用户记录。您的其余实施应该没问题。

# linux - 保护在 apache 服务器上运行的每个站点的源代码

> ID：14006164
> 
> 赞同：-1
> 
> 时间：2012-12-22T20:05:42.513
> 
> 标签：linux, apache, ssh, ftp, ext4

我已经设置了一个 apache 服务器实例（在 ubuntu 12.04 上）并在其上托管了两个 php 网站。网站由不同的团队维护，他们不希望其他团队可以看到代码。

网站代码位于目录 /etc/sites/team1 和 /etc/sites/team2 中。两个团队都可以通过 FTP 访问服务器（使用 vsftpd）。网络服务器使用属于 www-data 组的用户 www-data 的凭据运行。这意味着站点目录中存在的所有文件都必须具有用户 www-data 或组 www-data 的读取权限。当用户通过 FTP 客户端上传文件时，文件的所有者和组被设置为 FTP 用户的用户和组。

如何将每个通过 FTP 服务器上传的默认组设置为 www-data？

一种方法是将 FTP 用户的默认组设置为 www-data，但在这种情况下，两个站点的 FTP 用户都将拥有组 www-data，并且每个文件至少具有该组的读取权限，他们将能够看到彼此的代码。

保护源代码的正确方法是什么，以便 apache 服务器可以访问它们，但其他团队不能访问它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:15:42.163

对我来说，一个快速的解决方案是为每个网站设置单独的用户组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-25T20:48:14.377

虽然 ravdhaw 解决方案是正确的，但我还建议查看 vsftpd 的监狱可能性。您可以将用户监禁在他们自己的 Web 目录中，这将是他们能够看到的唯一目录。您可以在 serverfault 上检查此答案：

[https://serverfault.com/questions/229664/jail-linux-user-to-directory-for-ftp-login](https://serverfault.com/questions/229664/jail-linux-user-to-directory-for-ftp-login)

您应该检查 suphp 这将使您的安装更加安全，因为这些进程将由文件所有者运行，因此无法访问其他用户文件。

# ios - 将多个 UIImageView 组合到一个 UIImageView 中

> ID：14006167
> 
> 赞同：0
> 
> 时间：2012-12-22T20:06:16.897
> 
> 标签：ios

我想知道是否可以在一个图像视图中组合更多 UIImageViews。例如，如果我有 4 个 imageViews，并且我想以完全相同的方式为它们设置动画，我可以将它们组合成一个，并为单个图像设置动画吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T20:23:56.540

为什么不将几个 UIImageView 组合成一个 UIView？如果整个想法是同时显示多个 UIImage，我认为将它们绘制到一个容器中没有任何优势。

这是一个例子：

```
UIImageView *iv1 = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"img1"]];
UIImageView *iv2 = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"img1"]];
UIView *mainView = [[UIView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, iv1.frame.size.width + iv2.frame.size.width, MAX(iv1.frame.size.height,iv2.frame.size.height))];
[mainView addSubview:iv1];
iv2.frame = CGRectMake(iv1.frame.size.width, 0.0f, iv2.frame.size.width, iv2.frame.size.height);
[mainView addSubview:iv2]; 
```

# java - ubuntu中的java运行时错误

> ID：14006168
> 
> 赞同：3
> 
> 时间：2012-12-22T20:06:20.900
> 
> 标签：java, ubuntu, runtime-error

```
jagadeesh@jagadeesh-PC:~$ cd Programs
jagadeesh@jagadeesh-PC:~/Programs$ javac demo.java
jagadeesh@jagadeesh-PC:~/Programs$ java demo
Exception in thread "main" java.lang.UnsupportedClassVersionError: demo : Unsupported major.minor version 51.0
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:73)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:212)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
Could not find the main class: demo. Program will exit.
jagadeesh@jagadeesh-PC:~/Programs$ echo $CLASSPATH

jagadeesh@jagadeesh-PC:~/Programs$ 
```

* * *

我确定没有设置类路径。谁能给我关于类路径，javahome 等的详细解释。我在各个站点都遇到了这些术语，但我无法清楚地理解它们。我想解释一下应该包含在类路径中的路径以及如何去做。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:08:31.573

不，我认为这不是类路径问题。我认为您的版本更可能`javac`是版本 7，而是`java`版本 6。

运行`javac -version`并`java -version`检查。然后找出你从哪里运行每个，使用`which javac`和`which java`。然后要么显式运行 Java 7，要么升级以便在任何地方运行 Java 7，或者使用`javac -source 1.6 -target 1.6 demo.java`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:08:25.463

类路径与您的问题无关：

问题是，您使用另一个编译器 (javac) 编译了 java 源代码作为您想要尝试运行代码的 JVM (java)。

看起来 javac 发出了您的 JVM 无法解释的类文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T20:15:26.717

在 JDK 版本 7 上编译的 Java 类无法使用 JRE 版本 6 或低于 7 的任何版本执行。尝试查找系统上安装的 JDK 和 JRE 版本。如需更多帮助，请参阅：

[如何在 linux 上查找 JDK/JRE 版本](http://www.cyberciti.biz/faq/ubuntu-linux-find-jdk-version/)

# java - MVC：如何为未知模型正确创建视图

> ID：14006175
> 
> 赞同：1
> 
> 时间：2012-12-22T20:07:20.950
> 
> 标签：java, model-view-controller, view, model, controller

假设我有一个超类，`Model`. 假设我也有两个子类，`NumberModel`and `StringModel`，一个存储一个数字，另一个存储一个字符串。为了实现 MVC 方案，我制作了两个视图，`NumberView`它们`StringView`可以编辑和显示模型数据。

然后我有一个`Model`s列表。不幸的是，现在我不知道哪个`Model`s 处理数字和字符串，所以如果我想为所有这些创建视图，我会打破面向对象的范式。

*除非...*

我在`Model`调用`constructView()`中创建了一个方法，该方法返回一个适当的视图并在子类中覆盖它。但是突然间，我让模型意识到了视图，这在 MVC 方案中也感觉不好。

从设计的角度来看，实现这一点的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:13:12.143

也许[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)/[双重调度](http://en.wikipedia.org/wiki/Double_dispatch)是要走的路？它有点复杂，如果你只有两个模型/视图，可能会过于复杂。这可能不是最优雅的解决方案，但这里有：

```
/* Adding a new model involves adding a new method to this base class. Not very 
 * elegant but that's the way the pattern works...  */
public class View {
    public void render(AModel model) { /* implement in subclass */ }    
    public void render(BModel model) { /* implement in subclass */ }
}

/* Providers provides the views with models, and serves to decouple
 * models from views */
public interface ModelProvider { 
    public void renderWith(View view); 
}

public class AModelProvider implements ModelProvider {
    private final AModel _model;
    public void renderWith(View  view) { view.render(_model); }
}

public class BModelProvider implements ModelProvider { 
    private final BModel _model;
    public void renderWith(View  view) { view.render(_model); }
}

public class AView extends View { 
    public void render(AModel model) { 
        model.doA(); 
    } 
}

public class BView extends View { 
    public void render(BModel model) { 
        model.doB(); 
    } 
}

public class Controller {
    public void renderModels(List<ModelProvider> providers, View view) {
        for (ModelProvider provider : providers) {
            // if provider is an AModelProvider and view is an AView,
            // render(AModel) will be called. If provider is a BModelProvider
            // or if view is BView, nothing will happen since the empty
            // View base class methods will be called...
            provider.renderWith(view);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:12:44.437

我认为控制器应该根据模型中的值来决定使用哪个视图，这样模型就不知道要渲染哪个视图。只有控制器有知识。

# c# - XNA 从 spritesheet 获取颜色数据会使游戏崩溃

> ID：14006177
> 
> 赞同：2
> 
> 时间：2012-12-22T20:07:31.977
> 
> 标签：c#, xna, collision

我正在使用 C# 在 XNA 中构建一个小型自上而下的射击游戏，并且我正在尝试实现每像素碰撞检测。我有以下代码来执行此操作，以及返回包含碰撞的矩形的标准边界框检测。

```
private bool perPixel(Rectangle object1, Color[] dataA, Rectangle object2, Color[] dataB)
    {
        //Bounds of collision
        int top = Math.Max(object1.Top, object2.Top);
        int bottom = Math.Min(object1.Bottom, object2.Bottom);
        int left = Math.Max(object1.Left, object2.Left);
        int right = Math.Min(object1.Right, object2.Right);

        //Check every pixel
        for (int y = top; y < bottom; y++)
        {
            for (int x = left; x < right; x++)
            {
                //Check alpha values
                Color colourA = dataA[(x - object1.Left) + (y - object1.Top) * object1.Width];
                Color colourB = dataB[(x - object2.Left) + (y - object2.Top) * object2.Width];

                if (colourA.A != 0 && colourB.A != 0)
                {
                    return true;
                }
            }
        }
        return false;
    } 
```

我很确定这会起作用，但我也试图从精灵表中获取一些要检查的对象，并且我正在尝试使用此代码来获取颜色数据，但它得到了一个错误说“传入的数据大小对于这个资源来说太大或太小”。

```
 Color[] pacmanColour = new Color[frameSize.X * frameSize.Y];

                pacman.GetData(0, new Rectangle(currentFrame.X * frameSize.X, currentFrame.Y * frameSize.Y, frameSize.X, frameSize.Y), pacmanColour,
                    currentFrame.X * currentFrame.Y, (sheetSize.X * sheetSize.Y)); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:57:47.877

让我向您展示我处理 Texture2D 颜色的方法

我使用以下技术从文件加载预制结构

```
//Load the texture from the content pipeline
Texture2D texture = Content.Load<Texture2D>("Your Texture Name and Directory");

//Convert the 1D array, to a 2D array for accessing data easily (Much easier to do Colors[x,y] than Colors[i],because it specifies an easy to read pixel)
Color[,] Colors = TextureTo2DArray(texture); 
```

而且功能...

```
 Color[,] TextureTo2DArray(Texture2D texture)
    {
        Color[] colors1D = new Color[texture.Width * texture.Height]; //The hard to read,1D array
        texture.GetData(colors1D); //Get the colors and add them to the array

        Color[,] colors2D = new Color[texture.Width, texture.Height]; //The new, easy to read 2D array
        for (int x = 0; x < texture.Width; x++) //Convert!
            for (int y = 0; y < texture.Height; y++)
                colors2D[x, y] = colors1D[x + y * texture.Width];

        return colors2D; //Done!
    } 
```

它将返回一个简单易用的二维颜色数组，因此您可以简单地检查 Colors[1,1]（对于像素 1,1）是否等于任何值。

# perl - 无法在 Perl 中执行 git 命令

> ID：14006184
> 
> 赞同：1
> 
> 时间：2012-12-22T20:08:18.050
> 
> 标签：perl, git

你好！我跑步没问题

> git log --grep="cherrypick" --all >cherrypicklog.txt

从命令行。但是它无法在 Perl 中执行。

```
my $result = `git log --grep="cherry picked from commit" --all > cherrypicklog.txt`; 
```

`git`不被识别为内部或外部命令、可运行程序或批处理文件。

我错过了什么？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:10:52.127

我对 perl 了解不多，但我认为这只是 git 不在`PATH`您的 perl 脚本中的环境中的一般情况。尝试使用绝对路径：

```
my $result = `/path/to/bin/git log --grep="cherry picked from commit" --all > cherrypicklog.txt`; 
```

# c++ - C++ 默认初始化

> ID：14006186
> 
> 赞同：1
> 
> 时间：2012-12-22T20:08:30.580
> 
> 标签：c++

根据 Stanley Lipmann 的 C++ Primer（第 4 版），第 50 页上说：

> “在任何函数体之外定义的变量都被初始化为 0。”

根据我阅读的内容，这似乎不是真的。

全局`char`默认为空白而不是 0。

将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T20:11:01.140

Stanley 是正确的 -*具有静态存储持续时间的对象在任何其他初始化发生之前被初始化为零*。

因此，在您的术语中，全局“默认”`char` *为*`0`. 这是整数`0`，而*不是*字符`'0'`（通常是`48`）。当您尝试将其流式传输到控制台时，您将看不到任何内容，因为此`char`值没有人类可读的表示。

如果您的意思是全局`char*`or `char const*`，那么这也“默认”为`0`，即它将是一个空指针。这*与*指向空字符串的指针不同。尝试流式传输这将导致未定义的行为，因此您什么也看不到，或者您可以看到我妈妈的番茄汤食谱以 20Hz 的解释性舞蹈形式呈现在 ASCII 艺术翻译层后面。

两者都不会是“空白”，尽管不知道“空白”在这里意味着什么，我不能绝对肯定地说。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-22T20:15:51.623

尝试这个：

```
#include <iostream>
char global;

int main()
{
    std::cout << "Value of Global " << ((int)global) << "\n";
} 
```

`global`这是一个静态存储持续时间对象，因此将被零初始化。
我将它（非常懒惰地）转换为一个整数，以便流将打印出它的值（而不是字符），只是为了表明它为零。

打印出 char '\0' 不会打印任何有用的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-22T20:10:32.560

`'0'`不是`0`。当它状态*初始化为 0*时，它表示值`0`（也是`\0`or `NULL`），而不是字符`'0'`（在 ASCII 编码中为 48）。

# javascript - 处理并保持 node.js/express 会话

> ID：14006190
> 
> 赞同：2
> 
> 时间：2012-12-22T20:08:57.423
> 
> 标签：javascript, node.js, express, redis

我目前正在开发一个网络应用程序，每次都会`fs.mkdir`调用这个网络应用程序，删除所有当前的快速会话，所以我需要一种方法来保留所有这些会话。我试图用 connect-mongodb 和 connect-redis 来保留所有这些会话，但都不起作用，nodemon 总是说 req.session 是未定义的。我不知道我必须做什么才能保留所有会话。

我需要一种方法来保留所有会话，在执行时不要丢失它们`fs.mkdir`，以及它的教程，因为我还没有找到任何好的和完整的教程，任何人都可以工作！我在 Stackoverflow 中阅读了与此相关的所有内容，但一切正常！请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:15:27.233

这听起来很异国情调，在`fs.mkdir`你的会议被抹去之后。（我发现了你的另一个 SO 问题）

但回到这个问题，这里有一个小代码片段，你可以如何使用会话（redis）。

```
var express = require('express')
  , fs = require('fs')
  , http = require('http')
  , RedisStore = require('connect-redis')(express)
  , sessionStore = new RedisStore()
  , app = express()
  ;

app.configure(function(){
  app.set('port', 3000);
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('secret'));
  app.use(express.session({
    store: sessionStore
  }));
  app.use(express.static(__dirname + '/public'));
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true }));
});

app.get( '/', function(req, res){
  res.setHeader("Content-Type", "text/html");
  console.log( req.session );
  console.log( '------------------------' );
  res.end( 'root' );
});

app.get( '/dir/:id', function(req, res){
  console.log( req.session );
  console.log( '------------------------' );

  fs.mkdir( req.params.id );
  if ( req.session.dirs === undefined )
    req.session.dirs = [];
  req.session.dirs.push( req.params.id );

  console.log( req.session );
  console.log( '------------------------' );

  res.setHeader("Content-Type", "text/html");
  res.end( 'dir' );
});

server = http.createServer(app).listen(3000); 
```

您应该阅读[express](http://expressjs.com)的文档，并浏览express的[示例](https://github.com/visionmedia/express/tree/master/examples/session)

# java - java.lang.IllegalArgumentException：Ormlite 游标不存在列“_id”

> ID：14006192
> 
> 赞同：1
> 
> 时间：2012-12-22T20:09:06.037
> 
> 标签：java, android, ormlite

我正在使用 Ormlite with `CursorLoader`，使用[ormlite-extras](https://github.com/campnic/ormlite-android-extras)库（我使用该包`support.extras`，因为我打算针对 android 2.2 及更高版本）。

我有以下例外：

```
FATAL EXCEPTION: main
java.lang.IllegalArgumentException: column '_id' does not exist
    at android.database.AbstractCursor.getColumnIndexOrThrow(AbstractCursor.java:314)
    at android.support.v4.widget.CursorAdapter.swapCursor(CursorAdapter.java:344)
    at rainstudios.meleo.ui.eventlv.EventLvFragment.onLoadFinished(EventLvFragment.java:274)
    at rainstudios.meleo.ui.eventlv.EventLvFragment.onLoadFinished(EventLvFragment.java:1)
    at android.support.v4.app.LoaderManagerImpl$LoaderInfo.callOnLoadFinished(LoaderManager.java:427)
    at android.support.v4.app.LoaderManagerImpl$LoaderInfo.onLoadComplete(LoaderManager.java:395)
    at android.support.v4.content.Loader.deliverResult(Loader.java:103)
    at rainstudios.meleo.data.RainstudiosOrmliteCursorLoader.deliverResult(RainstudiosOrmliteCursorLoader.java:68)
    at rainstudios.meleo.data.RainstudiosOrmliteCursorLoader.deliverResult(RainstudiosOrmliteCursorLoader.java:1)
    at android.support.v4.content.AsyncTaskLoader.dispatchOnLoadComplete(AsyncTaskLoader.java:221)
    at android.support.v4.content.AsyncTaskLoader$LoadTask.onPostExecute(AsyncTaskLoader.java:61)
    at android.support.v4.content.ModernAsyncTask.finish(ModernAsyncTask.java:461)
    at android.support.v4.content.ModernAsyncTask.access$500(ModernAsyncTask.java:47)
    at android.support.v4.content.ModernAsyncTask$InternalHandler.handleMessage(ModernAsyncTask.java:474)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:130)
    at android.app.ActivityThread.main(ActivityThread.java:3835)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:507)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:847)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:605)
    at dalvik.system.NativeStart.main(Native Method) 
```

我做了一些挖掘并注意到CursorLoader 中的代码返回的确实`'_id'`不存在。`results`

有关更多信息，请参阅上面的代码：

```
/* Runs on a worker thread */
@Override
public Cursor loadInBackground() {
    Cursor cursor = null;
    try {
        CloseableIterator<T> iterator = mDao.iterator(mQuery);

        // get the raw results which can be cast under Android
        AndroidDatabaseResults results = (AndroidDatabaseResults) iterator
                .getRawResults();
        cursor = results.getRawCursor();
    } catch (SQLException e) {
        e.printStackTrace();
    }
    if (cursor != null) {
        // Ensure the cursor window is filled
        cursor.getCount();
        registerContentObserver(cursor, mObserver);
    }
    return cursor;
} 
```

使用调试器，显示如下：

```
results.columnNameMap = [id, code, name, popular, rating, voteCount, shortDescription, description, hoursDescription, url, modificationDate, syncDate, artist_id, district_id, pictures, frontPicture, userRating, venue_id, userComment, userFavorite, situation_id, caFrontPictureId, caResources]

results.columnNames = {syncDate=11, userRating=16, district_id=13, pictures=14, userFavorite=19, artist_id=12, code=1, situation_id=20, frontPicture=15, voteCount=5, url=9, caResources=22, id=0, hoursDescription=8, userComment=18, shortDescription=6, description=7, popular=3, name=2, venue_id=17, rating=4, caFrontPictureId=21, modificationDate=10} 
```

准备好的查询的创建非常标准：

```
public PreparedQuery<EventDb> findAllEventsQuery() {
    try {

        QueryBuilder<EventDb, Integer> eventQb = getEventDao()
                .queryBuilder();
        return eventQb.prepare();

    } catch (Throwable e) {
        Out.handleSilentError("Cannot retrieve all events", e);
    }
    return null;
} 
```

我进行了执行查询的测试并将结果作为 List 获取：一切正常。

现在，我很困惑。

此外，我还有一个给 ormlite 专家的。

*   我应该通过调用来关闭迭代器`iterator.closeQuietly()`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-22T17:32:10.303

正如@patheticpat 所指出的，该解决方案在stackoverflow 上可用：[ORMLite with CursorAdapter in Android](https://stackoverflow.com/questions/12416964/ormlite-with-cursoradapter-in-android)

您的 id 字段**需要**映射到名为 _id 的列才能在`Ormlite`4.42 中使用 Cursor。

像这样 ：

```
@DatabaseTable(tableName = "event")
public class EventDb extends BaseDaoEnabled<EventDb, Integer> {

    @DatabaseField(generatedId = true, columnName = "_id")
    int id; 
```

注意：你不能打电话`iterator.closeQuietly()`，因为它崩溃了。我希望没有内存泄漏，因为如果那样的话。

# io - “从 I/O 端口读取一个字节”与“从内存地址读取一个字节”？

> ID：14006193
> 
> 赞同：1
> 
> 时间：2012-12-22T20:09:06.540
> 
> 标签：io, cpu-architecture, dma, instruction-set, machine-instruction

为了简化讨论，我假设只有一个执行线程。以下只是我的胡思乱想：

1、如果CPU从内存地址读取一个字节，那么它可以从同一个地址重复读取同一个值。

2、如果CPU从一个端口重复读取一个字节，那么每次读取的值可能不同。

我认为这两种方式的区别在于端口控制器可以在每次读取操作后**自动更新**端口上的值。

但是，我找不到任何明确支持我的陈述的教科书。

我对么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-08T21:48:11.003

IO 指令应该与硬件交互。因此，IO 指令通常不（也不应该）符合内存语义。相反，语义取决于它们与之通信的硬件（和相应的协议）。不要将 IO 空间视为内存。

内存指令可以访问内存以及内存映射 IO。当它们访问内存映射的 IO 时，它们的行为类似于 IO 指令。只有当他们访问真实内存时，内存语义才适用。例如，这意味着对内存位置的读取始终返回写入该位置的最后一个值。

CPU 区分用于内存映射 IO 和实内存的地址空间非常重要。例如，来自内存映射 IO 的数据不得存储在缓存中，内存指令不得*推测性*地访问内存映射 IO 位置。因此，访问内存映射的 IO 空间比访问实际内存要慢得多。

为了区分内存映射 IO 和实际内存，处理器通常使用[页表](http://en.wikipedia.org/wiki/Page_table)，但还有其他机制，如[内存类型范围寄存器](http://en.wikipedia.org/wiki/Memory_type_range_register)。

最后同样重要的是，可能还有其他硬件能够写入内存。示例是具有多核和/或[直接内存访问](http://en.wikipedia.org/wiki/Direct_memory_access)的系统。这些系统需要相互了解并使用[缓存一致性协议](http://en.wikipedia.org/wiki/Cache_coherence#Coherency_protocol)来维护正确的内存语义。当然，这也需要区分 IO 映射内存和真实内存。

结论是真实的记忆也表现得像记忆并且符合记忆语义。IO 和内存映射 IO 可以按照它想要的方式运行。

# matlab - 绘制分段函数

> ID：14006195
> 
> 赞同：0
> 
> 时间：2012-12-22T20:09:16.053
> 
> 标签：matlab

我正在尝试在 MATLAB 中绘制以下分段函数：

```
x=linspace(0,1,100);
e=1;
n=9;
N(e,:) = (n*x-e+1).*(x>(e-1)/n).*(x<e/n) + (-n*x+e+1).*(x>e/n).*(x<(e+1)/n);
plot(x,N(e,:)); 
```

结果是这样的：

![图形](../Images/d8fb86a75e5931f459942f54ca0752d2.png)

而不是应有的等腰三角形。有人知道如何解决这个问题或有其他选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:24:02.753

我假设您希望您的函数实际上的值为 1`x=0.11`而不是 0。为此，您可以简单地替换`(x<e/n)`为`(x<=e/n)`.

# javascript - jquery show() 在执行时破坏 css 位置属性

> ID：14006197
> 
> 赞同：3
> 
> 时间：2012-12-22T20:10:02.953
> 
> 标签：javascript, jquery, html, css

我的问题出在我的网站上，当我加载页面并单击主页时，如果文章在屏幕上可见，我编写的 js 将其隐藏得很流畅，很好，没有问题。但是当我单击关于我们链接时，它显示文章，但在其行为完成时 CSS 位置已损坏。

这是代码：

**HTML：**

```
<nav>
    <ul class="sf-menu sf-vertical">
        <li><a href=# onclick=home()>Home</a></li>
        <li><a href=#about onclick=about()>About Us</a></li>
        <li><a href=#>Cuisines</a>
            <ul>
                <li><a href=#starters>Starters</a></li>
                <li><a href=#>Main Dishes</a></li>
                <li><a href=#>Desserts</a></li>
                <li><a href=#>Mezes</a></li>
            </ul>
        </li>
        <li><a href=#>Wine List</a></li>
        <li><a href=#gallery>Gallery</a></li>
        <li><a href=#contacts>Contacts</a></li>
    </ul>
</nav>

<article class=vanished id=about>
    <h1>About Us</h1>
    <div class="main-wrapper scroll">
        <div class="wrapper clearfix">
            <img src=img/bazar-place.png alt=bazar-place width=222 height=150 class=about-img>
            <h4>Our Restaurant</h4>
            <p>Bazar is a restaurant located between the districts Haga and Vasastaden in Gothenburg with a focus on Turkish and Persian food of the best quality that creates opportunities for an exciting mix all the way, from appetizer to dessert.</p>
        </div>
        <div class="wrapper clearfix">
            <img src=img/belly.jpg alt=belly-dancing width=222 height=167 class=about-img id=belly>
            <h4>Events</h4>
            <p>Every Saturday from 21, we have Belly dancing at Bazar.</p>
        </div>
        <div class="wrapper clearfix">
            <img src=img/food.jpg alt=food-services width=222 height=167 class=about-img id=food>
            <h4>Food Services</h4>
            <p>Taste our famous pasta dish to the human price of 69 :- We offer 10% discount for take-away at our entire menu.</p>
            <p>At lunchtime you can choose from three Turkish pasta dishes or among two or three different main dishes. Ask about vegetarian options! Drinking, salad and coffee / tea included. Lunch can also be picked up.</p>
        </div>
        <div class="wrapper last clearfix">
            <img src=img/extra.jpg alt=extra-services width=222 height=167 class=about-img id=extra>
            <h4>Extra Services</h4>
            <p>We can help with everything from after work, kick-off to the birthday called with food and drink that lasts all night. Do you want more entertainment we can arrange live music and belly dancing.</p>
        </div>
    </div>
</article> 
```

**JAVASCRIPT：**

```
function home(){

    if ($(".active") == [])
    {
        return ;
    }
    else
    {
        var active = $(".active");
        active.css("display","inline-block");
        active.hide("slide",{direction:"left"},700);
        active.attr("class","vanished");

    }
}
function about(){
    if ($(".active") == [])
    {
        var hidden = $("#about");
        hidden.css("display","inline-block");
        hidden.show("slide",{direction : "right"},700);
        hidden.attr("class","active");
    }
    else
    {
        if ($("#about").attr("class") == "active")
        {
            return ;
        }
        else
        {
            var active = $(".active");
            active.css("display","inline-block");
            active.hide("slide",{direction:"left"},700);
            active.attr("class","vanished");
            var hidden = $("#about");
            hidden.css("display","inline-block");
            hidden.show("slide",{direction : "right"},700);
            hidden.attr("class","active");
        }

    }
} 
```

**CSS：**

```
article{
    position: absolute;
    width: 550px;
    height: 100%;
    background-image: url("../img/blockBG.png");
    z-index: 1;
    left: 235px;
    border-left: 1px solid #4A4A4A;
    border-right-color: #7b7b7b;
    border-right-style: solid;
    border-right-width: thick;
    padding-right: 40px;
    padding-left: 40px;
    text-align: center;

}

.vanished{
    display:none;
}

.main-wrapper{
    position:relative;
    z-index:1;
    width: 100%;
    height: 590px;
    display:block;
}

.wrapper{
    border-bottom:1px solid #4A4A4A;
    margin-bottom: 15px;
}

.last{
    border: none;
}

h4{
    color: #efefef;
    text-decoration: none;
    text-align: left;
    font-family:'Yeseva One',cursive;
    font-size: 17px;
    font-weight: normal;
    margin-bottom: 10px;
    margin-top: 0;
    line-height: 19px;
}

h1{
    position: relative;
    font-family:'Yeseva One',cursive;
    font-size:60px;
    z-index: 2;
    color: white;
    margin-top: 90px;
    padding-bottom: 41px;
    margin-bottom: 20px;
    font-weight: normal;
    border-bottom:1px solid #4A4A4A;
}

p{
    color: #efefef;
    text-decoration: none;
    text-align: left;
    font-family:Arial, sans-serif;
    font-size: 12px;

}

.clearfix:before,
.clearfix:after {
    content: " "; /* 1 */
    display: table; /* 2 */
}

.clearfix:after {
    clear: both;
}

/*
 * For IE 6/7 only
 * Include this rule to trigger hasLayout and contain floats.
 */

.clearfix {
    *zoom: 1;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:20:51.243

问题在于`<h1>` `margin-top`仅在动画结束时正确应用。

尝试将距离顶部变成填充而不是边距，它应该修复它：

```
h1{
    position: relative;
    font-family:'Yeseva One',cursive;
    font-size:60px;
    z-index: 2;
    color: white;
    margin-top: 0;
    padding-top: 90px;
    padding-bottom: 41px;
    margin-bottom: 20px;
    font-weight: normal;
    border-bottom:1px solid #4A4A4A;
} 
```

或者，您可以为父`<article>`级提供填充或边框顶部。这将防止`<h1>`边距在动画运行时在其容器之外折叠。

# c# - 如何读取/写入特定数量的字节到文件

> ID：14006199
> 
> 赞同：2
> 
> 时间：2012-12-22T20:10:09.330
> 
> 标签：c#, .net, file, filesystems, filestream

我正在寻找通过以大小块构建文件来创建文件。本质上，我希望创建一个基本的文件系统。

我需要编写一个标题，然后是“无限”个可能的相同大小/结构的条目。重要的部分是：

*   每个数据块都需要单独读/写
*   标头需要作为自己的实体可读/可写
*   需要一种方法来存储此数据并能够快速确定其在文件中的位置

会想象该文件类似于：

```
[HEADER][DATA1][DATA2][DATA3][...] 
```

处理这样的事情的正确方法是什么？假设我想从文件中读取 DATA3，我怎么知道该数据块从哪里开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:00:12.073

如果我理解正确并且您需要一种方法来为您的块分配一种名称/ID `DATA`，您可以尝试引入另一种类型的块。

我们称之为`TOC`（目录）。因此，文件结构将如下所示`[HEADER][TOC1][DATA1][DATA2][DATA3][TOC2][...]`。

`TOC`块将包含名称/ID 和对多个`DATA`块的引用。此外，它将包含一些内部数据，例如指向下一个`TOC`块的指针（因此，您可以将每个`TOC`块视为一个链表节点）。

在运行时，所有`TOC`块都可以表示为一种`HashMap`，其中 key 是`DATA`块的名称/ID，值是它在文件中的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:54:05.280

I am working in reverse but this may help.

I write decompilers for binary files. Generally there is a fixed header of a known number of bytes. This contains specific file identification so we can recognize the file type we are dealing with.

Following that will be a fixed number of bytes containing the number of sections (groups of data) This number then tells us how many data pointers there will be. Each data pointer may be four bytes (or whatever you need) representing the start of the data block. From this we can work out the size of each block. The decompiler then reads the blocks one at a time to get the size and location in the file of each data block. The job then is to extract that block of bytes and do whatever is needed.

We step through the file one block at a time. The size of the last block is the start pointer to the end of the file.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:33:12.430

我们可以在标头中存储块的大小。如果块的大小是可变的，您可以存储指向实际块的指针。一个有趣的可变大小设计是在 postgres 堆文件页面中。[http://doxygen.postgresql.org/bufpage_8h_source.html](http://doxygen.postgresql.org/bufpage_8h_source.html)

# delphi - 随机化字符串列表

> ID：14006205
> 
> 赞同：14
> 
> 时间：2012-12-22T20:10:57.200
> 
> 标签：delphi, delphi-xe2

我怎样才能像这个在线工具的工作方式一样随机化 StringList 中的字符串。如果有人熟悉它，请检查：[http ://textmechanic.co/Randomize-List.html](http://textmechanic.co/Randomize-List.html)

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-22T21:44:41.857

执行 shuffle 的一种常见算法是[Fisher-Yates](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle) shuffle。这会产生均匀分布的排列。

要在 Delphi`TStrings`对象上实现，您可以使用以下命令：

```
procedure Shuffle(Strings: TStrings);
var
  i: Integer;
begin
  for i := Strings.Count-1 downto 1 do 
    Strings.Exchange(i, Random(i+1));
end; 
```

现在，虽然理论上这将产生均匀分布的排列，但实际性能在很大程度上取决于随机数生成器的质量。这在 Knuth 的计算机编程艺术，第 2 卷，第 3.4.2 节，算法 P 中进行了讨论。

进一步阅读：

*   [Fisher-Yates 洗牌](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)（维基百科）
*   Jeff Attwood 关于洗牌的两篇博客文章：[洗牌](http://www.codinghorror.com/blog/2007/12/shuffling.html)和[天真的危险](http://www.codinghorror.com/blog/2007/12/the-danger-of-naivete.html)
*   [Fisher-Yates 洗牌背后的直觉](http://eli.thegreenplace.net/2010/05/28/the-intuition-behind-fisher-yates-shuffling/)(Eli Bendersky)
*   [计算机编程艺术](http://www-cs-faculty.stanford.edu/~uno/taocp.html)，唐纳德·高德纳，第 2 卷，第 3.4.2 节
*   [洗牌](http://en.wikipedia.org/wiki/Shuffling)（维基百科）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T20:37:38.443

只需遍历字符串列表并给每个项目一个不同的随机位置：

```
for i := StringList.Count - 1 downto 1 do
  StringList.Exchange(i, Random(i+1)); 
```

[编辑] 稍微改变了循环以使洗牌均匀。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-12-22T20:21:41.507

要随机化 a ，请使用**随机结果值**`TStrings`创建一个比较器，并用它对 进行排序。`TComparer`**`TStrings`**

 **```
/// The Comparer
TMyShuffleComparer= class(TComparer<string>)
public
  function Compare(const Left, Right: string): Integer; override;
end;

/// The randomizer 
function TMyShuffleComparer.Compare(const Left, Right: TCard): Integer;
begin
  // To sort, get a random number for compare result
  Result := Random(100) - 50;
end;

/// How to call the comparer
procedure TMyStrings.Shuffle;
begin
 Sort(TMyShuffleComparer.Create);
end; 
```

或直接致电：

```
 /// Shuffle
  MyString.Sort(TMyShuffleComparer.Create); 
```**

# javascript - 使用 clearInterval() 时出错

> ID：14006208
> 
> 赞同：1
> 
> 时间：2012-12-22T20:11:20.843
> 
> 标签：javascript, jquery, settimeout, setinterval, clearinterval

我使用以下代码每 1 秒隐藏和显示一个 div

```
$(document).ready(function(e) {
    var acc = setInterval(function(){
        $("#element").fadeOut(function(){
            setTimeout(function(){
                $("#element").fadeIn()  
            }, 1000)    
        })
    }, 200)
})

$(window).load(function(){
    setTimeout(function(){
        clearInterval(acc);
    }, 10000)
}) 
```

无法正常工作，`clearInterval()`我在 Google Chrome 上收到以下错误：

> **未捕获的 ReferenceError：未定义 acc**

**演示**：http: [//jsfiddle.net/enve/4GWvM/](http://jsfiddle.net/enve/4GWvM/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T20:13:12.253

您的代码中存在范围问题，您已`acc`在文档就绪处理程序的上下文中本地定义了变量，并且未在`load`处理程序的上下文中定义它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T20:14:15.483

尝试在回调*之外*`acc`重新定义变量。*`.ready`*

 *```
var _acc = function(callback) {
    return setInterval(callback, 1000);
};

var acc = null;

$(document).ready(function() {
    acc = _acc(function() {
        $("#element").fadeOut(function(){
            setTimeout(function(){
                $("#element").fadeIn()  
            }, 1000)    
        })
    });
});

... 
```*

# javascript - 如何计算 HTML5 画布上拖放事件的长度？(KineticJS)

> ID：14006219
> 
> 赞同：0
> 
> 时间：2012-12-22T20:13:29.407
> 
> 标签：javascript, timer, html5-canvas, kineticjs

我正在尝试创建一个应用程序，在该应用程序中，用户需要将*Kinetic.Image*对象拖动一段必要的时间（在本例中为 5 秒）；这将用于确保他们在未完成手头任务的情况下不会进入下一阶段。我正在为我的应用程序使用 KineticJS。这可能与 dragstart、dragmove 和 dragend 事件处理程序的某种组合吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T18:46:08.327

```
 var count = 0;
 function Tick() {
     count++;
     window.setTimeout("Tick()", 1000);
 }

 myObject.on('dragstart', function(){
     Tick();
 });

 myObject.on('dragend', function(){
     return count;
 } 
```

我不确定这是否是一个好方法，但是您可以使用 setTimeout 或 setInterval 来增加变量“count”，然后在拖动完成时返回该变量。

如果你想要一个原生的 KineticJS 实现，你必须使用 Kinetic.Animation，因为它有一个内置的“frame.time”，它会为你计算毫秒，但如果你只想拖动事件，那就有点混乱了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T20:43:54.390

我现在自己想出了一个解决方案，所以把它放在这里给任何可能感兴趣的人。我相信，最简单的方法是在 dragstart 中获取时间戳并在 dragend 中执行相同的操作并执行差异。用差值增加一个全局计数器变量，然后在 dragend 中检查该计数器是否超过所需的数量。

```
object1.on("dragstart", function() { lastTimestamp = Date.now(); });
object1.on("dragend", function() { timeTaken = Date.now() - lastTimestamp; }); 
```

# javascript - javascript查找没有id的节点

> ID：14006220
> 
> 赞同：2
> 
> 时间：2012-12-22T20:13:42.700
> 
> 标签：javascript, html, getelementbyid

由于我使用的 Javascript 库的限制，我无法将 id 分配给`<div>`. 不幸的是，我不知道如何将一个 Javascript 工具提示库 Tipped 中的 Tooltip 对象附加到没有 ID 的元素上。我不知道这是否可能，但我正在尝试通过其他方式找到该对象，这有望让我修改 id。

我正在寻找的元素是工具栏上的按钮，但它不是 HTML 按钮。它`<div>`具有 CSS 样式和分配的 Javascript 事件，使其看起来和感觉像一个按钮。我知道 parent 的类名，我知道 grandparent 的 id `<div>`，但这就是我所知道的。部分问题在于，一旦获得对 HTML 对象的引用，似乎没有很好的参考来说明如何迭代地操作 HTML 对象。我见过很多这样的例子：

```
var x = document.getElementsById("asdf") 
```

但没有后续代码显示如何实际做任何事情。x里面有什么？它有哪些方法？我知道innerHTML 和innerTEXT，但我不知道它们是否适用于x、x 的孩子或???。Chrome 控制台有所帮助，但我基本上迷路了。

这是我的按钮的相关代码：

![我页面中的 DIV（导出按钮上没有 id）](../Images/7f9dc711e013458f4f151133039dc615.png)

如您所见，Export 按钮上没有 id，但 parent 有一个类名，grandparent 有一个 id。另一个障碍是祖父母的身份不是静态的。它总是以“dhxtoolbar”开头，页面上只有一个工具栏，但我无法通过正则表达式搜索找到该工具栏。

最终，我希望能够将提示工具提示附加到“导出”按钮。我认为 Tipped 需要一个 id，但也许它不需要。无论如何，我想了解更多关于如何遍历 DOM 的信息，并且作为奖励，弄清楚我如何或是否可以更改活动页面上元素的 id。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:17:33.820

[Tipped](http://projects.nickstakenburg.com/tipped/documentation)实际上接受任何 CSS 选择器作为参数。如果该类是唯一的，则可以这样定位它：

```
Tipped.create('.dhx_toolbar_btn', 'some tooltip text'); 
```

或者，如果该类不是唯一的，您可以尝试通过树结构来定位它。编造的例子：

```
Tipped.create('.header .sidebar .dhx_toolbar_btn', 'some tooltip text'); 
```

我在您的 html 中注意到按钮具有空`title`属性（或者您的检查员可能只是添加了它们）。如果您可以设置`title`按钮的属性，Tipped 将自动拾取它。例子：

```
<div class="dhx_toolbar_btn" title="test title"> 
```

然后，您只需使用：

```
Tipped.create('.dhx_toolbar_btn'); 
```

Tipped 会自动选择标题并使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T16:24:49.747

这就是我试图解释的：

```
var Obj         = document.getElementsByClassName("classname");
var ObjChildren = Obj[0].getElementsByTagName("tag")
var searchText = "string";

for (var i = 0; i < ObjChildren.length; i < i++) {
    if (ObjChildren[i].innerHTML == searchText) {
        console.log(ObjChildren[i].innerHTML);
    }
} 
```

# spring - 在从spring mvc控制器返回页面期间获取堆栈溢出

> ID：14006224
> 
> 赞同：0
> 
> 时间：2012-12-22T20:13:52.623
> 
> 标签：spring, model-view-controller, spring-mvc, spring-webflow

我有 spring mvc 控制器，包含类似的方法

```
@requestmapping("jsps/welcome.jsp")
public String handleRequest(){
system.out.println("inside the handler");
return "welcome";} 
```

当我尝试运行welcome.jsp 页面时，我遇到了堆栈溢出，似乎该页面将进入控制器，然后控制器返回该页面，然后它将再次运行，依此类推。

我的弹簧配置是

```
<bean id="viewResolver"
class="------"
<property name="prefix">
<value> /jsps/ </value>
</property>
<property name="suffix">
<value> .jsp </value>
</property> 
```

和 urlmapping

```
<map>
<entry key="jsps/welcome.jsp">
<ref bean="mycontroller"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T05:03:24.647

原因很明显。调用控制器方法的请求，`jsps/welcome.jsp`该方法转发到名为“welcome”的视图，再次解析为url `jsps/welcome.jsp`，再次调用该方法。所以它一直持续到 StackOverFlow 被抛出。

解决方案是将 url 映射更改为另一个`url without .jsp`类似

```
@Requestmapping("/welcome")
public String handleRequest(){
   system.out.println("inside the handler");
   return "welcome";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:35:44.043

是的，控制器正在返回字符串`"welcome"`，视图解析器正在将其修改`"jsps/welcome.jsp"`为再次调用该方法。

换成`@requestmapping("jsps/welcome.jsp")`别的东西。通常我们有这样的`welcome.htm`东西

然后点击`welcome.htm`它会调用`handleRequest`方法，方法会返回`"welcome"`并查看解析器将其转换为`"jsps/welcome.jsp"`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T04:59:43.877

两件事情

1.  对于 URL 映射，最好不要使用 *.jsp。使用类似 jsps/welcome 或 jsps/welcome.htm
2.  要返回视图，请使用[ModelAndVeiw](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/web/servlet/ModelAndView.html)。

**更新**

进行这些更改

```
@requestmapping("jsps/welcome")
public String handleRequest(){
system.out.println("inside the handler");
return new ModelAndView("yourpathtojspfile");} // can be "jsps/welcome" 
```

在这里，这个页面将返回视图（使用 'jsps/welcome' 你会得到welcome.jsp）

当您返回一个字符串时，您可以选择使用

```
return "redirect:someUrl"; //But this will not return a view, instead search for the mapping someUrl. 
```

# javascript - Windows Media Encoder 为 WinRT 录制屏幕

> ID：14006228
> 
> 赞同：0
> 
> 时间：2012-12-22T20:14:33.470
> 
> 标签：javascript, microsoft-metro, windows-runtime, sharing

我使用 wmencoder 或 System.Windows.Media.Imaging 命名空间通过在桌面应用程序中使用 C# 来捕获屏幕。现在我需要捕获屏幕并在 JS WinRT 中的设备之间共享它。

**我的问题是如何捕获屏幕并在 JS Metro 应用程序中共享它。**

我应该使用 System.Windows.Media.Imaging 命名空间之类的东西来将位图帧对象的集合编码为图像流。？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T20:16:04.723

无法在 WinRT 中捕获屏幕截图。您必须通过非 Windows 运行时应用程序来执行此操作。

# jquery - 如何在 jquery 中定位多个 css 选择器

> ID：14006233
> 
> 赞同：0
> 
> 时间：2012-12-22T20:15:18.683
> 
> 标签：jquery, css

我打算将一些 jQuery 行为应用于两个具有自己的 css 类的元素。

我正在选择这样的两个班级......

```
$(".product-contain, .page-id-31").find("a:has(img)").fancybox({ 
```

但是该脚本仅适用于第二个选择器。我尝试了各种方法，但想不出一个合适的方法来做，我真的不想为另一个选择器复制代码。

将脚本应用于上述两个选择器的正确方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T20:16:50.477

使用[**each()**](http://api.jquery.com/jQuery.each/)通过选择器来调用`every`元素`returned`，目前`fancybox()`只使用`zero`选择器返回的索引处的元素调用。

```
$(".product-contain, .page-id-31").find("a:has(img)").each(function(){
      $(this).fancybox({
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:19:28.783

尝试

```
$.each( [".product-contain", ".page-id-31",.....] , function(i, value){ 

     var el = $(value); 
     el.find("a:has(img)").fancybox({options});

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:21:08.500

逗号分隔是应用多个选择器的正确方法。find 函数将尝试匹配其应用的上下文的所有后代。

您的选择器可以重写为：'.classA a.classC, .classB a.classC' 如果选择器符合您的意图，那么您的过滤是正确的。

Find 不会匹配上下文元素本身。

此外，如前所述，确保所应用的函数适用于整个结果集，而不仅仅是第一个结果。FancyBox 仅适用于集合中的第一个元素。在这种情况下，您可以应用 .each 函数来遍历集合中的所有元素并应用 fancyBox

# terrain - 调整六边形网格的高度图生成

> ID：14006238
> 
> 赞同：4
> 
> 时间：2012-12-22T20:15:33.177
> 
> 标签：terrain, procedural-generation, hexagonal-tiles, heightmap

目前我正在做一个小项目，只是为了一点乐趣。它是一个使用 OpenGL 的 C++、WinAPI 应用程序。

我希望它会变成一个在六边形网格上玩的 RTS 游戏，当我完成基本游戏引擎后，我计划进一步扩展它。

目前，我的应用程序包含一个包含顶点和高度图信息的 VBO。高度图是使用中点位移算法（菱形）生成的。

为了实现六边形网格，我采用了[这里](http://www.shamusyoung.com/twentysidedtale/?p=9669)解释的想法。它向下移动正常网格的奇数行，以允许相对容易地渲染六边形而没有太多进一步的复杂性（我希望）。

几天后它开始聚集在一起，我添加了鼠标选择，这是通过以独特的颜色渲染网格中的每个十六进制来实现的，然后在此 FBO 中对给定的鼠标位置进行采样以识别所选的 ID单元格（在下面屏幕截图的右上角可见）。

![在此处输入图像描述](../Images/1e13ab8b43616d12f6cb3b366424d80a.png)

在我项目的下一阶段，我想看看生成更多“可玩”的地形。对我来说，这意味着每个六边形的形状应该比上图中看到的更规则。

所以终于说到我的意思了，有没有：

*   一种在我当前的方法中平滑或调整顶点的方法，它将六边形的所有点都带到一个平面上（共面）。

***编辑：对于任何寻找有关如何使点共面的信息的人来说，[这是一个很好的解释](https://stackoverflow.com/questions/8886603/projecting-a-point-onto-the-same-plane-as-a-polygon)。***

*   一种更好的程序地形生成方法，可以更好地控制这类事情。
*   一种以不同方式表示我的顶点信息的方法，允许这样做。

需要明确的是，我并不是想实现一个带有凸起边缘或平台的平面六角网格（如下所示）。

![这里](../Images/d677af627f7c26c130f65deda91936b7.png))

我希望所有几何图形都加入并引导到下一个位。

我希望实现与我现在所拥有的类似的东西（相对较好的起伏山丘和地形），但具有更可控的高原。这给了我稍后关闭区域（无法播放的瓷砖）的灵活性，如果需要，我可以在其中添加更高细节的网格。

欢迎任何反馈，我将其用作学习练习，所以请 - 欢迎所有评论！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T09:12:22.973

这取决于您实际想要什么以及“更受控制”的含义。

您是否希望能够说“坐标 [11, -127] 上会有一座山，半径为 20”？这个的复杂性取决于你想走多远。如果您只想要山脉，那么径向渐变就足够了（只需将渐变值添加到噪声值）。但是，如果您想要一些更复杂的形状，那您就大饱眼福了。

[我在我的项目](https://code.google.com/p/geogen/)中深入探索了这个想法（请考虑已发布的版本只是一个原型，目前正在进行重大重新设计，但它完全可以用作地图生成器）。

另一种方法是使生成更加程序化 - 您只需指定一系列数学函数，然后将其应用于地形。即使是简单的价值转换也能让你走得很远。

所有这些方法都应该适用于十六进制网格。如果由于奇数行移位而出现伪影，那么您可以对奇数行进行插值（只需使用简单的线性插值公式从顶点所在的两个顶点计算顶点的高度值）。

考虑一个函数，它将紫色线映射到蓝色曲线 - 它强调较低的定位高度以及非常高的定位高度，但使它们之间的过渡更陡峭（这个例子只是一个余弦函数，使曲线不太平滑会使转型更加突出）。

![余弦值变换](../Images/159ce80cda87daea73251aa681ac8bc9.png)

您也可以只使用曲线的下半部分，使峰更锐利，较低的区域更平坦（因此更具可玩性）。

![余弦值变换 II](../Images/6da0b467967021d10960df678364d768.png)

曲线的“锐度”可以很容易地用功率（使效果更加戏剧化）或平方根（降低效果）来调制。

![在此处输入图像描述](../Images/484cc07de7a0e013aba693e4bdfa096d.png)

实现这一点实际上非常简单（特别是如果您使用余弦函数） - 只需将函数应用于地图中的每个像素。如果该函数在数学上不是那么微不足道，那么查找表就可以正常工作（表值之间的三次插值，线性插值会产生伪影）。

可以在本文中找到几种更简单的随机噪声地形“游戏化”方法：“[用于计算机游戏的侵蚀分形地形的实时合成](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CDYQFjAA&url=http://web.mit.edu/cesium/Public/terrain.pdf&ei=pcrWULTaMMn24QSYp4HACQ&usg=AFQjCNEz5i-HT7Ic10iT3ZwY4MamTpT_CA&sig2=Ceo8VEyDKAUAKLbJ5n_73w&bvm=bv.1355534169,d.bGE&cad=rja)”。

祝你的项目好运

# ios - Objective-c facebook graph api 分页

> ID：14006244
> 
> 赞同：2
> 
> 时间：2012-12-22T20:16:35.800
> 
> 标签：ios, facebook

我正在开发一个 iOS 应用程序，其中包括用户墙的 facebook 提要。使用带有以下 URL 的图形 api：

```
feedURL = [NSString stringWithFormat:@"https://graph.facebook.com/%@/feed?
access_token=%@&since=%@&until=%@",kFaceBookID,FBSession.activeSession.accessToken,
[dateRange objectForKey:@"since"], [dateRange objectForKey:@"until"]]; 
```

我得到的数据只有一个结果和一个用于分页的字典条目。当我使用“下一个”URL 执行 NSURLRequest 时，我得到 0 个结果。如果我将相同的 URL 剪切并粘贴到网络浏览器中，我会得到 25 个结果。关于为什么的任何想法？

这是我正在使用的代码：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSString *nextPageURL;
    NSError *jsonError;
    if (!jsonError) {
        NSDictionary *rDict = [NSJSONSerialization JSONObjectWithData:_postData
                                                              options:0
                                                                error:&jsonError];
        nextPageURL = [[rDict objectForKey:@"paging"]objectForKey:@"next"];
        NSArray *rArray = [rDict objectForKey:@"data"];
        DLog(@"Posts Dictionary = %@\n\n",rDict);
        for (NSDictionary *rPost in rArray) {
            FBPost *post = [[FBPost alloc]initFBPostWithDictionary:rPost];
            [feedsArray addObject:post];
        }
    }
    else
    {
        ALog(@"json error = %@",[jsonError localizedDescription]);
        [activity stopAnimating];
        NSString *errorMessage = [NSString stringWithFormat:@"Facebook status request failed with error: %@\nCheck your network connection and try again later",[jsonError localizedDescription]];
        [self quit:errorMessage];
    }
    [feedsTable reloadData];

    if (nextPageURL && [feedsArray count] < 30) {
        DLog(@"Next Feed URL = %@",nextPageURL);

        NSURLRequest *request = [NSURLRequest requestWithURL: [NSURL URLWithString:nextPageURL]];
        if (![[NSURLConnection alloc] initWithRequest:request delegate:self]) {
            ALog(@"Connection failed for request: %@",request);
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T19:48:00.730

我正在回答我自己的问题，因为我重新审视了整个逻辑并完全改变了我使用 [FBRequestConnection...] 的方法。如果有人感兴趣，这是代码。请注意，我一次获取一周的提要消息以提高 tableview 性能。

```
- (void) fetchFBFeedsForDateRange:(NSDictionary *)dateRange;
{
    _postData = [[NSMutableData alloc]init];
    //since, until is a decremented one week at a time date range. 
    NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                            [dateRange objectForKey:@"since"], @"since",
                            [dateRange objectForKey:@"until"], @"until",
                            nil];
    NSString *gPath = [NSString stringWithFormat:@"%@/feed",kFaceBookID];
    [FBRequestConnection startWithGraphPath:gPath
                                 parameters:params
                                 HTTPMethod:@"GET"
                          completionHandler:^(FBRequestConnection *connection, id result, NSError *error) {
                              if (!error) {
                                  NSArray *rArray = [result objectForKey:@"data"];
                                  //DLog(@"Posts Array = %@\n\n",rArray);
                                  for (NSDictionary *rPost in rArray) {
                                      FBPost *post = [[FBPost alloc]initFBPostWithDictionary:rPost];
                                      if (post.type) {
                                          if (!post.skip) {
                                              [feedsArray addObject:post];
                                          }
                                      }
                                  }
                                [feedsTable reloadData];
                                  if ([feedsArray count] <  kFaceBookMaxPostsToDisplay) {
                                      [self performSelector:@selector(fetchPreviousWeek)];
                                  }
                                  else
                                  {
                                      [activity stopAnimating];
                                  }
                              }
                              else
                              {
                                  [activity stopAnimating];
                                  NSString *errorMessage = [NSString stringWithFormat:@"Facebook status request failed with error: %@\nCheck your network connection and try again later",[error localizedDescription]];
                                  [self quit:errorMessage];

                              }

                          }];
} 
```

# java - Servlet 声明式安全

> ID：14006247
> 
> 赞同：1
> 
> 时间：2012-12-22T20:17:19.330
> 
> 标签：java, jakarta-ee, authentication, servlets

对于 Servlet 安全性，我在 web.xml 中读到我们可以声明

```
<auth-constraints> and <user-data-constraint> 
```

用于打开 SSL 和进行身份验证。但到目前为止，我个人还没有在现实生活中的 web.xml 中看到任何这些声明（在 Tomcat 上运行的应用程序，Glassfish）

所以我想知道实现这些目标的替代方法是什么？哪种方式是首选？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:25:17.197

强烈依赖于使用的应用服务器，但一般情况下，如果不在 AS 级别（而不是部署描述符）启用 SSL，就无法使应用服务器使用 SSL 公开应用程序。

例如对于 Tomcat，SSL 连接器（默认端口 8443）必须在`server.xml`. 然后，您可以使用 Apache (httpd) 作为反向代理，使用`mod_proxy`或`mod_jk`。

在您可以`ServletFilter`用来拦截所有请求的代码中，如果通信不在 SSL 之上，您可以将用户重定向到某个登录页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:25:41.533

首先您声明角色，可以使用注释或在 web.xml 中进行：

```
@DeclareRoles("userRole")
public class SomeServlet extends HttpServlet {
...
} 
```

然后你添加`<security-constraint>` 到你的`web.xml`：

```
 <security-constraint>
        <display-name>SecurityConstraint</display-name>
        <web-resource-collection>
             <web-resource-name>SomeServlet</web-resource-name>
            <url-pattern>/some_servlet</url-pattern>
        </web-resource-collection>
        <auth-constraint>
            <role-name>userRole</role-name>
        </auth-constraint>
        <user-data-constraint>
             <transport-guarantee>NONE</transport-guarantee>
        </user-data-constraint>
    </security-constraint>
    <login-config>
        <auth-method>BASIC</auth-method>
        <realm-name>file</realm-name>
    </login-config> 
```

`<url-pattern>`是要保护的模式。

对于 SSL，您`CONFIDENTIAL`输入`<transport-guarantee>`

# image - 二进制数据的字符串表示？

> ID：14006251
> 
> 赞同：1
> 
> 时间：2012-12-22T20:17:40.433
> 
> 标签：image, encoding, binaryfiles

这里看到的角色的正确术语是什么？

> `data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBhQSERUUExQVFRUWGRwaGBgYGB0dGxkcHxccGxocGxoYHCYgGxojHBsdHy8gJCgpLSwsGB4xNTAqNSYrLCkBCQoKDgwOGg8PGiklHx8pLCwpKSkpKSwpLCkpKSwpLCksKSwsLCkpKSkpLCkpKSwpLCwsKSwsLCksKSkpKSksKf/AABEIAJ0BQQMBIgACEQEDEQH/xAAcAAACAwEBAQEAAAAAAAAAAAAEBQIDBgEABwj/xABFEAACAQIEBAQDBgMGAwcFAAABAhEDIQAEEjEFQVFhBhMicTKBkRRCobHB8CNS0QcVM1Ni4RaS8TRygpOiwtIkQ1RVY//EABoBAAIDA..`

这是二进制数据的字符串表示吗？图像的字符串表示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:20:35.883

这称为[数据 URI](http://en.wikipedia.org/wiki/Data_URI_scheme)。它是一种用于将数据直接内联到 HTML 文档中的技术，而不需要单独的请求来获取文件。

这些字符是二进制数据的[Base64](http://en.wikipedia.org/wiki/Base64)编码 - 在这种情况下，它是图像的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:20:51.390

> 这是二进制数据的字符串表示吗？图像的字符串表示？

是的。这是一个[数据 URI](http://en.wikipedia.org/wiki/Data_URI_scheme)，由两部分组成 - 一个标明数据类型的标头和数据本身（base64 编码的二进制文件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:20:32.373

以 base64 编码的图像。

Base64 编码占用三个字节，每个字节由八位组成，并在 ASCII 标准中将它们表示为四个可打印字符。它基本上分两步完成。

第一步是将三个字节转换为四个六位的数字。ASCII 标准中的每个字符由七位组成。Base64 仅使用 6 位（对应 2^6 = 64 个字符）来确保编码数据可打印和人类可读。没有使用 ASCII 中可用的特殊字符。64 个字符（因此命名为 Base64）是 10 个数字、26 个小写字符、26 个大写字符以及“+”和“/”。

例如，如果这三个字节是 155、162 和 233，则相应的（和可怕的）比特流是 100110111010001011101001，它又对应于 6 位值 38、58、11 和 41。

来自[Base64](http://email.about.com/cs/standards/a/base64_encoding.htm)

# php - PHP If-Else Stack 看起来很复杂

> ID：14006254
> 
> 赞同：3
> 
> 时间：2012-12-22T20:18:11.637
> 
> 标签：php, if-statement

我正在使用 PHP 来布局导航菜单并根据 URL 显示内容。

我已经到达确定要显示什么内容的 IF-ELSE 堆栈（通过加载必要的类和/或方法）。但是必须有更好的方法来写这个..有什么建议吗？

*BreadCrumbs::getCrumb()*是一种静态方法，用于根据索引值（URI 请求，用'/'分割，然后保存在数组中）从 URL 中检索保存的元素。

... *(ArrayHelp::recValueSearch(BreadCrumbs::getCrumb(2), Config::getNavPrimary())*根据包含来自 Config 类的导航列表的数组检查 URI 元素。

*BreadCrumbs::setEmptyCrumb(1, "home")*运行一个设置默认值的方法，如果该值不存在或无效（在导航列表数组中）

```
<?php
// set bread crumbs
BreadCrumbs::setCrumbs($_SERVER['REQUEST_URI']);
BreadCrumbs::setEmptyCrumb(1, "home");
BreadCrumbs::setEmptyCrumb(2, "all");

if (BreadCrumbs::getCrumb(1) == 'about') {
    echo 'This is the <b>About</b> Page';
}
else if (BreadCrumbs::getCrumb(1) == 'contact') {
    echo 'This is the <b>Contact</b> Page';
}
else if (BreadCrumbs::getCrumb(1) == 'search') {
    echo 'This is the <b>Search</b> Page';
}
else if (BreadCrumbs::getCrumb(1) == 'home') {
    if (BreadCrumbs::getCrumb(2) == 'all') {
        echo 'This is the <b>Home</b> Page';
    }
    else if (ArrayHelp::recValueSearch(BreadCrumbs::getCrumb(2), Config::getNavSecondary())) {
        echo 'This is the list page for category: <b>' . BreadCrumbs::getCrumb(1) . '</b> and the country filter is: <b>'. BreadCrumbs::getCrumb(2) . '</b>';
    }
    else {
        echo 'change filter value and go to the <b>home</b> page';
    }
}
else if (ArrayHelp::recValueSearch(BreadCrumbs::getCrumb(1), Config::getNavPrimary())) {
    if (BreadCrumbs::getCrumb(2) == 'all') {
        echo 'This is the list page for category: <b>' . BreadCrumbs::getCrumb(1) . '</b> and the country filter is <b>all countries</b>';
    }
    else if (ArrayHelp::recValueSearch(BreadCrumbs::getCrumb(2), Config::getNavSecondary())) {
        echo 'This is the list page for category: <b>' . BreadCrumbs::getCrumb(1) . '</b> and the country filter is: <b>'. BreadCrumbs::getCrumb(2) . '</b>';
    }
    else {
        echo 'change filter value to all and go to category: <b>' . BreadCrumbs::getCrumb(1) . '</b>';
    }
}
else {
    echo 'redirect page to home/all';
}

?> 
```

编辑：更改为如下所示的 Switch 语句，更好一点..

```
 <?php
    $array_helper = new ArrayHelp;
    $valid_primary = $array_helper->recValueReturn(BreadCrumbs::getCrumb(1), Config::getNavPrimary());
    $valid_secondary = $array_helper->recValueReturn(BreadCrumbs::getCrumb(2), Config::getNavSecondary());
    switch (BreadCrumbs::getCrumb(1)) {
        case 'about' :
        case 'contact' :
        case 'search' :
            echo 'This is the <b>' . BreadCrumbs::getCrumb(1) . '</b> Page';
            break;
        case 'home' :
            switch (BreadCrumbs::getCrumb(2)) {
                case 'all' :
                    echo 'This is the <b>Home</b> Page';
                    break;
                case ($valid_secondary[1]) : 
                    echo 'This is the list page for category: <b>' . BreadCrumbs::getCrumb(1) . '</b> and the country filter is: <b>'. BreadCrumbs::getCrumb(2) . '</b>';
                    break;
                default:
                    echo 'change filter value and go to the <b>' . BreadCrumbs::getCrumb(1) . '</b> page';
                    break;
            }
            break;
        case ($valid_primary[1]) :
            switch (BreadCrumbs::getCrumb(2)) {
                case ($valid_secondary[1]) : 
                    echo 'This is the list page for category: <b>' . BreadCrumbs::getCrumb(1) . '</b> and the country filter is: <b>'. BreadCrumbs::getCrumb(2) . '</b>';
                    break;
                default:
                    echo 'change filter value and go to the <b>' . BreadCrumbs::getCrumb(1) . '</b> page';
                    break;
            }
            break;
        default:
            echo 'redirect page to home/all';
            break;
    }
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T20:23:46.897

是的，switch 语句更简洁一些

```
switch(BreadCrumbs::getCrumb(1)) {

   case 'about':
     echo 'This is the <b>About</b> Page';
     break;  

   case 'contact':
     echo 'This is the <b>Contact</b> Page';
     break;

   case 'search':
     echo 'This is the <b>Search</b> Page';
     break;

   // ....

   default: 
     // Default behavior
      break;
} 
```

下一步是获取您的每个页面打印输出并将其放置在自己的函数中或将 html 外部化到模板文件中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T20:29:21.490

如果您的示例代码显示了您的完整要求，其中一些可以通过使用返回的实际字符串大大简化`getCrumb`：

```
 $crumb = ucfirst(BreadCrumbs::getCrumb(1));
  switch($crumb){

     case 'home': case 'foobar': # etc, etc
        echo "This is the <b>$crumb</b> Page";
        break; # or add some extra logic
     default:
        # handle invalid crumbs here
        break;
  } 
```

([`ucfirst`](http://php.net/manual/en/function.ucfirst.php)用于使字符串的第一个字符大写。)

# progress-bar - 不确定的 SwingWorker 的示例代码

> ID：14006255
> 
> 赞同：1
> 
> 时间：2012-12-22T20:18:11.977
> 
> 标签：progress-bar, swingworker

这不是一个问题。这是有效的示例代码。该代码可能对其他人有所帮助。也许会有一些关于如何改进的帖子。它。

我想要一个不发送更新的进程的进度条。它只是运行直到完成。因此我需要一个不确定的进程栏。

该代码基于我在互联网上找到的一些代码。该代码有JPanel。切换到 JDialog 是必不可少的，否则它会在数字正确之前返回。

“导入 com.adamford.LuSch.GP;” 仅用于获取顶级框架 GP.mainFrame。删除导入并添加您自己的框架。

下面是代码。在后台运行的进程是 walkFileTree()。

* * *

```
import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.Toolkit;
import java.io.File;
import java.text.DecimalFormat;
import java.util.ArrayList;

import javax.swing.BorderFactory;
import javax.swing.JDialog;
import javax.swing.JPanel;
import javax.swing.JProgressBar;
import javax.swing.SwingWorker;

import com.adamford.LuSch.GP;

public class FldrStats extends JPanel  {

    private static JDialog jDia;
    private JProgressBar progressBar;
    private Task task;
    private String theSubdir;
    private File theSubfile;
    private double numOfBytes;
    private ArrayList<File> fileList = new ArrayList<File>();
    private ArrayList<File> subdirList = new ArrayList<File>();
    private static DecimalFormat DF = new DecimalFormat("#.##");
    private boolean debug = false;

    public FldrStats(String subdir) {        
        super(new BorderLayout()); 
        theSubdir = subdir;
        theSubfile = new File(theSubdir);
         // create the progress bar
        progressBar = new JProgressBar(0, 100);
        progressBar.setString("for folder " + subdir + " ");
        progressBar.setIndeterminate(true);
        progressBar.setStringPainted(true);
        // start the background task
        task = new Task();
        task.execute();
        // JPanel
        JPanel panel = new JPanel();
        panel.add(progressBar);
        add(panel, BorderLayout.PAGE_START);
        setBorder(BorderFactory.createEmptyBorder(20, 20, 20, 20));

        jDia = new JDialog(GP.mainFrame,"Calculating folder stats . . . ",true);        
        jDia.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);             
        panel.setOpaque(true); // content panes must be opaque
        jDia.setContentPane(panel); // add the main panel
        jDia.pack(); // size the jDia
        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
        Dimension labelSize = jDia.getContentPane().getPreferredSize();
        jDia.setLocation(screenSize.width / 2 - (labelSize.width / 2),
                screenSize.height / 2 - (labelSize.height / 2));
        jDia.setMinimumSize(new Dimension(300,50));
        jDia.setVisible(true); // display the jDia

    }

    private void finishUp() {
        // Executed in event dispatching thread
        Toolkit.getDefaultToolkit().beep();
        setCursor(null); // turn off the wait cursor
        jDia.dispose();
        if(debug) {
            System.out.println("Finishing");      
            System.out.println("Ab\t" + getNumSubdirs() + " subdirs");
            System.out.println("Ab\t" + getNumFiles() + " files");
            System.out.println("Ab\t" + getBytes() + " bytes");
        }
    }

    private double walkFileTree(File folder) {
        // re-entrant routine
        numOfBytes = 0;
        File[] filelist = folder.listFiles();
        for (int i = 0; i < filelist.length; i++) {
            File thisOne = filelist[i];
            if (thisOne.isDirectory()) {
                subdirList.add(thisOne);
                numOfBytes += walkFileTree(thisOne);
            } else {
                fileList.add(thisOne);
                numOfBytes += thisOne.length();
            }
        }
        return numOfBytes;
    }

    public String getSubdir() { return theSubdir; }
    public double getBytes() { return numOfBytes; }
    public double getKb() { return Double.valueOf(DF.format(numOfBytes/(1024.0))); }
    public double getMb() { return Double.valueOf(DF.format(numOfBytes/(1024.0*1024.0))); }
    public double getGb() { return Double.valueOf(DF.format(numOfBytes/(1024.0*1024.0*1024.0))); }
    public int getNumFiles() { return fileList.size(); }    
    public int getNumSubdirs() { return subdirList.size(); }

    public static void main(String[] args) {
        // Schedule a job for the event-dispatching thread:
        // creating and showing this application's GUI.
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new FldrStats("c:/aa");
                System.out.println("HERE");
             }
        });
    }

   //###################################################################
    class Task extends SwingWorker<Void, Void> {
        @Override
        public Void doInBackground() {
            // Main task. Executed in background thread.
            walkFileTree(theSubfile);
            return null;
        }

        @Override
        public void done() {
            finishUp();
        }
    }

} 
```

# javaagents - 使用 Java 代理在远程 JVM 上重新转换类

> ID：14006260
> 
> 赞同：1
> 
> 时间：2012-12-22T20:18:27.703
> 
> 标签：javaagents

我尝试在远程虚拟机（在同一主机上）中重新转换一个类。加载了一个代理（在清单中以正确值打包在 jar 中），但从未调用过转换器，尽管我要求 Instrumentation 在我的 Agent agentmain 方法中明确地重新转换该类（我验证了以下代码被调用）：

```
instrumentation.addTransformer(new MyClassFileTransformer(), true);
instrumentation.retransformClasses(Class.forName("example.MyClassToTransform")); 
```

任何想法为什么不会发生重新转换以及我应该解决什么问题？

# nexus - Sonatype nexus 管理员登录

> ID：14006263
> 
> 赞同：6
> 
> 时间：2012-12-22T20:19:02.320
> 
> 标签：nexus

我有一个我无法解决的问题。

我买了一个便宜的 vps，用 ubuntu 12.10 然后安装了 tomcat7、maven 和 nexus。它们都是最新的。这是一切的全新安装。我启动并部署了 nexus，catalina 中没有错误，nexus 中没有错误，当我尝试使用 admin/admin123 登录时，我失败了。

我会告诉你我的任何日志文件你需要什么，请帮助我。

**编辑**：关系是 2.2-01

**EDIT2**：这是一个便宜的服务器，有 512 内存，没有 X 运行

我的 security-configuration.xml 是这样的：

```
<?xml version="1.0"?>
<security-configuration>
    <version>2.0.3</version>
    <enabled>true</enabled><!-- was true -->
    <anonymousAccessEnabled>true</anonymousAccessEnabled>
    <anonymousUsername>anonymous</anonymousUsername>
    <anonymousPassword>{1FH7iFzhCukHI3ISkjq+AuQZb+bOMrB70bGqF2y6fNE=}</anonymousPassword>
    <realms>
      <realm>XmlAuthenticatingRealm</realm>
      <realm>XmlAuthorizingRealm</realm>
    </realms>
    <securityManager>default</securityManager>
</security-configuration> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T05:28:07.870

请执行下列操作：

1.  停止 Nexus
2.  将xml中的启用更改为false
3.  重启 Nexus
4.  以管理员身份进入没有任何东西
5.  重置管理员密码
6.  在用户界面中再次启用安全性

哦，顺便说一句。我建议在 VPS 上使用 Jetty 从捆绑包中运行 Nexus，而不是使用 Tomcat 中的 war 文件，这样您就可以从中获得更多性能。

更新：在 Nexus 2.7 及更高版本中不能再禁用安全性。[您必须按照此支持页面](https://support.sonatype.com/entries/24893021-How-can-I-reset-a-forgotten-admin-password-)中的说明将管理员用户插入 xml 。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-09-06T22:50:24.407

将 nexus 管理员密码从默认的“admin123”恢复为更安全的密码，而无需更改配置文件。

我让我的 nexus 实例启动并运行，没有问题以管理员用户和默认密码登录。我想重置管理员密码（更安全的密码）并按照以下说明操作（不接触 security.xml 文件，因为我讨厌更改配置文件来重置任何密码）

1.  使用管理员用户和默认密码登录到 nexus。
2.  单击管理选项卡下的服务器链接。
3.  确保正确设置了 SMTP 设置（主机名、端口、用户名和密码）。
4.  单击“测试 SMTP 设置”并提供电子邮件地址以查看您是否从 nexus 服务器收到邮件。
5.  如果您已经在您的实例上正确设置了 SMTP，则无需运行第 3 步和第 4 步。
6.  点击“安全”选项卡下的“用户”链接，然后选择管理员用户。确保您为此用户设置了正确的电子邮件。
7.  退出联结。
8.  登录并点击忘记您的“密码”链接。
9.  密码恢复屏幕将提示您输入“admin”用户，并且电子邮件应该是您在步骤 6 中列出的用户。
10.  点击“重置密码”按钮，您将在电子邮件中获得更强大的密码。

再次检查 SMTP 设置和管理员用户的电子邮件是一次性操作。步骤 8 到 10 只需不到一分钟，无需接触 security.xml 文件即可轻松重置管理员密码。当然，一旦您使用新密码登录，此文件将自动更新。比手动修改文件的首选方式。

# javascript - 在图像上映射

> ID：14006264
> 
> 赞同：0
> 
> 时间：2012-12-22T20:19:15.570
> 
> 标签：javascript, jquery, html, css, mapping

我正在为我的社区大学开发地图解决方案。

我知道，有 Dreamweaver 绘图工具，但我正在寻找最佳实践。更多 CSS3/HMTL/JS。

类似于[http://www.thewarzcartographer.com/](http://www.thewarzcartographer.com/)

任何人都可以提供建议或提示从哪里开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:22:58.167

您可以将 Google Maps API 与自定义图块一起使用。您的图块需要为 256 x 256 像素。

有关详细信息，请参阅此链接：

[http://econym.org.uk/gmap/custommap.htm](http://econym.org.uk/gmap/custommap.htm)

这里举个例子：

[http://econym.org.uk/gmap/example_custommap1.htm](http://econym.org.uk/gmap/example_custommap1.htm)

# maven - Maven pom 为另一个 pom 生成类文件

> ID：14006266
> 
> 赞同：0
> 
> 时间：2012-12-22T20:19:24.340
> 
> 标签：maven

我有一个依赖于生成源的 Maven 项目。这些源代码需要由另一个 maven pom 构建的 java 程序生成。（在这种情况下，源代码由 greendao 源代码生成器生成，但它们可以由任何通用 java 可执行文件生成。）

我以前没有处理过 maven 项目之间的这种相互依赖关系。假设我想使用反应器来构建这两个子模块，我如何确保第一个模块被构建并执行并生成其源文件以包含在第二个模块中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:30:04.140

模块 A 生成源。模块 B 依赖于模块 A。如果你在模块 B 的 pom 中说模块 B 依赖于模块 A，我认为反应器会弄清楚它需要先构建模块 A。

# html - 为什么一个 div 不定位在另一个 div 旁边？

> ID：14006271
> 
> 赞同：0
> 
> 时间：2012-12-22T20:19:56.267
> 
> 标签：html, css, web, position, css-float

我正在创建一个网站，但我在定位 div 时遇到了一些问题。我`content div`没有定位在旁边`navigation-bar div`，即使我漂浮在他们两个左边。

这是HTML代码。

```
<head>
<link rel="stylesheet" type="text/css" href="theme.css">
</head>

<body>

<div id="title">
Sample Title
</div>

<div id="navigation-bar">
Home
<br>
<br>
Products
<br>
<br>
</div>

<div id="content">
content goes here
</div>

</body>

</html> 
```

这是theme.css文件

```
#title
{
color: black;
padding: 20px;
font-size: 250%;
padding: 2%;
width: 70%;
height: 10%;
border: 4px solid blue;
}

#navigation-bar
{
background-color: #606060;
width: 15%;
height: 70%;
color: white;
text-align: center;
padding: 2%;
font-size: 80%;
border: 4px solid blue;
}

#content
{
border: 4px solid blue;
float: left;
width: 20%;
height: 70%;
} 
```

问题是 the`navigation-bar div`和`content div`wont 位置彼此相邻，而是`content div`将自身定位在 下方`navigation-bar div`。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:22:08.723

你在哪里`float: left;`使用`#navigation-bar`？

```
#navigation-bar
{
   background-color: #606060;
   width: 15%;
   height: 70%;
   color: white;
   text-align: center;
   padding: 2%;
   font-size: 80%;
   border: 4px solid blue;
   float: left; <--- Add this Here
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T20:21:51.123

怎么加一个`float: left`到`#navigation-bar`

[演示](http://jsfiddle.net/L8LCZ/)

# android - 像联系人应用程序中的字母滚动

> ID：14006276
> 
> 赞同：1
> 
> 时间：2012-12-22T20:20:40.763
> 
> 标签：android

有谁知道我在哪里可以找到关于如何实现字母滚动条的来源，就像 ICS 联系人应用程序中的那个一样。

我想要相同的外观和感觉，即三角形窗口。我见过很多类似的例子，但没有一个看起来像谷歌的实现。

谢谢

即是这样的： [在 ListView 中创建简单的字母滚动？](https://stackoverflow.com/questions/5122749/create-easy-alphabetical-scrolling-in-listview)

但我想要谷歌的版本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:43:19.310

了解 google 版本的最佳方法是在[此处查看 Contact 应用程序 AlphabetIndexer 源代码](http://code.google.com/p/android-cookbook/source/browse/trunk/OilCan/src/com/android/contacts/AlphabetIndexer.java?r=18)

# java - 在 Java 应用程序中使用 MVC

> ID：14006279
> 
> 赞同：1
> 
> 时间：2012-12-22T20:20:54.193
> 
> 标签：java, swing, model-view-controller, javafx-2

我需要编写一个跨平台的 GUI 应用程序来处理（在多个线程中）和可视化相当大量的数据。理想情况下，应用程序应该相对较快并且看起来不错。

该应用程序的界面将包括一个表格小部件、一个树小部件和一个自定义绘图小部件。用户将能够从这些小部件中的任何一个修改数据，并且更改应立即反映在其他小部件中。

当然，我打算使用 MVC。但是，我通常使用 C++/Qt 进行所有 GUI 编程，并且对 Java 的了解非常有限。因此，我非常感谢有关如何用 Java 组织这样的应用程序的任何建议。特别是，我应该使用 Swing 还是 JavaFX？您会为这项工作选择哪些小部件？您能否推荐任何涵盖 Java 平台这些方面的书籍/在线教程？

我将不胜感激任何反馈。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:41:02.593

这是一个非常主观的问题。

Swing 是一个成熟的、完善的和文档化的 API。它已经运行了超过 12 年，并拥有许多支持第三方的 API。

JavaFX 是一种相对较新的技术，虽然它的使用正在增长，但它在文档（尤其是第 3 方故障排除和教程）等方面仍然相对不成熟。

使用 JavaFX 2，您现在可以获得树和表实现，并且不再局限于它的脚本语言。

据我了解，JavaFX 的渲染引擎比 Swing 的更新得多（Swing 依赖于 AWT 及其渲染引擎，这在某些极端情况下“可能”导致问题 - 这一直是对 Swing 一段时间的批评（依赖 AWT))。

多年来，Swing 已在大量大型、高质量、高要求的应用程序中使用，虽然我确信 JavaFX 可能能够应对挑战，但这种规模的项目数量并不多。

这是一个流血边缘的问题，而不是经过验证的问题 - 恕我直言。

就个人而言，我会退回到 Swing，但其中很多来自对可用支持的经验和知识。但是，如果有机会，我可能会对在 JavaFX 和 Swing 中制作解决方案的原型感兴趣，不仅可以比较技术，还可以比较开发过程。

首次发布时，JavaFX 的目标是在与 Flash 相同的空间内竞争。有人可能会说，这是 Sun 试图替换/更新 Applet API。我不认为这是 JavaFX 现在唯一的方向，JavaFX 2 已经看到了一些显着的增强（包括包含树和表视图，并且减少了对它的脚本语言的依赖）。

有些人可能会建议 JavFX 是 Swing 的替代品，而 Swing 已被弃用。这不是真的。虽然确实如此，但 Swing 在过去几年中没有看到任何重大更新，但它是可行的核心库。

...恕我直言

# mysql - 仅当匹配索引的行数满足值时，如何从 MySQL 表中选择行？

> ID：14006283
> 
> 赞同：4
> 
> 时间：2012-12-22T20:21:15.007
> 
> 标签：mysql, sql

仅当与索引匹配的行数满足特定数量时，我才想从 MySQL 表中返回行。

这是问题所在：我有一个按用户名索引的用户评论表。因此，我有许多不同评论的行，所有评论都由用户名索引。我正在创建一个搜索过滤器，所以我需要返回拥有一定数量评论的人的用户名（即表格中的评论行数）。

我将如何创建一个 MySQL 查询，该查询将只提取具有 4 个评论（4 个表行条目）的人的用户名？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T20:24:33.747

这听起来很简单`GROUP BY`，并且`COUNT()`使用一个`HAVING`子句来限制具有 4 条评论的人。

```
SELECT
  username,
  COUNT(*) AS num_reviews
FROM
  user_reviews
GROUP BY username
/* Limit to those with 4 reviews */
HAVING num_reviews = 4 
```

查看[聚合函数](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)参考以获取有关如何`GROUP BY`使用的信息。该`HAVING`子句在 and 之后应用，`GROUP BY`用于限制其结果。

[http://sqlfiddle.com/#!2/9dc86/1](http://sqlfiddle.com/#!2/9dc86/1)

# sql - 了解 WHERE 如何与 GROUP BY 和聚合一起使用

> ID：14006290
> 
> 赞同：18
> 
> 时间：2012-12-22T20:22:06.583
> 
> 标签：sql

我的查询 -

```
select cu.CustomerID,cu.FirstName,cu.LastName, COUNT(si.InvoiceID)as inv --1
from Customer as cu inner join SalesInvoice as si --2
on cu.CustomerID = si.CustomerID -- 3
-- put the WHERE clause here ! --4   
group by cu.CustomerID,cu.FirstName,cu.LastName -- 5
where cu.FirstName = 'mark' -- 6 
```

输出正确的代码 -

![在此处输入图像描述](../Images/9a1c58997003ade35669ec33c8dd6b5f.png)

我得到错误 - 关键字“where”附近的语法不正确。

你能告诉我为什么我会收到这个错误吗？**我想知道为什么 WHERE 出现在 GROUP BY 之前而不是之后。**

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-12-22T20:23:47.193

你的顺序错了。该`WHERE`子句位于`GROUP BY`：

```
select cu.CustomerID,cu.FirstName,cu.LastName, COUNT(si.InvoiceID)as inv 
from Customer as cu 
inner join SalesInvoice as si 
   on cu.CustomerID = si.CustomerID 
where cu.FirstName = 'mark' 
group by cu.CustomerID,cu.FirstName,cu.LastName 
```

如果您想在 之后执行过滤器`GROUP BY`，那么您将使用一个`HAVING`子句：

```
select cu.CustomerID,cu.FirstName,cu.LastName, COUNT(si.InvoiceID)as inv 
from Customer as cu 
inner join SalesInvoice as si 
   on cu.CustomerID = si.CustomerID 
group by cu.CustomerID,cu.FirstName,cu.LastName
having cu.FirstName = 'mark' 
```

子句通常`HAVING`用于聚合函数过滤，因此在`GROUP BY`

要了解此处的操作顺序，请参阅[解释顺序的文章](http://www.bennadel.com/blog/70-SQL-Query-Order-of-Operations.htm)。从文章中SQL中的操作顺序是：

> *首先，我认为最好查看 SQL 指令的执行顺序，因为这会改变我可以优化的方式：*

```
FROM clause
WHERE clause
GROUP BY clause
HAVING clause
SELECT clause
ORDER BY clause 
```

使用此顺序，您将`WHERE`在`GROUP BY`. `WHERE`用于限制记录数 。

这样想，如果你应用`WHERE`after 然后你会返回更多的记录然后你会想要分组。首先应用它，减少记录集，然后应用分组。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-22T20:27:48.080

该`where`子句出现在 the 之前，`group by`因为从概念上讲，您在分组之前进行过滤，而不是之后。您希望将分组的输出限制为仅匹配的那些，而不是对您可能会因过滤器而丢弃的项目执行分组。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-22T20:27:36.697

SQL 确实允许您过滤 GROUP BY 的结果——它被称为 HAVING 子句。

如果您想过滤可以在分组之前确定的内容（即 FirstName = 'Mark' 的每个人），可以通过 WHERE 完成。

但是，如果您想过滤拥有 4 个或更多发票的每个人（即，在执行 COUNT*之后*您才知道的东西），那么您可以使用 HAVING。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-22T20:29:47.387

该`WHERE`子句用于 before `GROUP BY`，因为它更有意义。子句中指定的过滤器`WHERE`在分组之前使用。分组后，您可以有一个`HAVING`子句，它类似于`WHERE`，除了您也可以按聚合值过滤。

相比：

```
-- Select the number of invoices per customer (for Customer 1 only)
SELECT
  si.CustomerID,
  COUNT(*) as InvoiceCount
FROM
  SalesInvoice as si   
WHERE
  si.CustomerID = 1
  -- You cannot filter by count(*) here, because grouping hasn't taken place yet.
GROUP BY 
  si.CustomerID -- (Not needed in this case, because of only 1 customer) 
```

反对

```
-- Select all invoices of customers that have more than three invoices
SELECT
  si.CustomerID,
  COUNT(*) as InvoiceCount
FROM
  SalesInvoice as si   
GROUP BY
  si.CustomerId
HAVING
  -- You can filter by aggregates, like count, here.
  COUNT(*) > 3 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-22T20:55:19.277

Let's say you have 100,000 people in your database. 9 of whom are named Mark. Why should the database do a Count operation on all 100,000, then throw out the 99,991 NOT named Mark? Doesn't it seem smarter to filter out the Marks first, then do the Count only 9 times? Makes the operation a whole lot faster.

# java - 无状态会话 bean 中的静态字段

> ID：14006293
> 
> 赞同：10
> 
> 时间：2012-12-22T20:22:12.480
> 
> 标签：java, static, ejb

如果我在无状态 bean 中有一个静态字段：

```
@Stateless
@Local(SomeClass.class)
public class AccountBean implements SomeClass{

   private static final int STATIC_FIELD = 0;

   public AccountBean () {}
} 
```

该`STATIC_FIELD`值是否会在所有`AccountBean`实例中共享，例如在基本类中？

**编辑**将字段标记为`final`如下建议。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-22T20:27:25.757

是的，它将被共享，但当然只能在单个 JVM 内。它的大写表明它是一个常数，因此应该是`final`。

如果它不是一个常量，那么它就会有异味，不尊重 Java 命名约定，并且违反 EJB 规范。

# java - 使用 MongoDb 创建索引

> ID：14006294
> 
> 赞同：15
> 
> 时间：2012-12-22T20:22:24.540
> 
> 标签：java, mongodb, indexing

我是 MongoDB 的初学者，我正在尝试一些东西。我想存储 URL 并避免重复的 URL，我在 url 上创建了一个唯一索引。像那样

```
collection.createIndex(new BasicDBObject("url", type).append("unique", true)); 
```

但是每次我启动我的程序时，索引都会再次创建，不是吗？

因为，现在我的程序只插入一个 url “http://site.com”，如果我重新启动我的程序，这个 url 就像没有索引一样再次插入。

每次创建索引是处理索引的错误方法吗？

这是我的代码示例

```
mongo.getCollection().ensureIndex(new BasicDBObject("url", 1).append("unique", "true"));

mongo.getCollection().insert(new BasicDBObject("url", "http://site.com").append("crawled", 0));

mongo.getCollection().insert(new BasicDBObject("url", "http://site.com").append("crawled", 0)); 
```

和输出：

```
{ "_id" : { "$oid" : "50d627cf44ae5d6b5e9cf106"} , "url" : "http://site.com" , "crawled" : 0}
{ "_id" : { "$oid" : "50d627cf44ae5d6b5e9cf107"} , "url" : "http://site.com" , "crawled" : 0} 
```

谢谢

编辑 ：

这是我处理 MongoDB 的 Mongo 类 import java.net.UnknownHostException; 导入 java.util.List；导入 java.util.Set；

导入 com.mongodb.BasicDBObject；导入com.mongodb.DB；导入 com.mongodb.DBCollection；导入 com.mongodb.DBObject；导入 com.mongodb.MongoClient；

```
public class Mongo {

    private MongoClient mongoClient;
    private DB db;
    private DBCollection collection;
    private String db_name;

    public Mongo(String db){

        try {
            mongoClient = new MongoClient( "localhost" , 27017 );

            this.db = mongoClient.getDB(db);
            this.db_name = db;
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }

    }

    public void drop(){
        mongoClient.dropDatabase(db_name);
    }

    public void listCollections(){
        Set<String> colls = db.getCollectionNames();

        for (String s : colls) {
            System.out.println(s);
        }
    }

    public void listIndex(){
         List<DBObject> list = collection.getIndexInfo();

            for (DBObject o : list) {
                System.out.println("\t" + o);
            }
    }

    public void setCollection(String col){
        this.collection = db.getCollection(col);
    }

    public void insert(BasicDBObject doc){

        this.collection.insert(doc);

    }

    public DBCollection getCollection(){
        return collection;
    }

    public void createIndex(String on, int type){
        collection.ensureIndex(new BasicDBObject(on, type).append("unique", true));
    }

} 
```

这是我的课程处理我的程序

```
public class Explorer {

    private final static boolean DEBUG = false;
    private final static boolean RESET = false;

    private Mongo mongo;

    private String host;

    public Explorer(String url){
        mongo = new Mongo("explorer");
        mongo.setCollection("page");

        if (RESET){
            mongo.drop();
            System.out.println("Set RESET to FALSE and restart the program.");
            System.exit(1);
        }

        if (DEBUG) {
            mongo.listCollections();

        }

        this.host = url.toLowerCase();

        BasicDBObject doc = new BasicDBObject("url", "http://site.com").append("crawled", 0);

        mongo.getCollection().ensureIndex(new BasicDBObject("url", 1).append("unique", true));

        mongo.getCollection().insert(new BasicDBObject("url", "http://site.com").append("crawled", 0));

        mongo.getCollection().insert(new BasicDBObject("url", "http://site.com").append("crawled", 0));

        process();
    }

    private void process(){

        BasicDBObject query = new BasicDBObject("crawled", 0);

        DBCursor cursor = mongo.getCollection().find(query);

        try {
            while(cursor.hasNext()) {
                System.out.println(cursor.next());
            }
        } finally {
            cursor.close();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-22T22:48:24.090

您需要将唯一值作为布尔值 true 传递，而不是作为字符串传递，它是选项的第二个参数：

```
...ensureIndex(new BasicDBObject("url", 1), new BasicDBObject("unique", true)); 
```

另外，我使用 mongo 解释器手动测试了它：

```
> db.createCollection("sa")
{ "ok" : 1 }
> db.sa.ensureIndex({"url":1},{unique:true})
> db.sa.insert({url:"http://www.example.com", crawled: true})
> db.sa.insert({url:"http://www.example.com", crawled: true})
E11000 duplicate key error index: test.sa.$url_1  dup key: { : "http://www.example.com" }
> db.sa.insert({url:"http://www.example2.com/", crawled: false})
> db.sa.insert({url:"http://www.example.com", crawled: false})
E11000 duplicate key error index: test.sa.$url_1  dup key: { : "http://www.example.com" }
> 
```

只有两个对象：

```
> db.sa.find()
{ "_id" : ObjectId("50d636baa050939da1e4c53b"), "url" : "http://www.example.com", "crawled" : true }
{ "_id" : ObjectId("50d636dba050939da1e4c53d"), "url" : "http://www.example2.com/", "crawled" : false } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T20:49:09.550

我不完全理解你的问题，但我觉得你很可能应该使用`ensureIndex`，而不是`createIndex`因为后者总是试图创建索引，而前者只会*确保*它存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-27T21:35:50.987

刚刚偶然发现这个问题，自 3.0.0 版以来有一些变化

```
db.collection.ensureIndex(keys, options) 
```

> 自 3.0.0 版起已弃用：db.collection.ensureIndex() 现在是 db.collection.createIndex() 的别名。
> 
> 如果索引尚不存在，则在指定字段上创建索引。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-07T16:47:41.723

我还看到您没有在 getCollection(); 中指定集合名称；

那会选择什么系列？好奇的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-08T12:02:50.180

要使用 mongodb 的唯一索引，您应该使用带有 2 个参数的方法，其中第三个布尔参数用于“唯一”索引。

> mongo.getCollection().ensureIndex(new BasicDBObject("url", 1),"unq_url", true));

# ios - xcode 是否支持选项卡控件？

> ID：14006296
> 
> 赞同：0
> 
> 时间：2012-12-22T20:22:52.403
> 
> 标签：ios, ipad, cocoa-touch

我正在开发一个仪表板系统，我需要将应用程序的屏幕分成 4 个块。每个块都需要有一个页面/选项卡控件，其中包含不同的选项卡，例如日、月、周等

xcode不支持这个吗？我只能看到对选项卡控件的引用，其中选项卡位于应用程序屏幕的底部

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:01:15.753

您能否在[http://www.cocoacontrols.com/tags/tab](http://www.cocoacontrols.com/tags/tab)中尝试其中一种控件？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:55:31.630

I strongly recommend sticking with the tabs at the bottom. If you want them at the top you will have to implement your own solution or find one by someone else.

# objective-c - 在 ARC 中泄漏

> ID：14006306
> 
> 赞同：0
> 
> 时间：2012-12-22T20:23:54.810
> 
> 标签：objective-c, ios, ios5, automatic-ref-counting

我有一个单例对象，它是我的应用程序的一个模块，并且在此模块中创建的所有对象与任何其他模块都没有关系。我的应用程序创建了这个单例对象，并且这个对象进一步创建了它的子对象，它们没有任何关系我的应用程序中除此模块之外的其他对象。因此，在此模块任务结束后，我将此模块对象设置为`nil`。但是两个对象没有释放并显示在 xcode 的工具中。singelton 对象正在正确释放，但它的两个子对象仍然存在在记忆中。

我的项目完全是 ARC。那么编译器在其父（单例对象）设置为`nil`.

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:01:56.923

> 但是两个对象没有在 xcode 的工具中释放和显示。singelton 对象正在正确释放，但它的两个子对象保留在内存中。

我担心有一个保留周期。
因此，例如 child1 指向 child2，反之亦然。要打破这个循环，您应该使用弱引用。
我看不到代码，所以这只是一个想法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-22T20:27:24.187

如果您在其中初始化更多对象，然后再次调用超级对象，则单例通常是一个问题。因为单例静态变量还没有赋值。

您可以通过执行以下操作来防止这种情况：

* * *

# 单例文件

```
+ (SomeClass *)sharedInstance {
    if (!_someStaticInstance) {
        _someStaticInstance = [[SomeClass alloc]init];
    }

    return _someStaticInstance;
}

- (void)initialise {
    // do the real initialising here
} 
```

* * *

# 创建它的文件

```
[[SomeClass sharedInstance] initialise]; 
```

# qt - 将文件上“”之间的文本解析为 QString

> ID：14006309
> 
> 赞同：0
> 
> 时间：2012-12-22T20:24:10.253
> 
> 标签：qt, foreach, find, qstring, qregexp

我有一个如下所示的文本文件：

> 变量A = 10 变量B = 20 变量C = "Hello World"

该代码工作正常，但我的麻烦是在“”之间获取文本字符串。

```
QStringList Data;
Data << "VariableA = " << "VariableB = " << "VariableC = ";
QStringList Values;

int VariableA;
int VariableB;
QString VariableC;

foreach(const QString &DataToFind, Data) {
    QRegExp DataExpression(DataToFind);
    int DataStart = DataExpression.indexIn(TextToFind);
    if(DataStart >= 0) {
        int DataLength = DataExpression.matchedLength();
        int ValueSize = 1;
        while(TextToFind.at(DataStart + DataLength + ValueSize) != QChar(' ')) {
            ValueSize++;
        }
        QStringRef DataValue(&TextToFind, DataStart + DataLength, ValueSize);
        Values += DataValue.toString(); 
        DataStart = DataExpression.indexIn(description, DataStart + DataLength);
    } else {
        continue;
    }
}

VariableA = Values[0].toInt();
VariableB = Values[1].toInt();
VariableC = Values[2]; 
```

问题是VariableC上的文本可以在其中包含空格和/或“（双引号）。所以我上面发布的从文件中检索变量的方法是无用的。因为它使用“”来到达变量的末尾在文件中。

如何检索双引号内的全文？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T13:33:41.710

```
QStringList Data;
Data << "A = " << "B = " << "X = ";

int A;
int B;
QString X;

foreach(const QString &DataToFind, Data) {
    QRegExp DataExpression(DataToFind);
    int DataStart = DataExpression.indexIn(TextToFind);
    if(DataStart >= 0) {
        int DataLength = DataExpression.matchedLength();
        int ValueSize = 1;
        while(TextToFind.at(DataStart + DataLength + ValueSize) != QChar(' ')) {
            ValueSize++;
        }
        QStringRef DataValue(&TextToFind, DataStart + DataLength, ValueSize);
        DataStart = DataExpression.indexIn(description, DataStart + DataLength);
    } else {
        continue;
    }
} 
```

这完成了工作。

# c++ - 内联函数和 __thiscall __cdecl Bjarne 字符串示例

> ID：14006315
> 
> 赞同：0
> 
> 时间：2012-12-22T20:24:53.047
> 
> 标签：c++, string, visual-c++, calling-convention

我在 Bjarne“C++ ...”中实现了 String 类。我想内联 read() 和其他访问器函数，所以我将它们标记为内联。没关系，但是定义对主文件中对类 String 的引用进行读取的哈希函数会给出错误 LNK2019 unresolved external symbol char __thiscall String::read(int)const

为什么这没有解决？

String.h 中的类字符串：

```
#include <string.h>

class String{
    struct Srep{  // representation
        char* s; // pointer to elements
        int sz;  // number of characters
        int n;   // reference counter
        Srep(int nsz, const char* p){
            n=1;
            sz=nsz;
            s=new char[sz+1]; // add space for terminator
            strcpy(s,p);
        }
        ~Srep(){delete[]s;}
        Srep* get_own_copy(){ // clone if necessary
            if(n==1)return this;
            n--;
            return new Srep(sz,s);
        }
        void assign(int nsz, const char* p){
            if(sz!=nsz){
                delete[]s;
                sz=nsz;
                s=new char[sz+1];
            }
            strcpy(s,p);
        }
    private: //prevent copying
        Srep(const Srep&);
        Srep& operator=(const Srep&);
    };
    Srep* rep;
public:
    class Cref{ // reference to char
        friend class String;
        String& s;
        int i;
        Cref(String& ss, int ii):s(ss), i(ii){}
    public:
        inline operator char(){                 // yield value
            return s.read(i);
        }
        inline void operator=(char c){              // change value
            s.write(i,c);
        }
    };
    class Range{};

    String();                       // x=""
    String(const char*);            // x="abnm'
    String(const String&);          // x=other_string
    String& operator=(const char*);
    String& operator=(const String&);
    ~String();
    // access operators
    void check(int i)const;
    inline char read(int i)const;
    void write(int i, char c);
    Cref operator[](int i);
    char operator[](int i)const;
    int size()const;
}; 
```

字符串.cpp：

```
#include "stdafx.h"
#include "String.h"

String::String(){       // the empty string is the default value
    rep=new Srep(0,"");
}
String::String(const String& x){    // copy constructor
    x.rep->n++;
    rep=x.rep; // share representation
}
String::~String(){
    if(--rep->n==0)delete rep;
}
String& String::operator=(const String& x){ // copy assignment
    x.rep->n++; // protects against "st=st"
    if(--rep->n==0)delete rep;
    rep=x.rep;
    return *this;
}
// pseudo-copy operations taking const char* args are provided to allow
//string literals
String::String(const char* s){
    rep=new Srep(strlen(s),s);
}
String& String::operator=(const char* s){
    if(rep->n==1)   // recycle Srep
        rep->assign(strlen(s),s);
    else{           //use new Srep
        rep->n--;
        rep=new Srep(strlen(s),s);
    }
    return *this;
}
// access operators
inline void String::check(int i)const{
    if(i<0||rep->sz<=i)throw Range();
}
inline char String::read(int i)const{ // unchecked access to s
    return rep->s[i];
}
inline void String::write(int i, char c){
    rep=rep->get_own_copy();
    rep->s[i]=c;
}
inline String::Cref String::operator[](int i){
    check(i);
    return Cref(*this,i);
}
inline char String::operator[](int i)const{// checked access to s
    check(i);
    return rep->s[i];
}
inline int String::size()const{
    return rep->sz;
} 
```

主文件：

```
// Bjarne_exercise_string.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include "String.h"

int hash(const String& s){
    //int h=s.read(0);
    //const int max=s.size();
    //for(int i=1;i<max;i++){
    //  h^=s.read(i)>>1; // unchecked access to s (1st take s[i], then rightshift, and then XOR h and this)
    //}
    //return h;
    return 4;
}

int _tmain(int argc, _TCHAR* argv[])
{
    String s1;
    String s2;
    String s3="s3";
    String s4("s4");
    String s5(s3);
    s5=s4;
    s3=s4;
    //int i=hash(s3);
    //i=hash(s1);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:32:10.573

除非调用站点的编译器可以使用函数的主体，否则不能内联函数。将所有内联函数移动到头文件中。

至于您的链接器错误，您还记得链接到`String.obj`吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:32:17.903

要内联函数，它应该在标题中定义。如果您真的想要内联函数将定义移动到标题或将它们移动到类的主体并删除内联。要让 mo 链接错误在之前删除内联说明符`read`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-22T20:29:11.210

你没有`String::read()`函数。实施它，你会很成功[或者至少更近几步！]

# facebook - 如何在 drupal 7 中配置 Facebook + Oauth 模块

> ID：14006320
> 
> 赞同：0
> 
> 时间：2012-12-22T20:25:44.403
> 
> 标签：facebook, drupal, oauth

我正在寻找一种在 Drupal 7 中配置 Facebook + Oauth 模块的方法，因为我正在努力允许用户使用他们的 Facebook 用户/密码登录我的网站，同时我想将他们的 Facebook 详细信息保存在我的数据库。我一直在寻找配置这些模块的教程或分步过程。

请帮我。一旦我设法做到这一点，我将创建解释此过程的文章。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T04:20:58.150

您正在寻找模块[http://drupal.org/project/fb](http://drupal.org/project/fb)

> 这组模块将 Drupal 变成了一个开发 Facebook 应用程序的平台。这使您可以在 facebook 中嵌入您的内容和功能，或允许 facebook 用户通过 Facebook Connect 访问您的网站。
> 
> 使用 Drupal for Facebook，您可以在 Facebook 应用程序中利用 Drupal 的所有功能。如果您已经在 Drupal 中有内容，您可以在 Facebook 上公开它。

希望这个模块能完全满足您的所有需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-10T21:41:00.810

我已经创建了几个具有这种功能的网站，我最终总是使用 Facebook Oauth 模块而不是 Facebook 的 Drupal：http: [//drupal.org/project/fboauth](http://drupal.org/project/fboauth)

FB OAuth 模块允许您比 Drupal for Facebook 更快速、更轻松地集成 Facebook 登录。此外，您可以将用户的字段映射到 Facebook 数据源——这可能符合您对其 Facebook 详细信息的预期用途。

# entity-framework - EF4 提供者未返回提供者清单令牌字符串

> ID：14006321
> 
> 赞同：0
> 
> 时间：2012-12-22T20:26:00.420
> 
> 标签：entity-framework, connection-string

是的，还有一个关于提供者清单令牌的问题。不幸的是，之前的所有 22 个问题对解决我的问题都没有用。我使用 MVC4 + Code First + Sql Express 开发简单的 Web 应用程序。

这是我的上下文后代：

```
public class MCQContext : DbContext
{
    public MCQContext()
        : base("name=ApplicationConnection")
    {

    }
    ...............
} 
```

在这里 - 与问题相关的 web.config 的一部分：

```
<configuration>
  <configSections>
    <section name="entityFramework"
             type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
             requirePermission="false" />
  </configSections>

  <connectionStrings>
    <add name="ApplicationConnection"
         connectionString="Data Source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|aspnetdb.mdf;User Instance=true"
         providerName="System.Data.SqlClient" />
  </connectionStrings>

  <entityFramework>
    <defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework">
      <parameters>
        <parameter value="name=ApplicationConnection" />
      </parameters>
    </defaultConnectionFactory>
  </entityFramework> 
```

因此，如您所见，正确的连接字符串传递给了上下文类的基类（如果我将连接字符串重命名为“MCQContext”并且不将任何内容传递给父上下文类，则会出现相同的错误）。

我不知道如何解决它。如果我创建绝对空的 MVC4 应用程序、删除所有包（我更喜欢手动指定所需的程序集并且不使用 NuGet）并修复引用（包括对 sqlserver express 的引用），则会重现此行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-14T12:23:19.630

您的连接字符串的问题是：

```
<add name="TrempimModel"
 connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;
                   AttachDBFilename=|DataDirectory|aspnetdb.sdf;
                   User Instance=true"
 providerName="System.Data.SqlClient" /> 
```

您基本上是在定义要连接的“服务器”-但您并没有说要连接到文件中的哪个数据库。此外 - SQL Server Express 数据库文件的文件扩展名是 .mdf（不是 .sdf - 那是 SQL Server Compact Edition） - 您也需要考虑到这一点！（根据 OP 的评论，这是一个错字）。

您需要在连接字符串中定义一个额外的数据库=....（或 Initial Catalog=.....）：

```
 <add name="TrempimModel"
 connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;
                   database=YourDatabaseName;
                   AttachDBFilename=|DataDirectory|aspnetdb.mdf;
                   User Instance=true"
 providerName="System.Data.SqlClient" /> 
```

然后它应该工作得很好。

# jquery - jQuery 在多个 div 之间切换开/关

> ID：14006322
> 
> 赞同：2
> 
> 时间：2012-12-22T20:26:06.170
> 
> 标签：jquery

我有一个非常简单的 jQuery 切换在这里工作：http: [//jsfiddle.net/yVa3U/1/](http://jsfiddle.net/yVa3U/1/) - 但我不知道如何在单击下一个 div 时关闭活动 div。

关于如何做到这一点的任何建议？

谢谢

```
$(document).ready(function() {

  $('.answer').hide();

  $(".toggle").click(function(){

      $("div[rel='profile_" + $(this).attr("profile") + "']").toggle(400);
});

});​ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T20:29:00.497

你应该添加

```
$(".answer").not($(this).next()).hide(400); 
```

在调用`toggle()`函数之前

**旁注**

1.  您可以将行更改`$("div[rel='profile_" + $(this).attr("profile") + "']").toggle(400);`为 `$(this).next().toggle(400);`
2.  而不是使用属性`profile`，你应该更好地使用[`data`](http://api.jquery.com/data/)属性

**[演示](http://jsfiddle.net/yVa3U/5/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T20:27:57.697

您需要`hide` `all`点击答案`except`的`current`答案，您可以这样做，

**[现场演示](http://jsfiddle.net/yVa3U/8/)**

```
$(document).ready(function() {
    $('.answer').hide();
    $(".toggle").click(function() {
        currentAnswerDiv = $("div[rel='profile_" + $(this).attr("profile") + "']");
        $('.answer').not(currentAnswerDiv).hide();
        currentAnswerDiv.toggle(400);
    });
});​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T20:30:20.663

您可以使用`next()`

```
$(".toggle").click(function() {
       var $next=$(this).next().toggle(400)
      $('.answer').not($next).hide();  
}); 
```

最好用 CSS 隐藏你的答案类，而不是在 javascript 中等待就绪事件

演示：http: [//jsfiddle.net/yVa3U/7/](http://jsfiddle.net/yVa3U/7/)

API参考：[http ://api.jquery.com/next/](http://api.jquery.com/next/)

# eclipse - 如何使用 m2e 设置 Eclipse 项目特定的验证首选项

> ID：14006325
> 
> 赞同：0
> 
> 时间：2012-12-22T20:26:15.623
> 
> 标签：eclipse, maven, m2e

当使用“导入 Maven 项目”从 git 调用将 maven 项目导入 eclipse 时，m2e 插件似乎会生成一个新的 .project 和 .classpath 以及一些其他文件，即使这些文件已签入。

为了解决这个问题，我不想签入任何 Eclipse 特定文件，但是对每个项目文件进行了自定义，例如自定义保存操作，或更改验证以忽略特定内容，或更改 javascript 配置需要保留的动态 Web 项目，因此要么需要检查这些文件，要么需要由 m2e 生成这些设置。

有什么方法可以使用 m2e 来配置 eclipse 项目验证器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:29:20.390

我们过去也遇到过类似的问题。我们解决了它

*   不要签入 Eclipse 特定文件（svn 忽略，git 忽略，...）
*   使用[Workspace Mechanic 插件](http://code.google.com/a/eclipselabs.org/p/workspacemechanic/)使 Eclipse 设置在开发机器/开发人员中保持相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:36:18.663

另一个答案建议了 eclipse 的解决方案。但是，如果您可以灵活地使用不同的 IDE，我建议您将 Netbeans 与 git 一起使用。我测试了这两个 IDE，最后发现我可以在不同的情况下使用 Netbeans 节省时间！没有上述问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-05T13:46:48.093

我为另一个目的制作了[m2e-codestyle-maven-plugin](https://site.trajano.net/m2e-codestyle-maven-plugin/)，但它也应该满足您的需求（在我的情况下，我想设置默认设置以从我的[编码标准](https://site.trajano.net/coding-standards/)项目中打开所有验证。

您要做的关键是复制我的[编码标准](https://site.trajano.net/coding-standards/)项目并添加/更改相应的`org.eclipse.wst.validation.prefs`设置

```
vals/org.eclipse.wst.xml.core.xml/global=FF03 
```

例如，禁用 XML 的验证。您只能`m2e`使用配置文件激活它，如此处所示

[https://github.com/trajano/jee/blob/master/jee-domain-api/pom.xml#L24](https://github.com/trajano/jee/blob/master/jee-domain-api/pom.xml#L24)

```
<profile>
  <id>m2e</id>
  <activation>
    <property>
      <name>m2e.version</name>
    </property>
  </activation>
  <build>
    <plugins>
      <plugin>
        <groupId>net.trajano.mojo</groupId>
        <artifactId>m2e-codestyle-maven-plugin</artifactId>
        <executions>
          <execution>
            <goals>
              <goal>configure</goal>
            </goals>
          </execution>
        </executions>
        <dependencies>
          <dependency>
            <groupId>net.trajano</groupId>
            <artifactId>coding-standards</artifactId>
            <version>${coding-standards.version}</version>
          </dependency>
        </dependencies>
      </plugin>
    </plugins>
  </build>
</profile> 
```

# c - 编写 typedef 函数

> ID：14006326
> 
> 赞同：0
> 
> 时间：2012-12-22T20:26:35.263
> 
> 标签：c

在头文件中，我有以下行：

```
typedef int comparator(int* left, int* right); 
```

但是当我尝试为它编写一个函数定义时：

```
int comparator (int* left, int* right){
    if(left<right) {
        return 1;
    } else if(right>left) {
        return -1;
    } else {
        return 0;
    }   
} 
```

我得到的错误是：

> file.c:10：错误：“比较器”重新声明为不同类型的符号

该函数必须是 typedef 的，因为稍后在头文件中它会在方法原型中使用，如下所示：

```
struct bst_node** search(struct bst_node** root, comparator compare, void* data); 
```

那么这个方法是如何构造的呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T20:28:30.070

在你的头文件中你应该有

```
 int comparator(int* left, int* right); 
```

您没有声明类型，而只是声明了一个函数。

您可以声明一个称为比较器的函数指针类型...

```
typedef int (*comparator)(int* left, int* right); 
```

但是您不会再创建一个称为比较器的函数。你只需要制作一个具有相同签名的函数

```
int ascending_comparator(int* left, int* right)
{
    // comparison
} 
```

然后打电话

```
search(root, ascending_comparator, data); 
```

另外，我有一种感觉，您不想传递 int* 而是传递实际的 int，或者在您的函数中您不想比较指针，而是比较每个 int 指向的值，例如

```
int comparator (int* left, int* right){
    if(*left < *right) {
        return 1;
    } else if(*right > *left) {
        return -1;
    } else {
        return 0;
    }   
} 
```

但可能您想要比较存储整数的内存位置。

你的比较也是一样的

```
if(left < right) 
```

是相同的

```
if( right > left) 
```

所以也许你想要

```
 int comparator (int* left, int* right){
        if(*left < *right) {
            return 1;
        } else if(*left > *right) {
            return -1;
        } else {
            return 0;
        }   
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T20:28:19.917

我怀疑您实际上并不想创建 typedef，而是想使用原型声明函数。写就够了

```
int comparator(int *left, int *right); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T20:37:42.003

如果`typedef`不是错误，你现在有一个被调用的类型`comparator`，你不能使用这个标识符作为一个函数，不管现有类型是否是一个函数指针，它和写这个一样：

```
typedef int myType;

int myType(int, int); 
```

你可以`typedef`像这样使用它：

```
typedef int (* comparator)(int, int);

int comparison(int, int);
void sort(int [], comparator);

int main(void)
{
  int array[10];
  sort(array, comparison);
} 
```

如果您正在寻找函数声明并且这`typedef`是一个错误，那么其他答案已经为您提供了解决方案。

**编辑**：也许我错了，但是阅读评论，您似乎对`typedef`. 函数有它们的类型（`main`可以有 type`int ()(void)`或`int ()(int, char **)`），你只是说`comparator`可以用作类型，这意味着`int ()(int *, int *)`.

如果你写：

```
typedef double real; 
```

您没有创建（从技术上讲，*定义*）任何`double`对象，您只是在说“从现在开始，`real`意味着`double`”。

# html - rails：gmaps4rails gem在部署后不显示侧边栏

> ID：14006329
> 
> 赞同：2
> 
> 时间：2012-12-22T20:26:50.660
> 
> 标签：html, ruby-on-rails, ruby, google-maps, gmaps4rails

我有一个非常小的问题，它对网站来说是一个巨大的功能。简单概述一下，我在开发模式下开发了 rails 应用程序，并使用了运行良好的 gmaps4rails 应用程序。但是我将应用程序部署到 Heroku，现在 gmaps4rails 没有显示侧边栏。

下面是它应该是什么样子的图像： [image](http://i.stack.imgur.com/UJQ1X.png) 因此，当用户单击任何侧边栏条目时，它会将用户带到地图上的正确标记处。

下面是它在生产/Heroku 图像中如何呈现的 [图像](http://i.stack.imgur.com/vlNzU.png) 如您所见，没有侧边栏条目。

在查看呈现的源代码时，有一个区别。在开发模式下，存在`Gmaps.map.markers_conf.list_container = "ranchlist";`这行代码。此代码是获取列表并显示它的代码。

下面是视图本身的代码：

```
<div id="mapscontainer">
<%= gmaps("markers" => {"data" => @json, "options" => {"list_container" => "ranchlist"}}, 
    :map_options => {"auto_adjust" => true, "zoom" => 17,  
                                      :raw => '{ 
                                       panControl: true,
                                       zoomControl: true,
                                       mapTypeControl: false,
                                       scaleControl: false,
                                       streetViewControl: false,
                                       overviewMapControl: false,
                                       scrollwheel: false,
                                       zoom: 20,
                                       }' 
                          },
          :markers => { :data => @json  } 
)%>

<div id="ranchcontainer">
<ul id="ranchlist"><h2>Find A Mash's Wing Ranch <span style="font-size:25px;"><sup>&reg;</sup></span></h2>
<h1>Near You</h1></br>  
<%= image_tag("locations/locations_line.png", :class => "lineseperator") %> 
</ul>
</div> 
</div> 
```

# php - 当我启动 Apache 时 XAMPP 崩溃

> ID：14006332
> 
> 赞同：-1
> 
> 时间：2012-12-22T20:27:05.153
> 
> 标签：php, mysql, xampp

当我尝试从 XAMPP 启动 Apache 时怎么会崩溃？请留下一个解决方案。我相信我正确安装了它，并且 MySQL 运行良好，但是每当我尝试启动 Apache 时，XAMPP 就会崩溃。

错误信息是：

> 检测到问题！
> “系统”正在使用端口！
> 没有配置的免费端口，Apache 将不会启动！
> 您需要卸载/禁用/重新配置阻塞应用程序或重新配置 Apache 以侦听不同的端口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:36:39.507

> “系统”正在使用端口！没有配置的免费端口，Apache 将不会启动！您需要卸载/禁用/重新配置阻塞应用程序或重新配置 Apache 以侦听不同的端口

您的 Apache 不会崩溃，它只是无法启动，因为它尝试绑定的端口（通常是 80）正在使用中。

另一个 Web 服务器或 Skype 可能是原因。

[http://www.mydigitallife.info/disable-skype-from-using-opening-and-listening-on-port-80-and-443-on-local-computer/](http://www.mydigitallife.info/disable-skype-from-using-opening-and-listening-on-port-80-and-443-on-local-computer/)

# android - OpenCV / Android BufferQueue 错误：表面纹理已被放弃

> ID：14006337
> 
> 赞同：6
> 
> 时间：2012-12-22T20:27:28.820
> 
> 标签：android, opencv

Android 和 OpenCV 的新手。一直在尝试实现新书《*Mastering OpenCV with Practical Computer Vision Projects》*中的代码。该应用程序基本上使用 OpenCV 在相机预览上渲染卡通化图像。您可以触摸屏幕保存卡通化图像。

作者的源代码位于[此处](https://github.com/MasteringOpenCV/code/tree/master/Chapter1_AndroidCartoonifier)。

我对 CartoonifierApp.java 文件做了一个小的修改（见下文），以便我可以使用[OpenCV 管理器](https://play.google.com/store/apps/details?id=org.opencv.engine&hl=en)应用程序静态加载卡通化器库（原始代码引发 UnsatisfiedLinkError）。

我面临的问题是，当我将应用程序加载到我的 Galaxy Nexus (Android 4.1.1) 上时，我得到一个空白的黑屏。我的 LogCat 说：

> E/BufferQueue(4744): [unnamed-4744-0] setBufferCount: SurfaceTexture 已被放弃！E/Cartoonifier::SurfaceView(4744): startPreview() 失败

我认为这是一个内存问题。我知道 cpp 代码可以正常工作，因为它在我的计算机上运行良好——尽管在相对较新的笔记本电脑（华硕 U46E）上渲染速度很慢。

我不知道如何解决这个问题。我发现的唯一有用的建议是[这里](http://answers.opencv.org/question/2564/tuto-android-411-opencv-242-nexus-s/)。如果我在 CatoonifierVewBase.java 中替换我的 setPreview 方法

```
 if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB)
     mCamera.setPreviewTexture( new SurfaceTexture(10) );
 else
     mCamera.setPreviewDisplay(null); 
```

和

```
 mCamera.setPreviewDisplay(mHolder); 
```

然后会发生什么是相机正常工作，我可以通过触摸屏幕保存卡通化图像。请注意，这并不是我想要的结果，因为我想在相机预览中不断卡通化图像。相机只能工作，因为我没有写到表面视图（至少这是我的理解）。前面提到的[网站](http://answers.opencv.org/question/2564/tuto-android-411-opencv-242-nexus-s/)中的答案有一些解决方法，但我不知道他在说什么。

顺便说一句，我已经尝试了所有示例 OpenCV4Android 应用程序，它们工作得很好。我也在使用 OpenCV 2.4.3 版。API 级别目标是 15。

完整的Logcat：

> 12-22 15:33:07.966：I/CartoonifierApp(5999)：实例化新类 com.Cartoonifier.CartoonifierApp 12-22 15:33:07.966：I/CartoonifierApp(5999)：调用 onCreate 12-22 15:33:07.966 : I/CartoonifierApp(5999): 试图加载 OpenCV 库 12-22 15:33:07.982: I/Cartoonifier::SurfaceView(5999): 实例化新类 com.Cartoonifier.CartoonifierView 12-22 15:33:07.990: I /CartoonifierApp(5999): onResume 12-22 15:33:07.990: I/Cartoonifier::SurfaceView(5999): openCamera 12-22 15:33:07.990: I/Cartoonifier::SurfaceView(5999): releaseCamera 12-22 15:33:08.099: D/OpenCVManager/Helper(5999): 服务连接创建 12-22 15:33:08.099: D/OpenCVManager/Helper(5999): 试图获取库路径 12-22 15:33:08.138: D/OpenCVManager/Helper(5999): 试图获取库列表 12-22 15:33:08.169: D/OpenCVManager/Helper(5999): 库列表：“” 12-22 15:33:08.169: D/OpenCVManager/Helper(5999): 第一次尝试加载库 12-22 15:33:08.169: D/OpenCVManager/Helper(5999): 试图初始化 OpenCV 库 12- 22 15:33:08.169: D/OpenCVManager/Helper(5999): 试图加载库 /data/data/org.opencv.engine/lib/libopencv_java.so 12-22 15:33:08.169:
> 
> D/dalvikvm(5999)：试图加载 lib /data/data/org.opencv.engine/lib/libopencv_java.so 0x41936a40 12-22
> 
> 15:33:08.193：D/dalvikvm(5999)：添加共享库 /data/data/org.opencv.engine/lib/libopencv_java.so 0x41936a40 12-22
> 
> 15:33:08.193：D/OpenCVManager/Helper(5999)：OpenCV 库初始化没问题！
> 
> 12-22 15:33:08.193：D/OpenCVManager/Helper(5999)：首次尝试加载库是可以的 12-22 15:33:08.193：D/OpenCVManager/Helper(5999)：初始化完成，状态为 0 12- 22 15:33:08.193：D/OpenCVManager/Helper(5999)：与服务解除绑定 12-22 15:33:08.200：D/OpenCVManager/Helper(5999)：使用回调调用 12-22 15:33:08.200：I /CartoonifierApp(5999): OpenCV 加载成功
> 
> 12-22 15:33:08.200: D/dalvikvm(5999): 试图加载 lib /data/data/com.Cartoonifier/lib/libcartoonifier.so 0x41936a40 12-22
> 
> 15:33:08.200：D/dalvikvm(5999)：添加了共享库 /data/data/com.Cartoonifier/lib/libcartoonifier.so 0x41936a40 12-22
> 
> 15：33：08.200：D/dalvikvm（5999）：在 /data/data/com.Cartoonifier/lib/libcartoonifier.so 0x41936a40 中找不到 JNI_OnLoad，跳过初始化 12-22 15：33：08.200：D/OpenCVManager/Helper（ 5999): 服务连接已创建 12-22 15:33:08.200: D/OpenCVManager/Helper(5999): 试图获取库路径 12-22
> 
> 15:33:08.232：D/OpenCVManager/Helper(5999)：试图获取库列表 12-22 15:33:08.271：D/OpenCVManager/Helper(5999)：库列表：“”
> 
> 12-22 15:33:08.271: D/OpenCVManager/Helper(5999): 第一次尝试加载库 12-22 15:33:08.271: D/OpenCVManager/Helper(5999): 试图
> 
> 初始化 OpenCV 库 12-22 15:33:08.271：D/OpenCVManager/Helper(5999)：尝试加载库 /data/data/org.opencv.engine/lib/libopencv_java.so 12-22 15:33:08.271： D/dalvikvm(5999)：试图加载 lib /data/data/org.opencv.engine/lib/libopencv_java.so 0x41936a40 12-22
> 
> 15：33：08.271：D/dalvikvm（5999）：共享库'/data/data/org.opencv.engine/lib/libopencv_java.so'已经加载到相同的CL 0x41936a40 12-22 15：33：08.271：D/ OpenCVManager/Helper(5999)：OpenCV 库初始化没问题！12-22 15:33:08.271: D/OpenCVManager/Helper(5999): 第一次尝试加载库是可以的
> 
> 12-22 15:33:08.271：D/OpenCVManager/Helper(5999)：初始化完成，状态为 0 12-22 15:33:08.271：D/OpenCVManager/Helper(5999)：与服务解除绑定 12-22 15:33 :08.271: D/OpenCVManager/Helper(5999): 使用回调调用 12-22 15:33:08.271: I/CartoonifierApp(5999): OpenCV 加载成功 12-22 15:33:08.279: D/dalvikvm(5999):试图加载 lib /data/data/com.Cartoonifier/lib/libcartoonifier.so 0x41936a40 12-22 15:33:08.279: D/dalvikvm(5999): Shared lib '/data/data/com.Cartoonifier/lib/libcartoonifier .so' 已经在同一个 CL 0x41936a40 12-22 15:33:08.302 中加载：I/Cartoonifier::SurfaceView(5999):surfaceCreated 12-22 15:33:08.302:I/Cartoonifier::SurfaceView(5999):surfaceChanged( ）。窗口尺寸：1196x670 12-22 15:33:08.302: I/Cartoonifier::SurfaceView(5999): setupCamera(1196x670) 12-22 15:33:08.302: I/Cartoonifier::
> 
> 12-22 15:33:08.333：I/dalvikvm-heap(5999)：将堆（碎片情况）增加到 11.902MB，分配 1382416 字节
> 
> 12-22 15:33:08.357: D/dalvikvm(5999): GC_CONCURRENT freed 1K, 3% free 12156K/12423K, paused 12ms+1ms,总共24ms
> 
> 12-22 15:33:08.357: D/dalvikvm(5999): WAIT_FOR_CONCURRENT_GC 阻塞 11ms
> 
> 12-22 15:33:08.365: D/dalvikvm(5999): GC_FOR_ALLOC 释放 0K，3% 释放 12156K/12423K，暂停 9ms，总共 9ms
> 
> 12-22 15:33:08.372：I/dalvikvm-heap(5999)：将堆（碎片情况）增加到 13.219MB，分配 1382416 字节
> 
> 12-22 15:33:08.388: D/dalvikvm(5999): GC_CONCURRENT freed 0K, 3% free 13506K/13831K, paused 11ms+1ms,总共21ms
> 
> 12-22 15:33:08.388: D/dalvikvm(5999): WAIT_FOR_CONCURRENT_GC 阻塞 7ms
> 
> 12-22 15:33:08.404: D/dalvikvm(5999): GC_FOR_ALLOC freed <1K, 3% free 13506K/13831K, 暂停 9ms, 共 10ms
> 
> 12-22 15:33:08.411：I/dalvikvm-heap(5999)：将堆（碎片情况）增加到 16.735MB，分配 3686416 字节
> 
> 12-22 15:33:08.427: D/dalvikvm(5999): GC_CONCURRENT freed <1K, 3% free 17106K/17479K, paused 12ms+1ms,总共22ms
> 
> 12-22 15:33:08.427: D/dalvikvm(5999): WAIT_FOR_CONCURRENT_GC 阻塞 10ms
> 
> 12-22 15:33:08.443: D/dalvikvm(5999): GC_FOR_ALLOC freed <1K, 3% free 17106K/17479K, 暂停 10ms, 共 10ms
> 
> 12-22 15:33:08.450：I/dalvikvm-heap(5999)：将堆（碎片情况）增加到 20.250MB，分配 3686416 字节
> 
> 12-22 15:33:08.466: D/dalvikvm(5999): GC_CONCURRENT freed 0K, 2% free 20706K/21127K, paused 12ms+2ms,总共22ms
> 
> 12-22 15:33:08.466: D/dalvikvm(5999): WAIT_FOR_CONCURRENT_GC 阻塞 5ms
> 
> 12-22 15:33:08.466: I/Cartoonifier::SurfaceView(5999): 开始预览
> 
> 12-22 15:33:08.497: E/BufferQueue(5999): [unnamed-5999-0] setBufferCount: SurfaceTexture 已被放弃！
> 
> 12-22 15:33:08.505: E/Cartoonifier::SurfaceView(5999): mCamera.startPreview() 失败

CartoonifierApp.java 的片段显示我的修改

```
private BaseLoaderCallback  mLoaderCallback = new BaseLoaderCallback(this) {
    @Override
    public void onManagerConnected(int status) {
        switch (status) {
            case LoaderCallbackInterface.SUCCESS:
            {
                Log.i(TAG, "OpenCV loaded successfully");

                // Load native library after(!) OpenCV initialization
                System.loadLibrary("cartoonifier");
            } break;
            default:
            {
                super.onManagerConnected(status);
            } break;
        }
    }
};

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    Log.i(TAG, "called onCreate");
    super.onCreate(savedInstanceState);

    Log.i(TAG, "Trying to load OpenCV library");
    if (!OpenCVLoader.initAsync(OpenCVLoader.OPENCV_VERSION_2_4_3, this, mLoaderCallback))
    {
      Log.e(TAG, "Cannot connect to OpenCV Manager");
    }

    requestWindowFeature(Window.FEATURE_NO_TITLE);

    mView = new CartoonifierView(this);
    setContentView(mView);

    // Call our "onTouch()" callback function whenever the user touches the screen.
    mView.setOnTouchListener(this);
}

@Override
protected void onPause() {
    Log.i(TAG, "onPause");
    super.onPause();
    mView.releaseCamera();
}

@Override
public void onResume()
{
    super.onResume();
    Log.i(TAG, "onResume");
    if (!OpenCVLoader.initAsync(OpenCVLoader.OPENCV_VERSION_2_4_3, this, mLoaderCallback))
    {
      Log.e(TAG, "Cannot connect to OpenCV Manager");
    }   

    if( !mView.openCamera() ) {
        AlertDialog ad = new AlertDialog.Builder(this).create();  
        ad.setCancelable(false); // This blocks the 'BACK' button  
        ad.setMessage("Fatal error: can't open camera!");  
        /*ad.setButton("OK", new DialogInterface.OnClickListener() {  
            public void onClick(DialogInterface dialog, int which) {  
                dialog.dismiss();                      
                finish();
            }  
        });  */
        ad.show();
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T21:30:34.270

前段时间在 OpenCV 中解决了这个问题。

不确定是应用程序还是操作系统错误。问题是调用`Bitmap.createBitmap`分离`SurfaceTexture`用于可视化的对象。

解决方法是修改基类的[setupCamera](https://github.com/MasteringOpenCV/code/blob/master/Chapter1_AndroidCartoonifier/Cartoonifier_Android/src/com/Cartoonifier/CartoonifierViewBase.java#L144)`View`方法并更改

```
try {
    setPreview();
} catch (IOException e) {
    Log.e(TAG, "mCamera.setPreviewDisplay/setPreviewTexture fails: " + e);
}

/* Notify that the preview is about to be started and deliver preview size */
onPreviewStarted(params.getPreviewSize().width, params.getPreviewSize().height); 
```

至

```
/* Notify that the preview is about to be started and deliver preview size */
onPreviewStarted(params.getPreviewSize().width, params.getPreviewSize().height);

try {
    setPreview();
} catch (IOException e) {
    Log.e(TAG, "mCamera.setPreviewDisplay/setPreviewTexture fails: " + e);
} 
```

（行的顺序改变了）

# php - 从数据库中读取 0 和 1 并在复选框中检索

> ID：14006347
> 
> 赞同：-1
> 
> 时间：2012-12-22T20:28:37.533
> 
> 标签：php, database, checkbox, html-table, member

我正在尝试使用 PHPmyadmin 数据库创建一个成员表，并且在数据库中，有一个 0 和 1 字段，我想为每个成员转换复选框中的 0 和 1。是一个可编辑的表格，所以表格可能是一个表格。这是我所做的：

```
<?php
include('../../config.php'); 

$result2 = mysql_query("SELECT * FROM acars_users");

echo "<table border='1'>
<tr>
<th>ID</th>
<th>Dados Pessoais</th>
<th>Origem</th>
<th>Dados de Redes</th>
<th width='220px'>Base</th>
<th>Patente</th>
<th>Horas</th>
<th>&Eacute; Ativo?</th>
<th>Dinheiro</th>
<th>Senha</th>
<th>Op&ccedil;&otilde;es</th>
</tr>";

while($row = mysql_fetch_array($result2)) 

  {
  echo "<tr>";
  echo "<td>" . $row['id'] . "</td>";

  echo "<td width='300px'>" . "<form action=editar.php method=POST><input name=username size=7 type=text value=".$row['username']." /></br><input name=nome size=10 type=text value=".$row['nome']." /><input name=sobrenome size=20 type=text value=".$row['sobrenome']." /></br><input name=email size=25 type=text value=".$row['email']." />" . "</td>";

  echo "<td>" . "<input name=datanascimento size=10 type=text value=".$row['datanascimento']." /></br><input name=pais size=10 type=text value=".$row['pais']." /></br><input name=cidade size=30 type=text value=".$row['cidade']." />" . "</td>";

  echo "<td>" . "IVAO:&nbsp;<input name=idivao size=8 type=text value=".$row['idivao']." /></br>VATSIM:&nbsp;<input name=idvatsim size=8 type=text value=".$row['idvatsim']." />" . "</td>";

  echo "<td>" . "<input name=base size=8 type=text value=".$row['base']." />" . "</td>";
  echo "<td>" . "<input name=rank size=10 type=text value=".$row['rank']." /></br>Admin &nbsp;<input name=admin size=1 type=checkbox value=".$row['admin']." /></br>DOV &nbsp; <input name=dov size=1 type=checkbox value=".$row['dov']." /></br>Checador &nbsp; <input name=checador size=1 type=checkbox value=".$row['checador']." />" . "</td>";
  echo "<td>" . "<input name=horas size=6 type=text value=".$row['horas']." />" . "</td>";
  echo "<td>" . "<input type=checkbox name='isactive[]' value=".$row['isactive']." />" . "</td>";
  echo "<td>" . "<input name=dinheiro size=10 type=text value=".$row['dinheiro']." />" . "</td>";
  echo "<td>" . "<input name=password size=10 type=password value=".$row['password']." />" . "</td>";
  echo "<td>" . "<input name=edit_id value=".$row['id']." type=hidden><input type=submit value=Editar ></form><form action=deletarexist.php method=POST><input name=delete_id value=".$row['id']." type=hidden><input type=submit value=Demitir></form>" . "</td>";

  echo "</tr>";
  }

echo "</table>";

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:08:10.087

```
$chkd=$row['isactive']?'checked="checked"':''; // 0: false; 1: true
echo "<td><input type='checkbox' name='isactive[]' value='{$row['isactive']}' $chkd></td>"; 
```

（虽然，您应该考虑使用模板系统（例如 smarty）而不是回显 html 片段。一开始看起来有点奇怪，但是一旦习惯了，您将永远不会回头-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:50:11.683

我猜您希望选中复选框，在这种情况下，您需要将`checked="checked"`属性添加到复选框。

所以你会做的是这样的：

```
if($row['isactive'] == 1){
    echo "<td>" . "<input type='checkbox' name='isactive[]' value=".$row['isactive']. checked='checked' />" . "</td>";
} else {
    echo "<td>" . "<input type='checkbox' name='isactive[]' value=".$row['isactive']." />" . "</td>";
} 
```

对于值，您可能应该有一些东西来识别复选框，例如成员ID，具体取决于您使用它的目的。

# java - 找不到符号 - 变量 mText

> ID：14006348
> 
> 赞同：0
> 
> 时间：2012-12-22T20:28:50.427
> 
> 标签：java

嘿，我一直在写一些代码，它允许用户选择一个文件，一个 txt 文件，然后它读取文件的内容，然后将内容发送到打印机，这种情况下是 hp 8600，但是在编译时我得到一个错误，找不到符号 - 变量 mText，这是为什么，它应该从上面检索 mText，因为它现在应该包含 txt 文件中的所有数据，我做错了什么？

代码：

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.print.*;
import java.text.*;
import java.io.*;
import javax.swing.*;

public class PrintText implements Printable {

    // Below the code will allow the user to select a file and then print out the contents of the file
    public static void main(String[] args) throws IOException {

        //selects the file
        JFileChooser chooser = new JFileChooser();
        chooser.showOpenDialog(null);
        File file = chooser.getSelectedFile();
        String filename = file.getName();
        //System.out.println("You have selected: " + filename);  testing to see if file seleected was right
        String path = file.getAbsolutePath();

        //Reads contents of file into terminal 
        //FileReader fr = new FileReader("filename");
        // FileReader fr = new FileReader("D:/Documents/" + "filename")); 

        FileReader fr = new FileReader(path); 
        BufferedReader br = new BufferedReader(fr); 
        String mText; 
        while((mText = br.readLine()) != null) { 
            //Displays the contents of the file in terminal
            System.out.println(mText); 
        } 
        //fr.close(); 
    } 

        //private static final String mText = 
        //    "This is a test to see if this text will be printed "; //This works perfectly fine

        private static final AttributedString mStyledText = new AttributedString(mText);

    /**
     * Print a single page containing some sample text.
     */
    static public void printer(String args[]) {
        /* Get the representation of the current printer and 
         * the current print job.
         */
        PrinterJob printerJob = PrinterJob.getPrinterJob();
        /* Build a book containing pairs of page painters (Printables)
         * and PageFormats. This example has a single page containing
         * text.
         */
        Book book = new Book();
        book.append(new PrintText(), new PageFormat());
        /* Set the object to be printed (the Book) into the PrinterJob.
         * Doing this before bringing up the print dialog allows the
         * print dialog to correctly display the page range to be printed
         * and to dissallow any print settings not appropriate for the
         * pages to be printed.
         */
        printerJob.setPageable(book);
        /* Show the print dialog to the user. This is an optional step
         * and need not be done if the application wants to perform
         * 'quiet' printing. If the user cancels the print dialog then false
         * is returned. If true is returned we go ahead and print.
         */
        boolean doPrint = printerJob.printDialog();
        if (doPrint) {
            try {
                printerJob.print();
            } catch (PrinterException exception) {
                System.err.println("Printing error: " + exception);
            }
        }
    }

    /**
     * Print a page of text.
     */
    public int print(Graphics g, PageFormat format, int pageIndex) {
        /* We'll assume that Jav2D is available.
         */
        Graphics2D g2d = (Graphics2D) g;
        /* Move the origin from the corner of the Paper to the corner
         * of the imageable area.
         */
        g2d.translate(format.getImageableX(), format.getImageableY());
        /* Set the text color.
         */
        g2d.setPaint(Color.black);
        /* Use a LineBreakMeasurer instance to break our text into
         * lines that fit the imageable area of the page.
         */
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {
            TextLayout layout = measurer.nextLayout(wrappingWidth);
            pen.y += layout.getAscent();
            float dx = layout.isLeftToRight()? 0 : (wrappingWidth - layout.getAdvance());
            layout.draw(g2d, pen.x + dx, pen.y);
            pen.y += layout.getDescent() + layout.getLeading();
        }
        return Printable.PAGE_EXISTS;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:34:36.200

目前`mText`只定义在`main`方法的范围内。如果您希望在以下构造函数中使用它，则需要创建`mText`一个`static`类变量`mStyledText`：

```
private static String mText; 
```

然而，拥有非`final` `static`类变量被认为是不好的做法 - 为什么不在需要时`AttributedString`在`print`方法中创建：

```
AttributedString mStyledText = new AttributedString(mText); 
```

`main`此外，您在该方法中有很多功能。我会将它移到一个类*实例*方法中，您可以在其中完全避免使用任何`static`变量。

# java - 如何使用 Java 访问 CD 的原始字节？

> ID：14006358
> 
> 赞同：-1
> 
> 时间：2012-12-22T20:29:52.853
> 
> 标签：java, windows, cd-rom

不确定这是否可行，但我可以使用 Java 访问光盘的原始字节吗？如果是这样，你能提供一个代码示例吗？我使用的是 Windows，不介意平台特定的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:39:30.423

我很确定你不能在 Java 中做到这一点。[您必须使用 Windows API 编写本机 C 代码（从此处](http://support.microsoft.com/kb/138434)描述的 CreateFile 开始），然后使用Java中的[JNI调用它。](http://docs.oracle.com/javase/6/docs/technotes/guides/jni/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:53:09.007

您需要使用特定于平台的 API 询问操作系统 - 在 Linux 下，很可能有一个 /dev 文件，

# json - 高图表，跳过日期

> ID：14006360
> 
> 赞同：0
> 
> 时间：2012-12-22T20:30:12.597
> 
> 标签：json, highcharts

我从 json 文件将数据加载到图表中。图表如下所示：http: [//jsfiddle.net/jk171505/zC9dP/1/](http://jsfiddle.net/jk171505/zC9dP/1/)

有没有办法“简化”显示的数据，比如平均值？

```
 xAxis: {
        type: 'datetime',
        maxZoom: 48 * 3600 *1000
    }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:57:39.463

看起来 highcharts API 中没有任何平均函数。[http://api.highcharts.com/highcharts](http://api.highcharts.com/highcharts) 因此，您可能必须自己预处理该数据以获得平均值。在您的 jsfiddle 上，您有一个带有数据数组的对象。这是您如何循环获得整个集合的平均值的方法。

```
var sum = 0;
dataObj.series[0].data.forEach(function(point){
 sum += point[1]
});
var average = sum/dataObj.series[0].data.length; 
```

如果您想保留原始数据集并仅操作值，您还可以循环并修改每个值。

```
dataObj.series[0].data.forEach(function(point){
 point[1] = average;
}); 
```

我不太了解您的应用程序，但您可能不想获得整个集合的平均值，或者将集合中的每个点都更改为相同的值。因此，您应该将设置分解为块并获取每个块的平均值，以便以这种方式绘制它。根据您的应用程序发挥创意，但看起来您必须对数据进行预处理。

# python - 并行处理大量数据

> ID：14006363
> 
> 赞同：5
> 
> 时间：2012-12-22T20:30:32.693
> 
> 标签：python, fabric, boto, data-processing

我是一名 Python 开发人员，具有很好的 RDBMS 经验。我需要处理相当大量的数据（大约 500GB）。数据位于 s3 存储桶中的大约 1200 个 csv 文件中。我用 Python 编写了一个脚本，可以在服务器上运行它。但是，速度太慢了。根据目前的速度和数据量，通过所有文件大约需要 50 天（当然，截止日期在此之前是很好的）。

注意：处理是您的基本 ETL 类型的东西 - 没什么可怕的幻想。我可以轻松地将其泵入 PostgreSQL 中的临时模式，然后在其上运行脚本。但是，再一次，从我最初的测试来看，这会变慢。

注意：一个全新的 PostgreSQL 9.1 数据库将是它的最终目的地。

因此，我正在考虑尝试启动一堆 EC2 实例以尝试分批（并行）运行它们。但是，我以前从未做过这样的事情，所以我一直在四处寻找想法等。

同样，我是一名 python 开发人员，所以 Fabric + boto 似乎很有希望。我不时使用boto，但从未使用过Fabric。

我从阅读/研究中知道，这对于 Hadoop 来说可能是一项很棒的工作，但我不知道，也负担不起雇用它完成的费用，而且时间线不允许学习曲线或雇用某人。我也不应该，这是一种一次性的交易。所以，我不需要构建一个非常优雅的解决方案。我只需要让它工作并能够在今年年底之前获得所有数据。

另外，我知道这不是一个简单的 stackoverflow 问题（类似于“如何在 python 中反转列表”）。但是，我希望有人读到这篇文章并“说，我做了类似的事情并使用 XYZ ......这太棒了！”

我想我要问的是有没有人知道我可以用来完成这项任务的任何东西（鉴于我是一名 Python 开发人员，我不知道 Hadoop 或 Java - 并且有一个紧迫的时间表可以防止我正在学习 Hadoop 等新技术或学习一门新语言）

谢谢阅读。我期待任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:58:57.760

您是否进行了一些性能测量：瓶颈在哪里？是 CPU 限制、IO 限制还是 DB 限制？

当它受 CPU 限制时，您可以尝试使用 pypy 之类的 python JIT。

当它是 IO 绑定时，您需要更多的 HD（并在它们上放置一些条带化 md）。

当它是数据库绑定时，您可以尝试先删除所有索引和键。

上周我将 Openstreetmap 数据库导入到我服务器上的 postgres 实例中。输入数据约为450G。预处理（在这里用 JAVA 完成）刚刚创建了可以使用 postgres 'copy' 命令导入的原始数据文件。导入后生成密钥和索引。

导入所有原始数据大约需要一天时间 - 然后需要几天时间来构建键和索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T20:48:49.020

我前段时间做过这样的事情，我的设置就像

*   一个多核实例（x-large 或更多），将原始源文件 (xml/csv) 转换为中间格式。您可以在其上并行运行转换器脚本的 (num-of-cores) 副本。由于我的目标是 mongo，所以我使用 json 作为中间格式，在您的情况下它将是 sql。

*   此实例附加了 N 个卷。一旦卷变满，它就会分离并附加到第二个实例（通过 boto）。

*   第二个实例运行一个 DBMS 服务器和一个将准备好的（sql）数据导入数据库的脚本。我对 postgres 一无所知，但我猜它确实有一个类似`mysql`or的工具`mongoimport`。如果是，请使用它进行批量插入，而不是通过 python 脚本进行查询。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-23T16:39:45.730

我经常将 SQS/S3/EC2 组合用于这种类型的批处理工作。在 SQS 中为所有需要执行的工作排队消息（分成一些相当小的块）。启动 N 个 EC2 实例，这些实例配置为开始从 SQS 读取消息、执行工作并将结果放入 S3，然后才从 SQS 中删除消息。

你可以把它扩大到疯狂的水平，它对我来说一直很有效。就您而言，我不知道您是将结果存储在 S3 中还是直接转到 PostgreSQL。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-23T09:18:58.053

您可能会从 Amazon Elastic Map Reduce 形式的 hadoop 中受益。无需太深入，它可以被视为一种在并行（Map 阶段）中将一些逻辑应用于海量数据的方法。
还有一种称为 hadoop 流的 hadoop 技术——它可以使用任何语言（如 python）的脚本/可执行文件。
您会发现另一个有用的 hadoop 技术是 sqoop - 它在 HDFS 和 RDBMS 之间移动数据。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-23T17:37:30.587

您还可以`ipython`在 EC2 上非常轻松地使用并行计算，`StarCluster`
`StarCluster`它是一个用于创建和管理托管在 Amazon 的 EC2 上的分布式计算集群的实用程序。

[http://ipython.org/ipython-doc/stable/parallel/parallel_demos.html](http://ipython.org/ipython-doc/stable/parallel/parallel_demos.html)
[http://star.mit.edu/cluster/docs/0.93.3/index.html](http://star.mit.edu/cluster/docs/0.93.3/index.html)
[http://star.mit.edu/ cluster/docs/0.93.3/plugins/ipython.html](http://star.mit.edu/cluster/docs/0.93.3/plugins/ipython.html)

# wpf - 来自特定公司的计算机上的 WPF 应用程序“没有响应”

> ID：14006364
> 
> 赞同：3
> 
> 时间：2012-12-22T20:30:44.767
> 
> 标签：wpf, devexpress

我们遇到了运行我们基于 WPF 的程序的客户的问题。他可以启动应用程序，创建新文档，在树视图中导航菜单项以查看文档的不同部分，更改几乎（如果不是全部）我们的文本框值，将项目添加到列表（使用带有底层命令的按钮），等等，都没有任何问题。但是，如果他试图通过打开下拉列表来更改组合框的值，则程序将“无响应”并且 CPU 使用 100% 的容量（在一个内核上）。它也发生在其他随机的地方，但组合框总是失败。如果他只使用键盘并使用选项卡导航到组合框，他可以使用箭头键更改其值而不会出现问题。该程序检测到更改，并相应地采取行动，而不会出现任何问题或性能下降。

一些可能相关或不相关的信息：

*   我们为所有 GUI 组件使用 DevExpress，主题为“Seven”（我们测试了它们的版本 12.1.8 和 12.2.4。问题是一样的……）
*   我们的程序由许多文本框、组合框、数据网格、列表框等组成。我们正在使用停靠面板（如 Visual Studio），因此用户可以按照自己的方式修改布局。我们使用 WPF 3D 进行图形显示和编辑。
*   我们的客户正在使用带有 Windows 7 Professional Edition SP1（64 位）的 HP 笔记本电脑（挪威语）
*   他的分辨率：1920 x 1200
*   他的窗口缩放系数：100%（您可以通过更改 DPI 来放大所有内容）
*   他安装的.Net框架版本：4.0.30319.296
*   他是他计算机上的本地管理员。
*   无论安装位置如何，都会出现此问题。（我们已经尝试过 ClickOnce，我们的主要分发方法，并将已编译的发布文件以压缩 zip 的形式发送给他。没有区别……）
*   这个客户的电脑和他公司的另外两台电脑上的问题都是一样的，所以这不仅仅是巧合。
*   我们通过删除特定字体缓存尝试了“标准”WPF-applications-hangs-solution，但没有成功。(http://support.microsoft.com/kb/937135?wa=wsignin1.0)
*   客户住在 700 公里外，所以我们希望避免到他那里调试他的电脑。
*   即使设置尽可能相同，我们也无法在我们的任何计算机上重现该问题。（相同的 Windows、相同的 .Net 等等……）
*   我们向他发送了我们程序的一个特殊版本，该版本记录了整个应用程序中所有公共方法和属性的所有入口和出口（我们已经为其编写了源代码）。将他的日志文件和我们的日志文件进行比较，以获得一个非常简单的操作，该操作在我们的计算机上运行良好，但在他的计算机上运行良好，没有发现任何结果。这些文件看起来几乎是一样的，除了他没有包括当他点击退出按钮时运行的标准退出程序，这是因为他不得不“杀死”应用程序。除了 GUI 相关调用在或多或少随机时间发生的唯一区别（例如检查它是否可以执行的按钮命令）。它记录在他和我们的日志中，只是在不同的时间。（如果我们比较在同一台计算机上完成的两个不同的日志，我们会得到相同的结果，

我们这里的选择已经不多了。

*   有没有人对我们可以做些什么来解决这个问题有任何建议？
*   您是否听说过其他有类似问题的用户？（解决了吗？怎么解决的？）
*   有谁知道远程调试的好方法？（我们可以给他发送一些东西，以便他在发生这种情况时获得调用堆栈吗？）

任何提示都非常感谢！

最好的问候， 斯韦雷

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T09:50:28.300

如果其他人遇到这种情况，我会发布解决方案！

这实际上是 .Net 框架中的一个错误。可以在此处找到更多信息以及修复问题的补丁程序链接： [WPF 应用程序会固定 CPU 并将应用程序锁定在某些计算机上而不是其他计算机上的原因可能是什么？](https://stackoverflow.com/questions/9028598/what-could-be-reasons-a-wpf-app-would-pin-the-cpu-and-lock-the-app-on-some-compu)

感谢您为我提供答案的所有提示。

斯韦雷

# c++ - c ++线程等待用户IO（'getchar（）'）在主进程中挂起'Py_Initialize（）'

> ID：14006367
> 
> 赞同：1
> 
> 时间：2012-12-22T20:31:01.537
> 
> 标签：c++, python, multithreading

我只是偶然发现了一个非常奇怪的问题。在我的代码中，我启动了一个线程来等待用户输入——以防用户想要中断主进程。在该线程运行之后，我尝试使用 python 进行一些计算。`getchar()`线程使用-- 如果输入是返回来查找用户输入，则设置一个布尔标志以使主进程停止执行其正在执行的操作。主进程每隔一段时间检查一次这个标志，如果它被设置，它会采取适当的行动。

示意图：

```
bool volatile stopper = false;
thread stopThread(interrupt, &stopper);
while( !stopper ) {
    /* ... stuff ... */
    Py_Initialize();                            // this doesn't return unless 'interrupt()' completes.
    /* ... do things with python object ... */
} 
```

中断方法看起来像，

```
void interrupt(bool *st) {
    char ch;   
    while( ch != '\n' ) {
        ch = getchar();
    }
    *st = true;
} 
```

如果我`getchar()`用 a 替换 while 循环`sleep(10)`，则`Py_Initialize()`返回正常，并且一切正常。为什么 IO 请求阻塞`Py_Initialize()`？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T00:41:51.373

当你调用一个 I/O 函数`getchar`时，你会在某个 I/O 对象上持有一个锁，直到函数终止。在多线程程序中无限期地持有锁是非常糟糕的形式，因为这将导致任何试图获取该锁的线程无限期地阻塞。不要在多线程程序中调用阻塞 I/O 函数。

# c++ - ltrace：调用嵌套错误

> ID：14006368
> 
> 赞同：2
> 
> 时间：2012-12-22T20:31:29.297
> 
> 标签：c++, linux, ltrace

我正在运行 ltrace -c -C ./a.out 对我的应用程序进行一些分析，但它给出的错误如下：

错误：调用嵌套太深！

我的代码很简单

```
void StrinstrTest(long loop/*4000*/)
{

        std::string s("SS");
        double price = 90;
        double b = 90;
        double a= 90;
        int msize = 19;
        std::string first("FIRST");
        for(int i = 0 ; i<loop; i++)
        {
                std::stringstream ss;
                ss << "Hi "
                 << 'D' << s << 'D' << price
                 << 'D' << msize << endl;
                {
                     ss << 'D' << first << 'D'
                     << b<< 'D' << a;

                }
                string s = ss.str();
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-28T10:19:54.177

您必须使用旧版本的`ltrace`.

它与最新版本（至少 0.7.3 及更高版本）按预期工作。

# c++ - DirectX ID3DXEFFECT::BeginPass()/EndPass() 问题

> ID：14006369
> 
> 赞同：1
> 
> 时间：2012-12-22T20:31:31.567
> 
> 标签：c++, winapi, directx, effects, directx-9

我在 3D 模型上使用带效果的 DirectX 9。我已经正确加载了所有模型和效果，并且过去使用这种方法渲染蒙皮网格没有任何问题......但是，我最近开始在我的项目中使用 DXUT。现在，使用 DXUT，当我尝试渲染蒙皮网格时，会出现效果问题。我已经找到了问题，但不知道如何解决。以下代码在调用 DrawMeshContainer( LPD3DXMESHONTAINER pMeshContainer ) 期间发生。问题是对 BeginPass()/EndPass() 的调用。使用此效果的所有网格都可以正确渲染，但是当我尝试渲染不使用该效果的对象时，它们会呈现完全黑色……您可以看到该对象，但没有颜色。我在对对象的渲染调用之前和之后检查了照明状态，但这似乎是有序的。这是问题行的代码。如果我将这些行注释掉，其他对象会正确呈现

```
for(DWORD iAttrib = 0; iAttrib < numAttributes; ++iAttrib)
{
...
DWORD numPasses = 0;
g_pEffect->Begin(&numPasses D3DFX_DONOTSAVESTATE); // writing from memory...2nd param may use different identifier

for(DWORD iPass = 0; iPass < numPasses; ++iPass)
{
g_pEffect->BeginPass(iPass); // Begin Problem

pMeshContainer->MeshData.pMesh->DrawSubset( iAttrib );

g_pEffect->EndPass(); // End Problem
}
g_pEffect->End();

m_d3ddev->SetVertexShader( NULL );

}
} 
```

BeginPass()/EndPass() 是否会导致我需要考虑的某种类型的状态更改？我还尝试在调用 ID3DXMESH::DrawSubset() 上方使用 g_pEffect->CommitChanges() ，但没有成功……有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T03:52:11.750

问题已修复...我必须在过程结束时将像素着色器和顶点着色器一起设置为 NULL：

```
m_d3ddev->SetPixelShader( NULL )... 
```

# eclipse - Eclipse 打开任何文件（类似于打开类型 CTRL+SHIFT+T）

> ID：14006375
> 
> 赞同：3
> 
> 时间：2012-12-22T20:32:28.940
> 
> 标签：eclipse

在 Eclipse 中，我可以通过单击 CTRL+SHIFT+T 非常快速地找到一个类，然后开始输入类的名称，它会自动列出与该模式匹配的所有类。

是否有类似的功能可以考虑工作空间中的所有文件（或者如果可以将其配置为仅考虑某些文件类型则更好）？

我知道有通常的搜索功能，但我想在输入字母时获得建议列表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T20:36:34.523

Ctrl-Shift-R。打开***R** *资源

# php - SQL 检索数据时出错

> ID：14006376
> 
> 赞同：1
> 
> 时间：2012-12-22T20:32:38.590
> 
> 标签：php, mysql, sql

无论我更改什么，我都会继续运行此代码并得到相同的错误。

```
require('common.php');
$charname = $_SESSION['user']['username'];
$query = "SELECT group, guild, username, class, level 
      FROM DD_users 
      WHERE username = '".$charname."'";
try
{
// These two statements run the query against your database table.
$stmt = $db->prepare($query);
$stmt->execute();
}
catch(PDOException $ex)
{
// Note: On a production website, you should not output $ex->getMessage().
// It may provide an attacker with helpful information about your code. 
die("Failed to run query: " . $ex->getMessage());
}

// Finally, we can retrieve all of the found rows into an array using fetchAll
$rows = $stmt->fetchAll();

//print_r($rows);
$group = $rows['0']['adminaccess'];
$guild = $rows['0']['guild'];
$username = $rows['0']['username'];
$class = $rows['0']['class'];
$level = $rows['0']['level']; 
```

它返回此错误
`SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'group, guild, username, class, level FROM DD_users ' at line 1` 显然我需要更多文本才能编辑此错误...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T20:45:00.903

你忘记了`'`字符：

```
$query = "SELECT group, guild, username, class, level 
          FROM DD_users 
          WHERE username = '".$charname."'"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T20:34:37.210

试试这个：

`$query = "SELECT group, guild, username, class, level FROM DD_users WHERE username = '".$charname."'";`

注意额外的引号`'`。如果您查询字符串，则它们是必需的。

另外：`group`可能是保留关键字。您需要使用 `-style 引号或 .brackets 来逃避它`[`。试试哪个有效

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-22T20:35:24.913

注意 group 关键字是保留的，尝试将其括在反引号中 `

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T21:03:21.930

类似下面的内容可以为您省去使用单引号的麻烦——但更重要的是，它还可以保护您免受 SQL 注入攻击。您*永远*不想接受输入并将其直接推送到 SQL 查询字符串中。可怕的事情可能发生。

注意`?`查询字符串中的标记，以及通过调用`$charname`替换值的传递。这样做可以让底层库代码安全地将 $charname 引用到查询中。`?``execute(array($charname))`

```
require('common.php');
$charname = $_SESSION['user']['username'];
$query = "SELECT `group`, guild, username, class, level 
          FROM DD_users 
          WHERE username = ?";
try
{
    // These two statements run the query against your database table.
    $stmt = $db->prepare($query);
    $stmt->execute(array($charname));
}
catch(PDOException $ex)
{
    // Note: On a production website, you should not output $ex->getMessage().
    // It may provide an attacker with helpful information about your code. 
    die("Failed to run query: " . $ex->getMessage());
}

// Finally, we can retrieve all of the found rows into an array using fetchAll
$rows = $stmt->fetchAll();

print_r($rows); 
```

# node.js - 什么时候触发请求？http.request()

> ID：14006377
> 
> 赞同：3
> 
> 时间：2012-12-22T20:32:47.003
> 
> 标签：node.js

关于节点`http.request(options, callback)`方法的一个小问题。
我从[文档](http://nodejs.org/api/http.html#http_http_request_options_callback)中获得了以下示例代码：

```
var options = {
  hostname: 'www.google.com',
  port: 80,
  path: '/upload',
  method: 'POST'
};

var req = http.request(options, function(res) {
  console.log('STATUS: ' + res.statusCode);
  console.log('HEADERS: ' + JSON.stringify(res.headers));
  res.setEncoding('utf8');
  res.on('data', function (chunk) {
    console.log('BODY: ' + chunk);
  });
});

req.on('error', function(e) {
  console.log('problem with request: ' + e.message);
});

// write data to request body
req.write('data\n');
req.write('data\n');
req.end(); 
```

**问题：** 什么时候触发实际的 HTTP 请求？

是在将请求分配给`req`变量时（第 8 行），还是在`req.end()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T20:36:52.580

示例后面的文档中的解释是正确的：

> 请注意，在示例`req.end()`中被调用。必须始终调用req.end `http.request()`() 以表示您已完成请求 - 即使没有数据写入请求正文。

的调用`req.end()`是强制性的。请注意，这`req`是一个`http.ClientRequest`. 的文档[`http.ClientRequest.prototype.end`](http://nodejs.org/api/http.html#http_request_end_data_encoding)为您提供了最后的线索：

> `request.end([data], [encoding])`
> 完成发送请求

# jquery - 将旧的 Flash 动画转换为 jquery 动画

> ID：14006380
> 
> 赞同：0
> 
> 时间：2012-12-22T20:33:24.813
> 
> 标签：jquery, flash, jquery-animate

我有一个旧的 Flash 动画。你可以在这里观看：http: [//jsfiddle.net/RDjdk/](http://jsfiddle.net/RDjdk/)

我想用 jQuery 来做这件事……我相信现在是可能的。

你知道可以帮助我的图书馆或 tuts 吗？你有一些可以帮助我的片段吗？

我看一下 jRotate 或 CSS 转换...但我不知道如何开始。

目标是

```
1) Create an aboslute element which hide the website
2) Rotate a big pictureand minimize the size
3) Rotate another smaller picture
4) When the animation is completed... hide the animation and display the website 
```

此致，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:35:47.307

使用像[Adob​​e Edge](http://html.adobe.com/edge/animate/)这样的工具来做这种复杂的动画。

# c - CUDA C矩阵乘法

> ID：14006385
> 
> 赞同：4
> 
> 时间：2012-12-22T20:34:12.890
> 
> 标签：c, matrix, cuda, parallel-processing, gpu

编辑以对应链接问题后的当前状态。

我目前正在尝试在 CUDA 中重新实现基本的矩阵乘法，虽然我的代码适用于方阵和尺寸为 8 的倍数的矩形矩阵，但它似乎不适用于尺寸不是 8 的倍数的矩形矩阵。

以下是我的内核乘法函数：

```
 __global__ void matrixMultiply(float * A, float * B, float * C,
               int numARows, int numAColumns,
               int numBRows, int numBColumns,
               int numCRows, int numCColumns) {
    int Row = blockIdx.y * blockDim.y + threadIdx.y;
    int Col = blockIdx.x * blockDim.x + threadIdx.x;
    if (numAColumns != numBRows) return ;
    if ((Row < numARows) && (Col < numBColumns)){
        float Cvalue = 0;
        for (int k = 0 ; k < numAColumns ; ++k )
            Cvalue += A[Row*numAColumns + k] * B[k * numBColumns + Col];
        C[Row*numCColumns + Col] = Cvalue;
    }

} 
```

以下是内存分配（为了便于阅读，我删除了错误检查）：

```
cudaMalloc((void**) &deviceA, ARows*sizeof(float)*AColumns);
cudaMalloc((void**) &deviceB, BRows*sizeof(float)*BColumns);
cudaMalloc((void**) &deviceC, CRows*sizeof(float)*CColumns);
cudaMemcpy(deviceA, hostA, ARows*sizeof(float)*AColumns, cudaMemcpyHostToDevice);
cudaMemcpy(deviceB, hostB, BRows*sizeof(float)*BColumns, cudaMemcpyHostToDevice);
cudaMemcpy(deviceC, hostC, CRows*sizeof(float)*CColumns, cudaMemcpyHostToDevice); 
```

虽然以下是调用：

```
dim3 dimGrid((int)ceil(numCRows / 8.0) , (int)ceil(numCColumns / 8.0), 1);
dim3 dimBlock(8 , 8, 1);
multiplyMatrices<<<dimGrid,dimBlock>>>(deviceA, deviceB, deviceC, numARows, AColumns, BRows, BColumns, CRows, CColumns); 
```

最后将内存移回： cudaMemcpy(hostC, deviceC, CRows*sizeof(float)*CColumns, cudaMemcpyDeviceToHost);

现在我已经反复跟踪我的算法，我不相信它有什么问题，所以我个人认为我使用的块/网格大小调整方案可能有问题。如果任何比我更了解 CUDA/C 的人（这里是 Ruby/JavaScript 的人），可以看看它，并引导我了解我做错了什么，我将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T17:30:50.270

问题在于您正在创建的网格大小：

`dim3 dimGrid((int)ceil(numCRows / 8.0) , (int)ceil(numCColumns / 8.0), 1);`

由于行是矩阵的 Y 维度，列是 X 维度，因此您实际上是在创建转置网格。

要创建正确的网格，请执行以下操作：

`dim3 dimGrid((int)ceil(numCColumns / 8.0) , (int)ceil(numCRows / 8.0), 1);`

更好的方法是执行以下操作：

```
dim3 dimGrid;

dimGrid.x = (numCColumns + dimBlock.x - 1)/dimBlock.x;

dimGrid.y = (numCRows + dimBlock.y - 1)/dimBlock.y; 
```

# c++ - 将字符串转换为整数数组？

> ID：14006389
> 
> 赞同：3
> 
> 时间：2012-12-22T20:35:06.867
> 
> 标签：c++

我是 C++ 的初学者，无法弄清楚这一点。正如问题所说，如果我有一个字符串（数字），我如何将每个数字转换为一个整数并将每个数字放入一个整数数组中？

这是我的尝试：

```
std::string stringNumber = "123456789"; // this number will be very large

int intNumber[stringNumber.length()];

for (int i = 0; i < stringNumber.length(); i++) 
{
    intNumber[i] = std::atoi(stringNumber[i]);
    std::cout << intNumber[i] << std::endl;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T20:42:22.423

对于大多数预构建的解决方案，我会使用向量和`std::transform`. 这个想法是遍历每个字符并将其整数形式添加到向量中：（[请参阅完整示例](http://liveworkspace.org/code/48lq6z%241)）

```
std::string s = "1357924680";
std::vector<int> ints;
ints.reserve(s.size()); //to save on memory reallocations, thanks Nawaz
std::transform(std::begin(s), std::end(s), std::back_inserter(ints),
    [](char c) {
        return c - '0';
    }
); 
```

这样做是从字符串的开头循环到结尾，取每个字符，并将它的值减去`'0'`（`'5' - '0'`将是 5）添加到向量的末尾，留下一个整数等价向量。最重要的是，它不会重新发明轮子！

它还解决了您遇到的两个问题：

1.  它使用`std::vector`可变长度数组 (VLA) 代替。后者是非标准的，所以如果你需要一个运行时大小的数组，最好使用向量。

2.  您使用`atoi`，这本身就是不好的，因为它在错误时返回 0，无法确定结果是 0 还是有错误。它还需要一个字符串，而不是单个字符。相反，这会找到与字符之间的距离`'0'`，这是我们需要的整数。

对于额外的安全层，您可以使用`isdigit`来检查字符是否为数字。如果不是，请引发某种错误（如异常），或者以其他方式处理它。这样可以确保`ints`向量中的数字是从 0 到 9，并且不会以 25 之类的数字结束。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-22T20:38:45.613

你不需要atoi()。利用`intNumber[i] = stringNumber[i] - '0';`

# layout - 复合组件和 PanelGrid 的布局问题

> ID：14006394
> 
> 赞同：0
> 
> 时间：2012-12-22T20:35:56.983
> 
> 标签：layout, jsf-2, composite-component

> **可能重复：**
> [如何制作 JSF 复合组件的网格？](https://stackoverflow.com/questions/5713718/how-to-make-a-grid-of-jsf-composite-component)

我有`<p:panelGrid>`一列来生成页眉和页脚。

![在此处输入图像描述](../Images/e6c89df175bc38d0b85967af3d8a6f62.png)

文字是葡萄牙语，上面写着“字段放置在此处！PS：在第二面板内”。

在里面`<p:panelGrid>`，我有一个嵌套`<h:panelGrid>`的应该包含字段。我创建了一个复合组件来添加标签和输入字段。这是复合实现：

```
<cc:implementation>
    <h:panelGrid columns="2">
        <p:outputLabel for="#{cc.attrs.fieldId}" value="#{cc.attrs.fieldLabel}"/>
        <p:inputText id="#{cc.attrs.fieldId}" required="#{cc.attrs.required}" disabled="#{cc.attrs.disabled}" 
            value="#{cc.attrs.targetValue}" styleClass="cc.attrs.styleClass">
            <cc:insertChildren /> <!-- Validation Rules -->
            <f:ajax event="blur" execute="@this" render="@this" />
        </p:inputText>      
    </h:panelGrid>          
</cc:implementation> 
```

这应该在网格中对齐标签和输入。但是，它呈现如下内容：

![在此处输入图像描述](../Images/0126c5df24377bf72ee1115f605bf55f.png)

我尝试`<h:panelGrid>`从复合组件中删除 ，但它看起来也像这样未对齐：

![在此处输入图像描述](../Images/de7ecd24edd4b947dc3b3a3319f40bdf.png)

如何对齐标签和输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:38:51.477

表单布局从头开始可能是一件非常困难的事情，而且并不总是那么简单。话虽如此，您可以尝试使用一些 CSS 使其工作，为所有标签设置相等的宽度，然后使表单控件浮动到右侧。

在此处查看此技术和其他技术的一些示例：http: [//jeffhowden.com/code/css/forms/](http://jeffhowden.com/code/css/forms/)

可能感兴趣的另一件事是[Twitter Bootstrap](http://twitter.github.com/bootstrap/)库/框架。如果需要，您可以[对其进行自定义](http://twitter.github.com/bootstrap/customize.html)以仅获取基本布局和表单所需的 CSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T20:47:36.887

这是我所做的：

我的复合组件不呈现标签，这样，我在每个组件内都没有 panelGrid。结果是这样的：

```
<cc:implementation>
    <p:inputText id="#{cc.attrs.fieldId}" required="#{cc.attrs.required}" disabled="#{cc.attrs.disabled}" 
                 value="#{cc.attrs.targetValue}" styleClass="cc.attrs.styleClass">

        <cc:insertChildren /> <!-- Validation Rules -->
        <f:ajax event="blur" execute="@this" render="@this" />

    </p:inputText>      
</cc:implementation> 
```

这样，标签需要有这个：

```
 <h:panelGrid columns="2" cellspacing="5" styleClass="table_form">  

            <p:outputLabel for="inputId:id" value="#{msg['entity.id']}"/>
            <po:inputInteiro id="inputId" targetValue="#{campoController.entity.id}" fieldId="id" disabled="true" styleClass="inputTiny"/> 
```

需要注意，因为如果您不向复合组件提供 ID，并尝试仅查找内部 id，JSF 将找不到您的组件。如果您的方法不正确，则会出现以下异常：**javax.faces.FacesException: 无法找到从“mainForm:j_idt78”引用的标识符为“id”的组件**

最终结果是： ![](../Images/1016ba7e29fd4621268dfd778a043d0d.png)

另一个注意事项：primefaces 不再在必填字段中包含“*”......需要手动完成...... :(

希望这可以帮助！

# sql - 在存储过程中声明标量变量

> ID：14006395
> 
> 赞同：1
> 
> 时间：2012-12-22T20:36:16.800
> 
> 标签：sql, sql-server

我收到此错误：必须声明标量变量“@TempTable1”。如果我从 @Temptable1 周围删除单引号但没有返回任何行，则查询有效。

```
 ALTER PROCEDURE dbo.StoredProcedure2
      @Studentcode int
    AS
      DECLARE @sql AS nvarchar(max)
      DECLARE @pivot_list AS nvarchar(max) -- Leave NULL for COALESCE technique
      DECLARE @select_list AS nvarchar(max) -- Leave NULL for COALESCE technique
      Declare @TempTable1 AS table(CourseTitel nvarchar(50) , Grade nvarchar(50))

      INSERT INTO @TempTable1 (CourseTitel, Grade) 
       SELECT Courses.CourseTitel, Status.Status 
       FROM Status 
         INNER JOIN Courses ON Status.CourseCode = Courses.CourseCode 
       WHERE (Status.StudentCode = @Studentcode)

      SELECT @pivot_list = COALESCE(@pivot_list + ', ','') + '[' + CONVERT(varchar, PIVOT_CODE) + ']',
             @select_list = COALESCE(@select_list + ', ','') + '[' + CONVERT(varchar, PIVOT_CODE) + '] AS [col_' + CONVERT(varchar, PIVOT_CODE) + ']'
      FROM (SELECT DISTINCT PIVOT_CODE 
            FROM (SELECT CourseTitel, Grade, ROW_NUMBER() OVER (PARTITION BY CourseTitel ORDER BY Grade) AS PIVOT_CODE 
                  FROM @TempTable1) 
            AS rows) 
      AS  PIVOT_CODES

    SET @sql = ';WITH p AS (SELECT CourseTitel, Grade, 
                ROW_NUMBER() OVER (PARTITION BY urseTitel ORDER BY Grade) AS PIVOT_CODE 
                FROM ' + @TempTable1 + ' ) SELECT CourseTitel, ' + select_list + '
                FROM p PIVOT (MIN(Grade)FOR PIVOT_CODE IN (' + @pivot_list + ')) AS pvt'
    --PRINT (@sql)
    EXEC (@sql)
    /* SET NOCOUNT ON */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:26:23.397

因此，您正在声明一个表变量，并尝试对其运行动态 SQL。问题是动态 SQL 完成`exec`或`sp_executeSql`基本上在其自己的范围内运行，因此表变量没有在那里声明，并且随后不能在查询中使用。

我可以提出两种解决方法：

*   使该表可用作临时表。因为临时表是真实的表，它们在任何范围内都可以访问，所以它们将在动态 sql 中可以访问。一些伪 tsql 就像：

    ```
    ...
    if object_id('tempdb..#TempTable1 ') is not null
      drop table #TempTable1 

    create table #TempTable1 (CourseTitel nvarchar(50) , Grade nvarchar(50))
    ...
    @sql = '... AS PIVOT_CODE FROM #TempTable1) SELECT CourseTitel...' 
    ```

*   将表变量作为表值参数传递给动态 sql 块。这仅适用于 sql server 2008 及更高版本。但是，这需要将表的结构定义为 sql server 类型。这可以在系统级别完成一次，例如：

    ```
    CREATE TYPE TempTableType AS TABLE (CourseTitel nvarchar(50) , Grade nvarchar(50)) 
    ```

    然后我们可以使用该类型来声明表变量，并将其作为参数传递给动态 sql

    ```
    ...
    declare @TempTable1 AS TempTableType 
    ...
    @sql = N'... AS PIVOT_CODE FROM @TempTable1) SELECT CourseTitel...'
    EXEC sp_executesql @SQL, 
                       N'@TempTable1 TempTableType READONLY', 
                       @TempTable1 =@TempTable1 
    ```

# c# - 在 C# 中的每个面向对象的接口上重新定义相同的枚举

> ID：14006397
> 
> 赞同：6
> 
> 时间：2012-12-22T20:36:34.480
> 
> 标签：c#, interface

在过去，您经常有一个“低级”的数据模块，不依赖于任何其他模块，但可以被它们引用，例如获取整个系统使用的枚举。
现在我们在模块之间有了面向对象的接口，包括调用和事件。我的问题是，我们不应该在一个地方定义整个系统中使用的枚举，并且每个需要它们的接口都应该引用这些枚举吗？

我见过在每个接口上重新定义基本相同的枚举的软件，当它被传递到另一个模块时具有翻译功能。

例如，接口 IModule1 可能有

```
enum module1_state
{
    Unknown, 
    NotRunning,
    Running
} 
```

和接口 IModule2 可能有

```
enum module2_state
{
    Unknown,
    NotRunning,
    Running
} 
```

例如，模块 1 收集数据，模块 2 执行一些逻辑，然后将数据进一步传递给第三个模块，例如 GUI。

在许多情况下，枚举会完全不同，因为例如，第二个模块可以抽象出第三个模块不需要的一些信息，并传递一个简化版本。
但在某些情况下，它们并没有什么不同，在我看来，枚举仍然在每个接口上重新定义是错误的。一个示例是作为几个不同用例的一部分执行的操作。动作是一样的，但是根据用例的不同，几个小细节是不一样的。携带用例详细信息的枚举通过接口传递到高级逻辑模块，然后通过另一个接口传递到低级模块。它在每个接口上重新定义，因此必须在高级逻辑模块中进行翻译。

还有一些其他模块只是将较旧的现有接口转换为较新的接口，并且再次，两个接口都重新定义了相同的枚举。

谁能告诉我哪个是最佳实践？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:53:25.153

这是代码组织、模块化和重用的问题。两个模块重用第三个模块可能是有意义的（在同一个解决方案中考虑项目），但如果它们是单独的[有界上下文](http://domaindrivendesign.org/node/91)的一部分（考虑解决方案），它们会独立发展并且通常应该使用单独的定义。您看到的映射在单独的有界上下文之间应该是正常的，但枚举应该在同一上下文中统一。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T21:44:48.907

C# 和 Java 的现代 DLL 机制都允许重构将常见的东西 - 在你的问题的情况下，枚举 - 移动到其他人共享的公共 DLL 中；正如您所指出的，利用这一点似乎很容易。

尽管如此，正如我们许多人所知，代码的形状和架构往往反映了负责组织的形状和架构（康威定律，[http](http://en.wikipedia.org/wiki/Conways_Law) ://en.wikipedia.org/wiki/Conways_Law ）；代码不仅仅是满足需求，还包括作者身份、控制和责备（计划和项目管理）以及维护责任；这些导致代码结构反映组织结构图的结构。

（另请参见[http://blogs.gartner.com/ray_valdes/2008/09/19/organizational-structure-vs-product-architecture-which-one-wins/](http://blogs.gartner.com/ray_valdes/2008/09/19/organizational-structure-vs-product-architecture-which-one-wins/)）

所以，当我看到你所描述的东西时，我想知道是否有一些组织结构和政治在起作用。必须有人拥有公共 DLL，并且任何一个组织都可能不想依赖另一个；结果可能是这样的复制。

# c++ - SQLite 中的分段错误

> ID：14006402
> 
> 赞同：1
> 
> 时间：2012-12-22T20:36:47.133
> 
> 标签：c++, sqlite, segmentation-fault

我的 DataBase.cpp 文件中的代码：

```
#include "DataBase.h"
#include <sqlite3.h>
#include <string.h>
#include <wx/msgdlg.h>
bool CanClose(void)
{
    sqlite3 *Sqlite;
    sqlite3_stmt *sqlstmt;
    char *result;
    if(sqlite3_open("SysConfig",&Sqlite)==SQLITE_OK)
    {
       sqlite3_prepare(Sqlite,"SELECT config_value FROM configuration WHERE config_id = 1;",-1,&sqlstmt,NULL);
       sqlite3_step(sqlstmt);
       result = (char*)sqlite3_column_text(sqlstmt,0);
       sqlite3_close(Sqlite);
       if(strcmp(result,"YES")==1)    //Error Here
           return true;
       else
           return false;
    }
    else
    {
        wxMessageBox(_("Cannot Find System File!"),_("Error!"));
        sqlite3_close(Sqlite);
        return false;
    }
} 
```

我的程序表现得很突然。当我尝试调试它时，上面指示的行（第 19 行）给出了一些错误：

**程序收到信号 SIGSEGV，分段错误。**

语句的进一步反汇编在汇编指令中显示错误

`call 0x80500b0`

知道代码有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T21:20:18.670

# 段错误的原因

[sqlite3 文档`sqlite3_column_text`](https://www.sqlite.org/c3ref/column_blob.html)说：

> 如果这些例程中的任何一个在`sqlite3_step()`返回除 之外的内容后被调用 [...] `SQLITE_ROW`，则结果未定义。”

您没有检查 的返回值`sqlite3_step`，因此您的查询似乎返回了某种错误，然后`sqlite3_column_text`返回了无效指针。

# 调试 SQL 错误

根据[以下文档`prepare`](https://www.sqlite.org/c3ref/prepare.html)：

> 所有新程序都推荐使用和`sqlite3_prepare_v2()`接口。`sqlite3_prepare16_v2()`为了向后兼容，保留了两个较旧的接口 [包括`sqlite3_prepare`您所称的 ]，但不鼓励使用它们。
> 
> [...]
> 
> 发生错误时， sqlite3_step() 将返回详细错误代码或扩展错误代码之一。遗留行为是 sqlite3_step() 只会返回通用 SQLITE_ERROR 结果代码，并且应用程序必须再次调用 sqlite3_reset() 才能找到问题的根本原因。使用“v2”准备接口，错误的根本原因会立即返回。

因此，如果您切换到较新的界面，它应该会提供更丰富的信息，而不是通用的`SQLITE_ERROR`.

您也可以尝试使用`sqlite3`命令行程序，它会直接告诉您错误是什么。示例会话：

```
user@host:/path$ sqlite3 test.sqlite
sqlite> create table example ( id numeric primary key );
sqlite> select bogus from example;
Error: no such column: bogus 
```

* * *

顺便说一句，对于标准 C++ 使用`#include <cstring>`for`#include <string.h>`和`bool CanClose()`for `bool CanClose(void)`。

# javascript - CRM 2011 如何使用特定联系人的信息更新帐户表单（address1_city 字段）？

> ID：14006405
> 
> 赞同：0
> 
> 时间：2012-12-22T20:37:01.680
> 
> 标签：javascript, crm, dynamics-crm-4

我想编写根据“主要联系人”字段更新帐户表单（address1_city 字段）的 JavaScript 代码，我需要检索正确的联系人城市并使用此值更新帐户城市。

我怎样才能做到这一点？

我有一个返回第一个联系人的函数：

```
function getFirstContactToBePrimaryContact(contactName) 
{ 
    SDK.REST.retrieveMultipleRecords("Contact", "$select=FullName", 
        function (results) 
        { 
            var firstResult = results[0]; 

            if (firstResult != null) 
            { 
                if(contactName == firstResult) 
                { 
                    returnValue = getcity(firstResult);
                    return; 
                }
            } 
            else 
            { 
                //document.write("No Contact records are available to set as the primary contact for the account.");
            } 
        }, errorHandler, function () { /*OnComplete handler*/ } 
    ); 
} 
```

# menu - UL 中的选择器

> ID：14006410
> 
> 赞同：0
> 
> 时间：2012-12-22T20:37:42.243
> 
> 标签：menu, html-lists, css-selectors

我创建的一个简单的“ul”菜单有问题。我想要实现的是简单地将填充添加到菜单项 1 - 4 而不是徽标图像。我在“a”标签上尝试过一门课，但没有任何乐趣。我可以选择您所期望的“ul.menu”来填充整个 UL。（这一切都发生在显示：内联）如果我浮动：左而不是显示：内联我只能选择“a”标签，但如果我这样做，我会努力将整个菜单与标题居中。

那么解决方案是什么？我想为“a”标签而不是徽标图像添加一个 100px 的填充顶部。

HTML

```
<body>
  <div class="wrapper clearfix">

    <div id="header">

 <nav> 
    <ul class="menu">
      <li><a href="#">item 1</a></li>
      <li><a href="#">item2</a></li>
      <img src="images/logo.png" id="logo">
      <li><a href="#">item3</a></li>
      <li><a href="#">item4</a></li>
    </ul> 

 </nav>     

    </div><!--end of header-->

  </div><!--end of wrapper-->
</body> 
```

CSS

```
li {
display:inline;
padding-left: 2%;   
padding-right: 2%;
}

.wrapper {
margin-left: auto;
margin-right: auto;
width: 100%
}
#header {
clear: both;
float: left;
margin-left: 0;
width: 100%;
height: 400px;
display: block;
background-image:url(../images/header.jpg);
font:"Agency FB";
}

#logo   {
padding-top: 1%;
padding-bottom: 1%; 
} 
```

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T00:57:24.003

将 img 标签放在 ul 中不是有效的 HTML。您必须首先将 img 包装在 li 标签中，并为其指定一个 ID，如下所示：

```
<ul>
<li><a href="#">Stuff</a></li>
<li><a href="#">Stuff2</a></li>
<li id="logo_li"><img src="myimage.jpg"></img></li>
</ul> 
```

然后应用这样的 CSS：

```
ul li {
padding-top: 100px;
}
ul li#logo_li {
padding-top: 0px;
} 
```

这是您想要实现的工作示例 jsfiddle：http: [//jsfiddle.net/4BjEz/](http://jsfiddle.net/4BjEz/) （添加了红色边框，因此您可以看到 li 的高度+填充）

# c++ - 没有 iomanip 的 setprecision

> ID：14006412
> 
> 赞同：4
> 
> 时间：2012-12-22T20:37:52.190
> 
> 标签：c++

我想编译一个 C++ 应用程序，但我不能使用

```
#include <iomanip> 
```

有没有其他方法可以做到这一点？

信息：我需要设置精度为 5

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-22T20:39:17.887

是的，您有能力使用

```
cout.precision(5); 
```

这不需要

```
#include <iomanip> 
```

**注意：**这将为整个文档设置精度。

**例子：**

```
cout.precision(5);
cout << f; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T20:39:09.390

您可以`precision()`直接在流上设置，例如：

```
std::cout.precision(5); 
```

# actionscript-3 - Starling Feathers 屏幕导航器

> ID：14006413
> 
> 赞同：0
> 
> 时间：2012-12-22T20:38:03.687
> 
> 标签：actionscript-3, starling-framework

我想知道是否有办法在不继承 Screen 的类中使用 this.owner.showScreen(screen_id) ？

我正在构建一个页脚类（类似于页眉，但具有自定义控件），我将包含在多个屏幕中，但该类需要扩展 Starling Sprite。所以基本上它是一个包含文件/类。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T21:57:15.840

作为 getter 方法 this.owner 返回对屏幕导航器的引用，通过该引用来导航扩展 Screen 的类，这是不可能的。

为什么不简单地创建一个类说，Footer，它扩展了 feathers.controls.Header 并将其 y 属性设置为***stage.height - this.height***以便将其放置在底部？或者将标题放在底部的每个类上

```
// in initialize method of Screen classes
_header.y = stage.height - _header.height; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T15:19:05.943

feeltheblanks 是对的，但你不应该在初始化时这样做（舞台尺寸在某些移动设备上可能没有准备好），我也不会使用舞台高度，你应该使用组件的实际高度。

# php - 使用 codeigniter 的日期助手

> ID：14006420
> 
> 赞同：-1
> 
> 时间：2012-12-22T20:39:30.173
> 
> 标签：php, codeigniter

我想知道哪个 Codeigniter 函数是用于 gmdate php 函数的最佳函数。

这样做的目的是获取字符串 unix 时间戳并对其进行格式化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:08:29.863

你有选择。您可以像这样简单地使用原始 PHP 函数：

```
$utc_str = gmdate("M d Y H:i:s", time()); 
```

或者您可以使用`now()`CI 的日期助手中的功能，但是通过这样做，您需要首先将您`date_reference`的配置设置为`gmt`：

```
$config['time_reference'] = 'gmt'; 
```

并这样称呼它：

```
$utc_str = date("M d Y H:i:s", now()); 
```

由于 now() 根据配置文件中的“时间参考”设置，将当前时间作为 Unix 时间戳返回，参考服务器的本地时间或 GMT。

# java - 比较日历对象以秒为单位获取差异

> ID：14006421
> 
> 赞同：1
> 
> 时间：2012-12-22T20:40:02.267
> 
> 标签：java, datetime

我试图以秒为单位计算两个日历对象的差异。

第一个日历对象是当前调用时间，第二个日历对象是项目的创建时间戳。

现在我想知道“创建时间戳+几秒”是在当前调用时间日历对象 datetime 之后还是之前。

```
Calendar referenceCalendar = Calendar.getInstance();
Calendar compareCalendar = obj.getCreationDate();
compareCalendar.add(Calendar.SECOND, obj.getDuaration());
long differenceInSeconds = (compareCalendar.getTimeInMillis() - referenceCalendar.getTimeInMillis()) / 1000;

if (differenceInSeconds == 0) {
    iter.remove();
} else if (differenceInSeconds > 0) {
    iter.remove();
} 
```

但结果总是“差异> 0”。任何想法我做错了什么？

任何帮助将不胜感激。

**编辑**

我发现日历对象“obj.getCreationDate()”会不断更新它们的日期时间。

方法其实很简单：

```
public void setCreationDate(Calendar date)
            throws InvalidParameterException {
        if (date == null) {
            throw new InvalidParameterException(
                    "Creation date can not be null.");
        } else {
            this.creationDate = date;
        }
    } 
```

并且该方法只会被调用 1 次：

> setCreationDate(Calendar.getInstance);

Calendar.getInstance 会强制我保存的 var 更新其日期时间吗？在我看来，这种情况发生了。

-> 我真的很确定我的方法真的只被调用一次

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:45:42.207

日历是可比较的，不要得到毫秒和比较，使用`compareCalendar.compareTo(referenceCalendar)`

在你的情况下：

```
Calendar referenceCalendar = Calendar.getInstance();
Calendar compareCalendar = obj.getCreationDate();
compareCalendar.add(Calendar.SECOND, obj.getDuaration());

if (compareCalendar.compareTo(referenceCalendar) >= 0) {
    // ccompareCalendar is equals or greater referenceCalendar
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:51:26.010

发现问题：

它的以下行：

> compareCalendar.add(Calendar.SECOND, obj.getDuaration());

如果您将一些字段添加到现有日历对象，则基础对象将被当前日期时间对象 + 您添加的字段覆盖。

我不知道这是设计使然还是只是一个错误。

所以你可以简单地克隆你的对象并使用它而不是 obj.getCreationTime()

> 日历 clonedCalendar = (日历) obj.getCreationDate().clone();

# java - MyBatis 未在映射文件中加载 Oracle SYSDATE

> ID：14006423
> 
> 赞同：0
> 
> 时间：2012-12-22T20:40:22.697
> 
> 标签：java, oracle, spring, mybatis

我的一个 XML 中有以下非常基本的映射：

```
<select id="getUserAuthorities" parameterType="string" resultMap="resultGetUserAuthorities">
    SELECT AUTHORITY FROM BASIC_AUTHORITIES
    WHERE UPPER(USERNAME) = UPPER(#{username})
        AND (EXPIREDTADSTP IS NULL OR TRUNC(EXPIREDTADSTP) < SYSDATE)
</select> 
```

使用上述映射，我的应用程序服务器在创建映射器期间容器启动（Spring）失败，并出现以下错误：

> 调用 init 方法失败；嵌套异常是 java.lang.IllegalArgumentException: org.apache.ibatis.builder.BuilderException: 创建文档实例时出错。原因：org.xml.sax.SAXParseException：元素的内容必须由格式良好的字符数据或标记组成。

它似乎在 sysdate 上失败了，好像我删除了

> 或 TRUNC(EXPIREDTADSTP) < SYSDATE

然后它工作得很好。

MyBatis 不支持 Oracle SYSDATE 字段吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T03:30:40.273

问题是您的 XML 中有一个未转义的小于号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-11T06:42:18.630

您必须将单词“<”更改为“>”。您可以将句子更改`TRUNC(EXPIREDTADSTP) < SYSDATE`为 `SYSDATE>TRUNC(EXPIREDTADSTP)`. 也许，出现错误消息是因为您没有完成括号。

# iphone - 奇怪的 iOS 崩溃与 UIActivityViewController

> ID：14006426
> 
> 赞同：0
> 
> 时间：2012-12-22T20:40:57.283
> 
> 标签：iphone, ios, ipad

我在 iOS 6 上发生了以下崩溃，堆栈跟踪的图像在这里：

![堆栈跟踪](../Images/523c79b1cf7f06fc430edb14c907a74a.png)

我不知道发生了什么，但根据我们的 crashlytics 报告，很多用户都在发生这种情况。我们甚至没有在我们的应用程序中使用 UIActivityViewController，但我们确实有一个 Open In... 函数。

# c# - 如何保存 MethodInfo 指针并稍后调用该函数？

> ID：14006427
> 
> 赞同：5
> 
> 时间：2012-12-22T20:41:00.643
> 
> 标签：c#, cil, reflection.emit, methodinfo

C#/CIL/Reflection.Emit 问题：

我正在尝试定义一个具有函数指针的类型，实例化该类型，在另一种类型上创建一个静态方法（因为我不知道如何制作“只是一个函数”），给一个指向这个静态方法的指针到实例，然后使用该指针调用函数。

我几乎没有成功。:-(

这是类型：

```
Thunk = modb.DefineType("Thunk");

Thunk.DefineField("Env" , Env.AsType(), FieldAttributes.Public);
Thunk.DefineField("Expr", typeof(int), FieldAttributes.Public); // int is the correct type according to http://msdn.microsoft.com/en-us/library/system.reflection.emit.opcodes.ldftn.aspx

Thunk.CreateType(); 
```

到目前为止一切顺利（我认为）。然后我创建其中一个并分配函数指针：

```
var methodBuilder = MainType.DefineMethod("my_other_little_function", MethodAttributes.Static, typeof(Int64), new[] {Env.AsType()});
{
    var il2 = methodBuilder.GetILGenerator();
    il2.Emit(OpCodes.Ldarg_0);
    il2.Emit(OpCodes.Stloc_0);
    binding.Expr.Compile(il2);
    il2.Emit(OpCodes.Ret);
}
il.Emit(OpCodes.Newobj, ThunkCtor);
il.Emit(OpCodes.Dup);
il.Emit(OpCodes.Ldloc_0);
il.Emit(OpCodes.Stfld, Thunk.GetField("Env"));
il.Emit(OpCodes.Dup);
il.Emit(OpCodes.Ldftn, methodBuilder);
il.Emit(OpCodes.Stfld, Thunk.GetField("Expr")); 
```

据我所知，这部分工作得很好。问题出在其他地方，当我尝试调用它时：

```
var func = il.DeclareLocal(typeof(int));
il.Emit(OpCodes.Dup);
il.Emit(OpCodes.Ldfld, Thunk.GetField("Expr"));
il.Emit(OpCodes.Stloc, func);
il.Emit(OpCodes.Ldfld, Thunk.GetField("Env"));
il.Emit(OpCodes.Ldloc, func);

il.EmitCalli(OpCodes.Calli, CallingConventions.Standard, typeof(Int64), new[] { Env.AsType() }, null); 
```

如果我尝试运行由此创建的程序，我会在执行任何字节码之前出错（或者至少它是这样显示的）：

```
Unhandled Exception: System.InvalidProgramException: Common Language Runtime detected an invalid program. 
```

相反，如果我用代码替换 EmitCalli() 以简单地弹出函数指针和参数并推送一个数字，则程序的其余部分工作正常。那么我应该如何调用这个函数呢？

非常感谢。:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T03:23:14.760

除非您只是为了好玩而喜欢解决这样的问题，否则另一种选择是使用库来生成所需的 IL。

[Fasterflect](http://fasterflect.codeplex.com)是一个包含许多反射助手的库。例如，要获取方法的委托，只需编写：

```
var delegate = typeof(YourClass).DelegateForCallStaticMethod( "MyStaticMethod" );
delegate( args ); 
```

该库在后台使用 DynamicMethod 和 IL 生成，并且还具有不需要您为委托声明和使用变量的扩展（尽管如果您打算重复调用它会更快，例如在紧密循环中） . 简单的变体如下所示：

```
var result = typeof(YourClass).CallStaticMethod( "MyStaticMethod", args ); 
```

Fasterflect 缓存生成的委托（因为编译生成的 IL 非常昂贵），因此在简单场景中每次调用所增加的性能成本等同于进行缓存查找的成本。

免责声明：我参与了上述项目。也就是说，手工编写 IL 确实不是一件有趣的事。IL 生成的另一个不错的选择是 Mono.Cecil 库，尽管我不熟悉它提供的细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-14T06:44:38.667

您应该使用`IntPtr`for 函数指针而不是`int`. CLR 文档有时称这种类型为“native int”。

# sql - 识别交易满足特定条件的 ID

> ID：14006432
> 
> 赞同：0
> 
> 时间：2012-12-22T20:41:46.260
> 
> 标签：sql, sql-server, tsql

一段时间以来，我一直在用头撞墙。我有一组数据，我需要在其中识别其交易组满足特定条件的客户。我粘贴了下面数据集的一小部分。我们可以称表为“A”。我希望我粘贴的方式在问题输出中是清晰的！

我正在寻找一种方法来仅识别其交易组满足以下条件的客户：

*   在客户的事务组中，必须至少存在 1 种情况，即 TRANSTYPE 21 事务的 DATE*晚*于 TRANSTYPE 17 事务。（请注意，这里的日期是从 1900 年 1 月 1 日开始的典型 Excel“天数”，尽管这对于查询而言无关紧要。）

对此的任何帮助将不胜感激！

```
CUSTOMERID, TRANSID, TRANSTYPE, DATE

0027, 2, 17, 40948
0027, 3, 21, 40950
0085, 4, 17, 40955
0187, 14, 17, 41199
0187, 15, 21, 41214
0187, 16, 17, 41244
0513, 1, 17, 40940
0513, 5, 21, 40981
0565, 8, 21, 41032
0565, 11, 17, 41080
0715, 6, 17, 41009
0715, 7, 21, 41009
2780, 9, 17, 41039
2985, 10, 17, 41069
2985, 12, 21, 41091
2985, 13, 17, 41144 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:25:38.263

```
SELECT a.CUSTOMERID
FROM a
  INNER JOIN a b ON a.CUSTOMERID = b.CUSTOMERID
WHERE a.DATE > b.DATE
  AND a.TRANSTYPE = 21
  AND b.TRANSTYPE = 17 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:01:42.197

```
Select CUSTOMERID, TRANSID, TRANSTYPE, DATE
from A a1
where TRANSTYPE=17
and Exists(select * from a a2 where a2.CUSTOMERID=a1.CUSTOMERID and a2.TRANSID=21 and a2.Date>a1.Date) 
```

# javascript - 单击复选框时复选框不会更改其选中状态

> ID：14006435
> 
> 赞同：1
> 
> 时间：2012-12-22T20:42:11.957
> 
> 标签：javascript, css, asp.net-mvc, dom-events

我是 ASP.NET MVC 的新手，现在我遇到了一个问题，如果复选框出现在页面上的时间晚于最初加载的页面。看下一个场景：当我单击一个按钮时，Javascript 处理程序调用控制器后操作，并将其结果 html 加载到某个具体的 div 中。此 html 包含不会对鼠标按下事件做出反应的复选框（**不会更改其检查状态**）。

如果复选框与整个页面一起呈现，则复选框可以正常工作，但如果稍后呈现（作为后期操作的结果）则不会。在这里查看我的标记：

```
<a name="button" onclick="handler();"></a> 
```

在“按钮”上单击我想`ActionResult`从控制器中获取并将其放入 div：

```
<div id="resultWillBeLoadedIn">
    <!-- here is placeholder-->
</div> 
```

下一个 html 将从 /SomeController/SomeAction 返回并加载到上面的 div 中：

```
<span class="check">
    <span class="checkbox">
        <input type="checkbox" name="form" value="2" />
    </span>
</span> 
```

这是我的“按钮单击”的 Javascript 处理程序：

```
function handler() {
    var url = '/SomeController/SomeAction';
    $.post(url, { params... }, function (result) {
        $('#resultWillBeLoadedIn').html(result);
} 
```

查看 CSS 的一部分（我完全不是 CSS 方面的专家，所以我不确定这是否是我需要在这里展示的。而且......（老实说）我不是作者，所以请告诉我是否需要更多）：

```
.check .checkbox{
float: left;
height: 12px;
width: 12px;
display: inline-block;
margin: 3px 5px 0 0;
cursor: pointer;
background: url(../img/checkbox.png) 0 0 no-repeat;
}
.check span.disable{
float: left;
height: 12px;
width: 12px;
margin: 3px 5px 0 0;
display: inline-block;
background: url(../img/checkbox.png) 0 -24px no-repeat;
} 
```

请告诉我我缺少什么才能使复选框不仅在页面加载时正确呈现，而且在回发到某个 div 时呈现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T20:46:38.750

您已经省略了复选框的处理程序，但您可能需要为其使用委托处理程序（[on](http://api.jquery.com/on/)的文档）。本质上，您将处理程序委托给 DOM 中保留在页面上的更高级别元素（或者可能是 body 元素，如果没有更低级别的元素可以工作）并提供一个选择器过滤器，当调用处理程序以查看如果它匹配事件目标。通过这种方式，您可以拥有一个只应用一次的处理程序，并与稍后添加的动态元素一起使用。

```
$('body').on('click', 'input[type="checkbox"]', function() {
      // handler function
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:47:32.350

在回调中添加 html 后，连接一个点击处理程序。

```
$('selectCheckbox').on('click', handler); 
```

鉴于这个问题，它可能是 CSS/样式问题。我认为某些元素漂浮在复选框上并阻止它被点击。您可以在 chrome 检查器中查看它，并查看当您将鼠标悬停在复选框上时悬停的内容吗？

# php - 在查询字符串中传递变量

> ID：14006437
> 
> 赞同：-1
> 
> 时间：2012-12-22T20:42:42.080
> 
> 标签：php, email

我想在查询字符串中传递 $Email，看起来像这样

```
header("Location:index.php?state=sent&Email=$Email");
$Email = urlencode("$urlencode");
$urlencode = $row['Email']; 
```

我之前从我的数据库中定义了 $row

这将收到它

```
$Email = $_GET['Email'];
echo "<p style='color:white;margin-bottom:10%; font-size:17px;' align='center'> Your email is: $Email</p>"; 
```

但由于某种原因，它不会发送带有查询字符串的电子邮件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:47:33.200

你的顺序错了。应该：

```
$urlencode = $row['Email'];
$Email = urlencode($urlencode);
header("Location:index.php?state=sent&Email=$Email"); 
```

# node.js - 如何创建一个自我更新的 Node.js 应用程序？

> ID：14006439
> 
> 赞同：18
> 
> 时间：2012-12-22T20:43:11.763
> 
> 标签：node.js, versioning, auto-update, self-updating

我想用 Node.js 创建一个应用程序，它会定期检查更新并安装它们（如果有的话）。

基本组件对我来说很清楚：

*   包含更新包的 Web 服务器（或 FTP 服务器、文件系统……）
*   版本系统（例如 SemVer），以便您可以判断哪个包较新
*   用于签署更新包的公钥算法

那么，何时检查更新和安装更新可能会有不同的策略：

*   在应用程序启动时
*   在应用程序结束
*   怠速时

该应用程序甚至可能被硬关闭并自动重新启动。

但是还有一些问题：

*   npm 上是否有任何可用的模块已经提供了这样的系统？
*   如何组织文件系统中的不同版本？基本上你会有一个主机和多个（版本化）核心。是否应该`data`为所有这些文件创建一个文件夹？
*   如何处理`npm install`& co。对于新下载的包？
*   如何处理损坏的更新？
*   你怎么能实现这样的东西，使它与 Heroku & co. 兼容。你没有可以开车去的永久驱动器？

一般而言：您将如何尝试实现这样的系统？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T21:21:18.000

首先，您可以使用 NPM 本身进行包和应用程序交付。其次，您可以添加脚本文件以在 package.json 文件中添加 cron 作业（例如“postinstall”或“update”），以进行定期更新过程。在此脚本中，您可以检查您需要的所有内容，例如损坏的更新。在 Heroku 中，您可以使用 Scheduler Worker 进行更新处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-02-21T11:17:40.027

Web 服务器将是不必要的。Git 是托管公共和私有代码的完美解决方案，包括版本控制。对于私有存储库，您可以使用个人访问令牌。

我创建了一个模块，用于从 git 存储库自动更新 node.js 应用程序。它将本地 package.json 与您的 repo 中的进行比较，然后自动克隆 repo 并安装依赖项。您可以配置您的应用程序以检查应用程序开始、结束或安排例行检查的更新。

自动 Git 更新 - [https://github.com/chegele/AutoGitUpdate](https://github.com/chegele/AutoGitUpdate)

```
import AutoGitUpdate from 'auto-git-update';

const config = {
    repository: 'https://github.com/chegele/BackupPurger'
    tempLocation: 'C:/Users/scheg/Desktop/tmp/',
    ignoreFiles: ['util/config.js'],
    executeOnComplete: 'C:\\Users\\scheg\\Desktop\\worksapce\\AutoGitUpdate\\startTest.bat',
    exitOnComplete: true
}

const updater = new AutoGitUpdate(config);

updater.autoUpdate(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-04-10T09:10:22.657

> 所以你说的是你需要使用 **版本控制**来更新你的部署，如果更新破坏了它可以恢复。它还必须能够使用安全源进行更新并且必须与 Heroku & co 兼容？

呼，这要求很高。

听起来你想要像**Docker**这样的东西。 [https://www.docker.com/](https://www.docker.com/)

**与 Heroku 一起使用：** [https ://devcenter.heroku.com/articles/container-registry-and-runtime](https://devcenter.heroku.com/articles/container-registry-and-runtime)

**那么什么是 Docker？** 好吧，简而言之，它就像 github，但用于部署。它不是对源代码的版本控制，而是对整个环境的版本控制。所以你可以让你的脚本在 Windows 上的 Ubuntu 环境中运行。它可以使用特定版本的 node.js。然后使用已经安装的一组特定的 NPM 依赖项。在构建所有这些层之后，它可以在该环境中使用您的应用程序的特定版本。您可以完全控制部署映像中包含的所有内容，并且它可以在 docker 运行的所有操作系统上运行（包括 heroku）。（请注意，您不能使用 Windows 环境，除非在另一台装有 Docker 的 Windows 机器上）

因此，使用 Docker，您无需让脚本运行 npm 更新，而是在开发版本上运行 npm install 并在测试后推送到您的 Docker 映像。然后，您的部署服务器可以在您的 Docker 映像上运行拉取以更新应用程序、所有依赖项，甚至操作系统更新，以确保它按预期运行。如果更新中断了安装，那么您可以恢复使用早期的 Docker 映像，就像您可以从 github 删除提交一样，您可以删除对映像的拉取然后运行它，就好像更新从未发生过一样。如果需要，您甚至可以通过创建新的映像构建来生成具有不同环境和版本的多个 Docker 实例。

好的，这样就可以处理您的部署版本控制。呸！

但是自动检查更新和检测损坏的安装等呢？

**您仍然需要构建一个更新程序脚本来获得您想要的那种行为您** 不能指望更新程序工具知道如何调试您的安装并确定它是否“损坏”。也许您的脚本旨在引发错误。第三方更新程序脚本如何充分理解您的应用程序，从而确定是否需要回滚？

因此，您的更新程序脚本应该管理 Docker 镜像的拉取和恢复。它可以在启动应用程序之前运行拉后测试。如果您希望它能够自我修复，您还应该确保您的应用程序能够处理错误。也就是说，由您的应用程序决定是否需要执行回滚。Docker 使您的主应用程序可以（通过它的版本控制系统）与您的更新程序通信需要回滚。然后，您的更新程序脚本会在您的主应用程序退出后执行回滚到最后一个已知良好的 Docker 映像（并且可能在下一个版本发布之前不会再次执行拉取）。

**仅举几个示例用例：**

*   **1.安全更新：**

> 您创建一个包含您的程序的 Docker 映像。你让它在 Ubuntu 16.04 环境中运行。它包含所有需要的 NPM 安装和 Node 8。您上传到 Docker 存储库服务器。然后，您将映像部署到另一台机器并在那里运行它。您的应用程序现在正在用完另一台机器上的 Docker 容器。
> 
> 稍后，您在 dev 构建上更新 NPM 包并将新映像发布到您的 Docker 存储库在线。您的生产服务器检测到新构建，关闭应用程序，执行拉取以更新其本地 Docker 映像，并使用其本地 Docker 映像再次启动应用程序实例。由于所需 NPM 模块的某些新版本破坏了所有内容，您的应用程序开始崩溃。它处理错误并在返回 20 个错误后，向更新程序脚本发出信号以执行回滚并退出。由于您的应用程序关闭，Docker 容器将关闭。更新程序脚本现在从本地映像中删除最后一个 Docker 拉取，并使用恢复的映像再次重新生成应用程序映像的实例。对图像中的数据文件造成的任何类型的损坏都消失了。也许更新程序还将错误的版本号写入 JSON 文件，因此它可以跟踪不执行拉取的版本。您的应用程序现在运行得像蛤蜊一样快乐。
> 
> 但不满足于有一个损坏的版本并希望更新您的其他包，您可以解决错误并恢复导致开发构建问题的 NPM 包。您将更改推送到在线 Docker 存储库并增加版本号。您的应用程序检测到新的 docker 构建，检查以确保它不是“禁止构建”，然后向更新程序发出信号以运行拉取，优雅地退出。Docker 实例结束，更新程序执行新的拉取。这一次，一切都很好，工作正常，所以不需要回滚。

*   **2.使用多个版本**

> 但是现在让我们稍后再说，您真的在为您的应用程序着力，并且为它添加​​了各种很棒的功能。它现在的能力提高了 5000%，但速度也降低了 5000%。如果您之前发布了一个简单但快速的应用程序“版本 1”，并且它完成了您在另一台服务器上进行某些部署所需的操作，那么从你的 Docker 存储库。如果您需要更高版本，请生成它。或者可能会在各地的 20 台不同的机器上产生各种各样的版本。无需预先设置，无需安装节点或 NPM 包等依赖项。无需从源代码构建东西或检查以确保所需的特定工具与此版本的 MacOSX 或 windows 或某种 linux 兼容。无需查看某个新版本的模块是否会破坏您的应用程序的早期版本。该应用程序将始终在 Ubuntu 16.04 环境中运行，其中包含当时适用的所有必需软件。如果有人真的想更新环境的某些方面，他们可以创建一个分叉。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-14T11:28:12.490

如果您使用的是 PM2，这是一种非常流行的方法，现在使用 node.js 扩展和运行应用程序。然后你可能想看看他们提供的工具。如： [https ://github.com/keymetrics/pm2-auto-pull](https://github.com/keymetrics/pm2-auto-pull)

# python - Python Flask 方法定义

> ID：14006440
> 
> 赞同：2
> 
> 时间：2012-12-22T20:44:02.550
> 
> 标签：python, flask

使用 Flask 时，是否必须将所有方法定义放在一个文件中，因为我试图将一些方法定义移动到另一个文件中但 404 未找到错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T08:36:52.217

您不必在一个文件中定义所有内容。这在更大的应用程序中会非常糟糕:) 阅读[官方简短文档](http://flask.pocoo.org/docs/patterns/packages/)并在那里查看建议（其中包括先前答案中提到的蓝图，这是组织大型应用程序的好方法）。

还有一个很好的[示例应用程序](https://github.com/mitsuhiko/flask/wiki/Large-app-how-to)关于如何组织和创建更大的应用程序。也可能有帮助；）

其他非 Flask 特定的方法、类和所有内容都只是简单的 Python，因此也无需将它们放在一个文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:06:20.270

只要该文件具有对`Flask`您创建的对象的引用，您就可以将声明移动到其他文件中，但是如果您的应用程序变得足够大以保证您可能应该开始研究[Flask 蓝图](http://flask.pocoo.org/docs/blueprints/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:18:25.070

正如 Flask 中所建议的，您可以使用 Blueprint 来完成更大的应用程序。我喜欢创建彼此不太耦合的模块化应用程序的方法。因此，您制作的蓝图大部分都具有应用程序功能，例如路由或 before_request。

```
simple_page = Blueprint('simple',__name__,template_folder='templates')
@simple_page.route('/', defaults={'page': 'index'})
@simple_page.route('/<page>')
def show(page):
    try:
        return render_template('pages/%s.html' % page)
    except TemplateNotFound:
        abort(404) 
```

然后你注册它：

```
app = Flask(__name__)
app.register_blueprint(simple_page) 
```

一些关于蓝图的信息：

*   蓝图不是应用程序，不要指望它们会这样。
*   蓝图可以定义它们自己的模板文件夹，这很有用，您可以通过每个蓝图的文件夹模块来指定模板并为您的应用程序排序。
*   您应该始终记住附加一个“。” 尝试获取资源时：

    url_for('.index') #对于烧瓶应用

    url_for('.index') #用于蓝图

*   在撰写此答案时，蓝图是 Flask 中相当新的解决方案，是多个文件夹中模块化应用程序的最佳解决方案，并且在所有应用程序中共享相同的 Flask 对象。

# c# - 使用泛型加入 LINQ

> ID：14006442
> 
> 赞同：2
> 
> 时间：2012-12-22T20:44:37.550
> 
> 标签：c#, .net, linq, generics, linq-to-sql

我正在尝试在泛型中编写 LINQ 连接查询，但在识别外键时遇到了麻烦。PFB 代码。

我想识别表 U 中存在的外键，我可以将其用于比较操作。谢谢

```
var _tab = (from tblT in context.GetTable<T>()
            join tblU in context.GetTable<U>()
            on pk equals fk 
            select tblT).GetEnumerator(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T03:10:52.573

您提到要“识别表 U 中存在的外键”。虽然您可以通过反射和某种约定来做到这一点，但它似乎是一个脆弱的解决方案。我建议您通过委托提供主/外键关系。

基本上，连接使用委托来检索主键和外键，LINQ 提供程序将其转换为连接子句。连接的每一侧的签名基本上是相同的，在你的例子中它是：`Expression<Func<T, TKey>>`和`Expression<Func<U, TKey>>`。重要的是要注意连接两侧的键类型必须相同。

无论您使用什么来调用此方法，都应该要求传入这些委托。它可能看起来像这样：

```
public class Query
{
    public IEnumerable<T> GetData<T, U, TKey>(Expression<Func<T, TKey>> tKey, Expression<Func<U, TKey>> uKey)
    {
        Context context = new Context();
        // using the extension method as the query expression had trouble figuring out the types
        var data = context.GetTable<T>().Join(context.GetTable<U>(), tKey, uKey, (tblT, tblU) => tblT);            

        return data;
    }
} 
```

调用它看起来像这样：

```
var data = query.GetData<Person, Order, int>(person => person.Id, order => order.Orderer.Id); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-08T07:32:33.583

我改进了**@Gary.S 的**答案。在这里，我改进了查询选择器以及如何在此处使用 where close。我认为这将对您有所帮助。

这是我更新的**通用方法。**

注意：**AppDbContext 是我的 dbContext**

```
public class MyGenMetClass
{
    public async Task<IEnumerable<TResult>> FetchJonBy<TOuter, TInner, TKey, TResult>(Expression<Func<TOuter, TKey>> outerKeySelector, Expression<Func<TInner, TKey>> innerKeySelector, Expression<Func<TOuter, bool>> wherOuter, Expression<Func<TInner, bool>> wherInner, Expression<Func<TOuter, TInner, TResult>> resultSelector) where TOuter : class where TInner : class where TResult : class
     {
       try
       {
           using (AppDbContext db = new AppDbContext())
           {
                var data = await db.Set<TOuter>().Where(wherOuter).Join(db.Set<TInner>().Where(wherInner), outerKeySelector, innerKeySelector, resultSelector).ToListAsync();
                    return data;
            }
       }catch (Exception ex){
            return null;
       }
   }
} 
```

我的模型是这样的。

**供应商**模型类

```
public class SupplierModel
{
        [Key]
        public int SupplierId { get; set; }
        public string Name { get; set; }
        public int CategoryId { get; set; }
} 
```

**供应商**类别

```
public class SupplierCatgory
{
       [Key]
       public int CategoryId { get; set; }
       public string Category { get; set; }        
       public Boolean IsActive { get; set; } = true;  
} 
```

**供应商**视图模型类

```
public class SupplierViewModel
{       
        public int SupplierId { get; set; }
        public string Name { get; set; }
        public int CategoryId { get; set; }
        public string Category { get; set; }
} 
```

在这里我*加入了* **SupplierModel**和**SupplierCatgory**并*返回* **SupplierViewModel**

你可以这样打电话

```
var result =await new MyGenMetClass().FetchJonBy<SupplierModel,SupplierCatgory,int, SupplierViewModel>(s=> s.CategoryId,c=>c.CategoryId ,m=>m.IsAcvtive==true,c=>c.IsActive==true, (s, y) => new SupplierViewModel() { Name=s.Name,Category=y.Category} ); 
```

# node.js - 在同一台服务器上运行的 socket.io（节点）和 apache 出现 CORS 错误

> ID：14006446
> 
> 赞同：1
> 
> 时间：2012-12-22T20:45:21.397
> 
> 标签：node.js, socket.io, cors

我正在为我的网站创建一个功能，人们可以在其中与我实时聊天。为了做到这一点，我使用 php 和 apache 构建了网站的常规部分，并使用 node.js（使用 socket.io 和 express）构建了聊天服务器。当人们访问我们的网站时，如果他们想与我聊天，就会从侧面滑出一个小栏（在同一个窗口中，而不是弹出窗口）。随着聊天服务器的运行，我看到客户端正在尝试连接：

```
info  - socket.io started
Express server listening on port 8000 in development mode
debug - client authorized
info  - handshake authorized 776963641537662118 
```

它没有进一步尝试通过 websockets 或 XHR 连接，我在控制台的客户端收到以下错误：

```
XMLHttpRequest cannot load http://wundertutor.com:8000/socket.io/1/?t=1356208544112\. Cannot use wildcard in Access-Control-Allow-Origin when credentials flag is true. 
```

另外，我的 .htaccess 文件中有这个：

```
<IfModule mod_headers.c>
Header set Access-Control-Allow-Origin "*"
</IfModule> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-04T20:04:53.207

我意识到自从提出这个问题以来已经有很长时间了，但是您可能想尝试让您的节点应用程序也允许 CORS。您可以使用以下方法执行此操作：

```
io.set('origins', 'http://example.com:80'); 
```

example.com 是请求的来源。这就是我在我的应用程序上所做的，它允许 CORS 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:58:33.583

除非您希望其他域能够访问受该 mod_headers.c 影响的内容，否则将访问控制限制为您的域，如下所示：

```
<IfModule mod_headers.c>
Header set Access-Control-Allow-Origin http://wundertutor.com/
</IfModule> 
```

即删除错误所抱怨的通配符“*”。

# .net - 如何提示静态检查器以理解简单的算术？

> ID：14006451
> 
> 赞同：1
> 
> 时间：2012-12-22T20:47:09.687
> 
> 标签：.net, code-contracts

我正在研究一个将位图封装为像素数组的对象。该数组是一维的，我将图像的宽度存储在只读字段中。我还添加了一个基于像素数组长度和宽度计算高度的属性。我有以下关于高度的不变量：

*   像素数组（Data 属性，使用私有数据字段）不为空，并且至少有一个元素。
*   宽度大于零

高度属性的代码：

```
public int Height
{
    [Pure]
    get
    {
        Contract.Requires(Data != null);
        Contract.Requires(Width > 0);
        Contract.Requires(Data.Length > 0);

        Contract.Ensures(Contract.Result<int>() > 0);
        Contract.EndContractBlock();
        Contract.Assume(Data.Length > Width);

        return Data.Length / Width;
    }
} 
```

但我无法让静态检查器证明这一点。问题可能是（据我了解），没有要求`Data.Length % Width == 0`，所以因为整数除法`Data.Length / Width`可能为零；因此我添加了没有运气的假设。我不确定如何提示静态检查器接受我的保证。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T01:16:31.433

我写了一个简单的小测试，似乎通过了

测试对象类：

```
public class Class1
{
    public int Width { get; set; }
    public byte[] Data { get; set; }

    public int Height
    {
        [Pure]
        get
        {
            Contract.Requires(Data != null);
            Contract.Requires(Width > 0);
            Contract.Requires(Data.Length > 0);

            Contract.Ensures(Contract.Result<int>() > 1);
            //Contract.Assume(Data.Length > Width);

            return Data.Length / Width;
        }
    }
} 
```

单元测试：

```
[TestFixture]
public class Tests
{
    [Test]
    public void Class1_ContractEnsures_IsEnforced()
    {
        var item = new Class1 { Width = 1, Data = new byte[1] };
        var h = item.Height;
    }
} 
```

请注意，如果我重新启用`Assume`约束，那么这将首先触发（并失败），因此`Ensures`不会被测试。包含单元测试以创建对`Height`. 没有这个，代码合同似乎检测到`Height`没有使用，因此不会应用确保约束。此外，我收到的错误消息`CodeContracts: requires is false`可能有点误导。

如果有帮助，我正在使用`Code Contracts 1.4.50327.0`？

# intellij-idea - IntelliJ - 设置运行配置（出现错误）

> ID：14006458
> 
> 赞同：1
> 
> 时间：2012-12-22T20:48:01.467
> 
> 标签：intellij-idea, run-configuration

我已经开始了一个新项目，并且有一个 .bat 文件来运行我的应用程序。我碰巧使用 linux，所以我不能使用 .bat 文件（除非必须，否则我不想制作 .sh 文件）。有人可以告诉我如何设置我的运行配置，以便我的应用程序将通过 IntelliJ 12 运行吗？我已经尝试了几件事，但我不断收到此错误：

```
 Error: Could not find or load main class com.intellij.rt.execution.application.AppMain 
```

这是 .bat 文件中的行：

```
 java -Xmx1500m -XX:+DisableExplicitGC -noverify -cp bin;libs/* com.rs2.Server localhost 43594 600 
```

这就是我在 IntelliJ 中尝试过的：

（对不起，我不能发布图片，这是链接） [http://imgur.com/8Trn6](http://imgur.com/8Trn6)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:13:53.040

分号仅在 Windows 机器上是路径分隔符。如果您想在 *Nix（包括 Mac）中向您的路径添加内容，那么您需要使用冒号字符。

您的配置如下所示：

```
java -Xmx1500m -XX:+DisableExplicitGC -noverify -cp bin:libs/* com.rs2.Server localhost 43594 600 
```

# eclipse - Eclipse Egit Synchronize Workspace 无更改/空

> ID：14006460
> 
> 赞同：2
> 
> 时间：2012-12-22T20:48:13.467
> 
> 标签：eclipse, egit

我将 Eclipse 与 Egit 一起使用，当我使用以下方法进行同步时：

1.  团队同步工作区
2.  团队、高级、同步（我的标签）

我只得到“Git 没有变化”...

我有更改/新文件尚未提交，请指教。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:13:59.257

用 git 卸载了所有东西。拖动此页面上的“安装”链接：

[http://marketplace.eclipse.org/content/egit-git-team-provider](http://marketplace.eclipse.org/content/egit-git-team-provider)

到日食。链接本身：

[http://marketplace.eclipse.org/marketplace-client-intro?mpc_install=1336](http://marketplace.eclipse.org/marketplace-client-intro?mpc_install=1336)

# android - Android - 用 toast 确认应用退出

> ID：14006461
> 
> 赞同：10
> 
> 时间：2012-12-22T20:48:14.847
> 
> 标签：android, exit, toast, back, confirm

我是 Android 开发的新手，我想要它，所以当用户按下主活动上的后退按钮时，会出现一条 toast 消息，其中包含“再次按下后退按钮确认退出”消息。我该怎么做？这是我到目前为止所拥有的：

```
@Override
public void onBackPressed() {
    // TODO Auto-generated method stub
    super.onBackPressed();
    Toast s = Toast.makeText(getBaseContext(), "Press back again to exit", Toast.LENGTH_LONG);
    s.show();
    wait();

    public boolean onBackPressed() {
        finish();    
    }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-22T20:51:22.000

I would just save the time of the backpress and then compare the time of the latest press to the new press.

```
long lastPress;
@Override
public void onBackPressed() {
    long currentTime = System.currentTimeMillis();
    if(currentTime - lastPress > 5000){
        Toast.makeText(getBaseContext(), "Press back again to exit", Toast.LENGTH_LONG).show();
        lastPress = currentTime;
    }else{
        super.onBackPressed();
    }
} 
```

You can also dismiss the toast when the app the back press is confirmed (cred @ToolmakerSteve):

```
long lastPress;
Toast backpressToast;
@Override
public void onBackPressed() {
    long currentTime = System.currentTimeMillis();
    if(currentTime - lastPress > 5000){
        backpressToast = Toast.makeText(getBaseContext(), "Press back again to exit", Toast.LENGTH_LONG);
        backpressToast.show();
        lastPress = currentTime;
    } else {
        if (backpressToast != null) backpressToast.cancel();
        super.onBackPressed();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-06T09:08:11.073

```
private long mLastPress = 0;
const int TOAST_DURATION = 5000;
Toast onBackPressedToast;
@Override
public void onBackPressed() {
    long currentTime = System.currentTimeMillis();
    if (currentTime - mLastPress > TOAST_DURATION) {
        onBackPressedToast = Toast.makeText(this, R.string.press_once_again_to_exit, Toast.LENGTH_SHORT);
        onBackPressedToast.show();
        mLastPress = currentTime;
    } else {
        if (onBackPressedToast != null) {
            onBackPressedToast.cancel();  //Difference with previous answer. Prevent continuing showing toast after application exit.
            onBackPressedToast = null;
        }
        super.onBackPressed();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-21T13:19:37.937

在我的情况下完美地工作

```
private static long back_pressed;

@Override
public void onBackPressed()
{
        if (back_pressed + 2000 > System.currentTimeMillis()) 
               super.onBackPressed();
        else 
             Toast.makeText(getBaseContext(), "Press once again to exit!", Toast.LENGTH_SHORT).show();
        back_pressed = System.currentTimeMillis();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-02T14:34:36.543

在较新的版本中，您可以使用小吃店代替吐司。

```
import android.support.design.widget.Snackbar;
...
Snackbar.make(content, "Click BACK again to exit", Snackbar.LENGTH_SHORT).setAction("Action", null).show();
... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-03-10T19:23:57.963

在不得不多次实现相同的行为之后，决定继续为相同的行为构建一个库：[`DoubleBackPress Android Library`](https://github.com/kaushikthedeveloper/DoubleBackPress)。它提供了许多易于使用的模板和双后压行为，没有任何麻烦。

做就是了 ：

```
// set the ToastDisplay to be shown on FirstBackPress
FirstBackPressAction firstBackPressAction = new ToastDisplay().standard(this);

// set the Action on DoubleBackPress
DoubleBackPressAction doubleBackPressAction = new DoubleBackPressAction() {
    @Override
    public void actionCall() {
        finish();
    }
};

// setup DoubleBackPress behaviour
DoubleBackPress doubleBackPress = new DoubleBackPress()
        .withDoublePressDuration(3000)
        .withFirstBackPressAction(firstBackPressAction)
        .withDoubleBackPressAction(doubleBackPressAction); 
```

* * *

最后，使用 DoubleBackPress 行为覆盖 onBackPressed 以进行后压。

```
@Override
public void onBackPressed() {
    doubleBackPress.onBackPressed();
} 
```

[类似行为的示例 GIF](https://github.com/kaushikthedeveloper/DoubleBackPress#ToastDisplayExample)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-16T06:17:04.870

Toast 的最佳和简单的解决方案

> 在 Java 中

```
private Toast exitToast;

@Override
public void onBackPressed() {
    if (exitToast == null || exitToast.getView() == null || exitToast.getView().getWindowToken() == null) {
        exitToast = Toast.makeText(this, "Press again to exit", Toast.LENGTH_LONG);
        exitToast.show();
    } else {
        exitToast.cancel();
        finish();
    }
} 
```

> 在科特林

```
private var exitToast: Toast? = null

override fun onBackPressed() {
    if (exitToast == null || exitToast!!.view == null || exitToast!!.view.windowToken == null) {
        exitToast = Toast.makeText(this, "Press again to exit", Toast.LENGTH_LONG)
        exitToast!!.show()
    } else {
        exitToast!!.cancel()
        finish()
    }
} 
```

# google-chrome-extension - 谷歌加分享：图片和描述不来

> ID：14006463
> 
> 赞同：3
> 
> 时间：2012-12-22T20:48:37.423
> 
> 标签：google-chrome-extension, subdomain, google-plus, basic-authentication, facebook-opengraph

我想在 Google plus 上分享带有图片和描述的链接（来自 chrome 扩展）。

**没有http 基本身份验证**它工作正常。

即 URL = "https://mysite.com"

但是使用**http 基本身份验证**，不会加载图像和描述。

即 URL = "https://subdomain.mysite.com"

为了分享我正在使用这个：

在头部部分：

```
<meta property="og:title" content="My title"/>
<meta property="og:image" content="https://subdomain.mysite.com/my_logo.png"/>
<meta property="og:description" content="descption"/> 
```

使用链接分享：

```
<a href="https://plus.google.com/share?url=https://subdomain.mysite.com/link" target="_blank">share</a> 
```

问题是什么 ：

```
http-basic-authentication, subdomain or anything else ? 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T07:31:52.770

如图所示，我尝试使用子域共享 URL，我没有看到任何问题，我能够看到描述和徽标。

![在此处输入图像描述](../Images/b91d5dd96832f586eefccaee8b5b4e4c.png)

### 用于复制的代码。

**清单.json**

```
{
"name":"Share URL",
"description":"Share Some Trivial URL",
"version":"1",
"manifest_version":2,
"browser_action":{
"default_popup":"popup.html"
}
} 
```

**popup.html**

```
<html>
<head>
</head>
<body>
<a href="https://plus.google.com/share?url=http://maps.google.co.in/maps?hl=en&tab=wl" target="_blank">share</a>
</body>
</html> 
```

那是你想要达到的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T15:57:40.523

问题是 http-basic-authentication，这个问题的解决方案：`skipped the http-basic-authentication`对于特定的控制器（共享 url），下面是代码：

```
def http_authenticate

  # this line resolved my problem 
  return if ["my_controller"].include? params[:controller]

  if Rails.env.staging?
    authenticate_or_request_with_http_basic do |username, password|
      username == "u-name" && password == "pass"
    end
  end
end 
```

# python - 安装 pdfminer 错误，权限被拒绝

> ID：14006464
> 
> 赞同：2
> 
> 时间：2012-12-22T20:48:43.603
> 
> 标签：python

我正在尝试安装 pdfminer。使用命令 %python setup.py install 时出现此错误

```
error: could not create '/usr/local/lib/python2.4/site-packages/pyPdf':
Permission denied 
```

所以我尝试了：

```
python2.4 setup.py install --home=$HOME/lib/python2.4 
```

现在，当我尝试 pdf2txt.py -o output.html samples/simple1.pdf 我得到另一个错误：

```
from pdfminer.pdfparser import PDFDocument, PDFParser
ImportError: No module named pdfminer.pdfparser 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-12T15:34:37.053

`/usr/local`使用 sudo安装在默认位置：

```
sudo python2.4 setup.py install 
```

如果您没有 root 权限，则可以指定自定义位置：

```
python2.4 setup.py install --home=$HOME/lib/python2.4 
```

但是，您需要确保该位置位于您的 python 路径上：

```
export PYTHONPATH=$HOME/lib/python2.4:$PYTHONPATH 
```

您可以将它放在您的 bash 配置文件中，以确保它始终自动添加。您还可以从 python 中添加到 python 路径：

```
import sys
sys.path.append('/home/lib/python2.4') 
```

另一种选择是使用 virtualenv。如果未安装 virtualenv，您将需要 root 权限才能安装它，但是您可以将 virtualenvs 放在您想要的任何位置。

# c# - 这怎么可能缩短？

> ID：14006467
> 
> 赞同：-1
> 
> 时间：2012-12-22T20:48:48.037
> 
> 标签：c#, delegates, action, binarywriter

我在这里有这段代码：

```
public void SendID(int id)
{
    try
    {
        binaryWriter.Write((int)Command.ID);

        // part differening each time
        binaryWriter.Write(id);
        // end of part differing each time
    }
    catch (Exception ex)
    {
        if (Error != null)
            Error(this, new ErrorEventArgs(ex));
    }
} 
```

我想概括这个函数，因为 try/catch & Write(Command) 在这些方法中的每一个上总是相等的。现在我想知道最有效的方法是什么？

基本上我想到了一个这样的方法：

```
public void SendCommand(Command cmd, Action<BinaryWriter> action)
{
    try
    {
        binaryWriter.Write((int)Command.ID);
    }
    catch (Exception ex)
    {
        if (Error != null)
            Error(this, new ErrorEventArgs(ex));
    }
} 
```

但是，我无法指定我可能拥有的任何其他参数（例如字符串消息）。

另一种可能性是将参数更改为类型 object 但随后`BinaryWriter`不知道要访问什么，我每次都必须进行明确的对话。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:03:48.827

我认为这很好。您可以按照以下方式调用新方法：

`SendCommand(cmd, binaryWriter => binaryWriter.DoSomething(msg));`

# mysql - SQL 选择查询使 MySQL 服务器没有响应并且没有结果

> ID：14006468
> 
> 赞同：1
> 
> 时间：2012-12-22T20:48:55.830
> 
> 标签：mysql, wordpress

我在数据库中有两个来自目标网站的表，并且必须获取帖子缩略图行。一个表是[wp_posts](http://codex.wordpress.org/Database_Description#Table%3a_wp_posts)，另一个是[wp_postmeta](http://codex.wordpress.org/Database_Description#Table%3a_wp_postmeta)。标准 Wordpress 导出不包括特色图片，所以我打算自己获取。wp_posts 包含所有帖子，特色图片也是一种帖子并存储在此表中。wp_postmeta 表包含与post id 链接的不同元数据，_thumbnail_id 键的值是post 类型'attachment' 的ID。下面的查询将澄清我想说的一点。

```
Select * From wp_posts 
Where ID In (Select meta_value 
    From wp_postmeta 
    Where meta_key='_thumbnail_id' 
    And post_id In (Select ID From wp_posts 
        Where post_type='$post_type')); 
```

wp_post 包含大约 10k 行， wp_postmeta 包含大约 70k 行。谢谢大家的帮助。如果你们告诉我如何将带有缩略图的特定帖子类型从一个 wordpress 安装迁移到另一个，那也很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T18:11:59.653

我认为嵌套`IN`子句可能是您的性能问题的根源。您需要一个适度复杂的查询，因为 WordPress 1) 存储您的帖子，其中包含您`post_type`的一行`wp_posts`，2) 缩略图“附件”作为另一行`wp_posts`，以及 3) 附件元数据`wp_postmeta`。我相信这就是为什么你使用嵌套`IN`的 s but `IN`s 并不是特别有效的原因。

您的查询确实有效，但是对于您的大小的数据库，您可能会耗尽内存或时间，或两者兼而有之。在我的数据库上，它要小得多，您的查询在 0.0123 秒内执行。以下查询与您的查询结果完全相同，执行时间为 0.0006 秒。

```
SELECT children.*
FROM wp_posts as children
JOIN wp_posts as parents on parents.ID = children.post_parent
WHERE children.ID IN (
    SELECT meta_value
    FROM wp_postmeta
    WHERE post_id = parents.ID
    AND meta_key='_thumbnail_id'
) 
AND parents.post_type='{$post_type}' 
```

鉴于它从我的数据库返回 4 行，您可以看到这是多么巨大的执行差异。

以下查询并不比上面的查询慢多少（0.0013 秒），但返回前一个查询未返回的行（在我的情况下是额外的），并且仍然比您的快很多倍。我认为这是您想要的查询。

```
SELECT *
FROM wp_posts as children
JOIN wp_posts as parents on parents.ID = children.post_parent
JOIN wp_postmeta ON parents.ID = wp_postmeta.post_id
AND wp_postmeta.meta_key = '_thumbnail_id'
AND children.post_type = 'attachment'
AND parents.post_type = '{$post_type}' 
```

# c - 类型转换持续多长时间？（C）

> ID：14006470
> 
> 赞同：2
> 
> 时间：2012-12-22T20:49:00.650
> 
> 标签：c, casting, increment

我想编写一个带有两个参数的函数：指向任意内存块的 void 指针类型和块字节大小。知道块中写入的数据的结构类型，该函数应该打印包含的值。

但是，起初，我建议的代码不起作用：

```
#define RECORD struct record
struct record {
      char nam[32];
      double val;
};

void xprint (void *p, long j)
{
    j /= sizeof(RECORD);
    RECORD r;

    while(j--){
        r = *((RECORD *)p++);
        printf("\n..%s.., ..%lf..\n",r.nam, r.val);
    }
    return;
} 
```

所以，我想出了一些替代方案，主要是在代码的递增部分：

```
void print (void *p, long j)
{
    j /= sizeof(RECORD);
    RECORD r = *((RECORD *)p);

    while(j--){
        printf("\n%s,\t%8.2lf\n",r.nam, r.val);
        r = *(++(RECORD *)p);
    }
    return;
} 
```

现在它完成了这项工作，但代码看起来仍然不那么紧凑。

经过一番检查，我发现问题出 `r = *((RECORD *)p++);`在线路上。似乎当涉及到后缀递增时， p 不再是类型转换的，因此 p 仅递增一个字节。

是否可以重写 xprint 函数，以便我仍然使用后缀运算符，但应用于类型转换的指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T20:52:01.260

Convert the `void *` to a `RECORD *` straight away and then use that pointer for the rest of the function.

```
void print (const void *p, size_t size)
{
    const RECORD *r = p;
    size_t count = size / sizeof(*r);

    while (count--) {
        printf("\n%s,\t%8.2lf\n", r->nam, r->val);
        ++r;
    }
} 
```

I also made some stylistic changes here, such as better variable names and adding `const`.

* * *

On a side note, as Clement Rey says it'd be better to use a typedef than a define.

```
typedef struct record record_t; 
```

You can even combine the typedef with the struct definition:

```
typedef struct {
    char nam[32];
    double val;
} record_t; 
```

# javascript - Flash 消息 - jQuery

> ID：14006477
> 
> 赞同：4
> 
> 时间：2012-12-22T20:50:21.747
> 
> 标签：javascript, jquery

在我的 Rails 应用程序中，我有 flash 消息，我希望每次有 flash 消息时，它都会从顶部向下滚动（所有内容都变低）停留几秒钟，然后幻灯片会向上滚动。

我怎么能用 jQuery 做到这一点？

我要切换高度吗？

### 更新

有时消息会被注入到 HTML 中，这意味着`slideDown`由于 DOM 已经加载，因此将无法工作，我怎样才能拥有它以便 jQuery 查找`.message`然后应用`slideDown`and `slideUp`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-22T20:53:46.297

您可以让它向下滑动，等待几秒钟，然后再次滑动：

```
$(selector for your message).slideDown(function() {
    setTimeout(function() {
        $(selector for your message).slideUp();
    }, 5000);
}); 
```

将 更改为`5000`您希望消息保持可见的时间（以毫秒为单位）。

并且记得`display: none;`在 CSS 中为你的消息设置，这样它在 jQuery 进入之前不会出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T20:58:10.683

我假设您的 Flash 消息包含在某个由类标识（或可以）的元素中。您想找到第一个，然后将滚动位置调整到该元素的顶部（或与其有一些偏移），然后等待并滚动回顶部。

```
$(function() {
    var $flashMsg = $('.flash-message:first');
    if ($flashMsg.length) { // we've got one
       var top = $flashMsg.offset().top;
       $('html,body').animate({ scrollTop: top })
                     .delay(3000)
                     .animate({ scrollTop: 0 });
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:56:29.803

使用 JQuery`slideDown()`并`slideUp()`在回调中调用加上一个计时器：

```
$("#message").slideDown(500, function(){
    setTimeout(function(){
$("#message").slideUp(500);  
},5000);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-19T15:39:49.243

```
function flashRed(sel, blinks){  //using jQuery
    blinks = blinks||3
    var x = $(sel),
        bg = x.css('background-color'),
        fg = x.css('color'),
        counter = 0,
        f, b;

    for(var i = 0; i < blinks * 2; i++){  

       setTimeout(function(){
           if(counter%2){
             f=fg; b=bg
           }
           else{
             f='white'; b='red'
           }
           counter++

           x.css({'color':f, 'background-color':b})
       },i*400)
    } 

 } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-06T07:47:13.600

你可以这样做。这里的持续时间以毫秒为单位。

```
$.fn.flash_msg=function(duration){
  this.fadeIn().delay(duration).fadeOut(function(){
    this.remove();
  })
}

$("#message").flash_msg(1500); 
```

# jquery - 从数组中随机选择值并从数组中删除该值

> ID：14006480
> 
> 赞同：2
> 
> 时间：2012-12-22T20:51:01.120
> 
> 标签：jquery, arrays, random

琐碎的问题。到目前为止我所拥有的[http://jsfiddle.net/Dth2y/1/](http://jsfiddle.net/Dth2y/1/)

任务，下一个按钮应该从数组中随机选择一个值并从数组中删除该值。到目前为止，这称为 getNames 函数，在此函数中，从数组中随机选择的值在附加到 html 后也应该被删除。

HTML

```
<h1 id="name">Click Next To Start</h1> <button id="next">NEXT NAME</button> <button>SKIP NAME</button> 
```

​</p>

JS

```
 $(document).ready(function() {
     var names = [
         "Paul",
         "Louise",
         "Adam",
         "Lewis",
         "Rachel"
     ];

     function getNames() {
        return names[Math.floor(Math.random() * names.length)];

     }

             $("#next").click(function() {
                 $('#name').text(getNames())

     });
 }); 
```

​</p>

我已经使用 splice 方法看到了类似的问题，我试图一起破解一个版本，但想知道是否有更有效的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:58:52.840

你会想看看这个：[http ://ejohn.org/blog/javascript-array-remove/](http://ejohn.org/blog/javascript-array-remove/)

```
// Array Remove - By John Resig (MIT Licensed)
Array.prototype.remove = function(from, to) {
  var rest = this.slice((to || from) + 1 || this.length);
  this.length = from < 0 ? this.length + from : from;
  return this.push.apply(this, rest);
}; 
```

在这里它适用于你的小提琴：http: [//jsfiddle.net/Dth2y/3/](http://jsfiddle.net/Dth2y/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:05:49.803

您可以改为随机随机打乱数组，然后`pop()`是第一个元素或`shift()`最后一个元素。

```
/**
 * Shuffles an array in-place
 */
function shuffle(array) {
    for (var i = array.length-1; i > 0; --i) {
        // Select a random index 0 <= j <= i
        var j = Math.floor(Math.random() * (i+1));
        // Swap elements at i and j
        var temp = array[i];
        array[i] = array[j];
        array[j] = temp;
    }
}

$(document).ready(function() {
    var names = [
        "Paul",
        "Louise",
        "Adam",
        "Lewis",
        "Rachel"
    ];

    // Shuffle the names
    shuffle(names);

    $("#next").click(function() {
        // Grab the next name and remove it
        $('#name').text(names.pop());
    });
}); 
```

（该`shuffle`函数基于[Fisher-Yates shuffle 算法](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle#The_modern_algorithm)。[这篇文章](http://bost.ocks.org/mike/shuffle/)解释了它是如何工作的。）

# p2p - How to update nodes within a P2P network?

> ID：14006481
> 
> 赞同：0
> 
> 时间：2012-12-22T20:51:01.750
> 
> 标签：p2p, updates, auto-update

Supposed I have a P2P network with *lots* of nodes. If I want to update the P2P client there is one thing I do *not* want to do: Update each single node.

Now I could imagine updating *one* node, and from time to time, each node checks whether the node it currently interacts with is a newer version - and if so, gets the update from that node.

This way, updates would find their way through the P2P network and all you had to do was update one node. Moreover, you'd not be dependent from a central server.

Is there (somewhere out there ;-)) a concept for such an update scenario?

What might be the pros / cons of this approach?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T09:56:34.683

优点：如果出于任何其他原因，讨论和谈论真的很酷。

缺点：

*   可能是一个安全漏洞。如果我可以在 P2P 网络上放置一个流氓对等点，我的代码可以宣传实际上是病毒的更新。您至少应该确保更新包括某种代码签名和身份验证。

*   如果 P2P 协议或更新代码中存在任何类型的错误，那么您可能会进入只能升级所有节点的子集的状态。

更好的方法可能是让客户端从集中位置获取更新。一种混合方法是通过发布 URL 和文件哈希的中央服务器通知对等方更新。如果节点可以从对等点获取更新（并验证哈希和代码签名），那就太好了。但始终将“从中央服务器下载”作为后备。

您可能还想考虑如何合并“分阶段推出”，以便只有有限数量的对等方接收更新。因此，您可以在将更新推送到所有其他对等方之前验证更新在一小部分上是否正常。

# python - GPS Python 模块错误

> ID：14006482
> 
> 赞同：0
> 
> 时间：2012-12-22T20:51:03.803
> 
> 标签：python, gps, raspberry-pi, gpsd

我正在尝试在 rpi 上使用[此脚本。](http://www.danmandle.com/blog/getting-gpsd-to-work-with-python/)如果 gpsd 正在运行并且我从链接的博客文章中运行脚本，则会收到以下错误：

```
 File "/home/zzz/Timelapse/staticgps.py", line 29, in <module>
    gpsp = GpsPoller() # create the thread
  File "/home/zzz/Timelapse/staticgps.py", line 19, in __init__
    gpsd = gps.gps(mode=WATCH_ENABLE) #starting the stream of info
NameError: global name 'gps' is not defined 
```

知道出了什么问题吗？谢谢！！

编辑：这是我要求的脚本。它是链接的直接复制/粘贴。

```
#! /usr/bin/python
# Written by Dan Mandle http://dan.mandle.me September 2012
# License: GPL 2.0

import os
from gps import *
from time import *
import time
import threading

gpsd = None #seting the global variable

os.system('clear') #clear the terminal (optional)

class GpsPoller(threading.Thread):
    def __init__(self):
        threading.Thread.__init__(self)
        global gpsd #bring it in scope
        gpsd = gps(mode=WATCH_ENABLE) #starting the stream of info
        self.current_value = None
        self.running = True #setting the thread running to true

    def run(self):
        global gpsd
        while gpsp.running:
            gpsd.next() #this will continue to loop and grab EACH set of gpsd info to clear the buffer

if __name__ == '__main__':
    gpsp = GpsPoller() # create the thread
    try:
        gpsp.start() # start it up
        while True:
            #It may take a second or two to get good data
            #print gpsd.fix.latitude,', ',gpsd.fix.longitude,'  Time: ',gpsd.utc

            os.system('clear')

            print
            print ' GPS reading'
            print '----------------------------------------'
            print 'latitude    ' , gpsd.fix.latitude
            print 'longitude   ' , gpsd.fix.longitude
            print 'time utc    ' , gpsd.utc,' + ', gpsd.fix.time
            print 'altitude (m)' , gpsd.fix.altitude
            print 'eps         ' , gpsd.fix.eps
            print 'epx         ' , gpsd.fix.epx
            print 'epv         ' , gpsd.fix.epv
            print 'ept         ' , gpsd.fix.ept
            print 'speed (m/s) ' , gpsd.fix.speed
            print 'climb       ' , gpsd.fix.climb
            print 'track       ' , gpsd.fix.track
            print 'mode        ' , gpsd.fix.mode
            print
            print 'sats        ' , gpsd.satellites

            time.sleep(5) #set to whatever

    except (KeyboardInterrupt, SystemExit): #when you press ctrl+c
        print "\nKilling Thread..."
        gpsp.running = False
        gpsp.join() # wait for the thread to finish what it's doing
    print "Done.\nExiting." 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:36:36.780

您没有正确复制代码；链接页面有这一行：

```
gpsd = gps(mode=WATCH_ENABLE) #starting the stream of info 
```

请注意，它只是`gps()`，不是`gps.gps()`; 在脚本的顶部，`gps`模块中的所有名称都被导入到当前命名空间中，从而`gps()`形成本地名称。

确保您的脚本顶部*确实*有该语句`from gps import *`，从错误消息中可以看出您没有正确导入它（这`NameError`表明您的脚本中*没有任何*命名`gps`导入）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-10T19:37:15.957

如果有人在这里遇到同样的问题，那是因为您的脚本文件名为 gps.py。只需将其重命名为其他名称，导入即可正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-17T19:50:12.493

将 WATCH_ENABLE 替换为 1，就可以了。我不确定为什么这个常量没有暴露（新手） - 它在 gps 模块的 client.py 中声明

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-30T15:20:13.257

将脚本命名为 gps.py 不仅会导致无法定义 gps，而且您也不能将其命名为 gps1.py。将其重命名为 mygps.py

# javascript - How to append script tag to a div tag which is dynamically generate by javascript

> ID：14006487
> 
> 赞同：1
> 
> 时间：2012-12-22T20:51:42.493
> 
> 标签：javascript

I create a dynamical tag with id "video1" inside the static tag with id "videos":

```
document.getElementById("videos").innerHTML = '<div id="video1"></div>'; 
```

But when I want to append another script tag, I failed.

The following is my code to append that tag:

```
var s = document.createElement("script");
s.id = "scriptId"; //script tag's id
document.getElementById("video1").appendChild(s); 
```

The above code works for static tag, but it doesn't work for the dynamical generated tag video1\. So is there any way I can append a script tag to an another tag which is also dynamically generated by javascript?

Thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T20:59:16.930

相反，将其附加到头部：

```
var s = document.createElement("script");
s.id = "scriptId"; //script tag's id
document.getElementsByTagName("head")[0].appendChild(s); 
```

您还可以使用`eval(s.text)`来评估脚本的文本内容

# c# - Checking for mouse hover for a certain radius around a point

> ID：14006491
> 
> 赞同：0
> 
> 时间：2012-12-22T20:52:59.113
> 
> 标签：c#, forms

I am creating an FPS-like game via C# form. It is the first game I'm writing, so take it easy :p Anyway, the main idea is that the program would recognize when user's cursor hovers on a character. Now lets say that the character's coordinates are (X,Y) and I want to check if the cursor is within.. a range of 10\. To check this, I can use 2 conditions of **for** loops, but I believe there is a better way for checking it and I just don't know it. If you misunderstood what my intention is, post here and I will try to clarify it. Thank you

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:10:43.317

您不需要 for 循环。
假设鼠标坐标是（m_x，m_y），而字符坐标是（x，y）。
计算距离为 sqrt((m_x-x)*(m_x-x) + (m_y-y)*(m_y-y)) 如果距离小于 10，则鼠标在范围内。

为了获得更好的运行时间，请避免使用 sqrt，即

> if (((m_x-x)*(m_x-x) + (m_y-y)*(m_y-y) <100 )
> // 范围内 else
> // 范围外

# asp.net - Change pagesize in a repeater control

> ID：14006492
> 
> 赞同：0
> 
> 时间：2012-12-22T20:53:01.543
> 
> 标签：asp.net, vb.net, repeater

Is there a way of changing the pagesize of a repeater control depending on for example, the number of items belonging to a specific category?

I have written a count sql statement to count the number of items in a category and then have set that to be the pagesize but it doesn't seem to work properly.

```
aQuery = "Select COUNT(Product.ProductID) From Product INNER JOIN Category WHERE Product.CategoryID = Category.CategoryID GROUP BY Category.CategoryID 
```

this should give me a different value each time. But when I assign this value to the pagedData2.PageSize variable it doesn't change the number of items displayed on each page.

Is there a way of getting the number displayed on each page to change?

# java - 可以以线程安全的方式安全地递增 BigInteger，也许使用 AtomicReference，没有锁定？

> ID：14006495
> 
> 赞同：12
> 
> 时间：2012-12-22T20:53:34.673
> 
> 标签：java, increment, biginteger, atomicreference

我们的很多代码都是遗留的，但我们正在转向“大数据”后端，我正在尝试宣传更新的 API 调用，鼓励使用最新的 Spring 库等。我们的问题之一是应用层 ID一代。由于我不明白的原因，更高的权威想要顺序的 BigInteger。我会通过重新生成并重新尝试失败的插入来使它们随机化，但我确实被否决了。

撇开抱怨不谈，我现在需要跨线程递增并获取 BigInteger 并以安全和高性能的方式进行操作。我以前从未使用过 AtomicReference，但它看起来非常适合这个应用程序。现在我们有一个同步的代码块，它严重地损害了我们的性能。

这是正确的方法吗？语法示例？

我应该提到这个模块的工作方式，它使用存储过程访问数据库以获取要使用的值范围。一次数以万计，因此它可能仅在 20 分钟内发生一次。这可以防止各种服务器互相踩踏，但也增加了必须将 BigInteger 设置为任意后续值的麻烦。当然，这也需要是线程安全的。

PS我仍然认为我的随机生成想法比处理所有这些线程的东西要好。BigInteger 是一个大得离谱的数字，两次生成同一个数字的几率必须接近于零。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-22T21:09:48.577

可以使用 AtomicReference 这是一个快速草稿：

```
public final class AtomicBigInteger {

    private final AtomicReference<BigInteger> valueHolder = new AtomicReference<>();

    public AtomicBigInteger(BigInteger bigInteger) {
        valueHolder.set(bigInteger);
    }

    public BigInteger incrementAndGet() {
        for (; ; ) {
            BigInteger current = valueHolder.get();
            BigInteger next = current.add(BigInteger.ONE);
            if (valueHolder.compareAndSet(current, next)) {
                return next;
            }
        }
    }
} 
```

它基本上是 AtomicLong 代码的副本`incrementAndGet()`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-04-09T16:54:12.177

[`accumulateAndGet`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicReference.html#accumulateAndGet-V-java.util.function.BinaryOperator-)使用 Java 8 中引入的or变得更易于管理和理解[`getAndAccumulate`](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/atomic/AtomicReference.html#getAndAccumulate-V-java.util.function.BinaryOperator-)。这些允许您通过提供一个累加器函数来自动更新值，该函数将值设置为函数的结果，并且还可以返回先前的或计算的结果，具体取决于关于你需要什么。这是该类的外观示例，然后是我编写的使用它的简单示例：

```
import java.math.BigInteger;
import java.util.Objects;
import java.util.concurrent.atomic.AtomicReference;

public final class AtomicBigInteger {

  private final AtomicReference<BigInteger> bigInteger;

  public AtomicBigInteger(final BigInteger bigInteger) {
    this.bigInteger = new AtomicReference<>(Objects.requireNonNull(bigInteger));
  }

  // Method references left out for demonstration purposes
  public BigInteger incrementAndGet() {
    return bigInteger.accumulateAndGet(BigInteger.ONE, (previous, x) -> previous.add(x));
  }

  public BigInteger getAndIncrement() {
    return bigInteger.getAndAccumulate(BigInteger.ONE, (previous, x) -> previous.add(x));
  }

  public BigInteger get() {
    return bigInteger.get();
  }
} 
```

一个使用它的例子：

```
import java.math.BigInteger;
import java.util.List;
import java.util.concurrent.Callable;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;
import java.util.concurrent.TimeUnit;
import java.util.stream.Collectors;
import java.util.stream.IntStream;

public class ABIExample {

  private static final int AVAILABLE_PROCS = Runtime.getRuntime().availableProcessors();
  private static final int INCREMENT_AMOUNT = 2_500_000;
  private static final int TASK_AMOUNT = AVAILABLE_PROCS * 2;
  private static final BigInteger EXPECTED_VALUE = BigInteger.valueOf(INCREMENT_AMOUNT)
                                                             .multiply(BigInteger
                                                                           .valueOf(TASK_AMOUNT));

  public static void main(String[] args)
      throws InterruptedException, ExecutionException {
    System.out.println("Available processors: " + AVAILABLE_PROCS);

    final ExecutorService executorService = Executors
        .newFixedThreadPool(Runtime.getRuntime().availableProcessors());

    final AtomicBigInteger atomicBigInteger = new AtomicBigInteger(BigInteger.ZERO);

    final List<Callable<Void>> incrementTasks =  IntStream.rangeClosed(1, TASK_AMOUNT)
             .mapToObj(i -> incrementTask(i, atomicBigInteger))
             .collect(Collectors.toList());
    final List<Future<Void>> futures = executorService.invokeAll(incrementTasks);
    for (Future<Void> future : futures) {
      future.get();
    }
    executorService.shutdown();
    executorService.awaitTermination(30, TimeUnit.SECONDS);
    System.out.println("Final value: " + atomicBigInteger.get());
    final boolean areEqual = EXPECTED_VALUE.equals(atomicBigInteger.get());
    System.out.println("Does final value equal expected? - " + areEqual);
  }

  private static Callable<Void> incrementTask(
      final int taskNumber,
      final AtomicBigInteger atomicBigInteger
  ) {
    return () -> {
      for (int increment = 0; increment < INCREMENT_AMOUNT; increment++) {
        atomicBigInteger.incrementAndGet();
      }
      System.out.println("Task #" + taskNumber + " Completed");
      return null;
    };

  }
} 
```

在我的机器上运行示例的输出：

```
Available processors: 8
Task #3 Completed
Task #8 Completed
Task #7 Completed
Task #6 Completed
Task #5 Completed
Task #2 Completed
Task #4 Completed
Task #1 Completed
Task #9 Completed
Task #10 Completed
Task #11 Completed
Task #13 Completed
Task #16 Completed
Task #12 Completed
Task #14 Completed
Task #15 Completed
Final value: 80000000
Does final value equal expected? - true 
```

# mongodb - 列出集合中的特定数据

> ID：14006496
> 
> 赞同：1
> 
> 时间：2012-12-22T20:53:35.517
> 
> 标签：mongodb, spring-data, mongodb-java

我有一个 Admin 表，如下所示：

```
{ "_id" : "userID1", "_class" : "com.test.Admin", "projectList" : 
[     {       "projectID" : "project1" }, 
      {       "projectID" : "project2" } 
] }
{ "_id" : "userID2", "_class" : "com.test.Admin", "projectList" : 
[     {       "projectID" : "project3" }, 
      {       "projectID" : "project4" } 
] } 
```

我需要一种方法来列出 Admin 集合中的所有项目（即从每个文档中获取所有“projectList”） 我如何使用 java 驱动程序进行一个查询来获取所有只有数据的 projectList！

我目前使用的方法是获取所有管理员。然后编写一些java代码来获取每个Admin的所有项目。但是，我不喜欢我目前的做法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:03:24.670

将其转换为您的 Java 驱动程序：

```
db.admin.find({ projectList : {$exists : true}}, {projectList: 1}) 
```

它检查每个 projectList 属性是否存在，然后使用投影，只返回每个匹配文档的 projectList 属性。

可能类似于（我从未使用过 Java 驱动程序）：

```
query = new BasicDBObject("projectList", new BasicDBObject("$exists", true));

cursor = find(query, BasicDBObject("projectList", 1); 
```

# javascript - 动态加载的 jQuery 中的断点

> ID：14006499
> 
> 赞同：1
> 
> 时间：2012-12-22T20:54:16.337
> 
> 标签：javascript, debugging, google-chrome

我正在尝试在动态加载的 chrome 中调试一些 javascript。我尝试按照[此处](https://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints)的说明进行操作，但似乎已过时。脚本选项卡现在称为源，即使按下按钮后我似乎也找不到 dynamicScript.js。

我可以从源选项卡中看到动态加载的 js 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:08:08.100

实际上他们在那里。按![在此处输入图像描述](../Images/4725955071faef65912416126fcead15.png), 和中提琴。

![在此处输入图像描述](../Images/a8ba250ff38750f254d14f4702934368.png)

在[这个例子中，](http://jsfiddle.net/DerekL/gjf8e/)我动态地包含了`jquery.easing`. 他们隐藏它只是为了不会在栏上出现一堆标签。

## 更新

[他们的例子](https://developers.google.com/chrome-developer-tools/docs/scripts-breakpoints)是行不通的。（他们可能已经从其他地方移动了这个页面？）

![在此处输入图像描述](../Images/529f5d752c323bd01192543bad58d975.png)

如您所见，由于[Same origin policy](http://en.wikipedia.org/wiki/Same_origin_policy)`dynamicScript.js`未加载。他们试图从 to 加载脚本，这是不允许的。注意他们的例子实际上是在，不是。（不知道他们为什么这样做。）`google.com``appspot.com``appspot.com``google.com`

# objective-c - Implement alloc on a singleton

> ID：14006503
> 
> 赞同：4
> 
> 时间：2012-12-22T20:54:47.920
> 
> 标签：objective-c, ios

I'd like to have a singleton in my system but rather than have callers access it via some kind of 'sharedInstance' method, I'd like them to be able to be unaware that they are using a singleton, in other words, I'd like the callers to be able to say:

```
MyClass *dontKnowItsASingleton = [[MyClass alloc] init]; 
```

To accomplish this, I've tried overriding alloc as follows:

```
// MyClass.m

static MyClass *_sharedInstance;

+ (id)alloc {

    if (!_sharedInstance) {
        _sharedInstance = [super alloc];
    }
    return _sharedInstance;
} 
```

My question is: is this okay? It seems to work, but I've never overridden alloc before. Also, if it's okay, could I always use this technique, rather than dispatch_once approach I have been doing? ...

```
+ (id)sharedInstance {

    static SnappyTV *_sharedInstance = nil;
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        _sharedInstance = [[self alloc] init];
    });
    return _sharedInstance;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T21:02:03.523

正如@H2CO3 提到的，您制作单例的方法是可以接受的，但不是线程安全的。更传统的方法是将您的分配和比较包装在一个`@synchronized`块中，以减少多线程访问，但是覆盖`+alloc`并不是实现已经摇摇欲坠的模式的最佳方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:40:13.783

万一其他人来找我，我认为这是一个集成了所有好建议的解决方案：

```
+ (id)alloc {

    @synchronized(self) {
        if (!_sharedInstance) {
            _sharedInstance = [super alloc];
        }
        return _sharedInstance;
    }
}

- (id)init {

    @synchronized(self) {
        static BOOL init = NO;
        if (!init) {
            init = YES;
            self = [super init];
        }
    }
    return self;
} 
```

感谢@H2CO3 解决线程安全问题，感谢@CodaFi 解决线程安全问题，感谢@Rob Mayoff 解决 init under arc 的危险。我今天得到了最优秀和最聪明的人的帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T21:09:06.757

我认为您应该利用初始化方法：

```
+ (void) initialize
{
    _sharedInstance= [[self alloc]init];
}

+ (id)sharedInstance 
{
    return _sharedIntsance;
} 
```

# scala - Scala: flattening a map into a map

> ID：14006505
> 
> 赞同：0
> 
> 时间：2012-12-22T20:55:12.177
> 
> 标签：scala, map

I have the following 2 lists:

```
val a = List(List(1,2,3),List(2,3,4),List(3,4,5))
val b = List(1,2,3) 
```

I want to filter elements in `a` that contain an element in `b` and add them to a Map like so:

```
Map(1 -> List(List(1, 2, 3)), 2 -> List(List(1, 2, 3), List(2, 3, 4)), 3 -> List(List(1, 2, 3), List(2, 3, 4), List(3, 4, 5))) 
```

I tried the following:

```
b.map(x => Map( x -> a.filter(y => y contains x))) 
```

but it gives me

```
List(Map(1 -> List(List(1, 2, 3))), Map(2 -> List(List(1, 2, 3), List(2, 3, 4))), Map(3 -> List(List(1, 2, 3), List(2, 3, 4), List(3, 4, 5)))) 
```

How do I flatten this into a single Map? Is my approach wrong?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:11:11.353

首先，答案：

```
Map(b.map(i => (i, a.filter(_.contains(i)))):_*) 
```

如您所见，您非常接近，但您打电话`Map()`（即，`Map.apply()`）太“早”了。相反，您应该首先创建一个元组列表，因为您可以将一个元组序列传递给`Map.apply()`.

**更新：**正如 aztek 所说，这可以简化：

```
b.map(i => (i, a.filter(_.contains(i)))).toMap 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T23:19:15.743

或者，如果parens让你眼花缭乱，

```
scala> for (k <- b; c <- a; if c contains k) yield k -> c
res4: List[(Int, List[Int])] = List((1,List(1, 2, 3)), (2,List(1, 2, 3)), (2,List(2, 3, 4)), (3,List(1, 2, 3)), (3,List(2, 3, 4)), (3,List(3, 4, 5)))

scala> .groupBy(_._1)
res5: scala.collection.immutable.Map[Int,List[(Int, List[Int])]] = Map(2 -> List((2,List(1, 2, 3)), (2,List(2, 3, 4))), 1 -> List((1,List(1, 2, 3))), 3 -> List((3,List(1, 2, 3)), (3,List(2, 3, 4)), (3,List(3, 4, 5))))

scala> .mapValues(_.map(_._2))
res6: scala.collection.immutable.Map[Int,List[List[Int]]] = Map(2 -> List(List(1, 2, 3), List(2, 3, 4)), 1 -> List(List(1, 2, 3)), 3 -> List(List(1, 2, 3), List(2, 3, 4), List(3, 4, 5))) 
```

最近有人说他经常要做这个操作，就是扁平化值；现在我想知道这是否是他的意思。

# python - Writing MATE/GNOME Applets (Python) with PyGObject Introspection

> ID：14006512
> 
> 赞同：5
> 
> 时间：2012-12-22T20:55:56.503
> 
> 标签：python, gnome, pygobject, mate-desktop

So I have been trying to port a C GNOME applet to MATE, and after running into many different problems, I decided to rewrite it from scratch in python. Eventually, I found some not-horribly-out-of-date documentation, which is here: [http://wiki.mate-desktop.org/docs:devel:mate-panel](http://wiki.mate-desktop.org/docs:devel:mate-panel)

Apparently the new way of writing applets in python is to use PyGObject introspection, instead of the 'old' PyGtk.

So I have a few questions:

```
1\. Why is it better to use PyGObject instead of PyGtk etc
2\. Is the end user who downloads a python applet expected to have pygobject installed? It looks like it.
3\. The MATE documentation says 'ensure we are using Gtk 2, not Gtk3', but http://python-gtk-3-tutorial.readthedocs.org/en/latest/install.html says that its exclusively supports Gtk+ 3 and higher. 
```

EDIT: If I run

```
import gi
gi.require_version("Gtk", "2.0") 
```

in a python session, I get the warning:

```
RuntimeWarning: You have imported the Gtk 2.0 module.  Because Gtk 2.0 was not designed for use with introspection some of the interfaces and API will fail.  As such this is not supported by the pygobject development team and we encourage you to port your app to Gtk 3 or greater. PyGTK is the recomended python module to use with Gtk 2.0 
```

Which pretty much answers Question 3, but then brings up Question 1 again. Also, running `from gi.repository import MatePanelApplet` gives an ImportError `Could not find any typelib for MatePanelApplet` even though I have libmatepanelapplet-dev installed.

EDIT AGAIN: I found a solution to the ImportError here: [Can't import Webkit from gi.repository](https://stackoverflow.com/questions/7823972/cant-import-webkit-from-gi-repository). (Just install `gir1.2-mate-panel` instead of webkit)

And more errors:

```
./xmonad-log-applet.py:66: Warning: g_closure_set_marshal: assertion `closure != NULL' failed
  applet = MatePanelApplet.Applet()

(xmonad-log-applet.py:10928): GLib-GIO-CRITICAL **: g_dbus_connection_register_object: assertion `G_IS_DBUS_CONNECTION (connection)' failed
Segmentation fault (core dumped) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T08:37:52.767

MATE 是 GNOME 2 的一个分支，因此您应该使用 PyGTK（作为您收到的消息）。

关于每个问题：

1.  PyGObject 更好，因为您只需要一个与库（提供自省的库）的绑定，并且您可以自动访问每个支持 GOBject Introspection 的库的公共 API。对于开发人员来说是好事，因为他们可以访问与 C 相同的 API，而无需等待每个新版本的绑定。

2.  是的。但是用户很可能会有。GNOME 3 的几率是 100%，而 GNOME 2 (MATE) 的几率较小，因为它不是必需的。

3.  它看起来不像一个问题。正如我之前所说，MATE 是 GNOME 2 的一个版本，因此您必须使用可用于 GNOME 2 的库和文档。

您可以检查在 Python 中为 GNOME 2 编写的小程序（在 GNOME 删除 Bonobo 之后）。例如，[hasmter](https://github.com/projecthamster/hamster/tree/gnome_2x)。您可能需要更改一些名称，可能在 MATE 中将库名称从 GNOME 重命名为 MATE。

# java - Spring MVC + Hibernate: Partial model update from browser

> ID：14006517
> 
> 赞同：5
> 
> 时间：2012-12-22T20:56:37.993
> 
> 标签：java, spring, hibernate, spring-mvc

When only displaying a part of a Spring MVC model bean, is there a way to only update in the model what comes back from the browser?

Let's say we have a User class (public properties only in this example, of course):

```
public class User {
  public String firstName;
  public String lastName;
  public String email;
  public Date subscriptionExpiration;
} 
```

Now I display the first three properties as input fields in a JSP and want to update the object in the database accordingly. Only these 3 parameters should be updated, NOT the fourth one. One way to accomplish this would be

```
@RequestMapping("/user/{userId}", method=RequestMethod.POST)
public String saveChanges(@PathVariable userId, User user, Model model) {
  User oldUser = User.loadFromDB(userId);
  oldUser.firstName = user.firstName;
  oldUser.lastName = user.lastName;
  oldUser.email = user.email;
  oldUser.saveToDB();

  model.addAttribute("user", oldUser);
} 
```

but this would mean hardcoding all properties that could change, which I don't like too much.

Is there any way to determine what fields to update based on what the user was allowed to change? That mechanism should be smarter than just assuming that everything that's in the request parameters may be changed, otherwise any savvy user could manually inject additional fields into a request.

Using @Entity(dynamicUpdate=true) does not solve the problem either in my eyes, as I'm not getting the whole User object back in the request, and doing so would open up many security holes.

Am I missing a nice feature in Spring or is there any other way to conceptually solve for this problem? Any hints are greatly appreciated!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:48:05.950

请参阅[此问题](https://stackoverflow.com/questions/12597627/how-do-i-prevent-spring-mvc-overwriting-sessionattributes-from-request)以了解如何使用 @InitBinder 来允许/防止某些模型字段被 Spring 绑定以请求参数。这允许确保`subscriptionExpiration`不能通过注入请求参数来修改。

请参阅[文档](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/mvc.html#mvc-ann-modelattrib-methods)，了解如何在方法和方法参数上使用 @ModelAttribute 注释从数据库加载用户并将其添加到模型中，然后再调用 @RequestMapping 方法，并在 @RequestMapping 方法被调用时使用请求参数填充此用户RequestMapping 方法被调用。这允许从数据库中获取用户并让 Spring 使用来自请求的 ne 值填充它。您所要做的就是验证用户的新状态并将其保存到数据库中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T21:48:12.657

我认为方法

```
BeanUtils.copyProperties(Object source, Object target, String[] ignoreProperties) 
```

做你想做的事。它将所有属性从一个对象复制到另一个对象，而不会触及 中定义的属性`String[] ignoreProperties`。

> 将给定源 bean 的属性值复制到给定目标 bean 中，忽略给定的“ignoreProperties”。
> 
> 注意：源类和目标类不必匹配，甚至不必相互派生，只要属性匹配即可。源 bean 公开但目标 bean 未公开的任何 bean 属性都将被静默忽略。
> 
> 这只是一种方便的方法。对于更复杂的传输需求，请考虑使用完整的 BeanWrapper。

[API 文档](http://static.springsource.org/spring/docs/1.2.9/api/org/springframework/beans/BeanUtils.html#copyProperties%28java.lang.Object,%20java.lang.Object,%20java.lang.String%5B%5D%29)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-23T20:52:23.210

一种选择是利用表单中的隐藏字段。一个有缺点的选项，但它适用于某些情况

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-03T11:03:35.637

您可以先从数据库中读取对象，然后再绑定请求。您可以在[FuWeSta-Sample](https://github.com/opensource21/fuwesta/blob/dff999c3689e2a44536b0ce4f6bf0a39cabca2a4/fuwesta-sample/src/main/java/de/ppi/samples/fuwesta/frontend/PostCRUDController.java#L279)找到一个示例。

它使用一个必须由 Spring 初始化的[helper-bean 。](https://github.com/opensource21/fuwesta/blob/dff999c3689e2a44536b0ce4f6bf0a39cabca2a4/fuwesta-core/src/main/java/de/ppi/fuwesta/spring/mvc/bind/ServletBindingService.java)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-21T16:50:41.083

您正在寻找的好功能是[@ModelAttribute](http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#mvc-ann-modelattrib-methods)。我假设您的表单也会发布用户 ID。

```
public class UserController {

    @ModelAttribute
    public User getUser(@RequestParam(value = "id", required = false) Long id) {
        return User.loadFromDB(id);
    }

    @RequestMapping("/user/{id}", method=RequestMethod.POST)
    public String saveChanges(@ModelAttribute User user, BindingResult bindingResult, Model model) {

        if (bindingResult.hasErrors()) {
            // return ...
        }

        //  model.asMap().clear();

        user.saveToDB();
        // return ...
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-06-22T13:40:11.983

我有同样的问题，最后通过添加一个类型转换器来解决它。

```
public class AbstractDocumentConverter implements Converter<String, AbstractDocument> {

    private AbstractDocumentRepository abstractDocumentRepository;

    public AbstractDocumentConverter(AbstractDocumentRepository abstractDocumentRepository) {
        this.abstractDocumentRepository = abstractDocumentRepository;
    }

    @Override
    public AbstractDocument convert(String id) {
        return abstractDocumentRepository.findOne(id);
    }
} 
```

我使用 mongodb， AbstractDocument 是我所有文档的超类，在控制器中我添加 @ModelAttribute("id") 。

```
@RequestMapping("save")
public String save(@ModelAttribute("id") SportGame game) {
    sportGameService.save(game);
    return "redirect:/game/list";
} 
```

它首先将 id 转换为模型（在我的转换器中，它通过 id 从 db 中找到一个），然后从请求参数中填充模型字段。

# ruby - RMagick installation fails to build native extension

> ID：14006518
> 
> 赞同：3
> 
> 时间：2012-12-22T20:56:39.430
> 
> 标签：ruby, rmagick

On Mountain Lion I am trying to install RMagick. I found an [issue on GitHub](https://github.com/mroth/lolcommits/issues/56) and the solution should be the command `gem pristine rmagick`. But when I run it, I get:

```
ERROR:  While executing gem ... (Gem::Exception)
    Failed to find gems ["rmagick"] >= 0 
```

When I run `gem install rmagick`, I get this huge error:

```
Building native extensions.  This could take a while...
ERROR:  Error installing rmagick:
    ERROR: Failed to build gem native extension.

        /Users/xxxxx/.rvm/rubies/ruby-1.9.3-p327/bin/ruby extconf.rb
checking for Ruby version >= 1.8.5... yes
extconf.rb:128: Use RbConfig instead of obsolete and deprecated Config.
checking for clang... yes
checking for Magick-config... yes

Warning: Found more than one ImageMagick installation. This could cause problems at runtime.
         /usr/local/bin/Magick-config reports version 6.7.7 Q16 is installed in /usr/local/Cellar/imagemagick/6.7.7-6
         /opt/ImageMagick/bin/Magick-config reports version 6.7.8 Q16 is installed in /opt/ImageMagick
Using 6.7.7 Q16 from /usr/local/Cellar/imagemagick/6.7.7-6.

checking for ImageMagick version >= 6.4.9... yes
checking for HDRI disabled version of ImageMagick... yes
checking for stdint.h... yes
checking for sys/types.h... yes
checking for wand/MagickWand.h... yes
checking for InitializeMagick() in -lMagickCore... yes
checking for snprintf() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for AcquireImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for AffinityImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for AffinityImages() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for AutoGammaImageChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for AutoLevelImageChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for BlueShiftImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for ConstituteComponentTerminus() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for DeskewImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for EncipherImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for EqualizeImageChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for FloodfillPaintImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for FunctionImageChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for GetAuthenticIndexQueue() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for GetAuthenticPixels() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for GetImageAlphaChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for GetVirtualPixels() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for LevelImageColors() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for LevelColorsImageChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for LevelizeImageChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for LiquidRescaleImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for MagickLibAddendum() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for OpaquePaintImageChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for QueueAuthenticPixels() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for RemapImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for RemoveImageArtifact() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for SelectiveBlurImageChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for SetImageAlphaChannel() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for SetImageArtifact() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for SetMagickMemoryMethods() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for SparseColorImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for SyncAuthenticPixels() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for TransparentPaintImage() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for TransparentPaintImageChroma() in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for QueryMagickColorname() new signature... yes
checking for Image.type in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for DrawInfo.kerning in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for DrawInfo.interline_spacing in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for DrawInfo.interword_spacing in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for DitherMethod in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for MagickFunction in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for ImageLayerMethod in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for long double in assert.h,ctype.h,stdio.h,stdlib.h,math.h,time.h,stdint.h,sys/types.h,wand/MagickWand.h... yes
checking for AlphaChannelType.CopyAlphaChannel... yes
checking for AlphaChannelType.BackgroundAlphaChannel... yes
checking for CompositeOperator.BlurCompositeOp... yes
checking for CompositeOperator.DistortCompositeOp... yes
checking for CompositeOperator.LinearBurnCompositeOp... yes
checking for CompositeOperator.LinearDodgeCompositeOp... yes
checking for CompositeOperator.MathematicsCompositeOp... yes
checking for CompositeOperator.PegtopLightCompositeOp... yes
checking for CompositeOperator.PinLightCompositeOp... yes
checking for CompositeOperator.VividLightCompositeOp... yes
checking for CompressionType.DXT1Compression... yes
checking for CompressionType.DXT3Compression... yes
checking for CompressionType.DXT5Compression... yes
checking for CompressionType.ZipSCompression... yes
checking for CompressionType.PizCompression... yes
checking for CompressionType.Pxr24Compression... yes
checking for CompressionType.B44Compression... yes
checking for CompressionType.B44ACompression... yes
checking for DistortImageMethod.BarrelDistortion... yes
checking for DistortImageMethod.BarrelInverseDistortion... yes
checking for DistortImageMethod.BilinearForwardDistortion... yes
checking for DistortImageMethod.BilinearReverseDistortion... yes
checking for DistortImageMethod.DePolarDistortion... yes
checking for DistortImageMethod.PolarDistortion... yes
checking for DistortImageMethod.PolynomialDistortion... yes
checking for DistortImageMethod.ShepardsDistortion... yes
checking for DitherMethod.NoDitherMethod... yes
checking for FilterTypes.KaiserFilter... yes
checking for FilterTypes.WelshFilter... yes
checking for FilterTypes.ParzenFilter... yes
checking for FilterTypes.LagrangeFilter... yes
checking for FilterTypes.BohmanFilter... yes
checking for FilterTypes.BartlettFilter... yes
checking for FilterTypes.SentinelFilter... yes
checking for MagickEvaluateOperator.PowEvaluateOperator... yes
checking for MagickEvaluateOperator.LogEvaluateOperator... yes
checking for MagickEvaluateOperator.ThresholdEvaluateOperator... yes
checking for MagickEvaluateOperator.ThresholdBlackEvaluateOperator... yes
checking for MagickEvaluateOperator.ThresholdWhiteEvaluateOperator... yes
checking for MagickEvaluateOperator.GaussianNoiseEvaluateOperator... yes
checking for MagickEvaluateOperator.ImpulseNoiseEvaluateOperator... yes
checking for MagickEvaluateOperator.LaplacianNoiseEvaluateOperator... yes
checking for MagickEvaluateOperator.MultiplicativeNoiseEvaluateOperator... yes
checking for MagickEvaluateOperator.PoissonNoiseEvaluateOperator... yes
checking for MagickEvaluateOperator.UniformNoiseEvaluateOperator... yes
checking for MagickEvaluateOperator.CosineEvaluateOperator... yes
checking for MagickEvaluateOperator.SineEvaluateOperator... yes
checking for MagickEvaluateOperator.AddModulusEvaluateOperator... yes
checking for MagickFunction.ArcsinFunction... yes
checking for MagickFunction.ArctanFunction... yes
checking for MagickFunction.PolynomialFunction... yes
checking for MagickFunction.SinusoidFunction... yes
checking for ImageLayerMethod.FlattenLayer... yes
checking for ImageLayerMethod.MergeLayer... yes
checking for ImageLayerMethod.MosaicLayer... yes
checking for ImageLayerMethod.TrimBoundsLayer... yes
checking for VirtualPixelMethod.HorizontalTileVirtualPixelMethod... yes
checking for VirtualPixelMethod.VerticalTileVirtualPixelMethod... yes
checking for VirtualPixelMethod.HorizontalTileEdgeVirtualPixelMethod... yes
checking for VirtualPixelMethod.VerticalTileEdgeVirtualPixelMethod... yes
checking for VirtualPixelMethod.CheckerTileVirtualPixelMethod... yes
checking for ruby/io.h... yes
checking for rb_frame_this_func() in ruby.h,ruby/io.h... yes
creating extconf.h
creating Makefile

======================================================================
Sat 22Dec12 21:51:19
This installation of RMagick 2.13.1 is configured for
Ruby 1.9.3 (x86_64-darwin12.2.0) and ImageMagick 6.7.7 Q16 
======================================================================

make
compiling rmagick.c
compiling rmdraw.c
compiling rmenum.c
rmenum.c:450:13: warning: 4 enumeration values not handled in switch: 'DivideSrcCompositeOp', 'MinusSrcCompositeOp', 'DarkenIntensityCompositeOp'... [-Wswitch]
    switch (op)
            ^
rmenum.c:565:13: warning: enumeration values 'LZMACompression', 'JBIG1Compression', and 'JBIG2Compression' not handled in switch [-Wswitch]
    switch (ct)
            ^
rmenum.c:674:12: warning: 7 enumeration values not handled in switch: 'SincFastFilter', 'LanczosSharpFilter', 'Lanczos2Filter'... [-Wswitch]
    switch(type)
           ^
rmenum.c:922:12: warning: 5 enumeration values not handled in switch: 'Average9InterpolatePixel', 'Average16InterpolatePixel', 'BlendInterpolatePixel'... [-Wswitch]
    switch(interpolate)
           ^
4 warnings generated.
compiling rmfill.c
compiling rmilist.c
rmilist.c:448:12: warning: 'MapImages' is deprecated [-Wdeprecated-declarations]
    (void) MapImages(new_images, map, dither);
           ^
/usr/local/Cellar/imagemagick/6.7.7-6/include/ImageMagick/magick/deprecate.h:197:3: note: 'MapImages' declared here
  MapImages(Image *,const Image *,const MagickBooleanType)
  ^
1 warning generated.
compiling rmimage.c
rmimage.c:8155:12: warning: 'MapImage' is deprecated [-Wdeprecated-declarations]
    (void) MapImage(new_image, map, dither);
           ^
/usr/local/Cellar/imagemagick/6.7.7-6/include/ImageMagick/magick/deprecate.h:195:3: note: 'MapImage' declared here
  MapImage(Image *,const Image *,const MagickBooleanType)
  ^
rmimage.c:10701:17: warning: 'RecolorImage' is deprecated [-Wdeprecated-declarations]
    new_image = RecolorImage(image, order, matrix, &exception);
                ^
/usr/local/Cellar/imagemagick/6.7.7-6/include/ImageMagick/magick/deprecate.h:139:4: note: 'RecolorImage' declared here
  *RecolorImage(const Image *,const size_t,const double *,ExceptionInfo *)
   ^
2 warnings generated.
compiling rminfo.c
compiling rmmain.c
compiling rmmontage.c
compiling rmpixel.c
compiling rmstruct.c
compiling rmutil.c
rmutil.c:1612:43: warning: format string is not a string literal (potentially insecure) [-Wformat-security]
    rb_raise(Class_FatalImageMagickError, GetLocaleExceptionMessage(severity, reason));
                                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
rmutil.c:1652:20: warning: format string is not a string literal (potentially insecure) [-Wformat-security]
        rb_warning(msg);
                   ^~~
2 warnings generated.
linking shared-object RMagick2.bundle
ld: file not found: /usr/local/lib/libfreetype.6.dylib for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make: *** [RMagick2.bundle] Error 1

Gem files will remain installed in /Users/xxxxx/.rvm/gems/ruby-1.9.3-p327/gems/rmagick-2.13.1 for inspection.
Results logged to /Users/xxxxx/.rvm/gems/ruby-1.9.3-p327/gems/rmagick-2.13.1/ext/RMagick/gem_make.out 
```

The version of ImageMagick is 6.7.7-6.

Could you help me, please, how to get rid of this error and how to finally install RMagick on Mountain Lion?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-04T17:53:57.980

在安装 gem 之前，您是否使用过 brew 来安装“imagemagick”？

这可能会有所帮助：

```
brew update
brew remove imagemagick
brew install imagemagick 
```

其他如果前面的仍然不能解决您的问题：

```
brew install freetype 
```

或者

```
brew unlink freetype && brew link freetype 
```

或者安装[XQuartz](http://xquartz.macosforge.org/landing/)。

或者在 rmagick GitHub 页面上查看[此评论](https://github.com/rmagick/rmagick/issues/60#issuecomment-11541042)。

或者

```
ln -s /opt/X11/lib/libfreetype.6.dylib /usr/local/lib/libfreetype.6.dylib 
```

# python - python中的ECDF没有阶梯函数？

> ID：14006520
> 
> 赞同：2
> 
> 时间：2012-12-22T20:56:57.573
> 
> 标签：python, scipy, statsmodels

我一直在使用 statsmodels.distributions 中的 ECDF（经验累积分布函数）来绘制一些数据的 CDF。但是，ECDF 使用阶跃函数，因此我得到了锯齿状的图。

![在此处输入图像描述](../Images/0ff05d28e6cf5fb5caa47ee2c148b2f6.png)

所以我的问题是：scipy 或 statsmodels 是否有一个没有阶跃函数的 ECDF 烘焙？

顺便说一句，我知道我可以这样做：

```
hist, bin_edges = histogram(b_oz, normed=True)
plot(np.cumsum(hist)) 
```

但我没有得到正确的秤。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-23T01:00:57.783

如果您只想更改绘图，那么您可以让 matplotlib 在观察值之间进行插值。

```
>>> xx = np.random.randn(nobs)
>>> ecdf = sm.distributions.ECDF(xx)
>>> plt.plot(ecdf.x, ecdf.y)
[<matplotlib.lines.Line2D object at 0x07A872D0>]
>>> plt.show() 
```

或对原始数据进行排序并绘图

```
>>> xx.sort()
>>> plt.plot(xx, ecdf(xx))
[<matplotlib.lines.Line2D object at 0x07A87090>]
>>> plt.show() 
```

这与直接绘制它相同

```
>>> a=0; plt.plot(xx, np.arange(1.,nobs+1)/(nobs+a))
[<matplotlib.lines.Line2D object at 0x07A87D30>]
>>> plt.show() 
```

注意：根据您希望 ecdf 在边界处的行为方式以及居中方式，常用的“绘图位置”有不同的规范化，`a`例如我添加的参数 a=1 是常见的选择。

作为使用经验 cdf 的替代方法，您还可以使用插值或平滑 ecdf 或直方图，或内核密度估计。

# android - Android加载维基百科移动站点不同（片段内的webview）

> ID：14006522
> 
> 赞同：0
> 
> 时间：2012-12-22T20:57:15.663
> 
> 标签：android, mobile, webview, fragment, wikipedia

我正在尝试在位于片段内的 web 视图中加载 Wikipedia 链接。

一个示例站点站点是；[http://en.m.wikipedia.org/wiki/Spanish_dollar](http://en.m.wikipedia.org/wiki/Spanish_dollar)

如果我将它加载到我的移动浏览器甚至桌面上，我会得到所有部分都折叠的完整移动版本。但是，如果我将它加载到片段内的 web 视图中，它不会显示正确的“完整”移动维基百科网站。所有部分都扩展了，网站底部看起来不同。另外，左侧的菜单按钮占据了我的整个webview，而在普通浏览器中，它占据了60-70%或更少，所以你可以点击剩下的那一边返回！

我正在将 Web 视图动态添加到片段内的线性布局中，如下所示；

```
 WebView mWebview = new WebView(mContext);

    mWebview.setLayoutParams(new ViewGroup.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT, ViewGroup.LayoutParams.MATCH_PARENT));

    mWebview.setWebViewClient(new WebViewClient() {
      public void onReceivedError(WebView view, int    errorCode, String description, String failingUrl) {
         Toast.makeText(mContext, description, Toast.LENGTH_SHORT).show();}
    });

    mWebview.loadUrl("http://en.m.wikipedia.org/wiki/Spanish_Dollar");

    layout.addView(mWebview); 
```

任何帮助或提示将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:12:22.573

这可能是因为默认情况下禁用了 JavaScript。您可以通过调用来启用它[`WebSettings.setJavaScriptEnabled(boolean)`](http://developer.android.com/reference/android/webkit/WebSettings.html#setJavaScriptEnabled%28boolean%29)。

# java - 稍后如何在循环中使用变量

> ID：14006526
> 
> 赞同：0
> 
> 时间：2012-12-22T20:57:45.537
> 
> 标签：java

我不确定这是否可行，而且我很新，所以希望你们中的一些人能对此有所了解，我有一个函数可以读取 txt 文件的所有内容，然后在终端窗口中打印出来，但是我想成为能够将文本文件的数据存储在变量中，以便我以后可以使用它，这可能吗

继承人的代码片段：

```
String mText; 
        while((mText = br.readLine()) != null) { 
            //Displays the contents of the file in terminal
            System.out.println(mText); 
        } 
```

因为据我所知，一旦循环完成变量 mText 在这种情况下的内容被删除？

好的，因为在下面的代码中，我想打印到打印机，该文件的内容但是当我运行它时，我可以很好地显示文件的内容，但它从来没有出现打印机选项框，我想这将是问题所在，它看起来像是我的代码中的其他内容：

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.print.*;
import java.text.*;
import java.io.*;
import javax.swing.*;

public class PrintText implements Printable {
    private static String mText;

    // Below the code will allow the user to select a file and then print out the contents of the file
    public static void main(String[] args) throws IOException {

        //selects the file
        JFileChooser chooser = new JFileChooser();
        chooser.showOpenDialog(null);
        File file = chooser.getSelectedFile();
        String filename = file.getName();
        //System.out.println("You have selected: " + filename);  testing to see if file seleected was right
        String path = file.getAbsolutePath();

        //Reads contents of file into terminal 
        //FileReader fr = new FileReader("filename");
        // FileReader fr = new FileReader("D:/Documents/" + "filename")); 

        FileReader fr = new FileReader(path); 
        BufferedReader br = new BufferedReader(fr); 
        String mText; 
        while((mText = br.readLine()) != null) { 
            //Displays the contents of the file in terminal
            System.out.println(mText); 
        } 
        //fr.close(); 
    } 

    //private static final String mText = 
    //    "This is a test to see if this text will be printed "; //This works perfectly fine

    AttributedString mStyledText = new AttributedString(mText);

    /**
     * Print a single page containing some sample text.
     */
    static public void printer(String args[]) {
        /* Get the representation of the current printer and 
         * the current print job.
         */
        PrinterJob printerJob = PrinterJob.getPrinterJob();
        /* Build a book containing pairs of page painters (Printables)
         * and PageFormats. This example has a single page containing
         * text.
         */
        Book book = new Book();
        book.append(new PrintText(), new PageFormat());
        /* Set the object to be printed (the Book) into the PrinterJob.
         * Doing this before bringing up the print dialog allows the
         * print dialog to correctly display the page range to be printed
         * and to dissallow any print settings not appropriate for the
         * pages to be printed.
         */
        printerJob.setPageable(book);
        /* Show the print dialog to the user. This is an optional step
         * and need not be done if the application wants to perform
         * 'quiet' printing. If the user cancels the print dialog then false
         * is returned. If true is returned we go ahead and print.
         */
        boolean doPrint = printerJob.printDialog();
        if (doPrint) {
            try {
                printerJob.print();
            } catch (PrinterException exception) {
                System.err.println("Printing error: " + exception);
            }
        }
    }

    /**
     * Print a page of text.
     */
    public int print(Graphics g, PageFormat format, int pageIndex) {
        /* We'll assume that Jav2D is available.
         */
        Graphics2D g2d = (Graphics2D) g;
        /* Move the origin from the corner of the Paper to the corner
         * of the imageable area.
         */
        g2d.translate(format.getImageableX(), format.getImageableY());
        /* Set the text color.
         */
        g2d.setPaint(Color.black);
        /* Use a LineBreakMeasurer instance to break our text into
         * lines that fit the imageable area of the page.
         */
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {
            TextLayout layout = measurer.nextLayout(wrappingWidth);
            pen.y += layout.getAscent();
            float dx = layout.isLeftToRight()? 0 : (wrappingWidth - layout.getAdvance());
            layout.draw(g2d, pen.x + dx, pen.y);
            pen.y += layout.getDescent() + layout.getLeading();
        }
        return Printable.PAGE_EXISTS;
    }
} 
```

这是我所做的原始代码，它会打印出程序中预先输入的文本，我试图像上面那样添加文件阅读器，现在它不起作用

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.print.*;
import java.text.*;
import java.io.*;
import javax.swing.*;
import java.util.List;
import java.util.ArrayList;

public class PrintText implements Printable {
   /** private static String mText;

    // Below the code will allow the user to select a file and then print out the contents of the file
    public static void main(String[] args) throws IOException {

        //selects the file
        JFileChooser chooser = new JFileChooser();
        chooser.showOpenDialog(null);
        File file = chooser.getSelectedFile();
        String filename = file.getName();
        //System.out.println("You have selected: " + filename);  testing to see if file seleected was right
        String path = file.getAbsolutePath();

        //Reads contents of file into terminal 
        //FileReader fr = new FileReader("filename");
        // FileReader fr = new FileReader("D:/Documents/" + "filename")); 

        FileReader fr = new FileReader(path); 
        BufferedReader br = new BufferedReader(fr); 
        List<String> list = new ArrayList<String>();
        while((mText = br.readLine()) != null) { 
            //Displays the contents of the file in terminal
            System.out.println(mText);
            list.add(mText); 
        } 
        //fr.close(); 
    } 
*/
    private static final String mText = 
        "This is a test to see if this text will be printed "; //This works perfectly fine

    AttributedString mStyledText = new AttributedString(mText);

    /**
     * Print a single page containing some sample text.
     */
    static public void main(String args[]) {
        /* Get the representation of the current printer and 
         * the current print job.
         */
        PrinterJob printerJob = PrinterJob.getPrinterJob();
        /* Build a book containing pairs of page painters (Printables)
         * and PageFormats. This example has a single page containing
         * text.
         */
        Book book = new Book();
        book.append(new PrintText(), new PageFormat());
        /* Set the object to be printed (the Book) into the PrinterJob.
         * Doing this before bringing up the print dialog allows the
         * print dialog to correctly display the page range to be printed
         * and to dissallow any print settings not appropriate for the
         * pages to be printed.
         */
        printerJob.setPageable(book);
        /* Show the print dialog to the user. This is an optional step
         * and need not be done if the application wants to perform
         * 'quiet' printing. If the user cancels the print dialog then false
         * is returned. If true is returned we go ahead and print.
         */
        boolean doPrint = printerJob.printDialog();
        if (doPrint) {
            try {
                printerJob.print();
            } catch (PrinterException exception) {
                System.err.println("Printing error: " + exception);
            }
        }
    }

    /**
     * Print a page of text.
     */
    public int print(Graphics g, PageFormat format, int pageIndex) {
        /* We'll assume that Jav2D is available.
         */
        Graphics2D g2d = (Graphics2D) g;
        /* Move the origin from the corner of the Paper to the corner
         * of the imageable area.
         */
        g2d.translate(format.getImageableX(), format.getImageableY());
        /* Set the text color.
         */
        g2d.setPaint(Color.black);
        /* Use a LineBreakMeasurer instance to break our text into
         * lines that fit the imageable area of the page.
         */
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {
            TextLayout layout = measurer.nextLayout(wrappingWidth);
            pen.y += layout.getAscent();
            float dx = layout.isLeftToRight()? 0 : (wrappingWidth - layout.getAdvance());
            layout.draw(g2d, pen.x + dx, pen.y);
            pen.y += layout.getDescent() + layout.getLeading();
        }
        return Printable.PAGE_EXISTS;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:00:37.207

> 据我了解，一旦循环完成变量 mText 在这种情况下的内容被删除？

如果您从文本文件中读取多行，则所有先前的写入都将被以下写入覆盖。因此，您的变量`mText`将仅包含读取的最后一行。

如果您希望在循环结束后可以访问所有读取的行，则可以将这些行存储在某个集合中。

`List<String>`理想情况下，您可以在这种情况下创建一个，并将您的数据存储在其中：-

```
List<String> list = new ArrayList<String>();
while((mText = br.readLine()) != null) { 
        //Displays the contents of the file in terminal
        System.out.println(mText);
        list.add(mText); 
} 
```

现在在 while 循环之外，您可以从列表中访问您的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T20:59:26.933

不。变量是在方法的范围内定义的，因此在声明并赋予值后，它的值在方法中的任何位置都可用。

但是，您拥有的代码可能没有为变量分配值，因为 readline() 可能会抛出 IOException，因此在此循环之后您将无法使用该变量 - 您将获得一个“可能未分配的变量”编译错误。要解决此问题，请在声明变量时对其进行初始化：

```
String mText = null; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T21:05:15.343

如果要保留所有行，则必须以这种方式存储它们：

```
 StringBuilder sb= new StringBuilder();
    String mText;
    while ((mText = br.readLine()) != null) {
        //Displays the contents of the file in terminal
        System.out.println(mText);
        sb.append(mText).append('\n');
    }
    // now the whole content of the BufferedReader is stored in sb. 
```

# .net - 如何在 .NET 数学类中编写带有 sin 的方程？

> ID：14006529
> 
> 赞同：0
> 
> 时间：2012-12-22T20:58:05.003
> 
> 标签：.net, math

我知道如何使用计算器来解决这个问题，但是如何使用 .NET 中的 Math 类来解决这个问题？

```
(15/sin(v))=(10/sin(37)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:02:00.593

`Math`不提供*求解器*；它只是为常见的数学运算提供了一些工具。您将不得不手动*解决*它，或者罚款一个求解器库。

但有趣的是：

```
var v = 180 * Math.Asin(15 * Math.Sin(37 * Math.PI / 180) / 10) / Math.PI;
  // ~= 64.518 degrees 
```

假设您希望以度为单位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:02:32.870

如果我没看错的话，这只不过是简单的代数。

```
15/sin(v) = 10/sin(37); 
```

我假设 37 表示“度”。你会想要*弧度*。

两边乘以 sin(37)*sin(v)/10：

```
15*sin(37)/10 = sin(v) 
```

求解 v：

```
v = inverse sin(1.5*sin(37)) 
```

就个人而言，我发现缺乏关于 SO 的数学知识令人震惊。它通常甚至不是高级数学。人们对简单的高中代数有疑问。忘记微积分！没有这样的基本技能，你怎么能成为一个称职的程序员？

# php - 如何计算每一行的连接中的所有实例？

> ID：14006532
> 
> 赞同：5
> 
> 时间：2012-12-22T20:58:24.727
> 
> 标签：php, mysql, sql, database, join

我有以下方案：

```
CREATE TABLE IF NOT EXISTS `answers` (
`id` bigint(20) unsigned NOT NULL,
`answer` varchar(200) NOT NULL,
`username` varchar(15) NOT NULL,
`date` datetime NOT NULL,
PRIMARY KEY (`id`,`username`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

INSERT INTO `answers` (`id`, `answer`, `username`, `date`) VALUES
(1, 'gfdsf', 'guy', '2012-12-22 00:00:00'),
(4, 'gfdddsfs', 'maricela', '2012-12-22 00:00:00'),
(4, 'gfddsfs', 'mikha', '2012-12-22 00:00:00'),
(4, 'gfdsfs', 'guy', '2012-12-22 00:00:00');

CREATE TABLE IF NOT EXISTS `questions` (
`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
`asker_username` varchar(15) NOT NULL,
`target_username` varchar(15) NOT NULL,
`question` varchar(200) NOT NULL,
`hide` enum('y','n') NOT NULL DEFAULT 'n',
`date` datetime NOT NULL,
PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=5 ;

INSERT INTO `questions` (`id`, `asker_username`, `target_username`, `question`, `date`) VALUES
(1, 'mikha', 'guy', 'testo festo', '2012-12-22 00:00:00'),
(2, 'mikha', 'guy', 'saaaaaaaar', '2012-12-22 00:00:00'),
(3, 'sys.tem', 'every.one', 'test g1', '2012-12-06 00:00:00'),
(4, 'sys.tem', 'every.one', 'test g2', '2012-12-06 00:00:00'); 
```

我使用以下查询：

```
 SELECT        
   questions.id AS questionid,
   COUNT(answers.username) AS count_everyone,
   answers.username  
   FROM questions
   LEFT JOIN answers ON questions.id = answers.id
   GROUP BY questions.id,answers.username 
```

问题出在`COUNT(answers.username`. 我想计算每个问题的答案，但查询显示计数为 1。例如，问题 ID 4 被回答 3 次，但`COUNT(answers.username)`显示为 1 而不是 3。

这是预期的结果：

```
 questionid count_everyone  username
               1         1            guy
               2         0            null
               3         0            null
               4         3             guy
               4         3           maricela
               4         3             mikha 
```

这是我实际得到的结果：

```
 questionid count_everyone  username
               1         1            guy
               2         0            null
               3         0            null
               4         1             guy
               4         1           maricela
               4         1             mikha 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T21:28:51.433

```
select q.id, coalesce(j.AnswerCount, 0) as AnswerCount, a.username

from questions q

left outer join

(select id as Qid, count(answer) as AnswerCount
from answers
group by id) j

on q.id = j.Qid

left outer join 
answers a on q.id = a.id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T21:03:39.233

要获得正确的计数，您应该只按问题 ID 分组，而不是用户名：

```
SELECT        
    questions.id AS questionid,
    COUNT(answers.username) AS count_everyone
FROM questions
LEFT JOIN answers ON questions.id = answers.id
GROUP BY questions.id 
```

如果您*必须*在同一查询中获取用户名，请使用连接：

```
SELECT questionid, count_everyone, username
FROM
(
    SELECT        
        questions.id AS questionid,
        COUNT(answers.username) AS count_everyone
    FROM questions
    LEFT JOIN answers ON questions.id = answers.id
    GROUP BY questions.id
) T1
LEFT JOIN answers ON T1.questionid = answers.id 
```

[sqlfiddle](http://sqlfiddle.com/#!2/73ff3/11)

或`GROUP_CONCAT`：

```
SELECT        
    questions.id AS questionid,
    COUNT(answers.username) AS count_everyone,
    GROUP_CONCAT(answers.username) AS usernames
FROM questions
LEFT JOIN answers ON questions.id = answers.id
GROUP BY questions.id 
```

[sqlfiddle](http://sqlfiddle.com/#!2/73ff3/14)

或相关子查询：

```
SELECT        
    questions.id AS questionid,
    (SELECT COUNT(*) FROM answers WHERE questions.id = answers.id) AS count_everyone,
    answers.username
FROM questions
LEFT JOIN answers ON questions.id = answers.id 
```

[sqlfiddle](http://sqlfiddle.com/#!2/73ff3/16)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T21:16:03.367

**编辑**

我想你在找这个，它会显示所有的问题 id 并计算所有的答案，并显示所有的用户名。

[**演示 SLQFIDDLE**](http://sqlfiddle.com/#!2/73ff3/51)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T22:17:17.700

这个怎么样：

```
SELECT        
  questions.id AS questionid,
  COUNT(answers.username) AS count_everyone,
  GROUP_CONCAT(answers.username) users
FROM questions
LEFT JOIN answers ON questions.id = answers.id
WHERE questions.target_username = 'every.one'
GROUP BY questions.id 
```

[小提琴](http://www.sqlfiddle.com/#!2/73ff3/38)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T21:02:58.747

据我所知，你应该改变这个：

```
COUNT(answers.username) AS count_everyone, 
```

至：

```
COUNT(answers.id) AS count_everyone, 
```

因为您实际上想计算具有相同 ID 的答案的数量...

# c# - SignalR 用于大用户群的聊天

> ID：14006538
> 
> 赞同：4
> 
> 时间：2012-12-22T20:40:21.043
> 
> 标签：c#, ajax, asp.net-mvc, signalr

我有一个 ASP.NET MVC3 应用程序。

如果我的应用程序有大量用户——比如说 100,000——假设，如果所有用户都在互相交谈并且我使用 SignalR，那么会有 100,000 个长轮询连接吗？这些会导致某种拒绝服务吗？

我应该改用 AJAX HTTP 吗？或者 SignalR 是否足够聪明，可以在一段时间内没有发现任何活动时释放与资源池的连接？

什么时候推荐使用 signalR 进行聊天而不是 AJAX？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T22:24:52.470

您可以相当轻松地禁用 Windows 服务器上的所有 DoS 攻击保护。但是，这不一定能解决您的问题。100,000 个连接将需要多个服务器来完成类似的操作。

您的第一个限制是每个 IP 地址您只有大约 65,000 个可能的 tcp 端口来服务连接（65,535 个但保留的端口更少，等等）。因此，您要么需要具有多个 IP 地址的大型服务器（系统/应用程序中可能不可靠且存在单点故障），要么需要在某种负载均衡器后面的多个服务器。

同样对于长轮询，您会看到连接的一致“翻转”，因为每个长轮询连接结束并开始新的连接。TCP 端口不会立即重用，而是最快的可配置[TCP 定时等待延迟](http://technet.microsoft.com/en-us/library/cc938217.aspx)为 30 秒。因此，即使是 65,000 个连接也是不现实的，我将一半用于端口重用。然后，您需要考虑到达该服务器的网页、rest api 或其他静态资源的任何其他 http 请求。然后考虑处理器/内存必须为保存/格式化数据进行的任何其他处理。所以我会进一步减少一半。我会说每台服务器有 15,000 个客户端是一个现实的最大值。因此，对于 100,000 个用户，您在负载平衡集群中可能至少需要 7 台服务器。

最后我检查了 SignalR 在这样的多服务器环境中不起作用。同样，AJAX 或任何其他“频繁刷新”方法将在可用 tcp 端口/套接字等的数量方面受到类似的物理限制。您不能在一台服务器上以高频率的 http 请求服务 100,000 个客户端。

我已经使用 Amazon EC2 上的多个服务器使用[WebSync for ASP.net](http://www.frozenmountain.com/products/websync)对此类大规模负载进行了大量测试。我在 FrozenMountain 工作，去年我的工作之一是在 Amazon EC2 Cloud 上进行一些多服务器负载平衡测试。亚马逊云服务提供了一个很好的粘性负载均衡器，并且可以轻松复制您的服务器以进行测试。在“实验室条件”（专用服务器不做其他事情）中，我们可以在[亚马逊的“大型实例”](http://aws.amazon.com/ec2/instance-types/)上超过 20k 个客户端，这是一个具有 7.5gb 内存的四核服务器。

Its also worth pointing out that with the latest Server/IIS/Websync you get WebSockets support which will help reduce the port turnover and reuse as each client can maintain a single persistent socket connection to the web server. That can potentially increase your client count per server. So you might be able to go from a 7 server cluster down to maybe 4-5 servers depending on the adoption rate of websocket compatible browsers/clients. (Web browser based JavaScript clients won't have a high adoption rate, native devices like iPhones or Android devices will all have websocket support, so you'll see the full benefits right away). WebSync will fail back from WebSockets to Long Polling if the client doesn't support web sockets.

# joomla - 在 Joomla 中分页

> ID：14006541
> 
> 赞同：1
> 
> 时间：2012-12-22T20:59:49.697
> 
> 标签：joomla, pagination, paging

我是 joomla 的新手。我正在尝试创建一个显示数据库中数据的网页（我正在使用带有 Sourcerer 插件的 php）。数据包含带有图像的用户资料。现在我想每页显示 5 个用户配置文件（使用分页）。这只是我想要分页的一个菜单（页面）。我为此浏览了许多链接，但找不到确切的解决方案。请帮助我。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T15:50:28.367

在构造函数上方和类定义下方放置此代码

```
class ComUserModel extends JModel
{

    var $_pagination = null;

    function __construct() 
    { 
```

在您正在使用的模型的构造函数中，假设它是用户模型

```
function __construct() 
{
    $this->_app =& JFactory::getApplication();
    parent::__construct();

    // Get pagination request variables
    $limit = $this->_app->getUserStateFromRequest(OPTIOIN_NAME.'.user.limit', 'limit', $this->_app->getCfg('list_limit'), 'int');
    $limitstart = $this->_app->getUserStateFromRequest(OPTIOIN_NAME.'.user.limitstart', 'limitstart', 0, 'int');

    // In case limit has been changed, adjust it
    $limitstart = ($limit != 0 ? (floor($limitstart / $limit) * $limit) : 0);

    // Set States
    $this->setState(OPTIOIN_NAME.'.user.limit', $limit);
    $this->setState(OPTIOIN_NAME.'.user.limitstart', $limitstart);
} 
```

将以下功能添加到模型中

```
function pagination()
{
    if($this->_pagination == NULL)
        $this->_pagination = new JPagination(20, $this->getState(OPTIOIN_NAME.'.user.limitstart'), $this->getState(OPTIOIN_NAME.'.user.limit'));
    return $this->_pagination;
} 
```

当您检索数据时，

```
function getUsers()
{
    // Set the Limits and Filters
    $limit = $this->getState(OPTIOIN_NAME.'.user.limit');
    $limitstart = $this->getState(OPTIOIN_NAME.'.user.limitstart');

    //get db             
    $db = JFactory::getDBO();
    $count_query = 'count(*)';
    $select_query = '*';
    $from_query = $db->nameQuote(TABLE_PREFIX.'user_table');               

    //build the query
    $query = $db->getQuery(true);
    $query->select($select_query);
    $query->from($from_query); 
    $query->order($db->nameQuote('id').' desc');       
    $db->setQuery($query);               

    //build count query
    $cquery = $db->getQuery(true);
    $cquery->select($count_query);
    $cquery->from($from_query); 
    $cquery->order($db->nameQuote('id').' desc');       
    $db->setQuery($cquery);               
    $total = $db->loadResult();

    if ($db->getErrorNum())
    {
        $this->_app->enqueueMessage($db->stderr(), 'error');
        return false;
    }        
    //setup the pagination
    $this->_pagination  = new JPagination($total, $limitstart, $limit);     

    //get the data within limits
    $data       = $this->_getList($query, $limitstart, $limit);        

    if ($db->getErrorNum())
    {
        $this->_app->enqueueMessage($db->stderr(), 'error');
        return false;
    }

    return $data; 
} 
```

在控制器中

```
function getalluser()
{   

    $model      = $this->getModel('user');        
    $data       = $model->getUsers();  
    $pagination = $model->pagination();

    $view = $this->getView('userlist', 'html');
    $view->assignRef('data',$data);
    $view->assignRef('pagination', $pagination);        
    $view->display();
} 
```

在视图中将代码放在您想要分页的位置

```
<?php echo $this->pagination->getListFooter(); ?> 
```

如果您有任何问题，请告诉我

# phantomjs - 使用 PhantomJs 获取 Iron.io worker 的输出

> ID：14006544
> 
> 赞同：1
> 
> 时间：2012-12-22T21:00:34.100
> 
> 标签：phantomjs, iron.io

我正在编写这个应用程序，它使用来自网站的一些信息，并且我正在使用 PhantomJs 来提取这些信息。现在我希望用户能够在他们的系统中不需要 PhantomJs 的情况下运行我的应用程序。这样它就更像是一个服务调用。

我遵循了以下指南：[http ://ariya.ofilabs.com/2012/07/cloud-phantomjs-with-ironworker.html](http://ariya.ofilabs.com/2012/07/cloud-phantomjs-with-ironworker.html)

为了让 PhantomJs 工作并获取我需要的某个站点的信息，现在我可以排队一个工作人员并使用 Iron.io 的 Web 界面在日志中获取结果。

我想知道是否有办法以编程方式获取执行结果。我查看了[API](http://dev.iron.io/worker/reference/api/)，但我需要进行身份验证，还需要提供不同的任务 ID（我不知道如何获取）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T21:36:34.407

队列任务 => 获得`task_id`作为操作的结果。

但是有很多不同的方式来获取结果：通过 api 读取任务日志（你需要 project_id、token、task_id），将数据存储到 Amazon S3，将信息推送到某种队列，触摸自己的 api，将信息发送到 webhook，写入信息到数据库等

# php - 在我的 php 框架中进行正确的调度管理

> ID：14006560
> 
> 赞同：0
> 
> 时间：2012-12-22T21:03:11.947
> 
> 标签：php, frameworks, dispatcher

我正在尝试创建一个小框架。我目前正忙于我的调度程序对象，我无法从逻辑上制定关于调度程序应如何绑定控制器并请求视图/操作的最佳实践。

到目前为止一切正常，我可以创建带有动作的页面控制器并执行 echo "test123"；完美返回，我只是对如何构建视图以及如何让视图访问控制器中分配的变量感到有点困惑。我添加了一些评论，我觉得我可能会采取错误的方法。

一些让我烦恼的项目： - 我不太认为我在 require_once() 和在 dispatch() 方法中创建对象实例方面采取了正确的方法，但我不确定哪个其他选项会起作用。- 我试图确保用户通过请求的 url、引用的 url 或最后的默认控制器/操作获得某种输出，以便我可以在网站的模板中显示简化的错误消息，但我也觉得我可能在重复工作，有什么想法吗？- 我看不到如何绑定视图控制器（它将输出 HTML）。我将在哪里分配控制器中生成的变量或值？

注意事项：

*   调度程序不扩展任何其他类。
*   选定的页面控制器将扩展主控制器，而主控制器反过来又扩展到核心控制器。我认为核心控制器将捆绑我想在应用程序之间共享的所有其他类，如数据库类等，但我不确定这是否有意义。

任何关于如何改进我的调度员的想法将不胜感激！

```
 public function dispatch($user_request) {
    // Receive the user requested controller/action in an array:
    $this->requested_array = $user_request;
    $request_validated = false;
    // Ensure the master controller is available or break gracefully:
    if(!include(CONTROLLERS_DIR."master".CONTROLLER_SUFFIX.".php")) {
        output_message("Unable to load the master controller.", true);
        return false;
    }

    // Verify if the requested controller is available and that it is indeed a class:
    if(file_exists(CONTROLLERS_DIR.$this->requested_array['controller'].CONTROLLER_SUFFIX.".php")) {
        require_once(CONTROLLERS_DIR.$this->requested_array['controller'].CONTROLLER_SUFFIX.".php");
        if(class_exists($this->requested_array['controller'])) {
            // Create object of requested controller:
            $requested_controller_object = new $this->requested_array['controller']();
            // Verify that the requested action/method exists in the controller:
            if(method_exists($requested_controller_object, $this->requested_array['action'])) {
                $request_validated = true;
            }
        }

    } else {
        $this->dispatcher_errors[] = "Unable to locate the requested controller.";
    }

    if($request_validated != true) {
        // Rollback will check if the page has a successful referrer (same application) and assign the previous pages controller/action properties to this request:
        if($this->rollback() != true) {
            // Check if the default controller exists and if it is a class:
            if(file_exists(CONTROLLERS_DIR.$this->default_request_array['controller'].CONTROLLER_SUFFIX.".php")) {
                require_once(CONTROLLERS_DIR.$this->default_request_array['controller'].CONTROLLER_SUFFIX.".php");
                if(class_exists($this->default_request_array['controller'])) {
                    $requested_controller_object = new $this->default_request_array['controller']();
                    if(!method_exists($requested_controller_object, $this->default_request_array['action'])) {
                        // Verify if the default action exists in the default controller:
                        output_message("Unable to load the default action.", true);
                        return false;
                    }
                }
            } else {
                output_message("Unable to load the default controller.", true);
                return false;
            }
        } else {
            require_once(CONTROLLERS_DIR.$this->requested_array['controller'].CONTROLLER_SUFFIX.".php");
            $requested_controller_object = new $this->requested_array['controller']();
        }   
    // All systems go, create session variables to save this as the referring url:
    $this->process_referring_url();
    $requested_controller_object->{$this->requested_array['action']}();
    /*
     *  Layout happens here, but how? Should I extend my views class with dispatcher or do I create a views object? 
     * If so, how do I make sure my views will be able to get access to assigned variables from my controllers? 
     * Also, a method like $this->assign("variable_name",$value), in which class do I need to add this method as
     * it feels out of place in the dispatcher and the controller does not have access to the views object.
     */

    }
    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T04:25:44.897

不久前，我开始为自己的教育目的构建一个小型 php 框架。它最终受到 zend 框架的严重影响。也许看看一些已建立的想法框架。我对您发布的内容的 2c：

> 我不太认为我对 require_once() 采取了正确的方法并在 dispatch() 方法中创建对象实例

您可以使用 spl_autoload_register 注册一个自动加载函数来自动加载您的类并避免在调度程序中显式调用 require 。我认为在调度程序中实例化你的对象很好。

> 我看不到如何绑定视图控制器（它将输出 HTML）。我将在哪里分配控制器中生成的变量或值？

我的控制器的构造函数接受了一个包含所有 http 请求变量的请求对象、一个用于填充响应的操作的响应对象（无论是 HTML、Json 等）以及一个包含会话信息和任何其他配置数据的会话对象. 如果您有一个单独的视图控制器或需要多个控制器，您可以将控制器排队并在一个循环中分派，将带有所有必需变量的公共请求对象传递给它们。尽管每个请求只有一个控制器，但我保持简单。

> 任何关于如何改进我的调度员的想法将不胜感激！

您可以考虑使用在调度之前检查的控制器/操作白名单和黑名单，以便您更好地控制哪些请求得到满足。

# smalltalk - 如何在 Pharo 中安装 OSProcess？

> ID：14006562
> 
> 赞同：1
> 
> 时间：2012-12-22T21:03:23.863
> 
> 标签：smalltalk, pharo

我想使用 OSProcess 从 Pharo 1.4 在 Linux 和 MacOS 中执行外部程序。我遵循[了其他](https://stackoverflow.com/questions/3067563/using-squeak-from-a-shell)安装后说明，但是当我评估时

```
(PipeableOSProcess command: 'pwd') output asFileReference 
```

它在 Ubuntu 下挂起虚拟机。对于 OSProcessPlugin 有一个带有指令但执行返回的[Squeak wiki 页面：](http://wiki.squeak.org/squeak/3349)

> OSProcess 不可用或 OSProcess 插件不起作用

从文件浏览器加载[OSProcess sar 文件](http://wiki.squeak.org/squeak/708)会导致语法错误

```
(anArrayOfNullTerminatedStrings collect: [:e | e size])
    inject: offset into: [:p :e | ws nextPut: p. Cannot store into -> p := p + e]. 
```

我是否必须构建自己的虚拟机才能使其正常工作？我需要做什么才能在最新的 Pharo 1.4 下的 Linux 中执行命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T00:13:47.927

使用 Metacello 存储库中可用的 OSProcess 配置：

```
Gofer new
    squeaksource: 'MetacelloRepository';
    package: 'ConfigurationOfOSProcess';
    load.

((Smalltalk at: #ConfigurationOfOSProcess) project version: #stable) load. 
```

使用配置可以避免加载不稳定的版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-20T08:01:55.013

在 Pharo 5.0 或 alpha 6 中，使用目录浏览器，它位于世界菜单的工具菜单中。

[![Pharo 窗口的屏幕截图](../Images/64c3fe57712d4d6880381080960d84dc.png)](https://i.stack.imgur.com/YrGxU.jpg)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T05:34:23.213

来自[Pharo 的书](http://book.pharo-project.org/book/PharoTools/OSProcess/)（阅读它！）

```
Gofer new
    squeaksource3: 'coral';
    package: 'OSProcess'; 
    load. 
```

# objective-c - Cocoa 合并 2 个图像并保存它们

> ID：14006567
> 
> 赞同：1
> 
> 时间：2012-12-22T21:03:59.207
> 
> 标签：objective-c, cocoa

我试图在 Cocoa 中合并 2 个不同的图像，并喜欢将生成的图像保存在我的应用程序中。到目前为止我所做的是：

```
-(void)mergeImage:(NSImage*)target withImage:(NSImage*)source {
    [target lockFocus];

    NSPoint aPoint;
    aPoint.x = 1;
    aPoint.y = 1;
    [source drawAtPoint:aPoint fromRect:NSZeroRect operation:NSCompositeSourceOver fraction:1.0];
    [target unlockFocus];

    NSBitmapImageRep *bmpImageRep = [[NSBitmapImageRep alloc]initWithData:[target TIFFRepresentation]];

    [target addRepresentation:bmpImageRep];

    NSData *data = [bmpImageRep representationUsingType: NSPNGFileType
                                             properties: nil];

    NSURL* aURL = [[NSBundle mainBundle] bundleURL];

    NSString *tmpPathToFile = [[NSString alloc] initWithString:[NSString stringWithFormat:@"%@/tempImage.png", aURL]];
    [data writeToFile:tmpPathToFile atomically:YES];
} 
```

我没有收到任何错误，捆绑包的网址似乎是正确的。并且“数据”包含〜2,9MB 2985448

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:06:33.807

1.  你的应用是沙盒的吗？如果是这样，请确保它确实允许写入您正在写入的目录。
2.  是否已经存在同名文件？`atomically`不会覆盖它。
3.  文件路径是否正确？

* * *

就像[CodaFi](https://stackoverflow.com/users/945847/codafi)提到的那样，您不能写入应用程序包。但是，您可以写入应用程序支持文件夹。这就是它的用途。

# c - gcc 有双 rand 的问题吗？

> ID：14006569
> 
> 赞同：0
> 
> 时间：2012-12-22T21:04:17.040
> 
> 标签：c, gcc, random, double

我想生成双随机值。好的，我输入：

```
random_value = ((double)rand() / (double)RAND_MAX); 
```

用 printf 做一点检查：

```
printf("rand: %f ", random_value); 
```

很好，来自 <0,1> 的值。然后在 printf 之后我写道：

```
random_value *= range; // range have values from <0.05, 0.5>
printf("random_value: %f, range:%f\n", random_value, range); 
```

现在它对我来说开始变得神奇了。FIRST printf (printf("rand: %f ", random_value);) 开始只给我从 <0.8, 1> 的值，其中大多数值接近 ~0.99。当我删除这一行时：

```
random_value *= range; 
```

一切恢复正常。为什么会这样？

代码：

```
double random_value;
double range;
srand(time(NULL));
(...)
random_value = ((double)rand() / (double)RAND_MAX);
printf("rand: %f ", random_value);
random_value*=range;
printf("random_value: %f, range:%f\n", random_value, range); 
```

编译命令：

```
gcc -lm ant.c -o ant -O0 
```

海湾合作委员会：

```
gcc (GCC) 4.7.2 
```

系统：

```
Linux 3.6.10-1-ARCH #1 SMP PREEMPT Tue Dec 11 09:40:17 CET 2012 x86_64 GNU/Linux 
```

没有 random_value *= range 的输出；

```
rand: 0.534583 random_value: 0.534583, range:0.156963
rand: 0.909061 random_value: 0.909061, range:0.156963
rand: 0.144450 random_value: 0.144450, range:0.156963
rand: 0.235249 random_value: 0.235249, range:0.156963
rand: 0.978194 random_value: 0.978194, range:0.156963 
```

random_value *= range 的输出；

```
rand: 0.965320 random_value: 0.570025, range:0.590504
rand: 0.991456 random_value: 0.155622, range:0.156963
rand: 0.957783 random_value: 0.392337, range:0.409631
rand: 0.970194 random_value: 0.122562, range:0.126327
rand: 0.980422 random_value: 0.132694, range:0.135344 
```

# c - C 数组传递

> ID：14006578
> 
> 赞同：0
> 
> 时间：2012-12-22T21:06:22.977
> 
> 标签：c, arrays

我在使用以下代码时遇到问题（我不知道 splitString 函数是否有效，因为我在调用它时遇到了段错误）。代码是：

```
#include <stdio.h>
//
//      Split String
//
int splitString(char** ret,char* instr, char* fence,int max) {
        char* p;
        int count=0;
        char* sinstr;
        char* cp;
        int i=0;

        while(i<max) {
                cp=ret[i];
                p=fence;
                sinstr=instr;
                while(1) {
                        if (*p=='\0') {
                                *cp='\0';
                                instr=sinstr;
                                break;
                        }
                        if (*p==*sinstr) {
                                p++;
                                sinstr++;
                                continue;
                        } else {
                                *cp=*instr;
                                cp++;
                                instr++;
                                break;
                        }
                }
                i++;
        }
        *cp='\0';
        return count;
}
int main (int argc, char* const argv[]) {
        char *strs[128];

        char* in="test.txt";
        splitString(strs,in,".",2);
        printf("fn: %s, ext: %s\n",strs[0],strs[1]); 
} 
```

splitString 函数调用和 printf 都会出现段错误（如果我注释掉对 splitString 的调用，printf 会出现错误）。

我要做的是根据子字符串拆分字符串。该函数应该返回作为第一个参数传递给函数的数组中的子字符串。我知道我忽略了一些非常明显的东西，但我的 C 技能非常生疏。感谢任何指导。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:10:18.283

当然，您正在传入 strs ，并且它没有被初始化，并且 splitstring 假设数组指向实际的字符串，但它将是它的初始值（未定义的行为）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:14:23.020

strs[128] 中的 128 个数组未初始化/分配。

尽管如此，您还是要取消引用它们，然后在它们实际指向的地址写入数据，此时这可能是任何东西。

您可以在拆分函数中动态分配它们，以便它们适合每个子字符串，因为您将指针传递给指向您的函数的那些指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T23:01:21.800

你应该分配你的数组，（在主或函数中）

```
 char *strs[128]; 
```

# c# - SELECT .... WHERE something equals with Chinese characters

> ID：14006579
> 
> 赞同：5
> 
> 时间：2012-12-22T21:06:24.280
> 
> 标签：c#, sql, sql-server, unicode

在 C# 窗口应用程序中，当我这样做时

```
select * from myTable where category = '牛奶' 
```

或者

```
select * from myTable where category = 'baby牛奶' 
```

结果不返回任何行。

但

```
select * from myTable where category = 'baby' 
```

此结果返回一些行。谁能告诉我为什么？

注意：在 myTable 中，某些类别的列有一些带有`牛奶`or的值`baby牛奶`，我在窗口应用程序上显示汉字没有问题。

`牛奶`是汉字。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-22T21:08:08.297

这不是 C# 问题，而是 SQL 问题。

确保传入的 SQL 字符串在 SQL 中被解释为 Unicode 字符串，方法是在它前面加上`N`(SQL Server, [MySQL](http://dev.mysql.com/doc/refman/5.0/en/string-literals.html) )：

```
select * from myTable where category = N'牛奶' 
```

请参阅MSDN 上[的常量 (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms179899.aspx)。

> Unicode 字符串
> 
> Unicode 字符串的格式类似于字符串，但前面有一个 N 标识符（N 代表 SQL-92 标准中的国家语言）。N 前缀必须为大写。例如，'Michél' 是一个字符常量，而 N'Michél' 是一个 Unicode 常量。Unicode 常量被解释为 Unicode 数据，并且不使用代码页进行评估。Unicode 常量确实有一个排序规则。此排序规则主要控制比较和区分大小写。Unicode 常量被分配了当前数据库的默认排序规则，除非 COLLATE 子句用于指定排序规则。Unicode 数据是通过使用每个字符 2 个字节而不是每个字符 1 个字节存储字符数据来存储的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:12:05.223

好吧，把`N`前缀放在你的前面`Chinese texts`是可以接受的。您添加此前缀以对其进行转换。但是，您可能想知道它有一个缺点。

`N`为`nvarchar(...)`列或参数添加前缀的字符串。如果它们用于`varchar(...)`列或参数，则省略它，否则最终会导致**不必要的转换。**

参考：[在脚本中将 N 放在字符串前面有缺点吗？它被认为是“最佳实践”吗？](https://stackoverflow.com/questions/2716189/is-there-a-downside-to-putting-n-in-front-of-strings-in-scripts-is-it-considere)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-20T11:47:35.207

我今天用我的Java-MySQL应用程序遇到了这个问题，我认为它与编程语言无关，所以它可以在问题的情况下很好地工作。更改数据库连接 url 从

*   jdbc:mysql://foo:3308/bar

至

*   jdbc:mysql://foo:3308/bar?characterEncoding=utf8

一切都会好起来的。

# css - 在更改屏幕分辨率时固定 div 和内容

> ID：14006581
> 
> 赞同：1
> 
> 时间：2012-12-22T21:06:28.943
> 
> 标签：css, position, css-float, html

我正在设计一个网站，但面临一个重大问题。问题是该网站在我当前的分辨率下看起来不错。但是，一旦我在浏览器上开始放大或缩小（ctrl++、ctrl + -），页眉和页脚中的内容就会开始移动。

即使页面放大或缩小，我也希望导航项和页脚内容保持其位置。

任何帮助将不胜感激。css 很简单，因此识别问题不会太麻烦。这是网址：http: [//verdiensamen.nl/TestingSoccer/](http://verdiensamen.nl/TestingSoccer/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:16:09.407

设置容器的具体宽度。像这样

```
 #container {
  min-width: 800px;
  margin: 0 auto;
  margin-top: 1%;
  } 
```

它会解决你的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T23:10:47.390

绝对遵循 Syed Mohsin 的建议来指定容器宽度。此外，您可能希望`display:block;`在`#container`元素上应用 a。这将防止盒子的宽度发生变化。

# c# - webrequest getresponse 无效 url 程序挂起

> ID：14006586
> 
> 赞同：0
> 
> 时间：2012-12-22T21:07:16.527
> 
> 标签：c#, webrequest, getresponse

我的网络请求有问题...

当我有一个无效的 url 时，我的程序挂起：/ 我在互联网上读到它与它有关`GetResponse`并且我必须使用`BeginGetResponse`(async) ？

我尝试了各种异步代码，但不起作用......

我有什么（挂起无效的网址）：

```
 WebRequest request;
            request = WebRequest.Create(url);

            WebResponse webResponse = request.GetResponse();

            Stream ReceiveStream = webResponse.GetResponseStream();
            Encoding encode = System.Text.Encoding.GetEncoding("utf-8");
            StreamReader readStream = new StreamReader(ReceiveStream, encode);

            reader = new XmlTextReader(readStream);
            String[] login = new String[1];

            reader.Read();
            reader.ReadStartElement("response");

            reader.ReadStartElement("item");
            login[0] = reader.ReadString();

            reader.ReadEndElement();
            reader.ReadEndElement();

            reader.Close(); 
```

我尝试了什么：

```
 private HttpWebResponse response;
    private void FinishWebRequest(IAsyncResult result)
    {
        response = (result.AsyncState as HttpWebRequest).EndGetResponse(result) as       HttpWebResponse;
    }

    public void Read()
    {

            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
            request.BeginGetResponse(new AsyncCallback(FinishWebRequest), request);

            Stream ReceiveStream = response.GetResponseStream();
            Encoding encode = System.Text.Encoding.GetEncoding("utf-8");
            StreamReader readStream = new StreamReader(ReceiveStream, encode);

            reader = new XmlTextReader(readStream); 
```

但在这里我得到一个`InvalidOperation`例外（即使有一个有效/现有的 url）。我没看到/明白。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:18:12.683

[http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetrequeststream.aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetrequeststream.aspx)

您忘记了一步，您也可以在请求对象上设置超时

一般的想法是您获取请求流，将您的请求“字符串”转换为二进制并将其提供给流。

然后你的响应回调触发你再次抓取流并将其转换回字符串。

此示例中的 postData 是您在发布请求中发送到服务器的内容。

# php - PHP文件在检查几次后不显示任何内容

> ID：14006587
> 
> 赞同：1
> 
> 时间：2012-12-22T21:07:46.073
> 
> 标签：php, for-loop

因此，我被要求使用 html 表单向该数据库插入行。这是表单的代码：

```
<html>
<body>
<div id="header1">
  <h1>Donar d'alta un client</h1>
</div>
<hr>
<form action="alta.php" method="post">
    Numero: <input type="text" name="cnumero" /><br>
    Nom: <input type="text" name="cnom" /><br>
    Adreca: <input type="text" name="cadreca" /><br>
    Codi Postal: <input type="text" name="ccp" /><br>
    Poblacio: <input type="text" name="cpob" /><br>
    Dni: <input type="text" name="cdni" /><br>
    Email: <input type="text" name="cemail" /><br>
    <input type="submit" value="Afegeix" />
</form>
<hr>
</body>
</html> 
```

这是一个正常的形式，没什么特别的，它有效。现在问题来了。在文件 alta.php 中，我有 PHP 代码将所有这些信息插入到这个现有表的一行中。该表称为 CLIENT，它具有所有这些参数和另外 3 个参数，当您添加新行时必须为 NULL。这是 alta.php 的代码：

```
<html>
<body>
<?php
include 'vars.php';
ini_set('display_errors', 1);
error_reporting(E_ALL);

$numero= $_POST['cnumero'];
$nom= $_POST['cnom'];
$adreca= $_POST['cadreca'];
$codi_postal= $_POST['ccp'];
$poblacio= $_POST['cpoblacio'];
$dni= $_POST['cdni'];
$email= $_POST['cemail'];

$conn = oci_connect('u*******', 'u*******', '********');

if (!$conn) {
    $e = oci_error();
    trigger_error(htmlentities($e['No em connectat a la BD'], ENT_QUOTES), E_USER_ERROR);
}

$stid = oci_parse($conn, "INSERT INTO client 
                                    (client_num, client_nom, client_adreca, client_codi_postal, client_poblacio, client_dni, client_email)
                          VALUES
                                    (:client_num, :client_nom, :client_adreca, client_codi_postal, :client_poblacio, :client_dni, :client_email)");

oci_bind_by_name($stid, ":client_num", $numero);
oci_bind_by_name($stid, ":client_nom", $nom);
oci_bind_by_name($stid, ":client_adreca", $adreca);
oci_bind_by_name($stid, ":client_codi_postal", $codi_postal);
oci_bind_by_name($stid, ":client_poblacio", $poblacio);
oci_bind_by_name($stid, ":client_dni", $dni);
oci_bind_by_name($stid, ":client_email", $email);

    $r = oci_execute($stid);

    if ($r) { echo 'Client afegit correctament.'; }
    if (!$r){ echo 'Hi ha hagut un error.'; }

    oci_free_statement($stid);
    oci_close($conn);   
?>
        <br><br><br>
        <div id="tornar">
            <li><a href="index2.html">Tornar a l'inici</a></li>
        </div>
</body>
</html> 
```

问题是我的浏览器一直说存在“内部服务器错误”。所以显然有一段代码不起作用。你们能帮帮我吗？我花了太多时间思考它，我看不出有什么问题。

非常感谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:20:18.017

看起来`input names`您的表单中的 与您试图从`$_POST`PHP 代码中获取的内容不匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T00:20:03.907

我的猜测是您没有正确安装 oracle 库。一般来说，对于这样的问题，我会`echo 'it works' && exit;`在代码中的很多地方放置，直到它停止工作。然后我知道这是问题功能。

错误日志也是一种可能，但我过去经常发现日志中没有任何内容。

# python - 适用于 Google App Engine 的博客软件

> ID：14006595
> 
> 赞同：3
> 
> 时间：2012-12-22T21:09:27.833
> 
> 标签：python, google-app-engine, open-source, blogs

我对 Google App Engine 有一些经验，但我想看看是否有任何代码可以用于在 Google App Engine 上运行的可靠博客网站。

我见过一些不错的选择，3年前有人问过这个问题： [https](https://stackoverflow.com/questions/804368/blogging-system-which-runs-on-the-google-app-engine) ://stackoverflow.com/questions/804368/blogging-system-which-runs-on-the-google-app-engine但其中一些选项已过时，不再跟上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:30:32.820

这些是我发现的最好的：[blog](http://bloog.billkatz.com/)、[project-picky](http://code.google.com/p/project-picky/)、[joey-blog](https://github.com/joeyb/joeyb-blog)。

# c - 重复类型定义错误

> ID：14006601
> 
> 赞同：0
> 
> 时间：2012-12-22T21:10:20.187
> 
> 标签：c, typedef, priority-queue

```
#pragma once
#ifndef PRIQUE_H
#define PRIQUE_H

typedef struct queue_node
{
    int val;
    int priority;
    struct queue_node *link;
}

typedef struct p_queue
{
    int size;
    queue_node *first;
} 
```

这是我的头文件代码。当我运行主程序时，我收到重复 typedef 的错误。如何修复它。最初，我将所有代码包含在一个文件中，但希望制作一个头文件可以解决我制作的问题和相应的定义文件。请告诉我我哪里错了，为什么会出现这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T21:14:40.560

弥补我的聪明评论，您缺少 typedef 的结束定义。即你正在`typedef`做某事……什么都没有。我相信你正在尝试这样做：

```
#pragma once
#ifndef PRIQUE_H
#define PRIQUE_H

typedef struct queue_node
{
    int val;
    int priority;
    struct queue_node *link;
} queue_node;

typedef struct p_queue
{
    int size;
    queue_node *first;
} p_queue;

#endif 
```

# asp.net - ASP.NET的Forms Rule，每页只有一个Form：使用Master页面和Log in Form，Register页面呢？

> ID：14006602
> 
> 赞同：0
> 
> 时间：2012-12-22T21:10:31.300
> 
> 标签：asp.net, forms

通常在Master page中，我把我想在所有页面上看到的东西，常见的东西，其中一个常见的东西是两个带有Button的无辜TextBox，能够登录，这是一个Form。

我还有另一个页面，即注册页面，这是另一个表格。

我不能使用 2 runat="server" 表单，那么解决方案是什么？没有一个用 ASP.NET 编写的网站在标题中没有公共登录框的想法无法进入我的脑海......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:38:51.443

忘记runat='server'，回到html。

您的登录表单可能是

```
<form action="/loginaction.aspx" method="post">
  <input name="Username" />
  <input name="Password" type="password" />
  <input type="submit" value="sign in" />
</form> 
```

然后在`PageLoad`你的 loginaction.aspx 页面的方法中放入代码来处理登录请求。它可能看起来像这样：

```
string name = Request["Username"];
string password = Request["Password"];
// do login.. 
```

顺便说一句：可惜asp.net开发人员不能没有`runat='server'`......

# mysql - 带有java的远程MySQL忽略一列

> ID：14006604
> 
> 赞同：2
> 
> 时间：2012-12-22T21:10:41.237
> 
> 标签：mysql, jdbc

我再次被迫在这里寻求答案，因为发生的事情对我来说毫无意义，也许你们会知道发生了什么。

我正在连接到远程 MySQL 服务器，我的问题是我得到一个“列不存在”的错误，让我在下面详细解释一下。

连接后立即检查我的数据库是否正确响应查询，似乎确实如此

```
 st.executeQuery("SET CHARSET latin2"); 
    ResultSet rs = st.executeQuery("SELECT NrKarty, IloscWejsc, OdDnia, DoDnia FROM Karta");
    while (rs.next()) {
        System.out.println(rs.getString(1));
        System.out.println(rs.getInt(2));
        System.out.println(rs.getString(3));
        System.out.println(rs.getString(4));

    } 
```

我得到这样的结果（NrKarty 是这个表的主键）

```
5230303030303034443030463644323745
10
2012-12-13
2016-05-12 
```

这个结果非常好，一切都很好。当我需要询问该表中特定记录的数据时，问题就开始了，该记录由主键 (NrKarty) 指示。

自然，我的查询看起来像这样

```
Statement st = conn1.createStatement();
ResultSet rs = st.executeQuery("SELECT IloscWejsc, OdDnia, DoDnia FROM Karta WHERE NrKarty='"+cardCode+"'"); 
```

卡代码写得很好。查询也很好：

```
SELECT IloscWejsc, OdDnia, DoDnia FROM Karta WHERE NrKarty='5230303030303034443030463644323745' 
```

我在 phpMyAdmin 中检查了查询，返回了正确的结果。

但是在java中我得到这个错误：

```
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'NrKarty' in 'where clause' 
```

老实说，这对我来说毫无意义，也许更聪明的人会明白。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:32:46.340

好吧，就像我想的那样，它很简单，很愚蠢，并且与我所做的所有错误非常相似：D，在那个查询的正下方，我有另一个不正确的查询，它是在我想的时候抛出错误的那个一直都是另一个，也许如果我更仔细地查看编译结果，我会知道的，抱歉。

正确的查询应该是这样的（在另一个表中，抛出错误的那个）

```
SELECT Zajecie_idZajecia FROM KartaZajecie WHERE Karta_NrKarty='5230303030303034443030463644323745' 
```

# windows-phone-8 - 将位图图像源绑定到我的本地文件夹中的图像

> ID：14006607
> 
> 赞同：2
> 
> 时间：2012-12-22T21:10:47.087
> 
> 标签：windows-phone-8

我的`ApplicationData.Current.LocalFolder`文件夹中有一个图像列表。我想在 Image 控件中显示第一张图像。

在我的视图模型类中，我有以下代码：-

```
StorageFolder folder = ApplicationData.Current.LocalFolder;
IReadOnlyList<StorageFile> files = await folder.GetFilesAsync();
if (files.Count > 0)
{
    vm.SelectedImage = files[0].Name;
} 
```

我的 Xaml 有以下代码：

```
<Image>
       <Image.Source>
           <BitmapImage UriSource="{Binding SelectedImage, Mode=OneWay}" CreateOptions="BackgroundCreation"/>
        </Image.Source>
</Image> 
```

但我无法找出正确的字符串来传递图像以显示 - 任何帮助将不胜感激！

塔

罗斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T22:42:35.613

让 IsoStore 数据绑定工作的最简单方法是将 Image.Source 数据绑定到 Path 属性，而不是 Name 属性。

```
private async void SetImage()
{
    var files = await ApplicationData.Current.LocalFolder.GetFilesAsync();
    this.DataContext = files.First();
} 
```

XAML 数据绑定：

```
 <Image x:Name="img" Source="{Binding Path}" Width="100" Height="100" /> 
```

这是 Image.Source 的打印屏幕，显示为 StorageFile.Path：

![Image.Source 显示到 StorageFile.Path](../Images/ef01930df6f272d6d781c21fd09a7629.png)

# php - PHP递归打印带有键的多维数组的所有元素

> ID：14006609
> 
> 赞同：4
> 
> 时间：2012-12-22T21:11:09.030
> 
> 标签：php, arrays, multidimensional-array

我找到了以下代码，它可以很好地打印数组的所有元素。如何修改它以打印一个键，然后打印与该键对应的所有值，然后是另一个键，然后是与键对应的所有值？我还想对其进行修改，使其仅打印每个键的前 9 个值（不超过此值）。

```
 function printAll($a) {
  if (!is_array($a)) {
    echo $a, ' ';
     return;
   }

   foreach($a as $v) {
   printAll($v);
  }
 } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-09-18T13:17:14.733

我假设您想要一些非编程人类可以理解的东西。

```
function pretty_dump($arr, $d=1){
    if ($d==1) echo "<pre>";    // HTML Only
    if (is_array($arr)){
        foreach($arr as $k=>$v){
            for ($i=0;$i<$d;$i++){
                echo "\t";
            }
            if (is_array($v)){
                echo $k.PHP_EOL;
                Pretty_Dump($v, $d+1);
            } else {
                echo $k."\t".$v.PHP_EOL;
            }
        }
    }
    if ($d==1) echo "</pre>";   // HTML Only
} 
```

用法：

```
$myarray=array(
    'mammals'=>array(
        'cats'=>array(
            'cheetah',
            'lion',
            'cougar'
        ),
        'dogs'=>array(
            'big'=>'Scooby',
            'small'=>'chihuahua',
            'medium'=>array(
                'pumi',
                'bulldog',
                'boxer'
            )
        ),
    ),
    'fish'=>'fish',
    'birds'=>array(
        'flying'=>array(
            'mallard',
            'condor',
            'gull'
        ),
        'nonflying'=>'emu'
    )
);

pretty_dump($myarray); 
```

输出：

```
 mammals
        cats
            0   cheetah
            1   lion
            2   cougar
        dogs
            big Scooby
            small   chihuahua
            medium
                0   pumi
                1   bulldog
                2   boxer
    fish    fish
    birds
        flying
            0   mallard
            1   condor
            2   gull
        nonflying   emu 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T21:14:05.673

```
function printAll($a) {
    if (!is_array($a)) {
        echo $a, ' ';
        return;
    }

    foreach($a as $k => $value) {
         if($k<10){
             printAll($k);
             printAll($value);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T21:13:14.180

有什么问题[`print_r`](http://php.net/print-r)，[`var_dump`](http://php.net/var-dump)或者[`var_export`](http://php.net/var-export)？

除此之外，阅读文档[`foreach`](http://php.net/foreach)，您将清楚地了解如何获取您正在迭代的密钥。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-22T21:20:17.157

```
function printAll($a) {
  foreach ($a as $k => $v) {
    echo $k, ' ';
  }

  printAllVals($a);
}

function printAllVals($a) {
  if (!is_array($a)) {
    echo $a, ' ';
      return;
   }

   foreach($a as $k => $v) {
     if ($k < 10) {
       printAllVals($v);
     }
   }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T21:13:08.653

尝试：

```
foreach($a as $k => $v) 
```

`$k`你的钥匙在哪里，`$v`仍然是价值。

# javascript - 基于 HTML5 拖放事件的叠加层像疯了一样闪烁

> ID：14006612
> 
> 赞同：7
> 
> 时间：2012-12-22T21:11:26.533
> 
> 标签：javascript, jquery, html, dom

我正在尝试实现一个拖放上传器，当将文件拖到窗口中时，它会使用叠加层标记放置区域（放置区域内的 100% 宽度/高度绝对元素，静态时看起来很棒），并在文件离开窗口或被拖放到放置区之外。

问题是当文件被拖入窗口时，dragover 和 dragleave 事件会像疯了一样触发，因此覆盖层会像疯了一样闪进闪出。

```
window.addEventListener('dragover', handleDrag, false);
window.addEventListener('dragleave', handleStop, false);
window.addEventListener('drop', handleStop, false);
dropzone.addEventListener('drop', handleUpload, false);

function handleDrag(event) {
  // Stop normal browser response.
  event.stopPropagation();
  event.preventDefault();

  if (!window.mysettings.dragging) {
    window.mysettings.dragging = true;
    $('#dropzone').prepend('<div class="overlay">HELLO</div>');
  }
}

function handleStop(event) {
  // Stop normal browser response.
  event.stopPropagation();
  event.preventDefault();

  if (window.mysettings.dragging) {
    window.mysettings.dragging = false;
    $('#dropzone .overlay').remove();
  }
}

function handleUpload(event) {
  // Stop normal browser response.
  event.stopPropagation();
  event.preventDefault();

  if (window.mysettings.dragging) {
    window.mysettings.dragging = false;
    $('#dropzone .overlay').remove();
  }

  // DO MY FILE UPLOAD STUFF HERE
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-14T19:53:25.150

```
http://jsbin.com/zabeqigefi/1/edit?css,js,output 
```

嘿，

实际发生了什么：

1.  您每秒大约 60 次预置/删除项目。
2.  您不能在活动元素上显示全宽覆盖！如果你这样做，当你移动鼠标时，当覆盖处于活动状态时，dragleave 将被触发。
3.  我从 Dropbox 网站得到了这个 - 他们有四个部分来显示 dropzone 激活 - 就像这些（它的边框顶部，底部，左侧，右侧）：

    ```
    <div style="opacity: 0.6; /* display: none; */" class="external-drop-indicator top"></div>
    <div style="opacity: 0.6; display: none;" class="external-drop-indicator right"></div>
    <div style="opacity: 0.6; display: none;" class="external-drop-indicator bottom"></div>
    <div style="opacity: 0.6; display: none;" class="external-drop-indicator left"></div> 
    ```

祝你好运！

PS - 您始终可以向 body 添加一个类而不是创建新节点，并通过 css 更改 dropzone 的视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-28T17:32:25.570

在我的项目中，我发现以下属性确实闪烁：

*   `visibility:hidden`至`visibility:visible`
*   `display:none`至`display:block`

但是以下属性没有闪烁：

*   `opacity:0`至`opacity:1`

同样在 HTML 中，确保覆盖元素出现在活动区域​​元素之前。

# javascript - 笛卡尔到极坐标导致 NaN

> ID：14006618
> 
> 赞同：0
> 
> 时间：2012-12-22T21:12:08.203
> 
> 标签：javascript, math, 3d, three.js, polar-coordinates

所以我正在处理一个 3-D 场景，我需要随意转换到极坐标和从极坐标转换，并编写了一个函数来帮助我转换。问题是它经常导致其中一个角度的 NaN。我正在使用的功能如下：

```
toPolar: function(x,y,z){
    var sqrd = (x*x)+(y*y)+(z*z)
    var radius = Math.pow(sqrd,.5)
    var theta = Math.acos(z/radius)
    var phi = Math.asin(y/x)
    var toReturn={
        r:radius,
        t:theta,
        p:phi
    }
    return toReturn
} 
```

Phi 是返回 NaN 的原因，虽然我知道它在哪里导致 NaN，但它似乎在整个场景中的某些点上发生

你可以在这里看到问题：http: [//cabbibo.com/sketches/audioSketch3/](http://cabbibo.com/sketches/audioSketch3/)

在左上角，您可以看到相机的极坐标和笛卡尔坐标，极坐标 (phi) 的最后一部分会不时显示为 NaN。

我认为我的数学存在某种问题，因为我不擅长它，但似乎这可能是一个不同的问题，例如我不了解如何使用 Math.asin ...

感谢您的宝贵时间，如果有人需要任何其他信息，请告诉我！

艾萨克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:15:00.347

你不想要极坐标；你似乎想要球坐标。

你的 phi 方程看起来不正确。看一下这个：

[http://en.wikipedia.org/wiki/Spherical_coordinate_system](http://en.wikipedia.org/wiki/Spherical_coordinate_system)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:40:50.853

如果您希望 phi 像方位角一样（例如在水平面上，-pi -> pi），您应该使用 atan2。

```
var phi = Math.atan2(y,x); 
```

# spring - Spring @RequestParam 参数未在 POST 方法中传递

> ID：14006619
> 
> 赞同：6
> 
> 时间：2012-12-22T21:12:12.103
> 
> 标签：spring, spring-mvc

我在使用 Spring 和发布请求时遇到问题。我正在为 Ajax 调用设置控制器方法，请参阅下面的方法定义

```
@RequestMapping(value = "add.page", method = RequestMethod.POST)
@ResponseBody
public Object createComment(
        @RequestParam(value = "uuid", required = false) String entityUuid,
        @RequestParam(value = "type", required = false) String entityType,
        @RequestParam(value = "text", required = false) String text,
        HttpServletResponse response) {
        .... 
```

无论我以何种方式进行 HTML 调用，`@RequestParam`参数的值始终为空。我有许多其他方法看起来像这样，主要区别在于其他方法是 GET 方法，而这个是 POST。不能`@RequestParam`与 POST 方法一起使用吗？

我正在使用 Spring 版本 3.0.7.RELEASE - 有谁知道问题的原因可能是什么？

* * *

阿贾克斯代码：

```
$.ajax({
    type:'POST',
    url:"/comments/add.page",
    data:{
        uuid:"${param.uuid}",
        type:"${param.type}",
        text:text
    },
    success:function (data) {
        //
    }
}); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-22T22:36:52.250

问题原来是我调用该方法的方式。我的 ajax 代码传递了请求正文中的所有参数，而不是作为请求参数，所以这就是为什么我的`@RequestParam`参数都是空的。我将我的ajax代码更改为：

```
$.ajax({
    type: 'POST',
    url: "/comments/add.page?uuid=${param.uuid}&type=${param.type}",
    data: text,
    success: function (data) {
        //
    }
}); 
```

我还更改了控制器方法以从请求正文中获取文本：

```
@RequestMapping(value = "add.page", method = RequestMethod.POST)
@ResponseBody
public Object createComment(
        @RequestParam(value = "uuid", required = false) String entityUuid,
        @RequestParam(value = "type", required = false) String entityType,
        @RequestBody String text,
        HttpServletResponse response) { 
```

现在我得到了我期望的参数。

# jquery - 仅在 Chrome 中工作的 JQuery 代码

> ID：14006621
> 
> 赞同：-4
> 
> 时间：2012-12-22T21:12:26.160
> 
> 标签：jquery, google-chrome

这段代码有什么问题？

```
$(function size() {
    var width = document.width;
    $('.section').css('width', 2 * width);
    $('body').css('width', 8 * width).css('font-size', 0.023 * width);
    $('.center').css('width', width);
    $('#title').css('width', 0.78 * width);
    $('#lf').css('width', 0.56 * width);
});

$(window).ready(size); 
```

请帮忙！我不知道出了什么问题：/

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:33:16.553

`document.width`在 MDN 中被标记为过时，请`document.body.clientWidth`改用。

也不`$(window).ready(...)`是无效的jquery，你的意思是`$(window).load()`？

尽管第一个代码块以与注册处理程序相同的方式注册处理程序，但`$(document).ready(...)`不需要第二个调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:33:46.427

你应该使用

```
var width = $(document).width(); 
```

代替

```
var width = document.width; 
```

在 Chrome中`var width = document.width;`返回宽度，但`undefined`在其他浏览器中。既然你正在使用`jQuery`，那就好好利用它。您也可以使用您的代码

```
function size() {
    var width = $(document).width();
    alert(width);
};
$(size); // calls ready event event 
```

# css - 如何证明放置在多行和多列上的文本是合理的

> ID：14006623
> 
> 赞同：0
> 
> 时间：2012-12-22T21:12:49.077
> 
> 标签：css, text-align

我想知道如何以下列方式证明 HTML 文档中的某些文本：

**原文：**

```
............     ..........
.......          ...... 
```

**预期结果：**

```
............     . . ........
. . . . . ..     .  . . . . . 
```

我一直在思考和寻找解决方案，但我无处可去。

请帮忙。

**编辑**

澄清一下，列和行应该完全分开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:18:58.990

假设您的文本已作为单独的 div 或`css-columns`属性放置在列中，设置`text-align: justify;`应该可以解决问题。在没有看到所涉及的标记的情况下，我无法提供进一步的帮助。

编辑：请看[这个问题](https://stackoverflow.com/questions/4771304/justify-the-last-line-of-a-div)和最佳答案。我希望它可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:18:44.487

只需将这些行放在每一列和每一行上：

```
text-align:justify;
text-justify:inter-word; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T22:35:03.777

您可以使用 来证明文本的合理性`text-align: justify`，但这往往会导致印刷效果不佳。您可以通过使用连字符（在 CSS 或 JavaScript 中）来改善这种情况。在 IE 上，您可以额外使用`text-justify: newspaper`，这往往会改善结果。

关于段落或其他块的最后一行，这似乎是这里的问题，您可以添加

```
-moz-text-align-last: justify;
text-align-last: justify; 
```

在 IE 和 Firefox 上，这使得最后一行是合理的。但你可能不喜欢这个结果。如果最后一行只有一点点文字，与列宽相比，单词和/或字母之间会有很大的差距。

将文本划分为列是一个单独的问题，并且有许多可能的方法，具体取决于上下文和设计偏好。

# java - 如何在已安装的 Eclipse 中包含 JAVA 开发工具？

> ID：14006629
> 
> 赞同：1
> 
> 时间：2012-12-22T21:13:18.337
> 
> 标签：java, eclipse

> **可能重复：**
> [在 CDT 之上安装 eclipse JDT](https://stackoverflow.com/questions/1853450/install-eclipse-jdt-on-top-of-cdt)

我已经安装了：

```
 Eclipse IDE for C/C++ Developers
 Version: Indigo Release
 Build id: 20110615-0604 
```

现在我想要 Eclipse 中的 JAVA 开发工具。我该如何安装？

请张贴图形指南。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:15:49.943

只是去eclipse市场搜索Java工具并安装

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:16:49.310

转到帮助菜单，然后按安装新软件

![在此处输入图像描述](../Images/ad83e0be713de2767e5f19d0d571ca55.png)

或者，使用[Marketplace](http://marketplace.eclipse.org/)。

![在此处输入图像描述](../Images/4ca4ec4c079c727f0d7bd54c391dc31d.png)

# c# - 带有 DataRow 的 ASP.NET 控制器

> ID：14006632
> 
> 赞同：1
> 
> 时间：2012-12-22T21:13:25.793
> 
> 标签：c#, asp.net-mvc, strongly-typed-dataset

我正在构建一个与 SQL 服务器数据库通信的简单 ASP.NET 应用程序。在一个单独的项目中，我拥有由 Visual Studio 生成的数据集。我正在尝试公开一个将显示数据库中所有用户的 API，但我遇到了一个异常。

这是代码：

```
public class UserController : ApiController {

    public IEnumerable<GWDataSet.usersRow> GetAllUsers() {
        GWDataSet gw = new GWDataSet();
        usersTableAdapter adapter = new usersTableAdapter();
        adapter.Fill(gw.users);

        return gw.users.AsEnumerable();
    }
} 
```

这是一个例外：

```
Type 'System.Data.DataRow' cannot be serialized. Consider marking it with the DataContractAttribute attribute, and marking all of its members you want serialized with the DataMemberAttribute attribute. If the type is a collection, consider marking it with the CollectionDataContractAttribute. See the Microsoft .NET Framework documentation for other supported types. 
```

除了手动编辑系统生成的代码之外，有没有办法解决这个问题？我担心下次我对数据集进行更改时，它会覆盖我添加的所有数据合同元素。我认为有办法做到这一点，但我似乎找不到。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:48:56.700

这是因为您不能共享 DataRow 对象。它们不可序列化。如果你想共享它，你应该创建 DTO 对象。从服务、API 等共享对象是一种很好的做法。Tru 将您的 DataRow 转换为 DTO 对象。尝试类似：

创建你的类作为这个 DTO，例如：

```
[Serializable]
public class UserDTO
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Address { get; set; }
    public string Birthday { get; set; }
    /* other properties you need */
} 
```

在你的 web api 中，试试这个：

```
public class UserController : ApiController {

    public IEnumerable<UserDTO> GetAllUsers() {
        GWDataSet gw = new GWDataSet();
        usersTableAdapter adapter = new usersTableAdapter();
        adapter.Fill(gw.users);

        List<UserDTO> list = new List<UserDTO>();

        foreach(DataRow row in gw.users.Rows) 
        {
            UserDTO user = new UserDTO();
            user.FirstName = row["Name"].ToString();
            // fill properties

           list.Add(user);
        }

        return list;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T14:19:02.837

离开 Felipe 的回答（在记住我需要处理可怕的 DBNull 之后），这是我构建的最终方法：

```
 public IEnumerable<GW.Entities.user> GetAllUsers() {
        try {
            GWDataSet gw = new GWDataSet();
            List<GW.Entities.user> users = new List<user>();
            usersTableAdapter adapter = new usersTableAdapter();

            adapter.Fill(gw.users);

            foreach (GWDataSet.usersRow row in gw.users.Rows) {
                users.Add(new GW.Entities.user {
                    UserId = row.IsNull("UserId") ? 0 : row.UserId,
                    UserName = row.IsNull("UserName") ? "" : row.UserName,
                    EmailAddress = row.IsNull("EmailAddress") ? "" : row.EmailAddress,
                    UserPasswordLastChange = row.IsNull("UserPasswordLastChange") ? DateTime.MinValue : row.UserPasswordLastChange,
                    LastLogin = row.IsNull("LastLogin") ? DateTime.MinValue : row.LastLogin,
                    StatusCd = row.IsNull("StatusCd") ? "" : row.StatusCd,
                    LastTimestamp = row.IsNull("LastTimestamp") ? null : row.LastTimestamp
                });
            }

            return users;
        } catch (Exception ex) {
            Debug.WriteLine(ex.ToString());
            return null;
        }
    } 
```

这给了我一个输出：

```
<ArrayOfuser xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.datacontract.org/2004/07/GW.Entities">
    <user>
        <EmailAddress>seraieis@gmail.com</EmailAddress>
        <LastLogin>2012-12-19T20:48:26.41</LastLogin>
        <LastTimestamp>AAAAAAAARlI=</LastTimestamp>
        <StatusCd>A</StatusCd>
        <UserId>1</UserId>
        <UserName>seraieis</UserName>
        <UserPasswordLastChange>0001-01-01T00:00:00</UserPasswordLastChange>
    </user>
</ArrayOfuser> 
```

# jquery - 每次页面加载后，必须重新选择表单上的 jquery select 才能工作

> ID：14006635
> 
> 赞同：3
> 
> 时间：2012-12-22T21:13:45.240
> 
> 标签：jquery

我正在使用以下 jquery 来禁用我页面上的文本框。我遇到的问题是，默认情况下，因为它存储在数据库中，它会加载“remote_server”设置为 0 的页面。即使自动设置，字段仍然可以修改。我必须单击选择下拉菜单并重新选择“否”才能正常工作。

这是我的 JS

```
var e = document.getElementsByName("remote_server")[0]
var strUser = e.options[e.selectedIndex].value;

if ( strUser == 0 ) {

$('select[name=remote_server]').change(function(){
var inputs = $('input[name^=ftp_],select[name^=ftp_]');
$(this).val() == "0" ? inputs.attr("disabled", "disabled") : inputs.removeAttr("disabled");
});
} 
```

我用于下拉选择的 remote_server HTML 代码。

```
<select name="remote_server" class="required">
<option></option>
<option value="1" <?php if($remote=="1") echo 'selected="selected"'; ?>>Yes</option>
<option value="0" <?php if($remote=="0") echo 'selected="selected"'; ?>>No</option>
</select> 
```

加载页面我看到选项 0 也被选中，这就是为什么这让我感到困惑

```
<select name="remote_server" class="required">
<option></option>
<option value="1" >Yes</option>
<option value="0" selected="selected">No</option>
</select> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:24:53.753

您应该触发`change`事件：

```
$('select[name=remote_server]').change(function(){
   var inputs = $('input[name^=ftp_],select[name^=ftp_]');
   $(this).val() == "0" 
   ? inputs.attr("disabled", "disabled") 
   : inputs.removeAttr("disabled");
}).change() // trigger the event 
```

请注意，从 jQuery 1.6 开始，用于设置/获取元素的属性，`prop`应该使用方法而不是`attr`：

```
var $inputs = $('input[name^=ftp_],select[name^=ftp_]');

$('select[name=remote_server]').change(function(){
     $inputs.prop('disabled', this.value === 0)
}).change(); 
```

# html - 带有 css 查询的 vb.net html 解析器（有点像 nokogiri）

> ID：14006638
> 
> 赞同：1
> 
> 时间：2012-12-22T21:14:02.273
> 
> 标签：html, vb.net

vb.net / for vb.net 中是否有一个工具，例如 nokogiri（一种 ruby​​ gem），它允许使用令人敬畏的 css 查询（例如`#htmlid`）来解析 HTML 文件，`<p id="htmlid">...</p>`以便我可以轻松地解析 html 内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:15:27.920

[CsQuery](https://github.com/jamietre/CsQuery)可能是您正在寻找的。

> CsQuery - .NET 4 的 .C# jQuery 端口
> 
> CsQuery 是 .NET 4 的 jQuery 端口。它实现了所有 CSS2 和 CSS3 选择器、jQuery 的所有 DOM 操作方法以及一些实用方法。大多数 jQuery 测试套件（从 1.6.2 开始）已移植到 C#。

如果您对 LINQ 和/或 XPath 感到满意，我还会推荐很棒的[HTML Agility Pack](http://htmlagilitypack.codeplex.com)。

# javascript - onkeydown 事件仅在第 10 秒执行

> ID：14006644
> 
> 赞同：1
> 
> 时间：2012-12-22T21:14:44.907
> 
> 标签：javascript, settimeout, onkeypress

所以我有一个围绕网格移动的小方块，但是当我执行 onkeydown 事件时，我的方块移动得非常快。我只希望它每 10 秒执行一次，这样我的小方块就不会碰到剪刀。但是当我尝试 setTimeout 函数时，它只会在第一次按键时超时，然后继续快速执行，当您释放按键时，它仍在执行以赶上。这对我的小广场很不安全。任何帮助将非常感激。

这是没有 setTimeout 函数的代码，只是因为我觉得这不是正确的方法：

```
function checkArrowKeys(e){
    var arrs= [], key= window.event? event.keyCode: e.keyCode;
    arrs[37]= 'left';
    arrs[38]= 'up';
    arrs[39]= 'right';
    arrs[40]= 'down';
    if(arrs[key]){
        transition(arrs[key]);
    }
}
document.onkeydown=checkArrowKeys; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:19:22.210

如果您的预设延迟没有发生，您可以通过退出该功能来停止执行过渡。

```
var bWait=false;
function checkArrowKeys(e){
    if (bWait) return;
    var arrs= [], key= window.event? event.keyCode: e.keyCode;
    arrs[37]= 'left';
    arrs[38]= 'up';
    arrs[39]= 'right';
    arrs[40]= 'down';
    if(arrs[key]){
        transition(arrs[key]);
    }
    bWait=true; //wait for 10 milliseconds
    window.setTimeout("bWait=false;",10);
}
document.onkeydown=checkArrowKeys; 
```

你怎么看？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:52:28.520

键盘响应可能会变得异常复杂。通常你不想关注每个被触发的 keydown 事件，因为这取决于用户的键盘和设置；例如，一个事件最初触发，然后在暂停后触发快速流。当用户同时按住两个键时，还有一个问题。

以下代码通过单独的更新函数将键盘响应与动画分开。按下新的箭头键后，方块最初移动 1 步（设置为 5px），然后在 100 毫秒后连续移动，直到释放键。

（[小提琴](http://jsfiddle.net/XDyJJ/4/)）

```
var directions = [],
    lastPressTime, stepped, ti, frameRate = 30,
    squareSpeed = 5, stepTime = 100;

function update() {
    var x, y, d = directions[directions.length - 1],
        square = document.getElementById('square');
    if (!d) {
        return;
    }
    if (new Date().getTime() < lastPressTime + stepTime) {
        if (stepped) { // already stepped and <100ms has passed
            return;    // so do nothing
        }
        else {
            stepped = true;
        }
    }
    x = square.offsetLeft;
    y = square.offsetTop;
    if (d == 'left') {
        x -= squareSpeed;
    }
    else if (d == 'right') {
        x += squareSpeed;
    }
    else if (d == 'up') {
        y -= squareSpeed;
    }
    else if (d == 'down') {
        y += squareSpeed;
    }
    square.style.left = x + 'px';
    square.style.top = y + 'px';
}
function checkArrowKeys(e) {
    var arrs = [],
        key = window.event ? event.keyCode : e.keyCode;
    arrs[37] = 'left';
    arrs[38] = 'up';
    arrs[39] = 'right';
    arrs[40] = 'down';
    if (arrs[key]) {
        return arrs[key];
    }
}
document.onkeydown = function(e) {
    var d = checkArrowKeys(e);
    if (d) {
        // Key not already pressed; add it to array 
        // of directions and step forward
        if (directions.indexOf(d) === -1) {
            directions.push(d);
            lastPressTime = new Date().getTime();
            stepped = false;
        }
        if (!ti) {
            ti = setInterval(update, 1000 / frameRate);
        }
    }
};

document.onkeyup = function(e) {
    var d = checkArrowKeys(e),
        i;
    if (d) {
        i = directions.indexOf(d);
        // remove this direction from the array of directions
        if (i > -1) {
            directions = 
                directions.slice(0, i).concat(directions.slice(i + 1));
        }
        // if no keys are down then stop updating
        if (directions.length === 0) {
            clearInterval(ti);
            ti = null;
        }
    }
}; 
```

# wordpress - 使用 Wordpress 进行用户管理

> ID：14006647
> 
> 赞同：2
> 
> 时间：2012-12-22T21:15:14.543
> 
> 标签：wordpress

我有 Django 的背景，但我以前从未使用过 CMS。在我的公司，我被赋予了使用 wordpress 制作网站的任务。该网站需要通过标准注册/登录流程支持用户注册，该流程将用户重定向到他自己的个人资料页面，在那里他可以与网络应用程序进行交互。这在 Django 中很容易实现，但我不允许使用除 PHP 之外的任何东西。我决定使用 CMS，因为该站点包含许多带有简单文本内容的网页，更不用说可用于 PHP 的大量漂亮主题了。可以在 Wordpress 中执行此操作，还是我应该在 php 中查找 Web 框架并继续使用它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T22:56:30.790

您可以使用[login_redirect](http://codex.wordpress.org/Plugin_API/Filter_Reference/login_redirect)过滤器来更改用户在登录时看到的页面。

熟悉使用[操作和过滤钩子](http://codex.wordpress.org/Plugin_API)在 WordPress 中执行操作。他们是你的朋友:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T06:29:05.437

您可以编辑 wp-login.php。

找到 case 'login' : 并更改 $redirect_to = admin_url(); 的 else

至

```
$redirect_to = admin_url(). "/profile.php"; 
```

但是，我不确定您是否要养成编辑 wp-login.php 的习惯，因为当您更新它时可能会导致问题或被覆盖。很可能有更优雅的方法可以做到这一点，或者编写一个函数来做到这一点。

就插件而言，我使用 s2Member 将登录用户重定向到我选择的不同页面，甚至基于角色。我不明白为什么您不能更改配置文件并且不会导致上述任何黑客问题。

回首过去，我可以在谷歌上找到一些较旧的插件和一些提及，所以这是可能的。不要这么快就放弃 WordPress，几乎所有你能想到的都有插件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T21:23:28.187

Wordpress 有一个针对不同角色（管理员、编辑、作者、订阅者等）的注册系统。您可以使用其原生功能来测试用户[**是否**](http://codex.wordpress.org/Function_Reference/is_user_logged_in)登录以及[**哪个**](http://codex.wordpress.org/Function_Reference/get_currentuserinfo)用户登录，并相应地显示相关数据。

# javascript - 图像切换时未出现幻灯片动画

> ID：14006650
> 
> 赞同：1
> 
> 时间：2012-12-22T21:15:30.737
> 
> 标签：javascript, html, twitter-bootstrap, carousel

我有 Bootstrap 轮播，但没有“幻灯片”动画。它只是替换图像。我已经检查过[Twitter Bootstrap Carousel Not Sliding](https://stackoverflow.com/questions/10660718/twitter-bootstrap-carousel-not-sliding) 和[Twitter Bootstrap Carousel Slide doesn't Work](https://stackoverflow.com/questions/9985801/twitter-bootstrap-carousel-slide-doesnt-work) 但那里的处方似乎对我不起作用。

我的 bootstrap.js 文件肯定包含“过渡”位。而且因为旋转木马有效，我显然在那里得到了正确的课程。我很困惑为什么幻灯片动画不起作用。

## HTML

```
<head>
    <title>LessonUp - Learn Piano Faster</title>
    <!--Put in CSS link-->
    <script src="http://code.jquery.com/jquery-1.7.1.js"></script>
    <link  type="text/css" href="stylesheets/bootstrap.css" rel="stylesheet" media="screen"/>
    <script src="js/bootstrap.js"></script>
    <!--<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-carousel.js"</script>-->
    <script>
    $(document).ready(function(){
        $('.carousel').carousel({
            interval:3000
        });
    });
    </script>
    <script>
        $(document).ready(function(){
            $("#email_submit").click(function(event){
                $(".alert-success").show();
                $(".alert-success").fadeOut(8000);
          });
      });
    </script> 
```

## 轮播部分

```
<!--Carousel-->
           <div class="span7 slide">
               <div id="myCarousel" class="carousel slide">
       <!--Carousel Items-->
                   <div class="carousel-inner">
                        <div class="active item"><img src="img/Library_shot.png"></div>
                            <div class="item"><img src="img/performance_shot.png"></div>
                            <div class="item"><img src="img/lesson_shot.png"></div>
                   </div>
        <!--Carousel Nav-->
                   <a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
                   <a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
                </div>
           </div> 
```

您可以在 www.lessonupapp.com 上看到输出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T00:46:14.663

我认为这是因为你的图像太大了......我不是在开玩笑！让它更小，它会工作。您的图像超过 5000 像素 x 4000 像素，超过 1mb...

# c++ - C++：递归附加链表

> ID：14006653
> 
> 赞同：3
> 
> 时间：2012-12-22T21:15:51.200
> 
> 标签：c++, pointers, recursion, linked-list

这段代码应该附加两个链表，我完全看不出这段代码是如何附加作为参数传递的两个 Cell Structs 的，因为第二个参数没有发生任何操作。它只是要求第一个 Cell 中的下一个节点 - 那么这如何工作呢？

```
void Append(Cell *& first, Cell* second)
{
  if (first == NULL)
  {
    first = second;
  }
else {
    Append(first->next, second);
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:18:04.790

它递归直到是对第一个列表中最后一个指针的`first`引用，它设置为指向第二个列表中的第一个。它不需要操纵（假设它是一个单链表）。`next``Cell``Cell``second`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:18:17.217

这是一个递归算法，一直走到第一个列表（`else`分支）的末尾；一旦找到结尾（`first==NULL`），第二个列表的第一个元素将链接到第一个列表的最后一个元素，获得一个由两个原始列表连接而成的列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T21:18:56.767

`else`函数块一直跟随`next`指针，`first`直到它到达该列表的末尾。也就是说，直到`first->next`is`NULL`并且 the`else`不会被执行。

`if`现在是块中的基本情况。当`first->next`is时`NULL`，它将指针更改为指向`second`，这可能是另一个列表中的第一个元素。

有一些影响的原因是因为`first->next`指针是通过引用传递的。修改指针将修改列表末尾的实际指针，而不仅仅是修改副本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T21:19:39.767

第二个列表不需要修改。代码将递归遍历第一个列表，直到它到达第一个列表中的最后一个元素，并将该元素的下一个指针设置为第二个列表的开头。第二个列表中的元素将由两个列表共享。

**前：**

```
第一 → a → b → c

第二→d→e→f

```

**后：**

```
第一 → a → b → c
                ↓
第二→d→e→f

```

# c# - 将 XDocument 解析为字典

> ID：14006654
> 
> 赞同：1
> 
> 时间：2012-12-22T21:15:52.093
> 
> 标签：c#, .net, xml

关于如何将整个 XML 文档解析为字典，我需要朝着正确的方向努力。我的计划是让键成为路径，每个嵌套类型由“->”分隔。例如：

```
<Foo>
    <Bar>3</Bar>
    <Foo>
        <Bar>10</Bar>
    </Foo>
</Foo> 
```

如果我想获得一个值，我只需使用以下方法从字典中获取它：

```
string value = Elements["Foo->Bar"]; 
```

我不确定如何递归地遍历每个元素。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T21:27:09.340

直截了当的解决方案：

```
 private static string GetElementPath(XElement element)
    {
        var parent = element.Parent;
        if(parent == null)
        {
            return element.Name.LocalName;
        }
        else
        {
            return GetElementPath(parent) + "->" + element.Name.LocalName;
        }
    }

    static void Main(string[] args)
    {
        var xml = @"
            <Foo>
                <Bar>3</Bar>
                <Foo>
                    <Bar>10</Bar>
                </Foo>
            </Foo>";
        var xdoc = XDocument.Parse(xml);
        var dictionary = new Dictionary<string, string>();
        foreach(var element in xdoc.Descendants())
        {
            if(!element.HasElements)
            {
                var key = GetElementPath(element);
                dictionary[key] = (string)element;
            }
        }
        Console.WriteLine(dictionary["Foo->Bar"]);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:18:57.807

```
public static void parse()
    {
        Stack<String> stck = new Stack<string>();
        List<String> nodes = new List<string>();
        Dictionary<String, String> dictionary = new Dictionary<string, string>();

        using (XmlReader reader = XmlReader.Create("path:\\xml.xml"))
        {

            while (reader.Read())
            {
                if (reader.NodeType == XmlNodeType.Element)
                {

                    stck.Push(reader.Name);

                }
                if (reader.NodeType == XmlNodeType.Text)
                {
                    StringBuilder str = new StringBuilder();
                    if (stck.Count > 0)
                        nodes = stck.ToList<String>();
                    //List<String> _nodes ;
                    nodes.Reverse(0,nodes.Count);
                    foreach (String node in nodes)
                        str.Append(node + " --> ");

                    dictionary.Add(str.ToString(), reader.Value);
                    str.Clear();
                }
                if (reader.NodeType == XmlNodeType.EndElement)
                {

                    stck.Pop();

                }
            }
        }

        foreach (KeyValuePair<String, String> KVPair in dictionary)
            Console.WriteLine(KVPair.Key + " : " + KVPair.Value);
        Console.Read();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T21:33:48.027

您需要查看 xpath，使用的路径格式与您想要的有点不同，但是如果需要，您可以创建一个 wrap 函数

```
string GetByPath(string mypath)
{
  //process path, and reformat it to xpath
  //then get by xpath
} 
```

[http://support.microsoft.com/kb/308333](http://support.microsoft.com/kb/308333)

[http://www.codeproject.com/Articles/9494/Manipulate-XML-data-with-XPath-and-XmlDocument-C](http://www.codeproject.com/Articles/9494/Manipulate-XML-data-with-XPath-and-XmlDocument-C)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T21:36:47.337

另一种选择，但不确定 XML 文档的真实结构

```
 string data = "<Foo><Bar>3</Bar><Foo><bar>123</bar></Foo></Foo>";

    XDocument xdoc = XDocument.Parse(data);
    Dictionary<string, string> dataDict = new Dictionary<string, string>();

    foreach (XElement xelement in doc.Descendants().Where(x => x.HasElements == false))
    {
        int keyInt = 0;
        string keyName = xelement.Name.LocalName;

        while (dataDict.ContainsKey(keyName))
            keyName = xelement.Name.LocalName + "->" + keyInt++;

        dataDict.Add(keyName, xelement.Value);
    } 
```

# java - 将字符串转换为 Java 中的代码

> ID：14006656
> 
> 赞同：7
> 
> 时间：2012-12-22T21:16:02.100
> 
> 标签：java

> **可能重复：**
> [当将方法名称作为字符串给出时，如何调用 java 方法？](https://stackoverflow.com/questions/160970/how-do-i-invoke-a-java-method-when-given-the-method-name-as-a-string)
> [如何以编程方式编译和实例化 Java 类？](https://stackoverflow.com/questions/2946338/how-do-i-programmatically-compile-and-instantiate-a-java-class)

我有一个功能：

```
fun1() {
  System.out.print("hello");
} 
```

我想从用户或文件中读取字符串，如果字符串`"fun1()"`出现，我会调用 fun1.

我不想用 switch 语句来做这件事，因为我有很多功能。

有什么方法可以使用字符串调用函数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T21:20:03.637

你*可以*在这里使用反射：

```
Method method = MyClass.class.getDeclaredMethod("fun1", new Class[] {});
method.invoke(this, null); 
```

但是，首先考虑一下，如果你可以避免使用反射，那么就这样做。反射带来了许多缺点，例如难以调试和使自动重构工具（例如 Eclipse 中的那些工具）实际上毫无用处。

重新思考你的设计；您可能可以通过更清晰的类分解、更好的多态性等更好地解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:18:39.650

[您可以使用Java 反射](http://tutorials.jenkov.com/java-reflection/index.html "反射")来实现这一点

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T21:19:16.070

你可以使用反射来做到这一点。但是您提供的方法不是java。缺少返回类型。你为什么要这样做？这是一个链接，以防您走这条路：[使用反射调用静态方法](https://stackoverflow.com/questions/2467544/invoking-a-static-method-using-reflections)

# gtk - 在treeview gtk中更改列上的字体颜色

> ID：14006658
> 
> 赞同：0
> 
> 时间：2012-12-22T21:16:21.180
> 
> 标签：gtk, cellrenderer, gtktreeview

我有一个树视图，我想更改一列的文本颜色。

我怎么能这样做？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T10:33:57.317

（参考标准 C 方法，目前对 Vala 做的不多）

有几种方法可以实现这一点。您可以更改文本单元渲染器 (GtkCellRendererText) 的设置，例如

```
g_object_set (your_text_cell_renderer, "foreground", 
              "red", "foreground-set", TRUE); 
```

另一种方法是使用标记：

```
highlighted_txt = g_strconcat ("<span background='yellow' foreground='black'>", 
                               my_text, "</span>", NULL);
g_object_set (your_text_cell_renderer, "markup", highlighted_txt, NULL); 
```

要在特定条件下单独更改每列的字体颜色，请使用 gtk_tree_view_insert_column_with_data_func 或 gtk_tree_view_column_set_cell_data_func，它们在 GtkTreeView 的在线文档中有描述。您可以为每列使用不同的文本单元格渲染器以保持设置分开。

它可以通过类似这样的方式完成：

```
for (columns_cnt = 0; columns_cnt < NUMBER_OF_COLUMNS; columns_cnt++) {
  text_renderer = gtk_cell_renderer_text_new ();
  columns[columns_cnt] = gtk_tree_view_column_new_with_attributes
                         (column_header_txt[columns_cnt], text_renderer, 
                         "text", columns_cnt, NULL);
  gtk_tree_view_column_set_cell_data_func (columns[columns_cnt], text_renderer, 
                                           (GtkTreeCellDataFunc) 
                                           set_column_attributes, NULL, NULL);
}

...

static void set_column_attributes (GtkTreeViewColumn *cell_column, 
                                   GtkCellRenderer   *txt_renderer,
                                   GtkTreeModel      *cell_model, 
                                   GtkTreeIter       *cell_iter, 
                                   gpointer          pointer)
{
 // Use g_object_set or something else here.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T23:12:35.833

首先，您必须在模型中设置一列来描述每一行的颜色。然后，您使用[gtk_tree_view_insert_column_with_attributes](http://developer.gnome.org/gtk3/3.2/GtkTreeView.html#gtk-tree-view-insert-column-with-attributes)将`foreground`属性设置为颜色列的位置。

# facebook-graph-api - 无法使用 facebook api 从相册中获取照片

> ID：14006663
> 
> 赞同：3
> 
> 时间：2012-12-22T21:17:30.607
> 
> 标签：facebook-graph-api

我正在尝试使用相册 ID 从相册中获取照片，但无法获取，

我正在使用图形 api explorer 来检查 URL 并且它不起作用，

首先，我正在做一个`/me/albums`来获取专辑，

结果结果的一部分：

```
name": "Moribay Photos",
      "link": "https://www.facebook.com/album.php?fbid=388544751194190&id=100001160043714&aid=79115",
      "cover_photo": "388544754527523", 
```

`79115`既然我知道它的 id`/79115/photos`为

```
 {
      "data": [
      ]

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:39:32.367

您使用了错误的 id，请使用`fbid`not `aid`。

```
https://graph.facebook.com/388544751194190?fields=photos 
```

或者

```
https://graph.facebook.com/388544751194190/photos 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-13T09:19:59.480

我知道有点晚了，但是：

```
https://graph.facebook.com/[album-id]/photos?fields=id,images,link (etc.) 
```

此 url 提供来自专辑 ID 的现有 fb 专辑照片。

干杯。

# bcrypt - BCrypt 和 SCrypt 是密钥派生函数吗？

> ID：14006667
> 
> 赞同：0
> 
> 时间：2012-12-22T21:18:33.503
> 
> 标签：bcrypt, pbkdf2, scrypt

很抱歉这个问题，但我总是发现它们与 PBKDF2 相比，BCrypt 和 SCrypt KDF 也是如此？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T20:57:22.297

看来我找到了答案：

*   简短的回答是的。
*   长答案：看这里[PDF](http://www.tarsnap.com/scrypt/scrypt.pdf)

顺便说一句，BCrypt 似乎有 55 个字符的限制！

# cygwin - Cygwin 上的 ./configure 在“检查与 BSD 兼容的安装...”时挂起

> ID：14006674
> 
> 赞同：1
> 
> 时间：2012-12-22T21:19:22.383
> 
> 标签：cygwin, configure, autoconf

我在 Windows 7 中使用 Cygwin 并尝试编译一个库[Zyre](https://github.com/zeromq/zyre)。我的“配置”文件是由 autoconf 自动生成的。当我从命令行运行`./configure`生成文件时，它只是说

```
checking for a BSD-compatible install... 
```

这就对了。没有错误，没有抱怨，什么都没有。我等了 > 1 小时，还尝试重新启动几次。有什么问题？我该怎么做才能让它发挥作用？

**以下是有关我使用的平台的一些背景信息：**

`which install`给`/usr/bin/install`.

中断后的*config.log*文件为：

```
This file contains any messages produced by compilers while
running configure, to aid debugging if configure makes a mistake.

It was created by libzre configure 1.0.0, which was
generated by GNU Autoconf 2.69\.  Invocation command line was

$ ./configure 
[..]
install_sh=''
[..] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T11:56:32.670

我花了很长时间在互联网上搜索正确的主题，但最后，我找到了它并解决了问题。番茄和杰克，谢谢你的提示！

一方面，`./configure`没有找到任何与 BSD 兼容的安装。另一方面，`which install`发现了一个安装。在[这个关于 autoconf 的 configure.in 的博客](http://www.adp-gmbh.ch/misc/tools/configure/configure_in.html)和[关于 Autoconf 的手册](http://www.gnu.org/software/autoconf/manual/autoconf-2.67/html_node/Particular-Programs.html)的帮助下，我的注意力被吸引到了 configure 的`install_sh`变量上——在我的例子中它是空的。

解决方案是通过以下方式编辑文件`configure`（我之前使用 autoconf 生成的）：到该行

```
install_sh 
```

我添加了

```
/usr/bin/install -c 
```

那给了

```
install_sh = '/usr/bin/install -c' 
```

我的命令`/usr/bin/install`的输出在哪里。`which install`现在，我的`./configure`命令运行。

# variables - 在一个括号中连接多个树枝变量

> ID：14006676
> 
> 赞同：12
> 
> 时间：2012-12-22T21:20:00.383
> 
> 标签：variables, twig

我想在一个括号中连接 3 个变量，例如 PHP。

IE

在 PHP 中：

```
getimagesize($path.$image) 
```

我们可以用点符号连接变量。我怎样才能在树枝上重现这个？

`{{ path.key }}`没有按预期工作。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-22T21:32:06.343

使用波浪字符`~`连接字符串和/或变量。

> ~：将所有操作数转换为字符串并将它们连接起来。{{“你好”~名字~“！” }} 会返回（假设名字是 'John'）Hello John!。

[在文档中](http://twig.sensiolabs.org/doc/templates.html#other-operators)阅读它。

# matlab - 为 scatter3 图创建图例（Matlab）

> ID：14006678
> 
> 赞同：4
> 
> 时间：2012-12-22T21:20:04.307
> 
> 标签：matlab, legend, scatter-plot

我有一个`X`3 维矩阵点（`X`是一个`Nx3`矩阵），这些点属于集群。它所属的簇由`Nx1`向量给出`Cluster`（它的值类似于 1,2,3,...）。所以，我是这样绘制的`scatter3`：

```
scatter3(X(:,1),X(:,2),X(:,3),15,Cluster) 
```

它工作正常，但我想为其添加一个图例，显示彩色标记和它所代表的集群。

例如，如果我有 3 个集群，我想要一个像这样的图例：

```
<blue o> - Cluster 1
<red o> - Cluster 2
<yellow o> - Cluster 3 
```

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:22:20.440

`scatter3`我建议您不要使用 ，而是使用`plot3`，这将使标记更简单：

```
%# find out how many clusters you have
uClusters = unique(Cluster);
nClusters = length(uClusters);

%# create colormap
%# distinguishable_colormap from the File Exchange 
%# is great for distinguishing groups instead of hsv
cmap = hsv(nClusters);

%# plot, set DisplayName so that the legend shows the right label
figure,hold on
for iCluster = 1:nClusters
    clustIdx = Cluster==uClusters(iCluster);
    plot3(X(clustIdx,1),X(clustIdx,2),X(clustIdx,3),'o','MarkerSize',15,...
       'DisplayName',sprintf('Cluster %i',uClusters(iCluster)));
end

legend('show'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:59:46.677

要么你使用

*   `legend`

代码：

```
h = scatter3(X(:,1),X(:,2),X(:,3),15,Cluster)
hstruct = get(h);
legend(hstruct.Children, "Cluster1", "Cluster2", "Cluter3"); 
```

或者

*   [注释](http://www.mathworks.com/help/matlab/ref/annotation.html)。

# css - display : 块拉伸链接宽度

> ID：14006684
> 
> 赞同：0
> 
> 时间：2012-12-22T21:20:28.823
> 
> 标签：css

我不知道为什么，但是当我将 CSS 设置为`<img>`to时，`display: inline`它工作正常。

但后来我写了`display: block;`，它正在将包裹在元素周围的链接拉伸到整个屏幕上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:23:42.163

块元素占据了可用的全宽，前后都有一个新行，因为锚标签将它包围，它也是全宽。

内联元素只占用所需的宽度，并且不会强制换行。

要修复它，您应该将“我在 instagram 上的工作”锚标签和图像包装在一个 div 中，这是一个块元素，它不会拉伸内部元素。此外，`display:block`从您的 css 中的 instawork 类中删除。[JSFiddle 示例](http://jsfiddle.net/JmnRW/)

```
<div><a href="http://www.instagram.com/pauldewar_me" target="blank_"><img src="http://www.pauldewar.me/imgs/instawork.png"></a></div> 
```

参考：[CSS 块与内联 CSS 显示样式](http://www.webdesignfromscratch.com/html-css/css-block-and-inline/)

# javascript - 绕过 Ajax 自动滚动

> ID：14006685
> 
> 赞同：0
> 
> 时间：2012-12-22T21:20:38.520
> 
> 标签：javascript, ajax

我正在构建一个社交媒体分析程序，但我很难在 soundcloud 上使用滚动 ajax。ajax 要求您滚动到底部以加载更多关注者。

（例如[https://soundcloud.com/secretlycanadian/followers](https://soundcloud.com/secretlycanadian/followers)）

我希望能够立即加载所有这些关注者，我可以通过简单地使用 JS 向下滚动来实现这一点，但是在大帐户上执行此操作所需的时间确实是不可接受的。

谁能想到我可以研究的任何其他方法来解决这个问题？只是有点坚持从哪里开始看这个。

谢谢大家+圣诞快乐！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:30:53.777

为什么不直接从 URL 中删除限制参数？

示例 URL（仅限 60 个关注者）： [https ://api.soundcloud.com/users/11415557/followers?client_id=XXXXXXX&limit=60&linked_pa​​rtitioning=1&offset=60](https://api.soundcloud.com/users/11415557/followers?client_id=XXXXXXX&limit=60&linked_partitioning=1&offset=60)

限制设置为 200： [https ://api.soundcloud.com/users/11415557/followers?client_id=XXXXXXX&limit=200&linked_pa​​rtitioning=1&offset=00](https://api.soundcloud.com/users/11415557/followers?client_id=XXXXXXX&limit=200&linked_partitioning=1&offset=00)

但是，您将需要一个有效的 client_id。我不知道是否有任何服务器端限制。

# linux - 如何检测 Dropbox 文件夹何时更新？

> ID：14006693
> 
> 赞同：3
> 
> 时间：2012-12-22T21:21:48.507
> 
> 标签：linux, synchronization, dropbox

我有一个文件夹，其中包含正在计算机之间同步的文件。从计算机 A 上传文件后，我想将它们从计算机 B 的 Dropbox 文件夹复制到另一个文件夹。如何检测 Dropbox 文件夹何时更新？我可以定期检查 Dropbox 文件夹，但也许有更优雅的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T15:01:26.240

签出[inotify](http://linux.die.net/man/7/inotify)或[incrond](http://linux.die.net/man/7/inotify)，一旦检测到文件夹中的更改，您可以使用其中一种工具运行脚本。如果您选择`incrond`，您可以运行`incrontab -e`并添加如下内容：

```
/path/to/watched/dir IN_CLOSE_WRITE,IN_CREATE,IN_DELETE /path/to/script 
```

例如，在脚本中，您可以启动一个循环 while：

```
[[ $(dropbox filestatus /path/to/watched/dir) != "" ]] 
```

或者：

```
[[ $(lsof -p $dropbox_pid | grep 'REG|DIR.*/path/to/watched/dir') != "" ]] 
```

接着：

```
cp /path/to/watched/dir /path/to/copy/dir 
```

当循环完成时。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-15T22:57:49.920

不！（关于接受的答案）

Dropbox 目前（2012 年可能有所不同）不会触发`IN_CLOSE_WRITE`、`IN_MODIFY`或任何其他直观的选择。Dropbox 将内容移动到临时文件中，然后将其移回 Dropbox 目录。因此触发的 inotify 事件是`IN_MOVE_TO`和`IN_MOVE_FROM`。

所以你的 incrontab 指令应该理想地阅读：

```
/path/to/watched/dir IN_MOVE_TO,IN_CREATE,IN_DELETE /path/to/script 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-12-30T18:41:19.350

如前所述，dropbox 不会触发 IN_CREATE、IN_DELETE 或 IN_MODIFY 等。它会触发 IN_MOVED_TO 和 IN_MOVED_FROM。在 Debian 8 上验证。

# asp.net - 更改 ContentPlaceHolder 的 ID

> ID：14006694
> 
> 赞同：4
> 
> 时间：2012-12-22T21:22:28.243
> 
> 标签：asp.net, master-pages, contentplaceholder

我有一个母版页。在此母版页中，我有一个内容占位符，`id="ContentPlaceHolder1"` 我将其更改为`id="main-content"`然后更改使用此母版页创建的任何内容页的 ContentPlaceHolderID，但出现错误：

> 'main-content' 不是有效的标识符。

我应该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T21:36:15.157

您不能在您的 ID 中使用“-”。您可以使用

> **主要内容**

或者

> **主要内容**

# heroku - Heroku上的升级过程？

> ID：14006697
> 
> 赞同：0
> 
> 时间：2012-12-22T21:22:54.880
> 
> 标签：heroku, updates

如果我使用更新在 Heroku 上运行的应用程序`git push`并且该应用程序在多个 dynos 上运行 - Heroku 如何运行升级过程？

*   同时使用所有测功机？
*   相继？
*   ...？

换句话说：我的“集群”会出现停机时间，还是会有一个小的时间范围内我的应用程序的不同版本并行运行，或者......？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T06:08:28.143

不能告诉内部状态，但我所经历的是

*   代码推送完成
*   代码编译（slug 已编译）
*   之后，所有测功机都会获得最新代码并重新启动。（重新启动最多需要 30 秒左右，在此期间所有请求都进入队列）。

所以不会有停机时间，因为在重新启动过程中，所有请求都会排队，我认为在部署后不会运行多个版本的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-25T00:45:54.730

每个人都说更新 Heroku 应用程序时“没有停机时间”，但对于您的应用程序来说，这可能不是真的。

我最近开发了一个大小合理的 Rails 应用程序，该应用程序至少需要 25 秒才能启动，并且通常无法在 Heroku 允许的 30 秒内启动，然后才会将错误返回给您的客户。

在这整个过程中，您的用户都在等待某些事情发生。30秒是很长的时间，他们可能没有足够的耐心等待。

有人曾经告诉我，如果你有超过 1 个测功机，它们会单独重新启动，以免停机。这不是真的 - Heroku 停止所有测功机，然后启动所有测功机。

任何时候都不会在 Heroku 上运行您的应用程序的 2 个版本

# parsing - 在 Haskell 中创建一个 Read 实例

> ID：14006707
> 
> 赞同：20
> 
> 时间：2012-12-22T21:25:16.683
> 
> 标签：parsing, haskell, typeclass, symmetry

我有一个数据类型

```
data Time = Time {hour :: Int,
                  minute :: Int
                 } 
```

为此，我将 Show 的实例定义为

```
instance Show Time where
  show (Time hour minute) = (if hour > 10
                             then (show hour)
                             else ("0" ++ show hour))
                            ++ ":" ++
                            (if minute > 10
                             then (show minute)
                             else ("0" ++ show minute)) 
```

以 .格式打印出时间`07:09`。

`Show`现在， and之间应该是对称的`Read`，所以在阅读（但不是真正（我认为）理解）[this](https://stackoverflow.com/questions/5520940/creating-instance-of-read-type-class-in-haskell-for-custom-data-type)和[this](https://stackoverflow.com/questions/7851275/how-to-create-instance-of-read-for-a-datatype-in-haskell)并阅读[文档](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Text-Read.html#t%3aRead)之后，我想出了以下代码：

```
instance Read Time where
  readsPrec _ input =
    let hourPart = takeWhile (/= ':')
        minutePart = tail . dropWhile (/= ':')
    in (\str -> [(newTime
                  (read (hourPart str) :: Int)
                  (read (minutePart str) :: Int), "")]) input 
```

这行得通，但是这`""`部分使它看起来是错误的。所以我的问题最终是：

谁能向我解释实现 Read 以解析和/或向我展示的正确`"07:09"`方法`newTime 7 9`？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-22T22:03:00.130

我将使用`isDigit`并保留您对时间的定义。

```
import Data.Char (isDigit)

data Time = Time {hour :: Int,
                  minute :: Int
                 } 
```

你使用但没有定义`newTime`，所以我自己写了一个，这样我的代码就可以编译了！

```
newTime :: Int -> Int -> Time
newTime h m | between 0 23 h && between 0 59 m = Time h m
            | otherwise = error "newTime: hours must be in range 0-23 and minutes 0-59"
     where between low high val = low <= val && val <= high 
```

* * *

首先，您的节目实例有点错误，因为`show $ Time 10 10`给出`"010:010"`

```
instance Show Time where
  show (Time hour minute) = (if hour > 9       -- oops
                             then (show hour)
                             else ("0" ++ show hour))
                            ++ ":" ++
                            (if minute > 9     -- oops
                             then (show minute)
                             else ("0" ++ show minute)) 
```

让我们看一下`readsPrec`：

```
*Main> :i readsPrec
class Read a where
  readsPrec :: Int -> ReadS a
  ...
    -- Defined in GHC.Read
*Main> :i ReadS
type ReadS a = String -> [(a, String)]
    -- Defined in Text.ParserCombinators.ReadP 
```

那是一个解析器 - 它应该返回不匹配的剩余字符串而不是 just `""`，所以你是对的，这`""`是错误的：

```
*Main> read "03:22" :: Time
03:22
*Main> read "[23:34,23:12,03:22]" :: [Time]
*** Exception: Prelude.read: no parse 
```

`,23:12,03:22]`它无法解析它，因为您在第一次阅读时就扔掉了。

让我们在进行过程中重构一下以吃掉输入：

```
instance Read Time where
  readsPrec _ input =
    let (hours,rest1) = span isDigit input
        hour = read hours :: Int
        (c:rest2) = rest1
        (mins,rest3) = splitAt 2 rest2
        minute = read mins :: Int
        in
      if c==':' && all isDigit mins && length mins == 2 then -- it looks valid
         [(newTime hour minute,rest3)]
       else []                      -- don't give any parse if it was invalid 
```

举个例子

```
Main> read "[23:34,23:12,03:22]" :: [Time]
[23:34,23:12,03:22]
*Main> read "34:76" :: Time
*** Exception: Prelude.read: no parse 
```

但是，它确实允许“3:45”并将其解释为“03:45”。我不确定这是个好主意，所以也许我们可以添加另一个测试`length hours == 2`。

* * *

如果我们这样做，我会放弃所有这些拆分和跨度的东西，所以也许我更喜欢：

```
instance Read Time where
  readsPrec _ (h1:h2:':':m1:m2:therest) =
    let hour   = read [h1,h2] :: Int  -- lazily doesn't get evaluated unless valid
        minute = read [m1,m2] :: Int
        in
      if all isDigit [h1,h2,m1,m2] then -- it looks valid
         [(newTime hour minute,therest)]
       else []                      -- don't give any parse if it was invalid
  readsPrec _ _ = []                -- don't give any parse if it was invalid 
```

这对我来说实际上看起来更干净、更简单。

这次它不允许`"3:45"`：

```
*Main> read "3:40" :: Time
*** Exception: Prelude.read: no parse
*Main> read "03:40" :: Time
03:40
*Main> read "[03:40,02:10]" :: [Time]
[03:40,02:10] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T21:41:05.803

如果输入`readsPrec`是在 a 的有效表示之后包含一些其他字符的字符串`Time`，则这些其他字符应作为元组的第二个元素返回。

所以对于字符串`12:34 bla`，结果应该是`[(newTime 12 34, " bla")]`。您的实现会导致该输入出错。这意味着类似的东西`read "[12:34]" :: [Time]`会失败，因为它会调用`Time`'s作为参数（因为会消耗，然后用剩余的字符串调用`readsPrec`，然后检查返回的剩余字符串是不是或者是逗号，后跟更多元素）。`"12:34]"``readList``[``readsPrec``readsPrec``]`

要解决您的问题`readsPrec`，您应该重命名`minutePart`为类似的名称`afterColon`，然后将其拆分为实际的分钟部分（`takeWhile isDigit`例如）以及分钟部分之后的任何内容。然后，分钟部分之后的内容应该作为元组的第二个元素返回。

# html - 使用 :after 伪选择器的省略号样式文本切割与尾随图标相结合

> ID：14006710
> 
> 赞同：3
> 
> 时间：2012-12-22T21:25:37.933
> 
> 标签：html, css, css-selectors

我想可视化使用省略号样式缩短的长标题。这工作正常且符合预期。

在某些情况下，我需要文本来获取尾随图标（以调用操作）。通常我使用`:after`css 伪选择器来执行此操作。

但是，我无法让这两个细节一起工作。无论我尝试什么，图标并没有真正放在文本之后，而是根据需要放在下一行。所以浏览器使用了换行符，尽管我试图阻止这种情况（作为省略号样式的一部分）。简单地指定一个`top`值不是解决方案，因为当文本太短而无法缩短时，它会中断。

这是一个非常简单的示例来演示行为：

HTML 标记：

```
<div id="wrapper">
    <span id="text">some longish and wide text which should get a trailing icon when hovered</span>
</div>​ 
```

CSS定义：

```
#wrapper { 
    width:50%; 
    background-color: lightgray;
    margin: 10em;
    padding: 1em;
}
#text {
    font-size: 200%;
    padding: 0.2em;
    display: inline-block;
    overflow-x: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    width: 98%;
    background-color: gold;
}
#text:hover {
    background-color: goldenrod;
}
#text:hover:after {
    content: url("http://cdn1.iconfinder.com/data/icons/cc_mono_icon_set/blacks/48x48/playback_play.png");
    float: right;
}
​ 
```

我准备了一个简单的[演示](http://jsfiddle.net/AP7eC/1/)作为提琴手。

如何防止图标放置在文本下方？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:40:57.830

似乎`ellipsis`会使文本适合可用空间，而忽略放置在其后的元素。恕我直言，这是一个明智的设计，因为您不知道还有多少元素，以及是否会发生换行符。

一个解决方案可能是将图标**放在**text之外`span`，在包装器中。您还需要通过缩短`width`悬停时的文本来为其腾出空间：

```
#wrapper:hover #text {
    background-color: goldenrod;
    width: 74%;
}
#wrapper:hover:after {
    content: url("http://cdn1.iconfinder.com/data/icons/cc_mono_icon_set/blacks/48x48/playback_play.png");
    float: right;
} 
```

这是一个[工作演示](http://jsfiddle.net/AP7eC/3/)。如果您必须让图标 [出现] 与文本（金色）一起，我相信您必须创建另一个嵌套包装器（如[this](http://jsfiddle.net/AP7eC/5/)）。

# wpf - 将 UIElement 转换为 DataTemplate

> ID：14006715
> 
> 赞同：1
> 
> 时间：2012-12-22T21:26:44.797
> 
> 标签：wpf, xaml, datatemplate, datagridtemplatecolumn, uielement

我`DataTemplate`在 XAML 中定义了一个。我想对其进行自定义并将其提供给`DataGridTemplateColumn.CellTemplate`. 但是当我调用时`LoadContent()`，`VisualTree`仍然为空，而是`UIElement`返回一棵树。自定义树后，如何将其转换回`DataTemplate`? 或者有没有办法`DataGrid`直接喂细胞`UIElement`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T21:39:00.390

我了解到，一旦 UI 控件被实例化，就不可能转换回`DataTemplate`ie`FrameworkElementFactory`树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T07:53:20.320

我认为它应该可以帮助你

[代码项目](http://www.codeproject.com/Articles/43525/WPF-DataGrid-Using-DataTemplates-for-auto-generate)

# android - Listview 未从片段更新

> ID：14006718
> 
> 赞同：-1
> 
> 时间：2012-12-22T21:27:17.823
> 
> 标签：android, listview, dynamic, actionbarsherlock, fragment

当用户点击一个按钮时，一个新的字符串被添加到列表视图中，但是当我点击它时什么都没有出现。我该怎么做呢？

MatchesList.java 将字符串添加到列表视图的类

```
import java.util.ArrayList;

import com.actionbarsherlock.app.SherlockListActivity;

import android.app.ListActivity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.ArrayAdapter;
import android.widget.Button;

public class MatchesList extends SherlockListActivity{
    ArrayList<String> listItems = new ArrayList<String>();
    ArrayAdapter<String> adapter;

    int matchNum=0;
    Button addMatch;

    @Override
    public void onCreate(Bundle icicle){
        super.onCreate(icicle);
        setContentView(R.layout.fragment_matches);
        adapter= new ArrayAdapter<String>(this, 
                android.R.layout.simple_list_item_1, 
                listItems);

        setListAdapter(adapter);

        addMatch = (Button) findViewById(R.id.addMatchBtn);
        addMatch.setOnClickListener(new OnClickListener(){
            public void onClick(View v){
            addMatch(v);
            }
        });

    }

    public void addMatch(View view){
        matchNum += 1;
        listItems.add("Match " + matchNum);
        adapter.notifyDataSetChanged();
    }

} 
```

MatchesFragment.java

```
import com.actionbarsherlock.app.SherlockFragment;

import android.os.Bundle;
import android.view.*;

public class MatchesFragment extends SherlockFragment{

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState){
        return inflater.inflate(R.layout.fragment_matches, container, false);
    }
} 
```

片段匹配.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MatchesFragment" >

    <Button
        android:id="@+id/addMatchBtn"
        android:layout_width="50dp"
        android:layout_height="40dp"
        android:text="Add a Match"

    />

    <ListView 
        android:id="@android:id/list"
        android:layout_width="match_parent"
        android:layout_height="fill_parent"></ListView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:30:28.880

`listAdapter.add(...)`相反（然后不需要打电话`notifyDataSetChanged()`）。

例如，如果您使用过滤器，ArrayAdapter 可以在内部使用另一个列表，除了不好的做法，因为 ArrayAdapter 可以只对构造函数中传递的该列表进行防御性副本（尽管它没有）。它使用内部锁来保护该列表。所以真的不应该在外面修改它。

# api - CakePHP 2.0 使用 _serialize 给出空响应

> ID：14006719
> 
> 赞同：0
> 
> 时间：2012-12-22T21:27:58.283
> 
> 标签：api, cakephp-2.0

我正在使用序列化键以 json 格式输出数据。有没有办法什么都不输出，只是一个以 application/json 作为内容类型的空响应？我试过 null、一个空字符串和一个空数组作为序列化值，但似乎没有任何效果。

参考：[http ://book.cakephp.org/2.0/en/views/json-and-xml-views.html#using-data-views-with-the-serialize-key](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html#using-data-views-with-the-serialize-key)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T05:09:16.277

您不必使用 _serialize 方法，而是使用自定义视图。见：[http ://book.cakephp.org/2.0/en/views/json-and-xml-views.html#using-a-data-view-with-view-files](http://book.cakephp.org/2.0/en/views/json-and-xml-views.html#using-a-data-view-with-view-files)

您可以使所有操作都使用相同的视图文件，`$this->render('my_custom_view');`而不是为每个操作创建一个新的视图文件。

# height - CSS - 高度：100% 与最小高度：100%；

> ID：14006720
> 
> 赞同：4
> 
> 时间：2012-12-22T21:28:00.223
> 
> 标签：height, css

所以在我的代码中我有一个粘性页脚。粘性页脚具有带有 的 #wrap`min-height`容器`100%`。但是`min-height`你不能`height:100%`在 wrap div 内的对象上使用。

所以我添加`height:100%`了，但是当窗口高度太小时，它会通过使页脚滚动到 wrap div 中的内容来混淆布局。

有人对此有修复吗？

```
<div id="wrap">
    <div id="main">
        <div id="content">

        </div>
    </div>
    <div class="clearfooter"></div>
</div>
<div id="footer">

</div> 
```

CSS：

```
*{
    padding: 0px;
    margin: 0px;
}
html, body {
    height: 100%;
}
body{
    color: #FFF;
    background-image:url('../images/black_denim.png');
}
#wrap {
    min-height: 100%;
    margin-bottom: -200px;
    position: relative;
}
#topBanner{
    width: 200px;
    margin: 0px auto;
}
.clearfooter {
    height: 200px;
    clear: both;
}
/* footer */
#footer { 
    position: relative;
    height: 200px;
    width: 100%;
    min-width: 960px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:44:19.320

如果您只需要一个不覆盖任何正文内容的粘性页脚，那么只需给页脚一个固定位置，并将正文底部的填充设置为等于页脚高度。

```
body{ 
    padding-bottom:200px;
}

#footer { 
    position: fixed;
    bottom:0;
    height: 200px;
    width: 100%;
} 
```

编辑：

如果您担心在非常小的屏幕上，固定页脚覆盖了大部分屏幕，那么除了可能使用 css 媒体查询或 javascript 动态隐藏页脚之外，没有其他解决方法。

许多移动浏览器不支持固定位置，正是因为它们覆盖了大部分屏幕。

# ajax - Spring 与 AJAX 集成

> ID：14006723
> 
> 赞同：1
> 
> 时间：2012-12-22T21:28:48.847
> 
> 标签：ajax, spring, spring-mvc

所以我能够成功地将 AJAX 请求与 Spring MVC 集成。但是，我有一个问题——如果我单击表单的“提交”按钮，我的@Controller 类会检测到 url 并返回一个 ModelAndView。但是，我想要的是先有一个AJAX检查，如果表单提交不成功（例如，空白字段），返回一个AJAX响应。否则，照常进行并显示 ModelAndView。但是，我不知道如何同时集成两者。

任何想法或教程表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:34:44.440

你有几个选择：

*   使用 AJAX 时将表单提交到特定的不同 URL
*   使用AJAX发帖时在请求中添加特定参数，并使用该特定参数检查请求是否为n个AJAX请求
*   测试`X-Requested-With`请求标头是否存在并包含`XMLHttpRequest`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T13:41:18.447

我会走 PJAX 路线或也称为 HiJax 的路线。

基本上，如果它是使用标头的 AJAX 请求，则返回页面的子集。大多数人不仅仅是在他们的视图/模板中使用条件来决定包含完整的或无 chrome 的 HTML。

# xna - errorX3013：顶点着色器不采用 0 个参数

> ID：14006730
> 
> 赞同：0
> 
> 时间：2012-12-22T21:30:08.963
> 
> 标签：xna, hlsl

我开始使用 Shader Model 4.0，并且正在尝试设置一个基本的示例项目。（基本上是渲染和点亮一个立方体）

但是自动取款机。我完全停留在最基本的部分。我的顶点着色器不会编译并出现以下错误消息：

错误 1 ​​编译错误 ...\x.fx:

...\x.fx(32,43): **error X3013: 'VertexShaderFunction': function does not take 0 parameters** ...\x.fx 32 43 ...

到目前为止我的代码：

```
float4x4 World;
float4x4 View;
float4x4 Projection;

struct VS_INPUT
{
    float4 Position : POSITION;
};

struct VS_OUTPUT
{
    float4 Position : POSITION;
};

VS_OUTPUT VertexShaderFunction(in VS_INPUT input)
{
    VS_OUTPUT output;

    float4 worldPosition = mul(input.Position, World);
    float4 viewPosition = mul(worldPosition, View);
    output.Position = mul(viewPosition, Projection);

    return output;
}

technique Technique1
{
    pass Pass1
    {
        SetVertexShader( Compile( vs_4_1, VertexShaderFunction() ) );
        SetGeometryShader(NULL);
        SetPixelShader( NULL );
    }
} 
```

VS_INPUT 参数清楚地标记为输入而不是统一的。该结构为每个成员（也是唯一的一个）分配一个输入语义。有谁知道为什么编译不正确？

我正在使用**Win7 Ultimate + DirectX11 + XNA GameStudio 4.0**，我的显卡是**Intel GMA 4500MHD**（所以它应该允许着色器模型 4.0）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T22:42:58.223

我走了，回答我自己的问题 - 多么愚蠢的错误（而且很难找到）：

它是 CompileShader() 而不是 Compile()

# android - 在android中的文件中读取前一行

> ID：14006732
> 
> 赞同：-1
> 
> 时间：2012-12-22T21:30:26.103
> 
> 标签：android

我可以读取存储在资产文件夹中的文件中的下一行。但是如何通过单击按钮来阅读上一行。我的文件存储在 assets 文件夹中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:52:52.623

如果你有一个小文件，只需从第一行开始读取所有前面的行到你可以读取的行，甚至到最后一行，用“\n”分割它们并通过它的索引获取上一行，这不是一个好方法，但是我建议您发布您的代码，以便我们可以更好地帮助您^_*

# python - Python NumPy 无法正确调整大小

> ID：14006741
> 
> 赞同：0
> 
> 时间：2012-12-22T21:30:58.800
> 
> 标签：python, arrays, numpy, resize

为什么这段代码不起作用？我无法让这个 numpy 数组正确调整大小。

```
import numpy
a = numpy.zeros((10,10))
a[3,2] = 8
a.resize((5,5))
if a[3,2] == 8:
    print "yay"
else:
    print "not working"
raw_input() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T21:47:57.090

从文档 [ `help(a.resize)`]：

```
Shrinking an array: array is flattened (in the order that the data are
stored in memory), resized, and reshaped:

>>> a = np.array([[0, 1], [2, 3]], order='C')
>>> a.resize((2, 1))
>>> a
array([[0],
       [1]]) 
```

在您的情况下，`[3,2]`当被视为展平数据列表时，它被存储在索引 32 中：

```
>>> a = numpy.zeros((10,10))
>>> a[3,2] = 8
>>> list(a.flat).index(8)
32 
```

32 >= 25，因此您的更改无法在调整大小后继续存在。如果您只想保留一些值，那么您可以使用

```
>>> a = a[:5, :5]
>>> a
array([[ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.],
       [ 0.,  0.,  8.,  0.,  0.],
       [ 0.,  0.,  0.,  0.,  0.]])
>>> a[3,2]
8.0 
```

或者如果你真的想要，你可以在调整大小之前复制数据：

```
>>> a = numpy.zeros((10,10))
>>> a[3,2] = 8
>>> a.flat[:(5*5)] = a[:5, :5].flat
>>> a.resize((5,5))
>>> a[3,2]
8.0 
```

但我不太明白这一点。[我不记得 resize 是如何处理内存的，但我不会担心。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T21:58:21.443

从文档中，[http://docs.scipy.org/doc/numpy/reference/generated/numpy.resize.html](http://docs.scipy.org/doc/numpy/reference/generated/numpy.resize.html)

> numpy.resize(a, new_shape)
> 
> 返回具有指定形状的新数组。
> 
> 如果新数组大于原始数组，则新数组中会填充 a 的重复副本。请注意，此行为与 a.resize(new_shape) 不同，后者用零填充，而不是 a 的重复副本。

对于您期望的行为，您需要手动复制您希望新数组保留的值，例如

```
a=a[:5,:5] 
```

# android - android:screenOrientation="portrait" 在一个中文键盘上不起作用

> ID：14006742
> 
> 赞同：0
> 
> 时间：2012-12-22T21:30:59.800
> 
> 标签：android, android-listview, orientation, android-ui

我已经制作了应用程序并将其设置为具有`portrait`main `<activity>`in 的方向`ActivityManifest.xml`。它`portrait`在所有设备上，除了一个中文无名键盘。还有其他应用程序可以正确处理该垫上的方向。

我希望纵向屏幕宽度小于高度。

我的两个问题是：-

1.  设置方向的最佳方法是什么？我是否必须检查屏幕宽度/高度并相应地旋转屏幕？

2.  该方向错误有多普遍？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T12:09:27.147

你可能会看到[这个](https://stackoverflow.com/questions/13844577/androidscreenorientation-portrait-is-ignored-in-jellybean)答案。这是针对 Jellybean 错误的，但相同的代码也可能适用于其他版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T12:02:49.177

`ActivityManifest.xml`方法已经足够好了。我的越野车无名中文键盘是我目前看到的唯一设备。

# wolfram-mathematica - 如何在 Mathematica 中构造小于 n 的所有斐波那契数列

> ID：14006743
> 
> 赞同：3
> 
> 时间：2012-12-22T21:31:01.733
> 
> 标签：wolfram-mathematica

我想编写一个 Mathematica 函数，该函数构造一个包含所有小于 n 的斐波那契数的列表。此外，我想尽可能优雅和功能性地做到这一点（所以没有明确的循环）。

从概念上讲，我想获取一个无限的自然数列表，将 Fib[n] 映射到它上面，然后从这个列表中获取小于 n 的元素。我怎样才能在 Mathematica 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-28T18:40:20.117

第一部分可以在*Mathematica*中相当容易地完成。下面，我提供了两个函数`nextFibonacci`，它提供了下一个大于输入数字的斐波那契数（就像`NextPrime`）和`fibonacciList`，它提供了一个小于输入数字的所有斐波那契数的列表。

```
ClearAll[nextFibonacci, fibonacciList]
nextFibonacci[m_] := Fibonacci[
    Block[{n}, 
        NArgMax[{n, 1/Sqrt[5] (GoldenRatio^n - (-1)^n GoldenRatio^-n) <= m, n ∈ Integers}, n]
    ] + 1
]
nextFibonacci[1] := 2;

fibonacciList[m_] := Fibonacci@
    Range[0, Block[{n}, 
      NArgMax[{n, 1/Sqrt[5] (GoldenRatio^n - (-1)^n GoldenRatio^-n) < m, n ∈ Integers}, n]
    ]
] 
```

现在您可以执行以下操作：

```
nextfibonacci[15]
(* 21 *)

fibonacciList[50]
(* {0, 1, 1, 2, 3, 5, 8, 13, 21, 34} *) 
```

但是，第二部分很棘手。您正在寻找的是 Haskell 类型的惰性评估，它只会在必要时评估（否则，您无法在内存中保存无限列表）。例如，类似（在 Haskell 中）：

```
fibs = 0 : 1 : zipWith (+) fibs (tail fibs) 
```

然后允许您执行以下操作

```
take 10 fibs
-- [0,1,1,2,3,5,8,13,21,34]

takeWhile (<100) fibs
-- [0,1,1,2,3,5,8,13,21,34,55,89] 
```

不幸的是，没有对您想要的内容的内置支持。但是，您可以扩展*Mathematica*以实现惰性样式列表，如[本答案](https://mathematica.stackexchange.com/a/885)所示，它也[作为包实现](https://mathematica.stackexchange.com/a/4093)。现在你已经拥有了你需要的所有部分，我会让你自己处理这个。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-28T23:24:29.170

如果你从 GitHub获取我的[Lazy 包，你的解决方案很简单：](https://github.com/sblom/mathematica-lazy)

```
Needs["Lazy`"]
LazySource[Fibonacci] ~TakeWhile~ ((# < 1000) &) // List 
```

如果您想稍微从字面上实现您的原始描述

> 从概念上讲，我想获取一个无限的自然数列表，将 Fib[n] 映射到它上面，然后从这个列表中获取小于 n 的元素。

你可以这样做：

```
Needs["Lazy`"]
Fibonacci ~Map~ Lazy[Integers] ~TakeWhile~ ((# < 1000) &) // List 
```

为了证明这完全是惰性的，请尝试前面没有`// List`结尾的示例。你会看到它以（相当丑陋的）形式停止：

```
LazyList[First[ 
  LazyList[Fibonacci[First[LazyList[1, LazySource[#1 &, 2]]]], 
   Fibonacci /@ Rest[LazyList[1, LazySource[#1 &, 2]]]]], 
 TakeWhile[
  Rest[LazyList[Fibonacci[First[LazyList[1, LazySource[#1 &, 2]]]], 
    Fibonacci /@ Rest[LazyList[1, LazySource[#1 &, 2]]]]], #1 < 
    1000 &]] 
```

这包括一个`LazyList[]`表达式，其第一个元素是您正在延迟评估的表达式的第一个值，其第二个元素是有关如何继续扩展的指令。

## 改进

一直不停地调用有点低效`Fibonacci[n]`，尤其是当`n`开始变大时。实际上可以构造一个惰性生成器，它会在我们流式传输时计算斐波那契数列的当前值：

```
Needs["Lazy`"]

LazyFibonacci[a_,b_]:=LazyList[a,LazyFibonacci[b,a+b]]
LazyFibonacci[]:=LazyFibonacci[1,1]

LazyFibonacci[] ~TakeWhile~ ((# < 1000)&) // List 
```

最后，我们可以将其推广到一个更抽象的生成函数，它为累加器获取初始值，a `List`of `Rule`s 用于计算下一步的累加器值，a `List`of `Rule`s 用于根据当前累加器值计算结果。

```
LazyGenerator[init_, step_, extract_] := 
 LazyList[Evaluate[init /. extract], 
  LazyGenerator[init /. step, step, extract]] 
```

并且可以使用它来生成斐波那契数列，如下所示：

```
LazyGenerator[{1, 1}, {a_, b_} :> {b, a + b}, {a_, b_} :> a] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-28T17:28:08.320

好的，我希望我理解了这个问题。但请注意，我不是纯数学专业的，我是机械工程专业的学生。但这听起来很有趣。所以我查了公式，这就是我现在能想到的。我必须运行，但如果有错误，请告诉我，我会修复它。

这个操作要求`n`然后列出所有小于 n 的斐波那契数。没有循环可以找到小于 的斐波那契数`n`。它用于`Reduce`求解小于 的斐波那契数`n`。我接受了结果的底限，还扔掉了一个常数，该常数在解决方案中产生了一个复数乘数。

`Fibonacci`然后使用 Mathematica命令简单地制作所有这些数字的表格。所以如果你输入`n=20`它会列出`1,1,2,3,5,8,13`等等。由于内存不足（我的电脑上只有 8 GB 内存），我可以无限执行此操作。

我将限制`n`随意`500000`编辑和更改代码。

![数学图形](../Images/d00263d30292eaf17142dc400d3f521b.png)

```
Manipulate[
 Module[{k, m}, 
  k = Floor@N[Assuming[Element[m, Integers] && m > 0, 
        Reduce[f[m] == n, m]][[2, 1, 2]] /. Complex[0, 2] -> 0];
  TableForm@Join[{{"#", "Fibonacci number" }}, 
    Table[{i, Fibonacci[i]}, {i, 1, k}]]
  ],

  {{n, 3, "n="}, 2, 500000, 1, Appearance -> "Labeled", ImageSize -> Small}, 
  SynchronousUpdating -> False, 
  ContentSize -> {200, 500}, Initialization :>
  {
   \[CurlyPhi][n_] := ((1 + Sqrt[5])/2)^n;
   \[Psi][n_] := -(1/\[CurlyPhi][n]);
   f[n_] := (\[CurlyPhi][n] - \[Psi][n])/Sqrt[5];
   }] 
```

截屏

![数学图形](../Images/2eb5080a8ec61363d8ed6c016e8e7ff8.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-20T01:09:03.730

`k=Floor[Log[GoldenRatio,Fk]*Sqrt[5]+1/2]]`斐波那契数 Fk的 索引 k 是[https://en.wikipedia.org/wiki/Fibonacci_number](https://en.wikipedia.org/wiki/Fibonacci_number)。因此，小于*或等于*n 的斐波那契数列是

```
 FibList[n_Integer]:=Fibonacci[Range[Floor[Log[GoldenRatio,Sqrt[5]*n+1/2]]]] 
```

# matlab - 如何在 GUI 中更改输出结果的位置

> ID：14006745
> 
> 赞同：0
> 
> 时间：2012-12-22T21:31:55.750
> 
> 标签：matlab, user-interface, position

这里有没有人知道如何将GUI matlab中的输出位置更改为框的右侧而不是中心？

我想我必须更改结果文本框的一些属性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:38:28.607

*   看看这篇文章：[数字的定位](http://www.mathworks.com/help/matlab/creating_plots/positioning-figures.html)

图形位置属性控制图形窗口在屏幕上的大小和位置。监视器屏幕大小是根 Handle Graphics 对象的一个​​属性。启动时，MATLAB 软件会确定计算机屏幕的大小并为 Position 定义默认值。此默认设置创建大约四分之一屏幕最小范围的图形，并将它们从左到右居中放置在屏幕的上半部分。位置向量

MATLAB 将图窗 Position 属性定义为向量。因此，您可以在其中使用图形和文本，例如

```
figure(gcf)
text(offsetX1, offsetX1, ['result 1: ' num2str(result1)])
text(offsetX2, offsetX2, ['result 2: ' num2str(result2)]) 
```

*   [在 MATLAB GUI 中显示分析结果](https://stackoverflow.com/questions/964268/displaying-analytical-results-in-a-matlab-gui) 这篇文章讨论了添加一个带有结果的静态文本框并定位它。

*   [将 GUI 图形移动到屏幕上的指定位置：](http://www.mathworks.com/help/matlab/ref/movegui.html)

句法：

```
movegui(h,'position')
movegui(position)
movegui(h)
movegui 
```

***答案几乎是试图掩盖问题的模糊性***

# java - 为什么 Java 日历报告的日期不正确？

> ID：14006747
> 
> 赞同：2
> 
> 时间：2012-12-22T21:32:10.453
> 
> 标签：java, date, calendar

谁能告诉我为什么今天 22 日（英国）控制台中显示“5”？！

```
System.out.println(Calendar.DAY_OF_MONTH); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-22T21:33:08.133

`Calendar.DAY_OF_MONTH`是用于各种操作的常量（并且恰好是它的值是`5`），您应该使用：

```
Calendar.getInstance().get(Calendar.DAY_OF_MONTH); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T21:32:51.850

这是`static`Calendar 类中使用的字段，您需要以下内容

```
calendarInstance.get(Calendar.DAY_OF_MONTH); 
```

* * *

**看**

*   [`Calendar.DAY_OF_MONTH`](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Calendar.html#DAY_OF_MONTH)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-22T21:34:10.303

您需要构建一个日历实例，然后使用该静态字段来查找月份中的哪一天。

```
Calendar cal = Calendar.getInstance();
System.out.println(cal.get(Calendar.DAY_OF_MONTH)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T21:59:56.963

Calendar.DAY_OF_MONTH 或任何其他日历常量不会自动设置为日期，因此请返回它们的默认值。

```
public final static int DAY_OF_MONTH = 5; 
```

# ajax - 使用 ajax 加载 youtube 框架的 ajax 加载，其中 youtube id 是文本输入

> ID：14006750
> 
> 赞同：1
> 
> 时间：2012-12-22T21:32:34.850
> 
> 标签：ajax, wordpress, jquery, youtube

我在 wordpress 主题中为我的自定义帖子类型创建了元框。我的元字段包含文本类型。此文本类型的输入值是 youtube 视频 ID。Youtube 视频预览仅在发布该帖子后更新。如何更新视频 url 并在不发布该帖子的情况下立即查看预览。

```
add_action('save_post', 'my_metabox_save');
add_action( 'add_meta_boxes', 'my_metabox' );

function my_metabox () {

add_meta_box('my_metabox_id', "my metabox", 'my_metabox_cb', 'custome-post', 'normal', 'high');

}

##### MY metabox callback ########
function my_metabox_cb () {

wp_nonce_field( plugin_basename(__FILE__), 'myplugin_noncename' );

?>

//////////////////////////////////////////////////////////////////////////

<div class="my-video-id>
<h2>Enter Youtube Video ID</h2>

<input type="text" style="width: 100%;" name="my_youtube_id" value="<?php echo get_post_meta($_GET['post'], 'my_youtube_id', true); ?>" />

<?php if (get_post_meta($_GET['post'], 'my_youtube_id', true) != "") : ?>

<h2>youtube video box</h2>

<object width="600" height="400"><param name="movie" value="http://www.youtube.com/v/a6GCy_lKYo8?fs=1&amp;hl=en_US"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/<?php echo get_post_meta($_GET['post'], 'my_youtube_id', true); ?>?fs=1&amp;hl=en_US" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="400" height="300"></embed></object>

</div>

////////////////////////////////////////////////////////////////////////////////////////////////

}

function my_metabox_save ($post_id) {

 if ( !wp_verify_nonce( $_POST['myplugin_noncename'], plugin_basename(__FILE__) )) {
    return $post_id;
  }

  if ( defined('DOING_AUTOSAVE') && DOING_AUTOSAVE )
    return $post_id;

  if ( 'page' == $_POST['post_type'] ) {
    if ( !current_user_can( 'edit_page', $post_id ) )
      return $post_id;
  } else {
    if ( !current_user_can( 'edit_post', $post_id ) )
      return $post_id;
  }

 update_post_meta($post_id, 'my_youtube_id', $_POST['my_youtube_id'],true); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T21:40:57.027

我第一次误读了这个问题。要解决它，是一个 jQuery 的问题：从输入框中获取值并修改嵌入视频 div 的 HTML。一个例子：

```
add_action( 'add_meta_boxes', 'my_metabox' );

function my_metabox () {
    add_meta_box(
        'my_metabox_id', 
        "my metabox", 
        'my_metabox_cb', 
        'custome-post', 
        'normal', 
        'high'
    );
}

function my_metabox_cb () {
    ?>
        <div class="my-video-id">
            <h2>Enter Youtube Video ID</h2>
            <input type="text" style="width: 100%;" id="yt-id" value="" />
            <div id="yt-metabox"></div>
            <button id="yt-refresh">Refresh</button>
        </div>

        <script type="text/javascript">
        jQuery(document).ready(function($) {   
            $("#yt-refresh").click(function (e) {
                e.preventDefault();
                var yt_id = $('#yt-id').val();
                $('#yt-metabox').html('<object width="600" height="400"><param name="movie" value="http://www.youtube.com/v/a6GCy_lKYo8?fs=1&amp;hl=en_US"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/' + yt_id + '?fs=1&amp;hl=en_US" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="400" height="300"></embed></object>');
            });
        });
        </script>
    <?php
} 
```

# c# - 得墨忒耳定律也适用于属性吗？

> ID：14006762
> 
> 赞同：8
> 
> 时间：2012-12-22T21:34:38.647
> 
> 标签：c#, design-patterns, law-of-demeter

得墨忒耳定律说对象不能从对象 A 调用对象 B 的方法 M。但它也适用于属性吗？例子？

```
public class B{
     public bool IsValid();
}

public class A{
     public B B{get;set;}
} 
```

我可以做这样的事情吗？

```
var isValid = new A().B.IsValid() 
```

或者我应该这样做：

```
public class B{
     public bool IsValid();
}

public class A{
     private B B{get;set;}

     public bool IsValid(){
          return B.IsValid();
     }
}

var result = new A().IsValid(); 
```

如果我从 A 访问 B 的方法，是否有问题（根据法律）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-22T21:36:41.020

是的，它也适用于属性，因为此代码的客户端：

```
var isValid = new A().B.IsValid(); 
```

耦合到`A`也耦合到`B`。

在修复 Demeter 违规行为时，您必须平衡脱钩的需要和保持责任明确分离的需要。有时您可以创建得墨忒耳变形器：具有太多不相关方法的类只是为了遵守得墨忒耳法则。

**更新**：可以在[这篇文章](http://securesoftwaredev.com/2008/06/16/the-law-of-demeter/)中找到 Demeter 变形器的示例：

> 例如，考虑一个试图亲吻他的老板的人：`sendFlowers(john.getManager().getSpouse())`. 在此处应用 Hide Delegate 将`getManagersSpouse()`在 Employee 中产生一个方法。呸。

# jquery - CSS 根据 URL 模式突出显示目录中的活动链接

> ID：14006764
> 
> 赞同：3
> 
> 时间：2012-12-22T21:34:56.657
> 
> 标签：jquery, css

我有一个 div，其中包含一个 UL 元素以及我的每个页面的目录。

目前，我不得不在活动元素（class="active"）上硬编码一个特殊的类。但是，我正在尝试通过将 href 与浏览器的当前 URL 匹配来查看是否可以使用 CSS3 来完成这项工作。

例如，如果 toc div 的锚点中的 href 与页面的当前 URL 匹配，则为其添加特殊格式。

示例网址： http: [//mysite.com/page-title/2](http://mysite.com/page-title/2)

标记：

```
<div class="toc">
    <h3>Table of Contents</h3>
    <ul>
        <li><a href="http://mysite.com/page-title/">Part 1</a></li>
        <li><a href="http://mysite.com/page-title/2">Part 2</a></li>
        <li><a href="http://mysite.com/page-title/3">Part 3</a></li>
    </ul>
</div> 
```

在上面的示例中，我想对第二个列表项元素应用特殊的 css 格式，因为它的 HREF 模式与 URL 模式匹配“/2”。

如果这不能通过 CSS 实现，如果您可以提供 jQuery 代码，我可以将它放在我的 jQuery 脚本中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T21:45:53.283

使用 jQuery 类似下面的东西应该可以工作；

```
var urlString = window.location; // or try window.location.pathname

$('a[href="' + urlString + '"]').addClass("active"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:49:13.220

这里不需要 JavaScript。只需将一个类添加到与当前页面对应的 body 标记，然后将相同的类添加到导航项。然后为匹配的集合创建一个 css 规则，如下所示：

```
<body class="products">
<div class="toc">
    <h3>Table of Contents</h3>
    <ul>
        <li><a href="http://mysite.com/page-title/" class="products-nav">Product Overview</a></li>
        <li><a href="http://mysite.com/page-title/2" class="home-nav">A More Dynamic Home Page</a></li>
        <li><a href="http://mysite.com/page-title/3" class="images-nav">Featured Images on Steroids</a></li>
    </ul>
</div> 
```

和

```
<body class="home">
<div class="toc">
    <h3>Table of Contents</h3>
    <ul>
        <li><a href="http://mysite.com/page-title/" class="products-nav">Product Overview</a></li>
        <li><a href="http://mysite.com/page-title/2" class="home-nav">A More Dynamic Home Page</a></li>
        <li><a href="http://mysite.com/page-title/3" class="images-nav">Featured Images on Steroids</a></li>
    </ul>
</div> 
```

等等然后：

```
.products .products-nav, .home .home-nav, .images .images-nav {
    font-weight: bold;
} 
```

# javascript - 如何使用 JavaScript 或 CSS 仅显示 H2 标题的第一个单词

> ID：14006766
> 
> 赞同：0
> 
> 时间：2012-12-22T21:35:28.747
> 
> 标签：javascript, html, css

我只是想知道，有什么方法可以只显示 h2 标题中的第一个单词。

例如：

在源代码中它应该看起来像这样

```
<h2> Stackoverflow is an Ideal Place</h2> 
```

但是，在实时网站上，它应该看起来像这样

```
Stackoverflow 
```

基本上，我们希望显示整个标题中的第一个单词。但是，搜索引擎应该阅读完整的标题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:42:29.810

试试这个方法

```
$(document).ready(function(){
    var ac = $("#ac").text().split(' '); 
    $("#ac").text(ac[0])
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:55:11.053

你不能只用 CSS 来做到这一点。您有第一个字母、第一行但没有第一个单词的伪元素选择器。

您可以设置宽度，以便只有第一个单词可见（`overflow:hidden`当然也可以使用），但这对于所有字体系列和大小而言并非万无一失。

最后，您可以使用纯 JavaScript 或 jQuery 来完成。

纯JS：

```
var el = document.getElementById("ac");
el.innerHTML = el.innerHTML.split(/\s/)[0]; 
```

jQuery：

```
$("#ac").html(function(i, h) { return h.split(/\s/)[0];}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T22:00:10.697

这将做你想做的事......

```
<h2 id="ac">Stackoverflow is an Ideal Place</h2>​

$('#ac').html( function(i, h) {
    var words = h.split(/\s/);
    return ' <h2>' + words[0] + '</h2>';
});​ 
```

# html - 使用 CSS '+' 运算符更改显示值

> ID：14006768
> 
> 赞同：-1
> 
> 时间：2012-12-22T21:35:51.783
> 
> 标签：html, css

我正在尝试使用 CSS 创建一个下拉菜单，它以使用以下内容为中心：

```
#submenu_div {
  display: none;
}

#li_id:hover + #submenu_div {
  display: block;
} 
```

编辑：

这是整个事情的固定HTML。

```
<ul id="main_nav">
  <a href=""><li id="li_id">Home</li></a>
  <ul id="sub_who">                                                                                                                                     
    <li>Foo</li>
  </ul>
</ul> 
```

#submenu_div 位于前面代码所指的 li 所在的 ul 的父 div 之外。据我所知，这应该有效。但我显然做错了什么，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:40:01.267

> #submenu_div 位于前面代码所指的 li 所在的 ul 的父 div 之外。

`+`组合器*只*寻找一个真正的兄弟元素，即与.左侧匹配的元素具有*相同父*`+`元素的元素。你不能让它匹配其他任何东西。您将需要更改您的 HTML（因此它`#submenu_div`是 的真正兄弟`#li_id`）或您的 CSS（因此 LHS 上的东西`+`是 的真正兄弟`#submenu_div`）或两者兼而有之。

如果没有看到您的 HTML 结构，我无法给出更准确的建议。

# c++ - C++ 调用一个对象的方法，你只需要一次

> ID：14006774
> 
> 赞同：1
> 
> 时间：2012-12-22T21:36:40.040
> 
> 标签：c++

我不记得它叫什么了，但我知道我可以在 Java 中做到这一点。假设我有以下内容：

```
class Foo
{
public:
    Foo() {};
    void bar() {};
}; 
```

我想做这个：

```
int main() {
    (new Foo).bar();
} 
```

但这似乎不起作用。有没有类似的方法可以做到这一点而不必这样做：

```
int main() {
    Foo foobar;
    foobar.bar();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T21:39:20.493

`new`动态分配内存并返回一个指针。类成员是使用间接运算符获得的`->`。我认为这不是您要寻找的东西，因为您冒着导致内存泄漏的风险。简单地调用 的构造函数就`Foo`可以让我们做我们想做的事：

```
Foo().bar(); 
```

通过调用 的构造函数`Foo`，我们创建了一个临时对象，我们可以从中获取它的数据成员。这比指针更可取，因为我们不必处理内存泄漏和指针删除。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T21:38:21.990

你可以说`(new Foo)->bar();`。这行得通，但绝对是愚蠢的。正确的是：

```
int main()
{
    Foo x;
    x.bar(); 
} 
```

或者，如果您不想要局部变量：`Foo().bar();`. 但现在这是有问题的，因为如果你不需要`Foo`有状态，那么你可能根本不需要一个类。只需创建`bar`一个**免费函数**（Java 中不存在的东西）：

```
void bar();

int main()
{
    bar();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T21:38:51.350

是的，`Foo().bar();`。无需`new`像在 Java 中那样使用。

# c++ - 在 PySide (Qt) 中打开另一个程序并在原始窗口中显示

> ID：14006777
> 
> 赞同：4
> 
> 时间：2012-12-22T21:36:58.683
> 
> 标签：c++, python, qt, pyqt, pyside

我有一个 PySide 应用程序。我想创建一个小部件，我将在其中显示另一个应用程序（例如 SFML/Irrlicht/Ogre/whatever 游戏，它将是独立的 .exe 而不是 python 脚本），并且该小部件将充当该进程的主窗口。这可能吗？

我不需要与该应用程序进行任何通信，我将通过套接字进行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T21:42:12.573

到目前为止，最简单的方法就是使用 python 的 os.spawn、os.system 或 subprocess 模块来启动第二个进程。它将在独立于您的应用程序的自己的窗口中启动。

如果你真的想在你的主窗口中嵌入子进程，有几个选项。查看这个问题的答案：[Subprocess as QT widget](https://stackoverflow.com/questions/8094681/subprocess-as-qt-widget)

# html - 在 octopress 帖子中添加锚点

> ID：14006778
> 
> 赞同：4
> 
> 时间：2012-12-22T21:37:00.193
> 
> 标签：html, markdown, jekyll, octopress

我正在使用 Octopress，我知道为了在我的帖子中添加图片，而不是写：

```
<img src="src" alt="alt" class="class" /> 
```

我可以写：

```
{% img class src alt %} 
```

而且，如果写：

```
<a href="href">text</a> 
```

我可以写：

```
[text](href) 
```

但是我该怎么写：

```
<a href="href" target="target">text</a> 
```

?

如果这是不可能的，唯一的解决方案是编写 html 标记，我可以在哪里以及如何添加 ruby​​ 代码将其翻译为例如：`[text](href target)`to this: `<a href="href" target="target">text</a>`？

此外，我在哪里可以找到所有这些 html octopress 快捷方式的列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-30T12:06:20.067

这实际上是由用于处理文本的 Markdown 引擎而不是任何 Octopress 代码控制的。根据您使用的引擎，您可以编写

```
[text](href){: target="target" } 
```

这称为“内联属性列表”，是 Markdown 语法的扩展。它得到[Maruku](http://maruku.rubyforge.org/proposal.html)和[Kramdown](http://kramdown.rubyforge.org/syntax.html#inline-attribute-lists)的支持。

（请注意，Maruku 是 Jekyll 的默认 Markdown 引擎，因此如果您没有接触过配置的这方面，则支持此语法。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-06T16:43:03.793

这`{% img class src alt %}`是一个 octopress 标签，请参阅[插件文档](http://octopress.org/docs/)了解更多标签。

`[text](href)`遵循[markdown sintax](https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet)，并且不允许您向元素添加类、属性或 id。

因此，要解决目标问题，请在自定义标题布局中使用下面的片段，并在 url 末尾添加[锚点](https://gist.github.com/wagnerpinheiro/9392929)`#_blank`，以在新窗口中打开。

```
<script type="text/javascript">
function addBlankTargetForLinks () {
    $('a[href^="http"],a[href*="#_blank"]').each(function(){
        $(this).attr('target', '_blank');
    });
}

$(document).bind('DOMNodeInserted', function(event) {
    addBlankTargetForLinks();
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-30T12:11:21.510

### 使用 Markdown 语法：

```
[text](#target) 
```

### 为了`<a href="href" target="target">text</a>`

```
[text](href){: target="target" } 
```

# c - 使用布尔值的条件表达式会产生意外的结果

> ID：14006786
> 
> 赞同：0
> 
> 时间：2012-12-22T21:38:28.217
> 
> 标签：c, boolean

```
#include <stdio.h>
#include <stdbool.h>
#include <math.h>

int main() {        
    int num;
    int i;
    int prime = true;

    // omitted for brevity

    if (prime = true) {
        printf("The number is prime\n");    
    }
    else {
        printf("The number isn't prime\n");
    }
} 
```

我正在尝试编写一个程序来检查一个数字是否是素数，但它总是说这个数字是素数。答案可能非常明显，但我是个大菜鸟。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T21:40:16.407

至少，

```
if (prime = true) 
```

应该

```
if (prime == true) 
```

，但最好只是

```
if (prime) 
```

否则赋值的结果就是赋值`prime = true`的值，这是真的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T21:39:45.427

```
if (prime = true) 
```

应该

```
if (prime == true) 
```

反而。

`=`是赋值运算符，您正在寻找相等运算符`==`。

确保在编译程序时启用警告并修复代码中的所有警告。一个体面的程序不应该产生任何警告。

# objective-c - 使用 CADisplayLink 的 iOS 动画

> ID：14006802
> 
> 赞同：0
> 
> 时间：2012-12-22T21:40:53.667
> 
> 标签：objective-c, cocoa-touch, animation

我正在使用 CADisplayLink 的动画和计时。当球碰到一块大石头时，它会立即被移走。我如何为石头（块）的移除设置动画，例如爆炸成小石头？这是我目前拥有的代码：

```
- (void)checkCollisionWithBlocks
{
    for (BlockView *bv in blocks) {
        if (CGRectIntersectsRect(bv.frame, ballRect)) {
            ballVelocity.y = -ballVelocity.y;
            [blocks removeObject:bv];
            [bv removeFromSuperview];
            break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:58:36.897

CADisplayLink 确实有点……非常适合您的计划（用于将屏幕绘图更新同步到自定义动画）。这是我的解决方案：点燃一些东西！虽然不一定是爆炸，但这会导致你的方块喷出一些蓝色火焰（你可以通过修改来改变颜色`self.fireColor`）。

```
- (void)checkCollisionWithBlocks
{
    for (BlockView *bv in blocks) {
        if (CGRectIntersectsRect(bv.frame, ballRect)) {
            ballVelocity.y = -ballVelocity.y;
            [blocks removeObject:bv];
            [bv burpFire]
            [bv removeFromSuperview];
            break;
        }
    }
}

@interface BlockView : UIView 

@property (nonatomic, strong) CALayer *rootLayer;
@property (nonatomic, strong) CAEmitterLayer *fireEmitter;
@property (nonatomic, strong) CAEmitterLayer *smokeEmitter;
@property (nonatomic, strong) UIColor *fireColor;
@property (nonatomic, strong) UIColor *smokeColor;

-(void)burpFire;

@end
@implementation BlockView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        self.rootLayer = [CALayer layer];

        //Set the root layer's background color to black
        self.rootLayer.backgroundColor = [UIColor blackColor].CGColor;

        //Create the fire emitter layer
        self.fireEmitter = [CAEmitterLayer layer];
        self.fireEmitter.emitterPosition = CGPointMake(0, CGRectGetMaxY(frame) + 50);
        self.fireEmitter.emitterMode = kCAEmitterLayerOutline;
        self.fireEmitter.emitterShape = kCAEmitterLayerLine;
        self.fireEmitter.renderMode = kCAEmitterLayerAdditive;
        self.fireEmitter.emitterSize = CGSizeMake(0, 0);

        //Create the smoke emitter layer
        self.smokeEmitter = [CAEmitterLayer layer];
        self.smokeEmitter.emitterPosition = CGPointMake(0, CGRectGetMaxY(frame) + 50);
        self.smokeEmitter.emitterMode = kCAEmitterLayerPoints;

        //Create the fire emitter cell
        CAEmitterCell* fire = [CAEmitterCell emitterCell];
        fire.emissionLongitude = M_PI;
        fire.birthRate = 0;
        fire.velocity = -80;
        fire.velocityRange = -30;
        fire.emissionRange = -1.1;
        fire.yAcceleration = -200;
        fire.scaleSpeed = 0.3;
        self.fireColor = [UIColor colorWithRed:0.425 green:0.779 blue:0.800 alpha:0.100];
        fire.color = self.fireColor.CGColor;
        fire.contents = (id)[self CGImageNamed:@"fire.png"];

        //Name the cell so that it can be animated later using keypaths
        [fire setName:@"fire"];

        //Add the fire emitter cell to the fire emitter layer
        self.fireEmitter.emitterCells = [NSArray arrayWithObject:fire] ;

        //Create the smoke emitter cell
        CAEmitterCell* smoke = [CAEmitterCell emitterCell];
        smoke.birthRate = 11;
        smoke.emissionLongitude = M_PI / 2;
        smoke.lifetime = 0;
        smoke.velocity = -40;
        smoke.velocityRange = 20;
        smoke.emissionRange = M_PI / 4;
        smoke.spin = 1;
        smoke.spinRange = 6;
        smoke.yAcceleration = 160;
        smoke.contents = (id) [self CGImageNamed:@"smoke.png"];
        smoke.scale = 0.1;
        smoke.alphaSpeed = -0.12;
        smoke.scaleSpeed = 0.7;

        //Name the cell so that it can be animated later using keypaths
        [smoke setName:@"smoke"];

        //Add the smoke emitter cell to the smoke emitter layer
        self.smokeEmitter.emitterCells = [NSArray arrayWithObject:smoke];

        //Add the two emitter layers to the root layer
        [self.layer addSublayer:self.smokeEmitter];
        [self.layer addSublayer:self.fireEmitter];

        [self burpFire];

    }
    return self;
}

//Return a CGImageRef from the specified image file in the app's bundle
-(CGImageRef)CGImageNamed:(NSString*)name {
    NSString *url = [[NSBundle mainBundle] pathForResource:name ofType:nil];
    return [UIImage imageWithContentsOfFile:url].CGImage;
}

-(void)burpFire {
    float gas = 80.0 / 100.0;
    //Update the fire properties
    [self.fireEmitter setValue:[NSNumber numberWithInt:(gas * 1000)] forKeyPath:@"emitterCells.fire.birthRate"];
    [self.fireEmitter setValue:[NSNumber numberWithFloat:gas] forKeyPath:@"emitterCells.fire.lifetime"];
    [self.fireEmitter setValue:[NSNumber numberWithFloat:(gas * 0.35)] forKeyPath:@"emitterCells.fire.lifetimeRange"];
    self.fireEmitter.emitterSize = CGSizeMake(100 * gas, 0);

    //Update the smoke properites
    [self.smokeEmitter setValue:[NSNumber numberWithInt:gas * 4] forKeyPath:@"emitterCells.smoke.lifetime"];
    self.smokeColor = [UIColor colorWithRed:1 green:1 blue:1 alpha:gas * 0.3];
    [self.smokeEmitter setValue:(__bridge id)self.smokeColor.CGColor forKeyPath:@"emitterCells.smoke.color"];

    [self setNeedsDisplay];

    [self performSelector:@selector(burpFinished) withObject:nil afterDelay:1.5];
}

-(void)burpFinished {
    float gas = 0.0 / 100.0;
    //Update the fire properties
    [self.fireEmitter setValue:[NSNumber numberWithInt:(gas * 1000)] forKeyPath:@"emitterCells.fire.birthRate"];
    [self.fireEmitter setValue:[NSNumber numberWithFloat:gas] forKeyPath:@"emitterCells.fire.lifetime"];
    [self.fireEmitter setValue:[NSNumber numberWithFloat:(gas * 0.35)] forKeyPath:@"emitterCells.fire.lifetimeRange"];
    self.fireEmitter.emitterSize = CGSizeMake(100 * gas, 0);

    //Update the smoke properites
    [self.smokeEmitter setValue:[NSNumber numberWithInt:gas * 4] forKeyPath:@"emitterCells.smoke.lifetime"];
    self.smokeColor = [UIColor colorWithRed:1 green:1 blue:1 alpha:gas * 0.3];
    [self.smokeEmitter setValue:(__bridge id)self.smokeColor.CGColor forKeyPath:@"emitterCells.smoke.color"];
} 
```

CAEmitterLayers 会持续很长一段时间，所以如果你想让火关得更快一点，可以调整停止选择器的时间。如果您想要更小或更大的火，或者持续时间更长的火球，请使用 init 方法中的属性，无论哪种方式，您都会获得很酷的效果。

[所有颜色都必须是对 UIColor 的强引用，否则 Core Animation 会吓坏并在调试器中引发 C++ 脾气暴躁……不愉快。]

# travis-ci - 如何在 .travis.yml 中获取 Travis 的构建工作目录？

> ID：14006810
> 
> 赞同：70
> 
> 时间：2012-12-22T21:42:12.807
> 
> 标签：travis-ci

使用 .travis.yml 时，是否有一个环境变量包含 Travis-CI 中当前构建目录的名称？[浏览这里](http://about.travis-ci.org/docs/user/ci-environment/#Environment-variables)的文档，我没有看到一个。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2013-07-16T17:28:00.007

您可能想要`$TRAVIS_BUILD_DIR`，这是我们在运行测试之前将存储库克隆到并`cd`随后进入的目录。

# unit-testing - moq-为什么不能使用默认参数操作函数

> ID：14006812
> 
> 赞同：0
> 
> 时间：2012-12-22T21:43:18.933
> 
> 标签：unit-testing, mocking, tdd

我正在尝试在一个非常简单的界面上进行单元测试。我的界面是：

```
public interface Interface1
    {
        string retStr(string dd);
        string retStr2(string dd,string fff);
    } 
```

这是模拟：

```
var myMoq = new  Mock<Interface1>();

myMoq.Setup(d => d.retStr("David")).Returns("retStr");
Console.WriteLine(myMoq.Object.retStr("fdf").ToString());
I GOT runtime error: Object reference not set to an instance of an object. 
```

和另一个实施错误：

```
myMoq.Setup(d => d.retStr2(It.Is<string>(e=>e=="qqq"), It.IsAny<string>())).Returns("2 parameters");
Console.WriteLine(myMoq.Object.retStr2("fdf","wewew").ToString()); 
```

为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:23:19.303

在您的设置中，您正在设置将传入特定字符串的期望（例如“David”）。

您告诉 Moq，“如果使用字符串“David”调用方法，则返回“retStr”，否则返回默认值（对于字符串，null）。因此，当您`.ToString()`对方法的结果执行 a 时，对象为空。

同样的事情也适用于第二个例子。

为了做出更通用的返回值，`It.IsAny<string>()`在设置方法时使用。或者，按照您在测试中的预期执行操作，并在调用该方法时发送“David”。

# c# - 如何将文本框中的所有元素添加到数组中？

> ID：14006815
> 
> 赞同：0
> 
> 时间：2012-12-22T21:43:51.777
> 
> 标签：c#, winforms

实际上，我的文本框遇到了问题，只是说这是我做的第一个 Visual C# 应用程序。

我只有很多文本框，大约 14 个文本框，我想要的是在用户在每个文本框中输入值后，我需要将此值保存在数组 Temp[] 中

例如 （

```
 textbox1.text=1  so Temp[0]=1

 textbox2.text=4  so Temp[1]=4 
```

等等....

我还为我的应用添加了一张图片：

![在此处输入图像描述](../Images/e75845b2f0325217fd35f03b464b57fd.png)

如您所见，用户必须为第一个集合输入值，为第二个集合输入另一个值，我需要将每个集合中输入的值保存在一个数组中，以便稍后显示集合的并集和交集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:54:15.267

尝试这个。
对于第一个面板，int a=0；

```
foreach (TextBox tbx in Panel1.Controls.OfType<TextBox>())
{
    Temp1[a]= tbx.text ;
    a++;
} 
```

对于第二面板 a=0;

```
foreach (TextBox tbx in Panel2.Controls.OfType<TextBox>())
{
    Temp2[a]= tbx.text ;
    a++;
} 
```

**编辑**：您必须在 panel1 中定义第一组文本框，在 panel2 中定义第二组文本框。

# java - 如何将纬度减少到小数点后4位

> ID：14006816
> 
> 赞同：2
> 
> 时间：2012-12-22T21:43:56.967
> 
> 标签：java, android

这是我关于这个主题的第二篇文章。我发现了几十篇关于这个主题的帖子，但没有一个可行的解决方案。位置侦听器将为您提供一个纬度，例如 3.734567E7。我的目标是将该纬度的准确性降低到小数点后四位。我不在乎我是截断它还是舍入它。以下代码...

```
 Double d = Double.parseDouble("3.734567E7");
    NumberFormat fmtr = new DecimalFormat("###.####");      
    String f = fmtr.format(d);
    Log.w(getClass().getName(), "result using DecimalFormat =     " + f );
    d = (double) Math.round(d * 10000.0) / 10000.0;
    Log.w(getClass().getName(), "result using math round =        " + d );
    f = d.toString();
    Log.w(getClass().getName(), "result string using math round = " + f ); 
```

产生三行：37345670 3.734567E7 3.734567E7

这些处理都不会对数字产生任何影响。

当我不得不在我的 Windows Phone 应用程序上使用 C# 执行此操作时，我执行了以下操作...

myExecution.latitude = Math.Round(newLatitude, 4); 我花了不到一分钟的时间。我有一个多星期的时间试图弄清楚如何在 java 中做同样的事情。据我所知，Java math.round 很奇怪，无法指定您希望舍入多少小数位以使其完全无用。

我意识到科学记数法只应该是一种显示值的方式，与数量的内部存储方式没有任何关系。这使得这个问题更加令人困惑。

任何人都可以修改上面的代码以使其四舍五入到小数点后 4 位吗？

（但你不能改变第一行代码。它必须用科学计数法指定。如果你用十进制计数法指定它会很好用。谢谢，Gary

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T21:46:38.927

3.734567E7 表示 3.734567 x 10 ⁷即 37,345,670。所以没有小数可以四舍五入...

如果你想要 3.734600E7，你可以使用`Math.round(d / 1000) * 1000)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:49:54.547

一种简单的方法：

```
System.out.println(String.format("%.4f", 1.23456789)); 
```

输出：

```
1.2346 (or 1,2346 depending on your locale) 
```

更新：显示四舍五入

# php - 我想要一个链接来更改表单上的字段

> ID：14006819
> 
> 赞同：0
> 
> 时间：2012-12-22T21:44:21.170
> 
> 标签：php, html

基本上这就是我想要的：

访问我网站的人点击链接

```
<a href="/form.html">Clicking here will pre-select Option 1</a>
<a href="/form.html">Clicking this one will pre-select Option 2</a> 
```

然后单击的链接将确定表单中将预先选择的选项。

```
<select>
<option>Option 1</option>
<option>Option 2</option>
</select> 
```

我在想这可以用 PHP $_GET 来完成吗？我真的不确定。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:49:30.113

确实是$_GET，但是需要把表单文件后缀改成.php

```
<a href="/form.php/?option=1">Clicking here will pre-select Option 1</a>
<a href="/form.php/?option=2">Clicking this one will pre-select Option 2</a> 
```

表格.php：

```
<?php if (!isset($_GET['option']) {
    //redirect
     }
 ?>
<select>
<option <?php if ($_GET['option']==1) echo "selected"; ?> >Option 1</option>
<option <?php if ($_GET['option']==2) echo "selected"; ?>>Option 2</option>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:57:04.017

如果您的选项确定不依赖于服务器端数据，那么这也可以使用 JavaScript 在客户端完成。您需要做的就是从 URL 中提取查询字符串值，并根据提取的值设置选择的选项。

# django - 如何配置日志记录处理程序以生成每月轮换的日志文件？

> ID：14006821
> 
> 赞同：2
> 
> 时间：2012-12-22T21:44:26.590
> 
> 标签：django, logging, python-2.7, django-settings, filehandler

我将按照[Django 的建议使用 settings.py 中的 dictconfig 格式配置 python 日志记录系统。](https://docs.djangoproject.com/en/1.4/topics/logging/#configuring-logging) 为了有效起见，我想在每月拆分的日志文件中记录条目，而不考虑当月的天数（或者，将来，取决于我的项目的工作量，按 iso 周数）。不幸的是，蟒蛇[`TimedRotatingFileHandler`](http://docs.python.org/2/library/logging.handlers.html#timedrotatingfilehandler)无法做到这一点。我有使用标准[`FileHandler`](http://docs.python.org/2/library/logging.handlers.html#filehandler)并动态更改文件名的想法（顺便说一句自定义它）。

```
'fichierMensuelCustom': {
    'level': 'INFO',
    'class': 'logging.FileHandler',
    'filename': lambda x: 'logs/projet/projet_{0}.log'.format(time.strftime('%m-%Y')),
    'formatter': 'complet'
    }, 
```

（请不要笑）它不起作用，我被卡住了......有什么建议吗？

# .net - 关于 ado.net 的搜索

> ID：14006822
> 
> 赞同：-1
> 
> 时间：2012-12-22T21:44:33.147
> 
> 标签：.net

我想从 ado.net 中的数据库产品名称中搜索。当用户输入产品的全名时，它会得到结果，但我希望当用户输入第一个字母时，文本更改事件调用并根据第一个字母获取结果。例如，如果用户只输入'e'它会根据e获得所有结果并在datagridview中显示

```
 private void textBox10_TextChanged(object sender, EventArgs e)
    {
        SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["hamad"].ConnectionString);
        conn.Open();
        DataSet dtt = new DataSet();
        SqlCommand cmd = new SqlCommand("SELECT * from product where pname = '" + textBox10.Text.ToString() + "'", conn);
        SqlDataAdapter daa = new SqlDataAdapter();
        daa.SelectCommand = cmd;
        daa.Fill(dtt, "product");
        dataGridView2.DataSource = dtt;
        dataGridView2.DataMember = "product";
        dataGridView2.Visible = true;
    } 
```

请帮帮我。我想了很多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:10:02.657

首先，即使我的答案的假设不正确也是有效的，**永远不会**将用户提供的文本附加到 SQL 语句中。那是要求[SQL 注入](http://en.wikipedia.org/wiki/SQL_Injection)问题

* * *

我猜您需要以用户在文本框中输入的文本*开头的所有结果。*

*您正在向数据库询问与数据库中输入的内容完全相同*的任何条目，因此当用户查找书籍时，他将需要输入书籍的完整标题，否则将不会返回。这不是一个搜索:)

为此，您需要使用[`like`sql 运算符](http://msdn.microsoft.com/en-us/library/ms179859.aspx)，而不是使用`=`. 尝试换行：

```
SqlCommand cmd = new SqlCommand("SELECT * from product where pname = '" + textBox10.Text.ToString() + "'", conn); 
```

和

```
SqlCommand cmd = new SqlCommand("SELECT * from product where pname like @pname+'%'", conn);
cmd.Parameters.AddWithValues("@pname", textBox10.Text); 
```

这应该（安全地）返回名称以输入的字符串开头的任何产品。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:13:46.873

1.  当用户按 Tab、按 Enter 或单击文本框外的内容时调用 textChange 事件。
2.  如果要从字符串的一部分进行搜索，则必须在 sql 查询中使用 like。

尝试这个

```
 private void textBox10_TextChanged(object sender, EventArgs e)
  {
    SqlConnection conn = new SqlConnection(ConfigurationManager.ConnectionStrings["hamad"].ConnectionString);
    conn.Open();
    DataSet dtt = new DataSet();
    SqlCommand cmd = new SqlCommand("SELECT * from product where pname like @pname+'%'", conn);
    cmd.Parameters.AddWithValues("@pname", textBox10.Text);
    SqlDataAdapter daa = new SqlDataAdapter();
    daa.SelectCommand = cmd;
    daa.Fill(dtt, "product");
    dataGridView2.DataSource = dtt;
    dataGridView2.DataMember = "product";
    dataGridView2.Visible = true;
  } 
```

这将显示以您键入的字符开头的所有记录。 **注意**；如果您按 Tab、按 Enter 或单击文本框外的内容，所有这些都将完成。

# javascript - 页面完成加载，通过 Jquery .load 加载 jQuery 内容，执行 jQuery 元素

> ID：14006824
> 
> 赞同：0
> 
> 时间：2012-12-22T21:44:40.383
> 
> 标签：javascript, jquery

如果我希望在主页完成加载后能够加载内容（包含取决于 jQuery 的元素），则将从我网站上的另一个页面（div）中检索内容。然后如何根据 jQuery 获取这些元素来执行（工作）？

在将这些不同的 jQuery 元素加载到主页后，如何使用一些简单的方法使它们工作？我对 jQuery 了解不多，如果我可以在脚本上添加/编辑一个函数以使它们在加载后工作，那就太好了，但它可能比这更困难。在过去的日子里，我尝试初始化加载的不同对象，但注意到复杂的脚本非常困难。

页面加载这样的新内容（选择框）：

```
<select id="selectbox"> 
<option>1</option>
</select> 
```

选择框的 jQuery 代码：

```
$(document).ready(function(){ 
$("#selectbox").change(function(){ 
var selectedOption = $('#selectbox :selected').val(); 
$containerDiv = $('#div_that_will_get_content'); 
$containerDiv.html("");
        switch (selectedOption)
        {
        case "1":$containerDiv.load( "Page.html #div1 );break;
        }
return true;
}); 
}); 
```

选择框 (1) 中的选定选项从 Page.html #div1 收集数据，然后将数据发送到 div "#div_that_will_get_content"。因此，在主页完成加载后会加载 div。

现在，如果我想在这个 div 中放置一个 jQuery 元素，然后通过选择框将该 div 加载到主页中并加载到“#div_that_will_get_content”，这些元素不起作用。任何人都可以展示一个简单的 jQuery 示例，并简要说明脚本是如何从一开始就编写的，以及在加载后您进行了哪些更改以使其工作？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:53:23.923

不完全确定您需要什么，但部分答案在于使用成功回调`load()`

```
/* define this cached elemn outside change handler so don't have to search DOM each time*/
$containerDiv = $('#div_that_will_get_content');

$("#selectbox").change(function() {
    /* val() of select is same as searching for selected option val() but less code*/
    var url = 'Page.html #div' + $(this).val();
    $containerDiv.load(url, function() { 
         /* new ajax loaded html exists you can run code here*/
        $containerDiv.find('#someOtherDiv').doSomething()
    })

}); 
```

API 参考：[http ://api.jquery.com/load/](http://api.jquery.com/load/)

如果您的问题与将事件绑定到将来随时加载的元素（例如单击处理程序）有关，您可以在页面加载脚本中使用`on()`

```
$(document).on('click', '.className', function(){
     doSomething();
}) 
```

# r - 如何矢量化 R 中的 for 循环

> ID：14006832
> 
> 赞同：5
> 
> 时间：2012-12-22T21:45:26.107
> 
> 标签：r, for-loop, vectorization

我正在尝试清理这段代码，想知道是否有人对如何在没有循环的情况下在 R 中运行它有任何建议。我有一个名为 data 的数据集，其中包含 100 个变量和 200,000 个观察值。我想要做的基本上是通过将每个观察值乘以特定的标量来扩展数据集，然后将数据组合在一起。最后，我需要一个包含 800,000 个观察值（我要创建四个类别）和 101 个变量的数据集。这是我写的一个循环，它可以做到这一点，但它的效率非常低，我想要更快更高效的东西。

```
datanew <- c()
for (i in 1:51){
  for (k in 1:6){
    for (m in 1:4){

      sub <- subset(data,data$var1==i & data$var2==k)

      sub[,4:(ncol(sub)-1)] <- filingstat0711[i,k,m]*sub[,4:(ncol(sub)-1)]

      sub$newvar <- m

      datanew <- rbind(datanew,sub)

    }
  }
} 
```

请让我知道您的想法并感谢您的帮助。

下面是一些具有 2K 观测值而不是 200K 的样本数据

```
# SAMPLE DATA
#------------------------------------------------#
  mydf <- as.data.frame(matrix(rnorm(100 * 20e2), ncol=20e2, nrow=100))
  var1 <- c(sapply(seq(41), function(x) sample(1:51)))[1:20e2]
  var2 <- c(sapply(seq(2 + 20e2/6), function(x) sample(1:6)))[1:20e2]
  #----------------------------------#
  mydf <- cbind(var1, var2, round(mydf[3:100]*2.5, 2))
  filingstat0711 <- array(round(rnorm(51*6*4)*1.5 + abs(rnorm(2)*10)), dim=c(51,6,4))
#------------------------------------------------# 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T05:58:20.123

您可以尝试以下方法。请注意，我们将前两个 for 循环替换为对 lapply 的调用`mapply`，将第三个 for 循环替换为对 lapply 的调用。此外，我们正在创建两个向量，我们将组合它们以进行向量化乘法。

```
# create a table of the i-k index combinations using `expand.grid`
ixk <- expand.grid(i=1:51, k=1:6)

    # Take a look at what expand.grid does
    head(ixk, 60)

# create two vectors for multiplying against our dataframe subset
multpVec <- c(rep(c(0, 1), times=c(4, ncol(mydf)-4-1)), 0)
invVec   <- !multpVec

    # example of how we will use the vectors
    (multpVec * filingstat0711[1, 2, 1] + invVec)

# Instead of for loops, we can use mapply. 
newdf <- 
  mapply(function(i, k) 

    # The function that you are `mapply`ing is:
    # rbingd'ing a list of dataframes, which were subsetted by matching var1 & var2
    # and then multiplying by a value in filingstat
    do.call(rbind, 
        # iterating over m
        lapply(1:4, function(m)

          # the cbind is for adding the newvar=m, at the end of the subtable
          cbind(

            # we transpose twice: first the subset to multiply our vector. 
            # Then the result, to get back our orignal form
            t( t(subset(mydf, var1==i & mydf$var2==k)) * 
              (multpVec * filingstat0711[i,k,m] + invVec)), 

          # this is an argument to cbind
          "newvar"=m) 
    )), 

    # the two lists you are passing as arguments are the columns of the expanded grid
    ixk$i, ixk$k, SIMPLIFY=FALSE
  )

# flatten the data frame
newdf <- do.call(rbind, newdf) 
```

* * *

需要注意的两点：

1.  尽量不要使用常用函数中的,,,等字眼在上面的`data`代码`table`中`df`我用.`sub``mydf``data`

2.  您可以使用`apply(ixk, 1, fu..)`而不是`mapply`我使用的，但我认为 mapply 在这种情况下可以使代码更清晰

# mysql - 如何优化这个 MySQL 查询的运行时间？

> ID：14006835
> 
> 赞同：2
> 
> 时间：2012-12-22T21:46:21.270
> 
> 标签：mysql, performance

我正在使用[geonames.org](http://geonames.org)的地理空间数据库。我目前在我的网站上有一个自动完成输入字段，它将搜索词转发到数据库并返回适当的结果。一件重要的事情是，结果必须按国家/地区排序。

我从中选择的表大约有 900.000 行，并使用以下命令创建：

```
CREATE TABLE IF NOT EXISTS `geonames` (
`id` integer NOT NULL AUTO_INCREMENT PRIMARY KEY,
`country_code` char(2) NOT NULL,
`postal_code` varchar(20) NOT NULL,
`place_name` varchar(180) NOT NULL,
...
FULLTEXT(country_code),
FULLTEXT(postal_code),
FULLTEXT(place_name)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci; 
```

一个典型的语句如下所示：

```
SELECT postal_code, place_name FROM geonames WHERE LOWER(`place_name`)
LIKE 'washin%' ORDER BY FIELD (country_code, 'JE', 'GB', 'FR', 'LI', 'CH',
'DK', 'LU', 'BE', 'NL', ... many more countries in that list ... ) DESC; 
```

我使用*FULLTEXT*索引来加速`WHERE place_name LIKE 'washin%'`零件。但是查询仍然有些慢。SQL 查询的任务是在表中搜索每个`place_name`匹配的`'washin%'`，然后根据指定的国家对结果进行排序。查询速度慢是不是因为一次请求的数据量大？如果是的话，我怎么能减少这个瓶颈的运行时间？

我无论如何都不是 MySQL 方面的专家，所以如果有经验丰富的人可以帮助我加快显示的 SQL 查询或至少为我指明优化的方向，我会很高兴。

非常感谢你！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T21:48:32.317

您应该避免`LOWER`在 where 子句中，因为这样就不能有效地使用索引：

```
SELECT postal_code, place_name FROM geonames
WHERE `place_name` LIKE 'washin%'
ORDER BY FIELD(country_code, 'JE', 'GB',  ...) DESC; 
```

相反，您应该使用不区分大小写的排序规则。以结尾的排序规则`_ci`不区分大小写。区分大小写的排序规则以`_cs`.

此外，您的全文索引*不会*帮助您使用`LIKE`. 您[应该](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)在`place_name`.

> **B-Tree 索引特征**
> 
> B 树索引可用于使用 =、>、>=、<、<= 或 BETWEEN 运算符的表达式中的列比较。如果 LIKE 的参数是不以通配符开头的常量字符串，则索引也可用于 LIKE 比较。

您还可以选择将`country_code`and包含`postal_code`在索引中（但不作为第一列）。然后，这将为您的查询提供一个覆盖索引。

由于调用，`ORDER BY`也将无法有效地使用索引`FIELD`，但如果返回的结果数量相对较少，这应该不是问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:22:01.143

去掉对`LOWER`函数的调用：在mysql中，`LIKE`忽略大小写，所以不需要调用。

# python - 406 机械化错误

> ID：14006836
> 
> 赞同：0
> 
> 时间：2012-12-22T21:46:31.817
> 
> 标签：python, mechanize

尝试打开 URL 时，我在使用 Mechanize 时遇到 406 错误：

```
for url in urls:
    if "http://" not in url: 
        url = "http://" + url
    print url
    try:
        page = mech.open("%s" % url)
    except urllib2.HTTPError, e:
        print "there was an error opening the URL, logging it"
        print e.code
        logfile = open ("log/urlopenlog.txt", "a")
        logfile.write(url + "," + "couldn't open this page" + "\n")
        continue
    else:
        print "opening this URL..."
        page = mech.open(url) 
```

知道什么会导致 406 错误发生吗？如果我转到有问题的 URL，我可以在浏览器中打开它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T21:53:43.813

尝试根据浏览器发送的内容向您的请求添加标头；从添加`Accept`标头开始（406 通常意味着服务器不喜欢您想要接受的内容）。

请参阅文档中的[“添加标题”](http://wwwsearch.sourceforge.net/mechanize/doc.html#adding-headers)：

```
req = mechanize.Request(url)
req.add_header('Accept', 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8')
page = mechanize.urlopen(req) 
```

那里的`Accept`标头值基于 Chrome 发送的标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-26T00:43:03.257

如果您想了解您的浏览器发送了哪些标头，此网页会显示给您：[https ://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending](https://www.whatismybrowser.com/detect/what-http-headers-is-my-browser-sending)

'Accept' 和 'User-Agent' 标题应该足够了。这是我为摆脱错误所做的：

```
#establish counter
j = 0

#Create headers for webpage
headers = {'User-Agent': 'Mozilla/5.0', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'}

#Create for loop to get through list of URLs
for url in URLs:

    #Verify scraper agent so that web security systems don't block webpage scraping upon URL opening, with j as a counter
    req = mechanize.Request(URLs[j], headers = headers)

    #Open the url
    page = mechanize.urlopen(req)

    #increase counter
    j += 1 
```

您还可以尝试导入“urllib2”或“urllib”库来打开这些 URL。语法是一样的。

# google-maps-api-3 - 谷歌地图 API v3 不适用于科尔多瓦

> ID：14006846
> 
> 赞同：-1
> 
> 时间：2012-12-22T21:48:38.103
> 
> 标签：google-maps-api-3, cordova

我正在尝试在 Android 应用程序上使用谷歌地图。我将 Google Maps API 与

```
<script type="text/javascript" src="http://maps.googleapis.com/maps/api /js?key=my key&sensor=false"></script> 
```

每个网站都被列入白名单

```
<access origin=".*"/> 
```

在 .xml 中。

但我仍然得到一个错误

```
Uncaught referenceError:google is not defined 
```

因此，无法加载 API。该代码在我的 PC 上运行时运行良好，但是当我将它放在移动设备上时会发生这种情况，表明问题可能来自于 cordova。

我的设备当然有互联网连接，知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T01:00:24.127

假设这只是一个错字，但您的网址中有一个空格，现在我相信该网址是：[http ://maps.google.com/maps/api/js?key=yourkey&sensor=false](http://maps.google.com/maps/api/js?key=yourkey&sensor=false)

# tdd - 有哪些好的服务或工具可用于远程结对编程？

> ID：14006848
> 
> 赞同：3
> 
> 时间：2012-12-22T21:48:51.177
> 
> 标签：tdd, bdd, pair-programming

我使用过屏幕共享（通过 Skype 和 joinme）以及 tmux。

tmux 提供了更具交互性的体验，但我发现延迟很烦人。

用于远程结对编程的最佳服务和工具是什么？

最好在 Sublime Text 2 中工作，但如果这不可行，那么 vim 就可以了。

“最好”是指：

*   响应式 - 我不想等着看我的击键效果
*   互动 - 应该很容易将控制权切换给其他人

使用 Ruby、Rails、Sublime Text 2，（也许）vim。

**编辑：**需要在 OSX（最好）或 Ubuntu 上运行。请注意该解决方案是在本地计算机上运行（并且其他人可以在没有有效互联网 IP 的情况下连接到它），或者该解决方案是否在具有有效互联网静态 IP 的服务器上运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:06:45.830

对于结对编程，我通常将[Screen](http://kb.iu.edu/data/acuy.html)和[SubEthaEdit](http://www.codingmonkeys.de/subethaedit/)与语音聊天（例如 Skype）结合使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T21:57:27.813

我自己喜欢 TeamViewer。你也可以看看 Mikogo

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-02T18:53:47.567

你试过[亚硝酸盐](http://www.nitrous.io)吗？它是一个基于 Web 的 IDE，包括一个终端/bash 和一个文本编辑器。您可以免费注册并进入协作模式，邀请您的协作者，然后离开。

# haskell - MArray 特化为 STArray

> ID：14006850
> 
> 赞同：3
> 
> 时间：2012-12-22T21:49:04.983
> 
> 标签：haskell, marray

我对在 Haskell 中使用多态性的 STArray 感到困惑。

假设我有以下设置

```
data SomeData a = Something a

thawData :: MArray u a m => SomeData a -> m (u Int a)
thawData = {- doesn't matter -}

doSomething :: SomeData a -> ()
doSomething x = runST $ do 
  xArr <- thawData x
  return () 
```

现在，我相信 thawData 的类型专门用于这种情况

```
thawData :: SomeData a -> ST s (STArray Int a) 
```

但是，除非我将 thawData 的类型更改为显式使用 STArray，否则即使我尝试在 do 表达式的主体中显式键入它，这也不会编译。

那么到底发生了什么？为什么类型不能专门化？
我可以以某种方式更改 doSomething 的主体而不是 thawData 的类型吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T23:18:06.710

> 现在，我相信 thawData 的类型专门用于这种情况
> 
> ```
> thawData :: SomeData a -> ST s (STArray Int a) 
> ```

不完全是，`STArray`s 由状态类型参数化，所以它是`ST s (STArray s Int a)`. 但这无法推断，因为错误消息告诉您：

```
Thaw.hs:13:11:
    No instance for (MArray u0 a (ST s))
      arising from a use of `thawData'
    The type variable `u0' is ambiguous
    Possible fix: add a type signature that fixes these type variable(s)
    Note: there are several potential instances:
      instance MArray (GHC.Arr.STArray s) e (ST s)
        -- Defined in `Data.Array.Base'
      instance MArray (Data.Array.Base.STUArray s) Bool (ST s)
        -- Defined in `Data.Array.Base'
      instance MArray (Data.Array.Base.STUArray s) Char (ST s)
        -- Defined in `Data.Array.Base'
      ...plus 15 others
    Possible fix: add an instance declaration for (MArray u0 a (ST s))
    In a stmt of a 'do' block: xArr <- thawData x 
```

有几个可能的`MArray`类实例`ST s`作为 monad 可供选择（即使只有一个实例在范围内，编译器也会在开放世界假设下运行，其他实例*可以*在其他地方定义）。所以编译器不知道要使用哪个实例，因此它拒绝编译代码。

现在，建议的可能修复在这里不正确，您需要通过另一种方式修复数组类型。`thawData`一种可能性是像您一样在顶层专门化类型签名。

另一种是专攻它`doSomething`，

```
doSomething :: SomeData a -> ()
doSomething x = runST $ do 
  xArr <- (thawData :: SomeData b -> ST s (STArray s Int b)) x
  return () 
```

它告诉编译器在`thawData`这里使用哪种类型，第三个是将表达式类型签名移动到该行的末尾

```
{-# LANGUAGE ScopedTypeVariables #-}
-- imports etc.

doSomething :: forall a. SomeData a -> ()
doSomething x = runST $ do 
  xArr <- thawData x :: ST s (STArray s Int a)
  return () 
```

但这需要`ScopedTypeVariables`扩展，因为现在您需要引用`a`从`doSomething`. 不过，我发现它比行中间的表达式类型签名更具可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:42:21.660

如果您包含错误消息，它会有所帮助。

事实上，我所能做的就是猜测错误是因为您没有提供足够的上下文来确定`xArr`. 特别是，`m`可以与参数类型统一`ST s`并`a`来自参数类型，但没有确定的上下文`u`。

我的猜测是编译器告诉你的错误，但由于你没有包含它，这只是一个猜测。

如果我是对的，您可以`thawData`通过在类型注释上`xArr`或创建它的表达式上进行修改来解决此问题，从而指定`u`应该是什么类型。

# ios - 通用应用程序 - 如何？

> ID：14006851
> 
> 赞同：1
> 
> 时间：2012-12-22T21:49:04.983
> 
> 标签：ios, xcode4.2

我正在使用 Xcode 4.2 并正在编写一个通用应用程序。我在开始新项目时选择了 SingleView 应用程序模板。XCode 添加了 ViewController1.h、ViewController1.m、ViewController1_iphone.xib 和 ViewController1_iPad.xib。我需要添加更多 UI 并单击 File...New...New File 并选择 UIViewController 子类模板并看到两个复选框（针对 iPad，使用 Xib 作为用户界面）。

我应该怎么做才能同时支持 iPad 和 iPhone，同时拥有共享相同代码的通用 .h 和 .m 文件。我是否需要通过在视图控制器中执行此操作来添加代码以检查它是 iPad 还是 iPhone？

```
if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) { 
} else {
} 
```

另外，我看到人们在谈论~iPad 和~iPhone。这是怎么回事？

如果我理解正确，由于屏幕尺寸不同，我是否必须为 iPad 和 iPhone 分别设计 UI？

我在这里完全糊涂了。

请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T22:11:25.277

您可以添加两个笔尖（一个用于 ipad，一个用于 iphone），或者您可以添加一个可以为任一接口正确缩放的笔尖。通常，如果您制作的视图将覆盖整个或大部分屏幕，您会添加两个笔尖，如果您正在制作一些可能会在 iphone 上全屏但显示在ipad 上的弹出窗口。

波浪号后缀在[*Resource Programming Guide*](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/LoadingResources/Introduction/Introduction.html#//apple_ref/doc/uid/10000051i-CH1-SW2)[中的“iOS 支持设备特定资源”](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/LoadingResources/Introduction/Introduction.html#//apple_ref/doc/uid/10000051i-CH1-SW2)标题下进行了`~ipad`描述。请注意，**后缀完全是小写**，而不是您在问题中所写的驼峰式。这很重要，因为 iOS 使用区分大小写的文件系统。`~iphone`[](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/LoadingResources/Introduction/Introduction.html#//apple_ref/doc/uid/10000051i-CH1-SW2)

 ***当您使用or之`NSBundle`类的消息获取资源的路径时，iOS 将首先查找后缀为or的资源文件，具体取决于当前设备。例如，假设您这样做：`-[NSBundle pathForResource:ofType:]``-[NSBundle URLForResource:withExtension:]``~ipad``~iphone`

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"setup" ofType:@"plist"]; 
```

*   如果您在 iPhone 类型的设备（包括 iPod touch）或 iPhone 模式下的模拟器上运行它，iOS 将首先在您的应用程序包中查找名为`setup~iphone.plist`. 如果找到这样的文件，它将返回该文件的路径。如果它没有找到该文件，它将改为返回`setup.plist`.

*   如果您在 iPad 类型的设备上或在 iPad 模式下的模拟器上执行此操作，iOS 将首先在您的应用程序包中查找名为`setup~ipad.plist`. 如果找到这样的文件，它将返回该文件的路径。如果它没有找到该文件，它将改为返回`setup.plist`.

从包中获取资源的所有其他 API 都构建在`NSBundle`. 这意味着如果您使用`+[UIImage imageNamed:]`，它将自动使用特定于设备的图像，如果您的捆绑包中有一个。如果你使用`-[NSBundle loadNibNamed:owner:options:]`，它会自动加载一个特定于设备的 nib ( `.xib`) 文件，如果你的包中有一个。

如果您使用后缀，这会简化您的代码。如果您创建`MyViewController~ipad.xib`and `MyViewController~iphone.xib`，您的应用将*自动*为当前设备加载正确的。您不必检查用户界面习语；`NSBundle`为您检查。（您也可以使用名称`MyViewController~ipad.xib`and`MyViewController.xib`并获得相同的效果。）

现在，您可能已经注意到，当您创建“通用”项目时，Xcode 将您的项目文件命名为`ViewController1_iPhone.xib`and `ViewController1_iPad.xib`，它**不**使用波浪线后缀，并且它包含查看用户界面习语并相应地选择文件名的代码。为什么通用项目模板会这样做？我不知道，但这很**愚蠢**。我建议您修复文件名以使用波浪号后缀并删除检查用户界面习语的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:06:46.567

我建议将您的 .xib 文件移动到 Storyboards，一个用于 iPhone，一个用于 iPad。他们为开发带来了很多乐趣，并且易于学习。

然后，将您的自定义类分配给您的视图控制器并将您的 UI 元素链接到您的代码。如果您对两个故事板都这样做，那么它们可以通过引用一个通用的 .h/.m 文件来共享相同的代码。

在项目设置中，一旦应用程序配置为通用开发，您就可以将适当的故事板分配给 iPhone/iPad 部署信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T22:11:23.547

这或多或少取决于您选择如何实现事物和构建事物，但我倾向于使用以下想法：

*   忽略“Target for iPad”和“With Xib”选项（除非不使用情节提要。见后文）
*   创建一个包含所有共享代码的父视图控制器。EG MainViewController
*   为 iPad 和 iPhone 创建 2 个子类。EG MainViewController_iPhone 和 MainViewController_iPad （您可以使用您提到的 MainViewController~iPhone。这里只是命名偏好问题）
*   您希望在 iPhone 和 iPad 之间共享的任何代码，粘贴在 MainViewController 父类中，以及任何特定于每个设备的代码都放在适当的子类中

一般来说，如果你是在 iPhone 或 iPad 上运行，你真的不需要测试。这并不是说这是错误的，你不应该这样做，但是通过像这样分离类，你真的不需要这样做。但是我喜欢做的是在我处理设备可以处理的方向时检查我正在运行的设备，并将其放入共享的父视图控制器中。

至于您的 UI，您有 3 个选项。- 使用故事板（我推荐这个） - 使用单独的 XIB 文件 - 手动编码所有内容

根据您现在对 iOS 的了解程度，手动编写所有内容可能会更有效率，但很可能会花费您更长的时间。使用界面构建器既好又简单，尽管您仍然需要在代码中进行任何自定义，但这很好。

我建议使用情节提要，这样您就不会拥有大量不同的 XIB 文件。它还简化了 iPhone 和 iPad 之间的拆分，因为您的界面只需 2 个文件。一个将拥有 iPhone 的所有屏幕，一个将拥有 iPad 的所有屏幕。iOS 将在启动时自动加载正确的故事板，因此您无需执行任何操作。然后，要获取视图控制器和视图，您可以执行以下操作：

```
MainViewController *vc = [self.storyboard instantiateViewControllerWithIdentifier:@"MainViewControllerIdentifier"]; 
```

请注意，标识符是在情节提要中指定的。

希望这会有所帮助，但如果您有更多问题，请立即开除 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-23T05:11:50.363

这是你想要的：

```
if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone) 
{
    storyboard = [UIStoryboard storyboardWithName:@"ViewController1_iphone" bundle:nil];
}
else if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) 
{
storyboard = [UIStoryboard storyboardWithName:@"ViewController1_ipad" bundle:nil];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-22T22:12:35.687

如果您将 nib 文件命名为`MyNib.xib`和`MyNib~ipad.xib`，则将自动加载所需的 nib，具体取决于您的应用程序运行的设备。然而，并不总是需要创建不同的笔尖。如果您不需要太多自定义，并且可以使用 autoresizingMasks 解决，或者您正在以编程方式设置一些框架，则只需一个笔尖即可解决。如果您检查“针对 ipad”部分，您在 nib 中的视图会更大，并且分组表看起来有点不同，但我不知道结果有什么其他差异。

希望这可以帮助！***

# mysql - 使用 MySQL：使用内部联接使用值更新字段

> ID：14006856
> 
> 赞同：3
> 
> 时间：2012-12-22T21:49:46.717
> 
> 标签：mysql, join

我有一个主表和一个索引表。两个表共享一个名为“L_Status”的公共主字段。我想根据索引表中名为“status”的引用将主表中的数据从“L_Status”值（整数）更新为“L_StatusLV”（可读文本值）。这是我输入 PHPmyAdmin 来完成此操作的代码：

```
UPDATE markers.L_Status 
FROM markers
INNER JOIN STATUS ON markers.L_Status = status.L_Status
WHERE  markers.L_Status = status.L_StatusLV 
```

PHPmyAdmin 返回以下错误：

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的语法，以便在第 2 行的“FROM 标记内部连接状态 ON 标记。L_Status = status.L_Status WHERE ma”附近使用

关于这里的语法错误有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-22T21:56:33.037

MySQL 的`UPDATE` `JOIN`语法与 SQL Server 的不同（看起来像你所拥有的）：

```
UPDATE
  /* First join the tables */
  markers 
  INNER JOIN status ON markers.L_Status = status.L_Status
/* Then specify the new value in the SET clause */
SET markers.L_Status = status.L_StatusLV 
```

但是，正如您在上面提到的，当前值是整数。如果该列`markers.L_Status`是一`INT`列而不是`CHAR/VARCHAR`我假设人类可读的列是，这将不起作用。

访问[MySQL 的`UPDATE`语法参考](http://dev.mysql.com/doc/refman/5.0/en/update.html)以获得完整的语法细节。特别是，*`table_references`*.

# c - 在 Windows 上调试 R 的编译代码

> ID：14006861
> 
> 赞同：2
> 
> 时间：2012-12-22T21:50:41.033
> 
> 标签：c, r, debugging

我正在研究一个包含从 C/C++ 代码编译的二进制文件的 R 包。该编译代码中的某些内容会导致 Windows（7、64 位）上的随机崩溃，但不会导致 Linux（各种系统和配置）上的随机崩溃。我的 R 版本是 2.15.0。

我不知道如何调试它，因为我无法弄清楚 R 崩溃时给出的信息：

```
Problem signature:
  Problem Event Name:   BEX64
  Application Name: Rterm.exe
  Application Version:  2.150.58871.0
  Application Timestamp:    4f75a75a
  Fault Module Name:    StackHash_2264
  Fault Module Version: 0.0.0.0
  Fault Module Timestamp:   00000000
  Exception Offset: 0000000000000000
  Exception Code:   c0000005
  Exception Data:   0000000000000008
  OS Version:   6.1.7601.2.1.0.256.1
  Locale ID:    1037
  Additional Information 1: 2264
  Additional Information 2: 2264db07e74365624c50317d7b856ae9
  Additional Information 3: 875f
  Additional Information 4: 875fa2ef9d2bdca96466e8af55d1ae6e 
```

我可以从 StackHash 模块中的问题中学到什么吗？

一些附加信息：

1.  根据 R 文档，我在 Linux 上运行 Valgrind，它没有报告任何问题。我尝试了“gctorture”功能，但它似乎并没有以任何方式影响错误的行为。

2.  我在我的代码中使用 pthreads 来利用多核 CPU。当我禁用多线程（使用我拥有的预处理器定义）时，问题似乎消失了，但我不确定这是否真的消除了问题，或者只是降低了它发生的可能性。

3.  我没有使用那么多内存，这会在我正在使用的机器上造成麻烦。我也有一些递归调用，但似乎又太少了以至于它会溢出堆栈，除非线程在 Windows 上获得非常有限的堆栈？

4.  由于多线程随机性和错误的低概率，我很难使用打印到控制台或日志文件来隔离它。

任何指针将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:40:27.453

我会在调试器中加载 R，然后运行它直到它崩溃，然后看看它在哪里。

该错误显然是一个空指针访问（0000000000000008 引用的是 NULL） - 我很确定这不是堆栈问题。

您应该能够看到它在哪里崩溃。

# eclipse - Arm-angstrom gcc 编译器跳过 openCV 库

> ID：14006863
> 
> 赞同：1
> 
> 时间：2012-12-22T21:51:20.880
> 
> 标签：eclipse, arm, cross-compiling, angstrom-linux

我正在 BeagleBone 上使用 OpenCV 交叉编译我的第一个程序。

我使用 Eclipse Juno IDE、arm-angstrom-linux-gnueabi-gcc 编译器和最后一个 OpenCV 库。我已经在我的 PC 上成功地使用 OpenCV 构建了程序，我已经成功地将“Hello Wolrd”交叉编译到我的 BB 上，然后我尝试在 BB 上交叉编译 OpenCV。

我刚刚链接了 OpenCV 库（opencv_highgui，没有更改我的“hello world”代码），编译后出现以下错误：

```
/usr/local/angstrom/arm/lib/gcc/arm-angstrom-linux-gnueabi/4.3.3/../../../../arm-angstrom-linux-gnueabi/bin/ld: skipping incompatible /usr/lib/libopencv_highgui.so when searching for -lopencv_highgui
/usr/local/angstrom/arm/lib/gcc/arm-angstrom-linux-gnueabi/4.3.3/../../../../arm-angstrom-linux-gnueabi/bin/ld: skipping incompatible /usr/lib/libopencv_highgui.a when searching for -lopencv_highgui
/usr/local/angstrom/arm/lib/gcc/arm-angstrom-linux-gnueabi/4.3.3/../../../../arm-angstrom-linux-gnueabi/bin/ld: cannot find -lopencv_highgui 
```

Arm 编译器忽略了这个库，我也不知道为什么。

我该如何解决这个问题？

# python - Python itertools排列如何包含重复字符

> ID：14006867
> 
> 赞同：17
> 
> 时间：2012-12-22T21:51:49.427
> 
> 标签：python, permutation, itertools

> **可能重复：**
> [一组python的幂集和笛卡尔积](https://stackoverflow.com/questions/10342939/power-set-and-cartesian-product-of-a-set-python)

使用 Python Itertools.permutations() 我想接收和输出具有重复字符的排列。例如，这是我下面的函数及其当前输出。

```
def perm(n,i):
    b = 0
    while b < n:
        n= n -1
        from itertools import permutations as p
        file.write('\n'.join([''.join(item) for item in p(i,n)]))
perm(4,'0123') 
```

输出是：

```
012
013
021
023
031
032
102
103
120
123
130
132
201
203
210
213
230
231
301
302
310
312
320
321..... 
```

我如何获得像 112 或 222 这样的输出？

据我了解，组合不是特定于排列的顺序。我正在寻找的是找到所有组合，然后是每个组合的每个排列。这可能吗？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-12-22T22:07:42.343

你根本不想要排列。你想要笛卡尔积：

```
import itertools

def perm(n, seq):
    for p in itertools.product(seq, repeat=n):
        file.write("".join(p))
        file.write("\n")

perm(4, "0123") 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-22T22:01:10.667

您似乎正在寻找的是[笛卡尔积](http://docs.python.org/2/library/itertools.html#itertools.product)，而不是排列，它也由 itertools 提供。

您最好熟悉排列、组合、替换组合和笛卡尔积之间的区别，以确定最适合您的应用程序的方法，但很有可能，您正在寻找另一种选择。

# regex - 正则表达式向单词添加一些空格

> ID：14006868
> 
> 赞同：1
> 
> 时间：2012-12-22T21:52:12.753
> 
> 标签：regex, sublimetext2, code-snippets

我正在尝试为 Sublime Text 2 编写一个片段宠物。想法是用户键入一个字符串，该字符串将作为参数 $TM_CURRENT_WORD 传递给被调用的片段。我需要编写一个正则表达式，它将用最多 16 个字符的空格填充给定的单词。

例如用户输入：`SOMEWORD`- 8 ch。片段中的代码：`${$TM_CURRENT_WORD/"some regex magic"/"something more"}` 输出：（`SOMEWORDssssssss`这里 s 表示空格）

或：用户输入：`WORD`- 4 ch。输出应该是：`WORDssssssssssss`- 输入单词 + 12 个空格。

通常，输入可以是 1 到 16 个字符，但输出应该正好是 16 个字符。如果给出16个字符的单词？不应添加空格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-10T13:15:23.543

老实说，您可以编写一个完全符合您要求的小插件。

```
import sublime, sublime_plugin

class AddPaddingCommand(sublime_plugin.TextCommand):
    def run(self, edit):
        selections = self.view.sel()
        for s in selections:
            word = self.view.substr(s)
            padded_word = '{0: <16}'.format(word)
            self.view.replace(edit, s, padded_word) 
```

# elasticsearch - 这个弹性查询有什么问题

> ID：14006869
> 
> 赞同：1
> 
> 时间：2012-12-22T21:52:26.383
> 
> 标签：elasticsearch

为什么此查询工作正常（返回正确的结果）：

```
{
  "filter": {
    "term": { "id": "123456" }
  }
} 
```

而这个没有（返回 HTTP 500）：

```
{
  "filtered": {
    "query": {
      "match_all": {}
    },
    "filter": {
      "term": { "id": "123456" }
    }
  }
} 
```

?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:57:25.943

Elasticsearch 期望根级别的查询元素类似于“过滤器”元素。试试这个：

```
{
  "query": {
    "filtered": {
      "query": {
        "match_all": {}
      },
      "filter": {
        "term": { "id": "123456" }
      }
    }
  }
} 
```

# vb.net - vb.net 图像效果/色彩矩阵

> ID：14006870
> 
> 赞同：1
> 
> 时间：2012-12-22T21:52:26.917
> 
> 标签：vb.net

我目前在 vb.net 中使用 colormatrix 来应用滤镜效果，例如负片、色调和亮度等。

我的问题是，colormatrix 是最好的方法吗？或者还有其他更好的方法吗？谢谢

# jslint - JSLint'意外'（空格）'错误？

> ID：14006876
> 
> 赞同：3
> 
> 时间：2012-12-22T21:53:36.513
> 
> 标签：jslint, adobe-edge

我正在玩 Adob​​e 的[Edge Code](http://html.adobe.com/edge/code/)，它有自己的 JSLint 检查选项。我收到了这个我无法修复的错误（查看标题）……有人知道这是什么吗？以下 3 行代码中的每一行都会出现错误：

```
plugin.pics[data.images[i].index] = data.images[i];
dataLoadedEvent = $.Event('DualG:dataLoaded', [ plugin.pics.length ]);
privateLoadPic(index, container); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-30T19:44:03.293

我敢打赌，问题在于每行末尾的尾随空格。如果单击 JSLint 面板中的错误，光标会到行尾吗？如果是这样，可能就是这样；只需按 Shift+End，Delete 即可清理它。

如果我只是从上面粘贴您的确切代码并将其包装为一个简单的 JSLint 测试，我会得到零 JSLint 错误，如下所示：

```
/*jslint indent: 4 */
/*global plugin, data, $, i, dataLoadedEvent: true, privateLoadPic, index, container */
(function () {
    "use strict";

    plugin.pics[data.images[i].index] = data.images[i];
    dataLoadedEvent = $.Event('DualG:dataLoaded', [ plugin.pics.length ]);
    privateLoadPic(index, container);

}()); 
```

# c - 生成字符串

> ID：14006879
> 
> 赞同：-1
> 
> 时间：2012-12-22T21:53:47.247
> 
> 标签：c, distributed-computing, brute-force

我正在创建一个分布式密码破解器，我将在其中使用蛮力技术，所以我需要字符串的每个组合。

为了分发，`Server`将给出`Client`一系列字符串，例如 from `"aaaa"`to `"bxyz"`。我假设字符串长度为四。所以我需要检查这两个界限之间的每个字符串。

我正在尝试在 C 中生成这些字符串。我正在尝试为此制定逻辑，但我失败了；我也在谷歌上搜索过，但没有任何好处。任何的想法？

**编辑**

对不起兄弟，我想编辑它

我想要一个范围内的字符串组合，让我们假设介于`aaaa`和之间`aazz`的字符串就像`aaaa aaab aaac aaad ..... aazx aazy aazz`.. 我的字符空间只是大小写的英文字母，就像 52 个字符。我想检查 4 个字符的每个组合。但服务器将在其客户端之间分配字符串范围。我的问题是，如果一个客户的范围介于两者之间`aaaa`，`aazz`那么我将如何在这些范围之间生成字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:01:47.150

如果您的字符串只能理解 ASCII 表，则上限为 256 个字符或 2^8 个字符。

由于您的字符串长度为 4 个字符，因此您将有`2^8 * 2^8 * 2^8 * 2^8`组合或`2^8^4 = 2^32`组合。

只需拆分数字范围并在每台机器中开始组合。

您可能对此感兴趣：[计算第 N 个排列步骤？](https://stackoverflow.com/questions/3561137/calculating-nth-permutation-step)

**编辑**：

考虑到您的编辑，您的组合空间将是`52^4 = 7.311.616`组合。

然后，您只需要为每台机器划分这些“任务”以进行计算，因此，`7.311.616 / n = r`具有`r`每台机器计算的排列数量——最后一台机器可以计算`r + (7.311.616 % n)`组合。

由于您知道要在每台机器中构建的组合数量，因此您必须在每台机器中执行以下操作：

```
function check_permutations(begin, end, chars) {

    for (i = begin; i < end; i++) {

        nth_perm = nth_permutation(chars, i);
        check_permutation(nth_perm); // your function of verification

    }

} 
```

该功能`nth_permutation()`不难推导，我很确定您可以在我发布的链接中获得它。

在此之后，您只需使用诸如 的函数启动一个过程`check_permutations`，给出`begin`、`end`和 字符向量`chars`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:05:00.200

您可以生成包含所有排列的树。例如，就像在这个伪代码中一样：

```
strings(root,len)
    for(c = 'a' to 'z')
        root->next[c] = c
        strings(&root->next[c], len - 1) 
```

由 调用`strings(root, 4)`。

之后，您可以遍历树以获取所有排列。

# javascript - 导航栏显示错误的活动元素

> ID：14006880
> 
> 赞同：0
> 
> 时间：2012-12-22T21:53:49.227
> 
> 标签：javascript, twitter-bootstrap

Twitter Bootstrap 需要此修复，以便不使用固定导航栏覆盖当前锚点

```
legend {
padding-top: 60px;
margin-top: -60px;} /*fixes that anchor element is under navbar*/ 
```

我使用 data-spy 突出显示导航菜单元素

```
<body  data-spy="scroll" data-target=".navbar"> 
```

现在，当我选择导航元素时，之前的元素会突出显示。我知道 data-spy 仍然会看到前一个元素的一个点，因此会突出显示错误的元素。

但是如何解决呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T20:31:56.660

用 data 属性告诉滚动间谍脚本`offset`：

```
<body data-spy="scroll" data-target=".navbar" data-offset="60"> 
```

# android - 重复的菜单项出现，一个根本不显示；崩溃也

> ID：14006881
> 
> 赞同：0
> 
> 时间：2012-12-22T21:53:48.760
> 
> 标签：android

好的，所以我在开发我的 Android 应用程序方面做得很好，但后来我遇到了这个问题。我试图将另一个菜单项添加到我以前从未遇到过问题的选项菜单中，但现在，如问题中所述，其中一个项目出现两次，另一个根本没有出现，然后当我输入它崩溃的 Credits 活动。下面是 res/menu/menu.xml 和 MainActivity.java 的代码（第一个）

```
@Override 
public boolean onCreateOptionsMenu(Menu menu) { 
MenuInflater inflater = getMenuInflater(); 
inflater.inflate(R.menu.menu, menu); return true; }

@Override 
public boolean onOptionsItemSelected(MenuItem item) { 
// Handle item selection 
switch (item.getItemId()) { 

    case R.id.quit: 
        return true; 

    case R.id.new_game: 
        Intent intent = new Intent(this, New_Game.class); 
        startActivity(intent); 
        return true; 
    case R.id.visit_site: 
        Intent inten = new Intent(this, Site.class); 
        startActivity(inten); 
        return true; 
    case R.id.stay: 
         Intent inte = new Intent(this, MainActivity.class); 
        startActivity(inte); 
        return true; 
    case R.id.credits: 
        Intent i = new Intent(this, Credits.class); 
        startActivity(i); 
        return true; 
    case R.id.exit: 
        Intent in = new Intent(Intent.ACTION_MAIN); 
        in.addCategory(Intent.CATEGORY_HOME); 
        in.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
        startActivity(in); 
        finish();
        System.exit(0);
        return true; 

}return false;
} 
```

这是 XML 菜单

```
 <menu 
xmlns:android="http://schemas.android.com/apk/res/android" >
<item 
    android:id="@+id/visit_site" 
    android:title="Visit the Medieval Site!" /> 
<item 
    android:id="@+id/quit" 
    android:title="Exit">
    <item
        android:id="@+id/credits"
        android:title="Credits"
    />

    <menu 
        xmlns:android="http://schemas.android.com/apk/res/android" >
        <item 
            android:id="@+id/stay" 
            android:title="Cancel" 
        /> 
        <item 
            android:id="@+id/exit" 
            android:title="Exit" />
            </menu>
    </item>
<item
    android:id="@+id/new_game"
    android:title="Start the Game"

      />

      </menu> 
```

我在 Java 文件中将积分设置为普通的“Hello World”活动。这是该活动的 Android 清单声明。我将其包括在内，以防错误偶然出现。

```
<activity android:name=".Credits"
        android:label="Application Credits"
        android:configChanges="orientation|keyboardHidden"
        android:screenOrientation="landscape"    >
    </activity> 
```

如果有人能告诉我我在哪里搞砸了，我需要做什么来修复它。

下面是 Sam 询问的 Credits.java

```
 package com.apw.games.rpg.medieval;

import android.app.*;
import android.os.*;
import android.view.*;

public class Credits extends Activity
{

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.credits);

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:03:31.283

您的菜单布局不正确。问题是“积分”，您不能有嵌套项目：`<item><item></item></item>`。将“积分”移动到子菜单或将其移动到常规菜单：

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >

    <item
        android:id="@+id/visit_site"
        android:title="Visit the Medieval Site!"/>
    <item
        android:id="@+id/quit"
        android:title="Exit">
        <menu xmlns:android="http://schemas.android.com/apk/res/android" >
            <item
                android:id="@+id/stay"
                android:title="Cancel"/>
            <!-- I moved credits here -->
            <item
                android:id="@+id/credits"
                android:title="Credits"/>
            <item
                android:id="@+id/exit"
                android:title="Exit"/>
        </menu>
    </item>
    <item
        android:id="@+id/new_game"
        android:title="Start the Game"/>

    <!-- Or you can move credits here -->           
</menu> 
```

注意图层是`<menu> <item> <menu> <item> </item> </menu> </item> </menu>`.

# java - 如何在 JavaEE 6 中捕获 OptimisticLockException？

> ID：14006882
> 
> 赞同：2
> 
> 时间：2012-12-22T21:54:03.407
> 
> 标签：java, jpa, java-ee-6, optimistic-locking

我想知道在 JavaEE 6 中捕获的最佳方法是什么`OptimisticLockException`。我有以下 EJB：

```
@Stateless
public class SeminarBooking {

public void bookSeminar(Long seminarId, int numberOfPersons) {
    ...
    //check capacity & do booking
    //OptimisticLockException can occur in this method
} 
```

这是我的 REST 接口：

```
@Path("/seminars")
@Produces("application/xml")
@Stateless
public class SeminarResource {

    @GET
    @Path("{id}/book")
    public Seminar bookSeminar(@PathParam("id") Long id, @QueryParam("persons") Integer persons) {
        try {
            seminarBooking.bookSeminar(id, persons);
            return seminarBooking.getSeminar(id);
        }
        catch(Exception e) {
            //why is this never called?
            logger.error(This will never happen, e);
            throw new WebApplicationException(e);
        }
} 
```

在 REST 接口中，我捕获了所有异常，此外，我看到`OptimisticLockException`如果我从浏览器调用接口，那么为什么 catch-Block 从未执行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:08:25.600

显而易见的答案是，该 try 块中没有引发有问题的异常。尝试阅读堆栈跟踪以查看它是从哪里抛出的。鉴于它与持久性有关，它很可能被抛出到您的事务边界，而不是您认为的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:10:30.753

它可能永远不会被调用，因为 SeminarResource 是一个事务性 EJB。这意味着事务在其`bookSeminar()`方法返回之后提交，而不是在它返回之前提交。

这个 bean 可能不应该是事务性的。如果不是，事务将在调用 SeminarBooking 服务时启动，并在它返回时提交。而且您将能够捕获提交引发的异常。

# c# - 在字符串中间匹配锚定正则表达式的快速方法

> ID：14006885
> 
> 赞同：2
> 
> 时间：2012-12-22T21:54:22.567
> 
> 标签：c#, .net, regex

考虑这样的代码：

```
Match match = new Regex("^bar").Match(some_string,3); 
```

我想匹配`some_string`，但不是从一开始，而是从给定位置开始。问题是，我想**准确地**从那个位置进行匹配，因此是锚点。

不幸的是，它不起作用。MS 正则表达式不能单独将字符串块作为字符串使用，因此仅匹配**字符串**`^`的一个且真正的开头，而不是**起始位置**。

 ****简单的解决方法是这样写：

```
Match match = new Regex("^bar").Match(some_string.Substring(3)); 
```

缩小尺寸——**速度**（即缺乏它）。

所以我的问题是——如何快速匹配字符串中间的锚定正则**表达式**？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T21:57:04.720

.NET 对引擎开始的位置有一个单独的锚点（通常是最后一场比赛的结束，在你的情况下是偏移量）`\G`：.

所以你应该可以使用模式`@"\Gbar"`。

[来源 (MSDN)](http://msdn.microsoft.com/en-us/library/3583dcyh.aspx)

> 如果要限制匹配，使其从字符串中的特定字符位置开始，并且正则表达式引擎不扫描字符串的其余部分以查找匹配项，请使用 a `\G`(在左侧为 left-从右到左的模式，或在右边的从右到左的模式）。这限制了匹配，因此它必须准确地从 开始`startat`。****

# visual-studio-2010 - 为什么 VS 2010 虚拟服务器不能识别以“/”开头的路径？

> ID：14006888
> 
> 赞同：0
> 
> 时间：2012-12-22T21:54:42.643
> 
> 标签：visual-studio-2010

当我设计我的网络应用程序时，我喜欢使用“/”来指定对根目录的访问。现在，这在我在 IIS 7.5 上运行的生产站点上完美运行。

但是，当我尝试在 VS 2010 的虚拟服务器上运行该站点时，我不断收到以“/”开头的任何路径的 404 错误。

现在，当我收到 404 错误时，地址栏中的地址是正确的地址。例如，我有一个指向`/index.aspx' - and on the iis7.5 webserver, the path becomes`http://my.site.com/index.aspx `and it navigates perfectly. However on the VS virtual server, the path becomes`http://localhost:61679/index.aspx 的链接，但我收到 404 错误。

但是，如果我不在路径中使用“/”——也就是说，我要么使用完整路径，要么不使用它，那么虚拟服务器将导航到`http://localhost:61679/index.aspx`应该的样子。

所以无论“/”是不是第一个字符，地址都是一样的。

这些链接都没有使用`runat="server"`，所以我不需要担心使用`~`。

是否有设置可以启用此功能？

**[更新]**

我还有一些线索：
- 当我导航到`http://localhost:61679/index.aspx`它时会得到 404。 - 如果我导航到`http://localhost:61679/mysite/index.aspx`它加载正常。- 以“/”开头的链接指向`http://localhost:61679/`NOT `http://localhost:61679/mysite`。- 这意味着“/”告诉 VS 服务器导航到服务器的根目录，而不是站点的根目录。但是，它在 IIS 中不能以这种方式工作。

如果我告诉 VS 使用 IIS Express，一切正常。

这意味着必须在某处进行设置，以使“/”指代 Visual Studio 内置服务器的站点根目录（我将其称为“虚拟服务器”）。

# c++ - 将 LPBYTE 转换为字符串

> ID：14006889
> 
> 赞同：2
> 
> 时间：2012-12-22T21:55:04.757
> 
> 标签：c++, registry, type-conversion, lpbyte

我正在从注册表中查询数据，它被输出为 LPBYTE，这就是我卡住的地方。我需要将 LPBYTE 转换为我可以操作的数据类型，例如字符串。

到目前为止，这是我的代码

```
HKEY hk;
string poolID;
DWORD dwSize     = 0;
DWORD dwDataType = 0;
DWORD dwValue;
LPBYTE lpValue   = NULL;
CA2W registryLocation("Software\\Example");
// Check registry if exists, otherwise create.
LONG openReg = RegOpenKeyEx(HKEY_CURRENT_USER, registryLocation, 0, KEY_QUERY_VALUE, &hk);
if (openReg==ERROR_SUCCESS) {  } else { cout << "Error (Could not open/create Registry Location)\n"; }
// Get buffer size
LONG getRegBuf = RegQueryValueExA(hk, "", 0, &dwDataType, lpValue, &dwSize);
if (getRegBuf==ERROR_SUCCESS) { cout << "Got reg key buf size\n"; } else { cout << "Error (registry key does not exist)/n"; intro(); }
lpValue = (LPBYTE)malloc(dwSize);
// Open reg value
LONG getReg = RegQueryValueExA(hk, "", 0, &dwDataType, (LPBYTE)&dwValue, &dwSize);
if (getReg==ERROR_SUCCESS) { cout << "Successful\n"; } else { cout << "Error\n"; }
cout << dwValue; 
```

任何帮助或代码示例将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:21:29.337

您需要声明`lpValue`为`char*`.

```
char* lpValue; 
```

然后通过调用来分配它`new`。

```
lpValue = new char[dwSize+1]; 
```

如果注册表数据格式错误并且缺少空终止符，请分配一个额外的元素。这是可能发生的事情。然后将最后一个元素设置为`\0`：

```
lpValue[dwSize] = '\0'; 
```

然后获取值：

```
LONG getReg = RegQueryValueExA(..., (LPBYTE)&dwValue, ...); 
```

使用解除分配`delete[]`：

```
delete[] lpValue; 
```

# javascript - 调用 Javascript 函数 oncellchange

> ID：14006891
> 
> 赞同：0
> 
> 时间：2012-12-22T21:55:24.783
> 
> 标签：javascript, html, javascript-events

我正在尝试调用 javascript 函数 oncellchange，但它不起作用。任何帮助/指导表示赞赏。这是我的代码......

```
<script type="text/javascript" language="javascript">

function trainingcourses_paging(pageclickednumber, parameter)
{
 alert('working');
}

</script>

<input type="text" name="date" id="date" 
 oncellchange="trainingcourses_paging('1','');" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T21:57:44.720

至少在当前所有主流浏览器中，输入元素都有 onchange 事件，而不是 oncellchange。我相信 oncellchange 仅来自旧版本的 IE。

```
<script type="text/javascript" language="javascript">

function trainingcourses_paging(pageclickednumber, parameter)
{
 alert('working');
}

</script>

<input type="text" name="date" id="date" 
 onchange="trainingcourses_paging('1','');" /> 
```

# javascript - 使用 Javascript 隐藏文本字段

> ID：14006892
> 
> 赞同：0
> 
> 时间：2012-12-22T21:55:34.080
> 
> 标签：javascript, html

如果用户在一个字段中选择了某个`option value`字段`select`，那么您如何制作一个文本字段`hidden`，而不需要它。这必须在提交表单之前完成吗？

例如，在以下选择字段中，用户选择选择`value='a'`该文本字段将如何隐藏：

```
 <select name="form" id="aForm">
        <option value="a">choice1</option>
        <option value="b">choice2</option>
        <option value="c">choice3</option>
     </select>

     <input type="text" style="width:285px" name="textField" id="textField"/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T22:00:21.853

```
$("#aForm").on("change", function() { 
    if ($(this).val() == "a") 
        $("#textField").hide();
    else 
        $("#textField").show(); 
}); 
```

这里也是一个[jsfiddle](http://jsfiddle.net/beradrian/PcLgu/1/)

我假设您将显示除 a 之外的任何其他值的文本字段。

如果您使用的是纯 JavaScript 而不是 jQuery

```
function hideTF() {
    var s = document.getElementById("aForm");
    document.getElementById("textField").style.display 
         = (s.selectedIndex > 0  && s.options[s.selectedIndex] == 'a'
         ? "none" : "block");
}
var s = document.getElementById("aForm");
if (s.attachEvent)
    s.attachEvent("onchange", hideTF);
else
    s.addEventListener("change", hideTF, false); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T21:58:11.577

您可以使用它的变体：

```
var selection = aForm.selectedIndex,
    field = document.getElementById('textField');

if ( selection === x ) {

    field.style.display = "block"; // or visibility = "hidden"

} 
```

这应该包含在一个`.onchange`事件中。是被选中的对应元素`aForm.selectedIndex`的索引。`<option>`

# css - CSS - 填充包含 div 的剩余宽度

> ID：14006893
> 
> 赞同：3
> 
> 时间：2012-12-22T21:55:51.807
> 
> 标签：css, html, width

我有一个包含 div，里面有几个 div。

这些都没有宽度。

我想让黑色 div 填充整个空间，所以它延伸到右侧的 ABC div。

只需要在 Chrome 中工作，尽管跨浏览器当然很受欢迎！

```
<div id="player">
    <div id="now_playing">
        <div id="now_playing_icon">
            A
        </div>
        <div id="now_next_container">
            <div id="now_next_now">
                Now: Blah Blah
            </div>
            <div id="now_next_next">
                Next: Blah Blah
            </div>
        </div>
        <div id="timeline">
            fill the remainder width 20px margin
        </div>
        <div id="now_playing_controls">
            ABC
        </div>
    </div>
</div>​

#now_next_container{
    float: left;
    padding-top: 15px;
}

#now_next_next{
    color: #777777;
    font-size: 13px;
}

#now_next_now{
    color: #303030;
    font-size: 16px;
}

#now_playing{
    background: #edeeed;
    height: 65px;
    width: auto;
}

#now_playing_controls{
    color: #303030;
    float: right;
    font-size: 20px;
    height: 65px;    
    line-height: 65px;
    margin-right: 30px;
}

#now_playing_icon{
    color: #303030;
    float: left;
    font-size: 25px;
    line-height: 65px;
    margin-left: 30px;
    padding-right: 10px;
}

#player{
    width: 100%;
}

#timeline{
    background: black;
    color: white;
    float: left;
    height: 25px;
    line-height: 25px;
    margin: 20px;
}
​ 
```

[http://jsfiddle.net/WCpHh/](http://jsfiddle.net/WCpHh/)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:15:16.950

鉴于您只需要支持 Webkit，如您的问题中所述，这增加了使用 flex-box 模型的可能性。当然，这仍处于供应商前缀模式：

```
#player {
    background-color: #eee;
    padding: 1em;
    text-align: center;
}

#now_playing {
    border: 1px solid #000;
    display: -webkit-flex;
    -webkit-flex-direction: row;
    -webkit-flex-wrap: nowrap;
}

#now_playing_icon {
    display: -webkit-flex-inline;
    -webkit-order: 1;
    -webkit-flex: 1 1 auto;
}

#now_next_container {
    display: -webkit-flex-inline;
    -webkit-flex-direction: column;
    -webkit-order: 2;
    -webkit-flex: 1 1 auto;
}

#timeline {
    color: #f90;
    background-color: #000;
    display: -webkit-flex-inline;
    -webkit-order: 3;
    -webkit-flex: 4 1 auto;
}

#now_playing_controls {
    display: -webkit-flex-inline;
    -webkit-order: 4;
    -webkit-flex: 1 1 auto;
    margin-left: 20px;
}
​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Hdqca/1/)。

这并没有，确切地说，“使用剩余空间”，它被明确指示（我正在努力解释这一点，因为我才刚刚开始试验）比其他项目大四倍同一行（它的`flex-grow`属性（`4`in `4 1 auto`）指示它“增长”四倍。但我认为，鉴于 Chrome 的相对最新的化身，它确实可以满足您的需求。

参考：

*   [CSS Flexbox 请！（Flexbox 游乐场/演示）](http://demo.agektmr.com/flexbox/)。
*   [CSS 灵活框布局模块 (W3.org)](http://www.w3.org/TR/css3-flexbox/)。
*   ['使用 CSS 灵活框' (MDN)](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_flexible_boxes)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:58:59.230

您将需要使用 Javascript。[这行得通](http://jsfiddle.net/cvZkB/1/)。对应的JS如下：

```
$(function() {
    var  $timeline = $('#timeline')
    ,    $nowNext = $('#now_next_container')
    ,    $controls = $('#now_playing_controls')
    ,    adjustTimeline = function() {
         var width = $controls.offset().left - ($nowNext.offset().left + $nowNext.outerWidth())
         width = width - parseInt($timeline.css('margin'), 10)*2
         $timeline.width(width)
    }
    adjustTimeline();
    $(window).on('resize', adjustTimeline);        
});​ 
```

# django - Django ORM：过滤计算字段 MySQL 状态/解决方法

> ID：14006894
> 
> 赞同：1
> 
> 时间：2012-12-22T21:55:54.457
> 
> 标签：django, django-orm

似乎 Django 开发人员意识到在 MySQL 中无法过滤这样的计算字段：

```
SomeModel.objects.extra(select={ 'total': 'SOME CALCULATION GOES HERE' }, where=['total < 10']) 
```

或者

```
SomeModel.objects.extra(select={ 'total': 'SOME CALCULATION GOES HERE' }).filter(total__lt=10) 
```

这在[https://code.djangoproject.com/ticket/8784](https://code.djangoproject.com/ticket/8784)中有所描述，但不幸的是，以目前的速度实施似乎还需要一年的时间。我理解开发团队的担忧，即理想情况下他们希望摆脱 .extra() ，因为通过在该语句中编写纯 SQL 代码变得与 DB 无关。我相信在许多项目中处理计算字段是相当普遍的任务，我目前面临着我无法解决的问题：我认为大多数社区经常使用这种肮脏的解决方法：

```
SomeModel.objects.extra(select={ 'total': 'SOME CALCULATION GOES HERE' }, where=['1 HAVING total < 10']) 
```

实际上它有效，但只有在您需要对上述语句的结果添加过滤器的那一刻：

```
SomeModel.objects.extra(select={ 'total': 'SOME CALCULATION GOES HERE' }, where=['1 HAVING total < 10']).filter(id__gt=300) 
```

这不再起作用，因为它转换为错误的 SQL 语句：

```
SELECT id, ..., (SOME CALCULATION) AS total
FROM some_table
WHERE (1 AND HAVING total < 10 AND id > 300) 
```

我想要实现的是在自定义模型管理器中有某种​​限制，这将允许我编写如下代码：

```
class SomeModelManager(models.Manager):
  def apply_total_restriction(self, restriction_num):
    return self.extra(select={ 'total': 'CALCULATION GOES HERE' }).filter(total__lt=restriction_num)

...

SomeModel.objects.apply_total_restriction(restriction_num).filter(created_by_id__exact=1) 
```

问题是：有人知道如何克服这个暂时的（希望如此）限制并完成任务吗？任何可能的替代方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T19:19:14.413

我找到了解决方案：我认为在 WHERE 子句中再次计算该字段会太慢，但是当我尝试它时它变得非常快并且不需要 HAVING。下面是我的意思的演示：

`SELECT (a + b / 2) as 'c', a, b FROM table WHERE (a + b / 2) >= 20 AND a != b`

基本上就是这样 - 如果您认为需要 HAVING，请尝试使用 HAVING 测量时间，并将其与再次计算计算字段的时间进行比较，然后在 WHERE 中对其进行过滤，然后得出结论。

# lisp - 对项目 euler 4 的 lisp 程序的反馈

> ID：14006895
> 
> 赞同：0
> 
> 时间：2012-12-22T21:56:12.273
> 
> 标签：lisp, common-lisp

我刚开始学习 common lisp，所以我一直在研究项目 euler 问题。这是我的解决方案（在[https://github.com/qlkzy/project-euler-cl](https://github.com/qlkzy/project-euler-cl)的帮助下）。你们对风格的改变有什么建议吗？

```
; A palindromic number reads the same both ways. The largest palindrome made 
; from the product of two 2-digit numbers is 9009 = 91 99.
; Find the largest palindrome made from the product of two 3-digit numbers.

(defun num-to-list (num)
    (let ((result nil))
        (do ((x num (truncate x 10)))
            ((= x 0 ) result)
            (setq result (cons (mod x 10) result)))))

(defun palindrome? (num) 
    (let ((x (num-to-list num)))
        (equal x (reverse x))))

(defun all-n-digit-nums (n)
    (loop for i from (expt 10 (1- n)) to (1- (expt 10 n)) collect i))

(defun all-products-of-n-digit-nums (n)
    (let ((nums (all-n-digit-nums n)))
        (loop for x in nums
            appending (loop for y in nums collecting (* x y)))))

(defun all-palindromes (n)
    (let ((nums (all-products-of-n-digit-nums n)))
        (loop for x in nums
            when (palindrome? x) collecting x)))

(defun largest-palindrome (n)
    (apply 'max (all-palindromes 3)))

(print (largest-palindrome 3)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T23:36:49.117

Barnar 的解决方案很棒，但是只有一个小错字，返回结果应该是：

```
(defun largest-palindrome (n)
  (loop with start = (expt 10 (1- n))
        and end = (1- (expt 10 n))
        for i from start to end
        maximize (loop for j from i to end
                       for num = (* i j)
                       when (palindrome? num)
                       maximize num))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:42:19.523

```
(setq list (cons thing list)) 
```

可以简化为：

```
(push thing list) 
```

我对您的代码的其他评论与其说是关于 Lisp 风格，不如说是关于算法。创建所有这些中间数字列表似乎是一种糟糕的方法，只需编写嵌套循环来计算和测试数字。

```
(defun all-palindromes (n)
  (loop for i from (expt 10 (1- n)) to (1- (expt 10 n))
    do (loop for j from (expt 10 (1- n)) to (1- (expt 10 n))
             for num = (* i j)
         when (palindrome? num)
           collect num))) 
```

但是`LOOP`有一个功能可以使用：`MAXIMIZE`. 因此`COLLECT`，您可以：

```
(defun largest-palindrome (n)
  (loop with start = (expt 10 (1- n))
        and end = (1- (expt 10 n))
        for i from start to end
    do (loop for j from start to end
             for num = (* i j)
         when (palindrome? num)
           maximize num))) 
```

这是另一个优化：

```
(defun largest-palindrome (n)
  (loop with start = (expt 10 (1- n))
        and end = (1- (expt 10 n))
        for i from start to end
    do (loop for j from i to end
             for num = (* i j)
         when (palindrome? num)
           maximize num))) 
```

使内部循环从开始`i`而不是避免检查和`start`检查的冗余。`M*N``N*M`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T09:47:50.297

下面的例子有点做作，但它发现回文的迭代次数比原来的方法少得多：

```
(defun number-to-list (n)
  (loop with i = n
     with result = nil
     while (> i 0) do
       (multiple-value-bind (a b)
           (floor i 10)
         (setf i a result (cons b result)))
     finally (return result)))

(defun palindrome-p (n)
  (loop with source = (coerce n 'vector)
       for i from 0 below (floor (length source) 2) do
       (when (/= (aref source i) (aref source (- (length source) i 1)))
         (return))
       finally (return t)))

(defun suficiently-large-palindrome-of-3 ()
  ;; This is a fast way to find some sufficiently large palindrome
  ;; that fits our requirement, but may not be the largest
  (loop with left = 999
     with right = 999
     for maybe-palindrome = (number-to-list (* left right)) do
       (cond
         ((palindrome-p maybe-palindrome)
          (return (values left right)))
         ((> left 99)
          (decf left))
         ((> right 99)
          (setf left 999 right (1- right)))
         (t                             ; unrealistic situation
                                        ; we didn't find any palindromes
                                        ; which are multiples of two 3-digit
                                        ; numbers
          (return)))))

(defun largest-palindrome-of-3 ()
  (multiple-value-bind (left right)
      (suficiently-large-palindrome-of-3)
    (loop with largest = (* left right)
       for i from right downto left do
         (loop for j from 100 to 999
            for maybe-larger = (* i j) do
              (when (and (> maybe-larger largest)
                         (palindrome-p (number-to-list maybe-larger)))
                (setf largest maybe-larger)))
       finally (return largest))))      ; 906609 
```

它还尝试优化检查数字是否为回文的方式，但会增加内存成本。它还使用稍长的代码将数字拆分为一个列表，但减少了划分（这在计算上有点昂贵）。

整个想法是基于这样一个概念，即最大的回文将在某个地方更接近......最大的乘数，因此，从 99 * 99 开始，您将有很多糟糕的匹配。相反，它尝试从 999 * 999 开始，首先找到一些看起来不错的回文，以“草率”的方式进行。然后它会努力改进最初的发现。

# git - Git：不允许用户将新分支推送到远程仓库

> ID：14006896
> 
> 赞同：1
> 
> 时间：2012-12-22T21:56:17.280
> 
> 标签：git, git-push, remote-branch

有时，一些用户会错误地将他们的本地分支推送到远程仓库，在远程仓库上创建一个新分支。我们如何禁止用户在远程仓库上创建新分支，但仍允许他们将更改推送到现有分支。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:03:45.560

这在一定程度上取决于您的远程存储库在哪里。如果您可以完全控制它，那么创建一个`update` [钩子](http://git-scm.com/docs/githooks)可能是最简单的解决方案。您只需使用允许的分支列表检查分支名称（参考名称），如果不匹配，则拒绝更新。

如果您使用[Gitolite](http://sitaramc.github.com/gitolite/)对您的存储库进行访问控制，您也可以只指定[规则](http://sitaramc.github.com/gitolite/rules.html)以仅应用于已知分支并禁止对所有其他分支进行推送访问。

# c# - 从 C# 在同一环境中执行多个命令

> ID：14006897
> 
> 赞同：5
> 
> 时间：2012-12-22T21:56:19.747
> 
> 标签：c#, windows, visual-studio, process

我正在开发一个小型 C# GUI 工具，它应该获取一些 C++ 代码并在通过一些向导后对其进行编译。如果我在运行著名的`vcvarsall.bat`. 现在我希望用户不要先进入命令提示符，而是先调用程序`vcvars`和`nmake`我需要的其他工具。为此，`vcvars`显然应该保留设置的环境变量。

我怎样才能做到这一点？

我能找到的最好的解决方案是创建一个临时`cmd`/`bat`脚本来调用其他工具，但我想知道是否有更好的方法。

* * *

更新：我同时尝试了批处理文件和 cmd。使用批处理文件时，vcvars 将终止完整的批处理执行，因此我的第二个命令（即 nmake）将不会被执行。我目前的解决方法是这样的（缩短）：

```
string command = "nmake";
string args = "";
string vcvars = "...vcvarsall.bat";
ProcessStartInfo info = new ProcessStartInfo();
info.WorkingDirectory = workingdir;
info.FileName = "cmd";
info.Arguments = "/c \"" + vcvars + " x86 && " + command + " " + args + "\"";
info.CreateNoWindow = true;
info.UseShellExecute = false;
info.RedirectStandardOutput = true;
Process p = Process.Start(info); 
```

这可行，但不会捕获 cmd 调用的输出。仍在寻找更好的东西

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T09:03:29.000

我有几个不同的建议

1.  **您可能想使用 MSBuild 而不是 NMake 进行研究**

    它更复杂，但可以直接从 .Net 控制，它是 VS 项目文件的格式，适用于从 VS 2010 开始的所有项目，以及 C#/VB/等。比这更早的项目

2.  **您可以使用一个小的帮助程序捕获环境并将其注入您的进程**

    这可能有点矫枉过正，但它会起作用。vsvarsall.bat 没有比设置一些环境变量更神奇的事情了，所以您所要做的就是记录运行它的结果，然后将其重播到您创建的进程的环境中。

*帮助程序*(envcapture.exe) 很简单。它只是列出其环境中的所有变量并将它们打印到标准输出。这是整个程序代码；坚持下去`Main()`：

```
XElement documentElement = new XElement("Environment");
foreach (DictionaryEntry envVariable in Environment.GetEnvironmentVariables())
{
    documentElement.Add(new XElement(
        "Variable",
        new XAttribute("Name", envVariable.Key),
        envVariable.Value
        ));
}

Console.WriteLine(documentElement); 
```

您可能只需调用而不是该程序并解析该输出即可逃脱`set`，但是如果任何环境变量包含换行符，则可能会中断。

*在您的主程序中：*

首先，必须捕获由 vcvarsall.bat 初始化的环境。为此，我们将使用一个类似于`cmd.exe /s /c " "...\vcvarsall.bat" x86 && "...\envcapture.exe" "`. vcvarsall.bat 修改环境，然后 envcapture.exe 打印出来。然后，主程序捕获该输出并将其解析为字典。（注意：`vsVersion`这里可能是 90 或 100 或 110）

```
private static Dictionary<string, string> CaptureBuildEnvironment(
    int vsVersion, 
    string architectureName
    )
{
    // assume the helper is in the same directory as this exe
    string myExeDir = Path.GetDirectoryName(
        Assembly.GetExecutingAssembly().Location
        );
    string envCaptureExe = Path.Combine(myExeDir, "envcapture.exe");
    string vsToolsVariableName = String.Format("VS{0}COMNTOOLS", vsVersion);
    string envSetupScript = Path.Combine(
        Environment.GetEnvironmentVariable(vsToolsVariableName),
        @"..\..\VC\vcvarsall.bat"
        );

    using (Process envCaptureProcess = new Process())
    {
        envCaptureProcess.StartInfo.FileName = "cmd.exe";
        // the /s and the extra quotes make sure that paths with
        // spaces in the names are handled properly
        envCaptureProcess.StartInfo.Arguments = String.Format(
            "/s /c \" \"{0}\" {1} && \"{2}\" \"",
            envSetupScript,
            architectureName,
            envCaptureExe
            );
        envCaptureProcess.StartInfo.RedirectStandardOutput = true;
        envCaptureProcess.StartInfo.RedirectStandardError = true;
        envCaptureProcess.StartInfo.UseShellExecute = false;
        envCaptureProcess.StartInfo.CreateNoWindow = true;

        envCaptureProcess.Start();

        // read and discard standard error, or else we won't get output from
        // envcapture.exe at all
        envCaptureProcess.ErrorDataReceived += (sender, e) => { };
        envCaptureProcess.BeginErrorReadLine();

        string outputString = envCaptureProcess.StandardOutput.ReadToEnd();

        // vsVersion < 110 prints out a line in vcvars*.bat. Ignore 
        // everything before the first '<'.
        int xmlStartIndex = outputString.IndexOf('<');
        if (xmlStartIndex == -1)
        {
            throw new Exception("No environment block was captured");
        }
        XElement documentElement = XElement.Parse(
            outputString.Substring(xmlStartIndex)
            );

        Dictionary<string, string> capturedVars 
            = new Dictionary<string, string>();

        foreach (XElement variable in documentElement.Elements("Variable"))
        {
            capturedVars.Add(
                (string)variable.Attribute("Name"),
                (string)variable
                );
        }
        return capturedVars;
    }
} 
```

稍后，当你想在构建环境中运行命令时，只需将新进程中的环境变量替换为之前捕获的环境变量即可。`CaptureBuildEnvironment`每次运行程序时，您应该只需要为每个参数组合调用一次。不要尝试在运行之间保存它，否则它会变得陈旧。

```
static void Main()
{
    string command = "nmake";
    string args = "";

    Dictionary<string, string> buildEnvironment = 
        CaptureBuildEnvironment(100, "x86");

    ProcessStartInfo info = new ProcessStartInfo();
    // the search path from the adjusted environment doesn't seem
    // to get used in Process.Start, but cmd will use it.
    info.FileName = "cmd.exe";
    info.Arguments = String.Format(
        "/s /c \" \"{0}\" {1} \"",
        command,
        args
        );
    info.CreateNoWindow = true;
    info.UseShellExecute = false;
    info.RedirectStandardOutput = true;
    info.RedirectStandardError = true;
    foreach (var i in buildEnvironment)
    {
        info.EnvironmentVariables[(string)i.Key] = (string)i.Value;
    }

    using (Process p = Process.Start(info))
    {
        // do something with your process. If you're capturing standard output,
        // you'll also need to capture standard error. Be careful to avoid the
        // deadlock bug mentioned in the docs for
        // ProcessStartInfo.RedirectStandardOutput. 
    }
} 
```

如果您使用它，请注意，如果 vcvarsall.bat 丢失或失败，它可能会严重死机，并且使用非 en-US 语言环境的系统可能会出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:28:25.390

可能没有比收集您需要的所有数据、生成 bat 文件并使用`Process`类运行它更好的方法了。正如您所写，您正在重定向输出，这意味着您必须进行设置`UseShellExecute = false;`，所以我认为除了从 bat 文件中调用 SET 之外，没有其他方法可以设置变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T20:22:21.697

编辑：为 nmake 调用添加特定用例

过去我需要获得各种“构建路径的东西”，这就是我所使用的 - 你可能需要在这里或那里调整一些东西以适应，但基本上，vcvars 所做的唯一事情就是设置一个一堆路径；这些辅助方法会获取这些路径名，您只需要将它们传递到您的开始信息中：

```
public static string GetFrameworkPath()
{
    var frameworkVersion = string.Format("v{0}.{1}.{2}", Environment.Version.Major, Environment.Version.Minor, Environment.Version.Build);
    var is64BitProcess = Environment.Is64BitProcess;
    var windowsPath = Environment.GetFolderPath(Environment.SpecialFolder.Windows);
    return Path.Combine(windowsPath, "Microsoft.NET", is64BitProcess ? "Framework64" : "Framework", frameworkVersion);  
}

public static string GetPathToVisualStudio(string version)
{   
    var is64BitProcess = Environment.Is64BitProcess;
    var registryKeyName = string.Format(@"Software\{0}Microsoft\VisualStudio\SxS\VC7", is64BitProcess ? @"Wow6432Node\" : string.Empty);
    var vsKey = Microsoft.Win32.Registry.LocalMachine.OpenSubKey(registryKeyName);
    var versionExists = vsKey.GetValueNames().Any(valueName => valueName.Equals(version));
    if(versionExists)
    {
        return vsKey.GetValue(version).ToString();
    }
    else
    {
        return null;
    }
} 
```

您可以通过以下方式利用这些东西：

```
var paths = new[]
    { 
        GetFrameworkPath(), 
        GetPathToVisualStudio("10.0"),
        Path.Combine(GetPathToVisualStudio("10.0"), "bin"),
    };  

var previousPaths = Environment.GetEnvironmentVariable("PATH").ToString();
var newPaths = string.Join(";", previousPaths.Split(';').Concat(paths));
Environment.SetEnvironmentVariable("PATH", newPaths);

var startInfo = new ProcessStartInfo()
{
    FileName = "nmake",
    Arguments = "whatever you'd pass in here",
};
var process = Process.Start(startInfo); 
```

# css - 即使没有空间，如何防止我的 li's 低于我的菜单？

> ID：14006904
> 
> 赞同：0
> 
> 时间：2012-12-22T21:57:20.260
> 
> 标签：css, css-float

我已经创建了一个菜单，但无法解决这个问题，所以我希望有人可以帮助我:(

**问题**我菜单中的最后一个 li（锚标签）一直在我的菜单下方折叠，无论我做什么问题都仍然存在。在 Firefox 中看起来不错但是在所有其他浏览器中，这是一场灾难......

我尝试过：添加溢出：隐藏；到我的菜单包装器，尝试在最后一个 ul 标记后添加“清除两个”div，添加 display:inline-block 到 li 标签，还有很多解决我的问题的其他方法，但没有任何效果：（
我没有为我的锚标签设置显式宽度（**我*真的*不想这样做！**）。
在 Firefox 中看起来很完美：
[http ://robertpeic.com/kyani /template/menu.png](http://robertpeic.com/kyani/template/menu.png)
在其他浏览器中看起来像这样：（*请注意没有蓝色按钮，因为它出现在我的菜单下方*）
[http://robertpeic.com/kyani/template/menu2.png](http://robertpeic.com/kyani/template/menu2.png)
我不想要这个：
[http ://robertpeic.com/kyani/template/menu3.png](http://robertpeic.com/kyani/template/menu3.png)

**问题：**即使没有空间，如何防止我的 li's 低于我的菜单？
谢谢你的帮助！！

[**链接到我的菜单**](http://robertpeic.com/kyani/)

相关的 CSS 如下所示：

```
.mainmenu{
display:block;
width:906px;
margin:0px auto;
height:42px;
background-image:url('http://robertpeic.com/kyani/template/mainmenubg.jpg');
background-repeat:repeat-x;
position:relative;
margin-top:-15px;
z-index:160;
}

.mainmenu ul{
list-style-type:none;
}

.mainmenu ul li {
float:left;
}

.mainmenu ul li a{
text-decoration:none;
display:block;
font-family:"Palatino Linotype","Book Antiqua",Palatino,FreeSerif,serif;
font-size:20px;
padding:0 23px 0 23px;
color:#383838;
border-left:1px solid #dedede;
height:42px;
line-height:42px;
z-index:100;
}

.mainmenu ul li a:hover{
color:#ffffff;
}

.mainHover{
background-image:url('http://robertpeic.com/kyani/template/hoverm.png');
display:block;
position:relative;
background-repeat:repeat-x;
z-index:-50;
} 
```

html看起来像：

```
<div class="mainmenu">
<ul>
<li><a href="#">Početna</a></li>
<li><a href="#">Ky&auml;ni</a></li>
<li><a href="#">Trokut zdravlja</a></li>
<li><a href="#">Poslovna prilika</a></li>
<li><a href="#">Info predavanja</a></li>
<li><a href="#">Kontakt</a></li>
</ul>
</div><!--/mainmenu--> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T22:19:27.087

我添加`overflow:hidden`并`.mainmenu`更改了填充`.mainmenu ul li a`，它对我有用。

```
.mainmenu
overflow:hidden;

.mainmenu ul li a
padding:0 22px 0 23px; 
```

我发现获得具有跨浏览器兼容性的一致全宽菜单栏的最佳方法是强制 LI 的宽度。虽然它不是一个非常前向兼容的。这是我找到的保持视觉设计完整性的最佳方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T22:20:20.537

将主菜单 div 的宽度设置为 910 像素。它会解决你的问题，也不会显示任何白色间距

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T22:26:04.053

您的整个 html 将如下所示。在测试您的代码时，我发现，如果我省略第一行 DocType... 菜单会在 IE 中被破坏。在 Chrome 中它工作正常。所以AFAIK，你的问题是Doctype。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title></title>

        <style>
            .mainmenu
            {
                display: block;
                width: 906px;
                margin: 0px auto;
                height: 42px;
                background-image: url('http://robertpeic.com/kyani/template/mainmenubg.jpg');
                background-repeat: repeat-x;
                position: relative;
                margin-top: -15px;
                z-index: 160;
            }

            .mainmenu ul
            {
                list-style-type: none;
            }

            .mainmenu ul li
            {
                float: left;
            }

            .mainmenu ul li a
            {
                text-decoration: none;
                display: block;
                font-family: "Palatino Linotype" , "Book Antiqua" ,Palatino,FreeSerif,serif;
                font-size: 20px;
                padding: 0 20px ;
                color: #383838;
                border-left: 1px solid #dedede;
                height: 42px;
                line-height: 42px;
                z-index: 100;
            }

            .mainmenu ul li a:hover
            {
                color: #ffffff;
            }

            .mainHover
            {
                background-image: url('http://robertpeic.com/kyani/template/hoverm.png');
                display: block;
                position: relative;
                background-repeat: repeat-x;
                z-index: -50;
            }
        </style>
    </head>
    <body>
    <div class="mainmenu">
        <ul>
            <li><a href="#">Pocetna</a></li>
            <li><a href="#">Ky&auml;ni</a></li>
            <li><a href="#">Trokut zdravlja</a></li>
            <li><a href="#">Poslovna prilika</a></li>
            <li><a href="#">Info predavanja</a></li>
            <li><a href="#">Kontakt</a></li>
        </ul>
    </div>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-23T14:45:21.897

我现在感觉很蠢 :) 为了防止我的 li 低于我只用其他 div 包装我的菜单并将该 div 设置为溢出隐藏并且它工作得很好！谢谢大家的帮助！！！

CSS 现在看起来像：

```
.mainmenu{
 display:block;
 width:903px;
 }

 .mainmenu ul{
 list-style-type:none;
 }

 .mainmenu ul li {
 float:left;
  }

 .mainmenu ul li a{
 text-decoration:none;
 display:block;
 font-family:"Palatino Linotype","Book Antiqua",Palatino,FreeSerif,serif;
 font-size:20px;
 padding:0 23px 0 23px;
 color:#383838;
 border-left:1px solid #dedede;
 height:42px;
 line-height:42px;
 z-index:100;
 }

 .mainmenu ul li a:hover{
 color:#ffffff;
 }

.menuwrap{
margin:0px auto;
height:42px;
background-image:url('http://robertpeic.com/kyani/template/mainmenubg.jpg');
background-repeat:repeat-x;
position:relative;
margin-top:-15px;
z-index:160;
width:900px;
overflow:hidden;
} 
```

HTML 看起来像这样：

```
 <div class="menwrap">
      <div class="mainmenu">
      <ul>
      <li><a href="#">Početna</a></li>
      <li><a href="#">Ky&auml;ni</a></li>
      <li><a href="#">Trokut zdravlja</a></li>
      <li><a href="#">Poslovna prilika</a></li>
      <li><a href="#">Info predavanja</a></li>
      <li><a href="#">Kontakt</a></li>
      </ul>
      </div><!--/mainmenu-->
      </div><!--/menuwrap--> 
```

# visual-studio-2010 - Visual C++ 2010：在一个解决方案中包含几个项目的提升？

> ID：14006905
> 
> 赞同：3
> 
> 时间：2012-12-22T21:57:20.757
> 
> 标签：visual-studio-2010, visual-c++, configuration, dry, propertysheet

我在 Visual C++ 2010 解决方案的几个项目中使用了[boost 库](http://www.boost.org/)。我目前正在做的是通过设置修改每个项目的属性：

1.  Properties->Configuration Properties->C/C++->General->Additional Include Directories 包含boost目录`C:\boost\boost_1_47`

2.  Properties->Configuration Properties->Linker->General->Additional Library Directories 以包含 boost lib 目录`C:\boost\boost_1_47\lib`

现在我将我的 boost 版本升级到 1.51，我意识到我通过多次指定此信息（即每个项目一次）违反了 DRY。我想在一个地方定义提升信息。

经过研究，似乎[属性表](http://msdn.microsoft.com/en-us/library/a4xbdz1e%28v=vs.100%29.aspx)是一个很好的解决方案。我已经阅读了有关属性表继承的信息，但我看不出这有什么用，因为似乎如果您想添加一个特定于项目的包含目录，那么您将必须在该特定项目的属性中设置附加包含目录然后将覆盖定义 boost 包含目录的继承属性表。如果我对此有误，请纠正我。

所以我的下一个想法是创建一个名为 GlobalMacros.prop 的属性表并定义一个类似的用户宏`$(BoostDir)`，然后将此属性表添加到每个项目中。然后我可以在定义包含目录和库目录时在每个项目的属性中使用宏。但是，在创建宏时，有一个选项“将此宏设置为构建环境中的环境变量”，我不确定它的作用或是否应该设置它。

总的来说，我想知道减少常见设置的重复配置定义的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T22:52:33.620

我实际上是最初在 VS 2005 中在 Visual C++ 中实现属性表的开发人员（尽管我不对 VC++ 项目属性对话框的混乱负责）。警告：我在 2005 年之后停止了 VC++ 的工作，所以下面的内容对于您的版本可能并不完全准确。

在属性管理器中，您应该能够在所有项目中多选所有项目配置并添加新的属性表。这将自动从同一属性表继承这些项目配置。在该属性表中，直接设置 boost include 和 library 目录，或者为**BoostVersion**和**BoostDir**使用宏，并在属性表的属性中使用这些宏。

如果项目配置已选中“从父级或项目默认值继承”（这控制在 2005/2008 年插入 $(Inherit) 与 $(NoInherit) 并在 2010/2012 年插入 %(<propertyname>)），您应该查看项目配置中设置的任何项目特定属性，默认情况下，附加到属性表中的值。

您可以通过转到一个项目并检查编译器的“命令行”选项卡以查看开关是否符合您的预期来确认这一点。

编辑：请注意，VC++ 中有两种类型的属性：“单值”和“多值”。单值属性的一个示例是编译器的警告级别。单值属性的命令行上的值来自指定它的属性继承链中的第一个位置，从项目配置开始，然后是属性表，然后是项目系统中的内置默认值。多值属性的一个示例是编译器的包含目录。除非指定了 $(NoInherit) (2005/2008) 或未指定 %(<propertyname>) (2010/2012)，否则多值属性将与其父属性表连接。因此，默认情况下，

# python - 检查字典中的成员资格：例外还是设置？

> ID：14006906
> 
> 赞同：1
> 
> 时间：2012-12-22T21:57:22.207
> 
> 标签：python, dictionary, set

我想处理一个元素列表`ls`，每个元素在字典中可能有也可能没有相应的元素`d`。我可以想到两种方法来做到这一点。这里，`s`是所有作为 键的元素的集合`d`。在构造时，构造`d`也是微不足道的`s`，所以把它当作给定的。

```
for e in ls:
    if e in s:
        process(d[e]) 
```

和

```
for e in ls:
    try:
        process(d[e])
    except KeyError:
        pass 
```

两者中，哪个更快？此外，我听说 Python 使用“请求宽恕，而不是许可”的原则。这是否意味着通常使用`if`语句进行测试会比使用异常慢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T22:02:14.517

如果顺序无关紧要，请使用交叉点：

```
for e in s.intersection(ls):
    # only elements that are in `s` *and* `ls` are iterated over
    process(d[e]) 
```

`process()`无论如何，您的大部分时间都可能会花在上面，所以不要进行微优化。而是优化可读性（在合理范围内）。

至于`in`测试与异常处理的选择：如果未命中的数量较少（相对较少的异常），异常处理会更快，但如果未命中很多，则`in`测试将比处理大量异常更快。如果您真的在乎，请使用该 [`timeit`模块](http://docs.python.org/2/library/timeit.html)找到平衡点。在 Programmers.SE 上查看[我对这个主题的回答](https://softwareengineering.stackexchange.com/questions/175655/175663#175663)。

# php - 在短代码中添加 php

> ID：14006909
> 
> 赞同：2
> 
> 时间：2012-12-22T21:57:31.600
> 
> 标签：php, wordpress, variables, custom-fields, shortcode

那么我想做的是在我的wordpress侧边栏中添加一个条形码。用于生成条码的插件叫做 Yeblon

[Yeblon 插件页面](http://wordpress.org/extend/plugins/yeblon-qr-code-generator/)

插件使用的简码是

```
[yeblonqrcode size="100" url="" class="" style=""] 
```

url 是生成的条形码指向的位置

我要生成的 url 是从自定义字段中插入的。我使用了一个名为 Advanced Custom Fields 的插件。

[高级自定义字段插件页面](http://wordpress.org/extend/plugins/advanced-custom-fields/)

显示链接的代码是

```
<?php the_field("download_(android)" , $post->ID); ?> 
```

所以我的最终代码是

```
 <div id="mobile-barcodes-tabs">
        <?php $post = $wp_query->post; ?>
        <?php
        if(get_field('download_(android)')){ ?>
            <?php echo do_shortcode('[yeblonqrcode size="100" url="the_field("download_(android)" , $post->ID);" class="" style=""] ');?>
        <?php }
        ?>
    </div> 
```

但它不起作用我不知道是什么问题如果你帮助我我会很高兴提前谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T22:07:56.097

预先构建 PHP 值并使用字符串连接：

```
<div id="mobile-barcodes-tabs">
    <?php 
    $post = $wp_query->post;   
    $the_url = get_field( 'download_(android)' , $post->ID );   
    if( $the_url ) {            
        echo do_shortcode( '[yeblonqrcode size="100" url="' . $the_url . '" class="" style=""]' );
     }
    ?>
</div> 
```

*PS：您可能注意到我删除了所有不必要的打开和关闭 PHP 标记。*

# c# - 找不到xml文件

> ID：14006912
> 
> 赞同：-2
> 
> 时间：2012-12-22T21:57:43.690
> 
> 标签：c#, xml, wcf

我正在研究wcf。在我的测试项目中，服务从 xml 文件中读取数据，然后将其发送给客户端。数据是“myClass”类型的数组。服务类有一个功能 复制代码

```
 private XDocument GetDB()
    {

        string filePath = "SampleDB.xml"           
        return XDocument.Load(filePath);
    } 
```

此功能在我运行服务应用程序时起作用。但是当我从客户端调用服务时它不起作用。

位于**bin->debug**文件夹中的 xml 文件的副本。但是当我运行程序时，我看到这样的异常

> 找不到文件“C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\SampleDB.xml”。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T22:14:44.817

显然，给出文件的完整路径，应该以 bin\debug\SampleDB.xml 结尾

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-15T15:48:28.123

您必须使用 .xml 指定 xml 文件`Server.MapPath`。

```
string filePath = Server.MapPath("SampleDB.xml"); 
```

这就是“找不到文件'C:\Program Files (x86)\Microsoft Visual Studio 10.0\Common7\IDE\SampleDB.xml”的解决方案。

# php - Ip 到 Hostname Lookup 然后确认

> ID：14006921
> 
> 赞同：0
> 
> 时间：2012-12-22T21:59:52.113
> 
> 标签：php, ip-address, hostname

所以我想做的是检查一个IP地址，例如：66.249.74.233。该 IP 地址在查找主机名时会转换为： crawl-66-249-74-233.googlebot.com。

然后我想从那里做检查： crawl-66-249-74-233.googlebot.com 以确保它属于谷歌。我相信它可以做到，但我不确定我在寻找什么来传递主机名以确认它属于谷歌。

有什么想法吗？

# sql - SQL在GridView中只绑定DateTime的时间组件

> ID：14006924
> 
> 赞同：0
> 
> 时间：2012-12-22T22:00:01.427
> 
> 标签：sql, gridview, time

我有一个包含以下列的表：StartTime 和 Endtime（例如：15:40 和 18:20）。我对这些列使用 DateTime，它们是网格视图的活页夹。

有没有机会我只能在列中显示时间组件？GridView 还允许更新。我可以以某种方式指定如果插入 15:40，它实际上意味着一个日期时间）？

您认为这是可能的，还是我应该为此使用 ObjectDataSource ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T22:08:15.197

为了只显示 DateTime 的日期部分，您可以使用 asp:BoundField 的 DataFormatString 属性。例如：

```
<asp:BoundField DataField="columnname" DataFormatString="{0:HH:mm:ss}" /> 
```

就更新而言，您可能希望实现一个函数来处理 GridView 的 OnRowUpdating 事件。

# php - 使用 Yii 样板设置公共 HTML 文件夹的正确方法是什么？

> ID：14006926
> 
> 赞同：3
> 
> 时间：2012-12-22T22:00:14.193
> 
> 标签：php, frameworks, yii, boilerplate

我找不到指定如何设置公共 html 目录的文档。我正在尝试将所有其他文件和文件夹保留在站点根目录中。由于有一个前端和后端公共 html 文件夹，我看不出这是怎么可能的。

我的网站：

```
/site/perl/
/site/www/      <-How do you get just the 2 public folders here?  
/site/.ssh 
```

Yii 样板：

```
runpostdeploy
yiic
/backend/
 - /config
 - /www/index.php
/frontend/
 - /config
 - /www/index.php
/common/
/console/
/tests/ 
```

整个样板项目是否应该驻留在网站的公共 html 文件夹中？我认为这样做是不好的做法。

```
*** U P D A T E *** 
```

花了大部分时间试图解决这个问题。我能找到的最接近的东西是对 Yii Framwork 论坛帖子之一的评论。现在，我正在运行带有子域的样板，就像他们在此评论中推荐的那样。

[http://www.yiiframework.com/wiki/155/the-directory-structure-of-the-yii-project-site/#c9444](http://www.yiiframework.com/wiki/155/the-directory-structure-of-the-yii-project-site/#c9444)

我不确定这是否是正确的方法。但它有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T19:54:39.533

我相信如果你有两个申请，那么你需要两个地址。您可以像这样使用子目录：

```
www.site-name.com -> ../frontend/www/index.php
www.site-name.com/admin -> ../backend/www/index.php 
```

或者您可以像这样使用子域：

```
www.site-name.com -> ../frontend/www/index.php
admin.site-name.com -> ../backend/www/index.php 
```

就像Wordpress一样，如果你需要进入管理页面，你可以通过地址www.site-name.com/wp-admin访问

但是，如果您将此别名用于后端，请确保不要在前端使用“管理员”路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:06:18.547

您应该将站点公共主管设置为`frontend/www/`. 背后的想法`Yii Boilerplate` `backend/www`是为管理选项（如果需要）提供单独的域，而不是单独的模块。这样你就可以轻松地拥有单独`CWebUser`的`Yii::app()`等。[通过文档](https://github.com/clevertech/YiiBoilerplate)：

*backend：后端应用程序，主要由站点管理员用来管理整个系统（避免前端应用程序中的管理模块以避免混淆）*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T10:37:34.767

花了大部分时间试图解决这个问题。我能找到的最接近的东西是对 Yii Framwork 论坛帖子之一的评论。现在，我正在运行带有子域的样板，就像他们在此评论中推荐的那样。

[http://www.yiiframework.com/wiki/155/the-directory-structure-of-the-yii-project-site/#c9444](http://www.yiiframework.com/wiki/155/the-directory-structure-of-the-yii-project-site/#c9444)

我不确定这是否是正确的方法。但它有效。

# .net - 减少预先确定的div背景淡化的功能

> ID：14006931
> 
> 赞同：1
> 
> 时间：2012-12-22T22:00:53.507
> 
> 标签：.net, css, less, dotless

## 背景/目标

我有一些div。在每个 div 上，我想放置两个不同的类（每个类在我的应用程序中都有不同的逻辑含义）。

我希望一个类代表一个级别，这将转化为 div 的颜色。我想要另一个类来表示距离，并控制应用任何背景的淡入淡出级别。

所以我希望 div 看起来像：

```
<div class="element level-beginner distance-long"> 
```

并希望将其转化为褪色的绿色背景。

我对 LESS 了解一点（但只知道一点点），这似乎不是嵌套样式会有所帮助的情况（因为它不处理子元素，而是处理某个类是否已经被应用）。

本质上，**我想将颜色和不透明度/淡化控制为相互独立的 CSS 类**。

## 问题

*   有没有办法利用 less 以便一个类可以控制 div 元素背景的 alpha/fade 而不必指定颜色？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:28:09.210

LESS 颜色不透明度函数（淡入、淡出、淡出）需要颜色作为其第一个参数。LESS 不知道你将如何组合你的类，所以它不知道从哪里获得颜色。

CSS中有一个`opacity`属性，但是它调整整个元素（包括文本）的透明度。

您唯一真正的选择是为您计划使用的每个组合写出选择器，或者有一个可以为您生成它们的 mixin：

```
.themeMatrix(@color) {
    &.styleA {
        background: fade(@color, 50%);
    }

    &.styleB {
        background: fade(@color, 20%);
    }

    &.styleC {
        border: 1px solid @color;
    }
}

.colorA {
    .themeMatrix(white);
}

.colorB {
    .themeMatrix(green);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T22:31:48.533

仅使用 HTML、CSS 和 LESS，一个应用到一个元素的类无法“知道”另一个类的背景颜色是什么，以便将其淡出。这是不可能的。

但是，您仍然可以获得类似的效果，允许您链接类以创建新效果。

编写此代码的基本、普通的 CSS 方式如下：

```
.fire {
  background: rgb(255,0,0)
}
.fire.level-beginner {
  background: rgba(255,0,0,.5)
}
.fire.level-pro {
  background: rgba(255,0,0,.25)
} 
```

使用这个 CSS，如果一个元素有 class`.fire` *和* `.level-beginner`，它会得到淡出的背景。

现在，这就是预处理器很酷的原因：我们可以让 mixins 负责创建嵌套类，因此添加一个带有所有嵌套子选项的新颜色（例如`.water`with `blue`）是一件简单的事情：

**较少的：**

```
.colorfade(@fade) {
  background: fadeout(@color, @fade);
}

.colorfind (@color) {
  background: @color;
  &.level-beginner {
    .colorfade(50%)
  }
  &.level-pro {
    .colorfade(25%)
  }
}

.fire {
  .colorfind(red);
}

.water {
  .colorfind(blue);
}

.earth {
  .colorfind(green);
} 
```

**HTML：**

```
<div class="fire level-beginner"></div>
<div class="water level-pro"></div>
<div class="earth level-beginner"></div> 
```

[演示](http://codepen.io/joe/pen/kheAi)

# php - 重定向到 HTTP 错误文档而不更改请求 URL

> ID：14006934
> 
> 赞同：4
> 
> 时间：2012-12-22T22:01:39.583
> 
> 标签：php, http-headers, http-status-codes

我试图从 PHP 页面显示 HTTP 错误文档，但我希望原始 URL 保留在地址栏中，以防止搜索引擎爬虫混淆并允许重新加载页面以防临时问题。

我在 PHP 中做了一个重定向函数，它有点像这样：

```
public static function Redirect($url, $code = '303 See Other') {
    header('HTTP/1.1 ' . $code);
    header('Location: ' . $url);
    exit(0);
} 
```

如果我想显示错误文档，例如 403 Forbidden，我会执行以下操作：`Redirection::Redirect('/errordocs/403.php', '403 Forbidden');`它会正常工作。

正如我所说，用户 URL 将更改为`/errordocs/403.php`我想要避免的。

`header('Location: ' . $url);`如果 HTTP 代码是 4xx 或 5xx，我尝试做的是删除该行。我希望这会触发 Apache 显示正确的文档，因为我将 .htaccess 设置为指向相关的错误页面（它可以正常工作）。

我实际上从中得到的是标准的 Google Chrome 浏览器消息，用于当东西中断时，而不是我漂亮的自定义错误文档。

快速达成共识，现在最好的方法是什么？让它回显页面而不是重定向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:05:17.037

我只是做了同样的事情，但因为它是 404 - 没有找到 - 在我看来 - 它已经消失了......

所以我像这样设置我的 .htaccess 文件：

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (.*) - [G]
ErrorDocument 410 /error404.php 
```

现在，只要有人点击 404，它就会显示漂亮的 404 页面，但会停留在当前 url

注意：这是 .htacesss 文件的一个工作示例： [http ://www.smdailyjournal.com/stackoverflow](http://www.smdailyjournal.com/stackoverflow)

当你去[检查标题代码](http://tools.seobook.com/server-header-checker/)时，你会看到它返回一个真正的 410 - Gone 消息:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:05:08.393

如果是 4xx 状态码，您可以只显示错误 html 的内容。否则重定向：

```
public static function Redirect($url, $code = '303 See Other') {
    header('HTTP/1.1 ' . $code);
    if(strpos($code, '4') === FALSE) {
        header('Location: ' . $url);
    } else {
        include(get_error_page_file_name($code));
    }
    exit(0); 
```

}

上面的示例将发送正确的 HTTP 状态代码，将显示错误页面的内容并保持地址中的 url 相同。

# c# - 当方法返回 t > 1 作为布尔值时，这意味着什么？

> ID：14006940
> 
> 赞同：1
> 
> 时间：2012-12-22T22:03:09.327
> 
> 标签：c#, .net, boolean, return, reversi

有人可以解释以下返回语句的用途/含义是什么：**t > 1;** （见最后一个 if 语句最后一个方法）

该代码来自一个名为“Reversi”的游戏[http://en.wikipedia.org/wiki/Reversi](http://en.wikipedia.org/wiki/Reversi)

此方法检查您是否附上了另一位玩家的棋子。

```
public bool allowed(int x, int y, bool player)
    {
        int color;

        if(player == true) // true = player is blue.
            color= 1; 
        else color= -1;

        if(stone[x,y] != 0)
            return false;
        else
        {
         for (int dx = -1; dx <= 1; dx ++)
            {
             for (int dy = -1; dy <= 1; dy ++)
             {
                 if (dx != 0 || dy != 0) // 0, 0 must be skipped, own stone.
                 {
                     if (close(color, x, y, dx, dy))
                         return true;
                 }
             }
            }   
        }
         return false;
         }

public bool close(int color, int x, int y, int dx, int dy)
        {
            int s;
            int testx;
            int testy;
            for(int t=1; t<stone.Length;t++)
            {
                testx = x + t * dx;
                testy = y + t * dy;
                if(testx >= board.Width || testx <= 0 || testy >= board.Heigth|| testy <= 0)
                    return false;
            s = stone[x + t * dx, y + t * dy];
            if (s == 0) return false;
            if (s == color) return t>1;
        }
        return true;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T22:06:22.923

这段代码：

```
return t > 1; 
```

相当于：

```
if (t > 1)
{
    return true;
}
else
{
    return false;
} 
```

除了后一种方法不必要地冗长并且不幸的是在实际代码中很常见。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T22:06:10.187

对语句右侧的任何表达式`return`求值，然后从函数返回值。

在这种情况下，t 可以大于 1，也可以不大于 1 - 意味着它要么是要么`true`-`false`意味着要么要么`true`将`false`被返回，这取决于 t 的值。

它完全等同于：

```
if(t>1)
    return true;
else
    return false; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T22:05:27.977

如果 t 大于 1，则返回 true，否则返回 false。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T22:06:12.870

```
return t > 1; 
```

和

```
if (t > 1)
   return true;
else
   return false; 
```

和

```
bool greaterThanOne;

if (t > 1)
   greaterThanOne = true;
else
   greaterThanOne =false;

return greaterThanOne; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-22T22:06:34.923

`return t>1`等于

```
 if (t > 1)
   {
       return true;
   }
    else
   {
       return false;
   } 
```

还有另一种使用`return`like；

```
static string AmIAwesome(bool b)
        {
            return b ? "Yes, I'm" : "No, I'm not";
        } 
```

这与第一个逻辑相同。

# javascript - Javascript：从函数返回html元素

> ID：14006943
> 
> 赞同：1
> 
> 时间：2012-12-22T22:03:34.170
> 
> 标签：javascript, jquery

我正在尝试使用`datetime`属性过滤某些 html 元素。我的 html 元素看起来像

```
<time title="Sat Dec 22 16:29:21 2012 UTC" datetime="2012-12-22T16:29:21+00:00">4 hours</time> 
```

现在，我正在做的是

```
var x = $("p time").map(function() { filter(this);}) 
```

我的过滤功能看起来像：

```
function filter(var1){

  var now = new Date();
  var time = $(var1).attr("datetime");

  var time = new Date(time);
  var diff = now - time;

  if( diff < 7200000){

   console.log("yes");
   return $(var1).parent().parent();

  }
} 
```

当我运行上面的代码时，我得到`x`一个`empty array`并且`yes`被打印了 9 次。

所以，我的问题是为什么我的`filter`函数没有返回父 html 标记。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:07:58.203

```
var x = $("p time").map(function() { filter(this); }); 
```

应该

```
var x = $("p time").map(function() { return filter(this); }); 
```

你错过了 return 声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:12:15.763

使用 jQuery`filter()`方法

```
var p_parents_I_want = $("p time").filter(function() {
    var now = new Date();
    var time = $(this).attr("datetime");
    time = new Date(time);/* don't declare same var twice*/
    var diff = now - time;

    return diff < 7200000

}).parent().parent() 
```

通常可以替换`parent().parent()`使用`closest(selector)`

API参考： [http ://api.jquery.com/filter/](http://api.jquery.com/filter/)

# unity3d - unity 刚体恒速

> ID：14006947
> 
> 赞同：3
> 
> 时间：2012-12-22T22:04:26.723
> 
> 标签：unity3d, game-physics

我有一个受重力和碰撞效应影响的物体。我怎样才能使它在 X 轴上保持恒定的速度？
我有类似的东西：

```
void Update () {        
     rigidbody.velocity = 5 * new Vector3(1f,0f,0f);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T17:23:15.563

如果您真的希望物体无论如何都具有恒定的速度，那么您不希望它受到碰撞和重力的影响。在这种情况下，您应该选中刚体属性中的运动学复选框。这样，您将能够从脚本中移动对象的变换，并且对象的位置不会受到任何其他因素的影响。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T22:38:18.623

请注意，物理引擎的更新间隔与其他基本游戏逻辑不同。

特别是，`Rigidbody`每次调用 的状态都会更新一次**[`FixedUpdate()`](http://docs.unity3d.com/Documentation/ScriptReference/MonoBehaviour.FixedUpdate.html)**，因此，如果您想覆盖物理引擎的任何结果，您可能希望在您自己的内部进行`FixedUpdate()`，而不是`Update()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-22T21:36:57.660

除了每个人已经告诉过您的内容之外，我还要补充一点，如果您想在特定方向（在您的情况下为 X 轴）保持恒定速度，更正确的代码将是：

```
void FixedUpdate () {
    // We need to keep the old y and z component if we want the object to still be affected by gravity and other things
    rigidbody.velocity = new Vector3(5.0f , rigidbody.velocity.y, rigidbody.velocity.z);
} 
```

# c - 从输入形成数据库查询

> ID：14006949
> 
> 赞同：-1
> 
> 时间：2012-12-22T22:05:06.980
> 
> 标签：c, database, informix

在我的 C 程序中，我收到的输入格式为

```
 "name,age,salary|Richard,35,10000" 
```

现在我想从这个输入框插入和更新查询。

我正在使用`strtok_r`和`strtok`为此目的。

但我的问题是，在插入或更新时，我必须在 varchar 数据类型（如“Richard”）周围使用双引号。

输入没有固定的模式，它可以是任何顺序。

*   我每次都必须检查每一列的数据类型吗？

*   有更好的方法吗？

我使用的数据库是 Informix。我正在使用 ESQL/C，它是带有嵌入式 SQL 扩展的旧 C。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T23:36:21.640

处理这个问题的最好方法是通过主机变量，这意味着你不需要在值周围加上引号。Informix 非常擅长将字符串转换为其他类型；唯一会遇到麻烦的类型是 blob — BYTE、TEXT、BLOB、CLOB。

这段代码只编译过；它没有被执行。除最后一条外，各种`return`语句都是错误返回。我们可以辩论在没有释放准备好的语句的情况下返回是否正确；很容易争论它不是。几乎可以肯定，这个怪物应该有几个例程。

```
#include "sqlca.h"
#include "sqlda.h"
#include "sqltypes.h"
#include <assert.h>
#include <stdio.h>
#include <string.h>

extern int insert_record(char *line, const char *tabname);

int insert_record(char *line, const char *tabname)
{
    /* Analyze line */
    char *pipe = strchr(line, '|');
    char *comma = line;
    int c_count = 0;
    int v_count = 0;
    while ((comma = strchr(comma, ',')) != 0 && comma < pipe)
        c_count++;
    comma = pipe;
    while ((comma = strchr(comma, ',')) != 0)
        v_count++;
    if (v_count != c_count)
        return(-1);
    char *names[c_count];
    char *value[c_count];
    char *np = line;
    char *vp = pipe+1;
    for (int i = 0; i < c_count; i++)
    {
        names[i] = np;
        value[i] = vp;
        char *sep = strchr(np, ',');
        assert(sep != 0);
        if (sep > pipe)
            sep = pipe;
        *sep = '\0';
        np = sep + 1;
        sep = strchr(vp, ',');
        if (sep != 0)
        {
            *sep = '\0';
            vp = sep + 1;
        }
    }

    /* Create SQL statement with placeholders */
    /* names[i] contains column name for entry i; value[i] contains the value */
    $ char buffer[4096];
    char *sql = buffer;
    int len = sizeof(buffer) - 1;
    int num = snprintf(sql, len, "insert into %s", tabname);
    if (num <= 0 || num >= len)
        return(-2);
    if (num <= 0 || num >= len)
        return(-2);
    sql += num;
    len -= num;
    pad = "(";
    for (int i = 0; i < c_count; i++)
    {
        num = snprintf(sql, len, "%s%s", pad, "?");
        if (num <= 0 || num >= len)
            return(-2);
        sql += num;
        len -= num;
    }
    num = snprintf(sql, len, ")");
    if (num <= 0 || num >= len)
        return(-2);

    $ PREPARE p_insert FROM :buffer;
    if (sqlca.sqlcode != 0)
        return(sqlca.sqlcode);

    /* Create sqlda to describe strings */
    ifx_sqlda_t data;
    ifx_sqlvar_t columns[c_count];
    $ struct sqlda *udesc = &data;
    data.sqld = c_count;
    data.sqlvar = columns;
    data.desc_name[0] = '\0';
    data.desc_occ = 0;
    data.reserved = 0;
    data.desc_next = 0;
    for (int i = 0; i < c_count; i++)
    {
        columns[i].sqltype       = SQLVCHAR;
        columns[i].sqllen        = strlen(value[i]);
        columns[i].sqldata       = value[i];
        columns[i].sqlind        = 0;
        columns[i].sqlname       = names[i];
        columns[i].sqlformat     = 0;
        columns[i].sqlitype      = 0;
        columns[i].sqlilen       = 0;
        columns[i].sqlidata      = 0;
        columns[i].sqlxid        = 0;
        columns[i].sqltypename   = 0;
        columns[i].sqltypelen    = 0;
        columns[i].sqlownerlen   = 0;
        columns[i].sqlsourcetype = 0;
        columns[i].sqlownername  = 0;
        columns[i].sqlsourceid   = 0;
        columns[i].sqlilongdata  = 0;
        columns[i].sqlflags      = 0;
        columns[i].sqlreserved   = 0;
    }

    /* Execute the SQL and clean up */
    $ EXECUTE p_insert USING DESCRIPTOR udesc;
    if (sqlca.sqlcode != 0)
        return(sqlca.sqlcode);
    $ FREE p_insert;
    if (sqlca.sqlcode != 0)
        return(sqlca.sqlcode);
    return(0);
} 
```

# after-effects - 如何在 After Effects 的自定义全局库中声明函数？

> ID：14006958
> 
> 赞同：5
> 
> 时间：2012-12-22T22:06:27.083
> 
> 标签：after-effects

是否可以将所有自定义表达式保存在外部 .jsx 文件中，以便我可以从项目内部调用它们？

例如，假设我有一个经常使用的表达式，它将人偶工具点与空对象的位置联系起来。我知道我可以将该表达式转换为一个可以接受两个参数的函数，但是我可以将它保存到自定义库中，以便我可以轻松地在项目中重用它吗？

现在，我只是将相同的代码从一个属性复制并粘贴到另一个属性，我开始觉得有另一种方法可以更有效地做到这一点。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-12-13T07:55:10.190

我成功地测试了这个，把它放在你的表情之上：

```
$.evalFile("/Users/myname/ae/functions.txt"); 
```

然后，您可以访问您的 functions.txt 文件中的任何功能。

有关更多详细信息，请参见此处：[https ://forums.creativecow.net/readpost/227/29337](https://forums.creativecow.net/readpost/227/29337)

这种方法的问题是您仍然需要为每个表达式包含额外的行。

无论如何，这是我的完整设置，以防万一：我的表达是：

```
$.evalFile("/Users/myname/ae/functions.txt");

var p1  = thisComp.layer("Null 1").transform.position;
var p2  = thisComp.layer("Null 4").transform.position;
var p = p2 - p1;

printPosition(p) 
```

我的 functions.txt 文件包含以下内容：

```
function printPosition (p){
    return " " + parseInt(p[0]) + " : " + parseInt(p[1])
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-06T10:22:30.010

一个有点老的问题，但我找到了一个没有外部文件的类似 ling 的解决方案。

1.  为您的函数添加一个空层
2.  添加标记并在评论中写下您的功能
3.  在你的电话上调用 eval`comp->layer->marker->comment`

[![在此处输入图像描述](../Images/8e7eeba37b8a3e96ed9bf46fc08eff29.png)](https://i.stack.imgur.com/Kj8D6.png)

当你想调用你的函数时，你只需要一行：

```
eval(thisComp.layer("FunctionLayer").marker.key(1).comment);
test(1); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-10-17T12:09:00.660

我不认为这是可能的。但是您可以通过将表达式保存为预设来完成很多工作（通过将实际图层属性拖动到“效果和预设”窗口。请注意，您可以通过选择它们并使用“动画”->“应用动画预设”将预设应用于多个图层功能

希望能有所帮助。

# xml - 如何从 vb.net 中的 xml 文档中获取元素名称

> ID：14006965
> 
> 赞同：1
> 
> 时间：2012-12-22T22:07:24.010
> 
> 标签：xml, vb.net, visual-studio-2010, .net-4.0

我有一个 xml 文件，例如：

```
<config>
   <email  Host="201.0.0.0" From="mail@mail.com" Pass="xxx" Name="xxx"/>
   <gir    g1="Traditional" g2="mid Techn" g3="High Tech"/>
   <costs>
     <Pre-Incube    inscr="7000.00"  add="300.00"/>
     <Normal        inscr="1600.00"  inc="7000.00" add="500.00"/>
     <Urgent        inscr="1600.00"  inc="5000.00" add="500.00"/>
     <Estance       inscr="1600.00"  men="2500.00"/> 
     <Post          inscr="1600.00"  men="1500.00"/> 
   </costs>
</config> 
```

要获取元素“gir”的属性，我会这样做

```
Dim doc As XmlDocument = New XmlDocument()
doc.Load(path)
Dim root As XmlNode = doc.DocumentElement         
Dim nodeGir As XmlNode = root.SelectSingleNode("/config/gir")
cboGir.Items.Add(nodeGir.Attributes.ItemOf("g1").InnerText)
cboGir.Items.Add(nodeGir.Attributes.ItemOf("g2").InnerText)
cboGir.Items.Add(nodeGir.Attributes.ItemOf("g3").InnerText) 
```

但是如何获取“成本”下的子元素的*名称：*

```
Pre-Incube, Normal, Urgent, Estance, Post 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T22:21:08.137

改编自此[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.childnodes.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-2)：

```
Dim costs As XmlNode = root.SelectSingleNode("/config/costs")

Dim i As Integer 
For i = 0 To costs.ChildNodes.Count - 1
    cboGir.Items.Add(costs.ChildNodes[i].Name)
Next i 
```

或者可能更容易（来自[这个 MSDN 页面](http://msdn.microsoft.com/en-us/library/hcebdtae.aspx)）：

```
Dim costs As XmlNodeList = root.SelectNodes("/config/costs/*")
For Each book In costs      
    cboGir.Items.Add(book.Name)
Next 
```

[Name是](http://msdn.microsoft.com/en-us/library/system.xml.xmlnode.name.aspx)[XmlNode](http://msdn.microsoft.com/en-us/library/bxz4hfh3.aspx)上的一个属性- 文档是您的朋友。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-23T00:53:52.933

要获取所有成本子元素的名称，您可以执行以下操作：

```
For Each node As XmlNode In doc.SelectNodes("/config/costs/*")
    cboGir.Items.Add(node.Name)
Next 
```

# ruby-on-rails - 通过布尔通配符过滤数据

> ID：14006969
> 
> 赞同：0
> 
> 时间：2012-12-22T22:07:55.633
> 
> 标签：ruby-on-rails, ruby-on-rails-3

这是我之前遇到的问题的更新问题。我正在为当地的狗收养创建一个“match.com”风格的应用程序，用户和狗都有个人资料。在每个配置文件中，都有布尔字段。我试图只向最终用户展示与他们的用户资料相匹配的狗。然而，简单的一对一匹配不起作用，因为逻辑会根据用户的布尔值而变化。例如，如果用户有孩子 (user.kids_under_10:true)，那么我只需将其与可以与孩子放在一起的狗匹配 (dog.kids_under_10:true)。该模型看起来像

```
class Dog < ActiveRecord::Base

def self.by_profile(user)
  if user.kids_under_10 == true
    Dog.where(kids_under_10: user.kids_under_10)
  end
end 
```

然而，如果用户没有孩子，则可以显示对这个问题回答正确和错误的狗，因为可以与该用户放置对孩子不友好的狗。我意识到如果这是唯一的匹配标准，我可以简单地`else, Dog.all`在上述方法中添加一条语句。但是，由于还有其他布尔字段要匹配（即 user.has_cats 和 dog.cat_friendly），因此该解决方案不起作用。我想我需要一个包含数组的变量，但不太确定......任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T22:21:56.593

尝试使用这样的东西：

```
class Dog < ActiveRecord::Base
  def self.by_profile(user)
    dogs = scoped

    dogs = dogs.where(kids_under_10: true) if user.kids_under_10
    dogs = dogs.where(cat_friendly: true) if user.own_cats
    # other conditions

    dogs
  end
end 
```

基本上，该`scoped`方法为您提供了一个空关系。然后，您可以使用它有条件地添加`where`语句（或 AR 支持的任何其他内容）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:35:00.887

```
def self.by_profile(user)
  user.kids_under_10 ? Dog.where(kids_under_10: true) : Dog.all
end 
```

不是很优雅，但应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T22:15:21.960

所以我找到了一个解决方案，但我不确定它是否是最有效的解决方案，所以非常欢迎任何建议（我是编程新手，希望学习处理不同情况的“最佳”方法）。这是我解决问题的方法：

```
class Dog < ActiveRecord::Base

def self.by_profile(user)
  if user.kids_under_10?
    kids_under_10 = true
  else
    kids_under_10 = [true, false]
  end

  Dog.where(kids_under_10: kids_under_10)
end
end 
```

随着我添加更多参数，我可以预见这个解决方案会变得有点麻烦。条件语句可能会变得很长。感谢您的任何建议！

# excel - 将多个数组分配给 Excel 范围

> ID：14006971
> 
> 赞同：-2
> 
> 时间：2012-12-22T22:08:04.163
> 
> 标签：excel, vbscript, vba

只是出于好奇，我问你一个问题，如下所示：

假设我确实有一个数组 A1(6)=(45,25,,36,88),A2(6)=(14,25,11),A3(6)=(11,21,20,25,48 ）。现在我们可以借助单个语句（例如将单个数组赋值给一行）来放置这些数组值，就像这里的所有行到 Excel 的一个范围一样，在这里说“C1：R3”范围。

***编辑***

如果我需要将它们分配给 R1<- A1 + A2 +A3,R2<- A1 + A2 +A3 之类的行。你能告诉我怎么做吗？

R1<- (45,25,,36,88),14,25,11,,,,11,21,20,25,48,) 与 R2 相同。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T22:18:08.937

```
 Dim A(2,5)
    For i = 0 to 5
        A(0, i) = A1(i)
        A(1, i) = A2(i)
        A(2, i) = A3(i)
    Next i
    Range("C1:R3").Value = A 
```

**编辑**

对于第二部分，据我所知：

```
 Dim R(17)
    For i = 0 To 2
        For j = 0 To 5
            R(6 * i + j) = A(i, j)
        Next j
    Next i
    Range("C5:T5").Value = R 
```

**编辑 2**

或者：

```
 Dim R
    R = Split(Join(A1, ",") & "," & Join(A2, ",") & "," & Join(A3, ","), ",")
    Range("C5:T5").Value = R 
```

您可以使用任何您喜欢的分隔符（如果它适合您的数据）。

# php - PHP5 Socket 服务器闪存

> ID：14006978
> 
> 赞同：0
> 
> 时间：2012-12-22T22:09:12.863
> 
> 标签：php, actionscript-3, flash, serversocket

我正在尝试让一个相当简单的 Flash 游戏与 php 套接字一起工作。截至目前，我正在使用仅允许用户互相聊天的套接字进行测试。这将在我的个人机器上运行，只能从 IDE 运行。如果我尝试运行 SWF 或 .html，则不行。我知道人们在使用 PhP、C#、C++、HTML 等方面处于边缘，但我真的想坚持使用 php，因为我使用的主机将支持这一点，最终我将获得足够的经验来深入了解套接字服务器。

所以我的问题是我*大部分时间*都在工作。如果我在 Flash CS5 (Ctrl+Enter) 中对其进行测试，它将运行跟踪和所有内容，并在无法连接时停止，这是我预期的。但是，当我从 SWF 或 HTML 运行它时，它甚至不会初始化。下面的代码将使这一点更加清晰

```
import flash.net.*;
import fl.controls.*;
import flash.events.MouseEvent;
import flash.events.DataEvent;
import flash.events.SecurityErrorEvent;

var mySocket = new XMLSocket();
pushMsg.addEventListener(MouseEvent.CLICK, realsedButton);
//mySocket.connect("192.124.5.2",9999);
mySocket.addEventListener(Event.CONNECT, xmlsocket);
mySocket.addEventListener(Event.CLOSE, xmlsocket);
mySocket.addEventListener(IOErrorEvent.IO_ERROR, xmlsocket);
mySocket.addEventListener(DataEvent.DATA, dataHandler);
mySocket.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityHandler);   

msgArea.htmlText = "Started!";
connectToServer();
function connectToServer()
{
    msgArea.htmlText = "Inside connect To Server";
    mySocket.connect("localhost",9999);
}

function securityHandler(evt: SecurityErrorEvent)
{
    msgArea.htmlText = "SecurityError";
}

function dataHandler(evt:DataEvent)
{
    trace("Inside dataHandler")
    var xml = XML(evt.target.data);
    msgArea.htmlText += xml;
}

function xmlsocket(Event)
{
    msgArea.htmlText += "inside xmlSocket";
    switch(Event.type)
    {
        case 'ioError':
            msgArea.htmlText += "Inside dataHandler";
            msgArea.htmlText += "<b>Server connection failed!</b>";
            break;

        case 'connect':
            msgArea.htmlText +="Inside Connect";
            msgArea.htmlText += "<b>Server connection establed!</b>";
            break;

        case 'close':
            msgArea.htmlText +="Inside Close";
            msgArea.htmlText += "<b>Server connection lost</b>";
            break;
    }
}
function msgGO() 
{
    msgArea.htmlText +="Inside msgGO";
    if (inputMsg.htmlText != "") 
    {
        msgArea.htmlText +="Inside msgGo2";
        mySocket.send(inputMsg.htmlText+"\n");
        inputMsg.htmlText = "";
    }
}

function realsedButton(evt:MouseEvent)
{
    msgArea.htmlText +="Inside ReleasedButton";
    msgGO();
} 
```

因此，当我从 IDE 运行它时，它会输出： xmlSocket 内部连接到服务器内部 dataHandler 服务器连接失败！

这很好，除了跳过 Started！（不确定为什么）

当我从 SWF 或 HTML Inside 运行时连接到服务器

这就是发生的一切。我在消息中添加了以准确跟踪代码何时跳转的位置。在我的发布设置中，我确实将其设置为使用网络文件，我也尝试过使用本地文件。

使用网络文件，SWF 将输出 Inside connect To Server

使用本地文件，它不会输出任何东西。

如果有人能解释这一点或帮助我，我将不胜感激。

好的，所以我们取得了一些小的进展。它现在将在机器上运行，让我们开始！内部连接到服务器，然后大约 10-15 秒后弹出安全错误。

我们在 9999 上运行它，但我听说端口 843 和安全错误有些奇怪，有什么方法可以调试这个错误？我们只有在尝试使用 PhP Socket 从实际服务器运行它时才能得到它。

如果我在我的个人机器上运行 swf，我仍然没有通过 Started！并且无论我等待多长时间，都可以在内部连接到服务器

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T05:32:32.953

触发事件的原因是端口`SecurityError`上没有。Flash Player 尝试连接到 843 端口并请求跨域文件。但是如果该文件不存在或不正确，则FP 会触发。`crossdomain file``843``SecurityError`

# facebook - 从 Facebook API 获取高分辨率图片

> ID：14006979
> 
> 赞同：7
> 
> 时间：2012-12-22T22:09:13.657
> 
> 标签：facebook, facebook-graph-api, facebook-fql, photo

Facebook FQL API for Photos[声明](https://developers.facebook.com/docs/reference/fql/photo_src)从 API 返回的照片的最大分辨率为 960x960：

> Photo 对象具有等效的 src 连接。使用 photo_src FQL，您可以检索以下尺寸的图像：960、720、480、320、180、130、75 像素。

但是，某些图像以更高的分辨率上传。有时甚至更高。

定期浏览 Facebook 时，您可以看到这些图片并查看它们的全尺寸。但是，我似乎找不到任何方法来获取 API 中的原始分辨率。

这可能吗，我错过了什么？如果不是 - 为什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-22T23:49:28.863

### 获取图片的最大尺寸

```
/USER_ID?fields=images 
```

`images`返回“包含宽度、高度、源的对象数组，每个对象代表各种照片尺寸”。结果如下所示：

```
{
  "data": [
    {
      "images": [
        {
          "height": 1536, 
          "width": 2048, 
          "source": "https://fbcdn-sphotos-c-a.akamaihd.net/hphotos-ak-prn1/s2048x2048/65169_XXXXXX_n.jpg"
        }, 
        {
          "height": 720, 
          "width": 960, 
          "source": "https://fbcdn-sphotos-c-a.akamaihd.net/hphotos-ak-prn1/65169_44590146XXXXXXXXn.jpg"
        }, 
        {
          "height": 540, 
          "width": 720, 
          "source": "https://fbcdn-sphotos-c-a.akamaihd.net/hphotos-ak-prn1/s720x720/65169_44XXXXXXX0984540_n.jpg"
        },
        { 
          ...
        },
        {
          "height": 97, 
          "width": 130, 
          "source": "https://fbcdn-photos-a.akamaihd.net/hphotos-ak-prn1/s75x225/65169_44XXXXX_s.jpg"
        }
      ], 
    }
  ]
} 
```

### 获取*个人资料*图片的最大尺寸

尝试超过 960，即 961。如果可用，您将获得图片的最大尺寸！

```
/USER_ID?fields=picture.height(961) 
```

结果：

```
{
  "id": "PROFILE_ID", 
  "picture": {
    "data": {
      "url": "https://fbcdn-profile-a.akamaihd.net/hprofile-ak-prn1/615962_4486XXXXXXXXX3_601495975_o.jpg", 
      "width": 1536, 
      "height": 2048, 
      "is_silhouette": false
    }
  }
} 
```

# objective-c - ios - 显示下载进度 UIViewController

> ID：14006980
> 
> 赞同：0
> 
> 时间：2012-12-22T22:09:15.353
> 
> 标签：objective-c, ios, download, download-manager

在我的应用程序中实现[iOS 的 HCDownload](http://www.cocoacontrols.com/platforms/ios/controls/hcdownload)后，我可以成功显示文件的下载进度。

问题是编写它的人没有使用 Xcode 来编写模块，所以即使它应该使用，但在尝试与项目集成时它并不能很好地工作。

这些是我遇到的主要问题：

如果您执行 a`[self.navigationController pushViewController:dlvc animated:YES];`或 a`[self presentViewController: animated: completion:];`那么它会显示它何时启动。我可以通过返回来摆脱它，但是当我返回它时，它是空白的 - 所以我看不到下载的进度。然而，下载继续进行，因为它出现在我的文档文件夹中。（我使用 ASIHTTP 框架）

现在我正在这个项目中使用故事板，因为它没有附带我认为的 XIB 文件（这在过去有点工作）我可以只拥有一个 UITableViewController 并将其作为它的自定义类，但它不会播放球。

**是否有基于 XIB 的下载管理器 FrameWork，有人也可以指出我，或者有人对这个有好运吗？**

PS我知道Storyboards不使用XIB文件，但是这样集成到storyboard中比完全没有UI文件更容易:-)

非常感谢您的提示。

**编辑**

这是我实现它的代码：

```
 HCDownloadViewController *dlvc = [[HCDownloadViewController alloc] init];
    dlvc.delegate = self;

    NSString *documentDirectory = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];

    dlvc.downloadDirectory = documentDirectory;

    NSString *fileSave = [_streamingURL lastPathComponent];

    NSURL *url = [NSURL URLWithString:_streamingURL];
    ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];

    [dlvc downloadURL:url userInfo:nil];

    // Add your filename to the directory to create your saved pdf location
    NSString *pdfLocation = [documentDirectory stringByAppendingPathComponent:fileSave];

    NSString *cachesDirectory = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) lastObject];
    // Add your filename to the directory to create your temp pdf location
    NSString *tempPdfLocation = [cachesDirectory stringByAppendingPathComponent:fileSave];

    if (!networkQueue) {
        networkQueue = [[ASINetworkQueue alloc] init];
    }
    failed = NO;

    [request setTemporaryFileDownloadPath:tempPdfLocation];
    [request setDownloadDestinationPath:pdfLocation];
    [request setDownloadProgressDelegate:progressBar];
    [request setShowAccurateProgress:YES]; 
```

# google-apps-script - 为什么我不能计算出正确的 HMAC 签名？

> ID：14006981
> 
> 赞同：7
> 
> 时间：2012-12-22T22:09:15.750
> 
> 标签：google-apps-script

我正在尝试在 Google Apps Script 中计算 HMAC 签名，但文档并没有 100% 清楚地说明我需要如何传递参数，而且我无法获得预期的输出。

* * *

为了确定我是否得到正确的输出，我将结果与已知良好的 PHP 代码进行比较。该代码是：

```
$key = "a2V5"; # this is "key" base64-encoded
$value = "test";
$result = base64_encode(hash_hmac('sha512', $value, base64_decode($key), true)); 
```

* * *

我在 Google Apps 脚本中的代码是：

```
key = "a2V5"; // this is "key" base64-encoded
value = "test";
result = Utilities.base64Encode(Utilities.computeHmacSignature(Utilities.MacAlgorithm.HMAC_SHA_512, value, Utilities.base64Decode(key))); 
```

我期望收到的输出是：

```
KHoPuJp/vfpbVThjaRjlN6W4MGXk/zMSaLeqoRXd4EepsPT7W4KGCPwLYyfxAFX3Y3sFjp4Nu55piQGj5t1GHA== 
```

但我得到的是：

```
mGXJ3X/nH5ZIFUAPtf1PsViY50pD3cfU7J8w2KAIEAqrAgZ3dpKcuy5V1yvH4/C5n1C9rFFsKc2JKHTwUqPscQ== 
```

我在这里搞砸了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T22:40:03.523

我查看了您的代码，有一件事引起了我的注意：

`Utilities.base64Decode(key)`方法返回`Byte[]` `Utilities.computeHmacSignature(macAlgorithm, value, key)`接受 3 个参数。`value`并且`key`是 类型`string`。

也许这就是问题所在。您为什么不尝试以下方法并检查结果：

```
key = "a2V5"; // this is "key" base64-encoded
clearKey = "key";
value = "test";
result = Utilities.base64Encode(Utilities.computeHmacSignature(Utilities.MacAlgorithm.HMAC_SHA_512, value, clearKey)); 
```

[我在这里](https://developers.google.com/apps-script/class_utilities?hl=en)查看 Google Apps 脚本。

# json - 尝试使用 Crontab 时 Perl 的 REST 客户端错误

> ID：14006982
> 
> 赞同：1
> 
> 时间：2012-12-22T22:09:25.190
> 
> 标签：json, perl, rest, rest-client

脚本在手动运行时运行良好，但是当我在 cronjob 中安排它时，它显示：

```
malformed JSON string, neither array, object, number, string or atom, at character offset 0 (before "<html>\r\n<head><tit...") at /usr/local/lib/perl5/site_perl/5.14.2/JSON.pm line 171. 
```

脚本本身：

```
#rest config vaiables

$ENV{'PERL_LWP_SSL_VERIFY_NONE'} = 0;
print "test\n";
my $client = REST::Client->new();
$client->addHeader('Authorization', 'Basic YWRtaW46cmFyaXRhbg==');
$client->addHeader('content_type', 'application/json');
$client->addHeader('accept', 'application/json');
$client->setHost('http://10.10.10.10');
$client->setTimeout(1000);

$useragent = $client->getUseragent();

print "test\n";

#Getting racks by pod
                 $req = '/api/v2/racks?name_like=2t';
               #print " rekvest {$req}\n";
               $client->request('GET', qq($req));
               $racks = from_json($client->responseContent());
               $datadump = Dumper (from_json($client->responseContent())); 
```

crontab -l

```
*/2 * * * *  /usr/local/bin/perl /folder/api/2t.pl > /dmitry/api/damnitout 2>&1 
```

感谢任何建议谢谢你，德米特里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T00:44:09.407

很难说到底发生了什么，但根据我的经验，99% 的运行问题都`crontab`源于环境变量的差异。

调试此的典型方法：在脚本的开头添加如下块：

```
foreach my $key (keys %ENV) {
    print "$key = $ENV{$key}\n";
} 
```

在控制台中运行它，查看输出，将其保存在日志文件中。

现在，在 crontab 中重复相同的操作并将其保存到日志文件中（您已经这样做了 - 这很好）。

尝试以两种方式运行它并尝试修复它时，看看环境变量是否有任何差异。在 Perl 中，可能最简单的方法是通过更改 %ENV 来更改环境。在解决了所有差异之后，没有理由不能正常工作。

祝你好运！

# objective-c - 在按下 DetailDisclosureButton 时显示 UIViewController

> ID：14006983
> 
> 赞同：0
> 
> 时间：2012-12-22T22:09:40.243
> 
> 标签：objective-c, xcode, storyboard, xcode-storyboard

我正在尝试获取 UIViewController（使用情节提要构建的 GUI），以显示何时`DetailDisclosureButton`触摸/按下 a。我制作了一个非常简单的 GUI，屏幕上只有一个按钮。我给了它 Custom Class `NFLGameDetailsController`，在故事板上什么也没做。 ![](../Images/12e5ac89505a7a9e085b0fbd474dd2b5.png)

然后我创建了一个`NFLGameDetailsController`继承自 class 的类`UIViewController`。

这是Xcode从`UIViewController`类继承时生成的代码：

```
#import "NFLGameDetailsController.h"

@interface NFLGameDetailsController ()

@end

@implementation NFLGameDetailsController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

最后，在我的主控制器上，我添加`#import "NFLGameDetailsController.h"`了头文件，并实现了显示 UIViewController 的方法，如下所示：

```
- (void)tableView:(UITableView *)tableView accessoryButtonTappedForRowWithIndexPath:(NSIndexPath *)indexPath
{
    NFLGameDetailsController *controller = [[NFLGameDetailsController alloc] init];
    [[self navigationController] pushViewController:controller animated:YES];
} 
```

正在调用此方法，一切似乎都很好，但是当我按下附件详细信息披露按钮时，出现黑屏：

![](../Images/d0eb0c48ab66532559d08b3a6282e892.png)

为什么它没有显示我使用情节提要创建的 GUI？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T10:51:39.213

这是因为您只是在实例化一个类，而不是一个视图

如果你想从代码中加载另一个视图，你可以这样做

首先，将 Storyboard ID 分配给 Storyboard 编辑器中的视图控制器（例如 NFLGameDetailsController）

然后

```
- (void)tableView:(UITableView *)tableView accessoryButtonTappedForRowWithIndexPath:(NSIndexPath *)indexPath
{
    NFLGameDetailsController *controller = (NFLGameDetailsController *)[self.storyboard instantiateViewControllerWithIdentifier:@"NFLGameDetailsController"];
    [[self navigationController] pushViewController:controller animated:YES];
} 
```

但是您可以使用情节提要编辑器来配置您的表格视图及其单元格以加载另一个没有代码的视图

# ios - iOS 6 Storyboard Segue 风格 Popover 与 UIPopoverController 目标崩溃

> ID：14006986
> 
> 赞同：0
> 
> 时间：2012-12-22T22:10:19.320
> 
> 标签：ios, uipopovercontroller, uistoryboard

我有一个带有主 ViewController 的 iPad 应用程序，其中有一个 UIButton。这与具有样式 Popover 的 segue 相关联，其目标是 UIPopoverController 类（空，来自 Xcode 的带有 UIPopoverController 子类的“create new”）。

当我单击按钮时，segue 会执行，然后崩溃：

```
2012-12-22 16:58:57.275 iAmFrustratedApp[11521:c07] -[MyGreatPopoverController initWithCoder:]: unrecognized selector sent to instance 0x1caabe70
2012-12-22 16:58:57.277 iAmFrustratedApp[11521:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[MyGreatPopoverController initWithCoder:]: unrecognized selector sent to instance 0x1caabe70'
*** First throw call stack:
(0x22fe012 0x148fe7e 0x23894bd 0x22edbbc 0x22ed94e 0x5f3ae9 0x702a02 0x7020e5 0x5f367b 0x702a02 0x702418 0x7020e5 0x5f2aa3 0x81e48a 0x81ea83 0x81eb54 0x14a3705 0x3da920 0x3da8b8 0x49b671 0x49bbcf 0x49ad38 0x40a33f 0x40a552 0x3e83aa 0x3d9cf8 0x1bacdf9 0x2281f3f 0x228196f 0x22a4734 0x22a3f44 0x22a3e1b 0x1bab7e3 0x1bab668 0x3d765c 0x1cbd 0x1be5)
libc++abi.dylib: terminate called throwing an exception 
```

有趣的是，我曾经让这个目标是一个普通的 UIViewController。当它是那个类时，它工作正常，除了我不能以任何方式以编程方式关闭弹出窗口。这是我将目标类切换为 UIPopoverController 的唯一原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T23:21:45.100

来自[NSCoding 协议参考](https://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Protocols/NSCoding_Protocol/Reference/Reference.html)：

> NSCoding 协议声明了一个类必须实现的两个方法，以便可以对该类的实例进行编码和解码。这种能力为归档（对象和其他结构存储在磁盘上）和分发（对象被复制到不同的地址空间）提供了基础。
> 
> 编码器通过调用 encodeWithCoder: 或 initWithCoder: 来指示对象这样做。encodeWithCoder：指示对象将其实例变量编码为提供的编码器；一个对象可以多次接收此方法。initWithCoder：指示对象从提供的编码器中的数据初始化自己；因此，它取代了任何其他初始化方法，并且每个对象仅发送一次。任何应该可编码的对象类都必须采用 NSCoding 协议并实现其方法。

xib 文件只是由编码对象组成的存档。当您加载 xib 时，框架会将它们解码回（通过`initWithCoder`）为填充您的应用程序的对象。

现在，它发生了`UIPopoverController`不符合`NSCoding`协议的情况（请参阅[参考文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIPopoverController_class/Reference/Reference.html)，就在开头，它说：“符合”：那里没有列出 NSCoding。）

但：

> 任何应该可编码的对象类都必须采用`NSCoding`协议并实现其方法。

因此，当框架找到您的`UIPopoverController`派生类实例并尝试对其进行解码时，它会失败。

希望这可以澄清它。

# c++ - WinRT C++ ComPtr GetAddressOf vs &

> ID：14006988
> 
> 赞同：5
> 
> 时间：2012-12-22T22:10:51.690
> 
> 标签：c++, windows-runtime, directx-11

我刚刚开始使用适用于 Windows 8 应用程序的 DirectX 11.1，例如，我得到了以下 ComPtr：

```
ComPtr<ID3D11Buffer> constantBuffer; 
```

`&constantBuffer`我想知道的是，使用和有什么区别`constantBuffer.GetAddressOf()`？

有时它们都可以正常工作，但有时使用`&constantBuffer`会导致我的程序因访问冲突而崩溃。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T22:16:06.563

你读过文档吗？

[GetAddressOf](http://msdn.microsoft.com/en-us/library/br244957.aspx "获取地址") - 检索 ptr_ 数据成员的地址，其中包含指向此 ComPtr 表示的接口的指针。

[Operator&](http://msdn.microsoft.com/en-us/library/br230430.aspx) - 释放与此 ComPtr 对象关联的接口，然后检索 ComPtr 对象的地址。

# c# - 如何将 C# 对象设置为 null 本身

> ID：14006999
> 
> 赞同：6
> 
> 时间：2012-12-22T22:13:02.137
> 
> 标签：c#, null

在 C++ 中，可以删除`this`并将其自己的引用设置为 null。

我想将一个对象实例设置为 null 本身。

```
public class Foo
{

    public void M( )
    {
       // this = null; // How do I do this kind of thing?
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T23:00:15.027

`this`实际上只是`arg0`实例方法中参数的一个特殊名称。*不允许*将其设置`null`为：

 *1.  `this`例如，您永远无法更改`class`
2.  例如，您*可以*更改a 上的方法，但不能分配`this``struct``null`

1\. 的原因是它**没有用**：

*   该参数`arg0`在实例方法上是 by-val（不是 by-ref）`class`，因此方法的调用者不会注意到更改（为了完整性：在实例方法`arg0`上是 by-ref ）`struct`
*   它不会以任何方式真正改变内存管理：
    *   将某些内容设置为`null`不会删除它；GC 处理
    *   如果有*外部*根持有对对象的引用，它们*仍将*持有对对象的引用
    *   如果您担心参数的边缘情况是对象的最后一个根，那么只需*退出该方法*

所以基本上，这种语法是不允许的，因为它不符合你的要求。对于您想要的东西，**没有C# 隐喻。**

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-22T22:15:05.560

这在 .NET 中是不可能的。您不能从对象本身将当前实例设置为 null。在 .NET 中，当前实例 ( `this`) 是只读的，您不能为其赋值。顺便说一句，这在 .NET 中甚至都不需要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T22:50:08.590

在 C++`delete this`中，释放对象的内存。没有与 C#（或任何其他 .NET 语言）中的等效项。虽然它在 C++ 中是允许的，但我认为这不是一个好习惯。至少[你必须非常小心](http://www.parashift.com/c++-faq-lite/delete-this.html)。

.NET 使用[垃圾回收](http://msdn.microsoft.com/library/vstudio/0xy59wtx.aspx)来释放内存。一旦一个对象不再被引用并且不能从代码中的任何地方访问，垃圾收集器[最终](http://msdn.microsoft.com/en-us/library/vstudio/ee787088.aspx#conditions_for_a_garbage_collection)可以释放内存（并且垃圾收集器**很**小心）。所以只需向后靠，让垃圾收集器完成它的工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T22:40:36.623

根本没有。因为这是不可能从空对象访问方法的。在你的情况下，你想说

```
F f = new F() // where f = null
f.SomeMethod(); // ?????? not possible 
```

在这种情况下，您会得到一个空引用异常。你也可以看到达林的评论和解释。你怎么能从 null 访问任何东西，这意味着什么。我对遗产一无所知，但 .Net 并没有为您提供这些东西。相反，您可以在不再需要它时将其设置为 null。

来自 MSDN

```
public class Node<T>
{
        // Private member-variables
        private T data;
        private NodeList<T> neighbors = null;

        public Node() {}
        public Node(T data) : this(data, null) {}
        public Node(T data, NodeList<T> neighbors)
        {
            this.data = data;
            this.neighbors = neighbors;
        }

        public T Value
        {
            get
            {
                return data;
            }
            set
            {
                data = value;
            }
        }

        protected NodeList<T> Neighbors
        {
            get
            {
                return neighbors;
            }
            set
            {
                neighbors = value;
            }
        }
    }
}

public class NodeList<T> : Collection<Node<T>>
{
    public NodeList() : base() { }

    public NodeList(int initialSize)
    {
        // Add the specified number of items
        for (int i = 0; i < initialSize; i++)
            base.Items.Add(default(Node<T>));
    }

    public Node<T> FindByValue(T value)
    {
        // search the list for the value
        foreach (Node<T> node in Items)
            if (node.Value.Equals(value))
                return node;

        // if we reached here, we didn't find a matching node
        return null;
    }
}

 and Right—that operate on the base class's Neighbors property.
public class BinaryTreeNode<T> : Node<T>
{
    public BinaryTreeNode() : base() {}
    public BinaryTreeNode(T data) : base(data, null) {}
    public BinaryTreeNode(T data, BinaryTreeNode<T> left, BinaryTreeNode<T> right)
    {
        base.Value = data;
        NodeList<T> children = new NodeList<T>(2);
        children[0] = left;
        children[1] = right;

        base.Neighbors = children;
    }

    public BinaryTreeNode<T> Left
    {
        get
        {
            if (base.Neighbors == null)
                return null;
            else
                return (BinaryTreeNode<T>) base.Neighbors[0];
        }
        set
        {
            if (base.Neighbors == null)
                base.Neighbors = new NodeList<T>(2);

            base.Neighbors[0] = value;
        }
    }

    public BinaryTreeNode<T> Right
    {
        get
        {
            if (base.Neighbors == null)
                return null;
            else
                return (BinaryTreeNode<T>) base.Neighbors[1];
        }
        set
        {
            if (base.Neighbors == null)
                base.Neighbors = new NodeList<T>(2);

            base.Neighbors[1] = value;
        }
    }
}

public class BinaryTree<T>
{
   private BinaryTreeNode<T> root;

   public BinaryTree()
   {
      root = null;
   }

   public virtual void Clear()
   {
      root = null;
   }

   public BinaryTreeNode<T> Root
   {
      get
      {
         return root;
      }
      set
      {
         root = value;
      }
   }
} 
```*