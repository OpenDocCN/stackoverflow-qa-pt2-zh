# StackOverflow 问答 14186000-14186999

# c# - 尝试反序列化从 Exception 继承的类时，Json.net 失败

> ID：14186000
> 
> 赞同：16
> 
> 时间：2013-01-06T19:44:32.287
> 
> 标签：c#, json, json.net

我有一个`SearchError`继承自的类，`Exception`当我尝试从有效的 json 反序列化它时，我得到以下异常：

> ISerializable 类型“SearchError”没有有效的构造函数。要正确实现 ISerializable，应该存在采用 SerializationInfo 和 StreamingContext 参数的构造函数。路径 ''，第 1 行，位置 81。

我尝试实现建议的缺失构造函数，但没有帮助。

这是实现建议的构造函数后的类：

```
public class APIError : Exception
{
    [JsonProperty("error")]
    public string Error { get; set; }

    [JsonProperty("@http_status_code")]
    public int HttpStatusCode { get; set; }

    [JsonProperty("warnings")]
    public List<string> Warnings { get; set; }

    public APIError(string error, int httpStatusCode, List<string> warnings) : base(error)
    {
        this.Error = error;
        this.HttpStatusCode = httpStatusCode;
        this.Warnings = warnings;
    }

    public APIError(System.Runtime.Serialization.SerializationInfo info, System.Runtime.Serialization.StreamingContext context)
        : base(info, context)
    {
        Error = (string)info.GetValue("error", typeof(string));
        HttpStatusCode = (int)info.GetValue("@http_status_code", typeof(int));
        Warnings = (List<string>)info.GetValue("warnings", typeof(List<string>));
    }
} 
```

现在我得到以下异常（也在 json.net 代码中）：

> 未找到成员“类名”。

[我也尝试实现与这个相关问题](https://stackoverflow.com/questions/3422703/how-to-deserialize-object-derived-from-exception-class-using-json-net-c?rq=1)相同的解决方案，也得到了上面相同的错误。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-08-13T02:28:11.127

这个问题在这里得到了回答：[https ://stackoverflow.com/a/3423037/504836](https://stackoverflow.com/a/3423037/504836)

添加新的构造函数

```
public Error(SerializationInfo info, StreamingContext context){} 
```

解决了我的问题。

这里完整的代码：

```
[Serializable]
public class Error : Exception
{

    public string ErrorMessage { get; set; }

    public Error(SerializationInfo info, StreamingContext context) {
        if (info != null)
            this.ErrorMessage = info.GetString("ErrorMessage");
    }
    public override void GetObjectData(SerializationInfo info,StreamingContext context)
    {
        base.GetObjectData(info, context);

        if (info != null)
            info.AddValue("ErrorMessage", this.ErrorMessage);
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T19:55:35.747

正如错误所说，您缺少序列化构造函数：

```
public class SearchError : Exception
{
    public SearchError(System.Runtime.Serialization.SerializationInfo info, System.Runtime.Serialization.StreamingContext context) : base(info, context)
    {

    }
} 
```

# r - 取出R中日期最大的行

> ID：14186005
> 
> 赞同：0
> 
> 时间：2013-01-06T19:45:07.213
> 
> 标签：r

我在 R 中有一个数据框。假设它是股票价格。

```
[1] "Date"      "Open"      "High"      "Low"       "Close"     "Volume"   
[7] "Adj.Close"
10   2012-12-20 54.53 54.61 53.70 54.21   4898900     54.21
9    2012-12-21 53.05 53.69 52.59 53.60  11076800     53.60
8    2012-12-24 53.37 54.00 53.33 53.69   1702900     53.69
7    2012-12-26 53.62 53.79 52.88 53.13   3047100     53.13
6    2012-12-27 53.09 53.64 52.71 53.24   4583600     53.24
5    2012-12-28 52.98 53.27 52.62 52.64   3395700     52.64
4    2012-12-31 52.41 53.67 52.39 53.63   4623500     53.63
3    2013-01-02 54.59 55.00 54.26 55.00   6633800     55.00
2    2013-01-03 55.07 55.61 55.00 55.37   7335200     55.37
1    2013-01-04 55.53 56.00 55.31 55.69   5455700     55.69 
```

类似上面的东西。现在我需要找出每年最后一天的行。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T19:52:06.223

您可以从日期中提取“分组变量”，例如年和月，然后对不同的值使用聚合函数。那将是手工完成。

或者你可以使用已经有操作符的[xts](http://cran.r-project.org/package=xts)包：

```
R> library(quantmod)                             ## for getSymbols()
R> SPY <- getSymbols("SPY", auto.assign=FALSE)   ## SPY is now of class xts 
```

我们可以看看数据

```
R> summary(SPY)
     Index               SPY.Open      SPY.High      SPY.Low     
 Min.   :2007-01-03   Min.   : 68   Min.   : 70   Min.   : 67.1  
 1st Qu.:2008-07-03   1st Qu.:111   1st Qu.:112   1st Qu.:110.0  
 Median :2010-01-04   Median :128   Median :129   Median :127.5  
 Mean   :2010-01-02   Mean   :124   Mean   :125   Mean   :123.0  
 3rd Qu.:2011-07-05   3rd Qu.:140   3rd Qu.:140   3rd Qu.:139.0  
 Max.   :2013-01-04   Max.   :157   Max.   :158   Max.   :155.4  
   SPY.Close       SPY.Volume        SPY.Adjusted  
 Min.   : 68.1   Min.   :3.87e+07   Min.   : 62.6  
 1st Qu.:110.8   1st Qu.:1.38e+08   1st Qu.:104.1  
 Median :128.4   Median :1.86e+08   Median :121.1  
 Mean   :124.0   Mean   :2.12e+08   Mean   :116.1  
 3rd Qu.:139.7   3rd Qu.:2.57e+08   3rd Qu.:130.0  
 Max.   :156.5   Max.   :8.71e+08   Max.   :146.4  

R> 
```

并运行我们想要的计算：

```
R> tail(SPY[ endpoints(SPY) ])
           SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume
2012-08-31   141.29   141.82  140.36    141.16  151970400
2012-09-28   144.09   144.56  143.46    143.97  150696100
2012-10-31   141.85   142.03  140.68    141.35  103438500
2012-11-30   142.14   142.42  141.66    142.15  136568300
2012-12-31   139.66   142.56  139.54    142.41  243935200
2013-01-04   145.97   146.61  145.67    146.37  116790800
           SPY.Adjusted
2012-08-31       139.42
2012-09-28       142.96
2012-10-31       140.35
2012-11-30       141.15
2012-12-31       142.41
2013-01-04       146.37 
```

这`endpoints()`是您想要的功能，它默认选择月份。它找到我们想要的行索引。所以多年来一直如此：

```
R> SPY[ endpoints(SPY, "years") ]
           SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume
2007-12-31   147.10   147.61  146.06    146.21  108126800
2008-12-31    89.08    90.97   88.87     90.24  193987200
2009-12-31   112.77   112.80  111.39    111.44   90637900
2010-12-31   125.53   125.87  125.33    125.75   91218900
2011-12-30   126.02   126.33  125.50    125.50   95599000
2012-12-31   139.66   142.56  139.54    142.41  243935200
2013-01-04   145.97   146.61  145.67    146.37  116790800
           SPY.Adjusted
2007-12-31       131.14
2008-12-31        82.88
2009-12-31       104.73
2010-12-31       120.49
2011-12-30       122.78
2012-12-31       142.41
2013-01-04       146.37
R> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:35:25.307

您还可以使用基本的 R 包提取信息：

```
#Get the years from the dataset
years=unique(format(dataset$Date, "%Y"))
#Get the last day values for each year
values=list()
for (y in 1:length(years)){
    values[[y]]=dataset[dataset$Date==max(dataset$Date[format(dataset$Date, "%Y")==years[y]]),]
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T03:46:19.090

基础解决方案：

获取一些测试数据：

```
test <- read.table(textConnection("Date      Open      High      Low  Close Volume Adj.Close
2012-12-28 52.98 53.27 52.62 52.64   3395700     52.64
2012-12-31 52.41 53.67 52.39 53.63   4623500     53.63
2013-01-03 55.07 55.61 55.00 55.37   7335200     55.37
2013-01-04 55.53 56.00 55.31 55.69   5455700     55.69"),header=TRUE) 
```

将日期列更改为实际日期：

```
test$Date <- as.Date(test$Date) 
```

获取与每年的最大日期对应的行：

```
do.call(
         rbind,
         by(test,format(test$Date,"%Y"),function(x) x[x$Date == max(x$Date),])
       )

           Date  Open  High   Low Close  Volume Adj.Close
2012 2012-12-31 52.41 53.67 52.39 53.63 4623500     53.63
2013 2013-01-04 55.53 56.00 55.31 55.69 5455700     55.69 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-07T08:46:56.427

使用来自@thelatemail 的“测试”数据集，这是另一种——不是一个，而是两个——基 R 方法：

1.  `ave()`++`cut.Date()`基本子集：

    ```
    test[test$Date == ave(test$Date, cut(test$Date, "1 year"), FUN = max), ]
    #         Date  Open  High   Low Close  Volume Adj.Close
    # 2 2012-12-31 52.41 53.67 52.39 53.63 4623500     53.63
    # 4 2013-01-04 55.53 56.00 55.31 55.69 5455700     55.69 
    ```

2.  `sapply()`+ `split()`+ `cut.Date()`。我不太喜欢它，以至于您必须转置输出。我想你也可以`lapply()`代替`sapply()`, 然后使用`do.call(rbind...)`来获取`data.frame`.

    ```
    t(sapply(split(test, cut(test$Date, "1 year")), 
             function(x) x[which.max(x[["Date"]]),]))
    #            Date  Open  High  Low   Close Volume  Adj.Close
    # 2012-01-01 15705 52.41 53.67 52.39 53.63 4623500 53.63    
    # 2013-01-01 15709 55.53 56    55.31 55.69 5455700 55.69 
    ```

# javascript - 检查函数是否为假并使用它的值而不再次调用它

> ID：14186007
> 
> 赞同：-2
> 
> 时间：2013-01-06T19:45:12.317
> 
> 标签：javascript

嗨，我想知道是否有一种好方法来检查函数是否返回某些东西，如果它返回 false，则有一个后备。

```
function setPage(hash){
    for(k = 0; k<magazine.pages.length ; k++ )
    {
        if( magazine.pages[k][2] == hash )
        {
            return k;
            break;
        }
    }
    return false;
};

var actualPage = ( !hash ? 0 : setPage(hash.replace('#', '')) ? setPage(hash.replace('#', '')) : 0 )} ); 
```

我想避免 setPage() 函数被调用两次，而我之前无法存储它的值，因为我希望只有在 hash 为真时才调用它。是否可以在不牺牲简短语法的情况下做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:36:14.337

如果你让你的`setPage()`方法返回`0`而不是`false`你的问题消失了，而你的方法将不再返回模棱两可的变量类型：

```
function setPage(hash){
    for(k = 0; k < magazine.pages.length ; k++ )
    {
        if( magazine.pages[k][2] == hash )
        {
            return k;
            break;
        }

    }
    return 0;
};

var pageNum = hash ? setPage(hash.replace("#", "")) : 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:40:01.490

您可以使用布尔值`||`（或）。

```
var actualPage = ( !hash ? 0 : setPage(hash.replace('#', '')) || 0 )} ); 
```

Javascript 利用[短路求值](http://en.wikipedia.org/wiki/Short-circuit_evaluation)-`||`测试左边的表达式，如果它是真的，则返回该值，否则返回右边的值：

例如

```
var echoBack = function(v) { return v; }

echoBack(false) || 0; // 0;

echoBack('hello') || 0; // 'hello' 
```

# c# - 如何更新我的 API 以使用 async 关键字而不对所有调用者使用 await

> ID：14186009
> 
> 赞同：5
> 
> 时间：2013-01-06T19:45:17.850
> 
> 标签：c#, .net, .net-4.5, async-await

我正在尝试使用and将一些`TcpClient`依赖代码移植到 .net 4.5 。`StreamSocket``DataReader`

我有一个名为的函数`ReadLine()`，它无处不在。通过`DataReader`在这段代码的主体（`LoadAsync()`）中使用，我的方法被迫用`async`关键字标记。

连锁反应如下：现在我有数百个地方必须添加`async`到调用方法并将等待应用于底层`async`方法调用。

这引出了我的下一个问题......是否有一种简单的包装`ReadLine()`方法，以便调用方法不知道它是一个异步方法，这样我就不必更改我的其余代码？

另外...我经常从多个地方循环使用此方法调用。如果现在标记了这些方法`async`，恐怕我可能会在不应该的时候从流中读取数据，这将导致各种噩梦。这是一个问题还是我想得太远了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-07T02:20:51.313

> Also... I often use this method call in a loop, from multiple places. If these methods are now marked async, i'm afraid I might be reading data off a stream when I shouldn't be, which will cause all sorts of nightmares. Is it a problem or am I thinking too far ahead?

If you always use `await` whenver you call `*Async` methods, then your `async` methods will act just like synchronous methods (except they won't block). So using `await` in a loop will work just like you expect.

* * *

`async` does indeed "grow" through the code base. I usually think of this as similar to the old story about "turtles all the way down"; others have called it a "zombie virus".

I describe [the deadlock situation](http://nitoprograms.blogspot.com/2012/07/dont-block-on-async-code.html) in detail on my blog. As I state there, the best option is to allow `async` to grow.

If you *must* create a [synchronous wrapper for an asynchronous method, see Stephen Toub's advice](http://blogs.msdn.com/b/pfxteam/archive/2012/04/13/10293638.aspx). You can use `Task.Result`, but you need to do two things:

*   Use `ConfigureAwait(false)` everywhere. This will sidestep the deadlock situation.
*   Be aware that `Result` has different error handling semantics.

For your particular example, something like this should suffice:

```
private async Task<string> ReadLineAsync()
{
  ... // *Every* await in this method and every method it calls
      // must make use of ConfigureAwait(false).
}

public string ReadLine()
{
  try
  {
    return ReadLineAsync().Result;
  }
  catch (AggregateException ex)
  {
    ExceptionDispatchInfo.Capture(ex.InnerException).Throw();
    throw;
  }
} 
```

Please carefully consider the complexity before choosing a mixed synchronous/asynchronous code base. It's not as easy as it first appears.

P.S. Generally speaking, TCP/IP code should all be asynchronous anyway. It's usually a good idea to have a continuous asynchronous read going on a socket.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T19:51:10.003

创建一个 ReadLineAsync 函数和一个 ReadLine 函数。
在 ReadLine 函数中，您可以像这样调用 ReadLineAsync：

```
var readLineTask = ReadLineAsync(); 
readLineTask.Wait() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T19:53:45.373

将其标记为异步并不意味着您必须在调用它时等待它。您将其标记为异步，因为您在方法中使用了 await 。

这意味着您不必仅仅因为您`ReadLine()`在那里调用而将其他方法标记为异步。

为了使您的 readline 方法可以等待，它必须返回一个`Task`or `Task<T>`。

# c# - '无法访问已处置的对象。对象名称 'oracle 连接' oracle.DataAccess"

> ID：14186011
> 
> 赞同：1
> 
> 时间：2013-01-06T19:45:19.740
> 
> 标签：c#, android, oracle11g, ksoap2, android-ksoap2

我正在制作一个 android 应用程序，因为我使用 ksoap2 调用 .net c# web 服务，我的 android 应用程序向 web 服务发送一个字符串，该服务从 oracle 数据库中提取用户详细信息并返回连接在字符串中的响应。

我通常能够正确检索响应。然后突然服务器开始向我抛出以下错误“无法访问已处理的对象。对象名称'oracle连接'oracle.DataAccess”，我无法访问Web服务器上的Web服务。

我不知道为什么会这样。有时我突然通过相同的代码得到正确的响应而没有任何更改。我的调用方法如下

```
import org.ksoap2.SoapEnvelope;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;

public class CallSoap 
{
    public final String SOAP_ACTION = "http://tempuri.org/"+method_name;

    public  final String OPERATION_NAME = method_name;

    public  final String WSDL_TARGET_NAMESPACE = "http://tempuri.org/";

    public  final String SOAP_ADDRESS = "url";

    public CallSoap(){  }

    public String Call(String a)
    {
        SoapObject request = 
            new SoapObject(WSDL_TARGET_NAMESPACE,OPERATION_NAME);

        request.addProperty("data",a);

        SoapSerializationEnvelope envelope = 
            new SoapSerializationEnvelope(SoapEnvelope.VER11);

        envelope.dotNet = true;

        envelope.setOutputSoapObject(request);

        HttpTransportSE httpTransport = 
            new HttpTransportSE(SOAP_ADDRESS);

        Object response=null;
        try 
        {
            httpTransport.call(SOAP_ACTION, envelope);

            response = envelope.getResponse();
        }
        catch (Exception exception)
        {
            response=exception.toString();
        }

        return response.toString();
    }
} 
```

但是相同的 Web 服务可以从 Web 浏览器应用程序中正常运行。

我搜索了每个论坛可能的答案，最后在这里问了这个问题。很抱歉描述不够清楚，因为我对这一切都不熟悉。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T19:50:48.453

您的问题的原因与您的 Android 应用程序无关。它纯粹在 C# Web 服务中。

这可能是仅在某些条件下触发的错误，而在使用 Web 浏览器时不会发生。然而，问题出在服务器端。

如果您构建了 Web 服务，请使用有关该服务的足够信息开始一个新问题。如果没有，那么您需要将其委托给 Web 服务的所有者。

# codeigniter - Codeigniter Pagination 第三页链接被禁用

> ID：14186012
> 
> 赞同：1
> 
> 时间：2013-01-06T19:45:25.250
> 
> 标签：codeigniter, pagination

这是我的控制器：

```
class Comment extends CI_Controller {

function article() {
    $this->load->library('pagination');
    $this->load->model('comment_m');
            $id=$this->uri->segment(3);
    $config['base_url'] = 'http://localhost/ci/CodeIgniter_2.1.3/index.php/comment/article/'.$id;
    $config['total_rows'] = $this->db->get('comment_article')->num_rows();
            $config['per_page'] = 5;
    $config['num_links'] = 5;
    $config['full_tag_open'] = '<div id="pagination">';
    $config['full_tag_close'] = '</div>';
    $this->pagination->initialize($config);
            echo $this->uri->segment(4);
            $data['c_review'] = $this->comment_m->getarticle($id, $config['per_page'], $this->uri->segment(4));

            $this->load->view('comment_v', $data);
}
} 
```

这是我的模型：

```
class Comment_m extends CI_Model{

function getarticle($id,$limit,$start) {
    $this->db->select('name, content');
    $this->db->from('comment_article');
            $this->db->where('article_id', $id); 
            $this->db->limit($limit, $start);
    $q = $this->db->get();

    if($q->num_rows() > 0) {
        foreach ($q->result() as $c_review) {
            $data[] = $c_review;
        }
        return $data;
    }       

}
} 
```

如果我的文章少于或等于 10 篇（仅 2 页），则分页工作正常，但如果我有第三个分页链接，则第 3 个链接变得不可复制并且不是锚标记。我在我的另一个页面中使用了相同的分页，它工作正常，但是这个导致了这个问题。

这是分页页面图片的链接。这里突出显示的页面是 3，而活动页面仍然是 1，所以第 3 页是不可靠的。

[这是图片的链接](http://s20.postimage.org/v4pdir8n1/paginate.png)

这是我的另一个实现，我无法通过此分页实现，但这就是我想要的：这里当前页面是第 1 个，共有 13 个项目，每页 5 个项目。

[这是指向所需实现的链接](http://s20.postimage.org/z3r6fbmnx/paginate.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T05:06:13.567

以及您对 total_rows 有问题的观点，它为您提供了从 db 中选择的行数，而不是总数，如果您使用任何 where 子句，最好使用 count_all 或 count_all_result 只需更改它

```
from
$config['total_rows'] = $this->db->get('comment_article')->num_rows();

to 
$config['total_rows'] = $this->db->get('comment_article')->count_all(); 
```

另一项更改将在您在其他服务器上部署项目时为您提供帮助

```
from
$config['base_url'] = 'http://localhost/ci/CodeIgniter_2.1.3/index.php/comment/article/'.$id;

to
$config['base_url'] = base_url('comment/article/'.$id); // it will automatically add default base_url 
```

最重要的是你必须添加 $config['uri_segment'] 你必须告诉哪个段是页码默认是 3

```
$config['uri_segment'] = 3; 
```

在 CI 网站上查看分页文档

# c# - 如何删除 (LocalDb)\v11.0 MVC 4 中的数据库？

> ID：14186021
> 
> 赞同：1
> 
> 时间：2013-01-06T19:46:35.293
> 
> 标签：c#, asp.net-mvc, entity-framework-4

我和这个家伙有类似的问题[http://forums.asp.net/t/1849215.aspx/1?Ef+5+woes+Could+not+drop+constraint+](http://forums.asp.net/t/1849215.aspx/1?Ef+5+woes+Could+not+drop+constraint+)

我使用 VS2012 express 的数据库资源管理器删除了一个表，这似乎是一个坏主意，因为现在当我尝试进行迁移时，我收到了这个错误：

```
'FK_dbo.PriceGuides_dbo.Animals_AnimalId' is not a constraint.
Could not drop constraint. See previous errors. 
```

这是错误的，即使我删除或删除了任何称为 Priceguides、priceguides 的模型类和 priceguides 表的内容，我也会收到此错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:33:14.030

听起来您正在使用自动迁移，对吗？您可以发布它尝试运行的迁移吗？听起来它试图放弃一个不存在的约束。

这是我给其他陷入类似困境的人的答案：

[未使用 EF 迁移创建 SQL Azure 表](https://stackoverflow.com/questions/13826651/sql-azure-table-not-created-with-ef-migrations/13972292#13972292)

阅读这可能会让你回到正确的轨道上。你也可以专门试试这个；EF 不只是查看您的模型和数据库方案。它跟踪 __MigrationHistory 表中曾经运行过的所有迁移。查看此表，看看是否仍然存在对创建“FK_dbo.PriceGuides_dbo.Animals_AnimalId”约束的旧迁移的引用。只要 __MigrationHistory 表中有记录，自动迁移可能会继续尝试回滚它。

如果您更新了模型和 DBcontext

# ios - ReverseGeoCode 并在 CoreData 中保存结果

> ID：14186029
> 
> 赞同：0
> 
> 时间：2013-01-06T19:48:07.140
> 
> 标签：ios, core-data, background-process, reverse-geocoding, background-thread

假设我在 coreData 中有 1000 个海拔和经度条目。我想对这些高度和经度进行 reverseGeoCoding 并将结果保存回 coreData 。基于以下问题，我决定将 reverseGeoCode 操作置于后台

1.  ReverseGeoCode 在网络连接缓慢时需要一些时间。
2.  我们应该每分钟只使用一个地理编码请求。

我的问题是在上述情况下更新 coreData 的最佳做法是什么？- 当应用程序进入后台？（不要忘记有限的 backgroundTimeRemaining 将可用） - 或者在前台应用程序时在后台线程上。

简而言之，对于每个坐标，我想要 reverseGeoCoded 地址。请给出我应该遵循的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:14:11.060

我建议为此目的保留一个单独的 ManagedObjectContext。这将防止其他 CoreData 任务的任何锁定问题，并允许您为用户的工作拥有一个 MOC。想必用户并不想仅仅因为一个无关的后台任务完成就保存他们的工作，所以他们需要自己的 MOC！

鉴于相对较慢的查找（1/分钟），我会说在每个之后继续保存更改。

当应用程序在后台时，您不能这样做；您需要取消任何未决的反向地理编码请求，并在您回到前台时恢复它们。但是我建议您在前台使用后台线程。

如果您需要在其他 MOC 中使用这些对象，则通常的机制适用 - 发送通知或以其他方式让他们知道，以便他们获得新的。

# image - 如何在 Windows Store 应用程序中引用来自不同程序集的图像？

> ID：14186031
> 
> 赞同：1
> 
> 时间：2013-01-06T19:48:22.660
> 
> 标签：image, windows-runtime, embedded-resource

我有一个 Windows 应用商店应用程序，可以轻松引用存储为内容的图像：

var image = new BitmapImage(new Uri("ms-appx:///Images/MyImage.png"));

但是，如果图像作为嵌入式资源存储在不同的程序集中怎么办？怎样才能被引用？我尝试了不同的 Uri 表示法，但都没有奏效。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T07:04:34.933

如果您的资产是 Images 文件夹中 MyLibrary.dll 的一部分，这应该可以工作：

```
var image = new BitmapImage(new Uri("ms-appx:///MyLibrary/Images/MyImage.png")); 
```

# c - 将 Char[] 与 C“嵌入式”中的字符串进行比较

> ID：14186032
> 
> 赞同：-4
> 
> 时间：2013-01-06T19:48:41.650
> 
> 标签：c, string, embedded, 8051, keil

我尝试创建两个函数将字符串拆分为 2 部分，第一个函数我想从串口获取字符串“模式 1”，当`RX_IN_CHR_UART` 变量时，填充数据如“模式 1 34”，第二个函数我想获取“34”

此函数获取字符串**“模式 1”**

```
 #define GET_MODE_X 6
    #define GET_VALUE 4
    const char RX_IN_CHR_UART[];
        char* pod(char buf_Rx[])
            {
              int i=0;
              char spn[GET_MODE_X]; // 7
              for(i=0;i<GET_MODE_X;i++)
              {
                spn[i] = buf_Rx[i];
              }
              return Get_mode_x = spn;
            } 
```

和这个函数来获取字符串**“34”**

```
char* dop(char buf_Rx_val[])
{
   int k=0; 
   char datasip[GET_VALUE]; //2       
   for(k=0;k<GET_VALUE;k++)
   {
     datasip[k] = buf_Rx_val[GET_MODE_X+k+1];
   }
   return (Get_val_mod = datasip);
} 
```

当我尝试比较功能时`dop()`，`if(dop(RX_IN_CHR_UART)=="34")`它不起作用。

```
 if(!strcmp(mode1,pod(RX_IN_CHR_UART))) // compare "Mode 1"
   {
      Send_teks("Mode 1 ->:"); // send to serial port
      Send_teks(pod(RX_IN_CHR_UART));
      Send_Char('\n');
      Send_teks("Data yang dimasukkan ->:");
      Send_teks(dop(RX_IN_CHR_UART));
      Send_Char('\n');
      if(dop(RX_IN_CHR_UART) == "34") // doesn't work well
      {
        pwm_off();
        LCD_command(0x85);
        LCD_sendstring("Kipas off  ");
        Send_teks("Sukses");
        Send_Char('\n');
        Send_teks("Kipas Off");
        Send_Char('\n');
      }
  } 
```

我应该用这个函数做什么来比较 dop() 等于“34”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T19:52:01.953

使用 strcmp() 而不是 ==，就像在第一行中所做的那样。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T19:51:55.000

学习在编译器中启用所有警告。对于 GCC，这意味着`gcc -Wall`.

编译器应该警告您使用`==`来比较字符串（特别是与文字字符串）是不正确的。您应该`strcmp`为此目的使用：

```
 if(strcmp(dop(RX_IN_CHR_UART), "34") == 0) { 
```

# mef - 托管可扩展性框架 (MEF) 错误列表

> ID：14186043
> 
> 赞同：1
> 
> 时间：2013-01-06T19:50:18.873
> 
> 标签：mef

我在 Visual Studio 2010 中使用托管可扩展性框架 (MEF) 来增强 Visual Studio 本身。具体来说，我在某些情况下会生成错误，以帮助开发人员知道代码何时出现问题。我可以使用 ErrorTag 让红色波浪出现，但错误不会出现在错误列表中。

我注意到当自定义错误出现时，应用程序仍然运行。所以自定义错误实际上并不能阻止开发人员忽略它们并继续他们的快乐方式。本质上，据我所知，ErrorTag 所做的只是创建一个红色波浪形，仅此而已。

有谁知道如何使用 MEF 将错误添加到错误列表中，并在出现自定义错误时阻止应用程序运行？如果它实际上没有向开发人员突出显示，而是直接盯着它，它有点违背了创建错误的目的。下面是代码片段。这些只是寻找一个简单的文本来标记为错误，只是为了保持示例简单和干净。

另外，有没有人有关于扩展视觉工作室的好视频或书籍？我发现的最好的是在 Pluralsight 上，但它仍然只触及表面。

```
[Export(typeof(ITaggerProvider))]
[ContentType("code")]
[TagType(typeof(ErrorTag))]
class CheckTextErrorProvider : ITaggerProvider
{
    public ITagger<T> CreateTagger<T>(Microsoft.VisualStudio.Text.ITextBuffer buffer) where T : ITag
    {
        if (buffer == null)
        {
            throw new ArgumentException("Buffer is null");

        }
        else
        {
            return new CheckTextErrorTagger() as ITagger<T>;
        }
    }
}

class CheckTextErrorTagger: ITagger<IErrorTag>
{
    private const string _searchText = "checktext";
    public IEnumerable<ITagSpan<IErrorTag>> GetTags(NormalizedSnapshotSpanCollection spans)
    {
        foreach (SnapshotSpan currSpan in spans)
        {
            int loc = currSpan.GetText().ToLower().IndexOf(_searchText);

            if (loc > -1)
            {
                SnapshotSpan CheckTextSpan = new SnapshotSpan(currSpan.Snapshot, new Span(currSpan.Start + loc, _searchText.Length));
                yield return new TagSpan<ErrorTag>(CheckTextSpan, new ErrorTag());
            }
        }
    }

    public event EventHandler<SnapshotSpanEventArgs> TagsChanged
    {
        add { }
        remove { }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T17:17:37.433

您应该创建一个 ErrorListProvider：

```
 class ErrorListHelper
{
    public static ErrorListProvider GetErrorListProvider()
    {

        Microsoft.VisualStudio.OLE.Interop.IServiceProvider globalService = (Microsoft.VisualStudio.OLE.Interop.IServiceProvider)Microsoft.VisualStudio.Shell.Package.GetGlobalService(typeof(Microsoft.VisualStudio.OLE.Interop.IServiceProvider));

        System.IServiceProvider serviceProvider = new ServiceProvider(globalService);

        ErrorListProvider mErrorListProvider = new ErrorListProvider(serviceProvider);
        mErrorListProvider.ProviderName = "JS Errors";
        mErrorListProvider.ProviderGuid = new Guid(EnvDTE.Constants.vsViewKindCode);
        return mErrorListProvider;
    }
} 
```

用它：

```
mErrorListProvider = ErrorListHelper.GetErrorListProvider(); 
```

并添加一个错误：

```
ErrorTask errorTask = new ErrorTask();

            errorTask.Line = err.LineIndex;
            errorTask.Column = err.ColumnIndex;
            errorTask.Text = err.Text;
            errorTask.ErrorCategory = TaskErrorCategory.Warning;
            errorTask.Document = mFilePath;

            errorTask.Navigate += errorTask_Navigate;

            mErrorListProvider.Tasks.Add(errorTask); 
```

# ajax - 如何使用 Apache 正确配置反向代理，以用于跨域 AJAX？

> ID：14186045
> 
> 赞同：12
> 
> 时间：2013-01-06T19:50:34.163
> 
> 标签：ajax, apache, cross-domain, wampserver

需要开发一个同时高度依赖 API 但又不能与 API 本身驻留在同一域中的 Web 应用程序，在发出异步 HTTP 请求时绕过“同源策略”非常棘手（阿贾克斯）。有一次，有人建议我在我的计算机（运行 Windows 7）上安装 WAMP，并使用 Apache 配置反向代理。***同一个人在告诉我为名为dev***的 IP 127.0.0.1在文件中（我做了）`httpd.conf`创建别名之后，给了我添加到文件中的 Apache 指令：*`c:\windows\system32\drivers\etc\hosts`*

 *```
LoadModule headers_module modules/mod_headers.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_connect_module modules/mod_proxy_connect.so
LoadModule proxy_http_module modules/mod_proxy_http.so
LoadModule ssl_module modules/mod_ssl.so

Listen 127.0.0.1:8080
ProxyRequests off

<Proxy *>
                Order deny,allow
                Deny from all
                Allow from 127.0.0.1
</Proxy>

<VirtualHost dev:8080>
                ProxyPass / https://app.somesite.com:5002/
                ProxyPassReverse / https://app.somesitecom:5002/
                ProxyPassReverseCookieDomain app.somesite.com dev
                Header edit Location ^https://dev(:8080)?(.+)$ http://dev$1$2
                Header edit Set-Cookie "(^.+); secure; HttpOnly$" "$1; HttpOnly"
                SSLProxyEngine on
    SSLProxyVerify none
</VirtualHost> 
```

由于在配置服务器方面我是一个完全的新手，我只是粘贴了指令，幸运的是，代理工作。当我使用浏览器的地址栏访问时，它会从 API 返回正确的响应，例如`http://dev:8080/a/w/currencies`.

不幸的是，对同一 URL 的 AJAX 请求（代码如下）使 Chrome 给我`XMLHttpRequest cannot load http://dev:8080/a/w/currencies. Origin http://dev is not allowed by Access-Control-Allow-Origin.`错误。

```
$.ajax({
    url: "http://dev:8080/a/w/currencies",
    type: "GET",
    dataType: "json",
    data: {

    },
    success: function(data){
        console.log(data);
    }
}); 
```

那么，为了让这个代理与 AJAX 一起工作，还必须做些什么呢？我被告知了一些关于`alias`指令的内容，但不够具体和清晰，所以对于我缺乏经验的大脑来说没有多大意义。

PS：另外，有人告诉我“*问题是您从 dev:80 和 ajaxing 获取文件到 dev:8080* ”。鉴于我缺乏经验，这都没有多大意义。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-06T20:11:35.757

您有一个具有公共 IP 的服务器，并且 apache 正在其上运行。现在您想在 LAN 上托管您的应用程序，并希望它们可以在 Internet 上访问，重要的是这些应用程序仍在 LAN 上的机器上运行。

```
 |--------------192.168.1.3
                           |            (internal3.example.com)
                           |
                           |--------------192.168.1.4
                           |            (internal4.example.com)
  (Public IP )             |
            A--------------|
(reverse proxy server)     |
  (192.168.1.25)           |
example.com                |
                           |--------------192.168.1.1
                           |            (internal1.example.com)
                           |
                           |--------------192.168.1.2
                           |            (internal2.example.com) 
```

我正在使用 Ubuntu 来托管 Apache 虚拟主机定义，如果是基于 Debian 的系统，网站的定义是在上面完成的

/etc/apache2/sites-enabled/*.conf

其中 *conf 对应于

internal1.conf internal2.conf internal3.conf internal4.conf

每个站点的虚拟主机定义如下

/etc/apache2/sites-enabled/internal1.example.conf

```
<virtualhost *:80>
    ServerAdmin webmaster@localhost
    ServerName internal1.example.com
    ProxyRequests off
    <proxy *>
        Order deny,allow
        Allow from all
    </proxy >
    ProxyPass / http://192.168.1.1/
    ProxyPassReverse / http://192.168.1.1/ 
</VirtualHost> 
```

/etc/apache2/sites-enabled/internal2.example.conf

```
<virtualhost *:80>
      ServerAdmin webmaster@localhost
      ServerName internal2.example.com
      ProxyRequests off
      <proxy *>
      Order deny,allow
      Allow from all
      </proxy >
      ProxyPass / http://192.168.1.2/
      ProxyPassReverse / http://192.168.1.2/
</VirtualHost > 
```

/etc/apache2/sites-enabled/internal3.example.conf

```
<virtualhost *:80>
      ServerAdmin webmaster@localhost
      ServerName internal3.example.com
      ProxyRequests off
      <proxy *>
      Order deny,allow
      Allow from all
      </proxy >
      ProxyPass / http://192.168.1.3/
      ProxyPassReverse / http://192.168.1.3/
</VirtualHost > 
```

/etc/apache2/sites-enabled/internal4.example.conf

```
<virtualhost *:80>
    ServerAdmin webmaster@localhost
    ServerName internal4.example.com
    ProxyRequests off
    <proxy *>
        Order deny,allow
        Allow from all
    </proxy>
    ProxyPass / http://192.168.1.4/
    ProxyPassReverse / http://192.168.1.4/
</VirtualHost> 
```

请注意，在上述所有虚拟主机定义中，我都删除了日志文件的选项。因此，如果您应用到生产服务器，请将它们添加到每个 vhost 文件中。以上只是为您提供一个明确的示例，说明它是如何工作的。我运行了一个非常复杂的 Apache 设置，所以上面只是一个帮助你的小例子。

现在来到 Ajax 你的问题的一部分

在 chrome 中按 Ctrl+Shift+I 你会看到应用程序到底在哪里坏了，它会给你一些线索，（**从与你正在开发 Web 应用程序的机器不同的机器发出请求**）如果你可以看看如果请求来自 apache 日志`http://sample`具有 ajx api 的页面实际上已到达您的 apache 服务器，这将为您提供更多提示，如果代理正确转发您的请求，请使用 firefox 中的某些工具（如 live_http）在没有请求的情况下发布 HTTP HEADERS请求是由应用程序发出的，如果请求到达反向代理后面的服务器，观察标头可以为您提供帮助，还检查运行反向代理的服务器的日志，如果来自 Web 的请求到达它，以及请求是否到达到达了所请求的 URL。这会给你一个线索，

并且出于开发目的，在您的 .conf 文件中禁用重写规则一段时间以进行测试，一一进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-10T20:29:55.283

这里的问题是浏览器试图保护您免受放置在某些网页上的随机 javascript 的攻击。如果它能让所有的 javascript 在相同的上下文中运行，你就会将 Facebook 会话 cookie 或其他一些数据丢失给坏人。

在这种情况下，罪魁祸首可能很简单，因为 Chrome 不认为 'dev' 是完全合格的域名，因此它将无法通过同源测试。其他原因可能是在某些时候您从 app.somesite.dev 获取内容，并且在某些时候您向“dev”发送请求

服务器不在乎他们发送什么，您需要欺骗浏览器以相信所有内容都来自同一主机

1.  我会用 dev.example.com 127.0.0.1 替换主机文件中的“dev”
2.  我会确保来自 Apache 代理的所有内容都只引用 dev.example.com，无论它来自哪个服务器
3.  仅在您的代码中使用 dev.example.com

如果一切都失败了，您可以添加一个 HTTP 标头 'Access-Control-Allow-Origin: *' 以允许任何来源，但我不会使用它，除非仅在开发环境中使用。

PS。即使您从 example.com:80 获取 javascript，javascript 甚至无法调用 example.com:443 或 example.com 的 javascript 也无法向 dev.example.com 发出 xmlhttprequests

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-09T13:43:35.300

在 127.0.0.1 上，您的 html 代码应为：

```
$.ajax({
    url: "http://127.0.0.1/a/w/currencies",
    type: "GET",
    dataType: "json",
    data: {
    },
    success: function(data){
        console.log(data);
    }
}); 
```

在 127.0.0.1，你的 apache conf 应该是：

```
...

<VirtualHost dev:8080>
            ...
            ProxyPass / https://app.somesite.com:5002/
            ProxyPassReverse / https://app.somesitecom:5002/
            ...
</VirtualHost> 
```

在这种情况下，您的浏览器不会跨域，因为您的 url 和 ajax 使用相同的域。但是确切地说，ajax 请求 [https://app.somesite.com:5002/](https://app.somesite.com:5002/)，我不知道是不是反向-proxy，但它似乎对我有用。试试 ：）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-10-24T14:23:30.393

我很快就会自己尝试同样的事情，这就是我找到这个线程的方式。

我想知道您在 AJAX 请求中使用的实际 url 是否错误。本质上，您正在连接到代理。它会将您转发到端口 8080 地址。那你试试直接向8080地址发起AJAX请求？相对链接可能会起作用，以便 AJAX 调用沿同一路径转发，以便 javascript 知道它是同一来源。

另一种方法是使用 PHP 进行后端处理。本在线课程的第 7 讲涵盖了 AJAX，并使用 PHP 做了一个示例，以完全规避同源限制。 [http://academicearth.org/courses/building-dynamic-websites/](http://academicearth.org/courses/building-dynamic-websites/)

我刚刚发现了这个，这似乎是一个更好的解决方案。 [http://darius.kruythoff.net/blog/2011/xss-with-apache/](http://darius.kruythoff.net/blog/2011/xss-with-apache/)*

# r - 如何将返回具有因子的数据帧的函数应用于序列

> ID：14186051
> 
> 赞同：10
> 
> 时间：2013-01-06T19:50:54.427
> 
> 标签：r, dataframe

如何将返回带有因子的 data.frame 的函数应用于序列？

例子：

```
s <- factor(c(10, 20, 30))
t <- factor(c("a", "b", "a"))
v <- c(5, 6, 4)

df <- data.frame(s,t,v) 
```

所以 data.frame df 是这样的：

```
 s t v
1 10 a 5
2 20 b 6
3 30 a 4 
```

我还有一个返回 data.frame 的函数：

```
simpleFunc2 <- function(df, x){
  tmp <- subset(df, df$s == x)
  return(tmp)
} 
```

现在我有一个序列

```
x <- c(20, 30, 10, 30, 10) 
```

并希望结果 auf 将函数 simpleFunc2 应用于此序列。

我用 sapply

```
sapply(x, function(x) simpleFunc2(df, x)) 
```

但我明白了

```
 [,1]     [,2]     [,3]     [,4]     [,5]    
s factor,1 factor,1 factor,1 factor,1 factor,1
t factor,1 factor,1 factor,1 factor,1 factor,1
v 6        4        5        4        5 
```

如何获得正确的因子值？

这个例子被简化了。因此，在这种情况下，也许有一种更简单的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-06T19:56:39.210

尝试`lapply`改为`do.call`：

```
do.call(rbind, lapply(x, function(x) simpleFunc2(df=df, x))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T22:02:20.377

我看到您已经回答了您的问题，但我认为您从该数据框中选择超集的方法过于复杂。（如果该功能不具有代表性，我深表歉意。我想提供一种比通过更快的提取方法`subset`：

```
> df[ match(x, df$s), ]
     s t v
2   20 b 6
3   30 a 4
1   10 a 5
3.1 30 a 4
1.1 10 a 5
# Save results as from:
> do.call(rbind, lapply(x, function(x) simpleFunc2(df, x)) )
    s t v
2  20 b 6
3  30 a 4
31 10 a 5
32 30 a 4
5  10 a 5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-03T12:13:07.667

我不太明白这个问题，但两个答案都表明至少有一种简单的方法一直缺失。打字通常很方便

```
merge(df,as.data.frame(x),by=1) 
```

获得具有正确行/列名称的排序输出

```
 s t v
1 10 a 5
2 10 a 5
3 20 b 6
4 30 a 4
5 30 a 4 
```

在性能方面，所提出的方法无法与采用“匹配”的方法竞争，但在接受的答案中很容易击败该方法。

```
 microbenchmark::microbenchmark(
 do.call=do.call(rbind, lapply(x, function(x) simpleFunc2(df, x))),
 match=df[match(x, df$s), ],
 merge= merge(df,as.data.frame(x),by=1)) 
```

.

```
Unit: microseconds
    expr      min       lq    median        uq      max neval
 do.call 2487.451 2523.033 2547.4060 2604.3850 9554.748   100
   match  175.117  180.197  183.2465  187.8135  248.835   100
   merge 1020.307 1035.062 1049.4835 1071.6575 8057.059   100 
```

# asp.net - 使用箭头键导航

> ID：14186052
> 
> 赞同：0
> 
> 时间：2013-01-06T19:50:54.987
> 
> 标签：asp.net, jquery-ui, jquery, jquery-plugins

我正在使用这个 Gridview

[http://gridviewscroll.aspcity.idv.tw/Demo/Style.aspx#StyleCustom2](http://gridviewscroll.aspcity.idv.tw/Demo/Style.aspx#StyleCustom2)

有人可以告诉我如何使用箭头键导航到 GridView 到那个 gridview

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:16:08.293

1.  使用您想要扩展功能的 GridView 编辑网络表单。在那里，添加两个按钮。ButtonUp 和 ButtonDown。

2.  为按钮添加以下点击事件。我假设您的 GridView 称为 GridView1：

    ```
     protected void ButtonUp_Click(object sender, EventArgs e) {
            int i = GridView1.SelectedIndex;
            if(i>0)
            GridView1.SelectedIndex = GridView1.SelectedIndex - 1;
            }

            protected void ButtonDown_Click(object sender, EventArgs e) {
            int i = GridView1.SelectedIndex;
            if (i < GridView1.Rows.Count - 1)
            GridView1.SelectedIndex = GridView1.SelectedIndex + 1;
            } 
    ```

3.  如果您现在运行您的页面，您可以使用页面上的按钮在 GridView 中导航。现在，我们将通过 javascript 将按钮点击绑定到我们的键盘。将以下代码添加到 Page_Load 事件中：

    ```
     ClientScript.RegisterClientScriptBlock(typeof(string), "keyScript",
            @"function move(e) {
            var key = 0;
            if(window.event)
            key = event.keyCode;
            else
            key = e.keyCode;
            if(key == 38)
            document.getElementById('ButtonUp').click();
            if(key == 40)
            document.getElementById('ButtonDown').click();
            }
            document.onkeydown=move;
            ", true); 
    ```

4.  现在您应该可以使用键盘的上下键进行导航了。

5.  要使页面按钮不可见，请为它们创建以下 CssClass：

    ```
    .Invisible {
         display:none;
     } 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-22T15:15:03.510

```
<script type="text/javascript">
    $(document).keydown(function (e) {
        var keyCode = e.keyCode || e.which;
        var arrow = { left: 37, up: 38, right: 39, down: 40 };
        switch (keyCode) {
            case arrow.left:
                break;
            case arrow.up:
                document.getElementById(('<%= ButtonUp.ClientID %>')).click();
                break;
            case arrow.right:
                break;
            case arrow.down:
                //alert("down");
                document.getElementById(('<%= ButtonDown.ClientID %>')).click();
                break;
        }
    });
</script> 
```

# python - django test app error - 创建测试数据库时出错：创建数据库的权限被拒绝

> ID：14186055
> 
> 赞同：220
> 
> 时间：2013-01-06T19:51:21.253
> 
> 标签：python, sql, django, postgresql, django-testing

当我尝试使用命令测试任何应用程序时（当我尝试使用使用此命令的结构部署 myproject 时，我注意到了这一点）：

```
python manage.py test appname 
```

我收到此错误：

```
Creating test database for alias 'default'...
Got an error creating the test database: permission denied to create database

Type 'yes' if you would like to try deleting the test database 'test_finance', or 'no' to cancel 
```

`syncdb`命令似乎有效。我在 settings.py 中的数据库设置：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'finance',                      # Or path to database file if using sqlite3.
        'USER': 'django',                      # Not used with sqlite3.
        'PASSWORD': 'mydb123',                  # Not used with sqlite3.
        'HOST': '127.0.0.1',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
    }
} 
```

* * *

## 回答 #1

> 赞同：439
> 
> 时间：2013-01-06T20:31:49.907

当 Django 运行测试套件时，它会创建一个新数据库，在您的情况下是`test_finance`. 具有用户名的 postgres 用户`django`无权创建数据库，因此出现错误消息。

当您运行`migrate`or`syncdb`时，Django 不会尝试创建`finance`数据库，因此您不会收到任何错误。

您可以通过在 postgres shell 中以超级用户身份运行以下命令来向 django 用户添加 createdb 权限（[对此堆栈溢出答案](https://stackoverflow.com/questions/8988495/postgres-user-create-database/8989722#8989722)的提示）。

```
=> ALTER USER django CREATEDB; 
```

**注意：**命令中使用的用户名`ALTER USER <username> CREATEDB;`需要与 Django 设置文件中的数据库用户匹配。在这种情况下，最初的发布者，有用户作为`django`上述答案。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2017-07-16T18:08:41.360

我为您的问题找到了有趣的解决方案。
事实上，对于 MySQL，您可以为不存在的数据库授予权限。
因此，您可以在设置中为您的测试数据库添加名称“test_finance”：

```
 DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'finance',                      # Or path to database file if using sqlite3.
        'USER': 'django',                      # Not used with sqlite3.
        'PASSWORD': 'mydb123',                  # Not used with sqlite3.
        'HOST': '127.0.0.1',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
        'TEST': {
            'NAME': 'test_finance',
        },
    }
} 
```

以 root 用户身份启动 MySQL shell：

```
mysql -u root -p 
```

现在授予 MySQL 中这个不存在的数据库的所有权限：

```
GRANT ALL PRIVILEGES ON test_finance.* TO 'django'@'localhost'; 
```

现在 Django 将毫无问题地开始测试。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2018-03-05T04:14:00.083

对于 Postgres，用户必须具有`createdb`权限。

```
ALTER ROLE miriam CREATEDB; 
```

请参阅此文档：[https ://docs.djangoproject.com/en/2.0/topics/testing/overview/#the-test-database](https://docs.djangoproject.com/en/2.0/topics/testing/overview/#the-test-database)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-07-30T07:39:07.810

如果数据库是**mysql**，那么这两个更改将完成任务。

1.打开**mysite/mysite/settings.py**

您的数据库设置应该有一个额外的 TEST 块，如**projectname_test**所示。

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'myproject',
        'USER': 'chandan',
        'PASSWORD': 'root',
        'HOST': 'localhost',
        'PORT': '3306',
        'TEST': {
            'NAME': 'myproject_test',
        },
    }
} 
```

2.使用**mysql 命令提示符**或**mysql workbench键入以下命令，将所有权限授予****settings.py**中指定的用户

 **```
GRANT ALL PRIVILEGES ON myproject_test.* TO 'chandan'@'localhost'; 
```

现在您可以运行 `python manage.py test polls`.

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-03-10T16:21:05.120

就我而言，GRANT PRIVILEGES 解决方案不适用于**Python 3.7.2**、**Django 2.1.7**和**MySQL 5.6.23** ......我不知道为什么。

所以我决定使用 SQLite 作为 TEST 数据库...

```
DATABASES = {
    'default': {
        'NAME': 'productiondb',
        'ENGINE': 'mysql.connector.django',   # 'django.db.backends.mysql'
        'USER': '<user>',
        'PASSWORD': '<pass>',
        'HOST': 'localhost',
        'PORT': 3306,
        'OPTIONS': {
            'autocommit': True,
        },
        'TEST': {
            'ENGINE': 'django.db.backends.sqlite3',
            'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
        },
    }
} 
```

之后，TESTS 车无故障运行：

```
$ python manage.py test
Creating test database for alias 'default'...
System check identified no issues (0 silenced).

Destroying test database for alias 'default'...
----------------------------------------------------------------------
Ran 0 tests in 0.000s

OK

Process finished with exit code 0 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-05-01T19:07:04.497

哇，结合这里的所有答案和一点点调整终于让我找到了一个适用于 docker-compose、django 和 postgres 的工作解决方案......

首先 noufal valapra 给出的 postgres 命令不正确（或者可能只是不是当前的），它应该是：

```
ALTER USER docker WITH CREATEDB; 
```

在 docker-compose 设置的情况下，这将进入 init.sql 文件，这就是我的样子：

```
CREATE USER docker;
ALTER USER docker WITH CREATEDB;
CREATE DATABASE djangodb;
GRANT ALL PRIVILEGES ON DATABASE djangodb TO docker; 
```

然后用于 postgres 的 Dockerfile 如下所示：

```
FROM postgres:10.1-alpine
COPY init.sql /docker-entrypoint-initdb.d/ 
```

然后 Django settings.py 有这个条目：

```
if 'RDS_DB_NAME' in os.environ:
    INTERNAL_DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.postgresql_psycopg2',
            'NAME': os.environ['RDS_DB_NAME'],
            'USER': os.environ['RDS_USERNAME'],
            'PASSWORD': os.environ['RDS_PASSWORD'],
            'HOST': os.environ['RDS_HOSTNAME'],
            'PORT': os.environ['RDS_PORT'],
        }
    } 
```

docker-compose 看起来像这样：

版本：'3.6'

服务：

```
postgresdb:
  build:
    context: ./
    dockerfile: ./Dockerfile-postgresdb
  volumes:
    - postgresdata:/var/lib/postgresql/data/

django:
  build:
    context: ../
    dockerfile: ./docker/Dockerfile
  environment:
    - RDS_DB_NAME=djangodb
    - RDS_USERNAME=docker
    - RDS_PASSWORD=docker
    - RDS_HOSTNAME=postgresdb
    - RDS_PORT=5432

  stdin_open: true
  tty: true
  depends_on:
    - postgresdb

volumes:
    postgresdata: 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-09-28T06:50:46.100

如果您使用`docker-compose`对我有用的方法如下：

```
ALTER ROLE username CREATEDB;
GRANT ALL PRIVILEGES ON test_database_name.* TO 'username'; 
```

或者

```
ALTER ROLE username CREATEDB;
GRANT ALL PRIVILEGES ON *.* TO 'username'@'%'; 
```

我的设置如下所示：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'database_name',
        'USER': 'username',
        'PASSWORD': 'password',
        'HOST': 'db',
        'PORT': '3306',
    }
} 
```

我的`docker-compose.yml`样子如下：

```
version: '3'
services:
  web:
      build: .
      command: './wait_for_db_and_start_server.sh'
      env_file: env_web
      working_dir: /project_name
      links:
        - db
      volumes:
        - .:/volume_name
      ports:
        - "8000:8000"
      depends_on:
        - db
  db:
    image: mysql:5.7
    restart: always
    env_file: env_db
    working_dir: /db
    volumes:
      - ./Dump.sql:/db/Dump.sql
    ports:
      - "3306:3306" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-04-19T16:34:57.180

超级用户帐户是保证顺利测试的最简单方法。所以制作用户 su 的更简单的方法`django`是做`ALTER django WITH SUPERUSER`.

更多信息[https://www.postgresql.org/docs/current/sql-alteruser.html](https://www.postgresql.org/docs/current/sql-alteruser.html)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-03-05T07:09:53.823

## 检查运行时的操作并切换数据库

```
import sys
TESTING = sys.argv[1:2] == ['test']
if TESTING==False:
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.postgresql_psycopg2',
            'NAME': config('DB_NAME'),
            'USER': config('DB_USER'),
            'PASSWORD': config('DB_PASSWORD'),
            'HOST': config('DB_HOST'),
            'PORT': ''
             }       
           }
else:
    DATABASES = {    
        'default': {
        "ENGINE": "django.db.backends.sqlite3",
        "TEST": {
            "NAME": os.path.join(BASE_DIR, "test_db.sqlite3"),
        }
    }} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-10-10T20:06:42.137

也许您将测试置于暂停模式或作为后台作业。尝试`fg`在 bash shell 中使用命令。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-01-14T06:17:57.073

您也可以手动创建一个测试数据库，但将 TEST 键放在您的 settings.py

然后用值“默认”填充传递 MIRROR 键，以便您可以测试默认数据库的精确副本，或者您喜欢的任何数据库。

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
        'NAME': 'finance',
        'USER': 'django',
        'TEST': {
             'MIRROR': 'default',
        },
        'PASSWORD': 'mydb123',
        'HOST': '127.0.0.1',
        'PORT': '',
    }
} 
```

您还可以查看[高级 django postgres 文档](https://docs.djangoproject.com/en/3.1/topics/testing/advanced/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2022-01-18T08:27:23.077

通过键入以下内容切换到服务器上的 postgres 帐户：

```
sudo -i -u postgres 
```

您现在可以通过键入以下内容立即访问 Postgres 提示：

```
psql 
```

现在输入

```
ALTER USER username CREATEDB; 
```**

# mvvm - 集合中项目的互斥属性

> ID：14186056
> 
> 赞同：0
> 
> 时间：2013-01-06T19:51:22.493
> 
> 标签：mvvm, caliburn.micro

![截屏](../Images/a1820631ac0e1f291cb7e024b6fd6ac2.png)

我已经大大简化了这一点，但是我对解决这个问题的最佳方法有疑问。

在随附的屏幕截图中，我要求只能有一个主要联系人。用户应该能够从列表视图（屏幕截图的左侧）或详细信息视图（屏幕截图的右侧）更改主要联系人。

换句话说，如果用户在列表视图中选中 Jane Doe，John Smith 旁边的复选框将被取消选中。在 Detail 视图中也会发生同样的情况，如果选中 Jane Doe 的复选框，则会取消选中 John Smith。

我将 Caliburn.Micro 用于我的 MVVM 框架，并附上了示例项目。

我试图让项目变得非常简单。我没有解决附件项目中的问题，我希望对如何解决它有不同的想法。

[WpfApplication1.zip](https://docs.google.com/open?id=0Bx_O1D_19kS-aWN1YWMtdWNDT2M)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T13:51:51.237

业务对象负责确定如果一个成为主要项目会发生什么其他项目，因此您需要某种管理`IsPrimary`标志的对象。

但是，您这样做（自定义容器类型、调解器等）您需要一些东西来调解更改

例如

```
public class Mediator
{
    IList<Contact> _contacts = null;

    public Mediator(IList<Contact> contacts) 
    {
        _contacts = contacts;

        foreach(var c in contacts) 
        {
            c.PropertyChanged += ContactPropertyChanged;
        }
    }

    private bool _isChanging = false;

    private void ContactPropertyChanged(object sender, PropertyChangedEventArgs e)
    {
        var current = sender as Contact;

        if(e.PropertyName == "IsPrimary" && !_isChanging && current.IsPrimary)
        {
            _isChanging = true;

            foreach(var c in _contacts.Where(x => x != current) 
            {
                c.IsPrimary = false;
            }

            _isChanging = false;
        }
    }
} 
```

可能有更好的方法，比如拥有一个容器集合（它自己挂钩 propertychanged 等......还要注意事件处理程序！）

您可以编写一个更通用的模板版本来触发重载（因此您可以轻松地创建子类以创建不同的中介等）

```
public class Mediator<T>
{
    IList<T> _items = null;

    public Mediator(IList<T> items, params string[] watchedProperties) { ... etc

    protected virtual OnWatchedPropertyChanged(T sender, string PropertyName) 
    {
    }
}

public ContactMediator : Mediator<Contact>
{
     public ContactMediator(IList<Contact> contacts, params string[] watchedProperties) { ...

     override OnWatchedPropertyChanged(Contact object, string propertyName) { ... etc
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:10:38.463

在我看来，有几个基本选项。我的方向是创建一个名为 Person 的 Model 对象，并拥有一个名为 IsPrimary 的布尔属性。我会让这个模型对象实现 INotifyPropertyChanged。在我的 ViewModel 对象中，我将有一个 Person 对象的 BindingList 集合对象。然后为复选框连接一些命令以触发 Person 对象中的更改，这应该可以做到。

# ruby - CarrierWave 更新模型？

> ID：14186058
> 
> 赞同：0
> 
> 时间：2013-01-06T19:51:39.623
> 
> 标签：ruby, activerecord, carrierwave

CarrierWave 在 ActiveRecord 上做得非常棒，可以在我上传图像时调整图像大小 - 但我希望能够在处理图像时在我的 ActiveRecord 模型中记录图像是横向还是纵向 - 这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:37:12.197

您可以将此方法添加到您的上传文件：

```
include CarrierWave::RMagick

def landscape? picture
  if @file
    img = ::Magick::Image::read(@file.file).first
    img.columns > img.rows
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:39:52.207

从[README](https://github.com/jnicklas/carrierwave#conditional-versions)中，您可以使用以下内容来确定图片的方向：

```
def landscape?(picture)
  image = MiniMagick::Image.open(picture.path)
  image[:width] > image[:height]
end 
```

你可以`before_save`在你的模型中使用它，就像在CarrierWave wiki 中的[这个例子](https://github.com/jnicklas/carrierwave/wiki/How-to%3A-Store-the-uploaded-file-size-and-content-type)中一样，我已经稍微调整了：

```
class Asset < ActiveRecord::Base
  mount_uploader :asset, AssetUploader

  before_save :update_asset_attributes

  private

  def update_asset_attributes
    if asset.present? && asset_changed?
      self.landscape = landscape?(asset)
    end
  end

  def landscape?(picture) # ... as above ...
end 
```

**更新**：要在上传器中执行此操作，我不确定最佳方法。一种选择可能是编写自定义处理方法：

```
class AssetUploader < CarrierWave::Uploader::Base
  include CarrierWave::MiniMagick

  process :resize => [200, 200]

  private

  def resize(width, height)
    resize_to_limit(width, height) do |image|
      model.landscape = image[:width] > image[:height]
      image
    end
  end
end 
```

它利用了 MiniMagick`yield`对图像进行进一步处理的事实，以避免再次加载图像。

# ios - 使用 UIAccessibilityAction:accessibilityPerformEscape

> ID：14186059
> 
> 赞同：3
> 
> 时间：2013-01-06T19:51:39.930
> 
> 标签：ios, accessibility, voiceover

苹果的这个协议的文档说accessibilityPerformEscape

“在可以模态或层次结构显示的元素或包含视图上实现此方法。当 VoiceOver 用户执行关闭操作时，此方法会关闭视图。例如，您可以为弹出框实现此方法，以便给出用户故意执行关闭弹出框的关闭操作。”

我找不到任何关于解雇行动的信息。有人有任何线索吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T19:56:07.663

没关系，刚刚在这里找到它：

[http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Accessibility/AccessibilityfromtheViewControllersPerspective.html](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/Accessibility/AccessibilityfromtheViewControllersPerspective.html)

它是一个两指 Z 形。

# applescript - 带有 Tunnelblick 的 Applescript 选择随机 VPN

> ID：14186068
> 
> 赞同：1
> 
> 时间：2013-01-06T19:52:37.120
> 
> 标签：applescript

我一直在尝试编写一个简单的applescript来获取可用VPN连接的列表并随机选择一个，这里是：

```
tell application "Tunnelblick"
    set the_values_list to get configurations
    set the list_count to the count of the_values_list --gets number of items in list
    set pick to random number from 1 to list_count --has it choose a random item
    set generated_choice to item pick of the_values_list --sets the generated item as the choice
    return generated_choice --displays the choice
end tell 
```

这将返回：

> 应用程序“Tunnelblick”的配置“USA.Indiana.SouthBend_LOC1S2.UDP”

但是，如果我尝试通过替换返回来连接：

```
connect generated_choice --displays the choice 
```

我收到一个错误：

> Tunnelblick 出现错误：密钥格式无效。

为什么会发生这种情况？似乎它传递的是数组（列表）而不是值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T03:39:26.640

以下工作

`connect (get name of (configuration pick))`

# javascript - javascript 创建一个具有严格文档类型的 iframe

> ID：14186070
> 
> 赞同：8
> 
> 时间：2013-01-06T19:52:53.933
> 
> 标签：javascript, iframe, doctype

我正在构建一个可以嵌入其他站点的小部件。该小部件是使用创建的 iframe，`document.write()`但我不知道如何使用 javascript 应用 iframe 文档类型。

这是我的代码：

```
document.write("<iframe scrolling=\"no\" frameborder=\"0\">");
document.write("<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"   \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">");
document.write("<html>");
document.write("<head></head><body></body>");
document.write("</html>");
document.write("</iframe>");
document.write("</div>"); 
```

iframe 已创建，但我未应用 doctype。有没有办法做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-12T01:10:16.907

为了写入`iframe`，您首先需要创建它，将其附加到文档中，然后进入它的内部以获取其`contentDocument`.

这是一些示例代码：

```
// create the iframe and attach it to the document
var iframe = document.createElement("iframe");
iframe.setAttribute("scrolling", "no");
iframe.setAttribute("frameborder", "0");
document.body.appendChild(iframe);

// find the iframe's document and write some content
var idocument = iframe.contentDocument;
idocument.open();
idocument.write("<!DOCTYPE html>");
idocument.write("<html>");
idocument.write("<head></head>");
idocument.write("<body>this is the iframe</body>");
idocument.write("</html>");
idocument.close();

// now have a look at your creation in the console
console.log(idocument); 
```

看到它在这个[jsfiddle](http://jsfiddle.net/XuXtp/15/)中工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-19T10:54:04.460

您还可以使用 HTML5`srcdoc`属性来指定 iframe 的内容。

```
document.getElementById('myFrame').srcdoc = "<!DOCTYPE html PUBLIC...."; 
```

您必须检查`srcdoc`您的浏览器是否支持。

# android - 地图上有 75 个标记 -> 内存泄漏 -> OutOfMemoryException

> ID：14186072
> 
> 赞同：12
> 
> 时间：2013-01-06T19:53:06.443
> 
> 标签：android, maps, out-of-memory, google-maps-android-api-2

我在 Google 地图上绘制大约 80 个标记时遇到问题。我正在使用 Google Maps Android API v2。

标记的图标是动态的（随时间变化）。向地图添加标记后，无法更改图标。因此，我必须删除所有标记并再次添加所有标记。

```
mMap.clear();
for (int i = 0; i < teams.length(); i++) {
    team = teams.get(i);
    point = new LatLng(tema.getLatitude(), team.getLongitude());

    MarkerOptions marker = new MarkerOptions().position(point).title(name).icon(BitmapDescriptorFactory.fromResource(team.getMarkerId())));
        mMap.addMarker(marker);
} 
```

多次执行此代码（每分钟刷新一次）后，我得到了 OutOfMemoryExpcetion。

当使用较大的标记图标时，OutOfMemoryException 抛出得更快，所以我认为内存问题与未正确回收的图标位图有关。

我还发现，当将设备的旋转从横向更改为纵向并返回时，会增加使用的堆内存。GC 后内存不会被释放。

有人知道我是否错误地添加了标记，还是我在 Map API 实现中遇到了问题？

我尝试使用 Google Map 示例应用程序重现该错误。在`android-sdk/extras/google/google_play_services/samples/maps/src/com/example/mapdemo/MarkerDemoActivity.java`标记演示中可以找到。加快测试我增加了创建的标记数量。

```
int numMarkersInRainbow = 12; 
```

改成

```
int numMarkersInRainbow = 100; 
```

现在启动演示应用程序，选择标记演示并将设备的旋转从纵向切换到横向并返回几次。

初始堆：

```
Heap size   Allocated  Free      %Used    #Objects
11,543 BM   9,898 MB   1,645 MB  85,75%   65.982 
```

一些方向更改后的堆：

```
Heap size   Allocated  Free      %Used    #Objects
15,652 MB   11,337 MB  4,316 MB  72,43%   76.984 
```

经过几次方向更改后的堆：

```
Heap size   Allocated  Free      %Used    #Objects
21,312 MB   16,411 MB  4,901 MB  77,00%   111.350 
```

最终结果将是 OutOfMemoryExcpetion。

堆转储显示一些可能的堆泄漏：[https ://www.box.com/s/rsy0k22dcp267se2g1fy](https://www.box.com/s/rsy0k22dcp267se2g1fy)

完整的堆转储：[https ://www.box.com/s/6lyv2p6rlc0njqxw5zgu](https://www.box.com/s/6lyv2p6rlc0njqxw5zgu)

更新：这似乎与 Android Maps V2 中的内存泄漏问题有关。请参阅[https://code.google.com/p/gmaps-api-issues/issues/detail?id=4766](https://code.google.com/p/gmaps-api-issues/issues/detail?id=4766) 根据问题应该修复但我自己没有测试过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T23:36:56.040

是的，您正面临一个困扰许多 Android 开发人员的非常经典且常见的问题……来势汹汹的 OOM。当您没有在更新或旋转时完全清理旧的可绘制对象时，就会出现此问题。要解决这个问题，你真的应该在 mMap.clear 之前遍历你的标记并将它们设置为 null，并可能通过调用 System.gc() 请求（你不能强制它）垃圾收集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T21:51:41.300

这是您可能会采取的一种方法来解决可能的 API 问题...检测设备旋转并通过将 MarketOptions 对象设置为 null 来删除它...然后用您的标记重新填充它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-26T11:58:18.070

每当我的应用程序出现内存泄漏问题时，我都会经历以下场景

1.  加载应用程序
2.  执行疑似泄漏内存的操作（最好多执行一次，这样以后更容易分析）
3.  完成应用程序（按返回直到返回主屏幕）
4.  分析内存转储

我用于分析的步骤是

1.  打开直方图
2.  搜索我的包名
3.  检查是否有任何不应该的引用

如果存在泄漏并且您多次重复泄漏操作，您将看到片段、活动、视图等的多个实例。为了识别泄漏罪魁祸首：

1.  右键单击泄漏的对象-> 列出对象-> 带有传入引用
2.  选择传入的引用之一，右键单击-> GC 根路径-> 排除 WeakReferences
3.  打开堆栈级别，直到您确定一个引用。如果唯一的路径通向终结器，那么你挖得太深了。如果不确定，请尝试另一个泄漏的对象，重复步骤。

抱歉，这不是一门精确的科学，但它会导致提示，使您能够更轻松地识别泄漏代码。

# python - 从超类实例化子类

> ID：14186073
> 
> 赞同：2
> 
> 时间：2013-01-06T19:53:09.947
> 
> 标签：python

我需要从超类实例化一个子类。

```
class Superclass(object):
    @staticmethod
    def get_instance():
        #This should return an instance of subclass1 or subclass2

class Subclass1(Superclass):
    pass
class Subclass2(Superclass):
    pass 
```

我想写：

```
Subclass1.get_instance() 
```

并获得 Subclass1 的实例，对于 Subclass2 也是如此

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-06T20:04:52.307

使用`@classmethod`而不是`@staticmethod`：

```
class Superclass(object):
    @classmethod
    def get_instance(cls):
        #This should return an instance of subclass1 or subclass2
        return cls()

class Subclass1(Superclass):
    pass
class Subclass2(Superclass):
    pass 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:00:08.960

如果要访问给定类的子类列表，可以使用以下`__subclasses__`方法：

```
>>> class MyClass(object):
...     pass
... 
>>> class Subclass1(MyClass):
...     pass
... 
>>> class Subclass2(MyClass):
...     pass
... 
>>> MyClass.__subclasses__()
[<class '__main__.Subclass1'>, <class '__main__.Subclass2'>] 
```

如果您已经知道现有的子类，您可以简单地直接实例化它们：

```
>>> class MyClass(object):
...     def getInstance(self):
...             return Subclass1()
... 
>>> class Subclass1(MyClass): pass
... 
>>> MyClass().getInstance()
<__main__.Subclass1 object at 0x1e72d10> 
```

无论如何，我*猜*您正在尝试实现单例模式，在这种情况下，我认为您根本不应该使用`getInstance`方法。只需使用以下方法实现它：

*   一个模块，因为模块是单例
*   如果实例已存在，则重新实现`__new__`以返回旧实例
*   使用一些元类

还有很多方法可以做到这一点。

如果这不是您的目标，那么也许您应该更改设计，因为超类通常不必了解子类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:00:28.173

如果您不能只调用`selfclass()`类方法，那么正确的方法是定义（或假设）一个工厂方法，并让您的超类方法调用该工厂方法`self`：

```
class Mixinator(object):

      @classmethod # this is not really necessary, but it means you don't need an instance to start with
      def factoryuser(selfclass, *args):
          return selfclass.factory(*args)

      #only define factory if you want Mixinator to be usable on its own
      @classmethod
      def factory(selfclass, *args):
          return selfclass(*args)  # this is a stub. 
```

显然，子类应该需要更多地参与其中`factory`才能使这变得有价值。我不确定是否有任何用例无法通过替换`factory`为适当的来解决`__new__`，但这更明确。

# php - 两步认证

> ID：14186087
> 
> 赞同：1
> 
> 时间：2013-01-06T19:54:21.097
> 
> 标签：php, symfony-2.1, two-factor-authentication

我正在尝试在我正在编写的 Symfony2 应用程序中实现一个两因素身份验证方案。基本上，系统目前工作正常，以 Doctrine ORM Entity 作为用户提供者。但是，我在弄清楚如何正确和最有效地添加它时遇到了问题。

基本上，身份验证应该这样工作。用户看到登录表单。键入用户/密码组合，然后输入 OTP（在本例中为 yubikey。）

标准的 symfony2 身份验证可以很好地处理用户/密码。但是，我想添加添加 OTP 支持的选项（前提是用户有 yubikey 的数据库条目，并且它在站点范围内启用。）

有没有人对这种模式有任何运气？我想避免重新发明轮子，只需要弄清楚如何将其与当前的身份验证模式联系起来。

最初，我曾考虑在我正在使用的自定义密码编码器 (bcrypt) 中使用 isPasswordValid() 函数。但是，似乎没有办法将 otp 传递给该函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:21:29.070

您需要编写一个包含 OTP 相关逻辑的自定义身份验证提供程序（我假设您使用的是基于默认实体的提供程序）。我不会在这里复制和粘贴 Symfony 的示例，但他们的[文档](http://symfony.com/doc/current/cookbook/security/custom_authentication_provider.html)中有一个供参考。

# xml - 基于文本字段加载 XML 路径

> ID：14186088
> 
> 赞同：0
> 
> 时间：2013-01-06T19:54:27.077
> 
> 标签：xml, apache-flex, httpservice

我正在使用 HTTPService 加载我的 XML 文件。我正在尝试根据用户在文本字段中键入的内容加载特定数据。我正在尝试像这样加载：

```
xmlservice.send();
var string:String = {xmlservice.lastresult.TEXTFIELD.TEXT.code}; 
```

有没有办法做到以上几点？当我这样做时，我收到此错误：此行有多个标记：-xmlservice -1084：语法错误：在点之前需要冒号。-1084: 语法错误：在右括号之前需要标识符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T04:32:09.810

我想你想要这样的东西：

var string:String = xmlservice.lastresult[TEXTFIELD.TEXT].code;

# eclipse - Eclipse：关闭 Java 编辑器缩进功能

> ID：14186089
> 
> 赞同：0
> 
> 时间：2013-01-06T19:54:27.207
> 
> 标签：eclipse

![在此处输入图像描述](../Images/590ac7008f1235f8afa4cc0219a2b914.png)

我似乎在 Eclipse Java 编辑器中错误地打开了某个功能。

好像和缩进有关，但是我不知道这个特性的名字，所以不能关闭它！

请参阅随附的屏幕截图，其中的点表示缩进和每个换行符的图标。

此功能的名称是什么，以便我可以将其关闭？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:07:48.057

带有段落符号“显示空白字符”的图标（用于行尾的图标）打开和关闭此功能。

# java - 如何配置 Eclipse 以使用 Oracle javac 1.7.0_09 进行编译？

> ID：14186091
> 
> 赞同：7
> 
> 时间：2013-01-06T19:54:32.017
> 
> 标签：java, eclipse, javac

我正在尝试编译以下代码：

```
public class DuplicateMainExample {
    public static void main(String[] args) {
        System.out.print("A1");
    }

    public static void main(String... args) {
        System.out.print("A2");
    }   
} 
```

在 Eclipse 中它工作正常，但在这两种方法上都有警告 - “ *Duplicate MainExample 类型中的重复方法 main(String[])* ”

使用`javac`（java版本“1.7.0_09”）我有一个编译错误：

```
>javac DuplicateMainExample.java
DuplicateMainExample.java:8: error: cannot declare both main(String...) and main
(String[]) in DuplicateMainExample
        public static void main(String... args) {
                           ^
1 error 
```

如何在 Eclipse 中使用 编译`javac`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-06T19:56:37.687

仅仅因为您已经两次声明了具有完全相同签名的相同方法...只应声明一个类的主要方法。

Eclipse 已经嵌入了自己的编译器，在两种主要方法的情况下，它得到了最后一种，eclipse 编译器和 javac 编译器是两个不同的编译器......

看看[这个较旧的帖子](https://stackoverflow.com/questions/3061654/what-is-the-difference-between-javac-and-the-eclipse-compiler)以获取更多信息......

如果你想用 javac 编译，你可以尝试[在 eclipse 中使用 ant javac 适配器](http://help.eclipse.org/juno/index.jsp?topic=/org.eclipse.jdt.doc.user/tasks/task-ant_javac_adapter.htm)......但是我认为 ECJ 甚至比 javac 更好（我的观点）......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T20:16:28.100

Eclipse 永远不会*使用*javac。它的动态高亮能力与它自己的编译器密切相关，它具有增量操作的特殊能力。

如果你想要一个使用 javac 的 IDE，你可以研究一下 intellij。

# ember.js - 如何使用 Ember.js 的新路由器以编程方式在路由之间转换

> ID：14186092
> 
> 赞同：10
> 
> 时间：2013-01-06T19:54:34.063
> 
> 标签：ember.js, ember-router

## 问题：

您如何使用新的 Ember.js 路由器以编程方式转换到新路由？

## 背景/上下文

使用旧的 Ember.js 路由器，您可以使用路由器的方法以编程方式在路由/状态之间转换`send`：

```
//OLD Router Syntax
App = Ember.Application.create({
  Router: Ember.Router.extend({
    root: Ember.Route.extend({
      aRoute: Ember.Route.extend({
        route: '/',
        moveElsewhere: Ember.Route.transitionTo('bRoute')
      }),
      bRoute: Ember.Route.extend({
        route: '/someOtherLocation'
      })
    })
  })
});
App.initialize(); 
```

程序化过渡：

```
App.get('router').send('moveElsewhere'); 
```

给定新的 Ember.js 路由器（如下），我们如何完成同样的事情？

```
//NEW Router Syntax
App.Router.map(function(match) {
  match('/').to('aRoute');
  match('/someOtherLocation').to('bRoute');
}); 
```

## 解决方法（糟糕的解决方案？）

这不可能，对吧？

```
window.location = window.location.href + "#/someOtherLocation"; 
```

## 似乎不适用于新路由器的解决方案：

**1）**在实例上调用`send`方法`App.router`

```
> App.router.send("moveElseWhere")
TypeError: Cannot call method 'send' of undefined 
```

**2）**显式声明Route并设置事件

```
App.ARoute = Ember.Route.extend({
  events: {
    moveElseWhere: function(context){
       this.transitionTo('bRoute');
    }
  }
);

App.UploadRoute.moveElseWhere()
TypeError: Object (subclass of Ember.Route) has no method 'moveElseWhere' 
```

* * *

*注意：在编写[Ember.js 路由器文档](http://emberjs.com/api/classes/Ember.Router.html)时仍然指的是旧路由器，而[Ember.js 路由器指南](http://emberjs.com/guides/routing/defining-your-routes/)指的是新路由器*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-06T08:43:36.180

假设这个路由器定义：

```
App.Router.map ->
  this.resource('old_route', {path : ""})
  this.resource('new_route', {path : ":model_id"}) 
```

当您将控制器作为上下文时，您可以移至`new_route`with函数。`old_route.transitionToRoute()`

### 从控制器

```
this.get('target').transitionToRoute('new_route', model_instance) 
```

`this.get('target')`- 从控制器返回当前路由

### 从一个视图

```
this.get('controller').get('target').transitionToRoute('activity_detail', activity) 
```

### 笔记

函数 *transitionTo()在 1.0.0.RC3中已被[弃用](https://github.com/emberjs/ember.js/pull/2504/files)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T08:36:08.757

您可以使用`transitionTo`新的路由器 API，但您必须以不同的方式访问路由器实例。

有关可能性，请参阅问题[Access instance of new Ember Router的答案。](https://stackoverflow.com/questions/14166995/access-instance-of-new-ember-router)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T02:21:42.160

you trigger a link to a new route with the {{linkTo}} helper:

```
#your template

{{#linkTo allTodos activeClass="selected"}}All{{/linkTo}}

#your router

    App.Router.map(function (match) {
        match("/").to("todos", function (match) {
            match("/").to("allTodos"); // will fire this router
            match("/active").to("activeTodos");
            match("/completed").to("completedTodos");
        });
    }); 
```

Hope this helps :)

# java - 自定义按钮字体的这行代码放在哪里？

> ID：14186102
> 
> 赞同：-1
> 
> 时间：2013-01-06T19:56:02.437
> 
> 标签：java, android, xml, button, fonts

我应该把这段代码放在哪里

```
 Button txt = (Button) findViewById(R.id.button1);  
    Typeface font = Typeface.createFromAsset(getAssets(), "customfont.ttf");  
    txt.setTypeface(font); 
```

所以我可以更改按钮上显示的文本的字体？我只想更改按钮上的字体。我不想更改警报对话框中的字体。我只是不知道将代码放在哪里来更改按钮字体。我已经将自定义字体放置在 assets 中的“fonts”文件夹中。

这是按钮的xml部分：

```
<Button
    android:id="@+id/button1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:onClick="alertBtn"
    android:text="Click for message" 
    android:textSize="22sp"
    /> 
```

这是我的项目的代码：

```
package com.test.hellothere;

import android.app.Activity;
import android.app.AlertDialog;
import android.graphics.Typeface;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class HelloThereActivity extends Activity implements View.OnClickListener{
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

    }

    public void onClick(View v){}

    public void alertBtn(View v){

        new AlertDialog.Builder(this)
        .setTitle("Hello")
        .setMessage("Hello There!")
        .setNeutralButton("Go Back", null)
        .show();
    }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T19:58:33.413

将您的代码放在`onCreate`Activity 中，`setContentView`如下所示：

```
public class HelloThereActivity extends Activity implements View.OnClickListener{
    /** Called when the activity is first created. */
 Button txt;
 Typeface font;
  @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
       txt = (Button) findViewById(R.id.button1);  

       // call here for setting font 
       setfonttoView(txt);

       //.....same for other buttons
    }
  public void setfonttoView(Button button){
       font = Typeface.createFromAsset(getAssets(), "customfont.ttf");  
       button.setTypeface(font);
    }

  //your code here... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T19:58:41.087

```
Button txt = (Button) findViewById(R.id.button1);  
Typeface font = Typeface.createFromAsset(getAssets(), "customfont.ttf");  
txt.setTypeface(font); 
```

之内`onCreate()`

# android - YouTube Android Player API 的配额限制

> ID：14186104
> 
> 赞同：9
> 
> 时间：2013-01-06T19:56:05.697
> 
> 标签：android, youtube-api

我想在新的 Android 应用中使用[YouTube Android Player API 。](https://developers.google.com/youtube/android/player/)你能解释一下这个 API 的免费使用限制吗？我感兴趣的是在达到免费 API 限制之前每天可以播放多少个视频。

我已经做了一些背景研究，以下是我所知道的：

1.  Android Player API 使用 YouTube 应用程序和 YouTube Data APIs v3 来播放视频。
2.  程序员必须提供跟踪使用情况的 Data API v3 密钥。
3.  每个应用程序每天对 Data APIs v3 的访问限制为 500 万个单位。
4.  通过 Data API v3 进行的不同操作[在单位方面具有不同的成本](https://developers.google.com/youtube/v3/getting-started#quota)。

据我所知，YouTube 应用可以控制向 Data API 发出请求。当我没有源代码时，如何计算 YouTube 应用代表我使用的读取/写入/更新等？我怎样才能将这些操作转化为单位，然后转化为实际的视频？视频是我关心的，也是我可以通过 Android Player API 实际控制的。

让我们以 Justin Beiber 的 Baby 视频为例。它长 3 分 45 秒，它的 id 是 kffacxfA7G4 ，完整的 URL 是[http://www.youtube.com/watch?v=kffacxfA7G4](http://www.youtube.com/watch?v=kffacxfA7G4)。如果我将 id 提供给 Android Player API 作为起点，播放该视频需要什么单位？每天可以通过 API 播放多少个不同的此类视频？

编辑：这个问题主要针对 YouTube API 团队 @ Google（如[https://stackoverflow.com/users/385997/jeff-posnick](https://stackoverflow.com/users/385997/jeff-posnick)）中的人员，他们使用`youtube-api`StackOverflow 上的标签获取技术支持。有关详细信息，请参阅此博客文章：[https ://youtube-eng.googleblog.com/2012/09/the-youtube-api-on-stack-overflow_14.html](https://youtube-eng.googleblog.com/2012/09/the-youtube-api-on-stack-overflow_14.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:19:02.500

> 使用和配额。YouTube 可以自行决定对您的 YouTube API 使用设置操作配额。您不得试图规避自动使用配额限制。

来自：[https ://developers.google.com/youtube/terms](https://developers.google.com/youtube/terms)

这意味着你根本不知道配额是什么，是否有配额，基本上这是一个单方面的选择，你的应用程序是生是死。

我还应该提醒一个事实，商业解决方案可能会破坏这种许可，或者它们根本不是一个好的解决方案，因为您将在您无权控制产品的情况下提供产品。

我还强烈建议阅读**API 使用**和**禁止**部分。

# c++ - 崩溃删除 [ ] 初始化的 char 字符串

> ID：14186107
> 
> 赞同：0
> 
> 时间：2013-01-06T19:56:25.980
> 
> 标签：c++, string, initialization

在修复了来自未初始化指针的错误之后。一个旧的错误仍然存​​在，`stringclass::alloc()`如果我删除 mystring 尽管我们可以在之前处理或显示它，它会崩溃。它已经初始化了，那么这次发生了什么？

```
void stringclass::alloc(long newsize)
{     
   if(memsize < newsize)
   {
       cout << "checkpoint 1\n";
       if(mystring) delete [] mystring;
       cout << "checkpoint 2\n";
       memsize = newsize;
       mystring = new char[memsize];
       mystring[0] = 0;
       length = 0;
    }
} 
```

**完整代码：**

```
#include <iostream>
using namespace std;

#define DEFAULT_BREAKPOINT -1
#define DEFAULT_STARTPOINT -1

class stringclass
{
   protected :

      inline bool success()   { failbit = false;  return true; }
      inline bool fail()      { failbit = true; return false; }

   public :

      bool failbit;

      long memsize;
      long length;
      char * mystring;

      bool ins(const char * str, long startpoint, long breakpoint);

      inline long get_length()       { if(mystring) length = strlen(mystring); return length;}
      inline long get_memsize() const { return memsize; }

      void reset();
      void alloc(long newsize);

      void copy(const stringclass & other);
      stringclass();
      stringclass(const char str[]);
      stringclass(const stringclass & other);
      ~stringclass();

      friend ostream& operator << (ostream& out, stringclass & sc){out << sc.mystring; return out;}

};

void stringclass::copy(const stringclass & other)
{
   if(other.mystring == NULL)
   {
      reset();
      return;
   }

   alloc(other.memsize);
   strcpy(mystring, other.mystring);
   length = other.length;
}

stringclass::stringclass()
   : mystring(NULL), memsize(0), length(0)
{
}

stringclass::stringclass(const char str[])
   : mystring(NULL), memsize(0), length(0)
{
   if(str != NULL)
   {
      alloc(strlen(str) + 1);
      strcpy(mystring, str);
      length = strlen(mystring);
   }
}

stringclass::stringclass(const stringclass & other) 
   : mystring(NULL), memsize(0), length(0)
{
   copy(other);
}

stringclass::~stringclass()
{
   delete [] mystring;
}

void stringclass::reset()
{
   if(mystring) delete [] mystring;
   mystring = NULL;
   length = 0;
   memsize = 0;
}

void stringclass::alloc(long newsize)
{     
   if(memsize < newsize)
   {
       cout << "checkpoint 1\n";
       if(mystring) delete [] mystring;
       cout << "checkpoint 2\n";
       memsize = newsize;
       mystring = new char[memsize];
       mystring[0] = 0;
       length = 0;
    }
}

bool stringclass::ins(const char * str, long startpoint = DEFAULT_STARTPOINT, long breakpoint = DEFAULT_BREAKPOINT)
{
   if(startpoint == DEFAULT_STARTPOINT) startpoint = 0;
   if(breakpoint == DEFAULT_BREAKPOINT) breakpoint = startpoint;

   if(breakpoint > length || breakpoint - startpoint < 0) return fail();
   if(str == NULL) return fail();

   long str_length = strlen(str);
   long temp_size = 0;
   bool to_resize = false;

   if(length + str_length + 1 - (breakpoint - startpoint) > memsize)
   {
      temp_size = (length + str_length + 1 - (breakpoint - startpoint));
      to_resize = true;
   }
   else temp_size = memsize;

   char * temp = new char[temp_size];

   long temp_i = 0;

   if(mystring) for(; temp_i < startpoint; temp_i++) temp[temp_i] = mystring[temp_i];
   for(long str_i = 0; str_i < str_length; str_i++, temp_i++) temp[temp_i] = str[str_i];
   if(mystring) for(long buf_i = breakpoint; buf_i < memsize; buf_i++, temp_i++)temp[temp_i] = mystring[buf_i];

   temp[temp_i] = 0;

   if(to_resize) alloc(temp_size); //empty

   for(long buf_i = 0; buf_i < memsize; buf_i++) mystring[buf_i] = temp[buf_i];

   if(temp) delete [] temp;
   length = strlen(mystring);

   return success();
}

int main()
{

      stringclass str = "Hello";

      str.ins("rld", str.get_length());
      cout << str << endl;

      str.ins(" the wo", 5);
      cout << str << endl;

      system("PAUSE");
      return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:01:35.553

你溢出了一个缓冲区。

这个

```
char * temp = new char[temp_size]; 
```

应该

```
char * temp = new char[temp_size+1]; 
```

此外，您的班级没有赋值运算符，因此分配它会进行浅拷贝并导致双重删除。

# xml - XML - XSL 样式表问题

> ID：14186108
> 
> 赞同：-3
> 
> 时间：2013-01-06T19:56:28.637
> 
> 标签：xml, xslt

```
 <?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="vehicles.xsl"?>

<!-- File Name : vehicles.xml -->

<data>
    <params>
        <returned_page>1</returned_page>
        <total_pages>6</total_pages>
        <items_count>56</items_count>
        <previous_page></previous_page>
        <next_page>2</next_page>
    </params>
    <grid>
        <row>
            <car_id>1</car_id>
            <car_name>Audi A1</car_name>
            <car_price_per_day>75.33</car_price_per_day >
            <car_availability>1</car_availability>
        </row>
        <row>
            <car_id>2</car_id>
            <car_name>IQ 30</car_name>
            <car_price_per_day>45.99</car_price_per_day >
            <car_availability>1</car_availability>
        </row>
        <row>
            <car_id>3</car_id>
            <car_name>BMW 320</car_name>
            <car_price_per_day>86.44</car_price_per_day >
            <car_availability>0</car_availability>
        </row>
        <row>
            <car_id>4</car_id>
            <car_name>Ford Fiesta</car_name>
            <car_price_per_day >54.68</car_price_per_day>
            <car_availability>0</car_availability>
        </row>
        <row>
            <car_id>5</car_id>
            <car_name>Volkswagen Scirocco</car_name>
            <car_price_per_day >65.99</car_price_per_day >
            <car_available >0</car_available >
        </row>
    </grid>
</data>

 <?xml version="1.0" encoding="UTF-8"?>
<xsl:transform version="1.0"
xmlns:xsl="htp://www.w3.org/1999/XSL/Transform">

<!-- File Name : vehicles.xsl -->

<xsl:template match="/">
    <html>
        <body>
            <h2>CARS</h2>
            <table border="1">
                <tr bgcolor="#9acd32">
                    <th>ID</th>
                    <th>Name</th>
                    <th>Price/Day</th>
                    <th>Availability</th>
                </tr>
            <xsl:for-each select="row">
                <tr>
                    <td>
                        <xsl:value-of select="car_id"/>
                    </td>
                    <td>
                        <xsl:value-of select="car_name"/>
                    </td>
                    <td>
                        <xsl:value-of select="car_price_per_day"/>
                    </td>
                    <td>
                        <xsl:value-of select="car_availability"/>
                    </td>
                </tr>
            </xsl:for-each>
            </table>
        </body>
    </html>
</xsl:template>
</xsl:stylesheet> 
```

我的探索者都没有打开样式表..找不到它有什么问题我尝试了另一种编码，“选择值”命令的完整路径，“数据”和“行”作为模板匹配但输出相同。我试过 ie，mozila firefox 和 google chrome chrome 给了我一个空白页，即 xml 文件在单行和 firefox “加载样式表时出错：解析 XSLT 样式表失败。” 有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:05:11.127

您的 xslt 以

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:transform version="1.0"
xmlns:xsl="htp://www.w3.org/1999/XSL/Transform"> 
```

并以

```
</xsl:stylesheet> 
```

与开始标签不匹配。

开始标记在转换 URI 中也有错字。

如果您将开始更改为

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"> 
```

运行样式表不再出错。

但是，经过这么多的修复，它仍然无法正常工作，因为该行

```
 <xsl:for-each select="row"> 
```

找不到行。这是因为“行”标签不在根目录下。

将此更改为

```
 <xsl:for-each select="data/grid/row"> 
```

使您的转换至少对显示的数据有效。

可能还有其他改进需要进行，但这应该可以让您进行功能转换。

具有这些变化的整个变换是

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

<!-- File Name : vehicles.xsl -->

<xsl:template match="/">
    <html>
        <body>
            <h2>CARS</h2>
            <table border="1">
                <tr bgcolor="#9acd32">
                    <th>ID</th>
                    <th>Name</th>
                    <th>Price/Day</th>
                    <th>Availability</th>
                </tr>
            <xsl:for-each select="data/grid/row">
                <tr>
                    <td>
                        <xsl:value-of select="car_id"/>
                    </td>
                    <td>
                        <xsl:value-of select="car_name"/>
                    </td>
                    <td>
                        <xsl:value-of select="car_price_per_day"/>
                    </td>
                    <td>
                        <xsl:value-of select="car_availability"/>
                    </td>
                </tr>
            </xsl:for-each>
            </table>
        </body>
    </html>
</xsl:template>
</xsl:stylesheet> 
```

使用 xsltproc 对其进行测试会产生合理的输出，对我来说，它在 Firefox 17.0.1 中看起来也不错。

# php - 传递 CSS 属性以将其保存到 MySQL 数据库中的方法是什么？

> ID：14186111
> 
> 赞同：0
> 
> 时间：2013-01-06T19:56:41.773
> 
> 标签：php, javascript, xml-parsing, session-variables

我正在创建一个小型 Web 应用程序，它可以让用户通过 Javascript 调整 div 元素的大小和位置。然后，当用户点击“提交更改”按钮时，我想通过 PHP 将这些 div 元素（主要是宽度、顶部、左侧）的新 CSS 属性保存到 MySQL 数据库中。您认为实现这一目标的“最佳”方法是什么？

我已经用谷歌搜索了一段时间，我发现隐藏的输入元素可以保存这些值并通过 POST 方法传递它们。我还发现使用 $_SESSION 变量也可以，尽管我不确定如何获取 Javascript 产生的这些值并将它们传递给 PHP。我自己想知道是否可以通过 Javascript 创建 XML 文件，然后让 PHP 处理它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T19:59:47.867

为什么要为此使用 XML？这就像用大锤敲打一些地毯钉子一样。

我会为此使用 JSON - 创建一个存储有关 CSS 规则的信息的 JSON 对象，然后使用您想要的任何技术（表单、Ajax 等）将其上传到服务器，并将其作为文本类型存储在数据库中。

# c# - 用 C++ 实现接口？

> ID：14186114
> 
> 赞同：0
> 
> 时间：2013-01-06T19:56:58.210
> 
> 标签：c#, c++, inheritance, interface, polymorphism

我想实现我在 C++ 项目的引擎 (Unity3D) 中看到的行为。

以下代码采用 C#（Unity 语言）：

```
using UnityEngine;
using System.Collections;

public class example : MonoBehaviour {

    void Update() {
        //Update is called every frame
    }
} 
```

由于我无法访问 MonoBehavior 源，我只能猜测 Update() 是一个可以像这样实现的虚函数。

我想在 C++ 中复制相同的行为。有一个循环，`main()`一个超级对象将`Update()`在该循环中调用它的方法，它的所有子对象都应该继承这个超级对象并有可能实现`Update()`和使用它。

我知道这是一个模棱两可的问题，但我到处寻找答案，但没有找到。

这是一个例子：

```
class Base
{
 public:
     virtual void Update();
};

class Object: public Base
{
 public:
     void Update();
};

void main()
{
     Base* base;
     while(1)
     {
        base->Update();
     }
} 
```

结果应该是应该通过Base调用Object的Update()。我是 100% 上面的代码不起作用，这就是为什么我需要一些想法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T20:05:51.397

C++ 没有接口。您使用纯虚方法创建一个抽象类。

```
class MonoBehaviour 
{
    virtual void Update() = 0;
};

class your_class : MonoBehaviour 
{
    void Update() 
    { 
        // implement here. 
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T23:32:12.270

可能存在子类方法和基类方法的签名不相同，即它们具有相同的名称但返回不同的东西或具有不同的参数。这是始终调用基类方法的一种方法。

或者您可能只是在主函数中构造基类对象而不是子类对象。在 main 函数中放置一个中断来检查您正在为其调用 Update 的对象的实际类型。

您发布的代码应该可以正常工作。基类是否是抽象的并不重要。我更喜欢使其具体化并在应该为 = 0 的方法中抛出异常，以便在实现子类时方便（我不必从一开始就实现完整的行为，只需要我关注的方法和我正在测试它；所以它是递增的）。

是的，坚持公共继承。

编辑：或者如果你有这样的事情，可能会涉及到对象切片：

```
Derived* d_ptr = new Derived();
Base b = *d_ptr; // object slicing, d's methods will become Base methods;
Base* b_ptr = &b;
b_ptr->Update(); // will call Base::Update() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-27T13:12:07.240

第一件事。您提供的示例首先不起作用，因为您忘记了指针的实例化。你的意思可能是这样的：

```
 Base* base = new Object;
 while(1)
 {
    base->Update();
 } 
```

现在解决这个问题。这个概念应该如您所愿。如果如其他人已经指出的那样，Update 覆盖了 base 中的虚函数，则应在 Object 类中调用 Update。有一个整洁的东西`c++11`被调用`override`。它是您在函数声明之后放置的关键字，您希望覆盖基中的某些虚函数。`override`如果您尝试`override`使用非虚拟函数，编译器会抱怨这是一个很好的做法。这减少了代码中出错的可能性。

# android - 尝试使用数字选择器更新 TextView

> ID：14186118
> 
> 赞同：0
> 
> 时间：2013-01-06T19:57:34.833
> 
> 标签：android, textview, settext, numberpicker

当用户更改数字选择器小部件内的值时，我正在尝试更新 TextView 中显示的值。

我设置了号码选择器并正常工作，但是当我尝试调用 TextView 的 .setText() 方法时，出现以下错误：

**com.example.waitron5.MenuItemArrayAdapter.onValueChange 处的 java.lang.NullPointerException（MenuItemArrayAdapter.java:68）**

下面是与 MenuItemArrayAdapter 类中似乎发生错误的位置相对应的代码：

```
@Override
public void onValueChange(NumberPicker picker, int oldVal, int newVal) {
    Toast.makeText(this.getContext(), "Change: " + picker.getValue(), Toast.LENGTH_SHORT).show();
    //if oldVal > newVal increment price
    price.setText("xyz");
    //if oldVal < newVal decrement price
} 
```

放入 Toast 消息以测试侦听器是否正常工作，并且确实如此。然后我添加了 setText() 方法，但这导致了错误。

对此问题的任何帮助将不胜感激！我在 MenuItemArrayAdapter 类的顶部声明了 TextView：

```
private TextView price; 
```

注意：数字选择器包含在列表的每个视图中。这就是我有 MenuItemAdapter 类的原因。问题是否与尝试从错误位置更新 textView 相关联？

下面是 MenuItemAdapter 类的 getView() 方法。

```
public View getView(final int position, View convertView, ViewGroup parent){
    View v = convertView;

    if(v == null){
        LayoutInflater vi = (LayoutInflater) getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(R.layout.menuitem_row, null);
    }

    //assign values to view
    MenuItem item = this.menuItems.get(position);

    TextView nameView = (TextView) v.findViewById(R.id.item_name);
    TextView priceView = (TextView) v.findViewById(R.id.item_price);

    nameView.setText(item.getName() + " ");
    priceView.setText("€"+ String.valueOf(item.getPrice()));

    price = (TextView)v.findViewById(R.id.price);

    //number picker
    np = (NumberPicker)v.findViewById(R.id.numpick);
    np.setMaxValue(99);
    np.setMinValue(0);
    np.setValue(0);

    np.setOnValueChangedListener(this);

    return v;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:22:15.483

TextView`price`在 的每一行中是否可用`ListView`？
我想答案是否定的，就像屏幕上只有一个 TextView 应该显示总价一样。

如果我的假设是正确的，那么您就不应该实例`price`化`getView()`

```
price = (TextView)v.findViewById(R.id.price); 
```

因为`price`将在`R.layout.menuitem_row`布局中搜索。如果 TextView 不存在，当您尝试使用时会抛出 NullPointer。

解决方案是在声明主布局的 onCreate() 中实例化`price`，然后将其作为参数传递给`MenuItemArrayAdapter`.

像这样的东西：

```
// ....
TextView price = (TextView)findViewById(R.id.price);
adapter = new MenuItemArrayAdapter(this, price); 
this.setAdapter(adapter)
//.... 
```

然后修改构造函数`MenuItemArrayAdapter`来接受一个TextView：

```
public MenuItemArrayAdapter(Context context, TextView price){
  this.context = context;
  this.price=price
} 
```

之后，您可以安全地使用`price`它来更新它。

# linux - 如何根据 wget 的状态进行分支？

> ID：14186121
> 
> 赞同：0
> 
> 时间：2013-01-06T19:58:09.977
> 
> 标签：linux, bash, operators, wget, rpm

我正忙着编译一个脚本，通过向 PuTTy 窗口发送一些命令来在 Linux 上自动安装 MySQL。

我遇到的问题是一个存储库的下载链接不断变化，如果链接不可访问，我需要弹出一个提示。

这是我到目前为止得到的：

```
wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm 
&& echo "WE GOT IT" || echo "URL Invalid, Please specify new URL:" 
&& read newurl && wget $newurl 
```

但是无论文件是否存在，运行结果是： 1\. 第一个文件将下载，它将显示回显消息，然后它将等待读取 newurl 命令以获取用户输入，然后 wget 该新变量。

如何在“||”之后制作整个下半场 仅在第一个 url 不起作用时才会发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:03:21.233

### 重构你的代码

你的代码太扭曲了。虽然您可以使用大括号表达式对其进行改进，但最好将您的逻辑重构为 if/else 语句。作为（未经测试的）示例：

```
if wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm
then
    echo 'We got it!'
else
    read -p 'URL invalid. Please specify new URL: '
    wget "$REPLY"
fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:16:01.623

```
wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm 
&& echo "WE GOT IT" && exit || echo "URL Invalid, Please specify new URL:" 
&& read newurl && wget $newurl

Add "exit" on left side of ||  with && operator ,,if the left argument is true then it will download that file and exit from terminal otherwise prompt for new url 
```

# java - Java 类路径问题 - 不会运行

> ID：14186122
> 
> 赞同：0
> 
> 时间：2013-01-06T19:58:17.563
> 
> 标签：java, classpath

我正在学习如何从命令行运行 Java，并继续遇到同样的问题。`main()`我正在运行的方法是在`bin/edu/cuny/util/ConvertTestVectors.class`.

我将目录设置为`bin/cuny/`. 当我跑步时，`> java -cp . ConvertTestVectors`我得到：

```
Error: Could not find or load main class ConvertTestVectors 
```

当我跑步时，`> java -cp . util/ConvertTestVectors`我得到：

```
Exception in thread "main" java.lang.NoClassDefFoundError: util/ConvertTestVectors (wrong name: edu/cuny/util/ConvertTestVectors)
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(ClassLoader.java:791)
        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
        at java.net.URLClassLoader.defineClass(URLClassLoader.java:449)
        at java.net.URLClassLoader.access$100(URLClassLoader.java:71)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:361)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:308)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
        at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:480) 
```

有人能指出我正确的方向吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:19:08.053

要运行`main`某个 java 类的方法，您必须在命令行中指定此类的完全限定名称。例如，如果您的来源中有：

```
package edu.cuny.util;

class ConvertTestVectors {
    ...
    public static void main(String [] args) {
        ...
    }
    ...
} 
```

然后运行这个`main`方法你应该使用

```
java edu.cuny.util.ConvertTestVectors 
```

如果你的包名不同，你应该在命令行中相应地更改类名。

此外，还有一个`CLASSPATH`变量，它决定了 java 查找类的位置。它应该包含您的 java 包的根目录所在的目录（`edu`上例的父目录）。如果它包含`.`，那么您只需将目录更改为该根目录并运行 java 命令。

完全限定类名的各部分由点 ( `.`) 分隔，因此您不应`/`在类名中使用斜杠 ()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:00:25.763

`cd bin/edu/cuny && java util.ConvertTestVectors`

您必须使用完整的包名。

# android - Android 设备驱动程序：未找到？

> ID：14186127
> 
> 赞同：3
> 
> 时间：2013-01-06T19:58:50.320
> 
> 标签：android, drivers

我按照[此处](http://developer.android.com/tools/extras/oem-usb.html)的指南安装了我的 Android 设备驱动程序 (Windows 7)，这样我就可以在我的真实设备而不是模拟器上运行应用程序。

当 Windows 无法找到您需要的驱动程序并安装它们时该怎么办（...\adt-bundle-windows-x86_64\sdk\extras\google\usb_driver）？

我确实浏览了互联网，但我的制造商似乎“地下”，我找不到任何可信赖的链接。

具体来说，我的设备名称是“高通HSUSB设备”，T-mobile MOVE 2.2.2版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T20:14:41.173

首先，在 ADT 中，您需要勾选`Google Usb Driver`安装，然后如果您的设备是三星型号，则需要下载并安装`Samsung Kies` ，如果您的设备是 HTC，则需要`HTC manager`等..

这些链接可以帮助您：

[Android：在 Ubuntu 10.10 上的真实硬件（手机/平板电脑）上调试您的应用程序](http://binwaheed.blogspot.com/2011/12/android-debugging-your-application-on.html)

[Android 在真机上调试](http://www.mkyong.com/android/android-debugging-on-real-device/)

看到第二个我认为这可能对你有帮助..

# iphone - 如何使用按钮在 uiimage 中的 3 个图像视图之间切换

> ID：14186129
> 
> 赞同：-4
> 
> 时间：2013-01-06T19:59:13.507
> 
> 标签：iphone, objective-c, ios

基本上我需要一个在 3 个图像之间切换的按钮，我不确定如何实现这一点，我一直在寻找一种方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:08:17.087

你需要的是一个数组和模运算：

```
NSArray *images = [NSArray arrayWithObjects:image1, image2, image3, nil];

int idx = 0;

- (void)buttonPressed:(UIButton *)sender
{
    imageView.image = [images objectAtIndex:idx];
    idx = (idx + 1) % images.count;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:10:38.547

在 viewDidLoad 中，您可以获取 UIImageView 并将其添加到视图中。然后获取 UIImages 的 NSArray 并将索引 0 处的图像添加到 UIImageView 作为默认图像。然后创建一个自定义按钮，每次单击它都会旋转到 NSArray 中的新图像。这有帮助吗？

# objective-c - 覆盖 shouldAutorotateToInterfaceOrientation 方法

> ID：14186130
> 
> 赞同：0
> 
> 时间：2013-01-06T19:59:19.513
> 
> 标签：objective-c, ios5, ios6, autorotate

正在努力构建应用程序。我正在使用 ECSlidingViewController，它在打开新视图时使用：

```
[self.view addSubview:_topViewController.view]; 
```

这一切都很好，直到我想在一个视图上禁用横向。我的应用程序在一个视图控制器上启动，我将自动旋转设置为禁用

```
- (BOOL)shouldAutorotateToInterfaceOrientation(UIInterfaceOrientation)interfaceOrientation {
    return NO;
} 
```

当它作为子视图打开时，我如何在另一个视图控制器中覆盖它？

非常感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:09:03.060

我不确定是否有一种简单的方法可以只制作一些屏幕纵向和其他两者；特别是如果您的一个视图已经处于横向模式并且您想要打开下一个肖像，那将是一件痛苦的事情。我不确定你的所有要求。您应该将supportedInterfaceOrientations 与shouldAutoRotate 一起使用。如果没有任何效果，请找出所需的方向和当前方向，然后对视图应用变换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:41:13.253

view.transform = CGAffineTransformRotate(view.transform, phaseShift * M_PI/2.0f);

您必须根据设备方向和界面方向知道要使用 1 或 -1 的相移是什么。

# struts2 - struts action标签中method属性的含义

> ID：14186132
> 
> 赞同：3
> 
> 时间：2013-01-06T19:59:42.107
> 
> 标签：struts2, struts, struts-config

struts.xml中action标签中的属性方法是什么？我见过很多这个属性的用例，但我不明白它是如何改变行为的？

例如，当我更改以下方法属性或删除它时，我看不到任何事情发生。我尝试执行并输入和`{1}`. 为什么有时我会看到`{1}`struts.xml 文件的这个属性。

```
<action name="ShowAddItemPage" method="input" class="action.clerk.ShowAddItemPage">
  <result name="success" type="tiles">addItem</result>
  <result name="generalError" type="tiles">clerkGeneralError</result>
  <result name="input" type="tiles">addItem</result>
</action> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T09:46:45.217

根据[这一点](http://struts.apache.org/2.1.6/docs/action-configuration.html) ，动作标签中的属性方法用于指定在调用相应动作时将处理动作逻辑的方法名称。

行为如下：当调用任何操作时，会在 struts.xml 中查找该操作。如果指定了方法属性，则该方法将在动作类中执行，如果未指定方法属性，则默认调用 execute()。如果配置中没有执行方法并且没有指定其他方法，框架将抛出​​异常。

# ios - SplitViewController 不更新 detailView 变得绝望

> ID：14186135
> 
> 赞同：0
> 
> 时间：2013-01-06T19:59:50.760
> 
> 标签：ios, xcode, ipad, uisplitviewcontroller

我无法弄清楚问题是什么，我使用了 2 个教程和 Apple 给你的示例，但它仍然不会更新。我正在尝试修复此问题 4 天一些信息：我正在为这个项目使用故事板

Appdelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
// Override point for customization after application launch.
UISplitViewController *splitViewController = (UISplitViewController *)self.window.rootViewController;
UINavigationController *navigationController = [splitViewController.viewControllers lastObject];
splitViewController.delegate = (id)navigationController.topViewController;
return YES;
} 
```

主视图控制器.m

为控制器创建了一个属性（nieuwViewController）

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
SearchResult *searchResult = [searchResults objectAtIndex:indexPath.row];
NSLog(@"%@",searchResult);

self.nieuwViewController.searchResult =searchResult;
} 
```

NieuwViewController.m

```
- (void)setSearchResult:(SearchResult *)newSearchResult
{
if (_searchResult != newSearchResult) {
    _searchResult = newSearchResult;

    // Update the view.
    [self updateUI];
}

}

- (void)viewDidLoad
{
[super viewDidLoad];
NSLog(@"DETAIL VIEWDIDLOAD");
NSLog(@"%@",self.searchResult);
[self updateUI];

} 
```

在updateUI中，我设置了所有标签等，但如果我也记录了它，它会被调用一次（当应用程序启动时）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:03:43.943

`viewDidLoad`get 仅在 NIB 或情节提要初始化期间调用一次。用于`viewWillAppear`更新 ui。但请记住，在 SplitViewController 中，详细视图不会自动更新；从 触发更新`didSelectRowAtIndexPath`。

# xml - XSLT：如何组合节点名称和字符串以用作选择器以匹配元素

> ID：14186138
> 
> 赞同：1
> 
> 时间：2013-01-06T20:00:13.040
> 
> 标签：xml, xslt, xpath

我正在尝试使用祖父节点并与字符串合并一个变量以匹配另一个节点，但是以下语句失败：

```
<xsl:apply-templates select="/data/*[name() = $grandparent]/entry[@id = current()/item/@id]" mode="slides"/> 
```

这是变量：

```
<xsl:variable name="grandparent" select="concat(name(../..),'-','slides')"> 
```

完整的 XML：

```
<?xml version="1.0" encoding="utf-8" ?>
<data>
  <navigation>
    <page handle="work" id="2">
        <name>Work</name>
    </page>
    <page handle="studio" id="3">
        <name>Our Studio</name>
        <page handle="people" id="8">
            <name>People</name>
        </page>
        <page handle="process" id="7">
            <name>Process</name>
        </page>
    </page>
    <page handle="journal" id="4">
        <name>Journal</name>
    </page>
    <page handle="media" id="5">
        <name>Media</name>
        <page handle="press" id="25">
            <name>Press</name>
        </page>
        <page handle="publication" id="26">
            <name>Publication</name>
        </page>
    </page>
    <page handle="contact" id="6">
        <name>Contact</name>
    </page>
</navigation>

<work-slides>
    <section id="3" handle="work-slides">Work Slides</section>
    <entry id="105">
        <title handle="auto-4">Auto 4</title>
        <project>
            <item id="101" handle="autographer" section-handle="work" section-name="Work">Autographer</item>
        </project>
        <image size="272 KB" path="/uploads/slides" type="image/jpeg">
            <filename>auto4.jpg</filename>
        </image>
    </entry>
    <entry id="104">
        <title handle="auto-3">Auto 3</title>
        <project>
            <item id="101" handle="autographer" section-handle="work" section-name="Work">Autographer</item>
        </project>
        <image size="194 KB" path="/uploads/slides" type="image/jpeg">
            <filename>auto3.jpg</filename>
        </image>
    </entry>
</work-slides>
<work>
    <section id="1" handle="work">Work</section>
    <category link-id="11" link-handle="technology" value="Technology">
        <entry id="101">
            <name handle="autographer">Autographer</name>

            <category>
                <item id="11" handle="technology" section-handle="category" section-name="Category">Technology</item>
            </category>

            <slides>

                <item id="105" handle="auto4jpg" section-handle="work-slides" section-name="Work Slides">auto4.jpg</item>
            </slides>
        </entry>
        <entry id="39">
            <name handle="urraco">URRACO</name>

            <category>
                <item id="11" handle="technology" section-handle="category" section-name="Category">Technology</item>
            </category>

            <slides>
                <item id="104" handle="auto3jpg" section-handle="work-slides" section-name="Work Slides">auto3</item>
            </slides>
        </entry>
    </category>
</work> 
```

这是完整的 XSL：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0"
xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
xmlns:exsl="http://exslt.org/common"
exclude-result-prefixes="exsl"
>

<xsl:output method="xml" omit-xml-declaration="no" encoding="UTF-8" indent="yes" />

<!-- outline -->
<xsl:template match="/">
   <response>
        <xsl:for-each select="data/navigation/page">
            <xsl:element name="{@handle}">
                <xsl:attribute name="id"><xsl:value-of select="current()/@id"/></xsl:attribute>
                <xsl:value-of select="name"/>
                <xsl:apply-templates select="/data/*[name()=current()/@handle]" mode="page"/>
            </xsl:element>
        </xsl:for-each>
    </response>
</xsl:template>

<xsl:template match="/data/work" mode="page">
    <xsl:for-each select="category">
        <xsl:element name="{@link-handle}">
            <xsl:attribute name="id"><xsl:value-of select="@link-id"/></xsl:attribute>
            <xsl:value-of select="@value"/>
            <xsl:apply-templates select="entry" mode="category"/>
        </xsl:element>
    </xsl:for-each>
</xsl:template>

<xsl:template match="entry" mode="category">
    <xsl:variable name="grandparent" select="concat(name(../..),'-','slides')">
    <article>
        <xsl:attribute name="id"><xsl:value-of select="@id"/></xsl:attribute>
        <xsl:for-each select="child::*">
            <xsl:element name="{local-name()}">
                <xsl:choose>
                    <xsl:when test="local-name() = 'slides'">
                        <xsl:apply-templates select="/data/*[name() = $grandparent]/entry[@id = current()/item/@id]" mode="slides"/>
                    </xsl:when>
                    <xsl:otherwise>
                        <xsl:value-of select="."/>
                    </xsl:otherwise>
                </xsl:choose>
            </xsl:element>
        </xsl:for-each>
    </article>
</xsl:template>

<xsl:template match="entry" mode="slides">
    <slide>
        <xsl:for-each select="child::*">
            <xsl:element name="{local-name()}">
                <xsl:choose>
                    <xsl:when test="local-name() = 'image'">
                        <xsl:value-of select="concat($workspace, @path, '/', filename)"/>
                    </xsl:when>
                    <xsl:otherwise>
                        <xsl:value-of select="."/>
                    </xsl:otherwise>
                </xsl:choose>
            </xsl:element>
        </xsl:for-each>
    </slide>
</xsl:template>

</xsl:stylesheet> 
```

是否可以做到以上几点？我不明白为什么它应该失败。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T20:20:31.780

```
<xsl:variable name="grandparent" select="concat(name(../..),'-','slides')"> 
```

**这在语法上是非法的。具有未闭合起始标记的 XML 元素。**

**必须是**：

```
<xsl:variable name="grandparent" select="concat(name(../..),'-','slides')"/> 
```

# asp.net-mvc - 尝试使用 Glimpse 查看 POST 信息

> ID：14186143
> 
> 赞同：0
> 
> 时间：2013-01-06T20:00:38.693
> 
> 标签：asp.net-mvc, glimpse

我试图让 Glimpse 让我看看在 POST 操作中由“return RedirectToAction()”触发的 GET 操作之前的 POST 操作期间发生了什么。我发现[这篇 SO 帖子](https://stackoverflow.com/questions/6493455/glimpse-and-redirecttoaction)解释了：

> 您可以使用 Glimpse 的远程选项卡查看过去的请求。
> 
> 单击远程选项卡，然后选择右侧的“启动”链接。然后，这将向您显示该客户端随时间发出的请求列表。
> 
> 然后，您可以从该列表中单击给定请求的“启动”链接，以查看该过去请求的所有 Glimpse 信息（包括日志记录）。这在 Glimpse 中通过更改 URL 更改和显示在左上角/状态区域中的字符串“（远程）”来记录。

我的问题是，如果我多次发布，一瞥似乎只想让我通过“远程”选项卡访问第一个 POST。换句话说，当我与我的网站交互时，我想看看最近的 POST 中发生了什么，但 glimplse 似乎只想向我展示第一个 POST 中发生的事情。

通过测试这种行为，我创建了一个简单的 MVC 应用程序（我对 MVC 3 和 MVC 4 都做了同样的过程，结果大致相同）：

1.  在 Visual Studio 2012 中，创建一个新的 APS.NET MVC 3 Web 应用程序并将其命名为 MVC3App
2.  选择互联网应用程序
3.  在解决方案资源管理器中右键单击项目，选择管理 NuGet 包，然后安装 Glimpse for ASP.NET MVC3 (Beta)（版本 0.87）

修改 HomeController.cs 看起来像这样

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;
using System.Diagnostics;
using MVC3App.Models;

namespace MVC3App.Controllers
{
    public class HomeController : Controller
    {
        public ActionResult Index()
        {
            ViewBag.Message = "My test";

            // Initialize the model data
            if (Session["value"] == null) Session["value"] = 1;

            // Get a view model
            var mvm = new MyViewModel() {
                Value = Convert.ToInt32(Session["value"])
            };

            // Display the view
            return View(mvm);
        }

        [HttpPost]
        public ActionResult Index(MyViewModel mvm)
        {
            Trace.TraceInformation("POST: Value = {0}", mvm.Value);

            // Fetch the POST data and store it in the model data
            Session["value"] = mvm.Value;

            // Redirect back to the "display" page
            return RedirectToAction("Index");
        }

        public ActionResult About()
        {
            return View();
        }
    }
} 
```

添加模型\MyViewModel.cs

```
namespace MVC3App.Models
{
    public class MyViewModel
    {
        public int Value { get; set; }
    }
} 
```

最后，修改 Index.cshtml

```
@model MVC3App.Models.MyViewModel

@{
    ViewBag.Title = "Home Page";
}

@using (Html.BeginForm()) {
    <div>
        Value: @Html.EditorFor(m => m.Value)
    </div>
    <input type="submit" value="Click me" />
} 
```

运行项目时，您会得到一个网页，其中包含一个包含“1”的文本框。将值更改为“123”，然后单击“单击我”按钮。

现在，如果您在网页上显示 Glimpse 面板，您将看到它显示的信息可能来自显示该页面的 GET 请求。如果我单击远程选项卡，它会显示 3 个请求以及一个启动链接。如果我单击 Launch 链接，然后单击列表中 POST 请求旁边的 Launch 链接，则会显示来自 POST 的数据，其中包含值“123”。

现在，将网页上的值更改为“5”，然后单击“单击我”按钮。好的，所以现在我想在 POST 数据中查看值为 5 的 POST 请求中的数据。在 Glimpse 面板的 Remote 选项卡上，您会看到它仍然有 3 个远程请求可用。单击启动链接会显示相同的原始 3 个远程请求。它不显示我刚刚通过单击按钮触发的 POST 请求。

那么，我在这里缺少什么？我认为这应该可以工作，我只是以某种方式滥用它......（我想我应该补充一点，我在 Windows 7 上使用 IE。）

鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T17:52:48.363

I recommend that you try using Glimpse RC1\. (Available on NuGet if you Include Prerelease's).

The newer version of Glimpse does a better job of tracking request history.

Please note: the tab is no longer called Remote, but is instead called History. Either way, it does the exact same thing, the name is just different.

# python - python-sympy：当函数分段定义时，lambdify 返回错误的答案

> ID：14186145
> 
> 赞同：2
> 
> 时间：2013-01-06T20:01:12.380
> 
> 标签：python, sympy, piecewise

我对为什么以下代码的答案是 10 而不是 1 感到困惑。有人可以帮助我了解发生了什么`lambdify`或导致错误答案的原因吗？

```
import sympy
from sympy.utilities.lambdify import lambdify
from sympy import Function
from sympy.abc import x, y

def kFct(xIndex,loc,k1,k2):
...   if xIndex <= loc:
...     return k1
...   else:
...     return k2
... 
loc = 0.5
k1 = 1
k2 = 10

kfun = lambdify( (x,y), kFct(x,loc,k1,k2) )
print kfun(0,0)
>>> 10 
```

为什么不是答案`k1`或 1，因为`x = 0`小于`loc = 0.5`？

但是，如果我这样做，它会返回正确的答案

```
print kfct(0,loc,k1,k2)
>>> 1 
```

我需要将其`kfun`作为 x 和 y 的函数，因为稍后，我将其用作积分参数的一部分。它最终也将取决于 y。

我在 Mac 10.6.x 上使用 python 2.6.8。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:23:05.437

的参数`lambdify`在它们被传递之前被评估，所以你实际上并没有将你的函数传递给`lambdify`，你传递的是数字 10：

```
>>> kFct(x, loc, k1, k2)
10 
```

你在这里得到 10，因为

```
>>> x <= loc
x <= 0.5
>>> bool(x <= loc)
False 
```

所以第二个分支被采用。由于 Python 的工作方式，我认为你不能让它工作——你不能只压制一个分支。（原则上，一个程序可以做一些疯狂的字节码自省，但我很确定`sympy`不会。）

不过，您可以使用`implemented_function`：

```
>>> f = implemented_function(Function('kFct'), lambda x,y: kFct(x, loc, k1, k2))
>>> kfun = lambdify((x,y), f(x,y))
>>> kfun(0,0)
1
>>> kfun(0.5,0)
1
>>> kfun(0.51,0)
10
>>> kfun(1, 0.0)
10 
```

不过，考虑到额外的间接性，我不确定这对您有多大好处：我可能只使用函数本身（假设您最终要寻找积分的数值评估。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T23:13:34.983

您想使用`Piecewise`，它以 SymPy 可以使用的符号方式表示 if 分支。

这是您的示例，其中包含`loc`,`k1`和`k2`明确输入的值。您当然可以象征性地使用它们，然后`subs`在您的代码规定的情况下替换它们。

```
>>> kFct = Piecewise((1, x < 0.5), (10, True))
>>> kfun = lambdify(x, kFct)
>>> kfun(0)
1
>>> kfun(1)
10 
```

# facebook - 如何通过 Facebook 的 Javascript SDK 安全地授权用户

> ID：14186146
> 
> 赞同：31
> 
> 时间：2013-01-06T20:01:20.850
> 
> 标签：facebook, security, authorization, facebook-javascript-sdk, facebook-login

我想让用户使用他们的 Facebook ID 登录我的网站，而无需重新加载页面。这就是我使用[Facebook Javascript SDK](http://developers.facebook.com/docs/howtos/login/getting-started/)的原因。该方案描述了使用此 SDK 的授权流程： ![在此处输入图像描述](../Images/7c469a9aadf428f3aaaa528593a52c5e.png)

在流程结束时，我知道用户已登录并且我知道他们的 Facebook ID。然后我可以通过这个 ID 在我的数据库中注册他们，然后让他们使用它来登录。

**然而，这似乎非常不安全。**为了让我的服务器端脚本知道用户的 ID，我必须通过 AJAX 发送它。但是，我无法知道尝试登录的是否是 ID 的所有者。任何人都可以发送带有 ID 的 POST 请求（尤其是获取另一个用户 ID 的人）。

我目前的想法是让用户像往常一样通过JS SDK登录，通过AJAX将ID和Access Token发送到服务器，然后在PHP脚本中使用cURL来确保用户实际登录。

这是要走的路，还是我忽略了更好的选择？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-08T23:38:43.193

1.  您不需要通过 ajax 推送用户 ID。您应该在服务器端使用保存签名请求的 fbsr_{app_id} cookie。使用 FB 发布的“秘密”app_secret 解析此签名请求以获取“用户 ID”。注意：成功的解析还表明 FB 提供的 cookie 数据没有被篡改。

2.  解析 signed_request 后，您还应该获得“issued_at”时间。检查此时间是否在最后 10 分钟内。通过这样做，您知道登录请求到达您的服务器，因为用户（使用 user_id）使用客户端 SDK。（参考：http: [//developers.facebook.com/roadmap/completed-changes/](http://developers.facebook.com/roadmap/completed-changes/)）

3.  您应该立即将此代码交换为 access_token。如果失败（FB 会给你一个 OAuthException 类型的错误消息），这意味着在用户登录 facebook 和你收到登录请求之间存在不自然的延迟。

通过第 2 步，您可以阻止使用旧 fbsr_cookie 的攻击尝试。如果用户（来自 user_id）已经有您的帐户，那么您可能希望在此处停止并登录该用户。但是，在某些情况下您的 app_secret 可能会受到威胁。要处理这种情况，您应该按照步骤 3 进行操作，因为**access_token 的代码交换只能发生一次**，并且**在问题发生后 10 分钟内**发生。如果用户没有您网站的帐户，那么您无论如何都需要第 3 步来使用 access_token 从 FB 检索其他必要的用户数据，例如姓名、电子邮件等。

因此，只有在这 10 分钟的安全间隙内，其他人才能窃取受害者的 cookie 并试图进行攻击。如果您对这个安全漏洞不满意，您应该迁移到服务器端身份验证。该决定取决于您存储的用户信息的敏感性。而且您不会损害任何转移到服务器端身份验证的东西，您可以同时继续将客户端方法用于其他事情。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-06T21:30:47.833

通过 JS SDK 登录用户后，将设置一个包含凭据信息的特殊 cookie（如果我是正确的，则使用您的密钥编码）。然后可以通过[PHP SDK`getUser()`方法](https://developers.facebook.com/docs/reference/php/facebook-getUser/)使用此信息。

只要您的 API（您的 ajax 端点）与您的应用程序位于同一个域中，您就应该在用户请求您的服务器时收到此 cookie。

当然，您需要确保正确设置了 Javascript SDK，并且您使用了[`cookie: true`config 选项](https://developers.facebook.com/docs/reference/javascript/FB.init/)，并且您提供了一个[有效的`channel`文件](https://developers.facebook.com/docs/reference/javascript/#channel)。如果不满足这些要求，您可能会在 IE 和 Safari 中的跨域通信和 3rd 方 cookie 方面遇到一些问题。

您还可以检查这个相关问题：[A proper approach to FB auth](https://stackoverflow.com/questions/13351235/a-proper-approach-to-fb-auth)

# c# - 使用实体框架迭代数据库表的列

> ID：14186147
> 
> 赞同：1
> 
> 时间：2013-01-06T20:01:30.563
> 
> 标签：c#, entity-framework

我有一个需要清理的数据库，但我想动态清理它。每个表都包含几个字段，我的要求是将“ `Trim()`”函数应用于所有“字符串”字段。

假设我有两个名为`CustomerInfo`and的表`CustomerPayments`，我的要求是首先遍历这些表，并为每个表搜索类型为“ `String`”的列（字段），然后将`Trim()`方法应用于它们。

我可以用 LINQ 做到这一点吗？

我使用以下代码无济于事，因为`CustomerInfo`Entity Framework 生成的类没有实现`GetProperties()`.

```
foreach (PropertyInfo propertyInfo in CustomerInfo.GetProperties()) 
```

尽管我也确实需要在基础实体对象中迭代表名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:08:37.910

这不应该是

```
foreach (PropertyInfo propertyInfo in typeof(CustomerInfo).GetProperties()) 
```

?

# php - php domdocument 检查跨度类

> ID：14186148
> 
> 赞同：1
> 
> 时间：2013-01-06T20:01:32.237
> 
> 标签：php, html, domdocument, dom

如何迭代所有标签并检查类是 font18 还是 font17？

```
 $html = new DOMDocument();
    $html->load('file.html'); 
```

html:

```
 <p><a name="bookmark7"></a><span class="font18" style="font-weight:bold;">Abilitazione</span></p>
<p><span class="font17">I medici devono essere autorizzati dallo Stato a praticare la loro professione. I requisiti per ottenere questa autorizzazione variano a seconda delle diverse Nazioni. I laureati presso Facoltà mediche estere possono ottenere l'autorizzazione a esercitare in Italia se rispondono ai requisiti statali per quanto riguarda il tirocinio e se superano l'esame di Stato. Nell'ambito della CEE si tratta tuttora di una questione da definire nei particolari.</span></p> 
```

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T20:18:23.767

`Input is not proper UTF-8, indicate encoding ! Bytes: 0xE0 0x20 0x6D 0x65`如果您在此处使用，您的 HTML 将给出错误`$doc->load("file.html");`是一个简单的解决方法

```
$doc = new DOMDocument('1.0', 'UTF-8');
libxml_use_internal_errors(true);
$doc->loadHTML(file_get_contents("file.html"));

foreach ( $doc->getElementsByTagName('span') as $node ) {
    if (preg_match("/^font1[7|8]$/", $node->getAttribute('class'))) {
        echo $node->nodeValue, "<br /><br />";
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-06T20:09:36.200

以下将遍历所有`span`标签，您可以使用它来检查类（如果您提供的 HTML 片段确实是您正在使用的那个）：

```
$doc = new DOMDocument();
libxml_use_internal_errors(true);
$doc->load('file.html');

$xpath = new DOMXPath($doc);
$nodes = $xpath->query('//span');

foreach ($nodes as $node) {
    echo $node->getAttribute('class');
} 
```

演示：[http ://codepad.viper-7.com/pQuQw1](http://codepad.viper-7.com/pQuQw1)

如果 HTML 实际上不同，您可以告诉我，以便我更改我的代码段。仅选择 xpath 查询中的特定元素（例如，仅选择具有 class`font17`或的元素`font18`）也可能是值得的。

*请注意，我使用了 DOMXPath，因为这将使您更灵活地更改查询以根据您的 HTML 选择所需的元素*

如果您只想选择带有类的元素，`font17`或者`font18`您可以将查询更改为：

```
$nodes = $xpath->query('//span[contains(@class, "font17")]|//span[contains(@class, "font18")]'); 
```

演示：[http ://codepad.viper-7.com/mHo5P7](http://codepad.viper-7.com/mHo5P7)

# objective-c - 层支持/层托管 NSView 的不稳定行为

> ID：14186153
> 
> 赞同：8
> 
> 时间：2013-01-06T20:02:01.037
> 
> 标签：objective-c, cocoa, core-animation, calayer, nsview

我有一个看起来像这样的视图层次结构：

![在此处输入图像描述](../Images/ccedf0a3426d8faef314c8beb1eb7c17.png)

所以基本上我有一个 NSSplitView 和一个包含滚动视图（用于表格视图）的子视图以及一个包含 3 个子视图的页脚视图。需要注意的一些重要事项：

*   使用 10.8 基础 SDK，**没有自动布局**
*   窗口内容视图、拆分视图、滚动和页脚视图的父视图以及滚动视图和页脚视图都是由**NSViewContentsRedrawOnSetNeedsDisplay**重绘策略**支持**的层。
***   the `NSClipView`of the`NSScrollView`是一个特殊的子类，它是一个**层托管**视图并使用 a`CAScrollLayer`作为支持层。*   *颜色视图*是一个简单的图层支持视图，具有背景颜色集。*   *背景视图*是一个**图层托管**视图，它有一个*内容*属性设置为图像的子图层（还设置了**内容中心）***   内容*视图*是一个**层支持**的容器视图，它包含一个子视图，一个自定义**层支持**的按钮视图（不是 NSButton）。*   页脚视图与滚动视图重叠约 3 个像素**

 **这种布局我的行为非常不稳定。这是我得到的三个不同的场景，每次启动应用程序时都会随机化。

1) 一切正常。背景视图和所有内容都在那里：

![在此处输入图像描述](../Images/2c7bd61bd7cff632c2d985d41b36a63b.png)

2）按钮看起来很好，但背景视图似乎是部分透明的：

![在此处输入图像描述](../Images/36adf273073b803d81f8890ec34f0dba.png)

3）背景视图正确显示，但按钮不见了：

![在此处输入图像描述](../Images/37f2dbddf1396f52e89219d225344c97.png)

绝对没有代码在这些场景之间发生变化。我只是停止并再次运行该应用程序。我确保我不会在运行时更改与不透明度相关的任何内容。我在运行时唯一要做的就是在视图上设置背景颜色和图像。

**编辑：**我觉得重叠的视图可能会造成麻烦，所以我在没有重叠的情况下进行了测试并得到了相同的结果。

**编辑 2：**这似乎是`zPosition`层支持视图的层的问题。顺序是加扰和随机的。如果我手动将图层的 zPosition 强制为正确的值以匹配子视图顺序，那么一切都很好。不幸的是，除了设置`zPosition`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T20:36:59.443

这似乎是一个 OS X 错误。[雷达已归档](http://openradar.appspot.com/13542277)。同时，这是我发现的最好的解决方法（`view`所有兄弟视图的超级视图在哪里）：

`view.subviews = [view.subviews copy]`

触发 setter 以在视图层上`subviews`设置正确的值。`zPosition`**

# python - 我无法从 sublime 插件访问我的设置

> ID：14186154
> 
> 赞同：2
> 
> 时间：2013-01-06T20:02:09.843
> 
> 标签：python, settings, sublimetext2

我正在尝试编写一个插件来崇高文本 2，现在我需要访问设置值。但是我似乎无法弄清楚如何准确地做到这一点。我什至从其他插件复制了代码，但仍然无法访问我的设置值。

这是它现在的样子：

```
import sublime
import sublime_plugin

class SendMailCommand(sublime_plugin.TextCommand):

    def __init__(self, view):
        self.view = view

    def run(self, edit):
        settings = {}
        settings["use_tls"] = self.view.settings().get("smtp_tls", None)
        settings["use_port"] = self.view.settings().get('smtp_port', 25)

        print settings 
```

不用说，这些设置都没有默认值。我的 PackageName.sublime-settings 文件如下所示：

```
{
    "smtp_server": "smtp.gmail.com",
    "smtp_tls": true,
    "smtp_port":587
} 
```

如果我将设置的名称更改为指向通用用户设置文件中的某些内容，那么它可以工作，所以我猜测我的设置文件的名称有误，或者我只是在访问`plugin local`设置时做错了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:27:41.783

Okay so actually it is really simple, however I've seem to have missed that to load in the settings for your own project you must do the following:

```
settings = sublime.load_settings("<project-filename>.sublime-settings") 
```

# c# - 使用asp.net中的更新面板单击按钮更新gridview

> ID：14186162
> 
> 赞同：3
> 
> 时间：2013-01-06T20:03:01.310
> 
> 标签：c#, asp.net, ado.net

我有一个gridview定义为

```
 <asp:UpdatePanel ID="up2" runat="server">
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="btnSubmit" EventName="Click" />
    </Triggers>
    <ContentTemplate>
        <asp:GridView ID="GridView1" DataSourceID="employee" AutoGenerateEditButton="true" AutoGenerateDeleteButton="true" DataKeyNames="id" AllowPaging="true" AllowSorting="true" runat="server" CellPadding="4" ForeColor="#333333" 
            GridLines="None">
            <RowStyle BackColor="#F7F6F3" ForeColor="#333333" />
            <FooterStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
            <PagerStyle BackColor="#284775" ForeColor="White" HorizontalAlign="Center" />
            <SelectedRowStyle BackColor="#E2DED6" Font-Bold="True" ForeColor="#333333" />
            <HeaderStyle BackColor="#5D7B9D" Font-Bold="True" ForeColor="White" />
            <EditRowStyle BackColor="#999999" />
            <AlternatingRowStyle BackColor="White" ForeColor="#284775" />
      </asp:GridView>   
      <asp:SqlDataSource ID="employee" runat="server" ConnectionString="values go here" SelectCommand="select * from employee" UpdateCommand="update employee set name=@name, company=@company, salary=@salary where id=@id" DeleteCommand="delete from employee where id=@id"></asp:SqlDataSource>        
    </ContentTemplate>
 </asp:UpdatePanel> 
```

每次单击提交按钮时，我都需要更新它。提交按钮定义为

```
 protected void btnSubmit_Click(object sender, EventArgs e)
{
    try
    {
        SqlConnection xconn = new SqlConnection();
        xconn.ConnectionString = @"values go here";
        xconn.Open();
        string str = "insert into employee(name, company, salary) values(@name, @company, @salary)";
        SqlCommand ycmd = new SqlCommand(str, xconn);
        ycmd.Parameters.Add("@name", txtname.Text);
        ycmd.Parameters.Add("@salary", txtsalary.Text);
        ycmd.Parameters.Add("@company", txtcompany.Text);
        ycmd.ExecuteNonQuery();
        lblresult.Text = "Record successfully inserted";            
    }
    catch (SqlException e1)
    {
        lblresult.Text = "<span style='color:red;'>" + e1.Message + "<br />" + e1.StackTrace + "</span>";
    }
    catch (Exception e2)
    {
        lblresult.Text = "<span style='color:red;'>" + e2.Message + "<br />" + e2.StackTrace + "</span>";
    }
    finally
    {
        txtname.Text = "";
        txtcompany.Text = "";
        txtsalary.Text = "";
    }
} 
```

但是，网格不会更新`btnSubmit_Click`

有什么解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:06:01.360

你需要

```
GridView1.DataBind(); 
```

强制网格重新查询数据。

# c# - 根据大小对数字范围进行分区，然后为该范围内的给定数字找到分区的开始

> ID：14186165
> 
> 赞同：0
> 
> 时间：2013-01-06T20:03:14.347
> 
> 标签：c#, algorithm, linq

抱歉，如果以前有人问过这个问题，但我找不到适合我想做的事情的匹配项。

我正在寻找一种算法来在 C#（或相关的 LINQ 扩展）中执行以下操作。

给定一组数字中的一个数字（例如`56 of 1 to 245`），不排除任何数字和一个分区大小（例如`10`），我想找到给定数字所在分区的起始数字。

示例：搜索 56 的起始页。

```
1-10
11-20
21-30
31-40
41-50 
51-60 <-- 56 is in the partition starting with 51
..
231-240
241-245 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T20:06:35.677

```
int page = 56;
int partition_size = 10;

int starting_number = (page / partition_size) * partition_size + 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:16:15.033

在 VB.Net 中有一个名为 DivRem 的数学函数，它将两个实数相除并给出余数。这与其他解决方案基本相同，但是当您使用内置的数学函数时，它会扩展您的视野。

```
 Dim startingindex, inputparam, delta As Integer
        delta = 10
        inputparam = 56
        startingindex = inputparam - Math.DivRem(inputparam, delta, startingindex) 
```

结果是：startingindex = 51

# javascript - 使用数据属性对节点进行排序

> ID：14186173
> 
> 赞同：-2
> 
> 时间：2013-01-06T20:03:57.140
> 
> 标签：javascript, dom

所以，我有类似的东西：

```
<ul>
   <li data-index="34"></li>
   <li data-index="2"></li>
   <li data-index="28"></li>
   <li data-index="6"></li>
   <li data-index="79"></li>
   <li data-index="1"></li>
</ul> 
```

使用该数据索引订购 Dom 的最快方法是什么？

我正在使用冒泡排序算法，但试图找到一个更快的算法。

（仅纯 javascript，不是 jQuery）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:21:58.173

这将起作用：

```
var ul = document.getElementById( 'your ul element name' );
var arr = [ ];
for ( var i = 0; i < ul.children.length; ++i )
    arr.push( ul.children[ i ] );

arr.sort( function( a, b ) {
    return +a.getAttribute( 'data-index' ) - +b.getAttribute( 'data-index' );
} );

for ( i = 0; i < arr.length; ++i )
    ul.appendChild( arr[ i ] ); 
```

告诉我你是否需要解释。该解决方案使用 Array 对象上的内置排序机制，这可能相当快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:25:33.130

这是我的解决方案：

```
var ul = document.getElementsByTagName('ul')[0],
    lis = ul.getElementsByTagName('li'),
    values = [],
    html = '';

for (var i=0; i<lis.length; i++) {
  values.push(lis[i].getAttribute('data-index'));
}

values = values.sort();
for (var i=0; i<values.length; i++) {
  var el = document.querySelectorAll('[data-index="' + values[i] + '"]')[0];
  html += el.outerHTML;
}
ul.innerHTML = html; 
```

[在这里](http://jsfiddle.net/Uz8wQ/)摆弄

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T20:28:41.740

虽然有点麻烦，但这确实很好。不确定您现在使用的速度，但这运行起来非常有效：

```
var ul = document.getElementsByTagName("ul")[0];
var lis = ul.getElementsByTagName("li");
var len = lis.length;
var indexs = [];
var obj = null;
var getByIndex = function(j){
    var li = null;
    for(var i = 0; i < len; i++) {
        li = lis[i];
        if(obj.getAttribute("data-index") == j) {
            break;
        }
    }
    return(li);
};
for(var i = 0; i < len; i++) {
    indexs.push(lis[i].getAttribute("data-index"));
}
indexs.sort(function(a, b){return(a - b);});
for(var i = 0; i < len; i++) {
    obj = getByIndex(indexs[i]);
    ul.appendChild(obj);
} 
```

你总是可以优化代码和你有什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T20:32:56.203

在这里，应该这样做。不确定它是否是最佳性能，但它很短：

```
var items = document.querySelectorAll('li'),
    ul = items[0].parentNode;

[].slice.call( items ).sort(function( a,b ) {
  return a.getAttribute('data-index') - b.getAttribute('data-index');
}).forEach(function( item ) {
  ul.appendChild( item );
}); 
```

**演示：http:** [//jsbin.com/obasiq/1/edit](http://jsbin.com/obasiq/1/edit)

# html - 某些选择器的 CSS 选择器样式排除

> ID：14186174
> 
> 赞同：0
> 
> 时间：2013-01-06T20:04:01.187
> 
> 标签：html, css, css-selectors

我有

```
<table id="exclude1"><tr><td id="exclude2" height="100%" width="100%">

    <div>123</div><table>......</table> etc

</td></tr></table> 
```

和 CSS 样式

```
<style>
#exclude1, #exclude2 {border:0; background:transparent; width:100%; height:100%; margin:auto; padding:0; float:none; position:relative;}
* {border:1px solid red; background:red; width:100px; etc.....}
</style> 
```

问题是，当我为 '*' 选择器设置 'display:block' 或 'display:inline' 为 css 时，这种样式也适用于排除选择器。当我为“排除”选择器设置“显示：块”或“表格”或“表格单元”或其他任何内容时，这两个元素变得不同（对齐、大小等被破坏）。

我该怎么做才能使#exclude1 和#exclude2 不受“*”选择器样式的影响？

升级版：

我已将#exclude1、#exclude2 分隔为：

```
#exclude1 {border:0; background:transparent; width:100%; height:100%; margin:auto; padding:0; float:none; position:relative; display:table;}
#exclude2 {border:0; background:transparent; width:100%; height:100%; margin:auto; padding:0; float:none; position:relative; display:table-cell; vertical-align:middle;} 
```

似乎至少现在一切正常。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:27:16.733

将 * 放在#Exclude1、#Exclude2 之前。这就是 CSS 的工作原理，它们是**层叠**样式表。

而且，如果所有其他方法都失败了，请在您的属性之后抛出一个 !important，如下所示：

*   边框：无！重要；

# xaml - 绑定到 Windows 8 XAML 中的静态字段

> ID：14186175
> 
> 赞同：3
> 
> 时间：2013-01-06T20:04:04.230
> 
> 标签：xaml, windows-8, windows-runtime

如何绑定到 Windows 8 XAML 中的静态字段？在 WPF 中，我们曾经能够执行以下操作：

```
<TextBlock Text="{x:Static resources:Messages.LastName}"/> 
```

但似乎 x:Static 在 Windows 8 XAML 中不再有效。对于那些从 WPF 迁移到 Windows 8 的人来说，那里有什么好的资源吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T07:09:26.797

您可以重构代码以使属性不再是静态的，或者创建一个代理对象来中继您的静态属性更改。无论哪种方式，您最终都会得到一个类的实例，例如通过在资源中定义一个实例，然后您将像这样绑定：

```
Text="{Binding LastName, Source={StaticResource Messages}}" 
```

# c++ - 访问指针向量中的元素

> ID：14186176
> 
> 赞同：1
> 
> 时间：2013-01-06T20:04:16.453
> 
> 标签：c++, pointers, vector

这可能很简单，但我找不到：

我想访问指针向量中的元素

```
 class Tile
  {
  public:
    Tile(int xPosition, int yPosition, float tileWeight);
    float getValue() const {return value;};
    void setValue(float newValue) {value = newValue;};
    int getXPos() const {return xPos;};
    int getYPos() const {return yPos;};
    void setXPos(int newPos) {xPos = newPos;};
    void setYPos(int newPos) {yPos = newPos;}

  private:
    int xPos;
    int yPos;
    float value;
  };

class Enemy : public Tile
  {
  public:
    Enemy(int xPosition, int yPosition, float strength);
  }; 
```

在另一个班级

```
std::vector<Enemy*> enemies;
enemies = myWorld->getEnemies(5); 
```

我如何才能访问另一个类中第一个成员的值我似乎无法在另一个类中访问它

```
MySquare::movePlayer(std::vector <int> directions, std::vector<Enemy*> enemies,std::vector<int*> healthPks){

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:05:51.077

例如，要`getValue`对向量中的第一项调用函数，请使用

```
enemies[0]->getValue(); 
```

# python - 在 Python 中，time() 返回的纪元时间是否总是从 1970 年 1 月 1 日开始计算？

> ID：14186179
> 
> 赞同：12
> 
> 时间：2013-01-06T20:04:36.267
> 
> 标签：python, time, epoch

Python 中的纪元开始时间是否独立于平台（即始终为 1/1/1970）？

还是依赖于平台？

我想在运行 Python 的各种机器上序列化日期时间（以秒精度），并能够在不同的平台上读回它们，可能还使用不同的编程语言（而不是 Python）。序列化纪元时间是个好主意吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-06T20:09:45.337

[文档](http://docs.python.org/2/library/time.html)说：

> 要了解时代是什么，请查看`gmtime(0)`.

我将这解释为不保证特定的时代。

另请参阅[此 Python-Dev 线程](http://grokbase.com/t/python/python-dev/086gxjdb5a/epoch-and-platform)。这似乎证实了这样一个概念，即在实践中，时代总是被假定为 1970/01/01，但语言并没有明确保证这一点。

这样做的结果是，至少对于 Python 来说，使用纪元时间可能没问题，除非你正在处理奇怪和晦涩的平台。对于使用非 Python 工具阅读，您可能还可以，但要特别确定您需要阅读这些工具提供的文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T20:06:47.487

纪元时间（unix time）是一个标准术语：

[http://en.wikipedia.org/wiki/Unix_time](http://en.wikipedia.org/wiki/Unix_time)

> Unix 时间或 POSIX 时间是用于描述时间实例的系统，定义为自 1970 年 1 月 1 日协调世界时 (UTC) 午夜以来经过的秒数，[注 1] 不包括闰秒。 [注 2 ] 它广泛用于类 Unix 和许多其他操作系统和文件格式。它既不是时间的线性表示，也不是 UTC 的真实表示。[注 3] 在某些 Unix 系统上，可以通过在命令行上键入 date +%s 来检查 Unix 时间

这意味着如果您通过 Python 使用纪元时间，它将跨平台保持一致。保持一致性的最佳选择是在所有情况下都使用 UTC。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T20:08:12.797

`time()`总是会从纪元返回时间，请查看[文档](http://docs.python.org/2/library/time.html#time.time)。

请注意，Epoch 始终是自 1970 年以来的秒数，但由于不同机器上的时钟不一样 - 您可能会遇到一些问题。

引文：

> 纪元是时间开始的点。当年 1 月 1 日，0 时，“自纪元以来的时间”为零。对于 Unix，纪元是 1970。要找出纪元是什么，请查看 gmtime(0)。

和：

> time.time()¶
> 
> 以浮点数形式返回自纪元以来的时间（以秒为单位）。请注意，尽管时间始终以浮点数形式返回，但并非所有系统都提供比 1 秒更好的时间精度。虽然此函数通常返回非递减值，但如果系统时钟已在两次调用之间调回，则它可以返回比先前调用更低的值。

（均来自 Python 文档）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-07T21:11:38.187

[Micropython 的](http://www.micropython.org/)时代是 2000 年 1 月 1 日，见[time()](http://docs.micropython.org/en/latest/wipy/library/time.html#time.time)和[utime](https://docs.micropython.org/en/latest/pyboard/library/utime.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-14T15:59:10.660

在 Python pandas.to_datetime() 中，虽然默认值为 unix epoch origin，但您可以通过提供自定义参考时间戳来更改它。

例如，

```
pd.to_datetime(18081) #default unix epoch
Out: Timestamp('1970-01-01 00:00:00.000018081') #default is in nanosecond

pd.to_datetime(18081, unit='D')
Out: Timestamp('2019-07-04 00:00:00') #change unit of measure 
```

您可以将其更改为任何参考日期。确保单位合理。在下面的示例中，我们将原点设置为 1960 年 1 月 1 日。请注意，这是默认的 SAS 日期开始日期。

```
pd.to_datetime(18081, unit='D',  origin='1960-1-1') #change to your reference start date
Out: Timestamp('2009-07-03 00:00:00') 
```

# jquery - 调整大小 JQuery 对话框

> ID：14186180
> 
> 赞同：0
> 
> 时间：2013-01-06T20:04:37.373
> 
> 标签：jquery

我在 JQuery 中有一个对话框，我用这个脚本调用它：

```
$(function() {
        $( "#dialog" ).dialog({
            autoOpen: false,
        });

        $( "#newaircraft" ).click(function() {
            $( "#dialog" ).dialog( "open" );
            return false;
        });
    }); 
```

大的是完美的，但宽度并不有趣。我不知道为什么，因为我认为它是自动的，但只有大的是自动宽度没有。

示例屏幕：http: [//i50.tinypic.com/dwt7ur.png](http://i50.tinypic.com/dwt7ur.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:08:15.727

尝试：

```
$( "#dialog" ).dialog({
    autoOpen: false,
    width: 500
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:08:16.560

使用 CSS 设置对话框的高度和宽度：

例子 ：

```
#dialog{
   height:500px;
   width:500px;
} 
```

或者

```
#dialog{
   height:90%;
   width:90%;
} 
```

或使用JQueryUI 对话框小部件的`height`和选项：`width`

[http://api.jqueryui.com/dialog/#option-height](http://api.jqueryui.com/dialog/#option-height)

[http://api.jqueryui.com/dialog/#option-width](http://api.jqueryui.com/dialog/#option-width)

# vb.net - VB.NET：无法将 Excel 加载到 Windows 窗体上的 WebBrowser

> ID：14186185
> 
> 赞同：0
> 
> 时间：2013-01-06T20:05:15.720
> 
> 标签：vb.net, visual-studio-2010, excel

我正在使用以下代码将 Excel 工作表加载到 Windows 窗体上的 WebBrowser 控件中，并且导航中的 msgbox 会触发，但工作表在 WebBrowser 中不可见。此外， Navigated2 也无济于事。有什么东西不见了吗？

仅供参考：正在声明对项目的以下引用：

```
Microsoft Office 14.0 Object Library
Microsoft Excel 14.0 Object Library
Microsoft Internet Controls
Microsoft Common Dialog Control 6.0 (SP6) 
```

* * *

```
Imports Office = Microsoft.Office.Core
Imports Excel = Microsoft.Office.Interop.Excel

Public Class Form1
    Dim oDocument As Object
    Private xlAPP As New Excel.Application
    Private xlWBook As Excel.Workbook

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        ' Create new Application.

        Dim filename As String = Nothing
        With OpenFileDialog1
            .CheckFileExists = True
            .ShowReadOnly = True
            .Filter = "Excel files *.xlsx|*.xlsx"
            If .ShowDialog = Windows.Forms.DialogResult.OK Then
                'Load file
                filename = .FileName
            End If
        End With

        With xlAPP
            .Visible = False
            xlWBook = .Workbooks.Open(filename)
            xlWBook.Activate()

        End With

        Me.WebBrowser1.Navigate(xlWBook.FullName)

    End Sub

    Private Sub WebBrowser1_Navigated(ByVal pDisp As Object, URL As Object) Handles WebBrowser1.Navigated
        MsgBox("NavigateComplete Event")
        On Error Resume Next
        oDocument = pDisp.Document

    End Sub
    Private Sub WebBrowser1_DocumentCompleted(ByVal sender As Object, ByVal e As System.Windows.Forms.WebBrowserDocumentCompletedEventArgs) Handles WebBrowser1.DocumentCompleted

        With xlAPP.CommandBars("Standard")
            .Visible = True

        End With
    End Sub

End Class 
```

# android - 布局不正确

> ID：14186187
> 
> 赞同：0
> 
> 时间：2013-01-06T20:05:35.193
> 
> 标签：android, android-fragments, layout-inflater

当我运行我的应用程序时，我收到此错误：

```
01-06 15:00:42.865: E/AndroidRuntime(24230): FATAL EXCEPTION: main
01-06 15:00:42.865: E/AndroidRuntime(24230): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.fotolife.app/com.fotolife.app.MainView}: android.view.InflateException: Binary XML file line #8: Error inflating class com.google.android.maps.MapView
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2100)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2125)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.app.ActivityThread.access$600(ActivityThread.java:140)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1227)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.os.Looper.loop(Looper.java:137)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.app.ActivityThread.main(ActivityThread.java:4898)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at java.lang.reflect.Method.invokeNative(Native Method)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at java.lang.reflect.Method.invoke(Method.java:511)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1008)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:775)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at dalvik.system.NativeStart.main(Native Method)
01-06 15:00:42.865: E/AndroidRuntime(24230): Caused by: android.view.InflateException: Binary XML file line #8: Error inflating class com.google.android.maps.MapView
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.view.LayoutInflater.createView(LayoutInflater.java:613)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:687)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at com.fotolife.app.Map.onCreateView(Map.java:12)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:871)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1083)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:635)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1431)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.support.v4.app.FragmentActivity.onStart(FragmentActivity.java:523)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1178)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.app.Activity.performStart(Activity.java:5201)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2073)
01-06 15:00:42.865: E/AndroidRuntime(24230):    ... 11 more
01-06 15:00:42.865: E/AndroidRuntime(24230): Caused by: java.lang.reflect.InvocationTargetException
01-06 15:00:42.865: E/AndroidRuntime(24230):    at java.lang.reflect.Constructor.constructNative(Native Method)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at android.view.LayoutInflater.createView(LayoutInflater.java:587)
01-06 15:00:42.865: E/AndroidRuntime(24230):    ... 24 more
01-06 15:00:42.865: E/AndroidRuntime(24230): Caused by: java.lang.IllegalArgumentException: MapViews can only be created inside instances of MapActivity.
01-06 15:00:42.865: E/AndroidRuntime(24230):    at com.google.android.maps.MapView.<init>(MapView.java:291)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at com.google.android.maps.MapView.<init>(MapView.java:264)
01-06 15:00:42.865: E/AndroidRuntime(24230):    at com.google.android.maps.MapView.<init>(MapView.java:247)
01-06 15:00:42.865: E/AndroidRuntime(24230):    ... 27 more 
```

它说这个文件的第 12 行有错误：

```
package com.fotolife.app;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

public class Map extends Fragment {

    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        return inflater.inflate(R.layout.map, container, false);
    }

} 
```

第 12 行是：return inflater.inflate .....

这是片段应该膨胀的xml文件：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <com.google.android.maps.MapView
        android:layout_width="match_parent" 
        android:layout_height="match_parent"
        android:enabled="true"
        android:clickable="true"
        android:apiKey="@string/maps_api_key"
        />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:12:59.937

这是你的错误：

`01-06 15:00:42.865: E/AndroidRuntime(24230): Caused by: java.lang.IllegalArgumentException: MapViews can only be created inside instances of MapActivity.`

您不能`MapView`与片段一起使用，因为要使用片段，您的 Activity 需要是`Activity`(v11+) 或的子类`FragmentActivity`，但要使用`MapView`您的 Activity 必须是`MapActivity`.

如果您想同时使用地图和片段，则需要使用包含( [v11](https://developer.android.com/google/play-services/maps.html)[`MapFragment`](http://developer.android.com/reference/com/google/android/gms/maps/MapFragment.html) +) 或[`SupportMapFragment`](http://developer.android.com/reference/com/google/android/gms/maps/SupportMapFragment.html).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:10:21.347

我以前从未使用过 Google Maps Android API，但查看您的堆栈跟踪：

```
01-06 15:00:42.865: E/AndroidRuntime(24230): Caused by: java.lang.IllegalArgumentException: MapViews can only be created inside instances of MapActivity. 
```

您的活动需要扩展`MapActivity`。如果您想使用片段，也许您应该使用新的 V2 API。[https://developers.google.com/maps/documentation/android/](https://developers.google.com/maps/documentation/android/)

由于您的布局仅包含 a `MapView`，您是否考虑过使用 a`SupportMapFragment`代替：

```
<fragment
    class="com.google.android.gms.maps.SupportMapFragment"
    android:layout_width="match_parent"
    android:layout_height="match_parent"/> 
```

或者

```
SupportMapFragment f = new SupportMapFragment();
getSupportFragmentManager().beingTransaction()
    .add(android.R.id.content, f)
    .commit(); 
```

请参阅文档：[https ://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/SupportMapFragment](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/SupportMapFragment)

# ios - iOS App：免费 -> InApp 订阅模式

> ID：14186190
> 
> 赞同：-1
> 
> 时间：2013-01-06T20:05:56.683
> 
> 标签：ios, in-app-purchase

我有一个问题，我想知道他们是否有过类似的经历。我们正在完成一个只需要实现 InApp Purchase 的应用程序。

我的问题：如果我们发送具有免费功能的应用程序，在审核过程中我们会添加按钮和高级功能，然后我们会更新支付功能。苹果会拒绝更新吗？

这个想法是利用审查时间结束高级功能，然后发布具有所有功能（免费和高级）的最终版本。你怎么看？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:59:25.753

Apple 没有理由拒绝您的应用在更新中添加付费高级功能。但是，您必须等待第一个版本发布，然后才能提交更新供 Apple 审核。

但是，如果一直使用这些功能的人在安装更新后突然发现自己被锁定，那么将免费功能转换为付费功能似乎会出现问题。

# objective-c - 一个uibutton可以同时有一个outlet和一个action吗？

> ID：14186197
> 
> 赞同：0
> 
> 时间：2013-01-06T20:06:50.520
> 
> 标签：objective-c, uibutton, action, outlet

我有 2`UIButtons`个使用 switch 语句更改其文本标签（仅出于测试目的做了第一种情况）：

```
switch (_itemNumber)
{
    case 0:
        [_phoneButton setTitle:@"201-612-5480" forState:UIControlStateNormal];
        [_emailButton setTitle:@"aacenter@bergen.edu" forState:UIControlStateNormal];
        self.title = @"Acdmc. Adv. Center";
        break;

    default:
        break;
} 
```

因此，当`UIButton`按下 时，将执行一个操作：

```
- (IBAction)phoneButtonAction:(id)sender {
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:[NSString stringWithFormat:@"tel://%@",_emailButton.titleLabel.text]]];
}

- (IBAction)emailButtonAction:(id)sender {
    [[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"mailto://devprograms@apple.com"]];
} 
```

更改文本标签有效，但不是操作。是因为每个人只能有一个出口或一个动作`UIButton`吗？如果是这样，我怎样才能设法执行所需的操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:17:07.880

**和URL 方案在模拟器`mailto:`上`tel:`不起作用。只有设备。**

*以前的：*

您是否向 UIButtons 添加了任何操作？

```
[_phoneButton addTarget:self
                 action:@selector(phoneButtonAction:)
       forControlEvents:UIControlEventTouchUpInside];
[_phoneButton addTarget:self
                 action:@selector(emailButtonAction:)
       forControlEvents:UIControlEventTouchUpInside]; 
```

# java - Eclipse 未启动：JVM 已终止。退出代码=14

> ID：14186198
> 
> 赞同：2
> 
> 时间：2013-01-06T20:06:52.080
> 
> 标签：java, eclipse, jvm, openjdk, jvm-crash

尝试搜索修复无法找到一个！我正在运行 Fedora 17：

Eclipse(juno) 版本

```
eclipse-platform.x86_64                   1:4.2.1-2.fc17 
```

A`which java`产量

```
/usr/bin/java 
```

所以日食使用的是正确的。

A`java -version`产量

```
 java version "1.7.0_09-icedtea"
OpenJDK Runtime Environment (fedora-2.3.3.2.fc17-x86_64)
OpenJDK 64-Bit Server VM (build 23.2-b09, mixed mode) 
```

[Eclipse/安装](http://wiki.eclipse.org/Eclipse/Installation#Eclipse_4.2_.28Juno.29)页面说： Java *6 JRE/JDK 推荐用于 Eclipse 4.2。*
我需要降级吗？

* * *

*我见过这个问题：*

[尝试启动 Eclipse 时，JVM 以退出代码 14 终止](https://stackoverflow.com/questions/11426996/jvm-terminates-with-exit-code-14-when-trying-to-launch-eclipse)

但我的配置似乎是正确的。

* * *

有任何想法吗？

`eclipse.ini`（路径`/etc/eclipse.ini`） 的内容：

```
-preventMasterEclipseLaunch
-startup
plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.library
plugins/org.eclipse.equinox.launcher.gtk.linux.x86_64_1.1.200.v20120522-1813
-showsplash
org.eclipse.platform
--launcher.XXMaxPermSize
256m
--launcher.defaultAction
openFile
-vmargs
-Xms128m
-Xmx512m
-Dorg.eclipse.equinox.p2.reconciler.dropins.directory=//usr/share/eclipse/dropins

-Dorg.eclipse.swt.browser.UseWebKitGTK=true
-Dhelp.lucene.tokenizer=standard
-XX:CompileCommand=exclude,org/eclipse/core/internal/dtree/DataTreeNode,forwardDeltaWith
-XX:CompileCommand=exclude,org/eclipse/jdt/internal/compiler/lookup/ParameterizedMethodBinding,
-XX:CompileCommand=exclude,org/eclipse/cdt/internal/core/dom/parser/cpp/semantics/CPPTemplates,instantiateTemplate
-XX:CompileCommand=exclude,org/eclipse/cdt/internal/core/pdom/dom/cpp/PDOMCPPLinkage,addBinding
-XX:CompileCommand=exclude,org/python/pydev/editor/codecompletion/revisited/PythonPathHelper,isValidSourceFile
-XX:CompileCommand=exclude,org/python/pydev/ui/filetypes/FileTypesPreferencesPage,getDottedValidSourceFiles 
```

这是完整的错误信息

```
JVM terminated. Exit code=14
/usr/bin/java
-Xms128m
-Xmx512m
-Dorg.eclipse.equinox.p2.reconciler.dropins.directory=//usr/share/eclipse/dropins
-Dorg.eclipse.swt.browser.UseWebKitGTK=true
-Dhelp.lucene.tokenizer=standard
-XX:CompileCommand=exclude,org/eclipse/core/internal/dtree/DataTreeNode,forwardDeltaWith
-XX:CompileCommand=exclude,org/eclipse/jdt/internal/compiler/lookup/ParameterizedMethodBinding,
-XX:CompileCommand=exclude,org/eclipse/cdt/internal/core/dom/parser/cpp/semantics/CPPTemplates,instantiateTemplate
-XX:CompileCommand=exclude,org/eclipse/cdt/internal/core/pdom/dom/cpp/PDOMCPPLinkage,addBinding
-XX:CompileCommand=exclude,org/python/pydev/editor/codecompletion/revisited/PythonPathHelper,isValidSourceFile
-XX:CompileCommand=exclude,org/python/pydev/ui/filetypes/FileTypesPreferencesPage,getDottedValidSourceFiles
-XX:MaxPermSize=256m
-jar /usr/lib64/eclipse//plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
-os linux
-ws gtk
-arch x86_64
-showsplash /usr/lib64/eclipse//plugins/org.eclipse.platform_4.2.1.v20120814-120055/splash.bmp
-launcher /usr/lib64/eclipse/eclipse
-name Eclipse
--launcher.library /usr/lib64/eclipse//plugins/org.eclipse.equinox.launcher.gtk.linux.x86_64_1.1.200.v20120522-1813/eclipse_1503.so
-startup /usr/lib64/eclipse//plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar
--launcher.overrideVmargs
-exitdata 1f40006
-preventMasterEclipseLaunch
-vm /usr/bin/java
-vmargs
-Xms128m
-Xmx512m
-Dorg.eclipse.equinox.p2.reconciler.dropins.directory=//usr/share/eclipse/dropins
-Dorg.eclipse.swt.browser.UseWebKitGTK=true
-Dhelp.lucene.tokenizer=standard
-XX:CompileCommand=exclude,org/eclipse/core/internal/dtree/DataTreeNode,forwardDeltaWith
-XX:CompileCommand=exclude,org/eclipse/jdt/internal/compiler/lookup/ParameterizedMethodBinding,
-XX:CompileCommand=exclude,org/eclipse/cdt/internal/core/dom/parser/cpp/semantics/CPPTemplates,instantiateTemplate
-XX:CompileCommand=exclude,org/eclipse/cdt/internal/core/pdom/dom/cpp/PDOMCPPLinkage,addBinding
-XX:CompileCommand=exclude,org/python/pydev/editor/codecompletion/revisited/PythonPathHelper,isValidSourceFile
-XX:CompileCommand=exclude,org/python/pydev/ui/filetypes/FileTypesPreferencesPage,getDottedValidSourceFiles
-XX:MaxPermSize=256m
-jar /usr/lib64/eclipse//plugins/org.eclipse.equinox.launcher_1.3.0.v20120522-1813.jar 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T20:32:59.547

这就是解决问题的方法：

凭直觉（我在网上看到的所有.ini文件都没有第一行。第一行涉及的单词的含义（英文）似乎很奇怪），我删除了第一行

```
-preventMasterEclipseLaunch 
```

日食似乎正在工作！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-20T10:03:52.740

首先，很抱歉我引入这个标志造成的所有麻烦，但是......如果你想以 root 身份启动 Eclipse，你应该真正知道你在做什么，因为：

*   Eclipse 是一个基于插件的应用程序，无论如何都会运行所有插件。使用 IDE 以 root 身份工作通常不是一个好主意。
*   Eclipse 在根文件系统中写入了很多配置细节——您的安装不再可以通过 RPM 验证，Eclipse 安装实际上被破坏了——取决于您安装的内容，您可能无法安装任何其他 Eclipse 插件。

# java - 两个 JPanel 之间的通信

> ID：14186199
> 
> 赞同：6
> 
> 时间：2013-01-06T20:06:51.873
> 
> 标签：java, swing, jpanel, communication

我有这个带有 BorderLayout 的“主”面板（我们称之为**AAA**）和两个面板（**BBB**和**CCC**）：

```
public class AAA extends JPanel {
    BBB pnlNorth = new BBB();
    CCC pnlCenter = new CCC();
    public AAA(){
        setLayout(new BorderLayout());
        add(pnlNorth,BorderLayout.NORTH);
        add(pnlCenter,BorderLayout.CENTER);        
    }
} 
```

Panel **CCC**目前为空，带有 GridLayout。

我的面板**BBB**如下所示：

```
public class BBB extends JPanel {
    public BBB (){
        JLabel labNum = new JLabel("Number of items: ");
        JTextField txtNum = new JTextField();
        JButton cmdOK = new JButton("OK");
        txtNum.setColumns(5);
        cmdOK.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                /* ???????????? */
            }
        });
        add(labNum);
        add(txtNum);
        add(cmdOK);        
    }
} 
```

当用户在 txtNum 中输入一个数字并按“确定”时，面板**CCC**应填充适当数量的数据输入行。每行应包含两个文本字段、两个下拉列表和一个复选框。如果用户输入一些较大的数字，如果所有项目都在 JScrollPane 中，那就太好了。

**我的问题：我应该如何在****BBB**中实现动作监听器？我不知道用户将输入什么数字。因此，我不知道**CCC**的 GridLayout 中的确切行数（我只知道它应该有 5 列）。我可以从**BBB**中的侦听器修改其布局吗？以及如何从面板**BBB**中的侦听器向面板**CCC**添加组件？

 **当然，如果您有更好的解决方案（没有两个单独的面板），请告诉我 :)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T20:23:53.263

你可能想错了。最好不要考虑两个正在通信的*JPanel*，而是更简单地考虑两个*对象*它们正在通信，它们将像任何其他两个对象一样进行通信——通过影响状态的方法。该信息可以通过让一个对象调用另一个对象的方法并将其信息发布给它来从一个对象推送到另一个对象，或者可以通过使用观察者设计模式将其从一个对象拉到另一个对象，例如可以实现与可用的各种侦听器之一。我自己，我喜欢为此使用 PropertyChangeListener。因此，被观察对象将接受在其状态发生更改后收到通知的侦听器，然后这些观察者将调用被观察对象的公共方法以提取更改的信息。

例如，请查看[此答案](https://stackoverflow.com/a/4691447/522444)中的代码，或者甚至更好地[查看此问题的答案](https://stackoverflow.com/questions/7053283/sending-messages-between-two-jpanel-objects)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:59:24.373

我设法做到了。我只是在 North 面板的构造函数中将 Center 面板作为参数传递。它完美地工作。谢谢大家的回答:)**

# javascript - jQuery Autocomplete：如何禁止自由文本，并显示必须选择列表中的项目的错误？

> ID：14186205
> 
> 赞同：0
> 
> 时间：2013-01-06T20:07:21.593
> 
> 标签：javascript, forms, jquery-ui

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:27:52.233

我认为您可以使用`change`事件并检查是否`ui.item`为空，然后您可以将输入设为空并显示警报或自定义消息，例如（只是一个想法）

```
change: function( event, ui ) {
    if(ui.item==null) 
    {
        this.value='';
        alert('Please select a value from the list'); // or a custom message
    }
} 
```

[**演示**](http://jsfiddle.net/HKzL7/3/)。

**更新：如果值已更改，则在字段模糊时触发** [更改](http://api.jqueryui.com/autocomplete/#event-change)事件。

# ruby-on-rails - 使用 will_paginate 进行不区分大小写的搜索

> ID：14186206
> 
> 赞同：0
> 
> 时间：2013-01-06T20:07:26.140
> 
> 标签：ruby-on-rails, search, will-paginate, case-insensitive

我是 Ruby 新手，所以如果这是一个愚蠢的问题，我深表歉意。我正在尝试将 will_paginate 与搜索字段一起使用，并且无法使其不区分大小写。谢谢你的帮助！

来自 rating_controller.rb：

```
def index
    @ratings_by_name = Rating.paginate(:order => 'name ASC', :page => params[:page], :per_page =>10, :conditions => ['name like ?', "%#{params[:search]}%"])
    @ratings_by_score = Rating.paginate(:order => 'score DESC', :page => params[:page], :per_page =>10, :conditions => ['name like ?', "%#{params[:search]}%"])

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @ratings_by_name }
    end
  end 
```

来自 index.html.erb：

```
<div class="tabbable">
  <ul class="nav nav-pills">
    <li class="active"><a href="#tab1" data-toggle="tab">By Name</a></li>
    <li><a href="#tab2" data-toggle="tab">By Score</a></li>
    <li><form class="navbar-search">
      <input type="text" class="search-query span3" placeholder="Search" name="search">
      <div class="icon-search"></div>
     </form></li>
  </ul>
  <div class="tab-content">
    <div class="tab-pane active" id="tab1">
      <% @ratings_by_name.each do |rating| %>
      <div class="rating">
        <div class="row">
          <div class="span7">
            <strong><%= rating.name %></strong>
            <div class="meta">
                | <%= link_to 'View', rating %> | 
              <span class="admin">
                <%= link_to 'Edit', edit_rating_path(rating) %> | 
              </span>
              Rated on <%= rating.when_rated %>
            </div>
          </div>
          <div class="span1">
            <%= rating.score %>
          </div>
        </div>
      </div>
      <% end %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-27T10:10:25.810

尝试对订单使用“LOWER(name)”

```
@ratings_by_name = Rating.paginate(:order => 'LOWER(name) ASC', :page => params[:page], :per_page =>10, :conditions => ['name like ?', "%#{params[:search]}%"]) 
```

# javascript - 三.Raycaster 在 position.set() 之后与原始网格位置相交

> ID：14186209
> 
> 赞同：2
> 
> 时间：2013-01-06T20:07:36.563
> 
> 标签：javascript, three.js, raycasting

使用 Three.js，当我使用 position.set() 定位对象时，THREE.Raycaster 似乎不知道对象的新设置位置。如果我将对象留在 0,0,0 处，则网格会正确相交。

```
function init(){
var targets = [];
var object;
// More scene initializing code...

// creating a cube object and placing it at (-10,0,-10)
    var objectGeometry = new THREE.CubeGeometry(2,2,2);
    var objectMaterial = new THREE.PhongMeshMaterial({color: 0xEEEEEE });
    object = new THREE.Mesh(objectGeometry, objectMaterial);
    object.position.set(-10, 0, -10);
    scene.add(object);
    targets.push(object);

// more objects created and added to the scene

} 
```

我有一个角色控制器，我可以用跟随的相机四处移动，因此我将角色 (obj) 和目标插入到函数 testRay() 中进行测试；

```
function testRay(obj,targets,distance){
// code to keep the ray pointing out in front of the character at all times
    var endRayX = (Math.cos((270*(Math.PI/180))-obj.rotation.y)*distance + obj.position.x);
    var endRayZ = (Math.sin((270*(Math.PI/180))-obj.rotation.y)*distance + obj.position.z);
    var vector = new THREE.Vector3(endRayX,obj.position.y,endRayZ);
    var raycaster = new THREE.Raycaster(obj.positon,vector);
    intersects = raycaster.intersectObjects(targets);
    if(intersects.length>0){
        console.log("intersects.length: "+ intersects.length);
        console.log("intersects.distance: "+ intersects[0].distance);
        console.log("intersects.face: "+ intersects[0].face);
        console.log("intersects.point: " + intersects[0].point);
        console.log("intersects.object: " + intersects[0].object);
    }
} 
```

然后每次 requestAnimationFrame(main) 调用，我 testRay() 插入角色控制器和目标以查看它是否相交。

```
function main(){
    // some other code
    testRay(character,targets,30)
    window.requestAnimationFrame(main);
} 
```

好的，所以问题不是让它相交，这很好用。在创建期间使用 position.set() 后，它与对象的新位置相交。我注意到我可以简单地通过相交来移动对象，这似乎也移动了相交坐标。将对象添加到场景后移动会更好吗？有区别吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-01-11T23:29:29.740

这个问题有点老了，但也许这会对某人有所帮助：我遇到了类似的问题。似乎three.js 使用对象世界变换矩阵进行光线相交，并且根据您的操作顺序，这可能在调用之后`position.set();`和之前没有更新。`raycaster.intersectObject();`我相信当对象在场景中渲染时，这是由三个人自动完成的，但在我的情况下，对象实际上并不在场景中。我所要做的就是 `object.updateMatrixWorld()`在进行光线投射之前打电话。

# c# - 使用 FormatConvertedBitmap 从 Pbgra32 转换为 Bgr32 PixelFormats

> ID：14186219
> 
> 赞同：4
> 
> 时间：2013-01-06T20:08:43.910
> 
> 标签：c#, wpf, writeablebitmap, writeablebitmapex

我无法理解如何`FormatConvertedBitmap`将`WriteableBitmap`我拥有的a 转换`Pbgra32`为`Bgr32`. 我正在构建的应用程序最初使用 Bgr32，我介绍了`WriteableBitmapEx`（使用 Pbgra32）来翻转图像。现在，我需要从`Pbgra32`back 转换为`Bgr32`以保持与程序其余部分的一致性。以下是我所拥有的：

```
FormatConvertedBitmap newFormat = new FormatConvertedBitmap(this.colorBitmap, PixelFormats.Bgr32, null, 0); 
```

...我认为这对于进行转换是正确的。但是，我不确定如何从中检索 WriteableBitmap。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-30T02:25:33.443

您走在正确的轨道上，您只需将其转换为 a`WriteableBitmap`即可将其存储为一个。为此，您必须将其转换为`BitmapSource`first 并创建一个新的`WriteableBitmap`. 所以是这样的：

```
WriteableBitmap yourConvertedPicture = new WriteableBitmap(
   (BitmapSource)(new FormatConvertedBitmap(thePictureToConvert, PixelFormats.Bgr32, null, 0))
); 
```

这也适用于转换为任何其他`PixelFormat`

# mysql - 我可以使用 mysql 连接到 SQL Server 吗？

> ID：14186224
> 
> 赞同：4
> 
> 时间：2013-01-06T20:09:10.630
> 
> 标签：mysql, sql-server

我正在使用从[http://dev.mysql.com/doc/refman/5.5/en/mysql.html](http://dev.mysql.com/doc/refman/5.5/en/mysql.html)下载的 mysql 命令行工具- 我已启用远程连接到 SQL Server，但我无法使用它连接到它。我只是想知道是不是因为 mysql 客户端与 SQL Server 不兼容？如果不是，我可以在 OS X 或 ubuntu 上使用任何客户端吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T20:17:56.190

不，您不能使用 MySQL 连接到 MSSQL。

您必须使用专门为理解 MSSQL 协议而创建的客户端。Linux 上最流行的解决方案之一是[FreeTDS](http://www.freetds.org/)。

此外，您可以使用Microsoft 提供的[ODBC](https://docs.microsoft.com/en-us/sql/connect/odbc/linux-mac/installing-the-microsoft-odbc-driver-for-sql-server)或[JDBC驱动程序。](https://docs.microsoft.com/en-us/sql/connect/jdbc/download-microsoft-jdbc-driver-for-sql-server)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:17:52.583

你可以试试 SQuirreL SQL 客户端。它是用 Java 编写的，因此它应该在 Linux 和 Mac 上运行，并且它可以连接到 SQL 服务器以及基本上任何具有 JDBC 驱动程序的数据库服务器。

[http://squirrel-sql.sourceforge.net/](http://squirrel-sql.sourceforge.net/)

您可能需要从 Microsoft 单独下载 JDBC 驱动程序。

# jquery - 检索 XML 数据 - 改进我的方法

> ID：14186227
> 
> 赞同：0
> 
> 时间：2013-01-06T20:09:29.227
> 
> 标签：jquery

我正在检索谷歌标记的 xml 数据，但是我也想要标记计数，所以我这样做了。

```
<markers>
<results count="6" />
<marker id="1" lat="48.153938" lng="17.108459" icon_type="redicon" />
<marker id="2" lat="48.152657" lng="17.127541" icon_type="redicon" />
<marker id="3" lat="48.147572" lng="17.108433" icon_type="redicon" />
<marker id="14" lat="48.153938" lng="17.108459" icon_type="redicon" />
<marker id="15" lat="48.148170" lng="17.105650" icon_type="redicon" />
<marker id="16" lat="48.148170" lng="17.105650" icon_type="redicon" />
</markers> 
```

现在，我的标记检索这样的帖子数据，效果很好：

```
success: function (data, status, jqXHR) {

var markers = xml.documentElement.getElementsByTagName("marker");

for (var i = 0; i < markers.length; i++) {
//lalalalala 
```

然后我想检索计数，所以我这样做了：

```
success: function (data, status, jqXHR) {

$(data).find('markers').each(function(){
        var $entry = $(this);
        var pic = $entry.find('results').attr('count');
        $("#results").html(pic);
})

var xml = jqXHR.responseXML;
var markers = xml.documentElement.getElementsByTagName("marker");

for (var i = 0; i < markers.length; i++) {
//lalala 
```

但是我相信有更好的方法。有没有办法将我在第一个实例中所做的与标记相结合来获得计数？我只想降低代码的复杂性。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:11:29.220

也许在 for 循环中执行它，并遍历**标记**标记。

我在 JSFiddle 上有一个这样的例子：http: [//jsfiddle.net/3LyLR/](http://jsfiddle.net/3LyLR/)

```
var markers = xml.documentElement.getElementsByTagName("markers");

for (var i = 0; i < markers.length; i++) {

var currmarker = markers[i]
var markercount = currmarker.getElementsByTagName("results")[0].getAttribute("count");
//and whatever else you want to do

} 
```

# html - Jquery 网络摄像头问题在页面上显示网络摄像头

> ID：14186230
> 
> 赞同：1
> 
> 时间：2013-01-06T20:09:36.220
> 
> 标签：html, jquery-plugins

我正在尝试让页面上的网络摄像头捕捉照片，我正在使用[jquery web 插件](http://www.xarg.org/project/jquery-webcam-plugin/)。我在 Web 控制台中收到以下错误：[16:00:48.593] TypeError: $(...).webcam is not a function......

**html:**

```
 <head>

    <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script> --> 

    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.0/themes/base/jquery-ui.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.js"></script>
    <script src="http://code.jquery.com/ui/1.9.0/jquery-ui.js"></script>

    <style>
        <%@ include file="../css/forms.css" %>
        <%@ include file="../css/citizen_registration.css" %>
        <%@ include file="../js/jQuery-webcam/jquery.webcam.js" %>

    </style>

    <script type="text/javascript">

    $(document).ready(function(){

        $("#camera").webcam({
                width: 320,
                height: 240,
                mode: "callback",
                swffile: "../js/jQuery-webcam/jscam_canvas_only.swf",    

                onLoad: function() {
                alert('HELLO');

                }

        }); 
 });

    <div id="camera"></div> 
```

# java - 实例的局部变量/方法的范围是什么

> ID：14186239
> 
> 赞同：2
> 
> 时间：2013-01-06T20:10:17.347
> 
> 标签：java, scope

我正在测试下面的代码片段，我需要知道如何访问 tx 或 t.hello？它的范围是什么？开发人员是否以这种方式定义变量？

```
public class Test{

public Test(){
    System.out.print("constructor\n");
}

public static void main(String[] args) {

    Test t = new Test(){
        int x = 0;
        //System.out.print("" + x);
        void hello(){
            System.out.print("inside hello\n");
        }
    };
} 
```

**编辑**

但是为什么这个片段有效

```
 Thread  tr = new Thread() {
int loops = 1;

 @Override
 public void run() {
    loops += 1;
}
};
tr.start(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:36:14.677

你应该区分声明和定义。

在您的情况下，您声明一个类变量`Test`并将其分配给某个派生自`Test`（它是一个匿名类）的类的对象，其中包含一些额外的东西。

这个定义之后的代码只看到`t`类`Test`，它一无所知`x`，`hello`因为`Test`没有它们。

因此，除了反射之外，您不能在定义匿名类之后使用`x`和。`hello`是的，当开发人员在定义中需要这些变量时，他们会使用这些变量。

有人提到，您可以`Test`在定义后立即调用不属于其中的方法和访问变量：

```
int y = new Test(){
    int x = 0;
    //System.out.print("" + x);
    void hello(){
        System.out.print("inside hello\n");
    }
}.x; 
```

可以这样做，因为此时对象的类型是已知的（它是匿名类）。一旦将此对象分配给`Test t`，您就会丢失此信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:16:50.790

您的代码创建了一个[*匿名内部类*](http://docs.oracle.com/javase/tutorial/java/javaOO/innerclasses.html)。它（或多或少）相当于这样做：

```
public class Test {
    // ...
    private class TestAnonymousInner extends Test {
        int x = 0;
        //System.out.print("" + x);
        void hello(){
            System.out.print("inside hello\n");
        }
    }

    public static void main(String[] args) {
        Test t = new TestAnonymousInner();
        // invalid:
        // t.hello(); 
    }
} 
```

如果您查看该文件的编译器输出，您会注意到一个名为类似的文件`Test$1.class`——这就是您定义的匿名类。

由于您存储实例的变量是 type `Test`，因此无法通过它访问字段。它们可以通过反射或构造函数表达式访问。例如[以下作品](http://ideone.com/gsbZJo)，虽然它不是特别有用：

```
new Test() {
    void hello() {
        System.out.println("hello()");
    }
}.hello(); // should print "hello()" 
```

回复：您的编辑。`start()`是一种方法`Thread`。变量`tr`也是 type `Thread`，所以你可以调用它的方法。只是不是您在 AIC 中添加的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T20:32:16.240

它创建了一个匿名内部类。在这种情况下，它几乎没有用。匿名类通常用于在不创建全新类的情况下实现接口。当您这样做时，您可以添加任意数量的成员。例如：

```
Runnable r = new Runnable() {
    int i = 0;
    public void run() {
        System.out.println(i++);
    }
}; 
```

通过这样做，您为 Runnable 接口（没有这样的字段）的实现添加了一个计数器，并且每次调用`r.run();`递增的值时都会打印出来。

一个使用类似模式的不太人为的示例：

```
private final ExecutorService executor = Executors.newCachedThreadPool(new ThreadFactory() {
    private final AtomicInteger threadId = new AtomicInteger();

    @Override
    public Thread newThread(Runnable r) {
        return new Thread(r, "Thread #" + threadId.incrementAndGet());
    }
}); 
```

在这里，提供了 ThreadFactory 的基本实现，它为每个新的 Thread 命名`Thread #i`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T20:51:32.230

正如所写，x 和 hello 都不能在 t 引用的对象之外访问。问题是它们只在 t 的匿名类中声明。它们没有在 Test 中定义，并且不可能将 t 引用转换为声明它们的类型，因为它是匿名的。

我修改了 Test 使其抽象化，并添加了 hello 的抽象声明，允许从 t 引用的对象外部调用它。我还修改了 hello 以添加对 x 的使用。这些更改说明了访问匿名类功能的两种方式——通过基类或内部。

```
public abstract class Test {

  abstract void hello();

  public Test() {
    System.out.print("constructor\n");
  }

  public static void main(String[] args) {

    Test t = new Test() {
      int x = 0;

      // System.out.print("" + x);
      void hello() {
        System.out.print("inside hello\n");
        System.out.print("My value of x is "+x);
      }
    };
    t.hello();

  }
} 
```

# ios - UIWindow makeKeyWindow 返回一个 EXC_BAD_ACCESS

> ID：14186243
> 
> 赞同：0
> 
> 时间：2013-01-06T20:10:31.213
> 
> 标签：ios, exc-bad-access, uiwindow

```
[[[[UIApplication sharedApplication] delegate] window] makeKeyWindow]; 
```

我一直在尝试寻找另一种方法来执行此完全相同的操作，但我没有找到任何东西。发生的情况是，当它被触发时，调试器返回

> 错误：执行被中断，原因：EXC_BAD_ACCESS（代码=1，地址=0x6f6d6582）。进程已恢复到执行前的状态。

最终发生的是我的整个 UI 被冻结并且不接受任何触摸事件，因为主窗口不再是关键窗口。有人对如何解决这个问题有任何想法吗？我正在使用 David Keegan 的 KGModal 并且它`cleanup:`正在被解雇。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:09:17.473

尝试和回答。此时委托或窗口都未设置，并且指针不再引用有效对象，您无法调用它们。尝试记录委托的值，然后记录窗口以查看它们是否都连接到对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T06:40:38.087

我决定用我自己的动画来表达一些模态的东西。经过几个小时的工作，我得到了一切工作。

# c++ - 单元测试 C++。如何测试私人会员？

> ID：14186245
> 
> 赞同：52
> 
> 时间：2013-01-06T20:11:08.117
> 
> 标签：c++, unit-testing, testing

我想为我的 C++ 应用程序进行单元测试。

测试类的私有成员的正确形式是什么？创建一个可以测试私有成员、使用派生类或其他技巧的朋友类？

测试 API 使用哪种技术？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-01-06T20:40:53.960

通常，只测试问题评论中讨论的公共接口。

然而，有时测试私有或受保护的方法是有帮助的。例如，实现可能具有一些对用户隐藏的重要复杂性，并且可以通过访问非公共成员进行更精确的测试。通常最好想办法消除这种复杂性或弄清楚如何公开公开相关部分，但并非总是如此。

允许单元测试访问非公共成员的一种方法是通过[朋友](http://www.cplusplus.com/doc/tutorial/inheritance/)构造。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-06-27T06:32:52.743

回答这个问题涉及许多其他话题。除了 CleanCode、TDD 和其他方面的宗教信仰之外：

有几种方法可以访问私有成员。在任何情况下，您都必须否决经过测试的代码！这在解析 C++ 的两个级别（预处理器和语言本身）上都是可能的：

**全部定义为公开**

通过使用预处理器，您可以打破封装。

```
#define private public
#define protected public
#define class struct 
```

缺点是，**交付代码的类与测试中的不同**！第 9.2.13 章中的 C++ 标准说：

> 未指定具有不同访问控制的非静态数据成员的分配顺序。

这意味着，编译器有权为测试重新排序成员变量和虚函数。如果没有发生缓冲区溢出，您可能会感到困惑，这不会损害您的类，但这意味着您不会在交付时测试相同的代码。这意味着，如果您访问由代码初始化、编译时`private`未定义为的对象的成员，则您的成员`public`的偏移量可能会有所不同！

**朋友们**

此方法需要更改被测类以使其与测试类或测试函数成为朋友。一些测试框架，如 gtest( `FRIEND_TEST(..);`) 具有特殊的功能来支持这种访问私有事物的方式。

```
class X
{
private:
    friend class Test_X;
}; 
```

它只为测试打开课程，并没有打开世界，但您必须修改交付的代码。在我看来这是一件坏事，因为测试不应该改变被测试的代码。作为另一个缺点，它使交付代码的其他类有可能通过将自己命名为测试类来侵入您的类（这也会损害 C++ 标准的 ODR 规则）。

**声明受保护的私有事物并从类派生以进行测试**

不是一种非常优雅的方式，非常侵入性，但也可以：

```
class X
{
protected:
    int myPrivate;
};

class Test_X: public X
{
    // Now you can access the myPrivate member.
}; 
```

**使用宏的任何其他方式**

有效，但与第一种方式一样，在标准一致性方面具有相同的缺点。例如：

```
class X
{
#ifndef UNITTEST
private:
#endif
}; 
```

我认为最后两种方式都不能替代前两种方式，因为它们与第一种方式相比没有优势，但对测试代码的侵入性更大。第一种方式风险很大，所以你可以使用交友方式。

* * *

关于从不测试私人事物讨论的一些话。单元测试的好处之一是，你会很早就达到你必须改进代码设计的地步。这有时也是单元测试的缺点之一。它使面向对象有时比它必须的更复杂。特别是如果您遵循规则以与现实世界对象相同的方式设计类。

然后你有时不得不把代码改成丑陋的东西，因为单元测试方法迫使你这样做。处理用于控制物理过程的复杂框架就是一个例子。在那里，您想将代码映射到物理过程，因为过程的某些部分通常已经非常复杂。该进程的依赖关系列表有时会变得很长。这是一个可能的时刻，测试私人成员变得越来越好。您必须权衡每种方法的优缺点。

课程有时会变得复杂！然后你必须决定分开它们还是照原样接受它们。有时第二个决定更有意义。归根结底，您想要实现的目标始终是一个问题（例如，完美的设计、快速的整合时间、低开发成本……）。

* * *

**我的意见**

我访问私人成员的决策过程如下所示：

1.  您需要自己测试私人成员吗？（通常这会减少所需的测试总数）
2.  如果是，您是否看到重构该类的任何设计优势？
3.  如果不是，请在您的班级中与测试成为朋友（因为缺少替代方案而使用此测试）。

我不喜欢友好的方法，因为它改变了测试的代码，但是测试某些东西的风险可能与交付的不同（尽可能使用第一种方法），并不能证明更干净的代码是合理的。

顺便说一句：仅测试公共接口也是一个流畅的问题，因为根据我的经验，它的变化与私有实现一样频繁。所以你没有优势减少对公共成员的测试。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2013-01-06T20:54:30.777

我自己还没有找到黄金解决方案，但是`friend`如果您知道测试框架如何命名它的方法，您可以使用它来测试私有成员。我使用以下内容通过 Google 测试来测试私人成员。虽然这很好用，但请注意这是一个 hack，我不会在生产代码中使用它。

在我要测试的代码的标题（stylesheet.h）中，我有：

```
#ifndef TEST_FRIENDS
#define TEST_FRIENDS
#endif

class Stylesheet {
TEST_FRIENDS;
public:
    // ...
private:
    // ...
}; 
```

在测试中我有：

```
#include <gtest/gtest.h>

#define TEST_FRIENDS \
    friend class StylesheetTest_ParseSingleClause_Test; \
    friend class StylesheetTest_ParseMultipleClauses_Test;

#include "stylesheet.h"

TEST(StylesheetTest, ParseSingleClause) {
    // can use private members of class Stylesheet here.
} 
```

如果您添加一个访问私有成员的新测试，您总是会在 TEST_FRIENDS 中添加一个新行。这种技术的好处是它在测试代码中相当不显眼，因为您只添加了几个#defines，在不测试时它们没有效果。缺点是它在测试中有点冗长。

现在，关于您为什么要这样做的一句话。当然，理想情况下，您拥有职责明确的小类，并且这些类具有易于测试的接口。然而，在实践中，这并不总是那么容易。如果您正在编写一个库，那么您希望库的使用者能够使用什么（您的公共 API）决定了什么，而不是需要测试什么`private`。`public`您可以拥有不太可能更改的不变量，并且需要进行测试，但您的 API 的使用者不感兴趣。然后，对 API 进行黑盒测试是不够的。此外，如果您遇到错误并编写额外的测试以防止回归，则可能需要进行测试`private`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-12-13T09:38:19.213

```
Sometimes, it is required to test private methods. Testing can be done by adding FRIEND_TEST to the class.

    // Production code
    // prod.h

    #include "gtest/gtest_prod.h"
    ...   

    class ProdCode 
        {
         private:
          FRIEND_TEST(ProdTest, IsFooReturnZero);
          int Foo(void* x);
        };

    //Test.cpp
    // TestCode
    ...
    TEST(ProdTest, IsFooReturnZero) 
    {
      ProdCode ProdObj;
      EXPECT_EQ(0, ProdObj.Foo(NULL)); //Testing private member function Foo()

    }

Adding more info, since many are not aware of gtest features.
This is from gtest/gtest_prod.h

https://github.com/google/googletest/blob/master/googletest/include/gtest/gtest_prod.h

// Copyright 2006, Google Inc.
// All rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are
// met:
//
//     * Redistributions of source code must retain the above copyright
// notice, this list of conditions and the following disclaimer.
//     * Redistributions in binary form must reproduce the above
// copyright notice, this list of conditions and the following disclaimer
// in the documentation and/or other materials provided with the
// distribution.
//     * Neither the name of Google Inc. nor the names of its
// contributors may be used to endorse or promote products derived from
// this software without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

//
// Google C++ Testing and Mocking Framework definitions useful in production code.
// GOOGLETEST_CM0003 DO NOT DELETE

#ifndef GTEST_INCLUDE_GTEST_GTEST_PROD_H_
#define GTEST_INCLUDE_GTEST_GTEST_PROD_H_

// When you need to test the private or protected members of a class,
// use the FRIEND_TEST macro to declare your tests as friends of the
// class.  For example:
//
// class MyClass {
//  private:
//   void PrivateMethod();
//   FRIEND_TEST(MyClassTest, PrivateMethodWorks);
// };
//
// class MyClassTest : public testing::Test {
//   // ...
// };
//
// TEST_F(MyClassTest, PrivateMethodWorks) {
//   // Can call MyClass::PrivateMethod() here.
// }
//
// Note: The test class must be in the same namespace as the class being tested.
// For example, putting MyClassTest in an anonymous namespace will not work.

#define FRIEND_TEST(test_case_name, test_name)\
friend class test_case_name##_##test_name##_Test

#endif  // GTEST_INCLUDE_GTEST_GTEST_PROD_H_ 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-10T17:06:33.743

测试私有成员的愿望是一种设计气味，通常表明有一个班级被困在你的班级里，正在努力摆脱。一个类的所有功能都应该可以通过它的公共方法来执行；无法公开访问的功能实际上并不存在。

有几种方法可以让您意识到您需要测试您的私有方法是否按照他们所说的那样做。朋友班是其中最差的；他们以一种表面上看起来很脆弱的方式将测试与被测类的实现联系起来。更好的是依赖注入：使私有方法的依赖类属性，测试可以提供模拟版本，以便允许通过公共接口测试私有方法。最好的方法是提取一个封装了您的私有方法所具有的行为的类作为其公共接口，然后像往常一样测试新类。

有关更多详细信息，请参阅[清洁代码](http://books.google.com.br/books/about/Clean_Code.html?id=_i6bDeoCQzsC)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-01-16T16:18:47.830

尽管有关于测试私有方法的适当性的评论，但假设您确实需要......例如，在将遗留代码重构为更合适的东西之前，这通常是这种情况。这是我使用的模式：

```
// In testable.hpp:
#if defined UNIT_TESTING
#   define ACCESSIBLE_FROM_TESTS : public
#   define CONCRETE virtual
#else
#   define ACCESSIBLE_FROM_TESTS
#   define CONCRETE
#endif 
```

然后，在代码中：

```
#include "testable.hpp"

class MyClass {
...
private ACCESSIBLE_FROM_TESTS:
    int someTestablePrivateMethod(int param);

private:
    // Stuff we don't want the unit tests to see...
    int someNonTestablePrivateMethod();

    class Impl;
    boost::scoped_ptr<Impl> _impl;
} 
```

比定义测试朋友更好吗？它似乎没有替代方案那么冗长，并且在标题中很清楚正在发生什么。这两种解决方案都与安全性无关：如果您真的关心方法或成员，则需要将它们隐藏在不透明的实现中，可能还有其他保护措施。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-16T17:45:35.110

C++ 中有一个使用#define 的简单解决方案。只需像这样包装您的“ClassUnderTest”的包含：

```
#define protected public
 #define private   public
    #include <ClassUnderTest.hpp>
 #undef protected
#undef private 
```

[归功于这篇文章和 RonFox][1]

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2016-04-29T03:21:41.940

我宁愿在单元测试的 Makefile 中添加 -Dprivate=public 选项，避免修改我原始项目中的任何内容

# c++ - valgrind 使用使用 GENOID 创建的简单 BSON 对象报告 BSONObj::toString 中未初始化的值

> ID：14186246
> 
> 赞同：1
> 
> 时间：2013-01-06T20:11:09.170
> 
> 标签：c++, mongodb, bson

在来自 mongodb 的 C++ 驱动程序的一个非常简单的示例中使用 valgrind，一旦我们在 BSONObj 的定义中明确使用 GENOID，就会出现问题。这是一个说明问题的示例：

（在 gcc 4.4.5、boost 1.42、debian 6、mongodb C++ 驱动程序 2.2 上测试）

```
#include <cstdio>
#include <string>
#include "mongo/db/jsobj.h"

main()
{
  mongo::BSONObj p = BSON( mongo::GENOID << "name" << "Joe" << "age" << 33 );
  std::string s = p.toString();
  std::cout << s;
} 
```

使用 valgrind 运行时，我们会收到以下消息：

```
==2506== Use of uninitialised value of size 8
==2506==    at 0x40A66B: mongo::toHexLower(void const*, int) (hex.h:64)
==2506==    by 0x40A73F: mongo::OID::str() const (oid.h:66)
==2506==    by 0x40A798: mongo::operator<<(mongo::StringBuilderImpl<mongo::TrivialAllocator>&, mongo::OID const&) (oid.h:140)
==2506==    by 0x40DCC1: mongo::BSONElement::toString(mongo::StringBuilderImpl<mongo::TrivialAllocator>&, bool, bool, int) const (bson-inl.h:765)
==2506==    by 0x40C898: mongo::BSONObj::toString(mongo::StringBuilderImpl<mongo::TrivialAllocator>&, bool, bool, int) const (bson-inl.h:475)
==2506==    by 0x40C5A5: mongo::BSONObj::toString(bool, bool) const (bson-inl.h:445)
==2506==    by 0x40A1B8: main (mongobug.cc:10) 
```

如果我从 BSONObj 定义中删除 GENOID，问题就消失了。这是我在项目中使用 mongo::OID::gen() 时遇到的更复杂但类似问题的极简版本。

上面的例子取自这里的官方 mongodb C++ 驱动教程：[http ://www.mongodb.org/pages/viewpage.action?pageId=133415#C%2B%2BTutorial-BSON](http://www.mongodb.org/pages/viewpage.action?pageId=133415#C%2B%2BTutorial-BSON)

知道有什么问题吗？谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T19:51:48.940

和mongodb团队仔细审查后，mongodb代码似乎没有问题。我怀疑在 oid.h 中使用的联合中存在结构对齐问题，但它与 #pragma pack(1) 指令正确对齐。

我倾向于认为它宁愿是 valgrind 的误报，因为 mongo::OID 类的定义中使用的 struct 联合的结构并不那么简单。如果有人可以重现该问题并找到明确的答案，我会很感兴趣。谢谢！

# java - android中的通话管理

> ID：14186247
> 
> 赞同：0
> 
> 时间：2013-01-06T20:11:17.343
> 
> 标签：java, android, phone-call

我正在寻找有关 Android 中电话呼叫管理的开发人员指南或好的教程。我想要做的是检测来电激活一个自定义活动，我可以在其中接听、拒绝和挂断电话。

出于某种原因，我无法在谷歌中找到关于它的好信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:20:16.500

您必须与[TelephonyManager](http://developer.android.com/reference/android/telephony/TelephonyManager.html)进行交互（我正在使用您可以在[此处](https://github.com/libpd/pd-for-android/wiki/android)的“杂项”部分找到的代码）。

# data-structures - 破坏者模式和 NServiceBus

> ID：14186252
> 
> 赞同：2
> 
> 时间：2013-01-06T20:11:38.033
> 
> 标签：data-structures, architecture, messaging, nservicebus, disruptor-pattern

我一直在对高性能可靠消息传递系统的破坏者模式进行一些研究，作为 NServiceBus 的狂热用户，我想知道这是否可以实现？或者也许已经有一个实现......我只是想知道其他人对此的想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T18:24:38.267

如果您指的是[LMAX 架构](http://martinfowler.com/articles/lmax.html)和[Mechanical Sympathy](http://mechanical-sympathy.blogspot.com/2011/08/disruptor-20-released.html)的 Martin Thompson，那么答案是否定的，至少在不久的将来是这样。原因是破坏者架构在基础层面上与 NServiceBus 的架构不同。引用 Disruptor [GitHub 页面](http://lmax-exchange.github.com/disruptor/)：

> 这不是一个专业的解决方案，它不是专为金融应用而设计的。Disruptor 是一种通用机制，用于解决并发编程中的难题。它的工作方式与更传统的方法不同，因此您使用它的方式与您可能习惯的方式略有不同。**例如，将模式应用到您的系统并不像用魔术环缓冲区替换所有队列那么简单。**

因此，可以使用 NServiceBus 中存在的一些抽象，例如 IMessageHandler，并将环形缓冲区用作底层传输，但也可能需要更改一些抽象。

总的来说，我认为这是一个很好的问题。

# directx - 带有 DirectDraw (2d) 覆盖的 Direct3D 11

> ID：14186254
> 
> 赞同：1
> 
> 时间：2013-01-06T20:11:44.947
> 
> 标签：directx, direct3d, direct2d, directdraw, direct3d11

基本上，我想在 3d 交换链上进行 2d 绘图。但是我的代码注入了另一个程序，我没有源代码。

我可以画图，但它仅在使用 DXGI_FORMAT_B8G8R8A8_UNORM (BGR) 格式创建交换链时才有效。

最初，该程序使用 DXGI_FORMAT_R8G8B8A8_UNORM (RGB)，当我将其切换到 BGR 时，程序渲染到窗口/屏幕之外。几乎所有东西都更大。

有没有办法使用 RGB 将 Direct3D 11 与 2D 互操作，或者使应用程序渲染与 BGR 正确工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T16:26:57.613

如果交换链是使用 DXGI_FORMAT_R8G8B8A8_UNORM 格式创建的，那么您只需确保传递给呈现目标的 CreateBitmapFromDxgiSurface 方法的 Direct2D 位图属性也指定相同的 DXGI_FORMAT_R8G8B8A8_UNORM 像素格式。

# wpf - 如何在 WinRT 应用程序中将二进制转换为图像？

> ID：14186255
> 
> 赞同：1
> 
> 时间：2013-01-06T20:11:53.917
> 
> 标签：wpf, image, windows-runtime

我有将我的二进制数据转换为图像（png，jpg，jpeg）的示例代码（WPF）：

```
BitmapFrame imgSrc1;
BitmapFrame imgSrc2;
BitmapFrame imgSrc3;
imgSrc1 = new JpegBitmapDecoder(ms, BitmapCreateOptions.None, BitmapCacheOption.None).Frames[0];
imgSrc2 = new JpegBitmapDecoder(ms, BitmapCreateOptions.None, BitmapCacheOption.None).Frames[0];
imgSrc3 = new PngBitmapDecoder(ms, BitmapCreateOptions.None, BitmapCacheOption.None).Frames[0]; 
```

WinRT 中的类有些问题，没有像 JpegBitmapDecoder 这样的类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T07:02:51.953

您可以像这样创建 jpg 解码器：

```
// using Windows.Graphics.Imaging
BitmapDecoder.CreateAsync(BitmapDecoder.JpegDecoderId, stream) 
```

# c# - .NET 内存不足异常 - 已使用 1.3GB 但已安装 16GB

> ID：14186256
> 
> 赞同：100
> 
> 时间：2013-01-06T20:11:57.320
> 
> 标签：c#, .net, out-of-memory

当应用程序的内存使用量超过 1.3GB 时，我的 C# 应用程序出现内存不足异常。

我在具有 3GB 内存的 32 位机器上遇到了同样的问题，这在当时是有道理的。但是现在我使用高端主板和高端RAM将硬件升级为16GB内存的64位机器，但是在1.3GB之后仍然出现Out Of Memory异常！

我知道没有超过 2GB 的单个对象，并且 1.3 无论如何小于 2GB，因此单个对象的内置 MS 2GB 限制不太可能成为问题。

当应用程序达到某个内存使用阈值时，似乎存在某种类型的 Windows 终止开关。那么应该有一种方法来配置它。也许在注册表中？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2013-01-06T20:17:06.827

*在编译*到相同的目标架构之前没有区别。我**想**您`32`在这两种情况下都在为位架构进行编译。

值得一提的是，如果您在架构和位上获得由[CLR](https://msdn.microsoft.com/en-us/library/8bs2ecf4.aspx "MSDN")（例如）中的单个集合分配的内存，[`OutOfMemoryException`](https://msdn.microsoft.com/en-us/library/system.outofmemoryexception.aspx "MSDN")也可以提出。`2GB`[`List<T>`](https://msdn.microsoft.com/en-us/library/6sh2ey19.aspx "MSDN")`32``64`

为了能够从位架构的内存优势中受益`64`，您必须*编译*针对 `64`位架构的代码。在那之后，自然地，您的二进制文件将**仅**在位上运行`64`，但将受益于在 RAM 中拥有更多可用空间的可能性。

* * *

## 回答 #2

> 赞同：67
> 
> 时间：2013-01-07T06:28:00.140

如前所述，以 x64 编译应用程序可为您提供更多可用内存。

但是在必须在 x86 中构建应用程序的情况下，有一种方法可以将内存限制从 1.2GB 提高到 4GB（这是 32 位进程的实际限制）：

在Visual Studio安装目录的VC/bin文件夹中，必须有一个`editbin.exe`文件。所以在我的默认安装中，我在下面找到它

```
C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\editbin.exe 
```

为了使程序工作，也许你必须先`vcvars32.bat`在同一个目录中执行。然后一个

`editbin /LARGEADDRESSAWARE <your compiled exe file>`

足以让您的程序使用 4GB RAM。`<your compiled exe file>`是 VS 在编译项目时生成的 exe。

如果您想在每次编译项目时自动执行此行为，请对已执行的项目使用以下 Post-Build 事件：

```
if exist "$(DevEnvDir)..\tools\vsvars32.bat" (
   call "$(DevEnvDir)..\tools\vsvars32.bat"
   editbin /largeaddressaware "$(TargetPath)"
) 
```

旁注：同样可以`devenv.exe`让 Visual Studio 也使用 4GB RAM 而不是 1.2GB（但首先备份旧的`devenv.exe`）。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2016-09-27T12:06:17.703

值得一提的是，“任何 CPU”编译的默认设置现在检查“首选 32 位”复选框。如果设置为 AnyCPU，则在具有 16gb RAM 的 64 位操作系统上，如果选中此项，仍然可以在 2gb 处遇到内存不足异常。

[![Prefer32BitCheckBox](../Images/327e610024f1ed5b8ab64b22f6459906.png)](https://i.stack.imgur.com/PRvYA.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-06T20:14:08.623

看起来你有一个 64 位的拱门，很好——但是 .NET 运行时的 32 位版本和/或 Windows 的 32 位版本。

因此，您的进程可用的地址空间仍然是相同的，它与您之前的设置没有改变。

升级到 64 位操作系统和 64 位 .NET 版本；）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-06T20:21:46.723

您的应用程序是作为 64 位还是 32 位进程运行的？你可以在任务管理器中查看。

可能是，它以 32 位运行，即使整个系统运行在 64 位上。

如果是 32 位，第三方库可能会导致此问题。但首先确保您的应用程序正在为“任何 CPU”编译，如评论中所述。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-17T10:18:49.287

如果您有 32 位 Windows，则此方法在没有以下设置的情况下不起作用。

> 1.  运行提示 cmd.exe（重要：以管理员身份运行）
> 2.  键入 bcdedit.exe 并运行
> 3.  查看“increaseuserva”参数并没有然后写以下语句
> 4.  bcdedit /set increaseuserva 3072
> 5.  再次执行第 2 步并检查参数

我们添加了这个设置，这个块开始了。

```
if exist "$(DevEnvDir)..\tools\vsvars32.bat" (
   call "$(DevEnvDir)..\tools\vsvars32.bat"
   editbin /largeaddressaware "$(TargetPath)"
) 
```

更多信息 - 命令`increaseuserva`：[https ://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--set](https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/bcdedit--set)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-11-19T10:03:27.830

如果您只想为 VS 之外的特定 32 位应用程序提供对更多内存的访问，那么[https://github.com/cybertechniques/site/blob/master/analysis_tools/cff-explorer/index 中有一个有用的应用程序。 md](https://github.com/cybertechniques/site/blob/master/analysis_tools/cff-explorer/index.md)将为您设置应用程序标题。

*   从 NT Core 站点或 CFF Explorer 文件下载“CFF Explorer”。
*   启动“CFF Explorer”并打开 EXE（例如 C:\Users\dennisg\AppData\Local\Apps\2.0\MHV1WDDC.958Y0ELE416.L7Y\myapp.exe）
*   项目清单

在窗口左侧，选择“Nt Headers”下的“File Header”部分 在右侧查找以“Characteristics”开头的行和“Click here”字段。点击那里。（下一部分出现上下文菜单）。选择/启用“应用程序可以处理 >2gb 地址”复选框，然后单击“确定”。保存文件（文件 > 保存）。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2021-03-16T07:31:09.850

如果您在较新版本的 Visual Studio **(2017, 2019)**中搜索工具文件夹，我在下面

```
C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional\Common7\Tools 
```

并且文件的名称是Visual Studio 2017 及更高版本中的**VsDevCmd.bat**。

# matlab - VL_feat 函数对 Matlab 中的并行工作人员不可见

> ID：14186258
> 
> 赞同：1
> 
> 时间：2013-01-06T20:12:10.733
> 
> 标签：matlab, parallel-processing, vlfeat

所以我正在尝试使用 vl_feat 外部工具箱进行一些图像处理，并且我正在尝试并行运行它，因为有很多数据要处理。所以我有一个函数，其中包含一个 parfor 循环，它调用一个辅助函数，该函数调用 vl_ubcmatch。

现在，当我在没有先打开 matlabpool 的情况下运行我的代码时，它运行得很好。但是，如果我打开一个工人池然后运行代码，我会收到一条错误消息，提示“未定义函数 'vl_ubcmatch' 用于类型为 'uint8' 的输入参数”。因此，显然机器中设置并行作业的某些东西会导致它失去对 vl_ubcmatch 函数的跟踪。

我知道 vl_feat 工具箱中的函数代码不在 .m 文件中，而是使用 c 代码和 mex 文件，我不完全理解所有这些如何绑定到函数调用，但我假设该实现的某些内容使并行计算工具箱感到困惑。有没有其他人经历过这种情况，是否有任何解决方法？提前致谢。

# python - 是否有任何 python 包来处理任何 .txt 文件？

> ID：14186260
> 
> 赞同：-1
> 
> 时间：2013-01-06T20:12:34.697
> 
> 标签：python

我`openpyxl`用来处理许多 Excel 操作，但同样在寻找任何处理`.txt`文件的包。

我有一个如下的 .txt 文件，其中包含表格形式的数据。我必须从那里删除特殊字符并将原始数据放入 Excel 工作表中。

```
=============|=============|=============|=============|
    Name     |   Address   |PhoneNumber  |     Age     |
=============|=============|=============|=============|
   Matt      |   B3/24     |  8475968    |    25       |
   John      |   A1-A2 Wing|  3335968    |    44       | 
```

有吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T20:17:07.667

为什么需要“处理” .txt 文件？大多数情况下，您只需使用命令打开它们，然后使用和方法`open()`读取/写入它们。`read()``write()`

请查看 Python 文档中的[读取和写入文件](http://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files)部分。[从这里](http://docs.python.org/2/library/functions.html#open)的`open()`命令开始。

* * *

如果您有以某种特殊格式（例如[CSV](http://en.wikipedia.org/wiki/Comma-separated_values)）编写的 txt 文件，您可以尝试在[PyPi](http://pypi.python.org/pypi)上搜索正确的模块。请注意，在这种情况下，Python 有很好的内置 CSV 模块，可以很好地处理 CSV 文件。[在这里](http://docs.python.org/2/library/csv.html)阅读更多。

* * *

在你编辑了你的帖子之后，我可以告诉你，你可以选择[asciitable](http://python4astronomers.github.com/files/asciitable.html)，它也在[PyPi](http://pypi.python.org/pypi/asciitable/0.8.0)上并且有[很好的文档](http://cxc.harvard.edu/contrib/asciitable/)。
但是 - 如果没有这个库，这看起来并不难（嗨 - 只是说。你绝对应该使用这个模块，它看起来很棒）。只需逐行读取文件，然后用管道分割每一行。如果拆分后单元格的唯一内容是`=`符号，则留空行。Else - 只感受分裂后与行内容的单元格。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T20:41:35.513

我建议你试试[asciitable](http://cxc.harvard.edu/contrib/asciitable/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-06T21:06:51.083

我总是使用[pandas](http://pandas.pydata.org/pandas-docs/stable/)来解决这类问题，这就是你如何在一行中读取文件：

```
from pandas import read_table
data = read_table('table.txt', sep='|', skiprows=[0,2]).dropna(axis=1) 
```

出去：

```
 Name    Address    PhoneNumber  Age
0    Matt    B3/24       8475968     25
1    John    A1-A2 Wing  3335968     44 
```

`data.csv()`之后，您使用 data['Name'] 访问您的列，操作，过滤等。最后您使用or写入文件`data.to_excel()`。[请参阅此处](http://pandas.pydata.org/pandas-docs/stable/)的文档（特别是 groupby 部分）：

编辑：因为列名是用空格（'Name'而不是'Name'）导入的，所以你还需要这样做：

```
data.columns = data.columns.map(str.strip) 
```

之后`data['Name']`，`data['Address']`等将正常工作。`.dropna()`需要删除最后一个被错误导入的空列，因为在您的文件中有一个分隔符“|” 在每一行的末尾。你可以试一试，`.dropna()`看看会发生什么。

# servicestack - ConvertToList (ServiceStack OrmLite) 中的 NullReference 异常

> ID：14186266
> 
> 赞同：2
> 
> 时间：2013-01-06T20:13:16.913
> 
> 标签：servicestack, ormlite-servicestack

我在应用程序中使用 OrmLite 进行数据访问。在 4 个环境中的 3 个环境中，一切都按预期工作。

所有环境都运行 .net 4.5。数据库运行不同的版本。失败的环境连接到 sql server 10.50.2796，工作环境连接到 sql server 10.50.4000。

System.Data* 程序集的版本在不工作的服务器上是相同的。

堆栈跟踪：

> System.NullReferenceException：对象引用未设置为对象的实例。在 C:\src\ServiceStack.OrmLite\src\ServiceStack.OrmLite\Expressions\ReadExtensions.cs:ServiceStack 的第 151 行的 ServiceStack.OrmLite.ReadExtensions.ConvertToList[T](IDataReader dataReader) 的 lambda_method(Closure , Object , Object ) .OrmLite.ReadExtensions.Select[T](IDbCommand dbCmd, Expression `1 predicate) in C:\src\ServiceStack.OrmLite\src\ServiceStack.OrmLite\Expressions\ReadExtensions.cs:line 23 at ServiceStack.OrmLite.ReadConnectionExtensions.Exec[T](IDbConnection dbConn, Func`2 filter) in C:\src\ServiceStack.OrmLite\src\ServiceStack.OrmLite\Expressions\ReadConnectionExtensions.cs:line 26

**更新** 我认为这是与我连接到的 sql server 版本相关的错误。如果我在工作环境中更改连接字符串以使用运行 10.50.2796 的数据库，我会遇到同样的错误。

TIA，杰森

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T18:55:29.740

此错误发生在数据库中的 b/c 字段包含空值，并且相应的模型字段不可为空。我将尝试更深入地挖掘并向 OrmLite 团队提供一些测试。DB版本是一个红鲱鱼。

# jquery - 在两个表之间拖放

> ID：14186267
> 
> 赞同：1
> 
> 时间：2013-01-06T20:13:22.293
> 
> 标签：jquery, jquery-ui, drag-and-drop

我正在尝试在两个表之间拖放 n 行。第一个表有 3 列，第二个表有 4 列。我有拖放工作。

我看到的所有示例通常都在放置的位置附加到。我想做的是替换拖动行的内容并替换/更新放置位置的单元格。

我在想是否可以编写一个新的 tablerow(..)，然后删除当前删除的行并将其替换为生成的行。或者也许只是更新新位置的列。

```
(function ($) {
  $(document).ready(function () {
    var tb1 = $("#table1 tr");
    var tb2 = $("#table2 tr");
    tb1.draggable({
      appendTo: "body",
      helper: "clone",
      opacity: "0.35",
      revert: "invalid"
    });
    tb2.droppable({
      accept: '#table1 tr',
      tolerance: "pointer",
      drop: function (event, ui) {
        //loop through all items in the row
        var $col1, $col2;
        tb1.each(function () {
          $col1 = $("span:eq(0)", this).text();
          $col2 = $("span:eq(1)", this).text();
        });
        $droppedRow = $(this).children('td');
        var $destCol1 = $droppedRow.find('span')[0].innerHTML;
        var $destCol2 = $droppedRow.find('span')[1].innerHTML;
        var $row = "<tr><td>" & $destCol1 & "</td><td>" & $destCol2 & "</td><td>" & $col1 & "</td><td>" & $col2 & "</td></tr>";

      } 
```

[http://jsfiddle.net/S2yC2/7/](http://jsfiddle.net/S2yC2/7/)

任何建议如何进行。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:39:50.060

我认为您正在尝试这样做：http: [//jsfiddle.net/S2yC2/15/](http://jsfiddle.net/S2yC2/15/)

```
 drop: function (event, ui) {

    //Retrieve relevant data of the dragged line
    var $draggedCol = $(ui.draggable).children('td');
    var col1 = $($draggedCol[0]).html();
    var col2 = $($draggedCol[1]).html();      

    //Assign data to the void cell of the dropped line
    var $droppedRow = $(this).children('td');
    $($droppedRow[2]).html(col1);
    $($droppedRow[3]).html(col2);

  } 
```

# c++ - 双轴快速排序

> ID：14186270
> 
> 赞同：0
> 
> 时间：2013-01-06T20:13:40.260
> 
> 标签：c++, sorting, pivot, quicksort

我有一个任务来实现一个双轴快速排序算法。它似乎适用于具有少量数字的向量，但是当我尝试使用例如 100000 对向量进行排序时，我会遇到分段错误。有什么帮助吗？

```
void quicksort_dual_pivot(vector <int> &A, int L, int R)
{

if(L>=R) return; 

 int spivot = A[L]; //Error here.
 int bpivot = A[R]; 

if(spivot > bpivot){

    swap(A[R],A[L]);
    swap(spivot,bpivot);
}

int l = L+1; 

int g =  R-1; 

for(int k=l;k<=g;k++){

    if(A[k] < spivot) {     

        swap(A[k],A[l]);
        l++;
    }

    else if(A[k] > bpivot){
        while(A[g] > bpivot && k  < g){

          g--;
        }

        swap(A[g],A[k]); 
        g--;

        if(A[k] < spivot){    

            swap(A[k],A[l]);
            l++;

        }
    }

}

l--;
g++;

swap(A[L],A[l]);

swap(A[R],A[g]);

quicksort_dual_pivot(A,L,l-1); 

quicksort_dual_pivot(A,l+1,g-1); // And error here.

quicksort_dual_pivot(A,g+1,R);

} 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:53:04.247

附加调试器。

或者，如果您不想这样做，请在此之前打印出 L 并重新运行。

```
int spivot = A[L]; //Error here. 
```

看看你得到了什么。想必是意料之外的事情吧。然后看看这个值是如何在递归调用中传递的，看看是什么导致你得到一个错误的值。我敢打赌你会在一个或多个方向上从数组的末尾递增。

# jsp - 在 JSF 中迭代 selectBooleanCheckbox

> ID：14186271
> 
> 赞同：2
> 
> 时间：2013-01-06T20:13:41.603
> 
> 标签：jsp, jsf, jakarta-ee, datatable, crud

我正在创建一个 JSF 应用程序，在该应用程序中，我从用户`DataTable. I am showing`面前的 selectBooleanCheckbox` 中的数据库中获取用户列表，并且我想实现批量删除选项，以便用户可以选择多个用户并按下删除按钮。如果是 PHP，我可以很容易地做到这一点，但现在我不知道该怎么做。

我是否还需要创建一个`selectBooleanCheckbox`in bean 并绑定它？我期待着最好的方法。BalusC 的 CRUD 方法在这里不适用，因为他使用的是自定义 DAO 东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:06:10.737

请考虑这篇文章，[如何在 <h:dataTable> 中使用 <h:selectBooleanCheckbox> 来选择多行？](https://stackoverflow.com/questions/2524514/how-to-use-jsfs-hselectbooleancheckbox-with-hdatatable-to-create-one-object-p?rq=1)希望这对你有好处。它解释了处理复选框所需的每个步骤。

# html - 是什么导致水平滚动条出现在以下最简单的 HTML 中的 Chrome 上？

> ID：14186277
> 
> 赞同：7
> 
> 时间：2013-01-06T20:14:09.250
> 
> 标签：html, css, google-chrome

HTML：

```
<html>

  <body>
    <div>
      <input type="text">
    </div>
  </body>

</html> 
```

CSS：

```
 body {
   font:13px/1.231 arial;
 }
 input {
   font:99% arial;
 }
 div {
   display: inline-block;
   overflow: auto;
 }
 input {
   width: 15em;
 } 
```

在 Chrome 上的结果：

![在此处输入图像描述](../Images/0e4f67d5e39b4403ad424a108a8ad790.png)

jsFiddle - [http://jsfiddle.net/XBvWb/18/](http://jsfiddle.net/XBvWb/18/)

请注意，FF 和 IE9 都不显示此滚动条。

有没有大神能指教一下，请问这是怎么回事？

**编辑**

删除了输入边框、填充和边距 - [http://jsfiddle.net/XBvWb/41/](http://jsfiddle.net/XBvWb/41/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-06T20:44:04.097

我的猜测是 Chrome 存在舍入问题。

如果您使用任何 px 值作为输入宽度，滚动条就会消失。将输入字体大小更改为 100%（在此示例中恰好等于 13px）时也是如此。

输入的当前宽度为 15 * 99% * 13px = 193.05px

我认为 .05px 让滚动条出现。

这也解释了为什么滚动条会在 11em 左右的宽度处消失。它只是以 Chrome 可以更好地处理的方式进行了汇总。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:18:45.323

以下行导致额外的滚动条：

```
overflow: auto; 
```

您也可以保留它并为 div 添加显式宽度：

```
width: 100%; 
```

或使 div 成为块级元素

```
display:block 
```

基本上，您永远不应该将`block`关卡元素放在`inline-block`关卡元素中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T20:22:48.667

overflow:auto 如果内容被剪切，则强制滚动条。您的 width: 15em 输入导致内容被剪裁，从而迫使滚动条出现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-06T06:43:25.367

我有一个类似的问题，水平滚动框出现在 Chrome 而不是 Firefox 中。

如果您的网站（像大多数网站一样）不使用水平滚动，您可以通过简单地隐藏 x 轴上的所有溢出来解决此问题，如下所示：

```
body {
  overflow-x:hidden;
} 
```

注意：或者您也可以在`html`标签上设置它。不确定哪个更好。

# java - ksoap2 通过 SOAP 接收复杂对象数组

> ID：14186279
> 
> 赞同：3
> 
> 时间：2013-01-06T20:14:17.053
> 
> 标签：java, android, ksoap2

我正在尝试从用 PHP（nuSOAP）编写的肥皂服务接收复杂对象的数组。我正在尝试编写一个 Android 客户端并使用 ksoap2 库（3.0.0 RC.4）。这个网上有一些“解决方案”，有几个人面临同样的问题——无论如何，我尝试了很多不同的方法，但我现在仍然卡住了好几天，所以我决定向你们寻求帮助。因此，我将向您展示我认为最接近我想要获得的代码。

首先要做的事情 - SOAP-Response（主体）：

```
<SOAP-ENV:Body>
    <ns1:GetListResponse xmlns:ns1="http://localhost/games_db/games_db.php">
        <return xsi:type="SOAP-ENC:Array" SOAP-ENC:arrayType="tns:DataPlusID[24]">
            <item xsi:type="tns:DataPlusID">
                <data xsi:type="xsd:string">shitload</data>
                <ID xsi:type="xsd:int">4</ID>
            </item>
            <item xsi:type="tns:DataPlusID">
                <data xsi:type="xsd:string">of</data>
                <ID xsi:type="xsd:int">7</ID>
            </item>
            <item xsi:type="tns:DataPlusID">
                <data xsi:type="xsd:string">imformation</data>
                <ID xsi:type="xsd:int">10</ID>
            </item>
        </return>
    </ns1:GetListResponse>
</SOAP-ENV:Body> 
```

当我没有映射任何东西时，“envelope.bodyIn.toString()”给了我以下信息。

```
GetListResponse{
    return=[
        DataPlusID{data=shitload; ID=4; },
        DataPlusID{data=of; ID=7; },
        DataPlusID{data=information; ID=10; }
    ];
} 
```

这是课程，有一天应该会处理响应...

```
public class GetListResponse implements KvmSerializable {

    private Vector<DataPlusID> datavector = new Vector<DataPlusID>();

    @Override
    public Object getProperty(int arg0) {
        return this.datavector;
    }

    @Override
    public int getPropertyCount() {
        return 1;
    }

    @Override
    public void getPropertyInfo(int index, Hashtable properties, PropertyInfo info) {
        info.name = "return";
        info.type = new Vector<DataPlusID>().getClass();
    }

    @Override
    public void setProperty(int index, Object value) {
        this.datavector = (Vector<DataPlusID>) value;
    }
} 
```

和

```
public class DataPlusID implements KvmSerializable
{

    private String data;
    private int ID;

    @Override
    public Object getProperty(int arg0) {
        switch(arg0) {
        case 0:
            return data;
        case 1:
            return ID;
        }

        return null;
    }

    @Override
    public int getPropertyCount() {
        return 2;
    }

    @Override
    public void getPropertyInfo(int index, Hashtable arg1, PropertyInfo info) {
        switch(index) {
        case 0:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "data";
            break;
        case 1:
            info.type = PropertyInfo.INTEGER_CLASS;
            info.name = "ID";
            break;
        default:break;
        }
    }

    @Override
    public void setProperty(int index, Object value) {
        switch(index) {
        case 0:
            data = value.toString();
            break;
        case 1:
            ID = Integer.parseInt(value.toString());
            break;
        default:
            break;
        }
    }
} 
```

这是接收消息的代码

```
public GetListResponse GetList(String liste) throws Exception{

    SoapObject request = new SoapObject(Namespace, MethodGetList);

    request.addProperty("list", liste);

    final SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.setOutputSoapObject(request);

    envelope.addMapping(Namespace, "GetListResponse", new GetListResponse().getClass());
    //envelope.addMapping(Namespace, "return", new Vector<DataPlusID>().getClass());
    envelope.addMapping(Namespace, "item", new DataPlusID().getClass()); //tried also "DataPlusID" instead of "item"

    try {
        HttpTransportSE transport = new HttpTransportSE(URL);
        transport.debug = true;

        transport.call(ActionGetList, envelope);

        Log.d("SOAPEnvelope", "Response: "+transport.responseDump);
    } catch (Exception e){
        Log.d("SOAPEnvelope", "Fehler bei Serverabfrage: "+e.toString());
    }
    //Log.d("SOAPEnvelope", "BodyIn: "+envelope.bodyIn.toString());

    GetListResponse result = new GetListResponse();
    result = (GetListResponse)envelope.bodyIn;

    return result;
} 
```

处理数据：

```
new Thread(new Runnable() {
    public void run() {  
        try {
            GetListResponse response = new GetListResponse();
            response = GetList("genre");

            //content of datavector is below
            Vector<DataPlusID> datavector = new Vector<DataPlusID>();
            datavector = (Vector<DataPlusID>) response.getProperty(0);

            //EXCEPTION IS THROWN HERE
            String x = (String) datavector.get(0).getProperty(0);

            DataPlusID daten0 = new DataPlusID();
            //WOULD ALSO HAPPEN HERE
            daten0 = (DataPlusID) datavector.get(0);

            String genre1 = (String) daten0.getProperty(0);

        } catch (Exception e) {
            Log.d("SOAPEnvelope", e.toString());
        }
    }
}).start(); 
```

这是“数据向量”的内容：

```
(java.util.Vector)
[DataPlusID{data=Action; ID=4; },
DataPlusID{data=Adventure; ID=7; },
DataPlusID{data=Aufbauspiel; ID=10; },
DataPlusID{data=Beat 'em up; ID=11; }] 
```

抛出以下异常：

```
java.lang.ClassCastException: org.ksoap2.serialization.SoapObject cannot be cast to com.example.gamesdb_client.DataPlusID 
```

最奇怪的是，在调试时我实际上得到了我想要得到的值。--> 当我检查表达式“datavector.get(0).getProperty(0)”时，我得到：

```
(java.lang.String) shitload 
```

所以他实际上是以正确的格式（字符串）查看数据，但是当他尝试将其附加到字符串变量时，他给了我一个 ClassCastException？

无论如何，无论我尝试什么，最终结果都是 CCE，所以我很确定问题可以在映射（以及类定义）部分中找到：

```
1 envelope.addMapping(Namespace, "GetListResponse", new GetListResponse().getClass());
2 envelope.addMapping(Namespace, "item", new DataPlusID().getClass()); 
```

如果没有第 1 行，我会得到另一个 CCE，所以我希望映射能够按预期工作。如果没有第 2 行，没有任何变化，所以我很确定问题出在 DataPlusID 类中。

他只是无法链接这些：

```
DataPlusID{data=shitload; ID=4; },
DataPlusID{data=of; ID=7; },
DataPlusID{data=information; ID=10; } 
```

到 DataPlusID 类。

所以希望有人可以看看这个并给我一些如何解决问题的想法。也许只是一些我不明白的基本东西。- 让我的假期不被浪费^^谢谢。

**编辑：重新 R4j**

问题是，在示例代码中，他们使用了一个字符串向量（用 this.add(value.toString() 添加它）。这对我来说是不可能的，因为我有一个“DataPlusID”向量。有些东西like this.add(value); 不起作用，因为他不能将参数（类型：对象）放入 DataPlusID 向量中。

我试图通过将“GetListResponse”类的 setProperty 方法更改为：

```
public void setProperty(int index, Object value) {
    this.datavector = (Vector<DataPlusID>) value;

    for (int i = 0; i < datavector.size(); i++) {
        this.add(datavector.elementAt(i));
    }
} 
```

这样我就可以将向量的单个部分设置到类中。

不幸的是，这只是在该行中抛出了相同的 ClassCastExcepiton：

```
this.add(datavector.elementAt(i)); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-11T20:58:03.953

原始 postet 问题的解决方案。

**归功于 R4j - 你的回答对我帮助很大。**

类定义 - GetListResponse：

```
public class GetListResponse implements KvmSerializable {

    private Vector<SoapObject> datavector = new Vector<SoapObject>();
    private DataArray dataarray = new DataArray();

    @Override
    public Object getProperty(int arg0) {
        //return this.datavector.get(arg0);
        return this.dataarray;
    }

    @Override
    public int getPropertyCount() {
        return 1;
    }

    @Override
    public void getPropertyInfo(int index, Hashtable properties, PropertyInfo info) {
        info.name = "return";
        info.type = new Vector<DataPlusID>().getClass();
    }

    @Override
    public void setProperty(int index, Object value) {
        this.datavector = (Vector<SoapObject>) value;

        for(int i = 0; i < datavector.size(); i++) {
            dataarray.setProperty(0, datavector.get(i));
        }
    }
} 
```

数据数组：

```
public class DataArray extends Vector<DataPlusID> implements KvmSerializable {

    private static final long serialVersionUID = -1166006770093411055L;

    @Override
    public Object getProperty(int index) {
        return this.get(index);
    }    

    @Override
    public int getPropertyCount() {
        return this.size();
        //return dataArray.length;
    }

    @Override
    public void getPropertyInfo(int index, Hashtable properties, PropertyInfo info) {
        info.name = "item";
        info.type = new DataPlusID().getClass();
    }

    @Override
    public void setProperty(int index, Object value) {
        SoapObject soapObject = new SoapObject();
        soapObject = (SoapObject) value;

        DataPlusID daten = new DataPlusID();
        daten.setProperty(0, soapObject.getProperty("data"));
        daten.setProperty(1, soapObject.getProperty("ID"));

        this.add(daten);
    }
} 
```

数据加号：

```
public class DataPlusID implements KvmSerializable
{

    private String data;
    private int ID;

    @Override
    public Object getProperty(int arg0) {

        switch(arg0)
        {
        case 0:
            return data;
        case 1:
            return ID;
        }        
        return null;
    }

    @Override
    public int getPropertyCount() {
        return 2;
    }

    @Override
    public void getPropertyInfo(int index, Hashtable arg1, PropertyInfo info) {
        switch(index)
        {
        case 0:
            info.type = PropertyInfo.STRING_CLASS;
            info.name = "data";
            break;
        case 1:
            info.type = PropertyInfo.INTEGER_CLASS;
            info.name = "ID";
            break;
        default:break;
        }
    }

    @Override
    public void setProperty(int index, Object value) {
        switch(index)
        {
        case 0:
            data = value.toString();
            break;
        case 1:
            ID = Integer.parseInt(value.toString());
            break;
        default:
            break;
        }
    }
} 
```

接收数据的代码：

```
public GetListResponse GetList(String liste) throws Exception{

SoapObject request = new SoapObject(Namespace, MethodGetList);

request.addProperty("list", liste);

    final SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.setOutputSoapObject(request);

    //this is the only necessary mapping
    envelope.addMapping(Namespace, "GetListResponse", new GetListResponse().getClass());

    try {
        HttpTransportSE transport = new HttpTransportSE(URL);
        transport.debug = true;

        transport.call(ActionGetList, envelope);

    } catch (Exception e){
        Log.d("SOAPEnvelope", "Fehler bei Serverabfrage: "+e.toString());
    }
    GetListResponse result = new GetListResponse();
    result = (GetListResponse) envelope.bodyIn;

    return result;
} 
```

处理数据：

```
new Thread(new Runnable() {
    public void run() {  
        try {
            @SuppressWarnings("unchecked")
            GetListResponse response = GetList("genre");

            DataArray array = (DataArray) response.getProperty(0);

            DataPlusID daten = (DataPlusID) array.getProperty(2);

            String x = (String) daten.getProperty(0);

            Log.d("SOAPEnvelope", "element 3 = "+x);
            //Log says "element 3 = information"
        } catch (Exception e) {
            Log.d("SOAPEnvelope", e.toString());
        }
    }
}).start(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-09T03:15:27.997

据我所知，您的 GetListResponse 类应该扩展 Vector 而不是包含它。在此处检查[文档](http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks#sending/receiving_array_of_complex_types_or_primitives)

```
 public class GetListResponse extends Vector<DataPlusID> 
                                implements KvmSerializable {
  } 
```

**更新**：
对不起，我以前从未尝试过对复杂对象数组使用映射方法。您可以尝试[另一种方法](http://roderickbarnes.com/blog/droid-chronicles-web-services-handling-complex-parameters)，通过使用构建循环迭代`Vector<SoapObject>`并手动获取其属性（您不需要`GetListResponse`类）。像这样的东西：

```
Vector<SoapObject> vectorOfSoapObject = (Vector<SoapObject>)envelop.getResponse();
for (SoapObject soapObject : vectorOfSoapObject) {
   // put all properties into  DataPlusID  object
   DataPlusID  dataPlusIDObj = new DataPlusID();
   dataPlusIDObj.setData(soapObject.getPropertyAsString("data"));
} 
```

这种方法在[文档](http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks#Adding_an_array_of_complex_objects_to_the_request)中，它应该可以工作。

# objective-c - Objective-c DenseMap 错误

> ID：14186281
> 
> 赞同：-2
> 
> 时间：2013-01-06T20:14:38.257
> 
> 标签：objective-c, debugging

我想知道为什么会发生这种情况，有时在我的多米诺骨牌游戏中，有时将多米诺骨牌放在桌子上时会显示此错误，对不起我的英语不好。我正在寻找可以帮助我解决这个问题的东西，这只是我发布我的应用程序所需要的。

![在此处输入图像描述](../Images/d35fe406d5baa0575d4735c64e7f64db.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:42:56.730

它与分配问题无关，甚至`denseMap()`（这实际上是[NSObject 分配机制](http://www.opensource.apple.com/source/objc4/objc4-532/runtime/NSObject.mm)内部的一个非常酷的功能）。当运行时检测到您的应用程序正在递归时，它会终止该进程。 `-[GameViewController playGame]`似乎是从自身内部呼唤自己。

# android - 在 Linaro 版本 > 4.4 中，内联强制转换为结构后分配给结构成员失败？

> ID：14186284
> 
> 赞同：1
> 
> 时间：2013-01-06T20:14:56.990
> 
> 标签：android, compiler-errors, kernel, arm, cross-compiling

为什么是下面这行内核源码：

```
((struct fb_var_screeninfo) (s5ptv_status.fb->var)).bits_per_pixel =
    ((struct fb_var_screeninfo) (fb->var)).bits_per_pixel; 
```

在 2010q1 的 GNU ARM 工具链和 Linaro 工具链 v4.4 中正常编译，但在使用 Linaro 工具链 v4.5 或 v4.6 时失败并出现以下错误？

```
drivers/media/video/samsung/tv20/s5p_stda_grp.c:614:12: error: lvalue required as left operand of assignment 
```

从 4.4 到 4.5 的某些更改是否导致此语法无效？

# vb.net - sql连接突然报错

> ID：14186285
> 
> 赞同：0
> 
> 时间：2013-01-06T20:15:02.043
> 
> 标签：vb.net, sql-server-ce, sqlconnection

两天前，我在项目的非相关部分工作时突然收到此错误：

> *“System.Data.SqlServerCe.SqlCeConnection”类型的值无法转换为“Microsoft.SqlServerCe.Client.SqlCeConnection”。*

自从我开始从事我的项目以来，这一直有效。有谁知道为什么？我找不到任何可能导致这种情况的信息。如果我尝试将我的`conn`对象实际转换为 Microsoft 连接，我会收到大量错误，但没有任何效果......

```
Imports System
Imports System.Text
Imports System.Security.Cryptography
Imports FinalH.FinalDataSet
Imports System.Data.SqlServerCe
Imports FinalH.FinalDataSetTableAdapters

Public Module conn

Public path As String = Application.StartupPath
Public ConString As String = "Data Source=|DataDirectory|\Final.sdf;Encrypt Database=True;Password=******;File Mode=shared read;Persist Security Info=False;"
Public con As New SqlCeConnection(ConString) 
```

在我的登录课程中

```
Private Sub LogIn_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    Try
         daUsers.Connection = con
         UsersTable = daUsers.GetData()

    Catch fail As Exception
        MsgBox(fail.Message)
    End Try

    StartAndLoad()
End Sub 
```

非常简单的东西，一切都很好我在一个完全不同的班级工作：我试图转换一个表格类型，没有工作，取消并删除那个班级，突然我得到了这些错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:29:07.447

根据错误消息，有人更改了对 SqlServerCE dll 的引用。`Microsoft.SqlServerCe.Client.dll`仅[用于从 SQL Server Management Studio 管理 SSCE DB](http://msdn.microsoft.com/en-us/library/ms171951%28v=sql.100%29.aspx)，不应在应用程序中使用。

# postgresql - 尝试测试与数据库的连接

> ID：14186286
> 
> 赞同：0
> 
> 时间：2013-01-06T20:15:17.773
> 
> 标签：postgresql, heroku

我正在使用[Heroku](https://dashboard.heroku.com/apps)，并创建了一个新应用程序和一个 Postgres 空数据库设置。

我已经安装了 Heroku 工具带，可以登录 Heroku 并成功运行以下命令：

```
c:\>heroku pg:info mydbname --app my-app-name 
```

和

```
c:\>heroku pg:credentials mydbname --app my-app-name 
```

现在，我已经创建了我的应用程序和一个空数据库，我正在尝试成功连接到数据库。

我正在使用红宝石。我有我的项目的本地副本，我正在尝试创建一个简单的 ruby​​ 文件来连接到数据库。我只是想证明我可以从我的应用程序连接到数据库。

[我在这里](https://devcenter.heroku.com/articles/rack#database-access)查看 activerecord 选项

但是，我运气不太好。

任何 heroku/postgres 大师都可以帮助我指出正确的方向。数据库为空。我要做的只是第一步成功连接到数据库。

红宝石文件：

```
require 'active_record'
require 'uri'

db = URI.parse(ENV['DATABASE_URL'] || 'postgres://localhost/jade')

ActiveRecord::Base.establish_connection(
  :adapter  => db.scheme == 'postgres' ? 'postgresql' : db.scheme,
  :host     => db.host,
  :port     => db.port,
  :username => db.user,
  :password => db.password,
  :database => db.path[1..-1],
  :encoding => 'utf8'
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:32:58.360

What is the content of ENV['DATABASE_URL']
Can you try it with **enable user-env-compile**

Making an app’s config vars present during the build allows for build-time optimizations to run in an environment that more closely resembles the runtime environment. This also allows config vars to be used to configure the build.

```
$ heroku labs:enable user-env-compile -a myapp
-----> Enabling user-env-compile for myapp... done
WARNING: This feature is experimental and may change or be removed without notice. 
```

May help you [missing-database-url](https://stackoverflow.com/questions/11502305/heroku-grails-missing-database-url-when-building-app-on-heroku)

**EDIT:**

confirm that your database YAML file is being parsed properly.

```
ruby -ryaml -e "File.open('config/database.yml') { |f| puts YAML.load(f).inspect }" 
```

**Configuring a PostgreSQL Database**

your config/database.yml customized to use PostgreSQL databases:

```
development:
  adapter: postgresql
  encoding: unicode
  database: MyDb
  pool: 5
  username: meuser
  password: 
```

**Another Tip**
Look if you have a file called `Gemfile` in the root directory of your Rails app.
Look for `gem 'pg'` otherwise add it.

# javascript - 在函数调用javascript之间保留变量值

> ID：14186288
> 
> 赞同：5
> 
> 时间：2013-01-06T20:15:22.087
> 
> 标签：javascript, ios, uiwebview

我有一些变量，我想在函数调用之间保留它们的值，任何人都可以分享如何在 javascript 中执行此操作。我曾尝试使用全局变量，但这无济于事。非常感谢帮助，例如在下面的代码中，每当调用内部函数跳转时，警报值总是相同的，它不会为每个函数调用增加。警报（this.prevVal）；和警报（this.currentVal）；

```
// We're using a global variable to store the number of occurrences
var MyApp_SearchResultCount = 0;
var currSelected = 0;
var countStr = 0; 

//var prevEl,el;

// helper function, recursively searches in elements and their child nodes
function MyApp_HighlightAllOccurencesOfStringForElement(element,keyword) {
  if (element) {
    if (element.nodeType == 3) {        // Text node
      while (true) {
        var value = element.nodeValue;  // Search for keyword in text node
        var idx = value.toLowerCase().indexOf(keyword);

        if (idx < 0) break;             // not found, abort

        var span = document.createElement("span");
        var text = document.createTextNode(value.substr(idx,keyword.length));
        span.appendChild(text);
        span.setAttribute("class","MyAppHighlight");
        span.style.backgroundColor="yellow";
        span.style.color="black";
        text = document.createTextNode(value.substr(idx+keyword.length));
        element.deleteData(idx, value.length - idx);
        var next = element.nextSibling;
        element.parentNode.insertBefore(span, next);
        element.parentNode.insertBefore(text, next);
        element = text;
        window.MyApp_SearchResultCount++;   // update the counter
        //countStr = MyApp_SearchResultCount;   

      }
    } else if (element.nodeType == 1) { // Element node
      if (element.style.display != "none" && element.nodeName.toLowerCase() != 'select') {
        for (var i=element.childNodes.length-1; i>=0; i--) {
          MyApp_HighlightAllOccurencesOfStringForElement(element.childNodes[i],keyword);
        }
      }
    }
  }
}

// the main entry point to start the search
function MyApp_HighlightAllOccurencesOfString(keyword) {

    alert("test");

  //MyApp_RemoveAllHighlights();
  MyApp_HighlightAllOccurencesOfStringForElement(document.body, keyword.toLowerCase());
    alert(window.MyApp_SearchResultCount);  
}

// helper function, recursively removes the highlights in elements and their childs
function MyApp_RemoveAllHighlightsForElement(element) {
  if (element) {
    if (element.nodeType == 1) {
      if (element.getAttribute("class") == "MyAppHighlight") {
        var text = element.removeChild(element.firstChild);
        element.parentNode.insertBefore(text,element);
        element.parentNode.removeChild(element);
        return true;
      } else {
        var normalize = false;
        for (var i=element.childNodes.length-1; i>=0; i--) {
          if (MyApp_RemoveAllHighlightsForElement(element.childNodes[i])) {
            normalize = true;
          }
        }
        if (normalize) {
          element.normalize();
        }
      }
    }
  }
  return false;
}

// the main entry point to remove the highlights
function MyApp_RemoveAllHighlights() {
  window.MyApp_SearchResultCount = 0;
  MyApp_RemoveAllHighlightsForElement(document.body);
}

function goNext(){
    jump(1);
}
function goPrev(){
    jump(-1);
}

var prevSelected = 0;
var currSelectedGlo = 0; 

this.prevVal = 0; 
this.currentVal = 0;

function jump(howHigh){

    this.prevVal = this.currentVal; 
    this.currentVal = this.currentVal + 1; 

    alert(this.prevVal);
    alert(this.currentVal);

    prevSelected = currSelected;
    currSelected = currSelected + howHigh;
    //window.currSelectedGlo = currSelected + howHigh; 
    //currSelected = window.currSelectedGlo;

    //alert("prevSelected" +prevSelected);
    //alert("window.currSelected "+ currSelected);

    //alert(window.MyApp_SearchResultCount);
    //alert(currSelected);
    if (currSelected < 0){  
        currSelected = window.MyApp_SearchResultCount + currSelected;
    }
    if (currSelected >= window.MyApp_SearchResultCount){
        currSelected = currSelected - window.MyApp_SearchResultCount;
    }

    prevEl = document.getElementsByClassName("MyAppHighlight")[prevSelected];
    //alert(window.prevEl);
    if (prevEl){
        prevEl.style.backgroundColor="yellow";
    }
    el = document.getElementsByClassName("MyAppHighlight")[currSelected]; 
    el.style.backgroundColor="green";
    el.scrollIntoView(true); //thanks techfoobar

} 
```

谢谢 djrecker

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T20:20:47.080

您可以使用全局变量：

```
var value = 0;

function next() {
    return value++;
}

console.log(next());
console.log(next()); 
```

或者更好的是，一个具有属性和方法的对象：

```
function Counter() {
    this.value = 0;
}

Counter.prototype.next = function() {
    return this.value++;
};

var counter = new Counter();
console.log(counter.next());
console.log(counter.next()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:34:00.133

```
this.prevVal = 0; 
this.currentVal = 0;

function jump(howHigh){    
    this.prevVal = this.currentVal; 
    this.currentVal = this.currentVal + 1; 
```

这不是创建全局变量的常用方法，如果用于此目的很容易出错。此外，在使用严格模式时，您可能会遇到额外的障碍。

为了使您的变量可靠地全局化，请执行

```
var prevVal = 0; 
var currentVal = 0;

function jump(howHigh){ 
    prevVal = currentVal; 
    currentVal = currentVal + 1; 
```

小提琴（我也改成`+1`）`+howHigh`：http: [//jsfiddle.net/4uGZ3/](http://jsfiddle.net/4uGZ3/)

你不能得到比这更多的全局，但如果你想让你的变量在页面导航、重新加载等中存活下来，你必须使用`LocalStorage`（在 IE7 中不起作用）或 cookie：

```
function jump(howHigh){ 
    var currentVal = +localStorage.getItem("currentVal"); // + to cast to number
    prevVal = currentVal; 
    currentVal = currentVal + 1; 
    localStorage.setItem("currentVal", currentVal); // store back 
```

再次，小提琴：http: [//jsfiddle.net/uKtcY/7/](http://jsfiddle.net/uKtcY/7/)

* * *

这是通常的使用模式`this`：

```
function X(){
    this.prevVal=0;
    this.currenVal=0;
}
X.prototype.jump = function(){
    this.prevVal = this.currentVal; 
    this.currentVal = this.currentVal + 1; 
...

//test:
var x1 = new X();
var x2 = new X();

x1.jump(1); // 0=>1
x2.jump(2); // 0=>2
x1.jump(3); // 1=>4

... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T20:24:17.793

有两种方法可以做到这一点：

1）一个全局变量：

```
 someVar = 0;

 function increaseSomeVar(){

      someVar++;
 } 
```

2）返回一个变量：

```
 var someVar = 0;

 function increaseSomeVar(somelocalVar){
    somelocalVar++;
    return(somelocalVar);   
 }

 someVar = increaseSomeVar(someVar); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-06T20:26:39.940

首先，使用全局变量通常是个坏主意。

由于 javascript 通过引用传递对象，因此您可以使用具有数字的对象作为您更新的属性。通常，您可以随意传递此对象，除非您调用的函数会使您失去当前范围，例如`setTimeout`. 在这种情况下，您可以使用 jquery 的 bind 函数来跟踪变量和范围，例如

```
 MyApp_HighlightAllOccurencesOfStringForElement.bind(this, element, keyword); 
```

# javascript - 如何将 AJAX 调用的数据存储在变量中？

> ID：14186290
> 
> 赞同：0
> 
> 时间：2013-01-06T20:15:25.103
> 
> 标签：javascript, jquery

> **可能重复：**
> [除了函数本身，不能在 jQuery 的 .ajax 方法中使用返回的数据](https://stackoverflow.com/questions/11247066/cant-use-returned-data-in-ajax-method-of-jquery-anywhere-but-the-function-itse)

我正在尝试将 AJAX 调用的返回值存储到变量中。

```
var getJSONData = function(){
    JSONData = $.getJSON('/api');
};

var reloadPage = function(json_data){
    //Do some DOM manipulation with the JSON data
    //console.log(json_data) returns undefined
};

reloadPage(getJSONData()); 
```

此代码不起作用。尽管当我直接访问它或使用以下代码时，该 api 仍然有效

```
$.getJSON('/api', function(data){console.log(data)}); 
```

这有效并获得了我想要的 JSON 数据。

知道如何使它工作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T20:19:04.303

怎么样

```
var getJSONData = function(callback){
    JSONData = $.getJSON('/api', callback);
};

var reloadPage = function(json_data){
    //Do some DOM manipulation with the JSON data
    //console.log(json_data) returns undefined
};

getJSONData(reloadPage); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T20:20:59.177

AJAX 代表**异步**JavaScript 和 XML。在您执行 AJAX 调用时，您的数据不会立即可用，因此您需要使用回调函数来响应稍后的响应。

jQuery AJAX 调用提供了您可以使用的[延迟对象。](http://api.jquery.com/category/deferred-object/)

```
var getJSONData = function(){
    return $.getJSON('/api');
};

var reloadPage = function(data){
    console.log(data);
};

getJSONData().done(reloadPage); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-06T20:21:18.030

`$.getJSON`不返回 JSON 而是一个承诺。

最简单的方法是像这样使用它：

```
 $.getJSON('/api', reloadPage); 
```

`reloadPage`当浏览器收到响应时，将使用 JSON 数据作为参数调用您的函数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-06T20:21:59.250

`$.getJSON()`是异步的。它可以通过回调访问：

```
var getJSONData = function(callback){
    $.getJSON('/api').success(data) {
       callback(data);
    };
};

var reloadPage = function(){
    getJSONData(function(json_data) {
    //Do some DOM manipulation with the JSON data
    //console.log(json_data) returns undefined
    });
};

reloadPage(); 
```

# c++ - C++ 指针超出范围

> ID：14186298
> 
> 赞同：-1
> 
> 时间：2013-01-06T20:16:18.753
> 
> 标签：c++, pointers

我试图寻找答案，但我找不到答案。我是 C++ 新手，所以指针对我来说还不直观。

`main`我有一个程序，当单击 GUI 上的按钮时，该程序具有和其他单独的功能。

编译时，我从 clickbutton 函数中得到一个错误，指出指针未声明。我知道这是一个范围问题，但我不确定如何处理这个问题。我知道这是一个非常简单的答案，但我似乎无法在网上找到它。请让我知道访问它的正确方法是什么。

```
int main () {
...
Contract contract;
contract.firstvalue = 1 // various variables that need to be set for this class
contract.secondvalue = 2 // various variables that need to be set for this class

Contract *pointer = &contract; //pointer
...
} 
```

点击按钮

```
void clickbutton(){
//clicking a button should change the contract values
pointer.firstvalue = 5;
}

void clickbutton2(){
//clicking a button should change the contract values
pointer.secondvalue = 10;
} 
```

编辑：好吧，我明白我做错了什么。我对在 main 之外声明感到困惑，因为我无法设置“firstvalue”和“secondvalue”。但是我可以在 main 中设置它们并在 main 之外声明变量。在这种情况下，我不需要指针。感谢和抱歉造成混乱的可怕代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:20:27.013

当且仅当按钮的代码在同一范围内时，才在 main() 之外声明这些变量。否则，将它们声明为静态，但看看它的作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T20:20:42.337

更新：好的。既然您已经修复了原始错误，那么您`clickbutton()`产生错误的原因是因为`pointer`变量**不在范围内**。

您将需要以下内容：

```
void clickbutton(Contract *pointer){
  //clicking a button should change the contract values
  pointer->firstvalue = 5;
} 
```

或者，如果您的合约是全局对象（始终存在），

```
Contract *pointer;
void clickbutton() {
  pointer->firstvalue = 5;
}
int main() {
  Contract c;
  pointer = &c;
  clickbutton();
} 
```

但这可能不是你想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T20:25:42.493

您应该修改您的函数，以便它们将您要用作参数的指针作为参数。听起来你正在寻找一个全局变量，如果可能的话应该避免。传递你的对象（如下所示）是一个更好的主意。请注意使用箭头`->`运算符而不是点`.`运算符，因为我们正在处理指针。

```
void clickbutton(Contract *pointer) {
    //clicking a button should change the contract values
    pointer->firstvalue = 5;
}

void clickbutton2(Contract *pointer) {
    //clicking a button should change the contract values
    pointer->secondvalue = 10;
} 
```

# objective-c - 带有 NSNumbers 数组的 NSPredicate

> ID：14186300
> 
> 赞同：3
> 
> 时间：2013-01-06T20:16:21.187
> 
> 标签：objective-c, ios, nspredicate, nsnumber

我有一个`NSNumber`s数组，例如：10015、12313、10016

我想检查数组是否包含我在 searchBar 中输入的整数。

我的代码：

```
NSPredicate *resultPredicate = [NSPredicate 
    predicateWithFormat:@"SELF CONTAINS[c] %d", [searchText intValue]];

self.searchResults = [newArr filteredArrayUsingPredicate:resultPredicate]; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-06T20:39:05.137

如果您只需要数组是否包含它的布尔值，那么您就想要。

```
self.searchResults = [newArr containsObject:@([searchText intValue])]; 
```

如果您实际上想要`NSNumber`结果中的 s 子集（在本例中为 1），则 contains 将不起作用。必须像这样检查每个值的相等性`NSNumber`......

```
NSPredicate *resultPredicate = [NSPredicate 
    predicateWithFormat:@"SELF == %d", [searchText intValue]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:30:14.607

如果您只想知道数字是否在数组中，则无需使用谓词：

```
BOOL occurs = [newArr containsObject:[NSNumber numberWithInt:[searchText intValue]]]; 
```

应该这样做。

# php - PHP 数组搜索和 fgetcsv

> ID：14186302
> 
> 赞同：0
> 
> 时间：2013-01-06T20:16:31.170
> 
> 标签：php, arrays, search, matching, fgetcsv

在这里坐了几个小时，但我看不出问题出在哪里。

我有 1 个文件： Gross_matching.csv：

```
Actionspiele,77
Strategiespiele,112 
```

关键字是“Actionspiele, Strategiespiele”。

并且想得到这个文件，并在“Actionspiele”之后搜索并想得到“77|112”。但我得到“77|77”。有人知道为什么吗？

```
<?php
if (!empty($articleData['keywords'])) {
    $temp_dir = "...";
    if (file_exists($temp_dir."gross_matching.csv")) {
        $csv = array();
        $file_gross = fopen($temp_dir."gross_matching.csv", 'r');
        while (($result = fgetcsv($file_gross, ",")) !== false) {
            $csv[] = $result;
        }
        fclose($file);
    } else {
        $articleData['attr_attr18'] .= " | File not found";
    }
    if (!empty($csv)) {
        $string = '';
        $keywords = explode(",", $articleData['keywords']);
        if(is_array($keywords)) {
            foreach($keywords as $key => $value) {
                $pos = array_search($value, $csv);
                $string .= $csv[$pos][1]."|";
            } 
            if (!empty($string)) {
                $articleData['attr_attr18'] = $string;
            } else {
                $articleData['attr_attr18'] .= " - String empty";
            } 
        }
    } else {
        $articleData['attr_attr18'] .= " - csv empty";
    }
} else {
    $articleData['attr_attr18'] .= " - not Gross";
}
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T20:25:05.250

您尝试使用在数组`array_search()`中查找字符串，但该数组的所有值本身都是数组，而不是字符串，因此搜索失败并返回。当您用作数组索引时，它被强制转换为 0，因此它始终为您提供数组的第一行。`"Actionspiele"``$csv``false``false`

我会重写你的数组构建代码也看起来像这样：

```
$csv = array();
while ( $result = fgetcsv( $file_gross, "," ) ) {
    $csv[ $result[0] ] = $result[1];
} 
```

这将使用 CSV 文件的第一列作为键，第二列作为`$csv`数组的值，所以它看起来像这样：

```
$csv = array(
    'Actionspiele' => 77,
    'Strategiespiele' => 112,
); 
```

然后就可以简单的直接在数组中查找关键字了，像这样：

```
$ids = array();
foreach ( $keywords as $keyword ) {
    $ids[] = $csv[ $keyword ];
}
$string = implode( '|', $ids ); 
```

# sql - SQL：更新存储过程以使用复合主键更新表

> ID：14186312
> 
> 赞同：0
> 
> 时间：2013-01-06T20:17:16.953
> 
> 标签：sql, sql-server-2008, stored-procedures

我有一个带有三列 c1、c2 和 c3 的 sql Table_A。c1 和 c2 构成此表的主键。

现在，c1 的值是其他一些 TableBB 中的主要值，我想更新表 A 中的一行，其中 c1 值与传递的参数匹配。

我怎样才能做到这一点。我使用的代码给了我错误

```
 create procedure sp_update
            @c1 char(20),
            @c3 char(20)
    AS

    UPDATE Table_A
            SET
            C3 = @c3
    WHERE C1 = @c1 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:18:38.647

如果您的表称为“表 A”，请尝试：

```
UPDATE  [Table A] 
```

否则，看起来您正在将表别名为“A”。但是您不能在`update`子句中使用别名。所以改变这个：

```
UPDATE  YourTable A 
```

至：

```
UPDATE  YourTable 
```

# objective-c - 从类的方法中显示 UILabel

> ID：14186313
> 
> 赞同：0
> 
> 时间：2013-01-06T20:17:26.790
> 
> 标签：objective-c, ios, class

我有一个名为“Fraction”的自定义类及其方法“display”，我想在 View a UILabel 上显示它：

```
-(void)display{
    UILabel *myLabel = [[UILabel alloc]initWithFrame:CGRectMake(10, 50, 200, 40)];
    [myLabel setBackgroundColor:[UIColor clearColor]];
    [myLabel setText:@"______"];
    [self.view addSubview:myLabel];
 } 
```

但我在最后一行收到此错误：

> 在“分数 *”类型的对象上找不到属性“视图”

我该如何解决？

（iPhone“单一视图”应用程序，Xcode 4.5.2）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T20:22:57.027

您正在尝试将子视图添加到不是 UIView 的东西 - 在您的“显示”方法的上下文中，“自我”指的是分数类型的对象。如果 Fraction 没有一个名为 view 的 UIView 属性，并且没有从具有该属性的属性（例如 UIViewController）继承，那么它没有理由识别您在那里尝试执行的操作。正确的方法是在“Fraction”中有一个实例方法，它返回一个带有分数表示的 NSString。使用此返回值来执行视图需要的任何操作，例如将其添加到 UILabel 的文本属性中。

理解正确的 MVC 很重要——在您的示例中，您完全滥用了 MVC 抽象并且让数据对象影响视图。（M 和 V 不应直接交互）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T23:58:48.917

在视图控制器.h

分数*分数；

在 view controller.m 添加这个

```
UILabel *myLabel = [[UILabel alloc]initWithFrame:CGRectMake(10, 50, 200, 40)];
    [myLabel setBackgroundColor:[UIColor clearColor]];
    [myLabel setText:[fraction methodForLabelString]];
    [self.view addSubview:myLabel]; 
```

尝试这个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T04:03:20.783

检查“self”是否为 ViewController。addSubView 是 UIView 中的一个方法。

# android - Gast-lib - 可以从 Android 主页激活语音识别吗？

> ID：14186314
> 
> 赞同：1
> 
> 时间：2013-01-06T20:17:30.297
> 
> 标签：android, speech-recognition, activation

我找到了Android的gast-lib，我觉得很有趣，特别是与语音识别和TTS相关的部分。我想知道是否可以在使用其他应用程序时从主屏幕激活语音识别，方法是说“你好”之类的关键字。我尝试在 Android Sensing Playground 应用程序中设置移动激活。它在应用程序处于活动状态时工作，但不能从主屏幕或其他应用程序。感谢关注和帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T01:19:28.643

是的，这是完全可能的。

您是否按照 Android Sensing Playground 中的这些步骤进行操作？

1.  点击“激活服务控制”
2.  点击“运动”
3.  单击返回，直到您看到主屏幕
4.  摇晃手机

这对我有用，我能够通过从主屏幕移动来触发服务。

# c# - Kinect 骨架缩放和定位

> ID：14186319
> 
> 赞同：1
> 
> 时间：2013-01-06T20:17:57.273
> 
> 标签：c#, xna, kinect

使用颜色和深度流，我获得了我的图像，并且成功地缩放和更改了它的位置。但是，我不能对 Skeleton 数据做同样的事情。我想要做的是缩放骨架并将其定位到我的图像上，这样我就可以将我的 Gus 面具放在我的头上，并将排球放在我的手上，尺寸合适。我怎样才能对骨架做同样的事情？

这是我缩放和定位图像的线：

```
spriteBatch.Draw(activeSkeletons[p.Key].image, position1, activeSkeletons[p.Key].image.Bounds, Color.White, 0f, Vector2.Zero, 1f, SpriteEffects.None, 0f); 
```

绘图功能：

```
private void DrawSkeleton(SpriteBatch spriteBatch, Vector2 resolution, Texture2D img)
{

    foreach (KeyValuePair<int, Player> p in activeSkeletons)
    {
        if (activeSkeletons[p.Key].image != null)
        {
            if (p.Key == indexes[0])
            {
                //Drawing the image - first player
                spriteBatch.Draw(activeSkeletons[p.Key].image, position1, activeSkeletons[p.Key].image.Bounds, Color.White, 0f, Vector2.Zero, 1f, SpriteEffects.None, 0f);
            }
            else {
                //Drawing the image - second player
                spriteBatch.Draw(activeSkeletons[p.Key].image, position2, activeSkeletons[p.Key].image.Bounds, Color.White, 0f, Vector2.Zero, 1f, SpriteEffects.None, 0f);
            }
        }

        foreach (Joint joint in p.Value.skeleton.Joints)
        {
            if (joint.TrackingState == JointTrackingState.Tracked)
            {
                //Drawing the skeleton
                var colorPoint = kinect.CoordinateMapper.MapSkeletonPointToColorPoint(joint.Position, kinect.ColorStream.Format);
                spriteBatch.Draw(img, new Rectangle(Convert.ToInt32(colorPoint.X), Convert.ToInt32(colorPoint.Y), 10, 10), Color.White);
                if (joint.JointType == JointType.HandRight && joint.TrackingState == JointTrackingState.Tracked)
                {
                    //Volleyball
                    dopKonum = new Vector2(colorPoint.X - dop.Width / 2, colorPoint.Y - dop.Height / 2);
                    spriteBatch.Draw(dop, dopKonum, Color.White);
                }
                else if (joint.JointType == JointType.Head && joint.TrackingState != JointTrackingState.NotTracked)
                {
                    //Gus Fring
                    gusKonum = new Vector2(colorPoint.X - gus.Width / 2, colorPoint.Y - gus.Height / 2);
                    spriteBatch.Draw(gus, gusKonum, Color.White);
                }
            }
        }
    }
} 
```

这就是它的外观：

![Kinect](../Images/89856706be7c9c299bbf7c86b44ff236.png)

希望我解释得很好。

# mongodb - Dart MongoDB在插入后获取ID

> ID：14186321
> 
> 赞同：5
> 
> 时间：2013-01-06T20:18:11.907
> 
> 标签：mongodb, dart

如何使用 Dart 获取最后一次插入/保存到 mongoDB 的生成的 Id？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-07T08:51:08.853

默认情况下，mongo_dart 让 mongodb 服务器为插入的对象创建 id，并且不提供获取这些 id 的方法。

为了方便您的场景，您可以在插入之前预先创建对象 ID。我添加了新的测试来证明这一点。请注意，_id 字段必须是地图中的第一个字段 - 这是 mongodb 所要求的。

```
testInsertWithObjectId(){
  Db db = new Db('${DefaultUri}mongo_dart-test');
  DbCollection coll;
  var id;
  var objectToSave;
  db.open().chain(expectAsync1((c){
    coll = db.collection('testInsertWithObjectId');
    coll.remove();
    objectToSave = {"_id": new ObjectId(),"name":"a", "value": 10};
    id = objectToSave["_id"];
    coll.insert(objectToSave);
    return coll.findOne(where.eq("name","a"));
  })).then(expectAsync1((v1){
    expect(v1["_id"],id);
    expect(v1["value"],10);
    db.close();
  }));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:29:38.870

如果你插入`myObj`你的数据库，我很确定你可以做得到`myObj["_id"]`你`id`的对象。

或者您是否正在处理您不再拥有插入的最后一个对象的句柄的情况？

# ubuntu-12.04 - 设置分辨率 xrandr --addmode

> ID：14186322
> 
> 赞同：1
> 
> 时间：2013-01-06T20:18:13.657
> 
> 标签：ubuntu-12.04, screen-resolution, xrandr

我无法在 virtualbox 中使用 xrandr 设置屏幕分辨率。这是一个运行 ubuntu 12.04 的 VM，驱动程序支持此分辨率，因为来自同一 iso 的 VM 在同一台机器上运行它。为什么会出现 X Error of failed request: BadMatch (invalid parameter attributes)？

步骤 0

```
xrandr
Screen 0: minimum 64 x 64, current 1024 x 768, maximum 32000 x 32000
VBOX0 connected 1024x768+0+0 0mm x 0mm
   1024x768       60.0*+
   800x600        60.0  
   640x480        60.0 
```

步骤1

```
cvt 1920 1080
1920x1080 59.96 Hz (CVT 2.07M9) hsync: 67.16 kHz; pclk: 173.00 MHz
Modeline "1920x1080_60.00"  173.00  1920 2048 2248 2576  1080 1083 1088 1120 -hsync +vsync 
```

第2步

```
xrandr --newmode "1920x1080_60.00"  173.00  1920 2048 2248 2576  1080 1083 1088 1120 -hsync +vsync 
```

第 3 步

```
~$ xrandr --addmode VBOX0  1920x1080_60.00
   X Error of failed request:  BadMatch (invalid parameter attributes)
   Major opcode of failed request:  150 (RANDR)
   Minor opcode of failed request:  18 (RRAddOutputMode)
   Serial number of failed request:  20
   Current serial number in output stream:  21 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-03T01:09:01.120

如果您之前已完成此过程，那么当您尝试使用相同的名称时会发生一些事情。将模式命名为其​​他名称，然后重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-30T20:57:48.533

我认为问题是分号

现在试试

```
xrandr --addmode VBOX0  "1920x1080_60.00" 
```

# php - php和正则表达式，如果用户输入美元符号和百分号，如何去掉它？

> ID：14186327
> 
> 赞同：1
> 
> 时间：2013-01-06T20:18:26.073
> 
> 标签：php, regex, ereg-replace

基本上，这需要做的只是接受一个价格值，它只能是 40 或 39.95 或 100.09 或 4 等，如果用户在字段中输入除数字以外的任何内容，则会返回错误。

我的问题：我该如何更改它，以便如果用户在输入字段中输入一个美元符号，它只是被剥离而不是在那种特定情况下返回错误？

* * *

```
if (ereg_replace('/^\d+(\.\d{2})?$/', $_POST['itemAmt'])) {
    echo '<h1>The original cost of the item: $' . $_POST['itemAmt'] . ' </h1>';
} else {
    echo '<h1 style="color:red; font-weight:900;">The price value was not numeric, try again :) </h1><br>';
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T20:19:32.827

```
$itemAmt = str_replace(array('$', '%'), '', $_POST['itemAmt']); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T20:21:22.907

```
preg_replace('#[^0-9\.]+#','',$_POST['itemAmt']); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T20:32:41.427

可能的方式

```
if ( preg_match( '/^(\d+(?:\.\d+)?)[\$%]?$/', $_POST['itemAmt'] ) ) {
    $validprice = preg_replace( '/^(\d+(?:\.\d+)?)[\$%]?$/', '\1', $_POST['itemAmt'] );
} else {
    // invalid input
} 
```

# c# - 在 C# 中获取当前的 Visual Studio 实例（EnvDTE）

> ID：14186330
> 
> 赞同：4
> 
> 时间：2013-01-06T20:18:45.860
> 
> 标签：c#

如何在 C# 中获取 Visual Studio 的当前实例（EnvDTE）？

如果您有具有以下代码行的多个进程 Visual Studio，我将得到该对象`EnvDTE80.DTE2`：

```
EnvDTE80.DTE2 dte2 = (EnvDTE80.DTE2)System.Runtime.InteropServices.Marshal.GetActiveObject("VisualStudio.DTE.11.0"); 
```

在这一点上，我怎样才能获得当前的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T20:45:27.830

使用运行对象表获取所有实例，然后选择所需的一个。

我不认为你能做得比这更好。它类似于将调试器附加到 VS 实例的方式。您必须从列表中选择一个。

```
IEnumerable<DTE> GetInstances()
{
    IRunningObjectTable rot;
    IEnumMoniker enumMoniker;
    int retVal = GetRunningObjectTable(0, out rot);

    if (retVal == 0)
    {
        rot.EnumRunning(out enumMoniker);

        IntPtr fetched = IntPtr.Zero;
        IMoniker[] moniker = new IMoniker[1];
        while (enumMoniker.Next(1, moniker, fetched) == 0)
        {
            IBindCtx bindCtx;
            CreateBindCtx(0, out bindCtx);
            string displayName;
            moniker[0].GetDisplayName(bindCtx, null, out displayName);
            Console.WriteLine("Display Name: {0}", displayName);
            bool isVisualStudio = displayName.StartsWith("!VisualStudio");
            if (isVisualStudio)
            {
               var dte = rot.GetObject(moniker) as DTE;
               yield return dte;
            }
        }
    }
}

[DllImport("ole32.dll")]
private static extern void CreateBindCtx(int reserved, out IBindCtx ppbc);

[DllImport("ole32.dll")]
private static extern int GetRunningObjectTable(int reserved, out IRunningObjectTable prot); 
```

# jenkins - ImageMagick 在命令行中工作，但在 Jenkins Execute shell 中失败

> ID：14186332
> 
> 赞同：0
> 
> 时间：2013-01-06T20:18:55.613
> 
> 标签：jenkins, imagemagick, ghostscript

我的 Jenkis CI 的一项工作是通过 ImageMagick 和 GhostScript 转换 PDF（嗯，简而言之，它最终会做到）。奇怪的是，当从命令行（通过 SSH）调用时，它可以工作，但在 Jenkins 中启动失败。更奇怪的是底层 gs 命令（convert 使用 gs 转换 PDF）有效。

脚本：

```
#!/bin/bash -e
export MAGICK_TMPDIR=`pwd`/tmp
/usr/local/bin/convert -verbose /Users/Shared/Jenkins/Home/jobs/test/workspace/example.pdf /Users/Shared/Jenkins/Home/jobs/test/workspace/example_1.jpg 
```

詹金斯输出：

```
[workspace] $ /bin/bash -e /var/folders/hm/dm88jd4j2f328jj96hglfbk000009c/T/hudson3825950836307624243.sh
"gs" -q -dQUIET -dSAFER -dBATCH -dNOPAUSE -dNOPROMPT -dMaxBitmap=500000000 -dAlignToPixels=0 -dGridFitTT=2 "-sDEVICE=pngalpha" -dTextAlphaBits=4 -dGraphicsAlphaBits=4 "-r72x72" "-sOutputFile=/Users/Shared/Jenkins/Home/jobs/test/workspace/tmp/magick-QkcQLTEO-%08d" "-f/Users/Shared/Jenkins/Home/jobs/test/workspace/tmp/magick-b0tr61Ng" "-f/Users/Shared/Jenkins/Home/jobs/test/workspace/tmp/magick-scEOIbtN"
convert: Postscript delegate failed `/Users/Shared/Jenkins/Home/jobs/test/workspace/example.pdf': No such file or directory @ error/pdf.c/ReadPDFImage/668.
convert: missing an image filename `/Users/Shared/Jenkins/Home/jobs/test/workspace/example_1.jpg' @ error/convert.c/ConvertImageCommand/3016. 
```

Jenkins v. 1.496 在带有 Java 1.6.0_37 的 OS X 10.7.5 上运行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T15:17:11.010

正如[Sagar](https://stackoverflow.com/users/289812/sagar)建议的那样，我检查了终端中设置的环境变量。事实证明，导出 PATH 可以解决问题（这是合乎逻辑的，因为 GS 和 IM 是通过 brew 安装到不在 PATH 中的 /usr/local 的）。

# objective-c - 如何在 ARC 下自动释放未返回的对象

> ID：14186336
> 
> 赞同：2
> 
> 时间：2013-01-06T20:19:16.240
> 
> 标签：objective-c, memory-management, automatic-ref-counting, foundation

考虑这样一个函数：

```
void* getData()
{
    void* data= malloc(32);
    NSData* __autoreleasing dataObject= [NSData dataWithBytesNoCopy: data length: 32 freeWhenDone: YES]
    return data;
} 
```

如果我尝试执行此代码并在返回的内存区域中打印值（尽管它们没有初始化，但只是为了进行测试），我不会得到任何异常。

但是，如果我尝试放置一个断点并查看活动对象的映射，则没有活动的 NSData 对象，尽管数据仍在堆中，为什么？

我会知道如何返回一个自动释放的对象，就像在 ARC 之前一样。ARC 处理所有事情，但在这种情况下，数据被释放，因为我退出了函数范围。如何在通话后使其活跃并自动释放？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:48:14.250

这是不可能的。ARC 旨在自动释放不可访问的对象。由于 NSData 对象是本地的并且没有返回，所以它不能被使用，所以 ARC 将它释放。

从您发布的代码来看，您似乎希望返回指向某些数据的指针，即使它不是objective-c 对象，也会自动释放这些数据。您可能还希望能够使用生成它的函数内的 NSData API 访问这些数据。您在这里有几个选择。

1.  更改您的代码以返回 NSData 对象。如果调用代码想要直接访问缓冲区，它可以使用 NSData 的`bytes`方法。但是，如果您的代码是从 C 调用的，这将不起作用。

2.  停止尝试自动释放 C 数据。好的 C 代码应该知道何时需要释放数据，所以这应该不是问题。只需将您的代码更改为`freeWhenDone: NO`并在处理完数据后使用调用代码`free()`。

3.  将此函数放在其自己的文件中并禁用该文件的 ARC。这允许您通过手动调用来做您想做的事情`autorelease`，但您还必须手动处理函数其余部分的引用计数。

4.  结合 1 和 3。有一个使用 ARC 并返回 NSData 对象的函数，以及一个没有 ARC 的包装函数，它调用第一个获取自动释放的对象，然后从结果中返回缓冲区指针。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T22:29:41.717

一种方法是添加第二个功能

```
NSData *autoreleaseBufferOfLength(void *bytes, NSUInteger length) 
{ 
    return [NSData dataWithBytesNoCopy:bytes length:length freeWhenDone:YES]; 
} 
```

此函数将返回一个自动释放的`NSData`对象。

从缓冲区返回函数调用此函数

```
void *getAutoreleasedBuffer(NSUInteger length)
{
    void *buffer = malloc(length);
    if (buffer) {
        autoreleaseBufferOfLength(buffer, length);
    }
    return buffer;
} 
```

`NSData`从返回的对象`autoreleaseBufferOfLength`在自动释放池中，因此当自动释放池耗尽时，缓冲区将被释放（因为`NSData`创建的对象`autoreleaseBufferOfLength`随后被释放）。

我使用这个函数测试**了这个调试**`main`

```
int main(int argc, const char * argv[])
{
    @autoreleasepool {
        __unused void * buffer = autoreleasingBuffer(32);

        NSLog(@"%s:exiting @autoreleasepool block", __PRETTY_FUNCTION__);
    }
    NSLog(@"%s:exited @autoreleasepool block", __PRETTY_FUNCTION__);
    return 0;
} 
```

`-[NSConcreteData dealloc]`并通过在操作中添加符号断点`po @"deallocating NSConcreteData"`并选中“评估后自动继续”。这是输出

```
[53030:303] int main(int, const char **):exiting @autoreleasepool block
(NSString *) $0 = 0x0000000100300530 deallocating NSConcreteData
[53030:303] int main(int, const char **):exited @autoreleasepool block 
```

然后我测试**了 release**，稍微改变了测试，添加了一个设置在的`__weak`全局变量，`g_data``autoreleaseBufferOfLength`

```
__weak NSData *g_data = nil;
NSData *autoreleaseBufferOfLength(void *bytes, NSUInteger length) 
{ 
    return (g_data = [NSData dataWithBytesNoCopy:bytes length:length freeWhenDone:YES]); 
} 
```

并更改主登录：

```
int main(int argc, const char * argv[])
{
    @autoreleasepool 
    {
        __unused void * buffer = autoreleasingBuffer(32);

        NSLog(@"%s:exiting @autoreleasepool block; g_data = %@", __PRETTY_FUNCTION__, g_data);
    }
    NSLog(@"%s:exited @autoreleasepool block; g_data = %@", __PRETTY_FUNCTION__, g_data);
    return 0;
} 
```

在构建发布和运行时，这是输出：

```
[53934:707] int main(int, const char **):exiting @autoreleasepool block; g_data = 00000000 00000070 00000000 00000070 10000000 00000000 00000000 00000000>
[53934:707] int main(int, const char **):exited @autoreleasepool block; g_data = (null) 
```

这些测试表明，将调用包装`dataWithBytesNoCopy:length:freeWhenDone:`在第二个函数`autoreleaseBufferOfLength`中具有创建 NSData 对象并将其放置在自动释放池中的效果。

**注意**：这*不是*一个好主意。正如@ughoavgfhw 在他的回答中所描述的那样，通过排空自动释放池来实现`malloc`'d的最佳方法`free`是添加一个在没有 ARC 的情况下构建的文件（使用）。`-fno-objc-arc`然而，这种方法可能会引起一些兴趣。

# ruby-on-rails-3 - Twitter Bootstrap Rails：单击“新建”时保存

> ID：14186344
> 
> 赞同：0
> 
> 时间：2013-01-06T20:20:19.910
> 
> 标签：ruby-on-rails-3, twitter-bootstrap, controller, mongoid, save

我在创建成员（用于表）时遇到问题。每次我点击“新成员”，创建一个，它会自动保存一个新成员，就好像我点击了“提交”一样。每次我在调整表单时重新加载页面时，也会创建一个成员。这可能是我的控制器上的错字。这是'def new'。

```
def new
  @member = Member.new
  @member.association_id = @association.id
  @member.save
  3.times { @member.submembers << Submember.new() }
end 
```

否则，某些脚本可能会出错。问题是，我该如何解决这个问题？

谢谢你。

如果需要任何其他信息，请在此处评论。

错误信息：

```
Problem:
Calling Document.find with nil is invalid.
Summary:
Document.find expects the parameters to be 1 or more ids, and will return a single document if 1     id is provided, otherwise an array of documents if multiple ids are provided.
Resolution:
Most likely this is caused by passing parameters directly through to the find, and the parameter    either is not present or the key from which it is accessed is incorrect. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T20:35:57.783

您不应该在新操作中保存成员。您的代码应如下所示：

```
def new
  @member = Member.new      
  3.times { @member.submembers << Submember.new() }
end 
```

并且表单应该提交以创建操作，您可以在其中使用 Association_id 保存模型：

```
def create
  @member = Member.new(params[:member])
  @member.association_id = @association.id
  if @member.save
    redirect_to members_path, :notice => "Member was successfully created"
  else
    render :new
  end
end 
```

# javascript - 从函数将多个值返回到表单

> ID：14186355
> 
> 赞同：0
> 
> 时间：2013-01-06T20:21:14.007
> 
> 标签：javascript, forms

我是 JavaScript 新手，在将多个值返回到表单时遇到问题。这是我的代码：

表格：

```
<form name="form1">

First option
<input type="text" size="20" name="OptA" rows="1">

Second option
<input type="text" size="20" name="OptB" rows="1">

<input type="button" name="calc" value="Calculate" onclick="Evaluate(document.form1.OptA, document.form1.OptB, document.form1.TheStr);">

<input type="text" size="5" name="TheStr" readonly><input type="text" size="5" name="TheSte" readonly>

</form> 
```

剧本：

```
function Evaluate(OptA, OptB, TheStr)
{       
    var A_Count = 0;
    var B_Count = 0;
    var C_Count = 0;
    var D_Count = 0;
    var Str1 = 0;
    var Str2 = "";
    var Str3 = 0;
    var Str4 = "";
    var Char1 = "";
    var Char2 = "";
    var Char3 = "";
    var Char4 = "";
    var Total = 0;
    var TheOptions = OptA.value + OptB.value;
    var A1 = "";
        TheStr.value = "";
        TheOptions = TheOptions.toUpperCase();
        for (var i = 0; i < TheOptions.length; i++)
        {
                if (TheOptions.charAt(i) == 'A')
                {       A_Count++;      }
                else if (TheOptions.charAt(i) == 'B')
                {       B_Count++;      }
        }
        Str1 = "" + A_Count+B_Count;
        Str2 = "";
        while ((Str1.length > 2) & (Count < 20))
        {
                Str2 = "";
                for (var i = 0; i < Str1.length - 1; i++)
                {
                        Char2 = Str1.charAt(eval(i+1));
                        Str2 = Str2 + (parseInt(Str1.charAt(i)) + parseInt(Str1.charAt(eval(i+1))));
                }
                Count++;
                Str1 = Str2;
        }
        if (Count > 19)
        {
                TheStr.value = '0%';
        }
        else
        {
                TheStr.value = parseInt(Str2,10) + '%';
        }

    for (var i = 0; i < TheOptions.length; i++)
        {
                if (TheOptions.charAt(i) == 'C')
                {       C_Count++;      }
                else if (TheOptions.charAt(i) == 'D')
                {       D_Count++;      }
        }
        Str3 = "" + C_Count+D_Count;
        Str4 = "";
        while ((Str3.length > 2) & (Count < 20))
        {
                Str4 = "";
                for (var i = 0; i < Str3.length - 1; i++)
                {
                        Char4 = Str3.charAt(eval(i+1));
                        Str4 = Str4 + (parseInt(Str3.charAt(i)) + parseInt(Str3.charAt(eval(i+1))));
                }
                Count++;
                Str3 = Str4;
        }
        if (Count > 19)
        {
                TheSte.value = '0%';
        }
        else
        {
                TheSte.value = parseInt(Str2,10) + '%';
        }

    TheStr=(TheStr.value, TheSte.value)

} 
```

由于某种原因，它只向第一个输入框返回一个值，第二个输入框保持空白。我想我的问题是弄清楚如何返回多个值，然后如何将其解析到两个输入框中。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:24:55.827

两个输入都命名为“TheStr”。如果我理解正确，您需要将第二个输入命名为“TheSte”，并在您的 Evaluate 函数中声明它。

编辑：另外，最后的说明

```
TheStr=(TheStr.value, TheSte.value) 
```

没有效果。在您的函数中 TheStr 是一个文本输入。您可以通过设置 value 属性来更改其值

# javascript - Javascript 函数 - FB oAuth 函数转它为 twitter oAuth？

> ID：14186369
> 
> 赞同：2
> 
> 时间：2013-01-06T20:23:01.520
> 
> 标签：javascript, jquery, ajax, refactoring, twitter-oauth

我实际上正在使用这个 js 函数进行 facebook 连接。

```
window.fbAsyncInit = function(){
   FB.init({ 
    appId: '371***********',
     status: true,
      cookie: true,
       xfbml: true ,
       oauth:true,
       channelUrl: '<?php echo base_url(); ?>fb-channel-file.php' //this domain
     });
};
(function() {
   var e = document.createElement('script');
   e.type = 'text/javascript';
   e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
   e.async = true;
   document.getElementById("fb-root").appendChild(e);
}());
// FB LOGIN -->

function FBlogin(){
  FB.getLoginStatus(function(r){
    FB.login(function(response) {
      if(response.authResponse) {
        $.ajax({
          type:'GET',
          url: _config_base_url+'/auth/ajax_login',
          dataType:'json',
          data:{'fb_at':response.authResponse.accessToken},
          beforeSend:function(){
            notify('Loading ...',false,'notify-info');
          },
          error:function(_response){
              notify('An error occurred, please try again later.',false); 

            },
            success:function(json){
              notify_destroy();

              window.location.href= _config_base_url+'/profile';

            }
          });
      } else {}
    },{scope:'email'/*,user_birthday,user_location*/});
  });
} 
```

现在我想重现相同/完全相同的允许人们通过连接的功能`Twitter`，我只是将其转为`Google+`，但我真的不明白如何将其转为`Twitter oAuth.`

任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:20:33.137

## 更新

*   [这是一个投票赞成的答案，其中包含一个明确的示例和关于安全性的评论讨论。](https://stackoverflow.com/a/1286921/1085891)来自：[使用 OAuth 和 javascript 的应用程序](https://stackoverflow.com/questions/1221371/application-that-uses-oauth-and-javascript)

*   可能有用的教程

    *   [操作方法：在 JavaScript 中保护 OAuth](http://derek.io/blog/2010/how-to-secure-oauth-in-javascript/)
    *   [如何使用 Twitter OAuth 对用户进行身份验证](http://net.tutsplus.com/tutorials/php/how-to-authenticate-users-with-twitter-oauth/)

## 原始答案

*   这个对[JavaScript OAuth 使用 Twitter 登录的](https://stackoverflow.com/questions/2470694/javascript-oauth-sign-in-with-twitter)[答案](https://stackoverflow.com/a/5003176/1085891)读起来像是由于安全原因，它不可能或不是最好的方法。

    > 这样做的问题是任何查看您的页面的人现在也可以查看您的消费者密钥和必须保密的秘密。
    > 
    > ...
    > 
    > **Twitter 确实声明必须**尽一切可能将这些值保密以避免这种情况发生
    > 
    > 不幸的是，目前没有办法在基于浏览器的 JavaScript 中安全地使用 oAuth。

*   [jsOAuth](https://github.com/bytespider/jsOAuth)可能会有所帮助，但正如上面的答案所述，安全性是一个问题。

    > jsOAuth 是一个实现 OAuth 协议的 javascript 库。jsOAuth 旨在形成 Twitter 和 Yahoo 等自定义客户端的基础。
    > 
    > ...
    > 
    > **出于安全原因，jsOAuth 不在浏览器中运行。此处仅提及浏览器用于运行测试套件。**

# jar - Java JAR - 线程“主”java.lang.NoClassDefFoundError 中的异常

> ID：14186372
> 
> 赞同：-1
> 
> 时间：2013-01-06T20:23:14.313
> 
> 标签：jar

我在**Ubuntu**上工作。我制作了使用 3 个类的简单 GUI 应用程序。Main 是包含 main 方法的 Test.class。我已经从控制台级别将它们全部打包到 JAR 中。现在我有了“kalkulator.jar”，其中包含：Test.class、MyFrame.class、MyPanel.class 和 META-INF 文件夹。在 META_INf 中有 MANIFEST.MF。MANIFEST.MF 中的内容是：“主类：测试”和换行符。现在我尝试使用以下命令从控制台打开我的 JAR：java -jar kalkulator.jar 我得到：“线程中的异常“main”java.lang.NoClassDefFoundError：测试（错误名称：myproject/Test”）myproject 是我所有类的包. 那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:31:21.087

您需要执行以下操作：

1.  确保 jar 中的目录层次结构与包层次结构绝对匹配。这些类必须位于 jar 中名为“myproject”的目录中。如果他们只是处于顶级水平，那将是行不通的。

2.  使用 main 方法使 Main-Class 名称成为类的完全限定名称。（即 myproject.Test）。

3.  学习使用构建工具（例如 ant）来完成所有这些工作。

# c++ - 未定义对“静态成员函数内的静态类成员变量”的引用

> ID：14186373
> 
> 赞同：11
> 
> 时间：2013-01-06T20:23:18.917
> 
> 标签：c++, static, static-methods, static-members

我实际上是在尝试实现分页的模拟，在我的内存管理器中，我尝试创建一个静态页表，但是当我尝试打印它时它给出了引用错误。

```
#ifndef MEMORYMANAGER_H
#define MEMORYMANAGER_H
#include "memory.h"

class MemoryManager
{
    private:
        PhysicalMemory RAM;
        LogicalMemory VM;
        int offsetValue;
        static int ** pageTable;
    public:
        MemoryManager();
        bool addProcess(TimeSliceRequest);
        void printVirtualMemory();
        /*
         * Page Table Initialization
         **/
        static void initializePageTable(){
            pageTable = new int * [pageSize];
            for (int i=0; i<pageSize; i++) {
                pageTable[i] = new int [2];
            }
        }
        static int getPageTabe(int x, int y) {
            return MemoryManager::pageTable[x][y]; // undefined reference to `MemoryManager::pageTable'
        }
        static void printPageTable(){
            for(int i=0; i<pageSize; i++){
                for(int j=0; j<2; j++) {
                    cout << getPageTabe(i,j);
                }
                cout << endl;
            }
        }
};

#endif // MEMORYMANAGER_H 
```

从很长一段时间得到这个错误，请帮助

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-06T20:25:05.860

您只*声明*成员`pageTable`变量，您还必须*定义*它。这是通过基本上重复实现（源）文件中的声明来完成的：

```
int ** MemoryManager::pageTable; 
```

# vb.net - 无法在 vb.net 中使用 twitterizer 检索主时间线

> ID：14186376
> 
> 赞同：0
> 
> 时间：2013-01-06T20:23:29.200
> 
> 标签：vb.net, twitter, timeline, twitterizer

我正在尝试构建一个桌面 twitter 应用程序。

我已经把 oauth 搞定了，可以发布状态没有问题。

我不是想检索用户的家庭时间线，但我没有这样的运气。

任何帮助是极大的赞赏。这是我的代码：

```
 Dim tokens As New OAuthTokens
    tokens.AccessToken = requestToken2.Token
    tokens.AccessTokenSecret = requestToken2.TokenSecret
    tokens.ConsumerKey = consumerKey
    tokens.ConsumerSecret = consumerSecret

    Dim lastStatusID As Decimal = 123456

    Dim properties As New TimelineOptions()
    properties.UseSSL = True
    properties.SinceStatusId = lastStatusID

    Dim hometimeline As TwitterResponse(Of TwitterStatusCollection) = TwitterTimeline.HomeTimeline(tokens, properties)

    Dim tweet As String

    For Each tweet In hometimeline

    Next 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T10:48:44.957

TwitterTimeline.HomeTimeline 返回一个 TwitterResponse。此 TwitterResposen 包含一个属性 ResponseObject，其中包含您想要的推文。ResponseObject 是 TwitterStatus 对象的集合，其中包含属性 Text，即状态文本。

你的代码应该是这样的：

```
Dim hometimeline As TwitterResponse(Of TwitterStatusCollection) = TwitterTimeline.HomeTimeline(tokens, properties)

Dim tweet As TwitterStatus

For Each tweet In hometimeline.ResponseObject

Console.Writeline(tweet.Text)

Next 
```

PS。我不熟悉VB语法，所以如果我错了，请纠正我。

# python - scipy稀疏矩阵和numpy数组之间的点积

> ID：14186385
> 
> 赞同：1
> 
> 时间：2013-01-06T20:25:05.127
> 
> 标签：python, numpy

我试图在 scipy 稀疏矩阵和 numpy.ndarray 之间找到点积。张量是指theano.tensor。X 是稀疏矩阵，W_hidden 是 ndarray。b_hidden 也是 ndarray。

```
 tensor.tanh(tensor.dot(X,self.W_hidden)+self.b_hidden) 
```

然而，这条线有几个问题。我无法计算点积。除此之外，似乎我无法将常量 ndarray 添加到稀疏矩阵中，此外，我无法应用 tanh 函数。我得到的错误是：

```
 TypeError("Cannot convert %s to TensorType" % str_x, type(x)) 
```

非常感谢我如何解决这个问题的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T07:21:37.640

尽管我没有处理任何张量，但我最近遇到了与您相同的两个问题。如果您仍在寻求帮助：

1) 将 W_hidden 和 b_hidden 设为 numpy 矩阵而不是 ndarray。例如，如果 b_hidden 的形状为 (n,)，则其矩阵形式的形状为 (n,1)。这将允许它被添加到另一个矩阵，无论是否稀疏。

2) 使用 * 代替点，因为 X 和 W_hidden 都是矩阵。顺便说一句，W_hidden 的形状是什么？

# javascript - 使用javascript将点添加到svg路径

> ID：14186393
> 
> 赞同：1
> 
> 时间：2013-01-06T20:25:27.857
> 
> 标签：javascript, bezier

我有一个 SVG 路径，格式如下：

```
M352.793,422 C323.175,422 299.164,397.99 299.164,368.371 C299.164,338.753 323.175,314.742 352.793,314.742 C382.411,314.742 406.422,338.753 406.422,368.371 C406.422,397.99 382.411,422 352.793,422 z 
```

我想在不改变形状的情况下添加任意数量的点，均匀分布，所以最终得到这样的结果：

```
M352.793,422 C337.895,422 324.416,415.925 314.698,406.118 C305.095,396.427 299.164,383.092 299.164,368.371 C299.164,352.91 305.707,338.978 316.174,329.191 C325.759,320.228 338.635,314.742 352.793,314.742 C366.299,314.742 378.639,319.735 388.068,327.975 C399.316,337.806 406.422,352.259 406.422,368.371 C406.422,383.21 400.395,396.641 390.656,406.351 C380.956,416.021 367.572,422 352.793,422 z 
```

我知道这在数学上是可能的，因为它是由贝塞尔曲线定义的，它本身可以在任意点分割，而不改变曲线，但是弄清楚如何进行数学运算并生成新路径似乎是一项艰巨的任务细绳。

有没有可以提供帮助的图书馆？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T00:50:38.280

从我能找到的内容来看，有很多关于从初始点绘制贝塞尔曲线的 javascript 帮助，但是我没有找到用于逆向工程的帮助。所以我认为你有两种可能的方法，

**1)**

对曲线进行逆向工程以获得原始点，然后用较低的`t_step`. 下面的链接显示了它是如何完成的基本信息。

[逆向工程贝塞尔曲线](http://polymathprogrammer.com/2007/06/27/reverse-engineering-bezier-curves/)

[对贝塞尔曲线进行逆向工程](https://stackoverflow.com/questions/3032996/reverse-engineering-a-bezier-curve)

**2)**

尽管您可能会失去一些精度，但我觉得应该可以使用三次样条插值来估计每个点之间的曲线。

[样条插值](http://en.wikipedia.org/wiki/Spline_interpolation)

# lua - Lua：将多个结果从函数传递到表构造函数

> ID：14186394
> 
> 赞同：1
> 
> 时间：2013-01-06T20:25:30.910
> 
> 标签：lua

我偶然发现了lua的奇怪行为。代码示例：

```
function foo()
    local t = {'a', 'b', 'c'}
    return unpack(t)
end

function bar()
    local t = {'x', 'y'}
    return unpack(t)
end

b = { foo(), bar() }

for k,v in pairs(b) do
    print(k,v)
end 
```

此代码的结果是：

```
1   a
2   x
3   y 
```

因此，结果 from`foo()`除了第一个元素之外都被丢弃。问题是，为什么有些元素被丢弃了？我已经简要检查了 lua 5.2 手册，但我没有看到对这种行为的解释。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-06T20:34:31.853

> 问题是，为什么有些元素被丢弃了？

因为这就是 Lua 的工作方式。[产生多个值的表达式](http://www.lua.org/manual/5.2/manual.html#3.4)`...`（*函数*调用和列表的元素。

所以：

```
{foo, ...} 
```

将所有可变参数放在最后。

```
{..., foo} 
```

只会将第一个可变参数放入表中。

如果你想像这样捆绑多个函数调用，你必须使用一个函数将`table.insert`每个元素单独放入列表中。

# android - 如何复制此 UI 模式：单击 ListView 项目并在其下方展开？

> ID：14186398
> 
> 赞同：4
> 
> 时间：2013-01-06T20:26:02.770
> 
> 标签：android, listview, expandablelistview

例如，在应用程序 Plume 中，当您单击 ListView 项目（推文）时，它会在其下方展开以显示一些操作（回复、链接、转发等）。如何在我的应用程序中复制此行为？我希望能够单击 ListView 项目，然后用我自己的操作“扩展”它（对于选定的项目）。

截图示例：

![在此处输入图像描述](../Images/e9ac9611c023a1867a4fb9b2e1260356.png)

这里使用的 UI 设计模式是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:39:19.853

你必须为自己创造它。您应该创建一个扩展的自定义适配器，`BaseExpandableListAdapter`并且`getChildView`您应该将按钮水平放置`LinearLayout`，并使用您要使用的图标`TextViews`设置`TextView`'s 。`android:drawableTop`

这个布局的一个非常简单的使用：

```
<LinearLayout 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:orientation="horizontal">

        <TextView
            android:id="@+id/replyText"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_margin="5dp"
            android:text="@string/app_name"
            android:drawableTop="@drawable/ic_launcher" />
        <TextView
            android:id="@+id/someText"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/app_name"
            android:layout_margin="5dp"
            android:drawableTop="@drawable/ic_launcher" />
        <TextView
            android:id="@+id/otherText"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_margin="5dp"
            android:text="@string/app_name"
            android:drawableTop="@drawable/ic_launcher" />

</LinearLayout> 
```

您可以使用您的可绘制对象和字符串。这只是一种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:03:54.943

我不确定 Plume 是否使用这个库，但我已经成功使用[Android - SlideExplandableListView](https://github.com/tjerkw/Android-SlideExpandableListView)来实现这个功能。

[https://github.com/tjerkw/Android-SlideExpandableListView](https://github.com/tjerkw/Android-SlideExpandableListView)

# ruby - 在 Ruby 上评估 javascript

> ID：14186399
> 
> 赞同：5
> 
> 时间：2013-01-06T20:26:14.470
> 
> 标签：ruby, rubygems

我尝试获取网页的代码 html，但网络包含一些 javascript 代码，这些代码会生成一些我需要的数据。

```
http = Net::HTTP.new('localhost')
path = '/files.php'

# POST request -> logging in
data = ''
headers = {
   'Referer' =>  'http://localhost:8080/files.php',
   'User-Agent' => 'Mozilla/5.0 (Windows NT 6.2; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0',
   'Accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
   'Accept-Language' => 'es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3',
   'Content-Encoding' => 'gzip, deflate',
   'Connection' => 'keep-alive',
   'Cookie' => ''
}

resp, data = http.post(path, data, headers)

puts resp.body 
```

但这只会返回 html 而不会评估 javascript。我想在评估页面的 javascript 后获得最终的 html。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:51:31.717

在启用 JavaScript 的情况下进行抓取很难。基本上，如果你想可靠地做到这一点，你需要能够完全模拟浏览器。

幸运的是，有一些宝石可以做到这一点。您可以将[Capybara](https://github.com/jnicklas/capybara)与 Selenium 等支持 JavaScript 的驱动程序一起使用。例如（改编自[这篇博文](http://www.chadcf.com/blog/using-capybara-javascript-capable-replacement-mechanize)）：

```
require "capybara"
require "capybara/dsl"

Capybara.run_server = false
Capybara.current_driver = :selenium
Capybara.app_host = "http://www.google.com/"

class Scraper
  include Capybara::DSL

  def scrape
    visit('/')
    fill_in "q", :with => "Capybara"
    click_button "Google Search"
    all(:xpath, "//li[@class='g']/h3/a").each { |a| puts a[:href] }
  end
end 
```

如果 Selenium 不是您喜欢的，那么还有其他的 JavaScript 驱动程序（它实际上使您的浏览器自动化，例如 Firefox，而不是实现一个单独的“无头”浏览器自己的浏览器）。例如，请参阅[capybara-webkit](https://github.com/thoughtbot/capybara-webkit)或[poltergeist](https://github.com/jonleighton/poltergeist)，了解无头浏览器驱动程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:33:37.607

假设：您的 Javascript 存在于页面上的单个标记中。否则你将不得不通过寻找你想要的每一位 js 来解析。您想要的 gem 称为“therubyracer”，它将 google 的 v8 javascript 执行引擎嵌入到您的 ruby​​ 中。

转到您的命令行并安装 therubyracer

```
 gem install therubyracer 
```

然后：

```
 require 'v8'

 data = ''
 headers = {
    'Referer' =>  'http://localhost:8080/files.php',
    'User-Agent' => 'Mozilla/5.0 (Windows NT 6.2; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0',
    'Accept' => 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    'Accept-Language' => 'es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3',
    'Content-Encoding' => 'gzip, deflate',
    'Connection' => 'keep-alive',
    'Cookie' => ''
 }

 resp, data = http.post(path, data, headers)

 js = resp[resp.index('<script')..resp.index('</script>')]
 js = js[js.index('/>')..-1]

 cxt = V8::Context.new
 result = cxt.eval(js)
 puts result 
```

# windows - 使用 Win API 设置壁纸

> ID：14186400
> 
> 赞同：2
> 
> 时间：2013-01-06T20:26:19.057
> 
> 标签：windows, winapi, wallpaper

我想以编程方式设置壁纸。这是我迄今为止找到的唯一解决方案：

```
SystemParametersInfoW(SPI_SETDESKWALLPAPER, 1, (void*)wallpaperImageFilePath.utf16(), SPIF_UPDATEINIFILE | SPIF_SENDCHANGE); 
```

我的问题是：如何告诉 Windows 我希望墙纸图像居中（不调整大小）？上面的解决方案总是将图像设置为拉伸模式。根据 MSDN，没有伴随的标志`SPI_SETDESKWALLPAPER`。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2017-10-09T13:27:08.910

从 Windows 8 开始，现在有一个用于设置桌面背景的已发布界面。具体`IDesktopBackground::SetWallpaper`方法。[MSDN 文档](https://msdn.microsoft.com/en-us/library/windows/desktop/hh706962.aspx)

该界面还有多种获取和设置幻灯片配置的方法，以及获取所需的监控设备路径。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T20:36:31.150

没有用于设置壁纸方向的 API 函数。您必须直接转到注册表，特别是键的`"WallpaperStyle"`和`"TileWallpaper"`值`HKEY_CURRENT_USER\Control Panel\Desktop`。有关示例，请参见本文：

[设置桌面壁纸（CppSetDesktopWallpaper）](http://code.msdn.microsoft.com/windowsdesktop/CppSetDesktopWallpaper-eb969505)

# android - 为什么在我的布局中更改片段的位置会导致我的应用程序崩溃？

> ID：14186403
> 
> 赞同：0
> 
> 时间：2013-01-06T20:26:32.643
> 
> 标签：android, android-layout, android-fragments

我的应用程序只有两个按钮和一个加载 ListFragment 的空间。当按钮被定义为位于布局的顶部时，应用程序会根据需要运行：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_weight="1"
        android:layout_height="0px"
        android:orientation="horizontal" >
        <Button
            android:id="@+id/displayfragment1"
            android:layout_height="match_parent"
            android:layout_width="wrap_content"
            android:text="@string/button_fragment1" />
        <Button
            android:id="@+id/displayfragment2"
            android:layout_height="match_parent"
            android:layout_width="wrap_content"
            android:text="@string/button_fragment2" />
    </LinearLayout>

    <LinearLayout
        android:id="@+id/myfragment"
        android:layout_width="match_parent"
        android:layout_weight="5"
        android:layout_height="0px" />
</LinearLayout> 
```

但是，当我将片段布局移动到按钮上方时，如下所示，应用程序在启动时崩溃。

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/myfragment"
        android:layout_width="match_parent"
        android:layout_weight="5"
        android:layout_height="0px" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_weight="1"
        android:layout_height="0px"
        android:orientation="horizontal" >
        <Button
            android:id="@+id/displayfragment1"
            android:layout_height="match_parent"
            android:layout_width="wrap_content"
            android:text="@string/button_fragment1" />
        <Button
            android:id="@+id/displayfragment2"
            android:layout_height="match_parent"
            android:layout_width="wrap_content"
            android:text="@string/button_fragment2" />
    </LinearLayout>       

</LinearLayout> 
```

这是我为导致此崩溃所做的唯一更改，因此我认为这一定是问题所在？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:22:44.870

`R`在更改涉及的内容（尤其是布局内容）之后，请务必记住清理您的项目（项目 - >清理）。有时 Eclipse 会“忘记”修改`R`以反映更改（或错误地修改它，这似乎是这里的问题）并且会出现奇怪的问题。

# php - php facebook登录数组合并错误

> ID：14186408
> 
> 赞同：-1
> 
> 时间：2013-01-06T20:26:54.377
> 
> 标签：php, facebook, codeigniter, array-merge

我正在尝试将 facebook 登录整合到我的网站，我得到的错误是：

```
array_merge() [function.array-merge]: Argument #2 is not an array
Filename: fb/base_facebook.php

Line Number: 529 
```

我在控制器中使用的代码是：

```
$this->load->library('fb');
$data = array
    (
        'redirect_uri'=>site_url('main/handle_facebook_login'),
        'scope'=>'email'

    );

$this->fb->sdk->getLoginUrl('$data'); 
```

getLoginUrl 是它抛出豁免的地方

fb库中的代码是：

```
class Fb {

private $appid = '';
private $secret = '';

public function __construct()
{
  $ci =& get_instance();
  $ci->config->load('fb');
  $this->appid = $ci->config->item('fb_appid');
  $this->secret = $ci->config->item('fb_secret');

  //load the library
  $this->load();
}

private function load()
{
  include_once 'fb/facebook.php';
  $credentials = array(
     'appId' => $this->appid,
     'secret' => $this->secret
  );

  $this->sdk = new Facebook($credentials);
}      

} 
```

我将其传递给的 base_facebook 中的代码是：

```
 /**
* Get a Login URL for use with redirects. By default, full page redirect is
* assumed. If you are using the generated URL with a window.open() call in
* JavaScript, you can pass in display=popup as part of the $params.
*
* The parameters:
* - redirect_uri: the url to go to after a successful login
* - scope: comma separated list of requested extended perms
*
* @param array $params Provide custom parameters
* @return string The URL for the login flow
*/
public function getLoginUrl($params=array()) {
$this->establishCSRFTokenState();
$currentUrl = $this->getCurrentUrl();

// if 'scope' is passed as an array, convert to comma separated list
$scopeParams = isset($params['scope']) ? $params['scope'] : null;
if ($scopeParams && is_array($scopeParams)) {
  $params['scope'] = implode(',', $scopeParams);
}

return $this->getUrl(
  'www',
  'dialog/oauth',
  array_merge(array(
                'client_id' => $this->getAppId(),
                'redirect_uri' => $currentUrl, // possibly overwritten
                'state' => $this->state),
              $params));
} 
```

我不明白我做错了什么，我正在传递一个数组，但它说我不是？有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:37:17.123

实际上，您正在传递一个字符串，即字符串 '$data'（参见单引号）；

应该：

```
$this->fb->sdk->getLoginUrl($data); 
```

# objective-c - NSMutableArray arrayWithArray 与 NSArray mutableCopy 比较相同？

> ID：14186410
> 
> 赞同：7
> 
> 时间：2013-01-06T20:27:04.550
> 
> 标签：objective-c, ios6, nsmutablearray

给定以下代码示例，`newMutableArrray`变量是否因两个不同的初始化而不同，还是相同？

```
NSArray *originalArray = @[obj1, obj2, oj3];

NSMutableArray *newMutableArray = nil;

if (thereIsSomeDifference) {  
    newMutableArray = [NSMutableArray arrayWithArray:originalArray];  
}  
else {  
    newMutableArray = [originalArray mutableCopy];  
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-21T10:35:22.260

**不 ！！！这些初始化之间有两个区别：**

1.  保留计数：在第一种情况下，你得到一个自动释放的对象，在第二种情况下，你得到一个保留的对象，你需要在之后释放它（这不适用于 ARC）

2.  如果 originalArray 为 nil，在第一种情况下，您将获得一个包含 0 项的可变数组，在第二种情况下，您将获得 nil（因为向 nil 发送消息返回 nil）。在您的示例中，很明显 originalArray 不是 nil ，但在现实生活中您可以达到这种情况（我刚遇到这种情况）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-06T20:38:26.963

如果一个数组具有相同的对象（以相同的顺序），则它们等于另一个数组（isEqualToArray：选择器）。这是使用 isEqual: 方法验证的（不管数组是否可变）。

它们是一样的，一个或另一个初始化没有任何区别。验证此记录 isEqualToArray: 的结果。

```
NSArray *originalArray = @[obj1, obj2, oj3];
NSMutableArray *newMutableArray = nil;
newMutableArray = [NSMutableArray arrayWithArray:originalArray];  
thereIsSomeDifference= ![newMutableArray isEqualToArray: [originArray mutableCopy] ]; 
```

请注意，即使您将其与非可变副本进行比较，该比较也是正确的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T20:36:48.510

不，他们的结果是完全一样的。
只有初始化不同

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T20:42:53.377

为了回答，我们必须定义“相同性”。两个并排的 init 将导致不同的集合，但只要它们指向相同的元素，它们就会是相同的。

换句话说：

```
initA = [NSMutableArray arrayWithArray:originalArray];  
initB = [originalArray mutableCopy];

if (initA == initB) {
   // unreachable, because the pointers differ
}

// however
if ([initA isEqualToArray:initB]) {
   // will be true
   // because
   for (int i=0; i<initA.count; i++) {
       if ([initA objectAtIndex:i] == [initB objectAtIndex:i]) {
           NSLog(@"this will log every element %@ in the arrays", [initA objectAtIndex:i]);
       }
   }
} 
```

# python - flask-wtf selectField 选项无效

> ID：14186412
> 
> 赞同：2
> 
> 时间：2013-01-06T20:27:20.647
> 
> 标签：python, dictionary, flask, wtforms

我做了一个这样的 SelectField：

```
# constants.py
QUESTION_LIST = {}
QUESTION_LIST['QuestionOne'] = { 'disagree-strong': "Strongly Disagree", 'agree-strong': "Strongly Agree" }

#forms.py
from constants import *
typeone = SelectField('QuestionOne', 
      choices=QUESTION_LIST['QuestionOne'].iteritems(), 
      description='Answer the question') 
```

因此，当您加载页面时，它会显示选项。我选择了这个选项，按提交，它说“这不是一个有效的选择”，它会清空选择字段。

然后，当您刷新页面时，就好像代码已损坏并且不再显示选择...这是一个空的下拉/选择字段。

我究竟做错了什么？

编辑：出于某种原因，当您将迭代项放在视图中而不是表单中时，一切正常。Flask-WTF 的某种怪癖，如果您不使用它们的格式，它似乎会在您提交表单后删除选择。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T06:21:27.550

也许问题在于您在 dict 中的键是字符串。我以前遇到过这个问题，所以也许这样的事情会有所帮助：

```
typeone = SelectField("Question1", coerce=str, choices=QUESTION_LIST['QuestionOne']) 
```

这个`coerce`东西有帮助。会发生什么我认为所有 POST 数据都是 unicode 并且默认情况下`coerce`也等于 unicode（至少在 WTF 形式中，如果你使用一个，需要检查 Flask-WTF 扩展名）。你的选择键是字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:55:21.117

您正在传递一个集合而不是一个字典。`QUESTION_LIST`用冒号替换定义中的逗号。实际上调用`.iteritems()`应该已经失败......

```
QUESTION_LIST['QuestionOne'] = { 'disagree-strong': "Strongly Disagree",
                                 'agree-strong': "Strongly Agree" } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T00:48:29.657

出于某种原因，当您将迭代项放在视图而不是表单中时，一切正常。Flask-WTF 的某种怪癖，如果您不使用它们的格式，它似乎会在您提交表单后删除选择。

因此，只需将 .iteritems() 代码移动到 VIEW 中，只需键入 form.question_field.choices = QUESTION_LIST['QuestionOne'].iteritems(); 比在表单文件中使用 iteriterms 效果更好。

# xcode - 正确利用 xcode 中的计时器来更改主视图控制器的值

> ID：14186416
> 
> 赞同：0
> 
> 时间：2013-01-06T20:28:13.427
> 
> 标签：xcode, nstimer, appdelegate

在我的项目中，我有 1 个需要更改值的主视图控制器，例如 UILabel 和变量。

一旦用户第一次打开应用程序，我还需要一个持续运行的计时器。

我目前拥有的是一个计时器，它每隔一段时间在 appdelegate 中调用一个函数，当它在该函数中时，我将有一个 if 语句检测何时是午夜。到了午夜，我想在主视图控制器上重置一堆值。

所以，只要用户第一次打开应用程序，我就需要再次运行这个计时器。它需要在完全关闭时运行，并且在后台运行时，比如当用户点击主页按钮并且没有关闭它时。

我的主要问题是，我应该在 appdelegate 中为此使用哪些功能？现在看来，只有在我完全关闭 xcode 中的任务/应用程序并返回它之后，计时器才会触发，然后我会看到我的值被重置。不是当我只是在模拟器中回家时。

后来，我发现即使我暂时绕过这些需求并从计时器中触发午夜功能，当我在主 VC 中时，它并没有重置值，例如我的 UILabel ......即使那由于我放在那里的警报，部分代码正在触发。

所以，我的问题是，在什么功能下，我应该把我的午夜函数放入，以便能够在用户活跃在应用程序中时更改值，比如在午夜，以及当他们不在应用程序中时。当应用程序未运行时，我需要计时器仍然每小时或每分钟触发一次午夜功能，当它实际上到达午夜时，我需要将其分别放入主 VC 并重置值，以便用户最终执行打开应用程序并加载该主 VC，这些值将被重置。

本质上，用户全天都在跟踪一些数字，一旦到了午夜，这些数字就会被重置，所以当用户在一天中打开应用程序时，他会看到 0。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:50:42.703

不要用自己的计时器跟踪午夜。通过观察通知[UIApplicationSignificantTimeChangeNotification](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIApplication_Class/Reference/Reference.html)来跟踪它。这将自动处理各种重要情况，例如时区在您背后发生变化时，以及午夜来临时。

至于在后台跟踪时间变化，没有理由为您的用例这样做。在`applicationDidEnterBackground:`中，注意现在是什么时间。在`applicationWillEnterForeground:`中，检查现在是什么时间。如果您越过了午夜界限，请设定您的价值观。

# asp.net - 参考项目中未包含的参考项目文件

> ID：14186418
> 
> 赞同：0
> 
> 时间：2013-01-06T20:28:24.993
> 
> 标签：asp.net, .net, reference

我有一个包含 2 个项目的解决方案，一个是 ASP.Net 项目，另一个是类库。类库依赖于包含的文件才能运行。ASP.Net 项目依赖于类库来运行。

我将类所需的文件设置`Build Action`为“Content”和`Copy to Output Directory`“Copy if newer”，果然，我的类（`bin\Debug`或`bin\Release`）的输出目录显示了我需要的文件。

当我添加这个类作为对我的 ASP.Net 项目的引用时，我需要的额外文件“内容”文件不包括在内，只有`.dll`、`.pdb`和`.xml`文件以及其他依赖库包含在 ASP.Net 中项目。如何将我的“内容”文件也复制到 ASP.Net 文件夹中，就像文件`bin\Release`夹中的其他文件一样？

我认为这个答案会有所帮助，但我没有进行测试。（[Xml 文件未复制到测试输出目录](https://stackoverflow.com/questions/4369861/xml-file-not-copying-to-test-output-directory)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:27:18.283

似乎应该复制内容文件。您是否尝试将其标记为`Copy Always`？

无论如何，如果这不起作用，那么从您的构建中启用更好的诊断可能会有所帮助。例如：

1.  转到`Tools`-> `Options`-> `Projects and Solutions`-> `Build and Run`设置。
2.  更改`MSBuild project build output verbosity`为`Normal`。
3.  确保`On Run, when projects are out of date`设置为`Always build.`
4.  当您构建检查**_CopyOutOfDateSourceItemsToOutputDirectory**任务（复制任务）

在此处参考此问题： [文件标记为内容->始终复制未复制](https://stackoverflow.com/questions/13441513/file-marked-as-content-copy-always-is-not-being-copied)

# haskell - 在 Snap 中使用“runghc”而不抛出 webhandler 异常。使用 tryIO 仍然会报错

> ID：14186427
> 
> 赞同：0
> 
> 时间：2013-01-06T20:29:47.463
> 
> 标签：haskell, haskell-snap-framework

我试图在 snap 中使用 runGHC 来过滤掉可以编译的代码。但是，我正在使用 tryIO，但是当出现编译错误时，我的 webhandler 仍然会引发异常，而不是只返回一个空字符串。

```
import           Exception (tryIO)

...

runOnFileName :: String -> IO (String)
runOnFileName inp = do
   res <- sanitizeSource inp
   case res of
       Just (code, _, _, _)    -> return $ ppr code
       Nothing                 -> return ""

sanitizeSourceString :: String -> String -> IO (String)
sanitizeSourceString fn contents = do
  tmpdir <- getTemporaryDirectory
  let tmp = tmpdir </> fn ++ ".hs"
  exists <- doesFileExist tmp
  unless exists $ writeFile tmp $ contents
  runOnFileName tmp

sanitizeSource :: String -> IO (Maybe RenamedSource)
sanitizeSource inp =  do 
      runGhc (Just libdir) $ do
        dflags <- getSessionDynFlags
        let dflags' = foldl xopt_set dflags
                            [Opt_Cpp, Opt_ImplicitPrelude, Opt_MagicHash]
        setSessionDynFlags dflags
        target <- guessTarget inp Nothing
        setTargets [target]
        load LoadAllTargets
        modSum <- getModSummary $ mkModuleName "Main"
        p <- parseModule modSum
        t <- typecheckModule p
        d <- desugarModule t
        return $ renamedSource d

... in my handler...
eitherSan <- liftIO $ tryIO $ sanitizeSourceString (T.unpack uuid) (fromMaybe "" content)
let sanitized = case eitherSan of
    Left _ -> ""
    Right r -> r 
```

但是，如果我传递无法编译的“内容”，我的处理程序将失败并显示

```
 A web handler threw an exception. Details Parse error: naked expression at top level 
```

或任何编译器错误。我认为`tryIO`应该捕获异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T00:45:05.957

Daniel Fischer 关于`tryIO`您使用的是哪个问题是关键。也就是说，要么`tryIO`仅捕获 IO 异常等，在这种情况下，您应该使用来自的组合子`Control.Exception`，或者`tryIO`捕获多态异常，但您没有指定要捕获的异常，因此它默认为愚蠢的东西（如单元）并且您需要更加明确，或者以某种方式不会引发异常，但只有一个错误值隐藏在 sanitizeString 返回的 thunk 中，需要`evaluate`在块内强制（通过调用）`try`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-21T08:30:20.533

您需要捕获`SourceError`,`GhcApiError`和`SomeException`using `gcatch`。这是您的代码的独立版本：

```
{-# LANGUAGE ScopedTypeVariables #-}

import Control.Monad
import GHC
import GHC.Paths ( libdir )
import DynFlags
import Outputable
import System.FilePath
import System.Directory

import Control.Exception (SomeException)
import HscTypes (SourceError, GhcApiError)

runOnFileName :: String -> IO (String)
runOnFileName inp = do
   res <- sanitizeSource inp
   case res of
       Just (code, _, _, _)    -> return $ showSDoc tracingDynFlags (ppr code)
       Nothing                 -> return ""

sanitizeSourceString :: String -> String -> IO (String)
sanitizeSourceString fn contents = do
  tmpdir <- getTemporaryDirectory
  let tmp = tmpdir </> fn ++ ".hs"
  exists <- doesFileExist tmp
  unless exists $ writeFile tmp $ contents
  runOnFileName tmp

sanitizeSource :: String -> IO (Maybe RenamedSource)
sanitizeSource inp = (sanitizeSource' inp)
   `gcatch` (\(e  :: SourceError)   -> return Nothing)
   `gcatch` (\(g  :: GhcApiError)   -> return Nothing)
   `gcatch` (\(se :: SomeException) -> return Nothing)

sanitizeSource' :: String -> IO (Maybe RenamedSource)
sanitizeSource' inp =  do
      runGhc (Just libdir) $ do
        dflags <- getSessionDynFlags
        let dflags' = foldl xopt_set dflags
                            [Opt_Cpp, Opt_ImplicitPrelude, Opt_MagicHash]
        setSessionDynFlags dflags
        target <- guessTarget inp Nothing
        setTargets [target]
        load LoadAllTargets
        modSum <- getModSummary $ mkModuleName "Main"
        p <- parseModule modSum
        t <- typecheckModule p
        d <- desugarModule t
        return $ renamedSource d

eg1 = "module Main where\n\nf x = x + 1\n\nmain = undefined\n" -- will compile
eg2 = "module Main where\n\nf = x + 1\n\nmain = undefined\n"   -- won't compile 
```

示例会话：

```
*Main> :!rm -v /tmp/*hs 
```

解析好的代码：

```
*Main> r1 <- sanitizeSourceString "fn_eg1" eg1
*Main> r1
"Main.f x = x GHC.Num.+ 1\nMain.main = GHC.Err.undefined" 
```

现在，不解析的代码。打印了一个错误，但`r2`确实得到了空字符串，因此正确捕获了异常：

```
*Main> r2 <- sanitizeSourceString "fn_eg2" eg2

/tmp/fn_eg2.hs:3:5: Not in scope: `x'
*Main> r2
"" 
```

# linux - 如何在 .Xresources 配置中使用 linux 系统上的有效字体名称？

> ID：14186428
> 
> 赞同：22
> 
> 时间：2013-01-06T20:29:53.923
> 
> 标签：linux, shell, fonts, terminal, xserver

我对如何获得要在 .Xresources 文件中使用的有效字体名称很感兴趣。我已经安装`ttf-ms-fonts`并想将我的终端切换到快递字体。但是这样设置是行不通的

```
urxvt*font:     cour
urxvt*boldFont: courbd 
```

如何指定有效名称？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-06T20:54:27.287

首先，您必须决定是否要使用核心协议或 Xft 进行字体渲染。正如您在另一个答案中看到的，`xfontsel`是为核心协议获取正确字体名称的正确工具。但它不太可能是你想要的 truetype 字体（你想要抗锯齿吗？那么 Xft 是你的选择）。

如果 urxvt 是用 Xft 支持构建的（检查`urxvt --help 2>&1 | grep options`以确保），您可能希望为其提供前缀为的字体名称`xft:`

```
URxvt.font: xft:Courier New 
```

其他影响字体匹配和渲染的选项可以在 xft 字体名称中指定：

```
URxvt.font: xft:Courier New:pixelsize=18:antialias=false 
```

（搜索`man rxvt`更多`xft:`详情）

可以使用 查询所有可用的字体名称`fc-list`。例如`fc-list|grep courbd.ttf`，显示字体名称为 Courier New，样式为粗体（附加`:style=Bold`以选择它）。

用于`fc-match "Courier New"`从 Xft 的角度检查哪种字体与给定名称最匹配。

Other applications may have their own conventions for X11 and Xft font names. E.g. the same `xft:` prefix is used by emacs; xterm uses `faceName` and `renderFont` resources to determine whether to use Xft and which font to request; `xedit` supports core protocol only. The mere fact that the application is configurable from X resources isn't enough to tell how the font names are interpreted.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T20:37:59.227

我认为您可以使用该程序

```
xfontsel 
```

获取字体的完整名称。字体名称如下所示：

```
-*-courier-bold-*-*-*-*-*-*-*-*-*-*-* 
```

最良好的祝愿， 马蒂亚斯

# jsf - JSF 和部分验证

> ID：14186431
> 
> 赞同：5
> 
> 时间：2013-01-06T20:30:19.467
> 
> 标签：jsf, primefaces

我想知道是否有一种技巧可以验证表单中的所有字段，除了一个？

就像是 ：

```
<p:remoteCommand process="@form^F100"  .... /> 
```

显然，这行不通……

如果我在一个表单中有 100 个字段，是否有任何方法或快捷方式来验证所有异常 F100 ？

难道我注定要使用

```
<p:remoteCommand process="F1 F2 F3 F4 F5 F6 .... F99"  .... /> 
```

?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-06T20:55:01.817

您可以为此使用[PrimeFaces 选择器 (PFS)](http://www.primefaces.org/showcase/ui/selectors.jsf)。这允许您在 PrimeFaces ajax 组件的属性和属性中使用jQuery CSS选择[器语法。](http://api.jquery.com/category/selectors/)例如，您可以在您想跳过并使用选择器的组件上使用一个类。`process``update``noprocess``:not(.noprocess)`

然后可以按如下方式解决您的特定要求：

```
<h:form>
    <h:inputText ... />
    <h:inputText ... />
    <h:inputText ... />
    ...
    <h:inputText ... />
    <h:inputText ... />
    <h:inputText ... styleClass="noprocess" />
    <p:remoteCommand ... process="@(form :not(.noprocess))"/>
</h:form> 
```

这个例子将处理客户端输入的整个表单`class="noprocess"`。

# wpf - 使用转换器隐藏 WPF 中的网格

> ID：14186432
> 
> 赞同：1
> 
> 时间：2013-01-06T20:30:20.613
> 
> 标签：wpf, windows-phone-7, xaml, converter

我有一个这样的网格：

```
<Grid>
   <Grid.RowDefinitions>
     <RowDefinition />
     <RowDefinition />
   </Grid.RowDefinitions>
   <TextBlock  Grid.Row="1"  Margin="12,0,0,10" x:Name="TxtBox_Email"  Text="{Binding m_strMail}"  />
</Grid> 
```

如果绑定的变量为空，我想隐藏整个网格。我想我需要使用转换器，但我需要一些语法帮助。

任何人都可以帮助我吗？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:52:17.553

是的，你是对的。您可以像这样编写转换器：

```
public class StringLengthVisibilityConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter,
    System.Globalization.CultureInfo culture)
    {
        var strValue = value as String;
        return string.IsNullOrEmpty(strValue) ? Visibility.Collapsed : Visibility.Visible;
    }

    public object ConvertBack(object value, Type targetType, object parameter,
    System.Globalization.CultureInfo culture)
    {
        //We can't support this
        throw new NotImplementedException();
    }
} 
```

要使用转换器，请将资源添加到您的页面：

```
<phone:PhoneApplicationPage.Resources>
    <local:StringLengthVisibilityConverter x:Key="LengthConverter" />
</phone:PhoneApplicationPage.Resources> 
```

替换`local`指向转换器的 CLR 命名空间的 xmlns。

之后，我们可以在电网中使用我们的转换器：

```
<Grid Visibility="{Binding Path=m_strMail, Converter={StaticResource LengthConverter}}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T05:29:14.127

当您为网格创建样式时，可以仅在 xaml 中编写它。但是你必须为每个不同的绑定编写一个样式。此示例中的 Viewmodel 仅包含一个名为 MyString 的字符串属性。

```
<Window xmlns:local="clr-namespace:PlayGroundSecond">
    <Window.DataContext>
        <local:SimpleViewModel/>
    </Window.DataContext>

    <Window.Resources>
        <Style x:Key="MyOwnTextBlockStyle" TargetType="{x:Type TextBlock}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding MyString}" Value="{x:Null}">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding MyString}" Value="">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <Grid>
        <TextBlock Style="{StaticResource MyOwnTextBlockStyle}" Text="MyText"/>
    </Grid>
</Window> 
```

我认为 vcsjones 的解决方案更好，因为您可以将它用于每个绑定，并且在我的解决方案中，您必须为每个绑定编写一个带有 2 个 DataTriggers 的样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-29T11:06:04.657

没有转换器你可以像这样使用

```
 <Grid>
            <Grid.Style>
                <Style>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Path=m_strMail}" Value="">
                            <Setter Property="FrameworkElement.Visibility" Value="Collapsed" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition />
            </Grid.RowDefinitions>
            <TextBlock  Grid.Row="1"  Margin="12,0,0,10" x:Name="TxtBox_Email"  Text="{Binding m_strMail}"  />
        </Grid> 
```

# list - 在 Haskell 中交错列表列表

> ID：14186433
> 
> 赞同：10
> 
> 时间：2013-01-06T20:30:43.333
> 
> 标签：list, haskell, fold, interleave

我想知道如何在 Haskell 中编写一个将列表列表交错为单个列表的函数，例如，如果我有一个名为的函数

`interleavelists :: [[a]] -> [a]`

它应该能够交错元素。

示例：`[[1,2,3] [4,5,6] [7,8]] --> [1,4,7,2,5,8,3,6]`。

列表可以是有限的也可以是无限的......我可以使用`foldr`吗？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-06T20:49:49.403

最快的编写方法是使用[`transpose`](http://hackage.haskell.org/packages/archive/base/4.6.0.0/doc/html/Data-List.html#v%3atranspose)from `Data.List`。

```
import Data.List

interleavelists :: [[a]] -> [a]
interleavelists = concat . transpose 
```

`transpose`选择其参数的每个非空列表的第一个元素，将它们放入一个列表中，然后是参数元素的`transpose`s 列表。生成的结果列表会根据需要交错列表。如果某些元素列表是无限的，它会起作用，但如果列表列表本身有无限多的元素，它当然永远不会超过s 的列表。但无论如何处理这种情况是有问题的。`tail``concat``transpose``head`

使用`foldr`交错列表并非易事。假设你有

```
interleavelists xss = foldr something zero xss 
```

`interleavelists []`应该可能产生`[]`，所以这就是`zero`价值。和

```
interleavelists [xs] = xs 
```

看起来很自然，所以

```
something xs [] = xs 
```

但是如果第二个参数不是`[]`呢？然后你想将第一个参数的元素`something`以不同的距离插入到第二个参数中。但在哪些距离？如果所有列表的长度相同，则每个列表的距离都是恒定的，那么您可以将距离作为进一步的参数传递，

```
interleavelists = snd . foldr insertAtDistance (0, [])
  where
    insertAtDistance xs (d, ys) = (d+1, helper d xs ys)
    helper _ [] ws = ws
    helper k (b:bs) cs = b : us ++ helper k bs vs
      where
        (us,vs) = splitAt k cs 
```

这不是很漂亮，如果列表的长度不同，将产生可能不是所需的输出。但是，如果列表都具有相同的长度，它就可以完成工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T20:51:25.673

简单的递归版本：

```
inter :: [[a]] -> [a]
inter [] = []
inter xs = inter2 (filter (\x -> not (null x)) xs)
   where inter2 xs = map head xs ++ inter (map tail xs) 
```

现在，关于文件夹...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-26T15:12:04.447

交错列表的“标准”（或者也许是著名的）方式，早在 SICP（以及后来的 Reasoned Scheme）的快乐日子里，是

```
infixr 5 ++/

[]     ++/ ys = ys
(x:xs) ++/ ys = x:(ys ++/ xs) 
```

它可以与`foldr`,

```
*Main> foldr (++/) [] [[1,2,3],[4,5,6],[7,8]]
[1,4,2,7,3,5,8,6] 
```

这显然不会按照您想要的顺序产生结果，但是当列表的输入列表是无限的时，它会正常工作。我认为没有办法同时满足这两个要求，因为我们无法知道输入列表是否是无限的。

上面的结果是丹尼尔答案中的函数`insertAtDistance`将[产生的结果](https://stackoverflow.com/a/14186594/849891)，如果修改为始终插入距离为`1`，而不是`d+1`：

```
insertAtDistance xs (d, ys) = (1, helper d xs ys) 
```

当用`d+1`它定义时，会产生“扁平”交织，而`foldr (++/) []`产生倾斜交织：

```
*Main> take 20 $ foldr (++/) [] [cycle[i] | i<-[1..]]
[1,2,1,3,1,2,1,4,1,2,1,3,1,2,1,5,1,2,1,3] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-08T13:03:46.463

我们可以做你想做的

```
testList = [[1,2,3],[4,5,6],[7,8]]

interleave l = foldr' (concat [map (\x -> f x idx) l | idx <- [0..]])  
    where
        f x n = if (length(x)<=n) then Nothing else Just (x !! n)
        foldr' (x:xs) = case x of 
                         Nothing -> []
                         Just a  -> (:) a (foldr' xs) 
```

根据需要交错 [[1,2,3] [4,5,6] [7,8]] => [1, 4, 7, 2, 5, 8, 3, 6]

# javascript - Ajax 调用 XML 不起作用

> ID：14186434
> 
> 赞同：-1
> 
> 时间：2013-01-06T20:30:53.457
> 
> 标签：javascript, jquery, xml, ajax

我希望这会成功，但它不起作用，我没有看到警报。

```
function insertXML()
{
    $.ajax ({
        url: 'cd_catalog.xml',
        dataType: "xml",
        success: function(  )
        {           
            alert('called');
        }
    });
} 
```

cd_catalog.xml 与执行代码的 javascript 位于同一目录中，并且命名正确。

这也是我用于登录查询的代码的精确复制粘贴，我在这里搞砸了什么吗？

jquery-1.7.1.min.js 也被导入头部，包含代码的脚本正在正文中执行。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-06T20:35:28.967

确保您对 Web 服务器而不是本地文件进行 Ajax 调用。

# java - 如何使资源目录和全局消息变量在 java 或 java-ee 中工作并将其用于不同的语言

> ID：14186435
> 
> 赞同：0
> 
> 时间：2013-01-06T20:31:00.533
> 
> 标签：java, eclipse, jakarta-ee, struts2, internationalization

我在一个教程中看到，我可以在项目的根路径中创建一个名为 resources 的目录，并在该目录中创建一个名为 ApplicationResources.properties 的文件，以将所有消息定义为常量，以防止在程序中插入硬编码消息，我已将以下行添加到文件中，我尝试在我的 struts2 Web 项目的 MyClass-validation.xml 中使用它们，但它们没有被分配的消息替换。

我的文件是资源/ApplicationResources.properties：

```
errors.invalid=${getText(fieldName)} is invalid.
errors.required=${getText(fieldName)} is required.
errors.number=${getText(fieldName)} must be a number.
errors.range=${getText(fieldName)} is not in the range ${min} and ${max}. 
```

1.  如果这个方法是正确的，我怎样才能将它们插入到java程序中呢？或者我只能将它们用于配置文件？
2.  如果这种方法不正确，我应该怎么做？
3.  我如何将它用于 i18n？
4.  变量 min、max 是否应该来自消息变量范围？在配置文件中，它们应该来自标签属性。

XML:

```
 <?xml version="1.0" encoding="UTF-8"?>
   <!DOCTYPE validators PUBLIC "-//Apache Struts//XWork Validator 1.0.3//EN"
    "http://struts.apache.org/dtds/xwork-validator-1.0.3.dtd">
    <validators>
        <field name="duration">
            <field-validator type="int">
                <param name="min">1</param>
                <param name="max">1000</param>
                <message key="errors.range"/>
            </field-validator>
        </field>
    </validators> 
```

本教程是[在 Eclipse 中创建 Struts 2 应用程序](http://viralpatel.net/blogs/tutorial-create-struts-2-application-eclipse-example/)。BTW，我的项目结构是eclipse默认结构：MyProject/(src resources WebRoot)

# jqgrid - 如何在JSP中访问JQGrid的选定行的rowId

> ID：14186440
> 
> 赞同：0
> 
> 时间：2013-01-06T20:31:53.497
> 
> 标签：jqgrid, jsp-tags, struts2-jquery

我在一个 div 中有一个用 JQGrid 设计的页面，在另一个 div 中有一个表单（带有字段）。当我在 JQGrid 中选择一行时，我想根据行 ID 为表单中的字段填充数据。

```
<div id="data_div" class="results">
<table id="grid_table">
    <tr><td></td></tr>
</table>
<div id="pager" />
</div>
<div id="people-info">
<table><tr><td> <s:textfield key="act.actpeople[0].firstName" /></td></tr></table>
</div> 
```

这适用于硬编码 0,1,2 索引。我想写一些类似的东西：

```
<div id="people-info">
<table><tr><td> <s:textfield key="act.actpeople[${i}].firstName" /></td></tr></table>
</div> 
```

为 JQGrid 使用 Struts 2 和 JSON；在我的 javascript 中，我正在获取选定的行 ID，但是如何获取该 ID 以进行索引？我有哪些选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:20:57.220

据我了解，您询问如何根据在 jqGrid 中选择的行以另一种形式动态填充数据。在您的 jqGrid 设置中，您可以使用

```
onSelectRow: function (rowid) {
   var idRowData = $(this).jqGrid('getRowData', rowid);

   //set your form fields to the selected row column values
   FormField1.val(idRowData.Column1Name);
   FormField2.val(idRowData.Column2Name);
   //etc.....
} 
```

# mysql - 保存记录..但不保存... :(

> ID：14186446
> 
> 赞同：0
> 
> 时间：2013-01-06T20:32:58.120
> 
> 标签：mysql, ruby-on-rails, ruby

我有一个模型的这个静态方法，它正在创建多个记录。该方法在保存父对象时调用，用于创建适当的 n 个子记录的数据被传递给该方法（new_record），然后迭代传递给它的数组，并创建子记录。

Job 有许多 Job 活动。此方法new_record 属于job_activities 模型，在job_controller 中调用，保存作业记录时。基本上试图以一种形式实现两个模型。工作“has_many”job_activities，而Job_activites“belongs_to”一个工作。

到目前为止，这是我整理的内容-

```
 def self.new_record(sk_job_id, activities_list)
        activities_list.each do | act |
          puts "AAAAAAAAAAAAAAAAAAAAAAA creating a new record for "+act.inspect+" and " + sk_job_id.to_s
            ja = JobActivity.new
            puts "Job ID SK = "+sk_job_id.to_s
            puts "act = "+act
            puts "Record before assignment "+ ja.inspect
            ja.job_id_sk = sk_job_id
            ja.job_activity = act
            ja.created_by  = "raghav"
            ja.updated_by  = "raghav"
            puts "Record after assignment "+ ja.inspect            
            ja.save!
            puts "record after saving "+ ja.inspect
        end
      end 
```

奇怪的是，对象 ja 的分配前后状态反映的是“created_by”的分配，而不是 job_id_sk 和 job_activity 的分配......

而且，正如建议的那样，我实施了保存！但这并没有引发任何例外..它仍然默默地表现着它在做什么...... :(

```
AAAAAAAAAAAAAAAAAAAAAAA creating a new record for "ACT1" and 40
Job ID SK = 40
act = ACT1
Record before assignment #<JobActivity id: nil, job_id_sk: nil, job_activity: nil, created_by: nil, updated_by: nil, created_at: nil, updated_at: nil>

Record after assignment #<JobActivity id: nil, job_id_sk: nil, job_activity: nil, created_by: "raghav", updated_by: "raghav", created_at: nil, updated_at: nil>

record after saving #<JobActivity id: 13, job_id_sk: nil, job_activity: nil, created_by: "raghav", updated_by: "raghav", created_at: "2013-01-08 02:22:30", updated_at: "2013-01-08 02:22:30"> 
```

但是，当我去检查应该保存数据的 mysql 表时，我看到只传入了 NULL 值......

```
mysql> select job_id_sk, job_activity from job_activities;
+-----------+--------------+
| job_id_sk | job_activity |
+-----------+--------------+
|      NULL | NULL         |
|      NULL | NULL         |
|      NULL | NULL         |
|      NULL | NULL         |
|      NULL | NULL         |
+-----------+--------------+
5 rows in set (0.00 sec) 
```

我在某处遗漏了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:44:50.490

`model#save`返回 true 或 false，但是`model#save!`（注意`!`方法名称末尾的）将引发异常而不是返回 false。

可能是模型未通过验证或设置不正确。使用`save!`will 立即并且明显失败，告诉你什么是真正的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T02:35:08.857

找到问题了，解决办法...

我使用 attr_accessor 作为模型，而我应该一直使用 attr_accessible ...

詹姆斯对这个问题的回答帮助了我..

[在 ruby​​ 对象上调用 .save 只会为所有字符串传递 nil](https://stackoverflow.com/questions/9672033/called-save-on-a-ruby-object-is-only-passing-nil-for-all-strings)

# c++ - 如何对接口的引用进行惰性评估（尝试使用绑定）？

> ID：14186450
> 
> 赞同：1
> 
> 时间：2013-01-06T20:33:39.683
> 
> 标签：c++, binding, c++11

我可以`std::bind`使用实例正常工作，但无法使用对接口的引用（纯虚拟类）。

我需要这个功能来对接口进行惰性评估（它将在运行时引用具体实例）。

**编译错误**

```
In file included from /usr/include/c++/4.7/functional:56:0,
                 from junk.cpp:1:
/usr/include/c++/4.7/tuple: In instantiation of ‘struct std::_Head_base<0ul, Integer, false>’:
/usr/include/c++/4.7/tuple:215:12:   required from ‘struct std::_Tuple_impl<0ul, Integer>’
/usr/include/c++/4.7/tuple:374:11:   required from ‘class std::tuple<Integer>’
/usr/include/c++/4.7/functional:1148:29:   required from ‘struct std::_Bind<std::_Mem_fn<int (Integer::*)()const>(Integer)>’
junk.cpp:24:42:   required from here
/usr/include/c++/4.7/tuple:166:13: error: cannot declare field ‘std::_Head_base<0ul, Integer, false>::_M_head_impl’ to be of abstract type ‘Integer’
junk.cpp:4:8: note:   because the following virtual functions are pure within ‘Integer’:
junk.cpp:6:14: note:    virtual int Integer::getInt() const
make: *** [junk] Error 1 
```

有没有办法让它工作`std::bind`？如果没有，有什么东西在提升吗？

**代码**

```
#include <functional>
#include <iostream>

struct Integer
{
    virtual int getInt() const = 0;
};

struct IntImpl : public Integer
{
    virtual int getInt() const { return 42; }
};

int
main( int argv, char* argc[] )
{
    // works fine
    IntImpl  x;
    auto f = std::bind( &Integer::getInt, x );
    std::cerr << f() << std::endl;

    // need an interface because I won't know if concrete class will be x
    // or something else until run-time, but y will refer to that instance
    Integer& y = x; 
    // next line won't compile
    auto g = std::bind( &Integer::getInt, y );
    std::cerr << g() << std::endl;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:37:13.267

只需使用：

```
auto g = std::bind( &Integer::getInt, &y ); 
```

（在之前添加地址运算符`y`）

# javascript - 在 Promise 之外使用变量（在 windows8 javascript 开发中）

> ID：14186452
> 
> 赞同：0
> 
> 时间：2013-01-06T20:34:06.653
> 
> 标签：javascript, windows-8, promise

有一个代码：

```
var theContent;    
Windows.Storage.PathIO.readTextAsync(filepath).done(function (fileContent) {

                    theContent= fileContent;

                },

                function (error) {

                }); 
```

然后当我想在 Windows.Storage.PathIO.readTextAsync 之外使用“theContent”时，它不起作用...... theContent 变量根本不包含任何内容。

代码的哪一部分是错误的？谢谢！

* * *

我放了一些造成麻烦的来源。

**global.js**，其中包含用于共享的命名空间数组变量。（在 a.js 和 b.js 中）

```
WinJS.Namespace.define("GLOBAL", {
        theList: null
    }); 
```

**a.js**在某个文件中加载文本。

```
function readTextFromFiles() {

        GLOBAL.theList= new WinJS.Binding.List();

        for (var i = 0; i < theFileList.length; i++) {

            if (theFileList.getAt(i).filepath !== null) {

Windows.Storage.PathIO.readTextAsync(theFileList.getAt(i).filepath).done(function (fileContent) {

                    var splitted = fileContent.split("\r\n");

                    for (var j = 0; j < splitted.length; j ++) {
                        GLOBAL.theList.push({
                            partA: splitted[j]
                        });
                    }

                },

                function (error) {

                });

            }
        }

    } 
```

**b.js**以各种方式使用 GLOBAL.theList

```
ready: function (element, options) {

            new Windows.UI.Popups.MessageDialog("#2 length " + GLOBAL.theList.length, "MESSAGE").showAsync().then();
        }, 
```

*这是问题所在。* 当我调试**a.js**时，我看到**GLOBAL.theList**正确包含文件的文本。但是，当我将页面导航到**b.html(b.js)**时，弹出消息显示“#2 length 0”，这意味着**GLOBAL.theList 不**包含任何内容。

*   在页面加载其他 .js 文件之前，我在 default.html 中包含了 global.js。
*   当我不使用 Windows.Storage.PathIO.... 承诺时，我进行了测试并且它有效。（当我直接将数据任意放入 GLOBAL.theList 时）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:00:13.870

您要求`theContent`直线（程序）而不是回调的部分。

`.done(function (content) { doStuff(content); });`

或者，如果`doStuff`不使用`this`并且您不需要对它执行任何其他操作，那么`.done(doStuff);`当内容返回时，将与内容一起触发 just 和 doStuff。

```
loadImage = function () {}; // returns promise
showImage = function (image) {} // shows image

var imageLoading = loadImage("img/huge-img.bmp");

imageLoading.done(showImage); 
```

或者为了更简洁，构建`showImage`使用 Promise（在函数内部订阅它们的回调）。

```
function showImage(promise) {
    promise.done(function (img) { 
    document.body.appendChild(image);
 }); 
```

现在你有

```
 var image = loadImage("huge-img.bmp");
 showImage(image); 
```

使用承诺。看起来完全自然。

***编辑*** *重新：命名空间*

* * *

您可能仍然不希望将事物推入列表作为您在回调中所做的唯一事情。

什么在使用列表？

是`theList.push()`一个自定义函数，它具有相同的名称，`[].push()`但有额外的东西吗？

还是只是一堆东西？

这就是问题所在：
就像 AJAX 回调一样，promise 不会等待事情完成，然后再继续下一件事情。

因此，如果您的程序试图在该数组之外`done`（当数组最终有数据时）对该数组执行某些操作，那么这些函数将在一个空数组上工作。

相反，您应该使用方法（回调）来处理 Promise 的返回。

```
// these both do the same thing
/* ... */ .done(function (data) { NAMESPACE.module.callback(data); });
/* ... */ .done(NAMESPACE.Module.callback.bind(NAMESPACE.Module));

// if NAMESPACE.Module.callback ***does not use `this`*** you can write
/* ... */ .done(NAMESPACE.Module.callback);
// if you are unsure for even a second, do one of the other two calls 
```

如果您需要对回调中的数据做更多的事情，那么只需执行以下操作：

```
/* ... */ .done(function (data) {
    var arr = doStuff(data);

    arr.forEach(function (obj) {
        NAMESPACE.Module.list.push(obj);
    });

    NAMESPACE.Module.callback_relying_on_list();
}); 
```

请注意，这里的 2 个键是：

1.  确保`this`你的回调是正确的
2.  在承诺范围内工作——它们的重点是让你不必设置计时器来查看东西是否准备好了，但是......所以如果你只是设置值而不告诉任何人他们已经准备好了准备好了，承诺没有发挥作用

**编辑#2** *回复：来源*

* * *

看看你在这里做什么（简化）：

```
// a.js

function getFiles () {
    GLOBAL.list = [];
    getAsyncData().done(function (text) {
        GLOBAL.list.push({ content : text });
    });
}

//b.js
GLOBAL.Messages = {
    write : function (messages) {
        messages.forEach(/* ... */);
    },
    ready : function () { alert(GLOBAL.list.length); } }
};

// main program
getFiles();
GLOBAL.Messages.ready();
GLOBAL.Messages.write(GLOBAL.list); 
```

我知道这不是您的确切代码，但请看一下简化的情况：

如果我的`getFiles`功能完美运行，但服务器在 30 秒内没有发回我的数据，会发生什么情况？

我的`ready`和`write`函数不会等待这种情况发生。我一做完
他们就会开火。`getFiles`

所以在这里，你在错误的地方得到了这个承诺。
这是 100% 正确的方法，但为什么不这样做：

```
// a.js
function getFiles () {
    var filesLoaded = getAsyncData(); // I'm collecting the promise, not chaining it. 
    // again, simplified
    filesLoaded.done(function (text) { GLOBAL.list.push({ content : text}); });

    // ***super important part***
    return filesLoaded;
}

// b.js
/* ... */ = {

    ready : function (promise) {
        promise.done(function () { alert(GLOBAL.list.length); });
    },

    write : function (promise) {
        promise.done(/* write the list */);
    }
} 
```

现在你的主要看起来像这样：

```
var files = getFiles(); // files is the promise
// files.done, files.then, etc

GLOBAL.Messages.ready(files); // giving the promise to the method
// ready(promise) will subscribe to promise.done

GLOBAL.messages.write(files); // so will write(promise); 
```

以这种方式使用 Promise 时，请记住，我的示例与您添加到链中的 `files`对象完全相同。`.done()`

还要记住，有时你的函数会关心 promise 返回的值，而其他时候，函数只想知道 promise 何时完成，因此它们可以做一些事后需要发生的事情，而不是设置计时器来检查.

并且在您处理同步数据的任何时候都可以使用已清理的功能，现在您可以：

```
var files = readTextFromFiles();
/* ... */.ready(promise); 
```

这是否意味着您需要一个更多的功能来介于它`ready`正在做什么和您的旧准备看起来像之间？

嗯，是的……

但是值得知道您的功能不会过早关闭。
它看起来非常干净，没有巢穴，同时仍然是 100% 同步的。

如果你赶时间，或者你不能编辑那些其他功能，你可能会做一个坏主意，那就是在页面底部引导一些东西：

```
(function (promise) { promise.done(function () {
    /* ... everything() ... */ });
}(files)); 
```

丑陋且难以区分，需要在单独的页面上进行编辑，但至少它仍然是异步的，它仍然按顺序做事。

但这***仍然***意味着返回、收集和传递承诺。

希望有帮助。

# clojure - Clojure 命名空间未解析

> ID：14186453
> 
> 赞同：1
> 
> 时间：2013-01-06T20:34:07.480
> 
> 标签：clojure, namespaces, leiningen

在一个文件（core.clj）中我有

```
(ns nac.core)
(def bar "something") 
```

在同一目录中的另一个文件中，我有

```
 (ns nac.io
  (:require [nac.core :as c]))

 (defn foo [] c/bar) 
```

评估后，我收到一条错误消息

```
 Unable to resolve symbol: c in this context 
```

所以该文件在 require 中找到，但我命名的命名空间不是。

我在这里想念什么？谢谢。

# android - 两个自定义微调器布局

> ID：14186457
> 
> 赞同：1
> 
> 时间：2013-01-06T20:34:23.290
> 
> 标签：android, android-layout, spinner

我正在尝试使用两个带有自定义下拉菜单的微调器，只有底部的微调器在下拉时显示自定义布局。我一直在尝试自己找出原因，但我做不到。

```
public class setup extends Activity {
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.setuplayout);
    Spinner spinner1 = (Spinner) findViewById(R.id.Spinner01);
    // Create an ArrayAdapter using the string array and a default spinner layout
    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this,
            R.array.numberPlayers, R.layout.spinner_item);
    // Specify the layout to use when the list of choices appears
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    // Apply the adapter to the spinner
    spinner1.setAdapter(adapter);
    Spinner spinner2 = (Spinner) findViewById(R.id.Spinner02);
    // Create an ArrayAdapter using the string array and a default spinner layout
    ArrayAdapter<CharSequence> adapter2 = ArrayAdapter.createFromResource(this,
            R.array.gameDifficulty, R.layout.spinner_item);
    // Specify the layout to use when the list of choices appears
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    // Apply the adapter to the spinner
    spinner2.setAdapter(adapter2);
            }
            } 
```

这是上面提到的 spinner_item 的 xml 代码。

```
<?xml version="1.0" encoding="utf-8"?>
<TextView  
xmlns:android="http://schemas.android.com/apk/res/android"
android:textColor="#F9B12F"
android:layout_width="fill_parent" 
android:layout_height="wrap_content"
android:textSize="20sp"
android:gravity="left"  
android:padding="5dip"
android:popupBackground="#000000"
android:background="#000000"
/> 
```

这是 setuplayout xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical">
    <ImageView android:id="@+id/mainSetupImage"
        android:src="@drawable/setup"
        android:layout_width="match_parent"
        android:layout_height="match_parent">
    </ImageView>
    <ImageView
        android:id="@+id/players"
        android:clickable="true"
        android:src="@drawable/players"
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:layout_centerVertical="true">
    </ImageView>  
    <Spinner
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:drawSelectorOnTop="true"
        android:id="@+id/Spinner01"
        android:textColor="#F9B12F"
        android:layout_toRightOf="@+id/players"
        android:layout_marginLeft="25dp"
        android:layout_centerVertical="true"
        android:background="@drawable/spinner"/>
    <Spinner 
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:drawSelectorOnTop="true" 
        android:id="@+id/Spinner02"
        android:textColor="#F9B12F"
        android:layout_below="@+id/Spinner01"
        android:layout_toRightOf="@+id/difficulty"
        android:layout_marginTop="25dp"
        android:background="@drawable/spinner"/>

    <ImageView
        android:id="@+id/difficulty"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignTop="@+id/Spinner02"
        android:clickable="true"
        android:src="@drawable/difficulty" />       

    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T05:51:02.183

在第二个微调器中，您使用了适配器而不是适配器 2。所以使用adapter2并运行你的代码希望它会运行。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T22:19:18.703

我想分享一些代码，让所有人的代码在制作 ArrayAdapters 时更加简洁。

只需在您喜欢的类（甚至 MainActivity...）中定义一个静态方法，即可为您提供 Array 适配器，而不会弄脏您的代码：

```
 public static ArrayAdapter<CharSequence> 
     getArrayAdapter( Context c,  int arrayId, int idLayout1, int idLayout2){
     ArrayAdapter<CharSequence> aa;
     aa = ArrayAdapter.createFromResource( c, arrayId , idLayout1);
     aa.setDropDownViewResource( idLayout2);
     return aa;     
} 
```

然后在你的代码中你只需要这样做：

```
myspinner.addAdapter(
      this, ThatClass.getArrayAdapter( 
             R.array.myid, R.layout.id1, R.layout.id2 );
myspinner.setOnItemSelectedListener(this);

/* Remember that the default Android Spinner layout can be get passing these specific layout ids:
    android.R.layout.simple_spinner_item as layout1 
    android.R.layout.simple_spinner_dropdown_item as layout2
*/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T18:48:45.450

在你的帮助下我想通了。我使用了覆盖我的自定义布局的代码“adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item)”。感谢您强调两个代码的不同之处。这是一个巨大的帮助。我删除了引用的行，它现在可以工作了。

# image - Magento 1.7：在 2 列模板中全宽显示类别页面上的类别图像

> ID：14186458
> 
> 赞同：3
> 
> 时间：2013-01-06T20:34:27.360
> 
> 标签：image, magento, categories

找不到运行 Magento 1.7 的此问题的解决方案。上面主列中显示的类别。我想在页面宽度的两列上方显示它。这是一个例子：[http ://www.vimodos.nl/schoenen?art_sex=92](http://www.vimodos.nl/schoenen?art_sex=92)

有人有解决方案吗？非常感谢您的回复！

**更新**

谢谢回复。我按照您的指示在 catalog.xml 中添加了一个名为 category.image 的块

```
 <reference name="content">
        <block type="catalog/category_view" name="category.products"    template="catalog/category/view.phtml">
            <block type="catalog/product_list" name="product_list" template="catalog/product/list.phtml">
             <block type="catalog/category_image" name="category.image" template="catalog/category/image.phtml">
                <block type="catalog/product_list_toolbar" name="product_list_toolbar" template="catalog/product/list/toolbar.phtml">
                    <block type="page/html_pager" name="product_list_toolbar_pager"/> 
```

之后，我在 /template/catalog/category/ 下创建了一个 image.phtml 文件

重新加载类别页面时它是空的，没有错误消息。左侧栏中的小部件可见。

有什么建议么？非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T23:01:33.940

这似乎是 Magento 的内置功能。

要启用它，请执行以下操作：

*   登录到管理面板
*   转到目录->管理类别
*   选择要添加图像的类别
*   您将看到一个可以添加图片的地方（只需上传即可）
*   添加图像后，它将自动显示在类别页面中

**更新**

这是获取类别图像的代码：

```
$category = Mage::getModel('catalog/category')->load($catId);
$category->getImageUrl(); // remember to echo it out 
```

为了在分层导航上方进行设置，请执行以下步骤：

*   向 catalog.xml 添加一个块（在：`<catalog_category_default translate="label">`部分。
*   将上面的代码添加到模板文件（您在上面的块中引用的）

如果您需要进一步的帮助，请告诉我们

# java - android/java 多点触控，在这种情况下是什么 & 什么是 >>？

> ID：14186459
> 
> 赞同：2
> 
> 时间：2013-01-06T20:34:30.917
> 
> 标签：java, android, multi-touch, masking

我也是 android 世界的新人，Java 也很新，但是几年前作为 dot-net:er 和 Java 的一些学分，我并不完全落后 :)。 .但我仍然没有真正理解'&'和'>>'在以下两行中的实际作用..谁能解释一下..

```
int action = event.getAction() & MotionEvent.ACTION_MASK;
int pointerIndex = (event.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT; 
```

如果我理解第一行是正确的，event.getAction() 返回一个带有一堆信息的 int，但由于我们只对触发的动作感兴趣，所以我们添加 '& MotionEvent.ACTION_MASK' 以“解析”出来那一点..我是对的还是完全错的？

2:nd 行我不知道“>>”是做什么用的..所以请解释一下:)

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:36:21.773

[`getAction()`](http://developer.android.com/reference/android/view/MotionEvent.html#getAction%28%29)过去（在旧版本的 Android 中）只返回非常基本的向上、向下、悬停（等）动作。这使您可以做一些事情，例如`event.getAction() == ...`确定它是否是一种特定的动作。然而，随着多点触控的引入，触控事件变得更加复杂。现在，与动作一起，指针信息也存储在“动作”中。在你问之前：是的，他们本可以使用两种不同的方法，但是将动作的全部信息合二为一不仅更容易吗？

如JavaDocs中[@millimoose 的链接](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/operators.html)`&`所示，将只保留匹配的位（`a & b == 1`对于两个位`a`，`b`当且仅当`a == b == 1`）。您可能还想查看[位标志和字段的基础知识](http://helpnet.installshield.com/installshield17helplib/BitFlags.htm)，它们是使用位来表示各种状态的整数。

因此，当您调用 时`& MotionEvent.ACTION_MASK`，它将仅保留与 的位匹配[`ACTION_MASK`](http://developer.android.com/reference/android/view/MotionEvent.html#ACTION_MASK)的位（`11111111`或最右边的 8 位）。这是存储动作的地方（注意所有动作整数值都小于 255——最右边的 8 位）。

下一行取第二组 8 位（从右边开始，它们是第 8 位到第 15 位，包括），然后将它们右移 8 位，这样`1 0000 0000`（为演示而添加的空格）变为`1`. （这个运算符，右移，也在 JavaDoc 链接中解释。）

所以假设事件是`ACTION_UP`并且指针索引是 6，它为我们提供了关于事件和指针的信息。那将表示为`(6 << ACTION_POINTER_INDEX_SHIFT) | ACTION_UP`, 或`110 0000 0001`。在这种情况下，

*   的值`event.getAction()`等于`110 0000 0001`;
*   您的`action`变量等于`0000 0001`（当然，您可以忽略前导 0）；和
*   您的`pointerIndex`变量等于`110`（或`6`十进制）。

请记住，在 API 8 及更高版本上，您可以访问[`getActionMasked()`](http://developer.android.com/reference/android/view/MotionEvent.html#getActionMasked%28%29)，这将获得您在`action`上面使用的变量。

# javascript - 使用 jQuery 将带参数的函数附加到动态创建的 div

> ID：14186461
> 
> 赞同：0
> 
> 时间：2013-01-06T20:34:44.497
> 
> 标签：javascript, jquery, function, dynamically-generated

我正在动态创建一些 div 并将 onclick 函数附加到它们。有没有办法附加以这种方式获取参数的函数？

如果我只是在 html 中创建 div，我可以附加一个函数，它可以完美运行。我还可以动态附加没有参数的简单函数，它们可以完美运行。

我怎样才能将这个以'this'作为参数的函数附加到我的div？

有人有什么建议吗？？？

```
onclick="playSound(this)"

function playSound(el){
var soundId = $(el).html();
if ( soundId == ('d')){
d.playclip()
}
else if ( soundId == ('a')){
a.playclip()
}
else if ( soundId == ('n')){
n.playclip()
} 
```

我可以附加这样的功能，它工作正常。

```
$(".myDiv").live("click", function(){
alert('hello');
}); 
```

任何帮助将不胜感激！！！谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:40:26.590

对于这种特定情况，您可以使用以下内容：

```
$(".myDiv").click(function(){
  playSound(this);
}); 
```

* * *

如果您以这种方式重构代码删除`el`和使用：`this`

```
function playSound() {
    var soundId = $(this).html();
    if (soundId == ('d')) {
        d.playclip()
    } else if (soundId == ('a')) {
        a.playclip()
    } else if (soundId == ('n')) {
        n.playclip()
    }
} 
```

你可以直接使用它。

```
$(".myDiv").click(playSound); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:38:49.630

`$(el).data('some-key', 'some-value')`您可以使用和将一些数据附加到您的元素

```
$(".myDiv").live("click", function() {
   alert($(this).data('some-key'));
}) 
```

通过这种方式，您可以将数据附加到元素并在以后使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T20:42:27.820

绝对地。它被称为javascript的`bind`函数：

```
playSound.bind(this, arg1, arg2, ...) 
```

另一个类似的有用功能是 jquery 的代理功能。这只会跟踪范围，并且不允许您发送其他参数：

```
$.proxy(playSound, this) 
```

# java - 有没有办法让 FileChannels 自动关闭？

> ID：14186462
> 
> 赞同：1
> 
> 时间：2013-01-06T20:34:49.977
> 
> 标签：java, timer, nio, filechannel

我目前正在开发一个需要随机访问许多（60k-100k）相对大文件的应用程序。由于打开和关闭流是一项相当昂贵的操作，因此我更愿意将最大文件的 FileChannels 保持打开，直到不再需要它们为止。

问题是，由于 Java 7 的 try-with 语句没有涵盖这种行为，因此我需要手动关闭所有 FileChannel。但这变得越来越复杂，因为可以在整个软件中同时访问相同的文件。

我已经实现了一个 ChannelPool 类，它可以跟踪每个注册路径的打开的 FileChannel 实例。然后可以发出 ChannelPool 以关闭那些 Path 仅在特定时间间隔内被池本身弱引用的通道。我更喜欢事件侦听器方法，但我也不想听 GC。

来自 Apache Commons的[FileChannelPool](http://svn.apache.org/repos/asf/wicket/releases/wicket-1.5-RC5.1/wicket-core/src/main/java/org/apache/wicket/pageStore/FileChannelPool.java "文件通道池")没有解决我的问题，因为通道仍然需要手动关闭。

这个问题有更优雅的解决方案吗？如果没有，如何改进我的实施？

```
import java.io.IOException;
import java.lang.ref.WeakReference;
import java.nio.channels.FileChannel;
import java.nio.file.Path;
import java.nio.file.StandardOpenOption;
import java.util.Map;
import java.util.Timer;
import java.util.TimerTask;
import java.util.concurrent.ConcurrentHashMap;

public class ChannelPool {

    private static final ChannelPool defaultInstance = new ChannelPool();

    private final ConcurrentHashMap<String, ChannelRef> channels;
    private final Timer timer;

    private ChannelPool(){
        channels = new ConcurrentHashMap<>();
        timer = new Timer();
    }

    public static ChannelPool getDefault(){
        return defaultInstance;
    }

    public void initCleanUp(){
        // wait 2 seconds then repeat clean-up every 10 seconds.
        timer.schedule(new CleanUpTask(this), 2000, 10000);
    }

    public void shutDown(){
        // must be called manually.
        timer.cancel();
        closeAll();
    }

    public FileChannel getChannel(Path path){
        ChannelRef cref = channels.get(path.toString());
        System.out.println("getChannel called " + channels.size());

        if (cref == null){
            cref = ChannelRef.newInstance(path);
            if (cref == null){
                // failed to open channel
                return null;
            }
            ChannelRef oldRef = channels.putIfAbsent(path.toString(), cref);
            if (oldRef != null){
                try{
                    // close new channel and let GC dispose of it
                    cref.channel().close();
                    System.out.println("redundant channel closed");
                }
                catch (IOException ex) {}
                cref = oldRef;
            }
        }
        return cref.channel();
    }

    private void remove(String str) {   
        ChannelRef ref = channels.remove(str);
        if (ref != null){
            try {
                ref.channel().close();
                System.out.println("old channel closed");
            }
            catch (IOException ex) {}
        }
    }

    private void closeAll() {
        for (Map.Entry<String, ChannelRef> e : channels.entrySet()){
            remove(e.getKey());
        }
    }

    private void maintain() {
        // close channels for derefenced paths
        for (Map.Entry<String, ChannelRef> e : channels.entrySet()){
            ChannelRef ref = e.getValue();
            if (ref != null){
                Path p = ref.pathRef().get();
                if (p == null){
                    // gc'd
                    remove(e.getKey());
                }
            }
        }
    }

    private static class ChannelRef{

        private FileChannel channel;
        private WeakReference<Path> ref;

        private ChannelRef(FileChannel channel, WeakReference<Path> ref) {
            this.channel = channel;
            this.ref = ref;
        }

        private static ChannelRef newInstance(Path path) {
            FileChannel fc;
            try {
                fc = FileChannel.open(path, StandardOpenOption.READ);
            }
            catch (IOException ex) {
                return null;
            }
            return new ChannelRef(fc, new WeakReference<>(path));

        }

        private FileChannel channel() {
            return channel;
        }

        private WeakReference<Path> pathRef() {
            return ref;
        }
    }

    private static class CleanUpTask extends TimerTask {

        private ChannelPool pool;

        private CleanUpTask(ChannelPool pool){
            super();
            this.pool = pool;
        }

        @Override
        public void run() {
            pool.maintain();
            pool.printState();
        }
    }

    private void printState(){
        System.out.println("Clean up performed. " + channels.size() + " channels remain. -- " + System.currentTimeMillis());
        for (Map.Entry<String, ChannelRef> e : channels.entrySet()){
            ChannelRef cref = e.getValue();
            String out = "open: " + cref.channel().isOpen() + " - " + cref.channel().toString();
            System.out.println(out);
        }
    }

} 
```

编辑：感谢[fge](https://stackoverflow.com/users/1093528/fge "fge")的回答，我现在完全有我需要的东西。谢谢！

```
import com.google.common.cache.CacheBuilder;
import com.google.common.cache.CacheLoader;
import com.google.common.cache.LoadingCache;
import com.google.common.cache.RemovalListener;
import com.google.common.cache.RemovalNotification;
import java.io.IOException;
import java.nio.channels.FileChannel;
import java.nio.file.Path;
import java.nio.file.StandardOpenOption;
import java.util.concurrent.ExecutionException;

public class Channels {

    private static final LoadingCache<Path, FileChannel> channelCache = 
            CacheBuilder.newBuilder()
            .weakKeys()
            .removalListener(
                new RemovalListener<Path, FileChannel>(){
                    @Override
                    public void onRemoval(RemovalNotification<Path, FileChannel> removal) {
                        FileChannel fc = removal.getValue();
                        try {
                            fc.close();
                        }
                        catch (IOException ex) {}
                    }
                }
            )
            .build(
                new CacheLoader<Path, FileChannel>() {
                    @Override
                    public FileChannel load(Path path) throws IOException {
                        return FileChannel.open(path, StandardOpenOption.READ);
                    }
                }
            );

    public static FileChannel get(Path path){
        try {
            return channelCache.get(path);
        }
        catch (ExecutionException ex){}
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:39:44.730

看看这里：

[http://code.google.com/p/guava-libraries/wiki/CachesExplained](http://code.google.com/p/guava-libraries/wiki/CachesExplained)

您可以将 a`LoadingCache`与删除侦听器一起使用，该侦听器会在通道过期时为您关闭，您可以在访问或写入后指定过期。

# jquery - 滚动和滚动条的不同方向（jQuery Scrollbar Plugin）

> ID：14186464
> 
> 赞同：1
> 
> 时间：2013-01-06T20:35:03.393
> 
> 标签：jquery, jquery-ui, scroll, scrollbar, custom-scrolling

是否可以使用水平滚动条垂直滚动 div？（参见图片 - 将圆圈向右滑动，您将向下滚动）

如果使用流行的 jquery 滚动条插件可以实现这一点，那就太好了，这样我就可以使用一些高级选项而无需编写太多代码......

非常感谢。

-- 检查图像以了解：

![](../Images/8651a9da8446b37385cc0476d1346e5a.png)

# java - 更新 GridView 的问题

> ID：14186469
> 
> 赞同：1
> 
> 时间：2013-01-06T20:35:44.973
> 
> 标签：java, android, gridview

我正在尝试开发一款应用游戏，其中包含显示 12 张卡片，当您选择 3 张卡片时，这些卡片会被替换。我为此建立了两个类，“位置”和“卡片”。`onCreate()`我制作了 72 张卡片并将它们添加到一个`ArrayList`并创建 12 个位置，这 12 个位置有一个 int 作为输入，无论是否选择和一张卡片。该卡的输入之一是 , `R.drawable.image1`，并且在我的输入中我输入`ImageAdapter`了我的`mThumbIds`, `MainActivity.p1.getCard().getImage()`。`p1`是位置的静态实例，所有卡片也是静态的。当一个位置被点击时，它被选中，当其中 3 个被选中时，我有：

```
 if (deck.size() > 0) {
        countSel.get(0).setCard(deck.remove(0));
        countSel.get(1).setCard(deck.remove(1));
        countSel.get(2).setCard(deck.remove(2));
        gridview.invalidateViews();
    } 
```

其中，deck 包含所有卡片，并且`countSel`只有 3 张选定的卡片。所以基本上，现在我的 mThumbIds 中的位置有新卡片和新图片，但即使卡片更新，图像也不会更新。

感谢您的帮助，这是我的其余代码：

图像适配器：

```
package com.example.set;

import android.content.Context;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.GridView;
import android.widget.ImageView;
public class ImageAdapter extends BaseAdapter {
private Context mContext;

public ImageAdapter(Context c) {
    mContext = c;
}

public int getCount() {
    return mThumbIds.length;
}

public Object getItem(int position) {
    return null;
}

public  Integer[] getmThumbIds() {
    return mThumbIds;
}

public  void setmThumbIds(Integer[] mThumbIds) {
    this.mThumbIds = mThumbIds;
}

public long getItemId(int position) {
    return 0;
}

// create a new ImageView for each item referenced by the Adapter
public View getView(int position, View convertView, ViewGroup parent) {
    ImageView imageView;
    if (convertView == null) {  // if it's not recycled, initialize some attributes
        imageView = new ImageView(mContext);
        imageView.setLayoutParams(new GridView.LayoutParams(200, 200));
        imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
        imageView.setPadding(8, 8, 8, 8);
        notifyDataSetChanged();
    } else {
        imageView = (ImageView) convertView;
    }

    imageView.setImageResource(mThumbIds[position]);
    notifyDataSetChanged();
    return imageView;
}

// references to our images
public Integer[] mThumbIds = {
        MainActivity.p1.getCard().getImage() , MainActivity.p2.getCard().getImage(), 
        MainActivity.p3.getCard().getImage(),MainActivity.p4.getCard().getImage() , 
        MainActivity.p5.getCard().getImage(), MainActivity.p6.getCard().getImage(),
        MainActivity.p7.getCard().getImage() , MainActivity.p8.getCard().getImage(), 
        MainActivity.p9.getCard().getImage(), MainActivity.p10.getCard().getImage() , 
        MainActivity.p11.getCard().getImage(), MainActivity.p12.getCard().getImage(),
        MainActivity.p13.getCard().getImage() , MainActivity.p14.getCard().getImage(), 
        MainActivity.p15.getCard().getImage()
}; 
```

}

活动主.xml：

```
 <?xml version="1.0" encoding="utf-8"?>
    <GridView xmlns:android="http://schemas.android.com/apk/res/android" 
    android:id="@+id/gridview"
    android:layout_width="fill_parent" 
    android:layout_height="fill_parent"
    android:columnWidth="200dp"
    android:numColumns="3"
    android:verticalSpacing="60dp"
    android:horizontalSpacing="20dp"
    android:stretchMode="columnWidth"
    android:gravity="center"
    /> 
```

这是我尝试刷新gridview的部分，如果有人认为错误存在，我将发布其余代码，我只是很难正确格式化它：

```
 super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    final GridView gridview = (GridView) findViewById(R.id.gridview);
    gridview.setAdapter(new ImageAdapter(this));

    gridview.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View v,
                int position, long id) {
            if (position == 0) {
                choose(p1);
            } else if (position == 1) {
                choose(p2);
            } else if (position == 2) {
                choose(p3);
            } else if (position == 3) {
                choose(p4);
            } else if (position == 4) {
                choose(p5);
            } else if (position == 5) {
                choose(p6);
            } else if (position == 6) {
                choose(p7);
            } else if (position == 7) {
                choose(p8);
            } else if (position == 8) {
                choose(p9);
            } else if (position == 9) {
                choose(p10);
            } else if (position == 10) {
                choose(p11);
            } else if (position == 11) {
                choose(p12);
            } else if (position == 12) {
                choose(p13);
            } else if (position == 13) {
                choose(p14);
            } else if (position == 14) {
                choose(p15);
            } else {
            }
            if (countSel.size() == 3) {
                countSel.get(0).setChosen(0);
                countSel.get(1).setChosen(0);
                countSel.get(2).setChosen(0);
        if (set(countSel.get(1), countSel.get(2), countSel.get(0))) {
                    {
        Toast.makeText(MainActivity.this, "Got a Set",
            Toast.LENGTH_LONG).show();
                    }

                    if (deck.size() > 0) {
                    countSel.get(0).setCard(deck.remove(0));
                    countSel.get(1).setCard(deck.remove(1));
                    countSel.get(2).setCard(deck.remove(2));

                    } else {
                        countSel.get(0).setCard(cardnull);
                        countSel.get(1).setCard(cardnull);
                        countSel.get(2).setCard(cardnull);

                    }
                } else {
                    Toast.makeText(MainActivity.this,
            "Not A Set" + "remaining" + countSel.size(),
                            Toast.LENGTH_LONG).show();
                }
                countSel.clear();
            }

            {
        Toast.makeText(MainActivity.this,
                    "chicken" + "remaining" +countSel.size(),
                        Toast.LENGTH_SHORT).show();
            }

        }
    });
    gridview.invalidateViews();
}

public void choose(Position p) {
    if (p.getChosen() == 0) {
        p.setChosen(1);
        countSel.add(p);

    }

    else if (p.getChosen() == 1) {
        p.setChosen(0);
        countSel.remove(p);
        System.out.println(countSel.size());
    } else
        System.out.println("emo");
} 
```

# command-line - 如何使用 findstr 的结果设置变量

> ID：14186474
> 
> 赞同：0
> 
> 时间：2013-01-06T20:36:21.890
> 
> 标签：command-line, batch-file

我正在尝试编写一个批处理文件来搜索 pdf 文件并查找它们有多少页并循环所有页面。

我写了以下内容。我可以找到文件，甚至可以使用名为 pdftk 的工具找到页数。结果如下。

```
C:\Users\test\Documents\fishes\Fish_1.pdf
NumberOfPages: 5 
```

如何设置一个值为 的变量`5`？

```
@ECHO off
for /R %%i IN (*.pdf) DO (

ECHO %%i
"C:\Program Files (x86)\PDF Labs\PDFtk Server\bin\pdftk.exe" %%i dump_data | findstr NumberOfPages

set pagecount = findstr NumberOfPages ???

FOR /L %%j IN (1,1,%pagecount%) DO (
    ECHO "page " + %%j
)

) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:53:59.123

你已经有 90% 在那里了。使用 FOR /F 命令来处理命令的结果。`HELP FOR`从命令提示符键入以获取更多信息。

```
for /f "tokens=2" %%A in (
  '"C:\Program Files (x86)\PDF Labs\PDFtk Server\bin\pdftk.exe" %%i dump_data ^| findstr NumberOfPages'
) do set numberOfPages=%%A 
```

# mysql - 从 Amazon RDS 数据库快照恢复时出现问题

> ID：14186477
> 
> 赞同：4
> 
> 时间：2013-01-06T20:36:34.533
> 
> 标签：mysql, amazon-web-services, amazon-rds

我有一些几年前在 Amazon RDS 上制作的数据库快照。我正在尝试恢复这些数据库快照，但是当我选择快照并单击“从数据库快照恢复”时，我收到错误消息：

“找不到 mysql 的 5.1.42 版本”

我首先认为这是因为我没有运行实例，所以我去了 DB Instances，Launched DB Instance，并创建了一个与此快照相同大小的实例。但是，可用的最旧的 MySQL 是 5.1.45，所以这就是我使用的。我能够从我的本地机器连接到它，并且我确认它里面没有数据。

然后我回到我的数据库快照并再次尝试，即使我现在有一个数据库实例正在运行，我仍然收到相同的错误。

我需要做什么来恢复它？

（我都是从 aws Web UI 完成的）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T09:16:43.143

这是一个“有趣”（且令人担忧）的问题 - [Amazon RDS 技术常见问题解答](http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/RDSFAQ.html)中[MySQL 数据库引擎](http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/RDSFAQ.MySQL.html)一章中的数据库*引擎版本管理*部分似乎暗示恢复不受支持的 MySQL 快照实际上可能不再可能（即使没有说明）明确）：

> **Amazon RDS 是否提供支持新 MySQL 版本和/或弃用当前支持的 MySQL 版本的指南？**
> 
> [...]
> 
> 我们打算在最初受 Amazon RDS 支持后的 3 年内支持主要的 MySQL 版本，包括 MySQL 5.1。
> 
> **我们打算在Amazon RDS 最初支持**MySQL 次要版本（例如 MySQL 5.1.45）后至少支持 1 年。****
> 
>  **在 MySQL 主要或次要版本被“弃用”后，我们预计会提供三个月的宽限期，以便您 在计划的维护时段内**应用自动升级之前启动到受支持版本的升级。**
> 
> *[强调我的]***

 **根据[Impossible to create a RDS instance in EU-west](https://forums.aws.amazon.com/thread.jspa?messageID=250048&#250048)的说法，MySQL 5.1.42 最晚于 2011 年 5 月 24 日已被弃用，因此这*三个月的宽限期*早已过去。

显然，您遇到的这种弃用的明显影响（即无法恢复各自过时的快照）会让许多人感到惊讶，因此最终可能仍有处理它的选项，但恐怕您需要联系AWS 寻求解决方案，直接或通过[Amazon Relational Database Service 论坛](https://forums.aws.amazon.com/forum.jspa?forumID=60&start=0)- 如果可能，请在此处发布您的发现作为答案，我希望随着时间的推移，这个问题会定期出现。**

# windows-8 - 如何在 WinRT 中以增量方式加载数据组？

> ID：14186478
> 
> 赞同：5
> 
> 时间：2013-01-06T20:36:34.227
> 
> 标签：windows-8, microsoft-metro, windows-runtime, winrt-xaml

在WinRT中如果要支持增量加载，数据源必须实现[ISupportIncrementalLoading](http://msdn.microsoft.com/en-us/library/windows/apps/Hh701916)接口。我已经实现了这个，并且数据在 GridView 中正确显示。

我逐渐拉下的数据有一个与之关联的日期。我想将关联的月份显示为已下拉数据的“组标题”。但是，随着增量加载项目的月份发生变化，我看不到在“组标题”中设置样式的干净方式。

![插入增量加载数据的组头。](../Images/48295dd358edfc30738535e3680077d0.png)

我意识到通过[CollectionViewSource](http://msdn.microsoft.com/library/windows/apps/BR209833)支持 WinRT 中的正常分组，但是据我了解，这与 ISupportIncrementalLoading 不兼容。这对于一般情况是有意义的，因为新加载的项目实际上可能不会放在最后。但是，在这种情况下，我知道数据已经在服务器上按月份分组并按顺序拉下。

有没有办法在我上面画的“组标题”中设置样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T21:35:28.947

CollectionViewSource 与 ISupportIncrementalLoading 兼容，只需将 CollectionViewSource 的源设置为实现 ISupportIncrementalLoading 的东西。

# algorithm - 树中两个节点不相交的路径，使得这些长度的乘积得到最大

> ID：14186480
> 
> 赞同：0
> 
> 时间：2013-01-06T20:36:42.970
> 
> 标签：algorithm, graph-algorithm

我想在具有 n 个节点的树中找到两条路径，以便这两条路径没有任何公共节点，并且这两条路径的长度相乘得到最大值。任何人都可以帮助我如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:05:39.690

首先，使用递归过程生成每个可能的唯一路径的列表。

你最终得到了 m 个可能的路径。

其次，设置一个 mxm 元素数组。

检查 m 路径中的每一个与所有其他 m-1 路径，并将相应长度的乘积存储到数组中。这样做检查两条路径是否有共同的节点。如果是，则存储 0。

第三，检查 mxm 数组中具有最大值的元素。

你还能做什么？这是非常暴力的，但如果没有更多关于树属性的信息，这是唯一的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:23:29.307

一些想法。如果有两个值 a 和 b 加起来为 n，则 a*b 的最大值是当 a == b 时（为简单起见，假设 n 是偶数）。如果有一条路径通过所有 n 个节点，则将其分成两个几乎相等的部分。对于偶数 n 的此类图，答案将是 (n^2) / 4，对于奇数 n，答案将是 (n-1)/2 * (n+1)/2 = (n^2 - 1) / 4。如果没有路径通过所有 n 个节点，您将不得不使用其他一些技术。但上限如上。

# python - pydev/python 中的“未定义变量：main”

> ID：14186485
> 
> 赞同：3
> 
> 时间：2013-01-06T20:37:08.990
> 
> 标签：python, pydev, main

我在 pydev 中创建了一个名为“Main”的文件，其中写道：

```
if  __name__ =='__Main__':
    main()

def main():
    print("jargon") 
```

它说我在 if 语句下对 main() 的调用包含一个未定义的变量并且不会编译。为什么这样做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-06T20:37:49.050

Python 代码从上到下执行。您需要将`main()`定义移到`if __name__ == '__main__'`块上方。您拥有它的方式，在您尝试调用`main()`时，该功能尚不存在。

# xcode - 如何检查 Xcode 使用的 LLVM 编译器版本？

> ID：14186490
> 
> 赞同：23
> 
> 时间：2013-01-06T20:37:17.443
> 
> 标签：xcode, llvm

我在 OS X 10.8.2 上使用 Xcode 4.5.2。我如何知道 Xcode 使用的是哪个版本的 LLVM 编译器？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-06T20:41:45.887

从命令行：

```
07:40:35 andrew@iMac SalesIQ (siq-303)$ llvm-gcc -v
Using built-in specs.
Target: i686-apple-darwin11
Configured with: /private/var/tmp/llvmgcc42/llvmgcc42-2336.11~67/src/configure --disable-checking --enable-werror --prefix=/Applications/Xcode.app/Contents/Developer/usr/llvm-gcc-4.2 --mandir=/share/man --enable-languages=c,objc,c++,obj-c++ --program-prefix=llvm- --program-transform-name=/^[cg][^.-]*$/s/$/-4.2/ --with-slibdir=/usr/lib --build=i686-apple-darwin11 - enable-llvm=/private/var/tmp/llvmgcc42/llvmgcc42-2336.11~67/dst-llvmCore/Developer/usr/local --program-prefix=i686-apple-darwin11- --host=x86_64-apple-darwin11 --target=i686-apple-darwin11 --with-gxx-include-dir=/usr/include/c++/4.2.1
Thread model: posix
gcc version 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00)
07:40:39 andrew@iMac SalesIQ (siq-303)$ 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-06T20:41:55.847

从用户界面：

*   点击你的项目
*   选择一个目标（可以默认选择）
*   单击构建设置选项卡
*   滚动它以查看“Apple LLVM 编译器：XX - 代码生成”

XX 是你的 LLVM 的版本

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-08T15:29:05.760

这取决于您的构建设置；您可以选择 Clang 或 llvm-gcc，并且 iOS 版本可能使用与 OSX 不同的版本。要准确查看使用的版本，请扩展构建日志的编译选择，例如“<code>Compile ViewController.m”。会有一行像“<code>/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang -x ...</code>”

或者

“<code>/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/llvm-gcc-4.2 -x…</code>”

选择编译器的路径，在终端中执行以下命令：

```
8> /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang --version

Apple clang version 4.1 (tags/Apple/clang-421.11.66) (based on LLVM 3.1svn)… 
```

或者

```
9> /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/llvm-gcc-4.2 --version

i686-apple-darwin10-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2410.2.00)… 
```

请注意，Apple Clang 版本控制不同于 GCC 版本控制和开源 LLVM。

# http - Clojure Noir：如何仅为应用程序的一部分设置基本身份验证

> ID：14186491
> 
> 赞同：2
> 
> 时间：2013-01-06T20:37:38.277
> 
> 标签：http, clojure, basic-authentication, ring, noir

[我已经使用Ring Basic Authentication](https://github.com/remvee/ring-basic-authentication)为我的应用程序设置了 HTTP Basic 身份验证。它工作得很好，看起来像这样：

```
(:require [noir.server :as server]
...
(server/add-middleware wrap-basic-authentication authenticated?) 
```

认证？是我自己的功能实现。现在我只想将应用程序的一部分配置为进行基本身份验证，而将其他部分配置为公开。我知道这[可以](https://github.com/remvee/ring-basic-authentication/wiki)用 Ring（和 Compojure）来完成，所以它必须可以用基于 Ring 的 Noir 来完成。我只是不太确定如何应用[该示例](https://github.com/remvee/ring-basic-authentication/wiki)以适应 Noir，因为它使用路线，我不知道如何才能到达 Noir 中的那些。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T07:21:14.957

Noir 的问题在于，路由是在后台管理的，您根本无法做任何事情来改变它们与中间件等的联系方式。Noir 从来都不是复杂的中间件场景的好搭档，现在它已经被弃用了。这可能不是您想听到的答案，但我强烈建议您改用 Compojure。如果您正在寻找包含电池的东西，请查看[luminus leiningen 模板](http://www.luminusweb.net/)，用于生成包含 Compojure、lib-noir 和各种其他好东西的包含电池的 Web 应用程序。

# jquery - 如何在使用 jquery 将克隆添加到同一个列表之前检查无序列表的重复项？

> ID：14186493
> 
> 赞同：-2
> 
> 时间：2013-01-06T20:37:57.617
> 
> 标签：jquery

首先，我克隆以下 div 列表：

```
<div class=".a_list"><p><input type="checkbox" />Testing A list</p></div>
<div class=".a_list"><p><input type="checkbox" />Testing A list</p></div>
<div class=".a_list"><p><input type="checkbox" />Testing A list</p></div> 
```

```
$(".a_list").each(function(){
    $(this).clone().appendTo("#list").wrap("<li />");
}); 
```

在将克隆添加到列表之前如何检查#list

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:25:10.057

您应该首先`.`从类名中删除。你可以使用`filter`和`text`方法。

```
var $list = $('#list');
$(".a_list").each(function(){
    var $that = $(this); // Sorry, note that there was a typo here
    var e = $list.find('li').filter(function(){
         return $(this).text() === $that.text();
    }).length === 0;
    if (e) {
       $that.clone().wrap("<li/>").appendTo($list);
    }
}); 
```

# bash - 脚本在语法正确时给出“elif [ $1 = “-h”] 附近的意外错误

> ID：14186495
> 
> 赞同：0
> 
> 时间：2013-01-06T20:37:59.587
> 
> 标签：bash, parameters

尝试在终端中运行此命令时：

```
gerard@yoda ~$ Sources/Scripts/ultimate.sh -u -typecount -std /usr/bin py
Sources/Scripts/ultimate.sh: line 28: syntax error near unexpected token `elif'
Sources/Scripts/ultimate.sh: line 28: `elif [ $1 = "-h" ];' 
```

这是脚本的来源：

```
#!/bin/bash

## $1 = Mode(u/h) ; $2 = Command(?) ; $3+ = Params

if [ $1 = "-u" ];
    if [ $2 = "-typecount" ];
    then
        if [ $3 = "-std" ];
        then
            find $4 -maxdepth 1 -iname *.$5 | wc -l
        elif [ $3 = "-ext" ];
        then
            find $5 -maxdepth $4 -iname *.$6 | wc -l
        else
            echo 'use option -std for single-dir'
            echo 'or option -def for recusive with custom depth'
            echo 'filetype should be defined  type  instead of .type'
        fi
    elif [ $2 = "-prep" ];
    then
        sed -i 's/^/$3/' $4
    elif [ $2 = "-app" ];
    then
        sed -i 's/$/$3/' $4
    else
        echo 'No command specified/Command not found'
    fi
elif [ $1 = "-h" ];
then
    if [ $2 = "-typecount" ];
    then
        echo 'for -std: [location] [type]'
        echo 'for -ext: [depth] [location] [type]'
    elif [ $2 = "-prep" ];
    then
        echo '[text] [file]'
    elif [$2 = "-app" ];
    then
        echo '[text] [file]'
    else
        echo 'No command specified/Command not found'
else
    echo 'No mode specified/Wrong mode'
fi 
```

语法对我来说似乎是正确的，并且具有相同 elif 构造的脚本的更简单版本可以正常工作。我做错什么了？（需要的函数解析完成后脚本需要退出）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:42:28.383

在顶部，第一个之后没有`then`关键字`if`。

```
if [ $1 = "-u" ];
**then**
    if [ $2 = "-typecount" ]; 
```

您还缺少`fi`接近底部的内容：

```
 else
        echo 'No command specified/Command not found'
    **fi**
else 
```

# android - ANR keyDispatchingTimedOut 平台 OTHER

> ID：14186496
> 
> 赞同：1
> 
> 时间：2013-01-06T20:38:05.217
> 
> 标签：android

如何调查此错误？我从 android market 读到了这个日志。平台我看到“其他”。

```
Line 2637 and others:

    seekBar1.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {
              public void onStopTrackingTouch(SeekBar seekBar) {
              // TODO Auto-generated method stub
              if(seek<10)
              {
              seek=10;
              seekBar1.setProgress(seek);
              }
    //        Toast.makeText(getBaseContext(), String.valueOf(p), Toast.LENGTH_SHORT).show();
              }
              public void onStartTrackingTouch(SeekBar seekBar) {
              // TODO Auto-generated method stub
              }
              public void onProgressChanged(SeekBar seekBar, int progress,boolean fromUser) {
              // TODO Auto-generated method stub
              seek=progress;
              SharedPreferences prefs = getSharedPreferences(PRIVATE_PREF, 0);
              SharedPreferences.Editor editor = prefs.edit();
              editor.putInt("seek", seek);
              editor.putInt("progress", progress);
              editor.commit();
              textView1.setTextSize(seek);
              }
              });

    "main" prio=5 tid=1 NATIVE
      | group="main" sCount=1 dsCount=0 obj=0x409f0460 self=0x12800
      | sysTid=12489 nice=0 sched=0/0 cgrp=[fopen-error:2] handle=1074803848
      | schedstat=( 1790000000 1790000000 3091 ) utm=159 stm=20 core=0
      at libcore.io.Posix.fsync(Native Method)
      at libcore.io.BlockGuardOs.fsync(BlockGuardOs.java:97)
      at java.io.FileDescriptor.sync(FileDescriptor.java:71)
      at android.os.FileUtils.sync(FileUtils.java:111)
      at android.app.SharedPreferencesImpl.writeToFile(SharedPreferencesImpl.java:577)
      at android.app.SharedPreferencesImpl.access$800(SharedPreferencesImpl.java:48)
      at android.app.SharedPreferencesImpl$2.run(SharedPreferencesImpl.java:491)
      at android.app.SharedPreferencesImpl.enqueueDiskWrite(SharedPreferencesImpl.java:512)
      at android.app.SharedPreferencesImpl.access$100(SharedPreferencesImpl.java:48)
      at android.app.SharedPreferencesImpl$EditorImpl.commit(SharedPreferencesImpl.java:434)
      at com.example.app.MainActivity$3.onProgressChanged(MainActivity.java:2637)
      at android.widget.SeekBar.onProgressRefresh(SeekBar.java:89)
      at android.widget.ProgressBar.doRefreshProgress(ProgressBar.java:609)
      at android.widget.ProgressBar.refreshProgress(ProgressBar.java:621)
      at android.widget.ProgressBar.setProgress(ProgressBar.java:670)
      at android.widget.AbsSeekBar.trackTouchEvent(AbsSeekBar.java:411)
      at android.widget.AbsSeekBar.onTouchEvent(AbsSeekBar.java:349)
      at android.view.View.dispatchTouchEvent(View.java:5545)
      at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
      at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
      at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
      at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
      at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
      at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
      at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
      at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
      at android.view.ViewGroup.dispatchTransformedTouchEvent(ViewGroup.java:1957)
      at android.view.ViewGroup.dispatchTouchEvent(ViewGroup.java:1726)
      at com.android.internal.policy.impl.PhoneWindow$DecorView.superDispatchTouchEvent(PhoneWindow.java:1912)
      at com.android.internal.policy.impl.PhoneWindow.superDispatchTouchEvent(PhoneWindow.java:1371)
      at android.app.Activity.dispatchTouchEvent(Activity.java:2364)
      at com.android.internal.policy.impl.PhoneWindow$DecorView.dispatchTouchEvent(PhoneWindow.java:1860)
      at android.view.View.dispatchPointerEvent(View.java:5725)
      at android.view.ViewRootImpl.deliverPointerEvent(ViewRootImpl.java:2907)
      at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2471)
      at android.view.ViewRootImpl.processInputEvents(ViewRootImpl.java:849)
      at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:863)
      at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2446)
      at android.os.Handler.dispatchMessage(Handler.java:99)
      at android.os.Looper.loop(Looper.java:137)
      at android.app.ActivityThread.main(ActivityThread.java:4424)
      at java.lang.reflect.Method.invokeNative(Native Method)
      at java.lang.reflect.Method.invoke(Method.java:511)
      at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
      at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
      at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-01-29T15:16:27.607

这是一个非常古老的问题，但答案可能仍然有用。

上面的代码有两个问题：

1.  对`editor.commit();`commit() 方法的调用是同步的，这意味着每次调用它时，数据都会直接写入磁盘。
2.  调用`editor.commit();`内部`onProgressChanged()`方法。根据实现，此方法可能在一秒钟内被多次调用。将它与 UI 线程上的磁盘写入操作结合起来，这意味着您在不断地写入并且 UI 被阻塞。

**可能的解决方案：**

3.  将所需的值（“seek”，“progress”）保存到内存中。仅当存在数据可能丢失的风险（例如活动状态更改）时，才将它们保存到共享首选项中。

4.  替换`editor.commit();`为`editor.apply();`。Apply() 方法是异步的，因此不太可能发生阻塞 UI 线程。

您可以在此处查看完整文档： [https://developer.android.com/reference/android/content/SharedPreferences.Editor.html#apply()](https://developer.android.com/reference/android/content/SharedPreferences.Editor.html#apply())

# jquery - jQuery 点击动作只触发一次，每次页面刷新

> ID：14186505
> 
> 赞同：9
> 
> 时间：2013-01-06T20:39:45.380
> 
> 标签：jquery

我在我的网站的管理部分编写了一个 jQuery 代码，它可以在不刷新页面的情况下使网站脱机。它工作得很好，但有一件事：

> 当我单击打开时，准确地进行了 ajax 调用并且所有类都被更改并且文本被更改为关闭。但是，当我单击此文本时，没有任何反应。如果我重新加载页面，那么我将能够。

```
$("#switch_off").click(function() {
                $("#switch_off").html("<img style=\"padding-left:15px;\" src=\"/img/admin/ajax-loader.gif\">");
                $('#switch_off').removeClass('ttip_b')
                $.ajax({
                    url: "/settings/SwitchOffline",
                    type: "get",
                    data: '',
                    success: function(responseText, statusText, xhr, $form){ // Trigger when request was successful
                        $("#site_status").html("<span id=\"offline\" class=\"lbl error_bg\">Offline</span><span id=\"switch_on\" class=\"ttip_b\" title=\"Click to place Site Online\">Turn On</span>");
                    },
                    error: function(responseText){
                        //alert(responseText);
                    }   
                });
                return false;
            });

            $("#switch_on").click(function() {
                $("#switch_on").html("<img style=\"padding-left:15px;\" src=\"/img/admin/ajax-loader.gif\">");
                $('#switch_on').removeClass('ttip_b')
                $.ajax({
                    url: "/settings/SwitchOnline",
                    type: "get",
                    data: '',
                    success: function(responseText, statusText, xhr, $form){                            
                        $("#site_status").html("<span id=\"online\" class=\"lbl ok_bg\">Online</span><span id=\"switch_off\" class=\"ttip_b\" title=\"Click to place Site Offline\">Turn Off</span>");                          
                    },
                    error: function(responseText){
                        //alert(responseText);
                    }   
                });

                return false;
            }); 
```

![在线的](../Images/9272fe7bc4322a31b395df803cba752d.png) ![离线](../Images/8457b05b40b316074389a473404910d9.png)

带有一些 PHP 的 HTML 代码

```
<div class="user_info user_sep" style="width:90px;">
                            <p class="sepH_a">
                                <strong>Site Status</strong>
                            </p>
                            <?php
                            //debug($site_offline);
                            if($site_offline){
                            ?>                              
                            <span id="site_status">
                                <span id="offline" class="lbl error_bg">Offline</span>
                                <span id="switch_on" class="ttip_b" title="Click to place Site Online">Turn On</span>

                            </span>
                            <?php }else{ ?>
                            <span id="site_status">
                                <span id="online" class="lbl ok_bg">Online</span>
                                <span id="switch_off" class="ttip_b" title="Click to place Site Offline">Turn Off</span>

                            </span>
                            <?php } ?>
                        </div> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-06T20:49:10.367

尝试使用事件委托，因为您在每次单击时都重写 HTML，并且绑定丢失了。通过使用事件委托，您可以将事件绑定到 DOM 中的当前元素和将附加到 DOM 的未来元素，例如那些由 AJAX 调用产生的元素。

采用

```
$("#site_status").on("click", "#switch_off", function() {
  ...
}); 
```

```
$("#site_status").on("click", "#switch_on", function() {
  ...
}); 
```

代替

```
$("#switch_off").click(function() {
  ...
}); 
```

```
$("#switch_on").click(function() {
  ...
}); 
```

如果`#site_status`也被覆盖，则使用`document`.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-06T21:48:44.300

为了扩展@Alexander 的答案，问题在于您正在动态生成 HTML 内容，但在文档初始化时添加了侦听器。这意味着您尝试绑定的某些元素在绑定时**还不存在**。因此，永远不会创建侦听器。解决方案是使用 jQuery[`.on`](http://api.jquery.com/on)来“监听”尚不存在的元素上的事件：

```
$("#switch_off").click(function() { 
```

应该：

```
$(document).on('click', '#switch_off', function() { 
```

同样：

```
$("#switch_on").click(function() { 
```

应该：

```
$(document).on('click', '#switch_on', function() { 
```

然而，正如其他人所表达的那样，更好的解决方案是稍微清理一下代码并显示/隐藏各自的状态，而不是动态生成它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T21:24:35.167

以下代码适用于您的情况：

**编辑**：如果您只想要一个按钮（这似乎是您在重读问题时想要的） - 以下代码有效。顺便说一句，在您的场景中（以及出于此演示的目的）我能想到的唯一方法是从“关闭”开始，否则您需要提出自己的 ajax 来“检查”服务器是否处于ON 或 OFF 然后将适当的代码放入 HTML（以及适当的启动 JS）中。我把这留给你自己弄清楚。我也有一个想法如何做到这一点，但这由你决定是否愿意。

JSFIDDLE：http: [//jsfiddle.net/ytpv7/11/](http://jsfiddle.net/ytpv7/11/)

HTML：

```
<div id="site_status"><span id='switch_on'> Offline Turn ON  </span></div> 
```

JS：

```
$("#switch_on").click(ON);

function ON() {
    $.ajax({
        url : "/settings/SwitchOnline",
        type : "get",
        data : '',
        complete : function (responseText, statusText, xhr, $form) {
            var str = "<span id='switch_off'>" + 'Online Turn OFF' + "</span>";
      $("#site_status").html(str);
            $("#switch_off").click(OFF);
        },
        error : function (responseText) {
            //alert(responseText);
        }
    });

    return false;
}

function OFF() {

    $.ajax({
        url : "/settings/SwitchOffline",
        type : "get",
        data : '',
        complete : function (responseText, statusText, xhr, $form) {
            var str = "<span id='switch_on'>" + "Offline Turn ON" + "</span>";
      $("#site_status").html(str);
            $("#switch_on").click(ON);
        },
        error : function (responseText) {
            //alert(responseText);
      }
    });
    return false;
} 
```

**结束编辑**

原始答案 - 带有 ON 和 OFF 按钮（也可以使用 ajax 结果文本）：

（请注意在 JSFIDDLE 中，出于演示目的，我将 ajax 事件更改为完成 - 您将其更改回成功以用于您的目的）

[http://jsfiddle.net/ytpv7/5/](http://jsfiddle.net/ytpv7/5/)

HTML：

```
<div id="switch_off">OFF</div>
<div id="switch_on">ON</div>
<div id="site_status"></div> 
```

JS：

```
$("#switch_off").click(OFF);

$("#switch_on").click(ON);

function ON() {
    $("#switch_on").html("<img style=\"padding-left:15px;\" src=\"/img/admin/ajax-loader.gif\">");
    $('#switch_on').removeClass('ttip_b');
    $.ajax({
        url : "/settings/SwitchOnline",
        type : "get",
        data : '',
        complete : function (responseText, statusText, xhr, $form) {
            var str = "<span id='online'>" + 'Online Turn OFF' + "</span>";
      $("#site_status").html(str);
            $("#online").click(OFF);
        },
        error : function (responseText) {
            //alert(responseText);
        }
    });

    return false;
}

function OFF() {
    $("#switch_off").html("<img style=\"padding-left:15px;\" src=\"/img/admin/ajax-loader.gif\">");
    $('#switch_off').removeClass('ttip_b')
    $.ajax({
        url : "/settings/SwitchOffline",
        type : "get",
        data : '',
        complete : function (responseText, statusText, xhr, $form) { // Trigger when request was successful
            var str = "<span id='offline'>" + "Offline Turn ON" + "</span>";
      $("#site_status").html(str);
            $("#offline").click(ON);
        },
        error : function (responseText) {
            //alert(responseText);
      }
    });
    return false;
} 
```

# python - Python如何在生成的图像上叠加随机图像以最终得到2个带有文本的图像

> ID：14186510
> 
> 赞同：2
> 
> 时间：2013-01-06T20:39:55.077
> 
> 标签：python, image, python-imaging-library

这是我到目前为止的代码。它所做的是从文本文件中抓取随机文本行并生成随机颜色，然后创建顶部带有文本的 JPG 图像。我想要做的是随机拍摄一张照片并将其覆盖在纯色之上，不透明度可能为 0.2 或其他东西，然后将文本放在上面，所以我最终得到 > 纯色 > 图片覆盖 > 文本在上面。此代码生成多个图像。将文本也垂直居中会很好，但我不清楚如何做到这一点。

```
import Image, random, textwrap, ImageFont, ImageDraw, os, sys
basepath = os.path.dirname(sys.argv[0]) + "/"

for n in xrange(10):

    keywordlist = []
    imglist = []
    keyword = file(basepath + "text.txt", "r")

    for line in keyword:
        keywordlist.append(line.replace("\n", ""))

        def type(name):
            value = name[random.randint(0,len(name)-1)]
            return value

    def random_color():
        return (random.randint(0,155), random.randint(0,155), random.randint(0,155))

    astr = ('%s' %(type(keywordlist)))
    para = textwrap.wrap(astr,width=19)

    MAX_W,MAX_H=640,400
    im = Image.new('RGB', (MAX_W, MAX_H), (random_color()))
    draw = ImageDraw.Draw(im)
    font = ImageFont.truetype('C:/windows/fonts/Arialbd.ttf', 58)

    current_h=0
    for line in para:
        w,h=draw.textsize(line, font=font)
        draw.text(((MAX_W-w)/2, current_h), line, font=font,)
        current_h+=h

    im.save('img%000d.jpg' % n) 
```

以下是输出示例：

![例子](../Images/f52deda8dfa8b3fd54ad19435af6117b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:27:43.173

Use [the `blend` function](http://www.pythonware.com/library/pil/handbook/image.htm#image-blend-function):

```
new_image = Image.blend(solid_color_image, picture, 0.2) 
```

# ios - 在 iOS iTunes 库中设置音乐文件的插图（越狱）

> ID：14186514
> 
> 赞同：2
> 
> 时间：2013-01-06T20:40:31.497
> 
> 标签：ios, jailbreak, itunes-app, itunesartwork

有一个很好的开源库，它使用 Apple 的私有框架将音频文件添加到越狱 iOS 设备上的 iTunes 库中，[libipodimport](https://github.com/H2CO3/libipodimport)。它缺少的是在添加音乐文件时也添加艺术品的能力（一位贡献者签入了应该这样做的[代码](https://github.com/H2CO3/libipodimport/commit/fc74d693ecb05ca06fb3db280df9c8f40d6da10f)，但作者后来删除了它，因为它不起作用）。

有谁知道 libipodimport 中的代码缺少什么（请参阅上一个链接），或者可能是另一种将艺术作品文件添加到音乐文件的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T21:27:10.283

libipodimport 的贡献者告诉我，使艺术品添加工作的缺失行：

```
// metad is a SSDownloadMetadata object, see libipodimport for rest of code
[metad setFullSizeImageURL:[NSURL fileURLWithPath:[userInfo objectForKey:kIPIKeyArtworkPath]]]; 
```

它似乎只适用于 jpeg 文件，而不适用于 png 文件。

库 libipodimport 很可能会在不久的将来由作者更新。

# c# - 将两个 char 数组作为单个字符串返回的正确方法是什么？

> ID：14186517
> 
> 赞同：0
> 
> 时间：2013-01-06T20:40:43.220
> 
> 标签：c#, string, properties, path, char

我在一个静态类中有一个公共属性，我想将其用作针对非法文件和路径名验证用户输入的一种方式。

目前我有这个：

```
private static string invalidFileNames = new string(Path.GetInvalidFileNameChars());

private static string invalidPathNames = new string(Path.GetInvalidPathChars());

private static string invalidUserInput = (invalidFileNames + invalidPathNames); 

public static string InvalidUserInput
{

    get { return invalidUserInput; }

} 
```

根据[此处](http://msdn.microsoft.com/en-us/library/system.io.path.getinvalidfilenamechars.aspx)的 Microsoft 文档，我期待回来`"<>|"<>|`但我得到的只是第一个`"<>|`.

任何人都可以对这里发生的事情有所了解吗？如何确保返回两个字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:49:40.800

您无法在调试器中看到它们，但您可以将它们输出到文件中，并使用比记事本更好的编辑器查看它们，例如 notepad++

```
File.WriteAllText("tmp.txt", invalidUserInput, UTF8Encoding.GetEncoding("UTF-8")); 
```

![记事本++的屏幕截图](../Images/5212b4fbcd59a87926b5ee2045e7da39.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:50:10.647

你可以把它变成一个字符串

```
using System.Linq;

public static string InvalidUserInput
{
    get 
    {
        return new string(Path.GetInvalidFileNameChars()
                  .Concat(Path.GetInvalidPathChars())
                  .Distinct()
                  .ToArray());
    }
} 
```

您不会在 TextBox 中看到它们，因为`InvalidUserInput`在您的情况下终止符类型字符`\0`是它停止显示的（空终止符）。

如果您只想显示对用户有意义的内容，您可以使用删除导致问题的内容`Char.IsControl`

这是一个包含所有内容的静态类

```
public static class StringExtentions
{
    private static string _invalidUserInput = string.Empty;
    private static string _PrinatbleInvalidUserInput = string.Empty;

    public static string InvalidUserInput
    {
        get
        {
            if (_invalidUserInput == string.Empty)
            {
                _invalidUserInput = new string(Path.GetInvalidFileNameChars()
                      .Concat(Path.GetInvalidPathChars())
                      .Distinct()
                      .ToArray());
            }
            return _invalidUserInput;
        }
    }

    public static string GetPrinatbleInvalidUserInput
    {
        get
        {
            if (_PrinatbleInvalidUserInput == string.Empty)
            {
                _PrinatbleInvalidUserInput = new string(InvalidUserInput.Where(x => !char.IsControl(x)).ToArray());
            }
            return _PrinatbleInvalidUserInput;
        }
    }

    public static bool IsValidUserInput(this string str)
    {
        return !str.Any(c => InvalidUserInput.Contains(c));
    }
} 
```

用法：

```
public MainWindow()
{
    InitializeComponent();
    string myString = "C:\\InvalidPath<";

    if (!myString.IsValidUserInput())
    {
        MessageBox.Show(string.Format("String cannot contain {0}", StringExtentions.GetPrinatbleInvalidUserInput));
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:13:00.750

在这种情况下，因为您可能会多次使用数据，您可能只想记录两个字符数组之间唯一的字符。为此，您可以使用[Union](http://msdn.microsoft.com/en-us/library/bb341731.aspx)方法，如下所示：

```
private static string invalidUserInput = new string(Path.GetInvalidFileNameChars().Union(Path.GetInvalidPathChars()).ToArray()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T20:49:10.457

运行您的代码会返回许多 unicode 字符：

```
"<>|□□□□□□□□□  
□□
□□□□□□□□□□□□□□□□□□:*?\/"<>|□□□□□□□□□  
□□
□□□□□□□□□□□□□□□□□□
```

你确定你没有因为 unicode 字符而丢失任何东西吗？

另外，这是您的*确切*代码吗？如果您切换变量初始化的顺序，它将不再起作用，因为`invalidUserInput`必须在其他两个之后进行评估（它们按照它们在代码中定义的顺序进行评估）。

# windows-8 - Windows 8 上的 D3DXCreateFont 替代方案？

> ID：14186521
> 
> 赞同：1
> 
> 时间：2013-01-06T20:41:05.790
> 
> 标签：windows-8, directx, d3dx

我正在玩弄一个挂钩的 DirectX 9 应用程序。如您所知，[D3DX 框架在 Windows 8 中已被弃用](http://msdn.microsoft.com/en-us/library/windows/desktop/ee663275%28v=vs.85%29.aspx)。Microsoft 建议我们“研究使用 Direct3D API 的替代解决方案”。在 Windows 8 中使用方便的 D3DXCreateFont 的替代解决方案是什么？**我正在使用 DirectX 版本 9。**如果我仍然能够在 Windows 8 中以某种方式引用 D3DX 框架，那么这是我的首选解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:49:18.463

使用 D3DX。

在这种特殊情况下，因为您要挂接已经使用 DirectX 9 的应用程序，所以使用该 API 版本提供的库和资源是您的最佳解决方案。使用 D3D9 时，将 D3DX 用于实用程序功能是完全可以接受和推荐的做法。

这些建议适用于为 Windows 8 设计的软件。虽然您的软件可能旨在在该平台上运行，但连接到未施加重大限制的应用程序。你必须使用已经在使用的东西，在这种情况下，D3DX 将比尝试使用新库更兼容。事实上，考虑到有多少 D3D9 和更早的应用程序使用 D3DX，它很有可能已经在使用中，您也许可以重复使用它。

请注意，这并不意味着您需要的 D3DX DLL 存在；根据应用程序，可能只有一个版本，因此您可能需要提供 DLL 或安装程序。

# android - 2d 图形 - 如何制作节拍器时钟指针

> ID：14186525
> 
> 赞同：0
> 
> 时间：2013-01-06T20:41:35.500
> 
> 标签：android, animation, graphics, drawing, 2d

我是安卓新手。我有一个节拍器应用程序，我想放一个说明滴答循环的图形。（只是一根固定在一端的线，它的角度正在改变）是这样的： http: [//dir.coolclips.com/Entertainment/Music/Professional_Audio_Equipment/Metronomes/metronome_CoolClips_vc005895.jpg](http://dir.coolclips.com/Entertainment/Music/Professional_Audio_Equipment/Metronomes/metronome_CoolClips_vc005895.jpg)。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T12:27:47.590

您正在寻找的方程是基于节拍器（钟摆）频率。

![摆方程](../Images/8e0ace8351a58856d5d7470f8fc20844.png)

在哪里，![φ](../Images/0f848e7e00d36e4838d96f3d73bfdc77.png)是`current angle`，![飞零](../Images/11d7e72d7000477a947d4d7d4afc5d71.png)是`initial angle`，![G](../Images/ce8675641e02161ac307dd155ee07109.png)是`gravitational acceleration ~ 9.81 m/s`，![l](../Images/3fc1a21eec17ce9ad4965f54b4eaad38.png)是`length of pendulum in m`，![吨](../Images/ecd8b89fce61711c5d4526c76f780644.png)是`time of simulation in sec`..

# android - Android 存储媒体文件：使用 raw/ 文件夹还是 assets/ 文件夹？

> ID：14186527
> 
> 赞同：0
> 
> 时间：2013-01-06T20:41:47.997
> 
> 标签：android, file, directory

为什么选择一个而不是另一个？它们是如何存储在手机上的？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:44:04.180

通过资源，内置支持为不同语言、操作系统版本、屏幕方向等提供替代方案，如此处[所述](http://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources)。这些都不适用于资产。此外，API 的许多部分都支持使用资源标识符。最后，资源的名称被转换为在编译时检查的常量字段名称，因此代码和资源本身之间不匹配的机会更少。这些都不适用于资产。

那么为什么有一个资产文件夹呢？如果你想计算你想在运行时使用的资产，这很容易。对于资源，您必须声明可能使用的所有资源 ID 的列表，并计算列表中的索引。（如果资源集在开发周期中发生变化，这有点尴尬，并且会引入错误机会。）您可以使用名称检索资源 ID [`getIdentifier`](http://developer.android.com/reference/android/content/res/Resources.html#getIdentifier%28java.lang.String,%20java.lang.String,%20java.lang.String%29)，但这失去了编译时检查的好处。资产也可以组织成文件夹层次结构，资源不支持。这是一种不同的数据管理方式。尽管资源涵盖了大多数情况，但资产偶尔也会用到。

另一个区别：库项目中定义的资源会自动导入到依赖于库的应用程序项目中。对于资产，这不会发生；资产文件必须存在于应用程序项目的资产目录中。

# java - Java：排序索引数组

> ID：14186529
> 
> 赞同：3
> 
> 时间：2013-01-06T20:41:58.983
> 
> 标签：java, arrays, sorting, indexing

快速问题：我有一个数组`double[]array=new double [10]`，其中有随机双精度数，例如在 0 到 20 之间。我想要的是得到另一个数组`int []resultingArray=new int [array.length]`，每个值 int 是`array[]`排序形式从最大数字到最小数字的双精度值的索引。由于我的英语很烂，这里是一个“图表”：

数组 = (2, 6, 3) ***_* __ *_* _**结果数组 = (1, 2, 0)

这是一道考试题。双打是学生的 GPA，它要求一个方法返回一个数组，该数组由从最好的学生到最差的学生的 ID（在我的代码中是 double[]array 的索引）组成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:14:10.633

有很多使用`Map`s 的解决方案，我将提出一个仅使用数组的替代方案：

```
public int[] getIndices(double[] originalArray)
{
    int len = originalArray.length;

    double[] sortedCopy = originalArray.clone();
    int[] indices = new int[len];

    // Sort the copy
    Arrays.sort(sortedCopy);

    // Go through the original array: for the same index, fill the position where the
    // corresponding number is in the sorted array in the indices array
    for (int index = 0; index < len; index++)
        indices[index] = Arrays.binarySearch(sortedCopy, originalArray[index]);

    return indices;
} 
```

然而，这是非常低效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:29:19.177

Here's how I would do it:

*   Put all of the elements of `array` in a `Map<Integer, Double>` that maps the index to the value.

*   Put all of the elements of the `entrySet()` of this map into a list and sort that list by values.

*   Form an array out of the keys of the newly sorted list of entries.

* * *

```
public static int[] getIndicesInOrder(double[] array) {
    Map<Integer, Double> map = new HashMap<Integer, Double>(array.length);
    for (int i = 0; i < array.length; i++)
        map.put(i, array[i]);

    List<Entry<Integer, Double>> l = 
                           new ArrayList<Entry<Integer, Double>>(map.entrySet());

    Collections.sort(l, new Comparator<Entry<?, Double>>() {
            @Override
            public int compare(Entry<?, Double> e1, Entry<?, Double> e2) {
                return e2.getValue().compareTo(e1.getValue());
            }
        });

    int[] result = new int[array.length];
    for (int i = 0; i < result.length; i++)
        result[i] = l.get(i).getKey();

    return result;
} 
```

* * *

```
public static void main(String[] args) {
    double[] array = { 1.1, 2.2, 3.3, 4.4, 3.3 };

    System.out.println(Arrays.toString(getIndicesInOrder(array)));
} 
```

```
[3, 2, 4, 1, 0]

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T21:11:35.937

也许是这样的：

```
import java.util.*;

public class Test
{
    static Integer[] getIndicesInOrder(Integer[] array)
    {
        Integer[] c = array.clone();
        Arrays.sort(c, Collections.reverseOrder());

        List<Integer> l = Arrays.asList(array);

        for (int i = 0; i < array.length; ++i)
        {
            c[i] = l.indexOf(c[i]);
        }

        return c;
    }

    public static void main(String[] args)
    {
        Integer[] array = {2,6,3};

        System.out.println(Arrays.toString(getIndicesInOrder(array)));
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T22:20:26.570

您可以使用自定义[`Comparator`](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)比较各个索引处的等级数组中的值，

```
import java.util.*;

public class GradeComparator implements Comparator<Integer> {
    private double[] grades;
    public GradeComparator(double[] arr) {
        grades = arr;
    }
    public int compare(Integer i, Integer j) {
        return Double.compare(grades[j], grades[i]);
    }
} 
```

并使用它对索引数组进行排序`Comaprator`：

导入 java.util.*；

```
public class SortGrades {
    public static void main(String[] args) {
        double[] grades = { 2.4, 6.1, 3.9, 4.8, 5.5 };
        Integer[] ranks = new Integer[grades.length];
        for(int i = 0; i < ranks.length; ++i) {
            ranks[i] = i;
        }
        Comparator<Integer> gc = new GradeComparator(grades);
        Arrays.sort(ranks, gc);
        for(int i = 0; i < ranks.length; ++i) {
            System.out.println((i+1) + ": " + ranks[i] + ", grade: " + grades[ranks[i]]);
        }
    }
} 
```

输出

```
1: 1, grade: 6.1
2: 4, grade: 5.5
3: 3, grade: 4.8
4: 2, grade: 3.9
5: 0, grade: 2.4 
```

如预期的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-06T21:05:06.880

如果学生的分数是随机的，你可以这样做（这在现实世界中没有多大意义，因为你不能/不给学生打分精确到*15*位数字；）

```
public static int[] sortWithIndex(double[] results) {
    class ScoreIndex implements Comparable<ScoreIndex> {
        final double score;
        final int index;

        ScoreIndex(double score, int index) {
            this.score = score;
            this.index = index;
        }

        @Override
        public int compareTo(ScoreIndex o) {
            int cmp = Double.compare(score, o.score);
            return cmp == 0 ? Integer.compare(index, o.index) : cmp;
        }
    }
    List<ScoreIndex> list = new ArrayList<>();
    for (int i = 0; i < results.length; i++) list.add(new ScoreIndex(results[i], i));
    Collections.sort(list);
    int[] indexes = new int[results.length];
    for (int i = 0; i < list.size(); i++) indexes[i] = list.get(i).index;
    return indexes;
} 
```

* * *

如果您对学生进行评分以限制精度，请说您只能做到 < 6 位数

```
public static void sortWithIndex(double[] results) {
    for(int i = 0; i < results.length; i++)
        results[i] = results[i] * results.length * 1e6 + i;
    Arrays.sort(results);
} 
```

现在`results`按值的顺序包含所有原始值和它们来自的索引，如果有重复，则较低的索引在前。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-06T21:46:46.253

> 这是一道考试题。双打是学生的 GPA，它要求一个方法返回一个数组，该数组由从最好的学生到最差的学生的 ID（在我的代码中是 double[]array 的索引）组成。

我会用地图来做。`<ID, Doubles>`. 我们不能直接使用 TreeMap，因为它是按 Key 排序的。我们想按价值（那些双打）排序。但是，我们可以对此做一些技巧，以制作我们自己的比较器 impl。按值对地图进行排序。

我在一个junit测试类中写的，

```
@Test
public void testArray() {
    final double[] array = new double[] { 1.1, 2.2, 3.3, 4.4, 3.3 };
    final int[] result = new int[array.length];

    final Map<Integer, Double> map = new HashMap<Integer, Double>();
    for (int i = 0; i < array.length; i++) {
        map.put(i, array[i]);
    }
    final List<Map.Entry> list = new LinkedList<Map.Entry>(map.entrySet());
    Collections.sort(list, new Comparator() {
        @Override
        public int compare(final Object o1, final Object o2) {
            return 0 - ((Comparable) ((Map.Entry) o1).getValue()).compareTo(((Map.Entry) o2).getValue());
        }
    });
    for (int i = 0; i < list.size(); i++) {

        result[i] = (Integer) list.get(i).getKey();
    } 

    //here we have result, to test it:
    for (final int element : result) {
        System.out.println(element);
    }
} 
```

它打印：

```
 3
    2
    4
    1
    0 
```

# python - 为什么 collections.Counter 比 ''.count 慢得多？

> ID：14186533
> 
> 赞同：7
> 
> 时间：2013-01-06T20:42:24.817
> 
> 标签：python, performance, counter

我有一个简单的任务：计算每个字母在字符串中出现的次数。我已经使用了`Counter()`它，但是在一个论坛上我看到使用`dict()`/`Counter()`比使用`string.count()`每个字母慢得多的信息。我认为它只会遍历字符串一次，并且`string.count()`解决方案必须遍历它四次（在这种情况下）。为什么`Counter()`这么慢？

```
>>> timeit.timeit('x.count("A");x.count("G");x.count("C");x.count("T")', setup="x='GAAAAAGTCGTAGGGTTCCTTCACTCGAGGAATGCTGCGACAGTAAAGGAGGCCACGTGGTTGAGAGTTCCTAAGCATTCGTATGTACACCCGGACTCGATGCACTCAAACGTGCTTAAGGGTAAAGAAGGTCGAGAGGTATACTGGGGCACTCCCCTTAGAATTATATCTTGGTCAACTACAATATGGATGGAAATTCTAAGCCGAAAACGACCCGCTAGCGGATTGTGTATGTATCACAACGGTTTCGGTTCATACGCAAAATCATCCCATTTCAAGGCCACTCAAGGACATGACGCCGTGCAACTCCGAGGACATCCCTCAGCGATTGATGCAACCTGGTCATCTAATAATCCTTAGAACGGATGTGCCCTCTACTGGGAGAGCCGGCTAGACTGGCATCTCGCGTTGTTCGTACGAGCTCCGGGCGCCCGGGCGGTGTACGTTGATGTACAGCCTAAGAGCTTTCCACCTATGCTACGAACTAATTTCCCGTCCATCGTTCCTCGGACTGAGGTCAAAGTAACCCGGAAGTACATGGATCAGATACACTCACAGTCCCCTTTAATGACTGAGCTGGACGCTATTGATTGCTTTATAAGTGTTATGGTGAACTCGAAGACTTAGCTAGGAATTTCGCTATACCCGGGTAATGAGCTTAATACCTCACAGCATGTACGCTCTGAATATATGTAGCGATGCTAGCGGAACGTAAGCGTGAGCGTTATGCAGGGCTCCGCACCTCGTGGCCACTCGCCCAATGCCCGAGTTTTTGAGCAATGCCATGCCCTCCAGGTGAAGCGTGCTGAATATGTTCCGCCTCCGCACACCTACCCTACGGGCCTTACGCCATAGCTGAGGATACGCGAGTTGGTTAGCGATTACGTCATTCCAGGTGGTCGTTC'", number=10000)
0.07911698750407936
>>> timeit.timeit('Counter(x)', setup="from collections import Counter;x='GAAAAAGTCGTAGGGTTCCTTCACTCGAGGAATGCTGCGACAGTAAAGGAGGCCACGTGGTTGAGAGTTCCTAAGCATTCGTATGTACACCCGGACTCGATGCACTCAAACGTGCTTAAGGGTAAAGAAGGTCGAGAGGTATACTGGGGCACTCCCCTTAGAATTATATCTTGGTCAACTACAATATGGATGGAAATTCTAAGCCGAAAACGACCCGCTAGCGGATTGTGTATGTATCACAACGGTTTCGGTTCATACGCAAAATCATCCCATTTCAAGGCCACTCAAGGACATGACGCCGTGCAACTCCGAGGACATCCCTCAGCGATTGATGCAACCTGGTCATCTAATAATCCTTAGAACGGATGTGCCCTCTACTGGGAGAGCCGGCTAGACTGGCATCTCGCGTTGTTCGTACGAGCTCCGGGCGCCCGGGCGGTGTACGTTGATGTACAGCCTAAGAGCTTTCCACCTATGCTACGAACTAATTTCCCGTCCATCGTTCCTCGGACTGAGGTCAAAGTAACCCGGAAGTACATGGATCAGATACACTCACAGTCCCCTTTAATGACTGAGCTGGACGCTATTGATTGCTTTATAAGTGTTATGGTGAACTCGAAGACTTAGCTAGGAATTTCGCTATACCCGGGTAATGAGCTTAATACCTCACAGCATGTACGCTCTGAATATATGTAGCGATGCTAGCGGAACGTAAGCGTGAGCGTTATGCAGGGCTCCGCACCTCGTGGCCACTCGCCCAATGCCCGAGTTTTTGAGCAATGCCATGCCCTCCAGGTGAAGCGTGCTGAATATGTTCCGCCTCCGCACACCTACCCTACGGGCCTTACGCCATAGCTGAGGATACGCGAGTTGGTTAGCGATTACGTCATTCCAGGTGGTCGTTC'", number=10000)
2.1727447831030844
>>> 2.1727447831030844 / 0.07911698750407936
27.462430656767047
>>> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-06T21:26:54.903

`Counter()`允许您计算任何可散列对象，而不仅仅是子字符串。两种解决方案都是`O(n)`及时的。您的测量结果表明，迭代和散列单个字符的开销`Counter()`大于运行`s.count()`4 次。

`Counter()` *可以*使用 C 助手来计算元素，但它似乎不是特殊情况下的字符串，而是使用适用于任何其他可迭代的通用算法，即[处理单个字符涉及多个 Python C API 调用以推进迭代器，获取先前的值（在哈希表），递增计数器，设置新值（在哈希表中查找）](http://hg.python.org/cpython/file/8a6068ec220e/Modules/_collectionsmodule.c#l1680)：

```
 while (1) {
        key = PyIter_Next(it);
        if (key == NULL)
            break;
        oldval = PyObject_GetItem(mapping, key);
        if (oldval == NULL) {
            if (!PyErr_Occurred() || !PyErr_ExceptionMatches(PyExc_KeyError))
                break;
            PyErr_Clear();
            Py_INCREF(one);
            newval = one;
        } else {
            newval = PyNumber_Add(oldval, one);
            Py_DECREF(oldval);
            if (newval == NULL)
                break;
        }
        if (PyObject_SetItem(mapping, key, newval) == -1)
            break;
        Py_CLEAR(newval);
        Py_DECREF(key);
    } 
```

将其与[`FASTSEARCH()`](http://hg.python.org/cpython/file/8a6068ec220e/Objects/stringlib/fastsearch.h#l88)字节串的开销进行比较：

```
 for (i = 0; i < n; i++)
        if (s[i] == p[0]) {
           count++;
           if (count == maxcount)
              return maxcount;
        }
    return count; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-06T20:49:42.037

该类`Counter`继承自`dict`,`string.count`而是以下 C 实现 (CPython 3.3)：

```
/* stringlib: count implementation */

#ifndef STRINGLIB_FASTSEARCH_H
#error must include "stringlib/fastsearch.h" before including this module
#endif

Py_LOCAL_INLINE(Py_ssize_t)
STRINGLIB(count)(const STRINGLIB_CHAR* str, Py_ssize_t str_len,
                const STRINGLIB_CHAR* sub, Py_ssize_t sub_len,
                Py_ssize_t maxcount)
{
    Py_ssize_t count;

    if (str_len < 0)
        return 0; /* start > len(str) */
    if (sub_len == 0)
        return (str_len < maxcount) ? str_len + 1 : maxcount;

    count = FASTSEARCH(str, str_len, sub, sub_len, maxcount, FAST_COUNT);

    if (count < 0)
        return 0; /* no match */

    return count;
} 
```

猜一猜，哪个更快？:)

# bash - Bash curl POST一个二进制变量

> ID：14186536
> 
> 赞同：2
> 
> 时间：2013-01-06T20:42:37.367
> 
> 标签：bash, variables, curl, encoding, binary

你如何在 curl bash 中发布二进制变量？

```
#!/usr/bin/env bash
IMAGE=$(curl "http://www.google.com/images/srpr/logo3w.png")
curl --data-binary "$IMAGE" --request "POST" "http://www.somesite.com" 
```

上传时，Curl 似乎确实损坏了图像。

Curl 可以选择将响应写入磁盘然后从中读取，但仅在内存中执行此操作会更有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:02:14.073

尝试消除变量 ... 如下：

```
curl "http://www.google.com/images/srpr/logo3w.png" | curl --data-binary - --request "POST" "http://www.somesite.com" 
```

从 curl 手册页：

> 如果您以字母 @ 开始数据，则其余部分应该是从中读取数据的文件名，或者 - 如果您希望 curl 从标准输入中读取数据。

**编辑**：也从手册页：

> --raw 使用时，它会禁用所有内部 HTTP 内容解码或传输编码，而是让它们原封不动地传递。（在 7.16.2 中添加）

如果应用于任何一方或双方会发生什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-28T17:14:36.217

我有一个相关的问题，我想动态地从给定文件夹中卷曲文件。

`curl --data-binary directory/$file --request "POST" "http://www.somesite.com"` 不起作用 - 上传字符串“directory/myFile.jar”而不是实际文件。

添加@符号 `curl --data-binary @directory/$file --request "POST" "http://www.somesite.com"`修复它。

# android - “扩展应用程序”和 sharedPreferences 之间的区别？

> ID：14186537
> 
> 赞同：0
> 
> 时间：2013-01-06T20:42:38.333
> 
> 标签：android, sharedpreferences

我希望存储简单的变量，以便如果应用程序进程停止，数据在重新启动时仍然可用。我研究了扩展 Application 类和 sharedPreferences。对我来说，扩展 Application 似乎有利于在应用进程停止时删除的临时全局变量。但是 sharedPreferences 将变量保存到文件中，以便始终可用。两者有什么区别，它们的最佳用途是什么？此外，即使应用程序停止，存储您想要保留的变量的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T20:48:45.560

当您的应用程序的进程被终止时，存储在 Application 类中的所有数据都将丢失。您应该只使用它来存储在您的应用程序的多次启动和使用中不需要的数据。

对于存储简单数据，如高分、声音偏好、在启动偏好时显示对话框，您最好的选择是 SharedPreferences。对于更全面的数据，例如用户在您的应用程序中购买的列表，或待办事项列表应用程序中的注释，您应该使用 SQLite 数据库。

除此之外，如果您想存储PDF等文件或图像（图像也可以保存到数据库中），您可以使用内部存储或外部存储（可能是SD卡，或内部存储上的分区） ）。请记住，在大多数设备上，内部存储空间非常有限，您不应在其中保存过大的文件。

[这](http://developer.android.com/guide/topics/data/data-storage.html)部分文档应该可以帮助您选择存储选项。

# android - 用于将文本从数组更改为字符串的按钮

> ID：14186538
> 
> 赞同：0
> 
> 时间：2013-01-06T20:42:42.733
> 
> 标签：android, sdk

简单的问题我需要在此代码中添加什么，以便在按下按钮时将文本视图替换为数组列表中的字符串之一？

```
 package com.

    import android.app.Activity;
    import android.os.Bundle;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;
    import android.widget.TextView;

    public class main extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button b = (Button) findViewById(R.id.button1);

    b.setOnClickListener(new OnClickListener() {
           @Override
           public void onClick(View v) {
               TextView tx = (TextView) findViewById(R.id.textView2);
               tx.setText("Hello");

           }
    });
    }
    }

    -----------------------------------------------------

    <?xml version="1.0" encoding="utf-8"?>
    <resources>

    <string name="hello">Hello World, main!</string>
    <string name="app_name">Ihavenever</string>

    <string-array
    name="list">
    <item>@string/girl</item>
    <item>@string/boy</item>
    <item>@string/man</item>
    <item>@string/women</item>
    <item>@string/dog</item>
    <item>@string/cat</item>
    </string-array>

    </resources> 
```

所以简而言之，应用程序启动时底部有一个按钮，一旦按下它就会将其中一个项目放在屏幕中间的文本视图中的字符串数组中，当你再次按下它时，它会给你另一个和另一个直到那里没有剩下，然后从第一个重新开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T20:49:19.740

制作

```
int counter = 0; 
```

全局（外部`onCreate()`）。

然后在声明按钮后的 onCreate() 中：

```
Button b = (Button) findViewById(R.id.button1);

Resources res = getResources();
final String[] list = res.getStringArray(R.array.list); //get the array
((TextView) findViewById(R.id.textView2)).setText (list [counter]); //set the initial message.

b.setOnClickListener(new OnClickListener() {
           @Override
           public void onClick(View v) {
               TextView tx = (TextView) findViewById(R.id.textView2);
               counter++;
               if (counter >= list.length)
                  counter = 0;

               tx.setText(list [counter]); //set the new message.

           }
    }); 
```

# opengl - 使用法线贴图进行后处理的酷技巧？

> ID：14186544
> 
> 赞同：0
> 
> 时间：2013-01-06T20:43:23.423
> 
> 标签：opengl, glsl

这是一个非常具体的问题：我希望在后期处理中使用法线。我一直在研究 SSAO，但它似乎很慢，而且在低样本时我看不到好的结果。

目前我可以将它用于简单的“照明”，但我认为应该有更多更好的可能性。那么，有人知道法线贴图的任何后处理技巧吗？

编辑：顺便说一句，我也知道凹凸贴图。

Edit2：我还发现了一个更便宜的 SSAO 着色器，[http ://blenderartists.org/forum/showthread.php?184102-nicer-and-faster-SSAO](http://blenderartists.org/forum/showthread.php?184102-nicer-and-faster-SSAO)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:00:34.047

你到底想做什么？通常，唯一涉及法线贴图的后处理是延迟光照。

理论上，您可以使用这些信息来补充绽放或几乎任何与照明相关的后期效果。使用表面法线和亮度来计算散景可以使景深受益，您可以使用法线和镜面反射来计算眩光。我确信还有其他潜在用途，并且会尝试使用它们，特别是如果您的照明解决方案的缓冲区中有正常数据。

# r - vrtest 包：扩展文本答案？

> ID：14186547
> 
> 赞同：3
> 
> 时间：2013-01-06T20:44:11.677
> 
> 标签：r, variance, random-walk

我使用 vrtest 包（和 Lo.Mac 命令）进行了方差比测试。我的问题是 R 只是为我提供了计算出的测试统计数据，而不是测试的边界值、p 值等。有人知道该怎么做吗？这是我所做的：

```
> Lo.Mac(rcorr,kvec)
$Stats
             M1         M2
k=2   2.2525920  2.1072370
k=5   0.8903658  0.8383312
k=10 -0.5530420 -0.5388423

> str(Lo.Mac(rcorr,kvec))
List of 1
 $ Stats: num [1:3, 1:2] 2.253 0.89 -0.553 2.107 0.838 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:3] "k=2" "k=5" "k=10"
  .. ..$ : chr [1:2] "M1" "M2" 
```

非常感谢你 ！

热拉尔丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T07:49:37.557

看`?Boot.test`

> 此函数返回 Lo-MacKilay (1988) 和 Chow-Denning (1993) 检验的引导 p 值。

```
Boot.test(rcorr,kvec,nboot=500,wild="Normal")
$Holding.Period
[1]  2  5 10

$LM.pval
[1] 0.012 0.284 0.810

$CD.pval
[1] 0.028

$CI
          2.5%    97.5%
k=2  -2.013676 1.733034
k=5  -1.725987 1.745693
k=10 -1.562838 1.815892 
```

# jquery - IE7 和 8 中的白页 - Webshims / Polyfill 问题

> ID：14186553
> 
> 赞同：2
> 
> 时间：2013-01-06T20:45:09.653
> 
> 标签：jquery, wordpress, internet-explorer, polyfills

我刚刚使用 Twitter Bootstrap 和 Wordpress 完成了一个小型 Web 项目，但不幸的是 Internet Explorer 存在一些问题。Opera、Safari 和 Chrome 无错误地显示页面。

在 IE10 和 IE9 中一切看起来都不错，但 IE8 和 IE7 只显示一个白页。我已经进行了谷歌搜索以找到解决“白屏死机”（WSOD）的方法，但我很失望。

我还对页面本身进行了一些调试。通过这种方式，我发现 HTML5 表单的 polyfill 导致了问题。为此，我正在使用[Webshims](http://afarkas.github.com/webshim/demos/)。在页面上它声明了 IE6+ 兼容性，但正如您所见，情况并非如此，这很奇怪。

所以我查看了 FireBug 控制台，看看是否有任何 JavaScript 错误。没有任何错误，但有一个警告，位于导致问题的脚本中：

`Call webshims.polyfill before DOM-Ready or set waitReady to false.`

所以我查看了文档并设置`waitReady`为，`false`因为我在页面底部加载了脚本。结果，警告消失了——但 IE8 和 IE7 仍然只显示一个白页！作为测试，我再次删除了对脚本的调用，该页面在 IE8 和 7 中工作。一旦我再次添加调用 - 白页。

经过几个小时的困惑，我想到了一件事：默认情况下，Wordpress 中的 jQuery 以无冲突模式运行，这意味着`$("#something)`您必须编写`jQuery("#something")`. 我的想法是这可能会导致一些问题，所以我停用了无冲突模式。仍然：什么都没有，白页。

我没有更多的想法可能导致问题，所以我问你：你遇到过这个问题吗？您有任何解决方案或解决方案的想法吗？

非常感谢任何输入！

# c# - 计算 31 位数字/忽略最高有效位

> ID：14186564
> 
> 赞同：0
> 
> 时间：2013-01-06T20:46:45.240
> 
> 标签：c#, binary, computer-forensics

我正在开发一款分析 E01 比特流图像的软件。基本上，这些是取证数据文件，允许用户将磁盘上的所有数据压缩成一个文件。E01格式嵌入了关于原始数据的数据，包括源数据的MD5哈希和结果数据等。如果你有兴趣轻读，[这里](http://code.google.com/p/libewf/downloads/detail?name=Expert%20Witness%20Compression%20Format%20%28EWF%29.pdf)有EWF/E01规范。关于我的问题：

e01 文件包含一个“表”部分，它是一系列 32 位数字，它们是 e01 文件中实际数据块所在的其他位置的偏移量。我已经成功地将这些数据解析成一个列表，执行以下操作：

```
this.ChunkLocations = new List<int>();
//hack:Will this overflow?  We are adding to integers to a long?
long currentReadLocation = TableSectionDescriptorRef.OffsetFromFileStart + c_SECTION_DESCRIPTOR_LENGTH + c_TABLE_HEADER_LENGTH;
byte[] currReadBytes;
using (var fs = new FileStream(E01File.FullName, FileMode.Open))
      {
      fs.Seek(currentReadLocation, 0);
      for (int i = 0; i < NumberOfEntries; i++)
                {
                    currReadBytes = new byte[c_CHUNK_DATA_OFFSET_LENGTH];
                    fs.Read(currReadBytes,0, c_CHUNK_DATA_OFFSET_LENGTH);
                    this.ChunkLocations.Add(BitConverter.ToUInt32(currReadBytes, 0));
                }
       } 
```

c_CHUNK_DATA_OFFSET_LENGTH 是 4 个字节/“32 位”数字。

根据 ewf/e01 规范，“块数据偏移中的最高有效位指示块是压缩的 (1) 还是未压缩的 (0)”。这似乎可以通过以下事实得到证明：如果我将偏移量转换为整数，结果中会有很大的负数（对于没有压缩的块，毫无疑问），但大多数其他偏移量似乎都正确增加了，但是每个偶尔会有疯狂的数据。ChunkLocations 中的数据如下所示：

> ```
> 346256
> 379028
> -2147071848
> 444556
> 477328
> 510100 
> ```

在 -2147071848 的情况下，MSB 似乎被翻转以指示压缩/缺乏压缩。

问题：所以，如果 MSB 用于标记压缩的存在，那么我真的在处理 31 位数字，对吗？
1\. 在计算偏移值时如何忽略 MSB/计算 31 位数字？
2\. 这似乎是一个奇怪的标准，因为它似乎会显着限制您可以拥有的偏移量的大小，所以我在质疑我是否遗漏了什么？当我导航到 e01 文件中的这些位置时，这些偏移看起来是正确的。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:49:31.177

在处理二进制格式时，这种事情很典型。正如 dtb 指出的那样，对于这个应用程序来说，31 位可能已经足够大了，因为它可以处理高达 2 GiB 的偏移量。所以他们使用额外的位作为标志来节省空间。

您可以使用按位与来屏蔽该位：

```
const UInt32 COMPRESSED = 0x80000000;   // Only bit 31 on

UInt32 raw_value = 0x80004000;          // test value

bool compressed = (raw_value & COMPRESSED) > 0;
UInt32 offset = raw_value & ~COMPRESSED;

Console.WriteLine("Compressed={0}  Offset=0x{1:X}", compressed, offset); 
```

输出：

```
Compressed=True  Offset=0x4000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T20:51:21.203

如果您只想去除前导位，请使用 0x7FFFFFFF 对值执行按位和 (&)

# jquery - 带有加号和减号图标的jQuery隐藏和显示切换div

> ID：14186565
> 
> 赞同：19
> 
> 时间：2013-01-06T20:46:56.140
> 
> 标签：jquery, html, css, hide, show

我有为节目工作的代码并隐藏`div`. 当显示和隐藏处于活动状态时，如何添加两个不同的图标作为精灵图像？

例如：**+**图标显示我，然后**-**图标隐藏我。

这是代码，我有：http: [//jsfiddle.net/BLkpG/](http://jsfiddle.net/BLkpG/)

```
$(document).ready(function(){
   $(".slidingDiv").hide();
   $(".show_hide").show();

    $('.show_hide').click(function(){
    $(".slidingDiv").slideToggle();
  });
}); 
```

**切换到+**或**-**时需要将图像更改为上述图像。

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-06T20:56:22.677

尝试这样的事情

**jQuery**

```
$('#toggle_icon').toggle(function() {

    $('#toggle_icon').text('-');
    $('#toggle_text').slideToggle();

}, function() {

    $('#toggle_icon').text('+');
    $('#toggle_text').slideToggle();

}); 
```

**HTML**

```
<a href="#" id="toggle_icon">+</a>

<div id="toggle_text" style="display: none">
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s
</div> 
```

**[演示](http://jsfiddle.net/pfknd9ra/)**

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-06T21:09:18.353

我想说最优雅的方式是这样的：

```
<div class="toggle"></div>
<div class="content">...</div> 
```

然后是CSS：

```
.toggle{
 display:inline-block;
height:48px;
width:48px;  background:url("http://icons.iconarchive.com/icons/pixelmixer/basic/48/plus-icon.png");
}
.toggle.expanded{
  background:url("http://cdn2.iconfinder.com/data/icons/onebit/PNG/onebit_32.png");
} 
```

和js：

```
$(document).ready(function(){
  var $content = $(".content").hide();
  $(".toggle").on("click", function(e){
    $(this).toggleClass("expanded");
    $content.slideToggle();
  });
}); 
```

[小提琴](http://jsfiddle.net/z7F75/1/)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-06T21:04:21.200

切换文本`Show`并`Hide`移动`backgroundPosition` **Y**轴

**[现场演示](http://jsfiddle.net/BLkpG/900/)**

```
$(function(){ // DOM READY shorthand

    $(".slidingDiv").hide();

    $('.show_hide').click(function( e ){
        // e.preventDefault(); // If you use anchors
        var SH = this.SH^=1; // "Simple toggler"
        $(this).text(SH?'Hide':'Show')
               .css({backgroundPosition:'0 '+ (SH?-18:0) +'px'})
               .next(".slidingDiv").slideToggle();
    });

}); 
```

CSS：

```
.show_hide{
  background:url(plusminus.png) no-repeat;
  padding-left:20px;  
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-07T15:24:26.050

这是对 Enve 答案的快速编辑。我确实喜欢 roXor 的解决方案，但不需要背景图像。而且每个人似乎也忘记了一个`preventDefault`。

```
$(document).ready(function() {
  $(".slidingDiv").hide();

  $('.show_hide').click(function(e) {
    $(".slidingDiv").slideToggle("fast");
    var val = $(this).text() == "-" ? "+" : "-";
    $(this).hide().text(val).fadeIn("fast");
    e.preventDefault();
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<a href="#" class="show_hide">+</a>

<div class="slidingDiv">
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta.
    Mauris massa. Vestibulum lacinia arcu eget nulla. </p>

  <p>Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Curabitur sodales ligula in libero. Sed dignissim lacinia nunc. Curabitur tortor. Pellentesque nibh. Aenean quam. In scelerisque sem at dolor. Maecenas mattis.
    Sed convallis tristique sem. Proin ut ligula vel nunc egestas porttitor. Morbi lectus risus, iaculis vel, suscipit quis, luctus non, massa. Fusce ac turpis quis ligula lacinia aliquet. Mauris ipsum. </p>

</div>
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-01-06T20:52:14.873

这有效：

[http://jsfiddle.net/UhEut/](http://jsfiddle.net/UhEut/)

CSS：

```
.show_hide {
    display:none;
}
.plus:after {
    content:" +";
}
.minus:after {
    content:" -";
} 
```

jQuery：

```
$(document).ready(function(){
  $(".slidingDiv").hide();
  $(".show_hide").addClass("plus").show();
  $('.show_hide').toggle(
      function(){
          $(".slidingDiv").slideDown();
          $(this).addClass("minus");
          $(this).removeClass("plus");
      },
      function(){
          $(".slidingDiv").slideUp();
          $(this).addClass("plus");
          $(this).removeClass("minus");
      }
  );
}); 
```

HTML：

```
<a href="#" class="show_hide">Show/hide</a>

<div class="slidingDiv" style="display: block;">
Check out the updated jQuery plugin for doing this: <a href="http://papermashup.com/jquery-show-hide-plugin/" class="show_hide" target="_blank" style="display: inline;">jQuery Show / Hide Plugin</a>
</div> 
```

在 CSS 中，`content:" +";`您可以放置​​一个`background-image`（使用`background-position:right center;`并且`background-repeat:no-repeat`可能将`.show_hide`显示为块并给他一个宽度，以便 bg-image 不会被链接文本本身覆盖）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-04-26T16:10:58.870

这是一个如何使用箭头而不是 a`+`和的示例`-`。这用于`jQuery`更改元素上的类，并`CSS`设置箭头的样式。

```
$(".toggleHide").click(function() {
  $(".elementToHide").slideToggle("fast");
  $(this).find("i").toggleClass("down up");
});
```

```
i {
  border: solid black;
  border-width: 0 5px 5px 0;
  display: inline-block;
  padding: 5px;
  -webkit-transition-duration: 1s;
  /* Safari */
  transition-duration: 1s;
}

.up {
  transform: rotate(-135deg);
  -webkit-transform: rotate(-135deg);
}

.down {
  transform: rotate(45deg);
  -webkit-transform: rotate(45deg);
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<h3 class="toggleHide"><i class="down"></i></h3>
<aside class="elementToHide">
  Content to hide
</aside>
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-02T06:40:12.017

HTML：

```
<div class="Settings" id="GTSettings">
  <h3 class="SettingsTitle"><a class="toggle" ><img src="${appThemePath}/images/toggle-collapse-light.gif" alt="" /></a>General Theme Settings</h3>
  <div class="options">
    <table>
      <tr>
        <td>
          <h4>Back-Ground Color</h4>
        </td>
        <td>
          <input type="text" id="body-backGroundColor" class="themeselector" readonly="readonly">
        </td>
      </tr>
      <tr>
        <td>
          <h4>Text Color</h4>
        </td>
        <td>
          <input type="text" id="body-fontColor" class="themeselector" readonly="readonly">
        </td>
      </tr>
    </table>
  </div>
</div>

<div class="Settings" id="GTSettings">
  <h3 class="SettingsTitle"><a class="toggle" ><img src="${appThemePath}/images/toggle-collapse-light.gif" alt="" /></a>Content Theme Settings</h3>
  <div class="options">
    <table>
      <tr>
        <td>
          <h4>Back-Ground Color</h4>
        </td>
        <td>
          <input type="text" id="body-backGroundColor" class="themeselector" readonly="readonly">
        </td>
      </tr>
      <tr>
        <td>
          <h4>Text Color</h4>
        </td>
        <td>
          <input type="text" id="body-fontColor" class="themeselector" readonly="readonly">
        </td>
      </tr>
    </table>
  </div>
</div> 
```

JavaScript：

```
$(document).ready(function() {

  $(".options").hide();
  $(".SettingsTitle").click(function(e) {
    var appThemePath = $("#appThemePath").text();

    var closeMenuImg = appThemePath + '/images/toggle-collapse-light.gif';
    var openMenuImg = appThemePath + '/images/toggle-collapse-dark.gif';

    var elem = $(this).next('.options');
    $('.options').not(elem).hide('fast');
    $('.SettingsTitle').not($(this)).parent().children("h3").children("a.toggle").children("img").attr('src', closeMenuImg);
    elem.toggle('fast');
    var targetImg = $(this).parent().children("h3").children("a.toggle").children("img").attr('src') === closeMenuImg ? openMenuImg : closeMenuImg;
    $(this).parent().children("h3").children("a.toggle").children("img").attr('src', targetImg);
  });

}); 
```

# javascript - 多个DIV中的jquery scrollToFixed限制

> ID：14186567
> 
> 赞同：0
> 
> 时间：2013-01-06T20:47:15.833
> 
> 标签：javascript, jquery, scrollto

在过去的 48 小时里，我一直在尝试解决这个问题，但我真的找不到解决方案。我正在使用[https://github.com/bigspotteddog/ScrollToFixed](https://github.com/bigspotteddog/ScrollToFixed)插件，我想限制父 DIV 中的固定位置。我确实在stackoverflow和项目github页面中看到了关于scrollToFixed的**所有**相关问题，但我没有找到任何解决这个问题的线索。

到目前为止，我有这个：http: [//jsfiddle.net/CVMjp/1/](http://jsfiddle.net/CVMjp/1/)

这是基本的 HTML 结构：

```
<div class="container" id="element_1">
  <div class="content">Content</div>
  <div class="sticky">Sticky</div>
</div> 
```

这将是我影响页面上每个元素的 jQuery 函数：

```
$(document).ready(function() {
for (i = 1; i <= $('.sticky').length; i++) {

    $('#element_' + i + ' .sticky').scrollToFixed({
        marginTop: 20, 
                  zIndex:1,
                  limit: $('#element_' + (i + 1) + ' .content').offset().top - $('#element_' + i + ' .sticky').height() - 50
    });
}       
}); 
```

**我希望 .sticky 框在到达底部时停留在每个 .content 的底部。**现在在我的示例中，当它到达 .content DIV 的底部时，它会将其“固定”位置更改为“绝对”，但是正文边距存在问题（因为它具有基于正文的“左侧”位置而不是 .content 中的左侧位置）和其他问题我无法真正找到问题的根源。

**此外，在 jsfiddle 示例中， $(document).ready**没有问题，但在我的在线站点中，我必须使用**$(window).load**来获取每个 .content DIV的正确**offset().top 。**当我使用 document.ready 时，显然所有 .content DIV 都被视为具有相同的高度，尽管它们不同，因为它们内部的内容量不同。

如果我能解决这个问题，我会更新这个问题，但我可以使用一些帮助。

提前致谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T14:06:49.010

你需要一点不同的方法。

首先`.sticky`应该在一个容器中。`display: table`然后用和制作布局表`display: table-cell`。`table-layout: fixed`将帮助您保持两者`.sidebar`的`.content`高度相同。这是[小提琴](http://jsfiddle.net/JJJhX/)，先生。

不过也有限制。例如，您只能`position: relative`在您的身体标签上使用。

关于这个`offset().top`问题，您可以使用[waitForImages](https://github.com/alexanderdickson/waitForImages)插件并将其应用于您的`.content`唯一。虽然不知道更好的解决方案。

# jsf-2 - JSF2 - p:dataTable 中的 h:commandLink 调用 @ViewScoped bean 的构造函数

> ID：14186571
> 
> 赞同：0
> 
> 时间：2013-01-06T20:47:58.200
> 
> 标签：jsf-2, primefaces

为什么 p:dataTable 中的 h:commandLink 调用 @ViewScoped bean 的构造函数？

> JSF 2.1.8 + Primefaces 3.4 + Tomcat 6.0.35

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:f="http://java.sun.com/jsf/core" lang="en">
<h:body>
    <h:form>
        <p:dataTable var="item" value="#{realizadaMB.list}">
            <p:column>
                <f:facet name="header">
                Some
            </f:facet>
                <h:commandLink action="cotacao" value="#{item}" />
            </p:column>
        </p:dataTable>
    </h:form>
</h:body>
</html> 
```

-

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

    Simple page cotacao.xhtml

</html> 
```

-

```
@ManagedBean
@ViewScoped
public class RealizadaMB implements Serializable {
    private List<String> list = Arrays.asList("one", "two"); //getter and setter omitted
    @PostConstruct
    public void init() {
        System.out.println("Oh no!");
    }
} 
```

> 当我单击“一个”或“两个”时，会再次调用 init。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:41:35.480

暂时有两种解决方案：

1.  删除 primefaces 引用。请改用 h:dataTable 和 h:column。

2.  降级到 primefaces 3.3.1（看看[http://forum.primefaces.org/viewtopic.php?f=3&t=24676](http://forum.primefaces.org/viewtopic.php?f=3&t=24676)）

# svn - 在颠覆中搬迁而不搬迁？

> ID：14186572
> 
> 赞同：6
> 
> 时间：2013-01-06T20:47:58.760
> 
> 标签：svn, ubuntu, ubuntu-12.04

我需要在 subversion 中切换我的工作副本的基本 URL。

根据 1.7 的手册，我应该可以使用 svn relocate。 [http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.relocate.html](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.relocate.html)

但是，在 Ubuntu Linux 12.04 上，我的 1.6 版似乎没有 relocate 命令。

有没有办法在颠覆 1.6 或通过其他方法来实现这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-06T23:01:10.373

我找到了我正在寻找的答案。这只是跑步的问题

```
svn switch --relocate OLD_URL NEW_URL 
```

看起来在 subversion 1.7 上您可以使用新语法：

```
svn relocate NEW_URL 
```

# php - 上传时调整照片大小

> ID：14186573
> 
> 赞同：-1
> 
> 时间：2013-01-06T20:48:10.483
> 
> 标签：php, image

> **可能重复：**
> [PHP 调整大小并上传图片](https://stackoverflow.com/questions/6608586/php-resize-and-upload-an-image)

我有一个用户可以上传照片的网站。现在，我开始意识到有些照片需要重新调整大小和转换。我知道如何上传和移动照片，但是如果它们太大，我该如何重新调整它们的大小，如果不是，如何将它们转换为 JPEG？

这是我的PHP：

```
if ($_FILES['media']['size'] != 0) {
    $target= UPLOADPATH . $media;
    move_uploaded_file($_FILES['media']['tmp_name'], $target);
    $query= "INSERT INTO posts (user_id, story, media, date, view, type)
                        VALUES ('$user_id', '$story', '$media', now(), '$view', '1')";
    mysqli_query($connect, $query) or die('error with query 2');
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T20:54:45.850

这里有一个建议：

对您将接受的文件制定一些规则（例如 JPEG 和 PNG，小于 2MB，最大 5 兆像素）。将“可接受的”文件存储在方便的位置，可能在文档根目录之外。

**不要在上传时重新调整图像大小**。按需调整图像大小，例如使用[phpThumb **。](http://phpthumb.sourceforge.net/)

从长远来看，这种方法将证明比在上传时重新调整图像大小更好：在以下情况下，您将永远不需要处理所有（可能数百张）图像：

*   您的网站布局发生变化
*   您的项目需求发生变化
    *   你添加了一个灯箱风格的幻灯片，突然你需要它的缩略图
*   您需要为不同的设备提供不同的分辨率
*   您需要处理图像（例如在图像上写下您的公司名称）
    *   您的公司名称更改
*   您被告知*所有*缩略图都需要更改为方形

** 使用 phpThumb 时，我建议花一些时间来完成它的配置。尤其是安全和缓存相关的设置。创建输出图像分辨率的白名单也是一个好主意。

# javascript - Firefox 第二次自行拖动 div

> ID：14186574
> 
> 赞同：-2
> 
> 时间：2013-01-06T20:48:10.837
> 
> 标签：javascript, jquery, html, css

我设计了一个滑块，例如带有 jquery 的播放器音量滑块。但问题仅在 FIREFOX 中，第一次当我拖动滑块时这是正常的，但第二次浏览器拖动该 div 就像拖动图像一样。除非第一次拖动后我点击一个空白区域并再次拖动滑块。这里有什么问题？对不起，我的英语不好。

**编辑 ：**

[http://codepen.io/anon/pen/bjChB](http://codepen.io/anon/pen/bjChB)

html:

```
<div id="btn_container">

    <div id="button"></div>

</div> 
```

CSS：

```
div#btn_container{
width:200px;
height:60px;
position:absolute;
background:red;
margin:auto;
right:0;left:0;top:0;bottom:0;  
}
div#button{
width:60px;
height:60px;
background:blue;
position:absolute;
left:0px;top:0px;   
} 
```

jQuery：

```
$(document).ready(function() {
    var pressed = false;
    var $this;
    var x;
    $("div#button").mousedown(function(e){
        pressed = true;
        $this = $(this);
        var offset = $this.offset();
        var inside = e.pageX - offset.left;
        $(document).mousemove(function(e){
            if(pressed){
                var parentOffset = $this.parent().offset();
                x = e.pageX - parentOffset.left;
                if( x <= $this.parent().width() - $this.width() + inside && x >= 0 + inside)
                    $this.css({"left":x - inside});
            }
        });
    });
    $(document).mouseup(function(){
        if(pressed){
            if( x > $this.parent().width() - $this.width() - 30)
                $this.animate({"left":$this.parent().width() - $this.width()} , 50);

            pressed = false;
        }
    });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:42:53.780

您可以添加`e.preventDefault();`到您的`mousedown`以防止 Firefox 尝试使用的任何行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:44:50.760

我将此代码添加到 css 中，它可以防止 div 被选中。这解决了问题。

```
-moz-user-select: none;
-khtml-user-select: none;
-webkit-user-select: none;
-ms-user-select: none;
user-select: none; 
```

# php - 无法让mysql_fetch_rows合作

> ID：14186576
> 
> 赞同：3
> 
> 时间：2013-01-06T20:48:16.780
> 
> 标签：php, mysql, sql, html-table

我正在尝试根据用户输入的变量从 mysql 表中检索行。基本上，如果用户想要搜索“bob dilan” $fname 并且 $lname 将搜索并显示发生这种情况的所有行，我与用户的连接很好，因为我的 $mysql_num_fields 工作正常。目前在我的 mysql_fetch_rows while 循环内没有任何工作，甚至没有回声，但没有错误。我什至尝试使用 like 运算符而不是 = 无济于事。

PHP

```
$sql = "SELECT * FROM  ".$tbl_name." 
WHERE fname='".$fname."' 
and lname='".$lname."' 
and city='".$city."'
and phone='".$pohne."'
and interest_inet='".$internet."'
and interest_tv='".$television."'
and interest_voice='".$voice."'
and submission_ip='".$ip."'
and inquiry_handled='".$handled."'";
$result = mysql_query($sql);

echo "<table border='1'>";
echo "<tr>";
$i = 0;

while ($i < mysql_num_fields($result))
{
    $meta = mysql_fetch_field($result, $i);   
    echo "<th>".$meta->name."</th>";
    $i++;
}

while ($row = mysql_fetch_row($result))
{
    echo '<tr>';

foreach($row as $item)
{
    echo "<td>".$item."</td>";
}

echo '</tr>';
echo $row;
}

echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T20:52:00.437

您已经对结果集进行了一次迭代，这会导致指针前进到它的末尾。

在一个循环中完成所有工作，或者将整个结果集提取到一个数组中，然后迭代两次。

除此之外，您[**不应该在新代码中使用`mysql_*`函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:04:19.987

解决此问题的另一种方法是使用[mysql_data_seek](http://www.php.net/mysql-data-seek)

```
while ($i < mysql_num_fields($result))
{
    $meta = mysql_fetch_field($result, $i);   
    echo "<th>".$meta->name."</th>";
    $i++;
}

mysql_data_seek($result);

while ($row = mysql_fetch_row($result)) 
```

# javascript - 使用单选框和价格滑块的 jQuery 产品过滤器

> ID：14186577
> 
> 赞同：1
> 
> 时间：2013-01-06T20:48:28.010
> 
> 标签：javascript, jquery, filter, product

我需要能够根据价格（滑块）和单选框过滤产品。在这里查看其他帖子，我设法获得了基本功能。问题是我的过滤器现在可以与 OR 一起使用，而我需要它来与 AND 一起使用。

例如，我需要能够获得 Brand1、TeamA 和价格范围从 0 到 20 的产品。这应该只有一个产品，但我得到了 7 个产品。

在实际应用中，我有 6 个不同的属性。不确定这是否重要，但以防万一。

```
var $filters = $("input:radio[name='brand'],input:radio[name=team]").prop('checked', false); // start all unchecked

var $categoryContent = $('#CategoryContent li');
$filters.click(function() {
$categoryContent.hide();
$filters.filter(':checked').each(function(i, el) {
    $categoryContent.filter(':contains(' + el.value + ')').show();
});
}); 
```

这是我的工作示例：http: [//jsfiddle.net/unGmL/](http://jsfiddle.net/unGmL/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:52:31.107

问题是过滤功能需要考虑选择的品牌和团队，而不仅仅是价格。您仅在滑块事件上按价格过滤，并且您仅在点击事件上按类别过滤。你需要在*每个*事件上都做*这两件事。*

 *我更新了你的小提琴来做这两件事：http: [//jsfiddle.net/unGmL/16/](http://jsfiddle.net/unGmL/16/)

这是更新后的 showProducts：

```
function showProducts(minPrice, maxPrice) {
    $("#products li").hide().filter(function() {
      var $product = $(this),
          details = $product.html();
      // If min and max prices are specified, filter products by price
      if (min != null && max != null) {
        var price = parseInt($product.data("price"), 10);
        if (price < minPrice || price > maxPrice) {
          return false;
        }
      }
      var inputs = $("input:radio[name='brand']:checked,input:radio[name=team]:checked");
      // If team or brand are specified, filter products by
      // team/brand
      if (inputs.prop('checked')) {
        var found = true;
        inputs.each(function(index, cat) {
          var $input = $(this),
              cat = $input.val();
          // Both brand and team must match.
          // If brand and team are selected and one of them
          // is not matched, then product is filtered
          found = (details.indexOf(cat) >= 0) && found;
        });
        return found;
      }
      return true;
    }).show();
} 
```

`showProducts`现在查看选中的单选框。如果没有选中任何单选框，则不会应用品牌和团队过滤。如果需要品牌或团队，则检查每个产品以包含所选团队（如果选中）和所选品牌（如果选中）。

变量`min`和`max`降级为全局闭包，以便可以在任何事件回调中过滤价格。*

# csv - google docs 电子表格导出：如何从时间、日期中删除撇号

> ID：14186580
> 
> 赞同：0
> 
> 时间：2013-01-06T20:48:36.980
> 
> 标签：csv, documentation, openoffice.org, openoffice-calc

我正在将 Google Docs 中的电子表格导出为 CSV，并且每个日期和时间值前面都有撇号 (')。这真的很烦人，因为 OpenOffice 似乎无法在电子表格编辑器中找到/替换这些。

我可以通过将 CSV 文件作为文本打开并以这种方式替换字符来解决问题，但似乎必须首先找到一种方法来防止该问题。有人知道解决这个问题的方法吗？（在 OO 文件导入期间删除它们也是一个可接受的解决方案。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-31T17:49:34.867

撇号实际上并不是单元格内容的一部分，它只是表示单元格被格式化为文本。要将所有数据重新输入为数字：

1.  突出显示所有单元格并使用 Format -> Cells 将单元格格式更改为适当的数字格式。

2.  在所有单元格仍处于选中状态的情况下，转到菜单 Edit -> Find & Replace

3.  在搜索框中输入 .*（句点星号）

4.  在替换为框中输入 &

5.  选择更多选项并检查仅当前选择和正则表达式

6.  点击全部替换

.* “表示零个或多个任何字符”， & 表示“找到的任何内容”。这些是帮助部分中解释的正则表达式

[资源](https://forum.openoffice.org/en/forum/viewtopic.php?f=9&t=49046)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:11:22.657

事实证明，CSV 文件本身在数据中没有撇号，但它们是在导入期间由 OpenOffice Calc 添加的。检查标记为“检测特殊数字”的选择会阻止此修改，但随后会将值转换为可以在电子表格视图中处理的特定格式。仍然不是一个理想的解决方案，但显然问题集中在 OpenOffice Calc 而不是 Google Docs 上。

# c++ - 无法分配常量大小为 0 的数组

> ID：14186585
> 
> 赞同：0
> 
> 时间：2013-01-06T20:49:04.897
> 
> 标签：c++, arrays, visual-studio-2010

```
 int len = GetWindowTextLengthW(hwndEdit) + 1;
 wchar_t text[len]; 
```

我明白了

错误 2 错误 C2466：无法分配常量大小的数组 0
错误 3 错误 C2133：“文本”：未知大小
错误 1 ​​错误 C2057：预期的常量表达式

我不明白为什么它不会编译，因为 GetWindowTextLengthW(hwndEdit) + 1 > 0

null+1 = 1 不是真的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T20:54:24.800

你想要的是不必关心内存管理，对吧？这就是您选择静态分配数组的原因。

是的，您可以使用`new`这里推荐的答案，但我建议：

`std::vector< wchar_t > text;`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T20:52:05.187

首先，您使用的是声明静态大小数组的语法，但您传入了一个在运行时评估的大小变量。这就是它不编译的原因。

其次，您不能静态分配大小为 0 的数组，但这是另一个问题（尽管`std::array`允许您这样做）。

我认为您应该改用动态分配：

```
wchar_t* text = new wchar_t[len] 
```

甚至更好，使用`std::wstring`或`std::vector<wchar_t >`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T20:52:33.020

尝试：

```
wchar_t* text = new wchar_t[len]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T21:00:50.550

确实，抱怨零而不是非常量值的错误消息令人困惑（就像某些编译器抱怨未定义类型的 int 一样）。VLA 是 C99 功能，仅在某些 C++ 编译器中作为扩展存在（并且正在以不同的名称部分添加到 C++14 中）。MSVC 下最接近的等价物（在堆栈上分配，不调用释放函数）是 _alloca。

# javascript - 拆分包含布尔值的字符串

> ID：14186591
> 
> 赞同：-1
> 
> 时间：2013-01-06T20:49:31.020
> 
> 标签：javascript, jquery

这是我的javascript函数

```
function cmd_parse( cmd )
{
   return cmd.split( /\s+/ );
} 
```

如果我做一个函数调用

```
words = cmd_parse("hello jay true"); 
```

它给了我

```
words[0]="hello"  words[1]="jay"  words[2]="true" 
```

第三个是布尔值，但在调用函数后它变成了字符串值。有没有办法保留布尔状态并仍然进行拆分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T20:52:10.867

你误认为第三个是布尔值......它只是字符串中的“真”这个词。如果你想从中得到一个实际的布尔值，你将不得不沿着以下行做一个简单的表达式

```
var b = (words[2] === 'true') ? true : false; 
```

# php - 无法下载文件。垃圾代码显示

> ID：14186595
> 
> 赞同：2
> 
> 时间：2013-01-06T20:50:04.433
> 
> 标签：php, drupal, drupal-6, http-headers, download

我有 Drupal 网站，我的用户无法再下载文件。（docx、xlsx 等）。***仅***在 firefox中，当用户单击链接下载文件时，页面会显示垃圾代码。

我在别处读到的解决方案是添加以下内容，但它没有用。相反，每次重新加载页面时，都会提示用户针对应用程序类型进行虚拟下载。

drupal_set_header('Content-type: application/octet-stream; charset=utf-8');

我有一个简单的模块，它有一个页面可以吐出文件的链接。在这个模块中，我将上述内容添加到 hook_init() 函数中。

![垃圾代码截图](../Images/7c35a6c06d7f914c3d2111ff3ea0a2e8.png)

我以前从未遇到过这个问题，我不确定它为什么会开始。任何帮助当然将不胜感激。如果我在有人回复答案之前找到了解决方案，我会在此处发布以供将来参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:41:13.910

为您的 MIME 试一试：

```
drupal_set_header('Content-type: application/force-download'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T05:26:28.670

发生这种情况是因为 MIME 类型设置不正确。您可以强制 Drupal 将其设置`content-type header`为适当的 MIME 类型，或者在服务器端进行设置。

我建议您在文件夹中的 .htaccess 文件中执行此操作（默认为站点/默认/文件）

只需将下面的代码放入 .htaccess 文件中（或者如果它不存在，您可以创建一个新的 .htaccess 文件）。

```
AddType  application/octet-stream  .doc .xls .pdf 
```

请注意，hook_init() 会在每个正常页面请求时触发。**永远**不要在这个钩子中这样做，否则你最终会面临很多问题。

# php - 上传文本文件以解析多个模型数据

> ID：14186599
> 
> 赞同：0
> 
> 时间：2013-01-06T20:50:53.020
> 
> 标签：php, cakephp, file-upload

假设我有一张桌子`objects`：

```
CREATE TABLE objects (
    id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(50),
    someinfo VARCHAR(255),
); 
```

还有一个像这样的文本文件：

```
name,someinfo
"firstname","firstinfo"
"secondname","secondinfo"
... 
```

如何在 CakePHP 中上传这个文本文件来处理数据和创建对象？处理不是问题，我已经解决了。但是，我不确定如何上传文件。

注意：文件最大为 300MB。

***编辑***
我尝试`LOAD DATA INFILE`按照 dogmatic69 的建议使用，使用以下代码：

```
$filefullname = $this->request->data['File']['file']['tmp_name'];
debug($filefullname);
$query = 'LOAD DATA LOW_PRIORITY INFILE "'.$filefullname.'" INTO TABLE agencies FIELDS TERMINATED BY "," OPTIONALLY ENCLOSED BY """" LINES TERMINATED BY "\r" IGNORE 1 LINES';
$this->Agency->query($query); 
```

但是，我得到以下输出：

```
'C:\Windows\Temp\phpB413.tmp'
Error: SQLSTATE[HY000]: General error: 29 File 'C:\ProgramData\MySQL\MySQL Server 5.5\data\WindowsTempphpB413.tmp' not found (Errcode: 2)
SQL Query: LOAD DATA LOW_PRIORITY INFILE "C:\Windows\Temp\phpB413.tmp" INTO TABLE agencies FIELDS TERMINATED BY "," OPTIONALLY ENCLOSED BY """" LINES TERMINATED BY "\r" IGNORE 1 LINES 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:10:46.260

@Mark 的回答只涵盖了您需要的一小部分，所以这里有更多：

顺便说一句，[专家上传插件](https://github.com/josegonzalez/upload)可能比链接的更受欢迎。由星星和分叉组成，它的流行度大约是 uploadpack的*两倍。*

您需要将 csv 数据解析为有利于保存的蛋糕格式。[这里](https://github.com/infinitas/infinitas/tree/dev/Core/Data/Lib/Csv)有一些课程可以做到这一点。查看使用[测试](https://github.com/infinitas/infinitas/tree/dev/Core/Data/Test/Case/Lib/Csv)

对于您想要避免的大量数据，`saveAll()`因为它会为每一行创建一个插入。使用[它](https://github.com/infinitas/infinitas/blob/dev/Core/Data/Model/Behavior/BigDataBehavior.php)来获取一些关于批量插入的想法。

老实说，如果您要导入 300MB CSV 文件，您应该使用`LOAD DATA INFILE`速度更快的 MySQL。[http://dev.mysql.com/doc/refman/5.1/en/load-data.html](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:38:17.580

你最好使用 3rd 方库，最流行的是：uploadpack：[https ://github.com/szajbus/uploadpack](https://github.com/szajbus/uploadpack)

# javascript - 向 Twitter Bootstrap 子菜单添加间距

> ID：14186602
> 
> 赞同：0
> 
> 时间：2013-01-06T20:51:20.913
> 
> 标签：javascript, css, drop-down-menu, twitter-bootstrap, responsive-design

我正在尝试在 Twitter Bootstrap 子菜单的左侧添加一些间距，以便在 2 级和 3 级菜单之间有一点间距。因此，我使用了以下添加的 CSS：

```
.dropdown-submenu > .dropdown-menu {
    margin: -1px 0 0 5px;
} 
```

但是，当用户将鼠标移到间隙上时，子菜单就会消失（慢慢来）。如何在鼠标悬停时添加空间并保持菜单显示？

这是一个小提琴：

[http://jsfiddle.net/trxk8/5/](http://jsfiddle.net/trxk8/5/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:49:21.307

这并不是最漂亮的解决方案，但您可以`.dropdown-submenu`使用透明的 5px 边框填充元素。

这样做的副作用是您还必须稍微修剪子锚标记：

**CSS**

```
.dropdown-submenu  {
    border-right: transparent block 5px;
    margin-right: -5px;
}

.dropdown-submenu > a {
    position: relative;
    right: 5px;
    margin-left: 5px;
} 
```

**工作示例：http: [//jsfiddle.net/trxk8/8/](http://jsfiddle.net/trxk8/8/)**

`margin-top: -1px`请注意，您仍将保留`.dropdown-submenu > .dropdown-menu`

# jquery - 在mvc中触发隐藏文件上传控制后如何回发我的操作

> ID：14186603
> 
> 赞同：0
> 
> 时间：2013-01-06T20:51:23.510
> 
> 标签：jquery, file-upload

我需要在单击按钮时调用文件上传控件。文件上传控件对用户不可见。

在按钮的点击事件中，我触发了文件上传的点击事件。所以现在文件上传显示，我可以选择一个文件。问题是在我选择一个文件并单击打开后，我想回发我的操作。有人可以指导我如何完成吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:57:04.860

## 想法：

选择表格：`$('form#the_form_id');`然后提交：`$('form#the_form_id').submit();`。

## 事件处理：

为了仅在用户选择所需文件后执行上述代码，您只需将其（代码）绑定为用户选择文件后发生的事件的回调。

```
$('input[type=file]#the_fileinput_id').bind('change', function() {
    $('form#the_form_id').submit();
}); 
```

## 演示：

jsfiddle 中的演示：http: [//jsfiddle.net/NbGBj/](http://jsfiddle.net/NbGBj/)由这篇文章提供其他 SO 答案：[How to handle onchange event on input type=file in jQuery?](https://stackoverflow.com/questions/11860721/how-to-handle-onchange-event-on-input-type-file-in-jquery)

## X 浏览器兼容性：

IE 中不存在 AFAIK onChange 事件（对于任何输入类型 - 不限于文件输入）。jQuery 开发人员必须为它创建一个解决方法，它是从 jQuery 1.5.1 开始添加的。所以你的 jQuery 版本必须至少是这样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T20:57:40.347

当文件输入更改时，您希望提交表单，因此：

对于这个 html：

```
<form action="...">
   <input class="file" type="file" />
</form> 
```

将完成这项工作的 javasctript：

```
$('input.file').change(function(){
  $('form').submit();
}); 
```

# c# - c# .net 4.5 async await Task.Wait() 阻塞问题

> ID：14186608
> 
> 赞同：3
> 
> 时间：2013-01-06T20:51:38.603
> 
> 标签：c#, .net, deadlock, .net-4.5, async-await

我有以下扩展方法：

```
internal static string ReadLine(this DataReader stream)
{
   Task<string> line = ReadLineAsync(stream);
   // line.Wait(); - Not Required, as next call blocks
   return line.Result;
} 
```

它基本上是一个同步方法调用包装器，用于返回一个字符串的异步方法调用。如果我逐行执行该代码，则代码可以正常工作，但是如果我让它自由执行，似乎会遇到一个不确定的块。有任何想法吗？

与我发布的上一个问题相关：[如何更新我的 API 以使用 async 关键字而不为所有调用者使用 await](https://stackoverflow.com/questions/14186009/how-can-i-update-my-api-to-use-the-async-keyword-without-using-await-for-all-cal)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-07T02:30:09.707

正如一些人对您其他问题的答案所评论的那样，如果您`Task.Result`在 GUI 应用程序中使用，您可能会[导致死锁](https://blog.stephencleary.com/2012/07/dont-block-on-async-code.html)（正如我在我的博客中详细解释的那样）。

简而言之：

*   您在 UI 线程上启动异步操作。请注意，任务`line`代表`ReadLineAsync`方法，并且将在该方法完成时完成。
*   `ReadLineAsync`调用`await`一些不完整的操作。这会导致`ReadLineAsync`返回不完整的任务 ( `line`)。
*   您阻塞了等待`line`完成的 UI 线程。
*   当`await`ed 操作完成时，它将剩余的调度`ReadLineAsync`到 UI 线程。
*   UI 线程无法完成`ReadLineAsync`，因为它被同步阻塞等待`ReadLineAsync`完成。僵局。

有关解决此僵局的方法，请参阅[我对您的其他问题的回答。](https://stackoverflow.com/questions/14186009/how-can-i-update-my-api-to-use-the-async-keyword-without-using-await-for-all-cal/14189020#14189020)简而言之：

*   `ConfigureAwait(false)`到处使用。
*   更改您的错误处理以`Result`将其错误包含在`AggregateException`.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-27T06:07:04.097

根据： http: [//msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx](http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx) 你不应该这样做：

```
internal static string ReadLine(this DataReader stream)
{
   string line = await ReadLineAsync(stream);
   return line
} 
```

也就是说，我还没有开始做这个异步业务。但是我已经阅读了文档等。

# build - 在 Windows 上构建 MonoTouch .NET 库

> ID：14186609
> 
> 赞同：0
> 
> 时间：2013-01-06T20:51:39.453
> 
> 标签：build, mono, xamarin.ios

我有一个项目，我想在 Windows 上开发（并构建/发布到内部 nuget）。作为我的构建过程的一部分，我的程序集有多个版本（NET40、NET20 等）。

**我有一个新项目希望在 Mono 和 MonoTouch 上使用我的库。是否可以在 Windows 上构建可在 MonoTouch/MAC 上运行的库？**请注意，我不希望针对任何 MonoTouch.dll 或 Apple/iOS 特定库进行编程。我的程序集严格来说是 .NET 库。

将我的目标框架更改为 .NET 4.0“客户端配置文件”是否足以在 Mono 平台（包括 MonoTouch/iOS）上获得支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:32:43.610

您可以使用可移植类库来做到这一点。[有一篇很棒的文章介绍了如何进行此设置](http://slodge.blogspot.co.uk/2012/12/cross-platform-winrt-monodroid.html)。

由于@slodge 在 Twitter 上的精彩文章，设置起来非常容易。

# android - ImageView 未显示 youtube 缩略图

> ID：14186610
> 
> 赞同：0
> 
> 时间：2013-01-06T20:51:49.063
> 
> 标签：android, listview, imageview, baseadapter

我是 Android 新手，我正在开发一个应用程序，我在其中使用

```
....
YouTubeService service = new YouTubeService('blah','blah')
....
VideoFeed videoFeed = service.query(query, VideoFeed.class);
List<VideoEntry> videos = videoFeed.getEntries();

YouTubeMediaGroup mediaGroup = videoEntry.getMediaGroup();

String webPlayerUrl = mediaGroup.getPlayer().getUrl();

......                  

ytv.setWebPlayerUrl(webPlayerUrl);

.....

List<String> thumbnails = new LinkedList<String>();
for (MediaThumbnail mediaThumbnail : mediaGroup.getThumbnails()) {

thumbnails.add(mediaThumbnail.getUrl());

}

.... 
```

在适配器中，我使用了这个

```
mWebView.loadUrl(torvideo.getWebPlayerUrl()); 
```

但是我在 webview 中获得了一个全屏的 youtube 图像和一个可滚动的类似视频列表。

然而，我想要的是一个看起来类似于 youtube 搜索结果的缩略图（小图像、视频标题和更多细节。

您能否建议我，哪个视图或示例代码，以便我可以使用从 mediagroup 对象获得的缩略图列表显示在我的应用程序中？

编辑/更新：

我用过

```
 public class ResultViewAdapter extends BaseAdapter {

    ........

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

    View row = convertView;

    if (row == null) {
    final LayoutInflater li = (LayoutInflater) myContext
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    row = li.inflate(R.layout.activity_result_list, null);
    }

TORYouTubeVideo torvideo = (TORYouTubeVideo) getItem(position);

TextView textView = (TextView) row.findViewById(R.id.textView1);
textView.setText(torvideo.getVideoTitle());

    InputStream is = (InputStream) new URL(torvideo.getThumbnails().get(0)).getContent();

    Drawable d = Drawable.createFromStream(is, "src name");

    ImageView imageView = (ImageView) row.findViewById(R.id.imageView1);

    imageView.setImageDrawable(d);

return row;

} 
```

但我仍然无法在列表视图中看到图像，并且只看到一个空的可滚动列表

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T06:40:53.223

再次回答我的问题！！

移动了这部分

```
InputStream is = (InputStream) new URL(torvideo.getThumbnails().get(0)).getContent();

Drawable d = Drawable.createFromStream(is, "src name"); 
```

对于我的 youtube 查询正在发生的同一个异步任务，我现在可以看到图像了！（这是 mainThread 的问题）

看起来Android还有很长的路要走！:P

谢谢

# joomla - joomla (2.5) 系统插件安装期间加载语言文件

> ID：14186611
> 
> 赞同：3
> 
> 时间：2013-01-06T20:51:50.360
> 
> 标签：joomla, joomla2.5, joomla-extensions

在安装系统插件（在 Joomla 2.5 中）期间，我很难显示本地化字符串。在 xml 文件中使用本地化字符串的“正常”方式似乎不起作用，（请参阅另一个问题：[基于语言的安装说明](https://stackoverflow.com/questions/11601867/language-based-installation-description)）。

我现在尝试了那里提出的方式，通过安装脚本显示描述。这种工作（我可以成功回显文本），但是，我也无法在那里本地化 - 调试语言时它显示 plugin.sys.ini 尚未加载；我尝试手动加载文件，但加载我的任何插件语言文件都没有成功。这是我到目前为止得到的（在一个名为 setupscripts.php 的文件中）：

```
<?php // no direct access
defined('_JEXEC') or die('Restricted access');

class plgsystemmyplgnameInstallerScript {

    static function loadLanguage() {
        $lang =& JFactory::getLanguage();
        $lang->load('plg_system_myname', JPATH_ADMINISTRATOR);
    }

    function install($parent)
    {
        self::loadLanguage();
        echo JTEXT::_("PLG_MYNAME_TEST_TEXT");
    }
    function uninstall($parent)
    {
        self::loadLanguage();
        echo JText::_('PLG_MYNAME_UNINSTALL_TEXT');
    }
    function update($parent)
    {
        self::loadLanguage();
        echo JText::_('PLG_MYNAME_UPDATE_TEXT');
    }
    function preflight($type, $parent) {}
    function postflight($type, $parent) {
        self::loadLanguage();
        echo JText::_('PLG_MYNAME_INSTALL_TEXT');
    }
} 
```

但我只得到 ??PLG_MYNAME_TEST_TEXT?? ??PLG_MYNAME_INSTALL_TEXT?? （语言调试已打开）在安装过程中......奇怪的是，页面底部“未翻译的字符串”下的语言调试功能显示“无”（如果不是来自尝试但失败的问号则来自哪里翻译？？？）。

尝试了它的一些变体（在插件名称末尾使用 .sys，因为我实际上认为设置字符串应该在 .sys.ini 文件中，没有第二个参数（保持默认），但没有运气 - 没有错误，日志中什么都没有（实际上我的日志文件不存在，可能还没有条目？可以用Joomla设置日志级别吗？）。但是从来没有加载任何文件（“加载的语言文件”下没有任何变化） .

有人知道如何正确加载语言吗？

在安装过程中加载语言时有什么特别需要考虑的吗？如果加载语言失败，为什么没有错误消息？我是否可能必须将语言文件安装到特殊位置才能在安装过​​程中识别它们？我当前的 xml 如下所示：

```
<extension version="2.5" type="plugin" group="system" method="upgrade">
<name>PLG_MYNAME</name>
<!-- ... author, copyright, version, .. --> 
<scriptfile>setupscripts.php</scriptfile>
<files>
    <filename plugin="myname">myname.php</filename>
    <filename>setupscripts.php</filename>
    <filename>index.html</filename>
    <folder>sql</folder>
</files>
<!-- ... install->sql->file ... -->
<!-- ... uninstall->sql->file ... -->
<!-- ... update->schemas->schemapath ... -->
<languages [folder="admin"]>
   <language tag="en-GB">en-GB.plg_system_myname.ini</language>
   <language tag="en-GB">en-GB.plg_system_myname.sys.ini</language>
   <!-- ... other languages ... -->
</languages>
<!-- ... config->fields->fieldset->field ... -->
</extension> 
```

（folder="admin" 周围的方括号应该表示我尝试了使用和不使用此属性。它不会改变任何东西）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:03:11.627

如果您还将文件复制到管理语言文件夹，它仅适用于安装。如果您查看核心扩展，您会发现它们两者兼而有之。这确实是一个错误，但这就是解决方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T20:33:27.670

最后我发现了如何真正做到这一点。在 google Joomla 开发组中进行的彻底搜索提出了[这个非常相似的问题](https://groups.google.com/d/topic/joomla-dev-general/yoPbJEdRaIg/discussion)。

基本上，语言文件似乎需要驻留在一个单独的语言文件夹中，并且文件部分也需要引用它们。我的 xml 现在看起来像这样：

```
<!-- ... everything else stayed the same, except: -->
<files>
    <filename plugin="myplg">myplg.php</filename>
    <filename>index.html</filename>
    <folder>language</folder>
    <folder>sql</folder>
</files>
<languages folder="language">
        <language tag="en-GB">en-GB/en-GB.plg_system_myplg.ini</language>
        <language tag="en-GB">en-GB/en-GB.plg_system_myplg.sys.ini</language>
        <!-- .. other languages ... ->
</languages>
<!-- ... rest of the xml file ... --> 
```

语言文件现在都在单独的子文件夹中...它们被复制到与以前完全相同的位置（管理员/语言//...），但现在 XML 中的描述也已本地化！

我觉得很奇怪有这么多指定语言文件的方法，除了安装的一个角落情况外，这些方法基本上都可以工作......

希望这将帮助其他人在这方面苦苦挣扎！

# php - PDO 行计数错误

> ID：14186613
> 
> 赞同：0
> 
> 时间：2013-01-06T20:51:54.407
> 
> 标签：php, pdo

我是第一次使用 PDO。我创建了这个方法，我收到了这个错误：

```
 Call to a member function rowCount() on a non-object 
```

以下是我的代码。

```
 $db = new PDO("mysql:host=$dbhost;dbname=$dbname;charset=utf8", $dbuser, $dbpassword)   

     function doesRecordExist($query) {
            global $db;
            try {
                $stmt = $db->query($query);
                $count = $stmt->rowCount();
                return $count;
            } catch (PDOException $ex) {
                die($ex->getMessage());
            }
        } 
```

你能帮我吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:10:23.450

为什么不使用准备好的语句：另外，您需要在计算之前执行查询

```
$db = new PDO("mysql:host=$dbhost;dbname=$dbname;charset=utf8", $dbuser, $dbpassword)   

 function doesRecordExist($query) {
        global $db;
        try {
            $stmt = $db->prepare($query);
            $stmt->execute();
            $count = $stmt->rowCount();
            return $count;
        } catch (PDOException $ex) {
            die($ex->getMessage());
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:28:30.363

不要使用全局变量。将此作为对象传递。

```
$db = new PDO(....);

 function doesRecordExist($query, PDO $db) {
        try {
            $stmt = $db->prepare($query);
            $stmt->execute();
 ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:02:57.650

我忘记创建查询所指的表。给您带来的不便深表歉意

# css - 在速记宏中包装 SASS 的 @include

> ID：14186631
> 
> 赞同：1
> 
> 时间：2013-01-06T20:54:14.910
> 
> 标签：css, sass

为了方便起见，我希望能够`@include`用简写形式包装 SASS。`@i`

这可能吗？这样做的最佳方法是什么？

```
#foo {
  @include rounded(3px);
} 
```

变成：

```
#foo {
  @i rounded(3px);
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T21:05:57.367

使用 Sass 语法，您可以使用`+`：

```
#foo
  +rounded(3px) 
```

# java - 如何简化笨拙的并发代码？

> ID：14186636
> 
> 赞同：0
> 
> 时间：2013-01-06T20:54:36.913
> 
> 标签：java, android, multithreading, concurrency, locking

基本上这段代码执行http请求，如果http请求超时，它会重置wifi连接（有时必须这样做，就是这样，我也可以是其他非android相关的东西，而不是“reset wifi联系”）。

必须考虑以下特殊情况：

*   如果当前有 1 个或多个线程正在执行 http 请求，则不允许其他线程重置 wifi 连接
*   如果 1 个线程当前已经在重置 wifi 连接，而另一个线程即将重置 wifi 连接，则直接发送后一个线程重试 http 请求（当前一个线程完成 wifi 重置时）
*   当前正在重置 wifi 连接时不执行 http 请求
*   => 一次只有 1 个线程可以修复 wifi 连接，但多个线程可以同时发起 http 请求

这让我很头疼。

到目前为止，这是我的代码。我可以改进什么？

```
static int requestsActive = 0;
protected int requestTry = 0;
static final int maxTrys = 2;
static final ReentrantLock wifiLock = new ReentrantLock();

public void evaluate() throws Exception {
try {
    requestTry++;
    while (wifiLock.isLocked()) // no not start new http request while wifi is being fixed
        Thread.sleep(400);
    requestsActive++; //increment so that another thread that wants to fix wifi knows it has to wait
    response = httpClient.execute(requestBase);
    requestsActive--; // when == 0 wifi can be fixed if it needs to
} catch (ConnectTimeoutException e) {
    requestsActive--; //same as above (for exception case)
    if (requestTry == maxTrys)
        throw new ConnectTimeoutException("maxTrys reached");
    if (!wifiLock.tryLock()) //another thread is currently fixing wifi, no need to do it myself
        evaluate(); // ...so start a new http request
    while (requestsActive > 0) // wait until no more threads are in the http request section above
        Thread.sleep(400);
    WifiManager wifiMan = (WifiManager) App.getContext().getSystemService(Context.WIFI_SERVICE);
    resetWifi(wifiMan); //reset android wifi, nothing special
    wifiLock.unlock();
    evaluate();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:25:29.323

不幸的是，我不能保证这会奏效，因为我没有安装 Android 模拟器并且很快就把它放在一起。希望它至少作为一个可以构建的概念对您有所帮助。基本上，它使用信号量来允许一次尝试有限数量的请求，并且当连接超时时，它将获取信号量的所有许可，这将阻止在 wifi 重置时发出任何新请求。这利用了 Java 代码库中已经存在的并发代码，因此您不必自己重新实现任何代码。

[您可以在此处](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/concurrent/Semaphore.html "这里")查看信号量的 JavaDoc 。

```
static final int MAX_CONCURRENT_REQUESTS = 10;
static final Semaphore httpRequestsLock = new Semaphore(MAX_CONCURRENT_REQUESTS, true);

public void evaluate() throws Exception {
    Foo requestBase = null;
    HttpClient httpClient = new HttpClient();

    httpRequestsLock.acquire();
    try{
        response = httpClient.execute(requestBase);
    }
    catch (ConnectTimeoutException e) {
        httpRequestsLock.release();
        httpRequestsLock.acquire(MAX_CONCURRENT_REQUESTS); // Blocks until all current requests are done
        WifiManager wifiMan = (WifiManager) App.getContext().getSystemService(Context.WIFI_SERVICE);
        resetWifi(wifiMan); //reset android wifi, nothing special
        httpRequestsLock.release(MAX_CONCURRENT_REQUESTS);
        evaluate();
    }
} 
```

# vb.net - 带闭包的递归回调安全吗？

> ID：14186638
> 
> 赞同：0
> 
> 时间：2013-01-06T20:54:48.360
> 
> 标签：vb.net, closures

我想知道我是否做这样的事情：

```
 Private CurrentASyncSerialNumber As Integer  ' Break the callback chain if it isn't totally dean
    Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
          If tmrNoSerialActivity.ElapsedTime > 2 Then
             CurrentASyncSerialNumber += 1
             RunASyncComms(0, CurrentASyncSerialNumber)
          End If
       End Sub

Private Sub RunASyncComms(State As Integer, SerialNumber As Integer)
   if SerialNumber<>CurrentASyncSerialNumber then return
   tmrNoSerialActivity.ResetTimer 
   select case State 
       case 0    

         ' Some aync code involving RS232
          RS232_AddCommand(Sub() RunASyncComms(1000, SerialNumber))
      case 1000:
         ' Some aync code involving RS232
          RS232_AddCommand(Sub() RunASyncComms(2000, SerialNumber))
      case 2000:
         ' Some aync code involving RS232,
          RS232_AddCommand(Sub() RunASyncComms(0, SerialNumber))
          ' And now we start over. 
```

RS232_AddCommand 函数与 BeginInvoke 类似，不同之处在于它在所有计时器和绘制事件完成之前不会触发下一个命令，并且还确保之前的 RS232 异步代码已完成。

我的问题是这行递归调用它“RS232_AddCommand(Sub() RunASyncComms(1000, SerialNumber))”。这会创建一个累积且永远不会被垃圾收集器收集的闭包链吗？由于它被添加到集合中并延迟运行，我这样做安全吗？或者我会因为最终的堆栈溢出而变得更糟。

我想知道我的代码是否安全。

# java - 通过应用在 Facebook 粉丝页面上发帖

> ID：14186642
> 
> 赞同：8
> 
> 时间：2013-01-06T20:55:41.897
> 
> 标签：java, android, facebook, facebook-graph-api, fan-page

我设法创建了一个在我的 facebook 墙上发布的课程。但是如何更改代码以在我的 facebook 粉丝专页上共享呢？我在谷歌上找不到任何东西或堆栈溢出......

这是在 facebook 上分享的课程：

```
package com.celticwolf.blahblah;  <--- changed

import com.facebook.android.*;
import com.facebook.android.Facebook.DialogListener;

import android.app.Activity;
import android.content.Context;
import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.Window;
import android.widget.Toast;

public class ShareOnFacebook extends Activity{

    private static final String APP_ID = "35255389027859";  <--- changed
    private static final String[] PERMISSIONS = new String[] {"publish_stream"};

    private static final String TOKEN = "access_token";
        private static final String EXPIRES = "expires_in";
        private static final String KEY = "facebook-credentials";

    private Facebook facebook;
    private String messageToPost;

    public boolean saveCredentials(Facebook facebook) {
            Editor editor = getApplicationContext().getSharedPreferences(KEY, Context.MODE_PRIVATE).edit();
            editor.putString(TOKEN, facebook.getAccessToken());
            editor.putLong(EXPIRES, facebook.getAccessExpires());
            return editor.commit();
        }

        public boolean restoreCredentials(Facebook facebook) {
            SharedPreferences sharedPreferences = getApplicationContext().getSharedPreferences(KEY, Context.MODE_PRIVATE);
            facebook.setAccessToken(sharedPreferences.getString(TOKEN, null));
            facebook.setAccessExpires(sharedPreferences.getLong(EXPIRES, 0));
            return facebook.isSessionValid();
        }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        facebook = new Facebook(APP_ID);
        restoreCredentials(facebook);

        requestWindowFeature(Window.FEATURE_NO_TITLE);

        setContentView(R.layout.facebook_dialog);

        String facebookMessage = getIntent().getStringExtra("facebookMessage");
        if (facebookMessage == null){
            facebookMessage = "Test wall post";
        }
        messageToPost = facebookMessage;
    }

    public void doNotShare(View button){
        finish();
    }
    public void share(View button){
        if (! facebook.isSessionValid()) {
            loginAndPostToWall();
        }
        else {
            postToWall(messageToPost);
        }
    }

    public void loginAndPostToWall(){
         facebook.authorize(this, PERMISSIONS, Facebook.FORCE_DIALOG_AUTH, new LoginDialogListener());
    }

    public void postToWall(String message){ 
        new MyAsyncTask().execute(message);
    } 

class MyAsyncTask extends AsyncTask<String,Void,Boolean>
{
public Boolean doInBackground(String ...message){

    Bundle parameters = new Bundle();
            parameters.putString("message", message[0]);
            parameters.putString("description", "topic share");
            try {
                facebook.request("me");   
        String response = facebook.request("me/feed", parameters, "POST");  <---  I think here is the crucial part
        Log.d("Tests", "got response: " + response);
        if (response == null || response.equals("") ||
                response.equals("false")) {
            return Boolean.FALSE;
        }
        else {
             return Boolean.TRUE;
        }
    } catch (Exception e) {

        e.printStackTrace();
        return Boolean.FALSE;
    }
} 

public void onPostExecute(Boolean result){
        if(result == Boolean.TRUE){
 showToast("posted successfully");
}else{
 showToast("couldn't post to FB.");
}
        finish();
}
}

    class LoginDialogListener implements DialogListener {
        public void onComplete(Bundle values) {
            saveCredentials(facebook);
            if (messageToPost != null){
            postToWall(messageToPost);
        }
        }
        public void onFacebookError(FacebookError error) {
            showToast("Authentication with Facebook failed!");
            finish();
        }
        public void onError(DialogError error) {
            showToast("Authentication with Facebook failed!");
            finish();
        }
        public void onCancel() {
            showToast("Authentication with Facebook cancelled!");
            finish();
        }
    }

    private void showToast(String message){
        Toast.makeText(getApplicationContext(), message, Toast.LENGTH_SHORT).show();
    }
} 
```

谢谢你！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-06T21:06:15.510

 ~~```
String response = facebook.request("me/feed", parameters, "POST"); 
```~~  ~~`me/feed`变成`PAGE_ID/feed`：

```
String response = facebook.request("PAGE_ID/feed", parameters, "POST"); 
```

在此处了解如何使用 Graph API：[https ://developers.facebook.com/docs/reference/api/](https://developers.facebook.com/docs/reference/api/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T07:01:56.693

```
String response = facebook.request("PAGE_ID/feed", parameters, "POST"); 
```

这将是可行的，但要在页面中发布，您必须需要具有 Manage_Pages 和 Publish_stream 权限的访问令牌。~~

# html - 当浏览器变小时，阻止左右链接相互渗透

> ID：14186646
> 
> 赞同：2
> 
> 时间：2013-01-06T20:56:10.723
> 
> 标签：html, css

在我的页面左侧，我有一个徽标和一个链接列表，然后在右侧我有一个博客链接。当我将浏览器缩小时，博客链接会渗入左侧的链接。如何让博客链接在某个点停止移动？

[链接到我的问题](http://ernsteverything.com/ojk)

下面是我遇到的问题的代码。

html

```
<div id='logo'>
<img src="MAIN_IMAGES/logo.png" width="255" height="71"></div>

<div id='nav'>   
      <a class="ex4" href="#">FOOTWEAR</a>           
      <a href="projects.html">PROJECTS</a>
      <a href="#dialog2" name="modal">CLIENTS</a>
      <a href="#dialog5" name="modal">ABOUT</a>          
      <a href="#dialog3" name="modal">CONTACT</a>
 </div>
 <div id='blog'> 
    <a href="http://ernsteverything.com/blog">BLOG </a>
</div>
<div id='blogM'> 
     <img src="MAIN_IMAGES/date_2.png" width="60" height="19">
</div> 
```

CSS

```
#logo {top:17px;
       clear:both;
       float:left;
       position:absolute;
       left:45px;}
#nav {position:absolute;
      top:14px; 
      left: 385px;
      min-width:800px;
      white-space:nowrap;
      color:silver;}
#blog {position:absolute;
       top:14px;right:113px;
       list-style:none;
       font-family:"Gill Sans Light";
       font-style:normal;
       font-weight:400;
       text-decoration:none;
#blogM {position:absolute;
        top:13px;
        right:43px;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:51:54.910

所以问题在于您定位元素的方式，您将它们放置为基于像素的坐标网格而不是 html 文档。虽然你可以这样做，但这将是一个巨大的痛苦。你必须记住 html 是由没有像素和网格的恐龙制作的，并且已经进化为适应这种情况但不能替代。

看看[这个](http://www.alistapart.com/articles/css-positioning-101/)教程。您的 div 元素都是从 body 元素的尺寸绝对定位的。从理论上讲，元素将始终以这种方式重叠。但是，如果您将它们相对于彼此定位，则无论浏览器的尺寸如何，它们都应该一起工作。这个概念有点难以理解，所以你必须像恐龙一样思考。嵌套元素的工作方式很像在彼此旁边键入字母，而未嵌套元素就像在它们之间放置回车符的段落，使它们完全独立于它们周围的东西。

我对你的建议是摆脱整个 CSS 结构并重新开始。尝试重塑你的 DOM 类似

```
 <body>
        <div id='logo'>
        </div>
        <div id='nav'>
            <div id='blog'>
                <div id='bloglinks'>
                </div>
            </div>
        </div>
    </body> 
```

这应该将它们排成一行，然后使用“左”等偏移它们以将它们放置在您想要的位置。[这](http://www.barelyfitz.com/screencast/html-training/css/positioning/)也是一个很好的方法来了解它是如何工作的。这一切都已经过时了，你真的必须考虑以某种与模块化思维背道而驰的方式进行设计。

# c# - 将服务器端时钟与返回的数据表进行比较

> ID：14186650
> 
> 赞同：-1
> 
> 时间：2013-01-06T20:56:41.730
> 
> 标签：c#, asp.net, .net

我有一个条件语句，需要在服务器端为我的数据表执行。我不太熟悉 C# 以及如何将此外部事件链接到我的 aspx 页面。在我的数据表中，我有一个名为“计划时间”的列，需要将其与服务器端时钟进行比较，并在数据表行下方返回此事件。

顺便说一句，我正在使用军事时间

```
scheduledTime >15mins; return background-color:red; color:white;
scheduledTime >15min<=30mins; return background-color:yellow color:black;
scheduledTime >30mins<=2hours; return background-color:green color:white; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:03:35.287

您可以使用 TimeSpan 来获得 2 次之间的差异：

TimeSpan ts= DateTime.Parse("") - DateTime.Now;
var scheduleTime = ts.Minutes;

现在您可以比较您的 sheduledTime。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:16:54.790

如果您计划将数据表绑定到 gridview 中；您可以确定在 RowDataBound 事件中更改单元格背景。

# java - 如何在 Android 上格式化数字

> ID：14186657
> 
> 赞同：1
> 
> 时间：2013-01-06T20:57:48.687
> 
> 标签：java, android

我正在学习在 Android 上编写移动应用程序。我的第一个应用程序是单位转换器。目前一切正常，但我有一个关于格式化数字的问题。我有这段代码来从按钮获取文本并转换适当的输出：

```
if (bPrevodZ.getText() == "milimeter"){
    if (bPrevodDo.getText()=="kilometer"){
        String PomocnaPremenna = jednotkaZ.getText().toString();
        double cisloNaPrevod = Double.parseDouble(PomocnaPremenna);
        cisloNaPrevod = cisloNaPrevod*0.0000001;
        vysledok.setText(Double.toString(cisloNaPrevod));
    } 
```

最终结果是“cisloNaPrevod”，但我无法显示该数字的良好格式。例如：12345 毫米 = 0,0012345 公里，这很好吗？:)

但如果我转换：563287 mm = 0.05632869999999995 这很糟糕:) 我需要它显示 0.0563287

感谢任何帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T20:59:12.880

使用字符串格式：

```
String.format("%.6f", cisloNaPrevod); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:13:42.993

如果您希望您的号码始终有 6 个有效数字，请使用

```
vysledok.setText(String.format("%.6g", cisloNaPrevod)); 
```

给出结果`0.0563287`。

如果要四舍五入到小数点后 6 个数字，请使用

```
vysledok.setText(String.format("%.6f", cisloNaPrevod)); 
```

给出结果`0.056329`。

以下是一些涵盖数字格式的好资源：

*   [Java 的浮点备忘单](http://floating-point-gui.de/languages/java/)

*   [java.util.Formatter](http://docs.oracle.com/javase/7/docs/api/java/util/Formatter.html#syntax)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:47:18.297

如果这是您经常要做的事情，也许您应该使用`DecimalFormat`.

```
DecimalFormat df = new DecimalFormat("#.#######"); 
```

然后调用：

```
df.format(someDoubleValue); 
```

# php - 是否有代码来获取页面概述，如 facebook 状态

> ID：14186658
> 
> 赞同：0
> 
> 时间：2013-01-06T20:57:48.957
> 
> 标签：php, javascript

这可能在关闭前 30 秒，但我想知道是否有人知道 github 上的 php、javascript 等中的某些代码或其他任何接受 url 并为页面（如 facebook 状态框）返回漂亮概要、图像等的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:54:43.800

[https://github.com/scottmac/opengraph](https://github.com/scottmac/opengraph)是一个很好的 opengraph 爬虫。Opengraph 标签是 facebook（以及 google+ 和 twitter）获得这些精彩概要的方式。您可以使用 OG 刮板来获取具有所需信息的对象并使用它创建格式良好的块。

不过，刮掉 OG 标签并不是万灵药。网络上的许多页面要么是在 FB 定义 OG 之前开发的，要么是由不关心实现它的人开发的。在这种情况下，FB 也有尝试推断有关页面的事情的后备方案，但结果非常不一致。

# c - 字符指针赋值

> ID：14186659
> 
> 赞同：0
> 
> 时间：2013-01-06T20:57:59.643
> 
> 标签：c, pointers

这是程序的代码，它计算某个输入中所有单词的出现次数。取自 K 和 R 一书。除了作者为什么要使用 strdup() 之外，我几乎理解了所有内容。为什么我们不能只分配（在函数 addtree 中）`p->word=w`。在结构 tnode 中，word 显然是一个指向字符的指针，而 addtree 函数的参数是一个字符指针。

```
#include <stdio.h>
#include <ctype.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>

#define MAXWORD 100
#define BUFSIZE 100

struct tnode {                        /* the tree node: */
 char *word;                          /* points to the text */
 int count;                           /* number of occurrences */
 struct tnode *left;                  /* left child */
 struct tnode *right;                 /* right child */
};

struct tnode *addtree(struct tnode *, char *);
struct tnode *talloc(void);
void treeprint(struct tnode *);
void ungetch(int);
int getword(char *, int);
int getch(void);

char buf[BUFSIZE];                    /* buffer for ungetch */
int bufp = 0;                         /* next free position in buf */

int main(void) {                      /* word frequency count */
 struct tnode *root;
 char word[MAXWORD];

 root = NULL;
 while(getword(word, MAXWORD) != EOF)
  if(isalpha(word[0]))
    root = addtree(root, word);

 treeprint(root);
 exit(0);
}

                                      /* getword: get next word or character from input */
int getword(char *word, int lim) {
 int c, getch(void);
 void ungetch(int);
 char *w = word;

 while(isspace(c = getch()))
  ;
 if(c != EOF)
  *w++ = c;
 if(!isalpha(c)) {
  *w = '\0';
  return c;
 }
 for(; --lim > 0; w++)
  if(!isalnum(*w = getch())) {
   ungetch(*w);
   break;
  }
 *w = '\0';
 return word[0];
}

                                       /* addtree: add a node with w, at or below p */
struct tnode *addtree(struct tnode *p, char *w) {
 int cond;

 if(p == NULL) {                       /* a new word has arrived */
  p = talloc();                        /* make a new node */
  p->word = strdup(w);
  p->count = 1;
  p->left = p->right = NULL;
 } else if((cond = strcmp(w, p->word)) == 0)
  p->count++;                          /* repeated word */
 else if(cond < 0)                     /* less than into left subtree */
  p->left = addtree(p->left, w);
 else                                  /* greater than into right subtree */
  p->right = addtree(p->right, w);

 return p;
}

                                       /* talloc: make a tnode */
struct tnode *talloc(void) {
 return(struct tnode *)malloc(sizeof(struct tnode));
}

                                       /* treeprint: in-order print of tree p */
void treeprint(struct tnode *p) {
 if(p != NULL) {
  treeprint(p->left);
  printf("%4d %s\n", p->count, p->word);
  treeprint(p->right);
 }
}

int getch(void) {
 return (bufp > 0) ? buf[--bufp] : getchar();
}

void ungetch(int c) {
 if(bufp >= BUFSIZE)
  printf("ungetch: too many characters\n");
 else
  buf[bufp++] = c;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:03:34.157

因为没有`strdup`您只需分配变量的地址，因此两者都将指向相同的内存（因此相同的数据）。

```
char *ptr2 = ptr1;

+----------+           +---------+
|   PTR1   |---------->|  VALUE  |
+----------+           +---------+
                            ^
+----------+                |
|   PTR2   |----------------+
+----------+ 
```

虽然`strdup`分配了新的内存块并将字符复制到新的内存块中：

```
char *ptr2 = strdup(ptr1);

+----------+           +---------+
|   PTR1   |---------->|  VALUE  |
+----------+           +---------+

+----------+           +---------+    
|   PTR2   |---------->|  VALUE  |
+----------+           +---------+ 
```

你看出区别了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:01:44.583

@DCoder 是对的，这确实是这篇文章的**答案**。

第一次分配单词的行是：

```
char word[MAXWORD]; 
```

该程序一遍又一遍地反复进入这个记忆。如果不为每个节点复制这些数据，它们都会指向这个缓冲区。

# ruby-on-rails - 困惑，验证失败后未呈现新操作

> ID：14186660
> 
> 赞同：0
> 
> 时间：2013-01-06T20:58:08.263
> 
> 标签：ruby-on-rails, ruby

所以我有以下代码：

```
def new 
    @all_areas = Area.all
    @area = Area.new
end 
```

我传入 all_areas 的原因是表单中的下拉框需要它，使用 mongoid 和区域可以递归地嵌入到另一个区域中。

我的表单有以下代码：

```
 <% if @all_areas %>
        <%= f.label :parent_area %>
        <%= f.collection_select(:parent_area, @all_areas, :_id, :name, prompt: "Select a Parent...") %>
    <% end %> 
```

但是，当我提交“无效值，即空白名称”时，“新”页面不会呈现选择框来选择父级。

这里发生了什么？这是一个错误吗？

我的创建操作非常简单，如果验证失败，我只需执行以下操作：

```
else
     render 'new' 
```

为什么@all_areas 没有第二次传递给视图？我实际上已通过将创建操作中的代码更改为以下内容来修复它：

```
else
    @all_areas = Area.all
    render 'new' 
```

但这很令人惊讶，除非我遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:05:37.833

这不是一个错误。行为的原因是`create`动作实际上与动作完全分开`new`，因此您分配的实例变量`new`不会被延续。`render 'new'`只呈现名为“新”的视图，它实际上并不调用`new`动作。

`new`当您`GET`向`/areas/new`. `create`发生在你`POST`的时候`/areas`。因为它们是单独的请求，服务器不记得任何状态 - 事实上，您可以在`create`不调用的情况下调用`new`（例如，如果您从命令行使用 curl）。

基本上，您的方法是正确的，您需要在*两个*操作中设置`@all_areas`实例变量。您可能希望将其提取到单独的私有方法中以避免重复。

# mysql - 无法将 Crystal Reports 的存储过程从 SQL Server 迁移到 MySQL

> ID：14186662
> 
> 赞同：0
> 
> 时间：2013-01-06T20:58:32.770
> 
> 标签：mysql, sql-server, vb.net, crystal-reports-2010

我一直在尝试将 SQL Server 2005 数据库迁移到 MySQL 5.5.29 并且在使用 Crystal Reports 2010 完成的报告时遇到问题。我可以使用设置的数据源位置来迁移表（我必须单独执行每个表并重命名在它迁移之前），但我完成了。

但是，当我收到消息时，我无法更新存储过程：

> *数据库连接器错误：'HY00:[MySQL][ODBC 5.1 Driver][mysqld-5.5.28-lof]SELECT 命令拒绝用户 ... [数据库供应商代码：1142]*

我使用与表相同的 ODBC 源，所以我不知道我必须做什么来更新/迁移存储过程。我尝试创建一个新报告并添加一个存储过程，但得到相同的消息。

有任何想法吗？

谢谢，

维克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:40:22.020

根据错误消息，正在执行报告的用户确实无权访问指定的表。

MySQL 错误报告[Escaped wildcard in DB name prevent user from granting database permissions](http://bugs.mysql.com/bug.php?id=12008)可能会解释为什么当 db name 包含下划线时权限可能不会像您认为的那样应用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T20:09:45.733

这是提供商的限制，他们拒绝更改。因此，我无法在 Crystal Report 中包含存储过程。

# c++ - 光线追踪：由于相机移动导致的球体变形

> ID：14186663
> 
> 赞同：4
> 
> 时间：2013-01-06T20:58:36.900
> 
> 标签：c++, raytracing

我正在从头开始构建光线追踪器。我的问题是：当我更改相机坐标时，球体变为椭圆。我不明白为什么会这样。

以下是一些显示工件的图像：

```
Sphere: 1 1 -1 1.0 (Center, radius)
Camera: 0 0 5 0 0 0 0 1 0 45.0 1.0 (eyepos, lookat, up, foy, aspect) 
```

![进入相机 0 0 5 0 0 0 0 1 0 45.0 1.0](../Images/7a71c7d1fa5947bf73eb7ab72b787ed0.png)

但是当我改变相机坐标时，球体看起来扭曲了，如下所示：

```
Camera: -2 -2 2 0 0 0 0 1 0 45.0 1.0 
```

![在此处输入图像描述](../Images/7a86b5ff7c0fdf42cceae9ef26d24aaf.png)

我不明白出了什么问题。如果有人可以提供帮助，那就太好了！

我将 imagePlane 设置如下：

```
 //Computing u,v,w axes coordinates of Camera as follows:

 {       
        Vector a = Normalize(eye - lookat);  //Camera_eye - Camera_lookAt
        Vector b = up;    //Camera Up Vector 
        m_w = a;
        m_u = b.cross(m_w);
        m_u.normalize();
        m_v = m_w.cross(m_u);
} 
```

之后，我从相机位置（眼睛）计算每个像素的方向，如下所述：

```
//Then Computing direction as follows:

int half_w = m_width * 0.5;
    int half_h = m_height * 0.5;

double half_fy = fovy() * 0.5;
double angle = tan( ( M_PI * half_fy) / (double)180.0 );

for(int k=0; k<pixels.size(); k++){
    double j = pixels[k].x();       //width
    double i = pixels[k].y();       //height

    double XX = aspect() * angle * ( (j - half_w ) / (double)half_w );
    double YY  =           angle * ( (half_h - i ) / (double)half_h );

    Vector dir = (m_u * XX + m_v * YY) - m_w ;

 directions.push_back(dir);
} 
```

之后：

```
 for each dir:

    Ray ray(eye, dir);
    int depth = 0;
    t_color += Trace(g_primitive, ray, depth); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T08:46:22.967

在玩了很多之后，在你们所有人的评论的帮助下，我成功地创建了我的 rayTracer。很抱歉回答晚了，但我想用几句话来关闭这个线程。

所以，上面提到的代码是完全正确的。基于我自己的假设（如上面的评论中提到的），我决定像这样设置我的相机参数。

我上面提到的问题是相机的正常行为（正如上面评论中提到的）。

我现在得到了很好的结果，但是在编写 rayTracer 时几乎没有什么需要检查的：

1.  在计算 FOV 和 ASPECT RATIO 时，请务必注意弧度到度数（反之亦然）的转换。我这样做如下：

> ```
>  double angle = tan((M_PI * 0.5 * fovy) / 180.0);
>      double y = angle;
>      double x = aspect * angle; 
> ```

2）在计算三角形交点时，确保正确实现叉积。

3）在使用不同物体的交叉点时，请确保找到距离相机最小距离的交叉点。

这是我得到的结果： ![在此处输入图像描述](../Images/d147ee055f819ae5607930d2e0a763db.png)

上面是一个非常简单的模型（由 UCBerkeley 提供），我对其进行了光线追踪。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-22T18:54:35.863

这是正确的行为。拿一个带广角镜头的相机，将球体放在视野边缘附近并拍照。然后在照片应用程序中，在球体照片的顶部画一个圆圈，您会看到它不是圆形投影。

将纵横比设置为 1.0 但图像不是正方形的事实会放大这种效果。

需要解决的一些问题：

*   方向向量是(to - from)。你有（从 - 到），所以 a 指向后面。您需要在最后添加 m_w，而不是减去它。此外，此修复程序会将您的 m_u,m_v 旋转 180 度，这将使您将 (j - half_w) 更改为 (half_w - j)。

*   此外，将所有像素和所有方向放在列表中并不像循环 x,y 值那样有效。

# c# - 实体框架映射连接表字段

> ID：14186668
> 
> 赞同：1
> 
> 时间：2013-01-06T20:58:58.040
> 
> 标签：c#, .net, entity-framework

我有一个连接表，其中有一个字段，我需要进入一个实体并使其可更新。我有下面的表格设置，我需要的列是“ ”表`PersonelleID`中的“ `Account`”。现在，可能有多个，所以在这种情况下，有一个小学的概念（想象一下，如果你是一个从一所学校转到另一所学校的学生，你会有相同的帐户但有多个学校）。

知道如何将其带入实体世界吗？生成数据库会忽略连接表上的这个字段（可能是因为它不知道把它放在哪里）。

试图看看最好的路线是什么。

![实体问题](../Images/95332e295dc9f7962352439228191294.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:56:13.760

如果您使用 Code-First 方法，您将为连接表创建一个实体，该实体具有 Account 和 School 的外键以及您的额外属性。

```
public class Account
{
    public int AccountId { get; set; }
    public string UserName { get; set;}
}

public class AccountSchool
{
    [ForeignKey("Account")]
    public int AccountId { get; set; }

    [ForeignKey("School")]
    public string CEEBCodeId { get; set; }

    public string PersonelleID { get; set; }
}

public class School
{
    [Key]
    public string CEEBCodeId { get; set; }
    public string Name { get; set;}
} 
```

这就是我所做的，这是一篇解释如何做的文章： [http ://www.itq.nl/blogs/post/Code-First-Entity-Framework-Additional-properties-on-many -to-many-join-tables.aspx](http://www.itq.nl/blogs/post/Code-First-Entity-Framework-Additional-properties-on-many-to-many-join-tables.aspx)

# java-me - J2ME 哈希表比较

> ID：14186669
> 
> 赞同：1
> 
> 时间：2013-01-06T20:59:01.547
> 
> 标签：java-me, hashtable

当我尝试比较 J2ME 中的两个哈希表时，我正在处理一个小问题。

这是这种情况：

拳头，我有两个哈希表：

*   parkSlot(String SlotId, String Vehicle)
*   车辆（车辆ID，“可用”）；

有可能找到这个吗？

停车位
01“可用”
02 XSD123
03 ASD423
04“可用”
05“可用”

车辆 XSD123“可用”
LAE212“可用” EDO987“可用” ADE934“可用” ASD423“可用”

我需要获取两个哈希表中存在的车牌。我尝试使用 Enumeration 进行两次迭代，将第一个哈希表中的值和第二个哈希表中的键添加到另一个哈希表中，或者在每个哈希表之间进行比较，我不能

有人可以帮我解决这个问题吗？（我可以附上我的测试代码）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T17:13:18.287

最后我得到了这种情况的解决方案：我将第一个 Hashtable 的内容添加到 Vector 中，然后我比较了 Vector 和第二个 hashtable，删除了重复的数据

# ruby-on-rails-3 - 当我去 root uri 时，我的图像可以工作，但是当我去 base.com/controller/action uri 时，它们是损坏的图像

> ID：14186670
> 
> 赞同：0
> 
> 时间：2013-01-06T20:59:03.203
> 
> 标签：ruby-on-rails-3

我有一个简单的应用程序，当我转到指向 page#index 的根 uri 时，它会显示图像。图片以这种方式工作得很好，但是当我转到 /page/index 时，图片被破坏了。这是什么原因造成的？

路线.rb

```
root :to => "page#index"
match ':controller(/:action(/:id))(.:format)' 
```

当我查看源代码并尝试单击 /page/index 中的图像时，我得到：

```
Unknown action

The action 'assets' could not be found for PageController 
```

即使我把

```
match ':controller(/:action(/:id))(.:format)' 
```

前

```
root :to => "page#index" 
```

它仍然不渲染图像。

编辑：因为我收到控制器错误。这是我的 page_controller.rb

```
class PageController < ApplicationController
  def index
    render "index"
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:14:20.523

啊哈。该`<img>`标签应如下所示：

```
<img id="email" src="/assets/email.png" alt="Contact" /> 
```

`src`请注意属性开头的正斜杠。使用斜线，浏览器将始终尝试从以下位置提取图像：

```
http://my.web.site/assets/email.png 
```

但是没有它，你会得到一个*相对*路径，所以浏览器会尝试获取：

```
http://my.web.site/the/current/page/assets/email.png 
```

哪个不存在。除非您当前的页面是根 URL，这就是它在这种情况下工作的原因。

希望有帮助！

# ruby-on-rails - Lightbox2 损坏的图像显示在每个页面 rails 应用程序上

> ID：14186673
> 
> 赞同：1
> 
> 时间：2013-01-06T20:59:17.970
> 
> 标签：ruby-on-rails, asset-pipeline, lightbox2

我整个星期都遇到这个问题，我尝试过的一切都没有奏效，我什至不确定它为什么存在。[（这有点像我发布](https://i.stack.imgur.com/lGlzN.png)的这个问题的后续。

我将 lightbox2 js 和 css 文件添加到我的 rails 3.2.8 项目中。

我目前在控制台中的每个页面上都出现这些错误，在我的本地环境中（即使是我没有在标记中调用 lightbox 的页面）-

```
Failed to load resource: the server responded with a status of 404 (Not Found) http://localhost:3000/assets/images/close.png

Failed to load resource: the server responded with a status of 404 (Not Found) http://localhost:3000/assets/images/laoding.gif 
```

每个页面上都显示损坏的图像指示符。

![在此处输入图像描述](../Images/7ddda80d43b4838e163b3bb51f72fca7.png)

我对 lightbox.js 的路径更改进行了硬编码，以适当地检索上述图像，并且在使用 lightbox 时它们可以正常工作。

```
 LightboxOptions = (function() {

    function LightboxOptions() {
      + this.fileLoadingImage = '/assets/loading.gif';
      + this.fileCloseImage = '/assets/close.png';
      - this.fileLoadingImage = 'images/loading.gif';
      - this.fileCloseImage = 'images/close.png';
      this.resizeDuration = 700;
      this.fadeDuration = 500;
      this.labelImage = "Image";
      this.labelOf = "of";
    } 
```

当我可以清楚地看到在本地环境中工作的图像时，我不明白为什么会出现这些错误。另一个奇怪的事情是灯箱仍然可以工作，而不必在 application.js 和 application.css 中要求它

这是我的任期的输出-

```
Started GET "/assets/images/loading.gif" for 127.0.0.1 at 2013-01-06 12:36:31 -0800
Served asset /images/loading.gif - 404 Not Found (11ms)
ActionController::RoutingError (No route matches [GET] "/assets/images/loading.gif"): 
```

和关闭相同（但给出的屏幕截图它显然出现了）

![在此处输入图像描述](../Images/13908e29d77542cd00681c2af78f94d5.png)

应用程序.js

```
//= require jquery
//= require jquery-ui
//= require jquery_ujs
//= require jquery.ui.datepicker
//= require justgage
//= require raphael.min
//= require jquery.purr
//= require best_in_place
//= require_tree . 
```

（我不需要上面的灯箱吗？）

```
 *= require jquery.ui.datepicker
 *= require_self
 *= require bootstrap
 *= require_tree .
 */ 
```

（我不需要上面的灯箱吗？）

视图中使用的灯箱。

```
 <div class="row does_description_whole">
    <div class="row offset3">
      <div class="span3 does_description_text">
        <h4>Joe Popular</h4>
        <p>Lorem ipsum hipster bacon.</p>
      </div>
      <div class="span3">
        <a href="https://lh6.googleusercontent.com/picture/joe_does.png" rel="lightbox"><img src="https://lh3.googleusercontent.com/pciture/glance_town.png" class="does_pictures"></a>
      </div>
    </div>  
  </div 
```

为适当的路径编辑了 lightbox.js

我不明白为什么 1\. 每个页面都在 GET 请求（错误）图像，即使它们显示得当 2.为什么我不需要 application.js 和 application.css 中的灯箱文件。

感谢您的关注和查看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:23:07.643

如果您要使用资产管道，您应该像这样引用图像：

```
= (link_to image_tag(pic.image_url(:thumb)), pic.image_url, :rel => "group2", :class => "lightbox") if pic.image? 
```

您可以考虑使用`link_to`helper 而不是`a href`. 这`:rel =>`是指定要浏览的图像的来源。

通常，对图像的引用采用以下格式：

```
url('yourpng.png') 
```

关于为什么不应该在清单中包含灯箱：您应该在清单中`.js`和`.css`清单中包含它们。

已解决：归根结底，它就像`rm -rf public/assets`（@Tmacram 与我们分享了正确的解决方案）一样简单。

# javascript - ThreeJS 创建太阳

> ID：14186676
> 
> 赞同：1
> 
> 时间：2013-01-06T20:59:57.987
> 
> 标签：javascript, html, three.js, webgl

我正在尝试在 WebGL 中创建一个太阳系。但是我不知道设置照明。我想在我的太阳上放一盏灯，让它360度投射光。我的行星应该投射和接收阴影。为了实现这一点，我的灯光需要 360 度投射阴影。有可能做这样的事情吗？如果是这样，怎么做？我应该使用哪种类型的灯？

我的太阳有一个meshBasicMaterial，我的行星有一个meshShaderMaterial。谁能给我一些示例代码？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T09:05:21.610

您应该`THREE.PointLight`为太阳添加一个 - 它会将光线投射到各个方向。

阴影比较棘手，因为 Three.js 中的点光源不支持阴影投射。您有一些不太理想的选择：

*   使用 6 个仅限阴影的聚光灯或定向灯，阴影摄像机排列为指向每个世界轴（即进入立方体）。这将是相当昂贵的。
*   使用一个（或多个）指向最感兴趣的区域的阴影投射灯，例如用户当前正在看的地方。
*   自己实现全方位阴影贴图（例如双抛物面阴影只需要两个阴影贴图而不是 6 个）。
*   省略阴影。太空中可以接收阴影的表面并不多，所以你真的需要它们吗？

请注意，使用自定义`ShaderMaterial`阴影接收对象，您需要自己在着色器中实现阴影（或包含三个.js 的阴影代码块）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:14:29.977

听起来您需要使用全向灯。

# image - cocoa mac osx 不同尺寸图片的网格显示

> ID：14186678
> 
> 赞同：0
> 
> 时间：2013-01-06T21:00:05.553
> 
> 标签：image, macos, cocoa, gridview, size

我想要做的是在网格中显示一组图像，如时尚，但对于横向或纵向位置的图像具有不同的大小，这不包括使用 NSCollectionView 因为项目原型的大小只能设置一次......

我会以编程方式将子视图添加到scrollView，但是当窗口的大小发生变化并且scrollView的宽度变大时，右侧只会有空白区域......

您可以查看下面的图片以获得更好的理解...

[http://i.stack.imgur.com/NVJjP.png](http://i.stack.imgur.com/NVJjP.png)

提前谢谢你们...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T20:26:30.310

我最终做的是实现一个纯粹的数学算法，我根据之前添加的照片计算每张新添加的照片的（x，y）位置，它做得很好......保存照片的容器被嵌入一个滚动视图，不用说我还必须计算这个容器的高度。

# git - Git & Intellij，如何仅提交已更改文件的部分内容

> ID：14186681
> 
> 赞同：78
> 
> 时间：2013-01-06T21:00:14.560
> 
> 标签：git, intellij-idea, git-commit

我似乎不能只提交文件中的一小部分更改，似乎是所有文件或什么都没有，我正在使用带有 Intellij 的 Git，这可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2017-10-04T01:33:53.300

**更新 - 2/2018：2018.1** 的第一个 EAP 版本已经登陆，它就在这里！它被实现为每个大块的复选框，因此您可以在提交之前有选择地检查它们。享受！

**更新 - 2017 年 12 月：**

好吧，2017.3 刚刚发布，但没有成功。所以让我们期待 2018.1。

**更新 - 2017 年 11 月：**

这已经“进行”了几个月了。2017.3 EAP 版本已经发布了一段时间，但这个问题还没有完成。除了人们询问何时完成之外，没有对该问题的更新，我认为这将滑到 2018 年版本。

**更新 - 2017 年：**

正如一些评论中指出的那样，这个[问题](https://youtrack.jetbrains.com/issue/IDEA-63201)已经开放多年。但它现在正在进行中，并计划在 2017.3 中登陆，该版本目前处于 EAP 版本中，应该会在今年秋天推出。所以现在，在提出这个问题四年后，您很快就能在 IDE 中真正做到这一点。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-01-06T22:02:54.150

不在 IDE 中。如评论中所述，您可以使用命令行，但我发现使用 GUI GIT 客户端更容易（我使用[Tower](http://www.git-tower.com/)，但有很多可用的）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-12-09T15:42:33.443

你应该试试 SourceTree(Mac & Windows)，它是免费的，是使用 GIT 的好工具。它在舒适的 UI 中拥有您想要的所有提交自由。

这是我的 IntelliJ 提交工作流程，从简单到复杂的任务：

1.  智能
2.  源树
3.  外壳 GIT。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-02-22T10:21:23.470

等待终于结束了，部分提交是 EAP 18.1 的一部分：[https ://blog.jetbrains.com/idea/2018/02/intellij-idea-2018-1-eap-partial-git-commits-and-more/](https://blog.jetbrains.com/idea/2018/02/intellij-idea-2018-1-eap-partial-git-commits-and-more/)

# c++ - 如何复制 std::queue 进入 std::string?

> ID：14186683
> 
> 赞同：1
> 
> 时间：2013-01-06T21:00:27.747
> 
> 标签：c++, reference, char, queue, std

我正在为这段代码苦苦挣扎：

```
std::queue<char> output_queue;
std::string output_string
// put stuff into output_queue
while (!output_queue.empty())
    {
    output_string.insert(0,(output_queue.front()));
    output_queue.pop();
    } 
```

我不知何故不能这样做，因为`std::queue<char>::front()`会返回 a`char&`而我不能把它放入`std::string`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T21:03:51.583

您缺少`insert`插入字符的参数。您需要指定该字符的数量：

```
output_string.insert(0, 1, output_queue.front()); 
```

如果您想让自己更轻松，您也可以使用`std::deque`代替`std::queue`并将其替换为：

```
std::deque<char> output_queue;
//fill output_queue in same way, but use push/pop_front/back instead of push/pop

std::string output_string(output_queue.begin(), output_queue.end());
output_queue.clear(); 
```

这几乎与现在相同，因为您`queue`实际上`std::deque`在后台默认使用 a 。然而`deque`，它支持迭代器，这使得这在没有依赖底层存储的丑陋代码的情况下成为可能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:03:47.903

您可以使用

```
output_string += (output_queue.front()); 
```

然后（一段时间后）`reverse`它

# r - 具有常见 bin/legend 中断的 hexbin 图矩阵

> ID：14186686
> 
> 赞同：1
> 
> 时间：2013-01-06T21:00:36.200
> 
> 标签：r, plot

假设我有许多双变量实验的重复，我希望在六边形分箱图中同时显示这些实验，并具有常见的细胞计数。是否有现有的代码可以做到这一点？有没有一种简单的方法来修改 hexbin 包来为我做到这一点？

例如：

```
library(hexbin)
x <- replicate(9, rnorm(10000), simplify=FALSE)
y <- replicate(9, rnorm(10000), simplify=FALSE)
h <- mapply(hexbin, x, y)
par(mfrow=c(3,3))
lapply(h, plot) 
```

此代码不显示具有常见单元格计数的十六进制图网格，但我喜欢它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:25:45.673

hexbin 对象是使用网格图形绘制的，因此您的 par(mfrow=c(3,3)) 不会做任何事情。每个图表都绘制在单独的页面上。要获取绘图选项的详细信息：

```
?gplot.hexbin 
```

在这种情况下，我们希望将 maxcnt 设置为最大的单元格计数：

```
lapply(h, plot, maxcnt=max(unlist(lapply(h, function(x) max(x@count))))) 
```

这将对每个图形应用相同的图例。

# html - ASP.Net MVC 4 布局改变

> ID：14186689
> 
> 赞同：1
> 
> 时间：2013-01-06T21:00:47.673
> 
> 标签：html, css, asp.net-mvc-4

我试图将 html 模板转换为 ASP.Net MVC 4 项目。但是我遇到了问题。然后打开`localHost:11062/`网站，一切看起来都很完美![看这里](../Images/6257a91444520a6d8b3d951b71918f07.png)。但是，如果我尝试使用相同的地址直接调用控制器和操作`localHost:11062/StartMenu/Index`，这应该是相同的，但事实并非如此![看这里](../Images/49ad35c553f1ebecc00dc6f2f58efa7c.png)。对我来说，看起来 css 文件加载正确。但如果没有，起始站点应该看起来不一样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:04:33.450

我怀疑您已将 url 硬编码到某些 CSS 文件中，就像这样：

```
<link href="Content/Site.css" rel="stylesheet" type="text/css" /> 
```

而不是使用 url 助手：

```
<link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" /> 
```

当然，所有静态资源（例如 javascript、图像、...

您永远不应该在 ASP.NET MVC 应用程序中对 url 进行硬编码。处理 url 时始终使用 url 助手。

此外，如果您在 CSS 文件中引用一些静态资源（例如图像），请不要忘记它们应该与 CSS 文件的位置相关。

`Net`您可能很容易在javascript 调试工具（例如 FireBug ）的选项卡中看到这一点，在该选项卡中您会收到相应资源的 404 错误。

# mysql - 按两个表中两个日期值中的最大值排序

> ID：14186691
> 
> 赞同：0
> 
> 时间：2013-01-06T21:00:57.990
> 
> 标签：mysql

我正在一个简单的论坛上工作，并且在尝试对列出的主题进行排序时遇到困难 - 如果主题都有回复，那么它工作正常，如果没有回复，那么它工作正常，但如果它们两者结合，那么它不会好好工作。我需要从 forum_topics 和 forum_replies 中取出最大值并使用该值进行排序。

我一直在寻找最好的东西，这似乎是我需要的，但它对我不起作用：

```
SELECT
GREATEST(MAX(forum_topics.topic_date),MAX(forum_replies.reply_date)) as g_date 
from forum_topics 
left join forum_replies on forum_topics.topic_id=forum_replies.reply_topic
where forum_topics.topic_category='$category_id'
GROUP BY forum_topics.topic_id
ORDER BY g_date desc 
```

论坛主题

```
topic_id    topic_date          topic_category
1           26/12/2012 23:09    2
2           26/12/2012 10:13    5
3           27/12/2012 02:04    2
4           27/12/2012 02:25    7
5           27/12/2012 02:32    3
6           27/12/2012 02:46    2
8           27/12/2012 02:49    2
9           27/12/2012 16:05    2
10          06/01/2013 19:57    2
11          06/01/2013 20:35    2
12          06/01/2013 20:36    5 
```

论坛回复

```
reply_id    reply_date          reply_topic
1           29/12/2012 19:14    1
2           26/12/2012 23:49    3
3           31/12/2012 00:00    1
4           27/12/2012 02:03    1
5           27/12/2012 02:15    3
6           27/12/2012 02:16    3
7           27/12/2012 02:17    3
8           27/12/2012 02:26    4
9           27/12/2012 03:19    3
10          27/12/2012 03:26    3
11          27/12/2012 03:29    3
12          27/12/2012 03:29    3
13          27/12/2012 03:30    3
14          27/12/2012 03:32    3
15      27/12/2012 03:35    3
17          27/12/2012 15:23    8
18          06/01/2013 20:35    2
19          06/01/2013 20:38    1 
```

类别 id=2 的期望结果：

```
1           06/01/2013 20:38 (reply 19)
11          06/01/2013 20:35 (topic 11)
10          06/01/2013 19:57 (topic 10)
9           27/12/2012 16:05 (topic 9)
3           27/12/2012 03:35 (reply 15)
6           27/12/2012 02:46 (topic 6) 
```

实际输出

```
1   06/01/2013 20:38:23 
3   27/12/2012 03:35:33 
6   27/12/2012 02:46:57 
9   27/12/2012 16:05:42 
10  06/01/2013 19:57:33 
11  06/01/2013 20:35:48 
```

我究竟做错了什么？

# android - 带有 SSL 到特定证书的 Android REST 客户端

> ID：14186694
> 
> 赞同：1
> 
> 时间：2013-01-06T21:01:18.943
> 
> 标签：android, ssl, httpclient, ssl-certificate

我正在尝试从 Android 连接到 SSL 休息服务。服务器使用并非来自通用 CA（Thawte、Verisign...）的 SSL 证书

我已经用这个例子继续：[http ://blog.antoine.li/2010/10/22/android-trusting-ssl-certificates/](http://blog.antoine.li/2010/10/22/android-trusting-ssl-certificates/)

然而，虽然我已经完成了所有提到的步骤（创建一个 BKS 提供程序，创建一个自定义 SchemeRegistry），但我仍然有错误：“没有对等证书”。

调用服务的代码（来自 AsyncTask）：

```
DefaultHttpClient client = new MyHttpClient(mainActivity[0].getApplicationContext());
HttpGet get = new HttpGet("<url of the service>");
get.addHeader("Autorization","Basic YW5kcm9pZDo=");
// Execute the GET call and obtain the response
HttpResponse getResponse;
try {
  getResponse = client.execute(get);
  .... 
```

MyHttpClient 的代码与博客示例相同。执行 client.execute(get) 会导致 execption 崩溃：

```
01-06 21:47:03.615: W/System.err(19289): javax.net.ssl.SSLPeerUnverifiedException: No peer certificate
01-06 21:47:03.625: W/System.err(19289):    at org.apache.harmony.xnet.provider.jsse.SSLSessionImpl.getPeerCertificates(SSLSessionImpl.java:137)
01-06 21:47:03.630: W/System.err(19289):    at org.apache.http.conn.ssl.AbstractVerifier.verify(AbstractVerifier.java:93)
01-06 21:47:03.635: W/System.err(19289):    at org.apache.http.conn.ssl.SSLSocketFactory.createSocket(SSLSocketFactory.java:381)
01-06 21:47:03.640: W/System.err(19289):    at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:165)
01-06 21:47:03.645: W/System.err(19289):    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:164)
01-06 21:47:03.645: W/System.err(19289):    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:119)
01-06 21:47:03.645: W/System.err(19289):    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:360)
01-06 21:47:03.650: W/System.err(19289):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:555)
01-06 21:47:03.650: W/System.err(19289):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:487)
01-06 21:47:03.650: W/System.err(19289):    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:465)
01-06 21:47:03.650: W/System.err(19289):    at validatedid.helloworldandroid.DownloadDevicePendingDocsTask.doInBackground(DownloadDevicePendingDocsTask.java:41)
01-06 21:47:03.650: W/System.err(19289):    at validatedid.helloworldandroid.DownloadDevicePendingDocsTask.doInBackground(DownloadDevicePendingDocsTask.java:1)
01-06 21:47:03.655: W/System.err(19289):    at android.os.AsyncTask$2.call(AsyncTask.java:264)
01-06 21:47:03.655: W/System.err(19289):    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
01-06 21:47:03.655: W/System.err(19289):    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
01-06 21:47:03.655: W/System.err(19289):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:208)
01-06 21:47:03.660: W/System.err(19289):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
01-06 21:47:03.660: W/System.err(19289):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
01-06 21:47:03.660: W/System.err(19289):    at java.lang.Thread.run(Thread.java:856) 
```

在某些地方说这可能是服务器的错误，但我不知道如何检查。任何帮助都会非常感激。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T12:33:57.993

更多地研究stackoverflow，我找到了问题的解决方案。

看起来使用来自[http://blog.antoine.li/2010/10/22/android-trusting-ssl-certificates/](http://blog.antoine.li/2010/10/22/android-trusting-ssl-certificates/)的代码 是不够的（至少对我来说）。

SSLSocketFactory 需要子类化。完整解释：[使用 HttpClient over HTTPS 信任所有证书](https://stackoverflow.com/questions/2642777/trusting-all-certificates-using-httpclient-over-https?answertab=votes#tab-top)

我把答案留在这里，以防有人到达这里。

我希望在 Android 的下一个版本中，这将是使用 https 访问 rest 服务的一种更简单的方法，因为这是一项常见任务，目前还不是很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T16:03:31.007

我使用 -> [this](http://blog.crazybob.org/2010/02/android-trusting-ssl-certificates.html "这") <- 来建立我的 Https 自签名证书连接，而不禁用证书或主机验证，因此它对 SSL pov 非常安全。

在简历中，需要在您的应用程序上创建一个自定义密钥库，以便您可以针对应用程序密钥库验证您的服务器 HTTP。

令人失望的是，太多人认为禁用 SSL 验证是此类问题的正确答案，而事实上，SSL 的全部意义在于安全性和验证。如果您打算避免任何验证，请坚持使用纯 HTTP

请参考我最近对另一个问题的[回答](https://stackoverflow.com/a/15531475/1202462)

# sql - HH 中的每小时平均聚合 = (HH-1):41 - PostgreSQL 中的 HH:40 格式

> ID：14186695
> 
> 赞同：1
> 
> 时间：2013-01-06T21:01:31.033
> 
> 标签：sql, postgresql, aggregate-functions, time-series, average

我有时间数据库，我想获得时间序列数据的每小时平均值。

样本数据：

```
1     -1.64 2007-09-29 00:01:09
2     -1.76 2007-09-29 00:03:09
3     -1.83 2007-09-29 00:05:09
4     -1.86 2007-09-29 00:07:09
5     -1.94 2007-09-29 00:09:09
6     -1.87 2007-09-29 00:11:09
7     -1.87 2007-09-29 00:13:09
8     -1.80 2007-09-29 00:15:09
9     -1.64 2007-09-29 00:17:09
10    -1.60 2007-09-29 00:19:09
11    -1.90 2007-09-29 00:21:09
12    -2.08 2007-09-29 00:23:09
13    -1.94 2007-09-29 00:25:09
14    -2.12 2007-09-29 00:27:09
15    -1.87 2007-09-29 00:29:09
16    -2.18 2007-09-29 00:31:09
17    -1.98 2007-09-29 00:33:09
18    -1.73 2007-09-29 00:35:09
19    -1.84 2007-09-29 00:37:09
20    -2.04 2007-09-29 00:39:09
21    -1.86 2007-09-29 00:41:09
22    -1.94 2007-09-29 00:43:09
23    -1.77 2007-09-29 00:45:09
24    -1.78 2007-09-29 00:47:09
25    -1.50 2007-09-29 00:49:09
26    -1.46 2007-09-29 00:51:09
27    -1.72 2007-09-29 00:53:09
28    -1.67 2007-09-29 00:55:09
29    -1.56 2007-09-29 00:57:09
30    -1.69 2007-09-29 00:59:09
31    -1.97 2007-09-29 01:01:09
32    -1.79 2007-09-29 01:03:09
33    -1.79 2007-09-29 01:05:09
34    -1.84 2007-09-29 01:07:09
35    -1.91 2007-09-29 01:09:09
36    -1.87 2007-09-29 01:11:09
37    -1.98 2007-09-29 01:13:09
38    -1.83 2007-09-29 01:15:09
39    -1.88 2007-09-29 01:17:09
40    -1.88 2007-09-29 01:19:09
41    -1.78 2007-09-29 01:21:09
42    -1.78 2007-09-29 01:23:09
43    -1.66 2007-09-29 01:25:09
44    -1.70 2007-09-29 01:27:09
45    -1.46 2007-09-29 01:29:09
46    -1.36 2007-09-29 01:31:09
47    -1.40 2007-09-29 01:33:09
48    -1.34 2007-09-29 01:35:09
49    -1.34 2007-09-29 01:37:09
50    -1.30 2007-09-29 01:39:09
51    -1.36 2007-09-29 01:41:09
52    -1.40 2007-09-29 01:43:09
53    -1.43 2007-09-29 01:45:09
54    -1.38 2007-09-29 01:47:09
55    -1.40 2007-09-29 01:49:09
56    -1.42 2007-09-29 01:51:09
57    -1.47 2007-09-29 01:53:09
58    -1.66 2007-09-29 01:55:09
59    -1.84 2007-09-29 01:57:09
60    -1.92 2007-09-29 01:59:09
61    -1.88 2007-09-29 02:01:09
62    -2.11 2007-09-29 02:03:09
63    -1.91 2007-09-29 02:05:09
64    -2.04 2007-09-29 02:07:09
65    -1.94 2007-09-29 02:09:09
66    -1.92 2007-09-29 02:11:09
67    -1.80 2007-09-29 02:13:09
68    -1.74 2007-09-29 02:15:09
69    -1.74 2007-09-29 02:17:09
70    -1.76 2007-09-29 02:19:09
71    -1.74 2007-09-29 02:21:09
72    -1.80 2007-09-29 02:23:09
73    -1.80 2007-09-29 02:25:09
74    -1.80 2007-09-29 02:27:09
75    -1.82 2007-09-29 02:29:09
76    -1.90 2007-09-29 02:31:09
77    -1.93 2007-09-29 02:33:09
78    -2.06 2007-09-29 02:35:09
79    -2.08 2007-09-29 02:37:09
80    -1.95 2007-09-29 02:39:09
81    -1.98 2007-09-29 02:41:09
82    -2.32 2007-09-29 02:43:09
83    -1.86 2007-09-29 02:45:09
84    -1.97 2007-09-29 02:47:09
85    -1.64 2007-09-29 02:49:09
86    -2.00 2007-09-29 02:51:09
87    -1.48 2007-09-29 02:53:09
88    -1.74 2007-09-29 02:55:09
89    -1.85 2007-09-29 02:57:09
90    -1.82 2007-09-29 02:59:09
91    -1.82 2007-09-29 03:01:09
92    -1.92 2007-09-29 03:03:09
93    -1.80 2007-09-29 03:05:09
94    -1.54 2007-09-29 03:07:09
95    -1.36 2007-09-29 03:09:09
96    -1.50 2007-09-29 03:11:09
97    -1.59 2007-09-29 03:13:09
98    -1.60 2007-09-29 03:15:09
99    -1.58 2007-09-29 03:17:09
100   -1.81 2007-09-29 03:19:09
101   -2.16 2007-09-29 03:21:09
102   -1.97 2007-09-29 03:23:09
103   -1.94 2007-09-29 03:25:09
104   -2.29 2007-09-29 03:27:09
105   -2.46 2007-09-29 03:29:09
106   -2.42 2007-09-29 03:31:09
107   -2.34 2007-09-29 03:33:09
108   -2.38 2007-09-29 03:35:09
109   -2.44 2007-09-29 03:37:09
110   -2.28 2007-09-29 03:39:09
111   -2.24 2007-09-29 03:41:09
112   -2.26 2007-09-29 03:43:09 
```

应根据以下时间间隔进行汇总： **HH = (HH-1):41 - HH:40** *示例：13 = 观察期 12:41 至 13:40*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:31:26.930

应该像这样工作：

```
SELECT  date_trunc('hour', ts + interval '20 min') AS h
       ,avg(val) as avg_val
FROM    t
GROUP   BY 1
ORDER   BY 1; 
```

我加了 20 分钟，然后再将时间颗粒化[`date_trunc()`](http://www.postgresql.org/docs/current/interactive/functions-datetime.html#FUNCTIONS-DATETIME-TRUNC)，然后按它聚合。
请注意，边界时间`08:40`以 9 点钟的平均值结束。

### 定期每小时网格

...包括基表中没有任何行的小时数：

```
SELECT *
FROM   generate_series('2007-09-28 22:00'  -- first hour
                      ,'2007-09-29 05:00'  -- last hour
                      ,interval '1h') AS h
LEFT   JOIN (
    SELECT  date_trunc('hour', ts + interval '20 min') AS h
           ,avg(val) as avg_val
    FROM    t
    GROUP   BY 1
    ORDER   BY 1
    ) x USING (h); 
```

使用[`generate_series()`](http://www.postgresql.org/docs/current/interactive/functions-srf.html)and a `LEFT JOIN`。

[**-> 更新了 sqlfiddle。**](http://www.sqlfiddle.com/#!12/2ca8e/7)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-06T21:36:22.900

我的系统很慢，因此我不能给你一个 sql fiddle。试试下面的。假设您只需要获得静态每小时平均值。

```
SELECT datecol, DATEPART(hour,timescolumn) as hourcol, AVG(valuecol)
FROM Yourtable
GROUP BY hourcol, dateCol; 
```

**编辑：**

感谢@Erwin。我用他的 sqlfiddle 来运行我的查询。有几个语法错误。而且它只是每小时平均一次。

*   [SQLFIDDLE 演示](http://www.sqlfiddle.com/#!12/2ca8e/14)

Postegres查询：

```
SELECT DATE(ts) AS DT, 
DATE_PART('hour', ts) as hourcol, avg(val)
FROM t
GROUP BY hourcol, DT
ORDER BY hourcol
; 
```

结果：

```
DT                              HOURCOL     AVG
September, 29 2007 00:00:00+0000    0           -1.814666666667
September, 29 2007 00:00:00+0000    1           -1.638
September, 29 2007 00:00:00+0000    2           -1.879333333333
September, 29 2007 00:00:00+0000    3           -1.986363636364 
```

# c# - 编辑pdf itextsharp并发送到浏览器

> ID：14186698
> 
> 赞同：2
> 
> 时间：2013-01-06T21:01:47.527
> 
> 标签：c#, asp.net, itextsharp

我想编辑现有的pdf并将结果发送到浏览器这是我的方法：

```
 public static byte[] Generate()
        {
        var templatePath = HttpContext.Current.Server.MapPath("~/my_template.pdf");
        // Based on:
        // http://www.johnnycode.com/blog/2010/03/05/using-a-template-to-programmatically-create-pdfs-with-c-and-itextsharp/
        var reader = new PdfReader(templatePath);
        var outStream = new MemoryStream();
        var stamper = new PdfStamper(reader, outStream);

        var form = stamper.AcroFields;
        var fieldKeys = form.Fields.Keys;

        foreach (string fieldKey in fieldKeys)
        {
         if (form.GetField(fieldKey) == "MyTemplatesOriginalTextFieldA")
           form.SetField(fieldKey, "1234");
         if (form.GetField(fieldKey) == "MyTemplatesOriginalTextFieldB")
           form.SetField(fieldKey, "5678");
         }

          // "Flatten" the form so it wont be editable/usable anymore  
        stamper.FormFlattening = true;  

        stamper.Close();
        reader.Close();

        return outStream.ToArray();
        } 
```

和方法调用

```
 byte[] buffer = Generate();
        Response.ContentType = "application/pdf";
        Response.AddHeader("content-length", buffer.Length.ToString());
        Response.BinaryWrite(buffer); 
```

在这种情况下有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T11:41:26.953

添加这一行

```
 byte[] buffer = Generate();
  Response.ContentType = "application/pdf";
  Response.AddHeader("content-length", buffer.Length.ToString());
  Response.AppendHeader("Content-Disposition", "attachment; filename=youPDFName.pdf"); 
  Response.BinaryWrite(buffer);
  Response.End(); 
```

我在代码中添加了 Content-Disposition 和 response.end。

测试上面的代码，工作正常。让我知道它是否对你有用。

# eclipse - 如何在 XText 生成的插件中获取 PreferenceStore

> ID：14186699
> 
> 赞同：1
> 
> 时间：2013-01-06T21:02:01.953
> 
> 标签：eclipse, xtext, emf

我正在尝试扩展 XText 为 DSL 生成的首选项页面。我设法添加了一个利用字段编辑器的新首选项页面，但我看不到如何获取`IPreferenceStore`实例以跟踪修改后的配置，如[http://www.vogella.com/articles/EclipsePreferences/中所述文章.html](http://www.vogella.com/articles/EclipsePreferences/article.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-07-13T09:41:09.323

`IPreferenceStore`可以注入（参见文档[）](https://www.eclipse.org/Xtext/documentation/302_configuration.html#dependency-injection)：

```
 <page
            category="org.xtext.example.mydsl.MyDsl"
            class="org.xtext.example.mydsl.ui.MyDslExecutableExtensionFactory:org.xtext.example.mydsl.ui.MyPage"
            id="org.xtext.example.mydsl.MyDsl.coloring"
            name="MyPage">
            <keywordReference id="org.xtext.example.mydsl.ui.keyword_MyDsl"/>
        </page> 
```

与例如

```
public class MyPage extends FieldEditorPreferencePage {
    @Inject
    public MyPage (IPreferenceStore preferenceStore) {
        setPreferenceStore(preferenceStore);
    }
} 
```

# python - 如何用两个键对 lambda 进行排序？

> ID：14186701
> 
> 赞同：1
> 
> 时间：2013-01-06T21:02:09.840
> 
> 标签：python, map, lambda, sorted

我用这个

```
ThreadList.append([''.join(map(str,[Thread])), date, rrf[5]])

SendThreadList = ''

ThreadList = sorted(ThreadList, key=lambda Entry: Entry[1], reverse=True)
ThreadList = sorted(ThreadList, key=lambda Entry: Entry[2], reverse=True) 
```

sorted 只显示第二个排序，如何用 key 中的两个条目排序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T21:09:05.177

如果要按 Entry[1] 排序，然后按 Entry[2] 排序，则使 lambda 以元组形式返回...：

```
ThreadList = sorted(ThreadList, key=lambda Entry: (Entry[1], Entry[2]), reverse=True) 
```

有时更具可读性（并且可能会更快）的是使用`operator`模块并使用`key=operator.itemgetter(1, 2)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:20:28.657

虽然这是错误的做法，但如果您交换订单，您的示例将起作用：

```
ThreadList = sorted(ThreadList, key=lambda Entry: Entry[2], reverse=True)
ThreadList = sorted(ThreadList, key=lambda Entry: Entry[1], reverse=True) 
```

Python 排序是稳定的 - 如果两个条目并列`[1]`，它们将保持从第一个排序开始的顺序。

# c - 动态内存分配。我错过了什么？

> ID：14186706
> 
> 赞同：2
> 
> 时间：2013-01-06T21:02:26.093
> 
> 标签：c, memory, operating-system, malloc

请看一下这段代码：

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
    char* foo = (char*)malloc(500000000);

    // when I uncomment stuff that's below then operating system
    // admits that this program uses 500MB of memory. If I keep
    // this commented, it claims that the program uses almost no
    // memory at all. Why is it so?

    /*
    for (int i=0; i<500000000; i++)
    {
        foo[i] = (char)i;
    }
    */

    int bar; scanf("%d", &bar); // wait so I can see what's goin on

    free(foo);

    return 0;
} 
```

我的直觉很简单。当我使用 malloc 调用分配 500MB 时，操作系统应该说该进程正在使用超过 500MB 的内存。但显然，它不是那样工作的。我错过了什么？操作系统使用什么技巧，我应该阅读什么？

提前感谢您提供任何线索。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T21:06:30.970

> 我错过了什么？操作系统使用什么技巧，我应该阅读什么

这是一种惰性分配形式。简而言之：

*   `malloc`要求操作系统提供大量内存，操作系统会说：“当然，给你”并且（几乎）什么都不做
*   操作系统暗地里希望你永远不要碰“分配”的页面
*   当您*触摸*分配的页面时，操作系统会捕捉到不可避免的页面错误，叹息并分配页面

这发生在每页上。因此，如果在您的系统中`for`增加`i`页面大小（可能是 4096 或类似的东西），您将获得相同的用法。作为一个简单的技巧，尝试使用`for`触摸元素的数量。作为奖励，尝试通过将大小除以页面大小来预测内存使用情况

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:05:56.687

进程中的所有内存使用都由操作系统虚拟化。您可能在代码中“分配”了一个内存块，但操作系统实际上可能不会将其提交到物理内存，直到它被代码实际使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:05:32.797

在您使用它之前，您的操作系统可能不会分配（或显示它已分配）内存。

无论如何，`malloc()`如果要分配如此大的块，检查的返回值是一个非常好的主意。`malloc()` **可能**会失败，你知道的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T21:07:15.063

操作系统内存页面仅在您访问它们时才真正分配给您的进程（在您的情况下通过写入）。确切的行为取决于您的编译器和操作系统 - 在不同的系统上，您可能会发现内存立即用完。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-06T23:42:20.087

它与操作系统无关。编译器优化生成的代码，以便如果未使用分配的内存，则它会删除在生成的二进制文件中分配内存的语句。您可以通过将编译器优化级别设置为零来检查这一点。那么无论哪种情况，你都会得到 500MB，因为每次都会分配内存。

# php - JavaScript 变量值到 PHP

> ID：14186712
> 
> 赞同：-3
> 
> 时间：2013-01-06T21:03:17.210
> 
> 标签：php, javascript

我知道以下问题已被问过很多次：

```
<script>
  var myVar = 123;
  <?php $what_is_myVar = myVar ; ?>
</script> 
```

我对这个问题的搜索结果是：

*   PHP 运行在服务器上，JavaScript 运行在客户端……</li>
*   需要使用Ajax来传递一个JS值...
*   这段代码永远不会让你工作......</li>
*   需要设置隐藏字段值...</li>
*   使用 $_GET[]…</li>

我尝试了以下方法，但没有奏效：

```
<?php $what_is_myVar = "<script>document.write(myVar)</script>"; ?> 
```

我在任何地方都找不到完整的简短解决方案来传递`myVar`into`$what_is_myVar`

请任何人帮助我解决这个问题，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:06:31.073

你应该使用 ajax 请求，点击链接：
[5 Ways to Make Ajax Calls with jQuery](http://net.tutsplus.com/tutorials/javascript-ajax/5-ways-to-make-ajax-calls-with-jquery/)

# android - Android常用方法放哪里

> ID：14186713
> 
> 赞同：-1
> 
> 时间：2013-01-06T21:03:28.667
> 
> 标签：android, methods, android-activity

如果我有大多数活动都使用的方法，最好将这些方法放在每个活动类中还是创建一个包含这些方法的静态类？请解释原因，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:28:36.213

如果方法纯粹是无状态的，或者如果它们只需要引用某个活动可以提供的东西（例如 a `Context`），那么让一个类充满静态方法可能是最简单的。

如果方法需要在执行时维护一些无法封装在方法中的状态，则最好创建一个常规类，因为通常认为使用静态变量来维护状态是不好的——如这可能会导致多线程应用程序出现问题。

如果你走类路线，需要使用这些方法的活动/等可以创建你定义的类型的对象，然后使用它的`public`方法。

还有一整套其他选项——一个相对常见的选项是创建一个所有活动都可以访问的单例，而无需创建自己的类实例。单例通常用于管理类——在这种情况下，您在任何时候都只需要一个实例，并且该实例适合在事情发生时提供事件回调。

选择真的取决于你。在不知道您想要完成什么的情况下，很难推荐一个“最佳”选项。

# mysql - 如何根据外键执行 sql 计数

> ID：14186720
> 
> 赞同：1
> 
> 时间：2013-01-06T21:03:55.197
> 
> 标签：mysql, count, foreign-keys

这是简化的架构：

```
CREATE TABLE IF NOT EXISTS `person` (
  `Id` int(11) NOT NULL AUTO_INCREMENT,
  `HousingId` int(11) NOT NULL,
  PRIMARY KEY (`Id`)
);

CREATE TABLE IF NOT EXISTS `housing` (
  `Id` int(11) NOT NULL AUTO_INCREMENT,
  `Capacity` int(11) NOT NULL,
  PRIMARY KEY (`Id`)
); 
```

**我怎样才能简单地获得每个住房的可用空间？**

我尝试了以下查询：

```
select housing.Id, housing.Capacity - count(person.Id)
from housing, person 
where person.HousingId = housing.Id 
group by housing.Id 
```

但它只适用于至少有一个人的住房，不适用于空置的住房。

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T21:07:07.933

使用外连接

```
select housing.Id, housing.Capacity - count(person.Id)
from housing
LEFT OUTER JOIN person ON person.HousingId = housing.Id 
group by housing.Id, housing.Capacity 
```

# windows - 如何删除批处理文件中的文件列表

> ID：14186725
> 
> 赞同：3
> 
> 时间：2013-01-06T21:04:22.627
> 
> 标签：windows, batch-file

我正在尝试使用批处理脚本从目录及其子目录中删除所有非代码文件。使用命令提示符我可以验证脚本的结果，但是当脚本执行时，它不会执行人们期望的操作。

```
for /F %%F in ('dir /s /b /a-d ^| findstr /vile ".c .cpp .h .hpp"') do if "%%~fF" neq      "%~f0" del /S /Q "%%F" 
```

提取并执行以下命令时，生成的路径是正确的：

```
dir /s /b /a-d | findstr /vile ".c .cpp .h .hpp" 
```

但是，当通过批处理文件执行它时，发送到'del /S /Q "%%F"' 命令的结果路径一遍又一遍地是第一个子目录。

下面是命令提示符输出和批处理文件输出的对比（将del命令替换为echo）

安慰：

```
C:\testdata\delete_test>dir /s /b /a-d | findstr /vile ".c .cpp .h .hpp"
C:\testdata\delete_test\delete_non_code_files.bat
C:\testdata\delete_test\delete_test - Copy\7328_log.txt
C:\testdata\delete_test\delete_test - Copy\7588_log.dat
C:\testdata\delete_test\delete_test - Copy\7964_log.txt
C:\testdata\delete_test\delete_test - Copy\8860_log.txt
C:\testdata\delete_test\delete_test - Copy (2)\7328_log.txt
C:\testdata\delete_test\delete_test - Copy (2)\7588_log.dat
C:\testdata\delete_test\delete_test - Copy (2)\7964_log.txt
C:\testdata\delete_test\delete_test - Copy (2)\8860_log.txt
C:\testdata\delete_test\delete_test - Copy (3)\7328_log.txt
C:\testdata\delete_test\delete_test - Copy (3)\7588_log.dat
C:\testdata\delete_test\delete_test - Copy (3)\7964_log.txt
C:\testdata\delete_test\delete_test - Copy (3)\8860_log.txt 
```

批处理文件：

```
C:\testdata\delete_test>delete_non_code_files.bat
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test"
/S /Q "C:\testdata\delete_test\delete_test" 
```

为什么我的 %%F 变量不指向一个文件，因为 'for /F' 应该导致它这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:48:48.743

FOR /F 命令将每一行解析为标记，并且默认标记分隔符是`<space>`并且`<tab>`默认情况下，仅保留第一个标记。您需要通过将 DELIMS 设置为空来强制整行成为一个标记。此外，默认情况下 EOL 选项`;`，这意味着任何以开头的行都`;`将被跳过。从技术上讲，文件夹或文件名可以以 开头`;`，因此应将 EOL 选项设置为无法以有效路径开头的内容。是一个很好的`:`候选人。

完全不相关，但在这种情况下您不需要`/S`or`/Q`选项。

```
for /F "eol=: delims=" %%F in ('dir /s /b /a-d ^| findstr /vile ".c .cpp .h .hpp"') do if "%%~fF" neq "%~f0" del "%%F" 
```

# xcode - 无法在弹出控制器中显示的 UITableView 上显示重新排序控件

> ID：14186730
> 
> 赞同：0
> 
> 时间：2013-01-06T21:05:07.447
> 
> 标签：xcode, ios6, uitableview, uipopovercontroller

我正在使用通用应用程序并正在使用情节提要。该应用程序的基本思想是导航控制器内部有一个文本视图。用户编辑文本视图后，他们可以选择保存数据。此文本视图数据保存在数组中。要查看已保存文本视图的列表，导航栏中有一个按钮，按下该按钮会转到表格视图。我遇到的问题是在 iPad 版本上，此表格视图显示为弹出框并且不继承导航栏，该导航栏显示允许重新排序单元格的编辑按钮。我找不到解决方案来在弹出窗口中显示此表视图的重新排序控件。这适用于 iPhone 版本，因为 table view segue 是一个推送。

![在此处输入图像描述](../Images/26c0cd3de81d5fb1c87ca910eb71e315.png)

这是弹出框的segue代码：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"Show Digital Tape Archive"]) {
        if ([segue isKindOfClass:[UIStoryboardPopoverSegue class]]) {
            UIStoryboardPopoverSegue *popoverSegue = (UIStoryboardPopoverSegue *)segue;
            [self.popoverController dismissPopoverAnimated:YES];
            self.popoverController = popoverSegue.popoverController;
        } ..... 
```

任何帮助或建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T04:41:03.337

After researching and a lot of trial and error, the solution I came up with is creating this popover as a UIViewController instead of a UITableViewController. I then added a toolbar and a tableView. When I originally created this viewController, it was a UITableViewController and I wasn't able to add a toolbar.

There appears to be a way to add a toolbar on a UITableViewController but wasn't able to do it.

# google-chrome-extension - Chrome 扩展字体-face mime-type

> ID：14186735
> 
> 赞同：5
> 
> 时间：2013-01-06T21:05:34.123
> 
> 标签：google-chrome-extension, font-face

我已经在服务器上解决了这个问题，但在 Chrome 扩展程序中没有解决。当我使用加载了`@font-face`. 例如：

```
@font-face {
    font-family: 'fontello';
    src:  url("../../fonts/fontello.svg#fontello") format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

Chrome 告诉我这样的事情：

```
Resource interpreted as Font but transferred with MIME type image/svg+xml: "fonts/fontello.svg#fontello" 
```

所以在服务器上我可以强制为我的字体设置标题，但我可以在 Chrome 扩展中做什么？任何类型的 Chrome 扩展魔法提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-17T21:49:50.580

[自 Chrome 28 以来，此错误](https://code.google.com/p/chromium/issues/detail?id=230297)已得到修复，因此警告消息（关于 svg 字体）不再相关。

在评论中，乔希说他们仍然遇到扩展问题，大概他在控制台中收到以下消息：

> 资源解释为字体但使用 MIME 类型 text/plain 传输：chrome-extension://...

Chrome 扩展程序和应用程序中的文件使用操作系统定义的 MIME 类型提供服务（除了[mime_util.cc 中定义的一些常见格式](https://cs.chromium.org/file:mime_util.cc%20primary_mappings)）。在 Windows 上，这些位于 Windows 注册表中，在 Linux 中位于共享 MIME 数据库中（可通过[xdg-mime](http://linux.die.net/man/1/xdg-mime)访问）。如果您修复系统上的文件关联，警告将消失。例如，在 Josh 的示例中，映射`.ttf`到`font/truetype`和`woff`到`application/font-woff`将解决问题。

Chrome 支持 TTF、WOFF 和 SVG 字体，因此如果由于某种原因无法更改 MIME 映射，您可以随时切换到不同的字体。例如，如果您的系统`.woff`文件的 MIME 类型损坏，但映射正确`.ttf`，只需使用以下声明来加载 true-type 字体而不是 .woff 字体：

```
@font-face {
  font-family: 'NameOfMyFont';
  src: url('chrome-extension://__MSG_@@extension_id__/fontfile.ttf') format('truetype');
} 
```

# view - 如何使用 tableview 导航到新视图/页面/屏幕

> ID：14186739
> 
> 赞同：0
> 
> 时间：2013-01-06T21:05:38.497
> 
> 标签：view, tableview

所以我使用 tableview 来制作一个与搜索栏一起使用的列表，但现在我希望 tableview 中的部分在我按下它时导航/转到新视图/页面/屏幕，有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:14:43.393

干得好：

```
 - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath  {
    [[self navigationController] pushViewController:[[SecondViewController alloc] initWithNibName:@"SecondView" bundle:[NSBundle mainBundle]] animated:YES];
 } 
```

# javascript - Javascript 图像加载事件

> ID：14186752
> 
> 赞同：0
> 
> 时间：2013-01-06T21:06:39.160
> 
> 标签：javascript, jquery

我知道我可以将事件侦听器附加到加载图像，以便在图像完成加载时触发，如下所示：

```
<img id="mine" src="image.jpg" />

<script>
$('#mine').load(function() {
  console.log($(this).height()); //The image's height
  console.log($(this).width()); //The image's width
})
</script> 
```

但是我的浏览器在加载标题后就知道图像会有多大 - 我可以点击该事件，以便浏览器知道图像的大小后我可以调整页面上元素的大小吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:11:46.230

不，你不能。但是，您应该将图像的尺寸与标签一起传递。

```
<img id="mine" src="image.jpg" width="100" height="100"> 
```

例如，在 PHP 中您可以使用该[`getimagesize()`](http://php.net/manual/en/function.getimagesize.php)函数。

它甚至是改进浏览器渲染[的推荐做法。](https://developers.google.com/speed/docs/best-practices/rendering#SpecifyImageDimensions)

# string - Emacs Lisp 中要字符串的字符列表

> ID：14186758
> 
> 赞同：5
> 
> 时间：2013-01-06T21:07:17.453
> 
> 标签：string, emacs, elisp, concatenation, chars

我有一个字符列表，`(?h ?e ?l ?l ?o)`我想将其转换为 string `"hello"`。目前我使用这种结构：

```
(concat (mapcar (lambda (ch) (char-to-string ch)) s)) 
```

是否有更优雅和惯用的方式将字符列表转换为Elisp**中的字符串？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-06T21:20:31.700

Elisp`concat`返回一个字符串：

```
(concat '(?h ?e ?l ?l ?o)) 
```

（从`coerce`实现中发现`cl`）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-07T12:56:02.757

还有`(apply #'string LIST-OF-CHARS)`。

# c - 字符常量对于它的类型来说太长了，怎么了？

> ID：14186763
> 
> 赞同：-1
> 
> 时间：2013-01-06T21:08:34.567
> 
> 标签：c

为什么我得到这个，是`getchar()`功能吗？

```
printf("Type stop to end connection");
    while ((d=getchar()) != '\n' && i < MAXLENGHT){
    buf2[i++] = d;
}
buf2[i] = '\0';
dfg = strlen(buf2);}
while (d != 'stop'); // here the error
close(sockfd);
exit(0); 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T21:10:40.907

单引号表示`char`文字。通常这意味着一个字符。允许使用多字符文字，但标准说它们的含义是实现定义的。`'stop'`由于字符过多，您的实现似乎无效。

无论如何，我很确定您不打算编写多字符文字。查看代码片段，我认为您的意思是将输入读入字符串并用于`strcmp`测试与字符串的相等性`"stop"`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:12:32.073

除了语法错误（'' 而不是 ""），您可能还想比较字符串：

```
while (strcmp(buf2, "stop") != 0) ... 
```

# gdb - GDB 检查命令，目标地址有多个单元

> ID：14186769
> 
> 赞同：1
> 
> 时间：2013-01-06T21:09:09.540
> 
> 标签：gdb

我正在自学《Hacking The Art of Exploitation 2nd Edition》一书，并且已经达到了第一组障碍。

在 GDB 中，我可以理解这段代码：

```
x/x $rip 
```

将检查寄存器 $rip 并以十六进制输出。

但是这段代码做了什么：

```
x/2x $rip 
```

这本书说它正在检查目标地址的多个单元。但这是否意味着它在接下来的 2 次更改时显示 $rip 的值。还是有别的意思？

正如哥伦布所说，还有一个问题。调用检查命令后，我得到：

```
0x100000f00 <main+8> 0x00fc45c7 
```

main+8 是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T05:09:07.247

> `x/x $rip`将检查寄存器 $rip 并以十六进制输出。

这是不正确的：它将检查.指向的*内存*`$rip`。如果你想检查`$rip`自己，你会使用`print/x $rip`.

> 但是这段代码做了什么：`x/2x $rip`

它检查由 指向的两个记忆词`$rip`。

> 是什么`main+8`意思

这意味着您正在查看包含指令的内存，位于`8`从开始的偏移量`main()`

# javascript - javascript setInterval - 倒计时滞后

> ID：14186771
> 
> 赞同：2
> 
> 时间：2013-01-06T21:09:24.820
> 
> 标签：javascript, setinterval, countdown

我在下面使用此代码以秒为单位进行倒计时。问题是，当使用 jquery .load 再次加载包含倒计时的页面部分时，新的倒计时变得错误：每秒，我们看到快 2 秒，如下所示：9-8...7-6。 ..5-4 ......好像它没有与时钟同步......在那里看到它：aorbaroquethrash.com/test（为了发生问题，我必须在你在那里时改变歌曲）

知道如何解决这个问题吗？

```
<script type = "text/javascript">
/*author Philip M. 2010*/

var timeInSecs;
var ticker;

function startTimer(secs){
timeInSecs = parseInt(secs)-1;
ticker = setInterval("tick()",1000);   // every second
}

function tick() {
var secs = timeInSecs;
if (secs>0) {
timeInSecs--;
}
else {
clearInterval(ticker); // stop counting at zero
}

document.getElementById("countdown").innerHTML = secs;
} 
startTimer(<?php echo $stream['info']['length'];?>);

</script> 
```

帕特里克

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-06T21:21:14.513

您应该使用当前系统时间来显示或计算已经过去的秒数，而不是自己计算。 `setInterval()`不能保证按时完美调用，当您自己数数时，您可能会出现累积错误，如果没有按时调用，您将显示错误的时间。

记录您开始计数的时间，然后在每个刻度上，获取新的系统时间并计算自您开始计数以来已经过去了多少时间，没有累积错误。

* * *

另外，请不要将字符串传递给`setInterval()`. 传递一个真正的函数引用，因为这可以防止范围问题和其他潜在问题。

* * *

这是倒数计时器的工作代码示例：

```
var startTime, countAmt, interval;

function now() {
  return ((new Date()).getTime());
}

function tick() {
  var elapsed = now() - startTime;
  var cnt = countAmt - elapsed;
  var elem = document.getElementById("counter");
  if (cnt > 0) {
    elem.innerHTML = Math.round(cnt / 1000);
  } else {
    elem.innerHTML = "0";
    clearInterval(interval);
  }
}

function startTimer(secs) {
  clearInterval(interval);
  document.getElementById("counter").innerHTML = secs;
  countAmt = secs * 1000;
  startTime = now();
  interval = setInterval(tick, 1000);  
}

startTimer(20); 
```

工作演示：http: [//jsfiddle.net/jfriend00/mxntj/](http://jsfiddle.net/jfriend00/mxntj/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:49:27.193

我已将此添加到 jfriend00 脚本以获取 'minutes:secs' ：

```
function minute(secs){
    minVar = Math.floor(secs/60);
    secs = secs % 60;
    if (secs < 10) {
        secs = "0"+secs;
    }
    return minVar+":"+secs;
} 
```

添加到：elem.innerHTML = minute(Math.round(cnt / 1000)); 和 document.getElementById("countdown").innerHTML = minute(secs);

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:05:06.377

谢谢大家。

我需要添加'clearInterval(ticker);' 在函数 startTimer 的开头。

# ruby - 使用 let() 辅助函数时 Rspec 中的命名空间问题

> ID：14186779
> 
> 赞同：0
> 
> 时间：2013-01-06T21:10:28.510
> 
> 标签：ruby, rspec, namespaces

我在使用 rspec 提供的 let 函数时遇到问题：

在 app/spec/class_spec.rb 中：

```
require 'spec_helper'
module App
   describe Class do
      let(:instance) {Class.new('param')}

      describe "#method" do
         it "does something" do
            instance.method(...)
            # clever test code
         end
      .
      .
      .
end 
```

我一直在关注 RSpec 书，根据它的示例（通过了！），让我可以访问“描述类”块的其余部分的变量实例。但我得到了错误：

```
Uninitialized constant App::instance 
```

我也尝试添加此代码无济于事：

```
before :all do
    instance
end 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T10:17:43.980

代替

```
module App
   describe Class do 
```

只需使用：

```
describe App::Class 
```

一切都应该很好提示：相反`let(:instance) {Class.new('param')}`，您可以编写`let(:instance) {described_class.new('param')}`. 它更聪明。

# android - 将长字符串分成多个页面

> ID：14186783
> 
> 赞同：2
> 
> 时间：2013-01-06T21:10:52.540
> 
> 标签：android

我正在尝试将长字符串显示到多个页面中。我的 Activity.xml 有一个文本视图，它占据了屏幕高度的 90%（这是我设置的相对布局）。我需要一些帮助来找出可以用来实现目标的正确方法/类

下面是我的代码。粗体内容（代码中以 ** 开头的注释）是我需要帮助的地方。

```
public class StoryActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_story);

    String contentString;
    String pageString;
    final int screenWidth;
    final int screenHeight;
   final int pageWidth;
   final int pageHeight;
   final int totalPages;
   int pageNumber;

    //load the content into the string contentString    
    InputStream is = getAssets().open("Story.txt");
        int size = is.available();
       byte[] buffer = new byte[size];
       is.read(buffer);
       is.close();
     contentString = new String(buffer);

           // get screen dimensions       
       DisplayMetrics dm = new DisplayMetrics();
       getWindowManager().getDefaultDisplay().getMetrics(dm);
       screenWidth = dm.widthPixels;
       screenHeight= dm.heightPixels;

       // create textview
       TextView tv = (TextView)findViewById(R.id.textViewStory);

             // calculate pageheight since textview size is 90% of the screen 
            pageHeight = (int) (0.9* screenHeight);
            pageWidth = screenWidth;

            **// 1)need to find number of lines which will fit pageHeight
            // 2)then I need to find total number of lines in my String contentString
            // 3)dividing 2) by 1) can give me number of pages required to display 
            // contentString. 
            // 4)I can then concatenate contentString at number of lines as found in 
            // 1) and thus I know what text (pageString) to display in page1**

            tv.setText(pageString); 

            **// steps 4) can be repeated to display next page when user click 
            // “nextpage” button**         

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:33:35.420

我不会为您提供完整的解决方案，但我找到了可以帮助您的答案。

1.  [首先](https://stackoverflow.com/questions/11347007/can-i-know-how-many-characters-can-fit-into-textview-of-x-dp-width)有助于找出 TextView 宽度可以容纳多少个字符。
2.  [其次](https://stackoverflow.com/questions/12432199/how-to-find-out-how-many-lines-text-wraps-to-in-a-textview-on-android)有助于获得 TextView 准确显示的行数。

但是换行存在问题。您需要应用一些算法来找出 android 框架是如何包装文本的，或者为它执行此操作。这是文本换行的[好答案](https://stackoverflow.com/questions/4212675/wrap-the-string-after-a-number-of-character-word-wise-in-java)

# android - Java.Lang.Null.Pointer 在 onCreate 的 FindViewById 异常，这可能是什么原因？

> ID：14186789
> 
> 赞同：0
> 
> 时间：2013-01-06T21:11:43.753
> 
> 标签：android, android-layout, android-fragments, android-xml, android-fragmentactivity

以前我有一个活动布局，现在我试图在片段中复制它作为 viewPager 的一部分。我复制了旧的 XML 文件并更改了所有 ID，以防发生冲突。我正在为此片段引用新的 XML 布局并创建新的 ID。但是当我运行它时它会得到这个空指针异常。

这是 logcat 文件 [http://i48.tinypic.com/14ekq6s.png](http://i48.tinypic.com/14ekq6s.png)

这是发生错误的java文件的一部分。

```
@Override
    public RelativeLayout onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        if (container == null) {
            // We have different layouts, and in one of them this
            // fragment's containing frame doesn't exist.  The fragment
            // may still be created from its saved state, but there is
            // no reason to try to create its view hierarchy because it
            // won't be displayed.  Note this is not needed -- we could
            // just run the code below, where we would create and return
            // the view hierarchy; it would just never be used.
            return null;
        }
        inflater.inflate(R.layout.one, null);
        ViewPager viewFinder = (ViewPager) getView();
//setContentView(R.layout.one);

        title = (TextView)     viewFinder.findViewById(R.id.frag_AA);  //ERROR xml id file probz 
```

这是布局文件。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/frag_AA"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:text="I Am Text"
        android:textAppearance="?android:attr/textAppearanceLarge" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:26:08.287

原因是`viewFinder`为空。

我看到你夸大了`R.layout.one`：

```
inflater.inflate(R.layout.one, null); 
```

但你不使用inflater返回的视图。 `inflater.inflate()`返回一个视图，这是您应该查找`title`TextView 的地方。

像这样的东西：

```
View view = inflater.inflate(R.layout.one, null);
title = (TextView)view.findViewById(R.id.frag_AA); 
```

（我从来没有使用过 ViewPagers，但是看一下[这个页面](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)，我感觉你用错了，虽然我可能不对）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T05:25:12.183

试试下面的代码..

```
View myview = inflater.inflate(R.layout.one, null);
title = (TextView)myview.findViewById(R.id.frag_AA); 
```

因为您的充气机不会充气任何布局，这是`null`因为如果

`inflater.inflate(R.layout.one, null);`是返回类型。它是返回视图。这样就出现了这个问题。

# c# - Visual Studio、C#详细图表

> ID：14186796
> 
> 赞同：4
> 
> 时间：2013-01-06T21:12:22.703
> 
> 标签：c#, sql, charts

我正在创建一个小程序，通过图表按月显示我们的总销售额，但我的图表不够详细，它显示了例如 2012'07 的总和在 20 到 40 之间，但我需要确切的值。(32,4)

![在此处输入图像描述](../Images/665d4af0415f62378ff4e3a5ffc1773e.png)

需要帮助。

代码

```
 private void formGraph()
    {
        string database, host, user, pass, sqlParams, sqlQuery;
        string resultPassword = String.Empty;

        database = "";
        host = "localhost";
        user = "";
        pass = "";

        sqlParams = "Database=" + database + ";Data Source=" + host + ";User Id=" + user + ";Password=" + pass;
        sqlQuery = "SELECT YEAR(`importdate`) as 'Year', MONTH(`importdate`) as 'Month', SUM(`price`) as 'Sum' FROM `data` GROUP BY MONTH(`importdate`), YEAR(`importdate`) ORDER BY YEAR(`importdate`), MONTH(`importdate`) ASC LIMIT 12";

        MySqlConnection sqlConnection = new MySqlConnection(sqlParams);
        MySqlCommand sqlCommand = new MySqlCommand(sqlQuery, sqlConnection);

        try
        {
            sqlConnection.Open();

            MySqlDataReader sqlReader = sqlCommand.ExecuteReader();

            if (sqlReader.HasRows)
            {
                while (sqlReader.Read())
                {
                    string Sum = sqlReader["Sum"].ToString();
                    if (Sum.Contains(",")) Sum = Sum.Replace(",", ".");
                    if (Sum == "0") Sum = "1";
                    chart1.Series.Add(sqlReader["Year"].ToString() + '\'' + sqlReader["Month"].ToString());
                    chart1.Series[sqlReader["Year"].ToString() + '\'' + sqlReader["Month"].ToString()].Points.AddY(Sum);
                    //sqlReader["Year"].ToString() + '"' + sqlReader["Month"].ToString()
                }
            }
        }
        catch (MySqlException sqlError)
        {
            MessageBox.Show("Error", "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
        finally
        {
            sqlConnection.Close();
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:24:51.787

您需要浏览所有系列并将该`IsValueShownAsLabel`属性设置为 true。像这样，做第一个：

```
Chart1.Series[0].IsValueShownAsLabel = true; 
```

希望这对你有帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T21:27:55.257

```
Chart1.Series(Series1.Name).Font = New System.Drawing.Font("Arial", 10.0F, System.Drawing.FontStyle.Italic) 
```

*如果您将 Series1.Name 替换为您的，它应该可以工作 = 在列顶部显示值*

```
Chart1.Series(Series1.Name).IsValueShownAsLabel = True; 
```

# database - 海量连接和并发写入选择什么数据库（网络游戏）

> ID：14186797
> 
> 赞同：3
> 
> 时间：2013-01-06T21:12:26.150
> 
> 标签：database, online-game

我正在为即将到来的大型在线游戏收集信息。我在 MEGA MASSIVE 类农场游戏（数百万 dau）方面拥有丰富的经验，而 SQL 数据库是很好的解决方案。我还使用过使用 NoSQL 数据库的大型在线游戏，而这个特定的数据库（Mongo）并不是最合适的——当大量连接和大量并发写入发生时很糟糕。

我正在寻找有关现代大型在线游戏的事实、基准、演示以及有关其后端基础架构（尤其是数据库）的技术细节。

例如我感兴趣：

*   它可以管理数千个连接吗？可能是一些外部工具可以提供帮助（例如 pgbouncer for postgres）。
*   它可以管理数以万计的并发读写吗？
*   磁盘空间碎片怎么办？可以在不停止数据库的情况下进行优化吗？
*   一些智能复制呢？当 master 失败时，它可以告诉副本中缺少一些数据吗？我可以安全地将奴隶传播到主人并确切地知道缺少哪些数据并采取适当的行动吗？
*   它可以优雅地失败吗？（例如 postgres for ex。）
*   在生产中使用的好评

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:24:29.457

首先假设硬崩溃是极其罕见的，当它们发生时，它不会是一些信息丢失的悲剧。

数据库的使用不应与游戏的日常管理强耦合。应该通过更多的临时存储来管理日常事件。一些辅助进程应该组织临时事件以最终存储在数据库中。

在极端情况下，您可以想象每个会话每个字符只有一个数据库读取和一个数据库写入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:39:12.407

你考虑过[NoSQL](http://en.wikipedia.org/wiki/NoSQL)吗？

> NoSQL 数据库系统通常针对检索和追加操作进行了高度优化，并且除了记录存储（例如键值存储）之外，通常提供的功能很少。*与完整的 SQL 系统相比，运行时灵活性的降低可以通过某些数据模型的可扩展性和性能的显着提升来弥补。*
> 
> 简而言之，*当数据的性质不需要关系模型时，NoSQL 数据库管理系统在处理大量数据时很有用。*数据可以结构化，但当真正重要的是存储和检索大量数据的能力，而不是元素之间的关系时，使用 NoSQL。使用示例可能是将数百万个键值对存储在一个或几个关联数组中，或者存储数百万条数据记录。该组织对于不断增长的元素列表（例如 Twitter 帖子或来自大量用户的 Internet 服务器日志）的统计或实时分析特别有用。

有更高级别的 NoSQL 解决方案，例如具有内置复制支持的[CrouchDB 。](http://readwrite.com/2010/07/13/nosql-database-couchdb)

# c++ - glsl着色器传递和渲染纹理

> ID：14186799
> 
> 赞同：1
> 
> 时间：2013-01-06T21:12:34.710
> 
> 标签：c++, opengl, glsl, shader, fragment-shader

我正在尝试将纹理传递并使用着色器......但每次我尝试以最简单的方式使用它时，我都会得到黑匣子，有时是白色 - 取决于我放置他的纹理......不知何故......

这里的代码片段应该可以工作（我已经删除了我的包装以使其更容易）：

```
fbo->bind();
fbo->drawBuffer(0);
fbo->setClearColor( 1.0, 1.0, 1.0, 1.0);
fbo->cleanCurrentTexture();

GLuint location;
location = glGetUniformLocation( Program->getID(), "sampler");
glActiveTexture( GL_TEXTURE0 );
glBindTexture(GL_TEXTURE_2D, fbo2->getTexture(0) );
glUniform1i(location, 0);
Program->begin();
glEnable(GL_TEXTURE_2D);

glBegin(GL_QUADS);
    glVertex3f( -1.0f, -1.0f, 0.0f );
    glVertex3f( -1.0f, 1.0f, 0.0f );
    glVertex3f( 1.0f, 1.0f, 0.0f );
    glVertex3f( 1.0f, -1.0f, 0.0f );
glEnd();

Program->end();

fbo->unbind();

glColor3f(1.0,1.0,1.0);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

glEnable( GL_TEXTURE_2D );
glBindTexture( GL_TEXTURE_2D, fbo->getTexture(0) );
    glBegin(GL_QUADS);
         glTexCoord2d( 0.0f, 0.0f);
        glVertex3f( -1.0f, -1.0f, 0.0f );
         glTexCoord2d( 0.0f, 1.0f);
        glVertex3f( -1.0f, 1.0f, 0.0f );
         glTexCoord2d( 1.0f, 1.0f);
        glVertex3f( 1.0f, 1.0f, 0.0f );
         glTexCoord2d( 1.0f, 0.0f);
        glVertex3f( 1.0f, -1.0f, 0.0f );
    glEnd();
glDisable( GL_TEXTURE_2D); 
```

顶点着色器：

```
#version 120

void main()
{
    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;
    gl_TexCoord[0] = gl_MultiTexCoord0;
} 
```

片段着色器：

```
#version 120

uniform sampler2D sampler;

void main()
{   
    gl_FragColor = texture2D(sampler, gl_TexCoord[0].xy);
} 
```

当然，我试图绑定的纹理存在并且它是完整的。这是它的参数：

```
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE );
glTexParameterf( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE );
glTexParameteri(GL_TEXTURE_2D, GL_GENERATE_MIPMAP, GL_TRUE); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T01:03:00.497

正如 Plow 在他的评论中所说，我相信这与未设置纹理坐标有关。您只是为第二个四边形设置纹理坐标。第二个四边形也没有用着色器程序绘制，它的绘制坐标与第一个完全相同，这意味着它应该是完全白色的（因为`glColor3f(1.0,1.0,1.0)`），或者根本不应该绘制（取决于您的相机位置以及是否启用深度测试）。

尝试仅绘制第一个四边形，并正确设置纹理坐标。

# php - 2 个日期值之间的随机时间和日期

> ID：14186800
> 
> 赞同：11
> 
> 时间：2013-01-06T21:12:44.013
> 
> 标签：php

我正在尝试编写一个 php 脚本（或代码行）来回显两个日期之间的随机时间和日期，例如

2012-12-24 13:03

这将在我选择的 2012 年 10 月 1 日和 2013 年 1 月 1 日之间。

任何想法如何最好地做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-01-06T21:15:41.977

简单 :) 只需选择 2 个随机日期，转换为 EPOCH，并在这 2 个值之间随机 :)

[EPOCH](http://en.wikipedia.org/wiki/Epoch_%28reference_date%29) - 自 1970 年 1 月 1 日以来的时间，以秒为单位。
您可以使用该[`strtotime()`](http://php.net/manual/en/function.strtotime.php)函数将日期字符串转换为纪元时间，并使用该[`date()`](http://php.net/manual/en/function.date.php)函数使其相反。

```
function rand_date($min_date, $max_date) {
    /* Gets 2 dates as string, earlier and later date.
       Returns date in between them.
    */

    $min_epoch = strtotime($min_date);
    $max_epoch = strtotime($max_date);

    $rand_epoch = rand($min_epoch, $max_epoch);

    return date('Y-m-d H:i:s', $rand_epoch);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-06T21:31:06.613

您可能想要定义一个分辨率，例如一分钟、三分钟或 15 秒或一天半或其他什么。随机性应该应用于整个周期，我在这里选择了一分钟作为示例（您的周期中有 132480 分钟）。

```
$start    = new Datetime('1st October 2012');
$end      = new Datetime('1st Jan 2013');
$interval = new DateInterval('PT1M'); // Resolution: 1 Minute
$period   = new DatePeriod($start, $interval, $end);
$random   = new RandomIterator($period);

list($result) = iterator_to_array($random, false) ? : [null]; 
```

这例如给出：

```
class DateTime#7 (3) {
  public $date =>
  string(19) "2012-10-16 02:06:00"
  public $timezone_type =>
  int(3)
  public $timezone =>
  string(13) "Europe/Berlin"
} 
```

你可以在[这里](http://hakre.wordpress.com/2013/01/08/getting-n-random-elements-out-of-an-iterator-randomiterator/)[找到`RandomIterator`](http://hakre.wordpress.com/2013/01/08/getting-n-random-elements-out-of-an-iterator-randomiterator/)。没有它，它将花费更长的时间（与上面的示例相比，迭代次数大约为 1.5）：

```
$count    = iterator_count($period);
$random   = rand(1, $count);

$limited = new LimitIterator(new IteratorIterator($period), $random - 1, 1);
$limited->rewind();
$result = $limited->current(); 
```

我也尝试过几秒钟，但这需要很长时间。您可能希望首先找到一个随机日期（92 天），然后再找到其中的一些随机时间。

`DatePeriod`此外，我还进行了一些测试，只要您使用秒等常见分辨率，我就找不到任何使用的好处：

```
$start    = new Datetime('1st October 2012');
$end      = new Datetime('1st Jan 2013');

$random   = new DateTime('@' . mt_rand($start->getTimestamp(), $end->getTimestamp())); 
```

或分钟：

```
/**
 * @param DateTime $start
 * @param DateTime $end
 * @param int|DateInterval $resolution in Seconds or as DateInterval
 * @return DateTime
 */
$randomTime = function (DateTime $start, DateTime $end, $resolution = 1) {

    if ($resolution instanceof DateInterval) {
        $interval   = $resolution;
        $resolution = ($interval->m * 2.62974e6 + $interval->d) * 86400 + $interval->h * 60 + $interval->s;
    }

    $startValue = floor($start->getTimestamp() / $resolution);
    $endValue   = ceil($end->getTimestamp() / $resolution);
    $random     = mt_rand($startValue, $endValue) * $resolution;

    return new DateTime('@' . $random);
};

$random = $randomTime($start, $end, 60); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-06T21:20:19.437

假设您想包括 10 月 1 日，但不包括 1 月 1 日...

```
$start = strtotime("2012-10-01 00:00:00");
$end =  strtotime("2012-12-31 23:59:59");

$randomDate = date("Y-m-d H:i:s", rand($start, $end));

echo $randomDate; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-06T21:20:56.760

太疯狂了，它可能会起作用

```
function randomDate($start_date, $end_date)
{
//make timetamps
$min = strtotime($start_date);
$max = strtotime($end_date);

//random date
$rand_date = rand($min, $max);

//format it
return date('Y-m-d H:i:s', $rand_date);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-06T21:21:25.093

这里有一些代码来完成这个：

```
$randDate=date('Y-m-d', mt_rand(strtotime('2012-10-01'), strtotime('2013-01-01'))); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-06T21:19:04.470

好的，这里有东西

```
$date_start = strtotime('1 October 2012');
$date_end = strtotime('1 January 2013');
$rand_date = rand($date_start, $date_end);
echo(date('d.m.Y H:i', $rand_date)); 
```

# javascript - 使用 jQuery 更改文本

> ID：14186802
> 
> 赞同：1
> 
> 时间：2013-01-06T21:13:03.943
> 
> 标签：javascript, jquery

我有一个脚本从雅虎获取某个主题的新闻。它呈现新闻提要的标题，如下所示：

```
<div class="header-title">subject - Yahoo! News Search Results</div> 
```

我想将其更改为以不同的方式阅读。因为这是通过 JS 插入的，所以我想我可以用 jQuery 来改变它。

我试过这个：

```
$('.header-title').text('Subject News'); 
```

那没有用，然后我尝试了这个：

```
$('.header-title').empty();
$('.header-title').text('Subject News'); 
```

那也没有用。

以上两种方法看起来都对文本没有影响。

我不确定如何删除旧文本并替换为我的文本。

注意：我所有的代码都在 jQuery 的 Document Ready IE 中：

```
$(function(){ 
   //Code Here 
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:14:40.023

不要忘记将您的代码放入[DOM](http://api.jquery.com/ready/)中：

```
$(function() {
    $(".header-title").text("Subject News");
}); 
```

否则代码应该可以正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:35:21.153

**此解决方案假定您无权访问创建提要小部件的其他脚本**

在不了解其他脚本的情况下，它听起来像是异步的，并且还创建了标题元素。您可以有一个定时间隔循环来检查元素是否存在，一旦存在就进行更新：

```
function changeYahooTitle(){
     var $yhooTitle=$('.header-title');
    if($yhooTitle.length){
        $yhooTitle.text('My New Title');
    }else{
        /* doesn't exist so check again in 1/10th second, will loop recursively until found*/
        setTimeout(changeYahooTitle, 100);
    }
} 
```

然后在页面加载：

```
$(function(){
  changeYahooTitle()

}) 
```

如果您确实有权访问其他脚本，则可以对其进行修改以满足您的需要，或者您仍然可以使用此解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T21:16:01.913

尝试使用[`html()`](http://api.jquery.com/html/)而不是`empty()`和`text()`

```
$(document).ready(function(){
    $(".header-title").html("Subject News");
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T21:58:54.100

可能发生的事情：

1.  首先，您要设置文本：`$('.header-title').text('Subject News');`
2.  那么......在数据完成Yahoo的加载或您的文本实际上被新获取的数据替换的任何内容之后

    **更改加载回调中的文本（加载数据后），它将起作用。**

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-06T21:36:28.167

它不起作用，因为您在创建元素之前调用了该函数。如果你把你的函数放在元素`<script>`之后的标签内，`<div>`它应该可以工作

# ruby - Qt：未找到标头和库

> ID：14186805
> 
> 赞同：1
> 
> 时间：2013-01-06T21:13:21.643
> 
> 标签：ruby, qt, qt4, fedora, configure

我正在尝试`korundum`在 Fedora 17 上安装。在此`./configure`阶段我收到以下错误：

```
checking for Qt... configure: error: Qt (>= Qt 3.3 and < 4.0) (headers and libraries) not found. Please check your installation! 
```

现在我想我已经安装了 QT，我尝试执行以下操作：

```
./configure --with-qt-includes=/usr/lib64/qt4/include 
```

但这也不起作用所以我应该怎么做...对于您的信息，我在以下输出中列出：

```
yum list *-devel | grep -i qt

qt-devel.x86_64                       1:4.8.4-1.fc17                    @updates
qtwebkit-devel.x86_64                 2.2.2-1.fc17                      @updates
ruby-qt-devel.x86_64                  4.9.4-1.fc17                      @updates
OpenSceneGraph-qt-devel.i686          3.0.1-13.fc17                     updates 
OpenSceneGraph-qt-devel.x86_64        3.0.1-13.fc17                     updates 
PackageKit-qt-devel.i686              0.7.5-1.fc17                      updates 
PackageKit-qt-devel.x86_64            0.7.5-1.fc17                      updates 
PyQt-devel.i686                       3.18.1-11.fc17                    fedora  
PyQt-devel.x86_64                     3.18.1-11.fc17                    fedora  
PyQt4-devel.i686                      4.9.1-2.fc17                      fedora  
PyQt4-devel.x86_64                    4.9.1-2.fc17                      fedora  
SoQt-devel.i686                       1.5.0-5.fc17                      fedora  
SoQt-devel.x86_64                     1.5.0-5.fc17                      fedora  
avahi-qt3-devel.i686                  0.6.31-5.fc17                     updates 
avahi-qt3-devel.x86_64                0.6.31-5.fc17                     updates 
avahi-qt4-devel.i686                  0.6.31-5.fc17                     updates 
avahi-qt4-devel.x86_64                0.6.31-5.fc17                     updates 
bamf-qt-devel.i686                    0.2.3-1.fc17                      fedora  
bamf-qt-devel.x86_64                  0.2.3-1.fc17                      fedora  
dbus-qt3-devel.i686                   0.9-8.fc17                        fedora  
dbus-qt3-devel.x86_64                 0.9-8.fc17                        fedora  
dbusmenu-qt-devel.i686                0.9.0-3.fc17                      fedora  
dbusmenu-qt-devel.x86_64              0.9.0-3.fc17                      fedora  
ibus-qt-devel.i686                    1.3.1-8.fc17                      fedora  
ibus-qt-devel.x86_64                  1.3.1-8.fc17                      fedora  
kdevelop-pg-qt-devel.i686             1.0.0-1.fc17                      fedora  
kdevelop-pg-qt-devel.x86_64           1.0.0-1.fc17                      fedora  
libQtGTL-devel.i686                   0.9.2-1.fc17                      fedora  
libQtGTL-devel.x86_64                 0.9.2-1.fc17                      fedora  
libaccounts-qt-devel.i686             0.31-5.fc17                       fedora  
libaccounts-qt-devel.x86_64           0.31-5.fc17                       fedora  
libircclient-qt-devel.i686            0.5.0-4.fc17                      fedora  
libircclient-qt-devel.x86_64          0.5.0-4.fc17                      fedora  
libmygpo-qt-devel.i686                1.0.5-3.fc17                      fedora  
libmygpo-qt-devel.x86_64              1.0.5-3.fc17                      fedora  
libprojectM-qt-devel.i686             2.0.1-5.fc17                      fedora  
libprojectM-qt-devel.x86_64           2.0.1-5.fc17                      fedora  
libqttracker-devel.i686               6.11.0-2.fc15                     fedora  
libqttracker-devel.x86_64             6.11.0-2.fc15                     fedora  
lightdm-qt-devel.i686                 1.2.3-1.fc17                      updates 
lightdm-qt-devel.x86_64               1.2.3-1.fc17                      updates 
perl-Qt-devel.i686                    0.96.0-2.fc17                     fedora  
perl-Qt-devel.x86_64                  0.96.0-2.fc17                     fedora  
plplot-qt-devel.i686                  5.9.9-6.svn12161.fc17             fedora  
plplot-qt-devel.x86_64                5.9.9-6.svn12161.fc17             fedora  
polkit-qt-devel.i686                  0.103.0-2.fc17                    fedora  
polkit-qt-devel.x86_64                0.103.0-2.fc17                    fedora  
poppler-qt-devel.i686                 0.18.4-3.fc17                     fedora  
poppler-qt-devel.x86_64               0.18.4-3.fc17                     fedora  
python3-PyQt4-devel.i686              4.9.1-2.fc17                      fedora  
python3-PyQt4-devel.x86_64            4.9.1-2.fc17                      fedora  
qt-assistant-adp-devel.i686           4.6.3-3.fc17                      fedora  
qt-assistant-adp-devel.x86_64         4.6.3-3.fc17                      fedora  
qt-devel.i686                         1:4.8.4-1.fc17                    updates 
qt-gstreamer-devel.i686               0.10.2-1.fc17                     fedora  
qt-gstreamer-devel.x86_64             0.10.2-1.fc17                     fedora  
qt-mobility-devel.i686                1.2.0-10.20110922.fc17            fedora  
qt-mobility-devel.x86_64              1.2.0-10.20110922.fc17            fedora  
qt-qsa-devel.i686                     1.1.5-9.fc17                      fedora  
qt-qsa-devel.x86_64                   1.1.5-9.fc17                      fedora  
qt3-devel.i686                        3.3.8b-41.fc17                    fedora  
qt3-devel.x86_64                      3.3.8b-41.fc17                    fedora  
qtiocompressor-devel.i686             2.3.1-3.fc17                      fedora  
qtiocompressor-devel.x86_64           2.3.1-3.fc17                      fedora  
qtlockedfile-devel.i686               2.4-4.fc17                        fedora  
qtlockedfile-devel.x86_64             2.4-4.fc17                        fedora  
qtsingleapplication-devel.i686        2.6.1-6.fc17                      fedora  
qtsingleapplication-devel.x86_64      2.6.1-6.fc17                      fedora  
qtsinglecoreapplication-devel.i686    2.6.1-6.fc17                      fedora  
qtsinglecoreapplication-devel.x86_64  2.6.1-6.fc17                      fedora  
qtsoap-devel.i686                     2.7-3.fc17                        fedora  
qtsoap-devel.x86_64                   2.7-3.fc17                        fedora  
qtwebkit-devel.i686                   2.2.2-1.fc17                      updates 
qtweetlib-devel.i686                  0.5-1.fc17                        fedora  
qtweetlib-devel.x86_64                0.5-1.fc17                        fedora  
qwtplot3d-qt4-devel.i686              0.2.7-10.fc15                     fedora  
qwtplot3d-qt4-devel.x86_64            0.2.7-10.fc15                     fedora  
ruby-qt-devel.i686                    4.9.4-1.fc17                      updates 
simfqt-devel.i686                     1.00.0-1.fc17                     updates 
simfqt-devel.x86_64                   1.00.0-1.fc17                     updates 
smokeqt-devel.i686                    4.9.4-1.fc17                      updates 
smokeqt-devel.x86_64                  4.9.4-1.fc17                      updates 
telepathy-logger-qt-devel.i686        0.5.2-1.fc17                      updates 
telepathy-logger-qt-devel.x86_64      0.5.2-1.fc17                      updates 
telepathy-qt4-devel.i686              0.9.3-2.fc17                      updates 
telepathy-qt4-devel.x86_64            0.9.3-2.fc17                      updates 
zbar-qt-devel.i686                    0.10-11.fc17                      fedora  
zbar-qt-devel.x86_64                  0.10-11.fc17                      fedora  
zint-qt-devel.i686                    2.4.3-3.fc17                      fedora  
zint-qt-devel.x86_64                  2.4.3-3.fc17                      fedora 
```

那么，如何在 fedora 17 上安装 Qt4 头文件和库？怎么能解决这个问题。

# javascript - 可以使使用 JQuery .html() 创建的 div 标签可点击吗？

> ID：14186807
> 
> 赞同：1
> 
> 时间：2013-01-06T21:13:24.623
> 
> 标签：javascript, jquery, html, css

嘿家伙有点奇怪的问题，但如果我使用 JQuery .html() 添加 div 标签并给他们一个 ID，然后我可以使用 .click 他们吗？该代码可能会解释我想要做什么。如果没有，是否有可能的解决方法？

我正在尝试动态更改我的网站而不去新网站。

因此，如果我创建带有 ID 的 Div。

```
$("#funTime").click(function(){
  var htmls = $("#content2").html();
  $("#content2").html(htmls + " <div id='button1'>Create</div><div id='button2'>Annimate</div><div id='button4'>Clear</div>");
 });

$("#button1").click(function(){create();});
$("#button2").click(function(){forannimation();});
$("#button3").click(function(){createOnMouse();}); 
```

它不起作用，但我不知道为什么。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T21:14:20.343

不，您需要[`.on()`](http://api.jquery.com/on/)能够处理动态添加的元素。

```
$('#content2').on('click', '#button1', function() {
    // do your stuff
}); 
```

另请注意，您只能将具有特定 id 的单个元素添加到 DOM。在您的示例中，每次单击具有 id 的元素时，`#funTime`您都会添加具有相同 id 的元素。

您可以通过向 DOM 添加带有某个类而不是 id 的按钮或使用计数器来生成唯一 id 来改进您的代码。或者根据您的需要`#funTime`通过使用来防止其他点击。[`.one()`](http://api.jquery.com/one/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T21:16:10.023

您只能将事件处理程序分配给存在的元素。所以处理程序的分配应该在创建元素*之后完成：*

```
$("#funTime").click(function(){
  var htmls = $("#content2").html();
  $("#content2").html(htmls + " <div id='button1'>Create</div><div id='button2'>Annimate</div><div id='button4'>Clear</div>");

$("#button1").click(function(){create();});
$("#button2").click(function(){forannimation();});
$("#button3").click(function(){createOnMouse();});
 }); 
```

但是，多次调用点击`funtime`会导致多个元素具有相同的 id，从而导致文档无效。要么防止重复 ID（例如实现一个计数器），要么使用类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:16:55.120

您实际上可以创建元素，将事件绑定到它们，所有这些都在它们出现在屏幕上之前。Backbone 和其他人也采用这种方式。

```
var myNewDiv = $("<div ...>");
myNewDiv.click(function(){});
$(something).append(myNewDiv); 
```

如果您想向页面上尚未出现的内容添加事件，您必须使用 jQuery 委托。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T21:17:49.253

您应该对动态添加的元素使用 on() 侦听器

```
$("#content2").on('click','#button1',function(){create();}); 
```

这将添加一个侦听器以检查所选容器中的实时添加按钮 (#content2)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-06T21:21:19.183

要在创建元素时添加处理程序，需要在添加元素后立即在单击处理程序中添加它......否则需要使用委托方法，如`on()`

这会起作用：

```
$("#funTime").click(function(){
  var htmls = $("#content2").html();
  $("#content2").html(htmls + " <div id='button1'>Create</div><div id='button2'>Annimate</div><div id='button4'>Clear</div>");
  /* elements exist  can add event handlers*/
   $("#button1").click(function(){create();});
   $("#button2").click(function(){forannimation();});
   $("#button3").click(function(){createOnMouse();});

}); 
```

当前更常见的做法是使用允许未来元素并且可以在页面加载时运行的委托

# java - 如何在 Mac 上为 Java 7 实现 Java Swing 全屏模式？

> ID：14186808
> 
> 赞同：1
> 
> 时间：2013-01-06T21:13:33.167
> 
> 标签：java, macos, swing, fullscreen, keyevent

我在让我的 Java JFrame 在所有操作系统（Windows、Mac、Linux）上全屏显示时遇到了一些问题。似乎我发现的任何解决方案都可以在一个操作系统上运行，但不能在其他操作系统上运行，或者有一些其他严重的错误。我想使用 setFullScreenWindow(window w) 方法正确启动全屏，因为 setExtendedState(...) 在 Mac/Linux 上不起作用，因为菜单栏和任务栏仍然可见。

setFullScreenWindow(...) 方法在所有环境中都可以正常工作，直到 Java 7 出现，现在似乎存在一个问题，即一旦您进入全屏模式，应用程序就不再响应 Mac OS X 上的关键事件。应用程序工作在 Windows 上就好了。

有谁知道我怎么可能解决这个问题？

**编辑：** *此处描述的解决方法（[FullScreen Swing Components Fail to Receive Keyboard Input on Java 7 on Mac OS X Mountain Lion](https://stackoverflow.com/questions/13064607/fullscreen-swing-components-fail-to-receive-keyboard-input-on-java-7-on-mac-os-x)）不适用于 Windows，因为它会导致 JFrame 闪烁并且无法正确打开。*

**编辑：** *这里描述的全屏方法与下面使用的方法相同，由于键输入问题而不起作用：（[如何使 JFrame 真正全屏？](https://stackoverflow.com/questions/10055436/how-to-make-a-jframe-really-fullscreen)）*

**示例代码：**

```
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.KeyStroke;

public class FullScreenKeyTest extends JFrame {

public void createFrame() {
    initKey();
    GraphicsDevice gd = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
    this.setUndecorated(true);
    this.setVisible(true);
    gd.setFullScreenWindow(this);
}

private void initKey() {
    Action keyAction = new AbstractAction() {
        public void actionPerformed(ActionEvent e) {
            System.out.println("Escape key pressed");
            setVisible(false);
            System.exit(0);
        }
    };
    this.getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW).put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0), "keyPress");
    this.getRootPane().getActionMap().put("keyPress", keyAction);
}

public static void main(String[] args) {
    FullScreenKeyTest testFrame = new FullScreenKeyTest();
    testFrame.createFrame();
}
} 
```

# symfony - 在 Symfony2 中检测实体配置错误

> ID：14186812
> 
> 赞同：0
> 
> 时间：2013-01-06T21:14:17.443
> 
> 标签：symfony, doctrine-orm

好吧，我不知道如何修复我的项目中的错误。

我正在尝试处理具有多对多属性关系的嵌套表单。错误表明它无法创建关联，因为其中一方需要 ID。

好的。所以我试图只创造缺失的一面。但仍然是同样的错误。

最后，我意识到这个简单的代码仍然存在同样的问题：

```
public function onSuccess(Page $page)
{   
    $this->em->flush();
} 
```

我很高兴收到一条错误消息，例如“嘿，没有什么可刷新的！” 但是不，仍然是同样的错误：我必须在关联之前创建对象（及其 id）。

我查看了堆栈跟踪。是的，似乎 UnitOfWork ->computeAssociationChanges 在刷新后被调用，并且需要关联对象的 Id。

如果 flush 命令产生错误，我如何在数据库中创建对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T12:24:50.657

问题是由于实体类中的一个重大拼写错误。我通过使用 Symfony 的附加组件检查架构结构找到了它：

```
<?php
namespace Lp\LibBundle\Command;

use Symfony\Component\Console\Input\InputOption;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Output\OutputInterface;
use Symfony\Bundle\DoctrineBundle\Command\Proxy\DoctrineCommandHelper;
use Doctrine\ORM\Tools\Console\Command\ValidateSchemaCommand;

class MyValidateSchemaCommand extends ValidateSchemaCommand
{

/**
 * (non-PHPdoc)
 * @see Tools/Console/Command/Doctrine\ORM\Tools\Console\Command.ValidateSchemaCommand::configure()
 * 
 * Modifies name of the command to be in Doctrine namespace
 * Adds the Helper em for the entity manager which is not defined in Doctrine class 
 * @author ulrich, 09/09/11
 */
protected function configure()
{
    parent::configure();
    $this->setName('doctrine:orm:validate-schema');
    $this->addOption('em', null, InputOption::VALUE_OPTIONAL, 'The entity manager to use for this command');
}

/**
 * (non-PHPdoc)
 * @see Tools/Console/Command/Doctrine\ORM\Tools\Console\Command.ValidateSchemaCommand::execute()
 * 
 * Ajoute le Helper em pour l'entity manager qui n'est pas définis dans la class Doctrine
 * @author ulrich, 09/09/11
 */
protected function execute(InputInterface $input, OutputInterface $output)
{
    DoctrineCommandHelper::setApplicationEntityManager($this->getApplication(), $input->getOption('em'));

            return parent::execute($input, $output);
} 
```

[资料来源：乌尔里希](http://www.mon-code.net/article/26/ajouter-les-lignes-de-commande-doctrine2-a-symfony2)

这允许使用此命令指令来检测实体拼写错误。

```
> php app/console doctrine:orm:validate-schema 
```

# ruby - Nokogiri - 无法将 U+2019 从 UTF-8 转换为 CHANGELOG.ja.rdoc 从 ASCII-8BIT 到 UTF-8 到 US-ASCII，跳过

> ID：14186817
> 
> 赞同：3
> 
> 时间：2013-01-06T21:14:37.707
> 
> 标签：ruby, rubygems, nokogiri

和`gem install nokogiri`

我得到以下回应。

如何修复此错误？

```
Installing ri documentation for nokogiri-1.5.6...
unable to convert U+2019 from UTF-8 to US-ASCII for lib/nokogiri.rb, skipping
unable to convert "\xE3" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for CHANGELOG.ja.rdoc, skipping
unable to convert "\xE8" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for CHANGELOG.rdoc, skipping
unable to convert "\xE9" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.ja.rdoc, skipping
unable to convert "\xE9" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.rdoc, skipping
unable to convert "\xE2" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for ext/nokogiri/xml_node_set.c, skipping
Installing RDoc documentation for nokogiri-1.5.6...
unable to convert U+2019 from UTF-8 to US-ASCII for lib/nokogiri.rb, skipping
unable to convert "\xE3" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for CHANGELOG.ja.rdoc, skipping
unable to convert "\xE8" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for CHANGELOG.rdoc, skipping
unable to convert "\xE9" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.ja.rdoc, skipping
unable to convert "\xE9" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.rdoc, skipping
unable to convert "\xE2" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for ext/nokogiri/xml_node_set.c, skipping 
```

# matlab - 使用低精度 MATLAB 生成随机数

> ID：14186820
> 
> 赞同：4
> 
> 时间：2013-01-06T21:14:50.107
> 
> 标签：matlab, random, precision

我想生成大量随机数（均匀分布在区间[0,1]上）。目前，这些随机数的生成导致我的程序运行非常缓慢，但是程序只需要将它们计算到小数点后 5 位左右。

我不完全确定 MATLAB 是如何生成随机数的，但是如果有一种方法可以只将它们计算到小数点后 5 位，那么它将（希望极大地）加快我的程序。

有没有办法做这样的事情？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:47:23.060

要回答您的问题，是的，您可以生成单精度随机数，如下所示：

```
r = rand(..., 'single');  %Reference: http://www.mathworks.com/help/matlab/ref/rand.html 
```

当打印为十进制时，单精度数字有 7 个（ish）有效数字。

为了回应上面的一些评论，我认为这不会给你带来太多的性能。`rand`如果您的操作真的很慢，那么要做的第一件事就是批量调用。也就是说，而不是：

```
for ix 1:1000
    y = rand(1,1,'single);
end 
```

采用：

```
yVector = rand(1000,1,'single'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T08:36:45.987

如前所述，您可以指示`RAND`将数字直接生成为单精度，并且绝对最好以合适大小的块生成数字。如果您仍然需要更高的性能，并且您有 Parallel Computing Toolbox 和受支持的 NVIDIA GPU，则该`gpuArray.rand`功能可以更快，特别是如果您选择这样的 philox 生成器：

```
parallel.gpu.RandStream('Philox4x32-10') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T09:03:48.273

假设您实际上有一个正确的代码布局，您可以在数组中生成大量数字，这可能是低精度的解决方案。请注意，我尚未测试，但提到它很快：

```
R = randi([0 100000],500,300)/100000 
```

这将生成 150000 个介于 0 和 1 之间的低精度随机数

# c# - XmlException：输入文档已超出 MaxCharactersFromEntities 设置的限制

> ID：14186824
> 
> 赞同：2
> 
> 时间：2013-01-06T21:15:39.767
> 
> 标签：c#, .net, xml, exception

我有一个如下所示的 XML 文件：

```
<!DOCTYPE Root [
<!ELEMENT anEntity (#PCDATA)>
<!ELEMENT 500SuchElementsHere (#PCData)>
<!ENTITY file1 SYSTEM "file1.xml">
...
<!ENTITY file25 SYSTEM "file25.xml">
]>
<Root>
    &file1;
    &file2;
    ...
    &file25;
</Root> 
```

我正在使用这样的 XmlDocument 加载 XML 文件

```
XmlDocument doc = new XmlDocument();
doc.Load("filePath to the above xml file"); 
```

负载抛出标题中提到的异常。我在 Windows 7 Ultimate 上运行 .NET 4.5、VS 2012 Desktop Express。任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T21:28:14.440

您需要使用设置属性[MaxCharactersFromEntities设置为 0 的](http://msdn.microsoft.com/en-us/library/system.xml.xmlreadersettings.maxcharactersfromentities%28v=vs.95%29.aspx)[XmlReader](http://msdn.microsoft.com/en-us/library/system.xml.xmlreader%28v=vs.95%29.aspx)（或适用于您的方案的大数字）：

```
 var doc = new XmlDocument();

        using (var stream = new MemoryStream(Encoding.Default.GetBytes(xml)))
        {
            var settings = new XmlReaderSettings();

            // The default is 0, but setting it here allows us to document exactly why we are taking this approach.
            settings.MaxCharactersFromEntities = 0;

            using (var reader = XmlReader.Create(stream, settings))
            {
                doc.Load(reader);
            }
        } 
```

# java - 为什么线程不等待 notify()？

> ID：14186828
> 
> 赞同：4
> 
> 时间：2013-01-06T21:16:08.697
> 
> 标签：java, concurrency, wait, notify

为什么线程不等待`notify()`？线程启动，然后进入等待池，但在那一刻之后继续执行。

```
public class JavaApplication2 {
    public static void main(String [] args) {
       ThreadB b = new ThreadB();
       synchronized(b) {
           b.start();
           try {
              System.out.println("1");
              b.wait();
         } catch (InterruptedException e) {}
          System.out.println("Total is: " + b.total);
       }
     }
 }
  class ThreadB extends Thread {   
    int total;
      @Override
    public void run() {
        synchronized(this) {
            total += 1;
            //notify();
       }
    }
 } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T21:42:43.143

您正在对线程对象本身进行同步，这是错误的用法。发生的事情是垂死的执行线程总是调用`notify`它的`Thread`对象：`Thread.join` [依赖于 this](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/lang/Thread.java#1258)。因此，很清楚为什么在有和没有你自己`notify`的情况下你会得到相同的行为。

解决方案：使用单独的对象进行线程协调；这是标准做法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-25T12:58:10.283

为终止线程`notifyAll()`的对象调用该方法。`Thread`这一事实奇怪地记录在 的描述中[`Thread.join`](http://docs.oracle.com/javase/8/docs/api/java/lang/Thread.html#join--)，并附有以下句子：

> 当线程终止时，将调用 this.notifyAll 方法。建议应用程序不要在 Thread 实例上使用 wait、notify 或 notifyAll。

因此，如果您没有明确阅读 的描述（`join`不一定必须阅读），您就不会知道奇怪行为的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:20:58.803

您不能依赖于不从等待直到通知返回：“中断和虚假唤醒是可能的”。通常，您应该将等待调用包装在一个循环中，而线程应该继续等待。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T23:25:55.237

如果您尝试在任何对象上同步您的代码，`ThreadB`您会发现它永远不会终止。这是因为有一个对 的隐藏调用`notify`。

尽管我不知道在任何地方都指定了这一点，但 Thread 会在结束时通知自己。这隐含在`join`方法的实现方式中。这是代码`join`：

```
public final synchronized void join(long millis)
throws InterruptedException {
    long base = System.currentTimeMillis();
    long now = 0;

    if (millis < 0) {
        throw new IllegalArgumentException("timeout value is negative");
    }

    if (millis == 0) {
        while (isAlive()) {
            wait(0);
        }
    } else {
        while (isAlive()) {
            long delay = millis - now;
            if (delay <= 0) {
                break;
            }
            wait(delay);
            now = System.currentTimeMillis() - base;
        }
    }
} 
```

（来自JDK7源代码）

如您所见，只有在线程结束后`wait`调用某处调用该调用才有意义。`notify`相同的调用`notify`是允许您的程序终止的原因。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-06T21:59:56.943

您在这两个地方嵌套了同步 {} 构造。这些结构似乎在做一些奇怪的事情：线程根本不会对通知做出反应，只有在 ThreadB (b) 终止时才恢复。删除这个：

```
public class JavaApplication2 {
    public static void main(String[] args) {
        ThreadB b = new ThreadB();
        b.start();
        try {
            System.out.println(" ### Waiting for notify");
            synchronized (b) {
                b.wait();
            }
            System.out.println(" ### Notified");
        } catch (InterruptedException e) {
        }
        System.out.println("### Total is: " + b.total);
    }
}

class ThreadB extends Thread {
    int total;

    @Override
    public void run() {
        total += 1;
        System.out.println(" *** Ready to notify in 5 secs");
        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {
        }
        System.out.println(" *** Notification sent");
        synchronized (this) {
            notify();
        }
        System.out.println(" *** 5 sec post notification");
        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {
        }
        System.out.println(" *** ThreadB exits");
    }
} 
```

上面的代码可能正常工作：在 notify() 出现的情况下，主线程在 5 秒后恢复，在我们看到 ThreadB 终止的消息之前。注释掉 notify() 后，主线程在 10 秒**后**恢复，并且在有关 ThreadB 终止的消息之后，因为 notify() 是从其他代码调用的。Marko Topolnik 解释了这个“幕后” notify() 调用的原因和来源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-23T03:44:38.640

我在阅读 OCP SE 7 时对等待/通知操作进行了相同的测试，很好。我想我们应该让作者解释一下。

# postgresql - Postgresql：使用一个表中的多行从另一个表中获取行

> ID：14186830
> 
> 赞同：1
> 
> 时间：2013-01-06T21:16:13.067
> 
> 标签：postgresql

我正在尝试从我的 quiz_assign 表中选择所有行，这些行的 classid 对应于我的班级表中的一个teacherid。我只需要 quiz_assign 表中的行。

如果从类表中只选择了一行，我构建的查询有效，如果一个teacherid 对应于多个类，我的查询不起作用。

```
$teachersclassesquery = pg_query($db_handle, "SELECT * FROM quiz_assign WHERE classid = (SELECT classid FROM class WHERE teacherid = '$teacherid')"); 
```

如果不更改 quiz_assign 表以包含teacherid，我无法找到一种方法。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:20:06.087

使用`in`代替`=`

```
$teachersclassesquery = pg_query($db_handle, 
  "SELECT * FROM quiz_assign WHERE classid IN (
   SELECT classid FROM class WHERE teacherid = '$teacherid')"); 
```

# javascript - 在 JWPlayer 5.9 中突出显示当前活动的播放列表项

> ID：14186832
> 
> 赞同：0
> 
> 时间：2013-01-06T21:16:36.493
> 
> 标签：javascript, css, jwplayer

我正在尝试突出显示 jwplayer 中当前播放的播放列表项。我使用的是 5.9 版。如果有人有经验并且可能已经做过，请回复并建议我如何做到这一点。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T03:46:23.003

这可以通过使用播放器的“frontcolor”和“lightcolor” flashvars 来完成。

[http://www.longtailvideo.com/support/jw-player/jw-player-for-flash-v5/12536/configuration-options#colors](http://www.longtailvideo.com/support/jw-player/jw-player-for-flash-v5/12536/configuration-options#colors)

这是一个演示 - [http://bit.ly/VvF6VJ](http://bit.ly/VvF6VJ)

# java - 在 Weblogic 终止时触发函数

> ID：14186836
> 
> 赞同：1
> 
> 时间：2013-01-06T21:17:18.373
> 
> 标签：java, weblogic

有没有办法捕获 weblogic 终止事件并触发 Java 函数？

我的weblogic版本是V10.0

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:21:14.027

你可以实现一个`javax.servlet.ServletContextListener`

```
public class MyServletContextListener implements ServletContextListener {
  public void contextInitialized(ServletContextEvent e) {
  }

  public void contextDestroyed(ServletContextEvent e) {
  }
} 
```

并将其添加到 web.xml。

```
<listener>
    <listener-class>MyServletContextListener</listener-class>
</listener> 
```

在那里您可以处理 weblogic 容器的关闭。

# performance - 给定顶点时计算多面体的质心和体积

> ID：14186837
> 
> 赞同：6
> 
> 时间：2013-01-06T21:17:24.247
> 
> 标签：performance, matlab, volume, centroid, polyhedra

给定凸多面体 (3D) 的顶点位置，我需要计算多面体的质心和体积。[Mathworks 网站](http://www.mathworks.com/matlabcentral/fileexchange/8514-centroid-of-a-convex-n-dimensional-polyhedron/content/centroid.m)上提供了以下代码。

```
function C = centroid(P)
k=convhulln(P);
if length(unique(k(:)))<size(P,1)
    error('Polyhedron is not convex.');
end
T = delaunayn(P);
n = size(T,1);
W = zeros(n,1);
C=0;
for m = 1:n
    sp = P(T(m,:),:);
    [null,W(m)]=convhulln(sp);
    C = C + W(m) * mean(sp);
end
C=C./sum(W);
return
end 
```

代码很优雅，但速度非常慢。我需要数百次计算数千个多面体的体积和质心。在当前状态下使用此代码是不可行的。有谁知道更好的方法或者这个代码可以更快吗？我能想到一些小的变化，比如`mean`用表达来代替平均值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-12T15:57:17.250

有一种更简单的方法可以以最小的努力计算体积。第一种风格使用多面体的 3 个局部拓扑信息集，边缘的切线单位向量，该切线上的平面内法线的单位向量和面本身的单位向量（从顶点）。有关详细信息，请参阅[多面体的体积](http://www.ecse.rpi.edu/~wrf/Research/Short_Notes/volume.html)。

根据这篇[Wikipedia 文章](http://en.wikipedia.org/wiki/Polyhedron#Volume)，第二种风格使用面部区域、法线向量和面部重心来计算多面体体积。这两种算法都相当简单，很容易实现，并且通过简单的求和结构也很容易矢量化。我想这两种方法都比对多面体进行完全成熟的镶嵌要快得多。

然后可以通过应用发散定理将整个多面体体积上的积分转换为多面体表面上的积分来计算多面体的质心。详细描述可以在[Calculating the volume and centroid of a polyhedron in 3d 中](http://www2.imperial.ac.uk/~rn/centroid.pdf)找到。我没有检查是否真的需要将多面体细分为三角形，或者是否也可以使用多面体的更复杂的多边形表面，但无论如何，面的区域细分比体积细分要简单得多。总的来说，这种组合方法应该比体积方法快得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:39:33.317

如果你想要精确的解决方案，那么如果 quickhull 不够好，你唯一的选择就是[cudahull 。](http://gpuscience.com/articles/cudahull-fast-parallel-3d-convex-hull-on-the-gpu/)虽然，即使那样，您也只能获得大约 40 倍的最大增幅（似乎）。

我假设您制作的每个凸包至少有 10 个顶点（如果它比这少得多，那么您无能为力）。如果您不介意“足够接近”的解决方案。您可以创建一个版本的 quickhull 来限制每个多边形的顶点数。如果需要，您限制计算的顶点数也将允许计算最大误差。

问题是，当凸包上的顶点数接近无穷大时，你最终会得到一个球体。这意味着由于快速外壳的工作方式，您添加到凸包的每个额外顶点的效果*都比之前的要小。

*根据 quickhull 的编码方式，这可能仅在一般意义上是正确的。在实践中实现这一点需要修改 quickhull 的递归算法，所以虽然总是计算“下一个顶点”（除了在添加最后一个顶点之后，或者该部分没有剩余点），顶点实际上是添加到凸包中使多面体体积增加最大化的顺序（可能按最远到最远的顺序）。跟踪添加顶点的顺序会产生一些性能成本，但只要待处理凸包点与待处理点的比率足够高，就应该值得。至于错误，最好的选择可能是在达到实际凸包时停止算法，或最大音量增加小于当前总音量的某个比例。如果性能更重要，那么只需限制每个多边形的凸包点数。

您还可以查看各种近似凸包算法，但我上面概述的方法应该适用于体积/质心近似并具有确定误差的能力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:56:47.873

你可以加速你的代码多少很大程度上取决于你想如何计算你的质心。请参阅[有关质心计算的答案](https://stackoverflow.com/a/9325812/232610)以获取您的选项。事实证明，如果你需要实心多面体的质心，那你基本上就不走运了。然而，如果只有多面体的顶点有重量，那么你可以简单地写

```
[k,volume] = convhulln(P);
centroid = mean(P(k,:)); 
```

# android - android中的延迟动作

> ID：14186846
> 
> 赞同：12
> 
> 时间：2013-01-06T21:19:17.893
> 
> 标签：android

我想在`imageView`应用启动 5 秒后更改图像。

这是我到目前为止尝试的代码：

```
public class MainActivity extends Activity {
ImageView screen;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    screen=(ImageView)findViewById(R.id.imageView1);

    screen.setImageResource(R.drawable.ic_launcher);

    }
} 
```

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-01-06T21:21:44.980

您可以使用`Handler`，例如：

```
Handler handler = new Handler();
handler.postDelayed(new Runnable() {

    @Override
    public void run() {
        // change image
    }

}, 5000); // 5000ms delay 
```

正如 Sam 在评论中所说，您也可以这样做（因为所有`View`s 都有自己的处理程序）：

```
screen.postDelayed(new Runnable() {

    @Override
    public void run() {
        // change image
    }

}, 5000); // 5000ms delay 
```

请参阅[处理程序文档](http://developer.android.com/reference/android/os/Handler.html#postDelayed(java.lang.Runnable,%20long))。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T06:31:04.303

你可以试试这样的线程：

```
 new Thread(){  
        public void run(){  
            //sleep(5000);
            //refreshSthHere();
        }  
    }.start(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-08-13T09:36:30.527

您可以像 Tom Leese 所说的那样使用 Handler 或 Java Timer

```
new Timer().schedule(new TimerTask() {          
    @Override
    public void run() {
        // this code will be executed after 2 seconds       
    }
}, 2000); 
```

# c++ - 虚拟析构函数性能

> ID：14186849
> 
> 赞同：1
> 
> 时间：2013-01-06T21:19:35.750
> 
> 标签：c++, performance

> **可能重复：**
> [虚函数和性能 - C++](https://stackoverflow.com/questions/449827/virtual-functions-and-performance-c)

我有一些课：

```
class I
{
public:
  virtual void foo() = 0;
protected:
  virtual ~I(){}
}; 
```

该类不提供实例删除的接口，因此使析构函数受保护是很合乎逻辑的解决方案。因此，没有必要将析构函数设为虚拟。但我有虚拟化的代码。

这看起来不是一个大错误，但它对代码性能有很大影响吗？当我们创建虚函数时，我们在虚函数表中添加了一条记录，当我们进行虚调用时，我们在该表中进行搜索。所以这意味着查找时间增加了。我对吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T21:22:53.760

即使这是一个问题（它不是），不，它不会增加时间。查找实际上并不是运行时查找任何东西——vftable 有多大并不重要。它确切地知道在表内跳转的位置。

所以 - 调用一个`virtual`方法有一些成本 - 实际查找没有成本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:24:43.767

通常，您应该始终像`virtual`使用多态类一样声明析构函数。否则，您将遇到以下经典问题：

```
Base *derived = new Derived();
delete derived; 
```

与代码中存在潜在问题相比，对性能的担忧肯定是无关紧要的。今天你不需要删除对象，也许明天你会，如果你忘记了这一点，你最终会产生微妙的错误。

调用的成本是`virtual`存在的，但除非每秒调用数百万个虚拟方法，否则您永远不必担心。

虽然在 vtable 中查找方法不是运行时操作，但它是编译时操作。编译后，您的代码已经知道 vtable 的哪个索引被指定的方法占用。花费的时间是从vtable中间接获取函数的地址。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T23:16:29.167

很好的答案。虚函数调用的成本就像猿猴身上的一根头发。

然而，析构函数通常可能很慢，虚拟与否，因为它真的很容易使你的数据和类结构过于复杂，所以当你删除一些东西时，它可以运行你甚至没有意识到的 27 米的软件正在做。

# java - 从 res/raw 播放 .ogg 文件的 Android 媒体播放器错误 (-4 -4)

> ID：14186850
> 
> 赞同：0
> 
> 时间：2013-01-06T21:19:39.797
> 
> 标签：java, android, media-player

这里有奇怪的问题.. Logcat 在我的媒体播放器代码中向我显示了这个 (-4 -4) 错误。我的应用程序的 res/raw 文件夹中有一个文件`filename.ogg`，我正在尝试播放它。

这是代码：

```
 try {
                        String packageName = getPackageName(); 
                        int resID = getResources().getIdentifier( "filename" , "raw" , packageName );
                        mp.setDataSource("android.resource://" + packageName + "/" + resID);
                        mp.prepare();
                        mp.start();
                    } catch (Exception e) {
                        Toast.makeText(PlayScreen.this, e.toString(), Toast.LENGTH_LONG).show(); 
                    } 
```

我看到的吐司消息说：

`java.io.IOException: Prepare failed.: status=0xFFFFFFFC`

在 eclipse logcat 中，我看到：

`MediaPlayer Error (-4 -4)`

非常感谢任何可以提供帮助的人...我只想播放 res/raw 文件夹中的 .ogg 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:22:54.123

```
int resID = getResources().getIdentifier( "filename" , "raw" , packageName );
                        mp.setDataSource("android.resource://" + packageName + "/" + resID); 
```

而不是 resID 你试过 R.raw.youfilename

# javascript - HammerJS 事件属性未定义

> ID：14186851
> 
> 赞同：7
> 
> 时间：2013-01-06T21:19:40.513
> 
> 标签：javascript, jquery, hammer.js

我正在开发这个小网站：[网站](http://rolandgroza.me)；我正在使用 HammerJS 作为触摸支持库。

它似乎正在响应事件，并且它识别该`event.type`属性，但是当我尝试获取事件的`event.direction`或其他相关属性时`drag`，控制台中没有任何输出（我正在控制台中记录结果）。

这就是我监听`drag`事件的方式“

```
Application.ApplicationController.prototype.Drag = function(selector, delay, callback) {
    return $(selector).on('drag', _.debounce(function(event){
        event.preventDefault();
        return (typeof callback === 'function' && callback !== undefined) ? callback.apply( event, [ event ] ) : 'Argument : Invalid [ Function Required ]';
    }, delay)); 
}; 
```

我称之为：

```
this.Drag(selector, delay, function(event) {
    console.log(event.type, event.direction);
}); 
```

有人可以告诉我我在那里做错了什么或者我错过了什么吗？

**编辑：**我刚刚替换了 jQuery 库：[jquery.specialevents.hammer.js](https://github.com/EightMedia/hammer.js/blob/master/jquery.specialevent.hammer.js)；使用旧的[jquery.hammer.js](https://github.com/EightMedia/hammer.js/blob/master/jquery.hammer.js)；现在似乎它正在响应所有事件并且我得到了我应该得到的所有属性。我仍然想知道为什么我尝试使用的那个不工作？

**编辑：**我找到了问题的根本原因，我的代码依赖于一些库，我正在使用 Yepnope 脚本加载器异步加载这些库，所以在某个地方而不是加载所有库（包括hammer.js 的 jquery 插件） )，其中一些丢失了 :) 我已经解决了这个问题，现在这些事件具有它们应该具有的属性。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T04:25:24.207

> 我仍然想知道为什么我尝试使用的那个不工作？

`jquery.specialevent.hammer.js`理解和之间的区别`jquery.hammer.js`应该有助于理解问题。[的创建者 Damien`jquery.specialevent.hammer.js`解释了原因](http://damien.antipa.at/2012/06/11/hammer-js-with-native-jquery-events/)。

> 然而，Eight Media 决定在 jQuery 中创建自己的命名空间来激活事件。
> 
> ```
> $("#element").hammer({ /* options */ }).on("tap", function(ev) { 
>     console.log(ev); 
> }); 
> ```
> 
> 所以最后他们没有使用默认的jQuery事件系统。这意味着我现有的使用 jQuery 移动事件的源代码必须更改。这就是为什么我决定使用 jQuery 特殊事件 API 来实现 Hammer.JS 的使用。
> 
> ```
> $("#element").on("tap", { /* options */ }, function(ev) {
>     console.log(ev); 
> }); 
> ```
> 
> 我把 jquery.specialevent.hammer.js 放到了我的 Github 上，你也可以在那里找到一个演示。也许八媒体接受了我的拉取请求，它将成为 Hammer.JS 的一部分。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-16T02:51:23.377

`event.gesture.direction`应该给你你正在寻找的东西。

# mysql - 用 MYSQL 处理不明确的列名

> ID：14186853
> 
> 赞同：0
> 
> 时间：2013-01-06T21:19:43.237
> 
> 标签：mysql, sql

我将尽我所能准确地布局我正在尝试做的事情。我正在使用一个房地产数据库，该数据库有 5 个与不同类型的属性（住宅、商业、公寓、土地等）相关的表。该数据库有一个称为 MLS 的表，它将所有常见元素汇集到这些表中的一个表中。我需要查看这些表，其中主要包括来自这个常见 MLS 表的数据，但也包括来自其他几个表的一些特定数据。

我将给出一个示例，其中包括 RESIDENTIAL 和 CONDO 表中存在的字段，但不包括其他表。

在伪代码中

从 MLSTABLE、RESIDENTIALTABLE、CONDOTABLE 中选择 MLSNUMBER、（residential.CommunityAmenities 或 condo.CommunityAmenities）

这是我正在尝试的实际代码，但它给出了不明确的列名错误，因为 CommunityAmenities （和其他字段）存在于多个表中。

```
USE lsh_retsdata;

SELECT
    '',
    mls.mlsnum,
    mls.propertyclassid,
    '',
    mls.streetnumber,
    mls.streetname,
    '',
    mls.areaid,
    mls.streetletter,
    '',
    mls.StreetAddressDisplay,
    mls.remarks,
    mls.remarks,
    mls.city,
    mls.STATE,
    '',
    mls.zipcode,
    mls.countyid,
    "US",
    mls.latitude,
    mls.longitude,
    mls.listprice,
    '',
    '',
    mls.taxamount,
    '',
    totalbedrooms,
    totalfullbaths,
    mls.sqfttotal,
    '',
    mls.acres,
    mls.yearbuilt,
    mls.heatingsystem,
    mls.coolingsystem,
    heatingsource,
    mls.garagedescription,
    mls.garagecapacity,
    mls.zoning,
    '',
    mls.constructiontype,
    mls.roofmaterial,
    waterfrontdesc,
    CONCAT(mls.highschool,CHAR(13),mls.juniorhighschool),
    '',
    mls.style,
    associationfee,
    '',
    '',
    '',
    '',
    OfficeCoListOfficeName,
    '',
    CommunityAmenities
FROM rets_property_mls mls
LEFT JOIN rets_property_mul mul
    ON mls.mlsnum = mul.mlsnum
LEFT JOIN rets_property_auc auc
    ON mls.mlsnum = auc.mlsnum
LEFT JOIN rets_property_com com
    ON mls.mlsnum = com.mlsnum
LEFT JOIN rets_property_llf llf
    ON mls.mlsnum = llf.mlsnum
LEFT JOIN rets_property_cnd cnd
    ON mls.mlsnum = cnd.mlsnum 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:32:40.297

问题是（正如您已经注意到的）MySQL 不知道`CommunityAmenities`您想要哪个。

您可以通过明确说明该字段应来自哪个表来解决此问题：

`mul.CommunityAmenities`

（将 mul 替换为相应的表）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:23:34.220

您需要使用别名来重命名列更有意义:)

```
SELECT t1.CommunityAmenities AS t1CommunityAmenities,
t2\. CommunityAmenities AS t2CommunityAmenities
FROM t1 left join t2 on ... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:37:14.440

如果您有一列可以来自多个表，但只能在一个特定表中（例如在公寓表或住宅表中但不是两者），您可以使用它 `coalesce (condotable.communityamenities, residentialtable.communityamenities)` 来为您提供第一个非空值。（在您的情况下，唯一的非空值）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T21:31:13.617

In your list of selected fields, you need to quality all fields to avoid this error.

For example, instead of just `CommunityAmenities` in SELECT list you should use something like `mls.CommunityAmenities`. Otherwise, server does not know which exact table you meant - you joined many of them, and they all have this field.

# java - 为什么我的 JScrollPane 与示例不同？

> ID：14186859
> 
> 赞同：0
> 
> 时间：2013-01-06T21:20:53.440
> 
> 标签：java, swing, jscrollpane

我正在尝试学习一点 Swing，并且正在尝试[14.46.2.Add 组件到 JScrollPane](http://www.java2s.com/Tutorial/Java/0240__Swing/AddcomponenttoJScrollPane.htm)示例。代码是这样的：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension; 
import java.awt.FlowLayout;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JScrollPane;
import javax.swing.border.LineBorder;

public class AddingToJScrollPane {

public static void main(String args[]) {
  JFrame frame = new JFrame("Tabbed Pane Sample");
  frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

  JLabel label = new JLabel("Label");
  label.setPreferredSize(new Dimension(1000, 1000));
  JScrollPane jScrollPane = new JScrollPane(label);

  JButton jButton1 = new JButton();

  jScrollPane.setHorizontalScrollBarPolicy(JScrollPane.HORIZONTAL_SCROLLBAR_ALWAYS);
  jScrollPane.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
  jScrollPane.setViewportBorder(new LineBorder(Color.RED));
  jScrollPane.getViewport().add(jButton1, null);

  frame.add(jScrollPane, BorderLayout.CENTER);
  frame.setSize(400, 150);
  frame.setVisible(true);
 }
} 
```

从页面中您可以看到预期的结果。

![在此处输入图像描述](../Images/100a7292fc66e403dd7dedfd828aa55f.png)

但是，只需复制和粘贴该代码，我就会得到下图中的结果。我试图了解示例是否已过时或示例图像错误（教程图像上的红色边框在哪里？）。此外，我的滚动条未启用，而我期望它们启用。我是否缺少使它们启用的东西（在教程中它们没问题）？我正在使用JDK7。

![在此处输入图像描述](../Images/c9bf52586360a522f98ec674f6ada204.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:33:23.977

看到红色边框就OK了，就是这行引起的：

```
jScrollPane.setViewportBorder(new LineBorder(Color.RED)); 
```

作为背景信息，您应该知道在 Swing 中为组件设置彩色线边框是一种有用的调试可能性（否则通常很难看到一个组件在哪里结束，另一个组件从哪里开始），所以这里作者可能想调试一些东西截屏后，忘记从代码中删除这一行。

顺便说一句，如果你想学习 Swing，最好的在线资源是“官方”资源：http: [//docs.oracle.com/javase/tutorial/uiswing/components/scrollpane.html](http://docs.oracle.com/javase/tutorial/uiswing/components/scrollpane.html)

编辑：滚动条已启用，不像它们“变灰”，如果单击箭头，则会发生视觉变化。没有什么可以滚动的，因为按钮总是调整为可见区域的大小。正如我所说，这不是一个很好的例子，不要在这里学习......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:29:04.907

代码没问题，边框是红色

```
jScrollPane.setViewportBorder(new LineBorder(Color.RED)); 
```

并且链接中的图像是错误的图像

# javascript - Javascript：在 if 条件中引用此元素

> ID：14186863
> 
> 赞同：0
> 
> 时间：2013-01-06T21:21:05.097
> 
> 标签：javascript, drop-down-menu, if-statement, this, conditional-statements

我正在制作一个脚本，以在菜单按钮悬停（或鼠标悬停）时使子菜单显示为下拉菜单。我使 if 条件引用 this.id="menutoggle1" 并检查它是真还是假。

如果为真，它应该使用语句触发一个函数

```
document.getElementById("submenu1").style.display="inherit"; 
```

它不起作用，但我认为这与我的 if 条件有关。我不太了解条件，但我希望有人能解释为什么这是错误的，甚至可以帮助我解决它。

这是我的代码；

```
function submenu_show()
{
  if(this.id="menutoggle1" == true)
  {
    document.getElementById("submenu1").style.display="inherit";
  }
} 
```

我知道另一种方法可以实现我想要的结果，但是我需要为所有应该有子菜单的菜单选项编写两个函数来显示和两个函数隐藏，这只是混乱和呃。

编辑：我认为如果不完全放弃我的想法，我就无法让它发挥作用，所以我选择了另一种选择。我也意识到，如果写得正确，它毕竟不是那么混乱（毕竟它应该用于几个下拉菜单）。

这是我最终使用的代码；

```
<div id="menubutton1" onmouseover="submenu1_show();" onmouseout="submenu1_hide();"></div>
<div id="submenu1" onmouseover="submenu1_show();" onmouseout="submenu1_hide();"></div>

function submenu1_show()
{document.getElementById("submenu1").style.display="inherit";}
function submenu1_hide()
{document.getElementById("submenu1").style.display="none";} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:26:19.770

在当前代码中，*这*是 merky。它当然不是元素的 ID。您可以在函数中找到元素。

```
function fnName(){
     var el = document.getElementById("...");
     if(el.id === "something"){ ... }
} 
```

如果您想获得针对特定 ID 执行此操作的函数，您只需向 fnName 函数添加一个参数并将该参数传递给 doc.getElByID 函数即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:35:14.563

为什么不使用 jQuery 来为你做这件事呢？通过一点 CSS 和 jQuery 编辑，您可以利用滑动效果和淡入淡出效果以及其他好处。看看使用 jQuery 下拉是多么容易：

```
$('nav ul li a').hover(
    function() {
        $('nav ul li ul').addClass('over');
    },
    function() {
    $('nav ul li ul').removeClass('over');
    }
); 
```

这是一个工作[演示](http://jsfiddle.net/atomicpages/KVeg2/)。我知道它不能回答您的问题，但我希望这对您有所帮助！

# javascript - Firefox 中未调用 XMLHTTPRequest onreadystatechange

> ID：14186869
> 
> 赞同：0
> 
> 时间：2013-01-06T21:21:34.640
> 
> 标签：javascript, xml, http, firefox, request

我到处都检查了与此有关的所有其他问题，但我仍然找不到有效的答案，所以我将其发布在这里。

这是我的代码：

```
var link;

var xhr = new XMLHttpRequest(); 

xhr.onreadystatechange = function() { 

    if (xhr.readyState == 4) { 

        if (xhr.status == 200) { 

            link = xhr.responseText.split("::::")[0];       

    alert(link);
        } 

    } 

} 

var url = "http://youtube.thegoblin.net/banner/getImage.php?name=" + actualName; 

xhr.open("GET", url, true); 

xhr.send(); 
```

现在，这在 Chrome 中工作得非常好，但在 Firefox 中却不行。我知道问题与 onreadystatechange 不与同步 HTTPRequest 一起使用无关，因为这是异步的，并且在 Chrome 中运行良好。我已经尝试将它作为同步请求，但之后的任何内容`xhr.send();`都没有运行，我不知道为什么。

为什么这适用于 Chrome 而不是 Firefox？我怎样才能让它在 Firefox 中工作，谢谢。

* * *

**更新**

我相信问题是因为请求是跨域的。我怎样才能克服这个？

# c# - 在类之间编写共享枚举的最佳实践是什么

> ID：14186873
> 
> 赞同：8
> 
> 时间：2013-01-06T21:21:46.460
> 
> 标签：c#, enums

```
namespace Foo
{
    public enum MyEnum
    {
        High, Low
    }

    public class Class1
    {
        public MyEnum MyProperty { get; set; }
    }
} 
```

`MyEnum`被声明在外面， `Class1` 因为我在这里和其他类中需要它

看起来不错，但是如果我稍后决定删除包含的文件`Class1`怎么办？

`MyEnum`声明会丢失！！

在类之间编写共享枚举的最佳实践是什么？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-06T21:23:27.543

最佳实践是为每个类、枚举或其他类型创建单独的文件。

我的枚举.cs

```
namespace Foo
{
    public enum MyEnum
    {
        High, 
        Low
    }
} 
```

Class1.cs

```
namespace Foo
{
    public class Class1
    {
        public MyEnum MyProperty { get; set; }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T21:23:20.280

> 在类之间编写共享枚举的最佳实践是什么？

将每个枚举都放在一个自己的文件中，并与枚举同名。

```
// Foo\MyEnum.cs
namespace Foo
{
    public enum MyEnum
    {
        High, Low
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-05T07:19:01.947

根据我的经验，最好将显式值添加到字段中，以防您将它们作为整数存储在数据库中，因为更改顺序或添加/删除值可能会在运行时失败：

```
namespace Foo
{
    public enum MyEnum
    {
        High = 1, 
        Low = 2
    }
} 
```

另请注意，我从 1 开始注意未初始化的变量不被视为正确的枚举值。另一个想法是添加 None = 0 值。

# java - 尝试将单词放入数组时的 NPE

> ID：14186875
> 
> 赞同：0
> 
> 时间：2013-01-06T21:21:49.760
> 
> 标签：java, nullpointerexception

正如标题所说，当我试图在我的字符串数组中输入一个单词时，我得到了一个 NPE。

数组在方法之外声明

```
String[] spelersLijst;

    aantalSpelers = Input.readInt();

    for (int g = 0; g < aantalSpelers; g++) {
        String naamSpeler = "Speler " + (g+1);
        spelersLijst [g] = naamSpeler;
    } 
```

我敢肯定这只是我想念的一件小事，但我对这类事情并不擅长。提前致谢

编辑：错误在以下行：

```
spelersLijst [g] = naamSpeler; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T21:23:46.970

您正在尝试将元素插入尚未初始化的数组中。你必须在插入元素之前**初始化你的数组。**

```
String[] spelersLijst;
aantalSpelers = Input.readInt();
   spelersLijst= new String[aantalSpelers ];
for (int g = 0; g < aantalSpelers; g++) {
    String naamSpeler = "Speler " + (g+1);
    spelersLijst [g] = naamSpeler;
} 
```

# django - Django 表单向导 - 第 2 步有 ForeignKey 字段，其实例是在第 1 步中创建的 - 如何验证？

> ID：14186876
> 
> 赞同：3
> 
> 时间：2013-01-06T21:21:50.860
> 
> 标签：django, django-formwizard

我有一个表单向导，在第一步中，创建模型 A 的实例，然后在第二步中，使用 ForeignKey 字段创建模型 B，该字段应包含步骤 1 中的模型 A 实例。因此，用于验证为了工作，我需要在第 1`commit=False`步和第 2 步之间保存第 1 步的表单（也许用户选择后退一步？）。最好的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T01:12:03.820

我认为您可以在重新实现“完成”向导方法时对其进行管理，就在您将表单数据保存到数据库的那一刻（取决于您的最终目标，但如果您使用向导，您可能正在寻找数据将在向导结束时保存）。想想那些：

*   如果用户通过了“第一步”，那么他在这一步中输入的数据是正确的。
*   如果用户通过了“第 2 步”，那么他在这一步中输入的数据也是正确的，以此类推。阅读 django[文档](https://docs.djangoproject.com/en/1.4/ref/contrib/formtools/form-wizard/#how-it-works)的详细信息。

因此，您可以为 B 制作表格，而不必担心“步骤 2”中的“A”数据，因为当您处于向导的“最后一步”时，A 数据将是有效的。我的想法是，您可以只使用您想从 B 保存的数据而不是对 A 的引用来制作 B 表单。例如，如果我们有一个如下所示的 BModel：

```
Class B(models.Model):
    a = models.ForeignKey('A')
    name = models.CharField(max_lenght=50) 
```

您可以为 B 创建一个表单：

```
Class BForm(forms.Form):
    name = forms.CharField(max_length=50) 
```

最后在“完成”方法中，您可以使用`form_list`其所有形式都有效的方法：

```
def done(self, form_list, **kwargs):
    b_data = {}
    for form in form_list:
        # Getting the A instance
        if isinstance(form, AForm):
            a_instance = form.save()
        # Getting B data
        elif isinstance(form, BForm):
            b_data = form.cleaned_data
        else:
            form.save()
    b_data.update({'a': a_instance})
    BModel.objects.create(**b_data)
    return redirect("success_url") 
```

# ironpython - IronPython 和 DynamicObject 覆盖 TryUnaryOperation

> ID：14186877
> 
> 赞同：2
> 
> 时间：2013-01-06T21:21:57.303
> 
> 标签：ironpython, dynamic-language-runtime, short-circuiting

IronPython (2.7.3) 似乎没有使用 ExpressionType.IsFalse 和 ExpressionType.IsTrue 检查 TryUnaryOperation 以执行逻辑 AND 和 OR 操作的短路评估。

这是一个使用继承自 DynamicObject 的类的示例。在 C# 中，它可以完美运行，但如果在 IronPython 表达式中使用会产生错误的结果。这种行为是预期的还是错误的？如何让 IronPython 以与 C# 相同的方式运行？

班上：

```
public class Dyn : DynamicObject
{
    private readonly string text;

    public Dyn(string text)
    {
        this.text = text;
    }

    public override string ToString()
    {
        return this.text;
    }

    public override bool TryBinaryOperation(BinaryOperationBinder binder, object arg, out object result)
    {
        result = new Dyn(this + " " + binder.Operation + " " + arg);
        return true;
    }

    public override bool TryUnaryOperation(UnaryOperationBinder binder, out object result)
    {
        switch (binder.Operation)
        {
            case ExpressionType.IsFalse:
            case ExpressionType.IsTrue:
                result = false;
                return true;
        }

        return base.TryUnaryOperation(binder, out result);
    }
} 
```

用法：

```
dynamic a = new Dyn("a");
dynamic b = new Dyn("b");
dynamic c = new Dyn("c");

var correct = a && b || c;

var engine = Python.CreateEngine();
var scope = engine.CreateScope();
scope.SetVariable("a", a);
scope.SetVariable("b", b);
scope.SetVariable("c", c);
var incorrect = engine.Execute("a and b or c", scope);

Console.WriteLine("Correct: " + correct);
Console.WriteLine("Incorrect: " + incorrect); 
```

印刷：

```
Correct: a And b Or c
Incorrect: b 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T11:22:13.750

无法实现您想要的确切行为，但有一些技巧。

**完整性检查**

首先，让我们观察一下，实际上正在调用重写的方法，并且我们正确实现了`DynamicObject`. 我修改了你的`TryUnaryOperation`：

```
public override bool TryUnaryOperation(UnaryOperationBinder binder, out object result)
{
    Console.WriteLine("TryUnaryOperation was called with operation: {0}", binder.Operation);

    return base.TryUnaryOperation(binder, out result);
} 
```

创建`Dyn`对象并将其传递到范围后，如下所示：

```
dynamic a = new Dyn("a");

var engine = Python.CreateEngine();
var scope = engine.CreateScope();
scope.SetVariable("a", a);
var result = engine.Execute("not a", scope);
Console.WriteLine(result); 
```

按预期打印：

```
TryUnaryOperation was called with: Not 
```

**动机**

在覆盖`TryInvoke`,之后`TryInvokeMember`，`TryConvert`我们可以观察到，它们都没有被调用。冲浪后我发现，短路运算符`and` `or`不能被覆盖，因为：

> 它们更像是控制流工具而不是操作符，并且覆盖它们更像是覆盖如果

考虑 StackOverflow 上的这个问题[Any way to override the and operator in Python？](https://stackoverflow.com/questions/471546/any-way-to-override-the-and-operator-in-python)

**关闭解决方案**

但是有一种方法可以覆盖逻辑运算符`&`和`|`. 您的源代码`Dyn`如下

```
public class Dyn : DynamicObject
{
    private readonly string text;

    public Dyn(string text)
    {
        this.text = text;
    }

    public override string ToString()
    {
        return this.text;
    }

    public object __and__(Dyn other)
    {
        return new Dyn(this + " and " + other);
    }

    public object __or__(Dyn other)
    {
        return new Dyn(this + " or " + other);
    }
} 
```

然后在调用下一个代码后它成功打印`a and b or c`

```
dynamic a = new Dyn("a");
dynamic b = new Dyn("b");
dynamic c = new Dyn("c");

var engine = Python.CreateEngine();
var scope = engine.CreateScope();

scope.SetVariable("a", a);
scope.SetVariable("b", b);
scope.SetVariable("c", c); 

var correct = engine.Execute("a & b | c", scope);
Console.WriteLine(correct); 
```

**注意：**即使您覆盖`TryGetMember`- 它仍然不会在`a & b`表达式中调用。期望它会用`a.Name`表达式甚至. 调用是完全安全的`a.Name()`。您可以使用下一个代码进行验证

```
public override bool TryGetMember(GetMemberBinder binder, out object result)
{
    result = "test";
    return true;
} 
```

并称它为`a.Name`or `a.Name()`。稍后调用会导致“str is not callable”消息错误。

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T01:48:20.500

我认为使用运算符重载来获取语法树并不是最好的方法。可能最好遍历语法树并从中提取您需要的信息。遗憾的是，C# lambda 表达式的 AST 与 IronPython AST 不兼容。所以我设置了一个转换过程来将 IronPython AST 转换为 Linq AST。

```
 static void Main(string[] args)
    {
        var a = true;
        var b = true;
        var c = true;
        Expression<Func<bool>> csAst = () => a && b || c;
        var csexpr = csAst.Body;
        Console.WriteLine(csexpr.ToString());

        ScriptEngine engine = Python.CreateEngine();
        ScriptScope scope = engine.CreateScope();
        scope.SetVariable("a", a);
        scope.SetVariable("b", b);
        scope.SetVariable("c", c);
        string code = "a and b or c";
        var pyexpr = GetLinqExpressionFromPyExpression(code, scope);
        Console.WriteLine(pyexpr.ToString());
    } 
```

输出是：

```
((value(Parse.Program+<>c__DisplayClass0).a AndAlso value(Parse.Program+<>c__DisplayClass0).b) OrElse value(Parse.Program+<>c__DisplayClass0).c)
((a AndAlso b) OrElse c) 
```

这是（不完整的）转换过程：

```
 static System.Linq.Expressions.Expression GetLinqExpressionFromPyExpression(string pyExpression, ScriptScope scope)
    {
        ScriptEngine engine = scope.Engine;
        ScriptSource source =
            engine.CreateScriptSourceFromString(pyExpression, SourceCodeKind.Expression);
        SourceUnit sourceUnit = HostingHelpers.GetSourceUnit(source);
        LanguageContext context = HostingHelpers.GetLanguageContext(engine);
        Parser parser = Parser.CreateParser(
            new CompilerContext(sourceUnit, context.GetCompilerOptions(), ThrowingErrorSink.Default),
            (PythonOptions)context.Options);
        PythonAst ast = parser.ParseFile(true);
        SuiteStatement suite = (SuiteStatement)ast.Body;
        ExpressionStatement statement = (ExpressionStatement)suite.Statements[0];
        IronPython.Compiler.Ast.Expression expression = statement.Expression;

        return Convert(expression, scope);
    }

    static readonly Dictionary<PythonOperator, ExpressionType> linqOpFromPyOp = new Dictionary<PythonOperator, ExpressionType>{
        { PythonOperator.Not, System.Linq.Expressions.ExpressionType.Not },
        { PythonOperator.Pos, System.Linq.Expressions.ExpressionType.UnaryPlus },
        { PythonOperator.Invert, System.Linq.Expressions.ExpressionType.OnesComplement },
        { PythonOperator.Negate, System.Linq.Expressions.ExpressionType.NegateChecked },
        { PythonOperator.Add, System.Linq.Expressions.ExpressionType.AddChecked },
        { PythonOperator.Subtract, System.Linq.Expressions.ExpressionType.SubtractChecked },
        { PythonOperator.Multiply, System.Linq.Expressions.ExpressionType.MultiplyChecked },
        { PythonOperator.Divide, System.Linq.Expressions.ExpressionType.Divide },
        { PythonOperator.TrueDivide, System.Linq.Expressions.ExpressionType.Divide },
        { PythonOperator.Mod, System.Linq.Expressions.ExpressionType.Modulo },
        { PythonOperator.BitwiseAnd, System.Linq.Expressions.ExpressionType.And },
        { PythonOperator.BitwiseOr, System.Linq.Expressions.ExpressionType.Or },
        { PythonOperator.ExclusiveOr, System.Linq.Expressions.ExpressionType.ExclusiveOr },
        { PythonOperator.LeftShift, System.Linq.Expressions.ExpressionType.LeftShift },
        { PythonOperator.RightShift, System.Linq.Expressions.ExpressionType.RightShift },
        { PythonOperator.Power, System.Linq.Expressions.ExpressionType.Power },
        //{ PythonOperator.FloorDivide, System.Linq.Expressions.ExpressionType.Divide }, // TODO
        { PythonOperator.LessThan, System.Linq.Expressions.ExpressionType.LessThan },
        { PythonOperator.LessThanOrEqual, System.Linq.Expressions.ExpressionType.LessThanOrEqual },
        { PythonOperator.GreaterThan, System.Linq.Expressions.ExpressionType.GreaterThan },
        { PythonOperator.GreaterThanOrEqual, System.Linq.Expressions.ExpressionType.GreaterThanOrEqual },
        { PythonOperator.Equal, System.Linq.Expressions.ExpressionType.Equal },
        { PythonOperator.NotEqual, System.Linq.Expressions.ExpressionType.NotEqual },
        //{ PythonOperator.In, System.Linq.Expressions.ExpressionType. }, // TODO
        //{ PythonOperator.NotIn, System.Linq.Expressions.ExpressionType. }, // TODO
        //{ PythonOperator.IsNot, System.Linq.Expressions.ExpressionType.TypeIs }, // TODO
        { PythonOperator.Is, System.Linq.Expressions.ExpressionType.TypeIs },
    };

    static System.Linq.Expressions.Expression Convert(IronPython.Compiler.Ast.Expression node, ScriptScope scope)
    {
        switch (node.NodeName)
        {
            case "AndExpression":
                {
                    var _node = (IronPython.Compiler.Ast.AndExpression)node;
                    return System.Linq.Expressions.BinaryExpression.AndAlso(
                        Convert(_node.Left, scope), 
                        Convert(_node.Right, scope));
                }
            case "BinaryExpression":
                {
                    var _node = (IronPython.Compiler.Ast.BinaryExpression)node;
                    // TODO: do conversion if left and right have different types
                    return System.Linq.Expressions.BinaryExpression.MakeBinary(
                        linqOpFromPyOp[_node.Operator],
                        Convert(_node.Left, scope),
                        Convert(_node.Right, scope));
                }
            case "OrExpression":
                {
                    var _node = (IronPython.Compiler.Ast.OrExpression)node;
                    return System.Linq.Expressions.BinaryExpression.OrElse(
                        Convert(_node.Left, scope),
                        Convert(_node.Right, scope));
                }
            case "NameExpression":
                {
                    var _node = (IronPython.Compiler.Ast.NameExpression)node;
                    return System.Linq.Expressions.Expression.Parameter(
                        scope.GetVariable(_node.Name).GetType(), 
                        _node.Name);
                }
            // TODO: Add further Python Expression types
            default:
                throw new ArgumentTypeException("unhandled NodeType '" + node.NodeName + "'");
        }
    }

    internal class ThrowingErrorSink : ErrorSink
    {
        public static new readonly ThrowingErrorSink/*!*/ Default = new ThrowingErrorSink();

        private ThrowingErrorSink() { }

        public override void Add(SourceUnit sourceUnit, string message, SourceSpan span, int errorCode, Severity severity)
        {
            if (severity == Severity.Warning)
            {
                PythonOps.SyntaxWarning(message, sourceUnit, span, errorCode);
            }
            else
            {
                throw PythonOps.SyntaxError(message, sourceUnit, span, errorCode);
            }
        }
    } 
```

# c - C错误“可变大小的对象可能未初始化”

> ID：14186879
> 
> 赞同：3
> 
> 时间：2013-01-06T21:22:02.720
> 
> 标签：c, arrays

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-06T21:23:40.270

您的两个数组是*可变长度数组*。您不能在 C 中初始化可变长度数组。

要将数组的所有`int`元素设置为`0`您可以使用该`memset`函数：

```
memset(plansza, 0, sizeof plansza); 
```

顺便说一下，初始化一个不是可变长度数组的数组，初始化所有元素的有效形式`0`是：

```
int array[31][14] = {{0}};  // you need the {} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:30:05.827

If both dimensions are unknown, you'll have to use a one-dimensional array, and do the indexing yourself:

```
int *ary = (int *) malloc(x * y * sizeof(int));
memset(ary, 0, x * y * sizeof(int));
int elem1_2 = ary[1 * x + 2];
int elem3_4 = ary[3 * x + 4]; 
```

and so on. You better define some macros or access functions. And free the memory after use.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:53:23.000

替代@Chris 的建议：

您可以将二维数组创建为一维数组的数组。这将允许您像以前一样进行数组元素索引。请注意，在这种情况下，数组是在堆中分配的，而不是在堆栈中。因此，当您不再需要该数组时，您*必须*清理分配的内存。

例子：

```
#include <malloc.h>
#include <string.h>

/* Create dynamic 2-d array of size x*y.  */
int** create_array (int x, int y)
{
  int i;
  int** arr = (int**) malloc(sizeof (int*) * x);
  for (i = 0; i < x; i++)
    {
      arr[i] = (int*) malloc (sizeof (int) * y);
      memset (arr[i], 0, sizeof (arr[i]));
    }
  return arr;
}

/* Deallocate memory.  */
void remove_array (int** arr, int x)
{
  int i;
  for (i = 0; i < x; i++)
    free (arr[i]);
  free (arr);
}

int main()
{
  int x = 5, y = 10;
  int i, j;
  int** plansza = create_array (x, y); /* Array creation.  */
  plansza[1][1] = 42; /* Array usage.  */
  remove_array (plansza, x); /* Array deallocation.  */
  return 0;
} 
```

# android - 我的线程在 Android 上的交换速度不够快

> ID：14186884
> 
> 赞同：0
> 
> 时间：2013-01-06T21:22:28.050
> 
> 标签：android, multithreading, synchronization

所以我的应用程序上有 2 个线程（除其他外），一个修改对象（在示例中，设置矩形的位置）并调用方法，以便第二个线程可以在网络上发送它。

第一个线程：

```
 public void run(){
        while(mIsRunning){
            Log.i("MovingRectThread", "Run");
                mX += 10;
                mRect.setPos(mX,mY);
                //Send Rect
                mInterface.writeData(mRect);
                try {
                    Thread.sleep(10);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }
    } 
```

第二个线程：

```
public void run(){  
    int commandSize=-1;
    byte[] bufferR = new byte[ANSWER_SIZE];
    int answerResult = 0;

    while(mIsRunning){
        Log.i("ProcessThreadGraphic", "Run");

        switch(mState){
        case IDLEREAD:
            //****************
                    try {
                        commandSize = mmInStream.read(bufferR, 0, ANSWER_SIZE);
                    } 
                    catch (IOException e) {
                        connectionLost();
                    }

                    // We received something
                    if(commandSize != -1 && bufferR[0] == 0x02){
                        answerResult = bufferR[2];
                                                    if(answerResult == 0){
                            //Authorize sending again
                            mState = IDLEWRITE;
                        }
                    }
            //*********************
            break;
        case IDLEWRITE:
            //Trying to send something
            if(mBuffer != null ){
                try {
                    mmOutStream.write(mBuffer);
                    mBuffer = null;
                    mState = IDLEREAD;
                    Thread.yield();
                } catch (IOException e) {
                    connectionLost();
                }
            }
            //**************
            break;
        default:
            Log.e(TAG, "Error: state unknown");
            break;
        }
        try {
            Thread.sleep(1);
        } catch (InterruptedException e) {
            e.printStackTrace();
        } 
    }
} 
```

并且 mInterface.writeData 只结束调用：

```
 public void write(byte[]buffer){
    mBuffer = buffer;

    } 
```

我的问题是，线程不能很好地协同工作：一个在另一个重新启动之前循环多次，这不符合您可能想象的我的需要，我需要第一个修改我的对象一次，然后是第二个线程发送它，然后仅再次修改对象...

希望我已经足够清楚了。

# windows-phone-7 - OCR 用于扫描打印的收据。

> ID：14186885
> 
> 赞同：2
> 
> 时间：2013-01-06T21:22:35.187
> 
> 标签：windows-phone-7, ocr

> **可能重复：**
> [OCR 软件能否可靠地从表中读取值？](https://stackoverflow.com/questions/6173439/can-ocr-software-reliably-read-values-from-a-table)

这是这篇文章的后续内容 - [OCR 软件能否可靠地从表中读取值？](https://stackoverflow.com/questions/6173439/can-ocr-software-reliably-read-values-from-a-table?rq=1)

我的问题是 - OCR 是否可以扫描带有打印项目名称和价格值的**收据？**我目前正在使用 Project Hawaii 的 OCR 服务为 Windows Phone 7 开发应用程序。如果是，我该怎么做？

# php - 如何读取 public_html 内但域外的文件？使用相对路径

> ID：14186886
> 
> 赞同：1
> 
> 时间：2013-01-06T21:22:38.427
> 
> 标签：php, html, shared-hosting

我正在尝试从我的（附加）域目录之外的目录中读取文件。这是我的目录结构：

```
public_html /
    domain /
        file_read.php
        file_write.php

    sensitive /
        file.dat 
```

尽管我可以使用“../sensitive/file.dat”写入敏感信息，但我无法使用相同的方法进行阅读。任何想法为什么？

我没有使用绝对路径，因为它会出现在 html 源代码中。public_html 所属的域未被使用。

[编辑] 按要求共享一些代码：

file_write.php（敏感的也会有图片）：

```
mkdir ("../sensitive/dir", 0755);
copy ("resource/in/root/file.jpg", "../sensitive/dir/file.jpg");
move_uploaded_file ($_FILES['file']['tmp_name'], "../sensitive/dir/newfile.jpg"); 
```

file_read.php（什么都不显示）

```
<img src="../sensitive/dir/newfile.jpg" width="400" height="400"> 
```

我正在观察敏感文件，一切都写得很好。我还手动将 newfile.jpg 的权限从 644 调整到 744 再到 755，但没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:01:20.817

正如您所提到`sensitive`的，它在域目录之外。因此这将不起作用：

```
<img src="../sensitive/dir/newfile.jpg" width="400" height="400"> 
```

哪个好！否则任何人都可以`www.example.com/../sensitive/all/your/files.dat`

并有权访问敏感目录。

如果你想访问这个目录中的文件，你可以编写一个 php 页面，给出一些信息返回图像（确保这是安全的，否则人们将能够访问敏感目录）。

此问题提供有关输出图像的信息：[Output an Image in PHP](https://stackoverflow.com/q/1851849/505722)

# nunit - 在 NUnit 中构建和加载文件

> ID：14186888
> 
> 赞同：0
> 
> 时间：2013-01-06T21:22:44.780
> 
> 标签：nunit

我正在关注一本名为“单元测试的艺术”的书。我已经到了需要测试我使用 NUUnit 编写的测试方法的地步。作者指示构建项目，然后找到构建的程序集文件的路径，并给出 NUnit 的路径进行测试。

我的问题是我似乎无法获取此程序集文件路径。它位于哪里？

另外，当我运行我的代码时，我收到以下错误：

```
 Error    2   Program 'c:\Users\Documents\Visual Studio 2012\Projects\Loganalyzer\Loganalyzer\obj\Debug\Loganalyzer.exe' does not contain a static 'Main' method suitable for an entry point  c:\users\documents\visual studio 2012\Projects\Loganalyzer\Loganalyzer\CSC  Loganalyzer 
```

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Loganalyzer
{
    public class LogAnalyzer
    {
        public bool IsValidLogFileName(string fileName)
        {
            if (!fileName.EndsWith(".SLF"))
            {
                return false;
            }
            return true;
        }
    }
} 
```

我正在按照书中的确切示例进行操作，但如您所见，无法使其正常工作。我会感谢你们的帮助。

```
using Loganalyzer;
using NUnit.Framework;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace LogAnalyzerTest
{
    [TestFixture]
    class LogAnalyzerTest
    {

        [Test]
        public void IsValidFileName_validFile_ReturnsTrue()
        {
            //Arrange ( Arranges objects, creating and setting them up as necessary). 
            LogAnalyzer analyzer = new LogAnalyzer();

            //Act 
            bool result = analyzer.IsValidLogFileName("whatever.SLF"); 

            //Assert ( Asserts that something is as expected) 
            Assert.IsTrue(result, "file name should be valid"); 
        } 

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T05:16:29.883

似乎您正在尝试运行您的类项目 Loganalyzer，但您可能想要使用某种测试运行器。我更喜欢 TestDriven.net。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T16:21:23.990

NUnit 只是测试框架（非常简化，它指定了如何设置测试等的规则）。

您需要的是一些应用程序或插件来实际运行它们。您可以在[concole runner](http://nunit.com/index.php?p=nunit-console&r=2.6.1)或 NUnit 附带的[GUI runner](http://nunit.com/index.php?p=nunit-gui&r=2.6.1)中运行测试，或者在 TestDriven.net（我听说它非常好）中运行测试。

就个人而言，我使用[Resharper](http://www.jetbrains.com/resharper/)附带的跑步者（尽管只能免费试用一个月左右）。

关键是你没有一个可执行的项目，而是一个包含要测试的东西的类库。运行程序运行您的测试，然后调用您的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-02T15:49:19.807

如果您想使用本机 nunit 运行器，您通常使用这样的类

```
static class NUnitLauncher
{
    [STAThread]
    static void Main()
    {
        AppEntry.Main(new[] { Assembly.GetExecutingAssembly().Location });
    }
} 
```

您还必须将其设置为启动对象（在项目的属性中）。

您还需要参考 nunit-gui-runner.dll，您可以在 nunit 安装目录（通常是程序文件）中找到它。我的在

```
C:\Program Files (x86)\NUnit 2.5.7\bin\net-2.0\lib 
```

本地 nunit 运行器有问题，但我发现 resharper (6.1) 测试运行器在调试时不稳定 - 它有时会随机爆炸。它也不了解您可以在 nunit 中进行的所有不同类型的参数化测试。希望在较新的版本中不是这种情况——它有一个更好的用户界面。

您上面描述的问题是两件不同的事情 - 一件听起来像是因为您没有设置启动对象；另一个听起来像是对程序集的混淆。编译时生成的可执行文件将包含一个程序集 - 如果您将 nunit 指向它，那么它应该可以工作（假设它有一些 nunit 东西在那里（例如用 [Test] 标记的东西等））

# php - 动态页面：包括特定内容的特定旁白

> ID：14186892
> 
> 赞同：2
> 
> 时间：2013-01-06T21:23:04.370
> 
> 标签：php

我有以下代码来动态包含页面：

```
<div id="content">
    <div id="aside">
        ...
    </div>

    <div id="main">
        <?php
        $page = (isset($_GET['page'])) ? sanitize($_GET['page']) : 'home';
        if (!include 'pages/'.$page.'.php') require 'pages/404.php';
        ?>
    </div>
</div> 
```

如您所见，`#aside`具有静态内容。我想根据所选页面
包含特定内容。`#aside`例如，如果用户转到“主页”和“关于”，我希望将“默认”放在一边。但是，如果用户转到“文档”，我希望将“部分”放在一边。
我知道我可以将每个页面都包含在内，但这并不有效。我也不希望用户能够将放在一边作为主要内容，因此它们必须位于不同的文件夹或其他东西中。
我想知道一种有效且不那么复杂的方法来做到这一点。

感谢您花时间阅读本文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:27:01.787

您希望在数据库中的哪个页面上保留哪个侧边栏，然后查询该数据库以包含正确的侧边栏。

表结构可能如下所示：

*   表格*侧边栏*：ID | 路径 | 姓名 | 更多信息在侧边栏...
*   表*页*：ID | 路径 | 姓名 | 更多信息在页面...
*   表格*侧边栏到页面*：page_ID | sidebar_ID

这种方法甚至允许您在特定页面上放置多个侧边栏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T21:53:14.800

有几种不同的方法可以做到这一点，它们或多或少都是平等的。我几乎总是为站点使用 config.php 文件来保存我希望每个页面拥有的任何全局信息。在每一页的顶部，您只需调用

```
<?php 

    require_once('config.php');

?> 
```

在该 config.php 文件中，您可以有一个数组列出您的页面名称和您希望为每个页面包含的文件，以及一个返回内容的函数，如下所示：

```
// this lets you call includes relative to the site root
set_include_path($_SERVER['DOCUMENT_ROOT']);

$defaultAsideContent = 'includes/default.php';

$asideContent = array(
    'index.php' => 'includes/include-1.php',
    'document.php' => 'includes/include-2.php'
);

function getAsideContent() {

    global $asideContent;
    global $defaultAsideContent;

    $content = $defaultAsideContent;

    // get the requested page
    $pageFull = $_SERVER['REQUEST_URI'];
    // strip URL variables
    $pageParts = explode('?', $pageFull);
    $page = $pageParts[0];

    // loop throught the array and see if there is specific aside content for the page
    foreach($asideContent as $key=>$value) {
        if ($page == $key) {
           $content = $asideContent[$key]);
        }
    }

    include($content);
} 
```

最后，无论你想让你的旁白内容出现在哪里，只要做

```
<?php getAsideContent(); ?> 
```

当你创建一个新页面时，如果你想要特定的内容，只需编辑你的配置文件。仅供参考，根本没有测试这个，可能有错误，但你明白了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-09T02:36:55.440

如果你这样做了怎么办？

```
<?php
ob_start();
$page = (isset($_GET['page'])) ? sanitize($_GET['page']) : 'home';
if (!include 'pages/'.$page.'.php') require 'pages/404.php';
$contents = ob_get_clean();
?>
<div id="content">
    <div id="aside">
        <?php include($aside); ?>
    </div>

    <div id="main">
        <?php echo $contents; ?>        
    </div>
</div> 
```

$page.php 看起来像：

```
<?php $aside = "sidebars/default.php"; ?>
<p>HTML for #main<br />
goes here</p> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T15:23:26.550

Thank you all for your answers and collaboration. Although none of the answers did exactly what I was looking for, they showed me other ways to approach this issue and guided me to decide what method to use.
I came up with what I think is the simpliest way to do this:

1.  I set my folder structure as: **pages/aside** and **pages/main**
2.  I set up an array($asides) with the **aside** files as the *keys* and the **main** content files as the *values*.
3.  Then I check if the requested file exists in the **main** folder.
4.  **If it doesn't exist**, I redirect the user to the 404 page. **If it does exist**, I loop through *$asides* to see which *aside* is asigned to that *main* content page.
5.  If it doesn't belong to any of the establisged *asides*, then I include the **default** aside.

```
$asides = array(
        'aside1' => array('page1', 'page2', 'page3', 'page4'),
        'aside2' => array('page5', 'page6')
    );

$page = (!empty($_GET['p'])) ? sanitize($_GET['p']) : 'page1';

if (file_exists("pages/main/{$page}.php")) {

    foreach ($asides as $key => $value) {
        if (in_array($page, $asides[$key])) {
            $aside = $key;
            break;
        }
    }
    if (!isset($aside)) $aside = 'default';

?>
    <div id="aside"><?php require "pages/aside/{$aside}.php"; ?></div>
    <div id="main"><?php require "pages/main/{$page}.php"; ?></div>
<?php

} else {
    header('Location: ?p=404');
} 
```

The bounty goes to **Madara Uchiha** because in my opinion, his answer is simple an effective. Thanks again to all of you who helped me with this issue.

# android - 模拟来自串行连接的键盘输入

> ID：14186893
> 
> 赞同：2
> 
> 时间：2013-01-06T21:23:05.910
> 
> 标签：android, bluetooth, serial-port, keyevent

我正在编写我的第一个 Android 应用程序，现在遇到了我找不到答案的第一个问题。

我使用串行通信配置文件建立了蓝牙连接。我需要从此连接接收数据（它已经工作），然后我想将字符串（长度在 5 到 20 个字符之间）交给 web 视图，在那里它应该像键盘输入一样处理（意味着有焦点的字段得到填充数据）。

我用 KeyEvent 和 dispatchKeyEvent 进行了尝试（它似乎有效），但我不确定这种情况下的最佳做法是什么。因此，非常感谢您的反馈。

# lucene - 嵌套可枚举对象的 ElasticSearch 映射 (i18n)

> ID：14186894
> 
> 赞同：1
> 
> 时间：2013-01-06T21:23:07.427
> 
> 标签：lucene, indexing, full-text-search, elasticsearch

我不知道如何使用以下结构映射文档以进行搜索：

```
{
  "_id": "007ff234cb2248",
  "ids": {
    "source1": "123",
    "source2": "456",
    "source3": "789"
  }
  "names": [
    {"en":"Example"}, 
    {"fr":"exemple"}, 
    {"es":"ejemplo"},
    {"de":"Beispiel"}
  ],
  "children" : [
    {
      "ids": {
        "source1": "CXXIII",
        "source2": "CDLVI",
        "source3": "DCCLXXXIX",
      }
      names: [
        {"en":"Example Child"}, 
        {"fr":"exemple enfant"}, 
        {"es":"Ejemplo niño"},
        {"de":"Beispiel Kindes"}
      ]
    }
  ],
  "relatives": {
    // Typically no "ids" at this level.
    "relation": 'uncle',
    "children": [
      {
        "ids": {
          "source1": "0x7B",
          "source2": "0x1C8",
          "source3": "0x315"
        },
        "names": [
          {"en":"Example Cousin"}, 
          {"fr":"exemple cousine"}, 
          {"es":"Ejemplo primo"},
          {"de":"Beispiel Cousin"}
        ]
      }
    ]
  }
} 
```

该`child`对象可能`children`直接出现在该部分中，或者进一步嵌套在我的文档中`uncle.children`（在这种情况下是表兄弟）。IDs 字段为第一层（根）、第二层（孩子和叔叔）和第三层（堂兄弟）所共有，命名结构也为第一层和第三层所共有。

我的用例是能够按前缀和整个 ID 搜索 ID（嵌套对象）。并且还能够按照一组（*尚未定义*的）分析器规则搜索子名称。

我还没有找到以任何有用的方式映射这些的方法。我不相信对`ids`and使用相同的技术会取得很大的成功`names`，因为在名称和文档根之间存在额外级别的映射。

我什至不确定它**是否可以映射**。我至少在原则上相信`ids`应该可以映射为术语，也许如果我`names`以某种方式索引 as 术语，也是。

我简直不知所措，文档似乎没有涵盖这种级别的复杂映射。

我对来自 CouchDB 河的文档的控制有限（阅读：否），并且上游应用程序已经依赖于这种格式，所以我无法*真正*更改它。

我正在寻找能够通过以下伪条件进行搜索，所有这些都应该匹配：

*   ID：`"123"`
*   来源 ID（我不知道如何最好地用伪语言标记）
*   身份证前缀：`"CDL"`
*   姓名：`"Example"`,`"Example Child"`
*   本地化名称（我什至不知道如何最好地对其进行伪标记！

当我至少知道如何映射时，我可以自己弄清楚标记化和分析的细节

*   对象属性的键和值都很重要时的对象
*   当键和值很重要时的可枚举对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T12:00:45.300

如果从 ID 到其子项的映射是一对多，那么您可以将子项的名称存储在**子**字段中，因为一个字段可以有多个值。然后每个文档将有一个**ID**字段，可能是一个**关系**字段，以及零个或多**个子**字段。

# c# - LINQ to XML“System.Exception：值不能为空”

> ID：14186896
> 
> 赞同：-1
> 
> 时间：2013-01-06T21:23:13.987
> 
> 标签：c#, linq, linq-to-xml

我正在使用 C# 中的 LINQ to XML。我有以下代码，最后一行不断抛出 System.Exception: Value cannot be null。我无法弄清楚问题是什么。我什么都试过了。AuthorizedToSign 是一个列表。我能够使用庞大的嵌套 foreach 循环执行相同的操作。我确信就 XML 文件本身而言没有错误。如果有人可以提供帮助，我将不胜感激。

```
BusinessAccounts = (from a in accountRoot.Elements()
where (bool)a.Element("Business") == true
select new BusinessAccount()
{
OpenDate = (DateTime)a.Element("DateOpened"),
Password = a.Element("Password").Value,
Balance = (double)a.Element("Balance"),
AccountStatus = (Status)Enum.Parse(typeof(Status), a.Element("Status").Value),
//Element AuthToSign has a collection of sub-elements called "authName"
//couldn't get the code below to work
AuthorizedToSign = (from el in a.Element("AuthorizedToSign").Elements()
                    select el.Element("AuthName").Value).ToList()
                                }).ToList(); 
```

更改`select el.Element("AuthName").Value)` 为 `select (string)el.Element("AuthName"))` 无济于事。

XML 文件有很多如下所示的条目：

```
<?xml version="1.0" encoding="utf-8"?>
<Accounts>
  <BusinessAccount>
    <Business>true</Business>
    <AccountNumber>34534456</AccountNumber>
    <AccountBranchID>100</AccountBranchID>
    <AccountName>Elgris Tech</AccountName>
    <CompanyName>Elgris Tech</CompanyName>
    <CompanyID>235</CompanyID>
    <CreditLimit>50000</CreditLimit>
    <DateOpened>2014-12-13T00:00:00</DateOpened>
    <Balance>1200</Balance>
    <Password>1234</Password>
    <Status>Active</Status>
    <AuthorizedToSign>
      <AuthName>Yechiel</AuthName>
      <AuthName>Lev</AuthName>
      <AuthName>Roman</AuthName>
    </AuthorizedToSign>
  </BusinessAccount>
  <PrivateAccount>
    <Business>false</Business>
    <AccountNumber>34534458</AccountNumber>
    <AccountBranchID>100</AccountBranchID>
    <AccountName>Yechiel L.</AccountName>
    <CustomerName>Yechiel L.</CustomerName>
    <CustomerAddress>2sadfasosa, CA</CustomerAddress>
    <CustomerPhone>8-4268</CustomerPhone>
    <CardNumber>304456</CardNumber>
    <CreditLimit>10000</CreditLimit>
    <DateOpened>1994-06-23T00:00:00</DateOpened>
    <Balance>555000</Balance>
    <Password>pass</Password>
    <Status>Active</Status>
  </PrivateAccount>
</Accounts> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:33:24.790

更新

根据您的 xml，`PrivateAccount`元素没有`AuthorizedToSign`节点，因此引用`AuthorizedToSign`节点会引发异常。因此，在您的情况下，解决方案将很简单：

```
from a in accountRoot.Elements()
let authorized = a.Element("AuthorizedToSign")
where (bool)a.Element("Business")
select new BusinessAccount()
{
    OpenDate = (DateTime)a.Element("DateOpened"),
    Password = (string)a.Element("Password"),
    Balance = (double)a.Element("Balance"),
    AccountStatus = (Status)Enum.Parse(typeof(Status), (string)a.Element("Status")),
    AuthorizedToSign = authorized == null ? null : // or new List<string>()
                       authorized.Elements()
                                 .Select(auth => (string)auth)
                                 .ToList()
}; 
```

使用查询语法获取授权名称：

```
AuthorizedToSign = authorized == null ? null : // or new List<string>()
                   (from auth in authorized.Elements()
                    select (string)auth).ToList() 
```

# jquery - 图片网址：data:image/png;base64 (KineticJS)

> ID：14186906
> 
> 赞同：3
> 
> 时间：2013-01-06T21:23:58.927
> 
> 标签：jquery, image, html, canvas, kineticjs

当使用 KineticJS[生成 canvas 的图像时](http://www.html5canvastutorials.com/kineticjs/html5-canvas-stage-data-url-with-kineticjs/)，该函数`stage.toDataURL()`为我提供了一个以 开头的 URL，`data:image/png;base64`后跟一个非常长的字符串！

**问题：** URL 是如何工作的？它不包含 Web 服务器地址，它实际上是从任何地方检索图像吗？

我想将此生成的图像保存到我的网络服务器，将这个非常长的字符串发送到我的服务器是否是最佳做法`POST`，并让服务器使用`curl`这个 url？

**网址**

```
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkIAAADICAYAAAAEE46XAAALwElEQVR4Xu3ZUW7dVgwE0GRD3f86uqEWBVLARlUIxBXEeZmTb8uPPEMbE/nnD/8IECBAgAABAqUCP0v3tjYBAgQIECBA4Ici5AgIECBAgACBWgFFqDZ6ixMgQIAAAQKKkBsgQIAAAQIEagUUodroLU6AAAECBAgoQm6AAAECBAgQqBVQhGqjtzgBAgQIECCgCLkBAgQIECBAoFZAEaqN3uIECBAgQICAIuQGCBAgQIAAgVoBRag2eosTIECAAAECipAbIECAAAECBGoFFKHa6C1OgAABAgQIKEJugAABAgQIEKgVUIRqo7c4AQIECBAgoAi5AQIECBAgQKBWQBGqjd7iBAgQIECAgCLkBggQIECAAIFaAUWoNnqLEyBAgAABAoqQGyBAgAABAgRqBRSh2ugtToAAAQIECChCboAAAQIECBCoFVCEaqO3OAECBAgQIKAIuQECBAgQIECgVkARqo3e4gQIECBAgIAi5AYIECBAgACBWgFFqDZ6ixMgQIAAAQKKkBsgQIAAAQIEagUUodroLU6AAAECBAgoQm6AAAECBAgQqBVQhGqjtzgBAgQIECCgCLkBAgQIECBAoFZAEaqN3uIECBAgQICAIuQGCBAgQIAAgVoBRag2eosTIECAAAECipAbIECAAAECBGoFFKHa6C1OgAABAgQIKEJugAABAgQIEKgVUIRqo7c4AQIECBAgoAi5AQIECBAgQKBWQBGqjd7iBAgQIECAgCLkBggQIECAAIFaAUWoNnqLEyBAgAABAoqQGyBAgAABAgRqBRSh2ugtToAAAQIECChCboAAAQIECBCoFVCEaqO3OAECBAgQIKAIuQECBAgQIECgVkARqo3e4gQIECBAgIAi5AYIECBAgACBWgFFqDZ6ixMgQIAAAQKKkBsgQIAAAQIEagUUodroLU6AAAECBAgoQm6AAAECBAgQqBVQhGqjtzgBAgQIECCgCLkBAgQIECBAoFZAEaqN3uIECBAgQICAIuQGCBAgQIAAgVoBRag2eosTIECAAAECipAbIECAAAECBGoFFKHa6C1OgAABAgQIKEJugAABAgQIEKgVUIRqo7c4AQIECBAgoAi5AQIECBAgQKBWQBGqjd7iBAgQIECAgCLkBggQIECAAIFaAUWoNnqLEyBAgAABAoqQGyBAgAABAgRqBRSh2ugtToAAAQIECChCboAAAQIECBCoFVCEaqO3OAECBAgQIKAIuQECBAgQIECgVkARqo3e4h8s8NcHz94wut+rDSnb8bcR8AP720RpkSIBRSg7bL9Xs/MxHYFvAn5gHQSBzxNQhLIz83s1Ox/TEVCE3ACBDxdQhLIDVISy8zEdAUXIDRD4cIHvRehPvWg1zz/+03sUodVAfDiBmYAf2JmXryaQIKAIJaTw7wyKUFIaZiEwFlCExmQeILAuoAitR/BlAEUoKQ2zEBgLKEJjMg8QWBdQhNYjUISSIjALgRMBRehEz7MEdgQUoR3360/1RigpDbMQGAsoQmMyDxBYF1CE1iPwRigpArMQOBFQhE70PEtgR0AR2nH3RijJ3SwEHhJQhB6C9G0IvCigCL2IfftR/jR2S+QLCCQLKELJ6ZiNwLWAIpR0GYpQUhpmITAWUITGZB4gsC6gCK1H8GUARSgpDbMQGAsoQmMyDxBYF1CE1iNQhJIiMAuBEwFF6ETPswR2BBShHffrT/VGKCkNsxAYCyhCYzIPEFgXUITWI/BGKCkCsxA4EVCETvQ8S2BHQBHacfdGKMndLAQeElCEHoL0bQi8KKAIvYh9+1H+NHZL5AsIJAsoQsnpmI3AtYAilHQZilBSGmYhMBZQhMZkHiCwLqAIrUfwZQBFKCkNsxAYCyhCYzIPEFgXUITWI1CEkiIwC4ETAUXoRM+zBHYEFKEd9+tP9UYoKQ2zEBgLKEJjMg8QWBdQhNYj8EYoKQKzEDgRUIRO9DxLYEdAEdpx90Yoyd0sBB4SUIQegvRtCLwooAi9iH37Uf40dkvkCwgkCyhCyemYjcC1gCKUdBmKUFIaZiEwFlCExmQeILAuoAitR/BlAEUoKQ2zEBgLKEJjMg8QWBdQhNYjUISSIjALgRMBRehEz7MEdgQUoR3360/1RigpDbMQGAsoQmMyDxBYF1CE1iPwRigpArMQOBFQhE70PEtgR0AR2nH3RijJ3SwEHhJQhB6C9G0IvCigCL2IfftR/jR2S+QLCCQLKELJ6ZiNwLWAIpR0GYpQUhpmITAWUITGZB4gsC6gCK1H8GUARSgpDbMQGAsoQmMyDxBYF1CE1iNQhJIiMAuBEwFF6ETPswR2BBShHffrT/VGKCkNsxAYCyhCYzIPEFgXUITWI/BGKCkCsxA4EVCETvQ8S2BHQBHacfdGKMndLAQeElCEHoL0bQi8KKAIvYh9+1H+NHZL5AsIJAsoQsnpmI3AtYAilHQZilBSGmYhMBZQhMZkHiCwLqAIrUfwZQBFKCkNsxAYCyhCYzIPEFgXUITWI1CEkiIwC4ETAUXoRM+zBHYEFKEd9+tP9UYoKQ2zEBgLKEJjMg8QWBdQhNYj8EYoKQKzEDgRUIRO9DxLYEdAEdpx90Yoyd0sBB4SUIQegvRtCLwooAi9iH37Uf40dkvkCwgkCyhCyemYjcC1gCKUdBmKUFIaZiEwFlCExmQeILAuoAitR/BlAEUoKQ2zEBgLKEJjMg8QWBdQhNYjUISSIjALgRMBRehEz7MEdgS+F6GdGXzq/wv4veo6CHyQgB/YDwrLqAR+CShC2afg92p2PqYj8E3AD6yDIPB5AopQdmZ+r2bnYzoCipAbIPDhAopQdoCKUHY+piOgCLkBAgQIECBAgMA/Av7n4g4IECBAgACBWgFFqDZ6ixMgQIAAAQKKkBsgQIAAAQIEagUUodroLU6AAAECBAgoQm6AAAECBAgQqBVQhGqjtzgBAgQIECCgCLkBAgQIECBAoFZAEaqN3uIECBAgQICAIuQGCBAgQIAAgVoBRag2eosTIECAAAECipAbIECAAAECBGoFFKHa6C1OgAABAgQIKEJugAABAgQIEKgVUIRqo7c4AQIECBAgoAi5AQIECBAgQKBWQBGqjd7iBAgQIECAgCLkBggQIECAAIFaAUWoNnqLEyBAgAABAoqQGyBAgAABAgRqBRSh2ugtToAAAQIECChCboAAAQIECBCoFVCEaqO3OAECBAgQIKAIuQECBAgQIECgVkARqo3e4gQIECBAgIAi5AYIECBAgACBWgFFqDZ6ixMgQIAAAQKKkBsgQIAAAQIEagUUodroLU6AAAECBAgoQm6AAAECBAgQqBVQhGqjtzgBAgQIECCgCLkBAgQIECBAoFZAEaqN3uIECBAgQICAIuQGCBAgQIAAgVoBRag2eosTIECAAAECipAbIECAAAECBGoFFKHa6C1OgAABAgQIKEJugAABAgQIEKgVUIRqo7c4AQIECBAgoAi5AQIECBAgQKBWQBGqjd7iBAgQIECAgCLkBggQIECAAIFaAUWoNnqLEyBAgAABAoqQGyBAgAABAgRqBRSh2ugtToAAAQIECChCboAAAQIECBCoFVCEaqO3OAECBAgQIKAIuQECBAgQIECgVkARqo3e4gQIECBAgIAi5AYIECBAgACBWgFFqDZ6ixMgQIAAAQKKkBsgQIAAAQIEagUUodroLU6AAAECBAgoQm6AAAECBAgQqBVQhGqjtzgBAgQIECCgCLkBAgQIECBAoFZAEaqN3uIECBAgQICAIuQGCBAgQIAAgVoBRag2eosTIECAAAECipAbIECAAAECBGoFFKHa6C1OgAABAgQIKEJugAABAgQIEKgVUIRqo7c4AQIECBAgoAi5AQIECBAgQKBWQBGqjd7iBAgQIECAgCLkBggQIECAAIFaAUWoNnqLEyBAgAABAoqQGyBAgAABAgRqBRSh2ugtToAAAQIECChCboAAAQIECBCoFVCEaqO3OAECBAgQIKAIuQECBAgQIECgVkARqo3e4gQIECBAgMDfiLaSyZOoJNUAAAAASUVORK5CYII= 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T21:30:12.250

I believe that is a URL in the "data URI scheme."

[http://en.wikipedia.org/wiki/Data_URI_scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)

Their red dot example is good:

```
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Red dot"> 
```

If you post the data, base64 decode it, and save it as a .png, it will be a valid png image.

# affiliate - LinkShare Merchandiser API Web 服务引发错误 7187145（FSW 服务器连接）

> ID：14186908
> 
> 赞同：1
> 
> 时间：2013-01-06T21:24:13.693
> 
> 标签：affiliate

我使用[LinkShare Merchandiser Query API](http://cli.linksynergy.com/cli/publisher/links/webServices.php?serviceID=1)启动了一个应用程序，针对它的查询运行良好。我能够通过 IE、我的应用程序或 Yahoo Pipes 运行查询（我选择的方法 - 通过 Yahoo Pipes 从服务中提供我的应用程序）。

在开发我的应用程序时使用此服务一两个星期后，它开始随机返回大约五分之一的错误，总是在看起来超时（响应时间超过 5 秒）之后。现在我在 2 周的中断后恢复项目，查询根本不起作用。一次都无。

错误总是相同的，与它随机失败时的错误相同。在我看来（现在仍然看起来）这是他们方面的一个内部问题，但我无法相信在过去的 48 小时内它已经（并且现在）100% 的时间都被打破了。

任何查询都会失败。一个样品：

```
http://productsearch.linksynergy.com/productsearch?token=**token**&keyword="DVD+Player"&cat="Electronics"&MaxResults=20 
```

及其回应：

```
<?xml version="1.0" encoding="UTF-8"?>
<result>
  <Errors>
    <ErrorID>7187145</ErrorID>
    <ErrorText>Internal error 18171650 occurred: FSW server connection.</ErrorText>
  </Errors>
</result> 
```

没有文档，在网络上找不到任何提及此的内容，并且到目前为止还没有收到他们的回复。在这一点上，我不确定从哪里开始。

想法？经验？我应该抛弃这种方法并从不同的提供商重新开始吗？任何输入将不胜感激。

# java - 如何在 Android 中创建锁 (concurrent.locks.Lock)？

> ID：14186912
> 
> 赞同：15
> 
> 时间：2013-01-06T21:24:39.010
> 
> 标签：java, android, locking

这一定很明显，但我找不到答案。我需要锁定一个变量，以确保避免几个竞争危险情况。根据 android 文档，据我所知，使用 Lock 存在一个非常简单的解决方案：

```
Lock l = ...;
l.lock();
try {
    // access the resource protected by this lock
 }
 finally {
     l.unlock();
 } 
```

到目前为止，一切都很好。但是，我无法使第一行工作。似乎是这样的：

```
Lock l = new Lock(); 
```

可能是正确的，但 Eclipse 报告“无法实例化类型锁定” - 仅此而已。

有什么建议么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-06T21:27:55.810

If you're very keen on using a `Lock`, you need to choose a `Lock` implementation as you *cannot* instantiate interfaces. As per the [docs](http://developer.android.com/reference/java/util/concurrent/locks/Lock.html) You have 3 choices:

*   [ReentrantLock](http://developer.android.com/reference/java/util/concurrent/locks/ReentrantLock.html)
*   [Condition](http://developer.android.com/reference/java/util/concurrent/locks/Condition.html) This isn't a Lock itself but rather a helper class since `Condition`s are bound to `Lock`s.
*   [ReadWriteLock](http://developer.android.com/reference/java/util/concurrent/locks/ReadWriteLock.html)

You're probably looking for the `ReentrantLock` possibly with some `Condition`s

This means that instead of `Lock l = new Lock();` you would do:

```
ReentrantLock lock = new ReentrantLock(); 
```

However, if all you're needing to lock is a small part, a synchronized block/method is cleaner (as suggested by @Leonidos & @assylias).

If you have a method that sets the value, you can do:

```
public synchronized void setValue (var newValue)
{
  value = newValue;
} 
```

or if this is a part of a larger method:

```
public void doInfinite ()
{
  //code
  synchronized (this)
  { 
    value = aValue;
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:28:23.690

Just because `Lock` is an interface and can't be instantiated. Use its subclasses.

# delphi - 我在哪里可以找到基本的几何例程？

> ID：14186914
> 
> 赞同：22
> 
> 时间：2013-01-06T21:24:48.167
> 
> 标签：delphi

我在哪里可以找到几何算法，它可以回答“简单”的问题，比如是否有两条线相交，一个点是否在多边形内等等。

我擅长数学，但这个话题对我来说有点过时了。但令我惊讶的是，我找不到合适的程序包来解决这些问题。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-07T01:11:28.000

[FastGEO](http://www.partow.net/projects/fastgeo/index.html)是否适合您的需求？

该项目的摘要是

> FastGEO 是一个用 Delphi 编写的库，其中包含各种高度优化的基于矢量的几何算法和例程，用于许多不同类型的几何运算，例如几何图元和谓词、船体构造和三角剖分、裁剪、旋转和投影。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-07T04:38:52.660

SDL 套件有这种东西。 [http://www.lohninger.com/sdlindex.html](http://www.lohninger.com/sdlindex.html)。我们使用了很多他们的库，并且对它（以及他们的支持）感到非常满意。

我相信他们有免费版本。

T。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T13:03:32.697

我建议您访问以下网站：

*   [efg的计算机实验室](http://www.efg2.com/Lab/index.html)。
*   [Angus Johnson 的免费软件 Delphi 组件和实用程序](http://www.angusj.com/delphi/)。

我希望这些对你有帮助。

# ruby-on-rails - 覆盖 client_side_validations 行为以验证隐藏字段

> ID：14186916
> 
> 赞同：1
> 
> 时间：2013-01-06T21:24:53.897
> 
> 标签：ruby-on-rails, client-side-validation

我正在使用带有 Rails 3.1.0的[client_side_validations gem。](https://github.com/bcardarella/client_side_validations)我一直在尝试使用它来验证通过 javascript 小部件设置的隐藏字段。从我在 gem 的 github 页面上读到的内容来看，gem 故意不验证隐藏字段，因为用户无法更正这些字段。我没有成功尝试覆盖此行为。

有没有办法在不修改 client_side_validations 代码（安装 gem 时生成的 init 内容除外）的情况下覆盖特定字段的此行为？

我现在所做的方法是对 gem 中的 validateForm 函数进行轻微修改。当它查找要验证的字段时，它只会抓取可见的元素：

```
form.find(':input:enabled:visible[data-validate]').each(function() 
```

所以我把它改成了这样：

```
form.find(':input:enabled[data-validate]').each(function() 
```

这似乎有效。有没有更好的办法？

当用户更正错误时，我无法重新验证隐藏字段。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T23:18:50.847

如果您想验证隐藏字段，请执行此操作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-06T18:27:55.190

@mushroom 询问了 client_side_validations 3.1 版，但对于使用 3.2.x 版的任何人，现在都可以配置。

[3.2-stable 分支上的这段代码](https://github.com/bcardarella/client_side_validations/blob/3-2-stable/coffeescript/rails.validations.coffee#L111)显示了它是如何完成的。

一旦页面加载`window.ClientSideValidations.selectors.validate_inputs`，您将需要覆盖。`window.ClientSideValidations.selectors.inputs`至于在哈希中包含对隐藏元素的验证，我的建议是加载元素可见的页面，然后立即运行`$('#id_of_hidden_element').attr('type', 'hidden')`.

或者，您可以只制作输入元素`type='text'`并`opacity:0`在 CSS 样式表中使用以使其不可见。请注意，这还有其他副作用，例如使其可聚焦。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-06T06:21:41.470

我认为更好的方法是通过添加“id”或“class”来验证它

`<input type="hidden" id="validate_me">`

那么选择器应该是这样的：

`':input:enabled:visible[data-validate], #validate_me'`

# android - .APK 上传失败

> ID：14186917
> 
> 赞同：29
> 
> 时间：2013-01-06T21:24:56.357
> 
> 标签：android, upload, apk, google-play

下面我回答了

当我尝试上传我的 .APK 文件时，我收到此错误：

上传失败

我已经尝试清理我的项目，将其导出，并在近 24 小时内运行它大约 100 次。这只是我的 .APK 的更新版本。我已经成功地将几个更新的 .APK 上传到了 Play 商店。我更改了版本，并且为此更新使用了与所有其他更新相同的密钥库。有什么建议么？很抱歉，这不是特定于代码的问题。此外，我只对我的一项活动进行了小幅编辑。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-05-03T19:55:17.710

该问题与使用 Chrome 无关。问题是您的会话无效。使用任何不同的浏览器（例如 Firefox、Internet Explorer、Opera 等）将创建一个新会话并允许上传工作。

真正的解决方案是退出并重新登录，因为 Google 用于验证上传的任何数据都不再有效，但它们仍然允许您在整个开发者帐户中导航，就像您使用有效会话登录一样。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-01-06T21:38:56.760

谢谢交流

这个问题的解决方案是使用**firefox**而不是**chrome**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-25T10:22:00.073

这不是你的浏览器。注销并重新登录，简单的页面刷新是不行的。我知道这很疯狂，但它确实有效。您还会发现您的图像将无法上传而没有错误消息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-02-21T13:55:28.470

对我来说，尝试注销并再次登录我的帐户解决了这个问题（正如 mtg168 所说）

希望能帮助到你！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-06T21:31:28.647

How many times have you tried? I usually get that once in a while, and when I get it I might get it 4-5 times in a row. Play Store just sucks some times.

Retry and it should work!;o

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-19T21:17:22.650

我认为问题可能是您的会话已过期。我刚刚遇到了同样的问题，但是当我注销然后重新登录时，上传工作正常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-06T21:29:11.307

May be you need to specifiy a version name different than the one provided in version 2?

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-07-30T08:23:24.693

就我而言，我碰巧在上传apk之前更改了登录密码。退出并重新登录确实有帮助。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-08-16T16:48:34.613

对我来说，它最终与我的 strings.xml 中的换行符有关

大约 8 次尝试没有显示错误消息，然后它随机出现。将换行符从 \u000d 更改为 \n 后能够上传

# javascript - onchange 事件的问题

> ID：14186924
> 
> 赞同：-2
> 
> 时间：2013-01-06T21:25:46.837
> 
> 标签：javascript

JSFiddle： [这里](http://jsfiddle.net/QkK26/)

我有问题`onchange`。我用相同的方式编写了它们，但只有一个可以正常工作。我的函数命名`changerImage`工作正常；就是`changerLogo`什么都不想做。

这两个功能几乎相同，为什么它不起作用？

```
function changerLogo() {
    var indice2 = lstLogos.selectedIndex;
    var choix2 = lstLogos.options[indice2].value;
    grosseImage2.src = "images/logo/" + choix2;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:34:29.347

你拼错`onchange`了`onchage`：`onload`

```
lstLogos.**onchage** = changerLogo;
```

[更新了 jsFiddle](http://jsfiddle.net/QkK26/3/)（不是图像在那里工作......）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:37:19.417

除了 minitech 指出的错字之外，使用 addEventListener：

[https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener](https://developer.mozilla.org/en-US/docs/DOM/element.addEventListener)

或者只是使用像 jQuery`$('#1stLogos').change(function ..`这样的库，它将为您完成繁重的事件监听。

[http://jsfiddle.net/E7Qvg/](http://jsfiddle.net/E7Qvg/)

```
document.getElementById('lstLogos').addEventListener('change', changerLogo);
document.getElementById('lstPhotos').addEventListener('change', changerImage);

function changerImage() {
    var indice1 = lstPhotos.selectedIndex;
    var choix1 = lstPhotos.options[indice1].value;
    grosseImage1.src = "images/circuit/" + choix1;
    alert('changerImage works: ' + choix1);
} 

function changerLogo() {
    var indice2 = lstLogos.selectedIndex;
    var choix2 = lstLogos.options[indice2].value;
    alert('changerLogo works: ' + choix2);
} 
```

# websocket - Raspberry Pi 上的 Tornado 使用 websockets 以及监控串口 Arduino 通信

> ID：14186925
> 
> 赞同：16
> 
> 时间：2013-01-06T21:25:48.630
> 
> 标签：websocket, arduino, tornado, raspberry-pi

本质上，我希望实现的是一个基于画布的 Web 界面，通过[Raspberry Pi来控制](http://en.wikipedia.org/wiki/Raspberry_Pi)[Arduino](http://en.wikipedia.org/wiki/Arduino#ArduinoUno)。用[例](http://en.wikipedia.org/wiki/Use_case)是用户导航到显示画布的位置。然后在移动滑块时，会向 Raspberry Pi 上的[Tornado](http://en.wikipedia.org/wiki/Tornado_%28web_server%29)服务器发送一条 websocket 消息。Tornado 然后向 Arduino 发送一条串行消息，改变[LED的](http://en.wikipedia.org/wiki/Light-emitting_diode)[RGB](http://en.wikipedia.org/wiki/RGB_color_model)值。到目前为止一切顺利，在开发人员*[Raspberry Pi Android HTML5 Realtime Servo Control](http://martinsant.net/?page_id=479)*的文档的帮助下，我已经能够做到这一点。`raspberrypi:8080`

但是，从 Raspberry Pi 到 Arduino 的通信只是单向的。我希望 Tornado 也可以监视串行端口，以将任何传感器数据返回到前端。这是我不确定如何进行的地方。我能够使用[Node.js](http://en.wikipedia.org/wiki/Node.js)完成类似的事情，它异步监控 websocket 消息和串行消息。

是否应该生成一个持续监控端口的异步进程？我已经看到了这种解决方案的几个选项。

1.  有人建议`tornado.gen.Task`，但是对于单个 HTTP 请求，而不是对于恒定的串行数据。
2.  `tornado.ioloop.PeriodicCallback`我可以设置为每毫秒检查一次串行数据，但这听起来像是很多开销。
3.  ~~我还看到了单独的工具，例如[Swirl](http://code.naeseth.com/swirl/)。~~（根据[它的 Github repo](https://github.com/enaeseth/swirl) ，Swirl 已经过时了）

或者我应该设置一个单独的[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)应用程序来监控串行，然后与 Tornado 应用程序进行通信，它可以理解如下所示的内容？

4.  使用[websocket 客户端的 websocket 消息](https://github.com/liris/websocket-client)
5.  ZeroMQ（工作示例：*[pyzmq/examples/eventloop/web.py](https://github.com/zeromq/pyzmq/blob/master/examples/eventloop/web.py)*）

所以有很多选择......有哪些建议和一些理由可以尝试或避免上述任何选项？

这是我拥有和需要添加串行监控的内容：

```
import tornado.httpserver
import tornado.ioloop
import tornado.options
import tornado.web
import tornado.websocket

from tornado.options import define, options
define("port", default=8080, help="run on the given port", type=int)

class IndexHandler(tornado.web.RequestHandler):
    def get(self):
        self.render('index.html')

class WebSocketHandler(tornado.websocket.WebSocketHandler):
    def open(self):
        print 'new connection'
        self.write_message("connected")

    def on_message(self, message):
        print 'message received %s' % message
        self.write_message('message received %s' % message)

    def on_close(self):
        print 'connection closed'

if __name__ == "__main__":
    tornado.options.parse_command_line()
    app = tornado.web.Application(
        handlers=[
            (r"/", IndexHandler),
            (r"/ws", WebSocketHandler)
        ]
    )
    httpServer = tornado.httpserver.HTTPServer(app)
    httpServer.listen(options.port)
    print "Listening on port:", options.port
    tornado.ioloop.IOLoop.instance().start() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T01:03:45.323

这是我的 2 美分。我会提倡 Python -> websockets-client 路线。Tornado 服务器软件经过精心设计和调整以处理 Web 客户端请求。让它完成它的工作。任何将其硬塞到另一个角色（如监控本地硬件）的尝试都会导致比（a）设计用于执行此类工作（如 C/C++ 程序）或（b）足够灵活以处理的东西更多的开销这样的任务开销很小（如 Python 脚本）。

相关经验：曾为 Raspberry Pi 和 Arduino 编程。当地机器人俱乐部的官员。

# c# - 使用子类的 C# 类未实现继承的抽象成员错误

> ID：14186927
> 
> 赞同：2
> 
> 时间：2013-01-06T21:25:58.830
> 
> 标签：c#, inheritance, overriding

这是我正在尝试编译的 c# 代码 相当简单，`testDMO`继承自`testDMOBase` Then test 继承自 testBase

```
public abstract class testDMOBase { }
public class testDMO : testDMOBase { }
public abstract class testBase
{
    abstract protected void LoadCRUD(testDMOBase dmo);
}
public class test : testBase
{
    override protected void LoadCRUD(testDMO dmo) { }
} 
```

我收到以下错误：

> “test”没有实现继承的抽象成员“testBase.LoadCRUD(testDMOBase)”“test.LoadCRUD(testDMO)”：找不到合适的方法来覆盖

在覆盖方法上不应该使用子类吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T21:28:19.480

> Shouldn't the use of a subclass be ok on the override method?

No. Aside from anything else, which implementation would you expect to be called if the caller provided an instance *other* than your subclass?

```
testBase t = new test();
t.LoadCRUD(new SomeOtherDMO()); // What would be called here? 
```

You might well argue that it would make sense to be able to override the base method with a subclass method which is *more general* (e.g. with a parameter which is a *superclass* of the original parameter type, or with a return type which is a subclass of the original return type) but .NET doesn't allow either of these anyway. The parameter and return types of the overriding method have to match the original method *exactly*, at least after generic type parameter substitution.

It sounds like you *may* want to make your base type generic:

```
public abstract class TestBase<T> where T : TestDmoBase
{
    public abstract void LoadCrud(T dmo);
}

public class Test : TestBase<TestDmo>
{
    public override void LoadCrud(TestDmo dmo)
    {
        ...
    }
} 
```

Note that you should follow .NET naming conventions, too - even in sample code.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-06T21:27:09.937

不，在这种情况下，您必须**完全**遵循`abstract`方法的签名，才能提供有效的覆盖。

所以，你必须写：

```
public class test : testBase
{
    override protected void LoadCRUD(testDMOBase dmo)  //BASE CLASS
    { }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T21:29:15.860

> Shouldn't the use of a subclass be ok on the override method?

No, method overrides must use the same parameter types as their original declarations.

# if-statement - 没有 if 语句的分支

> ID：14186944
> 
> 赞同：3
> 
> 时间：2013-01-06T21:27:41.300
> 
> 标签：if-statement, language-agnostic

*是否可以在不*使用`if`语句的情况下分支代码？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T21:27:41.300

是的，你可以，GPU 风格。

假设您有一个分支的函数，并在最后返回一个值。

```
float function( float input )
{
    if( input > 0 )
    {
        // do stuff
        finalValue = 2+4+8*input;
        return finalValue ;
    }
    else
    {
        // do other stuff
        finalValue = 1+input;
        return finalValue ;
    }
} 
```

要在*不使用分支*的情况下做到这一点，您可以编写 GPU 风格的代码：也就是说，*评估两个分支，然后在最后丢弃您不想要的那个*。

```
float function( float input )
{
    // do stuff..regardless
    finalValue1 = 2+4+8*input;

    // do other stuff..regardless
    finalValue2 = 1+input;

    bool resultMask = input > 0 ; // 1 if should use finalValue1.
    return finalValue1*resultMask   +   finalValue2*(1 - resultMask) ;
} 
```

所以你有它。没有分支的分支，没有 if 语句的 if 语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:36:32.323

取决于您所说的“分支”和“如果”是什么意思。以下任何一个分支，没有“如果”。

```
switch (foo) {

} 
```

或者三元运算符，如果你不计算：

```
x == 0 ? doFunc1() : doFunc2() 
```

如果您的语言支持函数指针：

```
funcArray[selectedOption]() 
```

你可以很傻，做：

```
boolean once = true;
while (condition && once) {
  doAWhichNeverReturns();
  once = false; 
} 
doB(); 
```

但是我认为这并不能真正回答您的问题，因为我不知道您要做什么。

# python - python 是否有任何直接的方法来比较两个 .txt 文件？

> ID：14186949
> 
> 赞同：-1
> 
> 时间：2013-01-06T21:27:53.243
> 
> 标签：python, python-2.7

我有两个 .text 文件说`Sample2.txt`和`Sample1.txt`. 如果它们相同或不同，是否可以通过编程方式进行比较？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-06T21:29:23.497

使用标准库中的[difflib](http://docs.python.org/2/library/difflib.html)。

请参阅此[示例](http://www.doughellmann.com/PyMOTW/difflib/index.html)使用（复制自 Doug Hellmann 的 PyMOTW）

```
import difflib

d = difflib.Differ()
diff = d.compare(text1_lines, text2_lines)
print '\n'.join(diff) 
```

我省去了你的输出——你最好在上面提供的链接下自己阅读。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T21:30:02.843

好吧，你可以用欺骗的方式来做

```
open("myfile.txt").read() == open("myotherfile.txt").read() 
```

但这不是最好的方法，可能更好的方法是使用[difflib](http://docs.python.org/2/library/difflib.html)

```
import difflib
difflib.SequenceMatcher(None, file1.read(), file2.read()) 
```

# java - 使用下拉列表在 Java 中创建自动完成文本框

> ID：14186955
> 
> 赞同：30
> 
> 时间：2013-01-06T21:28:21.057
> 
> 标签：java, swing, autocomplete, autosuggest

我想创建一个自动建议文本框，它将在每个键释放事件中查询数据库。那部分很简单，但我想给它一个漂亮的视觉效果。类似于我们在 Facebook 搜索等网站上看到的自动建议文本框。

如何制作这样的界面？

一个天真的想法是在文本框下方放置一个 JList，并在找到一个时将其设置为可见。

有更好的想法或标准的做法吗？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-01-07T10:33:20.400

@syb0rg 的答案更简单，因为它使用了第 3 方库。

但是我使用了另一种方法：

它使用一个名为的自定义类，该类`AutoSuggestor`接受 a `JTextField`，它`Window`的一个`ArrayList<String>`单词来检查输入的单词，背景颜色和文本颜色，建议焦点颜色以及不透明度值。通过传递`JTextField`引用`DocumentListener`添加了 a ，它将检查输入的单词以及是否显示建议以及如果是则显示什么建议。当输入一个单词时，`DocumentListener`将触发`wordTyped(String wordTyped)`当前输入的单词或（至少输入了多少个单词）的方法，`wordTyped(..)`该单词将与`AutoSuggestor`s classes *字典*中的那些进行检查，这是一个基本`ArrayList`的`String`可以即时设置，如下例所示：

![在此处输入图像描述](../Images/537e9a7c82f7c90c3accc954d5a4f6ff.png)

（现在您必须使用鼠标并单击要自动完成的单词，或者使用`DOWN`横向建议和*文本字段*并在使用*向下*`ENTER`键遍历时选择建议。我尚未实现）：*`UP`*

 *```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.Window;
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.util.ArrayList;
import javax.swing.AbstractAction;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;
import javax.swing.JWindow;
import javax.swing.KeyStroke;
import javax.swing.SwingUtilities;
import javax.swing.border.LineBorder;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;

/**
 * @author David
 */
public class Test {

    public Test() {

        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JTextField f = new JTextField(10);

        AutoSuggestor autoSuggestor = new AutoSuggestor(f, frame, null, Color.WHITE.brighter(), Color.BLUE, Color.RED, 0.75f) {
            @Override
            boolean wordTyped(String typedWord) {

                //create list for dictionary this in your case might be done via calling a method which queries db and returns results as arraylist
                ArrayList<String> words = new ArrayList<>();
                words.add("hello");
                words.add("heritage");
                words.add("happiness");
                words.add("goodbye");
                words.add("cruel");
                words.add("car");
                words.add("war");
                words.add("will");
                words.add("world");
                words.add("wall");

                setDictionary(words);
                //addToDictionary("bye");//adds a single word

                return super.wordTyped(typedWord);//now call super to check for any matches against newest dictionary
            }
        };

        JPanel p = new JPanel();

        p.add(f);

        frame.add(p);

        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Test();
            }
        });
    }
}

class AutoSuggestor {

    private final JTextField textField;
    private final Window container;
    private JPanel suggestionsPanel;
    private JWindow autoSuggestionPopUpWindow;
    private String typedWord;
    private final ArrayList<String> dictionary = new ArrayList<>();
    private int currentIndexOfSpace, tW, tH;
    private DocumentListener documentListener = new DocumentListener() {
        @Override
        public void insertUpdate(DocumentEvent de) {
            checkForAndShowSuggestions();
        }

        @Override
        public void removeUpdate(DocumentEvent de) {
            checkForAndShowSuggestions();
        }

        @Override
        public void changedUpdate(DocumentEvent de) {
            checkForAndShowSuggestions();
        }
    };
    private final Color suggestionsTextColor;
    private final Color suggestionFocusedColor;

    public AutoSuggestor(JTextField textField, Window mainWindow, ArrayList<String> words, Color popUpBackground, Color textColor, Color suggestionFocusedColor, float opacity) {
        this.textField = textField;
        this.suggestionsTextColor = textColor;
        this.container = mainWindow;
        this.suggestionFocusedColor = suggestionFocusedColor;
        this.textField.getDocument().addDocumentListener(documentListener);

        setDictionary(words);

        typedWord = "";
        currentIndexOfSpace = 0;
        tW = 0;
        tH = 0;

        autoSuggestionPopUpWindow = new JWindow(mainWindow);
        autoSuggestionPopUpWindow.setOpacity(opacity);

        suggestionsPanel = new JPanel();
        suggestionsPanel.setLayout(new GridLayout(0, 1));
        suggestionsPanel.setBackground(popUpBackground);

        addKeyBindingToRequestFocusInPopUpWindow();
    }

    private void addKeyBindingToRequestFocusInPopUpWindow() {
        textField.getInputMap(JComponent.WHEN_FOCUSED).put(KeyStroke.getKeyStroke(KeyEvent.VK_DOWN, 0, true), "Down released");
        textField.getActionMap().put("Down released", new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent ae) {//focuses the first label on popwindow
                for (int i = 0; i < suggestionsPanel.getComponentCount(); i++) {
                    if (suggestionsPanel.getComponent(i) instanceof SuggestionLabel) {
                        ((SuggestionLabel) suggestionsPanel.getComponent(i)).setFocused(true);
                        autoSuggestionPopUpWindow.toFront();
                        autoSuggestionPopUpWindow.requestFocusInWindow();
                        suggestionsPanel.requestFocusInWindow();
                        suggestionsPanel.getComponent(i).requestFocusInWindow();
                        break;
                    }
                }
            }
        });
        suggestionsPanel.getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT).put(KeyStroke.getKeyStroke(KeyEvent.VK_DOWN, 0, true), "Down released");
        suggestionsPanel.getActionMap().put("Down released", new AbstractAction() {
            int lastFocusableIndex = 0;

            @Override
            public void actionPerformed(ActionEvent ae) {//allows scrolling of labels in pop window (I know very hacky for now :))

                ArrayList<SuggestionLabel> sls = getAddedSuggestionLabels();
                int max = sls.size();

                if (max > 1) {//more than 1 suggestion
                    for (int i = 0; i < max; i++) {
                        SuggestionLabel sl = sls.get(i);
                        if (sl.isFocused()) {
                            if (lastFocusableIndex == max - 1) {
                                lastFocusableIndex = 0;
                                sl.setFocused(false);
                                autoSuggestionPopUpWindow.setVisible(false);
                                setFocusToTextField();
                                checkForAndShowSuggestions();//fire method as if document listener change occured and fired it

                            } else {
                                sl.setFocused(false);
                                lastFocusableIndex = i;
                            }
                        } else if (lastFocusableIndex <= i) {
                            if (i < max) {
                                sl.setFocused(true);
                                autoSuggestionPopUpWindow.toFront();
                                autoSuggestionPopUpWindow.requestFocusInWindow();
                                suggestionsPanel.requestFocusInWindow();
                                suggestionsPanel.getComponent(i).requestFocusInWindow();
                                lastFocusableIndex = i;
                                break;
                            }
                        }
                    }
                } else {//only a single suggestion was given
                    autoSuggestionPopUpWindow.setVisible(false);
                    setFocusToTextField();
                    checkForAndShowSuggestions();//fire method as if document listener change occured and fired it
                }
            }
        });
    }

    private void setFocusToTextField() {
        container.toFront();
        container.requestFocusInWindow();
        textField.requestFocusInWindow();
    }

    public ArrayList<SuggestionLabel> getAddedSuggestionLabels() {
        ArrayList<SuggestionLabel> sls = new ArrayList<>();
        for (int i = 0; i < suggestionsPanel.getComponentCount(); i++) {
            if (suggestionsPanel.getComponent(i) instanceof SuggestionLabel) {
                SuggestionLabel sl = (SuggestionLabel) suggestionsPanel.getComponent(i);
                sls.add(sl);
            }
        }
        return sls;
    }

    private void checkForAndShowSuggestions() {
        typedWord = getCurrentlyTypedWord();

        suggestionsPanel.removeAll();//remove previos words/jlabels that were added

        //used to calcualte size of JWindow as new Jlabels are added
        tW = 0;
        tH = 0;

        boolean added = wordTyped(typedWord);

        if (!added) {
            if (autoSuggestionPopUpWindow.isVisible()) {
                autoSuggestionPopUpWindow.setVisible(false);
            }
        } else {
            showPopUpWindow();
            setFocusToTextField();
        }
    }

    protected void addWordToSuggestions(String word) {
        SuggestionLabel suggestionLabel = new SuggestionLabel(word, suggestionFocusedColor, suggestionsTextColor, this);

        calculatePopUpWindowSize(suggestionLabel);

        suggestionsPanel.add(suggestionLabel);
    }

    public String getCurrentlyTypedWord() {//get newest word after last white spaceif any or the first word if no white spaces
        String text = textField.getText();
        String wordBeingTyped = "";
        if (text.contains(" ")) {
            int tmp = text.lastIndexOf(" ");
            if (tmp >= currentIndexOfSpace) {
                currentIndexOfSpace = tmp;
                wordBeingTyped = text.substring(text.lastIndexOf(" "));
            }
        } else {
            wordBeingTyped = text;
        }
        return wordBeingTyped.trim();
    }

    private void calculatePopUpWindowSize(JLabel label) {
        //so we can size the JWindow correctly
        if (tW < label.getPreferredSize().width) {
            tW = label.getPreferredSize().width;
        }
        tH += label.getPreferredSize().height;
    }

    private void showPopUpWindow() {
        autoSuggestionPopUpWindow.getContentPane().add(suggestionsPanel);
        autoSuggestionPopUpWindow.setMinimumSize(new Dimension(textField.getWidth(), 30));
        autoSuggestionPopUpWindow.setSize(tW, tH);
        autoSuggestionPopUpWindow.setVisible(true);

        int windowX = 0;
        int windowY = 0;

        windowX = container.getX() + textField.getX() + 5;
        if (suggestionsPanel.getHeight() > autoSuggestionPopUpWindow.getMinimumSize().height) {
            windowY = container.getY() + textField.getY() + textField.getHeight() + autoSuggestionPopUpWindow.getMinimumSize().height;
        } else {
            windowY = container.getY() + textField.getY() + textField.getHeight() + autoSuggestionPopUpWindow.getHeight();
        }

        autoSuggestionPopUpWindow.setLocation(windowX, windowY);
        autoSuggestionPopUpWindow.setMinimumSize(new Dimension(textField.getWidth(), 30));
        autoSuggestionPopUpWindow.revalidate();
        autoSuggestionPopUpWindow.repaint();

    }

    public void setDictionary(ArrayList<String> words) {
        dictionary.clear();
        if (words == null) {
            return;//so we can call constructor with null value for dictionary without exception thrown
        }
        for (String word : words) {
            dictionary.add(word);
        }
    }

    public JWindow getAutoSuggestionPopUpWindow() {
        return autoSuggestionPopUpWindow;
    }

    public Window getContainer() {
        return container;
    }

    public JTextField getTextField() {
        return textField;
    }

    public void addToDictionary(String word) {
        dictionary.add(word);
    }

    boolean wordTyped(String typedWord) {

        if (typedWord.isEmpty()) {
            return false;
        }
        //System.out.println("Typed word: " + typedWord);

        boolean suggestionAdded = false;

        for (String word : dictionary) {//get words in the dictionary which we added
            boolean fullymatches = true;
            for (int i = 0; i < typedWord.length(); i++) {//each string in the word
                if (!typedWord.toLowerCase().startsWith(String.valueOf(word.toLowerCase().charAt(i)), i)) {//check for match
                    fullymatches = false;
                    break;
                }
            }
            if (fullymatches) {
                addWordToSuggestions(word);
                suggestionAdded = true;
            }
        }
        return suggestionAdded;
    }
}

class SuggestionLabel extends JLabel {

    private boolean focused = false;
    private final JWindow autoSuggestionsPopUpWindow;
    private final JTextField textField;
    private final AutoSuggestor autoSuggestor;
    private Color suggestionsTextColor, suggestionBorderColor;

    public SuggestionLabel(String string, final Color borderColor, Color suggestionsTextColor, AutoSuggestor autoSuggestor) {
        super(string);

        this.suggestionsTextColor = suggestionsTextColor;
        this.autoSuggestor = autoSuggestor;
        this.textField = autoSuggestor.getTextField();
        this.suggestionBorderColor = borderColor;
        this.autoSuggestionsPopUpWindow = autoSuggestor.getAutoSuggestionPopUpWindow();

        initComponent();
    }

    private void initComponent() {
        setFocusable(true);
        setForeground(suggestionsTextColor);

        addMouseListener(new MouseAdapter() {
            @Override
            public void mouseClicked(MouseEvent me) {
                super.mouseClicked(me);

                replaceWithSuggestedText();

                autoSuggestionsPopUpWindow.setVisible(false);
            }
        });

        getInputMap(JComponent.WHEN_FOCUSED).put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0, true), "Enter released");
        getActionMap().put("Enter released", new AbstractAction() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                replaceWithSuggestedText();
                autoSuggestionsPopUpWindow.setVisible(false);
            }
        });
    }

    public void setFocused(boolean focused) {
        if (focused) {
            setBorder(new LineBorder(suggestionBorderColor));
        } else {
            setBorder(null);
        }
        repaint();
        this.focused = focused;
    }

    public boolean isFocused() {
        return focused;
    }

    private void replaceWithSuggestedText() {
        String suggestedWord = getText();
        String text = textField.getText();
        String typedWord = autoSuggestor.getCurrentlyTypedWord();
        String t = text.substring(0, text.lastIndexOf(typedWord));
        String tmp = t + text.substring(text.lastIndexOf(typedWord)).replace(typedWord, suggestedWord);
        textField.setText(tmp + " ");
    }
} 
```

就目前而言，IMO 唯一可能需要的补充是：

*   `UP`弹出自动建议框中项目的关键焦点可遍历性，以便我们可以向上移动。

如果有任何问题让我知道，我会看看我能做什么。但似乎运行良好（触摸木头）。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-01-06T21:50:22.163

一个非常简单的方法是使用`GlazedList`自动完成的实现。启动和运行非常容易。你可以在[这里](http://publicobject.com/glazedlists/)找到它。

您可以在 JComboBox 上安装自动完成功能，只需一行 Glazed 代码，如下所示：

```
JComboBox comboBox = new JComboBox();
Object[] elements = new Object[] {"Cat", "Dog", "Lion", "Mouse"};
AutoCompleteSupport.install(comboBox, GlazedLists.eventListOf(elements)); 
```

还`SwingX`支持自动完成，可能比`GlazedList`. 你写的`SwingX`只是`AutoCompleteDecorator.decorate(comboBox);`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-17T15:15:18.760

要使用 TextAutoCompleter 类，您需要下载 jar 文件 AutoCompleter.jar 并将其添加到项目的库文件夹中，这里是下载链接：http: [//download1689.mediafire.com/4grrthscpsug/7pwzgefiomu392o/AutoCompleter.jar](http://download1689.mediafire.com/4grrthscpsug/7pwzgefiomu392o/AutoCompleter.jar) -Nawin

//在Main类中编写如下代码

```
package autocomplete;

import com.mxrck.autocompleter.TextAutoCompleter;
import java.sql.SQLException;
import javax.swing.JFrame;
import javax.swing.JTextField;

public class AutoComplete {
    JFrame f=new JFrame();
    JTextField t1;
AutoComplete() throws ClassNotFoundException, SQLException{

    f.setSize(500,500);
    f.setLocation(500,100);
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.setLayout(null);
    f.setVisible(true);

    t1=new JTextField();
    t1.setBounds(50,80,200,20);
    f.add(t1);

    TextAutoCompleter complete=new TextAutoCompleter(t1);
    DBConn conn=new DBConn();
        conn.connection();
        conn.retrieve();
    while(conn.rs.next()){

        complete.addItem(conn.rs.getString("number"));
    }

}

    public static void main(String[] args) throws ClassNotFoundException,
    SQLException{           

        new AutoComplete();
   }

}

//Create seperate class for database connection and write the following code

package autocomplete;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class DBConn {

    Connection con; ResultSet rs;PreparedStatement stat;

public void connection() throws ClassNotFoundException, SQLException{
    String url="jdbc:mysql://localhost:3306/";
    String driver="com.mysql.jdbc.Driver";   
    String db="demo";
    String username="root";
    String password="root";
    stat =null; 

        Class.forName(driver);
       con=(Connection)DriverManager.getConnection
       (url+db,username,password);              
        System.out.println("Connecttion SuccessFul");
}  

public void retrieve() throws SQLException{

    Statement  stmt=con.createStatement();
    String query="select number from phone";
    rs = stmt.executeQuery(query);

    System.out.println("retrieve succesfully");

} 
```

}

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-02-25T12:13:20.593

[建立在David](https://stackoverflow.com/users/1133011/david-kroukamp)的[解决方案](https://stackoverflow.com/a/14194104/4761457)之上：

我为该键添加了功能，并为该`UP`键添加了功能`ESC`以隐藏弹出窗口。除此之外，您还可以在构造一个`AutoSuggestor`对象时指定回调函数，选择从列表中的建议时会调用。

```
import javax.swing.border.LineBorder
import java.util.ArrayList
import javax.swing.event.DocumentListener

import java.awt.*
import java.awt.event.*
import javax.swing.*
import javax.swing.event.DocumentEvent

/**
 * Author of the original version: David @ https://stackoverflow.com/users/1133011/david-kroukamp
 */
class Test {
    init {

        val frame = JFrame()
        frame.defaultCloseOperation = JFrame.EXIT_ON_CLOSE

        val f = JTextField(10)

        val autoSuggestor = object : AutoSuggestor(f, frame, ArrayList(), Color.WHITE.brighter(), Color.BLUE, Color.RED, 0.75f) {
            override fun wordTyped(typedWord: String?): Boolean {

                //create list for dictionary this in your case might be done via calling a method which queries db and returns results as arraylist
                val words = ArrayList<String>()
                words.add("hello")
                words.add("heritage")
                words.add("happiness")
                words.add("goodbye")
                words.add("cruel")
                words.add("car")
                words.add("war")
                words.add("will")
                words.add("world")
                words.add("wall")

                setDictionary(words)
                //addToDictionary("bye");//adds a single word

                return super.wordTyped(typedWord)//now call super to check for any matches against newest dictionary
            }
        }

        val p = JPanel()

        p.add(f)

        frame.add(p)

        frame.pack()
        frame.isVisible = true
    }

    companion object {

        @JvmStatic
        fun main(args: Array<String>) {
            SwingUtilities.invokeLater { Test() }
        }
    }
}

internal open class AutoSuggestor(val textField: JTextField, val container: Window, words: ArrayList<String>, popUpBackground: Color, private val suggestionsTextColor: Color, private val suggestionFocusedColor: Color, opacity: Float, private val callback: (String) -> Unit = {}) {
    private val suggestionsPanel: JPanel
    val autoSuggestionPopUpWindow: JWindow
    private var typedWord: String? = null
    private val dictionary = ArrayList<String>()
    private var currentIndexOfSpace: Int = 0
    private var tW: Int = 0
    private var tH: Int = 0
    private val documentListener = object : DocumentListener {
        override fun insertUpdate(de: DocumentEvent) {
            checkForAndShowSuggestions()
        }

        override fun removeUpdate(de: DocumentEvent) {
            checkForAndShowSuggestions()
        }

        override fun changedUpdate(de: DocumentEvent) {
            checkForAndShowSuggestions()
        }
    }

    val addedSuggestionLabels: ArrayList<SuggestionLabel>
        get() {
            val sls = ArrayList<SuggestionLabel>()
            for (i in 0 until suggestionsPanel.componentCount) {
                if (suggestionsPanel.getComponent(i) is SuggestionLabel) {
                    val sl = suggestionsPanel.getComponent(i) as SuggestionLabel
                    sls.add(sl)
                }
            }
            return sls
        }

    //get newest word after last white space if any or the first word if no white spaces
    val currentlyTypedWord: String
        get() {
            val text = textField.text
            var wordBeingTyped = ""
            if (text.contains(" ")) {
                val tmp = text.lastIndexOf(" ")
                if (tmp >= currentIndexOfSpace) {
                    currentIndexOfSpace = tmp
                    wordBeingTyped = text.substring(text.lastIndexOf(" "))
                }
            } else {
                wordBeingTyped = text
            }
            return wordBeingTyped.trim { it <= ' ' }
        }

    init {
        this.textField.document.addDocumentListener(documentListener)

        setDictionary(words)

        typedWord = ""
        currentIndexOfSpace = 0
        tW = 0
        tH = 0

        autoSuggestionPopUpWindow = JWindow(container)
        autoSuggestionPopUpWindow.opacity = opacity

        suggestionsPanel = JPanel()
        suggestionsPanel.layout = GridLayout(0, 1)
        suggestionsPanel.background = popUpBackground

        addFocusListenersToHandleVisibilityOfPopUpWindow()
        addKeyBindingToRequestFocusInPopUpWindow()
    }

    private fun addFocusListenersToHandleVisibilityOfPopUpWindow() {
        textField.addFocusListener(object:FocusListener {
            override fun focusLost(e: FocusEvent?) {
                var focusOnPopUp = false
                for (i in 0 until suggestionsPanel.componentCount) {
                    if (suggestionsPanel.getComponent(i) is SuggestionLabel) {
                        val label = suggestionsPanel.getComponent(i) as SuggestionLabel
                        if (label.isFocused)
                            focusOnPopUp = true
                    }
                }

                if (!focusOnPopUp && !shouldShowPopUpWindow) {
                    autoSuggestionPopUpWindow.isVisible = false
                }
            }
            override fun focusGained(e: FocusEvent?) {
                shouldShowPopUpWindow = false
            }
        })
    }

    private fun addKeyBindingToRequestFocusInPopUpWindow() {
        textField.getInputMap(JComponent.WHEN_FOCUSED).put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0, true), "Escape released")
        textField.actionMap.put("Escape released", object : AbstractAction() {
            override fun actionPerformed(ae: ActionEvent) {// Hide the popwindow
                shouldShowPopUpWindow = false
                autoSuggestionPopUpWindow.isVisible = false
            }
        })

        textField.getInputMap(JComponent.WHEN_FOCUSED).put(KeyStroke.getKeyStroke(KeyEvent.VK_DOWN, 0, true), "Down released")
        textField.actionMap.put("Down released", object : AbstractAction() {
            override fun actionPerformed(ae: ActionEvent) {//focuses the first label on popwindow
                for (i in 0 until suggestionsPanel.componentCount) {
                    if (suggestionsPanel.getComponent(i) is SuggestionLabel) {
                        (suggestionsPanel.getComponent(i) as SuggestionLabel).isFocused = true
                        autoSuggestionPopUpWindow.toFront()
                        autoSuggestionPopUpWindow.requestFocusInWindow()
                        suggestionsPanel.requestFocusInWindow()
                        suggestionsPanel.getComponent(i).requestFocusInWindow()
                        break
                    }
                }
            }
        })

        textField.getInputMap(JComponent.WHEN_FOCUSED).put(KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0, true), "Up released")
        textField.actionMap.put("Up released", object : AbstractAction() {
            override fun actionPerformed(ae: ActionEvent) {//focuses the last label on popwindow
                for (i in 0 until suggestionsPanel.componentCount) {
                    val reverseIndex = suggestionsPanel.componentCount-1 - i
                    if (suggestionsPanel.getComponent(reverseIndex) is SuggestionLabel) {
                        (suggestionsPanel.getComponent(reverseIndex) as SuggestionLabel).isFocused = true
                        autoSuggestionPopUpWindow.toFront()
                        autoSuggestionPopUpWindow.requestFocusInWindow()
                        suggestionsPanel.requestFocusInWindow()
                        suggestionsPanel.getComponent(reverseIndex).requestFocusInWindow()
                        break
                    }
                }
            }
        })

        suggestionsPanel.getInputMap(JComponent.WHEN_FOCUSED).put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0, true), "Escape released")
        suggestionsPanel.actionMap.put("Escape released", object : AbstractAction() {
            override fun actionPerformed(ae: ActionEvent) {// Hide the popwindow
                shouldShowPopUpWindow = false
                autoSuggestionPopUpWindow.isVisible = false
            }
        })
        suggestionsPanel.getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT).put(KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0, true), "Up released")
        suggestionsPanel.actionMap.put("Up released", object : AbstractAction() {
            override fun actionPerformed(ae: ActionEvent) {//allows scrolling of labels in pop window (I know very hacky for now :))

                val sls = addedSuggestionLabels
                val max = sls.size

                var indexOfFocusedSuggestion = -1
                for (i in 0 until max) {
                    val sl = sls[i]
                    if ( sl.isFocused )
                        indexOfFocusedSuggestion = i
                }

                if (indexOfFocusedSuggestion - 1 < 0) {
                    sls[indexOfFocusedSuggestion].isFocused = false
                    autoSuggestionPopUpWindow.isVisible = false
                    setFocusToTextField()
                    checkForAndShowSuggestions()//fire method as if document listener change occured and fired it
                }
                else {
                    sls[indexOfFocusedSuggestion].isFocused = false
                    sls[indexOfFocusedSuggestion-1].isFocused = true
                    autoSuggestionPopUpWindow.toFront()
                    autoSuggestionPopUpWindow.requestFocusInWindow()
                    suggestionsPanel.requestFocusInWindow()
                    suggestionsPanel.getComponent(indexOfFocusedSuggestion-1).requestFocusInWindow()
                }

            }
        })
        suggestionsPanel.getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT).put(KeyStroke.getKeyStroke(KeyEvent.VK_DOWN, 0, true), "Down released")
        suggestionsPanel.actionMap.put("Down released", object : AbstractAction() {
            override fun actionPerformed(ae: ActionEvent) {//allows scrolling of labels in pop window (I know very hacky for now :))

                val sls = addedSuggestionLabels
                val max = sls.size

                var indexOfFocusedSuggestion = -1
                for (i in 0 until max) {
                    val sl = sls[i]
                    if ( sl.isFocused )
                        indexOfFocusedSuggestion = i
                }

                if (indexOfFocusedSuggestion + 1 >= max) {
                    sls[indexOfFocusedSuggestion].isFocused = false
                    autoSuggestionPopUpWindow.isVisible = false
                    setFocusToTextField()
                    checkForAndShowSuggestions()//fire method as if document listener change occured and fired it
                }
                else {
                    sls[indexOfFocusedSuggestion].isFocused = false
                    sls[indexOfFocusedSuggestion+1].isFocused = true
                    autoSuggestionPopUpWindow.toFront()
                    autoSuggestionPopUpWindow.requestFocusInWindow()
                    suggestionsPanel.requestFocusInWindow()
                    suggestionsPanel.getComponent(indexOfFocusedSuggestion+1).requestFocusInWindow()
                }
            }

        })
    }

    private fun setFocusToTextField() {
        container.toFront()
        container.requestFocusInWindow()
        textField.requestFocusInWindow()
    }

    var shouldShowPopUpWindow = false

    private fun checkForAndShowSuggestions() {
        typedWord = currentlyTypedWord

        suggestionsPanel.removeAll()//remove previos words/jlabels that were added

        //used to calcualte size of JWindow as new Jlabels are added
        tW = 0
        tH = 0

        val added = wordTyped(typedWord)

        if (!added) {
            if (autoSuggestionPopUpWindow.isVisible) {
                autoSuggestionPopUpWindow.isVisible = false
            }
        } else {
            shouldShowPopUpWindow = true
            showPopUpWindow()
            setFocusToTextField()
        }
    }

    protected fun addWordToSuggestions(word: String) {
        val suggestionLabel = SuggestionLabel(word, suggestionFocusedColor, suggestionsTextColor, this, callback)

        calculatePopUpWindowSize(suggestionLabel)

        suggestionsPanel.add(suggestionLabel)
    }

    private fun calculatePopUpWindowSize(label: JLabel) {
        //so we can size the JWindow correctly
        if (tW < label.preferredSize.width) {
            tW = label.preferredSize.width
        }
        tH += label.preferredSize.height
    }

    private fun showPopUpWindow() {
        autoSuggestionPopUpWindow.contentPane.add(suggestionsPanel)
        autoSuggestionPopUpWindow.minimumSize = Dimension(textField.width, 30)
        autoSuggestionPopUpWindow.setSize(tW, tH)
        autoSuggestionPopUpWindow.isVisible = true

        var windowX = 0
        var windowY = 0

        windowX = container.getX() + textField.x + 5
        if (suggestionsPanel.height > autoSuggestionPopUpWindow.minimumSize.height) {
            windowY = container.getY() + textField.y + textField.height + autoSuggestionPopUpWindow.minimumSize.height
        } else {
            windowY = container.getY() + textField.y + textField.height + autoSuggestionPopUpWindow.height
        }

        autoSuggestionPopUpWindow.setLocation(windowX, windowY)
        autoSuggestionPopUpWindow.minimumSize = Dimension(textField.width, 30)
        autoSuggestionPopUpWindow.revalidate()
        autoSuggestionPopUpWindow.repaint()

    }

    fun setDictionary(words: ArrayList<String>?) {
        dictionary.clear()
        if (words == null) {
            return //so we can call constructor with null value for dictionary without exception thrown
        }
        for (word in words) {
            dictionary.add(word)
        }
    }

    fun addToDictionary(word: String) {
        dictionary.add(word)
    }

    open fun wordTyped(typedWord: String?): Boolean {

        if (typedWord!!.isEmpty()) {
            return false
        }

        var suggestionAdded = false

        for (word in dictionary) {//get words in the dictionary which we added
            var fullyMatches = word.length >= typedWord.length
            for (i in 0 until typedWord.length) {//each string in the word
                if (word.length > i && !typedWord.toLowerCase().startsWith(word.toLowerCase()[i].toString(), i)) {//check for match
                    fullyMatches = false
                    break
                }
            }
            if (fullyMatches) {
                addWordToSuggestions(word)
                suggestionAdded = true
            }
        }
        return suggestionAdded
    }
}

internal class SuggestionLabel(string: String, private val suggestionBorderColor: Color, private val suggestionsTextColor: Color, private val autoSuggestor: AutoSuggestor, private val callback: (String) -> Unit) : JLabel(string) {

    var isFocused = false
        set(focused) {
            if (focused) {
                border = LineBorder(suggestionBorderColor)
            } else {
                border = null
            }
            repaint()
            field = focused
        }
    private val autoSuggestionsPopUpWindow: JWindow
    private val textField: JTextField

    init {
        this.textField = autoSuggestor.textField
        this.autoSuggestionsPopUpWindow = autoSuggestor.autoSuggestionPopUpWindow

        initComponent()
    }

    private fun initComponent() {
        isFocusable = true
        foreground = suggestionsTextColor

        addMouseListener(object : MouseAdapter() {
            override fun mouseClicked(me: MouseEvent) {
                super.mouseClicked(me)

                replaceWithSuggestedText()

                autoSuggestionsPopUpWindow.isVisible = false
            }
        })

        getInputMap(JComponent.WHEN_FOCUSED).put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0, true), "Enter released")
        actionMap.put("Enter released", object : AbstractAction() {
            override fun actionPerformed(ae: ActionEvent) {
                replaceWithSuggestedText()
                autoSuggestionsPopUpWindow.isVisible = false
            }
        })

        getInputMap(JComponent.WHEN_FOCUSED).put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0, true), "Escape released")
        actionMap.put("Escape released", object : AbstractAction() {
            override fun actionPerformed(ae: ActionEvent) {// Hide the popwindow
                autoSuggestionsPopUpWindow.isVisible = false
            }
        })
    }

    private fun replaceWithSuggestedText() {

        val suggestedWord = text
        val text = textField.text
        val typedWord = autoSuggestor.currentlyTypedWord
        val t = text.substring(0, text.lastIndexOf(typedWord))
        val tmp = t + text.substring(text.lastIndexOf(typedWord)).replace(typedWord, suggestedWord)
        textField.text = tmp
        callback(tmp)
    }
} 
```

注意：上面是用 Kotlin 编写的，但是如果你真的想要 Java 代码，你可以很容易地[将它转换回 Java](https://stackoverflow.com/questions/34957430/how-to-convert-a-kotlin-source-file-to-a-java-source-file)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-01-28T21:53:14.107

我想在我的 AVR 汇编器 IDE 中自动完成编辑器，所以[我编写了一个](https://github.com/toby1984/swing-autocomplete)与 Eclipse 中的自动完成功能类似的实现（CTRL-SPACE 激活、带有滚动条的下拉列表、光标键 + 鼠标导航）。它没有外部依赖，只是一个类。它应该适用于所有 JTextComponent 子类；您可以在 src/test 文件夹中找到一个使用示例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-10T07:45:18.800

将此行添加到第一个答案的私有 void addKeyBindingToRequestFocusInPopUpWindow() 以实现 UP 密钥。他的回答很完美。

```
//here I have to do my code for up key
    //---------------------------------------------------------------------
    //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    textField.getInputMap(JComponent.WHEN_FOCUSED).put(KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0, true), "Up released");
    textField.getActionMap().put("Up released", new AbstractAction() {
        @Override
        public void actionPerformed(ActionEvent ae) {//focuses the first label on popwindow
            for (int i = suggestionsPanel.getComponentCount()-1; i >=0; i--) {
                if (suggestionsPanel.getComponent(i) instanceof SuggestionLabel) {
                    ((SuggestionLabel) suggestionsPanel.getComponent(i)).setFocused(true);
                    autoSuggestionPopUpWindow.toFront();
                    autoSuggestionPopUpWindow.requestFocusInWindow();
                    suggestionsPanel.requestFocusInWindow();
                    suggestionsPanel.getComponent(i).requestFocusInWindow();
                    break;
                }
            }
        }
    });

    suggestionsPanel.getInputMap(JComponent.WHEN_ANCESTOR_OF_FOCUSED_COMPONENT).put(KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0, true), "Up released");
    suggestionsPanel.getActionMap().put("Up released", new AbstractAction() {
        //######int lastFocusableIndex = 0;
        int lastFocusableIndex = 0;
        //lastFocusableIndex=lastFocusableIndex___;
        @Override
        public void actionPerformed(ActionEvent ae) {//allows scrolling of labels in pop window (I know very hacky for now :))

            ArrayList<SuggestionLabel> sls = getAddedSuggestionLabels();
            int max = sls.size();
            lastFocusableIndex=lastFocusableIndex___;

            System.out.println("UP UP UP UP");//***// 
            System.out.println("max = "+String.valueOf(max));//***// 
            System.out.println("lastFocusableIndex = "+String.valueOf(lastFocusableIndex));//***// 
            System.out.println("UP UP UP UP");//***// 

            if (max > 1) {//more than 1 suggestion
                for (int i = max-1; i >=0; i--) {
                    SuggestionLabel sl = sls.get(i);
                    if (sl.isFocused()) {
                        if (lastFocusableIndex == 0) {
                            lastFocusableIndex = max - 1;
                            lastFocusableIndex___=lastFocusableIndex;
                            sl.setFocused(false);
                            autoSuggestionPopUpWindow.setVisible(false);
                            setFocusToTextField();
                            checkForAndShowSuggestions();//fire method as if document listener change occured and fired it

                        } else {
                            sl.setFocused(false);
                            lastFocusableIndex = i;
                            lastFocusableIndex___=lastFocusableIndex;
                        }
                    } else if (lastFocusableIndex > i) {
                        if (i < max ) {
                            sl.setFocused(true);
                            autoSuggestionPopUpWindow.toFront();
                            autoSuggestionPopUpWindow.requestFocusInWindow();
                            suggestionsPanel.requestFocusInWindow();
                            suggestionsPanel.getComponent(i).requestFocusInWindow();
                            lastFocusableIndex = i;
                            lastFocusableIndex___=lastFocusableIndex;
                            break;
                        }
                    }
                }
            } else {//only a single suggestion was given
                autoSuggestionPopUpWindow.setVisible(false);
                setFocusToTextField();
                checkForAndShowSuggestions();//fire method as if document listener change occured and fired it
            }
        }
    }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-19T09:40:10.223

我在项目中使用的一种工作方法是将 JTextField 放在 JComboBox 的顶部，并在您使用文档侦听器在 JTextField 中键入时打开底层组合框。您可能想要一个自定义组合框模型来更有效地更改项目，因为我认为默认模型只允许一次添加一个项目，这可能会影响性能。打开组合框我认为有一种方法可以显示它，如果你得到它的 UI。当我尝试在项目打开时更改项目时，我遇到了几个滚动错误，因此您可能需要关闭它，更改项目并重新显示。对于键盘的东西，您可以在 JTextField 中捕捉键盘按键并适当地调用 JComboBox。*

# rspec - RSpec message expectations not being met but method is called

> ID：14186959
> 
> 赞同：0
> 
> 时间：2013-01-06T21:28:39.300
> 
> 标签：rspec, mocking

I have the following test:

```
 describe "Exporter#get_method" do
    before(:each) do
      exporter.should_receive(:get_method).at_least(:once).and_call_original
    end

    it "should get the next terminal value" do
      exporter.send(:get_method).should == :split
    end

    it "should call descend if the current value is a hash" do
      exporter.should_receive(:descend).once

      2.times { exporter.send(:get_method) }
    end

    it "should call ascend if at the end of an array and there is a prologue" do
      exporter.should_receive(:ascend).once

      3.times { exporter.send(:get_method) }
    end
  end 
```

I can verify with a couple of binding.pry calls that ascend and descend are being called. However RSpec isn't seeing it. Where am I going wrong. I want to make sure that the method being tested does call the other methods under the correct circumstances. Is there another way to do this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:11:14.720

我倾向于从不将期望放在`before`块中。在我看来，`before`块实际上只是为了设置您正在测试的情况，而不是为了消除期望。当您移出`exporter.should_receive(:get_method).at_least(:once).and_call_original`块`before`并将其分布在 3`it`个块中时会发生什么（在这三种情况下根据需要对其进行编辑）？它可能与其他`should_receive`调用发生冲突。

另外，如果你打电话`exporter.get_method`而不是打电话，它会起作用`exporter.send(:get_method)`吗？通常，RSpec 旨在测试行为，而不是实现，如果`get_method`是私有方法，那么直接测试它没有任何意义。相反，您可能想要做的是为使用该私有方法的方法编写测试。否则，如果它不是私有方法，为什么要使用`:send`？

# c# - Change Rectangle Position Sketchflow Blend

> ID：14186967
> 
> 赞同：1
> 
> 时间：2013-01-06T21:29:23.047
> 
> 标签：c#, silverlight, expression-blend, blend, sketchflow

I am using Sketchflow c# silverlight Expression Blend 4\. I have a dragable control on a rectangle and I am trying to change the rectangle position in c# on mouse click. How can this be achieved? Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-01T22:58:29.230

如果您希望能够拖动矩形，请将控件的父级设置为画布，然后将 MouseDragElementBehavior 拖动到控件上。

如果您知道希望它移动到哪个位置并希望它只需单击即可工作，您可以将 ChangePropertyAction 行为拖到它上面以设置边距属性（或其他一些布局属性）。

# javascript - 多个 DOM 准备好了吗？

> ID：14186970
> 
> 赞同：4
> 
> 时间：2013-01-06T21:29:52.460
> 
> 标签：javascript, jquery

> **可能重复：**
> [JQuery - 多个 $(document).ready ...？](https://stackoverflow.com/questions/5263385/jquery-multiple-document-ready)

我的 JS 代码在 jQuery Document Ready IE 中使用 jQuery：

```
$(function() {

}); 
```

我在页面上运行多个 jQuery 脚本，所有脚本都包含在一个`$(function() { });`中，我有什么理由应该将脚本分解为多个准备好的处理程序？IE：

```
$(function() {
      // First Script
});

$(function() {
      // Second Script
});

//etc. 
```

或者可以在一个中包含多个脚本吗？IE：

```
$(function() {
      // First Script
      //Second Script
      //etc. 
}); 
```

我认为一个很好，但我想确保没有理由我应该使用多个。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T21:31:10.933

你的脚本中可以有多个`document.ready`处理程序，jQuery 会在执行之前将它们合并为一个处理程序。但实际上没有必要拥有很多 document.ready 处理程序。一个就够了。如果您始终将脚本放在 DOM 的末尾，就在结束`</body>`标记之前，您不需要使用任何 document.ready 处理程序。

例如：

```
<html>
<head>
    <title></title>
    ... your CSS references come here
</head>
<body>
    ... the markup of the body comes here ...

    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript">
        // you don't need to use any document.ready handlers here =>
        // you could directly write your scripts inline or reference them
        // as external resources. At this stage the DOM will be ready
    </script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-06T21:31:16.830

它的工作方式完全没有区别。

但是，它对组织很有用。

另一方面，这意味着需要运行更多的 jQuery。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T21:44:07.267

您可以将所有脚本/函数包装在单个就绪事件中，或者您可以简单地将所有脚本放在 html 之后，然后避免等待就绪事件，因为此时 DOM 已经加载。

```
<html>
<head>
    <!-- Style sheets Go Here -->
</head>
<body>
    <!--HTML Goes Here -->
    <!-- Scripts Go Here -->
</body>
</html> 
```

# netty - When should one manually create Channels?

> ID：14186976
> 
> 赞同：0
> 
> 时间：2013-01-06T21:30:15.380
> 
> 标签：netty, channels

When, if ever, does netty create new Channels? Or are the only Channels in existence those created explicitly by the appllication?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T23:32:14.373

如果您在[这里](http://static.netty.io/3.6/api/)研究不同的“引导”类，您会看到`ClientBootstrap`并`ConnectionlessBootstrap`在调用`bind()`和`connect()`方法时创建通道。`Serverbootstrap`另一方面，当远程客户端连接到本地服务器地址/端口时， A 会创建一个通道。

用“主动”和“被动”的术语来思考。客户端是活跃的，因为它主动或明确地连接到远程服务器或对等方。服务器是被动的，因为它懒惰地等待来自远程客户端或对等方的传入连接 - 并为每个客户端创建子通道。

# php - ZF2 教程 Album PHPUnit 测试因未定义属性而失败：AlbumTest\Model\AlbumTableTest::$controller

> ID：14186978
> 
> 赞同：3
> 
> 时间：2013-01-06T21:30:32.453
> 
> 标签：php, phpunit, zend-framework2

我正在构建 ZF2 Album 教程应用程序，当我进行单元测试时，我始终收到相同的错误，即使我再次重建了应用程序。有人能告诉我这里发生了什么吗？我在这里倾销所有相关信息以提供帮助。错误是：

```
PHPUnit 3.7.10 by Sebastian Bergmann.

Configuration read from D:\PHP\zf2-tutorial\module\Album\test\phpunit.xml.dist

......E

Time: 0 seconds, Memory: 6.25Mb

There was 1 error:

1) AlbumTest\Model\AlbumTableTest::testGetAlbumTableReturnsAnInstanceOfAlbumTable
Undefined property: AlbumTest\Model\AlbumTableTest::$controller

D:\PHP\zf2-tutorial\module\Album\test\AlbumTest\Model\AlbumTableTest.php:116

FAILURES!
Tests: 7, Assertions: 9, Errors: 1. 
```

AlbumTableTest.php 如下，最终断言收到错误：

```
<?php

namespace AlbumTest\Model;

use Album\Model\AlbumTable;
use Album\Model\Album;
use Zend\Db\ResultSet\ResultSet;
use PHPUnit_Framework_TestCase;

class AlbumTableTest extends PHPUnit_Framework_TestCase {

    public function testFetchAllReturnsAllAlbums() {
        $resultSet = new ResultSet();
        $mockTableGateway = $this->getMock('Zend\Db\TableGateway\TableGateway', array('select'), array(), '', false);
        $mockTableGateway->expects($this->once())
                ->method('select')
                ->with()
                ->will($this->returnValue($resultSet));

        $albumTable = new AlbumTable($mockTableGateway);

        $this->assertSame($resultSet, $albumTable->fetchAll());
    }

    public function testCanRetrieveAnAlbumByItsId() {
        $album = new Album();
        $album->exchangeArray(array('id' => 123,
            'artist' => 'The Military Wives',
            'title' => 'In My Dreams'));

        $resultSet = new ResultSet();
        $resultSet->setArrayObjectPrototype(new Album());
        $resultSet->initialize(array($album));

        $mockTableGateway = $this->getMock('Zend\Db\TableGateway\TableGateway', array('select'), array(), '', false);
        $mockTableGateway->expects($this->once())
                ->method('select')
                ->with(array('id' => 123))
                ->will($this->returnValue($resultSet));

        $albumTable = new AlbumTable($mockTableGateway);

        $this->assertSame($album, $albumTable->getAlbum(123));
    }

    public function testCanDeleteAnAlbumByItsId() {
        $mockTableGateway = $this->getMock('Zend\Db\TableGateway\TableGateway', array('delete'), array(), '', false);
        $mockTableGateway->expects($this->once())
                ->method('delete')
                ->with(array('id' => 123));

        $albumTable = new AlbumTable($mockTableGateway);
        $albumTable->deleteAlbum(123);
    }

    public function testSaveAlbumWillInsertNewAlbumsIfTheyDontAlreadyHaveAnId() {
        $albumData = array('artist' => 'The Military Wives', 'title' => 'In My Dreams');
        $album = new Album();
        $album->exchangeArray($albumData);

        $mockTableGateway = $this->getMock('Zend\Db\TableGateway\TableGateway', array('insert'), array(), '', false);
        $mockTableGateway->expects($this->once())
                ->method('insert')
                ->with($albumData);

        $albumTable = new AlbumTable($mockTableGateway);
        $albumTable->saveAlbum($album);
    }

    public function testSaveAlbumWillUpdateExistingAlbumsIfTheyAlreadyHaveAnId() {
        $albumData = array('id' => 123, 'artist' => 'The Military Wives', 'title' => 'In My Dreams');
        $album = new Album();
        $album->exchangeArray($albumData);

        $resultSet = new ResultSet();
        $resultSet->setArrayObjectPrototype(new Album());
        $resultSet->initialize(array($album));

        $mockTableGateway = $this->getMock('Zend\Db\TableGateway\TableGateway', array('select', 'update'), array(), '', false);
        $mockTableGateway->expects($this->once())
                ->method('select')
                ->with(array('id' => 123))
                ->will($this->returnValue($resultSet));
        $mockTableGateway->expects($this->once())
                ->method('update')
                ->with(array('artist' => 'The Military Wives', 'title' => 'In My Dreams'), array('id' => 123));

        $albumTable = new AlbumTable($mockTableGateway);
        $albumTable->saveAlbum($album);
    }

    public function testExceptionIsThrownWhenGettingNonexistentAlbum() {
        $resultSet = new ResultSet();
        $resultSet->setArrayObjectPrototype(new Album());
        $resultSet->initialize(array());

        $mockTableGateway = $this->getMock('Zend\Db\TableGateway\TableGateway', array('select'), array(), '', false);
        $mockTableGateway->expects($this->once())
                ->method('select')
                ->with(array('id' => 123))
                ->will($this->returnValue($resultSet));

        $albumTable = new AlbumTable($mockTableGateway);

        try {
            $albumTable->getAlbum(123);
        } catch (\Exception $e) {
            $this->assertSame('Could not find row 123', $e->getMessage());
            return;
        }

        $this->fail('Expected exception was not thrown');
    }

    public function testGetAlbumTableReturnsAnInstanceOfAlbumTable() {
        $this->assertInstanceOf('Album\Model\AlbumTable', $this->controller->getAlbumTable());
    }

}

?> 
```

getAlbumTable 在 AlbumController 中如下：

```
<?php

namespace Album\Controller;

use Zend\Mvc\Controller\AbstractActionController;
use Zend\View\Model\ViewModel;

class AlbumController extends AbstractActionController {

    protected $albumTable;

    public function indexAction() {
        return new ViewModel(array(
                    'albums' => $this->getAlbumTable()->fetchAll(),
                ));
    }

    public function addAction() {

    }

    public function editAction() {

    }

    public function deleteAction() {

    }

    public function getAlbumTable() {
        if (!$this->albumTable) {
            $sm = $this->getServiceLocator();
            $this->albumTable = $sm->get('Album\Model\AlbumTable');
        }
        return $this->albumTable;
    }

}

?> 
```

和 AlbumTable 是：

```
<?php
namespace Album\Model;

use Zend\Db\TableGateway\TableGateway;

class AlbumTable
{
    protected $tableGateway;

    public function __construct(TableGateway $tableGateway)
    {
        $this->tableGateway = $tableGateway;
    }

    public function fetchAll()
    {
        $resultSet = $this->tableGateway->select();
        return $resultSet;
    }

    public function getAlbum($id)
    {
        $id  = (int) $id;
        $rowset = $this->tableGateway->select(array('id' => $id));
        $row = $rowset->current();
        if (!$row) {
            throw new \Exception("Could not find row $id");
        }
        return $row;
    }

    public function saveAlbum(Album $album)
    {
        $data = array(
            'artist' => $album->artist,
            'title'  => $album->title,
        );

        $id = (int)$album->id;
        if ($id == 0) {
            $this->tableGateway->insert($data);
        } else {
            if ($this->getAlbum($id)) {
                $this->tableGateway->update($data, array('id' => $id));
            } else {
                throw new \Exception('Form id does not exist');
            }
        }
    }

    public function deleteAlbum($id)
    {
        $this->tableGateway->delete(array('id' => $id));
    }
}
?> 
```

Module.php 是：

```
<?php
namespace Album;

class Module
{
    public function getAutoloaderConfig()
    {
        return array(
            'Zend\Loader\ClassMapAutoloader' => array(
                __DIR__ . '/autoload_classmap.php',
            ),
            'Zend\Loader\StandardAutoloader' => array(
                'namespaces' => array(
                    __NAMESPACE__ => __DIR__ . '/src/' . __NAMESPACE__,
                ),
            ),
        );
    }

    public function getConfig()
    {
        return include __DIR__ . '/config/module.config.php';
    }
    // Add this method:
    public function getServiceConfig()
    {
        return array(
            'factories' => array(
                'Album\Model\AlbumTable' =>  function($sm) {
                    $tableGateway = $sm->get('AlbumTableGateway');
                    $table = new AlbumTable($tableGateway);
                    return $table;
                },
                'AlbumTableGateway' => function ($sm) {
                    $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
                    $resultSetPrototype = new ResultSet();
                    $resultSetPrototype->setArrayObjectPrototype(new Album());
                    return new TableGateway('album', $dbAdapter, null, $resultSetPrototype);
                },
            ),
        );
    }
}
?> 
```

module.config.php 是：

```
<?php
return array(
    'controllers' => array(
        'invokables' => array(
            'Album\Controller\Album' => 'Album\Controller\AlbumController',
        ),
    ),

    // The following section is new and should be added to your file
    'router' => array(
        'routes' => array(
            'album' => array(
                'type'    => 'segment',
                'options' => array(
                    'route'    => '/album[/:action][/:id]',
                    'constraints' => array(
                        'action' => '[a-zA-Z][a-zA-Z0-9_-]*',
                        'id'     => '[0-9]+',
                    ),
                    'defaults' => array(
                        'controller' => 'Album\Controller\Album',
                        'action'     => 'index',
                    ),
                ),
            ),
        ),
    ),

    'view_manager' => array(
        'template_path_stack' => array(
            'album' => __DIR__ . '/../view',
        ),
    ),
);
?> 
```

application.config.php 是：

```
<?php
return array(
    'modules' => array(
        'Application',
        'Album',                  // <-- Add this line
    ),
    'module_listener_options' => array(
        'config_glob_paths'    => array(
            'config/autoload/{,*.}{global,local}.php',
        ),
        'module_paths' => array(
            './module',
            './vendor',
        ),
    ),
);
?> 
```

引导程序.php：

```
<?php
namespace AlbumTest;//Change this namespace for your test

use Zend\Loader\AutoloaderFactory;
use Zend\Mvc\Service\ServiceManagerConfig;
use Zend\ServiceManager\ServiceManager;
use Zend\Stdlib\ArrayUtils;
use RuntimeException;

error_reporting(E_ALL | E_STRICT);
chdir(__DIR__);

class Bootstrap
{
    protected static $serviceManager;
    protected static $config;
    protected static $bootstrap;

    public static function init()
    {
        // Load the user-defined test configuration file, if it exists; otherwise, load
        if (is_readable(__DIR__ . '/TestConfig.php')) {
            $testConfig = include __DIR__ . '/TestConfig.php';
        } else {
            $testConfig = include __DIR__ . '/TestConfig.php.dist';
        }

        $zf2ModulePaths = array();

        if (isset($testConfig['module_listener_options']['module_paths'])) {
            $modulePaths = $testConfig['module_listener_options']['module_paths'];
            foreach ($modulePaths as $modulePath) {
                if (($path = static::findParentPath($modulePath)) ) {
                    $zf2ModulePaths[] = $path;
                }
            }
        }

        $zf2ModulePaths  = implode(PATH_SEPARATOR, $zf2ModulePaths) . PATH_SEPARATOR;
        $zf2ModulePaths .= getenv('ZF2_MODULES_TEST_PATHS') ?: (defined('ZF2_MODULES_TEST_PATHS') ? ZF2_MODULES_TEST_PATHS : '');

        static::initAutoloader();

        // use ModuleManager to load this module and it's dependencies
        $baseConfig = array(
            'module_listener_options' => array(
                'module_paths' => explode(PATH_SEPARATOR, $zf2ModulePaths),
            ),
        );

        $config = ArrayUtils::merge($baseConfig, $testConfig);

        $serviceManager = new ServiceManager(new ServiceManagerConfig());
        $serviceManager->setService('ApplicationConfig', $config);
        $serviceManager->get('ModuleManager')->loadModules();

        static::$serviceManager = $serviceManager;
        static::$config = $config;
    }

    public static function getServiceManager()
    {
        return static::$serviceManager;
    }

    public static function getConfig()
    {
        return static::$config;
    }

    protected static function initAutoloader()
    {
        $vendorPath = static::findParentPath('vendor');

        if (is_readable($vendorPath . '/autoload.php')) {
            $loader = include $vendorPath . '/autoload.php';
        } else {
            $zf2Path = getenv('ZF2_PATH') ?: (defined('ZF2_PATH') ? ZF2_PATH : (is_dir($vendorPath . '/ZF2/library') ? $vendorPath . '/ZF2/library' : false));

            if (!$zf2Path) {
                throw new RuntimeException('Unable to load ZF2\. Run `php composer.phar install` or define a ZF2_PATH environment variable.');
            }

            include $zf2Path . '/Zend/Loader/AutoloaderFactory.php';

        }

        AutoloaderFactory::factory(array(
            'Zend\Loader\StandardAutoloader' => array(
                'autoregister_zf' => true,
                'namespaces' => array(
                    __NAMESPACE__ => __DIR__ . '/' . __NAMESPACE__,
                ),
            ),
        ));
    }

    protected static function findParentPath($path)
    {
        $dir = __DIR__;
        $previousDir = '.';
        while (!is_dir($dir . '/' . $path)) {
            $dir = dirname($dir);
            if ($previousDir === $dir) return false;
            $previousDir = $dir;
        }
        return $dir . '/' . $path;
    }
}

Bootstrap::init();
?> 
```

TestConfig.php.dist：

```
<?php
return array(
    'modules' => array(
        'Album',
    ),
    'module_listener_options' => array(
        'config_glob_paths'    => array(
            '../../../config/autoload/{,*.}{global,local}.php',
        ),
        'module_paths' => array(
            'module',
            'vendor',
        ),
    ),
);
?> 
```

最后，phpunit.xml.dist：

```
<?xml version="1.0" encoding="UTF-8"?> 
<phpunit bootstrap="Bootstrap.php"> 
    <testsuites> 
        <testsuite name="zf2tutorial"> 
            <directory>./AlbumTest</directory> 
        </testsuite> 
    </testsuites> 
</phpunit> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-30T18:14:43.430

您假设您需要添加一些设置代码并将其与它进行比较`AlbumControllerTest.php`是一个好主意，这是正确的。

正如错误消息所述，问题在于该`AlbumTableTest`对象没有 `controller`属性。因此，我们需要使用以下方法添加属性：

```
$protected controller 
```

并使用以下方法对其进行初始化：

```
$this->controller = new AlbumController() 
```

此外，我们需要初始化`serviceManager`属性并设置它的属性，以便以下调用在控制器`serviceLocator`的方法中有意义：`getAlbumTable`

```
$sm = $this->getServiceLocator();
$this->albumTable = $sm->get('Album\Model\AlbumTable'); 
```

总而言之，您做了正确的事情，但您不需要所有额外的代码。你可以逃脱：

```
use AlbumTest\Bootstrap;
use Album\Controller\AlbumController;
use Album\Model\AlbumTable;
use Album\Model\Album;
use Zend\Db\ResultSet\ResultSet;
use PHPUnit_Framework_TestCase; 

class AlbumTableTest extends PHPUnit_Framework_TestCase       
{                                                             
protected $controller; 

    protected function setUp()
    {   
        $serviceManager = Bootstrap::getServiceManager();
        $this->controller = new AlbumController();  
        $this->controller->setServiceLocator($serviceManager);
    }

.... 
```

在开始时`AlbumTableTest.php`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T01:20:14.347

虽然我现在不确定这是不是适当的修复，但我解决了错误。我查看了 AlbumControllerTest 而不是 AlbumTableTest。它有一个创建控制器类的 setup 方法。我复制了设置代码以及适当的使用语句和变量声明，目前，我正在处理下一个问题......

我仍然对更好的答案感兴趣！

我复制（添加）的内容包括：

```
use AlbumTest\Bootstrap;
use Album\Controller\AlbumController;
use Zend\Http\Request;
use Zend\Http\Response;
use Zend\Mvc\MvcEvent;
use Zend\Mvc\Router\RouteMatch;
use Zend\Mvc\Router\Http\TreeRouteStack as HttpRouter;
use PHPUnit_Framework_TestCase;

class AlbumTableTest extends PHPUnit_Framework_TestCase {

    protected $controller;
    protected $request;
    protected $response;
    protected $routeMatch;
    protected $event;

    protected function setUp()
    {
        $serviceManager = Bootstrap::getServiceManager();
        $this->controller = new AlbumController();
        $this->request    = new Request();
        $this->routeMatch = new RouteMatch(array('controller' => 'index'));
        $this->event      = new MvcEvent();
        $config = $serviceManager->get('Config');
        $routerConfig = isset($config['router']) ? $config['router'] : array();
        $router = HttpRouter::factory($routerConfig);
        $this->event->setRouter($router);
        $this->event->setRouteMatch($this->routeMatch);
        $this->controller->setEvent($this->event);
        $this->controller->setServiceLocator($serviceManager);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-27T13:10:34.910

您忘记在 Module.php 中添加新的导入语句。文件的开头应如下所示：

```
namespace Album;

use Album\Model\Album;
use Album\Model\AlbumTable;
use Zend\Db\ResultSet\ResultSet;
use Zend\Db\TableGateway\TableGateway;

class Module
{
 //... 
```

容易跳过，很难找到，我在同一件事上花了整整 15 分钟......

# magento - Magento如何检查用户是否登录？

> ID：14186981
> 
> 赞同：0
> 
> 时间：2013-01-06T21:30:59.920
> 
> 标签：magento

如何检查用户是否已登录？

像：

```
 <?php unless user_is_signed_in 
   echo "Please log in"
   end

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:34:13.107

```
Mage::getSingleton('customer/session')->isLoggedIn(); 
```

或者

```
Mage::helper('customer')->isLoggedIn(); 
```

第二种方法调用第一种方法 -[见这里](https://github.com/LokeyCoding/magento-mirror/blob/magento-1.7/app/code/core/Mage/Customer/Helper/Data.php#L102)

* * *

所以以辅助方法为例...

```
$isLoggedIn = Mage::helper('customer')->isLoggedIn();
if (! $isLoggedIn) {
    echo "Please log in"; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:33:26.223

使用客户助手：

```
 $this->helper('customer')->isLoggedIn() 
```

# android - 屏幕关闭时上传任务会怎样？

> ID：14186985
> 
> 赞同：-2
> 
> 时间：2013-01-06T21:31:12.123
> 
> 标签：android

如果我尝试使用后台服务（例如使用 HttpClient java 对象）上传文件，并且在上传过程中屏幕关闭，现在有人会发生什么情况吗？

当设备屏幕关闭时（例如 30 秒后），后台服务停止了吗？

我在我的三星 Galaxy SII 上对其进行了测试，即使屏幕关闭，上传也会继续运行，但我不知道在其他设备上会发生什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:37:37.077

如果您在后台服务上运行它，它会在屏幕关闭时继续上传。在显式调用 stopService 之前，启动的服务不会停止。

# debian - vagrant 1.0.3 不为仅主机网络 debian 6 创建设备

> ID：14186989
> 
> 赞同：2
> 
> 时间：2013-01-06T21:31:27.213
> 
> 标签：debian, vagrant

我在我的 Vagrantfile 中使用以下行创建了一个仅主机网络

```
config.vm.network :hostonly, "10.1.1.15" 
```

我可以看到它设置了 /etc/network/interfaces 文件

```
#VAGRANT-BEGIN
# The contents below are automatically generated by Vagrant. Do not modify.
auto eth1
iface eth1 inet static
      address 10.1.1.15
      netmask 255.255.255.0
#VAGRANT-END 
```

但是，当我运行 ifconfig 时，我只看到一个 eth0 和一个 lo 设备。为什么 vagrant 没有为 eth1 设置设备？解决此问题的解决方案是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T22:36:29.460

好吧，经过更多挖掘后，我找到了解决方案。

万一这很重要，以下是有关我的环境的一些详细信息：

```
Ubuntu 12.10
Vagrant 1.0.3 install from the Ubuntu repos using apt-get
Virtualbox 4.1.24 downloaded from the virtualbox website 
```

据我所知，我使用过并遇到此问题的盒子（来自 vagrantup.com 的precise32 以及来自 vagrantbox.es 的挤压 64 盒子）在**/etc/udev中设置了一些规则/rules.d/70-persistent-net.rules**文件。这些通常在每次启动时都会更新，但由于某种原因，这不会发生。这会导致永远不会设置诸如 eth1 之类的设备（通常用于在 vagrant 中设置主机网络），并且操作系统不会认为它已配置。

您可以删除文件中的相关规则或仅删除文件。然后重新启动，问题应该得到解决。每次您执行**vagrant destroy**或创建新的 vagrant VM 时，您都必须这样做。然而，感谢#vagrant freenode 频道上的 simonmcc 指出了一个更永久的修复。

您可以在不重新启动的情况下删除该文件，然后执行一个 vagrant 包以这种方式重新打包该框。否则，从头开始创建您自己的盒子（使用或不使用 veewee）并确保此文件设置正确然后打包。

# linux - Remove all backup files in Linux using Shell script recursively

> ID：14186991
> 
> 赞同：7
> 
> 时间：2013-01-06T21:32:18.267
> 
> 标签：linux, bash, shell, ubuntu

How can I remove all backup files, i.e files ending with `~`, recursively in a particular folder in Ubuntu?

A script in any programming language would do.

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-06T21:36:42.093

一方面，您可以使用一个简单的`find`命令：

```
find . -type f -name '*~' -delete 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:37:46.233

单程：

```
find folder -name '*~' -print0 | xargs -0 rm -f 
```

基本上，看“man find”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T21:39:02.040

首先，递归是什么意思？递归是实现圆顶算法的一种便捷方式，但往往被过度使用 - 但有些人也将该术语应用于搜索目录树（可以通过递归的其他方式实现）。如果您只是想删除与目录树中特定 glob 匹配的所有文件，那么......

```
find /base/directory/ -type f -iname '*~' -exec rm -f {}\; 
```

（但您可能想先尝试一下`find /base/directory/ -type f -iname '*~' -exec ls -l {}\;`）。

# database - 指定并允许对在数据库中存储为行的成分进行重新排序

> ID：14186993
> 
> 赞同：0
> 
> 时间：2013-01-06T21:32:21.000
> 
> 标签：database, sorting, database-design, database-schema

我有一张`Ingredient`桌子和一张`Food`桌子，想用一张桌子把它们联系起来`IngredientToFood`。我还希望能够指定`Order`，因为这对营养信息非常重要。我的`IngredientToFood`表目前有、 和列`IngredientId`，在两个 ID 上具有复合 PK，并且 2 个 FK 引用每个相应的 ID。我想知道的是实施订购配料的最佳实践方式。我在这里和其他地方看到了以下提出的解决方案，我想知道哪个是我的用例的最佳解决方案。`FoodId``Order`

1.  使用该`Order`列指定数字顺序，在（100、200、300 等）之间留下大量分隔符。
2.  在这种情况下，使用两列 a`beforeIngredient`和。`afterIngredient`
3.  在插入或删除之前使用触发器重新编号现有`Order`值（在更新的情况下您会做什么？）

我不是在寻找有史以来最优雅的解决方案，而只是在寻找一种对订购成分的应用有意义的解决方案。我假设我可能会更频繁地插入/删除成分，而不是重新排序现有成分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:45:34.847

> 使用 Order 列指定数字顺序，在（100、200、300 等）之间留出大量间隔。

这是正确的想法，但你提到了营养信息的重要性。

您可能还想创建一个营养表，列出您想要跟踪的不同营养素。您可以为每种营养素分配一个数字，例如 100、200、300 等，其中较低的数字是更重要的营养素。

这个营养素编号将是 Order 表中的顺序编号。

与任意订单号相比，拥有营养表的优势在于您可以查询食谱中的营养成分。

# gwt - GWT GUI设计方法

> ID：14186995
> 
> 赞同：1
> 
> 时间：2013-01-06T21:32:26.880
> 
> 标签：gwt, user-interface

我正在尝试开发一个 GWT GUI，它将在 PhoneGap 的帮助下在移动设备上运行。简单的多视图应用程序，每个视图上都有不同的按钮/文本框。每个视图只能从单个预定视图导航到。即，我的视图可能会像 ViewA - ViewB - View C - Back to ViewB - ViewA 这样流动。每个视图都有一个后退按钮（不是浏览器按钮，因为这在手机间隙应用程序中没有用）是否有任何示例/书籍可以涵盖这样的内容。我已经查看了活动和地点框架，但这看起来对我想要的东西来说有点过分了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:35:39.103

如果您不需要支持浏览器后退按钮或浏览器书签，您可以通过一次将一个视图添加到父容器来实现基本导航。[你可以在这里](https://groups.google.com/forum/?fromgroups=#!topic/google-web-toolkit/5NRxedORK-k)找到一个例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T06:11:28.060

## 活动和场所框架

为大型项目（超过 5-10 个屏幕）提供价值[https://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces](https://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces)

不要在初次尝试时忽略它。学习曲线陡峭，但它提供

1) 具有清晰模块化的代码隔离以允许单元测试。

2）通过代码拆分和片段合并进行性能优化。

3) 自动历史跟踪

## GWT 历史管理器

您仍然可以在不使用“地点”的情况下使用 GWT 历史管理器。[https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsHistory](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsHistory)

同样好的起点是寻找其他gwt电话差距，例如

[https://github.com/dennisjzh/GwtMobile-PhoneGap](https://github.com/dennisjzh/GwtMobile-PhoneGap)

[https://play.google.com/store/apps/details?id=com.gwtmobile.phonegap](https://play.google.com/store/apps/details?id=com.gwtmobile.phonegap)

# xcode - Xcode tutorial throws execution error

> ID：14186997
> 
> 赞同：0
> 
> 时间：2013-01-06T21:32:31.627
> 
> 标签：xcode, uitableview

[I have completed "Your Second iOS App"](http://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011318-CH1-SW1) only to have the execution fail before the iPhone simulator completes it startup and see `signal SIGABRT` in Xcode.

At the bottom of the tutorial page there is a listing of all the .h and .m files. There are two peculiar things that I have noticed.

(1) Two files in that listing are never mentioned in the tutorial and there is no storyboard file (but I guess such a file is not reproducible): AddSightingViewController.h AddSightingViewController.m

(2) The two appDelegate files that are automatically created, are not listed, but then they are never mentioned (or used) in the tutorial.

Has anyone successfully run their 2nd tutorial? Can anyone see from the error report below what might be wrong? Notice that the error is "UITableView dataSource must return a cell from tableView:cellForRowAtIndexPath:"

```
2013-01-06 16:14:47.771 BirdWatching[47304:11303] *** Assertion failure in -[UITableView _configureCellForDisplay:forIndexPath:], /SourceCache/UIKit_Sim/UIKit-2372/UITableView.m:5471
2013-01-06 16:14:47.773 BirdWatching[47304:11303] *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'UITableView dataSource must return a cell from tableView:cellForRowAtIndexPath:'
*** First throw call stack:
(0x1c92012 0x10cfe7e 0x1c91e78 0xb65f35 0xcd26b 0x61a5c 0xcd0cb 0xd1f69 0xd201f 0xba80b 0xcb19b 0x6792d 0x10e36b0 0x228efc0 0x228333c 0x228eeaf 0x1068cd 0x4f1a6 0x4dcbf 0x4dbd9 0x4ce34 0x4cc6e 0x4da29 0x50922 0xfafec 0x47bc4 0x47dbf 0x47f55 0x50f67 0x14fcc 0x15fab 0x27315 0x2824b 0x19cf8 0x1beddf9 0x1bedad0 0x1c07bf5 0x1c07962 0x1c38bb6 0x1c37f44 0x1c37e1b 0x157da 0x1765c 0x22cd 0x21f5)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T22:13:22.423

重新启动我的计算机或其他原因导致此错误消息消失。

此外，结果证明，虽然我**以为**我已经完成了整个教程，但我没有，并且我的评论“（1）该列表中的两个文件在教程中从未提及”是我没有完成教程的信号。还有一页或更多我没有注意到。我现在已经完成了。

我的主要愿望是有一个同样详尽的教程可用，它不使用故事板，而是使用带有 nib 的 Xcode 4.5.2 来完成类似的任务。

所以，我很抱歉有人在这个问题上浪费了时间。